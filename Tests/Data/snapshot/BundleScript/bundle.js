(()=>{var e,t={36964:(e,t,n)=>{"use strict";n.d(t,{Z:()=>C});var s=n(28515),i=n(99827),o=n(98611),a=n(46382),r=n(53576),l=n(33638),d=n(5267),c=n(93818),h=n(89846),p=n(93043),u=n(5204),g=n(13311),m=n(17776),v=n(5863),f=n(77312);const y=new class{drafts={};setActiveMailComposer(e){l.Z.dispatch({actionType:"MAIL_SET_ACTIVE_COMPOSER",mailComposer:e}),y.drafts[e.state.id]=1}clearActiveMailComposer(e){l.Z.dispatch({actionType:"MAIL_CLEAR_ACTIVE_COMPOSER",mailComposer:e})}async deleteDraftMessage(){const e=s.Z.getDraftIdAndCancelDraftUpdates();if(e){await(0,f.fN)(e);const t=[e];p.Z.call(t),d.Z.deleteMessages(t),i.Z.updateIndex({removedSles:[e]})}}async queueMessage(e,t){const n=s.Z.getComposer();if(!n)return;const{to:a,cc:d,bcc:p}=n.state;if([a,d,p].every((e=>0===e.length)))return void l.Z.dispatch({actionType:"MAIL_ACTIVE_COMPOSER_MODAL",noRecipients:!0});const{searchListId:m}=n.props;let f;if(m){if(await n.flushPendingChanges(),f=await(0,c.Z)(m),f){o.Z.getByIds(f.sourceFilterIds).some((e=>e.accountId===v.of&&e.path===v.Wb))&&(f=await async function(e,t){const n={filteringPriority:v.Un.HIGH,addedProperties:t?{}:{searchList:{queued:!0}}},{sleUpdate:s,updatedSle:o}=await(0,h.Z)(e,v.of,v.Wb,v.of,v.J8,n);return i.Z.updateIndex({sleUpdates:[s]}),u.Z.filter(),o}(m,t))}}else n.cancelPendingChanges();if(!f){const e=await s.Z.getMessagePromise();if(!e)return;f=await g.Z.storeMessage(e,t)}t&&g.Z.sendSelected(e,[f]),r.ZP.close(e)}sendMessage(e){y.queueMessage(e,!0)}async chooseAttachments({showOpenFilePicker:e}){const t=await e({multiple:!0}),n=[];for(const e of t){const t=await e.getFile();if(t.size>v.gh){if("cancel"===await a.Z.showLargeAttachmentWarning(t.name,t.size))continue}const s=await t.arrayBuffer(),i=await(0,m.Z)(s);n.push({type:"attachment",content:i,filename:e.name,fileSize:t.size,mimeType:t.type})}y.addAttachments(n)}addAttachments(e){const t=s.Z.getComposer();t&&t.setState({attachments:[...t.state.attachments,...e]},(()=>t.updateAttribute(t.onBodyChange)))}},C=y},43630:(e,t,n)=>{"use strict";n.d(t,{Z:()=>me});var s=n(39005),i=n(99827),o=n(98611),a=n(36943),r=n(2431),l=n(54162),d=n(46382),c=n(96951),h=n(29087),p=n(81538),u=n(33638),g=n(56371),m=n(78347),v=n(58537),f=n(48868),y=n(83204),C=n(5267),w=n(97823),b=n(68906),S=n(6977),I=n(35489),k=n(93043),A=n(93789),T=n(5204),Z=n(5863),E=n(51501),_=n(77312);const M={call:async function(e,t){const n={},s=[],a=await w.Z.loadAllAccounts(),r=[],l=new Map,d=new E.R,c=[];for(const i of e){const{id:e,messageId:h,sources:p}=i,u=t.get(e);if(!u)return;p.size===u.length?l.set(e,i):d.add(u,e);for(const t of u){const l=o.Z.get(t);if(!l)continue;const{accountId:d,path:p}=l;if(d===Z.of&&[Z.J8,Z.Wb].includes(p))c.push(i.id);else if(d===Z.u4)r.push({path:p,messageId:h});else{const t=a.find((e=>e.MAIL_EMAIL===d));t?t.accountType===Z.s9.POP?n[d]?n[d].push(e):n[d]=[e]:t.accountType===Z.s9.IMAP&&s.push({accountId:d,path:p,searchListId:e}):console.warn("Account "+d+" not found")}}}let h=[];c.length>0&&(h=await(0,_.TP)(c));const p=[f.Z.messages,f.Z.searchList,f.Z.threading,f.Z.filteringQueue,f.Z.viewIds,f.Z.hasRaw];(s.length>0||Object.keys(n).length>0)&&(p.push(f.Z.buffer),s.length>0&&p.push(f.Z.imap),Object.keys(n).length>0&&p.push(f.Z.pop)),r.length>0&&p.push(f.Z.deletedFeedItems);const u=[],g=[...l.keys()],m=[];await f.Z.transaction("rw",p,(async()=>{for(const{filterIds:e,searchListIds:t}of d.batches){const n=[...e],{fileKeys:s,sleUpdates:i}=await A.Z.call(t,n);u.push(...s),m.push(...i);const o=new Map(n.map((e=>[e,void 0])));b.Z.call({type:"UPDATE_SLE",priority:Z.Un.HIGH,searchListIds:t,sources:o})}if(r.length>0&&f.Z.deletedFeedItems.bulkAdd(r),g.length>0){const e=await I.Z.getBySearchListIds(g);for(const t of e){const{accountId:e,searchListId:n,hasRaw:s}=t;if(1===s){const t=l.get(n);if(!t)throw new Error("Item not found "+n);const{sentDate:s}=t;u.push({accountId:e,searchListId:n,sentDate:s})}}k.Z.call(g)}s.length>0&&S.Z.addDelete(s);const e=Object.keys(n);if(e.length>0){const t=[];for(const s of e)t.push({accountId:s,searchListIds:n[s],operation:"BUFFER_OPERATION_DELETE_POP"});t.length>0&&f.Z.buffer.bulkAdd(t)}})),g.length>0&&C.Z.deleteMessages(g),i.Z.updateIndex({removedSles:g,sleUpdates:m}),v.Z.flushBuffer(),T.Z.filter();for(const e of u){const{accountId:t,searchListId:n,sentDate:s}=e;await y.Z.call(t,n,s).catch((()=>console.warn("Error deleting file. May not exist!",e)))}for(const e of h)await(0,_.MT)(e)}};var N=n(71320),P=n(45709),D=n(10671),x=n(84283),O=n(45660),L=n(10048),R=n(47482),B=n(59552),F=n(35458),V=n(18787),W=n(6129),U=n(8684);const H="VIVALDI_MAIL_MESSAGES_TRASHED";const z={call:async function(e,t){const n=new Map,s=[],a=[],r=[],l=new Set,d=[],c=new Set,h=new Map;function p(e,t,s){const i=n.get(t),{id:o,accountId:a,path:r}=e,l={deleted:s,read:!0,internal:!D.Z.isOnline(a,r)||s};i?i.set(o,l):n.set(t,new Map([[o,l]]))}function u(e,t,n){const{id:s,sources:i}=e;c.add(e),i.forEach(((e,i)=>{let a=e.read?{}:{read:!0};if(t.has(i)){const e=o.Z.get(i);if(!e)throw new Error("Filter not found "+i);const{accountId:t,path:s}=e,r=!D.Z.isOnline(t,s)||n;a={...a,deleted:n,internal:r}}if(Object.keys(a).length>0){const e=h.get(s);e?e.set(i,a):h.set(s,new Map([[i,a]]))}}))}function y(e,t,n){const s=t.find((t=>{const n=e.sources.get(t);return n&&!n.internal}));if(s){const{accountId:t,path:i}=o.Z.get(s),d=[t,i,e.id];a.push({key:d,destinationPath:n});const c=e.sources.get(s);c&&!c.read&&(r.push(d),l.add(e.id))}}e.forEach((e=>{const{id:i}=e,a=t.get(i),r=new Map;a&&0!==a.length?(a.forEach((e=>{const t=o.Z.get(e),{accountId:n}=t,s=r.get(n);s?s.push(e):r.set(n,[e])})),r.forEach(((t,a)=>{const r=(0,W.ZA)(a)&&m.Z.getFoldersOfType(a,Z.uT);if(r&&r.length>0){const l=new Set;r.forEach((s=>{const{path:r}=s,c=o.Z.getByFolder(a,r),{id:h}=c,g=e.sources.get(h);if(g)if(g.internal)y(e,t,r),g.deleted&&p(c,i,!1);else if(g.deleted){const t=new Set([h]);u(e,t,!1)}else d.push(e);else!function(e,t,s){const i=n.get(t),{id:o,accountId:a,path:r}=e,l={deleted:s,internal:!D.Z.isOnline(a,r)||s,read:!0};i?i.set(o,l):n.set(t,new Map([[o,l]]))}(c,i,!1),y(e,t,r);l.add(h)}));const c=t.filter((e=>!l.has(e)));u(e,new Set(c),!0),c.forEach((t=>{const n=e.sources.get(t),r=o.Z.get(t);if(!r)throw new Error("Filter not found "+t);n.internal||s.push([a,r.path,i]),p(r,i,!0)}))}else u(e,new Set(t),!0)}))):console.warn("No deleteSourceFilterIds for id "+i)}));const C=new Set;if(n.size>0&&(C.add(f.Z.searchList),C.add(f.Z.filteringQueue),C.add(f.Z.filters)),(s.length>0||a.length>0||r.length>0)&&(C.add(f.Z.imap),C.add(f.Z.buffer)),c.size>0&&C.add(f.Z.flaggingQueue),C.size>0){const e=[];await f.Z.transaction("rw",[...C],(async()=>{if(c.size>0){const t=P.Z.setCustomFlags([...c],{},h,!1);e.push(...t)}if(n.size>0){const t=await F.Z.call(n);e.push(...t);const s=new E.R;n.forEach(((e,t)=>{const n=[...e.keys()];s.add(n,t)}));for(const{filterIds:e,searchListIds:t}of s.batches)b.Z.call({type:"RE_RUN_SLES",priority:Z.Un.HIGH,searchListIds:t,filterIds:[...e],folderIds:[[Z.of,Z.cm]]})}if(r.length>0){const e={[Z.T4.SEEN]:!0};await S.Z.addCustomFlagsImapKeys(r,e)}if(a.length>0){const e=[];for(const t of a){const{key:n,destinationPath:s}=t,[i,o,a]=n;e.push({accountId:i,path:o,searchListId:a,destinationPath:s})}await S.Z.addCopy(e)}if(s.length>0){const e=[];for(const t of s){const[n,s,i]=t;e.push({accountId:n,path:s,searchListId:i})}await S.Z.addDelete(e)}})),T.Z.filter(),v.Z.flushBuffer(),e.length>0&&i.Z.updateIndex({sleUpdates:e})}d.length>0&&(e.length===d.length?(0,U.c)({title:(0,g.Z)("Already in trash"),icon:"resources/mail_notification_icon.png",timeout:3e4,tag:H}):(0,U.c)({title:(0,g.Z)("Some were already in trash"),icon:"resources/mail_notification_icon.png",timeout:3e4,tag:H})),V.Z.push({operation:"delete",listEntries:[...e],markUnread:l})}};var G=n(307),$=n(67103),K=n(1407),j=n(49168),Y=n(81744),X=n(70752),Q=n(83065),q=n(89175),J=n(59275),ee=n(26036),te=n(19842),ne=n(86088);const se={Red:"#f01",Orange:"#f80",Yellow:"#fd0",Green:"#3c0",Blue:"#08f",Purple:"#a09",Grey:"#666"},ie=new Image;ie.src=`data:image/svg+xml;base64,${btoa(ne.nyn.medium)}`;const oe=[Z.e9,Z.Nz,Z.hn,Z.Hd,Z.uT,Z.Oi];function ae(e){const t=document.createElement("canvas");t.width=32,t.height=32;const n=t.getContext("2d");return n.drawImage(ie,0,0),n.globalCompositeOperation="source-in",n.fillStyle=se[e],n.fillRect(0,0,32,32),t.toDataURL("image/png").replace("data:image/png;base64,","")}function re(e,t){e.push(t),t.children&&t.children.forEach((t=>re(e,t)))}function le(e,t){const n=(0,te.Rr)(e);let i=[];if(!n){const e=p.Z.get(K.uP);if(!e)return i;e.selectedIds.forEach((e=>{const n=o.Z.getListEntry(e.id);n&&(t?re(i,n):i.push(n))}))}if(!i.length||n){const e=s.Z.getActiveListEntry();if(e){const t=o.Z.getListEntry(e.id);t&&(i=[t])}}return i}function de(e,t,n){const o=e.filter((e=>e&&(void 0===n||n(e)))),a=t(o);i.Z.updateIndex({sleUpdates:a});const r=s.Z.getActiveListEntry();if(r){const e=o.find((e=>e.id===r.id));e&&(r.flags=e.flags)}}function ce(e,t,n){de(le(e),t,n)}function he(e){return Boolean(c.ZP.getActivePage(e)?.isMailPage)}function pe(e){return h.Z.get(e?q.kMailDeleteInOtherLocations:q.kMailMarkDeleteInOtherLocations)}async function ue(e){let t=s.Z.getActiveMessage();if(!t)return;let n=s.Z.getRenderingMethod();"raw"===n&&(n=h.Z.get(q.kMailPreferredRendering));const i=s.Z.getRaw();if(i&&!t.bodyParts){let s=await i.parseMainPart(n);e&&(s=s.concat(await i.parseAttachments())),t={...t,bodyParts:[...s]}}return t}const ge=new class{enableThreadedView(e){if(!he(e))return;const t=le(e);t&&t.length>0&&t[0]&&i.Z.selectThread(t[0])}enableCorrespondentView(e,t){if(he(e))if(t)i.Z.selectContactByAddress(e,t);else{const t=s.Z.getActiveMessage(),n=l.Z.getSelectedFolder();if(t&&n){const s=D.Z.getFolderType(n.accountId,n.path),{from:o,to:a,cc:r,bcc:l=[]}=t,d=s===Z.Nz?a[0]||r[0]||l[0]:o[0];d&&d.address&&i.Z.selectContactByAddress(e,d.address)}}}enableContactView(e,t,n){he(e)&&(n?i.Z.selectContactByIdAndAddress(e,t,n):i.Z.selectContactById(e,t))}setActiveMailDetail(e){u.Z.dispatch({actionType:"MAIL_SET_ACTIVE_COMPONENT",mailDetail:e})}setActiveMessage(e){u.Z.dispatch({actionType:"MAIL_SET_ACTIVE_MESSAGE",message:e})}markAsReadAndGoToNextUnread(e){he(e)&&(ge.markRead(e),u.Z.dispatch({actionType:"MAIL_GOTO_UNREAD"}))}goToNextUnread(e){he(e)&&u.Z.dispatch({actionType:"MAIL_GOTO_NEXT_UNREAD"})}goToPreviousUnread(e){he(e)&&u.Z.dispatch({actionType:"MAIL_GOTO_PREVIOUS_UNREAD"})}openMessage=e=>{const t=s.Z.getActiveListEntry(),n=s.Z.getActiveMessage();if(!t||!n)return;const i=o.Z.getByIds(t.sourceFilterIds);if(i.some((e=>e.accountId===Z.of&&(e.path===Z.Wb||e.path===Z.J8))))return r.Z.open(n,t.threadKey);const a=D.Z.getFolderTypes(i),l=a.has(Z.kY);if(a.has(Z.Nz)||l)return ge.createDraft();(0,G.Z)(e,n)};clearIfActive(e){setTimeout((()=>{u.Z.dispatch({actionType:"MAIL_CLEAR_IF_ACTIVE",mailDetail:e})}),100)}refreshActiveMessage(){u.Z.dispatch({actionType:"MAIL_REFRESH_ACTIVE_MESSAGE"})}async createDraft(){const e=await ue(!0);e&&r.Z.createDraftFromParsedMessage(e)}async reply(){const e=await ue(!1);e&&await r.Z.reply(e)}async replyAll(){const e=await ue(!1);e&&await r.Z.replyToAll(e)}async replyList(){const e=await ue(!1);e&&await r.Z.replyToList(e)}async forward(){const e=await ue(!0);e&&await r.Z.forward(e)}markRead(e){he(e)&&ce(e,(e=>P.Z.setRead(e,!0)))}markUnread(e){he(e)&&ce(e,(e=>P.Z.setRead(e,!1)))}markThreadRead(e){if(!he(e))return;de(le(e,!0),(e=>P.Z.setRead(e,!0)))}markThreadUnread(e){if(!he(e))return;de(le(e,!0),(e=>P.Z.setRead(e,!1)))}markFlagged(e){ce(e,(e=>P.Z.setFlagged(e,!0)),(e=>!(0,j.u9)(e)))}markUnflagged(e){ce(e,(e=>P.Z.setFlagged(e,!1)),(e=>(0,j.u9)(e)))}setCustomFlags(e,t){ce(e,(e=>P.Z.setCustomFlags(e,t)))}async prepareDelete(e,t,n,s){const i=n||le(e);let a;if(a=t?i.some((e=>e.sources.size>1)):i.some((e=>[...e.sources.entries()].filter((([e,t])=>!x.Z.isSourceDeleted(e,t))).length>1)),a||s){const a=l.Z.getSelectedFolder();if(!a)return void console.warn("No folder selected");const{accountId:r,path:c=Z.ym,type:h}=a,p=h===Z.Nz,u=function(e){let t=0;for(const n of e)for(const[e,s]of[...n.sources.entries()]){const{accountId:n,path:i}=o.Z.get(e);D.Z.getFolderType(n,i)===Z.Nz||s.deleted||++t}return t}(i);if(p||u<=1&&!s);else{const s=o.Z.getByFolderId([r,c]),a=i.some((e=>e.sources.has(s.id))),l=pe(t);if(a){if("ask"===l)return void d.Z.showMailDeleteDialogSetting(e,{entries:i,deletePermanently:t})}else{if(n)return void d.Z.showMailDeleteDialogConfirmAll(e,{entries:i,deletePermanently:t});if(i.length>1){if(["selected","folders","ask"].includes(l))return void d.Z.showMailDeleteDialogConfirmAll(e,{entries:i,deletePermanently:t})}else{if("selected"===l)return void d.Z.showMailDeleteDialogFolders(e,{entries:i,deletePermanently:t});if(["folders","ask"].includes(l)){const n=new Set;if(i[0].sources.forEach(((e,t)=>{if(!x.Z.isSourceDeleted(t,e)){const e=N.Z.get(t);if(!e)throw new Error("Filter not found "+t);n.add(e.accountId)}})),n.size>1)return void d.Z.showMailDeleteDialogAccounts(e,{entries:i,deletePermanently:t})}}}}}await this.delete(e,i,t)}async delete(e,t,n,s={}){const{setting:i,accountIds:a,sourceFilterIds:d}=s,c=i||pe(n),h=new Map,p=l.Z.getSelectedFolder();if(!p)return void console.warn("No folder selected");const{accountId:u,path:g=Z.ym}=p,m=o.Z.getByFolderId([u,g]),v=m&&t.some((e=>e.sources.has(m.id))),f=l.Z.isSentFolderSelected();if(t.forEach((e=>{const t=[];e.sources.forEach(((e,s)=>{if(!n&&x.Z.isSourceDeleted(s,e))return void O.Z.log("Mail",["delete"],`No need to re-delete - sourceFilterId: ${s}`);if(!function(e,t,n){const{accountId:s,path:i}=o.Z.get(t),a=D.Z.getFolderType(s,i);return e.deleted||a===Z.Nz===n}(e,s,f))return void O.Z.log("Mail",["delete"],`Will not delete from sent unless Sent folder is selected - isSentSelected: ${f.toString()} - sourceFilterId: ${s}`);const i=o.Z.get(s);if(i)return a||d?a&&!a.get(i.accountId)?void O.Z.log("Mail",["delete"],`Accounts selected to delete from do not match filter - sourceFilterId: ${i.id}`):d&&!d.get(s)?void O.Z.log("Mail",["delete"],`Folders selected to delete from do not match filter - sourceFilterId: ${s}`):void t.push(s):void("selected"===c&&v?m?.id===s?t.push(s):O.Z.log("Mail",["delete"],`filter not found - selectedFilter: ${m?m.id:"undefined"} - sourceFilterId: ${s}`):"folders"===c&&v?i.accountId===u?t.push(s):O.Z.log("Mail",["delete"],`filter not found -  source accountId: ${i.accountId} - selected accountId: ${u} - sourceFilterId: ${s}`):t.push(s));O.Z.log("Mail",["delete"],`sourceFilter not found! sourceFilterId: ${s}`)})),t.length>0&&h.set(e.id,t)})),0===h.size)return void O.Z.log("Mail",["delete"],"Nothing to delete");const y=t.filter((e=>h.has(e.id)));y.forEach((t=>{r.Z.closeComposer(e,t.id)})),y.length>0&&(n?M.call(y,h):z.call(y,h))}undelete(e){const t=le(e);(0,$.Z)(t)}getMoveToFolderMenu=e=>{const t=le(e),n=t.map((e=>{const t=[];return e.sources.forEach(((e,n)=>{e.deleted||t.push(n)})),t}));if(0===n.length)return[];const s=n.reduce(((e,t)=>e.filter((e=>t.includes(e))))),i=[];if(o.Z.getByIds(s).forEach((e=>{const{accountId:t,path:n}=e,s=D.Z.getFolderType(t,n);m.Z.isMailAccount(t)&&oe.includes(s)&&i.push([t,n])})),0===i.length){return[{...1===t.length?(0,ee.Z)("Can not move from this folder."):(0,ee.Z)("No common folder. Can not move this selection."),isEnabled:()=>!1,mnemonic:!1}]}const a=m.Z.getAccounts(),r=[];return i.forEach((([n,s])=>{const i=m.Z.getFolderName(n,s);let o=[];for(const e of oe)o.push(...D.Z.getPathsByType(n,e));if(o=o.filter((e=>e!==s)),o.length>0){const l=o.map((i=>{const o=(0,Q.kF)(i);return{handler:()=>(0,B.Z)(e,t,[{accountId:n,path:s}],n,i),label:(0,J.e)(o),labelEnglish:o}})),d=[];for(const i in a)if(i!==n){const o=a[i].folders;for(const a in o)for(const r of o[a].sort(((e,t)=>e.name.localeCompare(t.name)))){const o=r.path;if(oe.includes(a)){const a=m.Z.getFolderName(i,o);d.push({handler:()=>(0,B.Z)(e,t,[{accountId:n,path:s}],i,o),label:`${i}/${(0,J.e)(a)}`,labelEnglish:`${i}/${a}`})}}}if(1===Object.entries(a).length)r.push(...l);else{const e=l.concat(d);r.push({items:e,label:(0,g.Z)("Move from $1 to",[n+"/"+(0,J.e)(i)]),labelEnglish:`Move from ${n}/${i} to ...`})}}})),r};getCustomLabelsMenu=(e,t)=>{const n=o.Z.getByAccountId(Z.ut).sort(j.jp),s=[];let i=!1;return n.forEach((n=>{!i&&n.path.startsWith("$labelviv")&&s.length>0&&(s.push({type:"separator",label:"",labelEnglish:""}),i=!0),s.push({type:"checkbox",checked:t.indexOf(n.path)>-1,handler:this.toggleLabel(e,n.path,t),...(0,ee.Z)((0,Y.X)(n.name))})})),s};clearAllLabels=(e,t)=>{const n=Object.fromEntries(t.map((e=>[e,!1])));this.setCustomFlags(e,n)};toggleLabel=(e,t,n)=>()=>{const s=-1===n.indexOf(t);this.setCustomFlags(e,{[t]:s})};setLabel=(e,t)=>{this.setCustomFlags(e,{[t]:!0})};setLabels=(e,t)=>{this.setCustomFlags(e,t)};getReplyMenu=()=>[{type:"command",handler:()=>this.replyList(),label:(0,g.Z)("Reply to Mailing List"),labelEnglish:"Reply to Mailing List"},{type:"command",handler:()=>this.replyAll(),label:(0,g.Z)("Reply All"),labelEnglish:"Reply All"}];getStandardFlagsMenu=(e,t)=>{const n=[];for(const s of P.Z.getStandardFlagList()){let i=ae(s);s===Z.T4.CLEAR_FLAGS&&(n.push({type:"separator",label:"",labelEnglish:""}),i=void 0),n.push({type:"checkbox",checked:s===t,handler:()=>this.toggleStandardFlag(e,s,t),label:(0,X.M)(s),labelEnglish:s,iconPNG:i,iconPNGWhite:i})}return n};toggleStandardFlag=(e,t,n)=>{const s=n===t?(0,j.KR)(Z.T4.CLEAR_FLAGS):(0,j.KR)(t);this.setCustomFlags(e,s)};async _updateFlags(e,t){const n=e.map((e=>({searchListId:e.id})));await R.Z.call(n,t),e.forEach((e=>{const n=(0,j.hY)(e.flags,t);i.Z.updateIndex({sleUpdates:[{id:e.id,updates:{flags:n}}]})}));const s=e.map((e=>e.id));await L.Z.call(s,t)}setStandardFlag=(e,t)=>{const n=(0,j.KR)(t);this.setCustomFlags(e,n)};async markAsJunk(e){const t=le(e);await a.Z.moveToJunk(t)}async markAsNotJunk(e){const t=le(e);await a.Z.restoreFromJunk(t)}async clearJunkFlags(e,t,n){const s=n?t:t.filter((e=>[...e.flags].some((e=>e===Z.T4.JUNK)))),i={[Z.T4.JUNK]:!1,[Z.T4.NOT_JUNK]:!0,Junk:!1};s.length>0&&await this._updateFlags(s,i)}async clearDeletedFlags(e,t){const n=t.filter((e=>[...e.flags].some((e=>e===Z.T4.DELETED)))),s={[Z.T4.DELETED]:!1};n.length>0&&await this._updateFlags(n,s)}moveToArchive(e){const t=le(e);a.Z.moveToArchive(t)}restoreFromArchive(e){const t=le(e);a.Z.restoreFromArchive(t)}},me=ge},48603:(e,t,n)=>{"use strict";n.d(t,{Z:()=>K});var s=n(27770),i=n(68247),o=n(29087),a=n(16920),r=n(92292),l=n(7064),d=n(89175);const c="[bookmark update]",h=function(){return new Promise((e=>{l.Z.bookmarksPrivate.updatePartners(((t,n,s)=>{r.Z.runtime.lastError&&(console.warn(c,"failed to call vivaldi.bookmarksPrivate.updatePartners:",r.Z.runtime.lastError.message),t=!1,n=!1),e([t,n,s])}))}))},p=function(e){const t=function(e,n){for(let s=0;s<e.length;s++){const i=e[s];i.url&&(i.partner?console.warn(c,"partner id in bookmark tree without version:",i.partner,i.url):n.set(i.url,i.id)),i.children&&t(i.children,n)}};return Promise.all([new Promise((e=>{r.Z.bookmarks.getTree((t=>{r.Z.runtime.lastError&&console.warn(c,"failed to call chrome.bookmarks.getTree:",r.Z.runtime.lastError.message),e(t)}))})).then((e=>{const n=new Map;return e&&t(e,n),n})),fetch("./default-bookmarks/fallback-partner-ids.json",{method:"GET"}).then((e=>e.json())).then((t=>{let n=t[e];return n||(n=t[a.Z.getFallbackLocale()]),n}))]).then((([e,t])=>{const n={numMatch:0,size:0};return t?Promise.all(function*(e,t,n){const s=Object.keys(t);e:for(const i of s){const s=t[i];n.size+=1;for(const t of s){const s=e.get(t);if(s){console.warn(c,"Match",i,t),n.numMatch+=1,yield new Promise((e=>{r.Z.bookmarks.update(s,{partner:i},(()=>{r.Z.runtime.lastError&&console.warn(c,"failed to update partner:",i,r.Z.runtime.lastError.message),e()}))}));continue e}}console.warn(c,"No match for",i,s.join(" "))}}(e,t,n)).then((()=>n)):n})).then((e=>{console.warn(c,"Urls matched",e.numMatch,"of",e.size)}))},u={init:()=>h().then((([e,t,n])=>t?p(n).then((()=>(i.Z.set(d.kBookmarksVersion,"0"),h().then((([e])=>e))))):e)).catch((e=>(console.warn(c,"error while updating bookmarks:",e),!1))).then((e=>(e||console.warn(c,"failed to update bookmarks, current version:",o.Z.get(d.kBookmarksVersion)),e)))};var g=n(59486),m=n(96951),v=n(33638),f=n(15489),y=n(56371),C=n(28773),w=n(30381),b=n.n(w),S=n(35369),I=n(30460),k=n(44850),A=n(60842),T=n(53576);let Z=!0,E=!0;var _=new Map;function M(){Z=!0}function N(){Z=!1,x()}function P(){v.Z.dispatch({actionType:"BOOKMARKS_SET_BATCH_MODE",edit:!0})}function D(){v.Z.dispatch({actionType:"BOOKMARKS_SET_BATCH_MODE",edit:!1})}function x(e=!1){const t=r.Z.bookmarks.getTree(),n=fetch("./default-bookmarks/partners.json").then((e=>e.json())).catch((()=>(console.warn("Failed to load partner bookmarks"),{bookmarks:[],folders:[]})));return Promise.all([t,n]).then((([t,n])=>{v.Z.dispatch({actionType:"BOOKMARKS_INIT",bookmarks:t,failedUpgrade:e,partnerDB:n})}))}function O(e,t){Z||v.Z.dispatch({actionType:"BOOKMARKS_ADD_ITEM",id:e,changes:t})}function L(e,t){Z||v.Z.dispatch({actionType:"BOOKMARKS_CHANGE_ITEM",id:e,changes:t})}function R(e,t){Z||v.Z.dispatch({actionType:"BOOKMARKS_MOVE_ITEM",id:e,changes:t})}function B(e){v.Z.dispatch({actionType:"BOOKMARKS_REMOVE_ITEM",id:e})}function F(e,t){Z||x()}function V(e,t){if(Z)return;g.ZP.getItemById(e)&&v.Z.dispatch({actionType:"BOOKMARKS_CHANGE_ITEM",id:e,changes:{faviconUrl:t}})}function W(e,t){Z||v.Z.dispatch({actionType:"BOOKMARKS_CHANGE_ITEM",id:e,changes:t})}function U(){!1===E&&(E=!0,l.Z.bookmarksPrivate.onFaviconChanged.removeListener(V))}function H(){!0===E&&(E=!1,l.Z.bookmarksPrivate.onFaviconChanged.addListener(V))}async function z(e){const t=m.ZP.getTabsForPages(e.pages,!1).map((e=>({page:"group"===e.type?void 0:e.page,url:"group"===e.type?void 0:e.page.url,title:"group"===e.type?(0,A.aD)(e.id,(0,y.Z)("Stack")):(0,k.D1)(e.page),children:"group"===e.type?e.pages.map((e=>({page:e,url:e.url,title:(0,k.D1)(e)}))).toArray():void 0}))).filter((e=>e.children||e.url));if(!t.size)return;const{parentId:n,index:s}=e;if(1!==t.size||e.forceFolder){if(e.isStack){return await Promise.all(t.map((async({children:e,title:t})=>{if(!e?.length)return;const s=await r.Z.bookmarks.create({parentId:n,title:t});return await $.createBookmarks(e,s.id,0,"none"),s.id}))).then((e=>e.filter(Boolean)[0]))}{const i={parentId:n,..."number"==typeof s?{index:s}:null},o=await r.Z.bookmarks.create(i),a=b()(o.dateAdded).format("YYYY-MM-DD, HH:mm:ss"),l=e.isSelection?(0,y.Z)("Saved Tab Selection ($1)",[a]):(0,y.Z)("Saved Tabs ($1)",[a]);return await r.Z.bookmarks.update(o.id,{title:l}),await Promise.all(t.map((async e=>{const{children:t,title:n,url:s}=e;if(t?.length){const e=await r.Z.bookmarks.create({parentId:o.id,title:n});await $.createBookmarks(t,e.id,0,"none")}else await r.Z.bookmarks.create({parentId:o.id,title:n,url:s})}))),o.id}}{const{children:e,title:i,page:o}=t.first();if(e?.length){const t={parentId:n,title:i,..."number"==typeof s?{index:s}:null},o=await r.Z.bookmarks.create(t);return await $.createBookmarks(e,o.id,0,"none"),o.id}return o&&!e?$.bookmarkPageInFolder(o,n,s):void 0}}function G({clipboardData:e},t,n){e&&(t=g.ZP.validateForClipboard(t),e.setData("vivaldi/x-cut",n),e.setData(s.yR,JSON.stringify(t)),e.setData("text/plain",g.ZP.getDragData("text/plain",t)))}const $=new class{loadPromise(){return u.init().then((e=>x(!e))).then((()=>{Z=!1,E=!1,r.Z.bookmarks.onImportBegan.addListener(M),r.Z.bookmarks.onImportEnded.addListener(N),r.Z.bookmarks.onChanged.addListener(L),r.Z.bookmarks.onCreated.addListener(O),r.Z.bookmarks.onRemoved.addListener(B),r.Z.bookmarks.onMoved.addListener(R),r.Z.bookmarks.onChildrenReordered.addListener(F),l.Z.bookmarkContextMenu.onOpen.addListener(U),l.Z.bookmarkContextMenu.onClose.addListener(H),l.Z.menubarMenu.onOpen.addListener(U),l.Z.menubarMenu.onClose.addListener(H),l.Z.bookmarksPrivate.onFaviconChanged.addListener(V),l.Z.bookmarksPrivate.onMetaInfoChanged.addListener(W)}))}setBookmarkBarFolderAndToggleVisibility(e){const t=g.ZP.getBookmarkBarFolderId()!==e||!o.Z.get(d.kBookmarksBarVisible);return $.setBookmarkBarFolder(e).then((e=>{e&&i.Z.set(d.kBookmarksBarVisible,t)}))}setBookmarkBarFolderAndShow(e){return $.setBookmarkBarFolder(e).then((e=>{e&&i.Z.set(d.kBookmarksBarVisible,!0)}))}async setBookmarkBarFolder(e){const t=g.ZP.getItemById(e);if(!t||!g.ZP.isFolder(t))return!1;const n=g.ZP.getBookmarkBarFolderId();if(n===e)return!0;P();try{n!==g.SZ&&await r.Z.bookmarks.update(n,{bookmarkbar:!1}),await r.Z.bookmarks.update(e,{bookmarkbar:!0})}catch(e){console.warn(`BookmarkActions: Failed to set bookmark bar folder: ${e}`)}finally{D()}return!0}toggleSpeeddialFolder(e){const t=g.ZP.getItemById(e);t&&g.ZP.isFolder(t)&&r.Z.bookmarks.update(t.id,{speeddial:!t.speeddial})}setCutIds(e){v.Z.dispatch({actionType:"BOOKMARKS_SET_CUT_IDS",ids:e})}async move(e,t,n){const s=g.ZP.validateForDrag(e).map((e=>g.ZP.getItemById(e)?.id)).filter(Boolean);P();const i=await function(e,{parentId:t,index:n}){return e.reduce((async(e,s)=>{const i=await e,o=i[i.length-1]?.index,a=await r.Z.bookmarks.move(s,{parentId:t,index:void 0!==o?o+1:n});return i.push(a),Promise.resolve(i)}),Promise.resolve([]))}(s,{parentId:t,index:n});return D(),i.map((e=>e.id))}reorder(e,t){return e=g.ZP.validateForDrag(e),P(),Promise.all(e.reverse().map((e=>r.Z.bookmarks.move(e,{parentId:t,index:0}).then((e=>e.id))))).then((e=>(D(),e)))}async duplicate(e,t,n){const s=structuredClone(e.map((e=>g.ZP.getItemById(e))).filter((e=>e&&!e.trash)).filter(Boolean));P();const i=await Promise.all(s.map((async e=>{const{title:s,url:i,description:o,nickname:a,children:l}=e,d=await r.Z.bookmarks.create({index:n++,parentId:t,title:s,...(0,C.Z)(i?{url:i}:null),...(0,C.Z)(o?{description:o}:null),...(0,C.Z)(a?{nickname:a}:null)});if(!d)throw new Error("Bookmark was not created");if(l?.length){const e=l.map((({id:e})=>e));await this.duplicate(e,d.id,0)}return d.id})));return D(),i}async createWithPromise(e,t,n){P();const s=await((e,t,n)=>Promise.all(e.map((async e=>{if(e.separator)return this.createSeparator(t,void 0===n?void 0:n++);const s=await r.Z.bookmarks.create({title:e.title,url:e.url||(e.children?null:I.p),parentId:t,description:e.description||null,nickname:e.nickname||null,index:void 0===n?void 0:n++});return e.children?.length?await $.createWithPromise(e.children,s.id,0):s}))))(e,t,n);return D(),s}createSeparator(e,t){return r.Z.bookmarks.create({title:"---",url:I.p,parentId:e,description:"separator",nickname:"",index:t})}async createBookmarks(e,t,n,s){if(P(),"none"!==s){const e={parentId:t,..."number"==typeof n?{index:n}:null},i=await r.Z.bookmarks.create(e),o=b()(i.dateAdded).format("YYYY-MM-DD, HH:mm:ss");let a;switch(s){case"history":a=(0,y.Z)("Saved History ($1)",[o]);break;case"sync":a=(0,y.Z)("Saved Synced Tabs ($1)",[o])}a&&await r.Z.bookmarks.update(i.id,{title:a}),t=i.id}const i=await Promise.all(e.map((({url:e,title:s})=>r.Z.bookmarks.create({parentId:t,url:e,title:s,index:n++}).then((({id:e})=>e)))));return D(),i}remove(e=[]){return P(),Promise.all(e.map((e=>{if(_.get(e))return _.get(e);const t=g.ZP.getItemById(e);return t&&g.ZP.isFolder(t)&&t.id===o.Z.get(d.kBookmarksSaveFolder)&&i.Z.set(d.kBookmarksSaveFolder,g.SZ),t&&g.ZP.isFolder(t)?r.Z.bookmarks.removeTree(e).catch((()=>console.warn(`Error removing bookmark tree: ${e}`))).then((()=>_.delete(e))):r.Z.bookmarks.remove(e).catch((()=>console.warn(`Error removing bookmark: ${e}`))).then((()=>_.delete(e)))}))).then((()=>D()))}async emptyTrash(){!1===await new Promise((e=>{l.Z.bookmarksPrivate.emptyTrash(e),l.Z.utilities.cleanUnusedImages(0)}))&&console.warn("Empty trash failed.")}bookmarkAllOpenPages(e,t,n){const s=f.ZP.getActiveWorkspace(e);return z({pages:m.ZP.getPages(e,{workspaceId:s}),parentId:t,index:n,isStack:!1,isSelection:!1,forceFolder:!0})}bookmarkPages(e,t,n,s){return z({pages:(0,T.nq)(e)?e:S.aV.of(e),parentId:n,index:s,isStack:t,isSelection:!0,forceFolder:(0,T.nq)(e)})}async bookmarkPageInFolder(e,t=g.ZP.getRootNode().id,n){const{url:s}=e,i=(0,k.D1)(e),{id:o}=await r.Z.bookmarks.create({parentId:t,url:s,title:i,..."number"==typeof n?{index:n}:null});return o}cut(e,t){G(e,t,"true"),$.setCutIds(t),e.stopPropagation(),e.preventDefault()}copy(e,t){G(e,t,"false"),e.stopPropagation(),e.preventDefault()}paste({clipboardData:e},t,n){const i=g.ZP.getItemById(t);if(!i||!e)return Promise.resolve({isCut:!1,ids:[]});let o,a;if(g.ZP.isFolder(i))o=i.id,!0===n&&i.children?(a=i.children.length,a>0&&i.children[a-1].trash&&a--):a=0;else if(o=i.parentId,a=(i.index||0)+1,void 0===o)return console.log("error","Can not paste, target has no parent"),Promise.resolve({isCut:!1,ids:[]});const r=-1!==e.types.findIndex((e=>e===s.yR))?JSON.parse(e.getData(s.yR)):[];if(0===r.length)return Promise.resolve({isCut:!1,ids:[]});return g.ZP.getCutIds().length>0&&"true"===e.getData("vivaldi/x-cut")?$.move(r,o,a).then((e=>($.setCutIds([]),{isCut:!0,ids:e}))):$.duplicate(r,o,a).then((e=>({isCut:!1,ids:e})))}async onDropEvent(e,t,n,i){if(e.dataTransfer.types.includes(s.yR)){const o=JSON.parse(e.nativeEvent.dataTransfer.getData(s.yR));s.ZP.isCopyModifierPressed(e)||i&&i.disableMove?await $.duplicate(o,t,n):await $.move(o,t,n)}else{const i=await s.ZP.getUrlsFromEventPromise(e,!0);await $.createBookmarks(i,t,n,"none")}}},K=$},15590:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var s=n(27508),i=n(53576),o=n(33638),a=n(92292);const r={toggleBreakMode:async function(e){const t=!s.Z.getState().isActive;await async function(e,t){const n=t?"mute":"unmute";t&&o.Z.dispatch({actionType:"TOOLTIP_SET",id:null});await i.ZP.setMuting(e,"all",n),o.Z.dispatch({actionType:"BREAKMODE",isActive:t});const s=await a.Z.tabs.query({});await Promise.all(s.map((async e=>{await new Promise((n=>{if(!(e.id&&e.id>=0))return n();a.Z.tabs.sendMessage(e.id,{breakmode:t},n)}))})))}(e,t)}}},2934:(e,t,n)=>{"use strict";n.d(t,{z:()=>R,Z:()=>z});var s=n(50522),i=n(48735),o=n(12442),a=n(15800),r=n(34930),l=n(46382),d=n(33499),c=n(17673),h=n(68247),p=n(29087),u=n(60331),g=n(33638),m=n(15489),v=n(56371),f=n(92292),y=n(98035),C=n(45660),w=n(28773),b=n(80008),S=n.n(b),I=n(41851),k=n(7064),A=n(89175);const T={1:[{name:(0,v.Z)("One hour meeting"),ical:"BEGIN:VCALENDAR\nBEGIN:VEVENT\nUID:X-VIV-TEMPLATE-1\nDURATION:PT1H\nBEGIN:VALARM\nACTION:DISPLAY\nDESCRIPTION:\nTRIGGER:-PT15M\nEND:VALARM\nEND:VEVENT\nEND:VCALENDAR\n"},{name:(0,v.Z)("Doctor's appointment"),ical:"BEGIN:VCALENDAR\nBEGIN:VEVENT\nUID:X-VIV-TEMPLATE-2\nDURATION:PT15M\nBEGIN:VALARM\nACTION:DISPLAY\nDESCRIPTION:\nTRIGGER:-PT24H\nEND:VALARM\nEND:VEVENT\nEND:VCALENDAR\n"},{name:(0,v.Z)("calendar","Birthday"),ical:"BEGIN:VCALENDAR\nBEGIN:VEVENT\nUID:X-VIV-TEMPLATE-3\nX-VIV-ALLDAY:TRUE\nRRULE:FREQ=YEARLY;INTERVAL=1\nBEGIN:VALARM\nACTION:DISPLAY\nDESCRIPTION:\nTRIGGER:PT7H\nEND:VALARM\nEND:VEVENT\nEND:VCALENDAR\n"}]};var Z=n(24522),E=n(87852),_=n(47543),M=n(90870),N=n(13289),P=n(58821),D=n(34155);const{getPollResultText:x,validateEventTypes:O,getGeneratedSourceEvent:L}=a.Z,R=new Set(S().tz.names());const B=()=>({title:(0,v.Z)("Change External Event"),body:(0,v.Z)("You’re changing an external event. Changes you make will only show locally and may be overwritten by changes from event organiser."),actions:[{title:(0,v.Z)("Apply Change"),action:"confirm"}],cancelAction:{title:(0,v.Z)("Cancel"),action:"cancel",default:!0}}),F=e=>{let t="",n="";switch(e){case"save":t=(0,v.Z)("Change Recurring Event"),n=(0,v.Z)("You’re changing a repeating event. Do you want to change this occurrence only, this and upcoming events or change all events from start?");break;case"trash":t=(0,v.Z)("Delete Recurring Event"),n=(0,v.Z)("You’re deleting a repeating event. Do you want to delete this occurrence only, this and upcoming events or delete all events from start?");break;case"move":t=(0,v.Z)("Reschedule Recurring Event"),n=(0,v.Z)("You’re rescheduling a repeating event. Do you want to change this occurrence only, this and upcoming events or reschedule all events from start by same amount?");break;case"copy":t=(0,v.Z)("Copy Recurring Event"),n=(0,v.Z)("You’re copying a repeating event. Do you want to copy this occurrence only, this and upcoming events or copy all events from start?")}return{title:t,body:n,actions:[{title:(0,v.Z)("Only this Event"),action:"single",default:!0},{title:(0,v.Z)("This and Upcoming"),action:"upcoming"},{title:(0,v.Z)("All Events"),action:"all"}],cancelAction:{title:(0,v.Z)("Cancel"),action:"cancel"}}};function V(e,t){const n={start:0,end:0},s=S()(t.start),i=t.end&&S()(t.end);return e.task?i?t.byDateOnly?(n.start=e.start?S()(e.start).year(s.year()).month(s.month()).date(s.date()).valueOf():t.start,n.end=e.end?S()(e.end).year(i.year()).month(i.month()).date(i.date()).valueOf():t.end||0):(n.start=t.start,n.end=t.end||0):(t.byDateOnly?n.end=e.end?S()(e.end).year(s.year()).month(s.month()).date(s.date()).valueOf():t.start:n.end=t.start,n.start=e.start&&e.end?n.end-(e.end-e.start):0):t.byDateOnly?(n.start=S()(e.start).year(s.year()).month(s.month()).date(s.date()).valueOf(),n.end=i?S()(e.end).year(i.year()).month(i.month()).date(i.date()).valueOf():e.end?n.start+e.end-e.start:0):(n.start=t.start,n.end=t.end||(e.end?n.start+e.end-e.start:0)),t.hasOwnProperty("allDay")&&(n.allDay=t.allDay),n}function W(e,t=!0){return t&&a.Z.isCalDAV(a.Z.getAccountAndCalendar(e.calendarId)?.account?.account_type)}function U(e,t,n){n===A.kMailIsTurnedOff&&(t?H.stopAPIChangeListeners():H.startAPIChangeListeners())}const H=new class{#e=!1;async loadEvents(){return H.transformVivaldiEvents(await k.Z.calendar.getAllEvents())}async loadDatabase(){if(!p.Z.get(A.kMailIsTurnedOff)){const[e,t,n]=await Promise.all([k.Z.calendar.getAllAccounts(),H.loadEvents(),k.Z.calendar.getAll(),d.ZP.loadNotifications()]);g.Z.dispatch({actionType:"CALENDAR_INIT",accounts:e,events:t,calendars:n})}}async loadTemplates(){const e=await I.Z.loadTemplatesList();g.Z.dispatch({actionType:"CALENDAR_INIT_TEMPLATES",templates:e})}async loadPromise(){this.loadDatabase(),this.loadTemplates()}transformVivaldiEvents(e){const t=(0,P.EP)()||"",n=S().tz.zone(t);return e.map((e=>{const{start:s,end:i,attachment:o,...r}=e;let l=0,d=0;e.timezone===Z.$T||e.allDay?n&&(l=n.utcOffset(s||0)*Z.lb,d=n.utcOffset(i||0)*Z.lb):e.timezone&&R.has(e.timezone)||(r.timezone=t);const c=s?s+l:0;return{...r,start:c,end:i?i+d:c,attachment:a.Z.stringToAttachments(o)}}))}async createException(e,t,n,s){const i=await k.Z.calendar.createEventException(e,t,n,s);return H.transformVivaldiEvents([i])[0]}async trimExceptions(e,t){const n=e.recurrenceExceptions;if(!n)return;let s=0;e.start&&t.start?s=e.start-t.start:e.end&&t.end&&(s=e.end-t.end);const i=e.start??0;let o=-1/0;const a=(0,_.Qj)(e.rrule);a&&(o=a.options.until?a.options.until.valueOf():a.options.count?a.all().pop().valueOf():1/0);for(const t of n){const{date:n,exception_id:a,parent_event_id:r}=t;a&&n&&r===e.id&&(n+s<i||n+s>o)&&await k.Z.calendar.deleteEventException(a)}}updateEditState(e,t,n){g.Z.dispatch({actionType:"CALENDAR_EVENT_EDIT",edit:{windowId:e,pageId:t,eventId:n}})}async createEventTemplate(e){const t=await I.Z.saveTemplate("",e);g.Z.dispatch({actionType:"CALENDAR_ADD_TEMPLATE",template:t})}async updateTemplate(e,t){const n=await I.Z.saveTemplate(e,t);g.Z.dispatch({actionType:"CALENDAR_UPDATE_TEMPLATE",templateId:e,template:n})}async removeTemplate(e){await I.Z.deleteTemplate(e),g.Z.dispatch({actionType:"CALENDAR_REMOVE_TEMPLATE",templateId:e})}async createEvent(e,t=!0){const n=(0,P.sG)(e),o=s.Z.getCalendars().find((e=>e.id===n.calendarId));if(!o)throw"Can not create event, calendar not found";o.hidden&&H.updateCalendar(o.id,{hidden:!1}),n.syncPending=W(n,t);const a=(0,_.jw)(n.rrule,n.timezone);a&&(n.end_recurring=a);const r=await y.Z.createEvent(n);return r.syncPending&&i.Z.createEvent(r),d.ZP.updateAlarmsForEvent(r),r}createEvents(e){if(!e.length)return Promise.resolve({created_count:0,failed_count:0});const t=e.map((e=>{const{exceptionEvents:t,...n}=e;return{...n,syncPending:!1}})).map(P.sG);return y.Z.createEvents(t)}eventToCreateDetails(e){const{alarmId:t,id:n,recurrenceExceptions:s,trash:i,trash_time:o,notifications:r,filteredOut:l,invites:d,attachment:c,recurrenceId:h,...p}=e,u={...p,attachment:a.Z.attachmentsToString(c),is_template:!1};return u.timezone=u.timezone||(0,P.EP)(),u.notifications=r?.map((e=>({name:e.name,when:e.when}))),u.invites=d?.map((e=>({address:e.address,name:e.name||"",partstat:e.partstat||"NEEDS-ACTION"}))),u}async updateEvent(e,t,n=!1,o){const l={...e};async function h(e){let t=parseInt(l.id.split(":")[1]);e.start&&!l.start?t+=e.end-e.start:!e.start&&l.start&&(t-=l.end-l.start);let n=0,s=l.rrule??"",i=e.recurrenceExceptions;const o=(0,_.Qj)(s),a=(0,_.jw)(s,l.timezone),r=l.start||l.end;if(o&&t!==r){n=r-t;const a=(0,_.EE)(o?.origOptions,n);s=(0,_.Ns)({...a,...(0,w.Z)(a.dtstart?{dtstart:new Date((0,P.FL)(a.dtstart).valueOf()+n)}:null)}),e.recurrenceExceptions?.length&&(i=e.recurrenceExceptions.map((e=>({...e,date:(e.date??0)+n}))))}let d,c;l.task?(c=e.end+n,d=l.start?c-(l.end-l.start):0):(d=e.start+m,c=d+l.end-l.start);const h={...l,uid:e.uid,id:e.id,start:d,end:c,rrule:s,end_recurring:a,recurrenceExceptions:i};return await H.trimExceptions(h,e),h}let p,u=(0,P.sG)(l);u.id=u.id.split("-")[0],u.syncPending||(u.syncPending=W(u,n));const g=parseInt(u.id.split(":")[1]),m=l.start-g;if(a.Z.isGeneratedRecurringEvent(l)){const e=u.id.split(":")[0],s=a.Z.getGeneratedSourceEvent(l);switch(t){case"single":if(a.Z.getBaseEventIfException(u)){const e=s.recurrenceExceptions?.find((e=>e.date===u.recurrenceId))?.exception_event_id;if(!e)throw new Error("Could not find exception event id");u.id=e,u.rrule="",u.recurrenceExceptions=[],p=await y.Z.updateEvent(u),d.ZP.updateAlarmsForEvent(p),u=s}else{const t=H.eventToCreateDetails({...l,calendarId:l.calendarId,start:l.start,sequence:0,rrule:""});p=await H.createEvent(t,!1),u=await H.createException(e,p.id,!1,g)}p.recurrenceId=g;break;case"upcoming":if(!g||!s)throw new Error(`Invalid event id to update, ${u.id}`);const{rrule:t}=s,o=new Date(g),r=(0,_.Qj)(t,s.start,s.timezone);if(!r)throw new Error(`No recurrence on event to update, ${u.id}`);const c=(0,_._v)(r,o,u.timezone);if(!c){u=await h(s);break}const{origOptions:v}=r;let f;if(v.dtstart=v.dtstart&&(0,P.FL)(v.dtstart),v.until=v.until&&(0,P.FL)(v.until),u.rrule){const{rrule:e,start:t,timezone:n}=u;f=(0,_.Qj)(e,t,n)?.origOptions,m&&(f=(0,_.EE)(f,m))}const C=(0,_.Zm)({...v,until:c});let w,b;const S=v.count;if(S){const e=C.all().length;w=(0,_.Ns)({...v,count:e});const t=S-e;b=f&&(0,_.Ns)({...f,count:t,dtstart:o})}else w=(0,_.Ns)({...v,until:c}),b=f&&(0,_.Ns)({...f,dtstart:o});const I=u.recurrenceExceptions?.length?u.recurrenceExceptions.filter((e=>(e.date??0)>=g)):[],k=await y.Z.updateEvent({...s,rrule:w});a.Z.isRemoteCalendar(k.calendarId)&&n&&i.Z.updateEvent(k),d.ZP.updateAlarmsForEvent(k),u.uid=crypto.randomUUID(),u.href="",u.etag="",u.trash||(u.rrule=b,u=await H.createEvent(H.eventToCreateDetails(u)));const A=await y.Z.updateExceptions(I.map((e=>({exception_id:e.exception_id,parent_event_id:u.id,date:(e.date??0)+m}))));return A&&(u=A),await this.trimExceptions(u,l),u;default:if(!s)throw new Error(`Source event for ${l.id} not found`);u=await h(s)}}const v=s.Z.getEvents().find((e=>e.id===u.id)),f=a.Z.isOwnEvent(u),C=a.Z.shouldIncrementSequence(u,v);if(f&&C){const{sequence:e}=u;u.sequence=e?e+1:1}let b=[];if(u.trash||(!function(e){const t=e.notifications||[];if(!e.id)throw new Error("Can not save event reminders, invalid event Id.");const[n,s]=(0,M.Z)(t,(e=>!e.id)),i=c.Z.getState().notifications.filter((t=>t.event_id===e.id)),o=i.filter((e=>!s.some((t=>t.id===e.id))));n.filter((e=>!i.some((t=>e.when===t.when)))).forEach((t=>{d.ZP.createNotification({event_id:e.id,when:t.when,period:t.period||0,delay:t.delay||0,name:t.name||"",description:t.description||""},e)})),s.forEach((t=>{d.ZP.updateNotification(t,e)})),o.forEach((e=>{d.ZP.deleteNotification(e)}))}(u),(C||v?.title!==u.title||v?.description!==u.description||v?.location!==u.location)&&(b=function(e,t,n,s=!1,i){if(!(t.invites&&0!==t.invites.length||n?.invites&&0!==n.invites.length))return[];if(!t.invites||!e)throw new Error("Missing invites from draft or invalid event Id");const o=n?.invites??[],r=(0,N.Z)(t.invites,o,"address"),l=(0,N.Z)(o,t.invites,"address"),d=(0,N.Z)(o,l,"address");if(r.forEach((t=>{k.Z.calendar.createInvite({event_id:e,name:t.name||"",address:t.address,partstat:t.partstat})})),d.forEach((e=>{const n=t.invites&&t.invites.find((t=>t.address===e.address));n&&k.Z.calendar.updateInvite({id:e.id,address:n.address,name:n.name,partstat:n.partstat})})),l.forEach((e=>k.Z.calendar.deleteInvite(e.id))),a.Z.isOwnEvent(t)){const e=[];return r.length&&e.push(["create",r]),s&&d.length&&e.push(["update",d]),l.length&&e.push(["cancel",l]),e}return[]}(u.id,u,v,!0))),n&&(v&&v.calendarId!==u.calendarId?(a.Z.isRemoteCalendar(v.calendarId)&&i.Z.deleteEvent(v.id),a.Z.isRemoteCalendar(u.calendarId)&&i.Z.createEvent(i.Z.resetEventRemoteData(u))):a.Z.isRemoteCalendar(u.calendarId)&&i.Z.updateEvent(u,p)),u.recurrenceExceptions?.length&&m)for(const e of u.recurrenceExceptions){if(!e.exception_id)throw Error("Inconsistent data. Exception missing ID.");await k.Z.calendar.updateRecurrenceException(e.exception_id,{date:e.date})}const S=await y.Z.updateEvent(u);return b.length&&await r.Z.sendAttendeeMails(o,S,b),S}showAddEvent(e,t,n){H.addEventCommand(e,a.Z.minimalCreateEvent({title:t,url:n}))}async addEventCommand(e,t){t.task||t.start||(t.start=(0,P.zX)(Date.now())),t.url?.startsWith("data:")&&(t.url=""),H.updateEditState(e,E.W$,""),l.Z.showCalendarEditEvent(e,t)}async pollAllCalDAVAccountsWithStatus(){const e=await H.pollAllCalDAVAccounts();u.Z.setStatus(m.Ex,x(e),6e3)}async pollAllCalDAVAccounts(e){const t=s.Z.getState().accounts.filter((e=>e.url)).map((e=>e.id)),n={didPoll:!1,calendars:[],message:"",error:!1};if(0===t.length)return n.didPoll=!0,n;const o=s.Z.getState().calendars.filter((e=>t.some((t=>t===e.accountId)))).filter((e=>e.active)).map((e=>e.lastChecked)).filter(Boolean).reduce(((e,t)=>t>e?t:e),0)+6e4<=Date.now();return e&&!o?n:await i.Z.pollCalDAV(t)}async saveEvent(e,t,n){if(!e)return{clearDraft:!1};const s=m.ZP.getLastActiveBrowserWindowId();if(!a.Z.doesCalendarsExistsAndShowWarning(s))return{clearDraft:!1};e.calendarId||(e.calendarId=a.Z.getDefaultCalendar(e.task)?.id||""),e.id=e.id.split("-")[0],e.task&&(e.invites=[]);const i=a.Z.shouldSaveEvent(e,t);if("IGNORE"===i)return{clearDraft:!0};if("DELETE"===i){return{clearDraft:await H.trashEvent(e.id)}}if(!e.id){const t=await H.createEvent(O(H.eventToCreateDetails({...e,title:e.title||""})));let s="sent";return t?.invites?.length&&(s=r.Z.sendAttendeeMails(n,t,[["create",t.invites]])),{clearDraft:"edit"!==s,event:t}}{if("SAVE_INVITED"!==i&&!a.Z.isOwnEvent(e)){const{action:e}=await l.Z.showModal(s,{modal:B()});if("cancel"===e)return{clearDraft:!0}}let o="all";if(t&&a.Z.isRecurringEvent(t)){const{action:e}=await l.Z.showModal(s,{modal:F("save")});o=e}if("all"===o||"upcoming"===o||"single"===o){return{clearDraft:!0,event:await H.updateEvent(e,o,!0,n)}}}return{clearDraft:!0}}async moveEvent(e,t,n){const i=s.Z.getEvent(e);if(!i)return;const o=m.ZP.getLastActiveBrowserWindowId();if(!a.Z.isOwnEvent(i)){const{action:e}=await l.Z.showModal(o,{modal:B()});if("cancel"===e)return i}const r=V(i,t);!1===t.allDay&&i.allDay&&i.end-i.start===Z.hd&&(r.end=r.start+p.Z.get(A.kCalendarDefaultDuration));const d={...i,...r};if(!a.Z.isRecurringEvent(i))return H.updateEvent(d,"single",!0,n);{const{action:e}=await l.Z.showModal(o,{modal:F("move")});if("all"===e||"upcoming"===e||"single"===e)return H.updateEvent(d,e,!0,n)}}async copyEvent(e,t,n){const i=s.Z.getEvent(e);if(i){const e=V(i,t),s={...i,...e,uid:crypto.randomUUID(),etag:"",href:""},{rrule:o}=i;if(o){const e=m.ZP.getLastActiveBrowserWindowId(),{action:n}=await l.Z.showModal(e,{modal:F("copy")});if("cancel"===n)return;if("single"===n)s.rrule=void 0;else{const e=t.start-i.start,o=L(i),a=(0,_.Qj)(o.rrule,o.start,o.timezone),r=(0,_.EE)(a?.origOptions,e);if("upcoming"===n){r.dtstart=new Date(s.start);const e=a?.origOptions.count;if(e){let t=0;const n=(0,P.VV)(new Date(i.start));a?.all(((e,s)=>!(e>=n)||(t=s,!1))),r.count=e-t}}else"all"===n&&a?.origOptions.dtstart&&(r.dtstart=(0,P.FL)(new Date(a.origOptions.dtstart.valueOf()+e)),s.start=r.dtstart?.valueOf()||0,s.end=s.start+i.end-i.start);a?.origOptions.until&&(r.until=(0,P.FL)(new Date(a.origOptions.until.valueOf()+e))),s.rrule=(0,_.Ns)(r)}}const a=r.Z.getOrganizerForEvent(s);s.organizer&&s.organizer!==a&&(s.organizer=a,s.invites=[]);const d=await H.createEvent(H.eventToCreateDetails(s));return d.invites?.length&&r.Z.sendAttendeeMails(n,d,[["create",d.invites]]),d}}async deleteExceptions(e,t){const n=e.id.split(":")[0],{recurrenceExceptions:s}=e;if(s)for(const e of s){const{exception_id:s,exception_event_id:i,parent_event_id:o,date:a}=e;i&&n===o&&(void 0===t?.after||a&&a>=t?.after)&&(void 0===t?.at||a===t?.at)&&await H.deleteEvent(i),s&&k.Z.calendar.deleteEventException(s)}}async trashEvent(e,t){function n(e){return e.invites?.length&&a.Z.isOwnEvent(e)&&t?.sendEmails}async function o(e){H.deleteExceptions(e);const t=await H.updateEvent({...e,trash:!0,syncPending:W(e,!0)},"all");if(t.syncPending){(await i.Z.deleteEvent(e.id)).ok&&await y.Z.updateEvent({id:e.id,syncPending:!1})}return n(e)&&await r.Z.sendAttendeeMails(null,e,[["cancel",e.invites??[]]]),t}if(e){const[c,h]=e.split("-")[0].split(":"),p=parseInt(h),u=s.Z.getEvent(c);if(!u)return!1;let g;if(a.Z.isRecurringEvent(u)){const d=m.ZP.getLastActiveBrowserWindowId();switch(t?.saveMode??(await l.Z.showModal(d,{modal:F("trash")})).action){case"single":{const t=s.Z.getEvent(e);if(t?.recurrenceId&&H.deleteExceptions(u,{at:t.recurrenceId}),g=await H.createException(c,"0",!0,t?.recurrenceId??p),a.Z.isRemoteCalendar(g.calendarId)){const e=parseInt(g.sequence)+1,t=await y.Z.updateEvent({id:g.id,sequence:e});i.Z.updateEvent(t)}if(n(u)){const{rrule:e,...t}=u;r.Z.sendAttendeeMails(null,t,[["cancel",u.invites??[]]],!0)}break}case"upcoming":{const{rrule:e,start:t,timezone:s}=u,l=(0,_.Qj)(e,t,s);if(!l||!u.start)return!1;const d=(0,_._v)(l,new Date(p));if(!d){o(u);break}const{count:h,...m}=l.origOptions,v=(0,_.Ns)({...m,until:d}),f=parseInt(u.sequence)+1;g=await y.Z.updateEvent({id:c,rrule:v,sequence:f}),H.deleteExceptions(u,{after:d.valueOf()}),n(g)&&r.Z.sendAttendeeMails(null,g,[["update",g.invites??[]]]),a.Z.isRemoteCalendar(g.calendarId)&&i.Z.updateEvent(g);break}case"all":g=await o(u)}}else g=await o(u);g&&d.ZP.updateAlarmsForEvent(g)}return!0}async restoreEvent(e,t){await H.updateEvent({...t,trash:!1},"single",!0,e),t.invites?.length&&r.Z.sendAttendeeMails(e,t,[["create",t.invites]]),a.Z.isRemoteCalendar(t.calendarId)&&i.Z.createEvent(t),o.Z.selectEvent(e,{event:t})}createAccount(e){return new Promise(((t,n)=>{k.Z.calendar.createAccount(e,(s=>{const i=f.Z.runtime.lastError;if(i)return C.Z.error("Calendar",["create","account"],e,new Error(i.message)),n(i.message);t(s)}))}))}updateAccount(e){const{id:t,...n}=e;k.Z.calendar.updateAccount(t,n,(e=>{f.Z.runtime.lastError&&C.Z.error("Calendar",["update","account"],n,new Error(f.Z.runtime.lastError.message))}))}async updateCalendar(e,t,n=!0){const{account:o}=a.Z.getAccountAndCalendar(e);return!!o&&(a.Z.isCalDAV(o.account_type)&&n&&await i.Z.updateCalendar(e,t),(async(e,t)=>new Promise((n=>{k.Z.calendar.update(e,t,(t=>{const i=f.Z.runtime.lastError;if(i){const t=s.Z.getCalendars().find((t=>t.id===e)),n=t?.description??t?.name??"Calendar not found";C.Z.error("Calendar",["update","calendar"],n,t,new Error(i.message))}n(t)}))})))(e,t))}toggleCalendarVisibility(e){const t=s.Z.getCalendars().find((t=>t.id===e));t&&this.updateCalendar(e,{hidden:!t.hidden},!1)}setDefaultCalendarId(e,t=!1){const n=t?A.kCalendarDefaultTaskCalendarId:A.kCalendarDefaultCalendarId;p.Z.get(n)!==e&&h.Z.set(n,e)}async createCalendar(e,t,n=!1,s=!1){if(!s&&"ical"===t?.account_type)return{result:{status:!1,message:(0,v.Z)("Can not create a calendar in a web calendar account")}};const o=!(!e||!t?.url);if(t&&n&&o){const{status:n,message:s,name:o,ctag:a}=await i.Z.createCalendar(t,e);if(!n)return{result:{status:n,message:s}};e.name=o,e.ctag=a||""}try{e.color||(e.color=a.Z.getCalendarCreateColor());const t=await k.Z.calendar.create(e);return{result:{status:!0,message:(0,v.Z)("Success")},calendar:t}}catch(s){return C.Z.error("Calendar",["create","calendar"],s),n&&t&&o&&await i.Z.deleteCalendar(t,e.name),{result:{status:!1,message:s}}}}async deleteAccount(e){if(!s.Z.getAccounts().find((t=>t.id===e)))return!1;let t;try{t=await k.Z.calendar.deleteAccount(e)}catch(t){throw C.Z.error("Calendar",["delete","account"],e,new Error(t)),t}return t}async deleteCalendar(e,t=!1){const n=s.Z.getAccounts().find((t=>t.id===e.accountId));if(!n)return{status:!1,message:(0,v.Z)("No account found")};const o=!!n.url,a="ical"===n.account_type;t&&n&&o&&!a&&await i.Z.deleteCalendar(n,e.name);try{const t=await k.Z.calendar.delete(e.id);if(a){return{status:await H.deleteAccount(n.id),message:""}}return{status:t,message:""}}catch(t){const n=e.description??e.name;return C.Z.error("Calendar",["delete","calendar"],n,t),{status:!1,message:t}}}async deleteEvent(e){const t=e.split("-")[0].split(":")[0],{notifications:n}=c.Z.getState();n.filter((e=>e.event_id===t)).forEach((e=>{d.ZP.deleteNotification(e)}));try{await k.Z.calendar.deleteEvent(t)}catch(t){C.Z.error("Calendar",["delete","event"],e,new Error(t.message))}}importEventsDialog(e){const t=m.ZP.getLastActiveBrowserWindowId();l.Z.showCalendarImportEvents(t,e)}init(){p.Z.addListener(A.kMailIsTurnedOff,U),H.startAPIChangeListeners(!0),i.Z.calendarServiceStart(),k.Z.calendar.onIcsFileOpened.addListener(H.importEventsDialog.bind(this)),k.Z.calendar.onWebcalUrlOpened.addListener(H.importEventsDialog.bind(this)),async function(){const e=p.Z.get(A.kCalendarTemplatesVersion);if(e<1)for(let t=e+1;t<=1;t++)for(const e of T[t])await k.Z.calendar.createEventTemplate(e.name,e.ical);h.Z.set(A.kCalendarTemplatesVersion,1)}()}startListeners(){H.startAPIChangeListeners(),i.Z.calendarServiceStart()}stopListeners(){i.Z.calendarServiceStop(),H.stopAPIChangeListeners()}startAPIChangeListeners(e=!1){this.#e||p.Z.get(A.kMailIsTurnedOff)||(k.Z.calendar.onCalendarDataChanged.addListener(H.loadDatabase),e?D.nextTick((()=>H.loadPromise())):H.loadPromise(),d.ZP.startAPIChangeListeners(),this.#e=!0)}stopAPIChangeListeners(){this.#e&&(k.Z.calendar.onCalendarDataChanged.removeListener(H.loadDatabase),d.ZP.stopAPIChangeListeners(),this.#e=!1)}},z=H},12442:(e,t,n)=>{"use strict";n.d(t,{Z:()=>b});var s=n(50522),i=n(6320),o=n(15800),a=n(68247),r=n(33638),l=n(45660),d=n(30381),c=n.n(d),h=n(24522),p=n(87852),u=n(9126),g=n(58821);const m=["day","week","multiweek","month","year","agenda"],v=["day","week","agenda"];let f=(new Date).getDate();function y(e,t){const n=i.Z.getStateForPage(e);if(t.displayMode||t.selectedDate){const e=t.selectedDate??n.selectedDate,s=t.anchorDate??n.anchorDate,i=t.displayMode??n.displayMode;if(e&&s&&i){o.Z.getDisplayRange(s,i).contains(e)||(t={...t,anchorDate:e.clone(),selectedDate:e})}}r.Z.dispatch({actionType:"CALENDAR_UPDATE_UI",calendarUI:t,pageId:e})}function C(e,t,n){const s=i.Z.getStateForPage(e),{anchorDate:a,displayMode:r,selectedDate:l}=s;if(!l)return;let d;switch(r){case"agenda":case"multiweek":d="week";break;default:d=r}const c="previous"===t?a.clone().subtract(1,d):a.clone().add(1,d);let h;if(n&&o.Z.getDisplayRange(c,r).contains(n))h=n.clone();else if("month"===r){const e=o.Z.getDisplayRange(c,r),t=(0,g.Xq)(l,a);h=(0,g.FY)(t,l.weekday(),c,!1),h.isAfter(e.end,"day")&&(h=(0,g.Ro)(l.weekday(),c,!0))}else h="previous"===t?l.clone().subtract(1,d):l.clone().add(1,d);y(e,{anchorDate:c,selectedDate:h})}!function e(){setTimeout((function(){const t=(new Date).getDate();t!==f&&(f=t,function(){const e=i.Z.getState();for(const[t,n]of e){const{selectedDate:e,allDaySelected:s}=n;if(e&&e.valueOf()<(new Date).valueOf()){const n=c()().hour(e.hour()).minute(e.minute());w.selectDate(t,n,{allDay:s})}}}()),e()}),h.lb)}();const w=new class{init(e,t){y(e,t??(0,u.l)(e))}selectEvent(e,t){const{event:n,eventId:a,date:r,allDay:l,edit:d}=t,c=i.Z.getStateForPage(e),h=n?.id??a??"";if(h===c.selectedEvent&&(void 0===d||d===c.editing))return;let p=n;!p&&h&&(p=s.Z.getEvent(h));const u={};if(u.selectedEvent=h,t.hasOwnProperty("date")&&(u.selectedDate=r),p){if(!t.hasOwnProperty("date")){const e=o.Z.getEventRange(p);!e||c.selectedDate&&e.contains(c.selectedDate)||(u.selectedDate=e.start)}u.editing=d??c.editing;!(p.start||p.end)&&"agenda"!==c.displayMode&&(u.displayMode="agenda")}void 0!==l&&(u.allDaySelected=l),y(e,u)}selectDate(e,t,n={}){if(t&&!t.isValid())return void l.Z.error("Calendar",["actions"],new Error("Invalid date selected"));const s=i.Z.getStateForPage(e),{allDay:o,setToday:a}=n,{displayMode:r}=s;let d={allDaySelected:o??!1,selectedEvent:""};d=t&&a&&"agenda"===r?{...d,anchorDate:t,selectedDate:t}:{...d,selectedDate:t},y(e,d)}selectToday(e){const t=c()((0,g.zX)(Date.now()));w.selectDate(e,t,{setToday:!0})}viewPreviousPeriod(e,t){C(e,"previous",t)}viewNextPeriod(e,t){C(e,"next",t)}setViewMode(e,t){if(e===p.G6&&!v.includes(t))return;const n=i.Z.getStateForPage(e),s=(0,u.R)(e);if(t!==n.displayMode){s.displayMode=t;const n=o.Z.getCalendarFilterPrefsKey(e);a.Z.set(n,s)}y(e,{displayMode:t})}zoomViewMode(e,t){const n=i.Z.getStateForPage(e).displayMode,s=e===p.G6?v:m;let o=s.findIndex((e=>e===n))+t;o<0?o=0:o>=s.length&&(o=s.length-1),y(e,{displayMode:s[o]})}showCompletedTasks(e,t){const n=i.Z.getStateForPage(e);t=t??!n.showCompletedTasks;const s=(0,u.R)(e);if(t!==n.showCompletedTasks){s.showCompletedTasks=t;const n=o.Z.getCalendarFilterPrefsKey(e);a.Z.set(n,s)}y(e,{showCompletedTasks:t})}search(e,t){y(e,{filterText:t})}},b=w},29717:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var s=n(33638);const i={enableCapture:function(e,t){s.Z.dispatch({actionType:"CAPTURE_ENABLE",winId:e,noteId:t})},disableCapture:function(e){s.Z.dispatch({actionType:"CAPTURE_DISABLE",winId:e})}}},21788:(e,t,n)=>{"use strict";n.d(t,{Z:()=>m});var s=n(21838),i=n(96951),o=n(29087),a=n(83526),r=n(15489),l=n(2497),d=n(94595),c=n(7064),h=n(89175);const p=["INPUT","FRAME","IFRAME","OBJECT","SELECT","TEXTAREA","EMBED"],u=[{className:"url",action:"urlPasteAndGo"},{className:"vivaldi-searchfield",action:"searchPasteAndGo"},{className:"quick-command-search",action:"qcPasteAndGo"}];function g(){let e;const t=function(t){const{clipboardData:n}=t;n&&n.types.indexOf("text/plain")>-1&&(e=n.getData("text/plain"),t.preventDefault())};return document.addEventListener("paste",t),document.execCommand("paste"),document.removeEventListener("paste",t),e}const m=new class{undo(e){c.Z.editcommand.execute("undo",e)}redo(e){c.Z.editcommand.execute("redo",e)}cut(e){c.Z.editcommand.execute("cut",e)}copy(e){c.Z.editcommand.execute("copy",e)}paste(e){c.Z.editcommand.execute("paste",e)}selectAll(e){c.Z.editcommand.execute("selectAll",e)}set(e){const{body:t}=document;if(!e||!t)return;const n=document.createElement("input");n.style.position="absolute",n.style.zIndex="-1",n.value=e,t.appendChild(n),n.select(),document.execCommand("copy")||console.error("Failed to copy text."),t.removeChild(n)}pasteAsPlainText(e){c.Z.editcommand.execute("pasteAndMatchStyle",e)}pasteAsPlainTextOrPasteAndGo(e,t){let n=g();if(!r.ZP.isPopup(e)){const s=(0,l.Z)(e),{activeElement:i}=s.document,o=u.find((e=>i?.classList.contains(e.className)));if(o&&i instanceof s.HTMLInputElement)return n=(0,d.Z)({textToStrip:n??"",caretPosition:i?.selectionStart??0,selectionEnd:i?.selectionEnd??0,currentValue:i?.value??""}),void a.Z.doAction(e,t,o.action,{clipboardText:n});if(p.indexOf(i?.tagName)>-1||i?.isContentEditable)return void c.Z.editcommand.execute("pasteAndMatchStyle",e)}c.Z.windowPrivate.getFocusedElementInfo(e).then((({editable:s})=>{s?c.Z.editcommand.execute("pasteAndMatchStyle",e):(o.Z.get(h.kAddressBarStripJavascriptOnPaste)&&(n=(0,d.Z)({textToStrip:n??"",caretPosition:0,selectionEnd:0,currentValue:""})),a.Z.doAction(e,t,"urlPasteAndGo",{clipboardText:n}))}))}copyWithFilter(e){const t=e.indexOf("?");-1!==t&&(e=e.slice(0,t)),this.copyTextToClipboard(e)}async createNoteFromSelection(e){const t=i.ZP.getActivePage(e);if(t){const n=g(),i=await c.Z.utilities.getSelectedText(t.id);await s.Z.createNote(e,{content:n,url:i===n?t.url:void 0,type:"note"})}}copyUrlToClipboard(e){const t=function(t){t.clipboardData&&(t.clipboardData.setData("text/plain",e),t.stopPropagation(),t.preventDefault())};document.addEventListener("copy",t),document.execCommand("copy"),document.removeEventListener("copy",t)}copyTextToClipboard=e=>{const t=t=>{t.clipboardData&&(t.clipboardData.setData("text/plain",e),t.stopPropagation(),t.preventDefault())};return document.addEventListener("copy",t),document.execCommand("copy"),document.removeEventListener("copy",t),Promise.resolve()}}},47995:(e,t,n)=>{"use strict";n.d(t,{Z:()=>w});var s=n(15544),i=n(68247),o=n(29087),a=n(33638),r=n(56371),l=n(92292),d=n(7064),c=n(10334),h=n(30330),p=n(47380),u=n(89175);const g={version:1,chains:[{category:"CATEGORY_COMMAND_CHAIN",key:"ckqjhvf430003c5429ni7i7bz",label:(0,r.Z)("command chain",(0,r.Z)("Close Other and Open Defined Tab")),name:"COMMAND_ckqjhvf430003c5429ni7i7bz",chain:[{defaultValue:"https://vivaldi.com",key:"f57b8092-9426-4bc8-8e39-fcf3e315b065",param:"https://vivaldi.com",label:"COMMAND_OPEN_LINK_DEFAULT",name:(0,r.Z)("Open Link in New Tab")},{key:"275ca3f7-ecfb-4445-bf87-686cd473536e"}]},{category:"CATEGORY_COMMAND_CHAIN",key:"ckqkoqycf0003wv4210uduu8n",label:(0,r.Z)("command chain",(0,r.Z)("Toggle Fullscreen and Reader Mode")),name:"COMMAND_ckqkoqycf0003wv4210uduu8n",chain:[{key:"7420368f-565e-409f-8eec-5b5c578429af"},{key:"8dd47fc9-4c1f-4487-a475-f55bfa61aaf2"}]},{category:"CATEGORY_COMMAND_CHAIN",key:"ckqjdk4o7000001l58zh17egm",label:(0,r.Z)("command chain",(0,r.Z)("Open Links and Tile")),name:"COMMAND_ckqjdk4o7000001l58zh17egm",chain:[{defaultValue:"https://vivaldi.com",key:"0b01337b-4c13-4197-90c8-179c5c91cfff",param:"https://vivaldi.com",label:"COMMAND_OPEN_LINK_CURRENT"},{defaultValue:"https://vivaldi.net",key:"f57b8092-9426-4bc8-8e39-fcf3e315b065",param:"https://vivaldi.net",label:"COMMAND_OPEN_LINK_DEFAULT"},{defaultValue:"https://help.vivaldi.com",key:"f57b8092-9426-4bc8-8e39-fcf3e315b065",param:"https://help.vivaldi.com",label:"COMMAND_OPEN_LINK_DEFAULT"},{defaultValue:1e3,key:"2eb81004-6703-46db-9933-6afcfde924e4",param:150},{key:"e245bce5-20a7-481f-910e-23bf1de86748"},{key:"e245bce5-20a7-481f-910e-23bf1de86748"},{defaultValue:1e3,key:"2eb81004-6703-46db-9933-6afcfde924e4",param:125},{key:"cdd99010-5477-4508-aa28-d671de35dcb2"},{key:"854f8a44-50bd-41bc-8277-acd51e719d1b"}]}]},m=function(e){s.Z.isNamedMenuAvailable(e)&&d.Z.menuContent.get(e,((t,n,s)=>{a.Z.dispatch({actionType:"COMMAND_SET_NAMED_MENU",name:e,content:s})}))},v=function(e,t,n){const s=y(e);if(!s)return;const i={shortcuts:t,gestures:n,feature:h.CN.concat(o.Z.get(u.kChainedCommandsCommandList)).find((t=>t.name===e))?.feature||"browser"};a.Z.dispatch({actionType:"COMMAND_UPDATE_COMMAND",item:{key:s,value:i}})},f=function(){const e=h.CN.concat(o.Z.get(u.kChainedCommandsCommandList)),t=o.Z.get(u.kActions)[0],n=e.map((e=>{const n=t[e.name];if(n)return{key:e.name,value:{...n,feature:e.feature||"browser"}}})).filter(Boolean);a.Z.dispatch({actionType:"COMMAND_RESET",items:n})};function y(e){if(e.startsWith("COMMAND_"))return e}const C=new class{loadPromise(){const{version:e}=g;e!==o.Z.get(u.kChainedCommandsVersion)&&(e=>{const{chains:t}=g,n=o.Z.get(u.kChainedCommandsDeletedCommandList),s=o.Z.get(u.kChainedCommandsCommandList),a=s.map((e=>e.key)),r=t.filter((e=>!n.includes(e.key)&&!a.includes(e.key))),l=[...s,...r];i.Z.set(u.kChainedCommandsCommandList,l),i.Z.set(u.kChainedCommandsVersion,e)})(e);const t=h.CN.concat(o.Z.get(u.kChainedCommandsCommandList)),n=o.Z.get(u.kActions)[0],s=t.map((e=>{const t=n[e.name];if(t)return{key:e.name,value:{...t,feature:e.feature||"browser"}}})).filter(Boolean);return a.Z.dispatch({actionType:"COMMAND_INITIALIZE",items:s}),d.Z.menuContent.onChanged.addListener(m),o.Z.addListener(u.kChainedCommandsCommandList,C.chainListChanged),Promise.resolve()}requestNamedMenu(e){s.Z.getIsInitialized()&&!s.Z.isNamedMenuAvailable(e)&&d.Z.menuContent.get(e,((t,n,s)=>{l.Z.runtime.lastError?(a.Z.dispatch({actionType:"COMMAND_SET_NAMED_MENU",name:e,content:[]}),console.warn("Failed to read menu spec. Attempting fallback.",e),d.Z.menuContent.reset(e,!1,void 0,(()=>{}))):a.Z.dispatch({actionType:"COMMAND_SET_NAMED_MENU",name:e,content:s})}))}restoreShortcuts(){const e=structuredClone(o.Z.getDefault(u.kActions))[0];s.Z.getUserEditableCommands().forEach((t=>{const n=s.Z.getCommandConfiguration(t.name)?.gestures;n?e[t.name]={...e[t.name],gestures:n}:e[t.name]?.gestures&&delete e[t.name].gestures})),i.Z.set(u.kActions,[e]),f()}restoreGestures(){const e=structuredClone(o.Z.getDefault(u.kActions))[0];s.Z.getUserEditableCommands().forEach((t=>{const n=s.Z.getCommandConfiguration(t.name)?.shortcuts;n?e[t.name]={...e[t.name],shortcuts:n}:e[t.name]?.shortcuts&&delete e[t.name].shortcuts})),i.Z.set(u.kActions,[e]),f()}setShortcuts(e,t){const n=o.Z.get(u.kActions)[0],s={...n};s[e]={...n[e]},t&&t.length>0?s[e].shortcuts=t:delete s[e].shortcuts,i.Z.set(u.kActions,[s]),v(e,t,s[e].gestures)}setGestures(e,t){const n=o.Z.get(u.kActions)[0],s={...n};s[e]={...n[e]},t&&t.length>0?s[e].gestures=t:delete s[e].gestures,i.Z.set(u.kActions,[s]),v(e,s[e].shortcuts,t)}chainListChanged(e,t){if(t.length<e.length){const n=e.filter((e=>-1===t.findIndex((t=>t.key===e.key))));if(1===n.length){const e=y(n[0].name);e&&a.Z.dispatch({actionType:"COMMAND_REMOVE_COMMAND",key:e})}else console.warn("Wrong number of elements removed")}}executeActions(e,t,n,i){const a=(0,p.m)(e,t),r=s.Z.getCommands().find((e=>e.name===n));if(!r){const e=o.Z.get(u.kChainedCommandsCommandList);for(let t=e.length-1;t>=0;t--)if(e[t].name===n){(0,c.hT)(a,e[t].chain);break}return void console.warn("[execute actions]: Lookup failed for command",n)}let l=i;void 0===l&&(l=(0,h.xU)(r.name)?.defaultValue),void 0!==l&&(a.param=l),r.action(a)}handleRockerGesture(e,t){const n=o.Z.get(t?u.kMouseGesturesRockerGesturesRightToLeft:u.kMouseGesturesRockerGesturesLeftToRight),i=s.Z.getCommandByGuid(n);i?C.executeActions("gesture",e,i.name):console.warn("[Rocker Gesture]: No command for guid",n)}},w=C},17751:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var s=n(33638);const i=new class{log(e){s.Z.dispatch({actionType:"COMPONENT_LOGGER_LOG",entry:e})}clear(e){s.Z.dispatch({actionType:"COMPONENT_LOGGER_CLEAR",component:e})}}},4660:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var s=n(73132),i=n(72010),o=n(33638),a=n(7064);const r=new class{async initialize(e){const t=await a.Z.contacts.getAll();o.Z.dispatch({actionType:"CONTACT_INITIALIZE",contacts:t.map((e=>(0,s.Z)(e))),newContact:e})}updateContact(e){o.Z.dispatch({actionType:"CONTACT_UPDATE_CONTACT",contact:e})}addGeneratedContacts(e){o.Z.dispatch({actionType:"CONTACT_ADD_CONTACTS",contacts:e.map((e=>(0,s.Z)(e)))})}async addContact(e){const t=await a.Z.contacts.create({name:e.name,birthday:e.birthday,note:e.note,generatedFromSentMail:e.generatedFromSentMail,avatarUrl:e.avatarUrl,separator:e.separator,trusted:e.trusted});for(const n of e.emailAddresses)await a.Z.contacts.addEmailAddress({contactId:t.id,emailAddress:n.emailAddress,type:n.type});for(const n of e.postalAddresses)await a.Z.contacts.addPropertyItem({propertyName:"postalAddress",contactId:t.id,propertyValue:n.postalAddress,type:n.type});for(const n of e.phoneNumbers)await a.Z.contacts.addPropertyItem({propertyName:"phoneNumber",contactId:t.id,propertyValue:n.phoneNumber,type:n.type});e.id=t.id,o.Z.dispatch({actionType:"CONTACT_ADD_CONTACT",contact:e})}selectContact(e,t=!1){o.Z.dispatch({actionType:"CONTACT_SELECT_CONTACT",contact:e,focusContactView:t})}deleteContactsByIds(e){const t=[],n=[];for(const s of e)"string"==typeof s&&(t.push(s),n.push(a.Z.contacts.delete(s)));return Promise.all(n).then((()=>{o.Z.dispatch({actionType:"CONTACT_DELETE_CONTACTS",ids:t})}))}newEmptyContact(){return new Promise((e=>{a.Z.contacts.create({},(t=>{const n=(0,s.Z)(t);return r.initialize(n),e(n)}))}))}newContactFromMailAddress(e,t){a.Z.contacts.create({name:e.name||""},(t=>a.Z.contacts.addEmailAddress({contactId:t.id,emailAddress:e.address},(e=>{r.initialize((0,s.Z)(e))}))))}putTrustedEmailAddress(e){let t=!1;i.Z.getAsArray().forEach((n=>n.emailAddresses.forEach((s=>{e.address===s.emailAddress&&(t=!0,r.update(n.id,{trusted:!0}))})))),!1===t&&a.Z.contacts.create({name:e.name||"",generatedFromSentMail:!0,trusted:!0},(t=>a.Z.contacts.addEmailAddress({contactId:t.id,emailAddress:e.address},(e=>r.addGeneratedContacts([e])))))}async update(e,t){Object.keys(t).length>0&&await a.Z.contacts.update(e,t,(e=>r.updateContact((0,s.Z)(e))))}updatePropertyItem(e){a.Z.contacts.updatePropertyItem(e,(e=>r.updateContact((0,s.Z)(e))))}updateEmailAddress(e,t){a.Z.contacts.updateEmailAddress(e,t,(e=>r.updateContact((0,s.Z)(e))))}addPropertyItem(e){a.Z.contacts.addPropertyItem(e,(e=>r.updateContact((0,s.Z)(e))))}removePropertyItem(e){a.Z.contacts.removePropertyItem(e,(e=>r.updateContact((0,s.Z)(e))))}addEmailAddress(e){a.Z.contacts.addEmailAddress(e,(e=>r.updateContact((0,s.Z)(e))))}removeEmailAddress(e){a.Z.contacts.removeEmailAddress(e,(e=>r.updateContact((0,s.Z)(e))))}addIfNotAddressExists(e){a.Z.contacts.getAll((t=>{const n=new Set;t.forEach((e=>e.emailAddresses.forEach((e=>{e.emailAddress&&n.add(e.emailAddress.toLowerCase())}))));const s=[];e.forEach((e=>{n.has(e.address.toLowerCase())||(a.Z.contacts.create({name:e.name||"",generatedFromSentMail:!0},(t=>{a.Z.contacts.addEmailAddress({contactId:t.id,emailAddress:e.address},(e=>r.addGeneratedContacts([e])))})),s.push(e))}))}))}},l=r},83784:(e,t,n)=>{"use strict";n.d(t,{Z:()=>g});var s=n(1567),i=n(33638),o=n(63153),a=n(15489),r=n(92292),l=n(2497),d=n(28773),c=n(7064),h=n(82786);function p(e){return new Promise((t=>{r.Z.downloads.search(e,t)}))}const u=(0,h.M)();const g=new class{_isPolling=!1;_dispatchUpdate=e=>{i.Z.dispatch({actionType:"DOWNLOAD_PANEL_UPDATED",downloadItems:e})};_replaceDownloadItem=(e,t)=>{const n=s.Z.getItems({isIncognitoWindow:!1}),i=n.find((t=>t.id===e.id));if(!i)return;const o=n.indexOf(i),a=[...n.slice(0,o),t,...n.slice(o+1)];this._dispatchUpdate(a)};_startPolling=()=>{this._isPolling||(this._intervalId=setInterval(this._pollInProgressDownloads,500),this._isPolling=!0)};_stopPolling=()=>{this._isPolling=!1,clearInterval(this._intervalId)};_handleNewDownloadItem=e=>{const t=s.Z.getFilter(),n=s.Z.getOrderBy(),o={...(0,d.Z)(t?{query:t.split(" ")}:null),...(0,d.Z)(n?{orderBy:[n]}:null)};r.Z.downloads.search(o,(t=>{this._dispatchUpdate(t);const n=s.Z.getItems({isIncognitoWindow:!1}).find((t=>t.id===e));n&&i.Z.dispatch({actionType:"DOWNLOAD_STARTED",downloadItem:n})}))};_updateState=e=>{const t=s.Z.getItems({isIncognitoWindow:!1}),n=t.findIndex((t=>t.id===e.id));if(-1===n)return void this._handleNewDownloadItem(e.id);const i=[...t.slice(0,n),e,...t.slice(n+1)];this._dispatchUpdate(i)};_updateStateForDownloadItems=e=>{e.forEach(this._updateState)};_handleInProgressSearch=e=>{e.filter((e=>!e.paused)).length||this._stopPolling(),this._setTotalProgress(e),this._updateStateForDownloadItems(e)};_handleFileDeleted=(e,t)=>{this._pollInProgressDownloads(),e?r.Z.downloads.search({id:e,limit:1},(n=>{if(!n||!Array.isArray(n))return void console.warn(`DownloadActions: _handleFileDeleted: Failed to search downloads for ID ${e} (${t})`);const s=n[0];s&&this._updateState(s)})):console.warn(`DownloadActions: _handleFileDeleted: Invalid download ID ${e} (${t})`)};_pollInProgressDownloads=()=>{r.Z.downloads.search({state:"in_progress"},this._handleInProgressSearch)};_setTotalProgress=e=>{const t=e.filter((e=>!e.paused)),n=t.length,s=function(e){return e.length?e.map((e=>e.bytesReceived/e.totalBytes)).reduce(((e,t)=>e*t)):0}(t);i.Z.dispatch({actionType:"DOWNLOAD_SET_TOTAL_PROGRESS",totalNumberOfDownloads:n,totalProgress:s})};_handleDangerousFileDownload=e=>{const t=a.ZP.getLastActiveBrowserWindowId();a.ZP.isMinimized(t)&&o.Z.restore(t),async function(e,t){const n=await u();try{const{chrome:s}=(0,l.Z)(e);await s.downloads.acceptDanger(t)}catch(e){}finally{n()}}(t,e)};_onTransferChanged=e=>{e.paused&&e.paused.previous&&!e.paused.current?this._onTransferCreated():(e.filename&&this._handleNewDownloadItem(e.id),e.danger&&e.danger.current!==e.danger.previous&&this._handleDangerousFileDownload(e.id),e.exists&&!e.exists.current&&this._handleFileDeleted(e.id,"Deleted from disk"),e.state&&("interrupted"===e.state.current&&this._handleFileDeleted(e.id,"Interrupted"),"complete"===e.state.current&&(r.Z.downloads.search({id:e.id,limit:1},(([e])=>{this._updateState(e),this._pollInProgressDownloads(),i.Z.dispatch({actionType:"DOWNLOAD_COMPLETED",downloadItem:e})})),s.Z.openAfterDownload.has(e.id)&&(r.Z.downloads.open(e.id),s.Z.openAfterDownload.delete(e.id)))))};_onTransferErased=e=>{const t=s.Z.getItems({isIncognitoWindow:!1}),n=t.findIndex((t=>t.id===e));if(-1===n)return;const i=[...t.slice(0,n),...t.slice(n+1)];this._dispatchUpdate(i)};_onTransferCreated=()=>{this._startPolling()};_showDownload=e=>{r.Z.downloads.show(e)};_openDownload=e=>{r.Z.downloads.open(e)};_pauseDownload=e=>{r.Z.downloads.pause(e)};_resumeDownload=e=>{r.Z.downloads.resume(e)};_eraseDownload=e=>{r.Z.downloads.erase({id:e})};_restartDownload=e=>p({id:e}).then((([t])=>{return(n={url:t.url},new Promise((e=>{r.Z.downloads.download(n,e)}))).then((e=>p({id:e}))).then((([e])=>this._replaceDownloadItem(t,e))).then((()=>{return t={id:e},new Promise((e=>{r.Z.downloads.erase(t,e)}));var t}));var n}));_searchDownloads({filter:e,orderBy:t}){return new Promise((n=>{const s={...(0,d.Z)(e?{query:e.split(" ")}:null),...(0,d.Z)(t?{orderBy:[t]}:null)};r.Z.downloads.search(s,(e=>{n(e)}))}))}_setSearchFilter(e){if(e===s.Z.getFilter())return Promise.resolve();const t=s.Z.getOrderBy();return this._searchDownloads({filter:e,orderBy:t}).then((t=>{i.Z.dispatch({actionType:"DOWNLOAD_SET_FILTER",downloadItems:t,filter:e})}))}_setOrderBy(e){if(e===s.Z.getOrderBy())return Promise.resolve();const t=s.Z.getFilter();return this._searchDownloads({filter:t,orderBy:e}).then((t=>{i.Z.dispatch({actionType:"DOWNLOAD_SET_ORDER_BY",downloadItems:t,orderBy:e})}))}_validateDownload=e=>{r.Z.downloads.acceptMixed(e)};forceUpdate=()=>{const e=s.Z.getFilter(),t=s.Z.getOrderBy();this._searchDownloads({filter:e,orderBy:t}).then((e=>{i.Z.dispatch({actionType:"DOWNLOAD_SET_ORDER_BY",downloadItems:e,orderBy:t})}))};startResolvingReady=()=>{let e,t,n;return Promise.race([function(){let t=0;return new Promise((n=>{!function s(){c.Z.utilities.isDownloadManagerReady((e=>{e&&n()})),t++,e=setTimeout(s,1e3*t)}()}))}(),new Promise((e=>{n=()=>{e()},c.Z.utilities.onDownloadManagerReady.addListener(n)})),new Promise((e=>{t=setTimeout(e,2e4)}))]).then((()=>{clearTimeout(e),clearTimeout(t),c.Z.utilities.onDownloadManagerReady.removeListener(n),s.Z.resolveReady()}))};addOpenAfterDownload=e=>{s.Z.openAfterDownload.add(e)};setSearchFilter=e=>s.Z.ready.then((()=>this._setSearchFilter(e)));setOrderBy=e=>s.Z.ready.then((()=>this._setOrderBy(e)));showDownload=e=>{s.Z.ready.then((()=>{this._showDownload(e)}))};eraseDownload=e=>{s.Z.ready.then((()=>{this._eraseDownload(e)}))};openDownload=e=>{s.Z.ready.then((()=>{this._openDownload(e)}))};pauseDownload=e=>{s.Z.ready.then((()=>{this._pauseDownload(e)}))};resumeDownload=e=>{s.Z.ready.then((()=>{this._resumeDownload(e)}))};restartDownload=e=>s.Z.ready.then((()=>this._restartDownload(e)));validateMixedDownload=e=>{s.Z.ready.then((()=>{this._validateDownload(e)}))};load=()=>(r.Z.downloads.setShelfEnabled(!1),r.Z.downloads.onChanged.addListener(this._onTransferChanged),r.Z.downloads.onCreated.addListener(this._onTransferCreated),r.Z.downloads.onErased.addListener(this._onTransferErased),this.startResolvingReady(),s.Z.ready.then(this._startPolling))}},87210:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var s=n(16875),i=n(96951),o=n(29087),a=n(33638),r=n(83526),l=n(92292),d=n(89175);const c=new class{setFastForwardUrl(e,t,n){a.Z.dispatch({actionType:"FAST_FORWARD_SET_FORWARD_URL",pageId:e,forwardUrl:t})}_updateRewindInfo(e,t,n){a.Z.dispatch({actionType:"FAST_FORWARD_SET_REWIND_INFO",pageId:e,history:n,currentIndex:t})}setRewindInfo(e,t){e.getPageHistory(((e,n)=>{l.Z.runtime.lastError||c._updateRewindInfo(t,e,n)}))}navigateRewind(e){const t=i.ZP.getActivePage(e);if(t){const n=s.Z.getRewindRelativeIndex(t.id);r.Z.go(e,t.id,-1*n)}}navigateFastforward(e){const t=i.ZP.getActivePage(e);t&&l.Z.tabs.sendMessage(t.id,{navigateFastforward:!0})}isFFWEnabled(){return o.Z.get(d.kKeyboardShortcutsSpaceFastForwards)}sendMessage(e,t,n={}){l.Z.tabs.sendMessage(e,{...n,action:t})}onIsFFWEnabled(e){this.isFFWEnabled()&&c.sendMessage(e,"ffwGoForward")}initFastForward(){l.Z.runtime.onMessage.addListener(((e,t)=>{if(!function(e){return l.Z.runtime.id===e.id&&0===e.frameId}(t)||!e||"string"!=typeof e.action||!t.tab?.id)return;const{action:n}=e;"fastforwardUrlChanged"===n&&"string"==typeof e.nextUrl?c.setFastForwardUrl(t.tab.id,e.nextUrl,t.url):"canFFWGoForward"===n&&c.onIsFFWEnabled(t.tab.id)}))}},h=c},22616:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var s=n(33638);class i{static setImportProgress(e,t,n,i,o){s.Z.dispatch({actionType:"IMPORT_PROGRESS",importType:e,importItemType:t,current:n,total:i,key:o})}static addImportWarning(e,t,n){s.Z.dispatch({actionType:"IMPORT_PROGRESS_WARN",importType:e,importItemType:t,message:n})}static addImportError(e,t,n){s.Z.dispatch({actionType:"IMPORT_PROGRESS_ERROR",importType:e,importItemType:t,message:n})}static clearImportProgress(e,t){s.Z.dispatch({actionType:"IMPORT_PROGRESS_CLEAR",importType:e,importItemType:t})}}},99827:(e,t,n)=>{"use strict";n.d(t,{Z:()=>be});var s=n(33638),i=n(91834),o=n(10671),a=n(58537),r=n(46382),l=n(60331),d=n(56371),c=n(60308),h=n(9982),p=n(92292),u=n(45660),g=n(6977),m=n(93818),v=n(24651),f=n(5204),y=n(16445),C=n(40348),w=n(7064),b=n(99895),S=n(32593),I=n(3664);async function k(){return new Promise(((e,t)=>{try{w.Z.importData.readMessageFromThunderbirdMailbox(((n,s)=>p.Z.runtime.lastError?(u.Z.error("Mail",["import","thunderbird"],"Error reading message",p.Z.runtime.lastError),t(p.Z.runtime.lastError)):e({message:n,seekPosition:Number(s)})))}catch(e){return u.Z.error("Mail",["import","thunderbird"],"Error reading message",p.Z.runtime.lastError),t(e)}}))}async function A(e,t,n,s,i,p,C){const w=await function(e){const t=(0,y.Z)(e);return(0,S.jm)(t,[],e)}(t);if(w.from.length+w.to.length+w.cc.length===0&&!w.subject){u.Z.warn("Mail",["import file",n,s,i],"Selected file does not seem to be a mail file");const t=(0,d.Z)("Selected file does not seem to be a mail file: $1",[i]);return C?r.Z.showModalInfo(e,{title:(0,d.Z)("Mail Import File"),body:t}):l.Z.setStatus(e,t),!1}const I=o.Z.getFolderType(n,s),{indexUpdates:k}=await(0,c.Z)(n,s,I,[w]);be.updateIndex(k);const{addedSles:A,sleUpdates:T}=k;let Z;if(A&&A.length>0?Z=A[0]:T&&T.length>0&&(Z=await(0,m.Z)(T[0].id),u.Z.info("Mail",["import file",n,s,i],"Message already exists but was also added to this folder -",w.subject)),Z){const{id:e,sentDate:t}=Z;return await b.Z.call(n,t,e,w.raw),await v.Z.setHasRaw(n,e),await(0,h.Z)(n,s,[w]),f.Z.filter(),a.Z.updateThreads(),p&&(await g.Z.addUpload([{accountId:n,path:s,searchListId:e,flags:[]}]),a.Z.flushBuffer()),!0}{u.Z.info("Mail",["import file",n,s,i],"Message already exists in this folder -",w.subject);const t=(0,d.Z)("Message already exists in this folder - $1",[w.subject]);return C?r.Z.showModalInfo(e,{title:(0,d.Z)("Mail Import File"),body:t}):l.Z.setStatus(e,t),!1}}async function T(e,t,n,s,i,o){const a=await async function(e,t){return new Promise((n=>{w.Z.importData.openThunderbirdMailbox(e,String(t),(e=>{n(Number(e))}))}))}(t,0);let r=await k();if(r.message){let d=0,c=0;const h=(0,I.sy)(r.message);for(await A(e,h,n,s,t,i,o&&-1===r.seekPosition)?d+=1:c+=1;r.seekPosition>-1;){l.Z.setStatus(e,`${t}: ${Math.floor(r.seekPosition/1e3)}/${Math.floor(a/1e3)} kB (${d} messages)`,5e3),r=await k();const o=(0,I.sy)(r.message);await A(e,o,n,s,t,i,!1)?d+=1:c+=1}return w.Z.importData.closeThunderbirdMailbox(),{numAdded:d,numFailed:c}}w.Z.importData.closeThunderbirdMailbox();const d=await(0,C.Z)(t);return await A(e,d,n,s,t,i,o)?{numAdded:1,numFailed:0}:{numAdded:0,numFailed:1}}var Z=n(95752),E=n(29087),_=n(15489),M=n(54773),N=n(25051),P=n(16152),D=n(89175),x=n(78614),O=n(8684),L=n(44850);const R=new Set,B=(0,P.Z)((async function(){const e=[...R].filter((e=>!Z.Z.call(e.sources)));if(R.clear(),e.length<=5)for(const t of e)await W(t);else await async function(e){const t=()=>{const e=_.ZP.getMailWindowId();r.Z.showMail(e)};(0,O.c)({title:(0,d.Z)("You have $1 new mail","You have $1 new mails",[e.length]),icon:"resources/mail_notification_icon.png",silent:!E.Z.get(D.kMailNotificationsSoundOn),onClick:t,timeout:V,tag:F})}(e)}),5e3),F="VIVALDI_MAIL_BATCHED_MULTIMAIL",V=36e5;function W(e){const t=(0,x.Rz)(M.Z.get(e.fromIds)),n=(0,x.Rz)(M.Z.get(e.toIds));(0,O.c)({title:e.subject,body:(0,d.Z)("New mail from $1 to $2",[t,n]),icon:"resources/mail_notification_icon.png",silent:!E.Z.get(D.kMailNotificationsSoundOn),onClick:()=>{const t=`message/${e.id}`,n=L.jk.internalUrl("mailpage",t,(0,d.Z)("Mail")),s=_.ZP.getMailWindowId();N.QJ.openURL(s,n),p.Z.windows.update(s,{drawAttention:!0})},timeout:108e5,tag:`VIVALDI_MAIL_MESSAGE_ID_${e.id}`})}const U={newMail:function(e){R.add(e),B()}};var H=n(26219),z=n(49168),G=n(93986),$=n(72010),K=n(82227),j=n(3184),Y=n(98611),X=n(36943),Q=n(54162),q=n(78347),J=n(95095),ee=n(48868),te=n(71320),ne=n(51501),se=n(45709),ie=n(28918),oe=n(68906),ae=n(33956);const re=async function(e,t){const{id:n}=e;return await ee.Z.searchList.update(n,{unseen:t}),[{id:n,updates:{unseen:t}}]};var le=n(95538),de=n(34198),ce=n(81830),he=n(67103),pe=n(18787),ue=n(5863),ge=n(65741),me=n(1407);function ve(e,t){const n=ne.Z.parseQuery(e),s=Date.now();return l.Z.setStatus(me.A4,(0,d.Z)("Searching for $1...",[n])),u.Z.log("Mail",["search"],`query:${e}, refined:${n}`),async function(e){return new Promise((t=>{try{w.Z.mailPrivate.searchMessages(e,t)}catch(t){console.error(`Search failed for query: ${e}`,t)}}))}(n).then((e=>{if(t()){const e=`Discarding results for outdated query: ${n}`;throw u.Z.log("Mail",["search"],`${e}`),new Error(e)}{const t=Date.now()-s;return l.Z.setStatus(me.A4,(0,d.Z)("Search for $2 returned $1 result in $3ms.","Search for $2 returned $1 results in $3ms.",[e.length,n,t])),u.Z.log("Mail",["search"],`search for ${n} returned ${e.length} results in ${t}ms`),e}}))}var fe=n(6129);function ye(e,t){s.Z.dispatch({actionType:"MAIL_SELECT_THREAD",threadPrefix:e,query:t})}function Ce(e){s.Z.dispatch({actionType:"MAIL_INIT_MESSAGES",folderIntersections:we.getViewIntersections(e)})}const we=new class{constructor(){te.Z.addListener((e=>{"updateFilters"===e.target&&we.updateFilters(e.filterIds)}))}updateThreadKeys(e){s.Z.dispatch({actionType:"MAIL_UPDATE_THREAD_KEYS",updates:e})}getSelectedFilter(){const e=Q.Z.getSelectedFolder();if(e){const{accountId:t,path:n}=e;return Y.Z.getByFolderId([t,n])}}markSeenReadDebounced=(0,P.Z)((async e=>{const t=we.getSelectedFilter();if(t&&ne.Z.getFilterOptions(t).showRead&&E.Z.get(D.kMailAutoMarkAsRead)){const t=se.Z.setRead([e],!0,!1);we.updateIndex({sleUpdates:t})}else if(e.unseen){const t=await re(e,!1);await oe.Z.call({priority:ue.Un.HIGH,type:"RE_RUN_SLES",searchListIds:[e.id]}),we.updateIndex({sleUpdates:t}),f.Z.filter()}}),1e3);setDisconnected(e,t,n){n&&u.Z.error("Mail",[e],n),s.Z.dispatch({actionType:"MAIL_IS_DISCONNECTED",accountId:e,isDisconnected:t,errorMessage:n})}setConnecting(e,t){s.Z.dispatch({actionType:"MAIL_IS_CONNECTING",accountId:e,isConnecting:t})}markAllReadCmd(){const e=Q.Z.getSelectedFolder();let t;if(e){const{accountId:n,path:s}=e;t=Y.Z.getByFolderId([n,s])}const n=Y.Z.getListEntries().filter((e=>!Z.Z.call(e.sources,t)));we.markAllListEntriesRead(n)}markAllRead(e,t){const n=e===ue.Ry&&t!==ue.ym?ne.Z.fromCustomFolderPath(t):[e,t],s=Y.Z.getListEntriesByFolder(...n),i=Y.Z.getByFolderId(n);if(!i)throw new Error("Filter not found");const o=s.filter((e=>!Z.Z.call(e.sources,i)));we.markAllListEntriesRead(o)}markAllListEntriesRead(e){const t=se.Z.setRead(e,!0);we.updateIndex({sleUpdates:t})}async removeAccount(e,t,n,s){await ee.Z.transaction("rw",[ee.Z.buffer,ee.Z.accounts],(async()=>{await(0,ie.Z)({accountId:e,path:"",operation:"BUFFER_OPERATION_REMOVE_ACCOUNT",deleteFiles:t,deletePasswords:n}),await ee.Z.accounts.delete(e)})),s===ue.s9.IMAP&&await j.Z.disconnectIMAPClient(e),await q.Z.removeAccount(e),f.Z.removeFolders(e),a.Z.flushBuffer()}async removeAccountPath(e,t,n){await ee.Z.transaction("rw",[ee.Z.buffer,ee.Z.accounts],(async()=>{await(0,ie.Z)({accountId:e,path:t,operation:"BUFFER_OPERATION_REMOVE_ACCOUNT_PATH",deleteFiles:!0}),n===ue.s9.IMAP&&await ee.Z.accounts.where("accountId").equals(e).modify((e=>{delete e.folders[t]}))})),a.Z.flushBuffer()}setSearchOptions(e){s.Z.dispatch({actionType:"MAIL_SEARCH_SET_OPTIONS",options:e})}async addLabelsFilter(e){const t={name:e,accountId:ue.ut,path:e,filterValue:{include:[[{flag:e}]],...ne.Z.getSearchListButtons(ue.ut)}},n=await K.Z.add(t,ue.Un.NORMAL);await te.Z.updateFilters(n)}async addFilter(e,t=!0,n){const{query:s}=e.filterValue;let i;s&&!n&&(n=await(0,ce.Z)(s),i=!0);const o=await ee.Z.transaction("rw",[ee.Z.filters,ee.Z.filteringQueue],(async()=>t?await K.Z.add(e,ue.Un.LOW,n,i):await K.Z.add(e)));return await te.Z.updateFilters(o),t&&f.Z.filter(),o}async putFilter(e,t,n){const s=n||function(e,t){if(e.filterValue.query!==t.filterValue.query)return!0;const{filterValue:n}=e,{filterValue:s}=t;return!(0,ge.Z)(n.include,s.include)||!(0,ge.Z)(n.exclude||[],s.exclude||[])||n.sentDate!==s.sentDate||n.attachments!==s.attachments||!(0,ge.Z)(e.triggers||[],t.triggers||[])}(e,t),i=await ee.Z.transaction("rw",[ee.Z.filters,ee.Z.filteringQueue],(async()=>{const t=await K.Z.put(e);return s&&oe.Z.call({type:"RUN_FILTERS",priority:ue.Un.LOW,filterIds:[e.id],triggerFilterIdCandidates:[e.id]}),t}));await te.Z.updateFilters(i),s&&f.Z.filter()}async removeFilter(e){await K.Z.remove([e]),te.Z.updateFilters([e]),f.Z.filter()}async rerunFilter(e,t){await oe.Z.call({type:"RUN_FILTERS",priority:ue.Un.LOW,folderIds:[[e,t]]}),f.Z.filter()}async runStoredQueryFilters(e){const t=Y.Z.getByAccountId(ue.Kz);if(0===t.length)return;const n=t.map((e=>[e.accountId,e.path]));await oe.Z.call({type:"FILTERS_SLES",priority:ue.Un.NORMAL,folderIds:n,searchListIds:e}),f.Z.filter()}async updateFilters(e){s.Z.dispatch({actionType:"MAIL_FILTERS_CHANGED",filterIds:e});const t=[];e.forEach((e=>ne.Z.getAllViewTypes().forEach((n=>t.push(e*ue.XN+n))))),we.updateCounters(t)}async toggleMoveToOther(e){const t=e.path;let n,s,i;t.startsWith(ue.cs)?(s=ue.W4,n=ue.cs,i=t.substr(ue.cs.length+1)):(s=ue.cs,n=ue.W4,i=t.substr(ue.W4.length+1));const o=await K.Z.move(e.accountId,n,s,i);await te.Z.updateFilters(o),we.selectFolder({...e,path:[s,i].join("/"),id:ue.jT+"_"+[s,i].join("/")},Q.Z.getOptions()),f.Z.filter()}async removeMailingListFilter(e,t){const n=t.filterValue.include,i=n&&n[0],o=i&&i[0];if(o?.listId){const e=o.listId,n={listId:e,name:e,parentFolderType:"matches",subFolderType:"none",isIgnored:!0};await f.Z.updateMailingListGroup(n),await K.Z.remove([t.id]),await te.Z.updateFilters([t.id]),s.Z.dispatch({actionType:"MAILING_LIST_GROUP_CHANGED",mailingListGroup:n}),f.Z.filter()}else o?.senderIsMailingList&&await we.toggleSenderAsMailingList(e,o.senderIsMailingList)}async toggleSenderAsMailingList(e,t){const n=ue.wC,s=[ue.W4,ue.cs],i=[{senderIsMailingList:t}],o=s.map((e=>Y.Z.getByFolder(n,[e,t].join("/")))).find((e=>void 0!==e));if(o)await K.Z.remove([o.id]),await te.Z.updateFilters([o.id]);else{const e={name:t,accountId:n,path:`${ue.W4}/${t}`,filterValue:{include:[i],exclude:[[{flag:ue.T4.DELETED}]],...ne.Z.getSearchListButtons(ue.wC)}},s=await ve(`from:${t}`,(()=>!1)),o=await K.Z.add(e,ue.Un.LOW,s);await te.Z.updateFilters(o)}f.Z.filter()}updateQueryResults(e,t,n,i,o){const a=ne.Z.joinQueries(e,i);e.length>0&&we.changeQuery(e);const r=Q.Z.getOptions();if(void 0!==i&&i!==r.queryAddition&&Q.Z.changeQueryAddition(i),ne.Z.isValidSearch({...r,query:e,queryAddition:i})){const e=r.queryOptions,i={actionType:"MAIL_UPDATE_QUERY_RESULTS",queryResults:[],threadPrefix:n,folder:r.queryFolder||t,filterOptions:e,attachments:r.attachments,sentDate:r.sentDate,updateScrollPosition:o};a?ve(a,(function(){const e=ne.Z.joinQueries(Q.Z.getQuery(),Q.Z.getOptions().queryAddition);return a!==e})).then((e=>{i.queryResults=e,s.Z.dispatch(i)})).catch((()=>{})):(i.queryResults=Y.Z.getIndexSearchListIds(),s.Z.dispatch(i))}else l.Z.clearStatus(me.A4),we.clearQuery()}changeQuery(e){s.Z.dispatch({actionType:"MAIL_QUERY_CHANGE",query:e})}clearQuery(){s.Z.dispatch({actionType:"MAIL_CLEAR_QUERY"})}clearSearch(){s.Z.dispatch({actionType:"MAIL_CLEAR_SEARCH"})}showMailSearchOptions(){s.Z.dispatch({actionType:"SHOW_MAIL_SEARCH_OPTION"})}async regenerateUncategorizedMailingLists(){const e=Y.Z.getByAccountId(ue.wC),t=de.Z.mailingListGroupToFilters(e),n=le.Z.getGroups(),s=t.filter((e=>!n.some((t=>t.listId===e.path.split("/")[1]))));await we.regenerateMailingLists(s,!0)}async regenerateAllMailingLists(){const e=Y.Z.getByAccountId(ue.wC),t=de.Z.mailingListGroupToFilters(e);await we.regenerateMailingLists(t,!0)}async regenerateExistingMailingListGroup(e,t){const n=Y.Z.getByAccountId(ue.wC),s=de.Z.mailingListGroupToFilters(n,t);if(le.Z.get(ue.ZW)?.isIgnored)await we.regenerateMailingLists(s,!0);else{const e=de.Z.mailingListGroupToFilters(n,t),i=[...new Set([...s,...e])];await we.regenerateMailingLists(i,!1)}}async regenerateMailingListGroup(e,t=!1){const n=Y.Z.getByAccountId(ue.wC),s=de.Z.mailingListGroupToFilters(n,e);await we.regenerateMailingLists(s,t)}async regenerateMailingLists(e,t=!1){let n;if(!t){const t=e.map((e=>ne.Z.getTotalViewIdByFilterId(e.id)));n=Y.Z.getListEntryIdsByViewIds(t)}await K.Z.remove(e.map((({id:e})=>e)));const s=new Set;for(const t of e)s.add(t.id);await te.Z.updateFilters([...s]),await oe.Z.call({priority:ue.Un.LOW,type:"RE_RUN_SLES",searchListIds:n,runMailingLists:!0}),f.Z.filter()}async refreshMailingList(){await oe.Z.call({priority:ue.Un.LOW,type:"RE_RUN_SLES",runMailingLists:!0}),f.Z.filter()}async removeMailingListGroup(e){await f.Z.removeMailingListGroup(e),await we.regenerateMailingListGroup(e),s.Z.dispatch({actionType:"MAILING_LIST_GROUP_CHANGED",mailingListGroup:e})}async removeIgnoredMailingList(e){await f.Z.removeMailingListGroup(e),await we.refreshMailingList(),s.Z.dispatch({actionType:"MAILING_LIST_GROUP_CHANGED",mailingListGroup:e})}async initIndex(){const e=await ee.Z.searchList.count();let t=1e3,n=-1;await async function i(){const o=Date.now(),[a,r]=await Promise.all([ee.Z.searchList.where("id").above(n).limit(t).toArray(),ee.Z.viewIds.where("searchListId").above(n).limit(t).toArray()]);if(s.Z.dispatch({actionType:"MAIL_INIT_INDEX_BATCH",sleBatch:a,viewIdsBatch:r,total:e}),a.length===t){const{id:e}=a[t-1];n=e;const s=Date.now();t=J.Z.adjustBatchSize(1e3,1e5,50,t,s-o),await i()}}(),s.Z.dispatch({actionType:"MAIL_INIT_INDEX_FINISHED"})}updateIndex(e){s.Z.dispatch({actionType:"MAIL_INDEX_UPDATE",updates:e});const{sleUpdates:t=[]}=e,n=Q.Z.getQuery(),i=we.getViewIntersections();let a=!1;const r=new Set(E.Z.get(D.kMailAccounts).filter((e=>e.offline)).map((e=>e.MAIL_EMAIL))),l=new Map,d=new Map,c=[],h=[],p=[];function u(e,t){let n;switch(t.type){case"ADD_LABEL":n=l.get(t.label),n?n.push(e):l.set(t.label,[e]);break;case"REMOVE_LABEL":n=d.get(t.label),n?n.push(e):d.set(t.label,[e]);break;case"MARK_READ":c.push(e);break;case"SET_FLAG":const s=(0,z.KR)(t.flag);for(const t in s)s[t]?(n=l.get(t),n?n.push(e):l.set(t,[e])):(n=d.get(t),n?n.push(e):d.set(t,[e]));break;case"MARK_AS_SPAM":h.push(e);break;case"ARCHIVE":p.push(e)}}function g(e,t){const n=te.Z.get(e);if(!n)throw new Error("Filter not found "+e);const s=n.triggers;if(s){const e=we.getViewIntersections({accountId:n.accountId,path:n.path,name:n.name,id:ne.Z.toFolderPath(n.accountId,n.path)});for(const n of s)e&&!Y.Z.matchesViewIntersection(t.viewIds,e,t.totalViewIds)||u(t,n)}}t.forEach((e=>{const t=Y.Z.getListEntry(e.id),{addedViewIds:s,runTriggerFilterIds:l}=e.updates;if(t){if(n&&i&&(a=Y.Z.matchesViewIntersection(t.viewIds,i,t.totalViewIds)),E.Z.get(D.kMailNotifications)){const e=s?.some((e=>{if(e%ue.XN!=0)return!1;const n=e/ue.XN,s=te.Z.get(n);if(!s)return!1;const{accountId:i,path:a}=s;if(r.has(i))return!1;if(!(o.Z.getFolderType(i,a)===ue.e9))return!1;const l=(0,G.Ps)(i);return!l||t.sentDate>l}));e&&U.newMail(t)}if(s)for(const e of s){if(e%ue.XN!=0)continue;g(e/ue.XN,t)}l&&l.forEach((e=>{g(e,t)}))}else console.warn("ListEntry not found "+JSON.stringify(e))})),a&&we.updateQueryResults(n),l.forEach(((e,t)=>{se.Z.setCustomFlags(e,{[t]:!0})})),d.forEach(((e,t)=>{se.Z.setCustomFlags(e,{[t]:!1})})),c.length>0&&se.Z.setRead(c,!0),h.length>0&&X.Z.moveToJunk(h),p.length>0&&X.Z.moveToArchive(p)}async updateMailingListGroupName(e){await f.Z.updateMailingListGroup(e);const t=await K.Z.updateName([[ue.wC,ue.W4+"/"+e.listId],[ue.wC,ue.cs+"/"+e.listId]],e.name);te.Z.updateFilters(t),s.Z.dispatch({actionType:"MAILING_LIST_GROUP_CHANGED",mailingListGroup:e})}async updateMailingListGroup(e){const t=le.Z.get(e.listId);if(await f.Z.updateMailingListGroup(e),"uncategorized"===e.parentFolderType)await we.regenerateUncategorizedMailingLists();else if(t?.isIgnored&&!e.isIgnored)await we.refreshMailingList();else if(t)await we.regenerateExistingMailingListGroup(t,e);else{const t=!0;await we.regenerateMailingListGroup(e,t)}s.Z.dispatch({actionType:"MAILING_LIST_GROUP_CHANGED",mailingListGroup:e})}stop(){s.Z.dispatch({actionType:"MAIL_STOP"})}setAccountIndicator(e,t,n=0,i=0,o=0){s.Z.dispatch({actionType:"MAIL_INDICATOR_ADD_ACCOUNT",accountId:e,indicatorType:t,priority:n,current:i,total:o})}setPathIndicator(e,t,n,i,o,a){s.Z.dispatch({actionType:"MAIL_INDICATOR_ADD_PATH",accountId:e,path:t,indicatorType:n,priority:i,current:o,total:a})}removeAccountIndicator(e,t){s.Z.dispatch({actionType:"MAIL_INDICATOR_REMOVE_ACCOUNT",accountId:e,indicatorType:t})}removePathIndicator(e,t){s.Z.dispatch({actionType:"MAIL_INDICATOR_REMOVE_PATH",accountId:e,path:t})}removeAllIndicators(e){s.Z.dispatch({actionType:"MAIL_INDICATOR_REMOVE_ALL",accountId:e})}updateCounters(e){const t=Date.now(),n=Y.Z.getCounterFolders(e);0!==n.length&&(Y.Z.getIndex().forEach((e=>{const{viewIds:t,totalViewIds:s}=e;i.Z.updateCounterFolders(t,s,1,n)})),s.Z.dispatch({actionType:"MAIL_UPDATE_COUNTERS",countedFolders:n,deltaValues:!1}),u.Z.log("Mail",["counters"],`updateCounters took ${Date.now()-t}ms.`))}pageForward(e){if(Q.Z.canGoForward()){const t=Q.Z.getHistoryIndex();we.selectFolderFromHistory(e,t+1)}}pageBack(e){if(Q.Z.canGoBack()){const t=Q.Z.getHistoryIndex();we.selectFolderFromHistory(e,t-1)}}selectFolderFromHistory(e,t){const n=Q.Z.getOptionsFromHistory(t),i=Q.Z.getFolderFromHistory(t);s.Z.dispatch({actionType:"MAIL_FOLDER_SELECT_HISTORY_INDEX",historyIndex:t}),n.threadPrefix&&ye(n.threadPrefix,n.query),n.query&&we.updateQueryResults(n.query,i,n.threadPrefix,n.queryAddition),n.query||n.threadPrefix||Ce()}selectFolder(e,t={}){s.Z.dispatch({actionType:"MAIL_SELECT_FOLDER",folder:e,options:t}),t.threadPrefix?ye(t.threadPrefix):Ce()}selectFolderOnSubscriptionChange(e,t){const n={...e,subscribed:t},s=(e&&te.Z.getByFolderId([n.accountId,n.path]))?.filterValue.query||"";we.selectFolder(n,{query:s})}getImapFolderInfo(e){let t=e.accountId,n=e.path;if(e.accountId===ue.Ry){const s=e.path.indexOf("/");t=e.path.slice(0,s),n=e.path.slice(s+1)}return{imapAccountId:t,imapPath:n}}async importMailFiles(e,t,n,s){let i=!1;(0,fe.mq)(n)&&(i=await async function(){return new Promise((t=>{r.Z.showMailUploadConfirmation(e,n,t)}))}());let o=0,a=0;for(const r of t){const c=await w.Z.mailPrivate.getFullPath(r.filesystem.name,r.fullPath);l.Z.setStatus(e,(0,d.Z)("Importing message from file $1",[c]));try{const{numAdded:r,numFailed:l}=await T(e,c,n,s,i,1===t.length);o+=r,a+=l}catch(t){l.Z.setStatus(e,(0,d.Z)("Failed to import mail file: $1",[t])),u.Z.error("Mail",["import file",n,s],t)}}const c=(0,d.Z)("Finished importing $1 message.","Finished importing $1 messages.",[o]);let h=c;if(a>0){h=`${c} ${(0,d.Z)("Failed adding $1 message. See logs in Mail Status for details.","Failed adding $1 messages. See logs in Mail Status for details.",[a])}`}r.Z.showModalInfo(e,{title:(0,d.Z)("Mail Import File"),body:h})}async selectAndImportMailFiles(e,t){const n=await(0,H.Z)(e,["eml","mbs","mbox"]),{accountId:s,path:i}=t;this.importMailFiles(e.vivaldiWindowId,n,s,i)}async subscribeMailbox(e,t){const{imapAccountId:n,imapPath:s}=we.getImapFolderInfo(t);we.selectFolderOnSubscriptionChange(t,!0);try{await j.Z.subscribeMailbox(n,s)}catch(n){we.selectFolderOnSubscriptionChange(t,!1),l.Z.setStatus(e,(0,d.Z)("Failed to subscribe to mailbox: $1",[n])),console.error(n)}}async unsubscribeMailbox(e,t,n){const{imapAccountId:s,imapPath:i}=we.getImapFolderInfo(t);try{we.selectFolderOnSubscriptionChange(t,!1);try{await j.Z.unsubscribeMailbox(s,i,n)}catch(e){throw we.selectFolderOnSubscriptionChange(t,!0),e}n&&we.removeAccountPath(s,i,ue.s9.IMAP)}catch(t){l.Z.setStatus(e,(0,d.Z)("Failed to unsubscribe from mailbox: $1",[t])),console.error(t)}}selectThread(e){const t=[e.threadKey[0],e.threadKey[1]],n={accountId:ue.tQ,path:String(t),id:String(t),name:e.subject},s={threadPrefix:t};we.selectFolder(n,s)}async rerunThreading(e,t){const n=q.Z.getFolderName(e,t);l.Z.setStatus(me.A4,(0,d.Z)("Re-threading - $1 $2",[e,n]),5e3);const s=te.Z.getByFolderId([e,t]);if(!s)throw new Error(`Filter not found for ${e} ${n}`);const i=ne.Z.getTotalViewIdByFilterId(s.id),o=Y.Z.getListEntryIdsByViewIds([i]);await(0,ae.Z)(o),a.Z.updateThreads()}selectContactById(e,t){this.selectContact(e,t)}selectContactByAddress(e,t){this.selectContact(e,void 0,t)}selectContactByIdAndAddress(e,t,n){this.selectContact(e,t,n)}selectContact(e,t,n){let i="",o=[];const a=t?$.Z.getNodeById(t):void 0;n?(o=[n],i=n):a&&(i=a.name,o=a.emailAddresses.map((e=>e.emailAddress)));const r={accountId:ue.of,path:ue.ym,id:i,name:i},l=ne.Z.getContactQuery(o,new Set(["to","from"])),d={forSender:n,forContact:t,query:l,queryFolder:r};s.Z.dispatch({actionType:"MAIL_SELECT_FOLDER",folder:r,options:d});we.updateQueryResults(l,r,undefined)}sortListEntries(e=!1){s.Z.dispatch({actionType:"MAIL_SORT_LIST_ENTRIES",wasThreads:e});const t=Q.Z.getQuery();t&&we.updateQueryResults(t)}getViewIntersections(e){if(e||(e=Q.Z.getSelectedFolder()),!e)return;const{accountId:t,path:n=ue.ym}=e,s=Y.Z.getByFolder(t,n);return s?ne.Z.getViewIntersections(s):void 0}undo(){const e=pe.Z.pop();if(e)switch(e.operation){case"setFlags":this.undoSetFlags(e);break;case"delete":this.undoDelete(e)}}undoSetFlags(e){const{updates:t,updateItems:n,sourcesPerSle:s}=e;if(0===n.length)return;const i=se.Z.setCustomFlags(n,t,s,!1);we.updateIndex({sleUpdates:i})}undoDelete(e){const{listEntries:t,markUnread:n}=e;(0,he.Z)(t,n)}},be=we},2431:(e,t,n)=>{"use strict";n.d(t,{J:()=>_,Z:()=>F});var s=n(72010),i=n(13933),o=n(98611),a=n(54162),r=n(53576),l=n(96951),d=n(29087),c=n(15489),h=n(56371),p=n(71320),u=n(10671),g=n(88951),m=n(50399),v=n(97823),f=n(55346),y=n(93818),C=n(30381),w=n.n(C),b=n(51370),S=n(5863),I=n(44850),k=n(27569),A=n(78614),T=n(89175),Z=n(97781);async function E(e,t,n){const{inReplyTo:s,references:o}=N(e),{bodyParts:a=[],listId:r,listPost:l}=e,{cidAttachments:d}=R(a),c=L(a),p=function(e,t,n){let s=O(e,t);s=(0,k.$P)(n,s);const i=w()(e.sentDate).format("LLLL (Z)"),o=e.from,a=n?"\n\n":"<br><br>",r=o.length>0?o[0].name||o[0].address:"unknown",l=(0,h.Z)("On $1, $2 wrote:",[i,r])+a;return s?n?a+l+"> "+s.replace(/\r?\n/g,"\n> "):`${a}${l}<blockquote style="margin: 0 0 0.80ex; border-left: #0000FF 2px solid; padding-left: 1ex">${s}</blockquote>`:l}(e,d,c),{selectedAccount:u,from:g,messageId:m}=B(e),v=Date.now(),f={selectedAccount:u,messageId:m,from:[...g],subject:x(e,"Re: "),sentDate:v,threadKey:[v,e.id,v],attachments:[],to:t,cc:n,bcc:[],plaintext:c,cidAttachments:d,body:p,listId:r,listPost:l,inReplyTo:s,references:o,focusOnBody:!0,replied:e.id,fromDraft:!1};i.Z.set(f),await P()}function _(e){const{from:t,messageId:n,selectedAccount:s}=B(void 0,"account");return{bcc:[],body:"",cc:[],subject:"",to:[],...(0,b.Z)(e),attachments:[],from:t,messageId:n,plaintext:!0,selectedAccount:s,sentDate:Date.now(),listId:"",listPost:""}}function M(e,t){const{bodyParts:n=[]}=e,s=L(n),{attachments:i,cidAttachments:o}=R(n),a=O(e,o),{listId:r,listPost:l,inReplyTo:d,references:c,messageId:h,to:p,cc:u,bcc:g,subject:m,sentDate:v}=e,{selectedAccount:f,from:y}=B(e,"message");return{plaintext:s,attachments:i,cidAttachments:o,body:a,listId:r,listPost:l,inReplyTo:d,references:c,messageId:h,to:p,cc:u,bcc:g||[],subject:m,sentDate:v,selectedAccount:f,from:[...y],threadKey:t}}function N(e){const{messageId:t,inReplyTo:n,references:s}=e,i={inReplyTo:t,references:s?s.slice():[]};return 0===i.references.length&&n&&i.references.push(n),t&&i.references.push(t),i}async function P(e){const t=c.ZP.getMailWindowId(),n=D(e);await r.ZP.openURL(t,n,{singleton:Boolean(e)})}function D(e){return I.jk.internalUrl("mailpage","composer/draft",(0,h.Z)("Mail - Draft"),e?JSON.stringify({id:e}):void 0)}function x(e,t=""){if(!e)return"";const n=e.subject||"";return 0===n.toLowerCase().indexOf(t.toLowerCase())?n:t+n}function O(e,t){const n=(0,m.Z)(!0,e.bodyParts);return n&&n.content?"html"===n.type?function(){const i={};t.forEach((e=>{e.id&&(i["cid:"+e.id]=e)}));const o=(r=e.from,r&&r.length>0&&s.Z.isTrustedEmailAddress(r[0].address)),a=(0,Z.Nw)(n.content,{attachments:i,blockHTTPLeaks:!e.trusted&&!o});var r;return a.sanitized}():n.content:""}function L(e){const t=(0,m.Z)(!0,e);return!t||"html"!==t.type}function R(e){const t=[],n=[];return(0,k.yN)(e).forEach((e=>{if(e.inUse)n.push(e);else{const{id:n,inUse:s,...i}=e;t.push(i)}})),{attachments:t,cidAttachments:n}}function B(e,t){const n=d.Z.get(T.kMailDefaultAccount)||S.Y6,s=d.Z.get(T.kMailLastSentFrom),i=v.Z.getAccountsAndAliases();let r,l,c;if(i.length>0){if("account"===t){const e=a.Z.getSelectedFolder();if(e?.accountId&&(r=i.find((t=>t.MAIL_EMAIL===e.accountId))),!r&&e?.accountId===S.Ry){const t=e?.path.split("/")[0];r=i.find((e=>e.MAIL_EMAIL===t))}}else if(e){const{from:n,to:s}=e,a=n.map((e=>e.address)),l=s.map((e=>e.address));if("message"===t?a.length>0&&(r=i.find((e=>a.includes(e.MAIL_EMAIL)))):l.length>0&&(r=i.find((e=>l.includes(e.MAIL_EMAIL)))),!r){const t=o.Z.getSourceFilters(e.id),n=new Set(t.map((e=>e.accountId)));r=i.find((e=>n.has(e.MAIL_EMAIL)))}}!r&&n===S.Y6&&s&&(r=i.find((e=>e.MAIL_EMAIL===s))),r||n===S.Y6||(r=i.find((e=>e.MAIL_EMAIL===n))),r||(r=i[0])}return r?(l=[{name:r.MAIL_NAME,address:r.MAIL_EMAIL}],c=(0,g.Z)(r.MAIL_EMAIL)):(l=[],c=(0,g.Z)()),{selectedAccount:r,from:l,messageId:c}}const F={closeComposer:function(e,t){const n=D(t);r.ZP.closeUrl(e,n)},createDraft:async function(e={}){const{selectedAccount:t,from:n,messageId:s}=B(void 0,"account"),{to:o,cc:a,bcc:r,subject:l="",body:d=""}=e;if(!t)return;const c={selectedAccount:t,messageId:s,subject:l,body:d,from:[...n],sentDate:Date.now(),to:o||[],cc:a||[],bcc:r||[],plaintext:!0,attachments:[],fromDraft:!1,listId:"",listPost:""};i.Z.set(c),await P()},createDraftFromParsedMessage:function(e){const{bodyParts:t=[]}=e,n=L(t),{attachments:s,cidAttachments:o}=R(t),a=O(e,o),{selectedAccount:r,from:l,messageId:d}=B(e,"message"),{to:c,cc:h,bcc:p}=e,u={to:c,cc:h,bcc:p||[],sentDate:Date.now(),subject:x(e),plaintext:n,attachments:s,cidAttachments:o,body:a,focusOnBody:!0,selectedAccount:r,from:[...l],messageId:d,fromDraft:!1,listId:"",listPost:""};i.Z.set(u),P()},forward:async function(e){const{inReplyTo:t,references:n}=N(e),{bodyParts:s=[]}=e,{attachments:o,cidAttachments:a}=R(s),r=L(s),l=function(e,t,n){const s=O(e,t),i=w()(e.sentDate).format("LLLL (Z)"),o=(0,A.Rz)(e.from),a=(0,A.Rz)(e.to),r=(0,A.Rz)(e.cc);let l=`\n\n----- ${(0,h.Z)("Forwarded message")} -----\n`;o&&(l+=(0,h.Z)("From: $1",[o])+"\n");a&&(l+=(0,h.Z)("To: $1",[a])+"\n");r&&(l+=(0,h.Z)("Cc: $1",[r])+"\n");e.subject&&(l+=(0,h.Z)("Subject: $1",[e.subject])+"\n");return l+=(0,h.Z)("Date: $1",[i])+"\n\n\n",(n?l:l.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>"))+s}(e,a,r),{selectedAccount:d,from:c,messageId:p}=B(e),u=Date.now(),g={selectedAccount:d,messageId:p,from:[...c],sentDate:u,threadKey:[u,e.id,u],to:[],cc:[],bcc:[],subject:x(e,"Fwd: "),plaintext:r,attachments:o,cidAttachments:a,body:l,listId:"",listPost:"",inReplyTo:t,references:n,forwarded:e.id,fromDraft:!1};i.Z.set(g),await P()},open:function(e,t){const n=M(e,t);i.Z.set(n),P(e.id)},prepareDraft:async function(e){const[t,n]=await Promise.all([f.Z.call(e),(0,y.Z)(e)]);if(!t||!n)return!1;const s=M(t,n.threadKey);return i.Z.set(s),!0},reply:async function(e){let t;const n=o.Z.getListEntry(e.id);t=(n?n.sourceFilterIds.map((e=>p.Z.get(e))):[]).some((e=>e&&u.Z.getFolderType(e.accountId,e.path)===S.Nz))?e.to:e.replyTo&&e.replyTo.length>0?e.replyTo:e.from,await E(e,t,[])},replyToAll:async function(e){const t=v.Z.getAccountsAndAliases()||[],{from:n,to:s,replyTo:i,cc:o}=e,a=(0,A.Yn)(...i,...n,...s).filter((e=>t.every((t=>t.MAIL_EMAIL!==e.address)))),r=(0,A.Yn)(...o).filter((e=>t.every((t=>t.MAIL_EMAIL!==e.address))));await E(e,[...a],[...r])},replyToList:async function(e){const{listPost:t}=e,n=t.match(/mailto:\s*([^>,]+)/),s=n?[{address:n[1]}]:[];await E(e,s,[])},closeMailPages:function(){const e=I.xy.mailpage,t=l.ZP.filterPagesInAllWindows((t=>t.url.startsWith(e)));r.ZP.closePage(t)}}},46382:(e,t,n)=>{"use strict";n.d(t,{Z:()=>w});var s=n(12442),i=n(53576),o=n(29087),a=n(33638),r=n(63153),l=n(15489),d=n(56371),c=n(2497),h=n(7064),p=n(1407),u=n(12964),g=n(89175),m=n(44850);const v="window.html";let f;function y(e){const{screen:t}=(0,c.Z)(e),n=Math.max(o.Z.get(g.kSettingsSizeWidth),p.MK),s=Math.max(o.Z.get(g.kSettingsSizeHeight),p.mR),i=o.Z.get(g.kSettingsSizeLeft),a=o.Z.get(g.kSettingsSizeTop),r=s<=t.height?s:t.height;let l=i>=0?i:t.availLeft+n/2,d=a>=0?a:t.availTop+(t.height-s)/2;d<0&&(d=0);l+n>t.availLeft+t.width&&(l=t.availLeft+(t.width-n),l<0&&(l=0));return{left:Math.round(l),top:Math.round(d),width:Math.round(n),height:Math.round(r)}}const C=new class{openGuestWindow(){h.Z.runtimePrivate.switchToGuestSession((e=>{e||console.warn("Guest mode is disabled.")}))}closeGuestSession(){h.Z.runtimePrivate.closeGuestSession((e=>{e||console.warn("Guest mode is disabled.")}))}managePeople(){return h.Z.runtimePrivate.openProfileSelectionWindow()}closeActiveProfile(){h.Z.runtimePrivate.closeActiveProfile((e=>{e||console.warn("Failed to open profile window.")}))}showAddFeed(e,t){a.Z.dispatch({actionType:"MAIN_SHOW_ADD_FEED",winId:e,options:t})}showAddMailFolder(e,t){a.Z.dispatch({actionType:"MAIN_SHOW_ADD_MAIL_FOLDER",winId:e,options:t})}showDeleteMailFolder(e,t){a.Z.dispatch({actionType:"MAIN_SHOW_DELETE_MAIL_FOLDER",winId:e,options:t})}showDeleteWorkspace(e,t){a.Z.dispatch({actionType:"MAIN_SHOW_DELETE_WORKSPACE",winId:e,options:t})}showQuickCommand(e){a.Z.dispatch({actionType:"MAIN_SHOW_QUICKCOMMANDS",winId:e})}async showCalendar(e,t){try{const n=await i.ZP.openURL(e,"vivaldi://calendar",{singleton:!0});t&&s.Z.selectEvent(n.pageId,{eventId:t})}catch(e){console.error(e)}}showCalendarNotification(e,t){a.Z.dispatch({actionType:"MAIN_SHOW_CALENDAR_ALARM",winId:e,options:t})}showCalendarEditEvent(e,t){a.Z.dispatch({actionType:"MAIN_SHOW_CALENDAR_EDIT_EVENT",winId:e,options:{event:t}})}showEditEventTemplate(e,t){a.Z.dispatch({actionType:"MAIN_SHOW_CALENDAR_EDIT_TEMPLATE",winId:e,options:t})}showCalendarImportEvents(e,t){a.Z.dispatch({actionType:"MAIN_SHOW_CALENDAR_IMPORT_EVENTS_DIALOG",winId:e,options:{uri:t}})}showKeyboardShortcuts(e){a.Z.dispatch({actionType:"MAIN_SHOW_KEYBOARDS_SHORTCUTS",winId:e})}showPageAccessKeys(e){a.Z.dispatch({actionType:"MAIN_SHOW_PAGE_ACCESS_KEYS",winId:e})}showConfirmOpenLinksDialog(e,t){a.Z.dispatch({actionType:"MAIN_SHOW_CONFIRM_OPEN_LINKS_DIALOG",winId:e,options:t})}showConfirmCloseOtherTabsDialog(e,t){a.Z.dispatch({actionType:"MAIN_SHOW_CONFIRM_CLOSE_OTHER_TABS_DIALOG",winId:e,options:t})}showClearBrowsingHistoryDialog(e){a.Z.dispatch({actionType:"MAIN_SHOW_CLEAR_BROWSING_HISTORY_DIALOG",winId:e})}showModal(e,t){return new Promise((n=>a.Z.dispatch({actionType:"MAIN_SHOW_MODAL_DIALOG",winId:e,options:{...t,resolve:n}})))}showModalInfo(e,t){a.Z.dispatch({actionType:"MAIN_SHOW_MODAL_INFO",winId:e,options:t})}showImportDataDialog(e){a.Z.dispatch({actionType:"MAIN_SHOW_IMPORT_DATA_DIALOG",winId:e})}showBookmarkDialog(e,t){a.Z.dispatch({actionType:"MAIN_SHOW_BOOKMARK_DIALOG",winId:e,options:t})}showBookmarkAddedPopup(e,t){a.Z.dispatch({actionType:"MAIN_SHOW_BOOKMARK_ADDED_POPUP",winId:e,options:t})}async showMail(e){await i.ZP.openURL(e,m.jk.internals.mailpage,{singleton:!0})}showMailUnsubscribeDialog(e,t){const n={actionType:"MAIN_SHOW_MAIL_UNSUBSCRIBE_DIALOG",winId:e,options:t};a.Z.dispatch(n)}showMailAuthenticationDialog(e,t){const n={actionType:"MAIN_SHOW_MAIL_AUTHENTICATION_DIALOG",winId:e,options:t};a.Z.dispatch(n)}showMailDeleteDialogSetting(e,t){const n={actionType:"MAIN_SHOW_MAIL_DELETE_DIALOG_SETTING",winId:e,options:t};a.Z.dispatch(n)}showMailDeleteDialogFolders(e,t){const n={actionType:"MAIN_SHOW_MAIL_DELETE_DIALOG_FOLDERS",winId:e,options:t};a.Z.dispatch(n)}showMailDeleteDialogAccounts(e,t){const n={actionType:"MAIN_SHOW_MAIL_DELETE_DIALOG_ACCOUNTS",winId:e,options:t};a.Z.dispatch(n)}showMailDeleteDialogConfirmAll(e,t){const n={actionType:"MAIN_SHOW_MAIL_DELETE_DIALOG_CONFIRM_ALL",winId:e,options:t};a.Z.dispatch(n)}showSaveSessionDialog(e,t){a.Z.dispatch({actionType:"MAIN_SHOW_SAVE_SESSION_DIALOG",winId:e,options:t})}showOpenSessionDialog(e){a.Z.dispatch({actionType:"MAIN_SHOW_OPEN_SESSION_DIALOG",winId:e})}showDialog(e,t,n){const s={actionType:"MAIN_SHOW_DIALOG",winId:e,options:t,onAfterClose:n};a.Z.dispatch(s)}async showExtensions(e){await i.ZP.openURL(e,"vivaldi://extensions",{singleton:!0})}async showHistory(e){await i.ZP.openURL(e,"vivaldi://history",{singleton:!0})}async showNotes(e){await i.ZP.openURL(e,"vivaldi://notes",{singleton:!0})}async showBookmarks(e){await i.ZP.openURL(e,"vivaldi://bookmarks",{singleton:!0})}async showWelcome(e){await i.ZP.openURL(e,"vivaldi://welcome")}async showSettings(e,t="general",n){const s=n&&!(0,u.Z)(n)?Object.keys(n).map((e=>`${e}=${n[e]??""}`)).join("&"):"";if(o.Z.get(g.kSettingsInTab))await i.ZP.openURL(e,`vivaldi://settings/${t}/?${s}`,{singleton:!0,skipParams:!0});else{l.ZP.settingsCategory=`${t}&${s}`;const n={bounds:y(e),windowKey:"settings"};await r.Z.openWindow(e,v,"settings",n)}}showAccountSheet(e,t="login"){const n={actionType:"MAIN_SHOW_ACCOUNT_SHEET",winId:e,options:t};a.Z.dispatch(n)}showAddCustomLabel(e){a.Z.dispatch({actionType:"MAIN_SHOW_CREATE_LABEL",winId:e})}showDeleteCustomLabelConfirmation(e,t,n){a.Z.dispatch({actionType:"MAIN_SHOW_DELETE_LABEL_CONFIRMATION",winId:e,options:{label:t,callback:n}})}showDeleteFilterConfirmation(e,t,n){a.Z.dispatch({actionType:"MAIN_SHOW_DELETE_FILTER_CONFIRMATION",winId:e,options:{label:t,callback:n}})}showMailFilterViewConfirmation(e,t,n){a.Z.dispatch({actionType:"MAIN_SHOW_MAIL_VIEW_FILTER_CONFIRMATION",winId:e,options:{label:t,callback:n}})}showMailUploadConfirmation(e,t,n){a.Z.dispatch({actionType:"MAIN_SHOW_MAIL_UPLOAD_CONFIRMATION",winId:e,options:{accountId:t,callback:n}})}showMessageMoveConfirmation(e,t,n,s){a.Z.dispatch({actionType:"MAIN_SHOW_MAIL_MESSAGE_MOVE_CONFIRMATION",winId:e,options:{callback:t,title:n,body:s}})}showCreateArchiveFolderConfirmation(e,t,n,s){a.Z.dispatch({actionType:"MAIN_SHOW_MAIL_CREATE_ARCHIVE_FOLDER_CONFIRMATION",winId:e,options:{callback:t,title:n,body:s}})}showMailAccountDialog(e){const t={actionType:"MAIN_SHOW_MAIL_ACCOUNT_DIALOG",winId:e};a.Z.dispatch(t)}showCalendarAccountDialog(e){const t={actionType:"MAIN_SHOW_CALENDAR_ACCOUNT_DIALOG",winId:e};a.Z.dispatch(t)}showCreateCalendarDialog(e){a.Z.dispatch({actionType:"MAIN_SHOW_CREATE_CALENDAR_DIALOG",winId:e})}showPrivacyStatsDialog(e){a.Z.dispatch({actionType:"MAIN_SHOW_PRIVACY_STATS",winId:e})}showWorkspaceDialog(e,t){a.Z.dispatch({actionType:"MAIN_SHOW_WORKSPACE_DIALOG",winId:e,options:t})}showNoteSelectionDialog(e,t){a.Z.dispatch({actionType:"MAIN_SHOW_NOTE_SELECTION_DIALOG",winId:e,options:t})}showEnableWorkspaceDialog(e,t){a.Z.dispatch({actionType:"MAIN_SHOW_ENABLE_WORKSPACE_DIALOG",winId:e,options:t})}showIncludeWorkspaceDialog(e,t){a.Z.dispatch({actionType:"MAIN_SHOW_INCLUDE_WORKSPACE_DIALOG",winId:e,options:t})}showEnableSessionAutosaveDialog(e,t){a.Z.dispatch({actionType:"MAIN_SHOW_ENABLE_SESSION_AUTOSAVE_DIALOG",winId:e,options:t})}async openNewPopAsTabOrWindow(e,t,n){if(o.Z.get(g.kPopupsShowInTab))t.window.accept(e+";1");else{const s={bounds:{left:t.initialLeft,top:t.initialTop,width:t.initialWidth,height:t.initialHeight},incognito:n},o=await r.Z.openWindow(e,v,"popup",s);t.window?t.window.accept(o+";1"):i.ZP.openURL(o,t.targetUrl)}}startCasting(e){h.Z.utilities.startChromecast(e)}setPaneFocus(e,t){a.Z.dispatch({actionType:"MAIN_SELECTING_TOOLBAR",winId:e,options:{enable:t}})}stepFocus(e,t){const s=e.vivaldiWindowId,{document:o,HTMLElement:a}=e;i.ZP.clearSelection(s);const r=function(e,t){return Array.from(o.querySelectorAll(e)).map((e=>{const t=e.getBoundingClientRect(),n=function(e){let t=0,n=0;for(;e instanceof a&&(t+=e.offsetTop,n+=e.offsetLeft,e.offsetParent);)e=e.offsetParent;return{left:n,top:t}}(e);return{elm:e,rect:{left:n.left,top:n.top,width:t.width,height:t.height}}})).sort(((e,n)=>t?e.rect.left<n.rect.left?-1:e.rect.left>n.rect.left?1:e.rect.top<n.rect.top?-1:e.rect.top>n.rect.top?1:0:e.rect.top<n.rect.top?-1:e.rect.top>n.rect.top?1:e.rect.left<n.rect.left?-1:e.rect.left>n.rect.left?1:0))},l=function(e,t){const n=t.children;let s=!1;for(let t=0;t<n.length;t++){if(n[t]===e)return!0;if(l(e,n[t])){s=!0;break}}return s},d=r(".pagefocusstop",!0),c=r(".uifocusstop",!1).concat(d);if(c.length>0){let a=-1;const r=o.activeElement;for(let e=0;e<c.length;e++)if(c[e].elm===r||l(r,c[e].elm)){a=e;break}a=-1===a?t?0:c.length-1:t?a+1<c.length?a+1:0:0===a?c.length-1:a-1;if(-1!==d.findIndex((e=>e===c[a]))){const t=parseInt(c[a].elm.getAttribute("data-id"));i.ZP.activateTab(t,s),n(47995).Z.executeActions("event",e,"COMMAND_FOCUS_WEBVIEW"),f=setTimeout((()=>C.setPaneFocus(s,!1)),1e3)}else c[a].elm.focus(),f&&clearTimeout(f);C.setPaneFocus(s,!0)}}async showLargeAttachmentWarning(e,t){const{action:n}=await C.showModal(l.ZP.getMailWindowId(),{modal:{title:(0,d.Z)("A large file is being attached"),body:(0,d.Z)(`Sending a message with a large attachment may fail: file: "${e}" size: ${Number(t/1e6).toFixed(1)}MB`),actions:[{title:"Do not attach",action:"cancel",default:!0}],cancelAction:{title:(0,d.Z)("mail","Attach anyway"),action:"continue"}}});return n}},w=C},8074:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var s=n(33638);const i=new class{setNavigationState(e,t,n,i){s.Z.dispatch({actionType:"NAVIGATION_SET_STATE",pageId:e,windowId:t,navigationState:n,isUrlFieldFocused:i})}setSSLState(e,t){s.Z.dispatch({actionType:"PAGE_SET_SSL_STATE",pageId:e,info:t})}addBlockedPopupEvent(e,t){s.Z.dispatch({actionType:"NAVIGATION_ADD_POPUP",pageId:e,popupEvent:t})}removeBlockedPopup(e,t){s.Z.dispatch({actionType:"NAVIGATION_REMOVE_POPUP",pageId:e,targetUrl:t})}resetBlockedPopups(e){s.Z.dispatch({actionType:"NAVIGATION_RESET_BLOCKED_POPUPS",pageId:e})}setPermission(e,t,n,i,o,a,r){s.Z.dispatch({actionType:"NAVIGATION_SET_PERMISSION",pageId:e,origin:t,permission:n,requestEvent:i,state:o,promptPermission:a,suppressedPrompt:r})}resetPermissions(e){s.Z.dispatch({actionType:"NAVIGATION_RESET_PERMISSIONS",pageId:e})}setPageHasBlockedContent(e,t){s.Z.dispatch({actionType:"NAVIGATION_SET_BLOCKED_CONTENT",pageId:e,contentType:t})}resetPageHasBlockedContent(e){s.Z.dispatch({actionType:"NAVIGATION_RESET_BLOCKED_CONTENT",pageId:e})}}},21838:(e,t,n)=>{"use strict";n.d(t,{Z:()=>D});var s=n(30626),i=n(62882),o=n(53576),a=n(96951),r=n(18350),l=n(15285),d=n(29087),c=n(60331),h=n(33638),p=n(15489),u=n(56371),g=n(92292),m=n(25372),v=n(7064),f=n(89175),y=n(8684),C=n(44850);let w=!0,b=!1;function S(e){const t=(0,m.Z)(e);return t?t.hostname+t.pathname:e}function I(){w=!0}function k(){w=!1,A()}async function A(){const e=await v.Z.notes.getTree();h.Z.dispatch({actionType:"NOTES_INIT",notes:e})}function T(e,t){if(w)return;if(h.Z.dispatch({actionType:"NOTES_ADD_ITEM",id:e,item:t}),p.ZP.getActiveWindowId()===p.Ex||"note"!==t.type)return;const n=p.ZP.getLastActiveBrowserWindowId(),s=a.ZP.getActivePage(n);s&&C.jk.getDisplayUrlFromMapping(s.url).startsWith("vivaldi://notes")||(d.Z.get(f.kNotesCreationNotify)&&!l.ZP.getIsVisible(n,"PanelNotes")&&(0,y.c)({title:(0,u.Z)("New Note Created"),onClick:()=>r.Z.showContent(n,"PanelNotes",{setFocus:!0,selectId:e,reason:""}),timeout:3e4,tag:"VIVALDI_NOTES_NEW_CREATED"}),d.Z.get(f.kNotesCreationShowPanel)&&r.Z.showContent(n,"PanelNotes"))}function Z(e,t){w||h.Z.dispatch({actionType:"NOTES_MOVE_ITEM",id:e,targetFolder:t.parentId,targetIndex:t.index})}function E(e,t){w||(h.Z.dispatch({actionType:"NOTES_CHANGE_ITEM",id:e,changes:t}),b&&(b=!1,c.Z.setStatus(p.ZP.getActiveWindowId(),(0,u.Z)("Text has been appended to note."),5e3)))}function _(e){w||h.Z.dispatch({actionType:"NOTES_REMOVE_ITEM",id:e})}const M={scale:1,width:0,height:0};async function N({id:e,dataURL:t,title:n,url:s}){if(!t)throw new Error("Missing dataURL parameter");const o=i.ZP.getNodeById(e);if(!o||"note"!==o.type)throw new Error("Not a valid node for attachments");const a=t.indexOf(",");if(-1===a)throw new Error("data url is lacking a comma");const r=t.slice(a+1);s&&await v.Z.notes.update(e,{url:s}),await v.Z.notes.create({parentId:e,content:r,url:s,title:n,type:"attachment"})}function P(e){return new Promise(((t,n)=>{const s=new FileReader;s.onloadend=({target:e})=>{t(e.result)},s.onerror=()=>{s.abort(),n()},s.readAsDataURL(e)}))}const D={loadPromise:async function(){await A(),w=!1,v.Z.notes.onImportBegan.addListener(I),v.Z.notes.onImportEnded.addListener(k),v.Z.notes.onCreated.addListener(T),v.Z.notes.onMoved.addListener(Z),v.Z.notes.onChanged.addListener(E),v.Z.notes.onRemoved.addListener(_)},emptyTrash:function(){return new Promise(((e,t)=>{v.Z.notes.emptyTrash((n=>{!1===n&&(console.warn("Empty trash failed."),t("Empty trash failed.")),e()}))}))},addScreenshotToNote:function(e,t,n){const s=a.ZP.getActivePage(e)?.url??"";N({id:t,url:s,dataURL:n,title:(0,u.Z)("Capture: $1",S(s))})},addFile:async function(e,t){return N({id:e,dataURL:await P(t),title:t.name})},appendToNode:async function(e,t){const n=i.ZP.getNodeById(e);if(0===t.trim().length||!n)return;const s=`${n.content??""}\r\n${t}`;b=!0;try{await v.Z.notes.update(e,{content:s})}catch{b=!1}},createNoteFromCapture:async function(e,t){if(!t)throw new Error("Missing capture content");const n=a.ZP.getActivePage(e)?.url??"",s=await v.Z.notes.create({type:"note",url:n}),i=l.ZP.hasPanel(e,"PanelNotes");if(s)if(await N({id:s.id,dataURL:t,url:n,title:(0,u.Z)("Capture: $1",[S(n)])}),i){const t={selectId:s.id,setFocus:!0,reason:""};r.Z.showContent(e,"PanelNotes",t)}else{const t=C.jk.internalUrl("notes",s.id);o.ZP.openURL(e,t,{inCurrent:!1})}},readFileAsDataURL:P,createNotesFromTreeNodes:async function e(t,n="",s){return Promise.all(t.map((async(t,o)=>{const a=s?s+o:void 0;if("separator"===t.type){return await v.Z.notes.create({index:a,parentId:n,type:"separator"})}const r=await v.Z.notes.create({parentId:n,index:a,type:i.ZP.isFolder(t)?"folder":t.type,content:t.content,title:t.title,url:t.url});return t.children&&(r.children=await e(t.children,r.id,0)),r})))},createNote:async function(e,t,n=!0){const{content:i,url:o}=t,a=await v.Z.notes.create({type:"note",content:i,url:o});return o&&d.Z.get(f.kNotesCreationAddScreenshot)&&n?async function(e,t){const n=s.Z.getActiveWebView(e);if(!n)return;const i=["richtexteditor","markdowneditor"].includes(n.name)||"data:text/html,<html/>"===n.src?void 0:n.src,o=await function(e,t=M){return new Promise(((n,s)=>{e.getThumbnail(t,(e=>{g.Z.runtime.lastError&&s(g.Z.runtime.lastError.message),n(e)}))}))}(n);return N({id:t,url:i,dataURL:o,title:(0,u.Z)("Screenshot: $1",S(i??""))})}(e,a.id):a},removeNode:async function(e){await v.Z.notes.remove(e)},setCutIds:function(e){h.Z.dispatch({actionType:"NOTES_SET_CUT_IDS",ids:e})},setClipboard:function({clipboardData:e},t,n){if(!e)return;const s=t.map((e=>e.id));let o="";!function e(t){for(const n of t){const{title:t,content:s,url:a,dateAdded:r}=n,l=r?new Date(r).toString():void 0;o+=[t,s,l,a].filter(Boolean).join("\n")+"\n\n",i.ZP.isFolder(n)&&n.children&&e(n.children)}}(t),e.setData("vivaldi/x-cut",n?"true":"false"),e.setData(i.d0,JSON.stringify(s)),e.setData("text/plain",o)}}},33499:(e,t,n)=>{"use strict";function s(e){return Math.floor((e-1)/2)}n.d(t,{ZP:()=>_,y6:()=>k});const i=class{#t=[];constructor(e){this.comparator=e}_swap(e,t){const n=this.#t[e];this.#t[e]=this.#t[t],this.#t[t]=n}_heapify(e){const t=2*e+1;if(t>=this.#t.length)return;const n=t+1;let s=e;this.comparator(this.#t[t],this.#t[s])&&(s=t),n<this.#t.length&&this.comparator(this.#t[n],this.#t[s])&&(s=n),s!==e&&(this._swap(e,s),this._heapify(s))}peek(){return this.#t[0]}push(...e){e.forEach((e=>{let t=this.#t.length;this.#t.push(e);let n=s(t);for(;n>=0&&this.comparator(this.#t[t],this.#t[n]);)this._swap(n,t),t=n,n=s(n)}))}pop(){const e=this.#t.shift();return this._heapify(0),e}clear(){this.#t=[]}get size(){return this.#t.length}};var o=n(50522),a=n(46382),r=n(68247),l=n(29087),d=n(33638),c=n(63153),h=n(15489),p=n(45660),u=n(30381),g=n.n(u),m=n(7064),v=n(24522),f=n(47543),y=n(58821),C=n(89175),w=n(8684),b=n(34155);const S=5*v.hd,I=20*v.QI;function k(e,t){let n="LT";return t?n="L":e.isSame(Date.now(),"day")||(n="L LT"),n}const A=(e,t)=>e.alarmTime<t.alarmTime;function T(e,t){const{id:n,event_id:s,when:i}=e,a=t??(s&&o.Z.getEvent(s));if(!a)return p.Z.warn("Calendar",["reminders"],"Can not create alarms, event not found",e),void m.Z.calendar.deleteNotification(n);if(a.trash||a.task&&a.complete)return;const r=Date.now(),d=Math.max(l.Z.get(C.kCalendarLastNotificationTime)||r-v.hd,r-v.hd);let c=0,h=0;if(e.period){const t=r+v.QI;if(i>d&&i<t)return{alarmTime:i,notification:e,eventTime:(0,y.oJ)(a)}}else if(a.rrule){const{rrule:e}=a,t=parseInt(s?.split(":")[1]),n=new Set((a.recurrenceExceptions??[]).map((e=>e.date))),o=d+i+1e3,l=r+i+v.QI;c=(0,f.YE)(e,{from:o,to:l,eventStart:a.start,timezone:a.timezone}).map((e=>e.valueOf())).filter((e=>!t||e+i===t)).filter((e=>!n.has(e))).map((e=>e-i)).sort(((e,t)=>t-e))[0],h=c+i}else{const e=r+i+v.QI,t=(0,y.oJ)(a)-i;t>=d&&t<e&&(c=t)}return c?{alarmTime:c,notification:e,eventTime:h||(0,y.oJ)(a)}:void 0}async function Z(e){const t=Date.now();e.timeoutId&&clearTimeout(e.timeoutId);const n=v.lb-(t+1)%v.lb;e.timeoutId=setTimeout(Z,n,e),!e.alarms.size&&t>=e.nextBuildAlarms&&(E.updateAllAlarms(),e.nextBuildAlarms=(0,y.zX)(t));const s=l.Z.get(C.kCalendarNotificationType);if("none"===s)return;const i=e.alarms.peek();if(i&&!(i.alarmTime>t))try{const n=h.ZP.getLastActiveBrowserWindowId();for(;(e.alarms.peek()?.alarmTime??1/0)<=t;)E.showNotification(e.alarms.pop(),s,n)}catch(e){console.error("checkAlarms: Failed to retrive window id",e)}}const E=new class{#n={alarms:new i(A),nextBuildAlarms:0};async loadNotifications(){await m.Z.calendar.getAllNotifications((e=>{d.Z.dispatch({actionType:"NOTIFICATIONS_INIT",notifications:e})}))}deleteAlarmsForNotification(e){const t=new i(A);for(;this.#n.alarms.size;){const n=this.#n.alarms.pop();n.notification.id!==e&&t.push(n)}this.#n.alarms=t}deleteNotification(e){const{id:t,event_id:n}=e;n&&(m.Z.calendar.deleteNotification(t),this.deleteAlarmsForNotification(t))}async createNotification(e,t){e.event_id&&(e.event_id=e.event_id.split(":")[0]);const n=await m.Z.calendar.createNotification(e);if(n.event_id){const e=T(n,t);e&&this.#n.alarms.push(e)}return n}snooze(e,t){const{id:n,delay:s,eventTime:i,title:o,allDay:a,...r}=e;r.when=Date.now()+t*v.lb,r.period=e.eventTime,this.createNotification(r)}async updateNotification(e,t){let{id:n,event_id:s,...i}=e;s&&(s=s.split(":")[0]);const o=await m.Z.calendar.updateNotification(n,i);if(o.event_id){this.deleteAlarmsForNotification(n);const e=T(o,t);e&&this.#n.alarms.push(e)}}updateAlarmsForEvent(e){(e.notifications??[]).forEach((t=>this.updateAlarmsForNotification(t,e)))}updateAlarmsForNotification(e,t){this.deleteAlarmsForNotification(e.id);const n=T(e,t);n&&this.#n.alarms.push(n)}async updateAllAlarms(){this.#n.alarms.clear();const e=await m.Z.calendar.getAllNotifications();for(const t of e){const e=T(t);e&&this.#n.alarms.push(e)}}startAPIChangeListeners(){l.Z.get(C.kMailIsTurnedOff)||(m.Z.calendar.onNotificationChanged.addListener(E.loadNotifications),this.#n.alarms.clear(),this.#n.nextBuildAlarms=Date.now(),this.#n.timeoutId&&clearTimeout(this.#n.timeoutId),this.#n.timeoutId=setTimeout(Z,5e3,this.#n))}stopAPIChangeListeners(){m.Z.calendar.onNotificationChanged.removeListener(E.loadNotifications),this.#n.timeoutId&&(clearTimeout(this.#n.timeoutId),delete this.#n.timeoutId)}async showNotification(e,t,n){const{notification:s,eventTime:i}=e,d=o.Z.getEvent(s.event_id||"");if(!d)return;if(l.Z.get(C.kCalendarHiddenHidesNotifications)){if(o.Z.getCalendars().find((e=>e.id===d.calendarId))?.hidden)return}const p=d.title||s.name||"";if("system"===t){const e=g()(i),t=k(e,d.allDay??!1),s=e.format(t);(0,w.c)({title:`${s} - ${p}`,onClick:()=>{a.Z.showCalendar(n,d.id)},timeout:d.task?S:I,tag:`VIVALDI_CALENDAR_EVENT_ID_${d.id}`})}else{let e;const o="dialog"!==t&&l.Z.get(C.kCalendarNotificationFullscreen);if(o){const t=h.ZP.getWindowState(n);"normal"!==t?.state&&"minimized"!==t?.state||(c.Z.setFullscreen(n),e=n,await new Promise(b.nextTick))}const r={reminder:{...s,eventTime:i,allDay:d.allDay??!1,title:p},fullscreen:o,windowToRestore:e};a.Z.showCalendarNotification(n,r)}const u=l.Z.get(C.kCalendarNotificationSound);if(u){const e=new Audio(u);e.volume=l.Z.get(C.kCalendarNotificationVolume)/100,e.play()}r.Z.set(C.kCalendarLastNotificationTime,Date.now()),s.period&&m.Z.calendar.deleteNotification(s.id)}},_=E},53576:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>Pe,nq:()=>ye,y9:()=>ne});var s=n(7065),i=n(19789),o=n(46382),a=n(33638);var r=n(7168),l=n(8074),d=n(96951),c=n(14481),h=n(68247),p=n(29087),u=n(18237),g=n(14022),m=n(63153),v=n(15489),f=n(29104),y=n(53454),C=n(34540),w=n(92292),b=n(48764).lW;const S=function(e){const t=e.match(/^(data:)(.*?)?(;charset=.*?)?(;base64)?,(.*)$/);if(!t)return e;const n=t[2],s=t[5],i=new b(s,"base64").toString("binary"),o=new Array(i.length);for(let e=0;e<i.length;e++)o[e]=i.charCodeAt(e);const a=new Uint8Array(o),r=new Blob([a],{type:n});return URL.createObjectURL(r)};var I=n(2497),k=n(71193),A=n(84847),T=n(4027),Z=n(60842),E=n(7064),_=n(1407),M=n(44850),N=n(35369),P=n(69046),D=n(751),x=n(82786),O=n(16152),L=n(42941),R=n(36436),B=n(89175),F=n(721),V=n(14789),W=n(80419),U=n(37441),H=n(34155);let z=0;async function G(){const e=v.ZP.getLastActiveBrowserWindowId();if(e===v.Ex)return void console.warn("showWhatsNewTab: Expected a valid windowId");if(v.ZP.isIncognitoOrGuest(e))return;const t=await async function(e){return(await w.Z.windows.getAll({populate:!0})).some((t=>t.tabs?.some((t=>t.url===e||t.pendingUrl===e))))}(M.xy.welcome),n=await E.Z.utilities.canShowWhatsNewPage();if(!n.show)return;if(n.firstrun)return;const{vivaldiVersion:s}=E.Z.utilities.getVersion();return j(e,"https://vivaldi.com/newfeatures?hl="+i.ZP.UI_LANGUAGE+"&version="+s+"&os=W",{inCurrent:!1,inBackground:t})}const $=(0,O.Z)((e=>{const{toStart:t,windowId:n}=e,s=d.ZP.getActivePage(n);if(!s)return;const i=d.ZP.getSelectedPages(n);let o;o=d.ZP.isSelecting(n)&&i.size>1?i:N.aV.of(s);const a=(0,P.av)(s),r=d.ZP.getTabs(n,!0);if(a){const e=r.flatMap(((e,t)=>(0,P.av)(e.page)===a?[t]:[])),i=o.filter((e=>(0,P.av)(e)===a)),l=t?e.get(0):e.get(e.size-1);"number"==typeof l&&Ne.moveDroppedTabs(i,s.id,l,a,n)}else{const e=t?0:r.size-1;if(!o)return;Ne.moveDroppedTabs(o,s.id,e,void 0,n)}}),50),K={bookmarkId:"",inBackground:!1,inCurrent:!1,inSpecificPageId:void 0,incognito:!1,transition:E.Z.historyPrivate.TransitionType.AUTO_TOPLEVEL,fromUrlField:!1,index:void 0,postParams:void 0,contentType:void 0,singleton:!1,skipParams:!1,groupId:void 0};async function j(e,t="",n=K){const s=(0,M.Gr)(t),i=s&&"_blank"!==s?s:d.ZP.getDefaultStartpage(e);if(!v.ZP.getWindowState(e))return Promise.reject("Unknown window");if(v.ZP.isSettings(e)&&!0!==n.inNewWindow){let t=v.ZP.getLastActiveBrowserWindowId();if(t!==v.Ex&&v.ZP.isGuest()&&(t=v.Ex),t===v.Ex){const e=v.ZP.getIds("normal").filter((e=>!v.ZP.isGuest()));e.length>0&&(t=e[0])}t===v.Ex?(e=v.Ex,n.inNewWindow=!0,n.inBackground=!1):(e=t,n.inNewWindow=!1,n.inCurrent=!1)}if(v.ZP.isGuest()&&(0,M.YC)(i))return Promise.reject("Illegal URL for Guest mode");if(v.ZP.isIncognito(e)&&(0,M.CS)(i)){const t=v.ZP.getIds("normal").filter((e=>!v.ZP.isIncognitoOrGuest(e)));n.incognito=!1,t.length>0?e=t[0]:n.inNewWindow=!0}if(v.ZP.isPopup(e)&&(n.inNewWindow=!0,n.inBackground=!1),n.inNewWindow)return m.Z.openBrowserWindow(e,i,{incognito:n.incognito,transition:n.transition,fromUrlField:n.fromUrlField}).then((e=>{if(e&&e.tabs&&e.tabs.length>0){const t=e.tabs[0];return{windowId:parseInt(e.id),pageId:parseInt(t.id)}}return{windowId:-1,pageId:-1}}));let o="";if(n.contentType&&(o="Content-Type: "+n.contentType+"\r\n\r\n",console.assert(n.postParams)),n.singleton){const t=d.ZP.getPages(e).find((e=>(0,R.uu)(i,e.url,n.skipParams)));if(t){const n=v.ZP.getActiveWorkspace(e);return(0,P.cm)(t)!==n&&await(0,U.V)(t.id,{workspaceId:n}),(0,M.Z7)(i)&&a.Z.dispatch({actionType:"PAGE_OPEN_URL",windowId:e,pageId:t.id,url:i}),a.Z.dispatch({actionType:"PAGE_OPEN",windowId:e,pageId:t.id}),Promise.resolve({windowId:e,pageId:t.id})}}const r=n.inSpecificPageId?d.ZP.getPageInWindow(e,n.inSpecificPageId):d.ZP.getActivePage(e);if((n.inCurrent||n.inSpecificPageId)&&r&&!v.ZP.isPopup(e)){const t=r.vivExtData.ext_id;return c.Z.destroyPeriodicAlarm({id:t,from:"tab"}),a.Z.dispatch({actionType:"PAGE_OPEN_URL",pageId:r.id,windowId:e,url:i,postParams:n.postParams,headers:o,transition:n.transition,fromUrlField:n.fromUrlField,bookmarkId:n.bookmarkId}),Promise.resolve({windowId:e,pageId:r.id})}const l={url:n.postParams?_.f4:S(i),windowId:e,index:n.index,active:!n.inBackground,transition:n.transition,fromUrlField:n.fromUrlField,openerTabId:n.addOpenerTabId&&r&&!(0,M.$0)(r.url)?r.id:void 0};n.groupId&&(l.vivExtData=JSON.stringify({group:n.groupId}),l.pinned=d.ZP.isPinnedGroup(n.groupId,e));const h=(await w.Z.tabs.create(l)).id;return void 0===h?Promise.reject("Failed to create tab"):(n.postParams&&H.nextTick((()=>{a.Z.dispatch({actionType:"PAGE_OPEN_URL",pageId:h,windowId:e,url:i,postParams:n.postParams,headers:o,transition:n.transition,fromUrlField:n.fromUrlField,bookmarkId:n.bookmarkId})})),n.inBackground||await function(e,t){return new Promise((n=>{w.Z.windows.update(e,t,n)}))}(e,{focused:!0}),{windowId:e,pageId:h})}function Y(e,t,n){const s=n.windowId;if("complete"===t.status&&(t.title=n.title),a.Z.dispatch({actionType:"CHROME_TABS_UPDATED",tabId:e,windowId:s,changeInfo:t}),p.Z.get(B.kWorkspacesEnabled)&&t.url&&t.vivExtData&&"loading"===t.status){const e=JSON.parse(t.vivExtData).workspaceId,i=v.ZP.getActiveWorkspace(s);if(n.active&&e!==i){const t=()=>{H.nextTick((()=>{m.Z.setActiveWorkspace(n.windowId,e)}))};d.ZP.getPages(s,{workspaceId:i}).isEmpty()?Ne.openURL(s,"",{vivExtData:JSON.stringify({workspaceId:i}),inBackground:!0}).then(t):t()}}}function X(e,t,n){(class{static setMediaState(e,t){a.Z.dispatch({actionType:"PAGE_SET_MEDIASTATE",tabId:e,mediastate:t})}}).setMediaState(e,n)}function Q(e,t,n,s){let i="undecided";switch(s){case"allow":i="allowed";break;case"block":i="blocked";break;default:i="undecided"}let o=null;try{o=new URL(n)}catch(e){return}l.Z.setPermission(e,o.origin,t,null,i)}function q(e,t,n){a.Z.dispatch({actionType:"VIVALDI_TABS_UPDATED",pageId:e,windowId:t,tabInfo:n})}async function J(e,t){if(!v.ZP.getWindowState(e))return;const n=d.ZP.getPageInWindow(e,t),s=n?(0,P.cm)(n):void 0;s!==v.ZP.getActiveWorkspace(e)&&await m.Z.setActiveWorkspace(e,s);const i=d.ZP.getActivePage(e);i&&i.id===t||he(t,e)}function ee(e,t){E.Z.utilities.cleanUnusedImages(50);const n={actionType:"CHROME_TABS_REMOVED",tabId:e,removeInfo:t};a.Z.dispatch(n)}function te(e,t){const n={actionType:"CHROME_TABS_REPLACED",addedTabId:e,removedTabId:t};a.Z.dispatch(n)}async function ne(e,t){if(0===t.length)return;const n=[],s=d.ZP.getPages(e);for(let e=0;e<t.length;e++){const i=t[e],o=s.find((e=>e.id===i));if(o){const e=o.vivExtData.ext_id;n.push(e)}}await(0,C.Z)(e,{historystack:n})}let se=Promise.resolve();function ie(e){const t=s.ZP.tabToPage(e),{openerTabId:n,windowId:i}=t,o=d.ZP.getActivePage(i),r=v.ZP.getActiveWorkspace(i),l={ext_id:crypto.randomUUID()},c=[...d.ZP.getPageHistory(i)];t.active?(0,V.AL)(c,t.id):(0,V.EQ)(c,t.id);const h=t.index,m=e.vivExtData?.includes("ext_id");let C;if(ue||m||t.pinned||(t.index=function(e,t){const{windowId:n}=e,s=d.ZP.getPages(n),i=p.Z.get(B.kTabsNewPlacement),o="number"==typeof e.openerTabId?d.ZP.getPageById(e.openerTabId):null,a=o?(0,P.av)(o):(0,P.av)(e);switch(i){case"openintabstackwithrelated":case"rightofcurrent":{if("number"!=typeof e.openerTabId)return a&&d.ZP.isGroup(a,n)?d.ZP.getGroup(a,n).last().index+1:e.index;if(o?.pinned)return d.ZP.getPinnedCount(o.windowId);const t=t=>t.id!==e.openerTabId&&t.openerTabId!==e.openerTabId,i=s.skipWhile(t).takeUntil(t).last();return i?i.index+1:e.index}case"alwayslast":{if(a&&p.Z.get(B.kTabsStackingOpenInCurrent)&&d.ZP.isGroup(a,n))return d.ZP.getGroup(a,n).last().index+1;const e=s.last();if(e)return e.index+1}}if(!t)return e.index;const r=(0,P.av)(t);if(a&&a!==r&&d.ZP.isGroup(r,t.windowId))return d.ZP.getGroup(r,t.windowId).last().index+1;return t.pinned?d.ZP.getPinnedCount(t.windowId):t.index+1}(t,o)),"number"==typeof n&&"off"!==p.Z.get(B.kTabsStackingMode)){const e=d.ZP.getPageById(n);if(e){const s="openintabstackwithrelated"===p.Z.get(B.kTabsNewPlacement)&&!(0,M.pM)(e.url)&&!e.pinned;if(s||p.Z.get(B.kTabsStackingOpenInCurrent)){let o=(0,P.av)(e);if(!o&&s&&(o=d.ZP.getNewGroupId(),C=n),o){t.pinned=d.ZP.isPinnedGroup(o,i);if(s||d.ZP.getGroup(o,e.windowId).size>1){l.group=o;const{tiling:t}=e.vivExtData;!s&&t&&d.ZP.getTiles(t.id,i).size>1&&(l.tiling=t)}}}}}if(u.ZP.getIsLoading())if(t.vivExtData?.group&&(l.group=u.ZP.getLoadGroup(i,t.vivExtData.group)),u.ZP.getLoadPersistentTabs())l.workspaceId=t.vivExtData?.workspaceId;else if(u.ZP.getLoadWorkspaceAsTabs())l.workspaceId=void 0;else{let e=p.Z.get(B.kWorkspacesEnabled)?(0,P.cm)(t):void 0;if(void 0!==e){const t=u.ZP.getLoadWorkspaceId(e);if(void 0!==t&&!y.Z.getWorkspaceById(i,t)){const n=u.ZP.getWorkspace(e);f.Z.addWorkspaceWithId(i,t,g.Z.getLoadingWorkspaceName(e),n?.icon??"",n?.emoji.length?n?.emoji:void 0)}e=t}l.workspaceId=e??r}else v.ZP.initializingWindowId===i?l.workspaceId=(0,P.cm)(t):l.workspaceId=r;t.vivExtData=(0,N.TS)(t.vivExtData,l),a.Z.dispatch({actionType:"CHROME_TABS_CREATE",page:t,tabActivationHistory:c,deactivatePageId:t.active?o?.id:void 0,windowId:i,openerMissingGroupId:C});const b=Promise.all([(0,U.V)(t.id,l),C&&(0,U.V)(C,{group:l.group}),E.Z.tabsPrivate.update(t.id,{showImages:"never"!==p.Z.get(B.kPageImageLoading),loadFromCacheOnly:"cache"===p.Z.get(B.kPageImageLoading)}),ne(i,c),w.Z.windows.update(i,{focused:!0,drawAttention:!0}),h!==t.index&&w.Z.tabs.move([t.id],{index:t.index})]).catch((e=>{console.warn("handleChromeTabsCreated:",e)}));se=se.then((()=>b))}function oe(e){const t=e.windowId;a.Z.dispatch({actionType:"PAGE_OPEN",pageId:e.tabId,windowId:t,activatedByChrome:!0,selectGroup:!0})}function ae(e,t,n){let s=e.get(t);if(!s)return;e.delete(t);const i=s.windowId,o=n.newWindowId;s={...s,index:n.newPosition,windowId:o,active:!1};const r=[...d.ZP.getPageHistory(o)];if(s.active?(0,V.AL)(r,t):(0,V.EQ)(r,t),o!==i){const e=v.ZP.getActiveWorkspace(i);0===d.ZP.getPages(i,{workspaceId:e}).size&&Ne.openURL(i)}a.Z.dispatch({actionType:"CHROME_TABS_CREATE",page:s,tabActivationHistory:r,deactivatePageId:s.active?d.ZP.getActivePage(o)?.id:void 0,windowId:o})}function re(e,t,n){const s=n.oldWindowId,i=d.ZP.getPageInWindow(s,t);if(!i)return void console.error(`Expected to find page ${t} in window ${s}`);const o=i.active?d.ZP.findPageToActivateAfterClosingPage(i,s)?.id:void 0;e.set(t,i),a.Z.dispatch({actionType:"CHROME_TABS_REMOVED",tabId:t,removeInfo:{isWindowClosing:!1,windowId:s}}),o&&setTimeout((()=>{d.ZP.getPageInWindow(s,o)&&w.Z.tabs.update(o,{active:!0})}))}function le(e,t){const n=t.windowId;a.Z.dispatch({actionType:"CHROME_TABS_MOVED",tabId:e,windowId:n,index:t.toIndex})}function de(){w.Z.tabs.onReplaced.addListener(te),w.Z.tabs.onCreated.addListener(ie),w.Z.tabs.onUpdated.addListener(Y),w.Z.tabs.onRemoved.addListener(ee),w.Z.tabs.onMoved.addListener(le),w.Z.tabs.onActivated.addListener(oe);const e=new Map;w.Z.tabs.onDetached.addListener(re.bind(null,e)),w.Z.tabs.onAttached.addListener(ae.bind(null,e))}async function ce(e,t,n){a.Z.dispatch({actionType:"UNLOAD_DIALOG_CLOSED",windowId:e,tabId:t,proceed:n}),n||(ge=(0,x.M)(),void 0!==d.ZP.replacementTab?.id&&(await w.Z.tabs.remove(d.ZP.replacementTab.id),d.ZP.replacementTab=void 0))}function he(e,t,n=!0){a.Z.dispatch({actionType:"PAGE_OPEN",pageId:e,windowId:t,selectGroup:n})}function pe(e){a.Z.dispatch({actionType:"PAGE_MINIMIZE",windowId:e,workspaceId:v.ZP.getActiveWorkspace(e)})}let ue=!1;let ge=(0,x.M)();async function me(e,t){for(let n=0;n<e.size;n++){const s=e.get(n);if(s){const n=(0,P.av)(s);if(n){const i=e.first().windowId,o=d.ZP.getPages(i).filter((t=>!e.find((e=>e.id===t.id))&&(0,P.av)(t)===n));1===o.size&&(await(0,Z.ZP)(i,n,""),await Promise.all(o.map((e=>(0,U.V)(e.id,{group:void 0,tiling:void 0}))))),t||await(0,U.V)(s.id,{group:void 0,tiling:void 0})}else t||await(0,U.V)(s.id,{tiling:void 0})}}}async function ve(e,t){const{bypassConfirm:n=!1,forceClosePinned:i=!1}=t??{},r=ye(e)?e:N.aV.of(e);if(0===r.size)return;const l=i?"on":p.Z.get(B.kTabsClosePinned),c=r.first().windowId,h=function(e,t,n){const s=d.ZP.getPages(t);if(1===s.size&&!d.ZP.canClosePage(s.first()))return(0,N.aV)([]);let i=e;return"off"!==n&&"bury"!==n||(i=e.filter((e=>!e.pinned))),i}(r,c,l);if(!n&&p.Z.get(B.kTabsConfirmClosingTabs)&&h.size>=p.Z.get(B.kTabsConfirmClosingThreshold))return void o.Z.showConfirmCloseOtherTabsDialog(c,{pages:r});await me(r,!0),a.Z.dispatch({actionType:"PAGE_CLOSE",windowId:c,pages:h});r.some((e=>e.pinned&&e.active))&&"bury"===l&&pe(c);const u=new Map;let g=!1;for(const[e,t]of h.groupBy(P.cm)){const n=t.size===d.ZP.getPages(c,{workspaceId:e}).size;if(n&&!d.ZP.replacementTab){const t=await w.Z.tabs.create({url:d.ZP.getDefaultStartpage(c),active:!1,transition:E.Z.historyPrivate.TransitionType.AUTO_TOPLEVEL,windowId:c});u.set(e,t),void 0===e&&(g=n&&!p.Z.get(B.kTabsNeverCloseLast),d.ZP.replacementTab=t)}}const v=h.map((e=>e.id)).toArray();!d.ZP.replacementTab&&await async function(e,t){const n=e.some((e=>e.active));if(1===e.size&&n){const n=d.ZP.findPageToActivateAfterClosingPage(e.first(),t)?.id;return void 0!==n&&Ne.activateTab(n,t)}}(h,c),await w.Z.tabs.remove(v);for(const[e,t]of u){const n=s.ZP.tabToPage(t);Ne.moveToWorkspace(n,e)}const f=d.ZP.replacementTab?.id;d.ZP.replacementTab=void 0;const y=r.get(0);await async function(e,t){d.ZP.getPageInWindow(e.windowId,e.id)&&await new Promise((n=>{const s=setTimeout(i,t);function i(){n&&(d.ZP.removeListener(o),clearTimeout(s),n(),n=null)}function o(){d.ZP.getPageInWindow(e.windowId,e.id)||i()}d.ZP.addListener(o,(t=>t.get(e.windowId)))}))}(y,100),void 0!==f&&await w.Z.tabs.update(f,{active:!0}),g&&await m.Z.close(c)}async function fe(e,t,n,s){if(0!==z)return;let i;if("other"===t){const t=d.ZP.getActivePage(e);if(!t)return;i=d.ZP.getPages(e).filter((e=>e.id!==t.id))}else if("all"===t)i=d.ZP.getPages(e);else if(s&&"selection"===t)i=s;else{const t=d.ZP.getActivePage(e);if(!t)return;i=N.aV.of(t)}await Promise.all(i.map((async e=>{z++;try{await E.Z.tabsPrivate.update(e.id,{muteTab:"mute"===n})}finally{z--}})))}function ye(e){return e instanceof N.aV}async function Ce(e,t,n){if(ye(t)){const s=t;let i=s.some((e=>e.index<n))?n+1:n,o=!1;for(let t=0;t<s.size;t+=1){const a=s.get(t);if(!a)break;e!==a.windowId?await w.Z.tabs.move(a.id,{index:n+t,windowId:e}):(0===t&&i>a.index?i--:t>0&&(i<a.index||o)&&(i++,o=!0),a.index!==i&&await w.Z.tabs.move(a.id,{index:i,windowId:e}))}}else{const s=t;await w.Z.tabs.move(s.id,{windowId:e,index:n})}}async function we(e,t,n){const s={updateWorkspace:!0,keepActiveTab:!1,...n};if(s.updateWorkspace){const n=v.ZP.getActiveWorkspace(t);await Promise.all(e.map((e=>(0,U.V)(e.id,{workspaceId:n}))))}const i=await w.Z.tabs.move(e.map((e=>e.id)).toArray(),{windowId:t,index:-1});if(s.keepActiveTab)Ne.openLastPage(t);else{await new Promise((e=>{w.Z.windows.update(t,{focused:!0},e)}));const n=e.find((e=>e.active));n&&await w.Z.tabs.update(n.id,{active:!0})}return i}async function be(e,t,n=!1){const s=ye(e)?e:N.aV.of(e),i=s.first().windowId,o=v.ZP.getActiveWorkspace(i);let a=i;const r=s.groupBy(P.av).map(((e,t)=>void 0===t||d.ZP.getGroup(t,i).size===e.size?(0,N.aV)():e)).flatten().toList();if(await Ie(r),t&&(a=y.Z.getWindowId(t)??i,a!==i))return await m.Z.setActiveWorkspace(a,t),void await we(s,a);const l=(d.ZP.getPages(a,{workspaceId:t}).map((e=>e.index)).max()??-1)+1,c={workspaceId:t};if(await Promise.all(s.map((e=>(0,U.V)(e.id,c)))),n||await Ne.moveToIndex(a,s,l),0===d.ZP.getPages(i,{workspaceId:o}).size){const{pageId:e}=await Ne.openURL(i,"",{inBackground:!0});Ne.activateTab(e,i)}}async function Se(e,t,n){const s=e.count((e=>e.pinned));if(s>0&&s<e.size)return console.warn("Can't group a combination of pinned and unpinned pages."),"";const i=e.find(P.av),o=i?(0,P.av)(i):"",r=n||o||d.ZP.getNewGroupId();await Promise.all(e.filter((e=>(0,P.av)(e)!==r)).map((({id:e})=>(0,U.V)(e,{group:r}))));const l="number"==typeof t?t:e.first().index,c=e.first().windowId;return await Ce(c,e,l),a.Z.dispatch({actionType:"PAGE_TABSTACK_CREATE",windowId:c,pages:e}),r}async function Ie(e){const t=ye(e)?e:N.aV.of(e);if(t.isEmpty())return;const n=t.first().windowId;a.Z.dispatch({actionType:"PAGE_TABSTACK_REMOVE_FROM",windowId:n,pages:t}),await me(t,!1);const s=d.ZP.getPages(n).last().index+1;await Ne.moveToIndex(n,t,s)}function ke(e,t=(0,N.aV)()){const n=function(n){const{clipboardData:s}=n;if(!s)return;const i=e.map((e=>M.jk.getHoverUrl(e.url))).concat(t).join("\n");s.setData("text/plain",i),s.setData("text/uri-list",i),s.setData("vivaldi/x-uri-list",i),n.preventDefault()};document.addEventListener("copy",n),document.execCommand("copy"),document.removeEventListener("copy",n)}async function Ae(e,t){await Promise.all(e.map((e=>w.Z.tabs.update(e.id,{pinned:t}))))}async function Te(e,t){let n,s;"always"===t?(n=!0,s=!1):"cache"===t?(n=!0,s=!0):"never"===t&&(n=!1,s=!1),await E.Z.tabsPrivate.update(e.id,{showImages:n,loadFromCacheOnly:s}),h.Z.set(B.kPageImageLoading,t)}async function Ze(e,t,n="selection"){if(0===e.size)return;const s=e.first().windowId,i=t||(e.count()<4?"row":"grid"),o=crypto.randomUUID();await Promise.all(e.map((e=>(0,U.V)(e.id,{tiling:{layout:i,type:n,id:o}})))),a.Z.dispatch({actionType:"PAGE_TILE_PAGES",windowId:s,pages:e,id:o})}function Ee(e,t){const n=d.ZP.getTiles(t,e);n&&_e(n)}async function _e(e){if(e.isEmpty())return;const t=e.first().windowId;a.Z.dispatch({actionType:"PAGE_TILE_REMOVE_PAGES",windowId:t,pages:e}),await Promise.all(e.map((e=>(0,U.V)(e.id,{tiling:void 0}))))}function Me(e){a.Z.dispatch({actionType:"PAGE_SELECTION_CLEAR",windowId:e})}const Ne={clear:function(){a.Z.dispatch({actionType:"PAGE_CLEAR"})},clearSelection:Me,clonePages:async function(e){if(ue)return[];ue=!0;const t=[];try{const n=e.sort(((e,t)=>e.index-t.index)).filter((e=>!(0,M.m7)(e)));let i=-1;for(const e of n){i++;const n=e.index,o=await w.Z.tabs.duplicate(e.id);if(!o)continue;const a=o.id;if(!a)continue;"alwayslast"===p.Z.get(B.kTabsActivationOnClone)?await w.Z.tabs.move(a,{index:-1}):await w.Z.tabs.move(a,{index:n+1+i});const r=(0,P.av)(e);if(r&&d.ZP.getGroup(r,e.windowId).size>1){const t=s.ZP.tabToPage(o);await Se((0,N.aV)([e,t]))}t.push(a)}}finally{ue=!1}return t},close:async function(e){const t=await ge();try{if(v.ZP.isTabbedBrowser(e))if(d.ZP.isSelecting(e)){const t=d.ZP.getSelectedPages(e);await Ne.closePage(t)}else{const t=d.ZP.getActivePage(e);t&&await Ne.closePage(t)}else await m.Z.close(e)}finally{t()}},closeOther:function(e,t,n){const s=ye(e)?e:N.aV.of(e);let i;i=n?s.flatMap((e=>d.ZP.isGroup((0,P.av)(e),e.windowId)?d.ZP.getGroup((0,P.av)(e),e.windowId):N.aV.of(e))):s;const o=i.first().windowId;ve(d.ZP.getPages(o).filter((e=>(0,P.cm)(e)===t)).filterNot((e=>i.some((t=>t.id===e.id)))))},closePage:ve,closeTabStack:async function(e){const t=d.ZP.getPageById(e);if(!t)return;const n=(0,P.av)(t);ve(d.ZP.getGroup(n,t.windowId))},closeToLeft:async function(e,t,n=!1){const s=v.ZP.getActiveWorkspace(e),i=(0,P.av)(t);let o=d.ZP.getPages(e).filter((e=>(0,P.cm)(e)===s));if(o=n?o.skipUntil((e=>(0,P.av)(e)===i)).takeUntil((e=>e.id===t.id)):d.ZP.isGroup((0,P.av)(t),t.windowId)?o.takeUntil((e=>e.id===t.id)).filter((e=>(0,P.av)(e)!==i)):o.takeUntil((e=>e.id===t.id)),!o.isEmpty())return ve(o)},closeToRight:async function(e,t,n=!1){const s=v.ZP.getActiveWorkspace(e);let i=d.ZP.getPages(e).filter((e=>(0,P.cm)(e)===s)).skipUntil((e=>e.id===t.id)).skip(1);const o=(0,P.av)(t);if(n?i=i.takeUntil((e=>(0,P.av)(e)!==o)):d.ZP.isGroup((0,P.av)(t),t.windowId)&&(i=i.filter((e=>(0,P.av)(e)!==o))),!i.isEmpty())return ve(i)},closeUrl:function(e,t){ve(d.ZP.getPages(e).filter((e=>(0,R.uu)(t,e.url))))},copyUrls:ke,copyAllUrls:function(e,t){ke(d.ZP.getPages(e,{workspaceId:t}))},createTabStack:Se,changePeriodicReloadForPages:async function(e,t){await Promise.all(e.map((e=>(0,U.V)(e,{interval:t}))))},cycleByHistory:function(e,t,n={goBack:!1}){const s=(0,I.Z)(e),i=t instanceof s.WheelEvent&&t.buttons===T.Z.kRight,o=(0,A.Z)(t)||i;if(o){const n=()=>{a.Z.dispatch({actionType:"PAGE_CYCLE_HISTORY_MODIFIER_UP",windowId:e,workspaceId:v.ZP.getActiveWorkspace(e)})};i&&t instanceof s.WheelEvent?(0,W.g)(t,n,s.document):(0,F.Kz)(t,n)}a.Z.dispatch({actionType:"PAGE_SET_CYCLE_BY_HISTORY",windowId:e,goBack:n.goBack,activateEventModifierUp:o,workspaceId:v.ZP.getActiveWorkspace(e)})},cycleByOrder:function(e,t,n={goBack:!1}){const s=v.ZP.getActiveWorkspace(e),i=d.ZP.getCyclePageByOrder(e,s,n.goBack);i&&this.activateTab(i,e)},detachPage:async function(e,t,n){const s=ye(e)?e:N.aV.of(e),i=s.first().windowId,o=s.map((e=>e.id)),a=(0,k.Z)(i).find((e=>!o.includes(e.id)));a&&he(a.id,i),1===s.size&&await Ie(s),await be(s,void 0,!0);const r=s.first(),l=s.rest(),d=await m.Z.openBrowserWindow(i,[],{tabId:r.id,left:t,top:n});d?.id&&l.count()&&await we(l,d.id)},detachWorkspace:async function(e){const t=d.ZP.getWorkspacePages(e),n=t.first(),s=t.rest(),i=await m.Z.openBrowserWindow(n.windowId,[],{tabId:n.id,vivExtData:JSON.stringify({activeWorkspaceId:e})});i?.id&&s.size>0&&await we(s,i.id)},discardPage:function(e){e.isInspected||w.Z.tabs.discard(e.id)},exitPictureInPicture:function(e){w.Z.scripting.executeScript({target:{tabId:e},function:()=>{document.pictureInPictureElement&&document.exitPictureInPicture()}}).catch((e=>{}))},expandSelectionNext:function(e){a.Z.dispatch({actionType:"PAGE_SELECTION_EXPAND_NEXT",page:e})},expandSelectionPrevious:function(e){a.Z.dispatch({actionType:"PAGE_SELECTION_EXPAND_PREVIOUS",page:e})},expandTabStack:async function(e,t){const n=d.ZP.getPages(e).filter((e=>(0,P.av)(e)===t));await Promise.all(n.map((e=>(0,U.V)(e.id,{group:void 0}))))},gotoParentDirectory:function(e,t){const{url:n}=t,s=n.lastIndexOf("/");if(-1===s)return;let i;if(s+1===n.length){const e=n.substr(0,n.length-1).lastIndexOf("/");-1!==e&&(i=n.substr(0,e+1))}else i=n.substr(0,s+1);i&&!i.endsWith("://")&&Ne.openURL(e,i,{inSpecificPageId:t.id})},load:function(){de(),function(){const{tabsPrivate:e}=E.Z;e.onMediaStateChanged.addListener(X),e.onPermissionAccessed.addListener(Q),e.onTabUpdated.addListener(q),e.onBeforeUnloadDialogClosed.addListener(ce)}(),function(){const{windowPrivate:e}=E.Z;e.onBeforeUnloadDialogOpened.addListener(J)}(),p.Z.addListener(B.kTabsSelectionIncludeActive,Me),G()},minimizePage:pe,moveDroppedTabs:async function(e,t,n,s,i){const o=v.ZP.getActiveWorkspace(i);let a;a=void 0!==s?{group:s,workspaceId:o}:{workspaceId:o},e.map((e=>(0,U.V)(e.id,a))),await Ce(i,e,n),(t?e.find((e=>e.id===parseInt(t))):e.first())&&he(t,i),await new Promise((e=>setTimeout(e,100))),Ae(e.filter((e=>e.pinned)),!0)},moveToIndex:Ce,moveToWindow:we,moveWorkspaceToWindow:function(e,t){const n=d.ZP.getWorkspacePages(t);return n.size>0&&n.some((t=>t.windowId!==e))?we(n,e,{updateWorkspace:!1}):Promise.resolve()},muteAllExcept:function(e,t){fe(e,"selection","mute",d.ZP.getPages(e).filter((e=>-1===t.findIndex((t=>t.id===e.id)))))},newTab:async function(e,t,n={index:void 0,workspaceId:void 0,groupId:void 0,ignoreLinkRouting:void 0}){const s=n.index,i=n.workspaceId,o=n.groupId,r=(0,M.Gr)(t),l=r&&"_blank"!==r?r:d.ZP.getDefaultStartpage(e),c={url:l,windowId:e,index:s,active:!0,ignoreLinkRouting:n.ignoreLinkRouting,vivExtData:JSON.stringify({workspaceId:i,group:o}),pinned:d.ZP.isPinnedGroup(o,e)};p.Z.get(B.kWorkspacesEnabled)&&await m.Z.setActiveWorkspace(e,i);const h=await w.Z.tabs.create(c);if(void 0!==h?.id){const t=h.id;return a.Z.dispatch({actionType:"PAGE_OPEN_URL",pageId:t,windowId:e,url:l,postParams:void 0}),t}throw new Error("Failed to create tab")},openLastPage:function(e){const t=v.ZP.getActiveWorkspace(e),n="off"===p.Z.get(B.kTabsStackingMode),s=d.ZP.getWorkspaceTabsInWindow(e,t,n).last();s&&he(s.page.id,e)},activateTab:he,activateTabByIndex:function(e,t){const n=v.ZP.getActiveWorkspace(e),s="off"===p.Z.get(B.kTabsStackingMode),i=d.ZP.getWorkspaceTabsInWindow(e,n,s).get(t);if(!i)return;const o="group"===i.type?i.pages:(0,N.aV)();if(!(o.size>0)||!i.page.active)return void he(i.page.id,i.page.windowId);if(o.last()===i.page)return void he(o.first().id,e);const a=o.findIndex((e=>e.active))+1,r=o.get(a)?.id;r&&he(r,e)},openURL:j,openUrls:async function(e,t,n){n.inNewWindow?await m.Z.openBrowserWindow(e,t,{incognito:n.incognito}):await Promise.all(t.map(((s,i)=>n.inCurrent?Ne.openURL(e,s,{...n,inCurrent:0===i,inBackground:0!==i}):Ne.openURL(e,s,{...n,inBackground:n.inBackground||s!==(0,L.Z)(t)}))))},reloadPage:async function(e){const t=ye(e)?e:N.aV.of(e);await Promise.all(t.map((e=>w.Z.tabs.reload(e))))},removeFromTabStack:Ie,closeWorkspaceTabs:function(e){const t=d.ZP.getWorkspacePages(e).map((e=>e.id)).toArray();return w.Z.tabs.remove(t)},moveToWorkspace:be,setHistoryManagerState:async function(e,t){await(0,U.V)(e,{historyManagerState:t})},setImageInspector:function(e,t,n){a.Z.dispatch({actionType:"PAGE_SET_IMAGE_INSPECTOR",pageId:e,windowId:t,showImageInspector:n})},setImageLoading:Te,setMuting:fe,setPageInspected:function(e,t,n){a.Z.dispatch({actionType:"PAGE_SET_IS_INSPECTED",pageId:e,windowId:t,inspected:n})},setPinned:Ae,setReaderState:async function(e,t){await(0,U.V)(e,{readerMode:t})},setSelection:function(e,t){const{multiSelect:n=!1,addGroup:s=!0,excludeActive:i=!1}=t??{};a.Z.dispatch({actionType:"PAGE_SELECTION_SET",page:e,multiSelect:n,addGroup:s,excludeActive:i})},setThumbnail:async function(e,t){const n=d.ZP.getPageById(e);n&&(t?await(0,U.V)(e,{urlForThumbnail:n.url,thumbnail:t}):await(0,U.V)(e,{urlForThumbnail:void 0,thumbnail:void 0}))},setTitle:function(e,t,n){a.Z.dispatch({actionType:"PAGE_SET_TITLE",pageId:e,windowId:t,title:n})},showHomepage:async function(e,t){if(t.inCurrent){d.ZP.getActivePage(e)&&(0,D.gR)((0,I.Z)(e))}const n=p.Z.get(B.kHomepage),s=d.ZP.getDefaultStartpage(e),i=n===_.QG&&s===_.P1?s:n;await j(e,i,t)},stepPage:async function(e,t,n,s){const i=d.ZP.getStepInfo(e,t,n,s);if(!i)return;const{pages:o,index:a}=i;await Ne.moveDroppedTabs(o,e.id,a,void 0,s)},stepTabsToStart:function(e){$({toStart:!0,windowId:e})},stepTabsToEnd:function(e){$({toStart:!1,windowId:e})},tileLastActive:async function(e,t){const n=d.ZP.getActivePage(e),s=d.ZP.getPageInWindow(e,d.ZP.getLastVisited(e));if(n&&s&&(0,P.cm)(n)===(0,P.cm)(s)){const i=(0,N.aV)([n,s]);i.forEach((t=>{const n=(0,P.jA)(t);n&&Ee(e,n)})),await Ze(i,t)}},tilePages:Ze,tileTabStack:async function(e,t,n){const s=d.ZP.getGroup(t,e),i=n||(s.count()<4?"row":"grid");await Ze(s,i,"group")},toggleImageLoading:async function(e){const t=p.Z.get(B.kPageImageLoading);"always"===t?await Te(e,"never"):"never"===t?await Te(e,"cache"):await Te(e,"always")},toggleMuting:async function(e,t){const n=t.filter((e=>{const t=r.Z.hasMediaState(e.id,"muting");return!e.vivExtData.vivaldi_tab_muted&&!t})),s=t.filter((e=>{const t=r.Z.hasMediaState(e.id,"muting");return e.vivExtData.vivaldi_tab_muted||t}));await fe(e,"selection","mute",n),await fe(e,"selection","unmute",s)},toggleRelatedSelection:function(e){a.Z.dispatch({actionType:"PAGE_SELECTION_TOGGLE_RELATED",page:e})},toggleSelectedPagesPinned:async function(e){const t=d.ZP.isSelecting(e)?d.ZP.getSelection(e).map((t=>d.ZP.getPages(e).find((e=>e.id===t)))).filter(Boolean).toList():N.aV.of(d.ZP.getActivePage(e)).filter(Boolean);if(t.size)for(let e=0;e<t.size;e+=1){const n=t.get(e);if(!n)return;const s=(0,P.av)(n),i=d.ZP.getGroup(s,n.windowId),o=n.pinned||i?.some((e=>e.pinned));if(i.size>1)for(let e=0;e<i.size;e+=1){const t=o?i.size-1-e:e,n=i.get(t);n&&await w.Z.tabs.update(n.id,{pinned:!o})}else await w.Z.tabs.update(n.id,{pinned:!o})}},treeMove:async function({pages:e,groups:t,targetPage:n,area:s,group:i="",windowId:o,targetWorkspaceId:a}){await Promise.all(e.map((async e=>{switch(s){case"pinned":return await(0,U.V)(e.id,{group:i,tiling:void 0,workspaceId:a}),void await w.Z.tabs.update(e.id,{pinned:!0});case"stack":{const t=d.ZP.getPages(o).find((e=>(0,P.av)(e)===i&&Boolean(e.vivExtData.tiling)))?.vivExtData.tiling;return await(0,U.V)(e.id,{group:i,tiling:t,workspaceId:a}),void await w.Z.tabs.update(e.id,{pinned:!1})}case"regular":{const n=(0,P.av)(e),s=t.includes(n)?n:void 0,i=e.vivExtData.tiling;return await(0,U.V)(e.id,{group:s,tiling:s?i:void 0,workspaceId:a}),void await w.Z.tabs.update(e.id,{pinned:!1})}}}))),n&&await Ne.moveToIndex(n.windowId,e,n.index)},untilePages:_e,untileTileGroup:Ee},Pe=Ne},18350:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var s=n(15285),i=n(34197),o=n(68247),a=n(29087),r=n(33638),l=n(70864),d=n(7064),c=n(89175),h=n(34155);const p=new class{init(){const{barVisible:e}=a.Z.get(c.kPanelsWindowDefaults);r.Z.dispatch({actionType:"PANEL_INIT_COMMON",state:{regPanels:i.Z.readRegPanelListFromPrefs(),webPanels:i.Z.readWebPanelListFromPrefs(),barVisible:e}}),a.Z.addListener(c.kPanelsElements,p.setRegPanels),a.Z.addListener(c.kPanelsWebElements,p.setWebPanels),a.Z.addListener(c.kMailIsTurnedOff,p.setRegPanels)}setAddedButton(e,t,n,s){t===c.kToolbarsPanel&&r.Z.dispatch({actionType:"PANEL_ADDED",winId:e,panelId:n,showContent:s})}setRemovedButton(e,t,n){t===c.kToolbarsPanel&&r.Z.dispatch({actionType:"PANEL_REMOVED",winId:e,panelId:n})}setMuted(e,t,n){r.Z.dispatch({actionType:"PANEL_SET_MUTED",winId:e,panelId:t,muted:n})}setFocus(e){r.Z.dispatch({actionType:"PANEL_SET_FOCUS",winId:e})}removeFocus(e){r.Z.dispatch({actionType:"PANEL_REMOVE_FOCUS",winId:e})}toggleFloating(){r.Z.dispatch({actionType:"PANEL_TOGGLE_FLOATING"})}showNextPanel(e,t){r.Z.dispatch({actionType:"PANEL_SHOW_NEXT",winId:e,direction:t})}setContentVisible(e,t){r.Z.dispatch({actionType:"PANEL_SET_CONTENT_VISIBLE",winId:e,visible:t})}togglePanel(e){r.Z.dispatch({actionType:"PANEL_TOGGLE_PANEL",winId:e})}toggleContent(e,t){switch(t){case"webpanel 1":case"webpanel 2":case"webpanel 3":case"webpanel 4":case"webpanel 5":case"webpanel 6":case"webpanel 7":case"webpanel 8":case"webpanel 9":{const n=l.Z.getIndexByShortcut(t),s=[...a.Z.get(c.kToolbarsPanel)].filter((e=>i.Z.isWebPanel(e)));n>=1&&n<=s.length&&r.Z.dispatch({actionType:"PANEL_TOGGLE_CONTENT",winId:e,panelId:s[n-1]});break}default:r.Z.dispatch({actionType:"PANEL_TOGGLE_CONTENT",winId:e,panelId:t})}}showContent(e,t,n={selectId:"",reason:""}){const{setFocus:s=!1,selectId:i,reason:o}=n;r.Z.dispatch({actionType:"PANEL_SHOW_CONTENT",winId:e,panelId:t,setFocus:s,selectId:i,reason:o})}setWidth(e,t,n){r.Z.dispatch({actionType:"PANEL_SET_WIDTH",winId:e,panelId:t,width:n})}toggleCurrentPanel(e){r.Z.dispatch({actionType:"PANEL_TOGGLE_CURRENT",winId:e})}setSeparateFloating(e,t){let n=a.Z.get(c.kPanelsWebElements).slice(),s=n.findIndex((t=>t.id===e));if(-1!==s){const e={...n[s]};return e.floating=t,n[s]=e,void o.Z.set(c.kPanelsWebElements,n)}if(n=a.Z.get(c.kPanelsElements).slice(),s=n.findIndex((t=>t.id===e)),-1!==s){const e={...n[s]};e.floating=t,n[s]=e,o.Z.set(c.kPanelsElements,n)}}setPanelResizable(e,t){r.Z.dispatch({actionType:"PANEL_SET_RESIZABLE",panelId:e,resizable:t})}setRegPanels(){h.nextTick((()=>{r.Z.dispatch({actionType:"PANEL_SET_REG_PANELS",list:i.Z.readRegPanelListFromPrefs()})}))}setWebPanels(){h.nextTick((()=>{r.Z.dispatch({actionType:"PANEL_SET_WEB_PANELS",list:i.Z.readWebPanelListFromPrefs()})}))}setWebPanelValue(e,t,n){"title"===t?l.Z.setTitle(e,n):"faviconUrl"===t?l.Z.setFaviconUrl(e,n):"activeUrl"===t&&l.Z.setActiveUrl(e,n)}translateWithPanel(e,t,n){s.ZP.getIsVisible(e,"PanelTranslate")||this.toggleContent(e,"PanelTranslate"),d.Z.utilities.broadcastMessage({translate:{winId:e,lang:t,text:n}})}clearTransitionState(e,t){r.Z.dispatch({actionType:"PANEL_CLEAR_TRANSITION_STATE",winId:e,panelId:t})}closePanel(e){const t=s.ZP.getSelected(e);t&&r.Z.dispatch({actionType:"PANEL_CLOSE",winId:e,panelId:t})}},u=p},14481:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var s=n(53576),i=n(96951),o=n(34197),a=n(32921),r=n(33638),l=n(70864),d=n(15489),c=n(69046);const h={load:async function(){const e=new Map,t=Date.now();i.ZP.getReloadingPages().forEach((n=>{const s=n.vivExtData.interval,i=n.vivExtData.ext_id;if(!s||!i)return;const o={id:i,periodInMinutes:s,scheduledTime:(0,a.d)({periodInMinutes:s,currentTime:t}),from:"tab"};e.set(i,o)})),o.Z.readWebPanelListFromPrefs().forEach((n=>{if(n.interval&&n.interval>0){const{id:s,interval:i}=n,o={id:s,periodInMinutes:i,scheduledTime:(0,a.d)({periodInMinutes:i,currentTime:t}),from:"panel"};e.set(s,o)}})),r.Z.dispatch({actionType:"PERIODIC_RELOAD_ALL",alarms:e})},createOrDestroyAlarm:async function(e){const{alarm:t,id:n,interval:s,from:i}=e;l.Z.isExtPanel(n)||(t?.periodInMinutes===s?await this.destroyPeriodicAlarm({id:n,from:i}):await this.createPeriodicReloadAlarm({id:n,interval:s,from:i}))},createPeriodicReloadAlarm:async function(e){const{id:t,from:n,interval:o}=e;if(l.Z.isExtPanel(t))return;if(!o)return;const d={id:t,scheduledTime:(0,a.d)({periodInMinutes:o}),periodInMinutes:o,from:n},c=i.ZP.getPageByReloadId(t);c?await s.ZP.changePeriodicReloadForPages([c.id],o):"panel"===n&&l.Z.setPeriodicReload(t,o),r.Z.dispatch({actionType:"PERIODIC_RELOAD_CREATE",alarm:{alarmId:t,alarm:d}})},destroyTabPeriodicAlarms:async function(e){const t=d.ZP.getActiveWorkspace(e),n=i.ZP.getReloadingPages().filter((n=>n.windowId===e&&(0,c.cm)(n)===t)),o=n.map((e=>e.vivExtData.ext_id)).toArray(),a=n.map((e=>e.id)).toArray();await s.ZP.changePeriodicReloadForPages(a,0),r.Z.dispatch({actionType:"PERIODIC_RELOAD_DESTROY",alarmIds:o})},destroyAllPanelPeriodicAlarms:async function(){const e=[];for(const t of a.Z.getPanelAlarms().keys())e.push(t),l.Z.setPeriodicReload(t,null);r.Z.dispatch({actionType:"PERIODIC_RELOAD_DESTROY",alarmIds:e})},destroyPeriodicAlarm:async function(e){const{id:t,from:n}=e;if(l.Z.isExtPanel(t))return;const o=i.ZP.getPageByReloadId(t);o?await s.ZP.changePeriodicReloadForPages([o.id],0):"panel"===n&&l.Z.setPeriodicReload(t,null),r.Z.dispatch({actionType:"PERIODIC_RELOAD_DESTROY",alarmIds:[t]})},updateRunningAlarm:function(e,t){const n={alarmId:e,alarm:t};r.Z.dispatch({actionType:"PERIODIC_RELOAD_UPDATE",alarm:n})}}},98974:(e,t,n)=>{"use strict";n.d(t,{Z:()=>T});var s=n(46382),i=n(68247),o=n(29087),a=n(67044),r=n(87159),l=n(60331),d=n(61670),c=n(33638),h=n(15489),p=n(56371),u=n(92292),g=n(7064),m=n(89175);let v,f=!1;let y;function C(e){const t=e.value;c.Z.dispatch({actionType:"PROXY_INIT",apiMode:t.mode,bypassList:o.Z.get(m.kProxyBypassList),connectStrategy:o.Z.get(m.kProxyConnectStrategy),levelOfControl:e.levelOfControl,otherProxy:a.Z.getHasOtherProxy(),token:o.Z.get(m.kProxyToken)})}function w(e){const t=h.ZP.getActiveWindowId();if(t!==h.Ex){const n=(0,p.Z)("Privacy Guard: Connection failed with $1",[e.error]);l.Z.setStatus(t,n),console.warn(n)}}function b(e,t,n){switch(n){case m.kProxyBypassList:e.length===t.length&&e.toString()===t.toString()||(c.Z.dispatch({actionType:"PROXY_SET_BYPASS_LIST",bypassList:o.Z.get(m.kProxyBypassList)}),a.Z.getIsConnected()&&A.updateSettings());break;case m.kProxyConnectStrategy:c.Z.dispatch({actionType:"PROXY_SET_CONNECT_STRATEGY",connectStrategy:o.Z.get(m.kProxyConnectStrategy)}),a.Z.getIsConnected()&&A.connect();break;case m.kProxyConnected:t&&!a.Z.getIsConnected()?S():!t&&a.Z.getIsConnected()&&I()}}function S(){A.startSurveyTimer(!0),c.Z.dispatch({actionType:"PROXY_SET_PROXY_STATE",proxyState:"running",publicIp:"",location:void 0}),setTimeout((async()=>{const e=await fetch("https://api.invisv.com/my-ip"),t=await e.json(),n=await fetch("http://localhost:32323"),s=await n.json();c.Z.dispatch({actionType:"PROXY_SET_NETWORK_INFO",publicIp:t.ip,location:s.currentRelay})}),1e3)}async function I(){await A.clear(),c.Z.dispatch({actionType:"PROXY_SET_PROXY_STATE",proxyState:"stopped",publicIp:"",location:0})}function k(){if(void 0!==y&&(clearTimeout(y),y=void 0),r.ZP.showSurveyNow())A.showSurvey(!0);else{if(0===o.Z.get(m.kProxySeen))return;y=setTimeout(k,r.GO)}}const A=new class{loadPlatformSupport(){const e=g.Z.utilities.supportsProxy();return r.ZP.setSupportsProxy(e.support),Promise.resolve()}loadPromise(){return r.ZP.getSupportsProxy()?(u.Z.proxy.settings.onChange.addListener(C),o.Z.addListener(m.kProxyBypassList,b),o.Z.addListener(m.kProxyConnectStrategy,b),o.Z.addListener(m.kProxyConnected,b),new Promise((e=>{u.Z.proxy.settings.get({incognito:!1},(t=>{g.Z.utilities.getOtherProxies(a.Z.getLocal(),(n=>{const s=t.value;c.Z.dispatch({actionType:"PROXY_INIT",apiMode:s.mode,bypassList:o.Z.get(m.kProxyBypassList),connectStrategy:o.Z.get(m.kProxyConnectStrategy),levelOfControl:t.levelOfControl,otherProxy:n.hasOther&&"controlled_by_this_extension"!==t.levelOfControl,token:o.Z.get(m.kProxyToken)}),a.Z.getRunsApi()?a.Z.getHasToken()?A.connect():A.disconnect():A.clear(),A.startSurveyTimer(!1),e()}))}))}))):A.clear()}startSurveyTimer(e){const t=o.Z.get(m.kProxySeen);e?-1===t&&(i.Z.set(m.kProxySeen,Date.now()),setTimeout(k,r.uw)):0!==t&&-1!==t&&setTimeout(k,r.uw)}showSurvey(e){e||i.Z.set(m.kProxySeen,0),c.Z.dispatch({actionType:"PROXY_SET_SHOW_SURVEY",state:e})}clear(){return new Promise((e=>{u.Z.proxy.settings.get({incognito:!1},(t=>{"controlled_by_this_extension"===t.levelOfControl?u.Z.proxy.settings.clear({scope:"regular"},e):e()}))}))}async loadToken(){if(!a.Z.getHasToken()&&"request"!==a.Z.getTokenData().state&&d.Z.getState().hasToken){v=new AbortController,c.Z.dispatch({actionType:"PROXY_SET_TOKEN_STATE",tokenData:{message:(0,p.Z)("Fetching access token"),state:"fetch",token:""}});try{const e=await fetch("https://relay.vivaldi.com/token/",{method:"POST",cache:"no-cache",headers:{Authorization:"Bearer "+d.Z.getState().accessToken},signal:v.signal});if(e.ok){const t=await e.json();t.token?(i.Z.set(m.kProxyToken,t.token),c.Z.dispatch({actionType:"PROXY_SET_TOKEN_STATE",tokenData:{message:"",state:"idle",token:t.token}})):c.Z.dispatch({actionType:"PROXY_SET_TOKEN_STATE",tokenData:{message:(0,p.Z)("Failed to fetch access token: $1",[t.error]),state:"error",token:""}})}else{const e=(0,p.Z)("Invalid response");c.Z.dispatch({actionType:"PROXY_SET_TOKEN_STATE",tokenData:{message:(0,p.Z)("Failed to fetch access token: $1",[e]),state:"error",token:""}})}}catch(e){c.Z.dispatch({actionType:"PROXY_SET_TOKEN_STATE",tokenData:{message:(0,p.Z)("Failed to fetch access token"),state:"error",token:""}})}v=void 0}}cancelLoadToken(){v&&v.abort()}updateSettings(){const e={mode:"fixed_servers",rules:{singleProxy:a.Z.getLocal(),bypassList:a.Z.getBypassList(!0)}};u.Z.proxy.settings.set({value:e,scope:"regular"},(()=>{}))}async connect(){if(a.Z.getHasApiAccess()&&a.Z.getHasToken()){const e={local:a.Z.getLocal(),remote:a.Z.getRemote(),token:a.Z.getTokenData().token},t=await g.Z.utilities.connectProxy(e);if(!t.success){const e=h.ZP.getActiveWindowId();if(e!==h.Ex){const n=(0,p.Z)("Connection failed with $1",[t.message||(0,p.Z)("Can not run proxy")]);s.Z.showModalInfo(e,{title:(0,p.Z)("Privacy Guard"),body:n})}return void this.disconnect()}f||(f=!0,u.Z.proxy.onProxyError.addListener(w)),this.updateSettings(),S(),o.Z.removeListener(m.kProxyConnected,b),i.Z.set(m.kProxyConnected,!0),o.Z.addListener(m.kProxyConnected,b)}else a.Z.getHasApiAccess()?console.warn("ProxyActions.connect: Proxy token not set"):console.warn("ProxyActions.connect: Proxy api not available")}async disconnect(){a.Z.getHasApiAccess()?(await g.Z.utilities.disconnectProxy(),await I(),o.Z.removeListener(m.kProxyConnected,b),i.Z.set(m.kProxyConnected,!1),o.Z.addListener(m.kProxyConnected,b)):console.warn("ProxyActions.disconnect: Proxy api not available")}setBypassList(e){i.Z.set(m.kProxyBypassList,e)}setConnectStrategy(e){i.Z.set(m.kProxyConnectStrategy,e)}toggle(){a.Z.getIsConnected()?this.disconnect():this.connect()}},T=A},92413:(e,t,n)=>{"use strict";n.d(t,{Z:()=>v});var s=n(53576),i=n(96951),o=n(68247),a=n(29087),r=n(37330),l=n(33638),d=n(83526),c=n(92292),h=n(68079),p=n.n(h),u=n(89175);function g(e){const t=a.Z.get(u.kWebpagesReaderStyle),n=i.ZP.getActivePage(e);n?.vivExtData.readerMode&&c.Z.tabs.sendMessage(n.id,{readerStyle:{...t,...r.Z.getReaderThemeColor(e)}})}function m(e,t){if(e&&e.type&&t.tab?.id)switch(e.type){case"SET_RM":if(!e.payload||"boolean"!=typeof e.payload.isReaderable)return;const n=e.payload.isReaderable;l.Z.dispatch({actionType:"READERMODE",supportsReaderMode:n,pageId:t.tab.id,windowId:t.tab.windowId});break;case"SET_RM_STYLE":g(t.tab.windowId)}}const v={init:function(){c.Z.runtime.onMessage.addListener(m)},setReaderModeStyle:g,resetReaderModeStyle:function(e){o.Z.reset(u.kWebpagesReaderStyle),g(e)},toggleReaderMode:async function(e){p()(e.url)&&(e.vivExtData.readerMode?await s.ZP.setReaderState(e.id,!1):await s.ZP.setReaderState(e.id,!0),d.Z.doAction(e.windowId,e.id,"focusWebView"))}}},54614:(e,t,n)=>{"use strict";n.d(t,{M:()=>d,Z:()=>h});var s=n(96951),i=n(60331),o=n(33638),a=n(56371),r=n(7064);const l=["http://","https://","file://"];function d(e){return l.some((t=>e?.toLowerCase().startsWith(t)))}function c(){r.Z.readingListPrivate.getAll((e=>{o.Z.dispatch({actionType:"READING_LIST_UPDATE",entries:e})}))}class h{static init(){c(),r.Z.readingListPrivate.onModelChanged.addListener((()=>c()))}static addSeveral(e,t){let n=0;t.forEach((t=>{d(t.url)&&r.Z.readingListPrivate.add(t.url,t.title,(t=>{t&&(n+=1,i.Z.setStatus(e,(0,a.Z)("$1 page has been added to Reading List.","$1 pages have been added to Reading List.",[n])))}))}))}static add(e,t,n=""){if(!t){const i=s.ZP.getActivePage(e);i?(t=i.url,n=i.title):t=""}d(t)&&r.Z.readingListPrivate.add(t,n,(t=>{t&&i.Z.setStatus(e,(0,a.Z)("Page “$1” added to Reading List.",[n]))}))}static remove(e){r.Z.readingListPrivate.remove(e,(()=>{}))}static setReadStatus(e,t){r.Z.readingListPrivate.setReadStatus(e,t,(()=>{}))}}},10589:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var s=n(96951),i=n(29087),o=n(33638),a=n(15489),r=n(89175),l=n(34155);const d=new class{setText(e,t){const n=s.ZP.getActivePage(e);n&&o.Z.dispatch({actionType:"SEARCH_FIELD_SET_TEXT",tabId:n.id,text:t})}addTypedSearchHistory(e,t){i.Z.get(r.kAddressBarSearchTypedHistoryEnabled)&&!a.ZP.isIncognito(e)&&l.nextTick((()=>{o.Z.dispatch({actionType:"SEARCH_FIELD_ADD_TYPED_HISTORY",query:t})}))}deleteTypedSearchHistory(e,t){o.Z.dispatch({actionType:"SEARCH_FIELD_DELETE_TYPED_HISTORY",query:e,when:t})}deleteTypedHistoryPeriod(e){o.Z.dispatch({actionType:"SEARCH_FIELD_DELETE_TYPED_HISTORY_PERIOD",since:e})}load(){o.Z.dispatch({actionType:"SEARCH_FIELD_INIT_TYPED_HISTORY"}),i.Z.addListener(r.kHistoryDaysToKeepVisits,((e,t)=>{0===t?o.Z.dispatch({actionType:"SEARCH_FIELD_DELETE_TYPED_HISTORY_FROM_DATABASE"}):0===e&&t>0&&o.Z.dispatch({actionType:"SEARCH_FIELD_WRITE_TYPED_HISTORY_TO_DATABASE"})}))}}},66971:(e,t,n)=>{"use strict";n.d(t,{Z:()=>k});var s=n(46382),i=n(68247),o=n(29087),a=n(18237),r=n(33638),l=n(56371),d=n(34540),c=n(30381),h=n.n(c),p=n(7064),u=n(15489),g=n(89175),m=n(60842);function v(e,t,n){switch(t){case"added":n.item&&r.Z.dispatch({actionType:"SESSION_ADDED",id:e,owner:n.owner,parentId:n.parentId,index:n.index,item:n.item});break;case"changed":n.item&&r.Z.dispatch({actionType:"SESSION_CHANGED",id:e,item:n.item});break;case"content":n.content&&r.Z.dispatch({actionType:"SESSION_CONTENT",id:e,owner:"",content:n.content});break;case"deleted":r.Z.dispatch({actionType:"SESSION_DELETED",id:e});break;case"moved":n.item&&r.Z.dispatch({actionType:"SESSION_MOVED",id:e,item:n.item,parentId:n.parentId,index:n.index})}}function f(e){const t=new Map,n=new Map;r.Z.dispatch({actionType:"SESSION_SET_LOADING_PARAMETERS",opening:e,workspaceAsTabs:!1,persistentTabs:!0,workspaceMap:t,groupNameMap:n})}async function y(e,t){const n=e=>{const t=o.Z.get(g.kWorkspacesList);for(let n=0;n<t.length+1;n++)if(!t.some((t=>t.id===e+n)))return e+n;return-1};let s=!0;const i=new Map,l=new Map;for(let t=0;t<e.length;t++){const o=a.ZP.getById(e[t]),r=o?.item.workspaces;if(r?.length){let e=0;for(let t=0;t<r.length;t++){if(e=n(e+1),-1===e){s=!1;break}i.set(r[t].id,e)}}o?.item.groupNames.length&&(o.item.groupNames.forEach((e=>{l.set(e.id,{windowId:u.Ex,name:e.name})})),await(0,m.vo)())}s||i.clear(),r.Z.dispatch({actionType:"SESSION_SET_LOADING_PARAMETERS",opening:e.length>0,workspaceAsTabs:t,persistentTabs:!1,workspaceMap:i,groupNameMap:l})}async function C(){const e=o.Z.get(g.kSessionsSaveDays),t=await p.Z.sessionsPrivate.getAutosaveIds(e);I.remove(t)}function w(){r.Z.dispatch({actionType:"SESSION_SET_TIMED_BACKUP",backup:"on"===o.Z.get(g.kSessionsSaveOnExit)})}function b(e){if("backup"===e.reason||"autosave"===e.reason){const t={name:"",filename:"",parentId:-1,index:-1,owner:"",backup:e.reason};p.Z.sessionsPrivate.add(t,(e=>{e&&console.warn("Error making session backup: "+e)}))}}function S(){return h()().format("YYYY-MM-DD_HH_mm_ss")}const I=new class{loadPromise(){return p.Z.sessionsPrivate.onChanged.addListener(v),p.Z.sessionsPrivate.onPersistentLoad.addListener(f),o.Z.addListener(g.kSessionsSaveDays,C),o.Z.addListener(g.kSessionsSaveOnExit,w),a.ZP.addListener(b),new Promise((e=>{p.Z.sessionsPrivate.getAll((t=>{t.loadingFailed&&console.warn("Error loading session list"),r.Z.dispatch({actionType:"SESSION_INIT",model:t,backup:"on"===o.Z.get(g.kSessionsSaveOnExit)}),e()}))}))}setTitle(e,t){p.Z.sessionsPrivate.rename(e,t.trim())}add(e,t,n,s,i,o){const r=S(),l={name:e||r,filename:r,parentId:t,index:n,owner:s,windowId:i,ids:o};if(t<0||a.ZP.isTrash(t,!0))l.index=0;else if(t!==a.ZP.getRootId()){const e=a.ZP.getById(t);e?.item.parentId===a.ZP.getRootId()&&(l.index=e?.index??0)}return n<0&&(l.index=0),l.parentId=a.ZP.getRootId(),new Promise((e=>{p.Z.sessionsPrivate.add(l,(t=>{e(t)}))}))}duplicate(e,t,n,s){const i=a.ZP.getById(e),o=S(),r={name:i?.item.name?(0,l.Z)("$1 (copy)",[i?.item.name]):o,filename:o,parentId:t,index:n,owner:s,fromId:e};return new Promise((e=>{p.Z.sessionsPrivate.add(r,(t=>{e(t)}))}))}async requestContent(e,t){const n=await p.Z.sessionsPrivate.getContent(e);n.id===e&&0!==n.windows.length?r.Z.dispatch({actionType:"SESSION_CONTENT",id:e,owner:t,content:n}):console.warn("Failed to load content for",e)}emptyTrash(){return new Promise((e=>{p.Z.sessionsPrivate.emptyTrash((t=>{t&&console.warn("Error emptying trash: "+t),e()}))}))}makeContainer(e){return new Promise((t=>{p.Z.sessionsPrivate.makeContainer(e,(e=>{t(e)}))}))}modifyContent(e,t){return new Promise((n=>{p.Z.sessionsPrivate.modifyContent(e,t,(t=>{t&&console.warn("Error modifying session '"+e+"', error: "+t),n(t)}))}))}move(e,t,n){return Promise.all(e.map((e=>new Promise((s=>{const i=a.ZP.getById(e);p.Z.sessionsPrivate.move(e,t,n,(t=>{t&&console.warn("Error moving session '"+e+"', error: "+t),s(e)})),i&&(i.item.parentId!==t||i.index>n)&&n++})))))}async open(e,t,n,r=[]){const c=async(e,t,n,r,c)=>{const h={newWindow:n,oneWindow:!n,withWorkspace:!0,tabIds:c};return await y(t,r),Promise.all(t.map((t=>new Promise((n=>{p.Z.sessionsPrivate.open(t,e,h).then((i=>{i&&(console.warn("Error opening session '"+t+"', error: "+i),s.Z.showModalInfo(e,{title:(0,l.Z)("Sessions"),body:(0,l.Z)("No tabs were opened. You may have excluded all tabs in the session.")})),n()}))}))))).then((()=>{const e=a.ZP.getLoadGroupNameMap();if(e.size){const t={...o.Z.get(g.kTabsStackingNameMap)}||{};e.forEach(((e,n)=>{t[n]=e.name})),i.Z.set(g.kTabsStackingNameMap,t);const n=[];e.forEach((e=>{e.windowId===u.Ex||n.includes(e.windowId)||n.push(e.windowId)})),n.forEach((e=>{(0,d.Z)(e,{groupTitles:t})}))}y([],!1)}))},h=t.length>1?[]:r;return t.map((e=>a.ZP.getById(e))).filter(Boolean).some((e=>e.item?.workspaces.length))?new Promise((i=>{o.Z.get(g.kWorkspacesEnabled)?s.Z.showIncludeWorkspaceDialog(e,{onClose:s=>{c(e,t,n,s,h),i()}}):s.Z.showEnableWorkspaceDialog(e,{onClose:s=>{c(e,t,n,s,h),i()}})})):c(e,t,n,!0,r)}remove(e){let t=0;return Promise.all(e.map((e=>new Promise((n=>{const s=a.ZP.isTrash(e,!1);p.Z.sessionsPrivate.delete(e,t,(t=>{t&&console.warn("Error deleting session '"+e+"', error: "+t),n()})),s||t++})))))}async restore(e){let t=0;for(const n of e){const e=a.ZP.getById(n);if(e&&a.ZP.isTrashFolder(e.item.parentId))if(a.ZP.isAutoSaveNode(n)){const e=a.ZP.getById(a.ZP.getTrashId()),t=e?e.index:0;await I.move([n],a.ZP.getRootId(),t)}else-1===e.item.containerId?await I.move([n],a.ZP.getRootId(),t++):await I.move([n],e.item.containerId,0)}}update(e,t,n){const s={name:"",filename:S(),parentId:-1,index:-1,owner:"",windowId:t,ids:n};return new Promise((t=>{p.Z.sessionsPrivate.update(e,s,(e=>{t(e)}))}))}},k=I},43656:(e,t,n)=>{"use strict";n.d(t,{Z:()=>I});var s=n(5298),i=n(84451),o=n(96951),a=n(29087),r=n(60331),l=n(15489),d=n(2497),c=n(7064),h=n(89175);const p=new Map;function u(e){return p.get(e)??{indicator:void 0,spatnavActive:!1,tabId:-1,point:void 0,url:"",path:""}}function g(e,t){p.get(e)?.spatnavActive!==t&&(p.set(e,{...u(e),spatnavActive:t}),t?(c.Z.tabsPrivate.onWebviewClickCheck.addListener(w),c.Z.tabsPrivate.onKeyboardChanged.addListener(m),i.Z.bind("ctrl+enter",f),i.Z.bind("shift+enter",y),i.Z.bind("ctrl+shift+enter",C)):(c.Z.tabsPrivate.onWebviewClickCheck.removeListener(w),c.Z.tabsPrivate.onKeyboardChanged.removeListener(m),i.Z.unbind("ctrl+enter",f),i.Z.unbind("shift+enter",y),i.Z.unbind("ctrl+shift+enter",C)))}function m(e,t,n,i){if(!t)return;const o=p.get(e);if(!o?.spatnavActive)return;const a=(0,d.Z)(e);if("WEBVIEW"!==a.document.activeElement?.tagName)g(e,!1);else if(i===s.Z.KEY_ESCAPE&&0===n&&o?.spatnavActive){const t=a.document.activeElement,n=parseInt(t.getAttribute("tab_id"));c.Z.tabsPrivate.closeSpatnavOrCurrentOpenMenu(n,(({layout_changed:t,current_element_valid:n})=>{t&&n||g(e,!1)}))}else i===s.Z.KEY_RETURN&&0===n&&v(e,0)}function v(e,t){g(e,!1);const n=p.get(e),s=(0,d.Z)(e).document.activeElement;if(n?.point&&s){const e=parseInt(s.getAttribute("tab_id"));c.Z.tabsPrivate.activateSpatnavElement(e,t)}}function f(e){v(e.windowId,2)}function y(e){v(e.windowId,1)}function C(e){v(e.windowId,3)}function w(e,t,n,s,i){const o=(0,d.Z)(e).document.activeElement;if(!o)return;const a=parseInt(o.getAttribute("tab_id"));p.get(e)?.spatnavActive&&c.Z.tabsPrivate.closeSpatnavOrCurrentOpenMenu(a,(({layout_changed:t,current_element_valid:n})=>{t&&n||g(e,!1)})),g(e,!1)}function b(e){if(e!==l.ZP.getActiveWindowId())return;if(!(0,d.Z)(e).document.activeElement)return;const t=o.ZP.getActivePage(e)?.url??"",n=p.get(e)?.url??"";if(n){if(n!==t){const n=p.get(e)?.spatnavActive;n&&g(e,!1),p.set(e,{...u(e),url:t,point:void 0})}}else p.set(e,{...u(e),url:t,point:void 0})}async function S(e,t){const n=(0,d.Z)(e).document.activeElement;if(!n)return;const s=parseInt(n.getAttribute("tab_id"));if(!a.Z.get(h.kWebpagesSpatialNavigationEnabled)&&s)return;if(p.set(e,{...u(e),tabId:s}),!s)return void g(e,!1);const i=await c.Z.tabsPrivate.moveSpatnavRect(s,t);i&&i.width>0?g(e,!0):g(e,!1),p.set(e,{...u(e),point:i}),r.Z.setStatus(e,i.href)}const I=new class{attachSpatnavListeners(e){const t={onPageStore:b.bind(this,e)};return o.ZP.addListener(t.onPageStore,(t=>t.get(e))),t}detachSpatnavListeners(e){o.ZP.removeListener(e.onPageStore)}async left(e){await S(e,"left")}async up(e){await S(e,"up")}async right(e){await S(e,"right")}async down(e){await S(e,"down")}}},60331:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var s=n(33638),i=n(15489),o=n(1407);let a;const r=new class{setStatus(e,t,n){(e=this.rerouteWindowId(e))!==o.Ex&&(clearTimeout(a),s.Z.dispatch({actionType:"STATUS_SET_STATUS",windowId:e,status:t}),n&&(a=setTimeout(r.clearStatus.bind(this,e),n)))}clearStatus(e){(e=this.rerouteWindowId(e))!==o.Ex&&(clearTimeout(a),s.Z.dispatch({actionType:"STATUS_SET_STATUS",windowId:e,status:""}))}setPersistentStatus(e,t,n){(e=this.rerouteWindowId(e))!==o.Ex&&s.Z.dispatch({actionType:"STATUS_SET_PERSISTENT_STATUS",windowId:e,key:t,status:n})}clearPersistentStatus(e,t){(e=this.rerouteWindowId(e))!==o.Ex&&s.Z.dispatch({actionType:"STATUS_CLEAR_PERSISTENT_STATUS",windowId:e,key:t})}rerouteWindowId(e){return e===o.A4?i.ZP.getMailWindowId():e===o.Ex||i.ZP.isSettings(e)?i.ZP.getLastActiveBrowserWindowId():i.ZP.isTabbedBrowser(e)?e:o.Ex}},l=r},2699:(e,t,n)=>{"use strict";n.d(t,{Z:()=>_});var s=n(65792),i=n.n(s),o=n(68247),a=n(29087),r=n(19486),l=n(33638),d=n(15489),c=n(56371),h=n(92292),p=n(7064),u=n(58848),g=n(65741),m=n(89175),v=n(48588);const f=[m.kSystemAccentColor,m.kSystemDesktopThemeColor,m.kSystemHasDesktopWallpaperProtocol,m.kThemeDimBlurred,m.kThemePrivateWindow,m.kThemeScheduleEnabled,m.kThemeScheduleOS,m.kThemeScheduleTimeline,m.kThemeUseAnimation,m.kThemesCurrent,m.kThemeSimpleScrollbar,m.kThemesPreview,m.kThemesCurrentPrivate,m.kThemesSystem,m.kThemesUser];let y;const C=(0,u.Z)(((e,t)=>{i().valid(t)?l.Z.dispatch({actionType:"THEME_SET_META",tabId:e,color:i()(t)}):console.warn("Invalid meta theme color supplied for tabId",t,e)}),2e3,{trailing:!0});async function w(){const e=h.Z.extension.inIncognitoContext&&!window.isGuestSession?a.Z.get(m.kThemesCurrentPrivate):b(),t=r.Z.getThemeWithFallback(e),{backgroundImage:n,backgroundPosition:s}=t;return[t,await r.Z.getImageVars(n,s)]}function b(e){return r.Z.getPreview()?.id||S(e)}function S(e){if(e&&d.ZP.isIncognito(e))return a.Z.get(m.kThemesCurrentPrivate);switch(a.Z.get(m.kThemeScheduleEnabled)){case"timeline":return r.Z.getTimerByDate(new Date,"current").themeId;case"system":return a.Z.get(m.kThemeScheduleOS)[a.Z.get(m.kSystemDesktopThemeColor)];default:return a.Z.get(m.kThemesCurrent)}}function I(e){switch(a.Z.get(m.kThemeScheduleEnabled)){case"timeline":(0,v.k)(m.kThemeScheduleTimeline,(t=>{const n=r.Z.getTimerByDate(new Date,"current"),s=t.findIndex((e=>e.id===n.id));-1!==s&&(t[s].themeId=e)}));break;case"system":(0,v.k)(m.kThemeScheduleOS,(t=>{t[a.Z.get(m.kSystemDesktopThemeColor)]=e}));break;default:o.Z.set(m.kThemesCurrent,e)}Z()}function k(){const e=new Date,t=r.Z.getTimerByDate(e,"next");if(T(),t&&"timeline"===a.Z.get(m.kThemeScheduleEnabled)){const n=60*(t.minutes+60*t.hours-60*e.getHours()-e.getMinutes())-e.getSeconds();y=setTimeout((async()=>{const e=r.Z.getThemeWithFallback(t.themeId),n=await r.Z.getImageVars(e.backgroundImage,e.backgroundPosition);l.Z.dispatch({actionType:"THEME_SET",style:n,theme:e}),k()}),1e3*n)}}async function A(){const e=a.Z.get(m.kThemeScheduleEnabled);if(["system","timeline"].includes(e)){const[e,t]=await w();l.Z.dispatch({actionType:"THEME_SET",style:t,theme:e})}"timeline"===e?k():T()}function T(){y&&clearTimeout(y)}function Z(){a.Z.get(m.kThemesPreview)?.length>0&&o.Z.reset(m.kThemesPreview)}async function E(e,t,n){if((0,g.Z)(t,e))return;const[s,i]=await w();switch(n){case m.kThemeScheduleEnabled:case m.kThemeScheduleTimeline:l.Z.dispatch({actionType:"THEME_SET",style:i,theme:s}),"timeline"===a.Z.get(m.kThemeScheduleEnabled)?k():T();break;case m.kThemeScheduleOS:case m.kThemesCurrent:case m.kSystemHasDesktopWallpaperProtocol:case m.kSystemDesktopThemeColor:case m.kThemesCurrentPrivate:case m.kThemeDimBlurred:case m.kThemeSimpleScrollbar:case m.kThemesSystem:case m.kThemesUser:case m.kSystemAccentColor:case m.kThemeUseAnimation:case m.kThemesPreview:l.Z.dispatch({actionType:"THEME_SET",style:i,theme:s})}}const _={getCurrentId:b,getCurrentIdWithoutPreview:S,createTheme:function(e){const t=r.Z.getThemeWithFallback(e),n={...t};return n.id=crypto.randomUUID(),n.version=1,n.url="",n.name=(0,c.Z)("$1 copy",[t.name]),I(n.id),o.Z.set(m.kThemesUser,[...a.Z.get(m.kThemesUser),n]),n.id},deleteTheme:function(e){const t=a.Z.get(m.kThemesUser),n=t.findIndex((t=>t.id===e));let s;if(-1!==n){if(t[n+1])s=t[n+1].id;else if(t[n-1])s=t[n-1].id;else{const e=a.Z.get(m.kThemesSystem);s=e[e.length-1].id}a.Z.get(m.kThemesCurrent)===e&&o.Z.set(m.kThemesCurrent,s),a.Z.get(m.kThemesCurrentButtons)===e&&o.Z.reset(m.kThemesCurrentButtons),(0,v.k)(m.kThemeScheduleOS,(t=>{t.dark===e&&(t.dark=s),t.light===e&&(t.light=s)})),(0,v.k)(m.kThemeScheduleTimeline,(t=>{for(let n=0;n<t.length;n++){const i=t[n];i.themeId===e&&(i.themeId=s)}})),o.Z.set(m.kThemesUser,t.filter((t=>t.id!==e)))}else console.warn(`Theme ${e} is not a user theme and cannot be deleted.`)},exportTheme:async function(e,t){await p.Z.themePrivate.export({...e,engineVersion:1},{windowId:t,dialogTitle:(0,c.Z)("Select Export Location")})},installTheme:function(){const e=a.Z.get(m.kThemesPreview)[0];if(e){const t=a.Z.get(m.kThemesUser);o.Z.set(m.kThemesUser,[...t,e]),I(e.id),Z()}},updateTheme:function(){const e=a.Z.get(m.kThemesPreview)[0];if(e){(0,v.k)(m.kThemesUser,(t=>{const n=t.findIndex((t=>t.id===e.id));t[n]=e}))&&I(e.id),Z()}},clearThemePreview:Z,loadFavicon:function(e,t){const n=new Image,s=e.url;n.crossOrigin="Anonymous",n.onload=()=>{n.height=16,n.width=16;const s=r.Z.getPalette(n).map((e=>i()(e)));l.Z.dispatch({actionType:"THEME_SET_PAGE_PALETTE",favIconUrl:e.favIconUrl,hostname:t,windowId:e.windowId,colors:s})},n.onerror=()=>{l.Z.dispatch({actionType:"THEME_SET_FAILED_FAVICON_URL",url:s})},n.src=e.favIconUrl},loadPromise:async function(){Z();const[e,t]=await w();l.Z.dispatch({actionType:"THEME_SET",style:t,theme:e,init:!0}),k(),a.Z.addListener(f,E),p.Z.tabsPrivate.onThemeColorChanged.addListener(C),p.Z.utilities.onSuspend.addListener(T),p.Z.utilities.onResume.addListener(A)},revertSystemTheme:function(e){const t=a.Z.get(m.kThemesSystem),n=t.findIndex((t=>t.id===e)),s=a.Z.getDefault(m.kThemesSystem).find((t=>t.id===e));if(-1!==n&&void 0!==s){if(t[n]!==s){const e=[...t];e[n]=s,o.Z.set(m.kThemesSystem,e)}}else console.warn(e,"is not a valid system theme id")},updateCustomTheme:async function(e){const t=r.Z.getTheme(e);if(t){const{url:e}=t,n=await fetch(e);n.ok||console.warn(`No response from: ${e}`);const s=await n.json();s.download&&t.version<=s.version?p.Z.themePrivate.download(t.id,s.download,(e=>console.log(`Theme loaded: ${e.themeID}`))):console.warn(`Bad response from: ${e}`)}},setNextTheme:function(){const e=a.Z.get(m.kThemesSystem),t=a.Z.get(m.kThemesUser),n=e.concat(t);let s;switch(a.Z.get(m.kThemeScheduleEnabled)){case"timeline":s=r.Z.getTimerByDate(new Date,"current").themeId;break;case"system":const e=a.Z.get(m.kThemeScheduleOS),t=a.Z.get(m.kSystemDesktopThemeColor);s=e[t];break;default:s=a.Z.get(m.kThemesCurrent)}const i=n.findIndex((e=>e.id===s));I(n[i+1]?n[i+1].id:n[0].id)},setTheme:I,setThemeBackgroundImageFromUrl:function(e,t){const n=S(e);t.startsWith("file:")?p.Z.utilities.storeImage({themeId:n,url:t}):fetch(t).then((e=>e.blob())).then((e=>{e.arrayBuffer().then((t=>{p.Z.utilities.storeImage({themeId:n,mimeType:e.type,data:t})}))}))},setThemeByNameWithFallback:function(e){const t=a.Z.get(m.kThemesSystem),n=a.Z.get(m.kThemesUser),s=t.concat(n).find((t=>t?.name===e))?.id;s?I(s):console.warn((0,c.Z)("Unable to find a theme named $1",[e]))}}},69787:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var s=n(33638);class i{static setIntialized(e,t){s.Z.dispatch({actionType:"TILE_INITIALIZED",windowId:e,tilesState:t})}static setTileLayout(e,t,n){s.Z.dispatch({actionType:"TILE_SET_LAYOUT",windowId:e,mosaicLayout:t,id:n})}}},32773:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var s=n(33638);class i{static edit(e){s.Z.dispatch({actionType:"TOOLBAR_EDIT_MODE",toolbar:e})}static stopEditing(){s.Z.dispatch({actionType:"TOOLBAR_STOP_EDIT_MODE"})}}},65810:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var s=n(33638);const i=(e,t)=>t?setTimeout(e,t):e();let o;const a=new class{showTooltip(e,t=0){clearTimeout(o),o=i((()=>s.Z.dispatch({actionType:"TOOLTIP_SET",id:e})),t)}hideTooltip(e=0){clearTimeout(o),o=i((()=>s.Z.dispatch({actionType:"TOOLTIP_SET",id:null})),e)}}},54058:(e,t,n)=>{"use strict";n.d(t,{Z:()=>w});var s=n(5198),i=n(96951),o=n(18350),a=n(29087),r=n(37330),l=n(19486),d=n(85374),c=n(33638),h=n(15489),p=n(92292),u=n(7064),g=n(89175);const m=["colorBgLighter","colorFg","colorBg","colorFgFadedMore","colorBorder","colorBgLighter","colorBgDark"];function v(e,t){let n=t.adoptedLanguage;"und"===n&&(n=t.cldLanguage,"und"===n&&(n="")),c.Z.dispatch({actionType:"VIVALDI_TABS_LANGUAGE_DETERMINED",tabId:e,pageLanguage:n}),C.sendInitDataToInjectedScript(e,n)}function f(e,t,n,s){const i={isTranslated:!0,originalLang:t,translatedLang:n,error:s};c.Z.dispatch({actionType:"VIVALDI_TABS_PAGE_TRANSLATED",tabId:e,message:i})}function y(e,t){!1===t&&c.Z.dispatch({actionType:"VIVALDI_TABS_PAGE_TRANSLATED_REVERT",tabId:e})}const C={async translateSelection(e,t,n){let i=await s.ZP.detectTextLanguage(t,n);i||(i=d.ZP.getPageState(t).pageLanguage??"");const r=n.replace(/\u00AD/g,"");a.Z.get(g.kPanelsTranslateRedirect)?o.Z.translateWithPanel(e,i,n):p.Z.tabs.sendMessage(t,{action:"translateSelection",text:r,textLanguage:i,destLanguage:s.ZP.getTargetTranslationCode(),allLanguages:s.ZP.getTranslationLocales()})},async sendInitDataToInjectedScript(e,t){const n=await u.Z.utilities.getCommandLineValue("translate-server-url");n&&console.warn("Translate server overridden: "+n);const o=i.ZP.getPageById(e)?.windowId,d=o?r.Z.getBaseStylesByWindowId(o,m):l.Z.getFallbackStyle();p.Z.tabs.sendMessage(e,{action:"initData",pageLanguage:s.ZP.getTranslationCode(t),destLanguage:s.ZP.getTargetTranslationCode(),allLanguages:s.ZP.getTranslationLocales(),buttonEnabled:a.Z.get(g.kWebpagesTranslateSelectionButtonEnabled),resultInPanel:a.Z.get(g.kPanelsTranslateRedirect),styles:d,overrideServer:n},(()=>{p.Z.runtime.lastError}))},sendTextLanguageToInjectedScript(e,t){p.Z.tabs.sendMessage(e,{action:"textLanguage",textLanguage:t,textLanguageName:s.ZP.getHumanReadableLanguageFromCode(t)},(()=>{}))},init(){u.Z.tabsPrivate.onLanguageDetermined.addListener(v),u.Z.tabsPrivate.onPageTranslated.addListener(f),u.Z.tabsPrivate.onIsPageTranslatedChanged.addListener(y),u.Z.tabsPrivate.onShowTranslationUI.addListener(((e,t,n,s)=>{c.Z.dispatch({actionType:"VIVALDI_TABS_TRANSLATION_PROGRESS",tabId:e,translateStep:t,error:n,autoTranslate:s})})),p.Z.runtime.onMessage.addListener((function(e,t,n){if(!e||!t.tab?.id)return!1;const a=t.tab.id;if("translateSelectionReady"===e.action){const e=d.ZP.getPageState(a);return C.sendInitDataToInjectedScript(a,e.pageLanguage?e.pageLanguage:""),n(),!0}if("translateDetermineLanguage"===e.action)s.ZP.detectTextLanguage(a,e.text).then((e=>{C.sendTextLanguageToInjectedScript(a,e)}));else if("translateResult"===e.action){const t=i.ZP.getPageById(a)?.windowId;t&&h.ZP.isActive(t)&&u.Z.translateHistory.add(e.item,0),s.ZP.setTargetTranslationCode(e.destLang)}else if("translateInPanel"===e.action){const t=i.ZP.getPageById(a)?.windowId;t&&o.Z.translateWithPanel(t,e.lang,e.text)}return!1}))},resetTranslationParameters(e){c.Z.dispatch({actionType:"PAGE_RESET_TRANSLATION_PARAMETERS",tabId:e})},async translatePage(e){const t=s.ZP.getTargetTranslationCode(),n=d.ZP.getPageState(e);t&&n&&await u.Z.tabsPrivate.translatePage(e,n.pageLanguage?n.pageLanguage:"auto",t)}},w=C},76501:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var s=n(63365),i=n(33638),o=n(15489),a=n(92292),r=n(75256),l=n(7064);async function d(){const e=await a.Z.sessions.getRecentlyClosed();await new Promise((e=>setTimeout(e)));const t=e.filter((e=>{if(e.tab)return!0;if(!e.window)return!1;let t=!0;const n=(0,r.Z)(e.window.vivExtData);for(const[,e]of o.ZP.getState())if(t=e.extId!==n.ext_id,!t)break;return t}));i.Z.dispatch({actionType:"CHROME_SET_SESSION",session:t})}const c=new class{emptyTrash(){l.Z.utilities.clearAllRecentlyClosedSessions()}removeTabs(e){l.Z.utilities.clearRecentlyClosedTabs(e,(e=>{e||console.warn("Error removing tabs")}))}undeleteTab(e){return new Promise(((t,n)=>{a.Z.sessions.restore(e.sessionId,(s=>{a.Z.runtime.lastError&&(console.warn("Error restoring tab: ",e,a.Z.runtime.lastError),n()),t()}))}))}async undeletePreviousTab(){const e=s.Z.getTrash().find((e=>e.tab));e?.tab&&await c.undeleteTab(e.tab)}undeleteWindow(e){a.Z.sessions.restore(e.sessionId,(t=>{a.Z.runtime.lastError&&console.warn("Error restoring page: ",e,a.Z.runtime.lastError.message)}))}loadPromise(){return a.Z.sessions.onChanged.addListener(d),d()}},h=c},67975:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var s=n(33638);const i=new class{updateState(e,t){s.Z.dispatch({actionType:"URLFIELD_UPDATE_STATE",pageId:e,state:t})}reset(e){s.Z.dispatch({actionType:"URLFIELD_RESET",pageId:e})}}},2004:(e,t,n)=>{"use strict";n.d(t,{Z:()=>f});var s=n(53576),i=n(39206),o=n(10589),a=n(15489);const r=function(e){const t=e.replace(/^.*?\:\/\//,"");return!!t.includes('"')&&(!t.includes("/")||t.indexOf('"')<t.indexOf("/"))};var l=n(7064),d=n(36436),c=n(78614),h=n(86662);async function p(e,t,n){if(function(e){const t=e.split(" ");return t.length>=2&&void 0!==i.Z.getByKeyword(t[0])}(t))return u(e,t,n);const{addTypedSearchHistory:s,enableSearch:o,allowOverride:a,useSearchEngine:p,...g}=n,m=t.trimEnd().replace(/^https:\/(?!\/)/i,"https://").replace(/^https:\/{3,}/i,"https://").replace(/^http:\/(?!\/)/i,"http://").replace(/^http:\/{3,}/i,"http://"),{urlValid:v,isBrowserUrl:f,schemeParsed:y}=l.Z.utilities.isUrlValid(m);if((0,h.A)(m)){const e=(0,d.q9)(m);return Promise.resolve({url:e,options:g})}const C="file"!==y&&"javascript"!==y,w=/\s/.test(m),b=w&&/^(\w{1,}\:(\/\/)?)?(\w{1,}(\.\w{1,})?(:\d{1,5})?[/?#])/.test(m),S=/\.(.{2,})(\/)/.test(m.split(" ")[0]),I=/^([a-zA-Z0-9\-\._~!$&'()\*+,;=%]*(:[a-zA-Z0-9\-\._~!$&'()\*+,;=%]*)?)?@\S*/.test(m),k=/^[^\/ ]{1,}:(\/\/)?[^\/ ]{1,}(\/|\?|#)/.test(m);let A;function T(){return A||(A=l.Z.utilities.canOpenUrlExternally(m)),A}const Z=function(e){if(!e.includes(":"))return!1;if(e.includes(" ")&&e.indexOf(" ")<e.indexOf(":"))return!1;try{const t=parseInt(e.split(":")[1].split("/")[0]);return t>=0&&t<=65535}catch(e){return!1}}(m);if(n.enableSearch&&!k&&!I&&!S&&!Z&&(C&&w&&!b||""!==y&&!f&&!await T()))return u(e,m,n);if(v&&(f||await T())&&!Z)return Promise.resolve({url:m,options:g});const E=m.startsWith("?");if(E||(0,c.HZ)(m)||n.enableSearch&&r(m))return u(e,E?m.substr(1):m,n);const _=(0,d.q9)(m),M=/[a-z]+\/$/.test(m),N=/(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}/.test(m),P=l.Z.utilities.getUrlFragments(_),D=Boolean(P.tld),x=/^localhost/.test(m);if(n.enableSearch&&!N&&!D&&!Z&&!x&&!M)return u(e,m,n);try{return new URL(_),Promise.resolve({url:_,options:g})}catch(t){return n.enableSearch?u(e,m,n):Promise.resolve({url:"vivaldi://network-error/-300",options:g})}}async function u(e,t,n={}){const s=t,{addTypedSearchHistory:o,enableSearch:r,allowOverride:d,useSearchEngine:c,...h}=n;if(c){g(e,s,o);const{url:t,contentType:n,postParams:i}=await l.Z.searchEngines.getSearchRequest(c.id,s);return{url:t,options:{...h,postParams:i,contentType:n,transition:l.Z.historyPrivate.TransitionType.KEYWORD}}}const p=i.Z.getByQuery(s);if(p){const t=s.substr(p.keyword.length+1),{url:n,contentType:i,postParams:a}=await l.Z.searchEngines.getSearchRequest(p.id,t);return g(e,t,o),{url:n,options:{...h,postParams:a,contentType:i,transition:l.Z.historyPrivate.TransitionType.KEYWORD}}}const u=i.Z.getDefault(a.ZP.isIncognito(e));if(u){const{url:t,contentType:n,postParams:i}=await l.Z.searchEngines.getSearchRequest(u.id,s);return g(e,s,o),{url:t,options:{...h,postParams:i,contentType:n}}}return{url:t,options:{...h}}}function g(e,t,n){n&&o.Z.addTypedSearchHistory(e,t)}async function m({windowId:e,url:t,options:n}){await s.ZP.openURL(e,t.replace(/ /g,"%20"),{inCurrent:!n.hasOwnProperty("inBackground"),...n})}const v={processUrl:p,processSearchUrl:u,go:async function(e,t,n){await Promise.all(t.map(((s,i)=>{const o=s.trimStart();if(!o)return Promise.resolve();const a={...n};return t.length>1&&(a.inBackground=i!==t.length-1),p(e,o,a).then((({url:t,options:n})=>m({windowId:e,url:t,options:n})))})))},goSearchUrl:async function(e,t,n){const{url:s,options:i}=await u(e,t,n);s&&await m({windowId:e,url:s,options:i})}},f=v},83526:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var s=n(30626),i=n(99827),o=n(96951),a=n(67975),r=n(33638),l=n(57904),d=n(2497),c=n(751);const h=new class{doAction(e,t,n,s){r.Z.dispatch({actionType:"WEBPAGEVIEW_ACTIONS",windowId:e,pageId:t,subAction:n,...s?{payload:s}:null})}findInPage(e,t,n,i){const o=s.Z.getActiveWebView(e);if(o){const s={findNext:!1,matchCase:i||!1};o.find(n,s,this._findCallback.bind(this,e,t,n,i))}}findNextInPage(e,t,n,i,o){const a=s.Z.getActiveWebView(e);if(a){const s={backward:i||!1,findNext:!0,matchCase:o||!1};a.find(n,s,this._findCallback.bind(this,e,t,n,o))}}_findCallback(e,t,n,s,i){i&&!i.canceled&&r.Z.dispatch({actionType:"WEBPAGEVIEW_RESULTS_FROM_FIND_IN_PAGE",windowId:e,pageId:t,searchText:n,matchCase:s,results:i})}closeFindInPageToolbar(e,t){return!0===l.Z.isFindInPageOpen(t)&&(r.Z.dispatch({actionType:"WEBPAGEVIEW_CLOSE_FIND_IN_PAGE",windowId:e,pageId:t}),!0)}go(e,t,n){r.Z.dispatch({actionType:"WEBPAGEVIEW_GO",windowId:e,pageId:t,index:n||0})}back(e,t){o.ZP.getPageInWindow(e,t)?.isMailPage?i.Z.pageBack(e):r.Z.dispatch({actionType:"WEBPAGEVIEW_BACK",windowId:e,pageId:t})}forward(e,t){o.ZP.getPageInWindow(e,t)?.isMailPage?i.Z.pageForward(e):r.Z.dispatch({actionType:"WEBPAGEVIEW_FORWARD",windowId:e,pageId:t})}getPageHistory(e,t,n){r.Z.dispatch({actionType:"WEBPAGEVIEW_GET_HISTORY",windowId:e,pageId:t,callback:n})}stop(e,t){r.Z.dispatch({actionType:"WEBPAGEVIEW_STOP",windowId:e,pageId:t})}reload(e,t,n){(0,c.gR)((0,d.Z)(e)),r.Z.dispatch({actionType:"WEBPAGEVIEW_RELOAD",windowId:e,pageId:t,bypassCache:n}),a.Z.reset(t)}}},63153:(e,t,n)=>{"use strict";n.d(t,{Z:()=>E});var s=n(30626),i=n(7065),o=n(53576),a=n(96951),r=n(68247),l=n(29087),d=n(60331),c=n(37330),h=n(19486),p=n(69787),u=n(33638),g=(n(16920),n(15489)),m=n(56371),v=n(92292),f=n(75256),y=n(7064),C=n(44850),w=n(69046),b=n(89175),S=n(34155);function I(){0}function k(e,t){const n=g.ZP.getWindowState(e);n&&u.Z.dispatch({actionType:"WINDOW_STATE_CHANGED",windowId:e,oldState:n,change:t})}function A(e,t){u.Z.dispatch({actionType:"WINDOW_ACTIVATED",windowId:e,activated:t})}function T(e){u.Z.dispatch({actionType:"WINDOW_READY",windowId:e})}function Z(e,t,n){for(const[e]of g.ZP.getState())g.ZP.isMinimalUI(e)||u.Z.dispatch({actionType:"WINDOW_UPDATE_FROM_PREFS",windowId:e})}const E=new class{minimize(e){const t=g.ZP.getWindowState(e);t&&(y.Z.windowPrivate.setState(e,"minimized"),u.Z.dispatch({actionType:"WINDOW_STATE_CHANGED",windowId:e,oldState:t,change:"minimized"}))}minimizeAll(){for(const[e]of g.ZP.getState())this.minimize(e)}maximize(e){const t=g.ZP.getWindowState(e);t&&(y.Z.windowPrivate.setState(e,"maximized"),u.Z.dispatch({actionType:"WINDOW_STATE_CHANGED",windowId:e,oldState:t,change:"maximized"}))}restore(e){if(g.ZP.isHTML5Fullscreen(e)){const t=s.Z.getActiveWebView(e);t&&t.setIsFullscreen(!1),this.restoreStateAfterHTMLFullscreen(e)}else{const t=g.ZP.getWindowState(e);t&&(y.Z.windowPrivate.setState(e,"normal"),u.Z.dispatch({actionType:"WINDOW_STATE_CHANGED",windowId:e,oldState:t,change:"normal"}))}}setFullscreen(e){const t=g.ZP.getWindowState(e);t&&(y.Z.windowPrivate.setState(e,"fullscreen"),u.Z.dispatch({actionType:"WINDOW_STATE_CHANGED",windowId:e,oldState:t,change:"fullscreen"}))}toggleFullscreen(e){g.ZP.isFullscreen(e)?this.restore(e):this.setFullscreen(e)}restoreStateAfterHTMLFullscreen(e){const t=g.ZP.getWindowState(e);if(t){const n=g.ZP.getRestoreStateHtml5Fullscreen(e);y.Z.windowPrivate.setState(e,n),u.Z.dispatch({actionType:"WINDOW_STATE_CHANGED",windowId:e,oldState:t,change:n})}}async close(e){return v.Z.windows.remove(e)}onHTML5FullScreen(e,t){if(e)y.Z.windowPrivate.setState(t,"fullscreen");else{const e=g.ZP.getRestoreStateHtml5Fullscreen(t);y.Z.windowPrivate.setState(t,e)}u.Z.dispatch({actionType:"WINDOW_HTML5_FULL_SCREEN",windowId:t,html5FullScreen:e})}async setActiveWorkspace(e,t){if(t&&g.ZP.getIds("normal").length>1){const n=g.ZP.getActiveWorkspaces(e).get(t);if(n)return void this.focus(n);await o.ZP.moveWorkspaceToWindow(e,t)}u.Z.dispatch({actionType:"WINDOW_SET_ACTIVE_WORKSPACE",windowId:e,id:t})}toggleMinimalUI(e){u.Z.dispatch({actionType:"WINDOW_MINIMAL_UI",windowId:e,minimalUI:!g.ZP.isMinimalUI(e)})}toggleBookmarksBar(e){g.ZP.isMinimalUI(e)?u.Z.dispatch({actionType:"WINDOW_TOGGLE_BOOKMARKS_BAR",windowId:e}):g.ZP.isGuest()||r.Z.toggle(b.kBookmarksBarVisible,!0,!1)}toggleAddressBar(e){g.ZP.isMinimalUI(e)?u.Z.dispatch({actionType:"WINDOW_TOGGLE_ADDRESS_BAR",windowId:e}):r.Z.toggle(b.kAddressBarVisible,!0,!1)}toggleTabs(e){g.ZP.isMinimalUI(e)?u.Z.dispatch({actionType:"WINDOW_TOGGLE_TABS",windowId:e}):r.Z.toggle(b.kTabsVisible,!0,!1)}togglePanelToggle(e){g.ZP.isMinimalUI(e)?u.Z.dispatch({actionType:"WINDOW_TOGGLE_PANEL_TOGGLE",windowId:e}):r.Z.toggle(b.kPanelsShowToggle,!0,!1)}toggleStatusBar(e){g.ZP.isMinimalUI(e)?u.Z.dispatch({actionType:"WINDOW_TOGGLE_STATUS_BAR",windowId:e}):(r.Z.toggle(b.kStatusBarDisplay,"on",l.Z.get(b.kStatusBarMinimized)),S.nextTick((()=>{"overlay"===l.Z.get(b.kStatusBarDisplay)&&d.Z.setStatus(e,(0,m.Z)("Status Info set to Overlay"),2e3)})))}focus(e){return v.Z.windows.update(e,{focused:!0})}async openWindow(e,t,n,s){const i="normal"===n&&g.ZP.isMaximized(e),o={incognito:!1,state:i?"maximized":"normal",...s};if(o.tabUrl)o.tabUrl=(0,C.Gr)(o.tabUrl);else if("normal"===n){const t=l.Z.get(b.kIncognitoShowIntro);o.tabUrl=o.incognito&&t?C.xy["private-intro"]:a.ZP.getDefaultStartpage(e)}const r={ext_id:crypto.randomUUID(),...o.vivExtData?JSON.parse(o.vivExtData):null};"settings"===n&&(r.isSettings=!0),o.vivExtData=JSON.stringify(r),I();const d=await y.Z.windowPrivate.create(t,o,n);return i&&setTimeout((()=>this.maximize(d)),50),d}async openBrowserWindow(e,t,n={}){"string"==typeof t&&(t=(0,C.Gr)(t));let s=!1;const i={url:t,incognito:!1,transition:y.Z.historyPrivate.TransitionType.AUTO_TOPLEVEL,...n};g.ZP.isMaximized(e)&&(void 0===i.left&&void 0===i.top&&void 0===i.width&&void 0===i.height?i.state="maximized":s=!0);const o={ext_id:crypto.randomUUID(),...n.vivExtData?JSON.parse(n.vivExtData):null};if(i.vivExtData=JSON.stringify(o),I(),void 0===i.url){const t=l.Z.get(b.kIncognitoShowIntro);i.url=i.incognito&&t?C.xy["private-intro"]:a.ZP.getDefaultStartpage(e)}const r=await v.Z.windows.create(i);return s&&r?.id&&this.maximize(r.id),r}openIncognitoWindow(e,t){return this.openBrowserWindow(e,t,{incognito:!0})}__initForTests(){window.vivaldiWindowId=42,window.isGuestSession=!1,u.Z.dispatch({actionType:"WINDOW_SET_STATE",windowState:{extId:"cl75x1ek60000lji5dpopf94g",active:!0,state:"maximized",restoreStateFullscreen:"normal",restoreStateHtml5Fullscreen:"normal",fullscreenMenubarShown:!1,guest:!1,html5FullScreen:!1,incognito:!1,nativeDecorations:!1,minimalUI:!1,type:"normal",activeWorkspaceId:void 0,visibleUI:{addressBar:!1,bookmarksBar:!1,panelToggle:!1,tabs:!0,statusBar:"on"}},windowId:42,windowExtData:{}})}_setWindowState(e,t){const n=e.id;if("number"!=typeof n)return;const s=(0,f.Z)(e.vivExtData);let o;s.ext_id||(s.ext_id=crypto.randomUUID(),v.Z.windows.update(n,{vivExtData:JSON.stringify(s)})),o="popup"===e.type?s.isSettings?"settings":"popup":"normal";const a={extId:s.ext_id,active:e.focused,state:"locked-fullscreen"===e.state?"normal":e.state,restoreStateFullscreen:"maximized"===e.state?"maximized":"normal",restoreStateHtml5Fullscreen:"normal",fullscreenMenubarShown:!1,guest:t,html5FullScreen:!1,incognito:e.incognito&&!t,minimalUI:s.minimalUI,nativeDecorations:l.Z.get(b.kWindowsUseNativeDecoration),type:o,visibleUI:g.ZP.getUIFromPrefs(),activeWorkspaceId:s.activeWorkspaceId};if(s.visibleUI&&(0,g.TF)(a)&&(a.visibleUI=s.visibleUI),"fullscreen"===a.state&&(l.Z.get(b.kStartupRememberFullScreen)?y.Z.windowPrivate.setState(n,"fullscreen"):a.state="normal"),s.commandline_tab){for(const t of s.commandline_tab){const n=(e.tabs??[])[t];if(!n)break;const i=(0,f.Z)(n.vivExtData);i.workspaceId=s.activeWorkspaceId;const o=JSON.stringify(i);n.vivExtData=o,v.Z.tabs.update(n.id,{vivExtData:o})}delete s.commandline_tab,v.Z.windows.update(n,{vivExtData:JSON.stringify(s)})}if(!a.guest&&!a.incognito&&0===g.ZP.getIds("normal").filter((e=>!g.ZP.isIncognito(e))).length&&"settings"!==a.type&&e.tabs){const t=e.tabs.find((e=>e.active)),n=t?i.ZP.tabToPage(t):void 0,o=n?(0,w.cm)(n):s.activeWorkspaceId;a.activeWorkspaceId=o}if(u.Z.dispatch({actionType:"WINDOW_SET_STATE",windowState:a,windowId:n,windowExtData:s}),"settings"!==a.type){const t=e.tabs??[],i=s.historystack??[];u.Z.dispatch({actionType:"CHROME_TABS_INIT",tabs:t,windowId:n,historystack:i})}"object"==typeof s.tiles&&p.Z.setIntialized(n,s.tiles);const{theme:r}=c.Z.getState(),{backgroundImage:d,backgroundPosition:m}=r;h.Z.getImageVars(d,m).then((e=>u.Z.dispatch({actionType:"THEME_WINDOW_CREATED",style:e,windowId:n})))}loadPromise=async()=>{const{isGuestSession:e}=window;y.Z.windowPrivate.onStateChanged.addListener(k),y.Z.windowPrivate.onActivated.addListener(A),y.Z.windowPrivate.onWebContentsHasWindow.addListener(T),l.Z.addListener([b.kAddressBarVisible,b.kBookmarksBarVisible,b.kPanelsShowToggle,b.kStatusBarDisplay,b.kTabsVisible],Z),v.Z.windows.onCreated.addListener((t=>{if("normal"===t.type&&(g.ZP.initializingWindowId=t.id),("normal"===t.type||"popup"===t.type)&&v.Z.extension.inIncognitoContext===t.incognito)return this._setWindowState(t,e)})),v.Z.windows.onRemoved.addListener((e=>{y.Z.devtoolsPrivate.closeDevtools(1,e,(e=>{})),u.Z.dispatch({actionType:"WINDOW_CLOSED",windowId:e})}));const t=await v.Z.windows.getAll({populate:!0,windowTypes:["normal"]});for(const n of t)this._setWindowState(n,e)}}},29104:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var s=n(53576),i=n(96951),o=n(29087),a=n(33638),r=n(63153),l=n(15489),d=n(64387),c=n(53454),h=n(89175);const p=new class{loadPromise=async()=>{a.Z.dispatch({actionType:"WORKSPACES_INIT",workspaces:o.Z.get(h.kWorkspacesList)})};addWorkspaceWithId(e,t,n,s,i){const o=l.ZP.isIncognito(e)?"CREATE_PRIVATE_WORKSPACE":"CREATE_WORKSPACE";return a.Z.dispatch({actionType:o,id:t,name:n,icon:s,emoji:i}),t}async addWorkspace(e,t,n,o=!1,d=!1){const c=l.ZP.getLastActiveBrowserWindowId(),h=Date.now(),p=l.ZP.isIncognito(c)?"CREATE_PRIVATE_WORKSPACE":"CREATE_WORKSPACE";a.Z.dispatch({actionType:p,id:h,name:e,icon:t,emoji:n});const u=()=>d?Promise.resolve():r.Z.setActiveWorkspace(c,h);if(o){const e=i.ZP.getPages(c,{workspaceId:void 0});await s.ZP.moveToWorkspace(e,h),await u(),s.ZP.cycleByOrder(c,void 0)}else await u();return h}setName(e,t){const n=l.ZP.isIncognito(l.ZP.getLastActiveBrowserWindowId())?"SET_PRIVATE_WORKSPACE_NAME":"SET_WORKSPACE_NAME";a.Z.dispatch({actionType:n,id:e,name:t})}setIcon(e,t){const n=l.ZP.isIncognito(l.ZP.getLastActiveBrowserWindowId())?"SET_PRIVATE_WORKSPACE_ICON":"SET_WORKSPACE_ICON";a.Z.dispatch({actionType:n,id:e,icon:t})}setEmoji(e,t){const n=l.ZP.isIncognito(l.ZP.getLastActiveBrowserWindowId())?"SET_PRIVATE_WORKSPACE_EMOJI":"SET_WORKSPACE_EMOJI";a.Z.dispatch({actionType:n,id:e,emoji:t})}async removeWorkspace(e,t){l.ZP.getActiveWorkspace(e)===t&&await r.Z.setActiveWorkspace(e,void 0),await d.Z.removeWorkspaceRules(t),await s.ZP.closeWorkspaceTabs(t);const n=l.ZP.isIncognito(e)?"REMOVE_PRIVATE_WORKSPACE":"REMOVE_WORKSPACE";a.Z.dispatch({actionType:n,id:t})}activateWorkspaceByIndex(e,t){if("number"!=typeof t)r.Z.setActiveWorkspace(e,void 0);else{const n=c.Z.getWorkspaces(e)[t]?.id;n&&r.Z.setActiveWorkspace(e,n)}}setOrder(e,t){const n=l.ZP.isIncognito(e)?"REORDER_PRIVATE_WORKSPACES":"REORDER_WORKSPACES";a.Z.dispatch({actionType:n,ids:t})}_activateByOrder(e,t){const n=l.ZP.getActiveWorkspace(e),s=l.ZP.getActiveWorkspaces(e),i=c.Z.getWorkspaces(e).filter((e=>e.id===n||!s.has(e.id))).map((e=>e.id));if(!n){let n;return n="forward"===t?i[0]:i[i.length-1],void r.Z.setActiveWorkspace(e,n)}let o;if("forward"===t){const e=i.indexOf(n)+1;o=e>=i.length?void 0:i[e]}else{const e=i.indexOf(n)-1;o=e<-1?i[i.length-1]:-1===e?void 0:i[e]}r.Z.setActiveWorkspace(e,o)}activateNextByOrder(e){this._activateByOrder(e,"forward")}activatePreviousByOrder(e){this._activateByOrder(e,"backward")}hibernateInactive(e){const t=Array.from(l.ZP.getActiveWorkspaces(e).keys());c.Z.getWorkspaces(e).forEach((e=>{if(!t.includes(e.id)){i.ZP.getWorkspacePages(e.id).filter((e=>!e.active)).forEach(s.ZP.discardPage)}}))}}},64387:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var s=n(29087),i=n(33638),o=n(92),a=n(89175);function r(e,t){0===t.length&&0!==e.length&&i.Z.dispatch({actionType:"UPDATE_LINK_ROUTES_FROM_PREFS"})}const l=new class{loadPromise=async()=>{const e=s.Z.get(a.kWorkspacesLinkRoutes);i.Z.dispatch({actionType:"WORKSPACE_LINK_ROUTES_INIT",rules:e}),s.Z.addListener([a.kWorkspacesLinkRoutes],r)};async addLinkRoutingRule(e,t,n){const s=crypto.randomUUID();return i.Z.dispatch({actionType:"CREATE_WORKSPACE_LINK_ROUTE",id:s,type:e,expression:t,workspaceId:n}),s}async removeLinkRoutingRules(e){i.Z.dispatch({actionType:"REMOVE_WORKSPACE_LINK_ROUTES",ids:e})}async updateLinkRoutingRule(e,t,n,s){i.Z.dispatch({actionType:"UPDATE_WORKSPACE_LINK_ROUTE",id:e,type:t,expression:n,workspaceId:s})}async removeWorkspaceRules(e){const t=o.Z.getWorkspaceRules(e);t.length>0&&await this.removeLinkRoutingRules(t.map((e=>e.id)))}setOrder(e,t){i.Z.dispatch({actionType:"REORDER_WORKSPACE_LINK_ROUTES",ids:t})}}},22303:(e,t,n)=>{"use strict";n.d(t,{Z:()=>v});var s=n(30626),i=n(96951),o=n(29087),a=n(60331),r=n(33638),l=n(47825),d=n(56371),c=n(7064),h=n(71828),p=n(89175),u=n(44850);function g(e){r.Z.dispatch({actionType:"ZOOM_PAGE_DEFAULT",zoomData:e})}const m=new class{async setUIZoomPercentage(e){await m.setUIZoom(e/100)}async setUIZoom(e){const t=Math.min(Math.max(e,h.bI),h.OK);await c.Z.zoom.setVivaldiUIZoom(t)}async setDefaultWebPageZoom(e){const t=Math.min(Math.max(e/100,h.XF),h.qt);await c.Z.zoom.setDefaultZoom(t)}setPageZoomPercentage(e,t){m.setPageZoom(e,t/100)}setPageZoom(e,t){const n=Math.min(Math.max(t,h.XF),h.qt);(i.ZP.getActivePage(e)?.url??"").startsWith(u.jk.internals.notes)?r.Z.dispatch({actionType:"ZOOM_NOTES",zoomData:n}):r.Z.dispatch({actionType:"ZOOM_PAGE",zoomData:n});const l=s.Z.getActiveWebView(e);l&&(l.setZoom(n),"overlay"!==o.Z.get(p.kStatusBarDisplay)&&o.Z.get(p.kToolbarsStatus).includes("Zoom")||a.Z.setStatus(e,(0,d.Z)("Page Zoom $1%",[Math.round(100*n)]),2e3))}async uiZoomIn(){const e=l.Z.getUIZoom(),t=parseFloat(e+h.pL);await m.setUIZoom(t)}async uiZoomOut(){const e=l.Z.getUIZoom(),t=parseFloat(e-h.pL);await m.setUIZoom(t)}async pageZoomIn(e){const t=await m.getActiveZoom(e);m.setPageZoom(e,parseFloat((t+h.Zh).toFixed(2)))}async pageZoomOut(e){const t=await m.getActiveZoom(e);m.setPageZoom(e,parseFloat((t-h.Zh).toFixed(2)))}async pageZoomHalf(e){const t=await m.getActiveZoom(e);m.setPageZoom(e,parseFloat((t/2).toFixed(2)))}async pageZoomReset(e){const t=await c.Z.zoom.getDefaultZoom();m.setPageZoom(e,t)}async pageZoomDouble(e){const t=await m.getActiveZoom(e);m.setPageZoom(e,parseFloat((2*t).toFixed(2)))}getActiveZoom(e){return new Promise((t=>{const n=s.Z.getActiveWebView(e);n?n.getZoom((e=>{t(e)})):t(h.rM)})).then((e=>e))}dispatchZoomUI(e){r.Z.dispatch({actionType:"ZOOM_SET_UI",zoomData:e})}};c.Z.zoom.getVivaldiUIZoom((e=>{m.dispatchZoomUI(e)})),c.Z.zoom.onUIZoomChanged.addListener((e=>{m.dispatchZoomUI(e)})),c.Z.zoom.getDefaultZoom(g),c.Z.zoom.onDefaultZoomChanged.addListener(g);const v=m},34820:(e,t,n)=>{"use strict";var s=n(92292);let i;n(89907).k||(i=s.Z.extension.getViews().find((e=>e.isPortal))??window,i.isPortal||(i.isPortal=!0,i.requestAnimationFrame=e=>s.Z.extension.getViews().find((e=>e!==i))?.requestAnimationFrame(e),i.cancelAnimationFrame=e=>s.Z.extension.getViews().find((e=>e!==i))?.cancelAnimationFrame(e)));const o=i;var a=n(4660),r=n(17751),l=n(99827),d=n(53576),c=n(60331),h=n(1407);const p={contact:a.Z,mail:l.Z,page:d.ZP,status:c.Z,logger:r.Z};new BroadcastChannel("actions").addEventListener("message",(function(e){if(e.origin!==h.oP||!e.data||!e.data.actions)return;const{actionType:t,action:n,args:s}=e.data.actions,i=p[t];if(!i)throw new Error("Action creator not found for action type "+t);if("function"!=typeof i[n])throw new Error("Action "+i+"."+n+" not found");i[n](...s)}),!1);n(44620);var u=n(39005),g=n(48603),m=n(2934),v=n(47995),f=n(27033),y=n(33638),C=n(7064),w=n(29489);function b(){const e=f.Z.getScripts();S((({scripts:t})=>{const n=e.filter((e=>!t.includes(e))).map((e=>function(e){return`COMMAND_${(0,w.gD)(e).toUpperCase()}`.replace(/\s+/g,"_")}(e)));y.Z.dispatch({actionType:"CONTENT_SCRIPTS_UPDATED",updated:n,scripts:t})}))}function S(e){C.Z.pageActions.getScripts((t=>{const n=t.map((e=>`COMMAND_${(0,w.gD)(e)}`.toUpperCase().replace(/\s+/g,"_")));e({scriptNames:n,scripts:t})}))}const I={loadPromise:function(){return C.Z.pageActions.onScriptsChanged.addListener(b),new Promise((e=>{S((({scriptNames:t,scripts:n})=>{y.Z.dispatch({actionType:"CONTENT_SCRIPTS_INITIALIZE",scripts:n}),e()}))}))}};const k=new class{async loadPromise(){(async function(){const e=await fetch("https://vivaldi.com/bookmark/json/directmatch.json").then((e=>e.json()));return e.blocks.forEach((e=>{(new Image).src=e.unit.image_url})),{directMatchBlocks:e}})().then((e=>{y.Z.dispatch({actionType:"DIRECT_MATCH_INIT",directMatchData:e})}))}};var A=n(83784),T=n(87210),Z=n(31186),E=n(16920),M=n(30381),N=n.n(M);let P=!1;const D=[];async function x(){const e=N()().startOf("date"),t=N()().endOf("date");return new Promise((n=>{C.Z.historyPrivate.visitSearch({startTime:e.valueOf(),endTime:t.valueOf()},(e=>{y.Z.dispatch({actionType:"HISTORY_LOAD_TODAY",items:e}),n()}))}))}function O(e){for(;e.timeRemaining()>0&&D.length>0;){const e=D.pop();e.length>0&&y.Z.dispatch({actionType:"HISTORY_LOAD_YESTERDAY_AND_OLDER",items:e}),D.length>0&&requestIdleCallback(O)}}const L=new class{async loadPromise(){await x(),y.Z.dispatch({actionType:"HISTORY_INIT"});const e="HISTORY_"+Z.Z.getPanelResourceKey(),t=E.Z.getSync(e);t&&y.Z.dispatch({actionType:"HISTORY_INIT_FILTER",id:Z.Z.getPanelResourceKey(),setting:t}),s.Z.history.onVisited.addListener(x)}loadTodayHistory(){x()}_searchAndQueue=async e=>{const t=await C.Z.historyPrivate.visitSearch({startTime:e.from,endTime:e.to});D.push(t)};loadAll(){if(!P){P=!0;const e="month",t=N()().subtract(1,"d").endOf("d"),n=36,s=N()().subtract(n+1,e).endOf(e),i=N()("1970-01-01"),o=[this._searchAndQueue({to:s.valueOf(),from:i.valueOf()})];for(let s=n;s>=0;s--){const n=N()(t).subtract(s,e).endOf(0===s?"d":e),i=N()(n).startOf(e);o.push(this._searchAndQueue({to:n.valueOf(),from:i.valueOf()}))}Promise.allSettled(o).then((()=>requestIdleCallback(O)))}}deleteHistoryPromise(e){return y.Z.dispatch({actionType:"HISTORY_REMOVE_VISITS",visits:e}),Promise.all(e.map((e=>new Promise((t=>{if(e.isFolder){const n=N()(e.visitTime),i={startTime:N()(n.startOf("day")).valueOf(),endTime:N()(n.endOf("day")).valueOf()};s.Z.history.deleteRange(i,(()=>{t()}))}else{const n={time:e.visitTime,url:e.url||""};C.Z.historyPrivate.deleteVisits(n,(()=>{t()}))}})))))}removeLocalHistory(e){N()(e).isSame(N()(),"day")?x():y.Z.dispatch({actionType:"HISTORY_REMOVE_AFTER",since:e})}searchHistory(e,t){y.Z.dispatch({actionType:"HISTORY_SEARCH",filter:t,id:e})}saveStateFromSearchQuery(e,t){Z.Z.isPanel(e)?E.Z.set({["HISTORY_"+e]:{rangePicker:t.rangePicker,startTime:t.startTime.valueOf(),endTime:t.endTime.valueOf()}}):E.Z.set({HISTORY_MANAGER_STATE:{displayMode:t.displayMode,startTime:t.startTime.valueOf(),endTime:t.endTime.valueOf(),dayPickerVisible:t.dayPickerVisible,moreInfoVisible:t.moreInfoVisible,monthEntriesVisible:t.monthEntriesVisible}})}};var R=n(65792),B=n.n(R),F=n(24602),V=n(93513);class W extends F.Z{getInitialState(){return{lights:new Map,groups:new Map}}reduce(e,t){return"HUE_LIGHTS_UPDATE"===t.actionType?(0,V.Uy)(e,(e=>(e.groups=t.groups,e.lights=t.lights,e))):"HUE_LIGHTS_SET"===t.actionType?(0,V.Uy)(e,(t=>e||t)):e}}const U=new W;var H=n(29087),z=n(37330),G=n(15489),$=n(89175);async function K(){const e=H.Z.get($.kHueBridgeIp),t=H.Z.get($.kHueUsername);if(!e||!t)return void y.Z.dispatch({actionType:"HUE_LIGHTS_UPDATE",groups:new Map,lights:new Map});const n=await fetch(`http://${e}/api/${t}/lights`);n.ok||console.warn(`Unable to retrieve lights from bridge at ${e}`);const s=await n.json(),i=new Map(Object.entries(s)),o=await fetch(`http://${e}/api/${t}/groups`);o.ok||console.warn(`Unable to retrieve lights from bridge at ${e}`);const a=await o.json(),r=new Map(Object.entries(a));for(const[e,t]of r){t.lights.map((e=>i.get(e))).some((e=>e?.capabilities?.control?.colorgamuttype))||r.delete(e)}y.Z.dispatch({actionType:"HUE_LIGHTS_UPDATE",groups:r,lights:i})}let j;function Y(){const e=H.Z.get($.kHueBridgeIp),t=H.Z.get($.kHueUsername),n=H.Z.get($.kHueLights);if(!e||!t||!n)return;const s=G.ZP.getLastActiveBrowserWindowId(),i=z.Z.getState().windowStyles.get(s)?.["--colorAccentBg"];if("string"!=typeof i)return;if(i===j)return;j=i;const o=function(e){let t=e.get("rgb.r"),n=e.get("rgb.g"),s=e.get("rgb.b");t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92,n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/13.02,s=s>.04045?Math.pow((s+.055)/1.055,2.4):s/12.92;const i=.664511*t+.154324*n+.162028*s,o=.283881*t+.668433*n+.047685*s,a=88e-6*t+.07231*n+.986039*s;return[i/(i+o+a),o/(i+o+a)]}(B()(i)),a=`http://${e}/api/${t}`;for(const[e,t]of U.getState().lights)n.includes(t.uniqueid)&&fetch(`${a}/lights/${e}/state/`,{method:"put",body:JSON.stringify({transitiontime:3,xy:o})}).catch((e=>{console.warn("Unable to set Hue light",t.name,e)}))}async function X(e,t,n){switch(n){case $.kHueEnabled:await K(),t?(Y(),z.Z.addListener(Y),G.ZP.addListener(Y)):(z.Z.removeListener(Y),G.ZP.removeListener(Y));break;case $.kHueLights:y.Z.dispatch({actionType:"HUE_LIGHTS_SET",lights:t})}}const Q={loadPromise:async function(){H.Z.addListener([$.kHueEnabled,$.kHueLights],X),H.Z.get($.kHueEnabled)&&await X(!1,!0,$.kHueEnabled)},updateLights:K,flash:function(e){const t=H.Z.get($.kHueBridgeIp),n=H.Z.get($.kHueUsername);fetch(`http://${t}/api/${n}/lights/${e}/state`,{method:"put",body:JSON.stringify({alert:"select"})})}};var q=n(19789),J=n(15544),ee=n(45502),te=n(35369);class ne extends F.Z{getInitialState(){return{feature:"browser",hasActiveMessage:!1,hasMenu:!1,pageId:void 0,pages:(0,te.aV)(),windowId:G.Ex}}getHasActiveMessage(){return this.getState().hasActiveMessage}getHasMenu(){return this.getState().hasMenu}getName(){return"mac"}getPageId(){return this.getState().pageId}getPages(){return this.getState().pages}getWindowId(){return this.getState().windowId}reduce(e,t){switch(t.actionType){case"MACMENU_INIT":case"MACMENU_SET_WINDOW_ID":return(0,V.Uy)(e,(e=>{e.windowId=t.windowId}));case"MACMENU_SET_FEATURE":return(0,V.Uy)(e,(e=>{e.feature=t.feature}));case"MACMENU_SET_HAS_ACTIVE_MESSAGE":return(0,V.Uy)(e,(e=>{e.hasActiveMessage=t.hasActiveMessage}));case"MACMENU_SET_HAS_MENU":return(0,V.Uy)(e,(e=>{e.hasMenu=t.hasMenu}));case"MACMENU_SET_PAGE":return(0,V.Uy)(e,(e=>{e.pageId=t.pageId,e.pages=t.pages}));default:return this.getState()}}}const se=new ne(y.Z);var ie=n(96951),oe=n(32921),ae=n(76747),re=n(26591);const le=function(e,t){const n=ae.Z.getShortcutSettings(),s=function(t){if(t.isVisible&&!t.isVisible(e,!1))return null;if(ae.Z.isSeparator(t))return{type:"separator",name:"",action:"",withNoWindow:!0,id:-1};if("container"===t.type){const n=ae.Z.getDisplayName(t);return t.container?{type:"container",name:n,action:t.container.content,edge:t.container.edge,withNoWindow:!0===t.withNoWindow,enabled:!t.isEnabled||t.isEnabled(e),id:-1}:null}{let i;t.url&&(i=re.Z);const o="folder"===t.type?t.items?t.items.map(s).filter(Boolean):[]:null;if("folder"!==t.type&&!t.commandName)return null;const a=!t.isVisibleMac||t.isVisibleMac(e,!1);return{type:t.type,name:ae.Z.getDisplayName(t),action:t.commandName||"",withNoWindow:!0===t.withNoWindow,enabled:!t.isEnabled||t.isEnabled(e),id:-1,items:o,shortcut:ae.Z.getShortcut(t,n),checked:!(!t.checked||t.statestrings)&&t.checked,emphasized:t.emphasized,parameter:t.parameter,visible:a,url:t.url,icon:i}}};return t.map(s).filter(Boolean)};var de=n(34155);let ce;function he(e){switch(e){case"menu":de.nextTick((()=>{y.Z.dispatch({actionType:"MACMENU_SET_HAS_MENU",hasMenu:!0})}));break;case"menuState":case"shortcut":Ce()}}function pe(){de.nextTick((()=>{const e=G.ZP.getActiveWindowId();y.Z.dispatch({actionType:"MACMENU_SET_WINDOW_ID",windowId:e})}))}function ue(){de.nextTick((()=>{const e=se.getWindowId();if(G.ZP.isActive(e)){const t=ie.ZP.getActivePage(e)?.id;(se.getPageId()!==t||function(e,t){const n=ie.ZP.getPages(e);return n.size!==t.size||t.some(((e,t)=>{const s=n.get(t);return e!==s&&(e.title!==s?.title||e.url!==s?.url)}))}(e,se.getPages()))&&y.Z.dispatch({actionType:"MACMENU_SET_PAGE",pageId:t,pages:ie.ZP.getPages(e)})}}))}function ge(){de.nextTick((()=>{const e=ee.Z.getContext(se.getWindowId()).feature;y.Z.dispatch({actionType:"MACMENU_SET_FEATURE",feature:e})}))}function me(){de.nextTick((()=>{const e=se.getWindowId();if(G.ZP.isActive(e)&&G.ZP.isMail(e)){const e=Boolean(u.Z.getActiveMessage());y.Z.dispatch({actionType:"MACMENU_SET_HAS_ACTIVE_MESSAGE",hasActiveMessage:e})}}))}function ve(){const e=se.getWindowId();G.ZP.isActive(e)&&!G.ZP.isSettings(e)&&Ce()}function fe(){G.ZP.isActive(se.getWindowId())&&Ce()}async function ye(){await C.Z.menubar.getHasWindows()||we(G.Ex)}function Ce(){if(se.getHasMenu()){const e=se.getWindowId();e!==G.Ex&&we(e)}}function we(e){void 0===ce?(ce=e,setTimeout((()=>{const t=J.Z.getNamedMenu(e,se.getName(),!0);void 0!==ce&&C.Z.menubar.setup(le(ce,t)),ce=void 0}),100)):ce=e}new class{init(){if(!se.getHasMenu()){const e=G.ZP.getActiveWindowId();y.Z.dispatch({actionType:"MACMENU_INIT",windowId:e}),se.addListener(Ce),J.Z.addListener(he),G.ZP.addListener(pe,(e=>{const t=G.ZP.getActiveWindowId();return{windowId:t,minimalUI:G.ZP.isMinimalUI(t)}})),ie.ZP.addListener(ue,(e=>e.get(se.getWindowId()))),ee.Z.addListener(ge),u.Z.addListener(me),H.Z.addListener([$.kTabsStackingMode,$.kPanelsWindowShowPinnedGroup,$.kConfirmToQuitEnabled],ve),oe.Z.addListener(fe),s.Z.windows.onRemoved.addListener(ye),v.Z.requestNamedMenu(se.getName())}}};var be=n(39045),Se=n(58537),Ie=n(3184),ke=n(2431),Ae=n(46382);const Te=new Map;let Ze=0;function Ee(e,t){return new Promise(((n,s)=>{const i=Ze++;Te.set(i,{resolve:n,reject:s});const o={promiseId:i,func:e,args:t};navigator.serviceWorker?.ready.then((e=>e.active?.postMessage({pop:o})))}))}function _e(e){if(e.origin!==h.oP)return;const{pop:t}=e.data;if(!t)return;const{promiseId:n,results:s,error:i}=t,o=Te.get(n);if(!o)return void console.error("PopActions: Missing promise ",n);const{resolve:a,reject:r}=o;Te.delete(n),i?r(new Error(i)):a(s)}const Me=new class{constructor(){navigator.serviceWorker?.addEventListener("message",_e,!1)}checkForMail(e){return Ee("checkForMail",[e])}deletePopMail(e,t){return Ee("deletePopMail",[e,t])}getPopMessage(e,t,n){return Ee("getPopMessage",[e,t,n])}setCheckInterval(e,t){return Ee("setCheckInterval",[e,t])}verifyPopLogin(e){return Ee("verifyPopLogin",[e])}};var Ne=n(68247),Pe=n(82227),De=n(71320),xe=n(5863),Oe=n(56371),Le=n(95095),Re=n(48868),Be=n(51501),Fe=n(21285),Ve=n(61839);async function We(e,t){const{addedSles:n,forSearchDb:s}=await(0,Fe.Z)(xe.u4,e,xe.Oi,t);return(0,Ve.Z)(s),n}const Ue=async function(e){return await Re.Z.deletedFeedItems.where("path").equals(e).toArray()};const He=async function(e){return await Re.Z.searchList.where("messageId").anyOf(e).toArray()};var ze=n(24651),Ge=n(5204),$e=n(40382),Ke=n(8684),je=n(44850),Ye=n(34155);async function Xe(e,t){if(!await Pe.Z.get(xe.u4,t)){const n={name:e,accountId:xe.u4,path:t,filterValue:{include:[[{accountId:xe.u4},{path:t}]],...Be.Z.getSearchListButtons(xe.u4)}};await l.Z.addFilter(n,!1)}}function Qe(e,t){const n=t.length,s=Le.Z.adjustBatchSize.bind(void 0,10,100,500);let i,o=10,a=0;return new Promise(((r,d)=>{Ye.nextTick((function d(){const p=t.slice(a,a+o);a+=o,a>n&&(a=n);const u=Date.now();if(0===p.length)return void r(i);return async function(e,t){const n=t.map((e=>e.messageId)),s=new Set(t.map((e=>e.subject)));let i=[],o=[];await Re.Z.transaction("rw",Fe.E.concat([Re.Z.deletedFeedItems]),(async()=>{let a=await He(n);a=a.filter((e=>s.has(e.subject)));const r=await Ue(e),l=new Set;for(const e of a)l.add(e.messageId);for(const e of r)l.add(e.messageId);o=t.filter((e=>!l.has(e.messageId))),0!==o.length&&(i=await We(e,o))})),l.Z.updateIndex({addedSles:i});for(const e of o){const t=i.find((t=>t.messageId===e.messageId&&t.subject===e.subject));if(!t)throw new Error(`searchListEntry and message for rss out of sync. Subject: ${e.subject}`);await(0,$e.Z)(xe.u4,e.sentDate,t.id,e.raw),await ze.Z.setHasRaw(xe.u4,t.id)}return i[0]}(e,p).then((t=>{t&&!i?i=t:t&&c.Z.setStatus(h.A4,(0,Oe.Z)("Loading feed $1: $2/$3",[e,a,n]));const r=Date.now();o=s(o,r-u)})).then((()=>Ye.nextTick(d)))}))}))}const qe=new class{async add(e){H.Z.get($.kMailIsTurnedOff)&&Ne.Z.set($.kMailIsTurnedOff,!1);const t=H.Z.get($.kRssSettings),n=e.filter((e=>!t.some((t=>t.url===e.url))));if(n.length){if(n.some((e=>!e.path)))throw new Error("RssSettingsActions.add: Expected GUID path");Ne.Z.set($.kRssSettings,[...t,...n]);for(const e of n)await Xe(e.title||e.url,e.path),gn.poll([e],!0)}}async removeAllFeeds(){const e=H.Z.get($.kRssSettings);try{for(const t of e)await l.Z.removeAccountPath(xe.u4,t.path,"RSS");Ne.Z.set($.kRssSettings,[])}catch(e){console.error(e)}}removeFeed(e){const t=H.Z.get($.kRssSettings);try{l.Z.removeAccountPath(xe.u4,e,"RSS");const n=t.findIndex((t=>t.path===e));if(-1===n)throw`RssSettingsActions.removeFeed: path ${e} not found in prefs`;{const e=[...t];e.splice(n,1),Ne.Z.set($.kRssSettings,e)}}catch(e){console.error(e)}}async edit(e,t){const n=H.Z.get($.kRssSettings).slice(),s=n[t];if(s.title!==e.title){const t=await Pe.Z.setFilterName(xe.u4,s.path,e.title);De.Z.updateFilters(t)}n[t]=e,Ne.Z.set($.kRssSettings,n)}};function Je(e,t,n){for(const s of[e,t,n]){const e=s.filter(((e,t,n)=>e.email&&t===n.findIndex((t=>t.email===e.email))));if(e.length>0)return e.map((e=>({name:e.name?e.name:e.email,address:e.email})))}return[]}var et=n(45660),tt=n(77150),nt=n.n(tt),st=n(4111);function it(e){let t=new Date(e);return ot(t)||(t=at(e)),t}const ot=e=>e instanceof Date&&!isNaN(e),at=(e="")=>new Date(e.trim().replace(/\b[a-z]+$/i,(e=>st.Z[e.toUpperCase()]||"+0000"))),rt=new Map,lt=/\b(?:https?:\/\/|ftp:\/\/|www\.)\S+/gi;function dt(e,t,n){let s="";for(;e.endsWith(".")||e.endsWith(":");)s=e[e.length-1]+s,e=e.substr(0,e.length-1);"&lt;"===n.substr(t-4,4)&&e.endsWith("&gt;")?(s="&gt;"+s,e=e.substr(0,e.length-4)):[["(",")"],["[","]"]].forEach((([i,o])=>{n[t-1]===i&&e.endsWith(o)&&(s=o+s,e=e.substr(0,e.length-1))}));const i=`<a href="${e.startsWith("www.")?"http://"+e:e}" target="_blank">${e}</a>${s}`;return rt.set(t,i.length-s.length),i}let ct=0,ht=0;const pt=/\n((?:&gt;\ ?)*)([^\n]*)/g;function ut(e,t,n,s,i){let o=0,a=0;for(;;){const e=t.indexOf(";",a);if(-1===e)break;a=e+1,o++}const r=Math.min(o,ct+1);let l=`\n${n}`;if(r>ct)ht++,l=`\n<blockquote class="indent-${r} blockquote">${n}`;else if(r<ct){const e=ct-r;ht-=e;l=`\n${"</blockquote>".repeat(e)}${n}`}return ct=r,l}function gt(e,t,n){for(const[n,s]of rt)if(n<=t&&t+e.length<=n+s)return e;return`<a href="mailto:${e}">${e}</a>`}function mt(e){let t=e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(lt,dt).replace(/[A-Z0-9\-\_\.]+@(?:[A-Z\_-]+\.)+[A-Z]+/gi,gt).replace(pt,ut);return rt.clear(),ct=0,ht>0&&(t+="</blockquote>".repeat(ht),ht=0),t}function vt(e){const t=function(e){return`https://www.youtube-nocookie.com/embed/${e}?rel=0`}(e);return`<iframe src="${t}" frameborder="0" allowfullscreen></iframe>`}var ft=n(78614);function yt(e,t){const n=e[t];return"string"==typeof n?n:""}function Ct(e,t){if(/^\s*#/.test(e))return e;try{return new URL(e,t).href}catch(t){return e}}function wt(e){try{return new URL(e),!0}catch(e){return!1}}function bt(e,t){const n=[...e.attributes].find((e=>e.nodeName.toLowerCase()===t));return n?n.nodeName:""}const St=/^\s*(https?|ftp|file):/i;function It(e,t){if(!(t&&St.test(t)&&wt(t)&&/<[a-z][\w\-:]*[\s\/][^>]*=|<style\b/i.test(e)))return e;const n=(new DOMParser).parseFromString(e,"text/html"),s=n.documentElement,i=n.head,o=n.body;if(!(n&&s instanceof Element&&i instanceof Element&&o instanceof Element))return e;const a=/<html\b/i.test(e),r=/<head\b/i.test(e),l=/<(body|frameset)\b/i.test(e),d=s.attributes.length,c=i.attributes.length,h=o.attributes.length,p=i.childNodes.length,u=o.childNodes.length;let g;if(r||c||p||!i.parentNode||i.parentNode.removeChild(i),l||h||u||!o.parentNode||o.parentNode.removeChild(o),a||d)g=n.createElement("div"),g.appendChild(s);else{if(!s.children.length)return e;g=l||h||r||c||p&&u?s:p?i:o}return kt(g,t).innerHTML}function kt(e,t){if(!t||!St.test(t)||!wt(t))return e;const n=document.implementation.createDocument("http://www.w3.org/1999/xhtml","html",null),s=[...e.getElementsByTagName("base")].filter((e=>bt(e,"href")));if(s.length){const e=s[0].getAttribute(bt(s[0],"href"));if(e&&St.test(e)&&wt(e))t=e;else if(e&&!/^\s*[a-z0-9\-\+\.]+:/i.test(e)){const n=Ct(e,t);!St.test(n)&&wt(n)||(t=n)}s.forEach((e=>{e.parentNode&&e.parentNode.removeChild(e)}))}const i=n.documentElement;if(!i)return e;const o=n.createElement("base");o instanceof HTMLBaseElement&&(o.href=t,i.appendChild(o));const a=n.importNode(e,!0);i&&i.appendChild(a);const r=[{attr:"action",prop:"action",check:"",pattern:null,replacer:null},{attr:"archive",prop:"",check:"archive",pattern:/([^\s]+)/g,replacer:function(e,n){return Ct(n,t)}},{attr:"background",prop:"",check:"background",pattern:null,replacer:null},{attr:"cite",prop:"cite",check:"",pattern:null,replacer:null},{attr:"data",prop:"data",check:"",pattern:null,replacer:null},{attr:"formaction",prop:"formAction",check:"",pattern:null,replacer:null},{attr:"longdesc",prop:"longDesc",check:"",pattern:null,replacer:null},{attr:"href",prop:"href",check:"",pattern:null,replacer:null},{attr:"poster",prop:"poster",check:"",pattern:null,replacer:null},{attr:"src",prop:"src",check:"",pattern:null,replacer:null},{attr:"srcset",prop:"",check:"srcset",pattern:/([^,\s]+)(\s+[^,\s]+)/g,replacer:function(e,n,s){return Ct(n,t)+s}},{attr:"xml:link",prop:"",check:"",pattern:null,replacer:null}],l=a.getElementsByTagName("*");for(let e=0;e<l.length;e++){const s=l[e];let o;try{o=n.createElement(s.localName.toLowerCase())}catch(e){o=n.createElement(s.localName.toLowerCase().replace(/[^\w:\-].*$/,""))}i.appendChild(o);for(const{attr:e,prop:n,check:i,pattern:a,replacer:l}of r){const r=bt(s,e);if(r){const d=s.getAttribute(r)||"";if(o.setAttribute(e,d),a&&l){if(i&&yt(o,i)||!i){const e=d.replace(a,l);d!==e&&s.setAttribute(r,e)}}else if(n){const e=yt(o,n);e&&(d===e||/^\s*#/.test(d)||s.setAttribute(r,e))}else if(i&&yt(o,i)||!i){const e=Ct(d,t);d!==e&&s.setAttribute(r,e)}}}const a=function(e,n){return'url("'+Ct(n,t)+'")'},d=/\burl\("([^"]+)"\)/g,c=bt(s,"style");if(c){o.setAttribute("style",s.getAttribute(c)||"");const e=o.style.cssText;if(e){const t=e.replace(d,a);e!==t&&s.setAttribute(c,t)}}if(o instanceof HTMLStyleElement&&s.textContent.length&&o.sheet instanceof CSSStyleSheet){o.textContent=s.textContent;const e=[...o.sheet.cssRules].map((e=>e.cssText)).join("\n"),t=e.replace(d,a);e!==t&&(s.textContent=t)}i.removeChild(o)}return e.ownerDocument.adoptNode(a)}class At{category=[];cloud=[];people=new Nt;feeditems=[];generator=null;haserrors=!1;htmlrights="";htmldescription="";htmltitle="";icon=null;id="";image=null;language="";lastbuilddate="";links=new Et;plaintitle="";pubdate="";publishdate="";rating="";skipdays=new Lt;skiphours={};textinput=[];ttl="";updated="";updatedate="";updatefrequency="";updateperiod=""}class Tt{category=[];people=new Nt;htmlbody="";htmlcontent="";htmldescription="";htmlrights="";htmlsummary="";htmltitle="";id="";links=new Et;plaintitle="";pubdate="";publishdate="";published="";source=null;updated="";updatedate="";xmloriginal=""}class Zt{description="";height="";link="";title="";url="";width=""}class Et{alternate=[];comments=[];docs=[];enclosure=[];next=[];prev=[];related=[];self=[];serviceedit=[];servicepost=[];via=[]}class _t{hreflang="";bytelength="";mimetype="";title="";url=""}class Mt{label="";scheme="";term=""}class Nt{author=[];contributor=[];managingeditor=[];webmaster=[]}class Pt{email="";name="";url=""}class Dt{name="";url="";version=""}class xt{domain="";path="";port="";protocol="";registerprocedure=""}class Ot{htmldescription="";link="";name="";title=""}class Lt{sunday=!1;monday=!1;tuesday=!1;wednesday=!1;thursday=!1;friday=!1;saturday=!1}class Rt{htmltitle="";items=[];ownername="";owneremail="";ownerurl="";plaintitle="";publishdate="";updatedate=""}class Bt{category="";created="";feedurl="";htmldescription="";htmltitle="";items=[];language="";pageurl="";plaintitle="";supported=!0}const Ft="http://www.w3.org/1999/xhtml";function Vt(e){return(e||"").replace(/^\s+|\s+$/g,"")}function Wt(e){return(e||"").replace(/^\s*[\r\n]|\s+$/g,"")}function Ut(e){return document.createElementNS(Ft,"div").appendChild(document.createTextNode(e)).parentElement?.innerHTML??""}function Ht(e){const t=document.implementation.createHTMLDocument().createElementNS(Ft,"div");return t.innerHTML=e,Vt(t.textContent)}function zt(e,t,n){return/&(#\d+|#x[0-9a-e]+|[a-z][0-9a-z]*);|<[a-z][a-z0-9\-]*\b[^>]*>/i.test(e)?It(Vt(e),Qt("",t,n)):mt(Ut(Wt(e)))}function Gt(e){return e.toLowerCase()}function $t(e,t){return Vt(e||t).toLowerCase()}function Kt(e){let t="";for(let n=0;n<e.childNodes.length;n++)e.childNodes[n].nodeType!==Node.TEXT_NODE&&e.childNodes[n].nodeType!==Node.CDATA_SECTION_NODE||(t+=e.childNodes[n].nodeValue);return t}function jt(e,t,n){for(let s=t.length-1;s>=0;s--)if(t[s]){if(e.hasAttributeNS(t[s],n))return e.getAttributeNS(t[s],n);if(e.namespaceURI===t[s]&&(!s||e.hasAttributeNS("",n)))return e.getAttributeNS("",n);if(!s)return null}else{if(!s&&e.namespaceURI)return null;if(!s||!e.namespaceURI&&e.hasAttributeNS("",n))return e.getAttributeNS("",n)}}function Yt(e,t,n){for(let s=t.length-1;s>=0;s--)if(t[s]){if(e.hasAttributeNS(t[s],n))return!0;if(e.namespaceURI===t[s]&&(!s||e.hasAttributeNS("",n)))return!!s||e.hasAttributeNS("",n);if(!s)return!1}else{if(!s&&e.namespaceURI)return!1;if(!s||!e.namespaceURI&&e.hasAttributeNS("",n))return Boolean(s||e.getAttributeNS("",n))}return!1}function Xt(e){try{return new URL(e),!0}catch(e){return!1}}function Qt(e,t,n){const s=/^[a-z0-9\-\+\.]+:/i;if(s.test(e))return e;const i=/^(https?|ftp|file):/i,o=[e];let a,r=!1;for(;!r&&t?.nodeType===Node.ELEMENT_NODE;){if(t?.hasAttribute("xml:base")&&(a=Vt(t?.getAttribute("xml:base")),a.length)){const e=a.match(s);r=i.test(a)&&Xt(a),e&&!r||(o[o.length]=a)}t=t?.parentElement}if(!r){if(!i.test(n)||!Xt(n))return e;o[o.length]=n}for(n=o.pop();void 0!==(a=o.pop());)try{n=new URL(a,n).href}catch(t){return e}return n||(n=e),n}const qt=new RegExp("^[\\p{Ps}\\p{Pi}\"'<]+|[\\p{Pe}\\p{Pf}\"'>]+$","ug");function Jt(e){return en((new DOMParser).parseFromString(e,"application/xml"),e,"")}function en(e,t,n){let s=e,i=s?.documentElement;const o="http://www.w3.org/2005/Atom",a="http://www.w3.org/1999/02/22-rdf-syntax-ns#",r="http://purl.org/rss/1.0/",l="http://channel.netscape.com/rdf/simple/0.9/",d="http://purl.org/dc/elements/1.1/";function c(e,t=!1){let n="";const s=new XMLSerializer;e=e.cloneNode(!0);const i=document.createTreeWalker(e,NodeFilter.SHOW_CDATA_SECTION);for(;i.nextNode();)i.currentNode.parentNode?.replaceChild(i.currentNode.ownerDocument.createTextNode(i.currentNode.nodeValue),i.currentNode);if(t)for(let t=0;t<e.childNodes.length;t++)n+=s.serializeToString(e.childNodes[t]);else n=s.serializeToString(e).replace(/^<[^>]+>|<[^>]+>$/g,"");return n}function h(e,t,n){if(1===t.length)return e.getElementsByTagNameNS(t[0],n);const s=e.getElementsByTagName("*"),i=[];for(let e=0;e<s.length;e++)s[e].localName===n&&-1!==t.indexOf(s[e].namespaceURI)&&(i[i.length]=s[e]);return i}function p(e,t){const s=$t(jt(e,_,"type"),"");if(e.children.length){if(e.children.length>1||e.children[0]!==(e.getElementsByTagNameNS(Ft,"div")[0]||e.getElementsByTagNameNS(e.namespaceURI??null,"div")[0])||function(e){for(let t=0;t<e.childNodes.length;t++)if(e.childNodes[t].nodeType===Node.TEXT_NODE&&e.childNodes[t].nodeValue.replace(/^\s+|\s+$/g,"")||e.childNodes[t].nodeType===Node.CDATA_SECTION_NODE)return!0;return!1}(e)){return c(kt(e,Qt("",e,n)))}return c(kt(e.children[0],Qt("",e.children[0],n)),e.children[0].namespaceURI===Ft)}if("html"===s||"text/html"===s||"xhtml"===s||/^application\/.*\+xml$/.test(s))return It(Vt(Kt(e)),Qt("",e,n));if(s&&"text"!==s&&!/^text\/plain$/.test(s)&&/^[\-\w]+\/[\-\w\+]+$/.test(s)){if(t){const n=new _t;n.url="data:"+s+";base64,"+Vt(Kt(e)).replace(/\s+/g,""),n.mimetype=s,m(n,t)}return""}return mt(Ut(Wt(Kt(e))))}function u(e){if(e.children.length){return c(kt(e,Qt("",e,n)))}return zt(Kt(e),e,n)}function g(e){const t=new Zt;if(e.children.length){for(let s,i,o=0;o<e.children.length;o++)if(s=e.children[o],i=Gt(s.localName),-1!==_.indexOf(s.namespaceURI))switch(i){case"url":{const e=Vt(Kt(s));e&&(t.url=Qt(e,s,n))}break;case"link":case"feedlink":{const e=Vt(Kt(s));e&&(t.link=Qt(e,s,n))}break;case"title":case"feedtitle":t.title=Vt(Kt(s));break;case"description":t.description=Vt(Kt(s));break;case"width":t.width=Vt(Kt(s));break;case"height":t.height=Vt(Kt(s))}}else{const s=Vt(Kt(e));s&&(t.url=Qt(s,e,n))}return t}function m(e,t){const n=t.find((t=>t.url===e.url&&t.title===e.title&&t.hreflang===e.hreflang));n?(!n.mimetype&&e.mimetype&&(n.mimetype=e.mimetype),!n.bytelength&&e.bytelength&&(n.bytelength=e.bytelength)):t[t.length]=e}function v(e,t){let s,i;if("enclosure"===e.localName||"comments"===e.localName||"docs"===e.localName?s=e.localName:"source"===e.localName||"feedsource"===e.localName?s="via":"relation"===e.localName?s="related":(s=$t(jt(e,_,"rel"),"alternate"),s=s.replace(/\W/g,"")),"source"!==e.localName&&"feedsource"!==e.localName&&e.childNodes.length?i=Vt(Kt(e)):Yt(e,_,"href")?i=Vt(jt(e,_,"href")):Yt(e,_,"url")?i=Vt(jt(e,_,"url")):e.namespaceURI===d&&(i=Vt(Kt(e))),i&&s&&t.links.hasOwnProperty(s)){const o=new _t;switch(o.url=Qt(i,e,n),"source"===e.localName||"feedsource"===e.localName?o.title=Vt(Kt(e)):o.title=Vt(jt(e,_,"title")),o.mimetype=Vt(jt(e,_,"type")),o.hreflang=Vt(jt(e,_,"hreflang")),o.bytelength=Vt(jt(e,_,"length")),s){case"alternate":m(o,t.links.alternate);break;case"comments":m(o,t.links.comments);break;case"docs":m(o,t.links.docs);break;case"enclosure":m(o,t.links.enclosure);break;case"next":m(o,t.links.next);break;case"prev":m(o,t.links.prev);break;case"related":m(o,t.links.related);break;case"self":m(o,t.links.self);break;case"serviceedit":m(o,t.links.serviceedit);break;case"servicepost":m(o,t.links.servicepost);break;case"via":m(o,t.links.via)}}}function f(e){const t=new Mt,n=Vt(Kt(e));return n.length?(t.label=t.term=n,t.scheme=Vt(jt(e,_,"domain"))):(t.term=Vt(jt(e,_,"term")),t.label=Vt(jt(e,_,"label")||t.term),t.scheme=Vt(jt(e,_,"scheme"))),t}function y(e){const t=new Dt;t.name=Vt(Kt(e));const s=Vt(jt(e,_,"uri"));return s&&(t.url=Qt(s,e,n)),t.version=Vt(jt(e,_,"version")),t}function C(e){let t;if(e.children.length){t=new Pt;for(let s,i,o=0;o<e.children.length;o++)if(s=e.children[o],i=Gt(s.localName),-1!==_.indexOf(s.namespaceURI)){if("name"===i)t.name=Vt(Kt(s));else if("email"===i)t.email=Vt(Kt(s));else if("uri"===i){const e=Vt(Kt(s));e&&(t.url=Qt(e,s,n))}}else if("http://xmlns.com/foaf/0.1"===s.namespaceURI)if("name"===i)t.name=Vt(Kt(s));else if("homepage"===i){const e=Vt(s.getAttributeNS(a,"resource"));e&&(t.url=Qt(e,s,n))}else"mbox"===i&&(t.email=Vt(s.getAttributeNS(a,"resource")).replace(/^[a-z]+:/i,""))}else{const n=Vt(Kt(e));(0,ft.HZ)(n)?(t=new Pt,t.email=n):t=w(null,n)}return t}function w(e,t=""){const n=new Pt,s=e?Kt(e):t;n.name=Vt(s.replace(/[\s<(]*(mailto\s*:\s*)?[^\s<>():,@]+@[^\s<>():,@]+[\s>)]*/i," ")).replace(qt,"");const i=s.match(/[^\s<>():,@]+@[^\s<>():,@]+/);return i&&(n.email=i[0].replace(/^"([^\"]*)"$/,"$1")),n}function b(e){const t=new xt;return t.domain=Vt(jt(e,_,"domain")),t.port=Vt(jt(e,_,"port")),t.path=Vt(jt(e,_,"path")),t.registerprocedure=Vt(jt(e,_,"registerProcedure"))||Vt(jt(e,_,"registerprocedure")),t.protocol=Vt(jt(e,_,"protocol")),t}function S(e){const t=new Ot;for(let s,i,o=0;o<e.children.length;o++)if(s=e.children[o],i=Gt(s.localName),-1!==_.indexOf(s.namespaceURI))if("description"===i)t.htmldescription=u(s);else if("title"===i||"feedtitle"===i)t.title=Vt(Kt(s));else if("name"===i)t.name=Vt(Kt(s));else if("link"===i||"feedlink"===i){const e=Vt(Kt(s));e&&(t.link=Qt(e,s,n))}return t}function I(e,t){for(let n=0;n<e.children.length;n++){const s=e.children[n];if(-1!==_.indexOf(s.namespaceURI)&&"day"===Gt(s.localName)){const e=Vt(Kt(s)).toLowerCase();if(t.hasOwnProperty(e))switch(e){case"sunday":t.sunday=!0;break;case"monday":t.monday=!0;break;case"tuesday":t.tuesday=!0;break;case"wednesday":t.wednesday=!0;break;case"thursday":t.thursday=!0;break;case"friday":t.friday=!0;break;case"saturday":t.saturday=!0}}}}function k(e,t){for(let n=0;n<e.children.length;n++){const s=e.children[n];if(-1!==_.indexOf(s.namespaceURI)&&"hour"===Gt(s.localName)){const e=Vt(Kt(s)).toLowerCase();/^\d+$/.test(e)&&1*Number(e).valueOf()<24&&1*Number(e).valueOf()>=0&&(t[e]=!0)}}}function A(e){const t=new XMLSerializer;let o=t.serializeToString(e);const a=/^([^>]+)\sxmlns="http:\/\/www.w3.org\/1999\/xhtml"/;if(Z&&(o=o.replace(/<(\/?)feed(source|link|image|title)\b/g,"<$1$2"),o=o.replace(a,"$1")),!M.contains(e)){let e=t.serializeToString(M.cloneNode(!1));Z&&(e=e.replace(a,"$1")),o=`${e}${o}`}for(;e&&e.parentElement&&e.parentNode!==s;){const s=(e=e.parentElement)?.cloneNode(!1),r=Qt("",e,n);s.setAttribute("xml:base",r),Z&&e!==M&&e!==i&&e.hasAttribute("xmlns")&&s.removeAttribute("xmlns");let l=t.serializeToString(s);l=l.replace(/^<([\w\-:]+)\b([^>]*)\/>$/,"<$1$2></$1>"),Z&&(l=l.replace(a,"$1")),l=l.split("></"),o=l[0]+">"+o+"</"+l[1]}return o}function T(e){const t=new At;for(let n,s,i=0;i<e.children.length;i++)if(n=e.children[i],s=Gt(n.localName),-1!==_.indexOf(n.namespaceURI))"id"===s?t.id=Vt(Kt(n)):"image"===s||"feedimage"===s?n.children.length&&(t.image=g(n)):"logo"===s?t.image=g(n):"icon"===s?t.icon=g(n):"generator"===s?t.generator=y(n):"title"===s||"feedtitle"===s?("channel"===e.localName?t.htmltitle=u(n):t.htmltitle=p(n),t.plaintitle=Ht(t.htmltitle)):"rights"===s?t.htmlrights=p(n):"subtitle"===s?t.htmldescription=p(n):"copyright"===s?t.htmlrights=u(n):"description"===s?t.htmldescription=u(n):"updated"===s?t.updated=Vt(Kt(n)):"lastbuilddate"===s?t.lastbuilddate=Vt(Kt(n)):"pubdate"===s?t.pubdate=Vt(Kt(n)):"rating"===s?t.rating=Vt(Kt(n)):"language"===s?t.language=Vt(Kt(n)):"ttl"===s?t.ttl=Vt(Kt(n)):"category"===s?t.category[t.category.length]=f(n):"link"===s||"feedlink"===s||"docs"===s?v(n,t):"cloud"===s?t.cloud[t.cloud.length]=b(n):"author"===s?t.people.author[t.people.author.length]=C(n):"contributor"===s?t.people.contributor[t.people.contributor.length]=C(n):"managingeditor"===s?t.people.managingeditor[t.people.managingeditor.length]=C(n):"webmaster"===s?t.people.webmaster[t.people.webmaster.length]=C(n):"textinput"===s?n.children.length&&(t.textinput[t.textinput.length]=S(n)):"skipdays"===s?I(n,t.skipdays):"skiphours"===s&&k(n,t.skiphours);else if("http://purl.org/rss/1.0/modules/syndication/"===n.namespaceURI)if("updateperiod"===s){const e=Vt(Kt(n)).toLowerCase();t.updateperiod=e}else"updatefrequency"===s&&(t.updatefrequency=Vt(Kt(n)).toLowerCase());else n.namespaceURI===d&&("title"===s?(t.htmltitle=u(n),t.plaintitle=Ht(t.htmltitle)):"description"===s?t.htmldescription=u(n):"date"===s?t.pubdate=Vt(Kt(n)):"language"===s?t.language=Vt(Kt(n)):"rights"===s?t.htmlrights=u(n):"subject"===s?t.category[t.category.length]=f(n):"source"===s||"relation"===s?v(n,t):"publisher"===s?t.people.managingeditor[t.people.managingeditor.length]=w(n):"creator"===s?t.people.author[t.people.author.length]=w(n):"contributor"===s&&(t.people.contributor[t.people.contributor.length]=w(n)));if(!t.language){const n=Gt(e.localName);"source"===n||"feedsource"===n?e.hasAttribute("xml:lang")&&(t.language=Vt(e.getAttribute("xml:lang"))):i?.hasAttribute("xml:lang")&&(t.language=Vt(i?.getAttribute("xml:lang")))}if(t.publishdate=t.pubdate||t.updated||t.lastbuilddate,t.updatedate=t.lastbuilddate||t.updated||t.pubdate,"number"==typeof t.ttl||"string"==typeof t.ttl&&/^\d+$/.test(t.ttl))t.ttl=parseInt(t.ttl)||"";else if(t.updateperiod||t.updatefrequency){let e;e=/^\d+$/.test(t.updatefrequency)&&parseInt(t.updatefrequency)||1;const n={hourly:60,daily:1440,weekly:10080,monthly:306600,yearly:3679200};if(n.hasOwnProperty(t.updateperiod)){let s;switch(t.updateperiod){case"hourly":s=n.hourly;break;case"daily":s=n.daily;break;case"weekly":s=n.weekly;break;case"monthly":s=n.monthly;break;case"yearly":s=n.yearly;break;default:s=0}t.ttl=Math.round(s/e)}else t.ttl=Math.round(n.daily/e)}else t.ttl="";return t}let Z=!1,E="";if(!s||s.getElementsByTagNameNS(Ft,"parsererror").length){if(t&&/^\w*</.test(t)&&(t.match(/<[\w\-:]+[^>]*>/g)||[]).length>3&&(t.match(/<\/[\w\-:]+>/g)||[]).length>3){for(;/<(source|link|image|title)\b(([^\/>]|\/[^>])*>[^<]*((?!<\1\b([^\/>]|\/[^>])*>)<[^<]*)*?)<\/\1>/i.test(t);)t=t.replace(/<(source|link|image|title)\b(([^\/>]|\/[^>])*>[^<]*((?!<\1\b([^\/>]|\/[^>])*>)<[^<]*)*?)<\/\1>/gi,"<feed$1$2</feed$1>");const e=(t=t.replace(/<(\w+:link|\w+:category|category|\w+:cloud|cloud|\w+:enclosure|enclosure|\w+:thumbnail|thumbnail)\b([^>]*)\/>/gi,"<$1$2></$1>")).substring(0,1024).match(/\bxmlns:(\w+)\s*=\s*['"]http:\/\/purl\.org\/rss\/1.0\/modules\/content\/['"]/);e&&(E=e[1]+":encoded"),t=t.replace(/<!\[CDATA\[([\w\W]*?)\]\]>/gi,((e,t)=>Ut(t))),t="<!doctype html><html><head><title></title></head><body>"+t+"</body></html>",s=(new DOMParser).parseFromString(t,"text/html"),Z=!0}if(!s||s.getElementsByTagNameNS(Ft,"parsererror").length)return"NoDocumentNode";s.body instanceof HTMLBodyElement&&(s=s.body,i=s.children[0])}if(!i)return"NoDocumentElement";const _=void 0!==i?.namespaceURI?[i.namespaceURI]:[];let M;if(_[0]||"feed"!==i.localName?_[0]===a&&(_[1]=r,_[2]=l):_[1]=o,M="feed"===i.localName?i:h(i,_,"channel")[0],!M)return"NoChannelElement";-1===_.indexOf(o)&&_.unshift(o),-1===_.indexOf(r)&&_.unshift(r),-1===_.indexOf(l)&&_.unshift(l);const N=T(M);if(N.haserrors=Z,i!==M&&i.children.length>1)for(let e,t,n=0;n<i.children.length;n++)e=i.children[n],t=Gt(e.localName),-1!==_.indexOf(e.namespaceURI)&&("image"===t||"feedimage"===t?N.image=g(e):"textinput"===t&&(N.textinput[N.textinput.length]=S(e)));let P;P="feed"===M.localName?h(s,_,"entry"):h(s,_,"item");for(let e=0;e<P.length;e++){let t=!1;N.feeditems[e]=new Tt;for(let n=0;n<P[e].children.length;n++){const s=P[e].children[n],i=Gt(s.localName);if(-1!==_.indexOf(s.namespaceURI))if("link"===i||"feedlink"===i||"enclosure"===i||"comments"===i)v(s,N.feeditems[e]);else if("title"===i||"feedtitle"===i)"item"===s.parentElement?.localName?N.feeditems[e].htmltitle=u(s):N.feeditems[e].htmltitle=p(s),N.feeditems[e].plaintitle=Ht(N.feeditems[e].htmltitle);else if("summary"===i)N.feeditems[e].htmlsummary=p(s);else if("rights"===i)N.feeditems[e].htmlrights=p(s);else if("content"===i)N.feeditems[e].htmlcontent=p(s,N.feeditems[e].links.enclosure);else if("description"===i)t?N.feeditems[e].htmlsummary=u(s):N.feeditems[e].htmldescription=u(s);else if("author"===i)N.feeditems[e].people.author[N.feeditems[e].people.author.length]=C(s);else if("contributor"===i)N.feeditems[e].people.contributor[N.feeditems[e].people.contributor.length]=C(s);else if("category"===i)N.feeditems[e].category[N.feeditems[e].category.length]=f(s);else if("id"===i||"published"===i||"created"===i||"issued"===i||"updated"===i||"modified"===i||"pubdate"===i)switch(i){case"id":N.feeditems[e].id=Vt(Kt(s));break;case"published":case"created":case"issued":N.feeditems[e].published=Vt(Kt(s));break;case"updated":case"modified":N.feeditems[e].updated=Vt(Kt(s));break;case"pubdate":N.feeditems[e].pubdate=Vt(Kt(s))}else"guid"===i?(N.feeditems[e].id=Vt(Kt(s)),"false"!==$t(jt(s,_,"isPermaLink"),"")&&"false"!==$t(jt(s,_,"ispermalink"),"")&&v(s,N.feeditems[e])):"source"===i||"feedsource"===i?"item"===s.parentElement?.localName?v(s,N.feeditems[e]):N.feeditems[e].source=T(s):i===E&&(t||N.feeditems[e].htmlsummary||(N.feeditems[e].htmlsummary=N.feeditems[e].htmldescription),t=!0,N.feeditems[e].htmldescription=Kt(s));else if(s.namespaceURI===d)"title"===i?(N.feeditems[e].htmltitle=u(s),N.feeditems[e].plaintitle=Ht(N.feeditems[e].htmltitle)):"description"===i?N.feeditems[e].htmldescription=u(s):"date"===i?N.feeditems[e].pubdate=Vt(Kt(s)):"rights"===i?N.feeditems[e].htmlrights=u(s):"subject"===i?N.feeditems[e].category[N.feeditems[e].category.length]=f(s):"identifier"===i?(N.feeditems[e].id||(N.feeditems[e].id=Vt(Kt(s))),v(s,N.feeditems[e])):"source"===i||"relation"===i?v(s,N.feeditems[e]):"publisher"===i||"creator"===i?N.feeditems[e].people.author[N.feeditems[e].people.author.length]=w(s):"contributor"===i&&(N.feeditems[e].people.contributor[N.feeditems[e].people.contributor.length]=w(s));else if("http://purl.org/rss/1.0/modules/content/"===s.namespaceURI)"encoded"===i&&(t||N.feeditems[e].htmlsummary||(N.feeditems[e].htmlsummary=N.feeditems[e].htmldescription),t=!0,N.feeditems[e].htmldescription=Kt(s));else if("http://search.yahoo.com/mrss/"===s.namespaceURI)switch(i){case"group":{const t=s.getElementsByTagName("media:description")[0]?.innerHTML;if(t){const n=mt(t);N.feeditems[e].htmldescription+=`<div class="preformatted">${n}</div>`}const n=s.getElementsByTagName("media:thumbnail")[0];if(n){const t=new Zt;t.url=n.getAttribute("url")??"",t.width=n.getAttribute("width")??"",t.height=n.getAttribute("height")??"",N.feeditems[e].links.enclosure.push(t)}break}}else if("http://www.youtube.com/xml/schemas/2015"===s.namespaceURI){if("videoid"===i)N.feeditems[e].htmldescription+=`<div class="video-wrapper">${vt(s.innerHTML)}</div>`}else if("http://www.itunes.com/dtds/podcast-1.0.dtd"===s.namespaceURI)switch(i){case"author":case"block":case"category":case"duration":case"email":case"explicit":case"keywords":case"name":case"new":case"owner":case"pubDate":case"subtitle":case"summary":case"episodetype":case"season":case"episode":case"title":break;case"image":{const t=new Zt;t.url=s.getAttribute("href")??"",N.feeditems[e].links.enclosure.push(t);break}}}N.feeditems[e].publishdate=N.feeditems[e].published||N.feeditems[e].pubdate||N.feeditems[e].updated,N.feeditems[e].updatedate=N.feeditems[e].updated||N.feeditems[e].pubdate||N.feeditems[e].published,N.feeditems[e].htmlbody=N.feeditems[e].htmlcontent||N.feeditems[e].htmldescription||N.feeditems[e].htmlsummary,n&&(N.feeditems[e].xmloriginal=A(P[e]))}return N}var tn=n(85834),nn=n(87422);const sn=/^\s*data:/i,on="x-vivaldi/feed-embeddable-media/youtube";function an(e){const{htmlbody:t,htmlrights:n,links:s}=e,i=[{type:"html",content:`<main>\n      ${t}\n    </main>\n    ${hn(s,t)}\n    ${rn(n)}`}];return[["alternate",s.alternate],["enclosure",s.enclosure],["related",s.related],["via",s.via],["comments",s.comments],["serviceedit",s.serviceedit]].forEach((([e,t])=>{let n=1;t.filter((e=>e.url.match(sn))).forEach((t=>{const s=function(e,t){let n="us-ascii",s="text/plain";if(t){const e=t.match(/;\s*charset\s*=\s*("\s*)?([^\s;"]+)/i);e&&(n=e[2]),s=t.replace(/;[\w\W]*$|\s+/g,"")||s}const i={valid:!1,protocol:"",mimeType:s,charset:n,base64:!1,data:""},o=e.match(/^\s*data:([^,]*),([\w\W]*)$/i);if(o){i.valid=!0,i.protocol="data:",i.data=o[2];const e=o[1].split(";");e.forEach(((t,n)=>{if(!n&&/^\s*[a-z]*\/[\w!#$&\-^\.\+]+\s*$/.test(t))i.mimeType=t.replace(/\s+/g,"").toLowerCase();else{let s,o;const a=t.indexOf("=");-1===a?s=t:(s=t.substring(0,a),o=t.substring(a+1).replace(/^\s+|"|\s+$/g,"")),s=s.toLowerCase().replace(/^\s+|\s+$/g,""),"charset"===s&&o?i.charset=o.toLowerCase():"base64"===s&&-1===a&&n===e.length-1&&(i.base64=!0,i.data=i.data.replace(/\s+/g,""))}}))}return i}(t.url,t.mimetype),{valid:o,mimeType:a,charset:r,base64:l}=s;let d=l?(0,tn.tV)(s.data):s.data;if(o&&d){let s=t.title.replace(/[\\\/?%*:|"<>\s]/g,"")||`${e}${n++}`;const o=s.replace(/^([^\.]*$|[\w\W]*\.)/,"").toLowerCase(),c=(0,nn.nv)(a,o);if(c!==o&&(s=`${s}.${c}`),!l)if("utf-8"===r)try{d=decodeURIComponent(d)}catch(e){d=unescape(d)}else if("us-ascii"===r||"iso-8859-1"===r)d=unescape(d);else{const e=d.length;let t=0;const n=[];for(;t<e;){const s=d.substring(t,t+1);if("%"===s&&e-t>=3){const e=d.substring(t+1,t+2),i=d.substring(t+2,t+3);isNaN(parseInt(e,16))||isNaN(parseInt(i,16))?n.push(s.charCodeAt(0)):(n.push(parseInt(`${e}${i}`,16)),t+=2)}else{const e=s.charCodeAt(0);if(e>255){(new TextEncoder).encode(s).forEach((e=>n.push(e)))}else n.push(e)}t++}try{d=new TextDecoder(r).decode(new Uint8Array(n))}catch(e){try{d=decodeURIComponent(d)}catch(e){d=unescape(d)}}}const h={type:"attachment",mimeType:a,filename:s,content:(new TextEncoder).encode(d),fileSize:d.length};i.push(h)}}))})),i}const rn=e=>e?`<footer>${e}</footer>`:"";function ln(e=""){const t=document.createElement("div");return t.textContent=e,t.innerHTML}const dn=(e,t)=>{const n=e.hreflang?` hreflang="${ln(e.hreflang)}`:"";return`<li>\n    <a href="${ln(e.url)}"${n}>\n    ${ln("string"==typeof e.title&&""!==e.title?e.title:t.length?t:e.url)}\n    </a>\n    </li>`},cn=(e,t)=>`<figure>\n    ${e}\n    ${t?`<figcaption>${ln(t)}</figcaption>`:""}\n    </figure>`;const hn=(e,t)=>{const n=[],s=e=>!e.url.match(sn),i=document.createElement("video"),o=/^(image|img)\/(jpe?g|gif|a?png|svg+xml|bmp|x-icon|webp)(\b|$)/i,a=/^[^\?#]*\.(jpe?g|gif|a?png|svg|bmp|ico|cur|webp)(\?|#|$)/i,r=e.enclosure.filter(s);let l=[];/<(img|image)\s/i.test(t)||(l=r.filter((e=>e.mimetype?e.mimetype?.match(o):e.url.match(a))));const d=r.filter((e=>{const t=e.mimetype;if(t&&/^video\//i.test(t))return i.canPlayType(t);if(H.Z.get($.kRssEmbedYoutubeAttachments)){const t=/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/gi.exec(e.url);if(t&&t[1])return e.mimetype=on,e.url=t[1],!0}return!1})),c=r.filter((e=>{const t=e.mimetype;return!(!t||!/^audio\//i.test(t))&&i.canPlayType(t)})),h=r.filter((e=>!(l.includes(e)||d.includes(e)||c.includes(e))));n.push("<nav>");const p=e.alternate.filter(s),u=function(e,t){if(!t.length)return null;if(1===t.length)return t[0];let n=t.filter((e=>e.hreflang));const s=t.filter((e=>!e.hreflang));if(!n.length)return s[0];e=e.map((e=>e.replace(/_/g,"-").toLowerCase())),n=n.map((e=>({lang:e.hreflang?.replace(/_/g,"-").toLowerCase()??"",val:e})));let i=!1;do{for(let t=0;t<e.length;t++){const s=n.find((n=>n.lang===e[t]));if(s)return s.val}i=!1,n.forEach((e=>{const t=e.lang.lastIndexOf("-");-1!==t&&(i=!0,e.lang=e.lang.substring(0,t))}))}while(i);e=e.map((e=>e.replace(/-[\w\W]*$/g,"").toLowerCase()));for(let t=0;t<e.length;t++){const s=n.find((n=>n.lang===e[t]));if(s)return s.val}return s.length?s[0]:n[0].val}(navigator.languages,p);n.push('<ul class="mainbutton">'),u&&n.push(dn(u,(0,Oe.Z)("Open article"))),n.push("</ul>"),p.length>1&&(n.push(`<h2>${(0,Oe.Z)("Main article")}</h2><ul>`),p.forEach((e=>{e!==u&&n.push(dn(e,(0,Oe.Z)("Open article")))})),n.push("</ul>")),h.length&&(n.push(`<h2>${(0,Oe.Z)("Attachments")}</h2><ul>`),h.forEach((e=>{n.push(dn(e,""))})),n.push("</ul>"));const g=e.related.filter(s);g.length&&(n.push(`<h2>${(0,Oe.Z)("Related content")}</h2><ul>`),g.forEach((e=>{n.push(dn(e,""))})),n.push("</ul>"));const m=e.via.filter(s);m.length&&(n.push(`<h2>${(0,Oe.Z)("Sources")}</h2><ul>`),m.forEach((e=>{n.push(dn(e,""))})),n.push("</ul>"));const v=e.comments.filter(s);v.length&&(n.push(`<h2>${(0,Oe.Z)("Comments")}</h2><ul>`),v.forEach((e=>{n.push(dn(e,""))})),n.push("</ul>"));const f=e.serviceedit.filter(s);return f.length&&(n.push(`<h2>${(0,Oe.Z)("Edit blog post")}</h2><ul>`),f.forEach((e=>{n.push(dn(e,""))})),n.push("</ul>")),n.push("</nav>"),(l.length||d.length||c.length)&&(d.length&&(n.push(`<section><h2>${(0,Oe.Z)("Linked videos")}</h2>`),d.forEach((e=>{e.mimetype===on?n.push(function({url:e}){return cn(vt(e))}(e)):n.push((e=>cn(`<video controls src="${ln(e.url)}"></video>`,e.title))(e))})),n.push("</section>")),c.length&&(n.push(`<section><h2>${(0,Oe.Z)("Linked audio")}</h2>`),c.forEach((e=>{n.push((e=>cn(`<audio controls src="${ln(e.url)}"></audio>`,e.title))(e))})),n.push("</section>")),l.length&&(n.push(`<section><h2>${(0,Oe.Z)("Linked images")}</h2>`),l.forEach((e=>{n.push((e=>{const t=e.title?` alt="${ln(e.title)}"`:"";return cn(`<img src="${ln(e.url)}"${t}>`,e.title)})(e))})),n.push("</section>"))),n.join("")};function pn(e,t){return e.id+(t.pubDate?e.publishdate:e.updatedate)+e.links.alternate.map((e=>e.url)).join(" | ")}function un(e,t){const n=e.url,i=e.cacheLastModified,o=e.cacheETag,a="string"==typeof i||"string"==typeof o,r=new XMLHttpRequest,l=["application/atom+xml","application/rss+xml","application/rdf+xml;q=0.8","application/xml;q=0.6","text/xml;q=0.6","text/*;q=0.4"],p=new Promise(((e,s)=>{r.overrideMimeType("text/xml"),r.open("GET",n,!0),r.setRequestHeader("Accept",l.join(", ")),t?r.setRequestHeader("Cache-Control","max-age=0"):a&&("string"==typeof i&&r.setRequestHeader("If-Modified-Since",i),"string"==typeof o&&r.setRequestHeader("If-None-Match",o)),r.onload=function(){if(r.status>=400)return;const l=isNaN(Date.parse(r.getResponseHeader("Last-Modified")))?null:r.getResponseHeader("Last-Modified"),d=r.getResponseHeader("ETag");if((!t||!a)&&(304===r.status||"string"==typeof i&&"string"==typeof l&&new Date(i)===new Date(l)||"string"==typeof d&&o===d))return e({cacheRevalidated:!0});let c=r.responseURL;/^(https?|ftp|file):/i.test(c)||(c=n);try{let{responseXML:t}=r;if(null===t){if(/^\s{0,10}<(\!doctype\ )?html/i.test(r.responseText))return s((0,Oe.Z)("Received HTML instead of the expected XML feed."));/^\s/.test(r.responseText)&&(t=(new DOMParser).parseFromString(r.responseText.trim(),"text/xml"))}const n=en(t,r.responseText,c);"string"==typeof n?s(n):e({parsedFeed:n,lastModified:l,eTag:d})}catch(e){s(e)}},r.onreadystatechange=()=>{r.status>=400&&s(r.status)},r.onerror=r.onabort=function(e){s(e)},r.send()})),u=H.Z.get($.kRssSettings);return p.then((t=>{const i=u.findIndex((t=>t.url===e.url));if(-1===i)return Promise.reject("Feed deleted");const o={...u[i]};if(t.cacheRevalidated)return o.lastChecked=(new Date).valueOf(),qe.edit(o,i),Promise.resolve();const a=t.parsedFeed,r={pubDate:!1};/^https?:\/\/(\w+\.)?youtube\.com\//i.test(n)&&(r.pubDate=!0);const l=a.plaintitle;o.title||(o.title=l);const p=a.feeditems.map((t=>({accountId:xe.u4,path:e.url,subject:t.plaintitle,bodyParts:an(t),raw:t.xmloriginal,sentDate:it(t.updatedate).getTime()||0,messageId:nt()(pn(t,r)),from:[{name:l,address:l}],replyTo:Je(t.people.author.concat(t.people.contributor),a.people.author.concat(a.people.contributor),a.people.managingeditor.concat(a.people.webmaster)),to:[],cc:[],flags:[],internal:!0})));return async function(e,t,n){const i=n.length,o=await Qe(t,n);if(!o)return;const a=()=>{const e=["message",o.id].join("/"),t=je.jk.internalUrl("mailpage",e,o.subject),n=G.ZP.getMailWindowId();d.ZP.openURL(n,t),s.Z.windows.update(n,{drawAttention:!0})};if(H.Z.get($.kRssShowNotifications)){const t=(0,Oe.Z)("$1 New Feed from $2","$1 New Feeds from $2",[i,e]);(0,Ke.c)({title:o.subject,body:t,icon:"resources/mail_notification_icon.png",onClick:a,tag:"VIVALDI_IMPORT_RSS_FEEDS"})}c.Z.setStatus(h.A4,(0,Oe.Z)("Finished loading feed $2. $1 message loaded","Finished loading feed $2. $1 messages loaded",[i,e]),xe.QM),Ge.Z.filter()}(o.title,o.path,p).then((()=>{const e=(new Date).valueOf();o.lastChecked=e,o.lastParsed=e,o.errorCount="number"==typeof o.errorCount&&o.errorCount>=5?Math.round(.8*o.errorCount):0,o.cacheLastModified=t.lastModified,o.cacheETag=t.eTag,qe.edit(o,i)}))})).catch((t=>{const s=u.findIndex((t=>t.url===e.url));if(s>-1){const e={...u[s]};e&&navigator.onLine&&(e.lastChecked=(new Date).valueOf(),e.errorCount="number"==typeof e.errorCount?e.errorCount+1:1,qe.edit(e,s))}t instanceof Error?et.Z.error("Mail",["feeds","parsing"],(0,Oe.Z)("Encountered an error when parsing feed $1",[n]),t):et.Z.warn("Mail",["feeds","loading"],(0,Oe.Z)("Failed to load feed $1",[n]),t)}))}const gn=new class{#s;async poll(e=H.Z.get($.kRssSettings),t=!1){if(!navigator.onLine)return;const n=(new Date).valueOf(),s=e.filter((e=>{if(t)return!e.offline;let{refreshInterval:s,lastChecked:i=0,offline:o,errorCount:a=0}=e;s=Math.max(s,5);const r=Math.min(60480,0===a?s:s+5*a);return!o&&n>=6e4*r+i})),i=new Document,o=i.createElement("link");o.rel="preconnect",i.appendChild(o);const a=Date.now();for(const e of s){if(!navigator.onLine)break;const n=s.indexOf(e);let i=t;if(n<s.length-2){const e=s[n+1];o.href=e.url}if(!i&&"number"==typeof e.lastParsed&&e.lastParsed>0){const t=new Date(e.lastParsed);t.setDate(t.getDate()+14)<=a&&(i=!0)}await un(e,i)}}forceRefreshAllRSSAccounts(){const e=H.Z.get($.kRssSettings);e.length>0&&this.poll(e,!0)}_onPrefsChanged=(e,t)=>{0===e.length&&t.length>0?(void 0!==this.#s&&(console.warn("RSSStartup: Did not expect an existing polling interval ID"),clearInterval(this.#s)),this.#s=setInterval((()=>this.poll()),6e4),this.poll()):e.length>0&&0===t.length&&(clearInterval(this.#s),this.#s=void 0)};start(){H.Z.addListener($.kRssSettings,this._onPrefsChanged),this._onPrefsChanged([],H.Z.get($.kRssSettings))}stop(){H.Z.removeListener($.kRssSettings,this._onPrefsChanged),clearInterval(this.#s),this.#s=void 0}};var mn=n(78347),vn=n(10671),fn=n(97823),yn=n(54773),Cn=n(95538),wn=n(13311),bn=n(51370),Sn=n(18787);function In(){const e=H.Z.get($.kMailCheckInterval);"one_minute"===e?(Ie.Z.setCheckInterval(!0,1),Me.setCheckInterval(!0,1)):"fifteen_minutes"===e?(Ie.Z.setCheckInterval(!0,15),Me.setCheckInterval(!0,15)):(Ie.Z.setCheckInterval(!1),Me.setCheckInterval(!1))}function kn(){l.Z.sortListEntries()}function An(e){l.Z.sortListEntries("threads"===e)}function Tn(e){const t=(0,bn.Z)(e);ke.Z.createDraft(t)}const Zn={async startPortalLoad(){if(s.Z.extension.inIncognitoContext)return;await async function(){const{dbVersion:e,migrationNeeded:t}=await C.Z.mailPrivate.getDBVersion();if(3!==e||!t)return;function n(e,t,n){const s=0===t?0:Math.floor(e/t*100),i=0===t?"":`${(0,q.uf)(e)} / ${(0,q.uf)(t)} - ${s}%.`;et.Z.log("Mail",["migrate search db"],`${n} ${i}`),c.Z.setPersistentStatus(h.A4,"MAIL_SEARCH_MIGRATION",`${n} ${i}`)}et.Z.log("Mail",["migrate search db"],"Starting migration"),C.Z.mailPrivate.onUpgradeProgress.addListener(n);const s=await C.Z.mailPrivate.startMigration();if(c.Z.clearPersistentStatus(h.A4,"MAIL_SEARCH_MIGRATION"),C.Z.mailPrivate.onUpgradeProgress.removeListener(n),!s){const e="migratateSearchData: Irrecoverable failure.     Please close Vivaldi, delete MailSearchDB & MailSearchDB-journal files     from your profile directory and start again. Click the Mail Status button     in Status Bar, click the cog wheel in the top right corner and select     Rebuild Mail Search Database.";throw c.Z.setStatus(h.A4,"Error migrating search data. Please check the logs in     Mail Status button for more info"),et.Z.error("Mail",["migrateMailSearch"],e),new Error(e)}}(),Se.Z.startBackgroundActions(),s.Z.runtime.onMessage.addListener((async(e,t)=>{if(e&&t.tab?.id&&e.addFeed&&e.feeds){const n=e.feeds;Ae.Z.showAddFeed(t.tab.windowId,n)}}));const e=new SharedWorker("bundle-mailreader-worker.js");async function t(){c.Z.setPersistentStatus(h.A4,"MAIL_STARTUP",(0,Oe.Z)("Mail client starting...")),H.Z.addListener($.kMailCheckInterval,In),H.Z.addListener($.kMailSearchSortField,An),H.Z.addListener($.kMailSearchSortOrder,kn),C.Z.calendar.onMailtoOpened.addListener(Tn),window.addEventListener("online",En,!1);try{c.Z.setPersistentStatus(h.A4,"MAIL_DB_OPEN",(0,Oe.Z)("Opening mail DB - This may take time if upgrades are due...")),await(navigator.serviceWorker?.ready),await Re.Z.open()}finally{c.Z.clearPersistentStatus(h.A4,"MAIL_DB_OPEN")}try{await Promise.all([be.Z.getAccountsAndFolders().then((e=>Promise.all([mn.Z.initAccounts(e.accounts),vn.Z.initFolders(e.folders)]))),Cn.Z.initMailingLists(),De.Z.initFilters(),Se.Z.start(),l.Z.initIndex(),a.Z.initialize()])}catch(e){return et.Z.error("Mail",["startup"],e),n(),void c.Z.setPersistentStatus(h.A4,"MAIL_STARTUP_FAILED",(0,Oe.Z)("Mail client startup failed. Error: $1",[e.message||e]))}finally{c.Z.clearPersistentStatus(h.A4,"MAIL_STARTUP")}gn.start();const e=E.Z.getSync("FOLDER_SELECTION");l.Z.selectFolder(e),Ge.Z.filter(),Se.Z.updateFlags(),Se.Z.updateThreads(),Se.Z.runSystemTasks(),In(),c.Z.setStatus(h.A4,(0,Oe.Z)("Mail client started"),xe.QM)}async function n(){gn.stop(),Se.Z.flushBuffer(),Ie.Z.setCheckInterval(!1),Me.setCheckInterval(!1),H.Z.removeListener($.kMailCheckInterval,In),H.Z.removeListener($.kMailSearchSortField,An),H.Z.removeListener($.kMailSearchSortOrder,kn),C.Z.calendar.onMailtoOpened.removeListener(Tn),window.removeEventListener("online",En,!1),ke.Z.closeMailPages(),await Ie.Z.disconnectIMAPClients(),mn.Z.clear(),Cn.Z.clear(),De.Z.clear(),vn.Z.clear(),yn.Z.clear(),Sn.Z.clear(),l.Z.stop(),Se.Z.stop()}async function i(e,s,i){switch(i){case $.kMailIsTurnedOff:(H.Z.get($.kMailAccounts).length>0||H.Z.get($.kRssSettings).length>0)&&(s?n():(await t(),navigator.onLine&&En()));break;case $.kMailAccounts:if(!H.Z.get($.kMailIsTurnedOff)&&0===H.Z.get($.kRssSettings).length&&(e.length>0&&0===s.length?n():0===e.length&&s.length>0&&await t(),e.length<s.length&&navigator.onLine))for(const t of s)e.every((e=>e.MAIL_EMAIL!==t.MAIL_EMAIL))&&await _n(t);e.length>0&&0===s.length?Ne.Z.set($.kMailMailtoInVivaldi,!1):0===e.length&&s.length>0&&Ne.Z.set($.kMailMailtoInVivaldi,!0);break;case $.kRssSettings:H.Z.get($.kMailIsTurnedOff)||0!==H.Z.get($.kMailAccounts).length||(e.length>0&&0===s.length?n():0===e.length&&s.length>0&&await t())}}return e.onerror=console.error,navigator.serviceWorker?.ready.then((t=>{t.active?.postMessage({setupMailreaderOnBackground:!0},[e.port])})),H.Z.addListener([$.kMailIsTurnedOff,$.kMailAccounts,$.kRssSettings],i),H.Z.get($.kMailIsTurnedOff)?void 0:i(!0,!1,$.kMailIsTurnedOff)}};async function En(){et.Z.info("Mail",["startup"],"onOnline event fired");const e=G.ZP.getMailWindowId();e!==h.Ex&&wn.Z.sendAll(e,!1),await Promise.all([Ie.Z.connectIMAPClients(),Me.checkForMail()]),Se.Z.flushBuffer()}async function _n(e){if(et.Z.info("Mail",["startup"],"Adding new account fired"),e.accountType===xe.s9.IMAP){const t=await fn.Z.loadAccount(e.MAIL_EMAIL);Ie.Z.connectIMAPClient(t)}else e.accountType===xe.s9.POP&&Me.checkForMail(e.MAIL_EMAIL)}const Mn=Zn;var Nn=n(21838),Pn=n(18350),Dn=n(14481),xn=n(98974);let On=!1;const Ln="#000000";let Rn,Bn=Ln,Fn=Ln;const Vn={_onPrefsCacheChanged:function(e,t,n){n===$.kRazerChromaEnabled&&!0===t&&Vn.init()},isInitialized:function(){return On},setInitCallback:function(e){Rn=e},onChromaReady:function(){On||(On=!0,Fn!==Ln&&(Vn.setColor(Fn),Fn=Ln),Rn&&Rn(),C.Z.utilities.onRazerChromaReady.removeListener(this.onChromaReady),z.Z.addListener(this.onColorUpdated),G.ZP.addListener(this.onColorUpdated))},init:function(){On=!1,H.Z.addListener([$.kRazerChromaEnabled],this._onPrefsCacheChanged),C.Z.utilities.onRazerChromaReady.addListener(this.onChromaReady),C.Z.utilities.isRazerChromaReady((e=>{e&&this.onChromaReady()}))},onColorUpdated:function(){const e=G.ZP.getLastActiveBrowserWindowId(),t=z.Z.getState().windowStyles.get(e)?.["--colorAccentBg"];"string"==typeof t&&Vn.setColor(t)},setColor:function(e){if(!On)return void(Fn=e);if(Bn===e)return;Bn=e;let t=B()(e);const[,,n]=t.hsl();n<.1&&(t=t.brighten(1));const s=[],i=B().bezier([Bn,t.toString()]);for(let e=1;e<11;e++){const[t,n,o]=i(e/10).rgb();s.push({red:t,green:n,blue:o})}C.Z.utilities.setRazerChromaColor(s,(e=>{e||console.warn("Error setting Razer Chroma color")}))}},Wn=Vn;var Un=n(92413),Hn=n(54614);const zn=new class{resetRssFeeds(e){y.Z.dispatch({actionType:"RSS_CLEAR_FEEDS",tabId:e})}initPortalDocument(){s.Z.runtime.onMessage.addListener(((t,n,i)=>{if(!t||!n.tab?.id)return;const o=n.tab.id;if("remove_this_preview"===t.command)s.Z.tabs.sendMessage(o,{command:"remove_preview"});else if("get_tab_url"===t.command)i(n.tab.url);else if("get_content_type"===t.command){i(e.get(o)??"")}else if(t.feeds){const e=t.feeds;y.Z.dispatch({actionType:"RSS_FEEDS_FOUND",tabId:o,feeds:e})}}));const e=new Map;s.Z.webRequest.onResponseStarted.addListener((t=>{if(-1===t.tabId)return void console.warn("RssDetectActions:","Should this be a chrome.runtime.lastError check instead?");const n=(t.responseHeaders||[]).reverse().find((e=>"content-type"===e.name.toLowerCase()));e.set(t.tabId,n?.value)}),{types:["main_frame"],urls:["http://*/*","https://*/*"]},["responseHeaders"]),s.Z.tabs.onRemoved.addListener((t=>e.delete(t)))}};var Gn=n(39206),$n=n(10589),Kn=n(66971);function jn(e){y.Z.dispatch({actionType:"SYNC_ENGINE_STATE_CHANGED",engineData:e})}function Yn(e){y.Z.dispatch({actionType:"SYNC_CYCLE_COMPLETED",cycleData:e})}const Xn=new class{start(){C.Z.sync.start()}stop(){C.Z.sync.stop()}clearData(){C.Z.sync.clearData()}setEncryptionPassword(e,t){C.Z.sync.setEncryptionPassword(e,(e=>t(e)))}async loadPromise(){if(s.Z.extension.inIncognitoContext)return;const e=new Promise((e=>C.Z.sync.getEngineState((t=>{jn(t),C.Z.sync.onEngineStateChanged.addListener((e=>jn(e))),e()})))),t=new Promise((e=>C.Z.sync.getLastCycleState((t=>{Yn(t),C.Z.sync.onCycleCompleted.addListener((e=>Yn(e))),e()}))));await Promise.all([e,t])}};class Qn extends F.Z{getInitialState(){return{devices:[],loggedIn:!1}}hasSupport(){return!window.isGuestSession&&!s.Z.extension.inIncognitoContext}getDevices(){return this.getState().devices}getLoggedIn(){return this.getState().loggedIn}getDeviceTree(){return this.getState().devices.map(((e,t)=>{let n=[],s=[],i="device_"+t;return 1===e.sessions.length?e.sessions[0].window?.tabs&&e.sessions[0].window?.sessionId&&(i=e.sessions[0].window.sessionId,s=e.sessions[0].window.tabs.map((e=>({id:e.sessionId??"",name:e.title??"",url:e.url??"",windowId:i,tab:e})))):n=e.sessions.map(((e,t)=>{if(e.window&&e.window.sessionId){const n=e.window.sessionId;return{id:n,name:(0,Oe.Z)("Window $1",[t+1]),tabs:(e.window?.tabs??[]).map((e=>({id:e.sessionId??"",name:e.title??"",url:e.url??"",windowId:n,tab:e})))}}})).filter(Boolean),{id:i,name:e.deviceName,windows:n,tabs:s}}))}reduce(e,t){switch(t.actionType){case"SYNCED_TABS_INIT":return{devices:[...t.devices],loggedIn:t.loggedIn};case"SYNCED_TABS_SET_DEVICES":return{devices:[...t.devices],loggedIn:e.loggedIn};case"SYNCED_TABS_SET_LOGGED_IN":return{devices:[...e.devices],loggedIn:t.loggedIn};default:return e}}}const qn=new Qn(y.Z);var Jn=n(61670),es=n(34155);async function ts(){const e=await s.Z.sessions.getDevices();y.Z.dispatch({actionType:"SYNCED_TABS_SET_DEVICES",devices:e})}function ns(){es.nextTick((()=>{y.Z.dispatch({actionType:"SYNCED_TABS_SET_LOGGED_IN",loggedIn:"loggedIn"===(0,Jn.O)(Jn.Z.getState())})}))}const ss=new class{loadPromise(){return qn.hasSupport()&&(Jn.Z.addListener(ns),C.Z.sync.onCycleCompleted.addListener(ts),async function(){const e=await s.Z.sessions.getDevices(),t=Jn.Z.getState(),n="loggedIn"===(0,Jn.O)(t);y.Z.dispatch({actionType:"SYNCED_TABS_INIT",devices:e,loggedIn:n})}()),Promise.resolve()}openTabs=e=>{e.forEach((e=>{s.Z.sessions.restore(e,(t=>{s.Z.runtime.lastError&&console.warn("Error restoring tab: ",e,s.Z.runtime.lastError)}))}))};openWindows=e=>{e.forEach((e=>{s.Z.sessions.restore(e,(t=>{s.Z.runtime.lastError&&console.warn("Error restoring window: ",e,s.Z.runtime.lastError)}))}))}};var is=n(2699),os=n(54058),as=n(76501);function rs(e){y.Z.dispatch({actionType:"VIVALDI_ACCOUNT_STATE_UPDATED",state:e})}const ls=new class{login(e,t,n){C.Z.vivaldiAccount.login(e,t,n),C.Z.sync.start()}logout(){C.Z.sync.stop(),C.Z.vivaldiAccount.logout()}async loadPromise(){if(s.Z.extension.inIncognitoContext)return;rs(await C.Z.vivaldiAccount.getState()),C.Z.vivaldiAccount.onAccountStateChanged.addListener(rs)}};var ds=n(16716),cs=n(63153),hs=n(67294),ps=n(59486),us=n(24325),gs=n.n(us),ms=n(25372),vs=n(36436),fs=n(48521);const ys=["/resources","chrome://favicon","data:"];function Cs(e){return ys.some((t=>e.startsWith(t)))}function ws(e){if(Cs(e))return e;let t,n="";const s=(0,ms.Z)((0,vs.q9)(e));s&&({hostname:t,protocol:n}=s);return`${n||"https"}//${(t||"").split(".").slice(-2).join(".")}/favicon.ico`}class bs extends hs.PureComponent{state={loadFailed:!1};componentDidUpdate(e,t){t.loadFailed&&this.props.url!==e.url&&this.props.loadType!==e.loadType&&this.setState({loadFailed:!1})}handleImageLoadError=()=>{this.setState({loadFailed:!0})};getUrl=()=>{const e=this.props.fallbackUrl?(0,je.w$)(this.props.fallbackUrl):void 0,t=(0,je.w$)(this.props.url);return t.startsWith("<svg")?{type:"svg",url:t}:t.startsWith("data:")?{type:"data",url:t}:this.state.loadFailed?e&&Cs(e)?{type:"faviconSkipCache",url:e}:{type:"faviconSkipCache",url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABiUlEQVR42u2XK08DURBG6U/D80eQeMIjqGJAocCA6hqqUBASakCBAYUqSbvb92u3j6VZZjYcQ3q3hWlSRJucfF8yt3PPlbuxtb2zUtYC/1dAfge/ZHOlAkgsXSBJkn0B9ki6nvE87z5Twi7g5vtM4pCwC0yn0yPZn6KdBATcEnaBfBzHx4p0EvIIuCTMAnLhqXCiaCcBgSwJk8B4PD6Ti1K0k3QE5kn8WWA0Gl24mEwm5wjMk7AIXA6Hw6tZ6EzO7GZhFpCLChBFkUfSyVmEYVgwC8gF14PBoKhoJwGY/ThflB2HJoF+v38jL0mRTi5MLpezCchLbnu9HtyRdFLRsyTdLNDtdkvykgdFOgkl0oVZoNPpPMqip0Vot9tkiv7XLNBqtZ5l2YuinVTkAtLJMgTeMngl6STdLNBsNt+h0WiQdNI5NwvIonK9XnfxQToomwVkiV+r1YJZ6IwEYGYWCIKgbcEs4Pt+JIQOIpJO0s0ClUrls1qtQkwqOiM5R9JNAktk9QLrb0MXX53cKptKU4a6AAAAAElFTkSuQmCC"}:"page"===this.props.loadType?t.startsWith("javascript")?{type:"svg",url:gs()}:{type:"page",url:t}:Cs(t)?{type:"faviconSkipCache",url:t}:{type:this.props.loadType,url:t}};render(){const{type:e,url:t}=this.getUrl();if("svg"===e||"emoji"===e)return(0,fs.jsx)("span",{ref:this.props.refFavicon,className:this.props.className,style:this.props.style,dangerouslySetInnerHTML:{__html:t},title:this.props.title});const n=t.replace("vivaldi://","chrome://"),s="page"===e?"":"iconurl/",i=this.props.size||16,o="faviconSkipCache"===e||"data"===e,a=o?t:null,r=o?null:`chrome://favicon/size/${i}@1x/${s}${n} 1x,chrome://favicon/size/${i}@2x/${s}${n} 2x`;return(0,fs.jsx)("img",{ref:this.props.refFavicon,className:this.props.className,width:i,height:i,src:a,srcSet:r,style:this.props.style,title:this.props.title,onError:this.handleImageLoadError})}}const Ss=bs;var Is,ks=n(94184),As=n.n(ks),Ts=n(86088);function Zs(e,t,n,s){Is||(Is="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Is,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var Es=Zs("circle",{cx:"10.5",cy:"10.5",r:"5"}),_s=Zs("text",{x:"7.5",y:"14",fontSize:"10px"},void 0,"~"),Ms=Zs("text",{x:"9.5",y:"14",fontSize:"10px"},void 0,"!");class Ns extends hs.PureComponent{getImageSet=()=>this.props.trash?Ts.nre:this.props.speeddial?this.props.open?Ts.g0V:Ts.$II:this.props.open?Ts.fHR:Ts._TQ;render(){return Zs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",className:As()("folder-icon",this.props.className,{sd:this.props.speeddial}),style:{marginLeft:this.props.leftMargin?this.props.leftMargin:null,marginRight:this.props.rightMargin?this.props.rightMargin:null}},void 0,this.props.icon?this.props.icon:Zs("g",{className:"fill-override",dangerouslySetInnerHTML:{__html:(this.props.imageSet||this.getImageSet()).small}}),(this.props.isConnecting||this.props.disconnected)&&Zs("g",{className:this.props.isConnecting?"folder-evaluating":"folder-error",onClick:this.props.onClickStatusIcon},void 0,Es,this.props.isConnecting?_s:Ms))}}const Ps=Ns;var Ds=n(27770),xs=n(26036);const Os=new Map;function Ls(e,t){const n=Os.get(e),s=Gn.Z.getDefault(G.ZP.isIncognito(e));if(t&&n){return Gn.Z.getById(n)||s}return s}const Rs={settingsState:{linkurl:"",linktitle:"",pageurl:"",pagetitle:"",srcurl:"",selection:"",printableselection:"",selectionurl:"",keywordurl:"",isdevtools:!1,iseditable:!1,isimage:!1,isframe:!1,ismailcontent:!1,iswebpanel:!1,ismailto:!1,support:{copy:!1,audio:!1,canvas:!1,editoptions:!1,emoji:!1,extensions:!1,highlight:!1,pictureinpicture:!1,password:!1,passwordgeneration:!1,passwordshowall:!1,paste:!1,plugin:!1,qrcode:!1,sendlinktodevices:!1,sendpagetodevices:!1,video:!1},textfield:"document"},getLabelWithParameter:function(e,t,n,s){switch(t.action){case"DOCUMENT_LOOK_UP":if(t.title){const e=t.title;return delete t.title,{...s?ae.Z.makeLabelPair(e):ae.Z.makeLabelPair(e.replace("$1",n))}}return{...s?(0,xs.Z)("Look Up “$1”"):(0,xs.Z)("Look Up “$1”",[n])};case"DOCUMENT_GOTO_URL":if(t.title){const e=t.title;return delete t.title,{...s?ae.Z.makeLabelPair(e):ae.Z.makeLabelPair(e.replace("$1",n))}}return{...s?(0,xs.Z)("Go to “$1”"):(0,xs.Z)("Go to “$1”",[n])};case"DOCUMENT_SEARCH":case"DOCUMENT_SEARCH_LAST_USED":{const i="DOCUMENT_SEARCH_LAST_USED"===t.action,o=Ls(e,i),a=o?o.name:"";if(t.title){const e=t.title;return delete t.title,{...s&&o?ae.Z.makeLabelPair(e):ae.Z.makeLabelPair(e.replace("$1",a).replace("$2",n))}}return s?i?{...(0,xs.Z)("Search $1 for “$2” (With Last Used Engine)")}:{...(0,xs.Z)("Search $1 for “$2”")}:{...(0,xs.Z)("Search $1 for “$2”",[a,n])}}default:return ae.Z.makeLabelPair("")}},setSearchEngine:function(e,t){Os.set(e,t.id)},getSearchEngine:Ls,getShortcuts:function(e,t){return J.Z.getMenuItem(e,{id:"",type:"command",action:t},!0).shortcuts||[]}};const Bs={actions:function(){return["DOCUMENT_CONTAINER_DEVELOPER_TOOLS","DOCUMENT_VALIDATE_URL","DOCUMENT_VIEW_SOURCE","DOCUMENT_VIEW_FRAME_SOURCE","DOCUMENT_RELOAD_FRAME","DOCUMENT_INSPECT"]},options:function(e,t,n){const s=void 0===n,i=n||Rs.settingsState,o={...ae.Z.commandItem};switch(t.action){case"DOCUMENT_CONTAINER_DEVELOPER_TOOLS":return o.settingsLabel=(0,Oe.Z)("[Developer Tools]"),o.type="container",{...o,...(0,xs.Z)("Developer Tools")};case"DOCUMENT_VALIDATE_URL":return{...o,...(0,xs.Z)("Validate")};case"DOCUMENT_VIEW_SOURCE":{const t=Rs.getShortcuts(e,"COMMAND_TAB_VIEW_PAGE_SOURCE");return{...o,shortcuts:i.iswebpanel?[]:t,...i.iswebpanel?(0,xs.Z)("View Panel Source"):(0,xs.Z)("View Page Source")}}case"DOCUMENT_VIEW_FRAME_SOURCE":return{...o,...(0,xs.Z)("View Frame Source")};case"DOCUMENT_RELOAD_FRAME":return{...o,...(0,xs.Z)("Reload Frame")};case"DOCUMENT_INSPECT":{const t=Rs.getShortcuts(e,"COMMAND_DEVELOPER_TOOLS");return{...o,shortcuts:i.iswebpanel?[]:t,...(0,xs.Z)("Inspect")}}default:return J.Z.getMenuItem(e,t,s)}}};const Fs={actions:function(){return["DOCUMENT_CONTAINER_AV","DOCUMENT_CONTAINER_EXTENSIONS"].concat(Bs.actions())},options:function(e,t,n){const s=void 0===n,i={...ae.Z.commandItem};switch(t.action){case"DOCUMENT_CONTAINER_AV":return i.settingsLabel=(0,Oe.Z)("[Media Controls]"),i.type="container",{...i,...(0,xs.Z)("Media Controls")};case"DOCUMENT_CONTAINER_EXTENSIONS":return i.settingsLabel=(0,Oe.Z)("[Extensions]"),i.type="container",{...i,...(0,xs.Z)("Extensions")};default:return Bs.actions().includes(t.action)?Bs.options(e,t,n):J.Z.getMenuItem(e,t,s)}}};const Vs={actions:function(){return["CONTEXT_OPEN_IN_NEW_TAB","CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB","CONTEXT_OPEN_IN_TAB","CONTEXT_OPEN_IN_NEW_WINDOW","CONTEXT_OPEN_IN_PRIVATE_WINDOW","CONTEXT_CONTAINER_OPEN_IN_WINDOW","CONTEXT_BOOKMARK","CONTEXT_NEW_BOOKMARK","CONTEXT_NEW_FOLDER","CONTEXT_NEW_SEPARATOR","CONTEXT_EDIT","CONTEXT_RENAME","CONTEXT_CUT","CONTEXT_COPY","CONTEXT_PASTE","CONTEXT_DELETE"]},options:function(e,t,n){const s=void 0===n,i={...ae.Z.commandItem};switch(t.action){case"CONTEXT_OPEN_IN_NEW_TAB":return{...i,...(0,xs.Z)("Open in New Tab")};case"CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB":return{...i,...(0,xs.Z)("Open in Background Tab")};case"CONTEXT_OPEN_IN_TAB":return{...i,...(0,xs.Z)("Open")};case"CONTEXT_OPEN_IN_NEW_WINDOW":return{...i,...(0,xs.Z)("Open in New Window")};case"CONTEXT_OPEN_IN_PRIVATE_WINDOW":return{...i,...(0,xs.Z)("Open in Private Window")};case"CONTEXT_CONTAINER_OPEN_IN_WINDOW":return i.settingsLabel=(0,Oe.Z)("[Open in Another Window]"),i.type="container",{...i,...(0,xs.Z)("Open in Another Window")};case"CONTEXT_BOOKMARK":return{...i,...(0,xs.Z)("Add Active Tab")};case"CONTEXT_NEW_BOOKMARK":return{...i,...(0,xs.Z)("New Bookmark")};case"CONTEXT_NEW_FOLDER":return{...i,...(0,xs.Z)("command","New Folder")};case"CONTEXT_NEW_SEPARATOR":return{...i,...(0,xs.Z)("New Separator")};case"CONTEXT_EDIT":return{...i,...(0,xs.Z)("command","Edit")};case"CONTEXT_RENAME":return{...i,...(0,xs.Z)("Rename")};case"CONTEXT_CUT":return{...i,...(0,xs.Z)("win_linux","Cut")};case"CONTEXT_COPY":return{...i,...(0,xs.Z)("win_linux","Copy")};case"CONTEXT_PASTE":return{...i,...(0,xs.Z)("win_linux","Paste")};case"CONTEXT_DELETE":return{...i,...(0,xs.Z)("other","Delete")};default:return J.Z.getMenuItem(e,t,s)}}};const Ws={actions:function(){return["CONTEXT_BOOKMARK","CONTEXT_NEW_BOOKMARK","CONTEXT_NEW_FOLDER","CONTEXT_NEW_SEPARATOR","CONTEXT_PASTE","CONTEXT_CONTAINER_SORT"]},options:function(e,t,n){const s=void 0===n,i={...ae.Z.commandItem};switch(t.action){case"CONTEXT_BOOKMARK":return{...i,...(0,xs.Z)("Add Active Tab")};case"CONTEXT_NEW_BOOKMARK":return{...i,...(0,xs.Z)("New Bookmark")};case"CONTEXT_NEW_FOLDER":return{...i,...(0,xs.Z)("command","New Folder")};case"CONTEXT_NEW_SEPARATOR":return{...i,...(0,xs.Z)("New Separator")};case"CONTEXT_PASTE":return{...i,...(0,xs.Z)("win_linux","Paste")};case"CONTEXT_CONTAINER_SORT":return i.settingsLabel=(0,Oe.Z)("[Sort Options]"),i.type="container",{...i,...(0,xs.Z)("Sort")};default:return J.Z.getMenuItem(e,t,s)}}};const Us={actions:function(){return["CONTEXT_OPEN_IN_NEW_TAB","CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB","CONTEXT_OPEN_IN_TAB","CONTEXT_OPEN_IN_NEW_WINDOW","CONTEXT_OPEN_IN_PRIVATE_WINDOW","CONTEXT_CONTAINER_OPEN_IN_WINDOW","CONTEXT_SET_SPEEDDIAL","CONTEXT_UNSET_SPEEDDIAL","CONTEXT_SET_BOOKMARK_BAR","CONTEXT_UNSET_BOOKMARK_BAR","CONTEXT_MOVE_TO_BOOKMARK_BAR","CONTEXT_BOOKMARK","CONTEXT_BOOKMARK_ALL","CONTEXT_NEW_ITEM","CONTEXT_NEW_FOLDER","CONTEXT_NEW_SEPARATOR","CONTEXT_RENAME","CONTEXT_CUT","CONTEXT_COPY","CONTEXT_PASTE","CONTEXT_DELETE","CONTEXT_EXPAND_ALL","CONTEXT_COLLAPSE_ALL","CONTEXT_IMPORT","CONTEXT_SETTINGS","CONTEXT_CONTAINER_SEARCH"]},options:function(e,t,n){const s=void 0===n,i={...ae.Z.commandItem};switch(t.action){case"CONTEXT_OPEN_IN_NEW_TAB":return{...i,...(0,xs.Z)("Open in New Tab")};case"CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB":return{...i,...(0,xs.Z)("Open in Background Tab")};case"CONTEXT_OPEN_IN_TAB":return{...i,...(0,xs.Z)("Open")};case"CONTEXT_OPEN_IN_NEW_WINDOW":return{...i,...(0,xs.Z)("Open in New Window")};case"CONTEXT_OPEN_IN_PRIVATE_WINDOW":return{...i,...(0,xs.Z)("Open in Private Window")};case"CONTEXT_CONTAINER_OPEN_IN_WINDOW":return i.settingsLabel=(0,Oe.Z)("[Open in Another Window]"),i.type="container",{...i,...(0,xs.Z)("Open in Another Window")};case"CONTEXT_SET_SPEEDDIAL":return{...i,...(0,xs.Z)("Use as Speed Dial")};case"CONTEXT_UNSET_SPEEDDIAL":return{...i,...(0,xs.Z)("Remove from Speed Dial")};case"CONTEXT_SET_BOOKMARK_BAR":return{...i,...(0,xs.Z)("Set as Bookmark Bar Folder")};case"CONTEXT_UNSET_BOOKMARK_BAR":return{...i,...(0,xs.Z)("Remove as Bookmark Bar Folder")};case"CONTEXT_MOVE_TO_BOOKMARK_BAR":return{...i,...(0,xs.Z)("Move to Bookmark Bar Folder")};case"CONTEXT_BOOKMARK":return{...i,...(0,xs.Z)("Bookmark Active Page")};case"CONTEXT_BOOKMARK_ALL":return{...i,...(0,xs.Z)("Bookmark All Open Pages")};case"CONTEXT_NEW_ITEM":return{...i,...(0,xs.Z)("New Bookmark")};case"CONTEXT_NEW_FOLDER":return{...i,...(0,xs.Z)("command","New Folder")};case"CONTEXT_NEW_SEPARATOR":return{...i,...(0,xs.Z)("New Separator")};case"CONTEXT_RENAME":return{...i,...(0,xs.Z)("Rename")};case"CONTEXT_CUT":return{...i,...(0,xs.Z)("verb","Cut")};case"CONTEXT_COPY":return{...i,...(0,xs.Z)("verb","Copy")};case"CONTEXT_PASTE":return{...i,...(0,xs.Z)("verb","Paste")};case"CONTEXT_DELETE":return{...i,...(0,xs.Z)("verb","Delete")};case"CONTEXT_EMPTY_TRASH":return{...i,...(0,xs.Z)("Empty Trash")};case"CONTEXT_EXPAND_ALL":return{...i,...(0,xs.Z)("Expand All Folders")};case"CONTEXT_COLLAPSE_ALL":return{...i,...(0,xs.Z)("Collapse All Folders")};case"CONTEXT_IMPORT":return i.ellipsis=!0,{...i,...(0,xs.Z)("Import Bookmarks")};case"CONTEXT_SETTINGS":return i.type="folder",{...i,...(0,xs.Z)("Settings")};case"CONTEXT_CONTAINER_SEARCH":return i.settingsLabel=(0,Oe.Z)("[Search Settings]"),i.type="container",{...i,...(0,xs.Z)("command","Search")};default:return J.Z.getMenuItem(e,t,s)}}};const Hs={actions:function(){return["CONTEXT_CONTAINER_CLOSED_TAB"]},options:function(e,t,n){const s=void 0===n,i={...ae.Z.commandItem};return"CONTEXT_CONTAINER_CLOSED_TAB"===t.action?(i.settingsLabel=(0,Oe.Z)("[All Closed Tabs]"),i.type="container",{...i,...(0,xs.Z)("Closed Tabs")}):J.Z.getMenuItem(e,t,s)}};const zs={actions:function(){return["CONTEXT_COMPOSE_MAIL","CONTEXT_VIEW_ALL_MESSAGES","CONTEXT_NEW_ITEM","CONTEXT_EDIT","CONTEXT_DELETE","CONTEXT_CONTAINER_DEFAULT_ACTION"]},options:function(e,t,n){const s=void 0===n,i={...ae.Z.commandItem};switch(t.action){case"CONTEXT_COMPOSE_MAIL":return{...i,...(0,xs.Z)("Compose Mail")};case"CONTEXT_VIEW_ALL_MESSAGES":return{...i,...(0,xs.Z)("View All Messages")};case"CONTEXT_NEW_ITEM":return{...i,...(0,xs.Z)("New Contact")};case"CONTEXT_EDIT":return{...i,...(0,xs.Z)("command","Edit")};case"CONTEXT_DELETE":return{...i,...(0,xs.Z)("verb","Delete")};case"CONTEXT_CONTAINER_DEFAULT_ACTION":return i.settingsLabel=(0,Oe.Z)("[Default Action]"),i.type="container",{...i,...(0,xs.Z)("Default Action")};default:return J.Z.getMenuItem(e,t,s)}}};const Gs={actions:function(){return["DOCUMENT_SUGGEST_PASSWORD","DOCUMENT_SHOW_PASSWORDS","DOCUMENT_LOOK_UP","DOCUMENT_EMOJI","DOCUMENT_UNDO","DOCUMENT_REDO","DOCUMENT_CUT","DOCUMENT_COPY","DOCUMENT_PASTE","DOCUMENT_PASTE_AS_PLAIN_TEXT","DOCUMENT_SELECT_ALL","DOCUMENT_ADD_AS_SEARCH_ENGINE","COMMAND_COPY_SELECTION_TO_NOTE","COMMAND_APPEND_SELECTION_TO_NOTE","DOCUMENT_GOTO_URL","DOCUMENT_CONTAINER_NOTES","DOCUMENT_SEARCH","DOCUMENT_SEARCH_LAST_USED","DOCUMENT_CONTAINER_SEARCH_WITH","DOCUMENT_CONTAINER_EXTENSIONS","DOCUMENT_CONTAINER_SPELLCHECK","DOCUMENT_CONTAINER_SPELLCHECK_OPTIONS","DOCUMENT_CONTAINER_SPEECH"].concat(Bs.actions())},options:function(e,t,n){const s=void 0===n,i=n||Rs.settingsState,o={...ae.Z.commandItem};switch(t.action){case"DOCUMENT_SUGGEST_PASSWORD":return o.ellipsis=!0,{...o,...(0,xs.Z)("Suggest Password")};case"DOCUMENT_SHOW_PASSWORDS":return o.ellipsis=!0,{...o,...(0,xs.Z)("Show all Saved Passwords")};case"DOCUMENT_LOOK_UP":case"DOCUMENT_SEARCH":case"DOCUMENT_SEARCH_LAST_USED":return{...o,...Rs.getLabelWithParameter(e,t,i.printableselection,s)};case"DOCUMENT_EMOJI":return{...o,...(0,xs.Z)("Emoji && Symbols")};case"DOCUMENT_UNDO":return{...o,shortcuts:["ctrl+z"],...(0,xs.Z)("win_linux","Undo")};case"DOCUMENT_REDO":return{...o,shortcuts:["ctrl+y"],...(0,xs.Z)("win_linux","Redo")};case"DOCUMENT_CUT":return{...o,shortcuts:["ctrl+x"],...(0,xs.Z)("win_linux","Cut")};case"DOCUMENT_COPY":return{...o,shortcuts:["ctrl+c"],...(0,xs.Z)("win_linux","Copy")};case"DOCUMENT_PASTE":return{...o,shortcuts:["ctrl+v"],...(0,xs.Z)("win_linux","Paste")};case"DOCUMENT_PASTE_AS_PLAIN_TEXT":{const t=Rs.getShortcuts(e,"COMMAND_CLIPBOARD_PASTE_AS_PLAIN_TEXT");return{...o,shortcuts:t,...(0,xs.Z)("win_linux","Paste as Plain Text")}}case"DOCUMENT_SELECT_ALL":return{...o,shortcuts:["ctrl+a"],...(0,xs.Z)("win_linux","Select All")};case"DOCUMENT_GOTO_URL":return{...o,...Rs.getLabelWithParameter(e,t,i.selectionurl,s)};case"DOCUMENT_ADD_AS_SEARCH_ENGINE":return o.ellipsis=!0,{...o,...(0,xs.Z)("Add as Search Engine")};case"COMMAND_COPY_SELECTION_TO_NOTE":return{...J.Z.getMenuItem(e,t,s),...(0,xs.Z)("Copy to Note")};case"COMMAND_APPEND_SELECTION_TO_NOTE":return{...J.Z.getMenuItem(e,t,s),...(0,xs.Z)("Append to Note")};case"DOCUMENT_CONTAINER_NOTES":return o.settingsLabel=(0,Oe.Z)("[All notes]"),o.type="container",{...o,...(0,xs.Z)("Insert Note")};case"DOCUMENT_CONTAINER_SEARCH_WITH":return o.settingsLabel=(0,Oe.Z)("[All search engines]"),o.type="container",{...o,...(0,xs.Z)("Search With")};case"DOCUMENT_CONTAINER_EXTENSIONS":return o.settingsLabel=(0,Oe.Z)("[Extensions]"),o.type="container",{...o,...(0,xs.Z)("Extensions")};case"DOCUMENT_CONTAINER_SPELLCHECK":return o.settingsLabel=(0,Oe.Z)("[Spell Check]"),o.type="container",{...o,...(0,xs.Z)("Spell Check")};case"DOCUMENT_CONTAINER_SPELLCHECK_OPTIONS":return o.settingsLabel=(0,Oe.Z)("[Spell Check Options]"),o.type="container",{...o,...(0,xs.Z)("Spell Check Options")};case"DOCUMENT_CONTAINER_WRITING_DIRECTION":return o.settingsLabel=(0,Oe.Z)("[Writing Direction Options]"),o.type="container",{...o,...(0,xs.Z)("Writing Direction")};case"DOCUMENT_CONTAINER_SPEECH":return o.settingsLabel=(0,Oe.Z)("[Speech Commands]"),o.type="container",{...o,...(0,xs.Z)("Speech")};default:return Bs.actions().includes(t.action)?Bs.options(e,t,n):J.Z.getMenuItem(e,t,s)}}};const $s={actions:function(){return["CONTEXT_OPEN_FILE","CONTEXT_OPEN_IN_NEW_TAB","CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB","CONTEXT_OPEN_IN_TAB","CONTEXT_OPEN_IN_NEW_WINDOW","CONTEXT_OPEN_IN_PRIVATE_WINDOW","CONTEXT_FILEMANAGER","CONTEXT_COPY_ADDRESS","CONTEXT_COPY_PATH","CONTEXT_RESTART","CONTEXT_STOP","CONTEXT_RESUME","CONTEXT_REMOVE","CONTEXT_REMOVE_ALL_FINISHED"]},options:function(e,t,n){const s=void 0===n,i=n||{numAddresses:1,numFiles:1,numImages:1,hasActive:!1,hasPaused:!1,hasCompleted:!1},o={...ae.Z.commandItem};switch(t.action){case"CONTEXT_OPEN_FILE":return{...o,...s||i.numFiles<2?(0,xs.Z)("the file","Open"):(0,xs.Z)("Open Files")};case"CONTEXT_OPEN_IN":return o.type="folder",{...o,...s||i.numFiles<2?(0,xs.Z)("Open Image in"):(0,xs.Z)("Open Images in")};case"CONTEXT_OPEN_IN_NEW_TAB":return{...o,...(0,xs.Z)("open in","New Tab")};case"CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB":return{...o,...(0,xs.Z)("Background Tab")};case"CONTEXT_OPEN_IN_TAB":return{...o,...(0,xs.Z)("Current Tab")};case"CONTEXT_OPEN_IN_NEW_WINDOW":return{...o,...(0,xs.Z)("open in","New Window")};case"CONTEXT_OPEN_IN_PRIVATE_WINDOW":return{...o,...(0,xs.Z)("open in","Private Window")};case"CONTEXT_FILEMANAGER":return{...o,...(0,xs.Z)("Show in File Manager")};case"CONTEXT_COPY_ADDRESS":return{...o,...s||i.numAddresses<2?(0,xs.Z)("Copy Download Address"):(0,xs.Z)("Copy Download Addresses")};case"CONTEXT_COPY_PATH":return{...o,...s||i.numFiles<2?(0,xs.Z)("Copy Local Path"):(0,xs.Z)("Copy Local Paths")};case"CONTEXT_RESTART":return{...o,...(0,xs.Z)("command","Restart")};case"CONTEXT_STOP":return{...o,...(0,xs.Z)("other","Stop")};case"CONTEXT_RESUME":return{...o,...(0,xs.Z)("Resume Download")};case"CONTEXT_REMOVE":return{...o,...(0,xs.Z)("verb","Remove")};case"CONTEXT_REMOVE_ALL_FINISHED":return{...o,...(0,xs.Z)("Remove All Finished")};default:return J.Z.getMenuItem(e,t,s)}}};const Ks={actions:function(){return["CONTEXT_OPEN_IN_NEW_TAB","CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB","CONTEXT_OPEN_IN_TAB","CONTEXT_OPEN_IN_NEW_WINDOW","CONTEXT_OPEN_IN_PRIVATE_WINDOW","CONTEXT_CONTAINER_OPEN_IN_WINDOW","CONTEXT_FILTER_BY","CONTEXT_COPY","CONTEXT_SAVE","CONTEXT_DELETE","CONTEXT_EXPAND_ALL","CONTEXT_COLLAPSE_ALL"]},options:function(e,t,n){const s=n||{address:"",selectedCount:0},i=void 0===n,o={...ae.Z.commandItem};switch(t.action){case"CONTEXT_OPEN_IN_NEW_TAB":return{...o,...(0,xs.Z)("Open in New Tab")};case"CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB":return{...o,...(0,xs.Z)("Open in Background Tab")};case"CONTEXT_OPEN_IN_TAB":return{...o,...(0,xs.Z)("Open")};case"CONTEXT_OPEN_IN_NEW_WINDOW":return{...o,...(0,xs.Z)("Open in New Window")};case"CONTEXT_OPEN_IN_PRIVATE_WINDOW":return{...o,...(0,xs.Z)("Open in Private Window")};case"CONTEXT_CONTAINER_OPEN_IN_WINDOW":return o.settingsLabel=(0,Oe.Z)("[Open in Another Window]"),o.type="container",{...o,...(0,xs.Z)("Open in Another Window")};case"CONTEXT_FILTER_BY":return o.settingsLabel=(0,Oe.Z)("Filter by Address"),{...o,...i?(0,xs.Z)("Filter by Address"):(0,xs.Z)("Filter by “$1”",[s.address])};case"CONTEXT_COPY":return{...o,...(0,xs.Z)("Copy Address")};case"CONTEXT_SAVE":return{...o,...(0,xs.Z)("Save as Bookmark","Save as Bookmarks",[n?.selectedCount??0])};case"CONTEXT_DELETE":return{...o,...(0,xs.Z)("verb","Delete")};case"CONTEXT_EXPAND_ALL":return{...o,...(0,xs.Z)("Expand All Folders")};case"CONTEXT_COLLAPSE_ALL":return{...o,...(0,xs.Z)("Collapse All Folders")};default:return J.Z.getMenuItem(e,t,i)}}};const js={actions:function(){return["DOCUMENT_OPEN_IMAGE_IN_NEW_TAB","DOCUMENT_OPEN_IMAGE_IN_NEW_BACKGROUND_TAB","DOCUMENT_OPEN_IMAGE_IN_TAB","DOCUMENT_OPEN_IMAGE_IN_NEW_WINDOW","DOCUMENT_OPEN_IMAGE_IN_PRIVATE_WINDOW","DOCUMENT_SAVE_IMAGE","DOCUMENT_COPY_IMAGE","DOCUMENT_COPY_IMAGE_ADDRESS","DOCUMENT_SHOW_IMAGE_PROPERTIES","DOCUMENT_USE_IMAGE_AS_STARTPAGE_BACKGROUND","DOCUMENT_RELOAD_IMAGE","DOCUMENT_SEARCH_FOR IMAGE","DOCUMENT_CONTAINER_OPEN_IMAGE_IN_PROFILE","DOCUMENT_CONTAINER_TEXT_SELECTION","DOCUMENT_CONTAINER_EXTENSIONS"].concat(Bs.actions())},options:function(e,t,n){const s=void 0===n,i={...ae.Z.commandItem};switch(t.action){case"DOCUMENT_OPEN_IMAGE_IN_NEW_TAB":return{...i,...(0,xs.Z)("Open Image in New Tab")};case"DOCUMENT_OPEN_IMAGE_IN_NEW_BACKGROUND_TAB":return{...i,...(0,xs.Z)("Open Image in Background Tab")};case"DOCUMENT_OPEN_IMAGE_IN_TAB":return{...i,...(0,xs.Z)("Open Image")};case"DOCUMENT_OPEN_IMAGE_IN_NEW_WINDOW":return{...i,...(0,xs.Z)("Open Image in New Window")};case"DOCUMENT_OPEN_IMAGE_IN_PRIVATE_WINDOW":return{...i,...(0,xs.Z)("Open Image in Private Window")};case"DOCUMENT_CONTAINER_OPEN_IMAGE_IN_PROFILE":return i.settingsLabel=(0,Oe.Z)("[Open Image in Another Profile]"),i.type="container",{...i,...(0,xs.Z)("Open Image in Another Profile")};case"DOCUMENT_SAVE_IMAGE":return i.ellipsis=!0,{...i,...(0,xs.Z)("Save Image As")};case"DOCUMENT_COPY_IMAGE":return{...i,...(0,xs.Z)("Copy Image")};case"DOCUMENT_COPY_IMAGE_ADDRESS":return{...i,...(0,xs.Z)("Copy Image Address")};case"DOCUMENT_SHOW_IMAGE_PROPERTIES":return i.ellipsis=!0,{...i,...(0,xs.Z)("Image Properties")};case"DOCUMENT_USE_IMAGE_AS_STARTPAGE_BACKGROUND":return{...i,...(0,xs.Z)("Use Image as Window Background")};case"DOCUMENT_RELOAD_IMAGE":return{...i,...(0,xs.Z)("Reload Image")};case"DOCUMENT_QR_CODE":return{...i,...(0,xs.Z)("command","Create QR Code for This Image")};case"DOCUMENT_SEARCH_FOR IMAGE":return{...i,...(0,xs.Z)("Search for Image")};case"DOCUMENT_CONTAINER_TEXT_SELECTION":return i.settingsLabel=(0,Oe.Z)("[Selected Text]"),i.type="container",{...i,...(0,xs.Z)("Selected Text")};case"DOCUMENT_CONTAINER_EXTENSIONS":return i.settingsLabel=(0,Oe.Z)("[Extensions]"),i.type="container",{...i,...(0,xs.Z)("Extensions")};default:return Bs.actions().includes(t.action)?Bs.options(e,t,n):J.Z.getMenuItem(e,t,s)}}};const Ys={actions:function(){return["DOCUMENT_LOOK_UP","DOCUMENT_COPY","DOCUMENT_CONTAINER_LINK_TO_HIGHLIGHT","COMMAND_COPY_SELECTION_TO_NOTE","COMMAND_APPEND_SELECTION_TO_NOTE","COMMAND_TRANSLATE_SELECTION","DOCUMENT_PRINT","DOCUMENT_GOTO_URL","DOCUMENT_SEARCH","DOCUMENT_SEARCH_LAST_USED","DOCUMENT_CONTAINER_SEARCH_WITH","DOCUMENT_CONTAINER_EXTENSIONS","DOCUMENT_SEND_BY_MAIL","DOCUMENT_ADD_TO_CALENDAR","DOCUMENT_CONTAINER_SPEECH"].concat(Bs.actions())},options:function(e,t,n){const s=void 0===n,i=n||Rs.settingsState,o={...ae.Z.commandItem};switch(t.action){case"DOCUMENT_LOOK_UP":case"DOCUMENT_SEARCH":case"DOCUMENT_SEARCH_LAST_USED":return{...o,...Rs.getLabelWithParameter(e,t,i.printableselection,s)};case"DOCUMENT_COPY":return{...o,...(0,xs.Z)("command","Copy")};case"DOCUMENT_CONTAINER_LINK_TO_HIGHLIGHT":return o.settingsLabel=(0,Oe.Z)("[Link to Highlight]"),o.type="container",{...o,...(0,xs.Z)("Link to Highlight")};case"COMMAND_COPY_SELECTION_TO_NOTE":return{...J.Z.getMenuItem(e,t,s),...(0,xs.Z)("Copy to Note")};case"COMMAND_APPEND_SELECTION_TO_NOTE":return{...J.Z.getMenuItem(e,t,s),...(0,xs.Z)("Append to Note")};case"COMMAND_TRANSLATE_SELECTION":return{...J.Z.getMenuItem(e,t,s),...(0,xs.Z)("Translate Selection")};case"DOCUMENT_PRINT":return o.ellipsis=!0,{...o,...(0,xs.Z)("command","Print")};case"DOCUMENT_GOTO_URL":return{...o,...Rs.getLabelWithParameter(e,t,i.selectionurl,s)};case"DOCUMENT_CONTAINER_SEARCH_WITH":return o.settingsLabel=(0,Oe.Z)("[All search engines]"),o.type="container",{...o,...(0,xs.Z)("Search With")};case"DOCUMENT_CONTAINER_EXTENSIONS":return o.settingsLabel=(0,Oe.Z)("[Extensions]"),o.type="container",{...o,...(0,xs.Z)("Extensions")};case"DOCUMENT_SEND_BY_MAIL":return{...o,...(0,xs.Z)("Send by Mail")};case"DOCUMENT_ADD_TO_CALENDAR":return{...o,...(0,xs.Z)("Add as Calendar Event")};case"DOCUMENT_CONTAINER_SPEECH":return o.settingsLabel=(0,Oe.Z)("[Speech Commands]"),o.type="container",{...o,...(0,xs.Z)("Speech")};default:return Bs.actions().includes(t.action)?Bs.options(e,t,n):J.Z.getMenuItem(e,t,s)}}};const Xs={actions:function(){const e=["DOCUMENT_CONTAINER_EXTENSIONS","DOCUMENT_CONTAINER_DEVELOPER_TOOLS"].concat(Bs.actions());return["DOCUMENT_OPEN_IN_NEW_TAB","DOCUMENT_OPEN_IN_NEW_BACKGROUND_TAB","DOCUMENT_OPEN_IN_TAB","DOCUMENT_OPEN_IN_NEW_WINDOW","DOCUMENT_OPEN_IN_PRIVATE_WINDOW","DOCUMENT_ADD_LINK_TO_BOOKMARKS","DOCUMENT_ADD_LINK_TO_WEBPANEL","DOCUMENT_ADD_LINK_TO_READING_LIST","DOCUMENT_SAVE_LINK","DOCUMENT_SEND_LINK_BY_MAIL","DOCUMENT_COPY_LINK_ADDRESS","DOCUMENT_COPY_LINK_TEXT","DOCUMENT_CONTAINER_OPEN_IN_PWA","DOCUMENT_CONTAINER_OPEN_IN_PROFILE","DOCUMENT_CONTAINER_SEND_TO_DEVICES","DOCUMENT_CONTAINER_EXTENSIONS","DOCUMENT_CONTAINER_LINK_SELECTION","DOCUMENT_CONTAINER_LINKED_IMAGE","DOCUMENT_CONTAINER_OPEN_IN_WINDOW"].concat(Ys.actions().filter((t=>!e.includes(t)))).concat(js.actions().filter((t=>!e.includes(t)))).concat(Fs.actions().filter((t=>!e.includes(t)))).concat(Bs.actions())},options:function(e,t,n){const s=void 0===n,i=n||Rs.settingsState,o={...ae.Z.commandItem};switch(t.action){case"DOCUMENT_OPEN_IN_NEW_TAB":return{...o,...(0,xs.Z)("Open Link in New Tab")};case"DOCUMENT_OPEN_IN_NEW_BACKGROUND_TAB":return{...o,...(0,xs.Z)("Open Link in Background Tab")};case"DOCUMENT_OPEN_IN_TAB":return{...o,...(0,xs.Z)("Open Link")};case"DOCUMENT_OPEN_IN_NEW_WINDOW":return{...o,...(0,xs.Z)("Open Link in New Window")};case"DOCUMENT_OPEN_IN_PRIVATE_WINDOW":return{...o,...(0,xs.Z)("Open Link in Private Window")};case"DOCUMENT_CONTAINER_OPEN_IN_PWA":return o.settingsLabel=(0,Oe.Z)("[Open Link in Progressive Web Apps]"),o.type="container",{...o,...(0,xs.Z)("Open Link in Progressive Web Apps")};case"DOCUMENT_CONTAINER_OPEN_IN_PROFILE":return o.settingsLabel=(0,Oe.Z)("[Open Link in Another Profile]"),o.type="container",{...o,...(0,xs.Z)("Open Link in Another Profile")};case"DOCUMENT_CONTAINER_OPEN_IN_WINDOW":return o.settingsLabel=(0,Oe.Z)("[Open Link in Another Window]"),o.type="container",{...o,...(0,xs.Z)("Open Link in Another Window")};case"DOCUMENT_CONTAINER_OPEN_IN_WORKSPACE":return o.settingsLabel=(0,Oe.Z)("[Open Link in Another Workspace]"),o.type="container",{...o,...(0,xs.Z)("Open Link in Another Workspace")};case"DOCUMENT_ADD_LINK_TO_BOOKMARKS":return{...o,...(0,xs.Z)("Bookmark Link")};case"DOCUMENT_ADD_LINK_TO_WEBPANEL":return{...o,...(0,xs.Z)("Add Link to Web Panel")};case"DOCUMENT_ADD_LINK_TO_READING_LIST":return{...o,...(0,xs.Z)("Add Link to Reading List")};case"DOCUMENT_SEND_LINK_BY_MAIL":return{...o,...(0,xs.Z)("Send Link by Mail")};case"DOCUMENT_SAVE_LINK":return o.ellipsis=!0,{...o,...(0,xs.Z)("Save Link As")};case"DOCUMENT_COPY_LINK_ADDRESS":return{...o,...!s&&i.ismailto?(0,xs.Z)("Copy Email Address"):(0,xs.Z)("Copy Link Address")};case"DOCUMENT_COPY_LINK_TEXT":return{...o,...(0,xs.Z)("Copy Link Text")};case"DOCUMENT_CONTAINER_SEND_TO_DEVICES":return o.settingsLabel=(0,Oe.Z)("[Send Link to Your Devices]"),o.type="container",{...o,...(0,xs.Z)("Send Link to Your Devices")};case"DOCUMENT_CONTAINER_EXTENSIONS":return o.settingsLabel=(0,Oe.Z)("[Extensions]"),o.type="container",{...o,...(0,xs.Z)("Extensions")};case"DOCUMENT_CONTAINER_LINK_SELECTION":return o.settingsLabel=(0,Oe.Z)("[Selection menu]"),o.type="container",{...o,...(0,xs.Z)("Text Selection")};case"DOCUMENT_CONTAINER_LINKED_IMAGE":return o.settingsLabel=(0,Oe.Z)("[Image menu]"),o.type="container",{...o,...(0,xs.Z)("Image")};default:return Bs.actions().includes(t.action)?Bs.options(e,t,n):Ys.actions().includes(t.action)?Ys.options(e,t,n):js.actions().includes(t.action)?js.options(e,t,n):Fs.actions().includes(t.action)?Fs.options(e,t,n):J.Z.getMenuItem(e,t,s)}}};const Qs={actions:function(){return["DOCUMENT_MAIL_BACK","DOCUMENT_MAIL_FORWARD","COMMAND_SAVE_PAGE","DOCUMENT_PRINT","COMMAND_TAB_VIEW_PAGE_SOURCE","COMMAND_MAIL_SHOW_PLAINTEXT","DOCUMENT_CONTAINER_DEVELOPER_TOOLS","DOCUMENT_INSPECT"]},options:function(e,t,n){const s=void 0===n,i={...ae.Z.commandItem};switch(t.action){case"COMMAND_PAGE_BACK":return{...J.Z.getMenuItem(e,t,s),...(0,xs.Z)("navigation","Back")};case"COMMAND_PAGE_FORWARD":return{...J.Z.getMenuItem(e,t,s),...(0,xs.Z)("navigation","Forward")};case"COMMAND_SAVE_PAGE":return i.ellipsis=!0,{...i,...J.Z.getMenuItem(e,t,s),...(0,xs.Z)("command","Save As")};case"DOCUMENT_PRINT":{const t=Rs.getShortcuts(e,"COMMAND_PRINT_PAGE");return i.ellipsis=!0,{...i,shortcuts:t,...(0,xs.Z)("command","Print")}}case"COMMAND_TAB_VIEW_PAGE_SOURCE":return i.type="checkbox",{...i,...J.Z.getMenuItem(e,t,s),...(0,xs.Z)("Show Raw Message")};case"DOCUMENT_INSPECT":return{...i,shortcuts:[],...(0,xs.Z)("Inspect")};default:return Bs.actions().includes(t.action)?Bs.options(e,t,n):J.Z.getMenuItem(e,t,s)}}};const qs={actions:function(){return["CONTEXT_BACK","CONTEXT_FORWARD","CONTEXT_COPY","CONTEXT_SENDER_IS_MAILING_LIST","COMMAND_TAB_VIEW_PAGE_SOURCE","COMMAND_MAIL_SHOW_PLAINTEXT"]},options:function(e,t,n){const s=void 0===n,i={...ae.Z.commandItem};switch(t.action){case"COMMAND_PAGE_BACK":return{...J.Z.getMenuItem(e,t,s),...(0,xs.Z)("navigation","Back")};case"COMMAND_PAGE_FORWARD":return{...J.Z.getMenuItem(e,t,s),...(0,xs.Z)("navigation","Forward")};case"CONTEXT_COPY":return{...i,...(0,xs.Z)("win_linux","Copy")};case"CONTEXT_SENDER_IS_MAILING_LIST":return i.type="checkbox",{...i,...(0,xs.Z)("Treat Sender as a Mailing List")};case"COMMAND_TAB_VIEW_PAGE_SOURCE":return{...i,...J.Z.getMenuItem(e,t,s),...(0,xs.Z)("Show Raw Message")};default:return J.Z.getMenuItem(e,t,s)}}};const Js={actions:function(){return["CONTEXT_VIEW_ALL_MESSAGES","CONTEXT_RERUN_FILTER","CONTEXT_MARK_ALL_AS_READ","CONTEXT_MOVE_ALL_TO_TRASH","CONTEXT_EMPTY_TRASH","CONTEXT_CHECK_FOR_MAIL","CONTEXT_SEND","CONTEXT_RESCAN_UNREAD","CONTEXT_IMPORT_MAIL_FILES","CONTEXT_SUBSCRIBE","CONTEXT_UNSUBSCRIBE","CONTEXT_RERUN_THREADING","CONTEXT_MOVE_INTO_IMPORTANT","CONTEXT_MOVE_INTO_OTHER","CONTEXT_DELETE","CONTEXT_DELETE_ALL","CONTEXT_RENAME","CONTEXT_REGENERATE","CONTEXT_ADVANCED","CONTEXT_CREATE_LABEL","CONTEXT_ADD_NEW_ACCOUNT"]},options:function(e,t,n){const s=void 0===n,i={...ae.Z.commandItem};switch(t.action){case"CONTEXT_VIEW_ALL_MESSAGES":return{...i,...(0,xs.Z)("View All Messages")};case"CONTEXT_RERUN_FILTER":return{...i,...(0,xs.Z)("Rerun Filter for Folder")};case"CONTEXT_MARK_ALL_AS_READ":return{...i,...(0,xs.Z)("Mark All as Read")};case"CONTEXT_MOVE_ALL_TO_TRASH":return{...i,...(0,xs.Z)("mail","Move All to Trash")};case"CONTEXT_EMPTY_TRASH":return{...i,...(0,xs.Z)("mail","Empty Trash")};case"CONTEXT_CHECK_FOR_MAIL":return{...i,...(0,xs.Z)("Check for Mail")};case"CONTEXT_CREATE_FOLDER":return{...i,...(0,xs.Z)("Create Folder")};case"CONTEXT_DELETE_FOLDER":return{...i,...(0,xs.Z)("Delete Folder")};case"CONTEXT_SEND":return{...i,...(0,xs.Z)("Send")};case"CONTEXT_RESCAN_UNREAD":return{...i,...(0,xs.Z)("Rescan Unread Flags")};case"CONTEXT_IMPORT_MAIL_FILES":return{...i,...(0,xs.Z)("Import Mail Files...")};case"CONTEXT_SUBSCRIBE":return{...i,...(0,xs.Z)("Subscribe")};case"CONTEXT_UNSUBSCRIBE":return{...i,...(0,xs.Z)("Unsubscribe")};case"CONTEXT_RERUN_THREADING":return{...i,...(0,xs.Z)("Rerun Threading")};case"CONTEXT_MOVE_INTO_IMPORTANT":return{...i,...(0,xs.Z)("Move into Important")};case"CONTEXT_MOVE_INTO_OTHER":return{...i,...(0,xs.Z)("Move into Other")};case"CONTEXT_DELETE_ALL":return{...i,...(0,xs.Z)("Delete all")};case"CONTEXT_REGENERATE":return{...i,...(0,xs.Z)("Regenerate")};case"CONTEXT_DELETE":return{...i,...(0,xs.Z)("verb","Delete")};case"CONTEXT_RENAME":return{...i,...(0,xs.Z)("Rename")};case"CONTEXT_FILTER_EDIT":return{...i,...(0,xs.Z)("mail filters","Edit")};case"CONTEXT_CREATE_LABEL":return{...i,...(0,xs.Z)("Create Label")};case"CONTEXT_ADD_NEW_ACCOUNT":return{...i,...(0,xs.Z)("Add Account")};case"CONTEXT_ADVANCED":return i.type="folder",{...i,...(0,xs.Z)("Advanced")};case"CONTEXT_TOGGLE_MAIL_VIEWS":return i.type="folder",{...i,...(0,xs.Z)("mail","Views")};case"CONTEXT_MAIL_FOLDER":return i.type="container",{...i,...(0,xs.Z)("Mail Folder")};default:return J.Z.getMenuItem(e,t,s)}}};const ei={actions:function(){return["COMMAND_MAIL_REPLY","COMMAND_MAIL_REPLY_ALL","COMMAND_MAIL_REPLY_LIST","COMMAND_MAIL_FORWARD","COMMAND_MAIL_MARK_READ","COMMAND_MAIL_MARK_UNREAD","COMMAND_MAIL_MARK_JUNK","COMMAND_MAIL_MARK_NOT_JUNK","COMMAND_MAIL_MOVE_TO_ARCHIVE","COMMAND_MAIL_RESTORE_FROM_ARCHIVE","COMMAND_MAIL_GOTO_NEXT_UNREAD","COMMAND_MAIL_GOTO_PREVIOUS_UNREAD","COMMAND_MAIL_MARK_READ_AND_GOTO_NEXT_UNREAD","CONTEXT_CONTAINER_MOVE","CONTEXT_ADD_FLAG","CONTEXT_REMOVE_FLAG","CONTEXT_CONTAINER_FLAGS","CONTEXT_CONTAINER_LABELS","CONTEXT_EDIT","CONTEXT_SEND","CONTEXT_RECEIVER","CONTEXT_CONTAINER_TRASH","COMMAND_MAIL_ENABLE_THREADED_VIEW","COMMAND_MAIL_MARK_THREAD_READ","COMMAND_MAIL_MARK_THREAD_UNREAD","COMMAND_MAIL_ENABLE_SENDER_VIEW","CONTEXT_SENDER_IS_MAILING_LIST","CONTEXT_EXPAND_ALL","CONTEXT_COLLAPSE_ALL","COMMAND_MAIL_COMPOSE_NEW_MESSAGE"]},options:function(e,t,n){const s=void 0===n,i={...ae.Z.commandItem};switch(t.action){case"CONTEXT_GOTO":return i.type="folder",{...i,...(0,xs.Z)("Go to")};case"CONTEXT_CONTAINER_MOVE":return i.settingsLabel=(0,Oe.Z)("[Move to Folders]"),i.type="container",{...i,...(0,xs.Z)("Move")};case"CONTEXT_ADD_FLAG":return{...i,...(0,xs.Z)("Add Flag")};case"CONTEXT_REMOVE_FLAG":return{...i,...(0,xs.Z)("Remove Flag")};case"CONTEXT_CONTAINER_FLAGS":return i.settingsLabel=(0,Oe.Z)("[All Flags]"),i.type="container",{...i,...(0,xs.Z)("Flags")};case"CONTEXT_CONTAINER_LABELS":return i.settingsLabel=(0,Oe.Z)("[All Labels]"),i.type="container",{...i,...(0,xs.Z)("Labels")};case"CONTEXT_EDIT":return{...i,...(0,xs.Z)("mail","Edit")};case"COMMAND_MAIL_MOVE_TO_ARCHIVE":return{...i,...(0,xs.Z)("mail","Move Message to Archive")};case"COMMAND_MAIL_RESTORE_FROM_ARCHIVE":return{...i,...(0,xs.Z)("mail","Restore Message from Archive")};case"CONTEXT_SEND":return{...i,...(0,xs.Z)("Send")};case"CONTEXT_CONTAINER_TRASH":return i.settingsLabel=(0,Oe.Z)("[Trash elements]"),i.type="container",{...i,...(0,xs.Z)("Trash")};case"CONTEXT_RECEIVER":return{...i,...(0,xs.Z)("Show Messages for Receiver")};case"CONTEXT_THREAD":return i.type="folder",{...i,...(0,xs.Z)("Thread")};case"CONTEXT_SENDER":return i.type="folder",{...i,...(0,xs.Z)("Sender")};case"CONTEXT_SENDER_IS_MAILING_LIST":return i.type="checkbox",{...i,...(0,xs.Z)("Treat Sender as a Mailing List")};case"CONTEXT_EXPAND_ALL":return{...i,...(0,xs.Z)("Expand All Threads")};case"CONTEXT_COLLAPSE_ALL":return{...i,...(0,xs.Z)("Collapse All Threads")};default:return J.Z.getMenuItem(e,t,s)}}};const ti={actions:function(){return["CONTEXT_CONTAINER_CUSTOMIZE_TOOLBAR","CONTEXT_CONTAINER_BACKWARD_HISTORY","CONTEXT_CONTAINER_FORWARD_HISTORY"]},options:function(e,t,n){const s=void 0===n,i={...ae.Z.commandItem};switch(t.action){case"CONTEXT_CONTAINER_CUSTOMIZE_TOOLBAR":return i.settingsLabel=(0,Oe.Z)("[Customize]"),i.type="container",{...i,...(0,xs.Z)("Customize")};case"CONTEXT_CONTAINER_BACKWARD_HISTORY":return i.settingsLabel=(0,Oe.Z)("[Backward History]"),i.type="container",{...i,...(0,xs.Z)("Backward History")};case"CONTEXT_CONTAINER_FORWARD_HISTORY":return i.settingsLabel=(0,Oe.Z)("[Forward History]"),i.type="container",{...i,...(0,xs.Z)("Forward History")};default:return J.Z.getMenuItem(e,t,s)}}};const ni={actions:function(){return["CONTEXT_CONTAINER_OPEN_IN_WINDOW","CONTEXT_OPEN_ADDRESS","CONTEXT_NEW_FROM_SELECTION","CONTEXT_NEW_ITEM","CONTEXT_NEW_FOLDER","CONTEXT_NEW_SEPARATOR","CONTEXT_EDIT","CONTEXT_RENAME","CONTEXT_CUT","CONTEXT_COPY","CONTEXT_PASTE","CONTEXT_DELETE","CONTEXT_EMPTY_TRASH","CONTEXT_EXPAND_ALL","CONTEXT_COLLAPSE_ALL","CONTEXT_SETTINGS","CONTEXT_CONTAINER_SEARCH"]},options:function(e,t,n){const s=n||{inManager:!1},i=void 0===n,o={...ae.Z.commandItem};switch(t.action){case"CONTEXT_OPEN_IN_NEW_TAB":return{...o,...(0,xs.Z)("Open in New Tab")};case"CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB":return{...o,...(0,xs.Z)("Open in Background Tab")};case"CONTEXT_OPEN_IN_TAB":return{...o,...(0,xs.Z)("Open")};case"CONTEXT_OPEN_IN_NEW_WINDOW":return{...o,...(0,xs.Z)("Open in New Window")};case"CONTEXT_OPEN_IN_PRIVATE_WINDOW":return{...o,...(0,xs.Z)("Open in Private Window")};case"CONTEXT_CONTAINER_OPEN_IN_WINDOW":return o.settingsLabel=(0,Oe.Z)("[Open in Another Window]"),o.type="container",{...o,...(0,xs.Z)("Open in Another Window")};case"CONTEXT_SET_SPEEDDIAL":return{...o,...(0,xs.Z)("Use as Speed Dial")};case"CONTEXT_UNSET_SPEEDDIAL":return{...o,...(0,xs.Z)("Remove from Speed Dial")};case"CONTEXT_SET_BOOKMARK_BAR":return{...o,...(0,xs.Z)("Set as Bookmark Bar Folder")};case"CONTEXT_UNSET_BOOKMARK_BAR":return{...o,...(0,xs.Z)("Remove as Bookmark Bar Folder")};case"CONTEXT_MOVE_TO_BOOKMARK_BAR":return{...o,...(0,xs.Z)("Move to Bookmark Bar Folder")};case"CONTEXT_BOOKMARK":return{...o,...(0,xs.Z)("Bookmark Active Page")};case"CONTEXT_BOOKMARK_ALL":return{...o,...(0,xs.Z)("Bookmark All Open Pages")};case"CONTEXT_OPEN_ADDRESS":return{...o,...(0,xs.Z)("Open Note Address")};case"CONTEXT_NEW_FROM_SELECTION":return{...o,...(0,xs.Z)("Copy Selection to New Note")};case"CONTEXT_NEW_ITEM":return{...o,...(0,xs.Z)("New Note")};case"CONTEXT_NEW_FOLDER":return{...o,...(0,xs.Z)("command","New Folder")};case"CONTEXT_NEW_SEPARATOR":return{...o,...(0,xs.Z)("New Separator")};case"CONTEXT_EDIT":return i?{...o,...(0,xs.Z)("command","Edit")}:{...o,...s.inManager?(0,xs.Z)("Edit in New Tab"):(0,xs.Z)("Edit in Notes Manager")};case"CONTEXT_RENAME":return{...o,...(0,xs.Z)("Rename")};case"CONTEXT_CUT":return{...o,...(0,xs.Z)("verb","Cut")};case"CONTEXT_COPY":return{...o,...(0,xs.Z)("verb","Copy")};case"CONTEXT_PASTE":return{...o,...(0,xs.Z)("verb","Paste")};case"CONTEXT_DELETE":return{...o,...(0,xs.Z)("verb","Delete")};case"CONTEXT_EMPTY_TRASH":return{...o,...(0,xs.Z)("Empty Trash")};case"CONTEXT_EXPAND_ALL":return{...o,...(0,xs.Z)("Expand All Folders")};case"CONTEXT_COLLAPSE_ALL":return{...o,...(0,xs.Z)("Collapse All Folders")};case"CONTEXT_SETTINGS":return o.type="folder",{...o,...(0,xs.Z)("Settings")};case"CONTEXT_CONTAINER_SEARCH":return o.settingsLabel=(0,Oe.Z)("[Search Settings]"),o.type="container",{...o,...(0,xs.Z)("command","Search")};default:return J.Z.getMenuItem(e,t,i)}}};const si={actions:function(){return["DOCUMENT_BACK","DOCUMENT_FORWARD","DOCUMENT_RELOAD","COMMAND_ADD_BOOKMARK","DOCUMENT_ADD_TO_WEBPANEL","DOCUMENT_SEND_BY_MAIL","DOCUMENT_SAVE","DOCUMENT_PRINT","DOCUMENT_CAST","DOCUMENT_COPY_ADDRESS","DOCUMENT_CONTAINER_LINK_TO_HIGHLIGHT","DOCUMENT_CONTAINER_SEND_TO_DEVICES","DOCUMENT_CONTAINER_EXTENSIONS","DOCUMENT_QR_CODE","DOCUMENT_CONTAINER_PLUGIN_ROTATION"].concat(Bs.actions())},options:function(e,t,n){const s=void 0===n,i=n||Rs.settingsState,o={...ae.Z.commandItem};switch(t.action){case"DOCUMENT_BACK":{const t=i.iswebpanel?[]:Rs.getShortcuts(e,"COMMAND_PAGE_BACK");return{...o,shortcuts:t,...(0,xs.Z)("navigation","Back")}}case"DOCUMENT_FORWARD":{const t=i.iswebpanel?[]:Rs.getShortcuts(e,"COMMAND_PAGE_FORWARD");return{...o,shortcuts:t,...(0,xs.Z)("navigation","Forward")}}case"DOCUMENT_RELOAD":{const t=i.iswebpanel?[]:Rs.getShortcuts(e,"COMMAND_PAGE_REFRESH");return{...o,shortcuts:t,...(0,xs.Z)("navigation","Reload")}}case"COMMAND_ADD_BOOKMARK":return{...J.Z.getMenuItem(e,t,s),...o,...(0,xs.Z)("command","Bookmark Page")};case"DOCUMENT_ADD_TO_WEBPANEL":return{...o,...(0,xs.Z)("Add Page to Web Panel")};case"DOCUMENT_SEND_BY_MAIL":return{...o,...(0,xs.Z)("Send by Mail")};case"DOCUMENT_SAVE":{const t=i.iswebpanel?[]:Rs.getShortcuts(e,"COMMAND_SAVE_PAGE");return o.ellipsis=!0,{...o,shortcuts:t,...(0,xs.Z)("Save As")}}case"DOCUMENT_PRINT":{const t=i.iswebpanel?[]:Rs.getShortcuts(e,"COMMAND_PRINT_PAGE");return o.ellipsis=!0,{...o,shortcuts:t,...(0,xs.Z)("command","Print")}}case"DOCUMENT_CAST":return o.ellipsis=!0,{...o,...(0,xs.Z)("Cast")};case"DOCUMENT_COPY_ADDRESS":return{...o,...i.iswebpanel?(0,xs.Z)("Copy Panel Address"):(0,xs.Z)("Copy Page Address")};case"DOCUMENT_CONTAINER_LINK_TO_HIGHLIGHT":return o.settingsLabel=(0,Oe.Z)("[Link to Highlight]"),o.type="container",{...o,...(0,xs.Z)("Link to Highlight")};case"DOCUMENT_CONTAINER_SEND_TO_DEVICES":return o.settingsLabel=(0,Oe.Z)("[Send to Your Devices]"),o.type="container",{...o,...(0,xs.Z)("Send to Your Devices")};case"DOCUMENT_QR_CODE":{const t=i.iswebpanel?[]:Rs.getShortcuts(e,"COMMAND_PAGE_QR_CODE");return{...o,shortcuts:t,...(0,xs.Z)("command","Create QR Code for This Page")}}case"DOCUMENT_CONTAINER_EXTENSIONS":return o.settingsLabel=(0,Oe.Z)("[Extensions]"),o.type="container",{...o,...(0,xs.Z)("Extensions")};case"DOCUMENT_CONTAINER_PLUGIN_ROTATION":return o.settingsLabel=(0,Oe.Z)("[Plugin Rotation Commands]"),o.type="container",{...o,...(0,xs.Z)("Plugin Rotation")};default:return Bs.actions().includes(t.action)?Bs.options(e,t,n):J.Z.getMenuItem(e,t,s)}}};const ii={actions:function(){return["CONTEXT_OPEN_IN_NEW_TAB","CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB","CONTEXT_OPEN_IN_TAB","CONTEXT_OPEN_IN_NEW_WINDOW","CONTEXT_OPEN_IN_PRIVATE_WINDOW","CONTEXT_COPY_ADDRESS","CONTEXT_DESKTOP_VERSION","CONTEXT_MOBILE_VERSION","CONTEXT_SEPARATE_WIDTH","CONTEXT_CONTAINER_TOOLBAR","CONTEXT_CONTAINER_PERIODIC_TIMER","CONTEXT_CONTAINER_FLOATING","CONTEXT_MUTE_PANEL","CONTAINER_CLOSED_WEBPANEL"]},options:function(e,t,n){const s=void 0===n,i={...ae.Z.commandItem};switch(t.action){case"CONTEXT_CONTAINER_PERIODIC_TIMER":return i.settingsLabel=(0,Oe.Z)("[Periodic Reload]"),i.type="container",{...i,...(0,xs.Z)("Periodic Reload")};case"CONTEXT_MENU_OPEN":return i.type="folder",{...i,...(0,xs.Z)("Open in")};case"CONTEXT_OPEN_IN_NEW_TAB":return{...i,...(0,xs.Z)("open in","New Tab")};case"CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB":return{...i,...(0,xs.Z)("Background Tab")};case"CONTEXT_OPEN_IN_TAB":return{...i,...(0,xs.Z)("Current Tab")};case"CONTEXT_OPEN_IN_NEW_WINDOW":return{...i,...(0,xs.Z)("open in","New Window")};case"CONTEXT_OPEN_IN_PRIVATE_WINDOW":return{...i,...(0,xs.Z)("open in","Private Window")};case"CONTEXT_COPY_ADDRESS":return{...i,...(0,xs.Z)("Copy Panel Address")};case"CONTEXT_DESKTOP_VERSION":return{...i,...(0,xs.Z)("Show Desktop Version")};case"CONTEXT_MOBILE_VERSION":return{...i,...(0,xs.Z)("Show Mobile Version")};case"CONTEXT_CONTAINER_FLOATING":return i.settingsLabel=(0,Oe.Z)("[Separate Floating]"),i.type="container",{...i,...(0,xs.Z)("Floating Panel")};case"CONTEXT_MUTE_PANEL":return{...i,...(0,xs.Z)("Mute Panel")};case"CONTEXT_SEPARATE_WIDTH":return i.type="checkbox",{...i,...(0,xs.Z)("Separate Width")};case"CONTEXT_CONTAINER_TOOLBAR":return i.settingsLabel=(0,Oe.Z)("[Toolbar]"),i.type="container",{...i,...(0,xs.Z)("Navigation Controls")};default:return J.Z.getMenuItem(e,t,s)}}};const oi={actions:function(){return["CONTAINER_CLOSED_WEBPANEL"]},options:function(e,t,n){const s=void 0===n;return t.action,J.Z.getMenuItem(e,t,s)}};const ai={actions:function(){return["CONTEXT_OPEN","CONTEXT_MARK_READ","CONTEXT_MARK_UNREAD","CONTEXT_COPY","CONTEXT_DELETE"]},options:function(e,t,n){const s=void 0===n,i={...ae.Z.commandItem};switch(t.action){case"CONTEXT_OPEN":return{...i,...(0,xs.Z)("verb","Open")};case"CONTEXT_MARK_READ":return{...i,...(0,xs.Z)("Mark as Read")};case"CONTEXT_MARK_UNREAD":return{...i,...(0,xs.Z)("Mark as Unread")};case"CONTEXT_COPY_URL":return{...i,...(0,xs.Z)("verb","Copy Address")};case"CONTEXT_DELETE":return{...i,...(0,xs.Z)("verb","Remove")};default:return J.Z.getMenuItem(e,t,s)}}};const ri={actions:function(){return["CONTEXT_OPEN_SESSION_IN_NEW_WINDOW","CONTEXT_OPEN_SESSION","CONTEXT_OPEN_IN_NEW_TAB","CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB","CONTEXT_OPEN_IN_TAB","CONTEXT_OPEN_IN_NEW_WINDOW","CONTEXT_OPEN_IN_PRIVATE_WINDOW","CONTEXT_QUARANTINE","CONTEXT_PIN","CONTEXT_UNPIN","CONTEXT_NEW_STACK","CONTEXT_REMOVE_STACK","CONTEXT_NEW_WINDOW","CONTEXT_NEW_WORKSPACE","CONTEXT_COPY","CONTEXT_RENAME","CONTEXT_DELETE","CONTEXT_DELETE_WITHOUT_QUARANTINE","CONTEXT_EXPAND_ALL","CONTEXT_COLLAPSE_ALL"]},options:function(e,t,n){const s=void 0===n,i={...ae.Z.commandItem};switch(t.action){case"CONTEXT_OPEN_SESSION_IN_NEW_WINDOW":return{...i,...(0,xs.Z)("Open")};case"CONTEXT_OPEN_SESSION":return{...i,...(0,xs.Z)("Open in Current Window")};case"CONTEXT_OPEN_LINK_MENU":return{...i,...(0,xs.Z)("Open Link")};case"CONTEXT_OPEN_IN_NEW_TAB":return{...i,...(0,xs.Z)("Open Link in New Tab")};case"CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB":return{...i,...(0,xs.Z)("Open Link in Background Tab")};case"CONTEXT_OPEN_IN_TAB":return{...i,...(0,xs.Z)("Open Link in Active Tab")};case"CONTEXT_OPEN_IN_NEW_WINDOW":return{...i,...(0,xs.Z)("Open Link in New Window")};case"CONTEXT_OPEN_IN_PRIVATE_WINDOW":return{...i,...(0,xs.Z)("Open Link in Private Window")};case"CONTEXT_QUARANTINE":return i.type="checkbox",{...i,...(0,xs.Z)("Excluded")};case"CONTEXT_DELETE_WITHOUT_QUARANTINE":return{...i,...(0,xs.Z)("Delete Now")};case"CONTEXT_PIN":return{...i,...(0,xs.Z)("Pin")};case"CONTEXT_UNPIN":return{...i,...(0,xs.Z)("Unpin")};case"CONTEXT_NEW_STACK":return{...i,...(0,xs.Z)("Stack Tabs")};case"CONTEXT_REMOVE_STACK":return{...i,...(0,xs.Z)("Unstack Tabs")};case"CONTEXT_NEW_WINDOW":return{...i,...(0,xs.Z)("command","New Window")};case"CONTEXT_NEW_WORKSPACE":return{...i,...(0,xs.Z)("command","New Workspace")};case"CONTEXT_COPY":return{...i,...(0,xs.Z)("Copy Link")};case"CONTEXT_RENAME":return{...i,...(0,xs.Z)("Rename")};case"CONTEXT_DELETE":return{...i,...(0,xs.Z)("verb","Delete")};case"CONTEXT_EXPAND_ALL":return{...i,...(0,xs.Z)("Expand All Folders")};case"CONTEXT_COLLAPSE_ALL":return{...i,...(0,xs.Z)("Collapse All Folders")};default:return J.Z.getMenuItem(e,t,s)}}};const li={actions:function(){return["CONTEXT_OPEN_IN_NEW_WINDOW","CONTEXT_OPEN","CONTEXT_NEW_ITEM","CONTEXT_RENAME","CONTEXT_EDIT","CONTEXT_UPDATE","CONTEXT_DELETE","CONTEXT_RESTORE","CONTEXT_EMPTY_TRASH","CONTEXT_MOVE_TO_TOP","CONTEXT_DUPLICATE","CONTEXT_AUTOMATIC_BACKUP","CONTEXT_HISTORY"]},options:function(e,t,n){const s=void 0===n,i={...ae.Z.commandItem};switch(t.action){case"CONTEXT_OPEN_IN_NEW_WINDOW":return{...i,...(0,xs.Z)("Open")};case"CONTEXT_OPEN":return{...i,...(0,xs.Z)("Open in Current Window")};case"CONTEXT_RENAME":return{...i,...(0,xs.Z)("Rename")};case"CONTEXT_NEW_ITEM":return i.ellipsis=!0,{...i,...(0,xs.Z)("New")};case"CONTEXT_EDIT":return{...i,...(0,xs.Z)("command","Edit / View Contents")};case"CONTEXT_UPDATE":return i.ellipsis=!0,{...i,...(0,xs.Z)("Save New Version")};case"CONTEXT_DELETE":return{...i,...(0,xs.Z)("verb","Delete")};case"CONTEXT_RESTORE":return{...i,...(0,xs.Z)("Restore")};case"CONTEXT_EMPTY_TRASH":return{...i,...(0,xs.Z)("Empty Trash")};case"CONTEXT_MOVE_TO_TOP":return{...i,...(0,xs.Z)("Move to Top")};case"CONTEXT_DUPLICATE":return{...i,...(0,xs.Z)("Duplicate as New Session")};case"CONTEXT_AUTOMATIC_BACKUP":return i.ellipsis=!0,i.type="checkbox",{...i,...(0,xs.Z)("verb","Automatic Session Backup")};case"CONTEXT_AUTOSAVE_SIZE":return{...i,...ae.Z.makeLabelPair("")};case"CONTEXT_HISTORY":return i.type="checkbox",{...i,...(0,xs.Z)("Show History")};default:return J.Z.getMenuItem(e,t,s)}}};const di={actions:function(){return["CONTEXT_OPEN_IN_NEW_TAB","CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB","CONTEXT_OPEN_IN_TAB","CONTEXT_OPEN_IN_NEW_WINDOW","CONTEXT_OPEN_IN_PRIVATE_WINDOW","CONTEXT_CONTAINER_OPEN_IN_WINDOW","CONTEXT_OPEN_ALL","CONTEXT_SET_THUMBNAIL","CONTEXT_CLEAR_THUMBNAIL","CONTEXT_RELOAD","CONTEXT_EDIT","CONTEXT_RENAME","CONTEXT_CUT","CONTEXT_COPY","CONTEXT_PASTE","CONTEXT_DELETE","COMMAND_TOGGLE_STARTPAGE_NAVIGATION"]},options:function(e,t,n){const s=void 0===n,i={...ae.Z.commandItem};switch(t.action){case"CONTEXT_OPEN_IN_NEW_TAB":return{...i,...(0,xs.Z)("Open in New Tab")};case"CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB":return{...i,...(0,xs.Z)("Open in Background Tab")};case"CONTEXT_OPEN_IN_TAB":return{...i,...(0,xs.Z)("Open")};case"CONTEXT_OPEN_IN_NEW_WINDOW":return{...i,...(0,xs.Z)("Open in New Window")};case"CONTEXT_OPEN_IN_PRIVATE_WINDOW":return{...i,...(0,xs.Z)("Open in Private Window")};case"CONTEXT_CONTAINER_OPEN_IN_WINDOW":return i.settingsLabel=(0,Oe.Z)("[Open in Another Window]"),i.type="container",{...i,...(0,xs.Z)("Open in Another Window")};case"CONTEXT_OPEN_ALL":return{...i,...(0,xs.Z)("Open All Bookmarks")};case"CONTEXT_SET_THUMBNAIL":return i.ellipsis=!0,{...i,...(0,xs.Z)("Select Custom Thumbnail")};case"CONTEXT_CLEAR_THUMBNAIL":return{...i,...(0,xs.Z)("Clear Custom Thumbnail")};case"CONTEXT_RELOAD":return{...i,...(0,xs.Z)("Reload")};case"CONTEXT_EDIT":return{...i,...(0,xs.Z)("command","Edit")};case"CONTEXT_RENAME":return{...i,...(0,xs.Z)("Rename")};case"CONTEXT_CUT":return{...i,...(0,xs.Z)("win_linux","Cut")};case"CONTEXT_COPY":return{...i,...(0,xs.Z)("win_linux","Copy")};case"CONTEXT_PASTE":return{...i,...(0,xs.Z)("win_linux","Paste")};case"CONTEXT_DELETE":return{...i,...(0,xs.Z)("other","Delete")};default:return J.Z.getMenuItem(e,t,s)}}};const ci={actions:function(){return["CONTEXT_RENAME","CONTEXT_REMOVE","COMMAND_TOGGLE_STARTPAGE_NAVIGATION"]},options:function(e,t,n){const s=void 0===n,i={...ae.Z.commandItem};switch(t.action){case"CONTEXT_RENAME":return{...i,...(0,xs.Z)("Rename")};case"CONTEXT_REMOVE":return{...i,...(0,xs.Z)("Remove from Speed Dial")};default:return J.Z.getMenuItem(e,t,s)}}};const hi={actions:function(){return["CONTEXT_ADD_BOOKMARK_TO_SPEEDDIAL","CONTEXT_ADD_FOLDER_TO_SPEEDDIAL","CONTEXT_PASTE","CONTEXT_CUSTOMIZE","COMMAND_TOGGLE_STARTPAGE_NAVIGATION","CONTEXT_UNDO","CONTEXT_REDO"]},options:function(e,t,n){const s=void 0===n,i={...ae.Z.commandItem};switch(t.action){case"CONTEXT_ADD_BOOKMARK_TO_SPEEDDIAL":return{...i,...(0,xs.Z)("command","Add Bookmark to Speed Dial")};case"CONTEXT_ADD_FOLDER_TO_SPEEDDIAL":return{...i,...(0,xs.Z)("command","Add Speed Dial Folder")};case"CONTEXT_PASTE":return{...i,...(0,xs.Z)("win_linux","Paste")};case"CONTEXT_CUSTOMIZE":return i.ellipsis=!0,{...i,...(0,xs.Z)("other","Customize")};case"CONTEXT_UNDO":return{...i,...(0,xs.Z)("command","Undo")};case"CONTEXT_REDO":return{...i,...(0,xs.Z)("command","Redo")};default:return J.Z.getMenuItem(e,t,s)}}};const pi={actions:function(){return["CONTEXT_NEW","CONTEXT_TOGGLE_SUBSTRIP_LOCK","CONTEXT_BOOKMARK_ALL","CONTEXT_SAVE_SESSION","CONTEXT_REOPEN"]},options:function(e,t,n){const s=void 0===n,i={...ae.Z.commandItem};switch(t.action){case"CONTEXT_LOCK_SUBSTRIP":case"CONTEXT_UNLOCK_SUBSTRIP":return{...i,isVisible:()=>!1};case"CONTEXT_NEW":return{...i,...(0,xs.Z)("command","New Tab")};case"CONTEXT_TOGGLE_SUBSTRIP_LOCK":return{...i,...(0,xs.Z)("Lock Second Tab Row")};case"CONTEXT_BOOKMARK_ALL":return{...i,...(0,xs.Z)("Bookmark All Tabs")};case"CONTEXT_SAVE_SESSION":return J.Z.getMenuItem(e,{...t,action:"COMMAND_SAVE_SESSION"},s);case"CONTEXT_REOPEN":return J.Z.getMenuItem(e,{...t,action:"COMMAND_TAB_REOPEN_RECENTLY_CLOSED"},s);default:return J.Z.getMenuItem(e,t,s)}}};const ui={actions:function(){return["CONTEXT_CONTAINER_TAB_OVERFLOW"]},options:function(e,t,n){const s=void 0===n,i={...ae.Z.commandItem};return"CONTEXT_CONTAINER_TAB_OVERFLOW"===t.action?{...i,...(0,xs.Z)("Open Tab")}:J.Z.getMenuItem(e,t,s)}};const gi={actions:function(){return["CONTEXT_CLOSE","CONTEXT_TABSTACK_REMOVE_FROM"]},options:function(e,t,n){const s=void 0===n,i={...ae.Z.commandItem};switch(t.action){case"CONTEXT_CLOSE":return{...i,...(0,xs.Z)("Close Tab")};case"CONTEXT_TABSTACK_REMOVE_FROM":return{...i,...(0,xs.Z)("Remove from Tab Stack")};default:return J.Z.getMenuItem(e,t,s)}}};const mi={actions:function(){return["CONTEXT_NEW","CONTEXT_RELOAD","CONTEXT_CLONE","CONTEXT_PIN","CONTEXT_PIN_STACK","CONTEXT_UNPIN","CONTEXT_UNPIN_STACK","CONTEXT_MUTE","CONTEXT_MUTE_OTHER","CONTEXT_OPTIMIZE_FS_VIDEOS","CONTEXT_BOOKMARK","CONTEXT_BOOKMARK_STACK","CONTEXT_BOOKMARK_ALL","CONTEXT_COPY_LINK","CONTEXT_COPY_LINKS","CONTEXT_SAVE_SESSION","CONTEXT_TABSTACK_BY_SELECTION","CONTEXT_TABSTACK_BY_HOST","CONTEXT_TABSTACK_RENAME","CONTEXT_TABSTACK_RELOAD","CONTEXT_TABSTACK_REMOVE_FROM","CONTEXT_TABSTACK_UNGROUP","CONTEXT_TILE_TABSTACK","CONTEXT_UNTILE_TABSTACK","CONTEXT_TILE_TABS","CONTEXT_UNTILE_TAB","CONTEXT_UNTILE_TABS","CONTEXT_UNTILE_SELECTION","CONTEXT_HIBERNATE_TAB","CONTEXT_HIBERNATE_SELECTED_BACKGROUND_TABS","CONTEXT_HIBERNATE_TABSTACK","CONTEXT_HIBERNATE_BACKGROUND","CONTEXT_CLOSE","CONTEXT_CLOSE_TABSTACK","CONTEXT_CLOSE_OTHER","CONTEXT_CLOSE_LEFT","CONTEXT_CLOSE_RIGHT","CONTEXT_REOPEN","CONTEXT_CUSTOMIZE","CONTEXT_CONTAINER_PWA","CONTEXT_CONTAINER_MOVE_TO_WINDOW","CONTEXT_CONTAINER_MOVE_TO_WORKSPACE","CONTEXT_MOVE","CONTEXT_TABSTACK_MOVE","CONTEXT_MOVE_LEFT","CONTEXT_MOVE_RIGHT","CONTEXT_CONTAINER_PERIODIC_TIMER","CONTEXT_TABSTACK_BY_HOSTS","CONTEXT_MOVE_STACK_LEFT","CONTEXT_MOVE_STACK_RIGHT"]},options:function(e,t,n){const s=n||{isMultiSelect:!1,count:-1,closableCount:-1,unSelectedCount:0,unpinned:0,pinned:0,playing:0,hostname:"",hostnameCount:-1,canHibernateCount:-1,horizontal:!0,someIncognito:!1,canCloneCount:-1},i=void 0===n,o={...ae.Z.commandItem};switch(t.action){case"CONTEXT_NEW":return{...o,...(0,xs.Z)("command","New Tab")};case"CONTEXT_RELOAD":return{...o,...s.isMultiSelect?(0,xs.Z)("Reload $1 Tab","Reload $1 Tabs",[s.count]):(0,xs.Z)("Reload Tab")};case"CONTEXT_CLONE":return{...o,...s.isMultiSelect?(0,xs.Z)("Duplicate $1 Tab","Duplicate $1 Tabs",[s.canCloneCount]):(0,xs.Z)("Duplicate Tab")};case"CONTEXT_PIN_STACK":return{...o,...(0,xs.Z)("Pin Tab Stack")};case"CONTEXT_PIN":return{...o,...s.isMultiSelect?(0,xs.Z)("Pin $1 Tab","Pin $1 Tabs",[s.unpinned]):(0,xs.Z)("Pin Tab")};case"CONTEXT_UNPIN":return{...o,...s.isMultiSelect?(0,xs.Z)("Unpin $1 Tab","Unpin $1 Tabs",[s.pinned]):(0,xs.Z)("Unpin Tab")};case"CONTEXT_UNPIN_STACK":return{...o,...(0,xs.Z)("Unpin Tab Stack")};case"CONTEXT_CONTAINER_PERIODIC_TIMER":return o.settingsLabel=(0,Oe.Z)("[Periodic Reload]"),o.type="container",{...o,...(0,xs.Z)("Periodic Reload")};case"CONTEXT_MUTE":return o.type="checkbox",{...o,...s.isMultiSelect?(0,xs.Z)("Mute $1 Tab","Mute $1 Tabs",[s.playing]):(0,xs.Z)("Mute Tab")};case"CONTEXT_MUTE_OTHER":return{...o,...(0,xs.Z)("Mute Other Tabs")};case"CONTEXT_OPTIMIZE_FS_VIDEOS":return{...o,...(0,xs.Z)("Optimize fullscreen videos")};case"CONTEXT_BOOKMARK":return{...o,...s.isMultiSelect?(0,xs.Z)("Bookmark $1 Tab","Bookmark $1 Tabs",[s.count]):(0,xs.Z)("Bookmark Tab")};case"CONTEXT_BOOKMARK_STACK":return{...o,...(0,xs.Z)("Bookmark Tab Stack")};case"CONTEXT_BOOKMARK_ALL":return{...o,...(0,xs.Z)("Bookmark All Tabs")};case"CONTEXT_COPY_LINK":return{...o,...(0,xs.Z)("Copy Link")};case"CONTEXT_COPY_LINKS":return{...o,...(0,xs.Z)("Copy Links")};case"CONTEXT_SAVE_SESSION":return{...o,...s.count>0?(0,xs.Z)("Save $1 Selected Tab as Session","Save $1 Selected Tabs as Session",[s.count]):(0,xs.Z)("Save All Tabs as Session")};case"CONTEXT_TABSTACK_BY_SELECTION":return{...o,...i?(0,xs.Z)("Stack Selected Tabs"):(0,xs.Z)("Stack $1 Selected Tab","Stack $1 Selected Tabs",[s.count])};case"CONTEXT_TABSTACK_BY_HOST":return{...o,...i?(0,xs.Z)("Stack Tabs by Host"):(0,xs.Z)("Stack Tabs by Host ($1 of $2)",[s.hostnameCount,s.hostname])};case"CONTEXT_TABSTACK_BY_HOSTS":return{...o,...(0,xs.Z)("Stack Tabs by Hosts")};case"CONTEXT_TABSTACK_RELOAD":return{...o,...(0,xs.Z)("Reload Tab Stack")};case"CONTEXT_TABSTACK_RENAME":return{...o,...(0,xs.Z)("Rename Tab Stack")};case"CONTEXT_TABSTACK_REMOVE_FROM":return{...o,...(0,xs.Z)("Remove from Tab Stack")};case"CONTEXT_TABSTACK_UNGROUP":return{...o,...(0,xs.Z)("Unstack Tabs")};case"CONTEXT_TILE_TABSTACK":return{...o,...(0,xs.Z)("Tile Tab Stack")};case"CONTEXT_UNTILE_TABSTACK":return{...o,...(0,xs.Z)("Untile Tab Stack")};case"CONTEXT_TILE_TABS":return{...o,...i?(0,xs.Z)("Tile Tabs"):(0,xs.Z)("Tile $1 Tab","Tile $1 Tabs",[s.count])};case"CONTEXT_UNTILE_TAB":return{...o,...(0,xs.Z)("Untile Tab")};case"CONTEXT_UNTILE_TABS":return{...o,...(0,xs.Z)("Untile Tabs")};case"CONTEXT_UNTILE_SELECTION":return{...o,...(0,xs.Z)("Untile Selection")};case"CONTEXT_HIBERNATE_TAB":return{...o,...(0,xs.Z)("Hibernate Tab")};case"CONTEXT_HIBERNATE_SELECTED_BACKGROUND_TABS":return{...o,...i?(0,xs.Z)("Hibernate Selected Background Tabs"):(0,xs.Z)("Hibernate $1 Background Tab","Hibernate $1 Background Tabs",[s.canHibernateCount])};case"CONTEXT_HIBERNATE_TABSTACK":return{...o,...(0,xs.Z)("Hibernate Tab Stack")};case"CONTEXT_HIBERNATE_BACKGROUND":return{...o,...(0,xs.Z)("Hibernate Background Tabs")};case"CONTEXT_CLOSE":return{...o,...s.isMultiSelect?(0,xs.Z)("Close $1 Tab","Close $1 Tabs",[s.closableCount]):(0,xs.Z)("Close Tab")};case"CONTEXT_CLOSE_TABSTACK":return{...o,...(0,xs.Z)("Close Tab Stack")};case"CONTEXT_CLOSE_OTHER":return{...o,...s.isMultiSelect&&s.unSelectedCount>0?(0,xs.Z)("Close Other ($1 Unselected Tab)","Close Other ($1 Unselected Tabs)",[s.unSelectedCount]):(0,xs.Z)("Close Other Tabs")};case"CONTEXT_CLOSE_LEFT":return{...o,...s.horizontal?(0,xs.Z)("Close Tabs to the Left"):(0,xs.Z)("Close the Tabs Above")};case"CONTEXT_CLOSE_RIGHT":return{...o,...s.horizontal?(0,xs.Z)("Close Tabs to the Right"):(0,xs.Z)("Close the Tabs Below")};case"CONTEXT_REOPEN":return J.Z.getMenuItem(e,{...t,action:"COMMAND_TAB_REOPEN_RECENTLY_CLOSED"},i);case"CONTEXT_CUSTOMIZE":return o.ellipsis=!0,{...o,...(0,xs.Z)("panel","Customize")};case"CONTEXT_CONTAINER_PWA":return o.settingsLabel=(0,Oe.Z)("[All Progressive Web Apps]"),o.type="container",{...o,...(0,xs.Z)("Progressive Web Apps")};case"CONTEXT_CONTAINER_MOVE_TO_WINDOW":return o.settingsLabel=(0,Oe.Z)("[All Window Destinations]"),o.type="container",{...o,...(0,xs.Z)("Window Destinations")};case"CONTEXT_CONTAINER_MOVE_TO_WORKSPACE":return o.settingsLabel=(0,Oe.Z)("[All Workspace Destinations]"),o.type="container",{...o,...(0,xs.Z)("context","Workspace")};case"CONTEXT_MOVE":return o.type="folder",{...o,...s.isMultiSelect&&!s.someIncognito?(0,xs.Z)("Move $1 Tab","Move $1 Tabs",[s.count]):(0,xs.Z)("Move Tab")};case"CONTEXT_TABSTACK_MOVE":return o.type="folder",{...o,...(0,xs.Z)("Move Tab Stack")};case"CONTEXT_MOVE_LEFT":case"CONTEXT_MOVE_STACK_LEFT":return{...o,...s.horizontal?(0,xs.Z)("navigation","Left"):(0,xs.Z)("Up")};case"CONTEXT_MOVE_RIGHT":case"CONTEXT_MOVE_STACK_RIGHT":return{...o,...s.horizontal?(0,xs.Z)("navigation","Right"):(0,xs.Z)("Down")};default:return J.Z.getMenuItem(e,t,i)}}};const vi={actions:function(){return["CONTEXT_COPY","CONTEXT_DELETE"]},options:function(e,t,n){const s=void 0===n,i={...ae.Z.commandItem};switch(t.action){case"CONTEXT_COPY":return{...i,...(0,xs.Z)("verb","Copy")};case"CONTEXT_COPY_ALL":return{...i,...(0,xs.Z)("Copy Both")};case"CONTEXT_DELETE":return{...i,...(0,xs.Z)("verb","Delete")};default:return J.Z.getMenuItem(e,t,s)}}};const fi={actions:function(){return["DOCUMENT_LOOK_UP","DOCUMENT_EMOJI","DOCUMENT_UNDO","DOCUMENT_REDO","DOCUMENT_CUT","DOCUMENT_COPY","DOCUMENT_PASTE","DOCUMENT_PASTE_AS_PLAIN_TEXT","DOCUMENT_SELECT_ALL","DOCUMENT_CONTAINER_NOTES","DOCUMENT_CONTAINER_SPELLCHECK","DOCUMENT_CONTAINER_SPELLCHECK_OPTIONS","DOCUMENT_CONTAINER_SPEECH"]},options:function(e,t,n){const s=void 0===n,i={...ae.Z.commandItem},o=n||Rs.settingsState;switch(t.action){case"DOCUMENT_LOOK_UP":return{...i,...Rs.getLabelWithParameter(e,t,o.printableselection,s)};case"DOCUMENT_EMOJI":return{...i,...(0,xs.Z)("Emoji && Symbols")};case"DOCUMENT_UNDO":return{...i,shortcuts:["ctrl+z"],...(0,xs.Z)("win_linux","Undo")};case"DOCUMENT_REDO":return{...i,shortcuts:["ctrl+y"],...(0,xs.Z)("win_linux","Redo")};case"DOCUMENT_CUT":return{...i,shortcuts:["ctrl+x"],...(0,xs.Z)("win_linux","Cut")};case"DOCUMENT_COPY":return{...i,shortcuts:["ctrl+c"],...(0,xs.Z)("win_linux","Copy")};case"DOCUMENT_PASTE":return{...i,shortcuts:["ctrl+v"],...(0,xs.Z)("win_linux","Paste")};case"DOCUMENT_PASTE_AS_PLAIN_TEXT":{const t=Rs.getShortcuts(e,"COMMAND_CLIPBOARD_PASTE_AS_PLAIN_TEXT");return{...i,shortcuts:t,...(0,xs.Z)("win_linux","Paste as Plain Text")}}case"DOCUMENT_SELECT_ALL":return{...i,shortcuts:["ctrl+a"],...(0,xs.Z)("win_linux","Select All")};case"DOCUMENT_CONTAINER_NOTES":return i.settingsLabel=(0,Oe.Z)("[All notes]"),i.type="container",{...i,...(0,xs.Z)("Insert Note")};case"DOCUMENT_CONTAINER_SPELLCHECK":return i.settingsLabel=(0,Oe.Z)("[Spell Check]"),i.type="container",{...i,...(0,xs.Z)("Spell Check")};case"DOCUMENT_CONTAINER_SPELLCHECK_OPTIONS":return i.settingsLabel=(0,Oe.Z)("[Spell Check Options]"),i.type="container",{...i,...(0,xs.Z)("Spell Check Options")};case"DOCUMENT_CONTAINER_WRITING_DIRECTION":return i.settingsLabel=(0,Oe.Z)("[Writing Direction Options]"),i.type="container",{...i,...(0,xs.Z)("Writing Direction")};case"DOCUMENT_CONTAINER_SPEECH":return i.settingsLabel=(0,Oe.Z)("[Speech Commands]"),i.type="container",{...i,...(0,xs.Z)("Speech")};default:return J.Z.getMenuItem(e,t,s)}}};var yi=n(21788);const Ci={actions:function(){return["DOCUMENT_LOOK_UP","DOCUMENT_EMOJI","DOCUMENT_UNDO","DOCUMENT_REDO","DOCUMENT_CUT","DOCUMENT_COPY","CONTEXT_COPY_FILTERED","DOCUMENT_PASTE","COMMAND_CLIPBOARD_PASTE_AS_PLAIN_TEXT_OR_PASTE_AND_GO","DOCUMENT_SELECT_ALL","DOCUMENT_CONTAINER_NOTES","DOCUMENT_CONTAINER_SPELLCHECK","DOCUMENT_CONTAINER_SPELLCHECK_OPTIONS","DOCUMENT_CUSTOMIZE","DOCUMENT_SHOW_FULL_ADDRESS","DOCUMENT_CONTAINER_SPEECH"]},options:function(e,t,n){const s=void 0===n,i={...ae.Z.commandItem},o=n||Rs.settingsState;switch(t.action){case"DOCUMENT_LOOK_UP":return{...i,...Rs.getLabelWithParameter(e,t,o.printableselection,s)};case"DOCUMENT_EMOJI":return{...i,...(0,xs.Z)("Emoji && Symbols")};case"DOCUMENT_UNDO":return{...i,shortcuts:["ctrl+z"],...(0,xs.Z)("win_linux","Undo")};case"DOCUMENT_REDO":return{...i,shortcuts:["ctrl+y"],...(0,xs.Z)("win_linux","Redo")};case"DOCUMENT_CUT":return{...i,shortcuts:["ctrl+x"],...(0,xs.Z)("win_linux","Cut")};case"DOCUMENT_COPY":return{...i,shortcuts:["ctrl+c"],...(0,xs.Z)("win_linux","Copy")};case"CONTEXT_COPY_FILTERED":case"COMMAND_CLIPBOARD_COPY_FILTERED":return{...i,isVisible:()=>s||Boolean(n?.selection.length),handler:()=>{n&&yi.Z.copyWithFilter(n.selection)},...(0,xs.Z)("Copy without Parameters")};case"DOCUMENT_PASTE":return{...i,shortcuts:["ctrl+v"],...(0,xs.Z)("win_linux","Paste")};case"DOCUMENT_SELECT_ALL":return{...i,shortcuts:["ctrl+a"],...(0,xs.Z)("win_linux","Select All")};case"DOCUMENT_CONTAINER_NOTES":return i.settingsLabel=(0,Oe.Z)("[All notes]"),i.type="container",{...i,...(0,xs.Z)("Insert Note")};case"DOCUMENT_CONTAINER_SPELLCHECK":return i.settingsLabel=(0,Oe.Z)("[Spell Check]"),i.type="container",{...i,...(0,xs.Z)("Spell Check")};case"DOCUMENT_CONTAINER_SPELLCHECK_OPTIONS":return i.settingsLabel=(0,Oe.Z)("[Spell Check Options]"),i.type="container",{...i,...(0,xs.Z)("Spell Check Options")};case"DOCUMENT_CONTAINER_WRITING_DIRECTION":return i.settingsLabel=(0,Oe.Z)("[Writing Direction Options]"),i.type="container",{...i,...(0,xs.Z)("Writing Direction")};case"DOCUMENT_CUSTOMIZE":return i.ellipsis=!0,{...i,...(0,xs.Z)("panel","Customize")};case"DOCUMENT_SHOW_FULL_ADDRESS":return i.type="checkbox",{...i,...(0,xs.Z)("Show Full Address")};case"DOCUMENT_CONTAINER_SPEECH":return i.settingsLabel=(0,Oe.Z)("[Speech Commands]"),i.type="container",{...i,...(0,xs.Z)("Speech")};default:return J.Z.getMenuItem(e,t,s)}}};const wi={actions:function(){return["CONTEXT_NEW","CONTEXT_NEW_STACK","CONTEXT_NEW_STACK_FOR_HOST","CONTEXT_TABSTACK_UNGROUP","CONTEXT_CLONE","CONTEXT_ACTIVATE","CONTEXT_RELOAD","CONTEXT_HIBERNATE","CONTEXT_PIN","CONTEXT_PIN_STACK","CONTEXT_UNPIN","CONTEXT_UNPIN_STACK","CONTEXT_TILE_TABS","CONTEXT_UNTILE_TABS","CONTEXT_MUTE","CONTEXT_MUTE_OTHER","CONTEXT_UNMUTE","CONTEXT_RENAME","CONTEXT_COPY","CONTEXT_SAVE","CONTEXT_SAVE_ALL","CONTEXT_EXPORT","CONTEXT_EXPORT_ALL","CONTEXT_DELETE","CONTEXT_EMPTY_TRASH","CONTEXT_REOPEN","CONTEXT_EXPAND_ALL","CONTEXT_COLLAPSE_ALL","CONTEXT_OPEN_IN_NEW_WINDOW","CONTEXT_OPEN_SYNC_ITEMS","CONTEXT_REGISTER_SYNC","CONTEXT_SIGNIN_SYNC"]},options:function(e,t,n){const s=n||{hostname:"",selectedCount:0,isInTrashFolder:!1},i=void 0===n,o={...ae.Z.commandItem};switch(t.action){case"CONTEXT_NEW":return{...o,...(0,xs.Z)("command","New Tab")};case"CONTEXT_NEW_STACK":return{...o,...(0,xs.Z)("Stack $1 Selected Tab","Stack $1 Selected Tabs",[s.selectedCount])};case"CONTEXT_NEW_STACK_FOR_HOST":return{...o,...i?(0,xs.Z)("Stack Tabs by Host"):(0,xs.Z)("Stack Tabs by Host ($1)",[s.hostname])};case"CONTEXT_TABSTACK_UNGROUP":return{...o,...(0,xs.Z)("Unstack Tabs")};case"CONTEXT_CLONE":return{...o,...(0,xs.Z)("Duplicate")};case"CONTEXT_ACTIVATE":return{...o,...(0,xs.Z)("Activate")};case"CONTEXT_RELOAD":return{...o,...(0,xs.Z)("Reload")};case"CONTEXT_HIBERNATE":return{...o,...(0,xs.Z)("Hibernate")};case"CONTEXT_PIN":case"CONTEXT_PIN_STACK":return{...o,...(0,xs.Z)("Pin")};case"CONTEXT_UNPIN":case"CONTEXT_UNPIN_STACK":return{...o,...(0,xs.Z)("Unpin")};case"CONTEXT_TILE_TABS":return{...o,...(0,xs.Z)("Tile")};case"CONTEXT_UNTILE_TABS":return{...o,...(0,xs.Z)("Untile")};case"CONTEXT_MUTE":return{...o,...(0,xs.Z)("Mute")};case"CONTEXT_MUTE_OTHER":return{...o,...(0,xs.Z)("Mute Others")};case"CONTEXT_UNMUTE":return{...o,...(0,xs.Z)("Unmute")};case"CONTEXT_RENAME":return{...o,...(0,xs.Z)("Rename")};case"CONTEXT_COPY":return{...o,...1===s.selectedCount?(0,xs.Z)("Copy Link"):(0,xs.Z)("Copy Links")};case"CONTEXT_SAVE":return{...o,...(0,xs.Z)("Save as Bookmarks")};case"CONTEXT_SAVE_ALL":return{...o,...(0,xs.Z)("Save All as Bookmarks")};case"CONTEXT_EXPORT":return{...o,...(0,xs.Z)("Save as Session")};case"CONTEXT_EXPORT_ALL":return{...o,...(0,xs.Z)("Save All as Session")};case"CONTEXT_DELETE":return{...o,...s.isInTrashFolder?(0,xs.Z)("verb","Delete"):(0,xs.Z)("Close")};case"CONTEXT_EMPTY_TRASH":return{...o,...(0,xs.Z)("command","Clear All")};case"CONTEXT_REOPEN":return{...o,...(0,xs.Z)("Reopen")};case"CONTEXT_EXPAND_ALL":return{...o,...(0,xs.Z)("Expand All Folders")};case"CONTEXT_COLLAPSE_ALL":return{...o,...(0,xs.Z)("Collapse All Folders")};case"CONTEXT_OPEN_IN_NEW_WINDOW":return{...o,...(0,xs.Z)("Open in a New Window")};case"CONTEXT_OPEN_SYNC_ITEMS":return{...o,...(0,xs.Z)("Open")};case"CONTEXT_REGISTER_SYNC":return{...o,...(0,xs.Z)("Create Account")};case"CONTEXT_SIGNIN_SYNC":return{...o,...(0,xs.Z)("Log In")};default:return J.Z.getMenuItem(e,t,i)}}};const bi={actions:function(){return["CONTEXT_WORKSPACE_RENAME","CONTEXT_WORKSPACE_DELETE","CONTEXT_WORKSPACE_OPEN_IN_NEW_WINDOW","CONTEXT_WORKSPACE_HIBERNATE"]},options:function(e,t,n){const s={...ae.Z.commandItem};switch(t.action){case"CONTEXT_WORKSPACE_RENAME":return{...s,...(0,xs.Z)("Rename Workspace")};case"CONTEXT_WORKSPACE_DELETE":return{...s,...(0,xs.Z)("Delete Workspace")};case"CONTEXT_WORKSPACE_OPEN_IN_NEW_WINDOW":return{...s,...(0,xs.Z)("Open in a New Window")};case"CONTEXT_WORKSPACE_HIBERNATE":return{...s,...n?(0,xs.Z)("Hibernate Workspace"):(0,xs.Z)("Hibernate Tabs")};default:return J.Z.getMenuItem(e,t,!1)}}},Si=[{name:(0,Oe.Z)("Web Page"),group:"8",indent:0,sort:!0},{name:(0,Oe.Z)("Mail"),group:"6",indent:0,sort:!0},{name:(0,Oe.Z)("section","Start page"),group:"1",indent:0,sort:!0},{name:(0,Oe.Z)("Panels"),group:"4",indent:0,sort:!0},{name:(0,Oe.Z)("Tabs"),group:"2",indent:0,sort:!0},{name:(0,Oe.Z)("Bookmarks"),group:"5",indent:0,sort:!0},{name:(0,Oe.Z)("context","Address Bar"),group:"3",indent:0,sort:!1},{name:(0,Oe.Z)("Other"),group:"7",indent:0,sort:!0}],Ii={tab:{name:(0,Oe.Z)("context","Tab"),group:"2",...mi},tabstackthumbnails:{name:(0,Oe.Z)("Tab Stack Thumbnails"),group:"2",...gi},tabbar:{name:(0,Oe.Z)("context","Tab Bar"),group:"2",...pi},closedtab:{name:(0,Oe.Z)("Tab Trash Can"),group:"2",...Hs},taboverflow:{name:(0,Oe.Z)("Tab Overflow"),group:"2",...ui},windowlist:{name:(0,Oe.Z)("Window List"),group:"2",...wi},bookmarkbar:{name:(0,Oe.Z)("Bookmark Bar"),group:"5",...Ws},bookmarkbaritem:{name:(0,Oe.Z)("Bookmark Bar Button"),group:"5",...Vs},bookmarklist:{name:(0,Oe.Z)("Bookmark List"),group:"5",...Us},panelbar:{name:(0,Oe.Z)("Panel Bar"),group:"4",...oi},panelbaritem:{name:(0,Oe.Z)("Panel Bar Button"),group:"4",...ii},backwardbutton:{name:(0,Oe.Z)("Back Button"),group:"3",...ti},forwardbutton:{name:(0,Oe.Z)("Forward Button"),group:"3",...ti},rewindbutton:{name:(0,Oe.Z)("Rewind Button"),group:"3",...ti},fastforwardbutton:{name:(0,Oe.Z)("Fast Forward Button"),group:"3",...ti},reloadbutton:{name:(0,Oe.Z)("Reload Button"),group:"3",...ti},homebutton:{name:(0,Oe.Z)("Home Button"),group:"3",...ti},urledit:{name:(0,Oe.Z)("Text Field"),group:"3",...Ci},speeddialitem:{name:(0,Oe.Z)("Speed Dial Button"),group:"1",...di},startpage:{name:(0,Oe.Z)("context","Start Page"),group:"1",...hi},startpagebar:{name:(0,Oe.Z)("Start Page Bar"),group:"1",...ci},mailheader:{name:(0,Oe.Z)("Message Header"),group:"6",...qs},mailpanellist:{name:(0,Oe.Z)("mail","Panel"),group:"6",...Js},mailsearchlist:{name:(0,Oe.Z)("Message List"),group:"6",...ei},mailcontent:{name:(0,Oe.Z)("Message Content"),group:"6",...Qs},contactlist:{name:(0,Oe.Z)("Contacts"),group:"6",...zs},noteslist:{name:(0,Oe.Z)("Notes List"),group:"7",...ni},historylist:{name:(0,Oe.Z)("History List"),group:"7",...Ks},downloadlist:{name:(0,Oe.Z)("Download List"),group:"7",...$s},translatehistory:{name:(0,Oe.Z)("Translate History"),group:"7",...vi},readinglist:{name:(0,Oe.Z)("Reading List"),group:"7",...ai},sessioncontentlist:{name:(0,Oe.Z)("Session Content List"),group:"7",...ri},sessionlist:{name:(0,Oe.Z)("Session List"),group:"7",...li},uiedit:{name:(0,Oe.Z)("Text Field"),group:"7",...fi},workspacelist:{name:(0,Oe.Z)("Workspace List"),group:"7",...bi},link:{name:(0,Oe.Z)("Link"),group:"8",...Xs},image:{name:(0,Oe.Z)("Image"),group:"8",...js},page:{name:(0,Oe.Z)("Page"),group:"8",...si},selection:{name:(0,Oe.Z)("context","Selection"),group:"8",...Ys},docedit:{name:(0,Oe.Z)("Text Field"),group:"8",...Gs},audiovideo:{name:(0,Oe.Z)("Audio and Video"),group:"8",...Fs}},ki=()=>Object.keys(Ii),Ai=e=>Si.some((t=>t.group===e)),Ti=e=>{if(Ai(e)){const t=Si.findIndex((t=>t.group===e));return Si[t].name}return Ii[e].name},Zi=e=>Ii[e].options,Ei=e=>Ii[e].actions;function _i(e,t,n,s,i){const o=Zi(t);if(o){const t=t=>Promise.resolve(o(e,t));return Mi(e,s,n||t,i)}return Promise.resolve([])}function Mi(e,t,n,s){return Promise.all(t.map((t=>n(t).then((i=>{let o=ae.Z.commandItem;switch(t.type){case"folder":o={...i,type:t.type,id:t.id,items:[],commandName:t.action};break;case"command":case"checkbox":o={...i,type:t.type,id:t.id,commandName:t.action};break;case"radio":break;case"container":s.expandContainers?i.container?(i.container.cpp=!0,i.container.mode=t.containermode||"folder",i.container.edge=t.containeredge||"off",o={type:t.type,id:t.id,...i}):"inline"===t.containermode?(i.items||(i.items=[]),o={...i,type:"container",id:t.id}):"folder"===t.containermode&&(delete i.type,o={...i,type:"folder",id:t.id}):(i.container={content:t.action,mode:t.containermode,edge:t.containeredge,cpp:!1},o={...i,type:t.type,id:t.id,commandName:t.action});break;case"separator":o={...ae.Z.separatorItem,id:t.id}}return void 0!==t.title&&(o.label&&(o.label=t.title),o.labelEnglish&&(o.labelEnglish=t.title),o.settingsLabel&&delete o.settingsLabel,o.ellipsis=!1),void 0!==t.custom&&(o.custom=t.custom),o.showshortcut=t.showshortcut,"folder"!==t.type||!t.children||i.isVisible&&!i.isVisible(e,s.inSettings)?o:Mi(e,t.children,n,s).then((e=>(Array.prototype.push.apply(o.items,e),o)))}))))).then((t=>t.reduce(((t,n)=>n.isVisible&&!n.isVisible(e,s.inSettings)?[...t]:"container"===n.type&&n.items&&s.expandContainers?[...t,...n.items]:[...t,n]),[])))}const Ni={isSection:Ai,getKeys:ki,getSettingsList:()=>{const e={};Object.keys(Ii).forEach((t=>{const n=Ii[t];e[n.group]||(e[n.group]=[]),e[n.group].push(t)}));let t=[];return Si.forEach((n=>{if(e[n.group]){const s={key:n.group,indent:n.indent,name:n.name},i=e[n.group].map((e=>({key:e,indent:n.indent+1,name:Ti(e)}))).sort(((e,t)=>!1===n.sort?0:e.name<t.name?-1:e.name>t.name?1:0));i&&i.length>0&&(t=[...t,s,...i])}})),t},getNamedMenu:(e,t,n)=>new Promise((i=>{C.Z.menuContent.get(t,((o,a,r)=>{s.Z.runtime.lastError?(console.warn("Failed to read menu spec. Attempting fallback for menu key:",t),C.Z.menuContent.reset(t,!0,void 0,(()=>{C.Z.menuContent.get(t,((o,a,r)=>{void 0===s.Z.runtime.lastError?i(_i(e,t,n,r,{expandContainers:!0,inSettings:!1,updateCallbacks:!1})):(console.warn("fallback failed"),i([]))}))}))):i(_i(e,t,n,r,{expandContainers:!0,inSettings:!1,updateCallbacks:!1}))}))})),makeMenuWithContent:(e,t,n,s)=>_i(e,t,void 0,n,s),makeCommandList:(e,t)=>{if(void 0===Ii[t])return[];const n={id:"",type:"command",action:""},s=Zi(t);return Ei(t)().map((t=>(n.type=J.Z.getIsContainer(t)?"container":"command",n.action=t,{commandName:t,...s(e,n),id:t})))},hasName:e=>ki().includes(e)||Ai(e),getName:Ti,getOptionFunction:Zi,getActionList:Ei},Pi=Ni;var Di=n(84451),xi=n(94283),Oi=n(88594);class Li extends hs.PureComponent{static contextType=xi.Z;nodeRef=hs.createRef();componentDidMount=()=>{this._attachObserver()};componentWillUnmount=()=>{this._detachObserver()};componentDidUpdate(e){this.props.attached&&!e.attached&&this._detachObserver(),!this.props.attached&&e.attached&&this._attachObserver()}_attachObserver=()=>{const{Element:e,ResizeObserver:t}=this.context,n=this.nodeRef.current;if(n instanceof e)try{this._observer=new t(this.props.onResize),this._observer.observe(n)}catch(e){console.warn(e)}};_detachObserver=()=>{const{Element:e}=this.context,t=this.nodeRef.current;t instanceof e&&this._observer.unobserve(t)};render(){const e=(0,Oi.Z)(this.props,["ref","onResize","component","children","attached"]);return(0,fs.jsx)("div",{ref:this.nodeRef,...e,children:this.props.children})}}const Ri=Li;const Bi=class{constructor(e=!0){this.selectedIds_=[],this.anchorIndex_=-1,this.leadIndex_=-1,this.multiSelect_=e}isSelected(e){for(const t of this.selectedIds_)if(t.id===e)return t.selected;return!1}get length(){return this.selectedIds_.length}get isSingleItemSelected(){return 1===this.selectedIds_.length}get FirstSingleItemSelected(){return this.isSingleItemSelected?this.selectedIds_[0].id:-1}get selectedIds(){return this.selectedIds_}resetSelectionModel(){this.selectedIds_=[],this.anchorIndex_=-1,this.leadIndex_=-1}getData(){return{selectedIds_:this.selectedIds_,anchorIndex_:this.anchorIndex_,leadIndex_:this.leadIndex_}}setData(e){this.anchorIndex_=e.anchorIndex_,this.leadIndex_=e.leadIndex_,this.selectedIds_=e.selectedIds_}unSelectAll(){this.selectedIds_=[]}selectAll(e){this.multiSelect&&(e.forEach((e=>{this.selectedIds_.push({id:e,selected:!0})})),e.length>0&&(-1===this.anchorIndex_&&(this.anchorIndex_=e[0]),-1===this.leadIndex_&&(this.leadIndex_=e[0])))}setSelectedIds(e){this.multiSelect?this.selectedIds_=e.map((e=>({id:e,selected:!0}))):this.setIndexSelected(this.leadIndex,!0)}setLeadIndex(e){this.leadIndex=e}setIndexSelected(e,t){var n=this.selectedIds_.map((e=>e.id)).indexOf(e),s=this.selectedIds_[n];if((!s||s.selected!==t)&&(this.multiSelect||this.resetSelectionModel(),this.leadIndex=e,this.anchorIndex=e,-1!==e))if(t)this.selectedIds_.push({id:e,selected:t});else{var i=this.selectedIds_.map((e=>e.id)).indexOf(e);-1!==i&&this.selectedIds_.splice(i,1)}}get leadIndex(){return this.leadIndex_}set leadIndex(e){this.leadIndex_=e}get anchorIndex(){return this.anchorIndex_}set anchorIndex(e){this.anchorIndex_=e}get multiSelect(){return this.multiSelect_}set multiSelect(e){this.multiSelect_=e}};var Fi=n(81538),Vi=n(34155);const Wi={throttleSync:function(e,t={}){return function(){if(!t.isRunning){t.isRunning=!0;try{e.apply(this,arguments)}finally{Vi.nextTick((()=>{t.isRunning=!1}))}}}}};var Ui,Hi=n(4027),zi=n(52373);function Gi(e,t,n=((e,t,n)=>(0,zi.Z)(t[e],n[e]))){if(e===t)return!0;const s=Object.keys(e),i=Object.keys(t);if(s.length!==i.length)return!1;for(let i=0;i<s.length;i++)if(!t.hasOwnProperty(s[i])||!n(s[i],e,t))return!1;return!0}function $i(e,t,n,s){Ui||(Ui="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Ui,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Ki(e,t,n){switch(e){case"style":case"componentProps":return Gi(t[e],n[e])}return(0,zi.Z)(t[e],n[e])}class ji extends hs.Component{static contextType=xi.Z;#i={available:!1,onto:!1,edge:"none"};#o;shouldComponentUpdate(e){return!Gi(this.props,e,Ki)}isFolder=()=>this.props.isFolder(this.props.treeItem);hasChildren=()=>this.props.hasChildren(this.props.treeItem);onClick=e=>{this.props.onItemClick(this.props.treeItem,e),e.stopPropagation()};onDoubleClick=e=>{if(void 0===this.props.inlineEditText){if(this.isFolder()){this.props.overrideDoubleClick&&this.props.overrideDoubleClick(this.props.treeItem)||this.onExpandClick(e)}this.props.onItemDoubleClick(this.props.treeItem,e)}};onDragStart=e=>{const{inlineEditText:t,validateForDrag:n,getAllSelectedItems:s,mimeType:i}=this.props;if(!n||void 0!==t)return;let o=s().map((e=>e.id));o=n(o),0!==o.length&&(this.props.onDragStart(),i&&e.dataTransfer.setData(i,JSON.stringify(o)),e.dataTransfer.setData("text/uri-list",this.props.getDragData?.("text/uri-list",o)),e.dataTransfer.setData("vivaldi/x-uri-list",this.props.getDragData?.("vivaldi/x-uri-list",o)),e.dataTransfer.setData("text/plain",this.props.getDragData?.("text/plain",o)),e.dataTransfer.setData("vivaldi/x-title",this.props.getDragData?.("vivaldi/x-title",o)),this.props.setCustomDragData&&this.props.setCustomDragData(e.dataTransfer,o),e.dataTransfer.effectAllowed="all",this.#o=!0,Hi.Z.setWebviewPointerEvents(!1,this.context.document))};onDragEnd=e=>{this.#o=!1,Hi.Z.setWebviewPointerEvents(!0,this.context.document),this.props.onDragEnd()};onDragEnter=e=>{this.props.supportDrop&&(this.#i=this.props.supportDrop(this.props.treeItem,e))};onDrop=e=>{e.preventDefault(),e.stopPropagation(),!0===this.#i.available&&this.props.onDrop(this.props.treeItem,this.#i,e)};onDragOver=e=>{const{onDragOver:t,treeItem:n,index:s}=this.props;e.stopPropagation(),!0===this.#i.available&&t&&(e.preventDefault(),e.nativeEvent.dataTransfer.dropEffect="move",t(n,s,this.#i,e))};onDragLeave=e=>{e.preventDefault(),e.stopPropagation(),this.props.onDragLeave&&!0===this.#i.available&&this.props.onDragLeave(this.props.treeItem,e)};onMouseDown=e=>{const t=!this.props.isDraggable&&void 0===this.props.inlineEditText;this.props.onMouseDown(this.props.treeItem,t,e)};onMouseUp=e=>{this.props.onMouseUp(this.props.treeItem,e),0===e.buttons&&this.#o&&this.onDragEnd(e)};onExpandClick=e=>{if(this.props.treeItem.children&&this.props.treeItem.children.length>0){const t=e.altKey;this.props.toggle(this.props.treeItem.id,t),e.preventDefault(),e.stopPropagation()}};render(){const{Component:e,componentProps:t}=this.props,n=!!this.props.isSeparator&&this.props.isSeparator(this.props.treeItem),s=this.props.selected,i=this.props.dragOverObj.id===this.props.treeItem.id,o=this.props.dragOverObj.position;return $i("div",{style:this.props.style,"data-id":this.props.treeItem.id,className:"tree-item","data-selected":s?"":null,"data-lead":this.props.lead?"":null,"data-cut":this.props.isCut?"":null,"data-expanded":this.props.isExpanded?"":null,onDragEnter:this.props.enableDragAndDrop?this.onDragEnter:null,onDragOver:this.props.enableDragAndDrop?this.onDragOver:null,onDragLeave:this.props.enableDragAndDrop?this.onDragLeave:null,onDrop:this.props.enableDragAndDrop?this.onDrop:null,onContextMenu:this.props.onContextMenu},void 0,$i("div",{className:As()("tree-row",{folder:this.isFolder(),"tree-row-selected":s,"tree-row-selected--first":this.props.isFirstSelected,"tree-row-selected--last":this.props.isLastSelected,dragover:i&&"on"===o,dragoverAbove:i&&"above"===o,dragoverBelow:i&&"below"===o,"speeddial-folder":this.isFolder()&&this.props.treeItem.speeddial}),"data-separator":n?"":null,"data-selected":s?"":null,"data-nofocus":s&&!this.props.hasFocus?"":null,onClick:this.onClick,onDoubleClick:this.onDoubleClick,onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,draggable:this.props.isDraggable,onDragStart:this.props.enableDragAndDrop?this.onDragStart:null,onDragEnd:this.props.enableDragAndDrop?this.onDragEnd:null},void 0,(0,fs.jsx)(e,{...t})))}}const Yi=ji;var Xi=n(93974),Qi=n(47380),qi=n(84847),Ji=n(42568),eo=n.n(Ji),to=n(81157),no=n(16152);const so=(e,t)=>{const n={...H.Z.get($.kAppearanceTreeColumnsEntries),[t]:e};Ne.Z.set($.kAppearanceTreeColumnsEntries,n)},io=()=>H.Z.get($.kAppearanceTreeColumnsEntries),oo=e=>e.filter((e=>e.visible)).reduce(((e,t)=>(e.push({id:t.value,width:t.width||100,key:t.key}),e)),[]),ao=e=>e.map((e=>e.key?`minmax(${Math.min(e.width/2,100)}px, 1fr)`:`minmax(36px, ${e.width}px)`)).join(" ");var ro,lo=n(18337),co=n(721),ho=n(34155);function po(e,t,n,s){ro||(ro="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:ro,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const uo=24,go="F2",mo=16;function vo(e){e.target.select()}class fo extends hs.PureComponent{static contextType=xi.Z;static defaultProps={enableDragAndDrop:!0,rowHeight:uo,supportsCollapseAll:!0};emptyDragOverObj={id:-1,position:""};refTreeListEntries=hs.createRef();constructor(e){super(e);const t=this.setupExpandModel(e.nodes,!0),{multiSelect:n}=e;this.selectionModel=new Bi(n),this.state={dragOverObj:this.emptyDragOverObj,hasFocus:!1,expandModel:t,renderArray:this.makeRenderArray(e.nodes,t,e.sorting),inlineEditId:-1,inlineEditText:"",width:0,height:("number"==typeof e.rowHeight?e.rowHeight:uo)*e.nodes.length,isDeleting:!1}}_dropSupport={available:!1,onto:!1,edge:"none"};_leftMouseTimeStamp=0;expandId=-1;_isMounted=!1;_hasCutCopyPasteListeners=!1;_isComposing=!1;_scrollTopNeedsUpdate=!1;_canCutCopyPaste=!1;resetSelectionModel=()=>{this.selectionModel.resetSelectionModel(),this.updateSelectionState()};updateSelectionState=e=>{this.forceUpdate(e)};SelectionMixinSelectAll=()=>{this.selectionModel.selectAll(this.getAllIds()),this.updateSelectionState()};SelectionMixinSetLead=e=>{this.selectionModel.setLeadIndex(e),this.updateSelectionState()};SelectionMixinSelectItem=(e,t,n,s,i)=>{this.selectionModel.setLeadIndex(e);const o=t;let a=this.selectionModel.isSelected(e);if(o||n)a=i||!a;else{if(i&&this.selectionModel.length>1)return;this.selectionModel.unSelectAll(),a=!0}if(n&&-1!==this.selectionModel.anchorIndex){const t=this.getSelectedIdsFromIdToAnchor(e);this.selectionModel.setSelectedIds(t)}else this.selectionModel.setIndexSelected(e,a);this.updateSelectionState()};getHeight=()=>this.state.height;getSelectedIdsFromIdToAnchor=e=>{const t=this.selectionModel.anchorIndex;return this.getIdsBetween(t,e)};_initializeSettings=e=>{if(!e.settings)return;this._expandSettings="EXPAND_"+e.settings,this._scrollTopSettings="SCROLL_TOP_"+e.settings,this._scrollTopNeedsUpdate=!0,this._searchStyleSettings="SEARCH_STYLE_"+e.settings,this._onRowsRenderedOptions="ON_ROWS_RENDERED_OPTIONS_"+e.settings;const t=this.setupExpandModel(e.nodes,!0);this.prepareDataForRender(e.nodes,t,e.sorting)};_updateSelectionStateIfNeeded=e=>{if(e.settings){this._selectionSettings="SELECTION_"+e.settings;const t=E.Z.getSync(this._selectionSettings);if(t){const n=this.getSelectedItem();this.selectionModel.setData(t),this.updateSelectionState((()=>{const{onSelect:t}=e;if(t){const e=this.getSelectedItem();let s=-1;!e||n&&e.id===n.id?n&&(s=n.id):(s=e.id,t(e)),ho.nextTick((()=>{-1!==s&&this.scrollToId(s)}))}}))}else if(e.autoFocus&&e.nodes.length>0){const t=e.nodes[0];-1!==t.id&&ho.nextTick((()=>this.selectByNode(t)))}else this.resetSelectionModel()}};componentDidMount(){const{selectionStoreKey:e}=this.props;if(e){if(Fi.Z.has(e))throw new Error(`Key ${e} has already been set in\n          SelectionStore. VivaldiTreeList expects instances using\n          selectionStoreKey props to be singleton.`);Fi.Z.set(e,this.selectionModel)}this._initializeSettings(this.props),this._updateSelectionStateIfNeeded(this.props),this._isMounted=!0;const t=this.getWrapper();if(t){t.addEventListener("focus",this.onGotFocus,!0);const e=t.parentElement;e&&this.updateTreeSize(e.clientWidth,e.clientHeight)}}UNSAFE_componentWillReceiveProps(e){if(this.props.multiSelect!==e.multiSelect&&(this.selectionModel.multiSelect=Boolean(e.multiSelect)),e.settings!==this.props.settings)this._initializeSettings(e),this._updateSelectionStateIfNeeded(e),this.updateScrollTop();else{const t=this.state.isDeleting?this.state.expandModel:this.setupExpandModel(e.nodes,!1);!0===this.state.isDeleting&&this.setState({isDeleting:!1}),this.prepareDataForRender(e.nodes,t,e.sorting)}}componentDidUpdate(e,t){if(this.state.renderArray.length===t.renderArray.length)this.rerenderVisibleTreeItems();else if(e.columns!==this.props.columns){(e.columns&&e.columns.flatMap((e=>e.id)).join())!==(this.props.columns&&this.props.columns.flatMap((e=>e.id)).join())&&this.rerenderVisibleTreeItems()}e.sorting?.sortOrder===this.props.sorting?.sortOrder&&e.sorting?.sortField===this.props.sorting?.sortField||this._scrollLeadNodeIntoView()}componentWillUnmount(){this.enableCutCopyPasteListeners(!1),this.stopInlineEditTimer(),this.resetAutoExpandTimer(),this._isMounted=!1;const e=this.getWrapper();e&&e.removeEventListener("focus",this.onGotFocus,!0);const{selectionStoreKey:t}=this.props;t&&Fi.Z.get(t)===this.selectionModel&&Fi.Z.delete(t)}getWrapper(){return this.refTreeListEntries.current?.Grid._scrollingContainer}focusTree=()=>{const e=this.getWrapper();e instanceof this.context.HTMLElement&&e.focus()};prepareDataForRender=(e,t,n)=>{const s=this.makeRenderArray(e,t,n);this.setState({renderArray:s,expandModel:t}),"function"==typeof this.props.rowHeight&&this.rerenderVisibleTreeItems()};setCutIds=e=>{this.props.setCutIds&&this.props.setCutIds(e)};onCut=e=>{if(e.preventDefault(),!this._canCutCopyPaste)return;const t=this.getAllSelectedItems();this.props.onCut?this.props.onCut(e,t):(this.setCutIds(t.map((e=>e.id))),this.setClipboard(e,t,!0))};onCopy=e=>{const{onCopy:t}=this.props;if(!this._canCutCopyPaste)return;const n=this.getAllSelectedItems();t?t(e,n):this.setClipboard(e,n,!1)};toggleSelectedExpansion=(e,t=!1)=>{this.stopInlineEditTimer();const n=e||this.selectionModel.leadIndex;if(-1===n)return;if(this.state.inlineEditId===n)return;const s=this.findTreeItem(n);s&&this.props.isFolder(s)&&(t&&this.props.hasChildren(s)?this.toggleExpandModelRecursively(s):this.toggleExpandModel(s.id))};expand=e=>{const t=this.findTreeItem(e);t&&this.props.isFolder(t)&&this._setExpandState(t,!0)};pruneExpandModel=()=>{this.setState((e=>{const t={...e.expandModel},n=e=>{e.children&&(0===e.children.length&&this._isModelExpanded(e.id,t)&&this._setExpandModelElement(t,e.id,!1),e.children.forEach(n))};return this.props.nodes.forEach(n),{expandModel:t}}))};toggleExpandModelRecursively(e){const t=e=>this.props.isFolder(e)&&this.props.hasChildren(e)?e.children.flatMap(t).concat(e.id):[],n=!this.isExpanded(e.id),s=t(e);this.setState((e=>{const t={...e.expandModel};return"custom"===this.props.folderMode||this.props.folderMode,s.forEach((e=>this._setExpandModelElement(t,e,n))),{expandModel:t}}),(()=>{this.saveExpandModel(this.state.expandModel),this.prepareDataForRender(this.props.nodes,this.state.expandModel,this.props.sorting)}))}_setExpandModelElement=(e,t,n)=>{switch(this.props.folderMode){case"custom":e[t]=n;break;case"expand":n?delete e[t]:e[t]=!1;break;default:n?e[t]=!0:delete e[t]}};toggleExpandModel=e=>{this.setState((t=>{const n={...t.expandModel};return"custom"===this.props.folderMode||"expand"===this.props.folderMode?this._setExpandModelElement(n,e,!1===n[e]):this._setExpandModelElement(n,e,void 0===n[e]),{expandModel:n}}),(()=>{this.saveExpandModel(this.state.expandModel),this.prepareDataForRender(this.props.nodes,this.state.expandModel,this.props.sorting)}))};saveExpandModel=e=>{if(this.props.settings){const t={};t[this._expandSettings]=e,E.Z.set(t)}};saveSelectionModel=()=>{if(this.props.settings){const e={};e[this._selectionSettings]=this.selectionModel.getData(),E.Z.set(e)}};_getRenderIndex=e=>this.state.renderArray.findIndex((t=>t.node.id===e));_scrollLeadNodeIntoView=()=>{const e=this._getRenderIndex(this.selectionModel.leadIndex);e>=0&&this.scrollIntoView(e)};resetExpandModel=(e,t)=>{const n={},s=e=>{this.props.isFolder(e)&&(n[e.id]=t),this.props.hasChildren(e)&&e.children.forEach(s)};return"custom"===this.props.folderMode?e.forEach(s):"expand"===this.props.folderMode?t||e.forEach(s):t&&e.forEach(s),n};collapseAll=()=>{const e=this.findTreeItem(this.selectionModel.leadIndex);let t=e;for(;t&&void 0!==t.parentId&&t.parentId!==this.props.rootId;)t=this.findTreeItem(t.parentId);const n=this.resetExpandModel(this.props.nodes,!1);this.saveExpandModel(n),this.prepareDataForRender(this.props.nodes,n,this.props.sorting),t&&t!==e?this.selectByNode(t):this._scrollLeadNodeIntoView()};setupExpandModel=(e,t)=>{let n=this.props.settings&&t?E.Z.getSync("EXPAND_"+this.props.settings)||{}:this.state?.expandModel||{};switch(this.props.folderMode){case"expand":case"collapse":{const s=this.resetExpandModel(e,"expand"===this.props.folderMode);n=t?Object.assign(s,n):Object.assign(s,this.state.expandModel||{});break}case"custom":this.props.setupExpandModel&&(n=this.props.setupExpandModel(n,e,t))}return n};getExpandModel=()=>this.state.expandModel;expandWithModel=e=>{this.saveExpandModel(e),this.prepareDataForRender(this.props.nodes,e,this.props.sorting),this._scrollLeadNodeIntoView()};expandAll=()=>{this.expandAllExcept([])};expandAllExcept=e=>{const t=this.resetExpandModel(this.props.nodes,!0);e.forEach((e=>{this._setExpandModelElement(t,e,!1)})),this.saveExpandModel(t),this.prepareDataForRender(this.props.nodes,t,this.props.sorting),this._scrollLeadNodeIntoView()};isExpanded=e=>this._isModelExpanded(e,this.state.expandModel);onImport=()=>{this.props.onImport&&this.props.onImport()};setClipboard=(e,t,n)=>{const{clipboardData:s}=e,{getDragData:i,mimeType:o}=this.props;if(!o||!i||!s||this.props.disableClipboard)return;const a=t.map((e=>e.id));s.setData("vivaldi/x-cut",n.toString()),s.setData(o,JSON.stringify(a)),s.setData("text/plain",i("text/plain",a));const r=this.selectionModel.leadIndex;-1!==r&&s.setData("text/html",i("text/html",[r])),(0,to.ZP)(e)};contextMenuSpy=e=>{this._canCutCopyPaste=!1;const t=this.getWrapper();let n=e.target;for(;n;){if(n===t){this._canCutCopyPaste=!0;break}n=n.parentNode}};keyDownSpy=e=>{this._canCutCopyPaste=!0};onPaste=e=>{if(e.preventDefault(),!this._canCutCopyPaste)return;const{mimeType:t,onPaste:n}=this.props;if(n){const t=this.getSelectedItem();return void(t&&n(e,t))}if(!t)return;const s=this.getTargetFromSelection(),i=e.clipboardData;if(!i)return;const o=-1!==i.types.findIndex((e=>e===t))?JSON.parse(i.getData(t)):[];if(0===o.length)return;if("true"===i.getData("vivaldi/x-cut")){if(!(this.props.cutIds&&this.props.cutIds.length>0)||!this.props.onMove)return;this.props.onMove(o,s,"on").then((e=>{const t=e??[];this.setCutIds([]),this.selectionModel.setSelectedIds(t);const{onSelect:n}=this.props;if(t.length>0&&n){const e=this.findTreeItem(t[0]);e&&n(e)}this.rerenderVisibleTreeItems()}))}else{const e=structuredClone(o.map((e=>this.findTreeItem(e))));this.props.onCreate&&this.props.onCreate(e,s.parentId,s.index,!1).then((e=>{const t=Array.isArray(e)?e:e?.items||[];Boolean(t)&&t.length>0&&(this.selectionModel.setSelectedIds(t.map((e=>e.id))),this.SelectionMixinSetLead(t[0].id),this.rerenderVisibleTreeItems())}))}};moveNode=(e,t)=>{if(this.props.onMove&&this.canMoveUpDown(e,t)){const n={parentId:e.parentId,index:t?e.index-1:e.index+2,pageIndex:void 0},s=t?"above":"below";this.props.onMove([e.id],n,s)}};canMoveUpDown=(e,t)=>{if(!0===t&&0===e.index)return!1;if(!1===t){let t=0;if(e.parentId===this.props.rootId)t=this.props.nodes.length,t>0&&this._isTrashFolder(this.props.nodes[t-1])&&t--;else{const n=this.findTreeItem(e.parentId);n&&n.children&&(t=n.children.length)}if(e.index+1>=t)return!1}const n=!!this.props.sorting&&this.props.sorting.sortOrder!==Xi.Z.NO_SORTING,s=!this.props.supportsUpDownMove||this.props.supportsUpDownMove(e,t);return!n&&s};getKeyEventMap=()=>({esc:this.onKeyEscUp,up:this.onKeyArrowUp,down:this.onKeyArrowDown,"alt+up":this.onKeyArrowUp,"alt+down":this.onKeyArrowDown,left:this._collapseFolderOrSelectParent,right:this._expandFolder,del:this.onKeyDelete,home:this.onKeyHome,end:this.onKeyEnd,pageup:this.onKeyPageUp,pagedown:this.onKeyPageDown,"shift+del":this.onKeyShiftDelete,"shift+up":this.onKeyArrowUp,"shift+down":this.onKeyArrowDown,"shift+home":this.onKeyHome,"shift+end":this.onKeyEnd,"shift+pageup":this.onKeyPageUp,"shift+pagedown":this.onKeyPageDown,"ctrl+a":this.onKeySelectAll,"ctrl+left":this._collapseFolderOrSelectParent,"ctrl+right":this._expandFolder,"ctrl+space":this.onKeyCtrlSpace,"ctrl+up":this.onKeyCtrlUp,"ctrl+down":this.onKeyCtrlDown});enableCutCopyPasteListeners=e=>{if(this._canCutCopyPaste=e,this._hasCutCopyPasteListeners!==e){this._hasCutCopyPasteListeners=e;const{document:t}=this.context;this._hasCutCopyPasteListeners?(t.addEventListener("cut",this.onCut),t.addEventListener("copy",this.onCopy),t.addEventListener("paste",this.onPaste),t.addEventListener("contextmenu",this.contextMenuSpy),t.addEventListener("keydown",this.keyDownSpy)):(t.removeEventListener("cut",this.onCut),t.removeEventListener("copy",this.onCopy),t.removeEventListener("paste",this.onPaste),t.removeEventListener("contextmenu",this.contextMenuSpy),t.removeEventListener("keydown",this.keyDownSpy))}};onLostFocus=()=>{this.stopInlineEditTimer(),this.enableCutCopyPasteListeners(!1),this.setState({hasFocus:!1})};onGotFocus=()=>{if(-1===this.state.inlineEditId){let e=this.getSelectedItem();e&&-1===this._getRenderIndex(e.id)&&(e=void 0),this.props.autoFocus&&!e&&this.state.renderArray.length>0&&this.selectByNode(this.state.renderArray[0].node),this.enableCutCopyPasteListeners(!0),this.setState({hasFocus:!0})}};scrollIntoView=e=>{this.refTreeListEntries.current?.scrollToRow(e)};setSelectedIds=e=>{this.selectionModel.resetSelectionModel(),this.selectionModel.selectAll(e),this.saveSelectionModel(),this.updateSelectionState()};selectByIndex=e=>{this.state.renderArray.length>e&&this.selectByNode(this.state.renderArray[e].node)};selectById=(e,t,n)=>{const s=this.props.onSelect?this.findTreeItem(e):{id:e};this.selectByNode(s,t,n)};selectByNode=(e,t,n)=>{const s=e?e.id:-1;this.props.onSelect&&(e&&this.selectionModel.FirstSingleItemSelected===e.id||this.props.onSelect(e)),n||(n=this._getRenderIndex(s)),-1!==n&&this.scrollIntoView(n),t?this.SelectionMixinSelectItem(s,t.ctrlKey,t.shiftKey,t.metaKey,"contextmenu"===t.type):this.SelectionMixinSelectItem(s),this.saveSelectionModel()};scrollToId=e=>{this.scrollIntoView(this._getRenderIndex(e))};onItemClick=(e,t)=>{t.stopPropagation(),this.props.onItemClick&&this.props.onItemClick(t,e)};onItemDoubleClick=(e,t)=>{if(this.stopInlineEditTimer(),this.props.onItemDoubleClick){!(this.props.overrideDoubleClick&&this.props.overrideDoubleClick(e))&&this.props.isFolder(e)||this.props.onItemDoubleClick(t,e)}};onItemMouseDown=(e,t,n)=>{if(Hi.Z.isNavigationButton(n.button))return;const s=this.selectionModel.selectedIds;let i=!1;for(const t of s)if(t.id===e.id){i=!0;break}this.state.hasFocus&&i&&1===s.length&&n.button===Hi.Z.kLeft&&!(0,qi.Z)(n)&&n.target instanceof this.context.HTMLElement&&"title"===n.target.className&&n.timeStamp-this._leftMouseTimeStamp>300?this.startInlineEditTimerForId(e.id):this.stopInlineEditTimer();const o=n.ctrlKey;i&&!o||(i&&o&&1===s.length?this.unSelectAll():this.selectByNode(e,n)),"function"==typeof this.props.onItemMouseDown&&this.props.onItemMouseDown(e,n),n.button===Hi.Z.kLeft&&(this._leftMouseTimeStamp=n.timeStamp),t&&this.focusTree()};onItemMouseUp=(e,t)=>{if(Hi.Z.isNavigationButton(t.button))return;const n=this.selectionModel.selectedIds,s=t.ctrlKey;n.length>1&&t.button!==Hi.Z.kRight&&!s&&this.selectByNode(e,t),this.props.onItemMouseUp?.(e,t)};onContextMenuOpen=(e,t)=>{t&&this.scrollIntoView(this._getRenderIndex(t.id))};rerenderVisibleTreeItems=()=>{this.refTreeListEntries.current?.recomputeRowHeights()};getParentAndIndex=(e,t)=>{let n,s;if(e)if(this.props.isFolder(e))n=e.id,!this.isExpanded(e.id)&&t&&this.toggleExpandModel(e.id);else{n=e.parentId;const{id:t}=e;if(n===this.props.rootId)this.props.nodes&&(s=this.props.nodes.findIndex((e=>e.id===t))+1);else{const e=this.findTreeItem(n);e&&e.children&&(s=e.children.findIndex((e=>e.id===t))+1)}}else n=this.props.rootId;return{parentId:n,index:s,pageIndex:void 0}};getTargetFromSelection=()=>{const e=this.selectionModel.FirstSingleItemSelected;let t;return e&&-1!==e&&(t=this.findTreeItem(e),this.props.isValidAddTarget&&!this.props.isValidAddTarget(t)&&(t=void 0)),this.getParentAndIndex(t,!0)};onAdd=async(e,t)=>{const n=this.props.buildItem?this.props.buildItem(e,t):{...t,children:"folder"===e?[]:void 0,separator:"separator"===e},{parentId:s,index:i}=this.getTargetFromSelection();if(!this.props.onCreate)return;const o=await this.props.onCreate([n],s,i,!0);if(!o)return;const a=Array.isArray(o)?o:o.items,r=Boolean(!Array.isArray(o)&&o.props?.edit);if(1!==a.length)return;const[l]=a;this.getSelectedId()!==l.id&&this.selectByNode(l),r&&this.startInlineEdit(l.id)};onSave=()=>{const{onSave:e}=this.props;e&&e(this.getAllSelectedItems().map((e=>e.id)))};onSaveAll=()=>{this.props.onSave&&this.props.onSave([])};onExport=()=>{const{onExport:e}=this.props;e&&e(this.getAllSelectedItems().map((e=>e.id)))};onExportAll=()=>{this.props.onExport&&this.props.onExport([])};onDelete=e=>{let t=this.getAllSelectedItems().map((e=>e.id));if(this.props.validateForDeletion&&(t=this.props.validateForDeletion(t)),t.length>0){if(!this.props.confirmDelete)return this.setState({isDeleting:!0}),this.onDeleteItems(t,e);this.props.confirmDelete(t).then((n=>{if(n)return this.setState({isDeleting:!0}),this.onDeleteItems(t,e)}))}return Promise.resolve()};onDeleteItems=(e,t)=>{if(e&&e.length>0){let n=-1;const s=this.selectionModel.selectedIds;for(const e of s){const t=this._getRenderIndex(e.id);(-1===n||t<n)&&(n=t)}n<0&&(n=0);const i=this.state.renderArray[n].node;if(!this.props.delete)return Promise.resolve();let o=void 0!==i.parentId?this.findTreeItem(i.parentId):void 0;const a=e=>{this.selectByNode(e),e&&this.props.activateAfterDelete&&this.props.activateAfterDelete(e)};return this.props.delete(e,t).then((()=>{if(this.props.disableSelectAfterDelete)return;const t=this.state.renderArray.filter((t=>!e.includes(t.node.id)));if(0===t.length)a(void 0);else if(o)if(this.props.hasChildren(o)&&(o={...o},o.children=o.children.filter((t=>!e.includes(t.id))),o.children=this.sortItems(o.children,this.props.sorting)),this.props.hasChildren(o)){const e=o.children;if(1===e.length)a(e[0]);else{const s=e[0],i=e[e.length-1],o=this._getRenderIndex(s.id),r=this._getRenderIndex(i.id);if(n<=o)a(s);else if(n>=r)a(i);else{let s=0;if(r-o+1>e.length){const e=n-o;for(let n=0;n<e;n++){const e=t[o+n].node;this.props.hasChildren(e)&&this.isExpanded(e.id)&&(s-=e.children.length)}}const i=e[n-o+s];a(i)}}}else a(o);else{let e=this.state.renderArray.filter((e=>e.node.parentId===this.props.rootId||this._isTrashFolder(e.node)));const s=e.findIndex((e=>e.node.id===i.id));if(s>=0){e=t.filter((e=>e.node.parentId===this.props.rootId||this._isTrashFolder(e.node)));const n=e.length-1,i=e[Math.min(s,n)];a(i.node)}else{const e=t.length-1,s=t[Math.min(n,e)];a(s.node)}}})).catch((()=>{}))}return Promise.resolve()};onKeyCtrlUp=Wi.throttleSync((e=>{const t=this.selectionModel.leadIndex,n=this._getRenderIndex(t);if(0===n)return;const s=-1===n?this.state.renderArray.length-1:n-1;if(s<0)return;const i=this.state.renderArray[s].node;this.SelectionMixinSetLead(i.id),this.scrollIntoView(s)}));onKeyCtrlDown=Wi.throttleSync((e=>{const t=this.selectionModel.leadIndex,n=this._getRenderIndex(t);if(n===this.state.renderArray.length-1)return;const s=n+1,i=this.state.renderArray[s].node;this.SelectionMixinSetLead(i.id),this.scrollIntoView(s)}));onKeyArrowDown=Wi.throttleSync((e=>{const t=this.selectionModel.leadIndex,n=this._getRenderIndex(t);if(n!==this.state.renderArray.length-1){if(!0===e.altKey)this.moveNode(this.state.renderArray[n].node,!1);else{const t=n+1,s=this.state.renderArray[t].node;this.selectByNode(s,e,t)}e.preventDefault(),e.stopPropagation()}}));onKeyArrowUp=Wi.throttleSync((e=>{const t=this.selectionModel.leadIndex,n=this._getRenderIndex(t);if(0!==n){if(!0===e.altKey)this.moveNode(this.state.renderArray[n].node,!0);else{const t=-1===n?this.state.renderArray.length-1:n-1;if(t<0)return;const s=this.state.renderArray[t].node;this.selectByNode(s,e,t)}e.preventDefault(),e.stopPropagation()}}));onKeyEscUp=e=>{this.selectionModel.setSelectedIds([])};onKeyHome=e=>{const t=this.state.renderArray[0].node;this.selectByNode(t,e,0),e.preventDefault(),e.stopPropagation()};onKeyEnd=e=>{const t=this.state.renderArray.length,n=this.state.renderArray[t-1].node;this.selectByNode(n,e,t-1),e.preventDefault(),e.stopPropagation()};onKeyPageDown=Wi.throttleSync((e=>{const t=this.selectionModel.leadIndex,n=this._getRenderIndex(t),s=this.state.renderArray.length;let i=this.state.height,o=n;for(;o<s-1;){const e="function"==typeof this.props.rowHeight?this.props.rowHeight({index:o}):this.props.rowHeight||uo;if(!(i>=e))break;i-=e,o++}if(o===n)return;const a=this.state.renderArray[o].node;this.selectByNode(a,e,o),e.preventDefault(),e.stopPropagation()}));onKeyPageUp=Wi.throttleSync((e=>{const t=this.selectionModel.leadIndex,n=this._getRenderIndex(t);let s=this.state.height,i=n;for(;i>0;){const e="function"==typeof this.props.rowHeight?this.props.rowHeight({index:i}):this.props.rowHeight||uo;if(!(s>=e))break;s-=e,i--}if(i===n)return;const o=this.state.renderArray[i].node;this.selectByNode(o,e,i),e.preventDefault(),e.stopPropagation()}));handleKeyDelete=(e,t)=>{this.onDelete(t),e.preventDefault(),e.stopPropagation()};onKeyShiftDelete=e=>{this.handleKeyDelete(e,!0)};onKeyDelete=e=>{this.handleKeyDelete(e,!1)};onKeySelectAll=()=>{this.SelectionMixinSelectAll(),this.saveSelectionModel()};onKeyCtrlSpace=e=>{const t=this.selectionModel.leadIndex;this.SelectionMixinSelectItem(t,e.ctrlKey,e.shiftKey,e.metaKey,"contextmenu"===e.type)};_setExpandState=(e,t)=>{t!==this.isExpanded(e.id)&&this.toggleExpandModel(e.id)};_collapseFolderOrSelectParent=e=>{const t=this.findTreeItem(this.getSelectedId());if(t)if(this._isFolderWithChildren(t)&&this.isExpanded(t.id))this._setExpandState(t,!1);else{const e=this.findTreeItem(t.parentId);e&&this.selectByNode(e)}e.preventDefault(),e.stopPropagation()};expandToId=e=>{let t=this.findTreeItem(e);for(;t;)t=this.findTreeItem(t.parentId),t&&this.isFolder(t)&&this._setExpandState(t,!0)};_expandFolder=e=>{const t=this.findTreeItem(this.getSelectedId());t&&this._isFolderWithChildren(t)&&this._setExpandState(t,!0),e.preventDefault(),e.stopPropagation()};unSelectAll=()=>{this.selectByNode(void 0)};isItemLead=e=>e===this.selectionModel.leadIndex;isItemSelected=e=>this.selectionModel.isSelected(e);supportDropForItem=(e,t)=>this.props.getDropSupport?this.props.getDropSupport(e,t):{available:!1,onto:!1,edge:"none"};onDragLeaveItem=(e,t)=>{this.cancelDragOverObject(),this.resetAutoExpandTimer()};onDragOverItem=(e,t,n,s)=>{const i=s.currentTarget;if(!this.supportDropForItem(e,s).available)return;const o=i.getBoundingClientRect(),a="function"==typeof this.props.rowHeight?this.props.rowHeight({index:t}):this.props.rowHeight||uo,r=(s.clientY-o.top)/a;let l="";const d="both"===n.edge||"above"===n.edge,c="both"===n.edge||"below"===n.edge;!0===n.onto?l=r<=.25?d?"above":"on":r>.75&&c?"below":"on":r<=.5&&d?l="above":r>.5&&c&&(l="below"),(this.state.dragOverObj.id!==e.id||this.state.dragOverObj.id===e.id&&this.state.dragOverObj.position!==l)&&this.setState({dragOverObj:{id:e.id,position:l}},this.initAutoExpandTimer(e,l))};initAutoExpandTimer=(e,t)=>{this.isExpanded(e.id)||!this.props.isFolder(e)||"on"!==t?this.resetAutoExpandTimer():this.expandId!==e.id&&(this.resetAutoExpandTimer(),this.expandId=e.id,this.expandTimer=setTimeout(this.onAutoExpandTimer,1200))};resetAutoExpandTimer=()=>{this.expandTimer&&(clearTimeout(this.expandTimer),this.expandId=-1)};onAutoExpandTimer=()=>{-1!==this.expandId&&(this.state.dragOverObj.id===this.expandId&&"on"===this.state.dragOverObj.position&&this.toggleExpandModel(this.expandId),this.resetAutoExpandTimer())};onDragEmptyArea=e=>{if(this.state.renderArray.length>0){const t=this.state.renderArray[this.state.renderArray.length-1].node;this._dropSupport=this.supportDropForItem(t,e),this._dropSupport.available&&"none"!==this._dropSupport.edge&&(e.preventDefault(),e.nativeEvent.dataTransfer.dropEffect="move",this.state.dragOverObj.id!==t.id&&"below"!==this.state.dragOverObj.position&&this.setState({dragOverObj:{id:t.id,position:"below"}}))}e.stopPropagation()};onDropEmptyArea=e=>{if(this.resetAutoExpandTimer(),this.state.renderArray.length>0&&this._dropSupport.available){const t=this.state.renderArray[this.state.renderArray.length-1].node;this.onDrop(t,this._dropSupport,e),this._dropSupport={available:!1,onto:!1,edge:"none"}}e.preventDefault(),e.stopPropagation()};onDrop=(e,t,n)=>{this.resetAutoExpandTimer();const s=Ds.ZP.isCopyModifierPressed(n),i=this.state.dragOverObj.position,{mimeType:o}=this.props;switch(i){case"above":if("both"!==t.edge&&"above"!==t.edge)return void this.cancelDragOverObject();break;case"below":if("both"!==t.edge&&"below"!==t.edge)return void this.cancelDragOverObject();break;case"on":if(!1===t.onto)return void this.cancelDragOverObject();break;default:return void this.cancelDragOverObject()}let a;if(o&&n.dataTransfer&&-1!==n.dataTransfer.types.findIndex((e=>e===o))?a=JSON.parse(n.dataTransfer.getData(o)):this.props.onDrop&&this.props.onDrop(n,e,i).then((e=>{this.cancelDragOverObject(),e&&e.length>0&&this.selectByNode(e[0])})),!a||a.length<=0)return void this.cancelDragOverObject();const r=this.props.isFolder(e);let l=!1,d={index:0,parentId:void 0,pageIndex:void 0};this.props.getTargetSpec?d=this.props.getTargetSpec(e,i):"above"===i?(d.index=parseInt(e.index),d.parentId=e.parentId):"on"===i?d.parentId=r?e.id:e.parentId:"below"===i&&(r&&this.isExpanded(e.id)?d.parentId=e.id:(d.index=parseInt(e.index)+1,d.parentId=e.parentId));const c=a.map((t=>{if(t===e.id)return void(l=!0);const n=this.findTreeItem(t);if(s||!this.props.isFolder(n)||!n||!this.findItemInFolder(n,e.id))return n;l=!0})).filter((e=>null!==e));if(l||c.length<=0)this.cancelDragOverObject();else if(s){const e=structuredClone(c);this.props.onCreate&&this.props.onCreate(e,d.parentId,d.index,!1).then(this.cancelDragOverObject())}else{const e=c.map((e=>e.id));this.props.onMove?.(e,d,i).then((()=>{this.cancelDragOverObject()}))}};cancelDragOverObject=()=>{this.setState({dragOverObj:this.emptyDragOverObj})};onDragEndItem=()=>{this.cancelDragOverObject()};onCompositionStart=()=>{this._isComposing=!0};onCompositionEnd=()=>{this._isComposing=!1};onKeyDown=async e=>{const{ctrlKey:t,altKey:n,shiftKey:s,metaKey:i}=e,o={ctrlKey:t,altKey:n,shiftKey:s,metaKey:i},a=(0,co.VV)(o);if(this.stopInlineEditTimer(),-1!==this.state.inlineEditId)return void("Escape"===e.key&&a?(e.preventDefault(),await this.cancelInlineEdit(),this.focusTree()):"Enter"!==e.key||this._isComposing?e.key===go&&e.preventDefault():(e.preventDefault(),await this.saveInlineEdit(),this.focusTree()));if("Escape"===e.key&&a)this.setCutIds([]),e.preventDefault();else if("\\"===e.key&&a&&this.props.supportsCollapseAll)this.collapseAll();else if(this.props.supportsInlineEdit&&e.key===go){const t=!0===this.props.supportsInlineEdit?this.getSelectedItem():void 0;if(t){return void(this.startInlineEdit(t.id)&&e.preventDefault())}}let r=!1;if(this.props.onItemsActivated&&"Enter"===e.key){if(!1===e.repeat){const t=this.getAllSelectedItems();t&&this.props.onItemsActivated&&this.props.onItemsActivated(e,t)}r=!0,e.preventDefault()}var l=Di.Z.keyComboFromEvent(e.nativeEvent),d=this.getKeyEventMap()[l];d&&d(e.nativeEvent),!r&&this.props.onKeyDown&&this.props.onKeyDown(e)};startInlineEditTimerForId=e=>{this.stopInlineEditTimer(),!0===this.props.supportsInlineEdit&&(this.inlineEditTimeoutId=setTimeout(this.startInlineEdit.bind(this,e),700))};stopInlineEditTimer=()=>{-1!==this.inlineEditTimeoutId&&clearTimeout(this.inlineEditTimeoutId)};startInlineEditForSelectedItem=()=>{const e=this.selectionModel.FirstSingleItemSelected;-1!==e&&this.startInlineEdit(e)};startInlineEdit=e=>{const t=this.selectionModel.selectedIds;if(1===t.length&&t[0].id===e){const t=this.state.renderArray.filter((t=>t.node.id===e));if(1===t.length&&this.props.isValidToEdit?.(t[0].node.id))return this.setState({inlineEditId:e,inlineEditText:this.props.getTitle?this.props.getTitle(e):""}),!0}return!1};getInlineEditId=()=>-1===this.state.inlineEditId?void 0:this.state.inlineEditId;setInlineEditText=e=>{const t=e.target.value;this.setState({inlineEditText:t})};cancelInlineEdit=()=>new Promise((e=>{this.setState({inlineEditId:-1,inlineEditText:""},e)}));saveInlineEdit=()=>new Promise(((e,t)=>{if(-1===this.state.inlineEditId||!this.props.saveTitle)return t();this.props.saveTitle(this.state.inlineEditId,this.state.inlineEditText),this.setState({inlineEditId:-1,inlineEditText:""},e)}));onRowsRendered=e=>{this.props.onRowsRendered&&(this.props.onRowsRendered(e),E.Z.set({[this._onRowsRenderedOptions]:e})),this.updateScrollTop()};updateScrollTop=()=>{if(this._scrollTopNeedsUpdate){this._scrollTopNeedsUpdate=!1;const e=E.Z.getSync(this._scrollTopSettings);this.refTreeListEntries.current?.scrollToPosition(e)}};onScroll=(0,no.Z)((e=>{const{scrollTop:t}=e;this._scrollTopSettings&&E.Z.set({[this._scrollTopSettings]:t})}),500);getSelectedItem=()=>this.findTreeItem(this.selectionModel.leadIndex);getSelectedId=()=>this.selectionModel.FirstSingleItemSelected;isFolder=e=>Boolean(e&&this.props.isFolder(e));_isTrashFolder=e=>this.props.isTrashFolder?this.props.isTrashFolder(e):!0===e.trash;_isFolderWithChildren=e=>e.children&&e.children.length>0;_isModelExpanded=(e,t)=>"0"===e||!0===t[e]||"expand"===this.props.folderMode&&void 0===t[e];makeRenderArray=(e,t,n)=>{const s=[];if(!e||0===e.length)return s;e=this.sortItems(e,n);const i=n&&n.sortOrder!==Xi.Z.NO_SORTING,o=(e,n)=>{if(!(i&&this.props.isSeparator&&this.props.isSeparator(e))&&(s.push({node:e,level:n}),this.props.hasChildren(e)&&this._isModelExpanded(e.id,t)))for(const t of e.children)o(t,n+1)};for(const t of e)o(t,0);return s};canSort=e=>Boolean(e&&e.sortOrder&&e.sortOrder!==Xi.Z.NO_SORTING);sortItems=(e,t)=>{if(!t||!this.canSort(t)||t?.onlyScroll)return e;!1!==this.props.supportsDeepCopy&&(e=structuredClone(e));const n=t.comparator||Xi.Z.getDefaultComparator(t.sortOrder,t.sortField);return Xi.Z.treeSort(e,n),e};getSelectedFromTree=()=>{const e=[],t=function(n,s){for(let i=0;i<s.length;i++){const o=s[i];n.selectionModel.isSelected(o.id)?e.push(o):o.children&&t(n,o.children)}};return t(this,this.props.nodes),e};getAllSelectedItems=()=>{const e=this.selectionModel.selectedIds;if(0===e.length)return e;if(e.length>1&&!this.canSort(this.props.sorting))return this.getSelectedFromTree();const t=function(e,n){for(let s=0;s<e.length;s++){let i=e[s];if(i.id===n)return i;if(i.children&&(i=t(i.children,n),i))return i}},n=e.map((e=>t(this.props.nodes,e.id))).filter((e=>void 0!==e));return this.sortItems(n,this.props.sorting)};findTreeItem=e=>{function t(n){if(n.id===e)return n;if(n.children)for(let e=0;e<n.children.length;e++){const s=t(n.children[e]);if(s)return s}}for(let e=0;e<this.props.nodes.length;e++){const n=t(this.props.nodes[e]);if(n)return n}return null};findItemInFolder=(e,t)=>{let n=null;const s=e=>{if(e.id===t)return n=e;e.children&&e.children.forEach(s)};return e.children.forEach(s),n};getIdsBetween=(e,t)=>{const n=this._getRenderIndex(e),s=this._getRenderIndex(t);let i=[];return i=n>s?this.state.renderArray.slice(s,n+1):this.state.renderArray.slice(n,s+1),i.map((e=>e.node.id))};getAllIds=()=>this.state.renderArray.map(((e,t)=>e.node.id||t));getRenderArray=()=>this.state.renderArray;getId=e=>this.state.renderArray[e].node.id||e;getSearchStyle=()=>"flat"===E.Z.getSync(this._searchStyleSettings)?"flat":"tree";setSearchStyle=e=>{const t={};t[this._searchStyleSettings]=e,E.Z.set(t,(()=>{this.props.onSearchStyleChanged&&this.props.onSearchStyleChanged(e)}))};getNamedContextMenuItems=(e,t)=>{const n=this.context.vivaldiWindowId,s=Pi.getOptionFunction(e.name),{document:i}=this.context,o={selectedCount:this.getAllSelectedItems().length,...e.getState?e.getState(t):{}};return Pi.getNamedMenu(n,e.name,(async a=>{switch(a.action){case"CONTEXT_EXPAND_ALL":return{handler:this.expandAll,isVisible:()=>e.getVisibility(a,t),...s(n,a,o)};case"CONTEXT_COLLAPSE_ALL":return{handler:this.collapseAll,...s(n,a,o),isVisible:()=>e.getVisibility(a,t)};case"CONTEXT_NEW_ITEM":return{handler:()=>{this.onAdd("item")},isVisible:()=>e.getVisibility(a,t),...s(n,a,o)};case"CONTEXT_NEW_FOLDER":return{handler:()=>{this.onAdd("folder")},isVisible:()=>e.getVisibility(a,t),...s(n,a,o)};case"CONTEXT_NEW_SEPARATOR":return{handler:()=>{this.onAdd("separator")},isVisible:()=>e.getVisibility(a,t),...s(n,a,o)};case"CONTEXT_EDIT":return{handler:()=>{this.props.onEdit?.()},isVisible:()=>e.getVisibility(a,t)&&"function"==typeof this.props.onEdit,...s(n,a,o)};case"CONTEXT_RENAME":return{handler:()=>{this.startInlineEditForSelectedItem()},isVisible:()=>e.getVisibility(a,t),...s(n,a,o),shortcuts:[go]};case"CONTEXT_CUT":return{handler:()=>{i.execCommand("cut")},isVisible:()=>e.getVisibility(a,t),...s(n,a,o),shortcuts:["ctrl+x"]};case"CONTEXT_COPY":return{handler:()=>{i.execCommand("copy")},isVisible:()=>e.getVisibility(a,t),...s(n,a,o),shortcuts:["ctrl+c"]};case"CONTEXT_PASTE":return{handler:()=>{i.execCommand("paste")},isVisible:()=>e.getVisibility(a,t),...s(n,a,o),shortcuts:["ctrl+v"]};case"CONTEXT_SAVE":return{handler:()=>{this.onSave()},isVisible:()=>e.getVisibility(a,t),...s(n,a,o)};case"CONTEXT_SAVE_ALL":return{handler:()=>{this.onSaveAll()},isVisible:()=>e.getVisibility(a,t),...s(n,a,o)};case"CONTEXT_EXPORT":return{handler:()=>{this.onExport()},isVisible:()=>e.getVisibility(a,t),...s(n,a,o)};case"CONTEXT_EXPORT_ALL":return{handler:()=>{this.onExportAll()},isVisible:()=>e.getVisibility(a,t),...s(n,a,o)};case"CONTEXT_DELETE":return{handler:()=>{this.onDelete(!1)},isVisible:()=>e.getVisibility(a,t),...s(n,a,o),shortcuts:["delete"]};case"CONTEXT_IMPORT":return{handler:()=>{this.onImport()},isVisible:()=>e.getVisibility(a,t),...s(n,a,o)};case"CONTEXT_CONTAINER_SEARCH":{const i=this.getSearchStyle();return{items:[{type:"radio",radiogroup:1,checked:"flat"===i,handler:this.setSearchStyle.bind(this,"flat"),...(0,xs.Z)("Flat Search")},{type:"radio",radiogroup:1,checked:"tree"===i,handler:this.setSearchStyle.bind(this,"tree"),...(0,xs.Z)("Tree Search")}],isVisible:()=>e.getVisibility(a,t),...s(n,a,o)}}default:return e.getCapability(a,s,t,o)}}))};getContextMenuItemsPromise=e=>this.props.getContextMenuItemsPromise?this.props.getContextMenuItemsPromise(e).then((t=>this.appendStandardMenuItems(e,t))):Promise.resolve([]);getContextMenuItems=e=>{if(!0===this.props.appendContextItems){let t=this.appendStandardMenuItems(e,[]);const n=this.props.getContextMenuItems?this.props.getContextMenuItems(e):[];return t.length>0&&n.length>0&&(t=t.concat([ae.Z.separatorItem]),t=t.concat(n)),t}{const t=this.props.getContextMenuItems?this.props.getContextMenuItems(e):[];return this.appendStandardMenuItems(e,t)}};appendStandardMenuItems=(e,t)=>{const n=this.props.getContextMenuItemProps?this.props.getContextMenuItemProps(e):{},s=()=>{t.length>0&&t.push(ae.Z.separatorItem)};if((n.showNewItem||n.showNewFolder||n.showNewSeparator||n.showEdit||n.showMoveUp||n.showMoveDown||n.showRename)&&(s(),n.showNewItem&&t.push({handler:()=>{this.onAdd("item")},isVisible:()=>n.showNewItem,...this.props.getContextMenuNewItemString?this.props.getContextMenuNewItemString():ae.Z.makeLabelPair("")}),n.showNewFolder&&t.push({handler:()=>{this.onAdd("folder")},isVisible:()=>n.showNewFolder,...(0,xs.Z)("command","New Folder")}),n.showNewSeparator&&t.push({handler:()=>{this.onAdd("separator")},isVisible:()=>n.showNewSeparator,...(0,xs.Z)("New Separator")}),(n.showEdit||n.showRename)&&s(),n.showEdit&&t.push({handler:()=>{this.props.onEdit&&this.props.onEdit()},isVisible:()=>n.showEdit,...(0,xs.Z)("verb","Edit")}),n.showRename&&t.push({handler:()=>this.startInlineEditForSelectedItem(),isVisible:()=>n.showRename,shortcuts:[go],...(0,xs.Z)("Rename")}),(n.showMoveUp||n.showMoveDown)&&(s(),t.push({handler:()=>{const e=this.getSelectedItem();e&&this.moveNode(e,!0)},isVisible:()=>n.showMoveUp,shortcuts:["alt+up"],...(0,xs.Z)("Move Up")}),t.push({handler:()=>{const e=this.getSelectedItem();e&&this.moveNode(e,!1)},isVisible:()=>n.showMoveDown,shortcuts:["alt+down"],...(0,xs.Z)("Move Down")}))),n.showCut||n.showCopy||n.showPaste){s();const{document:e}=this.context;t=t.concat([{handler:()=>{e.execCommand("cut")},isVisible:()=>!0===n.showCut,shortcuts:["ctrl+x"],...(0,xs.Z)("verb","Cut")},{handler:()=>{e.execCommand("copy")},isVisible:()=>!0===n.showCopy,shortcuts:["ctrl+c"],...this.props.getContextMenuCopyString?this.props.getContextMenuCopyString():(0,xs.Z)("verb","Copy")},{handler:()=>{e.execCommand("paste")},shortcuts:["ctrl+v"],isVisible:()=>!0===n.showPaste,...(0,xs.Z)("verb","Paste")}])}if((n.showSave||n.showSaveAll)&&(s(),n.showSave&&(t=t.concat([{handler:()=>{this.onSave()},...this.props.getContextMenuSaveString?this.props.getContextMenuSaveString():(0,xs.Z)("verb","Save")}])),n.showSaveAll&&(t=t.concat([{handler:()=>{this.onSaveAll()},...this.props.getContextMenuSaveAllString?this.props.getContextMenuSaveAllString():(0,xs.Z)("verb","Save All")}]))),(n.showExport||n.showExportAll)&&(s(),n.showExport&&(t=t.concat([{handler:()=>{this.onExport()},...this.props.getContextMenuExportString?this.props.getContextMenuExportString():(0,xs.Z)("verb","Export")}])),n.showExportAll&&(t=t.concat([{handler:()=>{this.onExportAll()},...this.props.getContextMenuExportAllString?this.props.getContextMenuExportAllString():(0,xs.Z)("verb","Export All")}]))),n.showDelete&&(s(),t.push({handler:()=>{this.onDelete(!1)},shortcuts:["delete"],...this.props.getContextMenuDeleteString?this.props.getContextMenuDeleteString():(0,xs.Z)("verb","Delete")})),n.showExpandCollapse){s();const e=[{handler:this.expandAll,...(0,xs.Z)("Expand All Folders")},{handler:this.collapseAll,...(0,xs.Z)("Collapse All Folders")}];t=t.concat(e)}if(n.showImport&&(s(),t.push({handler:this.onImport,ellipsis:!0,...this.props.getContextMenuImportString?this.props.getContextMenuImportString():(0,xs.Z)("Import")})),n.showSettings){s();const e=this.getSearchStyle(),n=[{type:"checkbox",checked:"flat"===e,handler:this.setSearchStyle.bind(this,"flat"),...(0,xs.Z)("Flat Search")},{type:"checkbox",checked:"tree"===e,handler:this.setSearchStyle.bind(this,"tree"),...(0,xs.Z)("Tree Search")}];t=t.concat([{items:n,...(0,xs.Z)("Settings")}])}if(n.showCustomSettings&&(s(),this.props.addCustomSettingMenu&&(t=t.concat([this.props.addCustomSettingMenu()]))),n.showFullscreen){s();const e=[{handler:()=>cs.Z.toggleFullscreen(this.context.vivaldiWindowId),...(0,xs.Z)("Fullscreen")}];t=t.concat(e)}return t};onResize=e=>{const t=e[0].contentRect;this.updateTreeSize(t.width,t.height)};updateTreeSize=(e,t)=>{this._isMounted&&this.setState({width:e,height:t})};onContextMenu=async e=>{let t;if(e?.button>0&&e.currentTarget?.className?.includes("vivaldi-tree")||(t=this.getSelectedItem()),this.props.menu)return e.persist(),e.preventDefault(),e.stopPropagation(),void(this.props.menu&&this.getNamedContextMenuItems(this.props.menu,t).then((n=>{(0,Qi.Z)(this.context,n,(n=>{n&&this.onContextMenuOpen(e,t)}))(e)})));let n;e.preventDefault(),e.stopPropagation(),this.props.getContextMenuItemsPromise?(e.persist(),n=await this.getContextMenuItemsPromise(t)):n=this.getContextMenuItems(t),(0,Qi.Z)(this.context,n,(n=>{n&&this.onContextMenuOpen(e,t)}))(e)};renderTreeItem=e=>{const{key:t,index:n,style:s}=e,i=this.state.renderArray[n].node;void 0===i.id&&(i.id=n);const o=this.selectionModel.isSelected(i.id),a=this.state.renderArray[n-1]?.node.id,r=this.state.renderArray[n+1]?.node.id,l=n>=0&&a&&this.selectionModel.isSelected(a),d=r&&this.selectionModel.isSelected(r),c=this.selectionModel.leadIndex===i.id,h=this.props.cutIds&&this.props.cutIds.indexOf(i.id)>-1,p=!!i.children?.length&&this.isExpanded(i.id);let u=!1;!0===o&&(u=this.state.hasFocus||i.id===this.state.inlineEditId);let g=this.props.enableDragAndDrop&&this.state.inlineEditId!==i.id;g&&this.props.isValidDragSource&&(g=this.props.isValidDragSource(i));const m=this.state.inlineEditId===i.id?this.state.inlineEditText:void 0,v=this.state.renderArray[n].level,f=this.state.renderArray[n+1]?.level??0,y={node:i,level:v,isExpanded:p,isSelected:o,inlineEditText:m,onChange:this.setInlineEditText,isLastChild:v>0&&0===f||this.isFolder(i)&&0===v&&!p,onFocus:vo,onBlur:()=>{this.saveInlineEdit()}},{rowComponent:C,getRowComponentProps:w}=this.props,b=w?w(y):y;return po(Yi,{index:n,Component:C,componentProps:b,treeItem:i,style:s,overrideDoubleClick:this.props.overrideDoubleClick,isExpanded:p,isSeparator:this.props.isSeparator,toggle:this.toggleExpandModel,onContextMenu:this.onContextMenu,onMouseDown:this.onItemMouseDown,onMouseUp:this.onItemMouseUp,selected:o,isFirstSelected:o&&!l,isLastSelected:o&&!d,hasFocus:u,lead:c,isCut:h,validateForDrag:this.props.validateForDrag,onDragStart:this.stopInlineEditTimer,supportDrop:this.props.enableDragAndDrop?this.supportDropForItem:null,onDragLeave:this.props.enableDragAndDrop?this.onDragLeaveItem:null,onDragOver:this.props.enableDragAndDrop?this.onDragOverItem:null,onDragEnd:this.onDragEndItem,onDrop:this.onDrop,mimeType:this.props.mimeType,getDragData:this.props.getDragData,setCustomDragData:this.props.setCustomDragData,dragover:this.state.dragOverObj.id===i.id,dragOverObj:this.state.dragOverObj,inlineEditText:m,getAllSelectedItems:this.getAllSelectedItems,isFolder:this.props.isFolder,isDraggable:g,hasChildren:this.props.hasChildren,onItemClick:this.onItemClick,onItemDoubleClick:this.onItemDoubleClick,enableDragAndDrop:this.props.enableDragAndDrop},t)};getStyle=eo()((e=>({"--gridColumns":e&&ao(e)})));render(){const e=As()(this.props.className,{"vivaldi-tree":!this.props.className,"no-selection":-1===this.selectionModel.anchorIndex});return po(Ri,{style:this.getStyle(this.props.columns),className:e,onBlur:this.onLostFocus,onKeyDown:this.onKeyDown,onDragOver:this.props.enableDragAndDrop?this.onDragEmptyArea:void 0,onDragLeave:this.props.enableDragAndDrop?this.cancelDragOverObject:void 0,onDrop:this.props.enableDragAndDrop?this.onDropEmptyArea:void 0,onClick:this.unSelectAll,onCompositionStart:this.onCompositionStart,onCompositionUpdate:this.onCompositionStart,onCompositionEnd:this.onCompositionEnd,onContextMenu:this.onContextMenu,onResize:this.onResize},void 0,(0,fs.jsx)(lo.aV,{ref:this.refTreeListEntries,onRowsRendered:this.onRowsRendered,onScroll:this.onScroll,width:this.state.width,height:this.state.height,rowHeight:this.props.rowHeight||uo,rowRenderer:this.renderTreeItem,rowCount:this.state.renderArray.length,overscanRowCount:12,onScrollbarPresenceChange:this.props.onScrollbarPresenceChange,scrollToAlignment:this.props.scrollToAlignment,containerStyle:{pointerEvents:"auto"}}))}}const yo=fo;var Co;function wo(e,t,n,s){Co||(Co="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Co,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function bo({onExpandClick:e,inManager:t,fullView:n,node:s,level:i,isExpanded:o,inlineEditText:a,onChange:r,onBlur:l,onFocus:d,showBadge:c,onMouseEnter:h,onMouseLeave:p}){const u=(i+1)*mo+"px",g=i*mo+"px",m=Boolean(s.children),v=Boolean(m&&s.children.length),{favIconUrl:f,favIconLoadType:y}=je.jk.getBookmarkFavicon(s.url,s.faviconUrl);return wo("label",{"data-parent":s.parentId,onMouseEnter:h,onMouseLeave:p},"0",m&&v&&wo("span",{className:"expand-icon",style:{marginLeft:g},onMouseUp:t=>{const n=t.altKey;e(s.id,n)},onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},dangerouslySetInnerHTML:{__html:Ts.nfH}}),m&&s.trash&&wo(Ps,{speeddial:s.speeddial,open:o,trash:!0,leftMargin:v?0:u}),m&&!s.trash&&wo(Ps,{speeddial:s.speeddial,open:o,trash:!1,leftMargin:v?0:u}),!m&&wo(Ss,{url:f,loadType:y,style:{marginLeft:u},className:"tree-row-image bookmark-icon"}),void 0!==a&&wo("input",{type:"text",value:a,onChange:r,onFocus:d,onBlur:l,autoFocus:!0}),void 0===a&&wo("span",{className:"title"},void 0,s.title?s.title:ps.ZP.isBookmark(s)&&!t?s.url:""),c&&v&&!n&&wo("span",{className:"item-count"},void 0,s.children.filter((e=>!ps.ZP.isSeparator(e))).length))}var So,Io=n(34155);function ko(e,t,n,s){So||(So="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:So,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Ao({node:e,inlineEditText:t,isExpanded:n,level:s,onFocus:i,onChange:o,onBlur:a,onExpandClick:r}){return ko(bo,{node:e,inlineEditText:t,isExpanded:n,level:s,inManager:!1,fullView:!1,showBadge:!1,onExpandClick:r,onFocus:i,onChange:o,onBlur:a},e.id)}const To=ps.ZP.getRootId();class Zo extends hs.PureComponent{refTreeList=hs.createRef();componentDidMount(){this.setFolderTreeView()}componentDidUpdate(e){const t=this.refTreeList.current?.getSelectedId();e.selectedId===this.props.selectedId||t===this.props.selectedId||this.props.isEditing||this.setFolderTreeView()}async setFolderTreeView(){const{selectedId:e}=this.props,t=this.refTreeList.current?.getSelectedId();t!==e&&this.setSelectedId(e),this.props.expandAll?this.refTreeList.current?.expandAll():(this.refTreeList.current?.collapseAll(),await new Promise((e=>Io.nextTick(e))),e&&e!==To?this.refTreeList.current?.expandToId(e):this.refTreeList.current?.expand(To)),await new Promise((e=>Io.nextTick(e)));e&&"1"!==e&&this.refTreeList.current?.scrollToId(e)}setSelectedId=e=>{this.refTreeList.current?.setSelectedIds([e])};scrollToId=e=>{this.refTreeList.current?.scrollToId(e)};expand=e=>{this.refTreeList.current?.expand(e)};expandAll=()=>{this.refTreeList.current?.expandAll()};toggleSelectedExpansion=(e,t)=>{this.refTreeList.current?.toggleSelectedExpansion(e,t)};startInlineEdit=e=>{this.setSelectedId(e),this.scrollToId(e),this.focus(),this.refTreeList.current?.startInlineEdit(e)};focus=()=>{this.refTreeList.current?.focusTree()};render(){const{folders:e,onSelect:t}=this.props;return(0,fs.jsx)(yo,{ref:this.refTreeList,className:As()(this.props.className,"vivaldi-tree"),nodes:e,hasChildren:e=>e.children?.length,isFolder:e=>Boolean(e.children?.length&&!e.url),onSelect:e=>e&&t(e.id),rowComponent:e=>(0,fs.jsx)(Ao,{...e,onExpandClick:this.toggleSelectedExpansion}),saveTitle:this.props.onFolderTitleChange,isValidToEdit:()=>!0,getTitle:()=>this.props.defaultEditFolderText,enableDragAndDrop:!1})}}var Eo;function _o(e,t,n,s){Eo||(Eo="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Eo,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Mo(e,t){return t?t>16?e.large:t<16?e.small:e.medium:e.medium}function No({icon:e,size:t,className:n}){return _o("span",{style:t&&{"--IconSize":t},className:As()("VivaldiSvgIcon",n),dangerouslySetInnerHTML:{__html:e}})}function Po({size:e,className:t}){return _o(No,{icon:Mo(Ts.nre,e),size:e,className:t})}function Do({size:e,className:t}){return _o(No,{icon:Ts.oJy,size:e,className:t})}function xo({size:e,className:t}){return _o(No,{icon:Ts.u0H,size:e,className:t})}function Oo({size:e,className:t}){return _o(No,{size:e,className:t,icon:'\n<svg width="8" height="12" viewBox="0 0 8 12" xmlns="http://www.w3.org/2000/svg">\n  <path d="M7.06006 1.60666L6.1134 0.666656L4.00006 2.77999L1.88673 0.666656L0.940063 1.60666L4.00006 4.66666L7.06006 1.60666ZM0.940063 10.3933L1.88673 11.3333L4.00006 9.21999L6.1134 11.3333L7.0534 10.3933L4.00006 7.33332L0.940063 10.3933Z"/>\n</svg>\n'})}function Lo({size:e,className:t}){return _o(No,{icon:Mo(Ts._TQ,e),size:e,className:t})}function Ro({size:e,className:t}){return _o(No,{icon:Mo(Ts.fph,e),size:e,className:t})}function Bo({size:e,className:t}){return _o(No,{icon:Mo(Ts.$II,e),size:e,className:t})}function Fo({size:e,className:t}){return _o(No,{size:e,className:t,icon:'\n<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">\n  <rect x="1" y="1" width="7" height="7" rx="2"/>\n  <rect x="1" y="10" width="7" height="7" rx="2"/>\n  <rect x="10" y="10" width="7" height="7" rx="2"/>\n  <rect x="10" y="1" width="7" height="7" rx="2"/>\n</svg>\n'})}function Vo({size:e,className:t}){return _o(No,{icon:Mo(Ts.YvR,e),size:e,className:t})}function Wo({size:e,className:t}){return _o(No,{icon:Ts.AXs,size:e,className:t})}function Uo({size:e,className:t}){return _o(No,{icon:Ts.uw2,size:e,className:t})}function Ho({size:e,className:t}){return _o(No,{icon:Mo(Ts.bqs,e),size:e,className:t})}function zo({size:e,className:t}){return _o(No,{icon:Ts.kze,size:e,className:t})}function Go({size:e,className:t}){return _o(No,{icon:Ts.D7r.medium,size:e,className:t})}function $o({size:e,className:t}){return _o(No,{icon:Ts.Tu3,size:e,className:t})}function Ko({size:e,className:t}){return _o(No,{icon:Ts.GH$,size:e,className:t})}function jo({size:e,className:t,type:n}){switch(n){case"trash":return _o(Po,{className:t,size:e});case"bookmark":return _o(Do,{className:t,size:e});case"caret":case"chevron":return _o(xo,{className:t,size:e});case"contract":return _o(Oo,{className:t,size:e});case"folder":return _o(Lo,{className:t,size:e});case"folder-arrow":return _o(Ro,{className:t,size:e});case"speed-dial-folder":return _o(Bo,{className:t,size:e});case"speed-dial":return _o(Fo,{className:t,size:e});case"search":return _o(Vo,{className:t,size:e});case"download-speed":return _o(Wo,{className:t,size:e});case"download-placeholder":return _o(Uo,{className:t,size:e});case"settings":return _o(Ho,{className:t,size:e});case"close":return _o(zo,{className:t,size:e});case"checkmark":return _o(Go,{className:t,size:e});case"reorder":return _o(No,{size:e,className:"reorder",icon:'\n<svg width="12" height="4" viewBox="0 0 12 4" xmlns="http://www.w3.org/2000/svg">\n  <line x1="0" y1="0" x2="12" y2="0" stroke="currentColor" />\n  <line x1="0" y1="4" x2="12" y2="4" stroke="currentColor" />\n</svg>\n'});case"blocker-shield":return _o($o,{className:t,size:e});case"info":return _o(Ko,{className:t,size:e})}}const Yo=32;class Xo extends hs.PureComponent{static contextType=xi.Z;refCanvas=hs.createRef();componentDidMount(){this._isMounted=!0,this.offscreen=this.refCanvas.current.transferControlToOffscreen(),this.renderIcon(this.props.mediaState)}componentDidUpdate(e){const{mediaState:t,color:n,animated:s,active:i}=this.props;!this._isMounted||e.mediaState===t&&e.color===n&&e.animated===s&&e.active===i||this.renderIcon(this.props.mediaState)}componentWillUnmount(){this._isMounted=!1}shouldAnimate=()=>this._isMounted&&this.props.animated&&this.props.mediaState.has("playing")&&!this.props.mediaState.has("muting")&&!this.props.mediaState.has("capturing")&&!this.props.mediaState.has("pip");getInheritedColor=()=>{if(!this._isMounted)return;let e="#111111";this.props.color?e=this.props.color:this.refCanvas.current&&(e=getComputedStyle(this.refCanvas.current).getPropertyValue("color")),this._color!==e&&(this._color=e)};renderIcon=e=>{if(!this.offscreen)return;const t=this.offscreen.getContext("2d");this.getInheritedColor();let n=0;function s(e,t){return e+n*(t-e)}const i=()=>{t.beginPath(),t.moveTo(4,12),t.lineTo(10,12),t.lineTo(18,4),t.lineTo(18,28),t.lineTo(10,20),t.lineTo(4,20),t.closePath(),t.lineWidth=0,t.fillStyle=this._color,t.fill()},o=()=>{t.beginPath(),t.moveTo(2,27),t.lineTo(5,30),t.lineTo(28,7),t.lineTo(25,4),t.moveTo(4,12),t.lineTo(10,12),t.lineTo(18,4),t.lineTo(18,8),t.lineTo(6,20),t.lineTo(4,20),t.moveTo(14,24),t.lineTo(18,20),t.lineTo(18,28),t.closePath(),t.lineWidth=0,t.fillStyle=this._color,t.fill()},a=()=>{t.beginPath(),t.moveTo(6,25),t.lineTo(4,23),t.lineTo(4,8),t.lineTo(6,6),t.lineTo(26,6),t.lineTo(28,8),t.lineTo(28,23),t.lineTo(26,25),t.moveTo(26,23),t.lineTo(26,14),t.lineTo(14,14),t.lineTo(14,23),t.closePath(),t.lineWidth=0,t.fillStyle=this._color,t.fill()},r=e=>{if(!t||!this.shouldAnimate())return;this._lastTime||(this._lastTime=e);const i=e-this._lastTime;if(i<62.5)return void this.context.requestAnimationFrame(r);t.clearRect(18,0,Yo,Yo),n=n>1?0:Math.ceil(100*(n+.05))/100,t.beginPath(),t.moveTo(4,12),t.lineTo(10,12),t.lineTo(18,4),t.lineTo(18,28),t.lineTo(10,20),t.lineTo(4,20),t.moveTo(s(14,22),s(12,4)),t.quadraticCurveTo(s(18,32),16,s(14,22),s(20,28)),t.lineTo(s(16,24),s(22,30)),t.quadraticCurveTo(s(20,34),16,s(16,24),s(10,2)),t.closePath(),t.lineWidth=0;const o=n<.7?1:parseFloat((1-n)/.3);t.fillStyle=B()(this._color).alpha(o).css(),t.fill(),this.shouldAnimate()?(this.getInheritedColor(),this.context.requestAnimationFrame(r)):l(this.props.mediaState),this._lastTime=e-i%62.5},l=e=>{t.globalCompositeOperation&&(t.clearRect(0,0,Yo,Yo),e.has("pip")?a():e.has("capturing")?(t.beginPath(),t.arc(3,26,4,1.5*Math.PI,2*Math.PI,!1),t.lineWidth=2,t.stroke(),t.closePath(),t.beginPath(),t.arc(3,26,8,1.5*Math.PI,2*Math.PI,!1),t.lineWidth=2,t.stroke(),t.closePath(),t.beginPath(),t.arc(3,26,12,1.5*Math.PI,2*Math.PI,!1),t.lineWidth=2,t.stroke(),t.closePath(),t.beginPath(),t.moveTo(4,10),t.lineTo(4,8),t.lineTo(6,6),t.lineTo(26,6),t.lineTo(28,8),t.lineTo(28,23),t.lineTo(26,25),t.lineTo(20,25),t.lineWidth=2,t.stroke()):e.has("muting")?o():e.has("playing")&&this.shouldAnimate()?r(this.context.performance.now()):i())};l(e)};render(){let e="";return this.props.mediaState.has("pip")?e=(0,Oe.Z)("Exit Picture in Picture"):this.props.mediaState.has("muting")?e="tab"===this.props.src?(0,Oe.Z)("Unmute tab audio"):(0,Oe.Z)("Unmute panel audio"):this.props.mediaState.has("playing")&&(e="tab"===this.props.src?(0,Oe.Z)("Mute tab audio"):(0,Oe.Z)("Mute panel audio")),(0,fs.jsx)("canvas",{ref:this.refCanvas,className:"audioicon",width:Yo,height:Yo,title:e})}}const Qo=Xo,qo=e=>{const{draggable:t}=e;return t?{draggable:e.draggable,onDragStart:e.onDragStart,onDragLeave:e.onDragLeave,onDragEnter:e.onDragEnter,onDragOver:e.onDragOver,onDragEnd:e.onDragEnd,onDrop:e.onDrop}:{}},Jo=e=>{const{ctrlKey:t,altKey:n,shiftKey:s,metaKey:i}=e,o={ctrlKey:t,altKey:n,shiftKey:s,metaKey:i};return(0,co.mT)(o)};function ea(e,t,n){const s=e.clientX-t.left,i=e.clientY-t.top;let o=.5;void 0!==n&&n>=0&&n<=.5&&(o=n);const a=s<t.width*o,r=s>t.width*(1-o),l=i<t.height*o,d=i>t.height*(1-o);return{horizontal:a?"left":r?"right":"center",vertical:l?"top":d?"bottom":"center"}}function ta(e){return(0,hs.forwardRef)(((t,n)=>{const s=(0,hs.useRef)(null),i=n||s,[{buttonClasses:o,draggable:a,dragging:r,setVerticalPosition:l,setHorizontalPosition:d,dragOver:c,verticalPosition:h,horizontalPosition:p},{onDragStart:u,onDragEnd:g,onDragEnter:m,limitToDrag:v,onDrop:f,onDragLeave:y,onDragOver:C}]=function(e){const[t,n]=(0,hs.useState)(!1),[s,i]=(0,hs.useState)(!1),[o,a]=(0,hs.useState)(null),[r,l]=(0,hs.useState)(null),{draggable:d,onDragStart:c,onDragEnd:h,onDragEnter:p,onDrop:u,mimeType:g,image:m,imagePath:v,faviconPath:f,isOn:y,isPressed:C,isPopupVisible:w,name:b,edgeAmount:S}=e,I=(0,hs.useCallback)((e=>{c&&c(e),e.persist(),d?(e.dataTransfer.dropEffect="move",g&&b&&(e.dataTransfer.setData(g,b),e.dataTransfer.setData("text/plain","")),n(!0)):e.preventDefault()}),[d,c,g,b]),k=(0,hs.useCallback)((e=>{e.persist(),h?.(e),n(!1),i(!1),l(null),a(null)}),[h]),A=(0,hs.useCallback)((()=>{i(!0),p&&p()}),[p]),T=(0,hs.useCallback)((e=>{if(e.dataTransfer.types.includes(g)){const t=e.currentTarget.getBoundingClientRect();e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="move";const{horizontal:n,vertical:s}=ea(e,t,S);a(s),l(n)}}),[g,S]),Z=(0,hs.useCallback)((e=>{const t=e.currentTarget.getBoundingClientRect(),{horizontal:s,vertical:o}=ea(e,t,S);if(n(!1),i(!1),l(null),a(null),e.persist(),!e.dataTransfer.types.includes(g))return e.preventDefault(),void e.stopPropagation();u?.(e,s,o)}),[u,g,S]),E=(0,hs.useCallback)((e=>{d||e.preventDefault()}),[d]),_=(0,hs.useCallback)((e=>{i(!1),l(null),a(null)}),[]);return[{buttonClasses:(e=>{const n="center"===o&&"center"===r;return As()(e,{"button-on":y,"button-textonly":!m&&!v&&!f,"button-pressed":C||w,"button-dragged":t,"button-dragover":s,"button-dragover-top":"top"===o,"button-dragover-bottom":"bottom"===o,"button-dragover-center":n,"button-dragover-left":"left"===r,"button-dragover-right":"right"===r})})(e.buttonClasses),draggable:d&&Boolean(I&&e.mimeType),dragging:t,dragOver:s,setVerticalPosition:a,setHorizontalPosition:l,verticalPosition:o,horizontalPosition:r},{onDragStart:I,onDragEnd:k,limitToDrag:E,onDragEnter:A,onDrop:Z,onDragLeave:_,onDragOver:T}]}(t);return(0,fs.jsx)(e,{...t,ref:i,dragging:r,draggable:a,onDragStart:u,onDragEnd:g,onDragEnter:m,dragOver:c,limitToDrag:v,onDragLeave:y,onDragOver:C,onDrop:f,buttonClasses:o,setVerticalPosition:l,setHorizontalPosition:d,verticalPosition:h,horizontalPosition:p})}))}var na=n(14507);const sa=function(e,t){return hs.forwardRef(((n,s)=>{const i=(0,na.Z)(t);return(0,fs.jsx)(e,{...n,ref:s,prefValues:i})}))};var ia,oa=n(5298);function aa(e,t,n,s){ia||(ia="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:ia,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const ra={};function la(e){const[t,n]=(0,hs.useState)("");return(0,hs.useEffect)((()=>((async e=>{if(ra[e])return void n(ra[e].content);const t=new XMLHttpRequest;t.addEventListener("load",(s=>{const{response:i}=t;ra[e]={content:i},n(i)})),t.addEventListener("error",(e=>{console.error(e)})),t.open("GET",e),t.send()})(e.url),()=>{delete ra[e.url]})),[e.url]),t?aa("span",{className:e.className,dangerouslySetInnerHTML:{__html:t}}):null}var da=n(63377);function ca({verticalPosition:e,onResize:t}){const n=(0,hs.useRef)();return(0,hs.useEffect)((()=>{const e=n.current;return e?.addEventListener("pointerdown",t,!0),()=>{e?.removeEventListener("pointerdown",t,!0)}}),[t]),(0,fs.jsx)("div",{ref:n,className:`resize resize-${e}`})}var ha,pa=n(73935),ua=n(52250),ga=n(29697);function ma(e,t,n,s){ha||(ha="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:ha,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function va(e,t,n,s,i){if(!i)return{};const o={};if(s){const e=n.top-i.top-3,a=i.bottom-n.bottom-3;"above"===t?e>=s.height?o.bottom=Math.round(i.height-n.top-i.top+3)+"px":a>=s.height?o.top=Math.round(n.bottom-i.top+3)+"px":o.top="3px":"below"===t?a>=s.height?o.top=Math.round(n.bottom-i.top+3)+"px":e>=s.height?o.bottom=Math.round(i.height-n.top-i.top+3)+"px":o.bottom="3px":a>=s.height/2&&e>=s.height/2?(o["--anchorPos"]="50%",o.top=Math.round(n.top-i.top-s.height/2+12)+"px"):a>=s.height?(o["--anchorPos"]="12px",o.top=Math.round(n.top-i.top)+"px"):e>=s.height?(o["--anchorPos"]=s.height-18+"px",o.bottom=Math.round(i.height-n.bottom+3)+"px"):(o["--anchorPos"]="12px",o.bottom="3px")}else"above"===t?o.bottom=Math.round(i.height-n.top-i.top+3)+"px":"below"===t?o.top=Math.round(n.bottom-i.top+3)+"px":(o.position||(o["--anchorPos"]="12px"),o.top=Math.round(n.top)+"px");return"string"==typeof o.top?o.bottom="unset":o.top="unset","left"===e?o.right="left"===t?Math.round(Math.max(i.right-n.left+3,3))+"px":Math.round(Math.max(i.right-n.right,3))+"px":o.left="right"===e?"right"===t?Math.round(n.right+3)+"px":Math.round(Math.max(n.left,3))+"px":Math.round(n.left+n.width/2)+"px","string"==typeof o.left?o.right="unset":o.left="unset",o}class fa extends hs.PureComponent{static contextType=xi.Z;nodeRef=hs.createRef();renderInPortal=!0;horizontalPosition="center";state={height:this.props.height??400,originalHeight:this.props.height??400,originalY:0,originalMouseY:0};constructor(e,t){super(e),this.portalContainer=t.document.getElementById("browser")}componentDidMount(){this.context.addEventListener("resize",this.onWindowResize,!1),this.intersectionObserver=new IntersectionObserver(this.onIntersect,{root:this.portalContainer}),this.intersectionObserver.observe(this.props.buttonRef),this.props.isResizable&&(this.context.addEventListener("pointerup",this.stopResize,!0),this.context.addEventListener("pointercancel",this.stopResize,!0))}onIntersect=e=>{e[0].intersectionRatio<=0&&this.props.hidePopup()};componentDidUpdate(e){this.props.buttonRef!==e.buttonRef&&(this.intersectionObserver.disconnect(),this.intersectionObserver.observe(this.props.buttonRef)),this.recalculatePosition()}componentWillUnmount(){this.context.removeEventListener("resize",this.onWindowResize,!1),this.context.removeEventListener("pointerup",this.stopResize,!0),this.context.removeEventListener("pointercancel",this.stopResize,!0),this.intersectionObserver.disconnect()}recalculatePosition=()=>{const e=this.getNode();if(this.renderInPortal&&e){const t=va(this.horizontalPosition,this.props.popupPosition,this.props.buttonRef.getBoundingClientRect(),e.getBoundingClientRect(),this.context.document.body?.getBoundingClientRect());for(const n in t)e.style[n]!==t[n]&&e.style.setProperty(n,t[n])}};getNode(){return this.nodeRef.current?.focusRef.current}onWindowResize=()=>{this.forceUpdate()};getEdgeMargin=e=>{let t=Number.MAX_SAFE_INTEGER;const n=this.props.buttonRef.getBoundingClientRect();return"right"===e?t=n.left:"left"===e&&(t=this.context.innerWidth-n.right),t<=3?3-t:0};handleClickOutside=()=>{this.props.hidePopup()};keyDown=e=>{e.keyCode===oa.Z.KEY_ESCAPE&&(this.props.hidePopup(),e.preventDefault(),e.stopPropagation())};resize=e=>{const{originalHeight:t,originalMouseY:n}=this.state,s="above"===this.props.popupPosition?t-(e.pageY-n):t+(e.pageY-n);e.buttons?s>=100&&this.context.requestAnimationFrame((()=>{this.setState({height:s})})):this.stopResize(e)};stopResize=e=>{e.target.releasePointerCapture(e.pointerId),Hi.Z.setWebviewPointerEvents(!0,this.context.document),e.target.removeEventListener("pointermove",this.resize,!0),this.props.height!==this.state.height&&this.props.onResize?.(this.state.height)};startResize=e=>{const t=this.getNode();t&&e.button===Hi.Z.kLeft&&(e.preventDefault(),this.setState({originalHeight:parseFloat(getComputedStyle(t).getPropertyValue("height").replace("px","")),originalY:t.getBoundingClientRect().top,originalMouseY:e.pageY}),e.target.setPointerCapture(event.pointerId),Hi.Z.setWebviewPointerEvents(!1,this.context.document),e.target.addEventListener("pointermove",this.resize,!0))};render(){const e=G.ZP.getVisibleUI(this.context.vivaldiWindowId).addressBar,t=Boolean(this.props.buttonRef.closest(".toolbar-mainbar"));this.renderInPortal=e||!t;const{popupClassName:n,hasLightArrow:s,popupPosition:i}=this.props,o=this.props.buttonRef.getBoundingClientRect(),a=this.props.width||200,r=this.context.document.body?.getBoundingClientRect();this.horizontalPosition=function(e,t,n,s){if(!n)return"center";const i=t.left-n.left,o=n.right-t.right,a=e/2<i+t.width/2-3,r=e/2<o+t.width/2-3,l=e-t.width<o,d=e-t.width<i;if(a&&r){if("left"===s&&l)return"right";if("right"===s&&d)return"left"}else{if(d)return"left";if(l)return"right"}return"center"}(a,o,r,this.props.popupPosition);let l={"--popupWidth":Math.round(a)+"px","--buttonWidth":Math.round(o.width)+"px","--buttonHeight":Math.round(o.height)+"px","--edgeMargin":Math.round(this.getEdgeMargin(this.horizontalPosition))+"px"};if(this.props.isResizable&&(l["--popupHeight"]=Math.round(this.state.height)+"px"),this.renderInPortal){const e=this.getNode()?.getBoundingClientRect();l={...l,...va(this.horizontalPosition,i,o,e,r)}}const d=ma(ga.Z,{classNames:"button-popup",in:!0,onEnter:this.recalculatePosition,appear:!0,mountOnEnter:!0,unmountOnExit:!0,timeout:{enter:300,exit:150}},void 0,(0,fs.jsxs)(da.Z,{ref:this.nodeRef,focusName:"focus-popup-area",forceTrap:this.props.forceFocus??!0,onKeyDown:this.keyDown,style:l,className:As()(n,"button-popup",`button-popup-${this.horizontalPosition}`,`button-popup-pos-${i}`,"button-popup-arrow-"+(s?"light":"dark")),children:[this.props.children,this.props.isResizable&&ma(ca,{verticalPosition:i,onResize:this.startResize})]}));return this.portalContainer&&this.renderInPortal?pa.createPortal(d,this.portalContainer):d}}const ya=(0,ua.Z)(fa);class Ca extends F.Z{getInitialState(){return""}reduce(e,t){switch(t.actionType){case"TOOLBAR_EDIT_MODE":return t.toolbar;case"TOOLBAR_STOP_EDIT_MODE":return"";default:return e}}}const wa=new Ca;class ba extends hs.Component{static contextType=xi.Z;state={width:28,height:28,hasLoadedPopup:!1};constructor(e,t){super(e),this.portalContainer=t.document.getElementById("browser")}popupContainer=hs.createRef();webviewelm=null;componentWillUnmount(){this.detachListeners(),this.webviewelm=null}getNode(){return this.popupContainer.current}attachListeners=()=>{this.webviewelm?.addEventListener("sizechanged",this.onSizeChanged),this.webviewelm?.addEventListener("close",this.onClose),this.webviewelm?.addEventListener("newwindow",this.onNewWindow),this.webviewelm?.addEventListener("loadstop",this.onLoadStop),this.webviewelm?.addEventListener("dialog",this.onShowDialog),Di.Z.bind("esc",this.onCloseWithKeyboard)};focusPopup=()=>{const e=this.popupContainer.current?.parentElement?.parentElement?.parentElement?.querySelector(".focus-popup-area");e&&e.focus()};detachListeners=()=>{this.webviewelm?.removeEventListener("sizechanged",this.onSizeChanged),this.webviewelm?.removeEventListener("close",this.onClose),this.webviewelm?.removeEventListener("newwindow",this.onNewWindow),this.webviewelm?.removeEventListener("loadstop",this.onLoadStop),this.webviewelm?.removeEventListener("dialog",this.onShowDialog),Di.Z.unbind("esc",this.onCloseWithKeyboard)};handleClickOutside=e=>{this.props.popupWantsToClose()};removeWebView=()=>{this.detachListeners(),this.webviewelm&&(this.popupContainer.current?.removeChild(this.webviewelm),this.popupContainer.current?.remove(),this.webviewelm=null),this.setState({hasLoadedPopup:!1})};recreateWebView=()=>{const{document:e}=this.context;this.webviewelm&&this.removeWebView(),C.Z.zoom.getVivaldiUIZoom((t=>{const n=this.popupContainer.current;if(!n)return;this.portalContainer?.appendChild(n);let s=800,i=600;t>=1&&(s=Math.round(800*t),i=Math.round(600*t));const{extensionId:o,popupPage:a}=this.props;if(o&&a){const t=e.createElement("webview");t.setAttribute("windowId",String(this.context.vivaldiWindowId)),t.setAttribute("autosize","on"),t.setAttribute("minwidth",String(28)),t.setAttribute("minheight",String(28)),t.setAttribute("maxwidth",String(s)),t.setAttribute("maxheight",String(i)),t.setAttribute("partition","persist:"+o),t.setAttribute("class","ignore-react-onclickoutside"),t.setAttribute("vivaldi_view_type","extension_popup"),t.setAttribute("src",a),n?.appendChild(t),this.webviewelm=t,this.attachListeners()}}))};onSizeChanged=e=>{this.setState({width:e.newWidth,height:e.newHeight})};onLoadStop=e=>{this.props.enableOnClickOutside(),this.setState({hasLoadedPopup:!0}),setTimeout((e=>{this.webviewelm&&this.webviewelm.focus()}),50)};onNewWindow=e=>{e.window.accept(this.context.vivaldiWindowId+";1"),this.props.popupWantsToClose()};onShowDialog=e=>{this.props.disableOnClickOutside?.(),e.webview=this.webviewelm,e.preventDefault(),e.dialogtype="javascript",Ae.Z.showDialog(this.context.vivaldiWindowId,e,this.onClose),this.onSizeChanged(e)};onCloseWithKeyboard=()=>{this.props.popupWantsToClose(),this.focusPopup()};onClose=()=>{this.props.popupWantsToClose()};render(){let e=0,t=0,n=0;const{popupPosition:s}=this.props;if(this.props.popupRect){const i=this.props.popupRect;"above"===s||"below"===s?(e="above"===s?i.top-this.state.height-3:i.bottom+6-3,t=i.left+i.width/2-this.state.width/2,t=Math.min(Math.max(t,6),this.context.innerWidth-this.state.width-6),n=i.left-t+i.width/2-6):"left"!==s&&"right"!==s||(t="left"===s?i.left-this.state.width-6:i.left+i.width+6,n=6,e=i.top,e+this.state.height>this.context.innerHeight&&(e=this.context.innerHeight-this.state.height-6,n=i.top-e+i.height/2-6))}const i=this.state.hasLoadedPopup&&this.props.popupVisible,o=0===t&&0===e;return(0,fs.jsx)("div",{className:As()({"extension-popup":!0,bottom:!o&&"above"===s,top:!o&&"below"===s,left:!o&&"left"===s,right:!o&&"right"===s,hidden:!i}),style:{"--anchorPosition":n+"px",height:this.state.height,width:this.state.width,position:"fixed",left:o?"50%":t,top:o?"50%":e,transform:o?"translate(-50%, -50%)":"unset",display:i?"inherit":"none"},ref:this.popupContainer})}}const Sa=(0,ua.Z)(ba);var Ia,ka=n(10334),Aa=n(89555);function Ta(e,t,n,s){Ia||(Ia="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Ia,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Za=[$.kAddressBarExtensionsRenderInDropdown,$.kAddressBarExtensionsShowAllToggle,$.kAddressBarExtensionsVisible],Ea="vivaldi/x-button-extension";class _a extends hs.PureComponent{static contextType=xi.Z;refExtensionAnchor=hs.createRef();state={extensions:[],popupId:null,popupPage:null,popupVisible:!1,popupRect:void 0,extensionPopup:!1,shouldRenderHiddenExtensionsOnToolbar:!1,shouldRenderAllExtensionsOnToolbar:!1};_extensionActionShortcuts=[];_removedIdToIndex={};_shortcutCallbacks=[];_toolbarButtons=[];refWrapper=hs.createRef();refToolbar=hs.createRef();extensionActionPopupRef=hs.createRef();componentDidMount(){this.props.inEditor||(C.Z.extensionActionUtils.onAdded.addListener(this.onActionAdded),C.Z.extensionActionUtils.onRemoved.addListener(this.onActionRemoved),C.Z.extensionActionUtils.onUpdated.addListener(this.onActionChanged),C.Z.extensionActionUtils.onCommandAdded.addListener(this.onCommandAdded),C.Z.extensionActionUtils.onCommandRemoved.addListener(this.onCommandRemoved),C.Z.extensionActionUtils.onIconLoaded.addListener(this.onIconLoaded),C.Z.extensionActionUtils.getToolbarExtensions((e=>{const t=e.filter((e=>e.enabled)),n=E.Z.getSync("EXTENSION_BUTTON_ORDER_BROWSER");t.sort(((e,t)=>n.indexOf(e.id)-n.indexOf(t.id))),this.setState({extensions:t}),t.filter((e=>this.isExtensionAvailable(e))).forEach((e=>{const t=this.getExtensionIndex(e.id);this.updateShortcut(e.id,e.keyboardShortcut,t)}))})),ka.g2.addListener(this.extensionSubscriber))}componentDidUpdate(e,t){!t.extensionPopup&&this.state.extensionPopup&&this.refWrapper.current?.focus()}componentWillUnmount(){this.props.inEditor||(C.Z.extensionActionUtils.onAdded.removeListener(this.onActionAdded),C.Z.extensionActionUtils.onRemoved.removeListener(this.onActionRemoved),C.Z.extensionActionUtils.onUpdated.removeListener(this.onActionChanged),C.Z.extensionActionUtils.onIconLoaded.removeListener(this.onIconLoaded),C.Z.extensionActionUtils.onCommandAdded.removeListener(this.onCommandAdded),C.Z.extensionActionUtils.onCommandRemoved.removeListener(this.onCommandRemoved),ka.g2.removeListener(this.extensionSubscriber))}extensionSubscriber=e=>{const t=this._toolbarButtons.find((t=>t?.props.name===e));this.state.popupId!==e&&this.setState({popupVisible:!1,popupPage:null,popupRect:void 0,popupId:null});const n=t?.getRect()??this.refToolbar.current?.getBoundingClientRect();this.onExtensionActionClicked(e,n)};getExtensionIndex=e=>this.state.extensions.findIndex((t=>t.id===e));onIconLoaded=({badgeIcon:e,id:t})=>{const n=this.getExtensionIndex(t);-1!==n&&this.setState((t=>{const s=t.extensions.slice();return s[n]&&(s[n].badgeIcon=e),{extensions:s}}))};assignShortcut=(e,t,n)=>{t&&(this._extensionActionShortcuts[n]=t,this._shortcutCallbacks[n]=()=>{this.onExtensionActionClicked(e)},Di.Z.bind(t.toLowerCase(),this._shortcutCallbacks[n]))};removeShortcut=(e,t)=>{e&&(Di.Z.unbind(e.toLowerCase(),this._shortcutCallbacks[t]),this._extensionActionShortcuts[t]="",delete this._shortcutCallbacks[t])};updateShortcut=(e,t,n)=>{(t||this._extensionActionShortcuts[n])&&(t&&!this._extensionActionShortcuts[n]?this.assignShortcut(e,t,n):!t&&this._extensionActionShortcuts[n]?this.removeShortcut(t,n):t!==this._extensionActionShortcuts[n]&&(this.removeShortcut(t,n),this.assignShortcut(e,t,n)))};onActionChanged=(e,t)=>{if(this.context.vivaldiWindowId===t){const t=this.getExtensionIndex(e.id);-1!==t&&this.setState((n=>{const s=n.extensions.slice();return s[t]=e,{extensions:s}}),this.updateShortcut.bind(this,e.id,e.keyboardShortcut,t))}};saveBrowserOrder(){E.Z.set({EXTENSION_BUTTON_ORDER_BROWSER:this.state.extensions.map((e=>e.id))})}onActionAdded=e=>{this.setState((t=>{const n=this._removedIdToIndex[e.id];delete this._removedIdToIndex[e.id];const s=t.extensions.slice();return"number"==typeof n&&n<t.extensions.length?s.splice(n,0,e):s.push(e),{extensions:s}}),this.saveBrowserOrder)};onActionRemoved=e=>{const t=this.getExtensionIndex(e.id);-1!==t&&this.setState((n=>{this._removedIdToIndex[e.id]=t;const s=n.extensions.slice();return s.splice(t,1),{extensions:s}}),this.saveBrowserOrder)};onCommandAdded=(e,t)=>{const n=this.getExtensionIndex(e);this.assignShortcut(e,t,n)};onCommandRemoved=(e,t)=>{const n=this.getExtensionIndex(e);this.removeShortcut(t,n)};onExtensionActionClicked=(e,t,n)=>{const s=this.getExtensionIndex(e),i=this.state.extensions[s];if(i&&!i.visible){let e;const{HTMLElement:t}=this.context;return n&&n.target instanceof t&&(e=n.target),void this.getContextMenu(i).then((t=>{(0,Qi.Z)(this.context,t,void 0,this.props.menuOrigin,e)()}))}C.Z.extensionActionUtils.executeExtensionAction(e,this.context.vivaldiWindowId,(n=>{n&&this.setState((s=>({popupVisible:!s.popupVisible,popupPage:n,popupRect:t,popupId:e})),(()=>{this.state.popupVisible&&this.extensionActionPopupRef.current?.recreateWebView()}))}))};popupWantsToClose=()=>{this.setState({popupVisible:!1}),this.extensionActionPopupRef.current?.removeWebView()};onDrop=(e,t,n)=>{if(!this._dragOverId)return;let s=this.getExtensionIndex(this._dragOverId);if(this._dragOverId=null,-1===s)return;const i=e.dataTransfer.getData(Ea);if(!i)return;const o=this.getExtensionIndex(i);if(-1===o||o===s)return;if("right"===t&&s++,o===s)return;e.stopPropagation();const a=this.state.extensions[o],r=this.state.extensions.slice();r.splice(o,1),o<s&&s--,r.splice(s,0,a),this.setState((e=>({extensions:r})),this.saveBrowserOrder)};stopPropagation=e=>{e.stopPropagation()};onDragEnter=e=>{this._dragOverId=e};executeExtensionAction=(e,t)=>{if(this.state.popupVisible&&(this.popupWantsToClose(),this.state.popupId===e))return;const{HTMLElement:n}=this.context;t.target instanceof n&&(this.state.popupId!==e&&this.setState({popupVisible:!1,popupPage:null,popupRect:void 0,popupId:null}),this.onExtensionActionClicked(e,t.target.getBoundingClientRect(),t))};removeExtension=e=>{C.Z.extensionActionUtils.removeExtension(e,this.context.vivaldiWindowId)};showOptionsPage=e=>{C.Z.extensionActionUtils.showExtensionOptions(e,this.context.vivaldiWindowId)};toggleVisibility=e=>{this.state.extensionPopup&&this.hideHiddenExtensionsPopup(),C.Z.extensionActionUtils.toggleBrowserActionVisibility(e)};isExtensionAvailable=e=>!(G.ZP.isIncognito(this.context.vivaldiWindowId)&&!e.allowInIncognito);getHiddenExtensions=()=>this.state.extensions.filter((e=>e.actionIsHidden));hasHiddenExtensions=()=>this.state.extensions.some((e=>e.actionIsHidden));toggleHiddenExtensionsPopup=()=>{this.setState((e=>({extensionPopup:!e.extensionPopup})))};hideHiddenExtensionsPopup=()=>{this.setState({extensionPopup:!1})};onCustomMenuSelected=(e,t)=>{C.Z.extensionActionUtils.executeMenuAction(e,this.context.vivaldiWindowId,t,(e=>{s.Z.runtime.lastError&&s.Z.runtime.lastError.message&&console.warn("Error invoking menu item action: "+s.Z.runtime.lastError.message)}))};getContextMenu=e=>new Promise(((t,n)=>{const i=e.homepage||"https://chrome.google.com/webstore/detail/"+e.id,o=this.props.prefValues[$.kAddressBarExtensionsShowAllToggle];C.Z.extensionActionUtils.getExtensionMenu(e.id,(a=>{s.Z.runtime.lastError&&n(s.Z.runtime.lastError);const r=a.map((t=>{const n={handler:this.onCustomMenuSelected.bind(this,e.id,t.id),isVisible:()=>t.visible,mnemonic:!1,checked:t.checked,...ae.Z.makeLabelPair(t.name)};return t.submenu&&(n.items=t.submenu.map((t=>({handler:this.onCustomMenuSelected.bind(this,e.id,t.id),isVisible:()=>t.visible,mnemonic:!1,checked:t.checked,...ae.Z.makeLabelPair(t.name)})))),n})),l=[{handler:()=>d.ZP.openURL(this.context.vivaldiWindowId,i),...ae.Z.makeLabelPair(e.name||"")},...r.length>0?[ae.Z.separatorItem,...r,ae.Z.separatorItem]:[],{handler:()=>this.showOptionsPage(e.id),isVisible:()=>void 0!==e.optionspage&&""!==e.optionspage,...(0,xs.Z)("Options")},{handler:()=>this.removeExtension(e.id),isVisible:()=>"componentAction"!==e.extensionType,ellipsis:!0,...(0,xs.Z)("Remove Extension")},{handler:()=>this.toggleVisibility(e.id),isVisible:()=>!o&&Boolean(e.actionIsHidden),...(0,xs.Z)("Show Button")},{handler:()=>this.toggleVisibility(e.id),isVisible:()=>!o&&!e.actionIsHidden,...(0,xs.Z)("Hide Button")},ae.Z.separatorItem,{handler:()=>Ae.Z.showExtensions(this.context.vivaldiWindowId),...(0,xs.Z)("Manage Extensions")}];return t(l)}))}));switchToggleButton=()=>{this.props.prefValues[$.kAddressBarExtensionsShowAllToggle]?this.setState((e=>({shouldRenderAllExtensionsOnToolbar:!e.shouldRenderAllExtensionsOnToolbar}))):this.setState((e=>({shouldRenderHiddenExtensionsOnToolbar:!e.shouldRenderHiddenExtensionsOnToolbar})))};renderExtensionToggleButton=()=>Ta(Fa,{tooltip:(0,Oe.Z)("Toggle extensions"),onClick:this.switchToggleButton,image:Ts.v9y[this.props.size||"large"],customizeMenu:this.props.customizeMenu,menuOrigin:this.props.menuOrigin,hidePopup:this.hideHiddenExtensionsPopup,draggable:this.props.draggable||!1,onDragStart:this.props.onDragStart??Aa.Z,onDragEnd:this.props.onDragEnd??Aa.Z,onDrop:this.props.onDrop??Aa.Z,onDragEnter:this.props.onDragEnter??Aa.Z,onDragLeave:this.props.onDragLeave??Aa.Z,onDragOver:this.props.onDragOver??Aa.Z,mimeType:this.props.mimeType,name:this.props.name,size:this.props.size});renderHiddenExtensionInPopup=()=>{const{size:e="large"}=this.props,t=this.props.prefValues[$.kAddressBarExtensionsShowAllToggle],n=this.state.extensions.filter((e=>t?this.isExtensionAvailable:t?void 0:e.actionIsHidden&&this.isExtensionAvailable(e)));return Ta(Fa,{image:Ts.v9y[e],tooltip:(0,Oe.Z)("Show hidden extensions"),onClick:this.toggleHiddenExtensionsPopup,customizeMenu:this.props.customizeMenu,menuOrigin:this.props.menuOrigin,popupPosition:this.props.popupPosition,hidePopup:this.hideHiddenExtensionsPopup,isPopupVisible:this.state.extensionPopup,popupWidth:Math.min(34*n.length,442),className:"extensionPopupIcons",popupClassName:"extensionIconPopupMenu ToolbarButtonPopup-DefaultStyles",hasLightArrow:!0,size:e,hidePopup:this.hideHiddenExtensionsPopup,draggable:this.props.draggable||!1,onDragStart:this.props.onDragStart??Aa.Z,onDragEnd:this.props.onDragEnd??Aa.Z,onDrop:this.props.onDrop??Aa.Z,onDragEnter:this.props.onDragEnter??Aa.Z,onDragLeave:this.props.onDragLeave??Aa.Z,onDragOver:this.props.onDragOver??Aa.Z,mimeType:this.props.mimeType,name:this.props.name},void 0,(0,fs.jsx)("div",{ref:this.refWrapper,className:"toolbar toolbar-mainbar toolbar-wrap",tabIndex:"-1",children:n.map(((e,t)=>{const n=this.getExtensionIndex(e.id);return(0,fs.jsx)(Fa,{className:"ExtensionDropdownIcon extensionId",badgeText:e.badgeText,tooltip:e.name,tabIndex:0,draggable:this.props.draggable||!1,imagePath:e.badgeIcon,ref:e=>this._toolbarButtons[n]=e,onClick:this.executeExtensionAction.bind(this,e.id),menu:this.getContextMenu.bind(this,e),onDragEnter:()=>this.onDragEnter(e.id),onDragStart:this.stopPropagation,onDragEnd:this.stopPropagation,mimeType:Ea,name:e.id,onDrop:this.onDrop},e.id)}))}))};render(){const e=this.props.prefValues[$.kAddressBarExtensionsRenderInDropdown],t=this.state.shouldRenderAllExtensionsOnToolbar&&!e,n=this.state.shouldRenderHiddenExtensionsOnToolbar&&!e,s=this.props.preview?[]:this.state.extensions.filter((e=>this.isExtensionAvailable(e)));if(!this.props.preview&&0===s.length)return(0,fs.jsx)("div",{ref:this.refExtensionAnchor,className:"toolbar-extensions"});const i=this.props.prefValues[$.kAddressBarExtensionsShowAllToggle];return(0,fs.jsxs)(fs.Fragment,{children:[(0,fs.jsxs)("div",{ref:this.refToolbar,className:"toolbar-extensions",children:[!this.props.preview&&s.filter((e=>!i&&n||!i&&!e.actionIsHidden||i&&t)).map(((e,t)=>{const n=e.badgeIcon?e.badgeIcon:"data:image/svg+xml;utf8,"+Ts.N_W,s=this.getExtensionIndex(e.id);let o,a=e.badgeBackgroundColor?B()(e.badgeBackgroundColor):void 0;return a&&a.alpha()<.5?a=void 0:a&&a?.alpha()<1&&(a=a.alpha(1)),o=e.badgeIcon?e.badgeText:e.name?e.name.charAt(0).toUpperCase():"",(0,fs.jsx)(Fa,{badgeColor:a,badgeText:o,onClick:this.executeExtensionAction.bind(this,e.id),menu:this.getContextMenu.bind(this,e),tooltip:e.badgeTooltip||e.name||(0,Oe.Z)("Extension"),popupClassName:"extensionIconPopupMenu ToolbarButtonPopup-DefaultStyles",size:this.props.size,draggable:this.props.draggable||!1,className:As()(e.id,"ExtensionIcon","extensionId",{"ExtensionIcon--Hidden":!i&&e.actionIsHidden}),menuOrigin:this.props.menuOrigin,imagePath:n,popupPosition:this.props.popupPosition,ref:e=>{this._toolbarButtons[s]=e},onDragEnter:()=>this.onDragEnter(e.id),onDragStart:this.stopPropagation,onDragEnd:this.stopPropagation,onDrop:this.onDrop,mimeType:Ea,name:e.id},e.id)})),(this.props.preview||s.length>0&&!e&&(i||!i&&this.hasHiddenExtensions()))&&this.renderExtensionToggleButton(),s.length>0&&e&&(i||this.hasHiddenExtensions()&&!i)&&this.renderHiddenExtensionInPopup(),this.state.popupId&&Ta("div",{},void 0,(0,fs.jsx)(Sa,{ref:this.extensionActionPopupRef,extensionId:this.state.popupId,outsideClickIgnoreClass:"extensionId",popupVisible:this.state.popupVisible,popupPage:this.state.popupPage,popupPosition:this.props.popupPosition,popupWantsToClose:this.popupWantsToClose,popupRect:this.state.popupRect}))]}),(0,fs.jsx)("div",{ref:this.refExtensionAnchor})]})}}const Ma=sa(ta(_a),Za);var Na,Pa=n(34155);function Da(e,t,n,s){Na||(Na="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Na,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const xa="vivaldi/x-button-toolbar",Oa=n(39135),La=[$.kKeyboardTabToAll,$.kMailCountersPanelUnseenEnabled,$.kThemesPreferCustomButtons,$.kThemesCurrentButtons,$.kToolbarButtonPopupSizes,$.kThemeUseAnimation];function Ra(e,t,n){switch(e){case"children":return!t.isPopupVisible&&!n.isPopupVisible||t.children===n.children;case"buttonStyle":case"style":if(t[e]&&n[e])return Gi(t[e],n[e])}return t[e]===n[e]}class Ba extends hs.Component{static contextType=xi.Z;nodeRef=hs.createRef();uuid=crypto.randomUUID();setButtonRef=e=>{this.buttonRef=e,this.buttonRef&&this.props.isPopupVisible&&this.forceUpdate()};state={isMenuVisible:!1,currentTheme:is.Z.getCurrentId(this.context.vivaldiWindowId)};componentDidMount(){z.Z.addListener(this.onThemeStoreChanged)}shouldComponentUpdate(e,t){return!Gi(this.props,e,Ra)||!Gi(this.state,t)}componentWillUnmount(){z.Z.removeListener(this.onThemeStoreChanged),this.context.removeEventListener("pointerup",this.pointerUp,!0)}onThemeStoreChanged=()=>{const e=is.Z.getCurrentId(this.context.vivaldiWindowId);this.setState({currentTheme:e})};hasMenu=()=>Boolean(this.props.menu);getContextMenuHandler=e=>this.hasMenu()||Boolean(this.props.customizeMenu)?this.showCustomizeMenu(e,e.target):null;showMenu=async e=>{if(this.props.dragging)return;if(!this.props.menuOrigin)return void console.warn("ToolbarButton: showMenu called without menuOrigin");let t;const n=e||this.buttonRef;if(this.props.menu){const e=this.props.menu();t=Array.isArray(e)?e:await e}else t=[];this.props.customizeMenu&&(t=t.concat(this.props.customizeMenu)),0!==t.length?(this.context.removeEventListener("pointerup",this.pointerUp,!0),(0,Qi.Z)(this.context,t,this.menuVisibilityChanged,this.props.menuOrigin,n||void 0)()):console.warn("ToolbarButton: showMenu called without a menu")};showCustomizeMenu=async(e,t)=>{if(this.props.disabled&&!this.props.alwaysMenu)return;let n;if(e.persist(),(0,to.ZP)(e),this.props.menu){const e=this.props.menu();n=Array.isArray(e)?e:await e}else n=[];this.props.customizeMenu&&(n=n.concat(this.props.customizeMenu)),(0,Qi.Z)(this.context,n,this.menuVisibilityChanged)(e)};getRect=()=>this.buttonRef?.getBoundingClientRect();hidePopup=()=>{this.props.hidePopup?.()};onBlur=e=>{this.props.onBlur?.(e)};onFocus=e=>{e.persist(),this.props.onFocus?.(e)};onDragStart=e=>{this.props.onDragStart?.(e),clearTimeout(this.menuTimer)};pointerLeave=e=>{clearTimeout(this.menuTimer),this.props.onPointerLeave&&this.props.onPointerLeave(e)};menuVisibilityChanged=e=>{e?(this.setState({isMenuVisible:!0}),this.props.onContextMenuVisibilityChanged?.(!0)):Pa.nextTick((()=>{this.setState({isMenuVisible:!1}),this.props.onContextMenuVisibilityChanged?.(!1)}))};onMenuIndicator=e=>{const{parentElement:t}=e.target;""===wa.getState()&&!Jo(e)&&t instanceof this.context.HTMLElement&&(0,to.ZP)(e),this.state.isMenuVisible||setTimeout((()=>this.showMenu(t)),90)};pointerDown=e=>{const t=Date.now(),n=""===wa.getState();if(this.pointerTimestamp&&t-this.pointerTimestamp<150)e.preventDefault();else if(e.persist(),!n||Jo(e)&&G.ZP.isActive(this.context.vivaldiWindowId)||e.button!==Hi.Z.kLeft||"function"!=typeof this.props.onPointerDown){if(n){const n=e.currentTarget;let s=!0;!Jo(e)&&e.preventDefault(),e.button===Hi.Z.kLeft&&this.hasMenu()?this.props.onClick?this.menuTimer=setTimeout((()=>this.showMenu(n)),650):this.state.isMenuVisible&&(s=!1):e.button===Hi.Z.kRight&&(this.hasMenu()||this.props.customizeMenu)&&(e.stopPropagation(),s=!1),s&&(this.pointerTimestamp=t,this.context.addEventListener("pointerup",this.pointerUp,!0))}}else this.props.onPointerDown(e)};pointerUp=e=>{this.context.removeEventListener("pointerup",this.pointerUp,!0),clearTimeout(this.menuTimer);const t=this.buttonRef;if(t&&(e.target===t||e.target===t.parentElement)){const t="ctrlCmd"===this.props.modifier?e.ctrlKey:e.shiftKey;if(e.button===Hi.Z.kCenter||t)(0,to.ZP)(e),this.props.onMiddleClick&&this.props.onMiddleClick(e);else if(e.button===Hi.Z.kLeft){const t=Date.now()-this.pointerTimestamp;this.props.onClick&&("mouse"===e.pointerType||t<650)?this.props.onClick(e):this.hasMenu()&&((0,to.ZP)(e),e.target instanceof this.context.HTMLElement&&this.showMenu(e.target))}}};onAuxClick=e=>{e.button===Hi.Z.kCenter&&(0,to.ZP)(e)};keyDown=e=>{clearTimeout(this.menuTimer);const t=e.keyCode;this.props.onKeyDown?this.props.onKeyDown(e):this.hasMenu()&&e.shiftKey&&t===oa.Z.KEY_DOWN?(this.showMenu(e.currentTarget),(0,to.ZP)(e)):t!==oa.Z.KEY_SPACE&&t!==oa.Z.KEY_ENTER&&t!==oa.Z.KEY_RETURN||(this.props.onClick?this.props.onClick(e):this.hasMenu()&&((0,to.ZP)(e),this.showMenu(e.currentTarget)))};handleResize=e=>{if(!this.props.id)return;const t=this.props.prefValues[$.kToolbarButtonPopupSizes]??{};Ne.Z.set($.kToolbarButtonPopupSizes,{...t,[this.props.id]:Math.round(e)})};renderPanelAudioIcon=()=>{const{mediaState:e,mediaStateType:t,name:n,toggleMuted:s}=this.props;return t&&"panel"===t&&void 0!==e?Da("span",{className:"panel-audio",onClick:n&&s?()=>s(n):null},void 0,Da(Qo,{color:"#111",animated:!1,mediaState:new Set([e?"muting":"playing"]),src:"panel"})):null};renderWorkspaceAudioIcon=()=>{const{prefValues:e}=this.props;return Da("span",{className:"button-icon audio"},void 0,Da(Qo,{animated:e[$.kThemeUseAnimation],mediaState:new Set(["playing"]),src:"tab"}))};renderBadge=()=>{const{badgeText:e,badgeColor:t}=this.props;if(!e)return null;return Da("span",{className:"button-badge",style:t?{backgroundColor:t}:{}},void 0,e)};_onDragEnter=e=>{const t=e.dataTransfer.types.some((e=>e===xa||e===Ea));if(t){const{onDrop:e,onDragEnter:t}=this.props;Boolean(e&&t)&&t?.()}else{const{onPanelButtonDragEnter:n}=this.props;n?.(e,t)}};_onDragLeave=e=>{if(e.dataTransfer.types.some((e=>e===xa||e===Ea))){const{onDrop:t,onDragLeave:n}=this.props;Boolean(t&&n)&&n?.(e)}else{const{onPanelButtonDragLeave:e}=this.props;e?.()}};render(){const{disabled:e,buttonClasses:t,faviconPath:n=null,image:s,imagePath:i=null,imageOverride:o=null,title:a=null,style:r,buttonStyle:l,tabIndex:d,isMenuIndicatorVisible:c=!1,isMenuIndicatorDisabled:h=!1,isPopupVisible:p=!1,hidePopup:u,popupPosition:g,draggable:m,tooltip:v,children:f=null,limitToDrag:y,onDragEnd:C,onDragEnter:w,onDragOver:b,onDrop:S,onPointerEnter:I,prefValues:k,name:A,autoFocus:T,mediaState:Z,mediaStateType:E,faviconLoadType:_}=this.props,M="workspace"===E&&Z,N="number"==typeof d?d:k[$.kKeyboardTabToAll],P=Boolean(S&&w),D=100*(this.props.progress??0),x=k[$.kToolbarButtonPopupSizes]??{},O=this.props.isPopupResizable&&this.props.id?x[this.props.id]:void 0;if(!a&&!v)return console.warn("Button hidden due to missing title and tooltip"),null;const L=[this.uuid,this.props.outsideClickIgnoreClass||""],R=k[$.kThemesPreferCustomButtons]?o||A:void 0,B=R&&"none"!==R?z.Z.getToolbarButtonImage(R):null,F=B?.toLowerCase().endsWith(".svg"),V=`${this.uuid}__${k[$.kThemesCurrentButtons]}`;let W;return s&&B&&F?W=Da(la,{url:B,className:"button-icon override"},V):s&&B&&!F?W=Da("img",{src:B,className:"button-icon override"},V):B||i||n||!s?!i&&n?W=Da(Ss,{url:n,className:"button-icon favicon",loadType:_??Cs(n)?"faviconFromCache":"page"}):i&&(W=Da("img",{src:i,className:"button-icon",alt:""})):W=Da("span",{className:"button-icon",dangerouslySetInnerHTML:{__html:s}}),this.props.imageOnly&&W?Da("div",{className:As()("button-toolbar",this.props.className)},void 0,W):(0,fs.jsxs)("div",{ref:this.nodeRef,className:As()("button-toolbar",this.props.className,{[this.uuid]:f,"button-menu":c,"button-disabled-preview":e&&m}),onContextMenu:e?this.getContextMenuHandler:null,onPointerEnter:e?I:null,style:r,onPointerDown:e&&m?y:null,title:e?v?.trim()||a:null,...qo({draggable:m,onDragStart:e&&m?this.onDragStart:null,onDragEnd:m?C:null,onDragOver:P?b:null,onDrop:P?S:null}),onDragEnter:this._onDragEnter,onDragLeave:this._onDragLeave,children:[(0,fs.jsxs)("button",{name:A,ref:this.setButtonRef,disabled:e&&!m,draggable:m,onDragStart:!e&&m?this.onDragStart:null,tabIndex:0!==N?N:null,onKeyDown:this.keyDown,onPointerDown:this.pointerDown,onClick:to.ZP,onAuxClick:this.onAuxClick,autoFocus:T,onPointerEnter:I,onPointerLeave:this.pointerLeave,onDoubleClick:to.ZP,onContextMenu:this.getContextMenuHandler,onBlur:this.onBlur,onFocus:this.onFocus,style:l||null,title:e?null:v?.trim()||a,type:"button",className:As()("ToolbarButton-Button",t),children:[W,a&&Da("span",{className:"button-title"},void 0,a),M&&this.renderWorkspaceAudioIcon(),!M&&c&&Da("span",{className:As()("button-toolbar-menu-indicator",{disabled:this.state.isMenuVisible||h}),onPointerDown:this.onMenuIndicator,dangerouslySetInnerHTML:{__html:Oa}}),this.renderBadge(),this.renderPanelAudioIcon()]}),D>0&&D<100&&Da("div",{className:"progress"},void 0,Da("div",{className:"loaded",style:{width:`${D}%`}})),p&&f&&u&&g&&this.buttonRef&&Da(ya,{outsideClickIgnoreClass:L,hasLightArrow:this.props.hasLightArrow,hidePopup:this.hidePopup,className:this.props.className,buttonRef:this.buttonRef,width:this.props.popupWidth,popupClassName:this.props.popupClassName,popupPosition:g,isResizable:Boolean(this.props.isPopupResizable),height:O,onResize:this.handleResize},void 0,f)]},this.uuid)}}const Fa=sa(ta(Ba),La);var Va,Wa=n(34155);function Ua(e,t,n,s){Va||(Va="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Va,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Ha(e){return e.children?e.children.reduce(((e,t)=>{if(t.speeddial)return e.push(t),e;if(t.children?.length){const n=Ha(t);(n?.length||t.speeddial)&&e.push({...t,children:n})}return e}),[]):[]}var za=Ua(jo,{type:"search",size:18,className:"BookmarkLocationSelector-SearchInput-Icon"});function Ga({onValueChange:e,value:t,placeholder:n}){return Ua("div",{className:"BookmarkLocationSelector-SearchInput"},void 0,Ua("input",{placeholder:n,className:"BookmarkLocationSelector-SearchInput-Input",type:"search",value:t,onChange:({currentTarget:t})=>e(t.value)}),za)}const $a=Object.freeze({folders:!0,bookmarks:!1});class Ka extends hs.PureComponent{refFolderList=hs.createRef();state={nodes:ps.ZP.getFilteredTree("",{...$a,root:"bookmarks"===this.props.mode}).nodes,filter:"",isEditing:!1};componentDidMount(){ps.ZP.addListener(this.handleBookmarkStoreChange)}componentWillUnmount(){ps.ZP.removeListener(this.handleBookmarkStoreChange)}handleBookmarkStoreChange=()=>{this.setState((e=>({nodes:[...ps.ZP.getFilteredTree(e.filter,{...$a,root:"bookmarks"===this.props.mode}).nodes]})))};handleNewFolderButtonClick=async()=>{this.setState({isEditing:!0});const e=this.state.filter||(0,Oe.Z)("command","New Folder"),t=this.state.filter?"1":this.props.parentId,n="speeddial"===this.props.mode&&t===ps.q3,i=await s.Z.bookmarks.create({parentId:t,title:e,speeddial:n});this.refFolderList.current?.expand(t),await this.props.onParentIdChange(i.id),this.refFolderList.current?.startInlineEdit(i.id),this.setState({filter:""})};setParentOnSelect=async e=>{await this.props.onParentIdChange(e)};scrollToId=async e=>{await new Promise((e=>Wa.nextTick(e))),this.refFolderList.current?.scrollToId(e),await new Promise((e=>Wa.nextTick(e)))};toggleFolderChange=async()=>{const e="bookmarks"===this.props.mode?"speeddial":"bookmarks";await this.props.onModeChange(e),this.handleBookmarkStoreChange(),this.refFolderList.current?.focus()};handleFolderTitleChange=(e,t)=>{this.setState({isEditing:!1}),this.props.onFolderTitleChange(e,t)};handleFilterChange=e=>{const t=[...ps.ZP.getFilteredTree(e,{...$a,root:"bookmarks"===this.props.mode}).nodes];this.setState({filter:e,nodes:t},(()=>this.refFolderList.current?.expandAll()))};render(){const{className:e}=this.props,t="1"===this.props.parentId,n=this.state.nodes,s="speeddial"===this.props.mode?Ha({children:n}):n;return Ua("div",{className:As()("BookmarkLocationSelector",e)},void 0,Ua("p",{className:"BookmarkLocationSelector-Header"},void 0,(0,Oe.Z)("bookmarkeditor","Location")),Ua("div",{className:"BookmarkLocationSelector-SpeedDialCheckbox"},void 0,Ua("label",{},void 0,Ua("input",{type:"checkbox",checked:"speeddial"===this.props.mode,onChange:this.toggleFolderChange}),Ua("span",{},void 0,(0,Oe.Z)("Show only Speed Dial folders")))),Ua(Ga,{value:this.state.filter,onValueChange:this.handleFilterChange,placeholder:"speeddial"===this.props.mode?(0,Oe.Z)("Find in Speed Dial Folders"):(0,Oe.Z)("Find in All Folders")}),(0,fs.jsx)(Zo,{ref:this.refFolderList,folders:s,onSelect:this.setParentOnSelect,selectedId:this.props.parentId,isEditing:this.state.isEditing,expandAll:!t,onFolderTitleChange:this.handleFolderTitleChange,className:"BookmarkLocationSelector-FolderList",defaultEditFolderText:this.state.filter||(0,Oe.Z)("command","New Folder")}),Ua(Fa,{image:Ts.md4.small,title:"bookmarks"===this.props.mode?(0,Oe.Z)("Add a new folder in bookmarks","New Folder"):(0,Oe.Z)("New Speed Dial Folder"),size:"medium",className:"BookmarkLocationSelector-AddFolderButton",onClick:this.handleNewFolderButtonClick}))}}var ja;function Ya(e,t,n,s){ja||(ja="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:ja,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Xa({value:e,title:t,onChange:n,autoFocus:s}){return Ya("label",{className:"BookmarkInputField"},void 0,Ya("span",{className:"BookmarkInputField-Title"},void 0,t),Ya("input",{className:"BookmarkInputField-Input",type:"text",value:e,onChange:n,autoFocus:s}))}class Qa extends hs.PureComponent{refLocationSelector=hs.createRef();scrollToId=async e=>{await(this.refLocationSelector.current?.scrollToId(e))};render(){const{title:e,onTitleChange:t,autoFocus:n,url:s,onUrlChange:i,nickname:o,onNicknameChange:a,description:r,onDescriptionChange:l,onParentIdChange:d,parentId:c,onFolderTitleChange:h,locationSelectMode:p,onDeleteBookmarkClick:u,onClosePopupClick:g,onLocationSelectModeChange:m}=this.props,v=(f=c,ps.ZP.getItemById(f)?.title);var f;return Ya("form",{className:"BookmarkPopup",onSubmit:g},void 0,Ya("header",{className:"dialog-header"},void 0,Ya("h1",{className:"DialogHeader-HeaderText"},void 0,(0,Oe.Z)("Added Bookmark")),v&&Ya("p",{},void 0,(0,Oe.Z)("to $1",[v]))),Ya("div",{className:"dialog-content"},void 0,Ya("div",{className:"BookmarkPopup-TextInputWrapper"},void 0,Ya(Xa,{title:(0,Oe.Z)("bookmarkeditor","Name"),value:e,onChange:({currentTarget:e})=>{t(e.value)},autoFocus:"title"===n}),Ya(Xa,{title:(0,Oe.Z)("URL"),value:s,onChange:({currentTarget:e})=>i(e.value),autoFocus:"url"===n}),Ya(Xa,{title:(0,Oe.Z)("Nickname"),value:o,onChange:({currentTarget:e})=>a(e.value),autoFocus:"nickname"===n}),Ya(Xa,{title:(0,Oe.Z)("Description"),value:r,onChange:({currentTarget:e})=>l(e.value),autoFocus:"description"===n})),(0,fs.jsx)(Ka,{ref:this.refLocationSelector,className:"BookmarkPopup-LocationSelector",onParentIdChange:d,parentId:c,onFolderTitleChange:h,mode:p,onModeChange:m})),Ya("footer",{className:"dialog-footer"},void 0,Ya("input",{type:"submit",value:(0,Oe.Z)("bookmarkeditor","Done")}),Ya("input",{type:"button",className:"danger",onClick:u,value:(0,Oe.Z)("bookmarkeditor","Remove")})))}}var qa=n(57904);const Ja=new class{setBackgroundTasks(e){y.Z.dispatch({actionType:"BACKGROUND_TASKS_SET",tasks:e})}};const er=function(e,t,n,s,i,o){this.id=e,this.title=n,this.description=i,this.menuItems=o,this.progress=0,this.text=t},tr="thumbnailCapture";const nr=new class{pendingEntries=[];activeEntries=[];tasks=[];add=(e,t,n)=>{this.pendingEntries.push({id:e,url:t,callback:n})};run=()=>{for(;;){if(this.activeEntries.length>=1)return;if(0===this.pendingEntries.length)return void(0===this.activeEntries.length&&(this.removeFromArrayById(tr,this.tasks),Ja.setBackgroundTasks(this.tasks)));const e=this.pendingEntries.shift();this.activeEntries.push(e);let t=this.getFromArrayById(tr,this.tasks);t||(t=new er(tr,"","Thumbnail Capture","",[{name:(0,Oe.Z)("Cancel"),handler:function(){this.pendingEntries=[]}.bind(this)}]),this.tasks.push(t)),t.title=(0,Oe.Z)("Updating thumbnail for $1",[e.url]),t.description=(0,Oe.Z)("$1 bookmark waiting for update.","$1 bookmarks waiting for update.",[this.pendingEntries.length]),t.text=this.pendingEntries.length+this.activeEntries.length,Ja.setBackgroundTasks(this.tasks),e.callback.call(null,e.id,e.url)}};onLoaded=e=>{this.removeFromArrayById(e,this.activeEntries),this.run()};contains=e=>this.isInArrayById(e,this.pendingEntries)||this.isInArrayById(e,this.activeEntries);getFromArrayById=(e,t)=>t.find((t=>t.id===e));isInArrayById=(e,t)=>t.length>0&&void 0!==this.getFromArrayById(e,t);removeFromArrayById=(e,t)=>{const n=t.findIndex((t=>t.id===e));-1!==n&&t.splice(n,1)}},sr=440,ir=360;let or=0;const ar=new Map,rr={getPageThumbnail(e,t,n){or>4||(or++,e.getThumbnail(lr(t),(e=>{or--,s.Z.runtime.lastError?n(void 0):n(e||void 0)})))},updateForBookmark(e,t){this.updateForBookmarks([{id:e,url:t}])},updateForBookmarks(e){for(const t of e){const e=t.url;e&&!nr.contains(t.id)&&(nr.add(t.id,je.jk.getUrl(e),dr),cr(t.id))}nr.run()},linkAndQueryUpdatingBookmark:(e,t)=>t?(ar.set(e,t),nr.contains(t)):(ar.delete(e),!1),unlinkBookmarkComponent(e){ar.delete(e)}},lr=e=>e.compact?{width:330,height:270}:{width:sr,height:ir},dr=(e,t)=>{const n={bookmarkId:e,url:t};C.Z.thumbnails.captureBookmark(n).then((t=>{nr.onLoaded(e),cr(e)}))};function cr(e){for(const[t,n]of ar)n===e&&t.forceUpdate()}const hr=rr;async function pr(e){try{const t=await s.Z.tabs.sendMessage(e,{action:"fetchBookmarkMetadata"});if("bookmarkData"===t.type){const{title:e,url:n,description:s,imageUrl:i}=t.data,o=i?await async function(e,t,n){return new Promise(((s,i)=>{const o=new Image;o.crossOrigin="anonymous",o.onload=()=>{let e=o.naturalWidth,i=o.naturalHeight;n&&(e>sr&&(i*=sr/e,e=sr),i>ir&&(e*=ir/i,i=ir));const a=document.createElement("canvas"),r=a.getContext("2d");a.width=e,a.height=i,r.drawImage(o,0,0,e,i),a.toBlob((e=>{a.remove(),s(e)}),t)},o.onerror=i,o.src=e}))}(i,"image/png",!0):null;return{title:e,url:n,description:s,thumbnail_blob:o,thumbnail_content_type:"image/png"}}}catch(e){console.error(e)}}var ur;function gr(e,t,n,s){ur||(ur="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:ur,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function mr(e,t){return s.Z.bookmarks.update(e,t)}function vr(e){return H.Z.get($.kBookmarksFetchPageMetadata)&&!(0,je.cw)(e)}async function fr(e){return new Promise(((t,n)=>{const s={url:e?.url||"",title:e?(0,je.d6)(e.url,e.title):"",description:"",thumbnail_blob:null,thumbnail_content_type:""};e?.vivExtData.thumbnail?fetch(e?.vivExtData.thumbnail).then((e=>e.blob())).then((e=>{s.thumbnail_blob=e,s.thumbnail_content_type=e.type})).catch((e=>{console.log(e)})).finally((()=>{t(s)})):t(s)}))}class yr extends hs.PureComponent{static contextType=xi.Z;state={status:"standby",isBookmarkPopupOpen:!1,title:this.props.bookmarkData?.title||"",url:this.props.bookmarkData?.url||"",description:this.props.bookmarkData?.description||"",thumbnail:this.props.bookmarkData?.thumbnail||"",nickname:this.props.bookmarkData?.nickname||"",parentId:this.props.bookmarkData?.parentId||"",popupLocationSelectMode:"bookmarks"};componentDidMount(){qa.Z.addListener(this.onWebpageviewStoreChanged)}componentWillUnmount(){qa.Z.removeListener(this.onWebpageviewStoreChanged)}onWebpageviewStoreChanged=async e=>{if(e.winId!==this.context.vivaldiWindowId||"WEBPAGEVIEW_ACTIONS"!==e.type||"addBookmark"!==e.action)return;const t=ie.ZP.getPageInWindow(e.winId,e.pageId);if(!t)return;if(ps.ZP.findByUrl(t.url))return void this.setIsBookmarkPopupOpen(!0);const n=vr(t.url)&&await pr(t.id)||await fr(t);await this.bookmarkPage(n),H.Z.get($.kBookmarksConfirmAdding)&&this.setIsBookmarkPopupOpen(!0)};componentDidUpdate(e,t){if(t.isBookmarkPopupOpen&&!this.state.isBookmarkPopupOpen&&this.props.bookmarkData){const{title:e,url:t,description:n,nickname:s}=this.state;mr(this.props.bookmarkData.id,{title:e,url:t,description:n,nickname:s})}else this.props.bookmarkData?e.bookmarkData||this.setState({title:this.props.bookmarkData.title,url:this.props.bookmarkData.url,description:this.props.bookmarkData.description,thumbnail:this.props.bookmarkData.thumbnail,nickname:this.props.bookmarkData.nickname,parentId:this.props.bookmarkData.parentId,status:"bookmarked"}):this.setState({title:"",url:"",description:"",thumbnail:"",nickname:"",parentId:""}),"bookmarked"===this.state.status&&setTimeout((()=>{this.state.isBookmarkPopupOpen||this.setState({status:"standby"})}),4e3)}setIsBookmarkPopupOpen(e){e?this.setState({isBookmarkPopupOpen:e}):this.setState({isBookmarkPopupOpen:e,status:"standby"}),this.props.onBookmarkPopupVisibilityChange?.(e)}bookmarkPage=async e=>{let t=H.Z.get($.kBookmarksSaveFolder);const n=ps.ZP.getItemById(t);n&&!ps.ZP.isTrashed(n)||(t=ps.SZ);const s={parentId:t,title:e.title,url:e.url,description:e.description,thumbnail:""};if(e.thumbnail_blob)try{s.thumbnail=await C.Z.utilities.storeImage({data:await e.thumbnail_blob.arrayBuffer(),mimeType:e.thumbnail_content_type})}catch(e){console.error(e)}const i=await this.props.setBookmarked(s);i.parentId&&this.refBookmarkPopup.current?.scrollToId(i.parentId)};onDeleteBookmarkClick=async()=>{this.setState({status:"standby"}),this.props.bookmarkData&&(await g.Z.remove([this.props.bookmarkData.id]),this.setIsBookmarkPopupOpen(!1))};onBookmarkButtonClicked=async()=>{if(this.setState((e=>this.props.bookmarkData||e.isBookmarkPopupOpen||H.Z.get($.kBookmarksConfirmAdding)?(this.props.onBookmarkPopupVisibilityChange&&this.props.onBookmarkPopupVisibilityChange(!e.isBookmarkPopupOpen),{isBookmarkPopupOpen:!e.isBookmarkPopupOpen}):e)),!this.props.bookmarkData){const e=ie.ZP.getPageById(this.props.pageId);if(!e)return;const t=vr(e.url)&&await pr(this.props.pageId)||await fr(e);await this.bookmarkPage(t)}};handleParentIdChange=async e=>{const t=ps.ZP.getItemById(e);t&&!ps.ZP.isFolder(t)&&(console.info("handleParentIdChange: parentId is not a folder."),e=ps.SZ),this.props.bookmarkData&&(await g.Z.move([this.props.bookmarkData.id],e),Ne.Z.set($.kBookmarksSaveFolder,e),this.setState({parentId:e}))};handleTitleChange=e=>{this.setState({title:e})};handleUrlChange=e=>{this.setState({url:e})};handleNicknameChange=e=>{this.setState({nickname:e})};handleDescriptionChange=e=>{this.setState({description:e})};handleFolderTitleChange=(e,t)=>{mr(e,{title:t})};hidePopup=()=>{this.setIsBookmarkPopupOpen(!1)};onLocationSelectModeChange=e=>{this.setState({popupLocationSelectMode:e})};refBookmarkPopup=hs.createRef();render(){const{title:e,url:t,nickname:n,description:s,thumbnail:i,parentId:o}=this.state,a="bookmarked"===this.state.status||this.state.isBookmarkPopupOpen,r="bookmarked"===this.state.status&&!this.state.isBookmarkPopupOpen||this.props.isBookmarkPopup?(0,Oe.Z)("Added bookmark"):"",l=H.Z.get($.kAddressBarVisible)&&!G.ZP.isMinimalUI(this.context.vivaldiWindowId);return gr("div",{className:As()("BookmarkButton",{"BookmarkButton--Active":a})},void 0,gr(Fa,{onClick:this.onBookmarkButtonClicked,tooltip:(0,Oe.Z)("tooltip","Bookmark Page"),image:Ts.oJy,hidePopup:this.hidePopup,popupPosition:l?this.props.popupPosition:"below",isPopupVisible:this.state.isBookmarkPopupOpen,popupWidth:356,className:"BookmarkButton-Button",isOn:Boolean(this.props.bookmarkData),title:r},void 0,(0,fs.jsx)(Qa,{ref:this.refBookmarkPopup,onDeleteBookmarkClick:this.onDeleteBookmarkClick,onClosePopupClick:this.hidePopup,onParentIdChange:this.handleParentIdChange,onTitleChange:this.handleTitleChange,onUrlChange:this.handleUrlChange,onNicknameChange:this.handleNicknameChange,onDescriptionChange:this.handleDescriptionChange,onFolderTitleChange:this.handleFolderTitleChange,title:e,url:t,nickname:n,description:s,image:i,parentId:o,autoFocus:"title",locationSelectMode:this.state.popupLocationSelectMode,onLocationSelectModeChange:this.onLocationSelectModeChange})))}}var Cr;function wr(e,t,n,s){Cr||(Cr="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Cr,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class br extends hs.PureComponent{static contextType=xi.Z;#a;state={isBookmarkButtonOpen:!1};componentDidMount(){this.setExpireTimeout(5e3)}componentWillUnmount(){clearTimeout(this.#a)}setExpireTimeout(e){this.#a=setTimeout((()=>{this.props.onClose()}),e)}onSetBookmarked=e=>s.Z.bookmarks.create(e).then((t=>(Ae.Z.showBookmarkAddedPopup(this.context.vivaldiWindowId,{pageId:this.props.options.pageId,url:e.url??"",isActive:!0}),t)));handleBookmarkButtonVisibility(e){this.setState({isBookmarkButtonOpen:e}),clearTimeout(this.#a),e||this.setExpireTimeout(500)}render(){const e=ps.ZP.findByUrl(this.props.options.url),t="top"===H.Z.get($.kAddressBarPosition)?"below":"above";return wr(yr,{pageId:this.props.options.pageId,bookmarkData:e,setBookmarked:this.onSetBookmarked,popupPosition:t,isBookmarkPopup:!0,onBookmarkPopupVisibilityChange:e=>this.handleBookmarkButtonVisibility(e)})}}const Sr=br;var Ir;function kr(e,t,n,s){Ir||(Ir="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Ir,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Ar(){return ps.ZP.hasBeenInitialized()?{nodes:ps.ZP.getFoldersWithin(ps.ZP.getTopNodes(),0),bookmarksBarFolderId:ps.ZP.getBookmarkBarFolderId()}:{nodes:void 0,bookmarksBarFolderId:void 0}}class Tr extends hs.Component{state=Ar();_onStoreChange=()=>{this.setState(Ar())};componentDidMount(){ps.ZP.addListener(this._onStoreChange)}componentWillUnmount(){ps.ZP.removeListener(this._onStoreChange)}getFolderId=e=>{if(this.props.selectedItemID){const t=e.find((e=>e.id===this.props.selectedItemID));if(t)return t.id;console.warn("Bookmark folder not found")}return this.state.bookmarksBarFolderId};render(){const{nodes:e}=this.state;if(!e)return null;const t=this.getFolderId(e),n=e.find((e=>e.id===t))?.title||ps.Ei,s=e.map((e=>kr("option",{value:e.id},"dir_"+e.id," ".repeat(3*e.level),e.title)));return kr("span",{className:"bookmark-folder-picker"},void 0,kr("input",{type:"text",value:n,tabIndex:"-1",readOnly:!0}),kr("select",{className:"bookmark-folders",value:t,onChange:this.props.onChange},void 0,s))}}const Zr=Tr;var Er,_r=n(64473);function Mr(e,t,n,s){Er||(Er="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Er,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Nr={title:"",url:"",description:"",nickname:"",thumbnail:"",isFolder:!1,parentId:""};class Pr extends hs.PureComponent{static contextType=xi.Z;_parentId="";_index=0;state=Nr;constructor(e,t){super(e);const n=ps.ZP.getItemById(e.options.id);let s=Nr;switch(e.options.mode){case"edit":n&&(s={...s,title:n.title,url:n.url||"",thumbnail:n.thumbnail,description:n.description,nickname:n.nickname,isFolder:ps.ZP.isFolder(n),parentId:n.parentId||""});break;case"addbookmark":case"addfolder":if(n?ps.ZP.isFolder(n)?(this._parentId=n.id,this._index=0):(this._parentId=n.parentId??ps.SZ,this._index="number"==typeof n.index?n.index+1:0):(this._parentId=ps.SZ,this._index=0),s={...s,parentId:this._parentId,isFolder:"addfolder"===e.options.mode},!s.isFolder){const e=ie.ZP.getActivePage(t.vivaldiWindowId);e&&(s={...s,title:e.title,url:e.url,thumbnail:e.vivExtData.thumbnail})}}this.state=s}onCancel=()=>{this.props.onClose()};onSave=()=>{switch(this.props.options.mode){case"edit":{const e=this.props.options.id,t=Ds.ZP.verifyForUpdate({title:this.state.title,url:this.state.url,thumbnail:this.state.thumbnail,nickname:this.state.nickname,description:this.state.description},this.state.isFolder),n=ps.ZP.getItemById(e);n&&n.parentId!==this.state.parentId?g.Z.move([n.id],this.state.parentId,0).then((()=>{s.Z.bookmarks.update(e,t).then((()=>this.props.onClose()))})):s.Z.bookmarks.update(e,t).then((()=>this.props.onClose()));break}case"addbookmark":case"addfolder":{const e=Ds.ZP.verifyForCreate({parentId:this.state.parentId,index:this.state.parentId===this._parentId?this._index:0,title:this.state.title,url:this.state.url,nickname:this.state.nickname,description:this.state.description},this.state.isFolder);s.Z.bookmarks.create(e).then((()=>this.props.onClose()));break}default:this.props.onClose()}};changeValue=(e,t)=>{const n={};n[e]=t.target.value,this.setState(n)};render(){let e;switch(this.props.options.mode){case"edit":e=this.state.isFolder?(0,Oe.Z)("Edit Folder"):(0,Oe.Z)("Edit Bookmark");break;case"addbookmark":e=(0,Oe.Z)("New Bookmark");break;case"addfolder":e=(0,Oe.Z)("title","New Folder")}if(void 0===e)return null;const t=this.state.isFolder?(0,Oe.Z)("Folder Name"):(0,Oe.Z)("Bookmark Name");return Mr(_r.Z,{onRequestClose:this.onCancel},void 0,Mr("div",{className:"edit-bookmark"},void 0,Mr("header",{className:"dialog-header"},void 0,Mr("h1",{className:"dialog-title"},void 0,e)),Mr("form",{onSubmit:this.onSave},void 0,false,Mr("div",{className:"dialog-content"},void 0,Mr("input",{className:"title",type:"text",value:this.state.title,onChange:this.changeValue.bind(this,"title"),title:t,placeholder:t,autoFocus:!0}),!1===this.state.isFolder&&Mr("input",{className:"address",type:"text",value:this.state.url,onChange:this.changeValue.bind(this,"url"),title:(0,Oe.Z)("Address"),placeholder:(0,Oe.Z)("Address")}),void 0!==this.state.parentId&&Mr(Zr,{selectedItemID:this.state.parentId,onChange:this.changeValue.bind(this,"parentId")}),!1===this.state.isFolder&&Mr("input",{className:"nickname",type:"text",value:this.state.nickname,onChange:this.changeValue.bind(this,"nickname"),title:(0,Oe.Z)("Nickname"),placeholder:(0,Oe.Z)("Nickname")}),!1===this.state.isFolder&&Mr("textarea",{className:"description",type:"text",value:this.state.description,onChange:this.changeValue.bind(this,"description"),title:(0,Oe.Z)("Description"),placeholder:(0,Oe.Z)("Description")})),Mr("footer",{className:"dialog-footer"},void 0,Mr("input",{type:"submit",className:"primary",value:(0,Oe.Z)("Save")}),Mr("input",{type:"button",onClick:this.onCancel,value:(0,Oe.Z)("Cancel")})))))}}const Dr=Pr;class xr extends hs.PureComponent{static contextType=xi.Z;refButton=hs.createRef();componentDidMount(){this._reportSize()}componentDidUpdate(){this._reportSize()}_reportSize=()=>{const{HTMLElement:e}=this.context,t=this.refButton.current;t instanceof e&&this.props.onRendered(t.offsetWidth,t.offsetHeight)};_handleKeyDown=e=>{switch(e.key){case"ArrowUp":case"ArrowDown":case"Enter":this.props.onItemActivated(this.props.id,"Enter"===e.key,!0);break;case"ArrowLeft":this.props.moveFocus(this.props.id,"left",!1);break;case"ArrowRight":this.props.moveFocus(this.props.id,"right",!1);break;case"Escape":if(this.props.menuOpen)return;this.props.onLeaveBar();break;default:return}e.preventDefault(),e.stopPropagation()};_handleMouseDown=e=>{e.preventDefault()};_handleItemMouseUp=e=>{e.button===Hi.Z.kCenter&&e.preventDefault()};_handleClick=e=>{this.props.onItemActivated(this.props.id,!0,!0,e),e.preventDefault(),e.stopPropagation()};_handleBlur=()=>{this.props.onItemBlur(this.props.id)};_handleFocus=()=>{this.props.highlighted||this.props.onItemHighlightMissing(this.props.id)};_handleMouseEnter=e=>{this.props.onItemEnter(this.props.id)};_handleMouseLeave=e=>{this.props.onItemLeave(this.props.id)};render(){return(0,fs.jsx)("button",{ref:this.refButton,className:As()({bookmarkbarItem:!0,chevron:!0,highlighted:this.props.highlighted}),"data-id":this.props.id,"data-offset":this.props.offset,tabIndex:this.props.keyAccess,title:(0,Oe.Z)("More bookmarks"),dangerouslySetInnerHTML:{__html:Ts.zwh},onKeyDown:this._handleKeyDown,onClick:this._handleClick,onMouseDown:this._handleMouseDown,onMouseUp:this._handleItemMouseUp,onBlur:this._handleBlur,onFocus:this._handleFocus,onMouseEnter:this._handleMouseEnter,onMouseLeave:this._handleMouseLeave})}}const Or=xr;var Lr=n(44147),Rr=n(62077),Br=n(72536),Fr=n(86635),Vr=n(68551),Wr=n(13253),Ur=n(89661),Hr=n(34155);let zr=!1;const Gr={show:function(e,t,n,s,i,o,a){const r=e.vivaldiWindowId,l=function(e){a(e)},d=function(){Hr.nextTick((()=>{a("")}))};zr||(zr=!0,function(e,t){return new Promise((e=>{C.Z.zoom.getVivaldiUIZoom((n=>{t.forEach((e=>{e.rect.x=parseInt((e.rect.x+1)*n),e.rect.y=parseInt((e.rect.y+0)*n),e.rect.width=parseInt(e.rect.width*n),e.rect.height=parseInt(e.rect.height*n)})),e()}))}))}(0,n).then((()=>{C.Z.menubarMenu.onOpenBookmark.addListener(Lr.Z.onOpen),C.Z.menubarMenu.onBookmarkAction.addListener(Lr.Z.onAction),C.Z.menubarMenu.onHover.addListener(Lr.Z.onHover),C.Z.bookmarkContextMenu.onOpen.addListener(l),C.Z.bookmarkContextMenu.onClose.addListener(d),C.Z.bookmarkContextMenu.show({windowId:r,id:t,siblings:n,sortField:s,sortOrder:i,edge:J.Z.getBookmarkExtrasEdge(),icons:[re.Z,Fr.Z,Vr.Z,Wr.Z,Ur.Z,Rr.Z,Br.Z]},(()=>{Lr.Z.onHover(r,""),C.Z.menubarMenu.onOpenBookmark.removeListener(Lr.Z.onOpen),C.Z.menubarMenu.onBookmarkAction.removeListener(Lr.Z.onAction),C.Z.menubarMenu.onHover.removeListener(Lr.Z.onHover),C.Z.bookmarkContextMenu.onOpen.removeListener(l),C.Z.bookmarkContextMenu.onClose.removeListener(d),setTimeout((()=>{zr=!1}),100)}))})))}},$r={getMenu:async(e,t,n)=>{const i=[];for(const[o,a]of G.ZP.getState()){if(o===e||"normal"!==a.type)continue;const r=(await s.Z.windows.get(o,{populate:!0})).tabs||[],l=r.find((e=>e.active)),d=l&&l.url?je.jk.getDisplayTitleByUrl(l.url,l.title||l.url):String(i.length+1),c=a.incognito?(0,Oe.Z)("Private Window with $1 Active Tab ($2)","Private Window with $1 Active Tabs ($2)",[r.length,d]):(0,Oe.Z)("Window with $1 Active Tab ($2)","Window with $1 Active Tabs ($2)",[r.length,d]);i.push({handler:()=>{const e={inCurrent:!1,inBackground:H.Z.get($.kTabsOpenNewInBackground),inNewWindow:!1,allowOverride:!1,incognito:!1};Ds.ZP.openUrls(o,n,e,t)},...ae.Z.makeNumberMnemonic(c,i.length)})}return i}},Kr=$r,jr=(e,t,n)=>(e.dataTransfer.setData("text/uri-list",t),e.dataTransfer.setData("text/plain",t),e.dataTransfer.SetURLAndTitle(t,n),e.dataTransfer.setData("vivaldi/x-title",n),e);var Yr;function Xr(e,t,n,s){Yr||(Yr="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Yr,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var Qr=Xr("span",{className:"separator"}),qr=Xr(jo,{type:"chevron",size:10});class Jr extends hs.Component{static contextType=xi.Z;refButton=hs.createRef();refTitleInput=hs.createRef();dropMode={support:!1,copy:!1};centerButtonPressed=!1;regularWidth=-1;canHandleClick=!0;constructor(e){super(e),this.state={dragging:!1,title:e.node.title}}componentDidUpdate(){const{HTMLElement:e}=this.context,t=this.refButton.current;t instanceof e&&(this.props.onRendered(this.props.node.id,t.offsetWidth),this.props.editTitle||(this.regularWidth=t.offsetWidth))}componentDidMount(){const{HTMLElement:e}=this.context,t=this.refButton.current;t instanceof e&&this.props.onRendered(this.props.node.id,t.offsetWidth)}_edit=()=>{Ae.Z.showBookmarkDialog(this.context.vivaldiWindowId,{mode:"edit",id:this.props.node.id,index:-1})};_rename=()=>{this.setState({title:this.props.node.title}),this.props.onEditChanged(this.props.node.id)};_handleEditChange=e=>{this.setState({title:e.target.value})};_handleEditKeyDown=e=>{switch(e.key){case"Enter":this._saveTitle(e.currentTarget.value),this.refTitleInput.current?.blur();break;case"Escape":this._cancelEdit(),this.refTitleInput.current?.blur()}};_killEvent=e=>{e.preventDefault(),e.stopPropagation()};_cancelEdit=()=>{this.setState({title:this.props.node.title}),this.props.onEditChanged("")};_saveTitle=e=>{s.Z.bookmarks.update(this.props.node.id,{title:e})};_handleFocus=e=>{e.currentTarget.select()};_handleEditBlur=e=>{this.state.title||this._cancelEdit(),this.props.onEditChanged(""),this.props.onRendered(this.props.node.id,this.regularWidth)};_delete=()=>{g.Z.remove([this.props.node.id])};_handleItemMouseDown=e=>{e.button!==Hi.Z.kLeft&&(this.centerButtonPressed=e.button===Hi.Z.kCenter,e.preventDefault()),this.canHandleClick=!this.props.menuOpen};_handleItemMouseUp=e=>{e.button===Hi.Z.kCenter&&(e.preventDefault(),!0===this.centerButtonPressed&&0===e.buttons&&this.props.onItemActivated(this.props.node.id,!0,!1,e))};_handleClick=e=>{this.canHandleClick&&this.props.onItemActivated(this.props.node.id,!0,!0,e),e.preventDefault(),e.stopPropagation()};_handleKeyDown=e=>{switch("Enter"===e.key&&!0===e.repeat&&e.preventDefault(),e.key){case"ArrowUp":case"ArrowDown":case"Enter":this.props.onItemActivated(this.props.node.id,"Enter"===e.key,!0,e);break;case"ArrowLeft":this.props.moveFocus(this.props.node.id,"left",!1);break;case"ArrowRight":this.props.moveFocus(this.props.node.id,"right",!1);break;case"Escape":if(this.props.menuOpen)return;this.props.onLeaveBar();break;default:return}e.preventDefault(),e.stopPropagation()};_handleDrop=e=>{if(e.preventDefault(),e.stopPropagation(),this.dropMode.support&&""!==this.props.dragover.position){const t="on"===this.props.dragover.position?this.props.node.id:this.props.node.parentId,n="on"===this.props.dragover.position?0:this.props.dragover.index+("right"===this.props.dragover.position?1:0);t&&g.Z.onDropEvent(e,t,n)}this.props.resetDragover()};_handleDragStart=e=>{this.props.onDragStart(this.props.node.id),this.setState({dragging:!0});const t=JSON.stringify([this.props.node.id.toString()]);e.dataTransfer.setData(Ds.yR,t);const n=je.jk.getHoverUrl(ps.ZP.getUrlByNode(this.props.node));jr(e,n,this.props.node.title),e.dataTransfer.effectAllowed="all"};_handleDragEnd=e=>{this.setState({dragging:!1}),this.props.onDragEnd()};_handleDragLeave=e=>{};_handleDragEnter=e=>{this.dropMode=this.props.getDropModeForEvent(e)};_handleDragOver=e=>{e.preventDefault(),e.stopPropagation(),this.dropMode.support&&(e.dataTransfer.dropEffect=this.dropMode.copy?"copy":"move",this.props.onDragOver(this.props.node,e))};_handleBlur=()=>{this.props.onItemBlur(this.props.node.id)};_handleMouseEnter=e=>{if(!this.props.statusOff){const e=ps.ZP.getUrlByNode(this.props.node);c.Z.setStatus(this.context.vivaldiWindowId,e||this.props.node.title)}this.props.onItemEnter(this.props.node.id)};_handleMouseLeave=e=>{this.props.statusOff||c.Z.clearStatus(this.context.vivaldiWindowId),this.centerButtonPressed=!1,this.props.onItemLeave(this.props.node.id)};_openInNewWindow=(e,t)=>{const n={inCurrent:!1,inBackground:!1,inNewWindow:!0,allowOverride:!1,incognito:t};Ds.ZP.open(this.context.vivaldiWindowId,Ds.ZP.getBookmarksByNode(e),n,!0)};_openInNewTab=(e,t)=>{const n={inCurrent:!1,inBackground:t||H.Z.get($.kTabsOpenNewInBackground),inNewWindow:!1,allowOverride:!1,incognito:!1};Ds.ZP.open(this.context.vivaldiWindowId,Ds.ZP.getBookmarksByNode(e),n,!0)};_open=e=>{Ds.ZP.open(this.context.vivaldiWindowId,Ds.ZP.getBookmarksByNode(e),{inCurrent:!0,inBackground:!1,inNewWindow:!1,allowOverride:!1,incognito:!1},!0)};_getContextMenuItems=(e,t)=>{const n=this.context.vivaldiWindowId,s=Pi.getOptionFunction(e),i=ps.ZP.isSeparator(t);return Pi.getNamedMenu(n,e,(async e=>{switch(e.action){case"CONTEXT_OPEN_IN_NEW_TAB":return{handler:()=>this._openInNewTab(t,!1),isVisible:()=>!i,...s(n,e,{})};case"CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB":return{handler:()=>this._openInNewTab(t,!0),isVisible:()=>!i&&!H.Z.get($.kTabsOpenNewInBackground),...s(n,e,{})};case"CONTEXT_OPEN_IN_TAB":return{handler:()=>this._open(t),isVisible:()=>!i,...s(n,e,{})};case"CONTEXT_OPEN_IN_NEW_WINDOW":return{handler:()=>this._openInNewWindow(t,!1),isVisible:()=>!i,...s(n,e,{})};case"CONTEXT_OPEN_IN_PRIVATE_WINDOW":return{handler:()=>this._openInNewWindow(t,!0),isVisible:()=>!i,...s(n,e,{})};case"CONTEXT_CONTAINER_OPEN_IN_WINDOW":{const o=await Kr.getMenu(n,!0,Ds.ZP.getUrlsByNodes([t]));return{isVisible:()=>!i&&o.length>0,items:o,...s(n,e,{})}}case"CONTEXT_BOOKMARK":return{handler:this.props.addActiveTab,isVisible:()=>!i,...s(n,e,{})};case"CONTEXT_NEW_BOOKMARK":return{handler:this.props.createNewBookmark,...s(n,e,{})};case"CONTEXT_NEW_FOLDER":return{handler:this.props.createNewFolder,...s(n,e,{})};case"CONTEXT_NEW_SEPARATOR":return{handler:this.props.createNewSeparator,isVisible:()=>!this.props.isSorted,...s(n,e,{})};case"CONTEXT_EDIT":return{handler:this._edit,isVisible:()=>!i,...s(n,e,{})};case"CONTEXT_RENAME":return{handler:this._rename,isVisible:()=>!i,...s(n,e,{})};case"CONTEXT_CUT":return{handler:this.props.onCut,isVisible:()=>!i,...s(n,e,{})};case"CONTEXT_COPY":return{handler:this.props.onCopy,isVisible:()=>!i,...s(n,e,{})};case"CONTEXT_PASTE":return{handler:this.props.onPaste,isVisible:()=>!i,...s(n,e,{})};case"CONTEXT_DELETE":return{handler:this._delete,...s(n,e,{})};default:return{...s(n,e,{})}}}))};_onContextMenu=e=>{this.props.editTitle?e.stopPropagation():(e.persist(),e.preventDefault(),e.stopPropagation(),this._getContextMenuItems("bookmarkbaritem",this.props.node).then((t=>{(0,Qi.Z)(this.context,t)(e)})))};_onFocus=()=>{this.props.highlighted||this.props.onItemHighlightMissing(this.props.node.id)};render(){const e=this.props.node,t=ps.ZP.getUrlByNode(e),n=ps.ZP.isSeparator(e),s=ps.ZP.isFolder(e);let i;s&&"icon"!==this.props.display?i=(0,Oe.Z)("Show folder contents"):"icon"!==this.props.display&&"iconexceptfolders"!==this.props.display||!e.title?t&&(i=t):(i=e.title,t&&(i=i+"\n"+t));let o=!1;"icon"!==this.props.display&&(o="iconexceptfolders"!==this.props.display||!t);const{favIconUrl:a,favIconLoadType:r}=je.jk.getBookmarkFavicon(e.url,e.faviconUrl);return(0,fs.jsxs)("button",{ref:this.refButton,"data-id":e.id,"data-offset":0,title:i,tabIndex:this.props.keyAccess,className:As()({uifocusstop:this.props.uiFocus,bookmarkbarItem:!0,highlighted:this.props.highlighted||this.props.menuOpen,folder:!n&&!e.url,"data-cut":this.props.isCut,dragging:this.state.dragging,dragover:this.props.dragover.id===e.id&&"on"===this.props.dragover.position,dragoverLeft:this.props.dragover.id===e.id&&"left"===this.props.dragover.position,dragoverRight:this.props.dragover.id===e.id&&"right"===this.props.dragover.position}),draggable:!this.props.editTitle,onDragStart:this._handleDragStart,onDragEnd:this._handleDragEnd,onDragEnter:this._handleDragEnter,onDragOver:this._handleDragOver,onDrop:this._handleDrop,onBlur:this._handleBlur,onMouseEnter:this._handleMouseEnter,onMouseLeave:this._handleMouseLeave,onClick:this.props.editTitle?void 0:this._handleClick,onMouseDown:this.props.editTitle?void 0:this._handleItemMouseDown,onMouseUp:this.props.editTitle?void 0:this._handleItemMouseUp,onKeyDown:this.props.editTitle?void 0:this._handleKeyDown,onContextMenu:this._onContextMenu,onFocus:this._onFocus,onKeyUp:this._killEvent,children:[n&&Qr,!n&&a&&"text"!==this.props.display&&Xr(Ss,{url:a,loadType:r}),!n&&!e.url&&"text"!==this.props.display&&Xr(Ps,{speeddial:e.speeddial}),!n&&!this.props.editTitle&&o&&e.title&&(0,fs.jsxs)(fs.Fragment,{children:["text"===this.props.display&&s&&qr,Xr("span",{className:"title"},void 0,e.title)]}),this.props.editTitle&&(0,fs.jsx)("input",{ref:this.refTitleInput,type:"text",value:this.state.title,onFocus:this._handleFocus,onBlur:this._handleEditBlur,onClick:this._killEvent,onKeyDown:this._handleEditKeyDown,onChange:this._handleEditChange,autoFocus:!0})]},e.id)}}const el=Jr;var tl=n(57082),nl=n(45454);function sl(e,t){return!!t&&t.contains(e.activeElement)}function il(e){return e.querySelectorAll("a[href]:not([tabindex='-1']),\n    button:not([disabled]):not([tabindex='-1']),\n    input:not([disabled]):not([tabindex='-1']),\n    select:not([disabled]):not([tabindex='-1']),\n    textarea:not([disabled]):not([tabindex='-1']),\n    [contenteditable]:not([tabindex='-1']),\n    [tabindex]:not([disabled]):not([tabindex='-1'])")}function ol(e,t){const n=[...il(t||e)],s=n.findIndex((t=>t===e.activeElement));n[(s+1)%n.length].focus()}var al,rl=n(34155);function ll(e,t,n,s){al||(al="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:al,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class dl extends hs.PureComponent{static contextType=xi.Z;acceptEnterId="";draggedId="";dropMode={support:!1,copy:!1};clipboardId="";timer=null;nodeRef=hs.createRef();constructor(e,t){super(e);const{document:n}=t;this.state={nodes:ps.ZP.getBookmarksBarNodes(),map:new Map,dragover:{id:"",position:"",index:0},maxWidth:n.documentElement?n.documentElement.clientWidth:0,extenderWidth:0,sorting:{sortOrder:Xi.Z.NO_SORTING,sortField:"manually"},cutIds:ps.ZP.getCutIds(),editId:"",newItemAdded:!1,renderedArray:[],openMenuId:"",highlightedId:""}}componentDidMount(){const e=H.Z.get($.kBookmarksBarSorting);this._onSortChange(e.sortOrder,e.sortField),ps.ZP.addListener(this._onStoreChange),tl.Z.addListener("COMMAND_FOCUS_BOOKMARKBAR",this._onCommandSpy)}componentWillUnmount(){this.timer&&clearTimeout(this.timer),ps.ZP.removeListener(this._onStoreChange),tl.Z.removeListener("COMMAND_FOCUS_BOOKMARKBAR",this._onCommandSpy)}_onStoreChange=()=>{const e=ps.ZP.getBookmarksBarNodes();this.setState((t=>{const n=this._getRenderedItems(e,t.sorting,!0===t.newItemAdded?t.editId:"");return{nodes:e,map:new Map,renderedArray:n,cutIds:ps.ZP.getCutIds()}}))};_hasFocus=()=>{const{document:e,HTMLElement:t}=this.context,n=this.nodeRef.current;return n instanceof t&&sl(e,n)};_onCommandSpy=e=>{e===this.context.vivaldiWindowId&&(this._hasFocus()||this.state.renderedArray.length>0&&this._moveFocus(this.state.renderedArray[0].id,"current",!0))};_getRenderedItems=(e,t,n)=>{const s=structuredClone(e);if(s.length>0&&t&&t.sortOrder>=Xi.Z.ASCENDING_SORT){const e=(e,n)=>ps.ZP.treeSortComparator(e,n,{sortOrder:t.sortOrder,sortField:t.sortField});if(Xi.Z.treeSort(s,e),""!==n){const e=s.findIndex((e=>e.id===n));-1!==e&&s.splice(0,0,s.splice(e,1)[0])}}return s};_handleKeyDown=e=>{e.keyCode===oa.Z.KEY_ESCAPE&&this._resetDragover()};_onButtonRendered=(e,t)=>{this.state.map.get(e)!==t&&this.setState((n=>{const s=new Map(n.map);return s.set(e,t),{map:s}}))};_onExtenderRendered=(e,t)=>{this.setState({extenderWidth:e})};_onResize=e=>{const t=e[0].target;this.setState({maxWidth:Math.floor(t.clientWidth)})};_addActiveTab=()=>{const e=ie.ZP.getActivePage(this.context.vivaldiWindowId);e&&g.Z.bookmarkPageInFolder(e,ps.ZP.getBookmarkBarFolderId(),0)};_getItemInsertIndex=e=>{const t=this.state.renderedArray.length;return"number"!=typeof e||t<e?t:e};_createNewBookmark=()=>{Ae.Z.showBookmarkDialog(this.context.vivaldiWindowId,{mode:"addbookmark",id:ps.ZP.getBookmarkBarFolderId(),index:0})};_createNewFolder=()=>{Ae.Z.showBookmarkDialog(this.context.vivaldiWindowId,{mode:"addfolder",id:ps.ZP.getBookmarkBarFolderId(),index:0})};_createNewSeparator=e=>{g.Z.createSeparator(ps.ZP.getBookmarkBarFolderId(),this._getItemInsertIndex(e))};_resetDragover=()=>{this.setState({dragover:{id:"",position:"",index:0}})};_onEditChanged=e=>{""===e?this.setState((e=>({renderedArray:this._getRenderedItems(e.nodes,e.sorting,""),newItemAdded:!1,editId:""}))):this.setState({editId:e})};_onDragEndBookmark=()=>{this.draggedId="",this._resetDragover()};_onDropBar=e=>{if(e.preventDefault(),e.stopPropagation(),this.dropMode.support){const t=ps.ZP.getBookmarkBarFolderId(),n=ps.ZP.getBookmarksBarNodes().length;g.Z.onDropEvent(e,t,n)}this._resetDragover()};_onDragEnter=e=>{this.dropMode=this._getDropModeForEvent(e)};_onDragOverBar=e=>{e.preventDefault(),e.stopPropagation(),this.dropMode.support&&(e.dataTransfer.dropEffect=this.dropMode.copy?"copy":"move")};_onDragOver=(e,t)=>{if(e.id!==this.draggedId&&void 0!==e.index){var n="";if(this.state.sorting.sortOrder===Xi.Z.NO_SORTING){const s=t.currentTarget.getBoundingClientRect(),i=(t.clientX-s.left)/s.width;n=ps.ZP.isFolder(e)?i<=.33?"left":i>.66?"right":"on":i<=.5?"left":"right"}else ps.ZP.isFolder(e)&&(n="on");(this.state.dragover.id!==e.id||this.state.dragover.id===e.id&&this.state.dragover.position!==n)&&this.setState({dragover:{id:e.id,position:n,index:e.index}})}};_onDragStart=e=>{this.draggedId=e};_getDropModeForEvent=e=>{const t={support:!1,copy:!1};return t.support=e.dataTransfer.types.some((e=>Ds.ZP.isUriListType(e)||"text/plain"===e||e===Ds.yR)),t.support&&(e.dataTransfer.types.some((e=>e===h.Up))?t.copy=!1:t.copy=t.support&&(Ds.ZP.isCopyModifierPressed(e)||!e.dataTransfer.types.some((e=>e===Ds.yR)))),t};_onCut=e=>{g.Z.cut(e,[this.clipboardId]),e.stopPropagation(),e.preventDefault()};_onCopy=e=>{g.Z.copy(e,[this.clipboardId]),e.stopPropagation(),e.preventDefault()};_onPaste=e=>{const t=this.clipboardId===ps.ZP.getBookmarkBarFolderId();g.Z.paste(e,this.clipboardId,t),e.preventDefault(),e.stopPropagation()};_onCutContextMenu=e=>{this.clipboardId=e;const{document:t}=this.context;t.addEventListener("cut",this._onCut),t.execCommand("cut"),t.removeEventListener("cut",this._onCut)};_onCopyContextMenu=e=>{this.clipboardId=e;const{document:t}=this.context;t.addEventListener("copy",this._onCopy),t.execCommand("copy"),t.removeEventListener("copy",this._onCopy)};_onPasteContextMenu=e=>{this.clipboardId=e;const{document:t}=this.context;t.addEventListener("paste",this._onPaste),t.execCommand("paste"),t.removeEventListener("paste",this._onPaste)};_onSortOrderChange=()=>{const e=this.state.sorting.sortOrder===Xi.Z.DESCENDING_SORT?Xi.Z.ASCENDING_SORT:Xi.Z.DESCENDING_SORT;this._onSortChange(e,this.state.sorting.sortField)};_onTitleSortChange=e=>{let t=this.state.sorting.sortOrder;"manually"!==e&&t===Xi.Z.NO_SORTING?t=Xi.Z.ASCENDING_SORT:"manually"===e&&(t=Xi.Z.NO_SORTING),this._onSortChange(t,e)};_onSortChange=(e,t)=>{this.setState({sorting:{sortOrder:e,sortField:t}});const n={sortOrder:e,sortField:t};Ne.Z.set($.kBookmarksBarSorting,n),this.setState((e=>({renderedArray:this._getRenderedItems(e.nodes,n,!0===e.newItemAdded?e.editId:"")})))};_getContextMenuItems=e=>{const t=this.context.vivaldiWindowId,n=this.state.sorting.sortOrder!==Xi.Z.NO_SORTING,s=Pi.getOptionFunction(e),i=()=>[{handler:this._onTitleSortChange.bind(this,"manually"),type:"checkbox",checked:"manually"===this.state.sorting.sortField,...(0,xs.Z)("radio","Manually")},{handler:this._onTitleSortChange.bind(this,"title"),type:"checkbox",checked:"title"===this.state.sorting.sortField,...(0,xs.Z)("by Title")},{handler:this._onTitleSortChange.bind(this,"url"),type:"checkbox",checked:"url"===this.state.sorting.sortField,...(0,xs.Z)("by Address")},{handler:this._onTitleSortChange.bind(this,"nickname"),type:"checkbox",checked:"nickname"===this.state.sorting.sortField,...(0,xs.Z)("by Nickname")},{handler:this._onTitleSortChange.bind(this,"description"),type:"checkbox",checked:"description"===this.state.sorting.sortField,...(0,xs.Z)("by Description")},{handler:this._onTitleSortChange.bind(this,"dateadded"),type:"checkbox",checked:"dateadded"===this.state.sorting.sortField,...(0,xs.Z)("by Date Created")},ae.Z.separatorItem,{handler:this._onSortOrderChange,isVisible:()=>this.state.sorting.sortOrder!==Xi.Z.NO_SORTING&&this.state.sorting.sortOrder===Xi.Z.ASCENDING_SORT,...(0,xs.Z)("Descending")},{handler:this._onSortOrderChange,isVisible:()=>this.state.sorting.sortOrder!==Xi.Z.NO_SORTING&&this.state.sorting.sortOrder!==Xi.Z.ASCENDING_SORT,...(0,xs.Z)("Ascending")}];return Pi.getNamedMenu(t,e,(async e=>{switch(e.action){case"CONTEXT_BOOKMARK":return{handler:this._addActiveTab,...s(t,e,{})};case"CONTEXT_NEW_BOOKMARK":return{handler:this._createNewBookmark,...s(t,e,{})};case"CONTEXT_NEW_FOLDER":return{handler:this._createNewFolder,...s(t,e,{})};case"CONTEXT_NEW_SEPARATOR":return{handler:()=>{this._createNewSeparator(void 0)},isVisible:()=>!n,...s(t,e,{})};case"CONTEXT_PASTE":return{handler:()=>{this._onPasteContextMenu(ps.ZP.getBookmarkBarFolderId())},...s(t,e,{})};case"CONTEXT_CONTAINER_SORT":return{items:i(),...s(t,e,{})};default:return{...s(t,e,{})}}}))};_moveFocus=(e,t,n)=>{if(!0===n||this._hasFocus()){const{document:n,HTMLButtonElement:s}=this.context,i=Array.from(n.querySelectorAll("button.bookmarkbarItem")).map((e=>e.getAttribute("data-id"))).filter(Boolean);if("current"===t){const t=parseInt(e)<0?0:i.indexOf(e);if(-1===t)return;e=i[t]}else if("right"===t||"left"===t){if(1===i.length)return;let n=i.indexOf(e);n="right"===t?n+1>=i.length?0:n+1:n<=0?i.length-1:n-1,e=i[n]}const o=n.querySelector(`button.bookmarkbarItem[data-id="${e}"]`);o&&o instanceof s&&this.setState({highlightedId:e},(()=>o.focus()))}};_handleItemActivated=(e,t,n,s)=>{const i=ps.ZP.getItemById(e);if(i)if(ps.ZP.isFolder(i)&&n){const e=this._getMenuSorting(),t="top"===H.Z.get($.kBookmarksBarPosition)?"bottom":"top";Gr.show(this.context,i.id,this._getFolderSiblings(),e.field,e.order,t,this._onMenuVisibilityChanged)}else if(t&&s){const e=this.context.vivaldiWindowId,t=(0,nl.Z)(e,{ctrlKey:s.ctrlKey,altKey:s.altKey,shiftKey:s.shiftKey,metaKey:s.metaKey,button:"number"==typeof s.button?s.button:-1});Ds.ZP.open(e,Ds.ZP.getBookmarksByNode(i),t,!0),Ae.Z.setPaneFocus(this.context.vivaldiWindowId,!1)}};_handleItemEnter=e=>{""!==this.acceptEnterId&&this.acceptEnterId!==e||this.state.editId||(this._hasFocus()&&this._moveFocus(e,"current",!0),this.setState({highlightedId:e}))};_handleItemLeave=e=>{""===this.state.openMenuId&&this.setState({highlightedId:""})};_handleItemBlur=e=>{rl.nextTick((()=>{this._hasFocus()||this.setState({highlightedId:""})}))};_handleItemHighlightMissing=e=>{this.setState({highlightedId:e})};_handleLeaveBar=()=>{Ae.Z.setPaneFocus(this.context.vivaldiWindowId,!1),v.Z.executeActions("event",this.context,"COMMAND_FOCUS_WEBVIEW")};_getMenuSorting=()=>Xi.Z.toMenuSorting(this.state.sorting.sortOrder,this.state.sorting.sortField);_getFolderSiblings=()=>{const{document:e}=this.context;return Array.from(e.querySelectorAll("button.bookmarkbarItem")).filter((e=>e.classList.contains("folder")||e.classList.contains("chevron"))).map((e=>{const t=e.getBoundingClientRect();return{id:e.dataset.id,offset:Number(e.dataset.offset),folderGroup:Boolean(e.classList.contains("folder")||e.classList.contains("chevron")),rect:{x:parseInt(t.left),y:parseInt(t.top),width:parseInt(t.width),height:parseInt(t.height)}}}))};_onMenuVisibilityChanged=e=>{""===e?(this.acceptEnterId=this.state.openMenuId,this.timer=setTimeout((()=>{this.acceptEnterId="",this.timer=null}),100),this._hasFocus()?this._moveFocus(this.state.openMenuId,"current",!0):this.setState({highlightedId:""})):(this.setState({highlightedId:e}),this._moveFocus(e,"current",!1)),this.setState({openMenuId:e})};_isSorted=()=>"manually"!==this.state.sorting.sortField;_onContextMenu=e=>{e.persist(),e.preventDefault(),e.stopPropagation(),this._getContextMenuItems("bookmarkbar").then((t=>{(0,Qi.Z)(this.context,t)(e)}))};_renderBookmarkBarButton=(e,t)=>(0,fs.jsx)(el,{ref:e.id,node:e,editTitle:this.state.editId===e.id,isCut:-1!==this.state.cutIds.indexOf(e.id),menuOpen:this.state.openMenuId===e.id,display:this.props.display,statusOff:this.props.statusOff,dragover:this.state.dragover,highlighted:this.state.highlightedId===e.id,keyAccess:0===t?this.props.keyAccess:-1,uiFocus:0===t,moveFocus:this._moveFocus,onItemActivated:this._handleItemActivated,onItemEnter:this._handleItemEnter,onItemLeave:this._handleItemLeave,onItemBlur:this._handleItemBlur,onItemHighlightMissing:this._handleItemHighlightMissing,onLeaveBar:this._handleLeaveBar,onEditChanged:this._onEditChanged,onDragStart:this._onDragStart,onDragEnd:this._onDragEndBookmark,onDragOver:this._onDragOver,getDropModeForEvent:this._getDropModeForEvent,addActiveTab:this._addActiveTab,createNewBookmark:this._createNewBookmark,createNewFolder:this._createNewFolder,createNewSeparator:()=>this._createNewSeparator(t),isSorted:this._isSorted(),resetDragover:this._resetDragover,onRendered:this._onButtonRendered,onCut:this._onCutContextMenu.bind(this,e.id),onCopy:this._onCopyContextMenu.bind(this,e.id),onPaste:this._onPasteContextMenu.bind(this,e.id)},e.id);render(){let e=0;const t=[];let n=0,s="",i=0;for(let o=0;o<this.state.renderedArray.length;o++){const a=this.state.renderedArray[o];if(!this._isSorted()||!ps.ZP.isSeparator(a)){const r=this.state.map.get(a.id),l=e+("number"==typeof r?r:28);if(l>this.state.maxWidth||l+this.state.extenderWidth>this.state.maxWidth&&o+1<this.state.renderedArray.length){n=o,""===this.state.editId&&this.state.renderedArray[0].parentId&&(s=this.state.renderedArray[0].parentId);break}t.push(this._renderBookmarkBarButton(a,i)),i++,e=l}}const o=""!==s?ll(Or,{id:s,offset:n,keyAccess:-1,menuOpen:this.state.openMenuId===s,highlighted:this.state.highlightedId===s,moveFocus:this._moveFocus,onRendered:this._onExtenderRendered,onItemActivated:this._handleItemActivated,onItemEnter:this._handleItemEnter,onItemLeave:this._handleItemLeave,onItemBlur:this._handleItemBlur,onItemHighlightMissing:this._handleItemHighlightMissing,onLeaveBar:this._handleLeaveBar}):null;return(0,fs.jsx)("div",{ref:this.nodeRef,className:`bookmark-bar ${this.props.display}`,onDragEnter:this._onDragEnter,onDragOver:this._onDragOverBar,onDragLeave:this._resetDragover,onDrop:this._onDropBar,onContextMenu:this._onContextMenu,children:ll(Ri,{className:"observer",onKeyDown:this._handleKeyDown,onResize:this._onResize},void 0,t,o)})}}const cl=dl;var hl=n(15590),pl=n(27508),ul=n(84675),gl=n(29717);class ml extends hs.Component{static contextType=xi.Z;nodeRef=hs.createRef();componentDidMount(){this.getRadios().forEach((e=>{e.name=this.props.name,e.addEventListener("change",this.props.onChange)})),this.setCheckedDisabledRadio(this.props)}setCheckedDisabledRadio=e=>{this.getRadios().forEach((t=>{t.value===e.value.toString()&&(t.checked=!0),t.disabled=Boolean(e.disabled)}))};componentDidUpdate(e){e.value===this.props.value&&e.disabled===this.props.disabled||this.setCheckedDisabledRadio(this.props)}componentWillUnmount(){this.getRadios().forEach((e=>{e.removeEventListener("change",this.props.onChange)}))}getRadios=()=>{const{HTMLInputElement:e}=this.context,t=this.nodeRef.current,n=[];if(t){t.querySelectorAll('input[type="radio"]').forEach((t=>{t instanceof e&&n.push(t)}))}return n};render(){return(0,fs.jsx)("div",{ref:this.nodeRef,className:this.props.className,children:this.props.children})}}const vl=ml;var fl;function yl(e,t,n,s){fl||(fl="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:fl,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Cl=[{icon:Ts.oa7,mode:"area",label:(0,Oe.Z)("capture","Selection")},{icon:Ts.$O3,mode:"fullpage",label:(0,Oe.Z)("Full Page")}],wl=[{value:"png",label:(0,Oe.Z)("Save as PNG")},{value:"jpg",label:(0,Oe.Z)("Save as JPEG")},{value:"clipboard",label:(0,Oe.Z)("panel","Copy to Clipboard")},{value:"note",label:(0,Oe.Z)("Create Note with...")}],bl=12;function Sl(e,t){t.keyCode===oa.Z.KEY_ESCAPE&&ul.Z.cancelCallback(e)}const Il=e=>{const t=hs.useContext(xi.Z),{innerWidth:n}=t,{isOffScreenBelow:s,isOffScreenLeft:i,isOffScreenTopAndBottom:o}=function(e){const t=hs.useContext(xi.Z);let n=!1,s=!1,i=!1,o=!1;if(!e)return{isOffScreenTopAndBottom:i,isOffScreenBelow:n,isOffScreenLeft:o};const{top:a,height:r,left:l,width:d}=e,{innerHeight:c}=t;return s=a<46,o=l+d<300,n=c>a+r+34+17,i=!n&&s,{isOffScreenBelow:n,isOffScreenLeft:o,isOffScreenTopAndBottom:i}}(e);if(!e)return null;const{top:a,height:r,left:l}=e;return o?{left:l+bl,top:a+r-34-bl}:e?{top:s?e.top+e.height+bl:e.top-34-bl,...i?{left:e.left}:{right:n-(e.left+e.width)}}:null},kl=[$.kWebpagesCaptureSaveLocation,$.kWebpagesCaptureCompressionFormat,$.kKeyboardTabToAll];function Al({winId:e,captureSquare:t,mode:n,setMode:s,inProgress:i,isInternalUrl:o,setFormat:a,doScreenshot:r}){const l=(0,na.Z)(kl),d=Il(t),c=l[$.kWebpagesCaptureSaveLocation],h="clipboard"===c||"note"===c?c:l[$.kWebpagesCaptureCompressionFormat];return yl("form",{className:As()("ControlPanel",{Default:!d,InProgress:i}),style:d,onKeyDown:Sl.bind(this,e),onSubmit:r},void 0," ",i?(0,fs.jsxs)(fs.Fragment,{children:[yl("span",{dangerouslySetInnerHTML:{__html:Ts.GO5.medium}}),yl("span",{},void 0,(0,Oe.Z)("Capture in Progress..."))]}):yl(da.Z,{focusName:"focus-capture-dialog",forceTrap:!0},void 0,!t&&yl(vl,{name:"modePicker",className:"ControlPanel-ModeSelector",onChange:s,disabled:o,value:n},void 0,Cl.map((e=>{if(e.mode.includes("fullpage")&&o)return null;return yl("label",{className:As()("ControlPanel-ModeSelector--Option",{Active:e.mode.includes(n)})},e.mode,yl("span",{dangerouslySetInnerHTML:{__html:e.icon}}),yl("input",{type:"radio",value:e.mode,tabIndex:o?-1:l[$.kKeyboardTabToAll]}),yl("span",{},void 0,e.label))}))),yl("div",{className:"ControlPanel-Output"},void 0,yl("label",{className:"ControlPanel-Output--Description",htmlFor:"capture:format"},void 0,(0,Oe.Z)("format","Output")),yl("select",{id:"capture:format",className:"ControlPanel-Output--Select",onChange:a,value:h},void 0,wl.map((e=>yl("option",{value:e.value},e.value,e.label)))),yl("input",{className:"ControlPanel-Output--CaptureButton primary",type:"submit",onMouseDown:to.ZP,onTouchStart:to.ZP,disabled:"fullpage"!==n&&!("area"===n&&void 0!==t),value:(0,Oe.Z)("image","Capture")}))))}var Tl;function Zl(e,t,n,s){Tl||(Tl="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Tl,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const El=10,_l=[$.kWebpagesCaptureCaptureMode,$.kWebpagesCaptureCompressionFormat,$.kWebpagesCaptureSaveLocation],Ml=["TopLeft","TopMid","TopRight","BottomLeft","BottomMid","BottomRight","MidLeft","MidRight"],Nl=e=>{const t=ie.ZP.getActivePage(e);return!(!t?.id||!t?.url)&&je.jk.isInternalUrl(t?.url)};function Pl(e){const t=(0,na.Z)(_l),n=(0,hs.useRef)(null),s=(0,hs.useRef)(null),i=(0,hs.useRef)(0),o=(0,hs.useRef)(0),a=(0,hs.useRef)(0),r=(0,hs.useRef)(0),l=(0,hs.useRef)({}),[d,c]=(0,hs.useState)(Nl(e.winId)),h=d?"area":t[$.kWebpagesCaptureCaptureMode],p=(0,hs.useContext)(xi.Z),[u,g]=(0,hs.useState)(null),[m,v]=(0,hs.useState)(!1),[f,y]=(0,hs.useState)(!1);(0,hs.useEffect)((()=>{n.current?.focus()}),[]);const{winId:C}=e;(0,hs.useEffect)((()=>{const e=()=>{c(Nl(C))};return ie.ZP.addListener(e,p.selectWindow),()=>{ie.ZP.removeListener(e)}}),[p.selectWindow,C]);const w=()=>{const{x3:e,x4:t,y3:n,y4:s}={x3:Math.round(Math.min(i.current,o.current)),x4:Math.round(Math.max(i.current,o.current)),y3:Math.round(Math.min(a.current,r.current)),y4:Math.round(Math.max(a.current,r.current))},l=p.innerWidth,d=p.innerHeight;g({rectStyle:{left:e,top:n,width:t-e,height:s-n},areaStyle:{background:"transparent",borderWidth:`${n}px ${l-t}px ${d-s}px ${e}px`}})},b=e=>{v(!0),w();const t=Math.round(e.clientX),n=Math.round(e.clientY),s=Math.abs(t-i.current)<=8,d=Math.abs(t-o.current)<=8,c=Math.abs(n-a.current)<=8,h=Math.abs(n-r.current)<=8;l.current={x1:s,x2:d,y1:c,y2:h};const{HTMLElement:u}=p;e.target instanceof u&&e.target.setPointerCapture(e.pointerId.toString())},S=e=>{m&&(l.current.x1&&(i.current=e.clientX),l.current.x2&&(o.current=e.clientX),l.current.y1&&(a.current=e.clientY),l.current.y2&&(r.current=e.clientY),I(),w())},I=()=>{const e=i.current,t=o.current,n=a.current,s=r.current,{innerWidth:l,innerHeight:d}=p;e>l?i.current=l:t>e?(l-t<El&&(o.current=l),e<El&&(i.current=0)):t<El&&(o.current=0),n>d?a.current=d:s>n?(d-s<El&&(r.current=d),n<El&&(a.current=0)):s<El&&(r.current=0)},k=t=>{if(m){const{HTMLElement:n}=p;t.target instanceof n&&t.target.releasePointerCapture(t.pointerId.toString()),v(!1);const{current:i}=s;if(!i)return;const{width:o,height:a}=i.getBoundingClientRect();(o<=3||a<=3)&&ul.Z.cancelCallback(e.winId)}},A=()=>{const{current:e}=s,{current:t}=n;if(e&&t)if("area"===h){g({areaStyle:{borderColor:"rgba(0,0,0,0)",visibility:"hidden"},rectStyle:void 0}),v(!0),t.addEventListener("transitionend",T,!0)}else y(!0),Z()},T=()=>{n.current?.removeEventListener("transitionend",T);const t={x:Math.min(i.current,o.current),y:Math.min(a.current,r.current),width:Math.max(o.current,i.current)-Math.min(i.current,o.current),height:Math.max(r.current,a.current)-Math.min(r.current,a.current)};ul.Z.performCapture({windowId:p.vivaldiWindowId,mode:h,opts:t,noteId:e.capturing.noteId})},Z=async()=>{const n=t[$.kWebpagesCaptureSaveLocation],s=t[$.kWebpagesCaptureCompressionFormat],i=ie.ZP.getActivePage(e.winId)?.id;if(!i)return;const{image:o}=await ul.Z.captureFullpage(i,s,n);y(!1),gl.Z.disableCapture(e.winId),ul.Z.handleCaptureLocation({windowId:e.winId,mode:h,base64:o,noteId:e.capturing.noteId})},E=As()("CaptureArea","PreserveTransitions",{Area:"area"===h,FullPage:"area"!==h}),_=As()("CaptureRect",{Hidden:!u?.rectStyle});return(0,fs.jsxs)(fs.Fragment,{children:[(0,fs.jsx)("div",{ref:n,style:u?.areaStyle,id:"capture-area",className:E,tabIndex:0,onKeyDown:t=>{const{keyCode:n}=t;n===oa.Z.KEY_ESCAPE?(ul.Z.cancelCallback(e.winId),m&&v(!1)):n!==oa.Z.KEY_ENTER&&n!==oa.Z.KEY_RETURN||A()},onPointerDown:e=>{if(!h.includes("area"))return;v(!0),i.current=o.current=e.clientX,a.current=r.current=e.clientY,w();const{HTMLElement:t}=p;e.target instanceof t&&e.target.setPointerCapture(e.pointerId.toString()),(0,to.ZP)(e)},onPointerMove:e=>{m&&(o.current=e.clientX,r.current=e.clientY,I(),w())},onPointerUp:k}),!m&&Zl(Al,{winId:e.winId,captureSquare:u?.rectStyle,isInternalUrl:d,inProgress:f,mode:h,setMode:e=>{const{value:t}=e.target;"area"!==t&&"fullpage"!==t||Ne.Z.set($.kWebpagesCaptureCaptureMode,t)},setFormat:e=>{const{value:t}=e.target;"png"===t||"jpg"===t?(Ne.Z.set($.kWebpagesCaptureSaveLocation,"file"),Ne.Z.set($.kWebpagesCaptureCompressionFormat,t)):Ne.Z.set($.kWebpagesCaptureSaveLocation,t)},doScreenshot:A}),(0,fs.jsx)("div",{ref:s,style:u?.rectStyle,className:_,children:Ml.map((e=>Zl("div",{className:`CaptureRect-Corner ${e}`,onPointerDown:b,onPointerMove:S,onPointerUp:k},e)))})]})}class Dl extends F.Z{getInitialState(){return new Map}reduce(e,t){switch(t.actionType){case"CAPTURE_ENABLE":const{noteId:n}=t;return(0,V.Uy)(e,(e=>{e.set(t.winId,{capturing:!0,noteId:n})}));case"CAPTURE_DISABLE":return(0,V.Uy)(e,(e=>{e.delete(t.winId)}))}return e}getCapturingState(e){return this.getState().get(e)}}const xl=new Dl;var Ol=n(65398);class Ll extends Ol.Z{_storeState=new Map;getUtilityWebView(e){return this._storeState.get(e)}dispatchAction(e){if("UTILITY_WEBVIEW_SET_VIEW"===e.actionType)this._storeState.set(e.windowId,e.webview),this.emitChange()}}const Rl=new Ll(y.Z);var Bl,Fl=n(70864),Vl=n(67074);function Wl(e,t,n,s){Bl||(Bl="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Bl,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ul=1e6,Hl=[{text:(0,Oe.Z)("Past Hour"),value:"past_hour",format:"h",difference:-1},{text:(0,Oe.Z)("Past Day"),value:"past_day",format:"d",difference:-1},{text:(0,Oe.Z)("Past Week"),value:"past_week",format:"d",difference:-7},{text:(0,Oe.Z)("Past 4 Weeks"),value:"past_4_weeks",format:"d",difference:-28},{text:(0,Oe.Z)("All Time"),value:"everything",format:"",difference:0}],zl=[{value:"history",category:"history",text:(0,Oe.Z)("Browsing History")},{value:"typedHistory",category:"history",text:(0,Oe.Z)("Typed History")},{value:"siteUsageData",category:"history",text:(0,Oe.Z)("Site Usage Data")},{value:"translateHistory",category:"history",text:(0,Oe.Z)("Translation History")},{value:"downloads",category:"downloads",text:(0,Oe.Z)("Downloads")},{value:"cookies",category:"sitedata",text:(0,Oe.Z)("Cookies")},{value:"sessionCookies",category:"sitedata",text:(0,Oe.Z)("Cookies")},{value:"persistentCookies",category:"sitedata",text:(0,Oe.Z)("Cookies")},{value:"pluginData",category:"sitedata",text:(0,Oe.Z)("Plugin Data")},{value:"localStorage",category:"storage",text:(0,Oe.Z)("Storage (including Extension Storage)")},{value:"fileSystems",category:"storage",text:(0,Oe.Z)("File Systems")},{value:"webSQL",category:"storage",text:(0,Oe.Z)("Web SQL")},{value:"serverBoundCertificates",category:"storage",text:(0,Oe.Z)("Server Bound Certificates")},{value:"indexedDB",category:"storage",text:(0,Oe.Z)("Indexed DB")},{value:"serviceWorkers",category:"storage",text:(0,Oe.Z)("Service Workers")},{value:"cache",category:"caches",text:(0,Oe.Z)("Cache")},{value:"cacheStorage",category:"caches",text:(0,Oe.Z)("Cache Storage")},{value:"discardUserData",category:"caches",text:(0,Oe.Z)("Discard User Data")},{value:"passwords",category:"passwords",text:(0,Oe.Z)("Passwords (including your Sync login password)")},{value:"formData",category:"forms",text:(0,Oe.Z)("Form Autofill Data")},{value:"appcache",category:"appcache",text:(0,Oe.Z)("Applications Cache")},{value:"siteSettings",category:"sitesettings",text:(0,Oe.Z)("Site Settings")}];var Gl=Wl("p",{className:"in-progress"});class $l extends hs.PureComponent{static contextType=xi.Z;constructor(e){super(e);const t=zl.reduce(((e,t)=>(e[t.value]=!1,e)),{}),n=H.Z.get($.kClearPrivateDataEntries);n&&Object.entries(n).forEach((([e,s])=>{void 0===t[e]&&delete n[e]})),Object.assign(t,n);const s=new Map;zl.forEach((e=>{const t=s.get(e.category);t?t.push(e):s.set(e.category,[e])})),s.forEach((e=>{if(e.length>1){let n=0;e.forEach((e=>{t[e.value]&&n++})),0!==n&&n!==e.length&&e.forEach((e=>{t[e.value]=!0}))}}));const i={};let o=!0;Object.keys(t).forEach((e=>{i[e]=0,t[e]||(o=!1)})),this.state={all:o,inProgress:!1,deleteHistoryFrom:H.Z.get($.kClearPrivateDataRange),dataToRemove:t,dataToRemoveCounters:i}}componentDidMount(){this.updateClearDownloadsCounters(),this.updateClearBrowsingHistoryCounters()}selectChanged=e=>{this.updateClearDownloadsCounters({deleteHistoryFrom:e.target.value}),this.updateClearBrowsingHistoryCounters({deleteHistoryFrom:e.target.value}),this.setState({deleteHistoryFrom:e.target.value})};_onYes=e=>{const{dataToRemove:t,deleteHistoryFrom:n}=this.state;Ne.Z.set($.kClearPrivateDataEntries,t),Ne.Z.set($.kClearPrivateDataRange,n),this.setState({inProgress:!0}),e={deleteHistoryFrom:n,...e};const i=Hl.find((e=>n===e.value)),o=i&&"everything"!==n?N()().add(i.difference,i.format).startOf(i.format).valueOf():0,a=Rl.getUtilityWebView(this.context.vivaldiWindowId);if(!a)return;const{downloads:r,formData:l,history:d,serverBoundCertificates:c,serviceWorkers:h,siteUsageData:p,pluginData:u,passwords:m,typedHistory:v,translateHistory:f,siteSettings:y,discardUserData:w,...b}=t;a.clearData({since:o},b,(async()=>{s.Z.runtime.lastError&&console.warn("Error clearing data: ",s.Z.runtime.lastError.message);try{const{typedHistory:e,translateHistory:n,sessionCookies:i,persistentCookies:a,discardUserData:r,...l}=t;await s.Z.browsingData.remove({since:o},l)}catch(e){console.warn("Error clearing data: ",e.message)}t.history&&(L.removeLocalHistory(o),C.Z.contentBlocking.clearBlockedCounters()),t.translateHistory&&C.Z.translateHistory.reset(o),t.discardUserData&&(g.Z.emptyTrash(),Nn.Z.emptyTrash(),Fl.Z.emptyTrash()),t.typedHistory&&$n.Z.deleteTypedHistoryPeriod(o),C.Z.utilities.cleanUnusedImages(0),this.props.onYes?.()}))};_onNo=()=>{this.props.onNo&&this.props.onNo()};updateClearDownloadsCounters=e=>{if("everything"===(e={deleteHistoryFrom:this.state.deleteHistoryFrom,downloads:this.state.dataToRemove.downloads,...e}).deleteHistoryFrom)s.Z.downloads.search({},(e=>{this.setState((t=>({dataToRemoveCounters:{...t.dataToRemoveCounters,downloads:e.length}})))}));else{const t=this.getSelectedStartTime(e.deleteHistoryFrom);s.Z.downloads.search({},(e=>{const n=e.filter((e=>N()(e.startTime).valueOf()>t));this.setState((e=>({dataToRemoveCounters:{...e.dataToRemoveCounters,downloads:n.length}})))}))}};getSelectedStartTime=e=>{const t=Hl.find((t=>e===t.value));let n;return n=t?N()().add(t.difference,t.format).startOf(t.format).valueOf():N()().add(-1,"h").startOf("h").valueOf(),n};updateClearBrowsingHistoryCounters=e=>{if("everything"===(e={deleteHistoryFrom:this.state.deleteHistoryFrom,history:this.state.dataToRemove.history,...e}).deleteHistoryFrom)s.Z.history.search({text:"",startTime:0,maxResults:Ul},(e=>{this.setState((t=>({dataToRemoveCounters:{...t.dataToRemoveCounters,history:e.length}})))}));else{const t=this.getSelectedStartTime(e.deleteHistoryFrom);s.Z.history.search({text:"",maxResults:Ul,startTime:t},(e=>{this.setState((t=>({dataToRemoveCounters:{...t.dataToRemoveCounters,history:e.length}})))}))}};toggleAll=()=>{this.setState((e=>{const t=!e.all,n={};return Object.keys(e.dataToRemove).forEach((e=>{n[e]=t})),{all:t,dataToRemove:n}}))};toggleOne=(e,t)=>{"history"===e&&this.updateClearBrowsingHistoryCounters({history:t.target.checked}),"downloads"===e&&this.updateClearDownloadsCounters({downloads:t.target.checked});const n=zl.reduce(((n,s)=>(s.category===e&&(n[s.value]=t.target.checked),n)),{});this.setState((e=>{const t={...e.dataToRemove,...n};return{dataToRemove:t,all:Boolean(!Object.keys(t).find((e=>!1===t[e])))}}))};render(){if(G.ZP.isGuest())return Wl("header",{className:"dialog-header"},void 0,Wl("p",{className:"error"},void 0,(0,Oe.Z)("Delete Browsing Data not available from guest windows.")));const e=Hl.map((e=>Wl("option",{value:e.value},e.value,e.text))),t=Boolean(!Object.keys(this.state.dataToRemove).find((e=>!0===this.state.dataToRemove[e]))),n=zl.map(((e,t,n)=>{if(!n[t-1]||e.category!==n[t-1].category)return Wl("li",{style:{paddingLeft:"18px"}},e.value,Wl("label",{},void 0,Wl("input",{type:"checkbox",checked:this.state.dataToRemove[e.value],onChange:t=>this.toggleOne(e.category,t)}),Wl("span",{},void 0,e.text),this.state.dataToRemoveCounters[e.value]>0&&this.state.dataToRemove[e.value]&&Wl("span",{className:"item-count"},void 0,this.state.dataToRemoveCounters[e.value])))}));var s=Wl("div",{className:"dialog-clear-data"},void 0,Wl("header",{className:"dialog-header"},void 0,Wl("h1",{},void 0,(0,Oe.Z)("title","Delete Browsing Data"))),Wl("form",{className:"dialog-clear-data",onSubmit:this._onYes},void 0,Wl("div",{className:"dialog-content"},void 0,Wl("div",{className:"setting-single"},void 0,Wl("label",{},void 0,Wl("span",{},void 0,(0,Oe.Z)("Delete Data for:")),Wl("select",{onChange:this.selectChanged,value:this.state.deleteHistoryFrom,autoFocus:!0},void 0,e))),Wl("div",{className:"setting-single pad-top"},void 0,Wl("ul",{},void 0,Wl("li",{style:{paddingBottom:"6px"}},void 0,Wl("label",{},void 0,Wl("input",{type:"checkbox",checked:this.state.all,onChange:this.toggleAll}),Wl("span",{},void 0,(0,Oe.Z)("browser","All")))),n))),Wl("footer",{className:"dialog-footer"},void 0,Wl("input",{type:"submit",disabled:this.state.inProgress||t,value:(0,Oe.Z)("title","Delete")}),Wl("input",{type:"button",onClick:this._onNo,disabled:this.state.inProgress,value:(0,Oe.Z)("Cancel")}),this.state.inProgress&&Gl)));return(0,Vl.ZP)(s,this.props.filter)}}const Kl=$l;var jl,Yl,Xl;function Ql(e,t,n,s){jl||(jl="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:jl,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function ql(e){return Ql(_r.Z,{onRequestClose:e.onClose},void 0,Ql(Kl,{onNo:e.onClose,onYes:e.onClose}))}function Jl(e,t,n,s){Yl||(Yl="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Yl,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class ed extends hs.Component{static contextType=xi.Z;context;state={doNotShowAgain:!1};_onNo=()=>{this.props.onRequestClose()};_onYes=()=>{Ne.Z.set($.kTabsConfirmClosingTabs,!this.state.doNotShowAgain),this.props.onRequestClose(),d.ZP.closePage(this.props.options.pages,{bypassConfirm:!0})};_toggleDoNotShowAgain=()=>{this.setState((e=>({doNotShowAgain:!e.doNotShowAgain})))};render(){return Jl(_r.Z,{onRequestClose:this._onNo},void 0,Jl("header",{className:"dialog-header"},void 0,Jl("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("title","Close Tabs"))),Jl("form",{onSubmit:this._onYes},void 0,Jl("div",{className:"dialog-content"},void 0,Jl("p",{},void 0,(0,Oe.Z)("Do you want to close $1 tab?","Do you want to close $1 tabs?",[this.props.options.pages.size])),Jl("label",{className:"dialog-checkbox"},void 0,Jl("input",{type:"checkbox",checked:this.state.doNotShowAgain,onChange:this._toggleDoNotShowAgain}),Jl("span",{},void 0,(0,Oe.Z)("Do not ask again")))),Jl("footer",{className:"dialog-footer"},void 0,Jl("input",{type:"submit",onClick:this._onYes,value:(0,Oe.Z)("command","Close Tabs"),autoFocus:!0}),Jl("input",{type:"button",onClick:this._onNo,value:(0,Oe.Z)("Cancel")}))))}}function td(e,t,n,s){Xl||(Xl="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Xl,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class nd extends hs.Component{static contextType=xi.Z;context;state={doNotShowAgain:!1};_onNo=()=>{this.props.onRequestClose()};_onYes=()=>{Ne.Z.set($.kBookmarksConfirmOpening,!this.state.doNotShowAgain),this.props.onRequestClose(),d.ZP.openUrls(this.context.vivaldiWindowId,this.props.options.urls,{...this.props.options.openOptions})};_toggleDoNotShowAgain=()=>{this.setState((e=>({doNotShowAgain:!e.doNotShowAgain})))};render(){return td(_r.Z,{onRequestClose:this._onNo},void 0,td("header",{className:"dialog-header"},void 0,td("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("Open Multiple Links"))),td("form",{onSubmit:this._onYes},void 0,td("div",{className:"dialog-content"},void 0,td("p",{},void 0,(0,Oe.Z)("Do you want to open $1 link?","Do you want to open $1 links?",[this.props.options.urls.length])),td("label",{className:"dialog-checkbox"},void 0,td("input",{type:"checkbox",checked:this.state.doNotShowAgain,onChange:this._toggleDoNotShowAgain}),td("span",{},void 0,(0,Oe.Z)("Do not ask again")))),td("footer",{className:"dialog-footer"},void 0,td("input",{type:"submit",onClick:this._onYes,value:(0,Oe.Z)("Open All Links"),autoFocus:!0}),td("input",{type:"button",onClick:this._onNo,value:(0,Oe.Z)("Cancel")}))))}}const sd=async e=>{const{windowId:t,query:n,searchEngine:s,typedSearchEngine:i,abortSignal:o}=e;if(n.length<2||G.ZP.isIncognito(t)||!s.suggestUrl)return Promise.resolve([]);const{url:a,contentType:r,postParams:l}=await C.Z.searchEngines.getSuggestRequest(s.id,n);return new Promise((e=>{const t=""!==l;fetch(a,{signal:o,headers:t?{"Content-Type":r}:void 0,method:t?"POST":"GET",body:t?l:void 0}).then((async t=>{const n=(await t.json())[1].filter((e=>"string"==typeof e));e(function(e,t,n){const s=H.Z.get($.kAddressBarOmniboxNumberOfSearchSuggestions);return n.slice(0,s).map((n=>{const s=function(e,t){return e&&e.keyword&&!t.startsWith(e.keyword+" ")?e.keyword+" "+t:t}(t,n);return{id:n,type:"OMNI_RESULT_SUGGEST",isDeleteDisabled:!0,url:s,title:s,faviconUrl:e?.faviconUrl??"",faviconType:"img"}}))}(s,i,n))})).catch((t=>{"AbortError"!==t.name&&console.warn(t),e([])}))}))},id=()=>{let e=1;const t={id:"",extensionId:"",readOnly:!1,name:"New Engine",keyword:"new",faviconUrl:"",url:"https://example.com/search?q=%s",postParams:"",suggestUrl:"",suggestPostParams:"",imageUrl:"",imagePostParams:"",prepopulateId:0};for(;Gn.Z.getByKeyword(t.keyword);)t.keyword=`new${e}`,e++;return t};var od,ad=n(57458);function rd(e,t,n,s){od||(od="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:od,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class ld extends hs.Component{static contextType=xi.Z;constructor(e){super(e),this.state={name:this.props.name?this.props.name:"",url:this.props.url?this.props.url.replace("{searchTerms}","%s"):"",nickname:this.props.name?this.props.name:"",nicknameTaken:!1,default:!1},this.faviconUrl=""}componentDidMount(){this.constructFavicon(this.props.url)}getDataUri=(e,t)=>{const{document:n}=this.context,s=new Image;s.onload=function(){const s=n.createElement("canvas");s.width=this.naturalWidth,s.height=this.naturalHeight,s.getContext("2d").drawImage(this,0,0),t(s.toDataURL(e))},s.src=e};constructFavicon=e=>{const{document:t}=this.context;if(e){const n=(0,vs.q9)(e.trim()),s=t.createElement("a");s.href=n;const i=s.protocol+"//"+s.host+"/favicon.ico";this.getDataUri(i,(e=>{this.faviconUrl=e}))}};updateFavicon=e=>{if("string"==typeof e.target.value){const t=e.target.value.trim();if(t)return void this.constructFavicon(t)}this.faviconUrl=""};canCreate=()=>Boolean(this.state.name.trim()&&this.state.url.trim()&&this.state.nickname.trim()&&!1===this.state.nicknameTaken);create=async()=>{if(this.canCreate()){const e=id();e.name=this.state.name.trim(),e.keyword=this.state.nickname,e.url=(0,ad.encode)(this.state.url.trim()),e.faviconUrl=this.faviconUrl;const t=await C.Z.searchEngines.addTemplateUrl(e);t&&this.state.default&&C.Z.searchEngines.setDefault("defaultSearch",t),"function"==typeof this.props.onClose&&this.props.onClose()}};nameChange=e=>{"string"==typeof e.target.value&&this.setState({name:e.target.value})};defaultChange=e=>{"boolean"==typeof e.target.checked&&this.setState({default:e.target.checked})};urlChange=e=>{"string"==typeof e.target.value&&this.setState({url:e.target.value})};nicknameChange=e=>{if("string"==typeof e.target.value){const t=e.target.value.trim();this.setState({nickname:t,nicknameTaken:t.length>0&&void 0!==Gn.Z.getByKeyword(t)})}};render(){const e=this.state.nicknameTaken?Gn.Z.getByKeyword(this.state.nickname):null,t=e?e.name:"";return rd("form",{onSubmit:this.create},void 0,rd("header",{className:"dialog-header"},void 0,rd("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("Add Search Engine"))),rd("div",{className:"dialog-content"},void 0,rd("label",{className:"fieldset"},void 0,rd("input",{className:"searchengine_url setting-single-flex",type:"text",placeholder:(0,Oe.Z)("URL"),value:this.state.url,onChange:this.urlChange,onBlur:this.updateFavicon})),rd("label",{className:"fieldset"},void 0,rd("input",{className:"setting-single-flex",type:"text",value:this.state.name,placeholder:(0,Oe.Z)("Description"),onChange:this.nameChange,autoFocus:!0}),rd("input",{className:"searchengine_keyword setting-single-noflex",type:"text",value:this.state.nickname,placeholder:(0,Oe.Z)("Nickname"),onChange:this.nicknameChange})),this.state.nicknameTaken&&rd("p",{className:"info",style:{textAlign:"right"}},void 0,(0,Oe.Z)("Nickname in use by $1 search engine",[t])),rd("label",{className:"fieldset"},void 0,rd("input",{type:"checkbox",checked:this.state.default,onChange:this.defaultChange}),rd("span",{},void 0,(0,Oe.Z)("Set as Default Search")))),rd("footer",{className:"dialog-footer"},void 0,rd("input",{type:"submit",disabled:!this.canCreate(),value:(0,Oe.Z)("Add")}),rd("input",{type:"button",onClick:this.props.onClose,value:(0,Oe.Z)("Cancel")})))}}const dd=ld;var cd;function hd(e,t,n,s){cd||(cd="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:cd,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const pd=function(e){return hd(_r.Z,{onRequestClose:e.onClose},void 0,hd("div",{className:"dialog-addsearch"},void 0,hd(dd,{onClose:e.onClose,name:e.name,url:e.url})))};var ud=n(15285);const gd=1e3,md=[(0,Oe.Z)("B"),(0,Oe.Z)("kB"),(0,Oe.Z)("MB"),(0,Oe.Z)("GB"),(0,Oe.Z)("TB"),(0,Oe.Z)("PB"),(0,Oe.Z)("EB"),(0,Oe.Z)("ZB"),(0,Oe.Z)("YB")],vd=(0,Oe.Z)("bytes");function fd(e,t,n=!0){if(isNaN(e))return e?e.toString():"";if(e<=0)return"0 "+(n?vd:md[0]);void 0===t&&(t=e<gd?0:2);let s=md.length-1;for(var i=0;i<md.length;i++)if(e<Math.pow(gd,i+1)){s=i;break}let o=(e/Math.pow(gd,s)).toLocaleString(void 0,{maximumFractionDigits:t});if(t>0){const e="."+"0".repeat(t);o.endsWith(e)&&(o=o.substring(0,o.length-e.length))}const a=0===s&&n?vd:md[s];return o+(a?" "+a:"")}var yd=n(29526);const Cd=function(e){return class extends hs.Component{state={disabled:!0};componentDidMount(){this.timeout=setTimeout(this.enable,500)}componentWillUnmount(){clearTimeout(this.timeout)}enable=()=>this.setState({disabled:this.props.disabled||!1});render(){const{disabled:t,...n}=this.props,s=e||"input";return(0,fs.jsx)(s,{...n,disabled:this.state.disabled})}}};var wd,bd=n(86461);function Sd(e,t,n,s){wd||(wd="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:wd,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Id=Cd("input");class kd extends hs.Component{static contextType=xi.Z;refDefaultAction=hs.createRef();state={askNextTime:!1};componentDidMount(){this.refDefaultAction.current?.focus()}maybeShowDownloads(){const e=this.context.vivaldiWindowId;!ud.ZP.getIsVisible(e,"PanelDownloads")&&H.Z.get($.kDownloadsOpenPanelOnNew)&&v.Z.executeActions("button",this.context,(0,bd.PK)("DownloadButton",e)?"COMMAND_SHOW_DOWNLOADS_POPOUT":"COMMAND_SHOW_DOWNLOADS_PANEL")}onOpen=()=>{this.props.customData.request.allow("open"),this.maybeShowDownloads(),this.close()};onSave=()=>{this.props.customData.request.allow(),this.maybeShowDownloads(),this.close()};onSaveAs=()=>{this.props.customData.request.allow("saveas"),this.maybeShowDownloads(),this.close()};onCancel=()=>{this.props.customData.request.deny(),this.close()};close=()=>{Ne.Z.set($.kDownloadsStartAutomatically,this.state.askNextTime),this.props.onClose()};onAskDownloadChanged=({target:e})=>{this.setState({askNextTime:e.checked})};getHostAndPathname=()=>{const e=(0,yd.Z)(this.props.customData.url);let t="",n="";const s=(0,ms.Z)(e);return s&&({hostname:t,pathname:n}=s),{hostname:t,pathname:n}};render(){const e=this.props.customData.url.startsWith("data:");let t="",n="";this.props.customData.suggestedFilename&&e||({hostname:t,pathname:n}=this.getHostAndPathname());const s=this.props.customData.suggestedFilename?this.props.customData.suggestedFilename:(n||"").split("/").pop(),i=e?(0,Oe.Z)("Data URL"):t,o=-1===this.props.customData.fileSize?(0,Oe.Z)("Unknown"):fd(this.props.customData.fileSize);return Sd(_r.Z,{ignoreClickOutside:!0,ignoreEscape:!1,onRequestClose:this.onCancel},void 0,Sd("div",{className:"dialog-download"},void 0,Sd("header",{className:"dialog-header"},void 0,Sd("h1",{className:"dialog-title",title:s},void 0,(0,Oe.Z)("Download “$1”?",[s]))),Sd("div",{className:"dialog-content"},void 0,Sd("p",{},void 0,Sd("span",{className:"label",title:s},void 0,(0,Oe.Z)("File Name:")),Sd("span",{className:"selectable"},void 0,s)),Sd("p",{},void 0,Sd("span",{className:"label"},void 0,(0,Oe.Z)("File Size:")),Sd("span",{className:"selectable"},void 0,o)),Sd("p",{},void 0,Sd("span",{className:"label"},void 0,(0,Oe.Z)("Host:")),Sd("span",{className:"selectable"},void 0,i)),Sd("p",{},void 0,Sd("span",{className:"label"},void 0,(0,Oe.Z)("Location:")),Sd("span",{className:"selectable"},void 0,H.Z.get($.kDownloadDefaultDirectory))),Sd("label",{className:"autosave"},void 0,Sd("input",{type:"checkbox",onChange:this.onAskDownloadChanged}),Sd("span",{},void 0,(0,Oe.Z)("Always Save Files to Default Download Location")))),Sd("footer",{className:"dialog-footer"},void 0,(0,fs.jsx)("input",{type:"button",className:"primary",onClick:this.onSave,ref:this.refDefaultAction,value:(0,Oe.Z)("Save")}),Sd("input",{type:"button",onClick:this.onSaveAs,value:(0,Oe.Z)("Save As...")}),Sd(Id,{type:"button",onClick:this.onOpen,value:(0,Oe.Z)("Open")}),Sd("input",{type:"button",onClick:this.onCancel,value:(0,Oe.Z)("Cancel")}))))}}const Ad=kd;var Td;function Zd(e,t,n,s){Td||(Td="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Td,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Ed extends hs.PureComponent{static contextType=xi.Z;clickOnExtensionError(e){C.Z.extensionActionUtils.showGlobalError(e,this.context.vivaldiWindowId),1===this.props.errors.length&&this.props.onClose()}render(){return Zd(_r.Z,{style:{width:400},onRequestClose:this.props.onClose,ignoreClickOutside:!0,viewMode:"disabledExtensionsPopup slide"},void 0,Zd("header",{className:"dialog-header"},void 0,Zd("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("Extension Installed","Extensions Installed",[this.props.errors.length]))),Zd("div",{className:"dialog-content"},void 0,Zd("p",{className:"new-extension"},void 0,Zd("span",{dangerouslySetInnerHTML:{__html:Ts.Si$.medium}}),(0,Oe.Z)("A new extension was added by another application, and was automatically disabled.","New extensions were added by other applications, and were automatically disabled.",[this.props.errors.length])),this.props.errors.map((e=>Zd("div",{className:"list-item"},e.id,Zd("button",{onClick:()=>this.clickOnExtensionError(e.commandId)},void 0,(0,Oe.Z)("Review")),e.name)))),Zd("footer",{className:"dialog-footer"},void 0,Zd("input",{type:"button",value:(0,Oe.Z)("Show All Extensions"),onClick:()=>{Ae.Z.showExtensions(this.context.vivaldiWindowId),this.props.onClose()}}),Zd("input",{type:"button",value:(0,Oe.Z)("Close"),onClick:this.props.onClose})))}}const _d=Ed;var Md;function Nd(e,t,n,s){Md||(Md="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Md,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Pd extends hs.Component{constructor(e){super(e),this.state={hover:!1,show:!0}}componentDidMount(){this.hideSelf(4e3)}componentWillUnmount(){this._timeoutID&&clearTimeout(this._timeoutID)}startHover=e=>{this.setState({hover:!0})};endHover=e=>{this.setState({hover:!1})};showSelf=()=>{this._timeoutID&&clearTimeout(this._timeoutID),this.setState({show:!0}),this.props.onVisibilityChanged&&this.props.onVisibilityChanged(!0)};hideSelf=e=>{this._timeoutID&&clearTimeout(this._timeoutID),this._timeoutID=setTimeout(this.onClose,e)};onClose=()=>{this.setState({show:!1,hover:!1}),this.props.onClose&&this.props.onClose(),this.props.onVisibilityChanged&&this.props.onVisibilityChanged(!1)};onContextMenu=e=>{this._timeoutID&&clearTimeout(this._timeoutID),this.props.onContextMenu&&this.props.onContextMenu(e)};show=()=>{this.showSelf(),this.hideSelf(4e3)};render(){var e=As()({overlayinfobubble:!0,show:this.state.hover||this.state.show});return Nd("div",{onMouseEnter:this.startHover,onMouseLeave:this.endHover},void 0,Nd("div",{className:e,onContextMenu:this.onContextMenu,onClick:this.hideSelf.bind(this,0)},void 0,this.props.overlayText))}}const Dd=Pd;class xd extends hs.Component{static contextType=xi.Z;overlayRef=null;overlayVisible=!0;constructor(e){super(e),this.state={contextOpen:!1,show:!0}}showSelf=()=>{this.setState({show:!0}),this.overlayRef&&this.overlayRef.show()};hideSelf=()=>{this.setState({show:!1,contextOpen:!1})};alwaysHide=()=>{Ne.Z.set($.kWebpagesFullScreenShowBubble,!1),this.hideSelf()};shouldShow=()=>!!H.Z.get($.kWebpagesFullScreenShowBubble)&&(this.state.contextOpen||this.state.show);onOverlayVisibilityChanged=e=>{this.overlayVisible=e};onContextMenu=e=>{const t=[{handler:this.hideSelf.bind(this),...(0,xs.Z)("Hide Fullscreen Reminder")},{handler:this.alwaysHide,...(0,xs.Z)("Never Show Fullscreen Reminder")}];(0,Qi.Z)(this.context,t,(e=>this.setState({contextOpen:e})))(e)};render(){let e=null;if(this.shouldShow()){const t=(0,Oe.Z)("Press Escape key to exit fullscreen.");e=(0,fs.jsx)(Dd,{ref:e=>this.overlayRef=e,customData:this.props.customData,onClose:this.props.closeDialog,onContextMenu:this.onContextMenu,onVisibilityChanged:this.onOverlayVisibilityChanged,overlayText:t})}return e}}const Od=xd;var Ld,Rd=n(15800),Bd=n(50522),Fd=n(22616),Vd=n(34006);function Wd(e,t,n,s){Ld||(Ld="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Ld,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const{ensureHttpsForWebcal:Ud}=Rd.Z;function Hd(e,t){const n=[];for(const s of e)"ical"!==s.account_type&&n.push({account:s,calendars:t.filter((e=>e.accountId===s.id))});return n.sort(((e,t)=>"local"===e.account.account_type?1:"local"===t.account.account_type?-1:0))}const zd="CREATE_CALENDAR";class Gd extends hs.PureComponent{#r=[];#l=[];constructor(e){super(e);const t="string"==typeof e.file?e.file.split("\\").pop().split("/").pop():e.file.name;this.#r=Bd.Z.getAccounts(),this.#l=Bd.Z.getCalendars(),this.state={calendarGroups:Hd(this.#r,this.#l),importOption:{file:e.file,calendarId:"",createNew:!0,newCalendarName:t,importId:t},calendarName:"",eventCount:0,host:""}}componentDidMount(){Bd.Z.addListener(this.#d),this.probeiCal()}componentWillUnmount(){Bd.Z.removeListener(this.#d)}componentDidUpdate(e){this.props.file!==e.file&&this.probeiCal(),this.props.import&&!e.import&&async function(e){try{await(0,Vd.PU)(e)}catch(t){Fd.Z.addImportError("Calendar",e.importId,t.message)}}(this.state.importOption)}probeiCal=async()=>{const{message:e,eventCount:t,error:n,calendarName:s}=await(0,Vd.ig)(this.state.importOption);this.props.onStatus(e,t,n);const i={eventCount:t,calendarName:s},{file:o}=this.props;if("string"==typeof o){if(this.props.standAlone&&!o.startsWith("webcal")&&1===t&&Bd.Z.getWritableCalendars().length>0){const e=this.props.windowId??G.ZP.getLastActiveBrowserWindowId();(0,Vd.BC)(this.state.importOption,e)}o.startsWith("webcal")||o.startsWith("http")?i.host=C.Z.utilities.getUrlFragments(Ud(o))?.host??"":i.host=""}this.setState(i)};#d=()=>{const{accounts:e,calendars:t}=Bd.Z.getState();e===this.#r&&t===this.#l||(this.setState({calendarGroups:Hd(e,t)}),this.#r=e,this.#l=t)};onNameChange=e=>{const{importOption:t}=this.state,n=e.target.value===zd?{createNew:!0,calendarId:""}:{calendarId:e.target.value,createNew:!1};this.setState((e=>({importOption:{...t,...n}})))};setCreateNewName=e=>{const{importOption:t}=this.state;this.setState((n=>({importOption:{...t,newCalendarName:e.target.value}})))};render(){const{importOption:e,calendarName:t}=this.state,{importId:n,createNew:s,calendarId:i,newCalendarName:o}=e,a=`<strong>${this.state.host||o}</strong>`,r=this.state.host||o?(0,Oe.Z)("Add $1 event from $2 to","Add $1 events from $2 to",[this.state.eventCount,a]):(0,Oe.Z)("Add $1 event to","Add $1 events to",[this.state.eventCount]);return(0,fs.jsxs)(fs.Fragment,{children:[this.props.standAlone&&Wd("p",{dangerouslySetInnerHTML:{__html:r}}),Wd("div",{className:"import-calendar-target"},void 0,n&&!this.props.standAlone&&Wd("label",{className:"import-calendar-name"},void 0,(0,Oe.Z)("$1 to",[n])),Wd("select",{onChange:this.onNameChange,name:"calendarId",value:s?zd:i},void 0,this.state.calendarGroups.map((({account:e,calendars:t})=>Wd("optgroup",{label:"local"===e.account_type?(0,Oe.Z)("Local Calendars"):e.name||e.url},e.id,(0,fs.jsxs)(fs.Fragment,{children:[t.map((e=>Wd("option",{value:e.id},e.id,e.description||e.name))),"local"===e.account_type&&Wd("option",{value:zd},void 0,(0,Oe.Z)("New Calendar..."))]}))))),s&&Wd("label",{className:"import-calendar-new-name"},void 0,Wd("input",{type:"text",value:t||o,onChange:this.setCreateNewName})))]})}}const $d=Gd;var Kd;function jd(e,t,n,s){Kd||(Kd="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Kd,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Yd extends hs.PureComponent{static contextType=xi.Z;displayName="ImportCalendarDialog";state={fileHandles:[],calendarId:Rd.Z.getDefaultCalendar()?.id||"",calendarName:"",doImport:!1};componentDidMount(){this.props.setStartImport(this.startImport),this.props.setChooseFile(this.loadImport)}loadImport=async()=>{try{const e=await this.context.showOpenFilePicker({multiple:!0,types:[{description:"iCalendar",accept:{"text/calendar":[".ics",".txt"]}}]});this.setState({fileHandles:e}),this.props.readyToStart(!0)}catch(e){"AbortError"!==e.name&&Fd.Z.addImportError("Calendar","File",e.message)}};reportStatus=(e,t,n=!1)=>{n&&Fd.Z.addImportError("Calendar","File",e)};startImport=async()=>{H.Z.get($.kMailIsTurnedOff)&&(et.Z.log("Calendar",["import"],"Calendar is turned off - turning it on for importing"),Ne.Z.set($.kMailIsTurnedOff,!1),Pn.Z.showContent(this.context.vivaldiWindowId,"PanelCalendar")),this.setState({doImport:!0}),this.props.readyToStart(!1)};render(){return jd("div",{className:"import-calendar-files"},void 0,!!this.state.fileHandles.length&&jd("div",{className:"import-calendar-targets"},void 0,this.state.fileHandles.map((e=>jd($d,{file:e,import:this.state.doImport,onStatus:Aa.Z},e.name)))))}}const Xd=Yd;var Qd;function qd(e,t,n,s){Qd||(Qd="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Qd,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Jd(e){switch(e){case"error":return Ts.viW;case"warning":return Ts.h6;case"success":return Ts.JLz;default:return Ts.GH$}}class ec extends hs.Component{_refFeedback=hs.createRef();componentDidMount(){this._refFeedback.current?.scrollIntoViewIfNeeded()}componentDidUpdate(){this._refFeedback.current?.scrollIntoViewIfNeeded()}render(){const{type:e="info",children:t}=this.props;return(0,fs.jsxs)("div",{ref:this._refFeedback,className:`FormFeedback FormFeedback--${e}`,children:[qd("span",{className:"FormFeedback-Icon",dangerouslySetInnerHTML:{__html:Jd(e)}}),t]})}}const tc=ec;var nc,sc=n(69417),ic=n(79706);function oc(e,t,n,s){nc||(nc="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:nc,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const{ensureHttpsForWebcal:ac}=Rd.Z;const rc=function(e){const{subscribe:t,url:n,onStatus:s}=e,[i,o]=(0,hs.useState)(),[a,r]=(0,hs.useState)(),[l,d]=(0,hs.useState)((0,Oe.Z)("New Calendar")),c=(0,hs.useRef)(l);c.current=l,(0,hs.useEffect)((()=>{(0,vs.C3)(n)?(o(C.Z.utilities.getUrlFragments(ac(n))?.host),async function(){s((0,Oe.Z)("Fetching iCal..."),0);const e=await ic.Z.probeWebCalendar({id:"",account_type:"ical",username:"",name:c.current,url:ac(n)},"");if(e.foundService){const t=e.calendars[0];t.description&&d(t.description),r(t);const n=t.description?(0,Oe.Z)("Found calendar ‘$2’ containing $1 event","Found calendar ‘$2’ containing $1 events",[e.eventCount,t.description]):(0,Oe.Z)("Found a calendar containing $1 event","Found a calendar containing $1 events",[e.eventCount]);s(n,e.eventCount)}else s(e.statusMessage,0,!0)}()):(o(void 0),n&&s((0,Oe.Z)("Invalid URL: $1",[n]),0,!0))}),[n,s]),(0,hs.useEffect)((()=>{a&&t&&async function(){try{await m.Z.createAccount({account_type:"ical",username:"",name:c.current,url:ac(n)}),s((0,Oe.Z)("Successfully subscribed to web calendar"),0)}catch(e){s(e.message,0,!0)}}()}),[a,t,n,s]);const h=i?(0,Oe.Z)("Add new calendar subscription from $1?",[`<strong>${i}</strong>`]):(0,Oe.Z)("Add new calendar subscription?");return oc("div",{className:"import-webcal"},void 0,e.showBody&&oc("p",{dangerouslySetInnerHTML:{__html:h}}),oc(sc.Z,{label:(0,Oe.Z)("Calendar Name"),type:"text",value:l,onChange:function(e){d(e.target.value)},disabled:!a}))};var lc;function dc(e,t,n,s){lc||(lc="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:lc,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class cc extends hs.PureComponent{state={url:"",urlField:"",subscribe:!1,status:"info",message:""};#c=!1;componentDidMount(){this.props.setStartImport(this.startImport)}setUrlDebounced=(0,no.Z)((e=>{this.state.url!==e&&this.setState({url:e,status:"info",message:""},(()=>{const e=this.state.url.replace(/^\w+:\/\//,"");this.#c=Bd.Z.getAccounts().some((t=>"ical"===t.account_type&&t.url.replace(/^\w+:\/\//,"")===e))}))}),1e3);onUrlChange=e=>{const t=e.target.value.trim();(0,vs.C3)(t)?this.setUrlDebounced(t):this.state.url&&this.setUrlDebounced(""),this.setState({urlField:t})};onFetch=e=>{const t=this.state.urlField;this.state.url!==t&&(0,vs.C3)(t)&&this.setState({url:t})};reportStatus=(e,t,n=!1)=>{this.setState({status:n?"error":"info",message:e}),n&&Fd.Z.addImportError("Calendar",this.state.url,e)};startImport=async()=>{Fd.Z.clearImportProgress("Calendar",this.state.url);const e={subscribe:!0};this.state.url!==this.state.urlField&&(e.url=this.state.urlField),this.setState(e)};render(){return(0,fs.jsxs)(fs.Fragment,{children:[dc("div",{className:"import-calendar-file"},void 0,dc("form",{onSubmit:this.onFetch},void 0,dc("label",{className:"floating-label"},void 0,dc("span",{},void 0,(0,Oe.Z)("Remote ICS Address")),dc("div",{className:"toolbar toolbar-default"},void 0,dc("input",{className:"floating-input",type:"text",onChange:this.onUrlChange,value:this.state.urlField}),dc("input",{type:"submit",value:(0,Oe.Z)("Fetch"),disabled:!this.state.urlField})))),dc(rc,{url:this.state.url,subscribe:this.state.subscribe,onStatus:this.reportStatus})),dc("div",{},void 0,this.state.message&&dc(tc,{type:this.state.status},void 0,this.state.message),this.#c&&dc(tc,{type:"warning"},void 0,(0,Oe.Z)("You are already subscribed to this calendar")))]})}}const hc=cc;var pc,uc=n(90864),gc=n(26219),mc=n(83065);function vc(e,t,n,s){pc||(pc="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:pc,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var fc=vc("br",{}),yc=vc("br",{});class Cc extends hs.PureComponent{static contextType=xi.Z;accountIdToPaths=new Map;constructor(e,t){super(e);const n=mn.Z.getAccounts(),s=Object.keys(n);for(const e of s){const t=uc.Z.getFoldersFlat({folders:n[e].folders},!1).map((e=>e.path));this.accountIdToPaths.set(e,t)}const i=this.accountIdToPaths.entries().next().value,[o,a]=i||["",[]],r=a[0]||"";this.state={upload:!1,fileEntries:[],accountId:o,path:r}}componentDidMount(){this.props.setStartImport(this.startImport),this.props.setChooseFiles(this.chooseFiles)}chooseFiles=async()=>{const e=await(0,gc.Z)(this.context,["eml","mbs","mbox"]);this.setState({fileEntries:e}),this.props.readyToStart(!!this.state.accountId&&!!this.state.path)};startImport=async()=>{H.Z.get($.kMailIsTurnedOff)&&(et.Z.log("Calendar",["import"],"Calendar is turned off - turning it on for importing"),Ne.Z.set($.kMailIsTurnedOff,!1)),l.Z.importMailFiles(this.context.vivaldiWindowId,this.state.fileEntries,this.state.accountId,this.state.path)};accountSelected=e=>{const t=e.target.value,n=this.accountIdToPaths.get(t),s=n?n[0]:"";this.setState({accountId:t,path:s}),this.props.readyToStart(this.state.fileEntries.length>0&&!!this.state.path)};pathSelected=e=>{this.setState({path:e.target.value}),this.props.readyToStart(this.state.fileEntries.length>0&&!!this.state.accountId)};render(){return vc("div",{className:"import-data"},void 0,vc("fieldset",{},void 0,vc("div",{className:"import-pathname"},void 0,(0,Oe.Z)("Source Files:"),fc,this.state.fileEntries.length>0&&vc("input",{type:"text",value:this.state.fileEntries.map((e=>e.name)).join(", "),readOnly:!0}),0===this.state.fileEntries.length&&vc("input",{type:"text",value:(0,Oe.Z)("No files selected yet"),readOnly:!0})),vc("label",{htmlFor:"accountSel",className:"from"},void 0,(0,Oe.Z)("import","Destination Account")),vc("select",{id:"accountSel",value:this.state.accountId,onChange:this.accountSelected},void 0,Array.from(this.accountIdToPaths.keys()).map((e=>vc("option",{value:e},e,e)))),vc("label",{htmlFor:"pathSel",className:"from"},void 0,(0,Oe.Z)("import","Destination Folder")),vc("select",{value:this.state.path,onChange:this.pathSelected},void 0,(this.accountIdToPaths.get(this.state.accountId)||[]).map((e=>vc("option",{value:e},e,(0,mc.kF)(e))))),vc("div",{className:"import-pathname"},void 0,(0,Oe.Z)("Destination:"),yc,vc("input",{type:"text",value:`${this.state.accountId}/${(0,mc.kF)(this.state.path)}`,readOnly:!0}))))}}const wc=Cc;var bc,Sc=n(80225);function Ic(e,t,n,s){bc||(bc="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:bc,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class kc extends hs.PureComponent{static contextType=xi.Z;componentDidMount(){this.props.setRunImporter(this.startNotesImporter)}startNotesImporter=()=>{const e=this.context.vivaldiWindowId;return(0,Sc.T$)(e)};render(){return(0,fs.jsx)(fs.Fragment,{children:Ic("div",{className:"import-notes"},void 0,Ic("p",{},void 0,(0,Oe.Z)("Import a folder and its subfolders of plain-text and Markdown files (.md, .txt).")))})}}const Ac=kc;var Tc;function Zc(e,t,n,s){Tc||(Tc="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Tc,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ec=()=>[{value:5,name:(0,Oe.Z)("Every 5 Minutes")},{value:15,name:(0,Oe.Z)("Every 15 Minutes")},{value:30,name:(0,Oe.Z)("Every 30 Minutes")},{value:60,name:(0,Oe.Z)("Every Hour")},{value:120,name:(0,Oe.Z)("Every 2 Hours")},{value:360,name:(0,Oe.Z)("Every 6 Hours")},{value:720,name:(0,Oe.Z)("Every 12 Hours")},{value:1440,name:(0,Oe.Z)("Daily")},{value:10080,name:(0,Oe.Z)("Weekly")},{value:-1,name:(0,Oe.Z)("other","Never")}].map((e=>Zc("option",{value:e.value},e.value,e.name)));var _c;function Mc(e,t,n,s){_c||(_c="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:_c,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Nc extends hs.PureComponent{constructor(e){super(e),this.state={feeds:this.mapFeeds(this.props.options)}}mapFeeds=e=>e.map((e=>({url:e.url||"",path:crypto.randomUUID(),title:e.title||"",refreshInterval:"number"==typeof e.refreshInterval?e.refreshInterval:120,offline:!1,lastChecked:0})));addFeed=()=>{const{feeds:e}=this.state;Fd.Z.setImportProgress("Feeds (OPML)","Feeds",0,e.length),qe.add(e),Fd.Z.setImportProgress("Feeds (OPML)","Feeds",e.length,e.length),this.props.dismissable&&this.onDismiss()};onDismiss=()=>{this.props.onClose()};onChange=e=>{const{name:t,value:n,id:s}=e.target;this.setState((e=>{let i=0;return{feeds:e.feeds.map((e=>(i++,"fid"+i===s?{...e,[t]:n}:e)))}}))};feeds=()=>{let e=0;return this.state.feeds.map((t=>{e++;const n="fid"+e;return Mc("div",{className:"feed-list-item"},n,Mc("input",{type:"text",placeholder:(0,Oe.Z)("Title"),onChange:this.onChange,title:(0,Oe.Z)("Title"),value:t.title,name:"title",id:n}),Mc("input",{type:"text",placeholder:(0,Oe.Z)("Address"),onChange:this.onChange,title:(0,Oe.Z)("Address"),value:t.url,name:"url",id:n}),Mc("select",{onChange:this.onChange,value:t.refreshInterval,name:"refreshInterval",id:n},void 0,Ec()))}))};render(){return Mc("div",{className:"dialog-add-feed"},void 0,Mc("header",{className:"dialog-header"},void 0,Mc("h1",{},void 0,(0,Oe.Z)("browser","Add Feed"))),Mc("div",{className:"dialog-content"},void 0,this.feeds()),Mc("footer",{className:"dialog-footer"},void 0,Mc("input",{type:"button",value:(0,Oe.Z)("Add Feed","Add Feeds",[this.state.feeds.length]),className:"primary",onClick:this.addFeed}),this.props.dismissable&&Mc("input",{type:"button",onClick:this.onDismiss,value:(0,Oe.Z)("Cancel")})))}}const Pc=Nc;var Dc;function xc(e,t,n,s){Dc||(Dc="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Dc,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Oc(e){let t=[];return e.forEach((e=>{e.feedurl&&t.push({title:e.plaintitle,url:e.feedurl,path:e.feedurl,supported:e.supported}),e.items.length&&(t=t.concat(Oc(e.items)))})),t}function Lc(e,t){(0,Ke.c)({title:(0,Oe.Z)("Import Feeds (OPML file)"),body:t,tag:"VIVALDI_FEEDS_IMPORT_OPML_FILE"}),c.Z.setStatus(e,t)}class Rc extends hs.PureComponent{static contextType=xi.Z;#h=!1;state={listFeeds:!1,feeds:{}};componentDidMount(){this.#h=!0,this.props.setChooseFile(this.chooseAndParseFile)}componentWillUnmount(){this.#h=!1}chooseAndParseFile=async()=>{const e=this.context.vivaldiWindowId,t=await async function({showOpenFilePicker:e}){const[t]=await e({types:[{accept:{"text/*":[".opml",".txt"]},description:(0,Oe.Z)(".opml and .txt files")}]});return t}(this.context);H.Z.get($.kMailIsTurnedOff)&&(et.Z.info("Mail",["import"],"Mail is turned off - turning it on for importing an OPML file"),Ne.Z.set($.kMailIsTurnedOff,!1),Pn.Z.showContent(e,"PanelFeeds"));const n=await async function(e){const t=await e.getFile();return new Promise(((e,n)=>{const s=new FileReader;s.onloadend=()=>{s.result instanceof ArrayBuffer?e(s.result):n()},s.readAsArrayBuffer(t),s.onerror=e=>{console.error(s.error),n()}}))}(t),s=new Uint8Array(n);let i=new TextDecoder("utf-8").decode(s);const o=i.match(/^\<\?xml\s[^>]*\bencoding\s*=\s*"([^"]*)"[^>]*\?>/);if(o&&o[1]&&!/^\s*utf-8\s*$/i.test(o[1]))try{i=new TextDecoder(o[1]).decode(s)}catch(e){}const a=new DOMParser;try{const t=function(e,t){function n(e,i){for(let o=0;o<e.children.length;o++){const a=e.children[o],r=Gt(a.localName);if(-1!==s.indexOf(a.namespaceURI)&&"outline"===r&&"true"!==$t(jt(a,s,"isComment"),"")){const e=new Bt;if(-1!==["rss","atom"].indexOf($t(jt(a,s,"type"),""))&&(e.feedurl=Vt(jt(a,s,"xmlUrl")),e.feedurl)){e.feedurl=Qt(e.feedurl,a,t),e.created=Vt(jt(a,s,"created")),e.htmldescription=zt(jt(a,s,"description")||"",a,t),e.language=Vt(jt(a,s,"language")),e.pageurl=Vt(jt(a,s,"htmlUrl"))||Vt(jt(a,s,"url")),e.pageurl&&(e.pageurl=Qt(e.pageurl,a,t));const n=$t(jt(a,s,"version"),"");e.supported=!n||/^(rss\d*|atom\s*[\d\.]*)$/i.test(n)}if(Yt(a,s,"category")?e.category=Vt(jt(a,s,"category")):e.category=i?.category??"",a.children.length&&n(a,e),e.feedurl||e.items.length){i.items[i.items.length]=e;const n=Vt(jt(a,s,"text")),o=Vt(jt(a,s,"title"));n&&o&&n!==o?(e.htmltitle=zt(n.length<=o.length?n:o,a,t),e.htmldescription||(e.htmldescription=zt(n.length<=o.length?o:n,a,t))):e.htmltitle=zt(n||o,a,t)||Ut(e.feedurl),e.plaintitle=Ht(e.htmltitle)}}}}const s=[null,"","http://opml.org/spec2"];if("string"!=typeof t)return"FeedURLNotString";if(!e||e.getElementsByTagNameNS(Ft,"parsererror").length)return"NoDocumentNode";if(!e.documentElement)return"NoDocumentElement";if("opml"!==e.documentElement.localName&&"outlineDocument"!==e.documentElement.localName||-1===s.indexOf(e.documentElement.namespaceURI))return"WrongDocumentElement";const i=new Rt;for(let o,a,r=0;r<e.documentElement.children.length;r++)if(o=e.documentElement.children[r],-1!==s.indexOf(e.documentElement.namespaceURI))if(a=Gt(o.localName),"head"===a){for(let e,n,a=0;a<o.children.length;a++)if(e=o.children[a],-1!==s.indexOf(e.namespaceURI))if(n=Gt(e.localName),"title"===n)i.htmltitle=zt(Kt(e),e,t),i.plaintitle=Ht(i.htmltitle);else if("ownername"===n)i.ownername=Vt(Kt(e));else if("owneremail"===n)i.owneremail=Vt(Kt(e));else if("datecreated"===n)i.publishdate=Vt(Kt(e));else if("datemodified"===n)i.updatedate=Vt(Kt(e));else if("ownerid"===n){const n=Vt(Kt(e));n&&(i.ownerurl=Qt(n,e,t))}}else"body"===a&&n(o,i);return i}(a.parseFromString(i,"application/xml"),"http://localhost/");if("string"==typeof t)Lc(e,(0,Oe.Z)("File does not appear to be of OPML format."));else{const n=Oc(t.items),s=n.filter((e=>e.supported));0===s.length?Lc(e,(0,Oe.Z)("No items in this file are supported")):(n.length>s.length?Lc(e,(0,Oe.Z)(n.length-s.length+" items in this file are not supported")):c.Z.clearStatus(e),this.#h&&this.setState({listFeeds:!0,feeds:s}))}}catch(t){throw Lc(e,(0,Oe.Z)("Error parsing file - Not valid XML")),new Error(`Parsing failed: ${t}`)}};render(){return(0,fs.jsx)(fs.Fragment,{children:this.state.listFeeds&&xc(Pc,{onClose:async()=>{},options:this.state.feeds,dismissable:!1})})}}const Bc=Rc;function Fc(e,t,n,s){return e[t]=e[t]||{},e[t][n]=e[t][n]||{current:0,total:0},s&&(e[t][n].children=e[t][n].children||{},e[t][n].children&&(e[t][n].children[s]=e[t][n].children[s]||{current:0,total:0})),e}class Vc extends F.Z{getInitialState(){return{}}reduce(e,t){switch(t.actionType){case"IMPORT_PROGRESS":return(0,V.Uy)(e,(e=>{const{importType:n,importItemType:s,current:i,total:o,key:a}=t;e=Fc(e,n,s,a),a&&e[n][s].children?(e[n][s].children[a].current=i,e[n][s].children[a].total=o):(e[n][s].current=i,e[n][s].total=o)}));case"IMPORT_PROGRESS_WARN":return(0,V.Uy)(e,(e=>{const{importType:n,importItemType:s,message:i}=t;(e=Fc(e,n,s))[n][s].warnings=e[n][s].warnings||[],e[n][s].warnings.push(i)}));case"IMPORT_PROGRESS_ERROR":return(0,V.Uy)(e,(e=>{const{importType:n,importItemType:s,message:i}=t;(e=Fc(e,n,s))[n][s].errors=e[n][s].errors||[],e[n][s].errors.push(i)}));case"IMPORT_PROGRESS_CLEAR":return(0,V.Uy)(e,(e=>{delete e[t.importType]}));default:return e}}getImportProgress(){return this.getState()}numImportsInStore(){return Object.keys(this.getState()).length}isImportTypeInProgress(e){const t=this.getImportProgress();for(const n in t[e]){const s=t[e][n];if(!s.children&&(-1===s.total||s.current<s.total))return!0;if(s.children)for(const e in s.children){const t=s.children[e];if(-1===t.total||t.current<t.total)return!0}}return!1}}const Wc=new Vc;var Uc=n(32593),Hc=n(72010);async function zc(e,t,n){let s=0;for(let i=0;i<n.length;i++){const o=n[i];Fd.Z.setImportProgress(e,t,i+1,n.length),et.Z.log("Mail",["import"],`... importing contact ${++s}/${n.length}`);let r=!1;for(const e of o.emailAddresses){const t=Hc.Z.getContactsWithAddress(e.emailAddress);if(t){for(const e of o.emailAddresses)t.emailAddresses.includes(e.emailAddress)||(t.emailAddresses.push({id:e.id,emailAddress:e.emailAddress,type:e.type}),await a.Z.update(t.id,{name:t.name,birthday:t.birthday,note:t.note,generatedFromSentMail:t.generatedFromSentMail,avatarUrl:t.avatarUrl,separator:t.separator,trusted:t.trusted}));r=!0;break}}r||await a.Z.addContact(o)}et.Z.log("Mail",["import"],`... compared and/or imported ${n.length} contacts`)}var Gc=n(28973);const $c=[["is_read",xe.T4.SEEN],["is_replied",xe.T4.ANSWERED],["is_forwarded",xe.T4.FORWARDED],["is_resent",void 0],["is_outgoing",void 0],["is_sent",void 0],["is_queued",void 0],["is_seen",void 0],["is_timequeued",void 0],["is_deleted",xe.T4.DELETED],["has_attachment",void 0],["has_image_attachment",void 0],["has_audio_attachment",void 0],["has_video_attachment",void 0],["has_zip_attachment",void 0],["is_onepart_message",void 0],["currently unused bit",void 0],["is_waiting_for_indexing",void 0],["is_newsfeed_message",void 0],["partially_fetched",void 0],["is_news_message",void 0],["allow_8bit",void 0],["is_imported",void 0],["has_priority",void 0],["has_priority_low",void 0],["has_priority_max",void 0],["is_control_message",void 0],["allow_quotestring_qp",void 0],["has_keywords",void 0],["permanently_removed",void 0],["dir_forced_ltr",void 0],["dir_forced_rtl",void 0]];var Kc=n(16445),jc=n(40348),Yc=n(93986);function Xc(e,t,n,s,i){Fd.Z.setImportProgress(e,t,n,s,i)}async function Qc(e){const{path:t}=e;await Re.Z.importProgress.get(t)?await Re.Z.importProgress.update(t,e):await Re.Z.importProgress.add(e)}async function qc(e){const t=await async function(e){const t=(0,Uc.NQ)(e,"accounts.ini");try{const n=await C.Z.mailPrivate.readFileToText(t);if(n)return n;et.Z.log("Mail",["import"],`accounts.ini file not found in Opera Mail path: ${e}`)}catch(t){et.Z.log("Mail",["import"],`Failed to read accounts.ini file for Opera Mail path: ${e} - Error: ${t.message||t}`)}}(e);return t?function(e){const t={section:/^\[(Account(s)?[0-9]+)\]$/,param:/^([^=]+?)\s*=\s*(.*?)$/,comment:/^[;#].*$/},n=new Map,s=e.split(/[\r\n]+/);let i=null;return s.forEach((e=>{const s=e.trim();if(!t.comment.test(s))if(t.param.test(s)){const e=s.split("=",2),t=e[0].toLowerCase().replace(/\s+/g,"_"),o=isNaN(e[1])?e[1]:Number(e[1]);if(i){const e={...n.get(i),[t]:o};n.set(i,e)}else n.set(t,o)}else t.section.test(s)?(i=s.substr(1,s.length-2).toLowerCase(),n.set(i,{})):0===e.length&&i?i=null:et.Z.log("Mail",["parsing","accounts"],"ignored line:",s)})),et.Z.log("Mail",["parsing","accounts"],"parseMap:",n),(0,Gc.Z)(n).filter((([,e])=>e.account_name)).map((([e,t])=>(t.email||et.Z.warn("Mail",["parsing","accounts"],`Account in section ${e} has no email address. Protocol: ${t.incoming_protocol}`),{section:e,MAIL_EMAIL:t.email||"",MAIL_PORT:t.incoming_port,MAIL_SERVER:t.incoming_servername||"",MAIL_USER:t.incoming_username||"",MAIL_SMTP_SERVER:t.outgoing_servername||"",MAIL_SMTP_PORT:t.outgoing_port,MAIL_SMTP_SOCKET_TYPE:587===t.outgoing_port?"starttls":"ssl",MAIL_SMTP_USER:t.outgoing_username||"",accountType:t.incoming_protocol,offline:!0,MAIL_PASSWORD:"",MAIL_SMTP_PASSWORD:"",preFetch:!!t.download_bodies})))}(t):[]}async function Jc(e,t,n,i,o){H.Z.get($.kMailIsTurnedOff)&&(et.Z.log("Mail",["import"],"Mail is turned off - turning it on for importing from m2"),Ne.Z.set($.kMailIsTurnedOff,!1),Pn.Z.showContent(e,"PanelMail")),t&&"/"!==t[t.length-1]&&(t+="/");const a=await async function(e,t,n){et.Z.log("Mail",["import"],"importing accounts from",e);const s=mn.Z.getAccounts(),i=(await qc(e)).filter((e=>n.find((t=>t.accountId===e.MAIL_EMAIL&&t.accountType===e.accountType)))),o=new Map;for(let e=0;e<i.length;e++){const n=i[e];Xc(t,"MailAccounts",e+1,i.length);try{if(![xe.s9.IMAP,xe.s9.POP].includes(n.accountType.toUpperCase())){console.warn(`Importing accounts of type "${n.accountType}" is not supported`),Fd.Z.addImportWarning(t,"MailAccounts",(0,Oe.Z)(`Importing accounts of type "${n.accountType}" is not supported`));continue}if(o.set(n.section,n.MAIL_EMAIL),s[n.MAIL_EMAIL])continue;if(n.accountType===xe.s9.POP&&i.find((e=>e.MAIL_EMAIL===n.MAIL_EMAIL&&e.accountType===xe.s9.IMAP)))continue;const e=(0,Oi.Z)(n,"section"),a=(0,Uc.Gb)();await Se.Z.addAccount(e),(0,Yc.ZP)(e),await a,et.Z.log("Mail",["import"],"... imported account",n.MAIL_EMAIL)}catch(e){Fd.Z.addImportError(t,"MailAccounts",(0,Oe.Z)("Failed importing account $1",[n.MAIL_EMAIL])),console.error(`Failed importing account ${JSON.stringify(n)}`)}}return o}(n,i,o);await async function(e,t){et.Z.log("Mail",["import"],"importing contacts from",e);const n=await async function(e){const t=(0,Uc.NQ)(e,"contacts.adr"),n=await C.Z.mailPrivate.readFileToText(t);n||(s.Z.runtime.lastError?console.error(s.Z.runtime.lastError):console.warn(`contacts.adr file not found in Opera profile path: ${e}`));return n}(e);if(!n)return Fd.Z.addImportWarning(t,"MailContacts",(0,Oe.Z)("No contacts found in $1",e)),void et.Z.log("Mail",["import"],"... no contacts found in",e);const i=function(e){const t=e.split("#FOLDER")[0].split("#CONTACT");t.shift();const n=t.map((e=>e.replace(/\t/g,""))).map((e=>e.split(/[\r\n]+/g))).map((e=>{const t={};return e.forEach((e=>{const n=e.trim(),s=n.split("=")[0].toLowerCase(),i=n.split("=")[1];s.length&&(t[s]=i)})),t}));return et.Z.log("Mail",["parsing","contacts"],"parsed:",n),n.map(((e,t)=>{const{mail:n="",postaladdress:s="",phone:i="",fax:o=""}=e,a=String.fromCharCode(2)+String.fromCharCode(2),r=n.split(a),l=s.split(a),d=r.map(((e,t)=>({emailAddress:e,id:String(t),type:""}))),c=l.map(((e,t)=>({postalAddress:e,id:String(t),type:""})));let h=0;const p=[];return i&&p.push({phoneNumber:i,id:String(h++),type:""}),o&&p.push({phoneNumber:o,id:String(h++),type:"work"}),{avatarUrl:"",birthday:0,emailAddresses:d,generatedFromSentMail:!1,id:String(t),name:e.name,note:e.description,phoneNumbers:p,postalAddresses:c,separator:!1,trusted:!0}}))}(n);await zc(t,"MailContacts",i)}(t,i),await async function(e,t,n,s){et.Z.log("Mail",["import"],"importing messages from",n);let i=0;for(const o of t){const[t,a]=o,r=(0,Uc.NQ)(n,"store",t),l=await C.Z.mailPrivate.getFilePaths(r);i+=l.length,l.sort(),et.Z.log("Mail",["import"],`... found ${l.length} messages to import for account ${a}`),await sh(r,n,l,(async(t,n,i,o)=>{await nh(e,a,t,s,n,i,o)})),et.Z.log("Mail",["import"],"... finished importing messages for account",a),await Qc({path:r,currentIndex:0})}et.Z.log("Mail",["import"],"... finished importing",i,"messages"),c.Z.setStatus(e,(0,Oe.Z)("Finished importing $1 message.","Finished importing $1 messages.",[i]),xe.QM)}(e,a,n,i)}let eh=0,th=0;async function nh(e,t,n,s,i,o,a){et.Z.log("Mail",["import"],`... importing ${a}/${o}`);const r=Date.now(),l={};for(let e=0;e<i.length;e++){const n=i[e],r=await(0,jc.Z)(n);await oh(t,r,l,n),Xc(s,"MailMessages",a+e+1,o,t)}try{await async function(e){for(const t in e)for(const n in e[t]){const{messages:s}=e[t][n];await(0,Uc.m6)(t,n,s)}Ge.Z.filter(),Se.Z.updateThreads()}(l)}catch(e){Fd.Z.addImportError(s,"MailMessages",(0,Oe.Z)("Failed importing messages. Error: $1",[e.message||e])),console.error(e)}const d=Date.now();eh+=(d-r)/1e3,th+=i.length;const h=th/eh;c.Z.setStatus(e,(0,Oe.Z)("Importing: $1/$2. Batch size: $3. Rate: $4/s",[a,o,i.length,h.toFixed(1)]))}async function sh(e,t,n,s){const i=Le.Z.adjustBatchSize.bind(void 0,25,1e3,500);let o=25;let a=(await Re.Z.importProgress.get(e))?.currentIndex||0;return new Promise(((r,l)=>{!async function d(){const c=n.slice(a,a+o);if(0===c.length)return void r();const h=Date.now();try{await s(t,c,n.length,a),a+=c.length,await Qc({path:e,currentIndex:a})}catch(e){return void l(e)}const p=Date.now();o=i(o,p-h),d()}()}))}function ih(e,t,n,s){s[e]||(s[e]={}),s[e][t]||(s[e][t]={messages:[]}),s[e][t].messages.push(n)}async function oh(e,t,n,s){const i=(0,Kc.Z)(t);let o,a=!1,r=!1;if(i.received){const e=i.received.match(/\bfor\s<(.+@.+\..+)>/);e&&(o=e[1])}if(e&&o&&e===o)a=!0;else if(e){i.from.map((e=>e.address)).includes(e)&&(r=!0);i.to.map((e=>e.address)).includes(e)&&(a=!0);i.cc.map((e=>e.address)).includes(e)&&(a=!0)}const l=i.operaStatus?function(e){const t={mappedFlags:[],otherFlags:[]},n=e.substring(34,42);if(!/^[A-Fa-f0-9]{8}$/.test(n))return console.error("invalid flags hex value"),t;const s=parseInt(n,16);for(let e=0;e<$c.length;e++){const n=$c[e],i=s&Math.pow(2,e);i&&n[1]?t.mappedFlags.push(n[1]):i&&t.otherFlags.push(n[0])}return t}(i.operaStatus):{mappedFlags:[],otherFlags:[]};let d;if(i.operaLocation){const e=i.operaLocation.match(/^([^\s:]+):(\d+)$/);e&&(d=e[1],"inbox"===d.toLowerCase()&&(d=xe.Gf))}else l.otherFlags.includes("is_sent")&&(d=xe.N1);const c=await(0,Uc.jm)(i,l.mappedFlags,t);if(e)(a||!a&&!r)&&(await(0,Uc.oN)(e,d||xe.Gf),await(0,Uc.KJ)(e,d||xe.Gf),ih(e,d||xe.Gf,c,n)),r&&(await(0,Uc.oN)(e,d||xe.N1),await(0,Uc.KJ)(e,d||xe.N1),ih(e,d||xe.N1,c,n));else{s.match(/\/store\/drafts\//i)?ih(xe.of,xe.Wb,c,n):console.error("Found no fitting folder for message:",s,i.operaLocation)}}function ah(e,t){if(!e.aliases)return t;if(!t.aliases){return{...t,aliases:e.aliases}}const n=[...t.aliases];for(const s of e.aliases)t.aliases.find((e=>e.MAIL_EMAIL===s.MAIL_EMAIL))||n.push(s);return{...t,aliases:n}}const rh=[["read",xe.T4.SEEN],["replied",xe.T4.ANSWERED],["marked",void 0],["expunged",xe.T4.DELETED],["has_re",void 0],["elided",void 0],["unused",void 0],["offline",void 0],["watched",void 0],["sender_authed",void 0],["partial",void 0],["queued",void 0],["forwarded",xe.T4.FORWARDED],["priorities",void 0]];function lh(e){const t={mappedFlags:[],otherFlags:[]},n=e;if(!/^[A-Fa-f0-9]{4}$/.test(n))return console.error("invalid flags hex value"),t;const s=parseInt(n,16);for(let e=0;e<rh.length;e++){const n=rh[e],i=s&Math.pow(2,e);i&&n[1]?t.mappedFlags.push(n[1]):i&&t.otherFlags.push(n[0])}return t}var dh,ch=n(3664);async function hh(e){const{path:t}=e;await Re.Z.importProgress.get(t)?await Re.Z.importProgress.update(t,e):await Re.Z.importProgress.add(e)}async function ph(e){return new Promise(((t,n)=>{C.Z.mailPrivate.readFileToText(e,(n=>s.Z.runtime.lastError?(et.Z.warn("Mail",["import","thunderbird"],`Error reading file ${e}`,s.Z.runtime.lastError),t("")):n?void t(n):(et.Z.warn("Mail",["import","thunderbird"],`File ${e} is empty`),t(""))))}))}async function uh(){const e=(await new Promise((e=>{C.Z.importData.getProfiles((t=>{e(t)}))}))).find((e=>"Thunderbird"===e.name));return e?e.profilePath+"/":""}async function gh(){const e=await uh(),t=await async function(e){const t=e+"profiles.ini";return function(e){const t={profile:/^\[(Profile[0-9]+)\]$/,name:/^Name\s*=\s*(.*?)$/,path:/^Path\s*=\s*(.*?)$/,isRelative:/^IsRelative\s*=\s*(0|1)$/,default:/^Default\s*=\s*(0|1)$/},n={},s=e.split(/[\r\n]+/);let i;for(const e of s){const s=e.trim();let o=t.profile.exec(s);o?(i=o[1],n[i]={name:"",path:"",isRelative:!1}):(o=t.name.exec(s),o&&i?n[i].name=o[1]:(o=t.path.exec(s),o&&i?n[i].path=o[1]:(o=t.isRelative.exec(s),o&&i?n[i].isRelative="1"===o[1]:(o=t.default.exec(s),o&&i&&(n[i].default="1"===o[1])))))}return n}(await ph(t))}(e),n=[];for(const s in t){const i=t[s];n.push({prefsFilePath:e+i.path+"/prefs.js",profilePath:e+i.path})}return n}async function mh(e){return new Promise((t=>{C.Z.mailPrivate.getFilePaths(e+"/",t)}))}async function vh(e){return function(e){const t={account:/^user_pref\("mail\.account\.(account[0-9]+)\.(.+)", "(.+)"\);$/,identidy:/^user_pref\("mail\.identity\.(id[0-9]+)\.(.+)", "?([^"]+)"?\);$/,server:/^user_pref\("mail\.server\.(server[0-9]+)\.(.+)", "(.+)"\);$/,smtp:/^user_pref\("mail\.smtpserver\.(smtp[0-9]+)\.(.+)", "(.+)"\);$/},n={},s=e.split(/[\r\n]+/),i=[];for(const e of s){const s=e.trim(),o=t.account.exec(s)||t.identidy.exec(s)||t.server.exec(s)||t.smtp.exec(s);o&&(n[o[1]]=n[o[1]]||{},n[o[1]][o[2]]=o[3],o[1].startsWith("account")&&i.push(o[1]))}const o={serverFolders:{},localFolders:""};for(const e of i){const{server:t,identities:s}=n[e];if(t&&s){let e;if("POP3"===n[t].type.toUpperCase())e=xe.s9.POP;else{if("IMAP"!==n[t].type.toUpperCase()){et.Z.warn("Mail",["import","thunderbird"],`Importing accounts of type "${n[t].type}" is not supported`),e=xe.s9.IMAP;continue}e=xe.s9.IMAP}const i=s.split(",").map((e=>e.trim())),a=i.filter((e=>"true"===n[e].valid));if(0===a.length){et.Z.info("Mail",["import","thunderbird"],"No valid accounts found in prefs.js file");continue}const r=a[0],l=n[r].smtpServer,d={MAIL_EMAIL:n[r].useremail,MAIL_NAME:n[r].fullName,MAIL_SERVER:n[t].hostname,MAIL_PORT:e===xe.s9.IMAP?993:995,MAIL_USER:n[t].userName,MAIL_SMTP_SERVER:l?n[l].hostname:"",MAIL_SMTP_PORT:465,MAIL_SMTP_SOCKET_TYPE:"ssl",MAIL_SMTP_USER:l?n[l].username:"",offline:!0,accountType:e,useOAuth:n[t].hasOwnProperty("oauth2.issuer")&&n[t]["oauth2.issuer"].endsWith(".google.com")};if(n[r].htmlSigText&&(d.signature=n[r].htmlSigText),a.length>1){const e=a.slice(1);for(const t of e){const{useremail:e,fullName:s,htmlSigText:i}=n[t],o={MAIL_EMAIL:e};s&&(o.MAIL_NAME=s),i&&(o.signature=i),d.aliases?d.aliases.push(o):d.aliases=[o]}}const c=n[t].directory;o.serverFolders[c]=d}else t&&(o.localFolders=n[t].directory)}return o}(await ph(e))}async function fh(e){const t=e||await gh(),n=[];for(const e of t){const{serverFolders:t}=await vh(e.prefsFilePath);for(const s in t)n.push({mailAccount:t[s],profilePath:e.profilePath})}return n}function yh(e){const t=[];for(const n of e)/\.(?:html|msf|dat)$/.test(n)||t.push(n);return t}function Ch(e){let t="";const n=e.match(/[\\\/]([^\\\/]+)$/);if(n)return t=n[1],/inbox-[0-9]+/i.test(t)&&(t=t.slice(0,"inbox".length)),/sent-[0-9]+/i.test(t)&&(t=t.slice(0,"sent".length)),/outbox-[0-9]+/i.test(t)&&(t=t.slice(0,"outbox".length)),/trash-[0-9]+/i.test(t)&&(t=t.slice(0,"trash".length)),/junk-[0-9]+/i.test(t)&&(t=t.slice(0,"junk".length)),/spam-[0-9]+/i.test(t)&&(t=t.slice(0,"spam".length)),/drafts-[0-9]+/i.test(t)&&(t=t.slice(0,"drafts".length)),/archive-[0-9]+/i.test(t)&&(t=t.slice(0,"archive".length)),t;et.Z.warn("Mail",["import","thunderbird"],`No mbox file found in path ${e}`)}async function wh(e,t){return new Promise((n=>{C.Z.importData.openThunderbirdMailbox(e,String(t),(e=>{n(Number(e))}))}))}async function bh(e,t){H.Z.get($.kMailIsTurnedOff)&&(et.Z.log("Mail",["import","thunderbird"],"Mail is turned off - turning it on for importing from Thunderbird"),Ne.Z.set($.kMailIsTurnedOff,!1),Pn.Z.showContent(e,"PanelMail"));const n=await gh();await async function(e,t){const n=(await fh(e)).map((e=>e.mailAccount)),s=H.Z.get($.kMailAccounts),i=n.filter((e=>t.find((t=>t.accountId===e.MAIL_EMAIL&&t.accountType===e.accountType))));for(const e of s){const t=i.find((t=>t.MAIL_EMAIL===e.MAIL_EMAIL));if(t)try{(0,Yc.ZP)(ah(t,e))}catch(n){Fd.Z.addImportError("Thunderbird","MailAccounts",(0,Oe.Z)("Failed updating account $1",[e.MAIL_EMAIL])),et.Z.error("Mail",["import","thunderbird"],`Failed adding alias from ${JSON.stringify(t)}`)}}const o=i.filter((e=>!s.find((t=>t.MAIL_EMAIL===e.MAIL_EMAIL))));for(let e=0;e<o.length;e++){let t=o[e];if(t.accountType===xe.s9.IMAP){const e=o.find((e=>e.MAIL_EMAIL===t.MAIL_EMAIL&&e.accountType===xe.s9.POP));if(e)try{t=ah(e,t)}catch(n){Fd.Z.addImportError("Thunderbird","MailAccounts",(0,Oe.Z)("Failed updating account $1",[t.MAIL_EMAIL])),et.Z.error("Mail",["import","thunderbird"],`Failed adding alias from ${JSON.stringify(e)}`)}}else if(t.accountType===xe.s9.POP&&o.find((e=>e.MAIL_EMAIL===t.MAIL_EMAIL&&e.accountType===xe.s9.IMAP)))continue;try{const e=(0,Uc.Gb)();await Se.Z.addAccount(t),(0,Yc.ZP)(t),await e,et.Z.log("Mail",["import","thunderbird"],"... imported account",t.MAIL_EMAIL),Fd.Z.setImportProgress("Thunderbird","MailAccounts",1,1,t.MAIL_EMAIL)}catch(e){Fd.Z.addImportError("Thunderbird","MailAccounts",(0,Oe.Z)("Failed importing account $1",[t.MAIL_EMAIL])),et.Z.error("Mail",["import","thunderbird"],`Failed importing account ${JSON.stringify(t)}`)}}}(n,t);const s=[];for(const e of n){const{serverFolders:n,localFolders:i}=await vh(e.prefsFilePath);for(const e in n){et.Z.log("Mail",["import","thunderbird"],"messageFolder",e);const i=n[e].MAIL_EMAIL;if(!t.find((e=>e.accountId===i)))continue;const o=await mh(e),a=yh(o);0===a.length&&et.Z.log("Mail",["import","thunderbird"],"No thunderbird mbox files found in",o);for(const e of a){let t=Ch(e);if(t){const n=e.match(/[\\\/]([^\\\/]+)\.sbd[\\\/]/);n&&(t=n[1]+"/"+t),s.push({filePath:e,accountId:i,path:t})}}}if(i){const e=await mh(i);0===e.length&&et.Z.log("Mail",["import","thunderbird"],"No thunderbird mbox files found in",e);const t=yh(e);for(const e of t){let t=Ch(e);t&&("Unsent Messages"===t&&(t=xe.J8),s.push({filePath:e,accountId:xe.of,path:t}))}}}for(const t of s){const{filePath:n,accountId:s}=t;let i=t.path;"inbox"===i.toLowerCase()&&(i=xe.Gf);const o=(await Re.Z.importProgress.get(n))?.seekPosition||0,a=await wh(n,o);if(a<-1&&et.Z.warn("Mail",["import","thunderbird"],`filesize overflow for ${n}`),0===o)try{const{message:e}=await Sh();if(!e){et.Z.warn("Mail",["import","thunderbird"],`File does not contain messages ${n}`),C.Z.importData.closeThunderbirdMailbox();continue}await wh(n,o)}catch(e){et.Z.warn("Mail",["import","thunderbird"],`Error on checking file validity ${n}. Error: ${e}`),C.Z.importData.closeThunderbirdMailbox();continue}s!==xe.of&&(await(0,Uc.oN)(s,i),await(0,Uc.KJ)(s,i)),Fd.Z.setImportProgress("Thunderbird","MailMessages",0,-1,s+"/"+i),await Ih(e,n,s,i,o,a),await hh({path:n,seekPosition:0}),C.Z.importData.closeThunderbirdMailbox()}}async function Sh(){return new Promise(((e,t)=>{try{C.Z.importData.readMessageFromThunderbirdMailbox(((n,i)=>s.Z.runtime.lastError?(et.Z.warn("Mail",["import","thunderbird"],"Error reading message",s.Z.runtime.lastError),t(s.Z.runtime.lastError)):e({message:n,seekPosition:Number(i)})))}catch(e){return et.Z.warn("Mail",["import","thunderbird"],"Error reading message",s.Z.runtime.lastError),t(e)}}))}async function Ih(e,t,n,s,i,o){async function a(){const{message:e,seekPosition:n}=await Sh();if(i>-1&&-1===n&&await hh({path:t,seekPosition:i}),i=n,e.length>0){return(0,ch.sy)(e)}}async function r(o,a,r,l){-1===r&&(r=l),await async function(e,t,n){const s=[];for(const t of e){const e=(0,Kc.Z)(t),n=e.mozillaStatus?lh(e.mozillaStatus):{mappedFlags:[],otherFlags:[]},i=await(0,Uc.jm)(e,n.mappedFlags,t);s.push(i)}await(0,Uc.m6)(t,n,s)}(o,n,s);const d=Math.floor(r/1048576),h=Math.floor(l/1048576);c.Z.setStatus(e,`${n}/${s}: ${d}/${h} MB (${a} messages)`,5e3),Fd.Z.setImportProgress("Thunderbird","MailMessages",d,h,n+"/"+s),i>-1&&await hh({path:t,seekPosition:i})}try{let e,l=[],d=0,c=40,h=Date.now();const p=new Le.Z.BatchSizeOptimizer(c,1e3);do{if(e=await a(),e){if(l.push(e),l.length===c){d+=c,await r(l,d,i,o),l=[];const e=Date.now();c=p.optimize(c,e-h),h=Date.now()}}else{if(i>-1&&0===d){et.Z.warn("Mail",["import","thunderbird"],"File is not an mbox file",t,i);break}i>-1&&et.Z.warn("Mail",["import","thunderbird"],"Got an empty message",t,i)}}while(i>-1);l.length>0&&(d+=l.length,await r(l,d,i,o)),0===d&&Fd.Z.setImportProgress("Thunderbird","MailMessages",0,0,n+"/"+s)}catch(e){et.Z.error("Mail",["import","thunderbird"],e),Fd.Z.addImportError("Thunderbird","MailMessages",(0,Oe.Z)("Failed importing messages. Error: $1",[e.message||e]))}}function kh(e,t,n,s){dh||(dh="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:dh,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var Ah=kh("br",{}),Th=kh("br",{});class Zh extends hs.PureComponent{static contextType=xi.Z;#h=!1;refUserProfile=hs.createRef();constructor(e){super(e),this.state={useDefaultLocation:!0,importOptions:JSON.parse(JSON.stringify(e.profile)),selectedProfile:"",masterPassword:"",importItemStatus:(0,te.aV)(),accountSelection:[],selectedFolder:"",selectedFile:""}}componentDidMount(){this.#h=!0,C.Z.importData.onImportItemStarted.addListener(this.onImportItemStarted),C.Z.importData.onImportItemEnded.addListener(this.onImportItemEnded),C.Z.importData.onImportItemFailed.addListener(this.onImportItemFailed),this.offerAccountSelection(this.props.profile.mailPath),this.props.setStartImport(this.startImport),this.props.setChooseFile(this.chooseFile)}componentWillUnmount(){this.#h=!1,C.Z.importData.onImportItemStarted.removeListener(this.onImportItemStarted),C.Z.importData.onImportItemEnded.removeListener(this.onImportItemEnded),C.Z.importData.onImportItemFailed.removeListener(this.onImportItemFailed)}componentDidUpdate(e){e.profile!==this.props.profile&&this.setState({importOptions:JSON.parse(JSON.stringify(this.props.profile))},(()=>{this.offerAccountSelection(this.props.profile.mailPath||(0,Uc.NQ)(this.state.selectedFolder,"mail"))}))}async offerAccountSelection(e){if(this.props.profile.email||this.props.profile.contacts){const t=(e,t)=>e.MAIL_EMAIL>t.MAIL_EMAIL?1:-1;if("Thunderbird"===this.props.profile.name){const e=(await fh()).sort(((e,t)=>e.mailAccount.MAIL_EMAIL>t.mailAccount.MAIL_EMAIL?1:-1)).map((e=>({accountId:e.mailAccount.MAIL_EMAIL,accountType:e.mailAccount.accountType,selected:!0,profilePath:e.profilePath})));this.#h&&this.setState({accountSelection:e,selectedProfile:[...new Set(e.map((({profilePath:e})=>e)))].join(";")})}else/^[OÓ]pera/i.test(this.props.profile.name)?qc(e).then((e=>{const n=e.sort(t).filter((e=>e.MAIL_EMAIL&&[xe.s9.IMAP,xe.s9.POP].includes(e.accountType)));0===n.length?this._changeSelection("email"):this._setSelection("email",!0);const s=n.map((e=>({accountId:e.MAIL_EMAIL,accountType:e.accountType,selected:!0,profilePath:""})));this.#h&&this.setState({accountSelection:s})})):et.Z.warn("Mail",["import"],"Mail import not supported from profile",this.props.profile.name)}}onImportItemStarted=e=>{Fd.Z.setImportProgress(this.props.profile.name,e,0,0),this.setItemState(e,"IMPORT_STARTED")};onImportItemEnded=e=>{Fd.Z.setImportProgress(this.props.profile.name,e,0,0),this.setItemState(e,"IMPORT_COMPLETED")};onImportItemFailed=(e,t)=>{Fd.Z.addImportError(this.props.profile.name,e,t),this.setItemState(e,"IMPORT_FAILED",t)};setItemState(e,t,n){this.#h&&this.setState((s=>{let i=s.importItemStatus;const o=i.filter((t=>t.itemName===e)).first(),a={itemName:e,state:t,errorMsg:n};return i=o?i.map((t=>t.itemName===e?"IMPORT_FAILED"===t.state?t:{...a}:t)):i.push(a),{importItemStatus:i}}))}onStartImport=()=>{this.startImport()};startImport=async()=>{if(Wc.isImportTypeInProgress(this.props.profile.name))return void(0,Ke.c)({title:(0,Oe.Z)("Import for this profile is currently running"),tag:"VIVALDI_IMPORT_CURRENTLY_RUNNING"});const e=this.state.importOptions,t=e.history,n=e.favorites,s=e.passwords,i=e.notes,o=e.speeddial,a=e.email,r=e.contacts,l=e.hasDefaultInstall&&this.state.useDefaultLocation,d=""===this.state.selectedProfile?this.refUserProfile.current?.value??"":this.state.selectedProfile,c={history:t,favorites:n,passwords:s,notes:i,speeddial:o};let h=e.profilePath,p=e.mailPath;e.hasDefaultInstall&&this.state.useDefaultLocation||(h=this.state.selectedFolder||this.state.selectedFile,p=(0,Uc.NQ)(h,"mail")),h?(h.endsWith("operaprefs.ini")&&(h=h.substring(0,h.indexOf("operaprefs.ini"))),C.Z.importData.startImport(this.props.index,l,d,c,this.state.masterPassword,h,(()=>{if(a){const t=this.state.accountSelection.filter((e=>e.selected));if(this.setItemState("email","IMPORT_STARTED"),/^[OÓ]pera/.test(e.name))Jc(this.context.vivaldiWindowId,h,p,this.props.profile.name,t).then((()=>{this.setItemState("email","IMPORT_COMPLETED")}));else{if("Thunderbird"!==e.name)throw new Error("Unsupported mail client");bh(this.context.vivaldiWindowId,t).then((()=>{this.setItemState("email","IMPORT_COMPLETED")}))}}r&&async function(e,t){const n=(await C.Z.contacts.readThunderbirdContacts(t)).map((e=>{const t=e.emailAddresses.map((e=>{const{favorite:t,...n}=e;return{...n,emailAddress:n.emailAddress??"",isDefault:!1,type:n.type??""}})),n=e.postalAddresses.map((e=>({...e,postalAddress:e.postalAddress??"",type:e.type??""}))),s=e.phoneNumbers.map((e=>({...e,phoneNumber:e.phoneNumber??"",type:e.type??""})));return{...e,name:e.name??"",emailAddresses:t,postalAddresses:n,phoneNumbers:s}}));await zc(e,(0,Oe.Z)("Thunderbird Contacts"),n)}(h,d)}))):(0,Ke.c)({title:(0,Oe.Z)("Import source not specified!"),tag:"VIVALDI_IMPORT_SOURCE_NOT_SPECIFIED"})};openFolder=async()=>new Promise(((e,t)=>{this.context.chrome.fileSystem.chooseEntry({type:"openDirectory"},(n=>{s.Z.runtime.lastError||!n?t(s.Z.runtime.lastError||"Cancelled opening folder"):e(n)}))}));chooseFile=async()=>{const e=await async function(e,t){const{chrome:n}=e;return new Promise(((e,s)=>{n.fileSystem.chooseEntry({type:"openFile",accepts:[{mimeTypes:["text/*"],extensions:t,description:(0,Oe.Z)("files of type $1",[t])}]},(t=>{n.runtime.lastError||!t?s(n.runtime.lastError||"Cancelled opening file"):e(t)}))}))}(this.context,["html"]),t=await C.Z.mailPrivate.getFullPath(e.filesystem.name,e.fullPath);this.setState({selectedFile:t},this.startImport)};chooseFolder=async()=>{const e=await this.openFolder(),t=await C.Z.mailPrivate.getFullPath(e.filesystem.name,e.fullPath);this.setState({selectedFolder:t},(()=>this.offerAccountSelection((0,Uc.NQ)(t,"mail"))))};handlePasswordChange=e=>{const{HTMLInputElement:t}=this.context;e.target instanceof t&&this.setState({masterPassword:e.target.value.toString()})};handleUserProfileChange=e=>{const{HTMLSelectElement:t}=this.context;e.target instanceof t&&this.setState({selectedProfile:e.target.value})};_toggleDefault(){this.setState((e=>({useDefaultLocation:!e.useDefaultLocation})),(()=>{this.state.useDefaultLocation?this.offerAccountSelection(this.props.profile.mailPath):this.offerAccountSelection((0,Uc.NQ)(this.state.selectedFolder,"mail"))}))}_changeSelection(e){this.setState((t=>{const n={...t.importOptions},s=t.accountSelection.slice();if("email"===e){const t=s.filter((e=>e.selected));n[e]||0!==t.length?n[e]&&s.forEach((e=>e.selected=!1)):n.profilePath||n.mailPath?s.forEach((e=>e.selected=!0)):this.chooseFolder()}return n[e]=!n[e],{accountSelection:s,importOptions:n}}))}_setSelection(e,t){this.setState((n=>{const s={...n.importOptions};return s[e]=t,{importOptions:s}}))}_getImportItemMarkup(e,t,n,s,i){return kh("div",{className:"setting-single"},void 0,kh("div",{className:"import-setting"},void 0,kh("input",{id:t,type:"checkbox",checked:s,onChange:this._changeSelection.bind(this,e),disabled:i}),kh("label",{htmlFor:t},void 0,n)))}_onAccountSelection=e=>{this.setState((t=>{const n={...t.importOptions},s=t.accountSelection.filter((e=>e.selected));return 1===s.length&&!0===e.selected?n.email=!1:0===s.length&&!1===e.selected&&(n.email=!0),{importOptions:n,accountSelection:t.accountSelection.map((t=>(t.accountId===e.accountId&&t.accountType===e.accountType&&(t.selected=!t.selected),t)))}}))};render(){const e=this.props.profile,t=this.state.importOptions;if(t){const n=Boolean(!(t.passwords||t.history||t.notes||t.speeddial||t.email||t.contacts));let s;return e&&e.UserProfiles&&e.UserProfiles.length>0&&(s=e.UserProfiles.map((e=>kh("option",{value:e.profileName},e.profileName,e.profileDisplayName)))),(0,fs.jsxs)(fs.Fragment,{children:[kh("fieldset",{},void 0,s&&kh("div",{className:"profile"},void 0,kh("label",{htmlFor:"userProfile"},void 0,(0,Oe.Z)("Chrome User Profile")),(0,fs.jsx)("select",{ref:this.refUserProfile,id:"userProfile",onChange:this.handleUserProfileChange,value:this.state.selectedProfile,children:s})),e&&e.favorites&&this._getImportItemMarkup("favorites","f-favorites",(0,Oe.Z)("Bookmarks"),!!t&&t.favorites,n),e.passwords&&this._getImportItemMarkup("passwords","f-passwords",(0,Oe.Z)("Passwords"),!!t&&t.passwords,!1),e.supportsMasterPassword&&kh("div",{className:"setting-single import-masterpassword"},void 0,kh("label",{htmlFor:"f-masterpassword"},void 0,(0,Oe.Z)("Master password, if needed:")),kh("input",{id:"f_masterpassword",type:"password",onChange:this.handlePasswordChange})),e.history&&this._getImportItemMarkup("history","f-history",(0,Oe.Z)("History"),!!t&&t.history,!1),e.notes&&this._getImportItemMarkup("notes","f-notes",(0,Oe.Z)("Notes"),!!t&&t.notes,!1),e.speeddial&&this._getImportItemMarkup("speeddial","f-speeddial",(0,Oe.Z)("Speed Dial"),!!t&&t.speeddial,!1),e.email&&this._getImportItemMarkup("email","f-email",(0,Oe.Z)("Mail"),!!t&&t.email,!1),e.email&&kh("div",{className:"import-mail-account"},void 0,this.state.accountSelection.map((e=>{const{accountId:t,accountType:n,selected:s}=e;return kh("div",{className:"imported-email"},t+n,kh("input",{id:t+n,type:"checkbox",checked:s,onChange:()=>this._onAccountSelection(e)}),kh("label",{htmlFor:t+n},void 0,t," ",n))}))),e.contacts&&this._getImportItemMarkup("contacts","f-contacts",(0,Oe.Z)("Contacts"),!!t&&t.contacts,!1),e&&e.supportsStandaloneImport&&e.hasDefaultInstall&&kh("div",{className:"setting-single"},void 0,kh("input",{id:"f-location",type:"checkbox",checked:this.state.useDefaultLocation&&e.hasDefaultInstall,onChange:this._toggleDefault.bind(this),disabled:!1===e.hasDefaultInstall}),kh("label",{htmlFor:"f-location"},void 0,(0,Oe.Z)("Use Default Profile Location")))),e&&e.hasDefaultInstall&&this.state.useDefaultLocation&&e.profilePath.length>0&&kh("div",{className:"import-pathname"},void 0,(0,Oe.Z)("Detected Profile Path:"),Ah,kh("input",{type:"text",value:e.profilePath,readOnly:!0})),e?.supportsStandaloneImport&&(!e?.hasDefaultInstall||!this.state.useDefaultLocation)&&(0,fs.jsxs)(fs.Fragment,{children:[kh("div",{className:"import-pathname"},void 0,(0,Oe.Z)("Selected Profile Path:"),Th,kh("input",{type:"text",value:this.state.selectedFolder||(0,Oe.Z)("No folder selected"),readOnly:!0})),kh("div",{},void 0,kh("input",{type:"button",className:"primary",onClick:this.chooseFolder,value:(0,Oe.Z)("Choose a Folder...")}))]})]})}return null}}const Eh=Zh,_h={mixedToStrings:e=>e.map((function(e){return"string"==typeof e?e:Array.isArray(e)?`[${_h.mixedToStrings(e).join(", ")}]`:e instanceof Error?`Error: ${e.message}`:String(e)}))},Mh=_h;var Nh;function Ph(e,t,n,s){Nh||(Nh="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Nh,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const{mixedToStrings:Dh}=Mh;function xh(e){switch(e.toLowerCase()){case"file":return{translated:!0,text:(0,Oe.Z)("storage","File")};case"history":return{translated:!0,text:(0,Oe.Z)("History")};case"favorites":return{translated:!0,text:(0,Oe.Z)("Favorites")};case"passwords":return{translated:!0,text:(0,Oe.Z)("Passwords")};case"mailaccounts":return{translated:!0,text:(0,Oe.Z)("Mail Accounts")};case"mailmessages":return{translated:!0,text:(0,Oe.Z)("Mail Messages")};default:return{translated:!1,text:e}}}class Oh extends hs.PureComponent{#h=!1;constructor(e){super(e),this.state={progress:Wc.getImportProgress()}}componentDidMount(){this.#h=!0,Wc.addListener(this.onProgress)}componentWillUnmount(){this.#h=!1,Wc.removeListener(this.onProgress)}onProgress=(0,no.Z)((()=>{this.#h&&this.setState({progress:Wc.getImportProgress()})}),300,{leading:!0});_getImportItemStatus(e){return e.errors?Ph("div",{className:"import-result"},void 0,Ph(tc,{type:"error"},void 0,Dh(e.errors))):!e.children&&-1!==e.total&&e.current>=e.total?Ph("div",{className:"import-result"},void 0,Ph("div",{className:e.warnings?"import-warning":"import-success",title:e.warnings},void 0,Ph("span",{className:"status-icon",dangerouslySetInnerHTML:{__html:n(75124)}}),(0,Oe.Z)("other","Done"))):!e.children&&(e.total>=1||-1===e.total)?Ph("div",{className:"import-result numbers"},void 0,Ph("div",{className:e.warnings?"import-warning":"import-success",title:e.warnings},void 0,e.current+(e.total>1?"/"+e.total:""))):void 0}renderItem=(e,t)=>{const{translated:n,text:s}=xh(e);return Ph("div",{className:As()("setting-single import-status-table",{capitalized:n})},e,Ph("span",{},void 0,s),this._getImportItemStatus(t))};renderIndentedItem=(e,t)=>{const{translated:n,text:s}=xh(e);return Ph("div",{className:As()("setting-single import-mail-account imported-email import-status-table",{capitalized:n})},e,Ph("span",{},void 0,s),this._getImportItemStatus(t))};renderItems=e=>{const t=[];t.push(Ph("header",{},e,Ph("h4",{className:"dialog-title"},void 0,function(e){switch(e.toLowerCase()){case"calendar":return{translated:!0,text:(0,Oe.Z)("Calendar")};case"feeds":return{translated:!0,text:(0,Oe.Z)("Feeds")};default:return{translated:!1,text:e}}}(e).text)));for(const n in this.state.progress[e]){const s=this.state.progress[e][n];if(t.push(this.renderItem(n,s)),s.children)for(const e in s.children){const n=s.children[e];t.push(this.renderIndentedItem(e,n))}}return t};renderTypes=e=>{const t=[];for(const n of e)t.push(Ph("div",{className:"import-data"},n,Ph("div",{className:"imported-data"},void 0,this.renderItems(n))));return t};numImportsToReport=()=>Object.keys(this.state.progress).length;render(){const e=this.numImportsToReport(),t=Object.keys(this.state.progress);return 0===e?null:Ph("div",{className:"import-container"},void 0,this.renderTypes(t))}}var Lh;function Rh(e,t,n,s){Lh||(Lh="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Lh,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var Bh=Rh("div",{className:"import-data"},void 0,Rh(Oh,{}));class Fh extends hs.PureComponent{static contextType=xi.Z;#h=!1;constructor(e){super(e),this.state={offerings:{profiles:[]},selectedIndex:0,selectedPane:H.Z.get($.kMailImportSelectedPane),numImportsInStore:0,startImport:()=>{},runImporter:()=>Promise.resolve(),chooseFile:()=>Promise.resolve(),chooseFiles:()=>Promise.resolve(),isReadyToStart:!1}}componentDidMount(){this.#h=!0,C.Z.importData.getProfiles((e=>{if(this.#h){const t=Wc.numImportsInStore();this.setState((n=>({offerings:{...n.offerings,profiles:e},numImportsInStore:t,selectedPane:0===t?"import":n.selectedPane})))}})),Wc.addListener(this.onProgress)}clearFinishedImports=()=>{const e=Wc.getImportProgress();for(const t of Object.keys(e))for(const n of Object.keys(e[t])){const s=e[t][n];s.current===s.total&&Fd.Z.clearImportProgress(t,n)}};getProfileName=()=>this.state.selectedIndex<this.state.offerings.profiles.length?this.state.offerings.profiles[this.state.selectedIndex].name:"Feeds";componentWillUnmount(){this.#h=!1,this.clearFinishedImports(),Wc.removeListener(this.onProgress)}onImportItemStarted=e=>{Fd.Z.setImportProgress(this.getProfileName(),e,0,0)};onImportItemEnded=e=>{Fd.Z.setImportProgress(this.getProfileName(),e,1,1)};onImportItemFailed=(e,t)=>{Fd.Z.addImportError(this.getProfileName(),e,t)};onImportStarted=()=>{C.Z.importData.onImportItemStarted.addListener(this.onImportItemStarted),C.Z.importData.onImportItemEnded.addListener(this.onImportItemEnded),C.Z.importData.onImportItemFailed.addListener(this.onImportItemFailed),C.Z.importData.onImportEnded.addListener(this.onImportEnded),C.Z.importData.onImportStarted.removeListener(this.onImportStarted),this.setState({selectedPane:"status",numImportsInStore:Wc.numImportsInStore()})};onImportEnded=e=>{C.Z.importData.onImportItemStarted.removeListener(this.onImportItemStarted),C.Z.importData.onImportItemEnded.removeListener(this.onImportItemEnded),C.Z.importData.onImportItemFailed.removeListener(this.onImportItemFailed),C.Z.importData.onImportEnded.removeListener(this.onImportEnded),this.setState({numImportsInStore:Wc.numImportsInStore()})};onProgress=()=>{const e=Wc.numImportsInStore();e!==this.state.numImportsInStore&&this.setState({numImportsInStore:e})};handleSelectionChange(e){const{HTMLSelectElement:t}=this.context;if(e.target instanceof t){const t=parseInt(e.target.value,10);this.setState({selectedIndex:t})}}setStartImport=e=>{this.#h&&this.setState({startImport:()=>{e().then((()=>{this.onImportStarted()}))}})};setRunImporter=e=>{this.setState({runImporter:()=>e().then((()=>{this.setState({selectedPane:"status"})}))})};setChooseFile=e=>{this.#h&&this.setState({chooseFile:e})};newImport=()=>{this.clearFinishedImports(),this._selectPane("import")};setChooseFiles=e=>{this.#h&&this.setState({chooseFiles:e})};readyToStart=e=>{this.setState({isReadyToStart:e})};renderImportFooter(){const{selectedIndex:e}=this.state,t=e<this.state.offerings.profiles.length?this.state.offerings.profiles[e]:void 0,n=e===this.state.offerings.profiles.length+4,s=e===this.state.offerings.profiles.length,i=e===this.state.offerings.profiles.length+2,o=t?.hasDefaultInstall||t?.supportsStandaloneImport||"none"===t?.willShowDialogType,a=i,r=!a&&(!t||"file"===t.willShowDialogType&&"Safari"!==t.name);return s?Rh("footer",{className:"dialog-footer"},void 0,Rh("input",{type:"button",className:"primary",onClick:this.state.runImporter,value:(0,Oe.Z)("Choose a Notes Folder...")}),Rh("input",{type:"button",onClick:this.props.onClose,value:(0,Oe.Z)("Cancel")})):o||this.state.isReadyToStart||n?Rh("footer",{className:"dialog-footer"},void 0,Rh("input",{type:"button",className:"primary",onClick:this.state.startImport,value:(0,Oe.Z)("Start Import")}),a&&Rh("input",{type:"button",className:"primary",onClick:this.state.chooseFiles,value:(0,Oe.Z)("Choose One or More Files...")}),Rh("input",{type:"button",onClick:this.props.onClose,value:(0,Oe.Z)("Close")})):r?Rh("footer",{className:"dialog-footer"},void 0,Rh("input",{type:"button",className:"primary",onClick:this.state.chooseFile,value:(0,Oe.Z)("Choose a File...")}),Rh("input",{type:"button",onClick:this.props.onClose,value:(0,Oe.Z)("Cancel")})):a?Rh("footer",{className:"dialog-footer"},void 0,Rh("input",{type:"button",className:"primary",onClick:this.state.chooseFiles,value:(0,Oe.Z)("Choose One or More Files...")}),Rh("input",{type:"button",onClick:this.props.onClose,value:(0,Oe.Z)("Cancel")})):null}renderStatusFooter(){return Rh("footer",{className:"dialog-footer"},void 0,Rh("input",{type:"button",className:"primary",onClick:this.props.onClose,value:(0,Oe.Z)("Close")}),Rh("input",{type:"button",onClick:this.newImport,value:(0,Oe.Z)("New Import...")}))}_selectPane(e){Ne.Z.set($.kMailImportSelectedPane,e),this.setState({selectedPane:e})}render(){const e=this.state.offerings.profiles.map((e=>Rh("option",{value:e.index},e.index,e.name)));let t=this.state.offerings.profiles.length;if(e.push(Rh("option",{value:t++},"notes-import",(0,Oe.Z)("Notes Folder"))),e.push(Rh("option",{value:t++},"opml-import",(0,Oe.Z)("Feeds (OPML file)"))),!H.Z.get($.kMailIsTurnedOff)){const n=H.Z.get($.kMailAccounts);e.push(Rh("option",{value:t++,disabled:!n||0===n.length},"mail-file-import",(0,Oe.Z)("Mail files"))),e.push(Rh("option",{value:t++},"calendar-import",(0,Oe.Z)("Calendar Events (ICS file)"))),e.push(Rh("option",{value:t++},"calendar-import-web",(0,Oe.Z)("Calendar Events from Remote Server (iCal)")))}const{numImportsInStore:n}=this.state,s=0===n?(0,Oe.Z)("Import Status"):(0,Oe.Z)("Import Status ($1)",[n]);return Rh(_r.Z,{onRequestClose:this.props.onClose,viewMode:"import-data-dialog slide"},void 0,Rh("div",{className:"StatusPopup-Header"},void 0,Rh("h2",{},void 0,(0,Oe.Z)("Imports"))),Rh("div",{className:"dialog-content"},void 0,Rh("div",{className:"toolbar toolbar-default import"},void 0,Rh("div",{className:"toolbar-group equal-width"},void 0,Rh(Fa,{title:(0,Oe.Z)("Import"),isPressed:"import"===this.state.selectedPane,onClick:()=>this._selectPane("import")}),Rh(Fa,{title:s,isPressed:"status"===this.state.selectedPane,onClick:()=>this._selectPane("status"),disabled:0===this.state.numImportsInStore}))),"import"===this.state.selectedPane&&Rh("div",{className:"import-data"},void 0,Rh("fieldset",{},void 0,Rh("label",{htmlFor:"browserSel",className:"from"},void 0,(0,Oe.Z)("import","From")),Rh("select",{id:"browserSel",onChange:this.handleSelectionChange.bind(this),value:this.state.selectedIndex,autoFocus:!0},void 0,e)),this.state.selectedIndex<this.state.offerings.profiles.length&&Rh(Eh,{profile:this.state.offerings.profiles[this.state.selectedIndex],index:this.state.selectedIndex,setStartImport:this.setStartImport,setChooseFile:this.setChooseFile}),this.state.selectedIndex===this.state.offerings.profiles.length&&Rh(Ac,{setRunImporter:this.setRunImporter}),this.state.selectedIndex===this.state.offerings.profiles.length+1&&Rh(Bc,{setStartImport:this.setStartImport,setChooseFile:this.setChooseFile}),this.state.selectedIndex===this.state.offerings.profiles.length+2&&Rh(wc,{setStartImport:this.setStartImport,setChooseFiles:this.setChooseFiles,readyToStart:this.readyToStart}),this.state.selectedIndex===this.state.offerings.profiles.length+3&&Rh(Xd,{setStartImport:this.setStartImport,setChooseFile:this.setChooseFile,readyToStart:this.readyToStart}),this.state.selectedIndex===this.state.offerings.profiles.length+4&&Rh(hc,{setStartImport:this.setStartImport})),"status"===this.state.selectedPane&&Bh),"import"===this.state.selectedPane?this.renderImportFooter():this.renderStatusFooter())}}const Vh=Fh;var Wh,Uh=n(10679);function Hh(e,t,n,s){Wh||(Wh="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Wh,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const zh={width:400,minWidth:"unset"};class Gh extends hs.Component{refPromptInput=hs.createRef();refOkButton=hs.createRef();_pendingAction=!0;state={promptValue:this.props.customData.defaultPromptText};handleLoadStart=e=>{e.isTopLevel&&this.onCancel()};componentDidMount(){this.props.customData.webview.addEventListener("loadstart",this.handleLoadStart),"prompt"!==this.props.customData.messageType?(0,Uh.Z)((()=>this.refOkButton.current?.focus()),80):(0,Uh.Z)((()=>this.refPromptInput.current?.select()),80)}componentWillUnmount(){this.props.customData.webview.removeEventListener("loadstart",this.handleLoadStart)}onOk=e=>{this._pendingAction&&(e.preventDefault(),this._pendingAction=!1,this.props.customData.dialog.ok(this.state.promptValue)),this.props.onClose()};onCancel=()=>{this._pendingAction&&(this._pendingAction=!1,this.props.customData.dialog.cancel()),this.props.onClose()};handlePrompt=e=>{this.setState({promptValue:e.target.value})};render(){const e=(0,ms.Z)(this.props.customData.url)?.hostname||"",t=this.props.customData.messageType,n=e?(0,Oe.Z)("JavaScript from “$1”",[e]):(0,Oe.Z)("JavaScript from localhost");return Hh(_r.Z,{style:zh,onRequestClose:this.onCancel,ignoreClickOutside:!0,viewMode:"dialog-javascript slide"},void 0,Hh("header",{className:"dialog-header"},void 0,Hh("h1",{className:"dialog-title",title:n},void 0,n)),Hh("form",{onSubmit:this.onOk},void 0,Hh("div",{className:"dialog-content"},void 0,Hh("p",{},void 0,this.props.customData.messageText),"prompt"===t&&(0,fs.jsx)("input",{type:"text",ref:this.refPromptInput,value:this.state.promptValue,onChange:this.handlePrompt})),Hh("footer",{className:"dialog-footer"},void 0,(0,fs.jsx)("input",{ref:this.refOkButton,type:"submit",value:(0,Oe.Z)("OK")}),"alert"!==t&&Hh("input",{type:"button",onClick:this.onCancel,value:(0,Oe.Z)("Cancel")}))))}}const $h=Gh;var Kh;function jh(e,t,n,s){Kh||(Kh="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Kh,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Yh=287;function Xh(e){const t=e.length;switch(!0){case t>180&&t<Yh:return 426;case t>122:return 354;case t>84:return 306;default:return 258}}class Qh extends hs.Component{#h=!1;constructor(e){super(e),this.state={qrImage:"",data:this.props.data,dataChanged:!1}}componentDidMount(){this.#h=!0,this.onGenerate("dataurl")}componentWillUnmount(){this.#h=!1}componentDidUpdate(e){this.state.dataChanged||this.props.data===e.data||this.setState({data:this.props.data},this.onGenerate.bind(this,"dataurl"))}onUrlInputChanged=e=>{const t=e.currentTarget.value;this.setState({data:t}),t&&t.length>2&&C.Z.utilities.generateQRCode(t,(e=>{this.setState({qrImage:e,dataChanged:!0})}))};onGenerate=(e,t)=>{if(this.props.data){const n=(0,Oe.Z)("QR Code Generated");C.Z.utilities.generateQRCode(this.props.data,e,(t=>{"dataurl"===e?this.#h&&this.setState({qrImage:t,data:this.props.data}):"clipboard"===e&&(0,Ke.c)({title:n,body:(0,Oe.Z)("Image stored in the clipboard."),tag:"VIVALDI_QR_IMAGE_TO_CLIPBOARD"})})),t&&this.props.hidePopup()}};onCancel=()=>{this.props.hidePopup()};renderDialogHeader=()=>jh("div",{className:"dialog-header"},void 0,jh("h3",{},void 0,(0,Oe.Z)("Scan QR Code")));renderQRImage=()=>jh("div",{className:"dialog-content"},void 0,this.state.data.length>Yh?jh("p",{},void 0,(0,Oe.Z)("Address is too long, QR code source cannot exceed $1 characters.",[Yh])):jh("img",{src:this.state.qrImage,className:"qr-image"}),jh("input",{type:"text",value:this.state.data,spellCheck:"false",maxLength:Yh,onChange:this.onUrlInputChanged,onFocus:e=>e.target.select(),autoFocus:!0}));renderSaveCancel=()=>jh("footer",{className:"dialog-footer"},void 0,jh("input",{type:"button",onClick:this.onGenerate.bind(this,"clipboard",!0),disabled:this.state.data.length>Yh,value:(0,Oe.Z)("verb","Copy")}),jh("input",{type:"button",onClick:this.onGenerate.bind(this,"file",!0),disabled:this.state.data.length>Yh,value:(0,Oe.Z)("Save to Download")}));renderPopupContents=()=>jh("div",{className:"qr-share-dialog"},void 0,this.renderDialogHeader(),this.renderQRImage(),this.renderSaveCancel());render(){return this.props.useModal?jh(_r.Z,{style:{width:Xh(this.state.data),minWidth:"unset"},onRequestClose:this.onCancel},void 0,this.renderPopupContents()):this.renderPopupContents()}}const qh=Qh;var Jh;function ep(e,t,n,s){Jh||(Jh="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Jh,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const tp={width:400,minWidth:"unset"};class np extends hs.Component{state={awaiting:30};componentDidMount(){this.expireInterval=setInterval((()=>this.expirePreview()),1e3)}componentWillUnmount(){clearInterval(this.expireInterval)}expirePreview=()=>{this.setState((e=>{const t=e.awaiting-1;return t<=0&&(clearInterval(this.expireInterval),is.Z.clearThemePreview()),{awaiting:t}}))};acceptPreview=()=>{this.props.isUpdate?is.Z.updateTheme():is.Z.installTheme(),this.props.onClose()};discardPreview=()=>{is.Z.clearThemePreview(),this.props.onClose()};render(){return ep(_r.Z,{onRequestClose:Aa.Z,style:tp,viewMode:"slide",ignoreClickOutside:!0},void 0,ep("header",{className:"dialog-header"},void 0,ep("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("Theme Preview"))),ep("div",{className:"dialog-content"},void 0,this.state.awaiting>0&&(0,fs.jsxs)(fs.Fragment,{children:[ep("p",{},void 0,this.props.isUpdate?(0,Oe.Z)("This is a preview of the updated “$1” theme. Would you like to install this update and apply it?",[this.props.themeName]):(0,Oe.Z)("This is a preview of the “$1” theme. Would you like to install and apply it?",[this.props.themeName])),ep("p",{className:"info"},void 0,(0,Oe.Z)("Theme preview expires in $1 second.","Theme preview expires in $1 seconds.",[this.state.awaiting]))]}),this.state.awaiting<1&&ep("p",{},void 0,(0,Oe.Z)("Preview of the “$1” theme has expired, please reload the theme again if you wish to install it.",[this.props.themeName]))),ep("footer",{className:"dialog-footer"},void 0,ep("input",{type:"submit",value:this.props.isUpdate?(0,Oe.Z)("Update"):(0,Oe.Z)("Install"),onClick:this.acceptPreview,disabled:this.state.awaiting<1,autoFocus:!0}),ep("input",{type:"button",value:(0,Oe.Z)("Cancel"),onClick:this.discardPreview})))}}const sp=np;var ip;function op(e,t,n,s){ip||(ip="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:ip,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const ap=function({customData:e,closeDialog:t}){switch(e.dialogtype){case"download":return op(Ad,{customData:e,onClose:t});case"import":return op(Vh,{onClose:t});case"createSearch":return op(pd,{onClose:t,name:e.Name,url:e.Url});case"javascript":return op("div",{className:"modal-overlay"},void 0,op($h,{customData:e,onClose:t}));case"fullscreen":return op(Od,{customData:e,closeDialog:t});case"pointerLock":{const n=(0,Oe.Z)("Press Escape key to exit the pointer lock.");return op(Dd,{customData:e,onClose:t,overlayText:n})}case"qrcode":return op("div",{className:"modal-overlay"},void 0,op(qh,{useModal:!0,data:e.url,hidePopup:t}));case"extensionError":return op("div",{className:"modal-overlay"},void 0,op(_d,{errors:e.errors,onClose:t}));case"themePreview":return op("div",{className:"modal-overlay"},void 0,op(sp,{themeName:e.themeName,isUpdate:e.isUpdate,onClose:t}));default:return console.error("DialogRenderWrapper.render: unknown dialogtype:"+e.dialogtype),null}};var rp;function lp(e,t,n,s){rp||(rp="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:rp,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const dp=[$.kStartupShowCrashReportingDialog,$.kVivaldiCrashReportingConsentGranted,$.kStartupCrashReportingLastRequested,$.kStartupCrashReportingTimesShown],cp={width:500,minWidth:"unset"};class hp extends hs.Component{constructor(e){super(e)}UpdateLastRequestedAndClose=()=>{Ne.Z.set($.kStartupCrashReportingLastRequested,Date.now()),this.props.onClose()};DeclineForeverAndClose=()=>{Ne.Z.set($.kStartupShowCrashReportingDialog,!1),Ne.Z.set($.kVivaldiCrashReportingConsentGranted,!1),this.UpdateLastRequestedAndClose()};IncrementCounterAndClose=()=>{const e=this.props.prefValues[$.kStartupCrashReportingTimesShown];Ne.Z.set($.kStartupCrashReportingTimesShown,e+1),this.UpdateLastRequestedAndClose()};GrantConsentAndClose=()=>{Ne.Z.set($.kVivaldiCrashReportingConsentGranted,!0),this.UpdateLastRequestedAndClose()};openPrivacyPage=()=>{d.ZP.openURL(this.context.vivaldiWindowId,h.fg)};MaybeShowDeclineForeverButton(){return this.props.prefValues[$.kStartupCrashReportingTimesShown]>1?lp("input",{type:"button",value:(0,Oe.Z)("Never Ask Again"),onClick:this.DeclineForeverAndClose}):null}render(){return lp(_r.Z,{onRequestClose:Aa.Z,style:cp,viewMode:"slide",asToolbar:!0},void 0,lp("div",{className:"dialog-with-image"},void 0,lp("div",{className:"dialog-with-image-TextBlock"},void 0,lp("header",{className:"dialog-header"},void 0,lp("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("Share Crash Reports With Vivaldi"))),lp("div",{className:"dialog-content"},void 0,lp("p",{},void 0,(0,Oe.Z)("We recently detected a crash. Would you like to share future crash reports with us to help improve the browser?")),lp("p",{className:"info"},void 0,(0,Oe.Z)("Crash reports include the most recently visited webpage. It may send more personal information which is promptly deleted.")))),lp("span",{className:"dialog-image",dangerouslySetInnerHTML:{__html:Ts.bBV}})),lp("footer",{className:"dialog-footer"},void 0,lp("input",{type:"button",className:"primary",value:(0,Oe.Z)("Share Crash Reports"),onClick:this.GrantConsentAndClose}),lp("input",{type:"button",value:(0,Oe.Z)("Maybe Later"),onClick:this.IncrementCounterAndClose}),this.MaybeShowDeclineForeverButton()))}}const pp=sa(hp,dp);var up;function gp(e,t,n,s){up||(up="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:up,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const mp="https://vivaldi.com/bugreport/";class vp extends hs.Component{static contextType=xi.Z;state={hasError:!1,stack:"",existingChildren:this.props.children};static getDerivedStateFromProps(e,t){return e.children!==t.existingChildren?{hasError:!1,existingChildren:e.children}:null}static getDerivedStateFromError(e){return{hasError:!0,stack:e.stack}}componentDidCatch(e,t){return null}openBugReport=()=>{d.ZP.openURL(this.context.vivaldiWindowId,mp)};render(){const{children:e,level:t}=this.props;return this.state.hasError?gp("div",{className:"error-boundary"},void 0,gp("h1",{},void 0,(0,Oe.Z)("An error occurred")),gp("pre",{},void 0,this.state.stack),gp("p",{},void 0,(0,Oe.Z)("Please consider reporting the issue at $1 to help us fix it.",[mp])),"nothing"===t&&gp("input",{type:"button",onClick:()=>C.Z.runtimePrivate.exit(!0),value:(0,Oe.Z)("verb","Exit")}),"tabs"===t&&gp("input",{type:"button",onClick:this.openBugReport,value:(0,Oe.Z)("Report issue")})):e}}const fp=vp;var yp;function Cp(e,t,n,s){yp||(yp="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:yp,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const wp=[$.kStartupShowFfmpegInformation],bp={width:400,minWidth:"unset"};class Sp extends hs.Component{static contextType=xi.Z;constructor(e){super(e),this.state={doNotShowAgain:!1}}_onClose=()=>{Ne.Z.set($.kStartupShowFfmpegInformation,!this.state.doNotShowAgain),this.props.onClose()};_onInformation=()=>{d.ZP.openURL(this.context.vivaldiWindowId,"https://help.vivaldi.com/article/html5-proprietary-media-on-linux/"),this._onClose()};_onCheckChanged=()=>{this.setState((e=>({doNotShowAgain:!e.doNotShowAgain})))};render(){return Cp(_r.Z,{onRequestClose:Aa.Z,style:bp,viewMode:"slide"},void 0,Cp("header",{className:"dialog-header"},void 0,Cp("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("Media support"))),Cp("div",{className:"dialog-content"},void 0,Cp("p",{},void 0,(0,Oe.Z)("Vivaldi currently lacks a suitable component to play HTML5 ‘proprietary’ media (H.264/AAC).")),Cp("p",{},void 0,(0,Oe.Z)("Try to restart the browser. If that does not solve the problem click ‘More Information’ below.")),Cp("label",{className:"dialog-checkbox"},void 0,Cp("input",{type:"checkbox",checked:this.state.doNotShowAgain,onChange:this._onCheckChanged}),Cp("span",{},void 0,(0,Oe.Z)("Do not show again")))),Cp("footer",{className:"dialog-footer"},void 0,Cp("input",{type:"submit",value:(0,Oe.Z)("More Information"),onClick:this._onInformation,autoFocus:!0}),Cp("input",{type:"button",value:(0,Oe.Z)("Cancel"),onClick:this._onClose})))}}const Ip=sa(Sp,wp);var kp;function Ap(e,t,n,s){kp||(kp="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:kp,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Tp=[$.kStartupShowGitDirectoryWarning],Zp={width:500,minWidth:"unset"};class Ep extends hs.Component{constructor(e){super(e)}_onClose=()=>{Ne.Z.set($.kStartupShowGitDirectoryWarning,""),this.props.onClose()};render(){return Ap(_r.Z,{onRequestClose:Aa.Z,style:Zp,viewMode:"slide"},void 0,Ap("header",{className:"dialog-header"},void 0,Ap("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("Warning: Your profile folder might be in a Git repository"))),Ap("div",{className:"dialog-content selectable-content"},void 0,Ap("p",{},void 0,(0,Oe.Z)("A .git configuration was detected in")," ",Ap("b",{},void 0,this.props.prefValues[$.kStartupShowGitDirectoryWarning])),Ap("p",{},void 0,(0,Oe.Z)("This could cause you to accidentally share part of or your whole profile with a public Git repository and allow others to see your private data, such as website logins, cookies and cache files.")),Ap("p",{},void 0,(0,Oe.Z)("A .gitignore file has therefore been added to your profile folder to prevent accidental sharing to public Git services (e.g. GitHub). If sharing was intentional, please edit the .gitignore file to select what really should be ignored."))),Ap("footer",{className:"dialog-footer"},void 0,Ap("input",{type:"button",value:(0,Oe.Z)("Close"),onClick:this._onClose})))}}const _p=sa(Ep,Tp);var Mp;function Np(e,t,n,s){Mp||(Mp="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Mp,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Pp=[$.kStartupShowMediaAvailableInformation],Dp={width:400,minWidth:"unset"};class xp extends hs.Component{static contextType=xi.Z;constructor(e){super(e),this.state={doNotShowAgain:!1}}_onClose=()=>{Ne.Z.set($.kStartupShowMediaAvailableInformation,!this.state.doNotShowAgain),this.props.onClose()};_onInformation=()=>{d.ZP.openURL(this.context.vivaldiWindowId,"https://www.microsoft.com/en-us/software-download/mediafeaturepack"),this._onClose()};_onCheckChanged=()=>{this.setState((e=>({doNotShowAgain:!e.doNotShowAgain})))};render(){return Np(_r.Z,{onRequestClose:Aa.Z,style:Dp,viewMode:"slide"},void 0,Np("header",{className:"dialog-header"},void 0,Np("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("Media support"))),Np("div",{className:"dialog-content"},void 0,Np("p",{},void 0,(0,Oe.Z)("This Windows N edition lacks the media package to play HTML5 ‘proprietary’ media (H.264/AAC).")),Np("label",{className:"dialog-checkbox"},void 0,Np("input",{type:"checkbox",checked:this.state.doNotShowAgain,onChange:this._onCheckChanged}),Np("span",{},void 0,(0,Oe.Z)("Do not show again")))),Np("footer",{className:"dialog-footer"},void 0,Np("input",{type:"submit",value:(0,Oe.Z)("More Information"),onClick:this._onInformation,autoFocus:!0}),Np("input",{type:"button",value:(0,Oe.Z)("Cancel"),onClick:this._onClose})))}}const Op=sa(xp,Pp);var Lp;function Rp(e,t,n,s){Lp||(Lp="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Lp,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Bp=function(e){const t=(0,hs.useContext)(xi.Z),{document:s}=t,[i,o]=(0,hs.useState)(!1),[a,r]=(0,hs.useState)(!0),l=function(){const e=(0,hs.useContext)(xi.Z),t=(0,hs.useRef)(null),n=(0,hs.useCallback)((()=>{const n=t.current?.getBoundingClientRect();n&&C.Z.windowPrivate.updateMaximizeButtonPosition(e.vivaldiWindowId,n.left,n.top,n.width,n.height)}),[e.vivaldiWindowId]);return(0,hs.useEffect)((()=>(e.addEventListener("resize",n),e.addEventListener("load",n),()=>{e.removeEventListener("resize",n),e.removeEventListener("load",n)})),[n,e]),(0,hs.useLayoutEffect)(n,[n]),t}();let d,c,h;d=n(51759),h=n(96375),c=n(9592);const p=e=>{e.preventDefault()};return Rp("div",{className:As()({"window-buttongroup":!0,"on-mainbar":e.onMainBar,"alt-hover":i&&!G.ZP.isFullscreen(t.vivaldiWindowId),graphite:false,"disable-transition":a}),onMouseEnter:e=>{r(!1)},onMouseLeave:null},void 0,Rp("button",{tabIndex:"-1",className:"window-minimize",onMouseDown:p,onClick:e=>{cs.Z.minimize(t.vivaldiWindowId)},dangerouslySetInnerHTML:{__html:h}}),(0,fs.jsx)("button",{ref:l,tabIndex:"-1",className:"window-maximize",onMouseDown:p,onClick:e=>{e.persist(),G.ZP.isMaximized(t.vivaldiWindowId)||G.ZP.isFullscreen(t.vivaldiWindowId)?cs.Z.restore(t.vivaldiWindowId):cs.Z.maximize(t.vivaldiWindowId)},dangerouslySetInnerHTML:{__html:c}}),Rp("button",{tabIndex:"-1",className:"window-close",onMouseDown:p,onClick:e=>{e.stopPropagation(),cs.Z.close(t.vivaldiWindowId)},dangerouslySetInnerHTML:{__html:d}}))};var Fp,Vp=n(34197),Wp=n(32773),Up=n(57654);function Hp(e,t,n,s){Fp||(Fp="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Fp,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const zp=[$.kKeyboardTabToAll];var Gp=Hp("br",{});class $p extends hs.Component{static contextType=xi.Z;constructor(e){super(e),this.state={hasGuestSession:!1,accountState:"none",editedName:this.getProfileName(e.activeProfile),suggestedName:"",activeImageIndex:e.activeProfile.imageIndex,activeImageUrl:this.getProfileImage(e.activeProfile),profileImages:[],profileStats:[],selectedProfilePath:"",hasDesktopShortcut:!1,createDesktopShortcut:!1,canCreateDesktopShortcut:!0,canRemoveActive:!1}}componentDidMount(){this.attachListeners(),this.onWindowUpdated(),this.getAllProfileImages(),C.Z.runtimePrivate.getProfileDefaults((e=>{this.setState({suggestedName:e})})),C.Z.runtimePrivate.hasDesktopShortcut(((e,t)=>{this.setState({hasDesktopShortcut:e,createDesktopShortcut:e,canCreateDesktopShortcut:t})}))}componentWillUnmount(){this.detachListeners()}attachListeners=()=>{s.Z.windows.onCreated.addListener(this.onWindowUpdated),s.Z.windows.onRemoved.addListener(this.onWindowUpdated)};detachListeners=()=>{s.Z.windows.onCreated.removeListener(this.onWindowUpdated),s.Z.windows.onRemoved.removeListener(this.onWindowUpdated)};onWindowUpdated=()=>{C.Z.runtimePrivate.hasGuestSession((e=>{this.state&&this.setState({hasGuestSession:e})}))};getAllProfileImages=()=>{C.Z.runtimePrivate.getUserProfileImages((e=>{this.setState({profileImages:e})}))};openNamedProfile=e=>{C.Z.runtimePrivate.openNamedProfile(e,(t=>{t||console.warn("Failed to open profile: "+e),this.props.hidePopup()}))};getProfileImage=e=>{if(e.active){const e=Jn.Z.getState().accountInfo;if(e.pictureUrl)return e.pictureUrl}return e.customAvatar?e.customAvatar:e.image};getProfileName=e=>{if(e.active){const e=Jn.Z.getState().accountInfo;if(e.accountId)return e.accountId}return e.name};toggleGuestProfile=()=>{this.state.hasGuestSession?Ae.Z.closeGuestSession():Ae.Z.openGuestWindow(),this.props.hidePopup()};managePeople=()=>{this.setState({accountState:"list"})};manageUser=()=>{this.props.isLoggedIn?(Ae.Z.showSettings(this.context.vivaldiWindowId,"sync"),this.props.hidePopup()):this.setState({accountState:"edit"})};exitUser=()=>{Ae.Z.closeActiveProfile()};getFormattedName_=()=>this.props.accountInfo.username&&this.props.isLoggedIn?Hp("div",{className:"profile-name-text"},void 0,Hp("div",{className:"active-sync-item-label"},void 0,(0,Oe.Z)("Logged in as"),Gp),Hp("div",{},void 0,this.props.accountInfo.username)):this.props.activeProfile.name;selectActiveProfileImage=(e,t)=>{this.setState({activeImageIndex:e,activeImageUrl:t})};selectCustomProfileImage=()=>{C.Z.utilities.selectLocalImage({windowId:this.context.vivaldiWindowId,title:(0,Oe.Z)("Select Custom Image"),profileImage:!0})};goBack=()=>{let e="none";"info"===this.state.accountState&&(e="list"),this.state&&this.setState({accountState:e,editedName:this.props.activeProfile.name,activeImageIndex:this.props.activeProfile.imageIndex,canRemoveActive:!1})};onSave=()=>{let e=!0;if("edit"===this.state.accountState){if(this.state.editedName.length){const t=(0,Up.Z)(this.state.editedName).trim();if(!t.length)return;const n=this.state.hasDesktopShortcut!==this.state.createDesktopShortcut||this.state.activeImageIndex!==this.props.activeProfile.imageIndex;C.Z.runtimePrivate.updateActiveProfile(t,this.state.activeImageIndex,n?this.state.createDesktopShortcut:void 0,(t=>{e=t}))}}else if("new"===this.state.accountState&&this.state.suggestedName.length){const t=(0,Up.Z)(this.state.suggestedName).trim();if(!t.length)return;C.Z.runtimePrivate.createProfile(t,this.state.activeImageIndex,this.state.createDesktopShortcut,(t=>{e=t}))}this.props.hidePopup&&e&&this.props.hidePopup()};onCancel=()=>{this.goBack()};onSignin=()=>{Ae.Z.showSettings(this.context.vivaldiWindowId,"sync"),this.props.hidePopup()};onRegister=()=>{Ae.Z.showSettings(this.context.vivaldiWindowId,"sync",{view:"register"}),this.props.hidePopup()};createProfile=()=>{this.setState({accountState:"new",activeImageIndex:0})};showProfileInfo=(e,t)=>{this.setState({accountState:"info",selectedProfilePath:e}),t.preventDefault(),t.stopPropagation(),C.Z.runtimePrivate.getProfileStatistics(e,(e=>{e.map((e=>{switch(e.category){case"Autofill":e.category=(0,Oe.Z)("other","Autofill");break;case"Bookmarks":e.category=(0,Oe.Z)("Bookmarks");break;case"Passwords":e.category=(0,Oe.Z)("Passwords");break;case"BrowsingHistory":e.category=(0,Oe.Z)("Browsing History")}})),this.setState({profileStats:e})}))};confirmRemoval=()=>{this.setState({canRemoveActive:!0})};removeProfile=()=>{C.Z.runtimePrivate.deleteProfile(this.state.selectedProfilePath,(e=>{e&&this.goBack()}))};handleNameInput=e=>{"new"===this.state.accountState?this.setState({suggestedName:e.target.value}):this.setState({editedName:e.target.value})};changeDesktopShortcut=e=>{this.setState({createDesktopShortcut:e.currentTarget.checked})};handleFocus=e=>{e.currentTarget.select()};renderNavigationBack=()=>{const e=(0,Oe.Z)("profiles","Back");return Hp("button",{type:"button",title:e,className:"nav-back",onClick:this.goBack,dangerouslySetInnerHTML:{__html:Ts.mgF.medium+e}})};renderDialogHeader=()=>{let e;switch(this.state.accountState){case"new":e=(0,Oe.Z)("Create New Profile");break;case"info":break;default:e=(0,Oe.Z)("Edit Profile")}return e?Hp("div",{className:"profile-section-header"},void 0,e):null};renderNameEdit=()=>{const e="new"===this.state.accountState?this.state.suggestedName:this.state.editedName;return Hp("label",{className:"profile-section-name"},void 0,Hp("input",{type:"text",name:"name",placeholder:(0,Oe.Z)("profiles","Name"),onChange:this.handleNameInput,value:e,onFocus:this.handleFocus,autoFocus:!0}))};renderSaveCancel=()=>Hp("footer",{className:"dialog-footer"},void 0,Hp("input",{type:"submit",className:"primary",value:"new"===this.state.accountState?(0,Oe.Z)("Add Profile"):(0,Oe.Z)("Save")}),Hp("input",{type:"button",onClick:this.onCancel,value:(0,Oe.Z)("Cancel")}));renderProfileInfo=()=>{const e=[],t=this.props.allProfiles.filter((e=>e.path===this.state.selectedProfilePath));if(t&&t[0]){const n=this.getProfileName(t[0]),s=this.getProfileImage(t[0]);e.push(Hp("div",{className:"profile-details"},"apv_details",Hp("div",{className:"profile-image",style:{backgroundImage:`url(${s})`}}),Hp("div",{className:"profile-name"},void 0,n)))}return this.state.profileStats.forEach(((t,n)=>{e.push(Hp("div",{className:"profile-stat-row"},t.category,Hp("div",{className:"profile-category"},void 0,t.category),Hp("div",{className:"profile-count"},void 0,t.count)))})),this.state.canRemoveActive&&e.push(Hp(tc,{type:"error"},"apv_alert",(0,Oe.Z)("All profile data will be deleted and cannot be restored. Do you still want to proceed?"))),e.push(Hp("input",{type:"button",className:"danger remove-person-button",onClick:this.state.canRemoveActive?this.removeProfile:this.confirmRemoval,value:(0,Oe.Z)("Remove Profile")},"apv_button")),e};renderSelectableProfileImages=()=>{const e=[];e.push(Hp("button",{title:(0,Oe.Z)("Select custom avatar image"),type:"button",className:"avatarbox avatarbox-custom",onClick:this.selectCustomProfileImage.bind(this),dangerouslySetInnerHTML:{__html:Ts.IJb}},"custom-image"));let t=this.state.profileImages.map((e=>{const t=As()({"avatarbox-image":!0,"avatarbox-selected":this.state.activeImageIndex===e.index});return Hp("button",{title:e.name,type:"button",className:"avatarbox",onClick:this.selectActiveProfileImage.bind(this,e.index,e.image)},e.index,Hp("div",{className:t,style:{backgroundImage:`url(${e.image})`}}))}));return t=e.concat(t),Hp("div",{className:"avatarlist"},void 0,t)};renderCreateProfileShortcut=()=>this.state.canCreateDesktopShortcut?Hp("label",{},void 0,Hp("input",{className:"dialog-checkbox",checked:this.state.createDesktopShortcut,onChange:this.changeDesktopShortcut,type:"checkbox"}),Hp("span",{},void 0,(0,Oe.Z)("Create Desktop Shortcut"))):null;renderAllProfiles=()=>{const e=[];return this.props.allProfiles.forEach((t=>{const n=this.getProfileImage(t),s=this.getProfileName(t);e.push(Hp("button",{className:"account-item-large",title:s,onClick:this.showProfileInfo.bind(this,t.path),tabIndex:this.props.prefValues[$.kKeyboardTabToAll],autoFocus:-1!==this.props.prefValues[$.kKeyboardTabToAll]},t.path,Hp("img",{src:n}),Hp("span",{className:"profile-name"},void 0,s)))})),e};renderActiveProfileHeader=()=>{let e=this.props.accountInfo.pictureUrl;return e&&this.props.isLoggedIn||(e=this.getProfileImage(this.props.activeProfile)),(0,fs.jsxs)(fs.Fragment,{children:[Hp("div",{className:"account-item active-profile",onClick:this.manageUser},void 0,Hp("div",{className:"profile-name"},void 0,Hp("img",{src:e}),this.getFormattedName_()),(this.props.isLoggedIn||!this.props.accountInfo.username)&&Hp("span",{dangerouslySetInnerHTML:{__html:Ts.Zu.medium}})),this.props.accountInfo.username&&!this.props.isLoggedIn&&Hp("input",{type:"button",onClick:this.onSignin,value:(0,Oe.Z)("Log in"),autoFocus:!0})]})};renderInActiveProfiles=()=>{const e=this.props.allProfiles.filter((e=>!e.active)),t=[];return e.forEach((e=>{const n=this.getProfileImage(e),s=this.getProfileName(e);t.push(Hp("button",{className:"account-item",title:s,onClick:this.openNamedProfile.bind(this,e.path)},e.path,Hp("img",{src:n}),Hp("span",{className:"profile-name"},void 0,s)))})),t};renderGuestEntry=()=>{const e=this.state.hasGuestSession?(0,Oe.Z)("Exit Guest Session"):(0,Oe.Z)("Open Guest Profile");return Hp("button",{className:"account-item",onClick:this.toggleGuestProfile,title:e,dangerouslySetInnerHTML:{__html:Ts.CtH.medium+e}})};renderManagePeople=()=>{const e=(0,Oe.Z)("Manage Profiles");return Hp("button",{className:"account-item",onClick:this.managePeople,title:e,dangerouslySetInnerHTML:{__html:Ts.LaO.medium+e}})};renderExitUser=()=>{const e=(0,Oe.Z)("Exit $1",[this.props.activeProfile.name]);return Hp("button",{className:"account-item",onClick:this.exitUser,title:e,dangerouslySetInnerHTML:{__html:Ts.kze+e}})};renderSyncCTA=()=>Hp("div",{className:"account-create"},void 0,Hp("span",{dangerouslySetInnerHTML:{__html:n(71665)}}),Hp("p",{},void 0,(0,Oe.Z)("Create a Vivaldi Account to access your tabs, bookmarks, and data on all your devices.")),Hp("div",{className:"toolbar toolbar-wrap toolbar-space toolbar-center"},void 0,Hp("input",{type:"button",className:"primary",value:(0,Oe.Z)("Create Account"),onClick:this.onRegister}),Hp("input",{type:"button",value:(0,Oe.Z)("Log In"),onClick:this.onSignin})));render(){return"edit"===this.state.accountState||"new"===this.state.accountState?Hp("form",{className:"account-dialog",onSubmit:this.onSave},void 0,this.renderNavigationBack(),this.renderDialogHeader(),this.renderNameEdit(),this.renderSelectableProfileImages(),this.renderCreateProfileShortcut(),this.renderSaveCancel()):"list"===this.state.accountState?Hp("div",{className:"account-dialog"},void 0,this.renderNavigationBack(),Hp("div",{className:"account-listing-large"},void 0,this.renderAllProfiles()),Hp("footer",{className:"dialog-footer"},void 0,Hp("input",{type:"submit",className:"primary",onClick:this.createProfile,value:(0,Oe.Z)("Add Profile")}))):"info"===this.state.accountState?Hp("div",{className:"account-dialog"},void 0,this.renderNavigationBack(),this.renderDialogHeader(),Hp("div",{className:"profile-stat"},void 0,this.renderProfileInfo())):this.props.activeProfile.guest?Hp("div",{className:"account-dialog"},void 0,this.renderInActiveProfiles(),this.renderGuestEntry()):Hp("div",{className:"account-dialog"},void 0,Hp("header",{},void 0,this.renderActiveProfileHeader()),Hp("div",{className:"popup-scrollarea"},void 0,!this.props.accountInfo.username&&!this.props.isLoggedIn&&this.renderSyncCTA(),this.renderInActiveProfiles(),this.renderManagePeople(),this.renderGuestEntry(),this.props.allProfiles.length>1&&this.renderExitUser()))}}const Kp=sa($p,zp);var jp;function Yp(e,t,n,s){jp||(jp="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:jp,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Xp="/resources/contact-person.png";var Qp=Yp("div",{className:"profile-popup"});class qp extends hs.PureComponent{static contextType=xi.Z;state={popupVisible:!1,activeProfile:void 0,allProfiles:[],isLoggedIn:Jn.Z.getState().hasToken,accountInfo:Jn.Z.getState().accountInfo};componentDidMount(){C.Z.runtimePrivate.onProfilesUpdated.addListener(this.profilesUpdated),this.profilesUpdated(),Jn.Z.addListener(this.onVivaldiAccountChange),this.onVivaldiAccountChange()}componentWillUnmount(){C.Z.runtimePrivate.onProfilesUpdated.removeListener(this.profilesUpdated),Jn.Z.removeListener(this.onVivaldiAccountChange)}profilesUpdated=()=>{C.Z.runtimePrivate.getUserProfiles((e=>{const t=e.find((e=>!0===e.active));this.setState({allProfiles:e}),t&&this.setState({activeProfile:t})}))};onVivaldiAccountChange=()=>{const e=Jn.Z.getState();this.setState({isLoggedIn:e.hasToken&&e.isReady,accountInfo:e.accountInfo})};togglePopup=()=>{this.setState((e=>({popupVisible:!e.popupVisible})))};hidePopup=()=>{this.setState({popupVisible:!1})};render(){if(!this.props.preview&&G.ZP.isIncognito(this.context.vivaldiWindowId))return null;let e=this.state.accountInfo.username,t=this.state.accountInfo.pictureUrl;const n=this.state.activeProfile;return n?(n.guest?(n.image=t=Xp,n.name=e=(0,Oe.Z)("Guest User")):this.state.isLoggedIn||(e=n.name,t=n.customAvatar?n.customAvatar:n.image),t||(t=Xp),Yp(Fa,{imagePath:t,tooltip:e||(0,Oe.Z)("Account"),onClick:this.togglePopup,customizeMenu:this.props.customizeMenu,menuOrigin:this.props.menuOrigin,popupPosition:this.props.popupPosition,hidePopup:this.hidePopup,isPopupVisible:this.state.popupVisible,className:"button-circularimage button-cropimage profile-popup",popupClassName:"ToolbarButtonPopup-DefaultStyles",popupWidth:260,size:this.props.size,draggable:this.props.draggable||!1,onDragStart:this.props.onDragStart??Aa.Z,onDragEnd:this.props.onDragEnd??Aa.Z,onDrop:this.props.onDrop??Aa.Z,onDragEnter:this.props.onDragEnter??Aa.Z,onDragLeave:this.props.onDragLeave??Aa.Z,onDragOver:this.props.onDragOver??Aa.Z,mimeType:this.props.mimeType,name:this.props.name??""},void 0,Yp(Kp,{activeProfile:n,allProfiles:this.state.allProfiles,hidePopup:this.hidePopup,isLoggedIn:this.state.isLoggedIn,accountInfo:this.state.accountInfo}))):Qp}}const Jp=ta(qp);var eu,tu=n(13302);function nu(e,t,n,s){eu||(eu="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:eu,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const su=(e,t)=>Di.Z.isSingleKeyShortcut(e)?t?"singlefeatures":"single":"",iu=["shift+tab","tab","space","enter","left","right","up","down","pageup","pagedown","numlock","home","end","insert","del"],ou=["alt+shift+f4","alt+f4","shift+insert","ctrl+insert","shift+f10"];class au extends hs.Component{static contextType=xi.Z;refComboInput=hs.createRef();state={keyValue:this.props.command.shortcuts||[],selectedCombo:"",active:!1,duplicateCombo:null,systemReservedCombo:"",singleKeyWarning:!1};findExistingShortcut=(e,t)=>this.props.commandArray.filter((e=>e.shortcuts)).find((n=>n.shortcuts?.includes(e)&&n.feature===t));isTweakedShortcut=e=>(!this.props.command.shortcuts||!this.props.command.shortcuts.includes(e))&&Boolean(this.props.command.tweakedShortcut&&this.props.command.tweakedShortcut===e);restoreDefault=()=>{const e=H.Z.getDefault($.kActions)[0][this.props.command.name];if(e?.shortcuts)for(let t=0;t<e.shortcuts.length;t++){const n=this.findExistingShortcut(e.shortcuts[t],this.props.command.feature);if(n&&this.props.command.name!==n.name&&!this.isTweakedShortcut(e.shortcuts[t]))return void this.setState({duplicateCombo:{shortcut:(0,tu.$)(e.shortcuts[t]),label:n.label},systemReservedCombo:"",singleKeyWarning:!1})}this.setState({keyValue:e?.shortcuts??[]},this.save)};onClearComboButton=()=>{const{selectedCombo:e}=this.state,t=this.props.command.shortcuts;if(!e||!t)return void this.setState({keyValue:[]},this.save);const n=t.indexOf(e);if(n<0)return void this.setState({selectedCombo:""},this.save);const s=[...t.slice(0,n),...t.slice(n+1)];this.setState({keyValue:s,selectedCombo:s[n]||""},this.save)};onClearComboButtonMouseDown=e=>{e.preventDefault()};handleKeyEvent=e=>{const t=Di.Z.keyComboFromEvent(e.nativeEvent);if(!t)return;"tab"!==t&&"shift+tab"!==t&&e.preventDefault();const n=this.findExistingShortcut(t,this.props.command.feature);if("PageUp"!==e.nativeEvent.key&&"PageDown"!==e.nativeEvent.key||!e.nativeEvent.ctrlKey||e.preventDefault(),e.getModifierState("AltGraph"))return;const s=this.props.prefValues[$.kKeyboardShortcutsEnableSingleKey]||this.props.prefValues[$.kKeyboardShortcutsEnableSingleKeyForMail]&&["calendar","mail"].includes(this.props.command.feature),{selectedCombo:i}=this.state;if("backspace"===t||i&&"del"===t){let e=(this.props.command.shortcuts??[]).slice();if(i&&e)e.splice(e.indexOf(i),1);else if(e)if(s)e=e.slice(0,e.length-1);else for(let t=e.length-1;t>=0;t--)if(!Di.Z.isSingleKeyShortcut(e[t])){e.splice(t,1);break}this.setState({keyValue:e||[],duplicateCombo:null,systemReservedCombo:"",singleKeyWarning:!1},this.save),this.refComboInput.current?.focus()}else if(Di.Z.isSingleKeyShortcut(t)&&!s)this.setState({duplicateCombo:null,systemReservedCombo:"",singleKeyWarning:!0});else if(n&&!this.isTweakedShortcut(t))this.setState({duplicateCombo:{shortcut:(0,tu.$)(t),label:n.label},systemReservedCombo:"",singleKeyWarning:!1});else if(-1!==ou.indexOf(t))this.setState({systemReservedCombo:(0,tu.$)(t),duplicateCombo:null,singleKeyWarning:!1});else if(-1===iu.indexOf(t)){const e=this.props.command.shortcuts||[];this.setState({keyValue:e.slice().concat(t),duplicateCombo:null,systemReservedCombo:"",singleKeyWarning:!1},this.save)}else this.navigateWithArrowKeys(e)};navigateWithArrowKeys=e=>{let t=null;if(!this.state.keyValue||0===this.state.keyValue.length)return;const n=Di.Z.keyComboFromEvent(e.nativeEvent),{document:s,HTMLElement:i}=this.context,o=s.activeElement;switch(n){case"left":o&&(t=o.previousElementSibling);break;case"right":o&&(t=o.nextElementSibling);break;case"up":o&&o.parentNode&&(t=o.parentNode.firstChild);break;case"down":o&&o.parentNode&&(t=o.parentNode.lastChild)}t instanceof i&&(e.preventDefault(),e.stopPropagation(),t.focus())};save=()=>{v.Z.setShortcuts(this.props.command.name,this.state.keyValue)};onTextFocus=()=>{this.setState({active:!0})};onTextBlur=e=>{e.preventDefault(),e.stopPropagation(),this.setState({active:!1,duplicateCombo:null,systemReservedCombo:"",singleKeyWarning:!1}),this.save()};onButtonFocus=()=>{this.setState({active:!0})};onButtonBlur=e=>{e.preventDefault(),e.stopPropagation(),this.setState({active:!1,duplicateCombo:null,systemReservedCombo:"",singleKeyWarning:!1}),this.save()};onComboFocus=e=>{this.setState({selectedCombo:e.currentTarget.dataset.raw,active:!0})};onComboBlur=()=>{this.setState({selectedCombo:"",active:!1})};renderCombos=()=>{const e=this.props.command.shortcuts;if(Array.isArray(e)&&e.length>0){const t=["mail","calendar"].includes(this.props.command.feature);return e.map(((e,n)=>nu("button",{className:`multiinput-item ${su(e,t)}`,"data-raw":e,onFocus:this.onComboFocus,onBlur:this.onComboBlur,onKeyDown:this.handleKeyEvent},n,(0,tu.$)(e))))}return null};renderKeyboardShortcutEditSetting=()=>nu("div",{className:As()({controls:!0,active:this.state.active})},void 0,nu("div",{className:"multiinput"},void 0,nu("div",{className:"multiinput-group"},void 0,this.renderCombos(),(0,fs.jsx)("input",{type:"text",ref:this.refComboInput,id:this.props.id,defaultValue:"",onKeyDown:this.handleKeyEvent,onFocus:this.onTextFocus,onBlur:this.onTextBlur}))),nu("input",{type:"button",className:"circular restorekey",title:(0,Oe.Z)("Restore default shortcut"),onClick:this.restoreDefault,onFocus:this.onButtonFocus,onBlur:this.onButtonBlur}),nu("input",{type:"button",className:"circular clearkey",title:(0,Oe.Z)("Clear shortcut"),onMouseDown:this.onClearComboButtonMouseDown,onClick:this.onClearComboButton,onFocus:this.onButtonFocus,onBlur:this.onButtonBlur}),this.state.duplicateCombo&&nu("p",{className:"info"},void 0,(0,Oe.Z)("Shortcut $1 is already assigned to “$2” command.",[this.state.duplicateCombo.shortcut.toUpperCase(),this.state.duplicateCombo&&this.state.duplicateCombo.label])),this.state.systemReservedCombo&&nu("p",{className:"info"},void 0,(0,Oe.Z)("Shortcut $1 is reserved by the system.",[this.state.systemReservedCombo.toUpperCase()])),this.state.singleKeyWarning&&nu("p",{className:"info"},void 0,(0,Oe.Z)("Single Key Shortcuts are currently disabled.")));render(){return this.renderKeyboardShortcutEditSetting()}}const ru=au;var lu;function du(e,t,n,s){lu||(lu="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:lu,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class cu extends hs.PureComponent{static contextType=xi.Z;refComboInput=hs.createRef();state={commands:[],error:null};componentDidMount=()=>{this._initialSetup(),J.Z.addListener(this.onStoreChange)};componentWillUnmount=()=>{J.Z.removeListener(this.onStoreChange)};_initialSetup=()=>{this.setState({commands:J.Z.getSettingsList(!1)})};onStoreChange=()=>{this._initialSetup()};getCommand=()=>this.state.commands.find((e=>e.name===this.props.name));findExistingShortcut=e=>this.state.commands.filter((e=>e.shortcuts)).find((t=>t.shortcuts?.includes(e)));isDefault=()=>{const e=this.getCommand()?.shortcuts;if(void 0===e)return!0;const t=H.Z.getDefault($.kActions)[0][this.props.name]?.shortcuts;return!!t?.every(((t,n)=>t===e[n]))||void 0===t&&0===e.length};restoreDefault=()=>{const e=H.Z.getDefault($.kActions)[0][this.props.name];if(e.shortcuts)for(let t=0;t<e.shortcuts.length;t++){const n=e.shortcuts[t],s=this.findExistingShortcut(n);if(s&&s.name!==this.props.name)return void this.setState({error:(0,Oe.Z)("Shortcut $1 is already assigned to “$2” command.",[(0,tu.$)(n).toUpperCase(),s.label])})}const t=this.getCommand();t&&this.save(t,e.shortcuts||[])};handleKeyEvent=e=>{const t=this.getCommand();if(!t||["Escape","Tab"].includes(e.key)||e.getModifierState("AltGraph"))return void this.setState({error:null});e.preventDefault();const n=Di.Z.keyComboFromEvent(e.nativeEvent);if("Backspace"!==e.key){if(n){const e=this.findExistingShortcut(n);if(!H.Z.get($.kKeyboardShortcutsEnableSingleKey)&&Di.Z.isSingleKeyShortcut(n))this.setState({error:(0,Oe.Z)("Single Key Shortcuts are currently disabled.")});else if(e)this.setState({error:(0,Oe.Z)("Shortcut $1 is already assigned to “$2” command.",[(0,tu.$)(n).toUpperCase(),e.label])});else if(-1!==ou.indexOf(n)){const e=(0,tu.$)(n);this.setState({error:(0,Oe.Z)("Shortcut $1 is reserved by the system.",[e.toUpperCase()])})}else-1===iu.indexOf(n)&&this.setState({error:null},(()=>{const e=(t.shortcuts||[]).concat(n);this.save(t,e,(()=>{this.refComboInput.current?.focus()}))}))}}else{const e=t.shortcuts?.slice(0,t.shortcuts.length-1);e&&this.setState({error:null},(()=>{this.save(t,e)}))}};deleteCombo=(e,t,n,s)=>{const{HTMLElement:i}=this.context,o=n.filter(((e,t)=>t!==s));if("Delete"===e.key){const n=e.currentTarget.nextElementSibling;this.save(t,o,(()=>{n instanceof i&&n.focus()}))}else if("Backspace"===e.key&&n){const n=e.currentTarget.previousElementSibling||e.currentTarget.nextElementSibling;this.save(t,o,(()=>{n instanceof i&&n.focus()}))}else this.handleKeyEvent(e)};save=(e,t,n)=>{const{name:s}=e;this.setState({error:null},(()=>{v.Z.setShortcuts(s,t),n&&n()}))};render(){const e=this.getCommand(),t=e&&Array.isArray(e.shortcuts)&&e.shortcuts;return(0,fs.jsxs)(fs.Fragment,{children:[du("div",{className:"SingleShortcut-Toolbar toolbar toolbar-default"},void 0,du("div",{className:"multiinput"},void 0,du("div",{className:"multiinput-group"},void 0,e&&t&&t.map(((n,s)=>du("button",{style:{textTransform:"capitalize"},className:"multiinput-item",onKeyDown:n=>{this.deleteCombo(n,e,t,s)}},n,(0,tu.$)(n)))),(0,fs.jsx)("input",{type:"text",ref:this.refComboInput,placeholder:t&&0===t.length&&this.props.placeholder||null,onKeyDown:this.handleKeyEvent}))),du(Fa,{onClick:this.restoreDefault,image:Ts.GO5.medium,disabled:void 0!==e&&this.isDefault(),tooltip:(0,Oe.Z)("Restore default shortcut")})),this.state.error&&du("p",{className:"SingleShortcut-Error",dangerouslySetInnerHTML:{__html:Ts.Si$.small+this.state.error}})]})}}const hu=cu;var pu;function uu(e,t,n,s){pu||(pu="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:pu,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const gu=[$.kPrivacyBreakModeIntroductionShow];class mu extends hs.PureComponent{render(){return uu("div",{className:"popup-scrollarea"},void 0,uu("div",{className:"BreakModePopup--Graphic",dangerouslySetInnerHTML:{__html:Ts.Gvk.large}}),uu("h1",{},void 0,(0,Oe.Z)("Take a Break")),uu("p",{className:"BreakModePopup-Intro"},void 0,(0,Oe.Z)("Vivaldi is fading content and pausing media. Focus elsewhere for a while.")),uu("h3",{},void 0,(0,Oe.Z)("Keyboard Shortcut")),uu(hu,{name:"COMMAND_BREAKMODE_TOGGLE",placeholder:(0,Oe.Z)("No shortcut assigned")}),uu("label",{},void 0,uu("input",{type:"checkbox",checked:!this.props.prefValues[$.kPrivacyBreakModeIntroductionShow],onChange:()=>{Ne.Z.toggle($.kPrivacyBreakModeIntroductionShow,!0,!1)}}),uu("span",{},void 0,(0,Oe.Z)("Do not show again"))))}}const vu=sa(mu,gu);var fu;function yu(e,t,n,s){fu||(fu="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:fu,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Cu=[$.kPrivacyBreakModeIntroductionShow];var wu=yu(vu,{});class bu extends hs.PureComponent{state={shouldShowPopup:pl.Z.getState().isActive&&this.props.prefValues[$.kPrivacyBreakModeIntroductionShow],isInBreakMode:pl.Z.getState().isActive};componentDidMount=()=>{this.props.inEditor||pl.Z.addListener(this.onBreakModeChanged)};componentWillUnmount=()=>{this.props.inEditor||pl.Z.removeListener(this.onBreakModeChanged)};onBreakModeChanged=()=>{const e=pl.Z.getState().isActive,t=e&&this.props.prefValues[$.kPrivacyBreakModeIntroductionShow];this.setState({isInBreakMode:e,shouldShowPopup:t})};hidePopup=()=>{this.setState({shouldShowPopup:!1})};menu=()=>[{type:"checkbox",checked:this.props.prefValues[$.kPrivacyBreakModeIntroductionShow],handler:()=>{Ne.Z.toggle($.kPrivacyBreakModeIntroductionShow,!0,!1)},...(0,xs.Z)("Show Break Mode Introduction")}];render(){return yu(Fa,{className:"panel-clickoutside-ignore",tooltip:this.state.isInBreakMode?(0,Oe.Z)("End Break"):(0,Oe.Z)("Take a Break"),onClick:hl.Z.toggleBreakMode,customizeMenu:this.props.customizeMenu,menuOrigin:this.props.menuOrigin,image:this.state.isInBreakMode?Ts._qK[this.props.size]:Ts.Gvk[this.props.size],draggable:this.props.draggable,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,onDrop:this.props.onDrop,onDragEnter:this.props.onDragEnter,mimeType:this.props.mimeType,name:this.props.name,hidePopup:this.hidePopup,popupPosition:this.props.popupPosition,popupClassName:"BreakModePopup ToolbarButtonPopup-DefaultStyles",popupWidth:220,isPopupVisible:this.state.shouldShowPopup,menu:this.menu,size:this.props.size},void 0,wu)}}const Su=sa(bu,Cu);var Iu=n(48735),ku=n(6320);class Au extends F.Z{getInitialState(){return[]}getLogsByComponent(e){return this.getState().filter((t=>e.includes(t.component)))}reduce(e,t){switch(t.actionType){case"COMPONENT_LOGGER_LOG":{let n;return e.length>=1e3?(n=e.slice(1),n.push(t.entry)):n=e.concat(t.entry),n}case"COMPONENT_LOGGER_CLEAR":return e.filter((e=>e.component!==t.component))}return e}}const Tu=new Au;var Zu;function Eu(e,t,n,s){Zu||(Zu="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Zu,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const{mixedToStrings:_u}=Mh;function Mu(e){switch(e){case"warn":return"warning";case"log":return"info";default:return e}}function Nu(e){for(const t of e)if(t instanceof Error)return t}function Pu(e){const{component:t,tags:n,level:s,timestamp:i,args:o}=e,a=N()(i).format("HH:mm:ss.SSS"),r=_u(o).join(" "),l=`${a} ${s} [${t} - ${n.join(", ")}] ${r}\r\n`,d=Nu(o);return d?`${l}${d.stack}\r\n`:l}function Du(e){const t=hs.useContext(xi.Z);function n(){yi.Z.copyTextToClipboard(Pu(e.entry))}const{args:s,level:i,tags:o,timestamp:a}=e.entry,r=Nu(s);return Eu(tc,{type:Mu(i)},void 0,Eu("div",{className:"StatusPopup-LogEntryMessage","data-index":e.index,onContextMenu:function(e){(0,Qi.Z)(t,[{handler:n,...(0,xs.Z)("verb","Copy")}])(e)}},void 0,Eu("span",{className:"StatusPopup-LogEntryTags"},void 0,"[",o.join(", "),"]"),_u(s).join(" "),Eu("span",{className:"StatusPopup-LogEntryTimestamp"},void 0,!!r&&Eu("span",{className:"StatusPopup-LogEntryStacktrace",title:r.stack,dangerouslySetInnerHTML:{__html:Ts.AE4.small}}),N()(a).format("HH:mm:ss.SSS"))))}const xu=function(e){const{document:t}=hs.useContext(xi.Z);return(0,fs.jsxs)(fs.Fragment,{children:[0===e.logs.length&&Eu("div",{className:"StatusPopup-ContentPane StatusPopup-ContentPane--Empty"},void 0,Eu("span",{dangerouslySetInnerHTML:{__html:Ts.RXs}}),Eu("h1",{},void 0,(0,Oe.Z)("No Logs")),Eu("p",{className:"faded-text"},void 0,(0,Oe.Z)("No logs to show yet."))),0!==e.logs.length&&Eu("div",{className:"StatusPopup-List",tabIndex:e.logs.length?"-1":"0"},void 0,e.logs.map(((e,t)=>Eu(Du,{entry:e,index:t},e.timestamp+"__"+t)))),!e.hideButtons&&Eu("div",{className:"StatusPopup-Footer toolbar-default"},void 0,Eu(Fa,{onClick:function(){const n=t.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e.logs.map(Pu).join(""))),n.download=`Vivaldi_${e.component}_log.txt`,n.click()},disabled:0===e.logs.length,title:(0,Oe.Z)("Save to File")}),Eu(Fa,{onClick:function(){const t=e.logs.map(Pu).join("");yi.Z.copyTextToClipboard(t)},disabled:0===e.logs.length,title:(0,Oe.Z)("mail","Copy to Clipboard")}),Eu(Fa,{onClick:()=>r.Z.clear(e.component),disabled:0===e.logs.length,title:(0,Oe.Z)("Clear")}))]})};var Ou,Lu=n(24522),Ru=n(81723),Bu=n(58821),Fu=n(27856);function Vu(e,t,n,s){Ou||(Ou="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Ou,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Wu=new DOMParser;function Uu(e){const{start:t,end:n}=(0,Bu.aE)(e,!0);let s,i,o="";return e.allDay?(s=N().localeData().longDateFormat("LL"),i=N().localeData().longDateFormat("LL")):(s=(0,Bu.KC)(new Date,new Date(t.valueOf()||n.valueOf()))?"LT":q.ZP.getShortDateFormat()+" LT",i="LT"),e.start&&e.end&&t.valueOf()===n.valueOf()?o=`${t.format(s)}`:e.start&&e.end?o=`${t.format(s)}-${n.format(i)}`:e.end&&(o=`${n.format(s)}`),o}function Hu(e){let t="";if(void 0!==e){t=`${N()(e).format("LT")}`}return t}const zu=(e,t,n,s)=>{let i=n.trim();if(!i)return null;const o=function(e){for(let t=0;t<e.length;t++)if("<"===e[t]){let n=0;for(let s=t+1;s<e.length;s++){const i=e[s];if("<"===i)n++;else if(">"===i){if(!n){if("/"===e[s-1]){t=s+1;break}{const n=e.slice(t+1,s),i=n.match(/\w+/i)?.[0];if(i){const n=`</${i}>`,o=e.indexOf(n,s);if(-1!==o){t=s+o+n.length+1;break}}e=`${e.slice(0,t)}&lt;${n}&gt;${e.slice(s+1)}`,t=s+6;break}}n--}if(s===e.length-1){e=`${e.slice(0,t)}&lt;${e.slice(t+1)}`;break}}}return e}(i);return i=function(e){return-1===e.indexOf("<")||Wu.parseFromString(e,"text/html").body?.innerText===e}(o)?(e=>{const t=e.match(/(\n|[^\r\n]+)/g);return t&&1!==t.length?t.map((e=>-1!==e.indexOf("\n")?"<br />":e.startsWith("-::")?`<p class="delimiter">${e}</p>`:`<p>${e}</p>`)).join(""):e})(mt(i)):(0,Fu.sanitize)(i,{FORBID_TAGS:["style"]}),(0,fs.jsx)("span",{ref:s,className:`cal-event-${t}`,onClick:t=>function(e,t){const n=t.target.closest("a");n&&t.currentTarget.contains(n)&&n.href&&(t.stopPropagation(),t.preventDefault(),d.ZP.openURL(e,n.href))}(e,t),dangerouslySetInnerHTML:{__html:i}},t)},Gu=(e,t,n,s)=>{const i=Bd.Z.getCalendars();if(0===i.length)return Vu("div",{},void 0,(0,Oe.Z)("You have no calendars set up, event can not be saved"));const o=e.calendarId??Rd.Z.getDefaultCalendar(e.task)?.id,a=i.find((e=>e.id===o))??i[0],r=Bd.Z.getAccounts().find((e=>e.id===a?.accountId));if(!r)return Vu("div",{},void 0,(0,Oe.Z)("Calendar account not found. Go to settings and add a calendar account."));if("ical"===r.account_type){const e=Rd.Z.createCalendarIcon(a,10);return Vu("div",{title:(0,Oe.Z)("Web Calendar: $1",[a.description||a.name])},void 0,Vu("span",{className:"calendar-dot",dangerouslySetInnerHTML:{__html:e}}),a.description||a.name)}const l=Bd.Z.getState().accounts.filter((e=>"ical"===e.account_type)).map((e=>e.id)),d=(0,Ru.Z)(Bd.Z.getVisibleCalendars(),l,((e,t)=>e.accountId===t)),c=d.find((e=>e.id===o))??d[0];if(!c){return Vu("p",{className:"info"},void 0,e.task?(0,Oe.Z)("No task list found. Please go to calendar settings to add one."):(0,Oe.Z)("No calendar found. Please go to calendar settings to add one."))}const h=e.task?d.filter((e=>e.supportedCalendarComponent?.vtodo)):d.filter((e=>e.supportedCalendarComponent?.vevent));return Vu(Fa,{className:"CalendarSelector",title:c.description||c.name,image:Rd.Z.createCalendarIcon(c,10),menu:()=>function(e){return e.map((e=>{const n=Rd.Z.createCalendarIconPNG(e);return{handler:()=>t(e.id),label:e.description||e.name,labelEnglish:e.description||e.name,iconPNG:n,iconPNGWhite:n}}))}(h),menuOrigin:"bottomLeft",tabIndex:n})};var $u,Ku=n(8336),ju=n(39980),Yu=n(76259),Xu=n.n(Yu);function Qu(e,t,n,s){$u||($u="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:$u,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function qu(e){return e.some((e=>"error"===e.level))}function Ju(e){switch(e.account_type){case"google":return`<img src="${ju.K}" />`;case"ical":case"caldav":return Ts.eTS.small;case"vivaldi":return Xu();default:return Ts.bcq.small}}function eg(e){const[t,n]=hs.useState({}),s=Bd.Z.getAccounts();async function i(e){!function(e){n((t=>({...t,[e.id]:{pending:!0,error:!1,success:!1,message:""}})))}(e);const t=await Iu.Z.pollCalDAV([e.id]),s=Rd.Z.getPollResultText(t);!function(e,t,s){n((n=>({...n,[e.id]:{pending:!1,success:!t,error:t,message:s}})))}(e,t.error,s)}return(0,fs.jsxs)(fs.Fragment,{children:[Qu("div",{className:"StatusPopup-List"},void 0,s.map((e=>{const n=Bd.Z.getCalendars().filter((t=>t.accountId===e.id)),s=Math.max(...n.map((e=>e.lastChecked)).filter(Boolean));return Qu(hs.Fragment,{},e.id,Qu("div",{className:"StatusPopup-Account"},void 0,Qu("span",{className:"StatusPopup-AccountIcon",dangerouslySetInnerHTML:{__html:Ju(e)}}),Qu("span",{className:As()("StatusPopup-AccountName",{"StatusPopup-AccountName--Local":"local"===e.account_type})},void 0,e.name),"local"!==e.account_type&&Qu("div",{className:"StatusPopup-AccountStatus"},void 0,t[e.id]?.pending&&Qu("span",{className:"spinner",dangerouslySetInnerHTML:{__html:Ts.H0I}}),t[e.id]?.error&&Qu("span",{className:"StatusPopup-AccountStatus--Error",title:t[e.id].message,dangerouslySetInnerHTML:{__html:Ts.viW}}),t[e.id]?.success&&Qu("span",{className:"StatusPopup-AccountStatus--Success",title:t[e.id].message,dangerouslySetInnerHTML:{__html:Ts.JLz}}),Qu(Fa,{onClick:()=>i(e),title:(0,Oe.Z)("Refresh")})),n.map((e=>{const t=Rd.Z.createCalendarIcon(e,8);return Qu(hs.Fragment,{},e.id,Qu("span",{className:"StatusPopup-CalendarIcon",dangerouslySetInnerHTML:{__html:t}}),Qu("span",{className:"StatusPopup-CalendarName"},e.id,e.description||e.name))})),"local"!==e.account_type&&Qu("div",{className:"StatusPopup-AccountPoll"},void 0,(0,Oe.Z)("Last Checked $1",[N()(s).fromNow()]))))}))),Qu("div",{className:"StatusPopup-Footer toolbar-default"},void 0,Qu(Fa,{onClick:()=>async function(e){for(const t of e)await i(t)}(s),title:(0,Oe.Z)("Refresh All")}))]})}var tg=Qu("dt",{},void 0,"Id"),ng=Qu("dt",{},void 0,"Date"),sg=Qu("dt",{},void 0,"UID"),ig=Qu("dt",{},void 0,"Sequence"),og=Qu("dt",{},void 0,"Recurrence"),ag=Qu("dt",{},void 0,"Exceptions"),rg=Qu("div",{className:"StatusPopup-Footer"});function lg(e){const{selectedEvent:t}=e;return(0,fs.jsxs)(fs.Fragment,{children:[0===e.events.length&&Qu("div",{className:"StatusPopup-ContentPane StatusPopup-ContentPane--Empty"},void 0,Qu("span",{dangerouslySetInnerHTML:{__html:Ts.g1e}}),Qu("h1",{},void 0,(0,Oe.Z)("No Events")),Qu("p",{className:"faded-text"},void 0,(0,Oe.Z)("Get started by creating a new event.")),Qu("input",{type:"button",className:"primary",value:(0,Oe.Z)("New Event"),onClick:()=>m.Z.showAddEvent(e.windowId,"","")})),e.events.length>0&&(0,fs.jsxs)(fs.Fragment,{children:[Qu("h3",{},void 0,(0,Oe.Z)("Upcoming Events")),Qu("div",{className:"StatusPopup-List"},void 0,e.events.slice(0,5).map((t=>{const n=Rd.Z.getEventColors(t.calendarId);return Qu("button",{tabIndex:H.Z.get($.kKeyboardTabToAll),className:As()("StatusPopup-Event",{"StatusPopup-Event--AllDay":t.allDay}),onClick:()=>{Ae.Z.showCalendar(e.windowId,t.id),e.hidePopup()},style:n},Rd.Z.generateKey(t),Qu("span",{className:"StatusPopup-EventIcon",dangerouslySetInnerHTML:{__html:Rd.Z.getEventSquircle()}}),Qu("span",{className:"StatusPopup-EventDate"},void 0,Uu(t)),Qu("span",{className:"StatusPopup-EventTitle"},void 0,t.title))})))]}),t&&Qu("dl",{className:"StatusPopup-EventDetail"},void 0,Qu("dt",{},void 0,(0,Oe.Z)("Selected")),Qu("dd",{},void 0,t.title),tg,Qu("dd",{},void 0,t.id),ng,Qu("dd",{},void 0,`${N()(t.start).format("l LT")} - ${N().duration(t.start-t.end).humanize()}`),sg,Qu("dd",{},void 0,t.uid),ig,Qu("dd",{},void 0,t.sequence),t.rrule&&(0,fs.jsxs)(fs.Fragment,{children:[og,Qu("dd",{},void 0,t.rrule),ag]}),!!t.recurrenceExceptions?.length&&(0,fs.jsx)(fs.Fragment,{children:Qu("dd",{},void 0,t.recurrenceExceptions.map(((e,t)=>Qu("p",{},t,!!e.date&&`${N()(e.date).format("l LT")}`,` Cancel: ${e.cancelled?.toString()??"false"}`,!!e.exception_event_id&&"0"!==e.exception_event_id&&` Exc. Id: ${e.exception_event_id}`))))})),rg]})}function dg(e){const t=Bd.Z.getVisibleEvents();let n;const s=ie.ZP.getActivePage(e)?.id;if(void 0!==s){const e=ku.Z.getStateForPage(s).selectedEvent;e&&(n=Bd.Z.getEvent(e),n?.trash&&(n=void 0))}return{upcomingEvents:Ku.CP.call(t).sort(((e,t)=>(e.start||e.end)-(t.start||t.end))),selectedEvent:n}}class cg extends hs.PureComponent{static contextType=xi.Z;#p;constructor(e,t){super(e);const n=Tu.getLogsByComponent(["Calendar","oAuth"]);this.state={...dg(t.vivaldiWindowId),selectedPane:e.requestPane?e.requestPane:H.Z.get($.kCalendarStatusSelectedPane),logs:n,hasLoggedError:qu(n)}}componentDidMount(){Bd.Z.addListener(this._onStoreChange),Tu.addListener(this._onLogsUpdated),this.#p=setInterval((()=>this._onStoreChange()),Lu.lb)}componentWillUnmount(){Tu.removeListener(this._onLogsUpdated),this.#p&&clearInterval(this.#p),Bd.Z.removeListener(this._onStoreChange)}_onLogsUpdated=()=>{const e=Tu.getLogsByComponent(["Calendar","oAuth"]);this.setState({logs:e,hasLoggedError:qu(e)})};_onStoreChange=()=>{this.setState(dg(this.context.vivaldiWindowId))};_selectPane=e=>{Ne.Z.set($.kCalendarStatusSelectedPane,e),this.setState({selectedPane:e})};_viewLog=()=>{C.Z.devtoolsPrivate.toggleDevtools(this.context.vivaldiWindowId,"console"),this.props.hidePopup()};_startChangeListeners=()=>{m.Z.startAPIChangeListeners(),this.props.hidePopup()};openCalendarSettings=()=>{Ae.Z.showSettings(this.context.vivaldiWindowId,"calendar"),this.props.hidePopup()};getContextMenu=()=>[{handler:this.openCalendarSettings,...(0,xs.Z)("Calendar Settings")},{handler:this._viewLog,...(0,xs.Z)("View Log")},{handler:this._startChangeListeners,...(0,xs.Z)("Start Calendar Change Listeners")}];render(){return(0,fs.jsxs)(fs.Fragment,{children:[Qu("div",{className:"StatusPopup-Header"},void 0,Qu("h2",{},void 0,(0,Oe.Z)("Calendar Status")),Qu("div",{className:"toolbar button-popup-header-toolbar toolbar-default"},void 0,Qu(Fa,{onClick:()=>{Ae.Z.showCalendar(this.context.vivaldiWindowId),this.props.hidePopup()},menuOrigin:"bottomLeft",title:(0,Oe.Z)("Show Calendar")}),Qu(Fa,{menuOrigin:"bottomLeft",image:Ts.bqs.small,menu:this.getContextMenu,tooltip:(0,Oe.Z)("Settings")}))),Qu("div",{className:"toolbar toolbar-default"},void 0,Qu("div",{className:"toolbar-group equal-width"},void 0,Qu(Fa,{title:(0,Oe.Z)("Events"),isPressed:"events"===this.state.selectedPane,onClick:()=>this._selectPane("events")}),Qu(Fa,{title:(0,Oe.Z)("Accounts"),isPressed:"accounts"===this.state.selectedPane,onClick:()=>this._selectPane("accounts")}),Qu(Fa,{title:(0,Oe.Z)("Logs"),isPressed:"logs"===this.state.selectedPane,onClick:()=>this._selectPane("logs"),badgeText:this.state.hasLoggedError?"!":""}))),Qu("div",{className:"StatusPopup-Content"},void 0,Qu("div",{className:"StatusPopup-ContentPane"},void 0,"accounts"===this.state.selectedPane&&Qu(eg,{windowId:this.context.vivaldiWindowId}),"events"===this.state.selectedPane&&Qu(lg,{windowId:this.context.vivaldiWindowId,events:this.state.upcomingEvents,selectedEvent:this.state.selectedEvent,hidePopup:this.props.hidePopup}),"logs"===this.state.selectedPane&&Qu(xu,{logs:this.state.logs,component:"Calendar"})))]})}}const hg=cg;const pg=new class{open(e,t){y.Z.dispatch({actionType:"STATUS_POPUP_OPEN",component:e,pane:t})}close(e){y.Z.dispatch({actionType:"STATUS_POPUP_CLOSE",component:e})}},ug={calendarPopupOpen:!1,mailPopupOpen:!1};class gg extends F.Z{getInitialState(){return ug}isOpen(e){switch(e){case"Calendar":return this.getState().calendarPopupOpen;case"Mail":return this.getState().mailPopupOpen}}reduce(e,t){switch(t.actionType){case"STATUS_POPUP_OPEN":return t.pane&&("Mail"===t.component?Ne.Z.set($.kMailStatusSelectedPane,t.pane):"Calendar"===t.component&&Ne.Z.set($.kCalendarStatusSelectedPane,t.pane)),{mailPopupOpen:"Mail"===t.component,calendarPopupOpen:"Calendar"===t.component};case"STATUS_POPUP_CLOSE":if(this.isOpen(t.component))return ug}return e}}const mg=new gg;var vg;function fg(e,t,n,s){vg||(vg="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:vg,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const yg=[$.kCalendarStatusButtonStyle,$.kMailIsTurnedOff];class Cg extends hs.PureComponent{static contextType=xi.Z;state={isPopupOpen:!1,lastPoll:0,hasErrors:!1};componentDidMount=()=>{this.props.inEditor||(mg.addListener(this.popupStateChanged),Tu.addListener(this.handleLogStoreChange))};componentWillUnmount=()=>{this.props.inEditor||(mg.removeListener(this.popupStateChanged),Tu.removeListener(this.handleLogStoreChange))};popupStateChanged=()=>{const e=mg.getState().calendarPopupOpen;this.setState({isPopupOpen:e})};hidePopup=()=>{this.setState({isPopupOpen:!1}),pg.close("Calendar")};togglePopup=()=>{this.setState((e=>({isPopupOpen:!e.isPopupOpen})))};openCalendarSettings=()=>{Ae.Z.showSettings(this.context.vivaldiWindowId,"calendar")};getTooltip=()=>(0,Oe.Z)("Calendar Status");calendarHasErrors=()=>Tu.getLogsByComponent(["Calendar","oAuth"]).some((e=>"error"===e.level));handleLogStoreChange=()=>{this.setState({hasErrors:this.calendarHasErrors()})};menu=()=>{const e=this.props.prefValues[$.kCalendarStatusButtonStyle];return[{handler:this.openCalendarSettings,...(0,xs.Z)("Calendar Settings")},{items:[{type:"checkbox",checked:"imageandtext"===e,handler:()=>Ne.Z.set($.kCalendarStatusButtonStyle,"imageandtext"),...(0,xs.Z)("Image and Text")},{type:"checkbox",checked:"image"===e,handler:()=>Ne.Z.set($.kCalendarStatusButtonStyle,"image"),...(0,xs.Z)("Image Only")},{type:"checkbox",checked:"text"===e,handler:()=>Ne.Z.set($.kCalendarStatusButtonStyle,"text"),...(0,xs.Z)("title","Text Only")}],...(0,xs.Z)("Button Style")}]};render(){if(!(this.props.inEditor||!this.props.prefValues[$.kMailIsTurnedOff]&&G.ZP.isMail(this.context.vivaldiWindowId)))return null;const e=this.props.prefValues[$.kCalendarStatusButtonStyle],t=!G.ZP.isMail(this.context.vivaldiWindowId);return fg(Fa,{badgeText:this.state.hasErrors?"!":"",className:As()(this.state.hasErrors?"StatusButton--HasError":"StatusButton"),disabled:t,onClick:this.togglePopup,customizeMenu:this.props.customizeMenu,menuOrigin:this.props.menuOrigin,tooltip:this.getTooltip(),title:"image"!==e?(0,Oe.Z)("Calendar Status"):void 0,image:"text"!==e?Ts.bcq[this.props.size]:void 0,draggable:this.props.draggable,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,onDrop:this.props.onDrop,onDragEnter:this.props.onDragEnter,mimeType:this.props.mimeType,name:this.props.name,hidePopup:this.hidePopup,popupPosition:this.props.popupPosition,popupClassName:"StatusPopup",popupWidth:400,isPopupVisible:this.state.isPopupOpen,menu:this.menu,size:this.props.size},void 0,fg(hg,{hidePopup:this.hidePopup,requestPane:this.state.hasErrors?"logs":void 0}))}}const wg=sa(Cg,yg),bg={getTimeFormat:()=>H.Z.get($.kClockShowSeconds)?"LTS":"LT",getDateFormat:()=>q.ZP.getShortDateFormat(),getTimeAndDateFormat:()=>bg.getDateFormat()+" "+bg.getTimeFormat(),setTimer:(e,t)=>{const n=new Date;if(e.date<n){const t=new Date(e.date);t.setDate(t.getDate()+1),e.date=t.valueOf()}Ne.Z.set($.kClockTimers,[...H.Z.get($.kClockTimers),{...e,type:t,id:crypto.randomUUID()}])},removeTimer:e=>{const t=H.Z.get($.kClockTimers).filter((t=>e!==t.id));Ne.Z.set($.kClockTimers,t)},removeExpiredTimers:e=>{const t=H.Z.get($.kClockTimers).filter((t=>e<t.date));Ne.Z.set($.kClockTimers,t)},completeTimer:e=>{const t=H.Z.get($.kClockNotificationSound),n={title:bg.getName(e),body:bg.getTime(e),silent:!1,tag:`VIVALDI_CLOCK_TIMER_${bg.getName(e)}`};if(t){new Audio(t).play()}(0,Ke.c)(n)},getName:e=>e.name||("alarm"===e.type?(0,Oe.Z)("Alarm"):(0,Oe.Z)("Countdown")),getTime:e=>N()(e.date).format("LTS"),getActiveLabel:(e,t)=>{const n=N()(e.date),s=N().duration(n.diff(new Date)),i=s.hours(),o=s.minutes();let a;if("alarm"===e.type)a=n.format("LT");else if(i&&o)a=(0,Oe.Z)("$1h $2m",[i,o]);else if(i)a=(0,Oe.Z)("$1h",[i]);else if(o)a=(0,Oe.Z)("$1m",[o]);else{const e=s.seconds();a=(0,Oe.Z)("$1s",[e])}if(t){return`${a} - ${bg.getName(e)}`}return a},getAlarm:e=>H.Z.get($.kClockTimers).find((t=>t.id===e&&"alarm"===t.type)),setAlarmWithPreset:e=>{const t=new Date;t.setSeconds(0),t.setHours(e.hour),t.setMinutes(e.minute);const n={name:e.name,date:t.valueOf()};bg.setTimer(n,"alarm")},getAlarmPreset:e=>H.Z.get($.kClockAlarmPresets).find((t=>t.id===e)),saveAlarmPreset:(e,t,n)=>{const s=crypto.randomUUID();Ne.Z.set($.kClockAlarmPresets,[...H.Z.get($.kClockAlarmPresets),{name:e,hour:t,minute:n,id:s}])},removeAlarmPreset:e=>{const t=H.Z.get($.kClockAlarmPresets).filter((t=>t.id!==e));Ne.Z.set($.kClockAlarmPresets,t)},getCountdown:e=>H.Z.get($.kClockTimers).find((t=>t.id===e&&"countdown"===t.type)),setCountdownWithPreset:e=>{const t=new Date,n={name:e.name,date:t.setSeconds(t.getSeconds()+e.seconds).valueOf()};bg.setTimer(n,"countdown")},getCountdownPreset:e=>H.Z.get($.kClockCountdownPresets).find((t=>t.id===e)),saveCountdownPreset:(e,t)=>{const n=crypto.randomUUID();Ne.Z.set($.kClockCountdownPresets,[...H.Z.get($.kClockCountdownPresets),{name:e,seconds:t,id:n}])},removeCountdownPreset:e=>{const t=H.Z.get($.kClockCountdownPresets).filter((t=>t.id!==e));Ne.Z.set($.kClockCountdownPresets,t)}},Sg=bg;var Ig,kg=n(34155);function Ag(e,t,n,s){Ig||(Ig="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Ig,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Tg=["hour","minute","meridiem"],Zg=function(e){return 1===e.length?`0${e}`:e.length>2?e.slice(e.length-2):e};class Eg extends hs.PureComponent{static contextType=xi.Z;#u=!1;hidden=hs.createRef();fieldRefs={hour:hs.createRef(),minute:hs.createRef(),meridiem:hs.createRef()};hr12="";constructor(e){super(e);const t=this.getFormat(),n=t.match(/a/i)?.[0];n&&(this.hr12=n),this.separator=t.match(/h+([^m]*)m+/i)?.[1]??":";const[s="",i=""]=this.props.value.split(":");this.state={hour:s,minute:i,dateCache:N()(`2010-10-20 ${this.props.value}`)}}componentDidUpdate(e){e.value!==this.props.value&&this.setCache()}getFormat=()=>this.props.format||N()().localeData().longDateFormat("LT");setCache=()=>{const[e="",t=""]=this.props.value.split(":");this.setState({hour:e,minute:t,dateCache:N()(`2010-10-20 ${this.props.value}`)})};processChange=e=>{1!==this.state.hour.length&&1!==this.state.minute.length&&this.props.onChange(e)};select=e=>{e.target instanceof this.context.HTMLInputElement&&(e.preventDefault(),e.target.select())};focus=()=>{this.fieldRefs.hour.current?.focus()};onKeyDown=e=>{const{key:t,target:n}=e,s=n.dataset.type;if(t){const n=Tg.indexOf(s);switch(t){case"ArrowRight":e.preventDefault();const t=n+1===Tg.length?n:n+1;return void this.fieldRefs[Tg.slice(t,t+1)[0]].current?.select();case"ArrowLeft":e.preventDefault();const s=0===n?n:n-1;return void this.fieldRefs[Tg.slice(s,s+1)[0]].current?.select();case"ArrowDown":return void(e.altKey&&(e.preventDefault(),this.hidden.current?.showPicker()))}}isNaN(Number(t))&&kg.nextTick((()=>{const{document:e,HTMLInputElement:t}=this.context;e.activeElement instanceof t&&e.activeElement.select()}))};skipToNextField(e){const{document:t}=this.context,n=this.hr12?3:2,s=Tg.indexOf(e)+1;s===n&&H.Z.get($.kCalendarAutoTabDatetime)?kg.nextTick((()=>ol(t))):kg.nextTick((()=>{const e=Tg[Math.min(s,n-1)];this.fieldRefs[e].current?.select()}))}switchMeridiem=e=>{const{document:t}=this.context,{target:n}=e,s="string"==typeof e.key?e.key:"",i=this.state.dateCache.set("minute",parseInt(this.state.minute)).add(12,"hour"),{type:o}=e.target.dataset;"meridiem"===o&&("ArrowUp"===s||"ArrowDown"===s||"wheel"===e.type&&n===t.activeElement||s.toLowerCase()===i.format("a")[0].toLowerCase())&&(e.preventDefault(),this.setInput(i),this.setState({dateCache:i})),"a"!==s.toLowerCase()&&"p"!==s.toLowerCase()?this.onKeyDown(e):this.skipToNextField("meridiem")};onChangeTime=e=>{const{type:t}=e.target.dataset;let n=parseInt(e.target.value);const s=!e.nativeEvent.inputType,i=s&&this.props.step?parseInt(this.props.step):1;let o=!1;if(s&&"minute"===t&&n%i!=0){const e=parseInt(this.state.minute);o=!0,n<e?n=e-n%i:n-=n%i}const a="minute"===t?59:this.hr12?12:23,r="minute"===t?60:this.hr12?12:24;n>a?s?n%=r:this.hr12&&"hour"===t?(n%=r,this.state.dateCache.hour(n+12)):n=a:n<0&&(n=s?(n+r)%r:0);let l=n.toString();s&&(l=Zg(l)),o&&e.target.setAttribute("value",l),!s&&(10*n>a||e.target.value.length>=2)&&(l=Zg(l),this.skipToNextField(t)),this.setState({[t]:l},(()=>{let{hour:e}=this.state;this.hr12&&parseInt(e)<12&&"pm"===this.state.dateCache.format(this.hr12).toLowerCase()&&(e=parseInt(e)+12);const t=N()(this.state.dateCache).set("hour",parseInt(e)).set("minute",parseInt(this.state.minute));t.isValid()&&this.setInput(t)}))};setInput=e=>{const t=this.hidden.current,n=(Object.getOwnPropertyDescriptor(HTMLInputElement.prototype,"value")||{}).set;t&&n&&(n.call(t,(0,q.mr)(e)),t.dispatchEvent(new Event("input",{bubbles:!0})))};onFocus=e=>{e.persist(),e.preventDefault();const{document:t,HTMLElement:n}=this.context;if(this.#u||!(e.target instanceof n))return;const s=e.target.closest(".dateInput");kg.nextTick((()=>{this.props.onFocus&&s instanceof n&&sl(t,s)&&(this.#u=!0,this.props.onFocus(e))}))};onBlur=e=>{const{hour:t,minute:n}=this.state;(t.length<2||n.length<2)&&this.setState({hour:Zg(t),minute:Zg(n)}),e.preventDefault(),e.persist();const s=e.target.closest(".dateInput");kg.nextTick((()=>{const{document:t,HTMLElement:n}=this.context;this.props.onBlur&&s instanceof n&&!sl(t,s)&&(this.#u=!1,this.props.onBlur(e))}))};keepFocusWithin=e=>{e.preventDefault(),sl(this.context.document,e.target.nextElementSibling)||this.focus()};forceTimePicker=e=>{e.preventDefault(),this.hidden.current?.showPicker()};renderFields=()=>{const e=this.getFormat().replace(/[hma:]/gi,""),t={onFocus:this.select,onMouseDown:this.select,onMouseUp:e=>e.preventDefault(),onKeyDown:this.onKeyDown,onChange:this.onChangeTime,disabled:this.props.disabled};let n=this.state.hour;return 1!==n.length&&(n=this.hr12?Zg(((parseInt(this.state.hour)+11)%12+1).toString()):this.state.hour),Ag("span",{className:"faux time"},void 0,(0,fs.jsx)("input",{...t,className:"dateInputHour",tabIndex:this.props.tabIndex,type:"number",ref:this.fieldRefs.hour,"data-type":"hour",placeholder:(0,Oe.Z)("hh"),value:n}),Ag("span",{className:"dateInputSeparator"},void 0,this.separator),(0,fs.jsx)("input",{...t,className:"dateInputMinute",type:"number",ref:this.fieldRefs.minute,"data-type":"minute",tabIndex:this.props.tabIndex,step:this.props.step,placeholder:(0,Oe.Z)("time","mm"),value:this.state.minute}),this.hr12&&Ag("span",{},void 0,e),this.hr12&&(0,fs.jsx)("input",{...t,type:"text",ref:this.fieldRefs.meridiem,"data-type":"meridiem",className:"dateInputAmPm",tabIndex:this.props.tabIndex,placeholder:"--",value:this.state.dateCache.format(this.hr12).trim(),onKeyDown:this.switchMeridiem,onWheel:this.switchMeridiem,onChange:this.select}))};render(){return Ag("span",{className:"dateInput time",title:this.props.title,onBlur:this.onBlur,onFocus:this.onFocus},void 0,(0,fs.jsx)("input",{type:"time",ref:this.hidden,tabIndex:"-1",className:"dateInputHidden",value:this.props.value,disabled:this.props.disabled,onMouseDown:this.keepFocusWithin,onMouseUp:this.forceTimePicker,onChange:this.processChange}),this.renderFields(),Ag("span",{className:"arrowDown",dangerouslySetInnerHTML:{__html:Ts.uIM}}))}}const _g=Eg;var Mg;function Ng(e,t,n,s){Mg||(Mg="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Mg,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Pg=[$.kKeyboardTabToAll,$.kClockAlarmPresets,$.kClockTimers];class Dg extends hs.PureComponent{state={selectedPresetId:null,name:""};isPresetSelected=e=>e.id===this.state.selectedPresetId&&e.name===this.state.name&&this.props.minute===e.minute&&this.props.hour===e.hour;setAlarm=()=>{const e=this.state.name,t=new Date;t.setHours(this.props.hour),t.setMinutes(this.props.minute),t.setSeconds(0),this.setState({selectedPresetId:null,name:""},(()=>{this.props.hidePopup({name:e,date:t.valueOf()},"alarm")}))};setName=e=>{this.setState({name:e.currentTarget.value})};selectPreset=e=>{const t=e.name,n=e.id;this.props.setHour(e.hour),this.props.setMinute(e.minute),this.setState({name:t,selectedPresetId:n})};timeChange=e=>{const t=e.currentTarget.value.split(":"),n=parseInt(t[0]),s=parseInt(t[1]);this.props.setHour(n),this.props.setMinute(s)};savePreset=()=>{Sg.saveAlarmPreset(this.state.name,this.props.hour,this.props.minute)};setPreview=()=>{this.props.setMode("alarm")};render(){const e=this.props.prefValues[$.kClockAlarmPresets],t=this.state.selectedPresetId&&Sg.getAlarmPreset(this.state.selectedPresetId),n=this.props.alarms,s=new Date;s.setHours(this.props.hour),s.setMinutes(this.props.minute);const i=[],o=[];return n.forEach((e=>{this.props.now.valueOf()<e.date?i.push(e):o.push(e)})),Ng("div",{className:"ClockPopup-Alarms"},void 0,Ng("div",{className:"ClockPopup-Presets"},void 0,e.map((e=>{const n=t&&this.isPresetSelected(e);return Ng("div",{className:"ClockPopup-PresetWrapper"},e.id,Ng("button",{className:As()("ClockPopup-Preset",{"ClockPopup-Preset--selected":n}),tabIndex:this.props.prefValues[$.kKeyboardTabToAll],onClick:()=>this.selectPreset(e)},void 0,e.name),Ng("button",{className:As()("ClockPopup-Preset-Clear",{"ClockPopup-Preset-Clear--selected":n}),tabIndex:this.props.prefValues[$.kKeyboardTabToAll],onClick:()=>Sg.removeAlarmPreset(e.id),dangerouslySetInnerHTML:{__html:Ts.kze}}))}))),Ng("form",{className:"ClockPopup-Custom",onSubmit:this.setAlarm},void 0,Ng("div",{className:"ClockPopup-Custom-Line"},void 0,Ng("label",{className:"ClockPopup-TimeField"},void 0,Ng("h3",{},void 0,(0,Oe.Z)("Time")),Ng(_g,{className:"ClockPopup-DateInputField",onChange:this.timeChange,step:"5",title:(0,Oe.Z)("Alarm time"),onFocus:this.setPreview,value:N()(s).format("HH:mm"),noValidate:!0})),Ng("label",{className:"ClockPopup-TimeField"},void 0,Ng("h3",{},void 0,(0,Oe.Z)("Alarm preset","Name")),Ng("input",{className:"ClockPopup-Name",type:"text",onFocus:this.setPreview,placeholder:(0,Oe.Z)("Alarm preset","Name"),onChange:this.setName,value:this.state.name}))),Ng("div",{className:"ClockPopup-Custom-Line ClockPopup-Custom-Line--wrap"},void 0,Ng("input",{disabled:this.state.name.length<2||t&&t.name===this.state.name,className:"ClockPopup-SavePreset",type:"button",onClick:this.savePreset,value:(0,Oe.Z)("Save Preset")}),Ng("input",{className:"ClockPopup-Start",type:"submit",value:(0,Oe.Z)("verb","Set")}))))}}const xg=sa(Dg,Pg);var Og;function Lg(e,t,n,s){Og||(Og="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Og,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Rg=[$.kKeyboardTabToAll,$.kClockCountdownPresets,$.kClockTimers];class Bg extends hs.PureComponent{state={selectedPresetId:null,name:""};isPresetSelected=e=>{const t=60*this.props.minute+3600*this.props.hour;return e.id===this.state.selectedPresetId&&e.name===this.state.name&&t===e.seconds};setCountdown=()=>{const e=this.state.name,t=N()().add(this.props.hour,"hours").add(this.props.minute,"minutes").valueOf();this.setState({selectedPresetId:null,name:""},(()=>{this.props.hidePopup({name:e,date:t},"countdown")}))};setMinute=e=>{const{value:t}=e.currentTarget,n=Math.min(Math.max(parseInt(t),0),59);this.props.setMinute(n)};setHour=e=>{const{value:t}=e.currentTarget,n=Math.min(Math.max(parseInt(t),0),23);this.props.setHour(n)};decrementHour=()=>{this.props.setHour(this.props.hour-1)};incrementHour=()=>{this.props.setHour(this.props.hour+1)};decrementMinute=()=>{this.props.setMinute(this.props.minute-1)};incrementMinute=()=>{this.props.setMinute(this.props.minute+1)};setName=e=>{this.setState({name:e.currentTarget.value})};setPreview=()=>{this.props.setMode("countdown")};handleFocus=e=>{this.setPreview(),e.target.select()};selectPreset=e=>{const t=N().duration(e.seconds,"seconds"),n=e.name,s=t.hours(),i=t.minutes();this.props.setHour(s),this.props.setMinute(i),this.setState({name:n,selectedPresetId:e.id})};savePreset=()=>{const e=60*this.props.hour*60+60*this.props.minute;Sg.saveCountdownPreset(this.state.name,e)};render(){const e=this.props.prefValues[$.kClockCountdownPresets],t=this.state.selectedPresetId&&Sg.getCountdownPreset(this.state.selectedPresetId),n=this.props.countdowns,s=[],i=[];return n.forEach((e=>{this.props.now.valueOf()<e.date?s.push(e):i.push(e)})),Lg("div",{className:"ClockPopup-Countdowns"},void 0,Lg("div",{className:"ClockPopup-Presets"},void 0,e.map((e=>{const n=t&&this.isPresetSelected(e);return Lg("div",{className:"ClockPopup-PresetWrapper"},e.id,Lg("button",{className:As()("ClockPopup-Preset",{"ClockPopup-Preset--selected":n}),tabIndex:this.props.prefValues[$.kKeyboardTabToAll],onClick:()=>this.selectPreset(e)},void 0,e.name),Lg("button",{className:As()("ClockPopup-Preset-Clear",{"ClockPopup-Preset-Clear--selected":n}),tabIndex:this.props.prefValues[$.kKeyboardTabToAll],onClick:()=>Sg.removeCountdownPreset(e.id),dangerouslySetInnerHTML:{__html:Ts.kze}}))}))),Lg("form",{className:"ClockPopup-Custom",onSubmit:this.setCountdown},void 0,Lg("div",{className:"ClockPopup-Custom-Line"},void 0,Lg("label",{className:"ClockPopup-TimeField"},void 0,Lg("h3",{},void 0,(0,Oe.Z)("Hours")),Lg("input",{className:"ClockPopup-DateInputField",type:"number","data-type":"hour",step:1,min:0,max:23,onFocus:this.handleFocus,placeholder:(0,Oe.Z)("hh"),onChange:this.setHour,value:this.props.hour}),Lg("div",{className:"ClockPopup-Spinner-Wrapper"},void 0,Lg("button",{tabIndex:this.props.prefValues[$.kKeyboardTabToAll],disabled:23===this.props.hour,onClick:this.incrementHour,type:"button",className:"ClockPopup-Spinner ClockPopup-Spinner--up"}),Lg("button",{tabIndex:this.props.prefValues[$.kKeyboardTabToAll],disabled:0===this.props.hour,type:"button",onClick:this.decrementHour,className:"ClockPopup-Spinner ClockPopup-Spinner--down"}))),Lg("label",{className:"ClockPopup-TimeField"},void 0,Lg("h3",{},void 0,(0,Oe.Z)("Minutes")),Lg("input",{className:"ClockPopup-DateInputField",type:"number","data-type":"minute",step:1,min:0,max:59,placeholder:(0,Oe.Z)("time","mm"),onChange:this.setMinute,onFocus:this.handleFocus,value:this.props.minute}),Lg("div",{className:"ClockPopup-Spinner-Wrapper"},void 0,Lg("button",{tabIndex:this.props.prefValues[$.kKeyboardTabToAll],disabled:59===this.props.minute,onClick:this.incrementMinute,type:"button",className:"ClockPopup-Spinner ClockPopup-Spinner--up"}),Lg("button",{tabIndex:this.props.prefValues[$.kKeyboardTabToAll],disabled:0===this.props.minute,onClick:this.decrementMinute,type:"button",className:"ClockPopup-Spinner ClockPopup-Spinner--down"}))),Lg("label",{className:"ClockPopup-TimeField"},void 0,Lg("h3",{},void 0,(0,Oe.Z)("Countdown preset","Name")),Lg("input",{className:"ClockPopup-Name",type:"text",placeholder:(0,Oe.Z)("Countdown preset","Name"),onChange:this.setName,onFocus:this.handleFocus,value:this.state.name}))),Lg("div",{className:"ClockPopup-Custom-Line ClockPopup-Custom-Line--wrap"},void 0,Lg("input",{disabled:this.state.name.length<2||t&&t.name===this.state.name,className:"ClockPopup-SavePreset",type:"button",onClick:this.savePreset,value:(0,Oe.Z)("Save Preset")}),Lg("input",{disabled:0===this.props.hour&&0===this.props.minute,className:"ClockPopup-Start",type:"submit",value:(0,Oe.Z)("Start")}))))}}const Fg=sa(Bg,Rg);var Vg;function Wg(e,t,n,s){Vg||(Vg="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Vg,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ug=[$.kKeyboardTabToAll,$.kClockShowSeconds,$.kClockMode];class Hg extends hs.PureComponent{constructor(e){super(e),this.state={alarmHour:13,alarmMinute:37,countdownHour:0,countdownMinute:0,previewMode:"alarm"===this.props.prefValues[$.kClockMode]?"alarm":"countdown"}}setAlarmHour=e=>{this.setState({alarmHour:e})};setAlarmMinute=e=>{this.setState({alarmMinute:e})};setCountdownHour=e=>{this.setState({countdownHour:e})};setCountdownMinute=e=>{this.setState({countdownMinute:e})};setMode=e=>{Ne.Z.set($.kClockMode,e),this.setState({previewMode:e})};setPreviewMode=e=>{this.setState({previewMode:e})};removePastTimers=()=>{Sg.removeExpiredTimers(this.props.now.valueOf())};getClockStyle=()=>{const e=this.props.now.getHours(),t=this.props.prefValues[$.kClockShowSeconds]?this.props.now.getSeconds():0,n=this.props.now.getMinutes(),s=n/60,i={"--hourDeg":(e+s)%12*30-90+"deg","--minuteDeg":6*n+"deg","--secondDeg":this.props.prefValues[$.kClockShowSeconds]?6*t+360*n+60*e*360+"deg":"0deg"};if("countdown"===this.state.previewMode&&(i["--hourPercent"]=this.state.countdownHour<12?this.state.countdownHour/.12:100,i["--minutePercent"]=this.state.countdownMinute/.6),"alarm"===this.state.previewMode){const t=this.state.alarmHour>e?this.state.alarmHour-e:this.state.alarmHour===e&&this.state.alarmMinute>n?0:this.state.alarmHour-e+24,o=t>0?t-s:0,a=this.state.alarmMinute>n?this.state.alarmMinute-n:this.state.alarmMinute-n+60;i["--hourPercent"]=o<12?o/.12:100,i["--minutePercent"]=a/.6}return i};getInfoText=e=>{const t=e.filter((e=>"alarm"===e.type)),n=e.filter((e=>"countdown"===e.type));return t.length>0&&n.length>0?(0,Oe.Z)("$1 alarm","$1 alarms",[t.length])+", "+(0,Oe.Z)("$1 countdown","$1 countdowns",[n.length]):t.length>0?(0,Oe.Z)("$1 alarm","$1 alarms",[t.length]):n.length>0?(0,Oe.Z)("$1 countdown","$1 countdowns",[n.length]):N()().format(Sg.getTimeAndDateFormat())};render(){const e=this.props.timers,t=e.filter((e=>this.props.now.valueOf()<e.date)),n=e.filter((e=>this.props.now.valueOf()>e.date));return(0,fs.jsxs)(fs.Fragment,{children:[Wg("div",{className:"ClockPopup-Header"},void 0,Wg("h2",{},void 0,(0,Oe.Z)("Clock")),Wg("div",{className:"info"},void 0,this.getInfoText(t))),Wg("div",{className:"popup-scrollarea"},void 0,Wg("div",{style:this.getClockStyle(),className:As()("ClockPopup-BigClock",{"ClockPopup-BigClock--ShowSeconds":this.props.prefValues[$.kClockShowSeconds]}),dangerouslySetInnerHTML:{__html:Ts.gep}}),Wg("div",{className:"ClockPopup-Active"},void 0,t.map(((e,t)=>Wg("div",{className:"ClockPopup-Timer ClockPopup-Timer--Active"},e.id,Wg("button",{className:"ClockPopup-Timer-Name"},void 0,Sg.getActiveLabel(e,!0)),Wg("button",{className:"ClockPopup-Timer-Clear",tabIndex:this.props.prefValues[$.kKeyboardTabToAll],onClick:()=>Sg.removeTimer(e.id),dangerouslySetInnerHTML:{__html:Ts.kze}}))))),n.length>0&&(0,fs.jsxs)(fs.Fragment,{children:[Wg("div",{className:"ClockPopup-Header"},void 0,Wg("h2",{},void 0,(0,Oe.Z)("Past Timers")),Wg("button",{tabIndex:this.props.prefValues[$.kKeyboardTabToAll],className:"ClockPopup-Timer-Name",onClick:this.removePastTimers},void 0,(0,Oe.Z)("timers","Clear All"))),Wg("div",{className:"ClockPopup-Passed"},void 0,n.map((e=>Wg("div",{className:"ClockPopup-Timer ClockPopup-Timer--Passed"},e.id,Wg("button",{tabIndex:this.props.prefValues[$.kKeyboardTabToAll],className:"ClockPopup-Timer-Name"},void 0,Sg.getName(e)),Wg("button",{className:"ClockPopup-Timer-Clear",tabIndex:this.props.prefValues[$.kKeyboardTabToAll],onClick:()=>Sg.removeTimer(e.id),dangerouslySetInnerHTML:{__html:Ts.kze}})))))]}),Wg("div",{className:"toolbar toolbar-default"},void 0,Wg("div",{className:"toolbar-group"},void 0,Wg(Fa,{title:(0,Oe.Z)("Countdown"),isPressed:"countdown"===this.props.prefValues[$.kClockMode],onClick:()=>this.setMode("countdown")}),Wg(Fa,{title:(0,Oe.Z)("Alarm"),isPressed:"alarm"===this.props.prefValues[$.kClockMode],onClick:()=>this.setMode("alarm")}))),"countdown"===this.props.prefValues[$.kClockMode]&&Wg(Fg,{now:this.props.now,hour:this.state.countdownHour,minute:this.state.countdownMinute,hidePopup:this.props.hidePopup,setHour:this.setCountdownHour,setMinute:this.setCountdownMinute,setMode:this.setPreviewMode,countdowns:e.filter((e=>"countdown"===e.type))}),"alarm"===this.props.prefValues[$.kClockMode]&&Wg(xg,{now:this.props.now,alarms:e.filter((e=>"alarm"===e.type)),hidePopup:this.props.hidePopup,hour:this.state.alarmHour,minute:this.state.alarmMinute,setHour:this.setAlarmHour,setMode:this.setPreviewMode,setMinute:this.setAlarmMinute}))]})}}const zg=sa(Hg,Ug);var Gg;function $g(e,t,n,s){Gg||(Gg="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Gg,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Kg=[$.kClockButtonShowDate,$.kClockButtonShowName,$.kClockButtonStyle,$.kClockAlarmPresets,$.kClockCountdownPresets,$.kClockNotificationSound,$.kClockShowSeconds,$.kClockTimers],jg={"":(0,Oe.Z)("other","None"),"../../resources/notification_ding.opus":(0,Oe.Z)("Ding"),"../../resources/notification_rooster.opus":(0,Oe.Z)("Rooster"),"../../resources/notification_tada.opus":(0,Oe.Z)("Tada")};class Yg extends hs.PureComponent{buttonRef=hs.createRef();constructor(e){super(e),this.now=new Date,this.state={isPopupOpen:!1,hour:this.now.getHours(),minute:this.now.getMinutes(),width:34},this.isVertical="left"===e.popupPosition||"right"===e.popupPosition}componentDidMount(){this.props.inEditor||(this.intervalRef=setInterval(this.heartbeat,1e3),this.isVertical&&this.recalculateWidth())}componentDidUpdate(e){this.isVertical&&e.prefValues!==this.props.prefValues&&this.recalculateWidth()}componentWillUnmount(){this.props.inEditor||clearInterval(this.intervalRef)}recalculateWidth=()=>{const e=this.buttonRef.current?.buttonRef?.getBoundingClientRect();e?.height&&this.setState({width:Math.round(Math.min(Math.max(34,e.height),160))})};heartbeat=()=>{this.now=new Date;const e=this.now.getMinutes(),t=this.now.getHours(),n=this.now.getSeconds();let s=!1;this.props.prefValues[$.kClockShowSeconds]&&(this.state.isPopupOpen||"image"!==this.props.prefValues[$.kClockButtonStyle])||"countdown"===this.getFirstTimer()?.type?(this.setState({minute:e+n/60}),s=!0):e===this.state.minute&&t===this.state.hour||(this.setState({hour:t,minute:e}),s=!0),this.props.prefValues[$.kClockTimers].forEach((t=>{Math.round(t.date/1e3)===Math.round(this.now.valueOf()/1e3)&&(s||this.setState({minute:e+n/60}),Sg.completeTimer(t))}))};getActiveTimers=()=>this.props.prefValues[$.kClockTimers].slice().sort(((e,t)=>e.date-t.date)).filter((e=>this.now.valueOf()<e.date));getFirstTimer=()=>this.getActiveTimers()[0];getActiveMode=()=>{const e=this.getFirstTimer();return e?e.type:"time"};hidePopup=(e,t)=>{this.state.isPopupOpen&&this.setState({isPopupOpen:!1},(()=>{e&&t&&Sg.setTimer(e,t)}))};togglePopup=()=>{this.setState((e=>({isPopupOpen:!e.isPopupOpen})))};getClockStyle=()=>{const e=this.getFirstTimer(),t=this.now.getHours(),n=this.now.getMinutes(),s={"--hourDeg":30*(t+n/60)+"deg","--minuteDeg":`${6*n+360*t}deg`,"--clockWidth":`${this.state.width}px`};if(e&&"countdown"===e.type){const t=N()(e.date).diff(this.now,"seconds"),n=N().duration(t,"seconds"),i=n.hours()%12/.12,o=0===n.minutes()&&0===i;s["--countdownHourPercent"]=i,s["--countdownMinutePercent"]=o?n.seconds()/.6:n.minutes()/.6,o&&(s["--countdownSeconds"]="rotate(calc(var(--minuteDeg) + 90deg)) scaleX(-1)")}return s};getButtonText=()=>{const e="image"!==this.props.prefValues[$.kClockButtonStyle],t=this.props.prefValues[$.kClockButtonShowDate],n=this.props.prefValues[$.kClockButtonShowName],s=this.getFirstTimer();let i="";if("countdown"!==s?.type&&(e&&t?i=N()(this.now).format(Sg.getTimeAndDateFormat()):e?i=N()(this.now).format(Sg.getTimeFormat()):t&&(i=N()(this.now).format(Sg.getDateFormat()))),e&&s){if("countdown"===s.type)return Sg.getActiveLabel(s,n);if(n)return(i?i+" – ":"")+Sg.getName(s)}return i};getTooltip=()=>{const e=this.getActiveTimers();let t=N()(this.now).format("LL LT");if(e.length>0){const n=e.filter((e=>"countdown"===e.type)),s=e.filter((e=>"alarm"===e.type));n.length>0&&(t+="\n\n"+(0,Oe.Z)("Countdowns"),n.forEach((e=>{t+="\n"+Sg.getActiveLabel(e,!0)}))),s.length>0&&(t+="\n\n"+(0,Oe.Z)("Alarms"),s.forEach((e=>{t+="\n"+Sg.getActiveLabel(e,!0)})))}return t};menu=()=>{const e=this.props.prefValues[$.kClockButtonStyle];return[{isVisible:()=>this.props.prefValues[$.kClockCountdownPresets].length>0,items:this.props.prefValues[$.kClockCountdownPresets].map((e=>({handler:()=>Sg.setCountdownWithPreset(e),...(0,xs.Z)(e.name)}))),...(0,xs.Z)("New Countdown")},{isVisible:()=>this.props.prefValues[$.kClockAlarmPresets].length>0,items:this.props.prefValues[$.kClockAlarmPresets].map((e=>({handler:()=>Sg.setAlarmWithPreset(e),...(0,xs.Z)(e.name)}))),...(0,xs.Z)("New Alarm")},{items:[{type:"checkbox",checked:"imageandtext"===e,handler:()=>Ne.Z.set($.kClockButtonStyle,"imageandtext"),...(0,xs.Z)("Image and Text")},{type:"checkbox",checked:"image"===e,handler:()=>Ne.Z.set($.kClockButtonStyle,"image"),...(0,xs.Z)("Image Only")},{type:"checkbox",checked:"text"===e,handler:()=>Ne.Z.set($.kClockButtonStyle,"text"),...(0,xs.Z)("title","Text Only")}],...(0,xs.Z)("Button Style")},{items:[{type:"checkbox",checked:this.props.prefValues[$.kClockButtonShowName],handler:()=>Ne.Z.set($.kClockButtonShowName,!0),...(0,xs.Z)("Show Name")},{type:"checkbox",checked:!this.props.prefValues[$.kClockButtonShowName],handler:()=>Ne.Z.set($.kClockButtonShowName,!1),...(0,xs.Z)("Time Only")}],...(0,xs.Z)("Button Label")},{items:Object.keys(jg).map((e=>{const t=jg[e];return{type:"checkbox",checked:this.props.prefValues[$.kClockNotificationSound]===e,handler:()=>Ne.Z.set($.kClockNotificationSound,e),...(0,xs.Z)(t)}})),...(0,xs.Z)("Notification Sound")},{type:"checkbox",checked:this.props.prefValues[$.kClockShowSeconds],handler:()=>Ne.Z.set($.kClockShowSeconds,!this.props.prefValues[$.kClockShowSeconds]),...(0,xs.Z)("Show Seconds")},{type:"checkbox",checked:this.props.prefValues[$.kClockButtonShowDate],handler:()=>Ne.Z.set($.kClockButtonShowDate,!this.props.prefValues[$.kClockButtonShowDate]),...(0,xs.Z)("Show Date")}]};render(){const e=this.props.prefValues[$.kClockTimers].slice().sort(((e,t)=>e.date-t.date)),t=this.getActiveMode(),n=this.getFirstTimer(),s=this.props.prefValues[$.kClockButtonStyle];return(0,fs.jsx)(Fa,{className:`ClockButton ClockButton--${t}`,isOn:"time"!==t,onClick:this.togglePopup,customizeMenu:this.props.customizeMenu,menuOrigin:this.props.menuOrigin,ref:this.buttonRef,tooltip:this.getTooltip(),title:this.getButtonText(),image:"text"!==s||this.props.preview?Ts.kY4[this.props.size]:void 0,draggable:this.props.draggable,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,onDrop:this.props.onDrop,onDragEnter:this.props.onDragEnter,mimeType:this.props.mimeType,name:this.props.name,popupWidth:210,hidePopup:this.hidePopup,popupPosition:this.props.popupPosition,popupClassName:"ClockPopup",isPopupVisible:this.state.isPopupOpen,menu:this.menu,style:this.getClockStyle(),size:this.props.size,children:$g(zg,{now:this.now,timers:e,firstTimer:n,hidePopup:this.hidePopup})})}}const Xg=sa(Yg,Kg);var Qg,qg=n(7153),Jg=n(33466),em=n(61667),tm=n(93245);function nm(e,t,n,s){Qg||(Qg="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Qg,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const sm={top:0,right:0,bottom:0,left:0},im={data:{fill:"var(--colorHighlightBg)",fillOpacity:.2,stroke:"var(--colorHighlightBg)",strokeWidth:2}},om={grid:{stroke:"var(--colorFgAlpha)"}};var am,rm=nm(qg.Z,{preserveAspectRatio:"none"}),lm=nm(Jg.Z,{standalone:!1,style:om,offsetY:-10}),dm=nm(Jg.Z,{dependentAxis:!0,standalone:!1,style:om,offsetX:-10});class cm extends hs.PureComponent{dataPointCounter=0;timeline=[];maxSpeed=.1;render(){if(this.props.speed>this.maxSpeed&&(this.maxSpeed=1.1*this.props.speed),this.timeline=(0,V.Uy)(this.timeline,(e=>{e.push({x:this.dataPointCounter++,y:this.props.speed}),e.length>300&&e.splice(0,1)})),this.timeline.length<=1)return null;const e={x:[this.timeline[0].x,Math.max(this.timeline.at(-1).x,5)],y:[0,this.maxSpeed]};return nm(em.Z,{height:50,padding:sm,domain:e,domainPadding:{x:[Math.abs(Math.min(300,this.timeline.length-300)),0]},scale:"linear",containerComponent:rm},void 0,lm,dm,nm(tm.Z,{data:this.timeline,interpolation:"linear",standalone:!1,style:im}))}}function hm(e,t,n,s){am||(am="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:am,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var pm=hm(jo,{type:"download-speed"});class um extends hs.PureComponent{static contextType=xi.Z;pathButtonTitle=(0,Oe.Z)("Show in File Manager");_openUrl=()=>{this.props.url&&d.ZP.openURL(this.context.vivaldiWindowId,(0,vs.q9)(this.props.url))};render(){const{node:e}=this.props,t="complete"===e?.state?e.totalBytes:e?.bytesReceived||0,n=e?fd(t):"",s=e?e.currentSpeed:0,i=e?fd(s)+"/s":"",o="in_progress"===e?.state;return(0,fs.jsx)(fs.Fragment,{children:hm("div",{className:"container"},void 0,hm("div",{className:"completed"},void 0,n),hm("div",{className:"speed"},void 0,i?(0,fs.jsxs)(fs.Fragment,{children:[pm,i]}):(0,Oe.Z)("Download Speed")),hm("div",{className:"chart"},void 0,hm(cm,{speed:s},this.props.finalName)),hm("div",{className:"actionbuttons"},void 0,this.props.canResumeDownload&&this.props.hasPausedTransfersSelected?hm("input",{type:"button",className:"action-button",value:(0,Oe.Z)("navigation","Resume"),tabIndex:this.props.tabIndex,onClick:this.props.onDownloadResume}):hm("input",{type:"button",className:"action-button",disabled:o,value:(0,Oe.Z)("navigation","Restart"),tabIndex:this.props.tabIndex,onClick:this._openUrl}),hm("input",{id:"show-in-folder-button",type:"button",className:"action-button",tabIndex:this.props.tabIndex,disabled:o,onClick:this.props.openFile,value:this.pathButtonTitle,title:this.pathButtonTitle})))})}}const gm=um;var mm;function vm(e,t,n,s){mm||(mm="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:mm,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const fm="in_progress",ym="complete",Cm="interrupted";function wm({item:e}){const t=e.state===fm,n=e.paused||e.state===Cm,s=e.bytesReceived/e.totalBytes,i=e.totalBytes&&e.state!==ym?100*s:100;return vm("progress",{style:{"--duration":Math.min(e.totalBytes/100,500)+"ms","--progress":s.toFixed(2)},className:As()("DownloadItem-ProgressBar",{"unknown-filesize":!e.totalBytes,visible:t,loading:!n}),value:i,max:100})}var bm,Sm;function Im(e,t,n,s){bm||(bm="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:bm,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function km({node:e}){const{bytesReceived:t=0,fileSize:n=1,startTime:s="",endTime:i=""}=e||{},o=(t/n*100).toFixed(0),a=!isNaN(parseInt(o)),r=N()(s),l=N()(i),d=r.isSame(l,"day");return Im("div",{className:"panel-timefield"},void 0,Im("div",{className:"container"},void 0,Im("div",{className:"started"},void 0,(0,Oe.Z)("Started:")),Im("div",{className:"started-time"},void 0,r.isValid()?r.format("l, LTS"):""),Im("div",{className:"completed"},void 0,i?(0,Oe.Z)("Finished:"):a&&(0,Oe.Z)("Completed:")),Im("div",{className:"progress"},void 0,l.isValid()?l.format(d?"LTS":"l, LTS"):e&&a&&(0,fs.jsxs)(fs.Fragment,{children:[o+"%",Im(wm,{item:e})]}))))}function Am(e,t,n,s){Sm||(Sm="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Sm,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Tm=(0,Oe.Z)("File Name");class Zm extends hs.Component{render(){const e=this.props.downloadItem,t=(e?.filename||"").split("\\").pop().split("/").pop(),n=e?.url||"",s=t.length?t:Tm,i=e&&e?.bytesReceived>0?this.props.getItemPath(e.id):"";return Am("div",{className:As()({data:!0,"downloads-cardwrapper":!0,cardview:!0,disabled:!e})},void 0,Am("div",{className:"downloads-panel-actions"},void 0,Am("span",{className:"download-panel title",title:s},void 0,s),Am("input",{type:"text",className:"cardview url downloads",tabIndex:this.props.keyAccess,placeholder:(0,Oe.Z)("File URL"),disabled:!e,value:n,title:n,readOnly:!0}),Am("input",{type:"text",className:"cardview url downloads",tabIndex:this.props.keyAccess,placeholder:(0,Oe.Z)("Local File"),disabled:!e,value:i,title:i,readOnly:!0})),Am(km,{node:e}),Am("div",{className:"panel-pathfield"},void 0,Am(gm,{node:e,finalName:s,url:n,tabIndex:this.props.keyAccess,openFile:this.props.onShow,canResumeDownload:this.props.canResumeDownload,hasPausedTransfersSelected:this.props.hasPausedTransfersSelected,onDownloadResume:this.props.onDownloadResume})))}}const Em=Zm;var _m;function Mm(e,t,n,s){_m||(_m="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:_m,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Nm=[$.kKeyboardTabToAll];var Pm=Mm(jo,{type:"close",size:16});const Dm=function({title:e,showCloseButton:t}){const n=(0,na.Z)(Nm),s=(0,hs.useContext)(xi.Z);return Mm("h1",{},void 0,Mm("span",{},void 0,e),t&&Mm("button",{className:"close transparent",onClick:()=>Pn.Z.closePanel(s.vivaldiWindowId),title:(0,Oe.Z)("Close Panel"),tabIndex:n[$.kKeyboardTabToAll]},void 0,Pm))};var xm,Om;function Lm(e,t,n,s){xm||(xm="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:xm,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Rm({downloadItem:e,canResumeDownload:t,filter:n,hasActiveTransfersSelected:s,hasCompletedTransfers:i,hasCompletedTransfersSelected:o,hasPausedTransfersSelected:a,hasDownload:r,keyAccess:l,onDownloadResume:d,onFilterChange:c,onRemoveAllFinished:h,onRemoveSelected:p,onRestartSelectedDownload:u,onStopSelectedDownload:g,title:m,showCloseButton:v}){const{document:f}=(0,hs.useContext)(xi.Z),y=(0,hs.useRef)(),[C,w]=(0,hs.useState)(n),[,b]=(0,hs.useTransition)();(0,hs.useEffect)((()=>{f.activeElement!==y.current&&w(n)}),[f.activeElement,n]);return Lm("header",{},void 0,Lm(Dm,{title:m,showCloseButton:v}),Lm("div",{className:"toolbar toolbar-default toolbar-wrap"},void 0,(0,fs.jsx)("input",{ref:y,type:"search",placeholder:(0,Oe.Z)("verb","Search"),value:C,disabled:!r&&!n,onChange:e=>{const{value:t}=e.target;w(t),b((()=>{c(t)}))}}),Lm("div",{className:"toolbar"},void 0,Lm("div",{className:"toolbar-group"},void 0,Lm(Fa,a||t?{tooltip:(0,Oe.Z)("Resume Download"),onClick:d,image:Ts.sxZ.small}:{tooltip:(0,Oe.Z)("verb","Pause"),onClick:g,disabled:!s,image:Ts.Q9E.small}),Lm(Fa,{tooltip:(0,Oe.Z)("command","Restart"),disabled:!e,onClick:u,image:Ts.Ibx.small}),Lm(Fa,{tooltip:(0,Oe.Z)("verb","Remove"),disabled:!(o||a||e&&"interrupted"===e.state),onClick:p,image:Ts.M2k.small}),Lm(Fa,{tooltip:(0,Oe.Z)("Remove all finished"),disabled:!i,onClick:h,image:Ts.DwE.small})))))}function Bm(e,t,n,s){Om||(Om="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Om,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Fm(){return Bm("div",{className:"download-placeholder"},void 0,Bm("div",{className:"download-empty-state"},void 0,Bm("span",{dangerouslySetInnerHTML:{__html:Ts.ZsG}}),Bm("h1",{},void 0,(0,Oe.Z)("Your download list is empty")),Bm("p",{className:"faded-text"},void 0,(0,Oe.Z)("As soon as you download something, it will appear here."))))}var Vm,Wm=n(1567);function Um(e,t,n,s){Vm||(Vm="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Vm,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Hm="in_progress",zm="complete",Gm="interrupted";function $m({item:e}){const t=(new Date).getTime()+2e3,n=new Date(e.estimatedEndTime).getTime(),s=e.state===Hm,i=e.bytesReceived,{currentHumanized:o,endHumanized:a}=function(e,t){let n=fd(e);const s=fd(t||e);return n.split(" ")[1]===s.split(" ")[1]&&(n=n.split(" ")[0]),{currentHumanized:n,endHumanized:s}}(i,e.totalBytes),r=function(e,t,n){return e&&t>n?N()(t).fromNow():e&&t<=n?(0,Oe.Z)("about a second"):""}(s,n,t),l=(0,Oe.Z)("$1/s",[fd(e.currentSpeed)]),d=e.paused||e.state===Gm,c=e.error?function(e){switch(e){case"FILE_NO_SPACE":return(0,Oe.Z)("Disk is full");case"FILE_TOO_LARGE":return(0,Oe.Z)("File too large");case"FILE_FAILED":return(0,Oe.Z)("Download error");case"FILE_ACCESS_DENIED":return(0,Oe.Z)("Insufficient permissions");case"FILE_NAME_TOO_LONG":return(0,Oe.Z)("Path too long");case"FILE_VIRUS_INFECTED":return(0,Oe.Z)("Virus detected");case"FILE_TRANSIENT_ERROR":return(0,Oe.Z)("System busy");case"FILE_BLOCKED":return(0,Oe.Z)("Blocked");case"FILE_SECURITY_CHECK_FAILED":return(0,Oe.Z)("Virus scan failed");case"FILE_TOO_SHORT":return(0,Oe.Z)("File truncated");case"FILE_SAME_AS_SOURCE":return(0,Oe.Z)("Already downloaded");case"FILE_HASH_MISMATCH":return(0,Oe.Z)("Hash mismatch");case"NETWORK_FAILED":return(0,Oe.Z)("Network");case"NETWORK_TIMEOUT":return(0,Oe.Z)("Timeout");case"NETWORK_DISCONNECTED":return(0,Oe.Z)("Disconnected");case"NETWORK_SERVER_DOWN":return(0,Oe.Z)("Server unavailable");case"NETWORK_INVALID_REQUEST":return(0,Oe.Z)("Invalid network request");case"SERVER_FAILED":return(0,Oe.Z)("Server failed");case"SERVER_NO_RANGE":return(0,Oe.Z)("Server does not support range");case"SERVER_BAD_CONTENT":return(0,Oe.Z)("The server could not find the file");case"SERVER_UNAUTHORIZED":return(0,Oe.Z)("Unauthorized");case"SERVER_CERT_PROBLEM":return(0,Oe.Z)("Certificate problem");case"SERVER_FORBIDDEN":return(0,Oe.Z)("Forbidden");case"SERVER_UNREACHABLE":return(0,Oe.Z)("Unreachable");case"SERVER_CONTENT_LENGTH_MISMATCH":return(0,Oe.Z)("Content length mismatch");case"SERVER_CROSS_ORIGIN_REDIRECT":return(0,Oe.Z)("Cross origin redirect");case"USER_CANCELED":return(0,Oe.Z)("Cancelled");case"USER_SHUTDOWN":return(0,Oe.Z)("Shutdown");case"CRASH":return(0,Oe.Z)("Crashed")}return e}(e.error):"",h=d?(0,Oe.Z)("$1 of $2 - stopped",[o,a]):(0,Oe.Z)("$1 of $2 at $3",[o,a,l]);return Um("div",{className:"DownloadItem-FileSize"},void 0,e.state===zm?a:e.error?c:h,r&&` (${r})`)}var Km,jm;function Ym(e,t,n,s){Km||(Km="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Km,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Xm({onClick:e}){return Ym("button",{onClick:e,title:(0,Oe.Z)("verb","Pause"),className:"ActionButton circular",tabIndex:"-1",dangerouslySetInnerHTML:{__html:Ts.Q9E.small}})}function Qm({onClick:e}){return Ym("button",{onClick:e,title:(0,Oe.Z)("Resume Download"),className:"ActionButton circular resume",tabIndex:"-1",dangerouslySetInnerHTML:{__html:Ts.sxZ.small}})}function qm({onClick:e}){return Ym("button",{onClick:e,title:(0,Oe.Z)("Show in File Manager"),className:"ActionButton circular reveal",tabIndex:"-1",dangerouslySetInnerHTML:{__html:Ts._TQ.small}})}function Jm({onClick:e}){return Ym("button",{onClick:e,title:(0,Oe.Z)("verb","Remove"),className:"ActionButton circular remove",tabIndex:"-1",dangerouslySetInnerHTML:{__html:Ts.M2k.small}})}function ev(e){return new Promise(((t,n)=>{s.Z.downloads.getFileIcon(e,{size:32},(e=>{t(e)}))}))}function tv(e,t,n,s){jm||(jm="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:jm,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const nv="in_progress",sv="complete";function iv(e){const t=e.state===nv;return e.url+h.YV+(0,Oe.Z)("Added: $1",[N()(e.startTime).format("l, LTS")])+(t&&e.paused?h.YV+(0,Oe.Z)("Download stopped"):"")+(e.endTime?h.YV+(0,Oe.Z)("Complete: $1",[N()(e.endTime).format("l, LTS")]):"")}class ov extends hs.PureComponent{static contextType=xi.Z;#h=!1;constructor(e){super(e),N().relativeTimeThreshold("ss",2)}state={icon:void 0};componentDidMount(){this.#h=!0,ev(this.props.item.id).then((e=>{this.#h&&this.setState({icon:e})}))}componentWillUnmount(){this.#h=!1}componentDidUpdate(e,t){this.state.icon||e.item.state===this.props.item.state||ev(this.props.item.id).then((e=>{this.#h&&this.setState({icon:e})}))}handleMouseEnter=e=>{c.Z.setStatus(e,this.props.item.url)};handleMouseLeave=e=>{c.Z.clearStatus(e)};renderDownloadButton=()=>{const{item:e,onPause:t,onResume:n,onShow:s,onErase:i}=this.props;return e.state!==nv||e.paused?e.canResume?tv(Qm,{onClick:n.bind(null,e.id)}):e.state===sv&&e.exists?tv(qm,{onClick:s.bind(null,e.id)}):tv(Jm,{onClick:i.bind(null,e.id)}):tv(Xm,{onClick:t.bind(null,e.id)})};renderKeepDiscardMixedContent=()=>{const{item:e,onErase:t,onValidateMixedDownload:n}=this.props;return tv("div",{className:"DownloadItem-KeepDiscard"},void 0,tv("span",{},void 0,(0,Oe.Z)("This file can’t be downloaded securely.")),tv("span",{},void 0,tv("input",{type:"button",onClick:()=>t(e.id),title:(0,Oe.Z)("Discard insecure download"),className:"DownloadItem-KeepDiscard-KeepDiscardButton-default",value:(0,Oe.Z)("Discard"),autoFocus:!0}),tv("input",{type:"button",onClick:()=>n(e.id),title:(0,Oe.Z)("Keep insecure download"),className:"DownloadItem-KeepDiscard-KeepDiscardButton",value:(0,Oe.Z)("Keep")})))};render(){const{item:e}=this.props,t=(e.filename||e.finalUrl).split("\\").pop().split("/").pop(),n=this.context.vivaldiWindowId,{icon:s}=this.state;return tv("div",{className:As()("DownloadItem",{"DownloadItem--Unavailable":!1===e.exists}),onMouseEnter:()=>this.handleMouseEnter(n),onMouseLeave:()=>this.handleMouseLeave(n),title:iv(e)},void 0,s&&tv("img",{src:s,className:"DownloadItem-Icon"}),tv("div",{className:"DownloadItem-FileName"},void 0,t),tv(wm,{item:e}),tv($m,{item:e}),this.renderDownloadButton(),"block"===e.mixedState&&this.renderKeepDiscardMixedContent())}}const av=ov;class rv extends hs.Component{static contextType=xi.Z;static defaultProps={offset:0};#g=hs.createRef();componentDidMount=()=>{const e=this.#g.current;e&&(e.addEventListener("pointerdown",this.handlePointerDown,!0),e.addEventListener("pointerup",this.handlePointerUp,!0),e.addEventListener("pointercancel",this.handleStop,!0))};componentWillUnmount=()=>{const e=this.#g.current;e&&(e.removeEventListener("pointerdown",this.handlePointerDown,!0),e.removeEventListener("pointerup",this.handlePointerUp,!0),e.removeEventListener("pointercancel",this.handleStop,!0))};handleDoubleClick=e=>{this.props.onDoubleClick&&(this.props.onDoubleClick(),e.stopPropagation())};handlePointerDown=e=>{e.preventDefault(),e.button===Hi.Z.kLeft&&(e.currentTarget.setPointerCapture(e.pointerId),Hi.Z.setWebviewPointerEvents(!1,this.context.document),e.currentTarget.addEventListener("pointermove",this.handlePointerMove,!0),this.props.onStart&&this.props.onStart())};handlePointerUp=e=>{e.button===Hi.Z.kCenter?this.handleDoubleClick(e):this.handleStop(e)};handlePointerMove=e=>{if(!e.buttons)return void this.handleStop(e);const t=this.props.returnOffset?e.movementX:e.pageX+(this.props.offset||0),n=this.props.returnOffset?e.movementY:e.pageY+(this.props.offset||0);this.context.requestAnimationFrame((()=>{this.props.onSlidebarPosition(t,n,e)}))};handleStop=({currentTarget:e,pointerId:t})=>{e.releasePointerCapture(t),Hi.Z.setWebviewPointerEvents(!0,this.context.document),e.removeEventListener("pointermove",this.handlePointerMove,!0),this.props.onStop&&this.props.onStop()};render(){const{position:e}=this.props,t="left"===e||"right"===e?"SlideBar--FullHeight":"SlideBar--FullWidth",n="right"===e||"bottom"===e;return(0,fs.jsx)("button",{type:"button",tabIndex:"-1",ref:this.#g,style:this.props.style,onClick:e=>e.stopPropagation(),onDoubleClick:this.handleDoubleClick,className:As()("SlideBar",this.props.className,t,{alternate:n})})}}const lv=rv;var dv,cv=n(34155);function hv(e,t,n,s){dv||(dv="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:dv,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const pv="vivaldi/x-sortfield";class uv extends hs.PureComponent{static contextType=xi.Z;nodeRef=hs.createRef();constructor(e){super(e),this.state={columns:e.columns||[],maxWidth:0,dataKey:"",dragOverField:void 0}}getWidth=e=>{const t=this.nodeRef.current?.getBoundingClientRect();t?.width&&this.setState({maxWidth:t.width,dataKey:e})};saveColumnsToSettings=()=>{this.dragged="",this.props.onSaveRow&&this.props.onSaveRow()};resizeRow=(e,t,n)=>{const{dataKey:s}=this.state;this.setState((t=>{const i=t.columns?[...t.columns]:[],o=i.flatMap((e=>e.id)).indexOf(s),a=n.target.parentElement,r=Math.round(e-a.getClientRects()[0].left),l=o+1,d=a.nextSibling,c=Math.round(a.clientWidth+d.clientWidth)-r;return r<0||c<0||(i[l].key||0===o&&!i[o].key?i[o]={...i[o],width:r}:i[l]={...i[l],width:c},this.props.onUpdateRow&&this.props.onUpdateRow(i)),{columns:i}}))};updateField=e=>{const t=e.target.value;let n;n="manually"===t?Xi.Z.NO_SORTING:this.props.sortOrder===Xi.Z.NO_SORTING?Xi.Z.ASCENDING_SORT:this.props.sortOrder,this.props.onSortChange(n,t)};updateSort=(e,t)=>{let n;if(t.preventDefault(),e===this.props.sortField)switch(this.props.sortOrder){case Xi.Z.ASCENDING_SORT:n=Xi.Z.DESCENDING_SORT;break;case Xi.Z.DESCENDING_SORT:n=!1!==this.props.manualSorting?Xi.Z.NO_SORTING:Xi.Z.ASCENDING_SORT;break;case Xi.Z.NO_SORTING:n=Xi.Z.ASCENDING_SORT}else n=Xi.Z.ASCENDING_SORT;n&&this.props.onSortChange(n,e)};updateOrder=()=>{const e=this.props.sortOrder===Xi.Z.DESCENDING_SORT?Xi.Z.ASCENDING_SORT:Xi.Z.DESCENDING_SORT;this.props.onSortChange(e,this.props.sortField)};onDragStart=(e,t)=>{this.dragged=e,t.dataTransfer.setData(pv,!0),t.stopPropagation()};onDragOver=(e,t)=>{const{HTMLElement:n}=this.context;if(t.dataTransfer&&!t.dataTransfer.types.includes(pv))return;if(t.preventDefault(),t.stopPropagation(),e===this.dragged||!(t.currentTarget instanceof n))return;const s=t.currentTarget.getBoundingClientRect(),i=(t.clientX-s.left)/s.width<=.5?"left":"right";this.setState({dragOverField:{id:e,position:i}})};onDrop=e=>{if(this.state.columns&&void 0!==this.state.dragOverField&&this.state.columns.length>1&&e.dataTransfer.getData(pv)){const{columns:t,dragOverField:n}=this.state,s=t.findIndex((e=>e.id===this.dragged)),i=Math.max(0,t.findIndex((e=>e.id===n.id))+("right"===n.position?1:0)),o=s-i;if(0===o||!this.state.columns)return;e.preventDefault(),e.stopPropagation(),this.setState((e=>{if(e.columns){const t=[...e.columns];return t.splice(Math.max(0,i-(o<0?1:0)),0,t.splice(s,1)[0]),this.props.onUpdateRow&&this.props.onUpdateRow(t),{columns:t,dragOverField:void 0}}})),cv.nextTick((()=>this.saveColumnsToSettings()))}};resetDragOverField=()=>{this.setState({dragOverField:void 0})};resetColumns=()=>{const e=oo(this.props.fields);e&&(this.setState({columns:e}),this.props.onUpdateRow&&this.props.onUpdateRow(e))};onContextMenu=e=>{if(!this.state.columns)return;const t=this.state.columns.flatMap((e=>e.id)),n=this.props.fields.filter((e=>!e.key)).map((e=>({handler:this.toggleColumn.bind(this,e.value),type:"checkbox",checked:t.includes(e.value),...ae.Z.makeLabelPair(e.text)})),[]);this.props.columns&&(n.push(ae.Z.separatorItem),n.push({handler:this.resetColumns,...(0,xs.Z)("Reset Columns")})),(0,Qi.Z)(this.context,n)(e)};toggleColumn=e=>{if(!this.state.columns)return;const t=this.state.columns.flatMap((e=>e.id));t.includes(e)?this.setState((n=>{const s=n.columns||[];if(s){const n=t.indexOf(e),i=[...s.slice(0,n),...s.slice(n+1)];return this.props.onUpdateRow&&this.props.onUpdateRow(i),{columns:i}}})):this.setState((t=>{const n=t.columns||[],s=this.props.fields.find((t=>t.value===e));if(s&&n.length>0){const t=this.props.fields.indexOf(s),i=[...n.slice(0,t),{id:e,width:s.width||20},...n.slice(t)];return this.props.onUpdateRow&&this.props.onUpdateRow(i),{columns:i}}})),cv.nextTick((()=>this.saveColumnsToSettings()))};_getSortLabel=e=>{const t=e.text,n=e.value,s=e.isSortField??!0,i=this.props.sortField===n,o=e.fullScreenTitle,{dragOverField:a}=this.state,r=a&&a.id===e.value,l=a&&a.position||"",d=As()({"sortselector-button":!0,"sortselector-button-active":i&&this.props.sortOrder!==Xi.Z.NO_SORTING,"direction-ascending":i&&this.props.sortOrder===Xi.Z.ASCENDING_SORT,"direction-descending":i&&this.props.sortOrder===Xi.Z.DESCENDING_SORT,"over-left":r&&"left"===l,"over-right":r&&"right"===l,"drag-over":r}),{columns:c}=this.state,h=c.findIndex((e=>e.id===n)),p=c[h];return hv("div",{onContextMenu:this.onContextMenu},"key_"+n+t+o,hv("button",{draggable:1!==this.props.fields.length,onDragStart:this.onDragStart.bind(this,n),onDragOver:this.onDragOver.bind(this,n),onDragLeave:this.resetDragOverField,onDrop:this.onDrop,className:d,onClick:this.updateSort.bind(this,n),title:o||(0,Oe.Z)("Toggle Sort Order"),disabled:!s,tabIndex:this.props.keyAccess},void 0,p&&p.width<80?hv("span",{className:"column-icon",dangerouslySetInnerHTML:{__html:e.icon?e.icon:Ts.NNg.small}}):hv("span",{className:"column-label"},void 0,t),hv("span",{className:"column-sort-order",dangerouslySetInnerHTML:{__html:Ts.u0H}})),c&&h>-1&&h<c.length-1&&hv(lv,{onSlidebarPosition:this.resizeRow,onStart:()=>this.getWidth(n),onStop:this.saveColumnsToSettings,style:this.props.style,position:"right"}))};getFullOptions(){return this.state.columns&&this.state.columns.length>0?this.state.columns.map((e=>{const t=this.props.fields.find((t=>t.value===e.id));if(t)return this._getSortLabel(t)})).filter(Boolean):this.props.fields.map((e=>this._getSortLabel(e)))}getCompactOptions(){const e=this.props.fields.filter((({isSortField:e})=>e??!0)).map((e=>hv("option",{value:e.value},e.value,e.fullScreenTitle)));return!1!==this.props.manualSorting&&e.unshift(hv("option",{value:"manually"},"manually",(0,Oe.Z)("Sort Manually"))),e}render(){const{columns:e,fullsize:t}=this.props,n=this.props.sortOrder===Xi.Z.NO_SORTING,s=t&&e?ao(e):void 0,i=1===this.props.fields.length&&!this.props.compact,o=!(t||i);return(0,fs.jsx)("div",{ref:this.nodeRef,className:As()("sortselector",{"sortselector-tableheader":!o,"tableheader-add-scrollbar-spacing":t&&!!this.props.alignHeaderWithScrollbar,"sortselector-compact":o,single:i}),style:{gridTemplateColumns:s},children:o?(0,fs.jsxs)(fs.Fragment,{children:[hv("div",{className:"sortselector-area"},void 0,hv("select",{className:"sortselector-dropdown",title:(0,Oe.Z)("Sort by..."),value:this.props.sortField,tabIndex:this.props.keyAccess,onChange:this.updateField},void 0,this.getCompactOptions())),hv("button",{className:As()({"sortselector-button":!0,"direction-ascending":this.props.sortOrder===Xi.Z.ASCENDING_SORT,"direction-descending":this.props.sortOrder===Xi.Z.DESCENDING_SORT}),onClick:this.updateOrder,title:this.props.sortOrder===Xi.Z.ASCENDING_SORT?(0,Oe.Z)("Sort Descending"):(0,Oe.Z)("Sort Ascending"),tabIndex:n?-1:this.props.keyAccess,disabled:n,dangerouslySetInnerHTML:{__html:Ts.u0H}})]}):this.getFullOptions()})}}const gv=uv;var mv;function vv(e,t,n,s){mv||(mv="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:mv,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const fv=[{text:(0,Oe.Z)("title","Name"),value:"filename",fullScreenTitle:(0,Oe.Z)("Sort by Name")},{text:(0,Oe.Z)("Type"),value:"extension",fullScreenTitle:(0,Oe.Z)("Sort by Type")},{text:(0,Oe.Z)("Size"),value:"bytesReceived",fullScreenTitle:(0,Oe.Z)("Sort by Size")},{text:(0,Oe.Z)("Date"),value:"startTime",fullScreenTitle:(0,Oe.Z)("Sort by Date")},{text:(0,Oe.Z)("Address"),value:"url",fullScreenTitle:(0,Oe.Z)("Sort by Address")}];class yv extends hs.PureComponent{refTreeList=hs.createRef();static contextType=xi.Z;winId=this.context.vivaldiWindowId;getExtension=e=>{const t=e?e.lastIndexOf("."):-1;return-1!==t?e.substring(t+1):""};sortForExtension=(e,t)=>{const{sortOrder:n}=this.props;if(n<=Xi.Z.NO_SORTING)return 0;const s=e,i=t;let o=this.getExtension(s.filename),a=this.getExtension(i.filename);if(!o&&!a)return 0;if(!o)return n===Xi.Z.ASCENDING_SORT?1:-1;if(!a)return n===Xi.Z.ASCENDING_SORT?-1:1;if("number"==typeof o&&"number"==typeof a)return n===Xi.Z.ASCENDING_SORT?o-a:a-o;if(o=o.toString().toLowerCase(),a=a.toString().toLowerCase(),o>a)return n===Xi.Z.ASCENDING_SORT?1:-1;if(o<a)return n===Xi.Z.ASCENDING_SORT?-1:1;return Xi.Z.getDefaultComparator(n,"filename")(e,t)};returnFalse=()=>!1;selectByIds=e=>{e.forEach((e=>{this.refTreeList.current?.selectById(e,{ctrlKey:!0,metaKey:!0})}))};selectByNode=e=>{this.refTreeList.current?.selectByNode(e)};selectByIndex=e=>{this.refTreeList.current?.selectByIndex(e)};scrollToId=e=>{this.refTreeList.current?.scrollToId(e)};isSelected=e=>this.refTreeList.current?.isItemSelected(e);getSelectedNodes=()=>this.refTreeList.current?.selectionModel.selectedIds||[];getSelectedNode=()=>this.refTreeList.current?.getSelectedItem();onNodeMouseDown=()=>{this.refTreeList.current?.focusTree()};onNodeSelected=e=>{e?this.props.onSelected(parseInt(e.id)<0?void 0:e):this.props.onSelected(void 0)};onNodeDoubleClick=(e,t)=>{this.props.onOpen(t.id)};onNodesActivated=(e,t)=>{t.forEach((e=>{this.props.onOpen(e.id)}))};handleErase=e=>(this.props.nodes.filter((t=>e.includes(t.id))).forEach((({id:e})=>this.props.onErase(e))),Promise.resolve());rowComponent=e=>{const t=e.node;return vv(av,{item:t,onErase:this.props.onErase,onShow:this.props.onShow,onPause:this.props.onPause,onResume:this.props.onResume,onValidateMixedDownload:this.props.onValidateMixedDownload},t.id)};render(){const e=G.ZP.isIncognito(this.winId),t={sortOrder:this.props.sortOrder,sortField:this.props.sortField,comparator:this.sortForExtension,onlyScroll:"extension"!==this.props.sortField};return(0,fs.jsxs)(fs.Fragment,{children:[Wm.Z.hasDownloads({isIncognitoWindow:e})&&vv(gv,{fields:fv,manualSorting:!1,onSortChange:this.props.onSortChange,keyAccess:this.props.keyAccess,sortField:this.props.sortField,sortOrder:this.props.sortOrder}),vv("section",{className:"outerScrollbar"},void 0,(0,fs.jsx)(yo,{ref:this.refTreeList,settings:"DOWNLOADS_TREE",rowComponent:this.rowComponent,nodes:this.props.nodes,menu:this.props.menu,isFolder:this.returnFalse,hasChildren:this.returnFalse,delete:this.handleErase,onSelect:this.onNodeSelected,enableDragAndDrop:!1,onItemMouseDown:this.onNodeMouseDown,onItemDoubleClick:this.onNodeDoubleClick,onItemsActivated:this.onNodesActivated,rowHeight:52,sorting:t}))]})}}const Cv=yv;var wv,bv=n(34155);function Sv(e,t,n,s){wv||(wv="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:wv,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Iv(e,t){const n="startTime";if("extension"===e)return n;if(t===Xi.Z.ASCENDING_SORT)return e;switch(e){case"bytesReceived":return"-bytesReceived";case"endTime":return"-endTime";case"filename":return"-filename";case"startTime":return"-startTime";case"url":return"-url"}return n}const kv=[$.kDownloadsPanelEditorHeight];function Av(e){return"complete"===e.state&&e.mime.startsWith("image/")}var Tv=Sv(Fm,{});class Zv extends hs.PureComponent{static contextType=xi.Z;winId=this.context.vivaldiWindowId;nodeRef=hs.createRef();refTree=hs.createRef();defaultHeight=H.Z.getDefault($.kDownloadsPanelEditorHeight);state={downloadItems:[],hasActiveDownloadItemsSelected:!1,hasPausedDownloadItemsSelected:!1,hasCompletedDownloadItemsSelected:!1,hasCompletedDownloadItems:!1,selectedDownloadItem:void 0,filter:Wm.Z.getFilter(),editorHeight:H.Z.get($.kDownloadsPanelEditorHeight),...H.Z.get($.kDownloadsPanelSorting)};componentDidMount(){const{selectWindow:e}=this.context;ud.ZP.addListener(this.onPanelStoreChange),Wm.Z.addListener(this.onDownloadStoreChange),A.Z.setOrderBy(Iv(this.state.sortField,this.state.sortOrder)),A.Z.setSearchFilter(this.state.filter),G.ZP.addListener(this._onWindowStoreChange,e),this.fetchDownloadItemsAndUpdateState()}componentDidUpdate(e,t){return t.filter!==this.state.filter?this.fetchDownloadItemsAndUpdateState():"extension"===this.state.sortField||t.sortField===this.state.sortField&&t.sortOrder===this.state.sortOrder?(t.selectedDownloadItem!==this.state.selectedDownloadItem&&this.updateActiveProgressState(),void(!e.open&&this.props.open&&bv.nextTick((()=>{this.focusTree(),0===this.refTree.current?.getSelectedNodes().length&&this.refTree.current?.selectByIndex(0)})))):this.fetchDownloadItemsAndUpdateState()}componentWillUnmount(){Wm.Z.removeListener(this.onDownloadStoreChange),ud.ZP.removeListener(this.onPanelStoreChange),G.ZP.removeListener(this._onWindowStoreChange)}fetchDownloadItemsAndUpdateState=()=>new Promise((e=>{const t=G.ZP.isIncognito(this.winId),n=Wm.Z.getItems({isIncognitoWindow:t});let s;this.state.selectedDownloadItem&&(s=n.find((e=>{if(this.state.selectedDownloadItem)return e.id===this.state.selectedDownloadItem.id})),this.updateActiveProgressState());const i=n;this.setState({filter:Wm.Z.getFilter(),selectedDownloadItem:s,downloadItems:i,hasCompletedDownloadItems:n.some((e=>"complete"===e.state)),...H.Z.get($.kDownloadsPanelSorting)},e)}));scrollDownloadItemIntoView=e=>{this.refTree.current?.scrollToId(e.id)};selectDownloadItem=e=>{this.refTree.current?.selectByNode(e)};onDownloadStoreChange=e=>{switch(e.reason){case"download_completed":{const{downloadItem:t}=e;return void this.onTransferFinished(t)}case"download_started":{const{downloadItem:t}=e;return void this.fetchDownloadItemsAndUpdateState().then((()=>{this.scrollDownloadItemIntoView(t),this.selectDownloadItem(t)}))}case"download_panel_updated":return void this.fetchDownloadItemsAndUpdateState()}};onPanelStoreChange=()=>{const e=ud.ZP.getChangeReason();this.props.open&&"setFocus"===e&&!sl(this.context.document,this.nodeRef.current)&&this.focusTree()};_onWindowStoreChange=()=>{this.props.open&&G.ZP.isActive(this.winId)&&A.Z.forceUpdate()};onTransferFinished=e=>{s.Z.windows.getLastFocused((t=>{if(t.id!==this.winId)return;if(!H.Z.get($.kDownloadsNotifyOnComplete))return;if(!e)return;const n=e.filename.split("\\").pop().split("/").pop();const i=(0,Oe.Z)("Download Complete"),o=A.Z.showDownload.bind(null,e.id);s.Z.downloads.getFileIcon(e.id,{size:32},(t=>{(0,Ke.c)({title:i,body:n,icon:t,timeout:54e6,onClick:o,tag:`VIVALDI_DOWNLOAD_COMPLETE_ID_${e.finalUrl}`})}))})),this.updateActiveProgressState()};getMenuState=()=>{const e=this.updateActiveProgressState();return{numAddresses:this.getNumSelectedAddresses(),numFiles:this.getNumSelectedFiles(),numImages:this.getNumSelectedImages(),hasPaused:e.hasPausedDownloadItemsSelected,hasCompleted:e.hasCompletedDownloadItemsSelected,hasActive:e.hasActiveDownloadItemsSelected}};getMenuCapability=async(e,t,n,s)=>{const i=this.winId;switch(e.action){case"CONTEXT_OPEN_FILE":return{handler:this.openSelected,isVisible:()=>Boolean(n)&&s.hasCompleted&&s.numFiles>0,...t(i,e,s)};case"CONTEXT_OPEN_IN":return{isVisible:()=>Boolean(n)&&s.numImages>0&&s.numFiles>0,...t(i,e,s)};case"CONTEXT_OPEN_IN_NEW_TAB":return{handler:()=>{this.openSelectedInTab(!1,H.Z.get($.kTabsOpenNewInBackground))},isVisible:()=>Boolean(n)&&s.numImages>0&&s.numFiles>0,...t(i,e,s)};case"CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB":return{handler:()=>{this.openSelectedInTab(!1,!0)},isVisible:()=>Boolean(n)&&!H.Z.get($.kTabsOpenNewInBackground)&&s.numImages>0&&s.numFiles>0,...t(i,e,s)};case"CONTEXT_OPEN_IN_TAB":return{handler:()=>{this.openSelectedInTab(!0,!1)},isVisible:()=>Boolean(n)&&s.numImages>0&&s.numFiles>0,...t(i,e,s)};case"CONTEXT_OPEN_IN_NEW_WINDOW":return{handler:()=>{this.openSelectedInWindow(!1)},isVisible:()=>Boolean(n)&&s.numImages>0&&s.numFiles>0,...t(i,e,s)};case"CONTEXT_OPEN_IN_PRIVATE_WINDOW":return{handler:()=>{this.openSelectedInWindow(!0)},isVisible:()=>Boolean(n)&&s.numImages>0&&s.numFiles>0,...t(i,e,s)};case"CONTEXT_FILEMANAGER":return{handler:()=>{this.showSelectedInFilemanager()},isVisible:()=>Boolean(n)&&s.numFiles>0,...t(i,e,s)};case"CONTEXT_COPY_ADDRESS":return{handler:()=>{this.copySelectedAddress()},isVisible:()=>Boolean(n),...t(i,e,s)};case"CONTEXT_COPY_PATH":return{handler:()=>{this.copySelectedPath()},isVisible:()=>Boolean(n)&&s.hasCompleted&&s.numFiles>0,...t(i,e,s)};case"CONTEXT_RESTART":return{handler:()=>{this.restartSelected()},isVisible:()=>Boolean(n)&&(s.hasCompleted||this.fileErrors()),...t(i,e,s)};case"CONTEXT_STOP":return{handler:()=>{this.stopSelected()},isVisible:()=>Boolean(n)&&s.hasActive,...t(i,e,s)};case"CONTEXT_RESUME":return{handler:()=>{this.resumeSelected()},isVisible:()=>Boolean(n)&&s.hasPaused,...t(i,e,s)};case"CONTEXT_REMOVE":return{handler:()=>{this.removeSelected()},isVisible:()=>Boolean(n),...t(i,e,s)};case"CONTEXT_REMOVE_ALL_FINISHED":return{handler:()=>{this.removeAllFinished()},isVisible:()=>Boolean(n)&&s.hasCompleted,...t(i,e,s)};default:return{...t(i,e,s)}}};getSelectedDownloadItems=()=>{const e=this.refTree.current?.getSelectedNodes().map((e=>e.id))||[];return this.state.downloadItems.filter((t=>-1!==e.findIndex((e=>e===t.id))))};getNumSelectedImages=()=>this.getSelectedDownloadItems().filter(Av).length;getNumSelectedAddresses=()=>this.getSelectedDownloadItems().filter((e=>Boolean(e.url))).length;getNumSelectedFiles=()=>{let e=0;const t=this.getSelectedDownloadItems();for(let n=0;n<t.length;n++){const s=t[n];s.exists&&!s.error&&e++}return e};fileErrors=()=>{const e=this.getSelectedDownloadItems().map((e=>e.error));if(e.length)return!e.includes(void 0)};getActiveProgressStateForSelectedDownloadItems=()=>{const e=this.getSelectedDownloadItems(),t=this.state.downloadItems;let n=!1,s=!1,i=!1,o=!1;for(let t=0;t<e.length;t++){const a=e[t];if("in_progress"===a.state?a.paused?s=!0:n=!0:"complete"===a.state&&(i=o=!0),n&&s&&i)break}return o=o||!!t.find((e=>"complete"===e.state)),{hasActiveDownloadItemsSelected:n,hasPausedDownloadItemsSelected:s,hasCompletedDownloadItemsSelected:i,hasCompletedDownloadItems:o}};updateActiveProgressState=()=>{const e=this.getActiveProgressStateForSelectedDownloadItems();return this.setState(e),e};canResumeSelected=()=>{const e=this.getSelectedDownloadItems();if(1===e.length){return e[0].canResume}return!1};stopSelected=()=>{this.getSelectedDownloadItems().filter((e=>!e.paused)).forEach((({id:e})=>A.Z.pauseDownload(e)))};resumeSelected=()=>{this.getSelectedDownloadItems().filter((e=>e.canResume)).forEach((({id:e})=>A.Z.resumeDownload(e)))};restartSelected=()=>{this.getSelectedDownloadItems().forEach((({id:e})=>A.Z.restartDownload(e)))};showSelectedInFilemanager=()=>{this.getSelectedDownloadItems().forEach((({id:e})=>A.Z.showDownload(e)))};onSortChange=(e,t)=>{Ne.Z.set($.kDownloadsPanelSorting,{sortOrder:e,sortField:t});const n=Iv(t,e);A.Z.setOrderBy(n),"extension"===t&&this.setState({sortField:t,sortOrder:e})};openSelected=()=>{this.getSelectedDownloadItems().forEach((e=>{"complete"===e.state&&A.Z.openDownload(e.id)}))};openSelectedInTab=(e,t)=>{const n=this.getSelectedDownloadItems().filter((e=>"complete"===e.state&&e.mime.startsWith("image/"))).map((e=>"file://"+e.filename));if(n.length>0){const s=n[n.length-1];n.forEach((n=>{const i={inCurrent:e,inBackground:t};!1===t&&(i.inBackground=n!==s),d.ZP.openURL(this.context.vivaldiWindowId,n,i),e=!1}))}};openSelectedInWindow=e=>{const t=this.getSelectedDownloadItems().filter((e=>"complete"===e.state&&e.mime.startsWith("image/"))).map((e=>"file://"+e.filename)),n={inNewWindow:!0,incognito:e};t.forEach((e=>{d.ZP.openURL(this.context.vivaldiWindowId,e,n)}))};onSelected=e=>{this.setState({selectedDownloadItem:e},(()=>{A.Z.forceUpdate(),this.updateActiveProgressState()}))};removeAllFinished=()=>{this.state.downloadItems.filter((e=>"complete"===e.state)).forEach((({id:e})=>A.Z.eraseDownload(e)))};removeSelected=()=>{this.getSelectedDownloadItems().forEach((({id:e})=>A.Z.eraseDownload(e)))};copySelectedAddress=()=>{const e=this.getSelectedDownloadItems().map((e=>e.finalUrl));0!==e.length&&this.context.navigator.clipboard.writeText(e.join("\n"))};copySelectedPath=()=>{const e=this.getSelectedDownloadItems().filter((e=>"complete"===e.state)).map((e=>e.filename));0!==e.length&&this.context.navigator.clipboard.writeText(e.join("\n"))};getItemPath=eo()((e=>this.getSelectedDownloadItems().find((t=>t.id===e))?.filename??""));handleFilterChange=e=>new Promise((t=>this.setState({filter:e},(()=>{A.Z.setSearchFilter(e).then(t)}))));onSlidebarPosition=(e,t)=>{this.setState((e=>({editorHeight:Math.max(Math.min(e.editorHeight-t,250),h.mT)})))};onSlideBarStop=()=>{this.setState((e=>{const t=e.editorHeight<h.Cn?h.mT:e.editorHeight;return Ne.Z.set($.kDownloadsPanelEditorHeight,parseInt(t)),{editorHeight:t}}))};onSlidebarToggle=()=>{this.setState((e=>{let t=e.editorHeight;return t>h.Cn?(t=h.mT,Ne.Z.set($.kDownloadsPanelEditorHeight,t)):(t=250,Ne.Z.reset($.kDownloadsPanelEditorHeight)),{editorHeight:parseInt(t)}}))};focusTree=()=>{this.refTree.current?.refTreeList.current?.focusTree()};showSelectedDownloadItem=()=>{this.state.selectedDownloadItem&&A.Z.showDownload(this.state.selectedDownloadItem.id)};menu={name:"downloadlist",getState:this.getMenuState,getCapability:this.getMenuCapability,getVisibility:()=>!1};render(){if(!this.props.open)return null;const e=this.canResumeSelected(),t=G.ZP.isIncognito(this.winId),n=!Wm.Z.hasDownloads({isIncognitoWindow:t})&&!this.state.filter;return(0,fs.jsxs)("div",{ref:this.nodeRef,className:As()("panel","downloads",{isEmpty:n}),children:[Sv(Rm,{title:this.props.title,filter:this.state.filter,onFilterChange:this.handleFilterChange,keyAccess:this.props.keyAccess,canResumeDownload:e,onDownloadResume:this.resumeSelected,hasPausedTransfersSelected:this.state.hasPausedDownloadItemsSelected,hasActiveTransfersSelected:this.state.hasActiveDownloadItemsSelected,hasCompletedTransfersSelected:this.state.hasCompletedDownloadItemsSelected,hasCompletedTransfers:this.state.hasCompletedDownloadItems,hasDownload:0!==this.state.downloadItems.length,onStopSelectedDownload:this.stopSelected,onRestartSelectedDownload:this.restartSelected,downloadItem:this.state.selectedDownloadItem?this.state.selectedDownloadItem:void 0,onRemoveSelected:this.removeSelected,onRemoveAllFinished:this.removeAllFinished,showCloseButton:this.props.showCloseButton}),(0,fs.jsx)(Cv,{ref:this.refTree,keyAccess:this.props.keyAccess,menu:this.menu,nodes:this.state.downloadItems,onSelected:this.onSelected,onSortChange:this.onSortChange,sortField:this.state.sortField,sortOrder:this.state.sortOrder,onErase:A.Z.eraseDownload,onResume:A.Z.resumeDownload,onPause:A.Z.pauseDownload,onShow:A.Z.showDownload,onOpen:A.Z.openDownload,onValidateMixedDownload:A.Z.validateMixedDownload}),n?Tv:Sv("section",{className:As()("download-editor",{collapsed:this.state.editorHeight===h.mT}),style:{flexBasis:this.state.editorHeight}},void 0,Sv(lv,{onSlidebarPosition:this.onSlidebarPosition,onStop:this.onSlideBarStop,onDoubleClick:this.onSlidebarToggle,position:"bottom",returnOffset:!0}),this.state.editorHeight>h.mT&&Sv(Em,{downloadItem:this.state.selectedDownloadItem,keyAccess:this.props.keyAccess,onShow:this.showSelectedDownloadItem,canResumeDownload:e,hasPausedTransfersSelected:this.state.hasPausedDownloadItemsSelected,onDownloadResume:this.resumeSelected,getItemPath:this.getItemPath}))]})}}const Ev=sa(Zv,kv);var _v;function Mv(e,t,n,s){_v||(_v="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:_v,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Nv extends hs.PureComponent{static contextType=xi.Z;state={downloadProgress:0,isPopupVisible:!1};componentDidMount(){this.props.inEditor||(Wm.Z.addListener(this._onDownloadStoreChange),tl.Z.addListener("COMMAND_SHOW_DOWNLOADS_POPOUT",this.onCommandSpy))}componentWillUnmount(){this.props.inEditor||(Wm.Z.removeListener(this._onDownloadStoreChange),tl.Z.removeListener("COMMAND_SHOW_DOWNLOADS_POPOUT",this.onCommandSpy))}_onDownloadStoreChange=()=>{this.setState({downloadProgress:Wm.Z.getTotalProgress()})};onCommandSpy=(e,t)=>{e===this.context.vivaldiWindowId&&(this.state.isPopupVisible||this.setState({isPopupVisible:!0}))};hidePopup=()=>{this.setState({isPopupVisible:!1})};togglePopup=()=>{this.setState((e=>({isPopupVisible:!e.isPopupVisible})))};render(){return Mv(Fa,{id:"downloads",popupClassName:"download-popout",tooltip:(0,Oe.Z)("Downloads"),alwaysMenu:!0,onClick:this.togglePopup,customizeMenu:this.props.customizeMenu,menuOrigin:this.props.menuOrigin,popupPosition:this.props.popupPosition,hidePopup:this.hidePopup,isPopupVisible:this.state.isPopupVisible,popupWidth:360,image:Ts.izi[this.props.size],progress:this.state.downloadProgress,isPopupResizable:!0,draggable:this.props.draggable,onDragStart:this.props.onDragStart??Aa.Z,onDragEnd:this.props.onDragEnd??Aa.Z,onDrop:this.props.onDrop??Aa.Z,onDragEnter:this.props.onDragEnter??Aa.Z,onDragLeave:this.props.onDragLeave??Aa.Z,onDragOver:this.props.onDragOver??Aa.Z,mimeType:this.props.mimeType,name:this.props.name,size:this.props.size},void 0,Mv(Ev,{keyAccess:-1,title:(0,Oe.Z)("Downloads"),panelId:"PanelDownloads",open:!0,onOpenDialog:Aa.Z,showCloseButton:!0}))}}const Pv=ta(Nv);var Dv;function xv(e,t,n,s){Dv||(Dv="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Dv,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var Ov=xv("img",{className:"GamePreviewPopup-PreviewImage",src:"resources/game_screenshot.png"});function Lv(e){return xv("div",{className:"GamePreviewPopup"},void 0,xv("h2",{className:"GamePreviewPopup-HeaderText"},void 0,(0,Oe.Z)("Vivaldia Game")),xv("button",{className:"GamePreviewPopup-SettingsButton",title:(0,Oe.Z)("Settings"),dangerouslySetInnerHTML:{__html:Ts.bqs.large},onClick:()=>{return t=e.winId,void d.ZP.openURL(t,"vivaldi://settings/startpage/",{inBackground:!1});var t}}),Ov,xv("button",{onClick:()=>{return t=e.winId,void d.ZP.openURL(t,"vivaldi://game/",{inCurrent:!1,inBackground:!1});var t},className:"GamePreviewPopup-StartButton FormButton primary",title:(0,Oe.Z)("Click to Play")},void 0,(0,Oe.Z)("Click to Play")))}class Rv extends hs.PureComponent{static contextType=xi.Z;state={isPopupOpen:!1,isIconHovered:!1};hidePopup=()=>{this.setState({isPopupOpen:!1})};togglePopup=()=>{this.setState((e=>({isPopupOpen:!e.isPopupOpen})))};menu=()=>[{type:"checkbox",handler:()=>{Ne.Z.toggle($.kStartpageSpeedDialGameButtonShow,!0,!1)},checked:H.Z.get($.kStartpageSpeedDialGameButtonShow),...(0,xs.Z)("Show Game on Speed Dial")}];render(){const{isStartPage:e}=this.props,t=this.state.isPopupOpen||this.state.isIconHovered&&e?"resources/game_icon_alternate.png":"resources/game_icon.png";return xv(Fa,{className:"GameButton",customizeMenu:this.props.customizeMenu||void 0,tooltip:(0,Oe.Z)("Vivaldia the game"),popupPosition:this.props.popupPosition||"above",name:this.props.name||"Game",image:Ts.rNG[this.props.size||"large"],imagePath:e?t:void 0,mimeType:this.props.mimeType||"vivaldi/x-button-toolbar",menu:this.menu,hidePopup:this.hidePopup,onClick:this.togglePopup,isPopupVisible:this.state.isPopupOpen,menuOrigin:this.props.menuOrigin||void 0,popupPosition:this.props.popupPosition||"above",popupWidth:180,draggable:this.props.draggable||!1,onDragStart:this.props.onDragStart||Aa.Z,onDragEnd:this.props.onDragEnd||void 0,onDrop:this.props.onDrop||void 0,onDragEnter:this.props.onDragEnter||void 0,onPointerEnter:()=>this.setState({isIconHovered:!0}),onPointerLeave:()=>this.setState({isIconHovered:!1}),popupClassName:"extensionIconPopupMenu ToolbarButtonPopup-DefaultStyles"},void 0,xv(Lv,{winId:this.context.vivaldiWindowId}))}}var Bv,Fv=n(54162),Vv=n(83526);function Wv(e,t,n,s){Bv||(Bv="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Bv,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Uv extends hs.PureComponent{static contextType=xi.Z;updateQuery=()=>{const e=Fv.Z.getOptions(),t=Fv.Z.getSelectedFolder()?.accountId===xe.u4,n=Fv.Z.getQuery();if(e.forSender||e.forContact){const s=e.forSender?[e.forSender]:Hc.Z.getAddressesById(e.forContact||""),i=this.getContactString(n,s||[]),o=n.substring(i.length);return{query:o.startsWith(" AND ")?o.substring(" AND ".length):o,contactQuery:i,isFeed:t,options:e}}return{query:n,contactQuery:"",isFeed:t,options:e}};refSearchInput=hs.createRef();state=this.updateQuery();doDebounceSearch=(0,no.Z)((()=>{this.doSearch()}),200);getContactString(e,t){const n=e.lastIndexOf(`:,${t[t.length-1]}))`);return n>-1?e.substring(0,n+`:,${t[t.length-1]}))`.length):""}componentDidMount(){Fv.Z.addListener(this.queryListener),qa.Z.addListener(this._onWebpageviewChanged)}componentWillUnmount(){qa.Z.removeListener(this._onWebpageviewChanged),Fv.Z.removeListener(this.queryListener)}_onWebpageviewChanged=e=>{e.winId===this.context.vivaldiWindowId&&"WEBPAGEVIEW_ACTIONS"===e.type&&"focusSearchField"===e.action&&this.refSearchInput.current?.select()};queryListener=()=>{this.setState({options:Fv.Z.getOptions(),...this.updateQuery()})};doSearch=()=>{let e="";this.state.contactQuery&&this.state.query?e=this.state.contactQuery+" AND "+this.state.query:this.state.contactQuery?e=this.state.contactQuery:this.state.query&&(e=this.state.query);let t=Fv.Z.getOptions();if(t.query=e,Be.Z.isValidSearch(t)){let e=t.queryOptions,n=t.queryFolder;if(!e){const t=Fv.Z.getSelectedFolder();if(t&&"current"===H.Z.get($.kMailSearchFolder))n=t;else{const t=Be.Z.getDefaultFilterForPath(this.state.isFeed?xe.u4:xe.of,xe.ym);e=Be.Z.getFilterOptions(t),n={name:t.accountId,accountId:t.accountId,path:t.path,id:xe.i4+"_"+t.accountId}}}t={...t,queryFolder:n,queryOptions:e}}l.Z.setSearchOptions(t);l.Z.updateQueryResults(e,void 0,void 0,t.queryAddition,!0)};onKeyDown=e=>{switch(e.key){case"Enter":case"Return":H.Z.get($.kMailSearchOnEnter)&&this.doSearch();break;case"Escape":if(!this.state.query){(0,to.ZP)(e);const t=ie.ZP.getActivePage(this.context.vivaldiWindowId);t&&Vv.Z.doAction(this.context.vivaldiWindowId,t.id,"focusWebView")}}};onQueryChange=()=>{const e=this.refSearchInput.current?.value,t=H.Z.get($.kMailSearchOnEnter)&&e?void 0:this.doDebounceSearch;this.setState({query:e},t)};render(){const e=!this.state.query&&!Be.Z.isValidSearch(this.state.options);return(0,fs.jsxs)(fs.Fragment,{children:[(0,fs.jsx)("input",{ref:this.refSearchInput,className:"searchfield-input",type:"search",placeholder:this.state.isFeed?(0,Oe.Z)("Search Feeds"):(0,Oe.Z)("Mail Search"),value:this.state.query,onChange:this.onQueryChange,onKeyDown:this.onKeyDown}),e&&Wv("button",{className:"MailSearchField-advancedSearchIcon",tooltip:(0,Oe.Z)("Open advanced mail search"),dangerouslySetInnerHTML:{__html:Ts.uZ2},onClick:l.Z.showMailSearchOptions})]})}}const Hv=Uv;var zv,Gv=n(19842);function $v(e,t,n,s){zv||(zv="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:zv,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Kv=[$.kPanelsAsOverlayEnabled,$.kPanelsPosition,$.kMailViewDimensions,$.kMailViewLayout,$.kToolbarsMail,$.kToolbarsMailComposer,$.kToolbarsMailMessage];var jv=$v(Hv,{});class Yv extends hs.Component{static contextType=xi.Z;winId=this.context.vivaldiWindowId;state={searchInput:"",panelWidth:ud.ZP.getWidth(this.winId),folder:"",width:0,margin:0};componentDidMount(){this.props.inEditor||(this.getFieldStyle(),ud.ZP.addListener(this.panelStoreChanged,(e=>e.windowData.get(this.context.vivaldiWindowId))),Fv.Z.addListener(this.selectedFolderChanged),this.selectedFolderChanged())}componentDidUpdate(e){e.prefValues[$.kMailViewDimensions]!==this.props.prefValues[$.kMailViewDimensions]&&this.getFieldStyle()}componentWillUnmount(){this.props.inEditor||(ud.ZP.removeListener(this.panelStoreChanged),Fv.Z.removeListener(this.selectedFolderChanged))}panelStoreChanged=()=>{this.setState({panelWidth:ud.ZP.getWidth(this.winId)},(()=>this.getFieldStyle()))};selectedFolderChanged=()=>{let e,t;const n=Fv.Z.getSelectedFolder();n&&(e=n.accountId,t=n.path,this.setState({folder:e+t}))};getView=()=>{const e=ie.ZP.getActivePage(this.context.vivaldiWindowId)?.url??"";let t="list";return(0,Gv.vE)(e)?t="composer":(0,Gv.Ds)(e)&&(t="message"),t};getFieldStyle=()=>{const{prefValues:e}=this.props,t=this.getView(),n="list"!==t?0:6;"horizontal"===e[$.kMailViewLayout]&&this.setState({width:260,margin:6});const{document:s,HTMLDivElement:i}=this.context,o=ud.ZP.getSelected(this.context.vivaldiWindowId),a=o&&!ud.ZP.getSeparateFloating(o,this.context.vivaldiWindowId)&&!e[$.kPanelsAsOverlayEnabled]&&"left"===e[$.kPanelsPosition],r=s.querySelector(".mainbar .toolbar-mailbar .toolbar-spacer-flexible:has(~ .SearchField)"),l=s.querySelector(".mainbar .toolbar-mailbar .SearchField"),d=Boolean(s.querySelector("#panels-container.overlay.minimized"));if("list"===t&&r instanceof i){const{panelWidth:t}=this.state,s=r.getClientRects()[0];if(s){const i=l?.getClientRects()[0]?.left||6,o=a?s.left>t?s.left-t+(i-s.right)+6:0:s.left,r=e[$.kMailViewDimensions],c="vertical_wide"===e[$.kMailViewLayout],h="left"===e[$.kPanelsPosition]&&d?34:0;this.setState({width:Math.min((c?r.widthWide:r.width)-o+h,800),margin:n})}}this.setState((e=>({width:e.width||260,margin:e.margin||6})))};render(){const e=qo({draggable:this.props.draggable,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,onDragEnter:this.props.onDragEnter,onDragOver:this.props.onDragOver,onDragLeave:this.props.onDragLeave,onDrop:this.props.onDrop});if(this.props.inEditor)return(0,fs.jsx)("input",{type:"text",value:(0,Oe.Z)("Mail Search"),readOnly:!0,...e});const t=this.props.buttonClasses;return(0,fs.jsx)("div",{className:As()("SearchField",t),style:"horizontal"!==this.props.prefValues[$.kMailViewLayout]?{flexBasis:this.state.width,marginRight:this.state.margin}:{},...e,children:jv})}}const Xv=sa(ta(Yv),Kv);async function Qv(){await Promise.all([Ie.Z.checkForMail(),Me.checkForMail(),new Promise((e=>setTimeout(e,1e3)))])}const qv=[$.kMailIsTurnedOff,$.kMailSearchSortField,$.kMailPreferredRendering,$.kMailViewLayout];class Jv extends hs.PureComponent{static contextType=xi.Z;state={canGoBack:!1,canGoForward:!1,isCheckingMail:!1};_isMounted=!1;componentDidMount(){this._isMounted=!0,Fv.Z.addListener(this.updateNavigationButtons),u.Z.addListener(this.updateNavigationButtons)}componentWillUnmount(){this._isMounted=!1,Fv.Z.removeListener(this.updateNavigationButtons),u.Z.removeListener(this.updateNavigationButtons)}updateNavigationButtons=()=>{this.setState({canGoBack:Fv.Z.canGoBack(),canGoForward:Fv.Z.canGoForward()})};checkForMail=async()=>{this.setState({isCheckingMail:!0}),await Qv(),this.setState({isCheckingMail:!1})};_onHistorySelection=e=>{l.Z.selectFolderFromHistory(this.context.vivaldiWindowId,e)};_getHistoryMenuPromise=e=>()=>{const t=Fv.Z.getHistoryIndex(),n=ie.ZP.getActivePage(this.context.vivaldiWindowId)?.url??"",s=Fv.Z.getSelectionHistory(),i="backward"===e?s.slice(0,t).reverse():s.slice(t+1),o="backward"===e?(e,t)=>e-t-1:(e,t)=>e+t+1,a=i.map(((e,s)=>({url:n,handler:()=>this._onHistorySelection(o(t,s)),...ae.Z.makeNumberMnemonic(e.name,s)})));return Promise.resolve(a)};mailBackMenu=this._getHistoryMenuPromise("backward");mailForwardMenu=this._getHistoryMenuPromise("forward");selectHistoryItem=e=>{l.Z.selectFolderFromHistory(this.context.vivaldiWindowId,e)};rewindFolderSelection=()=>{l.Z.selectFolderFromHistory(this.context.vivaldiWindowId,0)};forwardToEndOfFolderSelection=()=>{l.Z.selectFolderFromHistory(this.context.vivaldiWindowId,Fv.Z.getSelectionHistory().length-1)};navigate=e=>{const t=ie.ZP.getActivePage(this.context.vivaldiWindowId);t&&(e?Vv.Z.forward(this.context.vivaldiWindowId,t.id):Vv.Z.back(this.context.vivaldiWindowId,t.id))};toggleLayout=()=>{const e=["horizontal","vertical","vertical_wide"],t=e.indexOf(this.props.prefValues[$.kMailViewLayout]),n=e[(t+1)%3];Ne.Z.set($.kMailViewLayout,n)};render(){const{name:e,size:t,customizeMenu:n,menuOrigin:s,draggable:i,onDragStart:o,onDragEnd:a,onDrop:r,onDragEnter:l,mimeType:d}=this.props,c={name:e,size:t,customizeMenu:n,menuOrigin:s,draggable:i,onDragStart:o,onDragEnd:a,onDrop:r,onDragEnter:l,mimeType:d};switch(e){case"MailBack":return(0,fs.jsx)(Fa,{...c,disabled:!this.state.canGoBack,onClick:()=>this.navigate(!1),tooltip:(0,Oe.Z)("Go to previous page")+"\n"+(0,Oe.Z)("Hold for history list"),menu:this.mailBackMenu,image:Ts.mgF[this.props.size]});case"MailForward":return(0,fs.jsx)(Fa,{...c,disabled:!this.state.canGoForward,onClick:()=>this.navigate(!0),tooltip:(0,Oe.Z)("Go to next page")+"\n"+(0,Oe.Z)("Hold for forward history list"),menu:this.mailForwardMenu,image:Ts.Zu[this.props.size]});case"MailReload":return(0,fs.jsx)(Fa,{...c,className:this.state.isCheckingMail?"btn-toolbar-spinner":"",disabled:this.props.disabled||this.state.isCheckingMail,tooltip:(0,Oe.Z)("Check for mail"),onClick:this.checkForMail,image:Ts.QPh[this.props.size]});case"MailRenderingMethod":{const e=this.props.prefValues[$.kMailPreferredRendering],n="prefer_html"===e?Ts.lOb[t]:Ts.dYD[t],s="prefer_html"===e?(0,Oe.Z)("Show Messages as Text"):(0,Oe.Z)("Show Messages as HTML");return(0,fs.jsx)(Fa,{...c,tooltip:s,onClick:()=>Ne.Z.toggle($.kMailPreferredRendering,"prefer_html","plaintext"),image:n})}case"MailViewLayout":const n=this.props.prefValues[$.kMailViewLayout];let s=Ts.s2Z[t];return"vertical"===n?s=Ts.Q_G[t]:"vertical_wide"===n&&(s=Ts.hR9[t]),(0,fs.jsx)(Fa,{...c,tooltip:(0,Oe.Z)("Toggle View"),onClick:this.toggleLayout,disabled:this.props.prefValues[$.kMailIsTurnedOff],image:s});case"MailViewThreading":const i="threads"===this.props.prefValues[$.kMailSearchSortField];return(0,fs.jsx)(Fa,{...c,tooltip:i?(0,Oe.Z)("Hide Message Threads"):(0,Oe.Z)("Show Message Threads"),onClick:()=>Ne.Z.set($.kMailSearchSortField,i?"sentDate":"threads"),image:i?Ts.AE4[t]:Ts.eCP[t]});default:return console.warn(`ToolbarButton “${e}” not found`),null}}}const ef=sa(Jv,qv);var tf=n(98611);const nf=new Set,sf=new Set,of=new Map;class af extends Ol.Z{hasError(e){return this.isDisconnected(e)&&void 0!==this.getErrorMessage(e)}hasAuthenticationError(e){if(this.hasError(e)){const t=this.getErrorMessage(e);return!!t&&t.toString().toLowerCase().indexOf("authentication")>=0}return!1}isDisconnected(e){return!sf.has(e)}isConnecting(e){return nf.has(e)}isConnected(e){return!this.isConnecting(e)&&!this.isDisconnected(e)}getErrorMessage(e){return of.get(e)}dispatchAction(e){switch(e.actionType){case"MAIL_IS_DISCONNECTED":{const{accountId:t,isDisconnected:n,errorMessage:s}=e;let i=!1;n?(i=sf.has(t),sf.delete(t)):(i=!sf.has(t),sf.add(t)),s?(of.set(t,s),i=!0):of.get(t)&&(of.delete(t),i=!0),i&&this.emitChange({accountId:t,isDisconnected:n});break}case"MAIL_IS_CONNECTING":{const{accountId:t,isConnecting:n}=e;let s=!1;n?(s=!nf.has(t),nf.add(t)):(s=nf.has(t),nf.delete(t)),s&&this.emitChange({accountId:t,isConnecting:n});break}}}}const rf=new af(y.Z);var lf;function df(e,t,n,s){lf||(lf="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:lf,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}hf.defaultProps={size:32};const cf="/resources/vivaldi_mail_default.png";function hf(e){let t=e.emailAddress.split("@")[1]||"";return t="gmail.com"===t?"https://ssl.gstatic.com/ui/v1/icons/mail/images/favicon5.ico":"googleusercontent.com"===t?"https://google.com/favicon.ico":ws(t),df(Ss,{size:e.size,className:e.className,url:t?(0,vs.q9)(t):cf,fallbackUrl:cf,loadType:"faviconSkipCache"})}const pf=hf;var uf,gf=n(95752),mf=n(307),vf=n(59275);function ff(e,t,n,s){uf||(uf="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:uf,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const yf=[$.kKeyboardTabToAll];function Cf(e){return e.some((e=>"error"===e.level))}var wf=ff("br",{});class bf extends hs.PureComponent{static contextType=xi.Z;constructor(e,t){super(e);const n=Tu.getLogsByComponent(["Mail","oAuth"]);this.state={activeListEntry:u.Z.getActiveListEntry(),isMailTabActive:Boolean(ie.ZP.getActivePage(t.vivaldiWindowId)?.isMailPage),selectedPane:e.requestPane?e.requestPane:H.Z.get($.kMailStatusSelectedPane),logs:n,hasLoggedError:Cf(n),isCheckingMail:!1}}componentDidMount(){const{selectWindow:e}=this.context;u.Z.addListener(this.handleActiveMessageStoreChange),ie.ZP.addListener(this.checkIfMailTabActive,e),Tu.addListener(this.handleLogStoreChange)}componentWillUnmount(){u.Z.removeListener(this.handleActiveMessageStoreChange),ie.ZP.removeListener(this.checkIfMailTabActive),Tu.removeListener(this.handleLogStoreChange)}checkIfMailTabActive=()=>{const e=Boolean(ie.ZP.getActivePage(this.context.vivaldiWindowId)?.isMailPage);this.setState({isMailTabActive:e})};handleActiveMessageStoreChange=()=>{this.updateCurrentMessageDebounced()};handleLogStoreChange=()=>{const e=Tu.getLogsByComponent(["Mail","oAuth"]);this.setState({logs:e,hasLoggedError:Cf(e)})};updateCurrentMessageDebounced=(0,no.Z)((()=>{this.setState({activeListEntry:u.Z.getActiveListEntry()})}));_selectPane=e=>{Ne.Z.set($.kMailStatusSelectedPane,e),this.setState({selectedPane:e})};_openMessage=async e=>{const t=await Re.Z.messages.get(e);this.props.hidePopup(),(0,mf.Z)(this.context.vivaldiWindowId,t)};_authenticate=async e=>{const t=await fn.Z.loadAccount(e);Ae.Z.showMailAuthenticationDialog(this.context.vivaldiWindowId,{account:t}),this.props.hidePopup()};_viewLog=()=>{C.Z.devtoolsPrivate.toggleDevtools(this.context.vivaldiWindowId,"console"),this.props.hidePopup()};_restoreFullTextSearchDb=async()=>{const e={title:(0,Oe.Z)("title","Rebuild Mail Search Database"),body:(0,Oe.Z)("Note: This task could take several minutes."),actions:[{title:(0,Oe.Z)("Rebuild"),action:"confirm"}],cancelAction:{title:(0,Oe.Z)("Cancel"),action:"cancel",default:!0}},{action:t}=await Ae.Z.showModal(this.context.vivaldiWindowId,{modal:e});"cancel"!==t&&(await Re.Z.systemTasks.add({taskName:"restore_full_text_search_db",currentPosition:0}),Se.Z.runSystemTasks())};_openAccount=()=>{this.props.hidePopup()};openMailSettings=()=>{Ae.Z.showSettings(this.context.vivaldiWindowId,"mail"),this.props.hidePopup()};getContextMenu=()=>{const e=H.Z.get($.kMailAccounts),t=[xe.of].concat(e.map((e=>e.MAIL_EMAIL)));return[{handler:this.openMailSettings,...(0,xs.Z)("Mail Settings")},{handler:this._viewLog,...(0,xs.Z)("View Log")},{handler:this._restoreFullTextSearchDb,...(0,xs.Z)("command","Rebuild Mail Search Database")},{...(0,xs.Z)("Select Folder"),items:t.map((e=>({type:"checkbox",checked:this.props.accountId===e,handler:()=>this.props.switchAccount(e),label:e,labelEnglish:e})))}]};checkForMail=async()=>{this.setState({isCheckingMail:!0}),await Qv(),this.setState({isCheckingMail:!1})};render(){const e=H.Z.get($.kMailAccounts),t=this.state.activeListEntry;return(0,fs.jsxs)(fs.Fragment,{children:[ff("div",{className:"StatusPopup-Header"},void 0,ff("h2",{},void 0,(0,Oe.Z)("Mail Status")),ff("div",{className:"toolbar button-popup-header-toolbar toolbar-default"},void 0,ff(Fa,{onClick:()=>{Ae.Z.showMail(this.context.vivaldiWindowId),this.props.hidePopup()},disabled:this.state.isMailTabActive,menuOrigin:"bottomLeft",title:(0,Oe.Z)("Show Mail")}),ff(Fa,{menuOrigin:"bottomLeft",image:Ts.bqs.small,menu:this.getContextMenu,tooltip:(0,Oe.Z)("Recent message settings")}))),ff("div",{className:"toolbar toolbar-default"},void 0,ff("div",{className:"toolbar-group equal-width"},void 0,ff(Fa,{title:(0,Oe.Z)("Messages"),isPressed:"messages"===this.state.selectedPane,onClick:()=>this._selectPane("messages")}),ff(Fa,{title:(0,Oe.Z)("Accounts"),isPressed:"accounts"===this.state.selectedPane,onClick:()=>this._selectPane("accounts")}),ff(Fa,{title:(0,Oe.Z)("Logs"),isPressed:"logs"===this.state.selectedPane,onClick:()=>this._selectPane("logs"),badgeText:this.state.hasLoggedError?"!":""}))),ff("div",{className:"StatusPopup-Content"},void 0,"accounts"===this.state.selectedPane&&ff("div",{className:"StatusPopup-ContentPane"},void 0,ff("div",{className:"StatusPopup-List"},void 0,e.map((e=>{const t=e.MAIL_EMAIL;let n;return e.offline?n="offline":navigator.onLine?rf.isConnected(t)?n="connected":rf.isConnecting(t)?n="connecting":rf.hasAuthenticationError(t)?n="needsAuth":rf.hasError(t)?n="hasError":e.accountType===xe.s9.IMAP?n="disconnected":e.accountType===xe.s9.POP&&(n="connected"):n="noNetwork",ff(hs.Fragment,{},t,ff("button",{tabIndex:this.props.prefValues[$.kKeyboardTabToAll],onClick:()=>this._openAccount(),className:"StatusPopup-Account"},void 0,ff(pf,{emailAddress:t,size:16,className:"StatusPopup-AccountIcon"}),ff("div",{className:"StatusPopup-AccountName"},void 0,t),ff("div",{className:"StatusPopup-AccountStatus"},void 0,"offline"===n&&(0,fs.jsxs)(fs.Fragment,{children:[ff("span",{className:"StatusPopup-AccountStatus--Success",title:(0,Oe.Z)("mail","Offline"),dangerouslySetInnerHTML:{__html:Ts.bBo.small}}),(0,Oe.Z)("mail","Offline")]}),"connected"===n&&(0,fs.jsxs)(fs.Fragment,{children:[ff("span",{className:"StatusPopup-AccountStatus--Success",title:(0,Oe.Z)("Connected"),dangerouslySetInnerHTML:{__html:Ts.JLz}}),(0,Oe.Z)("Connected")]}),"connecting"===n&&(0,fs.jsxs)(fs.Fragment,{children:[ff("span",{className:"StatusPopup-AccountStatus--Warning",title:(0,Oe.Z)("Connecting..."),dangerouslySetInnerHTML:{__html:Ts.rvX.small}}),(0,Oe.Z)("Connecting...")]}),"needsAuth"===n&&(0,fs.jsxs)(fs.Fragment,{children:[ff("span",{className:"StatusPopup-AccountStatus--Error",title:(0,Oe.Z)("Authentication Error"),dangerouslySetInnerHTML:{__html:Ts.viW}}),(0,Oe.Z)("Authentication Error")]}),"hasError"===n&&(0,fs.jsxs)(fs.Fragment,{children:[ff("span",{className:"StatusPopup-AccountStatus--Error",title:rf.getErrorMessage(t)||(0,Oe.Z)("Error"),dangerouslySetInnerHTML:{__html:Ts.viW}}),(0,Oe.Z)("Error")]}),"noNetwork"===n&&(0,fs.jsxs)(fs.Fragment,{children:[ff("span",{className:"StatusPopup-AccountStatus--Warn",title:(0,Oe.Z)("No Network"),dangerouslySetInnerHTML:{__html:Ts.GH$}}),(0,Oe.Z)("No Network")]}),"disconnected"===n&&(0,fs.jsxs)(fs.Fragment,{children:[ff("span",{className:"StatusPopup-AccountStatus--Warn",title:(0,Oe.Z)("Disconnected"),dangerouslySetInnerHTML:{__html:Ts.GH$}}),(0,Oe.Z)("Disconnected")]}),!n&&(0,fs.jsxs)(fs.Fragment,{children:[ff("span",{className:"StatusPopup-AccountStatus--Warn",title:(0,Oe.Z)("Unknown"),dangerouslySetInnerHTML:{__html:Ts.GH$}}),(0,Oe.Z)("Status Unknown")]}),"needsAuth"===n&&ff("a",{className:"StatusPopup-AccountStatusRetry",tabIndex:this.props.prefValues[$.kKeyboardTabToAll],onClick:this._authenticate.bind(this,t),href:""},void 0,(0,Oe.Z)("Retry")))))}))),ff("div",{className:"StatusPopup-Footer"})),"messages"===this.state.selectedPane&&ff("div",{className:"StatusPopup-ContentPane"},void 0,(0,fs.jsxs)(fs.Fragment,{children:[this.props.recentMessages.length>0&&ff("h3",{},void 0,this.props.accountId===xe.of?(0,Oe.Z)("Recent in All Messages"):(0,Oe.Z)("Recent in $1",[(0,Oe.Z)(this.props.accountId)])),ff("div",{className:"StatusPopup-List"},void 0,this.props.recentMessages.map((e=>{const t=yn.Z.get(e.toIds),n=t.length>0?t[0].address:"",s=yn.Z.get(e.fromIds),i=s.length>0?s[0].address:"";return ff("button",{tabIndex:this.props.prefValues[$.kKeyboardTabToAll],className:As()("StatusPopup-Mail",{"StatusPopup-Mail--Unread":!gf.Z.call(e.sources)}),onClick:()=>this._openMessage(e.id)},e.id,ff(pf,{emailAddress:n,size:16,className:"StatusPopup-MailIcon"}),ff("div",{className:"StatusPopup-MailTitle"},void 0,e.subject),ff("div",{className:"StatusPopup-MailReceiver"},void 0,i," ➝ ",n),ff("div",{className:"StatusPopup-MailDate"},void 0,N()(e.sentDate).fromNow()))}))),t&&(0,fs.jsx)(fs.Fragment,{children:ff("dl",{className:"StatusPopup-MailDetail"},void 0,ff("dt",{},void 0,(0,Oe.Z)("Current Message")),ff("dd",{},void 0,t.subject),ff("dt",{},void 0,(0,Oe.Z)("Internal ID")),ff("dd",{},void 0,t.id),ff("dt",{},void 0,(0,Oe.Z)("Thread ID")),ff("dd",{},void 0,t.threadKey),ff("dt",{},void 0,(0,Oe.Z)("Flags")),ff("dd",{},void 0," ",t.flags.join(", ")),[...t.sources.entries()].map((([e,t])=>{const n=De.Z.get(e);if(n)return ff(hs.Fragment,{},e,ff("dt",{},void 0,(0,Oe.Z)("Filter ID: $1",[e])),ff("dd",{},void 0,ff("span",{},void 0,t.read?(0,Oe.Z)("Read"):(0,Oe.Z)("Unread")),", ",ff("span",{},void 0,t.deleted?(0,Oe.Z)("Deleted"):(0,Oe.Z)("Not deleted")),", ",ff("span",{},void 0,t.internal?(0,Oe.Z)("Internal"):(0,Oe.Z)("External")),wf,ff("span",{},void 0,`${n.accountId} ${(0,vf.e)(n.name)}`)))})))})]}),ff("div",{className:"StatusPopup-Footer toolbar-default"},void 0,ff(Fa,{className:this.state.isCheckingMail?"btn-toolbar-spinner":"",disabled:this.state.isCheckingMail,onClick:()=>this.checkForMail(),title:(0,Oe.Z)("Check for New Messages"),image:this.state.isCheckingMail?Ts.QPh.small:void 0}))),"logs"===this.state.selectedPane&&ff("div",{className:"StatusPopup-ContentPane"},void 0,ff(xu,{logs:this.state.logs,component:"Mail"})))]})}}const Sf=sa(bf,yf);function If(e){return e>0?e>9999?(0,Oe.Z)("$1 K",[Math.round(e/1e3)]):e.toString():""}var kf;function Af(e,t,n,s){kf||(kf="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:kf,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Tf=[$.kMailAccounts,$.kMailCountersPanelUnseenEnabled,$.kMailCountersStatusButtonEnabled,$.kMailIsTurnedOff,$.kMailStatusButtonStyle,$.kRssSettings];function Zf(){const e=tf.Z.getCounters("All Messages","Unread");return{unseen:e?.unseen||0,unread:e?.unread||0}}function Ef(){const e=Zf();return{accountId:xe.of,isPopupOpen:!1,recentMessages:[],hasErrors:!1,...e}}class _f extends hs.PureComponent{static contextType=xi.Z;#h=!1;constructor(e){super(e),this.state={...Ef()}}componentDidMount(){tf.Z.addListener(this.handleMailFiltersStoreChange),mg.addListener(this.popupStateChanged),Tu.addListener(this.handleLogStoreChange),this.#h=!0}componentWillUnmount(){this.#h=!1,tf.Z.removeListener(this.handleMailFiltersStoreChange),mg.removeListener(this.popupStateChanged),Tu.removeListener(this.handleLogStoreChange)}static getDerivedStateFromError(){return Ef()}popupStateChanged=()=>{const e=mg.getState().mailPopupOpen;this.setState({isPopupOpen:e})};getMessageCount=()=>this.props.prefValues[$.kMailCountersPanelUnseenEnabled]?this.state.unseen:this.state.unread;handleMailFiltersStoreChange=e=>{switch(e.target){case"counters":case"finishIndexProgress":this.updateRecentMessagesAndCounters()}};hidePopup=()=>{this.setState({isPopupOpen:!1}),pg.close("Mail")};togglePopup=()=>{this.setState((e=>({isPopupOpen:!e.isPopupOpen})))};openMailAccountSheet=()=>{Ae.Z.showMailAccountDialog(this.context.vivaldiWindowId)};openMailSettings=()=>{Ae.Z.showSettings(this.context.vivaldiWindowId,"mail")};mailHasErrors=()=>Tu.getLogsByComponent(["Mail","oAuth"]).some((e=>"error"===e.level));handleLogStoreChange=()=>{this.setState({hasErrors:this.mailHasErrors()})};#m=0;updateRecentMessagesAndCounters=()=>{const e=Zf(),t=tf.Z.getIndex(),n=t.length;if(n<this.#m){const t=this.state.recentMessages.filter((e=>tf.Z.getListEntry(e.id)));t.length!==this.state.recentMessages.length&&(e.recentMessages=t),this.#m=n}else if(n>this.#m){let s=!1;const i=[...this.state.recentMessages],o=(this.state.accountId===xe.of?De.Z.getAll():De.Z.getByAccountId(this.state.accountId)).filter((e=>vn.Z.getFolderType(e.accountId,e.path)===xe.e9)).map((e=>e.id)),a=e=>e.sourceFilterIds.some((e=>o.includes(e)));for(let e=n;e>this.#m;e--){const n=t[e-1];if(a(n)&&(i.length<5||i[i.length-1].sentDate<=n.sentDate)){let e=0;for(;e<i.length&&!(i[e].sentDate<=n.sentDate);e++);i.splice(e,0,n),i.length>5&&i.pop(),s=!0}}s&&(e.recentMessages=i),this.#m=n}e.hasErrors=this.mailHasErrors(),this.setState(e)};switchAccount=e=>{this.#m=0,this.setState({accountId:e,recentMessages:[]},(()=>{this.updateRecentMessagesAndCounters()}))};getTooltip=()=>{const e=this.props.prefValues[$.kMailIsTurnedOff],t=this.props.prefValues[$.kMailAccounts].length+this.props.prefValues[$.kRssSettings].length>0;if(e||!t)return(0,Oe.Z)("Mail");const n=this.props.prefValues[$.kMailCountersPanelUnseenEnabled],s=this.getMessageCount();let i=(0,Oe.Z)("Mail Status");return s>0&&(i+=" "+(n?(0,Oe.Z)("($1 unseen)","($1 unseen)",[s]):(0,Oe.Z)("($1 unread)","($1 unread)",[s]))),this.state.recentMessages.length>0&&(i+="\n\n"),this.state.recentMessages.forEach(((e,t)=>{t>0&&(i+="\n\n"),i+=e.subject;const n=yn.Z.get(e.fromIds);n.length>0&&(i+="\n"+n[0].address)})),i};menu=()=>{const e=this.props.prefValues[$.kMailStatusButtonStyle],t=this.props.prefValues[$.kMailCountersStatusButtonEnabled];return[{handler:this.openMailSettings,...(0,xs.Z)("Mail Settings")},{items:[{type:"checkbox",checked:"imageandtext"===e,handler:()=>Ne.Z.set($.kMailStatusButtonStyle,"imageandtext"),...(0,xs.Z)("Image and Text")},{type:"checkbox",checked:"image"===e,handler:()=>Ne.Z.set($.kMailStatusButtonStyle,"image"),...(0,xs.Z)("Image Only")},{type:"checkbox",checked:"text"===e,handler:()=>Ne.Z.set($.kMailStatusButtonStyle,"text"),...(0,xs.Z)("title","Text Only")}],...(0,xs.Z)("Button Style")},{type:"checkbox",checked:t,handler:()=>Ne.Z.set($.kMailCountersStatusButtonEnabled,!t),...(0,xs.Z)("Show Message Counter")}]};render(){const e=this.props.prefValues[$.kMailStatusButtonStyle];if(!(this.props.inEditor||!this.props.prefValues[$.kMailIsTurnedOff]&&G.ZP.isMail(this.context.vivaldiWindowId)))return null;const t=this.props.prefValues[$.kMailCountersStatusButtonEnabled],n=!G.ZP.isMail(this.context.vivaldiWindowId),s=this.props.prefValues[$.kMailAccounts].length+this.props.prefValues[$.kRssSettings].length>0,i=this.props.prefValues[$.kMailCountersPanelUnseenEnabled];let o="";return this.state.hasErrors?o="!":t&&(o=If(this.getMessageCount())),Af(Fa,{badgeText:o??"",className:As()(this.state.hasErrors?"StatusButton--HasError":"StatusButton",{unseen:i}),disabled:n,onClick:s?this.togglePopup:this.openMailAccountSheet,customizeMenu:this.props.customizeMenu,menuOrigin:this.props.menuOrigin,tooltip:this.getTooltip(),title:"image"!==e?(0,Oe.Z)("Mail Status"):void 0,image:"text"!==e?Ts.lvj[this.props.size]:void 0,draggable:this.props.draggable,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,onDrop:this.props.onDrop,onDragEnter:this.props.onDragEnter,mimeType:this.props.mimeType,name:this.props.name,hidePopup:this.hidePopup,popupPosition:this.props.popupPosition,popupClassName:"StatusPopup",popupWidth:400,isPopupVisible:this.state.isPopupOpen,menu:this.menu,size:this.props.size},void 0,!n&&Af(Sf,{switchAccount:this.switchAccount,recentMessages:this.state.recentMessages,accountId:this.state.accountId,hidePopup:this.hidePopup,requestPane:this.state.hasErrors?"logs":void 0}))}}const Mf=sa(_f,Tf);var Nf=n(36964),Pf=n(43630);const Df={getItems:function(e,t){const n=[],s="read"===t?H.Z.get($.kMailReadHeadersHidden):H.Z.get($.kMailComposeHeadersHidden);return e.map((e=>{n.push({type:"checkbox",checked:!s.includes(e.ref),handler:this._setField.bind(this,e.ref,t),...e.labels})})),n},_setField:function(e,t){const n="read"===t?$.kMailReadHeadersHidden:$.kMailComposeHeadersHidden;let s=H.Z.get(n).slice();s.includes(e)?s=s.filter((t=>t!==e)):s.push(e),Ne.Z.set(n,s)}};var xf=n(75401),Of=n(84283),Lf=n(89165),Rf=n(6129);function Bf(e){const{enabledButtons:t}=e,{isJunkSelected:n,isNonJunkSelected:s,isDeletedSelected:i,isNonDeletedSelected:o,isArchivedSelected:a,isNonArchivedSelected:r,selectionCount:l,isOutboundSelected:d,isOutboxDraftsSelected:c,isReadSelected:p,isUnreadSelected:u,isArchivableSelected:g,isJunkableSelected:m}=function(){const e={isDeletedSelected:!1,isNonDeletedSelected:!1,isJunkSelected:!1,isNonJunkSelected:!1,isJunkableSelected:!1,isArchivedSelected:!1,isNonArchivedSelected:!1,isArchivableSelected:!1,isOutboundSelected:!1,isOutboxDraftsSelected:!1,isReadSelected:!1,isUnreadSelected:!1,selectionCount:0},t=Fi.Z.get(h.uP);if(!t)return e;const n=[xe.Nz,xe.fZ,xe.kY],s=[xe.fZ,xe.kY];for(const i of t.selectedIds){const t=tf.Z.getListEntry(i.id);if(!t)continue;e.selectionCount++;const{sourceFilterIds:o,sources:a,flags:r}=t;if(!e.isOutboundSelected){const t=De.Z.getByIds(o),s=vn.Z.getFolderTypes(t);e.isOutboundSelected=n.some((e=>s.has(e)))}if(!e.isOutboxDraftsSelected){const t=De.Z.getByIds(o),n=vn.Z.getFolderTypes(t);e.isOutboxDraftsSelected=s.some((e=>n.has(e)))}e.isDeletedSelected&&e.isNonDeletedSelected||(Of.Z.isMessageDeleted(a)?e.isDeletedSelected=!0:e.isNonDeletedSelected=!0),e.isJunkSelected&&e.isNonJunkSelected&&e.isJunkableSelected||((0,Lf.Z)(a,r)?(e.isJunkSelected=!0,e.isJunkableSelected=!0):(e.isNonJunkSelected=!0,!e.isJunkableSelected&&Ff(o,xe.Hd)&&(e.isJunkableSelected=!0))),e.isArchivedSelected&&e.isNonArchivedSelected&&!e.isArchivableSelected||((0,xf.Z)(a)?(e.isArchivedSelected=!0,e.isArchivableSelected=!0):(e.isNonArchivedSelected=!0,!e.isArchivableSelected&&(H.Z.get($.kMailAddArchiveFolder)?Vf(o):Ff(o,xe.hn))&&(e.isArchivableSelected=!0))),e.isReadSelected&&e.isUnreadSelected||(gf.Z.call(a)?e.isReadSelected=!0:e.isUnreadSelected=!0)}return e}();if(0===l)return void t.clear();const v=1===l&&!d;t.set("MailMsgTrash",!(i&&o)),t.set("MailMsgSpam",m&&!(n&&s)),t.set("MailMsgArchive",g&&!(a&&r)),t.set("MailMsgReply",v),t.set("MailMsgReplyToAll",v),t.set("MailMsgFlag",!c),t.set("MailMsgLabel",!c),t.set("MailMsgStatusRead",!(p&&u))}function Ff(e,t){const n=De.Z.getByIds(e);return[...new Set(n.map((({accountId:e})=>e)))].some((e=>mn.Z.getFoldersOfType(e,t).length>0))}function Vf(e){const t=De.Z.getByIds(e);return[...new Set(t.map((({accountId:e})=>e)))].some((e=>(0,Rf.ZA)(e)))}class Wf extends F.Z{getInitialState(){return{enabledButtons:new Map,hiddenButtons:new Map}}reduce(e,t){switch(t.actionType){case"MAIL_SELECT_FOLDER":case"MAIL_REFRESH_ACTIVE_MESSAGE":return(0,V.Uy)(e,(e=>{Bf(e),function(e){const{hiddenButtons:t}=e,n=Fv.Z.getSelectedFolder();if(!n)return void t.clear();const{accountId:s,path:i}=n,o=vn.Z.getFolderType(s,i),a=[xe.kY,xe.fZ].includes(o),r=[xe.Nz,xe.uT].includes(o);t.set("MailMsgEdit",!a),t.set("MailMsgSpam",a||r),t.set("MailMsgArchive",a||r),t.set("MailMsgReply",a),t.set("MailMsgReplyToAll",a),t.set("MailMsgStatusRead",a||o===xe.Nz),t.set("MailMsgFlag",a),t.set("MailMsgLabel",a)}(e)}));default:return e}}isEnabled(e){if(""!==wa.getState())return!0;const{enabledButtons:t}=this.getState();return t.get(e)??!1}isHidden(e){if(""!==wa.getState())return!1;const{hiddenButtons:t}=this.getState();return t.get(e)??!1}}const Uf=new Wf;var Hf,zf=n(49168);function Gf(e,t,n,s){Hf||(Hf="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Hf,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class $f extends hs.Component{_isIMEOpen=!1;state={newLabel:""};onSave=async()=>{if(this._isIMEOpen||!this.state.newLabel||this.doesLabelExist(this.state.newLabel))return;const e=(0,zf.A4)(this.state.newLabel),t=u.Z.getActiveListEntry(),n=t?(0,zf.Q3)(t.flags):[];await l.Z.addLabelsFilter(e),Pf.Z.toggleLabel(this.props.windowId,e,n)(),this.props.onClose()};onCancel=()=>{this.props.onClose()};doesLabelExist=e=>{const t=tf.Z.getByAccountId(xe.ut).map((e=>e.name.toLowerCase()));return t.includes(xe.ow+e.toLowerCase())||t.includes(e.toLowerCase())};newLabelChanged=e=>{if(this._isIMEOpen)return void this.setState({newLabel:e.target.value});const t=(0,zf.Tv)(e.target.value);t!==this.state.newLabel&&this.setState({newLabel:t})};render(){const{newLabel:e}=this.state,t=this.doesLabelExist(e);return Gf(_r.Z,{onRequestClose:this.onCancel,viewMode:this.props.viewMode},void 0,Gf("header",{className:"dialog-header"},void 0,Gf("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("Add a New Label"))),Gf("form",{onSubmit:this.onSave},void 0,Gf("div",{className:"dialog-content"},void 0,Gf("input",{type:"text",className:"new-label",maxLength:zf.Ws,onChange:this.newLabelChanged,onCompositionStart:()=>this._isIMEOpen=!0,onCompositionEnd:e=>{this._isIMEOpen=!1,this.newLabelChanged(e)},value:(0,mc.kF)(e),autoFocus:!0}),t&&Gf(tc,{type:"info"},void 0,(0,Oe.Z)("Label “$1” already exists.",[(0,mc.kF)(e)]))),Gf("footer",{className:"dialog-footer"},void 0,Gf("input",{type:"submit",className:"primary",value:(0,Oe.Z)("Save"),disabled:""===e||t}),Gf("input",{type:"button",value:(0,Oe.Z)("Cancel"),onClick:this.onCancel}))))}}const Kf=$f;const jf=function(e,t){const n=[];return t?(n.push({handler:()=>Pf.Z.undelete(e),...(0,xs.Z)("mail","Undelete")}),n.push({handler:()=>Pf.Z.prepareDelete(e,!0),...(0,xs.Z)("mail","Delete Permanently")})):n.push({handler:()=>Pf.Z.prepareDelete(e,!1),...(0,xs.Z)("mail","Move to Trash")}),n};var Yf;function Xf(e,t,n,s){Yf||(Yf="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Yf,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Qf=[{ref:"from",labels:(0,xs.Z)("sender","From")},{ref:"cc",labels:(0,xs.Z)("Carbon Copy")},{ref:"bcc",labels:(0,xs.Z)("Blind Carbon Copy")}],qf=[$.kMailSendOrQueue];class Jf extends hs.PureComponent{static contextType=xi.Z;state={standardFlag:"",customLabels:[],unread:!1,messageSelected:!1,showLabel:!1,disableTrash:!0,disableJunk:!0,disableArchive:!0,disableMarkRead:!0};componentDidMount(){this.props.inEditor||(u.Z.addListener(this.activeMessageStoreChanged),Uf.addListener(this.updateButtonStatus),this.activeMessageStoreChanged(),this.updateButtonStatus())}activeMessageStoreChanged=()=>{const e=u.Z.getActiveListEntry();if(e){const t=tf.Z.getListEntry(e.id);if(t){const e=Fv.Z.getSelectedFolder(),n=e&&tf.Z.getByFolder(e.accountId,e.path);this.setState({messageSelected:!0,unread:!gf.Z.call(t.sources,n),standardFlag:(0,zf.Zr)(t.flags),customLabels:(0,zf.Q3)(t.flags)})}else this.setState({messageSelected:!1})}else this.setState({messageSelected:!1})};updateButtonStatus=()=>{this.setState({disableTrash:!Uf.isEnabled("MailMsgTrash"),disableJunk:!Uf.isEnabled("MailMsgSpam"),disableArchive:!Uf.isEnabled("MailMsgArchive"),disableMarkRead:!Uf.isEnabled("MailMsgStatusRead")})};componentWillUnmount(){this.props.inEditor||(u.Z.removeListener(this.activeMessageStoreChanged),Uf.removeListener(this.updateButtonStatus))}createCustomLabel=()=>{this.setState({showLabel:!0})};closeCustomFlagDlg=()=>{this.setState({showLabel:!1})};getSendQueueMenu=()=>[{type:"checkbox",checked:"send"===this.props.prefValues[$.kMailSendOrQueue],handler:this.sendAndSetSendAsDefault,...(0,xs.Z)("Send")},{type:"checkbox",checked:"queue"===this.props.prefValues[$.kMailSendOrQueue],handler:this.queueAndSetQueueAsDefault,...(0,xs.Z)("Queue")}];sendAndSetSendAsDefault=()=>{"send"!==this.props.prefValues[$.kMailSendOrQueue]&&Ne.Z.set($.kMailSendOrQueue,"send")};queueAndSetQueueAsDefault=()=>{"queue"!==this.props.prefValues[$.kMailSendOrQueue]&&Ne.Z.set($.kMailSendOrQueue,"queue")};deleteDraftMessage=()=>{d.ZP.close(this.context.vivaldiWindowId),Nf.Z.deleteDraftMessage()};customLabelsMenuData=()=>{const e=Pf.Z.getCustomLabelsMenu(this.context.vivaldiWindowId,this.state.customLabels);return e.push(ae.Z.separatorItem,{handler:this.createCustomLabel,ellipsis:!0,...(0,xs.Z)("Add New Label")}),this.state.customLabels.length>0&&e.push(ae.Z.separatorItem,{handler:()=>Pf.Z.clearAllLabels(this.context.vivaldiWindowId,this.state.customLabels),...(0,xs.Z)("Clear All Labels")}),e};render(){let e=u.Z.isTrash(),t=u.Z.isJunk(),n=u.Z.isArchived();const s=this.props.size,i=this.context.vivaldiWindowId;if(!this.props.preview&&Uf.isHidden(this.props.name))return null;const{draggable:o,onDragStart:a,onDragEnd:r,onDrop:l,onDragEnter:d,mimeType:c,name:h,size:p,customizeMenu:g,menuOrigin:m}=this.props,v={draggable:o,customizeMenu:g,onDragStart:a,onDragEnd:r,onDrop:l,onDragEnter:d,mimeType:c,name:h,size:p,menuOrigin:m};switch(this.props.name){case"MailMsgEdit":return(0,fs.jsx)(Fa,{...v,tooltip:(0,bd.wY)(h),onClick:()=>Pf.Z.openMessage(i),disabled:!this.state.messageSelected||!Fv.Z.isFolderAnEditMailFolder(),image:Ts.NNg[s]});case"MailMsgReply":return(0,fs.jsx)(Fa,{...v,tooltip:(0,bd.wY)(h)+" "+J.Z.getShortcut("COMMAND_MAIL_REPLY"),onClick:()=>Pf.Z.reply(),disabled:!this.state.messageSelected,image:Ts.hGk[s]});case"MailMsgReplyToAll":const o=u.Z.isListPost();return(0,fs.jsx)(Fa,{...v,tooltip:o?(0,Oe.Z)("Reply to Mailing List")+" "+J.Z.getShortcut("COMMAND_MAIL_REPLY_LIST"):(0,bd.wY)(h)+" "+J.Z.getShortcut("COMMAND_MAIL_REPLY_ALL"),onClick:o?()=>Pf.Z.replyList():()=>Pf.Z.replyAll(),disabled:!this.state.messageSelected,image:Ts.Sap[s],isMenuIndicatorVisible:o,menu:o?()=>Pf.Z.getReplyMenu():void 0});case"MailMsgForward":return(0,fs.jsx)(Fa,{...v,tooltip:(0,bd.wY)(h)+" "+J.Z.getShortcut("COMMAND_MAIL_FORWARD"),onClick:()=>Pf.Z.forward(),disabled:!this.state.messageSelected,image:Ts.upG[s]});case"MailMsgStatusRead":case"MailMsgStatusUnread":const a=Fv.Z.getGoToMenuItems(this.context.vivaldiWindowId,xe.AF.toolbar),r=this.state.unread||"MailMsgStatusUnread"===this.props.name;return(0,fs.jsx)(Fa,{...v,tooltip:r?(0,bd.wY)("MailMsgStatusUnread")+" "+J.Z.getShortcut("COMMAND_MAIL_MARK_READ"):(0,bd.wY)("MailMsgStatusRead")+" "+J.Z.getShortcut("COMMAND_MAIL_MARK_UNREAD"),onClick:r?()=>Pf.Z.markRead(i):()=>Pf.Z.markUnread(i),disabled:!this.state.messageSelected||this.state.disableMarkRead,isMenuIndicatorVisible:!0,isMenuIndicatorDisabled:!this.state.unread,menu:()=>a,image:r?Ts.aAJ[s]:Ts.LDV[s],imageOverride:r?"MailMsgStatusUnread":"MailMsgStatusRead"});case"MailMsgFlag":return(0,fs.jsx)(Fa,{...v,tooltip:(0,bd.wY)(h),onClick:()=>Pf.Z.toggleStandardFlag(this.context.vivaldiWindowId,this.state.standardFlag?this.state.standardFlag:xe.T4.RED,this.state.standardFlag),disabled:!this.state.messageSelected,image:Ts.nyn[s],isMenuIndicatorVisible:!0,menu:()=>Pf.Z.getStandardFlagsMenu(this.context.vivaldiWindowId,this.state.standardFlag)});case"MailMsgLabel":return(0,fs.jsx)(Fa,{...v,tooltip:(0,bd.wY)(h),disabled:!this.state.messageSelected,image:Ts.rpm[s],isMenuIndicatorVisible:!0,menu:this.customLabelsMenuData,size:s,hidePopup:this.closeCustomFlagDlg,hasLightArrow:!0,popupClassName:"ToolbarButtonPopup-DefaultStyles",popupPosition:this.props.popupPosition,isPopupVisible:this.state.showLabel,children:Xf(Kf,{onClose:()=>Promise.resolve(this.closeCustomFlagDlg()),windowId:i,viewMode:"slide"})});case"MailMsgTrash":case"MailMsgTrashRestore":"MailMsgTrashRestore"===this.props.name?e=!0:this.props.preview&&(e=!1);const l=jf(i,e);return(0,fs.jsx)(Fa,{...v,tooltip:e?(0,bd.wY)("MailMsgTrashRestore"):(0,bd.wY)("MailMsgTrash"),onClick:e?()=>Pf.Z.undelete(i):()=>Pf.Z.prepareDelete(i,!1),disabled:!this.state.messageSelected||this.state.disableTrash,image:e?Ts.zpg[s]:Ts.nre[s],isMenuIndicatorVisible:l.length>0,menu:()=>l});case"MailMsgMove":return(0,fs.jsx)(Fa,{...v,tooltip:(0,bd.wY)(h),disabled:!this.state.messageSelected,image:Ts.Kt8[s],isMenuIndicatorVisible:!0,menu:()=>Pf.Z.getMoveToFolderMenu(i)});case"MailMsgSend":const d="send"===this.props.prefValues[$.kMailSendOrQueue];return(0,fs.jsx)(Fa,{...v,tooltip:d?(0,Oe.Z)("Send"):(0,Oe.Z)("Queue"),onClick:d?()=>Nf.Z.sendMessage(i):()=>Nf.Z.queueMessage(i,!1),title:d?(0,Oe.Z)("Send"):(0,Oe.Z)("Queue"),image:Ts.zLp[s],menu:this.getSendQueueMenu,isMenuIndicatorVisible:!0});case"MailMsgDiscard":return(0,fs.jsx)(Fa,{...v,tooltip:(0,bd.wY)(h),onClick:()=>this.deleteDraftMessage(),image:Ts.GqE[s],isMenuIndicatorVisible:!1});case"MailMsgAttach":return(0,fs.jsx)(Fa,{...v,tooltip:(0,bd.wY)(h),onClick:()=>Nf.Z.chooseAttachments(this.context),image:Ts.UEH[s],isMenuIndicatorVisible:!1});case"MailMsgSpam":case"MailMsgSpamRestore":return"MailMsgSpamRestore"===this.props.name?t=!0:this.props.preview&&(t=!1),(0,fs.jsx)(Fa,{...v,tooltip:t?(0,bd.wY)("MailMsgSpamRestore")+" "+J.Z.getShortcut("COMMAND_MAIL_MARK_NOT_JUNK"):(0,bd.wY)("MailMsgSpam")+" "+J.Z.getShortcut("COMMAND_MAIL_MARK_JUNK"),onClick:t?()=>Pf.Z.markAsNotJunk(i):()=>Pf.Z.markAsJunk(i),disabled:!this.state.messageSelected||this.state.disableJunk,image:t?Ts.och[s]:Ts.Qwh[s],isMenuIndicatorVisible:!1});case"MailMsgArchive":case"MailMsgArchiveRestore":return"MailMsgArchiveRestore"===this.props.name?n=!0:this.props.preview&&(n=!1),(0,fs.jsx)(Fa,{...v,tooltip:n?(0,bd.wY)("MailMsgArchiveRestore")+" "+J.Z.getShortcut("COMMAND_MAIL_RESTORE_FROM_ARCHIVE"):(0,bd.wY)("MailMsgArchive")+" "+J.Z.getShortcut("COMMAND_MAIL_MOVE_TO_ARCHIVE"),onClick:n?()=>Pf.Z.restoreFromArchive(i):()=>Pf.Z.moveToArchive(i),disabled:!this.state.messageSelected||this.state.disableArchive,image:n?Ts.RaS[s]:Ts._w1[s],isMenuIndicatorVisible:!1});case"MailMsgShowHeaders":return(0,fs.jsx)(Fa,{...v,tooltip:(0,bd.wY)(h),isMenuIndicatorVisible:!1,image:Ts.x6W[this.props.size],menu:()=>Df.getItems(Qf,"composer")});case"MailCompose":return(0,fs.jsx)(Fa,{...v,tooltip:(0,bd.wY)(h),isMenuIndicatorVisible:!1,image:Ts.XTV[this.props.size],onClick:ke.Z.createDraft.bind(null,void 0)});default:return console.warn(`ToolbarButton “${this.props.name}” not found`),null}}}const ey=sa(Jf,qf);var ty=n(16875);const ny=(0,V.vV)({blockedPageContents:[],blockedPopups:new Set,navigationInfo:{canGoBack:!1,canGoForward:!1,isLoading:!1,reason:void 0,trigger:"stop"},permissionInfo:new Map,sslInfo:{state:"none",issuer:void 0}},!0);class sy extends F.Z{getInitialState(){return new Map}getStateForTab(e){return this.getState().get(e)??ny}getNavigationInfo(e){return this.getStateForTab(e).navigationInfo}getSSLInfo(e){return this.getStateForTab(e).sslInfo}getBlockedPopupsById(e){return this.getStateForTab(e).blockedPopups}getPermissionsById(e){return this.getStateForTab(e).permissionInfo}getblockedPageContents(e){return this.getStateForTab(e).blockedPageContents}reduce(e,t){switch(t.actionType){case"CHROME_TABS_REMOVED":if(e.has(t.tabId)){const n=new Map(e);return n.delete(t.tabId),n}return e;case"NAVIGATION_SET_STATE":return function(e,t,n){return iy(e,t,"navigationInfo",(e=>{Object.assign(e,n)}))}(e,t.pageId,t.navigationState);case"PAGE_SET_SSL_STATE":return function(e,t,n){return iy(e,t,"sslInfo",(e=>{Object.assign(e,n)}))}(e,t.pageId,t.info);case"NAVIGATION_ADD_POPUP":return function(e,t,n){return iy(e,t,"blockedPopups",(e=>{e.add(n)}))}(e,t.pageId,t.popupEvent);case"NAVIGATION_REMOVE_POPUP":return function(e,t,n){return iy(e,t,"blockedPopups",(e=>{e.forEach((t=>{t.targetUrl===n&&e.delete(t)}))}))}(e,t.pageId,t.targetUrl);case"NAVIGATION_RESET_BLOCKED_POPUPS":return function(e,t){return iy(e,t,"blockedPopups",(e=>{e.forEach((t=>{e.clear()}))}))}(e,t.pageId);case"NAVIGATION_SET_PERMISSION":return function(e,t,n,s,i,o,a,r){return iy(e,t,"permissionInfo",(e=>{switch(s){case"audiocapture":s="microphone";break;case"videocapture":s="camera"}const t=e.get(n)??new Map;e.set(n,t);const l={requestEvent:i,state:o,promptPermission:a,suppressedPrompt:r};t.set(s,l)}))}(e,t.pageId,t.origin,t.permission,t.requestEvent,t.state,t.promptPermission,t.suppressedPrompt);case"NAVIGATION_RESET_PERMISSIONS":return function(e,t){return iy(e,t,"permissionInfo",(e=>{e.clear()}))}(e,t.pageId);case"NAVIGATION_SET_BLOCKED_CONTENT":return function(e,t,n){return iy(e,t,"blockedPageContents",(e=>{e.push(n)}))}(e,t.pageId,t.contentType);case"NAVIGATION_RESET_BLOCKED_CONTENT":return function(e,t){return iy(e,t,"blockedPageContents",(e=>{e.length=0}))}(e,t.pageId);default:return e}}}function iy(e,t,n,s){const i=e.get(t)??ny,o=(0,V.Uy)(i[n],s);return i[n]===o?e:new Map(e).set(t,{...i,[n]:o})}const oy=new sy;var ay=n(69046);class ry extends hs.PureComponent{static contextType=xi.Z;constructor(e,t){super(e);const n=ie.ZP.unsafeGetActivePage(t.vivaldiWindowId);this.state={activePageId:n.id,isInternalPage:je.jk.isInternalPage(n),navigationInfo:oy.getNavigationInfo(n.id),pageHistoryIndex:-1,...this.getFastForwardStoreState(n.id)}}_isMounted=!1;componentDidMount(){const{selectWindow:e}=this.context;this._isMounted=!0,this.props.inEditor||("FastForward"!==this.props.name&&"Rewind"!==this.props.name||ty.Z.addListener(this.fastForwardStoreChanged),oy.addListener(this.navigationStoreChanged,(e=>e.get(this.state.activePageId)?.navigationInfo)),ie.ZP.addListener(this.pageStoreChanged,e))}componentDidUpdate(e,t){e.name!==this.props.name&&console.error("NavButton: Can't reuse component for a different button")}componentWillUnmount(){this._isMounted=!1,this.props.inEditor||("FastForward"!==this.props.name&&"Rewind"!==this.props.name||ty.Z.removeListener(this.fastForwardStoreChanged),oy.removeListener(this.navigationStoreChanged),ie.ZP.removeListener(this.pageStoreChanged))}fastForwardStoreChanged=()=>{this.setState((e=>this.getFastForwardStoreState(e.activePageId)))};getFastForwardStoreState=e=>({forwardUrl:ty.Z.getFastForwardUrl(e),rewindRelativeIndex:ty.Z.getRewindRelativeIndex(e)});navigationStoreChanged=()=>{this.setState((e=>({navigationInfo:oy.getNavigationInfo(e.activePageId)})))};pageStoreChanged=()=>{if(!this._isMounted)return;const e=ie.ZP.unsafeGetActivePage(this.context.vivaldiWindowId),t=je.jk.isInternalPage(e)&&!e.url.startsWith(je.jk.internals.startpage);e.id!==this.state.activePageId?this.setState({activePageId:e.id,isInternalPage:t,navigationInfo:oy.getNavigationInfo(e.id),...this.getFastForwardStoreState(e.id)}):t!==this.state.isInternalPage&&this.setState({isInternalPage:t})};reload=({shiftKey:e})=>{this.state.navigationInfo&&(this.state.navigationInfo.isLoading?Vv.Z.stop(this.context.vivaldiWindowId,this.state.activePageId):Vv.Z.reload(this.context.vivaldiWindowId,this.state.activePageId,e))};cloneSelectedTabs=()=>{ie.ZP.isSelecting(this.context.vivaldiWindowId)?d.ZP.clonePages(ie.ZP.getSelectedPages(this.context.vivaldiWindowId)):d.ZP.clonePages(te.aV.of(ie.ZP.unsafeGetActivePage(this.context.vivaldiWindowId)))};back=e=>{Vv.Z.back(this.context.vivaldiWindowId,this.state.activePageId)};backInBackground=()=>{this.openURLFromHistory(-1)};forward=()=>{Vv.Z.forward(this.context.vivaldiWindowId,this.state.activePageId)};forwardInBackground=()=>{this.openURLFromHistory(1)};isSubstripVisible(e){const t=ie.ZP.getTabsForPages(ie.ZP.getGroup(e,this.context.vivaldiWindowId),!0);return"substrip"===H.Z.get($.kTabsStackingMode)&&(H.Z.get($.kTabsStackingSubstripLocked)||t.size>1)}openURLFromHistory=e=>{const t=this.context.vivaldiWindowId;Vv.Z.getPageHistory(t,this.state.activePageId,((n,s)=>{const i=n+e;if(i>=0||i<s.length){const e=ie.ZP.getPageInWindow(t,this.state.activePageId),n=e?(0,ay.av)(e):null;d.ZP.openURL(t,s[i].url,{inCurrent:!1,inBackground:!0,transition:C.Z.historyPrivate.TransitionType.RELOAD,groupId:n&&this.isSubstripVisible(n)?n:void 0})}}))};rewind=()=>{Vv.Z.go(this.context.vivaldiWindowId,this.state.activePageId,-1*this.state.rewindRelativeIndex)};rewindInBackground=()=>{const e=this.context.vivaldiWindowId;if(this.state.rewindRelativeIndex>0){const t=ie.ZP.getActivePage(e);if(t){const n=ty.Z.getRewindHistory(t);n.length>0&&d.ZP.openURL(e,n[0].url,{inBackground:!0,transition:C.Z.historyPrivate.TransitionType.RELOAD})}}};goHome=e=>{d.ZP.showHomepage(e,{inCurrent:!0})};goHomeInBackground=e=>{d.ZP.showHomepage(e,{inBackground:!0})};getHistory=()=>new Promise((e=>Vv.Z.getPageHistory(this.context.vivaldiWindowId,this.state.activePageId,((t,n)=>this.setState({pageHistoryIndex:t},(()=>e(n)))))));_onHistorySelection=(e,t,n,s)=>{const{ctrlKey:i,shiftKey:o,altKey:a,metaKey:r}=n,l=void 0===s?0:s,c=this.context.vivaldiWindowId;if(t&&(i||o||a||r||0!==l)){const e=(0,nl.Z)(c,{button:l,ctrlKey:Boolean(i),altKey:Boolean(a),shiftKey:Boolean(o),metaKey:Boolean(r)});d.ZP.openURL(c,t,{...e})}else Vv.Z.go(c,this.state.activePageId,e-this.state.pageHistoryIndex)};getHistoryMenuPromise=e=>()=>this.getHistory().then((t=>{const n="backward"===e?t.slice(0,this.state.pageHistoryIndex).reverse():t.slice(this.state.pageHistoryIndex+1),s="backward"===e?(e,t)=>e-t-1:(e,t)=>e+t+1;return n.map(((e,t)=>{let n=e.name;return je.jk.isInternalUrl(n)&&(n=je.jk.getDisplayTitleByUrl(n,"")),{...ae.Z.makeNumberMnemonic(n,t),url:e.url,handler:n=>{this._onHistorySelection(s(this.state.pageHistoryIndex,t),e.url,n.keyState,n.button)}}}))}));getContextMenuPromise=e=>{const t=this.context.vivaldiWindowId,n=Pi.getOptionFunction(e);return Pi.getNamedMenu(t,e,(async e=>{switch(e.action){case"CONTEXT_CONTAINER_CUSTOMIZE_TOOLBAR":return{items:this.props.customizeMenu,...n(t,e,{})};case"CONTEXT_CONTAINER_FORWARD_HISTORY":return this.getHistoryMenuPromise("forward")().then((s=>({items:s,...n(t,e,{})})));case"CONTEXT_CONTAINER_BACKWARD_HISTORY":return this.getHistoryMenuPromise("backward")().then((s=>({items:s,...n(t,e,{})})));default:return{...n(t,e,{})}}}))};getbackwardbuttonContextMenu=()=>this.getContextMenuPromise("backwardbutton");getforwardbuttonContextMenu=()=>this.getContextMenuPromise("forwardbutton");getrewindbuttonContextMenu=()=>this.getContextMenuPromise("rewindbutton");getfastforwardbuttonContextMenu=()=>this.getContextMenuPromise("fastforwardbutton");getreloadbuttonContextMenu=()=>this.getContextMenuPromise("reloadbutton");gethomebuttonContextMenu=()=>this.getContextMenuPromise("homebutton");render(){const{isInternalPage:e,navigationInfo:t}=this.state,n=this.context.vivaldiWindowId,{draggable:s,onDragStart:i,onDragEnd:o,onDrop:a,onDragEnter:r,mimeType:l,name:d,menuOrigin:c,size:h}=this.props,p={draggable:s,onDragStart:i,onDragEnd:o,onDrop:a,onDragEnter:r,mimeType:l,name:d,menuOrigin:c,size:h};switch(this.props.name){case"Back":return(0,fs.jsx)(Fa,{...p,disabled:!t||!t.canGoBack,onClick:this.back,onMiddleClick:this.backInBackground,modifier:"ctrlCmd",tooltip:(0,Oe.Z)("Go to previous page")+"\n"+(0,Oe.Z)("Hold for history list"),menu:this.getbackwardbuttonContextMenu,alwaysMenu:!0,image:Ts.mgF[this.props.size]});case"Forward":return(0,fs.jsx)(Fa,{...p,disabled:!t||!t.canGoForward,onClick:this.forward,onMiddleClick:this.forwardInBackground,modifier:"ctrlCmd",tooltip:(0,Oe.Z)("Go to next page")+"\n"+(0,Oe.Z)("Hold for forward history list"),menu:this.getforwardbuttonContextMenu,alwaysMenu:!0,image:Ts.Zu[this.props.size]});case"Rewind":return(0,fs.jsx)(Fa,{...p,className:"button-narrow",disabled:!(Number.isInteger(this.state.rewindRelativeIndex)&&this.state.rewindRelativeIndex>0),onClick:this.rewind,onMiddleClick:this.rewindInBackground,tooltip:(0,Oe.Z)("Rewind by visited domain")+"\n"+(0,Oe.Z)("Hold for history domain list"),menu:this.getrewindbuttonContextMenu,alwaysMenu:!0,image:Ts.jtA[this.props.size]});case"FastForward":return(0,fs.jsx)(Fa,{...p,className:"button-narrow",tooltip:this.state.forwardUrl?(0,Oe.Z)("Fast Forward - $1",[this.state.forwardUrl]):(0,Oe.Z)("Fast Forward"),onClick:()=>T.Z.navigateFastforward(n),disabled:!this.state.forwardUrl,menu:this.getfastforwardbuttonContextMenu,alwaysMenu:!0,image:Ts.Wmx[this.props.size]});case"Reload":case"Stop":case"COMMAND_PAGE_REFRESH":const s=!!t&&t.isLoading;return(0,fs.jsx)(Fa,{...p,disabled:e,menu:this.getreloadbuttonContextMenu,alwaysMenu:!0,tooltip:s&&!e?(0,Oe.Z)("verb","Stop"):(0,Oe.Z)("Reload current page"),onClick:this.reload,onMiddleClick:this.cloneSelectedTabs,image:s&&!e||"Stop"===this.props.name?Ts.YVA[this.props.size]:Ts.GO5[this.props.size],imageOverride:s&&!e||"Stop"===this.props.name?"Stop":"Reload"});case"Home":case"COMMAND_SHOW_HOMEPAGE":return(0,fs.jsx)(Fa,{...p,tooltip:(0,Oe.Z)("Go to homepage"),menu:this.gethomebuttonContextMenu,alwaysMenu:!0,onClick:()=>this.goHome(n),onMiddleClick:()=>this.goHomeInBackground(n),image:Ts.PaK[this.props.size]});default:return null}}}const ly=ry,dy=JSON.parse('{"t":[{"title":"Vivaldi Browser Help Center","url":"https://help.vivaldi.com","faviconURL":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAKQ2lDQ1BJQ0MgcHJvZmlsZQAAeNqdU3dYk/cWPt/3ZQ9WQtjwsZdsgQAiI6wIyBBZohCSAGGEEBJAxYWIClYUFRGcSFXEgtUKSJ2I4qAouGdBiohai1VcOO4f3Ke1fXrv7e371/u855zn/M55zw+AERImkeaiagA5UoU8Otgfj09IxMm9gAIVSOAEIBDmy8JnBcUAAPADeXh+dLA//AGvbwACAHDVLiQSx+H/g7pQJlcAIJEA4CIS5wsBkFIAyC5UyBQAyBgAsFOzZAoAlAAAbHl8QiIAqg0A7PRJPgUA2KmT3BcA2KIcqQgAjQEAmShHJAJAuwBgVYFSLALAwgCgrEAiLgTArgGAWbYyRwKAvQUAdo5YkA9AYACAmUIszAAgOAIAQx4TzQMgTAOgMNK/4KlfcIW4SAEAwMuVzZdL0jMUuJXQGnfy8ODiIeLCbLFCYRcpEGYJ5CKcl5sjE0jnA0zODAAAGvnRwf44P5Dn5uTh5mbnbO/0xaL+a/BvIj4h8d/+vIwCBAAQTs/v2l/l5dYDcMcBsHW/a6lbANpWAGjf+V0z2wmgWgrQevmLeTj8QB6eoVDIPB0cCgsL7SViob0w44s+/zPhb+CLfvb8QB7+23rwAHGaQJmtwKOD/XFhbnauUo7nywRCMW735yP+x4V//Y4p0eI0sVwsFYrxWIm4UCJNx3m5UpFEIcmV4hLpfzLxH5b9CZN3DQCshk/ATrYHtctswH7uAQKLDljSdgBAfvMtjBoLkQAQZzQyefcAAJO/+Y9AKwEAzZek4wAAvOgYXKiUF0zGCAAARKCBKrBBBwzBFKzADpzBHbzAFwJhBkRADCTAPBBCBuSAHAqhGJZBGVTAOtgEtbADGqARmuEQtMExOA3n4BJcgetwFwZgGJ7CGLyGCQRByAgTYSE6iBFijtgizggXmY4EImFINJKApCDpiBRRIsXIcqQCqUJqkV1II/ItchQ5jVxA+pDbyCAyivyKvEcxlIGyUQPUAnVAuagfGorGoHPRdDQPXYCWomvRGrQePYC2oqfRS+h1dAB9io5jgNExDmaM2WFcjIdFYIlYGibHFmPlWDVWjzVjHVg3dhUbwJ5h7wgkAouAE+wIXoQQwmyCkJBHWExYQ6gl7CO0EroIVwmDhDHCJyKTqE+0JXoS+cR4YjqxkFhGrCbuIR4hniVeJw4TX5NIJA7JkuROCiElkDJJC0lrSNtILaRTpD7SEGmcTCbrkG3J3uQIsoCsIJeRt5APkE+S+8nD5LcUOsWI4kwJoiRSpJQSSjVlP+UEpZ8yQpmgqlHNqZ7UCKqIOp9aSW2gdlAvU4epEzR1miXNmxZDy6Qto9XQmmlnafdoL+l0ugndgx5Fl9CX0mvoB+nn6YP0dwwNhg2Dx0hiKBlrGXsZpxi3GS+ZTKYF05eZyFQw1zIbmWeYD5hvVVgq9ip8FZHKEpU6lVaVfpXnqlRVc1U/1XmqC1SrVQ+rXlZ9pkZVs1DjqQnUFqvVqR1Vu6k2rs5Sd1KPUM9RX6O+X/2C+mMNsoaFRqCGSKNUY7fGGY0hFsYyZfFYQtZyVgPrLGuYTWJbsvnsTHYF+xt2L3tMU0NzqmasZpFmneZxzQEOxrHg8DnZnErOIc4NznstAy0/LbHWaq1mrX6tN9p62r7aYu1y7Rbt69rvdXCdQJ0snfU6bTr3dQm6NrpRuoW623XP6j7TY+t56Qn1yvUO6d3RR/Vt9KP1F+rv1u/RHzcwNAg2kBlsMThj8MyQY+hrmGm40fCE4agRy2i6kcRoo9FJoye4Ju6HZ+M1eBc+ZqxvHGKsNN5l3Gs8YWJpMtukxKTF5L4pzZRrmma60bTTdMzMyCzcrNisyeyOOdWca55hvtm82/yNhaVFnMVKizaLx5balnzLBZZNlvesmFY+VnlW9VbXrEnWXOss623WV2xQG1ebDJs6m8u2qK2brcR2m23fFOIUjynSKfVTbtox7PzsCuya7AbtOfZh9iX2bfbPHcwcEh3WO3Q7fHJ0dcx2bHC866ThNMOpxKnD6VdnG2ehc53zNRemS5DLEpd2lxdTbaeKp26fesuV5RruutK10/Wjm7ub3K3ZbdTdzD3Ffav7TS6bG8ldwz3vQfTw91jicczjnaebp8LzkOcvXnZeWV77vR5Ps5wmntYwbcjbxFvgvct7YDo+PWX6zukDPsY+Ap96n4e+pr4i3z2+I37Wfpl+B/ye+zv6y/2P+L/hefIW8U4FYAHBAeUBvYEagbMDawMfBJkEpQc1BY0FuwYvDD4VQgwJDVkfcpNvwBfyG/ljM9xnLJrRFcoInRVaG/owzCZMHtYRjobPCN8Qfm+m+UzpzLYIiOBHbIi4H2kZmRf5fRQpKjKqLupRtFN0cXT3LNas5Fn7Z72O8Y+pjLk722q2cnZnrGpsUmxj7Ju4gLiquIF4h/hF8ZcSdBMkCe2J5MTYxD2J43MC52yaM5zkmlSWdGOu5dyiuRfm6c7Lnnc8WTVZkHw4hZgSl7I/5YMgQlAvGE/lp25NHRPyhJuFT0W+oo2iUbG3uEo8kuadVpX2ON07fUP6aIZPRnXGMwlPUit5kRmSuSPzTVZE1t6sz9lx2S05lJyUnKNSDWmWtCvXMLcot09mKyuTDeR55m3KG5OHyvfkI/lz89sVbIVM0aO0Uq5QDhZML6greFsYW3i4SL1IWtQz32b+6vkjC4IWfL2QsFC4sLPYuHhZ8eAiv0W7FiOLUxd3LjFdUrpkeGnw0n3LaMuylv1Q4lhSVfJqedzyjlKD0qWlQyuCVzSVqZTJy26u9Fq5YxVhlWRV72qX1VtWfyoXlV+scKyorviwRrjm4ldOX9V89Xlt2treSrfK7etI66Trbqz3Wb+vSr1qQdXQhvANrRvxjeUbX21K3nShemr1js20zcrNAzVhNe1bzLas2/KhNqP2ep1/XctW/a2rt77ZJtrWv913e/MOgx0VO97vlOy8tSt4V2u9RX31btLugt2PGmIbur/mft24R3dPxZ6Pe6V7B/ZF7+tqdG9s3K+/v7IJbVI2jR5IOnDlm4Bv2pvtmne1cFoqDsJB5cEn36Z8e+NQ6KHOw9zDzd+Zf7f1COtIeSvSOr91rC2jbaA9ob3v6IyjnR1eHUe+t/9+7zHjY3XHNY9XnqCdKD3x+eSCk+OnZKeenU4/PdSZ3Hn3TPyZa11RXb1nQ8+ePxd07ky3X/fJ897nj13wvHD0Ivdi2yW3S609rj1HfnD94UivW2/rZffL7Vc8rnT0Tes70e/Tf/pqwNVz1/jXLl2feb3vxuwbt24m3Ry4Jbr1+Hb27Rd3Cu5M3F16j3iv/L7a/eoH+g/qf7T+sWXAbeD4YMBgz8NZD+8OCYee/pT/04fh0kfMR9UjRiONj50fHxsNGr3yZM6T4aeypxPPyn5W/3nrc6vn3/3i+0vPWPzY8Av5i8+/rnmp83Lvq6mvOscjxx+8znk98ab8rc7bfe+477rfx70fmSj8QP5Q89H6Y8en0E/3Pud8/vwv94Tz+4A5JREAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAADKGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDAgNzkuMTYwNDUxLCAyMDE3LzA1LzA2LTAxOjA4OjIxICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozNjMzMzk4REEzQ0UxMUU4OEQxNUUwM0EyM0ZDRkY5NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozNjMzMzk4RUEzQ0UxMUU4OEQxNUUwM0EyM0ZDRkY5NyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjM2MzMzOThCQTNDRTExRTg4RDE1RTAzQTIzRkNGRjk3IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjM2MzMzOThDQTNDRTExRTg4RDE1RTAzQTIzRkNGRjk3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+CzB6ggAABmJJREFUeNrEV1loVGcU/u4yk0xWs5hJE2PERNCKcX9QhBZR1Iii9UERRNFaRdu+iBL3uiDigj5UQaQPFeuCiMQNKxTy4Ip7K6iYxKhxS2LWyTYz995+/507mTszd9rSFjxwQubOnf98/znn+/7zS4Zh4FOaKv60TpwY+zyJXk6fRB9Cz6f3o6fQ3XSFLjmsp9ED9B56O72B/oJ+l/4r/ZX95X43boQAxNh39Ap6wf+40W8scEfp31sgIxmw2U/0pQmXkbhplszo7obR1cV99oSeu92QUlIgeTzMjWK+42AiayvpX9DH0btiAXydMLgsE3MA+ps3MDQNckEB1KFDIeXmmqCMtjbo9fWmG3xPKSxksVgtTXNabRi9kj7VDsBF/9Fxx9yR/vKluZhr6lS4Z86EOm4clIEDQ8As09+/R/DRI/ivXIH/8mUYBKuUlITW0PXYladY/XUtDKDcary4dGuPH5sBPevWwT1lSsLqyPn5cAufNg3BpUvRtXcv/BcuQB08OFE2RMavhbcw2TH4kydIWrAAmdzRXwWPo9aIEcg4dgwpmzZBq6sDOjujsmXZBBO49aEktuba06dIWrgQaYcPc0X1X7V+ypo18OzYgWBtrVMGiuwAvJFeDdVcHT0aaYcO/Wf+paxahaRFi6A9fx5iSMR0O4DMvsd+Pwx66oEDfY/a791D9fr18LEf/s6C7e2o37kTTSdP9j1L3b0bsmBGS0scgHBuPeHaa69eIWnuXKhlZeYj38OHeDR9OnqamtDw8zGMvXsHSQXOGiUoWMMGbDh71iS9RjDeFSsgp6bCtXw5erdsgZKZGaUTso2GIbrQ3QQQNt/vfyDI4LmTJiHY0oyX235IuHudwtTNLGUMHw7V5YLv+vVIZefMQdDrhdzbG91uNpUyFU4ZNAjq+PF9L+SUz0DG2LHwv36NtM+Ho/GXk2i/dcsRgJKejqzycgSpASp3nbdkSeRwGTAAwZFl0JqbHQGYB4vh80EmADkrq+8FF9WumPUPvHsHxaXCRU6/3ro1YRbSJ0xAT2srcubPR/rkyVGB9JJS+BhDlaQ4ACFjCmUhrzGWO28esikwPdXVSC4tQXtVFZpOnHAE0HX7tnlcFmzeHPedKzsbvmAQOntAcgQQ1n0HKyafTS4TpIcyXM8A3dQKu3WSLW/370fR9u1wia6PFSiuHWDwTvaZYmUhOhpPNSOaKhEqjRwJ7+LF6Hn2zJRccTjVUCU/HDyIljNn8H7PHlRTLVOp//kbNzo3KVnhYuBuAghYTAjT0PwksXF00tCgdIr/Y62wogIt586ZrEgqKoL28SPecbeSlTWdtS86fjxhFgMvXkBNTjZLIEBk2TKghwFolE1xqjmZizsvoLwGamogsRyi65O5Y8/gEpNGWbNnI4OnpZNpzGzvgwdQ2QcuqxT2EgTCMmyQp/6LFxN2uXf1aqSOGYMAqSZzIbGA4e81+8O7bVvC3/kuXUKQGVDS0szfyDFNGBptiEphantPn4b+9q3zSgRZQBrqjY2QmEaJB5WfOp9NzntGjUoIoO3oUZPSssX5WBa0R7ot1dSDjoqKhItlzJiBzFmz0H3/PgIsmYvy6t2wIeH7Lfv2IUCGiBLaZFiyA2iMFIu1LS1F4Px5tNoOpLiG5KJpVEyFTVV45AiU/v2ddeHqVbTs2gW3mI6iJyPVzoK62IFE/MDHDu+mcHy2dm18QxYXo4SSrHd0QGYzOgavrETDypVQc3LMA8mwZgKRA+rAB3sGrkcTVodOyc3gONVJELU84fxiLnQaxRyC66RxMxvyw7Jl5vdKXl5f8DDlGPiOuVdxM+LFRMwDrfGiKMMgmHqOZgqPYFPfWftk0WxS/L0kwGYUKfedOoVeUtnFDUgO86DQgVRFmZNz82ZlGIB4Tq3FpqjzXaSagbrozRQfcPIV6XQPG4Yk9onKrhYiJARIUMxPoJqgJ98RuzZrHnNH0EJrPkuT5aEZvBnZAQirsi4OsLeqTACt7AVxkiuclnTeA8xBU9BQHCykpsxLiUw2mJcTi9JO9zYKVkeaopSxBHUZDlezL637wWp7FszZTqiXuJTwvBAdLwl3HIuiAxu2NdySVOWR5WUiuJ7gaibsW7qYRr+yRuchmmHkuWVZETfTHnGS/bN51CDANmavlgEfcAa4SAC/9el+OMOf+nr+pwADAAZ5culxNH/mAAAAAElFTkSuQmCC"},{"title":"WikiPedia","url":"https://www.wikipedia.org","faviconURL":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAQAAADZc7J/AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QAAKqNIzIAAAAJcEhZcwAACxIAAAsSAdLdfvwAAAAHdElNRQfhBAwKMAfiL115AAACxklEQVRIx6WVX2jVZRjHP7/T8c9pg2nhv2yDXWg4gqGsQGci68J/FRhq4IUohISpiQpeRoi48DJML0yCukpEiV0oIuaIqTSmUtREFCdhjTTFnTPP9Jz308X57efZ2aJ19vyu3ud9ns/zfX/P+ycKANN4mxZ2MH77gm7O8wgIhEzoClbxdYVMgDA3XKwq3WC4GOamaGHZ/5A+0pbRkmJx1ekAi6PghACkyUU11aebS0OWIhleAOAZQ2QYJEMagCcEppBnKmngCTKJPLVEQI4UNaQjTnGYQWYSUeAeb/Iph7jCS6R4Ro4NtPEZfzCNPJNZSyu7GaSOAaayk/chZPP2+KGIuNc7Fu33c1Piy54ya8FeV4jLvWzWor+6VFxjjwVDlpBVzbtWrPWaw7ZVnGlvPNrpfG8lc3t81b9US4BgUM9YJx4qudVuZ4j7VP3TBR5TS5EDtnkwjisD5HxXbPBxDNBPxDpvqvtsNZcATjrPO/EoAQT1WxGPJoE91op77LPe7xNvcIXbLA5v5nLAY5vFRQ4kGraI9ba5wacJ4Lr1/jRcvxwQ1HYx8rskuMuM+KJXE49ud/Xw+kcDbtsovmUh0bBRnG5vAvjdVzz3PN2QTZVtSxpZBXTxQzyGVuAhXwIRAF8zv/LwPlcQ1J+dJG52KO7MEueIc/xF1Uc2eby8/kgFAK/zDtDBb0TAV8gxaujnGwBOIB9UnqdyBUHtdIq4S+23yQ51vTjLG+pCj4ysP/InlgBDrhIb/NuDvmdBvWBaPOBZm73/X4CgnhbxIxf5o6Vzsk58zTfcX5k+NuCBzSJ+bDFu52kz4mzvjg+gh8V6byXdH3SluLd8A/1bF0rdX0MDm2jE2JNhI9NZH89WdmHUba8FO+wrq6b3PWF+dH2DhPaxEJViHUu+wdCe5tIYd+04PLFdStFNZ9W3eifdE35co4k+7/8AeaKDkPxRJzsAAAAASUVORK5CYII="}]}');var cy=n(751);class hy extends hs.PureComponent{static contextType=xi.Z;#v=!1;#f=!1;#y=this.props.autocompleteValue;inputField=hs.createRef();componentDidMount(){const{addEventListener:e}=this.context;e("drop",this.windowDropHandler)}componentDidUnMount(){const{removeEventListener:e}=this.context;e("drop",this.windowDropHandler)}componentDidUpdate(e){if((e.autocompleteValue!==this.props.autocompleteValue||e.typedValue!==this.props.typedValue)&&this.inputField.current){const e=this.inputField.current,{selectionStart:t,selectionEnd:n}=function(e,t){if(!e||!t)return{selectionStart:-1,selectionEnd:-1};const n=t.length,s=e.length;return n===s?{selectionStart:-1,selectionEnd:-1}:e.toLowerCase().startsWith(t.toLowerCase())?{selectionStart:n,selectionEnd:s}:{selectionStart:-1,selectionEnd:-1}}(this.props.autocompleteValue,this.props.typedValue);-1!==t&&(e.selectionStart!==t&&(e.selectionStart=t,t!==n&&(e.selectionDirection="backward")),e.selectionEnd!==n&&(e.selectionEnd=n))}}setSelection=(e,t="none")=>{const n=this.inputField.current;n&&n.setSelectionRange(e.selectionStart,e.selectionEnd,t)};onValueChange=e=>{this.props.onValueChange(e)};onKeyPress=e=>{this.props.onKeyPress(e),this.props.typedValue+e.key===e.currentTarget.value&&this.onValueChange(e.currentTarget.value)};onChange=({currentTarget:e})=>{let t;t=this.#v&&this.#f&&!1!==this.props.readOnlyDnD?this.#y:e.value,this.onValueChange(t??"")};onDragStart=e=>{this.#v=!0,this.props.onDragStart(e)};windowDropHandler=e=>{this.#f=this.#v,this.#y=this.props.autocompleteValue};onDragEnd=e=>{this.#v=!1,this.#f=!1,this.props.onDragEnd(e)};render(){return(0,fs.jsx)("input",{id:this.props.inputId??cy.IY,ref:this.inputField,value:this.props.autocompleteValue,autoComplete:"off",spellCheck:"false",type:"text",autoFocus:this.props.autoFocus,className:this.props.className,disabled:this.props.disabled,placeholder:this.props.placeholder,title:this.props.title,readOnly:this.props.readOnly,onChange:this.onChange,onKeyPress:this.onKeyPress,onBlur:this.props.onBlur,onFocus:this.props.onFocus,onSelect:this.props.onSelect,onCompositionStart:this.props.onCompositionStart,onCompositionUpdate:this.props.onCompositionUpdate,onCompositionEnd:this.props.onCompositionEnd,onClick:this.props.onClick,onContextMenu:this.props.onClick,onDragStart:this.onDragStart,onDragEnter:this.props.onDragEnter,onDragOver:this.props.onDragOver,onDragLeave:this.props.onDragLeave,onDragEnd:this.onDragEnd,onDrop:this.props.onDrop,onMouseDown:this.props.onMouseDown,onMouseUp:this.props.onMouseUp,onKeyDown:this.props.onKeyDown,onCut:this.props.onCut,onCopy:this.props.onCopy,onPaste:this.props.onPaste})}}var py=n(67975),uy=n(98010),gy=n(50503),my=n(48588);const vy=Object.freeze({selectedItem:void 0,autocompleteValue:"",typedUrl:void 0});class fy extends F.Z{getInitialState(){return new Map}getUrlfieldState(e){return this.getState().get(e)??vy}getTypedUrlWithFallback(e,t){const{typedUrl:n}=this.getUrlfieldState(t);if("string"==typeof n)return n;if("number"==typeof t){const n=ie.ZP.getPageInWindow(e,t);if(n)return(0,uy.gC)((0,gy.dO)(n.url))}return""}reduce(e,t){switch(t.actionType){case"CHROME_TABS_REMOVED":case"URLFIELD_RESET":{const n=void 0===t.tabId?t.pageId:t.tabId;if(void 0===n)return this.getInitialState();if(e.has(n)){const t=new Map(e);return t.delete(n),t}return e}case"URLFIELD_UPDATE_STATE":return(0,my.c)(e,t.pageId,(e=>{Object.assign(e,t.state)}),vy);case"PAGE_CLOSE":{const n=new Map(e);for(const e of t.pages)n.delete(e.id);return n.size===e.size?e:n}}return e}}const yy=new fy;const Cy=function(e){return e.length>=32e3};var wy=n(74117);const by=function(e,t){return 0===(t=t.replace(/^https?\:\/\/(www+\.)?/,"")).indexOf(e)},Sy=["OMNI_RESULT_BOOKMARK_TITLE_EXACT","OMNI_RESULT_BOOKMARK_URL_HOST","OMNI_RESULT_BOOKMARK_TITLE","OMNI_RESULT_BOOKMARK_PROMOTED","OMNI_RESULT_BOOKMARK_URL"];function Iy(e,t,n){if(function(e,t){const n=Sy.findIndex((e=>t.type===e)),s=Sy.findIndex((t=>e.type===t));return-1!==n&&n<s}(e,t))return!0;if(e.type===n&&t.type===n){const n=(0,vs.Df)(t.url),s=(0,vs.Df)(e.url),i=t.url.slice(n,t.url.length),o=e.url.slice(s,e.url.length);if(i.length<o.length)return!0}return!1}function ky(e,t,n,s,i){return!!e.every(((n,s)=>Iy(n,t,"OMNI_RESULT_BOOKMARK_TITLE_EXACT")||Iy(n,t,"OMNI_RESULT_BOOKMARK_URL_HOST")||Iy(n,t,"OMNI_RESULT_BOOKMARK_TITLE")||Iy(n,t,"OMNI_RESULT_BOOKMARK_PROMOTED")?(e.splice(s,0,t),!1):!Iy(n,t,"OMNI_RESULT_BOOKMARK_URL")||(e.splice(s,0,t),!1)))&&e.length<i-1&&e.push(t),e.length>i&&e.pop(),e}function Ay({nickname:e,children:t,url:n,title:s,description:i},o){const a=o.join(" ");let r=[];return o[0].startsWith("data:")||(r=o.map((e=>new RegExp((0,wy.Z)(e),"i")))),function(e,t){return!(!t||!e)&&t.toLowerCase().startsWith(e.toLowerCase())}(a,e)?t?"OMNI_RESULT_FOLDER_NICKNAME":"OMNI_RESULT_BOOKMARK_NICKNAME":t||"string"!=typeof n?void 0:by(a,n)||Ty(a,n)?"OMNI_RESULT_BOOKMARK_URL_HOST":s&&s.toLowerCase().startsWith(a.toLowerCase())?"OMNI_RESULT_BOOKMARK_TITLE_EXACT":n&&r.every((e=>n.match(e)))?n.endsWith("/")?"OMNI_RESULT_BOOKMARK_PROMOTED":"OMNI_RESULT_BOOKMARK_URL":s&&r.every((e=>s.match(e)))?"OMNI_RESULT_BOOKMARK_TITLE":i&&r.every((e=>i.match(e)))?"OMNI_RESULT_BOOKMARK_DESCRIPTION":void 0}function Ty(e,t){return 0===(t=t.replace("https://vivaldi.com/bk/","")).indexOf("sd-")&&(t=t.replace("sd-","")),0===t.indexOf(e)}function Zy(e){switch(e){case"OMNI_RESULT_BOOKMARK_URL_HOST":return 200;case"OMNI_RESULT_BOOKMARK_PROMOTED":return 100;default:return 0}}class Ey{search=e=>{const t={bookmarkResults:[],nicknameResults:[]};if(!e)return Promise.resolve(t);const n=e.startsWith("data:")?[]:e.replace(/\s+/g," ").split(" ");return 0===n.length?Promise.resolve(t):function(e){let t=[];const n=[],s=H.Z.get($.kAddressBarOmniboxNumberOfBookmarkResults),i=H.Z.get($.kAddressBarOmniboxNumberOfBookmarkResults),o=H.Z.get($.kAddressBarOmniboxShowBookmarks),a=e.join("");e.join(" ");for(const r of ps.ZP.iterateTree()){const l=Ay(r,e);if(!l)continue;const{id:d,title:c,nickname:h,description:p}=r,u=Zy(l);if(ps.ZP.isBookmark(r)&&r.url){const e=je.jk.getDisplayUrlFromMapping(r.url);if("OMNI_RESULT_BOOKMARK_NICKNAME"===l&&n.length<i){const t={id:d,title:c,nickname:h,description:"",url:e,type:l,score:u,isDeleteDisabled:!0,faviconType:e?"favicon":"img",faviconUrl:e??"/resources/folder@2x.png"};n.push(t)}else if(o){if((0,vs.xl)(e)&&!a.startsWith("vivaldi:"))continue;t=[...ky(t,{id:d,title:c,nickname:h,description:p,url:e,type:l,score:u,isDeleteDisabled:!0,faviconType:"favicon",faviconUrl:e},0,0,s)]}}else if("OMNI_RESULT_FOLDER_NICKNAME"===l&&n.length<i){const e={id:d,title:c,nickname:h,description:"",url:c,type:l,score:u,isDeleteDisabled:!0,faviconType:"img",faviconUrl:"/resources/folder@2x.png"};n.push(e)}}return Promise.resolve({bookmarkResults:t,nicknameResults:n})}(n)}}function _y(e){return"OMNI_RESULT_BOOKMARK_NICKNAME"===e.type||My(e)}function My(e){return"OMNI_RESULT_FOLDER_NICKNAME"===e.type}function Ny(e){return e.type.includes("BOOKMARK")||_y(e)||"OMNI_RESULT_TYPED_HISTORY_SEARCH"===e.type||"OMNI_RESULT_BOOKMARK_UNKNOWN"===e.type}function Py(e){return"OMNI_RESULT_HISTORY_URL"===e.type||"OMNI_RESULT_HISTORY_PROMOTED"===e.type||"OMNI_RESULT_HISTORY_TITLE"===e.type}function Dy(e){return"OMNI_RESULT_TYPED_HISTORY"===e.type}function xy(e){return"OMNI_RESULT_DIRECT_MATCH"===e.type}function Oy(e){return"OMNI_RESULT_SYNCED_TABS"===e.type}function Ly(e){return"OMNI_RESULT_SUGGEST"===e.type}class Ry extends F.Z{getInitialState(){return{directMatchBlocks:null}}getDirectMatchBlocks(){return this.getState().directMatchBlocks}reduce(e,t){if("DIRECT_MATCH_INIT"===t.actionType)e={...t.directMatchData};return e}}const By=new Ry;var Fy=n(2004);const Vy=.7,Wy={q:["w","a"],w:["e","s","a","q"],e:["r","d","s","w"],r:["t","f","d","e"],t:["y","g","f","r"],y:["u","h","g","t"],u:["i","j","h","y"],i:["o","k","j","u"],o:["p","l","k","i"],p:["l","o"],a:["q","w","s","z"],s:["w","e","d","x","z","a"],d:["e","r","f","c","x","s"],f:["r","t","g","v","c","d"],g:["t","y","h","b","v","f"],h:["y","u","j","n","b","g"],j:["u","i","k","m","n","h"],k:["i","o","l","m","j"],l:["o","p","k"],z:["a","s","x"],x:["s","d","c","z"],c:["d","f","v","x"],v:["f","g","b","c"],b:["g","h","n","v"],n:["h","j","m","b"],m:["j","k","n"]},Uy=Array.from({length:128},(()=>Array(128).fill(1)));for(const e in Wy){const t=e.charCodeAt(0);Uy[t][e.toUpperCase().charCodeAt(0)]=.6,Uy[e.toUpperCase().charCodeAt(0)][t]=.6;for(const n of Wy[e]){const s=n.charCodeAt(0);Uy[t][s]=Vy,Uy[s][t]=Vy,Uy[e.toUpperCase().charCodeAt(0)][n.toUpperCase().charCodeAt(0)]=Vy,Uy[n.toUpperCase().charCodeAt(0)][e.toUpperCase().charCodeAt(0)]=Vy}}function Hy(e,t,n,s,i){if(t===n)return s?1:0;const o=e(t,n,Uy,i);if(!s)return o;const a=t.length,r=n.length,l=Math.max(a,r);return(l-o)/l}function zy(e,t,n,s){const i=e.length,o=t.length,a=Array.from({length:i+1},(()=>Array(o+1).fill(0)));for(let e=0;e<=i;e++)a[e][0]=e;for(let e=0;e<=o;e++)a[0][e]=e;for(let r=1;r<=i;r++)for(let i=1;i<=o;i++){let o=0;if(e[r-1]!==t[i-1]){const s=e.charCodeAt(r-1),a=t.charCodeAt(i-1);o=s<n.length&&a<n[s].length?n[s][a]:1}a[r][i]=Math.min(a[r-1][i]+1,a[r][i-1]+1,a[r-1][i-1]+o),s&&r>1&&i>1&&e[r-1]===t[i-2]&&e[r-2]===t[i-1]&&(a[r][i]=Math.min(a[r][i],a[r-2][i-2]+o))}return a[i][o]}function Gy(e,t,n=!1){return Hy(zy,e.toLowerCase(),t.toLowerCase(),n,!0)}function $y(e,t,n){fetch(e.clickUrl),Fy.Z.go(t,[e.url],{...n,transition:C.Z.historyPrivate.TransitionType.GENERATED})}function Ky(e,t,n,s){let i;if(H.Z.get($.kVivaldiAddressBarSearchDirectMatchEnabled)&&t){const o=e.trim().replace(/\s+/g," ").toLowerCase(),a=o.length;t.blocks.some((({unit:e})=>{if(e.match_offset>a||e.blocked_names.some((e=>e.toLowerCase()===o)))return!1;const t=e.name.slice(0,a).toLowerCase(),r=function(e){const t=e.length<3?0:1;return(Vy+.28*Math.floor(e.length/2))*t}(t),l=Gy(t,o)<=r,d=e.alternative_names.some((e=>Gy(e.slice(0,a).toLowerCase(),o)<=r));return!(!l&&!d)&&(i=function(e,t){const n=N()().format("YYYYMMDDHH"),s=function(e){const t=document.createElement("canvas").getContext("2d");return t.font="13px system-ui, -apple-system, HelveticaNeue, sans-serif",t.measureText(e).width}(e.title)<t/2?e.title:e.name;return{id:e.target_url,url:e.target_url.replace("%YYYYMMDDHH%",n),clickUrl:e.click_url.replace("%YYYYMMDDHH%",n),title:s,type:"OMNI_RESULT_DIRECT_MATCH",faviconUrl:e.image_url,faviconType:"url",isDeleteDisabled:!0}}(e,n),s?.id!==i.id&&function(e){const t=By.getDirectMatchBlocks();if(!t||!t.blocks||t.blocks.length<3)return;const n=[...t?.blocks].sort((()=>.5-Math.random())),s=n.findIndex((t=>t.unit.click_url===e.clickUrl));n.splice(0,0,n.splice(s,1)[0]),n.slice(0,4).forEach((async e=>{fetch(e.unit.image_url)}))}(i),!0)}))}return i}function jy(e,t){const n=e.filter((e=>xy(e))),s=(0,ms.Z)(t);return!(!n||!s)&&n.some((e=>(0,ms.Z)(e?.url)?.host===s.host))}function Yy(e,t,n,s){return 0!==e.length&&!Cy(s)&&t&&H.Z.get($.kAddressBarAutocompleteEnabled)?qy(e,t,s,n)?function(e,t){const n=(new URL(e.url).origin??"")+"/";return eC(t,n)}(t,s):function(e,t,n){if(!e||!H.Z.get($.kAddressBarAutocompleteEnabled))return t;const{url:s}=e;if(!n){if(e?.nickname&&Qy(t,e.nickname))return Xy(t,e.nickname);const n=function(e,t){if(e?.title&&Jy(e?.url,t,e.title)&&Qy(t,e.title))return Xy(t,e.title);if(Dy(e))return e?.text&&Qy(t,e.text)?Xy(t,e.text):e?.title&&Qy(t,e.title)?Xy(t,e.title):t;return null}(e,t);if(n)return n;const i=eC(t,s);return i!==t?i:e?.title&&Qy(t,e.title)?Xy(t,e.title):e?.text&&Qy(t,e.text)?Xy(t,e.text):t}switch(n){case"url":return eC(t,s);case"nickname":if(e?.nickname)return Xy(t,e.nickname);break;case"text":if(e?.text)return Xy(t,e.text);break;case"title":if(e?.title)return Xy(t,e.title)}return t}(t,s,n):s}function Xy(e,t){return e+t.slice(e.length)}function Qy(e,t){return t.toLowerCase().startsWith(e.toLowerCase())}function qy(e,t,n,s){const{origin:i,host:o}=(0,ms.Z)(t.url)??{origin:"",host:""},a=i+"/",r=o+"/",l=r.replace("www.",""),d=n.toLowerCase();return H.Z.get($.kAddressBarAutocompleteAutocompleteOnDomainFirst)&&"url"===s&&(0,vs.K2)(t.url)&&!Dy(t)&&!Ny(t)&&!xy(t)&&!jy(e,t.url)&&(a.startsWith(d)&&d.length<=a.length||r.startsWith(d)&&d.length<=r.length||l.startsWith(d)&&d.length<=l.length)}function Jy(e,t,n){const s=e?.indexOf("vivaldi.com/bk/");return"string"==typeof e&&-1!==s&&"string"==typeof n&&Qy(t,n)}function eC(e,t){const n=e.toLowerCase(),s=(0,vs.Df)(t),i=t.toLowerCase(),{origin:o,host:a,pathname:r}=(0,ms.Z)(i)??{origin:"",host:"",pathname:""},l=i.startsWith(n)?0:i.slice(s).indexOf(n)+s;let d="";if(!(a&&o&&(0,vs.K2)(t))||n.startsWith(o)||n.startsWith(a)||r){const o=t.slice(s);return t.includes("vivaldi.com/bk/")&&Ty(e,t)||Qy(e,o)?Xy(e,o):Xy(e,t.slice(i.indexOf(n)))}{const n=t.slice(l+e.length,o.length);d=t.slice(0,l)+e+n+(n&&n.endsWith("/")?"":"/")}return d.slice(l)}class tC extends hs.PureComponent{static contextType=xi.Z;context;#C=!1;#w=!1;#b="";#S=!1;get isIMEOpen(){return this.#w}refUrlInput=hs.createRef();state={autocompleteValue:"",shouldAutocompleteValue:!0,url:this.props.displayUrl||"",typedValueSetByInputEvent:!1};static getDerivedStateFromProps(e,t){if(e.displayUrl!==t.url)return{url:e.displayUrl,autocompleteValue:e.value,shouldAutocompleteValue:!1};const{selectedItem:n}=yy.getUrlfieldState(e.pageId);if(!t.shouldAutocompleteValue||!e.value)return{autocompleteValue:e.value,shouldAutocompleteValue:!1};if(0===e.autocompleteData.length&&t.autocompleteValue.toLowerCase().startsWith(e.value.toLowerCase()))return{autocompleteValue:t.autocompleteValue};if("OMNI_TYPE_SEARCH"===n?.type||e.navigationMode)return{autocompleteValue:e.value};const s=Yy(e.autocompleteData,e.autocompleteData[0],e.autocompleteKeyMatch,e.value);return{autocompleteValue:s,typedValueSetByInputEvent:e.value===s&&e.pageContext.isUrlFieldFocused&&t.typedValueSetByInputEvent}}componentDidUpdate(e,t){t.autocompleteValue!==this.state.autocompleteValue&&this.state.shouldAutocompleteValue&&this.props.onAutocompleteValueChange(this.state.autocompleteValue)}_makeSubmit=e=>{const t={ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey},n=H.Z.get($.kAddressBarOmniboxShowBestResult)?this.props.autocompleteData[0]?this.props.autocompleteData[0].url:this.state.autocompleteValue:this.props.value;this.setState({shouldAutocompleteValue:!1}),this.props.onSubmit({autocompletedValue:n,typedValue:yy.getTypedUrlWithFallback(this.context.vivaldiWindowId,this.props.pageId)},t)};onKeyDown=e=>{if(this.props.onKeyDown(e),"Escape"===e.key&&this.setState({shouldAutocompleteValue:!1,autocompleteValue:""}),"Enter"===e.key&&(e.altKey||e.ctrlKey||e.metaKey))return this._makeSubmit(e),void this.setState({shouldAutocompleteValue:!1});"Backspace"===e.key&&this.#w&&(this.#C=!0)};onKeyPress=e=>{this.props.onKeyPress(e),"Enter"!==e.key&&13!==e.which||e.altKey||e.ctrlKey||this._makeSubmit(e)};onValueChange=e=>{const{autocompleteValue:t,selectedItem:n}=yy.getUrlfieldState(this.props.pageId),s=yy.getTypedUrlWithFallback(this.context.vivaldiWindowId,this.props.pageId);if(py.Z.updateState(this.props.pageId,{typedUrl:e===this.props.displayUrl?void 0:e,selectedItem:t.startsWith(e)||!H.Z.get($.kAddressBarAutocompleteEnabled)?n:void 0}),s===e)this.setState({autocompleteValue:e,shouldAutocompleteValue:!1,typedValueSetByInputEvent:!0});else{const n=e.endsWith(" "),i=!this.props.navigationMode&&(s!==this.props.displayUrl&&e.length>=s.length||s===this.props.displayUrl&&1===e.length),o=this.props.navigationMode&&Boolean(t)&&e.length>=t.length,a=!this.#w&&!n&&!this.#S;this.setState({typedValueSetByInputEvent:!0,shouldAutocompleteValue:a&&(i||o)}),this.#S=!1}this.props.onValueChange(e)};onSelect=e=>{const{selectionStart:t,selectionEnd:n,value:s}=e.currentTarget;this.props.onSelect(e),this.#b=s.substring(t,n)};onCompositionStart=()=>{this.#w=!0};onCompositionUpdate=()=>{this.#w=!0};onCompositionEnd=e=>{const t=e.currentTarget.value,n=yy.getTypedUrlWithFallback(this.context.vivaldiWindowId,this.props.pageId),s=!this.#C&&t.length>=n.length;this.#C=!1,this.setState({shouldAutocompleteValue:s}),this.#w=!1};onCut=e=>{this.setState({shouldAutocompleteValue:!1,typedValueSetByInputEvent:!0}),this.props.onCut(e)};onPaste=e=>{this.#S=!0,this.props.onPaste(e)};render(){const e=yy.getTypedUrlWithFallback(this.context.vivaldiWindowId,this.props.pageId);return(0,fs.jsx)(hy,{ref:this.refUrlInput,autocompleteValue:this.state.autocompleteValue,typedValue:e,autoFocus:this.props.autoFocus,className:this.props.className,disabled:this.props.disabled,placeholder:this.props.placeholder,title:this.props.title,readOnly:this.props.readOnly,readOnlyDnD:this.props.readOnlyDnD,inputId:this.props.inputId,onBlur:this.props.onBlur,onFocus:this.props.onFocus,onSelect:this.onSelect,onCompositionStart:this.onCompositionStart,onCompositionUpdate:this.onCompositionUpdate,onCompositionEnd:this.onCompositionEnd,onClick:this.props.onClick,onContextMenu:this.props.onClick,onDragStart:this.props.onDragStart,onDragEnter:this.props.onDragEnter,onDragOver:this.props.onDragOver,onDragLeave:this.props.onDragLeave,onDragEnd:this.props.onDragEnd,onDrop:this.props.onDrop,onMouseDown:this.props.onMouseDown,onMouseUp:this.props.onMouseUp,onCut:this.onCut,onCopy:this.props.onCopy,onPaste:this.onPaste,onKeyDown:this.onKeyDown,onValueChange:this.onValueChange,onKeyPress:this.onKeyPress})}}const nC=["http:","https:","file:","ftp:"];function sC(e,t){const{visitCount:n=0,url:s=""}=t;return n+("OMNI_RESULT_HISTORY_PROMOTED"===e?200:0)-100*(s.split("/").length-4)}class iC{search=(e,t)=>{if(!e)return Promise.resolve([]);const[n,...s]=e.replace(/\s+/g," ").trim().split(" ");return new Promise((e=>{C.Z.historyPrivate.getDetailedHistory({text:n,maxResults:1e3},(n=>{e(n.filter((e=>e.url&&0!==e.lastVisitTime&&e.url.length<2048&&nC.some((t=>(e.url||"").startsWith(t)))&&!e.isRedirect&&function(e,t){if(0===e.length)return!0;const{title:n,url:s}=t;return n&&e.every((e=>n.toLowerCase().includes(e.toLowerCase())))||s&&e.every((e=>s.toLowerCase().includes(e.toLowerCase())))}(s,e))).map((e=>{const t=function(e,t){const n=t.map((e=>new RegExp((0,wy.Z)(e),"i"))),{url:s,title:i}=e;return s&&n.every((e=>s.toLowerCase().match(e)))?"/"===s.charAt(s.length-1)?"OMNI_RESULT_HISTORY_PROMOTED":"OMNI_RESULT_HISTORY_URL":i&&n.every((e=>i.toLowerCase().match(e)))?"OMNI_RESULT_HISTORY_TITLE":"OMNI_RESULT_HISTORY_UNKNOWN"}(e,s);return((e,t)=>{const{id:n,title:s,typedCount:i,url:o}=e,a={type:t,id:n,score:sC(t,e),title:s||"",typed:Boolean(i&&i>0),url:je.jk.getDisplayUrlFromMapping(o||""),isDeleteDisabled:!1,faviconUrl:o,faviconType:"favicon"};return e.lastVisitTime&&(a.lastVisitTime=e.lastVisitTime),e.visitCount&&(a.visitCount=e.visitCount),a})(e,t)})).sort(((e,t)=>(t.score||0)-(e.score||0))).filter(((e,n)=>n<t.count)))}))}))}}const oC=function(e="",t="",n){if(Cy(e)||Cy(t)||t.startsWith("data:"))return t;const s=e.toLowerCase().split(" ");let i;try{i=new RegExp("("+s.map((e=>(0,wy.Z)(e.toLowerCase()))).filter((e=>e.trim().length>0)).join("|")+")","i")}catch(e){return t}const o=t.toLowerCase().split(i);let a=0;return hs.createElement("span",{className:n},o.reduce(((e,n,s)=>{const o=a,r=i.test(n);return a+=n.length,r?e.concat(hs.createElement("b",{key:s},t.substr(o,n.length))):e.concat(hs.createElement("span",{key:s},t.substr(o,n.length)))}),[]))};var aC,rC;function lC(e,t,n,s){aC||(aC="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:aC,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class dC extends hs.PureComponent{domElement=hs.createRef();handleMouseUp=e=>{const{type:t,id:n,index:s}=this.props;e.button===Hi.Z.kCenter&&this.props.onMiddleClick(t,n,s)};handleClick=e=>{const{type:t,id:n,index:s}=this.props;this.props.onClick(t,n,s,e)};handleDelete=e=>{if(!this.props.onDelete)return;const{type:t,id:n,index:s}=this.props;this.props.onDelete(t,n,s),e.stopPropagation()};componentDidUpdate(e){!e.isHighlighted&&this.props.isHighlighted&&this.domElement.current&&this.domElement.current.scrollIntoViewIfNeeded()}renderFavicon=()=>{const{faviconUrl:e,faviconType:t}=this.props;return e?lC(Ss,{url:e,loadType:"url"===t?"faviconSkipCache":"img"===t?"faviconFromCache":"page"}):null};render(){const{displayText:e,details:t,index:n,isHighlighted:s,onMouseOver:i,pattern:o,nickname:a,type:r,url:l,badge:d}=this.props,c=As()({"omni-clickable":!0,OmniLinkItem:!0,"OmniLinkItem--Highlighted":s,"OmniLinkItem--SingleValue":!t&&!d,"OmniLinkItem--DirectMatch":"OMNI_RESULT_DIRECT_MATCH"===r});return(0,fs.jsxs)("div",{"data-index":n,"data-url":a||l||"",ref:this.domElement,className:c,onClick:this.handleClick,onMouseUp:this.handleMouseUp,onMouseOver:i,children:[this.props.faviconUrl&&lC("div",{className:"OmniLinkItem-Favicon"},void 0,this.renderFavicon()),lC("span",{className:"OmniLinkItem-Url"},void 0,o?oC(o,e,"OmniLinkItem-Url"):e),t&&(o&&oC(o,t,"OmniLinkItem-Details")||t),d&&lC("span",{className:"OmniLinkItem-Badge"},void 0,d),this.props.onDelete&&lC("span",{className:"OmniLinkItem-EraseButton",title:(0,Oe.Z)("Delete history item"),onClick:this.handleDelete,dangerouslySetInnerHTML:{__html:Ts.kze}})]})}}function cC(e,t,n,s){rC||(rC="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:rC,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class hC extends hs.PureComponent{static contextType=xi.Z;nodeRef=hs.createRef();state={searchEngineKeyword:"",searchEngineName:""};static getDerivedStateFromProps(e){const t=(e.typedSearchEngine||e.defaultSearchEngine||{name:""}).name;return{searchEngineKeyword:!e.typedSearchEngine&&e.defaultSearchEngine&&e.defaultSearchEngine.keyword&&e.defaultSearchEngine.keyword+" "||"",searchEngineName:t}}getNode(){return this.nodeRef.current}handleClickOutside=()=>{this.props.onMenuClosed?.()};getNumberOfItems=()=>this.props.items.reduce(((e,{items:t})=>e+t.length),0);componentDidUpdate(e,t){const n=this.getNumberOfItems();this.props.onNumberOfSelectableItemsChanged&&this.props.onNumberOfSelectableItemsChanged(n)}onLinkItemClicked=(e,t,n,s)=>{const i={ctrlKey:s.ctrlKey,altKey:s.altKey,shiftKey:s.shiftKey,metaKey:s.metaKey,button:s.button},o=this.findLinkItem(e,t,n);o&&this.props.onLinkItemClicked(o,(0,nl.Z)(this.context.vivaldiWindowId,i))};onDeleteItem=(e,t,n)=>{const s=this.findLinkItem(e,t,n);s&&!s.isDeleteDisabled&&this.props.onDeleteItem(s)};onLinkItemMiddleClicked=(e,t,n)=>{const s=nl.k.openInBackgroundTab,i=this.findLinkItem(e,t,n);i&&this.props.onLinkItemClicked(i,s)};findLinkItem=(e,t,n)=>{const s=this.props.items.find((n=>n.items.some((n=>n.type===e&&n.id===t))))?.items[n];if(s)return s;console.error("linkItem id doesn't match",t)};getDetails=e=>{if(Dy(e)||xy(e)||Ly(e))return"";const{pattern:t}=this.props;if("OMNI_RESULT_BOOKMARK_DESCRIPTION"===e.type&&e.description&&t&&(!e.url.includes(t)||!e?.title.includes(t))){const{description:n}=e,s=n.indexOf(t),i=Math.max(0,s-10);return(0!==i?"...":"")+n.slice(i)}return e.nickname||e.title||""};getBadge=e=>xy(e)?(0,Oe.Z)("Direct Match"):Oy(e)?(0,Oe.Z)(e.deviceName):"";renderLinkItem=(e,t,n,s)=>{const i=n-(s-t)===this.props.selectionIndex,o=void 0!==this.props.autocompleteHighlight&&this.props.autocompleteHighlight===e.id&&-1===this.props.selectionIndex,a=function(e){return Dy(e)&&e.text?e.text:xy(e)?e.title:e.url?e.url:e.title?e.title:e.text?e.text:""}(e),r="OMNI_RESULT_SUGGEST"===e.type||"OMNI_TYPE_SEARCH"===e.type;return cC(dC,{id:e.id,displayText:a,index:t,isHighlighted:i||o,details:this.getDetails(e),badge:this.getBadge(e),onClick:this.onLinkItemClicked,onMiddleClick:this.onLinkItemMiddleClicked,onDelete:e.isDeleteDisabled?null:this.onDeleteItem,pattern:r?void 0:this.props.pattern,hideIcons:Boolean(this.props.hideIcons),nickname:e.nickname||"",url:e.url||"",type:e.type,faviconUrl:e.faviconUrl||void 0,faviconType:e.faviconType||void 0},e.type+"-"+e.id)};renderCollection=({items:e,title:t,type:n},s)=>{if(!e||0===e.length)return null;return cC("section",{className:"OmniDropdown-Collection"},`${n}-${t||""}`,t&&cC("label",{className:"OmniDropdown-Label"},void 0,(0,Oe.Z)(t)),e.map(((t,n)=>this.renderLinkItem(t,n,s,e.length))))};render(){const{items:e}=this.props;let t=0;return(0,fs.jsx)("div",{ref:this.nodeRef,className:"OmniDropdown",children:e.map(((e,n)=>(t+=e.items.length,this.renderCollection(e,t))))})}}const pC=(0,ua.Z)(hC);const uC=class{constructor({provider:e}){this._searchProvider=e}search(e,t){const n=new Promise(((s,i)=>this._searchProvider.search(e,t).then(((...e)=>{n!==this._newestInstanceSearch&&i("A more recent search is in progress"),s(...e)}))));return this._newestInstanceSearch=n,this._newestInstanceSearch}};function gC(e){const t=!H.Z.get($.kAddressBarOmniboxShowSearchHistory);return e.reduce(((e,n)=>{const{keywordId:s,terms:i,url:o,title:a,typedCount:r}=n,l="-1"!==s?i:null;return t&&l||e.push({...l?{text:l}:null,url:o,title:a,typedCount:r,type:"OMNI_RESULT_TYPED_HISTORY",id:o,isDeleteDisabled:!1,faviconUrl:n.url,faviconType:"favicon"}),e}),[])}class mC{search=(e,t)=>e?new Promise((n=>{const s=Gn.Z.getByQuery(e),i=s?s.id:"-1";C.Z.historyPrivate.getTypedHistory(e,i,t.count,(e=>n(gC(e))))})):Promise.resolve([])}var vC;function fC(e,t,n,s){vC||(vC="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:vC,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var yC=fC("bdo",{},void 0,"."),CC=fC("bdo",{},void 0,"."),wC=fC("bdo",{},void 0,":"),bC=fC("bdo",{},void 0,"."),SC=fC("bdo",{},void 0,":");class IC extends hs.Component{static contextType=xi.Z;refComponent=hs.createRef();componentDidMount(){if(!this.refComponent.current)return;this._intersectionObserver=new IntersectionObserver((([e])=>{this.onIntersectionChange(e.intersectionRatio)}),{threshold:1}),this._intersectionObserver.observe(this.refComponent.current)}componentWillUnmount=()=>{this.props.onBaseDomainObscured(!1),this._intersectionObserver?.disconnect()};onIntersectionChange=e=>{const t=e<1;this.props.onBaseDomainObscured(t)};renderBdoSubDomain=e=>-1===e.indexOf(".")?(0,fs.jsxs)(fs.Fragment,{children:[fC("bdi",{},void 0,e),yC]}):e.split(".").map(((e,t)=>fC("span",{},t,fC("bdi",{},void 0,e),CC)));render(){const{urlFragment:e,onGoToPath:t,tld:n,basedomain:s,subdomain:i,port:o,scheme:a}=this.props,r=(a?`${a}://`:"")+(e||"")+(o?`:${o}`:""),l=this.context.vivaldiWindowId;return fC(ZC,{windowId:l,url:r,rawDisplay:this.props.rawDisplay,onGoToPath:t},void 0,s?(0,fs.jsxs)("span",{ref:this.refComponent,children:[i&&fC("span",{className:"UrlFragment--Lowlight UrlFragment-HostFragment-Subdomain"},void 0,this.renderBdoSubDomain(i)),fC("span",{className:"UrlFragment--Highlight UrlFragment-HostFragment-Basedomain"},void 0,fC("bdi",{},void 0,s)),n&&fC("span",{className:"UrlFragment--Highlight UrlFragment-HostFragment-TLD"},void 0,bC,fC("bdi",{},void 0,n)),o&&fC("span",{className:"UrlFragment--Lowlight UrlFragment-HostFragment-Port"},void 0,SC,fC("bdi",{},void 0,o))]}):(0,fs.jsxs)("span",{ref:this.refComponent,children:[fC("span",{className:"UrlFragment--Highlight"},void 0,e),o&&fC("span",{className:"UrlFragment--Lowlight"},void 0,wC,o)]}))}}var kC,AC=n(10373);function TC(e,t,n,s){kC||(kC="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:kC,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function ZC({windowId:e,url:t,className:n,children:s,onGoToPath:i,rawDisplay:o}){return TC("span",{className:As()(n,{"UrlFragment-Link":!o}),onClick:()=>i(t),onMouseOver:()=>!o&&c.Z.setStatus(e,t),onMouseOut:()=>!o&&c.Z.clearStatus(e)},void 0,s)}var EC=TC("bdo",{},void 0,"/");function _C({windowId:e,urlFragment:t,onGoToPath:n,host:s,scheme:i,port:o,rawDisplay:a,shouldDisplayPostfix:r}){return t?t.split("/").slice(1).map(((t,l,d)=>{if(!t&&r)return null;const c=(i?`${i}://`:"")+(s||"")+(o?`:${o}`:"")+"/"+d.slice(0,l+1).join("/");return TC(ZC,{windowId:e,className:"UrlFragment--Lowlight",rawDisplay:a,onGoToPath:n,url:c},c,EC,TC("bdi",{},void 0,t))})):null}var MC=TC("bdo",{},void 0,"&"),NC=TC("bdo",{},void 0,"=");function PC({urlFragment:e}){if(!e)return null;return e.split("&").map(((e,t)=>{const n=e.split("="),s=n[0];n.shift();const i=n.join("="),o=n.length>0;return TC("span",{},s,0!==t&&MC,s&&TC("bdi",{},void 0,s),o&&NC,i&&TC("bdi",{},void 0,i))}))}var DC=TC("bdo",{},void 0,"/"),xC=TC("bdo",{},void 0,"?"),OC=TC("bdo",{},void 0,"#");function LC({urlFragment:e,path:t}){if(!e)return null;const n=e.indexOf("#"),s=-1!==n?e.substring(n+1,e.length):"",i="?"===e.charAt(0)?e.substring(1,-1===n?e.length:n):"";return TC("span",{className:"UrlFragment--Lowlight"},void 0,(!t||"/"===t||"/"===t.slice(-1))&&DC,i&&(0,fs.jsxs)(fs.Fragment,{children:[xC,TC(PC,{urlFragment:i})]}),s&&(0,fs.jsxs)(fs.Fragment,{children:[OC,TC("bdi",{},void 0,s)]}))}var RC=TC("bdo",{},void 0,"://");function BC({urlFragment:e}){return TC("span",{className:"UrlFragment--Lowlight"},void 0,TC("bdi",{},void 0,e),RC)}var FC=TC("span",{className:"UrlFragment--Highlight"},void 0,"data:");function VC({urlFragment:e}){return e?(0,fs.jsxs)(fs.Fragment,{children:[FC,TC("span",{className:"UrlFragment--Lowlight"},void 0,e.substring("data:".length,h.RL))]}):null}function WC({windowId:e,displayUrl:t,shouldShowFullUrl:n,onGoToPath:s,shouldHighlightBaseDomain:i,onBaseDomainObscured:o,urlFragments:a,rawDisplay:r}){const l=function(){const{selectWindow:e,vivaldiWindowId:t}=hs.useContext(xi.Z),[n,s]=hs.useState(!1);return hs.useEffect((()=>{function n(e,n,i,o){e===t&&o===oa.Z.KEY_CONTROL&&s(n)}function i(){s(!1)}return C.Z.tabsPrivate.onKeyboardChanged.addListener(n),G.ZP.addListener(i,e),()=>{C.Z.tabsPrivate.onKeyboardChanged.removeListener(n),G.ZP.removeListener(i)}}),[e,t]),n}();if(!t)return null;const d=t;if(!["http","https","ftp","data"].includes(d.substring(0,d.indexOf(":"))))return TC("div",{className:As()({"UrlFragment-Wrapper":!r})},void 0,TC("span",{className:"UrlFragment--Highlight"},void 0,t.substring(0,h.RL)));const{schema:c}=(0,AC.C)(t);if("data:"===c)return TC("div",{className:As()({"UrlFragment-Wrapper":!r,"UrlFragment-Wrapper--ShouldHighlight":i})},void 0,TC(VC,{urlFragment:d}),";");const p=function(e){return(e.scheme?.length||0)+(e.username?.length||0)+(e.password?.length||0)+(e.host?.length||0)+(e.path?.length||0)+(e.ref?.length||0)+(e.query?.length||0)+(e.port?.length||0)+(e.tld?.length||0)>=h.RL}(a);if(p)return TC("div",{className:As()({"UrlFragment-Wrapper":!r})},void 0,TC("span",{className:"UrlFragment--Highlight"},void 0,t.substring(0,h.RL)));const{host:u,tld:g,port:m,scheme:v,path:f,query:y,ref:w}=a,b=("string"==typeof y?`?${y}`:"")+("string"==typeof w?`#${w}`:""),{subdomain:S,basedomain:I,hostTld:k}=(0,gy.gC)(u,g)||{subdomain:"",basedomain:"",hostTld:""},A=n&&b.length>0;return TC("div",{className:As()("UrlFragments",{"UrlFragment-Wrapper":!r,"UrlFragment-Wrapper--Clickable":!r&&l,"UrlFragment-Wrapper--ShouldHighlight":!r&&i})},void 0,n&&v&&TC(BC,{urlFragment:v}),TC("span",{className:"UrlFragment-LinkWrapper"},void 0,TC(IC,{urlFragment:u,scheme:v||"",tld:0!==k.length?k:g,port:m,basedomain:I,subdomain:S,rawDisplay:r,onGoToPath:s,onBaseDomainObscured:e=>o&&o(e)}),(n||!n&&"/"!==f)&&TC(_C,{windowId:e,urlFragment:f,onGoToPath:s,host:u,port:a.port,scheme:v||"",rawDisplay:r,shouldDisplayPostfix:A})),A&&TC(LC,{urlFragment:b,path:f}))}var UC=n(68079),HC=n.n(UC),zC=n(94595),GC=n(34155);class $C{_numberOfSelectableItems=0;_selectionIndex=0;constructor(e){this._inputComponent=e}setNumberOfSelectableItems=e=>{this._numberOfSelectableItems=e};getNumberOfSelectableItems=()=>this._numberOfSelectableItems;setSelectionIndex=e=>{this._selectionIndex=e};getSelectionIndex=()=>this._selectionIndex;_moveHighlight=(e,t)=>{const{HTMLElement:n}=this._inputComponent.context,s=this._inputComponent.getDropdown(),i=s?.nodeRef.current;if(!(i instanceof n))return Promise.reject();let o=-1;const a=Array.from(i.getElementsByClassName("omni-clickable")),r=this.getSelectionIndex(),l=this.getNumberOfSelectableItems();if(r<0||void 0===a[r])o=l-1;else{const n=a[r],s=0===r||parseInt(i.scrollTop)+10>n.offsetTop;switch(t){case"page":if(e)s?o=a.findIndex((e=>e.offsetTop+e.offsetHeight>i.offsetHeight)):(i.scrollTop=n.offsetTop,o=a.findIndex((e=>e.offsetTop>i.offsetHeight+i.scrollTop))),-1===o&&(o+=l);else if(s)i.scrollTop-=i.offsetHeight;else{let e=a.length-1;for(;e>0&&!(a[e].offsetTop-a[e].offsetHeight<i.scrollTop);e--);o=e}break;case"section":if(e){let e=this._getSectionIndex(!0,r+1,a);-1===e&&(e=this._getSectionIndex(!0,0,a)),-1!==e&&(o=e)}else{let e=this._getSectionIndex(!1,r-1,a);-1===e&&(e=this._getSectionIndex(!1,a.length-1,a)),-1!==e&&(o=e)}break;case"line":o=r+(e?1:-1),e?o>=l&&(o=0):o<0&&(o=l-1)}}return Number.isInteger(o)?(this._inputComponent.setAutocompleteHighlight(o,!0),this._setSelectedItem(s,o),new Promise((e=>{GC.nextTick(e)}))):Promise.reject()};_setSelectedItem=(e,t)=>{const n=this._inputComponent.setSelectedItem;if(!e||1===e.getNumberOfItems()||!n)return;n(e.props.items.flatMap((e=>e.items??[]))[t])};_getSectionIndex=(e,t,n)=>{if(e)for(let e=t;e<n.length;e++){if("0"===n[e].dataset.index)return e}else for(let e=t;e>=0;e--){if("0"===n[e].dataset.index)return e}return-1};up=()=>this._moveHighlight(!1,"line");down=()=>this._moveHighlight(!0,"line");pageUp=()=>this._moveHighlight(!1,"page");pageDown=()=>this._moveHighlight(!0,"page");sectionUp=()=>this._moveHighlight(!1,"section");sectionDown=()=>this._moveHighlight(!0,"section")}function KC(e,t,n){const s=e.toLowerCase(),i=function(e,t){const n=t.find((t=>t.nickname&&t.nickname===e));if(n&&H.Z.get($.kAddressBarOmniboxShowNicknames))return{item:n,keyMatch:"nickname",override:!0,categoryTitle:(0,Oe.Z)("Nickname")}}(s,t);if(i)return i;const o=function(e,t,n){let s,i,o;t.forEach((a=>{if("OMNI_TYPE_SEARCH"===a.type||"OMNI_DIRECT_TYPED_URL"===a.type||Ly(a)||"OMNI_DOMAIN_AUTOCOMPLETE"===a.type)return;const r=XC(a,s,"nickname"),l=XC(a,i,"url"),d=XC(a,o,"title"),c=Dy(a);(!s||r)&&a.nickname&&a.nickname.length>0&&Qy(e,a.nickname)&&(s=a),i&&!l||!QC(e,a)||(xy(a)||jy(t,a.url))&&!xy(a)||(i=a);const h=a.title?.toLowerCase(),p=(!o||d)&&h&&Qy(e,h)&&!c,u=(!o||d)&&c&&a.text&&a.text.length>0&&Qy(e,a.text);(n&&p||u)&&(o=a)}));const a=s||i||o;let r=a?s?"nickname":i?"url":o?"title":null:null;if(a&&Dy(a))return function(e,t){let n,s;if(e.forEach((e=>{!Dy(e)||s&&n||(e.text&&e.text.startsWith(t)&&!s?s=e:QC(t,e)&&!n&&(n=e))})),n&&n.typedCount&&s&&s.typedCount){const e=n.typedCount>=s.typedCount,t=e?n:s;return{item:t,keyMatch:e?"url":"text",override:!1,categoryTitle:jC(t)}}const i=n??s;return{item:i,keyMatch:n?"url":"text",override:!1,categoryTitle:jC(i)}}(t,e);("url"===r&&Jy(a?.url,e,a?.title)||a&&"url"===r&&xy(a))&&(r="title");if(a&&qy(t,a,e,r))return{item:qC(a),keyMatch:"url",override:!0,categoryTitle:(0,Oe.Z)("Domain Result")};return{item:a,keyMatch:r,override:!1,categoryTitle:jC(a)}}(s,t,n);return H.Z.get($.kAddressBarOmniboxShowBestResult)||o.override?o:{item:null,keyMatch:null,override:!1,categoryTitle:""}}function jC(e){const t=(0,Oe.Z)("Best Result");return e?_y(e)?(0,Oe.Z)("Best Result (Nickname)"):Ny(e)?(0,Oe.Z)("Best Result (Bookmark)"):Dy(e)?(0,Oe.Z)("Best Result (Typed History)"):Py(e)?(0,Oe.Z)("Best Result (History)"):Ly(e)?(0,Oe.Z)("Best Result (Search Suggestion)"):function(e){return"OMNI_RESULT_TOPSITE"===e.type}(e)?(0,Oe.Z)("Best Result (Frequently Visited Page)"):xy(e)?(0,Oe.Z)("Best Result (Direct Match)"):Oy(e)?(0,Oe.Z)("Best Result (Synced Tab)"):function(e){return"OMNI_RESULT_INTERNAL"===e.type}(e)?(0,Oe.Z)("Best Result (Vivaldi Page)"):(0,Oe.Z)("Best Result"):t}function YC(e){return"number"==typeof e.score&&"OMNI_RESULT_HISTORY_TITLE"!==e.type&&"OMNI_RESULT_TYPED_HISTORY"!==e.type&&"OMNI_TYPE_SEARCH"!==e.type&&"OMNI_DOMAIN_AUTOCOMPLETE"!==e.type?e.score:-1}function XC(e,t,n){if(!e||!t||!function(e,t){return!(!e?.type||!t.type)&&(Ny(e)&&Ny(t)||Py(e)&&Py(t)||Dy(e)&&Dy(t))}(e,t))return!1;const s=YC(e),i=YC(t);return-1===s||-1===i||s===i?"title"===n&&e.title&&t.title?e.title.length<t.title.length:"nickname"===n&&e.nickname&&t.nickname?e.nickname.length<t.nickname.length:(0,vs.Ph)(e.url).length<(0,vs.Ph)(t.url).length:s>i}function QC(e,t){const n=(0,vs.Df)(t.url),s=function(e,t,n){let s=t.url.toLowerCase().indexOf(e.toLowerCase());0!==s&&(s=t.url.substring(n).toLowerCase().indexOf(e.toLowerCase()),s>-1&&(s+=n));return s}(e,t,n);return 0===s||s===n||s===n+4&&"www."===t.url.substring(n,n+4)}function qC(e){const t=(new URL(e.url).origin??"")+"/",n=e.faviconUrl?e.faviconUrl:t,s=e.faviconType?e.faviconType:"img";return{id:e.id+"-d",type:"OMNI_DOMAIN_AUTOCOMPLETE",url:t,isDeleteDisabled:!0,faviconUrl:n,faviconType:s}}async function JC(){try{const e=await s.Z.sessions.getDevices();if(!e)return[];const t=[];return e.forEach((e=>{e.sessions.forEach((n=>{const s=n.window?.tabs?.map((e=>e))??[];s&&t.push(...s.map((t=>{return n=t,s=e.deviceName,{id:n.sessionId??`sync-${crypto.randomUUID()}`,type:"OMNI_RESULT_SYNCED_TABS",title:n.title??"",url:n.url??"",faviconUrl:n.favIconUrl??"",faviconType:"url",isDeleteDisabled:!0,deviceName:s};var n,s})))}))})),t}catch(e){return console.warn(e),[]}}const ew=eo()((function(e,t){if(!e)return t;let n=!1;return t.reduce(((t,s)=>{if("BEST_RESULT"===s.type||n)return t.push(s),t;const i=s.items.findIndex((t=>t?.id===e?.id&&t.type===e.type));if(-1!==i){const e=H.Z.get($.kAddressBarOmniboxDropdownPriority).findIndex((e=>e===s.type));return H.Z.get($.kAddressBarOmniboxDropdownPriority).findIndex((e=>"BEST_RESULT"===e))<e?t.push({...s,items:[...s.items.slice(0,i),...s.items.slice(i+1)]}):t.push(s),n=!0,t}return t.push(s),t}),[])}),{maxSize:2});var tw,nw=n(34155);function sw(e,t,n,s){tw||(tw="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:tw,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const iw=!1,ow="text/plain",aw=[$.kAddressBarAutocompleteSuffixExpansionValue,$.kAddressBarAutocompleteSuffixExpansionEnabled,$.kAddressBarInlineSearchEnabled,$.kAddressBarInlineSearchSuggestEnabled,$.kAddressBarInlineSearchSuggestOnNickname,$.kAddressBarOmniboxCutcopyEncoded,$.kAddressBarOmniboxEnabled,$.kAddressBarOmniboxShowBookmarks,$.kAddressBarOmniboxShowBrowserHistory,$.kAddressBarOmniboxShowSearchHistory,$.kAddressBarOmniboxShowTopSites,$.kAddressBarOmniboxShowTypedHistory,$.kAddressBarSelectOnClick,$.kAddressBarShowFullUrl,$.kAddressBarTypedHistoryEnabled,$.kAddressBarUrlOpenShortcut,$.kAddressBarOmniboxNumberOfBookmarkResults,$.kAddressBarOmniboxNumberOfHistoryResults,$.kAddressBarOmniboxNumberOfTypedHistoryResults,$.kAddressBarOmniboxNumberOfSearchSuggestions,$.kAddressBarStripJavascriptOnPaste,$.kAddressBarHighlightBaseDomain,$.kAddressBarOmniboxDropdownPriority,$.kAddressBarOmniboxShowNicknames,$.kAddressBarOmniboxShowBestResult,$.kAddressBarOmniboxShowSearchOrGoTo,$.kAddressBarOmniboxShowInternalUrls,$.kVivaldiAddressBarSearchDirectMatchEnabled,$.kAddressBarOmniboxShowSyncTabs,$.kAddressBarAutocompleteEnabled];function rw(e,t){return t&&e.startsWith(t.keyword+" ")?e.slice(t.keyword.length+1):e}const lw=[["vivaldi://version/",(0,Oe.Z)("Vivaldi Version")],["vivaldi://help/",(0,Oe.Z)("Help Pages")],["vivaldi://about/",(0,Oe.Z)("About")],["vivaldi://welcome/",(0,Oe.Z)("Vivaldi Welcome Tour")],["vivaldi://notes/",(0,Oe.Z)("Notes")],["vivaldi://bookmarks/",(0,Oe.Z)("Bookmarks")],["vivaldi://history/",(0,Oe.Z)("History")],["vivaldi://settings/",(0,Oe.Z)("Settings")],["vivaldi://extensions/",(0,Oe.Z)("Extensions")],["vivaldi://experiments/",(0,Oe.Z)("Experiments")],["vivaldi://game/",(0,Oe.Z)("Vivaldia Game")]].map((([e,t],n)=>({url:e,score:n,title:t,isDeleteDisabled:!0,id:e,type:"OMNI_RESULT_INTERNAL",faviconUrl:e,faviconType:"favicon"}))),dw=lw.map((e=>({...e,url:e.url.replace(/\//g,"")})));function cw(e){return{isOmniDropdownOpen:!1,isDefaultTypedHistoryOpen:!1,bookmarkResults:[],historyResults:[],typedHistoryResults:[],nicknameResults:[],suggestResults:[],directMatchResults:[],syncedTabsResults:[],bestResultData:{item:null,keyMatch:null,override:!1,categoryTitle:""},dropdownSelectionIndex:0,autocompletedItem:void 0,value:"",pageId:e,autocompletedIndex:-1,topSitesResults:[],navigationMode:!1,isSearching:!1}}class hw extends hs.PureComponent{static contextType=xi.Z;#h=!1;#I=!1;#k=!1;#A=!1;#T=!1;#Z=0;#E=!1;#_=!1;#M=[];#N=!1;_nav=new $C(this);_directMatchBlocks=null;_omniDropdownElement=hs.createRef();_urlInput=hs.createRef();bookmarkSearch=new Ey;historySearch=new uC({provider:new iC});typedHistorySearch=new mC;state=cw(this.props.pageId);static defaultProps={urlFragments:(0,gy.kG)()};setUrlfieldState=e=>{py.Z.updateState(this.props.pageId,e)};componentDidMount(){this.#h=!0}componentWillUnmount(){this.#h=!1,this._tearDownComponentEventListeners()}static getDerivedStateFromProps(e,t){const n=e.typedUrl??e.displayUrl;if(e.pageId!==t.pageId)return{pageId:e.pageId,value:n};const s=yy.getUrlfieldState(e.pageId);if(s.selectedItem&&t.navigationMode&&t.autocompletedIndex!==t.dropdownSelectionIndex){let e=s.selectedItem.url||"";const t=s.selectedItem;return t.text&&"OMNI_RESULT_TYPED_HISTORY"===t.type&&(e=t.text),{value:e}}return{value:n}}_getDirectMatchUtils=()=>{this._directMatchBlocks=By.getDirectMatchBlocks()};_isSuggestEnabled=()=>{const{prefValues:e}=this.props,t=Boolean(this.props.typedSearchEngine);return!!e[$.kAddressBarInlineSearchSuggestEnabled]&&e[$.kAddressBarOmniboxEnabled]&&(!e[$.kAddressBarInlineSearchSuggestOnNickname]||t)};blur(){(0,cy.gR)(this.context,this.props.inputId)}updateDropdown(){if(!this.#I&&this.props.showDropdown){if(!this.props.prefValues[$.kAddressBarOmniboxEnabled])return;if(!this.props.pageContext.isUrlFieldFocused)return;this.#k=!0,this.setState({isOmniDropdownOpen:!0,isDefaultTypedHistoryOpen:!1})}}searchTopSites=async e=>{let t=[];if(this.props.prefValues[$.kAddressBarOmniboxShowTopSites]&&!G.ZP.isIncognitoOrGuest(this.context.vivaldiWindowId)){let n;try{n=await s.Z.topSites.get()}catch{n=[]}t=n.reduce(((t,n,s)=>(s>5||!n.title.includes(e)&&!n.url.includes(e)||t.push({...n,id:n.url,faviconUrl:n.url,faviconType:"favicon",type:"OMNI_RESULT_TOPSITE"}),t)),[])}return t};runSearchSuggestion=(e,t,n)=>(this._abortController&&this._abortController.abort(),this._abortController=new AbortController,sd({windowId:e,query:t,searchEngine:n,typedSearchEngine:this.props.typedSearchEngine,abortSignal:this._abortController.signal}));onClick=async e=>{if(!this.props.prefValues[$.kAddressBarSelectOnClick])return;const{button:t,currentTarget:n}=e,{selectionStart:s,selectionEnd:i,value:o}=n;if(0===t&&Date.now()-this.#Z<350)return;this.#Z=Date.now();const a=0===s&&i===o.length;if(s===i||a){if(this.isUrlInputFocusedOnMouseDown())return void this.handleInputSelect(n);0===t&&await new Promise((e=>nw.nextTick(e))),n.select(),this._focusedOnMouseDown=null}};onMouseDown=e=>{this._focusedOnMouseDown=this.context.document.activeElement,1===e.buttons&&this.validateAutocomplete(e)};onValueChange=(e,t=-1)=>{const{dropdownSelectionIndex:n,autocompletedIndex:s,bestResultData:i}=this.state;this.props.prefValues[$.kVivaldiAddressBarSearchDirectMatchEnabled]&&!this._directMatchBlocks&&this._getDirectMatchUtils();const o=e.endsWith(" ");this.#_||this.state.value.length>=e.length||o||this.#T?(this.#N=!0,this.setUrlfieldState({selectedItem:void 0,autocompleteValue:""})):this.#N=!1;const{autocompleteValue:a,selectedItem:r}=yy.getUrlfieldState(this.props.pageId),l=this.props.prefValues[$.kAddressBarAutocompleteEnabled]?a.toLowerCase().startsWith(e.toLowerCase()):i.item===r;this.#_=!1,this.setState({isSearching:!0,autocompletedIndex:l?s:-1,dropdownSelectionIndex:l&&!this.#T?n:0===e.length?-1:0,autocompletedItem:void 0,navigationMode:!1},(()=>{e?(-1!==t&&this._urlInput.current?.refUrlInput.current?.setSelection({selectionStart:t,selectionEnd:t}),this.performSearch(e)):this.hideDropdown()}))};getDropdownItems=e=>{const{bookmark:t,topSites:n,suggest:s,nickname:i,typedHistory:o,history:a,directMatch:r,syncedTabs:l,bestResultData:d}=this.getDropdownResults(e),c=this.props.typedUrl||"",h=this.getSearchEngine(),p=function(e){if(e)return{title:e.categoryTitle,type:"BEST_RESULT",items:e.item?[e.item]:[]}}(d),u={title:(0,Oe.Z)("Vivaldi Pages"),type:"INTERNAL_URLS",items:(g=c,g.startsWith("vivaldi:/")?lw.filter((e=>e.url.startsWith(g))):g.startsWith("vivaldi:")?dw.filter((e=>e.url.startsWith(g))):[])};var g;const m=this.getDirectTypedUrlItem(),v={title:(0,Oe.Z)("Nickname"),type:"NICKNAMES",items:i},f={title:(0,Oe.Z)("Bookmarks"),type:"BOOKMARKS",items:t},y={title:(0,Oe.Z)("Frequently Visited Pages"),type:"FREQ_VISIT",items:n},C={title:(0,Oe.Z)("Suggestions"),type:"SUGGESTIONS",items:s},w={title:(0,Oe.Z)("Typed History"),type:"TYPED_HISTORY",items:o},b={title:(0,Oe.Z)("Browser History"),type:"HISTORY",items:a},S={title:(0,Oe.Z)("Direct Match"),type:"DIRECT_MATCH",items:r},I={title:(0,Oe.Z)("Synced Tabs"),type:"SYNCED_TABS",items:l};if(!this.props.prefValues[$.kAddressBarAutocompleteEnabled]&&!this.props.prefValues[$.kAddressBarOmniboxEnabled])return this.props.prefValues[$.kAddressBarInlineSearchEnabled]?h?[h]:[]:m?[m]:[];const k=this.props.prefValues[$.kAddressBarOmniboxDropdownPriority].reduce(((e,t)=>{switch(t){case"BEST_RESULT":(this.props.prefValues[$.kAddressBarOmniboxShowBestResult]||d?.override)&&p&&e.push(p);break;case"INTERNAL_URLS":this.props.prefValues[$.kAddressBarOmniboxShowInternalUrls]&&e.push(u);break;case"SEARCH":if(!this.props.prefValues[$.kAddressBarOmniboxShowSearchOrGoTo])break;this.props.prefValues[$.kAddressBarInlineSearchEnabled]?e.push(...h?[h]:[]):e.push(...m?[m]:[]);break;case"DIRECT_MATCH":this.props.prefValues[$.kVivaldiAddressBarSearchDirectMatchEnabled]&&e.push(S);break;case"NICKNAMES":this.props.prefValues[$.kAddressBarOmniboxShowNicknames]&&e.push(v);break;case"BOOKMARKS":this.props.prefValues[$.kAddressBarOmniboxShowBookmarks]&&e.push(f);break;case"FREQ_VISIT":this.props.prefValues[$.kAddressBarOmniboxShowTopSites]&&e.push(y);break;case"TYPED_HISTORY":this.props.prefValues[$.kAddressBarOmniboxShowTypedHistory]&&e.push(w);break;case"SUGGESTIONS":this.props.prefValues[$.kAddressBarInlineSearchSuggestEnabled]&&e.push(C);break;case"HISTORY":this.props.prefValues[$.kAddressBarOmniboxShowBrowserHistory]&&e.push(b);break;case"SYNCED_TABS":this.props.prefValues[$.kAddressBarOmniboxShowSyncTabs]&&e.push(I)}return e}),[]);if(this.#N){const e=k.findIndex((e=>"SEARCH"===e.type));-1===e&&h?k.splice(0,0,h):k.splice(0,0,k.splice(e,1)[0])}else if(!this.#N&&d?.item&&_y(d?.item)&&ps.ZP.hasNickname(c)){const e=k.findIndex((e=>"BEST_RESULT"===e.type));-1!==e&&k.splice(0,0,k.splice(e,1)[0])}return k};getDropdownResults=e=>{const{nicknameResults:t,bookmarkResults:n,historyResults:s,typedHistoryResults:i,suggestResults:o,topSitesResults:a,directMatchResults:r,syncedTabsResults:l,bestResultData:d}=this.state,c=e?.nickname??t,h=e?.bookmark??n,p=e?.history??s,u=e?.typedHistory??i,g=e?.topSites??a,m=e?.directMatch??r,v=e?.syncedTabs??l;return{nickname:c,bookmark:h,history:p,typedHistory:u,topSites:g,suggest:H.Z.get($.kAddressBarInlineSearchSuggestEnabled)?e?.suggest??o:[],directMatch:m,syncedTabs:v,bestResultData:e?.bestResultData??d}};onAutocompleteValueChange=e=>{this.setUrlfieldState({autocompleteValue:e}),this.state.navigationMode||this.setState({dropdownSelectionIndex:0,autocompletedIndex:0}),nw.nextTick((()=>{this.props.typedUrl&&this.setUrlfieldState({autocompleteValue:e})}))};handleInputSelect=e=>{this.#k?this.#k=!1:""!==e.value.trim()&&"none"===e.selectionDirection&&(e.selectionDirection="forward")};onSelected=e=>{const{currentTarget:t,nativeEvent:n}=e;"mouseup"!==n.type&&this.handleInputSelect(t)};_handleUndo=e=>{const t=e.currentTarget,{value:n}=this.state;if(this.state.value.length<t.value.length){e.preventDefault();const t=e.currentTarget.selectionStart-1;t>0?this.setUrlfieldState({typedUrl:n.substring(0,t)}):(this.setUrlfieldState({typedUrl:""}),this.hideDropdown())}""!==n||ie.ZP.isActiveInternal(this.context.vivaldiWindowId)||(e.preventDefault(),this.revertUrl())};_cleanupState=()=>{this.#A=!1};_constructSearchSuggestion=e=>{const{typedSearchEngine:t,defaultSearchEngine:n}=this.props,s=t||n;if(!s)return Promise.resolve([]);const i=this._isSuggestEnabled(),o=!!t&&t.hasOwnProperty("suggestUrl"),a=!t&&!!n&&n.hasOwnProperty("suggestUrl");if(!(i&&(o||a)))return Promise.resolve([]);const r=t?rw(e,t):e;return r.trim()?this.runSearchSuggestion(this.context.vivaldiWindowId,r.trim(),s):Promise.resolve([])};_searchDropdownItems=async(e,t,n)=>{if(!this.#h||this.props.pageId!==e||this.#I)return;const s=this.#M.length;this._cleanupState();const i=this._constructSearchSuggestion(t),{typedSearchEngine:o}=this.props,a=this.props.prefValues[$.kAddressBarOmniboxShowBrowserHistory]&&!o?this.historySearch.search(t,{count:H.Z.get($.kAddressBarOmniboxNumberOfHistoryResults)}).catch((()=>[])):Promise.resolve([]),r=this.props.typedHistoryEnabled&&this.props.prefValues[$.kAddressBarOmniboxShowTypedHistory]&&!o?this.typedHistorySearch.search(t,{count:H.Z.get($.kAddressBarOmniboxNumberOfTypedHistoryResults)}).catch((()=>[])):Promise.resolve([]),l={nicknameResults:[],bookmarkResults:[]},d=o?Promise.resolve(l):this.bookmarkSearch.search(t).catch((()=>l)),c=o?Promise.resolve([]):this.searchTopSites(t).catch((()=>[])),h=this.props.getOffsetWidth?this.props.getOffsetWidth():0,p=Ky(t,this._directMatchBlocks,h,this.state.directMatchResults[0]),u=p?[p]:[],g=this.props.prefValues[$.kAddressBarOmniboxShowSyncTabs]&&this.props.syncedTabs?function(e,t,n){t=t.toLowerCase();const s=[];return e.reduce(((e,n)=>{const i=n.url??"",o=n.title??"",a=new URL(i).host.toLowerCase().indexOf(t),r=o.toLowerCase().indexOf(t);return s.some(((t,i)=>{const o=t.urlIdx,l=t.titleIdx;return(-1!==a&&-1!==o&&a<o||-1!==r&&-1!==l&&r<l)&&(s.splice(i,0,{...n,urlIdx:a,titleIdx:r}),e.splice(i,0,n),!0)}))||-1===a&&-1===r||(s.push({...n,urlIdx:a,titleIdx:r}),e.push(n)),e}),[]).slice(0,n)}(this.props.syncedTabs,t,H.Z.get($.kAddressBarOmniboxNumberOfSyncedTabs)):[];this.updateDropdown(),this.#T=!1;const[m,v,f,y,C]=await Promise.all([d,a,r,c,i]);if(!this.#h)return;const w=!(this.#N||(b=t,(0,gy.n9)(b)&&(0,vs.C3)(b)&&!b.endsWith("/")&&!(0,gy.Lk)(b)));var b;let S=this.getRawDropdown(this._getFormattedTypedHistoryItems(),this.getDropdownItems({nickname:m.nicknameResults,bookmark:m.bookmarkResults,history:v,typedHistory:f,topSites:y,directMatch:u,syncedTabs:g,suggest:C,bestResultData:{item:null,keyMatch:null,override:!1,categoryTitle:""}}),!0);const I=w?KC(t,S,Boolean(this.props.autocompleteOnTitle)):{item:null,keyMatch:null,override:!1,categoryTitle:""},k=this.#M.length,A=s+k-1;if(n&&1!==s&&1!==k&&s-1!==A/2>>0)return;const T={nicknameResults:m.nicknameResults,bookmarkResults:m.bookmarkResults,historyResults:v,typedHistoryResults:f,topSitesResults:y,directMatchResults:u,syncedTabsResults:g,suggestResults:C,bestResultData:I};s===A&&(T.isSearching=!1),I.item&&(this.props.prefValues[$.kAddressBarOmniboxShowBestResult]||I.override)&&(S=this.getRawDropdown(this._getFormattedTypedHistoryItems(),ew(I.item,this.getDropdownItems({nickname:m.nicknameResults,bookmark:m.bookmarkResults,history:v,typedHistory:f,topSites:y,directMatch:u,syncedTabs:g,suggest:C,bestResultData:I})),!0)),this.setUrlfieldState({selectedItem:S[0]}),this.setState(T)};performSearch=e=>{if(""===e.trim()||Cy(e)||!this.props.prefValues[$.kAddressBarAutocompleteEnabled]&&!this.props.prefValues[$.kAddressBarOmniboxEnabled])return;this.#I=!1;const t=crypto.randomUUID();this.#M.push(t),hs.startTransition((()=>{this._searchDropdownItems(this.props.pageId,e,t).then((()=>{this.#M=this.#M.filter((e=>e!==t))}))}))};revertUrl=e=>{if(!this.#h)return;this.setUrlfieldState({typedUrl:e,autocompleteValue:"",selectedItem:void 0});const{value:t,autocompletedItem:n,autocompletedIndex:s}=cw(this.props.pageId);this.setState({value:t,autocompletedItem:n,autocompletedIndex:s})};_openTypedHistoryOmniDropDown=()=>{this.props.typedHistoryEnabled&&!this.state.isDefaultTypedHistoryOpen&&(this.selectFirstDefaultTypedHistoryDropdownItem(),this.setState({isDefaultTypedHistoryOpen:!0,isOmniDropdownOpen:!1,autocompletedIndex:-1,navigationMode:!0}))};toggleTypedHistory=e=>{e.preventDefault(),this.setState((e=>{const t=!e.isDefaultTypedHistoryOpen;return t&&this.selectFirstDefaultTypedHistoryDropdownItem(),{isDefaultTypedHistoryOpen:t,isOmniDropdownOpen:!t,autocompletedIndex:-1,navigationMode:t}}))};selectFirstDefaultTypedHistoryDropdownItem=()=>{const e=this.props?.defaultTypedHistory;e?.length&&(this.setUrlfieldState({selectedItem:e[0]}),this._nav.setNumberOfSelectableItems(e.length))};_onEscPressed=()=>{if(this._urlInput.current?.isIMEOpen)return;this.hideDropdown();const{pageId:e,displayUrl:t}=this.props,{typedUrl:n}=yy.getUrlfieldState(e);"string"==typeof n&&n!==t?(this.revertUrl(),(0,cy.i6)(this.context,this.props.inputId)):(this.blur(),v.Z.executeActions("shortcut",this.context,"COMMAND_FOCUS_WEBVIEW"))};hideDropdown=e=>{this.setUrlfieldState({selectedItem:void 0}),this.setState({isOmniDropdownOpen:!1,isDefaultTypedHistoryOpen:!1,dropdownSelectionIndex:0,bookmarkResults:[],historyResults:[],typedHistoryResults:[],nicknameResults:[],suggestResults:[]},e)};getDropdown=()=>this._omniDropdownElement.current;onPaste=e=>{const{clipboardData:t}=e,n=t.getData(ow);n.trim()||e.preventDefault();const{value:s}=this.state,i=this.context.document.activeElement?.classList.toString()===e.currentTarget?.classList.toString()?e.currentTarget.selectionStart:0,o=e.currentTarget.selectionEnd,a=(0,AC.i)(s,n,i,o);if(H.Z.get($.kAddressBarStripJavascriptOnPaste)&&(0,zC.M)(a)){e.preventDefault();const t=(0,zC.Z)({textToStrip:n,caretPosition:i,selectionEnd:o,currentValue:s}),a=n.length-n.indexOf(":")-1;return this.setUrlfieldState({typedUrl:t}),void this.onValueChange(t,a)}this.#T=!0,this.setUrlfieldState({selectedItem:void 0}),this.setState({bestResultData:{item:null,keyMatch:null,override:!1,categoryTitle:""}})};onClipboardEvent=e=>{const{clipboardData:t,type:n,currentTarget:s}=e,{HTMLInputElement:i}=this.context;if(!(s instanceof i&&t))return;if(0!==s.selectionStart||s.selectionEnd!==s.value.length)return;let o=s.value;s.selectionEnd&&s.selectionEnd!==s.value.length&&(o=s.value.substring(0,s.selectionEnd));const a=this.props.displayUrl!==o;if(this.props.prefValues[$.kAddressBarOmniboxCutcopyEncoded]&&!a){const e=(0,gy.dO)(o).host??"";o=encodeURI(o).replace(/%25/g,"%");const t=encodeURI(e),n=o.indexOf(t);o=o.slice(0,n)+e+o.slice(n+t.length)}if(o.length>=h.RL&&o.endsWith("...")&&this.props.displayUrl.startsWith(o.substring(0,h.RL))&&(o=this.props.displayUrl),(0,vs.Zj)(o)&&/[\.\/]/.test(o)&&this.state.value===this.props.displayUrl){const e=(0,ms.Z)(this.props.displayUrl);if(e?.protocol){o=(vs.JQ.find((t=>t.startsWith(e.protocol)))||e.protocol)+o}}if(t.setData("text",o),"cut"===n){const e=s.value.slice(s.selectionEnd);this.setUrlfieldState({typedUrl:e}),s.setSelectionRange(0,0),this.setUrlfieldState({selectedItem:void 0})}e.preventDefault()};validateAutocomplete=({currentTarget:e})=>{const t=e.value===this.props.displayUrl?void 0:e.value;t!==this.props.typedUrl&&this.setUrlfieldState({typedUrl:t,autocompleteValue:""})};_shortcutListener=(e,t,n,s)=>{if(t&&s===oa.Z.KEY_ESCAPE)this._onEscPressed()};_setUpComponentEventListeners=()=>{C.Z.tabsPrivate.onKeyboardChanged.addListener(this._shortcutListener)};_tearDownComponentEventListeners=()=>{C.Z.tabsPrivate.onKeyboardChanged.removeListener(this._shortcutListener)};onFocus=e=>{this.props.pageContext.isUrlFieldFocused=!0,this.props.onFocus&&this.props.onFocus(e),this.props.showDropdown&&this._setUpComponentEventListeners()};onBlur=e=>{this.props.pageContext.isUrlFieldFocused=!1;const{document:t,getSelection:n,Element:s}=this.context,i=n();i&&i.focusNode instanceof s&&i.focusNode.classList.contains("UrlField")&&i.removeAllRanges(),this.props.onBlur&&this.props.onBlur(),this.props.showDropdown&&this._tearDownComponentEventListeners(),nw.nextTick((()=>{t.activeElement?.classList.contains("uifocusstop")||Ae.Z.setPaneFocus(this.context.vivaldiWindowId,!1)}))};enterNavigationMode=()=>{this.setState({autocompletedIndex:-1,navigationMode:!0})};_handleSelectedItemChanged=()=>{0===this.state.dropdownSelectionIndex&&!this.state.isDefaultTypedHistoryOpen&&this.state.navigationMode&&(this.setState({navigationMode:!1}),this.setUrlfieldState({typedUrl:this.props.typedUrl}))};onKeyDown=e=>{if(!this._urlInput.current?.isIMEOpen){if(this.state.isOmniDropdownOpen||this.state.isDefaultTypedHistoryOpen)switch(e.key){case"Escape":e.preventDefault(),e.stopPropagation();break;case"ArrowUp":e.preventDefault(),e.stopPropagation(),(0,co.S2)(e)?this._nav.sectionUp().then(this._handleSelectedItemChanged):this._nav.up().then(this._handleSelectedItemChanged),this.enterNavigationMode();break;case"Tab":(0,co.VV)(e)?(e.preventDefault(),e.stopPropagation(),this._nav.down().then(this._handleSelectedItemChanged)):(0,co.Mr)(e)&&(e.preventDefault(),e.stopPropagation(),this._nav.up().then(this._handleSelectedItemChanged)),this.enterNavigationMode();break;case"ArrowDown":e.preventDefault(),e.stopPropagation(),(0,co.S2)(e)?this._nav.sectionDown().then(this._handleSelectedItemChanged):this._nav.down().then(this._handleSelectedItemChanged),this.enterNavigationMode();break;case"PageUp":this._nav.pageUp().then(this._handleSelectedItemChanged),this.enterNavigationMode();break;case"PageDown":this._nav.pageDown().then(this._handleSelectedItemChanged),this.enterNavigationMode();break;case"Delete":const{selectedItem:t}=yy.getUrlfieldState(this.props.pageId);(0,co.Mr)(e)&&t&&(e.preventDefault(),this.onOmniDropdownItemDelete(t))}switch(e.key){case"ArrowRight":case"ArrowLeft":case"End":case"Home":this.validateAutocomplete(e);break;case"z":!e.shiftKey&&e.ctrlKey&&this._handleUndo(e);break;case"ArrowDown":(0,qi.Z)(e)||this.state.isOmniDropdownOpen||this._openTypedHistoryOmniDropDown();break;case"ArrowUp":0===e.currentTarget.selectionStart&&(e.preventDefault(),this._openTypedHistoryOmniDropDown());break;case"Backspace":case"Delete":const t=(0,co.Np)(e)||iw;((0,co.VV)(e)||t)&&this.state.value.length>0&&(this.#_=!0)}}};_urlFieldGo=async(e,t)=>{this.props.onSubmit&&(this.cleanupUrl(e),await(this.props.onSubmit?.({url:e,...t?{options:t}:null})),this.#I=!0)};onKeyPress=e=>{this.props.onKeyPress&&this.props.onKeyPress(e)};onDragStart=e=>{if(Jo(e))return;const{getSelection:t}=this.context;this.#A=!0;const n=t();n&&e.currentTarget.value===n.toString()&&HC()(e.currentTarget.value)&&this.props.onUrlDrag?.(e)};onDragEnd=()=>{this.#A=!1};onDragEnter=e=>{if(e.stopPropagation(),!this.#A&&this.isDropAllowed(e)){e.preventDefault();const t=e.currentTarget,{HTMLInputElement:n}=this.context;t instanceof n&&t.classList.add("pseudo-selected")}};onDragOver=e=>{this.isDropAllowed(e)&&e.preventDefault()};onDragLeave=e=>{if(this.#A)return;const t=e.target,{HTMLInputElement:n}=this.context;t instanceof n&&t.classList.remove("pseudo-selected")};onDrop=e=>{if(!this.isDropAllowed(e))return;const t=e.target,{HTMLInputElement:n}=this.context;if(t instanceof n&&t.classList.remove("pseudo-selected"),"function"==typeof this.props.onDrop)this.#A||(this.props.onDrop(e),e.stopPropagation(),e.preventDefault());else if(this.props.handleDrop){e.stopPropagation(),e.preventDefault();let t="";const n=e.dataTransfer?Ds.ZP.extractUriListFromEvent(e):"";if(n.length>0){const e=n.split("\n");e.length>0&&(t=e[0])}else t=e.dataTransfer?e.dataTransfer.getData(ow):"";this.setUrlfieldState({typedUrl:t}),(0,cy.x0)(this.context,this.props.inputId)}};isDropAllowed=e=>{if(!e?.dataTransfer||e.dataTransfer.types.includes("vivaldi/x-button-toolbar"))return!1;return e.dataTransfer.types.some((e=>e===Ds.yR||e===ow||Ds.ZP.isUriListType(e)))};setDropdownSelectionIndex=e=>{this.setState({dropdownSelectionIndex:e})};setAutocompleteHighlight=this.setDropdownSelectionIndex;onOmniDropdownItemClicked=(e,t)=>{this.revertUrl(),this.blur();const n=this.context.vivaldiWindowId;e.url&&("OMNI_TYPE_SEARCH"!==e.type||(0,vs.C3)(e.url)?xy(e)?$y(e,n,{...t,incognito:t.incognito||G.ZP.isGuest()}):Fy.Z.go(n,[e.url],{...t,enableSearch:!0}):Fy.Z.goSearchUrl(n,e.url,{...t,incognito:t.incognito||G.ZP.isGuest()})),this.hideDropdown()};_deleteHistoryItem=e=>{const t=(0,vs.K2)(e.url)?e.url:e.id;s.Z.history.deleteUrl({url:t});const{historyResults:n,dropdownSelectionIndex:i,typedHistoryResults:o,bestResultData:a}=this.state,r=n.filter((t=>t.url!==e.url)),l=o.filter((t=>t.url!==e.url)),d=this.getRawDropdown(this._getFormattedTypedHistoryItems(),ew(a.item,this.getDropdownItems({history:r,typedHistory:l}))),c=e.id===a.item?.id&&0===i;c&&d.splice(0,1);const h=i>=d.length?d.length-1:i,p=-1!==h?d[h]:void 0;this.setUrlfieldState({selectedItem:p}),this.setState({historyResults:r,typedHistoryResults:l,dropdownSelectionIndex:h,bestResultData:c?{item:null,keyMatch:null,override:!1,categoryTitle:""}:a})};onOmniDropdownItemDelete=e=>{if("OMNI_TYPE_SEARCH"===e.type)return;const t=e;this._deleteHistoryItem(t)};isUrlInputFocusedOnMouseDown=()=>{if(!this._urlInput.current)return!1;const e=this._urlInput.current?.refUrlInput.current?.inputField.current;return e===this._focusedOnMouseDown};componentDidUpdate(e,t){if(t.dropdownSelectionIndex!==this.state.dropdownSelectionIndex&&this._nav.setSelectionIndex(this.state.dropdownSelectionIndex),e.typedSearchEngine!==this.props.typedSearchEngine){const{bestResultData:e}=this.state;this.setState({bestResultData:this.props.typedSearchEngine?{item:null,keyMatch:null,override:!1,categoryTitle:""}:e})}if(this.state.isDefaultTypedHistoryOpen&&!t.isDefaultTypedHistoryOpen&&(0,cy.x0)(this.context,this.props.inputId),this.props.pageId!==e.pageId&&this._cleanupState(),this.props.displayUrl&&this.props.displayUrl!==e.displayUrl&&void 0===this.props.typedUrl){const e=this._urlInput?.current?.refUrlInput?.current,t=e?.inputField?.current;e&&t&&e.setSelection({selectionStart:0,selectionEnd:t.value.length},"forward")}}getSearchEngine=()=>{const e=this.props.typedSearchEngine||this.props.defaultSearchEngine;if(!e)return;const t=this.props.typedUrl||"",n=(0,Oe.Z)("Search $1",[e.name]),s=(0,Oe.Z)("Go To");return{title:(0,vs.C3)(t)?s:n,type:"SEARCH",items:[{id:e.id,type:"OMNI_TYPE_SEARCH",text:t,url:t,isDeleteDisabled:!0,faviconUrl:Ts.YvR.medium,faviconType:"img"}]}};getDirectTypedUrlItem=()=>{if(!this.props.prefValues[$.kAddressBarOmniboxShowSearchOrGoTo]||this.props.prefValues[$.kAddressBarInlineSearchEnabled])return;const e=this.props.typedUrl||"";return{title:(0,Oe.Z)("Go to"),type:"SEARCH",items:[{id:e,type:"OMNI_DIRECT_TYPED_URL",text:e,url:e,isDeleteDisabled:!0,faviconUrl:Ts.YvR.medium,faviconType:"img"}]}};_getFormattedTypedHistoryItems=()=>[{type:"TYPED_HISTORY",title:(0,Oe.Z)("Typed History"),items:this.state.isDefaultTypedHistoryOpen?this.props?.defaultTypedHistory??[]:[]}];onTypedHistoryItemDelete=e=>{s.Z.history.deleteUrl({url:e.url})};setSelectedItem=e=>{this.setUrlfieldState({selectedItem:e})};renderDropdown=({typedHistoryItems:e,omniDropdownItems:t})=>{if(this.state.isDefaultTypedHistoryOpen)return(0,fs.jsx)(pC,{ref:this._omniDropdownElement,onNumberOfSelectableItemsChanged:this._nav.setNumberOfSelectableItems,onLinkItemClicked:this.onOmniDropdownItemClicked,items:e,selectionIndex:this.state.dropdownSelectionIndex,onDeleteItem:this.onTypedHistoryItemDelete,onMenuClosed:this.hideDropdown,outsideClickIgnoreClass:"drop-down-menu"});if(!this.props.prefValues[$.kAddressBarOmniboxEnabled]||!this.state.isOmniDropdownOpen)return null;const{bestResultData:n}=this.state;return(0,fs.jsx)(pC,{ref:this._omniDropdownElement,onNumberOfSelectableItemsChanged:this._nav.setNumberOfSelectableItems,onLinkItemClicked:this.onOmniDropdownItemClicked,items:t,selectionIndex:this.state.dropdownSelectionIndex,typedSearchEngine:this.props.typedSearchEngine,defaultSearchEngine:this.props.defaultSearchEngine,onDeleteItem:this.onOmniDropdownItemDelete,pattern:this.props.typedUrl,onMenuClosed:this.hideDropdown,outsideClickIgnoreClass:"drop-down-menu",bestResult:n.item})};runNickname=(e,t,n,s)=>{const{transition:i,fromUrlField:o,...a}=n;a.allowOverride=!1,Ds.ZP.open(s,ps.ZP.getNicknamed(e,!0),a,!0),this.cleanupUrl(t),this.#I=!0};handleSubmit=async({autocompletedValue:e,typedValue:t},n)=>{const s=this.context.vivaldiWindowId,i=e,o=n.shiftKey&&"shift"===this.props.prefValues[$.kAddressBarUrlOpenShortcut]||n.altKey&&"alt"===this.props.prefValues[$.kAddressBarUrlOpenShortcut]||iw,a=o&&n.ctrlKey,r={...(0,nl.Z)(s,{ctrlKey:n.ctrlKey,altKey:n.altKey,shiftKey:n.shiftKey,metaKey:n.metaKey}),inCurrent:!o,inBackground:a,transition:C.Z.historyPrivate.TransitionType.TYPED,fromUrlField:!0,incognito:G.ZP.isIncognitoOrGuest(s)};if(this.state.isSearching||this.#E){if(ps.ZP.hasNickname(t))return void this.runNickname(t,t,r,s)}if(n.ctrlKey&&this.props.prefValues[$.kAddressBarAutocompleteSuffixExpansionEnabled]&&this.props.prefValues[$.kAddressBarAutocompleteSuffixExpansionValue]){const n=(0,vs.K2)(e);return void await this._urlFieldGo((0,vs.Ei)(n?t:e,this.props.prefValues[$.kAddressBarAutocompleteSuffixExpansionValue]),r)}const{selectedItem:l}=yy.getUrlfieldState(this.props.pageId);if(l){const e=My(l),n=_y(l)||e?l.nickname:"";if(ps.ZP.hasNickname(n))return e&&(r.inCurrent=!o&&!H.Z.get($.kBookmarksOpenInNewTab)),void this.runNickname(n,t,r,s);const i="OMNI_TYPE_SEARCH"===l.type;return i&&!(0,vs.C3)(l.url)?(this.cleanupUrl(l.url),void Fy.Z.goSearchUrl(s,l.url,{inBackground:r.inBackground,inCurrent:r.inCurrent,inNewWindow:r.inNewWindow,incognito:r.incognito||G.ZP.isGuest(),allowOverride:r.allowOverride,transition:r.transition,fromUrlField:!0})):(Dy(l)||i||(r.transition=C.Z.historyPrivate.TransitionType.GENERATED),xy(l)?($y(l,s,r),this.cleanupUrl(t),void(this.#I=!0)):void await this._urlFieldGo(l.url,r))}i===this.props.displayUrl&&(r.transition=C.Z.historyPrivate.TransitionType.RELOAD),await this._urlFieldGo(i,r)};cleanupUrl=e=>{this.revertUrl(e),this.blur(),this.hideDropdown()};onMouseUp=e=>{const{getSelection:t}=this.context,{button:n,currentTarget:s}=e};getRawDropdown=(e,t,n=!1)=>!this.state.isSearching&&!this.#E||n?this.state.isDefaultTypedHistoryOpen?e.flatMap((e=>e.items)):t.flatMap((e=>e.items??[])):[];render(){const{value:e,navigationMode:t,bestResultData:n}=this.state,{typedUrl:s}=this.props,i={typedHistoryItems:this._getFormattedTypedHistoryItems(),omniDropdownItems:s&&s.length>0?ew(n.item,this.getDropdownItems()):[]},o=this.getRawDropdown(i.typedHistoryItems,i.omniDropdownItems),a=o[0]?.url===n.item?.url?n.keyMatch:null,r=this.props.prefValues[$.kAddressBarShowFullUrl],l=this.props.prefValues[$.kAddressBarHighlightBaseDomain],d=this.props.urlFragments?(0,gy.gG)(this.props.urlFragments):void 0;return(0,fs.jsxs)(fs.Fragment,{children:[sw("div",{className:As()("UrlField",{"UrlField--HasEditText":Boolean(s),"UrlField--IsEmpty":""===this.state.value})},void 0,(0,fs.jsx)(tC,{ref:this._urlInput,autoFocus:this.props.autoFocus,className:this.props.className||"",displayUrl:this.props.displayUrl,onSubmit:this.handleSubmit,autocompleteData:o,value:e,onValueChange:this.onValueChange,onAutocompleteValueChange:this.onAutocompleteValueChange,disabled:this.props.disabled?this.props.disabled:void 0,placeholder:this.props.placeholder?this.props.placeholder:void 0,title:this.props.title?this.props.title:void 0,pageId:this.props.pageId,pageContext:this.props.pageContext,readOnly:this.props.readonly,autocompletionEnabled:this.props.autocompletionEnabled,isOmniDropdownOpen:this.state.isOmniDropdownOpen,inputId:this.props.inputId,navigationMode:t,autocompleteKeyMatch:a,onBlur:this.onBlur,onFocus:this.onFocus,onSelect:this.onSelected,onClick:this.onClick,onContextMenu:this.onClick,onDragStart:this.onDragStart,onDragEnter:this.onDragEnter,onDragOver:this.onDragOver,onDragLeave:this.onDragLeave,onDragEnd:this.onDragEnd,onDrop:this.onDrop,onKeyPress:this.onKeyPress,onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onKeyDown:this.onKeyDown,onCut:this.onClipboardEvent,onCopy:this.onClipboardEvent,onPaste:this.onPaste}),d&&sw(WC,{windowId:this.context.vivaldiWindowId,urlFragments:d,displayUrl:this.props.displayUrl,shouldShowFullUrl:r,onGoToPath:this._urlFieldGo,onBaseDomainObscured:this.props.onBaseDomainObscured,shouldHighlightBaseDomain:l,rawDisplay:!1})),this.renderDropdown(i)]})}}const pw=sa(hw,aw);var uw;function gw(e,t,n,s){uw||(uw="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:uw,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const mw=dy.t;function vw(e){return{url:e.url,title:e.title}}class fw extends hs.PureComponent{static contextType=xi.Z;dropMode={support:!1,copy:!1};nodeRef=hs.createRef();_id=crypto.randomUUID();_pageContext={};state={drawerOpen:!1,suggestions:[],url:"",editUrl:void 0};componentDidMount(){yy.addListener(this._onUrlFieldStoreChanged,(e=>e.get(this._id)))}getNode(){return this.nodeRef.current}async updateSuggestedSites(){if(G.ZP.isIncognitoOrGuest(this.context.vivaldiWindowId))return;const e=(await s.Z.topSites.get()).map(vw).filter((e=>!Fl.Z.hasPanelUrl(e.url))),t=mw.map(vw).filter((e=>!Fl.Z.hasPanelUrl(e.url))),n=await C.Z.extensionActionUtils.getToolbarExtensions(),i=[];n.forEach((e=>{if(!e.enabled)return;const t=Fl.Z.getExtPanelId(e);t&&e.sidePanel&&!Fl.Z.hasPanelId(t)&&i.push({title:e.name,faviconURL:e.badgeIcon,url:e.sidePanel.url,extensionId:t,extension:e})}));const o=i.concat(e.concat(t));o.splice(12),this.setState({suggestions:o})}componentWillUnmount(){yy.removeListener(this._onUrlFieldStoreChanged),py.Z.reset(this._id)}_onUrlFieldStoreChanged=()=>{const{typedUrl:e}=yy.getUrlfieldState(this._id);this.setState({editUrl:e})};onDragEnter=e=>{this.dropMode=this.supportDropForEvent(e)};onDragOver=e=>{e.preventDefault(),e.stopPropagation(),this.dropMode.support?e.dataTransfer.dropEffect=this.dropMode.copy?"copy":"move":e.dataTransfer.dropEffect="none"};onDrop=e=>{e.preventDefault(),e.stopPropagation(),this.dropMode.support&&Ds.ZP.getUrlsFromEventPromise(e,!0).then((e=>{e.forEach((e=>{Fl.Z.addByUrl(this.context.vivaldiWindowId,e.url,!0)}))}))};supportDropForEvent=e=>{const t=e.dataTransfer.types.some((e=>Ds.ZP.isUriListType(e)||"text/plain"===e));return{support:t,copy:t&&!e.dataTransfer.types.some((e=>e===h.Up))}};handleClickOutside=()=>{this.state.drawerOpen&&this.closeDrawer()};handleKeyDown=(e,t,n)=>{if("start"===e);else if("suggestion"===e){switch(n.key){case"ArrowLeft":this.moveFocus(t,"left",!1);break;case"ArrowRight":this.moveFocus(t,"right",!1);break;case"ArrowUp":this.moveFocus(t,"up",!1);break;case"ArrowDown":this.moveFocus(t,"down",!1);break;default:return}n.preventDefault(),n.stopPropagation()}};moveFocus=(e,t,n)=>{const{document:s,HTMLElement:i}=this.context,o=this.nodeRef.current;if(o instanceof i&&(!0===n||sl(s,o))){const n=Array.from(o.querySelectorAll("button.webpanel-suggestion")),s=n.map((e=>e.getAttribute("data-id"))).filter(Boolean);if(0===s.length||s.length!==n.length)return!1;let i,a=0,r=-1;switch(n.forEach((e=>{const t=e.getBoundingClientRect();r<t.left&&(a++,r=t.left)})),t){case"current":if(""===e||"first"===e?e=s[0]:"last"===e&&(e=s[0===this.props.keyAccess?s.length-1:0]),i=s.indexOf(e),-1===i)return!1;break;case"right":case"left":if(1===s.length)return!1;if(i=s.indexOf(e),-1===i)return!1;if("right"===t){if((i+1)%a==0)return!1;if(i+=1,i>=s.length)return!1}else{if(i%a==0)return!1;if(i-=1,i>=s.length)return!1}break;case"up":case"down":if(1===s.length)return!1;if(i=s.indexOf(e),-1===i)return!1;if("up"===t){if(i-=a,i<0)return!1;e=s[i]}else if(i+=a,i>=s.length)return!1;break;default:return!1}e=s[i];const l=o.querySelector(`button.webpanel-suggestion[data-id="${e}"]`);if(l)return l.focus(),!0}return!1};onHideCallout=()=>{this.state.drawerOpen&&this.onToggleCallout()};onToggleCallout=()=>{this.state.drawerOpen?this.closeDrawer():this.updateSuggestedSites().then((()=>{const e=ie.ZP.getActivePage(this.context.vivaldiWindowId)?.url??"",t={drawerOpen:!0,url:je.jk.getDisplayUrlFromMapping(e)};py.Z.updateState(this._id,{typedUrl:e,autocompleteValue:""}),this.setState(t),Di.Z.bind("esc",this.closeDrawer)}))};onAddWebpanel=()=>{const{autocompleteValue:e}=yy.getUrlfieldState(this._id);let t=(e||this.state.editUrl||this.state.url||"").trim();0!==t.length&&(t=(0,vs.q9)(t),Fl.Z.addByUrl(this.context.vivaldiWindowId,t,!0),this.closeDrawer())};onClickSuggested=e=>{let t,n="",s="";if(e.extension){const i=e.extension.sidePanel;if(!i)return;t=Fl.Z.getExtPanelId(e.extension),n=i.url,s=i.activeUrl}else{if(0===e.url.length)return;n=(0,vs.q9)(e.url),s=n}const i={url:n??"",activeUrl:s??"",id:t};Fl.Z.addBySpec(this.context.vivaldiWindowId,i),this.closeDrawer()};closeDrawer=()=>{Di.Z.unbind("esc",this.closeDrawer),this.setState({drawerOpen:!1,url:"",editUrl:void 0})};preventContextMenu=e=>{e.stopPropagation()};render(){return gw(Fa,{id:"downloads",tooltip:(0,Oe.Z)("Add Web Panel"),image:Ts.ebB[this.props.size],alwaysMenu:!0,onClick:this.onToggleCallout,menu:this.props.menu,customizeMenu:this.props.customizeMenu,menuOrigin:this.props.menuOrigin,hidePopup:this.onHideCallout,popupClassName:"addwebpanel-wrapper",popupPosition:this.props.popupPosition,popupWidth:246,isPopupVisible:this.state.drawerOpen,draggable:this.props.draggable,onDragStart:this.props.onDragStart??Aa.Z,onDragEnd:this.props.onDragEnd??Aa.Z,onDrop:this.props.onDrop??Aa.Z,onDragEnter:this.props.onDragEnter??Aa.Z,onDragLeave:this.props.onDragLeave??Aa.Z,onDragOver:this.props.onDragOver??Aa.Z,mimeType:this.props.mimeType,name:this.props.name,size:this.props.size},void 0,(0,fs.jsx)("div",{ref:this.nodeRef,className:"addwebpanelcallout",onContextMenu:this.preventContextMenu,children:gw("form",{},void 0,gw("header",{},void 0,gw("h1",{},void 0,(0,Oe.Z)("Add Web Panel"))),gw("div",{className:"webpanel-input"},void 0,gw(pw,{className:"address",title:(0,Oe.Z)("Enter webpage address"),placeholder:"vivaldi.net",displayUrl:this.state.url,typedUrl:this.state.editUrl,autocompletionEnabled:!0,typedHistoryEnabled:!1,showDropdown:!1,pageId:this._id,pageContext:this._pageContext,inputId:this._id,autoFocus:!0}),gw("button",{className:"add",tabIndex:0,onClick:this.onAddWebpanel,dangerouslySetInnerHTML:{__html:Ts.md4.small},tooltip:(0,Oe.Z)("Add Web Panel")})),this.state.suggestions&&this.state.suggestions.length>0&&gw("div",{className:"webpanel-suggestions"},void 0,gw("div",{className:"suggestions-list"},"list",this.state.suggestions.map(((e,t)=>{const n="chrome://favicon/size/16@2x/"+e.url,s=t.toString();return gw("button",{className:"webpanel-suggestion",tabIndex:0===t?0:this.props.keyAccess,"data-id":s,title:e.title+"\n"+e.url,onKeyDown:this.handleKeyDown.bind(this,"suggestion",s),onClick:()=>this.onClickSuggested(e)},t,gw("img",{src:n,alt:""}))})))))}))}}const yw=ta(fw);var Cw=n(20676);const ww={getWebPanelBarMenu:function(){const e=H.Z.get($.kPanelsWebToolbar);return[{handler:()=>Fl.Z.setUIContent({showToolbar:!0}),isVisible:()=>!(!0===e.showToolbar),...(0,xs.Z)("command","Show")},{handler:()=>Fl.Z.setUIContent({showToolbar:!1}),isVisible:()=>!0===e.showToolbar,...(0,xs.Z)("other","Hide")},{handler:()=>Fl.Z.setUIContent({allControls:!e.allControls,showToolbar:e.showToolbar||!e.allControls}),type:"checkbox",checked:e.allControls,isVisible:()=>!0===e.showToolbar,...(0,xs.Z)("Display Navigation Controls")},{handler:()=>Fl.Z.setUIContent({zoomControls:!e.zoomControls,showToolbar:e.showToolbar||!e.allControls}),type:"checkbox",checked:e.zoomControls,isVisible:()=>!0===e.showToolbar,...(0,xs.Z)("Display Zoom Controls")}]},getPromise:function(e,t,n){const s="panelbaritem",i=Pi.getOptionFunction(s),o=Vp.Z.isWebPanel(t),a=o||Vp.Z.isRegPanel(t),r=e=>{if(o)return Fl.Z.getUrlById(e);switch(e){case"PanelBookmarks":return"vivaldi://bookmarks";case"PanelHistory":return"vivaldi://history";case"PanelDownloads":case"PanelWindow":case"PanelReadingList":case"PanelTranslate":case"PanelMail":case"PanelFeeds":case"PanelContacts":default:return"";case"PanelNotes":return"vivaldi://notes";case"PanelTasks":case"PanelCalendar":return"vivaldi://calendar"}},l=(t,n,s)=>{const i=r(t);i&&d.ZP.openURL(e,i,{inCurrent:n,inBackground:s})};return Pi.getNamedMenu(e,s,(async s=>{switch(s.action){case"CONTEXT_MENU_OPEN":return{isVisible:()=>r(t).length>0,...i(e,s,{})};case"CONTEXT_OPEN_IN_TAB":case"CONTEXT_OPEN_IN_NEW_TAB":return{handler:()=>l(t,"CONTEXT_OPEN_IN_TAB"===s.action,!1),isVisible:()=>r(t).length>0,...i(e,s,{})};case"CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB":return{handler:()=>l(t,!1,!0),isVisible:()=>r(t).length>0&&!H.Z.get($.kTabsOpenNewInBackground),...i(e,s,{})};case"CONTEXT_OPEN_IN_NEW_WINDOW":case"CONTEXT_OPEN_IN_PRIVATE_WINDOW":{const n=G.ZP.isGuest(),o="CONTEXT_OPEN_IN_NEW_WINDOW"===s.action;return{handler:()=>((t,n)=>{const s=r(t);s&&d.ZP.openURL(e,s,{inNewWindow:!0,incognito:n})})(t,!o),isVisible:()=>r(t).length>0&&!(o&&n),...i(e,s,{})}}case"CONTAINER_PERIODIC_RELOAD":case"CONTEXT_CONTAINER_PERIODIC_TIMER":return{...i(e,s,{}),items:Cw.Z.getMenu(t,"panel",e),isVisible:()=>o};case"CONTEXT_COPY_ADDRESS":return{handler:()=>{const e=r(t);e&&yi.Z.copyUrlToClipboard(e)},isVisible:()=>r(t).length>0,...i(e,s,{})};case"CONTEXT_DESKTOP_VERSION":return{handler:()=>Fl.Z.setMobileMode(t,!1),isVisible:()=>o&&Boolean(n?.mobileMode),...i(e,s,{})};case"CONTEXT_MOBILE_VERSION":return{handler:()=>Fl.Z.setMobileMode(t,!0),isVisible:()=>o&&!n?.mobileMode,...i(e,s,{})};case"CONTEXT_MUTE_PANEL":return{handler:e=>{Pn.Z.setMuted(e.windowId,t,!ud.ZP.getIsMuted(e.windowId,t))},isVisible:()=>o&&ud.ZP.getSelected(e)===t,checked:Boolean(n?.muted),type:"checkbox",...i(e,s,{})};case"CONTEXT_SEPARATE_WIDTH":return{handler:()=>Pn.Z.setPanelResizable(t,!ud.ZP.getResizableByPanel(t)),checked:ud.ZP.getResizableByPanel(t),isVisible:()=>a,...i(e,s,{})};case"CONTEXT_CONTAINER_FLOATING":{const n=H.Z.get($.kPanelsAsOverlayEnabled);return{items:[{handler:()=>{const n=ud.ZP.getSeparateFloating(t,e),s=H.Z.get($.kPanelsAsOverlayEnabled);void 0===n&&s?Pn.Z.setSeparateFloating(t,!1):Pn.Z.setSeparateFloating(t,!n)},type:"checkbox",checked:Boolean(ud.ZP.getSeparateFloating(t,e)),...(0,xs.Z)("This Panel")},{handler:()=>Ne.Z.toggle($.kPanelsAsOverlayEnabled,!0,!1),type:"checkbox",checked:Boolean(n),...(0,xs.Z)("All Panels")},ae.Z.separatorItem,{handler:()=>Pn.Z.setSeparateFloating(t,void 0),...(0,xs.Z)("Reset Panel Floating")}],isVisible:()=>a,...i(e,s,{})}}case"CONTEXT_CONTAINER_TOOLBAR":return{items:this.getWebPanelBarMenu(),isVisible:()=>o,...i(e,s,{})};case"CONTAINER_CLOSED_WEBPANEL":{const t={...i(e,s,{})};return 0===t.items?.length&&(t.isVisible=()=>!1),t}default:return{...i(e,s,{})}}}))}},bw=ww;var Sw=n(80342);const Iw=["mail.google.com"];function kw(e,t,n=999){if(!e||!t)return"";const s=Iw.some((e=>t.includes(e)))?e.match(/[\(\[\{](\d+)[\}\]\)]/):e.match(/^\((\d+)\D*?\)/);if(!s?.[1])return"";const i=parseInt(s[1]);return i<=0?"":i>n?"+":s[1]}const Aw=[$.kMailCountersPanelSwitcherEnabled,$.kMailCountersPanelUnseenEnabled,$.kMailIsTurnedOff,$.kPanelsAsOverlayEnabled,$.kPanelsWebToolbar,$.kPanelsWindowShowUnread,$.kReadingListShowCounter,$.kTabsCounterDetection,$.kToolbarsPanel];class Tw extends hs.PureComponent{static contextType=xi.Z;_isWebPanel=!1;_isMounted=!1;_isDraggingOverButton=!1;constructor(e,t){super(e),this._isWebPanel=Vp.Z.isWebPanel(e.name);const n=this._isWebPanel?this._getWebPanelContent(t.vivaldiWindowId,e.name):void 0;let s=0;if(this._isWebPanel&&!e.inEditor){const t=oe.Z.getAlarmFromReloadId(e.name);t&&(s=60*t.periodInMinutes)}const i=ie.ZP.unsafeGetActivePage(t.vivaldiWindowId);this.state={activePageId:i.id,isInternalPage:je.jk.isInternalPage(i),openPanel:ud.ZP.getIsContentVisible(t.vivaldiWindowId)?ud.ZP.getSelected(t.vivaldiWindowId):null,counter:0,mailCounterState:{unseen:0,unread:0},progress:s,webPanelContent:n}}componentDidMount(){if(!this.props.inEditor){switch(ud.ZP.addListener(this._onPanelStoreChange,(e=>e.windowData.get(this.context.vivaldiWindowId))),this._isWebPanel&&oe.Z.addListener(this._onPeriodicReloadStoreChanged),this.props.name){case"PanelDownloads":this._onDownloadStoreChange(),Wm.Z.addListener(this._onDownloadStoreChange);break;case"PanelWindow":this._onPageStoreChange(),ie.ZP.addListener(this._onPageStoreChange,this.context.selectWindow);break;case"PanelReadingList":this._onReadingStoreChange(),Sw.Z.addListener(this._onReadingStoreChange);break;case"PanelMail":case"PanelFeeds":this._onMailCounterChange(),tf.Z.addListener(this._onMailCounterChange)}this._isMounted=!0,this._onPanelStoreChange()}}componentWillUnmount(){this.props.inEditor||(ud.ZP.removeListener(this._onPanelStoreChange),Wm.Z.ensureRemovedListener(this._onDownloadStoreChange),ie.ZP.ensureRemovedListener(this._onPageStoreChange),Sw.Z.ensureRemovedListener(this._onReadingStoreChange),tf.Z.ensureRemovedListener(this._onMailCounterChange),this._isWebPanel&&oe.Z.removeListener(this._onPeriodicReloadStoreChanged),this._isMounted=!1)}_onPanelStoreChange=()=>{if(this._isWebPanel){const e=this._getWebPanelContent(this.context.vivaldiWindowId,this.props.name);this.setState({webPanelContent:e})}this.setState({openPanel:ud.ZP.getIsContentVisible(this.context.vivaldiWindowId)?ud.ZP.getSelected(this.context.vivaldiWindowId):null})};_getWebPanelContent=(e,t)=>{let n;if(!ud.ZP.canRender({winId:e,panelId:this.props.name}))return null;const s=ud.ZP.getWebPanel(e,this.props.name);if(s){const t=ud.ZP.getMutedMap(e)?.get(this.props.name);n={title:s.title,url:s.url,activeUrl:s.activeUrl,muted:t,faviconUrl:s.faviconUrl,mobileMode:s.mobileMode}}if(!n){let e=H.Z.get($.kPanelsWebElements).find((e=>e.id===this.props.name));e||(e=H.Z.getDefault($.kPanelsWebElements).find((e=>e.id===this.props.name))),e&&(n={title:"",url:e.url,activeUrl:e.activeUrl,faviconUrl:e.faviconUrl,mobileMode:e.mobileMode}),this.props.inEditor||e||console.warn("Missing web panel, no fallback:",this.props.name)}return n};_onPeriodicReloadStoreChanged=e=>{if(e)for(let t=0;t<e.length;t++){const n=e[t];if("panel"===n?.from&&this.props.name===n.id)return void this.setState({progress:n?.remainingTime})}oe.Z.getAlarmFromReloadId(this.props.name)||this.setState({progress:0})};_onDownloadStoreChange=()=>{this.setState({counter:Wm.Z.getTotalNumberOfDownloads(),progress:Wm.Z.getTotalProgress()})};_onReadingStoreChange=()=>{this.setState({counter:Sw.Z.getUnreadCount()})};_onPageStoreChange=()=>{this.setState({counter:ie.ZP.getUnreadCount(this.context.vivaldiWindowId)})};_onMailCounterChange=()=>{const e="PanelMail"===this.props.name,t=tf.Z.getCounters(e?xe.of:xe.u4,e?xe.tB:xe.ym);this.setState({mailCounterState:{unseen:t?.unseen??0,unread:t?.unread??0}})};getTitle=()=>{if(this._isWebPanel){const e=this.state.webPanelContent;return e?e.title?`${e.title}\n${e.url}`:e.url:""}return"PanelDownloads"===this.props.name&&this.state.progress>0?(0,Oe.Z)("Downloads")+" "+(0,Oe.Z)("($1 active transfer)","($1 active transfers)",[this.state.counter]):(0,bd.wY)(this.props.name)};handleUp=(e,t)=>{t.preventDefault(),t.buttons&&(0!==t.buttons||Jo(t)&&G.ZP.isActive(this.context.vivaldiWindowId))||this.handleClick(e,t)};setSelected=e=>{Pn.Z.toggleContent(this.context.vivaldiWindowId,e)};toggleMuted=e=>{Pn.Z.setMuted(this.context.vivaldiWindowId,e,!ud.ZP.getIsMuted(this.context.vivaldiWindowId,e))};handleClick=(e,t)=>{const n=this.context.vivaldiWindowId,{altKey:s,ctrlKey:i,shiftKey:o,metaKey:a}=t,r={altKey:s,ctrlKey:i,shiftKey:o,metaKey:a};if(t.button===Hi.Z.kCenter||t.button===Hi.Z.kLeft&&(0,co.S2)(r))switch(e){case"PanelBookmarks":Ae.Z.showBookmarks(n);break;case"PanelHistory":Ae.Z.showHistory(n);break;case"PanelNotes":Ae.Z.showNotes(n);break;case"PanelTasks":case"PanelCalendar":Ae.Z.showCalendar(n);break;case"PanelMail":Ae.Z.showMail(n);break;default:this._isWebPanel&&Fl.Z.openInTab(n,e,!1,!0)}else Jo(t)&&G.ZP.isActive(this.context.vivaldiWindowId)||this.setSelected(e);Ae.Z.setPaneFocus(n,!1)};debounceOpeningPanel=(0,no.Z)((()=>{if(!this._isDraggingOverButton)return!1;this.setSelected(this.props.name)}),1500);_onPanelButtonDragEnter=(e,t)=>{(0,to.ZP)(e),this._isDraggingOverButton=!0,this.debounceOpeningPanel()};_onPanelButtonDragLeave=()=>{this._isDraggingOverButton=!1};getPanelImageAndCounter=()=>{let e="",t=!1;switch(this.props.name){case"PanelBookmarks":e=Ts.CLf[this.props.size];break;case"PanelHistory":e=Ts.hcy[this.props.size];break;case"PanelDownloads":e=Ts.izi[this.props.size];break;case"PanelNotes":e=Ts.cyI[this.props.size];break;case"PanelWindow":e=Ts.NxY[this.props.size],t=this.props.prefValues[$.kPanelsWindowShowUnread];break;case"PanelReadingList":e=Ts.R_e[this.props.size],t=this.props.prefValues[$.kReadingListShowCounter];break;case"PanelTranslate":e=Ts.U_X[this.props.size];break;case"PanelMail":t=this.props.prefValues[$.kMailCountersPanelSwitcherEnabled],e=Ts.lvj[this.props.size];break;case"PanelCalendar":e=Ts.bcq[this.props.size];break;case"PanelTasks":e=Ts.wo7[this.props.size];break;case"PanelFeeds":e=Ts.ZU_[this.props.size],t=this.props.prefValues[$.kMailCountersPanelSwitcherEnabled];break;case"PanelContacts":e=Ts.LaO[this.props.size];break;case"PanelChat":e=Ts.yt5[this.props.size];break;case"PanelSession":e=Ts.CnO[this.props.size]}return{showCounter:t,image:e}};getBadgeText=()=>{if(this._isWebPanel){const e=this._getWebPanelContent(this.context.vivaldiWindowId,this.props.name)||this.state.webPanelContent;return e?0!==this.state.counter?If(this.state.counter):this.props.prefValues[$.kTabsCounterDetection]?kw(e.title,e.activeUrl,9):"":""}const{showCounter:e}=this.getPanelImageAndCounter(),t=this.props.prefValues[$.kMailCountersPanelUnseenEnabled],{counter:n,mailCounterState:s}=this.state,i=s?.unread||s?.unseen?t?s.unseen:s.unread:n;return e&&0!==i?If(i)??"":""};getWebPanelProps=e=>{if(!e)return null;const t=this.state.webPanelContent;return t?{mediaState:t.muted,faviconPath:t.faviconUrl}:null};renderToolbarButton=(e,t)=>{const n=this.context.vivaldiWindowId;let s,i,{image:o}=this.getPanelImageAndCounter();t&&(o=void 0,s="panel",i=this.toggleMuted);const a=this.state.openPanel===this.props.name,r=As()({"button-toolbar-webpanel":t,active:a}),l=this.state.webPanelContent??void 0;return(0,fs.jsx)(Fa,{...e,className:r,buttonClasses:ud.ZP.getIsBarVisible(this.context.vivaldiWindowId)&&(a||!this.state.openPanel&&this.props.prefValues[$.kToolbarsPanel][0]===this.props.name)?"uifocusstop":void 0,onPanelButtonDragEnter:this._onPanelButtonDragEnter,onPanelButtonDragLeave:this._onPanelButtonDragLeave,buttonStyle:{"--activeButton":a?1:0},progress:this.state.progress,tooltip:this.getTitle(),onClick:e=>this.handleUp(this.props.name,e),onMiddleClick:e=>this.handleClick(this.props.name,e),menu:()=>this.props.inEditor?[]:bw.getPromise(n,this.props.name,l),image:o,badgeText:this.getBadgeText(),mediaStateType:s,toggleMuted:i,...this.getWebPanelProps(t)})};render(){const e=this.context.vivaldiWindowId,{draggable:t,onDragStart:n,onDragEnd:s,onDrop:i,onDragEnter:o,mimeType:a,name:r,customizeMenu:l,popupPosition:d,menuOrigin:c,size:h}=this.props,p={draggable:t,onDragStart:n,onDragEnd:s,onDrop:i,onDragEnter:o,mimeType:a,name:r,customizeMenu:l,popupPosition:d,menuOrigin:c,size:h};return"PanelWeb"===this.props.name?(0,fs.jsx)(yw,{...p,id:"addwebpanel",menu:()=>this.props.inEditor?[]:bw.getPromise(e,this.props.name),keyAccess:-1}):this._isWebPanel?this.renderToolbarButton(p,!0):this.props.inEditor||ud.ZP.canRender({winId:e,panelId:this.props.name})?this.renderToolbarButton(p,!1):null}}const Zw=sa(Tw,Aw);var Ew;function _w(e,t,n,s){Ew||(Ew="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Ew,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Mw extends hs.PureComponent{render(){const{entry:e}=this.props,t=(0,ms.Z)(this.props.entry.url)?.host||"";return(0,fs.jsxs)(fs.Fragment,{children:[_w(Ss,{size:32,style:e.read?{filter:"saturate(0) opacity(0.7)"}:{},url:e.url,title:e.url,loadType:"page"}),_w("div",{className:"readinglist-name",title:e.title.length>80?e.title:null,style:e.read?{filter:"opacity(0.7)"}:{}},void 0,_w("p",{className:"title"},void 0,e.title||t),e.title&&_w("p",{className:"info"},void 0,t)),_w("button",{type:"button",className:"ActionButton circular",onClick:t=>this.props.onClickMark(e.url,!e.read,t),title:e.read?(0,Oe.Z)("Mark as unread"):(0,Oe.Z)("Mark as read"),tabIndex:-1,dangerouslySetInnerHTML:{__html:e.read?Ts.sgm.small:Ts.D7r.small}}),_w("button",{type:"button",className:"ActionButton circular",onClick:t=>this.props.onClickRemove(e.url,t),title:(0,Oe.Z)("verb","Remove"),tabIndex:-1,dangerouslySetInnerHTML:{__html:Ts.M2k.small}})]})}}const Nw=Mw;var Pw;function Dw(e,t,n,s){Pw||(Pw="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Pw,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const xw=[$.kKeyboardTabToAll];class Ow extends hs.PureComponent{static contextType=xi.Z;constructor(e){super(e),this.state={entries:Sw.Z.getList()||[],urlValid:(0,Hn.M)(this.props.url)}}componentDidMount(){Sw.Z.addListener(this._onStoreChanged)}componentDidUpdate(e){e.url!==this.props.url&&this.setState({urlValid:(0,Hn.M)(this.props.url)})}componentWillUnmount(){Sw.Z.removeListener(this._onStoreChanged)}_onStoreChanged=()=>{this.setState({entries:Sw.Z.getList()||[]})};onClickUrl=e=>{d.ZP.openURL(this.context.vivaldiWindowId,e,{singleton:!0}),Hn.Z.setReadStatus(e,!0),this.props.hidePopup()};onClickRemove=(e,t)=>{Hn.Z.remove(e),(0,to.ZP)(t)};onClickMark=(e,t,n)=>{Hn.Z.setReadStatus(e,t),(0,to.ZP)(n)};onSave=e=>{const t=this.context.vivaldiWindowId,n=ie.ZP.getActivePage(t);n&&Hn.Z.add(t,n.url,n.title),this.props.hidePopup(),(0,to.ZP)(e)};onKeyDown=(e,t)=>{switch(t.key){case"Escape":(0,to.ZP)(t),this.props.hidePopup();break;case"Enter":case" ":this.onClickUrl(e);break;case"Delete":case"Backspace":this.onClickRemove(e,t)}};renderDialogHeader=()=>Dw("div",{className:"dialog-header"},void 0,(0,Oe.Z)("Reading List"));renderEntry=(e,t)=>Dw("div",{tabIndex:0,className:"readinglist-item-large",onClick:this.onClickUrl.bind(this,e.url),onKeyDown:this.onKeyDown.bind(this,e.url)},e.url,Dw(Nw,{onClickMark:this.onClickMark,onClickRemove:this.onClickRemove,entry:e}));renderReadingList=()=>{const e=this.state.entries.filter((e=>!e.read)),t=this.state.entries.filter((e=>e.read)),n=[];return e.length?n.push(Dw("header",{},"header1",(0,Oe.Z)("Unread Articles"))):t.length&&n.push(Dw("p",{className:"comment"},"all-done",(0,Oe.Z)("All articles read."))),e.forEach((e=>{n.push(this.renderEntry(e,!1))})),t.length&&n.push(Dw("header",{},"header2",(0,Oe.Z)("Read Articles"))),t.forEach((e=>{n.push(this.renderEntry(e,!0))})),!e.length&&!t.length&&n.push(Dw("p",{className:"comment"},"empty",(0,Oe.Z)("No articles in your reading list."))),n};renderAddCurrent=()=>Dw("footer",{className:"dialog-footer"},void 0,Dw("input",{className:"primary",type:"button",onClick:this.onSave,value:(0,Oe.Z)("Add Current Page"),disabled:!this.state.urlValid,autoFocus:!0}));render(){return Dw("div",{className:"reading-list-dialog"},void 0,this.renderDialogHeader(),Dw("div",{className:"readinglist-listing-large"},void 0,this.renderReadingList()),this.renderAddCurrent())}}const Lw=sa(Ow,xw);var Rw;function Bw(e,t,n,s){Rw||(Rw="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Rw,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Fw=[$.kReadingListShowCounter];class Vw extends hs.PureComponent{static contextType=xi.Z;state={popupVisible:!1,readingListItems:Sw.Z.getUnreadCount(),url:ie.ZP.getActivePage(this.context.vivaldiWindowId)?.url??""};componentDidMount(){if(this.props.inEditor)return;const{selectWindow:e}=this.context;Sw.Z.addListener(this._onReadingStoreChange),ie.ZP.addListener(this._onPageStoreChange,e)}componentWillUnmount(){this.props.inEditor||(Sw.Z.removeListener(this._onReadingStoreChange),ie.ZP.removeListener(this._onPageStoreChange))}_onReadingStoreChange=()=>{const e=Sw.Z.getUnreadCount();this.setState({readingListItems:e})};_onPageStoreChange=()=>{const e=ie.ZP.getActivePage(this.context.vivaldiWindowId)?.url??"";this.setState({url:e})};togglePopup=()=>{this.setState((e=>({popupVisible:!e.popupVisible})))};hidePopup=()=>{this.setState({popupVisible:!1})};render(){const{readingListItems:e}=this.state,t=this.props.prefValues[$.kReadingListShowCounter]&&e>0?e>1e3?"999+":e.toString():void 0;return Bw(Fa,{image:Ts.R_e[this.props.size],tooltip:(0,Oe.Z)("Show the Reading List"),onClick:this.togglePopup,customizeMenu:this.props.customizeMenu,menuOrigin:this.props.menuOrigin,popupPosition:this.props.popupPosition,hidePopup:this.hidePopup,isPopupVisible:this.state.popupVisible,popupClassName:"ToolbarButtonPopup-DefaultStyles",popupWidth:350,size:this.props.size,badgeText:t,draggable:this.props.draggable,onDragStart:this.props.onDragStart??Aa.Z,onDragEnd:this.props.onDragEnd??Aa.Z,onDrop:this.props.onDrop??Aa.Z,onDragEnter:this.props.onDragEnter??Aa.Z,mimeType:this.props.mimeType,name:this.props.name??""},void 0,Bw(Lw,{hidePopup:this.hidePopup,url:this.state.url}))}}const Ww=sa(ta(Vw),Fw);var Uw;function Hw(e,t,n,s){Uw||(Uw="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Uw,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const zw=e=>{const{winId:t}=e,n=hs.useCallback((async function(e){const n=ie.ZP.getActivePage(t);if(!n)return;const{ctrlKey:s,altKey:i,shiftKey:o,metaKey:a}=e,r={ctrlKey:s,altKey:i,shiftKey:o,metaKey:a},l=(0,co.S2)(r),d=je.jk.isInternalUrl(n.url);if(!l||d)return void gl.Z.enableCapture(t);const c=H.Z.get($.kWebpagesCaptureSaveLocation),h=H.Z.get($.kWebpagesCaptureCompressionFormat),{image:p}=await ul.Z.captureFullpage(n.id,h,c);ul.Z.handleCaptureLocation({windowId:t,mode:"fullpage",base64:p})}),[t]);return Hw(Fa,{tooltip:(0,Oe.Z)("title","Capture Page"),onClick:n,image:Ts.z8c[e.size],size:e.size,customizeMenu:e.customizeMenu,draggable:e.draggable,menuOrigin:e.menuOrigin,onDragStart:e.onDragStart,onDragEnd:e.onDragEnd,onDrop:e.onDrop,onDragEnter:e.onDragEnter,mimeType:e.mimeType,popupClassName:"ToolbarButtonPopup-DefaultStyles",name:e.name})};var Gw;function $w(e,t,n,s){Gw||(Gw="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Gw,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Kw extends hs.PureComponent{static contextType=xi.Z;refToolbarButton=hs.createRef();state={pageactionFiles:[],drawerOpen:!1,currentTarget:null,scriptOverrides:[],contentScripts:f.Z.getState()};componentDidMount(){C.Z.pageActions.onOverridesChanged.addListener(this.onOverridesChanged),f.Z.addListener(this.newScriptUpdateList),this.updateScriptOverrides()}componentWillUnmount(){f.Z.removeListener(this.newScriptUpdateList),C.Z.pageActions.onOverridesChanged.removeListener(this.onOverridesChanged)}componentDidUpdate(e){this.props.pageId!==e.pageId&&this.updateScriptOverrides()}newScriptUpdateList=()=>{const e=f.Z.getScripts();this.setState({contentScripts:e})};onOverridesChanged=e=>{e===this.props.pageId&&this.updateScriptOverrides()};updateScriptOverrides=()=>{C.Z.pageActions.getScriptOverridesForTab(this.props.pageId,(e=>{this.setState({scriptOverrides:e})}))};togglePopup=()=>{this.setState((e=>({drawerOpen:!e.drawerOpen})))};hidePopup=()=>{this.state.drawerOpen&&this.setState({drawerOpen:!1})};onItemClicked=(e,t)=>{this.isScriptEnabled(e)?C.Z.pageActions.setScriptOverrideForTab(e,this.props.pageId,"no_override",(()=>{})):C.Z.pageActions.setScriptOverrideForTab(e,this.props.pageId,"enabled",(()=>{}))};hasScriptOverrides=()=>0!==this.state.scriptOverrides.length;isScriptEnabled=e=>{const t=this.state.scriptOverrides.find((t=>t.script===e));return!!t&&"enabled"===t.override};keyDownHandler=(e,t)=>{switch(t.key){case"ArrowUp":this.moveFocus(e,"up",!1);break;case"ArrowDown":this.moveFocus(e,"down",!1);break;default:return}t.preventDefault(),t.stopPropagation()};moveFocus=(e,t,n)=>{const{document:s,HTMLElement:i}=this.context,o=this.refToolbarButton.current?.nodeRef.current;if(o instanceof i&&(!0===n||sl(s,o))){const n=Array.from(o.querySelectorAll("input")).map((e=>e.getAttribute("data-id"))).filter(Boolean);if(0===n.length)return;let s;switch(t){case"current":if(""===e&&(e=n[0]),s=n.indexOf(e),-1===s)return;break;case"up":case"down":if(1===n.length)return;if(s=n.indexOf(e),-1===s)return;if("up"===t){if(s--,s<0)return}else if(s++,s>=n.length)return;break;default:return}e=n[s];const i=o.querySelector(`input[data-id="${e}"]`);i&&i.focus()}};render(){return(0,fs.jsxs)(Fa,{ref:this.refToolbarButton,tooltip:(0,Oe.Z)("Page Actions"),disabled:this.props.disabled,isPopupVisible:this.state.drawerOpen,isOn:this.hasScriptOverrides(),onClick:this.togglePopup,hidePopup:this.hidePopup,image:Ts.jVs[this.props.size],size:this.props.size,customizeMenu:this.props.customizeMenu,menuOrigin:this.props.menuOrigin,popupPosition:this.props.popupPosition,hasLightArrow:"above"===this.props.popupPosition,popupWidth:225,draggable:this.props.draggable,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,onDrop:this.props.onDrop,onDragEnter:this.props.onDragEnter,mimeType:this.props.mimeType,popupClassName:"ToolbarButtonPopup-DefaultStyles",name:this.props.name,children:[$w("h2",{},void 0,(0,Oe.Z)("Page Actions")),$w("div",{className:"popup-scrollarea"},void 0,this.state.contentScripts.map(((e,t)=>{const n=t.toString();return $w("label",{onKeyDown:this.keyDownHandler.bind(this,n)},t,$w("input",{"data-id":n,autoFocus:0===t,type:"checkbox",onChange:this.onItemClicked.bind(this,e),checked:this.isScriptEnabled(e)}),$w("span",{},void 0,(0,w.gD)(e)))})))]})}}const jw=Kw;var Yw,Xw=n(30626),Qw=n(22303);function qw(e,t,n,s){Yw||(Yw="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Yw,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Jw=[$.kAppearanceRangeButtons,$.kKeyboardTabToAll];class eb extends hs.PureComponent{static contextType=xi.Z;refEditZoom=hs.createRef();state={editing:!1};static defaultProps={disabled:!1};setZoomLevel=(e,t,n)=>{this.props.onZoomUpdated(e,n);const s=this.refEditZoom.current,i=Math.round(100*e);s&&!isNaN(e)&&(s.value=i.toString())};resetZoom=()=>{this.setZoomLevel(this.props.defaultZoomLevel),Qw.Z.dispatchZoomUI(this.props.defaultZoomLevel)};updateZoomLevel=()=>{const e=parseFloat(this.props.zoom);this.setZoomLevel(e,this.props.delay)};zoomInStep=()=>{this.setZoomLevel(parseFloat((this.props.zoom+this.props.step).toFixed(2)))};zoomOutStep=()=>{this.setZoomLevel(parseFloat((this.props.zoom-this.props.step).toFixed(2)))};zoomHalf=()=>{this.setZoomLevel(parseFloat((this.props.zoom/2).toFixed(2)))};zoomDouble=()=>{this.setZoomLevel(parseFloat((2*this.props.zoom).toFixed(2)))};handleKeyDown=e=>{e.keyCode===oa.Z.KEY_LEFT?(this.zoomOutStep(),e.preventDefault()):e.keyCode===oa.Z.KEY_RIGHT&&(this.zoomInStep(),e.preventDefault())};rangeChanged=e=>{const{value:t}=e.target;this.setZoomLevel(parseFloat(t),this.state.editing,this.props.delay)};_onEditKeyDown=e=>{const{step:t,zoom:n}=this.props;if(e.keyCode===oa.Z.KEY_ESCAPE)this._onEditZoomBlur();else if(e.keyCode===oa.Z.KEY_SUBTRACT)this.setZoomLevel(n-t,!0),e.preventDefault();else if(e.keyCode===oa.Z.KEY_ADD)this.setZoomLevel(n+t,!0),e.preventDefault();else if(e.keyCode===oa.Z.KEY_RETURN){let e=parseFloat(this.refEditZoom.current?.value)/100;0!==e&&e===parseFloat(e)||(e=1),this.setZoomLevel(e)}};toggleEditZoom=()=>{this.props.disabled||this.setState((e=>({editing:!e.editing})),(()=>this.refEditZoom.current?.select()))};_onEditZoomBlur=()=>{this._activeElement&&(this._activeElement.focus(),delete this._activeElement),this.setState({editing:!1})};onMouseEnter=()=>{!1!==this.props.scrolling&&this.context.document.addEventListener("wheel",this.onMouseWheel,!0)};onMouseLeave=()=>{!1!==this.props.scrolling&&this.context.document.removeEventListener("wheel",this.onMouseWheel,!0)};onMouseDown=e=>{Jo(e)?e.preventDefault():this._activeElement=this.context.document.activeElement};onMouseUp=()=>{this.props.delay&&this.updateZoomLevel(),this._activeElement&&(this._activeElement.focus(),delete this._activeElement)};onMouseWheel=e=>{e.deltaX<0?this.zoomOutStep():e.deltaX>0?this.zoomInStep():e.deltaY>0?this.zoomOutStep():e.deltaY<0&&this.zoomInStep()};incrementCount=()=>{this.setZoomLevel(this.props.zoom+this.props.step)};decrementCount=()=>{this.setZoomLevel(this.props.zoom-this.props.step)};onPageZoomUpdated=e=>{const t=Xw.Z.getActiveWebView(this.context.vivaldiWindowId);t&&t.setZoom(e)};showCustomizeMenu=(e,t)=>{const n=this.props.customizeMenu;n&&(e.persist(),e.preventDefault(),e.stopPropagation(),(0,Qi.Z)(this.context,n)(e))};render(){const{customizeMenu:e,zoom:t}=this.props,n=this.props.prefValues[$.kAppearanceRangeButtons],s=this.props.disabled||(this.props.defaultZoomLevel?this.props.defaultZoomLevel===t:1===t),i=this.state.editing?(0,fs.jsx)("input",{className:"zoom-percent",type:"number",ref:this.refEditZoom,defaultValue:Math.round(100*t),onKeyDown:this._onEditKeyDown,onBlur:this._onEditZoomBlur,step:"1",disabled:this.props.disabled}):qw("span",{className:As()({"zoom-percent":!0,disabled:this.props.disabled}),onMouseDown:this.onMouseDown,onClick:this.toggleEditZoom},void 0,`${Math.round(100*t)} %`),o=this.props.inFooter?this.props.prefValues[$.kKeyboardTabToAll]:0;return qw("div",{onContextMenu:e?this.showCustomizeMenu:null,className:"page-zoom-controls"},void 0,qw(Fa,{onClick:this.resetZoom,tooltip:(0,Oe.Z)("Reset Zoom"),disabled:s,title:(0,Oe.Z)("Reset"),tabIndex:o}),!n&&(0,fs.jsxs)(fs.Fragment,{children:[qw("input",{type:"range",min:this.props.minLevel,max:this.props.maxLevel,step:this.props.step,onChange:this.rangeChanged,onKeyDown:this.handleKeyDown,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onMouseDown:-1===o?this.onMouseDown:null,onMouseUp:this.onMouseUp,onTouchEnd:this.onMouseUp,value:t,disabled:this.props.disabled,tabIndex:o}),i]}),n&&(0,fs.jsxs)(fs.Fragment,{children:[qw(Fa,{onClick:this.decrementCount,tooltip:(0,Oe.Z)("Zoom Out"),disabled:this.props.disabled,image:Ts.M2k.medium,tabIndex:o}),i,qw(Fa,{onClick:this.incrementCount,tooltip:(0,Oe.Z)("Zoom In"),disabled:this.props.disabled,image:Ts.md4.medium,tabIndex:o})]}))}}const tb=sa(eb,Jw);var nb,sb=n(47825),ib=n(71828);function ob(e,t,n,s){nb||(nb="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:nb,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var ab=ob("input",{type:"range",min:"0",max:"2",value:"1",readOnly:!0});class rb extends hs.PureComponent{static contextType=xi.Z;state={disabled:!Xw.Z.getActiveWebView(this.context.vivaldiWindowId),defaultPageZoom:sb.Z.getDefaultPageZoom(),zoom:sb.Z.getZoom(),notesZoom:sb.Z.getNotesZoom(),isNoteWebView:!1};componentDidMount(){sb.Z.addListener(this._onZoomStoreChanged),s.Z.tabs.onZoomChange.addListener(this._onTabZoomChange),C.Z.tabsPrivate.onPageZoom.addListener(this._onPageZoom),Xw.Z.addListener(this._onActiveWebViewStoreChanged),this._onActiveWebViewStoreChanged()}componentWillUnmount(){Xw.Z.removeListener(this._onActiveWebViewStoreChanged),s.Z.tabs.onZoomChange.removeListener(this._onTabZoomChange),C.Z.tabsPrivate.onPageZoom.removeListener(this._onPageZoom),sb.Z.removeListener(this._onZoomStoreChanged)}_onActiveWebViewStoreChanged=()=>{const e=Xw.Z.getActiveWebView(this.context.vivaldiWindowId);e&&e.getZoom((t=>{this._updateZoomState(this.rangeCheck(t),e.name)}));const t={disabled:!e};e||(t.zoom=1),this.setState(t)};_onZoomStoreChanged=()=>{const{defaultPageZoom:e,zoom:t,notesZoom:n}=sb.Z.getState();this.setState({defaultPageZoom:e,zoom:t,notesZoom:n})};_onTabZoomChange=e=>{const t=Xw.Z.getActiveWebView(this.context.vivaldiWindowId);t&&t.getZoom((n=>{n===e.oldZoomFactor&&e.tabId===this.props.pageId&&this._updateZoomState(e.newZoomFactor,t.name)}))};_onPageZoom=(e,t)=>{if(e!==this.context.vivaldiWindowId)return;const n=Xw.Z.getActiveWebView(e);n&&n.getZoom((e=>{e+=.1*t,this._updateZoomState(e,n.name)}))};_updateZoomState=(e,t)=>{"markdowneditor"===t||"richtexteditor"===t?this.setState({notesZoom:e,isNoteWebView:!0}):this.setState({zoom:e,isNoteWebView:!1})};setZoomLevel=e=>{Qw.Z.setPageZoom(this.context.vivaldiWindowId,this.rangeCheck(e))};rangeCheck=e=>Math.min(Math.max(e,ib.XF),ib.qt);render(){const{disabled:e,zoom:t,notesZoom:n,isNoteWebView:s,defaultPageZoom:i}=this.state,o=this.props.draggable,a=this.props.onDrop&&this.props.onDragEnter;return(0,fs.jsxs)("div",{...qo({draggable:this.props.draggable,onDragStart:o?this.props.onDragStart:null,onDragEnd:o?this.props.onDragEnd:null,onDragEnter:a?this.props.onDragEnter:null,onDragOver:a?this.props.onDragOver:null,onDragLeave:a?this.props.onDragLeave:null,onDrop:a?this.props.onDrop:null}),className:this.props.buttonClasses,onContextMenu:e=>(0,Qi.Z)(this.context,this.props.customizeMenu??[])(e),children:[this.props.preview&&ab,!this.props.preview&&ob(tb,{zoom:s?n:t,scrolling:!0,inFooter:!0,defaultZoomLevel:i,maxLevel:ib.qt,minLevel:ib.XF,step:ib.Zh,disabled:e,customizeMenu:this.props.customizeMenu,onZoomUpdated:this.setZoomLevel},"zoomslider")]})}}const lb=ta(rb);var db;function cb(e,t,n,s){db||(db="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:db,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class hb extends hs.PureComponent{onKeyDown=e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),e.stopPropagation(),this.props.onClick())};render(){return cb("span",{title:this.props.title,className:"InlineText",tabIndex:H.Z.get($.kKeyboardTabToAll),onMouseDown:e=>e.preventDefault(),onClick:this.props.onClick,onKeyDown:this.onKeyDown},void 0,this.props.children)}}var pb,ub=n(67044),gb=n(36246);function mb(e,t,n,s){pb||(pb="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:pb,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class vb extends hs.PureComponent{static contextType=xi.Z;refSwitchInput=hs.createRef();refSwitchButton=hs.createRef();OFF=0;ON=12;constructor(e){super(e),e.scale&&(this.ON=this.ON*e.scale),this.state={dragging:!1,position:e.checked?this.ON:this.OFF}}componentDidUpdate(e){e.checked!==this.props.checked&&this.updateButtonPosition()}updateButtonPosition=()=>{this.setState({position:this.props.checked?this.ON:this.OFF})};onChange=e=>{const t=e.target.checked?this.ON:this.OFF;this.setState({position:t}),this.props.onChange&&this.props.onChange(e)};onClick=e=>{this.state.dragging?(e.preventDefault(),this.setState({dragging:!1})):this.toggleSwitch()};toggleSwitch=()=>{const e=new MouseEvent("click",{bubbles:!0,cancelable:!0});this.refSwitchInput.current?.dispatchEvent(e)};cancelEvent=e=>{e.preventDefault()};releasePointerCapture=e=>{e.currentTarget.hasPointerCapture(e.pointerId.toString())&&e.currentTarget.releasePointerCapture(e.pointerId.toString())};onPointerDown=e=>{e.currentTarget.setPointerCapture(e.pointerId.toString())};onPointerMove=e=>{if(1===e.buttons&&this.refSwitchButton.current===this.context.document.activeElement){const{movementX:t}=e;0!==t&&this.setState((e=>({dragging:!0,position:(0,gb.Z)(e.position+t,0,this.ON)})))}};onPointerUp=e=>{if(this.state.dragging){this.releasePointerCapture(e);const{position:t}=this.state;t>=0&&t<=this.ON/2?(this.setState({position:this.OFF}),this.props.checked&&this.toggleSwitch()):(this.setState({position:this.ON}),this.props.checked||this.toggleSwitch())}};render(){const{position:e}=this.state;return mb("div",{className:As()("Switch",{"Switch--Disabled":this.props.disabled,"Switch--Progress":this.props.inProgress,"Switch--Progress-Done":this.props.checked&&this.props.hasOwnProperty("inProgress")}),style:this.props.scale?{transform:`scale(${this.props.scale})`}:void 0,title:this.props.title},void 0,(0,fs.jsx)("input",{id:this.props.inputId,ref:this.refSwitchInput,className:"Switch-Input",type:"checkbox",onChange:this.onChange,checked:this.props.checked,disabled:this.props.disabled,value:this.props.value,onPointerDown:this.cancelEvent,tabIndex:this.props.tabIndex}),(0,fs.jsx)("button",{ref:this.refSwitchButton,className:As()({"Switch-Button":!0,dragging:this.state.dragging}),style:{transform:`translateX(${e/(this.props.scale||1)}px)`},onPointerDown:this.onPointerDown,onPointerMove:this.onPointerMove,onPointerUp:this.onPointerUp,onPointerCancel:this.releasePointerCapture,onClick:this.onClick,tabIndex:"-1"}))}}const fb=vb;var yb;function Cb(e,t,n,s){yb||(yb="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:yb,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const wb=(0,Oe.Z)("Privacy Guard separates your IP address from your traffic data, which gives no single point of monitoring what you do online."),bb=(0,Oe.Z)("Your device is configured to use another proxy. To use Privacy Guard, disable the other proxy and restart the browser."),Sb=(0,Oe.Z)("We would love to hear your honest feedback about this feature, click the link below and let us know what you think.");var Ib=Cb(jo,{type:"close",size:16}),kb=Cb("p",{className:"info"},void 0,Sb),Ab=Cb("p",{className:"ProxyPopup-CTA"},void 0,wb),Tb=Cb("p",{},void 0,bb),Zb=Cb("p",{},void 0,wb),Eb=Cb("p",{},void 0,bb);class _b extends hs.Component{static contextType=xi.Z;state=function(){return{showSurvey:ub.Z.getShowSurvey(),showTokenError:"error"!==ub.Z.getTokenData().state,connectStrategy:ub.Z.getConnectStrategy(),connecting:!1,hasProxyToken:ub.Z.getHasToken(),hasSyncToken:Jn.Z.getState().hasToken,tokenData:ub.Z.getTokenData()}}();componentDidMount(){ub.Z.addListener(this._onProxyStoreChanged),Jn.Z.addListener(this._onAccountStoreChanged)}componentWillUnmount(){ub.Z.removeListener(this._onProxyStoreChanged),Jn.Z.removeListener(this._onAccountStoreChanged),"fetch"===this._getMode()&&xn.Z.cancelLoadToken()}componentDidUpdate(e){this.props.connected!==e.connected&&this.props.connected&&this.setState({connecting:!1})}_onProxyStoreChanged=()=>{const e=this.state.tokenData.state;this.setState({showSurvey:ub.Z.getShowSurvey(),connectStrategy:ub.Z.getConnectStrategy(),hasProxyToken:ub.Z.getHasToken(),tokenData:ub.Z.getTokenData()},(()=>{"fetch"===e&&"idle"===this.state.tokenData.state&&this.setState({connecting:!0},(()=>{xn.Z.connect()}))}))};_onAccountStoreChanged=()=>{this.setState({hasSyncToken:Jn.Z.getState().hasToken})};_getMode=()=>"fetch"===this.state.tokenData.state?"fetch":this.state.connecting?"connecting":this.props.connected?"connected":"offline";_handleBusyLearnMore=()=>{d.ZP.openURL(this.context.vivaldiWindowId,"https://help.vivaldi.com/desktop/privacy/privacy-guard/#unavailable"),this.props.hidePopup()};_handleGotoINVISV=()=>{d.ZP.openURL(this.context.vivaldiWindowId,"https://invisv.com"),this.props.hidePopup()};_handleGotoSurvey=()=>{d.ZP.openURL(this.context.vivaldiWindowId,"https://vivaldi.com/bk/shield-survey"),this.props.hidePopup(),xn.Z.showSurvey(!1)};_handleCancelSurvey=()=>{xn.Z.showSurvey(!1)};_handleStrategyChange=e=>{const t=e.currentTarget.value;"random"!==t&&"fastest"!==t||xn.Z.setConnectStrategy(t)};_handleRegister=()=>{Ae.Z.showSettings(this.context.vivaldiWindowId,"sync",{view:"register"}),this.props.hidePopup()};_handleSignin=()=>{Ae.Z.showSettings(this.context.vivaldiWindowId,"sync"),this.props.hidePopup()};_handleModeChange=()=>{switch(this._getMode()){case"connected":xn.Z.disconnect();break;case"offline":this.state.hasProxyToken?this.setState({connecting:!0},(()=>{xn.Z.connect()})):(xn.Z.loadToken(),this.setState({showTokenError:!0}))}};_renderFooter=()=>Cb("footer",{className:"dialog-footer"},void 0,Cb("div",{className:"TranslatePopup-FooterText"},void 0,(0,Oe.Z)("Privacy Guard is powered by")," ",Cb(hb,{onClick:this._handleGotoINVISV},void 0,"INVISV")));_renderBusyFooter=()=>Cb("footer",{className:"dialog-footer"},void 0,Cb("div",{className:"TranslatePopup-FooterText"},void 0,Cb(hb,{onClick:this._handleBusyLearnMore},void 0,(0,Oe.Z)("Learn More"))));_renderPopup=()=>{const e=this._getMode(),t="connected"===e?(0,Oe.Z)("title","Privacy Guard – Connected"):(0,Oe.Z)("title","Privacy Guard – Inactive");let n="",s=!1;switch(e){case"fetch":n=(0,Oe.Z)("Fetching token...");break;case"connecting":n=(0,Oe.Z)("Connecting...");break;case"offline":"error"===this.state.tokenData.state&&this.state.showTokenError?n=this.state.tokenData.message:s=this.state.showSurvey;break;case"connected":s=this.state.showSurvey}const i=ie.ZP.getActivePage(this.context.vivaldiWindowId)?.url||"",o=(0,uy.x0)(i),a=[...ub.Z.getBypassList(!1)],r=(0,vs.xl)(i),l=a.some((e=>new RegExp(e.replace(/\./g,"\\.").replace(/\*/g,".*"),"i").test(o)));return Cb("div",{className:"ProxyPopup"},void 0,Cb("h2",{},void 0,t),Cb("div",{className:"ProxyPopup-Setting"},void 0,s&&Cb("div",{className:"ProxyPopup-SURVEY"},void 0,Cb("div",{className:"ProxyPopup-TitleWrapper"},void 0,Cb("p",{className:"ProxyPopup-SurveyTitle"},void 0,(0,Oe.Z)("Share your feedback with us!")),Cb("button",{className:"close transparent",onClick:this._handleCancelSurvey},void 0,Ib)),kb,Cb(hb,{onClick:this._handleGotoSurvey},void 0,(0,Oe.Z)("Take the survey"))),Cb(fb,{checked:"connected"===e||"connecting"===e||"fetch"===e,inProgress:!this.props.publicIp&&"offline"!==e,onChange:this._handleModeChange,scale:2.5,title:this.props.publicIp?"Disable Privacy Guard":"Enable Privacy Guard"}),n&&Cb("p",{},void 0,n),("offline"===e||"fetch"===e||"connecting"===e)&&Ab,"connected"===e&&Cb("div",{className:"ProxyPopup-Status"},void 0,Cb("span",{className:"ProxyPopup-Status-Label"},void 0,(0,Oe.Z)("Public IP")),Cb("span",{className:this.props.publicIp?"selectable":null},void 0,this.props.publicIp||(0,Oe.Z)("Fetching...")),Cb("span",{className:"ProxyPopup-Status-Label"},void 0,(0,Oe.Z)("other","Location")),Cb("span",{},void 0,this.props.location),Cb("span",{className:"ProxyPopup-Status-Label"},void 0,(0,Oe.Z)("Relay")),Cb("select",{value:this.state.connectStrategy,onChange:this._handleStrategyChange},void 0,this._renderConnectStrategies()),l&&Cb("p",{className:"info ProxyPopup-Status-Bypass"},void 0,(0,Oe.Z)("Privacy Guard is bypassed on “$1”.",[o])),!l&&!r&&Cb("button",{className:"ProxyPopup-Status-Bypass",disabled:!o,onClick:()=>{a.push(o),xn.Z.setBypassList(a)}},void 0,(0,Oe.Z)("Add Current Site to Exceptions")))),this._renderFooter())};_renderBusyPopup=e=>Cb("div",{className:"ProxyPopup"},void 0,Cb("h2",{},void 0,(0,Oe.Z)("title","Privacy Guard – Unavailable")),Cb("div",{className:"ProxyPopup-BUSY"},void 0,"error"===e&&Cb("h3",{},void 0,(0,Oe.Z)("Privacy Guard was disabled by another active proxy service.")),Tb),this._renderBusyFooter());_renderConnectSync=()=>Cb("div",{className:"ProxyPopup"},void 0,Cb("h2",{},void 0,this.props.busy?(0,Oe.Z)("title","Privacy Guard – Unavailable"):(0,Oe.Z)("title","Privacy Guard – Inactive")),Cb("div",{className:"ProxyPopup-Schema",dangerouslySetInnerHTML:{__html:Ts.$zT}}),Cb("div",{className:"ProxyPopup-Login"},void 0,Cb("div",{className:"ProxyPopup-CTA"},void 0,Cb("h3",{},void 0,(0,Oe.Z)("Supercharge Your Privacy")),Zb),!this.props.busy&&(0,fs.jsxs)(fs.Fragment,{children:[Cb("p",{},void 0,(0,Oe.Z)("To start with Privacy Guard, you need a Vivaldi Account.")),Cb("div",{className:"toolbar toolbar-wrap toolbar-space toolbar-center"},void 0,Cb("input",{type:"button",className:"primary",value:(0,Oe.Z)("Create Account"),onClick:this._handleRegister}),Cb("input",{type:"button",value:(0,Oe.Z)("Log In"),onClick:this._handleSignin}))]}),this.props.busy&&Cb("div",{className:"ProxyPopup-BUSY"},void 0,Cb("h3",{},void 0,(0,Oe.Z)("Privacy Guard is Unavailable")),Eb)),this._renderFooter());_renderConnectStrategies=()=>ub.Z.getConnectStrategies().map((e=>Cb("option",{value:e.key},e.key,e.name)));render(){return this.state.hasProxyToken||this.state.hasSyncToken?this.props.busy?this._renderBusyPopup("error"):this._renderPopup():this._renderConnectSync()}}const Mb=_b;var Nb;function Pb(e,t,n,s){Nb||(Nb="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Nb,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Db extends hs.PureComponent{static contextType=xi.Z;state={busy:ub.Z.getHasOtherProxy(),connected:ub.Z.getIsConnected(),enabled:ub.Z.getHasApiAccess(),location:ub.Z.getLocation(),popupOpen:!1,publicIp:ub.Z.getPublicIp(),rejectReason:ub.Z.getApiRejectReason(),showSurvey:ub.Z.getShowSurvey()};componentDidMount(){ub.Z.addListener(this._onStoreChanged)}componentWillUnmount(){ub.Z.removeListener(this._onStoreChanged)}_onStoreChanged=()=>{const e=this.state.showSurvey;this.setState({busy:ub.Z.getHasOtherProxy(),connected:ub.Z.getIsConnected(),enabled:ub.Z.getHasApiAccess(),location:ub.Z.getLocation(),publicIp:ub.Z.getPublicIp(),rejectReason:ub.Z.getApiRejectReason(),showSurvey:ub.Z.getShowSurvey()},(()=>{e||!this.state.showSurvey||this.state.popupOpen||this.togglePopup()}))};hidePopup=()=>{this.setState({popupOpen:!1})};togglePopup=()=>{this.setState((e=>({popupOpen:!e.popupOpen})))};getImage=()=>this.props.preview?Ts.T4m[this.props.size]:this.state.busy?Ts.gpy[this.props.size]:this.state.connected?Ts.CE8[this.props.size]:Ts.T4m[this.props.size];render(){if(G.ZP.isGuest())return null;const{name:e,size:t,popupPosition:n,customizeMenu:s,draggable:i,onDragStart:o,onDragEnd:a,onDrop:r,onDragEnter:l,mimeType:d,menuOrigin:c}=this.props,p={size:t,name:e,customizeMenu:s,menuOrigin:c,draggable:i,popupPosition:n,onDragStart:o,onDragEnd:a,onDrop:r,onDragEnter:l,mimeType:d};let u;return u=this.state.busy?(0,bd.wY)("Proxy")+h.YV+(0,Oe.Z)("Unavailable"):this.state.enabled?this.state.connected?(0,bd.wY)("Proxy")+h.YV+(0,Oe.Z)("Connected")+h.YV+(0,Oe.Z)("Public IP: $1",[this.state.publicIp||(0,Oe.Z)("Fetching...")]):(0,bd.wY)("Proxy")+h.YV+(0,Oe.Z)("Inactive"):(0,bd.wY)("Proxy")+h.YV+this.state.rejectReason,(0,fs.jsx)(Fa,{...p,tooltip:u,hidePopup:this.hidePopup,isPopupVisible:this.state.popupOpen,popupWidth:260,onClick:this.togglePopup,popupClassName:"ToolbarButtonPopup-DefaultStyles",image:this.getImage(),children:Pb(Mb,{busy:this.state.busy,connected:this.state.connected,location:this.state.location,publicIp:this.state.publicIp,hidePopup:this.hidePopup})})}}const xb=Db;var Ob;function Lb(e,t,n,s){Ob||(Ob="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Ob,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var Rb=Lb("li",{className:"divider"});class Bb extends hs.PureComponent{static contextType=xi.Z;nodeRef=hs.createRef();componentDidUpdate(e){if(this.props.isSelected&&!e.isSelected){const{HTMLElement:e}=this.context,t=this.nodeRef.current;t instanceof e&&t.scrollIntoViewIfNeeded(!1)}}_handleMouseUp=e=>{e.button!==Hi.Z.kLeft?e.stopPropagation():this.props.onItemActivated(this.props.item,e)};_killEvent=e=>{e.preventDefault(),e.stopPropagation()};_handleMouseOver=()=>{this.props.setSelected(this.props.index)};_getDisplayName=()=>Lb("span",{},void 0,this.props.item.name);_getDisplayShortcut=()=>{if(this.props.item.shortcut&&!1!==this.props.showShortcut){return Lb("span",{className:"shortcut"},void 0,this.props.item.noPrettifying?this.props.item.shortcut:(0,tu.$)(this.props.item.shortcut))}return null};_getIcon=()=>{if(this.props.item.iconSVG)return Lb("span",{dangerouslySetInnerHTML:{__html:this.props.item.iconSVG}});if(this.props.item.faviconUrl)return Lb(Ss,{url:this.props.item.faviconUrl,loadType:"faviconFromCache"});return Lb("img",{src:this.props.item.icon?this.props.item.icon:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"})};_renderItem=()=>{const e=this.props.item.type||"Normal";return(0,fs.jsxs)("li",{ref:this.nodeRef,className:As()({selectedItem:this.props.isSelected}),onMouseOver:this._handleMouseOver,onMouseDown:this._killEvent,onMouseUp:this._handleMouseUp,children:["Normal"===e&&Lb("a",{tabIndex:"0"},void 0,Lb("label",{className:"menu-icon"},void 0,this._getIcon()),Lb("label",{className:"menu-label"},void 0,this._getDisplayName(),this._getDisplayShortcut())),"Description"===e&&Lb("a",{tabIndex:"0",className:"menu-item-description-container"},void 0,Lb("label",{className:"menu-icon"},void 0,this._getIcon()),Lb("label",{className:"menu-label"},void 0,this._getDisplayName(),this._getDisplayShortcut()),Lb("label",{className:"menu-description"},void 0,this.props.item.description)),"Checkbox"===e&&Lb("a",{tabIndx:"0"},void 0,Lb("label",{},void 0,Lb("span",{className:"menu-icon"},void 0,Lb("input",{type:"checkbox",checked:this.props.item.checked,readOnly:!0})),Lb("span",{className:"menu-label"},void 0,this._getDisplayName()))),"Radio"===e&&Lb("a",{tabIndex:"0"},void 0,Lb("label",{},void 0,Lb("span",{className:"menu-icon"},void 0,Lb("input",{className:"menu-icon",type:"radio",name:"radiomenu",checked:this.props.item.checked,readOnly:!0})),Lb("span",{className:"menu-label"},void 0,this._getDisplayName())))]})};_renderDivider=()=>Rb;render(){return"Separator"===this.props.item.type?this._renderDivider():this._renderItem()}}const Fb=Bb;var Vb,Wb=n(34155);function Ub(e,t,n,s){Vb||(Vb="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Vb,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Hb extends hs.PureComponent{static contextType=xi.Z;nodeRef=hs.createRef();state={selectedItemIndex:this.props.items.findIndex((e=>e.id===this.props.selectedItem?.id))};getNode(){return this.nodeRef.current}_takeFocus=e=>{e&&e.stopPropagation&&e.stopPropagation();const{HTMLElement:t,HTMLButtonElement:n}=this.context,s=this.getNode();if(s instanceof t){const e=s.querySelector(".menu .focusTrap");e&&e instanceof n&&e.focus()}};_onKeyboardFocusIn=()=>{Wb.nextTick((()=>{const{HTMLElement:e}=this.context,t=this.getNode();t instanceof e&&t.addEventListener("keydown",this._handleKeyboardNavigation)}))};_onKeyboardFocusOut=()=>{const{HTMLElement:e}=this.context,t=this.getNode();t instanceof e&&t.removeEventListener("keydown",this._handleKeyboardNavigation)};_handleKeyboardNavigation=e=>{switch(e.preventDefault(),e.which){case oa.Z.KEY_SPACE:case oa.Z.KEY_RETURN:const t=this.state.selectedItemIndex;t>=0&&t<=this._getMaxMenuIndex()&&this._onItemActivated(this.props.items[t],e);break;case oa.Z.KEY_ESCAPE:this.props.onClose?.();break;case oa.Z.KEY_UP:this._stepSelection(!1);break;case oa.Z.KEY_DOWN:this._stepSelection(!0);break;default:e.stopPropagation()}};_stepSelection=e=>{let t=this.state.selectedItemIndex;if(0!==this.props.items.filter((e=>"Separator"!==e.type)).length){do{t+=e?1:-1,t=(t+this.props.items.length)%this.props.items.length}while("Separator"===this.props.items[t].type);this._setSelected(t)}};_getMaxMenuIndex=()=>this.props.items.length-1;_setSelected=e=>{"Separator"===this.props.items[e].type||e>this._getMaxMenuIndex()||this.setState({selectedItemIndex:e})};_onClicked=e=>{e.preventDefault(),e.stopPropagation();const{HTMLElement:t}=this.context,n=e.nativeEvent.target;n&&n instanceof t&&n.focus()};_onItemActivated=(e,t)=>{t.stopPropagation(),this.props.onItemActivated(e)};handleClickOutside=e=>{this.props.onClose?.()};render(){return(0,fs.jsxs)("nav",{ref:this.nodeRef,className:As()("menu",this.props.className),onMouseOver:this._takeFocus,onMouseDown:this._onClicked,onMouseUp:this._onClicked,onBlur:()=>this.props.onClose?.(),tabIndex:"-1",children:[Ub("input",{type:"text",className:"focusTrap",autoFocus:!0,onFocus:this._onKeyboardFocusIn,onBlur:this._onKeyboardFocusOut}),Ub("ul",{},void 0,this.props.items.map(((e,t)=>Ub(Fb,{index:t,item:e,showShortcut:this.props.showShortcuts,isSelected:this.state.selectedItemIndex===t,setSelected:this._setSelected,onItemActivated:this._onItemActivated},t))))]})}}const zb=(0,ua.Z)(Hb);var Gb;function $b(e,t,n,s){Gb||(Gb="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Gb,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Kb({onClick:e,icon:t}){return $b(Fa,{onClick:e,tooltip:(0,Oe.Z)("Change search engine"),faviconPath:t,faviconLoadType:"faviconFromCache"})}function jb({onClick:e}){return $b(Fa,{onClick:e,tooltip:(0,Oe.Z)("Change search engine"),image:Ts.L$F})}class Yb extends hs.PureComponent{onItemClicked=({id:e})=>{this.props.onItemClicked(e)};render(){return $b(hs.Fragment,{},void 0,$b("div",{className:"toolbar-insideinput SearchEngineSelect-Icon"},void 0,this.props.useFavicon?$b(Kb,{onClick:this.props.toggleOpen,icon:this.props.icon}):$b(jb,{onClick:this.props.toggleOpen})),this.props.isOpen&&$b(zb,{items:this.props.items,onClose:this.props.onClose,onItemActivated:this.onItemClicked,showShortcuts:this.props.showKeywords}))}}const Xb=Yb;var Qb=n(25776);const qb={};let Jb=[];class eS extends Ol.Z{getText(e){const t=ie.ZP.getActivePage(e);return t?qb[t.id]??"":""}getTypedHistory(){return Jb}dispatchAction(e){switch(e.actionType){case"SEARCH_FIELD_ADD_TYPED_HISTORY":!function(e){const t=H.Z.get($.kHistoryDaysToKeepVisits)>0?H.Z.get($.kAddressBarSearchTypedHistory):Jb;Jb=[{type:"OMNI_RESULT_TYPED_HISTORY_SEARCH",id:e,url:e,when:Date.now()}].concat(function(e,t){const n=e.length>=30?(0,Qb.Z)(e,30):e;return t?n.filter((({url:e})=>e!==t)):n}(t,e)),H.Z.get($.kHistoryDaysToKeepVisits)>0&&tS();nS.emitChange()}(e.query);break;case"SEARCH_FIELD_DELETE_TYPED_HISTORY":!function(e,t){Jb=e.length>0?Jb.filter((({url:t})=>e!==t)):Jb.filter((({when:e})=>t!==e)),H.Z.get($.kHistoryDaysToKeepVisits)>0&&tS();nS.emitChange()}(e.query,e.when);break;case"SEARCH_FIELD_DELETE_TYPED_HISTORY_FROM_DATABASE":s=!1,Ne.Z.reset($.kAddressBarSearchTypedHistory),s&&(Jb=[],nS.emitChange());break;case"SEARCH_FIELD_INIT_TYPED_HISTORY":Jb=H.Z.get($.kAddressBarSearchTypedHistory),nS.emitChange();break;case"SEARCH_FIELD_SET_TEXT":t=e.tabId,n=e.text,qb[t]=n,nS.emitChange();break;case"SEARCH_FIELD_WRITE_TYPED_HISTORY_TO_DATABASE":tS();break;case"SEARCH_FIELD_DELETE_TYPED_HISTORY_PERIOD":!function(e){Jb=Jb.filter((({when:t})=>e-t>0)),H.Z.get($.kHistoryDaysToKeepVisits)>0&&tS();nS.emitChange()}(e.since);break;case"CHROME_TABS_REMOVED":!function(e){delete qb[e]}(e.tabId)}var t,n,s}}function tS(){Ne.Z.set($.kAddressBarSearchTypedHistory,Jb)}const nS=new eS(y.Z),sS=nS;var iS,oS=n(58848),aS=n(8074);function rS(e,t,n,s){iS||(iS="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:iS,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class lS extends hs.PureComponent{static contextType=xi.Z;loadBlockedContent=()=>{const e=Xw.Z.getActiveWebView(this.context.vivaldiWindowId);e&&e.allowBlockedInsecureContent(),aS.Z.resetPageHasBlockedContent(this.props.pageId)};allowCookiesContent=()=>{const e=new URL(this.props.url).origin;C.Z.utilities.setContentSettings({type:"cookies",primaryPattern:e,secondaryPattern:"*",value:"allow",incognito:!1}),aS.Z.resetPageHasBlockedContent(this.props.pageId)};openManageCookies=()=>{Ae.Z.showSettings(this.context.vivaldiWindowId,"privacy")};render(){return rS("div",{tabIndex:"0",className:"addressfield-popup"},void 0,rS("header",{className:"addressfield-popup-header blocked-content"},void 0,rS("span",{dangerouslySetInnerHTML:{__html:Ts.W4h.small}}),rS("h1",{},void 0,(0,Oe.Z)("Blocked Content"))),rS("div",{className:"addressfield-popup-content blocked-content"},void 0,(()=>{let e=(0,te.D5)();this.props.blockedPageContent.map((t=>{let n=e.get(t);e=n?e.set(t,++n):e.set(t,1)}));const t=[];for(const[n,s]of e)switch(n){case"ads":t.push(rS("div",{className:"blocked-section"},n,(0,Oe.Z)("Advertisements on this page are flagged as abusive and blocked.")));break;case"cookies":t.push(rS("div",{className:"blocked-section"},n,(0,Oe.Z)("$1 cookie is blocked","$1 cookies are blocked",[s]),rS("div",{className:"clickable",onClick:this.allowCookiesContent},void 0,(0,Oe.Z)("Allow cookies for this site"))));break;case"mixed-script":t.push(rS("div",{className:"blocked-section"},n,(0,Oe.Z)("$1 unsafe resource is blocked","$1 unsafe resources are blocked",[s]),rS("div",{className:"clickable",onClick:this.loadBlockedContent},void 0,(0,Oe.Z)("Load the unsafe resource","Load the unsafe resources",[s]))));break;case"autoplay":t.push(rS("div",{className:"blocked-section"},n,(0,Oe.Z)("Autoplay of video content has been blocked.")));break;case"images":t.push(rS("div",{className:"blocked-section"},n,(0,Oe.Z)("Image loading has been blocked.")));break;default:console.warn("Unhandled blocked content $1",n)}return t})()),rS("footer",{className:"dialog-footer"},void 0,this.props.blockedPageContent.includes("cookies")&&rS("input",{type:"button",onClick:this.openManageCookies,value:(0,Oe.Z)("Manage Cookies")}),rS("input",{type:"button",onClick:this.props.onPopupClosed,value:(0,Oe.Z)("Close")})))}}const dS=lS;var cS;function hS(e,t,n,s){cS||(cS="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:cS,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class pS extends hs.Component{state={popupVisible:!1};onTogglePopupOpen=e=>{e.preventDefault(),this.setState((e=>({popupVisible:!e.popupVisible})))};onClosePopup=()=>{this.setState({popupVisible:!1})};render(){return hS(Fa,{image:Ts.W4h.small,tooltip:(0,Oe.Z)("Content has been blocked."),onClick:this.onTogglePopupOpen,popupPosition:this.props.position,className:"button-toolbar button-addressfield permission-popup is-blocking",hidePopup:this.onClosePopup,isPopupVisible:this.state.popupVisible,popupClassName:"addressfield-popup-container",popupWidth:240},void 0,hS(dS,{pageId:this.props.pageId,url:this.props.url,onPopupClosed:this.onClosePopup,blockedPageContent:this.props.blockedPageContent}))}}const uS=pS;var gS,mS=n(19626);function vS(e,t,n,s){gS||(gS="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:gS,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const fS=" "+(0,Oe.Z)("(Default)"),yS=["tracking","ad_blocking"];var CS=vS("br",{}),wS=vS("span",{className:"keep-ea-words"},void 0,fS),bS=vS("span",{className:"keep-ea-words"},void 0,fS),SS=vS("span",{className:"keep-ea-words"},void 0,fS);class IS extends hs.PureComponent{static contextType=xi.Z;buttonStyle={"--no-blocking":0,"--trackers":0,"--blocking":0,"--ads":0,"--base":1};state={adBlockingEnabled:!1,trackerBlockingEnabled:!1,isBlockingAds:!1,isBlockingTrackers:!1,blockedTrackerList:void 0,blockedAdList:void 0,showBlockedTrackers:!1,showBlockedAds:!1,popupOpen:!1,ruleSourceReady:!1};componentDidMount(){this._isMounted=!0,this.getRules(),this.updateSources(),this.updateBlockingState(),C.Z.contentBlocking.onStateChanged.addListener(this.getRules),C.Z.contentBlocking.onUrlsBlocked.addListener(this.updateBlocked),C.Z.contentBlocking.onExceptionsChanged.addListener(this.getRules),C.Z.contentBlocking.onRulesSourceUpdated.addListener(this.updateSources),C.Z.contentBlocking.onRuleSourceEnabled.addListener(this.updateSources),C.Z.contentBlocking.onRuleSourceDisabled.addListener(this.updateSources),s.Z.webNavigation.onCommitted.addListener(this.updateBlockingState)}componentDidUpdate(e){this.props.url!==e.url&&this.updateBlockingState()}componentWillUnmount(){this._isMounted=!1,C.Z.contentBlocking.onStateChanged.removeListener(this.getRules),C.Z.contentBlocking.onUrlsBlocked.removeListener(this.updateBlocked),C.Z.contentBlocking.onExceptionsChanged.removeListener(this.getRules),C.Z.contentBlocking.onRulesSourceUpdated.removeListener(this.updateSources),C.Z.contentBlocking.onRuleSourceEnabled.removeListener(this.updateSources),C.Z.contentBlocking.onRuleSourceDisabled.removeListener(this.updateSources),s.Z.webNavigation.onCommitted.removeListener(this.updateBlockingState)}getRules=()=>yS.forEach((e=>(0,mS.pg)(e,(t=>{this.setState(t,(()=>this.updateException(e)))}))));getHostname=e=>{let t="";try{t=new URL(e||this.props.url).hostname}catch(e){}return t.startsWith("www.")?t.substring(4):t};getIconUrl=()=>{const{url:e}=this.props;return je.jk.getFavicon(e)??e};togglePopup=()=>this.setState((e=>({popupOpen:!e.popupOpen})));hidePopup=()=>this.setState({popupOpen:!1});showSettings=()=>{const e=this.context.vivaldiWindowId;this.togglePopup(),Ae.Z.showSettings(e,"privacy",{scroll:"tracker_and_ad_blocking"})};getActiveExceptionList=e=>{const t="tracking"===e?"trackerBlockingEnabled":"adBlockingEnabled";return this.state[t]?"exempt_list":"process_list"};updateBlockingState=()=>{yS.map((e=>this.updateException(e))),yS.map((e=>this.updateBlocked(e,[this.props.pageId])))};updateException=e=>C.Z.contentBlocking.isExemptOfFiltering(e,this.props.url,(t=>{this._isMounted&&("tracking"===e?this.setState({isBlockingTrackers:!t}):this.setState({isBlockingAds:!t}))}));updateSources=()=>yS.forEach((e=>{C.Z.contentBlocking.getRuleSources(e,(e=>{this._isMounted&&(e.find((e=>""!==e.rules_list_checksum))?this.setState({ruleSourceReady:!0}):this.setState({ruleSourceReady:!1}))}))}));updateBlocked=(0,oS.Z)(((e,t)=>{const n="tracking"===e?"blockedTrackerList":"blockedAdList";t.includes(this.props.pageId)&&C.Z.contentBlocking.getBlockedUrlsInfo(e,[this.props.pageId],(e=>{this._isMounted&&this.setState({[n]:e[0]})}))}),500);setPageBlocking=e=>{const t=e.currentTarget.value,n=0+(this.state.trackerBlockingEnabled?1:0)+(this.state.adBlockingEnabled?1:0),s=this.getHostname();(0,mS.fs)(s,t,this.props.pageId,n)};handleExpandClick=(e,t)=>{t.preventDefault(),"tracking"===e?this.setState((e=>({showBlockedTrackers:!e.showBlockedTrackers}))):this.setState((e=>({showBlockedAds:!e.showBlockedAds})))};renderBlocked=e=>{if(!this.props.blockerVisible)return null;if(!(this.state.showBlockedTrackers&&"tracking"===e||this.state.showBlockedAds&&"ad_blocking"===e))return null;const t="tracking"===e?this.state.blockedTrackerList:this.state.blockedAdList;if(!t)return null;const n=t.blocked_urls_info.slice(0).reduce(((e,t)=>{const n=this.getHostname(t.url);return e[n]=(e[n]||0)+t.blocked_count,e}),{});for(const e of t.blocked_trackers_info){const t=e.domain;n[t]=(n[t]||0)+e.blocked_count}return(0,fs.jsxs)(fs.Fragment,{children:[vS("h3",{},void 0,"tracking"===e?(0,Oe.Z)("Tracker detail","Tracker details",[t.total_blocked_count]):(0,Oe.Z)("Ad detail","Ad details",[t.total_blocked_count])),vS("ul",{},void 0,Object.keys(n).sort(((e,t)=>n[e]>n[t]?-1:1)).map((e=>vS("li",{},e,vS("span",{},void 0,e),vS("span",{},void 0,n[e])))))]})};getButtonStyle=(e,t,n,s,i,o)=>({"--base":t&&0===n?0:1,"--no-blocking":!e&&t&&0===n?1:0,"--trackers":t&&1===n&&!o?1:0,"--ads":t&&2===n&&!o?1:0,"--blocking":o>100?1:0,"--total":o});openPrivacyStatisticsDialog(){this.hidePopup(),Ae.Z.showPrivacyStatsDialog(this.context.vivaldiWindowId)}getCurrentLevel=()=>{const{isBlockingTrackers:e,isBlockingAds:t}=this.state;return(e?1:0)+(t?1:0)};handleReportButton=()=>{const e=this.getCurrentLevel()?"AdBlock":"TrackerBlock",t=encodeURIComponent(this.getHostname()),n=["https://vivaldi.com/bugreport/?project=VB&&type=normal",`&bugUrl=${t}`,`&summary=%5B${e}%5D+Site+issue+on+${t}`].join("");d.ZP.openURL(this.context.vivaldiWindowId,n),this.hidePopup()};render(){const{ruleSourceReady:e,trackerBlockingEnabled:t,isBlockingTrackers:n,blockedTrackerList:s,adBlockingEnabled:i,isBlockingAds:o,blockedAdList:a}=this.state,{blockerVisible:r,tabIndex:l}=this.props,d=0+(t?1:0)+(i?1:0),c=this.getCurrentLevel(),p=s||a,u=s?.total_blocked_count??0,g=a?.total_blocked_count??0,m=u+g;return vS(Fa,{buttonStyle:this.getButtonStyle(Boolean(p),r,c,n,o,m),tooltip:(0,Oe.Z)("Content Blocker")+(e&&n?h.YV+(0,Oe.Z)("Tracker Blocking Active"):"")+(o&&e?h.YV+(0,Oe.Z)("Ad Blocking Active"):"")+(e?"":h.YV+(0,Oe.Z)("Blocking is inactive due to missing or disabled rule lists")),onClick:this.togglePopup,image:Ts.Tu3,hidePopup:this.hidePopup,popupPosition:this.props.position,popupWidth:300,popupClassName:"ContentBlocker ToolbarButtonPopup-DefaultStyles",className:"ContentBlocker-Control",isPopupVisible:this.state.popupOpen,badgeText:m>0&&m<100?m.toString():void 0},void 0,vS("div",{className:"ContentBlocker-Header"},void 0,vS("div",{className:"favicon"},void 0,vS(Ss,{url:this.getIconUrl(),loadType:"page"})),vS("div",{},void 0,r?(0,Oe.Z)("Blocking Level on"):(0,Oe.Z)("Content Blocker"),CS,r?vS("strong",{},void 0,this.getHostname()):null)),vS("div",{className:"dialog-content"},void 0,r&&vS("div",{className:"ContentBlocker-Field"},void 0,vS("button",{tabIndex:l,className:As()({"ContentBlocker-Label":!0,"ContentBlocker-Label--Active":0===c}),value:"0",onClick:this.setPageBlocking},void 0,vS("span",{className:"ContentBlocker-Label-Icon",dangerouslySetInnerHTML:{__html:Ts.Tu3},style:{"--no-blocking":1,"--base":0}}),vS("span",{className:"ContentBlocker-Label-Text"},void 0,(0,Oe.Z)("No Blocking"),0===d&&wS)),vS("button",{tabIndex:l,className:As()({"ContentBlocker-Label":!0,"ContentBlocker-Label--Active":1===c}),value:"1",onClick:this.setPageBlocking},void 0,vS("span",{className:"ContentBlocker-Label-Icon",style:{"--trackers":"1"},dangerouslySetInnerHTML:{__html:Ts.Tu3}}),vS("span",{className:"ContentBlocker-Label-Text"},void 0,(0,Oe.Z)("Block Trackers"),1===d&&bS)),vS("button",{tabIndex:l,className:As()({"ContentBlocker-Label":!0,"ContentBlocker-Label--Active":2===c}),value:"2",onClick:this.setPageBlocking},void 0,vS("span",{className:"ContentBlocker-Label-Icon",style:{"--ads":"1"},dangerouslySetInnerHTML:{__html:Ts.Tu3}}),vS("span",{className:"ContentBlocker-Label-Text"},void 0,(0,Oe.Z)("Block Trackers and Ads"),2===d&&SS))),p&&(0,fs.jsxs)(fs.Fragment,{children:[vS("div",{className:"ContentBlocker-Counter"},void 0,n&&vS("div",{className:"ContentBlocker-Counter--Block",onClick:this.handleExpandClick.bind(null,"tracking")},void 0,vS("div",{className:"ContentBlocker-Counter--Number"},void 0,vS("p",{},void 0,u)),vS("p",{},void 0,(0,Oe.Z)("Tracker Blocked","Trackers Blocked",[u]))),o&&vS("div",{className:"ContentBlocker-Counter--Block",onClick:this.handleExpandClick.bind(null,"ad_blocking")},void 0,vS("div",{className:"ContentBlocker-Counter--Number"},void 0,vS("p",{},void 0,g)),vS("p",{},void 0,(0,Oe.Z)("Ad Blocked","Ads Blocked",[g])))),vS("div",{className:"ContentBlocker-Blocked"},void 0,s&&this.renderBlocked("tracking"),a&&this.renderBlocked("ad_blocking"))]}),r&&p&&(n||o)&&vS("div",{className:"ContentBlocker-Counter--Information"},void 0,vS("div",{className:"info-text"},void 0,vS("p",{},void 0,(0,Oe.Z)("If the page appears broken, try turning off blocking and extensions.")),vS("p",{},void 0,vS("a",{href:"",onClick:this.handleReportButton},void 0,(0,Oe.Z)("Report a page problem.")))))),vS("div",{className:"ContentBlocker-Field"},void 0,vS("button",{className:"privacy-btn-icon",onClick:()=>this.openPrivacyStatisticsDialog(),title:(0,Oe.Z)("Show Privacy Statistics"),dangerouslySetInnerHTML:{__html:Ts.vh3+(0,Oe.Z)("Show privacy Statistics")}}),vS("input",{type:"button",onClick:this.showSettings,value:(0,Oe.Z)("Manage Default Settings"),autoFocus:0===l})))}}const kS=IS,AS={totalElements:0,loadedElements:0,loadedBytes:0,progress:0,url:""};class TS extends Ol.Z{_progressInfo=new te.D5;getProgressInfo(e){const t=this._progressInfo.get(e);if(t)return t}emitChange=(0,oS.Z)((()=>{super.emitChange()}),250);dispatchAction(e){switch(e.actionType){case"NAVIGATION_SET_STATE":{const{pageId:t,navigationState:n}=e;if("stop"!==n.trigger&&"abort"!==n.trigger)break;const s=this._progressInfo;this._progressInfo=this._progressInfo.set(t,AS),s!==this._progressInfo&&this.emitChange();break}case"PAGE_SET_PROGRESS":{const{pageId:t,progressState:n}=e;this._setProgressState(n,t);break}case"PAGE_CLOSE":this._removeProgressState(e.pages)}}_setProgressState(e,t){const n=this._progressInfo.get(t);e!==n&&(n&&(e.progress<n.progress&&(e={...e,progress:n.progress}),void 0===e.totalElements&&(e={...e,totalElements:n.totalElements}),void 0===e.loadedElements&&(e={...e,loadedElements:n.loadedElements})),this._progressInfo=this._progressInfo.set(t,e),this.emitChange())}_removeProgressState(e){e.forEach((e=>{this._progressInfo.has(e.id)&&(this._progressInfo=this._progressInfo.remove(e.id),this.emitChange())}))}}const ZS=new TS(y.Z);var ES;function _S(e,t,n,s){ES||(ES="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:ES,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const MS={bytes:0,bytesDisplayed:0,currentPageId:null,elLoaded:0,elLoadedDisplayed:0,elTotal:0,isProgressing:!1,isStarted:!1,progress:0,stopped:!1,pageloadTicker:""},NS=[$.kAddressBarShowProgress,$.kThemeUseAnimation];class PS extends hs.PureComponent{static contextType=xi.Z;_isMounted=!1;state=MS;componentDidMount(){this._isMounted=!0,oy.addListener(this._onNavigationStoreChanged,(e=>e.get(this.props.pageId)?.navigationInfo.trigger)),ZS.addListener(this._onProgressStateStoreChanged),qa.Z.addListener(this._onWebpageviewStoreChanged)}componentWillUnmount(){clearTimeout(this._updateTimer),this._isMounted=!1,oy.removeListener(this._onNavigationStoreChanged),ZS.removeListener(this._onProgressStateStoreChanged),qa.Z.removeListener(this._onWebpageviewStoreChanged)}componentDidUpdate(e,t){const n=this.props.pageId;if(n!==t.currentPageId){const e=ZS.getProgressInfo(this.props.pageId),{progress:t=0,loadedBytes:s=0,loadedElements:i=0,totalElements:o=0}=e||{};let a={};a=0===t||1===t||void 0===t?{...MS,currentPageId:n}:{...MS,currentPageId:n,progress:t,bytes:s,elLoaded:i,elTotal:o},this._onUpdateProgressState(a)}}_onUpdateProgressState=e=>{this.setState(e)};_onNavigationStoreChanged=()=>{this._onProgressStateStoreChanged()};_onProgressStateStoreChanged=()=>{const e=this.props.pageId,t=ie.ZP.getPageById(e);if(t){const e=t.url;if((0,vs.xl)(e))return}const n=ZS.getProgressInfo(e),{trigger:s}=oy.getNavigationInfo(e),{progress:i=0,loadedBytes:o=0,loadedElements:a=0,totalElements:r=0}=n||{};"start"===s?this.setState({...MS,currentPageId:e,isProgressing:!0,isStarted:!0}):"stop"===s?this.setState((e=>({isProgressing:!1,...e.stopped&&{}||{progress:1}}))):"commit"!==s||this.state.stopped||(this.setState({bytes:o,elLoaded:a,elTotal:r,isProgressing:!0,isStarted:!0,progress:i}),this.updateCount())};_onWebpageviewStoreChanged=e=>{e.pageId===this.props.pageId&&"WEBPAGEVIEW_STOP"===e.type&&1!==this.state.progress&&this.setState({isProgressing:!1,stopped:!0})};getIncrement=(e,t)=>{const n=t-e;let s=0;return n>10?s=Math.floor(n/5):n>4?s=2:n>0&&(s=1),e+s};updateCount=()=>{if(clearTimeout(this._updateTimer),!this._isMounted)return;const e=this.state.bytes,t=this.state.bytesDisplayed,n=this.state.elLoadedDisplayed;let s=this.state.elLoaded;1===this.state.progress&&s<this.state.elTotal&&(s=this.state.elTotal);const i=this.getIncrement(t,e),o=this.getIncrement(n,s);!1===this.props.prefValues[$.kThemeUseAnimation]?this.setState({elLoadedDisplayed:s,bytesDisplayed:e}):(s>n&&this.setState({elLoadedDisplayed:o}),e>t&&this.setState({bytesDisplayed:i}),!this.state.stopped&&(s>o||e>i)&&(this._updateTimer=setTimeout(this.updateCount,80)));const a=fd(e,e>1048576?1:0);e>0&&this.setState({pageloadTicker:a})};render(){if(!this.props.open||isNaN(this.state.progress))return null;const e=this.state.progress,t=this.state.elLoadedDisplayed,n=this.state.elTotal,s=this.state.isProgressing,i=this.state.isStarted,o=!0===this.state.stopped;return _S("div",{className:As()({pageload:!0,unstarted:!i,progressing:s,"progress-done":1===e||o,stopped:o})},void 0,this.props.prefValues[$.kAddressBarShowProgress]&&_S("progress",{className:"pageload-indicator",value:100*this.state.progress,max:100}),_S("div",{className:"pageload-ticker"},void 0,this.state.pageloadTicker),_S("div",{className:"pageload-ticker"},void 0,t+"/"+n))}}const DS=sa(PS,NS);var xS;function OS(e,t,n,s){xS||(xS="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:xS,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const LS=({onDialogClosed:e,onChange:t})=>(0,fs.jsxs)(fs.Fragment,{children:[OS("input",{type:"button",className:"primary",onClick:e,value:(0,Oe.Z)("OK"),autoFocus:!0}),OS("input",{type:"button",onClick:t,value:(0,Oe.Z)("Change")})]});var RS;function BS(e,t,n,s){RS||(RS="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:RS,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const FS=Cd("input");class VS extends hs.PureComponent{allow=()=>{this.props.onPermissionClicked(!1)};deny=()=>{this.props.onPermissionClicked(!0)};renderAllowDenyQuery=()=>{const e=this.props.renderNotice?this.props.renderNotice():null;return(0,fs.jsxs)(fs.Fragment,{children:[e,BS(FS,{type:"button",onClick:this.allow,value:(0,Oe.Z)("command","Allow")}),BS("input",{type:"button",className:"primary",onClick:this.deny,value:(0,Oe.Z)("Deny"),autoFocus:!0})]})};render(){return BS("section",{className:"addressfield-popup"},void 0,BS("header",{className:"addressfield-popup-header"},void 0,this.props.image&&BS("span",{dangerouslySetInnerHTML:{__html:this.props.image}}),BS("h1",{},void 0,this.props.message)),BS("section",{className:"dialog-footer"},void 0,!1===this.props.isDecided?this.renderAllowDenyQuery():BS(LS,{onDialogClosed:this.props.onDialogClosed,onChange:this.props.onSettingsClicked})))}}const WS=VS;var US=n(60203);const HS={Allow:(0,Oe.Z)("permission","Allow"),Ask:(0,Oe.Z)("permission","Ask"),"Augmented Reality":(0,Oe.Z)("Augmented Reality"),"Automatic Downloads":(0,Oe.Z)("Automatic Downloads"),Autoplay:(0,Oe.Z)("Autoplay"),"Background Synchronization":(0,Oe.Z)("Background Synchronization"),Block:(0,Oe.Z)("permission","Block"),"Bluetooth Devices":(0,Oe.Z)("Bluetooth Devices"),Camera:(0,Oe.Z)("Camera"),Clipboard:(0,Oe.Z)("Clipboard"),Cookies:(0,Oe.Z)("Cookies"),"File Editing":(0,Oe.Z)("File Editing"),Fonts:(0,Oe.Z)("Fonts"),Geolocation:(0,Oe.Z)("Geolocation"),"Global Permissions":(0,Oe.Z)("Global Permissions"),"Global Website Permissions":(0,Oe.Z)("Global Website Permissions"),"HID Devices":(0,Oe.Z)("HID Devices"),"Idle Detection":(0,Oe.Z)("Idle Detection"),Images:(0,Oe.Z)("Images"),"Intrusive Ads":(0,Oe.Z)("Intrusive Ads"),JavaScript:(0,Oe.Z)("JavaScript"),Microphone:(0,Oe.Z)("Microphone"),"MIDI Devices":(0,Oe.Z)("MIDI Devices"),"Motion Sensors":(0,Oe.Z)("Motion Sensors"),Notifications:(0,Oe.Z)("Notifications"),"Payment Handlers":(0,Oe.Z)("Payment Handlers"),Popups:(0,Oe.Z)("Popups"),"Reset Global Permissions":(0,Oe.Z)("Reset Global Permissions"),"Serial Ports":(0,Oe.Z)("Serial Ports"),"Session Only":(0,Oe.Z)("permission","Session Only"),Sound:(0,Oe.Z)("Sound"),"Third-Party Sign-in":(0,Oe.Z)("Third-Party Sign-in"),"USB Devices":(0,Oe.Z)("USB Devices"),"Virtual Reality":(0,Oe.Z)("Virtual Reality"),"Website Permissions":(0,Oe.Z)("Website Permissions"),"Window Management":(0,Oe.Z)("Window Management")},zS={autoplay:{label:HS.Autoplay,description:"Audio and video may play automatically",icon:Ts.S_k,path:"autoplay",exceptions:{ask:!0},default:"allow"},location:{label:HS.Geolocation,icon:Ts.awi.small,path:"geolocation",default:"ask"},"media-stream-camera":{label:HS.Camera,icon:Ts.TVZ.small,path:"media_stream_camera",exceptions:{allow:!0},default:"ask"},"media-stream-mic":{label:HS.Microphone,icon:Ts.nl.small,path:"media_stream_mic",exceptions:{allow:!0},default:"ask"},sensors:{label:HS["Motion Sensors"],icon:Ts.Y_k.small,path:"sensors",exceptions:{ask:!0},default:"allow"},notifications:{label:HS.Notifications,icon:Ts.nlo.small,path:"notifications",default:"ask"},javascript:{label:HS.JavaScript,icon:Ts.qR,path:"javascript",exceptions:{ask:!0},default:"allow"},images:{label:HS.Images,icon:Ts.svj,path:"images",exceptions:{ask:!0},default:"allow"},popups:{label:HS.Popups,icon:Ts.E2S,path:"popups",exceptions:{ask:!0},default:"block"},ads:{label:HS["Intrusive Ads"],icon:Ts.nY6.small,path:"subresource_filter",default:"block"},"multiple-automatic-downloads":{label:HS["Automatic Downloads"],icon:Ts.jLt,path:"automatic_downloads",default:"ask"},sound:{label:HS.Sound,icon:Ts.oG,path:"sound",exceptions:{ask:!0},default:"allow"},"bluetooth-scanning":{label:HS["Bluetooth Devices"],icon:Ts.DDW,path:"bluetooth_scanning",exceptions:{allow:!0},default:"ask"},"midi-sysex":{label:HS["MIDI Devices"],icon:Ts.Nek.small,path:"midi_sysex",default:"ask"},"idle-detection":{label:HS["Idle Detection"],icon:Ts.Erb,path:"idle_detection",default:"block"},"background-sync":{label:HS["Background Synchronization"],icon:Ts.jBF,path:"background_sync",exceptions:{ask:!0},default:"allow"},"usb-devices":{label:HS["USB Devices"],icon:Ts.O$M,path:"usb_guard",default:"ask"},"serial-ports":{label:HS["Serial Ports"],icon:Ts.MU4,path:"serial_guard",default:"ask"},"file-system-write":{label:HS["File Editing"],icon:Ts.fSD,path:"file_system_write_guard",default:"ask"},"hid-devices":{label:HS["HID Devices"],icon:Ts.YPt,path:"hid_guard",default:"ask"},clipboard:{label:HS.Clipboard,icon:Ts.Ofb,path:"clipboard",default:"ask"},"payment-handler":{label:HS["Payment Handlers"],icon:Ts.lqP,path:"payment_handler",exceptions:{ask:!0},default:"allow"},ar:{label:HS["Augmented Reality"],icon:Ts.nzH,path:"ar",default:"ask"},vr:{label:HS["Virtual Reality"],icon:Ts.nzH,path:"vr",default:"ask"},"federated-identity-api":{label:HS["Third-Party Sign-in"],icon:Ts.K08,path:"webid_api",default:"allow"},"window-placement":{label:HS["Window Management"],icon:Ts.tRc,path:"window_placement",default:"ask"},"local-fonts":{label:HS.Fonts,icon:Ts.saO,path:"local_fonts",default:"ask"},cookies:{label:HS.Cookies,icon:Ts.MEU,path:"cookies",default:"ask"}};var GS;function $S(e,t,n,s){GS||(GS="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:GS,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function KS(e){const t=Object.keys(zS).find((t=>zS[t].path===e));return t?zS[t].icon:""}class jS extends hs.PureComponent{changePermission=e=>{const{name:t,value:n}=e.target;C.Z.utilities.setDefaultContentSettings(t,n,(()=>this.props.reloadPermissions()))};resetToDefaults=()=>{Object.keys(zS).forEach((e=>{C.Z.utilities.setDefaultContentSettings(e,zS[e].default,Aa.Z)})),this.props.reloadPermissions()};render(){const{filter:e,permissionList:t}=this.props;return $S(US.Z,{filter:e},void 0,$S("div",{className:"detail"},void 0,$S("div",{className:"detail-content"},void 0,$S("h3",{},void 0,HS["Global Website Permissions"]),t&&Object.keys(t).map((e=>$S("label",{tooltip:zS[e].description??void 0},e,$S("span",{className:"icon",dangerouslySetInnerHTML:{__html:zS[e].icon}}),$S("span",{},void 0,zS[e].label),$S("select",{value:t[e],onChange:this.changePermission,name:e},void 0,!zS[e].exceptions?.allow&&$S("option",{value:"allow"},void 0,HS.Allow),!zS[e].exceptions?.ask&&"cookies"!==e&&$S("option",{value:"ask"},void 0,HS.Ask),"cookies"===e&&$S("option",{value:"session_only"},void 0,HS["Session Only"]),$S("option",{value:"block"},void 0,HS.Block)))))),$S("div",{className:"setting-single"},void 0,$S("input",{type:"button",value:HS["Reset Global Permissions"],onClick:this.resetToDefaults}))))}}const YS=jS;var XS;function QS(e,t,n,s){XS||(XS="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:XS,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function qS(e){switch(e){case"camera":case"microphone_and_camera":case"videocapture":return KS("media_stream_camera");case"location":return KS("geolocation");case"audiocapture":case"microphone":return KS("media_stream_mic");case"backgroundsync":return KS("background_sync");case"midi-sysex":return KS("midi_sysex");case"pushmessaging":return KS("notifications");case"protocol_handling":return Ts.mU8.small;default:return KS(e)}}class JS extends hs.PureComponent{static contextType=xi.Z;state={isDialogOpen:"undecided"===this.props.permission.state&&!this.props.permission?.suppressedPrompt,icon:qS(this.props.permissionType)};onNotificatorClicked=()=>{this.setState((e=>({isDialogOpen:!e.isDialogOpen})))};onDialogClosed=()=>{const{permissionType:e,permission:t}=this.props;"protocol_handling"===e&&"undecided"===t.state&&this.onPermissionClicked(!0),this.setState({isDialogOpen:!1})};onPermissionClicked=e=>{const t=this.props.permission.requestEvent;if(t){!1===e?t.allow():t.deny();const n=this.props.permissionType;n&&aS.Z.setPermission(this.props.pageId,this.props.origin,n,t,e?"blocked":"allowed")}this.onDialogClosed()};onSettingsClicked=()=>{Ae.Z.showSettings(this.context.vivaldiWindowId,"privacy",{scroll:"permissions"}),this.onDialogClosed()};getMessageText=()=>{const e="blocked"===this.props.permission.state,t="undecided"!==this.props.permission.state,n=this.props.origin,s=this.props.permission?.promptPermission,i=this.props.permissionType;if(!i)return"";if(t)if(e)switch(i){case"location":case"geolocation":return(0,Oe.Z)("Website “$1” has been denied location access.",[n]);case"notifications":return(0,Oe.Z)("Website “$1” has been denied showing notifications.",[n]);case"camera":case"videocapture":return(0,Oe.Z)("Website “$1” has been denied access to your camera.",[n]);case"audiocapture":case"microphone":return(0,Oe.Z)("Website “$1” has been denied access to your microphone.",[n]);case"microphone_and_camera":return(0,Oe.Z)("Website “$1” has been denied access to your microphone and camera.",[n]);case"sensors":return(0,Oe.Z)("Website “$1” has been denied access to motion sensors.",[n]);case"midi-sysex":return(0,Oe.Z)("Website “$1” has been denied access to MIDI devices.",[n]);case"protocol_handling":return(0,Oe.Z)("Website “$1” has been denied access to protocol handling.",[n])}else switch(i){case"location":case"geolocation":return(0,Oe.Z)("Website “$1” is accessing your location.",[n]);case"notifications":return(0,Oe.Z)("Website “$1” is authorized to show notifications.",[n]);case"camera":case"videocapture":return(0,Oe.Z)("Website “$1” is using your camera.",[n]);case"audiocapture":case"microphone":return(0,Oe.Z)("Website “$1” is recording with your microphone.",[n]);case"microphone_and_camera":return(0,Oe.Z)("Website “$1” is using your microphone and camera.",[n]);case"sensors":return(0,Oe.Z)("Website “$1” is using your motion sensors.",[n]);case"midi-sysex":return(0,Oe.Z)("Website “$1” is using your MIDI devices.",[n]);case"protocol_handling":return(0,Oe.Z)("Website  “$1” is registered for protocol handling.",[n])}else switch(i){case"location":case"geolocation":return(0,Oe.Z)("Website “$1” would like to access your location.",[n]);case"notifications":return(0,Oe.Z)("Website “$1” would like to show notifications.",[n]);case"camera":case"videocapture":return(0,Oe.Z)("Website “$1” would like to use your camera.",[n]);case"audiocapture":case"microphone":return(0,Oe.Z)("Website “$1” would like to use your microphone.",[n]);case"microphone_and_camera":return(0,Oe.Z)("Website “$1” would like to use your microphone and camera.",[n]);case"sensors":return(0,Oe.Z)("Website “$1” would like to use motion sensors.",[n]);case"midi-sysex":return(0,Oe.Z)("Website “$1” would like to use MIDI devices.",[n]);case"protocol_handling":return(0,Oe.Z)("Allow “$1” to open all “$2” links?",[n,s])}return console.warn("Unknown permissiontype: "+i),i};_privacyNotice(){d.ZP.openURL(this.context.vivaldiWindowId,"https://vivaldi.com/privacy/browser/")}renderNotice=()=>"geolocation"===this.props.permissionType?QS("div",{className:"geo-notice"},void 0,QS("a",{href:"",title:(0,Oe.Z)("Vivaldi Browser Privacy Policy"),onClick:this._privacyNotice},void 0,(0,Oe.Z)("Privacy Notice"))):null;render(){const e="blocked"===this.props.permission.state,t="undecided"!==this.props.permission.state,{permissionType:n}=this.props;if(t&&"protocol_handling"===n)return null;const s={"button-addressfield":!0,"permission-popup":!0,"is-allowing":!e&&t,"is-dialog-open":this.state.isDialogOpen};return QS(Fa,{tooltip:this.getMessageText(),onClick:this.onNotificatorClicked,image:this.state.icon,popupPosition:this.props.popupPosition,hidePopup:this.onDialogClosed,isPopupVisible:this.state.isDialogOpen,className:As()(s),popupClassName:"addressfield-popup-container",popupWidth:400},void 0,QS(WS,{onPermissionClicked:this.onPermissionClicked,isDecided:t,onDialogClosed:this.onDialogClosed,onSettingsClicked:this.onSettingsClicked,image:this.state.icon,renderNotice:this.renderNotice,message:this.getMessageText()}))}}const eI=JS;var tI,nI;function sI(e,t,n,s){tI||(tI="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:tI,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class iI extends hs.PureComponent{_isPermissionUsage=e=>!e.requestEvent&&"undecided"!==e.state;mergeSortMicCamPermissions(e){const t=new Map(Array.from(e).sort((([e],[t])=>e>t?1:-1))),n=t.get("microphone"),s=t.get("camera"),i=t.get("microphone_and_camera");return n&&s&&this._isPermissionUsage(n)&&this._isPermissionUsage(s)&&!i?(t.delete("microphone"),t.delete("camera"),t.set("microphone_and_camera",n)):i&&this._isPermissionUsage(i)&&(n&&this._isPermissionUsage(n)&&t.delete("microphone"),s&&this._isPermissionUsage(s)&&t.delete("camera")),t}render(){if(!this.props.pagePermissions.size)return null;const e=[];return this.props.pagePermissions.forEach(((t,n)=>{this.mergeSortMicCamPermissions(t).forEach(((t,s)=>{e.push(sI(eI,{pageId:this.props.pageId,permission:t,origin:n,permissionType:s,popupPosition:this.props.popupPosition},s))}))})),e}}function oI(e,t,n,s){nI||(nI="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:nI,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class aI extends hs.Component{onBlockedPopupUrlClicked=(e,t)=>{t.preventDefault(),this.props.onPopupAllowed(e)};renderItem=e=>oI("a",{className:"popupblocker-blocked-page",onClick:this.onBlockedPopupUrlClicked.bind(this,e),title:e.targetUrl,href:e.targetUrl},e.targetUrl+e.timeStamp,e.targetUrl);renderItems=e=>oI("div",{className:"popupblocker-blocked-pages"},void 0,Array.from(e,(e=>this.renderItem(e))));onShouldBlockClicked=e=>{this.props.onShouldBlockClicked(e)};renderAlwaysBlockQuery=()=>oI("section",{className:"dialog-footer"},void 0,oI("label",{},void 0,oI("input",{type:"radio",name:"blocked",value:"false",defaultChecked:!1!==this.props.shouldBlockPopups,onChange:this.onShouldBlockClicked.bind(this,!0)}),(0,Oe.Z)("Block Popups")),oI("label",{},void 0,oI("input",{type:"radio",name:"blocked",value:"true",defaultChecked:!1===this.props.shouldBlockPopups,onChange:this.onShouldBlockClicked.bind(this,!1)}),(0,Oe.Z)("Always Allow")));render(){return this.props.blockedPopups.size>0?oI("div",{tabIndex:"0",className:"addressfield-popup"},void 0,oI("header",{className:"addressfield-popup-header"},void 0,this.props.image&&oI("span",{dangerouslySetInnerHTML:{__html:this.props.image}}),oI("h1",{},void 0,(0,Oe.Z)("Blocked Popup Pages"))),oI("div",{className:"addressfield-popup-content"},void 0,this.renderItems(this.props.blockedPopups)),this.renderAlwaysBlockQuery()):null}}const rI=aI;var lI;function dI(e,t,n,s){lI||(lI="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:lI,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class cI extends hs.Component{state={isDialogOpen:!1,shouldBlockPopups:!0};componentDidMount(){this.props.url&&s.Z.contentSettings.popups.get({primaryUrl:this.props.url},(e=>{s.Z.runtime.lastError&&s.Z.runtime.lastError.message&&console.warn("ERROR getting content settings for popups. Original message:\n"+s.Z.runtime.lastError.message)}))}onNotificatorClicked=()=>{this.setState((e=>({isDialogOpen:!e.isDialogOpen})))};onDialogClosed=()=>{this.setState({isDialogOpen:!1})};onShouldBlockClicked=e=>{const t={primary_pattern:this.props.url,secondary_pattern:this.props.url,type:"popups",setting:e?"block":"allow"};C.Z.settings.setContentSetting(t),this.setState({shouldBlockPopups:e})};render(){var e={"button-addressfield":!0,"permission-popup":!0,"is-blocking":!0===this.state.shouldBlockPopups,"is-allowing":!1===this.state.shouldBlockPopups,"is-dialog-open":this.state.isDialogOpen};return dI("div",{className:"button-toolbar"},void 0,dI(Fa,{tooltip:(0,Oe.Z)("Blocked Popup Pages"),onClick:this.onNotificatorClicked,image:Ts.nY6.small,popupPosition:this.props.popupPosition,hidePopup:this.onDialogClosed,isPopupVisible:this.state.isDialogOpen,className:As()(e),popupClassName:"addressfield-popup-container",popupWidth:300},void 0,dI(rI,{image:Ts.nY6.medium,shouldBlockPopups:this.state.shouldBlockPopups,onShouldBlockClicked:this.onShouldBlockClicked,blockedPopups:this.props.blockedPopups,onPopupAllowed:this.props.onPopupAllowed})))}}const hI=cI;var pI;function uI(e,t,n,s){pI||(pI="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:pI,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class gI extends hs.PureComponent{state={popupVisible:!1};togglePopup=()=>{this.setState((e=>({popupVisible:!e.popupVisible})))};hidePopup=()=>{this.setState({popupVisible:!1})};render(){return uI(Fa,{className:"create-qr-code",image:Ts.ERJ,tooltip:(0,Oe.Z)("Share Page with QR Code"),onClick:this.togglePopup,popupPosition:this.props.popupPosition,hidePopup:this.hidePopup,isPopupVisible:this.state.popupVisible,popupClassName:"ToolbarButtonPopup-DefaultStyles",popupWidth:Xh(this.props.data),size:this.props.size},void 0,uI(qh,{hidePopup:this.hidePopup,data:this.props.data}))}}const mI=gI;class vI extends hs.PureComponent{state={remapLoading:!1};clickRef=hs.createRef();getMenuItems=()=>this.props.feeds.map((e=>{let t;return t=e.remap?{...ae.Z.makeLabelPair((0,Oe.Z)("Feed information could not be loaded")),isEnabled:()=>!1}:{...ae.Z.makeLabelPair(e.title+" - "+e.type),handler:t=>d.ZP.openURL(t.windowId,e.href)},t}));remapFeeds=()=>{this.state.remapLoading||(this.props.feeds.some((e=>e.remap))?(this.setState({remapLoading:!0}),Promise.allSettled(this.props.feeds.map((e=>e.remap?fetch(e.href).then((e=>e.ok?e.text():Promise.reject())).then((t=>{const n=(new DOMParser).parseFromString(t,"text/html").querySelector('link[type="application/rss+xml"][href], link[type="application/atom+xml"][href], link[type="text/x-opml"][href], a[type="application/rss+xml"][href], a[type="application/atom+xml"][href], a[type="text/x-opml"][href]');if(!(n&&(n instanceof window.HTMLLinkElement||n instanceof window.HTMLAnchorElement)&&n.href))return Promise.reject();e.href=n.href,e.remap=!1})):Promise.resolve()))).finally((()=>{this.setState({remapLoading:!1},this.clickRef.current?.showMenu)}))):this.clickRef.current?.showMenu())};render=()=>this.props.feeds.length?(0,fs.jsx)(Fa,{ref:this.clickRef,image:this.state.remapLoading?Ts.H0I:Ts.ZU_.small,onClick:this.remapFeeds,tooltip:(0,Oe.Z)("Page offers feeds"),menu:this.getMenuItems,menuOrigin:"bottomLeft"}):null}const fI=vI;class yI extends F.Z{getInitialState(){return new Map}reduce(e,t){switch(t.actionType){case"RSS_FEEDS_FOUND":{const{tabId:n,feeds:s}=t;return new Map(e).set(n,s)}case"RSS_CLEAR_FEEDS":case"CHROME_TABS_REMOVED":{const{tabId:n}=t;if(e.has(n)){const t=new Map(e);return t.delete(n),t}return e}default:return e}}}const CI=new yI;var wI;function bI(e,t,n,s){wI||(wI="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:wI,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var SI=bI("svg",{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},void 0,bI("g",{},void 0,bI("path",{d:"M7 8C7 7.44772 7.44772 7 8 7C8.55228 7 9 7.44772 9 8V11C9 11.5523 8.55228 12 8 12C7.44772 12 7 11.5523 7 11V8Z"}),bI("path",{d:"M8 6C8.55228 6 9 5.55228 9 5C9 4.44772 8.55228 4 8 4C7.44772 4 7 4.44772 7 5C7 5.55228 7.44772 6 8 6Z"}),bI("path",{fillRule:"evenodd",d:"M15 8C15 11.866 11.866 15 8 15C4.13401 15 1 11.866 1 8C1 4.13401 4.13401 1 8 1C11.866 1 15 4.13401 15 8ZM14 8C14 11.3137 11.3137 14 8 14C4.68629 14 2 11.3137 2 8C2 4.68629 4.68629 2 8 2C11.3137 2 14 4.68629 14 8Z"}))),II=bI("svg",{width:"16",height:"16",xmlns:"http://www.w3.org/2000/svg"},void 0,bI("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 2c1.694 0 3 1.31 3 2.846V6H5V4.846C5 3.311 6.306 2 8 2ZM4 6.085V4.846C4 2.722 5.79 1 8 1s4 1.722 4 3.846V6.085A1.5 1.5 0 0 1 13 7.5v5a1.5 1.5 0 0 1-1.5 1.5h-7A1.5 1.5 0 0 1 3 12.5v-5a1.5 1.5 0 0 1 1-1.415ZM4.5 7a.5.5 0 0 0-.5.5v5a.5.5 0 0 0 .5.5h7a.5.5 0 0 0 .5-.5v-5a.5.5 0 0 0-.5-.5h-7Z",fill:"currentColor"}),bI("path",{opacity:".1",d:"M8 7h3.5a.5.5 0 0 1 .5.5v5a.5.5 0 0 1-.5.5H8V7Z",fill:"#000"})),kI=bI("svg",{width:"16",height:"16",xmlns:"http://www.w3.org/2000/svg"},void 0,bI("path",{d:"M7.118 1.654a1 1 0 0 1 1.764 0l6.334 11.875A1 1 0 0 1 14.333 15H1.667a1 1 0 0 1-.883-1.47L7.118 1.653Z",fill:"var(--colorErrorBg)"}),bI("path",{d:"M8 5a1 1 0 0 0-1 1v3a1 1 0 0 0 2 0V6a1 1 0 0 0-1-1ZM8 11a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z",fill:"var(--colorErrorFg)"})),AI=bI("svg",{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},void 0,bI("path",{d:"M10.4 5c-.4-.8 0-1.8 1-2 .7 0 1.5.4 1.6 1.2a1.4 1.4 0 0 1-.2 1l-4 7c-.3.5-.7.8-1.2.8-.6 0-1-.2-1.3-.7L3.8 7.8 2.2 5c-.5-.8 0-2 1-2 .7 0 1 .2 1.4.7l1 2 1 1.4a2 2 0 0 0 1.7 1.5 2.2 2.2 0 0 0 2.3-2V6c0-.3 0-.6-.2-1z"}));function TI({pageSecurity:e,isUrlEmpty:t}){if(t)return bI(Ss,{url:H.Z.get($.kAddressBarInlineSearchEnabled)?Ts.YvR.medium:Ts.ZuY,loadType:"faviconFromCache"});switch(e){case"web":case"warning":return SI;case"secure":return II;case"insecure":return kI;case"internal":return AI;default:return null}}function ZI(e,t){const{typedUrl:n,selectedItem:s}=yy.getUrlfieldState(t),{favIconType:i,favIconUrl:o}=function(e,t){const n=Cee(e);return n?{favIconUrl:n.faviconUrl,favIconType:"img"}:{favIconUrl:t?.faviconUrl||"",favIconType:t?.faviconType||"favicon"}}(n,s);return{favIconType:i,favIconUrl:o,isUrlEmpty:"string"==typeof n&&0===n.length||"string"!=typeof n&&0===e.length,isEditingUrl:"string"==typeof n&&n!==e,skipCache:!(null==s)&&xy(s)}}class EI extends hs.PureComponent{static contextType=xi.Z;refSiteInfoButton=hs.createRef();_popupVisible=!1;_popupVisibleOnMouseDown=!1;constructor(e,t){super(e),this.state=ZI(e.displayUrl,e.pageId)}componentDidMount(){C.Z.windowPrivate.onPageInfoPopupChanged.addListener(this.popupChanged),yy.addListener(this._onUrlFieldChanged,(e=>e.get(this.props.pageId)))}componentDidUpdate(e,t){this.props.pageId===e.pageId&&this.props.displayUrl===e.displayUrl||this._onUrlFieldChanged()}componentWillUnmount(){C.Z.windowPrivate.onPageInfoPopupChanged.removeListener(this.popupChanged),clearTimeout(this._timeoutId),yy.removeListener(this._onUrlFieldChanged)}_onUrlFieldChanged=()=>{this.setState(ZI(this.props.displayUrl,this.props.pageId))};popupChanged=(e,t)=>{e===this.context.vivaldiWindowId&&(t?this._popupVisible=!0:this._timeoutId=setTimeout((()=>{this._popupVisible=!1}),1))};doActionShowPageInfo=()=>{if(this.state.isEditingUrl)return this.props.fieldGo();Xw.Z.getActiveWebView(this.context.vivaldiWindowId)&&s.Z.windows.getCurrent({},(e=>{C.Z.zoom.getVivaldiUIZoom((t=>{const n=this.refSiteInfoButton.current;if(!n)return;const s=n.getBoundingClientRect(),{left:i=0,top:o=0}=e,a=s.left*t+i-1,r=this.props.isInternal?60:360,{screen:l}=this.context,d=(l.availHeight-(s.bottom+o)*t>r?s.bottom+6:s.top-6)*t+o,c=Xw.Z.getActiveWebView(this.context.vivaldiWindowId);c&&c.showPageInfo({top:Math.round(d),left:Math.round(a)})}))}))};getFavIconData(){return{favIconUrl:this.state.isUrlEmpty||!this.state.favIconUrl?H.Z.get($.kAddressBarInlineSearchEnabled)?Ts.YvR.medium:Ts.ZuY:this.state.favIconUrl,favIconType:this.state.isUrlEmpty||!this.state.favIconUrl||"img"===this.state.favIconType?"faviconFromCache":this.state.skipCache?"faviconSkipCache":"page"}}render(){const{vivaldiWindowId:e}=this.context,t=this.state.isEditingUrl||this.props.isInternal?"internal":"none"===(n=this.props.sslState)?"internal":"security_error"===n?"insecure":"warning"===n?"warning":"secure"===n?"secure":"web";var n;const s=this.getFavIconData();return(0,fs.jsxs)("button",{ref:this.refSiteInfoButton,className:`button-addressfield SiteInfoButton ${t}`,title:this.state.isEditingUrl?(0,Oe.Z)("Go to address"):ie.ZP.isActiveInternal(e)?null:(0,Oe.Z)("View Site Info"),onMouseDown:()=>{this._popupVisibleOnMouseDown=this._popupVisible},onClick:()=>{this._popupVisibleOnMouseDown||this.doActionShowPageInfo(),this._popupVisibleOnMouseDown=!1},draggable:this.props.draggable,onDragStart:this.props.onDragStart,tabIndex:this.props.tabIndex,children:[this.state.isEditingUrl?bI(Ss,{className:"SiteInfoButton-Favicon",url:s.favIconUrl,loadType:s.favIconType}):bI("div",{className:"SiteInfoButton-SecurityBadge"},void 0,bI(TI,{pageSecurity:t,isUrlEmpty:this.state.isUrlEmpty})),"warning"===t&&bI("span",{className:"siteinfo-text"},void 0,(0,Oe.Z)("Not Secure"))]})}}const _I=EI;var MI,NI=n(5198);function PI(e){return e.local!==e.value?e.value+" ("+e.local+")":e.value}function DI(e,t,n,s){MI||(MI="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:MI,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const xI=[$.kTranslateEnabled,$.kVivaldiTranslateLanguageList];class OI extends hs.Component{static contextType=xi.Z;constructor(e,t){super(e),this.state={languages:this._getLanguages(),sourceLang:NI.ZP.getTranslationCode(this.props.pageLanguage),targetLang:NI.ZP.getTranslationCode(this.props.targetLang),settings:{isLanguagePairOnAlwaysTranslateList:!1,isLanguageInNeverTranslateList:!1,isSiteOnNeverTranslateList:!1,shouldShowNeverTranslateShortcut:!1,shouldShowAlwaysTranslateShortcut:!0}}}componentDidMount(){this.actionPerformed_=!1,this.updateLanguageTranslateSettings()}componentDidUpdate(e){e.translateStep!==this.props.translateStep&&"after_translate"===this.props.translateStep&&this.onCancel(),e.prefValues[$.kVivaldiTranslateLanguageList]!==this.props.prefValues[$.kVivaldiTranslateLanguageList]&&this.setState({languages:this._getLanguages()}),e.targetLang!==this.props.targetLang&&this.setState({targetLang:NI.ZP.getTranslationCode(this.props.targetLang)})}componentWillUnmount(){}isLanguageSupported=()=>this.props.prefValues[$.kVivaldiTranslateLanguageList].includes(this.state.sourceLang);_getLanguages=()=>NI.ZP.getTranslationLocales().map((e=>({id:NI.ZP.getTranslationCode(e.key),name:PI(e)})));reportDialogClosing(e){this.isLanguageSupported()&&!this.props.isTranslated&&!1===this.actionPerformed_&&(C.Z.prefs.setTranslationDeclined(this.props.tabId,e,this.state.sourceLang,this.state.targetLang,(()=>{})),this.setActionPerformed())}setActionPerformed(){this.actionPerformed_=!0}updateLanguageTranslateSettings(){this.state.sourceLang&&this.state.targetLang&&C.Z.prefs.getTranslateSettings(this.props.tabId,this.state.sourceLang,this.state.targetLang,(e=>{this.setState({settings:e})}))}shouldShowAlwaysTranslateShortcut=()=>{if(!this.state.sourceLang||this.state.settings.shouldShowNeverTranslateShortcut)return!1;const e=ie.ZP.getPageById(this.props.tabId);return Boolean(e&&!e.incognito)};shouldShowNeverTranslateShortcut=()=>!(!this.state.sourceLang||this.state.settings.isLanguagePairOnAlwaysTranslateList)&&this.state.settings.shouldShowNeverTranslateShortcut;isTranslationInProgress=()=>"translating"===this.props.translateStep;onCancel=()=>{this.props.hidePopup()};onTranslate=()=>{const e=NI.ZP.getTranslationCode(this.state.targetLang),t=this.state.sourceLang?NI.ZP.getTranslationCode(this.state.sourceLang):"auto";C.Z.tabsPrivate.translatePage(this.props.tabId,t,e,(e=>{})),this.setActionPerformed()};onRevert=()=>{C.Z.tabsPrivate.revertTranslatePage(this.props.tabId,(e=>{})),this.setActionPerformed()};onTargetLanguageSelected=e=>{const{value:t}=e.currentTarget;t!==this.state.targetLang&&(NI.ZP.setTargetTranslationCode(t),this.setState({targetLang:t}))};setAlwaysTranslate=e=>{C.Z.prefs.setLanguagePairToAlwaysTranslate(this.props.tabId,e,this.state.sourceLang,this.state.targetLang,(t=>{t&&(this.updateLanguageTranslateSettings(),e&&!this.props.isTranslated&&this.onTranslate())})),this.setActionPerformed()};setNeverTranslate=e=>{C.Z.prefs.setLanguageToNeverTranslate(this.props.tabId,e,this.state.sourceLang,this.state.targetLang,(e=>{e&&this.updateLanguageTranslateSettings()})),this.setActionPerformed()};setNeverTranslateSite=e=>{C.Z.prefs.setSiteToNeverTranslate(this.props.tabId,e,this.state.sourceLang,this.state.targetLang,(t=>{t&&(this.updateLanguageTranslateSettings(),e&&this.props.isTranslated&&this.onRevert())})),this.setActionPerformed()};toggleOfferToTranslate=()=>{Ne.Z.set($.kTranslateEnabled,!this.props.prefValues[$.kTranslateEnabled]),this.setActionPerformed()};_onAlwaysTranslate=e=>{const t=e.target.checked;this.setAlwaysTranslate(t),this.setActionPerformed()};_onNeverTranslate=e=>{const t=e.target.checked;this.setNeverTranslate(t),this.setActionPerformed()};openTranslatePage=()=>{d.ZP.openURL(this.context.vivaldiWindowId,"https://www.vivaldi.com/translate/")};isError=()=>this.props.error&&"no_error"!==this.props.error;handleCloseClick=e=>{this.reportDialogClosing(!0),this.onCancel()};handleMenuClick=e=>{const t=[];t.push({...(0,xs.Z)("Always Translate $1",[NI.ZP.getHumanReadableLanguageFromCode(this.state.sourceLang)]),type:"checkbox",handler:this.setAlwaysTranslate.bind(this,!this.state.settings.isLanguagePairOnAlwaysTranslateList),checked:this.state.settings.isLanguagePairOnAlwaysTranslateList}),t.push({...(0,xs.Z)("Never Translate $1",[NI.ZP.getHumanReadableLanguageFromCode(this.state.sourceLang)]),type:"checkbox",handler:this.setNeverTranslate.bind(this,!this.state.settings.isLanguageInNeverTranslateList),checked:this.state.settings.isLanguageInNeverTranslateList}),t.push({...(0,xs.Z)("Never Translate This Site"),handler:this.setNeverTranslateSite.bind(this,!this.state.settings.isSiteOnNeverTranslateList),type:"checkbox",checked:this.state.settings.isSiteOnNeverTranslateList}),t.push({...(0,xs.Z)("Offer to Translate Pages"),type:"checkbox",handler:this.toggleOfferToTranslate.bind(this),checked:this.props.prefValues[$.kTranslateEnabled]}),(0,Qi.Z)(this.context,t)(e),e.preventDefault(),e.stopPropagation()};renderDialogHeader(){return DI("div",{className:"TranslatePopup-Header"},void 0,DI("h3",{},void 0,(0,Oe.Z)("browser","Translate Page")),this.isLanguageSupported()&&(0,fs.jsx)(fs.Fragment,{children:DI("button",{className:As()({"TranslatePopup-Header-CloseButton":!0}),title:(0,Oe.Z)("Close Dialog"),dangerouslySetInnerHTML:{__html:Ts.vyJ},onClick:this.handleCloseClick})}))}renderContent(){if(this.isTranslationInProgress())return null;if(!1===this.isLanguageSupported())return DI("div",{className:"dialog-content"},void 0,(0,Oe.Z)("Vivaldi Translate does not currently support $1 ($2).",[NI.ZP.getHumanReadableLanguageFromCode(this.state.sourceLang),this.state.sourceLang]));if(this.state.languages&&this.state.languages.length>0&&!this.props.isTranslated){const e=this.state.languages.map((e=>e.id===this.state.targetLang?DI("option",{value:e.id,defaultValue:!0},e.id,e.name):e.id!==this.state.sourceLang?DI("option",{value:e.id},e.id,e.name):void 0));return DI("div",{className:"dialog-content"},void 0,DI("label",{className:"TranslatePopup-SelectLabel"},"select",(0,Oe.Z)("To:")),DI("select",{onChange:this.onTargetLanguageSelected,disabled:!1,value:this.state.targetLang},void 0,e))}return null}renderButtons(){const e=[];if(this.isLanguageSupported()){const t=this.isTranslationInProgress();this.isError()?e.push(DI(tc,{type:"error"},"error",(0,Oe.Z)("Error translating page."))):t&&e.push(DI("label",{className:"TranslatePopup-Status"},"progress",(0,Oe.Z)("Translating..."))),this.props.isTranslated&&!t?(e.push(DI("label",{className:"TranslatePopup-Status"},"status",(0,Oe.Z)("This page has been translated to $1 ($2).",[NI.ZP.getHumanReadableLanguageFromCode(this.state.targetLang),this.state.targetLang]))),e.push(DI("div",{className:"TranslatePopup-Buttons"},"translate-buttons",DI("input",{type:"button",className:"TranslatePopup-Buttons-Revert",onClick:this.onRevert,disabled:!1,autoFocus:!0,value:(0,Oe.Z)("Revert to $1",[NI.ZP.getHumanReadableLanguageFromCode(this.state.sourceLang)])},"translate-revert")))):t||(this.shouldShowAlwaysTranslateShortcut()&&e.push(DI("label",{className:"TranslatePopup-Checkbox"},"alwaysTranslate",DI("input",{type:"checkbox",checked:this.state.settings.isLanguagePairOnAlwaysTranslateList,onChange:this._onAlwaysTranslate}),DI("span",{},void 0,(0,Oe.Z)("Always translate $1",[NI.ZP.getHumanReadableLanguageFromCode(this.state.sourceLang)])))),this.shouldShowNeverTranslateShortcut()&&e.push(DI("label",{className:"TranslatePopup-Checkbox"},"neverTranslate",DI("input",{type:"checkbox",checked:this.state.settings.isLanguageInNeverTranslateList,onChange:this._onNeverTranslate}),DI("span",{},void 0,(0,Oe.Z)("Never translate $1",[NI.ZP.getHumanReadableLanguageFromCode(this.state.sourceLang)])))),e.push(DI("div",{className:"TranslatePopup-Buttons"},"translate-buttons",DI("input",{type:"button",className:"TranslatePopup-Buttons-Translate primary",onClick:this.onTranslate,disabled:!1,value:(0,Oe.Z)("verb","Translate"),autoFocus:!0},"translate-button"),DI("button",{className:"TranslatePopup-Buttons-MenuButton",onClick:this.handleMenuClick},void 0,DI("span",{className:"TranslatePopup-Buttons-MenuButton-Span",value:"options",dangerouslySetInnerHTML:{__html:Ts.bqs.small}},"translate-menu"),DI("label",{className:"TranslatePopup-Buttons-MenuButton-Label"},void 0,(0,Oe.Z)("Options"))))))}return e}renderFooter(){return DI("footer",{className:"dialog-footer"},void 0,DI("div",{className:"TranslatePopup-FooterText"},void 0,(0,Oe.Z)("Powered by Lingvanex, hosted by Vivaldi."),DI("a",{href:"",className:"TranslatePopup-ReadMoreLink",onClick:this.openTranslatePage,title:(0,Oe.Z)("Read more about Vivaldi Translate")},void 0,(0,Oe.Z)("Learn More"))))}render(){return DI("div",{className:"TranslatePopup"},void 0,this.renderDialogHeader(),this.renderContent(),this.renderButtons(),this.renderFooter())}}const LI=sa(OI,xI);var RI,BI=n(85374);function FI(e,t,n,s){RI||(RI="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:RI,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class VI extends hs.PureComponent{constructor(e){super(e);const t=this.getStateFromStore();this.state={popupVisible:!1,pageLanguage:t.pageLanguage,isTranslated:t.isTranslated,translateStep:t.translateStep,error:"no_error",targetLang:NI.ZP.getTargetTranslationCode(),autoTranslate:!1}}componentDidMount(){BI.ZP.addListener(this._onTranslationStateStoreChanged,(e=>e.get(this.props.tabId))),H.Z.addListener([$.kTranslateTargetLanguage],this._onPrefChanged)}componentWillUnmount(){BI.ZP.removeListener(this._onTranslationStateStoreChanged),H.Z.removeListener([$.kTranslateTargetLanguage],this._onPrefChanged)}static getDerivedStateFromProps(e){const{tabId:t}=e,n=BI.ZP.getPageState(t);if(n){const e=n.pageLanguage?n.pageLanguage:"",t=Boolean(n.isTranslated),s={pageLanguage:e,isTranslated:t,error:n.error,translateStep:n.translateStep,autoTranslate:n.autoTranslate};return t&&(s.targetLang=n.translatedLang,n.originalLang&&(s.pageLanguage=n.originalLang)),s}return null}_onPrefChanged=(e,t,n)=>{if(n===$.kTranslateTargetLanguage)this.setState({targetLang:String(t)})};getStateFromStore=()=>{const e=BI.ZP.getPageState(this.props.tabId);return{pageLanguage:e.pageLanguage?e.pageLanguage:"",isTranslated:Boolean(e.isTranslated),error:e.error,translateStep:e.translateStep,autoTranslate:e.autoTranslate}};_onTranslationStateStoreChanged=()=>{const e=this.getStateFromStore();"translating"!==e.translateStep&&"before_translate"!==e.translateStep||this.state.popupVisible||e.autoTranslate?"idle"===e.translateStep&&this.hidePopup():this.showPopup(),this.setState(e)};showPopup=()=>{this.setState({popupVisible:!0})};hidePopup=()=>{this.setState({popupVisible:!1})};togglePopup=()=>{this.setState((e=>({popupVisible:!e.popupVisible})))};render(){if(!this.state.pageLanguage||this.state.targetLang===this.state.pageLanguage)return null;const e=this.state.isTranslated;return FI(Fa,{isPressed:e,isOn:e,image:Ts.IeE,tooltip:e?(0,Oe.Z)("Revert Page Translation"):(0,Oe.Z)("title","Translate Page"),onClick:this.togglePopup,popupPosition:this.props.popupPosition,hidePopup:this.hidePopup,isPopupVisible:this.state.popupVisible,size:this.props.size,popupClassName:"ToolbarButtonPopup-DefaultStyles",popupWidth:300},void 0,FI(LI,{hidePopup:this.hidePopup,tabId:this.props.tabId,isTranslated:this.state.isTranslated,pageLanguage:this.state.pageLanguage,error:this.state.error,targetLang:this.state.targetLang,translateStep:this.state.translateStep}))}}const WI=VI;const UI=function(e){if(!e)return"";const t=(0,ms.Z)(e);return t?(t.hostname&&(e=t.hostname),0===e.indexOf("www.")&&(e=e.split("www.")[1]),e.includes("/")&&(e=e.split("/")[0]),e):e};const HI=new class{setActiveWebView(e,t){y.Z.dispatch({actionType:"WEBVIEW_SET_ACTIVE",windowId:e,component:t})}clearIfActive(e,t){y.Z.dispatch({actionType:"WEBVIEW_CLEAR_IF_ACTIVE",windowId:e,component:t})}};var zI;function GI(e,t,n,s){zI||(zI="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:zI,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class $I extends hs.PureComponent{constructor(e){super(e)}onCloseClicked=()=>{C.Z.infobars.sendButtonAction(this.props.infoBar.tabId,this.props.infoBar.identifier,"dismiss")};onActionClicked=(e,t)=>{t.stopPropagation(),t.preventDefault(),C.Z.infobars.sendButtonAction(this.props.infoBar.tabId,this.props.infoBar.identifier,e)};render(){return GI("div",{className:"page-confirm-info-bar"},void 0,GI("label",{},void 0,this.props.infoBar.messageText),GI("div",{className:"infobar-controls"},void 0,this.props.infoBar.buttons.map((e=>GI("input",{type:"button",value:e.text,title:(0,Oe.Z)("Select action"),onClick:this.onActionClicked.bind(this,e.action)},e.action))),GI("span",{className:"infobar-close",value:"close",title:(0,Oe.Z)("Cancel infobar"),onMouseUp:this.onCloseClicked,dangerouslySetInnerHTML:{__html:Ts.vyJ}})))}}const KI=$I;var jI;function YI(e,t,n,s){jI||(jI="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:jI,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class XI extends hs.PureComponent{constructor(e){super(e),this.state={infoBars:(0,te.aV)()}}componentDidMount(){C.Z.infobars.onInfobarCreated.addListener(this._onInfobarCreated),C.Z.infobars.onInfobarRemoved.addListener(this._onInfobarRemoved)}componentWillUnmount(){C.Z.infobars.onInfobarRemoved.removeListener(this._onInfobarRemoved),C.Z.infobars.onInfobarCreated.removeListener(this._onInfobarCreated)}_onInfobarCreated=e=>{this.props.tabId===e.tabId&&this.setState((t=>({infoBars:t.infoBars.insert(0,e)})))};_onInfobarRemoved=(e,t)=>{this.props.tabId===e&&this.setState((e=>({infoBars:e.infoBars.filter((e=>{e.identifier}))})))};render(){return YI(hs.Fragment,{},void 0,this.state.infoBars.map((e=>YI(KI,{infoBar:e},e.identifier))))}}const QI=XI;var qI;function JI(e,t,n,s){qI||(qI="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:qI,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const ek={dialog:"handleOnJavascriptDialog"};class tk extends hs.PureComponent{refWebviewDiv=hs.createRef();refDevTools=hs.createRef();state={dialogParentElement:void 0,customData:void 0};componentDidMount(){this.webview=this.refWebviewDiv.current?.firstChild,this.attachWebviewHandlers()}componentWillUnmount(){this.removeWebviewHandlers()}handleOnJavascriptDialog=e=>{e.preventDefault(),e.dialogtype="javascript",this.showDialog(e)};showDialog=e=>{e.webview=this.webview,this.setState({dialogParentElement:this.refDevTools.current,customData:e})};handleOnCloseDialog=()=>{this.setState({dialogParentElement:null})};attachWebviewHandlers=()=>{Object.keys(ek).forEach((e=>{this.webview&&this.webview.addEventListener(e,this[ek[e]])}))};removeWebviewHandlers=()=>{Object.keys(ek).forEach((e=>{this.webview&&this.webview.removeEventListener(e,this[ek[e]])}))};render(){if("off"===this.props.dockingState)return null;const e="undocked"===this.props.dockingState||!1===this.props.undockedIsUnmounted;return JI("div",{},void 0,(0,fs.jsx)("div",{ref:this.refDevTools,className:"devtools-content",children:(0,fs.jsx)("div",{ref:this.refWebviewDiv,dangerouslySetInnerHTML:{__html:`<webview name="${String(e?"vivaldi-devtools-undocked":"vivaldi-devtools-main")}"\n                inspect_tab_id="${String(this.props.tabId)}" />`}})}),this.props.active&&this.state.dialogParentElement&&this.state.customData&&JI(ap,{customData:this.state.customData,closeDialog:this.handleOnCloseDialog}))}}const nk=tk;var sk;function ik(e,t,n,s){sk||(sk="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:sk,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class ok extends hs.PureComponent{static contextType=xi.Z;constructor(e,t){super(e),this.state={show:H.Z.get($.kShowExtensionsBanner)}}onGoClicked=()=>{d.ZP.openURL(this.context.vivaldiWindowId,"https://vvld.in/chrome-web-store")};onCloseClicked=()=>{this.setState({show:!1}),Ne.Z.set($.kShowExtensionsBanner,!1)};render(){return!this.state.show||this.props.url.indexOf("chrome://extensions")<0?null:ik("div",{className:"vivaldi-extension-banner"},void 0,ik("label",{},void 0,(0,Oe.Z)("You can install any extension from the Chrome Web Store directly to Vivaldi. Just open the web store and click “Add to Chrome” on your extension of choice.")),ik("div",{className:"controls"},void 0,ik("input",{type:"button",value:(0,Oe.Z)("Chrome Web Store"),title:(0,Oe.Z)("Open Chrome Web Store"),onClick:this.onGoClicked}),ik("span",{className:"close",value:"close",title:(0,Oe.Z)("Close"),onMouseUp:this.onCloseClicked,dangerouslySetInnerHTML:{__html:Ts.vyJ}})))}}const ak=ok;var rk,lk=n(12666);function dk(e,t,n,s){rk||(rk="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:rk,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class ck extends hs.PureComponent{static contextType=xi.Z;constructor(e){super(e),this.state={hitImage:null,justFound:!1,uiZoom:1},this._updateUIZoom()}componentDidUpdate(e){(this.props.selectionRect.top!==e.selectionRect.top||this.props.selectionRect.left!==e.selectionRect.left||this.props.selectionRect.width!==e.selectionRect.width||this.props.selectionRect.height!==e.selectionRect.height)&&this.props.selectionRect.width&&this.props.selectionRect.height&&(this._updateUIZoom(),this.setState({hitImage:null,justFound:!1}),this._getNewSelectionImage(this.props.selectionRect,this.props.tabId))}_updateUIZoom=()=>{C.Z.zoom.getVivaldiUIZoom((e=>{this.setState({uiZoom:e})}))};_getNewSelectionImage=(e,t)=>{const n=Xw.Z.getActiveWebView(this.context.vivaldiWindowId);if(!n)return;const{uiZoom:s}=this.state,i=n.getBoundingClientRect(),o={left:parseInt(i.left+e.left/s),top:parseInt(i.top+e.top/s),width:parseInt(e.width/s),height:parseInt(e.height/s)},a={windowId:this.context.vivaldiWindowId,posX:o.left,posY:o.top,width:o.width,height:o.height,saveToDisk:!1};C.Z.thumbnails.captureUI(a,((e,t)=>{e?this.setState({hitImage:t,justFound:!0}):this.resetJustFound()}))};resetJustFound=()=>{this.setState({justFound:!1})};render(){if(!this.state.hitImage)return null;const{selectionRect:e,hitOffset:t}=this.props,{uiZoom:n}=this.state,s={position:"absolute",top:parseInt(e.top/n+t),left:parseInt(e.left/n),width:parseInt(e.width),height:parseInt(e.height)};return dk(lk.ZP,{in:this.state.justFound,appear:!0,enter:!0,exit:!0,unmountOnExit:!0,onEntered:(e,t)=>this.resetJustFound(),timeout:{appear:200,enter:200,exit:200}},void 0,(e=>dk("img",{src:this.state.hitImage,style:s,className:`fip-active-hit ${e}`})))}}const hk=ck;var pk;function uk(e,t,n,s){pk||(pk="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:pk,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class gk extends hs.PureComponent{static contextType=xi.Z;_isIMEOpen=!1;refFipToolbar=hs.createRef();refInputText=hs.createRef();constructor(e){super(e),this.state=this._getStateFromStores(!1)}componentDidMount(){this.props.isActive&&qa.Z.addListener(this.onWebpageviewStoreChanged)}componentWillUnmount(){qa.Z.ensureRemovedListener(this.onWebpageviewStoreChanged)}componentDidUpdate(e){e.isActive!==this.props.isActive&&(this.props.isActive?qa.Z.addListener(this.onWebpageviewStoreChanged):qa.Z.removeListener(this.onWebpageviewStoreChanged))}onCompositionStart=()=>{this._isIMEOpen=!0};onCompositionEnd=()=>{this._isIMEOpen=!1,this.onFindInPageTextChanged()};onWebpageviewStoreChanged=e=>{if(e.pageId!==this.props.pageId)return;if("WEBPAGEVIEW_CLOSE_FIND_IN_PAGE"===e.type)return void this.setState(this._getStateFromStores(!1));const t=Xw.Z.getActiveWebView(this.context.vivaldiWindowId);if(t){switch(e.type){case"WEBPAGEVIEW_RESULTS_FROM_FIND_IN_PAGE":this.setState(this._getStateFromStores(!0));break;case"WEBPAGEVIEW_ACTIONS":"findInPage"===e.action?this.setState(this._getStateFromStores(!1),this.populateWithPageSelection):"findNextInPage"===e.action?(this.focusFindInPageInput(),this.onNextClicked()):"findPreviousInPage"===e.action&&(this.focusFindInPageInput(),this.onPreviousClicked());break;case"WEBPAGEVIEW_FOCUS_FIND_IN_PAGE":this.focusFindInPageInput()}if(this.refFipToolbar.current){const e=this.refFipToolbar.current.getBoundingClientRect().height;let n;n="richtexteditor"===t.name||"markdowneditor"===t.name?this.refFipToolbar.current?.parentElement?.parentElement?.getBoundingClientRect()?.height??e:e,this.setState({hitOffset:n})}}};populateWithPageSelection=()=>{C.Z.utilities.getSelectedText(this.props.pageId,(e=>{if(e.length>0){const t=this.refInputText.current;t&&(t.value=e.substring(0,128)),this.onFindInPageTextChanged()}this.focusFindInPageInput()}))};scrollBy=e=>{let t;t=H.Z.get($.kWebpagesSmoothScrollingEnabled)?e?()=>window.scrollBy({top:window.innerHeight,behavior:"smooth"}):()=>window.scrollBy({top:-window.innerHeight,behavior:"smooth"}):e?()=>window.scrollBy({top:window.innerHeight,behavior:"auto"}):()=>window.scrollBy({top:-window.innerHeight,behavior:"auto"}),s.Z.scripting.executeScript({target:{tabId:this.props.pageId},function:t},(()=>{s.Z.runtime.lastError}))};onKeyDown=e=>{const{ctrlKey:t,altKey:n,shiftKey:s,metaKey:i}=e,o={ctrlKey:t,altKey:n,shiftKey:s,metaKey:i};if(!(0,co.Mr)(o))switch(e.key){case"PageDown":return void this.scrollBy(!0);case"PageUp":return void this.scrollBy(!1)}"m"===e.key&&(0,co.Np)(o)&&this.onMatchCaseClicked(),"Enter"===e.key&&((0,co.Mr)(o)?this.onPreviousClicked():(0,co.Np)(o)?this.closeAndActivate():this.onNextClicked())};focusFindInPageInput=()=>{const e=this.refInputText.current;e&&(e.focus(),e.value&&e.select())};_getFindInPageText=()=>{const e=this.refInputText.current;return e?e.value:""};onMatchCaseClicked=()=>{this.props.onFindInPage(this._getFindInPageText(),!this.state.matchCase),this.setState((e=>({matchCase:!e.matchCase})))};onPreviousClicked=()=>{this.props.onFindNextInPage(this._getFindInPageText(),!0,this.state.matchCase)};onNextClicked=()=>{this.props.onFindNextInPage(this._getFindInPageText(),!1,this.state.matchCase)};onCloseClicked=()=>{Vv.Z.closeFindInPageToolbar(this.context.vivaldiWindowId,this.props.pageId)};closeAndActivate=()=>{this.onCloseClicked();const e=Xw.Z.getActiveWebView(this.context.vivaldiWindowId);e&&e.stopFinding("activate")};onFindInPageTextChanged=()=>{if(this._isIMEOpen)return;const e=this._getFindInPageText();this.state.findInPageText!==e&&(this.setState({findInPageText:e}),this.props.onFindInPage(e,this.state.matchCase))};_getStateFromStores=e=>{const t=qa.Z.getFindResultsForPage(this.props.pageId);let n={};return n=e?{...this.state,activeMatchOrdinal:t.activeMatchOrdinal,matchCase:t.matchCase||!1,numberOfMatches:t.numberOfMatches,selectionRect:t.selectionRect}:{activeMatchOrdinal:t.activeMatchOrdinal,findInPageText:t.searchText,hitOffset:0,isFindInPageToolbarOpen:t.isFindInPageToolbarOpen,matchCase:t.matchCase,numberOfMatches:t.numberOfMatches,selectionRect:t.selectionRect},n};render(){if(H.Z.get($.kThemeUseAnimation)){const e=Xw.Z.getActiveWebView(this.context.vivaldiWindowId);e&&(0!==this.state.numberOfMatches&&this.state.isFindInPageToolbarOpen?(e.style.transition="filter 100ms",e.style.filter="brightness(95%)"):e.style.filter="brightness(100%)")}return uk("div",{className:"find-in-page-wrapper"},void 0,uk(ga.Z,{classNames:"find-in-page",in:this.state.isFindInPageToolbarOpen,mountOnEnter:!0,unmountOnExit:!0,timeout:{enter:300,exit:150}},void 0,(0,fs.jsxs)("div",{ref:this.refFipToolbar,onKeyDown:this.onKeyDown,className:As()("find-in-page","toolbar","toolbar-default",{"fip-nomatches":0===this.state.numberOfMatches&&this.state.findInPageText.length>0}),tabIndex:"-1",children:[uk("span",{className:"fip-input-label"},void 0,(0,Oe.Z)("Find in Page:")),uk("div",{className:"fip-input-container toolbar toolbar-default"},void 0,(0,fs.jsx)("input",{ref:this.refInputText,type:"search",onChange:this.onFindInPageTextChanged,onCompositionStart:this.onCompositionStart,onCompositionUpdate:this.onCompositionStart,onCompositionEnd:this.onCompositionEnd,defaultValue:this.state.findInPageText}),uk("span",{className:"fip-results",style:{display:this.state.findInPageText.length>0?"inline":"none"}},void 0,(0,Oe.Z)("$1 of $2",[this.state.activeMatchOrdinal,this.state.numberOfMatches]))),uk("div",{className:"toolbar-group"},void 0,uk(Fa,{className:"button-narrow",onClick:this.onPreviousClicked,image:Ts.Whf,tooltip:(0,Oe.Z)("Previous match")}),uk(Fa,{className:"button-narrow",onClick:this.onNextClicked,image:Ts.ze0,tooltip:(0,Oe.Z)("Next match")})),uk(Fa,{onClick:this.onCloseClicked,image:Ts.vyJ,tooltip:(0,Oe.Z)("Cancel search")}),uk("label",{className:"toolbar-group"},void 0,uk("input",{type:"checkbox",checked:this.state.matchCase,onChange:this.onMatchCaseClicked}),uk("span",{className:"fip-checkbox-label"},void 0,(0,Oe.Z)("Match Case")))]})),H.Z.get($.kThemeUseAnimation)&&0!==this.state.numberOfMatches&&uk(hk,{tabId:this.props.pageId,selectionRect:this.state.selectionRect,hitOffset:this.state.hitOffset,hitText:this.state.findInPageText}))}}const mk=gk;var vk=n(93197);const fk=!1,yk={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID"},Ck={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"},wk={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"},bk={256:"ImageWidth",257:"ImageHeight",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",296:"ResolutionUnit",513:"JpegIFOffset",514:"JpegIFByteCount",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite"},Sk={ColorSpace:{0:"Unknown",1:"sRGB",65535:"Adobe RGB / ProPhoto RGB"},ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}};function Ik(e){return!!e.exifdata}function kk(e,t){function n(n){var s=function(e){var t=new DataView(e);fk;if(255!==t.getUint8(0)||216!==t.getUint8(1))return!1;var n=2,s=e.byteLength;for(;n<s;){if(255!==t.getUint8(n))return!1;if(225===t.getUint8(n+1))return Mk(t,n+4,t.getUint16(n+2));n+=2+t.getUint16(n+2)}}(n),i=function(e){var t=new DataView(e);fk;if(255!==t.getUint8(0)||216!==t.getUint8(1))return!1;var n=2,s=e.byteLength,i=function(e,t){return 56===e.getUint8(t)&&66===e.getUint8(t+1)&&73===e.getUint8(t+2)&&77===e.getUint8(t+3)&&4===e.getUint8(t+4)&&4===e.getUint8(t+5)};for(;n<s;){if(i(t,n)){var o=t.getUint8(n+7);return o%2!=0&&(o+=1),0===o&&(o=4),Tk(e,n+8+o,t.getUint16(n+6+o))}n++}}(n),o=function(e){if(!("DOMParser"in self))return;var t=new DataView(e);fk;if(255!==t.getUint8(0)||216!==t.getUint8(1))return!1;var n=2,s=e.byteLength,i=new DOMParser;for(;n<s-4;){if("http"===_k(t,n,4)){var o=n-1,a=t.getUint16(n-2)-1,r=_k(t,o,a),l=r.indexOf("xmpmeta>")+8,d=(r=r.substring(r.indexOf("<x:xmpmeta"),l)).indexOf("x:xmpmeta")+10;return r=r.slice(0,d)+'xmlns:Iptc4xmpCore="http://iptc.org/std/Iptc4xmpCore/1.0/xmlns/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:tiff="http://ns.adobe.com/tiff/1.0/" xmlns:plus="http://schemas.android.com/apk/lib/com.google.android.gms.plus" xmlns:ext="http://www.gettyimages.com/xsltExtension/1.0" xmlns:exif="http://ns.adobe.com/exif/1.0/" xmlns:stEvt="http://ns.adobe.com/xap/1.0/sType/ResourceEvent#" xmlns:stRef="http://ns.adobe.com/xap/1.0/sType/ResourceRef#" xmlns:crs="http://ns.adobe.com/camera-raw-settings/1.0/" xmlns:xapGImg="http://ns.adobe.com/xap/1.0/g/img/" xmlns:Iptc4xmpExt="http://iptc.org/std/Iptc4xmpExt/2008-02-29/" '+r.slice(d),Pk(i.parseFromString(r,"text/xml"))}n++}}(n);e.exifdata=s||{},e.iptcdata=i||{},e.xmpdata=o||{},t&&t.call(e)}if(e.src)if(/^data\:/i.test(e.src))n(function(e,t){t=t||e.match(/^data\:([^\;]+)\;base64,/im)[1]||"",e=e.replace(/^data\:([^\;]+)\;base64,/gim,"");for(var n=atob(e),s=n.length,i=new ArrayBuffer(s),o=new Uint8Array(i),a=0;a<s;a++)o[a]=n.charCodeAt(a);return i}(e.src));else if(/^blob\:/i.test(e.src)){const t=new FileReader;t.onload=function(e){n(e.target.result)},function(e,t){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="blob",n.onload=function(e){200!==this.status&&0!==this.status||t(this.response)},n.send()}(e.src,(e=>{t.readAsArrayBuffer(e)}))}else{var s=new XMLHttpRequest;s.onload=function(){if(200!==this.status&&0!==this.status)throw"Could not load image";n(s.response),s=null},s.open("GET",e.src,!0),s.responseType="arraybuffer",s.send(null)}else if(self.FileReader&&(e instanceof self.Blob||e instanceof self.File)){const t=new FileReader;t.onload=function(e){n(e.target.result)},t.readAsArrayBuffer(e)}}const Ak={120:"caption",110:"credit",25:"keywords",55:"dateCreated",80:"byline",85:"bylineTitle",122:"captionWriter",105:"headline",116:"copyright",15:"category"};function Tk(e,t,n){for(var s,i,o,a,r=new DataView(e),l={},d=t;d<t+n;)28===r.getUint8(d)&&2===r.getUint8(d+1)&&(a=r.getUint8(d+2))in Ak&&(o=r.getInt16(d+3),i=Ak[a],s=_k(r,d+5,o),l.hasOwnProperty(i)?l[i]instanceof Array?l[i].push(s):l[i]=[l[i],s]:l[i]=s),d++;return l}function Zk(e,t,n,s,i){var o,a=e.getUint16(n,!i),r={};for(let l=0;l<a;l++)o=n+12*l+2,r[s[e.getUint16(o,!i)]]=Ek(e,o,t,n,i);return r}function Ek(e,t,n,s,i){var o,a,r,l,d,c,h=e.getUint16(t+2,!i),p=e.getUint32(t+4,!i),u=e.getUint32(t+8,!i)+n;switch(h){case 1:case 7:if(1===p)return e.getUint8(t+8,!i);o=p>4?u:t+8,a=[];for(let t=0;t<p;t++)a[t]=e.getUint8(o+t);return a;case 2:return _k(e,o=p>4?u:t+8,p-1);case 3:if(1===p)return e.getUint16(t+8,!i);o=p>2?u:t+8,a=[];for(let t=0;t<p;t++)a[t]=e.getUint16(o+2*t,!i);return a;case 4:if(1===p)return e.getUint32(t+8,!i);for(a=[],l=0;l<p;l++)a[l]=e.getUint32(u+4*l,!i);return a;case 5:if(1===p)return d=e.getUint32(u,!i),c=e.getUint32(u+4,!i),(r=new Number(d/c)).numerator=d,r.denominator=c,r;a=[];for(let t=0;t<p;t++)d=e.getUint32(u+8*t,!i),c=e.getUint32(u+4+8*t,!i),a[t]=new Number(d/c),a[t].numerator=d,a[t].denominator=c;return a;case 9:if(1===p)return e.getInt32(t+8,!i);a=[];for(let t=0;t<p;t++)a[t]=e.getInt32(u+4*t,!i);return a;case 10:if(1===p)return e.getInt32(u,!i)/e.getInt32(u+4,!i);a=[];for(let t=0;t<p;t++)a[t]=e.getInt32(u+8*t,!i)/e.getInt32(u+4+8*t,!i);return a}}function _k(e,t,n){var s="";for(let i=t;i<t+n;i++)s+=String.fromCharCode(e.getUint8(i));return s}function Mk(e,t){if("Exif"!==_k(e,t,4))return!1;var n,s,i,o,a,r=t+6;if(18761===e.getUint16(r))n=!1;else{if(19789!==e.getUint16(r))return!1;n=!0}if(42!==e.getUint16(r+2,!n))return!1;var l=e.getUint32(r+4,!n);if(l<8)return!1;if((s=Zk(e,r,r+l,Ck,n)).ExifIFDPointer)for(i in o=Zk(e,r,r+s.ExifIFDPointer,yk,n)){switch(i){case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"ColorSpace":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":o[i]=Sk[i][o[i]];break;case"LightSource":const e={1:5500,2:3500,3:2700,4:5e3,9:6e3,10:6e3,11:6500,12:7100,13:5400,14:4500,15:3700};s.kelvin=e[o[i]],o[i]=Sk[i][o[i]];break;case"ExifVersion":case"FlashpixVersion":o[i]=String.fromCharCode(o[i][0],o[i][1],o[i][2],o[i][3]);break;case"ComponentsConfiguration":o[i]=Sk.Components[o[i][0]]+Sk.Components[o[i][1]]+Sk.Components[o[i][2]]+Sk.Components[o[i][3]]}s[i]=o[i]}if(s.GPSInfoIFDPointer)for(i in a=Zk(e,r,r+s.GPSInfoIFDPointer,wk,n)){if("GPSVersionID"===i)a[i]=a[i][0]+"."+a[i][1]+"."+a[i][2]+"."+a[i][3];s[i]=a[i]}return s.thumbnail=function(e,t,n,s){var i=function(e,t,n){var s=e.getUint16(t,!n);return e.getUint32(t+2+12*s,!n)}(e,t+n,s);if(!i)return{};if(i>e.byteLength)return{};var o=Zk(e,t,t+i,bk,s);if(o.Compression)switch(o.Compression){case 6:if(o.JpegIFOffset&&o.JpegIFByteCount){var a=t+o.JpegIFOffset,r=o.JpegIFByteCount;o.blob=new Blob([new Uint8Array(e.buffer,a,r)],{type:"image/jpeg"})}break;case 1:console.log("Thumbnail image format is TIFF, which is not implemented.");break;default:console.log("Unknown thumbnail image format '%s'",o.Compression)}else 2===o.PhotometricInterpretation&&console.log("Thumbnail image format is RGB, which is not implemented.");return o}(e,r,l,n),s}function Nk(e){var t={};if(1===e.nodeType){if(e.attributes.length>0){t["@attributes"]={};for(var n=0;n<e.attributes.length;n++){var s=e.attributes.item(n);t["@attributes"][s.nodeName]=s.nodeValue}}}else if(3===e.nodeType)return e.nodeValue;if(e.hasChildNodes())for(var i=0;i<e.childNodes.length;i++){var o=e.childNodes.item(i),a=o.nodeName;if(t[a]){if(!t[a].push){var r=t[a];t[a]=[],t[a].push(r)}t[a].push(Nk(o))}else t[a]=Nk(o)}return t}function Pk(e){try{var t={};if(e.children.length>0)for(var n=0;n<e.children.length;n++){var s=e.children.item(n),i=s.attributes;for(var o in i){var a=i[o],r=a.nodeName,l=a.nodeValue;void 0!==r&&(t[r]=l)}var d=s.nodeName;if(void 0===t[d])t[d]=Nk(s);else{if(void 0===t[d].push){var c=t[d];t[d]=[],t[d].push(c)}t[d].push(Nk(s))}}else t=e.textContent;return t}catch(e){console.log(e.message)}}const Dk={getData:function(e,t){return!1!==e.complete&&(Ik(e)?t&&t.call(e):kk(e,t),!0)},getTag:function(e,t){if(Ik(e))return e.exifdata[t]},getAllTags:function(e){if(!Ik(e))return{};var t,n=e.exifdata,s={};for(t in n)n.hasOwnProperty(t)&&(s[t]=n[t]);return s},pretty:function(e){if(!Ik(e))return"";var t,n=e.exifdata,s="";for(t in n)n.hasOwnProperty(t)&&("object"==typeof n[t]?n[t]instanceof Number?s+=t+" : "+n[t]+" ["+n[t].numerator+"/"+n[t].denominator+"]\r\n":s+=t+" : ["+n[t].length+" values]\r\n":s+=t+" : "+n[t]+"\r\n");return s}};var xk;function Ok(e,t,n,s){xk||(xk="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:xk,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Lk(e){return`${e[0]}° ${e[1]}' ${e[2]}"`}const Rk=function({windowId:e,GPSLatitude:t,GPSLatitudeRef:n,GPSLongitude:s,GPSLongitudeRef:i}){const o=`http://tools.wmflabs.org/geohack/geohack.php?language=en&params=${t.join("_")}_${n}_${s&&s.join("_")}_${i}_`,a=`${Lk(t)} ${n},\n            ${Lk(s)} ${i}`;return Ok("div",{className:"image-metadata-generic"},void 0,Ok("h3",{},void 0,(0,Oe.Z)("other","Location")),Ok("div",{},void 0,Ok("a",{onClick:()=>function(e,t){d.ZP.openURL(e,t)}(e,o),href:o,title:(0,Oe.Z)("Open in GeoHack")},void 0,a)))};var Bk;function Fk(e,t,n,s){Bk||(Bk="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Bk,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Vk=function({value:e,name:t}){return Fk("div",{className:"image-metadata-generic"},void 0,Fk("h3",{},void 0,t),Fk("div",{},void 0,e))};var Wk,Uk=n(19486);function Hk(e,t,n,s){Wk||(Wk="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Wk,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const zk=[$.kKeyboardTabToAll],Gk=["0°",(0,Oe.Z)("Vertical Mirror"),"180°",(0,Oe.Z)("Horizontal Mirror"),(0,Oe.Z)("90° Horizontal Mirror"),"270°",(0,Oe.Z)("270° Vertical Mirror"),"90°"],$k=document.createElement("canvas"),Kk=$k.getContext("2d"),jk=document.createElement("canvas"),Yk=jk.getContext("2d");class Xk extends hs.Component{static contextType=xi.Z;refButtonForTests=hs.createRef();style=Uk.Z.convertColorsToVariables(vk.ZP.forTheme(Uk.Z.getThemeWithFallback("Vivaldi2")));constructor(e){super(e),this.state={histogramChannels:[],histogramStyle:3,histogramImage:null,height:0,width:0,size:0,data:{},status:0},jk.width=768,jk.height=300,Yk.globalCompositeOperation="lighter",Yk.lineWidth=1.5,$k.width=600,$k.height=400}componentDidMount(){this.props.open&&this.loadPhoto()}componentDidUpdate(e){this.props.open&&0===this.state.status&&this.loadPhoto()}loadPhoto=()=>{const{document:e}=this.context;this.props.url?this.setState({status:1},(()=>{const t=this.props.url,n=e.createElement("img"),s=[{fill:B()("#f00"),data:[]},{fill:B()("#0f0"),data:[]},{fill:B()("#00f"),data:[]},{fill:B()("#999"),data:[]}],i=s[0],o=s[1],a=s[2],r=s[3];let l,d=0;n.onload=()=>Dk.getData(n,(()=>{l&&URL.revokeObjectURL(l);const e=n.width/n.height;let t=$k.width,c=t/e,h=0,p=0;c>$k.height?(c=$k.height,t=c*e,h=($k.width-t)/2):p=($k.height-c)/2,Kk.clearRect(0,0,$k.width,$k.height),Kk.drawImage(n,h,p,t,c);const u=Kk.getImageData(0,0,$k.width,$k.height);for(let e=0;e<256;e+=1)i.data[e]=0,o.data[e]=0,a.data[e]=0,r.data[e]=0;const g=u.data.length/256;for(let e=0,t=u.data.length;e<t;e+=4)if(u.data[e+3]>0){const t=u.data[e],n=u.data[e+1],s=u.data[e+2];i.data[t]+=1/g,o.data[n]+=1/g,a.data[s]+=1/g}for(let e=0;e<256;e+=1)r.data[e]=.2126*i.data[e]+.7152*o.data[e]+.0722*a.data[e];const m=Dk.getAllTags(n);for(const e in m)"string"==typeof m[e]&&(m[e]=m[e].replace(/\0/g,""));this.setState({data:m,histogramChannels:s,height:n.naturalHeight,width:n.naturalWidth,size:d,status:2},this.updateHistogram)})),t.startsWith("file:/")?C.Z.utilities.readImage(t).then((e=>{const t=new Uint8Array(e.data),s=new Blob([t],{type:e.type});d=s.size,l=URL.createObjectURL(s),n.src=l})).catch((e=>{this.setState({status:3})})):fetch(t).then((e=>e.blob())).then((e=>{d=e.size,l=URL.createObjectURL(e),n.src=l})).catch((e=>{this.setState({status:3})}))})):this.setState({status:0})};updateHistogram(){let e=[];switch(this.state.histogramStyle){case 0:e=[this.state.histogramChannels[0]];break;case 1:e=[this.state.histogramChannels[1]];break;case 2:e=[this.state.histogramChannels[2]];break;case 4:e=[this.state.histogramChannels[3]];break;case 3:e=[this.state.histogramChannels[0],this.state.histogramChannels[1],this.state.histogramChannels[2]]}Yk.clearRect(0,0,jk.width,jk.height),e.forEach((e=>{Yk.beginPath(),Yk.moveTo(0,jk.height);for(let t=0;t<e.data.length+1;t+=1){const n=Math.round(e.data[t]*jk.height);Yk.lineTo(3*t,jk.height-n)}Yk.lineTo(jk.width,jk.height),Yk.strokeStyle=e.fill.css(),Yk.fillStyle=e.fill.alpha(.3).css(),Yk.fill(),Yk.stroke(),Yk.closePath()})),this.setState({histogramImage:jk.toDataURL()})}setHistogramStyle(e){this.setState({histogramStyle:e},this.updateHistogram)}_createClipboardData=()=>this.props.url+"\n\n"+this.state.width+" × "+this.state.height+"\n"+fd(this.state.size)+"\n\n"+JSON.stringify(this.state.data,null,2);copyToClipboard=e=>{if(!(this.state.size&&this.state.width&&this.state.height))return;const t=this._createClipboardData();this.context.navigator.clipboard.writeText(t)};render(){if(!this.props.open)return null;const e=this.state.data,t=Object.keys(e).length>0&&e.DateTimeOriginal,n=decodeURI(this.props.url.split("/").pop().split("#")[0].split("?")[0].toString()),s=e.ExposureTime?e.ExposureTime.valueOf():void 0;return Hk("div",{className:"image-inspector",style:this.style},void 0,Hk("header",{},void 0,Hk("h1",{},void 0,n),Hk("button",{className:"close no-stroke",title:(0,Oe.Z)("Close inspector"),onClick:this.props.toggleImageInspector,dangerouslySetInnerHTML:{__html:Ts.kze}})),Hk("div",{className:"image-inspector-container"},void 0,1===this.state.status&&Hk("p",{className:"in-progress"},void 0,(0,Oe.Z)("Analyzing image...")),3===this.state.status&&Hk("p",{},void 0,(0,Oe.Z)("Unable to analyze image.")),2===this.state.status&&Hk("div",{className:"image-inspector-metadata"},void 0,Hk("div",{className:"image-histogram"},void 0,Hk("img",{className:"histogram",title:(0,Oe.Z)("Histogram"),src:this.state.histogramImage}),Hk("div",{className:"toolbar text"},void 0,Hk("button",{tabIndex:this.props.prefValues[$.kKeyboardTabToAll],className:"button-toolbar "+(4===this.state.histogramStyle?"button-selected":""),onClick:this.setHistogramStyle.bind(this,4)},void 0,(0,Oe.Z)("Brightness")),Hk("button",{tabIndex:this.props.prefValues[$.kKeyboardTabToAll],className:"button-toolbar "+(3===this.state.histogramStyle?"button-selected":""),onClick:this.setHistogramStyle.bind(this,3)},void 0,"RGB"),Hk("span",{},void 0,Hk("button",{tabIndex:this.props.prefValues[$.kKeyboardTabToAll],className:"button-toolbar "+(0===this.state.histogramStyle?"button-selected":""),onClick:this.setHistogramStyle.bind(this,0)},void 0,"R"),Hk("button",{tabIndex:this.props.prefValues[$.kKeyboardTabToAll],className:"button-toolbar "+(1===this.state.histogramStyle?"button-selected":""),onClick:this.setHistogramStyle.bind(this,1)},void 0,"G"),Hk("button",{tabIndex:this.props.prefValues[$.kKeyboardTabToAll],className:"button-toolbar "+(2===this.state.histogramStyle?"button-selected":""),onClick:this.setHistogramStyle.bind(this,2)},void 0,"B")))),t&&Hk("div",{className:"image-metadata-device"},void 0,Hk("span",{className:"image-camera",dangerouslySetInnerHTML:{__html:Ts.b0l}}),Hk("h3",{},void 0,"Canon"===e.Make?"":e.Make," ",e.Model)),t&&Hk("div",{className:"image-metadata-core"},void 0,Hk("div",{title:(0,Oe.Z)("Aperture")},void 0,Hk("span",{dangerouslySetInnerHTML:{__html:Ts.S1h}}),e.FNumber&&`f/${e.FNumber.valueOf()}`),Hk("div",{title:(0,Oe.Z)("ISO Speed")},void 0,Hk("span",{dangerouslySetInnerHTML:{__html:Ts.KyY}}),e.ISOSpeedRatings&&e.ISOSpeedRatings),Hk("div",{title:(0,Oe.Z)("Exposure time")},void 0,Hk("span",{dangerouslySetInnerHTML:{__html:Ts.CKA}}),s&&s<1&&(0,Oe.Z)("1/$1 second","1/$1 seconds",[Math.round(1/s*100)/100]),s&&s>=1&&(0,Oe.Z)("$1 second","$1 seconds",[s])),Hk("div",{title:(0,Oe.Z)("Focal length")},void 0,Hk("span",{dangerouslySetInnerHTML:{__html:Ts.heI}}),(e.FocalLengthIn35mmFilm||e.FocalLength)&&`${e.FocalLengthIn35mmFilm?.valueOf()||e.FocalLength?.valueOf()||0} mm`)),e.WhiteBalance&&Hk("div",{className:"image-white-balance"},void 0,Hk("h3",{},void 0,(0,Oe.Z)("White Balance")),e.LightSource&&"Unknown"!==e.LightSource?e.LightSource:e.WhiteBalance,e.kelvin&&Hk("div",{className:"image-kelvinscale"},void 0,Hk("span",{className:"kelvin-indicator",style:{left:(e.kelvin-2e3)/70+"%"}},void 0,e.kelvin,"K"))),this.state.width&&this.state.height&&Hk(Vk,{value:this.state.width+" × "+this.state.height+" ("+Math.round(this.state.height*this.state.width/1e5)/10+"MP)",name:(0,Oe.Z)("Dimensions")}),this.state.size&&Hk(Vk,{value:fd(this.state.size),name:(0,Oe.Z)("Size")}),e.ColorSpace&&Hk(Vk,{value:`${e.ColorSpace}`,name:(0,Oe.Z)("Color Space")}),e.GPSLatitude&&e.GPSLatitudeRef&&e.GPSLongitude&&e.GPSLongitudeRef&&Hk(Rk,{windowId:this.context.vivaldiWindowId,GPSLatitude:e.GPSLatitude,GPSLatitudeRef:e.GPSLatitudeRef,GPSLongitude:e.GPSLongitude,GPSLongitudeRef:e.GPSLongitudeRef}),e.Copyright&&""!==e.Copyright.trim()&&Hk(Vk,{value:e.Copyright,name:(0,Oe.Z)("Copyright")}),e.DateTimeOriginal&&Hk(Vk,{value:e.DateTimeOriginal,name:(0,Oe.Z)("Captured at")}),e.Orientation&&Hk(Vk,{value:Gk[e.Orientation-1],name:(0,Oe.Z)("Orientation")}),e.Software&&Hk(Vk,{value:e.Software,name:(0,Oe.Z)("Software")}),Hk("div",{className:"toolbar text alldata-toolbar"},void 0,(0,fs.jsx)("button",{ref:this.refButtonForTests,className:"button-toolbar",tabIndex:this.props.prefValues[$.kKeyboardTabToAll],onClick:this.copyToClipboard,children:(0,Oe.Z)("Copy Data to Clipboard")})))))}}const Qk=sa(Xk,zk);var qk;function Jk(e,t,n,s){qk||(qk="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:qk,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class eA extends hs.PureComponent{static contextType=xi.Z;state={actionLog:[]};_actionLoggerChanged=e=>{const{actionType:t,...n}=e;let s=`${(new Date).toLocaleString()}: ${t.padEnd(35)}`;if(Object.keys(n).length>0){let e=!1;for(const t in n)try{let i=JSON.stringify(n[t]);if(void 0===i&&(i="undefined"),s.length+i.length>160){e=!0;continue}s+=`${t}: ${i}, `}catch(t){e=!0}e&&(s+="...")}this.setState((e=>{const t=e.actionLog.concat(s);return t.length>500&&t.splice(0,1),{actionLog:t}}))};componentDidMount(){y.Z.setLogCallback(this._actionLoggerChanged)}componentWillUnmount(){y.Z.setLogCallback(void 0)}getContextMenuItems=()=>[{handler:()=>this.setState({actionLog:[]}),...(0,xs.Z)("Clear")}];onContextMenu=e=>{(0,Qi.Z)(this.context,this.getContextMenuItems())(e)};render(){return Jk("div",{className:"actionlog",id:"action_logger",tabIndex:"0",onContextMenu:this.onContextMenu},void 0,Jk("textarea",{className:"actionlogs",readOnly:!0,value:this.state.actionLog.join("\n")}))}}const tA=eA;var nA,sA;function iA(e,t,n,s){nA||(nA="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:nA,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function oA({enabled:e,locked:t,fullName:n,description:s,onValueChange:i}){return iA("div",{className:"setting-single"},void 0,iA("label",{},void 0,iA("input",{type:"checkbox",checked:e,disabled:t,onChange:({currentTarget:e})=>i(e.checked)}),iA("span",{},void 0,n)),iA("p",{className:"info"},void 0,s))}function aA(e,t,n,s){sA||(sA="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:sA,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var rA=aA("br",{});function lA(){return aA("div",{className:"Experiments-Caution"},void 0,(0,Oe.Z)("These experimental features may change, break, disappear, not work as intended or at all."),rA,(0,Oe.Z)("Please proceed with caution."))}var dA,cA=aA(lA,{});class hA extends hs.PureComponent{constructor(e){super(e),this.state={experiments:this.getFeatureFlags()}}getFeatureFlags=()=>ds.Z.getFlags().filter((e=>!("chat"===e.name)));_handleChange=(e,t)=>{ds.Z.enableFeature(e,t).then((()=>this.setState({experiments:this.getFeatureFlags()})))};render(){return aA("div",{className:"Experiments vivaldi-settings",tabIndex:"0"},void 0,aA("h2",{className:"Experiments-Header"},void 0,(0,Oe.Z)("Experimental features")),cA,aA("div",{className:"setting-subgroup"},void 0,this.state.experiments.map((e=>aA(oA,{fullName:e.friendlyName,description:e.description,locked:e.locked,enabled:e.value,onValueChange:this._handleChange.bind(null,e.name)},e.name)))))}}function pA(e,t,n,s){dA||(dA="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:dA,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const uA="https://vvld.in/guest";function gA(e,t){t.preventDefault(),d.ZP.openURL(e,uA,{inCurrent:!1,inBackground:!1})}var mA=pA("svg",{className:"guest-intro-background",viewBox:"0 0 1244 860"},void 0,pA("path",{fill:"url(#guest-intro-bg-gradient)",d:"M0 0h153.513c16.141 27.93 32.15 55.734 47.912 83.11 16.086 27.94 32.722 56.832 49.076 85.128 11.01 19.031 22.079 38.316 32.781 56.967 25.186 43.883 51.228 89.259 77.402 132.848 33.382 55.651 75.894 82.121 137.77 85.829 3.205.192 6.454.288 9.655.288 39.673 0 78.14-14.461 108.316-40.722 21.644-18.834 48.687-52.291 54.604-104.667.749-6.654 1.357-13.708 1.855-19.573-1.07-29.74-6.476-52.92-17.294-74.518C622.935 139.46 612.708 67.99 625.087 0h136.676C747.1 44.93 749.845 96.364 774.32 145.251c20.839 41.6 30.654 85.7 31.485 138.023-.568 6.192-1.472 18.273-2.83 30.356-17.572 155.524-149.172 263.318-294.866 263.318-5.816 0-11.67-.173-17.526-.521C382.84 569.97 301.9 518.174 246.822 426.358c-38.015-63.313-74.255-127.68-111.253-191.634C90.359 156.507 45.49 78.062 0 0zm1113.47 0H1244v140.1c-7.496 27.86-18.849 54.995-34.031 81.275a1299530.57 1299530.57 0 0 1-170.255 294.799A1223193.145 1223193.145 0 0 0 841.018 860.24H687.72c135.675-235.123 271.527-470.147 407.26-705.25 22.311-38.621 31.22-79.696 25.368-124.548A170.12 170.12 0 0 0 1113.471 0z"}));class vA extends hs.Component{static contextType=xi.Z;render(){return pA("div",{className:"guest-intro"},void 0,mA,pA("div",{className:"guest-intro-content"},void 0,pA("h1",{},void 0,(0,Oe.Z)("title","Guest Profile")),pA("span",{className:"guest-intro-icon",dangerouslySetInnerHTML:{__html:Ts.CtH.large}}),pA("p",{},void 0,(0,Oe.Z)("Browsing with a Guest profile means that searches, sites visited, cookies, and temporary files won’t be stored by Vivaldi. It does not encrypt or otherwise modify your connection.")),pA("p",{},void 0,pA("a",{tabIndex:0,href:uA,onClick:e=>gA(this.context.vivaldiWindowId,e)},void 0,(0,Oe.Z)("Learn more about Guest Profiles")))))}}const fA=vA;var yA,CA=n(28515);function wA(e,t,n,s){yA||(yA="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:yA,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class bA extends hs.Component{onRequestClose=()=>{this.props.onRequestClose?this.props.onRequestClose():this.props.onClose(!1)};onClose=()=>{this.props.onClose(!1)};onConfirmed=()=>{this.props.onClose(!0)};render(){return wA(_r.Z,{viewMode:"slide",style:{width:this.props.dialogWidth||400,minWidth:"unset"},onRequestClose:this.onRequestClose},void 0,wA("header",{className:"dialog-header"},void 0,wA("h1",{className:"dialog-title"},void 0,this.props.title)),wA("div",{className:"dialog-content"},void 0,this.props.prompt.map((e=>wA("p",{},e,e)))),wA("footer",{className:"dialog-footer"},void 0,wA("input",{type:"submit",className:this.props.danger?"danger":null,value:this.props.positive,onClick:this.onConfirmed,autoFocus:!this.props.danger}),!this.props.hideNegative&&wA("input",{type:"button",value:this.props.negative,onClick:this.onClose,autoFocus:this.props.danger})))}}const SA=bA;var IA,kA=n(13933);function AA(e,t,n,s){IA||(IA="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:IA,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const TA="https://",ZA={width:400,minWidth:"unset"};function EA({onCreateLink:e,onCancelCreateLink:t,anchorOrSelection:n,isAnchor:s,useAddress:i}){const o=hs.useRef(),a=i?n?(0,Oe.Z)("Edit Address"):(0,Oe.Z)("Add Address"):s&&n?(0,Oe.Z)("Edit Link"):(0,Oe.Z)("Create Link");let r;return r=s||n.startsWith("http")?n:TA+n,AA(_r.Z,{style:ZA,onRequestClose:t},void 0,AA("header",{className:"dialog-header"},void 0,AA("h1",{className:"dialog-title"},void 0,a)),AA("form",{onSubmit:()=>{e(o.current?(0,vs.q9)(o.current.value):TA)}},void 0,AA("div",{className:"dialog-content"},void 0,(0,fs.jsx)("input",{ref:o,defaultValue:r,type:"text",autoFocus:!0,onFocus:e=>e.currentTarget.select()})),AA("footer",{className:"dialog-footer"},void 0,AA("input",{type:"submit",className:"primary",value:(0,Oe.Z)("Save Link")}),AA("input",{type:"button",onClick:t,value:(0,Oe.Z)("Cancel")}))))}var _A;function MA(e,t,n,s){_A||(_A="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:_A,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const NA=[[{command:"bold",text:(0,Oe.Z)("Bold"),icon:Ts.q7H},{command:"italic",text:(0,Oe.Z)("Italic"),icon:Ts.znb},{command:"underline",text:(0,Oe.Z)("Underline"),icon:Ts.slH},{command:"strikeThrough",text:(0,Oe.Z)("Strike through"),icon:Ts._QD}],[{command:"justifyLeft",text:(0,Oe.Z)("Left align"),icon:Ts.W_c},{command:"justifyCenter",text:(0,Oe.Z)("Center align"),icon:Ts.vxN},{command:"justifyRight",text:(0,Oe.Z)("Right align"),icon:Ts.JUc},{command:"justifyFull",text:(0,Oe.Z)("Justify"),icon:Ts.FsT}],[{command:"insertOrderedList",text:(0,Oe.Z)("Numbered list"),icon:Ts.o_D},{command:"insertUnorderedList",text:(0,Oe.Z)("Bullet list"),icon:Ts.rr$}],[{command:"outdent",text:(0,Oe.Z)("Remove indentation"),icon:Ts.XKb},{command:"indent",text:(0,Oe.Z)("Indent"),icon:Ts.b2r}],[{command:"createLink",text:(0,Oe.Z)("Create Link"),icon:Ts.v2I},{command:"insertImage",text:(0,Oe.Z)("Insert Image"),icon:Ts.kkq}],[{command:"undo",text:(0,Oe.Z)("win_linux","Undo"),icon:Ts.LwO},{command:"redo",text:(0,Oe.Z)("win_linux","Redo"),icon:Ts.W9w}],[{command:"removeFormat",text:(0,Oe.Z)("Remove formatting"),icon:Ts.mHT}]];class PA extends hs.Component{isAnchor=!1;anchorOrSelection="";state={buttonState:[],createLinkModalOpen:!1,formatBlock:"p",fontName:"sans-serif",fontSize:"2",foreColor:"#111111",backColor:"#f6f6f6",minimizeToolbar:!!this.props.isSignature};updateButtonState=e=>{const t=NA.flat().map((e=>e.command)).indexOf("createLink"),n=e&&e[0]||[];n[t]=Boolean(this.isAnchor&&this.anchorOrSelection),this.setState({buttonState:n})};updateDropdownAndColorState=e=>{if(Array.isArray(e)&&1===e.length&&Array.isArray(e[0])){const[t,n,s,i,o]=e[0];this.setState({formatBlock:""===t||"div"===t?"p":t,fontName:n.startsWith('"')&&n.endsWith('"')?n.substring(1,n.length-1):n,fontSize:s,foreColor:"rgb(0, 0, 0)"===i?"#111111":B()(i).hex(),backColor:"rgba(0, 0, 0, 0)"===o?"#f6f6f6":B()(o).hex()})}};updateLinkState=e=>{this.isAnchor=e.isAnchor,this.anchorOrSelection=e.anchorOrSelection};onCreateLink=e=>{this.setState({createLinkModalOpen:!1}),this.props.onCreateLink(e)};onCancelCreateLink=()=>{this.setState({createLinkModalOpen:!1}),this.props.onCancelCreateLink()};showCreateLinkModal=()=>this.setState({createLinkModalOpen:!0});render(){let e=0;return(0,fs.jsxs)(fs.Fragment,{children:[this.state.createLinkModalOpen&&MA(EA,{onCreateLink:this.onCreateLink,onCancelCreateLink:this.onCancelCreateLink,isAnchor:this.isAnchor,anchorOrSelection:this.anchorOrSelection}),MA("div",{className:"editor-html-toolbar"},void 0,!this.state.minimizeToolbar&&MA("select",{onChange:e=>this.props.onChange("formatBlock",e),value:this.state.formatBlock,title:(0,Oe.Z)("Paragraph Format"),tabIndex:"-1"},void 0,MA("option",{value:"h1"},void 0,(0,Oe.Z)("Heading 1")),MA("option",{value:"h2"},void 0,(0,Oe.Z)("Heading 2")),MA("option",{value:"h3"},void 0,(0,Oe.Z)("Heading 3")),MA("option",{value:"h4"},void 0,(0,Oe.Z)("Heading 4")),MA("option",{value:"p"},void 0,(0,Oe.Z)("Paragraph")),MA("option",{value:"pre"},void 0,(0,Oe.Z)("Preformatted")),MA("option",{value:"blockquote"},void 0,(0,Oe.Z)("Quote"))),MA("select",{onChange:e=>this.props.onChange("fontName",e),value:this.state.fontName,title:(0,Oe.Z)("Font"),tabIndex:"-1"},void 0,MA("option",{value:"serif"},void 0,(0,Oe.Z)("Serif")),MA("option",{value:"sans-serif"},void 0,(0,Oe.Z)("Sans-Serif")),MA("option",{value:"monospace"},void 0,(0,Oe.Z)("Fixed Width"))),!this.state.minimizeToolbar&&MA("select",{onChange:e=>this.props.onChange("fontSize",e),value:this.state.fontSize,title:(0,Oe.Z)("Font Size"),tabIndex:"-1"},void 0,MA("option",{value:"1"},void 0,(0,Oe.Z)("Extra Small")),MA("option",{value:"2"},void 0,(0,Oe.Z)("mail","Small")),MA("option",{value:"3"},void 0,(0,Oe.Z)("Normal")),MA("option",{value:"4"},void 0,(0,Oe.Z)("mail","Large")),MA("option",{value:"5"},void 0,(0,Oe.Z)("Larger")),MA("option",{value:"6"},void 0,(0,Oe.Z)("Extra Large"))),NA.map(((t,n)=>{n>0&&(e+=NA[n-1].length);const s=this.props.isSignature?t.filter((e=>"insertImage"!==e.command&&(!this.state.minimizeToolbar||!["insertOrderedList","insertUnorderedList","outdent","indent","undo","redo","removeFormat"].includes(e.command)))):t;if(0!==s.length)return MA("span",{className:"editor-button-group"},n,s.map(((t,n)=>MA("button",{tabIndex:"-1",onClick:()=>this.props.onClick(t.command),title:t.text,className:this.state.buttonState[e+n]?"active":null,dangerouslySetInnerHTML:{__html:t.icon}},t.command))))})),MA("input",{type:"color",tabIndex:"-1",className:"text-color",title:(0,Oe.Z)("Text Color"),value:this.state.foreColor,onChange:e=>this.props.onChangeColor("foreColor",e)}),!this.state.minimizeToolbar&&MA("input",{type:"color",tabIndex:"-1",className:"text-bg-color",title:(0,Oe.Z)("Text Background Color"),value:this.state.backColor,onChange:e=>this.props.onChangeColor("backColor",e)}),this.props.isSignature&&MA("span",{className:"editor-button-group"},void 0,MA("button",{tabIndex:"-1",style:{float:"right"},onClick:()=>this.setState((e=>({minimizeToolbar:!e.minimizeToolbar}))),title:this.state.minimizeToolbar?(0,Oe.Z)("Show more"):(0,Oe.Z)("Show less"),dangerouslySetInnerHTML:{__html:this.state.minimizeToolbar?Ts.yaZ.small:Ts.OCp.small}})))]})}}const DA=["colorFg","colorFgAlpha","colorFgIntense","colorBg","colorBgIntense","colorBgDark","colorBorder","colorHighlightBg","colorHighlightBgAlpha","colorBorder","radiusRounded"];var xA=n(65741),OA=n(97781);const LA=[...DA,"colorBgLighter","colorFgFadedMore"];class RA extends hs.Component{static contextType=xi.Z;refWebview=hs.createRef();#P=[];constructor(e,t){super(e);const n=z.Z.getBaseStylesByWindowId(t.vivaldiWindowId,LA);this.state={windowStyle:n}}componentDidMount(){z.Z.addListener(this.onThemeStoreChanged),this.refWebview.current?.addEventListener("consolemessage",this.handleConsoleMessage),this.refWebview.current?.addEventListener("contentload",this.handleContentLoad),this.refWebview.current?.addEventListener("newwindow",this.handleLinkClicked),C.Z.tabsPrivate.onKeyboardChanged.addListener(this.keyEventListener)}componentWillUnmount(){this.#P.forEach((e=>URL.revokeObjectURL(e))),z.Z.removeListener(this.onThemeStoreChanged),this.refWebview.current?.removeEventListener("consolemessage",this.handleConsoleMessage),this.refWebview.current?.removeEventListener("contentload",this.handleContentLoad),this.refWebview.current?.removeEventListener("newwindow",this.handleLinkClicked),C.Z.tabsPrivate.onKeyboardChanged.removeListener(this.keyEventListener)}onThemeStoreChanged=()=>{const e=z.Z.getBaseStylesByWindowId(this.context.vivaldiWindowId,LA);(0,xA.Z)(e,this.state.windowStyle)||this.setState({windowStyle:e},this.setStyle)};static defaultProps={hidden:!1};focus(){return this.refWebview.current?.focus()}blur(){return this.refWebview.current?.blur()}hasFocus(){const{document:e}=this.context;return!!this.refWebview.current&&this.refWebview.current===e.activeElement}getContentAsBodyParts=()=>{const e=this.refWebview.current;return e?new Promise(((t,n)=>{e.executeScript({code:"document.body.innerHTML"},(e=>{e&&Array.isArray(e)&&"string"==typeof e[0]?t([{type:"html",content:e[0]}]):n("RichTextEdit.getContentAsBodyParts: Couldn't get content from Webview")}))})):Promise.reject("RichTextEdit.getContentAsBodyParts: Webview doesn't exist")};getWebview=()=>{const e=this.refWebview.current;if(!e)throw new Error("RichTextEdit.getContentAsBodyParts: Webview doesn't exist");return e};postMessage=e=>{this.refWebview.current?.contentWindow?.postMessage?.(e,"*")};setContent=e=>{this.postMessage({type:"SET_CONTENT",content:e})};setStyle=()=>{let e=Uk.Z.createStyleRoot(this.state.windowStyle);e+=this.props.isNote?"\n    html, body, iframe {\n      background-color: var(--colorBg);\n      padding: 0;\n      margin: 0;\n      font-family: sans-serif;\n      overflow: initial;\n    }\n    body[contenteditable=\"plaintext-only\"] {\n      font-family: monospace;\n    }\n    body {\n      --EditorPadding: 12px;\n      --MaxWidth: 700px;\n      margin-left: var(--EditorPadding);\n      padding-left: calc(calc(50% - calc(var(--MaxWidth) / 2) - var(--EditorPadding))) !important;\n      padding-right: calc(50% - calc(var(--MaxWidth) / 2)) !important;\n      padding-top: var(--EditorPadding);\n      padding-bottom: calc(var(--EditorPadding) * 3);\n      color: var(--colorFgIntense);\n      font-size: 100%;\n      cursor: text;\n    }\n    img {\n      display: inline-block;\n      vertical-align: top;\n      max-width: 100%;\n      height: auto;\n    }\n    a:-webkit-any-link {\n      color: var(--colorHighlightBg);\n      cursor: pointer;\n    }\n  \n    html {\n      width: calc(100% - 12px);\n    }\n    html, body, iframe {\n      font-size: 100%;\n    }\n    input[type=checkbox] {\n      appearance: none;\n      position: relative;\n      width: 16px;\n      height: 16px;\n      min-width: 16px;\n      min-height: 16px;\n      vertical-align: middle;\n      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1) inset;\n      margin: unset;\n      border-width: 1px;\n      border-style: solid;\n      border-color: rgba(0,0,0,0.2);\n      background-color: var(--colorBgIntense);\n    }\n    input[type='checkbox']:disabled {\n      opacity: 1;\n      filter: grayscale(1);\n    }\n    input[type=checkbox]:before,\n    input[type=checkbox]:after {\n      content: '';\n      position: absolute;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      background-color: var(--colorHighlightBg);\n      transform-origin: 0 0;\n    }\n    input[type=checkbox]:before {\n      transform: rotate(-45deg) translateY(45%) translateX(-30%) scaleX(0.25) scaleY(0);\n    }\n    input[type=checkbox]:checked:before {\n      transform: rotate(-45deg) translateY(45%) translateX(-30%) scaleX(0.25) scaleY(0.4);\n    }\n    input[type=checkbox]:after {\n      transform: rotate(225deg) translateY(-30%) translateX(-95%) scaleX(0.25) scaleY(0);\n    }\n    input[type=checkbox]:checked:after {\n      transform: rotate(225deg) translateY(-30%) translateX(-95%) scaleX(0.25) scaleY(1.2);\n    }\n    \n    .tooltip {\n      --TipWidth: 480px;\n      position: relative;\n    }\n    .tooltip .tooltip-text * {\n      user-select: none;\n    }\n    .tooltip-text input {\n      margin-left: 3px;\n      border: 1px solid var(--colorBorder);\n      border-radius: 2px;\n      font-size: 13px;\n      opacity: 0.8;\n      color: var(--colorFg);\n      background-color: var(--colorBg);\n    }\n    .tooltip-text input:active {\n      background-color: var(--colorBgDark);\n    }\n    .tooltip-text input:first-of-type {\n      margin-left: 12px;\n    }\n    .tooltip-text a {\n      white-space: nowrap;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      color: var(--colorFg);\n    }\n    .tooltip .tooltip-text {\n      cursor: default;\n      position: absolute;\n      z-index: 1;\n      display: flex;\n      align-items: center;\n      top: 100%;\n      left: -6px;\n      max-width: var(--TipWidth);\n      padding: 6px 6px 6px 12px;\n      color:var(--colorFg);\n      background-color: var(--colorBg);\n      border: 1px solid var(--colorBgDark);\n      box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.1), 0 3px 10px rgba(0, 0, 0, 0.3);\n      border-radius: 3px;\n    }\n  \n  ":function(e=!1){const t="black_on_white"===H.Z.get($.kMailComposerColors);return`html, body {\n      overflow: initial;\n    }\n    body {\n      margin: ${e?"6px":"12px 24px 24px"};\n      font-family: sans-serif;\n      font-size: 100%;\n      color: ${t?"black;":"var(--colorFgIntense)"};\n      background-color: ${t?"white;":"var(--colorBgIntense)"};\n    }\n    img {\n      display: inline-block;\n      vertical-align: top;\n      max-width: 100%;\n      height: auto;\n    }\n    [contenteditable] {\n      cursor: text;\n    }\n    blockquote {\n      padding-inline-start: 18px;\n      border-left: 3px solid inherit;\n      margin: 0;\n      opacity: 0.85;\n    }\n    pre {\n      white-space: pre-wrap;\n    }\n    \n    .tooltip {\n      --TipWidth: 480px;\n      position: relative;\n    }\n    .tooltip .tooltip-text * {\n      user-select: none;\n    }\n    .tooltip-text input {\n      margin-left: 3px;\n      border: 1px solid var(--colorBorder);\n      border-radius: 2px;\n      font-size: 13px;\n      opacity: 0.8;\n      color: var(--colorFg);\n      background-color: var(--colorBg);\n    }\n    .tooltip-text input:active {\n      background-color: var(--colorBgDark);\n    }\n    .tooltip-text input:first-of-type {\n      margin-left: 12px;\n    }\n    .tooltip-text a {\n      white-space: nowrap;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      color: var(--colorFg);\n    }\n    .tooltip .tooltip-text {\n      cursor: default;\n      position: absolute;\n      z-index: 1;\n      display: flex;\n      align-items: center;\n      top: 100%;\n      left: -6px;\n      max-width: var(--TipWidth);\n      padding: 6px 6px 6px 12px;\n      color:var(--colorFg);\n      background-color: var(--colorBg);\n      border: 1px solid var(--colorBgDark);\n      box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.1), 0 3px 10px rgba(0, 0, 0, 0.3);\n      border-radius: 3px;\n    }\n  `}(this.props.isSignature),this.postMessage({type:"SET_STYLE",isNote:this.props.isNote,style:e})};debouncedUpdateState=(0,no.Z)((()=>{this.props.updateButtonState(),this.props.updateDropdownAndColorState()}),100);handleConsoleMessage=e=>{let t,n;const s=e.message.indexOf(" ");switch(-1===s?(t=e.message,n=""):(t=e.message.substring(0,s),n=e.message.substring(s+1)),t){case"selectionchange":this.debouncedUpdateState();const s=n.startsWith("anchor"),i=n.substring(7);this.props.handleLinkEvent({type:t,isAnchor:s,anchorOrSelection:i});break;case"input":this.debouncedUpdateState(),this.props.onChange(e);break;case"createLink":case"editLink":case"copyLink":case"unlink":this.props.handleLinkEvent({type:t});break;case"dragover":{const e={dataTransfer:{types:n?n.split(","):[]}};this.props.onDragOver?.(e);break}default:throw new Error(e.message)}};handleLinkClicked=e=>{e.targetUrl.startsWith("#")||(d.ZP.openURL(this.context.vivaldiWindowId,e.targetUrl),e.preventDefault())};handleContentLoad=()=>{this.setStyle(),this.props.onContentLoad?.(),this.postMessage({type:"CONTENT_LOAD_REPLY",translatedStrings:{copyValue:(0,Oe.Z)("link","Copy"),copyTitle:(0,Oe.Z)("Copy Link Address"),editValue:(0,Oe.Z)("link","Edit"),editTitle:(0,Oe.Z)("Edit Link Address"),unlinkValue:(0,Oe.Z)("link","Remove"),unlinkTitle:(0,Oe.Z)("Remove Link")}})};keyEventListener=(e,t,n,s,i)=>{const{document:o}=this.context;1===n&&t&&s===oa.Z.KEY_TAB&&o.activeElement&&o.activeElement===this.refWebview.current&&this.props.focusPreviousElement()};execCommand=(e,t,n=!0)=>{this.postMessage({type:"EXEC_COMMAND",command:e,value:t}),n&&setTimeout((()=>this.refWebview.current?.focus()),0)};onChange=(e,t)=>{this.execCommand(e,t.currentTarget.value),this.props.updateDropdownAndColorState()};onClick=e=>{switch(e){case"createLink":this.props.handleLinkEvent({type:"createLinkClicked"});break;case"insertImage":this.insertImage();break;default:this.execCommand(e,""),this.props.updateButtonState()}};insertImage=async()=>{const{showOpenFilePicker:e}=this.context,[t]=await e({types:[{description:"Images",accept:{"image/*":[".png",".gif",".jpeg",".jpg"]}}]}),n=await t.getFile(),s=URL.createObjectURL(n);this.#P.push(s),this.execCommand("insertHTML",`<img src="${s}" ${OA.ZR}="${n.type}" ${OA.Gx}="${t.name}" />`)};unlink=()=>{this.execCommand("unlink",!1)};selectSurrounding=()=>{this.postMessage({type:"SELECT_SURROUNDING"})};setZoomLevel=e=>{const t=this.refWebview.current;t&&(t.setZoomMode("per-view"),t.setZoom(e))};executeScript=e=>new Promise(((t,n)=>{this.refWebview.current?this.refWebview.current.executeScript(e,t):n()}));render(){return(0,fs.jsx)("webview",{className:"editor-webview",name:"richtexteditor",ref:this.refWebview,style:this.props.hidden||this.props.disabled?{display:"none"}:{},allowtransparency:"on",src:'data:text/html,<html id="content" tabindex="-1">\n  <head>\n    <style id="richtextstyle"></style>\n    <link id="stylesheet"></link>\n    <script src="chrome-extension://mpognobbkildjkofajifpdfhcoklimli/richtexteditor-bundle.js"><\/script>\n  </head>\n  <body class="MarkdownRender" contenteditable="true">\n  </body>\n</html>\n'})}}function BA(e,t){const[n,s]=(0,hs.useState)(!1),i=(0,hs.useCallback)((e=>{e.dataTransfer.types.includes("Files")&&s(!0)}),[]),o=(0,hs.useCallback)((e=>{e.target===e.currentTarget&&(e.preventDefault(),s(!1))}),[]),a=(0,hs.useCallback)((t=>{s(!1);const n=[...t.dataTransfer.items].filter((e=>"file"===e.kind)).map((e=>e.getAsFile()));n.length>0&&(t.preventDefault(),e(n))}),[e]);return(0,hs.useEffect)((()=>{const e=t?.current;n?e?.style.setProperty("pointer-events","none"):e?.style.removeProperty("pointer-events")}),[t,n]),{canDropFile:n,onDragLeave:o,onDragOver:i,onDrop:a}}var FA,VA=n(17776);function WA(e,t,n,s){FA||(FA="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:FA,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const UA=(0,hs.forwardRef)(((e,t)=>{const n=(0,hs.useRef)(null),s=(0,hs.useRef)(null);function i(){const e=n.current?.refWebview.current;e&&e.executeScript({code:"['formatBlock', 'fontName', 'fontSize', 'foreColor', 'backColor'].map(\n         command => document.queryCommandValue(command));"},(e=>{s.current&&s.current.updateDropdownAndColorState(e)}))}(0,hs.useImperativeHandle)(t,(()=>({focus:()=>{n.current&&n.current.focus()},getContentAsBodyParts:()=>{if(!n.current)throw new Error("MailComposer: Building body parts after body is gone");return n.current.getContentAsBodyParts()},getWebview:()=>{if(!n.current)throw new Error("MailComposer: Getting webview body is gone");return n.current.getWebview()},setContent:e=>{n.current?.setContent(e)}})),[]);const{canDropFile:o,onDragLeave:a,onDragOver:r,onDrop:l}=e.onSignatureAttachmentDrop?(d=n.current?.refWebview,h=e.onSignatureAttachmentDrop,BA((0,hs.useCallback)((async e=>{for(const t of e){if(t.size>2e6){et.Z.warn("Mail",["signature"],`Image ${t.name} is too large (over 2MB) to add to signature`);continue}const e=await new Promise(((e,n)=>{const s=new FileReader;s.onloadend=({currentTarget:t})=>{const{result:s}=t;s.startsWith("data:image/")?e(s):n("Not an image")},s.readAsDataURL(t)}));await new Promise(((t,n)=>{if(d&&d.current){let s="";d.current.executeScript({code:"document.body.innerHTML"},(i=>{i&&Array.isArray(i)&&"string"==typeof i[0]?(s=String(i[0])+`<div><img alt="" src="${e}"></div>`,s&&(d.current?.executeScript({code:`document.body.innerHTML = unescape('${escape(s)}');`}),h(s)),t()):n("RichTextEdit.getContentAsBodyParts: Couldn't get contet from Webview")}))}}))}}),[h,d]),d)):function(e,t){return BA((0,hs.useCallback)((async t=>{const n=[];for(const s of t){if(s.size>xe.gh&&"cancel"===await Ae.Z.showLargeAttachmentWarning(s.name,s.size))continue;let t;try{t=await s.arrayBuffer()}catch(t){console.error("useAttachmentDrop: "+t.toString()),c.Z.setStatus(e,t.toString());continue}const i=await(0,VA.Z)(t);n.push({type:"attachment",content:i,filename:s.name,mimeType:s.type,fileSize:t.byteLength})}Nf.Z.addAttachments(n)}),[e]),t)}(e.windowId,n.current?.refWebview);var d,h;const p=!!e.onSignatureAttachmentDrop;return WA("div",{className:"editor-html"},void 0,(0,fs.jsx)(PA,{ref:s,onClick:function(e){n.current&&n.current.onClick(e)},onCreateLink:function(e){const t=n.current;t&&(""===e?t.execCommand("unlink"):"https://"!==e&&t.execCommand("createLink",e),t.focus())},onCancelCreateLink:function(){n.current&&n.current.focus()},onChange:function(e,t){n.current&&n.current.execCommand(e,t.currentTarget.value),i()},onChangeColor:function(e,t){const s=n.current;s&&s.execCommand(e,t.currentTarget.value,!1)},isSignature:p}),o&&WA("div",{className:"file-dropzone",onDragLeave:a,onDrop:l,onDragOver:e=>e.preventDefault()},void 0,WA("h1",{},void 0,(0,Oe.Z)("Drop file(s) here"))),(0,fs.jsx)(RA,{ref:n,isSignature:p,onChange:e.onBodyChange,onDragOver:r,onContentLoad:e.onContentLoad,focusPreviousElement:e.focusPreviousElement,updateDropdownAndColorState:i,updateButtonState:function(){const e=n.current?.refWebview.current,t='"'+NA.flat().map((e=>e.command)).join('","')+'"';e&&e.executeScript({code:`[${t}].map(command => document.queryCommandState(command));`},(e=>{s.current&&s.current.updateButtonState(e)}))},handleLinkEvent:function(e){const t=s.current;if(!t)return;const{isAnchor:i,anchorOrSelection:o}=t;switch(e.type){case"selectionchange":t.updateLinkState(e);break;case"createLink":case"editLink":t.showCreateLinkModal();break;case"copyLink":break;case"unlink":i&&o&&n.current?.unlink();break;case"createLinkClicked":i&&o&&n.current?.selectSurrounding(),t.showCreateLinkModal()}}}))})),HA=UA,zA=(e,t)=>{for(const n of e){let e=!1;for(const s of t)0!==s.indexOf(n)||(e=!0);if(!e)return!1}return!0};var GA;function $A(e,t,n,s){GA||(GA="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:GA,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function KA(e,t){const n=/[\S]+/g;let s=[];if(e&&(s=s.concat(e.match(n)||[])),t){const e=t.match(/[^@.+]+/g)||[];s=s.concat([...e,...t.split("@"),t])}return new Set(s.map((e=>e.toLowerCase())))}function jA(e,t,n=[],s){const i=eo()(((e,t)=>{const n=new Map(e);return t.forEach((({address:e,name:t})=>{n.has(e)&&n.delete(e)})),n}))(t,n);return eo()(((e,t)=>{const n=[];for(const[s,i]of t){(0===i.size?new Set([""]):i).forEach((t=>{if(e.length>0){const i=KA(e),o=KA(t,s);zA(i,o)&&n.push({address:s,name:t})}else n.push({address:s,name:t})}))}return s?.resetSelectionModel(),s?.setIndexSelected(0,!0),n}))(e,i)}class YA extends hs.Component{refMultiInputOptions={};selectionModel=new Bi;constructor(e){super(e),this.state={filteredList:[],inputValue:"",dropDownVisible:!1,isEditing:!1,selectedIndex:-1}}isMetaKeyPressed=!1;onKeyArrowUp=()=>{const e=this.selectionModel.leadIndex;e>0&&(this.selectionModel.resetSelectionModel(),this.selectionModel.setIndexSelected(e-1,!0),this.forceUpdate())};onKeyArrowDown=()=>{const e=this.selectionModel.leadIndex;e<this.state.filteredList.length-1&&(this.selectionModel.resetSelectionModel(),this.selectionModel.setIndexSelected(e+1,!0),this.forceUpdate())};inputChanged=e=>{const t=this.refInputField?this.refInputField.value:"";this.props.onChange&&this.props.onChange(e);const n=jA(t,this.props.allItems,this.props.selectedItems,this.selectionModel);let s=!0;0!==t.length&&0!==n.length||(s=!1);const i=this.props.setIsValidInput;if(i){let e=!1;if(t.trim().length>0){const n=(0,ft.D$)(t);if(n.length>0){const t=n[0];(0,ft.HZ)(t.address)&&(e=!0)}}i(e)}this.setState({inputValue:t,filteredList:n,dropDownVisible:s})};onOptionClick=e=>{this.selectOption(e)};onItemClick=e=>{this.removeOption(e,!0)};removeOption=(0,no.Z)(((e,t)=>{const n=this.props.selectedItems,[s]=n.splice(e,1),i=t?e:Math.max(e-1,0);this.setState(((e,o)=>(o.itemSelectionCallback(n),{isEditing:t,selectedIndex:n.length>0?i:-1,inputValue:t?(0,ft.li)(s):""})),(()=>{this.state.isEditing||-1===this.state.selectedIndex?this.focusInput():this.focusItem(i)}))}));inputConfirmed=e=>{let t=!1;if(e&&e.value&&e.value.trim().length>0){let n="";const s=this.props.selectedItems,i=(0,ft.D$)(e.value);for(;i.length>0;){const e=i.shift();if(!(0,ft.HZ)(e.address)){i.unshift(e),n=(0,ft.Rz)(i);break}-1===this.state.selectedIndex?s.push(e):s.splice(this.state.selectedIndex,0,e),t=!0}t&&(this.setState((e=>({isEditing:!1,inputValue:n,dropDownVisible:!1})),(()=>this.focusItem(this.state.selectedIndex))),this.props.itemSelectionCallback(s))}return t};selectAll=()=>{this.selectionModel.resetSelectionModel(),this.setState(((e,t)=>(t.itemSelectionCallback([]),{inputValue:t.selectedItems.map((e=>(0,ft.li)(e))).join(", "),dropDownVisible:!1})),(()=>this.refInputField&&this.refInputField.select()))};selectOption=e=>{this.selectionModel.resetSelectionModel(),this.setState(((t,n)=>{const s=n.selectedItems;return-1===t.selectedIndex?s.push(e):s.splice(t.selectedIndex,0,e),n.itemSelectionCallback(s),{isEditing:!1,inputValue:"",dropDownVisible:!1}}),(()=>this.focusItem(this.state.selectedIndex)))};inputKeyUp=()=>{this.isMetaKeyPressed=!1};inputKeyDown=e=>{const t=e.keyCode;t===oa.Z.KEY_CONTROL&&(this.isMetaKeyPressed=!0);const n=!this.refInputField||0===this.refInputField.value.trim().length,s=this.state.filteredList[this.selectionModel.leadIndex],i=t===oa.Z.KEY_TAB||t===oa.Z.KEY_RETURN;if(n&&this.isMetaKeyPressed&&"a"===e.key)return this.selectAll(),e.preventDefault(),void e.stopPropagation();this.state.dropDownVisible&&void 0!==s&&i?(this.selectOption(s),e.preventDefault(),e.stopPropagation()):i||","===e.key?(this.inputConfirmed(this.refInputField)&&e.preventDefault(),e.stopPropagation()):t===oa.Z.KEY_ESCAPE?this.state.dropDownVisible?this.setState({dropDownVisible:!1}):this.inputConfirmed(this.refInputField)?e.preventDefault():(this.onKeyArrowLeft(),e.preventDefault(),e.stopPropagation()):this.state.dropDownVisible&&t===oa.Z.KEY_DOWN?(this.onKeyArrowDown(),e.preventDefault()):this.state.dropDownVisible&&t===oa.Z.KEY_UP?(this.onKeyArrowUp(),e.preventDefault()):!n||t!==oa.Z.KEY_LEFT&&t!==oa.Z.KEY_BACK_SPACE?n&&t===oa.Z.KEY_RIGHT&&(this.onKeyArrowRight(),e.preventDefault(),e.stopPropagation()):(this.onKeyArrowLeft(),e.preventDefault(),e.stopPropagation())};onKeyArrowLeft=()=>{let e;const t=-1===this.state.selectedIndex;e=this.state.isEditing?this.state.selectedIndex-1:t?this.props.selectedItems.length-1:Math.max(this.state.selectedIndex-1,-1),this.setState({selectedIndex:e,isEditing:!1,inputValue:"",dropDownVisible:!1},(()=>{e<0?this.focusInput():this.focusItem(e)}))};onKeyArrowRight=()=>{const e=this.state.selectedIndex+1;e===this.props.selectedItems.length?this.setState({isEditing:!1,selectedIndex:-1},(()=>this.focusInput())):this.setState((t=>({isEditing:!1,selectedIndex:e})),(()=>this.focusItem(e)))};inputLostFocus=e=>{this.props.clearInputOnBlur&&this.inputConfirmed(this.refInputField),this.setState({dropDownVisible:!1})};itemKeyDown=(e,t)=>{const n=t.keyCode;if(this.state.dropDownVisible&&e===this.props.selectedItems.length-1&&this.focusInput(),n===oa.Z.KEY_LEFT)this.onKeyArrowLeft(),t.preventDefault(),t.stopPropagation();else if(n===oa.Z.KEY_RIGHT)this.onKeyArrowRight(),t.preventDefault(),t.stopPropagation();else if(n===oa.Z.KEY_BACK_SPACE||n===oa.Z.KEY_DELETE)this.removeOption(e),t.preventDefault(),t.stopPropagation();else if(n===oa.Z.KEY_RETURN){const t=!0;this.removeOption(e,t)}else n===oa.Z.KEY_ESCAPE&&this.setState({isEditing:!1,selectedIndex:-1},(()=>this.focusInput()))};onClose=(e,t)=>{this.removeOption(e),t.stopPropagation()};onFocus=e=>{this.setState({selectedIndex:e})};renderSelectedItem=(e,t)=>{let n="";return e.address?n=e.address:"string"==typeof e&&(n=e),(0,fs.jsxs)("div",{title:n,onKeyDown:this.itemKeyDown.bind(this,t),onFocus:()=>this.onFocus(t),ref:e=>this.refMultiInputOptions["item_"+t]=e,onClick:this.onItemClick.bind(this,t),className:As()("multiinput-item",this.props.className),tabIndex:this.state.selectedIndex===t||0===this.props.tabIndex?0:-1,children:[e.name&&$A("span",{className:"multiinput-item-primary"},void 0,e.name),e.address&&$A("span",{className:"multiinput-item-secondary"},void 0,"<"+e.address+">"),"string"==typeof e&&$A("span",{className:"multiinput-item-primary"},void 0,e),$A("button",{type:"button",className:"close",dangerouslySetInnerHTML:{__html:Ts.kze},onClick:e=>this.onClose(t,e),tabIndex:this.props.tabIndex})]},"selected_item_"+t)};focusInput=()=>{this.refInputField&&this.refInputField.focus()};focusItem=e=>{this.refMultiInputOptions["item_"+e]?.focus()};renderMailAddressForOption=e=>$A("div",{},void 0,e.name?$A(hs.Fragment,{},void 0,$A("div",{className:"multiinput-option-primary"},void 0,e.name),$A("div",{className:"multiinput-option-secondary"},void 0,"<"+e.address+">")):$A("div",{className:"multiinput-option-primary"},void 0,e.address));renderInputField=()=>(0,fs.jsx)("input",{type:"text",ref:e=>this.refInputField=e,value:this.state.inputValue,onChange:this.inputChanged,onBlur:this.inputLostFocus,onKeyDown:this.inputKeyDown,onKeyUp:this.inputKeyUp,autoComplete:"false",spellCheck:"false",placeholder:this.props.placeholder});renderOption=(e,t)=>{const n=this.selectionModel.isSelected(t);return(0,fs.jsx)("div",{className:"multiinput-option",ref:e=>this.refMultiInputOptions["option_"+t]=e,role:"option","data-id":t,"data-selected":n?"":null,onClick:this.onOptionClick.bind(this,e),children:this.renderMailAddressForOption(e)},"option_"+t)};renderDropDown=()=>$A("div",{role:"listbox",className:"multiinput-select"},void 0,this.state.filteredList.map(this.renderOption));getInput=()=>$A("div",{className:"multiinput-group"},"input_"+this.state.selectedIndex,this.renderInputField(),this.state.dropDownVisible?this.renderDropDown():"");render(){const e=this.props.selectedItems.map(this.renderSelectedItem);return this.state.isEditing?e.splice(this.state.selectedIndex,0,this.getInput()):e.push(this.getInput()),(0,fs.jsx)("div",{ref:e=>this.refMultiInputEnvelope=e,className:"multiinput",children:e})}}const XA=YA;var QA=n(88951);var qA,JA=n(77312),eT=n(13519),tT=n(27569),nT=n(16888),sT=n(34155);function iT(e,t,n,s){qA||(qA="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:qA,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const oT=[$.kKeyboardTabToAll,$.kMailAccounts,$.kMailComposeHeadersHidden];class aT extends hs.PureComponent{static contextType=xi.Z;refTo=hs.createRef();refFrom=hs.createRef();signature="";draftCreated=!1;fromDraft=!0;refBody=hs.createRef();refSubject=hs.createRef();messageId=(0,QA.Z)();draftIsPlaintext=!1;cidAttachments=[];focusOnBody=!1;constructor(e){super(e),this.state=this._initDraft()}_initDraft=()=>{const e=fn.Z.getAccountsAndAliases(),t={from:e.length>0?[{address:e[0].MAIL_EMAIL}]:[],to:[],cc:[],bcc:[],subject:"",attachments:[],mailAddresses:Hc.Z.getMailAddresses(),showModal:!1},n=this.props.mailto&&!this.props.searchListId?(0,ke.J)(this.props.mailto):kA.Z.get();return n?(this.sentDate=n.sentDate,this.threadKey=n.threadKey,this.references=n.references,this.messageId=n.messageId,this.cidAttachments=n.cidAttachments||[],this.listId=n.listId,this.listPost=n.listPost,this.inReplyTo=n.inReplyTo,this.forwarded=n.forwarded,this.replied=n.replied,this.draftIsPlaintext=n.plaintext,this.focusOnBody=n.focusOnBody,this.selectedAccount=n.selectedAccount,t.attachments=n.attachments,t.bcc=n.bcc,t.cc=n.cc,t.from=n.from,t.subject=n.subject,t.to=n.to,this.bodyDraft=n.body,this.fromDraft=n.fromDraft??!0,this.fromDraft||(this.signature=(0,tT.SG)((0,tT.o$)(t.from,e,!!n.replied,!!n.forwarded),this.getSignaturePosition())),t):(this.sentDate=Date.now(),this.draftIsPlaintext=!1,this.bodyDraft="",t)};_setIfActive=e=>{e.isActive?sT.nextTick((()=>Nf.Z.setActiveMailComposer(this))):(sT.nextTick((()=>Nf.Z.clearActiveMailComposer(this))),this.flushPendingChanges())};_contactsChanged=()=>{const e=Hc.Z.getMailAddresses();this.setState({mailAddresses:e})};_showModal=e=>{"noRecipients"===e&&this.setState({showModal:!0})};_hideModal=()=>{this.setState({showModal:!1})};componentDidMount(){this._isMounted=!0,this._setIfActive(this.props),CA.Z.addListener(this._showModal),Hc.Z.addListener(this._contactsChanged),this.focusOnBody&&this.refBody.current?this.refBody.current.focus():this.refTo.current&&this.refTo.current.focusInput();const{searchListId:e}=this.props;e&&(async()=>{await ke.Z.prepareDraft(e)&&this._isMounted&&this.setState(this._initDraft(),this.onContentLoad)})()}onContentLoad=()=>{if(!this.bodyDraft&&!this.signature)return;const e=[],t=this.getSignaturePosition();""!==this.bodyDraft&&"above"!==t||e.push({content:"<br>",isPlainText:!1}),(this.replied||this.forwarded)&&("above"===t?e.push({content:this.signature,isPlainText:!1}):e.push({content:(0,tT.SG)("","above"),isPlainText:!1})),""!==this.bodyDraft&&e.push({content:this.bodyDraft,isPlainText:this.draftIsPlaintext}),"below"===t&&this.draftIsPlaintext&&this.bodyDraft&&e.push({content:"<br>",isPlainText:!1}),"below"!==t&&this.bodyDraft?e.push({content:(0,tT.SG)("","below"),isPlainText:!1}):e.push({content:this.signature,isPlainText:!1}),e.length>0&&this.refBody.current?.setContent(e),this.signature="",this.bodyDraft="",this.draftIsPlaintext=!1};componentDidUpdate(e){e.isActive!==this.props.isActive&&this._setIfActive(this.props)}componentWillUnmount(){this._isMounted=!1,CA.Z.removeListener(this._showModal),Hc.Z.removeListener(this._contactsChanged),sT.nextTick((()=>Nf.Z.clearActiveMailComposer(this))),this.flushPendingChanges()}getSignaturePosition=()=>(!!this.replied||!!this.forwarded)&&this.selectedAccount?.signaturePosition||"below";_updateSignature=e=>{const t=fn.Z.getAccountsAndAliases(),n=(0,tT.o$)(e,t,!!this.replied,!!this.forwarded),s=this.getSignaturePosition(),i=this.refBody.current;if(!i)return;const o="below"===s?".viv-signature-below":".viv-signature",a=".viv-signature-below"===o?".viv-signature":".viv-signature-below";i.getWebview().executeScript({code:`\n      if (document.body.querySelector(':scope > ${a}') instanceof HTMLSpanElement) {\n        document.body.querySelector(':scope > ${a}').innerHTML = unescape('${escape("")}');\n      }\n      if (document.body.querySelector(':scope > ${o}') instanceof HTMLSpanElement) {\n        document.body.querySelector(':scope > ${o}').innerHTML = unescape('${escape(n)}');\n      }\n    `})};buildMessage=()=>this.refBody.current?this.refBody.current.getContentAsBodyParts().then(this.processBodyParts).then((e=>({from:this.state.from,to:this.state.to,cc:this.state.cc,bcc:this.state.bcc,subject:this.state.subject,sentDate:this.sentDate,threadKey:this.threadKey,bodyParts:e,flags:["\\Seen"],listId:this.listId,listPost:this.listPost,inReplyTo:this.inReplyTo,replied:this.replied,forwarded:this.forwarded,...this.references?{references:this.references}:null,internal:!0,messageId:this.messageId,queued:!1}))):Promise.reject();_createDraftMessage=async e=>{const t=await async function(e){const{addedSles:t,forSearchDb:n}=await(0,Fe.Z)(xe.of,xe.Wb,xe.kY,[e],{filteringPriority:xe.Un.HIGH});(0,Ve.Z)(n);const[s]=t;if(!s)throw new Error("Failed to store message in drafts folder");return s}(e),{id:n,threadKey:i}=t;if(await ze.Z.setHasRaw(xe.of,n),this.threadKey=i,this._isMounted){const e=`${this.props.url}&query={"id":${n}}`;s.Z.tabs.update(this.props.pageId,{url:e})}l.Z.updateIndex({addedSles:[t]}),Ge.Z.filter(),Se.Z.updateThreads()};updateAttribute=e=>this.props.searchListId?e(this.props.searchListId):this.draftCreated?Promise.resolve():(this.draftCreated=!0,this.buildMessage().then(this._createDraftMessage));updateBody=(0,oS.Z)((e=>this.updateAttribute((async t=>{await function(e,t){return Re.Z.messages.update(e,{bodyParts:t})}(t,e);const n=(0,eT.H)(e);await(0,nT.K)(t,this.state,n),this.updateIndex(t,{attachment:(0,tT.tZ)(e)})}))),5e3,{leading:!1});processBodyParts=async e=>{if("html"===e[0].type){const{blobFreeHTML:t,cidsInUse:n,newImages:s}=(0,OA.o6)(e[0].content),i=this.cidAttachments.filter((e=>e.id&&n.includes("cid:"+e.id)));e[0].content=t;const o=s.map((async({dataOrBlobUrl:e,cid:t,mimeType:n,filename:s})=>{const i=await fetch(e),o=await i.arrayBuffer();return{type:"attachment",content:new Uint8Array(o),filename:s,id:t,mimeType:n,fileSize:o.byteLength}})),a=await Promise.all(o);return e.concat(this.state.attachments,i,a)}return Promise.resolve(e.concat(this.state.attachments))};onBodyChange=()=>this._isMounted&&this.refBody.current?.getContentAsBodyParts?this.refBody.current.getContentAsBodyParts().then(this.processBodyParts).then(this.updateBody):Promise.reject();flushPendingChanges=async()=>{await this.toSelected.flush(),await this.ccSelected.flush(),await this.bccSelected.flush(),await this.subjectChange.flush(),await this.updateBody.flush()};cancelPendingChanges=()=>{this.toSelected.cancel(),this.ccSelected.cancel(),this.bccSelected.cancel(),this.subjectChange.cancel(),this.updateBody.cancel()};updateIndex=(e,t)=>{if(!this.threadKey)throw new Error("MailComposer: Trying to update an unsaved draft");const n=[{id:e,updates:t}];l.Z.updateIndex({sleUpdates:n})};fromChange=e=>{this.selectedAccount=fn.Z.getAccountsAndAliases().find((t=>t.MAIL_EMAIL===e.target.value)),this.setState({from:this.selectedAccount?[{name:this.selectedAccount.MAIL_NAME,address:this.selectedAccount.MAIL_EMAIL}]:[]},(()=>(this._updateSignature(this.state.from),this.updateAttribute((async e=>{await function(e,t){return Re.Z.transaction("rw",[Re.Z.messages,Re.Z.searchList],(()=>{Re.Z.searchList.update(e,{from:t}),Re.Z.messages.update(e,{from:t})}))}(e,this.state.from),this.updateIndex(e,{from:this.state.from})}))))),this.selectedAccount&&(this.messageId=(0,QA.Z)(this.selectedAccount.MAIL_EMAIL))};toSelected=(0,oS.Z)((()=>this.updateAttribute((async e=>{await function(e,t){return Re.Z.transaction("rw",[Re.Z.messages,Re.Z.searchList],(()=>{Re.Z.searchList.update(e,{to:t}),Re.Z.messages.update(e,{to:t})}))}(e,this.state.to),this.updateIndex(e,{to:this.state.to})}))),5e3,{leading:!1});onToSelected=e=>{this.setState({to:[...e]},(()=>this.toSelected()))};ccSelected=(0,oS.Z)((()=>this.updateAttribute((e=>function(e,t){return Re.Z.transaction("rw",[Re.Z.messages,Re.Z.searchList],(()=>{Re.Z.searchList.update(e,{cc:t}),Re.Z.messages.update(e,{cc:t})}))}(e,this.state.cc)))),5e3,{leading:!1});onCcSelected=e=>{this.setState({cc:[...e]},(()=>this.ccSelected()))};bccSelected=(0,oS.Z)((()=>this.updateAttribute((e=>function(e,t){return Re.Z.messages.update(e,{bcc:t})}(e,this.state.bcc)))),5e3,{leading:!1});onBccSelected=e=>{this.setState({bcc:[...e]},(()=>this.bccSelected()))};subjectChange=(0,oS.Z)((()=>this.updateAttribute((async e=>{await function(e,t){return Re.Z.transaction("rw",[Re.Z.messages,Re.Z.searchList],(()=>{Re.Z.searchList.update(e,{subject:t}),Re.Z.messages.update(e,{subject:t})}))}(e,this.state.subject),this.updateIndex(e,{subject:this.state.subject})}))),5e3,{leading:!1});onSubjectChange=e=>{this.setState({subject:e.target.value},(()=>this.subjectChange()))};focusSubject=()=>{this.refSubject.current&&this.refSubject.current.focus()};removeAttachment=e=>{const t=this.state.attachments[e];this.setState((t=>({attachments:t.attachments.filter(((t,n)=>n!==e))})),(()=>this.updateAttribute(this.onBodyChange).then((()=>{"string"==typeof t.content&&(0,JA.MT)(t.content)}))))};_onContextMenu=(e,t)=>{const n=[{handler:this.removeAttachment.bind(this,e),...(0,xs.Z)("mail","Remove")}];(0,Qi.Z)(this.context,n)(t)};render(){const{from:e,to:t,cc:n,bcc:s,subject:i,attachments:o}=this.state,a=this.props.prefValues[$.kMailComposeHeadersHidden];return iT("div",{id:"mail_composer"},void 0,iT("header",{},void 0,!a.includes("from")&&iT("div",{},void 0,iT("label",{htmlFor:"from"},void 0,(0,Oe.Z)("sender","From")),iT("div",{className:"headerItemWrapper"},void 0,(0,fs.jsxs)("select",{ref:this.refFrom,id:"from",onChange:this.fromChange,value:e.length>0?e[0].address:"",children:[fn.Z.getAccountsAndAliases().map(((e,t)=>iT("option",{value:e.MAIL_EMAIL},t,(e.MAIL_NAME?e.MAIL_NAME:"")+" ("+e.MAIL_EMAIL+")"))),")}"]}))),iT("div",{},void 0,iT("label",{htmlFor:"to"},void 0,(0,Oe.Z)("To")),iT("div",{className:"headerItemWrapper"},void 0,(0,fs.jsx)(XA,{ref:this.refTo,id:"to",tabIndex:0===this.props.prefValues[$.kKeyboardTabToAll]?0:-1,selectedItems:t,allItems:this.state.mailAddresses,itemSelectionCallback:this.onToSelected,clearInputOnBlur:!0}))),(n.length>0||!a.includes("cc"))&&iT("div",{},void 0,iT("label",{htmlFor:"cc",title:(0,Oe.Z)("Carbon copy")},void 0,(0,Oe.Z)("Cc")),iT("div",{className:"headerItemWrapper"},void 0,iT(XA,{id:"cc",tabIndex:0===this.props.prefValues[$.kKeyboardTabToAll]?0:-1,selectedItems:n,allItems:this.state.mailAddresses,itemSelectionCallback:this.onCcSelected,clearInputOnBlur:!0}))),(s.length>0||!a.includes("bcc"))&&iT("div",{},void 0,iT("label",{htmlFor:"bcc",title:(0,Oe.Z)("Blind carbon copy")},void 0,(0,Oe.Z)("Bcc")),iT("div",{className:"headerItemWrapper"},void 0,iT(XA,{id:"bcc",tabIndex:0===this.props.prefValues[$.kKeyboardTabToAll]?0:-1,selectedItems:s,allItems:this.state.mailAddresses,itemSelectionCallback:this.onBccSelected,clearInputOnBlur:!0}))),iT("div",{},void 0,iT("label",{htmlFor:"subject"},void 0,(0,Oe.Z)("Subject")),iT("div",{className:"headerItemWrapper"},void 0,(0,fs.jsx)("input",{type:"text",ref:this.refSubject,id:"subject",value:i,onChange:this.onSubjectChange}))),o.length>0&&iT("div",{},void 0,iT("label",{},void 0,(0,Oe.Z)("Attachments")),iT("div",{className:"composer-attachments"},void 0,o.map(((e,t)=>iT("div",{onContextMenu:this._onContextMenu.bind(this,t),className:"attachment",title:e.filename},`attachment${t}`,iT("span",{className:"attachment-title"},void 0,e.filename),iT("button",{className:"attachment-remove",tabIndex:0===this.props.prefValues[$.kKeyboardTabToAll]?0:-1,onClick:this.removeAttachment.bind(this,t),dangerouslySetInnerHTML:{__html:Ts.kze}}))))))),iT("main",{},void 0,this.state.showModal&&iT(SA,{title:(0,Oe.Z)("Missing Recipients"),prompt:[(0,Oe.Z)("At least one address must be added to the To, Cc, or Bcc fields in order to send this email.")],positive:(0,Oe.Z)("OK"),onClose:this._hideModal,hideNegative:!0}),(0,fs.jsx)(HA,{ref:this.refBody,windowId:this.context.vivaldiWindowId,focusPreviousElement:this.focusSubject,onBodyChange:this.onBodyChange,onContentLoad:this.onContentLoad})))}}const rT=sa(aT,oT);var lT;function dT(e,t,n,s){lT||(lT="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:lT,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const cT=function(e){return dT("div",{className:"MailDisabled"},void 0,dT("h1",{},void 0,(0,Oe.Z)("Mail, Calendar and Feeds are Turned Off")),dT("p",{},void 0,(0,Oe.Z)("Vivaldi email client is turned off. Go to Settings\n        to enable it, set up accounts or change preferences.")),dT("input",{type:"button",onClick:()=>Ae.Z.showSettings(e.windowId,"general",{scroll:"features"}),tabIndex:0,value:(0,Oe.Z)("Go to Settings")}))};var hT;function pT(e,t,n,s){hT||(hT="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:hT,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const uT=function(e){const[t,n]=(0,hs.useState)(!1);return t?null:pT("div",{className:As()("MailWarningMessage",e.type)},void 0,e.children,pT("button",{className:"MailWarningMessage-Exit",onClick:()=>n(!0)},void 0,pT("span",{dangerouslySetInnerHTML:{__html:Ts.vyJ}})))};var gT;function mT(e,t,n,s){gT||(gT="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:gT,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const vT={markup:"",style:"",prepend:!1};function fT(e){const{markup:t,style:n,prepend:s}=e||vT;return`{\n  let container = document.querySelector('.VIVcontainer');\n  if (!container) {\n    container = document.createElement('div');\n    container.className = 'VIVcontainer';\n  } else {\n    container.remove();\n  }\n  document.body.${s?"prepend":"append"}(container);\n  let style;\n  let content;\n  let shadowRoot;\n  if (!container.shadowRoot) {\n    style = document.createElement('style');\n    content = document.createElement('div');\n    content.className = 'shadowWrapper';\n    shadowRoot = container.attachShadow({ mode: 'open' });\n    shadowRoot.appendChild(style);\n    shadowRoot.appendChild(content);\n  } else {\n    shadowRoot = container.shadowRoot;\n    style = shadowRoot.querySelector('style');\n    content = shadowRoot.querySelector('div');\n  }\n  style.textContent = ${JSON.stringify(n)};\n  content.innerHTML = ${JSON.stringify(t)};\n  window.requestAnimationFrame(() => {\n    const styles = window.getComputedStyle(document.body);\n    const top = parseFloat(styles.marginTop) + parseFloat(styles.paddingTop);\n    const left = parseFloat(styles.marginLeft) + parseFloat(styles.paddingLeft);\n    const right = parseFloat(styles.marginRight) + parseFloat(styles.paddingRight);\n    container.style.marginTop = Math.floor(top * ${s?"-1":"0"}) + "px";\n    container.style.marginLeft = Math.floor(left * -1) + "px";\n    container.style.marginRight = Math.floor(top * -1) + "px";\n  })}`}class yT extends hs.PureComponent{static contextType=xi.Z;refWebview=hs.createRef();refContentBlockedToggle=hs.createRef();state={leakPrevented:!1};componentDidUpdate(e){const{document:t}=this.context;if(!(0,xA.Z)(e.style,this.props.style)){const e=Uk.Z.createStyleRoot(this.props.style);this.refWebview.current?.executeScript({code:`\n        document.styleSheets[0].deleteRule(0);\n        document.styleSheets[0].insertRule("${e}", 0\n        );`})}const{textOrHtml:n,blockHTTPLeaks:s,bodyParts:i,isRss:o,renderingMethod:a}=this.props,{content:r,type:l}=n,d=this.refWebview.current;let c=!1;if(e.textOrHtml!==n||!r&&e.inject!==this.props.inject||"html"===l&&e.blockHTTPLeaks!==s){let e,n=!1;if("raw"===a){const n=t.createTextNode(r),s=t.createElement("p");s.appendChild(n),e=`<html>${this.getDefaultStyle(!1)}<body>${s.innerHTML}</body></html>`}else if("html"===l){const t={};(i||[]).forEach((e=>{"attachment"===e.type&&e.id&&(t["cid:"+e.id]=e)}));const a=(0,OA.Nw)(r,{attachments:t,blockHTTPLeaks:s});n=a.leakPrevented,e=o?this.getDefaultRssStyle()+a.sanitized:this.getDefaultStyle(!0)+a.sanitized}else e=`<html>${this.getDefaultStyle(!1)}<body>${mt(r)}</body></html>`;this.setState({leakPrevented:n}),d?.executeScript&&(c=!0,d.executeScript({code:`document.open();\n           document.write(${JSON.stringify(e)});\n           document.close();`}))}(c||e.inject!==this.props.inject)&&d?.executeScript({code:fT(this.props.inject)})}updateWebviewEventListeners=e=>{const t=this.refWebview.current,n=e;this.refWebview.current=n,t&&(t.removeEventListener("newwindow",this.handleNewWindow),t.removeEventListener("targeturlchanged",this.handleTargetURLChanged),t.removeEventListener("consolemessage",this.handleConsoleMessage),t.removeEventListener("fullscreen",this.handleOnFullscreen)),n&&(C.Z.zoom.getDefaultZoom((e=>n.setZoom(e))),n.addEventListener("newwindow",this.handleNewWindow),n.addEventListener("targeturlchanged",this.handleTargetURLChanged),n.addEventListener("consolemessage",this.handleConsoleMessage),n.addEventListener("fullscreen",this.handleOnFullscreen))};handleOnFullscreen=e=>{cs.Z.onHTML5FullScreen(e.enterFullscreen,this.context.vivaldiWindowId)};handleNewWindow=e=>{switch(e.preventDefault(),e.windowOpenDisposition){case"current_tab":case"new_foreground_tab":e.window.accept(this.context.vivaldiWindowId+";1");break;case"new_background_tab":e.window.accept(this.context.vivaldiWindowId+";0");break;case"new_window":cs.Z.openBrowserWindow(this.context.vivaldiWindowId,e.targetUrl);break;case"off_the_record":cs.Z.openBrowserWindow(this.context.vivaldiWindowId,e.targetUrl,{incognito:!0})}};handleTargetURLChanged=({newUrl:e})=>{const t=(0,uy.ZP)(e);c.Z.setStatus(this.context.vivaldiWindowId,t)};handleConsoleMessage=e=>{const t=this.props.inject?.messageHandler;"function"==typeof t&&t(e)};getDefaultStyle=e=>{const t=H.Z.get($.kMailColorQuotedText);return`<style type="text/css">\n    ${Uk.Z.createStyleRoot(this.props.style)}\n    html {\n      overflow-y: auto;\n    }\n    body {\n      ${e?"":"white-space: pre-wrap;"}\n      ${e?"":"overflow-wrap: break-word;"}\n      color: ${e?"black":"var(--colorFgIntense)"};\n      background-color: ${e?"white":"var(--colorBgIntense)"};\n      font-family: ${e?"sans-serif":"monospace"};\n      margin: 18px;\n      line-height: 1.3;\n      height: auto !important;\n      min-height: calc(100% - 48px);\n    }\n    .VIVcontainer {\n      all: initial;\n      display: block;\n    }\n    .blockquote {\n      border-left: 2px solid;\n      margin: 6px 0;\n      padding: 0 0 0 9px;\n      border-left-color: var(--quoteLvl1);\n      ${t?"color: var(--quoteLvl1);":""}\n    }\n    .blockquote .blockquote {\n      border-left-color: var(--quoteLvl2);\n      ${t?"color: var(--quoteLvl2);":""}\n    }\n    .blockquote .blockquote .blockquote {\n      border-left-color: var(--quoteLvl3);\n      ${t?"color: var(--quoteLvl3);":""}\n    }\n    ${e?"":"a { color: var(--colorHighlightBg); }"}\n    </style>`};getDefaultRssStyle=()=>`<style type="text/css">\n    ${Uk.Z.createStyleRoot(this.props.style)}\n    html {\n      background: var(--colorBgIntense);\n      color: var(--colorFgIntense);\n      font-family: sans-serif;\n      overflow-y: auto;\n    }\n    body {\n      margin: 24px;\n      height: auto !important;\n      min-height: calc(100% - 48px);\n    }\n    body > main {\n      font-size: initial;\n      /* feeds should not be using these variables */\n      /* prevent the feed from copying a custom theme for phishing */\n      --colorBg: white;\n      --colorFg: black;\n    }\n    body > main a {\n      color: var(--colorHighlightBg);\n    }\n    body > nav ul.mainbutton a {\n      display: inline-block;\n      padding: 0.3em 12px;\n      font-size: initial;\n      color: var(--colorHighlightFg);\n      background-color: var(--colorHighlightBg);\n      border-radius: 4px;\n    }\n    body > nav ul.mainbutton::after {\n      content: "";\n      display: block;\n      border-bottom: 1px solid var(--colorBorder);\n      height: 0.7em;\n      opacity: 0.3;\n    }\n    body > nav h2,\n    body > section h2 {\n      font-weight: normal;\n      font-size: larger;\n    }\n    body > nav h2::after,\n    body > section h2::after {\n      content: ":";\n    }\n    body > nav ul,\n    body > nav li {\n      display: block;\n      margin-left: 0;\n      padding-left: 0;\n    }\n    body > nav a {\n      color: var(--colorHighlightBg);\n      text-decoration: none;\n    }\n    body > section img,\n    body > section video,\n    main img,\n    main video,\n    main image,\n    main image,\n    main object,\n    main embed {\n      max-width: 100%;\n      /* allow default image ratio to work in cases where height has been set */\n      height: auto !important;\n    }\n    main iframe {\n      border: none;\n      max-width: 100%;\n    }\n    body > footer {\n      opacity: 0.5;\n    }\n\n    div.video-wrapper {\n      background: #111;\n      margin-left: -24px;\n      margin-top: -24px;\n      margin-right: -24px;\n      margin-bottom: 24px;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    }\n\n    div.video-wrapper iframe {\n      --cinema-mode-height: 40vw;\n      height: var(--cinema-mode-height);\n      width: calc(var(--cinema-mode-height) / .5625);\n      min-height: 320px;\n      max-height: 100vh;\n    }\n\n    div.preformatted {\n      white-space: pre-wrap;\n    }\n\n    /* Overrides for specific feed issues */\n    main figure[style*="width"] {\n      /* WordPress hard codes a width which creates scrollbars.\n      Max-width does not fix it because of the default margin.\n      Fix it without breaking feeds that have floating figures. Assume that if\n      a figure has a style attribute with width, it is probably not well\n      styled, and width should be ignored. */\n      width: auto !important;\n    }\n    </style>`;handleLoadExternalContentClicked=()=>{const e=this.refContentBlockedToggle.current?.checked??!1;this.props.onUnblockExternalContent(e)};showOriginalHTML=()=>{u.Z.toggleRenderingMethod("prefer_html")};render(){const{fromAddress:e}=this.props,{leakPrevented:t}=this.state,{convertedFromHtml:n=!1}=this.props.textOrHtml,s=[];return this.props.shouldWarnUserFrom&&s.push((0,Oe.Z)('More than one "From" address detected.')),this.props.shouldWarnUserFromName&&s.push((0,Oe.Z)('"From" name looks like an email address.')),(0,fs.jsxs)(fs.Fragment,{children:[n&&mT("div",{className:"mail-content-blocked"},void 0,mT("div",{className:"content-blocked-text"},void 0,(0,Oe.Z)("This message was converted from HTML.")),mT("input",{className:"content-blocked-action",type:"button",onClick:this.showOriginalHTML,value:(0,Oe.Z)("Show original HTML version")})),s.length>0&&mT(uT,{type:"danger"},void 0,mT("div",{className:"content-blocked-text"},void 0,s.length>1?mT("ul",{},void 0,s.map((e=>mT("li",{},e,e)))):s[0]+" ",(0,Oe.Z)("Someone may be trying to hide their identity (spoofing) to phish for information. Be careful of links you click."))),this.props.shouldWarnUserReplyTo&&mT(uT,{type:"warning"},void 0,mT("div",{className:"content-blocked-text"},void 0,(0,Oe.Z)('"Reply To" does not match the "From" address. Make sure you trust the "Reply To" address before replying.'))),t&&mT("div",{className:"mail-content-blocked"},void 0,mT("div",{className:"content-blocked-text"},void 0,(0,Oe.Z)("This message was prevented from loading external content.")),mT("label",{title:(0,Oe.Z)("Always allow $1",[e]),className:"content-blocked-toggle-container"},void 0,(0,fs.jsx)("input",{className:"content-blocked-toggle",ref:this.refContentBlockedToggle,type:"checkbox"}),mT("span",{className:"content-blocked-toggle-text"},void 0,(0,Oe.Z)("Always allow $1",[e]))),mT("input",{className:"content-blocked-action",type:"button",title:(0,Oe.Z)("Load External Content"),onClick:this.handleLoadExternalContentClicked,value:(0,Oe.Z)("Load External Content")})),mT("div",{className:"mail_body"},void 0,mT("section",{tabIndex:"0"},void 0,(0,fs.jsx)("webview",{name:"vivaldi-mail",ref:this.updateWebviewEventListeners,src:"data:text/html,<html/>"})))]})}}const CT=yT;var wT=n(88630),bT=n(11430),ST=n(99895),IT=n(82786),kT=n(76257),AT=n(70611);async function TT(e){const{mimeTree:t,raw:n}=await bT.Z.getMimeTree(e);return new ZT(t,n)}class ZT{#D;constructor(e,t){this.lock=(0,IT.M)(),this.mimeTree=e,this.#D=t}async getRaw(){let e;const t=await this.lock();try{e=this.#D}finally{t()}return e}async getByteString(){let e="";const t=await this.lock();try{e=(0,ch.DA)(this.#D)}finally{t()}return e}async parse(e){let t=[];const n=await this.lock();try{const s=await bT.Z.parseMail(this.#D,e);t=s.bodyParts,this.#D=s.raw}finally{n()}return t}#x;async parseAttachments(){if(this.#x)return this.#x;const e=[],t=(0,kT.Dc)(this.mimeTree);for(const n of t){(await this.parse(n.mimeTree)).forEach((t=>{"attachment"===t.type&&e.push(t)}))}return this.#x=e,e}async getDeliveryHeaders(){let e={};const t=await this.lock();try{e=(0,kT.Ao)(this.#D)}finally{t()}return e}async parseCalendar(){let e;const t=(0,kT.fN)(this.mimeTree);if(t){const n=await this.parse(t.mimeTree);n.length&&(e=n[0])}return e}#O;#L;async parseMainPart(e){if(this.#O&&this.#L===e)return this.#O;let t=(0,kT.yQ)(this.mimeTree,e),n=!1;if(t||"plaintext"!==e||(t=(0,kT.yQ)(this.mimeTree,"prefer_html"),t&&(n=!0)),!t)return[];let s=await this.parse(t.mimeTree);if(n){for(const e of s)if("html"===e.type){s=[{type:"text",content:(0,AT.yy)(e.content),convertedFromHtml:!0}];break}}else if("text/html"===t.mimeTree.contentType.value){const e=(0,kT.Wh)(this.mimeTree);for(const t of e){(await this.parse(t.mimeTree)).forEach((e=>s.push(e)))}}return this.#O=s,this.#L=e,s}async parseSearchPart(){const e=(0,kT.PW)(this.mimeTree);if(!e)return[];let t=[];const n=await this.lock();try{const s=await bT.Z.parseMail(this.#D,e.mimeTree);t=s.bodyParts,this.#D=s.raw}finally{n()}return t}async saveAs(e){const t=await this.lock(),n=new Blob([this.#D],{type:"message/rfc822"}),i=URL.createObjectURL(n);s.Z.downloads.download({url:i,filename:e,saveAs:!0},(()=>{URL.revokeObjectURL(i),t()}))}async writeBufferToDisk(e,t,n){const s=await this.lock();try{await ST.Z.call(e,t,n,this.#D)}finally{s()}}}var ET=n(34930);function _T(e,t){return Re.Z.messages.update(e,{rsvpState:t})}function MT(e="Undefined"){const t=(Bd.Z.getEvents()||[]).find((t=>t.uid===e&&!t.trash));if(!t)throw new Error(`Event with uid "${e}" not found.`);return t}function NT(e){const{exceptionEvents:t,...n}=e;return m.Z.createEvent(n)}const PT=new class{async replyToInvite(e,t,n,s,i,o){if("DECLINECOUNTER"===i)throw new Error(`Can not reply to invite with method ${i}`);t=function(e,t,n,s){const i=e.invites?.find((e=>e.address===t));if(!i)throw new Error("Attendee not found");return t===n?i.partstat=s:e.invites?.push({...i,address:n,partstat:s}),e}(t,n,s,i);const a="ACCEPTED"===i||"TENTATIVE"===i;let r;try{r=MT(t.uid)}catch(e){}let l,d=!1;if(r)if(d="ical"===Rd.Z.getAccountAndCalendar(r.calendarId)?.account?.account_type,o?.value){const e=(0,Vd.Uq)(o),l=r.recurrenceExceptions?.find((t=>t.date===e));if(!l&&a){const n=await NT(t);m.Z.createException(r.id,n.id,!1,e),r=n}else if(l?.exception_event_id){const e=Bd.Z.getEvent(l.exception_event_id);if(!e)throw new Error("Database inconsistency. Exception event not found.");!async function(e,t,n,s){const{invites:i}=e,o=i?.findIndex((e=>e.address===t));if(!i||"number"!=typeof o||-1===o)throw new Error("Attendee not found");if(t===n){const{event_id:t,...n}=i[o],a=await C.Z.calendar.updateInvite({...n,partstat:s});return(0,V.Uy)(e,(e=>{e.invites&&(e.invites[o]=a)}))}{const{id:t,...a}=i[o],r=await C.Z.calendar.createInvite({...a,name:a.name??"",event_id:a.event_id,address:n,partstat:s});(0,V.Uy)(e,(e=>{e.invites&&e.invites.push(r)}))}}(e,n,s,i),r=e}}else r.invites&&!d&&(r=await this.updateEventInCalendar(t,r));else a&&(r=await NT(t));r||(r=function(e){const t=(e.invites||[]).map((e=>({...e,event_id:"",id:""}))),n=(e.notifications||[]).map((e=>({...e,id:""}))),{is_template:s,exceptionEvents:i,...o}=e;return{...o,id:"",start:e.start||0,end:e.end||0,notifications:n,invites:t,attachment:Rd.Z.stringToAttachments(e.attachment)}}(t)),l=r.invites?.length?r.invites:t.invites?.map((e=>({...e,id:"",event_id:r?.id??""})));const c=l?.find((e=>e.address===s));if(!c)throw new Error("Attendee email address not found");const h={...r,invites:[c],organizer:r.organizer||t.organizer};await ET.Z.sendReplyMails(e,h,n,s,i);const p=u.Z.getActiveMessage();p&&(p.rsvpState=i,_T(p.id,p.rsvpState),Pf.Z.setActiveMessage(p))}async declineCounter(e,t,n,s){let i;try{i=MT(t.uid)}catch(e){return void et.Z.error("Calendar",["invite"],"Error finding existing event to decline counter for",t)}await ET.Z.sendReplyMails(e,i,n,s,"DECLINECOUNTER");const o=u.Z.getActiveMessage();if(o){const e={...o,rsvpState:"DECLINECOUNTER"};_T(e.id,e.rsvpState),Pf.Z.setActiveMessage(e)}}addEventToCalendar(e,t){return NT(e)}updateEventInCalendar(e,t){const{is_template:n,exceptionEvents:s,...i}=e,o=t.invites||[],a=i.invites||[],r=o.map((e=>{const t=a.find((t=>t.address===e.address));if(t)return{...e,partstat:t.partstat,name:t.name}})).filter(Boolean);a.forEach((e=>{o.find((t=>t.address===e.address))||r.push({...e,event_id:t.id,id:""})}));const l={...i,id:t.id,start:i.start||t.start,end:i.end||t.end,notifications:t.notifications,invites:r,attachment:Rd.Z.stringToAttachments(i.attachment)},d=l.rrule?"all":"single";return m.Z.updateEvent(l,d)}handleCancellation(e,t){const n=MT(e.uid);if(t){const e=(0,Vd.Uq)(t),s=`${n.id}:${e}`;m.Z.trashEvent(s,{sendEmails:!1,saveMode:"single"})}else m.Z.trashEvent(n.id,{sendEmails:!1})}handleReply(e){const t=MT(e.uid);if(!t.invites)throw new Error("Target event missing invites data.");if(!e.invites)throw new Error("Incoming event missing invites data.");const n=e.invites[0];let s=!1;t.invites.forEach((e=>{e.address===n.address&&(C.Z.calendar.updateInvite({id:e.id,partstat:n.partstat}),s=!0)})),s&&m.Z.loadPromise()}};var DT=n(15805);function xT(e,t){const[n,s]=(0,hs.useState)(e.getState());return(0,hs.useEffect)((()=>{function n(){s(e.getState())}return e.addListener(n,t),()=>e.removeListener(n)}),[e,t]),n}var OT,LT=n(34155);function RT(e,t,n,s){OT||(OT="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:OT,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const BT=function(e,t){return"0"!==e&&e.length<t?e.padStart(t,"0"):e.length>t?e.slice(e.length-t):e};function FT(e){function t(e,t){return t.findIndex((t=>t[0].toUpperCase()===e[0].toUpperCase()&&t.length<e.length))}function n(e){return["d","m","y"].includes(e?.[0].toLowerCase())}const s=e.match(/(d+|m+|y+)|([^dmy]*)/gi)?.slice(0,-1);if(!s)return console.log("Incompatible date format found: "+e),FT("yyyy-mm-dd");const i=[],o=[];let a="",r=s.shift();for(;r&&a.length<3;){for(;r&&!n(r);)r=s.shift();if(!r)break;-1!==t(r,s)||a.includes(r[0].toLowerCase())||(i.push(r),a+=r[0].toLowerCase(),n(s[0])?o.push(""):o.push(s.shift())),r=s.shift()}let l=i.map((e=>e[0].toLowerCase())).join("");if("dm"===l?l="dmy":"md"===l&&(l="ymd"),3!==l.length)return console.log("Incompatible date format found: ",e,l),FT("yyyy-mm-dd");return{fields:l.split("").map((t=>{switch(t){case"d":return{type:"day",format:"dd"};case"m":return{type:"month",format:"mm"};case"y":return{type:"year",format:"yyyy"};default:throw new Error(`Unexpected date format group: ${t}, ${e}`)}})),separators:o}}class VT extends hs.PureComponent{static contextType=xi.Z;_focused=!1;hidden=hs.createRef();fieldRefs={day:this.props.dayInputRef||hs.createRef(),month:hs.createRef(),year:hs.createRef()};inputPosition=-1;constructor(e){super(e),this._template=FT(this.getFormat());const[t,n,s]=this.props.value.split("-");this.state={year:t,month:n,day:s}}componentDidUpdate(e){e.value!==this.props.value&&this.setCache()}setCache=()=>{const[e,t,n]=this.props.value.split("-");this.setState({year:e,month:t,day:n})};getFormat=()=>this.props.format||N().localeData().longDateFormat("L");processChange=e=>{this.props.onChange(e)};select=e=>{this.inputPosition=-1,e.target instanceof this.context.HTMLInputElement&&(e.preventDefault(),e.target.select())};focus=()=>{this.fieldRefs[this._template.fields[0].type]?.current?.focus()};onKeyDown=e=>{this.props.onKeyDown&&this.props.onKeyDown(e);const{key:t,target:n}=e,s=n.dataset.type,i=this._template.fields.findIndex((e=>e.type===s));if(t&&("ArrowLeft"===t||"ArrowRight"===t||"ArrowDown"===t))switch(t){case"ArrowRight":e.preventDefault();const t=this.fieldRefs[this._template.fields[i+1].type];return void(t&&t.current.select());case"ArrowLeft":e.preventDefault();const n=this.fieldRefs[this._template.fields[i-1].type];return void(n&&n.current.select());case"ArrowDown":return void(e.altKey&&(e.preventDefault(),this.hidden.current?.showPicker()))}isNaN(Number(t))&&LT.nextTick((()=>{const{document:e,HTMLInputElement:t}=this.context;e.activeElement instanceof t&&e.activeElement.select()}))};skipToNextField(e){const{document:t}=this.context,n=this._template.fields.length,s=this._template.fields.findIndex((t=>t.type===e))+1;s===n&&(this.props.autoFocusNextElement??H.Z.get($.kCalendarAutoTabDatetime))?LT.nextTick((()=>{ol(t)})):LT.nextTick((()=>{const e=this._template.fields[Math.min(s,n-1)].type;this.fieldRefs[e].current?.select()}))}onChangeDate=e=>{const{type:t}=e.target.dataset;let n=parseInt(e.target.value);const s=[this.state.year,this.state.month,this.state.day],i=!e.nativeEvent.inputType,o=i&&this.props.step?parseInt(this.props.step):1;let a=!1;if(i&&"day"===t){const e=parseInt(this.state.day);a=!0,n=n<e?e-o:e+o}const r="year"===t?4:2,l="year"===t?9999:"month"===t?12:N()(this.props.value).daysInMonth(),d=e.target.value===r||i?1:0;parseInt(n)>l?i?n%=l:n=l:n<d&&(n=i?l:d);let c=n.toString();i&&(c=BT(c,r)),a&&e.target.setAttribute("value",c),!i&&(10*n>l||e.target.value.length>=r)&&(c=BT(c,r),this.skipToNextField(t)),this.setState({[t]:c},(()=>{const e=["year","month","day"].indexOf(t);if(c.length<r)return;s[e]=c;const n=N()(s.join("-"));if(n.isValid()){if(this.props.min&&n.isBefore(N()(this.props.min))||this.props.max&&n.isAfter(N()(this.props.max)))return;const e=this.hidden.current,t=(Object.getOwnPropertyDescriptor(HTMLInputElement.prototype,"value")||{}).set;e&&t&&(t.call(e,(0,q.SI)(n)),e.dispatchEvent(new Event("input",{bubbles:!0})))}}))};onFocus=e=>{if(e.persist(),e.preventDefault(),this._focused)return;const t=e.target.closest(".dateInput");LT.nextTick((()=>{const{document:n,HTMLElement:s}=this.context;this.props.onFocus&&t instanceof s&&sl(n,t)&&(this._focused=!0,this.props.onFocus(e))}))};onBlur=e=>{const t=this._template.fields.reduce(((e,t)=>{const n=this.state[t.type];return n.length<t.format.length&&(e[t.type]=BT(n,t.format.length)),e}),{});Object.keys(t).length>0&&this.setState(t),e.preventDefault(),e.persist();const n=e.target.closest(".dateInput");LT.nextTick((()=>{const{document:t,HTMLElement:s}=this.context;this.props.onBlur&&n instanceof s&&!sl(t,n)&&(this._focused=!1,this.props.onBlur(e))}))};keepFocusWithin=e=>{e.preventDefault(),sl(this.context.document,e.target.nextElementSibling)||this.focus()};renderFields=()=>{const e=[this._template.fields[0].type,this._template.separators[0]??"/",this._template.fields[1].type,this._template.separators[1]??this._template.separators[0]??"/",this._template.fields[2].type],t={onFocus:this.select,onMouseDown:this.select,onMouseUp:e=>e.preventDefault(),onKeyDown:this.onKeyDown,onChange:this.onChangeDate,disabled:this.props.disabled};return RT("span",{className:"faux date"},void 0,e.map(((e,n)=>{switch(e.toLowerCase()){case"day":return(0,hs.createElement)("input",{...t,autoFocus:0===n&&this.props.autoFocus,key:"dd_"+n,className:"dateInputDay",type:"number",ref:this.fieldRefs.day,"data-type":"day",tabIndex:this.props.tabIndex,placeholder:(0,Oe.Z)("dd"),value:this.state.day});case"month":return(0,hs.createElement)("input",{...t,autoFocus:0===n&&this.props.autoFocus,key:"mm_"+n,className:"dateInputMonth",type:"number",ref:this.fieldRefs.month,"data-type":"month",tabIndex:this.props.tabIndex,placeholder:(0,Oe.Z)("date","mm"),value:this.state.month});case"year":return(0,hs.createElement)("input",{...t,autoFocus:0===n&&this.props.autoFocus,key:"yy_"+n,className:"dateInputYear",type:"number",ref:this.fieldRefs.year,"data-type":"year",tabIndex:this.props.tabIndex,placeholder:(0,Oe.Z)("yyyy"),value:this.state.year});default:return RT("span",{className:"dateInputSeparator"},"separator_"+n,e)}})))};render(){const{format:e,onChange:t,tabIndex:n,onFocus:s,onBlur:i,dayInputRef:o,...a}=this.props;return RT("span",{className:"dateInput",title:this.props.title,onBlur:this.onBlur,onFocus:this.onFocus},void 0,(0,fs.jsx)("input",{...a,type:"date",ref:this.hidden,tabIndex:"-1",className:"dateInputHidden",onMouseDown:this.keepFocusWithin,onChange:this.processChange}),this.renderFields(),RT("span",{className:"arrowDown",dangerouslySetInnerHTML:{__html:Ts.uIM}}))}}const WT=VT;var UT,HT=n(49550),zT=n(80008),GT=n.n(zT),$T=n(82191),KT=n(47543);function jT(e){return{[$T.Ci.DAILY]:"days",[$T.Ci.WEEKLY]:"weeks",[$T.Ci.MONTHLY]:"months",[$T.Ci.YEARLY]:"years"}[e]||"none"}function YT(e,t,n,s){UT||(UT="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:UT,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const XT=new Map([["none",{name:(0,Oe.Z)("No repeat"),frequency:void 0}],["days",{name:(0,Oe.Z)("Daily"),frequency:$T.Ci.DAILY}],["weeks",{name:(0,Oe.Z)("Weekly"),frequency:$T.Ci.WEEKLY}],["months_dom",{name:(0,Oe.Z)("Monthly by date"),frequency:$T.Ci.MONTHLY}],["months_dow",{name:(0,Oe.Z)("Monthly by week"),frequency:$T.Ci.MONTHLY}],["years",{name:(0,Oe.Z)("Yearly"),frequency:$T.Ci.YEARLY}]]),QT=e=>{if(!e)return(0,Oe.Z)("No repeat");const{count:t,dtstart:n,until:s,interval:i=1}=e.origOptions,o=GT()(n).format("LL");let a="",r="";if(i<=2)switch(e.origOptions.freq){case $T.Ci.DAILY:a=(0,Oe.Z)("Repeats daily","Repeats every other day",[i]);break;case $T.Ci.WEEKLY:a=(0,Oe.Z)("Repeats weekly","Repeats every other week",[i]);break;case $T.Ci.MONTHLY:a=(0,Oe.Z)("Repeats monthly","Repeats every other month",[i]);break;case $T.Ci.YEARLY:a=(0,Oe.Z)("Repeats yearly","Repeats every other year",[i])}else switch(e.origOptions.freq){case $T.Ci.DAILY:a=(0,Oe.Z)("Repeats every $1 days","Repeats every $1 days",[i]);break;case $T.Ci.WEEKLY:a=(0,Oe.Z)("Repeats every $1 weeks","Repeats every $1 weeks",[i]);break;case $T.Ci.MONTHLY:a=(0,Oe.Z)("Repeats every $1 months","Repeats every $1 months",[i]);break;case $T.Ci.YEARLY:a=(0,Oe.Z)("Repeats every $1 years","Repeats every $1 years",[i])}if(t&&t>0)r=(0,Oe.Z)("$1 time beginning $2","$1 times beginning $2",[t,o]);else if(s){const e=GT()(s).format("LL");r=(0,Oe.Z)("from $1 to $2",[o,e])}else r=(0,Oe.Z)("beginning $1",[o]);return(0,Oe.Z)("$1, $2",[a,r])};var qT=YT("hr",{});class JT extends hs.Component{static contextType=xi.Z;constructor(e){super(e);const t=GT()().startOf("week");this.week=[...Array(7).keys()].map((()=>{const e={name:t.format("dddd"),number:(t.day()+6)%7};return t.add(1,"day"),e}));const n=e.event.rrule?.match(/BYMONTHDAY=([\d,]+)/)?.[1].split(",");n&&(this.monthDates=n.join(", ")),this.state={showMonthPicker:!1}}domPickerRef=hs.createRef();storedFocusElement=null;isTypingDate=!1;endDateElement=hs.createRef();changeField=e=>{if(!this.recurrence)return;let{value:t}=e.currentTarget;const n=e.currentTarget.name;"number"===e.currentTarget.type&&(t=parseInt(t),(isNaN(t)||t<1)&&(t=0),"count"===n&&t&&(t+=1)),this.recurrence=(0,KT.yu)(this.recurrence,{[n]:t}),this.props.updateEvent({...this.props.event,rrule:this.recurrence.toString()})};verifyValidValue=e=>{const{recurrence:t}=this;if(!t)return;const n=e.currentTarget.name;let{value:s}=e.currentTarget;"number"===e.currentTarget.type&&(s=parseInt(s),(isNaN(s)||s<1)&&(s=1,"count"===n&&(s+=1),this.recurrence=(0,KT.yu)(t,{[n]:s}),this.props.updateEvent({...this.props.event,rrule:this.recurrence.toString()})))};changeRecurrence=e=>{this.props.updateEvent(function(e,t){const n=new Date((0,Bu.oJ)(t));let s;switch(e){case"days":s=(0,KT.Ns)({dtstart:n,freq:$T.Ci.DAILY,interval:1});break;case"weeks":s=(0,KT.Ns)({dtstart:n,freq:$T.Ci.WEEKLY,interval:1,byweekday:(n.getDay()+6)%7});break;case"months_dom":s=(0,KT.Ns)({dtstart:n,freq:$T.Ci.MONTHLY,interval:1,bymonthday:n.getDate()});break;case"months_dow":const e=Math.ceil(n.getDate()/7),t=(0,KT._7)(n.getDay()).nth(e);s=(0,KT.Ns)({dtstart:n,freq:$T.Ci.MONTHLY,interval:1,byweekday:t});break;case"years":s=(0,KT.Ns)({dtstart:n,freq:$T.Ci.YEARLY,interval:1});break;default:s=""}return{...t,rrule:s}}(e.currentTarget.value,this.props.event))};changeDate=e=>{this.props.updateEvent(function(e,t){const{rrule:n,start:s,timezone:i}=t,o=(0,KT.Qj)(n,s,i);if(!o)return t;const a=(0,KT.yu)(o,{until:GT()(e).endOf("day").toDate(),count:void 0});return{...t,rrule:a?.toString()}}(e.currentTarget.value,this.props.event))};changeEnds=e=>{this.props.updateEvent(function(e,t){const{rrule:n,start:s,timezone:i}=t,o=(0,KT.Qj)(n,s,i);if(!o)return t;let a;switch(e){case"forever":a=(0,KT.yu)(o,{until:void 0,count:void 0});break;case"endDate":const e=jT(o.origOptions.freq);a=(0,KT.yu)(o,{count:void 0,until:GT()((0,Bu.oJ)(t)).add(1,e).toDate()});break;case"count":a=(0,KT.yu)(o,{count:2,until:void 0})}return{...t,rrule:a?.toString()}}(e.target.value,this.props.event))};changeDayOfMonth=e=>{const{recurrence:t}=this;if(!t)return;this.monthDates=e.currentTarget.value;const n=this.monthDates.split(",").map((e=>parseInt(e))).filter((e=>e>=1&&e<=31));n.length&&(this.recurrence=(0,KT.yu)(t,{bymonthday:n}),this.props.updateEvent({...this.props.event,rrule:this.recurrence.toString()}))};toggleDayOfMonthPicker=()=>{const{document:e}=this.context;this.setState((e=>({showMonthPicker:!e.showMonthPicker})),(()=>{if(this.state.showMonthPicker){this.storedFocusElement=e.activeElement;const t=e.querySelector("button[name='1-dayOfMonth']");t&&t.focus()}}))};hideDayOfMonthPicker=()=>{this.setState({showMonthPicker:!1},(()=>{this.storedFocusElement&&(this.storedFocusElement.focus(),this.storedFocusElement=null)}))};dayOfWeekPickerClick=e=>{e.target.focus();const{recurrence:t}=this;if(!t)return;const n=parseInt(e.target.name);if(isNaN(n))throw new Error("Can not select day, invalid day value");const s=new Set((0,KT.IK)(t));s.has(n)&&s.size>1?s.delete(n):s.add(n),this.recurrence=(0,KT.yu)(t,{byweekday:Array.from(s)}),this.props.updateEvent({...this.props.event,rrule:this.recurrence.toString()})};dayOfMonthPickerClick=e=>{e.target.focus();const t=parseInt(e.target.name);this.selectDayOfMonth(t)};selectDayOfMonth=e=>{const{recurrence:t}=this;if(!t)return;const n=new Set((0,KT.v1)(t));n.has(e)&&n.size>1?n.delete(e):n.add(e);const s=Array.from(n).sort(((e,t)=>e-t));this.monthDates=s.join(", ")??"",this.recurrence=(0,KT.yu)(t,{bymonthday:s}),this.props.updateEvent({...this.props.event,rrule:this.recurrence.toString()})};monthPickerBlur=e=>{const t=this.domPickerRef.current;t&&e.relatedTarget instanceof Node&&!t.contains(e.relatedTarget)&&this.setState({showMonthPicker:!1})};dayOfWeekPickerKeyDown=e=>{const{document:t}=this.context,n=t.activeElement;if(!n||!n.hasAttribute("name"))return;const s=GT()().localeData().firstDayOfWeek(),i=(parseInt(n.name)-s+7)%7;let o=null;switch(HT.Z[e.keyCode]){case"Left":i>0&&(o=i-1);break;case"Right":i<6&&(o=i+1);break;default:return}if(null!==o){o=(o+s)%7;const e=t.querySelector(`button[name='${o}-dayOfWeek']`);e&&(e.tabIndex=0,e.focus(),n.tabIndex=-1)}};dayOfMonthPickerKeyDown=e=>{if(!this.state.showMonthPicker&&"Down"===HT.Z[e.keyCode])return void this.toggleDayOfMonthPicker();const{document:t}=this.context,n=t.activeElement;if(!n||!n.hasAttribute("name"))return;const s=parseInt(n.name);let i;switch(HT.Z[e.keyCode]){case"Up":s>7&&(i=s-7);break;case"Down":s<25&&(i=s+7);break;case"Left":s%7!=1&&(i=s-1);break;case"Right":s%7!=0&&(i=s+1);break;case"Enter":return this.selectDayOfMonth(s),void e.stopPropagation();case"Escape":return e.stopPropagation(),void this.hideDayOfMonthPicker();default:return}if(i){const e=t.querySelector(`button[name='${i}-dayOfMonth']`);e&&e.focus()}};weekOfMonthChange=e=>{const{recurrence:t}=this;if(!t)return;const n=parseInt(e.currentTarget.value);let[s,i]=e.currentTarget.name.split("-");s=parseInt(s);const o=(0,KT.QX)(t),a=o[s];"weekOfMonthWeek"===i?o[s]=o[s].nth(n):"weekOfMonthDay"===i&&(o[s]=KT.z3[n],void 0!==a.n&&(o[s]=o[s].nth(a.n))),this.recurrence=(0,KT.yu)(t,{byweekday:o}),this.props.updateEvent({...this.props.event,rrule:this.recurrence.toString()})};addWeekOfMonth=()=>{const{event:e}=this.props,{recurrence:t}=this;if(!t)return;const n=GT()(e.start),s=Math.ceil(n.date()/7),i=(0,KT._7)(n.day()).nth(s),o=(0,KT.QX)(t);o.push(i),this.recurrence=(0,KT.yu)(t,{byweekday:o}),this.props.updateEvent({...e,rrule:this.recurrence.toString()})};deleteWeekOfMonth=e=>{const t=parseInt(e.currentTarget.name),{recurrence:n}=this;if(!n)return;const s=(0,KT.QX)(n).splice(t,1);this.recurrence=(0,KT.yu)(n,{byweekday:s}),this.props.updateEvent({...this.props.event,rrule:this.recurrence.toString()})};renderWeekSelection(){const{recurrence:e}=this;if(!e)return null;const t=(0,KT.IK)(e);return YT("div",{className:"edit-group capped-width"},void 0,YT("div",{className:"toolbar toolbar-default calendar-week-picker"},void 0,YT("div",{className:"toolbar toolbar-group"},void 0,this.week.map(((e,n)=>{const s=t.includes(e.number),i=`${e.number}-dayOfWeek`;return YT(hs.Fragment,{},i,YT(Fa,{name:i,onClick:this.dayOfWeekPickerClick,onKeyDown:this.dayOfWeekPickerKeyDown,title:e.name.substr(0,1),tooltip:e.name,tabIndex:s?this.props.tabIndex:-1,isPressed:s}),n<this.week.length-1&&qT)})))))}renderDayOfMonthSelection(){const{event:e}=this.props;if(!this.recurrence)return null;const t=(0,KT.v1)(this.recurrence);return YT("div",{className:"edit-group capped-width"},void 0,YT("label",{},void 0,YT("span",{},void 0,(0,Oe.Z)("On days")),YT("input",{type:"text",id:"day_of_month",value:this.monthDates||GT().tz(e.start,e.timezone).date(),onChange:this.changeDayOfMonth}),YT(Fa,{className:"button-narrow",image:Ts.bcq.small,popupPosition:"below",isPopupVisible:this.state.showMonthPicker,popupWidth:240,onClick:this.toggleDayOfMonthPicker,onKeyDown:this.dayOfMonthPickerKeyDown,tabIndex:this.props.tabIndex,tooltip:(0,Oe.Z)("Show date picker"),hidePopup:this.hideDayOfMonthPicker,popupClassName:"ToolbarButtonPopup-DefaultStyles"},void 0,(0,fs.jsx)("div",{className:"dom-picker",ref:this.domPickerRef,onBlur:this.monthPickerBlur,children:YT("div",{className:"toolbar toolbar-default"},void 0,[...Array(31).keys()].map((e=>{const n=e+1;return YT(Fa,{isPressed:t.includes(n),name:`${n}-dayOfMonth`,onKeyDown:this.dayOfMonthPickerKeyDown,onClick:this.dayOfMonthPickerClick,tabIndex:this.state.showMonthPicker?this.props.tabIndex:-1,title:n.toString(),tooltip:(0,Oe.Z)("Repeat monthly on day $1",[n])},n)})))}))))}renderWeekOfMonthSelection(){if(!this.recurrence)return null;const e=(0,KT.QX)(this.recurrence);return e.map(((t,n)=>YT("div",{className:"edit-group"},n,YT("label",{},void 0,YT("select",{name:`${n}-weekOfMonthWeek`,onChange:this.weekOfMonthChange,tabIndex:this.props.tabIndex,value:t.n},void 0,YT("option",{value:"1"},void 0,(0,Oe.Z)("First")),YT("option",{value:"2"},void 0,(0,Oe.Z)("ordering","Second")),YT("option",{value:"3"},void 0,(0,Oe.Z)("Third")),YT("option",{value:"4"},void 0,(0,Oe.Z)("Fourth")),YT("option",{value:"5"},void 0,(0,Oe.Z)("Fifth")),YT("option",{value:"-1"},void 0,(0,Oe.Z)("Last")),YT("option",{value:"-2"},void 0,(0,Oe.Z)("Second last"))),YT("select",{name:`${n}-weekOfMonthDay`,onChange:this.weekOfMonthChange,tabIndex:this.props.tabIndex,value:t.weekday},void 0,this.week.map((e=>YT("option",{value:e.number},e.number,e.name)))),e.length>1&&YT("input",{type:"button",className:"circular",name:`${n}`,onClick:this.deleteWeekOfMonth,onKeyDown:this.dayOfMonthPickerKeyDown,tabIndex:this.props.tabIndex,title:(0,Oe.Z)("Remove rule"),value:"–"}),YT("input",{type:"button",className:"circular",onClick:this.addWeekOfMonth,onKeyDown:this.dayOfMonthPickerKeyDown,tabIndex:this.props.tabIndex,title:(0,Oe.Z)("Add rule"),value:"+"})))))}render(){const{event:e}=this.props,{rrule:t,start:n,timezone:s}=e;this.recurrence=(0,KT.Qj)(t,n,s);const i=this.recurrence||{origOptions:{}},{freq:o,interval:a,count:r,until:l}=i.origOptions,d=o===$T.Ci.MONTHLY?i.origOptions.byweekday?"months_dow":"months_dom":jT(o),c=void 0!==r?"count":l?"endDate":"forever",h=r&&"number"==typeof r?r-1:"";let p="";switch(o){case $T.Ci.DAILY:p=(0,Oe.Z)("day","days",[a]);break;case $T.Ci.WEEKLY:p=(0,Oe.Z)("week","weeks",[a]);break;case $T.Ci.MONTHLY:p=(0,Oe.Z)("month","months",[a]);break;case $T.Ci.YEARLY:p=(0,Oe.Z)("year","years",[a])}return(0,fs.jsxs)(fs.Fragment,{children:[YT("div",{className:"edit-group capped-width"},void 0,(0,fs.jsx)("select",{name:"frequency",ref:this.props.focusRef,onChange:this.changeRecurrence,tabIndex:this.props.tabIndex,value:d,children:Array.from(XT).map((([e,t])=>YT("option",{value:e},e,t.name)))})),"weeks"===d&&this.renderWeekSelection(),"months_dom"===d&&this.renderDayOfMonthSelection(),"months_dow"===d&&this.renderWeekOfMonthSelection(),"none"!==d&&YT("div",{className:"edit-group capped-width"},void 0,YT("label",{},void 0,YT("span",{},void 0,(0,Oe.Z)("every","every",[a])),YT("input",{type:"number",name:"interval",min:"1",disabled:!d,onChange:this.changeField,onBlur:this.verifyValidValue,tabIndex:this.props.tabIndex,value:a||""}),YT("span",{},void 0,p))),"none"!==d&&YT("div",{className:"edit-group"},void 0,(0,fs.jsxs)("select",{name:"endsRepeating",ref:this.props.focusRef,onChange:this.changeEnds,tabIndex:this.props.tabIndex,value:c,children:[YT("option",{value:"forever"},void 0,(0,Oe.Z)("Forever")),YT("option",{value:"endDate"},void 0,(0,Oe.Z)("Ending")),YT("option",{value:"count"},void 0,(0,Oe.Z)("Repeating"))]}),(0,fs.jsxs)(fs.Fragment,{children:["endDate"===c&&l&&(0,fs.jsx)(WT,{name:"endDate",onChange:this.changeDate,min:GT()(e.start).format("YYYY-MM-DD"),tabIndex:this.props.tabIndex,ref:this.endDateElement,value:GT()((0,Bu.FL)(l)).format("YYYY-MM-DD")}),"count"===c&&YT("label",{},void 0,YT("input",{size:"3",type:"number",name:"count",onChange:this.changeField,onBlur:this.verifyValidValue,min:"1",tabIndex:this.props.tabIndex,value:h}),YT("span",{},void 0,(0,Oe.Z)("time","times",[h])))]}))]})}}const eZ=JT;var tZ,nZ=n(81744);function sZ(e,t,n,s){tZ||(tZ="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:tZ,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class iZ extends hs.Component{mailLabelRef=hs.createRef();_isMounted=!1;state={breakpoint:!1,componentMaxWidth:32,shouldDetachObserver:!1,numberOfVisibleLabelsAllowed:0,numberOfCheckedLabels:(0,zf.Q3)(this.props.flags).length};componentDidMount(){this._isMounted=!0,this.state.numberOfCheckedLabels>0&&(this.setComponentMaxWidth(this.getComponentMaxWidth()),this.observerHandler())}componentWillUnmount(){this._isMounted=!1}componentDidUpdate(e,t){const n=this.mailLabelRef.current&&this.mailLabelRef.current.clientWidth;this.props.flags!==e.flags&&(this.setComponentMaxWidth(this.getComponentMaxWidth()),this.setNumberOfCheckedLabels((0,zf.Q3)(this.props.flags).length),this.observerHandler(),n&&(n>this.state.componentMaxWidth&&this.setBreakpoint(!1),n<this.state.componentMaxWidth&&this.setBreakpoint(!0)))}observerHandler=()=>{0===this.state.numberOfCheckedLabels?this.setState({shouldDetachObserver:!0}):this.setState({shouldDetachObserver:!1})};observeTargetHandler=e=>{if(!this._isMounted)return;const t=e[0].target;this.setNumberOfVisibleLabelsAllowed(t.clientWidth),t.clientWidth>this.state.componentMaxWidth&&this.setBreakpoint(!1),t.clientWidth<this.state.componentMaxWidth&&this.setBreakpoint(!0)};setNumberOfVisibleLabelsAllowed=e=>{const t=e/(32+(3+3*(e/32)));this.setState({numberOfVisibleLabelsAllowed:t})};setNumberOfCheckedLabels=e=>{this.setState({numberOfCheckedLabels:e})};setBreakpoint=e=>{this.setState({breakpoint:e})};setComponentMaxWidth=e=>{this.setState({componentMaxWidth:e})};getComponentMaxWidth=()=>{const e=(0,zf.Q3)(this.props.flags);return(32+3*this.state.numberOfVisibleLabelsAllowed)*e.length};render(){if(0===this.state.numberOfCheckedLabels)return null;let e,t=[];this.state.breakpoint?(t=(0,zf.Q3)(this.props.flags).slice(this.state.numberOfVisibleLabelsAllowed).map((e=>(0,nZ.X)(e))),e=(0,zf.Q3)(this.props.flags).slice(0,this.state.numberOfVisibleLabelsAllowed).map((e=>[(0,nZ.X)(e),(0,nZ.X)(e,!1)]))):e=(0,zf.Q3)(this.props.flags).map((e=>[(0,nZ.X)(e),(0,nZ.X)(e,!1)]));const n=t.join("\n");return(0,fs.jsx)("div",{className:this.props.className,ref:this.mailLabelRef,children:sZ(Ri,{className:"MailLabels-Observer",onResize:this.observeTargetHandler,attached:this.state.shouldDetachObserver},void 0,sZ("ul",{className:"MailLabels-Container"},void 0,e.map((([e,t])=>sZ("li",{title:e,"data-label":t,className:"MailLabels-Label"},t,e))),t.length>0&&sZ("li",{title:n,className:"MailLabels-Label MailLabels-Tooltip"},void 0,`+${t.length}`)))})}}const oZ=iZ;var aZ,rZ=n(73132);function lZ(e,t,n,s){aZ||(aZ="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:aZ,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class dZ extends hs.Component{static contextType=xi.Z;winId=this.context.vivaldiWindowId;state={activeItemIndex:-1,openDropdownMenu:!1,contact:this.props.mailAddress?Hc.Z.getContactsWithAddress(this.props.mailAddress.address):void 0,status:""};componentDidMount(){this.props.mailAddress&&Hc.Z.addListener(this.contactChanged)}componentWillUnmount(){Hc.Z.ensureRemovedListener(this.contactChanged)}contactChanged=()=>{if(this.props.mailAddress){const e=this.props.mailAddress.address.toLowerCase(),t=this.state.contact&&Hc.Z.getNodeById(this.state.contact.id);t?.emailAddresses.some((t=>t.emailAddress.toLowerCase()===e))?this.setState({contact:t}):this.setState({contact:Hc.Z.getContactsWithAddress(e)})}};onClickDropdown=()=>{this.setState((e=>({openDropdownMenu:!e.openDropdownMenu})))};closeMenu=()=>{this.setState({activeItemIndex:-1,openDropdownMenu:!1})};handleKeyDown=e=>{switch(e.key){case"Escape":case"Tab":this.closeMenu();break;case"Enter":case"Space":if(e.stopPropagation(),e.preventDefault(),this.state.activeItemIndex>-1){const e=this.getDropdownMenuItems()[this.state.activeItemIndex];e.onSuccessText?e.handler().then((()=>this.onMenuItemClicked(e.onSuccessText)),(()=>this.onMenuItemClicked(e.onErrorText))):(e.handler(),this.closeMenu())}else this.props.onClick();break;case"ArrowUp":this.setState((e=>{const t=e.activeItemIndex-1;if(t>-1)return{activeItemIndex:t}}));break;case"ArrowDown":this.setState((e=>{const t=e.activeItemIndex+1;if(t<this.getDropdownMenuItems().length)return{openDropdownMenu:!0,activeItemIndex:t}}))}};onMenuItemClicked=e=>{this.statusTimeout&&clearTimeout(this.statusTimeout);this.setState({status:e}),this.closeMenu(),this.statusTimeout=setTimeout((()=>this.setState({status:""})),1e3)};contactOrAddressString=()=>this.props.mailAddress&&this.state.contact&&!this.state.contact.generatedFromSentMail?this.state.contact.name?this.state.contact.name+" <"+this.props.mailAddress.address+">":this.props.mailAddress.address:this.props.buttonTitle;onEditContact=e=>{if(!e)return;const t=this.context.vivaldiWindowId;Pn.Z.showContent(t,"PanelContacts",{setFocus:!0,selectId:e.id,reason:"edit"}),l.Z.selectContactById(t,e.id),d.ZP.openURL(t,je.jk.internals.mailpage,{singleton:!0})};onAddContact=e=>{const t=this.context.vivaldiWindowId;Pn.Z.showContent(t,"PanelContacts"),a.Z.newContactFromMailAddress(e,!0),l.Z.selectContactByAddress(t,e.address),d.ZP.openURL(t,je.jk.internals.mailpage,{singleton:!0})};getDropdownMenuItems=()=>{if(this.props.mailAddress){const e=this.props.mailAddress;return this.state.contact?[...this.props.dropdownMenuItems,{...(0,xs.Z)("Edit contact"),handler:this.onEditContact.bind(this,this.state.contact)}]:[...this.props.dropdownMenuItems,{...(0,xs.Z)("Add to contacts"),handler:this.onAddContact.bind(this,e)}]}return this.props.dropdownMenuItems};onContextMenu=e=>{const t=this.getDropdownMenuItems().map((e=>({label:e.label,labelEnglish:e.labelEnglish,handler:e.handler})));(0,Qi.Z)(this.context,t)(e)};render(){return lZ("div",{className:"button-with-dropdown-wrapper"},void 0,lZ("div",{className:"button-with-dropdown-container",onMouseLeave:this.closeMenu,title:this.contactOrAddressString(),onContextMenu:this.onContextMenu},void 0,lZ("button",{onKeyDown:this.handleKeyDown,tabIndex:this.props.prefValues[$.kKeyboardTabToAll],onClick:this.props.onClick},void 0,this.state.contact&&lZ("img",{src:this.state.contact.avatarUrl||rZ.g}),lZ("span",{},void 0,this.contactOrAddressString())),lZ("button",{tabIndex:-1,onMouseDown:this.onClickDropdown,dangerouslySetInnerHTML:{__html:Ts.yaZ.medium}}),this.state.openDropdownMenu&&lZ("ul",{className:"dropdown-menu"},void 0,this.getDropdownMenuItems().map(((e,t)=>lZ("li",{onMouseUp:e.onSuccessText?()=>e.handler().then((()=>this.onMenuItemClicked(e.onSuccessText)),(()=>this.onMenuItemClicked(e.onErrorText))):()=>{e.handler&&e.handler(),this.closeMenu()},className:this.state.activeItemIndex===t?"active":void 0},e.label,e.label)))),this.state.status&&lZ("div",{className:"status"},void 0,this.state.status)))}}const cZ=dZ;var hZ;function pZ(e,t,n,s){hZ||(hZ="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:hZ,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class uZ extends hs.PureComponent{static contextType=xi.Z;nodeRef=hs.createRef();state={maxShown:5};onClickAddress=e=>{e.address&&Pf.Z.enableCorrespondentView(this.context.vivaldiWindowId,e.address)};render(){const e=this.state.maxShown,t=this.props.mailAddresses;return(0,fs.jsxs)("span",{ref:this.nodeRef,className:"detail",children:[t.slice(0,e).map(((e,t)=>{const n=(0,ft.li)(e),s=[{...(0,xs.Z)("Copy address"),handler:()=>yi.Z.copyTextToClipboard(n),onSuccessText:(0,Oe.Z)("Copied to clipboard",[n]),onErrorText:(0,Oe.Z)("Failed to copy address")},{...(0,xs.Z)("See messages to and from address"),handler:this.onClickAddress.bind(this,e)}];return pZ(cZ,{prefValues:this.props.prefValues,onClick:this.onClickAddress.bind(this,e),mailAddress:e,buttonTitle:n,dropdownMenuItems:s},n+String(t))})),t.length>this.state.maxShown&&pZ("a",{tabIndex:this.props.prefValues[$.kKeyboardTabToAll],onClick:()=>this.setState({maxShown:t.length})},"more",(0,Oe.Z)("... $1 more","... $1 more",[t.length-this.state.maxShown,t.length-this.state.maxShown])),5!==this.state.maxShown&&pZ("a",{tabIndex:this.props.prefValues[$.kKeyboardTabToAll],onClick:()=>this.setState({maxShown:5})},"Show less",(0,Oe.Z)("Show less"))]},"detail"+t.toString())}}const gZ=uZ;var mZ,vZ=n(10124),fZ=n(4668);function yZ(e,t,n,s){mZ||(mZ="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:mZ,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const CZ=[$.kDownloadsNotifyOnComplete,$.kDownloadsOpenPanelOnNew,$.kDownloadsStartAutomatically,$.kKeyboardTabToAll],wZ=(0,Oe.Z)("Reply To"),bZ=(0,Oe.Z)("mail","From");function SZ(e){return e?N()(e).format("LLL"):""}var IZ=yZ("span",{},"separator","→");function kZ(e){const t=new Map,n=new Map;return e.forEach(((e,n)=>{const s=tf.Z.get(n);if(!s)return;const{accountId:i,name:o}=s;let a=t.get(i);if(a||(a={internal:[],external:[]},t.set(i,a)),e.deleted&&e.internal){const e=a.internal;e.length>0&&e.push(yZ("span",{},n+"nbsp",", ")),e.push(yZ("span",{style:{textDecoration:"line-through"}},n,(0,vf.e)(o)))}else{const e=a.external;e.length>0&&e.push(yZ("span",{},n,", ")),e.push((0,vf.e)(o))}})),t.forEach((({internal:e,external:t},s)=>{n.set(s,[...e,...e.length>0?[IZ]:[],...0===t.length?[(0,Oe.Z)("Local Copy")]:[],...t])})),n}var AZ=yZ("span",{className:"label"},void 0,bZ),TZ=yZ("span",{className:"label"},void 0,wZ),ZZ=yZ("span",{className:"spacer"});class EZ extends hs.PureComponent{static contextType=xi.Z;refWebpagecontainer=hs.createRef();refSubject=hs.createRef();refFrom=hs.createRef();refTo=hs.createRef();refDate=hs.createRef();constructor(e){let t;super(e);let n=[];u.Z.getActiveListEntry()===e.listEntry&&(n=u.Z.getAttachments(),t=u.Z.getRaw()),this.state={attachments:n,dialogParentElement:void 0,customData:null,maxShownAttachments:5,raw:t}}componentDidMount(){u.Z.addListener(this.activeMessageStoreChanged)}componentWillUnmount(){u.Z.removeListener(this.activeMessageStoreChanged)}activeMessageStoreChanged=()=>{if(u.Z.getActiveListEntry()===this.props.listEntry){const e=u.Z.getAttachments(),t=u.Z.getRaw();this.setState({attachments:e,raw:t})}};async maybeParse(e){if("attachment"===e.type){const t=e.content;return"string"==typeof t?{...e,content:await(0,vZ.Z)(t)}:{...e,content:t}}if(this.state.raw){const[t]=await this.state.raw.parse(e.mimeTree);if(t&&"attachment"===t.type)return t}}async onClickAttachment(e,t){const n=await this.maybeParse(t),s=e.detail%2==0;if(n&&!s)if(this.props.prefValues[$.kDownloadsStartAutomatically]){if((0,fZ.Ve)(n),this.props.prefValues[$.kDownloadsOpenPanelOnNew]){const e=this.context.vivaldiWindowId,t="PanelDownloads";(0,bd.PK)("DownloadButton",e)?v.Z.executeActions("event",this.context,"COMMAND_SHOW_DOWNLOADS_POPOUT"):ud.ZP.canAutoOpen(e,t)&&Pn.Z.toggleContent(e,t)}}else this.showDialog((0,fZ.JX)(n))}async onClickAttachmentDropdown(e,t){const n=await this.maybeParse(e);if(!n)return;(0,fZ.Ve)(n,t);const s=this.context.vivaldiWindowId,i="PanelDownloads";this.props.prefValues[$.kDownloadsOpenPanelOnNew]&&ud.ZP.canAutoOpen(s,i)&&Pn.Z.toggleContent(s,i)}onClickDownloadAll=async e=>{const t=e.detail%2==0;if(!this.state.raw||t)return;(await this.state.raw.parseAttachments()).forEach((e=>(0,fZ.Ve)(e)))};onClickSaveAll=e=>{const{raw:t}=this.state,n=e.detail%2==0;t&&!n&&this.context.chrome.fileSystem.chooseEntry({type:"openDirectory"},(e=>{const n=s.Z.runtime.lastError;n?"User cancelled"!==n.message&&console.error("Error saving attachments",n.message||n):e?s.Z.fileSystem.getWritableEntry(e,(n=>{const s={create:!0};t.parseAttachments().then((t=>{for(const e of t){const t=(0,fZ.up)(e);n.getFile((0,fZ.BZ)(e.filename),s,(e=>{e.createWriter((e=>{e.write(t)}))}))}if(this.props.prefValues[$.kDownloadsNotifyOnComplete]){const t=new Notification(this.props.fromAddress,{body:(0,Oe.Z)("Attachments have been saved to $1",e.name),icon:"resources/mail_notification_icon.png"});setTimeout((()=>t.close()),xe.QM)}}))})):console.error("Error saving attachments, directory entry missing")}))};onClickSubject=()=>{Pf.Z.enableThreadedView(this.context.vivaldiWindowId)};_toggleSenderAsMailingList=()=>{this.props.fromAddress&&l.Z.toggleSenderAsMailingList(this.context.vivaldiWindowId,this.props.fromAddress)};_copyHeader=()=>{const{from:e,listEntry:t,message:n}=this.props,{sentDate:s,subject:i}=t,o=n?n.to:yn.Z.get(t.toIds),{cc:a=[],bcc:r=[]}=n||{},l=[[(0,Oe.Z)("mail","From"),e],[(0,Oe.Z)("To"),o],[(0,Oe.Z)("Cc"),a],[(0,Oe.Z)("Bcc"),r]];let d=i+"\n"+SZ(s);for(const[e,t]of l)t.length>0&&(d+=`\n${e}: ${(0,ft.Rz)(t)}`);d+="\n",yi.Z.copyTextToClipboard(d)};getContextMenuItemsPromise=(e,t)=>{const n=this.context.vivaldiWindowId,s=Pi.getOptionFunction(e);return Pi.getNamedMenu(n,e,(async e=>{switch(e.action){case"COMMAND_PAGE_BACK":return{isVisible:()=>Fv.Z.canGoBack(),...s(n,e,{})};case"COMMAND_PAGE_FORWARD":return{isVisible:()=>Fv.Z.canGoForward(),...s(n,e,{})};case"CONTEXT_COPY":return{handler:this._copyHeader,...s(n,e,{})};case"COMMAND_TAB_VIEW_PAGE_SOURCE":return{checked:"raw"===this.props.renderingMethod,...s(n,e,{})};case"CONTEXT_SENDER_IS_MAILING_LIST":return{handler:this._toggleSenderAsMailingList,checked:tf.Z.isSenderMailingList(this.props.fromAddress),...s(n,e,{})};default:return{...s(n,e,{})}}}))};handleOnCloseDialog=()=>{this.setState({dialogParentElement:void 0})};showDialog=e=>{this.setState({dialogParentElement:this.refWebpagecontainer.current,customData:e})};onHeaderContextMenu=e=>(e.persist(),e.preventDefault(),e.stopPropagation(),this.getContextMenuItemsPromise("mailheader",e).then((t=>{(0,Qi.Z)(this.context,t)(e)})),!1);onAttachmentContextMenu=(e,t)=>{(0,Qi.Z)(this.context,e)(t)};renderAttachmentButtons=(e,t)=>e.slice(0,t).map(((e,t)=>{const n=[{...(0,xs.Z)("Save"),handler:()=>this.onClickAttachmentDropdown(e)},{...(0,xs.Z)("Save As"),handler:()=>this.onClickAttachmentDropdown(e,"saveas")}];return yZ("button",{className:"attachment-button",onClick:t=>this.onClickAttachment(t,e),title:e.filename,tabIndex:this.props.prefValues[$.kKeyboardTabToAll],onContextMenu:this.onAttachmentContextMenu.bind(this,n)},e.filename+String(t),e.filename)}));renderSubjectButton=e=>yZ(cZ,{prefValues:this.props.prefValues,onClick:this.onClickSubject,buttonTitle:e,dropdownMenuItems:[{...(0,xs.Z)("Copy subject"),handler:()=>yi.Z.copyTextToClipboard(e),onSuccessText:(0,Oe.Z)("Copied to clipboard"),onErrorText:(0,Oe.Z)("Failed to copy subject")},{...(0,xs.Z)("See message thread"),handler:this.onClickSubject}]});render(){const{listEntry:e,message:t}=this.props,{sentDate:s,sources:i,subject:o}=e,{cc:a=[],bcc:r=[],replyTo:l=[]}=t||{},d=t?t.to:yn.Z.get(e.toIds),c=(0,zf.Zr)(e.flags).toLowerCase(),h=kZ(i);return yZ("header",{onContextMenu:this.onHeaderContextMenu,className:As()({"mail-detail-header":!0,"is-unread":gf.Z.call(i)})},void 0,this.state.dialogParentElement&&this.state.customData&&yZ(Ad,{customData:this.state.customData,onClose:this.handleOnCloseDialog}),o&&(0,fs.jsx)("h1",{className:"subject",ref:this.refSubject,children:this.renderSubjectButton(o)}),yZ("div",{className:"mail-indicators"},void 0,Of.Z.isMessageDeleted(i)&&yZ("span",{className:"mail-status-indicator read-status trash",style:{display:"flex"},dangerouslySetInnerHTML:{__html:Ts.nre.small}}),(0,zf.XN)(this.props.listEntry)&&yZ("span",{className:"mail-status-indicator",dangerouslySetInnerHTML:{__html:Ts.upG.small}}),(0,zf.B_)(this.props.listEntry)&&yZ("span",{className:"mail-status-indicator",dangerouslySetInnerHTML:{__html:Ts.hGk.small}}),c&&yZ("span",{className:`flag-color flag-${c}`,title:(0,Oe.Z)("Flagged"),dangerouslySetInnerHTML:{__html:Ts.nyn.small}})),yZ("div",{className:"mail-details"},void 0,(0,fs.jsxs)("div",{ref:this.refWebpagecontainer,className:"mail-detail-main",children:[AZ,(0,fs.jsx)(gZ,{ref:this.refFrom,prefValues:this.props.prefValues,mailAddresses:this.props.from}),l.length>0&&!(1===l.length&&this.props.fromAddress===l[0].address)&&!(0,xA.Z)(this.props.from,l)&&(0,fs.jsxs)(fs.Fragment,{children:[TZ,yZ(gZ,{prefValues:this.props.prefValues,mailAddresses:l})]}),d.length>0&&(0,fs.jsxs)(fs.Fragment,{children:[yZ("span",{className:"label"},void 0,(0,Oe.Z)("To")),(0,fs.jsx)(gZ,{ref:this.refTo,prefValues:this.props.prefValues,mailAddresses:d})]}),a.length>0&&(0,fs.jsxs)(fs.Fragment,{children:[yZ("span",{className:"label",title:(0,Oe.Z)("Carbon copy")},void 0,(0,Oe.Z)("Cc")),yZ(gZ,{prefValues:this.props.prefValues,mailAddresses:a})]}),r.length>0&&(0,fs.jsxs)(fs.Fragment,{children:[yZ("span",{className:"label",title:(0,Oe.Z)("Blind carbon copy")},void 0,(0,Oe.Z)("Bcc")),yZ(gZ,{prefValues:this.props.prefValues,mailAddresses:r})]}),(e.attachment>0||this.state.attachments.length>0)&&(0,fs.jsxs)(fs.Fragment,{children:[yZ("span",{className:"label",title:(0,Oe.Z)("Attachment"),dangerouslySetInnerHTML:{__html:n(51843)}}),yZ("span",{className:"detail attachments"},void 0,this.renderAttachmentButtons(this.state.attachments,this.state.maxShownAttachments),this.state.attachments.length>this.state.maxShownAttachments&&yZ("a",{tabIndex:this.props.prefValues[$.kKeyboardTabToAll],onClick:()=>this.setState((e=>({maxShownAttachments:e.attachments.length})))},void 0,(0,Oe.Z)("... $1 more","... $1 more",[this.state.attachments.length-this.state.maxShownAttachments,this.state.attachments.length-this.state.maxShownAttachments])),this.state.attachments.length>1&&yZ("button",{className:"attachment-button",href:"#",onClick:this.onClickSaveAll},void 0,(0,Oe.Z)("attachments","Save All")),this.state.attachments.length>1&&yZ("button",{className:"attachment-button",href:"#",onClick:this.onClickDownloadAll},void 0,(0,Oe.Z)("attachments","Download All")))]}),(0,zf.OK)(e.flags)&&(0,fs.jsxs)(fs.Fragment,{children:[yZ("span",{className:"label"},void 0,(0,Oe.Z)("Label")),yZ("div",{className:"adjustment-mail-labels"},void 0,yZ(oZ,{flags:e.flags}))]}),ZZ]}),yZ("div",{className:"mail-detail-side"},void 0,!h.has(xe.u4)&&[...h.entries()].map((([e,t])=>yZ("div",{className:"mail-detail-item"},e,t,Object.keys(mn.Z.getAccounts()).length>1&&yZ("span",{className:"mail-detail-item-accountId"},void 0,e)))),(0,fs.jsx)("div",{className:"mail-detail-item mail-detail-item-date",ref:this.refDate,children:SZ(s)}))))}}const _Z=sa(EZ,CZ),MZ={title:"",calendarId:"",is_template:!1},NZ={markup:"",style:"",prepend:!1},PZ=new TextDecoder("utf-8",{fatal:!0}),DZ={ACCEPTED:{existing:(0,Oe.Z)("You have accepted the invite"),update:(0,Oe.Z)("You accepted the previous invite")},DECLINED:{existing:(0,Oe.Z)("You have declined the invite"),update:(0,Oe.Z)("You declined the previous invite")},TENTATIVE:{existing:(0,Oe.Z)("You have tentatively accepted the invite"),update:(0,Oe.Z)("You tentatively accepted the previous invite")},"NEEDS-ACTION":{existing:(0,Oe.Z)("You still have to reply to the invite"),update:(0,Oe.Z)("You did not reply to the previous invite")},DECLINECOUNTER:{existing:(0,Oe.Z)("You have declined the counter proposal"),update:""},DELEGATED:{existing:(0,Oe.Z)("You delegated invite to another person"),update:(0,Oe.Z)("You delegated previous invite to another person")}};function xZ(e){return(0,OA.Nw)(mt(e).replace(/\n/g,"<br />")).sanitized}function OZ(e){return Uk.Z.createStyleRoot(e)+"\n  .shadowWrapper {\n    padding: 18px;\n  }\n  .Event {\n    color: var(--colorFg);\n    background-color: var(--colorBgIntense);\n    font-family: system-ui, sans-serif;\n    font-size: 13px;\n    font-weight: 400;\n    border: 1px solid var(--colorBorder);\n    border-radius: var(--radius);\n  }\n  .Event-Message {\n    padding: 12px;\n    display: flex;\n    flex-direction: row;\n    justify-content: space-between;\n    border-bottom: 1px solid var(--colorBorder);\n    align-items: center;\n  }\n  .Event-Rsvp {\n    margin-bottom: 12px;\n    padding: 6px 12px;\n    display: flex;\n    flex-direction: row;\n    justify-content: space-between;\n    align-items: center;\n    background-color: var(--colorBg);\n    border-bottom: 1px solid var(--colorBorder);\n  }\n  .Event-Error {\n    margin: 0 6px;\n    padding: 12px;\n    display: flex;\n    flex-direction: row;\n    justify-content: space-between;\n    background-color: var(--colorErrorBg);\n    border-bottom: 1px solid var(--colorBorder);\n    align-items: start;\n    font-weight: 700;\n    color: var(--colorErrorFg);\n  }\n  .Event-Title {\n    font-size: 16px;\n    margin: 12px;\n    color: var(--colorFgIntense);\n  }\n  .Event-Title--Previous {\n    font-size: 16px;\n    margin: 0;\n    font-weight: normal;\n  }\n  .Event-Title--Changed {\n    text-decoration: line-through;\n  }\n  .Event-Props {\n    display: grid;\n    grid-template-columns: max-content 1fr;\n    gap: 6px 18px;\n    margin: 12px;\n  }\n  .Event-Props--Diff {\n    grid-template-columns: max-content 1fr 1fr;\n  }\n  .Event-Props--Diff .Event-Title {\n    margin: 0;\n  }\n  .Event-Prop--Previous p {\n    text-decoration: line-through;\n  }\n  .Event-Prop--Previous p.Event-Attendee--Exists {\n    text-decoration: none;\n  }\n  span {\n    flex: 1 1 auto;\n  }\n  input[type=button] {\n    padding: 6px 18px;\n    margin-left: 6px;\n    color: var(--colorFgIntense);\n    background-color: var(--colorBgIntense);\n    border: 1px solid var(--colorBorder);\n    border-radius: var(--radius);\n    font-size: 14px;\n  }\n  input[type=button]:enabled:hover {\n    background-image: linear-gradient(var(--colorBg), var(--colorBg))\n  }\n  dd, dt, p {\n    margin: 0 0 3px 0;\n    padding: 0;\n    word-break: break-word;\n  }\n  p:last-child {\n    margin: 0;\n  }\n  dt {\n    font-weight: 600;\n  }\n  "}function LZ(e,t=!1){const n=t?(0,Oe.Z)("Can not determine email address to reply from. Which one should be used to send your reply?"):(0,Oe.Z)("More than one of your email addresses are invited. Which one should be used to send your reply?");return{title:(0,Oe.Z)("Select Reply Mail"),body:n,actions:e.map(((e,t)=>({title:e,action:e,default:0===t}))),cancelAction:{title:(0,Oe.Z)("Cancel"),action:"cancel"}}}function RZ(e,t,n){let s,i,o;try{const e=(0,DT.Z)(t);e.METHOD||(e.VEVENT[0]?.ORGANIZER&&e.VEVENT[0]?.ATTENDEE?e.METHOD="REQUEST":e.METHOD="PUBLISH"),i=e.METHOD;let n=e.VEVENT[0];if(1===n?.EXCEPTIONS?.length&&1===Object.keys(n).length&&(n=n.EXCEPTIONS[0]),!n)return et.Z.error("Mail",["invite"],"No event in invite"),{inviteInfo:{type:"parsing_error",message:(0,Oe.Z)("No event in invite")},incomingEvent:MZ};o=n["RECURRENCE-ID"],s=(0,Vd.rP)(n,Rd.Z.getDefaultCalendar()?.id||"")}catch(e){return et.Z.error("Mail",["invite"],"Error parsing iCalendar"),{inviteInfo:{type:"parsing_error",message:e.message},incomingEvent:MZ}}const a=s.invites||[];let r=n.find((e=>e.uid===s.uid&&!e.trash));if(r?.rrule&&o){const e=(0,Vd.Uq)(o),{event:t}=(0,Ku.Km)(new Date(e),r);t&&(r=t)}const l={incomingEvent:s,existingEvent:r,method:i},d=e?.rsvpState||"NEEDS-ACTION";if(r&&"ical"===Rd.Z.getAccountAndCalendar(r.calendarId)?.account?.account_type){const e="NEEDS-ACTION"===d?{type:"invite_existing_ical_unanswered"}:{type:"invite_existing_ical_answered",state:d};return{...l,inviteInfo:e}}const c=s.sequence??0,h=r?.sequence??0;if("PUBLISH"===i)return r?h<c?{...l,inviteInfo:{type:"publish_update"}}:{...l,inviteInfo:{type:"publish_existing"}}:{...l,inviteInfo:{type:"publish_not_existing"}};if("REQUEST"===i)return r?o?"NEEDS-ACTION"===d?{...l,inviteInfo:{type:"update_single_exception_unanswered",recurrenceId:o}}:{...l,inviteInfo:{type:"update_single_exception_answered",state:d,recurrenceId:o}}:r.organizer!==s.organizer?{...l,inviteInfo:{type:"update_fraudulent"}}:h<c?"NEEDS-ACTION"===d?{...l,inviteInfo:{type:"update_unanswered",prevState:d}}:{...l,inviteInfo:{type:"update_answered",state:d}}:h===c?"NEEDS-ACTION"===d?{...l,inviteInfo:{type:"invite_existing_unanswered"}}:{...l,inviteInfo:{type:"invite_existing_answered",state:d}}:{...l,inviteInfo:{type:"invite_outdated"}}:o?{...l,inviteInfo:{type:"update_single_exception_not_existing",recurrenceId:o}}:"NEEDS-ACTION"===d?{...l,inviteInfo:{type:"invite_unanswered"}}:{...l,inviteInfo:{type:"invite_answered",state:d}};if("CANCEL"===i)return o&&function(e,t){const n=e?.recurrenceExceptions;if(n?.length){const e=(0,Vd.Uq)(t);return Boolean(n.find((t=>t.cancelled&&t.date===e)))}return!1}(r,o)?{...l,inviteInfo:{type:"cancel_recurring_cancelled"}}:r?{...l,inviteInfo:{type:"cancel_existing",recurrenceId:o}}:{...l,inviteInfo:{type:"cancel_not_existing"}};if("REPLY"===i){if(1!==a.length||c>h)return{...l,inviteInfo:{type:"reply_invalid"}};const e=a[0];if(!r)return{...l,inviteInfo:{type:"reply_not_existing"}};const t=r.invites||[];if(!t.some((t=>t.address===e.address)))return{...l,inviteInfo:{type:"reply_fraudulent"}};if(c===h&&1===a.length){const{partstat:e,address:n}=a[0],s=t.find((e=>e.address===n));if(s&&s.partstat===e)return{...l,inviteInfo:{type:"reply_not_changed"}};if(s&&s.partstat!==e)return{...l,inviteInfo:{type:"reply_changed"}}}if(c<h)return{...l,inviteInfo:{type:"reply_outdated"}}}return"COUNTER"===i?c>h?{...l,inviteInfo:{type:"counter_invalid"}}:c<h?{...l,inviteInfo:{type:"counter_outdated"}}:r?d?{...l,inviteInfo:{type:"counter_existing_answered",state:d}}:{...l,inviteInfo:{type:"counter_existing_unanswered"}}:{...l,inviteInfo:{type:"counter_not_existing"}}:{...l,inviteInfo:{type:"invite_unsupported_method"}}}function BZ(e){return"string"==typeof e?e:e[0]}function FZ(e,t,n,s,i,o,a,r,l){if(!t||!n)return NZ;const{incomingEvent:d,existingEvent:c,method:h,inviteInfo:p}=RZ(t,i,o),u=H.Z.get($.kMailAccounts),g=Fv.Z.getSelectedFolder(),m=Array.from(kZ(n.sources).keys()),v=(d.invites||[]).map((e=>e.address));let f;s?.["delivered-to"]?f=BZ(s["delivered-to"]):1===t.to.length?f=t.to[0].address:s?.["x-delivered-to"]?f=BZ(s["x-delivered-to"]):s?.["x-resolved-to"]&&(f=BZ(s["x-resolved-to"]));const y=f&&v.includes(f)?f:null,C=`\n    <input type="button" value="${(0,Oe.Z)("Accept")}" onclick="console.log('Accept')" />\n    <input type="button" value="${(0,Oe.Z)("Maybe")}" onclick="console.log('Maybe')" />\n    <input type="button" value="${(0,Oe.Z)("Decline")}" onclick="console.log('Decline')" />\n  `,w=`\n    <input type="button" value="${(0,Oe.Z)("Accept")}" onclick="console.log('AcceptCounter')" />\n    <input type="button" value="${(0,Oe.Z)("Decline")}" onclick="console.log('DeclineCounter')" />\n  `,b=`<input type="button" value="${(0,Oe.Z)("Add To Calendar")}" onclick="console.log('Add')" />`,S=`<input type="button" value="${(0,Oe.Z)("Update in Calendar")}" onclick="console.log('Update')" />`;let I,k="",A="",T="";switch(p.type){case"invite_existing_ical_unanswered":k=(0,Oe.Z)("This message contains changes for an event that you have in a read only web calendar. You can reply to it here but your status will not be updated in the Calendar."),T+=C;break;case"invite_existing_ical_answered":k=(0,Oe.Z)("This message contains changes for an event that you have in a read only web calendar."),T+=DZ[p.state].existing;break;case"publish_not_existing":k=(0,Oe.Z)("This message contains event data published for your information."),A=b;break;case"publish_existing":k=(0,Oe.Z)("This message contains event data that you already have in your calendar.");break;case"publish_update":k=(0,Oe.Z)("This message contains event update published for your information."),A=S;break;case"invite_unanswered":y?(k=(0,Oe.Z)("This message contains a calendar event invite."),T+=C):k=(0,Oe.Z)("This message contains a calendar event invite. You are not invited but you can still add it to your calendar."),A=b;break;case"invite_answered":k=(0,Oe.Z)("This message contains a calendar event invite you have responded to but you don't have the event in your calendar."),A=b,T+=DZ[p.state].existing;break;case"invite_outdated":k=(0,Oe.Z)("This message contains a calendar event invite. You have a more recent version of the event in your calendar.");break;case"invite_existing_unanswered":k=(0,Oe.Z)("This message contains an invitation to an event you have in your calendar. You have not responded to the invitation."),T+=C;break;case"invite_existing_answered":k=(0,Oe.Z)("This message contains an existing event you have in your calendar."),T+=DZ[p.state].existing;break;case"update_unanswered":k=(0,Oe.Z)("This message contains an update to a calendar event.")+DZ[p.prevState].update,A=S,T+=C;break;case"update_answered":k=(0,Oe.Z)("This message contains an update to a calendar event.")+DZ[p.state].update,A=S,T+=DZ[p.state].existing;break;case"update_single_exception_answered":k=(0,Oe.Z)("This message contains an invite to make an exception to a recurring calendar event."),T+=DZ[p.state].existing,I=p.recurrenceId;break;case"update_single_exception_unanswered":k=(0,Oe.Z)("This message contains an invite to make an exception to a recurring calendar event."),A=b,T+=C,I=p.recurrenceId;break;case"update_single_exception_not_existing":k=(0,Oe.Z)("This message contains an invite to make an exception to a recurring calendar event that you do not have in your calendar. You can still accept this as a stand alone event."),A=b,T+=C,I=p.recurrenceId;break;case"update_fraudulent":k=(0,Oe.Z)("This message contains an update to a calendar event. It does not match the event you have in your calendar. Check the event details below and if it looks correct you have to delete the existing event in your calendar before you can accept this one.");break;case"cancel_existing":k=(0,Oe.Z)("This message contains an event cancellation."),A=`<input type="button" value="${(0,Oe.Z)("Remove from Calendar")}" onclick="console.log('Delete')" />`,I=p.recurrenceId;break;case"cancel_not_existing":k=(0,Oe.Z)("This message contains cancellation of an event you don’t have in your calendar.");break;case"cancel_recurring_cancelled":k=(0,Oe.Z)("This message contains cancellation of an event already cancelled in your calendar.");break;case"reply_not_existing":k=(0,Oe.Z)("This message contains an invite reply for an event you do not have in your calendar.");break;case"reply_invalid":k=(0,Oe.Z)("Invalid event invite reply found.");break;case"reply_fraudulent":k=(0,Oe.Z)("Fraudulent event invite reply found.");break;case"reply_not_changed":k=(0,Oe.Z)("This message contains an event invite reply which is already processed.");break;case"reply_changed":k=(0,Oe.Z)("This message contains an event invite reply."),A=`<input type="button" value="${(0,Oe.Z)("Update Event in Calendar")}" onclick="console.log('Partstat')" />`;break;case"reply_outdated":k=(0,Oe.Z)("This message contains an event invite reply for an older version of the event.");break;case"counter_not_existing":k=(0,Oe.Z)("This message contains a counter proposal for an event which was not found. It will be ignored.");break;case"counter_existing_unanswered":k=(0,Oe.Z)("This message contains a counter proposal for the following event."),A=w;break;case"counter_existing_answered":k=(0,Oe.Z)("This message contains a counter proposal for the following event."),k+=DZ[p.state].existing;break;case"counter_outdated":k=(0,Oe.Z)("This message contains an outdated counter proposal. It will be ignored.");break;case"counter_invalid":k=(0,Oe.Z)("This message contains an invalid counter proposal. It will be ignored.");break;case"invite_unsupported_method":k=(0,Oe.Z)("Unsupported method parameter “$1”.",[h]);break;case"parsing_error":k=(0,Oe.Z)("Error parsing calendar data. For details see logs located in Calendar button on status bar.")}T&&(T=`<span>${(0,Oe.Z)("RSVP")}</span>`+T);const Z="parsing_error"===p.type?"":function(e,t,n,s){const i=[],{url:o,location:a,organizer:r,invites:l,rrule:d}=t,c=N()(t.start),h=N()(t.end);t.allDay?c.isSame(h,"day")?(i.push([(0,Oe.Z)("Date"),c.format("LL"),""]),i.push(["","",""])):(i.push([(0,Oe.Z)("Starts"),c.format("LL"),""]),i.push([(0,Oe.Z)("Ends"),h.format("LL"),""])):(i.push([(0,Oe.Z)("Starts"),c.format("LLLL"),""]),i.push([(0,Oe.Z)("Ends"),h.format("LLLL"),""])),i.push([" ",s?(0,Oe.Z)("Single event exception"):d?QT((0,KT.Qj)(d,t.start,t.timezone)):"",""]),i.push([(0,Oe.Z)("Organizer"),r||"",""]),i.push([(0,Oe.Z)("Attendees"),l&&l.map((e=>`<p>${e.address}</p>`)).join("\r\n"),""]),i.push([(0,Oe.Z)("other","Location"),a,""]),i.push([(0,Oe.Z)("URL"),o?`<a href="${o}">${o}</a>`:"",""]),i.push([(0,Oe.Z)("Description"),xZ(t.description||""),""]);const p=parseInt(n?.sequence)||0,u=parseInt(t.sequence)||0,g=n&&("REQUEST"===e&&p<u||"COUNTER"===e&&p===u);if(g&&n){const e=N()(n.start),s=N()(n.end);if(n.allDay!==t.allDay)n.allDay?(i[0][2]=`<p>${e.format("LL")}</p>`,e.isSame(s,"day")||(i[1][2]=`<p>${s.format("LL")}</p>`)):(i[0][2]=`<p>${e.format("LLLL")}</p>`,i[1][2]=`<p>${s.format("LLLL")}</p>`);else{const o=t.allDay?"LL":"LLLL";n.start!==t.start&&(i[0][2]=`<p>${e.format(o)}</p>`),n.end!==t.end&&(i[1][2]=`<p>${s.format(o)}</p>`)}if(n.rrule!==d&&(i[2][2]=`<p>${QT((0,KT.Qj)(n.rrule,n.start,n.timezone))}</p>`),n.organizer!==r&&(i[3][2]=`<p>${n.organizer||"&nbsp"}</p>`),(0,xA.Z)((n.invites||[]).map((e=>e.address)),(l||[]).map((e=>e.address)))||(i[4][2]=n.invites&&n.invites.map((e=>`<p ${t.invites?.some((t=>t.address===e.address))?'class=" Event-Attendee--Exists"':""}>${e.address}</p>`)).join("\r\n")||"&nbsp"),a&&n.location!==a&&(i[5][2]=`<p>${n.location||"&nbsp"}</p>`),o&&n.url!==o){const e=n.url;i[6][2]=e?`<p><a href="${e}">${e}</a></p>`:"&nbsp"}t.description&&n.description!==t.description&&(i[7][2]=`<p>${xZ(n.description||"")}</p>`||"&nbsp")}const m=i.filter((e=>e[1]||e[2])),v=`<h1 class="Event-Title">${t.title}</h1>`;if(g&&n)return`\n      <dl class="Event-Props Event-Props--Diff">\n        <dt />\n        <dd>${v}</dd>\n        <dd><h2 class="${t.title===n.title?"Event-Title--Previous":"Event-Title--Previous Event-Title--Changed"}">${n.title}</h2></dd>\n      ${m.map((([e,t,n])=>{let i="Event-Prop--Previous";return" "===e&&s&&(i=""),`\n              <dt>${e}</dt>\n              <dd>${t||""}</dd>\n              <dd class="${i}">${n||""}</dd>`})).join("\r\n")}\n      </dl>\n    `;return`\n    ${v}\n    <dl class="Event-Props">\n    ${m.map((([e,t])=>`\n      <dt>${e}</dt>\n      <dd>${t||""}</dd>`)).join("\r\n")}\n    </dl>\n  `}(h,d,c,I);return{markup:`\n    <div class="Event">\n      <div class="Event-Message"><span>${k}</span>${A}</div>\n      ${T?`<div class="Event-Rsvp">${T}</div>`:""}\n      ${r&&`<div class="Event-Error">${r}</div>`}\n      ${Z}\n    </div>\n      `,style:OZ(a),prepend:!0,messageHandler:async n=>{const{message:s}=n;let i="";if("DeclineCounter"===s)i=t?.from[0].address||"";else if(["Accept","Maybe","Decline","AcceptCounter"].includes(s)||"DeclineCounter"===s&&!i){if(1===m.length)i=m[0];else if(0===m.length){if(1===u.length)i=u[0].MAIL_EMAIL;else if(g){const{accountId:e,path:t}=g;u.some((t=>t.MAIL_EMAIL===e))?i=e:t&&e===xe.Ry&&(i=t.split("/")[0])}if(!i){const{action:t}=await Ae.Z.showModal(e,{modal:LZ(u.map((e=>e.MAIL_EMAIL)),!0)});i=t}}else{const{action:t}=await Ae.Z.showModal(e,{modal:LZ(m)});i=t}if("cancel"===i)return}try{switch(s){case"Accept":if(!y)throw new Error("Can not accept invite. No attendee found.");await PT.replyToInvite(e,d,y,i,"ACCEPTED",I);break;case"Maybe":if(!y)throw new Error("Can not accept invite. No attendee found.");await PT.replyToInvite(e,d,y,i,"TENTATIVE",I);break;case"Decline":if(!y)throw new Error("Can not decline invite. No attendee found.");await PT.replyToInvite(e,d,y,i,"DECLINED",I);break;case"Add":await PT.addEventToCalendar(d,I);break;case"Update":case"AcceptCounter":c&&await PT.updateEventInCalendar(d,c);break;case"DeclineCounter":if(!y)throw new Error("Can not decline counter. No attendee found.");PT.declineCounter(e,d,y,i);break;case"Delete":PT.handleCancellation(d,I);break;case"Partstat":PT.handleReply(d)}r&&l("")}catch(e){et.Z.error("Calendar",["invite"],"Error handling invite.",e),l(`Error handling invite. ${e.message}`)}}}}const VZ={type:"text",content:""};const WZ=hs.forwardRef((function(e,t){const{windowId:n,style:s,fromAddress:i,isRss:o,isSenderTrusted:a,listEntry:r,message:l,onUnblockExternalContent:d,raw:c,renderingMethod:h,shouldWarnUserFrom:p,shouldWarnUserFromName:u,shouldWarnUserReplyTo:g}=e,m=function(e,t,n){const[s,i]=hs.useState([]);return hs.useMemo((()=>{if(e)if("raw"===n)if(t)t.getByteString().then((e=>i([{type:"text",content:e}])));else if(e.bodyParts&&"string"==typeof e.bodyParts[0].content){const t=e.bodyParts[0].content,n=(0,tT.yN)(e.bodyParts);wT.Z.build(e,t,n).then((e=>i([{type:"text",content:e}])))}else i([]);else e.bodyParts?i(e.bodyParts):t&&t.parseMainPart(n).then(i);else i([])}),[e,t,n]),s}(l,c,h),v=function(e,t){const[n,s]=hs.useState(),i=hs.useRef();return i.current=e,hs.useEffect((()=>{const n=[];return e&&"raw"!==t?((async()=>{const t=(0,kT.Dc)(e.mimeTree).filter((e=>e.mimeType&&e.mimeType.startsWith("image/")));for(const s of t){const t=await e.parse(s.mimeTree);if(1===t.length&&"attachment"===t[0].type){const{content:e,mimeType:s}=t[0],i=new Blob([e],{type:"string"==typeof s?s:""}),o=URL.createObjectURL(i);n.push(o)}}if(n.length>0&&e===i.current){const e={markup:n.map((e=>`<img src="${e}" />`)).join(""),style:"img {\n            margin-top: 12px;\n            display: inline-block;\n            vertical-align: top;\n            max-width: 100%;\n            height: auto;\n          }",prepend:!1};s(e)}else s()})(),()=>{n.forEach((e=>URL.revokeObjectURL(e)))}):s()}),[e,t]),n}(c,h),f=function(e,t,n,s,i,o){const{events:a}=xT(Bd.Z),[r,l]=hs.useState(),[d,c]=hs.useState(""),h=hs.useRef();return h.current=t,hs.useEffect((()=>{if(!s||"raw"===i)return c(""),l();(async()=>{let i,r={};const p=await s.parseCalendar();p&&t?.id===h.current?.id&&(r=await s.getDeliveryHeaders(),i="string"==typeof p.content?p.content:PZ.decode(p.content)),i?l(FZ(e,t,n,r,i,a,o,d,c)):l()})()}),[d,a,n,t,s,i,o,e]),r}(n,l,r,c,h,s);let y,C;if(c&&l&&(y=f||v),l&&(C=m.find((e=>"html"===e.type)),C||(C=m.find((e=>"text"===e.type)))),C||(C=VZ),"html"===C.type||"text"===C.type){const e=!!l&&!l.trusted&&!a;return(0,fs.jsx)(CT,{style:s,blockHTTPLeaks:e,bodyParts:"html"===C.type?m:void 0,fromAddress:i,shouldWarnUserReplyTo:g,shouldWarnUserFrom:p,shouldWarnUserFromName:u,inject:y,isRss:o,onUnblockExternalContent:d,ref:t,textOrHtml:C,renderingMethod:h},"mainBody")}return null}));var UZ=n(89378),HZ=n(28918),zZ=n(55346);const GZ={call:function(e){return Re.Z.pop.where("searchListId").equals(e).toArray()}};var $Z=n(35489);var KZ,jZ=n(83507),YZ=n(34155);function XZ(e,t,n,s){KZ||(KZ="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:KZ,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const QZ=["colorHighlightFg","colorHighlightBg","colorFg","colorBg","colorBgDark","colorFgIntense","colorBgIntense","colorBorder","radius","colorErrorFg","colorErrorBg"];function qZ(e){const t=String(e["--colorBg"]),n=String(e["--colorHighlightBg"]),s=B()(t).luminance(),i=s<.2?.7:s>.8?.3:.5,o=String(B()(n).set("hsl.h",B()(n).get("hsl.h")+80).luminance(i)),a=String(B()(n).set("hsl.h",B()(n).get("hsl.h")+160).luminance(i)),r=String(B()(n).set("hsl.h",B()(n).get("hsl.h")+240).luminance(i));return{...e,"--quoteLvl1":o,"--quoteLvl2":a,"--quoteLvl3":r}}async function JZ(e,t,n){const{id:s,sentDate:i}=t,{accountId:o}=n;await e.writeBufferToDisk(o,i,s),await ze.Z.setHasRaw(o,s)}class eE extends hs.Component{static contextType=xi.Z;messageBody=hs.createRef();messageHeader=hs.createRef();isRssFeedMessage=!1;constructor(e,t){super(e),this.state={style:qZ(z.Z.getBaseStylesByWindowId(t.vivaldiWindowId,QZ)),message:void 0,renderingMethod:H.Z.get($.kMailPreferredRendering),isSenderTrusted:!1,accountOfflineNoMessage:!1,netOfflineNoMessage:!1,rssNoMessage:!1}}_setIfActive=e=>{YZ.nextTick((()=>{const t=this.messageBody.current?.refWebview.current,n=this.context.vivaldiWindowId;e.pageIsActive?(Pf.Z.setActiveMailDetail(this),t&&HI.setActiveWebView(n,t)):(Pf.Z.clearIfActive(this),t&&HI.clearIfActive(n,t))}))};_markSeenReadIfHasBody=()=>{l.Z.markSeenReadDebounced.cancel();const{listEntry:e}=this.props,{message:t,raw:n}=this.state;if(e&&t){const{bodyParts:s}=t;e&&(n||s)&&l.Z.markSeenReadDebounced(e)}};componentDidMount(){tl.Z.addListener("COMMAND_TAB_VIEW_PAGE_SOURCE",this.onCommandSpy),tl.Z.addListener("COMMAND_MAIL_SHOW_PLAINTEXT",this.onCommandSpy),tl.Z.addListener("COMMAND_MAIL_SHOW_HTML",this.onCommandSpy),H.Z.addListener([$.kMailAccounts,$.kMailPreferredRendering,$.kMailColorQuotedText],this.onPrefsChanged),z.Z.addListener(this.onThemeStoreChanged),rf.addListener(this.onConnectionChanged),this.context.addEventListener("online",this._onOnline),tf.Z.getIndex().length>0?this.fetchMessage(this.props):tf.Z.addListener(this.checkIfReadyToReadFromDisk),this._setIfActive(this.props)}_onOnline=()=>{this.state.netOfflineNoMessage&&this.setState({netOfflineNoMessage:!1},(()=>this.fetchMessage(this.props)))};onConnectionChanged=e=>{!1!==e.isDisconnected||this.state.raw||this.setState({netOfflineNoMessage:!1},(()=>{this.props.listEntry&&(et.Z.log("Mail",["detail-view","connnection status",e.accountId],"connection established - fetch message body"),this.fetchMessage(this.props))}))};onPrefsChanged=(e,t,n)=>{switch(n){case $.kMailAccounts:this.state.accountOfflineNoMessage&&this.setState({accountOfflineNoMessage:!1},(()=>{this.props.listEntry&&this.fetchMessage(this.props)}));break;case $.kMailPreferredRendering:this.setState({renderingMethod:t});break;case $.kMailColorQuotedText:this.fetchMessage(this.props)}};checkIfReadyToReadFromDisk=e=>{"finishIndexProgress"===e.target&&(tf.Z.ensureRemovedListener(this.checkIfReadyToReadFromDisk),this.fetchMessage(this.props))};_isBeingActivated(e){return!this.props.pageIsActive&&e.pageIsActive}UNSAFE_componentWillReceiveProps(e){const t=e.listEntry?e.listEntry.id:void 0;if((this.props.listEntry?this.props.listEntry.id:void 0)!==t)this.fetchMessage(e);else if(this._isBeingActivated(e)){if(void 0!==t&&Nf.Z.drafts[t]){const t=CA.Z.getComposer();t&&t.flushPendingChanges().then((()=>this.fetchMessage(e)))}Nf.Z.drafts={}}e.pageIsActive!==this.props.pageIsActive&&this._setIfActive(e)}shouldComponentUpdate(e,t){return e.hasNoListEntries!==this.props.hasNoListEntries||(!Gi(this.state,t)||!!this.props.prefValues&&!!e.prefValues&&this.props.prefValues[$.kMailViewLayout]!==e.prefValues[$.kMailViewLayout])}componentDidUpdate(){this._markSeenReadIfHasBody()}componentWillUnmount(){tl.Z.removeListener("COMMAND_TAB_VIEW_PAGE_SOURCE",this.onCommandSpy),tl.Z.removeListener("COMMAND_MAIL_SHOW_PLAINTEXT",this.onCommandSpy),tl.Z.removeListener("COMMAND_MAIL_SHOW_HTML",this.onCommandSpy),H.Z.removeListener([$.kMailAccounts,$.kMailPreferredRendering,$.kMailColorQuotedText],this.onPrefsChanged),tf.Z.ensureRemovedListener(this.checkIfReadyToReadFromDisk),rf.removeListener(this.onConnectionChanged),this.context.removeEventListener("online",this._onOnline),z.Z.removeListener(this.onThemeStoreChanged),this._currentId=-1,YZ.nextTick((()=>{Pf.Z.clearIfActive(this);const e=this.messageBody.current?.refWebview.current;e&&HI.clearIfActive(this.context.vivaldiWindowId,e)}))}onCommandSpy=(e,t)=>{if(this.props.pageIsActive&&e===this.context.vivaldiWindowId)switch(t){case"COMMAND_TAB_VIEW_PAGE_SOURCE":this.toggleRenderingMethod("raw");break;case"COMMAND_MAIL_SHOW_PLAINTEXT":this.toggleRenderingMethod("plaintext");break;case"COMMAND_MAIL_SHOW_HTML":this.toggleRenderingMethod("prefer_html")}};onThemeStoreChanged=()=>{const e=qZ(z.Z.getBaseStylesByWindowId(this.context.vivaldiWindowId,QZ));(0,xA.Z)(this.state.style,e)||this.setState({style:e})};async updateMessage(e,t,n){const s=(0,eT.H)(n),i={searchListId:e,subject:t.subject,body:s,to:(0,UZ.Z)(t.to),cc:(0,UZ.Z)(t.cc),from:(0,UZ.Z)(t.from),replyTo:(0,UZ.Z)(t.replyTo)};if(!await C.Z.mailPrivate.updateMessage(i))throw new Error(`Failed to add body to FTS db for id ${e}`)}readRaw=async(e,t,n)=>{async function s(e){for(const s of e){const e=await jZ.Z.call(s.accountId,t,n);if(e)return e}}return await s(e.samePathFilters)||await s(e.sameAccountFilters)||await s(e.otherFilters)};fetchMessage=async e=>{const{listEntry:t}=e,n=H.Z.get($.kMailPreferredRendering);if(this.setState({message:void 0,raw:void 0,renderingMethod:n,accountOfflineNoMessage:!1,netOfflineNoMessage:!1,rssNoMessage:!1},(()=>{YZ.nextTick(Pf.Z.refreshActiveMessage)})),!t)return void et.Z.log("Mail",["detail-view","fetch-message"],"no listEntry");const{id:s,sentDate:i,sourceFilterIds:o,fromIds:a}=t;this._currentId=s;const r=await zZ.Z.call(s);if(!r)return void et.Z.log("Mail",["detail-view","fetch-message"],"no message");const d=()=>{const e=this._currentId!==r.id;return e&&et.Z.log("Mail",["detail-view","fetch-message"],"selection changed"),e};if(d())return;this.setState({message:r},Pf.Z.refreshActiveMessage);const c=H.Z.get($.kMailAccounts),h=Fv.Z.getSelectedFolder(),p=tf.Z.getByIds(o);function u(e){const t=[],n=[],s=[];for(const i of e)i.accountId!==h?.accountId||h?.path!==xe.ym&&i.path!==h?.path?i.accountId===h?.accountId?n.push(i):s.push(i):t.push(i);return{samePathFilters:t,sameAccountFilters:n,otherFilters:s}}const g=u(p);let m,v=await this.readRaw(g,s,i);if(d())return;async function f(e){const t=c.filter((e=>e.accountType===xe.s9.IMAP&&!e.offline)),n=e.filter((e=>t.find((t=>t.MAIL_EMAIL===e.accountId))));for(const e of n){const{accountId:t}=e;try{if(v=await Ie.Z.fetchRawOfMessage(t,r.id),v)return m={accountId:t,type:"imap"},v}catch(e){et.Z.info(e)}}if(!v){const t={},n=c.filter((e=>e.accountType===xe.s9.POP));if(n.length>0){const s=await fn.Z.loadAllAccounts(),i=e.filter((e=>n.find((t=>t.MAIL_EMAIL===e.accountId))));for(const e of i){const n=s.find((t=>t.MAIL_EMAIL===e.accountId));n&&(t[e.accountId]=n)}}if(Object.keys(t).length>0){const e=await GZ.call(s);for(const n of e){const{accountId:e,uidl:s}=n,i=t[e];try{return v=await Me.getPopMessage(i,s,r.id),m={accountId:e,type:"pop",uidl:s},v}catch(e){et.Z.info(e)}}}}}this.isRssFeedMessage=p.some((e=>e.accountId===xe.u4));const y=p.filter((e=>{const n=t.sources.get(e.id);return n&&!n.internal}));if(!v){const e=await $Z.Z.getBySearchListId(s);if(d())return;if(!(e.length>0&&e.every((e=>!e.hasRaw)))){const e=864e5;v=await this.readRaw(g,s,i+e)||await this.readRaw(g,s,i-e),v&&et.Z.log("Mail",["detail-view","fetch-message"],"Message was found under wrong day folder")}}if(!v){if(y.length>0&&!navigator.onLine)return this.setState({netOfflineNoMessage:!0}),void et.Z.warn("Mail",["detail-view","fetch-message"],"no network connection");const e=y.some((e=>c.find((t=>t.MAIL_EMAIL===e.accountId&&!t.offline))));if(y.length>0&&!e)return this.setState({accountOfflineNoMessage:!0}),void et.Z.warn("Mail",["detail-view","fetch-message"],"account is offline");if(this.isRssFeedMessage)return this.setState({rssNoMessage:!0}),void et.Z.warn("Mail",["detail-view","fetch-message"],"Unexpected - rss messages without a raw");if(0===y.length)return void et.Z.log("Mail",["detail-view","fetch-message"],"no external source filter");const t=u(y);if(v=await f(t.samePathFilters)||await f(t.sameAccountFilters)||await f(t.otherFilters),!v)return void et.Z.log("Mail",["detail-view","fetch-message"],"Failed to fetch message");if(d()){if(v&&m){const e=await TT(v),t=await e.parseSearchPart();await this.updateMessage(s,r,t),await JZ(e,r,m),l.Z.runStoredQueryFilters([s]),y.length>1&&(0,HZ.Z)({operation:"BUFFER_OPERATION_FETCH_RAW_FOR_ALL_SOURCES",searchListId:s}).then(Se.Z.flushBuffer)}return}}let C;if(this.isRssFeedMessage){C=function(e){if(""===e)return[];const t=Jt(e);if("string"==typeof t)return[{type:"html",content:`<html><body><p>${(0,Oe.Z)("Error: $1",[t])}</p></body></html>`}];const{feeditems:n}=t;return n.length?an(n[0]):[{type:"html",content:`<html><body><p>${(0,Oe.Z)("Error: $1",["NO_FEED_ITEM"])}</p></body></html>`}]}(new TextDecoder("utf-8").decode(v))}this.setState({isSenderTrusted:this.isRssFeedMessage||yn.Z.get(a).every((e=>Hc.Z.isTrustedEmailAddress(e.address))),message:this.isRssFeedMessage?{...r,bodyParts:C}:r,raw:this.isRssFeedMessage?new ZT({contentType:{value:"application/rss+xml",params:{}},contentID:void 0,disposition:void 0,transferEncoding:"7bit",bodyStart:0,bodyIsEmptyOrWhitespaceStub:!1,byteLength:v.byteLength,byteOffset:v.byteOffset},v):await TT(v)},(async()=>{Pf.Z.refreshActiveMessage(),y.length>1&&(0,HZ.Z)({operation:"BUFFER_OPERATION_FETCH_RAW_FOR_ALL_SOURCES",searchListId:s}).then(Se.Z.flushBuffer);const e=this.state.raw;if(!e||!m)return void(e||et.Z.log("Mail",["detail-view","fetch-message"],"no rawWrapper"));const t=await e.parseMainPart(n);await this.updateMessage(s,r,t),await JZ(e,r,m),l.Z.runStoredQueryFilters([s])}))};toggleRenderingMethod=e=>{this.setState((t=>({renderingMethod:t.renderingMethod===e?H.Z.get($.kMailPreferredRendering):e})))};onUnblockExternalContent=e=>{const t=this.state.message;var n;if(t)if(e){const e=t.from;e[0]&&(a.Z.putTrustedEmailAddress(e[0]),this.setState({isSenderTrusted:!0}))}else n=t.id,Re.Z.messages.update(n,{trusted:!0}),this.setState((e=>e.message?{message:{...e.message,trusted:!0}}:null))};shouldWarnUser=()=>{if(this.isRssFeedMessage)return!1;const e=this.state.message;if(e&&e.replyTo[0]&&e.from[0]){const t=e.from[0].address.split("@").pop(),n=e.replyTo[0].address.split("@").pop(),s=[/(^|\.)gmail\./,/(^|\.)yahoo\./,/(^|\.)hotmail\./,/(^|\.)aol.com/,/(^|\.)msn\./,/(^|\.)live\./,/(^|\.)office365\./,/(^|\.)outlook\./,/(^|\.)dmx.de/,/(^|\.)free.fr/,/(^|\.)icloud\./];if(e.replyTo.length>1||t!==n||s.some((e=>t.match(e)))&&e.from[0].address!==e.replyTo[0].address)return!0}return!1};shouldWarnUserFromName=()=>{const e=this.state.message;return!!e&&e.from.some((({name:e,address:t})=>e&&e!==t&&(0,ft.v9)(e)&&!Hc.Z.hasContact(e,t)))};render(){let e=[],t="";const{listEntry:n,hasNoListEntries:s}=this.props;if(n){const{fromIds:s}=n;e=yn.Z.get(s),t=e.length>0?e[0].address:""}const i=!this.state.accountOfflineNoMessage&&!this.state.netOfflineNoMessage&&!this.state.rssNoMessage;return XZ("div",{id:"mail_detail"},void 0,n&&(0,fs.jsx)(_Z,{ref:this.messageHeader,message:this.state.message,listEntry:n,renderingMethod:this.state.renderingMethod,from:e,fromAddress:t},this.state.message?.id||""),i&&(0,fs.jsx)("div",{...!this.props.listEntry&&{style:{display:"none"}},className:"message-body-part",children:(0,fs.jsx)(WZ,{ref:this.messageBody,windowId:this.context.vivaldiWindowId,isRss:this.isRssFeedMessage,style:this.state.style,message:this.state.message,listEntry:n,raw:this.state.raw,renderingMethod:this.state.renderingMethod,isSenderTrusted:this.state.isSenderTrusted,fromAddress:t,shouldWarnUserFrom:e.length>1,shouldWarnUserFromName:this.shouldWarnUserFromName(),shouldWarnUserReplyTo:this.shouldWarnUser(),onUnblockExternalContent:this.onUnblockExternalContent})}),i&&!n&&!s&&XZ("section",{className:"no-message-selected"},void 0,XZ("div",{dangerouslySetInnerHTML:{__html:Ts.Fii}}),XZ("div",{},void 0,(0,Oe.Z)("No message selected"))),this.state.netOfflineNoMessage&&XZ("section",{className:"no-message-selected"},void 0,XZ("div",{dangerouslySetInnerHTML:{__html:Ts.Fii}}),XZ("div",{},void 0,(0,Oe.Z)("No network connection. Unable to fetch message"))),this.state.accountOfflineNoMessage&&XZ("section",{className:"no-message-selected"},void 0,XZ("div",{dangerouslySetInnerHTML:{__html:Ts.Fii}}),XZ("div",{},void 0,(0,Oe.Z)("Account is offline. Unable to fetch message"))),this.state.rssNoMessage&&XZ("section",{className:"no-message-selected"},void 0,XZ("div",{dangerouslySetInnerHTML:{__html:Ts.Fii}}),XZ("div",{},void 0,(0,Oe.Z)("Missing feed message"))))}}const tE=eE;var nE;function sE(e,t,n,s){nE||(nE="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:nE,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class iE extends hs.PureComponent{state={listEntry:void 0};componentDidMount(){tf.Z.isInitialized()?this.getListEntry():tf.Z.addListener(this.onMailFilterStoreChange)}componentWillUnmount(){tf.Z.ensureRemovedListener(this.onMailFilterStoreChange)}onMailFilterStoreChange=e=>{"finishIndexProgress"===e.target&&(this.getListEntry(),tf.Z.ensureRemovedListener(this.onMailFilterStoreChange))};getListEntry(){const e=tf.Z.getListEntry(this.props.id);this.setState({listEntry:e})}render(){return sE("div",{id:"mail_view",className:"top"},void 0,sE(tE,{hasNoListEntries:!0,listEntry:this.state.listEntry,pageIsActive:this.props.isActive}))}}const oE=iE;var aE;function rE(e,t,n,s){aE||(aE="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:aE,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const lE=[$.kPanelsAsOverlayEnabled,$.kPanelsPosition,$.kMailListButtons,$.kMailViewDimensions,$.kMailViewLayout,$.kToolbarsMail,$.kToolbarsMailComposer,$.kToolbarsMailMessage];class dE extends hs.Component{static contextType=xi.Z;_isMounted=!1;_isConfirmationDialogVisible=!1;constructor(e,t){super(e),this.windowId=t.vivaldiWindowId,this.state={searchInput:"",showMailingLists:!0,showMailingListsButton:!1,showRead:!0,showReadButton:!1,showDeleted:!1,showDeletedButton:!1,showCustomFolder:!0,showCustomFolderButton:!1,showJunk:!1,showJunkButton:!1,showFeeds:!1,showFeedsButton:!1,showArchived:!1,showArchivedButton:!1,showSubFolders:!1,total:0,accountId:"",path:"",isPopupVisible:!1,defaultFilterOptions:void 0,hasQuery:!1,queryTotal:0},e.settingsFilter&&(this.state={...this.state,accountId:e.settingsFilter.accountId,path:e.settingsFilter.path,defaultFilterOptions:e.settingsFilter?.defaultFilterOptions,...this.updateShowButtons(e.settingsFilter.filterValue),...this.getUpdatedViews(e.settingsFilter)})}componentDidMount(){this._isMounted=!0,this.props.settingsFilter||(Fv.Z.addListener(this.selectedFolderChanged),tf.Z.addListener(this.onCountersChanged),this.selectedFolderChanged(),this._updateCounters())}componentWillUnmount(){this._isMounted=!1,this.props.settingsFilter||(Fv.Z.removeListener(this.selectedFolderChanged),tf.Z.removeListener(this.onCountersChanged))}_updateCounters=()=>{const e=tf.Z.getListEntries().length,t=tf.Z.getQueryNumFound()||0;this.setState({total:e,queryTotal:t})};onCountersChanged=e=>{this._isMounted&&"listEntries"===e.target&&this._updateCounters()};selectedFolderChanged=()=>{if(!this._isMounted)return;let e,t;const n=Fv.Z.getSelectedFolder(),s=Fv.Z.getOptions();if(s.queryFolder&&Be.Z.isValidSearch(s))e=s.queryFolder.accountId,t=s.queryFolder.path;else{if(!n)return;e=n.accountId,t=n.path}const i=tf.Z.getByFolder(e,t||xe.ym),o=i?i.filterValue:{...Be.Z.getSearchListButtons("")};i&&Be.Z.isValidSearch(s)&&(i.filterValue={...i.filterValue,...s.queryOptions}),this.setState({accountId:e,path:t,hasQuery:Boolean(s.query||s.queryAddition||s.attachments||s.sentDate),defaultFilterOptions:i?.defaultFilterOptions,...this.updateShowButtons(o),...this.getUpdatedViews(i)},(()=>this._updateCounters()))};getUpdatedViews=e=>e?Be.Z.getFilterOptions(e):{};toggleShow=e=>{const t=Fv.Z.getOptions();if(this.props.settingsFilterCallback)this.props.settingsFilterCallback(e,!this.state[e]),this.setState((t=>({[e]:!t[e]})));else{if(Be.Z.isValidSearch(t)){const n=!this.state[e];return t.queryOptions={...t.queryOptions,[e]:n},l.Z.setSearchOptions(t),void l.Z.updateQueryResults(Fv.Z.getQuery())}{const t=Fv.Z.getSelectedFolder(),n=t&&this.getOldFilter(t);if(!n)return;n.triggers&&n.triggers?.length>0?(this._isConfirmationDialogVisible=!0,Ae.Z.showMailFilterViewConfirmation(this.context.vivaldiWindowId,n.name,(t=>{this._isConfirmationDialogVisible=!1,t&&this.updateSavedFilter(e,n,!0)}))):this.updateSavedFilter(e,n)}}};updateSavedFilter=(e,t,n)=>{this.setState((s=>{const i=!s[e],o=(0,V.Uy)(t,(t=>{t.filterValue[e]=i}));return l.Z.putFilter(o,t,!!n),{[e]:i}}))};togglePopup=()=>{this.setState((e=>({isPopupVisible:!e.isPopupVisible})))};getOldFilter=e=>tf.Z.getByFolder(e.accountId,e.path||xe.ym);updateShowButtons=e=>Object.fromEntries(this.getOptionNames().map((t=>[t+"Button",this._updateShowButton(e,t+"Button")])));_updateShowButton=(e,t)=>!e.hasOwnProperty(t)||e[t];getContextMenuItems=()=>{const e=[];return this.getOptionNames().forEach((t=>{this.state[t+"Button"]&&e.push({type:"checkbox",checked:this.state[t],handler:()=>this.toggleShow(t),...(0,xs.Z)(this.convertOptionToTranslatableString(t))})})),e};onContextMenu=e=>{const{document:t,HTMLElement:n}=this.context,s=e.target instanceof n&&e.target.closest(".calendar-grid");s&&s!==t.activeElement&&s instanceof n&&s.focus(),(0,Qi.Z)(this.context,this.getContextMenuItems())(e)};getViewFilterIcon=(e,t)=>{const n="vertical"===this.props.prefValues[$.kMailViewLayout],s="text_menu"===H.Z.get($.kMailListButtons),i=this.props.settingsFilter;if((!n||i)&&s&&!t)return"";switch(e){case"showRead":return this.state[e]?Ts.tD0:Ts.LDV.small;case"showCustomFolder":return this.state[e]?Ts.Hj9:Ts.dMx.small;case"showMailingLists":return this.state[e]?Ts.ibx:Ts.GAD.small;case"showFeeds":return this.state[e]?Ts.hCY:Ts.ZU_.small;case"showJunk":return this.state[e]?Ts.K30:Ts.Qwh.small;case"showDeleted":return this.state[e]?Ts.Y41:Ts.nre.small;case"showArchived":return this.state[e]?Ts.sBl:Ts._w1.small}};getTitleAndTooltip=(e,t)=>{const n=!!this.props.settingsFilter;return{title:"text_menu"===H.Z.get($.kMailListButtons)||t||n?this.convertOptionToTranslatableString(e):void 0,tooltip:this.convertOptionToTranslatableString(e,!0)}};getButtonOrCheckbox=(e,t)=>{const n=!!this.props.settingsFilter,s="text_menu"===H.Z.get($.kMailListButtons),i="vertical"===this.props.prefValues[$.kMailViewLayout],o=s&&i&&!n||t,a=this.getTitleAndTooltip(e,t),r=a?.title;return o?rE("label",{className:As()("MailListButtons-CheckboxWrapper",this.state[e]&&"MailListButtons-CheckboxWrapper--active")},e,rE("span",{className:As()("MailListButtons-CheckboxIcon",this.state[e]&&"MailListButtons-CheckboxIcon--active"),dangerouslySetInnerHTML:{__html:this.getViewFilterIcon(e,t)}}),r,(0,fs.jsx)("input",{...a,className:"MailListButtons-Checkbox",onChange:()=>this.toggleShow(e),checked:this.state[e],type:"checkbox"})):(0,hs.createElement)(Fa,{...a,key:e,isOn:this.state[e],onClick:()=>this.toggleShow(e),image:this.getViewFilterIcon(e)})};renderButtons(e){const t=[];return this.getOptionNames().forEach((n=>{this.state[n+"Button"]&&t.push(this.getButtonOrCheckbox(n,e))})),t}getOptionNames=()=>["showRead","showCustomFolder","showMailingLists","showArchived","showFeeds","showJunk","showDeleted"];getNewDefaultOptions=()=>{const e={};return this.getOptionNames().forEach((t=>{this.state[t+"Button"]&&(e[t]=!!this.state[t])})),e};convertOptionToTranslatableString=(e,t)=>{switch(e){case"showMailingLists":return t?(0,Oe.Z)("Show Mailing Lists"):(0,Oe.Z)("Mailing Lists");case"showRead":return t?(0,Oe.Z)("Show Read"):(0,Oe.Z)("Read");case"showDeleted":return t?(0,Oe.Z)("Show Trash"):(0,Oe.Z)("Trash");case"showCustomFolder":return t?(0,Oe.Z)("Show Custom Folders"):(0,Oe.Z)("Custom Folders");case"showJunk":return t?(0,Oe.Z)("Show Spam"):(0,Oe.Z)("Spam");case"showFeeds":return t?(0,Oe.Z)("Show Feeds"):(0,Oe.Z)("Feeds");case"showArchived":return t?(0,Oe.Z)("Show Archived"):(0,Oe.Z)("Archived");default:return""}};resetToDefault=()=>{const e=vn.Z.getFolderType(this.state.accountId,this.state.path),t=Be.Z.getDefaultFilterForPath(this.state.accountId,this.state.path,e),n=this.state.defaultFilterOptions||Be.Z.getFilterOptions(t),s=Fv.Z.getSelectedFolder(),i=s&&this.getOldFilter(s);if(!i)return;const o=(0,V.Uy)(i,(e=>{for(const t in n)this.state[t+"Button"]&&(e.filterValue[t]=n[t])}));this.setState((e=>(l.Z.putFilter(o,i),n)))};menu=()=>[{handler:this.resetToDefault,...(0,xs.Z)("Reset")},{handler:this.setAsNewDefault,...(0,xs.Z)("Set as New Default")}];isDifferent=()=>{const e=vn.Z.getFolderType(this.state.accountId,this.state.path),t=Be.Z.getDefaultFilterForPath(this.state.accountId,this.state.path,e),n=this.state.defaultFilterOptions||Be.Z.getFilterOptions(t);return this.getOptionNames().some((e=>this.state[e+"Button"]&&this.state[e]!==!!n[e]))};isSearching=()=>{const e=Fv.Z.getOptions();return Be.Z.isValidSearch(e)};setAsNewDefault=()=>{const e=Fv.Z.getSelectedFolder(),t=e&&this.getOldFilter(e);if(!t)return;const n=this.getNewDefaultOptions(),s={...t,defaultFilterOptions:n};this.setState((e=>(l.Z.putFilter(s,t),{defaultFilterOptions:n})))};renderViewFilterButton=()=>{const e=mn.Z.getFolderName(this.state.accountId,this.state.path),t=this.renderButtons(!0),n=this.isDifferent(),s=this.isSearching();return rE(Fa,{tooltip:(0,Oe.Z)("View Filters"),popupPosition:"below",image:Ts.EnF.small,hidePopup:()=>{this._isConfirmationDialogVisible||this.setState({isPopupVisible:!1})},onClick:this.togglePopup,isPopupVisible:this.state.isPopupVisible,popupWidth:240,className:As()("MailListButtons-FilterIcon",{"MailListButtons-FilterIcon--active":n}),popupClassName:"MailListButtons-Popup",outsideClickIgnoreClass:"MailListButtons-TextMenuTitle"},void 0,rE("span",{className:"MailListButtons-Label"},void 0,(0,Oe.Z)('Show the following types of messages in "$1"',[e]),":"),t,n&&rE("div",{className:"MailListButtons-PopupButtonsWrapper"},void 0,rE("input",{type:"button",className:"MailListButtons-PopupButtons",onClick:this.resetToDefault,value:(0,Oe.Z)("Reset")}),!s&&rE("input",{type:"button",className:"MailListButtons-PopupButtons",onClick:this.setAsNewDefault,value:(0,Oe.Z)("Set as New Default")})))};render(){const e=!!this.props.settingsFilter,t=this.renderButtons(),n="icons_only"===H.Z.get($.kMailListButtons);if(0===t.length)return null;const s="vertical"===this.props.prefValues[$.kMailViewLayout],i=this.isDifferent(),o=(0,q.uf)(this.state.total);let a=(0,Oe.Z)("$2 message","$2 messages",[this.state.total,o]);return this.state.hasQuery&&(a=(0,Oe.Z)("Found $2 message","Found $2 messages",[this.state.total,o])),n||!s||e?rE("div",{className:As()("MailListButtons",{"MailListButtons--textMenu":!n||e,"MailListButtons--settings":e}),onContextMenu:this.onContextMenu},void 0,this.state.hasQuery&&rE("div",{title:(0,Oe.Z)("Found in all folders: $1. Found in current folder: $2",[this.state.queryTotal,this.state.total]),className:As()("MailListButtons-MessageCount",{"MailListButtons-MessageCount--hasQuery":this.state.hasQuery})},void 0,a),e?rE("span",{},void 0,(0,Oe.Z)("mail","Include messages from:")):rE("span",{className:"MailListButtons-Label"},void 0,(0,Oe.Z)("mail","Show"),":"),rE("div",{className:"toolbar toolbar-insideinput"},void 0,t),!e&&this.renderViewFilterButton()):rE("div",{className:"MailListButtons MailListButtons--popUp",onContextMenu:this.onContextMenu},void 0,rE("div",{title:(0,Oe.Z)("Found in all folders: $1. Found in current folder: $2",[this.state.queryTotal,this.state.total]),className:"MailListButtons-MessageCount"},void 0,a),rE("div",{className:As()("MailListButtons-TextMenuTitle",{"MailListButtons-TextMenuTitle--active":i})},void 0,rE("div",{onClick:this.togglePopup},void 0,(0,Oe.Z)("View Filters")),this.renderViewFilterButton()),i&&rE("div",{className:"MailListButtons-NonDefaultStateMessage"},void 0,rE("strong",{},void 0,(0,Oe.Z)("mail","Show"),": "),this.getOptionNames().filter((e=>this.state[e+"Button"]&&this.state[e])).map((e=>this.convertOptionToTranslatableString(e))).join(", ")))}}const cE=sa(dE,lE);var hE;function pE(e,t,n,s){hE||(hE="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:hE,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class uE extends hs.PureComponent{renderSubjectLine=()=>(0,fs.jsxs)(fs.Fragment,{children:[this.props.isParent&&pE("div",{className:"status-indicators"},void 0,pE("span",{className:"expand-icon",onClick:this.props.handleExpandClick,dangerouslySetInnerHTML:{__html:n(4103)}})),pE("div",{className:"subject"},void 0,this.props.queued&&pE("span",{className:"mail-queued",dangerouslySetInnerHTML:{__html:n(48783)}}),pE("div",{className:"subject-title"},void 0,this.props.variables.subject)),pE(oZ,{className:"labels",flags:this.props.flags})]});renderDataLine=()=>{const e=void 0!==this.props.level&&this.props.level>0,t=this.props.variables,s=e&&!this.props.isParent?16:0;let i=0;return"number"==typeof this.props.level&&(i=16*Math.min(this.props.level-1,5)),(0,fs.jsxs)(fs.Fragment,{children:[pE("div",{className:"status-indicators"},void 0,this.props.renderStatusIndicator(t,"vertical")),pE("div",{className:"from",style:{paddingLeft:this.props.level?`${i+s}px`:0,minWidth:this.props.level?`${50+i+s}px`:0}},void 0,this.props.isParent&&e&&pE("div",{className:"status-indicators"},void 0,pE("span",{className:"expand-icon",onClick:this.props.handleExpandClick,dangerouslySetInnerHTML:{__html:n(4103)}})),pE("div",{className:"mail-contact-name"},void 0,t.contactString),0!==this.props.attachment&&pE("span",{className:"mail-status-indicator mail-attachment-indicator",title:(0,Oe.Z)("Attachment"),dangerouslySetInnerHTML:{__html:n(51843)}})),e&&pE(oZ,{className:"labels",flags:this.props.flags}),t.flagColor&&pE("span",{className:`mail-status-indicator ${t.flagColor}`,dangerouslySetInnerHTML:{__html:Ts.nyn.small}}),pE("div",{className:"maildate"},void 0,pE("div",{className:"mailDateInfo"},void 0,t.datetime))]})};getTitle=()=>{const e=Fv.Z.getSelectedFolder(),t=e&&tf.Z.getByFolder(e.accountId,e.path),n=this.props.variables,s=gf.Z.call(this.props.sources,t)?"":` (${this.props.unseen?(0,Oe.Z)("Unseen"):(0,Oe.Z)("Unread")})`;return`${n.subject}${s}\n`+(0,Oe.Z)("From: $1",[n.contactString])+"\n"+(0,Oe.Z)("Sent: $1",[n.datetime])};render(){const e=0===this.props.level,t=0!==this.props.level;return pE("div",{className:this.props.variables.classes,"data-id":this.props.id,title:this.getTitle()},void 0,e&&(0,fs.jsxs)(fs.Fragment,{children:[pE("div",{className:"mail_entry_row data_row"},void 0,this.renderDataLine()),pE("div",{className:"mail_entry_row subject_row"},void 0,this.renderSubjectLine())]}),t&&pE("div",{className:"mail_entry_row data_row"},void 0,this.renderDataLine()))}}const gE=uE;var mE;function vE(e,t,n,s){mE||(mE="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:mE,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const fE=[$.kCalendarRelativeDates,$.kMailCountersPanelUnseenEnabled],yE={sameDay:(0,Oe.Z)("[Today] $1",["LT"]),lastDay:(0,Oe.Z)("[Yesterday] $1",["LT"]),nextDay:(0,Oe.Z)("[Tomorrow]",["LT"]),nextWeek:(0,Oe.Z)("[Next] $1",["dddd"]),lastWeek:"dddd LT",sameElse:"LL LT"},CE={...yE,lastWeek:"dddd LT",sameElse:"ll LT"},wE={...yE,lastWeek:"ddd LT",sameElse:"L LT"},bE=[145,170,205];var SE=vE("span",{className:"mail-status-indicator"}),IE=vE("span",{});class kE extends hs.Component{renderStatusIndicator=()=>{const e=SE,{selectedFilter:t,sources:s,flags:i}=this.props,o=(0,Lf.Z)(s,i),a=!!t&&vn.Z.getFolderType(t.accountId,t.path)===xe.Nz,r=t?Of.Z.isMessageDeleted(s,t,a):Of.Z.isMessageDeleted(s),l=gf.Z.call(s,t),d=this.props.isParent&&this.props.unreadInThread&&l,c=(0,xf.Z)(s);switch(!0){case o:return vE("span",{className:"mail-status-indicator read-status spam",dangerouslySetInnerHTML:{__html:Ts.Qwh.small}});case r:return vE("span",{className:"mail-status-indicator read-status trash",dangerouslySetInnerHTML:{__html:Ts.nre.small}});case c:return vE("span",{className:"mail-status-indicator read-status",dangerouslySetInnerHTML:{__html:Ts._w1.small}});case(0,zf.B_)(this.props):return vE("span",{className:"mail-status-indicator",dangerouslySetInnerHTML:{__html:Ts.hGk.small}});case(0,zf.XN)(this.props):return vE("span",{className:"mail-status-indicator",dangerouslySetInnerHTML:{__html:Ts.upG.small}});case!l:case d:return vE("span",{className:"mail-status-indicator read-status",dangerouslySetInnerHTML:{__html:n(d?85382:88826)}});default:return e}};renderFlags=(e,t,n)=>vE("span",{className:`mail-status-indicator ${t.flagColor}`,dangerouslySetInnerHTML:{__html:Ts.nyn[n]}});renderMailEntryHorizontal=e=>{const{columns:t}=this.props;if(!t)return null;const s=this.props.level&&!this.props.isParent?16:0;let i=0;"number"==typeof this.props.level&&(i=16*Math.min(this.props.level,5));const o=N()(this.props.sentDate).format("LT"),a=N()().isSame(this.props.sentDate,"day");var r=vE("span",{},void 0,o),l=vE("span",{},void 0,o);return vE("div",{className:e.classes,"data-id":this.props.id},void 0,t.map((d=>{switch(d.id){case"unread":return vE("label",{},d.id,this.renderStatusIndicator());case"sender":return vE("label",{className:"from"},d.id,vE("span",{},void 0,e.contactString));case"subject":return vE("label",{className:"subject",style:{width:t?"var(--subjectWidth)":null,marginLeft:this.props.level?`${i+s}px`:0}},d.id,this.props.isParent&&vE("span",{className:"expand-icon",onClick:this.props.handleExpandClick,dangerouslySetInnerHTML:{__html:n(4103)}}),this.props.queued&&vE("span",{className:"mail-queued",dangerouslySetInnerHTML:{__html:n(48783)}}),vE("span",{},void 0,e.subject));case"label":return vE("label",{className:"labels"},d.id,vE("div",{className:"adjustment-mail-labels"},void 0,vE(oZ,{flags:this.props.flags})));case"flag":return vE("label",{},d.id,e.messageIsFlagged&&this.renderFlags(this.props,e,"small"));case"attachment":return vE("label",{className:"mail-status-indicator mailattachment"},d.id,this.props.attachment>0&&2048!==this.props.attachment&&vE("span",{},void 0,(0,Oe.Z)("$1 item","$1 items",[this.props.attachment])),2048===this.props.attachment&&vE("span",{},void 0,(0,Oe.Z)("1+ items")));case"size":return vE("label",{className:"mailsize"},d.id,vE("span",{},void 0,fd(this.props.size,1,!1)));case"sentDate":return vE("label",{className:"maildate"},d.id,a&&d.width<=bE[0]?r:(0,fs.jsxs)(fs.Fragment,{children:[vE("span",{},void 0,e.datetime.split(o)[0]),d.width>bE[0]&&l]}));case"threads":return vE("label",{},d.id,IE);default:console.warn("Unknown column:",d.id)}})))};contactsToString(e){let t="";if(e&&e.length>0){yn.Z.get(e).forEach((e=>{t&&(t+=", "),t+=e.name?e.name:e.address}))}return t}render(){const e={mail_entry:!0,"mail-parent":this.props.isParent,"mail-child":this.props.isChild,"last-mail-child":this.props.isLastChild},t={classes:As()(e,"loading"),contactString:"",contactColumnTitle:"",datetime:"",flagColor:"",messageIsFlagged:!1,subject:""},n=this.props.prefValues[$.kMailCountersPanelUnseenEnabled]&&this.props.unseen;t.subject=this.props.subject||"(no subject)",t.messageIsFlagged=(0,zf.u9)(this.props),t.classes=As()(e,{unread:!n&&!gf.Z.call(this.props.sources,this.props.selectedFilter),unseen:n});const s=Fv.Z.getSelectedFolder(),i=s&&(s.type||s.path);[xe.Nz,xe.kY,xe.fZ].includes(i)?(t.contactString=this.contactsToString(this.props.toIds),t.contactColumnTitle=(0,Oe.Z)("mail","To")):(t.contactString=this.contactsToString(this.props.fromIds),t.contactColumnTitle=(0,Oe.Z)("mail","From")),t.messageIsFlagged&&(t.flagColor=`flag-color flag-${(0,zf.Zr)(this.props.flags).toLowerCase()}`);const o=(this.props.columns||[]).find((e=>"sentDate"===e.id)),a=o&&o.width>bE[1]&&"vertical"!==this.props.direction?o.width>bE[2]?yE:CE:wE;return t.datetime=this.props.prefValues[$.kCalendarRelativeDates]?N()(this.props.sentDate).calendar(null,a):N()(this.props.sentDate).format(a.sameElse),"horizontal"===this.props.direction||"vertical_wide"===this.props.direction?this.renderMailEntryHorizontal(t):vE(gE,{variables:t,handleExpandClick:this.props.handleExpandClick,unseen:this.props.unseen,id:this.props.id,queued:this.props.queued,flags:this.props.flags,sources:this.props.sources,isParent:this.props.isParent,level:this.props.level,attachment:this.props.attachment,renderStatusIndicator:this.renderStatusIndicator})}}const AE=sa(kE,fE);var TE=n(75995),ZE=n(47513),EE=n.n(ZE);const _E=function(e,t){return!!e.isParent&&!!e.unreadInThread&&!t(e)},ME=function(e,t,n,s){for(let i=t+1;i<e.length;i++){const t=e[i];if(!gf.Z.call(t.sources,n)||_E(t,s))return i}return-1},NE=function(e,t,n,s){for(let i=t-1;i>=0;i--){const t=e[i];if(!gf.Z.call(t.sources,n)||_E(t,s))return i}return-1},PE=function(e,t,n,s,i,o="undefined"){if("undefined"===o){if(n){const n=ME(e,t,s,i);return n>-1?n:NE(e,t,s,i)}{const n=NE(e,t,s,i);return n>-1?n:ME(e,t,s,i)}}return"previous"===o?n?NE(e,t,s,i):ME(e,t,s,i):n?("next"!==o&&console.warn("Direction to look for unread mail is not correct"),ME(e,t,s,i)):NE(e,t,s,i)};var DE,xE=n(6826),OE=n(51733);function LE(e,t,n,s){DE||(DE="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:DE,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class RE extends hs.PureComponent{refTree=hs.createRef();static contextType=xi.Z;winId=this.context.vivaldiWindowId;state={list:tf.Z.getListEntries(),sorting:{sortField:H.Z.get($.kMailSearchSortField),sortOrder:H.Z.get($.kMailSearchSortOrder),comparator:void 0,onlyScroll:!0},autoFocusEntry:!0};componentDidMount(){tf.Z.addListener(this.messageListChanged)}componentWillUnmount(){this._unbind(),tf.Z.removeListener(this.messageListChanged)}messageListChanged=e=>{switch(this.setState({autoFocusEntry:!0}),e.target){case"gotoUnread":return void this._gotoUnreadFiltered();case"gotoNextUnread":return void this._gotoNextUnread();case"gotoPreviousUnread":return void this._gotoPreviousUnread();case"listEntries":return void this.updateListEntriesDebounced(e)}};updateListEntriesDebounced=(0,no.Z)((e=>{const{isLoading:t,updateSelection:n,updateScrollPosition:s}=e,i={sortField:H.Z.get($.kMailSearchSortField),sortOrder:H.Z.get($.kMailSearchSortOrder),onlyScroll:!0},o=t?{isLoading:!0}:{isLoading:!1,sorting:i,list:tf.Z.getListEntries()};this.setState(o,(()=>{if(n)this.updateMessageSelection(s);else if(s)if("ascending"===this.state.sorting.sortOrder){const e=this.refTree.current;e?.scrollIntoView(e.getRenderArray().length)}else{this.refTree.current?.scrollIntoView(0)}}))}),100,{maxWait:200});delete=(e,t)=>{const n=this.context.vivaldiWindowId;return Fv.Z.isTrashFolderSelected()||t?Pf.Z.prepareDelete(n,!0):Pf.Z.prepareDelete(n,!1)};isValidAddTarget=xE.Z;hasChildren=e=>Boolean(e.children&&e.children.length);isFolder=e=>this.hasChildren(e);getSelectedNodes=()=>{const e=this.refTree.current;if(!e)return[];const t=e.selectionModel.selectedIds,n=e.getRenderArray().map((e=>e.node));return t.map((e=>n.find((t=>t.id===e.id)))).filter(Boolean)};getNumSelected=()=>this.refTree.current?this.refTree.current.selectionModel.selectedIds.length:0;_findIndex=(e,t,n)=>{if(-1===e)return 0===t.length||"ascending"===this.state.sorting.sortOrder?-1:-t.length-1;let s=tf.Z.getListEntry(e);if(s||this.selectedEntry?.id!==e||(s=this.selectedEntry),!s)return-1;if("threads"===this.state.sorting.sortField&&"descending"===this.state.sorting.sortOrder){const e=(e,t)=>e.threadKey[0]===t.threadKey[0]?t.threadKey[1]-e.threadKey[1]:t.threadKey[0]-e.threadKey[0];let n=EE()(t,s,e);if(n>=0){for(;n>0&&0===e(t[n-1],s)&&(0,OE.HT)(t[n],s)>0;)n--;for(;n<t.length-1&&0===e(t[n],s)&&(0,OE.HT)(t[n],s)<0;)n++;s!==t[n]&&(n=-n-1)}return n}return EE()(t,s,n)};setMessageSelection=(e=[],t,n)=>{const s=this.refTree.current;if(!s)return;const i=t?t.id:-1,o=n?n.id:-1;s.selectionModel.setSelectedIds(e),s.selectionModel.anchorIndex=i,s.selectionModel.leadIndex=o,s.updateSelectionState(),s.saveSelectionModel(),this.onSelect(n)};updateMessageSelection=(e=!1)=>{const t=this.refTree.current;if(!t)return this.onSelect();const n=t.getRenderArray().map((e=>e.node));if(0===n.length)return this.setMessageSelection();const s=tf.Z.getListEntryComparator(),i=t.selectionModel.selectedIds.map((e=>e.id)).filter((e=>this._findIndex(e,n,s)>=0));let o=t.selectionModel.leadIndex;if(-1===o&&(o=t.selectionModel.anchorIndex),-1===o)return this.setMessageSelection();let a=this._findIndex(o,n,s);a<0&&(a=-a-1);let r=this._findIndex(t.selectionModel.anchorIndex,n,s);r<0&&(r=-r-1);const l=a>r;if(0===i.length){const e=Math.min(a,n.length-1),t=n[e];i.push(t.id)}const d=i[l?0:i.length-1],c=this._findIndex(d,n,s),h=n[c],p=i[l?i.length-1:0],u=this._findIndex(p,n,s),g=n[u];this.setMessageSelection(i,h,g),e&&t.scrollIntoView(u)};_markSelectedRead=()=>{Pf.Z.markRead(this.winId)};_markSelectedFlagged=()=>{Pf.Z.markFlagged(this.winId)};_toggleSenderAsMailingList=()=>{this.getSelectedNodes().forEach((e=>{const t=yn.Z.get(e.fromIds);l.Z.toggleSenderAsMailingList(this.winId,t[0].address)}))};_markSelectedUnflagged=()=>{Pf.Z.markUnflagged(this.winId)};_goToNext=()=>{const e=this.refTree.current;if(!e)return;const t=e.selectionModel.leadIndex,n=e.getRenderArray().map((e=>e.node));let s=this._findIndex(t,n,tf.Z.getListEntryComparator());if(s<0&&(s=-s-1),s<n.length-1){const t=n[s+1];t.isParent&&!e.isExpanded(t.id)?(e.toggleExpandModel(t.id),this._goToNext()):t&&e.selectByNode(t)}};_goToNextUnread=e=>{const t=this.refTree.current;if(!t)return;const n=t.selectionModel.leadIndex,s=t.getRenderArray().map((e=>e.node));let i=this._findIndex(n,s,tf.Z.getListEntryComparator());i<0&&(i=-i-1);const o=Fv.Z.getSelectedFolder(),a=o?.accountId===xe.tQ?Be.Z.getFilterForSingleThreadView():o&&tf.Z.getByFolder(o.accountId,o.path);if(!a)throw new Error("Filter not found");const r=PE(s,i,"ascending"===this.state.sorting.sortOrder,a,(e=>t.isExpanded(e.id)),e);if(r>-1){const n=s[r];n.isParent&&!t.isExpanded(n.id)?(t.toggleExpandModel(n.id),this._goToNextUnread(e)):t.selectByNode(n)}};_markAndGotoNextUnread=Wi.throttleSync((()=>{this._markSelectedRead(),this._gotoUnreadFiltered("undefined")}));_gotoNextUnread=Wi.throttleSync((()=>{this._gotoUnreadFiltered("next")}));_gotoPreviousUnread=Wi.throttleSync((()=>{this._gotoUnreadFiltered("previous")}));_gotoUnreadFiltered=(e="undefined")=>{const t=Fv.Z.getSelectedFolder();if(!t)return;const n=tf.Z.getByFolder(t.accountId,t.path);Be.Z.getFilterOptions(n).showRead&&this._goToNextUnread(e)};getLabelMenuItems=()=>{const e=u.Z.getActiveListEntry(),t=e?(0,zf.Q3)(e.flags):[],n=Pf.Z.getCustomLabelsMenu(this.winId,t);return n.push(ae.Z.separatorItem,{handler:()=>Ae.Z.showAddCustomLabel(this.winId),ellipsis:!0,...(0,xs.Z)("Add New Label")}),t.length>0&&n.push(ae.Z.separatorItem,{handler:()=>Pf.Z.clearAllLabels(this.winId,t),...(0,xs.Z)("Clear All Labels")}),n};_scrollOrMarkAndGotoNext=e=>{const{document:t,HTMLElement:n}=this.context,s=t.querySelector("#mail_view .mail_body webview");s instanceof n&&"function"==typeof s.executeScript&&s.executeScript({code:this._injectCode(e.shiftKey)},(e=>{e&&!1===e[0]&&(this._markSelectedRead(),this._goToNext())}))};_injectCode=e=>e?"b__ = document.documentElement.querySelector('body');\n      if (b__.scrollTop !== 0) {\n        b__.scrollBy({\n          top: - b__.clientHeight - 30,\n          left: 0,\n          behavior: 'smooth'\n        });\n        true;\n      }":"b__ = document.documentElement.querySelector('body');\n      if (b__.scrollHeight - b__.scrollTop > b__.clientHeight) {\n        b__.scrollBy({\n          top: b__.clientHeight - 30,\n          left: 0,\n          behavior: 'smooth'\n        });\n        true;\n      } else {\n        false;\n      }";_sendSelected=()=>{wn.Z.sendSelected(this.context.vivaldiWindowId,this.getSelectedNodes())};standardFlagMenuData=()=>{const e=u.Z.getActiveListEntry(),t=e?(0,zf.Zr)(e.flags):"";return Pf.Z.getStandardFlagsMenu(this.winId,t)};getMenuCapability=(e,t,n)=>{const s=this.winId,i=Uf.isEnabled("MailMsgSpam"),o=Uf.isEnabled("MailMsgArchive"),a=e=>{const t=Fv.Z.getSelectedFolder(),n=t&&tf.Z.getByFolder(t.accountId,t.path);return Boolean(e)&&gf.Z.call(e.sources,n)},r=e=>{const t=Fv.Z.getSelectedFolder();if(t&&tf.Z.getByFolder(t.accountId,t.path))return(0,xf.Z)(e.sources)},l=e=>{const t=Fv.Z.getSelectedFolder();if(t&&tf.Z.getByFolder(t.accountId,t.path))return(0,Lf.Z)(e.sources,e.flags)},d=e=>"threads"===this.state.sorting.sortField&&1===this.getNumSelected()&&Boolean(e)&&Boolean(e.children),c=e=>1===this.getNumSelected()&&Boolean(e)&&e.fromIds.length>0?yn.Z.get(e.fromIds)[0].address:"",h=()=>tf.Z.getByIds(n.sourceFilterIds).some((e=>e.accountId===xe.of&&e.path===xe.J8)),p=()=>{const e=Fv.Z.getSelectedFolder(),t=e&&tf.Z.getByFolder(e.accountId,e.path);return!!t&&vn.Z.getFolderType(t.accountId,t.path)===xe.Nz};switch(e.action){case"COMMAND_MAIL_COMPOSE_NEW_MESSAGE":return Promise.resolve({handler:ke.Z.createDraft.bind(null,void 0),...t(s,e,{})});case"CONTEXT_SEND":return Promise.resolve({handler:this._sendSelected,isVisible:()=>Boolean(n)&&h(),...t(s,e,{})});case"COMMAND_MAIL_REPLY":return Promise.resolve({isVisible:()=>Boolean(n)&&Uf.isEnabled("MailMsgReply"),...t(s,e,{})});case"COMMAND_MAIL_REPLY_ALL":return Promise.resolve({handler:Pf.Z.replyAll,isVisible:()=>Boolean(n)&&Uf.isEnabled("MailMsgReplyToAll"),...t(s,e,{})});case"COMMAND_MAIL_REPLY_LIST":return Promise.resolve({handler:Pf.Z.replyList,isVisible:()=>Boolean(n)&&u.Z.isListPost(),...t(s,e,{})});case"COMMAND_MAIL_FORWARD":return Promise.resolve({isVisible:()=>Boolean(n)&&!h(),...t(s,e,{})});case"COMMAND_MAIL_MARK_READ":return Promise.resolve({isVisible:()=>Boolean(n)&&Uf.isEnabled("MailMsgStatusRead")&&!a(n),...t(s,e,{})});case"COMMAND_MAIL_MARK_UNREAD":return Promise.resolve({isVisible:()=>Boolean(n)&&Uf.isEnabled("MailMsgStatusRead")&&a(n),...t(s,e,{})});case"CONTEXT_GOTO":case"COMMAND_MAIL_MARK_READ_AND_GOTO_NEXT_UNREAD":case"CONTEXT_THREAD":return Promise.resolve({isVisible:()=>Boolean(n),...t(s,e,{})});case"COMMAND_MAIL_GOTO_NEXT_UNREAD":case"COMMAND_MAIL_GOTO_PREVIOUS_UNREAD":return Promise.resolve({isVisible:()=>Boolean(n)&&!(()=>{const e=Fv.Z.getSelectedFolder();return!!e&&vn.Z.getFolderType(e.accountId,e.path)===xe.tB})(),...t(s,e,{})});case"CONTEXT_CONTAINER_MOVE":return Promise.resolve({items:Pf.Z.getMoveToFolderMenu(s),isVisible:()=>Boolean(n),...t(s,e,{})});case"CONTEXT_ADD_FLAG":return Promise.resolve({handler:this._markSelectedFlagged,isVisible:()=>Boolean(n)&&Uf.isEnabled("MailMsgFlag")&&!(0,zf.u9)(n),...t(s,e,{})});case"CONTEXT_REMOVE_FLAG":return Promise.resolve({handler:this._markSelectedUnflagged,isVisible:()=>Boolean(n)&&Uf.isEnabled("MailMsgFlag")&&(0,zf.u9)(n),...t(s,e,{})});case"CONTEXT_CONTAINER_FLAGS":return Promise.resolve({items:this.standardFlagMenuData(),isVisible:()=>Boolean(n)&&Uf.isEnabled("MailMsgFlag"),...t(s,e,{})});case"CONTEXT_CONTAINER_LABELS":return Promise.resolve({items:this.getLabelMenuItems(),isVisible:()=>Boolean(n)&&Uf.isEnabled("MailMsgLabel"),...t(s,e,{})});case"CONTEXT_EDIT":return Promise.resolve({handler:()=>Pf.Z.openMessage(s),isVisible:()=>Boolean(n)&&Fv.Z.isFolderAnEditMailFolder(),...t(s,e,{})});case"COMMAND_MAIL_MARK_JUNK":return Promise.resolve({isVisible:()=>Boolean(n)&&i&&!1===l(n),...t(s,e,{})});case"COMMAND_MAIL_MARK_NOT_JUNK":return Promise.resolve({isVisible:()=>Boolean(n)&&i&&!0===l(n),...t(s,e,{})});case"COMMAND_MAIL_MOVE_TO_ARCHIVE":return Promise.resolve({handler:()=>Pf.Z.moveToArchive(s),isVisible:()=>Boolean(n)&&o&&!1===r(n),...t(s,e,{})});case"COMMAND_MAIL_RESTORE_FROM_ARCHIVE":return Promise.resolve({handler:()=>Pf.Z.restoreFromArchive(s),isVisible:()=>Boolean(n)&&o&&!0===r(n),...t(s,e,{})});case"CONTEXT_CONTAINER_TRASH":const g=(e=>{const t=Fv.Z.getSelectedFolder(),n=t&&tf.Z.getByFolder(t.accountId,t.path);if(Boolean(e)&&n){const t=vn.Z.getFolderType(n.accountId,n.path)===xe.Nz;return Of.Z.isMessageDeleted(e.sources,n,t)}})(n);return Promise.resolve({items:null!=g&&Uf.isEnabled("MailMsgTrash")?jf(s,g):[],isVisible:()=>Boolean(n)&&void 0!==g,...t(s,e,{})});case"CONTEXT_RECEIVER":return Promise.resolve({handler:()=>Pf.Z.enableCorrespondentView(s),isVisible:()=>Boolean(n)&&p(),...t(s,e,{})});case"CONTEXT_SENDER":return Promise.resolve({isVisible:()=>Boolean(n)&&!p(),...t(s,e,{})});case"COMMAND_MAIL_ENABLE_SENDER_VIEW":{const i=c(n);return Promise.resolve({isVisible:()=>Boolean(n)&&1===this.getNumSelected()&&i.length>0,...t(s,e,{})})}case"CONTEXT_SENDER_IS_MAILING_LIST":{const i=c(n);return Promise.resolve({handler:this._toggleSenderAsMailingList,checked:tf.Z.isSenderMailingList(i),isVisible:()=>Boolean(n)&&1===this.getNumSelected()&&i.length>0,...t(s,e,{})})}case"COMMAND_MAIL_ENABLE_THREADED_VIEW":return Promise.resolve({isVisible:()=>Boolean(n)&&1===this.getNumSelected(),...t(s,e,{})});case"COMMAND_MAIL_MARK_THREAD_READ":return Promise.resolve({isVisible:()=>Boolean(n)&&d(n)&&!a(n),...t(s,e,{})});case"COMMAND_MAIL_MARK_THREAD_UNREAD":return Promise.resolve({isVisible:()=>Boolean(n)&&d(n)&&a(n),...t(s,e,{})});default:return Promise.resolve({...t(s,e,{})})}};getMenuVisibility=e=>{switch(e.action){case"CONTEXT_EXPAND_ALL":case"CONTEXT_COLLAPSE_ALL":return"threads"===this.state.sorting.sortField;default:return!1}};handleExpandClick=()=>{this.refTree.current&&this.refTree.current.toggleSelectedExpansion()};onItemDoubleClick=()=>{Pf.Z.openMessage(this.context.vivaldiWindowId)};onItemMouseDown=(e,t)=>{1===t.button&&(t.preventDefault(),t.stopPropagation())};onItemMouseUp=(e,t)=>{1===t.button&&(t.preventDefault(),t.stopPropagation())};getRowComponentProps=e=>{const{node:t,level:n,isLastChild:s}=e,i=Fv.Z.getSelectedFolder();let o;if(i){const{accountId:e,path:t}=i;o=tf.Z.getByFolder(e,t)}else console.warn("No folder selected");return{...t,level:n,direction:"horizontal"===this.props.position||"vertical_wide"===this.props.position?"horizontal":"vertical",handleExpandClick:this.handleExpandClick,selectedFilter:o,columns:this.props.columns,isLastChild:s}};getHeight=({index:e})=>"threads"!==!this.state.sorting.sortField&&this.refTree.current&&this.refTree.current.state.renderArray[e].node.isChild?24:48;onSelect=e=>{this.selectedEntry=e,this.setState({autoFocusEntry:!!this.selectedEntry}),this.props.onSelect(e)};openMessage=e=>{Pf.Z.openMessage(e.windowId)};onFocus=()=>{Di.Z.bind("enter",this.openMessage)};_unbind=()=>{Di.Z.unbind("enter",this.openMessage)};onBlur=()=>{this._unbind()};onKeyDown=e=>{const t=!!e.ctrlKey;switch(e.key){case"z":!t||e.shiftKey||e.altKey||(l.Z.undo(),e.preventDefault(),e.stopPropagation());break;case" ":e.preventDefault(),e.repeat||this._scrollOrMarkAndGotoNext(e)}};getDragData=(e,t)=>t;menu={name:"mailsearchlist",getCapability:this.getMenuCapability,getVisibility:this.getMenuVisibility};render(){const e=Fv.Z.getSelectedFolder(),t="threads"===H.Z.get($.kMailSearchSortField)?TE.Z.getThreadsAsTree(this.state.list.slice(),"ascending"===H.Z.get($.kMailSearchSortOrder)):this.state.list;let n,s=!1;e&&(n="MAIL_SEARCH_"+e.accountId+e.path,uc.Z.isSubscribable(e)&&(s=!e.subscribed));const i="vertical"===this.props.position?this.getHeight:24;return LE("div",{className:"list-wrapper",onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:this.onKeyDown},void 0,!s&&this.state.isLoading&&LE("span",{className:"mail-loading"},void 0,(0,Oe.Z)("Loading selected view...")),!s&&!this.state.isLoading&&this.state.list.length>0&&(0,fs.jsx)(yo,{ref:this.refTree,rowComponent:AE,getRowComponentProps:this.getRowComponentProps,nodes:t,onSelect:this.onSelect,onItemDoubleClick:this.onItemDoubleClick,onItemMouseDown:this.onItemMouseDown,onItemMouseUp:this.onItemMouseUp,delete:this.delete,disableSelectAfterDelete:!0,isFolder:this.isFolder,menu:this.menu,hasChildren:this.hasChildren,settings:n,rootId:0,isValidAddTarget:this.isValidAddTarget,disableClipboard:!0,rowHeight:i,folderMode:"expand",selectionStoreKey:h.uP,getDragData:this.getDragData,mimeType:"vivaldi/x-mail-message",validateForDrag:e=>e,columns:this.props.columns,autoFocus:this.state.autoFocusEntry,sorting:this.state.sorting}),!s&&!this.state.isLoading&&0===this.state.list.length&&LE("span",{className:"mail-loading"},void 0,(0,Oe.Z)("No messages in selected view")),e&&s&&LE("div",{className:"mail-folder-subscribe"},void 0,LE("h2",{},void 0,(0,Oe.Z)("Subscribe to Folder")),LE("p",{},void 0,(0,Oe.Z)("You are currently not subscribed to the folder $2 of $1.",[e.accountId,e.path])),LE("input",{type:"button",className:"primary",value:(0,Oe.Z)("Subscribe"),onClick:()=>l.Z.subscribeMailbox(this.context.vivaldiWindowId,e)})))}}const BE=RE;var FE;function VE(e,t,n,s){FE||(FE="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:FE,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class WE extends hs.PureComponent{rules={from:(0,Oe.Z)("sender","From"),to:(0,Oe.Z)("To"),cc:(0,Oe.Z)("Cc"),subject:(0,Oe.Z)("Subject"),body:(0,Oe.Z)("Body"),...this.props.isSettings&&{anywhere:(0,Oe.Z)("Anywhere")}};state={rule:"",conjunction:this.props.isEmpty?"":"AND",ruleName:this.props.isSettings?"anywhere":"from",allMailAddresses:Hc.Z.getMailAddresses(),isValidInput:!1,condition:"include"};_allMailAddressesChanged=()=>{this.setState({allMailAddresses:Hc.Z.getMailAddresses()})};componentDidMount(){Hc.Z.addListener(this._allMailAddressesChanged)}componentWillUnmount(){Hc.Z.removeListener(this._allMailAddressesChanged)}onChangeRuleName=e=>{const t=e.target.value;switch(t){case"subject":case"body":case"to":case"from":case"cc":case"anywhere":this.setState({ruleName:t},(()=>{this.props.isSettings||this.onSubmit()}));break;default:this.onChangeConjunction(e)}};onChange=e=>{this.setState({rule:e.target.value,isValidInput:e.target.value.trim().length>0},(()=>{this.props.isSettings||H.Z.get($.kMailSearchOnEnter)||this.onSubmit()}))};onChangeConjunction=e=>{switch(e.target.value){case"NOT":case"AND":case"OR":this.setState({conjunction:e.target.value},(()=>{this.props.isSettings||this.onSubmit()}))}};onSubmit=(e,t)=>{const{ruleName:n,condition:s,conjunction:i,rule:o}=this.state;this.props.onSubmit({ruleName:n,rule:o,condition:s,conjunction:i,mailAddresses:t},e),this.props.isSettings&&this.setState({rule:""})};onBeforeAddMailFilter=()=>{if(this.state.rule)return this.setState({showDialog:!0}),!0};addAddressToRuleGroup=e=>{if(this.props.isSettings){if(e.length>0){const t=e[0].address,n="equal",s=this.state.conjunction;this.props.onSubmit({ruleName:this.state.ruleName,rule:t,condition:n,conjunction:s})}}else this.onSubmit(!1,e)};setIsValidInput=e=>{this.state.isValidInput!==e&&this.setState({isValidInput:e})};onChangeCondition=e=>{const t=e.target.value;switch(t){case"equal":case"include":case"starts_with":this.setState({condition:t})}};onClose=e=>{if(e){const e=!0;this.onSubmit(e)}else this.setState({showDialog:!1})};render(){const e=this.state.ruleName,t=[];for(const e in this.rules)t.push(VE("option",{value:e},e,this.rules[e]));const n="AND"===this.state.conjunction,s=[...this.props.isSettings||!n?["AND"]:[],"OR","NOT"].map((e=>VE("option",{value:e},e,(0,Oe.Z)(e))));return!this.props.isSettings&&n&&t.push(VE("optgroup",{label:(0,Oe.Z)("Conjunction")},"conjunction",s)),VE("form",{onSubmit:this.onSubmit,className:As()("MailFilterSelector",!this.props.isSettings&&"MailFilterSelector--mailList",this.props.isSettings&&"MailFilterSelector--isSettings")},void 0,!this.props.isEmpty&&(this.props.isSettings||!n)&&VE("select",{onChange:this.onChangeConjunction,value:this.state.conjunction,className:"MailFilterSelector-conjunctionContainer"},void 0,s),VE("select",{onChange:this.onChangeRuleName,value:this.state.ruleName},void 0,this.rules&&t),this.props.isSettings&&VE("select",{onChange:this.onChangeCondition,value:this.state.condition},void 0,["from","cc","to"].includes(e)&&(0,fs.jsx)(fs.Fragment,{children:VE("option",{value:"equal"},void 0,(0,Oe.Z)("equals"))}),VE("option",{value:"include"},void 0,(0,Oe.Z)("includes")),VE("option",{value:"starts_with"},void 0,(0,Oe.Z)("starts with")),["subject","body","anywhere"].includes(e)&&(0,fs.jsx)(fs.Fragment,{children:VE("option",{value:"equal"},void 0,(0,Oe.Z)("equals"))})),VE("div",{className:"MailFilterSelector-inputContainer"},void 0,["from","to","cc"].includes(e)?VE(XA,{id:e,selectedItems:this.props.selectedMailAddresses,allItems:this.state.allMailAddresses||new Map,itemSelectionCallback:this.addAddressToRuleGroup,setIsValidInput:this.setIsValidInput,onChange:this.onChange,clearInputOnBlur:this.props.isSettings,className:"MailFilterSelector-input"}):VE("input",{type:"text",onChange:this.onChange,value:this.state.rule,className:"MailFilterSelector-input"}),this.props.isSettings&&VE("input",{type:"button",disabled:!this.state.isValidInput,onClick:this.onSubmit,value:(0,Oe.Z)("Add to Search")})),this.state.showDialog&&VE(SA,{title:(0,Oe.Z)("Forgot to add to search"),prompt:[(0,Oe.Z)("We noticed you wrote something and didn't add it to the search. Would you like to add '$1' to the search?",[this.state.rule])],positive:(0,Oe.Z)("Add to Search"),negative:(0,Oe.Z)("Cancel"),onRequestClose:()=>this.setState({showDialog:!1}),onClose:this.onClose}))}}const UE=WE;var HE;function zE(e,t,n,s){HE||(HE="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:HE,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const GE=function(e){return zE("select",{value:e.attachments,className:e.className,onChange:t=>{let n;"1"===t.currentTarget.value?n=1:"0"===t.currentTarget.value&&(n=0),e.selectAttachments(n)},title:(0,Oe.Z)("Select whether the message can include attachments or not.")},void 0,zE("option",{value:void 0,title:(0,Oe.Z)("Any Attachments")},void 0,(0,Oe.Z)("Any Attachments")),zE("option",{title:(0,Oe.Z)("Has Attachments"),value:1},void 0,(0,Oe.Z)("Has Attachments")),zE("option",{title:(0,Oe.Z)("No Attachments"),value:0},void 0,(0,Oe.Z)("No Attachments")))};function $E(e){const{unseen:t,unread:n,total:s}=e;return t>0?t===n&&n===s?(0,Oe.Z)("$1 new message","$1 new messages",[t]):t===n?(0,Oe.Z)("$1 new message of $2 messages","$1 new messages of $2 messages",[t,s]):(0,Oe.Z)("$1 new in $2 unread of $3 messages","$1 new in $2 unread of $3 messages",[t,n,s]):n>0?n===s?(0,Oe.Z)("$1 unread message","$1 unread messages",[n]):(0,Oe.Z)("$1 unread of $2 messages","$1 unread of $2 messages",[n,s]):(0,Oe.Z)("$1 message","$1 messages",[s])}var KE;function jE(e,t,n,s){KE||(KE="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:KE,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const YE=[$.kMailCountersPanelUnseenEnabled];class XE extends hs.Component{_isMounted=!1;state={unseen:0,unread:0,total:0};componentDidMount(){this._isMounted=!0,this._updateCounters(),tf.Z.addListener(this.onCountersChanged)}componentWillUnmount(){tf.Z.removeListener(this.onCountersChanged)}_updateCounters=(e=this.props)=>{const{accountId:t,path:n}=e;if(this._isMounted){const e=tf.Z.getCounters(t,n);this.setStateIfNeeded({unread:e&&e.unread||0,unseen:e&&e.unseen||0,total:e&&e.total||0})}};setStateIfNeeded=e=>{Object.getOwnPropertyNames(e).some((t=>e[t]!==this.state[t]))&&this.setState(e)};onCountersChanged=e=>{"counters"===e.target&&this._updateCounters()};handleMouseUp=e=>{const t=e.altKey;this.props.handleExpandClick(this.props.id,t)};render(){const e=this.state.unseen>0&&this.props.prefValues[$.kMailCountersPanelUnseenEnabled],{unseen:t,unread:s,total:i}=this.state,o=this.props.label+" "+$E({unseen:t,unread:s,total:i});return jE("div",{className:"mail-panel-category-container"},void 0,jE("label",{className:"mail-panel-category"+(this.props.hasChildren?"":" empty"),title:o},void 0,jE("span",{onClick:this.props.onClick,className:"title"},void 0,this.props.label),!this.props.isExpanded&&jE("div",{className:"counter-container"},void 0,e&&jE("span",{className:"item-count counter-unseen"},void 0,this.state.unseen),this.state.unread>0&&jE("span",{className:"item-count counter-unread"},void 0,this.state.unread)),this.props.hasChildren&&jE("span",{className:"expand-icon display-hint",onMouseDown:to.ZP,onMouseUp:this.handleMouseUp,dangerouslySetInnerHTML:{__html:n(4103)}})))}}const QE=sa(XE,YE),qE={},JE={};class e_ extends Ol.Z{getAccountIndicator(e){let t,n=Object.keys(xe.NB).length;if(qE[e]){const s=Object.keys(qE[e]);for(const i of s)qE[e][i].priority<n&&(n=qE[e][i].priority,t=qE[e][i])}if(JE[e])for(const s in JE[e])JE[e][s].priority<n&&(n=JE[e][s].priority,t=JE[e][s]);return t}getPathIndicator(e,t){if(JE[e]&&JE[e][t])return JE[e][t]}reset(){for(const e in qE)delete qE[e];for(const e in JE)delete JE[e]}dispatchAction(e){switch(e.actionType){case"MAIL_INDICATOR_ADD_ACCOUNT":{const{accountId:t,indicatorType:n,priority:s,current:i,total:o}=e;!function(e,t,n,s,i){qE[e]||(qE[e]={});qE[e][t]={indicatorType:t,priority:n,current:s,total:i},t_.emitChange()}(t,n,s,i,o);break}case"MAIL_INDICATOR_ADD_PATH":{const{accountId:t,path:n,indicatorType:s,priority:i,current:o,total:a}=e;!function(e,t,n,s,i,o){JE[e]||(JE[e]={});JE[e][t]={indicatorType:n,priority:s,current:i,total:o},t_.emitChange()}(t,n,s,i,o,a);break}case"MAIL_INDICATOR_REMOVE_ACCOUNT":{const{accountId:t,indicatorType:n}=e;!function(e,t){qE[e]&&qE[e][t]&&(delete qE[e][t],t_.emitChange())}(t,n);break}case"MAIL_INDICATOR_REMOVE_PATH":{const{accountId:t,path:n}=e;!function(e,t){JE[e]&&JE[e][t]&&(delete JE[e][t],t_.emitChange())}(t,n);break}case"MAIL_INDICATOR_REMOVE_ALL":t=e.accountId,delete qE[t],delete JE[t],t_.emitChange()}var t}}const t_=new e_(y.Z);const n_=t_;var s_,i_=n(34198);function o_(e,t,n,s){s_||(s_="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:s_,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const a_=[$.kMailAccounts,$.kMailCountersPanelArchiveEnabled,$.kMailCountersPanelDraftsEnabled,$.kMailCountersPanelJunkEnabled,$.kMailCountersPanelTrashEnabled,$.kMailCountersPanelUnseenEnabled,$.kMailPanelActivityIndicatorsEnabled];function r_(e){const t={disconnected:!1,isConnecting:!1,error:void 0},{isImap:n,isAccount:s,accountId:i,isOnline:o,isOffline:a}=e;return s&&(o?n?(t.disconnected=!a&&rf.isDisconnected(i),t.isConnecting=rf.isConnecting(i),rf.hasError(i)&&(t.error=rf.getErrorMessage(i))):t.disconnected=!1:t.disconnected=!a),t}class l_ extends hs.Component{static contextType=xi.Z;_isMounted=!1;state=function(e){return{unread:0,unseen:0,total:0,...r_(e)}}(this.props);componentDidMount(){this._isMounted=!0,this._updateCounters(),tf.Z.addListener(this.onCountersChanged),rf.addListener(this.onConnectionChanged),n_.addListener(this.onIndicatorsChanged)}componentWillUnmount(){this._isMounted=!1,tf.Z.removeListener(this.onCountersChanged),rf.removeListener(this.onConnectionChanged),n_.removeListener(this.onIndicatorsChanged)}componentDidUpdate(e){e.isOnline!==this.props.isOnline&&this.setStateIfNeeded(r_(this.props))}onCountersChanged=e=>{"counters"===e.target&&this._updateCounters()};onConnectionChanged=()=>{this.setStateIfNeeded(r_(this.props))};onIndicatorsChanged=()=>{const e=this.props.path===xe.ym?n_.getAccountIndicator(this.props.accountId):n_.getPathIndicator(this.props.accountId,this.props.path),t={indicator:""},n=this.props.isExpanded&&this.props.path===xe.ym;if(e&&!n){const{indicatorType:n,current:s,total:i}=e,o=this.getIndicatorText(n);t.indicator=i>0?`${o} ${s}/${i}`:o}this.setState(t)};_updateCounters=(e=this.props)=>{if(this._isMounted){let{accountId:t,path:n}=e;t===xe.Ry&&n!==xe.ym&&([t,n]=Be.Z.fromCustomFolderPath(e.path));const s=tf.Z.getCounters(t,n);this.setStateIfNeeded({unread:s&&s.unread||0,unseen:s&&s.unseen||0,total:s&&s.total||0})}};setStateIfNeeded=e=>{Object.getOwnPropertyNames(e).some((t=>e[t]!==this.state[t]))&&this.setState(e)};getIndicatorText=e=>{switch(e){case"INDICATOR_TYPE_FLAGS":return(0,Oe.Z)("Updating Flags");case"INDICATOR_TYPE_THREADING":return(0,Oe.Z)("Threading");case"INDICATOR_TYPE_FLUSHING":return(0,Oe.Z)("Flushing");case"INDICATOR_TYPE_CONNECTING":return(0,Oe.Z)("Connecting");case"INDICATOR_TYPE_FETCHING":return(0,Oe.Z)("Fetching");case"INDICATOR_TYPE_PRE_FETCHING":return(0,Oe.Z)("Prefetching");default:return""}};isDrafts=()=>this.props.path===xe.Wb||this.props.type===xe.kY;isOutbox=()=>this.props.path===xe.J8||this.props.type===xe.fZ;isTrash=()=>this.props.path===xe.cm||this.props.type===xe.uT;isUnread=()=>this.props.path===xe.tB;isSent=()=>this.props.path===xe.N1||this.props.type===xe.Nz;isJunk=()=>this.props.path===xe.rp||this.props.type===xe.Hd;isArchive=()=>this.props.path===xe.$T||this.props.type===xe.hn;isFeeds=()=>this.props.accountId===xe.u4;isLabels=()=>this.props.accountId===xe.ut;isFilters=()=>this.props.accountId===xe.Kz;isFlags=()=>this.props.accountId===xe.MN;isReceived=()=>this.props.path===xe.ik||this.props.type===xe.e9;isMailingList=()=>this.props.accountId===xe.wC&&i_.Z.isMailingListPath(this.props.path);getImageSet=()=>this.props.isAccount?Ts.GtN:this.isSent()?Ts.zLp:this.isJunk()?Ts.Qwh:this.isArchive()?Ts._w1:this.isFeeds()?Ts.ZU_:this.isUnread()?Ts.aAJ:this.isReceived()?Ts.LDV:this.isDrafts()?Ts.XTV:this.isFilters()?Ts.EnF:this.isLabels()?Ts.rpm:this.isFlags()?Ts.nyn:this.isMailingList()?Ts.GAD:void 0;_onError=e=>{const t=rf.getErrorMessage(this.props.name);t&&t.toLowerCase().indexOf("authentication")>=0?Ae.Z.showMailAuthenticationDialog(this.context.vivaldiWindowId,{account:e}):Ae.Z.showSettings(this.context.vivaldiWindowId,"mail")};_handleStatusIconClick=async()=>{if(this.state.disconnected&&!rf.isConnecting(this.props.name)){const e=await fn.Z.loadAccount(this.props.name);this._onError(e)}else Ae.Z.showSettings(this.context.vivaldiWindowId,"mail")};handleMouseUp=e=>{const t=e.altKey;this.props.handleExpandClick(this.props.id,t)};render(){const e=this.props.prefValues[$.kMailPanelActivityIndicatorsEnabled]&&this.state.indicator,t=this.state.unread>0&&!(this.isDrafts()||this.isOutbox()||this.isTrash()||this.isJunk()||this.isArchive()),n=t&&this.state.unseen>0&&this.props.prefValues[$.kMailCountersPanelUnseenEnabled],s=this.state.total>0&&this.isOutbox(),i=this.state.total>0&&this.props.prefValues[$.kMailCountersPanelTrashEnabled]&&this.isTrash(),o=this.state.unread>0&&this.props.prefValues[$.kMailCountersPanelJunkEnabled]&&this.isJunk(),a=this.state.unread>0&&this.props.prefValues[$.kMailCountersPanelArchiveEnabled]&&this.isArchive(),r=this.state.total>0&&this.props.prefValues[$.kMailCountersPanelDraftsEnabled]&&this.isDrafts();let l;if(this.state.error)l=this.state.error;else if(this.props.isAccount&&!this.props.isOnline)l=(0,Oe.Z)("No network connection");else if(!this.props.isOffline&&this.state.disconnected)l=(0,Oe.Z)("Disconnected");else{const{unseen:e,unread:t,total:n}=this.state;l=(this.isLabels()?(0,nZ.X)(this.props.name):(0,vf.e)(this.props.name))+"\n"+$E({unseen:e,unread:t,total:n})}const d=this.props.level*mo;let c;return c=this.props.hasChildren?0:this.props.level>1?d+mo:d,o_("label",{className:As()("mail_panel_node",{disabled:this.props.subscribable}),title:l,onClick:this.props.onClick},void 0,this.props.hasChildren&&0!==this.props.level&&o_("span",{className:"expand-icon",style:{marginLeft:d},onMouseDown:to.ZP,onMouseUp:this.handleMouseUp,dangerouslySetInnerHTML:{__html:Ts.nfH}}),o_(Ps,{imageSet:this.getImageSet(),open:this.props.isExpanded,trash:this.isTrash(),disconnected:this.state.disconnected,isConnecting:this.state.isConnecting,leftMargin:c,onClickStatusIcon:this._handleStatusIconClick}),void 0!==this.props.inlineEditText&&o_("input",{type:"text",value:this.props.inlineEditText,onChange:this.props.onChange,onFocus:this.props.onFocus,onBlur:this.props.onBlur,autoFocus:!0}),void 0===this.props.inlineEditText&&o_(hs.Fragment,{},void 0,o_("span",{className:"title"},void 0,this.isLabels()?(0,nZ.X)(this.props.name):(0,vf.e)(this.props.name)),e&&o_("span",{className:"item-count counter-indicator"},void 0,this.state.indicator),n&&o_("span",{className:"item-count counter-unseen"},void 0,this.state.unseen),t&&o_("span",{className:"item-count counter-unread"},void 0,this.state.unread),o&&o_("span",{className:"item-count counter-unread"},void 0,this.state.unread),a&&o_("span",{className:"item-count counter-unread"},void 0,this.state.unread),(s||i||r)&&o_("span",{className:"item-count counter-total"},void 0,this.state.total)))}}const d_=sa(l_,a_);var c_;function h_(e,t,n,s){c_||(c_="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:c_,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class p_ extends hs.Component{onHide=()=>{"Mail"===this.props.component&&Ne.Z.set($.kMailPanelShowErrorMessages,!1)};onClear=()=>{if(this.props.logEntries.length>0){const e=this.props.logEntries[this.props.logEntries.length-1];this.props.setEarliestErrorTimestamp(e.timestamp)}};render(){return h_("header",{},void 0,h_("div",{onClick:this.onClear},void 0,h_(xu,{logs:this.props.logEntries,component:this.props.component,hideButtons:!0})),h_("div",{className:"toolbar toolbar-default"},void 0,h_("input",{type:"button",value:(0,Oe.Z)("mail","Hide"),title:(0,Oe.Z)("Hide error log. It can be seen in Mail Status, or enabled again in settings."),onClick:this.onHide}),h_("input",{type:"button",value:(0,Oe.Z)("Show More"),title:(0,Oe.Z)("Show full log."),onClick:()=>pg.open("Mail","logs")})))}}const u_=p_;var g_=n(74652);function m_(e,t){let n=[];const s=Object.keys(t);return e.length>s.length&&(n=e.filter((e=>e.offline&&!e.isDeleted&&!s.some((t=>t===e.MAIL_EMAIL)))).map((e=>e.MAIL_EMAIL))),n}var v_=n(59552),f_=n(30628);async function y_(e){for(const t of e){const e=[t,""],n=[t,"￿"],s={Inbox:[],Drafts:[],All:[],Flagged:[],Sent:[],Trash:[],Junk:[],Archive:[],Other:[]},i=(await Re.Z.filters.where("[accountId+path]").between(e,n).toArray()).map((e=>e.path));let o=".";for(const e of i){if(e===xe.ym)continue;e.indexOf("/")>-1&&(o="/");let t=(0,mc.kF)(e);if(e.indexOf(o)>-1){const n=e.split(o);t=(0,mc.kF)(n[n.length-1])}const n=(0,Uc.C7)(e),i={path:e,name:t,type:n,delimiter:o};s[n]?s[n].push(i):s[n]=[i]}await be.Z.add(t,s),await mn.Z.addAccounts({[t]:{folders:s}})}}var C_=n(68906);async function w_(e,t){return Re.Z.searchList.update(e,t)}var b_=n(26067);async function S_(){const e=nt()(xe.u4).substring(0,6),t=await C.Z.mailPrivate.getFileDirectory(e);if(!t)return void et.Z.error("Feeds",["restore"],"Root path for feeds not found on disk");const n=await C.Z.mailPrivate.getFilePaths(t);if(0===n.length)return void et.Z.error("Feeds",["restore"],"No feed files found");const s=H.Z.get($.kRssSettings);if(0===s.length)return void et.Z.error("Feeds",["restore"],"No settings found for Feeds and hence unable to restore");const i={},o=[],a=[],r=[],d=new Map;for(const e of n){const t=(0,b_.B)(xe.u4),n=RegExp(`${t}/([0-9]{4})/([0-9]{2})/([0-9]{2})/([0-9]+).eml`).exec(e);if(!n){et.Z.error("Feeds",["restore"],`File path does not fit expected format for a feed file: ${e}`);continue}const[,s,i,o,a]=n;d.set(Number(a),{feedsRootFolder:t,filePath:e,year:s,month:i,day:o})}const c=[...d.keys()],h=await Re.Z.searchList.where("id").anyOf(c).toArray();for(const[e,t]of d){const{feedsRootFolder:n,filePath:d,year:c,month:p,day:u}=t,g=await C.Z.mailPrivate.readFileToText(d),m=g.match(/xml:base="([^"]+)"/);if(!m){et.Z.error("Feeds",["restore"],`No url found in file ${d}`);continue}const v=m[1].replaceAll("&amp;","&");if(o.includes(v))continue;const f=s.find((e=>e.url===v));if(!f){o.push(v),et.Z.error("Feeds",["restore"],`settings for ${v} missing from prefs and hence unable to restore`);continue}const y=h.find((t=>t.id===e));let w;const b=await Pe.Z.get(xe.u4,f.path);if(b)w=b.id;else{et.Z.warn("Feeds",["restore"],`adding missing filter for ${v}`);const e={name:f.title,accountId:xe.u4,path:f.path,filterValue:{include:[[{accountId:xe.u4},{path:f.path}]],...Be.Z.getSearchListButtons(xe.u4)}},t=await l.Z.addFilter(e,!1);if(0===t.length){et.Z.error("Feeds",["restore"],`failed to add new filter for ${v}`);continue}w=t[0],a.push(w)}if(y){const e=y.sourceFilterIds[0];if(e!==w){et.Z.warn("Feeds",["restore"],`Re-assigning filter ${e} to ${w} for entry ${y.id}`);const t=y.sources.get(e),n={deleted:!1,internal:!0,read:!1},s=new Map,i=t?{...t}:{...n};s.set(w,i);const o={sourceFilterIds:[w],sources:s};await w_(y.id,o);const a=t?{...t}:{...n},d=new Map;d.set(w,a),d.set(e,void 0);const c={sourceFilterIds:[w],sources:d},h={id:y.id,updates:c};l.Z.updateIndex({sleUpdates:[h]}),r.push(y.id)}}else{et.Z.warn("Feeds",["restore"],`adding missing entry for ${e}`);const t=Jt(g);if("string"==typeof t){et.Z.error("Feeds",["restore"],t);continue}const s={pubDate:v.match(/^https?:\/\/(\w+\.)?youtube\.com\//i)},o=t.feeditems.map((e=>({accountId:xe.u4,path:f.path,subject:e.plaintitle,bodyParts:an(e),raw:g,sentDate:new Date(Number(c),Number(p)-1,Number(u)).getTime(),messageId:nt()(pn(e,s)),from:[{name:f.title,address:f.title}],replyTo:[],to:[],cc:[],flags:[],internal:!0}))),a=await We(f.path,o);1!==a.length&&et.Z.error("Feeds",["restore"],"Expected one-to-one between sle and file for feeds"),l.Z.updateIndex({addedSles:a});const r=a[0].id,d=[n,c,p,u];et.Z.warn("Feeds",["restore"],`writing raw message to new file: ${d.join("/")}/${r}.eml`),await C.Z.mailPrivate.writeTextToMessageFile(d,`${r}.eml`,g),i[r]=d.join("/"),i[e]&&i[e]===d.join("/")||(et.Z.warn("Feeds",["restore"],`removing obsolete message file: ${d.join("/")}/${e}.eml`),await C.Z.mailPrivate.deleteMessageFile(d,`${e}.eml`))}}a.length>0&&await C_.Z.call({type:"RUN_FILTERS",priority:xe.Un.LOW,filterIds:a}),r.length>0&&await C_.Z.call({type:"RE_RUN_SLES",priority:xe.Un.LOW,searchListIds:r}),a.length+r.length>0&&Ge.Z.filter()}var I_=n(95064),k_=n(10048);const A_={name:(0,Oe.Z)("All Messages"),accountId:xe.of,path:xe.ym,id:xe.w1,children:[]},T_={name:(0,Oe.Z)("Custom Folders"),accountId:xe.Ry,path:xe.ym,id:xe.Ry,children:[]},Z_={name:(0,Oe.Z)("Mailing Lists"),accountId:xe.wC,path:xe.ym,id:xe.jT,children:[]},E_={name:(0,Oe.Z)("Filters"),accountId:xe.Kz,path:xe.ym,id:xe.rQ,children:[]},__={name:(0,Oe.Z)("Flags"),accountId:xe.MN,path:xe.ym,id:xe.q0,children:[]},M_={name:(0,Oe.Z)("Labels"),accountId:xe.ut,path:xe.ym,id:xe.pz,children:[]},N_={name:(0,Oe.Z)("Feeds"),accountId:xe.u4,path:xe.ym,id:xe.sM,children:[]};var P_,D_=n(70752),x_=n(56551);function O_(e,t,n,s){P_||(P_="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:P_,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const L_=[$.kMailPanelItemsOrder,$.kMailPanelItemsShowAccounts,$.kMailPanelItemsShowAllMessages,$.kMailPanelItemsShowCustomFolders,$.kMailPanelItemsShowFeeds,$.kMailPanelItemsShowFilters,$.kMailPanelItemsShowFlags,$.kMailPanelItemsShowLabels,$.kMailPanelItemsShowMailingLists],R_=new Map([["ALL_MESSAGES",{key:"ALL_MESSAGES",name:(0,Oe.Z)("All Messages"),showPref:$.kMailPanelItemsShowAllMessages}],["CUSTOM_FOLDERS",{key:"CUSTOM_FOLDERS",name:(0,Oe.Z)("Custom Folders"),showPref:$.kMailPanelItemsShowCustomFolders}],["MAILING_LISTS",{key:"MAILING_LISTS",name:(0,Oe.Z)("Mailing Lists"),showPref:$.kMailPanelItemsShowMailingLists}],["FILTERS",{key:"FILTERS",name:(0,Oe.Z)("Filters"),showPref:$.kMailPanelItemsShowFilters}],["FLAGS",{key:"FLAGS",name:(0,Oe.Z)("Flags"),showPref:$.kMailPanelItemsShowFlags}],["LABELS",{key:"LABELS",name:(0,Oe.Z)("Labels"),showPref:$.kMailPanelItemsShowLabels}],["FEEDS",{key:"FEEDS",name:(0,Oe.Z)("Feeds"),showPref:$.kMailPanelItemsShowFeeds}],["ACCOUNTS",{key:"ACCOUNTS",name:(0,Oe.Z)("All Accounts"),showPref:$.kMailPanelItemsShowAccounts}]]);class B_ extends hs.PureComponent{constructor(e){super(e)}moveItem=(e,t)=>{const n=this.props.prefValues[$.kMailPanelItemsOrder].slice(),[s]=n.splice(e,1);n.splice(t,0,s),Ne.Z.set($.kMailPanelItemsOrder,n)};toggleShow=e=>{Ne.Z.toggle(e,!0,!1)};renderListItem=(e,t)=>{const{key:n,name:s,showPref:i}=t,o=this.props.prefValues[i];return(0,fs.jsxs)(fs.Fragment,{children:[O_("input",{type:"checkbox",value:n,checked:o,onChange:this.toggleShow.bind(this,i)}),s]})};render(){const e=[];for(const t of this.props.prefValues[$.kMailPanelItemsOrder]){const n=R_.get(t);n&&e.push(n)}return O_("div",{className:"setting-single"},void 0,O_("h3",{},void 0,(0,Oe.Z)("Mail Panel Order and Visibility")),O_("p",{className:"info"},void 0,(0,Oe.Z)("Hide, show and re-order folders in the Mail Panel.")),O_(x_.Z,{filter:this.props.filter,items:e,moveItem:this.moveItem,renderListItem:this.renderListItem,supportDragAndDrop:!0,mimeType:"vivaldi/x-settings-quick-command-type"}))}}const F_=sa(B_,L_);var V_,W_=n(34155);function U_(e,t,n,s){V_||(V_="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:V_,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const H_="vivaldi/x-mail-message",z_=[xe.W4,xe.cs],G_=[xe.T4.RED,xe.T4.ORANGE,xe.T4.YELLOW,xe.T4.GREEN,xe.T4.BLUE,xe.T4.PURPLE,xe.T4.GRAY],$_=[xe.w1+"_"+xe.Sp,xe.w1,xe.rQ,xe.q0,xe.pz,xe.sM,xe.Ry,xe.jT];let K_=0;const j_=()=>{const e=H.Z.get($.kMailPanelItemsOrder),t=rM(),n=[];for(const s of e)switch(s){case"ALL_MESSAGES":t.showAllMessages&&(A_.children=oM().sort(tM),n.push(A_));break;case"CUSTOM_FOLDERS":if(t.showCustomFolders){const e=!t.showUnsubscribed;T_.children=aM(e).sort(OE.JM),n.push(T_)}break;case"MAILING_LISTS":if(t.showMailingLists){const e=iM(tf.Z.getByAccountId(xe.wC),xe.jT),t=e.find((e=>e.path===xe.cs));t&&(t.name=(0,Oe.Z)("Mailing Lists","Other"));const s=e.find((e=>e.path===xe.W4));s&&(s.name=(0,Oe.Z)("Mailing Lists","Important")),Z_.children=e.sort(J_),n.push(Z_)}break;case"FILTERS":t.showFilters&&(E_.children=iM(tf.Z.getByAccountId(xe.Kz),xe.rQ).sort(OE.JM),n.push(E_));break;case"FLAGS":t.showFlags&&(__.children=iM(tf.Z.getByAccountId(xe.MN),xe.q0).sort(eM),n.push(__));break;case"LABELS":t.showLabels&&(M_.children=iM(tf.Z.getByAccountId(xe.ut),xe.pz).sort(zf.jp),n.push(M_));break;case"FEEDS":t.showFeeds&&(N_.children=iM(tf.Z.getByAccountId(xe.u4),xe.sM).sort(OE.JM),n.push(N_));break;case"ACCOUNTS":if(t.showAccounts){const e=mn.Z.getAccounts(),s=[],i=uc.Z.getFolders(e,t.showUnsubscribed);for(const e of i)e.accountId!==xe.u4&&s.push({...e,type:"All",subscribed:!0});n.push({name:(0,Oe.Z)("All Accounts"),path:xe.ym,accountId:xe.Sp,id:xe.w1+"_"+xe.Sp,children:s})}break;default:throw Error("Invalid mail panel item key: "+s)}return n},Y_=()=>(N_.children=iM(tf.Z.getByAccountId(xe.u4),xe.sM).sort(OE.JM),[N_]);var X_=U_("hr",{}),Q_=U_("hr",{});class q_ extends hs.PureComponent{refTreeList=hs.createRef();static contextType=xi.Z;winId=this.context.vivaldiWindowId;_isMounted=!1;isFeedsPanel=()=>"PanelFeeds"===this.props.panelId;isMailPanel=()=>"PanelMail"===this.props.panelId;state={mailFolders:this.isFeedsPanel()?Y_():j_(),mailAccounts:mn.Z.getAccounts(),online:navigator.onLine,showHiddenMailingLists:!1,indexProgress:tf.Z.isInitialized()?100:0,showErrors:H.Z.get($.kMailPanelShowErrorMessages),isCheckingMail:!1,waitingForAccountCache:!mn.Z.hasLoadedFolders()&&(H.Z.get($.kMailAccounts).length>0||H.Z.get($.kRssSettings).length>0),isRestoringAccounts:!1,isRestoringFeeds:!1};componentDidMount(){this._isMounted=!0,mn.Z.addListener(this.gotFolders),tf.Z.addListener(this._onFiltersChanged),rf.addListener(this.onImapStoreChange),ud.ZP.addListener(this.onPanelStoreChange),Fv.Z.addListener(this.onFolderSelection),this.context.addEventListener("online",this._onOnline),this.context.addEventListener("offline",this._onOffline),this.isMailPanel()&&(H.Z.addListener([$.kMailShowUnsubscribed],Ie.Z.reconnectIMAPClients),H.Z.addListener([$.kMailPanelItemsOrder,$.kMailPanelItemsShowAccounts,$.kMailPanelItemsShowAllMessages,$.kMailPanelItemsShowCustomFolders,$.kMailPanelItemsShowFeeds,$.kMailPanelItemsShowFilters,$.kMailPanelItemsShowFlags,$.kMailPanelItemsShowLabels,$.kMailPanelItemsShowMailingLists,$.kMailShowUnsubscribed],this.onMailPanelSettingsChanged),H.Z.addListener($.kMailAccounts,this.onAccountDisplayNamePrefsChange)),H.Z.addListener([$.kMailPanelShowErrorMessages],this.onShowErrorsChanged),Tu.addListener(this.logsUpdated),this.logsUpdated()}componentDidUpdate(e){!e.open&&this.props.open&&this.props.focusContent&&W_.nextTick((()=>{this.refTreeList.current?.focusTree()}))}componentWillUnmount(){this._isMounted=!1,this.context.removeEventListener("online",this._onOnline),this.context.removeEventListener("offline",this._onOffline),mn.Z.removeListener(this.gotFolders),tf.Z.removeListener(this._onFiltersChanged),rf.removeListener(this.onImapStoreChange),ud.ZP.removeListener(this.onPanelStoreChange),Fv.Z.removeListener(this.onFolderSelection),H.Z.removeListener([$.kMailPanelShowErrorMessages],this.onShowErrorsChanged),this.isMailPanel()&&(H.Z.removeListener([$.kMailShowUnsubscribed],Ie.Z.reconnectIMAPClients),H.Z.removeListener([$.kMailPanelItemsOrder,$.kMailPanelItemsShowAccounts,$.kMailPanelItemsShowAllMessages,$.kMailPanelItemsShowCustomFolders,$.kMailPanelItemsShowFeeds,$.kMailPanelItemsShowFilters,$.kMailPanelItemsShowFlags,$.kMailPanelItemsShowLabels,$.kMailPanelItemsShowMailingLists,$.kMailShowUnsubscribed],this.onMailPanelSettingsChanged),H.Z.removeListener($.kMailAccounts,this.onAccountDisplayNamePrefsChange)),Tu.removeListener(this.logsUpdated)}getFailingAccountError=()=>{const e=Object.keys(this.state.mailAccounts).filter((e=>rf.isDisconnected(e)));if(0===e.length)return;const t=Tu.getLogsByComponent(["Mail"]).filter((t=>"error"===t.level&&t.tags.some((t=>e.includes(t)))));if(0===t.length)return;const n=t[t.length-1];return n.timestamp>K_?n:void 0};logsUpdated=()=>{this.setState({accountError:this.getFailingAccountError()})};onItemsActivated=(e,t)=>{this.openTabForMailbox(t[0])};activateAfterDelete=e=>{this.openTabForMailbox(e)};onImapStoreChange=()=>{navigator.onLine?this._onOnline():this._onOffline()};onFolderSelection=()=>{W_.nextTick((()=>{const e=Fv.Z.getSelectedFolder();e&&this.refTreeList.current?.selectByNode(e)}))};_onOnline=()=>{this.setState({online:!0,accountError:this.getFailingAccountError()})};_onOffline=()=>{this.setState({online:!1})};_onFiltersChanged=e=>{if("mailingLists"===e.target){const e=this.isFeedsPanel()?Y_():j_();this.setState({mailFolders:e})}else if("filters"===e.target){let t;const{filterIds:n}=e;if(n){const e=tf.Z.getByIds(n),s=[xe.Kz,xe.MN,xe.ut,xe.u4,xe.of,xe.Ry,xe.wC];t=n.length>e.length||e.some((e=>s.includes(e.accountId)))}else t=!0;if(t){const e=this.isFeedsPanel()?Y_():j_();this.setState({mailFolders:e})}}else if("updateIndexProgress"===e.target){const t=Math.floor(e.indexCount/e.total*100)||0;this.setState({indexProgress:t})}else if("finishIndexProgress"===e.target){const e=this.isFeedsPanel()?Y_():j_();this.setState({mailFolders:e,indexProgress:100})}};onPanelStoreChange=()=>{const e=this.refTreeList.current?.getWrapper(),t=ud.ZP.getChangeReason();this.props.open&&"setFocus"===t&&e instanceof this.context.HTMLElement&&!sl(this.context.document,e)&&this.refTreeList.current?.focusTree()};gotFolders=()=>{const e=this.isFeedsPanel()?Y_():j_();this.setState({mailFolders:e,mailAccounts:mn.Z.getAccounts(),waitingForAccountCache:!1})};getAllAccountMailboxes=e=>{const t=[];let n;switch(e.path){case xe.N1:n=xe.Nz;break;case xe.rp:n=xe.Hd;break;case xe.cm:n=xe.uT;break;case xe.$T:n=xe.hn}if(n){const e=mn.Z.getAccounts();for(const s in e){e[s].folders[n]?.forEach((({type:e,path:i,subscribed:o})=>{e===n&&t.push({accountId:s,path:i,subscribed:o})}))}}return t};openTabForMailbox=e=>{this.hasContentForMessageView(e)&&W_.nextTick((()=>{(e.accountId===xe.of?this.getAllAccountMailboxes(e):[e]).forEach((({accountId:e,path:t,subscribed:n})=>{t!==xe.ym&&((0,Rf.mq)(e)&&n?Ie.Z.checkNewDeletedModified(e,t):(0,Rf.Vd)(e)&&Me.checkForMail(e))})),d.ZP.openURL(this.context.vivaldiWindowId,je.jk.internals.mailpage,{singleton:!0}),l.Z.selectFolder(e)}))};handleMailboxClick=(0,no.Z)((e=>{if(e.accountId===xe.Ry&&e.path!==xe.ym){const[t,n]=Be.Z.fromCustomFolderPath(e.path);this.openTabForMailbox({...e,accountId:t,path:n})}else this.openTabForMailbox(e)}),200,{leading:!0,trailing:!1});handleExpandClick=(e,t)=>{this.refTreeList.current?.toggleSelectedExpansion(e,t)};rowComponent=e=>{const{node:t,level:n}=e;if(0===n)return U_(QE,{id:t.id,name:t.name,label:t.name,handleExpandClick:this.handleExpandClick,hasChildren:this.hasChildren(t),onClick:this.handleMailboxClick.bind(this,t),isExpanded:e.isExpanded,accountId:t.accountId,path:t.path},t.id);let{name:s}=t;const i=uc.Z.isAccountRootFolder(t);let o=!1,a=!1;if(i){const e=fn.Z.getAccountsAndAliases().find((e=>e.MAIL_EMAIL===t.accountId));e?.displayName&&(s=e?.displayName),o=e?.offline||!1,a=this.state.online}return U_(d_,{name:s,accountId:t.accountId,id:t.id,type:t.type,path:t.path,isAccount:i,isImap:(0,Rf.ZA)(t.accountId),isOnline:a,isOffline:o,level:n,onClick:this.handleMailboxClick.bind(this,t),isExpanded:e.isExpanded,onChange:e.onChange,onFocus:e.onFocus,onBlur:e.onBlur,inlineEditText:e.inlineEditText,handleExpandClick:this.handleExpandClick,hasChildren:this.hasChildren(t),subscribable:uc.Z.isSubscribable(t)&&!t.subscribed},t.id)};isFolder=()=>!0;getMailFolders=()=>{const e=[];for(const t of H.Z.get($.kMailPanelItemsOrder)){const n=R_.get(t);n&&e.push({handler:this.toggleShow.bind(this,n.showPref),type:"checkbox",checked:H.Z.get(n.showPref),label:n.name,labelEnglish:n.name})}return e};toggleShow=e=>{Ne.Z.toggle(e,!0,!1)};hasChildren=e=>Boolean(e.children&&e.children.length>0);hasContentForMessageView=e=>!0;openMailSettings=()=>{Ae.Z.showMailAccountDialog(this.context.vivaldiWindowId)};sendAllOutgoing=()=>{wn.Z.sendAll(this.context.vivaldiWindowId)};sendForAccount=e=>{wn.Z.sendForAccount(this.context.vivaldiWindowId,e)};rescanUnreadFlags=(e,t)=>{Ie.Z.rescanUnreadFlags(e,t)};showAddFolderDialog=e=>{Ae.Z.showAddMailFolder(this.context.vivaldiWindowId,{accountId:e})};showDeleteFolderDialog=(e,t)=>{Ae.Z.showDeleteMailFolder(this.context.vivaldiWindowId,{accountId:e,path:t})};getMenuCapability=async(e,t,n)=>{const s=this.winId;switch(e.action){case"CONTEXT_VIEW_ALL_MESSAGES":return{handler:()=>this.openTabForMailbox(n),isVisible:()=>Boolean(n),...t(s,e,{})};case"CONTEXT_RERUN_FILTER":return{handler:()=>l.Z.rerunFilter(n.accountId,n.path||xe.ym),isVisible:()=>Boolean(n),...t(s,e,{})};case"CONTEXT_MARK_ALL_AS_READ":{const i=n?vn.Z.getFolderType(n.accountId,n.path):"";return{handler:()=>l.Z.markAllRead(n.accountId,n.path),isVisible:()=>Boolean(n)&&i!==xe.Nz&&i!==xe.kY&&i!==xe.hn&&i!==xe.fZ,...t(s,e,{})}}case"CONTEXT_MOVE_ALL_TO_TRASH":{const i=n?vn.Z.getFolderType(n.accountId,n.path):"";return{handler:()=>function(e,t,n,s){const i=tf.Z.getListEntriesByFolder(t,n);Pf.Z.prepareDelete(e,!1,i,s)}(s,n.accountId,n.path,!0),isVisible:()=>Boolean(n)&&(i===xe.Hd||i===xe.kY||i===xe.fZ),...t(s,e,{})}}case"CONTEXT_EMPTY_TRASH":{const i=n?vn.Z.getFolderType(n.accountId,n.path):"";return{handler:()=>async function(e,t,n){if(vn.Z.getFolderType(t,n)!==xe.uT)throw new Error("Non-Trash folder can not be emptied");const s=tf.Z.getListEntriesByFolder(t,n);await Pf.Z.prepareDelete(e,!0,s)}(s,n.accountId,n.path),isVisible:()=>Boolean(n)&&i===xe.uT,...t(s,e,{})}}case"CONTEXT_CHECK_FOR_MAIL":return{handler:()=>this.checkAccountForMail(n.accountId),isVisible:()=>Boolean(n)&&uc.Z.isAccountRootFolder(n)&&!(0,Rf.S9)(n.accountId),...t(s,e,{})};case"CONTEXT_CREATE_FOLDER":return{handler:()=>this.showAddFolderDialog(n.accountId),isVisible:()=>Boolean(n)&&(0,Rf.ZA)(n.accountId)&&uc.Z.isAccountRootFolder(n)&&!(0,Rf.S9)(n.accountId),...t(s,e,{})};case"CONTEXT_DELETE_FOLDER":return{handler:()=>this.showDeleteFolderDialog(n.accountId,n.path),isVisible:()=>Boolean(n)&&(0,Rf.ZA)(n.accountId)&&uc.Z.isAccountSubFolder(n)&&"inbox"!==n.path.toLowerCase()&&!(0,Rf.S9)(n.accountId),...t(s,e,{})};case"CONTEXT_TOGGLE_MAIL_VIEWS":return{isVisible:()=>Boolean(n)&&this.isMailPanel(),...t(s,e,{})};case"CONTEXT_MAIL_FOLDER":return{items:this.getMailFolders(),...t(s,e,{})};case"CONTEXT_SEND":return{handler:()=>this.sendForAccount(n.accountId),isVisible:()=>Boolean(n)&&uc.Z.isAccountRootFolder(n),...t(s,e,{})};case"CONTEXT_RESCAN_UNREAD":return{handler:()=>this.rescanUnreadFlags(n.accountId,n.path),isVisible:()=>Boolean(n)&&uc.Z.isAccountSubFolder(n)&&(0,Rf.ZA)(n.accountId)&&!(0,Rf.S9)(n.accountId),...t(s,e,{})};case"CONTEXT_IMPORT_MAIL_FILES":return{handler:()=>l.Z.selectAndImportMailFiles(this.context,n),isVisible:()=>Boolean(n)&&uc.Z.isAccountSubFolder(n),...t(s,e,{})};case"CONTEXT_SUBSCRIBE":return{handler:()=>l.Z.subscribeMailbox(s,n),isVisible:()=>Boolean(n)&&uc.Z.isSubscribable(n)&&!n.subscribed,...t(s,e,{})};case"CONTEXT_UNSUBSCRIBE":return{handler:()=>Ae.Z.showMailUnsubscribeDialog(s,{folder:n}),isVisible:()=>Boolean(n)&&uc.Z.isSubscribable(n)&&n.subscribed,...t(s,e,{})};case"CONTEXT_RERUN_THREADING":return{handler:()=>l.Z.rerunThreading(n.accountId,n.path),isVisible:()=>Boolean(n)&&uc.Z.isAccountSubFolder(n),...t(s,e,{})};case"CONTEXT_MOVE_INTO_IMPORTANT":{const i=Boolean(n)&&n.accountId===xe.wC&&n.path!==xe.ym?tf.Z.getByFolder(n.accountId,n.path):null,o=i&&i.path!==xe.cs&&i.path!==xe.W4&&i.path.startsWith(xe.cs);return{handler:()=>l.Z.toggleMoveToOther(n),isVisible:()=>Boolean(o),...t(s,e,{})}}case"CONTEXT_MOVE_INTO_OTHER":{const i=Boolean(n)&&n.accountId===xe.wC&&n.path!==xe.ym?tf.Z.getByFolder(n.accountId,n.path):null,o=i&&i.path!==xe.cs&&i.path!==xe.W4&&i.path.startsWith(xe.W4);return{handler:()=>l.Z.toggleMoveToOther(n),isVisible:()=>Boolean(o),...t(s,e,{})}}case"CONTEXT_DELETE_ALL":return{handler:qe.removeAllFeeds,isVisible:()=>Boolean(n)&&n.id===xe.sM&&n.children&&this.hasChildren(n),...t(s,e,{})};case"CONTEXT_CREATE_LABEL":return{handler:()=>Ae.Z.showAddCustomLabel(s),isVisible:()=>Boolean(n)&&n.accountId===xe.ut,...t(s,e,{})};case"CONTEXT_FILTER_EDIT":return{handler:()=>Ae.Z.showSettings(this.context.vivaldiWindowId,"mail",{scroll:"mail_filters_and_actions"}),isVisible:()=>Boolean(n)&&n.accountId===xe.Kz,...t(s,e,{})};case"CONTEXT_ADD_NEW_ACCOUNT":return{handler:()=>Ae.Z.showMailAccountDialog(s),isVisible:()=>Boolean(n)&&n.accountId===xe.Sp,...t(s,e,{})};case"CONTEXT_REGENERATE":return{handler:l.Z.regenerateAllMailingLists,isVisible:()=>Boolean(n)&&n.accountId===xe.wC&&n.path===xe.ym,...t(s,e,{})};case"CONTEXT_ADVANCED":return{isVisible:()=>Boolean(n),...t(s,e,{})};default:return{...t(s,e,{})}}};getMenuVisibility=(e,t)=>{if(!t)return!1;switch(e.action){case"CONTEXT_RENAME":return this.isValidToEdit(t.id);case"CONTEXT_DELETE":return 1===this.validateForDeletion([t.id]).length;case"CONTEXT_FILTER_EDIT":return t.id.startsWith(xe.rQ);default:return!1}};confirmDelete=e=>{if(1!==e.length)return Promise.resolve(!1);const t=this.refTreeList.current?.findTreeItem(e[0]);return t?t.accountId===xe.ut?new Promise((e=>{Ae.Z.showDeleteCustomLabelConfirmation(this.context.vivaldiWindowId,t.name,e)})):Promise.resolve(!0):Promise.resolve(!1)};validateForDeletion=e=>{if(e.length>1)return[];const t=[];return e.forEach((e=>{const n=this.refTreeList.current?.findTreeItem(e);if(n){let s=!1;switch(n.accountId){case xe.Kz:case xe.ut:s=void 0!==n.path&&Boolean(tf.Z.getByFolder(n.accountId,n.path));break;case xe.wC:s=n.path!==xe.ym&&(!n.children||0===n.children.length);break;case xe.u4:s=n.id!==xe.sM}s&&t.push(e)}})),t};deleteNodes=e=>Promise.all(this.validateForDeletion(e).map((e=>{const t=this.refTreeList.current?.findTreeItem(e);if(t)switch(t.accountId){case xe.ut:!async function(e,t){const n=tf.Z.getByFolder(e,t);if(!n)throw new Error(`Filter not found for ${e} and ${t}`);if(!n.filterValue.include)throw new Error(`Filter for flag does not have any include rules: ${n.path}`);const s=n.filterValue.include.find((e=>e.some((e=>e.hasOwnProperty("flag")))));if(!s)throw new Error(`Filter for flag does not have flag include rule: ${n.path}`);const i=s.find((e=>e.hasOwnProperty("flag")))?.flag;if(void 0===i)throw new Error(`flag not found in include rule for label ${n.path}`);const o=tf.Z.getIndex(),a=[];for(const e of o)e.flags.includes(i)&&a.push(e.id);const r=[];await Re.Z.transaction("rw",[Re.Z.buffer,Re.Z.filters,Re.Z.filteringQueue,Re.Z.viewIds,Re.Z.imap,Re.Z.searchList],(async()=>{await Pe.Z.remove([n.id]),await Re.Z.searchList.where("id").anyOf(a).modify((e=>{const t=e.flags.indexOf(i);t>-1&&(e.flags.splice(t,1),r.push({id:e.id,updates:{flags:e.flags}}))})),await k_.Z.call(a,{[i]:!1})})),await De.Z.updateFilters([n.id]),l.Z.updateIndex({sleUpdates:r}),Ge.Z.filter(),Se.Z.flushBuffer()}(t.accountId,t.path);break;case xe.Kz:case xe.wC:{const e=tf.Z.getByFolder(t.accountId,t.path);if(e)return t.accountId===xe.wC?l.Z.removeMailingListFilter(this.context.vivaldiWindowId,e):l.Z.removeFilter(e.id);console.warn("No filter",t.accountId,t.path);break}case xe.u4:return qe.removeFeed(t.path);default:console.warn("Unknown account",t.accountId)}else console.warn("No match",e);return Promise.resolve()}))).then((()=>Promise.resolve()));onContextMenu=e=>{e.nativeEvent.buttons>0&&this.refTreeList.current?.unSelectAll(),this.refTreeList.current?.onContextMenu(e)};getRowHeight=({index:e})=>{const t=this.refTreeList.current?.getId(e);return void 0===t?24:$_.includes(t)?30:24};menu={name:"mailpanellist",getCapability:this.getMenuCapability,getVisibility:this.getMenuVisibility};getDropSupport=(e,t)=>{const n=t.dataTransfer.types.some((e=>e===H_)),{accountId:s,path:i}=e,o=vn.Z.getFolderType(s,i);return{available:n,onto:(s===xe.MN&&i!==xe.ym||s===xe.ut&&i!==xe.ym||s===xe.Ry&&i!==xe.ym||s===xe.of&&i===xe.tB||s===xe.of&&i===xe.rp||s===xe.of&&i===xe.$T||s===xe.of&&i===xe.cm||o===xe.uT||o===xe.Hd||o===xe.hn||o===xe.Oi||o===xe.e9)&&n,edge:"none"}};onDrop=(e,t,n)=>{const s=vn.Z.getFolderType(t.accountId,t.path),i=Fv.Z.getSelectedFolder();switch(!0){case t.accountId===xe.MN:Pf.Z.setStandardFlag(this.winId,t.path);break;case t.accountId===xe.ut:i&&i.accountId===xe.ut?Pf.Z.setLabels(this.winId,{[i.path]:!1,[t.path]:!0}):Pf.Z.setLabel(this.winId,t.path);break;case t.accountId===xe.of&&t.path===xe.tB:Pf.Z.markUnread(this.winId);break;case t.accountId===xe.of&&t.path===xe.rp||s===xe.Hd:Pf.Z.markAsJunk(this.winId);break;case t.accountId===xe.of&&t.path===xe.$T||s===xe.hn:Pf.Z.moveToArchive(this.winId);break;case t.accountId===xe.of&&t.path===xe.cm||s===xe.uT:{const t=JSON.parse(e.dataTransfer.getData(H_)).map((e=>tf.Z.getListEntry(e)));Pf.Z.prepareDelete(this.winId,!1,t,!0);break}case t.accountId===xe.Ry||s===xe.Oi||s===xe.e9:{const n=JSON.parse(e.dataTransfer.getData(H_)).map((e=>tf.Z.getListEntry(e))),[s,i]=t.accountId===xe.Ry?Be.Z.fromCustomFolderPath(t.path):[t.accountId,t.path];this.moveListEntries(n,s,i);break}case t.accountId===xe.Sp:t.path===xe.tB&&Pf.Z.markUnread(this.winId);break;case t.accountId===xe.wC:case t.accountId===xe.u4:case t.accountId===xe.Kz:break;default:if(t.path===xe.ym)break}return e.preventDefault(),e.stopPropagation(),Promise.resolve([])};moveListEntries=(e,t,n)=>{const s=new Set,i=Fv.Z.getSelectedFolder();if(i){const e=i?.type;e&&s.add(e);const t=De.Z.getByFolderId([i.accountId,i.path]);if(t){const{showDeleted:e,showJunk:n,showCustomFolder:i,showArchived:o}=Be.Z.getFilterOptions(t);switch(i&&s.add(xe.Oi),o&&s.add(xe.hn),e&&s.add(xe.uT),n&&s.add(xe.Hd),t.accountId){case xe.of:t.path!==xe.tB&&t.path!==xe.ik&&t.path!==xe.ym||s.add(xe.e9);break;case xe.wC:case xe.Kz:case xe.MN:case xe.ut:case xe.Sp:s.add(xe.e9)}}}const o=e.flatMap((e=>e.sourceFilterIds)).reduce(((e,t)=>{const n=De.Z.get(t);return n?e.push(n):et.Z.error("Mail",["move"],`Can not find any filter for id: ${t} when moving messages`),e}),[]),a=new Map,r=i&&mn.Z.get(i.accountId),l=o.filter((e=>{const t=vn.Z.getFolderType(e.accountId,e.path);if(r){if(i?.accountId!==e.accountId)return!1;if(![xe.Hd,xe.uT].includes(t)&&i?.path!==e.path)return!1}return s.has(t)})).map((e=>(a.set(e.id,{accountId:e.accountId,path:e.path}),{accountId:e.accountId,path:e.path})));if(0===l.length)et.Z.error("Mail",["move"],`Can not find any source filter to move from when moving ${e.length} message(s)`);else{const s=new Set;let i=0,o=0;e.forEach((e=>{let n=0,r=!1;e.sources.forEach(((e,i)=>{if(a.has(i)){const o=a.get(i)?.accountId;e.internal||++n,o&&o!==t&&(s.add(o),r=!0)}})),n>1&&++o,r&&++i}));const r=()=>(0,v_.Z)(this.context.vivaldiWindowId,e,l,t,n);i&&o?this.showMailMessageMoveDialog((e=>{e&&r()}),(0,Oe.Z)("Move message from different account and in multiple folders?","Move messages from different account and in multiple folders?",[i]),(0,Oe.Z)("Are you sure you want to move $1 message from $2 to $3? (Note: Messages in multiple folders will move to to a single folder)","Are you sure you want to move $1 messages from $2 to $3? (Note: Messages in multiple folders will move to to a single folder)",[i,[...s].join(", "),t])):i?this.showMailMessageMoveDialog((e=>{e&&r()}),(0,Oe.Z)("Move message to different account?","Move messages to different account?",[i]),(0,Oe.Z)("Are you sure you want to move $1 message from $2 to $3?","Are you sure you want to move $1 messages from $2 to $3?",[i,[...s].join(", "),t])):o?this.showMailMessageMoveDialog((e=>{e&&r()}),(0,Oe.Z)("Move message in multiple folders?","Move messages in multiple folders?",[o]),(0,Oe.Z)("Are you sure you want to move $1 message in multiple folders to a single folder?","Are you sure you want to move $1 messages in multiple folders to a single folder?",[o])):r()}};renderMailTree=()=>{const e=this.isFeedsPanel()?"FEEDS_PANEL":"MAIL_PANEL";return(0,fs.jsx)(yo,{ref:this.refTreeList,rowComponent:this.rowComponent,getDropSupport:this.getDropSupport,onDrop:this.onDrop,nodes:this.state.mailFolders,menu:this.menu,onItemsActivated:this.onItemsActivated,isFolder:this.isFolder,hasChildren:this.hasChildren,settings:e,multiSelect:!1,supportsInlineEdit:!0,supportsCollapseAll:!1,isValidToEdit:this.isValidToEdit,validateForDeletion:this.validateForDeletion,confirmDelete:this.confirmDelete,activateAfterDelete:this.activateAfterDelete,delete:this.deleteNodes,saveTitle:this.saveTitle,getTitle:this.getTitle,rowHeight:e=>this.getRowHeight(e),folderMode:"expand"})};findAccountIndex=(e,t)=>e.findIndex((e=>e.path===t.substring(`${xe.sM}_`.length)));getTitle=e=>{let t="",n="";if(e.startsWith(xe.jT))t=xe.wC,n=xe.jT;else if(e.startsWith(xe.rQ))t=xe.Kz,n=xe.rQ;else if(e.startsWith(xe.q0))t=xe.MN,n=xe.q0;else{const t=H.Z.get($.kRssSettings);if(e){return t[this.findAccountIndex(t,e)].title||""}}const s=e.replace(n+"_",""),i=tf.Z.getByFolder(t,s);return i?i.name:""};isValidToEdit=e=>!(!e.startsWith(xe.sM)||e===xe.sM)||(e.startsWith(xe.jT)&&e.split("/").length>1||e.startsWith(xe.rQ)||e.startsWith(xe.q0));saveTitle=(e,t)=>{if(e){const n=H.Z.get($.kRssSettings),s=n.find((t=>t.path===e.substring(`${xe.sM}_`.length)));if(s&&s.title!==t){const i={...s,title:t},o=this.findAccountIndex(n,e);return void qe.edit(i,o)}}let n,s="";if(e.startsWith(xe.jT))s=xe.wC,n=xe.jT;else if(e.startsWith(xe.rQ))s=xe.Kz,n=xe.rQ;else{if(!e.startsWith(xe.q0))return;s=xe.MN,n=xe.q0}const i=e.replace(n+"_",""),o=tf.Z.getByFolder(s,i);o&&t&&(o.name=t,Pe.Z.put(o).then((e=>{De.Z.updateFilters(e)})))};_getPendingMenu=()=>{const e=[];return f_.Z.m3GetAll().then((t=>{const n={};t.forEach((e=>{if(e.from){const t=e.from[0].address;n[t]||(n[t]=[]),n[t].push(e)}}));for(const t in n){const s=n[t].length;s>0&&e.push({handler:this.sendForAccount.bind(null,t),...(0,xs.Z)("Send from $1 ($2)",[t,s])})}return e}))};_getFetchMenuItems=()=>{const e=[],t=Object.keys(this.state.mailAccounts);for(const n of t)e.push({handler:this.checkAccountForMail.bind(null,n),...(0,xs.Z)("Check $1",[n])});return e};checkAccountForMail=e=>{(0,Rf.mq)(e)?Ie.Z.checkForMail(e):(0,Rf.Vd)(e)&&Me.checkForMail(e)};checkForMail=async()=>{this.setState({isCheckingMail:!0}),await Qv(),this._isMounted&&this.setState({isCheckingMail:!1})};checkForFeeds=()=>{gn.forceRefreshAllRSSAccounts()};showAddFeedDialog=()=>{Ae.Z.showAddFeed(this.context.vivaldiWindowId,[{url:"",path:crypto.randomUUID(),title:"",refreshInterval:0}])};showMailMessageMoveDialog=(e,t,n)=>{Ae.Z.showMessageMoveConfirmation(this.context.vivaldiWindowId,e,t,n)};onShowErrorsChanged=()=>{this.setState({showErrors:H.Z.get($.kMailPanelShowErrorMessages)})};onAccountDisplayNamePrefsChange=(e,t)=>{e.some((e=>t.some((t=>t.MAIL_EMAIL===e.MAIL_EMAIL&&t.displayName!==e.displayName))))&&this.forceUpdate()};onMailPanelSettingsChanged=()=>{const e=this.isFeedsPanel()?Y_():j_();this.setState({mailFolders:e})};setEarliestErrorTimestamp=e=>{K_=e,this.setState((()=>({accountError:this.getFailingAccountError()})))};_restoreLostAccounts=async e=>{this.setState({isRestoringAccounts:!0}),await y_(e),this._isMounted&&this.setState({isRestoringAccounts:!1})};_restoreLostFeeds=async()=>{this.setState({isRestoringFeeds:!0}),await S_(),this._isMounted&&this.setState({isRestoringFeeds:!1})};render(){if(!this.props.open)return null;const e=De.Z.getByAccountId(xe.u4),t=H.Z.get($.kRssSettings),n=t.length>0;if(this.isFeedsPanel()){const s=tf.Z.isInitialized()&&(this.state.isRestoringFeeds||t.length>e.length);return U_("div",{className:"panel",id:"mail_panel"},void 0,!s&&U_("header",{},void 0,U_(Dm,{title:this.state.online?this.props.title:(0,Oe.Z)("$1 – Offline",[this.props.title]),showCloseButton:this.props.showCloseButton}),U_("div",{className:"toolbar toolbar-default"},void 0,U_("div",{className:"toolbar toolbar-group"},void 0,U_(Fa,{tooltip:(0,Oe.Z)("Check all feeds"),image:Ts.GO5.small,disabled:!n,onClick:this.checkForFeeds}),X_,U_(Fa,{tooltip:(0,Oe.Z)("Add a feed"),onClick:this.showAddFeedDialog,image:Ts.md4.small})))),n||s?this.state.indexProgress<100?U_("span",{className:"mail-loading"},void 0,U_("progress",{max:"100",value:this.state.indexProgress})):U_("section",{onContextMenu:this.onContextMenu},void 0,this.renderMailTree()):U_("div",{className:"mail-onboarding"},void 0,U_("span",{dangerouslySetInnerHTML:{__html:Ts.Us1}}),U_("h1",{},void 0,(0,Oe.Z)("Add your first feed")),U_("p",{className:"faded-text"},void 0,(0,Oe.Z)("Click the “+” button to add a new feed."))),s&&U_("header",{},void 0,U_(Dm,{title:(0,Oe.Z)("Database Error Detected"),showCloseButton:this.props.showCloseButton}),U_("div",{className:"toolbar toolbar-default"},void 0,U_("label",{title:(0,Oe.Z)("Filters for feeds are missing from DB and need to be restored!")},void 0,U_("input",{type:"button",onClick:this._restoreLostFeeds,disabled:this.state.isRestoringFeeds,value:this.state.isRestoringFeeds?(0,Oe.Z)("Restoring Feeds ..."):(0,Oe.Z)("Restore Feeds")})))))}{const e=Object.keys(this.state.mailAccounts).length,t=H.Z.get($.kMailPanelItemsShowFeeds);if(!this.state.waitingForAccountCache){const e=H.Z.get($.kMailAccounts),t=Object.keys(this.state.mailAccounts);if(e.length>t.length){const t=m_(e,this.state.mailAccounts);if(this.state.isRestoringAccounts||t.length>0)return et.Z.warn("Mail",["Panel","Accounts"],"Some offline accounts in prefs are missig from accounts table!"),U_("header",{},void 0,U_(Dm,{title:(0,Oe.Z)("Database Error Detected"),showCloseButton:this.props.showCloseButton}),U_("div",{className:"toolbar toolbar-default"},void 0,U_("label",{title:(0,Oe.Z)("Offline accounts are missing from DB and need to be restored!")},void 0,U_("input",{type:"button",onClick:()=>this._restoreLostAccounts(t),disabled:this.state.isRestoringAccounts,value:this.state.isRestoringAccounts?(0,Oe.Z)("Restoring Accounts ..."):(0,Oe.Z)("Restore Accounts")}))))}}return this.state.waitingForAccountCache||0!==e||t&&n?U_("div",{className:"panel",id:"mail_panel"},void 0,U_("header",{},void 0,U_(Dm,{title:this.state.online?this.props.title:(0,Oe.Z)("$1 – Offline",[this.props.title]),showCloseButton:this.props.showCloseButton}),U_("div",{className:"toolbar toolbar-default"},void 0,U_("div",{className:"toolbar toolbar-group"},void 0,U_(Fa,{className:this.state.isCheckingMail?"btn-toolbar-spinner":"",disabled:this.state.isCheckingMail,tooltip:(0,Oe.Z)("Check all accounts"),onClick:this.checkForMail,isMenuIndicatorVisible:e>1,image:Ts.GO5.small,menu:this._getFetchMenuItems,menuOrigin:"bottomLeft"}),Q_,U_(Fa,{tooltip:(0,Oe.Z)("Send from all accounts"),onClick:this.sendAllOutgoing,disabled:100!==this.state.indexProgress,isMenuIndicatorVisible:e>1,image:Ts.zLp.small,menu:this._getPendingMenu,menuOrigin:"bottomLeft"})),U_(Fa,{title:(0,Oe.Z)("Compose"),tooltip:(0,Oe.Z)("Compose new mail")+" "+J.Z.getShortcut("COMMAND_MAIL_COMPOSE_NEW_MESSAGE"),onClick:ke.Z.createDraft.bind(null,void 0),image:Ts.XTV.small,className:"button-mail-compose"}))),this.state.showErrors&&!!this.state.accountError&&U_(u_,{logEntries:[this.state.accountError],component:"Mail",setEarliestErrorTimestamp:this.setEarliestErrorTimestamp}),U_("section",{className:"outerScrollbar",onContextMenu:this.onContextMenu},void 0,this.state.indexProgress<100?U_("span",{className:"mail-loading"},void 0,U_("progress",{max:"100",value:this.state.indexProgress})):this.renderMailTree())):U_("div",{className:"panel",id:"mail_panel"},void 0,U_("header",{},void 0,U_(Dm,{title:(0,Oe.Z)("Mail"),showCloseButton:this.props.showCloseButton})),U_("div",{className:"mail-onboarding-wrapper"},void 0,U_("div",{className:"mail-onboarding"},void 0,U_("span",{dangerouslySetInnerHTML:{__html:Ts.Rx8}}),U_("h1",{},void 0,(0,Oe.Z)("Add your first mail account")),U_("p",{className:"faded-text"},void 0,(0,Oe.Z)("You can add any IMAP or POP account to Vivaldi Mail.")),U_("input",{type:"button",onClick:this.openMailSettings,value:(0,Oe.Z)("Add Mail Account")}))))}}}const J_=function(e,t){return z_.indexOf(e.path)-z_.indexOf(t.path)},eM=function(e,t){return G_.indexOf(e.path)-G_.indexOf(t.path)},tM=function(e,t){return I_.k.indexOf(e.path)-I_.k.indexOf(t.path)},nM=function(e,t,n,s,i,o,a){s.sort(OE.JM).forEach((s=>{(0,g_.Z)(s.path,n)?sM(e,t,n+"/",s.children??[],i,o,a):s.children&&s.children.length>0&&nM(e,t,n,s.children,i,o,a)}))},sM=function(e,t,n,s,i,o,a){const r=t.indexOf("/");if(e===xe.u4||-1===r)i[n+=t]||(s.push({name:a||t,path:n,accountId:e,id:o+"_"+n,children:[]}),i[n]=!0);else{const l=t.substr(r+1),d=t.substr(0,r);if(i[n+=d])nM(e,l,n,s,i,o,a);else{const t={accountId:e,path:n,children:[],id:o+"_"+n,name:De.Z.getByFolderId([e,n])?.name||d};sM(e,l,n+"/",t.children??[],i,o,a),s.push(t),i[n]=!0}}},iM=(e,t)=>{const n=[],s={};for(let i=0;i<e.length;i++){const o=e[i],a=o.accountId===xe.MN?(0,D_.M)(o.path):o.accountId===xe.ut?(0,nZ.X)(o.path):o.name;sM(o.accountId,o.path,"",n,s,t,a)}return n},oM=()=>{const e=tf.Z.getByAccountId(xe.of);return 0===e.length?[]:e.map((e=>({name:(0,vf.W)(e.path),path:e.path,accountId:xe.of,id:xe.w1+"_"+e.path,children:[]})))},aM=e=>{const t=[],n=mn.Z.getAccounts(),s=new Set,i=new Set;for(const o in n){const a=uc.Z.getFoldersFlat({folders:n[o].folders},e);for(const e of a)if(e.type===xe.Oi){s.has(e.name)?i.add(e.name):s.add(e.name);const n=Be.Z.toFolderPath(o,e.path);t.push({...e,id:xe.Ry+"_"+n,accountId:xe.Ry,path:n})}}return t.forEach((e=>{if(i.has(e.name)){const t=e.path.substring(0,e.path.indexOf("/"));e.name=e.name+" ("+t+")"}})),t},rM=()=>({showAccounts:H.Z.get($.kMailPanelItemsShowAccounts),showAllMessages:H.Z.get($.kMailPanelItemsShowAllMessages),showCustomFolders:H.Z.get($.kMailPanelItemsShowCustomFolders),showFeeds:H.Z.get($.kMailPanelItemsShowFeeds),showFilters:H.Z.get($.kMailPanelItemsShowFilters),showFlags:H.Z.get($.kMailPanelItemsShowFlags),showLabels:H.Z.get($.kMailPanelItemsShowLabels),showMailingLists:H.Z.get($.kMailPanelItemsShowMailingLists),showUnsubscribed:H.Z.get($.kMailShowUnsubscribed)}),lM=q_;var dM;function cM(e,t,n,s){dM||(dM="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:dM,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const hM=function(e){function t(e){return cM("option",{title:e.name,value:JSON.stringify(e)},e.id,e.name)}const n=e.originalSelectedFolder?.accountId===xe.u4,s=n?xe.u4:xe.of,{selectedAccountId:i,selectedName:o}=e.filter;let a=(0,Oe.Z)("Selected");return e.currentAccountId&&e.currentPath&&(a=mn.Z.getFolderName(e.currentAccountId,e.currentPath)),e.isEditable?(i&&o&&(a=i===o?(0,Oe.Z)(i):(0,Oe.Z)(i)+"/"+(0,Oe.Z)(o)),cM("span",{},void 0,(0,Oe.Z)("Searching in: $1",[a]))):cM("div",{className:"MailSearchOptionsSelectedFolder"},void 0,cM("span",{},void 0,(0,Oe.Z)("Search in")),cM("select",{value:e.selectedFolderString,onChange:function(t){const n=t.currentTarget.value;let s;try{s=JSON.parse(n)}catch(e){et.Z.error("Mail",["search"],e)}s&&e.selectSearchFolder(s,n)},title:(0,Oe.Z)("Select which view to search in")},void 0,cM("option",{value:JSON.stringify({name:s,accountId:s,path:xe.ym,id:xe.i4+"_"+s}),title:n?(0,Oe.Z)("All Feeds"):(0,Oe.Z)("All Messages")},void 0,n?(0,Oe.Z)("All Feeds"):(0,Oe.Z)("All Messages")),e.originalSelectedFolder&&cM("optgroup",{label:(0,Oe.Z)("Current Folder")},void 0,cM("option",{title:a,value:JSON.stringify(e.originalSelectedFolder)},void 0,a)),(n?Y_():j_()).flatMap((s=>s.path===xe.ym&&(s.accountId===xe.of||s.accountId===xe.Sp||n&&xe.u4)?cM("optgroup",{label:s.name},s.id,s.children?.map((e=>t(e)))):s.accountId!==xe.Kz&&e.isFilterManager&&Be.Z.canSaveAsFilter(s.accountId,s.path)?t(s):void 0))))};var pM;function uM(e,t,n,s){pM||(pM="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:pM,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const gM=function(e){const[t,n]=hs.useState(!1),s=e=>{let t;const n=N()();if(n.endOf("day"),"string"==typeof e)if(e.endsWith("days")){const s=parseInt(e.substring(0,e.indexOf(" days")));t=n.subtract(s,"day").valueOf()}else if(e.endsWith("months")){const s=parseInt(e.substring(0,e.indexOf(" months")));t=n.subtract(s,"month").valueOf()}else if(e.endsWith("years")){const s=parseInt(e.substring(0,e.indexOf(" years")));t=n.subtract(s,"year").valueOf()}else if("custom"===e)return e;return t};return t?uM(WT,{onChange:t=>{const{value:n}=t.currentTarget,s=N()(n).endOf("day").valueOf();e.selectSentDate(s)},onKeyDown:e=>{switch(e.key){case"Enter":case"Escape":return void n(!1)}},autoFocus:!0,onBlur:e=>((0,to.ZP)(e),n(!1),Promise.resolve()),title:(0,Oe.Z)("After"),value:e.sentDate?N()(e.sentDate).format("YYYY-MM-DD"):N()().startOf("date").format("YYYY-MM-DD")}):uM("select",{value:e.sentDate,className:e.className,onChange:t=>{const s=t.currentTarget.value;"custom"!==s?s?e.selectSentDate(parseInt(s)):e.selectSentDate():n(!0)},title:(0,Oe.Z)("Select how far back in time the message can be dated.")},void 0,(()=>{let t=!1;const n=[[void 0,(0,Oe.Z)("Any Date")],["1 days",(0,Oe.Z)("Today")],["7 days",(0,Oe.Z)("One week")],["14 days",(0,Oe.Z)("Two weeks")],["1 months",(0,Oe.Z)("One month")],["6 months",(0,Oe.Z)("Six months")],["1 years",(0,Oe.Z)("One year")],["custom",(0,Oe.Z)("Custom date")]].map((([n,i])=>{e.sentDate&&s(n)===e.sentDate&&(t=!0);return uM("option",{value:s(n),title:i},i,i)}));return[uM("option",{disabled:!0,value:t?"default":e.sentDate,title:e.sentDate?(0,Oe.Z)("After: $1",[N()(e.sentDate).format("LL")]):(0,Oe.Z)("After: Any Date")},"default",e.sentDate?(0,Oe.Z)("After: $1",[N()(e.sentDate).format("LL")]):(0,Oe.Z)("After: Any Date")),...n]})())};var mM;function vM(e,t,n,s){mM||(mM="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:mM,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const fM=[$.kKeyboardTabToAll];class yM extends hs.Component{static contextType=xi.Z;_isMounted=!1;refAllButton=hs.createRef();constructor(e){super(e);const t=Fv.Z.getOptions();this.state={recipientTypes:this.getRecipientTypes(t),forSender:t.forSender,forContact:t.forContact,attachments:t.attachments,sentDate:t.sentDate,selectedFolderString:t.queryFolder?JSON.stringify(t.queryFolder):void 0,mailAddresses:[]}}componentDidMount(){Fv.Z.addListener(this.updateSearchOptions),this._isMounted=!0}componentWillUnmount(){this._isMounted=!1,Fv.Z.removeListener(this.updateSearchOptions)}selectAttachments=e=>{const t={...Fv.Z.getOptions()};"number"==typeof e?t.attachments=e:delete t.attachments,l.Z.setSearchOptions(t),l.Z.updateQueryResults(Fv.Z.getQuery(),void 0,void 0,t.queryAddition)};selectSentDate=e=>{const t={...Fv.Z.getOptions()};"number"==typeof e?t.sentDate=e:delete t.sentDate,l.Z.setSearchOptions(t),l.Z.updateQueryResults(Fv.Z.getQuery(),void 0,void 0,t.queryAddition)};changeRecipientTypes=(e,t)=>{const{checked:n}=e.target;n?this.addRecipientTypes(t):this.removeRecipientTypes(t)};doSearch=e=>{l.Z.updateQueryResults(e)};addRecipientTypes=e=>{this.setState((t=>{let n=[];if(t.forContact&&!t.forSender?n=Hc.Z.getAddressesById(t.forContact)||[]:t.forSender&&(n=[t.forSender]),n.length>0){const s=t.recipientTypes||new Set,i=Be.Z.getContactQuery(n,s);s.add(e);const o=Be.Z.getContactQuery(n,s),a=Fv.Z.getQuery(),r=o+a.substring(a.indexOf(i)+i.length);return this.doSearch(r),{recipientTypes:s}}}))};removeRecipientTypes=e=>{this.setState((t=>{const{recipientTypes:n,forSender:s,forContact:i}=t;let o=[];if(i&&!s?o=Hc.Z.getAddressesById(i)??[]:s&&(o=[s]),n&&o.length>0){const t=Be.Z.getContactQuery(o,n);n.delete(e);const s=Be.Z.getContactQuery(o,n),i=Fv.Z.getQuery(),a=s+i.substring(i.indexOf(t)+t.length);return this.doSearch(a),{recipientTypes:n}}}))};updateSearchOptions=e=>{const t=Fv.Z.getOptions();if(this._isMounted&&"setOptions"===e){const e=t.queryFolder?JSON.stringify(t.queryFolder):void 0;this.setState({selectedFolderString:e,sentDate:t.sentDate,attachments:t.attachments})}else"selectFolder"===e&&this.setState({forSender:t.forSender,forContact:t.forContact,recipientTypes:this.getRecipientTypes(t),mailAddresses:[]})};getRecipientTypes(e){let t="";if(e.forSender)t=e.forSender;else if(e.forContact){const n=Hc.Z.getAddressesById(e.forContact||"");n&&n.length>0&&(t=n[0])}const n=new Set,s=e.query||"";if(!t)return n;if(s.startsWith("(")){const e=s.match(/\((.*)\)/);e&&e.length>1&&(e[1].includes(Be.Z.getEqualsAddressQuery(t,"from"))&&n.add("from"),e[1].includes(Be.Z.getEqualsAddressQuery(t,"to"))&&n.add("to"),e[1].includes(Be.Z.getEqualsAddressQuery(t,"cc"))&&n.add("cc"))}return n}editFilter=()=>{Ae.Z.showSettings(this.context.vivaldiWindowId,"mail",{scroll:"mail_filters_and_actions"})};debounceUpdateMailFilterSelector=(0,no.Z)((e=>{this.updateMailFilterSelector(e)}),200);updateMailFilterSelector=e=>{this.setState((t=>{e.mailAddresses?e.rule="":e.mailAddresses=t.mailAddresses;const n=Be.Z.getAddedQuery(e)||"";return l.Z.updateQueryResults(Fv.Z.getQuery(),void 0,void 0,n),{mailAddresses:e.mailAddresses}}))};selectSearchFolder=e=>{const t={...Fv.Z.getOptions(),queryFolder:e};l.Z.setSearchOptions(t),l.Z.updateQueryResults(Fv.Z.getQuery(),e,void 0,t.queryAddition)};render(){const e=Fv.Z.getOptions(),t=e.queryFolder,n=tf.Z.getByFolder(t?t.accountId:this.props.currentAccountId,t?t.path:this.props.currentPath);if(!n)return null;const s=this.props.currentAccountId===xe.Kz&&!Be.Z.isValidSearch(e),i=n&&Be.Z.canSaveAsFilter(n.accountId,n.path)&&Be.Z.isValidSearch(e),o=Hc.Z.getAddressesById(this.state.forContact||""),a=this.state.forContact,r=a?Hc.Z.getNodeById(a):void 0,d=!this.state.forSender&&!this.state.forContact,c=this.state.forContact;return vM("div",{className:As()("toolbar toolbar-default mail-search MailSearchOptions",d&&"MailSearchOptions--search",c&&"MailSearchOptions--contact")},void 0,d&&this.props.currentAccountId!==xe.tQ&&vM("div",{className:"MailSearchOptions-SearchInContainer"},void 0,vM(hM,{filter:n,selectedFolderString:this.state.selectedFolderString,currentAccountId:this.props.currentAccountId,currentPath:this.props.currentPath,isEditable:s,selectSearchFolder:this.selectSearchFolder,originalSelectedFolder:Fv.Z.getSelectedFolder()}),!s&&vM("div",{className:"MailSearchOptions-DropdownContainer"},void 0,vM(gM,{className:"MailSearchOptions-Dropdown",selectSentDate:this.selectSentDate,sentDate:this.state.sentDate}),vM(GE,{className:"MailSearchOptions-Dropdown",selectAttachments:this.selectAttachments,attachments:this.state.attachments}))),this.props.currentAccountId===xe.tQ&&(0,fs.jsx)(fs.Fragment,{children:vM("h2",{className:"MailSearchOptions-Title"},void 0,(0,Oe.Z)("Displaying a single thread"))}),(this.state.forSender||this.state.forContact)&&(a&&1!==o?.length?vM("div",{className:"MailSearchOptions-TitleWrapper"},void 0,vM("h2",{className:"MailSearchOptions-Title"},void 0,(0,Oe.Z)("Displaying mails for")),vM("div",{className:"MailSearchOptions-ContactWrapper"},void 0,vM("img",{className:"MailSearchOptions-Image",src:r?.avatarUrl?r.avatarUrl:rZ.g,alt:""}),vM("select",{value:this.state.forSender||"all",className:"MailSearchOptions-Dropdown",onChange:e=>{const t=e.currentTarget.value;Pf.Z.enableContactView(this.context.vivaldiWindowId,a,"all"!==t?t:void 0)}},void 0,vM("option",{value:"all"},"all",r?.name?(0,Oe.Z)("$1 (All)",[r?.name||""]):(0,Oe.Z)("$1 addresses",[o?.length])),o?.map((e=>vM("option",{value:e},e,e)))))):vM("h2",{className:"MailSearchOptions-Title"},void 0,(0,Oe.Z)("Displaying mails for"),vM("span",{className:"MailSearchOptions-ContactWrapper"},void 0,a&&vM("img",{className:"MailSearchOptions-Image",src:r?.avatarUrl?r.avatarUrl:rZ.g,alt:""}),vM("span",{className:"MailSearchOptions-Contact"},void 0,o&&1===o.length?o[0]:this.state.forSender)))),(this.state.forSender||this.state.forContact)&&vM("div",{className:"MailSearchOptions-RecipientTypes"},void 0,vM("label",{className:"MailSearchOptions-RecipientType"},void 0,vM("input",{type:"checkbox",checked:this.state.recipientTypes.has("from"),onChange:e=>this.changeRecipientTypes(e,"from")}),(0,Oe.Z)("mail","from")),vM("label",{className:"MailSearchOptions-RecipientType"},void 0,vM("input",{type:"checkbox",checked:this.state.recipientTypes.has("to"),onChange:e=>this.changeRecipientTypes(e,"to")}),(0,Oe.Z)("to")),vM("label",{className:"MailSearchOptions-RecipientType"},void 0,vM("input",{type:"checkbox",checked:this.state.recipientTypes.has("cc"),onChange:e=>this.changeRecipientTypes(e,"cc")}),(0,Oe.Z)("cc"))),!s&&!this.state.forSender&&!this.state.forContact&&vM(UE,{saveFilter:()=>{},isEmpty:!1,onSubmit:(e,t)=>this.updateMailFilterSelector(e),selectedMailAddresses:this.state.mailAddresses,isSettings:!1}),s&&vM(Fa,{onClick:this.editFilter,title:(0,Oe.Z)("mail_filter","Edit Filter"),tooltip:(0,Oe.Z)("mail_filter","Edit Filter"),className:As()("MailSearchOptions-Save",d&&"MailSearchOptions-Save--search")}),!s&&!this.state.forContact&&vM("div",{className:"MailSearchOptions-SaveButtonContainer"},void 0,i&&vM(Fa,{tabIndex:0,className:"MailSearchOptions-Save",onClick:this.props.saveSearch,title:(0,Oe.Z)("Save as Filter"),tooltip:(0,Oe.Z)("Save search as Filter")}),vM(Fa,{tabIndex:0,className:"MailSearchOptions-Clear",onClick:l.Z.clearSearch,title:(0,Oe.Z)("Clear Search"),tooltip:(0,Oe.Z)("Clear and close search")})))}}const CM=sa(yM,fM);var wM;function bM(e,t,n,s){wM||(wM="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:wM,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const SM=[$.kKeyboardTabToAll,$.kMailSearchSortField,$.kMailSearchSortOrder,$.kMailViewLayout];var IM=bM(cE,{});class kM extends hs.Component{nodeRef=hs.createRef();constructor(e){super(e),this.state={columns:io()["vertical_wide"===this.props.prefValues[$.kMailViewLayout]?"mail_vertical":"mail_horizontal"]||oo(this.getMailSortFields(e.prefValues[$.kMailViewLayout])),slideBarStyle:tf.Z.hasNoListEntries()?{backgroundColor:"unset"}:{}}}componentDidUpdate(e){const t=this.props.prefValues[$.kMailViewLayout];t!==e.prefValues[$.kMailViewLayout]&&this.setState({columns:io()["vertical_wide"===t?"mail_vertical":"mail_horizontal"]||oo(this.getMailSortFields(t))}),this.props.hasNoListEntries!==e.hasNoListEntries&&this.setSlideBarStyle()}setSlideBarStyle=()=>{tf.Z.hasNoListEntries()?this.setState({slideBarStyle:{backgroundColor:"unset"}}):this.setState({slideBarStyle:{}})};getMailSortFields=e=>{const t=this.props.selectedFolder&&[xe.Nz,xe.kY,xe.fZ].includes(vn.Z.getFolderType(this.props.selectedFolder.accountId,this.props.selectedFolder.path));return[{value:"unread",text:(0,Oe.Z)("Unread"),icon:Ts.XQw.small,fullScreenTitle:(0,Oe.Z)("Unread"),width:36,visible:"vertical"!==e,isSortField:!1},{value:"flag",text:(0,Oe.Z)("Flag"),icon:Ts.nyn.small,fullScreenTitle:(0,Oe.Z)("Flag"),width:36,visible:"vertical"!==e,isSortField:!1},{value:"sender",text:t?(0,Oe.Z)("Recipient"):(0,Oe.Z)("Sender"),icon:Ts.HXY,fullScreenTitle:t?(0,Oe.Z)("Sort by Message Recipient"):(0,Oe.Z)("Sort by Message Sender"),width:150,visible:"vertical"!==e},{value:"subject",text:(0,Oe.Z)("Subject"),fullScreenTitle:(0,Oe.Z)("Sort by Subject"),width:300,visible:"vertical"!==e,key:!0},{value:"label",text:(0,Oe.Z)("Labels"),icon:Ts.rpm.small,fullScreenTitle:(0,Oe.Z)("Labels"),width:"vertical_wide"===e?36:140,visible:"vertical"!==e,isSortField:!1},{value:"attachment",text:(0,Oe.Z)("Attachment"),icon:Ts.onv,fullScreenTitle:(0,Oe.Z)("Attachment"),width:36,visible:"vertical"!==e,isSortField:!1},{value:"size",text:(0,Oe.Z)("Size"),icon:Ts.W9U,fullScreenTitle:(0,Oe.Z)("Size"),width:100,visible:"horizontal"===e,isSortField:!1},{value:"sentDate",text:(0,Oe.Z)("Date"),icon:Ts.V_c,fullScreenTitle:t?(0,Oe.Z)("Sort by Date Sent"):(0,Oe.Z)("Sort by Date Received"),width:150,visible:"vertical"!==e},{value:"threads",text:(0,Oe.Z)("Date (Threaded)"),icon:Ts.V_c,fullScreenTitle:(0,Oe.Z)("Sort by Date (Threaded)"),width:150,visible:!1}]};onSortChange=(e,t)=>{const n=this.props.prefValues[$.kMailSearchSortOrder],s=this.props.prefValues[$.kMailSearchSortField];("ascending"===n&&e!==Xi.Z.ASCENDING_SORT||"descending"===n&&e!==Xi.Z.DESCENDING_SORT)&&Ne.Z.set($.kMailSearchSortOrder,this.getMailSortOrder(e)),s!==t&&Ne.Z.set($.kMailSearchSortField,t)};saveSearch=()=>{const{queryFolder:e,queryAddition:t,queryOptions:n,attachments:s,sentDate:i}=Fv.Z.getOptions(),{accountId:o,path:a}=e||(this.props.selectedFolder||{}),r=tf.Z.getByFolder(o,a)||{},d=Be.Z.joinQueries(Fv.Z.getQuery(),t),c={...r.filterValue,...n,attachments:s,sentDate:i,query:d},h={name:d||Be.Z.generateFilterName(),accountId:xe.Kz,path:Math.random().toString(36).substring(2),filterValue:{...c},selectedAccountId:o,selectedName:r.name};l.Z.addFilter(h)};onUpdateRow=e=>{this.setState({columns:e})};onSaveRow=()=>{so(this.state.columns,"vertical_wide"===this.props.prefValues[$.kMailViewLayout]?"mail_vertical":"mail_horizontal")};getSortOrder(){return"ascending"===this.props.prefValues[$.kMailSearchSortOrder]?Xi.Z.ASCENDING_SORT:Xi.Z.DESCENDING_SORT}getMailSortOrder(e){switch(e){case Xi.Z.ASCENDING_SORT:return"ascending";case Xi.Z.DESCENDING_SORT:return"descending";default:throw new Error("Non existent mail sort order "+e)}}render(){const e=this.getMailSortFields(this.props.prefValues[$.kMailViewLayout]),t=this.getSortOrder(),n=this.props.selectedFolder,s=Fv.Z.getOptions(),i="horizontal"===this.props.position?"top":"left";return(0,fs.jsxs)("div",{ref:this.nodeRef,id:"mail_search",style:this.props.style,children:[(this.props.showMailSearchOptions||n?.accountId===xe.Kz||s.forSender||n?.accountId===xe.tQ||s.forContact)&&bM(CM,{saveSearch:this.saveSearch,currentPath:this.props.selectedFolder?.path||"",currentName:this.props.selectedFolder?.name||"",currentAccountId:this.props.selectedFolder?.accountId||""}),IM,bM(gv,{fields:e,columns:this.state.columns,onSortChange:this.onSortChange,sortField:this.props.prefValues[$.kMailSearchSortField],sortOrder:t,manualSorting:!1,keyAccess:this.props.prefValues[$.kKeyboardTabToAll],fullsize:"horizontal"===this.props.prefValues[$.kMailViewLayout]||"vertical_wide"===this.props.prefValues[$.kMailViewLayout],onUpdateRow:this.onUpdateRow,onSaveRow:this.onSaveRow,style:this.state.slideBarStyle},this.state.columns.flatMap((e=>e.id)).join()||"sortfield"),bM(BE,{position:this.props.position,onSelect:this.props.onSelect,columns:this.state.columns}),bM(lv,{onSlidebarPosition:this.props.onSlidebarPosition,position:i})]})}}const AM=sa(kM,SM);var TM,ZM=n(34155);function EM(e,t,n,s){TM||(TM="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:TM,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const _M=[$.kMailViewLayout,$.kMailViewDimensions];function MM(e,t){const n=ie.ZP.getPagesByUrl(e,je.xy.mailpage);return n.size>1&&n.first().id!==t}class NM extends hs.PureComponent{static contextType=xi.Z;mailSearchRef=hs.createRef();state={listEntry:void 0,hasNoListEntries:tf.Z.hasNoListEntries(),showMailSearchOptions:Be.Z.isValidSearch(Fv.Z.getOptions()),isDuplicateTab:MM(this.context.vivaldiWindowId,this.props.id)};onSlidebarPosition=(e,t)=>{const n=this.mailSearchRef.current?.nodeRef.current;if(!(n instanceof this.context.Element))return;var s=n.getBoundingClientRect(),i=t-s.top,o=e-s.left;const a={...this.props.prefValues[$.kMailViewDimensions]};"horizontal"===this.props.prefValues[$.kMailViewLayout]?(i>2e3?i=2e3:i<120&&(i=120),a.height=Math.floor(i)):(o>2e3?o=2e3:o<200&&(o=200),"vertical_wide"===this.props.prefValues[$.kMailViewLayout]?a.widthWide=Math.floor(o):a.width=Math.floor(o)),Ne.Z.set($.kMailViewDimensions,a)};componentDidMount(){Fv.Z.addListener(this._folderChanged),tf.Z.addListener(this._onFiltersChanged),ie.ZP.addListener(this._onPageStoreChange)}componentWillUnmount(){Fv.Z.removeListener(this._folderChanged),tf.Z.removeListener(this._onFiltersChanged),ie.ZP.removeListener(this._onPageStoreChange)}_onPageStoreChange=()=>{if(this.state.isDuplicateTab){const e=MM(this.context.vivaldiWindowId,this.props.id);e||this.setState({isDuplicateTab:e})}};_onFiltersChanged=()=>{this.state.hasNoListEntries!==tf.Z.hasNoListEntries()&&this.setState({hasNoListEntries:tf.Z.hasNoListEntries()})};_folderChanged=e=>{if("toggleShowMailSearchOptions"===e)return void this.setState((e=>({showMailSearchOptions:!e.showMailSearchOptions})));const t=Fv.Z.getSelectedFolder();if(!t)return;const n=Fv.Z.getOptions();this.setState({showMailSearchOptions:!!n.query||Be.Z.isValidSearch(n)});const s=(0,Oe.Z)(t.name),i=(0,Oe.Z)(t.accountId);let o="Labels"===i?(0,nZ.X)(s):s;s!==i&&(o+=" ("+i+")"),ZM.nextTick((()=>d.ZP.setTitle(this.props.id,this.context.vivaldiWindowId,o)))};handleSelection=(0,no.Z)((e=>{this.setState({listEntry:e})}),200,{leading:!0,trailing:!0});render(){if(!G.ZP.isMail(this.context.vivaldiWindowId))return EM("div",{className:"mail-single-window-error"},"mailview",EM("div",{},void 0,EM("span",{dangerouslySetInnerHTML:{__html:Ts.Rx8}}),EM("h1",{},void 0,(0,Oe.Z)("Mail is in Another Window")),EM("p",{className:"faded-text"},void 0,(0,Oe.Z)("The Vivaldi email client runs in a single window at a time.")),EM("input",{type:"button",className:"primary",onClick:()=>{const e=G.ZP.getMailWindowId();Ae.Z.showMail(e),s.Z.windows.update(e,{focused:!0})},value:(0,Oe.Z)("Go to Mail")})));if(this.state.isDuplicateTab)return EM("div",{className:"mail-onboarding-wrapper"},"mailview",EM("div",{className:"mail-onboarding"},void 0,EM("h1",{},void 0,(0,Oe.Z)("Mail is in Another Tab")),EM("p",{},void 0,(0,Oe.Z)("The Vivaldi email client runs in a single tab at a time."))));const e="vertical_wide"===this.props.prefValues[$.kMailViewLayout],t="horizontal"===this.props.prefValues[$.kMailViewLayout]?{height:this.props.prefValues[$.kMailViewDimensions].height}:{width:this.props.prefValues[$.kMailViewDimensions][e?"widthWide":"width"]};return EM("div",{id:"mail_view",className:this.props.prefValues[$.kMailViewLayout]},void 0,(0,fs.jsx)(AM,{ref:this.mailSearchRef,selectedFolder:Fv.Z.getSelectedFolder(),showMailSearchOptions:this.state.showMailSearchOptions,onSlidebarPosition:this.onSlidebarPosition,position:this.props.prefValues[$.kMailViewLayout],style:t,hasNoListEntries:this.state.hasNoListEntries,onSelect:this.handleSelection}),EM(tE,{listEntry:this.state.listEntry,prefValues:this.props.prefValues,hasNoListEntries:this.state.hasNoListEntries,pageIsActive:this.props.isActive}))}}const PM=sa(NM,_M);var DM;function xM(e,t,n,s){DM||(DM="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:DM,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const OM=[$.kIncognitoShowIntro],LM=Ne.Z.getEventHandler,RM="https://vvld.in/privacy-and-security";var BM=xM("svg",{className:"private-window-background",viewBox:"0 0 1244 860"},void 0,xM("defs",{},void 0,xM("linearGradient",{x1:"0.15",y1:"0.3",x2:"0.3",y2:"0.5",id:"private-intro-bg-gradient"},void 0,xM("stop",{offset:"0",stopColor:"var(--colorFg)",stopOpacity:"0.03"}),xM("stop",{offset:"1",stopColor:"var(--colorFg)",stopOpacity:"0.003"})),xM("linearGradient",{x1:"1",y1:"0",x2:"0",y2:"1",id:"private-intro-accent-gradient"},void 0,xM("stop",{offset:"0",stopColor:"var(--colorAccentBg)",stopOpacity:"0"}),xM("stop",{offset:"0.5",stopColor:"var(--colorAccentBg)",stopOpacity:"1"}),xM("stop",{offset:"1",stopColor:"var(--colorAccentBg)",stopOpacity:"0"}))),xM("path",{fill:"url(#private-intro-bg-gradient)",d:"M0 0h153.513c16.141 27.93 32.15 55.734 47.912 83.11 16.086 27.94 32.722 56.832 49.076 85.128 11.01 19.031 22.079 38.316 32.781 56.967 25.186 43.883 51.228 89.259 77.402 132.848 33.382 55.651 75.894 82.121 137.77 85.829 3.205.192 6.454.288 9.655.288 39.673 0 78.14-14.461 108.316-40.722 21.644-18.834 48.687-52.291 54.604-104.667.749-6.654 1.357-13.708 1.855-19.573-1.07-29.74-6.476-52.92-17.294-74.518C622.935 139.46 612.708 67.99 625.087 0h136.676C747.1 44.93 749.845 96.364 774.32 145.251c20.839 41.6 30.654 85.7 31.485 138.023-.568 6.192-1.472 18.273-2.83 30.356-17.572 155.524-149.172 263.318-294.866 263.318-5.816 0-11.67-.173-17.526-.521C382.84 569.97 301.9 518.174 246.822 426.358c-38.015-63.313-74.255-127.68-111.253-191.634C90.359 156.507 45.49 78.062 0 0zm1113.47 0H1244v140.1c-7.496 27.86-18.849 54.995-34.031 81.275a1299530.57 1299530.57 0 0 1-170.255 294.799A1223193.145 1223193.145 0 0 0 841.018 860.24H687.72c135.675-235.123 271.527-470.147 407.26-705.25 22.311-38.621 31.22-79.696 25.368-124.548A170.12 170.12 0 0 0 1113.471 0z"}),xM("path",{stroke:"url(#private-intro-accent-gradient)",strokeWidth:"2",d:"M854 839.979L1103.98 407"}),xM("path",{stroke:"url(#private-intro-accent-gradient)",d:"M951 649.979L1200.98 217"}),xM("path",{stroke:"url(#private-intro-accent-gradient)",d:"M969 628.452L1126.86 356"}),xM("path",{stroke:"url(#private-intro-accent-gradient)",d:"M802 686.452L959.86 414"}),xM("path",{stroke:"url(#private-intro-accent-gradient)",opacity:".5",d:"M735 790.452L892.86 518"}));class FM extends hs.Component{static contextType=xi.Z;state={searchEngines:Gn.Z.get()};componentDidMount(){Gn.Z.addListener(this.#R)}componentWillUnmount(){Gn.Z.removeListener(this.#R)}#R=()=>{this.setState({searchEngines:Gn.Z.get()})};#B=e=>{e.preventDefault(),d.ZP.openURL(this.context.vivaldiWindowId,RM,{inCurrent:!1,inBackground:!1})};#F=()=>{d.ZP.openURL(this.context.vivaldiWindowId,"https://store.vivaldi.com/shop/privacy-ghost-unisex-t-shirt/?pk_campaign=private-window",{inCurrent:!1,inBackground:!1})};#V=e=>{C.Z.searchEngines.setDefault("defaultPrivate",e.currentTarget.value)};#W=e=>{const t=[{handler:this.#F,...(0,xs.Z)("Get the T-Shirt")}];(0,Qi.Z)(this.context,t)(e)};render(){const e=Gn.Z.getDefault(!0);return xM("div",{className:"private-intro"},void 0,BM,xM("div",{className:"private-intro-content"},void 0,xM("h1",{},void 0,(0,Oe.Z)("title","Private Window")),xM("span",{className:"private-intro-ghost",dangerouslySetInnerHTML:{__html:n(51491)},onContextMenu:this.#W,onDoubleClick:this.#F}),xM("p",{},void 0,(0,Oe.Z)("Browsing in a Private Window means that searches, sites visited, cookies, and temporary files won’t be stored by Vivaldi. It does not encrypt or otherwise modify your connection.")),xM("p",{},void 0,xM("a",{tabIndex:0,href:RM,onClick:this.#B},void 0,(0,Oe.Z)("Learn more about Privacy & Security"))),xM("h2",{},void 0,(0,Oe.Z)("Default Search")),xM("p",{className:"private-intro-blurb"},void 0,xM("span",{},void 0,(0,Oe.Z)("While in a Private Window, Vivaldi will use $1 to answer your searches.",[e?.name])),xM("span",{},void 0,"DuckDuckGo"===e?.name&&" "+(0,Oe.Z)("DuckDuckGo is a search engine that does not track your search history, enabling you to search privately."))),xM("h3",{},void 0,(0,Oe.Z)("Search with")),xM("label",{className:"private-intro-select-searchengine"},void 0,e&&xM(Ss,{className:"private-intro-favicon",url:e.faviconUrl,loadType:"faviconFromCache"}),xM("select",{value:e?.id,onChange:this.#V},void 0,this.state.searchEngines.map((e=>xM("option",{value:e.id},e.id,e.name))))),xM("label",{className:"private-intro-disable"},void 0,xM("input",{type:"checkbox",checked:!this.props.prefValues[$.kIncognitoShowIntro],onChange:LM($.kIncognitoShowIntro,"inverse")}),xM("span",{},void 0,(0,Oe.Z)("Do Not Show Introduction Again")))))}}const VM=sa(FM,OM);var WM;function UM(e,t,n,s){WM||(WM="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:WM,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function HM(){return UM("webview",{src:`${h.oP}/saga/saga.html`})}const zM={SpeedDial:"startpage",Bookmarks:"bookmarks",History:"history",Calendar:"calendar",Mail:"mailpage",NotesManager:"notes"},GM="HintTooltip",$M={show:100,hide:300},KM="top";class jM extends hs.Component{static contextType=xi.Z;_container=hs.createRef();_hint=hs.createRef();state={visible:!1,at:KM,top:0,left:0};componentWillUnmount(){clearTimeout(this._timeout)}getScrollParent=e=>{const{overflowY:t}=this.context.getComputedStyle(e);return!["visible","hidden"].includes(t)&&e.scrollHeight>e.clientHeight?e:e.parentElement?this.getScrollParent(e.parentElement):e};getHintPosition=()=>{let e=this.props.position||KM;const{top:t,left:n,width:s,height:i}=this._container.current?.getBoundingClientRect()||{top:0,left:0,width:0,height:0},{width:o,height:a}=this._hint.current?.getBoundingClientRect()||{width:0,height:0};if(!this.props.position){const r=this._container.current?.parentElement?this.getScrollParent(this._container.current.parentElement):this.context.document.documentElement;if(!r)return;const{top:l,left:d}=r.getBoundingClientRect()||{top:0,left:0},{clientHeight:c,clientWidth:h}=r,p={left:n-d-o>0,right:n-d+s+o<h,bottom:t-l+i+a<c,top:t-l-a>0};switch(e){case"left":p.left||(e="right",p.right||(e="top",p.top||(e="bottom")));break;case"right":p.right||(e="left",p.left||(e="top",p.top||(e="bottom")));break;case"bottom":p.bottom||(e="top",p.top||(e="right",p.right||(e="left")));break;default:p.top||(e="bottom",p.bottom||(e="right",p.right||(e="left")))}}let r,l;switch(e){case"left":r=(i-a)/2,l=-o;break;case"right":r=(i-a)/2,l=s;break;case"bottom":r=i,l=(s-o)/2;break;default:r=-a,l=s-o>0?s-o:(s-o)/2}this.setState({at:e,top:r,left:l})};showHint=()=>{const{show:e}=this.props.delay||$M;clearTimeout(this._timeout),this._timeout=setTimeout((()=>this.setState({visible:!0},(()=>this.getHintPosition()))),e)};hideHint=()=>{const{hide:e}=this.props.delay||$M;clearTimeout(this._timeout),this._timeout=setTimeout((()=>this.setState({visible:!1})),e)};toggleHint=()=>{const{show:e,hide:t}=this.props.delay||$M,n=this.state.visible;clearTimeout(this._timeout),this._timeout=setTimeout((()=>this.setState({visible:n},(()=>n&&this.getHintPosition()))),n?t:e)};render(){const{label:e,className:t}=this.props,{at:n,top:s,left:i}=this.state;return(0,fs.jsxs)("div",{className:As()(t,GM,[`HintTooltip--${n||KM}`],["HintTooltip--"+(this.state.visible?"Visible":"Hidden")]),role:"tooltip",ref:this._container,onFocus:this.showHint,onBlur:this.hideHint,onMouseEnter:this.showHint,onMouseLeave:this.hideHint,onTouchEnd:this.toggleHint,children:[(0,fs.jsx)("div",{ref:this._hint,style:{top:s,left:i},className:"HintTooltip__content",children:e}),this.props.children]})}}var YM,XM=n(66777);function QM(e,t,n,s){YM||(YM="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:YM,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const qM=[$.kAddressBarOmniboxEnabled,$.kAddressBarOmniboxDropdownPriority,$.kAddressBarInlineSearchEnabled,$.kAddressBarOmniboxShowBestResult,$.kAddressBarOmniboxShowSearchHistory,$.kAddressBarOmniboxShowNicknames,$.kAddressBarOmniboxShowBookmarks,$.kAddressBarOmniboxShowTypedHistory,$.kAddressBarOmniboxShowTopSites,$.kAddressBarInlineSearchSuggestEnabled,$.kAddressBarOmniboxShowBrowserHistory,$.kAddressBarOmniboxShowInternalUrls,$.kAddressBarOmniboxShowSearchOrGoTo,$.kVivaldiAddressBarSearchDirectMatchEnabled,$.kAddressBarOmniboxShowSyncTabs],JM=Ne.Z.getEventHandler,eN=[{key:"BEST_RESULT",name:(0,Oe.Z)("Best Result"),pref:$.kAddressBarOmniboxShowBestResult,hint:(0,Oe.Z)("Most relevant suggestion found across all categories")},{key:"INTERNAL_URLS",name:(0,Oe.Z)("Vivaldi Pages"),pref:$.kAddressBarOmniboxShowInternalUrls,hint:(0,Oe.Z)("Vivaldi components and tools")},{key:"SEARCH",name:(0,Oe.Z)("Search / Go To"),pref:$.kAddressBarOmniboxShowSearchOrGoTo,hint:(0,Oe.Z)("Initiate a search or directly enter a web address")},{key:"NICKNAMES",name:(0,Oe.Z)("Bookmarks Nicknames"),pref:$.kAddressBarOmniboxShowNicknames,hint:(0,Oe.Z)("Bookmarks labeled with custom shortcut nicknames")},{key:"BOOKMARKS",name:(0,Oe.Z)("Bookmarks"),pref:$.kAddressBarOmniboxShowBookmarks,hint:(0,Oe.Z)("All saved bookmarks")},{key:"TYPED_HISTORY",name:(0,Oe.Z)("Typed History"),pref:$.kAddressBarOmniboxShowTypedHistory,hint:(0,Oe.Z)("Manually entered URLs and search queries")},{key:"FREQ_VISIT",name:(0,Oe.Z)("Frequently Visited Pages"),pref:$.kAddressBarOmniboxShowTopSites,hint:(0,Oe.Z)("Websites visited frequently in recent days")},{key:"SUGGESTIONS",name:(0,Oe.Z)("Search Suggestions"),pref:$.kAddressBarInlineSearchSuggestEnabled,hint:(0,Oe.Z)("Recommendations provided by the search engine based on your current query")},{key:"HISTORY",name:(0,Oe.Z)("Browser History"),pref:$.kAddressBarOmniboxShowBrowserHistory,hint:(0,Oe.Z)("All recorded visits to pages and URLs")},{key:"DIRECT_MATCH",name:(0,Oe.Z)("Direct Match"),pref:$.kVivaldiAddressBarSearchDirectMatchEnabled,hint:(0,Oe.Z)("Shortcut to known brand website")},{key:"SYNCED_TABS",name:(0,Oe.Z)("Sync Tabs"),pref:$.kAddressBarOmniboxShowSyncTabs,hint:(0,Oe.Z)("Pages on your other devices")}];class tN extends hs.Component{renderListItem=(e,t)=>{const n=eN.find((e=>e.key===t.key)),s=n&&this.props.prefValues[n.pref];return n?(0,fs.jsxs)(fs.Fragment,{children:[QM("input",{type:"checkbox",disabled:!this.props.prefValues[$.kAddressBarOmniboxEnabled],value:t.key,checked:s,onChange:()=>{Ne.Z.toggle(n.pref,!0,!1);const e=H.Z.get(n.pref);n!==$.kAddressBarOmniboxShowBestResult||e||Ne.Z.set($.kAddressBarAutocompleteEnabled,!1)}}),QM(jM,{className:"hint-position",label:n.hint},void 0,t.name)]}):null};moveItem=(e,t)=>{const n=this.props.prefValues[$.kAddressBarOmniboxDropdownPriority].map((e=>e)),s=n.splice(e,1)[0];n.splice(t,0,s),Ne.Z.set($.kAddressBarOmniboxDropdownPriority,n)};resetList=()=>{Ne.Z.reset($.kAddressBarOmniboxDropdownPriority),eN.forEach((e=>{e.pref&&Ne.Z.reset(e.pref)}))};render(){const{prefValues:e}=this.props;return QM(XM.j,{className:"setting-group setting-group-double",filter:this.props.filter},void 0,QM("h3",{},void 0,(0,Oe.Z)("Drop-Down Menu")),QM(XM.C,{text:(0,Oe.Z)("Show Drop-Down when Typing")},void 0,QM("input",{type:"checkbox",checked:e[$.kAddressBarOmniboxEnabled],onChange:JM($.kAddressBarOmniboxEnabled)})),QM(XM.C,{text:(0,Oe.Z)("Show Search Queries in Typed History"),className:"pad-left"},void 0,QM("input",{type:"checkbox",disabled:!e[$.kAddressBarOmniboxEnabled],checked:e[$.kAddressBarOmniboxShowSearchHistory],onChange:JM($.kAddressBarOmniboxShowSearchHistory)})),QM("div",{className:"setting-single list-priority pad-top"},void 0,QM("h3",{},void 0,(0,Oe.Z)("Drop-Down Menu Priority")),QM("p",{className:"info"},void 0,(0,Oe.Z)("Select the order and which category to display. The autocomplete will prioritize categories by their order.")),QM(x_.Z,{filter:this.props.filter,items:(t=e[$.kAddressBarOmniboxDropdownPriority],t.map((e=>{const t=eN.find((t=>t.key===e));return{key:e,name:t?.name||""}}))),moveItem:this.moveItem,renderListItem:this.renderListItem,supportDragAndDrop:!0,mimeType:"vivaldi/x-settings-dropdown-type"}),QM("input",{type:"button",onClick:this.resetList,value:(0,Oe.Z)("Reset to Default")})));var t}}const nN=sa(tN,qM);var sN;function iN(e,t,n,s){sN||(sN="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:sN,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const oN=Ne.Z.getEventHandler;var aN=iN("input",{type:"radio",value:"alt"}),rN=iN("div",{className:"setting-single"},void 0,iN("label",{},void 0,iN("input",{type:"radio",value:"shift"}),iN("span",{},void 0,"Shift + Enter")));class lN extends hs.Component{render(){return iN(US.Z,{filter:this.props.filter},void 0,iN("div",{className:"setting-group"},void 0,iN("h3",{},void 0,(0,Oe.Z)("Open Address in New Tab")),iN(vl,{name:"urlfieldShortcut",className:"setting-single",value:this.props.value,onChange:oN($.kAddressBarUrlOpenShortcut)},void 0,iN("div",{className:"setting-single"},void 0,iN("label",{},void 0,aN,iN("span",{},void 0,"Alt + Enter"))),rN)))}}const dN=lN;var cN;function hN(e,t,n,s){cN||(cN="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:cN,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const pN="https://vivaldi.com/privacy/";function uN(e){return"string"!=typeof e.type}class gN extends hs.Component{static contextType=xi.Z;static defaultProps={displayPrivacyLink:!1};constructor(e){super(e),this.state={children:this.searchChildren(this.props)}}hiddenWhenFilter="";componentDidMount(){this.hideCategoryIfEmpty()}componentDidUpdate(e){this.props.filter!==e.filter?this.hiddenWhenFilter?this.shouldSearchHiddenComponent(this.hiddenWhenFilter,this.props.filter)&&this.setState({children:this.searchChildren(this.props)}):this.setState({children:this.searchChildren(this.props)}):this.props.children!==e.children&&this.setState({children:this.searchChildren(this.props)}),this.hideCategoryIfEmpty()}unfilteredChildren=e=>hs.Children.map(e.children,(e=>e&&uN(e)?hs.cloneElement(e,{filter:""}):e));filteredChildren=e=>hs.Children.map(e.children,((t,n)=>!t||uN(t)?t:(0,Vl.ZP)(t,e.filter)));searchChildren=e=>{if(!e.filter)return hs.Children.map(e.children,(e=>e));return(0,Vl.zR)(e.categoryTitle,e.filter)?this.unfilteredChildren(e):this.filteredChildren(e)};shouldSearchHiddenComponent=(e,t)=>!t||e.length>=t.length||e!==t.slice(0,e.length);hideCategoryIfEmpty=()=>{this.root&&(1===this.root.children.length||!0===this.props.displayPrivacyLink&&2===this.root.children.length?(this.root.style.display="none",this.hiddenWhenFilter=this.props.filter):(this.root.style.removeProperty("display"),this.hiddenWhenFilter=""))};openPrivacyPage=()=>{d.ZP.openURL(this.context.vivaldiWindowId,pN)};render(){const e=this.props.categoryTitle&&hN("h2",{},void 0,this.props.categoryTitle),t=(0,Vl.ZP)(e,this.props.filter)||e,n=(0,Oi.Z)(this.props,["filter","categoryTitle","displayPrivacyLink"]);return(0,fs.jsxs)("div",{ref:e=>e?this.root=e:null,...n,children:[t,e&&!0===this.props.displayPrivacyLink&&hN("div",{className:"privacy-link"},void 0,hN(hb,{title:pN,onClick:this.openPrivacyPage},void 0,(0,Oe.Z)("Learn more about Privacy in Vivaldi"))),this.state.children]})}}const mN=gN;var vN;function fN(e,t,n,s){vN||(vN="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:vN,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const yN=[$.kAddressBarAutocompleteSuffixExpansionEnabled,$.kAddressBarAutocompleteSuffixExpansionValue,$.kAddressBarAutocompleteEnabled,$.kAddressBarAutocompleteAutocompleteOnDomainFirst,$.kAddressBarAutocompleteAutocompleteOnTitle,$.kAddressBarExtensionsShowAllToggle,$.kAddressBarExtensionsRenderInDropdown,$.kAddressBarOmniboxCutcopyEncoded,$.kAddressBarOmniboxEnabled,$.kAddressBarOmniboxShowBookmarks,$.kAddressBarOmniboxShowTopSites,$.kAddressBarOmniboxShowTypedHistory,$.kAddressBarOmniboxShowBrowserHistory,$.kAddressBarOmniboxShowSearchHistory,$.kAddressBarPosition,$.kAddressBarSelectOnClick,$.kAddressBarShowFullUrl,$.kAddressBarShowProgress,$.kAddressBarShowQrGenerator,$.kAddressBarStripJavascriptOnPaste,$.kAddressBarUrlOpenShortcut,$.kAddressBarVisible,$.kAddressBarHighlightBaseDomain,$.kHttpsOnlyModeEnabled,$.kAddressBarOmniboxDropdownPriority,$.kAddressBarOmniboxShowNicknames,$.kAddressBarInlineSearchSuggestEnabled,$.kAddressBarInlineSearchEnabled],CN=Ne.Z.getEventHandler;var wN=fN("input",{type:"radio",value:"top"}),bN=fN("input",{type:"radio",value:"bottom"}),SN=fN("input",{type:"radio",value:"false"}),IN=fN("input",{type:"radio",value:"true"});class kN extends hs.Component{renderShowAddressBar(){return fN(XM.j,{filter:this.props.filter,className:"unlimited"},void 0,fN(XM.C,{text:(0,Oe.Z)("Show Address Bar")},void 0,fN("input",{type:"checkbox",checked:this.props.prefValues[$.kAddressBarVisible],onChange:CN($.kAddressBarVisible)})))}renderAddressBarPosition(){return fN(XM.j,{filter:this.props.filter,heading:(0,Oe.Z)("Address Bar Position")},void 0,fN(vl,{name:"addressbar-position",value:this.props.prefValues[$.kAddressBarPosition],onChange:CN($.kAddressBarPosition),className:"group"},void 0,fN(XM.C,{text:(0,Oe.Z)("Top")},void 0,wN),fN(XM.C,{text:(0,Oe.Z)("Bottom")},void 0,bN)))}renderAddressBarOptions(){return fN(XM.j,{filter:this.props.filter,heading:(0,Oe.Z)("Address Field Options")},void 0,fN(XM.C,{text:(0,Oe.Z)("Show Full Address")},void 0,fN("input",{type:"checkbox",checked:this.props.prefValues[$.kAddressBarShowFullUrl],onChange:CN($.kAddressBarShowFullUrl)})),fN(XM.C,{text:(0,Oe.Z)("Select Address on Activation")},void 0,fN("input",{type:"checkbox",checked:this.props.prefValues[$.kAddressBarSelectOnClick],onChange:CN($.kAddressBarSelectOnClick)})),fN(XM.C,{text:(0,Oe.Z)("Copy and Cut Encoded Address")},void 0,fN("input",{type:"checkbox",checked:this.props.prefValues[$.kAddressBarOmniboxCutcopyEncoded],onChange:CN($.kAddressBarOmniboxCutcopyEncoded)})),fN(XM.C,{text:(0,Oe.Z)("Page Load Progress Bar")},void 0,fN("input",{type:"checkbox",checked:this.props.prefValues[$.kAddressBarShowProgress],onChange:CN($.kAddressBarShowProgress)})),fN(XM.C,{text:(0,Oe.Z)("QR Code Generator")},void 0,fN("input",{type:"checkbox",checked:this.props.prefValues[$.kAddressBarShowQrGenerator],onChange:CN($.kAddressBarShowQrGenerator)})))}renderAddressBarAutoComplete(){return fN(XM.j,{filter:this.props.filter,heading:(0,Oe.Z)("Address Auto-Complete")},void 0,fN(XM.C,{text:(0,Oe.Z)("radio","Enabled")},void 0,fN("input",{type:"checkbox",checked:this.props.prefValues[$.kAddressBarAutocompleteEnabled],onChange:CN($.kAddressBarAutocompleteEnabled)})),fN(XM.C,{className:"pad-left",text:(0,Oe.Z)("Autocomplete On Item Title")},void 0,fN("input",{type:"checkbox",checked:this.props.prefValues[$.kAddressBarAutocompleteAutocompleteOnTitle],disabled:!this.props.prefValues[$.kAddressBarAutocompleteEnabled],onChange:CN($.kAddressBarAutocompleteAutocompleteOnTitle)})),fN(XM.C,{className:"pad-left",text:(0,Oe.Z)("Autocomplete On Domain First")},void 0,fN("input",{type:"checkbox",checked:this.props.prefValues[$.kAddressBarAutocompleteAutocompleteOnDomainFirst],disabled:!this.props.prefValues[$.kAddressBarAutocompleteEnabled],onChange:CN($.kAddressBarAutocompleteAutocompleteOnDomainFirst)})))}renderDomainExpansion(){return fN(XM.j,{filter:this.props.filter,heading:(0,Oe.Z)("Domain Expansion")},void 0,fN("p",{className:"info pad-top"},void 0,(0,Oe.Z)("Expand top level domains with Ctrl + Enter. This shortcut takes precedence over tab opening modifiers")),fN(XM.C,{text:(0,Oe.Z)("radio","Enabled")},void 0,fN("input",{type:"checkbox",checked:this.props.prefValues[$.kAddressBarAutocompleteSuffixExpansionEnabled],onChange:CN($.kAddressBarAutocompleteSuffixExpansionEnabled)})),fN(XM.C,{className:"pad-left",text:(0,Oe.Z)("Suffix")},void 0,fN("input",{disabled:!this.props.prefValues[$.kAddressBarAutocompleteSuffixExpansionEnabled],type:"text",defaultValue:this.props.prefValues[$.kAddressBarAutocompleteSuffixExpansionValue],maxLength:"256",onChange:CN($.kAddressBarAutocompleteSuffixExpansionValue)})))}renderExtensions(){return fN(XM.j,{filter:this.props.filter,heading:(0,Oe.Z)("Extension Visibility")},void 0,fN(vl,{name:"extension-toolbar-expansion",value:this.props.prefValues[$.kAddressBarExtensionsShowAllToggle],onChange:CN($.kAddressBarExtensionsShowAllToggle,"convert"),className:"group"},void 0,fN(XM.C,{label:(0,Oe.Z)("Show and hide only hidden extensions"),text:(0,Oe.Z)("Toggle Only Hidden Extensions")},void 0,SN),fN(XM.C,{label:(0,Oe.Z)("Show and hide all extensions"),text:(0,Oe.Z)("Toggle All Extensions")},void 0,IN)),fN(XM.C,{label:(0,Oe.Z)("Enable the drop-down menu for hidden extensions"),text:(0,Oe.Z)("Expand Hidden Extensions to Drop-Down Menu")},void 0,fN("input",{type:"checkbox",checked:this.props.prefValues[$.kAddressBarExtensionsRenderInDropdown],onChange:CN($.kAddressBarExtensionsRenderInDropdown)})))}renderProfileManagement(){return fN(XM.j,{filter:this.props.filter,heading:(0,Oe.Z)("Profile Management")},void 0,fN("input",{type:"button",onClick:Ae.Z.managePeople,value:(0,Oe.Z)("Manage Profiles")}))}renderSecurityFeatures(){return fN(XM.j,{filter:this.props.filter,heading:(0,Oe.Z)("Security Features")},void 0,fN(XM.C,{text:(0,Oe.Z)("Always Use Secure Connection (HTTPS)")},void 0,fN("input",{type:"checkbox",checked:this.props.prefValues[$.kHttpsOnlyModeEnabled],onChange:CN($.kHttpsOnlyModeEnabled)})),fN(XM.C,{text:(0,Oe.Z)("Strip JavaScript from Pasted Text")},void 0,fN("input",{type:"checkbox",checked:this.props.prefValues[$.kAddressBarStripJavascriptOnPaste],onChange:CN($.kAddressBarStripJavascriptOnPaste)})),fN(XM.C,{text:(0,Oe.Z)("Highlight Base Domain in Address")},void 0,fN("input",{type:"checkbox",checked:this.props.prefValues[$.kAddressBarHighlightBaseDomain],onChange:CN($.kAddressBarHighlightBaseDomain)})))}render(){return fN(mN,{categoryTitle:(0,Oe.Z)("title","Address Bar"),filter:this.props.filter},void 0,this.renderShowAddressBar(),this.renderAddressBarPosition(),this.renderAddressBarOptions(),fN(dN,{value:this.props.prefValues[$.kAddressBarUrlOpenShortcut],filter:this.props.filter}),this.renderAddressBarAutoComplete(),fN(nN,{filter:this.props.filter}),this.renderDomainExpansion(),this.renderProfileManagement(),this.renderExtensions(),this.renderSecurityFeatures())}}const AN=sa(kN,yN);var TN;function ZN(e,t,n,s){TN||(TN="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:TN,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const EN={auto:(0,Oe.Z)("theme","Auto"),light:(0,Oe.Z)("theme","Light"),dark:(0,Oe.Z)("theme","Dark")};var _N=ZN("svg",{width:"97",height:"76",viewBox:"0 0 97 76",xmlns:"http://www.w3.org/2000/svg",className:"tab-preview"},void 0,ZN("rect",{width:"48",height:"76",className:"website-appearance-preview background-color"}),ZN("rect",{x:"48",width:"49",height:"76",className:"website-appearance-preview foreground-color"}),ZN("path",{d:"M48 9H77C77.5523 9 78 9.44772 78 10V16C78 16.5523 77.5523 17 77 17H48V9Z",className:"website-appearance-preview background-color"}),ZN("path",{d:"M8 10C8 9.44772 8.44772 9 9 9H48V17H9C8.44771 17 8 16.5523 8 16V10Z",className:"website-appearance-preview foreground-color"}),ZN("g",{opacity:"0.3"},void 0,ZN("path",{d:"M48 25H9C8.44772 25 8 25.4477 8 26V27C8 27.5523 8.44771 28 9 28H48V25Z",className:"website-appearance-preview foreground-color"}),ZN("path",{d:"M48 31H9C8.44772 31 8 31.4477 8 32V33C8 33.5523 8.44771 34 9 34H48V31Z",className:"website-appearance-preview foreground-color"}),ZN("path",{d:"M48 37H9C8.44772 37 8 37.4477 8 38V39C8 39.5523 8.44771 40 9 40H48V37Z",className:"website-appearance-preview foreground-color"}),ZN("path",{d:"M48 43H9C8.44772 43 8 43.4477 8 44V45C8 45.5523 8.44771 46 9 46H48V43Z",className:"website-appearance-preview foreground-color"}),ZN("path",{d:"M48 55H9C8.44772 55 8 55.4477 8 56V57C8 57.5523 8.44771 58 9 58H48V55Z",className:"website-appearance-preview foreground-color"}),ZN("path",{d:"M8 62C8 61.4477 8.44772 61 9 61H29C29.5523 61 30 61.4477 30 62V63C30 63.5523 29.5523 64 29 64H9C8.44772 64 8 63.5523 8 63V62Z",className:"website-appearance-preview foreground-color"})),ZN("g",{opacity:"0.3"},void 0,ZN("path",{d:"M48 58H74C74.5523 58 75 57.5523 75 57V56C75 55.4477 74.5523 55 74 55H48V58Z",className:"website-appearance-preview background-color"}),ZN("path",{d:"M48 46H60C60.5523 46 61 45.5523 61 45V44C61 43.4477 60.5523 43 60 43H48V46Z",className:"website-appearance-preview background-color"}),ZN("path",{d:"M48 40H60C60.5523 40 61 39.5523 61 39V38C61 37.4477 60.5523 37 60 37H48V40Z",className:"website-appearance-preview background-color"}),ZN("path",{d:"M48 34H60C60.5523 34 61 33.5523 61 33V32C61 31.4477 60.5523 31 60 31H48V34Z",className:"website-appearance-preview background-color"}),ZN("path",{d:"M48 28H74C74.5523 28 75 27.5523 75 27V26C75 25.4477 74.5523 25 74 25H48V28Z",className:"website-appearance-preview background-color"}))),MN=ZN("svg",{width:"97",height:"76",viewBox:"0 0 97 76",xmlns:"http://www.w3.org/2000/svg",className:"tab-preview"},void 0,ZN("rect",{width:"97",height:"76",className:"website-appearance-preview foreground-color"}),ZN("g",{opacity:"0.3"},void 0,ZN("path",{d:"M9 25C8.44772 25 8 25.4477 8 26V27C8 27.5523 8.44771 28 9 28H74C74.5523 28 75 27.5523 75 27V26C75 25.4477 74.5523 25 74 25H9Z",className:"website-appearance-preview background-color"}),ZN("path",{d:"M9 55C8.44772 55 8 55.4477 8 56V57C8 57.5523 8.44771 58 9 58H74C74.5523 58 75 57.5523 75 57V56C75 55.4477 74.5523 55 74 55H9Z",className:"website-appearance-preview background-color"}),ZN("path",{d:"M8 32C8 31.4477 8.44772 31 9 31H60C60.5523 31 61 31.4477 61 32V33C61 33.5523 60.5523 34 60 34H9C8.44771 34 8 33.5523 8 33V32Z",className:"website-appearance-preview background-color"}),ZN("path",{d:"M9 61C8.44772 61 8 61.4477 8 62V63C8 63.5523 8.44772 64 9 64H41C41.5523 64 42 63.5523 42 63V62C42 61.4477 41.5523 61 41 61H9Z",className:"website-appearance-preview background-color"}),ZN("path",{d:"M8 44C8 43.4477 8.44772 43 9 43H60C60.5523 43 61 43.4477 61 44V45C61 45.5523 60.5523 46 60 46H9C8.44771 46 8 45.5523 8 45V44Z",className:"website-appearance-preview background-color"}),ZN("path",{d:"M9 37C8.44772 37 8 37.4477 8 38V39C8 39.5523 8.44771 40 9 40H60C60.5523 40 61 39.5523 61 39V38C61 37.4477 60.5523 37 60 37H9Z",className:"website-appearance-preview background-color"})),ZN("rect",{x:"8",y:"9",width:"70",height:"8",rx:"1",className:"website-appearance-preview background-color"})),NN=ZN("svg",{width:"97",height:"76",viewBox:"0 0 97 76",xmlns:"http://www.w3.org/2000/svg",className:"tab-preview"},void 0,ZN("rect",{width:"97",height:"76",className:"website-appearance-preview background-color"}),ZN("g",{opacity:"0.3"},void 0,ZN("path",{d:"M9 25C8.44772 25 8 25.4477 8 26V27C8 27.5523 8.44771 28 9 28H74C74.5523 28 75 27.5523 75 27V26C75 25.4477 74.5523 25 74 25H9Z",className:"website-appearance-preview foreground-color"}),ZN("path",{d:"M9 55C8.44772 55 8 55.4477 8 56V57C8 57.5523 8.44771 58 9 58H74C74.5523 58 75 57.5523 75 57V56C75 55.4477 74.5523 55 74 55H9Z",className:"website-appearance-preview foreground-color"}),ZN("path",{d:"M8 32C8 31.4477 8.44772 31 9 31H60C60.5523 31 61 31.4477 61 32V33C61 33.5523 60.5523 34 60 34H9C8.44771 34 8 33.5523 8 33V32Z",className:"website-appearance-preview foreground-color"}),ZN("path",{d:"M9 61C8.44772 61 8 61.4477 8 62V63C8 63.5523 8.44772 64 9 64H41C41.5523 64 42 63.5523 42 63V62C42 61.4477 41.5523 61 41 61H9Z",className:"website-appearance-preview foreground-color"}),ZN("path",{d:"M8 44C8 43.4477 8.44772 43 9 43H60C60.5523 43 61 43.4477 61 44V45C61 45.5523 60.5523 46 60 46H9C8.44771 46 8 45.5523 8 45V44Z",className:"website-appearance-preview foreground-color"}),ZN("path",{d:"M9 37C8.44772 37 8 37.4477 8 38V39C8 39.5523 8.44771 40 9 40H60C60.5523 40 61 39.5523 61 39V38C61 37.4477 60.5523 37 60 37H9Z",className:"website-appearance-preview foreground-color"})),ZN("rect",{x:"8",y:"9",width:"70",height:"8",rx:"1",className:"website-appearance-preview foreground-color"})),PN=ZN("svg",{xmlns:"http://www.w3.org/2000/svg",className:"selectbox-checkmark",viewBox:"0 0 15 16"},void 0,ZN("path",{d:"M5.3 13.3L1.5 9.5 3 8l2.3 2.5L13 2.7 14.6 4l-8 8z"}));class DN extends hs.Component{render(){if(!this.props.preference)return null;const e=this.props.preference,t=EN[this.props.preference],n=As()({selectbox:!0,"selectbox-selected":this.props.selected}),s=(0,Oi.Z)(this.props,["preference","vivaldiSettings"]);return(0,fs.jsxs)("button",{className:n,title:t,...s,children:[ZN("div",{className:"selectbox-image"},void 0,"auto"===e&&_N,"light"===e&&MN,"dark"===e&&NN,PN),ZN("div",{className:"selectbox-title"},void 0,t)]})}}const xN=DN;var ON,LN=n(34155);function RN(e,t,n,s){ON||(ON="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:ON,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class BN extends hs.PureComponent{state={zoom:sb.Z.getUIZoom()};componentDidMount(){sb.Z.addListener(this._onZoomStoreChanged)}componentWillUnmount(){sb.Z.removeListener(this._onZoomStoreChanged)}_onZoomStoreChanged=()=>{this.setState({zoom:sb.Z.getUIZoom()})};setZoomLevel=(e,t)=>{t?this.setState({zoom:e}):Qw.Z.setUIZoom(e),LN.nextTick((()=>{this.props.onUIZoomUpdate()}))};render(){const{zoom:e}=this.state;return RN(tb,{inFooter:!1,zoom:e,defaultZoomLevel:ib.an,scrolling:!1,maxLevel:ib.OK,minLevel:ib.bI,step:ib.Wp,delay:!0,onZoomUpdated:this.setZoomLevel},"zoomslider")}}const FN=BN;var VN;function WN(e,t,n,s){VN||(VN="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:VN,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const UN={width:400,minWidth:"unset"},HN=[$.kAppearanceCssUiModsDirectory,$.kAppearanceDisableTitleBar,$.kAppearanceForceDarkModeTheme,$.kAppearanceRangeButtons,$.kPopupsShowInTab,$.kPreferredColorScheme,$.kTabsBarPosition,$.kSettingsInTab,$.kSettingsMonoIcons,$.kStatusBarDisplay,$.kStatusBarMinimized,$.kThemeDimBlurred,$.kThemeSimpleScrollbar,$.kThemeUseAnimation,$.kWindowsLinuxAltControls,$.kWindowsUseNativeDecoration],zN=Ne.Z.getEventHandler,GN=0,$N=1,KN=2;var jN=WN("br",{}),YN=WN("input",{type:"radio",value:"false"}),XN=WN("input",{type:"radio",value:"true"}),QN=WN("input",{type:"radio",value:"on"}),qN=WN("input",{type:"radio",value:"overlay"}),JN=WN("input",{type:"radio",value:"off"}),eP=WN("br",{}),tP=WN("br",{}),nP=WN("br",{});class sP extends hs.Component{static contextType=xi.Z;refUIZoomSetting=hs.createRef();state={modFolder:this.props.prefValues[$.kAppearanceCssUiModsDirectory],confirmReset:!1};reportStatusBar=e=>{const{value:t}=e.target;Ne.Z.set($.kStatusBarDisplay,t),"on"!==t&&(Ne.Z.set($.kStatusBarMinimized,t),"overlay"===t&&c.Z.setStatus(this.context.vivaldiWindowId,(0,Oe.Z)("Status Info set to Overlay"),2e3))};confirmResetToolbars=()=>{this.setState({confirmReset:!0})};cancelResetToolbars=()=>{this.setState({confirmReset:!1})};handleResetToolbars=()=>{this.setState({confirmReset:!1}),Ne.Z.reset($.kToolbarsNavigation),Ne.Z.reset($.kToolbarsPanel),Ne.Z.reset($.kToolbarsStatus)};changeColorScheme=e=>{e!==GN&&e!==$N&&e!==KN||Ne.Z.set($.kPreferredColorScheme,e)};renderColorSchemePreference(){const e=this.props.prefValues,t=e[$.kPreferredColorScheme];return WN("div",{className:"setting-group unlimited"},void 0,WN("p",{className:"info"},void 0,(0,Oe.Z)("Some websites customize their color scheme according to user preferences. Choose which color scheme you would like these sites to use.")),WN("div",{className:"setting-single pad-top"},void 0,WN("div",{className:"selectbox-container"},void 0,WN(xN,{preference:"light",selected:t===$N,onClick:this.changeColorScheme.bind(this,$N)}),WN(xN,{preference:"dark",selected:t===KN,onClick:this.changeColorScheme.bind(this,KN)}),WN(xN,{preference:"auto",selected:t===GN,onClick:this.changeColorScheme.bind(this,GN)}))),WN("div",{className:"setting-single pad-top"},void 0,WN("label",{},void 0,WN("input",{type:"checkbox",checked:e[$.kAppearanceForceDarkModeTheme],onChange:zN($.kAppearanceForceDarkModeTheme),disabled:t!==KN}),WN("span",{},void 0,(0,Oe.Z)("Force a dark theme on all websites"))),WN("p",{className:"info",disabled:t!==KN},void 0,(0,Oe.Z)("Enabling this setting may break some websites and/or images."),jN,(0,Oe.Z)("This setting requires a restart to take full effect."))))}renderWindowSettings(){return WN("div",{className:"setting-group"},void 0,WN("div",{className:"setting-single"},void 0,WN("label",{},void 0,WN("input",{type:"checkbox",checked:this.props.prefValues[$.kWindowsUseNativeDecoration],onChange:zN($.kWindowsUseNativeDecoration)}),WN("span",{},void 0,(0,Oe.Z)("Use Native Window"))),WN("p",{className:"info"},void 0,(0,Oe.Z)("This setting requires a restart to take full effect."))),WN("div",{className:"setting-single"},void 0,WN("label",{},void 0,WN("input",{type:"checkbox",checked:!this.props.prefValues[$.kAppearanceDisableTitleBar],onChange:()=>{Ne.Z.toggle($.kAppearanceDisableTitleBar,!0,!1)}}),WN("span",{},void 0,(0,Oe.Z)("Show Title Bar"))),WN("p",{className:"info"},void 0,(0,Oe.Z)("This setting has no effect with Tab Bar visible on top."))),WN("div",{className:"setting-single"},void 0,WN("label",{},void 0,WN("input",{type:"checkbox",checked:this.props.prefValues[$.kThemeDimBlurred],onChange:zN($.kThemeDimBlurred)}),WN("span",{},void 0,(0,Oe.Z)("Fade Colors in Background Windows")))),WN("div",{className:"setting-single"},void 0,WN("label",{},void 0,WN("input",{type:"checkbox",checked:this.props.prefValues[$.kThemeSimpleScrollbar],onChange:zN($.kThemeSimpleScrollbar)}),WN("span",{},void 0,(0,Oe.Z)("Use Simple Scrollbars")))),WN("div",{className:"setting-single"},void 0,WN("label",{},void 0,WN("input",{type:"checkbox",checked:this.props.prefValues[$.kSettingsMonoIcons],onChange:zN($.kSettingsMonoIcons)}),WN("span",{},void 0,(0,Oe.Z)("Use Monochrome Settings Icons")))))}renderOpenInTabs(){const e=this.context.window.matchMedia("(prefers-reduced-motion: reduce)").matches;return WN("div",{className:"setting-group"},void 0,WN("div",{className:"setting-single"},void 0,WN("label",{},void 0,WN("input",{type:"checkbox",checked:this.props.prefValues[$.kSettingsInTab],onChange:zN($.kSettingsInTab)}),WN("span",{},void 0,(0,Oe.Z)("Open Settings in a Tab")))),WN("div",{className:"setting-single"},void 0,WN("label",{},void 0,WN("input",{type:"checkbox",checked:this.props.prefValues[$.kPopupsShowInTab],onChange:zN($.kPopupsShowInTab)}),WN("span",{},void 0,(0,Oe.Z)("Open Popups in Tabs")))),WN("div",{className:"setting-single pad-top"},void 0,WN("label",{},void 0,WN("input",{type:"checkbox",checked:this.props.prefValues[$.kThemeUseAnimation]&&!e,onChange:zN($.kThemeUseAnimation),disabled:e}),WN("span",{},void 0,(0,Oe.Z)("Use Animation"))),e&&WN("p",{className:"info"},void 0,(0,Oe.Z)("Animations are disabled due to OS “Reduce Motion” accessibility setting."))),WN("div",{className:"setting-single"},void 0,WN("label",{},void 0,WN("input",{type:"checkbox",checked:this.props.prefValues[$.kAppearanceRangeButtons],onChange:zN($.kAppearanceRangeButtons)}),WN("span",{},void 0,(0,Oe.Z)("Use Buttons in Range Controls")))))}renderWindowsControlPosition(){return WN("div",{className:"setting-group"},void 0,WN("h3",{},void 0,(0,Oe.Z)("Window Controls Position")),WN(vl,{className:"linuxAltControls",name:"linuxAltControls",value:this.props.prefValues[$.kWindowsLinuxAltControls],onChange:zN($.kWindowsLinuxAltControls,"convert")},void 0,WN("div",{className:"setting-single"},void 0,WN("label",{},void 0,YN,WN("span",{},void 0,(0,Oe.Z)("Right Side")))),WN("div",{className:"setting-single"},void 0,WN("label",{},void 0,XN,WN("span",{},void 0,(0,Oe.Z)("Left Side"))))))}renderStatusBar(){return WN("div",{className:"setting-group"},void 0,WN("h3",{},void 0,(0,Oe.Z)("title","Status Bar")),WN("div",{className:"setting-single"},void 0,WN(vl,{name:"StatusBar",className:"group",value:this.props.prefValues[$.kStatusBarDisplay],onChange:this.reportStatusBar},void 0,WN("div",{className:"setting-single"},void 0,WN("label",{},void 0,QN,WN("span",{},void 0,(0,Oe.Z)("verb","Show Status Bar")))),WN("div",{className:"setting-single"},void 0,WN("label",{},void 0,qN,WN("span",{},void 0,(0,Oe.Z)("Status Info Overlay")))),WN("div",{className:"setting-single"},void 0,WN("label",{},void 0,JN,WN("span",{},void 0,(0,Oe.Z)("verb","Hide Status Bar")))))))}renderToolbarCustomizations(){return WN("div",{className:"setting-group"},void 0,this.state.confirmReset&&WN(_r.Z,{style:UN,onRequestClose:this.cancelResetToolbars},void 0,WN("div",{className:"dialog-restore-shortcuts"},void 0,WN("header",{className:"dialog-header"},void 0,WN("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("Reset All Toolbars?"))),WN("div",{className:"dialog-content"},void 0,WN("p",{},void 0,(0,Oe.Z)("Icon placement in all toolbars will be restored to default."))),WN("footer",{className:"dialog-footer"},void 0,WN("input",{type:"button",className:"danger",onClick:this.handleResetToolbars,value:(0,Oe.Z)("Reset")}),WN("input",{type:"button",onClick:this.cancelResetToolbars,value:(0,Oe.Z)("Cancel"),autoFocus:!0})))),WN("div",{className:"setting-single"},void 0,WN("h3",{},void 0,(0,Oe.Z)("Toolbar Customization")),WN("p",{className:"info"},void 0,(0,Oe.Z)("Individual toolbars may be reset or edited using the context menu.")),WN("input",{type:"button",onClick:this.confirmResetToolbars,value:(0,Oe.Z)("Reset All Toolbars")})))}uiZoomUpdate=()=>{const e=this.refUIZoomSetting.current,{Element:t}=this.context;e instanceof t&&e.scrollIntoViewIfNeeded()};renderUserInterfaceZoom(){return(0,fs.jsx)("div",{className:"setting-group setting-group-double",ref:this.refUIZoomSetting,children:WN("div",{className:"setting-single"},void 0,WN("h3",{},void 0,(0,Oe.Z)("User Interface Zoom")),WN("div",{className:"toolbar toolbar-default"},void 0,WN(FN,{onUIZoomUpdate:this.uiZoomUpdate})))})}selectCSSFolder=()=>{C.Z.utilities.selectFile({windowId:this.context.vivaldiWindowId,title:(0,Oe.Z)("Select Folder for CSS UI Mods"),type:"folder"}).then((e=>{e&&(this.setState({modFolder:e}),Ne.Z.set($.kAppearanceCssUiModsDirectory,e))}))};onChangeCSSModFolder=e=>{this.setState({modFolder:e.target.value}),Ne.Z.set($.kAppearanceCssUiModsDirectory,e.target.value)};renderCustomStylingOptions(){return ds.Z.isEnabled("css_mods")?WN("div",{className:"setting-subgroup"},void 0,WN("div",{className:"setting-single"},void 0,WN("div",{className:"setting-single folder-selection"},void 0,WN("input",{type:"text",value:this.state.modFolder,title:(0,Oe.Z)("Enter Custom UI Modifications Path"),onChange:this.onChangeCSSModFolder}),WN("input",{type:"button",value:(0,Oe.Z)("Select Folder..."),onClick:this.selectCSSFolder})),WN("p",{className:"info"},void 0,(0,Oe.Z)("Directory for custom CSS UI modification files."),eP,(0,Oe.Z)("They must have a .css extension to be included."),tP,(0,Oe.Z)("No guarantees are made that these will work in new versions of Vivaldi."),nP,(0,Oe.Z)("This requires a restart to apply.")))):null}render(){return(0,fs.jsxs)(fs.Fragment,{children:[WN(mN,{categoryTitle:(0,Oe.Z)("Website Appearance"),filter:this.props.filter},void 0,this.renderColorSchemePreference()),WN(mN,{categoryTitle:(0,Oe.Z)("Window Appearance"),filter:this.props.filter},void 0,this.renderOpenInTabs(),this.renderWindowSettings(),!1,this.renderStatusBar(),this.renderToolbarCustomizations(),this.renderUserInterfaceZoom()),WN(mN,{categoryTitle:(0,Oe.Z)("Custom UI Modifications"),filter:this.props.filter,className:"setting-group unlimited"},void 0,this.renderCustomStylingOptions())]})}}const iP=sa(sP,HN);var oP;function aP(e,t,n,s){oP||(oP="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:oP,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class rP extends hs.Component{_isMounted=!1;_updateNotifierStatusKnown=!1;static#U=void 0;state={showUpdateSettings:!1,updateNotifierEnabled:!1,autoInstallUpdate:!0};componentDidMount(){this._isMounted=!0,void 0===rP.#U&&C.Z.autoUpdate.hasAutoUpdates().then((e=>{rP.#U=e,this._isMounted&&this.forceUpdate()}))}componentWillUnmount(){this._isMounted=!1}refreshUpdateNotifierEnabled=()=>{C.Z.autoUpdate.isUpdateNotifierEnabled((e=>{this.setUpdateNotifierEnabled(e)}))};setUpdateNotifierEnabled=e=>{this._isMounted&&this.setState({updateNotifierEnabled:e})};refreshAutoInstallUpdates=()=>{C.Z.autoUpdate.getAutoInstallUpdates((e=>{this._isMounted&&this.setState({autoInstallUpdate:e})}))};toggleUpdateSettings=()=>{this._updateNotifierStatusKnown||(this._updateNotifierStatusKnown=!0,this.refreshUpdateNotifierEnabled()),this.setState((e=>({showUpdateSettings:!e.showUpdateSettings})))};toggleUpdateNotifier=e=>{e.target.checked?C.Z.autoUpdate.enableUpdateNotifier((e=>{e?this.setUpdateNotifierEnabled(!0):this.refreshUpdateNotifierEnabled()})):C.Z.autoUpdate.disableUpdateNotifier((e=>{e?this.setUpdateNotifierEnabled(!1):this.refreshUpdateNotifierEnabled()}))};toggleAutoInstallUpdate=e=>{const t=e.target.checked;C.Z.autoUpdate.setAutoInstallUpdates(t),this.refreshAutoInstallUpdates()};getUpdateLabel(){return!1===rP.#U?(0,Oe.Z)("Automatically download updates and notify when they are ready to install"):(0,Oe.Z)("Automatically Download and Install Updates")}render(){return aP(mN,{categoryTitle:(0,Oe.Z)("Updates"),filter:this.props.filter},void 0,aP("div",{className:"setting-group unlimited"},void 0,aP("p",{className:"info"},void 0,(0,Oe.Z)("Get the latest security fixes by allowing automatic updates of Vivaldi.")),aP("div",{className:"setting-single"},void 0,aP("input",{type:"button",value:this.state.showUpdateSettings?(0,Oe.Z)("Hide Update Settings"):(0,Oe.Z)("Show Update Settings"),onClick:this.toggleUpdateSettings})),this.state.showUpdateSettings&&aP("div",{className:"setting-single"},void 0,aP("label",{},void 0,aP("input",{type:"checkbox",checked:this.state.updateNotifierEnabled,onChange:this.toggleUpdateNotifier}),aP("span",{},void 0,this.getUpdateLabel()))),!1))}}const lP=rP;var dP;function cP(e,t,n,s){dP||(dP="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:dP,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const hP=[$.kBiscuitLoadBookmarks,$.kBiscuitLogLevel,$.kBiscuitLogRockerGestures,$.kBiscuitVersion,$.kStartpageSpeedDialTrackerSuggestionShow,$.kBiscuitLogComponents],pP=Ne.Z.getEventHandler;var uP=cP("h2",{},void 0,"Biscuit Area 🐶"),gP=cP("h3",{},void 0,"Biscuit Mode"),mP=cP("span",{},void 0,"Show Browser Version on Status Bar"),vP=cP("span",{},void 0,"Upgrade Bookmarks Every Startup"),fP=cP("span",{},void 0,"Show “Support Us” Search Dialog"),yP=cP("span",{},void 0,"Log Rocker Gestures"),CP=cP("h3",{},void 0,"Logging"),wP=cP("div",{},void 0,"Log Level"),bP=cP("option",{value:"debug"},void 0,"Debug"),SP=cP("option",{value:"info"},void 0,"Info"),IP=cP("option",{value:"warn"},void 0,"Warn"),kP=cP("option",{value:"error"},void 0,"Error"),AP=cP("option",{value:"none"},void 0,"None"),TP=cP("h3",{},void 0,"Log Components");class ZP extends hs.Component{render(){return"🐶"!==this.props.filter&&"biscuit"!==this.props.filter?null:cP("span",{},void 0,uP,cP("div",{className:"setting-group-double"},void 0,gP,cP("div",{className:"setting-single"},void 0,cP("label",{},void 0,cP("input",{type:"checkbox",checked:this.props.prefValues[$.kBiscuitVersion],onChange:pP($.kBiscuitVersion)}),mP)),cP("div",{className:"setting-single"},void 0,cP("label",{},void 0,cP("input",{type:"checkbox",checked:this.props.prefValues[$.kBiscuitLoadBookmarks],onChange:pP($.kBiscuitLoadBookmarks)}),vP)),cP("div",{className:"setting-single"},void 0,cP("label",{},void 0,cP("input",{type:"checkbox",checked:this.props.prefValues[$.kStartpageSpeedDialTrackerSuggestionShow],onChange:pP($.kStartpageSpeedDialTrackerSuggestionShow)}),fP)),cP("div",{className:"setting-single"},void 0,cP("label",{},void 0,cP("input",{type:"checkbox",checked:this.props.prefValues[$.kBiscuitLogRockerGestures],onChange:pP($.kBiscuitLogRockerGestures)}),yP)),CP,cP("div",{className:"setting-single"},void 0,cP("label",{style:{alignItems:"center"}},void 0,wP,cP("select",{value:this.props.prefValues[$.kBiscuitLogLevel],onChange:pP($.kBiscuitLogLevel)},void 0,bP,SP,IP,kP,AP))),TP,cP("div",{className:"setting-single"},void 0,Object.entries(this.props.prefValues[$.kBiscuitLogComponents]).map((e=>{const[t,n]=e;return cP("div",{className:"setting-single"},t,cP("label",{},void 0,cP("input",{type:"checkbox",checked:n,onChange:e=>{const n={...this.props.prefValues[$.kBiscuitLogComponents],[t]:e.target.checked};Ne.Z.set($.kBiscuitLogComponents,n)}}),cP("span",{},void 0,t)))})))))}}const EP=sa(ZP,hP);var _P;function MP(e,t,n,s){_P||(_P="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:_P,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const NP=[$.kBookmarksBarDisplay,$.kBookmarksBarPosition,$.kBookmarksBarVisible],PP=Ne.Z.getEventHandler;var DP=MP("input",{type:"radio",value:"top"}),xP=MP("input",{type:"radio",value:"bottom"}),OP=MP("input",{type:"radio",value:"default"}),LP=MP("input",{type:"radio",value:"text"}),RP=MP("input",{type:"radio",value:"icon"}),BP=MP("input",{type:"radio",value:"iconexceptfolders"});class FP extends hs.Component{onFolderChange=e=>{g.Z.setBookmarkBarFolder(e.target.value)};render(){return MP(mN,{categoryTitle:(0,Oe.Z)("Bookmark Bar"),filter:this.props.filter},void 0,MP("div",{className:"setting-group unlimited"},void 0,MP("div",{className:"setting-single"},void 0,MP("label",{},void 0,MP("input",{type:"checkbox",checked:this.props.prefValues[$.kBookmarksBarVisible],onChange:PP($.kBookmarksBarVisible)}),MP("span",{},void 0,(0,Oe.Z)("Show Bookmark Bar"))))),MP("div",{className:"setting-group"},void 0,MP("h3",{},void 0,(0,Oe.Z)("Select Bookmark Bar Folder")),MP("div",{className:"setting-single"},void 0,MP(Zr,{onChange:this.onFolderChange}))),MP("div",{className:"setting-group"},void 0,MP("h3",{},void 0,(0,Oe.Z)("Bookmark Bar Position")),MP(vl,{name:"bookmark-position",value:this.props.prefValues[$.kBookmarksBarPosition],onChange:PP($.kBookmarksBarPosition)},void 0,MP("div",{className:"setting-single"},void 0,MP("label",{},void 0,DP,MP("span",{},void 0,(0,Oe.Z)("Top")))),MP("div",{className:"setting-single"},void 0,MP("label",{},void 0,xP,MP("span",{},void 0,(0,Oe.Z)("Bottom")))))),MP("div",{className:"setting-group"},void 0,MP("h3",{},void 0,(0,Oe.Z)("Bookmark Bar Display")),MP(vl,{name:"bookmark_bar_display",value:this.props.prefValues[$.kBookmarksBarDisplay],onChange:PP($.kBookmarksBarDisplay)},void 0,MP("div",{className:"setting-single"},void 0,MP("label",{},void 0,OP,MP("span",{},void 0,(0,Oe.Z)("Text and Icon")))),MP("div",{className:"setting-single"},void 0,MP("label",{},void 0,LP,MP("span",{},void 0,(0,Oe.Z)("radio","Text Only")))),MP("div",{className:"setting-single"},void 0,MP("label",{},void 0,RP,MP("span",{},void 0,(0,Oe.Z)("Icon Only")))),MP("div",{className:"setting-single"},void 0,MP("label",{},void 0,BP,MP("span",{},void 0,(0,Oe.Z)("Bookmark Icon Only")))))))}}const VP=sa(FP,NP);var WP;function UP(e,t,n,s){WP||(WP="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:WP,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const HP=[$.kBookmarksConfirmAdding,$.kBookmarksConfirmOpening,$.kBookmarksConfirmOpeningThreshold,$.kBookmarksFetchPageMetadata,$.kBookmarksOpenInNewTab,$.kBookmarksSingleClickOpens,$.kBookmarksUnderlineMenuLetter],zP=Ne.Z.getEventHandler;class GP extends hs.Component{minThreshold=1;maxThreshold=99;render(){return UP(mN,{categoryTitle:(0,Oe.Z)("Bookmarks"),filter:this.props.filter},void 0,UP("div",{className:"setting-group unlimited"},void 0,UP("div",{className:"setting-single"},void 0,UP("label",{},void 0,UP("input",{type:"checkbox",checked:this.props.prefValues[$.kBookmarksOpenInNewTab],onChange:zP($.kBookmarksOpenInNewTab)}),UP("span",{},void 0,(0,Oe.Z)("Open Bookmarks in New Tab")))),UP("div",{className:"setting-single"},void 0,UP("label",{},void 0,UP("input",{type:"checkbox",checked:this.props.prefValues[$.kBookmarksSingleClickOpens],onChange:zP($.kBookmarksSingleClickOpens)}),UP("span",{},void 0,(0,Oe.Z)("Open Bookmark Panel Items with Single Click")))),UP("div",{className:"setting-single"},void 0,UP("label",{},void 0,UP("input",{type:"checkbox",checked:this.props.prefValues[$.kBookmarksUnderlineMenuLetter],onChange:zP($.kBookmarksUnderlineMenuLetter)}),UP("span",{},void 0,(0,Oe.Z)("Use “&” in Title to Underline Next Letter in Menus")))),UP("div",{className:"setting-single max-bookmarks"},void 0,UP("label",{},void 0,UP("input",{type:"checkbox",checked:this.props.prefValues[$.kBookmarksConfirmOpening],onChange:zP($.kBookmarksConfirmOpening)}),UP("span",{},void 0,(0,Oe.Z)("Confirm Opening Bookmarks over Maximum of")),UP("input",{type:"number",size:"2",disabled:!this.props.prefValues[$.kBookmarksConfirmOpening],value:this.props.prefValues[$.kBookmarksConfirmOpeningThreshold],onChange:zP($.kBookmarksConfirmOpeningThreshold),min:this.minThreshold,max:this.maxThreshold}))),UP("div",{className:"setting-single max-bookmarks"},void 0,UP(XM.C,{text:(0,Oe.Z)("Fetch Bookmark Data from Page Metadata")},void 0,UP("input",{type:"checkbox",checked:this.props.prefValues[$.kBookmarksFetchPageMetadata],onChange:zP($.kBookmarksFetchPageMetadata)}))),UP("div",{className:"setting-single"},void 0,UP(XM.C,{text:(0,Oe.Z)("Always Open Bookmark Dialog")},void 0,UP("input",{type:"checkbox",checked:this.props.prefValues[$.kBookmarksConfirmAdding],onChange:zP($.kBookmarksConfirmAdding)})))))}}const $P=sa(GP,HP);var KP;function jP(e,t,n,s){KP||(KP="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:KP,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const YP=Ne.Z.getEventHandler,XP=[$.kMailIsTurnedOff];const QP=function(e){const t=(0,na.Z)(XP);return jP(mN,{categoryTitle:e.categoryTitle||(0,Oe.Z)("Productivity Features"),filter:e.filter,"data-anchor":"features"},void 0,jP(US.Z,{filter:e.filter},void 0,jP("div",{className:"setting-group unlimited"},void 0,jP("div",{className:"setting-single"},void 0,e.inform&&t[$.kMailIsTurnedOff]&&jP("h3",{},void 0,(0,Oe.Z)("Mail, Calendar and Feeds are Turned Off")),jP("label",{},void 0,jP("input",{type:"checkbox",checked:!t[$.kMailIsTurnedOff],onChange:YP($.kMailIsTurnedOff,"inverse")}),jP("span",{},void 0,(0,Oe.Z)("Enable Mail, Calendar and Feeds")))))))};var qP,JP=n(25201),eD=n(88545);function tD(e,t,n,s){qP||(qP="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:qP,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const{isCalDAV:nD,isOAuthProvider:sD}=Rd.Z,{UNKNOWN:iD,VERIFYING:oD,OK:aD,ERROR:rD}=Lu.LB;class lD extends hs.Component{constructor(e){super(e),this.state={status:iD,statusText:"",password:"",passwordChanged:!1,name:e.account.name,username:e.account.username,url:e.account.url,refreshing:!1}}componentDidMount=()=>{const{url:e,username:t}=this.state;e&&t&&(0,JP.Ij)({url:e,username:t}).then((e=>{e.found&&this.setState({password:e.password})}))};probeAccounts=async()=>{const{account:e}=this.props,{account_type:t}=e,{password:n}=this.state;let s={foundService:!1,statusMessage:"",calendars:[],eventCount:0};if(this.logStatus((0,Oe.Z)("Verifying..."),oD),"ical"===t){s=await ic.Z.probeWebCalendar(this.getAccount(),n);const{foundService:e,eventCount:t}=s;if(e)return this.logStatus((0,Oe.Z)("Connected to Web Calendar. Found $1 Event(s)",[t]),aD),e}else if(sD(t))s=await(0,eD.P)(this.getAccount(),n);else{if(!this.state.password)return this.logStatus((0,Oe.Z)("Password Missing..."),rD),!1;s=await(0,eD.P)(this.getAccount(),n)}return s.foundService?(this.logStatus((0,Oe.Z)("Connected to CalDAV. Found $1 Calendar(s)",[s.calendars.length]),aD),Iu.Z.resetStatus(this.props.account.name)):this.logStatus((0,Oe.Z)("Not connected. $1",[s.statusMessage||""]),rD),s.foundService};savePasswordIfNeeded=e=>{const{account_type:t}=this.props.account,{username:n,password:s,url:i}=this.state,{urlValid:o}=C.Z.utilities.isUrlValid(i);if(e&&(0,JP.QN)({url:i,username:n}),o){if(["caldav","vivaldi"].includes(t)||"ical"===t&&n.trim())try{this.logStatus("",iD),(0,JP.vW)({url:i,username:n},s)}catch(e){this.logStatus(e.message,rD)}}else this.logStatus((0,Oe.Z)("Invalid URL"),oD)};isAccountChanged=()=>this.state.name!==this.props.account.name||this.state.username!==this.props.account.username||this.state.url!==this.props.account.url||this.state.passwordChanged;onChangeCredentials=e=>{const t=e.target.value;this.setState({password:t,passwordChanged:!0,status:iD},(()=>this.savePasswordIfNeeded(!1)))};getAccount=()=>({id:this.props.account.id,name:this.state.name,username:this.state.username,url:this.state.url,account_type:this.props.account.account_type});logStatus=(e,t)=>{this.setState({status:t,statusText:e})};saveAccount=async()=>{let e=!0;const{account_type:t}=this.props.account;"local"!==t&&(e=await this.probeAccounts()),this.setState({passwordChanged:!1},(()=>{e&&this.props.saveAccount(this.getAccount())}))};changeName=e=>{const t=e.target.value;this.setState({name:t})};changeUrl=e=>{const t=e.target.value;t!==this.state.url&&this.setState({url:t},(()=>this.savePasswordIfNeeded(!0)))};changeUsername=e=>{const t=e.target.value;if(t!==this.state.username){const{url:e,username:n}=this.state;(0,JP.QN)({url:e,username:n}),this.setState({username:t},(()=>this.savePasswordIfNeeded(!0)))}};render(){const{name:e,url:t,account_type:n,username:s}=this.getAccount(),{password:i}=this.state,o=this.state.status===rD?"error":this.state.status===aD?"success":"info",a=["caldav","ical"].includes(n)||"vivaldi"===n&&i;return tD("form",{className:"detail",onSubmit:this.saveAccount},void 0,tD("div",{className:"detail-content"},void 0,tD("div",{className:"setting-group"},void 0,tD("div",{className:"setting-single"},void 0,tD(sc.Z,{type:"text",onChange:this.changeName,label:this.props.searchableStrings.Name,value:e}))),"local"!==n&&tD("div",{className:"setting-group"},void 0,tD("div",{className:"setting-single"},void 0,tD(sc.Z,{type:"text",onChange:this.changeUrl,label:this.props.searchableStrings.URL,value:t}))),(nD(n)||"ical"===n)&&tD("div",{className:"setting-group"},void 0,tD("div",{className:"setting-single"},void 0,tD(sc.Z,{type:"text",onChange:this.changeUsername,name:"username",label:this.props.searchableStrings.Username,value:s}))),a&&tD("div",{className:"setting-group"},void 0,tD("div",{className:"setting-single"},void 0,tD(sc.Z,{type:"password",onChange:this.onChangeCredentials,name:"password",label:this.props.searchableStrings.Password,value:i}))),this.state.statusText&&tD("div",{className:"setting-group-double"},void 0,tD(tc,{type:o},void 0,this.state.statusText))),tD("div",{className:"detail-toolbar"},void 0,tD("input",{type:"submit",value:(0,Oe.Z)("Save"),disabled:!this.isAccountChanged()}),"local"!==n&&tD("input",{type:"button",onClick:this.probeAccounts,value:(0,Oe.Z)("Test")})))}}const dD=lD;var cD,hD=n(1712);function pD(e,t,n,s){cD||(cD="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:cD,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const{startDeletingAccount:uD}=hD.Z,{prepareForDeleteAccount:gD}=Iu.Z;const mD=function(e){const[t,n]=hs.useState(""),[s,i]=hs.useState(""),{item:o,onClose:a,onDeleteInProgress:r}=e,l=async e=>{try{await uD(e)}catch(e){i(Mh.mixedToStrings([e]))}finally{n(""),r(!1)}},d=t===o.id;return pD("div",{},void 0,pD("header",{className:"dialog-header"},void 0,pD("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("Are you sure you want to remove the account ‘$1’ and its events?",[o.name]))),pD("div",{className:"dialog-content"},void 0,"local"===o.account_type&&pD("p",{},void 0,(0,Oe.Z)("This will permanently delete your local calendars and associated events. It can not be undone.")),"local"!==o.account_type&&pD("p",{},void 0,(0,Oe.Z)("This will not delete any data on the remote server. You can set it up again if you later want to use it in Vivaldi.")),s&&pD(tc,{type:"error"},void 0,s)),pD("footer",{className:"dialog-footer"},void 0,pD("input",{type:"button",className:"danger",disabled:d,onClick:async()=>{r(!0),n(o.id);try{"local"===o.account_type?l(o.id):await gD({accountId:o.id,onRemoval:l})}catch(e){i(Mh.mixedToStrings([e]))}finally{n(""),r(!1)}},value:d?(0,Oe.Z)("Removing Account"):(0,Oe.Z)("verb","Remove"),autoFocus:!0}),pD("input",{type:"button",onClick:a,disabled:d,value:(0,Oe.Z)("Cancel")})))};const vD=function(e){return hs.forwardRef((function(t,n){const s=xT(Bd.Z);return(0,fs.jsx)(e,{...t,ref:n,...s})}))};var fD;function yD(e,t,n,s){fD||(fD="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:fD,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const{createLocalAccountAndCalendar:CD}=hD.Z,{ensureAccountType:wD,isCalDAV:bD,ensureHttpsForWebcal:SD}=Rd.Z,{UNKNOWN:ID,VERIFYING:kD,OK:AD,ERROR:TD}=Lu.LB;function ZD(e){switch(e){case"vivaldi":return(0,Oe.Z)("user@vivaldi.net");case"google":return(0,Oe.Z)("user@gmail.com");case"fastmail":return(0,Oe.Z)("user@fastmail.com");case"icloud":return(0,Oe.Z)("user@icloud.com");default:return""}}function ED(e,t="vivaldi"){return{status:ID,statusText:"",name:(0,Oe.Z)("New Account"),url:"",account_type:t,username:"",password:"",step:"accountType",initial:e,requestPending:!1,calendars:[]}}var _D=yD("img",{src:"/resources/vivaldi_calendar_default.png",alt:"",width:"64",height:"64"}),MD=yD("span",{className:"info"},void 0,"App specific password is required to connect to iCloud calendars.");class ND extends hs.Component{static contextType=xi.Z;state=ED(!0,this.props.onboarding?"local":"vivaldi");account=null;changeType=e=>{const t="icloud"===e?(0,Lu.Hv)():"",n="icloud"===e?"icloud":wD(e);n!==this.state.account_type?this.setState({account_type:n,url:t,username:"",password:""}):this.setState({account_type:n})};handleChange=e=>{const{target:{name:t,value:n}}=e;this.setState({[t]:n})};toggleCalendarState=(e,t,n)=>{this.setState((s=>{const i=[...s.calendars];return i[t]={...i[t],[n]:e.target.checked},{calendars:i}}))};selectAccountType=()=>{"local"===this.state.account_type?this.createAccount():this.setState({step:"accountInfo"})};goBack=()=>{"accountInfo"===this.state.step?this.setState({step:"accountType",statusText:"",status:ID}):"accountSummary"===this.state.step&&(this.account=null,this.setState({step:"accountInfo",calendars:[]}))};addAnother=()=>{this.account=null,this.setState(ED(!1))};createAccount=async()=>{const{name:e,account_type:t,username:n}=this.state;let s;if(bD(wD(t)))s=await this.createCalDAVAccount();else if("ical"===t)s=await this.createWebCalendar();else if("local"===t)try{({account:s}=await CD({name:e,url:"",account_type:t,username:n},null)),this.setState({step:"done"})}catch(e){this.log((0,Oe.Z)("Error creating local calendar.")+String(e?.message||e),TD)}s&&(this.account=s)};log=(e,t,n)=>{const s=n?{username:n.username,name:n.name}:{};this.setState({...s,statusText:e,status:t})};createWebCalendar=async()=>{this.log((0,Oe.Z)("Verifying..."),kD),this.setState({requestPending:!0});const{name:e,account_type:t,username:n,password:s}=this.state;let{url:i}=this.state;i.startsWith("webcal")&&(i=SD(i),this.setState({url:i}));const o={id:"",name:e,url:i,account_type:wD(t),username:n,interval:Lu.jC},{foundService:a,statusMessage:r,eventCount:l,calendars:d}=await ic.Z.probeWebCalendar(o,s);return!a&&r?(this.log(r,TD),this.setState({requestPending:!1})):(this.log((0,Oe.Z)("Connected to Web Calendar, found $1 event(s).",[l]),AD),this.setState({step:"accountSummary",calendars:d,requestPending:!1})),o};createCalDAVAccount=async()=>{this.log((0,Oe.Z)("Verifying..."),kD),this.setState({requestPending:!0});const{name:e,url:t,account_type:n,username:s,password:i}=this.state;try{const{account:o,calendars:a}=await Iu.Z.getCalDAVAccountDetails({name:e,url:t,account_type:wD(n),username:s,password:i},this.log);if(this.state.status!==TD){for(const e of a)e.active=!0;this.account=o,this.setState({step:"accountSummary",calendars:a,requestPending:!1})}else this.setState({requestPending:!1})}catch(e){this.setState({requestPending:!1})}};saveAccount=async()=>{const e=this.account;if(e&&"local"!==e.account_type){"icloud"===e.account_type&&(e.account_type="caldav"),this.setState({requestPending:!0});try{await Iu.Z.saveCalendarAccount({account:e,calendars:this.state.calendars,password:this.state.password},this.log),this.setState({requestPending:!0,step:"done"})}catch(e){this.setState({requestPending:!1}),this.log(e.message,TD)}}};render(){const{name:e,url:t,account_type:n,username:s}=this.state,{password:i}=this.state,o=["vivaldi","fastmail","google","icloud","caldav","ical"];(!hD.Z.getLocalAccount()||this.props.onboarding&&this.state.initial)&&o.unshift("local");const a=this.state.status===TD?"error":this.state.status===AD?"success":"info";let r;if("accountInfo"===this.state.step)switch(this.state.account_type){case"vivaldi":r=(0,Oe.Z)("Vivaldi.net account, OK - now enter your login details below and let us fetch your calendars.");break;case"icloud":r=(0,Oe.Z)("Apple iCloud account, OK - now enter your username and app specific password below and let us fetch your calendars.");break;case"caldav":r=(0,Oe.Z)("CalDAV account, OK - now enter the server URL and your login details below and let us fetch your calendars.");break;case"google":r=(0,Oe.Z)("Google account, OK - now enter your username below and then log in using the google dialog shown.");break;case"ical":r=(0,Oe.Z)("Web calendar, OK - now enter the calendar URL below and let us fetch your events.")}return(0,fs.jsxs)(fs.Fragment,{children:["accountType"===this.state.step&&yD("form",{className:"detail",onSubmit:this.selectAccountType},void 0,yD("div",{className:"detail-content"},void 0,this.props.onboarding&&(0,fs.jsxs)(fs.Fragment,{children:[_D,this.state.initial&&(0,fs.jsxs)(fs.Fragment,{children:[yD("h1",{},void 0,(0,Oe.Z)("Welcome to Vivaldi Calendar")),yD("p",{},void 0,(0,Oe.Z)("Let’s get you going by adding your first account."))]}),!this.state.initial&&(0,fs.jsxs)(fs.Fragment,{children:[yD("h1",{},void 0,(0,Oe.Z)("Vivaldi Calendar")),yD("p",{},void 0,(0,Oe.Z)("Great, let’s add another account."))]})]}),!this.props.onboarding&&yD("p",{},void 0,(0,Oe.Z)("Select account type to add.")),yD("div",{className:"toolbar toolbar-pills toolbar-wrap"},void 0,o.map((e=>yD(Fa,{isPressed:e===this.state.account_type,title:this.props.searchableStrings[e],onClick:()=>this.changeType(e)},e))))),yD("div",{className:"detail-toolbar"},void 0,yD("input",{type:"submit",value:(0,Oe.Z)("Continue"),autoFocus:!0}))),"accountInfo"===this.state.step&&yD("form",{className:"detail",onSubmit:this.createAccount},void 0,yD("div",{className:"detail-content"},void 0,this.props.onboarding&&(0,fs.jsxs)(fs.Fragment,{children:[yD("h1",{},void 0,(0,Oe.Z)("Add Your First Calendar Account")),yD("p",{},void 0,r)]}),yD("div",{className:"setting-group unlimited"},void 0,yD("div",{className:"setting-group"},void 0,yD("div",{className:"setting-single"},void 0,yD(sc.Z,{type:"text",name:"name",onChange:this.handleChange,label:this.props.searchableStrings.Name,value:e,autoFocus:!0}))),["caldav","ical"].includes(n)&&yD("div",{className:"setting-group"},void 0,yD("div",{className:"setting-single"},void 0,yD(sc.Z,{type:"text",name:"url",onChange:this.handleChange,label:this.props.searchableStrings.URL,value:t})))),(bD(wD(n))||"ical"===n)&&yD("div",{className:"setting-group unlimited"},void 0,yD("div",{className:"setting-group"},void 0,yD("div",{className:"setting-single"},void 0,yD(sc.Z,{type:"text",name:"username",onChange:this.handleChange,label:this.props.searchableStrings.Username,value:s,placeholder:ZD(n)}))),["caldav","ical","icloud"].includes(n)&&yD("div",{className:"setting-group"},void 0,yD("div",{className:"setting-single"},void 0,yD(sc.Z,{type:"password",name:"password",onChange:this.handleChange,label:this.props.searchableStrings.Password,value:i})),"icloud"===n&&MD)),this.state.statusText&&yD("div",{className:"setting-group-double"},void 0,yD(tc,{type:a},void 0,this.state.statusText))),yD("div",{className:"detail-toolbar"},void 0,yD("input",{type:"submit",disabled:bD(wD(n))&&!s||this.state.requestPending,value:(0,Oe.Z)("Add Account")}),yD("input",{type:"button",disabled:this.state.requestPending,onClick:this.goBack,value:(0,Oe.Z)("navigation","Back")}))),"accountSummary"===this.state.step&&yD("form",{className:"detail",onSubmit:this.saveAccount},void 0,yD("div",{className:"detail-content"},void 0,this.state.calendars.length>0&&(0,fs.jsxs)(fs.Fragment,{children:[this.props.onboarding&&(0,fs.jsx)(fs.Fragment,{children:yD("h1",{},void 0,(0,Oe.Z)("Calendar Visibility and Syncing"))}),yD("p",{},void 0,(0,Oe.Z)("We found the following calendars:")),yD("table",{},void 0,yD("thead",{},void 0,yD("tr",{},void 0,yD("td",{},void 0,(0,Oe.Z)("Calendar")),yD("td",{},void 0,(0,Oe.Z)("Sync")),yD("td",{},void 0,(0,Oe.Z)("show","Hide")))),yD("tbody",{},void 0,this.state.calendars.map(((e,t)=>yD("tr",{},e.name||e.description||e.ctag,yD("td",{},void 0,e.description||e.name),yD("td",{},void 0,yD("input",{type:"checkbox",onChange:e=>this.toggleCalendarState(e,t,"active"),checked:e.active})),yD("td",{},void 0,yD("input",{type:"checkbox",onChange:e=>this.toggleCalendarState(e,t,"hidden"),checked:e.hidden})))))))]}),0===this.state.calendars.length&&yD("p",{},void 0,(0,Oe.Z)("No calendars found. Check that your credentials are correct and your calendar service has calendars configured.")),this.state.statusText&&this.state.status===TD&&yD("div",{className:"setting-group-double"},void 0,yD(tc,{type:a},void 0,this.state.statusText))),yD("div",{className:"detail-toolbar"},void 0,yD("input",{type:"submit",disabled:this.state.requestPending,value:(0,Oe.Z)("Save Account")}),yD("input",{type:"button",disabled:this.state.requestPending,onClick:this.goBack,value:(0,Oe.Z)("navigation","Back")}))),"done"===this.state.step&&yD("form",{className:"detail",onSubmit:this.props.showTips},void 0,yD("div",{className:"detail-content"},void 0,this.props.onboarding&&(0,fs.jsx)(fs.Fragment,{children:yD("span",{className:"ShowMailTipsAndTricks-allSetIcon",dangerouslySetInnerHTML:{__html:Ts.mXV}})}),yD("h1",{},void 0,(0,Oe.Z)("Great, You’re All Set!")),"local"===this.account?.account_type&&yD("p",{},void 0,(0,Oe.Z)("If you want to add more local calendars use the calendar list in settings.")),this.props.onboarding&&yD("p",{},void 0,(0,Oe.Z)("Where to next?"))),yD("div",{className:"detail-toolbar"},void 0,yD("input",{type:"submit",value:(0,Oe.Z)("Show Tips and Tricks")}),yD("input",{type:"button",onClick:this.addAnother,value:(0,Oe.Z)("Add Another Account")}),this.props.onboarding&&yD("input",{type:"button",value:(0,Oe.Z)("Open Vivaldi Calendar"),onClick:()=>{Ae.Z.showCalendar(this.context.vivaldiWindowId),this.props.done?.()}}),!this.props.onboarding&&yD("input",{type:"button",value:(0,Oe.Z)("calendar","Done"),onClick:()=>{this.props.done?.()}})))]})}}const PD=ND;var DD,xD=n(76632);function OD(e,t,n,s){DD||(DD="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:DD,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class LD extends hs.PureComponent{faviconStyle=this.props.isCreating?{opacity:.3}:{};render(){let e=this.props.iconPath;return"gmail.com"===e?e="https://ssl.gstatic.com/ui/v1/icons/mail/images/favicon5.ico":"googleusercontent.com"===e?e="https://google.com/favicon.ico":"fastmail.com"===e?e="https://www.fastmail.com/wp-content/uploads/2023/01/cropped-FM-Icon-WhiteBG-600@2x-32x32.png":e&&(e=ws(e)),(0,fs.jsxs)(fs.Fragment,{children:[OD(Ss,{size:32,className:"item-icon",url:e?(0,vs.q9)(e):this.props.iconFallbackPath,fallbackUrl:this.props.iconFallbackPath,loadType:"faviconSkipCache",style:this.faviconStyle}),OD("div",{className:"item-title"},void 0,this.props.title),OD("div",{className:"item-meta"},void 0,this.props.meta)]})}}const RD=LD;var BD;function FD(e,t,n,s){BD||(BD="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:BD,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const VD=["editor","density","help"];function WD(e){const[t,s]=hs.useState(H.Z.get($.kCalendarEditMode));return(0,fs.jsxs)(fs.Fragment,{children:[e.onboarding&&FD("h3",{},void 0,(0,Oe.Z)("Calendar Settings")),FD("h1",{},void 0,(0,Oe.Z)("Adding Events")),FD("p",{},void 0,(0,Oe.Z)("We’re all about choice. By default, we add and edit events inline, right inside the calendar without any popups.")),FD("div",{className:"ShowCalendarTipsAndTricks-Selectbox"},void 0,FD("button",{className:As()("selectbox",{"selectbox-selected":"inline"===t}),onClick:function(){s("inline"),Ne.Z.set($.kCalendarEditMode,"inline")},type:"button"},void 0,FD("div",{className:"selectbox-image"},void 0,FD("span",{className:"onboarding-iillustration",dangerouslySetInnerHTML:{__html:n(36502)}}),FD("div",{dangerouslySetInnerHTML:{__html:Ts.D7r.medium}})),FD("div",{className:"selectbox-title"},void 0,(0,Oe.Z)("Inline Editor"))),FD("button",{className:As()("selectbox",{"selectbox-selected":"popup"===t}),onClick:function(){s("popup"),Ne.Z.set($.kCalendarEditMode,"popup")},type:"button"},void 0,FD("div",{className:"selectbox-image"},void 0,FD("span",{className:"onboarding-iillustration",dangerouslySetInnerHTML:{__html:n(46647)}}),FD("div",{dangerouslySetInnerHTML:{__html:Ts.D7r.medium}})),FD("div",{className:"selectbox-title"},void 0,(0,Oe.Z)("Dialog Editor"))))]})}function UD(e){const[t,s]=hs.useState(H.Z.get($.kCalendarDisplayDensity));return(0,fs.jsxs)(fs.Fragment,{children:[e.onboarding&&FD("h3",{},void 0,(0,Oe.Z)("Calendar Settings")),FD("h1",{},void 0,(0,Oe.Z)("Calendar Density")),FD("p",{},void 0,(0,Oe.Z)("We can show you all the details from an event right in the calendar, or just the title. It’s up to you.")),FD("div",{className:"ShowCalendarTipsAndTricks-Selectbox"},void 0,FD("button",{className:As()("selectbox",{"selectbox-selected":"full"===t}),onClick:function(){s("full"),Ne.Z.set($.kCalendarDisplayDensity,"full")},type:"button"},void 0,FD("div",{className:"selectbox-image"},void 0,FD("span",{className:"onboarding-iillustration",dangerouslySetInnerHTML:{__html:n(87922)}}),FD("div",{dangerouslySetInnerHTML:{__html:Ts.D7r.medium}})),FD("div",{className:"selectbox-title"},void 0,(0,Oe.Z)("Full Details"))),FD("button",{className:As()("selectbox",{"selectbox-selected":"minimal"===t}),onClick:function(){s("minimal"),Ne.Z.set($.kCalendarDisplayDensity,"minimal")},type:"button"},void 0,FD("div",{className:"selectbox-image"},void 0,FD("span",{className:"onboarding-iillustration",dangerouslySetInnerHTML:{__html:n(18767)}}),FD("div",{dangerouslySetInnerHTML:{__html:Ts.D7r.medium}})),FD("div",{className:"selectbox-title"},void 0,(0,Oe.Z)("Title Only"))))]})}function HD(e){return(0,fs.jsxs)(fs.Fragment,{children:[e.onboarding&&FD("h3",{},void 0,(0,Oe.Z)("Calendar Help")),FD("h1",{},void 0,(0,Oe.Z)("Get All the Help You Need")),FD("div",{className:"ShowCalendarTipsAndTricks-WithImage"},void 0,FD("span",{className:"onboarding-iillustration",dangerouslySetInnerHTML:{__html:Ts.Kuf}}),FD("div",{className:"ShowCalendarTipsAndTricks-TextBlock"},void 0,FD("p",{},void 0,(0,Oe.Z)("Want more tips and tricks? Our Help pages contain all the documentation you need.")),FD("p",{},void 0,FD("a",{onClick:()=>d.ZP.openURL(e.windowId,"https://help.vivaldi.com/calendar/")},void 0,(0,Oe.Z)("Visit our Help pages for Calendar.")))))]})}function zD(e){const[t,n]=hs.useState(VD[0]);const s=t===VD[VD.length-1];return FD("div",{className:"ShowCalendarTipsAndTricks"},void 0,FD("form",{className:"detail",onSubmit:function(){n(VD[VD.indexOf(t)+1])}},void 0,FD("div",{className:"detail-content"},void 0,"editor"===t&&FD(WD,{windowId:e.windowId,onboarding:e.onboarding}),"density"===t&&FD(UD,{windowId:e.windowId,onboarding:e.onboarding}),"help"===t&&FD(HD,{windowId:e.windowId,onboarding:e.onboarding})),FD("div",{className:"detail-toolbar"},void 0,!s&&FD("input",{type:"submit",value:(0,Oe.Z)("Next tip")}),FD("input",{type:s?"submit":"button",value:(0,Oe.Z)("Open Vivaldi Calendar"),onClick:()=>{Ae.Z.showCalendar(e.windowId),e?.onClose?.()}}),e.onClose&&FD("input",{type:"button",value:(0,Oe.Z)("calendar","Done"),onClick:()=>{e?.onClose?.()}}))))}var GD,$D=n(25765);function KD(e,t,n,s){GD||(GD="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:GD,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const{isOAuthProvider:jD,ensureAccountType:YD}=Rd.Z,XD="/resources/vivaldi_calendar_default.png",QD=n(28888),qD={"Add your First Calendar Account":(0,Oe.Z)("Add your First Calendar Account"),"Press the “Add” button to the left to add a new Account.":(0,Oe.Z)("Press the “Add” button to the left to add a new Account.")},JD={...$D.d,icloud:"Apple iCloud","Calendar Type":(0,Oe.Z)("Calendar Type"),Name:(0,Oe.Z)("calendar","Name"),URL:(0,Oe.Z)("Address"),Password:(0,Oe.Z)("Password"),Username:(0,Oe.Z)("Username"),Timezone:(0,Oe.Z)("Timezone"),Description:(0,Oe.Z)("Description")};class ex extends hs.Component{static contextType=xi.Z;state={deletingAccount:"",isCreating:!1,setupStep:"setup"};#H=!1;onCreateItem=()=>{this.#H=!0,this.setState({isCreating:!0,setupStep:"setup"})};onCancelCreateItem=()=>{"setup"===this.state.setupStep?this.setState({isCreating:!1}):this.setState({isCreating:!1,setupStep:"setup"})};showTips=()=>{this.setState({setupStep:"tips"})};done=()=>{this.setState({setupStep:"setup"})};saveAccount=e=>{m.Z.updateAccount(e)};getFallbackIcon=e=>"caldav"===e?"/resources/calendar_caldav.png":"ical"===e?"/resources/calendar_web.png":XD;renderListItem=(e,t)=>{const n=YD(t.account_type);let s="";if(jD(n)){s=((0,ms.Z)(t.url)?.hostname||"").split(".").slice(-2).join(".")}return KD(RD,{title:t.name,meta:$D.d[n],iconPath:s,iconFallbackPath:this.getFallbackIcon(n)})};renderCreateListItem=()=>KD(RD,{title:(0,Oe.Z)("New Account"),meta:(0,Oe.Z)("Setup in progress..."),iconFallbackPath:XD,isCreating:!0});renderContent=(e,t)=>{const n=this.props.accounts[e],s=nt()(Object.values(n).reduce(((e,t)=>e+t)));return(0,fs.jsxs)(fs.Fragment,{children:["setup"===this.state.setupStep&&KD(dD,{filter:this.props.filter,searchableStrings:t,account:n,saveAccount:this.saveAccount},s),"tips"===this.state.setupStep&&KD(zD,{windowId:this.context.vivaldiWindowId,onClose:this.done,onboarding:!1})]})};remapAccounts=()=>this.props.accounts.map((e=>({...e,key:e.id})));renderCreate=e=>KD(PD,{done:this.onCancelCreateItem,filter:this.props.filter,searchableStrings:e});renderEmpty=e=>KD("div",{className:"detail"},void 0,KD("div",{className:"detail-content"},void 0,KD("h3",{},void 0,qD["Add your First Calendar Account"]),KD("p",{},void 0,qD["Press the “Add” button to the left to add a new Account."])));deleteAccountDialog=e=>(0,fs.jsx)(mD,{...e});render(){return KD(xD.Z,{title:(0,Oe.Z)("Calendar Accounts"),subtitle:(0,Oe.Z)("Add accounts such as Google, Outlook, Vivaldi.net, etc., to access your online calendars."),className:"account-settings",deleteDialog:this.deleteAccountDialog,addTipString:(0,Oe.Z)("Add Account"),deleteTipString:(0,Oe.Z)("tooltip","Remove Account"),emptyListGraphic:QD,emptyListString:(0,Oe.Z)("No accounts added"),filter:this.props.filter,items:this.remapAccounts(),masterLayout:0,renderListItem:this.renderListItem,renderCreateListItem:this.renderCreateListItem,renderContent:this.renderContent,isCreating:this.state.isCreating,onCreateItem:this.onCreateItem,onCancelCreateItem:this.onCancelCreateItem,renderCreate:this.renderCreate,renderEmpty:this.renderEmpty,contentStrings:JD,emptyStrings:qD,createStrings:JD,onRemove:Aa.Z})}}const tx=vD(ex),nx=hs.createContext({pageId:NaN,displayDensity:"full",isPanel:!1,handler:{selectDate:Aa.Z,selectEvent:Aa.Z,editEvent:Aa.Z,saveEventEdit:Aa.Z,updateEventEdit:Aa.Z,endEventEdit:Aa.Z,cancelEventEdit:Aa.Z}});var sx;function ix(e,t,n,s){sx||(sx="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:sx,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const ox=function(e){const{event:t,updateEvent:n}=e,{start:s,end:i,allDay:o=!1}=t,a=hs.useRef(""),r=function(e,t,n){let s=t-e;return s<0&&(s+=Lu.hd),{days:Math.floor(s/Lu.hd)+(n?1:0),hours:n?0:Math.floor(s%Lu.hd/Lu.QI),minutes:n?0:Math.floor(s%Lu.QI/Lu.lb)}}(s,i,o);function l(){const{days:t,hours:s,minutes:i}=r;e.event.end=o?e.event.start+(t||0)*Lu.hd:e.event.start+(t||0)*Lu.hd+(s||0)*Lu.QI+(i||0)*Lu.lb,n(e.event)}function d(e){const{name:t,value:n}=e.currentTarget,s=Math.max(parseInt(n),0);switch(t){case"days":r.days=s;break;case"hours":r.hours=s;break;case"minutes":r.minutes=s}a.current=isNaN(s)?t:"",l()}function c(e){const{name:t}=e.currentTarget;e.currentTarget.value||(r[t]=0,a.current="",l())}const{days:h,hours:p,minutes:u}=r;return ix("div",{className:"edit-group"},void 0,ix("label",{},void 0,ix("input",{type:"number",name:"days",min:"0",value:"days"===a.current?"":h,onBlur:c,onChange:d}),ix("span",{},void 0,(0,Oe.Z)("Days"))),!o&&(0,fs.jsxs)(fs.Fragment,{children:[ix("label",{},void 0,ix("input",{type:"number",name:"hours",min:"0",value:"hours"===a.current?"":p,onBlur:c,onChange:d}),ix("span",{},void 0,(0,Oe.Z)("Hours"))),ix("label",{},void 0,ix("input",{type:"number",name:"minutes",min:"0",value:"minutes"===a.current?"":u,onBlur:c,onChange:d}),ix("span",{},void 0,(0,Oe.Z)("Minutes")))]}))};var ax;function rx(e,t,n,s){ax||(ax="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:ax,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const lx=60,dx=1440,cx=10080;function hx(e,t){if(0===e)return t?(0,Oe.Z)("Same day"):(0,Oe.Z)("At event time");if(e%cx==0){const t=e/cx;return(0,Oe.Z)("$1 week before","$1 weeks before",[t])}if(e%dx==0){const t=e/dx;return(0,Oe.Z)("$1 day before","$1 days before",[t])}if(e%lx==0){const t=e/lx;return(0,Oe.Z)("$1 hour before","$1 hours before",[t])}return(0,Oe.Z)("$1 minute before","$1 minutes before",[e])}const px=[[NaN,(0,Oe.Z)("No reminder")],[0,(0,Oe.Z)("At event time")],[5,hx(5,!1)],[10,hx(10,!1)],[15,hx(15,!1)],[30,hx(30,!1)],[45,hx(45,!1)],[60,hx(60,!1)],[120,hx(120,!1)],[240,hx(240,!1)],[360,hx(360,!1)],[480,hx(480,!1)],[720,hx(720,!1)],[1440,hx(1440,!1)],[2880,hx(2880,!1)],[4320,hx(4320,!1)],[5760,hx(5760,!1)],[7200,hx(7200,!1)],[8640,hx(8640,!1)],[10080,hx(10080,!1)],[20160,hx(20160,!1)],[30240,hx(30240,!1)],[40320,hx(40320,!1)]],ux=[[NaN,(0,Oe.Z)("No reminder")],[0,(0,Oe.Z)("Same day")],[1440,(0,Oe.Z)("$1 day before","$1 days before",[1])],[2880,(0,Oe.Z)("$1 day before","$1 days before",[2])],[4320,(0,Oe.Z)("$1 day before","$1 days before",[3])],[5760,(0,Oe.Z)("$1 day before","$1 days before",[4])],[7200,(0,Oe.Z)("$1 day before","$1 days before",[5])],[8640,(0,Oe.Z)("$1 day before","$1 days before",[6])],[10080,(0,Oe.Z)("$1 week before","$1 weeks before",[1])],[20160,(0,Oe.Z)("$1 week before","$1 weeks before",[2])],[30240,(0,Oe.Z)("$1 week before","$1 weeks before",[3])],[40320,(0,Oe.Z)("$1 week before","$1 weeks before",[4])]],gx=6e4;function mx(e){const t=vx(e);return`${Math.floor(t/lx%24).toString().padStart(2,"0")}:${(t%lx).toString().padStart(2,"0")}`}function vx(e){return e<0?Math.abs(e)%dx:(dx-e%dx)%dx}const fx=function(e){const t=hs.useRef(null),n=e.value/gx;function s(t){let s=parseInt(t.target.value);e.allDay&&(s-=vx(n)),e.onChange(s*gx)}const i=e.allDay?[...ux]:[...px],o=e.allDay?Math.ceil(n/dx)*dx:n;return i.find((([e])=>e===o))||(i.push([o,hx(o,e.allDay??!1)]),i.sort((([e],[t])=>e-t))),(0,fs.jsxs)(fs.Fragment,{children:[e.create&&(0,fs.jsx)("select",{ref:t,className:e.className,tabIndex:e.tabIndex,onChange:s,value:"NaN",disabled:0===i.length,children:i.map((([e,t])=>rx("option",{value:e.toString()},e,t)))}),!e.create&&(0,fs.jsxs)(fs.Fragment,{children:[(0,fs.jsx)("select",{ref:t,className:e.className,tabIndex:e.tabIndex,onChange:s,value:o,disabled:0===i.length,children:i.map((([e,t])=>rx("option",{value:e.toString()},e,t)))}),e.allDay&&(0,fs.jsxs)(fs.Fragment,{children:[rx("span",{style:{flex:"0 0 auto"}},void 0,(0,Oe.Z)("at")),rx(_g,{onChange:function(n){const s=Date.parse(`1970-01-01T${n.target.value}Z`)/gx,i=(parseInt(t.current?.value)||0)-s;e.onChange(i*gx)},value:mx(n),step:"5",autoFocusNextElement:!1})]})]})]})};var yx;function Cx(e,t,n,s){yx||(yx="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:yx,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function wx(e){"Enter"===HT.Z[e.keyCode]&&e.stopPropagation()}const bx=function(e){const t=hs.useContext(xi.Z),{document:n}=t,[s,i]=hs.useState(!1);if(hs.useEffect((()=>{if(s){const e=n.querySelectorAll(".cal-event-alarm-time");e.length&&e[e.length-1].focus(),i(!1)}}),[s,n]),e.event.task&&!e.event.end)return(0,fs.jsxs)(fs.Fragment,{children:[e.label&&Cx("h2",{},void 0,e.label),Cx("p",{className:"info"},void 0,(0,Oe.Z)("Can not set reminder for task without due time."))]});if(e.event.task&&!e.event.end)return(0,fs.jsxs)(fs.Fragment,{children:[e.label&&Cx("h2",{},void 0,e.label),Cx("p",{className:"info"},void 0,(0,Oe.Z)("Can not set reminder for task without due time."))]});const o=t=>{const n=function(e,t){let n=t;e.allDay&&t%Lu.hd==0&&(n-=vx(H.Z.get($.kCalendarDefaultAlldayNotificationTime)||900)*Lu.lb);return{id:"",event_id:e.id,name:e.title,when:n}}(l,t??0),s=[...l.notifications||[],n];i(!0),e.updateEvent({...e.event,notifications:s})},a=()=>{o(function(e){if(e)return(H.Z.get($.kCalendarDefaultAlldayNotificationTime)||900)*Lu.lb;{const e=H.Z.get($.kCalendarDefaultNotification);return-1===e?0:e*Lu.lb}}(l.allDay??!1))},r=s=>{const i=[...e.event.notifications??[]];if(!i.length)return;const{HTMLElement:o}=t,a=n.activeElement instanceof o&&n.activeElement.closest(".calendar-event");if(a){const e=il(a);e.forEach(((t,s)=>{t===n.activeElement&&e[s-1]?.focus()}))}const r=i.indexOf(s);-1!==r&&(i.splice(r,1),e.updateEvent({...e.event,notifications:i}))},{event:l}=e;return(0,fs.jsxs)(fs.Fragment,{children:[e.label&&Cx("h2",{},void 0,e.label),!!l.notifications?.length&&l.notifications.map(((t,n)=>Cx("div",{className:"edit-group"},t.id||n,Cx("label",{},void 0,Cx(fx,{allDay:l.allDay??!1,create:!1,value:t.when,onChange:n=>((t,n)=>{const s=[...e.event.notifications??[]];if(!s.length)return;const i=s.findIndex((e=>e===t));if(-1!==i){if(-1===n||isNaN(n))return void r(t);s[i]={...s[i],when:n},e.updateEvent({...e.event,notifications:s})}})(t,n),tabIndex:e.tabIndex,className:"cal-event-alarm-time"}),!e.readOnly&&(0,fs.jsxs)(fs.Fragment,{children:[Cx("button",{className:"circular",onClick:r.bind(null,t),onKeyDown:wx,tabIndex:e.tabIndex,type:"button",title:(0,Oe.Z)("Remove alarm"),dangerouslySetInnerHTML:{__html:Ts.M2k.small}}),Cx("button",{className:"circular",onClick:a,onKeyDown:wx,tabIndex:e.tabIndex,type:"button",title:(0,Oe.Z)("Add another alarm"),dangerouslySetInnerHTML:{__html:Ts.md4.small}})]}))))),!l.notifications?.length&&Cx("div",{className:"edit-group"},void 0,Cx("label",{},void 0,Cx(fx,{allDay:l.allDay??!1,create:!0,value:0,onChange:o,tabIndex:e.tabIndex,className:"cal-event-alarm-time"})))]})};var Sx;function Ix(e,t,n,s){Sx||(Sx="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Sx,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const kx={ACCEPTED:{icon:Ts.wHY,text:(0,Oe.Z)("Has accepted the invite")},DECLINED:{icon:Ts.dHk,text:(0,Oe.Z)("Has declined the invite")},TENTATIVE:{icon:Ts.owS,text:(0,Oe.Z)("Has tentatively accepted the invite")},"NEEDS-ACTION":{icon:Ts.DvK,text:(0,Oe.Z)("Has not replied to the invite")},DELEGATED:{icon:Ts.upG.large,text:(0,Oe.Z)("Has delegated invite to another person")}};function Ax(e){const{requestAnimationFrame:t}=hs.useContext(xi.Z);return(0,fs.jsx)("p",{className:As()("Participants-Dropdown-Item",{"Participants-Dropdown-Item--Selected":e.selected}),onClick:e.onClick,ref:n=>{e.selected&&n&&t((()=>{n.scrollIntoViewIfNeeded()}))},children:e.contact.name?Ix(hs.Fragment,{},void 0,Ix("span",{className:"Participants-Dropdown-Item-Primary"},void 0,e.contact.name),Ix("span",{className:"Participants-Dropdown-Item-Secondary"},void 0,"<"+e.contact.address+">")):Ix("span",{className:"Participants-Dropdown-Item-Primary"},void 0,e.contact.address)})}const Tx={value:"",items:[],selectedIndex:0},Zx=hs.forwardRef((function(e,t){const n=hs.useContext(xi.Z),s=hs.useMemo((()=>t??hs.createRef()),[t]),[i,o]=hs.useState(Tx);return Ix("div",{className:"Participants-Input edit-group"},void 0,(0,fs.jsx)("input",{ref:s,type:"text",tabIndex:e.tabIndex,placeholder:e.placeholder,value:i.value,onChange:function(t){const{value:n}=t.target,s=n?jA(n,e.contacts):[];o({value:n,items:s,selectedIndex:0})},onKeyDown:function(t){const{value:n}=t.target;switch(HT.Z[t.keyCode]){case"Up":o((e=>({...e,selectedIndex:Math.max(0,e.selectedIndex-1)}))),(0,to.ZP)(t);break;case"Down":o((e=>({...e,selectedIndex:Math.min(e.items.length-1,e.selectedIndex+1)}))),(0,to.ZP)(t);break;case"Enter":const s=i.items[i.selectedIndex];if(s)e.onItemSelected(s);else if(n){(0,ft.D$)(n).forEach(e.onItemSelected)}o(Tx),(0,to.ZP)(t);break;case"Escape":i.value&&(o(Tx),(0,to.ZP)(t))}}}),i.items.length>0&&s?.current instanceof n.HTMLElement&&Ix(ya,{popupClassName:"Participants-Dropdown",buttonRef:s.current,hidePopup:()=>o(Tx),isResizable:!1,popupPosition:"below",width:350,forceFocus:!1,anchorPosition:"left"},void 0,i.items.map(((t,n)=>Ix(Ax,{contact:t,selected:n===i.selectedIndex,onClick:t=>function(t,n){e.onItemSelected(i.items[n]),o(Tx),(0,to.ZP)(t)}(t,n)},t.address)))))}));class Ex extends hs.Component{static contextType=xi.Z;contacts=new Map;showNoMailWarning=!1;constructor(e){super(e),this.contacts=this.getRemainingContacts(Hc.Z.getMailAddresses())}stopEnterEvent=e=>{e.keyCode===oa.Z.KEY_RETURN&&e.stopPropagation()};contactSelected=e=>{const{event:t}=this.props,n={id:"",event_id:t.id,name:e.name,address:e.address,sent:!1},s=t.invites?[n,...t.invites]:[n];this.props.updateEvent({...t,invites:s}),this.contacts=this.getRemainingContacts(this.contacts),this.forceUpdate()};getRemainingContacts(e){const{event:t}=this.props;if(!t.invites||0===t.invites.length)return e;const n=new Set(t.invites.map((e=>e.address)));return new Map([...e.entries()].filter((([e,t])=>!n.has(e))))}removeInvite=(e,t)=>{const{event:n}=this.props;if(!n.invites||0===n.invites.length)return;const s=[...n.invites],i=s.findIndex((t=>t.address===e));if(-1===i)return;s.splice(i,1);const{HTMLElement:o}=this.context,a=t.target.closest(".calendar-event");if(a instanceof o){const e=il(a);e.forEach(((n,s)=>{n===t.target&&e[s-1]&&e[s-1].focus()}))}this.props.updateEvent({...n,invites:s}),this.contacts=this.getRemainingContacts(Hc.Z.getMailAddresses()),this.forceUpdate()};render(){const{event:e}=this.props,t=(e.invites||[]).filter((t=>t.address!==e.organizer));return e.task?Ix("div",{className:"Participants"},void 0,Ix("p",{className:"info"},void 0,(0,Oe.Z)("Participants not supported for Tasks"))):Ix("div",{className:"Participants"},void 0,!this.props.readOnly&&(0,fs.jsx)(Zx,{contacts:this.contacts,onItemSelected:this.contactSelected,tabIndex:this.props.tabIndex,placeholder:this.props.label,ref:this.props.focusRef}),this.props.readOnly&&!e.invites?.length&&Ix("span",{},void 0,(0,Oe.Z)("No participants")),!!e.invites?.length&&Ix("div",{className:"Participants-List"},void 0,e.organizer&&Ix("div",{className:"Participant",title:(0,Oe.Z)("Event Organizer")},e.organizer,Ix("span",{className:"Participant-Status",dangerouslySetInnerHTML:{__html:Ts.LaO.small}}),Ix("span",{className:"Participant-Address"},void 0,e.organizer),!this.props.readOnly&&Ix("input",{onClick:this.removeInvite.bind(this,e.organizer||""),onKeyDown:this.stopEnterEvent,tabIndex:this.props.tabIndex,type:"button",value:(0,Oe.Z)("verb","Remove")})),t.map(((e,t)=>{const n=e.partstat||"NEEDS-ACTION",s=kx[n]?kx[n]:kx["NEEDS-ACTION"];return Ix("div",{className:"Participant",title:this.props.readOnly?"":s.text},e.address,!this.props.readOnly&&Ix("span",{className:"Participant-Status",dangerouslySetInnerHTML:{__html:s.icon}}),Ix("span",{className:"Participant-Address"},void 0,e.address),!this.props.readOnly&&Ix("input",{onClick:this.removeInvite.bind(this,e.address),onKeyDown:this.stopEnterEvent,tabIndex:this.props.tabIndex,type:"button",value:(0,Oe.Z)("verb","Remove")}))}))),!H.Z.get($.kCalendarMailAccount)&&Ix("p",{className:"info"},void 0,(0,Oe.Z)("In order to send invitations you will need to select a mail account in calendar settings.")))}}const _x=Ex;var Mx;function Nx(e,t,n,s){Mx||(Mx="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Mx,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Px=function(e){const{event:t,updateEvent:n}=e,s=hs.useRef(null),i=hs.useCallback((()=>{const i=s.current;"start"===e.type?t.start=i&&i<=t.end?i:t.end-H.Z.get($.kCalendarDefaultDuration):t.end=i||(0,Bu.zX)(Date.now()),n(t)}),[t,n,e.type]),o=hs.useCallback((()=>{"start"===e.type?(s.current=t.start,t.start=0):(s.current=t.end,t.start=0,t.end=0),n(t)}),[t,n,e.type]),a=(0,Bu.Yu)(t),r="start"===e.type,l="dialog"===e.view,d=!l,c=r?(0,Oe.Z)("Start Time"):(0,Oe.Z)("Due Time"),h=r?(0,Oe.Z)("Task Start Date"):(0,Oe.Z)("Task Due Date"),p=r?(0,Oe.Z)("Task Start Time"):(0,Oe.Z)("Task Due Time"),u=r?(0,Oe.Z)("Clear Start Time"):(0,Oe.Z)("Clear Due Time"),g=r?t.start:t.end,m=Nx("button",{className:"circular",onClick:o,tabIndex:e.tabIndex,type:"button",title:u,dangerouslySetInnerHTML:{__html:Ts.YVA.small}}),v=!e.timeOnly&&Nx(WT,{className:"cal-event-date-picker",onChange:e.onDateChange,tabIndex:e.tabIndex,title:h,value:GT().tz(g,a).format("YYYY-MM-DD"),autoFocus:!0}),f=!t.allDay&&Nx(_g,{className:"cal-event-time-picker",disabled:t.allDay,onChange:e.onTimeChange,tabIndex:e.tabIndex,step:"5",title:p,value:t.allDay?"00:00":GT().tz(g,a).format("HH:mm")});return(0,fs.jsxs)(fs.Fragment,{children:[!g&&Nx("button",{className:"TaskTime FormButton FormButton--WithIcon",onClick:i,dangerouslySetInnerHTML:{__html:`${Ts.hcy.small} ${c}`},tabIndex:e.tabIndex,autoFocus:!0,disabled:r&&!t.end}),!!g&&(0,fs.jsxs)(fs.Fragment,{children:[r&&l&&m,!r&&l&&f,v,(r||d)&&f,!(r&&l)&&m]})]})};var Dx,xx=n(68172);function Ox(e,t,n,s){Dx||(Dx="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Dx,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var Lx=Ox("option",{disabled:!0},void 0,"––––––––––––––––––––––"),Rx=Ox("option",{disabled:!0},void 0,"––––––––––––––––––––––");function Bx(e){const t=(0,hs.useContext)(xi.Z),n=(0,hs.useRef)("label");const s=Bd.Z.getTemplates();return Ox("select",{name:"template",onChange:function(s){const i=s.currentTarget.value;"create"===i?function(){const n={templateId:"",name:e.event.title,event:e.event,properties:Lu.rA};Ae.Z.showEditEventTemplate(t.vivaldiWindowId,n)}():((0,xx.tE)(i,e.event).then(e.updateEvent),n.current=i)},tabIndex:e.tabIndex,value:n.current},void 0,Ox("option",{value:"label"},void 0,(0,Oe.Z)("Templates")),Lx,s.map((e=>Ox("option",{value:e.id},e.id,e.name))),!!s.length&&Rx,Ox("option",{value:"create"},void 0,(0,Oe.Z)("Create Event Template")))}class Fx extends hs.Component{static contextType=xi.Z;constructor(e){super(e)}shouldComponentUpdate=()=>{const{document:e}=this.context;return!(this.element&&this.element===e.activeElement)};setRef=e=>{this.element=e,e&&this.props.setElementRef&&this.props.setElementRef(e)};updateContent=e=>{if(this.element){const e=this.element.textContent;this.props.updateContent(e||"")}};render(){const e=(this.props.className||"")+" editable",t=(0,Oi.Z)(this.props,["className","content","updateContent","formatter","setElementRef"]);return(0,fs.jsx)("p",{...t,className:e,contentEditable:"plaintext-only",onBlur:this.updateContent,onInput:this.updateContent,ref:this.setRef,suppressContentEditableWarning:!0,"data-placeholder":this.props.placeholder?this.props.placeholder:"",children:this.props.formatter(this.props.content)})}}const Vx=Fx;var Wx;function Ux(e,t,n,s){Wx||(Wx="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Wx,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Hx extends hs.PureComponent{updateText=e=>{const{event:t,field:n}=this.props;(e&&e!==t[n]||!e&&t[n])&&this.props.updateEvent({...t,[n]:e})};onKeyDown=e=>{if("Enter"===HT.Z[e.keyCode]&&!e.shiftKey){const{saveEventEdit:t}=this.props;t&&(t(),(0,to.ZP)(e))}};render(){return this.props.readOnly?Ux("p",{className:`field cal-event-${this.props.field}`},void 0,this.props.event[this.props.field]):Ux(Vx,{setElementRef:e=>{this.props.focusRef&&e&&(this.props.focusRef.current=e)},tabIndex:this.props.tabIndex,title:this.props.label,placeholder:this.props.label,className:`field cal-event-${this.props.field}`,content:this.props.event[this.props.field],formatter:e=>e,updateContent:this.updateText,onKeyDown:this.onKeyDown})}}const zx=Hx;var Gx=n(12442);const $x=e=>{const{pageId:t,handler:n}=hs.useContext(nx),s=hs.useContext(xi.Z).vivaldiWindowId,i=hs.useCallback((()=>{m.Z.trashEvent(e.id)}),[e]),o=hs.useCallback((()=>{const t={templateId:"",name:e.title,event:e,properties:Lu.rA};Ae.Z.showEditEventTemplate(s,t)}),[e,s]),a=hs.useCallback((n=>{Gx.Z.selectEvent(t,{event:e}),n?yi.Z.cut(s):yi.Z.copy(s)}),[e,t,s]),r=hs.useCallback((()=>[{handler:()=>n.editEvent(e),...(0,xs.Z)("verb","Edit")},{type:"separator",label:"",labelEnglish:""},{handler:()=>a(!0),...(0,xs.Z)("verb","Cut")},{handler:()=>a(!1),...(0,xs.Z)("verb","Copy")},{handler:()=>i(),...(0,xs.Z)("verb","Delete")},{handler:()=>o(),...(0,xs.Z)("Create Event Template")}]),[i,a,n,e,o]);return{trashEvent:i,getContextMenu:r}};var Kx;function jx(e,t,n,s){Kx||(Kx="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Kx,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Yx=[jx("option",{value:Lu.ad},"current",(0,Oe.Z)("Current ($1)",[(0,Bu.EP)()])),jx("option",{value:Lu.$T},"floating",(0,Oe.Z)("Always in Local Time")),jx("option",{value:"UTC"},"UTC","UTC")].concat(GT().tz.names().filter((e=>-1!==e.indexOf("/"))).map((e=>jx("option",{value:e},e,e))));function Xx(){return Yx[0]=jx("option",{value:Lu.ad},"current",(0,Oe.Z)("Current ($1)",[(0,Bu.EP)()])),Yx}function Qx(e,t,n){const s=(0,Bu.Yu)(e),i=GT().tz(e[t],s).format("YYYY-MM-DD");return Jx(t,e,GT().tz(`${i} ${n}`,s).valueOf())}function qx(e,t,n){const s=(0,Bu.Yu)(e),i=GT().tz(e[t],s).format("HH:mm"),o=GT().tz(`${n} ${i}`,s);return e.allDay&&!e.task&&"end"===t&&o.add(1,"day"),Jx(t,e,o.valueOf())}function Jx(e,t,n){if(!isNaN(n)){const s=H.Z.get($.kCalendarAutoAdjustEnd);if("start"===e&&("always"===s||"timed_only"===s&&!t.allDay)){const e=t.end-t.start;t.start=n,t.end=n+e}else t[e]=n}return t}class eO extends hs.Component{createTimeHandler=e=>t=>{const{value:n}=t.currentTarget;this.props.updateEvent(Qx(this.props.event,e,n))};createDateHandler=e=>t=>{const{value:n}=t.currentTarget;this.props.updateEvent(qx(this.props.event,e,n))};setTimezone=e=>{const{value:t}=e.currentTarget;t!==this.props.event.timezone&&this.props.updateEvent((0,Bu.bn)(this.props.event,t))};setAllDay=e=>{const{checked:t}=e.currentTarget;this.props.event.allDay=t,this.props.updateEvent(this.props.event)};render(){const{event:e}=this.props,{start:t,end:n}=(0,Bu.aE)(e);return jx("div",{},void 0,!e.task&&(0,fs.jsxs)(fs.Fragment,{children:[jx("div",{className:"edit-group large-gap"},void 0,jx(WT,{className:"cal-event-date-picker",onChange:this.createDateHandler("start"),tabIndex:this.props.tabIndex,title:(0,Oe.Z)("Event Start Date"),value:t.format("YYYY-MM-DD")}),!e.allDay&&(0,fs.jsx)(_g,{className:"cal-event-time-picker",onChange:this.createTimeHandler("start"),ref:this.props.focusRef,tabIndex:this.props.tabIndex,step:"5",title:(0,Oe.Z)("Event Start Time"),value:t.format("HH:mm")})),jx("div",{className:"edit-group large-gap"},void 0,jx(WT,{className:"cal-event-date-picker",onChange:this.createDateHandler("end"),tabIndex:this.props.tabIndex,title:(0,Oe.Z)("Event End Date"),value:n.format("YYYY-MM-DD")}),!e.allDay&&jx(_g,{className:"cal-event-time-picker",onChange:this.createTimeHandler("end"),tabIndex:this.props.tabIndex,step:"5",title:(0,Oe.Z)("Event End Time"),value:n.format("HH:mm")}))]}),e.task&&(0,fs.jsxs)(fs.Fragment,{children:[!!e.end&&jx("div",{className:"edit-group large-gap"},void 0,jx(Px,{type:"start",view:"inline",event:e,updateEvent:this.props.updateEvent,onDateChange:this.createDateHandler("start"),onTimeChange:this.createTimeHandler("start"),tabIndex:this.props.tabIndex})),jx("div",{className:"edit-group large-gap"},void 0,jx(Px,{type:"due",view:"inline",event:e,onDateChange:this.createDateHandler("end"),onTimeChange:this.createTimeHandler("end"),updateEvent:this.props.updateEvent,tabIndex:this.props.tabIndex}))]}),jx("div",{className:"edit-group large-gap"},void 0,jx("label",{},void 0,jx("input",{type:"checkbox",checked:!!e.allDay,onChange:this.setAllDay,tabIndex:this.props.tabIndex}),jx("span",{},void 0,(0,Oe.Z)("All Day"))),jx("label",{},void 0,jx("select",{disabled:!!e.allDay,onChange:this.setTimezone,value:e.allDay?Lu.$T:e.timezone,tabIndex:this.props.tabIndex},void 0,Xx()))),jx(bx,{event:e,tabIndex:this.props.tabIndex,updateEvent:this.props.updateEvent,label:(0,Oe.Z)("Reminders")}))}}const tO=eO;var nO;function sO(e,t,n,s){nO||(nO="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:nO,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var iO=sO("span",{},void 0,"-"),oO=sO("span",{},void 0,"-");class aO extends hs.Component{createTimeHandler=e=>t=>{const{value:n}=t.currentTarget;this.props.updateEvent(Qx(this.props.event,e,n))};createDateHandler=e=>t=>{const{value:n}=t.currentTarget;this.props.updateEvent(qx(this.props.event,e,n))};changeField=(e,t)=>{this.props.event[e]=t.currentTarget.checked,this.props.updateEvent(this.props.event)};onCalendarChange=e=>{this.props.event.calendarId=e.target.value,this.props.updateEvent(this.props.event)};onCalendarSelected=e=>{m.Z.setDefaultCalendarId(e,this.props.event.task??!1),this.props.event.calendarId=e,this.props.updateEvent(this.props.event)};render(){const{event:e}=this.props,{start:t,end:n}=(0,Bu.aE)(e);return(0,fs.jsxs)(fs.Fragment,{children:[sO("div",{className:"edit-group large-gap"},void 0,(0,fs.jsx)(zx,{...this.props,label:(0,Oe.Z)("Title"),field:"title"})),sO("div",{className:"edit-group large-gap"},void 0,!e.task&&e.allDay&&(0,fs.jsxs)(fs.Fragment,{children:[sO(WT,{className:"cal-event-date-picker",onChange:this.createDateHandler("start"),tabIndex:this.props.tabIndex,title:(0,Oe.Z)("Event Start Date"),value:t.format("YYYY-MM-DD")}),iO,sO(WT,{className:"cal-event-date-picker",onChange:this.createDateHandler("end"),tabIndex:this.props.tabIndex,title:(0,Oe.Z)("Event End Date"),value:n.format("YYYY-MM-DD")})]}),!e.task&&!e.allDay&&(0,fs.jsxs)(fs.Fragment,{children:[sO(_g,{className:"cal-event-time-picker",onChange:this.createTimeHandler("start"),tabIndex:this.props.tabIndex,step:"5",title:(0,Oe.Z)("Event Start Time"),value:t.format("HH:mm")}),oO,sO(_g,{className:"cal-event-time-picker",onChange:this.createTimeHandler("end"),tabIndex:this.props.tabIndex,step:"5",title:(0,Oe.Z)("Event End Time"),value:n.format("HH:mm")})]}),e.task&&sO(Px,{type:"due",view:"inline",event:e,updateEvent:this.props.updateEvent,onDateChange:this.createDateHandler("end"),onTimeChange:this.createTimeHandler("end"),tabIndex:this.props.tabIndex})),sO("div",{className:"edit-group inline large-gap"},void 0,sO("label",{},void 0,sO("input",{type:"checkbox",checked:!!e.task,onChange:this.changeField.bind(null,"task"),tabIndex:this.props.tabIndex}),sO("span",{},void 0,(0,Oe.Z)("Is a Task"))),sO("label",{},void 0,sO("input",{disabled:!e.task,type:"checkbox",checked:!!e.complete,onChange:this.changeField.bind(null,"complete"),tabIndex:e.task?this.props.tabIndex:-1}),sO("span",{},void 0,(0,Oe.Z)("Complete")))),e&&sO("div",{className:"edit-group large-gap capped-width"},void 0,Gu(e,this.onCalendarSelected,this.props.tabIndex)),e&&sO("div",{className:"edit-group capped-width"},void 0,sO(Bx,{event:e,tabIndex:this.props.tabIndex,updateEvent:this.props.updateEvent}))]})}}const rO=aO;var lO;function dO(e,t,n,s){lO||(lO="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:lO,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var cO=dO("div",{className:"CalendarEventBubble-Arrow"});const hO=function(e){const t=hs.useContext(xi.Z),n=hs.useRef(hs.createRef().current),s=hs.useRef(),i=hs.useCallback(((e,n)=>{s.current||(s.current=t.requestAnimationFrame((()=>{!function(e,t){const n=e.current,s=t.current;if(!n||!s)return;const i=n.parentElement?.getBoundingClientRect()||{left:0,top:0,bottom:0,width:0,height:0},o=n.getBoundingClientRect(),a=s.getBoundingClientRect(),r=a.left-i.left,l=i.width-a.right;l>=o.width?(n.style.left=a.right-i.left+"px",n.style.right="auto",n.classList.remove("CalendarEventBubble--RightArrow"),n.classList.add("CalendarEventBubble--LeftArrow")):r>=o.width?(n.style.right=i.width-a.left+"px",n.style.left="auto",n.classList.remove("CalendarEventBubble--LeftArrow"),n.classList.add("CalendarEventBubble--RightArrow")):r>l?(n.style.left="0px",n.style.right="auto",n.classList.remove("CalendarEventBubble--LeftArrow"),n.classList.add("CalendarEventBubble--RightArrow")):(n.style.right="0px",n.style.left="auto",n.classList.remove("CalendarEventBubble--RightArrow"),n.classList.add("CalendarEventBubble--LeftArrow"));const d=n.querySelector(".CalendarEventBubble-Arrow"),c=a.top-i.top,h=i.height-a.bottom,p=(o.height-a.height)/2;if(c>p&&h>p){if(n.style.top=a.top-i.top-p+"px",n.style.bottom="auto",d){const e=p+a.height/2;d.style.top=`${e}px`}}else if(h<p){if(n.style.bottom="0px",n.style.top="auto",d){const e=i.bottom-o.height,t=Math.min(o.height-20,a.top-e+a.height/2);d.style.top=`${t}px`}}else if(n.style.top="0px",n.style.bottom="auto",d){const e=Math.max(20,a.top-o.top+a.height/2);d.style.top=`${e}px`}}(e,n),s.current=null})))}),[s,t]);hs.useEffect((()=>{function s(){i(n,e.eventRef)}const o=new t.ResizeObserver(s),a=e.eventRef.current?.closest(".calendar-viewport");return a&&a.addEventListener("scroll",s),t.addEventListener("resize",s),e.eventRef.current&&o.observe(e.eventRef.current),i(n,e.eventRef),()=>{a&&a.removeEventListener("scroll",s),e.eventRef.current&&o.unobserve(e.eventRef.current),t.removeEventListener("resize",s)}}),[e.eventRef,i,t]);const{saveEvent:o,trashEvent:a}=e,r=hs.useCallback((function(e){(0,to.ZP)(e),o()}),[o]),l=hs.useCallback((function(e){(0,to.ZP)(e),a()}),[a]);return(0,fs.jsx)("div",{className:"CalendarEventBubble panel-clickoutside-ignore",ref:n,"data-top":"225px",children:dO(da.Z,{focusName:"calendar_event",forceTrap:!0},void 0,cO,dO("div",{className:"CalendarEventBubble-Inner"},void 0,dO("form",{onSubmit:r},void 0,dO(pR,{event:e.event}),dO("div",{className:"CalendarEventBubble-Buttons"},void 0,dO("input",{type:"submit",value:e.event.id?(0,Oe.Z)("calendar","Done"):e.event.task?(0,Oe.Z)("Add Task"):(0,Oe.Z)("Add Event"),onClick:r}),dO("input",{type:"button",value:(0,Oe.Z)("calendar","Cancel"),onClick:e.discardChanges}),!!e.event.id&&dO("input",{type:"button",value:(0,Oe.Z)("verb","Delete"),onClick:l})))))})};var pO;function uO(e,t,n,s){pO||(pO="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:pO,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class gO extends hs.Component{static contextType=xi.Z;render(){const{event:e}=this.props;return(0,fs.jsxs)(fs.Fragment,{children:[uO("div",{className:"edit-group large-gap"},void 0,(0,fs.jsx)(zx,{...this.props,label:(0,Oe.Z)("Description"),field:"description"})),uO("div",{className:"edit-group"},void 0,(0,fs.jsx)(zx,{...this.props,label:(0,Oe.Z)("URL"),field:"url"})),e.attachment&&e.attachment.length>0&&uO("div",{className:"cal-event-attchments"},void 0,e.attachment.map((e=>uO("div",{className:"cal-event-attachment"},e.url,uO("span",{dangerouslySetInnerHTML:{__html:Ts.UEH.small}}),uO("a",{onClick:()=>d.ZP.openURL(this.context.vivaldiWindowId,e.url),title:e.url},void 0,e.filename||e.url)))))]})}}const mO=gO;var vO;function fO(e,t,n,s){vO||(vO="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:vO,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class yO extends hs.PureComponent{render(){return fO("div",{className:"cal-edit-tabs"},void 0,this.props.tabs.map((e=>{const{id:t,label:n,icon:s}=e;return fO("button",{className:As()("cal-edit-tab",{selected:this.props.currentTabId===t}),dangerouslySetInnerHTML:{__html:s},onClick:this.props.onSelectTab.bind(null,t),tabIndex:"-1",title:n},`tab-${t}`)})))}}const CO=yO,wO="basics";const bO=function(e,t,n,s){const i=hs.useContext(xi.Z),[o,a]=hs.useState({tabId:wO,toFocus:""}),r=hs.useRef({});r.current={currentTabState:o,tabs:e,editing:n};const l=hs.useRef(!1),d=hs.useRef(null),c=s?.[0].current,h=s?.[1].current,p=hs.useCallback(((t,n="")=>{const s=r.current.currentTabState.tabId;if(!e.get(t)||t===s)return;const o=e.get(s),l=o&&o.containerRef.current,d=i.getSelection(),{document:c}=i;if(l?.contains(c.activeElement)){const e=[];if(d)for(let t=0;t<d.rangeCount;t++)e.push(d.getRangeAt(t));const t={element:c.activeElement,ranges:e};o&&(o.storedFocus=t)}c.activeElement?.blur(),a({tabId:t,toFocus:n})}),[e,i]);return hs.useEffect((()=>{const e=(e,t="first")=>{const{tabs:n,currentTabState:s}=r.current,i=n.get(s.tabId);let o;"next"===e?(o=i&&i.index+1||0,o=o<n.size?o:0):(o=i&&i.index-1||0,o=o<0?n.size-1:o);const a=[...n.values()].find((e=>e.index===o));p(a&&a.id||wO,t)},n=e.bind(null,"next","first"),s=e.bind(null,"previous","last"),o=t=>{const{changeTab:n,direction:s,toFocus:i}=(e=>{const t=HT.Z[e.keyCode];return"PageUp"===t||"Tab"===t&&e.altKey&&e.shiftKey?{changeTab:!0,direction:"previous",toFocus:"first"}:"PageDown"===t||"Tab"===t&&e.altKey?{changeTab:!0,direction:"next",toFocus:"first"}:{changeTab:!1,direction:"next",toFocus:"first"}})(t);n&&(t.preventDefault(),e(s,i))},a=e=>{const{tabs:t,currentTabState:n}=r.current;let s;t.forEach((t=>{const n=t.containerRef.current;e.target instanceof i.HTMLElement&&n?.contains(e.target)&&(s=t.id)})),s&&s!==n.tabId&&p(s)};c&&c.addEventListener("focusin",s),h&&h.addEventListener("focusin",n);const l=t.current;return l&&(l.addEventListener("keydown",o),l.addEventListener("focusin",a)),()=>{l&&(l.removeEventListener("keydown",o),l.removeEventListener("focusin",a)),c&&c.removeEventListener("focusin",s),h&&h.removeEventListener("focusin",n)}}),[n,t,p,c,h,i]),hs.useEffect((function(){function s(e,t){i.requestAnimationFrame((()=>function(e,t,n){if(t.tabIndex<0){const e=t.tabIndex;t.tabIndex=0,t.focus(),t.tabIndex=e}else t.focus();const s=e.document.getSelection();if(!s)return;const{HTMLInputElement:i,HTMLElement:o}=e;if(t instanceof i&&"number"===t.type)t.select();else{if(s.focusNode&&s.focusNode.childNodes[s.focusOffset]===t)return;{const i=e.document.createRange();if(!(i&&t instanceof o))return;i.selectNodeContents(t);const a=t.hasChildNodes()?t.childNodes[0]:null;if(n&&a)try{i.setStart(a,n.start),i.setEnd(a,n.end)}catch(e){i.collapse(!1),et.Z.error("Calendar","Setting caret position failed!",e)}else i.collapse(!1);s.removeAllRanges(),e.document.contains(i.commonAncestorContainer)&&s.addRange(i)}}}(i,e,t)))}const a=n&&!1===l.current;if(l.current=n,!n)return;const r=t.current,p=i.getSelection(),u=e.get(o.tabId);if(r&&u)if(a){e.forEach((e=>e.storedFocus=null)),i.requestAnimationFrame((()=>{r.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"})}));const t=u.focusRef?.current;t&&s(t,d.current)}else{const e=!(!c||!h);if(e&&["first","last"].includes(o.toFocus)){let t=[];if(r instanceof i.HTMLElement&&(t=Array.from(il(r))),e&&(t=t.slice(1,-1)),t=t.filter((e=>!e.parentElement?.className.includes("cal-event-body-buttons"))),t.length)"first"===o.toFocus?s(t[0]):s(t[t.length-1]);else{const e=u.focusRef&&u.focusRef.current;e&&s(e)}}else if(u.storedFocus){const e=u.storedFocus;e.element?.focus(),p&&(p.removeAllRanges(),e.ranges.forEach((e=>p.addRange(e))))}else if(!r.contains(i.document.activeElement)){const e=u.focusRef&&u.focusRef.current;e&&s(e)}}}),[o,n,t,e,c,h,i]),[o.tabId,e=>p(e,"first")]};var SO;function IO(e,t,n,s){SO||(SO="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:SO,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const kO=[$.kCalendarEditMode,$.kCalendarDisplayEventIcons,$.kCalendarDisplayDimPastEvents],AO=[["basics",(0,Oe.Z)("Basic Event Info"),Ts.qHs],["time",(0,Oe.Z)("Date and Time"),Ts.zTz],["recurrence",(0,Oe.Z)("Recurrence"),Ts.Eki],["location",(0,Oe.Z)("other","Location"),Ts.GF3],["description",(0,Oe.Z)("Description"),Ts.wTH],["participants",(0,Oe.Z)("Type to add Participants"),Ts.Rs2]],TO=[["basics",(0,Oe.Z)("Basic Task Info"),Ts.qHs],["time",(0,Oe.Z)("Date and Time"),Ts.zTz],["recurrence",(0,Oe.Z)("Recurrence"),Ts.Eki],["location",(0,Oe.Z)("other","Location"),Ts.GF3],["description",(0,Oe.Z)("Description"),Ts.wTH]],ZO=e=>{const t=Uu(e);let n=`${e.title||""}`;return t&&(n+=` (${t})`),e.location&&(n+=`\n${e.location}`),e.description&&(n+=`\n${e.description}`),n};function EO(e){["Space","Enter"].includes(HT.Z[e.keyCode])&&e.stopPropagation()}function _O(e){const t=hs.useContext(nx),n=hs.useContext(xi.Z),s=hs.useRef(new Map((e.event.task?TO:AO).map(((e,t)=>{const[n,s,i]=e;return[n,{id:n,label:s,icon:i,index:t,focusRef:hs.createRef(),containerRef:hs.createRef(),storedFocus:null}]})))),{event:i,isSelected:o,isEditing:a,isMultiDay:r,isFiltering:l,multiDayContinues:d,multiDayContinuing:c}=e,h=hs.useRef(null),p=hs.useRef(null),u=hs.useRef(null),g=(0,na.Z)(kO),[v,f]=bO(s.current,h,a,[p,u]),{trashEvent:y,getContextMenu:C}=$x(i),w=s.current.get("title"),b=w&&w.focusRef||hs.createRef(),S=s.current.get("time"),I=S&&S.focusRef||hs.createRef(),k=""===i.id,A=g[$.kCalendarEditMode],T=hs.useCallback((e=>{"Enter"!==HT.Z[e.keyCode]||e.shiftKey||(e.preventDefault(),e.stopPropagation(),t.handler.saveEventEdit())}),[t.handler]);const Z=hs.useCallback((()=>{k||y(),t.handler.cancelEventEdit()}),[t.handler,y,k]);let E;if(a&&"popup"===A){const e=n.document.querySelector("#main > .inner");e&&(ie.ZP.isActivePage(n.vivaldiWindowId,t.pageId)||t.isPanel)&&(E=pa.createPortal(IO(hO,{event:i,eventRef:h,saveEvent:t.handler.saveEventEdit,trashEvent:y,discardChanges:t.handler.cancelEventEdit}),e))}const _=g[$.kCalendarDisplayDimPastEvents],M=i.end&&i.end<Date.now(),N=i.task&&!i.complete;return(0,fs.jsxs)(fs.Fragment,{children:[(0,fs.jsxs)("div",{className:As()(`calendar-event calendar${i.calendarId}`,e.className,{selected:o||a,editing:a&&"inline"===A,"all-day":r,solid:"solid"===e.displayStyle,"filtered-out":i.filteredOut&&!a,"task-completed":i.task&&i.complete,minimal:"minimal"===t.displayDensity,compact:"compact"===t.displayDensity,"event-passed":M&&_&&!l&&!a&&!N,"task-overdue":M&&!l&&!a&&N,"multiday-continuing":e.multiDayContinuing&&!a,"multiday-continues":e.multiDayContinues&&!a}),style:e.style,ref:h,onContextMenu:function(e){lR(n,e.target)?e.stopPropagation():(Gx.Z.selectEvent(t.pageId,{event:i}),(0,Qi.Z)(n,C())(e))},title:ZO(i),"data-event-id":i.id,onClick:e=>{a||t.handler.editEvent(i),e.stopPropagation()},onKeyDown:T,children:[a&&"inline"===A&&IO(da.Z,{focusName:"calendar_event_inline_edit",preventTrap:!0},void 0,IO(CO,{tabs:Array.from(s.current.values()),currentTabId:v,onSelectTab:f}),IO("div",{className:"cal-event-body"},void 0,(0,fs.jsxs)(fs.Fragment,{children:[(0,fs.jsx)("span",{className:"sentry",tabIndex:"0",ref:p}),Array.from(s.current.values(),(e=>{const{id:n,label:s,focusRef:o}=e,a=v===n,r=a?0:-1,l={event:i,updateEvent:t.handler.updateEventEdit,field:n,label:s,focusRef:o,tabIndex:r};let d;switch(n){case"basics":d=(0,fs.jsx)(rO,{...l});break;case"recurrence":d=(0,fs.jsx)(eZ,{...l});break;case"description":d=(0,fs.jsx)(mO,{...l});break;case"time":d=(0,fs.jsx)(tO,{...l});break;case"participants":d=(0,fs.jsx)(_x,{...l});break;default:d=IO("div",{className:"edit-group"},void 0,(0,fs.jsx)(zx,{...l}))}return(0,fs.jsxs)("div",{ref:e.containerRef,className:As()("cal-event-body-edit",{selected:a}),children:[d,IO("div",{className:"cal-event-body-buttons"},void 0,""===i.id&&i.filteredOut&&IO("span",{className:"cal-event-body-filtered-warning",dangerouslySetInnerHTML:{__html:Ts.h6},title:i.task?(0,Oe.Z)("Once saved this task will be hidden by current search"):(0,Oe.Z)("Once saved this event will be hidden by current search")}),IO("input",{onClick:t.handler.saveEventEdit,onKeyDown:EO,tabIndex:r,type:"submit",value:(0,Oe.Z)("calendar","Done")}),IO("input",{onClick:Z,onKeyDown:EO,tabIndex:r,type:"button",value:k?(0,Oe.Z)("Cancel"):(0,Oe.Z)("verb","Delete")}))]},e.id)})),(0,fs.jsx)("span",{className:"sentry",tabIndex:"0",ref:u})]}))),(!a||"popup"===A)&&IO("div",{className:"cal-event-body"},void 0,IO("div",{className:"cal-event-header"},void 0,!r&&"transparent"===e.displayStyle&&!i.task&&IO("span",{className:"cal-event-dot",dangerouslySetInnerHTML:{__html:Rd.Z.getEventSquircle()}}),i.task&&IO("input",{type:"checkbox",checked:!!i.complete,onChange:e.onCompleteChanged??function(n){const{checked:s}=n.target,i=(0,V.Uy)(e.event,(e=>{e.complete=s}));m.Z.updateEvent(i,"single",!0,t.pageId)},onMouseDown:to.ZP,onClick:to.ZP,tabIndex:o?"0":"-1"}),!r&&(i.start||i.task)&&!!i.end&&!c&&(0,fs.jsx)("span",{className:"cal-event-time",ref:I,children:Hu(i.start||i.end)}),!r&&!!i.end&&!d&&c&&(0,fs.jsx)("span",{className:"cal-event-time",ref:I,children:Hu(i.end)}),zu(n.vivaldiWindowId,"title",i.title,b),g[$.kCalendarDisplayEventIcons]&&IO("div",{className:"cal-event-icons"},void 0,i.url&&IO("span",{dangerouslySetInnerHTML:{__html:Ts.wTH}}),i.location&&IO("span",{dangerouslySetInnerHTML:{__html:Ts.GF3}}),!(!i.notifications||!i.notifications.length)&&IO("span",{dangerouslySetInnerHTML:{__html:Ts.zTz}}),Rd.Z.isRecurringEvent(i)&&IO("span",{dangerouslySetInnerHTML:{__html:Ts.Eki}}),i.attachment&&i.attachment.length>0&&IO("span",{dangerouslySetInnerHTML:{__html:Ts.UEH.small}}))),"minimal"!==t.displayDensity&&IO("div",{className:"cal-event-body-content"},void 0,zu(n.vivaldiWindowId,"description",i.description||""),zu(n.vivaldiWindowId,"location",i.location||""),zu(n.vivaldiWindowId,"url",i.url||""))),e.resizeHandler&&!c&&IO("div",{className:"calendar-event-resizer pre "+e.resizeHandler}),e.resizeHandler&&!d&&IO("div",{className:"calendar-event-resizer post "+e.resizeHandler})]}),E]})}function MO(e,t){var n,s;return!e.isEditing&&!t.isEditing&&(e.event===t.event&&e.isSelected===t.isSelected&&e.isMultiDay===t.isMultiDay&&e.isFiltering===t.isFiltering&&(n=e.style,s=t.style,!n&&!s||!!n&&!!s&&n.gridRowStart===s.gridRowStart&&n.gridRowEnd===s.gridRowEnd&&n.gridColumnStart===s.gridColumnStart&&n.gridColumnEnd===s.gridColumnEnd))}const NO=hs.memo(_O,MO);var PO;function DO(e,t,n,s){PO||(PO="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:PO,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const xO=function(e){const t=e.date.clone(),n=new Date,s=n.getFullYear(),i=n.getMonth(),o=n.getDate(),a=e.date.year(),r=e.date.month(),l=e.date.week(),d=e.date.date();t.startOf("month").subtract(1,"week").startOf("week");const c=[];for(;c.length<7;){const e=t.format("dd");c.push(DO("div",{className:"MonthDayPicker-DayOfWeek"},e,e)),t.add(1,"day")}const h=e.date.clone().endOf("month");for(;t.isSameOrBefore(h)||0!==t.weekday();){const n=t.date()===o&&t.month()===i&&t.year()===s,h=t.date()===d&&t.month()===r&&t.year()===a,p=t.week()===l&&t.year()===a,u=t.clone();c.push(DO("div",{className:As()("MonthDayPicker-Day",{"MonthDayPicker-Day--Current":n,"MonthDayPicker-Day--Selected":h,"MonthDayPicker-Day--SelectedWeek":p&&!h&&!n,"MonthDayPicker-Day--OtherMonth":t.month()!==i}),onClick:()=>Gx.Z.selectDate(e.pageId,u)},t.format("M-D"),t.date())),t.add(1,"day")}return DO("div",{className:"MonthDayPicker"},void 0,DO("header",{className:"MonthDayPicker-Header"},void 0,DO("div",{className:"toolbar-group"},void 0,DO(Fa,{className:"button-narrow button-transparent",onClick:()=>function(e,t){Gx.Z.selectDate(e,t.clone().subtract(1,"month"))}(e.pageId,e.date),tooltip:(0,Oe.Z)("Previous"),image:Ts.mgF.small}),DO(Fa,{className:"button-narrow button-transparent",onClick:()=>function(e,t){Gx.Z.selectDate(e,t.clone().add(1,"month"))}(e.pageId,e.date),tooltip:(0,Oe.Z)("Next"),image:Ts.Zu.small})),DO("h2",{className:"MonthDayPicker-Month"},void 0,e.date.format("MMMM YYYY"))),c)},OO="vivaldi/x-calendar-event",LO="vivaldi/x-calendar-create-event",{minimalCreateEvent:RO}=Rd.Z,BO={dragging:!1,cancelled:!1,currentX:null,currentY:null,initialTime:0,initialEndTime:0,initialStartRow:0,initialEndRow:0,initialLeftCol:0,initialRightCol:0,resizeEvent:null,draggingFrom:"start",isAllDay:!1};function FO(e,t,n,s,i){const[o,a]=hs.useState(null),[r,l]=hs.useState(null),d=hs.useRef(null),c=hs.useRef(null),h=hs.useRef(s);h.current=s;const p=hs.useContext(xi.Z),{document:u,getComputedStyle:g}=p,{handler:m}=hs.useContext(nx),v=hs.useRef(),f=hs.useRef({...BO});hs.useEffect((()=>{const e=u.createElement("div");return e.classList.add("calendar-drag-image"),v.current=e,u.body?.append(e),()=>{e.remove()}}),[u]);const y=hs.useCallback((()=>{e&&a({gridTemplateColumns:g(e).gridTemplateColumns,gridTemplateRows:g(e).gridTemplateRows})}),[e,g]),C=hs.useCallback((()=>{a(null)}),[]),w=hs.useCallback((()=>{d.current=null,l(d.current),f.current={...BO},i(!1),C()}),[C,i]);function b(){const{resizeEvent:s}=f.current;if(f.current.dragging){if(s){const t=n(e,f.current,d.current);if(!t)return void w();if(t&&!(0,xA.Z)(t,c.current)){const e=s.dataset.eventId,n=h.current;if(n&&n?.id===e)n.start=t.startTime,n.end=t.endTime,m.updateEventEdit(n);else{const n=Bd.Z.getEvent(e);n&&m.editEvent({...n,start:t.startTime,end:t.endTime})}c.current=t}}else{const n=t(e,f.current,d.current);if(!n)return void w();(0,xA.Z)(d.current,n)||l(n),d.current=n}p.requestAnimationFrame(b)}else if(f.current.cancelled)s&&m.cancelEventEdit(),w();else{const e=d.current;e?m.editEvent(null,RO({start:e.startTime,end:e.endTime,allDay:e.isAllDay})).then(w):s&&m.saveEventEdit().then(w)}}return{gridFrozen:o,handlers:{onDragStart:e=>{if(!e.dataTransfer.items.length){const t=u.elementFromPoint(e.clientX,e.clientY),n=t?.closest(".calendar-event");if(t instanceof p.HTMLElement&&t.classList.contains("calendar-event-resizer"))f.current.resizeEvent=t.parentElement instanceof p.HTMLElement&&t.parentElement||null,t.classList.contains("pre")?f.current.draggingFrom="start":f.current.draggingFrom="end";else if(n instanceof p.HTMLElement){const t=n.dataset.eventId;return e.dataTransfer&&t&&(e.dataTransfer.setData(OO,JSON.stringify({id:t})),e.dataTransfer.effectAllowed="copyMove",e.stopPropagation()),e.dataTransfer.setDragImage(n,20,20),void i(!0)}v.current&&e.dataTransfer.setDragImage(v.current,0,0),e.dataTransfer.setData(LO,!0),f.current.dragging=!0,i(!0),f.current.currentX=e.clientX,f.current.currentY=e.clientY,f.current.resizeEvent||y(),e.stopPropagation(),p.requestAnimationFrame(b)}},onDragOver:e=>{e.dataTransfer.types.some((e=>e===LO))&&(f.current.currentX=e.clientX,f.current.currentY=e.clientY,e.stopPropagation(),e.preventDefault())},onDragEnd:e=>{i(!1),e.dataTransfer.types.some((e=>e===OO))&&e.stopPropagation(),"none"===e.dataTransfer.dropEffect&&(f.current.dragging=!1,f.current.cancelled=!0,e.stopPropagation(),e.preventDefault())},onDrop:e=>{i(!1),e.dataTransfer.types.some((e=>e===LO))&&(f.current.currentX=e.clientX,f.current.currentY=e.clientY,f.current.dragging=!1,e.stopPropagation())}},overlay:r}}var VO=n(23542),WO=n(90870);function UO(e){return e.task?e.start?{start:e.start,end:e.end}:{start:e.end,end:e.end?e.end+1:0}:{start:e.start,end:e.end}}function HO(e,t=!1){const n=t?Math.ceil:Math.floor,s=new Date(e);return 4*s.getHours()+n(s.getMinutes()/15)}function zO(e,t){e.items.forEach((n=>{const s=jO(e.items,n,t).sort(((e,t)=>e.stacking-t.stacking));let i=0;for(;s[i]&&i===s[i].stacking;)i++;n.stacking=i,n.adjacent=s}))}function GO(e){e.items.forEach((e=>{const t=new Set(e.adjacent.map((e=>e.stacking))).size;e.stackSize=t+1}))}const $O=(e,t)=>0===t?e:$O(t,e%t),KO=(e,t)=>e*t/$O(e,t);function jO(e,t,n){return e.filter((e=>e!==t&&("day"===n?e.startRow<t.endRow&&e.endRow>t.startRow:e.startCol<t.endCol&&e.endCol>t.startCol)))}const YO=eo()(((e,t,n)=>{let s=function(e,t){e.sort(((e,t)=>{const{start:n,end:s}=UO(e),{start:i,end:o}=UO(t);if(n!==i)return n-i;const a=s-n,r=o-i;return a!==r?r-a:(parseInt(e.id)||1/0)-(parseInt(t.id)||1/0)}));const n=e.map((e=>{const{start:t,end:n}=UO(e),s=HO(t);let i=HO(n,!0);return 0===i&&t!==n&&(i=96),{event:e,adjacent:[],stacking:1/0,stackSize:-1,startRow:s,endRow:i>s?i:s+1,startCol:0,endCol:0}}));return{columns:-1,maxStackSize:0,items:n}}(e);return zO(s,"day"),GO(s),s=function(e){const t=[...new Set(e.items.map((e=>e.stackSize)))],n=t.reduce(((e,t)=>t>e?t:e),-1),s=Math.min(Math.max(100,n),t.reduce(((e,t)=>KO(e,t)),1)),i=s/n;return{columns:s,maxStackSize:n,items:e.items.map((e=>(e.startCol=Math.ceil(e.stacking*i),e.endCol=Math.floor((e.stacking+1)*i),e)))}}(s),function(e){e.items.sort(((e,t)=>{const n=t.stacking-e.stacking;return 0!==n?n:e.startRow-t.startRow}));const t=[];e.items.forEach((n=>{const s=jO(t,n,"day"),i=Math.min(...s.map((e=>e.startCol)),e.columns),o=i/n.endCol;n.endCol=i,n.startCol=Math.ceil(n.startCol*o),t.push(n)}))}(s),s}),{maxSize:2});const XO=eo()(((e,t,n)=>{let s=function(e,t,n){const s=t.clone().startOf("day"),i=e=>{let{start:t,end:i}=UO(e);return i===N()(i).startOf("day").valueOf()&&(i-=1),[(0,gb.Z)(N()(t).diff(s,"day"),0,n-1),(0,gb.Z)(N()(i).diff(s,"day")+1,1,n)]};let[o,a]=(0,WO.Z)(e,(e=>{const[t,n]=i(e);return n-t>1}));const r=o.sort(((e,t)=>{const{start:n,end:s}=UO(e),{start:i,end:o}=UO(t),a=(s||h.Lc)-n,r=(o||h.Lc)-i;return a!==r?r-a:n!==i?n-i:(parseInt(e.id)||1/0)-(parseInt(t.id)||1/0)})).map((e=>{const[t,n]=i(e);return{event:e,adjacent:[],stacking:1/0,stackSize:-1,startCol:t,endCol:n,startRow:0,endRow:0}}));a=a.sort(((e,t)=>{if(!e.id||!t.id)return e.id?-1:1;const n=Rd.Z.isMultiDayEvent(e);if(n!==Rd.Z.isMultiDayEvent(t))return n?-1:1;const{start:s,end:i}=UO(e),{start:o,end:a}=UO(t);if(s!==o)return s-o;const r=(i||h.Lc)-s,l=(a||h.Lc)-o;return r!==l?l-r:(parseInt(e.id)||1/0)-(parseInt(t.id)||1/0)}));const l=[],d=s.clone();for(;d.diff(s,"day")<n;){const e=Rd.Z.filterEventsByPeriod(a,d,"day"),t=(0,gb.Z)(d.diff(s,"day"),0,n-1);l.push({events:e,adjacent:[],stacking:1/0,stackSize:-1,startCol:t,endCol:t+1,startRow:0,endRow:0,date:d.valueOf()}),d.add(1,"day")}return{rows:-1,maxStackSize:0,items:r,multiEventItems:l,startTime:s.valueOf(),endTime:d.valueOf()}}(e,t,n);return zO(s,"week"),GO(s),s=(e=>{const t=[...new Set(e.items.map((e=>e.stackSize)))].reduce(((e,t)=>t>e?t:e),0);return{...e,rows:t,maxStackSize:t,items:e.items.map((e=>(e.startRow=e.stacking,e.endRow=e.stacking+1,e)))}})(s),s=(e=>{const t=e.multiEventItems.length?e.rows+1:e.rows,n=e.multiEventItems.map((n=>{const s=jO(e.items,n,"week"),i=Math.max(0,...s.map((e=>e.endRow)));return{...n,startRow:i,endRow:t}}));return{...e,rows:t,multiEventItems:n}})(s),s}),{maxSize:10});var QO;function qO(e,t,n,s){QO||(QO="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:QO,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const JO=(0,VO.extendMoment)(N()),eL=[$.kCalendarClickTimeSlot,$.kCalendarDisplayWeekNumber],{minimalCreateEvent:tL,getDisplayRange:nL}=Rd.Z;function sL(e,t){const{resizeEvent:n}=t;if(!e||!n)return;const s=e.querySelectorAll(".calendar-drop-target"),i=!t.initialTime,o=t.currentX||1e5,a=t.currentY||1e5,r=Array.from(s).find((e=>{const t=e.getBoundingClientRect();return t.bottom>a&&t.right>o}));if(!r)return;if(i){const e=Bd.Z.getEvent(n.dataset.eventId);if(!e)return;t.initialTime=e.start,t.initialEndTime=e.allDay?e.end-Lu.hd:e.end,t.isAllDay=e.allDay??!1}const l=parseInt(r.dataset.date),d=l+(0,Bu.oR)(t.initialTime),c=l+(0,Bu.oR)(t.initialEndTime);let h,p;return"end"===t.draggingFrom&&c<=t.initialTime||"start"===t.draggingFrom&&d<t.initialEndTime?(h=d,p=t.initialEndTime):(h=t.initialTime,p=c),{startTime:h,endTime:p,isAllDay:t.isAllDay}}function iL(e,t){if(!e)return;const n=Array.from(e.querySelectorAll(".calendar-drop-target")),s=!t.initialTime,i=t.currentX||1e5,o=t.currentY||1e5,a=n.find((e=>{const t=e.getBoundingClientRect();return t.bottom>o&&t.right>i}));if(a&&s){const{resizeEvent:e}=t;if(e)return;t.initialTime=parseInt(a.dataset.date),t.initialEndTime=t.initialTime,t.initialLeftCol=parseInt(a.style.gridColumnStart),t.initialRightCol=t.initialLeftCol+1,t.initialStartRow=parseInt(a.style.gridRowStart),t.initialEndRow=t.initialStartRow+parseInt(a.style.gridRowEnd.match(/\d/)?.[0]),t.isAllDay=!0}if(a){const e=t.initialLeftCol,n=t.initialStartRow,s=parseInt(a.style.gridColumnStart),i=parseInt(a.style.gridRowStart);let o,r,l,d,c,h,p=!0,u="initialStartToCurrent";return(parseInt(a.dataset.date)<t.initialTime||t.resizeEvent&&"start"===t.draggingFrom)&&(u="initialEndToCurrent",p=!1),"initialStartToCurrent"===u?(o=e,r=parseInt(a.style.gridColumnStart)+1,l=n,d=parseInt(a.style.gridRowStart)+parseInt(a.style.gridRowEnd.match(/\d/)?.[0])):(o=s,r=t.initialRightCol,l=i,d=t.initialEndRow),p?(c=t.initialTime,h=parseInt(a.dataset.date)+(0,Bu.oR)(t.initialEndTime)):(c=parseInt(a.dataset.date)+(0,Bu.oR)(t.initialTime),h=t.initialEndTime),{startCol:o,endCol:r,startRow:l,endRow:d,startTime:c,endTime:h,isAllDay:t.isAllDay}}}function oL(e){return e.reduce(((e,t)=>e=(e=e.concat(t.items.map((e=>e.event)))).concat(t.multiEventItems.reduce(((e,t)=>e.concat(t.events)),[]))),[])}function aL(e){const t=(0,na.Z)(eL);if(!e.overlay)return null;const{startRow:n,endRow:s,startCol:i,endCol:o,startTime:a,endTime:r}=e.overlay,l="week"===e.displayMode?1:2,d=t[$.kCalendarDisplayWeekNumber]&&"week"!==e.displayMode?2:1,c="week"===e.displayMode?2:7;return e.grids.reduce((([t,l],h)=>{const p=h.rows+2,u=l===n,g=l+p===s,m=As()("calendar-drag-overlay",{left:u,right:g});if(u){const s={gridRowStart:n,gridRowEnd:l+p,gridColumnStart:i,gridColumnEnd:g?o:d+c},h=e.overlay?.isAllDay??1?"L":"LLL";t.push(qO("div",{className:m,style:s},l,qO("div",{className:"start-time"},void 0,u&&(0,fs.jsx)(fs.Fragment,{children:JO(a).format(h)})),qO("div",{className:"end-time"},void 0,g&&(0,fs.jsx)(fs.Fragment,{children:JO(r).format(h)}))))}else if(l>n&&l<s){const n={gridRowStart:l,gridRowEnd:l+p,gridColumnStart:d,gridColumnEnd:g?o:d+c},s=e.overlay?.isAllDay??1?"L":"LLL";t.push(qO("div",{className:m,style:n},l,qO("div",{className:"start-time"},void 0,u&&qO("span",{},void 0,JO(a).format(s))),qO("div",{className:"end-time"},void 0,g&&qO("span",{},void 0,JO(r).format(s)))))}return[t,l+p]}),[[],l])}function rL(e){const t=e.showWeekNumber?2:1,n=JO().startOf("week");return[...Array(7).keys()].map((e=>{const s=qO(hs.Fragment,{},e,qO("header",{style:{gridColumnStart:e+t},className:"calendar-header-date"},void 0,n.format("dddd")));return n.add(1,"days"),s}))}function lL(e){const{requestAnimationFrame:t}=hs.useContext(xi.Z),{handler:n,pageId:s}=hs.useContext(nx),[i,o]=hs.useState(""),a=(0,na.Z)(eL),{displayMode:r,editingEvent:l,grids:d,filter:c,selectedEvent:h,isActiveEditor:p}=e,u=hs.useCallback(((e,t)=>{e.dataTransfer.types.some((e=>e===OO))&&(e.preventDefault(),e.stopPropagation(),o(t))}),[]),g=hs.useCallback((e=>{e.dataTransfer.types.some((e=>e===OO))&&(e.preventDefault(),e.stopPropagation())}),[]),v=hs.useCallback((e=>{e.dataTransfer.types.some((e=>e===OO))&&(e.preventDefault(),e.stopPropagation())}),[]),f=hs.useCallback(((t,n)=>{const i=t.dataTransfer;if(i.types.some((e=>e===OO))){t.preventDefault(),t.stopPropagation();const a=JSON.parse(i.getData(OO)).id.split("-")[0];if(e.events.find((e=>e.id===a))){("copy"===i.effectAllowed?m.Z.copyEvent:m.Z.moveEvent)(a,{start:n,byDateOnly:!0},s),o("")}}}),[s,e.events]),y=e.displayRange.start.valueOf(),C=a[$.kCalendarDisplayWeekNumber]&&"week"!==e.displayMode,w=hs.useMemo((()=>{const s=e.filter,o=JO(y),r=C?2:1,l=s.anchorDate.month(),d=new Date,c="week"===e.displayMode?2:7;let h="week"===e.displayMode?2:3;return e.grids.flatMap(((p,m)=>{const y=[];return C&&y.push(qO(hs.Fragment,{},m,qO("div",{className:"week-number",style:{gridRowStart:h-1,gridRowEnd:`span ${p.rows+2}`}},void 0,qO("span",{className:"week-number-value"},void 0,o.week())))),[...Array(c).keys()].forEach((c=>{if("week"===e.displayMode&&3===m&&1===c)return;const C=`${m}-${c}`,w=o.valueOf(),b=o.month()===l,S=Number(o.format("E"))>5,I="week"!==e.displayMode&&(0===m&&0===c||1===o.date()),k=o.date()===d.getDate()&&o.month()===d.getMonth()&&o.year()===d.getFullYear(),A=s.selectedDate&&o.isSame(s.selectedDate,"day"),T=e=>((e,t)=>{"click"===e.type&&e.stopPropagation();const s=t+(new Date).getHours()*Lu.QI;"select"===a[$.kCalendarClickTimeSlot]||"contextmenu"===e.type?n.selectDate(JO(s),!0):n.editEvent(null,tL({start:s}))})(e,w);y.push(qO("div",{className:As()("calendar-drop-target",{current:k,"dragged-over":C===i,"out-of-view":"month"===e.displayMode&&!b,weekend:S}),"data-date":w,style:{gridRowStart:h-1,gridRowEnd:`span ${p.rows+2}`,gridColumnStart:c+r},onDragEnter:e=>u(e,C),onDragOver:v,onDragLeave:g,onDrop:e=>f(e,w),onClick:T,onContextMenu:T},C,(0,fs.jsxs)("div",{className:As()("day",{current:k}),ref:e=>{A&&e&&t((()=>{e.scrollIntoView({block:"nearest",inline:"nearest"})}))},onClick:e=>{e.stopPropagation(),n.selectDate(JO(w),!0)},children:[o.format("D"),"week"===e.displayMode&&" "+o.format("ddd"),I&&" "+o.format("MMM")]}))),o.add(1,"day")})),h+=p.rows+2,y}))}),[i,y,e.displayMode,e.grids,a,e.filter,C,t,n,u,v,g,f]),b=[...w];if(e.filter.selectedDate){const s="week"===e.displayMode?2:7,i=e.filter.selectedDate.valueOf()-y,o=Math.floor(i/(s*Lu.hd)),a=e.grids.slice(0,o+1).reduce(((e,t)=>e+t.rows+2),0)+("week"===e.displayMode?0:1),r=Math.floor(i/Lu.hd)%s+(C?2:1),l=!e.selectedEvent&&!e.editingEvent;b.push((0,fs.jsx)("div",{className:As()("calendar-add-event-button","selected","bottom",{active:l}),style:{gridRowStart:a,gridRowEnd:"span 1",gridColumnStart:r},ref:e=>{l&&e&&t((()=>{e.scrollIntoViewIfNeeded({block:"nearest",inline:"nearest"})}))},onClick:l?()=>function(e,t){const n=e.selectedDate?e.selectedDate.clone().startOf("day").valueOf()+(new Date).getHours()*Lu.QI:0;t.editEvent(null,tL({start:n}))}(e.filter,n):Aa.Z,dangerouslySetInnerHTML:{__html:Ts.PbG}},"add-event-button"))}if("week"===e.displayMode){const t=7+e.grids[0].rows+e.grids[1].rows+e.grids[2].rows;b.push(qO("div",{className:"calendar-day-picker",style:{gridRowStart:t,gridRowEnd:`span ${e.grids[3].rows+2}`,gridColumnStart:2}},"pickerCell",qO(xO,{date:e.filter.selectedDate??e.filter.anchorDate,pageId:s})))}const S=Boolean(c.filterText),I=hs.useMemo((()=>({displayStyle:"transparent",isFiltering:S})),[S]);let k=[],A="week"===r?2:3;const T=a[$.kCalendarDisplayWeekNumber]&&"week"!==r?1:0;return d.forEach(((t,n)=>{k=k.concat(t.items.map((n=>{const s=n.event.end,i=p&&l?.id===n.event.id&&!e.isDragging,o=n.event.id.split("-")[0]===h?.split("-")[0],a=i&&l?l:n.event,r={gridRowStart:n.startRow+A,gridColumnStart:n.startCol+T+1,gridColumnEnd:n.endCol+T+1};return(0,fs.jsx)(NO,{multiDayContinuing:(n.event.start||1/0)<t.startTime,multiDayContinues:s>t.endTime,event:a,style:r,...I,isMultiDay:Rd.Z.isMultiDayEvent(n.event),isSelected:o,isEditing:i,resizeHandler:"horizontal"},`${Rd.Z.generateKey(n.event)}-${r.gridRowStart}`)}))),k=k.concat(t.multiEventItems.map(((s,i)=>{const o=l&&s.events.some((e=>e.id===l.id)),a=new Date(s.date).toDateString(),r=`${n}-${i}`;return qO("div",{className:As()("event-container",{selected:o}),style:{gridRowStart:s.startRow+A,gridRowEnd:t.rows+A,gridColumnStart:s.startCol+T+1,gridColumnEnd:s.endCol+T+1},onDragEnter:e=>u(e,r),onDragOver:v,onDragLeave:g,onDrop:e=>f(e,s.date),"data-date":s.date},`${a}-${A}`,s.events.map((n=>{const s=p&&l?.id===n.id&&!e.isDragging,i=n.id.split("-")[0]===h?.split("-")[0],o=s&&l?l:n;return(0,fs.jsx)(NO,{event:o,...I,multiDayContinuing:(n.start||1/0)<t.startTime,multiDayContinues:n.end>t.endTime,isMultiDay:Rd.Z.isMultiDayEvent(n),isSelected:i,isEditing:s,resizeHandler:"horizontal"},Rd.Z.generateKey(n))})))}))),A+=t.rows+2})),b.push(...k),b}const dL=function(e){const t=(0,na.Z)(eL),{handler:n}=hs.useContext(nx),{document:s,requestAnimationFrame:i}=hs.useContext(xi.Z),o=hs.useRef(null),[a,r]=hs.useState([]),[l,d]=hs.useState(JO.range()),[c,h]=hs.useState(!1),{gridFrozen:p,handlers:u,overlay:g}=FO(o.current,iL,sL,e.editingEvent,h),m=!c&&e.editingEvent?{onDragStart:to.ZP}:u,v=hs.useRef({selectedEventCache:new Map,lastSelectedEvent:null,navigationPending:!1,updateCreateOverlay:()=>{}}),{events:f,filter:y,displayMode:C}=e;hs.useMemo((()=>{let t=f;c&&e.editingEvent&&(t=f.map((t=>t.id===e.editingEvent?.id?e.editingEvent:t)).filter(Boolean));const n=function(e,t,n){const s=nL(t,n),i=[],o=s.start.clone(),a="week"===n?2:7;for(;o<s.end;){const t=o.valueOf(),n=Rd.Z.filterEventsByPeriod(e,o,"day",a).map((e=>e.start<t?{...e,id:`${e.id}-${o.dayOfYear()}`}:e)),r=o.isSame(s.end,"day")?1:a;i.push(XO(n,o,r)),o.add(a,"day")}return{grids:i,displayRange:s}}(t,y.anchorDate,C);r(n.grids),d(n.displayRange)}),[C,f,y.anchorDate,c,e.editingEvent]);const w=(e,t,i,o)=>{v.current.navigationPending=!1;const a=e||v.current.lastSelectedEvent,r=a?s.getElementById(a.id):s.getElementById(i.toDate().toDateString()),l=i.clone();if("Left"===o?l.subtract(1,"day"):l.add(1,"day"),!r)return v.current.selectedEventCache.clear(),void n.selectDate(l,!0);const d=t.map((e=>{const t=s.getElementById(e.id);return{event:e,element:t,bounds:t?t.getBoundingClientRect():{top:0,bottom:0}}})).filter((e=>Boolean(e.element))),c=r.getBoundingClientRect(),h=d.filter((e=>e.bounds.bottom>c.top&&e.bounds.top<c.bottom)).sort(((e,t)=>{const n=(c.top+c.bottom)/2,s=(e.bounds.top+e.bounds.bottom)/2,i=(t.bounds.top+t.bounds.bottom)/2;return Math.abs(s-n)-Math.abs(i-n)}));if(h.length){const e=h[0];b({event:e.event,date:l})}else n.selectDate(l,!0)},b=e=>{const{event:t}=e;if(t){const e=JO(t.start).format("YYYY-MM-DD");v.current.selectedEventCache.set(e,t),v.current.lastSelectedEvent=t}else v.current.selectedEventCache=new Map,v.current.lastSelectedEvent=null;n.selectEvent({...e,allDay:!0})};let S={};if(p)S=p;else{const t="week"===e.displayMode?"":"max-content ";S.gridTemplateRows=a.reduce(((e,t)=>`${e} 1.9em ${"max-content ".repeat(Math.max(t.rows-1,0))} ${t.rows?"minmax(min-content, 1fr) ":""} minmax(20px, 1fr) `),t)}const I=t[$.kCalendarDisplayWeekNumber]&&"week"!==C;return(0,fs.jsxs)("div",{className:As()("calendar-grid calendar-grid-days",`calendar-grid-${e.displayMode}`,{"is-dragging":c,"show-weeknumber":I}),ref:o,onKeyDown:t=>{const s=oL(a),o=t.altKey;if(!e.editingEvent){const a="week"===e.displayMode?2:7,r=s.find((t=>t.id===e.selectedEvent)),{selectedDate:d}=e.filter;if(!d)return void console.error("Can not navigate day grid. No selected calendar date.");const c=d.weekday();switch(HT.Z[t.keyCode]){case"Left":{if(v.current.navigationPending||c%a==0)break;const e=d.clone().subtract(1,"day"),t=e.format("YYYY-MM-DD"),o=v.current.selectedEventCache.get(t);if(o){b({event:o,date:e});break}if(r||v.current.lastSelectedEvent){const t=Rd.Z.filterEventsByPeriod(s,e,"day");i(w.bind(this,r,t,d,"Left")),v.current.navigationPending=!0}else n.selectDate(e,!0);break}case"Right":{if(v.current.navigationPending||c%a==a-1||6===c)break;const e=d.clone().add(1,"day"),t=e.format("YYYY-MM-DD"),o=v.current.selectedEventCache.get(t);if(o){b({event:o,date:e});break}if(r||v.current.lastSelectedEvent){const t=Rd.Z.filterEventsByPeriod(s,e,"day");i(w.bind(this,r,t,d,"Right")),v.current.navigationPending=!0}else n.selectDate(e,!0);break}case"Up":{v.current.selectedEventCache=new Map,v.current.lastSelectedEvent=null;const t=Rd.Z.filterEventsByPeriod(s,d,"day"),i=t.findIndex((t=>t.id===e.selectedEvent));if(-1===i&&t.length&&!o)b({event:t[t.length-1],date:d});else if(0===i||!t.length||o){let t=a;"week"===e.displayMode&&c<2&&(t=0===c?1:3),n.selectDate(d.clone().subtract(t,"day"),!0)}else b({event:t[i-1],date:d});break}case"Down":{v.current.selectedEventCache=new Map,v.current.lastSelectedEvent=null;let t=Rd.Z.filterEventsByPeriod(s,d,"day");const i=t.findIndex((t=>t.id===e.selectedEvent));let r=a;if("week"===e.displayMode&&c>=5&&(r=5===c?3:1),o){const e=d.clone().add(r,"day");n.selectDate(e,!0)}else if(-1===i){const e=d.clone().add(r,"day");if(e.isAfter(l.end,"day")){const n=Ku.tV.call(Bd.Z.getEvents(),e,"day");t=oL([XO(n,e,1)])}else t=Rd.Z.filterEventsByPeriod(s,e,"day");t.length?b({event:t[0],date:e}):n.selectDate(e,!0)}else i===t.length-1?b({event:null}):b({event:t[i+1],date:d});break}case"Enter":if((0,to.ZP)(t),e.selectedEvent){const t=s.find((t=>t.id===e.selectedEvent));n.editEvent(t)}else{const e=d.clone().hours((new Date).getHours()).valueOf();n.editEvent(null,tL({start:e}))}break;case"Escape":(0,to.ZP)(t),e.selectedEvent&&b({event:null})}}},draggable:!0,...m,style:S,tabIndex:"0",children:["week"!==e.displayMode&&qO(rL,{showWeekNumber:I}),qO(lL,{grids:a,events:f,displayRange:l,displayMode:C,editingEvent:e.editingEvent,selectedEvent:e.selectedEvent,filter:y,isActiveEditor:!!e.editingEvent,isDragging:c,setIsDragging:h}),qO(aL,{overlay:g,displayMode:C,grids:a})]})};function cL(e){return"time"in e}function hL(e,t,n,s){let i,o,a;const r=n||t;let l;const d=s[8];switch(e){case"Left":l=r.isAllDay?r:t,i=e=>e.navigation.right<r.navigation.right&&e.navigation.top<l.navigation.bottom&&e.navigation.bottom>l.navigation.top,o=(e,t)=>t.navigation.right-e.navigation.right,a=(e,t)=>e.navigation.top-t.navigation.top;break;case"Right":l=r.isAllDay?r:t,i=e=>e.navigation.right>r.navigation.right&&e.navigation.left>=r.navigation.left&&e.navigation.top<l.navigation.bottom&&e.navigation.bottom>l.navigation.top,o=(e,t)=>e.navigation.left-t.navigation.left,a=(e,t)=>e.navigation.top-t.navigation.top;break;case"Up":{const e=d.display.bottom-d.display.top-1;l=r.isAllDay?t:r,i=e=>e.navigation.bottom<=r.navigation.top&&e.navigation.left<l.navigation.right&&e.navigation.right>l.navigation.left,o=(t,n)=>{const s=cL(t)||t.isAllDay?t.navigation.bottom:t.navigation.bottom+e;return(cL(n)||n.isAllDay?n.navigation.bottom:n.navigation.bottom+e)-s},a=(e,t)=>e.navigation.left-t.navigation.left;break}case"Down":{const e=d.display.bottom-d.display.top-1;l=r.isAllDay?t:r,i=e=>e.navigation.top>=r.navigation.bottom&&e.navigation.left<l.navigation.right&&e.navigation.right>l.navigation.left,o=(t,n)=>(!cL(t)||t.isAllDay?t.navigation.top-e:t.navigation.top)-(!cL(n)||n.isAllDay?n.navigation.top-e:n.navigation.top),a=(e,t)=>e.navigation.left-t.navigation.left;break}default:return}const c=s.filter(i).sort(((e,t)=>{const n=o(e,t);return 0!==n?n:cL(e)!==cL(t)?cL(e)?1:-1:a(e,t)}));return c.length?c[0]:null}var pL,uL=n(98891),gL=n(84584),mL=n(34155);function vL(e,t,n,s){pL||(pL="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:pL,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const fL=[$.kCalendarCollapseHours,$.kCalendarClickTimeSlot,$.kCalendarDayEnds,$.kCalendarDayStarts,$.kCalendarOnlyHourlyKeynav,$.kCalendarTimeIncrements],{minimalCreateEvent:yL}=Rd.Z,CL={day:{row:2,column:2},week:{row:2,column:2},year:{row:1,column:2}},wL=96,bL={adjacent:[],stacking:0,stackSize:0,startRow:0,endRow:1,startCol:0,endCol:1};function SL(e,t,n){const s=N()();if(e.isSame(s,t)){const e=HO(s.valueOf())+CL[t].row,i=Math.round(s.minutes()%15/15*100);let o=0,a=n[0]+1;if("week"===t){const e=s.weekday();o=(0,uL.Z)(n.slice(0,e))+e,a=n[e]+1}return{row:e,percentage:i,column:o,columnSpan:a}}}function IL(e,t,n,s){const i=s?(0,uL.Z)(s.slice(0,n.startCol)):n.startCol,o=s?(0,uL.Z)(s.slice(0,n.endCol)):n.endCol;return{left:t+i,top:e+n.startRow,right:t+o,bottom:e+n.endRow}}const kL=eo()((function(e,t,n,s,i,o){const[a,r]=(0,WO.Z)(e,Rd.Z.isMultiDayEvent);a.sort(((e,t)=>e.start!==t.start?e.start-t.start:e.end!==t.end?e.end-t.end:(parseInt(e.id)||1/0)-(parseInt(t.id)||1/0)));const[l,d,c]=function(e,t,n,s){const i=[];if("day"===s)i.push(YO(e,n));else if("week"===s){const t=n.clone().startOf("week");[...Array(7).keys()].forEach((n=>{const s=Rd.Z.filterEventsByPeriod(e,t,"day");i.push(YO(s,t)),t.add(1,"days")}))}let o;if("day"===s){const e=n.clone().startOf("day").valueOf();o={maxStackSize:1,rows:t.length,items:[],multiEventItems:t.length?[{...bL,date:n.valueOf(),events:t}]:[],startTime:e,endTime:e+Lu.hd}}else o=XO(t,n.clone().startOf("week"),7);const a=i.map((e=>e.columns));return[i,o,a]}(r,a,t,n),{timeCells:h,eventCells:p}=function(e,t,n,s,i,o,a,r){function l(e){return 60*e.hour()+e.minute()}const d=N()(e).startOf(t),c=i.map((e=>e+1)),h=s?s.rows+1:1;let p,u,g=[],m=CL[t].row,v=[];if(m=CL[t].row,p=CL[t].column,s){const e={start:s.startTime,end:s.startTime+Lu.S};v=v.concat(s.items.map((t=>{const n=IL(m,p,t,c);return{display:n,navigation:n,isAllDay:!0,event:t.event,time:e}}))),v=v.concat(s.multiEventItems.map((t=>{const n=IL(m,p,t,c);return{display:n,navigation:n,isAllDay:!0,events:t.events,time:e}})))}m+=h,p=CL[t].column,v=v.concat(n.flatMap((e=>{const t=e.items.map((e=>({display:{...IL(m,p,e)},navigation:{...IL(m,p,e)},isAllDay:!1,event:e.event})));return p+=e.columns+1,t}))),m=CL[t].row,p=CL[t].column,u=d.clone(),g=g.concat(c.map((e=>{const t=u.valueOf();u.add(1,"day");const n=u.valueOf(),s=p,i=m,o=p+e,a=m+h,r=v.filter((e=>e.navigation.left<o&&e.navigation.right>s&&e.navigation.top<a&&e.navigation.bottom>i)).reduce(((e,t)=>Math.max(e,t.navigation.bottom)),i);return p+=e,{display:{left:s,top:i,right:o,bottom:a},navigation:{left:s,top:r,right:o,bottom:a},isAllDay:!0,time:{start:t,end:n}}}))),m+=h,p=CL[t].column,u=d.clone();const f=Math.max(60*o-r,0),y=60*a;return u.add(f,"minute"),g=g.concat(c.flatMap(((e,t)=>{const n=[];for(;u.diff(d,"day")===t;){const t=p,s=l(u)===f?m:m+l(u)/15,i=p+e,o=u.valueOf();u.add(r,"minute");const a=l(u),d=a>y||0===a?m+wL:m+l(u)/15,c=u.valueOf(),h=v.filter((e=>e.navigation.left<i&&e.navigation.right>t&&e.navigation.top<d&&e.navigation.bottom>s)),g=h.reduce(((e,t)=>Math.max(e,t.navigation.right)),t),C={display:{left:t,top:s,right:i,bottom:d},navigation:{left:g,top:s,right:i,bottom:d},isAllDay:!1,time:{start:o,end:c}};l(u)>y&&(u.add(1,"day").startOf("day"),C.time.end=u.valueOf(),u.add(f,"minute")),n.push(C)}return p+=e,n}))),{timeCells:g,eventCells:v}}(t,n,l,d,c,s,i,o);return{grids:l,gridColumns:c,allDayGrid:d,timeCells:h,eventCells:p}}),{maxSize:2});function AL(e,t,n){const s=e?.querySelectorAll(".quarter"),i=e?.querySelectorAll(".calendar-background-day");if(s&&i){let e=!1;const o=[...s].find(((t,s)=>{const i=t.getBoundingClientRect(),o=i.bottom>n;return o&&0===s&&n<i.top&&(e=!0),o})),a=[...i].find((e=>e.getBoundingClientRect().right>t));if(o&&a)return{currentRow:o,currentCol:a,isAllDayRow:e}}return{}}function TL(e,t,n){const{resizeEvent:s}=t;if(!e||!s)return;const i=t.currentX??1e5,o=t.currentY??1e5,{currentRow:a,currentCol:r,isAllDayRow:l}=AL(e,i,o);if(a&&r){const e=!t.initialTime,i=e?l:n?.isAllDay||!1;if(e){const e=Bd.Z.getEvent(s.dataset.eventId);if(!e)return;t.initialTime=e.start,t.initialEndTime=e.allDay?e.end-Lu.hd:e.end}const o=i?parseInt(r.dataset.date):parseInt(r.dataset.date)+parseInt(a.dataset.starttime),d=i?parseInt(r.dataset.date)+Lu.hd:parseInt(r.dataset.date)+parseInt(a.dataset.endtime);let c,h;return"end"===t.draggingFrom&&d<=t.initialTime||"start"===t.draggingFrom&&o<t.initialEndTime?(c=o,h=t.initialEndTime):(c=t.initialTime,h=d),{startTime:c,endTime:h,isAllDay:i}}}function ZL(e,t,n){if(!e)return;const s=t.currentX??1e5,i=t.currentY??1e5;let{currentRow:o,currentCol:a,isAllDayRow:r}=AL(e,s,i);if(o&&a){const e=!t.initialTime,s=e?r:n?.isAllDay||!1;if(e){if(t.resizeEvent)return;t.initialTime=parseInt(a.dataset.date)+parseInt(o.dataset.starttime),t.initialEndTime=parseInt(a.dataset.date)+parseInt(o.dataset.endtime),t.initialStartRow=parseInt(o.style.gridRowStart),t.initialEndRow=parseInt(o.style.gridRowEnd),t.initialLeftCol=parseInt(a.style.gridColumnStart),t.initialRightCol=parseInt(a.style.gridColumnEnd)}s&&(o=a);const i=t.initialLeftCol,l=t.initialStartRow,d=parseInt(a.style.gridColumnStart),c=parseInt(o.style.gridRowStart);let h,p,u,g,m,v,f=!0;return i<d?s?("start"===t.draggingFrom?(h=parseInt(a.style.gridColumnStart),p=t.initialRightCol):(h=i,p=parseInt(a.style.gridColumnEnd)),u=parseInt(o.style.gridRowStart),g=l):(h=i,p=parseInt(a.style.gridColumnEnd),u=l,g=parseInt(o.style.gridRowEnd)):i>d?(h=parseInt(a.style.gridColumnStart),p=t.initialRightCol,u=parseInt(o.style.gridRowStart),g=t.initialEndRow,f=!1):(h=i,p=t.initialRightCol,"end"===t.draggingFrom&&l<=c||"start"===t.draggingFrom&&t.initialEndRow<=c?(u=l,g=parseInt(o.style.gridRowEnd)):(u=c,g=t.initialEndRow,f=!1)),f?(m=t.initialTime,v=s?parseInt(a.dataset.date):parseInt(a.dataset.date)+parseInt(o.dataset.endtime)):(m=s?parseInt(a.dataset.date):parseInt(a.dataset.date)+parseInt(o.dataset.starttime),v=t.initialEndTime),{startCol:h,endCol:p,startRow:u,endRow:g,startTime:m,endTime:v,isAllDay:s}}}function EL(e){if(!e.overlay)return null;const{startRow:t,endRow:n,startCol:s,endCol:i,startTime:o,endTime:a,isAllDay:r}=e.overlay,l={gridRowStart:t,gridRowEnd:n,gridColumnStart:s,gridColumnEnd:i};if(r)return vL("div",{className:"calendar-drag-overlay start end",style:l},void 0,vL("div",{className:"start-time"},void 0,N()(o).format("L")),vL("div",{className:"end-time"},void 0,N()(a).format("L")));{const[t]=e.columnSizes.reduce((([t,r],d)=>{const c=d+1,h=r===s,p=i>r&&i<=r+c,u=As()("calendar-drag-overlay",{start:h,end:p});return h?(l.gridRowEnd=p?n:e.rowOffset+wL,l.gridColumnEnd=r+d,t.push(vL("div",{className:u,style:{...l}},r,vL("div",{className:"start-time"},void 0,h&&(0,fs.jsx)(fs.Fragment,{children:N()(o).format("LT")})),vL("div",{className:"end-time"},void 0,p&&(0,fs.jsx)(fs.Fragment,{children:N()(a).format("LT")}))))):r>s&&r<i&&(l.gridRowStart=e.rowOffset,l.gridColumnStart=r,l.gridColumnEnd=r+d,l.gridRowEnd=p?n:e.rowOffset+wL,t.push(vL("div",{className:u,style:{...l}},r,vL("div",{className:"start-time"},void 0,h&&vL("span",{},void 0,N()(o).format("LT"))),vL("div",{className:"end-time"},void 0,p&&vL("span",{},void 0,N()(a).format("LT")))))),[t,r+c]}),[[],e.colOffset]);return t}}function _L(e){const{handler:t}=hs.useContext(nx),n=(0,na.Z)([$.kCalendarCollapseHours,$.kCalendarDayEnds,$.kCalendarDayStarts,$.kCalendarTimeIncrements,$.kCalendarOnlyHourlyDivider]),{anchorDate:s,displayMode:i,allDayGrid:o,filter:a}=e;return hs.useMemo((function(){function e(e,n){e.stopPropagation();const s=N()(a.selectedDate).hours(n);t.selectDate(s,!1)}const r=n[$.kCalendarCollapseHours],l=r?n[$.kCalendarDayStarts]:0,d=r&&n[$.kCalendarDayEnds]||24,c=s.clone().startOf("day").hour(l),h=parseInt(n[$.kCalendarTimeIncrements]);let p=CL[i].row;o&&(p+=o.rows+1);const u=(0,gL.Z)(l,d);let g=[];g=15===h?[{rowOffset:0,span:1,startOffset:0,endOffset:9e5},{rowOffset:1,span:1,startOffset:9e5,endOffset:18e5},{rowOffset:2,span:1,startOffset:18e5,endOffset:27e5},{rowOffset:3,span:1,startOffset:27e5,endOffset:36e5}]:30===h?[{rowOffset:0,span:2,startOffset:0,endOffset:18e5},{rowOffset:2,span:2,startOffset:18e5,endOffset:36e5}]:[{rowOffset:0,span:4,startOffset:0,endOffset:36e5}];const m=N()().localeData().longDateFormat("LT").match(/[aA]/)?.[0],v=m?`h ${m}`:"H:mm",f=m?N()().startOf("day").format(v):"0:00";return(0,fs.jsxs)(fs.Fragment,{children:[vL("div",{className:"hour-track",style:{gridRowEnd:wL+p}}),l>0&&(0,fs.jsxs)(fs.Fragment,{children:[vL("div",{className:"hour",onClick:t=>e(t,l-1),style:{gridRowStart:p,gridRowEnd:"span "+4*l}},void 0,vL("div",{className:"hour-value"},void 0,f)),vL("div",{className:"quarter collapsed morning","data-starttime":l*Lu.QI-h*Lu.lb,"data-endtime":l*Lu.QI,style:{gridRowStart:p,gridRowEnd:p+4*l}}),vL("div",{className:"hour-line",style:{gridRowStart:p}})]}),u.map(((t,s)=>{const i=p+4*t,o=vL(hs.Fragment,{},`fr${s}`,vL("div",{className:"hour",onClick:n=>e(n,t),style:{gridRowStart:i}},void 0,vL("div",{className:"hour-value"},void 0,c.format(v))),g.map(((e,s)=>vL(hs.Fragment,{},e.rowOffset,vL("div",{className:"quarter",style:{gridRowStart:i+e.rowOffset,gridRowEnd:i+e.rowOffset+e.span},"data-starttime":t*Lu.QI+e.startOffset,"data-endtime":t*Lu.QI+e.endOffset}),0!==s&&!n[$.kCalendarOnlyHourlyDivider]&&vL("div",{className:"quarter-line",style:{gridRowStart:i+e.rowOffset}})))),vL("div",{className:"hour-line",style:{gridRowStart:i}}));return c.add(1,"hour"),o})),d<24&&(0,fs.jsxs)(fs.Fragment,{children:[vL("div",{className:"hour-line",style:{gridRowStart:p+4*d}}),vL("div",{className:"hour",onClick:t=>e(t,c.hour()),style:{gridRowStart:p+4*d},style:{gridRowStart:p+4*d,gridRowEnd:p+96}},void 0,vL("div",{className:"hour-value"},void 0,c.format(v))),vL("div",{className:"quarter collapsed evening","data-starttime":d*Lu.QI,"data-endtime":d*Lu.QI+h*Lu.lb,style:{gridRowStart:p+4*d,gridRowEnd:p+wL}})]}),vL("div",{className:"hour hour-last",style:{gridRowStart:p+wL-1}},void 0,vL("div",{className:"hour-value"},void 0,f))]})}),[n,o,s,i,t,a])}function ML(e){const{anchorDate:t,displayMode:n,gridColumns:s,filter:i,inPanel:o}=e,{handler:a}=hs.useContext(nx);return hs.useMemo((function(){const e=[];if("week"===n){const n=t.clone().startOf("week");let o=2;s.forEach(((t,s)=>{const r=n.format(q.ZP.getWeekdayFormat(q.ZP.getShortDateFormat())),l=n.valueOf();e.push(vL(hs.Fragment,{},s,vL("header",{style:{gridRowStart:1,gridColumnStart:o,gridColumnEnd:o+t+1},className:As()("calendar-header-date",{current:(0,Bu.KC)(n.toDate(),new Date)}),onClick:e=>{e.stopPropagation();const t=N()(l).hours(i.selectedDate?.hours()??0);a.selectDate(t,i.allDaySelected)}},void 0,r),vL("div",{style:{gridRowStart:2,gridRowEnd:"grid-bottom",gridColumnStart:o,gridColumnEnd:o+t+1},className:As()("calendar-background-day",{weekend:n.day()%6==0}),"data-date":n.valueOf()}))),o+=t+1,n.add(1,"days")}))}else e.push(vL(hs.Fragment,{},"day",vL("header",{style:{gridRowStart:1,gridColumnStart:2,gridColumnEnd:s[0]+3},className:As()("calendar-header-date",{current:(0,Bu.KC)(t.toDate(),new Date)})},void 0,t.format(q.ZP.getWeekdayFormat(o?"ll":"LL"))),vL("div",{style:{gridRowStart:2,gridRowEnd:"grid-bottom",gridColumnStart:2,gridColumnEnd:s[0]+3},className:As()("calendar-background-day",{weekend:t.day()%6==0}),"data-date":t.clone().startOf("day").valueOf()})));return e}),[t,n,s,o,a,i])}function NL(e){return e.marker?[vL("div",{className:"current-time",style:{gridRowStart:e.marker.row,gridColumnStart:e.marker.column+2,gridColumnEnd:`span ${e.marker.columnSpan}`}},"marker",vL("span",{className:"marker",style:{top:`${e.marker.percentage}%`}}))]:null}function PL(e){const{requestAnimationFrame:t}=hs.useContext(xi.Z),{editEvent:n}=hs.useContext(nx).handler,{cells:s,selectedEvent:i,editingEvent:o,allDaySelected:a,selectedDate:r}=e;return hs.useMemo((function(){return s.map(((e,s)=>{const{display:l,isAllDay:d,navigation:c,time:h}=e;if(!h)return null;const p=r?.valueOf(),u=p&&a===d&&h.start<=p&&h.end>p;if(!u)return null;const g=u&&!i&&!o;return(0,fs.jsx)("div",{className:As()("calendar-add-event-button selected",{active:g,"with-event":c.left!==l.left}),onClick:e=>{e.stopPropagation(),n(null,yL({start:h.start,allDay:d}))},style:{gridRowStart:c.top,gridRowEnd:c.bottom,gridColumnStart:c.left,gridColumnEnd:c.right},ref:e=>e&&t((()=>{e.scrollIntoView({block:"nearest",inline:"nearest"})})),dangerouslySetInnerHTML:{__html:Ts.PbG}},`sel${s}`)}))}),[a,s,n,o,r,i,t])}function DL(e){const t=Boolean(e.filter.filterText),n=hs.useMemo((()=>({displayStyle:"solid",isFiltering:t})),[t]),{cells:s,editingEvent:i,selectedEvent:o,displayMode:a}=e;return hs.useMemo((()=>s.map(((t,s)=>{if(t.event){const s=t.event;if(!s)return null;const a=i?.id===s.id&&!e.isDragging,r=s.id.split("-")[0]===o?.split("-")[0],l=a&&i?i:s,d=Rd.Z.generateKey(s,t.isAllDay?`${t.display.left}${t.display.right}`:`${t.display.left}${t.display.top}`),c=t.time&&s.start<t.time.start,h=t.time&&s.end>t.time.end;return(0,fs.jsx)(NO,{...n,style:{gridRowStart:t.display.top,gridRowEnd:t.display.bottom,gridColumnStart:t.display.left,gridColumnEnd:t.display.right},event:l,isMultiDay:Rd.Z.isMultiDayEvent(s),isSelected:r,isEditing:a,resizeHandler:t.isAllDay?"horizontal":"vertical",multiDayContinuing:c,multiDayContinues:h},d)}if(t.events){const s=t.events;if(!s.length)return null;const r=Rd.Z.generateKey(s[0]);return vL("div",{className:As()("event-container",{"calendar-day-allday":t.isAllDay&&"day"===a}),style:{gridRowStart:t.display.top,gridRowEnd:t.display.bottom,gridColumnStart:t.display.left,gridColumnEnd:t.display.right}},`${r}-${t.display.top}`,s.map((s=>{const a=i?.id===s.id&&!e.isDragging,r=s.id.split("-")[0]===o?.split("-")[0];return(0,fs.jsx)(NO,{...n,event:s,isMultiDay:Rd.Z.isMultiDayEvent(s),isSelected:r,isEditing:a,resizeHandler:t.isAllDay?"horizontal":"vertical"},`${Rd.Z.generateKey(s)}`)})))}}))),[s,a,n,i,o,e.isDragging])}const xL=function(e){const{handler:t,pageId:n}=hs.useContext(nx),{editEvent:s,selectDate:i,selectEvent:o}=t,{requestAnimationFrame:a,HTMLElement:r}=hs.useContext(xi.Z),l=hs.useRef(null),[d,c]=hs.useState(null),[h,p]=hs.useState([]),[u,g]=hs.useState([]),[v,f]=hs.useState([]),[y,C]=hs.useState(!1),[w,b]=hs.useState(null),[S,I]=hs.useState(null),k=(0,na.Z)(fL),A=hs.useRef({updateTimer:null,updateCreateOverlay:()=>{},isResizing:!1,hover:{x:0,y:0,updateRequested:!1}});hs.useEffect((()=>(A.current.updateTimer||(A.current.updateTimer=setInterval((()=>{b(SL(e.anchorDate,e.displayMode,h))}),6e4)),()=>{A.current.updateTimer&&clearInterval(A.current.updateTimer)})));const{anchorDate:T,displayMode:Z,events:E}=e,_=k[$.kCalendarCollapseHours],M=_?k[$.kCalendarDayStarts]:0,P=_&&k[$.kCalendarDayEnds]||24,D=k[$.kCalendarOnlyHourlyKeynav]?60:k[$.kCalendarTimeIncrements];hs.useMemo((()=>{let t=E;y&&e.editingEvent&&(t=E.map((t=>t.id===e.editingEvent?.id?e.editingEvent:t)).filter(Boolean));const n=kL(t,T,Z,M,P,D);p(n.gridColumns),c(n.allDayGrid),g(n.timeCells),f(n.eventCells)}),[T,Z,M,P,E,D,y,e.editingEvent]),hs.useMemo((()=>{const e=SL(T,Z,h);e&&d&&(e.row=e.row+d.rows+1),b(e)}),[T,Z,d,h]);const{gridFrozen:x,handlers:O,overlay:L}=FO(l.current,ZL,TL,e.editingEvent,C),R=()=>{if(A.current.hover.x&&A.current.hover.y){const{currentRow:e,currentCol:t,isAllDayRow:n}=AL(l.current,A.current.hover.x,A.current.hover.y);I(e&&t?{gridColumnStart:parseInt(t.style.gridColumnStart),gridRowStart:n?2:parseInt(e.style.gridRowStart),gridColumnEnd:parseInt(t.style.gridColumnEnd),gridRowEnd:n?parseInt(e.style.gridRowStart):parseInt(e.style.gridRowEnd)||parseInt(e.style.gridRowStart)+1}:null)}A.current.hover.updateRequested=!1},B=e=>{if(e.target!==e.currentTarget||A.current.isResizing)return;const{currentRow:n,currentCol:s,isAllDayRow:i}=AL(l.current,e.clientX,e.clientY);if(n&&s){"click"===e.type&&e.stopPropagation();const o=parseInt(s.dataset.date)+parseInt(n.dataset.starttime);"select"===k[$.kCalendarClickTimeSlot]||"contextmenu"===e.type?t.selectDate(N()(o),i):t.editEvent(null,yL({start:o,allDay:i})),I(null)}},F=!y&&e.editingEvent?{onDragStart:to.ZP}:{...O,onDragOver:e=>{e.dataTransfer.types.some((e=>e===OO))?(A.current.hover.x=e.clientX,A.current.hover.y=e.clientY,A.current.hover.updateRequested||(a(R),A.current.hover.updateRequested=!0),e.preventDefault(),e.stopPropagation()):O.onDragOver(e)},onDrop:e=>{const t=e.dataTransfer;if(t.types.some((e=>e===OO))){e.preventDefault(),e.stopPropagation();const{currentRow:s,currentCol:i,isAllDayRow:o}=AL(l.current,e.clientX,e.clientY);if(s&&i){const e=parseInt(i.dataset.date)+parseInt(s.dataset.starttime),a=JSON.parse(t.getData(OO)).id;("copy"===t.effectAllowed?m.Z.copyEvent:m.Z.moveEvent)(a,{start:e,allDay:o},n)}}else O.onDrop(e)}},{allDaySelected:V,selectedDate:W}=e.filter,U=hs.useCallback((t=>{if(!(t.shiftKey||t.ctrlKey||t.metaKey))if(W){if(!e.editingEvent){const n=HT.Z[t.keyCode],a=t.altKey;switch(n){case"Up":case"Down":case"Left":case"Right":t.preventDefault();const r=a?[]:v,[l,d,c]=function(e,t,n,s,i,o=!1){const a=s.valueOf(),r=t.find((e=>e.isAllDay===o&&e.time.start<=a&&e.time.end>a));if(!r)return[null,null,!1];const l=n.find((e=>e.event&&e.event.id===i||e.events&&e.events.some((e=>e.id===i)))),d=l||r;if(d.events&&("Up"===e||"Down"===e)){const t=d.events.findIndex((e=>e.id===i));if("Up"===e&&t>0||"Down"===e&&t<d.events.length-1){const n="Up"===e?-1:1,s=d.events[t+n];return[r.time&&r.time.start,s,r.isAllDay]}}let c;switch(e){case"Up":case"Down":case"Left":case"Right":c=hL(e,r,l,[...t,...n])}if(c){let n;if(c.time)return[c.time.start,null,c.isAllDay];if(c.event)n=c.event;else if(c.events){const t="Up"===e?c.events.length-1:0;n=c.events[t]}if(n){if(function(e,t){return e.time.start<(t.end||1/0)&&e.time.end>t.start}(r,n))return[r.time&&r.time.start,n,c.isAllDay];let s;if(s=d.isAllDay?function(e,t,n){let s;s="Left"===n?t=>t.navigation.right===e.navigation.right:t=>t.navigation.left===e.navigation.left;const i=t.filter(s).sort(((e,t)=>e.navigation.top-t.navigation.top));return i.length?i[0]:null}(c,[...t],e):hL(e,r,null,[...t]),s&&s.time)return[s.time.start,n,c.isAllDay]}}return[null,null,!1]}(n,u,r,W,e.selectedEvent,V);if(!l){let e;switch(n){case"Left":e=W.clone().subtract(1,"day");break;case"Right":e=W.clone().add(1,"day")}return void(e&&i(e,V))}(d||e.selectedEvent)&&o({event:d,date:N()(l),allDay:c}),d||i(N()(l),c);break;case"Enter":if(t.preventDefault(),e.selectedEvent){const t=E.find((t=>t.id===e.selectedEvent));s(t)}else{const e=W.valueOf();s(null,yL({start:e,allDay:V}))}break;case"Escape":t.preventDefault(),e.selectedEvent&&o({})}I(null)}}else console.error("Can not navigate hour grid. No selected calendar date.")}),[v,u,e.selectedEvent,E,e.editingEvent,V,W,s,i,o]);let H={};if(x)H=x;else{const t="auto ",n=h.reduce(((e,n)=>`${e} ${t.repeat(n)} 16px`),"var(--calendar-hour-column-width) ");H.gridTemplateColumns=n+" [grid-right]";let s="";CL[e.displayMode].row-1&&(s="max-content ");const i=k[$.kCalendarCollapseHours],o=i?k[$.kCalendarDayStarts]:0,a=i&&k[$.kCalendarDayEnds]||24;let r=o>0?`repeat(${4*o}, min-content) `:"";r+=`repeat(${4*(24-o-(24-a))}, auto) `,r+=a<24?`repeat(${4*(24-a)}, min-content) `:"",d?.rows&&(s+=`repeat(${d.rows}, min-content) `),s+=`1.5em ${r} [grid-bottom]`,H.gridTemplateRows=s}return(0,fs.jsxs)("div",{className:As()("calendar-grid calendar-grid-hours",`calendar-grid-${e.displayMode}`,{"is-dragging":y}),ref:l,onKeyDown:U,style:H,tabIndex:"0",draggable:!0,...F,onMouseDown:e=>{e.target instanceof r&&e.target.className.includes("calendar-event-resizer")&&(A.current.isResizing=!0)},onMouseUp:e=>{mL.nextTick((()=>A.current.isResizing=!1))},onMouseMove:e=>{A.current.hover.x=e.clientX,A.current.hover.y=e.clientY,A.current.hover.updateRequested||(a(R),A.current.hover.updateRequested=!0)},onContextMenu:B,onClick:B,children:[vL(ML,{anchorDate:T,displayMode:Z,gridColumns:h,filter:e.filter,inPanel:e.inPanel??!1}),vL(_L,{allDayGrid:d,anchorDate:T,displayMode:Z,filter:e.filter}),S&&vL("div",{className:"calendar-grid-hover",style:S}),vL(PL,{cells:u,editingEvent:e.editingEvent,allDaySelected:e.filter.allDaySelected,selectedDate:e.filter.selectedDate,selectedEvent:e.selectedEvent}),vL(NL,{marker:w}),vL(DL,{cells:v,editingEvent:e.editingEvent,filter:e.filter,isDragging:y,selectedEvent:e.selectedEvent,setIsDragging:C,displayMode:e.filter.displayMode}),vL(EL,{overlay:L,rowOffset:CL[e.displayMode].row+(d&&d.rows+1||0),colOffset:CL[e.displayMode].column,columnSizes:h})]})};var OL;function LL(e,t,n,s){OL||(OL="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:OL,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const RL=[$.kCalendarDisplayWeekNumber];function BL(e){const t=Bd.Z.getCalendars().find((t=>t.id===e.event.calendarId));let n,s;e.event.end&&!e.event.start?(s=Math.max(2,Math.floor((e.event.end-e.startTime)/Lu.lq)),n=s-2):(n=Math.max(0,Math.floor((e.event.start-e.startTime)/Lu.lq)),s=Math.max(Math.min(96,Math.floor((e.event.end-e.startTime)/Lu.lq)),n+1));return LL("line",{stroke:"var(--colorCalendarBg)",style:Rd.Z.getCalendarColorStyles(t),x1:110,x2:110,y1:n,y2:s})}function FL(e){const t=Bd.Z.getCalendars().find((t=>t.id===e.event.calendarId)),n=Math.floor(48-10*(e.count-1)-10)+20*e.index;return LL("line",{stroke:"var(--colorCalendarBg)",x1:10,x2:10,y1:n,y2:n+14,style:Rd.Z.getCalendarColorStyles(t)},e.event.id)}function VL(e){const[t,n]=(0,WO.Z)(Rd.Z.filterEventsByPeriod(e.events,e.day,"day"),Rd.Z.isMultiDayEvent),s=e.day.clone();return LL(hs.Fragment,{},e.day.valueOf(),LL("div",{className:As()("CalendarMonth-Day",{"CalendarMonth-Day--OtherMonth":!e.isSameMonth,"CalendarMonth-Day--Selected":e.isSelected,"CalendarMonth-Day--Highlighted":e.isHighlighted,"CalendarMonth-Day--Current":e.day.isSame(Date.now(),"day"),"CalendarMonth-Day--Weekend":e.day.day()%6==0}),onClick:e.renderMonthDay?Aa.Z:()=>e.onSelect(s)},void 0,e.renderMonthDay&&e.renderMonthDay(e.day),!e.renderMonthDay&&e.day.format("D"),!e.renderMonthDay&&!(!n.length&&!t.length)&&LL("svg",{viewBox:"0 0 120 96"},void 0,n.map((t=>LL(BL,{event:t,startTime:e.day.valueOf()},t.id))),t.map(((e,n)=>LL(FL,{event:e,index:n,count:t.length},e.id))))))}var WL=LL("span",{}),UL=LL("span",{});const HL=function(e){const t=(0,na.Z)(RL),n=e.showWeekNumber&&t[$.kCalendarDisplayWeekNumber],{events:s,month:i,style:o}=e,a=i.clone().startOf("month").startOf("week");let r;if(e.fixedHeight)r=[...Array(42).keys()].map((e=>a.clone().add(e,"day")));else{const e=Rd.Z.getDisplayRange(i,"month");r=Array.from(e.by("day"))}const l=r.slice(0,7);return LL("div",{style:o,className:As()("CalendarMonth",{"CalendarMonth--ShowWeeknumber":n})},i.valueOf(),n&&WL,e.showWeekDays&&l.map((e=>LL("span",{className:"CalendarMonth-DayOfWeek"},`hdr-${e.valueOf()}`,e.format("dd")[0]))),r.map(((t,o)=>{const a=t.isSame(i,"month");return n&&o%7==0?LL(hs.Fragment,{},o,LL("span",{className:"CalendarMonth-Week"},void 0,t.week()),e.showOutOfMonthDays||a?LL(VL,{day:t,events:s,isSelected:!!e.selectedDate&&e.selectedDate.isSame(t,e.highlightMode),isHighlighted:e.highlightedDate?.isSame(t,e.highlightMode)||!1,isSameMonth:a,onSelect:e.onSelect,renderMonthDay:e.renderMonthDay}):UL):e.showOutOfMonthDays||a?LL(VL,{day:t,events:s,isSelected:!!e.selectedDate&&e.selectedDate.isSame(t,e.highlightMode),isHighlighted:e.highlightedDate?.isSame(t,e.highlightMode)||!1,isSameMonth:a,onSelect:e.onSelect,renderMonthDay:e.renderMonthDay},t.valueOf()):LL("span",{},t.valueOf())})))};var zL;function GL(e,t,n,s){zL||(zL="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:zL,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const $L=function(e){const t=hs.useContext(nx),n=hs.useRef(),s=()=>{const e=n.current;if(!e)return 0;const t=!!e.childElementCount&&e.children[0];return t?Math.max(1,Math.floor(e.clientWidth/t.clientWidth)):0},{anchorDate:i,displayMode:o}=e.filter,a=Rd.Z.getDisplayRange(i,o),r=Array.from(a.by("month"));return(0,fs.jsx)("div",{className:`calendar-grid-${e.filter.displayMode} calendar-grid`,onKeyDown:n=>{const i=e.filter.selectedDate;if(!i)return void console.error("Can not navigate month grid. No selected calendar date.");let o,a;switch(HT.Z[n.keyCode]){case"Left":if(0===i.weekday()||1===i.date()){const e=(0,Bu.Xq)(i);o=(0,Bu.FY)(e,6,i.clone().subtract(1,"month"),!0)}else o=i.clone().subtract(1,"day");break;case"Right":if(o=i.clone().endOf("month"),6===i.weekday()||i.isSame(o,"day")){const e=(0,Bu.Xq)(i);o=(0,Bu.FY)(e,0,i.clone().add(1,"month"),!0)}else o=i.clone().add(1,"day");break;case"Up":a=s(),i.date()<8?(o=i.clone().subtract(a,"month"),o=(0,Bu.Ro)(i.weekday(),o)):o=i.clone().subtract(1,"week");break;case"Down":a=s(),o=i.clone().endOf("month"),o.date()-i.date()<7?(o=i.clone().add(a,"month"),o=(0,Bu.PX)(i.weekday(),o)):o=i.clone().add(1,"week")}o&&(o.hour(i.hour()).minute(i.minute()),Gx.Z.selectDate(t.pageId,o))},ref:n,tabIndex:"0",children:r.map((n=>{const s=Rd.Z.filterEventsByPeriod(e.events,n,"month");return GL("div",{},n.valueOf(),GL("p",{className:"month-name"},void 0,n.format("MMMM")),GL(HL,{events:s,month:n,selectedDate:e.filter.selectedDate,showWeekNumber:!0,showWeekDays:!0,onSelect:e=>Gx.Z.selectDate(t.pageId,e),fixedHeight:!1,highlightMode:"day"}))}))})};var KL,jL=n(87852);function YL(e,t,n,s){KL||(KL="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:KL,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const{minimalCreateEvent:XL}=Rd.Z,QL=[$.kCalendarClickTimeSlot],qL="YYYY-MM-DD",JL="!todos";function eR(e,t,n,s=0){const i=s>0?{...n,id:`${n.id}-${s}`}:n,o=e.get(t);Array.isArray(o)?(o.push(i),e.set(t,o)):e.set(t,[i])}const tR=eo()((function(e,t,n){const s=new Map;return e.forEach((e=>{if(e.task)if(e.end){const t=N()(e.end).format(qL);eR(s,t,e)}else eR(s,JL,e);else if(e.start){const i=N()(Math.max(e.start,t)).startOf("day");let o=0;const a=Math.min(e.end,n);for(;i.valueOf()<a||i.valueOf()===e.start;){const t=i.format(qL);eR(s,t,e,o),i.add(1,"day"),o++}}})),s.forEach((e=>e.sort(((e,t)=>e.id&&t.id?e.allDay!==t.allDay?e.allDay?-1:1:e.task&&t.task?(e.end||1/0)-(t.end||1/0):e.start-t.start:e.id?-1:1)))),s}),{maxSize:2});function nR(e,t){return e===jL.Nw||e===jL.Q9&&"agenda"===t}class sR extends hs.Component{static contextType=nx;state={eventGroups:new Map,selectedDate:N()().format(qL)};completedTasks=new Map;static getDerivedStateFromProps=(e,t)=>{const n=Rd.Z.getDisplayRange(e.filter.anchorDate,e.displayMode),s=tR(e.events,n.start.valueOf(),n.end.valueOf());let i="";const o=e.filter.selectedDate?.format(qL)??JL,a=[...s.keys()].sort();for(const e of a)if(!i&&o<=e){i=e;break}return!i&&a.length&&(i=a.pop()),!i&&e.filter.selectedDate&&(i=e.filter.selectedDate.format(qL)),{eventGroups:s,selectedDate:i||JL}};_createDraft=e=>nR(this.context.pageId,this.props.displayMode)?{end:e,task:!0}:{start:e};onClickBackground=(e,t)=>{if(this.props.editingEvent)this.context.handler.endEventEdit();else if(e.target===e.currentTarget){const n=t?N()(t,qL):void 0,s=this._createDraft(n?.valueOf()??0);"select"===this.props.prefValues[$.kCalendarClickTimeSlot]||"contextmenu"===e.type?n&&this.context.handler.selectDate(n,!0):this.context.handler.editEvent(null,XL(s))}};onClickCreate=(e,t)=>{"click"===e.type&&e.stopPropagation();const n=t?t+(new Date).getHours()*Lu.QI:0,s=this._createDraft(n);this.context.handler.editEvent(null,XL(s))};onClickEvent=(e,t)=>{const{editingEvent:n}=this.props;(!n||n&&n.id!==t.id)&&this.context.handler.editEvent(t),e.stopPropagation()};onKeyDown=e=>{const{handler:t}=this.context,n=e.altKey;if(!this.props.editingEvent){const s=Rd.Z.getDisplayRange(this.props.filter.anchorDate,this.props.displayMode),i=this.state.selectedDate,o=Array.from(this.state.eventGroups.keys()).sort();let a,r;switch(HT.Z[e.keyCode]){case"Up":if((0,to.ZP)(e),a=this.state.eventGroups.get(i)||[],r=a.findIndex((e=>e.id===this.props.selectedEvent)),n||0===r||0===a.length){const e=o.findIndex((e=>i===e));if(e<=0&&i!==JL){const e=s.start.clone().subtract(1,"day");Gx.Z.viewPreviousPeriod(this.context.pageId,e)}else if(e>0){const n=o[e-1],s=n===JL?null:N()(n);t.selectDate(s,!0)}}else if(this.props.selectedEvent){const e=a[r-1];t.selectEvent({event:e})}else{const e=a[a.length-1];t.selectEvent({event:e})}break;case"Down":if((0,to.ZP)(e),a=this.state.eventGroups.get(i)||[],r=a.findIndex((e=>e.id===this.props.selectedEvent)),n||-1===r||!this.props.selectedEvent){const e=o.findIndex((e=>i===e));a=this.state.eventGroups.get(o[e+1])||[],e>=o.length-1?Gx.Z.viewNextPeriod(this.context.pageId,s.end.clone().add(1,"day")):a.length&&!n?t.selectEvent({event:a[0]}):t.selectDate(N()(o[e+1]),!0)}else r===a.length-1?t.selectEvent({}):t.selectEvent({event:a[r+1]});break;case"Enter":if((0,to.ZP)(e),this.props.selectedEvent){a=this.state.eventGroups.get(i)||[];const e=a.find((e=>e.id===this.props.selectedEvent));this.context.handler.editEvent(e)}else{const e=nR(this.context.pageId,this.props.displayMode),t=i!==JL&&N()(i),n=t?t.hours((new Date).getHours()).valueOf():0,s=e?{end:n,task:e}:{start:n};this.context.handler.editEvent(null,XL(s))}break;case"Escape":(0,to.ZP)(e),this.props.selectedEvent&&t.selectEvent({})}}};renderEvents=()=>{const e=[],t=this.state.selectedDate,n=Boolean(this.props.filter.filterText),s=[...this.state.eventGroups.keys()].sort();for(const i of s){const o=this.state.eventGroups.get(i)||[],a=t===i,r=i!==JL?N()(i,qL):void 0,l=i===s[s.length-1],d=nR(this.context.pageId,this.props.displayMode);e.push((0,fs.jsxs)("div",{className:"cal-tasks-row",ref:e=>{a&&e&&e.scrollIntoView({block:"nearest",inline:"nearest",behavior:"smooth"})},children:[!!r&&YL("div",{className:As()("cal-tasks-row-date",{current:(0,Bu.KC)(r.toDate(),new Date)})},void 0,YL("span",{className:"cal-tasks-row-dow"},void 0,r?.format("dddd")),YL("span",{className:"cal-tasks-row-doy"},void 0,r?.format("ll"))),YL("div",{className:As()("cal-tasks-row-events",{selected:a})},void 0,o.map((e=>{const t=this.props.selectedEvent?.split("-")[0]===e.id.split("-")[0],s=!!this.props.editingEvent&&this.props.editingEvent.id===e.id;this.completedTasks.has(e.id)&&(e={...e,complete:this.completedTasks.get(e.id)});const i=s&&this.props.editingEvent?this.props.editingEvent:e;let o;return d&&!this.props.filter.showCompletedTasks&&(o=t=>{const n=(0,V.Uy)(e,(e=>{e.complete=t.target.checked}));this.completedTasks.set(n.id,n.complete??!1),n.complete&&setTimeout((()=>{this.completedTasks.get(n.id)&&(m.Z.updateEvent(n,"single",!0,this.context.pageId),this.completedTasks.delete(n.id))}),1500),setTimeout((()=>this.forceUpdate()),0)}),YL("div",{className:As()("event-container",{exiting:this.completedTasks.get(e.id)}),onClick:e=>this.onClickEvent(e,i)},Rd.Z.generateKey(i),YL(NO,{event:i,displayStyle:this.props.eventDisplayStyle,isSelected:t,isEditing:s,isMultiDay:i.allDay,isFiltering:n,multiDayContinuing:!!e.start&&e.start<(r?.valueOf()??-1/0),multiDayContinues:(e.end||0)>(r?.valueOf()??1/0)+Lu.hd,onCompleteChanged:o}))})),!this.props.editingEvent&&(!d||l)&&(0,fs.jsx)("div",{className:As()("calendar-add-event-button",{active:a&&!this.props.selectedEvent,selected:a||d,"task-list":d}),onClick:e=>this.onClickCreate(e,d?0:Date.parse(i)),ref:e=>{a&&!this.props.selectedEvent&&e&&e.scrollIntoViewIfNeeded({block:"nearest",inline:"nearest",behavior:"smooth"})},dangerouslySetInnerHTML:{__html:d?(0,Oe.Z)("Add Task"):Ts.PbG}}))]},i))}return e};renderAddEvent(){const e=0===Bd.Z.getEvents().length,t=nR(this.context.pageId,this.props.displayMode),n=t?0:this.props.filter.anchorDate.valueOf();return YL("div",{className:"cal-tasks-row"},void 0,YL("div",{className:"cal-tasks-row-events selected"},void 0,e&&YL("h2",{},void 0,t?(0,Oe.Z)("Your calendar is empty. Add your first task below!"):(0,Oe.Z)("Your calendar is empty. Add your first event below!")),YL("div",{className:"calendar-add-event-button selected active",onClick:e=>this.onClickCreate(e,n)},void 0,"+")))}render(){return YL("div",{className:`calendar-grid calendar-grid-${this.props.displayMode}`,onKeyDown:this.onKeyDown,onClick:this.onClickBackground,tabIndex:"0"},void 0,0===this.props.events.length&&this.renderAddEvent(),this.renderEvents())}}const iR=sa(sR,QL);var oR;function aR(e,t,n,s){oR||(oR="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:oR,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const{minimalCreateEvent:rR}=Rd.Z;function lR(e,t){if(!t)return!1;const{HTMLElement:n}=e;return t instanceof n&&t.isContentEditable||"function"==typeof t.select}const dR=function(e){const t=hs.useContext(nx),n=hs.useContext(xi.Z),s=hs.useRef(),i=hs.useRef({});i.current={allDaySelected:e.filter.allDaySelected,selectedDate:e.filter.selectedDate,selectedEvent:e.filter.selectedEvent,editingEvent:e.editingEvent};const o=t.pageId===jL.G6||t.pageId===jL.Nw,a=hs.useRef(!!e.editingEvent);hs.useEffect((()=>{a.current=!!e.editingEvent})),hs.useEffect((()=>{function e(e){if(e!==n.vivaldiWindowId)return;const{editingEvent:s,selectedDate:a}=i.current,{area:r}=ee.Z.getContext(e);if(s||o!==("panel"===r))return;const l=a?a.clone().startOf("day").valueOf()+(new Date).getHours()*Lu.QI:0;t.handler.editEvent(null,rR({start:l}))}return tl.Z.addListener("COMMAND_CALENDAR_CREATE_EVENT",e),()=>{tl.Z.removeListener("COMMAND_CALENDAR_CREATE_EVENT",e)}}),[o,n,t.handler]);const r=hs.useCallback((()=>{const n=e.trashedEvents.sort(((e,t)=>(e.trash_time||0)-(t.trash_time||0))).slice(-1);n.length&&m.Z.restoreEvent(t.pageId,n[0])}),[t.pageId,e.trashedEvents]),l=hs.useCallback(((e,t)=>{const o=n.document.getSelection(),a=n.document.activeElement,{selectedEvent:r,editingEvent:l}=i.current,d=r||l?.id;if(d&&(!o||o.isCollapsed)&&s.current?.contains(a)){const{clipboardData:n}=e;if(!n)throw new Error("No clipboardData on copy event");e.preventDefault();const s=Bd.Z.getEvent(d);if(!s)return void et.Z.warn("Calendar",`Event to copy (id: ${d}) not found`);n.setData("text/plain",s.title),n.setData(OO,d),n.setData("vivaldi/x-cut",t)}}),[n.document]),d=hs.useCallback((e=>{l(e,"true")}),[l]),c=hs.useCallback((e=>{l(e,"false")}),[l]),{pageId:h}=t,{document:p}=n,u=hs.useCallback((async e=>{if(s.current?.contains(p.activeElement)){const{clipboardData:n}=e;if(!n)throw new Error("No clipboardData on paste event");const{allDaySelected:s,selectedDate:o,editingEvent:a}=i.current;if(a)return;(0,to.ZP)(e);const r=n.getData(OO),l=o?.valueOf()??0;if(r){const e=s,i="true"===n.getData("vivaldi/x-cut")?m.Z.moveEvent:m.Z.copyEvent,o=await i(r,{start:l,byDateOnly:e},t.pageId);a?t.handler.editEvent(o):Gx.Z.selectEvent(h,{event:o})}else{const e=n.getData("text/plain");e&&t.handler.editEvent(null,rR({title:e,start:l}))}}}),[p,h,t.handler,t.pageId]),g=s.current;hs.useEffect((()=>{if(g)return Di.Z.bind("ctrl+z",r,{feature:"calendar"}),p.addEventListener("cut",d),p.addEventListener("copy",c),p.addEventListener("paste",u),()=>{Di.Z.unbind("ctrl+z",r),p.removeEventListener("cut",d),p.removeEventListener("cut",c),p.removeEventListener("paste",u)}}),[p,g,r,d,c,u]);const v=e.displayMode||e.filter.displayMode,f=Rd.Z.getDefaultCalendar();return(0,fs.jsxs)("div",{ref:s,className:"calendar-viewport outerScrollbar",onContextMenu:t=>{const{HTMLElement:s}=n,i=t.currentTarget.closest(".calendar-grid");i&&i!==p.activeElement&&i instanceof s&&i.focus(),(0,Qi.Z)(n,(()=>{const t=[{handler:()=>yi.Z.paste(n.vivaldiWindowId),...(0,xs.Z)("verb","Paste")}];return e.trashedEvents.length&&t.push({handler:r,...(0,xs.Z)("Restore Event from Trash")}),t})())(t)},onFocus:e.onFocus,onKeyDown:s=>{const{editingEvent:i,filter:o}=e,a=s.ctrlKey;if(i)switch(HT.Z[s.keyCode]){case"Escape":t.handler.cancelEventEdit();break;case"Del":case"Backspace":a&&!lR(n,s.target)&&m.Z.trashEvent(i.id)}else switch(HT.Z[s.keyCode]){case"Del":case"Backspace":o.selectedEvent&&m.Z.trashEvent(o.selectedEvent),s.preventDefault(),s.stopPropagation()}},style:Rd.Z.getCalendarColorStyles(f),children:[aR("style",{},void 0,Rd.Z.getCalendarColors()),("day"===v||"week"===v&&!o)&&aR(xL,{anchorDate:e.anchorDate||e.filter.anchorDate,filter:e.filter,events:e.events,displayMode:v,selectedEvent:e.filter.selectedEvent,editingEvent:e.editingEvent,inPanel:o}),("week"===v&&o||"multiweek"===v||"month"===v)&&aR(dL,{filter:e.filter,events:e.events,displayMode:v,selectedEvent:e.filter.selectedEvent,editingEvent:e.editingEvent}),"year"===v&&aR($L,{filter:e.filter,events:e.events}),"agenda"===v&&aR(iR,{filter:e.filter,events:e.events,displayMode:v,eventDisplayStyle:e.eventDisplayStyle||"transparent",selectedEvent:e.filter.selectedEvent,editingEvent:e.editingEvent})]})};var cR;function hR(e,t,n,s){cR||(cR="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:cR,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const pR=e=>{const{event:t}=e,{getContextMenu:n}=$x(t),s=hs.useRef(),i=hs.useContext(xi.Z),{document:o,getSelection:a}=i,r=hs.useContext(nx),l=r.handler.updateEventEdit,c=r.handler.saveEventEdit,h=!!e.checkboxes,p=h&&!e.editTemplate,u=e.checkboxes??{};hs.useEffect((()=>{const t=s.current,n=a();if(t&&n&&!e.checkboxes){t.focus();const e=o.createRange();e.selectNodeContents(t),e.collapse(!1),n.removeAllRanges(),n.addRange(e)}}),[o,a,e.checkboxes]);const g={updateEvent:l,saveEventEdit:c,event:t,tabIndex:0},v=t=>n=>{const{value:s}=n.currentTarget;l(Qx(e.event,t,s)),e.enableProperty&&e.enableProperty("time")},f=t=>n=>{const{value:s}=n.currentTarget;l(qx(e.event,t,s)),e.enableProperty&&e.enableProperty("time")};const{start:y,end:C}=(0,Bu.aE)(t),w=!(t.start||t.end||h),b=h&&t.allDay;return hR("div",{className:"CalendarEventFull",onContextMenu:e=>{lR(i,e.target)?e.stopPropagation():(0,Qi.Z)(i,n())(e)},style:{backgroundImage:Ts._9b},onClick:to.UW},void 0,(!p||u.title)&&hR("div",{className:"CalendarEventFull-Row"},void 0,hR("span",{className:"CalendarEventFull-Icon",dangerouslySetInnerHTML:{__html:Ts.qHs}}),(0,fs.jsx)(zx,{...g,field:"title",label:(0,Oe.Z)("Title"),focusRef:s,readOnly:p}),u.title),(!p||u.description)&&hR("div",{className:"CalendarEventFull-Row CalendarEventFull-Row--NoIcon"},void 0,(0,fs.jsx)(zx,{...g,field:"description",label:(0,Oe.Z)("Description"),readOnly:p}),u.description),(!p||u.time)&&!b&&!t.task&&(0,fs.jsx)(fs.Fragment,{children:hR("div",{className:"CalendarEventFull-Row"},void 0,hR("span",{className:"CalendarEventFull-Icon",dangerouslySetInnerHTML:{__html:Ts.zTz}}),hR("div",{className:"edit-group"},void 0,!h&&hR(WT,{onChange:f("start"),title:(0,Oe.Z)("Event Start Date"),value:y.format("YYYY-MM-DD")}),!t.allDay&&hR(_g,{onChange:v("start"),step:"5",title:(0,Oe.Z)("Event Start Time"),value:y.format("HH:mm")}),"–",!t.allDay&&hR(_g,{onChange:v("end"),step:"5",title:(0,Oe.Z)("Event End Time"),value:C.format("HH:mm")}),!h&&hR(WT,{onChange:f("end"),title:(0,Oe.Z)("Event End Date"),value:C.format("YYYY-MM-DD")})),u.time)}),(!p||u.time)&&t.task&&hR("div",{className:"CalendarEventFull-Row"},void 0,hR("span",{className:"CalendarEventFull-Icon",dangerouslySetInnerHTML:{__html:Ts.zTz}}),hR("div",{className:"CalendarEventFull-TaskTime edit-group"},void 0,hR(Px,{type:"start",view:"dialog",event:t,updateEvent:l,onDateChange:f("start"),onTimeChange:v("start")}),(!!t.start||!!t.end)&&"–",hR(Px,{type:"due",view:"dialog",event:t,updateEvent:l,onDateChange:f("end"),onTimeChange:v("end")})),u.time),u.duration&&hR("div",{className:As()("CalendarEventFull-Row",{"CalendarEventFull-Row--NoIcon":!b})},void 0,b&&hR("span",{className:"CalendarEventFull-Icon",dangerouslySetInnerHTML:{__html:Ts.zTz}}),hR(ox,{event:t,updateEvent:function(t){e.enableProperty&&e.enableProperty("duration"),l(t)}}),u.duration),(!p||u.allDay)&&(!t.task||!!t.end)&&hR("div",{className:"CalendarEventFull-Row CalendarEventFull-Row--NoIcon"},void 0,hR("div",{className:"edit-group"},void 0,hR("label",{},void 0,hR("input",{type:"checkbox",checked:!!t.allDay,onChange:function(t){l({...e.event,allDay:t.currentTarget.checked})}}),hR("span",{},void 0,(0,Oe.Z)("All Day")))),u.allDay),(!p||u.timezone)&&(!t.task||!!t.end)&&hR("div",{className:"CalendarEventFull-Row CalendarEventFull-Row--NoIcon"},void 0,hR("div",{className:"edit-group"},void 0,hR("label",{},void 0,hR("select",{disabled:!!t.allDay,onChange:t=>{const{value:n}=t.currentTarget;n!==e.event.timezone&&l((0,Bu.bn)({...e.event},n))},value:t.allDay?Lu.$T:t.timezone},void 0,Xx()))),u.timezone),(!p||u.task)&&hR("div",{className:"CalendarEventFull-Row"},void 0,hR("span",{className:"CalendarEventFull-Icon",dangerouslySetInnerHTML:{__html:Ts._9b}}),hR("div",{className:"edit-group"},void 0,hR("label",{},void 0,hR("input",{type:"checkbox",checked:!!t.task,onChange:function(t){l({...e.event,task:t.currentTarget.checked})}}),hR("span",{},void 0,(0,Oe.Z)("Is a Task"))),!h&&hR("label",{},void 0,hR("input",{disabled:!t.task,type:"checkbox",checked:!!t.complete,onChange:function(t){l({...e.event,complete:t.currentTarget.checked})}}),hR("span",{},void 0,(0,Oe.Z)("Complete")))),u.task),(!p||u.location)&&hR("div",{className:"CalendarEventFull-Row"},void 0,hR("span",{className:"CalendarEventFull-Icon",dangerouslySetInnerHTML:{__html:Ts.GF3}}),(0,fs.jsx)(zx,{...g,field:"location",label:(0,Oe.Z)("other","Location"),readOnly:p}),u.location),(!p||u.recurrence)&&hR("div",{className:"CalendarEventFull-Row"},void 0,hR("span",{className:"CalendarEventFull-Icon CalendarEventFull-Icon--WithInput",dangerouslySetInnerHTML:{__html:Ts.Eki}}),hR("div",{className:"CalendarEventFull-RowContent"},void 0,!w&&(0,fs.jsx)(eZ,{...g,field:"recurrence",label:"recurrence"}),w&&hR("div",{className:"edit-group capped-width"},void 0,hR("span",{className:"info"},void 0,(0,Oe.Z)("Task without time can not recur.")))),u.recurrence),(!p||u.url)&&hR("div",{className:"CalendarEventFull-Row"},void 0,hR("span",{className:"CalendarEventFull-Icon",dangerouslySetInnerHTML:{__html:Ts.wTH}}),(0,fs.jsx)(zx,{...g,field:"url",label:(0,Oe.Z)("URL"),readOnly:p}),u.url),!p&&t.attachment&&t.attachment.length>0&&hR("div",{className:"CalendarEventFull-Row"},void 0,hR("span",{className:"CalendarEventFull-Icon",dangerouslySetInnerHTML:{__html:Ts.onv}}),t.attachment.map((e=>hR("div",{className:"CalendarEventFull-Attachment"},e.url,hR("a",{onClick:()=>d.ZP.openURL(i.vivaldiWindowId,e.url),title:e.url},void 0,e.filename||e.url))))),(!p||u.reminders)&&hR("div",{className:"CalendarEventFull-Row"},void 0,hR("span",{className:"CalendarEventFull-Icon CalendarEventFull-Icon--WithInput",dangerouslySetInnerHTML:{__html:Ts.PPL}}),hR("div",{className:"CalendarEventFull-RowContent"},void 0,hR(bx,{event:t,updateEvent:l,readOnly:p})),u.reminders),(!p||u.participants)&&!t.task&&hR("div",{className:"CalendarEventFull-Row"},void 0,hR("span",{className:"CalendarEventFull-Icon CalendarEventFull-Icon--WithInput",dangerouslySetInnerHTML:{__html:Ts.Rs2}}),hR("div",{className:"CalendarEventFull-RowContent"},void 0,(0,fs.jsx)(_x,{...g,field:"attendees",label:(0,Oe.Z)("Type to add Participants"),readOnly:p})),u.participants),(!p||u.calendar)&&hR("div",{className:"CalendarEventFull-Row"},void 0,hR("span",{className:"CalendarEventFull-Icon CalendarEventFull-Icon--WithInput",dangerouslySetInnerHTML:{__html:Ts.fIz}}),hR("div",{className:"CalendarEventFull-RowContent"},void 0,Gu(t,(e=>{h||m.Z.setDefaultCalendarId(e,t.task),l({...t,calendarId:e})}),0)),u.calendar),!h&&hR("div",{className:"CalendarEventFull-Row CalendarEventFull-Row--NoIcon"},void 0,hR(Bx,{event:t,updateEvent:l})),""===t.id&&t.filteredOut&&hR(tc,{type:"warning"},void 0,t.task?(0,Oe.Z)("Once saved this task will be hidden by current search"):(0,Oe.Z)("Once saved this event will be hidden by current search")))};var uR;function gR(e,t,n,s){uR||(uR="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:uR,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const mR={title:"title",description:"description",allDay:"allDay",timezone:"timezone",task:"task",location:"location",rrule:"recurrence",url:"url",notifications:"reminders",invites:"participants",calendarId:"calendar"},vR={selectDate:Aa.Z,selectEvent:e=>{},editEvent:(e,t)=>Promise.resolve(),updateEventEdit:e=>{},saveEventEdit:Promise.resolve,endEventEdit:e=>Promise.resolve(),cancelEventEdit:Aa.Z};function fR(e){const[t,n]=(0,hs.useState)({...e.event}),[s,i]=(0,hs.useState)(e.name),[o,a]=(0,hs.useState)(e.properties),r=(0,hs.useContext)(nx),{edit:l=!0,templateId:d,setSaveTemplate:c}=e,h=(0,hs.useRef)();function p(e,n){if(o.hasOwnProperty(e)){const i={...o,[e]:n};return a(i),h.current=(0,xx.tL)(t,i),h.current.name=s,i}return o}(0,hs.useEffect)((()=>{h.current=function(e,t,n){return{...(0,xx.tL)(e,t),name:n}}(e.event,e.properties,e.name)}),[e.event,e.properties,e.name]),(0,hs.useEffect)((()=>{n({...e.event}),a({...e.properties}),i(e.name)}),[e.name,e.properties,e.event]),(0,hs.useEffect)((()=>{c((function(){if(h.current){if(!h.current.name)throw new Error((0,Oe.Z)("Please name the template"));if(Object.keys(h.current).length<=1)throw new Error((0,Oe.Z)("No property selected. Please select at least one to save template."));d?m.Z.updateTemplate(d,h.current):m.Z.createEventTemplate(h.current)}}))}),[c,d]);const u={...vR,updateEventEdit:e=>{let i=o;for(const n of Object.keys(mR))t[n]!==e[n]&&(i=p(mR[n],!0));const a={...e};n(a),h.current=(0,xx.tL)(a,i),h.current.name=s}};function g(e){p(e.target.id,e.target.checked)}let v;for(const e in o){if(!l&&!o[e])continue;const n=!l||"timezone"===e&&t.allDay;v={...v,[e]:gR(fb,{inputId:e,checked:!!o[e],disabled:n,onChange:g})}}const f={...r,handler:u},y=!!d;return gR("fieldset",{className:"detail-content",disabled:!l},void 0,l&&gR("label",{className:"floating-label"},void 0,gR("span",{},void 0,(0,Oe.Z)("Template name")),gR("input",{value:s,name:"name",onChange:function(e){const t=e.target.value;h.current&&(h.current.name=t),i(t)},type:"text"})),!y&&gR("p",{className:"info"},void 0,(0,Oe.Z)("Select the properties you want to include in the template. Any changes you make will not be saved to the original event.")),gR(nx.Provider,{value:f},void 0,gR(pR,{event:t,checkboxes:v,editTemplate:l,enableProperty:e=>{p(e,!0)}})))}var yR;function CR(e,t,n,s){yR||(yR="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:yR,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const wR={id:"",calendarId:"",title:"",start:0,end:0};function bR(e){const[t,n]=(0,hs.useState)(!e.templateId),[s,i]=(0,hs.useState)(""),o=(0,hs.useRef)(Aa.Z),a=(0,hs.useMemo)((()=>{const t=((0,Bu.FL)(new Date).getHours()+1)*Lu.QI,n=t+H.Z.get($.kCalendarDefaultDuration);return(0,xx.$u)(e.template,{...wR,start:t,end:n})}),[e.template]),r=(0,hs.useMemo)((()=>(0,xx.e$)(e.template)),[e.template]);(0,hs.useEffect)((()=>{n(!e.templateId)}),[e.templateId]);const l=(0,hs.useCallback)((e=>{o.current=e}),[]);return CR("form",{className:"detail edit-template"},void 0,CR(fR,{templateId:e.templateId,name:e.template.name,event:a,properties:r,setSaveTemplate:l,edit:t}),s&&CR(tc,{type:"error"},void 0,s),CR("div",{className:"detail-toolbar"},void 0,CR("input",{type:"button",value:t?(0,Oe.Z)("Save"):(0,Oe.Z)("verb","Edit"),onClick:t?async function(e){i("");try{o.current()}catch(e){i(e.message)}}:function(){n(!0)}})))}var SR,IR=n(41851);function kR(e,t,n,s){SR||(SR="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:SR,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const AR=n(28888),TR={},ZR={"Add your First Event Template":(0,Oe.Z)("Add your First Event Template"),"Press the “Add” button to the left to add a new template.":(0,Oe.Z)("Press the “Add” button to the left to add a new template.")};function ER(e,t){return kR("div",{className:"item-title"},void 0,t.name)}var _R,MR=kR("div",{className:"item-meta"},void 0," ");function NR(){return(0,fs.jsxs)(fs.Fragment,{children:[kR("div",{className:"item-title"},void 0,(0,Oe.Z)("New Template")),MR]})}function PR(e){return kR("div",{className:"detail"},void 0,kR("div",{className:"detail-content"},void 0,kR("h3",{},void 0,ZR["Add your First Event Template"]),kR("p",{},void 0,ZR["Press the “Add” button to the left to add a new template."])))}function DR(e){const{templates:t}=xT(Bd.Z),n=(0,hs.useRef)(""),[s,i]=(0,hs.useState)({id:""}),o=(0,hs.useMemo)((()=>(n.current="",t.map((e=>({...e,key:e.id}))))),[t]);return kR(mN,{categoryTitle:(0,Oe.Z)("Event Templates"),filter:e.filter},void 0,kR(xD.Z,{className:"giant",deleteTitle:(0,Oe.Z)("Delete Template"),onRemove:function(e){const n=t[e]?.id;m.Z.removeTemplate(n)},addTipString:(0,Oe.Z)("Add Template"),deleteTipString:(0,Oe.Z)("Delete Template"),emptyListGraphic:AR,emptyListString:(0,Oe.Z)("No Templates added"),filter:e.filter,items:o,masterLayout:1,renderListItem:ER,renderCreateListItem:NR,renderContent:function(e,o){const a=t[e]?.id;if(n.current!==a)return n.current=a,IR.Z.loadTemplate(a).then((e=>{e&&i({id:a,template:e})})),null;const{template:r}=s;return r?kR(bR,{templateId:a,template:r}):null},renderCreate:function(e){return kR(bR,{templateId:"",template:{name:(0,Oe.Z)("New Template")}})},renderEmpty:PR,contentStrings:TR,emptyStrings:ZR,createStrings:TR}))}function xR(e,t,n,s){_R||(_R="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:_R,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const OR=function(e){const[t,n]=hs.useState(""),[s,i]=hs.useState(""),{item:o,onClose:a,onDeleteInProgress:r}=e,l=t===o.id,{account:d}=Rd.Z.getAccountAndCalendar(o.id);return xR("div",{},void 0,xR("header",{className:"dialog-header"},void 0,xR("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("Are you sure you want to delete the calendar ‘$1’ and its events?",[o.description]))),xR("div",{className:"dialog-content"},void 0,"local"===d?.account_type&&xR("p",{},void 0,(0,Oe.Z)("This will permanently delete your local calendar and associated events. It can not be undone.")),"ical"===d?.account_type&&xR("p",{},void 0,(0,Oe.Z)("This will not delete any data on the remote server. You can set it up again if you later want to use it in Vivaldi.")),d&&Rd.Z.isCalDAV(d.account_type)&&xR("p",{},void 0,(0,Oe.Z)("This will permanently delete the calendar on the remote server. It can not be undone. You can use the calendar settings to disable sync or hide the calendar.")),s&&xR(tc,{type:"error"},void 0,s)),xR("footer",{className:"dialog-footer"},void 0,xR("input",{type:"button",className:"danger",disabled:l,onClick:async()=>{r(!0),n(o.id);const e=await m.Z.deleteCalendar(o,!0);!1===e.status?i(e.message):(n(""),r(!1))},value:l?(0,Oe.Z)("Deleting Calendar"):(0,Oe.Z)("verb","Delete"),autoFocus:!0}),xR("input",{type:"button",onClick:a,disabled:l,value:(0,Oe.Z)("Cancel")})))};var LR;function RR(e,t,n,s){LR||(LR="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:LR,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class BR extends hs.Component{nodeRef=hs.createRef();state={originalColor:this.props.color};_abort=()=>{this.props.setColor(B()(this.state.originalColor),this.props.name,!1)};onSystemPickerChange=e=>{const t=e.currentTarget.value.trim();t.length<=3&&this.props.setColor(B()(t),this.props.name)};onSystemPickerKeyDown=e=>{"Escape"===e.key?(e.preventDefault(),this._abort()):"Enter"===e.key&&this.onSystemPickerChange(e)};render(){return RR("input",{type:"color",title:(0,Oe.Z)("Show system color picker"),className:"colorpicker-system",value:`#${this.props.color}`,onKeyDown:this.onSystemPickerKeyDown,onChange:this.onSystemPickerChange})}}const FR=BR;var VR;function WR(e,t,n,s){VR||(VR="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:VR,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function UR({className:e}){return WR("span",{className:e,dangerouslySetInnerHTML:{__html:Ts.V34}})}var HR=WR(UR,{className:"VivaldiDropdown-SelectedValue-Arrow"});function zR({item:e}){return WR("span",{className:"VivaldiDropdown-SelectedValue"},void 0,e&&e.icon&&WR("img",{src:e.icon,className:"VivaldiDropdown-SelectedValue-Icon"}),e&&e.faviconUrl&&WR(Ss,{url:e.faviconUrl,className:"VivaldiDropdown-SelectedValue-Icon",loadType:"faviconFromCache"}),e&&WR("span",{className:"VivaldiDropdown-SelectedValue-Title"},void 0,e.name),HR)}var GR=WR(UR,{className:"VivaldiDropdown-SelectedValue-Arrow"}),$R=WR(UR,{className:"VivaldiDropdown-SelectedValue-Arrow"});class KR extends hs.Component{refButton=hs.createRef();state={isExpanded:!1};onItemActivated=({id:e})=>{this.props.onValueChange(e),this.collapse()};collapse=()=>{this.setState({isExpanded:!1}),this.focus()};toggle=e=>{(0,to.ZP)(e),this.setState((e=>({isExpanded:!e.isExpanded})))};handleKeyDown=e=>{switch(e.which){case oa.Z.KEY_UP:case oa.Z.KEY_DOWN:this.setState({isExpanded:!0})}};focus=()=>{this.refButton.current?.focus()};render(){const e=this.props.items.find((e=>e.id===this.props.value));return WR("div",{className:As()("VivaldiDropdown",this.props.className)},void 0,(0,fs.jsx)("button",{type:"button",ref:this.refButton,disabled:this.props.disabled,onMouseDown:this.toggle,title:this.props.tooltip,className:As()("VivaldiDropdown-Button",{"VivaldiDropdown-Button--isActive":this.state.isExpanded}),onKeyDown:this.handleKeyDown,children:this.props.hideButtonText?GR:this.props.placeholder&&!e?WR("div",{className:"VivaldiDropdown-Placeholder"},void 0,WR("p",{},void 0,this.props.placeholder),$R):WR(zR,{item:e||this.props.items[0]})}),this.state.isExpanded&&WR(zb,{className:"VivaldiDropdown-DropdownMenu",items:this.props.items,onClose:this.collapse,onItemActivated:this.onItemActivated,selectedItem:e}))}}const jR=KR;var YR;function XR(e,t,n,s){YR||(YR="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:YR,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const QR=/^([0-9a-f]{3}){1,2}$/i;var qR=XR("span",{className:"ColorEditor-HexTextInput-Octothorpe"},void 0,"#");class JR extends hs.Component{refColorToggle=hs.createRef();constructor(e){super(e),this.state={color:e.colorValue.substring(1)},this.debouncedSetColor=(0,no.Z)(this.props.setColor,100,{leading:!1}),e.predefinedColors&&(this.dropdownColors=e.predefinedColors.map((e=>({type:"Normal",name:e.name,iconSVG:this.createColorIcon(e.value),noPrettifying:!0,id:e.value}))))}createColorIcon=e=>`<svg width="16" height="16" viewBox="0 0 16 16">\n      <rect x="0" y="0" width="16" height="16" rx="2" ry="2" fill="${e}" />\n    </svg>`;hexInputEvents=e=>{let t=e.currentTarget.value;if("#"===t.charAt(0)&&(t=t.substring(1)),t.length>6&&(t=t.substring(0,6)),this.setState({color:t}),QR.test(t)){const e=B()(t);e&&this.props.setColor(e,this.props.colorKey)}};onColorPicked=(e,t,n=!1)=>{this.setState({color:e.hex().substring(1)}),n?this.debouncedSetColor(e,t):this.props.setColor(e,t)};onDropdownColorSelected=e=>{const t=B()(e);t&&(this.setState({color:t.hex().substring(1)}),this.props.setColor(t,this.props.colorKey))};render(){const e=this.props.colorKey,t=this.props.predefinedColors&&this.props.predefinedColors.length>0;let{color:n}=this.state;return QR.test(n)||(n=this.props.colorValue.replace("#","")),XR("div",{className:As()("ColorEditor",{"with-dropdown":t})},void 0,this.props.label&&XR("label",{htmlFor:e,className:"color-name"},void 0,this.props.label),XR("div",{className:"ColorEditor-ColorPickerContainer"},void 0,XR(FR,{name:e,color:n,setColor:this.onColorPicked},e),t&&XR(jR,{className:"ColorEditor-VivaldiDropdown",disabled:this.props.disabled,items:this.dropdownColors,onValueChange:this.onDropdownColorSelected,tooltip:(0,Oe.Z)("Choose a Color"),value:n,hideButtonText:!0})),XR("div",{className:"ColorEditor-HexTextInput"},void 0,qR,XR("input",{className:"ColorEditor-HexTextInput-InputField",type:"text",id:e,disabled:this.props.disabled,value:this.state.color,spellCheck:"false",onChange:this.hexInputEvents})))}}const eB=JR;var tB;function nB(e,t,n,s){tB||(tB="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:tB,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var sB=nB("input",{type:"radio",value:"all"}),iB=nB("input",{type:"radio",value:"vevent"}),oB=nB("input",{type:"radio",value:"vtodo"});class aB extends hs.PureComponent{static defaultProps={searchableStrings:{Events:"Events",Tasks:"Tasks"}};constructor(e){super(e)}onChangeCalendarComponent=e=>{const t={...this.props.supportedCalendarComponent},{value:n}=e.target;"all"===n?(t.vtodo=!0,t.vevent=!0):(t.vtodo="vtodo"===n,t.vevent="vevent"===n),this.props.updateCalendarComponent(t)};getSupportedComponent(){const{vevent:e,vtodo:t}=this.props.supportedCalendarComponent;return e&&t?"all":e?"vevent":"vtodo"}render(){return nB("div",{className:"setting-group"},void 0,nB("h3",{},void 0,(0,Oe.Z)("Allowed Calendar Items")),nB(vl,{name:"calendar-density",value:this.getSupportedComponent(),onChange:this.onChangeCalendarComponent,className:"group",disabled:this.props.disabled},void 0,nB("div",{className:"setting-single"},void 0,nB("label",{},void 0,sB,nB("span",{},void 0,(0,Oe.Z)("calendar","All")))),nB("div",{className:"setting-single"},void 0,nB("label",{},void 0,iB,nB("span",{},void 0,(0,Oe.Z)("calendar","Events Only")))),nB("div",{className:"setting-single"},void 0,nB("label",{},void 0,oB,nB("span",{},void 0,(0,Oe.Z)("Tasks Only"))))))}}const rB=aB;const lB=async function(e,{showSaveFilePicker:t}){const n=Bd.Z.getCalendars().find((t=>t.id===e)),{description:s=(0,Oe.Z)("Events")}=n||{};try{!async function(e,t){if(!e)return;const n=[...Bd.Z.getEventsPerCalendar(t)];n.forEach((e=>{e.recurrenceExceptions?.length&&e.recurrenceExceptions.forEach((t=>{const s=n.findIndex((e=>e.id===t.exception_event_id));-1!==s&&(n[s]={...n[s],recurrenceId:t.date,sequence:e.sequence})}))}));const s=Rd.Z.eventsToICalendar(n);try{const t=await e.createWritable();await t.write(s),await t.close()}catch(e){et.Z.error("Calendar",["export"],"Exporting events failed.",e)}}(await t({suggestedName:`${s}.ics`,types:[{description:(0,Oe.Z)("iCalendar file"),accept:{"text/calendar":[".ics"]}}]}),e)}catch(e){et.Z.error("Calendar",["export"],"Error opening filepicker",e)}};var dB;function cB(e,t,n,s){dB||(dB="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:dB,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const{isLocalCalendar:hB}=Rd.Z,{UNKNOWN:pB,OK:uB,ERROR:gB}=Lu.LB;class mB extends hs.Component{static contextType=xi.Z;state={status:pB,statusText:"",calendar:this.props.calendar};isCalendarChanged=()=>{const e=this.props.calendar;if(!e)return!1;const t=this.state.calendar;return!(0,xA.Z)(t,e)};setCalendarProperty=e=>{this.setState((t=>({calendar:{...t.calendar,...e}})))};onChange=e=>{const{name:t,value:n}=e.target,s={},i="iconindex"===t?isNaN(n)?0:parseInt(n):n;s[t]=i,this.setCalendarProperty(s)};logStatus=(e,t)=>{this.setState({status:t,statusText:e})};saveCalendar=()=>{this.state.calendar.description?this.props.save(this.state.calendar):this.setState({statusText:(0,Oe.Z)("Calendar Name cannot be empty")})};setColor=(e,t,n=!1)=>{this.setCalendarProperty({color:e.hex()})};onChangeCheckbox=e=>{const{checked:t,name:n}=e.target;this.setCalendarProperty({[n]:t})};onChangeCalendarComponent=e=>{this.setCalendarProperty({supportedCalendarComponent:e})};exportCalendar=e=>{lB(this.state.calendar.id,this.context)};render(){const{description:e,hidden:t,active:n,id:s,supportedCalendarComponent:i}=this.state.calendar,{disabledProperties:o,searchableStrings:a}=this.props,r=Rd.Z.getCalendarColor(this.state.calendar),l=this.state.status===gB?"error":this.state.status===uB?"success":"info";return cB("form",{className:"detail",onSubmit:this.saveCalendar},void 0,cB("div",{className:"detail-content"},void 0,cB("div",{className:"setting-group"},void 0,cB("div",{className:"setting-single"},void 0,cB(sc.Z,{type:"text",onChange:this.onChange,name:"description",label:a["Calendar Name"],value:e,disabled:o.includes("name")})),cB("div",{className:"setting-single"},void 0,cB("label",{},void 0,cB("input",{type:"checkbox",name:"hidden",checked:t,onChange:this.onChangeCheckbox}),cB("span",{},void 0,a["Hide from Calendar View"])))),cB("div",{className:"setting-group"},void 0,cB("div",{className:"setting-single"},void 0,cB(eB,{label:a.Color,colorKey:"color",colorValue:r,setColor:this.setColor,predefinedColors:$D.h,disabled:o.includes("color")}))),!hB(s)&&cB("div",{className:"setting-group"},void 0,cB("h3",{},void 0,(0,Oe.Z)("Sync Calendar")),cB("div",{className:"setting-single"},void 0,cB("label",{title:(0,Oe.Z)("Active")},void 0,cB("input",{type:"checkbox",name:"active",checked:n,onChange:this.onChangeCheckbox}),cB("span",{},void 0,a.Active)))),cB(rB,{supportedCalendarComponent:i,updateCalendarComponent:this.onChangeCalendarComponent,searchableStrings:this.props.searchableStrings,disabled:!hB(s)}),this.state.statusText&&cB("div",{className:"setting-group-double"},void 0,cB(tc,{type:l},void 0,this.state.statusText))),cB("div",{className:"detail-toolbar"},void 0,cB("input",{type:"submit",value:(0,Oe.Z)("Save"),disabled:!this.isCalendarChanged()}),cB("input",{type:"button",onClick:this.exportCalendar,value:(0,Oe.Z)("Export Calendar")})))}}const vB=mB;var fB;function yB(e,t,n,s){fB||(fB="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:fB,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const{isCalendarValidToCreate:CB}=Rd.Z,{getCalendarCreateParams:wB}=hD.Z;class bB extends hs.PureComponent{state={calendar:wB(),statusText:"",status:"info"};setColor=(e,t,n=!1)=>this.setCalendarProperty(t,e.hex());onAccountChange=e=>{this.setCalendarProperty("accountId",e.target.value)};onCalendarChange=e=>{const{name:t,value:n}=e.target,s="iconindex"===t?isNaN(n)?0:parseInt(n):n;this.setCalendarProperty(t,s)};setCalendarProperty=(e,t)=>this.setState((n=>({calendar:{...n.calendar,[e]:t},status:"info",statusText:""})));createCalendar=async()=>{this.setState({status:"info",statusText:(0,Oe.Z)("Creating calendar")});const e=await this.props.createCalendar(this.state.calendar);e.result.status||this.setState({status:"error",statusText:e.result.message})};isCalendarValidToCreate=()=>CB(this.state.calendar);onChangeCalendarComponentS=e=>{this.setState((t=>({calendar:{...t.calendar,supportedCalendarComponent:e}})))};render(){const{color:e,description:t,accountId:n,supportedCalendarComponent:s}=this.state.calendar,i=Bd.Z.getAccounts().filter((e=>"ical"!==e.account_type));return yB("form",{className:"detail",onSubmit:this.createCalendar},void 0,yB("div",{className:"detail-content"},void 0,i.length>1&&yB("div",{className:"setting-group"},void 0,yB("div",{className:"setting-single"},void 0,yB("label",{className:"floating-label"},void 0,yB("span",{},void 0,(0,Oe.Z)("Account")),yB("select",{onChange:this.onAccountChange,value:n},void 0,i.map((e=>yB("option",{value:e.id},e.id,e.name))))))),yB("div",{className:"setting-group"},void 0,yB("div",{className:"setting-single"},void 0,yB(sc.Z,{type:"text",onChange:this.onCalendarChange,name:"description",label:this.props.searchableStrings["Calendar Name"],value:t,autoFocus:!0}))),yB("div",{className:"setting-group"},void 0,yB("div",{className:"setting-single"},void 0,yB(eB,{label:this.props.searchableStrings.Color,colorKey:"color",colorValue:e||Rd.Z.getCalendarCreateColor(),setColor:this.setColor,predefinedColors:$D.h}))),yB(rB,{supportedCalendarComponent:s,updateCalendarComponent:this.onChangeCalendarComponentS,searchableStrings:this.props.searchableStrings,disabled:!1})),!!this.state.statusText&&yB(tc,{type:this.state.status},void 0,this.state.statusText),yB("div",{className:"detail-toolbar"},void 0,yB("input",{className:"primary",type:"submit",disabled:!this.isCalendarValidToCreate(),value:(0,Oe.Z)("Create Calendar")})))}}const SB=bB;var IB;function kB(e,t,n,s){IB||(IB="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:IB,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const AB=n(28888),{ensureAccountType:TB,isCalDAV:ZB}=Rd.Z,EB={"Add your First Calendar":(0,Oe.Z)("Add your First Calendar"),"Press the “Add” button to the left to add a new Calendar.":(0,Oe.Z)("Press the “Add” button to the left to add a new Calendar.")},_B={...$D.d,"Calendar Name":(0,Oe.Z)("Calendar Name"),Active:(0,Oe.Z)("Active"),"Hide from Calendar View":(0,Oe.Z)("Hide from Calendar View"),"Calendar Type":(0,Oe.Z)("Calendar Type"),Name:(0,Oe.Z)("calendar","Name"),CalDav:(0,Oe.Z)("CalDAV"),URL:(0,Oe.Z)("Address"),Subscribe:(0,Oe.Z)("Subscribe"),Password:(0,Oe.Z)("Password"),Username:(0,Oe.Z)("Username"),Timezone:(0,Oe.Z)("Timezone"),Color:(0,Oe.Z)("calendar","Color"),Index:(0,Oe.Z)("Index"),Events:(0,Oe.Z)("Events"),Tasks:(0,Oe.Z)("Tasks")};var MB=kB("div",{}),NB=kB("div",{className:"item-meta"},void 0," ");class PB extends hs.PureComponent{renderListItem=(e,t)=>{const n=this.props.accounts.find((e=>e.id===t.accountId));if(n){const e=TB(n.account_type),s="local"===e?Ts.bcq:Ts.eTS;return(0,fs.jsxs)(fs.Fragment,{children:[kB("span",{className:"item-icon",style:{fill:Rd.Z.getCalendarColor(t)},dangerouslySetInnerHTML:{__html:s.large}}),kB("div",{className:"item-title"},void 0,t.description||t.name),kB("div",{className:"item-meta"},void 0,`${n.name} (${$D.d[e]})`)]})}return MB};renderCreateListItem=()=>(0,fs.jsxs)(fs.Fragment,{children:[kB("div",{className:"item-title"},void 0,(0,Oe.Z)("New Calendar")),NB]});save=e=>{const{id:t,...n}=e;m.Z.updateCalendar(t,n)};createCalendar=e=>{if(0===Bd.Z.getAccounts().length)return hD.Z.createLocalAccountAndCalendar(null,e);{const t=this.props.accounts.find((t=>t.id===e.accountId));return m.Z.createCalendar(e,t,!0)}};renderContent=(e,t)=>{const{calendars:n}=this.props,s=n&&n[e];if(!s)return null;const i=nt()(Object.values(s).reduce(((e,t)=>e+t))),o=this.props.accounts.find((e=>e.id===s.accountId)),a=[];return ZB(o?.account_type)&&a.push("name"),"google"===o?.account_type&&s.supportedCalendarComponent?.vtodo&&a.push("color"),kB(vB,{save:this.save,searchableStrings:t,calendar:s,disabledProperties:a},i)};renderCreate=e=>kB(SB,{searchableStrings:e,createCalendar:this.createCalendar});renderEmpty=e=>kB("div",{className:"detail"},void 0,kB("div",{className:"detail-content"},void 0,kB("h3",{},void 0,EB["Add your First Calendar"]),kB("p",{},void 0,EB["Press the “Add” button to the left to add a new Calendar."])));remapCalendars=()=>this.props.calendars.map((e=>({...e,key:e.id})));deleteCalendarDialog=e=>(0,fs.jsx)(OR,{...e});render(){return kB(mN,{categoryTitle:(0,Oe.Z)("Calendars"),filter:this.props.filter},void 0,kB(xD.Z,{className:"tall",deleteDialog:this.deleteCalendarDialog,addTipString:(0,Oe.Z)("Add Calendar"),deleteTipString:(0,Oe.Z)("tooltip","Delete Calendar"),emptyListGraphic:AB,emptyListString:(0,Oe.Z)("No Calendars added"),filter:this.props.filter,items:this.remapCalendars(),masterLayout:0,onRemove:Aa.Z,renderListItem:this.renderListItem,renderCreateListItem:this.renderCreateListItem,renderContent:this.renderContent,renderCreate:this.renderCreate,renderEmpty:this.renderEmpty,contentStrings:_B,emptyStrings:EB,createStrings:_B}))}}const DB=vD(PB);var xB;function OB(e,t,n,s){xB||(xB="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:xB,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class LB extends hs.Component{_hiddenRange=hs.createRef();setValue=e=>{const t=this._hiddenRange.current,n=(Object.getOwnPropertyDescriptor(HTMLInputElement.prototype,"value")||{}).set;t&&n&&(n.call(t,e.currentTarget.value),t.dispatchEvent(new Event("input",{bubbles:!0})))};render(){const{prefValues:e,className:t,label:n,minLabel:s,maxLabel:i,...o}=this.props,a=this.props.step||1,r=["RangeButtonInput",t].join(" ");return e[$.kAppearanceRangeButtons]?OB("span",{className:r},void 0,(0,fs.jsx)("input",{...o,ref:this._hiddenRange,type:"range",onChange:this.props.onChange,hidden:!0}),OB("button",{type:"button",className:"FormButton",onClick:this.setValue,title:s??(0,Oe.Z)("Decrease"),value:Number((this.props.value-a).toFixed(2)),disabled:this.props.disabled||this.props.value<=this.props.min,dangerouslySetInnerHTML:{__html:Ts.M2k.medium}}),n??this.props.value,OB("button",{type:"button",className:"FormButton",onClick:this.setValue,title:i??(0,Oe.Z)("Increase"),value:Number((this.props.value+a).toFixed(2)),disabled:this.props.disabled||this.props.value>=this.props.max,dangerouslySetInnerHTML:{__html:Ts.md4.medium}})):OB("label",{className:r},void 0,(0,fs.jsx)("input",{...o,type:"range"}),OB("span",{},void 0,n??this.props.value))}}const RB=sa(LB,[$.kAppearanceRangeButtons]);var BB;function FB(e,t,n,s){BB||(BB="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:BB,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const VB=[$.kCalendarAutoAdjustEnd,$.kCalendarAutoTabDatetime,$.kCalendarClickOutside,$.kCalendarClickTimeSlot,$.kCalendarCollapseHours,$.kCalendarDayEnds,$.kCalendarDayStarts,$.kCalendarDefaultAlldayNotification,$.kCalendarDefaultAlldayNotificationTime,$.kCalendarDefaultDuration,$.kCalendarDefaultNotification,$.kCalendarDisplayDensity,$.kCalendarDisplayDimPastEvents,$.kCalendarHandleIcsDownloads,$.kCalendarHandleWebcalLinks,$.kCalendarDisplayEventIcons,$.kCalendarDisplayWeekNumber,$.kCalendarEditMode,$.kCalendarHiddenHidesNotifications,$.kCalendarMailAccount,$.kCalendarNotificationFullscreen,$.kCalendarNotificationType,$.kCalendarNotificationSound,$.kCalendarNotificationVolume,$.kCalendarOnlyHourlyDivider,$.kCalendarOnlyHourlyKeynav,$.kCalendarSendInviteEmailAction,$.kCalendarTimeIncrements,$.kMailAccounts,$.kMailIsTurnedOff],WB=Ne.Z.getEventHandler,UB=[["",(0,Oe.Z)("other","None")],["../../../resources/notification_ding.opus",(0,Oe.Z)("Ding")],["../../../resources/notification_rooster.opus",(0,Oe.Z)("Rooster")],["../../../resources/notification_tada.opus",(0,Oe.Z)("Tada")]],HB=[[0,(0,Oe.Z)("No Duration")],[5*Lu.lb,(0,Oe.Z)("$1 minute","$1 minutes",[5])],[10*Lu.lb,(0,Oe.Z)("$1 minute","$1 minutes",[10])],[15*Lu.lb,(0,Oe.Z)("$1 minute","$1 minutes",[15])],[30*Lu.lb,(0,Oe.Z)("$1 minute","$1 minutes",[30])],[45*Lu.lb,(0,Oe.Z)("$1 minute","$1 minutes",[45])],[1*Lu.QI,(0,Oe.Z)("$1 hour","$1 hours",[1])],[2*Lu.QI,(0,Oe.Z)("$1 hour","$1 hours",[2])],[3*Lu.QI,(0,Oe.Z)("$1 hour","$1 hours",[3])],[8*Lu.QI,(0,Oe.Z)("$1 hour","$1 hours",[8])]],zB=N()().startOf("day"),GB=[];for(;zB.hour()<13;){const e=zB.hour();GB.push(FB("option",{value:e},e,zB.format("LT"))),zB.add(1,"hour")}zB.hour(12);const $B=[];for(;zB.hour()>0;){zB.add(1,"hour");const e=zB.hour()||24;$B.push(FB("option",{value:e},e,zB.format("LT")))}var KB=FB("input",{type:"radio",value:"full"}),jB=FB("input",{type:"radio",value:"compact"}),YB=FB("input",{type:"radio",value:"minimal"}),XB=FB("input",{type:"radio",value:"15"}),QB=FB("input",{type:"radio",value:"30"}),qB=FB("input",{type:"radio",value:"60"}),JB=FB("input",{type:"radio",value:"select"}),eF=FB("input",{type:"radio",value:"create"}),tF=FB("input",{type:"radio",value:"cancel"}),nF=FB("input",{type:"radio",value:"save_and_close"}),sF=FB("input",{type:"radio",value:"inline"}),iF=FB("input",{type:"radio",value:"popup"}),oF=FB("input",{type:"radio",value:"always"}),aF=FB("input",{type:"radio",value:"never"}),rF=FB("input",{type:"radio",value:"timed_only"}),lF=FB("input",{type:"radio",value:"system"}),dF=FB("input",{type:"radio",value:"dialog"}),cF=FB("input",{type:"radio",value:"melt"}),hF=FB("input",{type:"radio",value:"burn"}),pF=FB("input",{type:"radio",value:"ask"}),uF=FB("input",{type:"radio",value:"send"}),gF=FB("input",{type:"radio",value:"cancel"});class mF extends hs.Component{renderMailAccountSelection(){const e=this.props.prefValues[$.kMailAccounts],t=this.props.prefValues[$.kCalendarMailAccount],n=e.find((e=>e.MAIL_EMAIL===t));return FB("div",{className:"setting-group"},void 0,FB("div",{className:"setting-single"},void 0,FB("h3",{},void 0,(0,Oe.Z)("Calendar Mail Account")),FB("select",{value:t,onChange:WB($.kCalendarMailAccount)},void 0,!n&&FB("option",{value:t,disabled:!0},void 0,(0,Oe.Z)("Select mail account")),e.map((e=>FB("option",{value:e.MAIL_EMAIL},e.MAIL_EMAIL,e.MAIL_EMAIL))))))}render(){return(0,fs.jsxs)(fs.Fragment,{children:[!this.props.prefValues[$.kMailIsTurnedOff]&&(0,fs.jsxs)(fs.Fragment,{children:[FB(tx,{filter:this.props.filter}),FB(DB,{filter:this.props.filter}),FB(DR,{filter:this.props.filter}),FB(mN,{categoryTitle:(0,Oe.Z)("Calendar Display"),filter:this.props.filter},void 0,FB("div",{className:"setting-group"},void 0,FB("div",{className:"setting-single"},void 0,FB("label",{},void 0,FB("input",{type:"checkbox",checked:this.props.prefValues[$.kCalendarDisplayEventIcons],onChange:WB($.kCalendarDisplayEventIcons)}),FB("span",{},void 0,(0,Oe.Z)("Show Event Property Icons")))),FB("div",{className:"setting-single"},void 0,FB("label",{},void 0,FB("input",{type:"checkbox",checked:this.props.prefValues[$.kCalendarDisplayDimPastEvents],onChange:WB($.kCalendarDisplayDimPastEvents)}),FB("span",{},void 0,(0,Oe.Z)("Show Past Events Faded")))),FB("div",{className:"setting-single"},void 0,FB("label",{},void 0,FB("input",{type:"checkbox",checked:this.props.prefValues[$.kCalendarDisplayWeekNumber],onChange:WB($.kCalendarDisplayWeekNumber)}),FB("span",{},void 0,(0,Oe.Z)("Show Week Number"))),FB("p",{className:"info"},void 0,(0,Oe.Z)("For week settings see Language under General Settings.")))),FB("div",{className:"setting-group"},void 0,FB("h3",{},void 0,(0,Oe.Z)("Events View")),FB(vl,{name:"calendar-density",value:this.props.prefValues[$.kCalendarDisplayDensity],onChange:WB($.kCalendarDisplayDensity),className:"group"},void 0,FB("div",{className:"setting-single"},void 0,FB("label",{},void 0,KB,FB("span",{},void 0,(0,Oe.Z)("Full")))),FB("div",{className:"setting-single"},void 0,FB("label",{},void 0,jB,FB("span",{},void 0,(0,Oe.Z)("calendar","Compact")))),FB("div",{className:"setting-single"},void 0,FB("label",{},void 0,YB,FB("span",{},void 0,(0,Oe.Z)("Minimal")))))),FB("div",{className:"setting-group"},void 0,FB("h3",{},void 0,(0,Oe.Z)("Visible Day Hours")),FB("div",{className:"setting-single day-setting-grid"},void 0,FB("label",{},void 0,FB("span",{},void 0,(0,Oe.Z)("Day Starts at")),FB("select",{name:"day_starts",value:this.props.prefValues[$.kCalendarDayStarts],onChange:WB($.kCalendarDayStarts)},void 0,GB),FB("span",{},void 0,(0,Oe.Z)("Day Ends at")),FB("select",{name:"day_ends",value:this.props.prefValues[$.kCalendarDayEnds],onChange:WB($.kCalendarDayEnds)},void 0,$B))),FB("div",{className:"setting-single"},void 0,FB("label",{},void 0,FB("input",{type:"checkbox",checked:this.props.prefValues[$.kCalendarCollapseHours],onChange:WB($.kCalendarCollapseHours)}),FB("span",{},void 0,(0,Oe.Z)("Collapse Excluded Hours"))))),FB("div",{className:"setting-group"},void 0,FB("h3",{},void 0,(0,Oe.Z)("Time Increments")),FB(vl,{name:"time-increments",value:this.props.prefValues[$.kCalendarTimeIncrements],onChange:WB($.kCalendarTimeIncrements),className:"group"},void 0,FB("div",{className:"setting-single"},void 0,FB("label",{},void 0,XB,FB("span",{},void 0,(0,Oe.Z)("15 Minutes")))),FB("div",{className:"setting-single"},void 0,FB("label",{},void 0,QB,FB("span",{},void 0,(0,Oe.Z)("30 Minutes")))),FB("div",{className:"setting-single"},void 0,FB("label",{},void 0,qB,FB("span",{},void 0,(0,Oe.Z)("1 Hour"))))),FB("div",{className:"setting-single"},void 0,FB("label",{},void 0,FB("input",{type:"checkbox",checked:this.props.prefValues[$.kCalendarOnlyHourlyDivider],onChange:WB($.kCalendarOnlyHourlyDivider)}),FB("span",{},void 0,(0,Oe.Z)("Show Only 1 Hour Grid Lines")))),FB("div",{className:"setting-single"},void 0,FB("label",{},void 0,FB("input",{type:"checkbox",checked:this.props.prefValues[$.kCalendarOnlyHourlyKeynav],onChange:WB($.kCalendarOnlyHourlyKeynav)}),FB("span",{},void 0,(0,Oe.Z)("Use 1 Hour Increments for Keyboard Navigation"))))),FB("div",{className:"setting-group"},void 0,FB("h3",{},void 0,(0,Oe.Z)("Click on Time Slot Should")),FB(vl,{name:"click-timeslot",value:this.props.prefValues[$.kCalendarClickTimeSlot],onChange:WB($.kCalendarClickTimeSlot),className:"group"},void 0,FB("div",{className:"setting-single"},void 0,FB("label",{},void 0,JB,FB("span",{},void 0,(0,Oe.Z)("Select Period")))),FB("div",{className:"setting-single"},void 0,FB("label",{},void 0,eF,FB("span",{},void 0,(0,Oe.Z)("calendar","Create New Event")))))),FB("div",{className:"setting-group"},void 0,FB("h3",{},void 0,(0,Oe.Z)("Click Outside Event Should")),FB(vl,{name:"click-outside",value:this.props.prefValues[$.kCalendarClickOutside],onChange:WB($.kCalendarClickOutside),className:"group"},void 0,FB("div",{className:"setting-single"},void 0,FB("label",{},void 0,tF,FB("span",{},void 0,(0,Oe.Z)("Discard Changes")))),FB("div",{className:"setting-single"},void 0,FB("label",{},void 0,nF,FB("span",{},void 0,(0,Oe.Z)("Save Changes"))))))),FB(mN,{categoryTitle:(0,Oe.Z)("Calendar Editing"),filter:this.props.filter},void 0,FB("div",{className:"setting-group"},void 0,FB("h3",{},void 0,(0,Oe.Z)("Edit Mode")),FB(vl,{name:"edit-mode",value:this.props.prefValues[$.kCalendarEditMode],onChange:WB($.kCalendarEditMode),className:"group"},void 0,FB("div",{className:"setting-single"},void 0,FB("label",{},void 0,sF,FB("span",{},void 0,(0,Oe.Z)("Inline"))),FB("div",{className:As()("img-setting",{disabled:"popup"===this.props.prefValues[$.kCalendarEditMode]})},void 0,FB("span",{className:"image",dangerouslySetInnerHTML:{__html:n(9371)}}))),FB("div",{className:"setting-single"},void 0,FB("label",{},void 0,iF,FB("span",{},void 0,(0,Oe.Z)("radio","Dialog"))),FB("div",{className:As()("img-setting",{disabled:"inline"===this.props.prefValues[$.kCalendarEditMode]})},void 0,FB("span",{className:"image",dangerouslySetInnerHTML:{__html:n(97487)}}))))),FB("div",{className:"setting-group"},void 0,FB("h3",{},void 0,(0,Oe.Z)("Default Event Duration")),FB("div",{className:"setting-single"},void 0,FB("label",{},void 0,FB("select",{value:this.props.prefValues[$.kCalendarDefaultDuration],onChange:WB($.kCalendarDefaultDuration)},void 0,HB.map((([e,t])=>FB("option",{value:e},e,t)))))),FB("h3",{},void 0,(0,Oe.Z)("Default Event Reminder")),FB("div",{className:"setting-single"},void 0,FB("label",{},void 0,FB("select",{value:this.props.prefValues[$.kCalendarDefaultNotification],onChange:e=>{let t=parseInt(e.target.value);isNaN(t)&&(t=-1),Ne.Z.set($.kCalendarDefaultNotification,t)}},void 0,px.map((([e,t])=>FB("option",{value:e.toString()},e,t)))))),FB("h3",{},void 0,(0,Oe.Z)("Default Reminder for All Day Events")),FB("div",{className:"setting-single"},void 0,FB("label",{},void 0,FB(fx,{value:this.props.prefValues[$.kCalendarDefaultAlldayNotificationTime]*Lu.lb,onChange:e=>{isNaN(e)?(e=0,Ne.Z.set($.kCalendarDefaultAlldayNotification,!1)):Ne.Z.set($.kCalendarDefaultAlldayNotification,!0),0===this.props.prefValues[$.kCalendarDefaultAlldayNotificationTime]&&(e-=540*Lu.lb),Ne.Z.set($.kCalendarDefaultAlldayNotificationTime,e/Lu.lb)},create:!this.props.prefValues[$.kCalendarDefaultAlldayNotification],allDay:!0})))),FB("div",{className:"setting-group"},void 0,FB("h3",{},void 0,(0,Oe.Z)("Auto Adjust End Time")),FB("p",{className:"info"},void 0,(0,Oe.Z)("Automatically update end time when editing to keep same event duration.")),FB(vl,{name:"auto-adjust-end",value:this.props.prefValues[$.kCalendarAutoAdjustEnd],onChange:WB($.kCalendarAutoAdjustEnd),className:"group"},void 0,FB("div",{className:"setting-single"},void 0,FB("label",{},void 0,oF,FB("span",{},void 0,(0,Oe.Z)("Always")))),FB("div",{className:"setting-single"},void 0,FB("label",{},void 0,aF,FB("span",{},void 0,(0,Oe.Z)("other","Never")))),FB("div",{className:"setting-single"},void 0,FB("label",{},void 0,rF,FB("span",{},void 0,(0,Oe.Z)("Except for All Day Events")))))),FB("div",{className:"setting-group"},void 0,FB("h3",{},void 0,(0,Oe.Z)("Auto Focus Next Date/Time")),FB("div",{className:"setting-single"},void 0,FB("label",{},void 0,FB("input",{type:"checkbox",checked:this.props.prefValues[$.kCalendarAutoTabDatetime],onChange:WB($.kCalendarAutoTabDatetime)}),FB("span",{},void 0,(0,Oe.Z)("Automatically move focus to next field after typing complete date or time value")))))),FB(mN,{categoryTitle:(0,Oe.Z)("Calendar Notifications"),filter:this.props.filter},void 0,FB("div",{className:"setting-group"},void 0,FB("div",{className:"setting-single"},void 0,FB("label",{},void 0,FB("input",{type:"checkbox",value:"none"!==this.props.prefValues[$.kCalendarNotificationType]?"none":"dialog",checked:"none"!==this.props.prefValues[$.kCalendarNotificationType],onChange:WB($.kCalendarNotificationType)}),FB("span",{},void 0,(0,Oe.Z)("Enable Notifications")))),FB("div",{className:"setting-single"},void 0,FB("label",{},void 0,FB("input",{type:"checkbox",checked:this.props.prefValues[$.kCalendarHiddenHidesNotifications],disabled:"none"===this.props.prefValues[$.kCalendarNotificationType],onChange:WB($.kCalendarHiddenHidesNotifications)}),FB("span",{},void 0,(0,Oe.Z)("Disable for Hidden Calendars"))))),FB("div",{className:"setting-group"},void 0,FB("h3",{},void 0,(0,Oe.Z)("Notification Style")),FB(vl,{name:"calendarnotificationgroup",value:this.props.prefValues[$.kCalendarNotificationType]||"",onChange:WB($.kCalendarNotificationType),disabled:"none"===this.props.prefValues[$.kCalendarNotificationType]},void 0,FB("div",{className:"setting-single"},void 0,FB("label",{},void 0,lF,FB("span",{},void 0,(0,Oe.Z)("System Notification")))),FB("div",{className:"setting-single"},void 0,FB("label",{},void 0,dF,FB("span",{},void 0,(0,Oe.Z)("calendar","Dialog")))),FB("div",{className:"setting-single"},void 0,FB("label",{},void 0,cF,FB("span",{},void 0,(0,Oe.Z)("Melt Browser")))),FB("div",{className:"setting-single"},void 0,FB("label",{},void 0,hF,FB("span",{},void 0,(0,Oe.Z)("Burn Browser"))))),FB("div",{className:"setting-single"},void 0,FB("label",{},void 0,FB("input",{type:"checkbox",checked:this.props.prefValues[$.kCalendarNotificationFullscreen],onChange:WB($.kCalendarNotificationFullscreen),disabled:!("melt"===this.props.prefValues[$.kCalendarNotificationType]||"burn"===this.props.prefValues[$.kCalendarNotificationType])}),FB("span",{},void 0,(0,Oe.Z)("Full Screen Notifications"))),FB("p",{className:"info"},void 0,(0,Oe.Z)("Applies to Melt and Burn notification type.")))),FB("div",{className:"setting-group"},void 0,FB("h3",{},void 0,(0,Oe.Z)("Notification Sound")),FB(vl,{name:"calendarnotificationsoundgroup",value:this.props.prefValues[$.kCalendarNotificationSound]||"",onChange:WB($.kCalendarNotificationSound),disabled:"none"===this.props.prefValues[$.kCalendarNotificationType]},void 0,UB.map((([e,t])=>FB("div",{className:"setting-single"},e,FB("label",{},void 0,FB("input",{type:"radio",value:e}),FB("span",{},void 0,t)))))),FB("h3",{},void 0,(0,Oe.Z)("Notification Volume")),FB("div",{className:"setting-single"},void 0,FB(RB,{value:this.props.prefValues[$.kCalendarNotificationVolume],min:0,max:100,step:5,onChange:WB($.kCalendarNotificationVolume),label:`${this.props.prefValues[$.kCalendarNotificationVolume]} %`,title:(0,Oe.Z)("Minimum width of horizontally scaled active tab")})))),FB(mN,{categoryTitle:(0,Oe.Z)("Calendar Integration"),filter:this.props.filter},void 0,this.renderMailAccountSelection(),FB("div",{className:"setting-group"},void 0,FB("h3",{},void 0,(0,Oe.Z)("Send Invite Email Messages")),FB(vl,{name:"calendarinviteemailsgroup",value:this.props.prefValues[$.kCalendarSendInviteEmailAction]||"",onChange:WB($.kCalendarSendInviteEmailAction)},void 0,FB("div",{className:"setting-single"},void 0,FB("label",{},void 0,pF,FB("span",{},void 0,(0,Oe.Z)("Ask Each Time")))),FB("div",{className:"setting-single"},void 0,FB("label",{},void 0,uF,FB("span",{},void 0,(0,Oe.Z)("Always Send Messages")))),FB("div",{className:"setting-single"},void 0,FB("label",{},void 0,gF,FB("span",{},void 0,(0,Oe.Z)("Never Send Messages")))))),FB("div",{className:"setting-group"},void 0,FB("div",{className:"setting-single"},void 0,FB("label",{},void 0,FB("input",{type:"checkbox",checked:this.props.prefValues[$.kCalendarHandleIcsDownloads],onChange:WB($.kCalendarHandleIcsDownloads)}),FB("span",{},void 0,(0,Oe.Z)("Open ICS files in Vivaldi")))),FB("div",{className:"setting-single"},void 0,FB("label",{},void 0,FB("input",{type:"checkbox",checked:this.props.prefValues[$.kCalendarHandleWebcalLinks],onChange:WB($.kCalendarHandleWebcalLinks)}),FB("span",{},void 0,(0,Oe.Z)("Open Webcal Links in Vivaldi"))))))," "]}),FB(QP,{categoryTitle:(0,Oe.Z)("Calendar"),filter:this.props.filter,inform:!0})]})}}const vF=sa(mF,VB);var fF,yF=n(85619);function CF(e,t,n,s){fF||(fF="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:fF,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const wF=[$.kWebpagesCaptureDirectory,$.kWebpagesCaptureSaveFilePattern],bF=Ne.Z.getEventHandler,SF=new Date,IF="139cea89-3ed1-4ccd-bd3c-7a6a36f824d5",kF=[{tag:"$timestamp",title:(0,Oe.Z)("Long date"),format:"YYYY-MM-DD HH.mm.ss"},{tag:"$year",title:(0,Oe.Z)("Year"),format:"YYYY"},{tag:"$month",title:(0,Oe.Z)("Month"),format:"MM"},{tag:"$day",title:(0,Oe.Z)("Day"),format:"DD"},{tag:"$hour",title:(0,Oe.Z)("Hour"),format:"HH"},{tag:"$minute",title:(0,Oe.Z)("Minute"),format:"mm"},{tag:"$second",title:(0,Oe.Z)("time","Second"),format:"ss"},{tag:"$ms",title:(0,Oe.Z)("Millisecond"),format:"SSS"},{tag:"$longid",title:(0,Oe.Z)("Unique ID"),value:IF},{tag:"$shortid",title:(0,Oe.Z)("Short unique ID"),value:IF.substring(24)},{tag:"$host",title:(0,Oe.Z)("Active tab host name"),value:"example.com"},{tag:"$title",title:(0,Oe.Z)("Active tab title"),value:(0,Oe.Z)("Example Page Title")}];class AF extends hs.Component{static contextType=xi.Z;handleDragEnter=e=>{const{dataTransfer:t,target:n}=e;n&&t.types.includes("text/plain")&&(n.setSelectionRange(n.value.length,n.value.length),n.focus())};setDragData=e=>{const{dataTransfer:t,target:n}=e;t.setData("text/plain",n.innerText),t.dropEffect="none",t.effectAllowed="copyMove",t.setDragImage(n,0,0)};handleDoubleClick=e=>{const{HTMLInputElement:t}=this.context,{target:n}=e;let s=n.innerText;if(this._inputRef instanceof t){const e=this._inputRef.selectionStart,t=this._inputRef.value||"";s=" "+s+" ";let n=e>0?t.substr(0,e)+s+t.substr(e):t+s;n=n.replace(/ {2}/g," ").trim(),Ne.Z.set($.kWebpagesCaptureSaveFilePattern,n),this._inputRef&&this._inputRef.focus()}};resetSetting=()=>{Ne.Z.reset($.kWebpagesCaptureSaveFilePattern)};parseFileName=()=>{let e=this.props.prefValues[$.kWebpagesCaptureSaveFilePattern];return kF.forEach((t=>{const n=new RegExp((0,yF.Z)(t.tag),"gi"),s=t.format?N()(SF).format(t.format):t.value;e=e.replace(n,s)})),(e||IF)+".png"};selectCaptureFolder=()=>{C.Z.utilities.selectFile({windowId:this.context.vivaldiWindowId,title:(0,Oe.Z)("Select Capture Folder"),type:"folder"}).then((e=>{e&&Ne.Z.set($.kWebpagesCaptureDirectory,e)}))};renderTags=()=>kF.map(((e,t)=>CF("span",{draggable:"true",onDoubleClick:this.handleDoubleClick,onDragStart:this.setDragData,title:e.title+(e.format?" ("+e.format+")":"")},t,e.tag)));render(){return CF(mN,{categoryTitle:(0,Oe.Z)("Image Capture"),filter:this.props.filter},void 0,CF("div",{className:"setting-group"},void 0,CF("div",{className:"setting-single"},void 0,CF("h3",{},void 0,(0,Oe.Z)("Capture Storage Folder")),CF("div",{className:"setting-single folder-selection"},void 0,CF("input",{type:"text",value:this.props.prefValues[$.kWebpagesCaptureDirectory],title:(0,Oe.Z)("Enter capture storage folder"),spellCheck:"false",onChange:bF($.kWebpagesCaptureDirectory)}),CF("input",{type:"button",value:(0,Oe.Z)("Select Folder..."),onClick:this.selectCaptureFolder})))),CF("div",{className:"setting-group"},void 0,CF("div",{className:"setting-single capture-name-template"},void 0,CF("h3",{},void 0,(0,Oe.Z)("Capture File Name Template")),(0,fs.jsx)("input",{type:"text",ref:e=>this._inputRef=e,onDragEnter:this.handleDragEnter,value:this.props.prefValues[$.kWebpagesCaptureSaveFilePattern],title:(0,Oe.Z)("Modify file name template"),spellCheck:"false",onChange:bF($.kWebpagesCaptureSaveFilePattern)}),CF("p",{className:"info"},void 0,this.parseFileName()),CF("p",{className:"info"},void 0,this.renderTags()),CF("input",{type:"button",value:(0,Oe.Z)("Restore Default"),onClick:this.resetSetting}))))}}const TF=sa(AF,wF),ZF=e=>null,EF="https://downloads.vivaldi.com/",_F={[EF+"ddg/tds-v2-current.json"]:"DuckDuckGo Tracker Radar",[EF+"easylist/easyprivacy-current.txt"]:"EasyPrivacy",[EF+"easylist/easylist-current.txt"]:"EasyList",[EF+"lists/abp/abp-filters-anti-cv-current.txt"]:"ABP anti-circumvention list",[EF+"lists/abp/antiadblockfilters-current.txt"]:"AdBlock Warning Removal List",[EF+"lists/vivaldi/partners-current.txt"]:(0,Oe.Z)("Allow ads from our partners (support Vivaldi)"),"https://www.i-dont-care-about-cookies.eu/abp/":(0,Oe.Z)("Remove cookie warnings ($1)",["I don’t care about cookies"]),"https://secure.fanboy.co.nz/fanboy-cookiemonster.txt":(0,Oe.Z)("Remove cookie warnings ($1)",["Easylist Cookie List"]),"https://secure.fanboy.co.nz/fanboy-annoyance.txt":(0,Oe.Z)("Remove annoyances, can break sites ($1)",["Fanboy's Annoyance List"]),"https://easylist-downloads.adblockplus.org/Liste_AR.txt":(0,Oe.Z)("Arabic ($1)",["Liste AR"]),"http://stanev.org/abp/adblock_bg.txt":(0,Oe.Z)("Bulgarian ($1)",["Bulgarian List"]),"https://easylist-downloads.adblockplus.org/easylistchina.txt":(0,Oe.Z)("Chinese ($1)",["EasyList China"]),"https://raw.githubusercontent.com/cjx82630/cjxlist/master/cjx-annoyance.txt":(0,Oe.Z)("Chinese ($1)",["CJX’s Annoyance List"]),"https://raw.githubusercontent.com/yecarrillo/adblock-colombia/master/adblock_co.txt":(0,Oe.Z)("Colombian ($1)",["Colombian List by Yecarrillo"]),"https://raw.githubusercontent.com/tomasko126/easylistczechandslovak/master/filters.txt":(0,Oe.Z)("Czech and Slovak ($1)",["Czech and Slovak filter list"]),"https://easylist-downloads.adblockplus.org/easylistdutch.txt":(0,Oe.Z)("Dutch ($1)",["EasyList Dutch"]),"https://pgl.yoyo.org/adservers/serverlist.php?hostformat=adblockplus&mimetype=plaintext":(0,Oe.Z)("English ($1)",["Peter Lowe’s List"]),"https://adblock.ee/list.php":(0,Oe.Z)("Estonian ($1)",["Eesti saitidele kohandatud filter"]),"https://gurud.ee/ab.txt":(0,Oe.Z)("Estonian ($1)",["Filters by Gurud.ee"]),"https://cdn.rawgit.com/SlashArash/adblockfa/master/adblockfa.txt":(0,Oe.Z)("Farsi ($1)",["AdBlock Farsi"]),"https://raw.githubusercontent.com/finnish-easylist-addition/finnish-easylist-addition/master/Finland_adb.txt":(0,Oe.Z)("Finnish ($1)",["EasyList Finland"]),"https://easylist-downloads.adblockplus.org/liste_fr.txt":(0,Oe.Z)("French ($1)",["Liste FR"]),"https://easylist.to/easylistgermany/easylistgermany.txt":(0,Oe.Z)("German ($1)",["EasyList Germany"]),"https://www.void.gr/kargig/void-gr-filters.txt":(0,Oe.Z)("Greek ($1)",["void.gr"]),"https://raw.githubusercontent.com/easylist/EasyListHebrew/master/EasyListHebrew.txt":(0,Oe.Z)("Hebrew ($1)",["EasyList Hebrew"]),"https://raw.githubusercontent.com/hufilter/hufilter/master/hufilter.txt":(0,Oe.Z)("Hungarian ($1)",["hufilter"]),"https://adblock.gardar.net/is.abp.txt":(0,Oe.Z)("Icelandic ($1)",["Icelandic ABP List"]),"https://easylist-downloads.adblockplus.org/indianlist.txt":(0,Oe.Z)("Indian ($1)",["Indian List"]),"https://raw.githubusercontent.com/heradhis/indonesianadblockrules/master/subscriptions/abpindo.txt":(0,Oe.Z)("Indonesian ($1)",["ABPindo"]),"https://raw.githubusercontent.com/gioxx/xfiles/master/filtri.txt":(0,Oe.Z)("Italian ($1)",["X Files"]),"https://easylist-downloads.adblockplus.org/easylistitaly.txt":(0,Oe.Z)("Italian ($1)",["EasyList Italy"]),"https://raw.githubusercontent.com/k2jp/abp-japanese-filters/master/abpjf.txt":(0,Oe.Z)("Japanese ($1)",["ABP Japanese filters"]),"https://raw.githubusercontent.com/eEIi0A5L/adblock_filter/master/mochi_filter.txt":(0,Oe.Z)("Japanese ($1)",["もちフィルタ（広告ブロック）"]),"https://raw.githubusercontent.com/eEIi0A5L/adblock_filter/master/tamago_filter.txt":(0,Oe.Z)("Japanese ($1)",["たまごフィルタ（mobile filter）"]),"https://easylist-downloads.adblockplus.org/koreanlist.txt":(0,Oe.Z)("Korean ($1)",["Korean List"]),"https://raw.githubusercontent.com/yous/YousList/master/youslist.txt":(0,Oe.Z)("Korean ($1)",["YousList"]),"https://notabug.org/latvian-list/adblock-latvian/raw/master/lists/latvian-list.txt":(0,Oe.Z)("Latvian ($1)",["Latvian List"]),"https://raw.githubusercontent.com/EasyList-Lithuania/easylist_lithuania/master/easylistlithuania.txt":(0,Oe.Z)("Lithuanian ($1)",["EasyList Lithuania"]),"https://raw.githubusercontent.com/DandelionSprout/adfilt/master/NorwegianExperimentalList%20alternate%20versions/NordicFiltersABP.txt":(0,Oe.Z)("Nordic ($1)",["Dandelion Sprout’s Nordic Filters"]),"https://easylist-downloads.adblockplus.org/easylistpolish.txt":(0,Oe.Z)("Polish ($1)",["EasyList Polish"]),"https://easylist-downloads.adblockplus.org/easylistportuguese.txt":(0,Oe.Z)("Portuguese ($1)",["EasyList Portuguese"]),"https://www.zoso.ro/pages/rolist.txt":(0,Oe.Z)("Romanian ($1)",["ROLIST"]),"https://easylist-downloads.adblockplus.org/advblock.txt":(0,Oe.Z)("Russian ($1)",["RU AdList"]),"https://easylist-downloads.adblockplus.org/easylistspanish.txt":(0,Oe.Z)("Spanish ($1)",["EasyList Spanish"]),"https://secure.fanboy.co.nz/fanboy-turkish.txt":(0,Oe.Z)("Turkish ($1)",["Fanboy’s Turkish"]),"https://raw.githubusercontent.com/abpvn/abpvn/master/filter/abpvn.txt":(0,Oe.Z)("Vietnamese ($1)",["ABPVN List"])};function MF(e){return _F[e]||e}var NF;function PF(e,t,n,s){NF||(NF="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:NF,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const DF={width:500,minWidth:"unset"},xF={success:(0,Oe.Z)("Fetched successfully"),download_failed:(0,Oe.Z)("Failed to download"),file_not_found:(0,Oe.Z)("File cannot be located"),file_read_error:(0,Oe.Z)("File cannot be read"),file_unsupported:(0,Oe.Z)("Invalid format"),failed_saving_parsed_rules:(0,Oe.Z)("Cannot save to the profile"),unknown:(0,Oe.Z)("Fetch not completed")};var OF=PF("br",{}),LF=PF("br",{});class RF extends hs.PureComponent{static contextType=xi.Z;fileInput=hs.createRef();state={blockerSources:[],sortedList:[],cachedSource:void 0,newSource:"",showEditor:0,importError:""};componentDidMount(){this.updateSources(),C.Z.contentBlocking.onRulesSourceUpdated.addListener(this.updateSources),C.Z.contentBlocking.onRuleSourceDisabled.addListener(this.updateSources),C.Z.contentBlocking.onRuleSourceEnabled.addListener(this.updateSources)}componentWillUnmount(){C.Z.contentBlocking.onRulesSourceUpdated.removeListener(this.updateSources),C.Z.contentBlocking.onRuleSourceDisabled.removeListener(this.updateSources),C.Z.contentBlocking.onRuleSourceEnabled.removeListener(this.updateSources)}updateSources=()=>{C.Z.contentBlocking.getRuleSources(this.props.ruleGroup,(e=>{this.setState({blockerSources:e,sortedList:this.remapSources(e)})})),this.state.cachedSource&&this.updateCachedSource()};updateCachedSource=()=>{this.state.cachedSource&&C.Z.contentBlocking.getRuleSource(this.props.ruleGroup,this.state.cachedSource.id,(e=>{if("unknown"!==e.last_fetch_result)return"success"!==e.last_fetch_result?(this.state.cachedSource&&this.removeSource(this.state.cachedSource.id),void this.setState({cachedSource:void 0,showEditor:1,importError:xF[e.last_fetch_result]})):void this.setState({cachedSource:e,showEditor:3,importError:""})}))};remapSources=e=>{if(e){return e.map(((e,t)=>{const n=e.unsafe_adblock_metadata,s=e.is_from_url?e.source_url:e.source_file,i=n.title&&MF(s)===s?n.title:MF(s);return{key:e.id.toString(),name:i,isDefault:e.source_url.startsWith(EF),enabled:e.loaded,id:e.id}})).sort(((e,t)=>e.name<t.name?-1:1)).sort(((e,t)=>e.isDefault&&!t.isDefault?-1:1))}return[]};updateNewSource=e=>{const{value:t}=e.currentTarget;this.setState({newSource:t})};onImportFromFile=e=>C.Z.utilities.selectFile({windowId:this.context.vivaldiWindowId,title:(0,Oe.Z)("Select a Blocker List Text File"),type:"file",accepts:[{ext:"txt"}]}).then((e=>{e&&this.importFromFile(e)}));importFromFile=e=>{C.Z.contentBlocking.addKnownSourceFromFile(this.props.ruleGroup,e,(e=>this.finishImport(e)))};importFromUrl=()=>{this.state.newSource.includes(EF)?this.setState({importError:(0,Oe.Z)("Failed to add internal list")}):C.Z.contentBlocking.addKnownSourceFromURL(this.props.ruleGroup,this.state.newSource,(e=>this.finishImport(e)))};finishImport=e=>{s.Z.runtime.lastError?(console.warn(Object.values(s.Z.runtime.lastError)),this.setState({cachedSource:void 0,importError:(0,Oe.Z)("Failed to add list")})):C.Z.contentBlocking.getRuleSource(this.props.ruleGroup,e,(e=>{this.setState({cachedSource:e,showEditor:2,importError:""},(()=>{this.updateCachedSource()}))}))};onToggleStatus=e=>{this.state.sortedList[e]&&this.toggleStatus(this.state.sortedList[e].id)};toggleStatus=e=>{const t=this.state.blockerSources.find((t=>t.id===e));t&&(t.loaded?C.Z.contentBlocking.disableSource(this.props.ruleGroup,e):C.Z.contentBlocking.enableSource(this.props.ruleGroup,e))};copySource=e=>{const t=this.state.blockerSources.find((t=>e===t.id));if(t){const e=t.is_from_url?t.source_url:t.source_file;yi.Z.set(e)}};onRemoveSource=e=>{this.state.sortedList[e]&&this.removeSource(this.state.sortedList[e].id)};removeSource=e=>{C.Z.contentBlocking.deleteKnownSource(this.props.ruleGroup,e)};restoreSources=()=>{C.Z.contentBlocking.resetPresetSources(this.props.ruleGroup),this.updateSources()};onContextMenu=(e,t)=>{const n=this.state.sortedList[e];if(!n)return;const s=[{handler:this.copySource.bind(null,n.id),...(0,xs.Z)("Copy List Origin")},{handler:this.toggleStatus.bind(null,n.id),isVisible:()=>!n.enabled,...(0,xs.Z)("Enable List")},{handler:this.toggleStatus.bind(null,n.id),isVisible:()=>n.enabled,...(0,xs.Z)("Disable List")},{...ae.Z.separatorItem,isVisible:()=>!n.isDefault||"ad_blocking"===this.props.ruleGroup},{handler:this.removeSource.bind(null,n.id),isVisible:()=>!n.isDefault,...(0,xs.Z)("Remove List")},{handler:this.restoreSources,isVisible:()=>"ad_blocking"===this.props.ruleGroup,...(0,xs.Z)("Restore Built-In Lists")}];(0,Qi.Z)(this.context,s)(t)};showDialog=()=>{this.setState({showEditor:1})};onCancel=()=>{this.state.cachedSource&&this.removeSource(this.state.cachedSource.id),this.closeDialog()};closeDialog=()=>{this.setState({cachedSource:void 0,newSource:"",importError:"",showEditor:0})};renderDialog=()=>{const{cachedSource:e,showEditor:t}=this.state,n=e?e.unsafe_adblock_metadata:void 0;return PF(_r.Z,{style:DF,viewMode:"float",onRequestClose:this.state.showEditor<2?this.onCancel:Aa.Z},void 0,PF("form",{className:"ContentBlocker-Exception"},void 0,PF("header",{className:"dialog-header"},void 0,PF("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("Import New Blocker List"))),1===t&&PF("div",{className:"dialog-content"},void 0,PF("p",{className:"info"},void 0,(0,Oe.Z)("Enter URL to import blocker rules")),PF("div",{className:"dialog-row"},void 0,PF("input",{type:"text",value:this.state.newSource,onChange:this.updateNewSource,autoFocus:!0}),PF("label",{},void 0,PF("div",{className:"button-toolbar"},void 0,PF("button",{className:"FormButton",type:"button",title:(0,Oe.Z)("Import from a file..."),dangerouslySetInnerHTML:{__html:Ts._TQ.small},onClick:this.onImportFromFile}))))),e&&2===t&&PF("div",{className:"dialog-content"},void 0,PF("h3",{},void 0,(0,Oe.Z)("Loading..."))),e&&3===t&&PF("div",{className:"dialog-content"},void 0,PF("h3",{},void 0,n?n.title:e.source_url),n&&PF("p",{className:"info"},void 0,e.source_url),PF("p",{},void 0,(0,Oe.Z)("Valid rules: $1",[e.rules_info.valid_rules]),OF,(0,Oe.Z)("Invalid rules: $1",[e.rules_info.invalid_rules]),LF,(0,Oe.Z)("Unsupported rules: $1",[e.rules_info.unsupported_rules]))),PF("footer",{className:"dialog-footer"},void 0,this.state.importError&&PF("p",{className:"info"},void 0,this.state.importError),(1===t||2===t)&&PF("input",{type:"submit",className:"primary",onClick:this.importFromUrl,value:(0,Oe.Z)("Import...")}),3===t&&PF("input",{type:"submit",className:"primary",onClick:this.closeDialog,value:(0,Oe.Z)("blocker","Done"),autoFocus:!0}),PF("input",{type:"button",onClick:this.onCancel,value:(0,Oe.Z)("Cancel")}))))};renderItem=(e,t)=>{const n=this.state.blockerSources.find((e=>t.id===e.id));return n?PF("div",{className:"ContentBlocker-SourceItem"},void 0,PF("input",{type:"checkbox",onMouseDown:e=>e.stopPropagation(),checked:t.enabled,onChange:this.toggleStatus.bind(null,n.id)}),PF("span",{className:"title"},void 0,e),PF("p",{className:"info"},void 0,""!==n.rules_list_checksum?(0,Oe.Z)("Updated on $1",[N()(n.last_update).format("lll")]):n.loaded?(0,Oe.Z)("Not fetched"):(0,Oe.Z)("Disabled"),n.is_fetching?" "+(0,Oe.Z)("(Fetching...)"):"")):null};render(){const{sortedList:e}=this.state,t=Math.min(44*e.length+22,200);return PF(US.Z,{filter:this.props.filter},void 0,0!==this.state.showEditor&&this.renderDialog(),PF("h3",{},void 0,this.props.title),PF("div",{className:"ContentBlocker-Sources",style:{minHeight:t}},void 0,PF(x_.Z,{items:e,renderListItem:this.renderItem,filter:this.props.filter,onActivate:this.onToggleStatus,onContextMenu:this.onContextMenu,onCreateItem:this.showDialog,onRemove:this.onRemoveSource,addTipString:(0,Oe.Z)("Add List"),deleteTipString:(0,Oe.Z)("Remove List"),supportDragAndDrop:!1})))}}const BF=RF;var FF,VF=n(96405);function WF(e,t,n,s){FF||(FF="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:FF,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const UF=["tracking","ad_blocking"],HF={width:500,minWidth:"unset"};class zF extends hs.PureComponent{static contextType=xi.Z;_refSelect=hs.createRef();state={exceptionRules:void 0,exceptionList:[],trackerBlockingEnabled:!1,adBlockingEnabled:!1,blockerSources:[],newException:{name:"",level:"2"},addExceptionDialog:!1,showSources:!1,incorrectFormat:!1};componentDidMount(){this.getRules(),this.updateExceptions(),C.Z.contentBlocking.onExceptionsChanged.addListener(this.updateExceptions),C.Z.contentBlocking.onStateChanged.addListener(this.getRules)}componentWillUnmount(){C.Z.contentBlocking.onExceptionsChanged.removeListener(this.updateExceptions),C.Z.contentBlocking.onStateChanged.removeListener(this.getRules)}getRules=()=>UF.forEach((e=>(0,mS.pg)(e,(e=>{this.setState(e,(()=>this.updateExceptions()))}))));updateExceptions=()=>C.Z.contentBlocking.getAllExceptionLists((e=>{const t=Object.values(e).reduce(((e,t)=>e=e.concat(t.exempt_list).concat(t.process_list)),[]),n=this.remapExceptions((0,VF.Z)(t).sort());this.setState({exceptionRules:e,exceptionList:n})}));setDefaultBlocking=e=>{const{value:t}=e.target;switch(t){case"0":C.Z.contentBlocking.setActiveExceptionsList("tracking","process_list"),C.Z.contentBlocking.setActiveExceptionsList("ad_blocking","process_list");break;case"1":C.Z.contentBlocking.setActiveExceptionsList("tracking","exempt_list"),C.Z.contentBlocking.setActiveExceptionsList("ad_blocking","process_list");break;case"2":C.Z.contentBlocking.setActiveExceptionsList("tracking","exempt_list"),C.Z.contentBlocking.setActiveExceptionsList("ad_blocking","exempt_list")}this.getRules()};deleteException=e=>{if("number"==typeof e&&this.state.exceptionList){const t=this.state.exceptionList[e].key;["tracking","ad_blocking"].forEach((e=>["process_list","exempt_list"].forEach((n=>C.Z.contentBlocking.removeExceptionForDomain(e,n,t))))),this.updateExceptions()}};deleteAllExceptions=()=>{["tracking","ad_blocking"].forEach((e=>["process_list","exempt_list"].forEach((t=>C.Z.contentBlocking.removeAllExceptions(e,t))))),this.updateExceptions()};remapExceptions=e=>e?e.map((e=>({key:e,name:e}))):[];onContextMenu=(e,t)=>{const n=[{handler:this.deleteException.bind(null,e),...(0,xs.Z)("Remove Site")},{handler:this.deleteAllExceptions,...(0,xs.Z)("Remove All Sites from List")}];(0,Qi.Z)(this.context,n)(t)};updateNewException=e=>{const t=e.currentTarget;"name"===t.name?this.setState((e=>({newException:{...e.newException,name:t.value}}))):this.setState((e=>({newException:{...e.newException,level:t.value}})))};onAddNewException=()=>this.setState({addExceptionDialog:!0});onClose=()=>this.setState((e=>({newException:{...e.newException,name:""},addExceptionDialog:!1,incorrectFormat:!1})));toggleSources=()=>this.setState((e=>({showSources:!e.showSources})));saveException=()=>{const{newException:e}=this.state,t=(0,vs.Ph)((0,vs.Qj)(e.name));t?((0,mS.fs)(t,e.level),this.onClose()):this.setState({incorrectFormat:!0})};getPageBlockingLevel=e=>{const{exceptionRules:t}=this.state;if(!t)return;let n=0;return!t.tracking.process_list.includes(e)&&t.tracking.exempt_list.includes(e)||n++,!t.ad_blocking.process_list.includes(e)&&t.ad_blocking.exempt_list.includes(e)||n++,n};changePageBlocking=e=>{const{name:t,value:n}=e.target,s=G.ZP.isSettings(G.ZP.getActiveWindowId())?void 0:ie.ZP.getActivePage(G.ZP.getLastActiveBrowserWindowId())?.id;(0,mS.fs)(t,n,s)};renderModal=()=>WF(_r.Z,{style:HF,onRequestClose:this.onClose,viewMode:"float"},void 0,WF("form",{className:"ContentBlocker-Exception"},void 0,WF("header",{className:"dialog-header"},void 0,WF("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("Add a New Site to Exception List"))),WF("div",{className:"dialog-content"},void 0,WF("input",{type:"text",name:"name",placeholder:(0,Oe.Z)("e.g. example.com"),value:this.state.newException.name,onChange:this.updateNewException,autoFocus:!0}),this.state.incorrectFormat&&WF("p",{className:"info"},void 0,(0,Oe.Z)("Enter a valid domain name excluding the protocol")),WF("select",{value:this.state.newException.level,onChange:this.updateNewException,name:"level"},void 0,WF("option",{value:"0"},void 0,(0,Oe.Z)("No Blocking")),WF("option",{value:"1"},void 0,(0,Oe.Z)("Block Trackers")),WF("option",{value:"2"},void 0,(0,Oe.Z)("Block Trackers and Ads")))),WF("footer",{className:"dialog-footer"},void 0,WF("input",{type:"submit",className:"primary",onClick:this.saveException,value:(0,Oe.Z)("other","Add Site")}),WF("input",{type:"button",onClick:this.onClose,value:(0,Oe.Z)("Cancel")}))));onSelectItem=e=>{const{HTMLSelectElement:t}=this.context,n=this._refSelect.current?.refItems.current?.children;if(!n||0===n.length)return;const s=n[e].children[1];s instanceof t&&(this.currentSelection=s)};onActivate=(e,t)=>{t.target!==this.currentSelection&&this.currentSelection?.focus()};renderItem=(e,t)=>{if(!t)return null;const n=this.getPageBlockingLevel(t.key);return(0,fs.jsxs)(fs.Fragment,{children:[WF("span",{},void 0,e),WF("select",{value:n,name:t.name,onMouseDown:e=>e.stopPropagation(),onChange:this.changePageBlocking,tabIndex:"-1"},void 0,WF("option",{value:"0"},void 0,(0,Oe.Z)("No Blocking")),WF("option",{value:"1"},void 0,(0,Oe.Z)("Block Trackers")),WF("option",{value:"2"},void 0,(0,Oe.Z)("Block Trackers and Ads")))]})};render(){const e=0+(this.state.trackerBlockingEnabled?1:0)+(this.state.adBlockingEnabled?1:0);return WF(mN,{categoryTitle:(0,Oe.Z)("title","Tracker and Ad Blocking"),"data-anchor":"tracker_and_ad_blocking",filter:this.props.filter},void 0,this.state.addExceptionDialog&&this.renderModal(),WF("div",{className:"ContentBlocker-Rules"},void 0,WF("div",{className:"setting-group setting-group-double"},void 0,WF("h3",{},void 0,(0,Oe.Z)("Blocking Level")),WF("p",{className:"info"},void 0,(0,Oe.Z)("Select default level of protection.")),WF("label",{className:As()({"ContentBlocker-Setting":!0,"ContentBlocker-Setting--Active":0===e})},void 0,WF("button",{value:"0",title:(0,Oe.Z)("No content blocking will be applied to any site by default."),onClick:this.setDefaultBlocking,className:"ContentBlocker-Control",style:{"--no-blocking":1,"--base":0},dangerouslySetInnerHTML:{__html:Ts.Tu3}}),WF("span",{className:"keep-ea-words"},void 0,(0,Oe.Z)("No Blocking"))),WF("label",{className:As()({"ContentBlocker-Setting":!0,"ContentBlocker-Setting--Active":1===e})},void 0,WF("button",{value:"1",title:(0,Oe.Z)("Online trackers collect personal information and browsing habits across multiple sites."),onClick:this.setDefaultBlocking,className:"ContentBlocker-Control",style:{"--trackers":1},dangerouslySetInnerHTML:{__html:Ts.Tu3}}),WF("span",{className:"keep-ea-words"},void 0,(0,Oe.Z)("Block Trackers"))),WF("label",{className:As()({"ContentBlocker-Setting":!0,"ContentBlocker-Setting--Active":2===e})},void 0,WF("button",{value:"2",title:(0,Oe.Z)("Web advertisement supports existence of many sites but can also be used to build a personal profile for monetization."),onClick:this.setDefaultBlocking,className:"ContentBlocker-Control",style:{"--ads":1},dangerouslySetInnerHTML:{__html:Ts.Tu3}}),WF("span",{className:"keep-ea-words"},void 0,(0,Oe.Z)("Block Trackers and Ads")))),WF("div",{className:"setting-group setting-group-double"},void 0,WF("h3",{},void 0,(0,Oe.Z)("Exceptions")),WF("p",{className:"info"},void 0,(0,Oe.Z)("Manage blocking level per site")),this.state.exceptionList&&WF("div",{className:"ContentBlocker-Exceptions"},void 0,(0,fs.jsx)(x_.Z,{ref:this._refSelect,items:this.state.exceptionList,renderListItem:this.renderItem,filter:this.props.filter,onContextMenu:this.onContextMenu,onCreateItem:this.onAddNewException,onRemove:this.deleteException,addTipString:(0,Oe.Z)("Add Site Exception"),deleteTipString:(0,Oe.Z)("Remove Site Exception"),supportDragAndDrop:!1,onSelectItem:this.onSelectItem,onActivate:this.onActivate})),WF("input",{type:"button",value:this.state.showSources?(0,Oe.Z)("Hide Sources"):(0,Oe.Z)("Manage Sources"),onClick:this.toggleSources})),this.state.showSources&&(0,fs.jsxs)(fs.Fragment,{children:[WF("div",{className:"setting-group setting-group-double"},void 0,WF("div",{className:"setting-single"},void 0,WF(BF,{filter:this.props.filter,ruleGroup:"tracking",title:(0,Oe.Z)("Tracker Blocking Sources")}))),WF("div",{className:"setting-group setting-group-double"},void 0,WF("div",{className:"setting-single"},void 0,WF(BF,{filter:this.props.filter,ruleGroup:"ad_blocking",title:(0,Oe.Z)("Ad Blocking Sources")})))]})))}}const GF=zF;var $F;function KF(e,t,n,s){$F||($F="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:$F,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class jF extends hs.PureComponent{refButton=hs.createRef();handleDelete=async e=>{(0,to.ZP)(e),this.props.onDeleteCookie(this.props.domain,this.props.viewInfo)};toggleDetail=()=>{this.props.viewCookies?(this.props.onCollapse(this.props.domain),this.props.onHideInfo(this.props.domain)):this.props.onExpand(this.props.domain)};showDetail=()=>{this.props.onExpand(this.props.domain)};hideDetail=()=>{this.props.onHideInfo(this.props.domain),this.props.onCollapse(this.props.domain)};handleRowClicked=e=>{this.refButton.current?.focus(),this.toggleDetail()};showInfo=e=>{this.props.onShowInfo(this.props.domain,e)};focusCookie=e=>{const t=e.currentTarget,n=this.refButton.current?.querySelectorAll("a");if(n?.length)switch(e.key){case"ArrowRight":let e=Array.from(n).indexOf(t)+1;e>=n.length&&(e=0),n[e].focus();break;case"ArrowLeft":const s=Array.from(n).indexOf(t)-1;s<0?(this.toggleDetail(),this.refButton.current?.focus()):n[s].focus()}};handleKeyDown=(e,t)=>{switch((0,to.ZP)(e),e.key){case"Enter":this.toggleDetail();break;case"ArrowRight":this.props.viewCookies?this.focusCookie(e):this.showDetail();break;case"ArrowLeft":this.focusCookie(e);break;case"Escape":this.hideDetail(),this.refButton.current?.focus();break;case"Delete":this.props.onDeleteCookie(this.props.domain,this.props.viewInfo);break;default:this.props.onKeyDown(e)}};renderCookies=()=>this.props.items.map(((e,t)=>KF("a",{tabIndex:"0",onFocus:()=>this.showInfo(e),onKeyDown:e=>this.handleKeyDown(e,t),title:e.name},"cookie-"+e.name.toLowerCase(),e.name)));renderInfo=()=>{if(!this.props.viewInfo)return null;const{expirationDate:e,path:t,hostOnly:n,httpOnly:s,session:i,secure:o,value:a}=this.props.viewInfo,r=e&&N()(Math.round(1e3*e)).format("l LT");return KF("dl",{},void 0,KF("dt",{},void 0,(0,Oe.Z)("Expires:")),KF("dd",{},void 0,r),KF("dt",{},void 0,(0,Oe.Z)("Path:")),KF("dd",{},void 0,t),KF("dt",{},void 0,(0,Oe.Z)("Host Only:")),KF("dd",{},void 0,n.toString()),KF("dt",{},void 0,(0,Oe.Z)("HTTP Only:")),KF("dd",{},void 0,s.toString()),KF("dt",{},void 0,(0,Oe.Z)("Session:")),KF("dd",{},void 0,i.toString()),KF("dt",{},void 0,(0,Oe.Z)("Secure:")),KF("dd",{},void 0,o.toString()),KF("dt",{},void 0,(0,Oe.Z)("Value:")),KF("dd",{},void 0,a))};render(){const{domain:e}=this.props,t=e.replace(/^\./,""),n=(0,vs.q9)(t);return(0,fs.jsxs)("button",{id:e,ref:this.refButton,style:this.props.style,onKeyDown:this.handleKeyDown,children:[KF("div",{className:"overview",onClick:this.handleRowClicked},void 0,KF(Ss,{className:"site-icon",url:n,loadType:"page"}),e,!this.props.viewCookies&&KF("span",{className:"count"},void 0,this.props.count),KF("span",{className:"controls"},void 0,KF("input",{type:"button",className:"circular clearkey",tabIndex:-1,title:this.props.viewInfo?(0,Oe.Z)("Delete selected cookie"):(0,Oe.Z)("Delete cookies"),onClick:this.handleDelete}))),this.props.viewCookies&&KF("div",{className:"detail"},void 0,this.renderCookies(),this.props.viewInfo&&KF("div",{className:"info"},void 0,this.renderInfo()))]})}}const YF=jF;var XF,QF=n(78330),qF=n(34155);function JF(e,t,n,s){XF||(XF="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:XF,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const eV={width:400,minWidth:"unset"};class tV extends hs.PureComponent{static contextType=xi.Z;refList=hs.createRef();visibleCookies=new Map;state={cookieData:{},cookieFilter:"",confirmation:!1,showCookies:!1,domains:[],expandedItems:[]};componentDidMount(){s.Z.cookies.onChanged.addListener(this.cookieChangeListener),this.getAllCookies()}componentWillUnmount(){s.Z.cookies.onChanged.removeListener(this.cookieChangeListener)}cookieChangeListener=e=>{const{removed:t}=e;t&&this.debouncedGetAllCookies()};getAllCookies=async()=>{const e=(await s.Z.cookies.getAll({})).reduce(((e,t)=>{const n=e[t.domain]||[];return n.push(t),e[t.domain]=n,e}),{}),t=this.state.cookieFilter.toLowerCase();this.setState({cookieData:e,domains:Object.keys(e).filter((e=>e.includes(t))).sort()},(()=>{qF.nextTick((()=>{this.refList.current?.recomputeRowHeights(),this.refList.current?.forceUpdate()}))}))};debouncedGetAllCookies=(0,no.Z)(this.getAllCookies);deleteFilteredCookies=async()=>{const e=await s.Z.cookies.getAll({});await Promise.all(e.map((e=>e.domain.toLowerCase().includes(this.state.cookieFilter.toLowerCase())?s.Z.cookies.remove({url:this.getCookieUrl(e),name:e.name}):Promise.resolve())))};deleteAllCookies=async()=>{const e=await s.Z.cookies.getAll({});await Promise.all(e.map((e=>s.Z.cookies.remove({url:this.getCookieUrl(e),name:e.name})))),this.setState({cookieData:{},confirmation:!1,showCookies:!1,domains:[]})};getButtons=()=>Array.from(this.context.document.querySelectorAll(".setting-group.setting-cookies button"));getCookieUrl=e=>"http"+(e.secure?"s":"")+"://"+e.domain+e.path;removeChromeEntry=async e=>{await s.Z.cookies.remove({url:this.getCookieUrl(e),name:e.name})};handleDeleteCookie=async(e,t)=>{const{cookieData:n}=this.state,s=n[e];t&&s.length>1?(this.focusNextCookie(e,t),await this.removeChromeEntry(t)):(this.collapseRow(e),qF.nextTick((()=>{this.focusNextRow(e),Promise.all(s.map(this.removeChromeEntry))})))};focusNextRow=e=>{const t=this.getButtons(),n=t.findIndex((t=>t.id===e));(t[n+1]??t[n-1])?.focus()};focusNextCookie=(e,t)=>{const n=this.getButtons().find((t=>t.id===e)),s=Array.from(n?.querySelectorAll("a")??[]),i=s.findIndex((e=>e.title===t.name));(s[i+1]??s[i-1]??s[0])?.focus()};onSettingsFilter=e=>{this.setState({cookieFilter:e.target.value},(()=>{hs.startTransition((()=>{const e=this.state.cookieFilter.toLowerCase();this.setState((t=>({domains:Object.keys(t.cookieData).filter((t=>t.includes(e))).sort()})))}))}))};onAskToDelete=()=>{this.setState({confirmation:!0})};onCancel=()=>{this.setState({confirmation:!1})};renderModal=()=>JF(_r.Z,{style:eV,onRequestClose:this.onCancel},void 0,JF("div",{className:"dialog-delete-cookies"},void 0,JF("header",{className:"dialog-header"},void 0,JF("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("Delete All Cookies?"))),JF("div",{className:"dialog-content"},void 0,JF("p",{},void 0,(0,Oe.Z)("All cookies will be removed."))),JF("footer",{className:"dialog-footer"},void 0,JF("input",{type:"button",className:"primary",onClick:this.deleteAllCookies,value:(0,Oe.Z)("other","Delete"),autoFocus:!0}),JF("input",{type:"button",onClick:this.onCancel,value:(0,Oe.Z)("Cancel")}))));showCookieList=()=>{this.setState((e=>({showCookies:!e.showCookies})))};handleKeyDown=e=>{(0,to.ZP)(e);const{HTMLAnchorElement:t}=this.context,n=e.currentTarget instanceof t?e.currentTarget.parentElement?.parentElement:e.currentTarget,s=this.getButtons();if(s?.length)switch(e.key){case"ArrowUp":const i=Array.from(s).indexOf(n),o=e.currentTarget instanceof t?i:i-1;o>=0&&s[o].focus();break;case"Delete":case"ArrowDown":const a=Array.from(s).indexOf(n)+1;a<s.length&&s[a].focus();break;default:return}};handleExpandRow=e=>{this.setState((t=>({expandedItems:t.expandedItems.concat([e])}))),this.refList.current?.recomputeRowHeights(),this.refList.current?.forceUpdate()};collapseRow=e=>{this.setState((t=>({expandedItems:t.expandedItems.filter((t=>t!==e))}))),this.refList.current?.recomputeRowHeights(),this.refList.current?.forceUpdate()};handleShowInfo=(e,t)=>{this.visibleCookies.set(e,t),this.refList.current?.recomputeRowHeights(),this.refList.current?.forceUpdate()};hideInfo=e=>{this.visibleCookies.delete(e),this.refList.current?.recomputeRowHeights(),this.refList.current?.forceUpdate()};getRowHeight=({index:e})=>{const t=this.state.domains[e];if(this.state.expandedItems.includes(t)){const e=this.refList.current?.props.width,n=e?Math.floor(e/110):1,s=1+Math.ceil(this.state.cookieData[t].length/n);return this.visibleCookies.get(t)?28*(7+s):28*s}return 28};renderRow=({index:e,parent:t,key:n,style:s})=>{const{domains:i,expandedItems:o,cookieData:a}=this.state,r=i[e],l=a[r];return JF(YF,{style:s,domain:r,count:l.length,items:l,onKeyDown:this.handleKeyDown,onExpand:this.handleExpandRow,onCollapse:this.collapseRow,viewCookies:o.includes(r),viewInfo:this.visibleCookies.get(r),onShowInfo:this.handleShowInfo,onHideInfo:this.hideInfo,onDeleteCookie:this.handleDeleteCookie},"domain-"+r)};render(){if(!this.state.cookieData)return JF("div",{className:"saved-passwords"},void 0,JF("p",{},void 0,(0,Oe.Z)("No cookies found.")));const{cookieData:e,cookieFilter:t,domains:n}=this.state,s=n.length,i=n.reduce(((t,n)=>t+e[n].length),0);return JF(US.Z,{filter:this.props.filter},void 0,JF("div",{className:"setting-group setting-cookies unlimited"},void 0,this.state.confirmation&&this.renderModal(),JF("h3",{},void 0,(0,Oe.Z)("Saved Cookies")),JF("p",{},void 0,(0,Oe.Z)("Vivaldi currently stores $1 from $2.",[(0,Oe.Z)("$1 cookie entry","$1 cookie entries",[i]),(0,Oe.Z)("$1 domain","$1 domains",[s])])),this.state.showCookies&&(0,fs.jsxs)(fs.Fragment,{children:[JF("div",{className:"setting-single"},void 0,JF("input",{type:"search",placeholder:(0,Oe.Z)("Filter by domain"),value:t,onChange:this.onSettingsFilter})),0===s&&t&&JF("div",{className:"empty-cookie-items"},void 0,(0,Oe.Z)("Query “$1” matches no result.",[t])),JF("div",{className:"cookie-list"},void 0,JF("div",{className:"setting-single cookie-items"},void 0,JF(QF.q,{},void 0,(({height:e,width:t})=>(0,fs.jsx)(lo.aV,{ref:this.refList,width:t,height:e,rowHeight:this.getRowHeight,rowRenderer:this.renderRow,rowCount:s})))))]}),JF("div",{className:"setting-single"},void 0,JF("input",{type:"button",value:this.state.showCookies?(0,Oe.Z)("Hide Saved Cookies"):(0,Oe.Z)("Show Saved Cookies"),disabled:0===i,onClick:this.showCookieList}),JF("input",{type:"button",className:"danger",onClick:this.onAskToDelete,disabled:0===i,value:(0,Oe.Z)("Delete All Cookies")}),t&&JF("input",{type:"button",onClick:this.deleteFilteredCookies,value:(0,Oe.Z)("Delete Filtered Cookies")}))))}}const nV=tV;var sV;function iV(e,t,n,s){sV||(sV="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:sV,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class oV extends hs.Component{state={cookieSetting:"",cookieMode:"off"};componentDidMount(){C.Z.utilities.getDefaultContentSettings("cookies",(e=>{this.setState({cookieSetting:e})})),C.Z.utilities.getBlockThirdPartyCookies((e=>{this.setState({cookieMode:e})}))}handleCookieModeChange=e=>{const t=e.target.value;C.Z.utilities.setBlockThirdPartyCookies(t,(e=>{})),this.setState({cookieMode:t})};render(){const e="block"===this.state.cookieSetting;return iV(mN,{categoryTitle:(0,Oe.Z)("Cookies"),filter:this.props.filter},void 0,iV("p",{className:"info"},void 0,(0,Oe.Z)("Manage default cookie policy in Global Website Permissions.")),iV(nV,{filter:this.props.filter}),iV("div",{className:"setting-group"},void 0,iV("h3",{},void 0,(0,Oe.Z)("Third-Party Cookies")),iV("p",{className:"info"},void 0,(0,Oe.Z)("Disabling third party cookies might make some pages fail to work as intended.")),iV(vl,{className:"cookieSelection",name:"cookieSelGroup2",value:this.state.cookieMode,onChange:this.handleCookieModeChange},void 0,iV("div",{className:"setting-single"},void 0,iV("label",{},void 0,iV("input",{type:"radio",value:"off",disabled:e}),iV("span",{},void 0,(0,Oe.Z)("radio","Allow All")))),iV("div",{className:"setting-single"},void 0,iV("label",{},void 0,iV("input",{type:"radio",value:"BlockThirdPartyIncognitoOnly",disabled:e}),iV("span",{},void 0,(0,Oe.Z)("radio","Block in Incognito Mode Only")))),iV("div",{className:"setting-single"},void 0,iV("label",{},void 0,iV("input",{type:"radio",value:"BlockThirdParty",disabled:e}),iV("span",{},void 0,(0,Oe.Z)("radio","Block All")))))))}}const aV=oV;var rV;function lV(e,t,n,s){rV||(rV="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:rV,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const dV=[$.kDownloadDefaultDirectory,$.kDownloadsNotifyOnComplete,$.kDownloadsOpenPanelOnNew,$.kDownloadsStartAutomatically,$.kDownloadsUpdateDefaultDownloadWhenSavingAs],cV=Ne.Z.getEventHandler;class hV extends hs.Component{static contextType=xi.Z;selectDownloadFolder=()=>{C.Z.utilities.selectFile({windowId:this.context.vivaldiWindowId,title:(0,Oe.Z)("Select Download Folder"),type:"folder"}).then((e=>{e&&Ne.Z.set($.kDownloadDefaultDirectory,e)}))};render(){return lV(mN,{categoryTitle:(0,Oe.Z)("Downloads"),filter:this.props.filter,className:"setting-group unlimited"},void 0,lV("div",{className:"setting-subgroup"},void 0,lV("h3",{},void 0,(0,Oe.Z)("Download Location")),lV("div",{className:"setting-single"},void 0,lV("div",{className:"setting-single folder-selection"},void 0,lV("input",{type:"text",value:this.props.prefValues[$.kDownloadDefaultDirectory],title:(0,Oe.Z)("Enter Default Download Directory Path"),onChange:cV($.kDownloadDefaultDirectory)}),lV("input",{type:"button",value:(0,Oe.Z)("Select Folder..."),onClick:this.selectDownloadFolder}))),lV("div",{className:"setting-single pad-top"},void 0,lV("label",{},void 0,lV("input",{type:"checkbox",checked:this.props.prefValues[$.kDownloadsStartAutomatically],onChange:cV($.kDownloadsStartAutomatically)}),lV("span",{},void 0,(0,Oe.Z)("Save Files to Default Location Without Asking")))),lV("div",{className:"setting-single"},void 0,lV("label",{},void 0,lV("input",{type:"checkbox",checked:this.props.prefValues[$.kDownloadsUpdateDefaultDownloadWhenSavingAs],onChange:cV($.kDownloadsUpdateDefaultDownloadWhenSavingAs)}),lV("span",{},void 0,(0,Oe.Z)("Update Default Location When Choosing Save as Location")))),lV("div",{className:"setting-single"},void 0,lV("label",{},void 0,lV("input",{type:"checkbox",checked:this.props.prefValues[$.kDownloadsOpenPanelOnNew],onChange:cV($.kDownloadsOpenPanelOnNew)}),lV("span",{},void 0,(0,Oe.Z)("Display Downloads Automatically")))),lV("div",{className:"setting-single"},void 0,lV("label",{},void 0,lV("input",{type:"checkbox",checked:this.props.prefValues[$.kDownloadsNotifyOnComplete],onChange:cV($.kDownloadsNotifyOnComplete)}),lV("span",{},void 0,(0,Oe.Z)("Notify on Completed Downloads"))))))}}const pV=sa(hV,dV);var uV;function gV(e,t,n,s){uV||(uV="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:uV,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const mV={standard:{localizedFamily:(0,Oe.Z)("Standard")},sansserif:{localizedFamily:(0,Oe.Z)("Sans-serif")},serif:{localizedFamily:(0,Oe.Z)("Serif")},fixed:{localizedFamily:(0,Oe.Z)("Monospaced")},cursive:{localizedFamily:(0,Oe.Z)("Cursive")},fantasy:{localizedFamily:(0,Oe.Z)("Fantasy")}},vV=[9,10,11,12,13,14,16,18,20,24],fV=[0,4,6,7,8,...vV],yV=[$.kWebKitDefaultFontSize,$.kWebKitMinimumFontSize],CV=Ne.Z.getEventHandler;class wV extends hs.Component{state={fontList:[],fonts:{}};componentDidMount(){s.Z.fontSettings.onFontChanged.addListener(this._getFonts),s.Z.fontSettings.getFontList((e=>{this.setState({fontList:e})})),this.mapObject(mV,((e,t)=>{s.Z.fontSettings.getFont({genericFamily:e},(n=>{this.setState((s=>({fonts:{...s.fonts,[e]:{font:n.fontId,localizedFamily:t.localizedFamily}}})))}))}))}componentWillUnmount(){s.Z.fontSettings.onFontChanged.removeListener(this._getFonts)}_getFonts=e=>{this.setState((t=>({fonts:{...t.fonts,[e.genericFamily]:{font:e.fontId,localizedFamily:mV[e.genericFamily].localizedFamily}}})))};mapObject=(e,t)=>Object.keys(e).map((n=>t(n,e[n])));changeHandler=(e,t)=>{let n=$.kWebKitStandardFontFamily;switch(e){case"standard":n=$.kWebKitStandardFontFamily;break;case"fantasy":n=$.kWebKitFantasyFontFamily;break;case"fixed":n=$.kWebKitFixedFontFamily;break;case"sansserif":n=$.kWebKitSansSerifFontFamily;break;case"serif":n=$.kWebKitSerifFontFamily;break;case"cursive":n=$.kWebKitCursiveFontFamily}Ne.Z.set(n,t.target.value)};renderOptions=e=>{const t="default"===e?parseInt(this.props.prefValues[$.kWebKitDefaultFontSize]):parseInt(this.props.prefValues[$.kWebKitMinimumFontSize]),n="default"===e?vV:fV;return n.includes(t)||(n.push(t),n.sort(((e,t)=>e-t))),n.map((e=>gV("option",{},e,e)))};render(){const{prefValues:e}=this.props,t=this.state.fontList.map((e=>gV("option",{value:e.fontId},e.fontId,e.displayName)));return gV(mN,{categoryTitle:(0,Oe.Z)("Fonts"),filter:this.props.filter,className:"setting-group unlimited"},void 0,gV("div",{className:"setting-group-double font-slider"},void 0,gV("label",{},void 0,gV("span",{},void 0,(0,Oe.Z)("Default Font Size")),gV("span",{className:"fake-dataset"},void 0,gV("input",{type:"number",min:"6",max:"99",value:e[$.kWebKitDefaultFontSize],onChange:CV($.kWebKitDefaultFontSize)}),gV("select",{value:e[$.kWebKitDefaultFontSize],onChange:CV($.kWebKitDefaultFontSize)},void 0,this.renderOptions("default")))),gV("label",{},void 0,gV("span",{},void 0,(0,Oe.Z)("Minimum Font Size")),gV("span",{className:"fake-dataset"},void 0,gV("input",{type:"number",min:"0",max:"99",value:e[$.kWebKitMinimumFontSize],onChange:CV($.kWebKitMinimumFontSize)}),gV("select",{value:e[$.kWebKitMinimumFontSize],onChange:CV($.kWebKitMinimumFontSize)},void 0,this.renderOptions("minimum"))))),gV("div",{className:"setting-group-double pad-top font-face-list"},void 0,gV("h3",{},void 0,(0,Oe.Z)("Default Fonts")),this.mapObject(this.state.fonts,((e,n)=>gV("label",{className:"setting-single"},e,gV("span",{},void 0,n.localizedFamily),gV("select",{onChange:this.changeHandler.bind(this,e),value:n.font},void 0,t))))))}}const bV=sa(wV,yV);var SV;function IV(e,t,n,s){SV||(SV="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:SV,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const kV=[$.kHueBridgeIp,$.kHueEnabled,$.kHueLights,$.kHueUsername];class AV extends hs.PureComponent{initialState=()=>{const{lights:e,groups:t}=U.getState();return{groups:t,lights:e,validBridge:!1,validUsername:!1,waitingForButtonPress:!1,givenUp:!1,manualIp:""}};_isMounted=!1;state=this.initialState();componentDidMount(){this._isMounted=!0,U.addListener(this.onHueStoreChanged),this.props.prefValues[$.kHueEnabled]&&this.props.prefValues[$.kHueBridgeIp]&&this.verifyBridge()}componentWillUnmount(){U.removeListener(this.onHueStoreChanged),this._isMounted=!1}onHueStoreChanged=()=>{const{lights:e,groups:t}=U.getState();this.setState({lights:e,groups:t})};verifyBridge=()=>{const e=H.Z.get($.kHueBridgeIp);e?fetch(`http://${e}/description.xml`).then((e=>{e.ok?this.setState({validBridge:!0},this.verifyUsername):this.getBridge()})).catch((e=>{this.getBridge()})):this.getBridge()};getBridge=()=>{fetch("https://discovery.meethue.com/").then((e=>{e.ok?e.json().then((e=>{e&&e[0]&&e[0].internalipaddress?(Ne.Z.set($.kHueBridgeIp,e[0].internalipaddress),this.verifyBridge()):this.setState({givenUp:!0})})):this.setState({givenUp:!0})})).catch((e=>{this.setState({givenUp:!0})}))};setBridge=()=>{Ne.Z.set($.kHueBridgeIp,this.state.manualIp),this.verifyBridge()};verifyUsername=()=>{const e=H.Z.get($.kHueBridgeIp),t=H.Z.get($.kHueUsername);t?fetch(`http://${e}/api/${t}/`).then((e=>{e.ok?e.json().then((e=>{e[0]?.error?(Ne.Z.set($.kHueUsername,""),this.getUsername()):e?.config&&this.setState({validUsername:!0,waitingForButtonPress:!1},Q.updateLights)})):this.setState({givenUp:!0})})).catch((e=>{this.setState({givenUp:!0})})):this.getUsername()};getUsername=()=>{const e=H.Z.get($.kHueBridgeIp);e&&fetch(`http://${e}/api`,{method:"POST",body:JSON.stringify({devicetype:"vivaldi_browser#desktop_hue"})}).then((e=>{e.ok?e.json().then((e=>{e[0]?.success?.username?(Ne.Z.set($.kHueUsername,e[0].success.username),this.verifyUsername()):e[0]?.error&&101===e[0].error.type&&(this.setState({waitingForButtonPress:!0}),setTimeout((()=>{this._isMounted&&this.getUsername()}),1e3))})):this.setState({givenUp:!0})})).catch((e=>{this.setState({givenUp:!0})}))};toggleLight=(e,t)=>{const n=!H.Z.get($.kHueLights).includes(t),s=H.Z.get($.kHueLights).filter((e=>e!==t));n&&s.push(t),Q.flash(e),Ne.Z.set($.kHueLights,s)};resetBridge=()=>{Ne.Z.reset($.kHueBridgeIp),Ne.Z.reset($.kHueUsername),this.setState(this.initialState())};changeManualIp=e=>{this.setState({manualIp:e.currentTarget.value})};render(){const e=this.props.prefValues[$.kHueEnabled],t=this.props.prefValues[$.kHueLights],{waitingForButtonPress:n,validBridge:s,validUsername:i,groups:o,lights:a}=this.state;return IV(mN,{categoryTitle:(0,Oe.Z)("Philips Hue Theme Integration"),filter:this.props.filter},void 0,IV("div",{className:"setting-group"},void 0,IV("div",{className:"setting-single"},void 0,IV("label",{},void 0,IV("input",{type:"checkbox",checked:e,onChange:Ne.Z.getEventHandler($.kHueEnabled)}),IV("span",{},void 0,(0,Oe.Z)("Enable Hue"))),IV("p",{className:"info"},void 0,e&&s&&!n?(0,Oe.Z)("Connected to Hue Bridge at $1.",[this.props.prefValues[$.kHueBridgeIp]]):(0,Oe.Z)("Requires a Philips Hue lighting system on the local network.")))),e&&s&&IV("div",{className:"setting-group"},void 0,IV("input",{type:"button",className:"danger",value:(0,Oe.Z)("Reset Bridge Connection"),onClick:this.resetBridge})),e&&(!s||n)&&IV("div",{className:"setting-group unlimited"},void 0,IV("h3",{},void 0,(0,Oe.Z)("Bridge Discovery")),!n&&IV("div",{className:"setting-group"},void 0,IV(sc.Z,{type:"text",onChange:this.changeManualIp,label:(0,Oe.Z)("Bridge IP (Leave blank to autodiscover)"),placeholder:"127.0.0.1",value:this.state.manualIp}),IV("div",{className:"setting-single"},void 0,IV("input",{type:"button",className:"primary",value:this.state.manualIp?(0,Oe.Z)("Connect"):(0,Oe.Z)("Find Bridge"),onClick:this.state.manualIp?this.setBridge:this.getBridge}))),n&&IV("div",{className:"setting-group unlimited"},void 0,IV("p",{className:"info"},void 0,(0,Oe.Z)("Found Bridge at $1. Waiting for button press...",[this.props.prefValues[$.kHueBridgeIp]])),IV("div",{className:"hue-press-button",dangerouslySetInnerHTML:{__html:`${Ts.I_V}${(0,Oe.Z)("Press the button on your Bridge")}`}}))),e&&i&&o.size>0&&a.size>0&&IV("div",{className:"setting-group unlimited"},void 0,IV("p",{className:"info"},void 0,(0,Oe.Z)("Only lights that support color can be selected."),"* "+(0,Oe.Z)("Light currently unreachable.")),[...o.keys()].map((e=>IV("div",{className:"setting-group"},e,IV("h3",{},void 0,o.get(e)?.name),o.get(e)?.lights.map((e=>{const n=a.get(e);if(!n)return null;const s=t&&t.some((e=>e===n.uniqueid)),i=n.type.toLowerCase().includes("color light");return IV("div",{className:"setting-single"},n.uniqueid,IV("label",{},void 0,IV("input",{type:"checkbox",checked:s,disabled:!i,onChange:()=>{this.toggleLight(e,n.uniqueid)}}),IV("span",{},void 0,n.name,!n.state.reachable&&"*")))})))))))}}const TV=sa(AV,kV);var ZV;function EV(e,t,n,s){ZV||(ZV="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:ZV,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const _V=[$.kWebpagesAccessKeys],MV=Ne.Z.getEventHandler;class NV extends hs.Component{render(){return EV(US.Z,{filter:this.props.filter},void 0,EV("div",{className:"setting-group"},void 0,EV("h3",{},void 0,(0,Oe.Z)("Access Keys")),EV("div",{className:"setting-single"},void 0,EV("label",{},void 0,EV("input",{type:"checkbox",checked:this.props.prefValues[$.kWebpagesAccessKeys],onChange:MV($.kWebpagesAccessKeys)}),EV("span",{},void 0,(0,Oe.Z)("Allow Access Keys"))),EV("p",{className:"info"},void 0,(0,Oe.Z)("Some websites may use this accessibility feature to register shortcuts for certain elements, using $1 modifier.",["Shift+Alt"])))))}}const PV=sa(NV,_V),DV=function(e){switch(e){case"CATEGORY_COMMAND_APPLICATION":return(0,Oe.Z)("win_linux","Window");case"CATEGORY_COMMAND_APPEARANCE":return(0,Oe.Z)("win_linux","View");case"CATEGORY_COMMAND_TAB_ACTION":return(0,Oe.Z)("command","Tab");case"CATEGORY_COMMAND_WEBPAGE_NAVIGATION":return(0,Oe.Z)("Page");case"CATEGORY_COMMAND_MAIL":return(0,Oe.Z)("Mail");case"CATEGORY_COMMAND_CALENDAR":return(0,Oe.Z)("Calendar");case"CATEGORY_COMMAND_CHAIN":return(0,Oe.Z)("Chains");case"CATEGORY_COMMAND_WORKSPACE_ACTION":return(0,Oe.Z)("Workspaces");default:return"Unknown"}};var xV;function OV(e,t,n,s){xV||(xV="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:xV,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const LV=Ne.Z.getEventHandler;class RV extends hs.Component{render(){return OV(US.Z,{filter:this.props.filter},void 0,OV("div",{className:"setting-group"},void 0,OV("h3",{},void 0,(0,Oe.Z)("Keyboard Shortcuts")),OV("div",{className:"setting-single"},void 0,OV("label",{},void 0,OV("input",{type:"checkbox",checked:this.props.prefValues[$.kKeyboardShortcutsEnable],onChange:LV($.kKeyboardShortcutsEnable)}),OV("span",{},void 0,(0,Oe.Z)("Enable Keyboard Shortcuts")))),OV("div",{className:"setting-single pad-left"},void 0,OV("label",{},void 0,OV("input",{type:"checkbox",checked:this.props.prefValues[$.kKeyboardShortcutsEnableSingleKey],onChange:LV($.kKeyboardShortcutsEnableSingleKey),disabled:!this.props.prefValues[$.kKeyboardShortcutsEnable]}),OV("span",{},void 0,(0,Oe.Z)("Single Key Shortcuts")))),!this.props.prefValues[$.kMailIsTurnedOff]&&OV("div",{className:"setting-single pad-left"},void 0,OV("label",{},void 0,OV("input",{type:"checkbox",checked:this.props.prefValues[$.kKeyboardShortcutsEnableSingleKeyForMail],onChange:LV($.kKeyboardShortcutsEnableSingleKeyForMail),disabled:!this.props.prefValues[$.kKeyboardShortcutsEnable]}),OV("span",{},void 0,(0,Oe.Z)("Mail and Calendar Single Key Shortcuts")))),OV("div",{className:"setting-single"},void 0,OV("label",{},void 0,OV("input",{type:"checkbox",checked:this.props.prefValues[$.kKeyboardShortcutsSpaceFastForwards],onChange:LV($.kKeyboardShortcutsSpaceFastForwards)}),OV("span",{},void 0,(0,Oe.Z)("Space Key to Fast Forward")))),OV("div",{className:"setting-single"},void 0,OV("label",{},void 0,OV("input",{type:"checkbox",checked:this.props.prefValues[$.kKeyboardShortcutsAltOpensMenu],onChange:LV($.kKeyboardShortcutsAltOpensMenu)}),OV("span",{},void 0,(0,Oe.Z)("Alt Key for Main Menu"))))))}}const BV=RV;var FV;function VV(e,t,n,s){FV||(FV="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:FV,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const WV=[$.kKeyboardTabToAll,$.kKeyboardTabToAllUsesSystemDefault,$.kWebpagesFocusTrap],UV=Ne.Z.getEventHandler;var HV=VV("input",{type:"radio",value:"1"}),zV=VV("input",{type:"radio",value:"0"});class GV extends hs.Component{handleDarwinKeyAccess=e=>{const t=H.Z.get($.kSystemMacKeyboardUiMode),n=e.target&&e.target.checked;n||-1===this.props.prefValues[$.kKeyboardTabToAll]?n&&2===t&&0!==this.props.prefValues[$.kKeyboardTabToAll]?Ne.Z.set($.kKeyboardTabToAll,0):n&&0===t&&-1!==this.props.prefValues[$.kKeyboardTabToAll]&&Ne.Z.set($.kKeyboardTabToAll,-1):Ne.Z.set($.kKeyboardTabToAll,-1),Ne.Z.set($.kKeyboardTabToAllUsesSystemDefault,n)};renderFullKeyboardAccess=()=>VV("div",{className:"setting-group"},void 0,VV("h3",{},void 0,(0,Oe.Z)("Full Keyboard Access")),!1,VV(vl,{name:"keyAccessSetting",className:"setting-single",value:this.props.prefValues[$.kKeyboardTabToAll],onChange:UV($.kKeyboardTabToAll)},void 0,VV("label",{},void 0,VV("input",{type:"radio",value:"0",disabled:this.props.prefValues[$.kKeyboardTabToAllUsesSystemDefault]}),VV("span",{},void 0,(0,Oe.Z)("Focus All Controls"))),VV("p",{className:"info"},void 0,(0,Oe.Z)("Press TAB key to focus all controls")),VV("label",{},void 0,VV("input",{type:"radio",value:"-1",disabled:this.props.prefValues[$.kKeyboardTabToAllUsesSystemDefault]}),VV("span",{},void 0,(0,Oe.Z)("Focus Input"))),VV("p",{className:"info"},void 0,(0,Oe.Z)("Press TAB key to focus text boxes and lists only"))));onFocusCyclingChanged=e=>{const t="1"===e.target.value;Ne.Z.set($.kWebpagesFocusTrap,t)};renderFocusCycling=()=>VV("div",{className:"setting-group"},void 0,VV("h3",{},void 0,(0,Oe.Z)("Focus Cycling")),VV(vl,{name:"toolbarFocusCycling",className:"setting-single",value:this.props.prefValues[$.kWebpagesFocusTrap]?"1":"0",onChange:this.onFocusCyclingChanged},void 0,VV("label",{},void 0,HV,VV("span",{},void 0,(0,Oe.Z)("Cycle in Component"))),VV("p",{className:"info"},void 0,(0,Oe.Z)("TAB key focus is bound to individual toolbars or webpage")),VV("label",{},void 0,zV,VV("span",{},void 0,(0,Oe.Z)("Cycle All"))),VV("p",{className:"info"},void 0,(0,Oe.Z)("TAB key focus cycles through whole application"))));render(){return VV(US.Z,{filter:this.props.filter},void 0,this.renderFocusCycling(),this.renderFullKeyboardAccess())}}const $V=sa(GV,WV);var KV;function jV(e,t,n,s){KV||(KV="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:KV,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const YV=[$.kActions,$.kKeyboardShortcutsEnableSingleKey,$.kWebpagesSpatialNavigationEnabled],XV=Ne.Z.getEventHandler;class QV extends hs.Component{isSingleKeyShortcut=(e,t)=>!!t||!Di.Z.isSingleKeyShortcut(e);render(){const{prefValues:e}=this.props,t=e[$.kActions][0],n=e[$.kKeyboardShortcutsEnableSingleKey],s=t.COMMAND_SPATNAV_LEFT.shortcuts?.slice(0,3).filter((e=>this.isSingleKeyShortcut(e,n)))||[],i=t.COMMAND_SPATNAV_RIGHT.shortcuts?.slice(0,3).filter((e=>this.isSingleKeyShortcut(e,n)))||[],o=t.COMMAND_SPATNAV_UP.shortcuts?.slice(0,3).filter((e=>this.isSingleKeyShortcut(e,n)))||[],a=t.COMMAND_SPATNAV_DOWN.shortcuts?.slice(0,3).filter((e=>this.isSingleKeyShortcut(e,n)))||[];return jV(US.Z,{filter:this.props.filter},void 0,jV("div",{className:"setting-group"},void 0,jV("div",{className:"setting-single"},void 0,jV("h3",{},void 0,(0,Oe.Z)("Spatial Navigation")),jV("label",{},void 0,jV("input",{type:"checkbox",checked:this.props.prefValues[$.kWebpagesSpatialNavigationEnabled],onChange:XV($.kWebpagesSpatialNavigationEnabled)}),jV("span",{},void 0,(0,Oe.Z)("spatial navigation","Enabled"))),jV("div",{className:"info"},void 0,(0,Oe.Z)("Navigate between links and elements using your keyboard."),jV("div",{className:"shortcuts"},void 0,Boolean(s.length)&&(0,fs.jsxs)(fs.Fragment,{children:[jV("span",{},void 0,(0,Oe.Z)("spatnav","Left")),jV("span",{className:"shortcut"},void 0,s.map((e=>jV("kbd",{},e,(0,tu.$)(e)))))]}),Boolean(i.length)&&(0,fs.jsxs)(fs.Fragment,{children:[jV("span",{},void 0,(0,Oe.Z)("spatnav","Right")),jV("span",{className:"shortcut"},void 0,i.map((e=>jV("kbd",{},e,(0,tu.$)(e)))))]}),Boolean(o.length)&&(0,fs.jsxs)(fs.Fragment,{children:[jV("span",{},void 0,(0,Oe.Z)("spatnav","Up")),jV("span",{className:"shortcut"},void 0,o.map((e=>jV("kbd",{},e,(0,tu.$)(e)))))]}),Boolean(a.length)&&(0,fs.jsxs)(fs.Fragment,{children:[jV("span",{},void 0,(0,Oe.Z)("spatnav","Down")),jV("span",{className:"shortcut"},void 0,a.map((e=>jV("kbd",{},e,(0,tu.$)(e)))))]}))))))}}const qV=sa(QV,YV);var JV,eW=n(30330);function tW(e,t,n,s){JV||(JV="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:JV,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const nW={width:400,minWidth:"unset"},sW=[$.kMailIsTurnedOff,$.kChainedCommandsCommandList,$.kKeyboardShortcutsAltOpensMenu,$.kKeyboardShortcutsEnable,$.kKeyboardShortcutsEnableSingleKey,$.kKeyboardShortcutsEnableSingleKeyForMail,$.kKeyboardShortcutsSpaceFastForwards];class iW extends hs.Component{state={commandArray:J.Z.getSettingsList(!1),openCategories:["CATEGORY_COMMAND_APPLICATION"],confirmation:!1,hideFullKeyAccess:0,hideConfigureSingleKeyShortcut:0,shouldHideKeyboardShortcuts:!1,keyboardShortcutFilter:""};componentDidMount(){J.Z.addListener(this._onStoreChange),f.Z.addListener(this._onStoreChange),H.Z.addListener($.kMailIsTurnedOff,this._onStoreChange)}_onStoreChange=()=>{this.setState({commandArray:J.Z.getSettingsList(!1)})};componentWillUnmount(){J.Z.removeListener(this._onStoreChange),f.Z.removeListener(this._onStoreChange),H.Z.removeListener($.kMailIsTurnedOff,this._onStoreChange)}componentDidUpdate(e){this.props.filter!==e.filter&&this.setState({keyboardShortcutFilter:""})}switchCategory=e=>{this.setState((0,V.Uy)((t=>{const n=t.openCategories;n.indexOf(e)>-1?n.splice(n.indexOf(e),1):n.push(e)})))};confirmRestoreKeys=()=>{this.setState({confirmation:!0})};restoreKeys=()=>{v.Z.restoreShortcuts(),this.setState({confirmation:!1})};onCancel=()=>{this.setState({confirmation:!1})};renderModal=()=>tW(_r.Z,{style:nW,onRequestClose:this.onCancel},void 0,tW("div",{className:"dialog-restore-shortcuts"},void 0,tW("header",{className:"dialog-header"},void 0,tW("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("Restore Keyboard Shortcuts?"))),tW("div",{className:"dialog-content"},void 0,tW("p",{},void 0,(0,Oe.Z)("All keyboard shortcuts will be restored to default."))),tW("footer",{className:"dialog-footer"},void 0,tW("input",{type:"button",className:"danger",onClick:this.restoreKeys,value:(0,Oe.Z)("Restore")}),tW("input",{type:"button",onClick:this.onCancel,value:(0,Oe.Z)("Cancel"),autoFocus:!0}))));renderKeyboardCommandCategories=(e,t)=>{const n=e.reduce(((e,t)=>(e[t.category]=(e[t.category]||[]).concat(t),e)),{});let s;s=H.Z.get($.kWorkspacesEnabled)?Object.keys(n):Object.keys(n).filter((e=>"CATEGORY_COMMAND_WORKSPACE_ACTION"!==e));const i=s.map(((e,s)=>this.renderKeyboardCommandCategory(e,n[e],t)));return i.length>0?tW("div",{className:"setting-single"},void 0,tW("div",{className:"keystrokes"},void 0,i),!this.props.filter&&"read-only"!==this.props.view&&tW("input",{type:"button",onClick:this.confirmRestoreKeys,value:(0,Oe.Z)("Restore Default Keys")})):null};renderKeyboardCommandCategory=(e,t,n)=>{const s=DV(e);return tW("div",{className:"category "+(n||this.state.openCategories.indexOf(e)>-1?"show":"hide")},e,tW("button",{onClick:this.switchCategory.bind(this,e)},void 0,(0,Vl.CH)(s,n)),tW("div",{className:"list"},void 0,t.map(((e,t)=>this.renderCommandKeys(e,t,n)))))};renderCommandKeys=(e,t,n)=>{const s=!this.props.prefValues[$.kKeyboardShortcutsEnable],i=!this.props.prefValues[$.kKeyboardShortcutsEnableSingleKey];if("read-only"===this.props.view)return tW("div",{className:"keycombo"},t,tW("label",{},void 0,(0,Vl.CH)(e.label,n)),e.shortcuts&&e.shortcuts.map(((e,t)=>[tW("span",{title:s?(0,Oe.Z)("Keyboard Shortcuts are disabled"):1===e.length&&i?(0,Oe.Z)("Single Key Shortcuts are disabled"):""},t,tW("input",{type:"button",disabled:!0,className:e.length>1?"item regular":"item single",value:(0,tu.$)(e)}))])));if(!(0,eW.os)(e.name)){const t=e.name.toLowerCase();return tW("div",{className:"keycombo"},t,tW("label",{htmlFor:"combo-"+t},void 0,(0,Vl.CH)(e.label,this.props.filter)),tW(ru,{prefValues:this.props.prefValues,id:"combo-"+t,commandArray:this.state.commandArray,command:e},t))}return null};renderListOfKeyboardCommands=e=>{let t=[];if(t="read-only"===this.props.view?this.state.commandArray.filter((e=>Boolean(e.shortcuts&&e.shortcuts.length>0))):this.state.commandArray,e){const n=this.tokenize(e);t=t.filter((t=>{if((t.label||t.name).toLowerCase().indexOf(e.toLowerCase())>-1)return!(0,eW.os)(t.name);return(t.shortcuts||[]).some((e=>{const t=this.tokenize(e);return zA(n,t)}))}))}return t.length>0?tW("div",{className:"keyboard-shortcut-list"},void 0,e&&tW("header",{},void 0,tW("h3",{},void 0,(0,Oe.Z)("Showing all keyboard shortcut entries matching $1.",[e]))),this.renderKeyboardCommandCategories(t,e)):null};tokenize=e=>new Set(e.match(/[^,\s\+]+/g)||[]);render(){const e=this.state.keyboardShortcutFilter||this.props.filter;if("read-only"===this.props.view)return this.renderListOfKeyboardCommands(e);const{prefValues:t}=this.props;return tW(mN,{categoryTitle:(0,Oe.Z)("Keyboard"),className:As()({"keyboard-shortcut-list":!0,singlekeydisabled:!t[$.kKeyboardShortcutsEnableSingleKey],singlekeydisabledfeatures:!t[$.kKeyboardShortcutsEnableSingleKeyForMail]}),filter:this.props.filter},void 0,this.state.confirmation&&this.renderModal(),tW($V,{filter:this.props.filter}),tW(PV,{filter:this.props.filter}),tW(BV,{filter:this.props.filter,prefValues:t}),tW(qV,{filter:this.props.filter}),this.renderListOfKeyboardCommands(e))}}const oW=sa(iW,sW);var aW,rW=n(9761),lW=n(49269);function dW(e,t,n,s){aW||(aW="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:aW,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const cW=[$.kTranslateEnabled],hW=Ne.Z.getEventHandler;class pW extends hs.PureComponent{static contextType=xi.Z;_isMounted=!1;state={language:q.ZP.UI_LANGUAGE,acceptLangs:[],acceptLangsList:[]};componentDidMount(){this._isMounted=!0,s.Z.languageSettingsPrivate.getLanguageList((e=>{if(s.Z.runtime.lastError)console.error(s.Z.runtime.lastError.message);else if(this._isMounted){const t=[];for(const n of e){if(n.code===n.nativeDisplayName){const e=rW.lE.find((e=>e.key===n.code));if(!e)continue;n.nativeDisplayName=e.local}t.push(n)}this.setState({acceptLangsList:t.sort(((e,t)=>e.code.localeCompare(t.code))).map((e=>({key:e.code,value:e.nativeDisplayName})))})}})),this.updateAcceptedList()}componentWillUnmount(){this._isMounted=!1}updateAcceptedList=()=>{s.Z.i18n.getAcceptLanguages((e=>{s.Z.runtime.lastError?(console.error(s.Z.runtime.lastError.message),this._isMounted&&this.setState({acceptLangs:[]})):this._isMounted&&this.setState({acceptLangs:e})}))};onContextMenu=(e,t)=>{const n=[];e>=0&&e<this.state.acceptLangs.length&&(n.push({...(0,xs.Z)("Move to Top"),handler:this.moveItemToTop.bind(this,e),isVisible:()=>0!==e}),n.push({...(0,xs.Z)("Move Up"),handler:this.moveItem.bind(this,e,e-1),isVisible:()=>e>1}),n.push({...(0,xs.Z)("Move Down"),handler:this.moveItem.bind(this,e,e+1),isVisible:()=>e!==this.state.acceptLangs.length-1}),n.push({...(0,xs.Z)("verb","Remove"),handler:this.removeItem.bind(this,e),isVisible:()=>this.state.acceptLangs[e]!==this.state.language&&this.state.acceptLangs.length>1})),(0,Qi.Z)(this.context,n)(t)};addItem=e=>{if(e&&e.target){const t=e.target.value;s.Z.languageSettingsPrivate.enableLanguage(t),this.updateAcceptedList()}};moveItem=(e,t)=>{const n=t<e?"UP":"DOWN",i=Math.abs(e-t);(0,lW.Z)(i,(()=>{s.Z.languageSettingsPrivate.moveLanguage(this.state.acceptLangs[e],n)})),this.updateAcceptedList()};moveItemToTop=e=>{s.Z.languageSettingsPrivate.moveLanguage(this.state.acceptLangs[e],"TOP"),this.updateAcceptedList()};removeItem=e=>{this.state.acceptLangs.length<=1||(s.Z.languageSettingsPrivate.disableLanguage(this.state.acceptLangs[e]),this.updateAcceptedList())};resetToDefault=()=>{Ne.Z.reset($.kAcceptLanguages),this.updateAcceptedList()};resetTranslationSettingsToDefault=()=>{C.Z.prefs.resetTranslationPrefs()};remapLangs=()=>this.state.acceptLangs.map((e=>({key:e,name:e,isDefault:Boolean(e===this.state.language||this.state.acceptLangs.length<=1)})));renderItem=(e,t)=>dW("span",{},void 0,e);render(){const e=this.state.acceptLangsList.filter((e=>!this.state.acceptLangs.includes(e.key)));return e.unshift({key:"",value:(0,Oe.Z)("Select Language")}),dW(US.Z,{filter:this.props.filter},void 0,dW("div",{className:"setting-group accept-language-list"},void 0,dW("div",{className:"setting-single"},void 0,dW("h3",{},void 0,(0,Oe.Z)("Accept Languages")),dW("p",{className:"info"},void 0,(0,Oe.Z)("Preferred languages, accepted by compatible websites in given order")),this.state.acceptLangsList.length>0?(0,fs.jsxs)(fs.Fragment,{children:[dW(x_.Z,{items:this.remapLangs(),filter:this.props.filter,onCreateItem:this.addItem,moveItem:this.moveItem,onRemove:this.removeItem,onContextMenu:this.onContextMenu,renderListItem:this.renderItem,optionsList:e,addTipString:(0,Oe.Z)("Add Language"),deleteTipString:(0,Oe.Z)("Remove Language"),supportDragAndDrop:!0,mimeType:"vivaldi/x-settings-accept-langage"}),dW("input",{type:"button",value:(0,Oe.Z)("Reset to Default"),onClick:this.resetToDefault})]}):dW("p",{},void 0,(0,Oe.Z)("Language list retrieval for “$1” failed",[this.state.language]))),dW("div",{className:"setting-single offer-translate"},void 0,dW("label",{},void 0,dW("input",{type:"checkbox",checked:this.props.prefValues[$.kTranslateEnabled],onChange:hW($.kTranslateEnabled)}),dW("span",{},void 0,dW("h3",{},void 0,(0,Oe.Z)("Automatically Offer to Translate Pages")))),dW("p",{className:"info"},void 0,(0,Oe.Z)("When unchecked, translation popup and automatic translations will be disabled. Translation can still be manually triggered on each page.")),dW("input",{type:"button",value:(0,Oe.Z)("Reset Translation Settings to Default"),onClick:this.resetTranslationSettingsToDefault}))))}}const uW=sa(pW,cW);var gW;function mW(e,t,n,s){gW||(gW="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:gW,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const vW=[$.kCalendarDateFormat,$.kCalendarStartOfWeek,$.kCalendarWeekNumberRule],fW=Ne.Z.getEventHandler,yW={width:400,minWidth:"unset"};class CW extends hs.Component{locales=[...rW.lE].sort(((e,t)=>e.local.localeCompare(t.local)));_isMounted=!1;state={initialLanguage:"",language:"",confirmation:!1,localMoment:q.ZP.getLocale()};componentDidMount(){this._isMounted=!0,C.Z.utilities.getLanguage((e=>{this._isMounted&&this.setState({language:e,initialLanguage:e})})),this.updateFormatPreview()}componentDidUpdate(e,t){const n=this.props.prefValues,s=e.prefValues;n[$.kCalendarDateFormat]===s[$.kCalendarDateFormat]&&n[$.kCalendarStartOfWeek]===s[$.kCalendarStartOfWeek]&&n[$.kCalendarWeekNumberRule]===s[$.kCalendarWeekNumberRule]||this.updateFormatPreview()}componentWillUnmount(){this._isMounted=!1}langChanged=e=>{const t=e.currentTarget.selectedOptions[0].dataset.lang;this.setState({language:t})};saveLanguage=()=>{C.Z.utilities.setLanguage(this.state.language,(()=>{NI.ZP.setTargetTranslationCode(NI.ZP.getTranslationCode(this.state.language)),this.setState((e=>({initialLanguage:e.language,confirmation:!1})))}))};saveDateFormat=e=>{const t=e.target.value;Ne.Z.set($.kCalendarDateFormat,t)};updateFormatPreview=()=>{C.Z.utilities.getSystemDateFormat((e=>{this._isMounted&&this.setState({localMoment:q.ZP.getLocale(e)})}))};confirmLanguageChange=()=>{this.setState({confirmation:!0})};onCancel=()=>{this.setState((e=>({language:e.initialLanguage,confirmation:!1})))};renderModal=()=>{const e=this.locales.find((e=>e.key===this.state.language));return e?mW(_r.Z,{viewMode:"float",style:yW,onRequestClose:this.onCancel},void 0,mW("div",{className:"dialog-restore-shortcuts"},void 0,mW("header",{className:"dialog-header"},void 0,mW("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("Save New Language?"))),mW("div",{className:"dialog-content"},void 0,mW("p",{},void 0,(0,Oe.Z)("Vivaldi user interface language will be set to:")),mW("p",{},void 0,mW("strong",{},void 0,e.local+(e.value!==e.local?" – "+e.value:""))),mW("p",{},void 0,(0,Oe.Z)("Browser restart is required for new setting to take effect."))),mW("footer",{className:"dialog-footer"},void 0,mW("input",{type:"button",className:"danger",onClick:this.saveLanguage,value:(0,Oe.Z)("Save Language")}),mW("input",{type:"button",onClick:this.onCancel,value:(0,Oe.Z)("Cancel"),autoFocus:!0})))):null};render(){const e=N()(),{longDateFormat:t,week:n,weekdays:s}=this.state.localMoment;return e.localeData()._week=this.state.localMoment.week,mW(mN,{categoryTitle:(0,Oe.Z)("Language"),"data-anchor":"language",filter:this.props.filter},void 0,mW("p",{className:"info"},void 0,(0,Oe.Z)("These settings require a restart to take full effect.")),this.state.confirmation&&this.renderModal(),mW("form",{className:"setting-group",onSubmit:this.confirmLanguageChange},void 0,mW("h3",{},void 0,(0,Oe.Z)("User Interface Language")),mW("div",{className:"setting-single"},void 0,mW("select",{onChange:this.langChanged,value:this.state.language.toLowerCase()},void 0,this.locales.map((e=>mW("option",{value:e.key.toLowerCase(),"data-lang":e.key},e.key,e.local+(e.value!==e.local?" – "+e.value:""))))),mW("input",{type:"submit",className:"primary",disabled:this.state.language===this.state.initialLanguage,value:(0,Oe.Z)("Save Language")}))),mW("div",{className:"setting-group"},void 0,mW("div",{className:"setting-single"},void 0,mW("h3",{},void 0,(0,Oe.Z)("Preferred Date & Time Format")),mW("p",{className:"info"},void 0,(0,Oe.Z)("Affects beginning day of week, time and date display format.")),mW("select",{value:this.props.prefValues[$.kCalendarDateFormat],onChange:this.saveDateFormat},void 0,mW("option",{value:"system"},void 0,(0,Oe.Z)("Inherit from Operating System")),mW("option",{value:"language"},void 0,(0,Oe.Z)("Same as Selected Language")))),mW("div",{className:"setting-single"},void 0,mW("h3",{},void 0,(0,Oe.Z)("Week Starts On")),mW("label",{},void 0,mW("select",{name:"week_starts",value:this.props.prefValues[$.kCalendarStartOfWeek],onChange:fW($.kCalendarStartOfWeek)},void 0,mW("option",{value:"system"},void 0,(0,Oe.Z)("System Default")),mW("option",{value:"sunday"},void 0,(0,Oe.Z)("Sunday")),mW("option",{value:"monday"},void 0,(0,Oe.Z)("Monday")),mW("option",{value:"tuesday"},void 0,(0,Oe.Z)("Tuesday")),mW("option",{value:"wednesday"},void 0,(0,Oe.Z)("Wednesday")),mW("option",{value:"thursday"},void 0,(0,Oe.Z)("Thursday")),mW("option",{value:"friday"},void 0,(0,Oe.Z)("Friday")),mW("option",{value:"saturday"},void 0,(0,Oe.Z)("Saturday"))))),mW("div",{className:"setting-single"},void 0,mW("h3",{},void 0,(0,Oe.Z)("First Week Number")),mW("label",{},void 0,mW("select",{name:"week_number_rule",value:this.props.prefValues[$.kCalendarWeekNumberRule],onChange:fW($.kCalendarWeekNumberRule)},void 0,mW("option",{value:"4"},void 0,(0,Oe.Z)("First 4 Day Week (ISO8601)")),mW("option",{value:"1"},void 0,(0,Oe.Z)("First Week in Calendar Year")),mW("option",{value:"7"},void 0,(0,Oe.Z)("First Whole Week"))))),mW("dl",{className:"info",style:{display:"grid",gridTemplateColumns:"auto 1fr",gridGap:"2px 8px",margin:"12px 0"}},void 0,mW("dt",{},void 0,(0,Oe.Z)("Time Format")),mW("dd",{},void 0,e.format(t.LT)),mW("dt",{},void 0,(0,Oe.Z)("Short Date")),mW("dd",{},void 0,e.format(t.L)),mW("dt",{},void 0,(0,Oe.Z)("Long Date")),mW("dd",{},void 0,e.format(t.LLLL)),mW("dt",{},void 0,(0,Oe.Z)("Start of Week")),mW("dd",{},void 0,s[n.dow]),mW("dt",{},void 0,(0,Oe.Z)("Week Number")),mW("dd",{},void 0,e.week()))),mW(uW,{filter:this.props.filter}))}}const wW=sa(CW,vW);var bW;function SW(e,t,n,s){bW||(bW="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:bW,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const IW={Title:(0,Oe.Z)("Title"),Address:(0,Oe.Z)("Address"),"Every 5 minutes":(0,Oe.Z)("Every 5 minutes"),"Every 15 minutes":(0,Oe.Z)("Every 15 minutes"),"Every 30 minutes":(0,Oe.Z)("Every 30 minutes"),"Every hour":(0,Oe.Z)("Every hour"),"Every 2 hours":(0,Oe.Z)("Every 2 hours"),"Every 6 hours":(0,Oe.Z)("Every 6 hours"),"Every 12 hours":(0,Oe.Z)("Every 12 hours"),Daily:(0,Oe.Z)("Daily"),Weekly:(0,Oe.Z)("Weekly"),Never:(0,Oe.Z)("other","Never")};class kW extends hs.Component{constructor(e){super(e),this.state={account:this.props.account,accountIndex:this.props.accountIndex,urlValidated:!1}}isAccountChanged=()=>{const e=this.props.account;if(!e||!this.state.urlValidated)return!1;const{url:t,path:n,title:s,refreshInterval:i,offline:o}=this.state.account;return!(s===e.title&&t===e.url&&n===e.path&&i===e.refreshInterval&&o===e.offline)};isUrlValid=e=>""!==e.trim()&&(e.split(/\s/).filter((e=>e))||[e]).every((e=>(0,vs.C3)(e)));setAccountProperty=e=>{const{name:t,value:n}=e.target,s="refreshInterval"===t?"-1"===n:this.state.account.offline,i=this.isUrlValid("url"===t?n:this.state.account.url);this.setState((e=>({account:{...e.account,[t]:n,offline:s},urlValidated:i})))};saveAccount=()=>{const{url:e,path:t,title:n,refreshInterval:s,lastChecked:i,offline:o}=this.state.account;this.props.save({url:e,path:t,title:n,refreshInterval:s,lastChecked:i,offline:o},this.props.accountIndex)};render(){return SW("form",{className:"detail",onSubmit:this.saveAccount},void 0,SW("div",{className:"detail-content"},void 0,SW("div",{className:"setting-group"},void 0,SW("div",{className:"setting-single"},void 0,SW(sc.Z,{type:"text",onChange:this.setAccountProperty,name:"title",label:this.props.searchableStrings.Title,placeholder:(0,Oe.Z)("Feed Title"),value:this.state.account.title,autoFocus:!this.state.account.title})),SW("div",{className:"setting-single"},void 0,SW(sc.Z,{type:"text",onChange:this.setAccountProperty,name:"url",label:this.props.searchableStrings.Address,placeholder:(0,Oe.Z)("Feed Address"),isVerified:this.state.urlValidated,value:this.state.account.url})),SW("div",{className:"setting-single"},void 0,SW("label",{className:"floating-label"},void 0,SW("span",{},void 0,(0,Oe.Z)("Refresh Interval")),SW("select",{onChange:this.setAccountProperty,value:this.state.account.refreshInterval,name:"refreshInterval"},void 0,Ec()))))),SW("div",{className:"detail-toolbar"},void 0,SW("input",{type:"submit",value:(0,Oe.Z)("Save"),disabled:!this.isAccountChanged()})))}}const AW=kW;function TW(e,t){C.Z.mailPrivate.getFileDirectory(t,(t=>{t&&d.ZP.openURL(e,`file://${t}`,{inCurrent:!1,inBackground:!1})}))}var ZW;function EW(e,t,n,s){ZW||(ZW="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:ZW,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const _W="/resources/vivaldi_rss_default.png",MW=n(55592),NW=[$.kMailIsTurnedOff,$.kRssDetectFeeds,$.kRssEmbedYoutubeAttachments,$.kRssShowNotifications],PW=Ne.Z.getEventHandler,DW={"Add your First Newsfeed Account":(0,Oe.Z)("Add your First Newsfeed Account"),"Press the “Add” button to the left to add a new account.":(0,Oe.Z)("Press the “Add” button to the left to add a new account.")};class xW extends hs.PureComponent{static contextType=xi.Z;constructor(e){super(e);const t=H.Z.get($.kRssSettings),n=De.Z.getByAccountId(xe.u4);this.state={accounts:t,areFiltersMissing:t.length>n.length,isRestoringFeeds:!1}}componentDidMount=()=>{H.Z.addListener($.kRssSettings,this._onSettingsChanged)};componentWillUnmount=()=>{H.Z.removeListener($.kRssSettings,this._onSettingsChanged)};_onSettingsChanged=(e,t)=>{this.setState({accounts:t})};removeAt=e=>{const{path:t}=this.state.accounts[e];qe.removeFeed(t)};renderListItem=(e,t)=>{const n=((0,ms.Z)(t.url)?.hostname||"").split(".").slice(-2).join(".");return EW(RD,{title:t.title,meta:t.url,iconPath:n,iconFallbackPath:_W},t.url)};renderCreateListItem=()=>(0,fs.jsx)(fs.Fragment,{children:EW(RD,{title:(0,Oe.Z)("New Feed"),meta:(0,Oe.Z)("Setup in progress..."),iconFallbackPath:_W,isCreating:!0})});save=(e,t)=>{const{accounts:n}=this.state;if(t<n.length)qe.edit(e,t);else{const t=[],n=e.url.split(/\s/).filter((e=>e));n.length>1?n.forEach((n=>{const{title:s,path:i}=e;t.some((e=>e.url===n))||t.push({url:n,path:i,title:s,refreshInterval:5,lastChecked:0,offline:!1})})):t.push(e),qe.add(t)}};renderContent=(e,t)=>{const{accounts:n}=this.state,s=n&&n[e];return s?EW(AW,{save:this.save,searchableStrings:t,account:s,accountIndex:e},s.url):null};renderCreate=e=>{const{accounts:t}=this.state,n={title:"",url:"",path:crypto.randomUUID(),lastChecked:0,refreshInterval:0,offline:!1};return EW(AW,{save:this.save,searchableStrings:e,account:n,accountIndex:t.length})};renderEmpty=e=>EW("div",{className:"detail"},void 0,EW("div",{className:"detail-content"},void 0,EW("h3",{},void 0,e["Add your First Newsfeed Account"]),EW("p",{},void 0,e["Press the “Add” button to the left to add a new account."])));remapAccounts=()=>this.state.accounts.map((e=>({...e,key:e.title,name:e.title})));_restoreLostFeeds=async()=>{this.setState({isRestoringFeeds:!0}),await S_();const e=H.Z.get($.kRssSettings),t=De.Z.getByAccountId(xe.u4);this.setState({areFiltersMissing:e.length!==t.length,isRestoringFeeds:!1})};render(){return(0,fs.jsxs)(fs.Fragment,{children:[!this.props.prefValues[$.kMailIsTurnedOff]&&EW(mN,{filter:this.props.filter,categoryTitle:(0,Oe.Z)("Newsfeed Accounts")},void 0,this.state.areFiltersMissing&&EW("div",{className:"setting-group"},void 0,EW("div",{className:"setting-single"},void 0,EW("h3",{},void 0,(0,Oe.Z)("Database Error Detected")),EW("label",{title:(0,Oe.Z)("Filters for feeds are missing from DB and need to be restored!")},void 0,EW("input",{type:"button",onClick:this._restoreLostFeeds,disabled:this.state.isRestoringFeeds,value:this.state.isRestoringFeeds?(0,Oe.Z)("Restoring Feeds ..."):(0,Oe.Z)("Restore Feeds")})))),EW("div",{className:"setting-group unlimited"},void 0,EW(xD.Z,{deleteTitle:(0,Oe.Z)("title","Delete Feed"),addTipString:(0,Oe.Z)("title","Add Feed"),deleteTipString:(0,Oe.Z)("tooltip","Delete Feed"),emptyListGraphic:MW,emptyListString:(0,Oe.Z)("No Feeds added"),filter:this.props.filter,items:this.remapAccounts(),masterLayout:0,onRemove:this.removeAt,renderListItem:this.renderListItem,renderCreateListItem:this.renderCreateListItem,renderContent:this.renderContent,renderCreate:this.renderCreate,renderEmpty:this.renderEmpty,contentStrings:IW,emptyStrings:DW,className:"setting-rss-accounts"}),EW("div",{className:"setting-group"},void 0,EW("div",{className:"setting-single"},void 0,EW("input",{type:"button",onClick:()=>gn.forceRefreshAllRSSAccounts(),disabled:0===this.state.accounts.length,value:(0,Oe.Z)("Update All Feeds")}))),EW("div",{className:"setting-group"},void 0,EW("div",{className:"setting-single"},void 0,EW("input",{type:"button",onClick:()=>TW(this.context.vivaldiWindowId,(0,b_.B)(xe.u4)),disabled:0===this.state.accounts.length,value:(0,Oe.Z)("Reveal Data Folder")}))))),EW(mN,{categoryTitle:(0,Oe.Z)("Feed Settings"),filter:this.props.filter},void 0,EW(XM.j,{filter:this.props.filter,heading:(0,Oe.Z)("Feed Detection")},void 0,EW("div",{className:"setting-single"},void 0,EW("label",{title:(0,Oe.Z)("Use Vivaldi Feeds to detect, preview and subscribe to feeds.")},void 0,EW("input",{type:"checkbox",checked:this.props.prefValues[$.kRssDetectFeeds],onChange:PW($.kRssDetectFeeds)}),EW("span",{},void 0,(0,Oe.Z)("Detect Feeds in Web Pages"))))),!this.props.prefValues[$.kMailIsTurnedOff]&&(0,fs.jsxs)(fs.Fragment,{children:[EW(XM.j,{filter:this.props.filter,heading:(0,Oe.Z)("Feed Notifications")},void 0,EW("div",{className:"setting-single"},void 0,EW("label",{},void 0,EW("input",{type:"checkbox",checked:this.props.prefValues[$.kRssShowNotifications],onChange:PW($.kRssShowNotifications)}),EW("span",{},void 0,(0,Oe.Z)("Show Notifications for New Feed Items"))))),EW(XM.j,{filter:this.props.filter,heading:(0,Oe.Z)("Attachments")},void 0,EW("div",{className:"setting-single"},void 0,EW("label",{},void 0,EW("input",{type:"checkbox",checked:this.props.prefValues[$.kRssEmbedYoutubeAttachments],onChange:PW($.kRssEmbedYoutubeAttachments)}),EW("span",{},void 0,(0,Oe.Z)("Embed YouTube Links in Attachments")))))]})),EW(QP,{categoryTitle:(0,Oe.Z)("Feeds"),filter:this.props.filter,inform:!0})]})}}const OW=sa(xW,NW);var LW,RW=n(6271);function BW(e,t,n,s){LW||(LW="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:LW,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const FW={Port:(0,Oe.Z)("Port"),"Incoming Server":(0,Oe.Z)("Incoming Server"),Username:(0,Oe.Z)("Username"),Password:(0,Oe.Z)("Password"),"Outgoing Server":(0,Oe.Z)("Outgoing Server"),"Use App Password":(0,Oe.Z)("Use App Password"),"Use OAuth":(0,Oe.Z)("Use OAuth")};var VW=BW("select",{name:"MAIL_SOCKET_TYPE",value:"ssl",disabled:!0},void 0,BW("option",{value:"ssl"},void 0,"SSL/TLS")),WW=BW("option",{value:"starttls"},void 0,"StartTLS");class UW extends hs.PureComponent{isImap(){return this.props.account.accountType===xe.s9.IMAP}toggleOAuth=()=>{this.props.setAccountProperty("useOAuth",!this.props.account.useOAuth)};onChangeEvent=e=>{const{name:t,value:n}=e.target;this.props.setAccountProperty(t,n)};render(){const{MAIL_SERVER:e,MAIL_PORT:t,MAIL_USER:n,MAIL_PASSWORD:s,MAIL_SMTP_SERVER:i,MAIL_SMTP_PORT:o,MAIL_SMTP_USER:a,MAIL_SMTP_PASSWORD:r,MAIL_SMTP_SOCKET_TYPE:l}=this.props.account;return BW("div",{className:"setting-group-block setting-mail-account-form"},void 0,BW("div",{className:"setting-group"},"mail__imap",BW("div",{className:"setting-single setting-single-flex"},void 0,BW(sc.Z,{type:"text",disabled:this.props.disabled,onChange:this.onChangeEvent,name:"MAIL_SERVER",label:this.props.searchableStrings["Incoming Server"],labelImportant:!0,placeholder:"mail.vivaldi.net",isVerified:this.props.incomingVerified,hasError:this.props.showErrors&&!e,value:e||"",className:"incoming-server-label"}),BW(sc.Z,{type:"number",disabled:this.props.disabled,onChange:this.onChangeEvent,name:"MAIL_PORT",label:this.props.searchableStrings.Port,placeholder:this.isImap()?"993":"995",isVerified:this.props.incomingVerified,value:t||"",className:"port-label"})),BW("div",{className:"setting-single"},void 0,BW("label",{className:"floating-label",disabled:!0},void 0,(0,Oe.Z)("Connection Security"),VW)),BW("div",{className:"setting-single"},void 0,BW(sc.Z,{type:"text",disabled:this.props.disabled,onChange:this.onChangeEvent,name:"MAIL_USER",label:this.props.searchableStrings.Username,placeholder:"user@vivaldi.net",isVerified:this.props.userVerified,hasError:this.props.showErrors&&!n,value:n||""})),!this.props.account.useOAuth&&BW("div",{className:"setting-single"},void 0,BW(sc.Z,{type:"password",disabled:this.props.disabled,onChange:this.onChangeEvent,name:"MAIL_PASSWORD",label:this.props.searchableStrings.Password,placeholder:"",isVerified:this.props.userVerified,hasError:this.props.showErrors&&!s,value:s||""}))),BW("div",{className:"setting-group"},"mail__smtp",BW("div",{className:"setting-single setting-single-flex"},void 0,BW(sc.Z,{type:"text",disabled:this.props.disabled,onChange:this.onChangeEvent,name:"MAIL_SMTP_SERVER",label:this.props.searchableStrings["Outgoing Server"],labelImportant:!0,placeholder:"mail.vivaldi.net",isVerified:this.props.smtpVerified,hasError:this.props.showErrors&&!i,value:i||"",className:"outgoing-server-label"}),BW(sc.Z,{type:"number",disabled:this.props.disabled,onChange:this.onChangeEvent,name:"MAIL_SMTP_PORT",label:this.props.searchableStrings.Port,placeholder:"465",value:o||"",isVerified:this.props.smtpVerified,className:"port-label"})),BW("div",{className:"setting-single"},void 0,BW("label",{className:"floating-label"},void 0,(0,Oe.Z)("Connection Security"),BW("select",{name:"MAIL_SMTP_SOCKET_TYPE",onChange:this.onChangeEvent,value:l||"ssl"},void 0,BW("option",{value:"ssl"},void 0,(0,Oe.Z)("SSL/TLS (Recommended)")),WW))),BW("div",{className:"setting-single"},void 0,BW(sc.Z,{type:"text",disabled:this.props.disabled,onChange:this.onChangeEvent,name:"MAIL_SMTP_USER",label:this.props.searchableStrings.Username,placeholder:"user@vivaldi.net",isVerified:this.props.userVerified,hasError:this.props.showErrors&&!a,value:a||""})),!this.props.account.useOAuth&&BW("div",{className:"setting-single"},void 0,BW(sc.Z,{type:"password",disabled:this.props.disabled,onChange:this.onChangeEvent,name:"MAIL_SMTP_PASSWORD",label:this.props.searchableStrings.Password,placeholder:"",isVerified:this.props.userVerified,hasError:this.props.showErrors&&!r,value:r||""})),(0,RW.Ap)(this.props.account)&&BW("label",{className:"setting-single"},void 0,BW("input",{type:"checkbox",checked:!!this.props.account.useOAuth&&this.props.account.useOAuth,onChange:this.toggleOAuth}),BW("span",{},void 0,this.props.searchableStrings["Use OAuth"]))))}}const HW=UW;var zW;function GW(e,t,n,s){zW||(zW="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:zW,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var $W=GW("input",{type:"radio",value:xe.kA,default:!0}),KW=GW("input",{type:"radio",value:xe.Qp}),jW=GW("input",{type:"radio",value:xe.eQ});class YW extends hs.PureComponent{onChange=e=>{let{name:t,value:n,checked:s}=e.target;n===xe.qd&&s&&(n=xe.kA);const i={...this.props.account.popDeletion,[t]:n};this.props.setAccountProperty("popDeletion",i)};render(){const e=this.props.account.popDeletion||{},{when:t=xe.qd,howManyDays:n=xe.CH}=e;return GW("div",{className:"setting-group setting-group-double"},void 0,GW(vl,{name:"popdeletiongroup",value:t,onChange:this.onChange,disabled:t===xe.qd,name:"when"},void 0,GW("div",{className:"setting-single"},void 0,GW("label",{},void 0,GW("input",{type:"checkbox",checked:t!==xe.qd,value:xe.qd,onChange:this.onChange,name:"when"}),GW("span",{},void 0,(0,Oe.Z)("Delete mail from server")))),GW("div",{className:"setting-single pad-left"},void 0,GW("label",{className:"pop-how-many-days"},void 0,$W,GW("input",{type:"number",min:"1",disabled:t!==xe.kA,value:n,placeholder:xe.CH,onChange:this.onChange,name:"howManyDays",className:"pop-how-many-days-input"}),GW("span",{},void 0,(0,Oe.Z)("days after receiving from server")))),GW("div",{className:"setting-single pad-left"},void 0,GW("label",{},void 0,KW,GW("span",{},void 0,(0,Oe.Z)("when deleting locally")))),GW("div",{className:"setting-single pad-left"},void 0,GW("label",{},void 0,jW,GW("span",{},void 0,(0,Oe.Z)("when received from server"))))))}}const XW=YW;var QW;function qW(e,t,n,s){QW||(QW="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:QW,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const JW={"Limit size when loading":(0,Oe.Z)("Limit size when loading"),"Limit (MB)":(0,Oe.Z)("Limit (MB)"),"Sync Options":(0,Oe.Z)("Sync Options")};class eU extends hs.PureComponent{onChange=e=>{const{name:t,value:n,checked:s}=e.target,i={...this.props.popMaxSize,[t]:"limited"===t?s:n};"limited"===t&&s&&!i.limit&&(i.limit=xe.yX),this.props.setAccountProperty("popMaxSize",i)};render(){const{limited:e=!1,limit:t=xe.yX}=this.props.popMaxSize||{};return(0,fs.jsxs)(fs.Fragment,{children:[qW("h3",{},void 0,JW["Sync Options"]),qW("label",{className:"setting-single"},void 0,qW("input",{type:"checkbox",name:"limited",checked:e,onChange:this.onChange}),qW("span",{},void 0,JW["Limit size when loading"])),qW("label",{className:"setting-single setting-single-flex"},void 0,qW("input",{type:"number",name:"limit",placeholder:xe.yX,disabled:!e,onChange:this.onChange,value:t,style:{width:90}}),qW("span",{},void 0,JW["Limit (MB)"]))]})}}const tU=eU;var nU=n(16504),sU=n(42315);function iU(e){if(0===e.length)throw new Error("raceToResolve: Need an array with at least one Promise.");let t;return new Promise(((n,s)=>Promise.all(e.map((e=>e.then(n).catch((e=>t=e))))).then((()=>s(t)))))}async function oU(e){const t=await e.listWellKnownFolders();for(const n of[xe.e9,xe.Nz,xe.uT])if(Array.isArray(t[n])&&t[n].length>0){const{path:s,subscribed:i}=t[n][0];i||await e.subscribeMailbox({path:s})}}var aU=n(90305);const{OK:rU,ERROR:lU,OFFLINE:dU}=xe.In,cU=async function(e){try{const t=await sU.Z.getIMAPClient(e);return t.onError=e=>new Error((0,Oe.Z)("Login for incoming server failed. IMAP server responded with: $1",[e.message])),await t.login(),t}catch(e){throw new Error((0,Oe.Z)("Login for incoming server failed. IMAP server responded with: $1",[e.message]))}},hU=function(e){return sU.Z.getSMTPClient(e).then((e=>new Promise(((t,n)=>{e.onidle=e.quit,e.onerror=n,e.onclose=t,e.connect()})))).catch((async t=>{throw e.useOAuth&&await(0,aU.oy)(e.MAIL_EMAIL,(0,RW.dn)(e)),new Error((0,Oe.Z)("Login for outgoing server failed. Server responded with: $1",[t.message]))}))},pU=(e,t=!1)=>{const[n,s,i,o]=t?[e.MAIL_SMTP_PORT,e.MAIL_SMTP_SERVER,e.MAIL_SMTP_USER,e.MAIL_SMTP_PASSWORD]:[e.MAIL_PORT,e.MAIL_SERVER,e.MAIL_USER,e.MAIL_PASSWORD];if(!n||"number"!=typeof n)throw new Error(t?(0,Oe.Z)("Outgoing port is missing or not a number"):(0,Oe.Z)("Incoming port is missing or not a number"));if(!s)throw new Error(t?(0,Oe.Z)("Outgoing server information is missing"):(0,Oe.Z)("Incoming server information is missing"));if(!e.useOAuth){if(!i)throw new Error(t?(0,Oe.Z)("Outgoing username is missing"):(0,Oe.Z)("Incoming username is missing"));if(!o)throw new Error(t?(0,Oe.Z)("Outgoing password is missing"):(0,Oe.Z)("Incoming password is missing"))}},uU=(e,t,n,s,i)=>new Promise(((i,o)=>{const a=nU.default.open(e,t,{useSecureTransport:"ssl"===n});a.onerror=e=>{o({})},a.onopen=()=>{a.close(),i("MAIL_SMTP_SERVER"===s?{MAIL_SMTP_SERVER:e,MAIL_SMTP_PORT:t,MAIL_SMTP_SOCKET_TYPE:n}:{MAIL_SERVER:e,MAIL_PORT:t})}})),gU=(e,t)=>{const n={...e,MAIL_SMTP_USER:t};return hU(n).then((()=>[rU,"Outgoing connection success",n])).catch((t=>{throw[lU,t.message,e]}))},mU=async(e,t,n)=>{const s=await fU(t);return s?vU(e,s,n):Promise.reject(`No MX record found for ${t}`)},vU=(e,t,n)=>{const s=[`https://autoconfig.${t}/mail/config-v1.1.xml?emailaddress=${e.MAIL_EMAIL}`,`https://autoconfig.vivaldi.net/v1.1/${t}`,`https://${t}/.well-known/autoconfig/mail/config-v1.1.xml?emailaddress=${e.MAIL_EMAIL}`],i="pop"===n?"pop3":n;return iU(s.map((t=>yU(e,i,t))))},fU=async e=>{const t=await fetch(`https://autoconfig.vivaldi.net/mxlookup?domain=${e}`);if(t.ok){const e=await t.json();if(e&&e[0]?.target){return bU(e[0]?.target)}}},yU=(e,t,n)=>new Promise(((s,i)=>{const o=new XMLHttpRequest;o.onload=async function(){if(200===o.status)try{const n=o.responseXML;let a,r,l,d,c;for(const e of n.getElementsByTagName("incomingServer"))e.getAttribute("type")===t&&"ssl"===e.getElementsByTagName("socketType")[0].textContent.toLowerCase()&&(a=e.getElementsByTagName("hostname")[0].textContent,r=e.getElementsByTagName("port")[0].textContent);for(const e of n.getElementsByTagName("outgoingServer"))if("smtp"===e.getAttribute("type")&&"plain"!==e.getElementsByTagName("socketType")[0].textContent.toLowerCase()&&(l=e.getElementsByTagName("hostname")[0].textContent,d=e.getElementsByTagName("port")[0].textContent,c=e.getElementsByTagName("socketType")[0].textContent.toLowerCase()),"ssl"===c&&l&&d)break;if(!(a&&r&&l&&d&&c))return i(new Error("autodiscover: Missing Outgoing or Incoming Server/Port information"));const h={...e,MAIL_SERVER:a,MAIL_PORT:Number(r),MAIL_SMTP_SERVER:l,MAIL_SMTP_PORT:Number(d),MAIL_SMTP_SOCKET_TYPE:"ssl"===c?"ssl":"starttls"};s([rU,h])}catch(e){i(new Error(`autodiscover: ${e}`))}else i(new Error("autodiscover: Not in autoconfing"))},o.timeout=2e3;const a=function(){i(new Error("autodiscover: Error looking up in autoconfig"))};o.onerror=a,o.ontimeout=a,o.open("GET",n),o.responseType="document",o.send()})),CU=async(e,t,n,s)=>{const i=await fU(t);return i?wU(e,i,n,s):[lU,e]},wU=(e,t,n,s)=>{const i=[`${n}.${t}`,`mail.${t}`,`${n}.mail.${t}`],o=[`smtp.${t}`,`mail.${t}`,`smtp.mail.${t}`];let a,r;return Promise.race([new Promise((e=>setTimeout(e,1e4))),Promise.allSettled([iU([...i.map((e=>uU(e,s,"ssl","MAIL_SERVER")))]).then((e=>{a=e})),new Promise((e=>Promise.allSettled([iU([...o.map((e=>uU(e,465,"ssl","MAIL_SMTP_SERVER")))]).then((t=>{r=t,e()})),iU([...o.map((e=>uU(e,587,"starttls","MAIL_SMTP_SERVER")))]).then((e=>{r||(r=e)}))]).then(e)))])]).then((()=>{const t={...e,...a,...r};return[["MAIL_SERVER","MAIL_PORT","MAIL_SMTP_SERVER","MAIL_SMTP_PORT","MAIL_SMTP_SOCKET_TYPE"].every((e=>t[e]))?rU:lU,t]}))},bU=e=>{let t=e;if(null!=e){var n=e.split(".").reverse();null!=n&&n.length>1&&(t=n[1]+"."+n[0],-1!==e.toLowerCase().indexOf(".co.uk")&&n.length>2&&(t=n[2]+"."+t))}return t.toLowerCase()},SU={isValidEmail:e=>{if(!e||!e.MAIL_EMAIL)return!1;const t=e.MAIL_EMAIL.split("@");if(t&&2===t.length){const e=t[1].split(".");return!!(e&&e[1]&&e[1].length>1)}return!1},verify:async e=>{if(e.offline)return[dU,e];await(async e=>(pU(e,!0),await hU(e)))(e);try{return await(async e=>{if(pU(e,!1),e.accountType!==xe.s9.IMAP)return Me.verifyPopLogin(e);(await cU(e)).logout()})(e),[rU,e]}catch(t){return[lU,e,t]}},autofill:async e=>{if(!SU.isValidEmail(e))return[lU,e];const t=e.MAIL_EMAIL,n=e.MAIL_EMAIL&&t.split("@")[1];let s="imap",i=993;return e.accountType===xe.s9.POP&&(s="pop",i=995),iU([vU(e,n,s),mU(e,n,s)]).catch((()=>{let t;return new Promise((o=>Promise.allSettled([wU(e,n,s,i).then((e=>{e[0]===rU&&o(e),t||(t=e)})),CU(e,n,s,i).then((e=>{e[0]===rU&&o(e),t||(t=e)}))]).then((()=>o(t)))))})).then((e=>e))},signIn:async e=>{if(e.offline)return[dU,"offline",e];e.MAIL_PORT||(e.MAIL_PORT=e.accountType===xe.s9.IMAP?993:995),e.MAIL_SMTP_PORT||(e.MAIL_SMTP_PORT=465);try{pU(e,!1),pU(e,!0)}catch(t){return[lU,t.message,e]}if(e.useOAuth)try{return await gU(e,e.MAIL_EMAIL)}catch(e){return e}const t=[e.MAIL_USER],n=[e.MAIL_SMTP_USER];if(e.MAIL_EMAIL===e.MAIL_USER&&e.MAIL_EMAIL===e.MAIL_SMTP_USER&&e.MAIL_EMAIL.includes("@")){const s=e.MAIL_EMAIL.split("@")[0];t.push(s),n.push(s)}const s=await Promise.allSettled([iU(n.map((t=>gU(e,t)))),iU(t.map((t=>(async(e,t)=>{const n={...e,MAIL_USER:t};try{if(e.accountType===xe.s9.IMAP){const e=await cU(n);return[rU,"Incoming connection success",n,e]}return await Me.verifyPopLogin(e),[rU,"Incoming connection success",n]}catch(t){throw[lU,t.message,e,[]]}})(e,t))))]);let i={...e},o=rU,a="",r=!1;for(const e of s)if(e.reason)o=lU,a=e.reason[1],i={...i,...e.reason[2]};else if(e.value&&(i={...i,...e.value[2]},5===e.value.length)){const t=e.value[4];r||(await oU(t),r=!0),t.logout()}return[o,a,i]}},IU=SU;var kU;function AU(e,t,n,s){kU||(kU="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:kU,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const{UNKNOWN:TU,VERIFYING:ZU,OK:EU,ERROR:_U}=xe.In,MU={Back:(0,Oe.Z)("account creation","Back"),IMAP:(0,Oe.Z)("IMAP"),"Manual Setup":(0,Oe.Z)("Manual Setup"),"Edit Servers":(0,Oe.Z)("Edit Servers"),Manual:(0,Oe.Z)("Manual"),POP:(0,Oe.Z)("POP"),"Email Address":(0,Oe.Z)("Email Address"),Password:(0,Oe.Z)("Password"),"Offline Account":(0,Oe.Z)("Offline Account"),"Download Messages for Offline Viewing and Searching":(0,Oe.Z)("Download Messages for Offline Viewing and Searching"),"Upload Sent Messages to Sent Folder":(0,Oe.Z)("Upload Sent Messages to Sent Folder"),"Add your First Account":(0,Oe.Z)("Add your First Account"),"Add Mail Account":(0,Oe.Z)("Add Mail Account"),"Enter your email address below and we’ll help you get going with your first account.":(0,Oe.Z)("Enter your email address below and we’ll help you get going with your first account."),"Enter your email address below and we’ll help you get going.":(0,Oe.Z)("Enter your email address below and we’ll help you get going."),"If you would like a new mail account, we offer a free account when you register with vivaldi.net.":(0,Oe.Z)("If you would like a new mail account, we offer a free account when you register with vivaldi.net."),"Don’t have an email address?":(0,Oe.Z)("Don’t have an email address?"),"We have a selection of trusted email providers for you to choose from.":(0,Oe.Z)("We have a selection of trusted email providers for you to choose from."),"Please provide the password for your account":(0,Oe.Z)("Please provide the password for your account"),"Enter your password":(0,Oe.Z)("Enter your password"),...FW,"IMAP Server":(0,Oe.Z)("IMAP Server"),"POP Server":(0,Oe.Z)("POP Server"),"SMTP Server":(0,Oe.Z)("SMTP Server"),"Account Type":(0,Oe.Z)("Account Type"),Port:(0,Oe.Z)("Port"),"Create Local Account":(0,Oe.Z)("Create Local Account")},NU="https://vivaldi.com/email-signup/";class PU extends hs.PureComponent{static contextType=xi.Z;_isMounted=!1;constructor(e){super(e),this.state={isAdding:!0,status:TU,statusText:"",account:{accountType:xe.s9.IMAP,MAIL_SMTP_SOCKET_TYPE:"ssl"},addressValidated:!1,incomingVerified:!1,smtpVerified:!1,userVerified:!1,isEdited:!1,showManual:!1,syncUsernames:!0,syncPasswords:!0,showConfirmOAuth:!1}}componentDidMount(){this._isMounted=!0}componentWillUnmount(){this._isMounted=!1}setAccountProperty=(e,t)=>{"MAIL_EMAIL"===e?this.setState((e=>{const n=e.syncUsernames&&e.account.MAIL_EMAIL===e.account.MAIL_USER&&e.account.MAIL_EMAIL===e.account.MAIL_SMTP_USER,s={...e.account,MAIL_EMAIL:t,MAIL_USER:n?t:e.account.MAIL_USER,MAIL_SMTP_USER:n?t:e.account.MAIL_SMTP_USER};return{addressValidated:!this.accountExists(t)&&(e.account.offline||IU.isValidEmail(s)),account:s,syncUsernames:n}})):"MAIL_PASSWORD"===e?this.setState((e=>{const n=e.syncPasswords&&e.account.MAIL_PASSWORD===e.account.MAIL_SMTP_PASSWORD;return{account:{...e.account,MAIL_PASSWORD:t,MAIL_SMTP_PASSWORD:n?t:e.account.MAIL_SMTP_PASSWORD},syncPasswords:n}})):"MAIL_PORT"===e||"MAIL_SMTP_PORT"===e?this.setState((n=>({account:{...n.account,[e]:""!==t?Number(t):NaN},..."MAIL_PORT"===e?{incomingVerified:!1}:{smtpVerified:!1}}))):"MAIL_SERVER"===e||"MAIL_SMTP_SERVER"===e?this.setState((n=>({account:{...n.account,[e]:t},incomingVerified:"MAIL_SERVER"!==e&&n.incomingVerified,smtpVerified:"MAIL_SMTP_SERVER"!==e&&n.smtpVerified}))):this.setState((n=>({account:{...n.account,[e]:t}})))};accountExists(e){return(H.Z.get($.kMailAccounts)||[]).findIndex((t=>t.MAIL_EMAIL===e))>=0}onChangeAccountProperty=e=>{const{name:t,value:n}=e.target;this.setAccountProperty(t,n)};autofill=()=>{this.state.account.offline?this.createOffline():this.setState((e=>({isEdited:e.status===_U,status:ZU,statusText:(0,Oe.Z)("Attempting account autodiscovery...")})),(async()=>{const[e,t]=await IU.autofill(this.state.account);this.autofillCallback(e,t)}))};signIn=()=>{this.setState((e=>({isAdding:!1,isEdited:e.status===_U,status:ZU,statusText:(0,Oe.Z)("Attempting sign in...")})),(async()=>{const[e,t,n]=await IU.signIn(this.state.account);this.signInCallback(e,t,n)}))};completeDiscovery=e=>{this.setState({account:e,isAdding:!1,status:EU,statusText:(0,Oe.Z)("Autodiscovery completed."),incomingVerified:!0,smtpVerified:!0,userVerified:!1})};onCancel=()=>{this.setState({showConfirmOAuth:!1,status:EU})};onConfirmOAuth=e=>{this.setState((t=>({account:{...t.account,useOAuth:e},showConfirmOAuth:!1}))),e?this.signIn():this.completeDiscovery(this.state.account)};autofillCallback=(e,t)=>{if(this._isMounted)if(e===EU)(0,RW.Ap)(t)?this.setState({account:{...t},showConfirmOAuth:!0}):this.completeDiscovery(t);else if(e===_U){const e=t.MAIL_SERVER&&t.MAIL_PASSWORD&&t.MAIL_SMTP_SERVER&&t.MAIL_SMTP_PASSWORD;this.setState((n=>{const s={...n.account,...t};return{status:_U,statusText:e?(0,Oe.Z)("This should not happen"):(0,Oe.Z)("Autodiscovery failed. Please enter server settings"),showManual:!e,account:s,userVerified:!1}}))}};signInCallback=(e,t,n)=>{this._isMounted&&e===EU?this.setState({account:n,isAdding:!1,status:EU,statusText:(0,Oe.Z)("Login completed."),incomingVerified:!0,smtpVerified:!0,userVerified:!0},this.saveAccount):this._isMounted&&e===_U&&this.setState((e=>{const s={...e.account,...n};return{status:_U,statusText:t,account:s,userVerified:!1}}))};considerAddingAccount=e=>{const t=e.target.name||"",n="BACK"===t,s="OFFLINE"===t,i="MANUAL"===t&&!this.state.isAdding||n||s;"Enter"!==e.key||i||this.onSubmit()};createOfflineMailFolder=async e=>{const t=(0,b_.B)(e);return new Promise((e=>{C.Z.mailPrivate.createFileDirectory(t,e)}))};createOffline=async()=>{const e=this.state.account.MAIL_EMAIL;await this.createOfflineMailFolder(e),this.saveAccount()};createAccountBooleanHandler=e=>t=>{const{checked:n}=t.target;this.setState((t=>({account:{...t.account,[e]:n}})))};saveAccount=async()=>{(0,Yc.ZP)(this.state.account),await Se.Z.addAccount(this.state.account)};setViewType=e=>{const t=e.target.name;this.setState((e=>({showManual:"MANUAL"===t})))};createLocalAccount=e=>{this.setState((e=>({account:{...e.account,offline:!0}})),this.createOffline)};onSubmit=()=>{!this.state.addressValidated||this.isCreating()||this.state.account.offline||(this.state.isAdding&&!this.state.showManual?this.autofill():this.signIn())};renderSubmitButton=()=>{const e=this.state.status!==_U&&!this.state.showManual,t=this.state.status===_U&&!this.state.showManual;let n;this.state.showManual?n=(0,Oe.Z)("Add Account"):this.state.isAdding?n=(0,Oe.Z)("Continue"):e?n=(0,Oe.Z)("Sign In"):t&&(n=(0,Oe.Z)("Retry Login"));const s=!this.state.addressValidated||this.isCreating();return AU("input",{onClick:this.onSubmit,className:"primary",disabled:s,type:"button",value:n})};onChangeMailAccountType=e=>{const t=e.target.value===xe.s9.POP?xe.s9.POP:xe.s9.IMAP;this.setState((e=>({account:{...e.account,accountType:t}})))};isCreating=()=>this.state.status===ZU;renderStatusCheck=()=>{if(this.state.status===ZU||this.state.status===_U)return AU(tc,{type:this.state.status===_U?"error":"info"},void 0,this.state.statusText)};onSignUpClicked=()=>{d.ZP.openURL(this.context.vivaldiWindowId,NU),this.props.onClose&&this.props.onClose()};showOAuthDialog=()=>{const e=(0,Oe.Z)("OAuth follows a standard login process."),t=(0,Oe.Z)("Alternatively use an app-specific password. They are single purpose passwords that you can generate to login permanently."),n=(0,Oe.Z)("More info on Vivaldi Help.");return AU(SA,{title:(0,Oe.Z)("Pick Authentication Type"),prompt:[e,"",t,n],negative:(0,Oe.Z)("Use App-Specific Password"),positive:(0,Oe.Z)("Use OAuth"),onRequestClose:this.onCancel,onClose:this.onConfirmOAuth})};render(){const e=this.isCreating(),t=this.state.account.accountType===xe.s9.POP,n=!this.state.account.useOAuth&&this.state.showManual;return AU("div",{className:"detail"},void 0,AU("div",{className:"detail-content"},void 0,AU("div",{className:"setting-group-double"},void 0,this.state.isAdding&&!this.state.showManual&&(0,fs.jsxs)(fs.Fragment,{children:[AU("h2",{},void 0,this.props.emptyAccounts?MU["Add your First Account"]:MU["Add Mail Account"]),AU("p",{className:"mail-setup-description"},void 0,this.props.emptyAccounts?MU["Enter your email address below and we’ll help you get going with your first account."]:MU["Enter your email address below and we’ll help you get going."])]}),!this.state.isAdding&&!this.state.showManual&&(0,fs.jsxs)(fs.Fragment,{children:[AU("h2",{},void 0,MU["Enter your password"]),AU("p",{className:"mail-setup-description no-margin"},void 0,(0,Oe.Z)("Please provide the password for your account")),AU("a",{className:"mail-setup-email-link",href:"mailto:"+this.state.account.MAIL_EMAIL},void 0,this.state.account.MAIL_EMAIL)]})),AU("div",{className:"setting-group-double",onKeyPress:this.considerAddingAccount},void 0,this.state.isAdding&&AU("div",{className:"setting-single mail-address"},void 0,AU(sc.Z,{focusInput:this.props.focusInput,type:"text",disabled:e,isVerified:this.state.addressValidated,label:"",name:"MAIL_EMAIL",onChange:this.onChangeAccountProperty,placeholder:(0,Oe.Z)("Enter your email address")}),AU("select",{className:"CreateMailAccount-dropdown",onChange:this.onChangeMailAccountType,value:this.state.account.accountType},void 0,AU("option",{value:xe.s9.IMAP},void 0,(0,Oe.Z)("IMAP")),AU("option",{value:xe.s9.POP},void 0,(0,Oe.Z)("POP3")))),!this.state.isAdding&&!this.state.showManual&&AU("div",{className:"setting-single mail-address"},void 0,AU(sc.Z,{type:"password",disabled:e,label:"",autoFocus:!0,placeholder:(0,Oe.Z)("My long safe password"),onChange:this.onChangeAccountProperty,name:"MAIL_PASSWORD"})),t&&this.state.showManual&&AU(XW,{account:this.state.account,setAccountProperty:this.setAccountProperty})&&AU(tU,{popMaxSize:this.state.account.popMaxSize,setAccountProperty:this.setAccountProperty}),this.state.showManual&&AU(HW,{account:this.state.account,incomingVerified:this.state.incomingVerified,searchableStrings:this.props.searchableStrings,showErrors:this.state.status===_U,smtpVerified:this.state.smtpVerified,userVerified:this.state.userVerified,setAccountProperty:this.setAccountProperty}),this.renderStatusCheck(),AU("div",{className:"toolbar toolbar-default toolbar-wrap"},void 0,this.renderSubmitButton(),!n&&AU("input",{onClick:this.setViewType,type:"button",name:"MANUAL",value:this.state.isAdding?this.props.searchableStrings["Manual Setup"]:this.props.searchableStrings["Edit Servers"]}),!n&&AU("input",{onClick:this.createLocalAccount,type:"button",name:"OFFLINE",value:this.props.searchableStrings["Create Local Account"],disabled:!this.state.addressValidated||this.isCreating()}),n&&AU("input",{onClick:this.setViewType,type:"button",name:"BACK",value:this.props.searchableStrings.Back}))),this.state.isAdding&&!this.state.showManual&&AU("div",{className:"email-partnership"},void 0,AU("h3",{},void 0,MU["Don’t have an email address?"]),AU(hb,{title:NU,onClick:this.onSignUpClicked},void 0,MU["We have a selection of trusted email providers for you to choose from."]))),this.state.showConfirmOAuth&&this.showOAuthDialog())}}const DU=PU;var xU;function OU(e,t,n,s){xU||(xU="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:xU,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class LU extends hs.Component{static contextType=xi.Z;focusSender=()=>{};constructor(e){super(e),this._initDraft()}_initDraft=()=>{this.signature=this.props.signature};componentDidMount(){this._isMounted=!0,this.onContentLoad()}componentWillUnmount(){this._isMounted=!1}componentDidUpdate(e){e.emailAddress!==this.props.emailAddress&&(this.signature=this.props.signature,this.onContentLoad())}onBodyChange=()=>this._isMounted&&this.refSignature.current?.getContentAsBodyParts?this.refSignature.current.getContentAsBodyParts().then(this.updateBody):Promise.reject();updateBody=(0,oS.Z)((async e=>{const t=e[0].content;this.props.onChange(t)}),200,{leading:!1});onContentLoad=()=>{this.signature&&setTimeout((()=>{""!==this.signature&&this.refSignature.current&&this.refSignature.current.setContent([{content:this.signature,isPlainText:!1}]),this.signature=""}),150)};refSignature=hs.createRef();render(){return OU("main",{},void 0,(0,fs.jsx)(HA,{ref:this.refSignature,windowId:this.context.vivaldiWindowId,onSignatureAttachmentDrop:this.props.onChange,focusPreviousElement:this.focusSender,onBodyChange:this.onBodyChange,onContentLoad:this.onContentLoad}))}}const RU=LU;var BU,FU=n(59938);function VU(e,t,n,s){BU||(BU="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:BU,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const WU={"Alias Address":(0,Oe.Z)("Alias Address"),"New Alias":(0,Oe.Z)("New Alias"),"Enable Rich Text and Images":(0,Oe.Z)("Enable Rich Text and Images"),"Replied Messages":(0,Oe.Z)("Replied Messages"),"Forwarded Messages":(0,Oe.Z)("Forwarded Messages"),Signature:(0,Oe.Z)("Signature"),"Sender Name":(0,Oe.Z)("Sender Name")};class UU extends hs.PureComponent{state={newAlias:""};autoSetAliasProperty=(e,t,n)=>{if(n===this.props.aliases[e][t])return;const s=(0,V.Uy)(this.props.aliases,(s=>{s[e][t]=n}));s!==this.props.aliases&&this.props.setAliases(s)};toggleCheckboxAliasProperty=(e,t)=>{const{checked:n,name:s}=e.target;this.autoSetAliasProperty(t,s,n)};autoSaveAliasProperty=(e,t)=>{const{name:n,value:s}=e.target;this.autoSetAliasProperty(t,n,s)};changeNewAlias=e=>{this.setState({newAlias:e.target.value})};addNewAlias=()=>{const e=(0,V.Uy)(this.props.aliases,(e=>{e.push({MAIL_EMAIL:this.state.newAlias})}));this.props.setAliases(e),this.setState({newAlias:""})};removeAlias=e=>{const t=(0,V.Uy)(this.props.aliases,(t=>{t.splice(e,1)}));this.props.setAliases(t)};render(){return(0,fs.jsxs)(fs.Fragment,{children:[VU("form",{className:"setting-group"},void 0,VU("h3",{},void 0,this.props.searchableStrings["New Alias"]),VU("div",{className:"setting-single"},void 0,VU(sc.Z,{type:"text",labelImportant:!0,isVerified:(0,ft.HZ)(this.state.newAlias),label:"",name:"MAIL_EMAIL",onChange:this.changeNewAlias,placeholder:this.props.defaultEmail.split("@").join("+label@")}),VU("input",{type:"submit",onClick:this.addNewAlias,disabled:!(0,ft.HZ)(this.state.newAlias),value:(0,Oe.Z)("Add Alias")}))),this.props.aliases?.map(((e,t)=>VU("div",{className:"MailAliasesForm-block"},t,VU("div",{className:"setting-group"},void 0,VU("div",{className:"setting-single"},void 0,VU("h3",{},void 0,this.props.searchableStrings["Alias Address"]),VU(sc.Z,{type:"text",onChange:e=>this.autoSaveAliasProperty(e,t),name:"MAIL_EMAIL",label:"",placeholder:"John Doe",value:e.MAIL_EMAIL?e.MAIL_EMAIL:""})),VU("div",{className:"setting-single"},void 0,VU("h3",{},void 0,this.props.searchableStrings["Sender Name"]),VU(sc.Z,{type:"text",onChange:e=>this.autoSaveAliasProperty(e,t),name:"MAIL_NAME",label:"",placeholder:"John Doe",value:e.MAIL_NAME?e.MAIL_NAME:""})),VU("div",{className:"setting-single"},void 0,VU("input",{type:"submit",className:"danger",onClick:()=>this.removeAlias(t),value:(0,Oe.Z)("Remove Alias")}))),VU("div",{className:"setting-group setting-group-double"},void 0,VU("div",{className:"setting-single"},void 0,VU("h3",{},void 0,this.props.searchableStrings.Signature),VU("div",{className:"mail-signature"},void 0,e.isSignatureRichText?VU(RU,{onChange:e=>this.autoSetAliasProperty(t,"signature",e),signature:e.signature||"",emailAddress:e.MAIL_EMAIL}):VU(sc.Z,{type:"textarea",rows:"2",onChange:e=>this.autoSaveAliasProperty(e,t),name:"signature",label:"",placeholder:void 0===e.signature?FU.F:"",value:e.signature||""}),VU("div",{className:"mail-signature-footer"},void 0,VU("div",{className:"mail-signature-footer-sidebar"},void 0,VU("h3",{},void 0,(0,Oe.Z)("Include Signature in:")),VU("label",{},void 0,VU("input",{type:"checkbox",name:"signatureReply",checked:void 0===e.signatureReply||e.signatureReply,onChange:e=>this.toggleCheckboxAliasProperty(e,t)}),VU("span",{},void 0,WU["Replied Messages"])),VU("label",{},void 0,VU("input",{type:"checkbox",name:"signatureForward",checked:!!e.signatureForward,onChange:e=>this.toggleCheckboxAliasProperty(e,t)}),VU("span",{},void 0,WU["Forwarded Messages"]))),VU("div",{},void 0,VU("select",{value:e.signaturePosition||"below",onChange:e=>this.autoSaveAliasProperty(e,t),name:"signaturePosition",title:(0,Oe.Z)("Placement of signature")},void 0,VU("option",{value:"above"},void 0,(0,Oe.Z)("Place Signature at Top")),VU("option",{value:"below"},void 0,(0,Oe.Z)("Place Signature at Bottom")))),VU("div",{},void 0,VU("label",{},void 0,VU("input",{type:"checkbox",checked:!!e.isSignatureRichText,name:"isSignatureRichText",onChange:e=>this.toggleCheckboxAliasProperty(e,t)}),VU("span",{},void 0,WU["Enable Rich Text and Images"]))))))))))]})}}const HU=UU;var zU;function GU(e,t,n,s){zU||(zU="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:zU,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const $U=[$.kMailListButtons],KU=Ne.Z.getEventHandler;var jU=GU("span",{className:"ShowMailTipsAndTricks-fakeButton"},void 0,"R"),YU=GU("span",{className:"ShowMailTipsAndTricks-fakeButton"},void 0,"T"),XU=GU("span",{className:"ShowMailTipsAndTricks-fakeButton"},void 0,"F"),QU=GU("span",{className:"ShowMailTipsAndTricks-fakeButton"},void 0,"G"),qU=GU("span",{className:"ShowMailTipsAndTricks-fakeButton"},void 0,"K"),JU=GU("span",{className:"ShowMailTipsAndTricks-fakeButton"},void 0,"E"),eH=GU("span",{className:"ShowMailTipsAndTricks-fakeButton"},void 0,"M"),tH=GU("input",{type:"radio",value:"text_menu"}),nH=GU("input",{type:"radio",value:"icons_only"});class sH extends hs.PureComponent{static contextType=xi.Z;SM=["start","singlekey","unseen","filterbuttons","feeds","final"];state={current:this.props.isSettings?"singlekey":"start"};renderState(e){switch(this.state.current){case"start":return GU("div",{className:"ShowMailTipsAndTricks-allSetContainer"},void 0,GU("span",{className:"ShowMailTipsAndTricks-allSetIcon",dangerouslySetInnerHTML:{__html:Ts.mXV}}),GU("h1",{className:"ShowMailTipsAndTricks-allSetTitle"},void 0,(0,Oe.Z)("Great, you’re all set!")),GU("p",{className:"ShowMailTipsAndTricks-description"},void 0,(0,Oe.Z)("Where to next?")));case"singlekey":const t="https://help.vivaldi.com/desktop/shortcuts/keyboard-shortcuts/";return(0,fs.jsxs)(fs.Fragment,{children:[GU("h1",{className:"ShowMailTipsAndTricks-title"},void 0,(0,Oe.Z)("Mail Tips & Tricks")),GU("h2",{className:"ShowMailTipsAndTricks-subtitle"},void 0,(0,Oe.Z)("Single key shortcuts")),GU("p",{className:"ShowMailTipsAndTricks-description"},void 0,(0,Oe.Z)("When you’re in Mail you can hit a single key to get common tasks done faster")),GU("div",{className:"ShowMailTipsAndTricks-shortcuts"},void 0,GU("label",{className:"ShowMailTipsAndTricks-shortcutContainer"},void 0,jU,(0,Oe.Z)("Reply")),GU("label",{className:"ShowMailTipsAndTricks-shortcutContainer"},void 0,YU,(0,Oe.Z)("Threaded View")),GU("label",{className:"ShowMailTipsAndTricks-shortcutContainer"},void 0,XU,(0,Oe.Z)("mail","Forward")),GU("label",{className:"ShowMailTipsAndTricks-shortcutContainer"},void 0,QU,(0,Oe.Z)("Mark the current e-mail as read and jump to the next unread.")),GU("label",{className:"ShowMailTipsAndTricks-shortcutContainer"},void 0,qU,(0,Oe.Z)("Mark as Read")),GU("label",{className:"ShowMailTipsAndTricks-shortcutContainer"},void 0,JU,(0,Oe.Z)("Enable Sender View (only show emails to and from the sender)")),GU("label",{className:"ShowMailTipsAndTricks-shortcutContainer"},void 0,eH,(0,Oe.Z)("Mark Thread as Read")),GU("a",{href:t,className:"ShowMailTipsAndTricks-shortcutLink",onClick:()=>d.ZP.openURL(e,t)},void 0,(0,Oe.Z)("Learn more about keyboard shortcuts")))]});case"unseen":const n="https://help.vivaldi.com/mail/mail-get-started/view-and-manage-messages/#Message_read_status";return(0,fs.jsxs)(fs.Fragment,{children:[GU("h1",{className:"ShowMailTipsAndTricks-title"},void 0,(0,Oe.Z)("Mail Tips & Tricks")),GU("h2",{className:"ShowMailTipsAndTricks-subtitle"},void 0,(0,Oe.Z)("Unseen and Unread")),GU("div",{className:"ShowMailTipsAndTricks-descriptionContainer"},void 0,GU("span",{className:"ShowMailTipsAndTricks-icon",dangerouslySetInnerHTML:{__html:Ts.tG3}}),GU("div",{className:"ShowMailTipsAndTricks-descriptionSide ShowMailTipsAndTricks-descriptionSide--Unseen"},void 0,GU("p",{},void 0,(0,Oe.Z)("In Vivaldi Mail, we separate between emails you’ve seen and those you have read.")),GU("p",{},void 0,(0,Oe.Z)("Emails are not marked read until you press K or G on the keyboard (or use the toolbar buttons).")),GU("a",{href:n,onClick:()=>d.ZP.openURL(e,n)},void 0,(0,Oe.Z)("Learn more about Unseen emails."))))]});case"filterbuttons":const s="https://help.vivaldi.com/mail/mail-get-started/view-and-manage-messages/#Display_messages_with_view_toggles";return(0,fs.jsxs)(fs.Fragment,{children:[GU("h1",{className:"ShowMailTipsAndTricks-title"},void 0,(0,Oe.Z)("Mail Tips & Tricks")),GU("h2",{className:"ShowMailTipsAndTricks-subtitle"},void 0,(0,Oe.Z)("View Filters")),GU("div",{className:"ShowMailTipsAndTricks-descriptionContainer"},void 0,GU("div",{className:"ShowMailTipsAndTricks-descriptionSide"},void 0,GU("h3",{},void 0,(0,Oe.Z)("Select View Filter style:")),GU(vl,{name:"maillistbuttonstips",value:this.props.prefValues[$.kMailListButtons],onChange:KU($.kMailListButtons),className:"ShowMailTipsAndTricks-radioGroup"},void 0,GU("div",{className:"setting-single"},void 0,GU("label",{},void 0,tH,GU("span",{},void 0,(0,Oe.Z)("Text Menu"))),GU("div",{className:"text_menu"===this.props.prefValues[$.kMailListButtons]?"img-setting":"img-setting disabled"},void 0,GU("span",{className:"text_menu"===this.props.prefValues[$.kMailListButtons]?"mail-settings-image image alternate":"mail-settings-image image",dangerouslySetInnerHTML:{__html:Ts.yYJ}}))),GU("div",{className:"setting-single"},void 0,GU("label",{},void 0,nH,GU("span",{},void 0,(0,Oe.Z)("Icons Only"))),GU("div",{className:"icons_only"===this.props.prefValues[$.kMailListButtons]?"img-setting":"img-setting disabled"},void 0,GU("span",{className:"icons_only"===this.props.prefValues[$.kMailListButtons]?"mail-settings-image image alternate":"mail-settings-image image",dangerouslySetInnerHTML:{__html:Ts.EO4}}))))),GU("div",{className:"ShowMailTipsAndTricks-descriptionSide"},void 0,GU("p",{},void 0,(0,Oe.Z)("They are Show Read, Show Custom IMAP folders, Show Mailing Lists, Show Feeds, Show Junk, and Show Deleted.")),GU("p",{},void 0,(0,Oe.Z)("For global views, such as the Unread view, you can quickly filter out messages that have already been dealt with (like read messages) or sorted (like e-mail in other folders than your Inbox).")),GU("a",{href:s,onClick:()=>d.ZP.openURL(e,s)},void 0,(0,Oe.Z)("Learn more about View Filters"))))]});case"feeds":const i="https://help.vivaldi.com/mail/mail-feeds/feeds/";return(0,fs.jsxs)(fs.Fragment,{children:[GU("h1",{className:"ShowMailTipsAndTricks-title"},void 0,(0,Oe.Z)("Mail Tips & Tricks")),GU("h2",{className:"ShowMailTipsAndTricks-subtitle"},void 0,(0,Oe.Z)("Feeds")),GU("div",{className:"ShowMailTipsAndTricks-descriptionContainer"},void 0,GU("span",{className:"ShowMailTipsAndTricks-icon",dangerouslySetInnerHTML:{__html:Ts.ooy}}),GU("div",{className:"ShowMailTipsAndTricks-descriptionSide"},void 0,GU("p",{},void 0,(0,Oe.Z)("That’s right, we have a Feed reader built into our email client!")),GU("p",{},void 0,(0,Oe.Z)("You can add feeds directly in the Mail Panel, or use the standalone Feeds panel.")),GU("a",{href:i,onClick:()=>d.ZP.openURL(e,i)},void 0,(0,Oe.Z)("Learn more about the Feed reader"))))]});case"final":const o="https://help.vivaldi.com/mail/#mail-get-started";return(0,fs.jsxs)(fs.Fragment,{children:[GU("h1",{className:"ShowMailTipsAndTricks-title"},void 0,(0,Oe.Z)("Mail Tips & Tricks")),GU("h2",{className:"ShowMailTipsAndTricks-subtitle"},void 0,(0,Oe.Z)("Get all the help you need")),GU("div",{className:"ShowMailTipsAndTricks-descriptionContainer"},void 0,GU("span",{className:"ShowMailTipsAndTricks-icon",dangerouslySetInnerHTML:{__html:Ts.Kuf}}),GU("div",{className:"ShowMailTipsAndTricks-descriptionSide"},void 0,GU("p",{},void 0,(0,Oe.Z)("Want more tips and tricks? Our Help pages contain all the documentation you need.")),GU("p",{},void 0,(0,Oe.Z)("Visit our Help pages for Mail.")),GU("a",{href:o,onClick:()=>d.ZP.openURL(e,o)},void 0,(0,Oe.Z)("Learn more about Vivaldi Mail"))))]});default:return null}}getNextState=()=>{const e=this.SM.indexOf(this.state.current),t=this.SM[e+1];this.setState({current:t})};openMail=async()=>{const e=this.context.vivaldiWindowId;this.props.onClose&&this.props.onClose(),Pn.Z.showContent(e,"PanelMail",{setFocus:!0,selectId:"",reason:""});const t=await s.Z.tabs.query({windowType:"normal"}),n=await t.find((e=>e.url?.startsWith(je.xy.mailpage)));n?s.Z.windows.update(n.windowId,{focused:!0},(()=>{s.Z.tabs.update(n.id,{active:!0})})):Ae.Z.showMail(e),l.Z.selectFolder({name:(0,Oe.Z)("Unread"),accountId:xe.of,path:xe.tB,id:xe.w1+"_"+xe.tB})};render(){return GU("div",{className:As()("ShowMailTipsAndTricks",this.props.isSettings&&"ShowMailTipsAndTricks--inSettings")},void 0,this.renderState(this.context.vivaldiWindowId),GU("div",{className:As()("ShowMailTipsAndTricks-buttonContainer",this.props.isSettings&&"ShowMailTipsAndTricks-buttonContainer--inSettings")},void 0,GU("div",{className:"ShowMailTipsAndTricks-buttonCenter"},void 0,"final"!==this.state.current&&GU("input",{type:"submit",className:"ShowMailTipsAndTricks-button",value:"start"===this.state.current?(0,Oe.Z)("Show me tips and tricks"):(0,Oe.Z)("Next tip"),onClick:this.getNextState}),"start"===this.state.current&&GU("input",{type:"button",className:"ShowMailTipsAndTricks-button",value:(0,Oe.Z)("Add another account"),onClick:this.props.onCreateItem}),!this.props.isSettings&&GU("input",{type:"button",className:"ShowMailTipsAndTricks-button",value:(0,Oe.Z)("Open Vivaldi Mail"),onClick:this.openMail}),"final"===this.state.current&&this.props.isSettings&&GU("input",{type:"button",className:"ShowMailTipsAndTricks-button",value:(0,Oe.Z)("mail","Done"),onClick:()=>this.props.onClose&&this.props.onClose()}))))}}const iH=sa(sH,$U);var oH;function aH(e,t,n,s){oH||(oH="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:oH,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class rH extends hs.PureComponent{constructor(e){if(super(e),e.children instanceof Array){const t=e.children[0];this.state={selectedTabId:e.activeTabId||t.props.id}}}componentDidUpdate(e){e.activeTabId!==this.props.activeTabId&&this.setState({selectedTabId:this.props.activeTabId})}onTabClick=e=>{this.props.onTabClick&&this.props.onTabClick(e),this.setState({selectedTabId:e})};render(){const{children:e,icons:t}=this.props,n=this.state.selectedTabId;return e instanceof Array&&e.length>1?aH("div",{className:[this.props.className,"TabbedView"].join(" ")},void 0,aH("nav",{className:"TabbedView-List",role:"tablist"},void 0,e.map(((e,s)=>{const{id:i,label:o,className:a}=e.props;return aH("button",{"aria-selected":i===n?"true":"false",type:"button",role:"tab",className:As()(i===n&&"active",a),onMouseDown:e=>e.preventDefault(),onClick:()=>this.onTabClick(i),dangerouslySetInnerHTML:{__html:(t?t[s]:"")+o}},i)}))),e.map((e=>{if(e.props.id===n)return aH("div",{className:"TabbedView-Content",role:"tabpanel","aria-labelledby":e.props.id},e.props.id,e.props.children)}))):(console.warn("TabbedView error: expecting multiple TabGroupEntries"),null)}}const lH=rH;var dH,cH=n(34155);function hH(e,t,n,s){dH||(dH="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:dH,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const{VERIFYING:pH,OK:uH,ERROR:gH,OFFLINE:mH}=xe.In,vH={"Sender Name":(0,Oe.Z)("Sender Name"),"Account Display Name":(0,Oe.Z)("Account Display Name"),"Sync Options":(0,Oe.Z)("Sync Options"),Signature:(0,Oe.Z)("Signature"),"Download Messages for Offline Viewing and Searching":(0,Oe.Z)("Download Messages for Offline Viewing and Searching"),"Take Account Offline":(0,Oe.Z)("Take Account Offline"),"Upload Sent Messages to Sent Folder":(0,Oe.Z)("Upload Sent Messages to Sent Folder"),"Update Account":(0,Oe.Z)("Update Account"),Aliases:(0,Oe.Z)("Aliases"),Identity:(0,Oe.Z)("Identity"),Servers:(0,Oe.Z)("Servers"),Tips:(0,Oe.Z)("Tips"),"Name and signature":(0,Oe.Z)("Name and signature"),"Add a sender name and signature for this account.":(0,Oe.Z)("Add a sender name and signature for this account."),"Enable Rich Text and Images":(0,Oe.Z)("Enable Rich Text and Images"),"Replied Messages":(0,Oe.Z)("Replied Messages"),"Forwarded Messages":(0,Oe.Z)("Forwarded Messages"),...FW,...WU},fH=["MAIL_EMAIL","MAIL_PORT","MAIL_SERVER","MAIL_USER","MAIL_PASSWORD","MAIL_SMTP_PORT","MAIL_SMTP_SERVER","MAIL_SMTP_USER","MAIL_SMTP_PASSWORD","offline"];class yH extends hs.PureComponent{_isMounted=!1;_hasVerified=!1;constructor(e){super(e),this.state={status:pH,statusText:(0,Oe.Z)("Verifying..."),accountSettings:this.props.accountSettings,incomingVerified:!1,smtpVerified:!1,userVerified:!1,view:"identity",...this.getStatus()}}static getDerivedStateFromProps(e,t){return e.accountSettings.MAIL_EMAIL!==t.accountSettings.MAIL_EMAIL?{accountSettings:e.accountSettings}:null}componentDidMount(){this._isMounted=!0,rf.addListener(this.onConnectionChanged)}componentWillUnmount(){this._isMounted=!1,rf.removeListener(this.onConnectionChanged)}onConnectionChanged=()=>{this.setState(this.getStatus())};getStatus=()=>{if(this.props.accountSettings.accountType===xe.s9.IMAP){const e=rf.getErrorMessage(this.props.accountSettings.MAIL_EMAIL);return e?{status:gH,statusText:e}:!this.props.accountSettings.offline&&rf.isDisconnected(this.props.accountSettings.MAIL_EMAIL)?{status:gH,statusText:(0,Oe.Z)("No network connection")}:{status:uH,statusText:(0,Oe.Z)("Verified")}}};componentDidUpdate(e,t){this.props.accountSettings!==e.accountSettings&&this._isConnectionUpdated(e.accountSettings,this.props.accountSettings)&&cH.nextTick((async()=>{if(this._isMounted){this.setState({status:pH,statusText:(0,Oe.Z)("Verifying..."),incomingVerified:!1,smtpVerified:!1,userVerified:!1});const[e,t,n]=await IU.verify(this.props.accountSettings);this.verifyAccountCallback(e,t,n)}}))}_isConnectionUpdated=(e,t)=>fH.some((n=>e[n]!==t[n]));saveAccount=async()=>{const e=this.props.accountSettings,t=this.state.accountSettings,n=this._isConnectionUpdated(e,t);if(t.accountType===xe.s9.POP?Me.checkForMail(t.MAIL_EMAIL):t.accountType===xe.s9.IMAP&&(n?(await Ie.Z.disconnectIMAPClient(e.MAIL_EMAIL),Ie.Z.connectIMAPClient(t)):t.MAIL_PASSWORD!==e.MAIL_PASSWORD&&t.accountType===xe.s9.IMAP&&Ie.Z.reconnectIMAPClient(t.MAIL_EMAIL)),e){if(n){this.setState({status:pH,statusText:(0,Oe.Z)("Verifying..."),incomingVerified:!1,smtpVerified:!1,userVerified:!1});const[e,t,n]=await IU.verify(this.state.accountSettings);this.verifyAccountCallback(e,t,n)}(0,Yc.ZP)(t,e)}};setAccountProperty=(e,t)=>{"MAIL_PORT"===e||"MAIL_SMTP_PORT"===e?this.setState((n=>({accountSettings:{...n.accountSettings,[e]:Number(t)}}))):this.setState((n=>({accountSettings:{...n.accountSettings,[e]:t}})))};autoSetAccountProperty=(e,t)=>{t!==this.props.accountSettings[e]&&this.setState((n=>({accountSettings:{...n.accountSettings,[e]:t}})),(()=>(0,Yc.ZP)(this.state.accountSettings,this.props.accountSettings)))};autoSaveAccountProperty=e=>{const{name:t,value:n}=e.target;this.autoSetAccountProperty(t,n)};autoSaveCheckboxAccountProperty=e=>{const{name:t,checked:n}=e.target;this.autoSetAccountProperty(t,n)};areNonAutosavedPropertiesSame=()=>{const e=this.props.accountSettings,t=this.state.accountSettings;return t.MAIL_EMAIL===e.MAIL_EMAIL&&t.MAIL_PASSWORD===e.MAIL_PASSWORD&&t.MAIL_PORT===e.MAIL_PORT&&t.MAIL_SERVER===e.MAIL_SERVER&&t.MAIL_SMTP_PASSWORD===e.MAIL_SMTP_PASSWORD&&t.MAIL_SMTP_PORT===e.MAIL_SMTP_PORT&&t.MAIL_SMTP_SERVER===e.MAIL_SMTP_SERVER&&t.MAIL_SMTP_USER===e.MAIL_SMTP_USER&&t.MAIL_USER===e.MAIL_USER&&t.popDeletion===e.popDeletion&&t.useOAuth===e.useOAuth&&t.MAIL_SMTP_SOCKET_TYPE===e.MAIL_SMTP_SOCKET_TYPE};verifyAccountCallback=(e,t,n)=>{if(!this._isMounted)return;const i=(0,b_.B)(t.MAIL_EMAIL);new Promise(((e,t)=>{C.Z.mailPrivate.getFileDirectory(i,(n=>{s.Z.runtime.lastError?new Promise((e=>{C.Z.mailPrivate.createFileDirectory(i,(i=>{s.Z.runtime.lastError?t((0,Oe.Z)("Error creating data directory")):e(n)}))})).then(e(n)):e(n)}))})).then((s=>{if(this._isMounted&&e===uH)this.setState({status:uH,statusText:(0,Oe.Z)("Verified"),incomingVerified:!0,smtpVerified:!0,userVerified:!0});else if(this._isMounted&&e===gH){const e="string"==typeof t.MAIL_SERVER&&t.MAIL_SERVER.length>3,s="string"==typeof t.MAIL_SMTP_SERVER&&t.MAIL_SMTP_SERVER.length>3;this.setState({status:gH,statusText:(0,Oe.Z)("Error: $1",[n.message]),incomingVerified:e&&!isNaN(t.MAIL_PORT),smtpVerified:s&&!isNaN(t.MAIL_SMTP_PORT),userVerified:!1})}else this._isMounted&&e===mH&&this.setState({status:mH,statusText:(0,Oe.Z)("mail","Offline")})})).catch((e=>{this.setState({status:gH,statusText:e})}))};toggleOffline=e=>{const{checked:t}=e.target,{offline:n}=this.state.accountSettings;this.setState((e=>({accountSettings:{...e.accountSettings,offline:t}})),(()=>{(0,Yc.HV)(this.state.accountSettings),n&&!t?(this.setState({view:"servers"}),Ie.Z.connectIMAPClient(this.state.accountSettings)):!n&&t&&Ie.Z.disconnectIMAPClient(this.state.accountSettings.MAIL_EMAIL)}))};togglePrefetch=e=>{const{checked:t}=e.target,{preFetch:n,MAIL_EMAIL:s}=this.state.accountSettings;this.setState((e=>({accountSettings:{...e.accountSettings,preFetch:t}})),(()=>{(0,Yc.HV)(this.state.accountSettings),!n&&t&&setTimeout((()=>Ie.Z.preFetch(s)),200)}))};toggleUploadSent=e=>{const{checked:t}=e.target;this.setState((e=>({accountSettings:{...e.accountSettings,uploadSent:t}})),(()=>{(0,Yc.HV)(this.state.accountSettings)}))};toggleSignatureRichText=e=>{const{checked:t}=e.target;this.setState((e=>({accountSettings:{...e.accountSettings,isSignatureRichText:t}})),(()=>{(0,Yc.HV)(this.state.accountSettings)}))};setViewType=e=>{"servers"!==e||this._hasVerified||(this._hasVerified=!0,IU.verify(this.props.accountSettings).then((e=>{const[t,n,s]=e;this.verifyAccountCallback(t,n,s)}))),this.setState({view:e})};render(){const e=this.props.showTips,t=this.state.accountSettings,n=t.accountType===xe.s9.POP,s=this.state.status===gH?"error":this.state.status===uH?"success":"info";return hH("div",{className:"detail"},void 0,e&&hH("div",{className:"tips"},void 0,hH("h2",{},void 0,vH["Name and signature"]),hH("p",{className:"mail-setup-description"},void 0,vH["Add a sender name and signature for this account."])),hH(lH,{icons:["",this.state.status===gH?Ts.viW:"","",""],onTabClick:this.setViewType,activeTabId:this.state.view,className:e?"hide-navigation":""},void 0,hH("div",{id:"identity",label:vH.Identity},void 0,hH("div",{className:"setting-group"},void 0,hH("div",{className:"setting-single"},void 0,hH("h3",{},void 0,vH["Sender Name"]),hH(sc.Z,{type:"text",onChange:this.autoSaveAccountProperty,name:"MAIL_NAME",label:"",placeholder:"John Doe",value:t.MAIL_NAME?t.MAIL_NAME:""})),hH("div",{className:"setting-single"},void 0,hH("h3",{},void 0,vH["Account Display Name"]),hH(sc.Z,{type:"text",onChange:this.autoSaveAccountProperty,name:"displayName",label:"",placeholder:"My Home Mail Account",value:t.displayName?t.displayName:""}))),hH("div",{className:"setting-group"},void 0,!n&&(0,fs.jsxs)(fs.Fragment,{children:[hH("h3",{},void 0,vH["Sync Options"]),hH("div",{className:"setting-single"},void 0,hH("label",{},void 0,hH("input",{type:"checkbox",checked:!!t.preFetch&&t.preFetch,onChange:this.togglePrefetch,disabled:t.offline}),hH("span",{},void 0,vH["Download Messages for Offline Viewing and Searching"])))]}),!n&&hH("label",{className:"setting-single",title:(0,Oe.Z)("Some mail servers (e.g. Outlook), will create a copy of the sent message in its Sent folder. It is only for such cases that this should be unchecked")},void 0,hH("input",{type:"checkbox",checked:t.uploadSent??!0,onChange:this.toggleUploadSent,disabled:t.offline}),hH("span",{},void 0,vH["Upload Sent Messages to Sent Folder"])),n&&hH(tU,{popMaxSize:t.popMaxSize,setAccountProperty:this.autoSetAccountProperty}),hH("label",{className:"setting-single",title:(0,Oe.Z)("Account will no longer try connecting to a server to fetch new messages")},void 0,hH("input",{type:"checkbox",checked:!!t.offline&&t.offline,onChange:this.toggleOffline}),hH("span",{},void 0,vH["Take Account Offline"]))),hH("div",{className:"setting-group-double"},void 0,hH("h3",{},void 0,vH.Signature),hH("div",{className:"mail-signature"},void 0,t.isSignatureRichText?hH(RU,{onChange:e=>this.autoSetAccountProperty("signature",e),signature:t.signature||"",emailAddress:t.MAIL_EMAIL}):hH(sc.Z,{type:"textarea",rows:"4",onChange:this.autoSaveAccountProperty,name:"signature",label:"",placeholder:void 0===t.signature?FU.F:"",value:t.signature||""}),hH("div",{className:"mail-signature-footer"},void 0,hH("div",{className:"mail-signature-footer-sidebar"},void 0,hH("h3",{},void 0,(0,Oe.Z)("Include Signature in:")),hH("label",{},void 0,hH("input",{type:"checkbox",name:"signatureReply",checked:void 0===t.signatureReply||t.signatureReply,onChange:this.autoSaveCheckboxAccountProperty}),hH("span",{},void 0,vH["Replied Messages"])),hH("label",{},void 0,hH("input",{type:"checkbox",name:"signatureForward",checked:!!t.signatureForward,onChange:this.autoSaveCheckboxAccountProperty}),hH("span",{},void 0,vH["Forwarded Messages"]))),hH("div",{},void 0,hH("select",{value:t.signaturePosition||"below",onChange:this.autoSaveAccountProperty,name:"signaturePosition",title:(0,Oe.Z)("Placement of signature")},void 0,hH("option",{value:"above"},void 0,(0,Oe.Z)("Place Signature at Top")),hH("option",{value:"below"},void 0,(0,Oe.Z)("Place Signature at Bottom")))),hH("div",{},void 0,hH("label",{},void 0,hH("input",{type:"checkbox",checked:!!t.isSignatureRichText,onChange:this.toggleSignatureRichText}),hH("span",{},void 0,vH["Enable Rich Text and Images"])))))),e&&hH("div",{className:"setting-group setting-group-double pad-top"},void 0,hH("input",{type:"submit",value:(0,Oe.Z)("Continue"),onClick:()=>e()}))),hH("div",{id:"servers",label:vH.Servers,className:this.state.status===gH?"error":""},void 0,hH("form",{onSubmit:this.saveAccount},void 0,hH(HW,{disabled:t.useOAuth,account:t,incomingVerified:this.state.incomingVerified,showErrors:this.state.status===gH,smtpVerified:this.state.smtpVerified,userVerified:this.state.userVerified,setAccountProperty:this.setAccountProperty,searchableStrings:vH}),n&&hH(XW,{account:t,setAccountProperty:this.setAccountProperty}),hH("div",{className:"setting-group-double"},void 0,this.state.statusText&&hH(tc,{type:s},void 0,this.state.statusText),hH("input",{type:"submit",value:(0,Oe.Z)("Update Account"),disabled:this.areNonAutosavedPropertiesSame()})))),hH("div",{id:"aliases",label:vH.Aliases},void 0,hH(HU,{aliases:t.aliases||[],setAliases:this.autoSetAccountProperty.bind(this,"aliases"),searchableStrings:vH,defaultSignature:t.signature,defaultName:t.MAIL_NAME,defaultEmail:t.MAIL_EMAIL})),hH("div",{id:"tips",label:vH.Tips},void 0,hH(iH,{onCreateItem:()=>{},onClose:()=>this.setState({view:"identity"}),isSettings:this.props.isSettings}))))}}const CH=yH;var wH;function bH(e,t,n,s){wH||(wH="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:wH,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class SH extends hs.PureComponent{state={deleteFiles:!1,deletePasswords:!0};_isMounted=!1;_isSyncingPasswords=!1;componentDidMount(){this._isMounted=!0,this.getSyncStateForPasswords()}componentWillUnmount(){this._isMounted=!1}getSyncStateForPasswords(){C.Z.sync.getEngineState((e=>{const t=e.dataTypes.find((e=>"passwords"===e.dataType));this._isSyncingPasswords=t?.enabled||!1,this._isMounted&&this.setState({deletePasswords:!1})}))}async onSubmit(e){const t=this.props.item,{MAIL_EMAIL:n,accountType:s}=t;e.preventDefault(),(0,Yc.HV)({...t,isDeleted:!0}),l.Z.removeAccount(n,this.state.deleteFiles,this.state.deletePasswords,s),this.props.onClose()}onChangeFileDeletion(){this.setState((e=>({deleteFiles:!e.deleteFiles})))}onChangePasswordDeletion(){this.setState((e=>({deletePasswords:!e.deletePasswords})))}render(){const{MAIL_EMAIL:e,useOAuth:t}=this.props.item;return bH("form",{onSubmit:this.onSubmit.bind(this)},void 0,bH("header",{className:"dialog-double-header"},void 0,bH("div",{className:"header-icon",dangerouslySetInnerHTML:{__html:Ts.Si$.large}}),bH("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("Delete Account $1",[e]))),!t&&this._isSyncingPasswords&&bH("div",{className:"dialog-content"},void 0,bH("label",{},void 0,bH("input",{autoFocus:!0,type:"checkbox",checked:this.state.deletePasswords,onChange:this.onChangePasswordDeletion.bind(this)}),(0,Oe.Z)("Delete email passwords from settings")),bH("p",{className:"info"},void 0,(0,Oe.Z)("If checked, other instances and devices using the same sync account and Vivaldi Mail will sign out from this account."))),bH("div",{className:"dialog-content"},void 0,bH("label",{},void 0,bH("input",{autoFocus:!0,type:"checkbox",checked:this.state.deleteFiles,onChange:this.onChangeFileDeletion.bind(this)}),(0,Oe.Z)("Also delete message files from disk")),bH("p",{className:"info"},void 0,(0,Oe.Z)("If checked, all message files for $1 will be deleted. Otherwise they will remain on disk.",[e]))),bH("footer",{className:"dialog-footer"},void 0,bH("input",{type:"submit",className:"danger",value:(0,Oe.Z)("verb","Delete"),autoFocus:!0}),bH("input",{type:"button",onClick:this.props.onClose,value:(0,Oe.Z)("Cancel")})))}}const IH=SH;var kH;function AH(e,t,n,s){kH||(kH="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:kH,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const TH="/resources/vivaldi_mail_default.png",ZH=n(89182);class EH extends hs.PureComponent{static contextType=xi.Z;_isMounted=!1;state={isCreating:!1,accounts:[],setupStep:"setup",missingAccountIds:[],isRestoringAccounts:!1};loadAccountsAndCapabilities=async e=>{const t=await fn.Z.loadAllAccounts();if(!this._isMounted)return;const n=m_(t,mn.Z.getAccounts());if(t.length<this.state.accounts.length)this.setState({accounts:t,missingAccountIds:n});else{let s;e&&t.length>this.state.accounts.length&&(s="signature"),s?this.setState({accounts:t,setupStep:s,isCreating:!1,missingAccountIds:n}):this.setState({accounts:t,missingAccountIds:n})}};componentDidMount(){this._isMounted=!0,this.loadAccountsAndCapabilities()}componentWillUnmount(){this._isMounted=!1}componentDidUpdate(e){if(e.prefValues[$.kMailAccounts]!==this.props.prefValues[$.kMailAccounts]){const e=!0;this.loadAccountsAndCapabilities(e)}}renderListItem=(e,t)=>{const{name:n,displayName:s}=t;let i="";"string"!=typeof t.MAIL_EMAIL?et.Z.warn("Mail",["Account Settings"],"Invalid mail address",JSON.stringify(t.MAIL_EMAIL)):i=t.MAIL_EMAIL.split("@")[1]??"";const o=t.isDeleted?(0,Oe.Z)("Deleting..."):t.displayName?t.MAIL_EMAIL:i;return AH(RD,{title:s||n,meta:o,iconPath:i,iconFallbackPath:TH})};onContextMenu=(e,t)=>{const n=this.state.accounts[e],s=n&&n.MAIL_EMAIL,i=(0,b_.B)(s),o=[{handler:()=>TW(this.context.vivaldiWindowId,i),...(0,xs.Z)("Reveal Data Folder")}];(0,Qi.Z)(this.context,o)(t)};renderCreateListItem=()=>AH(RD,{title:(0,Oe.Z)("New Account"),meta:(0,Oe.Z)("Setup in progress..."),iconFallbackPath:TH,isCreating:!0});renderContent=(e,t)=>{const n=this.state.accounts[e];return AH(CH,{accountSettings:n,searchableStrings:t,isSettings:!0})};renderCreate=e=>AH(DU,{focusInput:!0,emptyAccounts:0===this.state.accounts.length,searchableStrings:e},"create");renderEmpty=e=>AH(DU,{emptyAccounts:!0,searchableStrings:e},"empty");remapAccounts=()=>this.state.accounts.map((e=>({...e,key:e.MAIL_EMAIL,name:e.MAIL_EMAIL})));deleteDialog=e=>(0,fs.jsx)(IH,{...e});onCreateItem=()=>{this.setState({isCreating:!0,setupStep:"setup"})};onCancelCreateItem=()=>{this.setState({isCreating:!1})};_restoreLostAccounts=async()=>{this.setState({isRestoringAccounts:!0}),await y_(this.state.missingAccountIds),await this.loadAccountsAndCapabilities(),this._isMounted&&this.setState({isRestoringAccounts:!1})};render(){return this.state.missingAccountIds.length>0?AH("div",{className:"setting-group"},void 0,AH("div",{className:"setting-single"},void 0,AH("h3",{},void 0,(0,Oe.Z)("Database Error Detected")),AH("label",{title:(0,Oe.Z)("Offline accounts are missing from DB and need to be restored!")},void 0,AH("input",{type:"button",onClick:this._restoreLostAccounts,disabled:this.state.isRestoringAccounts,value:this.state.isRestoringAccounts?(0,Oe.Z)("Restoring Accounts ..."):(0,Oe.Z)("Restore Accounts")})))):AH(xD.Z,{title:(0,Oe.Z)("Mail Accounts"),addTipString:(0,Oe.Z)("Add account"),items:this.remapAccounts(),masterLayout:0,onRemove:Aa.Z,deleteDialog:this.deleteDialog,onContextMenu:this.onContextMenu,emptyListGraphic:ZH,emptyListString:(0,Oe.Z)("No accounts added"),renderListItem:this.renderListItem,renderCreateListItem:this.renderCreateListItem,renderContent:this.renderContent,contentStrings:vH,isCreating:this.state.isCreating,onCreateItem:this.onCreateItem,onCancelCreateItem:this.onCancelCreateItem,renderCreate:this.renderCreate,className:"setting-mail-account",createStrings:MU,renderEmpty:this.renderEmpty,emptyStrings:MU,filter:this.props.filter})}}const _H=sa(EH,[$.kMailAccounts]);var MH,NH=n(45709);function PH(e,t,n,s){MH||(MH="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:MH,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const DH=new Map([["SET_FLAG",(0,Oe.Z)("Flag")],["ADD_LABEL",(0,Oe.Z)("Add label")],["REMOVE_LABEL",(0,Oe.Z)("Remove label")],["MARK_READ",(0,Oe.Z)("Mark as read")],["MARK_AS_SPAM",(0,Oe.Z)("Mark as spam")],["ARCHIVE",(0,Oe.Z)("Move to Archive")]]);var xH=PH("hr",{},"separator"),OH=PH("hr",{},"separator");class LH extends hs.PureComponent{state={showCreateLabel:!1,showArchivingNotification:!1};onChangeType=e=>{const t=e.target.value;let n;"ADD_LABEL"===t?n={type:"ADD_LABEL",label:(0,zf.A4)(this.props.trigger.label||"")}:"REMOVE_LABEL"===t?n={type:"REMOVE_LABEL",label:(0,zf.A4)(this.props.trigger.label||"")}:"MARK_READ"===t?n={type:"MARK_READ"}:"SET_FLAG"===t?n={type:"SET_FLAG",flag:this.props.trigger.flag||xe.T4.RED}:"MARK_AS_SPAM"===t?n={type:"MARK_AS_SPAM"}:"ARCHIVE"===t&&(H.Z.get($.kMailAddArchiveFolder)||this.setState({showArchivingNotification:!0}),n={type:"ARCHIVE"}),n&&this.props.editTrigger(this.props.triggerIndex,n)};onChangeLabel=e=>{const t=e.target.value;if("addlabel"===t)return void this.setState({showCreateLabel:!0});switch(this.props.trigger.type){case"ADD_LABEL":const e={type:"ADD_LABEL",label:t};this.props.editTrigger(this.props.triggerIndex,e);break;case"REMOVE_LABEL":const n={type:"REMOVE_LABEL",label:t};this.props.editTrigger(this.props.triggerIndex,n)}};onChangeFlag=e=>{const t=e.target.value;if("SET_FLAG"===this.props.trigger.type){const e={type:"SET_FLAG",flag:t};this.props.editTrigger(this.props.triggerIndex,e)}};renderAction=()=>{switch(this.props.trigger.type){case"ADD_LABEL":case"REMOVE_LABEL":return this.renderLabel();case"SET_FLAG":return this.renderFlag();case"MARK_READ":case"MARK_AS_SPAM":case"ARCHIVE":return}};renderLabel=()=>{const e=De.Z.getByAccountId(xe.ut).sort(zf.jp).map((e=>PH("option",{value:e.path},e.path,(0,nZ.X)(e.name))));return e.push([xH,PH("option",{value:"addlabel"},"addlabel",(0,Oe.Z)("Add New Label"))]),PH("select",{className:"MailTriggerSelector-select",onChange:this.onChangeLabel,value:this.props.trigger.label||""},void 0,e)};renderFlag=()=>{const e=NH.Z.getStandardFlagList().map((e=>PH("option",{value:e},e,(0,D_.M)(e))));return e.push([OH,PH("option",{value:xe.T4.CLEAR_FLAGS},xe.T4.CLEAR_FLAGS,(0,D_.M)(xe.T4.CLEAR_FLAGS))]),PH("select",{className:"MailTriggerSelector-select",onChange:this.onChangeFlag,value:this.props.trigger.flag||xe.T4.RED},void 0,e)};onCustomLabelDlgClose=()=>(this.setState({showCreateLabel:!1}),Promise.resolve());onSetArchivingOption=e=>{e&&Ne.Z.set($.kMailAddArchiveFolder,!0),this.setState({showArchivingNotification:!1})};render(){return(0,fs.jsxs)(fs.Fragment,{children:[PH("form",{className:"MailTriggerSelector"},void 0,PH("select",{className:"MailTriggerSelector-select",onChange:this.onChangeType,value:this.props.trigger.type},void 0,[...DH.keys()].map((e=>PH("option",{value:e},e,DH.get(e))))),this.renderAction(),!this.props.lastTrigger&&PH("input",{type:"button",onClick:this.props.removeTrigger.bind(this,this.props.triggerIndex),className:"MailTriggerSelector-button circular remove"}),PH("input",{type:"button",onClick:this.props.addTrigger,className:"MailTriggerSelector-button circular add"})),this.state.showCreateLabel&&PH(Kf,{onClose:this.onCustomLabelDlgClose,windowId:this.props.windowId,viewMode:"float"}),this.state.showArchivingNotification&&PH(SA,{title:(0,Oe.Z)("Move to Archive"),prompt:[(0,Oe.Z)("The setting 'Add Archive Folder if Missing' is currently turned off. Do you want to turn it on?")],positive:(0,Oe.Z)("Yes"),negative:(0,Oe.Z)("No"),onClose:this.onSetArchivingOption})]})}}const RH=LH;var BH;function FH(e,t,n,s){BH||(BH="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:BH,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const VH={"Mail Filter":(0,Oe.Z)("Mail Filter"),Search:(0,Oe.Z)("mail filters","Search"),Actions:(0,Oe.Z)("mail filters","Actions"),Save:(0,Oe.Z)("Save"),Name:(0,Oe.Z)("mail filters","Filter Name")};class WH extends hs.Component{refButton=hs.createRef();constructor(e){super(e);const t={accountId:this.props.filter.accountId,path:this.props.filter.path,name:this.props.filter.name,id:Be.Z.toFolderPath(this.props.filter.accountId,this.props.filter.path)};this.state={filter:this.props.filter,showDialog:!1,originalSelectedFolder:t,selectedFolderString:JSON.stringify(t)}}componentDidUpdate(e){e.filter!==this.props.filter&&this.setState({filter:this.props.filter})}updateName=e=>{const t=e.target.value;this.setState((0,V.Uy)((({filter:e})=>{e.name=t})))};updateFilter=(e,t)=>{const n=t.target.value;this.setState((0,V.Uy)((({filter:t})=>{"query"===e&&(t.name&&t.name!==t.filterValue.query||(t.name=n)),t.filterValue[e]=n})))};updateFilterCallback=(e,t)=>{this.setState((0,V.Uy)((({filter:n})=>{n.filterValue[e]=t})))};addQuery=(e,t)=>{this.setState((0,V.Uy)((({filter:t})=>{const n=Be.Z.getAddedQuery(e),s=t.filterValue.query,i=s?s+" "+n:n;t.name&&t.name!==s||(t.name=i),t.filterValue.query=i})),(()=>t&&this.saveFilter()))};validate=e=>!(!e.filterValue||0===Object.keys(e.filterValue).length)||(this.setState({showDialog:!0}),!1);onClose=e=>{if(this.setState({showDialog:!1}),e){const e=!0;this.saveFilter(e)}};saveFilter=e=>{if(this.refButton.current?.onBeforeAddMailFilter())return;const t=function(e){const t={...e};if(t.filterValue){const e={...t.filterValue};""===e.query&&(delete e.query,t.filterValue=e)}if(t.triggers){const e=t.triggers.filter((e=>!Object.values(e).some((e=>!e))));0===e.length?delete t.triggers:t.triggers=e}return t}(this.state.filter);(e||this.validate(t))&&(t.name||(t.name=Be.Z.generateFilterName()),void 0===t.id?l.Z.addFilter(t):t.id&&this.props.filter.id&&l.Z.putFilter(t,this.props.filter,!0))};getNewTrigger=()=>({type:"ADD_LABEL",label:""});addTrigger=()=>{const e=this.getNewTrigger();this.setState((0,V.Uy)((({filter:t})=>{t.triggers?t.triggers.push(e):t.triggers=[e]})))};removeTrigger=e=>{this.setState((0,V.Uy)((({filter:t})=>{const{triggers:n}=t;n&&(n.splice(e,1),0===n.length&&delete t.triggers)})))};editTrigger=(e,t)=>{this.setState((0,V.Uy)((({filter:n})=>{const{triggers:s}=n;s&&(s[e]=t)})))};selectSearchFolder=(e,t)=>{const n=De.Z.getByFolderId([e.accountId,e.path]);this.setState((0,V.Uy)((({filter:s,selectedFolderString:i})=>{n&&(s.selectedName=e.name,s.selectedAccountId=e.accountId,s.filterValue={...n.filterValue,query:s.filterValue.query},t)})))};selectSentDate=e=>{this.setState((0,V.Uy)((({filter:t})=>{"number"==typeof e?t.filterValue.sentDate=e:delete t.filterValue.sentDate})))};selectAttachments=e=>{this.setState((0,V.Uy)((({filter:t})=>{"number"==typeof e?t.filterValue.attachments=e:delete t.filterValue.attachments})))};render(){return FH("div",{className:"detail"},void 0,FH("div",{className:"detail-content"},void 0,FH("div",{className:"setting-group-double"},void 0,FH("div",{className:"setting-single"},void 0,FH(sc.Z,{type:"text",onChange:this.updateName,label:this.props.searchableStrings.Name,value:this.state.filter.name||"",labelImportant:!0})),FH("div",{className:"setting-single"},void 0,FH(hM,{filter:this.state.filter,selectedFolderString:this.state.selectedFolderString,currentAccountId:this.props.filter.accountId,currentPath:this.props.filter.path,isEditable:!1,selectSearchFolder:this.selectSearchFolder,originalSelectedFolder:this.state.originalSelectedFolder,isFilterManager:!0})),FH("div",{className:"setting-flexgroup"},void 0,FH("div",{className:"setting-single-noflex"},void 0,FH(gM,{selectSentDate:this.selectSentDate,sentDate:this.state.filter.filterValue.sentDate})),FH("div",{className:"setting-single-noflex"},void 0,FH(GE,{attachments:this.state.filter.filterValue.attachments,selectAttachments:this.selectAttachments}))),FH("div",{className:"setting-single"},void 0,FH(cE,{settingsFilter:this.state.filter,settingsFilterCallback:this.updateFilterCallback},this.state.filter.id||"new")),this.state.filter.filterValue.query&&FH("div",{className:"setting-single"},void 0,FH(sc.Z,{type:"textarea",rows:"3",onChange:this.updateFilter.bind(this,"query"),label:this.props.searchableStrings.Search,title:(0,Oe.Z)("Tokenized search through content, recipients, and subject field"),value:this.state.filter.filterValue.query||""})),FH("div",{className:"setting-single"},void 0,(0,fs.jsx)(UE,{ref:this.refButton,saveFilter:this.saveFilter,isEmpty:!this.state.filter.filterValue.query,onSubmit:this.addQuery,isSettings:!0,selectedMailAddresses:[]},this.state.filter.filterValue.query)),FH("div",{className:"setting-single"},void 0,FH("div",{className:"MailActionManagerEditor-mailTriggerSelectors"},void 0,this.state.filter.triggers?(0,fs.jsxs)(fs.Fragment,{children:[FH("h3",{},void 0,this.props.searchableStrings.Actions),this.state.filter.triggers.map(((e,t)=>FH(RH,{trigger:e,triggerIndex:t,removeTrigger:this.removeTrigger,addTrigger:this.addTrigger,editTrigger:this.editTrigger,lastTrigger:!1,windowId:this.props.windowId},t)))]}):FH("input",{type:"button",value:(0,Oe.Z)("Add Action"),onClick:this.addTrigger}))))),FH("div",{className:"detail-toolbar"},void 0,!this.state.filter.id&&FH("input",{type:"button",className:"primary",onClick:()=>this.saveFilter(),disabled:this.props.filter===this.state.filter,value:(0,Oe.Z)("Add Mail Filter")}),this.state.filter.id&&FH("input",{type:"button",className:"primary",onClick:()=>this.saveFilter(),disabled:this.props.filter===this.state.filter,value:(0,Oe.Z)("Update Mail Filter")}),FH("input",{type:"button",disabled:this.props.filter===this.state.filter,onClick:()=>{this.setState({filter:this.props.filter})},value:(0,Oe.Z)("Cancel")})),this.state.showDialog&&FH(SA,{title:(0,Oe.Z)("Missing search"),prompt:[(0,Oe.Z)("By not specifying any search parameters you are about to apply an action to all your messages. Would you like to proceed?")],positive:(0,Oe.Z)("Apply to All"),negative:(0,Oe.Z)("Cancel"),danger:!0,onRequestClose:()=>this.setState({showDialog:!1}),onClose:this.onClose}))}}const UH=WH;var HH;function zH(e,t,n,s){HH||(HH="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:HH,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const GH=[$.kMailAccounts,$.kMailIsTurnedOff],$H={"Filters added in the mail panel will appear here.":(0,Oe.Z)("Filters added in the mail panel will appear here.")};class KH extends hs.PureComponent{constructor(e){super(e),this.state={mailFilters:this.loadMailFilters()}}componentDidMount(){De.Z.addListener(this.mailFiltersChanged)}componentWillUnmount(){De.Z.removeListener(this.mailFiltersChanged)}mailFiltersChanged=()=>{const e=this.loadMailFilters();this.state.mailFilters.length===e.length&&this.state.mailFilters.every(((t,n)=>t===e[n]))||this.setState({mailFilters:e})};loadMailFilters=()=>De.Z.getAll().filter((e=>e.accountId===xe.Kz&&e.path!==xe.ym));remapMailFilters=e=>e.map(((e,t)=>({...e,key:String(t)})));renderListItem=e=>(0,fs.jsxs)(fs.Fragment,{children:[zH("span",{className:"item-icon",dangerouslySetInnerHTML:{__html:Ts.EnF.small}}),zH("div",{className:"item-title"},void 0,e)]});renderContent=(e,t)=>zH(UH,{searchableStrings:t,windowId:this.props.windowId,filter:this.state.mailFilters[e]});renderCreateListItem=()=>zH("div",{className:"item-title"},void 0,(0,Oe.Z)("New Filter"));renderCreate=e=>{const t=Be.Z.getDefaultFilterForPath(xe.of,xe.ym),n={name:"",accountId:xe.Kz,path:Math.random().toString(36).substring(2),selectedAccountId:t.accountId,selectedName:t.name,filterValue:{}};return zH(UH,{searchableStrings:e,windowId:this.props.windowId,filter:n})};renderEmpty=e=>zH("div",{className:"detail"},void 0,zH("div",{className:"detail-content"},void 0,zH("p",{},void 0,e["Filters added in the mail panel will appear here."])));removeAt=e=>{const t=this.state.mailFilters[e];l.Z.removeFilter(t.id)};render(){return 0===this.props.prefValues[$.kMailAccounts].length||this.props.prefValues[$.kMailIsTurnedOff]?null:zH(xD.Z,{title:(0,Oe.Z)("Mail Filters and Actions"),dataAnchor:"mail_filters_and_actions",deleteTitle:(0,Oe.Z)("Delete Filter"),addTipString:(0,Oe.Z)("Add Mail Filter"),deleteTipString:(0,Oe.Z)("Delete Mail Filter"),masterLayout:1,items:this.remapMailFilters(this.state.mailFilters),onRemove:this.removeAt,renderListItem:this.renderListItem,renderContent:this.renderContent,contentStrings:VH,renderCreate:this.renderCreate,renderCreateListItem:this.renderCreateListItem,renderEmpty:this.renderEmpty,emptyStrings:$H,filter:this.props.filter,className:"setting-mail-filters"})}}const jH=sa(KH,GH);var YH;function XH(e,t,n,s){YH||(YH="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:YH,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var QH=XH("input",{type:"radio",value:!0}),qH=XH("input",{type:"radio",value:!1});class JH extends hs.PureComponent{state={ignoredMailingLists:Cn.Z.getIgnored()};componentDidMount(){tf.Z.addListener(this.mailingListsChanged)}componentWillUnmount(){tf.Z.removeListener(this.mailingListsChanged)}mailingListsChanged=e=>{if("mailingLists"===e.target){const e=Cn.Z.getIgnored();if(this.state.ignoredMailingLists.length===e.length&&this.state.ignoredMailingLists.every(((t,n)=>t===e[n])))return;this.setState({ignoredMailingLists:e})}};remap=e=>e.map(((e,t)=>({name:e.listId,key:String(t)})));renderListItem=(e,t)=>XH("span",{title:t.listId},void 0,e);onRemove=e=>{l.Z.removeIgnoredMailingList(this.state.ignoredMailingLists[e])};onChangeIgnoreAll=e=>{const{value:t}=e.target,n="true"===t,s=Cn.Z.get(xe.ZW);s&&s.isIgnored!==n&&(s.isIgnored=!s.isIgnored,l.Z.updateMailingListGroup(s))};render(){return XH("div",{className:"detail"},void 0,XH("div",{className:"detail-content"},void 0,XH("div",{className:"setting-group unlimited"},void 0,XH("h3",{},void 0,(0,Oe.Z)("Uncategorized mailing lists")),XH("p",{className:"info"},void 0,(0,Oe.Z)("Manage the rest of the mailing lists that have been automatically generated using the list-id attribute"))),XH(vl,{name:"subFolderType",value:Cn.Z.areUncategorizedMailingListsIgnored(),onChange:this.onChangeIgnoreAll,className:"setting-group unlimited"},void 0,XH("div",{className:"setting-single"},void 0,XH("label",{},void 0,QH,XH("span",{},void 0,(0,Oe.Z)("mailinglist subfolder","Ignore All")))),XH("div",{className:"setting-single"},void 0,XH("label",{},void 0,qH,XH("span",{},void 0,(0,Oe.Z)("Ignore Selected"))))),XH("div",{className:"setting-single"},void 0,XH(x_.Z,{items:this.remap(this.state.ignoredMailingLists),renderListItem:this.renderListItem,filter:this.props.filter,deleteTipString:(0,Oe.Z)("Stop ignoring uncategorized mailing list"),supportDragAndDrop:!1,onRemove:this.onRemove}))))}}const ez=JH;var tz;function nz(e,t,n,s){tz||(tz="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:tz,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const sz={Sender:(0,Oe.Z)("Sender"),"List ID":(0,Oe.Z)("List ID")};var iz=nz("input",{type:"radio",value:"true"}),oz=nz("input",{type:"radio",value:"false"});class az extends hs.Component{state={mailingList:this.props.mailingList,updating:!1};componentDidUpdate(e){e.mailingList!==this.props.mailingList&&this.setState({mailingList:this.props.mailingList,updating:!1})}updateListId=e=>{const t=e.target.value;this.setState((0,V.Uy)((({mailingList:e})=>{e.listId===e.name&&(e.name=t),e.listId=t})))};updateName=e=>{const t=e.target.value;this.setState((0,V.Uy)((({mailingList:e})=>{e.name=t})))};onlyPathChanged=()=>Object.keys(this.state.mailingList).every((e=>"name"===e?this.state.mailingList[e]!==this.props.mailingList[e]:this.state.mailingList[e]===this.props.mailingList[e]));saveMailingList=async()=>{this.setState({updating:!0}),this.onlyPathChanged()?await l.Z.updateMailingListGroupName(this.state.mailingList):await l.Z.updateMailingListGroup(this.state.mailingList)};hasChanged=()=>this.state.mailingList!==this.props.mailingList;isIgnoredChanged=e=>{const t=e.target.value;this.setState((0,V.Uy)((({mailingList:e})=>{e.isIgnored="true"===t})))};onChangeSubfolderType=e=>{const t=e.target.value;this.setState((0,V.Uy)((({mailingList:e})=>{e.subFolderType=t})))};onChangeParentFolder=e=>{const t=e.target.value;this.setState((0,V.Uy)((({mailingList:e})=>{e.parentFolderType=t})))};cancel=()=>{this.setState({mailingList:this.props.mailingList})};render(){const e=this.state.mailingList;return nz("form",{className:"detail",style:{overflowY:"scroll"}},void 0,nz("div",{className:"detail-content"},void 0,nz("div",{className:"setting-group unlimited"},void 0,nz("h3",{},void 0,(0,Oe.Z)("Mailing List Group")),nz("p",{className:"info"},void 0,(0,Oe.Z)("Group your autogenerated mailing lists. When a match is found, the whole list ID is used to group messages."))),nz("div",{className:"setting-group unlimited"},void 0,nz("div",{className:"setting-single"},void 0,nz("label",{},void 0,this.props.searchableStrings["List ID"],nz("select",{name:"parentFolderType",value:e.parentFolderType,onChange:this.onChangeParentFolder},void 0,nz("option",{value:"endsWith"},void 0,(0,Oe.Z)("Ends with")),nz("option",{value:"startsWith"},void 0,(0,Oe.Z)("Starts with"))),nz("input",{type:"text",onChange:this.updateListId,value:e.listId,disabled:!this.props.isCreating}))),nz(vl,{name:"mailcheckintervalgroup",value:e.isIgnored,onChange:this.isIgnoredChanged,className:"setting-single"},void 0,nz("div",{className:"setting-single"},void 0,nz("label",{},void 0,iz,nz("span",{},void 0,(0,Oe.Z)("Not a Mailing List")))),nz("div",{className:"setting-single"},void 0,nz("label",{},void 0,oz,nz("span",{},void 0,(0,Oe.Z)("A Mailing List"))))),nz("div",{className:"setting-single"},void 0,nz("label",{},void 0,nz("span",{},void 0,(0,Oe.Z)("Folder Name")),nz("input",{type:"text",onChange:this.updateName,disabled:e.isIgnored,value:e.name}))),nz("div",{className:"setting-single"},void 0,nz("label",{},void 0,nz("span",{},void 0,(0,Oe.Z)("Subfolder Grouping")),nz("select",{disabled:e.isIgnored,name:"subFolderType",value:e.subFolderType,onChange:this.onChangeSubfolderType},void 0,nz("option",{value:"none"},void 0,(0,Oe.Z)("mailinglist subfolder","None")),nz("option",{value:"host"},void 0,(0,Oe.Z)("Host")),nz("option",{value:"title"},void 0,(0,Oe.Z)("Title")),nz("option",{value:"senderName"},void 0,(0,Oe.Z)("Sender Name"))))),this.state.updating&&nz(tc,{type:"info"},void 0,(0,Oe.Z)("Updating")))),nz("div",{className:"detail-toolbar"},void 0,!this.props.isCreating&&(0,fs.jsxs)(fs.Fragment,{children:[nz("input",{type:"submit",className:"primary",disabled:!this.hasChanged()||this.state.updating,onClick:this.saveMailingList,value:(0,Oe.Z)("Update Mailing List Group")}),nz("input",{type:"button",disabled:!this.hasChanged(),onClick:this.cancel,value:(0,Oe.Z)("Cancel")})]}),this.props.isCreating&&nz("input",{type:"submit",className:"primary",disabled:this.props.mailingList===this.state.mailingList||this.state.updating,onClick:this.saveMailingList,value:(0,Oe.Z)("Add Mailing List Group")})))}}const rz=az;var lz;function dz(e,t,n,s){lz||(lz="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:lz,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const cz=[$.kMailAccounts,$.kMailIsTurnedOff],hz={"Mailing lists added in the mail panel will appear here.":(0,Oe.Z)("Mailing lists added in the mail panel will appear here.")};var pz=dz("svg",{className:"item-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16"},0,dz("path",{opacity:".35",d:"M0 3h8v1H0zM0 5h3v1H0zM0 7h3v1H0z"}),dz("path",{d:"M15 5H5a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1zm-1 4l-4 2-4-2V7l4 2 4-2z"}));class uz extends hs.PureComponent{constructor(e){super(e),this.state={mailingListGroups:this.getMailingLists()}}componentDidMount(){Cn.Z.addListener(this.mailingListGroupsChanged)}componentWillUnmount(){Cn.Z.removeListener(this.mailingListGroupsChanged)}mailingListGroupsChanged=()=>{const e=this.getMailingLists();this.state.mailingListGroups.length===e.length&&this.state.mailingListGroups.every(((t,n)=>t===e[n]))||this.setState({mailingListGroups:e})};getMailingLists=()=>Cn.Z.getGroups();remapMailingListGroups=e=>{const t=[...e];return t.push({name:"Uncategorized mailing lists",isDefault:!0}),t.map(((e,t)=>{let n=e.name;return e.listId&&n!==e.listId&&(n+=" ("+e.listId+")"),{...e,name:n,key:String(t)}}))};getFavicon=e=>{if(e){const t=e.split("@");if(t&&2===t.length){const e=t[1].split(".");if(e&&e[1]&&e[1].length>1)return dz(Ss,{className:"item-icon",url:`${t[1]}`,loadType:"page"},0)}}return pz};renderListItem=(e,t)=>(0,fs.jsxs)(fs.Fragment,{children:["matches"!==t.parentFolderType&&this.getFavicon(t.listId),dz("div",{className:"item-title"},void 0,e)]});renderContent=(e,t)=>this.state.mailingListGroups.length===e?dz(ez,{filter:this.props.filter}):dz(rz,{searchableStrings:t,mailingList:this.state.mailingListGroups[e]});renderEmpty=e=>dz("div",{className:"detail"},void 0,dz("div",{className:"detail-content"},void 0,dz("p",{},void 0,e["Mailing lists added in the mail panel will appear here."])));renderCreateListItem=()=>dz("div",{className:"item-title"},void 0,(0,Oe.Z)("New Mailing List Group"));renderCreate=e=>dz(rz,{isCreating:!0,searchableStrings:e,mailingList:{name:"",isIgnored:!1,subFolderType:"host",parentFolderType:"endsWith",listId:""}});removeAt=e=>{this.setState((t=>{const n=[...t.mailingListGroups],[s]=n.splice(e,1);return l.Z.removeMailingListGroup(s),{mailingListGroups:n}}))};render(){if(0===this.props.prefValues[$.kMailAccounts].length||this.props.prefValues[$.kMailIsTurnedOff])return null;const e=this.remapMailingListGroups(this.state.mailingListGroups);return dz(xD.Z,{title:(0,Oe.Z)("Mailing Lists"),className:"setting-mailing-lists",deleteTitle:(0,Oe.Z)("Delete List"),addTipString:(0,Oe.Z)("Add Mailing List"),deleteTipString:(0,Oe.Z)("Delete Mailing List"),items:e,onRemove:this.removeAt,masterLayout:1,renderListItem:this.renderListItem,renderContent:this.renderContent,contentStrings:sz,renderCreate:this.renderCreate,renderCreateListItem:this.renderCreateListItem,renderEmpty:this.renderEmpty,emptyStrings:hz,filter:this.props.filter},e.length)}}const gz=sa(uz,cz);var mz;function vz(e,t,n,s){mz||(mz="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:mz,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const fz=[$.kCalendarRelativeDates,$.kMailAccounts,$.kMailAddArchiveFolder,$.kMailAutoGenerateContacts,$.kMailAutoMarkAsRead,$.kMailCheckInterval,$.kMailComposerColors,$.kMailColorQuotedText,$.kMailIsTurnedOff,$.kMailMailtoInVivaldi,$.kMailCountersPanelArchiveEnabled,$.kMailCountersPanelDraftsEnabled,$.kMailCountersPanelJunkEnabled,$.kMailCountersPanelSwitcherEnabled,$.kMailCountersPanelTrashEnabled,$.kMailCountersPanelUnseenEnabled,$.kMailCountersStatusButtonEnabled,$.kMailDefaultAccount,$.kMailDeleteInOtherLocations,$.kMailImapLogsOn,$.kMailIncludeIdentifyingHeaders,$.kMailListButtons,$.kMailMarkDeleteInOtherLocations,$.kMailNotifications,$.kMailNotificationsOnSuccessfullySent,$.kMailNotificationsSoundOn,$.kMailPreferredRendering,$.kMailPanelActivityIndicatorsEnabled,$.kMailPanelShowErrorMessages,$.kMailShowUnsubscribed,$.kMailSingleClickTabs,$.kMailSmtpLogsOn,$.kMailSearchOnEnter,$.kMailSearchFolder,$.kMailViewLayout,$.kMailDisplayMailPanelViewingMail,$.kMailOpenPanelAutomaticallyViewingMail],yz=Ne.Z.getEventHandler;var Cz=vz("input",{type:"radio",value:"horizontal"}),wz=vz("input",{type:"radio",value:"vertical"}),bz=vz("input",{type:"radio",value:"vertical_wide"}),Sz=vz("input",{type:"radio",value:"text_menu"}),Iz=vz("input",{type:"radio",value:"icons_only"}),kz=vz("input",{type:"radio",value:"one_minute"}),Az=vz("input",{type:"radio",value:"fifteen_minutes"}),Tz=vz("input",{type:"radio",value:"manual"}),Zz=vz("input",{type:"radio",value:"prefer_html"}),Ez=vz("input",{type:"radio",value:"plaintext"}),_z=vz("input",{type:"radio",value:xe.Y6}),Mz=vz("input",{type:"radio",value:"black_on_white"}),Nz=vz("input",{type:"radio",value:"inherit_themes"});class Pz extends hs.Component{renderMailAccountRadioGroup=e=>e.map(((e,t)=>vz("div",{className:"setting-single"},"default-account-"+t,vz("label",{},void 0,vz("input",{type:"radio",value:e.MAIL_EMAIL}),vz("span",{},void 0,e.MAIL_EMAIL)))));render(){const e=this.props.prefValues[$.kMailAccounts];return(0,fs.jsxs)(fs.Fragment,{children:[!this.props.prefValues[$.kMailIsTurnedOff]&&(0,fs.jsxs)(fs.Fragment,{children:[vz("section",{className:"setting-section"},void 0,vz(_H,{filter:this.props.filter})),vz(mN,{categoryTitle:(0,Oe.Z)("Mail Settings"),filter:this.props.filter},void 0,vz("div",{className:"setting-group"},void 0,vz("div",{className:"setting-single"},void 0,vz("label",{},void 0,vz("input",{type:"checkbox",checked:this.props.prefValues[$.kMailImapLogsOn],onChange:yz($.kMailImapLogsOn)}),vz("span",{},void 0,(0,Oe.Z)("Turn on IMAP Logs in Console"),vz("p",{className:"info"},void 0,(0,Oe.Z)("Reconnect mail accounts to make this effective. Note that this will degrade performance of the mail client."))))),vz("div",{className:"setting-single"},void 0,vz("label",{},void 0,vz("input",{type:"checkbox",checked:this.props.prefValues[$.kMailSmtpLogsOn],onChange:yz($.kMailSmtpLogsOn)}),vz("span",{},void 0,(0,Oe.Z)("Turn on SMTP Logs in Console"),vz("p",{className:"info"},void 0,(0,Oe.Z)("Turn this on for debugging problems with sending mail. Will take effect immediately. No need to reconnect.")))))),vz("div",{className:"setting-group"},void 0,vz("h3",{},void 0,(0,Oe.Z)("Mail View Layout")),vz(vl,{name:"mailviewgroup",value:this.props.prefValues[$.kMailViewLayout],onChange:yz($.kMailViewLayout)},void 0,vz("div",{className:"setting-single"},void 0,vz("label",{},void 0,Cz,vz("span",{},void 0,(0,Oe.Z)("mail","Horizontal")))),vz("div",{className:"setting-single"},void 0,vz("label",{},void 0,wz,vz("span",{},void 0,(0,Oe.Z)("mail","Vertical")))),vz("div",{className:"setting-single"},void 0,vz("label",{},void 0,bz,vz("span",{},void 0,(0,Oe.Z)("Vertical Wide"))))),vz("div",{className:"setting-single pad-top"},void 0,vz("label",{},void 0,vz("input",{type:"checkbox",checked:this.props.prefValues[$.kCalendarRelativeDates],onChange:yz($.kCalendarRelativeDates)}),vz("span",{},void 0,(0,Oe.Z)("Use Relative Dates"))))),vz("div",{className:"setting-group"},void 0,vz("h3",{},void 0,(0,Oe.Z)("Mail Notifications")),vz("div",{className:"setting-single"},void 0,vz("label",{},void 0,vz("input",{type:"checkbox",checked:this.props.prefValues[$.kMailNotifications],onChange:yz($.kMailNotifications)}),vz("span",{},void 0,(0,Oe.Z)("mail","Enabled")))),vz("div",{className:"setting-single pad-left"},void 0,vz("label",{},void 0,vz("input",{type:"checkbox",checked:this.props.prefValues[$.kMailNotificationsSoundOn],disabled:!this.props.prefValues[$.kMailNotifications],onChange:yz($.kMailNotificationsSoundOn)}),vz("span",{},void 0,(0,Oe.Z)("mail","Play Sound")))),vz("div",{className:"setting-single"},void 0,vz("label",{},void 0,vz("input",{type:"checkbox",checked:this.props.prefValues[$.kMailNotificationsOnSuccessfullySent],disabled:!this.props.prefValues[$.kMailNotifications],onChange:yz($.kMailNotificationsOnSuccessfullySent)}),vz("span",{},void 0,(0,Oe.Z)("Notify on Successfully Sent"))))),vz("div",{className:"setting-group"},void 0,vz("h3",{},void 0,(0,Oe.Z)("Unseen Messages")),vz("p",{className:"info"},void 0,(0,Oe.Z)("Highlight unread messages that have not been seen since the last check.")),vz("div",{className:"setting-single"},void 0,vz("label",{},void 0,vz("input",{type:"checkbox",checked:this.props.prefValues[$.kMailCountersPanelUnseenEnabled],onChange:yz($.kMailCountersPanelUnseenEnabled)}),vz("span",{},void 0,(0,Oe.Z)("Highlight and Count Unseen Messages"))))),vz("div",{className:"setting-group"},void 0,vz("h3",{},void 0,(0,Oe.Z)("Unread Messages")),vz("div",{className:"setting-single"},void 0,vz("label",{},void 0,vz("input",{type:"checkbox",checked:this.props.prefValues[$.kMailAutoMarkAsRead],onChange:yz($.kMailAutoMarkAsRead)}),vz("span",{},void 0,(0,Oe.Z)("Automatically Mark as Read"))))),vz("div",{className:"setting-group"},void 0,vz("h3",{},void 0,(0,Oe.Z)("Filter View Buttons")),vz(vl,{name:"maillistbuttons",value:this.props.prefValues[$.kMailListButtons],onChange:yz($.kMailListButtons)},void 0,vz("div",{className:"setting-single"},void 0,vz("label",{},void 0,Sz,vz("span",{},void 0,(0,Oe.Z)("Text Menu"))),vz("div",{className:"text_menu"===this.props.prefValues[$.kMailListButtons]?"img-setting":"img-setting disabled"},void 0,vz("span",{className:"text_menu"===this.props.prefValues[$.kMailListButtons]?"mail-settings-image image alternate":"mail-settings-image image",dangerouslySetInnerHTML:{__html:Ts.yYJ}}))),vz("div",{className:"setting-single"},void 0,vz("label",{},void 0,Iz,vz("span",{},void 0,(0,Oe.Z)("Icons Only"))),vz("div",{className:"icons_only"===this.props.prefValues[$.kMailListButtons]?"img-setting":"img-setting disabled"},void 0,vz("span",{className:"icons_only"===this.props.prefValues[$.kMailListButtons]?"mail-settings-image image alternate":"mail-settings-image image",dangerouslySetInnerHTML:{__html:Ts.EO4}}))))),vz("div",{className:"setting-group"},void 0,vz("div",{className:"setting-single"},void 0,vz("h3",{},void 0,(0,Oe.Z)("Mail Search")),vz("label",{},void 0,vz("input",{type:"checkbox",checked:this.props.prefValues[$.kMailSearchOnEnter],onChange:yz($.kMailSearchOnEnter)}),vz("span",{},void 0,(0,Oe.Z)("Start Search Using Enter Key")))),vz("div",{className:"setting-single pad-top"},void 0,vz("h3",{},void 0,(0,Oe.Z)("Default Search Folder")),vz("select",{name:"mailsearchfoldergroup",value:this.props.prefValues[$.kMailSearchFolder],onChange:yz($.kMailSearchFolder)},void 0,vz("option",{value:"all"},void 0,(0,Oe.Z)("All Messages")),vz("option",{value:"current"},void 0,(0,Oe.Z)("Current Folder"))))),vz("div",{className:"setting-group"},void 0,vz("h3",{},void 0,(0,Oe.Z)("Mailto Links")),vz("div",{className:"setting-single"},void 0,vz("label",{},void 0,vz("input",{type:"checkbox",checked:this.props.prefValues[$.kMailMailtoInVivaldi],onChange:yz($.kMailMailtoInVivaldi)}),vz("span",{},void 0,(0,Oe.Z)("Handle Mailto Links in Vivaldi Mail"))))),vz("div",{className:"setting-group"},void 0,vz("h3",{},void 0,(0,Oe.Z)("Mail Counters")),vz("div",{className:"setting-single"},void 0,vz("label",{},void 0,vz("input",{type:"checkbox",checked:this.props.prefValues[$.kMailCountersStatusButtonEnabled],onChange:yz($.kMailCountersStatusButtonEnabled)}),vz("span",{},void 0,(0,Oe.Z)("Show on Status Button")))),vz("div",{className:"setting-single"},void 0,vz("label",{},void 0,vz("input",{type:"checkbox",checked:this.props.prefValues[$.kMailCountersPanelSwitcherEnabled],onChange:yz($.kMailCountersPanelSwitcherEnabled)}),vz("span",{},void 0,(0,Oe.Z)("Show on Panel Button")))),vz("div",{className:"setting-single"},void 0,vz("label",{},void 0,vz("input",{type:"checkbox",checked:this.props.prefValues[$.kMailCountersPanelTrashEnabled],onChange:yz($.kMailCountersPanelTrashEnabled)}),vz("span",{},void 0,(0,Oe.Z)("Include Trash Messages")))),vz("div",{className:"setting-single"},void 0,vz("label",{},void 0,vz("input",{type:"checkbox",checked:this.props.prefValues[$.kMailCountersPanelJunkEnabled],onChange:yz($.kMailCountersPanelJunkEnabled)}),vz("span",{},void 0,(0,Oe.Z)("Include Spam Messages")))),vz("div",{className:"setting-single"},void 0,vz("label",{},void 0,vz("input",{type:"checkbox",checked:this.props.prefValues[$.kMailCountersPanelArchiveEnabled],onChange:yz($.kMailCountersPanelArchiveEnabled)}),vz("span",{},void 0,(0,Oe.Z)("Include Archive Messages")))),vz("div",{className:"setting-single"},void 0,vz("label",{},void 0,vz("input",{type:"checkbox",checked:this.props.prefValues[$.kMailCountersPanelDraftsEnabled],onChange:yz($.kMailCountersPanelDraftsEnabled)}),vz("span",{},void 0,(0,Oe.Z)("Include Draft Messages"))))),vz("div",{className:"setting-group"},void 0,vz("h3",{},void 0,(0,Oe.Z)("mail","Panel")),vz("div",{className:"setting-single"},void 0,vz("label",{},void 0,vz("input",{type:"checkbox",checked:this.props.prefValues[$.kMailDisplayMailPanelViewingMail],onChange:yz($.kMailDisplayMailPanelViewingMail)}),vz("span",{},void 0,(0,Oe.Z)("Display Mail Panel when Viewing Mail")))),vz("div",{className:"setting-single pad-left"},void 0,vz("label",{},void 0,vz("input",{type:"checkbox",checked:this.props.prefValues[$.kMailOpenPanelAutomaticallyViewingMail],disabled:!this.props.prefValues[$.kMailDisplayMailPanelViewingMail],onChange:yz($.kMailOpenPanelAutomaticallyViewingMail)}),vz("span",{},void 0,(0,Oe.Z)("Open Panel Automatically")))),vz("div",{className:"setting-single"},void 0,vz("label",{},void 0,vz("input",{type:"checkbox",checked:this.props.prefValues[$.kMailSingleClickTabs],onChange:yz($.kMailSingleClickTabs)}),vz("span",{},void 0,(0,Oe.Z)("Open Mail Tabs with Single Click")))),vz("div",{className:"setting-single"},void 0,vz("label",{},void 0,vz("input",{type:"checkbox",checked:this.props.prefValues[$.kMailPanelActivityIndicatorsEnabled],onChange:yz($.kMailPanelActivityIndicatorsEnabled)}),vz("span",{},void 0,(0,Oe.Z)("Show Activity Indicators"))),vz("p",{className:"info"},void 0,(0,Oe.Z)("Briefly display status next to folders when updating."))),vz("div",{className:"setting-single"},void 0,vz("label",{},void 0,vz("input",{type:"checkbox",checked:this.props.prefValues[$.kMailPanelShowErrorMessages],onChange:yz($.kMailPanelShowErrorMessages)}),vz("span",{},void 0,(0,Oe.Z)("Error Messages"))),vz("p",{className:"info"},void 0,(0,Oe.Z)("Display errors in Mail Panel. They are also accessible via Mail Status Button."))),vz("div",{className:"setting-single"},void 0,vz("label",{},void 0,vz("input",{type:"checkbox",checked:this.props.prefValues[$.kMailShowUnsubscribed],onChange:yz($.kMailShowUnsubscribed)}),vz("span",{},void 0,(0,Oe.Z)("Show Unsubscribed Mailboxes"))))),vz("div",{className:"setting-group"},void 0,vz(F_,{filter:this.props.filter})),vz("div",{className:"setting-group"},void 0,vz("h3",{},void 0,(0,Oe.Z)("Check For New Mail")),vz(vl,{name:"mailcheckintervalgroup",value:this.props.prefValues[$.kMailCheckInterval],onChange:yz($.kMailCheckInterval)},void 0,vz("div",{className:"setting-single"},void 0,vz("label",{},void 0,kz,vz("span",{},void 0,(0,Oe.Z)("Every Minute")))),vz("div",{className:"setting-single"},void 0,vz("label",{},void 0,Az,vz("span",{},void 0,(0,Oe.Z)("Every 15 Minutes")))),vz("div",{className:"setting-single"},void 0,vz("label",{},void 0,Tz,vz("span",{},void 0,(0,Oe.Z)("mail","Manually")))))),vz("div",{className:"setting-group"},void 0,vz("h3",{},void 0,(0,Oe.Z)("Mail Rendering")),vz(vl,{name:"mailpreferredrendering",value:this.props.prefValues[$.kMailPreferredRendering],onChange:yz($.kMailPreferredRendering)},void 0,vz("div",{className:"setting-single"},void 0,vz("label",{},void 0,Zz,vz("span",{},void 0,(0,Oe.Z)("Prefer HTML over Text")))),vz("div",{className:"setting-single"},void 0,vz("label",{},void 0,Ez,vz("span",{},void 0,(0,Oe.Z)("format","Text Only"))))),vz("div",{className:"setting-single"},void 0,vz("label",{},void 0,vz("input",{type:"checkbox",checked:this.props.prefValues[$.kMailColorQuotedText],onChange:yz($.kMailColorQuotedText)}),vz("span",{},void 0,(0,Oe.Z)("Color Quoted Text"))))),e&&vz("div",{className:"setting-group"},void 0,vz("h3",{},void 0,(0,Oe.Z)("Default Sender in New Messages")),vz("p",{className:"info"},void 0,(0,Oe.Z)("Used as fallback if no account is selected")),vz(vl,{name:"maildefaultaccountgroup",value:this.props.prefValues[$.kMailDefaultAccount]||xe.Y6,onChange:yz($.kMailDefaultAccount)},void 0,this.renderMailAccountRadioGroup(e),vz("div",{className:"setting-single"},"default-account-mru",vz("label",{},void 0,_z,vz("span",{},void 0,(0,Oe.Z)("Most Recently Used")))))),vz("div",{className:"setting-group"},void 0,vz("h3",{},void 0,(0,Oe.Z)("Contacts")),vz("div",{className:"setting-single"},void 0,vz("label",{},void 0,vz("input",{type:"checkbox",checked:this.props.prefValues[$.kMailAutoGenerateContacts],onChange:yz($.kMailAutoGenerateContacts)}),vz("span",{},void 0,(0,Oe.Z)("Generate contacts for message recipients"))))),vz("div",{className:"setting-group"},void 0,vz("h3",{},void 0,(0,Oe.Z)("Composer Colors")),vz("p",{className:"info"},void 0,(0,Oe.Z)("Doesn’t affect the color of sent messages")),vz(vl,{name:"mailcomposercolors",value:this.props.prefValues[$.kMailComposerColors],onChange:yz($.kMailComposerColors)},void 0,vz("div",{className:"setting-single"},"composer-background-white",vz("label",{},void 0,Mz,vz("span",{},void 0,(0,Oe.Z)("Black on White")))),vz("div",{className:"setting-single"},"composer-background-theme",vz("label",{},void 0,Nz,vz("span",{},void 0,(0,Oe.Z)("Inherit Theme Colors")))))),vz("div",{className:"setting-group"},void 0,vz("h3",{},void 0,(0,Oe.Z)("Optional Mail Headers")),vz("p",{className:"info"},void 0,(0,Oe.Z)("Mail headers to include when sending messages")),vz("div",{className:"setting-single"},void 0,vz("label",{},void 0,vz("input",{type:"checkbox",checked:this.props.prefValues[$.kMailIncludeIdentifyingHeaders],onChange:yz($.kMailIncludeIdentifyingHeaders)}),vz("span",{},void 0,(0,Oe.Z)("mail","Mail client identification headers"))))),vz("div",{className:"setting-group"},void 0,vz("div",{className:"setting-single"},void 0,vz("h3",{},void 0,(0,Oe.Z)("Delete Duplicate Messages")),vz("select",{value:this.props.prefValues[$.kMailMarkDeleteInOtherLocations],onChange:yz($.kMailMarkDeleteInOtherLocations)},void 0,vz("option",{value:"ask"},void 0,(0,Oe.Z)("Ask")),vz("option",{value:"folders"},void 0,(0,Oe.Z)("From All Folders on Current Account")),vz("option",{value:"accounts"},void 0,(0,Oe.Z)("From All Accounts and Folders")))),vz("div",{className:"setting-single pad-top"},void 0,vz("h3",{},void 0,(0,Oe.Z)("Permanently Delete Duplicate Messages")),vz("select",{value:this.props.prefValues[$.kMailDeleteInOtherLocations],onChange:yz($.kMailDeleteInOtherLocations)},void 0,vz("option",{value:"ask"},void 0,(0,Oe.Z)("Ask")),vz("option",{value:"selected"},void 0,(0,Oe.Z)("From the Current Folder Only")),vz("option",{value:"folders"},void 0,(0,Oe.Z)("From All Folders on Current Account")),vz("option",{value:"accounts"},void 0,(0,Oe.Z)("From All Accounts and Folders"))))),vz("div",{className:"setting-group"},void 0,vz("h3",{},void 0,(0,Oe.Z)("Archive Actions")),vz("div",{className:"setting-single"},"add-archive-folder",vz("label",{},void 0,vz("input",{type:"checkbox",checked:this.props.prefValues[$.kMailAddArchiveFolder],onChange:yz($.kMailAddArchiveFolder)}),vz("span",{},void 0,(0,Oe.Z)("Add Archive Folder if Missing")))))),vz("section",{className:"setting-section"},void 0,vz(gz,{filter:this.props.filter})),vz("section",{className:"setting-section"},void 0,vz(jH,{windowId:this.context.vivaldiWindowId,filter:this.props.filter}))]}),vz(QP,{categoryTitle:(0,Oe.Z)("Mail"),filter:this.props.filter,inform:!0})]})}}const Dz=sa(Pz,fz);var xz=n(63305);const Oz="vivaldi/x-commanditem",Lz="vivaldi/x-commandfolder",Rz="vivaldi/x-commandmixed",Bz="vivaldi/x-menuitem",Fz="vivaldi/x-menudefaulttopfolder",Vz="vivaldi/x-menufolder",Wz="vivaldi/x-menumixed",Uz="vivaldi/x-bookmarkcontainer";function Hz(e){return(0,tu.$)(e)}var zz;function Gz(e,t,n,s){zz||(zz="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:zz,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var $z=Gz("hr",{className:"separator-left"}),Kz=Gz("hr",{className:"separator-right"});class jz extends hs.Component{static contextType=xi.Z;refTreeList=hs.createRef();_searchKey="";_appendToSearch=!1;_isIMEOpen=!1;constructor(e,t){super(e),this.state={commandItems:[],searchFilter:"",darkBackground:z.Z.hasDarkBackground(t.vivaldiWindowId)}}componentDidMount(){this._isMounted=!0,this._initialSetup(),J.Z.addListener(this._onCommandStoreChanged),z.Z.addListener(this._onThemeStoreChanged)}_initialSetup=(0,no.Z)((async(e="")=>{if(!this._isMounted)return!1;const{commandItems:t,searchFilter:n}=await this._getStateWithSearchFilter(e);this.setState({commandItems:t,searchFilter:n})}),200);componentWillUnmount(){this._isMounted=!1,clearTimeout(this._timeout),J.Z.removeListener(this._onCommandStoreChanged),z.Z.removeListener(this._onThemeStoreChanged)}componentDidUpdate(e,t){0===t.commandItems?.length&&this.state.commandItems.length>0&&this.refTreeList.current?.selectByNode(this.state.commandItems[0]),this.props.menu!==e.menu&&this._initialSetup(this.state.searchFilter)}_onCommandStoreChanged=e=>{if("menu"===e){const e=this.state.searchFilter;this._initialSetup(e)}};_onThemeStoreChanged=()=>{this.setState({darkBackground:z.Z.hasDarkBackground(this.context.vivaldiWindowId)})};_getStateWithSearchFilter=async e=>{const t="contextfolder",n="chainfolder",s="appfolder",i="mailfolder",o="calendarfolder",a=e=>e.sort(((e,t)=>{if("container"===e.type&&"container"===t.type){const n=e.settingsLabel||"",s=t.settingsLabel||"";return n<s?-1:n>s?1:0}return"container"===e.type&&"container"!==t.type?"separator"===t.type?1:-1:"container"!==e.type&&"container"===t.type?"separator"===e.type?-1:1:"separator"===e.type||"separator"===t.type||e.label<t.label?-1:e.label>t.label?1:0})),r=(e,t)=>({parentId:e,id:t.id||"",type:t.type,label:t.settingsLabel||t.label,action:"",iconPNG:t.iconPNG||"",iconPNGWhite:t.iconPNGWhite||"",shortcuts:t.shortcuts}),l=e=>a(J.Z.makeCommandList(this.context.vivaldiWindowId).filter((t=>{if(void 0===t.id||t.id.startsWith("COMMAND_MAIL")||t.id.startsWith("COMMAND_CALENDAR"))return!1;return-1!==(t.settingsLabel||t.label||"").toLowerCase().indexOf(e)}))),d=e=>a(J.Z.makeCommandList(this.context.vivaldiWindowId).filter((t=>{if(void 0===t.id||!t.id.startsWith("COMMAND_MAIL"))return!1;return-1!==(t.settingsLabel||t.label||"").toLowerCase().indexOf(e)}))),c=e=>a(J.Z.makeCommandList(this.context.vivaldiWindowId).filter((t=>{if(void 0===t.id||!t.id.startsWith("COMMAND_CALENDAR"))return!1;return-1!==(t.settingsLabel||t.label||"").toLowerCase().indexOf(e)}))),h=(e,t)=>a(Pi.makeCommandList(this.context.vivaldiWindowId,e).filter((e=>{const n=e.settingsLabel||e.label;return void 0===n?(console.warn("Action ignored for command list",e.commandName),!1):-1!==n.toLowerCase().indexOf(t)}))),p=async e=>{const t=d(e).map((e=>r(s,e))),h=c(e).map((e=>r(s,e))),p=[{id:i,parentId:s,type:"folder",label:(0,Oe.Z)("Mail Commands"),action:"",iconPNG:"",iconPNGWhite:"",children:t},{id:o,parentId:s,type:"folder",label:(0,Oe.Z)("Calendar Commands"),action:"",iconPNG:"",iconPNGWhite:"",children:h}].sort(((e,t)=>e.label<t.label?-1:e.label>t.label?1:0)).concat(l(e).map((e=>r(s,e)))),u=await(async e=>{const t=await J.Z.getChainCommandsShortcuts();return a(H.Z.get($.kChainedCommandsCommandList).map((e=>{const n=t.find((t=>t.name===e.name));return{type:"command",action:e.name,id:e.name,...ae.Z.makeLabelPair(e.label),shortcuts:n?.shortcuts}})).filter((t=>-1!==(t.label||"").toLowerCase().indexOf(e))))})(e).then((e=>e.map((e=>r(n,e)))));return[{id:s,parentId:"",type:"folder",label:(0,Oe.Z)("Application Commands"),action:"",iconPNG:"",iconPNGWhite:"",children:p},{id:n,parentId:"",type:"folder",label:(0,Oe.Z)("Command Chains"),action:"",iconPNG:"",iconPNGWhite:"",children:u}]};let u=[];if(!Pi.isSection(this.props.menu)){const s=e.toLowerCase();u=Pi.getKeys().includes(this.props.menu)?await(async(e,s)=>p(s).then((i=>{const o=h(e,s).map((e=>r(n,e)));return[{id:t,parentId:"",type:"folder",label:(0,Oe.Z)("Context Commands"),action:"",iconPNG:"",iconPNGWhite:"",children:o}].concat(i)})))(this.props.menu,s):await p(s);const i={parentId:"",id:"separator",type:"separator",action:"",iconPNG:"",iconPNGWhite:"",label:""};u.splice(0,0,i);const o=J.Z.makeCommandList(this.context.vivaldiWindowId,J.Z.getOpenLinkName());o&&1===o.length&&o[0].id&&u.splice(0,0,r("",o[0]))}return{searchFilter:e,commandItems:u,darkBackground:this.state.darkBackground}};_hasChildren=e=>Boolean(e.children?.length);_isFolder=e=>Boolean(e.children);_isSeparator=e=>"separator"===e.type;_isValidDragSource=e=>!this._isFolder(e);_validateForDrag=xz.Z;_getDragData=(e,t)=>"";_getNodeById=e=>{const t=n=>{if(n)for(let s=0;s<n.length;s++){const i=n[s];if(i.id===e)return i;if(i.children){const e=t(i.children);if(e)return e}}};return t(this.state.commandItems)};_getMimeData=e=>{let t="";const n=[];return e.forEach((e=>{const s=this._getNodeById(e);if(s&&void 0!==s.type){t="folder"===s.type?""===t||t===Lz?Lz:Rz:""===t||t===Oz?Oz:Rz;const e={id:"",type:s.type,action:s.id};"folder"===s.type&&(e.title=s.label);const i=J.Z.getCommandParameter(e.action);if(i&&(e.parameter=i),J.Z.getOpenLinkName()===e.action){const t=J.Z.getCommandLabel(e.action);t&&(e.title=t)}const o={menu:"contextfolder"===s.parentId?this.props.menu:"",node:e};n.push(o)}})),{mimeType:t,payload:JSON.stringify(n)}};_setDragData=(e,t)=>{const n=this._getMimeData(t);e.setData(n.mimeType,n.payload)};_copy=(e,t)=>{const n=e.clipboardData;if(n){const e=t.filter(this._isValidForClipboard).map((e=>e.id)),s=this._getMimeData(e);n.setData(s.mimeType,s.payload)}(0,to.ZP)(e)};_onKeyDown=e=>{const t=(e,t,n)=>{for(let s=t;s<n.length;s++){const t=n[s];if(t.label&&t.label.toUpperCase().startsWith(e))return t}};switch(e.key){case"ArrowUp":case"ArrowDown":case"PageUp":case"PageDown":break;default:const{ctrlKey:n,altKey:s,shiftKey:i,metaKey:o}=e,a={ctrlKey:n,altKey:s,shiftKey:i,metaKey:o};if((0,co.VV)(a)){const n=this.refTreeList.current?.getSelectedItem(),s=n?this._getNodeById(n.parentId):void 0,i=s?s.children||[]:this.state.commandItems,o=(n?i.findIndex((e=>e.id===n.id)):-1)+1,a=this._searchKey.length;if("ArrowLeft"===e.key||"ArrowRight"===e.key){if(0===a)break}else if(this._appendToSearch&&!1===e.repeat){const t=e.key.toUpperCase();1===a&&this._searchKey[0]===t||(this._searchKey+=t)}else this._searchKey=e.key.toUpperCase();let r=t(this._searchKey,o,i);r||0===o||(r=t(this._searchKey,0,i)),r&&(this.refTreeList.current?.selectByNode(r),e.preventDefault()),clearTimeout(this._timeout),this._appendToSearch=!0,this._timeout=setTimeout((()=>{this._appendToSearch=!1}),400)}}};_onSearchFilterChange=async e=>{if(this._isIMEOpen)this.setState({searchFilter:e.target.value});else{const t=await this._getStateWithSearchFilter(e.target.value);this.setState(t)}};_handleExpandClick=(e,t)=>{const n=e.altKey;this.refTreeList.current?.toggleSelectedExpansion(t,n)};_getContextMenuItems=e=>e?[{isVisible:()=>{const e=this.refTreeList.current?.getAllSelectedItems().filter((e=>this._isValidForClipboard(e))).map((e=>e.id));return Boolean(e&&e.length>0&&this.props.canAddToTree())},handler:()=>{const e=this.refTreeList.current?.getAllSelectedItems().filter((e=>this._isValidForClipboard(e))).map((e=>e.id));if(e){const t=this._getMimeData(e);this.props.addToTree(t.mimeType,t.payload)}},...(0,xs.Z)("Add to Content")}]:[];_getContextMenuItemProps=e=>({showCopy:this._isValidForClipboard(e)});_isValidForClipboard=e=>!this._isFolder(e);rowComponent=e=>{const t=e.node,n=e.level,s=n*mo+"px",i=(n+1)*mo+"px";if(this._isSeparator(t))return Gz("label",{style:{marginLeft:i}},"0",$z,(0,Oe.Z)("Menu Separator"),Kz);let o=t.label;t.ellipsis&&(o+=ae.Z.ellipsisString()),"container"===t.type&&t.settingsLabel&&(o=t.settingsLabel);const a=this._isFolder(t)&&this._hasChildren(t);let r=H.Z.get($.kKeyboardShortcutsEnable);t.shortcuts?.length>0&&1===t.shortcuts[0].length&&r&&(r=ae.Z.hasBrowserFeature(t)?H.Z.get($.kKeyboardShortcutsEnableSingleKey):H.Z.get($.kKeyboardShortcutsEnableSingleKeyForMail));const l=this.state.darkBackground?t.iconPNGWhite:t.iconPNG;return Gz("label",{style:a?null:{marginLeft:i}},"0",a&&Gz("span",{className:"expand-icon",style:{marginLeft:s},onMouseDown:to.ZP,onMouseUp:e=>this._handleExpandClick(e,t.id),dangerouslySetInnerHTML:{__html:Ts.nfH}}),l&&Gz("img",{src:"data:image/png; base64, "+l}),Gz("span",{className:"title"},void 0,o),t.shortcuts&&t.shortcuts.length>0&&Gz("span",{className:"nickname"},void 0,Hz(t.shortcuts[0])))};render(){return(0,fs.jsxs)(fs.Fragment,{children:[(0,fs.jsx)(yo,{ref:this.refTreeList,rowComponent:this.rowComponent,nodes:this.state.commandItems,enableDragAndDrop:!0,validateForDrag:this._validateForDrag,isValidDragSource:this._isValidDragSource,getDragData:this._getDragData,setCustomDragData:this._setDragData,hasChildren:this._hasChildren,isFolder:this._isFolder,onCopy:this._copy,getContextMenuItems:this._getContextMenuItems,getContextMenuItemProps:this._getContextMenuItemProps,onKeyDown:this._onKeyDown}),Gz("div",{className:"setting-single"},void 0,Gz("input",{type:"search",className:"menu-search",value:this.state.searchFilter,placeholder:(0,Oe.Z)("Filter Commands"),onCompositionStart:()=>this._isIMEOpen=!0,onCompositionEnd:e=>{this._isIMEOpen=!1,this._onSearchFilterChange(e)},onChange:this._onSearchFilterChange}))]})}}const Yz=jz;var Xz,Qz=n(34155);function qz(e,t,n,s){Xz||(Xz="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Xz,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Jz="MenuCutIds";class eG extends hs.Component{refTreeList=hs.createRef();static contextType=xi.Z;winId=-1;_isMounted=!1;_isMac=!1;_editHasFocus=!1;_id=crypto.randomUUID();_pageContext={};constructor(e,t){super(e),this.winId=t.vivaldiWindowId,this.state={rootId:"",role:void 0,menuItems:[],editId:"",editTitle:"",editUrl:"",url:"",cutIds:[],darkBackground:z.Z.hasDarkBackground(t.vivaldiWindowId)}}componentDidMount(){this._isMounted=!0,C.Z.menuContent.onChanged.addListener(this._onMenuChanged),C.Z.utilities.onSharedDataUpdated.addListener(this._onSharedDataChanged),z.Z.addListener(this._onThemeStoreChanged),yy.addListener(this._onUrlFieldStoreChanged,(e=>e.get(this._id))),this._loadMenu()}componentWillUnmount(){this._isMounted=!1,C.Z.menuContent.onChanged.removeListener(this._onMenuChanged),C.Z.utilities.onSharedDataUpdated.removeListener(this._onSharedDataChanged),z.Z.removeListener(this._onThemeStoreChanged),yy.removeListener(this._onUrlFieldStoreChanged)}componentDidUpdate(e,t){this.props.menu!==e.menu&&(this._cancelEdit(),this._loadMenu())}_onThemeStoreChanged=()=>{this.setState({darkBackground:z.Z.hasDarkBackground(this.context.vivaldiWindowId)})};_onUrlFieldStoreChanged=()=>{const{typedUrl:e}=yy.getUrlfieldState(this._id);this.setState({editUrl:e})};getSelectedItem=()=>this.refTreeList.current?.getSelectedItem();_onMenuChanged=(e,t,n,s,i)=>{e===this.props.menu&&this._setMenu(e,t,n,s,i,!1)};_loadMenu=()=>{const e=this.props.menu;Pi.isSection(e)?this._isMounted&&this.setState({rootId:"",role:void 0,menuItems:[]}):C.Z.menuContent.get(e,((t,n,i)=>{s.Z.runtime.lastError?(this.setState({rootId:"",role:void 0,menuItems:[]}),console.warn("Failed to read menu spec. Attempting fallback for menu key:",e),C.Z.menuContent.reset(e,Pi.hasName(e),void 0,Aa.Z)):this._setMenu(e,t,n,"",i,!0)}))};_setMenu=(e,t,n,s,i,o)=>{const a=(e,t,n)=>{const s={...e,index:n,parentId:t},i=e.id;return e.items&&void 0!==i&&(s.children=e.items.map(((e,t)=>a(e,i,t)))),s};((e,t,n)=>{const s={expandContainers:!1,inSettings:!0,updateCallbacks:!1};return"context"===t?Pi.makeMenuWithContent(this.winId,e,n,s):Promise.resolve(J.Z.makeMenuWithContent(this.winId,n,s))})(e,n,i).then((e=>{const i=e.map(((e,n)=>a(e,t,n)));this._isMounted&&this.setState({rootId:t,role:n,menuItems:i},(()=>{if(o&&this.state.menuItems.length>0)this.refTreeList.current?.selectByNode(this.state.menuItems[0]);else{const e=this._getNodeById(s);e&&this.refTreeList.current?.selectByNode(e)}}))}))};_getNodeById=e=>{const t=n=>{if(n)for(let s=0;s<n.length;s++){const i=n[s];if(i.id===e)return i;if(i.children){const e=t(i.children);if(e)return e}}};return t(this.state.menuItems)};_hasChildren=e=>Boolean(e.children)&&e.children.length>0;_isFolder=e=>Boolean(e.children);_isContainer=e=>"container"===e.type;_isBookmarkContainer=e=>"CONTAINER_BOOKMARK"===e.container?.content;_isSeparator=e=>"separator"===e.type;_isLink=e=>e.commandName===J.Z.getOpenLinkName();_isDefaultTopFolder=e=>!this._isContextMenu()&&(!!this._isMac&&["MENU_APPLE_APP","MENU_FILE","MENU_EDIT","MENU_VIEW","MENU_BOOKMARKS","MENU_WINDOW","MENU_HELP"].includes(e.commandName));_isPersistent=e=>!this._isContextMenu()&&(!!this._isMac&&["MENU_APPLE_APP","MENU_BOOKMARKS","MENU_WINDOW","MENU_HELP"].includes(e.commandName));_canDeleteNode=e=>!!this._isContextMenu()||(!this._isMac||!this._isPersistent(e)&&!this._isBookmarkContainer(e));_isValidForClipboard=e=>this._isValidDragSource(e);_isValidDragSource=e=>!!this._isContextMenu()||(!this._isMac||!["MENU_APPLE_APP"].includes(e.commandName));_validateForDrag=e=>e.map(this._getNodeById).filter(Boolean).filter(this._isValidDragSource).map((e=>e.id));_validateForDeletion=e=>e.map(this._getNodeById).filter(Boolean).filter(this._canDeleteNode).map((e=>e.id));_validateForRename=e=>{const t=this._getNodeById(e);return!!t&&(!this._isSeparator(t)&&!1!==t.settingsRename)};_validateForEdit=e=>{const t=this._getNodeById(e);return!!t&&this._isLink(t)};_reset=e=>{C.Z.menuContent.reset(this.props.menu,Pi.hasName(this.props.menu),[e],Aa.Z)};_setContainerMode=(e,t)=>{C.Z.menuContent.update(this.props.menu,e,{containerMode:t},Aa.Z)};_setShowShorcut=(e,t)=>{C.Z.menuContent.update(this.props.menu,e,{showshortcut:t},Aa.Z)};_setContainerEdge=(e,t)=>{C.Z.menuContent.update(this.props.menu,e,{containerEdge:t},Aa.Z)};_onEdit=()=>{const e=this.getSelectedItem();if(e){const t=e.url||"https://www.vivaldi.com";py.Z.updateState(this._id,{typedUrl:t,autocompleteValue:""}),this.setState({editId:e.id,editTitle:e.label,url:t})}};_onTitleChanged=e=>{const t=e.target.value;this.setState({editTitle:t})};_onEditFocus=()=>{this._editHasFocus=!0};_onEditBlur=()=>{this._editHasFocus=!1,Qz.nextTick((()=>{this._saveEdit(!this._editHasFocus,!1)}))};_cancelEdit=()=>{this.setState({editId:"",editTitle:"",editUrl:""})};_saveEdit=(e,t)=>{const n=this.state.editId,{autocompleteValue:s}=yy.getUrlfieldState(this._id);let i=(s||this.state.editUrl||this.state.url||"").trim();void 0===C.Z.utilities.getUrlFragments(i).scheme&&(i="http://"+i),C.Z.menuContent.update(this.props.menu,n,{title:this.state.editTitle,parameter:i},(()=>{e&&this.setState({editId:"",editTitle:"",editUrl:""},(()=>{const e=this._getNodeById(n);e&&(t&&this.refTreeList.current?.focusTree(),this.refTreeList.current?.expandToId(n),this.refTreeList.current?.selectByNode(e))}))}))};_handleEditKeyPress=e=>{"Escape"===e.key&&(e.preventDefault(),this._cancelEdit()),"Enter"===e.key&&(e.preventDefault(),this._saveEdit(!0,!0))};_getTitle=e=>{const t=this._getNodeById(e);if(t){let e=t.label;return t.ellipsis&&(e+=ae.Z.ellipsisString()),e}return""};_saveTitle=(e,t)=>{C.Z.menuContent.update(this.props.menu,e,{title:t},Aa.Z)};_isMenubarMenu=()=>"mac"===this.state.role||"horizontal"===this.state.role;_isContextMenu=()=>"context"===this.state.role;_getDragData=(e,t)=>"";_getMimeData=e=>{let t="",n=!1,s=!1;e.forEach((e=>{const i=this._getNodeById(e);i&&(this._isFolder(i)?(this._isDefaultTopFolder(i)&&(n=!0),t=""===t||t===Vz?Vz:Wz):(this._isBookmarkContainer(i)&&(s=!0),t=""===t||t===Bz?Bz:Wz))}));const i=[];return i.push({mimeType:t,payload:JSON.stringify(e)}),n&&i.push({mimeType:Fz,payload:JSON.stringify(e)}),s&&i.push({mimeType:Uz,payload:JSON.stringify(e)}),i};_setDragData=(e,t)=>{this._getMimeData(t).forEach((t=>{e.setData(t.mimeType,t.payload)}))};_getDropSupport=(e,t)=>{const n={available:!1,onto:!1,edge:"none"};return n.available=t.dataTransfer.types.some((e=>e===Bz||e===Vz||e===Wz||e===Oz||e===Lz||e===Rz)),n.available&&(n.onto=this._canDropOnto(e,t),n.edge=this._canDropOnEdge(e,t)?"both":"none"),n};_canDropOnto=(e,t)=>{if(this._isFolder(e)){if(this._isMac){if(t.dataTransfer.types.some((e=>e===Uz)))return!1;if(t.dataTransfer.types.some((e=>e===Vz))&&t.dataTransfer.types.some((e=>e===Fz)))return!1}return!0}return!1};_canDropOnEdge=(e,t)=>e.parentId!==this.state.rootId||!this._isMenubarMenu()||(!this._isMac||0!==e.index)&&t.dataTransfer.types.some((e=>e===Vz||e===Wz||e===Lz||e===Rz));_getTargetSpec=(e,t)=>{const n={id:e.id,index:0,parentId:""};return this._isFolder(e)&&"on"===t?n.parentId=e.id:(n.parentId=e.parentId,n.index=e.index+("below"===t?1:0)),n};_canAddToTopLevel=e=>{let t=!0;return this._isMenubarMenu()&&e.forEach((e=>{"folder"!==e.type&&(t=!1)})),t};_handleMimeData=(e,t,n,s,i)=>{const o={type:""};if(this._hasCommandMimeType(s,o)){const n=JSON.parse(i(o.type)).map((e=>{if(!e.menu||e.menu===this.props.menu)return e.node})).filter(Boolean);return this._add(e,t,n,!0).then((()=>Promise.resolve([])))}if(this._hasMenuMimeType(s,o)){const s=i(o.type),a=JSON.parse(s);if(n){const n=[];return this._getContentTree(n,a),this._add(e,t,n,!1).then((()=>Promise.resolve([])))}return this._onMove(a,{parentId:e,index:t,pageIndex:void 0}).then((e=>{if(e&&e.length>0){const t=e[0];this.refTreeList.current?.expandToId(t),this.refTreeList.current?.setSelectedIds(e),this._setCutIds([])}return Promise.resolve([])}))}return Promise.resolve([])};_onDrop=(e,t,n)=>{const s="on"===n?t.id:t.parentId,i="on"===n?0:t.index+("below"===n?1:0),o=Ds.ZP.isCopyModifierPressed(e);return this._handleMimeData(s,i,o,e.dataTransfer.types,(t=>e.dataTransfer.getData(t)))};addToNode=(e,t,n)=>{const s=this._isFolder(e)?e.id:e.parentId,i=this._isFolder(e)?0:e.index+1,o=JSON.parse(t).map((e=>{if(!e.menu||e.menu===this.props.menu)return e.node})).filter(Boolean);return this._add(s,i,o,n)};_add=(e,t,n,s,i)=>this._addAtPosition(e,t,n,s).then((e=>{e?.length>0&&(this.refTreeList.current?.expandToId(e[0]),this.refTreeList.current?.setSelectedIds(e))}));_addAtPosition=(e,t,n,s)=>{const i=(e,t,n)=>Promise.all(e.map((e=>new Promise((s=>{C.Z.menuContent.create(this.props.menu,t,n++,[e],((t,n)=>{e.children?i(e.children,n[0],0).then((()=>{s(n[0])})):s(n[0])}))}))))),o=s&&1===n.length&&n[0].action===J.Z.getOpenLinkName();return i(n,e,t).then((e=>(o&&Qz.nextTick(this._onEdit),e)))};_supportsUpDownMove=(e,t)=>!!this._isValidDragSource(e)&&!(e.parentId===this.state.rootId&&t&&e.index<1);_onMove=(e,t)=>{const{parentId:n="",index:s=0}=t;return new Promise((t=>{C.Z.menuContent.move(this.props.menu,e,n,s,(n=>{t(e)}))}))};_onKeyPressed=e=>{"Escape"===e.key&&this._setCutIds([])};_setCutIds=e=>{C.Z.utilities.setSharedData({key:Jz,value:e.length>0?e.join():""})};_onSharedDataChanged=(e,t)=>{if(e===Jz){const e=t.length>0?t.split(","):[];e.length>0?this.context.addEventListener("keydown",this._onKeyPressed,!0):this.context.removeEventListener("keydown",this._onKeyPressed,!0),this.setState({cutIds:e})}};_cut=(e,t)=>{const n=t.filter(this._isValidForClipboard).map((e=>e.id));this._setCutIds(n);const s=e.clipboardData;if(s){s.setData("vivaldi/x-cut","true");this._getMimeData(n).forEach((e=>{s.setData(e.mimeType,e.payload)}))}(0,to.ZP)(e)};_copy=(e,t)=>{const n=e.clipboardData;if(n){const e=t.filter(this._isValidForClipboard).map((e=>e.id));this._getMimeData(e).forEach((e=>{n.setData(e.mimeType,e.payload)}))}(0,to.ZP)(e)};_getContentTree=(e,t)=>{t.forEach((t=>{const n=this._getNodeById(t);if(n){const t={id:"",action:n.commandName||"",type:n.type};if(t.action===J.Z.getOpenLinkName()&&(t.parameter=n.url,t.title=n.label),"folder"===t.type&&(t.title=n.label,t.children=[],n.children)){const e=n.children.map((e=>e.id)),s=[];this._getContentTree(s,e),t.children=s}e.push(t)}}))};_hasCommandMimeType=(e,t)=>{for(let n=0;n<e.length;n++){const s=e[n];switch(s){case Oz:case Lz:case Rz:return t.type=s,!0}}return t.type="",!1};_hasMenuMimeType=(e,t)=>{for(let n=0;n<e.length;n++){const s=e[n];switch(s){case Bz:case Vz:case Wz:return t.type=s,!0}}return t.type="",!1};_paste=(e,t)=>{const n=e.clipboardData;if(!n)return Promise.resolve([]);const s="true"===n.getData("vivaldi/x-cut");if(s&&0===this.state.cutIds.length)return Promise.resolve([]);const i=this._isFolder(t)?t.id:t.parentId,o=this._isFolder(t)?0:t.index+1;return this._handleMimeData(i,o,!s,n.types,(e=>n.getData(e))).then((e=>(s&&this._setCutIds([]),e)))};_onCreate=(e,t,n,s)=>s?new Promise((s=>{const i=[];let o=!1,a=!1;e.forEach(((e,t)=>{if(e.children)o=0===t,i.push({id:"",type:"folder",action:"",title:(0,Oe.Z)("command","New Folder")});else if(e.separator)i.push({id:"",type:"separator",action:""});else{a=0===t;const e=J.Z.getOpenLinkName();i.push({id:"",type:"command",action:e,title:J.Z.getCommandLabel(e)||"",parameter:J.Z.getCommandParameter(e)||""})}})),C.Z.menuContent.create(this.props.menu,t||"",n??-1,i,((e,t)=>{a&&Qz.nextTick(this._onEdit);const n={items:t.map((e=>({id:e}))),props:{edit:o}};s(n)}))})):Promise.resolve({items:[]});_onRemove=e=>new Promise((t=>{C.Z.menuContent.remove(this.props.menu,e,(e=>{t(e)}))}));_handleExpandClick=(e,t)=>{const n=e.altKey;this.refTreeList.current?.toggleSelectedExpansion(t,n)};_getContextMenuItemProps=e=>Pi.isSection(this.props.menu)?{}:e?{showMoveUp:this.refTreeList.current?.canMoveUpDown(e,!0)??!1,showMoveDown:this.refTreeList.current?.canMoveUpDown(e,!1)??!1,showRename:this._validateForRename(e.id),showEdit:this._validateForEdit(e.id),showDelete:this._canDeleteNode(e),showNewItem:!0,showNewSeparator:!0,showNewFolder:!0,showCut:this._canDeleteNode(e),showCopy:!0,showPaste:!0}:{showNewSeparator:!this._isMenubarMenu(),showNewFolder:!0,showPaste:!0};_getContextMenuNewItemString=()=>(0,xs.Z)("New Link");_getNodeMenuItems=e=>[{handler:()=>this._reset(e.id),isVisible:()=>this._isFolder(e)&&!e.custom,...(0,xs.Z)("Restore Default Folder")},{isVisible:()=>this._isContainer(e)&&!this._isBookmarkContainer(e),...(0,xs.Z)("Show as Subfolder"),type:"checkbox",checked:"folder"===e.container?.mode,handler:()=>this._setContainerMode(e.id,"folder"===e.container?.mode?"inline":"folder")},{isVisible:()=>this._isBookmarkContainer(e),...(0,xs.Z)("Show 'Add Active Tab'"),items:[{type:"radio",checked:"above"===e.container?.edge,radiogroup:2,handler:this._setContainerEdge.bind(this,e.id,"above"),...(0,xs.Z)("Above List")},{type:"radio",checked:"below"===e.container?.edge,radiogroup:2,handler:this._setContainerEdge.bind(this,e.id,"below"),...(0,xs.Z)("Below List")},{type:"separator",label:"",labelEnglish:""},{type:"radio",checked:"off"===e.container?.edge,handler:this._setContainerEdge.bind(this,e.id,"off"),radiogroup:2,...(0,xs.Z)("radio","Hide")}]},{isVisible:()=>!0,...(0,xs.Z)("Show Shortcuts in Menu"),type:"checkbox",isEnabled:()=>H.Z.get($.kKeyboardShortcutsEnable),checked:!1!==e.showshortcut,handler:()=>this._setShowShorcut(e.id,!(!1!==e.showshortcut))}];_getContextMenuItems=e=>e?this._getNodeMenuItems(e):[];rowComponent=e=>{const{inlineEditText:t,node:n,onBlur:s,onChange:i,onFocus:o,level:a}=e,r=a*mo+"px",l=(a+1)*mo+"px";if(this._isSeparator(n))return qz("label",{},"0",qz("hr",{style:{marginLeft:l},className:"separator"}));let d=n.label;n.ellipsis&&(d+=ae.Z.ellipsisString()),"container"===n.type&&(n.settingsLabel?d="inline"===n.container?.mode||this._isBookmarkContainer(n)?n.settingsLabel:(0,Oe.Z)("$1 (as Subfolder)",[n.settingsLabel]):"folder"===n.container?.mode&&(d=(0,Oe.Z)("$1 (as Subfolder)",[d])));const c=this._isFolder(n)&&this._hasChildren(n);let h=H.Z.get($.kKeyboardShortcutsEnable);n.shortcuts?.length>0&&1===n.shortcuts[0].length&&h&&(h=ae.Z.hasBrowserFeature(n)?H.Z.get($.kKeyboardShortcutsEnableSingleKey):H.Z.get($.kKeyboardShortcutsEnableSingleKeyForMail));const p=!1!==n.showshortcut,u=this._isMenubarMenu()&&this._isMac?void 0:this.state.darkBackground?n.iconPNGWhite:n.iconPNG;return qz("label",{style:c?null:{marginLeft:l}},"0",c&&qz("span",{className:"expand-icon",style:{marginLeft:r},onMouseDown:to.ZP,onMouseUp:e=>this._handleExpandClick(e,n.id),dangerouslySetInnerHTML:{__html:Ts.nfH}}),void 0!==t&&qz("input",{type:"text",value:t,onChange:i,onFocus:o,onBlur:s,autoFocus:!0}),u&&qz("img",{src:"data:image/png; base64, "+u}),void 0===t&&qz("span",{className:"title"},void 0,d),n.shortcuts?.length>0&&!p&&h&&qz("span",{style:{textDecoration:"line-through"},className:"nickname"},void 0,Hz(n.shortcuts[0])),n.shortcuts?.length>0&&p&&h&&qz("span",{className:"nickname"},void 0,Hz(n.shortcuts[0])))};render(){return this.state?this.state.editId?qz("div",{onKeyDown:this._handleEditKeyPress},void 0,qz("div",{className:"UrlField"},void 0,qz("input",{type:"text",placeholder:(0,Oe.Z)("Title"),value:this.state.editTitle,onChange:this._onTitleChanged,onBlur:this._onEditBlur,onFocus:this._onEditFocus})),qz(pw,{placeholder:(0,Oe.Z)("Address"),title:(0,Oe.Z)("Enter webpage address"),pageId:this._id,pageContext:this._pageContext,autocompletionEnabled:!0,typedHistoryEnabled:!1,autoFocus:!1,displayUrl:this.state.url,typedUrl:this.state.editUrl,handleDrop:!0,onBlur:this._onEditBlur,onFocus:this._onEditFocus,inputId:this._id,autoFocus:!0})):(0,fs.jsxs)(fs.Fragment,{children:[(0,fs.jsx)(yo,{ref:this.refTreeList,rowComponent:this.rowComponent,nodes:this.state.menuItems,rootId:this.state.rootId,cutIds:this.state.cutIds,enableDragAndDrop:!Pi.isSection(this.props.menu),validateForDrag:this._validateForDrag,validateForDeletion:this._validateForDeletion,isValidDragSource:this._isValidDragSource,getDragData:this._getDragData,setCustomDragData:this._setDragData,getDropSupport:this._getDropSupport,onDrop:this._onDrop,onMove:this._onMove,onCreate:this._onCreate,onEdit:this._onEdit,delete:this._onRemove,onCut:this._cut,onCopy:this._copy,onPaste:this._paste,hasChildren:this._hasChildren,isFolder:this._isFolder,appendContextItems:!0,getContextMenuItems:this._getContextMenuItems,getContextMenuItemProps:this._getContextMenuItemProps,getContextMenuNewItemString:this._getContextMenuNewItemString,getTitle:this._getTitle,saveTitle:this._saveTitle,supportsInlineEdit:!0,supportsUpDownMove:this._supportsUpDownMove,isValidToEdit:this._validateForRename}),qz("div",{className:"setting-single"},void 0,qz("input",{type:"button",onClick:this.props.confirmReset,value:(0,Oe.Z)("Restore Default Menu")}))]}):null}}const tG=eG;var nG;function sG(e,t,n,s){nG||(nG="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:nG,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const iG=[$.kMenuDisplay],oG={width:400,minWidth:"unset"};class aG extends hs.Component{refMenuTree=hs.createRef();constructor(e){super(e);const t="top"===this.props.prefValues[$.kMenuDisplay]?"menubar":"vivaldi";this.state={menu:t,confirmation:!1}}_onMenuChange=e=>{this.setState({menu:e.target.value})};_handleResetMenu=()=>{C.Z.menuContent.reset(this.state.menu,Pi.hasName(this.state.menu),void 0,(()=>{})),this.closeConfirmation()};_canAddToTree=()=>Boolean(this.refMenuTree.current?.getSelectedItem());_addToTree=(e,t)=>{const n=this.refMenuTree.current,s=n?.getSelectedItem();n&&s&&n.addToNode(s,t,!0)};confirmReset=()=>this.setState({confirmation:!0});closeConfirmation=()=>this.setState({confirmation:!1});getMenuName=e=>{if(e||(e=this.state.menu),Pi.hasName(e))return Pi.getName(e);switch(e){case"vivaldi":return(0,Oe.Z)("Vivaldi Button Menu");case"menubar":return(0,Oe.Z)("Horizontal Menu");case"mac":return(0,Oe.Z)("Application Menu");default:return e}};renderModal=()=>{const e=this.getMenuName();return sG(_r.Z,{style:oG,onRequestClose:this.closeConfirmation,viewMode:"anchor slide"},void 0,sG("header",{className:"dialog-header"},void 0,sG("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("Reset $1?",[e]))),sG("div",{className:"dialog-content"},void 0,sG("p",{},void 0,(0,Oe.Z)("$1 will be reset to its default state.",[e]))),sG("footer",{className:"dialog-footer"},void 0,sG("input",{type:"button",className:"primary",onClick:this._handleResetMenu,value:(0,Oe.Z)("Reset to Default"),autoFocus:!0}),sG("input",{type:"button",onClick:this.closeConfirmation,value:(0,Oe.Z)("Cancel")})))};_getOptionItems=()=>[...["vivaldi","menubar"].map((e=>({key:e,indent:1,name:this.getMenuName(e)}))),...Pi.getSettingsList()];render(){const e=this._getOptionItems().map((e=>0===e.indent?sG("optgroup",{label:e.name},e.key):sG("option",{value:e.key},e.key," ".repeat(2*e.indent),e.name)));return sG(US.Z,{filter:this.props.filter},void 0,this.state.confirmation&&this.renderModal(),sG("div",{className:"setting-single"},void 0,sG("h3",{},void 0,(0,Oe.Z)("Menu Customization")),sG("select",{className:"menu-list",value:this.state.menu,onChange:this._onMenuChange},void 0,e)),sG("div",{className:"menu-lists"},void 0,sG("div",{className:"setting-single menu-commands"},void 0,sG("h3",{},void 0,(0,Oe.Z)("Content"))),sG("div",{className:"setting-single menu-commands"},void 0,sG("h3",{},void 0,(0,Oe.Z)("Commands"))),sG("div",{className:"setting-single menu-items"},void 0,(0,fs.jsx)(tG,{ref:this.refMenuTree,menu:this.state.menu,confirmReset:this.confirmReset,filter:this.props.filter})),sG("div",{className:"setting-single menu-commands"},void 0,sG(Yz,{canAddToTree:this._canAddToTree,addToTree:this._addToTree,menu:this.state.menu,filter:this.props.filter}))))}}const rG=sa(aG,iG);var lG;function dG(e,t,n,s){lG||(lG="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:lG,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const cG=[$.kMenuDisplay,$.kMenuIconType],hG=Ne.Z.getEventHandler;var pG=dG("input",{type:"radio",value:"vivaldi"}),uG=dG("input",{type:"radio",value:"top"}),gG=dG("input",{type:"radio",value:"icon"}),mG=dG("input",{type:"radio",value:"burger"});class vG extends hs.PureComponent{render(){return dG(mN,{categoryTitle:(0,Oe.Z)("Menu"),filter:this.props.filter},void 0,dG("div",{className:"setting-group"},void 0,dG("h3",{},void 0,(0,Oe.Z)("title","Menu Position")),dG(vl,{name:"menuPosition",value:this.props.prefValues[$.kMenuDisplay],onChange:hG($.kMenuDisplay),className:"group"},void 0,dG("div",{className:"setting-single"},void 0,dG("label",{},void 0,pG,dG("span",{},void 0,(0,Oe.Z)("menu","Vivaldi Button")))),dG("div",{className:"setting-single"},void 0,dG("label",{},void 0,uG,dG("span",{},void 0,(0,Oe.Z)("menu","Horizontal")))))),dG("div",{className:"setting-group"},void 0,dG("h3",{},void 0,(0,Oe.Z)("Menu Icon Style")),dG(vl,{name:"menuStyle",value:this.props.prefValues[$.kMenuIconType],onChange:hG($.kMenuIconType),className:"group"},void 0,dG("div",{className:"setting-single"},void 0,dG("label",{},void 0,gG,dG("span",{},void 0,(0,Oe.Z)("Vivaldi Icon")))),dG("div",{className:"setting-single"},void 0,dG("label",{},void 0,mG,dG("span",{},void 0,(0,Oe.Z)("Menu Icon")))))),dG(rG,{filter:this.props.filter}))}}const fG=sa(vG,cG),yG=40;const CG=class{points=[];points_buffer=[];stopped=!0;ctx;idx=0;timeout=0;requestId;animationId;current_point_index;constructor(e,t,n="#006ed7",s="#ffffff"){this.window=e,this.canvas=t,this.color=n,this.bgColor=s}segment_length=function(e){let t,n=0,s=0,i=0,o=0,a=0,r=0;for(t=0;t<e.length;t++)"0"===e[t]?a+=1:"4"===e[t]&&(a-=1),a>n&&(n=a),a<s&&(s=a);for(t=0;t<e.length;t++)"2"===e[t]?r-=1:"6"===e[t]&&(r+=1),r>i&&(i=r),r<o&&(o=r);return s>0&&(s=0),o>0&&(o=0),120/Math.max(Math.abs(n-s),Math.abs(i-o))};init_points=function(){this.points=[],this.points_buffer=[];const e={x:yG,y:yG};this.points.push(e);const t=this.segment_length(this.sequence);for(let e=0;e<this.sequence.length;e++){const n={};"0"===this.sequence[e]?(n.x=this.points[e].x+t,n.y=this.points[e].y):"2"===this.sequence[e]?(n.x=this.points[e].x,n.y=this.points[e].y+t):"4"===this.sequence[e]?(n.x=this.points[e].x-t,n.y=this.points[e].y):"6"===this.sequence[e]&&(n.x=this.points[e].x,n.y=this.points[e].y-t),this.points.push(n)}let n=this.points[0].x,s=this.points[0].y,i=this.points[0].x,o=this.points[0].y;for(let e=1;e<this.points.length;e++)this.points[e].x<n&&(n=this.points[e].x),this.points[e].x>i&&(i=this.points[e].x),this.points[e].y<s&&(s=this.points[e].y),this.points[e].y>o&&(o=this.points[e].y);if(n<yG){for(let e=0;e<this.points.length;e++)this.points[e].x+=-(n-yG);i+=-(n-yG)}if(s<yG){for(let e=0;e<this.points.length;e++)this.points[e].y+=-(s-yG);o+=-(s-yG)}for(let e=0;e<this.points.length;e++)this.points[e].x+=(160-i)/2,this.points[e].y+=(160-o-8)/2;for(let e=0;e<this.points.length;e++){const t={x:this.points[e].x,y:this.points[e].y};this.points_buffer.push(t)}};reset_points=function(){for(let e=0;e<this.points_buffer.length;e++)this.points[e].x=this.points_buffer[e].x,this.points[e].y=this.points_buffer[e].y};draw_point=function(e){this.ctx.beginPath(),this.ctx.arc(e.x,e.y,8,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.fillStyle=this.color,this.ctx.fill()};draw_segment=function(){if(!this.stopped){if(this.idx>=this.points.length)return this.timeout>=30?(this.timeout=0,this.idx=0,this.reset_points(),this.window.clearTimeout(this.requestId),void(this.requestId=setTimeout((()=>{this.animationId=this.window.requestAnimationFrame((()=>this.draw_segment()))}),1e3/60))):(this.ctx.fillStyle=B()(this.bgColor).alpha(.15).css(),this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.timeout++,this.window.clearTimeout(this.requestId),void(this.requestId=setTimeout((()=>{this.animationId=this.window.requestAnimationFrame((()=>this.draw_segment()))}),1e3/60)));this.ctx.fillStyle=B()(this.bgColor).alpha(.1).css(),this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.draw_point(this.points[this.idx]),!this.points[this.idx+1]||this.points[this.idx].x===this.points[this.idx+1].x&&this.points[this.idx].y===this.points[this.idx+1].y?(this.idx++,this.draw_segment()):(this.points[this.idx].x<this.points[this.idx+1].x?this.points[this.idx].x+=5:this.points[this.idx].x>this.points[this.idx+1].x&&(this.points[this.idx].x-=5),this.points[this.idx].y<this.points[this.idx+1].y?this.points[this.idx].y+=5:this.points[this.idx].y>this.points[this.idx+1].y&&(this.points[this.idx].y-=5),this.window.clearTimeout(this.requestId),this.requestId=setTimeout((()=>{this.window.requestAnimationFrame((()=>this.draw_segment()))}),1e3/60))}};clear_canvas=function(){this.ctx.fillStyle=this.bgColor,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)};start=function(e){this.sequence=e,this.ctx=this.canvas.getContext("2d"),this.ctx.lineWidth=3,this.clear_canvas(),this.init_points(),this.stopped&&(this.stopped=!1,this.animationId=this.window.requestAnimationFrame((()=>{this.draw_segment()})))};stop=function(){this.stopped=!0,this.current_point_index=0,this.timeout=0,this.idx=0,this.window.cancelAnimationFrame(this.animationId)}};var wG,bG=n(92571),SG=n(21191),IG=n(34155);function kG(e,t,n,s){wG||(wG="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:wG,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const AG={width:400,minWidth:"unset"},TG=je.jk.settingCategories,ZG=["colorHighlightBg","colorBg"],EG=[$.kMouseGesturesAltGesturesEnabled,$.kMouseGesturesDoubleClickMenuEnabled,$.kMouseGesturesEnabled,$.kMouseGesturesStrokeTolerance,$.kMouseGesturesRockerGesturesEnabled,$.kMouseGesturesRockerGesturesRightToLeft,$.kMouseGesturesRockerGesturesLeftToRight],_G=Ne.Z.getEventHandler;var MG=kG("hr",{}),NG=kG("span",{className:"meter-bg"});class PG extends hs.Component{static contextType=xi.Z;refGestureList=hs.createRef();refGestureCanvas=hs.createRef();lastX=0;lastY=0;constructor(e,t){super(e);const n=z.Z.getBaseStylesByWindowId(t.vivaldiWindowId,ZG),s=J.Z.getSettingsList(!0),i=s.find((e=>e.guid===this.props.prefValues[$.kMouseGesturesRockerGesturesLeftToRight])),o=s.find((e=>e.guid===this.props.prefValues[$.kMouseGesturesRockerGesturesRightToLeft]));this.state={commandArray:s,assignedArray:J.Z.getCommandsForGestures(),selectedCommand:this._getTopCommand(s),addingGesture:0,gestureExists:!1,angleMap:this.populateAngleMap(),confirmation:!1,colorHighlightBg:String(n["--colorHighlightBg"]),colorBg:String(n["--colorBg"]),rockerLTRCommand:i,rockerRTLCommand:o}}componentDidMount(){z.Z.addListener(this.onThemeStoreChanged),J.Z.addListener(this._onCommandStoreChange),f.Z.addListener(this._onCommandStoreChange),this.props.category!==TG.all&&IG.nextTick((()=>this.refGestureList.current?.focus()))}_onCommandStoreChange=()=>{const e=J.Z.getSettingsList(!0),t=J.Z.getCommandsForGestures();let n=!1;const s=this.state.selectedCommand?.name,i=Object.keys(t);for(let e=0;e<i.length&&!n;e++){n=-1!==t[i[e]].findIndex((e=>e.name===s))}n?this.setState({commandArray:e,assignedArray:t,addingGesture:0}):this.setState({commandArray:e,selectedCommand:this._getTopCommand(e),assignedArray:t,addingGesture:0}),0===i.length&&this.clearAnimation()};componentWillUnmount(){z.Z.removeListener(this.onThemeStoreChanged),this.animation?.stop(),J.Z.removeListener(this._onCommandStoreChange),f.Z.removeListener(this._onCommandStoreChange)}componentDidUpdate(e,t){const n=this.refGestureCanvas.current;this.animation&&n&&(this.state.colorBg!==t.colorBg||this.state.colorHighlightBg!==t.colorHighlightBg)&&(this.clearAnimation(),this.animation=new CG(this.context.window,n,this.state.colorHighlightBg,this.state.colorBg),this.state.selectedCommand?.gestures&&this.animation.start(this.state.selectedCommand.gestures[0]))}onThemeStoreChanged=()=>{const e=z.Z.getBaseStylesByWindowId(this.context.vivaldiWindowId,ZG),t=String(e["--colorHighlightBg"]),n=String(e["--colorBg"]);t===this.state.colorHighlightBg&&n===this.state.colorBg||this.setState({colorHighlightBg:t,colorBg:n})};populateAngleMap=()=>{const e=2*Math.PI/4,t=2*Math.PI/100,n=[];for(let s=-e/2;s<=2*Math.PI-e/2;s+=t){const t=2*Math.floor((s+e/2)/e);n.push(t)}return n};_getCommandByGesture=e=>this.state.commandArray.find((t=>{if(t.gestures&&t.gestures[0]===e)return t}));_getTopCommand=e=>e.find((e=>e.gestures));onGestureListChange=e=>{const t=this.state.selectedCommand;let n=e&&"focus"===e.type&&t&&t.gestures?t.gestures[0]:e.target.value;const s=e&&"focus"===e.type&&t?t:this._getCommandByGesture(n);if(n){this.clearAnimation();const e=this.refGestureCanvas.current;e&&(this.animation=new CG(this.context.window,e,this.state.colorHighlightBg,this.state.colorBg)),0===n.indexOf("e")&&(n=n.substring(1,n.length)),this.animation?.start(n),this.setState({addingGesture:0,selectedCommand:s})}};addGesture=()=>{this.setState({addingGesture:1})};onCancelGesture=()=>{this.moves=[],this.clearAnimation();const e=this.state.commandArray;this.setState({addingGesture:0,gestureExists:!1,selectedCommand:this._getTopCommand(e)})};_findNextCommandGesture=()=>{const e=this.state.selectedCommand,t=this.state.commandArray.filter((e=>e.gestures));if(t&&e){const n=t.findIndex((t=>t.name===e.name));return n<t.length-1?t[n+1]:t[n-1]}};removeGesture=()=>{const e=this._findNextCommandGesture(),t=this.state.selectedCommand;t&&(v.Z.setGestures(t.name),this.setState({selectedCommand:e}),this.animation&&e?.gestures&&this.animation.start(e.gestures[0]))};editGesture=()=>{const e=this.state.selectedCommand;e&&this.setState((t=>({addingGesture:2,selectedCommand:t.commandArray.find((t=>t.name===e.name))})))};restoreGestures=()=>{v.Z.restoreGestures(),this.setState({confirmation:!1})};confirmRestore=()=>{this.setState({confirmation:!0})};onCancel=()=>{this.setState({confirmation:!1})};consolidateCommands=()=>this.state.commandArray.filter((e=>!e.gestures&&e));save=()=>{if(!this.moves)return;let e=this.moves.join("");const t=this.state.selectedCommand;t&&((0,SG.jD)(t.name)&&(e="e"+e),v.Z.setGestures(t.name,[e]),this.moves=[],IG.nextTick((()=>this.refGestureList.current?.focus())))};addPoint=(e,t,n)=>{this.pointX.push(e),this.pointY.push(t),n&&this.pointDrag.push(n)};addMove=(e,t)=>{const n=2*Math.PI/4;let s=Math.atan2(t,e)+n/2;s<0&&(s+=2*Math.PI);const i=Math.floor(s/(2*Math.PI)*100);Array.isArray(this.moves)&&this.moves.push(this.state.angleMap[i])};redraw=()=>{const e=this.refGestureCanvas.current,t=e?.getContext("2d");if(e&&t){t.clearRect(0,0,t.canvas.width,t.canvas.height),"string"==typeof this.state.colorHighlightBg&&(t.strokeStyle=this.state.colorHighlightBg),t.lineJoin="round",t.lineWidth=16;for(let e=0;e<this.pointX.length;e++)t.beginPath(),this.pointDrag[e]&&e?t.moveTo(this.pointX[e-1],this.pointY[e-1]):t.moveTo(this.pointX[e]-1,this.pointY[e]),t.lineTo(this.pointX[e],this.pointY[e]),t.closePath(),t.stroke()}};penDown=e=>{if(2!==this.state.addingGesture||e.button&&0!==e.button)return;e.touches&&(e=e.touches[0]),this.clearAnimation(),this.moves=[],this.paint=!0;const t=this.refGestureCanvas.current?.getBoundingClientRect()??{left:0,top:0};this.addPoint(e.pageX-t.left,e.pageY-t.top),this.redraw()};penMove=e=>{if(2===this.state.addingGesture&&(e.touches&&(e=e.touches[0]),this.paint)){const t=this.refGestureCanvas.current?.getBoundingClientRect()??{left:0,top:0};if(this.addPoint(e.pageX-t.left,e.pageY-t.top,!0),0===this.lastX)return this.lastX=e.pageX-t.left,void(this.lastY=e.pageY-t.top);const n=e.pageX-t.left-this.lastX,s=e.pageY-t.top-this.lastY,i=10;n*n+s*s>i*i&&(this.lastX=e.pageX-t.left,this.lastY=e.pageY-t.top,this.addMove(n,s)),this.redraw()}};penUp=()=>{if(this.paint=!1,2!==this.state.addingGesture||!this.moves||this.moves.length<3)return;this.moves.length&&(this.moves=this.moves.map(((e,t,n)=>{if(e!==n[t-1]&&e===n[t+1])return e})).filter((e=>void 0!==e)));let e=this.moves.join("");e.length>5&&(e=e.substring(e.length-5));const t=this.refGestureCanvas.current;t&&(this.animation=new CG(this.context.window,t,this.state.colorHighlightBg,this.state.colorBg),this.animation.start(e));const{assignedArray:n,selectedCommand:s}=this.state;let i;i=s&&(0,SG.jD)(s.name)?n["e"+e]:n[e],this.setState({gestureExists:Boolean(i)})};penLeave=()=>{this.paint&&(this.paint=!1,this.moves=[],this.forceUpdate())};clearAnimation=()=>{this.animation?.stop(),this.clearCanvas()};clearCanvas=()=>{this.paint=!1,this.pointX=[],this.pointY=[],this.pointDrag=[];const e=this.refGestureCanvas.current;if(e){e.getContext("2d").clearRect(0,0,e.width,e.height)}};renderGesture=()=>(0,fs.jsx)("canvas",{ref:this.refGestureCanvas,width:"200",height:"200",onTouchStart:this.penDown,onTouchMove:this.penMove,onTouchEnd:this.penUp,onTouchCancel:this.penLeave,onMouseDown:this.penDown,onMouseMove:this.penMove,onMouseUp:this.penUp,onMouseLeave:this.penLeave});renderSearchableCommands=()=>{const e=this.consolidateCommands(),t=this.props.category!==TG.all,{selectedCommand:n}=this.state;return kG(bG.Z,{placeholder:(0,Oe.Z)("Filter commands..."),isClearable:!0,autoFocus:t,selectedCommand:n,openMenuOnFocus:!0,isMulti:!1,setSelectedItem:this.setSelectedCommand,commands:e})};renderRockerGestureCommands=e=>{const t=this.state.commandArray;let n="LTR"===e?this.state.rockerLTRCommand:this.state.rockerRTLCommand;const s=this.props.prefValues[$.kMouseGesturesRockerGesturesLeftToRight],i=this.props.prefValues[$.kMouseGesturesRockerGesturesRightToLeft];return"LTR"===e&&n&&s!==n.guid?n=t.find((e=>e.guid===s)):"RTL"===e&&n&&i!==n.guid&&(n=t.find((e=>e.guid===i))),kG(bG.Z,{placeholder:(0,Oe.Z)("Filter commands..."),isClearable:!1,autoFocus:!1,selectedCommand:n,openMenuOnFocus:!0,isMulti:!1,setSelectedItem:t=>this.setSelectedRockerCommand(t,e),commands:t})};setSelectedRockerCommand=(e,t)=>{"LTR"===t?(Ne.Z.set($.kMouseGesturesRockerGesturesLeftToRight,e.guid),this.setState({rockerLTRCommand:e})):(Ne.Z.set($.kMouseGesturesRockerGesturesRightToLeft,e.guid),this.setState({rockerRTLCommand:e}))};setSelectedCommand=e=>{this.setState({selectedCommand:e})};renderCommands=()=>this.state.commandArray.map((e=>{const{gestures:t}=e;return t?kG("option",{value:t[0]},`id-gesture-${e.label.split(" ").join("_")}`,e.label):null}));renderModal=()=>kG(_r.Z,{style:AG,onRequestClose:this.onCancel},void 0,kG("div",{className:"dialog-restore-shortcuts"},void 0,kG("header",{className:"dialog-header"},void 0,kG("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("Restore Gestures?"))),kG("div",{className:"dialog-content"},void 0,kG("p",{},void 0,(0,Oe.Z)("All command gestures will be restored to default settings."))),kG("footer",{className:"dialog-footer"},void 0,kG("input",{type:"button",className:"danger",onClick:this.restoreGestures,value:(0,Oe.Z)("Restore")}),kG("input",{type:"button",onClick:this.onCancel,value:(0,Oe.Z)("Cancel"),autoFocus:!0}))));render(){const e=this.props.prefValues,t=this.state.selectedCommand,n=t&&t.gestures?t.gestures[0]:void 0,s=!this.moves||0===this.moves.length,i=this.state.gestureExists&&!s?this.state.commandArray.find((e=>e.gestures&&e.gestures.includes(this.moves.join("")))):void 0,o=" "+(0,Oe.Z)("This setting requires a restart to take full effect.");return kG(mN,{categoryTitle:(0,Oe.Z)("Mouse"),filter:this.props.filter},void 0,this.state.confirmation&&this.renderModal(),kG("div",{className:"setting-group unlimited"},void 0,kG("h3",{},void 0,(0,Oe.Z)("Gestures")),kG("div",{className:"setting-single"},void 0,kG("label",{},void 0,kG("input",{type:"checkbox",checked:e[$.kMouseGesturesEnabled],onChange:_G($.kMouseGesturesEnabled)}),kG("span",{},void 0,(0,Oe.Z)("Allow Gestures"))),kG("p",{className:"info"},void 0,(0,Oe.Z)("Hold down right mouse button and perform a gesture to issue related command.")+o)),kG("div",{className:"setting-single"},void 0,kG("label",{},void 0,kG("input",{type:"checkbox",checked:e[$.kMouseGesturesAltGesturesEnabled],onChange:_G($.kMouseGesturesAltGesturesEnabled)}),kG("span",{},void 0,(0,Oe.Z)("win_linux","Perform Gestures with Alt Key"))),kG("p",{className:"info"},void 0,(0,Oe.Z)("Use gestures with trackpad or other input device.")))),kG("div",{className:"setting-group unlimited gestures"},void 0,kG("div",{className:"setting-single pad-top"},void 0,kG("h3",{},void 0,(0,Oe.Z)("Gesture Mapping")),kG("div",{className:"gesture-map setting-single"},void 0,(0,fs.jsx)("select",{ref:this.refGestureList,className:"gesture-list",value:n,onChange:this.onGestureListChange,onFocus:this.onGestureListChange,onBlur:this.clearAnimation,size:"9",children:this.renderCommands()}),kG("div",{className:2===this.state.addingGesture?"active gesture":"gesture"},void 0,this.renderGesture())),kG("div",{className:"setting-single record-gesture"},void 0,0===this.state.addingGesture&&kG("div",{className:"toolbar toolbar-default"},void 0,kG("div",{className:"toolbar toolbar-group"},void 0,kG(Fa,{tooltip:(0,Oe.Z)("New gesture"),onClick:this.addGesture,image:Ts.md4.medium}),MG,kG(Fa,{tooltip:(0,Oe.Z)("Remove gesture"),onClick:this.removeGesture,disabled:!t,image:Ts.M2k.medium})),kG(Fa,{tooltip:(0,Oe.Z)("Edit gesture"),onClick:this.editGesture,disabled:!t,image:Ts.NNg.medium}),kG(Fa,{title:(0,Oe.Z)("Restore Default Gestures"),onClick:this.confirmRestore})),1===this.state.addingGesture&&kG("form",{onSubmit:this.editGesture},void 0,kG("h3",{className:"pad-top"},void 0,(0,Oe.Z)("Pick a Command")),kG("div",{className:"toolbar"},void 0,this.renderSearchableCommands(),kG("input",{type:"submit",disabled:!t,value:(0,Oe.Z)("Next...")}),kG("input",{type:"button",onClick:this.onCancelGesture,value:(0,Oe.Z)("Cancel")}))),t&&2===this.state.addingGesture&&(0,fs.jsxs)(fs.Fragment,{children:[kG("h3",{className:"pad-top"},void 0,(0,Oe.Z)("Recording “$1” Gesture",[t.label])),kG("div",{className:"add-gesture"},void 0,kG("p",{className:"info"},void 0,(0,Oe.Z)("Draw a new gesture in the highlighted area using the primary input. Gesture may consist of horizontal and vertical lines, limited to maximum of five strokes.")),kG("div",{className:"save"},void 0,kG("input",{type:"submit",value:(0,Oe.Z)("Save Gesture"),onClick:this.save,disabled:s||this.state.gestureExists}),kG("input",{type:"button",onClick:this.onCancelGesture,value:(0,Oe.Z)("Cancel")}),i&&kG("p",{className:"alert"},void 0,(0,Oe.Z)("This gesture is already used by “$1” command.",[i.label]))))]})))),kG("div",{className:"setting-group unlimited"},void 0,kG("div",{className:"setting-single pad-top"},void 0,kG("h3",{},void 0,(0,Oe.Z)("Gesture Sensitivity")),kG("p",{className:"info"},void 0,(0,Oe.Z)("Set minimum stroke length to be recognized as a gesture move.")),kG("div",{className:"setting-single tolerance"},void 0,kG("div",{className:"gesture-preview"},void 0,NG,kG("span",{className:"meter",style:{width:e[$.kMouseGesturesStrokeTolerance]+"px"}}),kG("span",{},void 0,(0,Oe.Z)("$1 pixels",[e[$.kMouseGesturesStrokeTolerance]]))),kG(RB,{min:5,max:100,step:5,onChange:_G($.kMouseGesturesStrokeTolerance),value:e[$.kMouseGesturesStrokeTolerance]}))),kG("div",{className:"setting-single pad-top"},void 0,kG("h3",{},void 0,(0,Oe.Z)("Rocker Gestures")),kG("label",{},void 0,kG("input",{type:"checkbox",checked:e[$.kMouseGesturesRockerGesturesEnabled],onChange:_G($.kMouseGesturesRockerGesturesEnabled)}),kG("span",{},void 0,(0,Oe.Z)("Allow Rocker Gestures"))),kG("p",{className:"info"},void 0,o),kG("div",{className:"pad-left"},void 0,kG("div",{className:"rocker-gesture-settings"},void 0,kG("span",{className:"rocker-gesture-settings-title"},void 0,kG("span",{dangerouslySetInnerHTML:{__html:Ts.GmL}}),(0,Oe.Z)("other","Right")),this.renderRockerGestureCommands("LTR")),kG("p",{className:"info"},void 0,(0,Oe.Z)("Press left mouse button followed by right button to execute."))),kG("div",{className:"pad-left"},void 0,kG("div",{className:"rocker-gesture-settings"},void 0,kG("span",{className:"rocker-gesture-settings-title"},void 0,kG("span",{style:{transform:"scale(-1, 1)"},dangerouslySetInnerHTML:{__html:Ts.GmL}}),(0,Oe.Z)("other","Left")),this.renderRockerGestureCommands("RTL")),kG("p",{className:"info"},void 0,(0,Oe.Z)("Press right mouse button followed by left button to execute.")))),ds.Z.isEnabled("double_click_menu")&&kG("div",{className:"setting-single pad-top"},void 0,kG("h3",{},void 0,(0,Oe.Z)("Double Click Context Menu")),kG("label",{},void 0,kG("input",{type:"checkbox",checked:e[$.kMouseGesturesDoubleClickMenuEnabled],onChange:_G($.kMouseGesturesDoubleClickMenuEnabled)}),kG("span",{},void 0,(0,Oe.Z)("Allow Double Click to Show Context Menu"))),kG("p",{className:"info"},void 0,(0,Oe.Z)("Use a double click to show the context menu.")+o))))}}const DG=sa(PG,EG);var xG;function OG(e,t,n,s){xG||(xG="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:xG,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const LG=Ne.Z.getEventHandler,RG=[$.kVivaldiClientHintsBrand,$.kVivaldiClientHintsBrandAppendVivaldi,$.kVivaldiClientHintsBrandCustomBrand,$.kVivaldiClientHintsBrandCustomBrandVersion],BG=new RegExp(/[^\x20-\x21\x23-\x5B\x5D-\x7E]/),FG=new RegExp(/^[0-9.]*$/);class VG extends hs.Component{static contextType=xi.Z;state={brandPatternMismatch:!1,versionPatternMismatch:!1};onClick=()=>{C.Z.utilities.launchNetworkSettings(this.context.vivaldiWindowId)};getString=()=>{const e=navigator.userAgentData?.brands.map((e=>`"${e.brand}";v="${e.version}"`)).join(",");return e??""};validateBrandInput=e=>{const t=e.target.value;!BG.test(t)&&!t.includes('"')||""===t?(Ne.Z.set($.kVivaldiClientHintsBrandCustomBrand,t),this.state.brandPatternMismatch&&this.setState({brandPatternMismatch:!1})):this.setState({brandPatternMismatch:!0})};validateVersionInput=e=>{const t=e.target.value;FG.test(t)||""===t?(Ne.Z.set($.kVivaldiClientHintsBrandCustomBrandVersion,t),this.state.versionPatternMismatch&&this.setState({versionPatternMismatch:!1})):this.setState({versionPatternMismatch:!0})};render(){const e=Boolean(navigator.userAgentData);return OG(mN,{categoryTitle:(0,Oe.Z)("Network"),filter:this.props.filter},void 0,OG("div",{className:"setting-group"},void 0,OG("h3",{},void 0,(0,Oe.Z)("Proxies")),OG("div",{className:"setting-single"},void 0,OG("input",{type:"button",value:(0,Oe.Z)("Proxy Settings"),onClick:this.onClick}))),e&&OG("div",{className:"setting-group setting-group-double brand-masking"},void 0,OG("h3",{},void 0,(0,Oe.Z)("User Agent Brand Masking")),OG("p",{className:"info"},void 0,(0,Oe.Z)("This setting is intended for debugging websites by updating the Sec-CH-UA browser identity HTTP header. Changes may cause site compatibility issues.")," ",(0,Oe.Z)("This setting requires a restart to take full effect.")),OG("div",{},void 0,OG("label",{className:"stack-column"},void 0,OG("span",{},void 0,(0,Oe.Z)("Report Browser Brand as")),OG("select",{value:this.props.prefValues[$.kVivaldiClientHintsBrand].toString(),onChange:LG($.kVivaldiClientHintsBrand)},void 0,OG("option",{value:"0"},void 0,(0,Oe.Z)("No Brand")),OG("option",{value:"1"},void 0,(0,Oe.Z)("Vivaldi")),OG("option",{value:"2"},void 0,(0,Oe.Z)("Custom")),OG("option",{value:"3"},void 0,(0,Oe.Z)("Google Chrome")),OG("option",{value:"4"},void 0,(0,Oe.Z)("Microsoft Edge"))))),OG("div",{className:"setting-single pad-top"},void 0,OG("label",{},void 0,OG("input",{type:"checkbox",checked:this.props.prefValues[$.kVivaldiClientHintsBrandAppendVivaldi],onChange:LG($.kVivaldiClientHintsBrandAppendVivaldi),disabled:this.props.prefValues[$.kVivaldiClientHintsBrand]<2}),OG("span",{},void 0,(0,Oe.Z)("Append Vivaldi Brand")))),OG("div",{className:"setting-single"},void 0,OG("label",{},void 0,OG("input",{type:"text",value:this.props.prefValues[$.kVivaldiClientHintsBrandCustomBrand],onChange:this.validateBrandInput,disabled:2!==this.props.prefValues[$.kVivaldiClientHintsBrand],maxLength:"50"}),OG("span",{},void 0,(0,Oe.Z)("Custom Brand"))),this.state.brandPatternMismatch&&OG(tc,{type:"warning"},void 0,(0,Oe.Z)("Brand is limited to 50 ASCII and punctuation characters except for a double quote."))),OG("div",{className:"setting-single"},void 0,OG("label",{},void 0,OG("input",{type:"text",value:this.props.prefValues[$.kVivaldiClientHintsBrandCustomBrandVersion],onChange:this.validateVersionInput,disabled:2!==this.props.prefValues[$.kVivaldiClientHintsBrand],maxLength:"20"}),OG("span",{},void 0,(0,Oe.Z)("Custom Version"))),this.state.versionPatternMismatch&&OG(tc,{type:"warning"},void 0,(0,Oe.Z)("Version is limited to 20 number or period characters."))),OG("div",{className:"setting-single pad-top"},void 0,OG("h3",{},void 0,(0,Oe.Z)("Sec-CH-UA HTTP Header")),OG("p",{},void 0,OG("span",{className:"selectable"},void 0,this.getString())))))}}const WG=sa(VG,RG);var UG;function HG(e,t,n,s){UG||(UG="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:UG,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const zG=[$.kMailContactDefaultAction,$.kMailIsTurnedOff,$.kMailSingleClickTabs,$.kNotesCreationAddScreenshot,$.kNotesCreationNotify,$.kNotesCreationShowPanel,$.kPanelsAsOverlayAutoClose,$.kPanelsLazyLoad,$.kPanelsAsOverlayEnabled,$.kPanelsPosition,$.kReadingListShowCounter,$.kReadingListPanelSingleClickOpens,$.kPanelsShowCloseButton,$.kPanelsShowFolderBadge,$.kPanelsShowToggle,$.kPanelsTranslatePaste,$.kPanelsTranslateRedirect,$.kPanelsWindowDragToStack,$.kPanelsWindowShowPinnedGroup,$.kPanelsWindowSingleClickOpens,$.kPanelsWindowShowUnread,$.kTabsCounterDetection],GG=Ne.Z.getEventHandler;var $G=HG("input",{type:"radio",value:"left"}),KG=HG("input",{type:"radio",value:"right"}),jG=HG("input",{type:"radio",value:"viewAllMessages"}),YG=HG("input",{type:"radio",value:"compose"});class XG extends hs.Component{render(){return HG(mN,{categoryTitle:(0,Oe.Z)("Panels"),filter:this.props.filter},void 0,HG("div",{className:"setting-group"},void 0,HG("h3",{},void 0,(0,Oe.Z)("Panel Position")),HG(vl,{name:"panelPosition",value:this.props.prefValues[$.kPanelsPosition],onChange:GG($.kPanelsPosition),className:"group"},void 0,HG("div",{className:"setting-single"},void 0,HG("label",{},void 0,$G,HG("span",{},void 0,(0,Oe.Z)("Left Side")))),HG("div",{className:"setting-single"},void 0,HG("label",{},void 0,KG,HG("span",{},void 0,(0,Oe.Z)("Right Side")))))),HG("div",{className:"setting-group"},void 0,HG("h3",{},void 0,(0,Oe.Z)("Panel Options")),HG("div",{className:"setting-single"},void 0,HG("label",{title:(0,Oe.Z)("Display a panel toggle button along the side")},void 0,HG("input",{type:"checkbox",checked:this.props.prefValues[$.kPanelsShowToggle],onChange:GG($.kPanelsShowToggle)}),HG("span",{},void 0,(0,Oe.Z)("Show Panel Toggle")))),HG("div",{className:"setting-single"},void 0,HG("label",{title:(0,Oe.Z)("Overlay panel over browser content")},void 0,HG("input",{type:"checkbox",checked:this.props.prefValues[$.kPanelsAsOverlayEnabled],onChange:GG($.kPanelsAsOverlayEnabled)}),HG("span",{},void 0,(0,Oe.Z)("Floating Panel")))),HG("div",{className:"setting-single pad-left"},void 0,HG("label",{title:(0,Oe.Z)("Automatically collapse panel upon losing focus")},void 0,HG("input",{type:"checkbox",disabled:!this.props.prefValues[$.kPanelsAsOverlayEnabled],checked:this.props.prefValues[$.kPanelsAsOverlayAutoClose],onChange:GG($.kPanelsAsOverlayAutoClose)}),HG("span",{},void 0,(0,Oe.Z)("Auto-Close Inactive Panel")))),HG("div",{className:"setting-single"},void 0,HG("label",{},void 0,HG("input",{type:"checkbox",checked:this.props.prefValues[$.kPanelsShowCloseButton],onChange:GG($.kPanelsShowCloseButton)}),HG("span",{},void 0,(0,Oe.Z)("Show Close Button")))),HG("div",{className:"setting-single"},void 0,HG("label",{},void 0,HG("input",{type:"checkbox",checked:this.props.prefValues[$.kPanelsShowFolderBadge],onChange:GG($.kPanelsShowFolderBadge)}),HG("span",{},void 0,(0,Oe.Z)("Show Folder Counters"))))),HG("div",{className:"setting-group"},void 0,HG("h3",{},void 0,(0,Oe.Z)("Web Panels")),HG("div",{className:"setting-single"},void 0,HG("label",{title:(0,Oe.Z)("Detect and display numeric notification from page title in Tabs and Web Panels")},void 0,HG("input",{type:"checkbox",checked:this.props.prefValues[$.kTabsCounterDetection],onChange:GG($.kTabsCounterDetection)}),HG("span",{},void 0,(0,Oe.Z)("Detect Page Title Notifications")))),HG("div",{className:"setting-single"},void 0,HG("label",{title:(0,Oe.Z)("Wait to Load Panels Until Activated")},void 0,HG("input",{type:"checkbox",checked:this.props.prefValues[$.kPanelsLazyLoad],onChange:GG($.kPanelsLazyLoad)}),HG("span",{},void 0,(0,Oe.Z)("Lazy Load"))))),HG("div",{className:"setting-group"},void 0,HG("h3",{},void 0,(0,Oe.Z)("title","Notes Panel")),HG("div",{className:"setting-single"},void 0,HG("label",{title:(0,Oe.Z)("Show panel content when adding a note from a page")},void 0,HG("input",{type:"checkbox",checked:this.props.prefValues[$.kNotesCreationShowPanel],onChange:GG($.kNotesCreationShowPanel)}),HG("span",{},void 0,(0,Oe.Z)("Open Panel Automatically")))),HG("div",{className:"setting-single"},void 0,HG("label",{},void 0,HG("input",{type:"checkbox",checked:this.props.prefValues[$.kNotesCreationNotify],onChange:GG($.kNotesCreationNotify)}),HG("span",{},void 0,(0,Oe.Z)("Notify on Adding New Note")))),HG("div",{className:"setting-single"},void 0,HG("label",{title:(0,Oe.Z)("Add a screenshot when adding a note from a page")},void 0,HG("input",{type:"checkbox",checked:this.props.prefValues[$.kNotesCreationAddScreenshot],onChange:GG($.kNotesCreationAddScreenshot)}),HG("span",{},void 0,(0,Oe.Z)("Fetch Screenshot for New Notes"))))),HG("div",{className:"setting-group"},void 0,HG("h3",{},void 0,(0,Oe.Z)("title","Window Panel")),HG("div",{className:"setting-single"},void 0,HG("label",{},void 0,HG("input",{type:"checkbox",checked:this.props.prefValues[$.kPanelsWindowSingleClickOpens],onChange:GG($.kPanelsWindowSingleClickOpens)}),HG("span",{},void 0,(0,Oe.Z)("Activate with Single Click")))),HG("div",{className:"setting-single"},void 0,HG("label",{},void 0,HG("input",{type:"checkbox",checked:this.props.prefValues[$.kPanelsWindowShowPinnedGroup],onChange:GG($.kPanelsWindowShowPinnedGroup)}),HG("span",{},void 0,(0,Oe.Z)("Pinned Folder")))),HG("div",{className:"setting-single"},void 0,HG("label",{},void 0,HG("input",{type:"checkbox",checked:this.props.prefValues[$.kPanelsWindowDragToStack],onChange:GG($.kPanelsWindowDragToStack)}),HG("span",{},void 0,(0,Oe.Z)("Create Tab Stack by Drag and Drop")))),HG("div",{className:"setting-single"},void 0,HG("label",{},void 0,HG("input",{type:"checkbox",checked:this.props.prefValues[$.kPanelsWindowShowUnread],onChange:GG($.kPanelsWindowShowUnread)}),HG("span",{},void 0,(0,Oe.Z)("Show Unread Tabs Badge"))))),HG("div",{className:"setting-group"},void 0,HG("h3",{},void 0,(0,Oe.Z)("title","Translate Panel")),HG("div",{className:"setting-single"},void 0,HG("label",{},void 0,HG("input",{type:"checkbox",checked:this.props.prefValues[$.kPanelsTranslateRedirect],onChange:GG($.kPanelsTranslateRedirect)}),HG("span",{},void 0,(0,Oe.Z)("Use Panel Instead of Dialog")))),HG("div",{className:"setting-single"},void 0,HG("label",{},void 0,HG("input",{type:"checkbox",checked:this.props.prefValues[$.kPanelsTranslatePaste],onChange:GG($.kPanelsTranslatePaste)}),HG("span",{},void 0,(0,Oe.Z)("Translate when pasting text"))))),HG("div",{className:"setting-group"},void 0,HG("h3",{},void 0,(0,Oe.Z)("Reading List Panel")),HG("div",{className:"setting-single"},void 0,HG("label",{},void 0,HG("input",{type:"checkbox",checked:this.props.prefValues[$.kReadingListPanelSingleClickOpens],onChange:GG($.kReadingListPanelSingleClickOpens)}),HG("span",{},void 0,(0,Oe.Z)("Activate with Single Click")))),HG("div",{className:"setting-single"},void 0,HG("label",{},void 0,HG("input",{type:"checkbox",checked:this.props.prefValues[$.kReadingListShowCounter],onChange:GG($.kReadingListShowCounter)}),HG("span",{},void 0,(0,Oe.Z)("Show Unread Counters"))))),!this.props.prefValues[$.kMailIsTurnedOff]&&HG("div",{className:"setting-group"},void 0,HG("h3",{},void 0,(0,Oe.Z)("title","Contacts Panel")),HG("div",{className:"setting-single"},void 0,HG("label",{},void 0,HG("input",{type:"checkbox",checked:this.props.prefValues[$.kMailSingleClickTabs],onChange:GG($.kMailSingleClickTabs)}),HG("span",{},void 0,(0,Oe.Z)("Activate with Single Click")))),HG("div",{className:"setting-single pad-top"},void 0,HG("h3",{},void 0,(0,Oe.Z)("Default Contact Action")),HG(vl,{name:"contactDefaulAction",value:this.props.prefValues[$.kMailContactDefaultAction],onChange:GG($.kMailContactDefaultAction),className:"group"},void 0,HG("div",{className:"setting-single"},void 0,HG("label",{},void 0,jG,HG("span",{},void 0,(0,Oe.Z)("View All Mail Messages")))),HG("div",{className:"setting-single"},void 0,HG("label",{},void 0,YG,HG("span",{},void 0,(0,Oe.Z)("radio","Compose New Message"))))))))}}const QG=sa(XG,zG);var qG;function JG(e,t,n,s){qG||(qG="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:qG,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const e$=[$.kExceptionsAutoplay,$.kExceptionsGeolocation,$.kExceptionsCamera,$.kExceptionsMic,$.kExceptionsSensors,$.kExceptionsNotifications,$.kExceptionsJavaScript,$.kExceptionsImage,$.kExceptionsPopUp,$.kExceptionsSubResource,$.kExceptionsAutoDownload,$.kExceptionsSound,$.kExceptionsBluetooth,$.kExceptionsMIDI,$.kExceptionsIdle,$.kExceptionsBackgroundSync,$.kExceptionsUSB,$.kExceptionsSerial,$.kExceptionsFileEdit,$.kExceptionsHID,$.kExceptionsClipboard,$.kExceptionsPayment,$.kExceptionsAugmentedReality,$.kExceptionsVirtualReality,$.kExceptionsWebID,$.kExceptionsWindowManagement,$.kExceptionsFont,$.kExceptionsCookies],t$=",*";function n$(e,t){return e.startsWith("file:")?t?(0,vs.Ph)(e).replace(t$,""):e.split("/").pop().replace(t$,""):(0,vs.Ph)(e).replace(t$,"")}var s$=JG("hr",{});class i$ extends hs.PureComponent{state={siteFilter:"",confirmation:!1,globalPermissions:void 0};#z=[];componentDidMount(){this.initPermissionState()}initPermissionState=()=>{Object.keys(zS).forEach((e=>{C.Z.utilities.getDefaultContentSettings(e,(t=>{this.setState((n=>({globalPermissions:{...n.globalPermissions,[e]:t}})))}))}))};resetPermissions=()=>{this.state.siteFilter?e$.forEach((e=>{const t=structuredClone(this.props.prefValues[e]);Object.keys(t).filter((e=>e.includes(this.state.siteFilter))).forEach((e=>delete t[e])),Object.keys(t).length?Ne.Z.set(e,t):Ne.Z.reset(e)})):e$.forEach((e=>Ne.Z.reset(e))),this.setState({confirmation:!1})};onSettingsFilter=e=>{this.setState({siteFilter:e.target.value})};onChangePerm=e=>{const{value:t,dataset:n}=e.target,s=parseInt(t),i=n.pref,o=n.site;if(e$.includes(i)&&o){const e={...H.Z.get(i)};0===s?delete e[o]:e[o]={...e[o],setting:s},Ne.Z.set(i,e)}};onAskToDelete=()=>this.setState({confirmation:!0});onCancel=()=>this.setState({confirmation:!1});renderModal=()=>JG(_r.Z,{onRequestClose:this.onCancel,viewMode:"float"},void 0,JG("div",{className:"dialog-delete-cookies"},void 0,JG("header",{className:"dialog-header"},void 0,JG("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("Reset Website Permissions?"))),JG("div",{className:"dialog-content"},void 0,JG("p",{},void 0,this.state.siteFilter?(0,Oe.Z)("Filtered website permission exceptions will be removed."):(0,Oe.Z)("All website permission exceptions will be removed."))),JG("footer",{className:"dialog-footer"},void 0,JG("input",{type:"button",className:"danger",onClick:this.resetPermissions,value:(0,Oe.Z)("other","Reset"),autoFocus:!0}),JG("input",{type:"button",onClick:this.onCancel,value:(0,Oe.Z)("Cancel")}))));getGlobalValue=e=>{const t=Object.keys(zS).find((t=>zS[t].path===e));if(this.state.globalPermissions&&t){const e=this.state.globalPermissions[t]??"";switch(e){case"allow":return HS.Allow;case"block":return HS.Block;case"ask":return HS.Ask;case"session_only":return HS["Session Only"];default:return console.warn("Setting error",e),"?"}}return console.warn("Unknown permission",e),"?"};getSitePermissions=(e,t)=>{const n=this.props.prefValues[e][t]?.setting??0,s=e.split(".").pop();return JG("label",{className:0!==n?"changed":"default"},e,JG("span",{className:"icon",dangerouslySetInnerHTML:{__html:KS(s)}}),JG("span",{},void 0,function(e){const t=Object.keys(zS).find((t=>zS[t].path===e));return t?zS[t].label:""}(s)),JG("select",{"data-pref":e,"data-site":t,value:n,onChange:this.onChangePerm},e+n,JG("option",{value:0},void 0,(0,Oe.Z)("Default ($1)",[this.getGlobalValue(s)])),s$,JG("option",{value:1},void 0,HS.Allow),e===$.kExceptionsCookies?JG("option",{value:4},void 0,HS["Session Only"]):JG("option",{value:3},void 0,HS.Ask),JG("option",{value:2},void 0,HS.Block)))};remapDomains=()=>{const e=e$.flatMap((e=>Object.keys(this.props.prefValues[e]))),t=[...new Set([...e,...this.#z])].filter((e=>e.includes(this.state.siteFilter))).map((t=>({key:t,name:n$(t,!1),number:e.filter((e=>e===t)).length})),[]).sort(((e,t)=>(0,OE.qf)(e.name,t.name)));return this.#z=t.map((e=>e.key)),t.unshift({key:"default",name:HS["Global Permissions"],number:0}),t};renderContent=(e,t)=>{if(0===e)return JG(YS,{filter:this.props.filter,permissionList:this.state.globalPermissions,reloadPermissions:this.initPermissionState});const n=this.#z[e-1];return JG("div",{className:"detail"},void 0,JG("div",{className:"detail-content"},void 0,JG("h3",{},void 0,(0,Oe.Z)("Permissions for “$1”",[n$(n,!0)])),e$.map((e=>this.getSitePermissions(e,n)))))};renderListItem=(e,t)=>(0,fs.jsxs)(fs.Fragment,{children:[JG("span",{},void 0,e),t.number>0&&JG("span",{className:"item-count"},void 0,t.number)]});render(){const{siteFilter:e}=this.state,t=e$.flatMap((e=>Object.keys(this.props.prefValues[e]))),n=t.length,s=[...new Set(t)].length;return JG(mN,{filter:this.props.filter,categoryTitle:HS["Website Permissions"]},void 0,this.state.confirmation&&this.renderModal(),JG("div",{className:"setting-group unlimited","data-anchor":"permissions"},void 0,JG("p",{},void 0,(0,Oe.Z)("There $1 to the default permissions across $2.",[(0,Oe.Z)("is $1 exception","are $1 exceptions",[n]),(0,Oe.Z)("$1 domain","$1 domains",[s])]))),JG(xD.Z,{items:this.remapDomains(),masterLayout:1,renderListItem:this.renderListItem,renderContent:this.renderContent,contentStrings:HS,className:"setting-site-permissions",filter:this.props.filter,disableAutoFocus:!0}),JG("div",{className:"setting-single setting-single-flex"},void 0,JG("input",{type:"search",placeholder:(0,Oe.Z)("Filter by domain"),value:e,onChange:this.onSettingsFilter}),JG("input",{type:"button",onClick:this.onAskToDelete,value:(0,Oe.Z)(e?(0,Oe.Z)("Reset Filtered Website Permissions"):(0,Oe.Z)("Reset All Website Permissions"))})))}}const o$=sa(i$,e$);var a$;function r$(e,t,n,s){a$||(a$="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:a$,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const l$=[$.kHistoryDaysToKeepVisits,$.kSavingBrowserHistoryDisabled];class d$ extends hs.Component{onHistoryDaysChanged=e=>{const t=parseInt(e.target.value,10);Ne.Z.set($.kHistoryDaysToKeepVisits,t),0===t?Ne.Z.set($.kSavingBrowserHistoryDisabled,!0):Ne.Z.set($.kSavingBrowserHistoryDisabled,!1)};render(){const e=this.props.prefValues[$.kHistoryDaysToKeepVisits],t=[0,1,7,31,91,182,365,3650].includes(e);return r$(US.Z,{filter:this.props.filter},void 0,r$("div",{className:"setting-group"},void 0,r$("h3",{},void 0,(0,Oe.Z)("other","Save Browsing History")),r$("div",{className:"setting-single"},void 0,r$("select",{onChange:this.onHistoryDaysChanged,value:e},void 0,r$("option",{value:"0"},void 0,(0,Oe.Z)("command","Session Only")),r$("option",{value:"1"},void 0,(0,Oe.Z)("One Day")),r$("option",{value:"7"},void 0,(0,Oe.Z)("One Week")),r$("option",{value:"31"},void 0,(0,Oe.Z)("One Month")),r$("option",{value:"91"},void 0,(0,Oe.Z)("Three Months")),r$("option",{value:"182"},void 0,(0,Oe.Z)("Six Months")),r$("option",{value:"365"},void 0,(0,Oe.Z)("One Year")),r$("option",{value:"3650"},void 0,(0,Oe.Z)("Forever")),!t&&r$("option",{value:e},void 0,(0,Oe.Z)("Other ($1 Days)",[e])))),r$("p",{className:"info"},void 0,(0,Oe.Z)("Browser restart is required for new setting to take effect."))))}}const c$=sa(d$,l$);var h$;function p$(e,t,n,s){h$||(h$="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:h$,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const u$=[$.kAddressBarInlineSearchEnabled,$.kAddressBarInlineSearchSuggestEnabled,$.kAddressBarSearchSuggestEnabled,$.kAddressBarSearchTypedHistoryEnabled,$.kAddressBarTypedHistoryEnabled,$.kAlternateErrorPagesEnabled,$.kAutofillCreditCardEnabled,$.kAutofillProfileEnabled,$.kEnableDoNotTrack,$.kEnableHyperlinkAuditing,$.kPrivacyAdverseAdBlockEnabled,$.kPrivacyAutofillServerAssist,$.kPrivacyGoogleComponentExtensionsHangoutServices,$.kPrivacyGoogleComponentExtensionsWebStore,$.kSafeBrowsingEnabled,$.kIncognitoShowIntro,$.kVivaldiCrashReportingConsentGranted,$.kWebRTCIPHandlingPolicy,$.kCustomHandlersEnabled];const g$=Ne.Z.getEventHandler,m$=[$.kVivaldiCrashReportingConsentGranted];class v$ extends hs.Component{static contextType=xi.Z;state={protocolHandling:this.props.prefValues[$.kCustomHandlersEnabled]};componentDidMount(){H.Z.addListener(m$,this.onPrefsCacheChanged)}componentWillUnmount(){H.Z.removeListener(m$,this.onPrefsCacheChanged)}onPrefsCacheChanged=()=>this.forceUpdate();toggleChromePrivacyWebRTCChange=()=>{const e=this.webRTCAnnouncesIPs()?"disable_non_proxied_udp":"default";Ne.Z.set($.kWebRTCIPHandlingPolicy,e)};webRTCAnnouncesIPs=()=>["default","default_public_interface_only","default_public_and_private_interfaces"].some((e=>this.props.prefValues[$.kWebRTCIPHandlingPolicy]===e));toggleProtocolHandling=()=>{C.Z.utilities.setProtocolHandling(!this.state.protocolHandling),this.setState((e=>({protocolHandling:!e.protocolHandling})))};toggleCrashReportConsent=()=>{Ne.Z.set($.kVivaldiCrashReportingConsentGranted,!H.Z.get($.kVivaldiCrashReportingConsentGranted))};openPrivacyPage=()=>{d.ZP.openURL(this.context.vivaldiWindowId,h.fg)};render(){const e=this.props.prefValues;return p$(mN,{categoryTitle:(0,Oe.Z)("Privacy"),displayPrivacyLink:!0,filter:this.props.filter},void 0,p$("div",{className:"setting-group"},void 0,p$("div",{className:"setting-single"},void 0,p$("h3",{},void 0,(0,Oe.Z)("Tracking Prevention")),p$("label",{title:(0,Oe.Z)("Send “Do Not Track” directive to supporting websites")},void 0,p$("input",{type:"checkbox",checked:e[$.kEnableDoNotTrack],onChange:g$($.kEnableDoNotTrack)}),p$("span",{},void 0,(0,Oe.Z)("Ask Websites Not to Track Me")))),p$("div",{className:"setting-single"},void 0,p$("label",{title:"Reject advertisement on websites listed by Google as privacy offenders"},void 0,p$("input",{type:"checkbox",checked:e[$.kPrivacyAdverseAdBlockEnabled],onChange:g$($.kPrivacyAdverseAdBlockEnabled)}),p$("span",{},void 0,(0,Oe.Z)("Block Ads on Abusive Sites")))),p$("div",{className:"setting-single"},void 0,p$("label",{title:(0,Oe.Z)("Block tracking on links with a “ping” attribute or via navigator.sendBeacon")},void 0,p$("input",{type:"checkbox",checked:!e[$.kEnableHyperlinkAuditing],onChange:g$($.kEnableHyperlinkAuditing,"inverse")}),p$("span",{},void 0,(0,Oe.Z)("Block Hyperlink Audit Tracking")))),p$("div",{className:"setting-single"},void 0,p$("label",{title:(0,Oe.Z)("Web Real-Time Communication broadcast may leak IP address to services")},void 0,p$("input",{type:"checkbox",checked:this.webRTCAnnouncesIPs(),onChange:this.toggleChromePrivacyWebRTCChange}),p$("span",{},void 0,(0,Oe.Z)("Broadcast IP for Best WebRTC Performance"))))),p$("div",{className:"setting-group"},void 0,p$("h3",{},void 0,(0,Oe.Z)("Google Services")),p$("div",{className:"setting-single"},void 0,p$("label",{},void 0,p$("input",{type:"checkbox",checked:e[$.kSafeBrowsingEnabled],onChange:g$($.kSafeBrowsingEnabled)}),p$("span",{},void 0,(0,Oe.Z)("Phishing and Malware Protection")))),p$("div",{className:"setting-single"},void 0,p$("label",{},void 0,p$("input",{type:"checkbox",checked:e[$.kAlternateErrorPagesEnabled],onChange:g$($.kAlternateErrorPagesEnabled)}),p$("span",{},void 0,(0,Oe.Z)("DNS to Help Resolve Navigation Errors")))),p$("div",{className:"setting-single"},void 0,p$("label",{},void 0,p$("input",{type:"checkbox",checked:e[$.kPrivacyAutofillServerAssist],onChange:g$($.kPrivacyAutofillServerAssist)}),p$("span",{},void 0,(0,Oe.Z)("Form Autofill Assist"))))),p$("div",{className:"setting-group"},void 0,p$("h3",{},void 0,(0,Oe.Z)("Google Extensions")),p$("p",{className:"info"},void 0,(0,Oe.Z)("Browser restart is required for new settings to take effect.")),p$("div",{className:"setting-single"},void 0,p$("label",{},void 0,p$("input",{type:"checkbox",checked:e[$.kPrivacyGoogleComponentExtensionsHangoutServices],onChange:g$($.kPrivacyGoogleComponentExtensionsHangoutServices)}),p$("span",{},void 0,(0,Oe.Z)("Hangouts")))),p$("div",{className:"setting-single"},void 0,p$("label",{},void 0,p$("input",{type:"checkbox",checked:e[$.kPrivacyGoogleComponentExtensionsWebStore],onChange:g$($.kPrivacyGoogleComponentExtensionsWebStore)}),p$("span",{},void 0,(0,Oe.Z)("Web Store"))),p$("p",{className:"info"},void 0,(0,Oe.Z)("You will be unable to install extensions with this option disabled.")))),p$("div",{className:"setting-group"},void 0,p$("h3",{},void 0,(0,Oe.Z)("noun","Search")),p$("div",{className:"setting-single"},void 0,p$("label",{},void 0,p$("input",{type:"checkbox",checked:e[$.kAddressBarInlineSearchEnabled],onChange:g$($.kAddressBarInlineSearchEnabled)}),p$("span",{},void 0,(0,Oe.Z)("Search in Address Field")))),p$("div",{className:"setting-single"},void 0,p$("label",{},void 0,p$("input",{type:"checkbox",checked:e[$.kAddressBarInlineSearchSuggestEnabled],onChange:g$($.kAddressBarInlineSearchSuggestEnabled)}),p$("span",{},void 0,(0,Oe.Z)("Suggestions in Address Field")))),p$("div",{className:"setting-single"},void 0,p$("label",{},void 0,p$("input",{type:"checkbox",checked:e[$.kAddressBarSearchSuggestEnabled],onChange:g$($.kAddressBarSearchSuggestEnabled)}),p$("span",{},void 0,(0,Oe.Z)("Suggestions in Search Field"))))),p$("div",{className:"setting-group"},void 0,p$("div",{className:"setting-single"},void 0,p$("h3",{},void 0,(0,Oe.Z)("Show Typed History")),p$("div",{className:"setting-single"},void 0,p$("label",{},void 0,p$("input",{type:"checkbox",checked:e[$.kAddressBarTypedHistoryEnabled],onChange:g$($.kAddressBarTypedHistoryEnabled)}),p$("span",{},void 0,(0,Oe.Z)("radio","In Address Field")))),p$("div",{className:"setting-single"},void 0,p$("label",{},void 0,p$("input",{type:"checkbox",checked:e[$.kAddressBarSearchTypedHistoryEnabled],onChange:g$($.kAddressBarSearchTypedHistoryEnabled)}),p$("span",{},void 0,(0,Oe.Z)("radio","In Search Field")))))),p$(c$,{filter:this.props.filter}),p$("div",{className:"setting-group"},void 0,p$("div",{className:"setting-single"},void 0,p$("h3",{},void 0,(0,Oe.Z)("title","Autofill")),p$("label",{},void 0,p$("input",{type:"checkbox",checked:e[$.kAutofillProfileEnabled],onChange:g$($.kAutofillProfileEnabled)}),p$("span",{},void 0,(0,Oe.Z)("Form Autofill")))),p$("div",{className:"setting-single"},void 0,p$("label",{},void 0,p$("input",{type:"checkbox",checked:e[$.kAutofillCreditCardEnabled],onChange:g$($.kAutofillCreditCardEnabled)}),p$("span",{},void 0,(0,Oe.Z)("Credit Card Autofill"))))),p$("div",{className:"setting-group"},void 0,p$("div",{className:"setting-single"},void 0,p$("h3",{},void 0,(0,Oe.Z)("Private Windows")),p$("label",{},void 0,p$("input",{type:"checkbox",checked:e[$.kIncognitoShowIntro],onChange:g$($.kIncognitoShowIntro)}),p$("span",{},void 0,(0,Oe.Z)("Show Introduction"))))),p$("div",{className:"setting-group"},void 0,p$("div",{className:"setting-single"},void 0,p$("h3",{},void 0,(0,Oe.Z)("Protocol handling")),p$("label",{},void 0,p$("input",{type:"checkbox",checked:this.state.protocolHandling,onChange:this.toggleProtocolHandling}),p$("span",{},void 0,(0,Oe.Z)("Sites can ask to handle protocols")))),!1),p$("div",{className:"setting-group"},void 0,p$("h3",{},void 0,(0,Oe.Z)("Crash Reporting")),p$("div",{className:"setting-single"},void 0,p$("label",{},void 0,p$("input",{type:"checkbox",checked:H.Z.get($.kVivaldiCrashReportingConsentGranted),onChange:this.toggleCrashReportConsent}),p$("span",{},void 0,(0,Oe.Z)("Allow Vivaldi to Send Automatic Crash Reports"))),p$("p",{className:"info"},void 0,(0,Oe.Z)("Crash reports include the most recently visited webpage. It may send more personal information which is promptly deleted.")," ",p$(hb,{title:h.fg,onClick:this.openPrivacyPage},void 0,"Privacy policy")))))}}const f$=sa(v$,u$);var y$;function C$(e,t,n,s){y$||(y$="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:y$,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const w$={width:500,minWidth:"unset"};function b$(e){return e.map(((e,t)=>({key:t.toString(),name:e})))}class S$ extends hs.PureComponent{static contextType=xi.Z;state={canControl:ub.Z.getHasApiAccess()&&ub.Z.getHasToken(),connected:ub.Z.getIsConnected(),index:-1,items:b$(ub.Z.getBypassList(!1)),rule:"",showDialog:!1};componentDidMount(){ub.Z.addListener(this._onStoreChanged)}componentWillUnmount(){ub.Z.removeListener(this._onStoreChanged)}_onStoreChanged=()=>{this.setState({canControl:ub.Z.getHasApiAccess()&&ub.Z.getHasToken(),connected:ub.Z.getIsConnected(),items:b$(ub.Z.getBypassList(!1))})};_onNew=()=>{this.setState({showDialog:!0,rule:"",index:-1})};_onDelete=e=>{const t=this.state.items.map(((t,n)=>{if(n!==e)return t.name})).filter(Boolean);xn.Z.setBypassList(t)};_onActivate=e=>{this.setState((t=>({showDialog:!0,rule:t.items[e].name,index:e})))};_onDialogUpdate=e=>{this.setState({rule:e.currentTarget.value})};_onDialogSave=()=>{const e=this.state.rule.trim();if(e){const t=this.state.items.map((e=>e.name));-1===this.state.index?t.push(e):t.splice(this.state.index,1,e),xn.Z.setBypassList(t),this._onDialogClose()}};_onDialogClose=()=>{this.setState({showDialog:!1,index:-1})};_renderDialog=()=>C$(_r.Z,{style:w$,onRequestClose:this._onDialogClose,viewMode:"float"},void 0,C$("form",{className:"ContentBlocker-Exception"},void 0,C$("header",{className:"dialog-header"},void 0,C$("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("Add URL Rule to Bypass Proxy"))),C$("div",{className:"dialog-content"},void 0,C$("input",{type:"text",name:"name",placeholder:(0,Oe.Z)("e.g. example.com, or *.example.com"),value:this.state.rule,onChange:this._onDialogUpdate,autoFocus:!0})),C$("footer",{className:"dialog-footer"},void 0,C$("input",{type:"submit",className:"primary",onClick:this._onDialogSave,value:(0,Oe.Z)("other","Add URL")}),C$("input",{type:"button",onClick:this._onDialogClose,value:(0,Oe.Z)("Cancel")}))));_renderItem=(e,t)=>C$("span",{},void 0,e);render(){return C$(mN,{categoryTitle:(0,Oe.Z)("title","Privacy Guard"),"data-anchor":"proxy_bypass",filter:this.props.filter},void 0,this.state.showDialog&&this._renderDialog(),C$("div",{className:"setting-group setting-group-double"},void 0,C$("h3",{},void 0,(0,Oe.Z)("Privacy Guard Exceptions")),C$("p",{className:"info"},void 0,(0,Oe.Z)("A list of domains to bypass the Privacy Guard proxy connection.")),C$(x_.Z,{items:this.state.items,renderListItem:this._renderItem,filter:this.props.filter,onCreateItem:this._onNew,onRemove:this._onDelete,addTipString:(0,Oe.Z)("Add Domain"),deleteTipString:(0,Oe.Z)("Remove Domain"),supportDragAndDrop:!1,onActivate:this._onActivate,emptyListString:(0,Oe.Z)("Exception list is empty."),emptyListGraphic:Ts.T4m.small})))}}const I$=S$;var k$=n(87159),A$=n(5422);const T$=[{key:"CALCULATOR",name:(0,Oe.Z)("Calculator"),pref:$.kQuickCommandsShowCalculator},{key:"NORMAL_COMMAND",name:(0,Oe.Z)("Commands")},{key:"COMMAND_CHAIN",name:(0,Oe.Z)("Command Chains")},{key:"KEYWORD_SEARCH",name:(0,Oe.Z)("Web Search & URL Entry")},{key:"WORKSPACES",name:(0,Oe.Z)("Workspaces")},{key:"OPEN_TABS",name:(0,Oe.Z)("Open Tabs")},{key:"BOOKMARK_ITEM_OR_FOLDER",name:(0,Oe.Z)("Bookmarks"),pref:$.kQuickCommandsShowBookmarks},{key:"READING_LIST",name:(0,Oe.Z)("Reading List"),pref:$.kQuickCommandsShowReadingList},{key:"NOTES_SEARCH",name:(0,Oe.Z)("Notes"),pref:$.kQuickCommandsShowNotes},{key:"HISTORY",name:(0,Oe.Z)("Browsing History"),pref:$.kQuickCommandsShowHistory},{key:"EXTENSIONS",name:(0,Oe.Z)("Extensions"),pref:$.kQuickCommandsShowExtensions},{key:"PAGE_ACTIONS",name:(0,Oe.Z)("Page Actions"),pref:$.kQuickCommandsShowPageActions},{key:"CLOSED_TABS",name:(0,Oe.Z)("Closed Tabs")}];var Z$;function E$(e,t,n,s){Z$||(Z$="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Z$,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const _$=[$.kActions,$.kQuickCommandsKeepValue,$.kQuickCommandsOpenUrlInNewTab,$.kQuickCommandsSearchEnglish,$.kQuickCommandsMatchNickname,$.kQuickCommandsLimitResults,$.kQuickCommandsSearchPriority,$.kQuickCommandsShowBookmarks,$.kQuickCommandsShowCalculator,$.kQuickCommandsShowExtensions,$.kQuickCommandsShowHistory,$.kQuickCommandsShowPageActions,$.kQuickCommandsShowNotes,$.kQuickCommandsShowReadingList,$.kQuickCommandsUseNotesManager,$.kWorkspacesEnabled],M$=Ne.Z.getEventHandler;function N$(e){const t=H.Z.get($.kWorkspacesEnabled);return e.filter((e=>t||"WORKSPACES"!==e)).map((e=>({key:e,name:T$.find((t=>t.key===e))?.name||""})))}var P$=E$("br",{});class D$ extends hs.Component{renderListItem=(e,t)=>{const n=T$.find((e=>e.key===t.key))?.pref,s=n&&this.props.prefValues[n];return(0,fs.jsxs)(fs.Fragment,{children:[n?E$("input",{type:"checkbox",value:t.key,checked:s,onChange:M$(n)}):E$("span",{style:{width:16}}),t.name]})};resetList=()=>{Ne.Z.reset($.kQuickCommandsSearchPriority)};moveItem=(e,t)=>{const n=this.props.prefValues[$.kQuickCommandsSearchPriority].map((e=>e)),s=n.splice(e,1)[0];n.splice(t,0,s),Ne.Z.set($.kQuickCommandsSearchPriority,n)};render(){const e=this.props.prefValues,t=e[$.kActions][0].COMMAND_SHOW_QUICK_COMMANDS.shortcuts||[];return(0,fs.jsxs)(fs.Fragment,{children:[E$(mN,{categoryTitle:(0,Oe.Z)("Quick Commands"),filter:this.props.filter},void 0,E$("div",{className:"info"},void 0,t.length>0&&(0,fs.jsxs)(fs.Fragment,{children:[(0,Oe.Z)("Open Quick Commands with:")," ",E$("span",{className:"shortcut"},void 0,t.map((e=>E$("kbd",{},e,(0,tu.$)(e))))),P$,(0,Oe.Z)("Press $1 or $2 keys with $3 modifier to skip to next search result section. Press $4 key to auto-complete input from current list selection.",[(0,tu.$)("Down"),(0,tu.$)("Up"),(0,tu.$)("Alt"),(0,tu.$)("Right")])]})),E$("div",{className:"setting-group setting-group-double"},void 0,E$("div",{className:"setting-single list-priority"},void 0,E$("h3",{},void 0,(0,Oe.Z)("Search Types and Priority")),E$("p",{className:"info"},void 0,(0,Oe.Z)("Select data types to include in Quick Command search results. Reorder the list to change default search highlight priority.")),E$(x_.Z,{filter:this.props.filter,items:N$(e[$.kQuickCommandsSearchPriority]),moveItem:this.moveItem,renderListItem:this.renderListItem,supportDragAndDrop:!0,mimeType:"vivaldi/x-settings-quick-command-type"}),E$("input",{type:"button",onClick:this.resetList,value:(0,Oe.Z)("Reset Priority")}))),E$("div",{className:"setting-group setting-group-double"},void 0,E$("h3",{},void 0,(0,Oe.Z)("Quick Command Options")),E$("div",{className:"setting-single"},void 0,E$("label",{},void 0,E$("input",{type:"checkbox",checked:e[$.kQuickCommandsKeepValue],onChange:M$($.kQuickCommandsKeepValue)}),E$("span",{},void 0,(0,Oe.Z)("Keep Last Typed Value")))),E$("div",{className:"setting-single"},void 0,E$("label",{},void 0,E$("input",{type:"checkbox",checked:e[$.kQuickCommandsLimitResults],onChange:M$($.kQuickCommandsLimitResults)}),E$("span",{},void 0,(0,Oe.Z)("Limit Number of Visible Search Results")))),!navigator.language.startsWith("en")&&E$("div",{className:"setting-single"},void 0,E$("label",{},void 0,E$("input",{type:"checkbox",checked:e[$.kQuickCommandsSearchEnglish],onChange:M$($.kQuickCommandsSearchEnglish)}),E$("span",{},void 0,(0,Oe.Z)("Include English Search Terms"))),E$("p",{className:"info"},void 0,(0,Oe.Z)("Include English equivalent of command names in search results"))),E$("div",{className:"setting-single"},void 0,E$("label",{},void 0,E$("input",{type:"checkbox",checked:e[$.kQuickCommandsOpenUrlInNewTab],onChange:M$($.kQuickCommandsOpenUrlInNewTab)}),E$("span",{},void 0,(0,Oe.Z)("Open Links in New Tab")))),E$("div",{className:"setting-single"},void 0,E$("label",{},void 0,E$("input",{type:"checkbox",checked:e[$.kQuickCommandsMatchNickname],onChange:M$($.kQuickCommandsMatchNickname)}),E$("span",{},void 0,(0,Oe.Z)("Open Bookmarks on Nickname Match")))),E$("div",{className:"setting-single"},void 0,E$("label",{},void 0,E$("input",{type:"checkbox",checked:e[$.kQuickCommandsUseNotesManager],onChange:M$($.kQuickCommandsUseNotesManager)}),E$("span",{},void 0,(0,Oe.Z)("Open Notes in Notes Manager")))))),E$(mN,{categoryTitle:(0,Oe.Z)("Command Chains"),filter:this.props.filter},void 0,E$(A$.Z,{filter:this.props.filter,category:this.props.category}))]})}}const x$=sa(D$,_$);var O$;function L$(e,t,n,s){O$||(O$="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:O$,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const R$=["keyboard","mouse","chromalink","mousemat","headset"],B$=[$.kRazerChromaDevices,$.kRazerChromaEnabled],F$=[{device:"keyboard",text:(0,Oe.Z)("Keyboard")},{device:"mouse",text:(0,Oe.Z)("Mouse")},{device:"mousemat",text:(0,Oe.Z)("Mouse Mat")},{device:"headset",text:(0,Oe.Z)("Headset")},{device:"chromalink",text:(0,Oe.Z)("Chroma Link")}];class V$ extends hs.Component{constructor(e){super(e)}isDeviceEnabled=(e,t)=>e.findIndex((e=>e===t))>-1;onChromaEnabled=e=>{const t=e.target.checked;Ne.Z.set($.kRazerChromaEnabled,t)};onDeviceChecked=(e,t)=>{const n=t.target.checked,s=this.props.prefValues[$.kRazerChromaDevices],i=R$.filter((t=>e===t?n:this.isDeviceEnabled(s,t)));Ne.Z.set($.kRazerChromaDevices,i)};renderDeviceList(){const e=this.props.prefValues[$.kRazerChromaDevices];return F$.map((t=>L$("div",{className:"setting-single pad-left"},t.device,L$("label",{},void 0,L$("input",{type:"checkbox",disabled:!this.props.prefValues[$.kRazerChromaEnabled],checked:Boolean(this.isDeviceEnabled(e,t.device)),onChange:this.onDeviceChecked.bind(this,t.device)}),L$("span",{},void 0,t.text)))))}render(){return L$(mN,{categoryTitle:(0,Oe.Z)("Razer Chroma Theme Integration"),filter:this.props.filter},void 0,L$("div",{className:"setting-group"},void 0,L$("div",{className:"setting-single"},void 0,L$("label",{},void 0,L$("input",{type:"checkbox",checked:this.props.prefValues[$.kRazerChromaEnabled],onChange:this.onChromaEnabled}),L$("span",{},void 0,(0,Oe.Z)("Enable Razer Chroma Integration"))),L$("p",{className:"info"},void 0,(0,Oe.Z)("Requires Razer Chroma enabled devices connected to the local machine."))),this.renderDeviceList()))}}const W$=sa(V$,B$);var U$;function H$(e,t,n,s){U$||(U$="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:U$,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const z$=Ne.Z.getEventHandler,G$=[$.kKeyboardTabToAll,$.kWebpagesReaderAllowVertical,$.kWebpagesReaderControls,$.kWebpagesReaderStyle],$$=["ja","ja-KS","ko","zh-CN","zh-TW"].includes(navigator.language),K$={min:.5,max:4,step:.1},j$={min:1,max:2,step:.1},Y$={min:20,max:100,step:2};var X$=H$("hr",{}),Q$=H$("hr",{}),q$=H$("hr",{}),J$=H$("hr",{}),eK=H$("hr",{}),tK=H$("hr",{});class nK extends hs.Component{static contextType=xi.Z;constructor(e,t){super(e),this.state={isOpen:!1,colorFg:String(z.Z.getReaderThemeColor(t.vivaldiWindowId)["--colorFg"])}}componentDidMount(){z.Z.addListener(this.onThemeStoreChanged)}onThemeStoreChanged=()=>{this.setState({colorFg:String(z.Z.getReaderThemeColor(this.context.vivaldiWindowId)["--colorFg"])})};componentWillUnmount(){z.Z.removeListener(this.onThemeStoreChanged)}setTheme=e=>()=>{this.setStyle({themeStyle:e})};setFontFamily=e=>()=>{this.setStyle({fontFamily:e})};setLineHeight=e=>()=>{const t=this.props.prefValues[$.kWebpagesReaderStyle],{step:n}=j$,s=(t.lineHeight+("increment"===e?n:-n)).toFixed(1);this.setStyle({lineHeight:parseFloat(s)})};setFontSize=e=>()=>{const t=this.props.prefValues[$.kWebpagesReaderStyle],{step:n}=K$,s=(t.fontSize+("increment"===e?n:-n)).toFixed(1);this.setStyle({fontSize:parseFloat(s)})};setWidth=e=>()=>{const t=this.props.prefValues[$.kWebpagesReaderStyle],{step:n}=Y$;this.setStyle({width:t.width+("increment"===e?n:-n)})};setDirection=e=>()=>{this.setStyle({writingMode:e})};setStyle=(0,oS.Z)((e=>{Ne.Z.set($.kWebpagesReaderStyle,{...this.props.prefValues[$.kWebpagesReaderStyle],...e}),Un.Z.setReaderModeStyle(this.context.vivaldiWindowId)}),300,{leading:!0,trailing:!0});toggleControls=()=>{this.setState((e=>({isOpen:!e.isOpen})))};canFontGrow=()=>this.props.prefValues[$.kWebpagesReaderStyle].fontSize<K$.max;canFontShrink=()=>this.props.prefValues[$.kWebpagesReaderStyle].fontSize>K$.min;canLineHeightGrow=()=>this.props.prefValues[$.kWebpagesReaderStyle].lineHeight<j$.max;canLineHeightShrink=()=>this.props.prefValues[$.kWebpagesReaderStyle].lineHeight>j$.min;canColumnGrow=()=>this.props.prefValues[$.kWebpagesReaderStyle].width<Y$.max;canColumnShrink=()=>this.props.prefValues[$.kWebpagesReaderStyle].width>Y$.min;render(){const e=this.props.prefValues[$.kWebpagesReaderAllowVertical],t=this.props.prefValues[$.kWebpagesReaderStyle],n="vertical-rl"===t.writingMode;if(this.props.prefs&&t){const n=(0,fs.jsxs)(fs.Fragment,{children:[H$("h2",{},void 0,(0,Oe.Z)("Reader")),H$("div",{className:"setting-group-unlimited"},void 0,H$("div",{className:"setting-single"},void 0,H$("label",{},void 0,H$("input",{type:"checkbox",checked:this.props.prefValues[$.kWebpagesReaderControls],onChange:z$($.kWebpagesReaderControls)}),H$("span",{},void 0,(0,Oe.Z)("Display Settings on Page in Reader")))),!$$&&H$("div",{className:"setting-single"},void 0,H$("label",{},void 0,H$("input",{type:"checkbox",checked:e,onChange:z$($.kWebpagesReaderAllowVertical)}),H$("span",{},void 0,(0,Oe.Z)("Allow Vertical Text Direction"))))),H$("div",{className:"setting-group pad-top"},void 0,H$("div",{className:"setting-single"},void 0,H$("h3",{},void 0,(0,Oe.Z)("Font Face")),H$("div",{className:"toolbar toolbar-default"},void 0,H$("div",{className:"toolbar toolbar-group"},void 0,H$(Fa,{title:(0,Oe.Z)("Sans-serif"),image:Ts.g4W.medium,isPressed:"sans-serif"===t.fontFamily,onClick:this.setFontFamily("sans-serif")}),X$,H$(Fa,{title:(0,Oe.Z)("Serif"),image:Ts.USP.medium,isPressed:"serif"===t.fontFamily,onClick:this.setFontFamily("serif")})))),H$("div",{className:"setting-single"},void 0,H$("h3",{},void 0,(0,Oe.Z)("Font Size")),H$(RB,{label:Math.round(100*t.fontSize)+" %",value:t.fontSize,min:K$.min,max:K$.max,step:K$.step,onChange:e=>this.setStyle({fontSize:Number(e.currentTarget.value)})})),H$("div",{className:"setting-single"},void 0,H$("h3",{},void 0,(0,Oe.Z)("Line Height")),H$(RB,{value:t.lineHeight,min:j$.min,max:j$.max,step:j$.step,onChange:e=>this.setStyle({lineHeight:Number(e.currentTarget.value)})})),H$("div",{className:"setting-single"},void 0,H$("h3",{},void 0,(0,Oe.Z)("Column Width")),H$(RB,{value:t.width,min:Y$.min,max:Y$.max,step:Y$.step,onChange:e=>this.setStyle({width:Number(e.currentTarget.value)})})),H$("div",{className:"setting-single"},void 0,H$("input",{type:"button",value:(0,Oe.Z)("Reset to Defaults"),onClick:()=>Un.Z.resetReaderModeStyle(this.context.vivaldiWindowId)}))),H$("div",{className:"setting-group pad-top"},void 0,H$("div",{className:"setting-single"},void 0,H$("h3",{},void 0,(0,Oe.Z)("Color Scheme")),H$("div",{className:"toolbar toolbar-default"},void 0,H$("div",{className:"toolbar toolbar-group"},void 0,H$(Fa,{title:(0,Oe.Z)("other","Light"),image:Ts.XQw.medium,onClick:this.setTheme("light"),isPressed:"light"===t.themeStyle,buttonStyle:{"--kIconCircleFill":"#f6f6f6","--kIconCircleStroke":"var(--colorFg)"}}),Q$,H$(Fa,{title:(0,Oe.Z)("other","Dark"),image:Ts.XQw.medium,onClick:this.setTheme("dark"),isPressed:"dark"===t.themeStyle,buttonStyle:{"--kIconCircleFill":"#111111","--kIconCircleStroke":"var(--colorFg)"}}),q$,H$(Fa,{title:(0,Oe.Z)("other","Theme"),image:Ts.XQw.medium,isPressed:"theme"===t.themeStyle,onClick:this.setTheme("theme"),buttonStyle:{"--kIconCircleFill":"var(--colorBgLight)","--kIconCircleStroke":"var(--colorHighlightBg)"}})))),($$||e)&&H$("div",{className:"setting-single"},void 0,H$("h3",{},void 0,(0,Oe.Z)("Text Direction")),H$("div",{className:"toolbar toolbar-default"},void 0,H$("div",{className:"toolbar toolbar-group"},void 0,H$(Fa,{tooltip:(0,Oe.Z)("Horizontal Text"),title:(0,Oe.Z)("title","Horizontal"),onClick:this.setDirection("unset"),isPressed:"vertical-rl"!==t.writingMode,image:Ts.weK,disabled:!($$||e)}),H$(Fa,{tooltip:(0,Oe.Z)("Vertical Text"),title:(0,Oe.Z)("title","Vertical"),isPressed:"vertical-rl"===t.writingMode,onClick:this.setDirection("vertical-rl"),image:Ts.lIQ,disabled:!($$||e)})))))]});return(0,Vl.ZP)(n,this.props.filter)}return(0,fs.jsxs)(fs.Fragment,{children:[H$(ga.Z,{classNames:"reader-toolbar",in:this.state.isOpen,mountOnEnter:!0,unmountOnExit:!0,timeout:{enter:300,exit:150}},"toolbar",H$("div",{className:"toolbar toolbar-default reader-toolbar"},void 0,H$("div",{className:"toolbar-group"},void 0,H$(Fa,{tooltip:(0,Oe.Z)("Sans-serif"),image:Ts.g4W.medium,isPressed:"sans-serif"===t.fontFamily,onClick:this.setFontFamily("sans-serif")}),H$(Fa,{tooltip:(0,Oe.Z)("Serif"),image:Ts.USP.medium,buttonStyle:{fontFamily:"serif"},isPressed:"serif"===t.fontFamily,onClick:this.setFontFamily("serif")})),H$("div",{className:"toolbar-group"},void 0,H$(Fa,{className:"decrease-font-size",tooltip:(0,Oe.Z)("Decrease font size"),image:Ts.g4W.medium,disabled:!this.canFontShrink(),onClick:this.setFontSize("decrement")}),J$,H$(Fa,{className:"increase-font-size",tooltip:(0,Oe.Z)("Increase font size"),image:Ts.g4W.medium,disabled:!this.canFontGrow(),onClick:this.setFontSize("increment")})),H$("div",{className:"toolbar-group"},void 0,H$(Fa,{className:n?"button-rotateimage":"",tooltip:(0,Oe.Z)("Tighten line spacing"),disabled:!this.canLineHeightShrink(),onClick:this.setLineHeight("decrement"),image:Ts.sss}),eK,H$(Fa,{className:n?"button-rotateimage":"",tooltip:(0,Oe.Z)("Loosen line spacing"),disabled:!this.canLineHeightGrow(),onClick:this.setLineHeight("increment"),image:Ts.zDC})),H$("div",{className:"toolbar-group"},void 0,H$(Fa,{className:n?"button-rotateimage":"",tooltip:(0,Oe.Z)("Shrink column"),disabled:!this.canColumnShrink(),onClick:this.setWidth("decrement"),image:Ts.Gpq}),tK,H$(Fa,{className:n?"button-rotateimage":"",tooltip:(0,Oe.Z)("Grow column"),disabled:!this.canColumnGrow(),onClick:this.setWidth("increment"),image:Ts.Fib})),($$||e)&&H$("div",{className:"toolbar-group"},void 0,H$(Fa,{tooltip:(0,Oe.Z)("Horizontal Text"),isPressed:"vertical-rl"!==t.writingMode,onClick:this.setDirection("unset"),image:Ts.weK}),H$(Fa,{tooltip:(0,Oe.Z)("Vertical Text"),isPressed:"vertical-rl"===t.writingMode,onClick:this.setDirection("vertical-rl"),image:Ts.lIQ})),H$("div",{className:"toolbar-group"},void 0,H$(Fa,{tooltip:(0,Oe.Z)("other","Light"),image:Ts.XQw.medium,onClick:this.setTheme("light"),isPressed:"light"===t.themeStyle,buttonStyle:{"--kIconCircleFill":"white","--kIconCircleStroke":"var(--colorFg)"}}),H$(Fa,{tooltip:(0,Oe.Z)("other","Dark"),image:Ts.XQw.medium,onClick:this.setTheme("dark"),image:Ts.XQw.medium,isPressed:"dark"===t.themeStyle,buttonStyle:{"--kIconCircleFill":"black","--kIconCircleStroke":"var(--colorFg)"}}),H$(Fa,{tooltip:(0,Oe.Z)("other","Inherit Theme"),image:Ts.XQw.medium,isPressed:"theme"===t.themeStyle,onClick:this.setTheme("theme"),buttonStyle:{"--kIconCircleFill":"var(--colorBgLight)","--kIconCircleStroke":"var(--colorHighlightBg)"}})))),H$(Fa,{buttonStyle:this.state.isOpen?void 0:{fill:this.state.colorFg},className:"reader-settings-toggle",onClick:this.toggleControls,tooltip:(0,Oe.Z)("Reader settings"),image:Ts.bqs.medium},"reader-settings-toggle")]})}}const sK=sa(nK,G$);var iK;function oK(e,t,n,s){iK||(iK="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:iK,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const aK={width:400,minWidth:"unset"};class rK extends hs.Component{state={confirmation:!1};resetSection=()=>{this.props.prefPaths?.length>0&&this.props.prefPaths.forEach((e=>{Ne.Z.reset(e)})),this.setState({confirmation:!1})};onCancel=()=>{this.setState({confirmation:!1})};askConfirmation=()=>{this.setState({confirmation:!0})};renderConfirmation=e=>oK(_r.Z,{style:aK,viewMode:"float",onRequestClose:this.onCancel},void 0,oK("div",{className:"dialog-restore-settings"},void 0,oK("header",{className:"dialog-header"},void 0,oK("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("Reset $1 Settings to Default?",[e]))),oK("div",{className:"dialog-content"},void 0,oK("p",{},void 0,(0,Oe.Z)("All settings in the “$1” section will be reset to default values.",[e]))),oK("footer",{className:"dialog-footer"},void 0,oK("input",{type:"button",className:"danger",onClick:this.resetSection,value:(0,Oe.Z)("command","Reset Settings")}),oK("input",{type:"button",onClick:this.onCancel,value:(0,Oe.Z)("Cancel"),autoFocus:!0}))));render(){return this.props.prefPaths?.length?oK(mN,{categoryTitle:(0,Oe.Z)("title","Reset Settings"),filter:this.props.filter},void 0,this.state.confirmation&&this.renderConfirmation(this.props.name),oK("div",{className:"setting-group"},void 0,oK("div",{className:"setting-single"},void 0,oK("input",{type:"button",value:(0,Oe.Z)("Reset $1 Settings to Default",[this.props.name]),onClick:this.askConfirmation}),oK("p",{className:"info"},void 0,(0,Oe.Z)("This will reset the settings in this section to default values."))))):null}}const lK=rK;class dK extends hs.Component{state={confirmation:!1};resetSettings=()=>{vivaldi.prefs.resetAllToDefault([kMailAccounts,kMailIsTurnedOff,kMailRefreshTokens]),this.setState({confirmation:!1}),vivaldi.runtimePrivate.restart()};onCancel=()=>{this.setState({confirmation:!1})};askConfirmation=()=>{this.setState({confirmation:!0})};renderConfirmation=()=>ResetSettings_jsx(Modal,{style:ResetSettings_MODAL_STYLE,viewMode:"float",onRequestClose:this.onCancel},void 0,ResetSettings_jsx("div",{className:"dialog-reset-settings"},void 0,ResetSettings_jsx("header",{className:"dialog-header"},void 0,ResetSettings_jsx("h1",{className:"dialog-title"},void 0,_("Reset All Settings to Default?"))),ResetSettings_jsx("div",{className:"dialog-content"},void 0,ResetSettings_jsx("p",{},void 0,_("Settings will be reset to default values and the browser will restart. Mail accounts are not removed."))),ResetSettings_jsx("footer",{className:"dialog-footer"},void 0,ResetSettings_jsx("input",{type:"button",className:"danger",onClick:this.resetSettings,value:_("Reset All Settings And Restart")}),ResetSettings_jsx("input",{type:"button",onClick:this.onCancel,value:_("Cancel"),autoFocus:!0}))));render(){return ResetSettings_jsx(SettingsSearchCategory,{categoryTitle:_("Reset All Settings"),filter:this.props.filter},void 0,this.state.confirmation&&this.renderConfirmation(),ResetSettings_jsx("div",{className:"setting-group"},void 0,ResetSettings_jsx("div",{className:"setting-single"},void 0,ResetSettings_jsx("input",{type:"button",value:_("Reset All Settings to Default"),onClick:this.askConfirmation}),ResetSettings_jsx("p",{className:"info"},void 0,_("This will reset the all settings to default values. Mail accounts are not removed.")))))}}var cK;function hK(e,t,n,s){cK||(cK="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:cK,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var pK=hK("span",{},void 0,"•••••••");class uK extends hs.Component{render(){const{origin:e,username:t,password:n}=this.props.savedPassword,{columns:s}=this.props;if(s.length<1||!this.props.savedPassword)return null;var i=hK(Ss,{url:e,loadType:"page"}),o=hK("span",{},void 0,e),a=hK("input",{type:"text",value:t,tabIndex:-1,readOnly:!0}),r=hK("input",{type:"text",value:n,tabIndex:-1,readOnly:!0});return s.map(((t,n)=>{switch(t.id){case"origin":return hK("label",{},t.id+"__"+n,hK("span",{className:"site-icon",onDoubleClick:this.props.openLink.bind(null,e),title:(0,Oe.Z)("Double-click to visit $1",[e])},void 0,i),o);case"username":return hK("label",{},t.id+"__"+n,a);case"password":return hK("div",{},t.id+"__"+n,hK("label",{},void 0,this.props.showPassword?r:pK),hK("button",{type:"button",className:"listcontrol",title:this.props.showPassword?(0,Oe.Z)("Hide password"):(0,Oe.Z)("other","Show password"),tabIndex:-1,onClick:this.props.togglePassword.bind(null,this.props.savedPassword.index),dangerouslySetInnerHTML:{__html:Ts.sgm.medium}}));default:return null}}))}}const gK=uK;class mK extends hs.PureComponent{static contextType=xi.Z;_passwordTree=hs.createRef();state={visiblePasswords:[]};componentDidMount(){this._passwordTree.current&&this._passwordTree.current.focusTree()}togglePassword=e=>{C.Z.savedpasswords.authenticate(this.context.vivaldiWindowId,(t=>{t&&this._onShowPassword(e)}))};_onShowPassword=e=>{this.setState((t=>{const n=t.visiblePasswords.slice(0);return n.includes(e)?n.splice(n.indexOf(e),1):n.push(e),{visiblePasswords:n}}))};onPasswordDeleted=e=>{this.state.visiblePasswords.includes(e)&&this.setState((t=>{const n=t.visiblePasswords.slice(0);return n.splice(n.indexOf(e),1),{visiblePasswords:n}}))};openLink=e=>{d.ZP.openURL(this.context.vivaldiWindowId,e)};copyPassword=e=>{C.Z.savedpasswords.authenticate(this.context.vivaldiWindowId,(t=>{t&&yi.Z.set(e)}))};getContextMenuItems=e=>{const t=this.state.visiblePasswords.includes(e.index);return[{handler:this.togglePassword.bind(null,e.index),isVisible:()=>t,...(0,xs.Z)("Hide Password")},{handler:this.togglePassword.bind(null,e.index),isVisible:()=>!t,...(0,xs.Z)("Show Password")},ae.Z.separatorItem,{handler:this.copyPassword.bind(null,e.password),...(0,xs.Z)("Copy Password")},{handler:yi.Z.set.bind(null,e.username),...(0,xs.Z)("Copy Account Name")},{handler:this.openLink.bind(null,e.origin),isVisible:()=>(0,vs.q9)(e.origin).startsWith("http"),...(0,xs.Z)("Visit Page")},ae.Z.separatorItem,{handler:this.props.onDelete.bind(null,e),...(0,xs.Z)("Delete Password")}]};onKeyDown=e=>{if(!this._passwordTree.current)return;const t=this._passwordTree.current.getSelectedItem();if(t)switch(e.key){case"Delete":case"Backspace":this.props.onDelete(t);break;case" ":e.preventDefault(),this.togglePassword(t.index);break;case"Enter":this.openLink(t.origin)}};onMouseDown=()=>{this._passwordTree.current&&this._passwordTree.current.focusTree()};getRowComponentProps=e=>({columns:this.props.columns,savedPassword:e.node,showPassword:this.state.visiblePasswords.includes(e.node.index),togglePassword:this.togglePassword,openLink:this.openLink});render(){return(0,fs.jsx)(yo,{ref:this._passwordTree,rowComponent:gK,getRowComponentProps:this.getRowComponentProps,nodes:this.props.nodes,enableDragAndDrop:!1,onItemMouseDown:this.onMouseDown,onItemDoubleClick:Aa.Z,onKeyDown:this.onKeyDown,getContextMenuItems:this.getContextMenuItems,isFolder:xE.Z,disableClipboard:!0,hasChildren:xE.Z,sorting:this.props.sorting,columns:this.props.columns,multiSelect:!1})}}const vK=mK;var fK;function yK(e,t,n,s){fK||(fK="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:fK,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const CK=s.Z.passwordsPrivate.onPasswordsFileExportProgress,wK=[$.kCredentialsEnableService],bK=Ne.Z.getEventHandler,SK="passwords",IK={width:400,minWidth:"unset"},kK=[{text:(0,Oe.Z)("Website"),value:"origin",fullScreenTitle:(0,Oe.Z)("Sort by website"),width:300,visible:!0,key:!0},{text:(0,Oe.Z)("title","Account Name"),value:"username",fullScreenTitle:(0,Oe.Z)("Sort by account name"),width:160,visible:!0},{text:(0,Oe.Z)("Password"),value:"password",fullScreenTitle:(0,Oe.Z)("Sort by password"),width:160,visible:!0}];class AK extends hs.Component{passwordTree=hs.createRef();constructor(e){super(e);const t=io().passwords;this.state={savedPasswordsData:[],confirmation:!1,toRemove:null,siteFilter:"",passwordsVisible:!1,columns:t||oo(kK),sorting:{sortOrder:1,sortField:"manually",comparator:this.sortComparator},exportStatus:"NOT_STARTED"}}componentDidMount(){this.getSavedPassords(),CK.addListener(this.exportProgress),s.Z.extension.inIncognitoContext||C.Z.savedpasswords.createDelegate()}componentWillUnmount(){CK.removeListener(this.exportProgress)}sortComparator=(e,t)=>e.index<t.index?1:-1;onSortChange=(e,t)=>{this.setState({sorting:{sortOrder:e,sortField:t}})};onUpdateRow=e=>this.setState({columns:e});onSaveRow=()=>so(this.state.columns,SK);exportProgress=e=>{this.setState({exportStatus:e.status})};getSavedPassords=()=>C.Z.savedpasswords.getList((e=>{this.setState({savedPasswordsData:e})}));deleteSavedPassword=()=>{const e=this.state.toRemove;e&&(C.Z.savedpasswords.remove(e.index,(()=>{this.passwordTree.current&&this.passwordTree.current.onPasswordDeleted(e.index),this.getSavedPassords()})),this.setState({confirmation:!1,toRemove:null}))};onAskToDelete=e=>this.setState({confirmation:!0,toRemove:e});onCancel=()=>this.setState({confirmation:!1,toRemove:null});togglePasswordList=()=>this.setState((e=>({passwordsVisible:!e.passwordsVisible,siteFilter:""})));exportPasswords=()=>{s.Z.passwordsPrivate.exportPasswords((()=>{}))};filterEntries=e=>this.setState({siteFilter:e.target.value});getHostName=()=>{const e=this.state.toRemove;if(!e)return null;return(0,ms.Z)(e.origin)?.hostname};renderDeleteConfirmationModal=()=>{const e=this.state.toRemove;if(!e)return null;const t=this.getHostName();return yK(_r.Z,{viewMode:"float",onRequestClose:this.onCancel,style:IK},void 0,yK("div",{className:"dialog-delete-password"},void 0,yK("header",{className:"dialog-header"},void 0,yK("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("Delete password for $1?",[t||e.origin]))),yK("div",{className:"dialog-content"},void 0,yK("p",{},void 0,(0,Oe.Z)("Password for user “$1” on page “$2” will be removed.",[e.username,e.origin]))),yK("footer",{className:"dialog-footer"},void 0,yK("input",{type:"button",className:"primary",onClick:this.deleteSavedPassword,value:(0,Oe.Z)("other","Delete"),autoFocus:!0}),yK("input",{type:"button",onClick:this.onCancel,value:(0,Oe.Z)("Cancel")}))))};render(){const{siteFilter:e}=this.state,t=e.toLowerCase(),n=this.state.savedPasswordsData.filter((e=>e.username.toLowerCase().includes(t)||e.origin.toLowerCase().includes(t)));return yK(mN,{categoryTitle:(0,Oe.Z)("Passwords"),filter:this.props.filter,className:"saved-passwords setting-group unlimited"},void 0,this.state.confirmation&&this.renderDeleteConfirmationModal(),yK("div",{className:"setting-group unlimited"},void 0,yK("div",{className:"setting-single"},void 0,yK("label",{},void 0,yK("input",{type:"checkbox",onChange:bK($.kCredentialsEnableService),checked:this.props.prefValues[$.kCredentialsEnableService]}),yK("span",{},void 0,(0,Oe.Z)("Save Webpage Passwords")))),this.state.passwordsVisible&&yK("div",{className:"setting-single"},void 0,yK("input",{type:"search",defaultValue:"",placeholder:(0,Oe.Z)("Filter Passwords"),onChange:this.filterEntries})),this.state.passwordsVisible&&yK("div",{className:"saved-passwords-tree"},void 0,yK(gv,{fields:kK,fullsize:!0,onSortChange:this.onSortChange,onSaveRow:this.onSaveRow,onUpdateRow:this.onUpdateRow,columns:this.state.columns,sortField:this.state.sorting.sortField,sortOrder:this.state.sorting.sortOrder,keyAccess:0,manualSorting:!1}),(0,fs.jsx)(vK,{ref:this.passwordTree,sorting:this.state.sorting,columns:this.state.columns,onDelete:this.onAskToDelete,nodes:n})),0===n.length&&yK("div",{className:"saved-passwords"},void 0,e?(0,Oe.Z)("Query “$1” matches no result.",[e]):(0,Oe.Z)("No saved passwords found.")),n.length>0&&yK("div",{className:"setting-single"},void 0,yK("input",{type:"button",onClick:this.togglePasswordList,value:this.state.passwordsVisible?(0,Oe.Z)("Hide Passwords"):(0,Oe.Z)("Show Saved Passwords")}),yK("input",{type:"button",onClick:this.exportPasswords,value:(0,Oe.Z)("Export Passwords"),disabled:"IN_PROGRESS"===this.state.exportStatus}),"FAILED_CANCELLED"===this.state.exportStatus||"FAILED_WRITE_FAILED"===this.state.exportStatus&&yK(tc,{type:"error"},"error",(0,Oe.Z)("Export failed.")),yK("p",{className:"info"},void 0,(0,Oe.Z)("Passwords are exported in clear text without encryption.")))))}}const TK=sa(AK,wK);var ZK;function EK(e,t,n,s){ZK||(ZK="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:ZK,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const _K={title:(0,Oe.Z)("title","Name"),Nickname:(0,Oe.Z)("Nickname"),"Nickname in use by $1":(0,Oe.Z)("Nickname in use by $1",[""]),URL:(0,Oe.Z)("URL"),"POST Parameters":(0,Oe.Z)("POST Parameters"),"Substitute search keyword in addresses or post parameters with %s or %S":(0,Oe.Z)("Substitute search keyword in addresses or post parameters with %s or %S"),"Empty post parameters disable the use of POST. Post parameters are in the form name=value,name=value":(0,Oe.Z)("Empty post parameters disable the use of POST. Post parameters are in the form name=value,name=value"),"Suggest URL":(0,Oe.Z)("Suggest URL"),"Suggest POST Parameters":(0,Oe.Z)("Suggest POST Parameters"),"Image Search URL":(0,Oe.Z)("Image Search URL"),"Image Search POST Parameters":(0,Oe.Z)("Image Search POST Parameters"),"Set as Default Search":(0,Oe.Z)("Set as Default Search"),"Set as Private Search":(0,Oe.Z)("Set as Private Search")};function MK(e){const t=Gn.Z.getById(e);return t&&e?{id:e,extensionId:t.extensionId,extensionName:"",name:t.name?t.name.trim():"",url:t.url.trim(),postParams:t.postParams?t.postParams.trim():"",suggestUrl:t.suggestUrl?t.suggestUrl.trim():"",suggestPostParams:t.suggestPostParams?t.suggestPostParams.trim():"",imageUrl:t.imageUrl?t.imageUrl.trim():"",imagePostParams:t.imagePostParams?t.imagePostParams.trim():"",faviconUrl:t.faviconUrl?t.faviconUrl.trim():"",keyword:t.keyword,default:Gn.Z.isDefault(e,!1),private:Gn.Z.isDefault(e,!0),nicknameTaken:!1,readOnly:t.readOnly}:{id:e,extensionId:"",extensionName:"",name:"",url:"",postParams:"",suggestUrl:"",suggestPostParams:"",imageUrl:"",imagePostParams:"",faviconUrl:"",keyword:"",default:!1,private:!1,nicknameTaken:!1,readOnly:!0}}class NK extends hs.Component{static contextType=xi.Z;urlHasChanged=!1;constructor(e,t){super(e),this.state=MK(e.id),this.convertExtensionIdToName(this.state.extensionId)}static getDerivedStateFromProps(e,t){return e.id!==t.id?MK(e.id):null}componentDidMount(){Gn.Z.addListener(this._onSearchEngineCacheChanged)}componentWillUnmount(){Gn.Z.removeListener(this._onSearchEngineCacheChanged)}componentDidUpdate(e,t){e.id!==this.props.id&&(this.save(t,!1),this.urlHasChanged=!1)}_onSearchEngineCacheChanged=()=>{const e=Gn.Z.getDefault(!1),t=Gn.Z.getDefault(!0);this.setState({default:e?.id===this.props.id,private:t?.id===this.props.id})};convertExtensionIdToName=e=>{e&&s.Z.management.getAll().then((t=>t.find((t=>t.id===e))?.name)).then((e=>e&&this.setState({extensionName:e})))};handleKeyDown=e=>{"Enter"===e.key&&this.save()};handleBlur=()=>{this.props.id===this.state.id&&this.save()};getDataUri=(e,t)=>{const{document:n}=this.context,s=new Image;s.onload=function(){const s=n.createElement("canvas");s.width=this.naturalWidth,s.height=this.naturalHeight,s.getContext("2d").drawImage(this,0,0),t(s.toDataURL(e))},s.src=e};constructFavicon=e=>{const{document:t}=this.context;if(e&&!this.state.faviconUrl){const n=(0,vs.q9)(e.trim()),s=t.createElement("a");s.href=n;const i=s.protocol+"//"+s.host+"/favicon.ico";this.getDataUri(i,(e=>{this.urlHasChanged&&this.setState({faviconUrl:e},(()=>this.save()))}))}};canSave=e=>Boolean(e.id&&!e.nicknameTaken&&""!==e.keyword&&""!==e.name&&""!==e.url);save=(e=this.state,t=!0)=>{if(!this.canSave(e))return;const n=Gn.Z.getById(e.id);if(!n)return;const s=structuredClone(n);s.id=e.id,s.name=e.name,s.keyword=e.keyword,s.url=e.url.trim(),s.postParams=e.postParams.trim(),s.suggestUrl=e.suggestUrl.trim(),s.suggestPostParams=e.suggestPostParams.trim(),s.imageUrl=e.imageUrl.trim(),s.imagePostParams=e.imagePostParams.trim(),s.suggestPostParams=e.suggestPostParams.trim(),this.urlHasChanged&&(s.faviconUrl=e.faviconUrl);const i=Gn.Z.getDefault(!1)?.id,o=Gn.Z.getDefault(!0)?.id;(0,xA.Z)(s,n)||C.Z.searchEngines.updateTemplateUrl(s),e.default!==(i===e.id)&&(C.Z.searchEngines.setDefault("defaultSearch",e.id),C.Z.searchEngines.setDefault("defaultSearchField",e.id),C.Z.searchEngines.setDefault("defaultSpeeddials",e.id)),e.private!==(o===e.id)&&(e.private?(C.Z.searchEngines.setDefault("defaultPrivate",e.id),C.Z.searchEngines.setDefault("defaultSearchFieldPrivate",e.id),C.Z.searchEngines.setDefault("defaultSpeeddialsPrivate",e.id)):o===n.id&&i&&(C.Z.searchEngines.setDefault("defaultPrivate",i),C.Z.searchEngines.setDefault("defaultSearchFieldPrivate",i),C.Z.searchEngines.setDefault("defaultSpeeddialsPrivate",i)))};nameChange=e=>{this.setState({name:e.target.value})};nicknameChange=e=>{const t=e.target.value.trim();let n=t.length>0&&void 0!==Gn.Z.getByKeyword(t);if(n&&this.props.id){const e=Gn.Z.getById(this.props.id);e&&e.keyword===t&&(n=!1)}this.setState({keyword:t,nicknameTaken:n})};urlChange=e=>{const t=e.target.value;(0,vs.C3)(t)&&this.constructFavicon(t),this.setState({url:t}),this.urlHasChanged=!0};postParamsChange=e=>{this.setState({postParams:e.target.value})};suggestUrlChange=e=>{this.setState({suggestUrl:e.target.value})};suggestPostParamsChange=e=>{this.setState({suggestPostParams:e.target.value})};imageUrlChange=e=>{this.setState({imageUrl:e.target.value})};imagePostParamsChange=e=>{this.setState({imagePostParams:e.target.value})};defaultChange=e=>{this.setState({default:e.target.checked},(()=>this.save()))};privateChange=e=>{this.setState({private:e.target.checked},(()=>this.save()))};openExtensionsPage=()=>{const{extensionId:e}=this.state;e&&d.ZP.openURL(this.context.vivaldiWindowId,`vivaldi://extensions/?id=${e}`,{singleton:!0})};render(){const e=this.state.nicknameTaken?Gn.Z.getByKeyword(this.state.keyword):null,t=e?e.name:"";return EK("div",{className:"detail"},void 0,EK("div",{className:"detail-content"},void 0,this.state.extensionId&&EK(tc,{type:"info"},void 0,(0,Oe.Z)("This search engine is added by “$1” extension.",[this.state.extensionName])," ",EK(hb,{onClick:this.openExtensionsPage},void 0,(0,Oe.Z)("Show Extension"))),EK("div",{className:"setting-group"},void 0,EK("div",{className:"setting-single"},void 0,EK(sc.Z,{type:"text",focusInput:this.props.focusNameInput,label:this.props.searchableStrings.title,value:this.state.name,onBlur:this.handleBlur,onChange:this.nameChange,onKeyDown:this.handleKeyDown,disabled:this.state.readOnly})),""===this.state.name.trim()&&EK(tc,{type:"warning"},void 0,(0,Vl.CH)((0,Oe.Z)("Name cannot be empty"),this.props.filter)),EK("div",{className:"setting-single"},void 0,EK(sc.Z,{type:"text",label:this.props.searchableStrings.Nickname,value:this.state.keyword,onBlur:this.handleBlur,onChange:this.nicknameChange,onKeyDown:this.handleKeyDown,disabled:this.state.readOnly})),""===this.state.keyword&&EK(tc,{type:"warning"},void 0,(0,Vl.CH)((0,Oe.Z)("Nickname cannot be empty"),this.props.filter)),this.state.nicknameTaken&&EK(tc,{type:"warning"},void 0,(0,Vl.CH)((0,Oe.Z)("Nickname in use by $1",[t]),this.props.filter))),EK("p",{className:"info"},void 0,this.props.searchableStrings["Substitute search keyword in addresses or post parameters with %s or %S"]),EK("p",{className:"info"},void 0,this.props.searchableStrings["Empty post parameters disable the use of POST. Post parameters are in the form name=value,name=value"]),EK("div",{className:"setting-group"},void 0,EK("div",{className:"setting-single"},void 0,EK(sc.Z,{type:"text",label:this.props.searchableStrings.URL,value:this.state.url,onBlur:this.handleBlur,onChange:this.urlChange,onKeyDown:this.handleKeyDown,disabled:this.state.readOnly})),""===this.state.url.trim()&&EK(tc,{type:"warning"},void 0,(0,Vl.CH)((0,Oe.Z)("URL cannot be empty"),this.props.filter)),EK("div",{className:"setting-single"},void 0,EK(sc.Z,{type:"text",label:this.props.searchableStrings["POST Parameters"],value:this.state.postParams,onBlur:this.handleBlur,onChange:this.postParamsChange,onKeyDown:this.handleKeyDown,disabled:this.state.readOnly}))),EK("div",{className:"setting-group"},void 0,EK("div",{className:"setting-single"},void 0,EK(sc.Z,{type:"text",label:this.props.searchableStrings["Suggest URL"],value:this.state.suggestUrl,onBlur:this.handleBlur,onChange:this.suggestUrlChange,onKeyDown:this.handleKeyDown,disabled:this.state.readOnly})),EK("div",{className:"setting-single"},void 0,EK(sc.Z,{type:"text",label:this.props.searchableStrings["Suggest POST Parameters"],value:this.state.suggestPostParams,onBlur:this.handleBlur,onChange:this.suggestPostParamsChange,onKeyDown:this.handleKeyDown,disabled:this.state.readOnly}))),EK("div",{className:"setting-group"},void 0,EK("div",{className:"setting-single"},void 0,EK(sc.Z,{type:"text",label:this.props.searchableStrings["Image Search URL"],value:this.state.imageUrl,onBlur:this.handleBlur,onChange:this.imageUrlChange,onKeyDown:this.handleKeyDown,disabled:this.state.readOnly})),EK("div",{className:"setting-single"},void 0,EK(sc.Z,{type:"text",label:this.props.searchableStrings["Image Search POST Parameters"],value:this.state.imagePostParams,onBlur:this.handleBlur,onChange:this.imagePostParamsChange,onKeyDown:this.handleKeyDown,disabled:this.state.readOnly}))),EK("div",{className:"setting-group pad-top"},void 0,EK("div",{className:"setting-single"},void 0,EK("label",{},void 0,EK("input",{type:"checkbox",checked:this.state.default,disabled:this.state.default,onChange:this.defaultChange}),EK("span",{},void 0,this.props.searchableStrings["Set as Default Search"]))),EK("div",{className:"setting-single"},void 0,EK("label",{},void 0,EK("input",{type:"checkbox",checked:this.state.private,disabled:this.state.default&&this.state.private,onChange:this.privateChange}),EK("span",{},void 0,this.props.searchableStrings["Set as Private Search"]))))))}}const PK=NK;var DK;function xK(e,t,n,s){DK||(DK="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:DK,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class OK extends hs.Component{static contextType=xi.Z;state={currentSearchEngine:void 0,thanksState:!1};componentDidMount(){Gn.Z.addListener(this._onSearchEngineCacheChanged)}componentWillUnmount(){Gn.Z.removeListener(this._onSearchEngineCacheChanged)}_onSearchEngineCacheChanged=()=>{const e=G.ZP.isIncognito(this.context.vivaldiWindowId),t=Gn.Z.getDefault(e),n=Gn.Z.getSpeeddialsSearch(e),s=Gn.Z.getSearchField(e);t?.prepopulateId!==Gn.A&&n?.prepopulateId!==Gn.A&&s?.prepopulateId!==Gn.A||this.setState({thanksState:!1,currentSearchEngine:void 0})};_updateCurrentEngine=e=>{const t=Gn.Z.getByPrepopulateId(Number(e));t&&this.setState({currentSearchEngine:t,thanksState:!0},(()=>{const e=G.ZP.isIncognito(this.context.vivaldiWindowId),n=Gn.Z.getDefault(e),s=Gn.Z.getSpeeddialsSearch(e),i=Gn.Z.getSearchField(e);if(1===n?.prepopulateId){const n=e?"defaultPrivate":"defaultSearch";C.Z.searchEngines.setDefault(n,t.id)}if(1===s?.prepopulateId){const n=e?"defaultSpeeddialsPrivate":"defaultSpeeddials";C.Z.searchEngines.setDefault(n,t.id)}if(1===i?.prepopulateId){const n=e?"defaultSearchFieldPrivate":"defaultSearchField";C.Z.searchEngines.setDefault(n,t.id)}}))};render(){const e=function(){const e=[3,4,5,7];return Gn.Z.get().reduce(((e,t)=>{let n="";switch(t.prepopulateId){case 3:n=(0,Oe.Z)("Powerful AI tools. Speed.");break;case 4:n=(0,Oe.Z)("A better planet with every search.");break;case 5:n=(0,Oe.Z)("Powered by Google. Does not track you.");break;case 7:n=(0,Oe.Z)("Privacy first. Does not track you.");break;default:return e}return e.push({type:"Description",id:t.prepopulateId.toString(),name:t.name,icon:t.faviconUrl,description:n}),e}),[]).sort(((t,n)=>e.indexOf(t.id)-e.indexOf(n.id)))}(),{thanksState:t}=this.state;return xK("div",{className:"tracker-warning"},void 0,xK("button",{className:"close",onClick:()=>{Ne.Z.set($.kStartpageSpeedDialTrackerSuggestionShow,!1)},dangerouslySetInnerHTML:{__html:Ts.kze}}),!this.props.hideImg&&xK("img",{className:"tony-illustration",src:t?"resources/tony_thanks.png":"resources/support_tony.png",align:"left"}),t?(0,fs.jsxs)(fs.Fragment,{children:[xK("h1",{},void 0,(0,Oe.Z)("Thank you for supporting Vivaldi")),xK("p",{},void 0,(0,Oe.Z)("We appreciate your decision and thank you for helping us stay sustainable. You can try one of our other partners if you're unhappy with the results from your first choice."))]}):(0,fs.jsxs)(fs.Fragment,{children:[xK("h1",{},void 0,(0,Oe.Z)("Support Vivaldi")),xK("p",{},void 0,(0,Oe.Z)("We are building the best browser for you. To be able to do this we rely on revenue from our search partners. Consider one of these search engines to help support us:"))]}),xK("div",{className:"engine-suggestion-container"},void 0,xK(jR,{className:"engine-suggestion",items:e,value:this.state.currentSearchEngine?.prepopulateId?.toString()??"",onValueChange:this._updateCurrentEngine,tooltip:(0,Oe.Z)("Select Default Search Engine")}),xK("a",{className:"support-vivaldi",href:"https://vivaldi.com/contribute/",onClick:()=>{d.ZP.openURL(this.context.vivaldiWindowId,"https://vivaldi.com/contribute/")}},void 0,(0,Oe.Z)("Other Ways To Support Vivaldi"))))}}const LK=sa(OK,[]);var RK,BK=n(34155);function FK(e,t,n,s){RK||(RK="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:RK,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const VK=[$.kAddressBarInlineSearchEnabled,$.kAddressBarInlineSearchSuggestEnabled,$.kAddressBarInlineSearchSuggestOnNickname,$.kAddressBarSearchAllowExtensionOverride,$.kAddressBarSearchDisplay,$.kAddressBarSearchInNewTab,$.kAddressBarSearchKeepSelected,$.kAddressBarSearchShowFavicon,$.kAddressBarSearchShowKeyword,$.kAddressBarSearchSuggestEnabled,$.kPageSearchInBackground,$.kStartpageSpeedDialDisplaySearch,$.kVivaldiAddressBarSearchDirectMatchEnabled,$.kStartpageSpeedDialTrackerSuggestionShow],WK=Ne.Z.getEventHandler,UK={width:400,minWidth:"unset"};function HK({engines:e,selectedEngine:t,onValueChange:n,tooltip:s}){const i=e.map((e=>({type:"Normal",id:e.id,name:e.name,faviconUrl:e.faviconUrl,checked:t?.id===e.id})));return(0,fs.jsx)(fs.Fragment,{children:FK(jR,{items:i,value:t?t.id:"",onValueChange:n,tooltip:s})})}var zK=FK("input",{type:"radio",value:"field"}),GK=FK("input",{type:"radio",value:"button"}),$K=FK("div",{className:"setting-single pad-left"});class KK extends hs.Component{static contextType=xi.Z;_focusEditor=!1;_editorKey=0;refSpeedDialDefaultSearchEngine=hs.createRef();state={confirmation:!1,keepCustomEngines:!1,searchEngines:Gn.Z.get(),language:void 0};componentDidMount(){C.Z.utilities.getLanguage((e=>{this.setState({language:e})})),Gn.Z.addListener(this._onSearchEngineCacheChanged)}componentWillUnmount(){Gn.Z.removeListener(this._onSearchEngineCacheChanged)}_onSearchEngineCacheChanged=()=>{this.setState({searchEngines:Gn.Z.get()})};restoreSearchEngines=()=>{C.Z.searchEngines.repairPrepopulatedTemplateUrls(!this.state.keepCustomEngines),this.setState({confirmation:!1})};setDefault=(e,t)=>{C.Z.searchEngines.setDefault(t?"defaultPrivate":"defaultSearch",e),this._editorKey++};confirmRestoreDefaults=()=>{this.setState({confirmation:!0}),BK.nextTick((()=>this._editorKey++))};onCancelConfirm=()=>{this.setState({confirmation:!1})};toggleKeepCustomEngines=()=>{this.setState((e=>({keepCustomEngines:!e.keepCustomEngines})))};renderModal=()=>{const e=this.state.keepCustomEngines?(0,Oe.Z)("Search engines will be reset to default settings, but your custom search engines will be kept."):(0,Oe.Z)("Search engines will be reset to default settings, which will also reset your custom search engines.");return FK(_r.Z,{style:UK,viewMode:"float",onRequestClose:this.onCancelConfirm},void 0,FK("div",{className:"dialog-restore-search"},void 0,FK("header",{className:"dialog-header"},void 0,FK("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("Restore Default Search Engines?"))),FK("div",{className:"dialog-content"},void 0,FK("p",{},void 0,e)),FK("footer",{className:"dialog-footer"},void 0,FK("label",{},void 0,FK("input",{type:"checkbox",checked:this.state.keepCustomEngines,onChange:this.toggleKeepCustomEngines}),FK("span",{},void 0,(0,Oe.Z)("Keep Custom Searches"))),FK("input",{type:"button",className:"danger",onClick:this.restoreSearchEngines,value:(0,Oe.Z)("Restore")}),FK("input",{type:"button",onClick:this.onCancelConfirm,value:(0,Oe.Z)("Cancel"),autoFocus:!0}))))};removeAt=e=>{if(e>=0&&e<this.state.searchEngines.length){const t=this.state.searchEngines[e];C.Z.searchEngines.removeTemplateUrl(t.id)}};renderListItem=(e,t)=>{const n=Gn.Z.getById(t.key);if(!n)return(0,fs.jsx)(fs.Fragment,{children:FK("div",{className:"item-title"},void 0,e||"Error")});const s=Gn.Z.isDefault(n.id,!0),i=n.id===Gn.Z.getImageSearch()?.id;return(0,fs.jsxs)(fs.Fragment,{children:[FK(Ss,{className:"item-icon",url:n.faviconUrl,loadType:"faviconFromCache"}),FK("div",{className:"item-title"},void 0,e||n.name),s&&FK("span",{className:"item-badge",title:(0,Oe.Z)("Private Window Search Engine")},void 0,(0,Oe.Z)("Private")),i&&FK("span",{className:"item-badge",title:(0,Oe.Z)("Default Image Search Engine")},void 0,(0,Oe.Z)("Image")),FK("div",{className:"item-meta"},void 0,n.keyword)]})};onCreateEngine=async()=>{const e=id();e.name=(0,Oe.Z)("New Engine"),await C.Z.searchEngines.addTemplateUrl(e),this._focusEditor=!0,BK.nextTick((()=>this._focusEditor=!1))};renderContent=(e,t)=>{const n=this.state.searchEngines[e];return n?FK(PK,{focusNameInput:this._focusEditor,searchableStrings:t,filter:this.props.filter,id:n.id},n.id):null};onContextMenu=(e,t)=>{const n=[];if(e>=0&&e<this.state.searchEngines.length){const t=this.state.searchEngines[e];Gn.Z.isDefault(t.id,!1)||n.push({handler:this.setDefault.bind(this,t.id,!1),...(0,xs.Z)("searchengine","Set as Default Search")}),Gn.Z.isDefault(t.id,!0)||n.push({handler:this.setDefault.bind(this,t.id,!0),...(0,xs.Z)("searchengine","Set as Private Search")})}(0,Qi.Z)(this.context,n)(t)};onActivate=e=>{if(e>=0&&e<this.state.searchEngines.length){const t=this.state.searchEngines[e];this.setDefault(t.id,!1)}};moveEngine=(e,t)=>{const n=e<t?t+1:t;if(e>=0&&e<this.state.searchEngines.length&&n>=0&&n<=this.state.searchEngines.length){const t=this.state.searchEngines[e];if(n===this.state.searchEngines.length)C.Z.searchEngines.moveTemplateUrl(t.id);else{const e=this.state.searchEngines[n];C.Z.searchEngines.moveTemplateUrl(t.id,e.id)}}};shouldRenderDefaultSearchEngineCard=()=>{const e=this.refSpeedDialDefaultSearchEngine.current?.state.thanksState??!1,t=G.ZP.isIncognito(this.context.vivaldiWindowId),n=Gn.Z.getDefault(t);return this.props.prefValues[$.kStartpageSpeedDialTrackerSuggestionShow]&&(n?.prepopulateId===Gn.A||e)};render(){if(!this.state.searchEngines)return null;const e=Gn.Z.getDefault(!1),t=Gn.Z.getDefault(!0),n=Gn.Z.getImageSearch(),s=this.state.searchEngines.filter((e=>e.imageUrl));n&&!s.find((e=>e.id===n.id))&&s.push(n);const i=this.state.searchEngines.map((t=>({key:t.id,name:t.name,isDefault:t.id===e?.id,isStatic:""!==t.extensionId,isRemovable:Gn.Z.isRemovable(t.id)&&!t.extensionId})));return FK(mN,{categoryTitle:(0,Oe.Z)("noun","Search"),filter:this.props.filter},void 0,this.state.confirmation&&this.renderModal(),FK("div",{},void 0,this.shouldRenderDefaultSearchEngineCard()&&(0,fs.jsx)(LK,{ref:this.refSpeedDialDefaultSearchEngine,hideImg:!1}),FK("div",{className:"setting-group"},void 0,FK("div",{className:"setting-single"},void 0,FK("h3",{},void 0,(0,Oe.Z)("Default Search Engine")),FK(HK,{engines:this.state.searchEngines,selectedEngine:e,onValueChange:e=>{C.Z.searchEngines.setDefault("defaultSearch",e),C.Z.searchEngines.setDefault("defaultSearchField",e),C.Z.searchEngines.setDefault("defaultSpeeddials",e)},tooltip:(0,Oe.Z)("Select Default Search Engine")}))),FK("div",{className:"setting-group"},void 0,FK("div",{className:"setting-single"},void 0,FK("h3",{},void 0,(0,Oe.Z)("Private Window Search Engine")),FK(HK,{engines:this.state.searchEngines,selectedEngine:t,onValueChange:e=>{C.Z.searchEngines.setDefault("defaultPrivate",e),C.Z.searchEngines.setDefault("defaultSearchFieldPrivate",e),C.Z.searchEngines.setDefault("defaultSpeeddialsPrivate",e)},tooltip:(0,Oe.Z)("Select Private Window Search Engine")}))),FK("div",{className:"setting-group"},void 0,FK("div",{className:"setting-single"},void 0,FK("h3",{},void 0,(0,Oe.Z)("Image Search Engine")),FK(HK,{engines:s,selectedEngine:n,onValueChange:e=>C.Z.searchEngines.setDefault("defaultImage",e),tooltip:(0,Oe.Z)("Select Default Search Engine for Images")})))),FK("div",{className:"setting-group"},void 0,FK("h3",{},void 0,(0,Oe.Z)("Search Field Display")),FK("div",{className:"setting-single"},void 0,FK("label",{},void 0,FK(vl,{name:"renderSearchField",value:this.props.prefValues[$.kAddressBarSearchDisplay],onChange:WK($.kAddressBarSearchDisplay)},void 0,FK("div",{className:"setting-single"},void 0,FK("label",{},void 0,zK,FK("span",{},void 0,(0,Oe.Z)("Show as a Text Field")))),FK("div",{className:"setting-single"},void 0,FK("label",{},void 0,GK,FK("span",{},void 0,(0,Oe.Z)("Show as a Button"))))))),FK("div",{className:"setting-single"},void 0,FK("label",{},void 0,FK("input",{type:"checkbox",checked:this.props.prefValues[$.kAddressBarSearchShowKeyword],onChange:WK($.kAddressBarSearchShowKeyword)}),FK("span",{},void 0,(0,Oe.Z)("Show Search Engine Nickname in Drop-Down Menu")))),FK("div",{className:"setting-single"},void 0,FK("label",{},void 0,FK("input",{type:"checkbox",checked:this.props.prefValues[$.kAddressBarSearchInNewTab],onChange:WK($.kAddressBarSearchInNewTab)}),FK("span",{},void 0,(0,Oe.Z)("Always Search in New Tab")))),FK("div",{className:"setting-single"},void 0,FK("label",{},void 0,FK("input",{type:"checkbox",checked:this.props.prefValues[$.kAddressBarSearchShowFavicon],onChange:WK($.kAddressBarSearchShowFavicon)}),FK("span",{},void 0,(0,Oe.Z)("Show Search Engine Icon"))))),FK("div",{className:"setting-group"},void 0,FK("h3",{},void 0,(0,Oe.Z)("Search Options")),FK("div",{className:"setting-single"},void 0,FK("label",{},void 0,FK("input",{type:"checkbox",checked:this.props.prefValues[$.kAddressBarInlineSearchEnabled],onChange:WK($.kAddressBarInlineSearchEnabled)}),FK("span",{},void 0,(0,Oe.Z)("Search in Address Field")))),FK("div",{className:"setting-single pad-left"},void 0,FK("label",{},void 0,FK("input",{type:"checkbox",checked:this.props.prefValues[$.kAddressBarSearchAllowExtensionOverride],onChange:WK($.kAddressBarSearchAllowExtensionOverride)}),FK("span",{},void 0,(0,Oe.Z)("Allow Control by Extensions"))),FK("p",{className:"info"},void 0,(0,Oe.Z)("Requires a restart to take effect"))),FK("div",{className:"setting-single"},void 0,FK("label",{},void 0,FK("input",{type:"checkbox",checked:this.props.prefValues[$.kStartpageSpeedDialDisplaySearch],onChange:WK($.kStartpageSpeedDialDisplaySearch)}),FK("span",{},void 0,(0,Oe.Z)("Show Search Field on Speed Dial")))),FK("div",{className:"setting-single"},void 0,FK("label",{},void 0,FK("input",{type:"checkbox",checked:this.props.prefValues[$.kAddressBarSearchKeepSelected],onChange:WK($.kAddressBarSearchKeepSelected)}),FK("span",{},void 0,(0,Oe.Z)("Keep Last Selected Search Engine")))),FK("div",{className:"setting-single"},void 0,FK("label",{},void 0,FK("input",{type:"checkbox",checked:this.props.prefValues[$.kAddressBarSearchKeepTypedText],onChange:WK($.kAddressBarSearchKeepTypedText)}),FK("span",{},void 0,(0,Oe.Z)("Keep Typed Text After Searching")))),FK("div",{className:"setting-single"},void 0,FK("label",{},void 0,FK("input",{type:"checkbox",checked:this.props.prefValues[$.kPageSearchInBackground],onChange:WK($.kPageSearchInBackground)}),FK("span",{},void 0,(0,Oe.Z)("Page Selection Search in Background"))))),FK("div",{className:"setting-group"},void 0,FK("div",{id:"searchSuggest",className:"setting-group"},void 0,FK("h3",{},void 0,(0,Oe.Z)("Allow Search Suggestions")),FK("div",{className:"setting-single"},void 0,FK("label",{},void 0,FK("input",{type:"checkbox",checked:this.props.prefValues[$.kAddressBarInlineSearchSuggestEnabled],onChange:WK($.kAddressBarInlineSearchSuggestEnabled)}),FK("span",{},void 0,(0,Oe.Z)("searchengine","In Address Field")))),FK("div",{className:"setting-single pad-left"},void 0,FK("label",{},void 0,FK("input",{type:"checkbox",checked:this.props.prefValues[$.kAddressBarInlineSearchSuggestOnNickname],disabled:!this.props.prefValues[$.kAddressBarInlineSearchSuggestEnabled],onChange:WK($.kAddressBarInlineSearchSuggestOnNickname)}),FK("span",{},void 0,(0,Oe.Z)("Only when Using Search Engine Nickname")))),FK("div",{className:"setting-single"},void 0,FK("label",{},void 0,FK("input",{type:"checkbox",checked:this.props.prefValues[$.kAddressBarSearchSuggestEnabled],onChange:WK($.kAddressBarSearchSuggestEnabled)}),FK("span",{},void 0,(0,Oe.Z)("searchengine","In Search Field")))),FK("div",{className:"setting-single"},void 0,FK("label",{},void 0,FK("input",{type:"checkbox",checked:this.props.prefValues[$.kVivaldiAddressBarSearchDirectMatchEnabled],onChange:WK($.kVivaldiAddressBarSearchDirectMatchEnabled)}),FK("span",{},void 0,(0,Oe.Z)("searchengine","Enable Direct Match"))),FK("a",{className:"info",onClick:()=>d.ZP.openURL(this.context.vivaldiWindowId,"https://help.vivaldi.com/others/what-is-direct-match/"),href:"https://help.vivaldi.com/others/what-is-direct-match/"},void 0,(0,Oe.Z)("Learn more about Direct Match"))))),FK(xD.Z,{className:"setting-search-engine",filter:this.props.filter,subtitle:(0,Oe.Z)("Search Engines"),deleteTitle:(0,Oe.Z)("title","Delete Search Engine"),addTipString:(0,Oe.Z)("Add Search Engine"),deleteTipString:(0,Oe.Z)("tooltip","Delete Search Engine"),items:i,supportDragAndDrop:!0,masterLayout:1,mimeType:"vivaldi/x-search-engine",renderListItem:this.renderListItem,renderContent:this.renderContent,contentStrings:_K,moveItem:this.moveEngine,onContextMenu:this.onContextMenu,onActivate:this.onActivate,onRemove:this.removeAt,onCreateItem:this.onCreateEngine}),FK("div",{className:"setting-group unlimited"},void 0,FK("div",{className:"setting-single"},void 0,FK("input",{type:"button",onClick:this.confirmRestoreDefaults,value:(0,Oe.Z)("Restore Defaults")}),$K)))}}const jK=sa(KK,VK);var YK;function XK(e,t,n,s){YK||(YK="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:YK,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class QK extends hs.Component{static contextType=xi.Z;manageCertificatesClicked=e=>{const{vivaldiWindowId:t}=this.context;C.Z.utilities.showManageSSLCertificates(t,(()=>{}))};render(){return XK(mN,{categoryTitle:(0,Oe.Z)("Security"),filter:this.props.filter},void 0,XK("div",{className:"setting-group unlimited"},void 0,XK("div",{className:"setting-single"},void 0,XK("input",{type:"button",value:(0,Oe.Z)("Manage Certificates"),onClick:this.manageCertificatesClicked}),XK("p",{className:"info"},void 0,(0,Oe.Z)("Manage HTTPS/SSL certificates and settings.")))))}}const qK=QK;var JK;function ej(e,t,n,s){JK||(JK="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:JK,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const tj=["appearance","tabs","qc","privacy","mail","all"];function nj(e){return Object.keys(je.mh).filter((e=>{if("chat"===e){return!1&&ds.Z.isEnabled("chat")}return!("reset"===e)})).map((e=>({...je.mh[e],key:e})))}class sj extends hs.PureComponent{rowComponent=e=>{const t=e.node,n=this.props.selectedCategory.title===t.title;return ej("div",{onMouseDown:e=>e.preventDefault(),className:As()({"button-category":!0,"category-selected":n,spacer:tj.includes(t.key),["group_"+t.group]:!0})},t.id,ej("span",{dangerouslySetInnerHTML:{__html:t.icon}}),t.title)};getHeight=({index:e})=>{const t=nj(this.props.selectedCategory)[e];if(t){const e=t.title.length;return 8*Math.ceil(e/24)+20+(tj.includes(t.key)?12:0)}return uo};handleItemClick=(e,{key:t})=>{this.props.onCategorySelected(t)};handleItemsActivated=(e,t)=>{this.props.onCategorySelected(t[0].key)};handleFilterChange=({currentTarget:e})=>{this.props.onFilterChange(e.value)};render(){return ej("div",{className:"settings-sidebar"},void 0,ej("header",{className:"settings-navigation-header"},void 0,(0,fs.jsx)("input",{className:"settings-search",type:"search",ref:this.props.focusRef,placeholder:(0,Oe.Z)("verb","Search"),value:this.props.filter,onChange:this.handleFilterChange,autoFocus:G.ZP.isSettings(this.context.vivaldiWindowId),tabIndex:"0"})),ej(yo,{rowComponent:this.rowComponent,nodes:nj(this.props.selectedCategory),className:"settings-navigation",settings:"SETTINGS_TREE",onItemClick:this.handleItemClick,onItemsActivated:this.handleItemsActivated,enableDragAndDrop:!1,rowHeight:this.getHeight,isFolder:xE.Z,hasChildren:xE.Z}))}}const ij=sj;var oj;function aj(e,t,n,s){oj||(oj="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:oj,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const rj=[$.kStartpageNavigation,$.kStartpageSpeedDialAddButtonVisible,$.kStartpageSpeedDialAllowDnd,$.kStartpageSpeedDialColumns,$.kStartpageSpeedDialControlsVisible,$.kStartpageSpeedDialDeleteVisible,$.kStartpageSpeedDialFaviconVisible,$.kStartpageSpeedDialGameButtonShow,$.kStartpageSpeedDialTitlesVisible,$.kStartpageSpeedDialSize,$.kStartpageSpeedDialPrivacyStatsShow],lj=Ne.Z.getEventHandler,dj=new Map([["icon",{value:90,label:(0,Oe.Z)("Icon")}],["tiny",{value:120,label:(0,Oe.Z)("Tiny")}],["small",{value:170,label:(0,Oe.Z)("other","Small")}],["medium",{value:220,label:(0,Oe.Z)("other","Medium")}],["large",{value:270,label:(0,Oe.Z)("other","Large")}],["huge",{value:320,label:(0,Oe.Z)("Huge")}],["fit_to_columns",{value:-1,label:(0,Oe.Z)("Scale to Fit Columns")}]]);var cj=aj("input",{type:"radio",value:"on"}),hj=aj("input",{type:"radio",value:"speed_dial_only"}),pj=aj("input",{type:"radio",value:"off"}),uj=aj("input",{type:"radio",value:"always"}),gj=aj("input",{type:"radio",value:"hover"}),mj=aj("input",{type:"radio",value:"never"}),vj=aj("option",{value:1},void 0,"1"),fj=aj("option",{value:2},void 0,"2"),yj=aj("option",{value:3},void 0,"3"),Cj=aj("option",{value:4},void 0,"4"),wj=aj("option",{value:5},void 0,"5"),bj=aj("option",{value:6},void 0,"6"),Sj=aj("option",{value:7},void 0,"7"),Ij=aj("option",{value:8},void 0,"8"),kj=aj("option",{value:10},void 0,"10"),Aj=aj("option",{value:12},void 0,"12");class Tj extends hs.PureComponent{render(){const{filter:e,prefValues:t}=this.props;return aj("div",{},void 0,aj(mN,{categoryTitle:(0,Oe.Z)("verb","Start Page"),filter:e},void 0,aj("div",{className:"setting-group unlimited"},void 0,aj("div",{className:"setting-group"},void 0,aj("h3",{},void 0,(0,Oe.Z)("Start Page Navigation")),aj("div",{className:"setting-single"},void 0,aj(vl,{name:"StartPageNavigation",value:t[$.kStartpageNavigation],onChange:lj($.kStartpageNavigation)},void 0,aj("div",{className:"setting-single"},void 0,aj("label",{},void 0,cj,aj("span",{},void 0,(0,Oe.Z)("Show on Internal Pages")))),aj("div",{className:"setting-single"},void 0,aj("label",{},void 0,hj,aj("span",{},void 0,(0,Oe.Z)("Show on Speed Dial Page")))),aj("div",{className:"setting-single"},void 0,aj("label",{},void 0,pj,aj("span",{},void 0,(0,Oe.Z)("radio","Hide"))))))))),aj(mN,{categoryTitle:(0,Oe.Z)("Speed Dial"),filter:e},void 0,aj("div",{className:"setting-group"},void 0,aj("h3",{},void 0,(0,Oe.Z)("Speed Dial Appearance")),aj(vl,{name:"SpeedDialTitles",value:t[$.kStartpageSpeedDialTitlesVisible],onChange:lj($.kStartpageSpeedDialTitlesVisible)},void 0,aj("div",{className:"setting-single"},void 0,aj("label",{},void 0,uj,aj("span",{},void 0,(0,Oe.Z)("Show Title")))),aj("div",{className:"setting-single"},void 0,aj("label",{},void 0,gj,aj("span",{},void 0,(0,Oe.Z)("Show Title on Hover")))),aj("div",{className:"setting-single"},void 0,aj("label",{},void 0,mj,aj("span",{},void 0,(0,Oe.Z)("Hide Title"))))),aj("div",{className:"setting-single pad-top"},void 0,aj("label",{},void 0,aj("input",{type:"checkbox",checked:t[$.kStartpageSpeedDialFaviconVisible],onChange:lj($.kStartpageSpeedDialFaviconVisible),disabled:"never"===t[$.kStartpageSpeedDialTitlesVisible]}),aj("span",{},void 0,(0,Oe.Z)("Show Favicon")))),aj("div",{className:"setting-single"},void 0,aj("label",{},void 0,aj("input",{type:"checkbox",checked:t[$.kStartpageSpeedDialDeleteVisible],onChange:lj($.kStartpageSpeedDialDeleteVisible)}),aj("span",{},void 0,(0,Oe.Z)("Show Delete Button")))),aj("div",{className:"setting-single"},void 0,aj("label",{},void 0,aj("input",{type:"checkbox",checked:t[$.kStartpageSpeedDialControlsVisible],onChange:lj($.kStartpageSpeedDialControlsVisible)}),aj("span",{},void 0,(0,Oe.Z)("Show Thumbnail Control Buttons")))),aj("div",{className:"setting-single"},void 0,aj("label",{},void 0,aj("input",{type:"checkbox",checked:t[$.kStartpageSpeedDialAddButtonVisible],onChange:lj($.kStartpageSpeedDialAddButtonVisible)}),aj("span",{},void 0,(0,Oe.Z)("Show “Add” Button"))),aj("p",{className:"info"},void 0,(0,Oe.Z)("When disabled, new bookmarks can be added by double-clicking the Speed Dial background."))),aj("div",{className:"setting-single"},void 0,aj("label",{},void 0,aj("input",{type:"checkbox",checked:t[$.kStartpageSpeedDialPrivacyStatsShow],onChange:lj($.kStartpageSpeedDialPrivacyStatsShow)}),aj("span",{},void 0,(0,Oe.Z)("Show Privacy Statistics"))))),aj("div",{className:"setting-group"},void 0,aj("div",{className:"setting-single"},void 0,aj("h3",{},void 0,(0,Oe.Z)("Maximum Columns")),aj("select",{className:"max-columns",value:t[$.kStartpageSpeedDialColumns],onChange:lj($.kStartpageSpeedDialColumns),title:(0,Oe.Z)("Maximum number of Speed Dial columns")},void 0,vj,fj,yj,Cj,wj,bj,Sj,Ij,kj,Aj,aj("option",{value:99},void 0,(0,Oe.Z)("Unlimited")))),aj("div",{className:"setting-single pad-top"},void 0,aj("h3",{},void 0,(0,Oe.Z)("Speed Dial Size")),aj("select",{className:"max-columns",value:t[$.kStartpageSpeedDialSize],onChange:lj($.kStartpageSpeedDialSize)},void 0,Array.from(dj).map((([e,{label:t}])=>aj("option",{value:e},e,t))))),aj("div",{className:"setting-single pad-top"},void 0,aj("label",{},void 0,aj("input",{type:"checkbox",checked:t[$.kStartpageSpeedDialAllowDnd],onChange:lj($.kStartpageSpeedDialAllowDnd)}),aj("span",{},void 0,(0,Oe.Z)("Allow Drag and Drop Reordering"))))),aj("div",{className:"setting-group"},void 0,aj("div",{className:"setting-single"},void 0,aj("h3",{},void 0,(0,Oe.Z)("Vivaldia, the Vivaldi Game")),aj("label",{},void 0,aj("input",{type:"checkbox",checked:t[$.kStartpageSpeedDialGameButtonShow],onChange:lj($.kStartpageSpeedDialGameButtonShow)}),aj("span",{},void 0,(0,Oe.Z)("Show on Speed Dial")))))))}}const Zj=sa(Tj,rj);var Ej;function _j(e,t,n,s){Ej||(Ej="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Ej,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Mj=Ne.Z.getEventHandler,Nj=[$.kWindowsShowWindowCloseConfirmationDialog];class Pj extends hs.Component{render(){return _j(US.Z,{filter:this.props.filter},void 0,_j("div",{className:"setting-group"},void 0,_j("h3",{},void 0,(0,Oe.Z)("Close Window Confirmation")),_j("div",{className:"setting-single"},void 0,_j("label",{},void 0,_j("input",{type:"checkbox",checked:this.props.prefValues[$.kWindowsShowWindowCloseConfirmationDialog],onChange:Mj($.kWindowsShowWindowCloseConfirmationDialog)}),_j("span",{},void 0,(0,Oe.Z)("Show Close Window Confirmation Dialog"))))))}}const Dj=sa(Pj,Nj);var xj;function Oj(e,t,n,s){xj||(xj="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:xj,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Lj=Ne.Z.getEventHandler,Rj=[$.kSystemShowExitConfirmationDialog];class Bj extends hs.Component{renderMacQuitConfirmation(){return Oj(US.Z,{filter:this.props.filter},void 0,Oj("div",{className:"setting-group"},void 0,Oj("h3",{},void 0,(0,Oe.Z)("Quit Confirmation")),Oj("div",{className:"setting-single"},void 0,Oj("label",{},void 0,Oj("input",{type:"checkbox",checked:this.props.prefValues[$.kConfirmToQuitEnabled],onChange:Lj($.kConfirmToQuitEnabled)}),Oj("span",{},void 0,(0,Oe.Z)("Warn on Quit (⌘Q)"))))))}renderExitConfirmation(){return Oj(US.Z,{filter:this.props.filter},void 0,Oj("div",{className:"setting-group"},void 0,Oj("h3",{},void 0,(0,Oe.Z)("Exit Confirmation")),Oj("div",{className:"setting-single"},void 0,Oj("label",{},void 0,Oj("input",{type:"checkbox",checked:this.props.prefValues[$.kSystemShowExitConfirmationDialog],onChange:Lj($.kSystemShowExitConfirmationDialog)}),Oj("span",{},void 0,(0,Oe.Z)("Show Exit Confirmation Dialog"))))))}render(){return this.renderExitConfirmation()}}const Fj=sa(Bj,Rj);var Vj;function Wj(e,t,n,s){Vj||(Vj="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Vj,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Uj="about:blank",Hj=[$.kHomepage,$.kHomepageCache];class zj extends hs.Component{state={customHomepage:this.props.prefValues[$.kHomepageCache]};saveHomePage=({currentTarget:e})=>{this.setState({customHomepage:e.value});const t=""!==e.value?(0,vs.Rz)(e.value):e.value;Ne.Z.set($.kHomepage,t||Uj),t!==h.QG&&Ne.Z.set($.kHomepageCache,t)};render(){const e=(this.props.prefValues[$.kHomepage]===Uj?"":this.props.prefValues[$.kHomepage])===h.QG;return Wj(US.Z,{filter:this.props.filter},void 0,Wj("div",{className:"setting-group homepage"},void 0,Wj("h3",{},void 0,(0,Oe.Z)("noun","Homepage")),Wj("div",{className:"setting-single"},void 0,Wj("label",{},void 0,Wj("input",{type:"radio",name:"startpage_url",onChange:this.saveHomePage,checked:e,value:h.QG}),Wj("span",{},void 0,(0,Oe.Z)("other","Start Page")))),Wj("div",{className:"setting-single"},void 0,Wj("label",{},void 0,Wj("input",{type:"radio",name:"startpage_url",onChange:this.saveHomePage,checked:!e,value:this.props.prefValues[$.kHomepageCache]}),Wj("span",{},void 0,(0,Oe.Z)("Specific Page")))),Wj("div",{className:"setting-single"},void 0,Wj("input",{type:"text",placeholder:(0,Oe.Z)("Address"),disabled:e,onChange:this.saveHomePage,value:this.state.customHomepage}))))}}const Gj=sa(zj,Hj);var $j,Kj=n(53454);function jj(e,t,n,s){$j||($j="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:$j,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Yj={width:500,minWidth:"unset"};const Xj=function({from:e,onClose:t}){const n=xT(Kj.Z);if(!n.workspaces.length&&!n.privateWorkspaces.length)return t(!0),null;const s=()=>{t(!1)};return jj(_r.Z,{onRequestClose:s,viewMode:"slide float",style:Yj},void 0,jj("header",{className:"dialog-header"},void 0,jj("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("Disable Workspaces"))),jj("div",{className:"dialog-content"},void 0,jj("p",{className:"error"},void 0,"startup"===e&&(0,Oe.Z)("Workspaces currently require setting set to “Startup with Last Session”, otherwise they will be disabled.")," ",(0,Oe.Z)("What would you like to do with the tabs that are currently in a Workspace?"))),jj("footer",{className:"dialog-footer"},void 0,jj("input",{type:"button",className:"primary",value:(0,Oe.Z)("verb","Move Tabs"),onClick:async()=>{const e=G.ZP.getLastActiveBrowserWindowId();if(e===G.Ex)return console.warn("No active window found"),void t(!1);for(const t of G.ZP.getIds("normal")){await cs.Z.setActiveWorkspace(t,void 0);const n=ie.ZP.getPages(t).filter((e=>void 0!==(0,ay.cm)(e)));n.size>0&&await d.ZP.moveToWindow(n,e)}t(!0)},autoFocus:!0}),jj("input",{type:"button",value:(0,Oe.Z)("verb","Close Tabs"),onClick:async()=>{for(const e of G.ZP.getIds("normal")){await cs.Z.setActiveWorkspace(e,void 0);const t=ie.ZP.getPages(e).filter((e=>void 0!==(0,ay.cm)(e)));await d.ZP.closePage(t,{bypassConfirm:!0,forceClosePinned:!0})}t(!0)}}),jj("input",{type:"button",value:(0,Oe.Z)("Cancel"),onClick:s})))};var Qj,qj,Jj;function eY(e,t,n,s){Qj||(Qj="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Qj,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function tY({filter:e,onSave:t,onDelete:n,urlItem:s}){return eY(US.Z,{filter:e},void 0,eY("div",{className:"setting-single"},void 0,eY("input",{className:"edit",type:"text",value:s.url,onChange:e=>{s.url=e.target.value,t(s)}}),eY("input",{type:"button",tabIndex:"-1",className:"circular clearkey",onClick:n,title:(0,Oe.Z)("Remove page")})))}function nY(e,t,n,s){qj||(qj="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:qj,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function sY(e){const t=(0,hs.createRef)(),[n,s]=(0,hs.useState)(!1),[i,o]=(0,hs.useState)((H.Z.get($.kURLsToRestoreOnStartup)||[]).map(((e,t)=>({url:e,id:t})))),a=e=>e.includes(":")?e:"http://"+e,r=e=>{o(e);const t=e.map((e=>e.url));Ne.Z.set($.kURLsToRestoreOnStartup,t)},l=()=>{const e=t.current;if(!e)return;const n=a(e.value),o=[...i];o.push({url:n,id:o.length}),e.value="",s(!1),r(o)},d=e=>{const t=[...i],n=t.find((t=>t.id===e.id));n&&(n.url=a(e.url)),r(t)},c=e=>{const t=[...i],n=t.find((t=>t.id===e.id));t.splice(t.indexOf(n),1),r(t)};return nY(US.Z,{filter:e.filter},void 0,nY("div",{className:"setting-group setting-startup-specific-pages"},void 0,nY("h3",{},void 0,(0,Oe.Z)("Startup Pages")),i.map((t=>nY(tY,{urlItem:t,onDelete:c.bind(this,t),onSave:d,filter:e.filter},t.id))),nY("form",{className:"setting-flexgroup",onSubmit:l},void 0,(0,fs.jsx)("input",{type:"text",className:"setting-single-flex",ref:t,value:e.url,onKeyUp:e=>{const{keyCode:t,currentTarget:n}=e;if(n.value.length>2?s(!0):s(!1),t===oa.Z.KEY_ESCAPE)n.value="",s(!1);else{if(t!==oa.Z.KEY_RETURN&&t!==oa.Z.KEY_ENTER||!(n.value.length>2))return;l()}},placeholder:(0,Oe.Z)("Enter page URL")}),nY("input",{type:"submit",className:"setting-single-noflex",disabled:!n,value:(0,Oe.Z)("Add")}),nY("input",{type:"button",onClick:()=>{const e=[];for(const[t,n]of G.ZP.getState())"normal"===n.type&&ie.ZP.getPages(t).forEach((({url:t},n)=>{je.jk.isInternalUrl(t)||e.push({id:n,url:t})}));r(e)},value:(0,Oe.Z)("Use Current Pages")}))))}function iY(e,t,n,s){Jj||(Jj="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Jj,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const oY=[$.kTabsAlwaysLoadPinnedAfterRestore,$.kTabsDeferLoadingAfterRestore,$.kWorkspacesEnabled],aY=Ne.Z.getEventHandler;function rY({filter:e}){const t=(0,na.Z)(oY),n=iY(sY,{filter:e,prefValues:t}),[s,i]=(0,hs.useState)(!1),[o,a]=(0,hs.useState)("last"),[r,l]=(0,hs.useState)();(0,hs.useEffect)((()=>{C.Z.utilities.getStartupAction((e=>a(e)))}),[]);const d=e=>{const n=e.target.value;if("last"!==n&&t[$.kWorkspacesEnabled])l(n),i(!0),e.preventDefault();else{const e=H.Z.get($.kURLsToRestoreOnStartup);C.Z.utilities.setStartupAction(n,e,(e=>a(e)))}},c=(0,hs.useMemo)((()=>"urls"===o?n:null),[e,t,o]);return iY(US.Z,{filter:e},void 0,iY("div",{className:"setting-group"},void 0,iY("h3",{},void 0,(0,Oe.Z)("Startup with")),iY(vl,{name:"startupSettings",value:o,onChange:Aa.Z},void 0,iY("div",{className:"setting-single"},void 0,iY("label",{},void 0,iY("input",{type:"radio",value:"last",onClick:d}),iY("span",{},void 0,(0,Oe.Z)("Last Session"))),iY("p",{className:"info"},void 0,(0,Oe.Z)("Required for Workspaces feature"))),iY("div",{className:"setting-single"},void 0,iY("label",{},void 0,iY("input",{type:"radio",value:"homepage",onClick:d}),iY("span",{},void 0,(0,Oe.Z)("radio","Homepage")))),iY("div",{className:"setting-single"},void 0,iY("label",{},void 0,iY("input",{type:"radio",value:"speeddial",onClick:d}),iY("span",{},void 0,(0,Oe.Z)("radio","Start Page")))),iY("div",{className:"setting-single"},void 0,iY("label",{},void 0,iY("input",{type:"radio",value:"urls",onClick:d}),iY("span",{},void 0,(0,Oe.Z)("Specific Pages"))))),iY("div",{className:"setting-single pad-top"},void 0,iY("label",{title:(0,Oe.Z)("Wait to load restored session content until tab is activated.")},void 0,iY("input",{type:"checkbox",checked:t[$.kTabsDeferLoadingAfterRestore],onChange:aY($.kTabsDeferLoadingAfterRestore)}),iY("span",{},void 0,(0,Oe.Z)("Lazy Load Restored Tabs")))),iY("div",{className:"setting-single pad-left"},void 0,iY("label",{title:(0,Oe.Z)("Load pinned tabs before they are activated.")},void 0,iY("input",{type:"checkbox",disabled:!t[$.kTabsDeferLoadingAfterRestore],checked:t[$.kTabsAlwaysLoadPinnedAfterRestore],onChange:aY($.kTabsAlwaysLoadPinnedAfterRestore)}),iY("span",{},void 0,(0,Oe.Z)("Always Load Pinned Tabs"))))),c,s&&iY(Xj,{onClose:e=>{if(i(!1),e&&r){Ne.Z.set($.kWorkspacesEnabled,!1);const e=H.Z.get($.kURLsToRestoreOnStartup);C.Z.utilities.setStartupAction(r,e,(e=>a(e)))}},from:"startup"}))}var lY;function dY(e,t,n,s){lY||(lY="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:lY,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const cY=[$.kWelcomeReadPages,$.kWelcomeSeenPages];class hY extends hs.Component{resetSeen=()=>{Ne.Z.set($.kWelcomeReadPages,[]),Ne.Z.set($.kWelcomeSeenPages,[])};render(){const e=this.props.prefValues[$.kWelcomeReadPages].length>0,t=this.props.prefValues[$.kWelcomeSeenPages].length>0;return dY(US.Z,{filter:this.props.filter},void 0,dY("div",{className:"setting-group"},void 0,dY("h3",{},void 0,(0,Oe.Z)("Welcome Page")),dY("div",{className:"setting-single"},void 0,dY("label",{},void 0,dY("input",{type:"button",disabled:e+t===0,value:(0,Oe.Z)("Reset Welcome Page"),onClick:this.resetSeen})))))}}sa(hY,cY);var pY;function uY(e,t,n,s){pY||(pY="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:pY,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const gY=[$.kStartupCheckIsDefault],mY=Ne.Z.getEventHandler;class vY extends hs.Component{_isMounted=!1;state={isVivaldiDefault:!0};componentDidMount(){this.getDefaultBrowserValue(),this._isMounted=!0}componentWillUnmount(){this._isMounted=!1}getDefaultBrowserValue=()=>{C.Z.utilities.isVivaldiDefaultBrowser((e=>{this._isMounted&&this.setState({isVivaldiDefault:!0===e})}))};setVivaldiDefault=()=>{C.Z.utilities.setVivaldiAsDefaultBrowser((e=>{this._isMounted&&this.setState({isVivaldiDefault:!0===e})})),this.props.onClose&&this.props.onClose()};renderCheckbox=()=>uY("label",{title:(0,Oe.Z)("Check if Vivaldi is your default browser upon every startup")},void 0,uY("input",{type:"checkbox",checked:this.props.prefValues[$.kStartupCheckIsDefault],onChange:mY($.kStartupCheckIsDefault)}),uY("span",{},void 0,(0,Oe.Z)("Check on Startup")));render(){return this.props.onClose?uY("form",{onSubmit:this.setVivaldiDefault,className:"SuggestDefault"},void 0,uY("span",{},void 0,(0,Oe.Z)("Enjoying Vivaldi? Make it your default browser.")),uY("input",{type:"submit",value:(0,Oe.Z)("browser","Set as Default Browser")}),this.renderCheckbox(),uY("button",{type:"button",className:"SuggestDefault-Close",dangerouslySetInnerHTML:{__html:Ts.vyJ},onClick:this.props.onClose})):uY(US.Z,{filter:this.props.filter},void 0,uY("div",{className:"setting-group"},void 0,!this.props.onClose&&uY("h3",{},void 0,(0,Oe.Z)("Default Browser")),uY("div",{className:"setting-single"},void 0,this.state.isVivaldiDefault?uY("p",{},void 0,(0,Oe.Z)("Vivaldi is set as your default browser.")):uY("div",{},void 0,uY("p",{},void 0,(0,Oe.Z)("Vivaldi isn’t your default browser.")),uY("input",{type:"button",onClick:this.setVivaldiDefault,value:(0,Oe.Z)("browser","Set as Default")}))),uY("div",{className:"setting-single pad-top"},void 0,this.renderCheckbox())))}}const fY=sa(vY,gY);var yY;function CY(e,t,n,s){yY||(yY="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:yY,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class wY extends hs.Component{render(){return(0,fs.jsxs)(fs.Fragment,{children:[CY(mN,{categoryTitle:(0,Oe.Z)("Startup"),filter:this.props.filter},void 0,(0,fs.jsx)(fY,{...this.props}),(0,fs.jsx)(Gj,{...this.props}),(0,fs.jsx)(rY,{...this.props}),!1),CY(mN,{categoryTitle:(0,Oe.Z)("title","Close and Exit"),filter:this.props.filter},"2",(0,fs.jsx)(Fj,{...this.props}),(0,fs.jsx)(Dj,{...this.props}))]})}}const bY=wY;var SY;function IY(e,t,n,s){SY||(SY="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:SY,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class kY extends hs.PureComponent{state={remaining:N().duration({})};componentDidMount=()=>{this.timer=setInterval(this.nextTick,1e3)};componentWillUnmount=()=>clearInterval(this.timer);nextTick=()=>{this.setState({remaining:N().duration(this.props.end.diff(N()()))}),this.props.end.isAfter(N()())?this.props.onElapsed(!1):(this.props.onElapsed(!0),clearInterval(this.timer))};render(){const e=this.state.remaining;return IY("span",{},void 0,(0,Oe.Z)(this.props.label,[e.minutes().toString().padStart(2,"0")+":"+e.seconds().toString().padStart(2,"0")]))}}const AY=kY;var TY;function ZY(e,t,n,s){TY||(TY="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:TY,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function EY(e){d.ZP.openURL(e,"https://login.vivaldi.net/profile/samlsso")}function _Y(){ls.logout()}function MY({windowId:e,deviceName:t,pictureUrl:n,username:s,isLoggedIn:i}){return ZY("div",{className:"sync-status"},void 0,ZY("div",{className:"avatar-username"},void 0,ZY("img",{src:n||"/resources/default-avatar.png",className:"profile-picture",title:(0,Oe.Z)("View account profile page"),onClick:()=>EY(e),alt:""}),ZY("div",{className:"user-info"},void 0,ZY("strong",{className:"username",onClick:()=>EY(e)},void 0,s),ZY("span",{className:"info"},void 0,t&&" "+(0,Oe.Z)("on $1",[t])))),i&&ZY("input",{type:"button",value:(0,Oe.Z)("Log Out"),onClick:_Y}))}var NY,PY,DY=n(34155);function xY(e,t,n,s){NY||(NY="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:NY,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class OY extends hs.PureComponent{_refInput=hs.createRef();state={type:"password"};toggleVisibility=()=>{const e={start:this._refInput.current?.selectionStart||0,end:this._refInput.current?.selectionEnd||0};this.setState((e=>({type:"text"===e.type?"password":"text"}))),DY.nextTick((()=>{this._refInput.current&&(this._refInput.current.selectionStart=e.start,this._refInput.current.selectionEnd=e.end)}))};render(){const{hideButton:e,...t}=this.props;return xY("span",{className:"PasswordInputWrapper"},void 0,(0,fs.jsx)("input",{...t,ref:this._refInput,type:this.state.type,className:"PasswordInput"}),!e&&xY("button",{type:"button",title:"password"===this.state.type?(0,Oe.Z)("title","Show password"):(0,Oe.Z)("Hide password"),onClick:this.toggleVisibility,className:"PasswordToggle",tabIndex:"-1",dangerouslySetInnerHTML:{__html:Ts.sgm.medium}}))}}function LY(e,t,n,s){PY||(PY="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:PY,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const RY="•••••••",BY=Ne.Z.getEventHandler,FY="17006";class VY extends hs.PureComponent{static contextType=xi.Z;constructor(e){super(e),this.state={username:e.accountState.accountInfo.username,password:e.accountState.hasSavedPassword?RY:"",sessionName:"",savePassword:!1,countdownElapsed:!1}}onCountDownElapsed=e=>{this.setState({countdownElapsed:e})};onUsernameChange=e=>{this.setState({username:e.target.value})};onPasswordChange=e=>{this.setState({password:e.target.value})};onSavePasswordChange=e=>{this.setState({savePassword:e.target.checked})};onRecoverAccount=()=>{d.ZP.openURL(this.context.vivaldiWindowId,"https://login.vivaldi.net/profile/id/recoverAccount",{inCurrent:!1})};onPasswordReset=()=>{d.ZP.openURL(this.context.vivaldiWindowId,"https://login.vivaldi.net/profile/id/userInfoView",{inCurrent:!1})};onLogin=()=>{this.state.username&&this.state.password&&ls.login(this.state.username,this.state.password===RY?"":this.state.password,this.state.savePassword)};onLogout=()=>{ls.logout()};onRegister=()=>{this.props.onChangeDisplay()};renderForm=e=>{const t=""!==this.props.accountState.accountInfo.accountId,n=this.props.accountState.hasSavedPassword&&this.props.accountState.accountInfo.username===this.state.username,s=n&&this.state.password===RY;return LY("form",{onSubmit:this.onLogin,noValidate:!0},void 0,LY("h1",{},void 0,(0,Oe.Z)("Log in to Your Account")),LY("p",{},void 0,(0,Oe.Z)("To begin with data synchronization, a confirmed Vivaldi account is required. New to Vivaldi?")," ",LY(hb,{onClick:this.onRegister},void 0,(0,Oe.Z)("Create an Account."))),LY("div",{className:"AccountSheet-Form"},void 0,LY("label",{},void 0,(0,Oe.Z)("Username"),LY("input",{type:"text",value:this.state.username,disabled:t,onChange:this.onUsernameChange,autoFocus:this.props.autoFocus})),!s&&LY(hb,{onClick:this.onRecoverAccount},void 0,(0,Oe.Z)("Forgot Username?")),LY("label",{},void 0,(0,Oe.Z)("Password"),LY(OY,{value:this.state.password,onChange:this.onPasswordChange,hideButton:s})),!n&&LY(hb,{onClick:this.onPasswordReset},void 0,(0,Oe.Z)("Forgot Password?")),LY("label",{className:"AccountSheet-Password"},void 0,LY("input",{type:"checkbox",disabled:s,checked:this.state.savePassword||s,onChange:this.onSavePasswordChange}),(0,Oe.Z)("Save Password")),LY("label",{},void 0,(0,Oe.Z)("Device Name"),LY("input",{type:"text",defaultValue:this.props.customSessionName,placeholder:this.props.defaultSessionName,onChange:BY($.kSyncSessionName)}))),e&&LY(tc,{type:"error"},void 0,e),LY("div",{className:"AccountSheet-Footer"},void 0,t&&LY("input",{type:"button",value:(0,Oe.Z)("Cancel"),onClick:this.onLogout}),LY("input",{type:"submit",value:(0,Oe.Z)("Login")})))};render(){if(G.ZP.isIncognitoOrGuest(this.context.vivaldiWindowId))return null;const{accountState:e,defaultSessionName:t}=this.props,n=e.accountInfo.username,s=e.lastTokenFetchError.serverMessage,i=e.lastTokenFetchError.errorCode,o=N()(e.nextTokenRequestTime),a=H.Z.get($.kSyncSessionName)||t;let r=null;switch((0,Jn.O)(e)){case"loggedIn":return(0,fs.jsxs)(fs.Fragment,{children:[LY("h1",{},void 0,(0,Oe.Z)("Connected")),LY("p",{},void 0,(0,Oe.Z)("Vivaldi account is active and connected.")),LY(MY,{windowId:this.context.vivaldiWindowId,deviceName:a,pictureUrl:e.accountInfo.pictureUrl,username:n,isLoggedIn:!0})]});case"loginFailed":if(s){if(e.lastTokenFetchError.serverMessage.startsWith(FY))break;r=function(e){const t=parseInt(e.substring(0,5));switch(t){case 17001:return(0,Oe.Z)("$1 Account doesn’t exist.",[t]);case 17002:return(0,Oe.Z)("$1 Invalid credentials are provided.",[t]);case 17003:return(0,Oe.Z)("$1 Account is locked after multiple incorrect login attempts, please wait 5 minutes.",[t]);case 17004:return(0,Oe.Z)("$1 Account is disabled.",[t]);case 17005:return(0,Oe.Z)("$1 Account has been temporarily locked as a result of multiple unsuccessful login attempts. Please wait 5 minutes before trying again.",[t]);case 17006:return(0,Oe.Z)("$1 Account hasn’t been activated yet. Please check your email to finish the registration process.",[t]);default:return e}}(s)}else r=-1===i?(0,Oe.Z)("You must use a vivaldi.net user account to log in."):(0,Oe.Z)("Vivaldi.net rejected your credentials: Error code $1",[i]);break;case"loggingIn":return o.isAfter(N()())&&("network_error"===e.lastTokenFetchError.errorType&&(r=(0,Oe.Z)("Unable to connect to vivaldi.net: $1 ($2)",[s,i])),"server_error"===e.lastTokenFetchError.errorType&&(r=s?(0,Oe.Z)("Vivaldi.net is experiencing issues: $1 ($2)",[s,i]):(0,Oe.Z)("Vivaldi.net is experiencing issues: Error code $1",[i]))),(0,fs.jsxs)(fs.Fragment,{children:[LY("div",{className:"AccountSheet-Form"},void 0,LY("p",{className:r?null:"in-progress"},void 0,(0,Oe.Z)("Logging in to Vivaldi.net as $1.",[n]),!r&&" "+(0,Oe.Z)("Please wait."))),r&&LY(tc,{type:"error"},void 0,r," ",LY(AY,{label:(0,Oe.Z)("Retrying in $1"),end:o,onElapsed:this.onCountDownElapsed})),LY("div",{className:"AccountSheet-Footer"},void 0,LY("input",{type:"button",value:(0,Oe.Z)("Cancel"),onClick:this.onLogout}))]});case"credentialsMissing":r=e.hasEncryptedToken?(0,Oe.Z)("Failed to decrypt your credentials. Please log in again."):(0,Oe.Z)("Failed to retreive your credentials. Please log in again.")}return this.renderForm(r)}}const WY=VY;var UY,HY=n(34155);function zY(e,t,n,s){UY||(UY="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:UY,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const GY=/[a-zA-Z0-9]{3,30}/,$Y=q.ZP.UI_LANGUAGE.replace("-","_"),KY=Ne.Z.getEventHandler;let jY=new AbortController;const YY=()=>jY.abort();function XY(e,t){YY();const n=new Promise(((n,s)=>{jY=new AbortController,fetch(e,{method:"POST",body:JSON.stringify(t),signal:jY.signal,headers:{"Content-Type":"application/json"}}).then((e=>{e.ok||s(e.text()),n(e.json())}))})),s=new Promise(((e,t)=>{const n=setTimeout((()=>{clearTimeout(n),t({status:0,statusText:"Error: Connection timed out [9010]"})}),6e4)}));return Promise.race([n,s])}class QY extends hs.PureComponent{static contextType=xi.Z;_refEmailField=hs.createRef();_refConfirmEmailField=hs.createRef();_refUsernameField=hs.createRef();_refAgeField=hs.createRef();_refPasswordField=hs.createRef();_refConfirmPasswordField=hs.createRef();_refVerifyAccountField=hs.createRef();constructor(e){super(e),this.state={username:e.accountState.accountInfo.username||"",email:"",error:"",age:-1,password:"",savePassword:!0,step:e.unverified?3:1,fetching:!1,agreedToTerms:!1,agreedToNewsletter:!1,activationCode:"",activationCount:0},e.unverified&&C.Z.vivaldiAccount.getPendingRegistration((e=>{e&&this.setState({username:e.username,email:e.recovery_email,password:e.password},(()=>this.goToStep(3)))}))}componentWillUnmount(){YY()}getError=e=>{switch(e){case 1001:case 1005:return{error:(0,Oe.Z)("Please choose a username between 3 and 30 letters (a-z) and numbers (0-9) only."),step:1,field:"username"};case 1002:return{error:(0,Oe.Z)("Please enter a valid email address."),step:1,field:"email"};case 1003:return{error:(0,Oe.Z)("We require our members to be at least 16 years old to join."),step:1,field:"age"};case 1004:return{error:(0,Oe.Z)("This email is already linked with another account."),step:1,field:"email"};case 1006:return{error:(0,Oe.Z)("Please choose a password at least 12 characters long."),step:2,field:"password"};case 1007:return{error:(0,Oe.Z)("Username “$1” already exists, please enter another one.",[this.state.username]),step:1,field:"username"};case 1008:return{error:(0,Oe.Z)("Email is in wrong format."),step:1,field:"email"};case 1010:return{error:(0,Oe.Z)("Please enter a realistic lifespan number."),step:1,field:"age"};case 2001:return{error:(0,Oe.Z)("Username contains a reserved word."),step:1,field:"username"};case 2002:return{error:(0,Oe.Z)("Email domain has been blacklisted."),step:1,field:"email"};case 2003:return{error:(0,Oe.Z)("IP address has been blacklisted."),step:1,field:"username"};case 3001:return{error:(0,Oe.Z)("Claims are missing."),step:1,field:"username"};case 4001:return{error:(0,Oe.Z)("Code does not match."),step:3,field:"activationCode"};case 4002:return{error:(0,Oe.Z)("The code has expired. Please request a new activation code."),step:3,field:"activationCode"};case 4004:return{error:(0,Oe.Z)("The code has been invalidated. Please request a new activation code."),step:3,field:"activationCode"};case 5001:return{error:(0,Oe.Z)("Failed to send account activation email."),step:3,field:"activationCode"};case 4003:case 5002:return{error:(0,Oe.Z)("Account has been locked."),step:3,field:"activationCode"};case 9e3:return{error:(0,Oe.Z)("Please fill in the required fields."),step:1,field:"username"};case 9001:return{error:(0,Oe.Z)("Email addresses need to match."),step:1,field:"email"};case 9002:return{error:(0,Oe.Z)("Passwords need to match."),step:2,field:"password"};case 9003:return{error:(0,Oe.Z)("You need to agree to Terms and Conditions."),step:2,field:"password"};case 9004:return{error:(0,Oe.Z)("Activation code should consist of $1 number.","Activation code should consist of $1 numbers.",[6]),step:3,field:"activationCode"};case 9010:return{error:(0,Oe.Z)("Connection error"),step:1,field:"username"};case 9020:return{error:(0,Oe.Z)("Please fill in the username"),step:1,field:"username"};case 9021:return{error:(0,Oe.Z)("Please provide your age"),step:2,field:"age"};case 9022:return{error:(0,Oe.Z)("Please provide your email"),step:1,field:"email"};case 9023:return{error:(0,Oe.Z)("Please fill in the email confirmation"),step:1,field:"confirmEmail"};case 9024:return{error:(0,Oe.Z)("Please provide your password"),step:3,field:"password"};case 9025:return{error:(0,Oe.Z)("Please fill in the password confirmation"),step:2,field:"confirmPassword"};default:return{error:(0,Oe.Z)("Unknown error"),step:1,field:"username"}}};onRegister=e=>{const t=e.currentTarget;t.password.checkValidity()&&t.confirmPassword.checkValidity()&&t.agreed.checkValidity()&&(this.setState({fetching:!0}),XY("https://login.vivaldi.net/profile/sync-registration",{username:this.state.username,emailaddress:this.state.email,password:this.state.password,age:this.state.age,lang:$Y,disableNonce:!0,newsletter:this.state.agreedToNewsletter}).then((e=>{this.parseResponse(e)})).catch((e=>{console.warn("Registration request failed:",e.statusText),this.setState({fetching:!1,error:this.getError(9010).error})})))};onCheckUserCredentials=e=>{const t=e.currentTarget;t.username.checkValidity()&&t.age.checkValidity()&&t.email.checkValidity()&&t.confirmEmail.checkValidity()&&(this.setState({fetching:!0}),this.validateServerData("username").then((()=>this.validateServerData("email"))).then((()=>{this.goToStep(2),this.setState({fetching:!1})})).catch((e=>{console.warn("Account credentials validation failed",e.statusText),this.setState({fetching:!1})})))};parseResponse=e=>{if(e.error){const t=e.error,n=function(e){const t=e.match(/\[(\d+)\]/);return t?parseInt(t[1]):0}(t),{error:s,step:i,field:o}=this.getError(n);this.setState((o=>{let{activationCount:a}=o;return 0===n?{error:t,step:o.step,activationCount:a,fetching:!1}:(a=4001===n?e.attempts_remaining:0,{error:s,step:i,activationCount:a})})),HY.nextTick((()=>this.reportValidity(o,s)))}else e.success?.includes("Registration")?(this.goToStep(3),C.Z.vivaldiAccount.setPendingRegistration({username:this.state.username,recovery_email:this.state.email,password:this.state.savePassword?this.state.password:""})):e.success?.includes("Code has been sent")?this.setState({activationCount:-1}):e.success?.includes("verified")&&(this.resetActivation(),this.state.username&&this.state.password?ls.login(this.state.username,this.state.password,this.state.savePassword):(this.goToStep(1),this.props.onChangeDisplay()))};validateServerData=e=>XY("https://login.vivaldi.net/profile/validateField",{field:e,value:this.state[e]}).then((e=>{this.parseResponse(e)})).catch((t=>(console.warn("Field validation failed",t.statusText,e),this.setState({fetching:!1,error:this.getError(9010).error}),Promise.reject())));debouncedValidate=(0,no.Z)((e=>this.validateServerData(e).catch((()=>{}))),500);reportValidity=(e,t)=>{let n=null;switch(e){case"age":n=this._refAgeField.current;break;case"username":n=this._refUsernameField.current;break;case"email":n=this._refEmailField.current;break;case"confirmEmail":n=this._refConfirmEmailField.current;break;case"password":n=this._refPasswordField.current?._refInput.current;break;case"confirmPassword":n=this._refConfirmPasswordField.current;break;case"activationCode":n=this._refVerifyAccountField.current}n&&(n.setCustomValidity(t),n.focus())};onUsernameChange=e=>{this.resetValidity(e);const t=e.target.value.trim();GY.test(t)&&this.debouncedValidate("username"),this.setState({username:t})};onAgeChange=e=>{this.resetValidity(e),this.setState({age:parseInt(e.target.value)})};onEmailChange=e=>{this.resetValidity(e),this._refConfirmEmailField.current?.setCustomValidity("");const t=e.target.value;this.setState({email:t}),(0,ft.HZ)(t)&&this.debouncedValidate("email")};onPasswordChange=e=>{this.resetValidity(e),this._refConfirmPasswordField?.current?.setCustomValidity(""),this.setState({password:e.target.value})};onSavePasswordChange=({target:e})=>{this.setState({savePassword:e.checked})};agreeToTerms=e=>{this.resetValidity(e),this.setState({agreedToTerms:e.target.checked})};agreeToNewsletter=({target:e})=>{this.setState({agreedToNewsletter:e.checked})};onActivationCodeChange=e=>{const{value:t}=e.target;this.resetValidity(e),this.setState({activationCode:t.trim().substring(0,6)})};verifyAccount=()=>{let{activationCode:e,username:t}=this.state;if(e=e.trim(),6!==e.length||/[^\d]/.test(e)){const{error:e,field:t}=this.getError(9004);return this.reportValidity(t,e),void this.setState({fetching:!1,error:this.getError(9004).error,activationCount:0})}XY("https://login.vivaldi.net/profile/activation-code",{username:t,activation_code:e,lang:$Y}).then((e=>{this.parseResponse(e)})).catch((e=>{console.warn("Code verification failed",e.statusText),this.setState({fetching:!1,error:this.getError(9010).error})}))};sendVerificationCode=()=>{this.setState({error:"",activationCode:""}),XY("https://login.vivaldi.net/profile/resend-activation-code",{username:this.state.username,lang:$Y}).then((e=>{this.parseResponse(e)})).catch((e=>{console.warn("Verification code request failed",e.statusText),this.setState({fetching:!1,error:this.getError(9010).error})}))};goToStep=e=>this.setState({step:e,error:"",activationCount:0});openNewsletterPage=()=>{d.ZP.openURL(this.context.vivaldiWindowId,"https://vivaldi.com/newsletter/",{inCurrent:!1})};openPrivacyPage=()=>{d.ZP.openURL(this.context.vivaldiWindowId,"https://vivaldi.com/privacy/",{inCurrent:!1})};setValidity=e=>{const{name:t,validity:n}=e.target;let s="";switch(!0){case n.rangeUnderflow&&"age"===t:s=this.getError(1003).error;break;case n.rangeOverflow&&"age"===t:s=this.getError(1010).error;break;case n.stepMismatch:case n.rangeUnderflow:case n.rangeOverflow:case n.typeMismatch:case n.patternMismatch:case n.badInput:case n.tooLong:case n.tooShort:"username"===t&&(s=this.getError(1001).error),"password"===t&&(s=this.getError(1006).error),"email"===t&&(s=this.getError(1002).error),"confirmEmail"===t&&(s=this.getError(9001).error),"confirmPassword"===t&&(s=this.getError(9002).error);break;case n.valueMissing:s=this.getError(9e3).error,"agreed"===t&&(s=this.getError(9003).error),"username"===t&&(s=this.getError(9020).error),"age"===t&&(s=this.getError(9021).error),"email"===t&&(s=this.getError(9022).error),"confirmEmail"===t&&(s=this.getError(9023).error),"password"===t&&(s=this.getError(9024).error),"confirmPassword"===t&&(s=this.getError(9025).error);break;case n.customError:s=e.target.validationMessage;case n.valid:}e.target.setCustomValidity(s),e.target.focus(),e.preventDefault(),this.setState({error:s})};resetValidity=e=>{e.target.setCustomValidity(""),this.setState({error:""})};resetActivation=()=>{C.Z.vivaldiAccount.setPendingRegistration()};renderUserDetails=()=>zY("form",{onSubmit:this.onCheckUserCredentials,noValidate:!0},void 0,zY("h1",{},void 0,(0,Oe.Z)("Create an Account")),zY("p",{},void 0,(0,Oe.Z)("To start syncing data across devices, a confirmed Vivaldi account is required. Already have an account?")," ",zY(hb,{onClick:this.props.onChangeDisplay},void 0,(0,Oe.Z)("Log in."))),zY("div",{className:"AccountSheet-Form AccountSheet-FormGrid"},void 0,zY("label",{},void 0,zY(jM,{label:(0,Oe.Z)("Username is used for email, blog link and forum display name. It can only contain letters and numbers, and cannot be changed.")},void 0,(0,Oe.Z)("Username")),(0,fs.jsx)("input",{ref:this._refUsernameField,type:"text",name:"username",value:this.state.username,onChange:this.onUsernameChange,onInvalid:this.setValidity,required:!0,pattern:GY.source,autoFocus:this.props.autoFocus})),zY("label",{},void 0,zY(jM,{label:(0,Oe.Z)("We need this information to prove to authorities that you are older than 16 to comply with the European General Data Protection Regulation (GDPR).")},void 0,(0,Oe.Z)("Age")),(0,fs.jsx)("input",{ref:this._refAgeField,type:"number",name:"age",value:this.state.age>=0?this.state.age:"",onChange:this.onAgeChange,onInvalid:this.setValidity,required:!0,min:"16",max:"150"})),zY("label",{},void 0,zY(jM,{label:(0,Oe.Z)("We’ll use this email address to send you account-related messages (activation, password reset) and technical updates.")},void 0,(0,Oe.Z)("Recovery Email")),(0,fs.jsx)("input",{ref:this._refEmailField,type:"email",name:"email",placeholder:"name@provider.com",value:this.state.email,onChange:this.onEmailChange,onInvalid:this.setValidity,pattern:ft.s9.source,required:!0})),zY("label",{},void 0,(0,Oe.Z)("Confirm Recovery Email"),(0,fs.jsx)("input",{ref:this._refConfirmEmailField,type:"email",name:"confirmEmail",defaultValue:"",onChange:this.resetValidity,onInvalid:this.setValidity,pattern:(0,wy.Z)(this.state.email),required:!0}))),this.state.error&&zY(tc,{type:"error"},void 0,this.state.error),zY("div",{className:"AccountSheet-Footer"},void 0,!this.state.fetching&&zY("input",{type:"submit",value:(0,Oe.Z)("Next")}),this.state.fetching&&zY("span",{className:"FormButton primary in-progress"},void 0,(0,Oe.Z)("Checking..."))));renderPasswordDetails=()=>zY("form",{onSubmit:this.onRegister,noValidate:!0},void 0,zY("h1",{},void 0,(0,Oe.Z)("Create an Account")),zY(MY,{windowId:this.context.vivaldiWindowId,pictureUrl:"",username:this.state.username,deviceName:this.state.email}),zY("div",{className:"AccountSheet-Form AccountSheet-FormGrid"},void 0,zY("label",{},void 0,zY(jM,{label:(0,Oe.Z)("Use 12 or more characters. We recommend using several words separated by spaces.")},void 0,(0,Oe.Z)("Password")),(0,fs.jsx)(OY,{ref:this._refPasswordField,name:"password",value:this.state.password,onChange:this.onPasswordChange,onInvalid:this.setValidity,minLength:"12",required:!0,autoFocus:this.props.autoFocus})),zY("label",{},void 0,(0,Oe.Z)("Confirm Password"),(0,fs.jsx)("input",{type:"password",ref:this._refConfirmPasswordField,name:"confirmPassword",defaultValue:"",onChange:this.resetValidity,onInvalid:this.setValidity,pattern:(0,wy.Z)(this.state.password),required:!0})),zY("label",{className:"columnRow"},void 0,zY("input",{type:"checkbox",checked:this.state.savePassword,onChange:this.onSavePasswordChange}),(0,Oe.Z)("Save Password")),zY("label",{className:"fullRow"},void 0,(0,Oe.Z)("Device Name"),zY("input",{type:"text",className:"device",defaultValue:this.props.customSessionName,placeholder:this.props.defaultSessionName,onChange:KY($.kSyncSessionName)})),zY("span",{className:"fullRow columnRow link"},void 0,zY("label",{},void 0,zY("input",{type:"checkbox",checked:this.state.agreedToNewsletter,onChange:this.agreeToNewsletter}),(0,Oe.Z)("I want to receive the Vivaldi newsletter.")),zY(hb,{title:(0,Oe.Z)("Learn more about Vivaldi Newsletter"),onClick:this.openNewsletterPage},void 0,zY("span",{dangerouslySetInnerHTML:{__html:Ts.vvh.small}}))),zY("span",{className:"fullRow columnRow link"},void 0,zY("label",{},void 0,zY("input",{type:"checkbox",name:"agreed",required:!0,checked:this.state.agreedToTerms,onInvalid:this.setValidity,onChange:this.agreeToTerms}),(0,Oe.Z)("I have read and agree to the Terms of Use and Privacy Policy.")),zY(hb,{title:(0,Oe.Z)("Visit Vivaldi Privacy page"),onClick:this.openPrivacyPage},void 0,zY("span",{dangerouslySetInnerHTML:{__html:Ts.vvh.small}})))),this.state.error&&zY(tc,{type:"error"},void 0,this.state.error),zY("div",{className:"AccountSheet-Footer AccountSheet-Footer--Justified"},void 0,zY("input",{type:"button",value:(0,Oe.Z)("navigation","Back"),onClick:()=>{YY(),this.goToStep(1)}}),!this.state.fetching&&zY("input",{type:"submit",value:(0,Oe.Z)("Register")}),this.state.fetching&&zY("span",{className:"FormButton primary in-progress"},void 0,(0,Oe.Z)("Registering..."))));renderAccountVerification=()=>zY("form",{onSubmit:this.verifyAccount,noValidate:!0},void 0,zY("h1",{},void 0,(0,Oe.Z)("Activate Your Account")),zY(MY,{windowId:this.context.vivaldiWindowId,pictureUrl:"",username:this.state.username,deviceName:this.state.email}),zY("div",{className:"AccountSheet-Form"},void 0,zY("p",{},void 0,this.state.email?(0,Oe.Z)("Activation code has been sent to “$1”.",[this.state.email]):(0,Oe.Z)("Activation code has been sent to your email.")," ",(0,Oe.Z)("Please enter the 6 digit code.")),(0,fs.jsx)("input",{ref:this._refVerifyAccountField,type:"text",onChange:this.onActivationCodeChange,value:this.state.activationCode,name:"activationCode",className:"AccountSheet-Verification",size:6,placeholder:"000000",autoFocus:!0}),zY("p",{},void 0,(0,Oe.Z)("Don’t see the email? Please check your spam folder.")," ",-1!==this.state.activationCount&&zY(hb,{onClick:this.sendVerificationCode},void 0,(0,Oe.Z)("Or get another activation code.")))),this.state.error&&zY(tc,{type:"error"},void 0,this.state.error," ",this.state.error===this.getError(4001).error&&this.state.activationCount>0&&this.state.activationCount<3&&(0,Oe.Z)("$1 attempt remaining.","$1 attempts remaining.",[this.state.activationCount]),this.state.error===this.getError(4001).error&&0===this.state.activationCount&&(0,Oe.Z)("Please request a new activation code.")),!this.state.error&&-1===this.state.activationCount&&zY(tc,{type:"info"},void 0,(0,Oe.Z)("New activation code was sent.")),zY("div",{className:"AccountSheet-Footer AccountSheet-Footer--Justified"},void 0,zY("input",{type:"button",value:(0,Oe.Z)("Cancel"),onClick:()=>{this.resetActivation(),this.props.onChangeDisplay()}}),zY("input",{type:"submit",value:(0,Oe.Z)("Activate Account")})));render(){const{step:e}=this.state;return(0,fs.jsxs)(fs.Fragment,{children:[1===e&&this.renderUserDetails(),2===e&&this.renderPasswordDetails(),3===e&&this.renderAccountVerification()]})}}const qY=QY;var JY;function eX(e,t,n,s){JY||(JY="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:JY,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const tX=[$.kSyncSessionName];class nX extends hs.PureComponent{#h=!1;constructor(e){super(e);const t=Jn.Z.getState();this.state={display:"register"===this.props.view?"register":"login",accountState:t,defaultSessionName:"",unverified:!1}}componentDidMount(){this.#h=!0,Jn.Z.addListener(this.onVivaldiAccountChange),this.onVivaldiAccountChange(),this.setDefaultSession()}setDefaultSession=async()=>{if(!this.#h)return;const e=await(async()=>C.Z.sync.getDefaultSessionName())();this.setState({defaultSessionName:e})};componentWillUnmount(){this.#h=!1,Jn.Z.removeListener(this.onVivaldiAccountChange)}onVivaldiAccountChange=()=>{const e=Jn.Z.getState();this.setState({accountState:e}),e.lastTokenFetchError.serverMessage.includes(FY)&&"loginFailed"===(0,Jn.O)(e)?this.setState({display:"register",unverified:!0}):C.Z.vivaldiAccount.getPendingRegistration((e=>{e&&this.setState({display:"register",unverified:!0})}))};onChangeDisplay=()=>{this.setState((e=>({display:"login"===e.display?"register":"login",unverified:!1})))};render(){const{display:e}=this.state;return eX("div",{className:"AccountSheet"},void 0,eX("span",{className:"AccountSheet-Logo",dangerouslySetInnerHTML:{__html:n(38151)}}),"register"===e&&eX(qY,{autoFocus:this.props.autoFocus,onClose:this.props.onClose,onChangeDisplay:this.onChangeDisplay,defaultSessionName:this.state.defaultSessionName,customSessionName:this.props.prefValues[$.kSyncSessionName],accountState:this.state.accountState,unverified:this.state.unverified}),"login"===e&&eX(WY,{autoFocus:this.props.autoFocus,onClose:this.props.onClose,onChangeDisplay:this.onChangeDisplay,defaultSessionName:this.state.defaultSessionName,accountState:this.state.accountState,customSessionName:this.props.prefValues[$.kSyncSessionName]}))}}const sX=sa(nX,tX),iX="▽",oX="▼",aX="△",rX="▲",lX="⭍",dX={not_synced:(0,Oe.Z)("Not synced"),success:(0,Oe.Z)("sync","Done"),auth_error:(0,Oe.Z)("Sync server refused your credentials"),server_error:(0,Oe.Z)("Sync server encountered an error"),network_error:(0,Oe.Z)("Network error"),conflict:(0,Oe.Z)("Conflict with another client’s data occurred"),throttled:(0,Oe.Z)("Sync server throttled the connection"),other_error:(0,Oe.Z)("Unexpected error")};function cX(e,t){return function(e,t){switch(e){case"not_synced":return t?iX:aX;case"success":return t?oX:rX;default:return lX}}(e,t)+" "+(t?(0,Oe.Z)("Download: $1",[dX[e]]):(0,Oe.Z)("Upload: $1",[dX[e]]))}function hX(e){return[dX[e.downloadUpdatesStatus],dX[e.commitStatus]]}var pX;function uX(e,t,n,s){pX||(pX="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:pX,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const gX={bookmarks:{label:(0,Oe.Z)("Bookmarks"),description:(0,Oe.Z)("Sync bookmarks and Speed Dials"),icon:Ts.CLf.small},preferences:{label:(0,Oe.Z)("Settings"),description:(0,Oe.Z)("Sync Vivaldi settings (not all settings are syncable)"),icon:Ts.bqs.small},passwords:{label:(0,Oe.Z)("Passwords"),description:(0,Oe.Z)("Sync stored webpage passwords"),icon:Ts._ZF},autofill:{label:(0,Oe.Z)("other","Autofill"),description:(0,Oe.Z)("Sync form autofill information"),icon:Ts.lku},history:{label:(0,Oe.Z)("History"),description:(0,Oe.Z)("Sync History and Typed Urls"),icon:Ts.hcy.small},extensions:{label:(0,Oe.Z)("Extensions"),description:(0,Oe.Z)("Sync browser extensions and settings"),icon:Ts.v9y.small},apps:{label:(0,Oe.Z)("Apps"),description:(0,Oe.Z)("Sync Web Apps"),icon:Ts.v9y.small},reading_list:{label:(0,Oe.Z)("Reading List"),description:(0,Oe.Z)("Sync the Reading List"),icon:Ts.R_e.small},tabs:{label:(0,Oe.Z)("Tabs"),description:(0,Oe.Z)("Sync open tabs"),icon:Ts.hcy.small},notes:{label:(0,Oe.Z)("Notes"),description:(0,Oe.Z)("Sync Vivaldi Notes (attachments are not syncable)"),icon:Ts.fbI}};class mX extends hs.Component{static contextType=xi.Z;syncAllId="syncAll__"+crypto.randomUUID();syncPartsId="syncParts__"+crypto.randomUUID();constructor(e){super(e),this.state={countdownElapsed:!1,showConfirmClearDataDialog:!1,showChangeFeedback:!1,dataTypes:e.syncState.engineData.dataTypes}}componentWillUnmount(){clearTimeout(this.changeTimeout)}onCountDownElapsed=e=>{this.setState({countdownElapsed:e})};onSyncEverythingChange=()=>{this.setChangeFeedback(),C.Z.sync.setTypes(!0,this.props.syncState.engineData.dataTypes),C.Z.sync.setupComplete(),this.setState((e=>({dataTypes:e.dataTypes.map((e=>(e.enabled=!0,e)))})))};onDataTypeChange=e=>{const t=e.target.name,n=e.target.checked;this.setState((e=>{const s=e.dataTypes,i=s.find((e=>e.dataType===t));return i&&(i.enabled=n),{dataTypes:s}})),C.Z.sync.setTypes(this.props.syncState.engineData.syncEverything,this.props.syncState.engineData.dataTypes)};setChangeFeedback=()=>{clearTimeout(this.changeTimeout),this.setState({showChangeFeedback:!0},(()=>this.changeTimeout=setTimeout(this.resetChangeFeedback,1e3)))};resetChangeFeedback=()=>{this.setState({showChangeFeedback:!1})};onApplyChanges=()=>{this.setChangeFeedback(),C.Z.sync.setTypes(!1,this.state.dataTypes),C.Z.sync.setupComplete()};onClearData=()=>{this.setState({showConfirmClearDataDialog:!0})};onConfirmClearDataDialog=e=>{this.setState({showConfirmClearDataDialog:!1}),e&&Xn.clearData()};onSaveBackupKey=()=>{C.Z.utilities.selectFile({windowId:this.context.vivaldiWindowId,title:(0,Oe.Z)("Save Backup Encryption Key"),type:"save_file",accepts:[{ext:"txt"}]}).then((e=>{e&&C.Z.sync.backupEncryptionToken(e,(e=>{e||console.warn("File not saved (vivaldi.sync)")}))}))};renderResetButton=()=>"configuration_pending"===this.props.syncState.engineData.engineState?null:uX("input",{type:"button",onClick:this.onClearData,value:(0,Oe.Z)("Reset Remote Data")});render(){const{cycleData:e,engineData:t}=this.props.syncState,n="not_synced"!==this.props.syncState.cycleData.downloadUpdatesStatus?N()(this.props.syncState.cycleData.cycleStartTime).calendar():"...",s=this.state.dataTypes.map((e=>uX("li",{},e.dataType,uX("label",{className:"grid"},void 0,uX("span",{className:"icon",dangerouslySetInnerHTML:{__html:gX[e.dataType].icon}}),uX("h3",{},void 0,gX[e.dataType].label),uX("span",{className:"description"},void 0,gX[e.dataType].description),uX("input",{type:"checkbox",name:e.dataType,checked:e.enabled,onChange:this.onDataTypeChange}))))),[i,o]=this.state.showChangeFeedback?[hX(e)[0],(0,Oe.Z)("Updating")]:hX(e),a=this.state.showChangeFeedback?"in_progress":e.commitStatus;let r=null;if(0!==parseInt(e.nextRetryTime)){const t=N()(e.nextRetryTime);r=t.isBefore(N()())?uX("p",{className:"in-progress"},void 0,(0,Oe.Z)("Retrying")):uX(AY,{label:(0,Oe.Z)("Retrying in $1"),end:t,onElapsed:this.onCountDownElapsed})}const l=t.syncEverything?this.syncAllId:this.syncPartsId,d="configuration_pending"===t.engineState;return uX(US.Z,{filter:this.props.filter},void 0,uX("div",{className:"setting-group-double"},void 0,!d&&uX("div",{className:"sync-status detail"},void 0,uX("span",{className:"time"},void 0,(0,Oe.Z)("Last sync:")," ",uX("strong",{},void 0,n)),uX("span",{className:`data-in ${e.downloadUpdatesStatus}`},void 0,uX("span",{className:"icon",dangerouslySetInnerHTML:{__html:Ts.OXd}}),(0,Oe.Z)("Download: $1",[i])),uX("span",{className:`data-out ${a}`},void 0,uX("span",{className:"icon",dangerouslySetInnerHTML:{__html:Ts.uUH}}),(0,Oe.Z)("Upload: $1",[o]))),r&&uX(tc,{type:"info"},void 0,r),t.isEncryptingEverything&&(0,fs.jsxs)(fs.Fragment,{children:[uX("div",{className:"status"},void 0,uX("span",{className:"icon",dangerouslySetInnerHTML:{__html:Ts._ZF}}),(0,Oe.Z)("Data secured by encryption password.")),uX("div",{className:"status"},void 0,uX("label",{},void 0,uX("span",{className:"icon",dangerouslySetInnerHTML:{__html:Ts.SpM}}),uX(jM,{label:(0,Oe.Z)("Store the backup recovery key in a secure place. If you forget your encryption password, you may use this key to retrieve your sync data. We won’t be able to recover your data since your password and backup key are never sent to us.")},void 0,uX(hb,{onClick:this.onSaveBackupKey},void 0,(0,Oe.Z)("Save Backup Encryption Key")))))]}),!t.isEncryptingEverything&&uX(tc,{type:"error"},void 0,(0,Oe.Z)("Sync encryption failed. We recommend that you clear remote Sync data and restart Sync with your current browser data.")),this.state.showConfirmClearDataDialog&&uX(SA,{title:(0,Oe.Z)("Delete Remote Sync Data"),prompt:[(0,Oe.Z)("This will remove all sync data stored on the Vivaldi server, reset your encryption password, and log you out.")],positive:(0,Oe.Z)("Delete Sync Data"),negative:(0,Oe.Z)("Cancel"),onClose:this.onConfirmClearDataDialog,danger:!0})),d&&uX("div",{className:"sync-status-confirmed"},void 0,uX("h3",{},void 0,(0,Oe.Z)("All set! Time to decide what data to sync between devices."))),uX("div",{className:"setting-group-double pad-top"},void 0,uX(lH,{activeTabId:l,icons:[Ts.uWq,Ts.o7J]},void 0,uX("div",{label:(0,Oe.Z)("Sync All Data"),id:this.syncAllId},void 0,uX("div",{className:"TabbedView--Padded"},void 0,uX("p",{},void 0,!d&&t.syncEverything&&(0,Oe.Z)("All data is synchronized, and synchronization of new data types is automatically enabled."),!d&&!t.syncEverything&&(0,Oe.Z)("Selected data subset is synchronized.")," ",(!t.isFirstSetupComplete||!t.syncEverything)&&(0,Oe.Z)("Sychronize all data, and automatically enable synchronization of new data types."))),uX("div",{className:"TabbedView-Footer"},void 0,this.renderResetButton(),uX("input",{type:"submit",value:t.isFirstSetupComplete?(0,Oe.Z)("Sync All Data"):(0,Oe.Z)("Start Syncing"),onClick:this.onSyncEverythingChange,disabled:t.syncEverything&&!d,autoFocus:t.isFirstSetupComplete&&this.props.autoFocus}))),uX("div",{label:(0,Oe.Z)("Sync Selected Data"),id:this.syncPartsId},void 0,uX("form",{onSubmit:this.onApplyChanges},void 0,uX("ul",{},void 0,s),uX("div",{className:"TabbedView-Footer"},void 0,this.renderResetButton(),uX("input",{type:"submit",disabled:!d&&(!t.isSetupInProgress&&t.isFirstSetupComplete||(0,xA.Z)(this.state.dataTypes,this.props.syncState.engineData.dataTypes)),value:t.isFirstSetupComplete?(0,Oe.Z)("Apply Changes"):(0,Oe.Z)("Start Syncing"),autoFocus:!t.isFirstSetupComplete&&this.props.autoFocus})))))))}}const vX=mX;var fX;function yX(e,t,n,s){fX||(fX="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:fX,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class CX extends hs.Component{static contextType=xi.Z;ID1="fm1__"+crypto.randomUUID();ID2="fm2__"+crypto.randomUUID();state={encryptionPassword:"",wrongPasswordEntered:!1,wrongBackupKey:"key"===this.props.unlockAttempt,showConfirmClearDataDialog:!1};onEncryptionPasswordChange=e=>{this.setState({wrongPasswordEntered:!1,wrongBackupKey:!1,encryptionPassword:e.target.value})};onDecrypt=()=>{this.setState({wrongPasswordEntered:!1}),Xn.setEncryptionPassword(this.state.encryptionPassword,(e=>{this.props.onUnlockAttempt("passphrase"),e||this.setState({wrongPasswordEntered:!0,wrongBackupKey:!1})}))};onPasswordLost=()=>{this.setState({showConfirmClearDataDialog:!0,wrongPasswordEntered:!1,wrongBackupKey:!1})};resetErrorState=()=>{this.setState({wrongPasswordEntered:!1,wrongBackupKey:!1})};onConfirmClearDataDialog=e=>{this.setState({showConfirmClearDataDialog:!1}),e&&Xn.clearData()};onUploadEncyptionKey=()=>{C.Z.utilities.selectFile({windowId:this.context.vivaldiWindowId,title:(0,Oe.Z)("Select Backup Encryption Key file"),type:"file",accepts:[{ext:"txt"}]}).then((e=>{e&&C.Z.sync.restoreEncryptionToken(e).then((e=>{this.props.onUnlockAttempt("key"),e||this.setState({wrongPasswordEntered:!1,wrongBackupKey:!0})}))}))};renderForgotPassword=()=>yX(hb,{onClick:this.onPasswordLost},void 0,(0,Oe.Z)("Forgot Password?"));render(){return yX(mN,{categoryTitle:(0,Oe.Z)("Encryption Password"),filter:this.props.filter},void 0,yX(US.Z,{filter:this.props.filter},void 0,yX("div",{className:"setting-group-double"},void 0,this.state.showConfirmClearDataDialog&&yX(SA,{title:(0,Oe.Z)("Delete Remote Sync Data"),prompt:[(0,Oe.Z)("Without your current encryption password we’re unable to decrypt your data. Resetting this password requires deleting all existing Sync data on Vivaldi servers.")],positive:(0,Oe.Z)("Delete Sync Data"),negative:(0,Oe.Z)("Cancel"),onClose:this.onConfirmClearDataDialog,danger:!0}),yX(lH,{activeTabId:"key"===this.props.unlockAttempt?this.ID2:void 0,icons:[Ts.WHX,Ts.c02],onTabClick:this.resetErrorState},void 0,yX("div",{label:(0,Oe.Z)("Encryption Password"),id:this.ID1},void 0,yX("form",{onSubmit:this.onDecrypt},void 0,yX("div",{className:"TabbedView--Padded"},void 0,yX("p",{},void 0,(0,Oe.Z)("The data received from the Sync server is encrypted. Please provide your encryption password to decrypt it.")),yX("label",{className:"setting-single encryption"},void 0,yX("span",{},void 0,(0,Oe.Z)("Encryption Password")),yX(OY,{value:this.state.encryptionPassword,onChange:this.onEncryptionPasswordChange,autoFocus:this.props.autoFocus})),this.state.wrongPasswordEntered&&yX(tc,{type:"error"},void 0,(0,Oe.Z)("Wrong password entered."))),yX("div",{className:"TabbedView-Footer"},void 0,this.renderForgotPassword(),yX("input",{type:"submit",value:(0,Oe.Z)("Decrypt")})))),yX("div",{label:(0,Oe.Z)("Load Encryption Key"),id:this.ID2},void 0,yX("div",{className:"TabbedView--Padded"},void 0,yX("p",{},void 0,(0,Oe.Z)("To recover data without a password, you may use your Backup Encryption Key, provided you have saved it earlier.")),this.state.wrongBackupKey&&yX(tc,{type:"error"},void 0,(0,Oe.Z)("Unable to decrypt with given backup encryption key."))),yX("div",{className:"TabbedView-Footer"},void 0,this.renderForgotPassword(),yX("input",{type:"button",onClick:this.onUploadEncyptionKey,value:(0,Oe.Z)("Load")})))))))}}const wX=CX;var bX;function SX(e,t,n,s){bX||(bX="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:bX,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class IX extends hs.Component{static contextType=xi.Z;_input=hs.createRef();state={encryptionPassword:"",shortPassword:!1};onSetPassword=()=>{!this.state.encryptionPassword||this.state.encryptionPassword.length<12?(this.setState({shortPassword:!0}),this._input.current?._refInput.current?.focus()):this.doSetPassword(this.state.encryptionPassword)};doSetPassword=e=>{Xn.setEncryptionPassword(e,(e=>{e&&this.setState({shortPassword:!1})}))};onEncryptionPasswordChange=e=>{this.setState({encryptionPassword:e.target.value}),e.target.value.length>=12&&this.setState({shortPassword:!1})};render(){return SX(US.Z,{filter:this.props.filter},void 0,SX("h2",{},void 0,(0,Oe.Z)("Set a New Encryption Password")),SX("form",{onSubmit:this.onSetPassword},void 0,SX("div",{className:"setting-group-double"},void 0,SX("div",{className:"setting-single"},void 0,SX("p",{},void 0,(0,Oe.Z)("To encrypt and protect your sync data (passwords, bookmarks, notes, and more), please create an encryption password. This password will never be sent to us."))),SX("div",{className:"setting-single"},void 0,SX("label",{className:"encryption-password"},void 0,SX("span",{className:"icon",dangerouslySetInnerHTML:{__html:Ts._ZF}}),(0,Oe.Z)("Encryption Password"),(0,fs.jsx)(OY,{ref:this._input,value:this.state.encryptionPassword,onChange:this.onEncryptionPasswordChange})),this.state.shortPassword&&SX(tc,{type:"error"},void 0,(0,Oe.Z)("Minimum password length of $1 character is required.","Minimum password length of $1 characters is required.",[12]))),SX("div",{className:"setting-single align-right pad-top"},void 0,SX("input",{type:"submit",value:(0,Oe.Z)("Save and Continue"),autoFocus:this.props.autoFocus})))))}}const kX=IX;class AX extends F.Z{getInitialState(){return{engineData:{engineState:"stopped",disableReasons:[],protocolErrorType:"success",protocolErrorDescription:"",protocolErrorClientAction:"unknown",usesEncryptionPassword:!1,needsDecryptionPassword:!1,isEncryptingEverything:!1,isSetupInProgress:!1,isFirstSetupComplete:!1,syncEverything:!0,dataTypes:[],isReady:!1},cycleData:{cycleStartTime:0,downloadUpdatesStatus:"not_synced",commitStatus:"not_synced",nextRetryTime:0,isReady:!1}}}reduce(e,t){switch(t.actionType){case"SYNC_ENGINE_STATE_CHANGED":return{engineData:t.engineData,cycleData:e.cycleData};case"SYNC_CYCLE_COMPLETED":return{engineData:e.engineData,cycleData:t.cycleData}}return e}}const TX=new AX;var ZX,EX=n(34155);function _X(e,t,n,s){ZX||(ZX="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:ZX,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const MX=[$.kSyncSessionName];class NX extends hs.Component{static contextType=xi.Z;constructor(e){super(e),this.state={syncState:TX.getState(),accountState:Jn.Z.getState(),defaultSessionName:"",unlockAttempt:""}}componentDidMount(){TX.addListener(this.onSyncStoreChange),Jn.Z.addListener(this.onVivaldiAccountChange),this.onSyncStoreChange(),this.onVivaldiAccountChange(),C.Z.sync.getDefaultSessionName((e=>this.setState({defaultSessionName:e})))}componentWillUnmount(){TX.removeListener(this.onSyncStoreChange),Jn.Z.removeListener(this.onVivaldiAccountChange)}onSyncStoreChange=()=>{this.setState({syncState:TX.getState()})};onVivaldiAccountChange=()=>{this.setState({accountState:Jn.Z.getState()})};onUnlockAttempt=e=>{this.setState({unlockAttempt:e})};restartSync=()=>{Xn.stop(),EX.nextTick((()=>Xn.start()))};startSync=()=>{Xn.start()};stopSync=()=>{Xn.stop()};getContent=()=>{const e=this.state.syncState.engineData;if(e.disableReasons.includes("enterprise_policy"))return _X("p",{},void 0,(0,Oe.Z)("Sync has been disabled by your administrator"));const t=e.engineState;if(!this.state.accountState.hasToken)return null;switch(t){case"stopped":return _X("div",{className:"setting-group-double"},void 0,"disable_sync_on_client"===e.protocolErrorClientAction&&_X("p",{},void 0,(0,Oe.Z)("Sync was stopped following a request from the server: $1",["not_my_birthday"===e.protocolErrorType?(0,Oe.Z)("Sync server data was reset"):e.protocolErrorDescription])),_X("input",{type:"button",onClick:this.startSync,value:(0,Oe.Z)("Start Sync")}));case"failed":if(e.disableReasons.includes("not_signed_in"))return _X("div",{className:"setting-group-double"},void 0,_X("p",{className:"in-progress"},void 0,(0,Oe.Z)("Waiting for account details")),_X("input",{type:"button",onClick:this.stopSync,value:(0,Oe.Z)("Cancel")}));if(e.disableReasons.includes("flag"))return _X("p",{},void 0,(0,Oe.Z)("Sync was disabled from the command line"));let t=(0,Oe.Z)("Unexpected error. You may need to restart Vivaldi.");if(e.disableReasons.includes("unrecoverable_error")){if("upgrade_client"===e.protocolErrorClientAction)return _X("p",{},void 0,(0,Oe.Z)("You must upgrade Vivaldi in order to use Sync"));t=(0,Oe.Z)("Sync must be restarted: $1",[e.protocolErrorDescription])}return _X("div",{className:"setting-group-double"},void 0,_X("p",{},void 0,t),_X("input",{type:"button",onClick:this.restartSync,value:(0,Oe.Z)("sync","Restart")}));case"starting":return _X("p",{className:"in-progress"},void 0,(0,Oe.Z)("Initializing Sync..."));case"starting_server_error":return _X("p",{className:"in-progress"},void 0,(0,Oe.Z)("The sync server is experiencing issues. Retrying initialization soon."));case"clearing_data":return _X("p",{className:"in-progress"},void 0,(0,Oe.Z)("Clearing Sync data. Please wait."));case"configuration_pending":case"started":return e.needsDecryptionPassword?_X(wX,{filter:this.props.filter,autoFocus:this.props.category!==je.jk.settingCategories.all,unlockAttempt:this.state.unlockAttempt,onUnlockAttempt:this.onUnlockAttempt}):e.usesEncryptionPassword?_X(vX,{filter:this.props.filter,syncState:this.state.syncState,autoFocus:this.props.category!==je.jk.settingCategories.all}):_X(kX,{filter:this.props.filter,autoFocus:this.props.category!==je.jk.settingCategories.all})}return null};render(){if(G.ZP.isIncognitoOrGuest(this.context.vivaldiWindowId))return _X("p",{},void 0,(0,Oe.Z)("Sync settings are unavailable in Private Windows."));if(!this.state.syncState.engineData.isReady||!this.state.syncState.cycleData.isReady||!this.state.accountState.isReady)return null;const e=this.getContent(),{username:t,pictureUrl:n}=this.state.accountState.accountInfo,s=this.props.prefValues[$.kSyncSessionName]||this.state.defaultSessionName,i=(0,Jn.O)(this.state.accountState);return _X(mN,{categoryTitle:(0,Oe.Z)("Sync"),filter:this.props.filter,className:"sync-setup"},void 0,_X(US.Z,{filter:this.props.filter},void 0,_X("div",{className:"setting-group-double"},void 0,"loggedIn"!==i?_X(sX,{onClose:Aa.Z,view:(o=this.props.url,"register"===(0,vs.DP)(o).view?"register":"login"),autoFocus:this.props.category!==je.jk.settingCategories.all},this.props.url):_X(MY,{windowId:this.context.vivaldiWindowId,pictureUrl:n,username:t,deviceName:s,isLoggedIn:!0}))),e&&_X(US.Z,{filter:this.props.filter},void 0,e));var o}}const PX=sa(NX,MX);var DX;function xX(e,t,n,s){DX||(DX="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:DX,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const OX=Ne.Z.getEventHandler,LX=[$.kTabsActivationOnClose,$.kTabsActivationPreferRelated,$.kTabsAlignNext,$.kTabsDoubleClickClose,$.kTabsFocusWebview,$.kTabsBarPosition,$.kTabsNeverCloseLast,$.kTabsConfirmClosingTabs,$.kTabsConfirmClosingThreshold];var RX=xX("input",{type:"radio",value:"activation_order"}),BX=xX("input",{type:"radio",value:"left"}),FX=xX("input",{type:"radio",value:"right"});class VX extends hs.Component{confirmClosingTabsMinThreshold=1;confirmClosingTabsMaxThreshold=99;isHorizontal=()=>{const e=this.props.prefValues[$.kTabsBarPosition];return"top"===e||"bottom"===e};render(){const{prefValues:e}=this.props;return xX(US.Z,{filter:this.props.filter},void 0,xX("span",{},void 0,xX("div",{className:"setting-group"},void 0,xX("div",{className:"setting-single"},void 0,xX("h3",{},void 0,(0,Oe.Z)("Close Tab Activation")),xX("div",{className:"setting-single"},void 0,xX("label",{title:(0,Oe.Z)("Activate tabs related by origin first")},void 0,xX("input",{type:"checkbox",checked:e[$.kTabsActivationPreferRelated],onChange:OX($.kTabsActivationPreferRelated)}),xX("span",{},void 0,(0,Oe.Z)("Always Activate Related Tab")))),xX("div",{className:"setting-single pad-top"},void 0,xX(vl,{name:"tabActivate",value:e[$.kTabsActivationOnClose],onChange:OX($.kTabsActivationOnClose)},void 0,xX("div",{className:"setting-single"},void 0,xX("label",{},void 0,RX,xX("span",{},void 0,(0,Oe.Z)("Activate in Recently Used Order")))),xX("div",{className:"setting-single"},void 0,xX("label",{},void 0,BX,xX("span",{},void 0,this.isHorizontal()?(0,Oe.Z)("Activate Left in Tab Order"):(0,Oe.Z)("Activate Above in Tab Order")))),xX("div",{className:"setting-single"},void 0,xX("label",{},void 0,FX,xX("span",{},void 0,this.isHorizontal()?(0,Oe.Z)("Activate Right in Tab Order"):(0,Oe.Z)("Activate Below in Tab Order")))))))),xX("div",{className:"setting-group"},void 0,xX("h3",{},void 0,(0,Oe.Z)("Tab Handling")),xX("div",{className:"setting-single"},void 0,xX("label",{title:(0,Oe.Z)("Align the close buttons to easily close multiple tabs")},void 0,xX("input",{type:"checkbox",checked:e[$.kTabsAlignNext],onChange:OX($.kTabsAlignNext)}),xX("span",{},void 0,(0,Oe.Z)("Align Next Close Button")))),xX("div",{className:"setting-single"},void 0,xX("label",{},void 0,xX("input",{type:"checkbox",checked:e[$.kTabsDoubleClickClose],onChange:OX($.kTabsDoubleClickClose)}),xX("span",{},void 0,(0,Oe.Z)("Close Tab on Double Click")))),xX("div",{className:"setting-single"},void 0,xX("label",{title:(0,Oe.Z)("Prevents window closing along with last tab.")},void 0,xX("input",{type:"checkbox",checked:e[$.kTabsNeverCloseLast],onChange:OX($.kTabsNeverCloseLast)}),xX("span",{},void 0,(0,Oe.Z)("Keep Window Open when Last Tab is Closed")))),xX("div",{className:"setting-single max-bookmarks"},void 0,xX("label",{},void 0,xX("input",{type:"checkbox",checked:this.props.prefValues[$.kTabsConfirmClosingTabs],onChange:OX($.kTabsConfirmClosingTabs)}),xX("span",{},void 0,(0,Oe.Z)("Confirm Closing Tabs over Maximum of")),xX("input",{type:"number",size:"2",disabled:!this.props.prefValues[$.kTabsConfirmClosingTabs],value:this.props.prefValues[$.kTabsConfirmClosingThreshold],onChange:OX($.kTabsConfirmClosingThreshold),min:this.confirmClosingTabsMinThreshold,max:this.confirmClosingTabsMaxThreshold}))),xX("div",{className:"setting-single"},void 0,xX("label",{title:(0,Oe.Z)("Focus page content instead of addressfield")},void 0,xX("input",{type:"checkbox",checked:e[$.kTabsFocusWebview],onChange:OX($.kTabsFocusWebview)}),xX("span",{},void 0,(0,Oe.Z)("Focus Page Content on New Tab")))))))}}const WX=sa(VX,LX);var UX;function HX(e,t,n,s){UX||(UX="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:UX,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const zX=Ne.Z.getEventHandler,GX=[$.kMouseWheelTabSwitch,$.kTabsCycleByRecentOrder,$.kTabsMinimize,$.kTabsVisualSwitchEnable,$.kTabsVisualSwitchListLayout];var $X=HX("input",{type:"radio",value:"true"}),KX=HX("input",{type:"radio",value:"false"});class jX extends hs.Component{render(){const e=this.props.prefValues;return HX(US.Z,{filter:this.props.filter},void 0,HX("div",{className:"setting-group"},void 0,HX("h3",{htmlFor:"tabSelection"},void 0,(0,Oe.Z)("Tab Cycling")),HX(vl,{name:"tabCyclingOrder",value:this.props.prefValues[$.kTabsCycleByRecentOrder],onChange:zX($.kTabsCycleByRecentOrder,"convert")},void 0,HX("div",{className:"setting-single"},void 0,HX("label",{},void 0,$X,HX("span",{},void 0,(0,Oe.Z)("Cycle in Recently Used Order")))),HX("div",{className:"setting-single"},void 0,HX("label",{},void 0,KX,HX("span",{},void 0,(0,Oe.Z)("Cycle in Tab Order"))))),HX("div",{className:"setting-single pad-top"},void 0,HX("label",{},void 0,HX("input",{type:"checkbox",checked:this.props.prefValues[$.kTabsVisualSwitchEnable],onChange:zX($.kTabsVisualSwitchEnable)}),HX("span",{},void 0,(0,Oe.Z)("Show Tab Cycler")))),HX("div",{className:"setting-single pad-left"},void 0,HX("label",{},void 0,HX("input",{type:"checkbox",checked:this.props.prefValues[$.kTabsVisualSwitchListLayout],disabled:!this.props.prefValues[$.kTabsVisualSwitchEnable],onChange:zX($.kTabsVisualSwitchListLayout)}),HX("span",{},void 0,(0,Oe.Z)("Display Tab Cycler as List")))),HX("div",{className:"setting-single"},void 0,HX("label",{title:(0,Oe.Z)("Scroll over Tab Bar to switch tabs by order, or scroll anywhere else while holding Alt key to switch tabs per Tab Cycling setting.")},void 0,HX("input",{type:"checkbox",checked:e[$.kMouseWheelTabSwitch],onChange:zX($.kMouseWheelTabSwitch)}),HX("span",{},void 0,(0,Oe.Z)("Switch Tabs by Scrolling")))),HX("div",{className:"setting-single"},void 0,HX("label",{},void 0,HX("input",{type:"checkbox",checked:this.props.prefValues[$.kTabsMinimize],onChange:zX($.kTabsMinimize)}),HX("span",{},void 0,(0,Oe.Z)("Minimize Active Tab"))),HX("p",{className:"info"},void 0,(0,Oe.Z)("Click current tab to switch to last active tab.")))))}}const YX=sa(jX,GX);var XX;function QX(e,t,n,s){XX||(XX="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:XX,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const qX=Ne.Z.getEventHandler,JX=[$.kTabsAutoMuting];var eQ=QX("input",{type:"radio",value:"off"}),tQ=QX("input",{type:"radio",value:"onlyActive"}),nQ=QX("input",{type:"radio",value:"prioritizeActive"});class sQ extends hs.Component{render(){return QX(US.Z,{filter:this.props.filter},void 0,QX("div",{className:"setting-group"},void 0,QX("h3",{},void 0,(0,Oe.Z)("Mute Tab Audio")),QX(vl,{name:"mutableTabs",value:this.props.prefValues[$.kTabsAutoMuting],onChange:qX($.kTabsAutoMuting)},void 0,QX("div",{className:"setting-single"},void 0,QX("label",{},void 0,eQ,QX("span",{},void 0,(0,Oe.Z)("Play All Audio")))),QX("div",{className:"setting-single"},void 0,QX("label",{},void 0,tQ,QX("span",{},void 0,(0,Oe.Z)("Play Only in Active Tab")))),QX("div",{className:"setting-single"},void 0,QX("label",{},void 0,nQ,QX("span",{},void 0,(0,Oe.Z)("Prioritize Active Tab")))))))}}const iQ=sa(sQ,JX);var oQ;function aQ(e,t,n,s){oQ||(oQ="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:oQ,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const rQ=Ne.Z.getEventHandler,lQ=[$.kTabsActivationOnClone,$.kTabsNewPlacement,$.kTabsOpenNewInBackground];var dQ=aQ("input",{type:"radio",value:"rightofcurrent"}),cQ=aQ("input",{type:"radio",value:"directrightofcurrent"}),hQ=aQ("input",{type:"radio",value:"alwayslast"}),pQ=aQ("input",{type:"radio",value:"openintabstackwithrelated"}),uQ=aQ("input",{type:"radio",value:"rightofcurrent"}),gQ=aQ("input",{type:"radio",value:"alwayslast"});class mQ extends hs.Component{render(){return aQ(US.Z,{filter:this.props.filter},void 0,aQ("span",{},void 0,aQ("div",{className:"setting-group"},void 0,aQ("div",{className:"setting-single"},void 0,aQ("h3",{},void 0,(0,Oe.Z)("New Tab Position")),aQ(vl,{name:"tabOpen",value:this.props.prefValues[$.kTabsNewPlacement],onChange:rQ($.kTabsNewPlacement)},void 0,aQ("div",{className:"setting-single"},void 0,aQ("label",{},void 0,dQ,aQ("span",{},void 0,(0,Oe.Z)("After Related Tabs")))),aQ("div",{className:"setting-single"},void 0,aQ("label",{},void 0,cQ,aQ("span",{},void 0,(0,Oe.Z)("After Active Tab")))),aQ("div",{className:"setting-single"},void 0,aQ("label",{},void 0,hQ,aQ("span",{},void 0,(0,Oe.Z)("As Last Tab")))),aQ("div",{className:"setting-single"},void 0,aQ("label",{},void 0,pQ,aQ("span",{},void 0,(0,Oe.Z)("As Tab Stack with Related Tab"))))),aQ("div",{className:"setting-single pad-top"},void 0,aQ("label",{},void 0,aQ("input",{type:"checkbox",checked:this.props.prefValues[$.kTabsOpenNewInBackground],onChange:rQ($.kTabsOpenNewInBackground)}),aQ("span",{},void 0,(0,Oe.Z)("New Tab from Link Opens in Background")))))),aQ("div",{className:"setting-group"},void 0,aQ("div",{className:"setting-single"},void 0,aQ("h3",{},void 0,(0,Oe.Z)("Duplicated Tab Position")),aQ(vl,{name:"tabClone",value:this.props.prefValues[$.kTabsActivationOnClone],onChange:rQ($.kTabsActivationOnClone)},void 0,aQ("div",{className:"setting-single"},void 0,aQ("label",{},void 0,uQ,aQ("span",{},void 0,(0,Oe.Z)("Next to Original Tab")))),aQ("div",{className:"setting-single"},void 0,aQ("label",{},void 0,gQ,aQ("span",{},void 0,(0,Oe.Z)("As Last Tab")))))))))}}const vQ=sa(mQ,lQ);var fQ;function yQ(e,t,n,s){fQ||(fQ="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:fQ,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const CQ=Ne.Z.getEventHandler,wQ=[$.kMouseWheelTabSwitch,$.kTabsActiveMinSize,$.kTabsAtEdge,$.kTabsCloseButtonLeft,$.kTabsCloseButtonPermanent,$.kTabsCounterDetection,$.kTabsDimHibernated,$.kTabsHorizontalScrolling,$.kTabsPageLoadInfo,$.kTabsBarPosition,$.kTabsShowCloseButton,$.kTabsShowSyncedTabsButton,$.kTabsShowTrashCan,$.kTabsStackingMode,$.kTabsThumbnails,$.kTabsTooltip,$.kTabsUnread,$.kWorkspacesEnabled,$.kWorkspacesButtonShowInTabbar];var bQ=yQ("input",{type:"radio",value:"progress_bar"}),SQ=yQ("input",{type:"radio",value:"progress_icon"}),IQ=yQ("input",{type:"radio",value:"spinner"}),kQ=yQ("input",{type:"radio",value:"none"});class AQ extends hs.Component{render(){const{prefValues:e}=this.props,{hasToken:t,isReady:s}=Jn.Z.getState();return yQ(US.Z,{filter:this.props.filter},void 0,yQ("div",{className:"setting-group"},void 0,yQ("h3",{},void 0,(0,Oe.Z)("tbd","Tab Bar")),yQ("div",{className:"setting-single"},void 0,yQ("label",{},void 0,yQ("input",{type:"checkbox",checked:e[$.kTabsHorizontalScrolling],onChange:CQ($.kTabsHorizontalScrolling)}),yQ("span",{},void 0,(0,Oe.Z)("Enable Horizontal Scrolling"))),yQ("p",{className:"info"},void 0,(0,Oe.Z)("Hold Shift key when “Switch Tabs by Scrolling” setting is enabled."))),yQ("div",{className:"setting-single"},void 0,yQ("label",{},void 0,yQ("input",{type:"checkbox",checked:e[$.kTabsAtEdge],onChange:CQ($.kTabsAtEdge)}),yQ("span",{},void 0,(0,Oe.Z)("Remove Tab Spacing in Maximized Windows")))),yQ("div",{className:"setting-single"},void 0,yQ("label",{},void 0,yQ("input",{type:"checkbox",checked:e[$.kTabsShowTrashCan],onChange:CQ($.kTabsShowTrashCan)}),yQ("span",{},void 0,(0,Oe.Z)("Display Trash Can")))),yQ("div",{className:"setting-single"},void 0,yQ("label",{},void 0,yQ("input",{type:"checkbox",checked:e[$.kTabsShowSyncedTabsButton],onChange:CQ($.kTabsShowSyncedTabsButton),disabled:!t&&!s}),yQ("span",{},void 0,(0,Oe.Z)("Display Synced Tabs Button"))),!t&&!s&&yQ("p",{className:"info"},void 0,(0,Oe.Z)("This setting requires active Sync.")))),yQ("div",{className:"setting-group"},void 0,yQ("div",{className:"setting-single"},void 0,yQ("h3",{},void 0,(0,Oe.Z)("Tab Options")),yQ("div",{className:"setting-single"},void 0,yQ("label",{},void 0,yQ("input",{type:"checkbox",checked:e[$.kTabsTooltip],onChange:CQ($.kTabsTooltip)}),yQ("span",{},void 0,(0,Oe.Z)("Show Popup Thumbnails")))),yQ("div",{className:"setting-single"},void 0,yQ("label",{},void 0,yQ("input",{type:"checkbox",checked:e[$.kTabsThumbnails],onChange:CQ($.kTabsThumbnails)}),yQ("span",{},void 0,(0,Oe.Z)("Show Tab Thumbnails")))),yQ("div",{className:"setting-single"},void 0,yQ("label",{},void 0,yQ("input",{type:"checkbox",checked:e[$.kTabsShowCloseButton],onChange:CQ($.kTabsShowCloseButton)}),yQ("span",{},void 0,(0,Oe.Z)("Display Close Button")))),yQ("div",{className:"setting-single pad-left"},void 0,yQ("label",{title:(0,Oe.Z)("Display Close button on left side of a tab")},void 0,yQ("input",{type:"checkbox",disabled:!e[$.kTabsShowCloseButton],checked:e[$.kTabsCloseButtonLeft],onChange:CQ($.kTabsCloseButtonLeft)}),yQ("span",{},void 0,(0,Oe.Z)("On Left Side")))),yQ("div",{className:"setting-single pad-left"},void 0,yQ("label",{title:(0,Oe.Z)("Permanently display Close button")},void 0,yQ("input",{type:"checkbox",disabled:!e[$.kTabsShowCloseButton],checked:e[$.kTabsCloseButtonPermanent],onChange:CQ($.kTabsCloseButtonPermanent)}),yQ("span",{},void 0,(0,Oe.Z)("Permanently")))),yQ("div",{className:"setting-single"},void 0,yQ("label",{title:(0,Oe.Z)("Detect and display numeric notification from page title in Tabs and Web Panels")},void 0,yQ("input",{type:"checkbox",checked:e[$.kTabsCounterDetection],onChange:CQ($.kTabsCounterDetection)}),yQ("span",{},void 0,(0,Oe.Z)("Detect Page Title Notifications")))),yQ("div",{className:"setting-single"},void 0,yQ("label",{title:(0,Oe.Z)("Display a triangle symbol for unread Tabs")},void 0,yQ("input",{type:"checkbox",checked:e[$.kTabsUnread],onChange:CQ($.kTabsUnread)}),yQ("span",{},void 0,(0,Oe.Z)("Use Unread Indicators"))),yQ("div",{className:e[$.kTabsUnread]?"img-setting":"img-setting disabled"},void 0,yQ("span",{className:"image",dangerouslySetInnerHTML:{__html:n(33271)}}))),yQ("div",{className:"setting-single"},void 0,yQ("label",{},void 0,yQ("input",{type:"checkbox",checked:e[$.kTabsDimHibernated],onChange:CQ($.kTabsDimHibernated)}),yQ("span",{},void 0,(0,Oe.Z)("Dim Icon when Hibernated")))))),yQ("div",{className:"setting-group tab-min-width"},void 0,yQ("h3",{},void 0,(0,Oe.Z)("Active Tab Minimum Width")),yQ("div",{className:"setting-single"},void 0,yQ(RB,{value:e[$.kTabsActiveMinSize],min:30,max:180,step:30,onChange:CQ($.kTabsActiveMinSize),label:(0,Oe.Z)("$1 pixel","$1 pixels",[parseInt(e[$.kTabsActiveMinSize])]),title:(0,Oe.Z)("Minimum width of horizontally scaled active tab")}))),yQ("div",{className:"setting-group"},void 0,yQ("h3",{},void 0,(0,Oe.Z)("Page Load Progress")),yQ(vl,{name:"tabPageLoadInfo",value:this.props.prefValues[$.kTabsPageLoadInfo],onChange:CQ($.kTabsPageLoadInfo)},void 0,yQ("div",{className:"setting-single"},void 0,yQ("label",{title:(0,Oe.Z)("Display tab progress bar while page is loading")},void 0,bQ,yQ("span",{},void 0,(0,Oe.Z)("Progress Bar")))),yQ("div",{className:"setting-single"},void 0,yQ("label",{title:(0,Oe.Z)("Display circular progress in place of favicon while page is loading")},void 0,SQ,yQ("span",{},void 0,(0,Oe.Z)("Favicon Progress")))),yQ("div",{className:"setting-single"},void 0,yQ("label",{title:(0,Oe.Z)("Display spinner in place of favicon while page is loading")},void 0,IQ,yQ("span",{},void 0,(0,Oe.Z)("Favicon Spinner")))),yQ("div",{className:"setting-single"},void 0,yQ("label",{title:(0,Oe.Z)("Don’t display page loading progress")},void 0,kQ,yQ("span",{},void 0,(0,Oe.Z)("radio","None")))))))}}const TQ=sa(AQ,wQ);var ZQ;function EQ(e,t,n,s){ZQ||(ZQ="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:ZQ,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const _Q=Ne.Z.getEventHandler,MQ=[$.kExtensionURLOverrides,$.kTabsNewPageLink];class NQ extends hs.Component{state={customUrl:H.Z.get($.kTabsNewPageCustomUrl)};_handleCustomUrlChange=({currentTarget:e})=>{const t=e.value;this.setState({customUrl:t}),this._saveCustomUrl(t)};_saveCustomUrl=e=>{const t=(0,vs.q9)(e);Ne.Z.set($.kTabsNewPageCustomUrl,t),this.props.prefValues[$.kTabsNewPageLink]!==h.Fp.CUSTOM&&Ne.Z.set($.kTabsNewPageLink,h.Fp.CUSTOM)};focusCustomUrlInput=()=>{this._customPageRef&&this._customPageRef.focus()};render(){const e=this.props.prefValues,t=e[$.kExtensionURLOverrides].newtab?.some((e=>e.active)),n=e[$.kTabsNewPageLink]===h.Fp.EXTENSION;return EQ(US.Z,{filter:this.props.filter},void 0,EQ("div",{className:"setting-group new-tab-page"},void 0,EQ("h3",{},void 0,(0,Oe.Z)("title","New Tab Page")),EQ(vl,{name:"tabPageSettings",value:e[$.kTabsNewPageLink],onChange:_Q($.kTabsNewPageLink)},void 0,EQ("div",{className:"setting-single"},void 0,EQ("label",{},void 0,EQ("input",{type:"radio",value:h.Fp.STARTPAGE,checked:e[$.kTabsNewPageLink]===h.Fp.STARTPAGE||e[$.kTabsNewPageLink]===h.Fp.EXTENSION,onChange:_Q($.kTabsNewPageLink)}),EQ("span",{},void 0,(0,Oe.Z)("noun","Start Page")))),EQ("div",{className:"setting-single pad-left"},void 0,EQ("label",{title:(0,Oe.Z)("Allow installed third-party extensions to control the Start Page")},void 0,EQ("input",{type:"checkbox",disabled:!t,checked:n,onChange:_Q($.kTabsNewPageLink),value:n?h.Fp.STARTPAGE:h.Fp.EXTENSION}),EQ("span",{},void 0,(0,Oe.Z)("Controlled by Extension")))),EQ("div",{className:"setting-single"},void 0,EQ("label",{},void 0,EQ("input",{type:"radio",value:h.Fp.HOMEPAGE}),EQ("span",{},void 0,(0,Oe.Z)("other","Homepage")))),EQ("div",{className:"setting-single"},void 0,EQ("label",{},void 0,EQ("input",{type:"radio",value:h.Fp.BLANKPAGE}),EQ("span",{},void 0,(0,Oe.Z)("other","Blank Page")))),EQ("div",{className:"setting-single"},void 0,EQ("label",{},void 0,EQ("input",{type:"radio",className:"pad-top",onMouseUp:this.focusCustomUrlInput,value:h.Fp.CUSTOM}),EQ("span",{},void 0,(0,fs.jsx)("input",{type:"text",ref:e=>this._customPageRef=e,placeholder:(0,Oe.Z)("Specific Page"),onChange:this._handleCustomUrlChange,value:this.state.customUrl,tabIndex:e[$.kTabsNewPageLink]===h.Fp.CUSTOM?0:-1})))))))}}const PQ=sa(NQ,MQ);var DQ;function xQ(e,t,n,s){DQ||(DQ="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:DQ,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const OQ=[$.kTabsClosePinned,$.kTabsShowSeparator],LQ=Ne.Z.getEventHandler;var RQ=xQ("input",{type:"radio",value:"off"}),BQ=xQ("input",{type:"radio",value:"bury"}),FQ=xQ("input",{type:"radio",value:"on"});class VQ extends hs.Component{render(){return xQ(US.Z,{filter:this.props.filter},void 0,xQ("div",{className:"setting-group"},void 0,xQ("h3",{},void 0,(0,Oe.Z)("Pinned Tabs")),xQ(vl,{name:"closablePinnedTabs",value:this.props.prefValues[$.kTabsClosePinned],onChange:LQ($.kTabsClosePinned)},void 0,xQ("div",{className:"setting-single"},void 0,xQ("label",{},void 0,RQ,xQ("span",{},void 0,(0,Oe.Z)("Don’t Close Pinned Tabs")))),xQ("div",{className:"setting-single"},void 0,xQ("label",{},void 0,BQ,xQ("span",{},void 0,(0,Oe.Z)("Minimize Instead of Close")))),xQ("div",{className:"setting-single"},void 0,xQ("label",{},void 0,FQ,xQ("span",{},void 0,(0,Oe.Z)("Close as Other Tabs"))))),xQ("div",{className:"setting-single pad-top"},void 0,xQ("label",{},void 0,xQ("input",{type:"checkbox",checked:this.props.prefValues[$.kTabsShowSeparator],onChange:LQ($.kTabsShowSeparator)}),xQ("span",{},void 0,(0,Oe.Z)("Show Separator Below Pinned Tabs"))))))}}const WQ=sa(VQ,OQ);var UQ;function HQ(e,t,n,s){UQ||(UQ="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:UQ,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const zQ={top:(0,Oe.Z)("Top"),right:(0,Oe.Z)("title","Right"),bottom:(0,Oe.Z)("Bottom"),left:(0,Oe.Z)("title","Left")};var GQ=HQ("g",{},void 0,HQ("path",{className:"thumb-preview-colorBg",d:"M0 0h96v76H0z"}),HQ("path",{className:"thumb-preview-colorBgDark",d:"M0 0h96v12H0z"}),HQ("path",{className:"thumb-preview-non-active-tab",d:"M33 2h30v8H33zM64 2h30v8H64z"}),HQ("path",{className:"thumb-preview-colorAccentBg",d:"M2 2h30v8H2z"})),$Q=HQ("g",{},void 0,HQ("path",{className:"thumb-preview-colorBg",d:"M0 0h96v76H0z"}),HQ("path",{className:"thumb-preview-colorBgDark",d:"M62 0h34v76H62z"}),HQ("path",{className:"thumb-preview-non-active-tab",d:"M64 11h30v8H64zM64 20h30v8H64z"}),HQ("path",{className:"thumb-preview-colorAccentBg",d:"M64 2h30v8H64z"})),KQ=HQ("g",{},void 0,HQ("path",{className:"thumb-preview-colorBg",d:"M0 0h96v76H0z"}),HQ("path",{className:"thumb-preview-colorBgDark",d:"M0 64h96v12H0z"}),HQ("path",{className:"thumb-preview-non-active-tab",d:"M33 66h30v8H33zM64 66h30v8H64z"}),HQ("path",{className:"thumb-preview-colorAccentBg",d:"M2 66h30v8H2z"})),jQ=HQ("g",{},void 0,HQ("path",{className:"thumb-preview-colorBg",d:"M0 0h96v76H0z"}),HQ("path",{className:"thumb-preview-colorBgDark",d:"M0 0h34v76H0z"}),HQ("path",{className:"thumb-preview-non-active-tab",d:"M2 11h30v8H2zM2 20h30v8H2z"}),HQ("path",{className:"thumb-preview-colorAccentBg",d:"M2 2h30v8H2z"})),YQ=HQ("svg",{xmlns:"http://www.w3.org/2000/svg",className:"selectbox-checkmark",viewBox:"0 0 16 16"},void 0,HQ("path",{d:"M5.3 13.3L1.5 9.5 3 8l2.3 2.5L13 2.7 14.6 4l-8 8z"}));class XQ extends hs.Component{render(){if(!this.props.position)return null;const e=this.props.position,t=zQ[this.props.position],n=As()({selectbox:!0,"selectbox-selected":this.props.selected}),s=(0,Oi.Z)(this.props,["position","vivaldiSettings"]);return(0,fs.jsxs)("button",{className:n,title:t,...s,children:[HQ("div",{className:"selectbox-image"},void 0,HQ("svg",{viewBox:"0 0 96 76",xmlns:"http://www.w3.org/2000/svg",className:"tab-preview"},void 0,"top"===e&&GQ,"right"===e&&$Q,"bottom"===e&&KQ,"left"===e&&jQ),YQ),HQ("div",{className:"selectbox-title"},void 0,t)]})}}const QQ=XQ;var qQ;function JQ(e,t,n,s){qQ||(qQ="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:qQ,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const eq="left",tq="right",nq="bottom",sq=[$.kKeyboardTabToAll,$.kTabsBarPosition,$.kTabsVisible],iq=Ne.Z.getEventHandler;class oq extends hs.Component{setTabPosition=e=>{Ne.Z.set($.kTabsBarPosition,e)};render(){const e=this.props.prefValues,t=e[$.kTabsBarPosition];return JQ(US.Z,{filter:this.props.filter},void 0,JQ("div",{className:"setting-group unlimited"},void 0,JQ("div",{className:"setting-single"},void 0,JQ("label",{},void 0,JQ("input",{type:"checkbox",checked:e[$.kTabsVisible],onChange:iq($.kTabsVisible)}),JQ("span",{},void 0,(0,Oe.Z)("radio","Show Tab Bar"))))),JQ("div",{className:"setting-group unlimited"},void 0,JQ("div",{className:"setting-single tabbar-position"},void 0,JQ("h3",{},void 0,(0,Oe.Z)("Tab Bar Position")),JQ("div",{className:"selectbox-container"},void 0,JQ(QQ,{position:"top",selected:"top"===t,onClick:this.setTabPosition.bind(this,"top")}),JQ(QQ,{position:"left",selected:t===eq,onClick:this.setTabPosition.bind(this,eq)}),JQ(QQ,{position:"right",selected:t===tq,onClick:this.setTabPosition.bind(this,tq)}),JQ(QQ,{position:"bottom",selected:t===nq,onClick:this.setTabPosition.bind(this,nq)})))))}}const aq=sa(oq,sq);var rq;function lq(e,t,n,s){rq||(rq="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:rq,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const dq=Ne.Z.getEventHandler,cq=[$.kTabsSelectionEnabled,$.kTabsSelectionIncludeActive];class hq extends hs.Component{render(){return lq(US.Z,{filter:this.props.filter},void 0,lq("div",{className:"setting-group"},void 0,lq("div",{className:"setting-single"},void 0,lq("h3",{},void 0,(0,Oe.Z)("Tab Selection")),lq("div",{className:"setting-single"},void 0,lq("label",{title:(0,Oe.Z)("Select multiple tabs with Ctrl and Shift")},void 0,lq("input",{type:"checkbox",checked:this.props.prefValues[$.kTabsSelectionEnabled],onChange:dq($.kTabsSelectionEnabled)}),lq("span",{},void 0,(0,Oe.Z)("Enable Tab Selection")))),lq("div",{className:"setting-single"},void 0,lq("label",{title:(0,Oe.Z)("The active tab will always be part of the initial tab selection")},void 0,lq("input",{type:"checkbox",checked:this.props.prefValues[$.kTabsSelectionIncludeActive],onChange:dq($.kTabsSelectionIncludeActive)}),lq("span",{},void 0,(0,Oe.Z)("Include Active Tab in Initial Selection")))))))}}const pq=sa(hq,cq);var uq;function gq(e,t,n,s){uq||(uq="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:uq,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const mq=Ne.Z.getEventHandler,vq=[$.kTabsStackingAllowDnd,$.kTabsStackingAutoExpand,$.kTabsStackingMode,$.kTabsStackingOpenInCurrent,$.kTabsBarWidth,$.kTabsBarPosition,$.kTabsStackingPreferDotted,$.kTabsStackingDndDelay];class fq extends hs.Component{render(){const{prefValues:e}=this.props;return gq(US.Z,{filter:this.props.filter},void 0,gq("div",{className:"setting-group"},void 0,gq("h3",{},void 0,(0,Oe.Z)("Tab Stacking")),gq("div",{className:"setting-single"},void 0,gq("label",{},void 0,gq("input",{name:"tab-stack-style",type:"radio",value:"dotted",checked:"dotted"===e[$.kTabsStackingMode],onChange:mq($.kTabsStackingMode)}),gq("span",{},void 0,(0,Oe.Z)("radio","Compact"))),gq("div",{className:"dotted"===e[$.kTabsStackingMode]?"img-setting":"img-setting disabled"},void 0,gq("span",{className:"image",dangerouslySetInnerHTML:{__html:n(18998)}}))),gq("div",{className:"setting-single pad-top"},void 0,gq("label",{},void 0,gq("input",{name:"tab-stack-style",type:"radio",value:"substrip",checked:"substrip"===e[$.kTabsStackingMode],onChange:()=>{Ne.Z.set($.kTabsBarWidth,260),Ne.Z.set($.kTabsStackingMode,"substrip")}}),gq("span",{},void 0,(0,Oe.Z)("Two-Level"))),gq("div",{className:"substrip"===e[$.kTabsStackingMode]?"img-setting":"img-setting disabled"},void 0,gq("span",{className:e[$.kTabsStackingPreferDotted]?"image alternate":"image",dangerouslySetInnerHTML:{__html:n(86681)}}))),gq("div",{className:"setting-single pad-left"},void 0,gq("label",{},void 0,gq("input",{type:"checkbox",disabled:"substrip"!==e[$.kTabsStackingMode],checked:e[$.kTabsStackingPreferDotted],onChange:mq($.kTabsStackingPreferDotted)}),gq("span",{},void 0,(0,Oe.Z)("Use Compact Display Style")))),gq("div",{className:"setting-single pad-top"},void 0,gq("label",{},void 0,gq("input",{name:"tab-stack-style",type:"radio",value:"accordion",checked:"accordion"===e[$.kTabsStackingMode],onChange:mq($.kTabsStackingMode)}),gq("span",{},void 0,(0,Oe.Z)("Accordion"))),gq("div",{className:"accordion"===e[$.kTabsStackingMode]?"img-setting":"img-setting disabled"},void 0,gq("span",{className:"image",dangerouslySetInnerHTML:{__html:n(86484)}}))),gq("div",{className:"setting-single pad-left"},void 0,gq("label",{},void 0,gq("input",{type:"checkbox",disabled:"accordion"!==e[$.kTabsStackingMode],checked:e[$.kTabsStackingAutoExpand],onChange:mq($.kTabsStackingAutoExpand)}),gq("span",{},void 0,(0,Oe.Z)("Auto Expand")))),gq("div",{className:"setting-single pad-top"},void 0,gq("label",{},void 0,gq("input",{name:"tab-stack-style",type:"radio",value:"off",checked:"off"===e[$.kTabsStackingMode],onChange:mq($.kTabsStackingMode)}),gq("span",{},void 0,(0,Oe.Z)("Disable"))))),gq("div",{className:"setting-group"},void 0,gq("h3",{},void 0,(0,Oe.Z)("Tab Stack Options")),gq("div",{className:"setting-single"},void 0,gq("label",{},void 0,gq("input",{type:"checkbox",disabled:"off"===e[$.kTabsStackingMode],checked:e[$.kTabsStackingOpenInCurrent],onChange:mq($.kTabsStackingOpenInCurrent)}),gq("span",{},void 0,(0,Oe.Z)("Open Tabs in Current Tab Stack")))),gq("div",{className:"setting-single"},void 0,gq("label",{},void 0,gq("input",{type:"checkbox",disabled:"off"===e[$.kTabsStackingMode],checked:e[$.kTabsStackingAllowDnd],onChange:mq($.kTabsStackingAllowDnd)}),gq("span",{},void 0,(0,Oe.Z)("Allow Stacking by Drag and Drop")))),gq("div",{className:"setting-single stacking-delay pad-left"},void 0,gq("label",{htmlFor:"stacking-delay",title:(0,Oe.Z)("Adjust tab stack drop detection delay when moving a tab over another one.")},void 0,(0,Oe.Z)("Stacking Drop Delay")),gq("input",{type:"range",id:"stacking-delay",value:e[$.kTabsStackingDndDelay],min:50,max:850,step:200,disabled:!e[$.kTabsStackingAllowDnd]||"off"===e[$.kTabsStackingMode],onChange:mq($.kTabsStackingDndDelay)}),gq("p",{className:"info stack-speed"},void 0,gq("span",{},void 0,(0,Oe.Z)("Short")),gq("span",{},void 0,(0,Oe.Z)("Long"))))))}}const yq=sa(fq,vq);Ne.Z.getEventHandler,$.kTabsTilingCollapseBorder;var Cq;function wq(e,t,n,s){Cq||(Cq="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Cq,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const bq=["❤️","✨","😊","🎁","😂","🎉","👍","✅","⭐","👉","😉","🥰","👀","🤔","😭","🥳","💵","✈️","📚"],Sq=({closeModal:e,onPick:t,top:n,left:s,activeIcon:i,activeEmoji:o})=>{const a=(0,hs.useRef)(),[r,l]=(0,hs.useState)(void 0!==o),d=e=>{if(r){const n=e.currentTarget.dataset.emoji;return void t(n)}const n=parseInt(e.currentTarget.dataset.id);isNaN(n)||t(n)};return wq(_r.Z,{viewMode:"icon-picker",onRequestClose:e,style:{width:230,minWidth:"unset",top:n,left:s,right:"auto"}},void 0,wq("form",{onSubmit:n=>{const s=a.current?.value;s?t(s):e()}},void 0,wq("header",{className:"dialog-header"},void 0,(0,Oe.Z)("Select Workspace Icon"),wq("div",{className:"dialog-header buttons"},void 0,wq("input",{type:"button",className:r?"":"active",value:(0,Oe.Z)("Icon"),onClick:()=>l(!1)}),wq("input",{type:"button",className:r?"active":"",value:`${(0,Oe.Z)("Emoji")} 😀`,onClick:()=>l(!0)}))),wq("div",{className:"dialog-content workspaces"},void 0,!r&&wq("ul",{},void 0,Kj.S.map(((e,t)=>wq("li",{className:i===e?"active":"","data-id":t,onClick:d},t,wq("span",{className:"icon",dangerouslySetInnerHTML:{__html:e}}))))),r&&(0,fs.jsxs)(fs.Fragment,{children:[wq("ul",{},void 0,bq.map(((e,t)=>wq("li",{className:o===e?"active":"","data-emoji":e,onClick:d},e,e))),o&&!bq.includes(o)&&wq("li",{className:"active","data-emoji":o,onClick:d},o,o)),(0,fs.jsx)("input",{ref:a,type:"text",pattern:"^(?:\\p{Emoji}+(?:\\ufe0f|\\u200d)*)+\\p{Emoji}?$",placeholder:(0,Oe.Z)("Paste any emoji here 👍"),onChange:e=>{const n=a.current,s=n?.value;s&&!n?.validity.patternMismatch&&t(s)}})]})),wq("footer",{className:"dialog-footer"},void 0,wq("input",{type:"submit",value:(0,Oe.Z)("OK"),autoFocus:!0}),wq("input",{type:"button",onClick:e,value:(0,Oe.Z)("Cancel"),autoFocus:!0}))))};var Iq,kq=n(29104);function Aq(e){const t=Kj.Z.getWorkspaces(e),n=(0,Oe.Z)("title","New Workspace");if(!t.some((e=>e.name===n)))return n;const s=`^${(0,Oe.Z)("New Workspace $1",["(\\d+)"])}$`,i=t.map((e=>{const t=e.name.match(s);if(t)return Number(t[1]).valueOf()})).filter(Boolean),o=0===i.length?0:Math.max(...i);return(0,Oe.Z)("New Workspace $1",[o+1])}function Tq(e,t,n,s){Iq||(Iq="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Iq,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Zq(){return Kj.S[Math.floor(Math.random()*Kj.S.length)]}class Eq extends hs.PureComponent{static contextType=xi.Z;refTop=hs.createRef();state={name:Aq(this.context.vivaldiWindowId),isIconPickerVisible:!1,includeTabs:!1,activeIcon:Zq(),activeEmoji:void 0};handleDismiss=this.props.onClose;handleChange=e=>{this.setState({name:e.currentTarget.value})};handleCheckbox=()=>{this.setState((e=>({includeTabs:!e.includeTabs})))};handleCreate=e=>{const{name:t,activeIcon:n,activeEmoji:s,includeTabs:i}=this.state;e.preventDefault(),t&&n&&(kq.Z.addWorkspace(t,n,s,i,this.props.createInBackground),this.props.onClose())};showIconPicker=()=>{this.props.onShowIconPicker?this.props.onShowIconPicker():this.setState({isIconPickerVisible:!0})};hideIconPicker=()=>{this.setState({isIconPickerVisible:!1})};handlePick=e=>{if("number"==typeof e){const t=Kj.S[e];this.setState({activeIcon:t,activeEmoji:void 0})}else this.setState({activeEmoji:e});this.hideIconPicker()};handleFocus=e=>{e.target instanceof this.context.HTMLInputElement&&e.target.select()};scrollIntoView=()=>{this.refTop.current?.scrollIntoViewIfNeeded()};render(){const{name:e,activeIcon:t,activeEmoji:n,includeTabs:s,isIconPickerVisible:i}=this.state,o=this.props,a=void 0===G.ZP.getActiveWorkspace(o.windowId);return(0,fs.jsxs)("div",{ref:this.refTop,className:As()("workspace-new",o.className),style:o.style,children:[Tq("header",{className:"dialog-header"},void 0,Tq("h1",{},void 0,(0,Oe.Z)("workspaces","Create Workspace"))),Tq("div",{className:"dialog-content"},void 0,Tq("form",{className:"create-form",onSubmit:this.handleCreate},void 0,Tq("div",{className:"icon-button",style:{alignItems:a?"center":"flex-end"},onClick:this.showIconPicker,dangerouslySetInnerHTML:{__html:n??t}}),Tq("div",{className:"inputs"},void 0,Tq("label",{},void 0,(0,Oe.Z)("Workspace Name"),Tq("input",{type:"text",value:e,placeholder:(0,Oe.Z)("Choose Workspace Name"),onChange:this.handleChange,autoFocus:!0,onFocus:this.handleFocus})),a&&!o.disableMoveTabs&&Tq("label",{},void 0,Tq("input",{type:"checkbox",checked:s,onChange:this.handleCheckbox}),(0,Oe.Z)("Move tabs from current window to new workspace"))))),Tq("footer",{className:"dialog-footer"},void 0,Tq("input",{type:"button",value:(0,Oe.Z)("Create"),className:"primary",disabled:!e,onClick:this.handleCreate}),Tq("input",{type:"button",value:(0,Oe.Z)("Cancel"),onClick:this.handleDismiss})),i&&Tq(Sq,{closeModal:this.hideIconPicker,onPick:this.handlePick,activeIcon:t,activeEmoji:n,top:0,left:50})]})}}const _q=Eq;var Mq,Nq=n(5200),Pq=n(59240);function Dq(e,t,n,s){Mq||(Mq="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Mq,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const xq="DRAGGABLE_RULE";var Oq=Dq("option",{value:""},"");function Lq({windowId:e,rule:t,ruleCount:n,style:s,workspaces:i,findItem:o,moveItem:a,onDelete:r,onFocus:l,onTypeChanged:d,onExpressionChanged:c,onWorkspaceChanged:h,onDrop:p,onAddWorkspace:u}){const g=hs.useRef(null),m=o(t.id)?.index,v=(m??0)+1,[{isDragging:f,handlerId:y},C]=(0,Nq.c)((()=>({type:xq,item:{id:t.id,originalIndex:m},collect:e=>({isDragging:e.isDragging(),handlerId:e.getHandlerId()})})),[t.id,m]),[,w]=(0,Pq.L)((()=>({accept:xq,hover(e,n){if(!g.current||"number"!=typeof m)return;const s=e.originalIndex,i=m;if(s===i)return;const o=g.current?.getBoundingClientRect(),r=(o.bottom-o.top)/2,l=n.getClientOffset().y-o.top;s<i&&l<r||s>i&&l>r||(a(e.id,t.id),e.originalIndex=i)},drop:p})),[t.id,a]);return C(g),w(g),(0,fs.jsxs)("div",{ref:g,className:"WorkspaceLinkRouting-Item",style:{...s,opacity:f?0:1},"data-handler-id":y,children:[Dq("div",{className:"header"},void 0,Dq("p",{className:"name"},void 0,(0,Oe.Z)("Workspace Rule $1",[v])),Dq("div",{},void 0,Dq("input",{type:"button",className:"circular remove",title:(0,Oe.Z)("Remove Workspace Rule"),onClick:r}))),Dq("form",{},void 0,Dq("div",{},void 0,(0,Oe.Z)("If URL")),Dq("div",{className:"inputs"},void 0,Dq("select",{value:t.type,onChange:d,onFocus:l},void 0,Dq("option",{value:"CONTAINS"},void 0,(0,Oe.Z)("contains")),Dq("option",{value:"EQUALS"},void 0,(0,Oe.Z)("is")),Dq("option",{value:"STARTSWITH"},void 0,(0,Oe.Z)("starts with"))),Dq(sc.Z,{label:"",className:"expression",type:"text",placeholder:(0,Oe.Z)("https://"),value:t.expression,onChange:c,onFocus:l,hasError:!t.expression})),Dq("div",{},void 0,(0,Oe.Z)("Open in")),Dq("div",{className:"inputs"},void 0,i.length>0&&Dq("select",{name:"workspaceId",value:t.workspaceId,onChange:h,onFocus:l},void 0,!t.workspaceId&&Oq,i.map((e=>Dq("option",{value:e.id},e.id,e.name))),Dq("option",{value:"NEW_WORKSPACE"},void 0,(0,Oe.Z)("+ Create New Workspace"))),0===i.length&&Dq("div",{className:"toolbar toolbar-default toolbar-group"},void 0,Dq("div",{className:"toolbar-group"},void 0,Dq(Fa,{onClick:u,image:Ts.md4.medium,title:(0,Oe.Z)("Add Workspace")})))))]},t.id)}const Rq=hs.memo(Lq);function Bq(e){const t={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=0);return t}function Fq(e,t,n){for(const s in t){if(!Object.prototype.hasOwnProperty.call(t,s))continue;if(0!==n[s])return!1;const i="number"==typeof t[s]?t[s]:t[s].val;if(e[s]!==i)return!1}return!0}const Vq=[0,0];function Wq(e,t,n,s,i,o,a){const r=n+(-i*(t-s)+-o*n)*e,l=t+r*e;return Math.abs(r)<a&&Math.abs(l-s)<a?(Vq[0]=s,Vq[1]=0,Vq):(Vq[0]=l,Vq[1]=r,Vq)}function Uq(e){const t={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]="number"==typeof e[n]?e[n]:e[n].val);return t}const Hq=1e3/60;class zq extends hs.Component{static contextType=xi.Z;constructor(e){super(e),this.state=this.defaultState()}unmounting=!1;wasAnimating=!1;animationID=null;prevTime=0;accumulatedTime=0;defaultState(){const{defaultStyle:e,style:t}=this.props,n=e||Uq(t),s=Bq(n);return{currentStyle:n,currentVelocity:s,lastIdealStyle:n,lastIdealVelocity:s}}unreadPropStyle=null;clearUnreadPropStyle=e=>{let t=!1,{currentStyle:n,currentVelocity:s,lastIdealStyle:i,lastIdealVelocity:o}=this.state;for(const a in e){if(!Object.prototype.hasOwnProperty.call(e,a))continue;const r=e[a];"number"==typeof r&&(t||(t=!0,n={...n},s={...s},i={...i},o={...o}),n[a]=r,s[a]=0,i[a]=r,o[a]=0)}t&&this.setState({currentStyle:n,currentVelocity:s,lastIdealStyle:i,lastIdealVelocity:o})};startAnimationIfNecessary=()=>{if(this.unmounting||null!=this.animationID)return;const{requestAnimationFrame:e}=this.context;this.animationID=e((e=>{if(this.unmounting)return;const t=this.props.style;if(Fq(this.state.currentStyle,t,this.state.currentVelocity))return this.wasAnimating&&this.props.onRest&&this.props.onRest(),this.animationID=null,this.wasAnimating=!1,void(this.accumulatedTime=0);this.wasAnimating=!0;const n=e||performance.now(),s=n-this.prevTime;if(this.prevTime=n,this.accumulatedTime=this.accumulatedTime+s,this.accumulatedTime>10*Hq&&(this.accumulatedTime=0),0===this.accumulatedTime)return this.animationID=null,void this.startAnimationIfNecessary();const i=(this.accumulatedTime-Math.floor(this.accumulatedTime/Hq)*Hq)/Hq,o=Math.floor(this.accumulatedTime/Hq),a={},r={},l={},d={};for(const e in t){if(!Object.prototype.hasOwnProperty.call(t,e))continue;const n=t[e];if("number"==typeof n)l[e]=n,d[e]=0,a[e]=n,r[e]=0;else{let t=this.state.lastIdealStyle[e],s=this.state.lastIdealVelocity[e];for(let e=0;e<o;e++)[t,s]=Wq(Hq/1e3,t,s,n.val,n.stiffness,n.damping,n.precision);const[c,h]=Wq(Hq/1e3,t,s,n.val,n.stiffness,n.damping,n.precision);l[e]=t+(c-t)*i,d[e]=s+(h-s)*i,a[e]=t,r[e]=s}}this.animationID=null,this.accumulatedTime-=o*Hq,this.setState({currentStyle:l,currentVelocity:d,lastIdealStyle:a,lastIdealVelocity:r}),this.unreadPropStyle=null,this.startAnimationIfNecessary()}))};componentDidMount(){this.prevTime=performance.now(),this.startAnimationIfNecessary()}UNSAFE_componentWillReceiveProps(e){null!=this.unreadPropStyle&&this.clearUnreadPropStyle(this.unreadPropStyle),this.unreadPropStyle=e.style,null==this.animationID&&(this.prevTime=performance.now(),this.startAnimationIfNecessary())}componentWillUnmount(){this.unmounting=!0,null!=this.animationID&&(this.context.cancelAnimationFrame(this.animationID),this.animationID=null)}render(){const e=this.props.children(this.state.currentStyle);return e&&hs.Children.only(e)}}var Gq=n(64387),$q=n(92);const Kq={stiffness:170,damping:26,precision:.01};function jq(e,t){return{...Kq,...t,val:e}}var Yq,Xq=n(81365),Qq=n(57865);function qq(e,t,n,s){Yq||(Yq="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Yq,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Jq(e){return(0,hs.forwardRef)((function(t,n){const s=(0,hs.useContext)(xi.Z);return qq(Xq.W,{backend:Qq.PD,context:s},void 0,(0,fs.jsx)(e,{ref:n,...t}))}))}function eJ(){const[,e]=hs.useState(!1);return()=>e((e=>!e))}var tJ,nJ=n(34155);function sJ(e,t,n,s){tJ||(tJ="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:tJ,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const iJ={stiffness:500,damping:32},oJ="CREATE_WORKSPACE_DIALOG";const aJ=Jq((function(e){const t=hs.useContext(xi.Z),n=eJ(),s=hs.useRef(null),i=hs.useRef(null),o=hs.useRef(null),a=hs.useRef($q.Z.getRules()),[r,l]=hs.useState(Kj.Z.getWorkspaces(t.vivaldiWindowId)),[d,c]=hs.useState(),[h,p]=hs.useState(""),u=a.current?.length??0,[g,m]=hs.useState(!1);hs.useEffect((()=>{function e(){const e=Kj.Z.getWorkspaces(t.vivaldiWindowId);l(e),c((t=>t?{...t,workspaceId:e[e.length-1]?.id}:t)),cs.Z.focus(t.vivaldiWindowId)}function s(){a.current=$q.Z.getRules(),n()}return Kj.Z.addListener(e),$q.Z.addListener(s),()=>{Kj.Z.removeListener(e),$q.Z.removeListener(s)}}),[t.vivaldiWindowId,n]);const v=e=>{if(!d)return;const t=e.currentTarget.value;"CONTAINS"!==t&&"EQUALS"!==t&&"STARTSWITH"!==t||c({...d,type:t})},f=e=>{d&&c({...d,expression:e.target.value})},y=e=>{if(!d)return;const t=e.currentTarget.value;if("NEW_WORKSPACE"===t)return void C(d.id);const n=Number(e.currentTarget.value);""===t||isNaN(n)||c({...d,workspaceId:n})},C=e=>{p(e),nJ.nextTick((()=>{i.current?.scrollIntoView()}))};hs.useEffect((()=>{d&&(d.id?Gq.Z.updateLinkRoutingRule(d.id,d.type,d.expression,d.workspaceId):Gq.Z.addLinkRoutingRule(d.type,d.expression,d.workspaceId).then((()=>c(void 0))))}),[d]);const w=hs.useCallback((()=>{const e=a.current?.map((e=>e.id))??[];Gq.Z.setOrder(t.vivaldiWindowId,e)}),[t.vivaldiWindowId,a]),b=hs.useMemo((()=>({position:"relative",minHeight:114*u+8})),[u]),S=hs.useCallback((e=>{const t=a.current?.find((t=>t.id===e));if(t)return{item:t,index:a.current?.indexOf(t)??0}}),[a]),I=hs.useRef(null),k=hs.useCallback(((e,s)=>{const i=()=>{n(),I.current=null},o=S(e)?.index,r=a.current;if(r&&"number"==typeof o){const n=r.find((t=>t.id===e)),o=r.find((e=>e.id===s)),l=r.indexOf(n),d=r.indexOf(o);a.current=(0,V.Uy)(r,(e=>{const[t]=e.splice(l,1);e.splice(d,0,t)})),I.current||(I.current=t.requestAnimationFrame(i))}}),[t,S,n]);let A;if(d)if(d.id){const e=a.current??[];A=[];for(let t=0;t<e.length;t++){const n=e[t];n.id===d.id?A.push(d):A.push(n)}}else A=a.current?.concat([d])??[d];else A=a.current?[...a.current]:[];const T=h?A.findIndex((({id:e})=>e===h)):-1;return T>-1&&A.splice(T+1,0,{id:oJ,type:"EQUALS",expression:"",workspaceId:-1}),G.ZP.isIncognitoOrGuest(t.vivaldiWindowId)?null:sJ(US.Z,{filter:e.filter},void 0,(0,fs.jsxs)("div",{ref:o,className:As()("WorkspaceLinkRouting",{disabled:!e.enabled}),children:[sJ("h3",{},void 0,(0,Oe.Z)("Open Websites in Workspaces Automatically")),sJ("p",{className:"info"},void 0,(0,Oe.Z)("Set up rules to automatically open websites in specific Workspaces."),(0,Oe.Z)('Example: All links from "vivaldi.net" open in a workspace called "Vivaldi"')),(0,fs.jsx)("div",{ref:s,className:"WorkspaceLinkRouting-DragArea",style:b,children:A.map(((e,n)=>sJ(zq,{style:{posY:jq(114*n,iJ)}},e.id,(({posY:n})=>e.id===oJ?(0,fs.jsx)(_q,{ref:i,windowId:t.vivaldiWindowId,onClose:()=>Promise.resolve(p("")),onShowIconPicker:()=>m(!0),createInBackground:!0,disableMoveTabs:!0,className:"inline",style:{transform:`translate3d(0, ${n}px, 0)`}},e.id):sJ(Rq,{windowId:t.vivaldiWindowId,rule:e,ruleCount:u,style:{transform:`translate3d(0, ${n}px, 0)`},workspaces:r,findItem:S,moveItem:k,onDelete:()=>{var t;(t=e.id)?Gq.Z.removeLinkRoutingRules([t]):c(void 0)},onFocus:()=>c(e),onTypeChanged:v,onExpressionChanged:f,onWorkspaceChanged:y,onDrop:w,onAddWorkspace:()=>C(e.id)})))))})]}),sJ("div",{className:"setting-single"},void 0,sJ("input",{type:"button",value:(0,Oe.Z)("Add New Workspace Rule"),onClick:()=>{c({id:"",type:"CONTAINS",expression:"",workspaceId:r[0]?.id})}})),g&&sJ(Sq,{closeModal:()=>m(!1),onPick:e=>{i.current?.handlePick(e),m(!1)},activeIcon:i.current?.state.activeIcon,activeEmoji:i.current?.state.activeEmoji,top:o.current?.offsetTop??0,left:90}))}));var rJ;function lJ(e,t,n,s){rJ||(rJ="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:rJ,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const dJ=[$.kWorkspacesButtonShowInTabbar,$.kWorkspacesEnabled],cJ=Ne.Z.getEventHandler;function hJ({filter:e}){const t=(0,na.Z)(dJ),[n,s]=(0,hs.useState)(!1),[i,o]=(0,hs.useState)();(0,hs.useEffect)((()=>{C.Z.utilities.getStartupAction((e=>o(e)))}),[]);return(0,fs.jsxs)(fs.Fragment,{children:[lJ(US.Z,{filter:e},void 0,lJ("div",{className:"setting-group"},void 0,lJ("div",{className:"setting-single"},void 0,"last"!==i&&lJ("p",{className:"info"},void 0,(0,Oe.Z)("Enabling Workspaces will set “Startup with” setting to “Last Session”.")),lJ("div",{className:"setting-single"},void 0,lJ("label",{},void 0,lJ("input",{type:"checkbox",checked:t[$.kWorkspacesEnabled],onChange:()=>{t[$.kWorkspacesEnabled]?s(!0):(Ne.Z.set($.kWorkspacesEnabled,!0),C.Z.utilities.setStartupAction("last",H.Z.get($.kURLsToRestoreOnStartup)))}}),lJ("span",{},void 0,(0,Oe.Z)("Enable Workspaces"))))),lJ("div",{className:"setting-single"},void 0,lJ("label",{},void 0,lJ("input",{type:"checkbox",checked:t[$.kWorkspacesButtonShowInTabbar],onChange:cJ($.kWorkspacesButtonShowInTabbar),disabled:!t[$.kWorkspacesEnabled]}),lJ("span",{},void 0,(0,Oe.Z)("Show Workspaces in Tab Bar")))))),n&&lJ(Xj,{onClose:e=>{s(!1),e&&Ne.Z.set($.kWorkspacesEnabled,!1)},from:"tabs"})]})}var pJ;function uJ(e,t,n,s){pJ||(pJ="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:pJ,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class gJ extends hs.Component{render(){const{filter:e,isWorkspacesEnabled:t}=this.props;return(0,fs.jsxs)(fs.Fragment,{children:[uJ(mN,{categoryTitle:(0,Oe.Z)("Tabs"),filter:e},void 0,uJ(aq,{filter:e}),uJ(PQ,{filter:e}),uJ(vQ,{filter:e}),uJ(WX,{filter:e})),uJ(mN,{categoryTitle:(0,Oe.Z)("Tab Display"),filter:e},void 0,uJ(TQ,{filter:e})),uJ(mN,{categoryTitle:(0,Oe.Z)("Tab Features"),filter:e},void 0,uJ(YX,{filter:e}),uJ(pq,{filter:e}),uJ(yq,{filter:e}),!1,uJ(WQ,{filter:e}),uJ(iQ,{filter:e})),uJ(mN,{categoryTitle:(0,Oe.Z)("Workspaces"),filter:e},void 0,uJ(hJ,{filter:e}),uJ(aJ,{filter:e,enabled:t}))]})}}const mJ=gJ;var vJ;function fJ(e,t,n,s){vJ||(vJ="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:vJ,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const yJ=Ne.Z.getEventHandler,CJ=["Spacer","FlexibleSpacer","Divider","AddressField","AccountButton","PanelChat","StatusInfo","MailSearch","VersionInfo","Zoom"];async function wJ(e,t,n,s){let i=await s.arrayBuffer();s.name.endsWith(".svg")&&(i=(0,Uk.t)(i).buffer);const o=await C.Z.utilities.storeImage({data:i,mimeType:s.type});(0,my.k)(e,(e=>{const s=e.find((e=>e.id===t));s?(s.buttons=s.buttons??{},s.buttons[n]=o):console.error("saveButtonImage: expected to find theme")}))}var bJ=fJ("span",{className:"label"},void 0,"28 × 28");function SJ(e){const{showOpenFilePicker:t}=hs.useContext(xi.Z),{themePref:n,themeId:s,selectedButton:i,preventEditing:o}=e,a=i&&null!==z.Z.getToolbarButtonImage(i),r=hs.useCallback((async e=>{if(1!==e.length||!i)return;const[t]=e;try{wJ(n,s,i,t)}catch(e){console.error("ThemeButtonsEditor: "+e.toString())}}),[i,n,s]);function l(e){return i?fJ(vne,{name:i,index:0,draggable:!1,label:" ",size:e,mimeType:"",onDragEnter:Aa.Z,onDragStart:Aa.Z,onDragEnd:Aa.Z,onDrop:Aa.Z,preview:!0,inEditor:!0,forceIcon:!0},i):null}const{canDropFile:d,onDragLeave:c,onDragOver:h,onDrop:p}=BA(r);return(0,fs.jsxs)(fs.Fragment,{children:[fJ("div",{inert:o?"true":null,className:"Button-Area droparea",onDragEnter:e=>{e.currentTarget.classList.add("dragover")},onDragOver:e=>{e.preventDefault(),h(e)},onDragLeave:e=>{d&&c(e),e.currentTarget.classList.remove("dragover")},onDrop:e=>{d&&p(e),e.currentTarget.classList.remove("dragover")},onClick:async()=>{if(!i)return;const[e]=await t({types:[{description:(0,Oe.Z)("Image files"),accept:{"image/*":[".bmp",".gif",".jpg",".jpeg",".png",".webp",".svg"]}}]}),o=await e.getFile();wJ(n,s,i,o)}},void 0,fJ("div",{className:"Button-Area-Large toolbar-large"},void 0,l("large"),bJ),fJ("div",{className:"Button-Area-Preview",style:{scale:4}},void 0,l("large"),fJ("span",{className:"label"},void 0,(0,Oe.Z)("command","Preview")))),fJ("div",{className:"Button-Area-Controls"},void 0,fJ("input",{type:"button",value:(0,Oe.Z)("Remove Custom Image"),disabled:!a,onClick:()=>{(0,my.k)(n,(e=>{const t=e.find((e=>e.id===s));t?.buttons&&(delete t.buttons[i],0===Object.keys(t.buttons).length&&delete t.buttons)}))}}))]})}var IJ=fJ("hr",{});class kJ extends hs.PureComponent{static contextType=xi.Z;state={selectedButton:""};changeButtonSelection=e=>{const t=e.target.value;this.setState({selectedButton:t})};getThemesWithButtons=()=>Uk.Z.getSystemThemes().concat(this.props.prefValues[$.kThemesUser]).filter((e=>e.buttons&&(e.url&&Object.keys(e.buttons).some((e=>!e.startsWith("COMMAND_")))||!e.url)));setButtons=e=>{const{value:t}=e.currentTarget;"none"===t?Ne.Z.reset($.kThemesCurrentButtons):Ne.Z.set($.kThemesCurrentButtons,t)};renderCategory=e=>{let t=[];return t="chains"===e?H.Z.get($.kChainedCommandsCommandList).map((e=>({id:e.name,label:e.label}))):"mail"===e?[...bd.ww.find((e=>"mail"===e.category))?.buttons||[],...bd.ww.find((e=>"mail_composer"===e.category))?.buttons||[],...bd.ww.find((e=>"mail_message"===e.category))?.buttons||[]]:bd.ww.find((t=>t.category===e))?.buttons||[],t=[...new Set(t)],t.filter((e=>!CJ.includes(e.id))).map(((e,t)=>fJ("option",{value:e.id},e.id+"__"+t,e.label)))};render(){const{themeId:e,prefValues:t}=this.props,n=this.getThemesWithButtons(),s=Boolean(t[$.kThemesCurrentButtons]&&e!==t[$.kThemesCurrentButtons]);return(0,fs.jsx)(fs.Fragment,{children:fJ("div",{className:"TabbedView--Padded Button-Settings"},void 0,fJ("div",{className:"setting-group unlimited"},void 0,fJ("div",{className:"setting-single"},void 0,fJ("label",{},void 0,fJ("input",{type:"checkbox",checked:t[$.kThemesPreferCustomButtons],onChange:yJ($.kThemesPreferCustomButtons),disabled:!n.length}),fJ("span",{},void 0,(0,Oe.Z)("Use Icon Set"))),n.length>0&&fJ("label",{},void 0,fJ("span",{},void 0,(0,Oe.Z)("other","from")),fJ("select",{defaultValue:t[$.kThemesCurrentButtons],onChange:this.setButtons,disabled:!t[$.kThemesPreferCustomButtons]},void 0,fJ("option",{value:"none"},void 0,(0,Oe.Z)("Currently Active Theme")),IJ,n.map((e=>fJ("option",{value:e.id},e.id,e.name)))))),fJ("p",{className:"info"},void 0,(0,Oe.Z)("Disable setting to always use default Vivaldi icon set. Or select a theme to apply its icon set to all other themes."))),fJ("h3",{},void 0,(0,Oe.Z)("Current Theme Icons")),fJ("div",{className:"Button-Manager"},void 0,fJ("div",{className:"Button-Selector"},void 0,fJ("select",{size:"14",onChange:this.changeButtonSelection,onKeyDown:t=>{"Delete"!==t.key&&"Backspace"!==t.key||(0,my.k)(this.props.themePref,(t=>{const n=t.find((t=>t.id===e));n?.buttons&&(delete n.buttons[this.state.selectedButton],0===Object.keys(n.buttons).length&&delete n.buttons)}))}},void 0,fJ("option",{disabled:!0},void 0,(0,Oe.Z)("category","Navigation")),this.renderCategory("navigation"),fJ("option",{disabled:!0},void 0,(0,Oe.Z)("category","Status Bar")),this.renderCategory("status"),fJ("option",{disabled:!0},void 0,(0,Oe.Z)("category","Panel")),this.renderCategory("panel"),fJ("option",{disabled:!0},void 0,(0,Oe.Z)("category","Mail")),this.renderCategory("mail"),fJ("option",{disabled:!0},void 0,(0,Oe.Z)("category","Command Chains")),this.renderCategory("chains"))),fJ("div",{className:"Button-Editor"},void 0,s?fJ(tc,{type:"warning"},void 0,(0,Oe.Z)("Only the currently active theme can be edited. Please switch to “$1” theme first, or change the Custom Buttons setting above.",[n.find((e=>e.id===t[$.kThemesCurrentButtons]))?.name])):fJ("p",{className:"info"},void 0,!this.state.selectedButton&&(0,Oe.Z)("Select a button from the list on the left.")," ",(0,Oe.Z)("Drop a custom icon in the area below. Supply images in bitmap or SVG format, designed to fit on a 28 × 28 pixel canvas.")," ",fJ(hb,{onClick:()=>{d.ZP.openURL(this.context.vivaldiWindowId,"https://help.vivaldi.com/desktop/appearance-customization/creating-custom-icon-set/",{singleton:!0})}},void 0,(0,Oe.Z)("Learn more."))),this.state.selectedButton&&fJ(SJ,{themePref:this.props.themePref,themeId:e,selectedButton:this.state.selectedButton,preventEditing:s}))))})}}const AJ=kJ;var TJ;function ZJ(e,t,n,s){TJ||(TJ="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:TJ,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var EJ=ZJ("span",{className:"ThemeEditorColorPicker-HexSymbol"},void 0,"#");class _J extends hs.PureComponent{state={hexString:void 0};onKeyDown=e=>{const t="#"+e.currentTarget.value;switch(e.key){case"Enter":4!==t.length&&7!==t.length||!B().valid(t)||(this.props.setColor(B()(t).hex()),this.setState({hexString:void 0}));break;case"Escape":this.setState({hexString:void 0})}};updateHexString=e=>{const t="#"+e.currentTarget.value;"blur"===e.type&&4===t.length&&B().valid(t)?(this.props.setColor(B()(t).hex()),this.setState({hexString:void 0})):7===t.length&&B().valid(t)?(this.props.setColor(t),this.setState({hexString:void 0})):this.setState({hexString:t})};render(){return ZJ("div",{className:"ThemeEditorColorPicker"},void 0,this.props.label&&ZJ("div",{className:"ThemeEditorColorPicker-Label"},void 0,this.props.label),ZJ("input",{type:"color",className:"ThemeEditorColorPicker-ColorInput",disabled:this.props.disabled,value:this.props.color,onChange:e=>this.props.setColor(e.currentTarget.value)}),EJ,ZJ("input",{className:"ThemeEditorColorPicker-HexInput",type:"text",disabled:this.props.disabled,value:(this.state.hexString||this.props.color).substring(1),onChange:this.updateHexString,onKeyDown:this.onKeyDown,onBlur:this.updateHexString}))}}const MJ=_J;var NJ;function PJ(e,t,n,s){NJ||(NJ="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:NJ,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const DJ=[$.kThemeScheduleEnabled,$.kThemeScheduleOS,$.kThemeScheduleTimeline,$.kThemesSystem,$.kThemesUser,$.kThemesCurrent,$.kThemesCurrentPrivate],xJ=["backgroundBlur","backgroundImage","colorAccentBg","colorAccentBgDark","colorAccentFg","colorBg","colorBgAlphaBlur","colorBgIntenser","colorBgLightIntense","colorBorder","colorFg","colorHighlightBg","colorTabBar","colorWindowBg","radius","radiusRounded"];var OJ=PJ("div",{className:"ThemePreview-TabBar"},void 0,PJ("div",{className:"ThemePreview-TabBar-Tab ThemePreview-TabBar-Tab--Active"}),PJ("div",{className:"ThemePreview-TabBar-Tab"})),LJ=PJ("div",{className:"ThemePreview-AddressBar"},void 0,PJ("div",{className:"ThemePreview-AddressBar-Icon ThemePreview-AddressBar-Icon--Active"}),PJ("div",{className:"ThemePreview-AddressBar-Icon ThemePreview-AddressBar-Icon--Active"}),PJ("div",{className:"ThemePreview-AddressBar-Icon"}),PJ("div",{className:"ThemePreview-AddressBar-Input"})),RJ=PJ("div",{className:"ThemePreview-Panel"},void 0,PJ("div",{className:"ThemePreview-Panel-Item ThemePreview-Panel-Item--Active"}),PJ("div",{className:"ThemePreview-Panel-Item"}),PJ("div",{className:"ThemePreview-Panel-Item"}));class BJ extends hs.PureComponent{constructor(e){super(e);const{backgroundImage:t,backgroundPosition:n,id:s}=this.props.theme;this.state={style:void 0},Uk.Z.getImageVars(t,n).then((e=>{this.setState({style:{...e,...z.Z.getBaseStylesByThemeId(s,xJ)}})}))}componentDidUpdate(e,t){if(e.theme!==this.props.theme){const{backgroundImage:e,backgroundPosition:t,id:n}=this.props.theme;Uk.Z.getImageVars(e,t).then((e=>{this.setState({style:{...e,...z.Z.getBaseStylesByThemeId(n,xJ)}})}))}}render(){const e=this.props.theme.id,t=this.props.prefValues[$.kThemeScheduleEnabled],n=this.props.prefValues[$.kThemeScheduleOS],s=this.props.prefValues[$.kThemeScheduleTimeline],i=Uk.Z.createClassnames(this.props.theme,this.state.style);return PJ("div",{className:As()(this.props.className,"ThemePreview",{"ThemePreview--Selected":this.props.isCurrent&&this.props.themeChangeCallback})},void 0,PJ("button",{disabled:!this.props.themeChangeCallback,onClick:this.props.themeChangeCallback?()=>{const e=this.props.theme.id;is.Z.setTheme(e),this.props.themeChangeCallback&&this.props.themeChangeCallback(e)}:null,className:"ThemePreview-Image"},void 0,!this.state.style&&PJ("div",{className:"ThemePreview-Browser ThemePreview-Browser--Loading",dangerouslySetInnerHTML:{__html:Ts.H0I}}),PJ("div",{className:As()("ThemePreview-Browser",i),style:this.state.style},void 0,OJ,LJ,RJ)),(this.props.themeChangeCallback||this.props.welcomePage)&&PJ("div",{className:"ThemePreview-Label"},void 0,this.props.theme.name),this.props.themeChangeCallback&&!this.props.welcomePage&&PJ("div",{className:"ThemePreview-Label-Meta"},void 0,this.props.theme.id===this.props.prefValues[$.kThemesCurrentPrivate]&&PJ("span",{},void 0,(0,Oe.Z)("Private")),"system"===t&&e===n.light&&PJ("span",{},void 0,(0,Oe.Z)("theme","Light")),"system"===t&&e===n.dark&&PJ("span",{},void 0,(0,Oe.Z)("theme","Dark")),"timeline"===t&&s.some((t=>t.themeId===e))&&PJ("span",{},void 0,(0,Oe.Z)("Schedule"))),!this.props.isSystem&&this.props.onConfirmDeletion&&PJ("button",{className:"ThemePreview-Delete",onClick:()=>{void 0!==this.props.onConfirmDeletion&&this.props.onConfirmDeletion(e)},tabIndex:-1,dangerouslySetInnerHTML:{__html:Ts.uN0}}))}}const FJ=sa(BJ,DJ);var VJ;function WJ(e,t,n,s){VJ||(VJ="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:VJ,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const UJ="chrome://vivaldi-data/desktop-image/0",HJ=[$.kSystemAccentColor,$.kSystemHasDesktopWallpaperProtocol,$.kThemesPreferCustomButtons,$.kThemesCurrentButtons,$.kThemesSystem,$.kThemesUser],zJ={colorBg:(0,Oe.Z)("Background"),colorFg:(0,Oe.Z)("Foreground"),colorHighlightBg:(0,Oe.Z)("Highlight"),colorAccentBg:(0,Oe.Z)("Accent"),colorWindowBg:(0,Oe.Z)("background color","Window")},GJ={"#EDEEF2":(0,Oe.Z)("background","Light"),"#1D1E21":(0,Oe.Z)("background","Dark"),"#BBDFEF":(0,Oe.Z)("background","Blue"),"#fce370":(0,Oe.Z)("background","Yellow"),"#a4edd9":(0,Oe.Z)("background","Green"),"#ffb6c9":(0,Oe.Z)("background","Pink"),"#A9C8B3":(0,Oe.Z)("background","Soft Green"),"#BEB0CB":(0,Oe.Z)("background","Purple"),"#EFE5DD":(0,Oe.Z)("background","Sand"),"#FA7C68":(0,Oe.Z)("background","Orange")},$J={"/resources/4-0-wallpaper-light.jpg":(0,Oe.Z)("Blurred Circle Light"),"/resources/4-0-wallpaper-dark.jpg":(0,Oe.Z)("Blurred Circle Dark"),"/resources/bg_alt_7.jpg":(0,Oe.Z)("Human"),"/resources/bg_alt_1.jpg":(0,Oe.Z)("Pink Cloud"),"/resources/bg_alt_6.webp":(0,Oe.Z)("Blueprint"),"/resources/bg_alt_4.webp":(0,Oe.Z)("Beach"),"/resources/bg_geometric_1.jpg":(0,Oe.Z)("Purple Rain")},KJ=(0,no.Z)(((e,t)=>{(0,my.k)(e,t)}),50,{leading:!1,trailing:!0}),jJ=(0,oS.Z)(((e,t)=>{(0,my.k)(e,t)}),50,{leading:!0,trailing:!0});var YJ=WJ("img",{width:"24",height:"24",src:"../../../resources/emoji_party.png"});class XJ extends hs.PureComponent{static contextType=xi.Z;_isIMEOpen=!1;colorId=crypto.randomUUID();backgroundId=crypto.randomUUID();settingsId=crypto.randomUUID();buttonsId=crypto.randomUUID();state={backgroundType:"image",baseBgShowPicker:!1,baseFgShowPicker:!1,highlightBgShowPicker:!1,accentBgShowPicker:!1,view:"colors"};render(){const{theme:e,isCurrent:t,isSystem:s,prefValues:i}=this.props,o=s?$.kThemesSystem:$.kThemesUser,a=i[$.kThemesSystem].concat(i[$.kThemesUser]),r=i[o].findIndex((t=>t.id===e.id)),l=a.reduce(((e,t)=>{const n=t.backgroundImage,s=[...Object.keys(e),...Object.keys($J)];return n&&!s.includes(n)&&n!==UJ&&(e[n]=(0,Oe.Z)("From $1",[t.name])),e}),{}),c={...$J,...l};return WJ(US.Z,{filter:this.props.filter},void 0,WJ("div",{className:"ThemeEditor"},void 0,WJ("div",{className:"ThemeEditor-Header"},void 0,WJ("div",{className:"ThemeEditor-HeaderBasics"},void 0,WJ("div",{className:"toolbar toolbar-default"},void 0,WJ("select",{value:e.id,onChange:e=>{this.props.themeChangeCallback&&this.props.themeChangeCallback(e.currentTarget.value)}},void 0,a.map((e=>WJ("option",{value:e.id},e.id,e.name)))),WJ("input",{type:"button",className:t?void 0:"primary",disabled:t,onClick:()=>is.Z.setTheme(e.id),value:(0,Oe.Z)("other","Enable")}),s&&WJ("input",{type:"button",className:"danger",disabled:Uk.Z.isSystemThemeModified(Uk.Z.getThemeWithFallback(e.id)),onClick:()=>is.Z.revertSystemTheme(e.id),value:(0,Oe.Z)("Reset")}),!s&&e.url&&WJ("input",{type:"button",className:"danger",disabled:!t,onClick:()=>is.Z.updateCustomTheme(e.id),value:(0,Oe.Z)("Reload")})),WJ("div",{className:"ThemeEditor-Name"},void 0,WJ("h3",{},void 0,(0,Oe.Z)("theme","Name")),WJ("input",{className:"theme-name",type:"text",disabled:s,onCompositionStart:()=>this._isIMEOpen=!0,onCompositionEnd:e=>{this._isIMEOpen=!1,(0,my.k)(o,(t=>{t[r].name=e.target.value}))},onChange:e=>{this._isIMEOpen||(0,my.k)(o,(t=>{t[r].name=e.target.value}))},defaultValue:e.name},e.id)),!s&&WJ("div",{className:"toolbar toolbar-default"},void 0,YJ,WJ("a",{className:"external-link",href:"https://themes.vivaldi.net",onClick:()=>d.ZP.openURL(this.context.vivaldiWindowId,"https://themes.vivaldi.net/upload")},void 0,(0,Oe.Z)("Share your theme"),WJ("span",{dangerouslySetInnerHTML:{__html:n(70942)}})))),WJ("div",{},void 0,WJ(FJ,{isCurrent:t,isSystem:s,theme:e},e.id))),WJ(lH,{icons:[Ts.v5q.small,Ts.yhu.small,Ts.d$r.small,Ts.oMs.small]},void 0,WJ("div",{id:this.colorId,label:(0,Oe.Z)("Colors")},void 0,WJ("div",{className:"ThemeEditorColors"},void 0,WJ("div",{className:"ThemeEditorColors-Base"},void 0,["colorBg","colorFg"].map((t=>WJ(MJ,{label:zJ[t],color:e[t],setColor:e=>{KJ(o,(n=>{n[r][t]=B()(e).hex()}))}},e.id+t)))),WJ("div",{className:"ThemeEditorColors-Accent"},void 0,["colorHighlightBg","colorAccentBg"].map((t=>WJ(MJ,{label:zJ[t],disabled:["colorHighlightBg"].includes(t)&&e.preferSystemAccent,color:e[t],setColor:e=>{KJ(o,(n=>{n[r][t]=B()(e).hex()}))}},e.id+t))),WJ("div",{className:"setting-single"},void 0,WJ("label",{},void 0,WJ("input",{type:"checkbox",checked:e.preferSystemAccent,onChange:e=>{(0,my.k)(o,(t=>{t[r].preferSystemAccent=e.target.checked}))}}),WJ("span",{},void 0,(0,Oe.Z)("Prefer System Color")))))),WJ("div",{className:"TabbedView--Padded"},void 0,WJ("div",{className:"setting-group"},void 0,WJ("div",{className:"setting-single"},void 0,WJ("h3",{},void 0,(0,Oe.Z)("Color Overrides")),WJ("label",{},void 0,WJ("input",{type:"checkbox",checked:e.accentFromPage,onChange:e=>{(0,my.k)(o,(t=>{t[r].accentFromPage=e.target.checked}))}}),WJ("span",{},void 0,(0,Oe.Z)("Accent from Page"))),WJ("p",{className:"info"},void 0,(0,Oe.Z)("Get accent color from current webpage. Apply accent color to transparent Tab Bar background."))),WJ("div",{className:"setting-single"},void 0,WJ("label",{},void 0,WJ("input",{type:"checkbox",checked:e.accentOnWindow,onChange:e=>{(0,my.k)(o,(t=>{t[r].accentOnWindow=e.target.checked}))}}),WJ("span",{},void 0,(0,Oe.Z)("Accent on Window"))),WJ("p",{className:"info"},void 0,(0,Oe.Z)("Apply accent color to window background instead of the toolbar.")))),WJ("div",{className:"setting-group"},void 0,WJ("div",{className:"setting-single"},void 0,WJ("h3",{},void 0,(0,Oe.Z)("Limit Accent Color Saturation")),WJ(RB,{min:.2,max:1,step:.05,value:e.accentSaturationLimit,onChange:e=>{jJ(o,(t=>{t[r].accentSaturationLimit=Number(e.target.value)}))},label:`${Math.floor(100*e.accentSaturationLimit)}%`})),WJ("div",{className:"setting-single pad-top"},void 0,WJ("h3",{},void 0,(0,Oe.Z)("Color Contrast")),WJ(RB,{min:-10,max:20,step:1,onChange:e=>{jJ(o,(t=>{t[r].contrast=Number(e.target.value)}))},value:e.contrast}))))),WJ("div",{id:this.backgroundId,label:(0,Oe.Z)("Background")},void 0,WJ("div",{className:"ThemeEditor-BackgroundMeta"},void 0,WJ("div",{className:"ThemeEditor-BackgroundMetaBasic"},void 0,WJ("span",{},void 0,(0,Oe.Z)("Type:")),WJ("select",{value:this.state.backgroundType,onChange:e=>{const t=e.target.value;this.setState({backgroundType:t})}},void 0,WJ("option",{value:"image"},void 0,(0,Oe.Z)("theme background","Image")),WJ("option",{value:"color"},void 0,(0,Oe.Z)("theme background","Color"))),"color"===this.state.backgroundType&&(0,fs.jsxs)(fs.Fragment,{children:[WJ("span",{},void 0,(0,Oe.Z)("Custom Color")),WJ(MJ,{color:e.colorWindowBg,setColor:e=>{KJ(o,(t=>{t[r].colorWindowBg=B()(e).hex()}))}})]}),"image"===this.state.backgroundType&&(0,fs.jsxs)(fs.Fragment,{children:[WJ("select",{value:e.backgroundPosition,onChange:e=>{(0,my.k)(o,(t=>{t[r].backgroundPosition=e.target.value}))}},void 0,WJ("option",{value:"stretch"},void 0,(0,Oe.Z)("Stretch to Fit")),WJ("option",{value:"repeat"},void 0,(0,Oe.Z)("verb","Repeat")),WJ("option",{value:"center"},void 0,(0,Oe.Z)("Center"))),this.props.prefValues[$.kSystemHasDesktopWallpaperProtocol]&&WJ("input",{className:"ThemeEditor-BackgroundCustomButton",type:"button",disabled:e.backgroundImage===UJ,value:(0,Oe.Z)("Use Desktop Image"),onClick:()=>{(0,my.k)(o,(e=>{e[r].backgroundImage=UJ}))}}),WJ("input",{className:"ThemeEditor-BackgroundCustomButton",type:"button",value:(0,Oe.Z)("Select Image..."),onClick:()=>{C.Z.utilities.selectLocalImage({windowId:this.context.vivaldiWindowId,title:(0,Oe.Z)("Select Background Image"),themeId:e.id})}})]})),"color"===this.state.backgroundType&&e.backgroundImage&&e.colorWindowBg&&WJ("div",{className:"ThemeEditor-BackgroundMetaInfoBar"},void 0,WJ("span",{},void 0,(0,Oe.Z)("This theme has a background image set that may obscure the color.")),WJ("input",{type:"button",value:(0,Oe.Z)("Clear Image"),onClick:()=>{(0,my.k)(o,(e=>{e[r].backgroundImage=""}))}}))),WJ("div",{className:"ThemeEditor-Background"},void 0,WJ("div",{className:"ThemeEditor-BackgroundList"},void 0,"color"===this.state.backgroundType&&(0,fs.jsxs)(fs.Fragment,{children:[WJ("button",{className:As()("selectbox",{"selectbox-selected":!e.colorWindowBg}),onClick:()=>{(0,my.k)(o,(e=>{e[r].colorWindowBg=""}))}},void 0,WJ("div",{className:"selectbox-image",style:{backgroundColor:e.colorBg},dangerouslySetInnerHTML:{__html:Ts.D7r.medium}}),WJ("div",{className:"selectbox-title"},void 0,(0,Oe.Z)("No color"))),Object.keys(GJ).map((t=>WJ("button",{className:As()("selectbox",{"selectbox-selected":t===e.colorWindowBg}),onClick:e=>{(0,my.k)(o,(e=>{e[r].colorWindowBg=t}))}},t,WJ("div",{className:"selectbox-image",style:{backgroundColor:t},dangerouslySetInnerHTML:{__html:Ts.D7r.medium}}),WJ("div",{className:"selectbox-title"},void 0,GJ[t]))))]}),"image"===this.state.backgroundType&&(0,fs.jsxs)(fs.Fragment,{children:[WJ("button",{className:As()("selectbox",{"selectbox-selected":!e.backgroundImage}),onClick:e=>{(0,my.k)(o,(e=>{e[r].backgroundImage=""}))}},void 0,WJ("div",{className:"selectbox-image",style:{backgroundColor:e.colorWindowBg},dangerouslySetInnerHTML:{__html:Ts.D7r.medium}}),WJ("div",{className:"selectbox-title"},void 0,(0,Oe.Z)("No image"))),Object.keys(c).map((t=>WJ("button",{className:As()("selectbox",{"selectbox-selected":t===e.backgroundImage}),onClick:e=>{(0,my.k)(o,(e=>{e[r].backgroundImage=t}))}},t,WJ("div",{className:"selectbox-image",style:{backgroundImage:`url(${t})`},dangerouslySetInnerHTML:{__html:Ts.D7r.medium}}),WJ("div",{className:"selectbox-title"},void 0,c[t]))))]})))),WJ("div",{id:this.settingsId,label:(0,Oe.Z)("Settings")},void 0,WJ("div",{className:"TabbedView--Padded"},void 0,WJ("div",{className:"setting-group"},void 0,WJ("div",{className:"setting-single"},void 0,WJ("h3",{},void 0,(0,Oe.Z)("Transparency")),WJ(RB,{min:0,max:.25,step:.01,value:1-e.alpha,onChange:e=>{jJ(o,(t=>{t[r].alpha=parseFloat((1-Number(e.currentTarget.value)).toFixed(2))}))},label:`${Math.round(100*(1-e.alpha))}%`}),WJ("p",{className:"info pad-zero"},void 0,(0,Oe.Z)("Adjust Panel transparency level."))),WJ("div",{className:"setting-single pad-top"},void 0,WJ("label",{},void 0,WJ("input",{type:"checkbox",checked:e.transparencyTabBar,onChange:e=>{(0,my.k)(o,(t=>{t[r].transparencyTabBar=e.target.checked}))}}),WJ("span",{},void 0,(0,Oe.Z)("Transparent Tab Bar")))),WJ("div",{className:"setting-single"},void 0,WJ("label",{},void 0,WJ("input",{type:"checkbox",checked:e.transparencyTabs,onChange:e=>{(0,my.k)(o,(t=>{t[r].transparencyTabs=e.target.checked}))}}),WJ("span",{},void 0,(0,Oe.Z)("Transparent Background Tabs"))))),WJ("div",{className:"setting-group"},void 0,WJ("div",{className:"setting-single"},void 0,WJ("h3",{},void 0,(0,Oe.Z)("Blur")),WJ(RB,{min:0,max:10,step:1,value:e.blur,onChange:e=>{jJ(o,(t=>{t[r].blur=Number(e.target.value)}))}}),WJ("p",{className:"info pad-zero"},void 0,(0,Oe.Z)("Apply blur effect to image in Panel and Tab Bar background."))),WJ("div",{className:"setting-single pad-top"},void 0,WJ("h3",{},void 0,(0,Oe.Z)("Corner Rounding")),WJ(RB,{min:-1,max:14,value:e.radius,onChange:e=>{jJ(o,(t=>{t[r].radius=Number(e.target.value)}))},label:-1===e.radius?(0,Oe.Z)("Disabled"):e.radius.toString()}))))),WJ("div",{id:this.buttonsId,label:(0,Oe.Z)("Icons")},void 0,WJ(AJ,{themeId:e.id,themePref:o,prefValues:i})))))}}const QJ=sa(XJ,HJ);var qJ;function JJ(e,t,n,s){qJ||(qJ="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:qJ,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const e0=[$.kThemeScheduleEnabled,$.kThemeScheduleOS,$.kThemeScheduleTimeline,$.kThemesSystem,$.kThemesUser],t0=Ne.Z.getEventHandler,n0=["colorFg","colorBg","colorBgDark","colorBgIntense","colorBorderIntense","colorAccentBg"];var s0=JJ("hr",{});class i0 extends hs.PureComponent{static contextType=xi.Z;refScheduleTimeline=hs.createRef();constructor(e){super(e),this.state={dragging:!1,now:new Date,selectedScheduleId:e.prefValues[$.kThemeScheduleTimeline][0].id}}componentDidMount(){this.context.addEventListener("pointerup",this.stopPointerReschedule),this.timer=setInterval(this.updateNow,6e4)}componentWillUnmount(){clearInterval(this.timer),this.context.removeEventListener("pointerup",this.stopPointerReschedule)}updateNow=()=>{this.setState({now:new Date})};startPointerReschedule=(e,t)=>{t.persist(),t.preventDefault(),this.setState({dragging:!0,selectedScheduleId:e},(()=>{this.handlePointerReschedule(t)}))};pointerReschedule=e=>{e.preventDefault(),this.state.dragging&&this.handlePointerReschedule(e)};stopPointerReschedule=()=>{if(this.state.dragging){this.setState({dragging:!1});const e=Uk.Z.getTimerByDate(new Date,"current");e&&is.Z.setTheme(e.themeId)}};handlePointerReschedule=e=>{const t=this.refScheduleTimeline.current?.getBoundingClientRect()??{left:0,width:0},n=e.clientX-t.left,s=5*Math.floor(1439/t.width*n/5);s<0||s>1439||(0,my.k)($.kThemeScheduleTimeline,(e=>{const t=e.findIndex((e=>e.id===this.state.selectedScheduleId));e[t].hours=Math.floor(s/60),e[t].minutes=s-60*e[t].hours}))};addSchedule=()=>{const e=this.props.prefValues[$.kThemeScheduleTimeline],t=crypto.randomUUID();Ne.Z.set($.kThemeScheduleTimeline,[...e,{id:t,minutes:0,hours:12,themeId:Uk.Z.getDefaultTheme().id,undeletable:!1}]),this.setState({selectedScheduleId:t})};removeSelectedScheduleOnDelete=e=>{["KeyCode.KEY_BACK_SPACE","KeyCode.KEY_DELETE"].includes(e.keyCode)&&this.removeSelectedSchedule()};handleKeyboardReschedule=(e,t)=>{if([oa.Z.KEY_LEFT,oa.Z.KEY_RIGHT].includes(t.keyCode)){(0,my.k)($.kThemeScheduleTimeline,(n=>{const s=n.findIndex((t=>t.id===e));let i=60*n[s].hours+n[s].minutes;t.shiftKey?t.keyCode===oa.Z.KEY_LEFT&&i>29?i-=30:t.keyCode===oa.Z.KEY_RIGHT&&i<1409&&(i+=30):t.keyCode===oa.Z.KEY_LEFT&&i>4?i-=5:t.keyCode===oa.Z.KEY_RIGHT&&i<1434&&(i+=5),n[s].hours=Math.floor(i/60),n[s].minutes=i-60*n[s].hours}))&&this.setState({selectedScheduleId:e})}else[oa.Z.KEY_BACK_SPACE,oa.Z.KEY_DELETE].includes(t.keyCode)&&this.removeSelectedSchedule()};removeSelectedSchedule=()=>{(0,my.k)($.kThemeScheduleTimeline,(e=>{const t=e.findIndex((e=>e.id===this.state.selectedScheduleId));e[t].undeletable||e.splice(t,1)}))&&this.setState({selectedScheduleId:void 0})};updateOSTheme=e=>{const t=this.props.prefValues[$.kThemeScheduleOS];Ne.Z.set($.kThemeScheduleOS,{...t,[e.target.name]:e.target.value})};indicatorFocus=(e,t)=>{t.stopPropagation(),this.setState({selectedScheduleId:e})};indicatorBlur=()=>{this.setState({selectedScheduleId:void 0})};render(){const e=[...this.props.prefValues[$.kThemeScheduleTimeline]],t=this.state.now,n=(t.getMinutes()+60*t.getHours())/14.4+"%",{prefValues:s}=this.props,i=s[$.kThemesSystem].concat(s[$.kThemesUser]).sort(((e,t)=>e.name.localeCompare(t.name))),o="timeline"!==s[$.kThemeScheduleEnabled],a="system"!==s[$.kThemeScheduleEnabled],r=!1===e.find((e=>e.id===this.state.selectedScheduleId))?.undeletable;return e.sort(((e,t)=>60*e.hours+e.minutes-(60*t.hours+t.minutes))),e.unshift(e[e.length-1]),JJ(mN,{categoryTitle:(0,Oe.Z)("Theme Schedule"),className:"setting-group unlimited",filter:this.props.filter,onPointerMove:this.pointerReschedule},void 0,JJ("div",{className:"setting-group-double"},void 0,JJ("div",{className:"setting-single"},void 0,JJ("label",{},void 0,JJ("input",{type:"radio",value:"off",checked:"off"===s[$.kThemeScheduleEnabled],onChange:t0($.kThemeScheduleEnabled)}),JJ("span",{},void 0,(0,Oe.Z)("No Schedule")))),JJ("div",{className:"setting-single pad-top"},void 0,JJ("label",{},void 0,JJ("input",{type:"radio",value:"system",checked:"system"===s[$.kThemeScheduleEnabled],onChange:t0($.kThemeScheduleEnabled)}),JJ("span",{},void 0,(0,Oe.Z)("Operating System")))),JJ("div",{className:"setting-single"},void 0,JJ("label",{},void 0,JJ("span",{},void 0,(0,Oe.Z)("theme","Light")),JJ("select",{name:"light",value:s[$.kThemeScheduleOS].light,disabled:a,onChange:this.updateOSTheme},void 0,i.map((e=>JJ("option",{value:e.id},e.id,e.name))))),JJ("label",{},void 0,JJ("span",{},void 0,(0,Oe.Z)("theme","Dark")),JJ("select",{name:"dark",value:s[$.kThemeScheduleOS].dark,disabled:a,onChange:this.updateOSTheme},void 0,i.map((e=>JJ("option",{value:e.id},e.id,e.name)))))),JJ("div",{className:"setting-single"},void 0,JJ("label",{},void 0,JJ("input",{type:"radio",value:"timeline",checked:"timeline"===s[$.kThemeScheduleEnabled],onChange:t0($.kThemeScheduleEnabled)}),JJ("span",{},void 0,(0,Oe.Z)("Manual Schedule"))))),(0,fs.jsxs)("div",{className:"theme-schedule-timeline"+(o?" schedule-disabled":""),ref:this.refScheduleTimeline,children:[!o&&JJ("span",{className:"theme-schedule-now-indicator",style:{left:n}},void 0,(0,Oe.Z)("Now")),e.map(((t,n)=>{const s=0===n?0:(60*t.hours+t.minutes)/14.4,a=e[n+1],r=a?60*a.hours+a.minutes:1440,l=String(t.hours).padStart(2,"0"),d=String(t.minutes).padStart(2,"0"),{name:c}=Uk.Z.getThemeWithFallback(t.themeId),h=z.Z.getBaseStylesByThemeId(t.themeId,n0),p=this.state.selectedScheduleId===t.id;return JJ("div",{className:As()("theme-schedule-timeslice",{"timeslice-selected":!o&&p}),style:{width:r/14.4-s+"%",left:`${s}%`}},n,0!==n&&(0,fs.jsxs)(fs.Fragment,{children:[!o&&JJ("div",{title:c,className:"timeslice-bubble",onFocus:this.indicatorFocus.bind(this,t.id),onBlur:this.indicatorBlur,disabled:o,onPointerDown:e=>this.startPointerReschedule(t.id,e),onKeyDown:this.handleKeyboardReschedule.bind(this,t.id)},void 0,JJ("div",{},void 0,`${l}:${d}`)),JJ("div",{className:"theme-schedule-timeslice-indicator"},void 0,JJ("input",{type:"button",className:"theme-schedule-timeslice-draghandle",title:c,onFocus:this.indicatorFocus.bind(this,t.id),onBlur:this.indicatorBlur,disabled:o,onPointerDown:e=>this.startPointerReschedule(t.id,e),onKeyDown:this.handleKeyboardReschedule.bind(this,t.id)}))]}),JJ("select",{disabled:o,value:t.themeId,style:h,title:c,onFocus:this.indicatorFocus.bind(this,t.id),onKeyDown:this.removeSelectedScheduleOnDelete,onChange:e=>{return n=t.id,s=e.target.value,void(0,my.k)($.kThemeScheduleTimeline,(e=>{const t=e.findIndex((e=>e.id===n));-1!==t&&(e[t].themeId=s)}));var n,s}},void 0,i.map((e=>JJ("option",{value:e.id},e.id,e.name)))))}))]}),JJ("div",{className:"toolbar toolbar-default toolbar-group"},void 0,JJ("div",{className:"toolbar-group"},void 0,JJ(Fa,{disabled:o,onClick:this.addSchedule,image:Ts.md4.medium,title:(0,Oe.Z)("Add")}),s0,JJ(Fa,{disabled:o||!r||void 0===this.state.selectedScheduleId,onClick:this.removeSelectedSchedule,image:Ts.M2k.medium,title:(0,Oe.Z)("other","Remove")}))))}}const o0=sa(i0,e0);var a0,r0=n(97899),l0=n(8959);function d0(e,t,n,s){a0||(a0="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:a0,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const c0=[$.kSystemAccentColor,$.kThemeScheduleEnabled,$.kThemeScheduleOS,$.kThemeScheduleTimeline,$.kThemesSystem,$.kThemesUser,$.kThemesCurrent,$.kThemesPreview,$.kThemesCurrentPrivate];var h0=d0("div",{className:"ThemePreview-Label-Meta"});class p0 extends hs.PureComponent{static contextType=xi.Z;libraryId=crypto.randomUUID();editorId=crypto.randomUUID();constructor(e,t){super(e);const n=t.vivaldiWindowId;this.state={editorThemeId:is.Z.getCurrentIdWithoutPreview(n),tabbedViewId:this.libraryId,confirmDeletionId:void 0}}onAddTheme=(e,t)=>{const n=t.currentTarget.closest(".settings-content");n&&n.scrollTop>150&&n.scrollTo({top:150,behavior:"smooth"});const s=is.Z.createTheme(e);this.setState({editorThemeId:s,tabbedViewId:this.editorId})};onConfirmDeletion=e=>{this.setState({confirmDeletionId:e})};closeDialog=()=>{this.setState({confirmDeletionId:void 0})};deleteTheme=()=>{this.state.confirmDeletionId&&is.Z.deleteTheme(this.state.confirmDeletionId),this.closeDialog()};renderDialog=()=>{const e=Uk.Z.getThemeWithFallback(this.state.confirmDeletionId).name;return d0(_r.Z,{onRequestClose:this.closeDialog,viewMode:"float"},void 0,d0("header",{className:"dialog-header"},void 0,d0("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("Deleting “$1”",[e])),d0("p",{},void 0,(0,Oe.Z)("Do you want to permanently delete the “$1” theme?",[e]))),d0("div",{className:"dialog-footer"},void 0,d0("input",{type:"button",className:"danger",onClick:this.deleteTheme,value:(0,Oe.Z)("Delete Theme")}),d0("input",{type:"button",onClick:this.closeDialog,value:(0,Oe.Z)("Cancel")})))};renderFooter(e){return d0("div",{className:"TabbedView-Footer"},void 0,d0("input",{type:"button",value:(0,Oe.Z)("Open Theme..."),onClick:()=>async function(e){is.Z.clearThemePreview();const[t]=await e.showOpenFilePicker({multiple:!1,types:[{description:(0,Oe.Z)("Select Theme to Import"),accept:{"application/zip":[".zip"]}}]}),n=(0,r0.Z)(await t.getFile()),s=new ReadableStream({async pull(e){const t=await n.next();if(t.done)return e.close();const{value:s}=t,{name:i}=s;let o;if(i.toLowerCase().endsWith(".svg")){const e=await s.arrayBuffer(),t=(0,Uk.t)(e);o=()=>new ReadableStream({start(e){e.enqueue(t),e.close()}})}else o=()=>s.stream();return e.enqueue({name:i,stream:o})}}),i=s.pipeThrough(new l0.Z).getReader(),o=[];let a=0;for(;;){const{done:e,value:t}=await i.read();if(e||!t)break;a+=t.byteLength,o.push(t)}const r=new Uint8Array(a);let l=0;for(const e of o)r.set(e,l),l+=e.byteLength;const{error:d}=await C.Z.themePrivate.import({dataBlob:r.buffer});if(d)throw new Error(`${d.kind} - ${d.details}`)}(this.context)}),d0("input",{type:"button",value:(0,Oe.Z)("Export Theme..."),onClick:async()=>{const t=Uk.Z.getThemeWithFallback(e);await is.Z.exportTheme(t,this.context.vivaldiWindowId)}}),d0("a",{className:"external-link",href:"https://themes.vivaldi.net",onClick:()=>d.ZP.openURL(this.context.vivaldiWindowId,"https://themes.vivaldi.net"),style:{margin:"auto 0 auto auto"}},void 0,(0,Oe.Z)("Get more themes"),d0("span",{dangerouslySetInnerHTML:{__html:n(70942)}})))}render(){const e=Uk.Z.getSystemThemes(),t=e.concat(this.props.prefValues[$.kThemesUser]),n=is.Z.getCurrentIdWithoutPreview(this.context.vivaldiWindowId);return(0,fs.jsxs)(fs.Fragment,{children:[d0(mN,{filter:this.props.filter,categoryTitle:(0,Oe.Z)("Themes")},void 0,d0(US.Z,{filter:this.props.filter},void 0,d0("p",{className:"info"},void 0,(0,Oe.Z)("Select any of the pre-installed themes, make your own in the Theme Editor, or head over to themes.vivaldi.net to download themes shared by the Vivaldi community.")),d0(lH,{icons:[Ts.v5q.small,Ts.B$9.small],activeTabId:this.state.tabbedViewId,onTabClick:e=>{this.setState({tabbedViewId:e})},className:"ThemeEditor-Tabs-"+(this.state.tabbedViewId===this.libraryId?"Library":"Editor")},void 0,d0("div",{id:this.libraryId,label:(0,Oe.Z)("Library")},void 0,d0("div",{className:"TabbedView--Padded ThemePreviews"},void 0,this.state.confirmDeletionId&&this.renderDialog(),t.map((t=>d0("div",{onDoubleClick:()=>{this.setState({tabbedViewId:this.editorId})}},t.id,d0(FJ,{isCurrent:t.id===n,isSystem:e.some((e=>e.id===t.id)),theme:t,themeChangeCallback:e=>{this.setState({editorThemeId:e})},onConfirmDeletion:this.onConfirmDeletion})))),d0("div",{className:"ThemePreview ThemePreview--New"},void 0,d0("button",{onClick:e=>this.onAddTheme(n,e),className:"ThemePreview-Image",dangerouslySetInnerHTML:{__html:Ts.Clf}}),d0("div",{className:"ThemePreview-Label"},void 0,(0,Oe.Z)("New Theme...")),h0)),this.renderFooter(n)),d0("div",{id:this.editorId,label:(0,Oe.Z)("Editor")},void 0,d0("div",{className:"TabbedView--Padded"},void 0,d0(QJ,{theme:Uk.Z.getThemeWithFallback(this.state.editorThemeId),isCurrent:this.state.editorThemeId===n,isSystem:e.some((e=>e.id===this.state.editorThemeId)),filter:this.props.filter,themeChangeCallback:e=>{this.setState({editorThemeId:e})}})),this.renderFooter(this.state.editorThemeId||n))))),d0(mN,{categoryTitle:(0,Oe.Z)("Private Window Theme"),filter:this.props.filter},void 0,d0("div",{className:"setting-single setting-single--LeadingText"},void 0,d0("label",{},void 0,d0("span",{},void 0,(0,Oe.Z)("Select theme for Private Windows")),d0("select",{value:this.props.prefValues[$.kThemesCurrentPrivate],onChange:e=>Ne.Z.set($.kThemesCurrentPrivate,e.currentTarget.value)},void 0,t.map((e=>d0("option",{value:e.id},e.id,e.name))))))),d0(o0,{filter:this.props.filter})]})}}const u0=sa(p0,c0);var g0;function m0(e,t,n,s){g0||(g0="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:g0,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const v0=[$.kPluginsAlwaysOpenPdfExternally,$.kPluginsWidevineEnabled],f0=Ne.Z.getEventHandler;class y0 extends hs.Component{constructor(e){super(e)}render(){return m0(mN,{categoryTitle:(0,Oe.Z)("Plugins"),filter:this.props.filter},void 0,m0("div",{className:"setting-group unlimited"},void 0,m0("div",{className:"setting-single"},void 0,m0("label",{},void 0,m0("input",{type:"checkbox",checked:!this.props.prefValues[$.kPluginsAlwaysOpenPdfExternally],onChange:f0($.kPluginsAlwaysOpenPdfExternally,"inverse")}),m0("span",{},void 0,(0,Oe.Z)("Enable Internal PDF Viewer")))),m0("div",{className:"setting-single"},void 0,m0("label",{},void 0,m0("input",{type:"checkbox",checked:this.props.prefValues[$.kPluginsWidevineEnabled],onChange:f0($.kPluginsWidevineEnabled)}),m0("span",{},void 0,(0,Oe.Z)("Enable Widevine Plugin"))))))}}const C0=sa(y0,v0);var w0;function b0(e,t,n,s){w0||(w0="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:w0,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class S0 extends hs.PureComponent{state={zoom:1};#h=!1;componentDidMount(){this.#h=!0,C.Z.zoom.onDefaultZoomChanged.addListener(this._onDefaultZoomChanged),C.Z.zoom.getDefaultZoom(this._onDefaultZoomChanged)}componentWillUnmount(){this.#h=!1,C.Z.zoom.onDefaultZoomChanged.removeListener(this._onDefaultZoomChanged)}rangeCheck=e=>Math.min(Math.max(e,ib.VH),ib.oJ);_onDefaultZoomChanged=e=>{this.#h&&this.setState({zoom:this.rangeCheck(e)})};setZoomLevel=e=>{const t=this.rangeCheck(e);C.Z.zoom.setDefaultZoom(t)};render(){const{zoom:e}=this.state;return b0(tb,{zoom:e,defaultZoomLevel:ib.XZ,scrolling:!0,inFooter:!1,maxLevel:ib.oJ,minLevel:ib.VH,step:ib.s5,disabled:!1,onZoomUpdated:this.setZoomLevel},"zoomslider")}}const I0=S0;var k0;function A0(e,t,n,s){k0||(k0="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:k0,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const T0=[$.kMouseWheelPageZoom,$.kWebpagesTabZoomEnabled],Z0=Ne.Z.getEventHandler;var E0=A0("div",{className:"toolbar toolbar-default"},void 0,A0(I0,{}));class _0 extends hs.Component{handleZoomUpdated=e=>{C.Z.zoom.setDefaultZoom(e)};render(){return A0(US.Z,{filter:this.props.filter},void 0,A0("div",{className:"setting-group"},void 0,A0("div",{className:"setting-single"},void 0,A0("h3",{},void 0,(0,Oe.Z)("Default Webpage Zoom")),E0,A0("p",{className:"info"},void 0,(0,Oe.Z)("This affects all webpages with default zoom level."))),A0("div",{className:"setting-single pad-top"},void 0,A0("label",{},void 0,A0("input",{type:"checkbox",checked:this.props.prefValues[$.kMouseWheelPageZoom],onChange:Z0($.kMouseWheelPageZoom)}),A0("span",{},void 0,(0,Oe.Z)("Use $1+Scroll to Zoom Page",["Ctrl"])))),A0("div",{className:"setting-single"},void 0,A0("label",{},void 0,A0("input",{type:"checkbox",checked:this.props.prefValues[$.kWebpagesTabZoomEnabled],onChange:Z0($.kWebpagesTabZoomEnabled)}),A0("span",{},void 0,(0,Oe.Z)("Use Tab Zoom"))),A0("p",{className:"info"},void 0,(0,Oe.Z)("Retain zoom level when navigating between websites")))))}}const M0=sa(_0,T0);var N0;function P0(e,t,n,s){N0||(N0="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:N0,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const D0=[$.kWebpagesFullScreenShowBubble];D0.push($.kWebpagesFullScreenHideMouse);const x0=Ne.Z.getEventHandler;class O0 extends hs.Component{render(){const e=P0("div",{className:"setting-single"},void 0,P0("label",{},void 0,P0("input",{type:"checkbox",checked:this.props.prefValues[$.kWebpagesFullScreenShowBubble],onChange:x0($.kWebpagesFullScreenShowBubble)}),P0("span",{},void 0,(0,Oe.Z)("Show Fullscreen Reminder")))),t=P0("div",{className:"setting-single"},void 0,P0("label",{},void 0,P0("input",{type:"checkbox",checked:this.props.prefValues[$.kWebpagesFullScreenHideMouse],onChange:x0($.kWebpagesFullScreenHideMouse)}),P0("span",{},void 0,(0,Oe.Z)("Hide the Mouse Cursor for Page-initiated Fullscreen"))));return P0(US.Z,{filter:this.props.filter},void 0,P0("span",{},void 0,P0("div",{className:"setting-group"},void 0,P0("h3",{},void 0,(0,Oe.Z)("Fullscreen Mode")),e,t)))}}const L0=sa(O0,D0);var R0;function B0(e,t,n,s){R0||(R0="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:R0,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const F0=[$.kHardwareAccelerationModeEnabled],V0=Ne.Z.getEventHandler;class W0 extends hs.Component{render(){return B0(US.Z,{filter:this.props.filter},void 0,B0("div",{className:"setting-group unlimited"},void 0,B0("div",{className:"setting-single"},void 0,B0("label",{},void 0,B0("input",{type:"checkbox",checked:this.props.prefValues[$.kHardwareAccelerationModeEnabled],onChange:V0($.kHardwareAccelerationModeEnabled)}),B0("span",{},void 0,(0,Oe.Z)("Use Hardware Acceleration When Available"))),B0("p",{className:"info"},void 0,(0,Oe.Z)("This setting requires a restart to take full effect.")))))}}const U0=sa(W0,F0);var H0;function z0(e,t,n,s){H0||(H0="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:H0,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var G0=z0("input",{type:"radio",value:"allowed"}),$0=z0("input",{type:"radio",value:"once"}),K0=z0("input",{type:"radio",value:"none"});class j0 extends hs.Component{state={animationPolicy:"allowed"};componentDidMount(){s.Z.accessibilityFeatures.animationPolicy.onChange.addListener(this._onAnimationPolicyChanged),this._onAnimationPolicyChanged()}componentWillUnmount(){s.Z.accessibilityFeatures.animationPolicy.onChange.removeListener(this._onAnimationPolicyChanged)}_onAnimationPolicyChanged=()=>{s.Z.accessibilityFeatures.animationPolicy.get({},(({value:e})=>{this.setState({animationPolicy:e})}))};onSelected=e=>{const t=e.target.value;this.setState({animationPolicy:t},(()=>{s.Z.accessibilityFeatures.animationPolicy.set({value:t},(()=>{}))}))};render(){return z0(US.Z,{filter:this.props.filter},void 0,z0("div",{className:"setting-group"},void 0,z0("div",{className:"setting-single"},void 0,z0("h3",{},void 0,(0,Oe.Z)("Play Image Animation")),z0(vl,{name:"animationPolicy",value:this.state.animationPolicy,onChange:this.onSelected},void 0,z0("div",{className:"setting-single"},void 0,z0("label",{},void 0,G0,z0("span",{},void 0,(0,Oe.Z)("command","Loop")))),z0("div",{className:"setting-single"},void 0,z0("label",{},void 0,$0,z0("span",{},void 0,(0,Oe.Z)("Once")))),z0("div",{className:"setting-single"},void 0,z0("label",{},void 0,K0,z0("span",{},void 0,(0,Oe.Z)("radio","Never"))))))))}}const Y0=j0;var X0;function Q0(e,t,n,s){X0||(X0="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:X0,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var q0=Q0("input",{type:"radio",value:"always"}),J0=Q0("input",{type:"radio",value:"never"}),e1=Q0("input",{type:"radio",value:"cache"});class t1 extends hs.Component{state={imageLoading:"always"};componentDidMount(){this._initState(),H.Z.addListener($.kPageImageLoading,this._onSettingsChanged)}componentWillUnmount(){H.Z.removeListener($.kPageImageLoading,this._onSettingsChanged)}_initState=()=>{const e=H.Z.get($.kPageImageLoading);e&&this.setState({imageLoading:e})};_onSettingsChanged=(e,t)=>{this.setState({imageLoading:t})};onSelected=e=>{const{value:t}=e.target;this.setState({imageLoading:t},(()=>{Ne.Z.set($.kPageImageLoading,t)}))};render(){return Q0(US.Z,{filter:this.props.filter},void 0,Q0("div",{className:"setting-group"},void 0,Q0("div",{className:"setting-single"},void 0,Q0("h3",{},void 0,(0,Oe.Z)("page settings","Load Images")),Q0("p",{className:"info"},void 0,(0,Oe.Z)("Image loading setting for new tabs.")),Q0(vl,{name:"imageLoadingPolicy",value:this.state.imageLoading,onChange:this.onSelected},void 0,Q0("div",{className:"setting-single"},void 0,Q0("label",{},void 0,q0,Q0("span",{},void 0,(0,Oe.Z)("radio","Always")))),Q0("div",{className:"setting-single"},void 0,Q0("label",{},void 0,J0,Q0("span",{},void 0,(0,Oe.Z)("radio","Never")))),Q0("div",{className:"setting-single"},void 0,Q0("label",{},void 0,e1,Q0("span",{},void 0,(0,Oe.Z)("radio","Cached"))))))))}}const n1=t1;var s1;function i1(e,t,n,s){s1||(s1="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:s1,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const o1=[$.kWebpagesPictureInPictureButtonEnabled],a1=Ne.Z.getEventHandler;class r1 extends hs.Component{render(){return i1(US.Z,{filter:this.props.filter},void 0,i1("div",{className:"setting-group unlimited"},void 0,i1("div",{className:"setting-single"},void 0,i1("label",{},void 0,i1("input",{type:"checkbox",checked:this.props.prefValues[$.kWebpagesPictureInPictureButtonEnabled],onChange:a1($.kWebpagesPictureInPictureButtonEnabled)}),i1("span",{},void 0,(0,Oe.Z)("Picture-in-Picture Button on Videos"))),i1("p",{className:"info"},void 0,(0,Oe.Z)("This setting requires a restart to take effect.")))))}}const l1=sa(r1,o1);var d1;function c1(e,t,n,s){d1||(d1="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:d1,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const h1=[$.kNetworkPredictionOptions];function p1(e){const t=(0,na.Z)(h1);return c1(US.Z,{filter:e.filter},void 0,c1("div",{className:"setting-group"},void 0,c1("h3",{},void 0,(0,Oe.Z)("Prefetch")),c1("p",{className:"info"},void 0,(0,Oe.Z)("Follow webpage suggestions to prefetch DNS, and to preload resources and documents early.")),c1("div",{className:"setting-single"},void 0,c1("label",{},void 0,c1("input",{type:"checkbox",checked:2!==t[$.kNetworkPredictionOptions],onChange:e=>{const{checked:t}=e.currentTarget;Ne.Z.set($.kNetworkPredictionOptions,t?0:2)}}),c1("span",{},void 0,(0,Oe.Z)("Prefetch Resources"))))))}var u1;function g1(e,t,n,s){u1||(u1="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:u1,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const m1=[$.kWebpagesAllowSelectionInLinks],v1=Ne.Z.getEventHandler;class f1 extends hs.Component{render(){return g1(US.Z,{filter:this.props.filter},void 0,g1("div",{className:"setting-group unlimited"},void 0,g1("div",{className:"setting-single"},void 0,g1("label",{},void 0,g1("input",{type:"checkbox",checked:this.props.prefValues[$.kWebpagesAllowSelectionInLinks],onChange:v1($.kWebpagesAllowSelectionInLinks)}),g1("span",{},void 0,(0,Oe.Z)("Allow Text Selection in Links"))))))}}const y1=sa(f1,m1);var C1;function w1(e,t,n,s){C1||(C1="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:C1,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const b1=[$.kWebpagesSmoothScrollingEnabled],S1=Ne.Z.getEventHandler;class I1 extends hs.Component{render(){return w1(US.Z,{filter:this.props.filter},void 0,w1("div",{className:"setting-group unlimited"},void 0,w1("div",{className:"setting-single"},void 0,w1("label",{},void 0,w1("input",{type:"checkbox",checked:this.props.prefValues[$.kWebpagesSmoothScrollingEnabled],onChange:S1($.kWebpagesSmoothScrollingEnabled)}),w1("span",{},void 0,(0,Oe.Z)("Smooth Scrolling"))),w1("p",{className:"info"},void 0,(0,Oe.Z)("This setting requires a restart to take full effect.")))))}}const k1=sa(I1,b1);var A1;function T1(e,t,n,s){A1||(A1="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:A1,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Z1=Ne.Z.getEventHandler,E1=[$.kWebpagesTabFocusesLinks];var _1=T1("input",{type:"radio",value:"false"}),M1=T1("input",{type:"radio",value:"true"});class N1 extends hs.Component{render(){return T1(US.Z,{filter:this.props.filter},void 0,T1("div",{className:"setting-group"},void 0,T1("div",{className:"setting-single"},void 0,T1("h3",{},void 0,(0,Oe.Z)("Webpage Focus")),T1("p",{className:"info"},void 0,(0,Oe.Z)("This setting takes effect in new tabs or windows only.")),T1(vl,{name:"tabToFocusSetting",className:"setting-single",value:this.props.prefValues[$.kWebpagesTabFocusesLinks],onChange:Z1($.kWebpagesTabFocusesLinks,"convert")},void 0,T1("div",{className:"setting-single"},void 0,T1("label",{},void 0,_1,T1("span",{},void 0,(0,Oe.Z)("Focus Forms Only")))),T1("div",{className:"setting-single"},void 0,T1("label",{className:"setting-single"},void 0,M1,T1("span",{},void 0,(0,Oe.Z)("Focus All Controls and Links"))))))))}}const P1=sa(N1,E1);var D1;function x1(e,t,n,s){D1||(D1="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:D1,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const O1=[$.kWebpagesTranslateSelectionButtonEnabled],L1=Ne.Z.getEventHandler;class R1 extends hs.Component{render(){return x1(US.Z,{filter:this.props.filter},void 0,x1("div",{className:"setting-group unlimited"},void 0,x1("div",{className:"setting-single"},void 0,x1("label",{},void 0,x1("input",{type:"checkbox",checked:this.props.prefValues[$.kWebpagesTranslateSelectionButtonEnabled],onChange:L1($.kWebpagesTranslateSelectionButtonEnabled)}),x1("span",{},void 0,(0,Oe.Z)("Show Selected Text Translate Button"))))))}}const B1=sa(R1,O1);var F1;function V1(e,t,n,s){F1||(F1="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:F1,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class W1 extends hs.Component{render(){return V1(mN,{categoryTitle:(0,Oe.Z)("Webpages"),filter:this.props.filter},void 0,(0,fs.jsx)(k1,{...this.props}),(0,fs.jsx)(U0,{...this.props}),(0,fs.jsx)(l1,{...this.props}),(0,fs.jsx)(y1,{...this.props}),(0,fs.jsx)(B1,{...this.props}),(0,fs.jsx)(P1,{...this.props}),(0,fs.jsx)(L0,{...this.props}),(0,fs.jsx)(Y0,{...this.props}),(0,fs.jsx)(n1,{...this.props}),(0,fs.jsx)(p1,{...this.props}),(0,fs.jsx)(M0,{...this.props}))}}const U1=W1;(0,Oe.Z)("title","Name"),(0,Oe.Z)("Latitude"),(0,Oe.Z)("Longitude"),(0,Oe.Z)("Add your First Geolocation"),(0,Oe.Z)("Press the “Add” button to the left to add a new Geolocation"),rW.lE.map((e=>({label:e.value,key:e.key,local:e.local}))),[...m.z].map((e=>{const t=e.replace(/_/g," ");return{identifier:e,label:t}}));$.kGeolocationAccuracy,$.kGeolocationDefaultLocationId,$.kGeolocationLatitude,$.kGeolocationList,$.kGeolocationLongitude,$.kGeolocationUseOverride,je.jk.settingCategories,Ne.Z.getEventHandler;var H1;function z1(e,t,n,s){H1||(H1="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:H1,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const G1=je.jk.settingCategories,$1="http://example.com/?path=",K1=[$.kMailIsTurnedOff,$.kThemesPreview,$.kThemesUser,$.kSettingsMonoIcons,$.kWorkspacesEnabled];function j1(e){const t=(0,vs.DP)(e);return t.scroll?t.scroll:""}function Y1(e){const t=(0,vs.DP)(e),n=t.query,s=n?"all":t.path,i=s&&s.split("/");let o;if(!n&&i&&i.length>0&&G1[i[0]]&&(o=G1[i[0]],i.length>1)){const e=i.join("_");o=G1[e]}return o||(n?G1.all:G1.general)}function X1(e){return(0,vs.DP)(e)?.search||""}var Q1=z1("svg",{className:"guest-intro-background",viewBox:"0 0 1244 860"},void 0,z1("path",{fill:"url(#guest-intro-bg-gradient)",d:"M0 0h153.513c16.141 27.93 32.15 55.734 47.912 83.11 16.086 27.94 32.722 56.832 49.076 85.128 11.01 19.031 22.079 38.316 32.781 56.967 25.186 43.883 51.228 89.259 77.402 132.848 33.382 55.651 75.894 82.121 137.77 85.829 3.205.192 6.454.288 9.655.288 39.673 0 78.14-14.461 108.316-40.722 21.644-18.834 48.687-52.291 54.604-104.667.749-6.654 1.357-13.708 1.855-19.573-1.07-29.74-6.476-52.92-17.294-74.518C622.935 139.46 612.708 67.99 625.087 0h136.676C747.1 44.93 749.845 96.364 774.32 145.251c20.839 41.6 30.654 85.7 31.485 138.023-.568 6.192-1.472 18.273-2.83 30.356-17.572 155.524-149.172 263.318-294.866 263.318-5.816 0-11.67-.173-17.526-.521C382.84 569.97 301.9 518.174 246.822 426.358c-38.015-63.313-74.255-127.68-111.253-191.634C90.359 156.507 45.49 78.062 0 0zm1113.47 0H1244v140.1c-7.496 27.86-18.849 54.995-34.031 81.275a1299530.57 1299530.57 0 0 1-170.255 294.799A1223193.145 1223193.145 0 0 0 841.018 860.24H687.72c135.675-235.123 271.527-470.147 407.26-705.25 22.311-38.621 31.22-79.696 25.368-124.548A170.12 170.12 0 0 0 1113.471 0z"}));function q1(e){return z1("div",{className:"guest-intro"},void 0,Q1,z1("div",{className:"guest-intro-content"},void 0,z1("h1",{},void 0,(0,Oe.Z)("Settings Unavailable")),z1("p",{},void 0,(0,Oe.Z)("Settings are not available in guest windows.")),z1("p",{},void 0,z1("a",{tabIndex:0,href:uA,onClick:t=>gA(e.windowId,t)},void 0,(0,Oe.Z)("Learn more about Guest Profiles")))))}class J1 extends hs.Component{static contextType=xi.Z;refFocusTrap=hs.createRef();refSidebar=hs.createRef();refContent=hs.createRef();state={category:Y1(this.props.url),filter:X1(this.props.url),showThemePreview:void 0};static getDerivedStateFromProps(e,t){return e.url.startsWith($1)?null:{category:Y1(e.url)}}componentDidMount(){const{document:e,vivaldiWindowId:t}=this.context;G.ZP.isSettings(t)&&(e.title=this.getWindowTitle()),setTimeout((()=>this.scrollToAnchor(this.props.url)),200),this.focusFilterInput()}componentDidUpdate(e,t){const{document:n,vivaldiWindowId:s}=this.context;if(G.ZP.isSettings(s)&&t.category!==this.state.category&&(n.title=this.getWindowTitle()),t.category!==this.state.category&&this.scrollTop(),e.prefValues[$.kThemesPreview]?.length<this.props.prefValues[$.kThemesPreview]?.length){const{name:t,id:n}=this.props.prefValues[$.kThemesPreview][0];G.ZP.isSettings(this.context.vivaldiWindowId)&&G.ZP.isActive(this.context.vivaldiWindowId)?this.setState({showThemePreview:{themeName:t,isUpdate:this.props.prefValues[$.kThemesUser].findIndex((e=>e.id===n))>-1}}):e.prefValues[$.kThemesPreview].length<this.props.prefValues[$.kThemesPreview].length&&this.closeThemePreview()}j1(this.props.url)&&this.scrollToAnchor(this.props.url)}componentWillUnmount(){0}closeThemePreview=()=>this.setState({showThemePreview:void 0});focusFilterInput=()=>this.refSidebar.current?.focus();scrollToAnchor=e=>{const t=j1(e);if(!t)return;const n=this.refFocusTrap.current?.focusRef.current,{HTMLElement:s}=this.context;if(!(n instanceof s))return;const i=n.querySelector(`[data-anchor='${t}']`);i&&i.scrollIntoView(!0)};onMacMenuAction=(e,t,n)=>{this.context.vivaldiWindowId===e&&J.Z.isActionWhitelistedForSettings(t)&&v.Z.executeActions("menu",this.context,t)};getWindowTitle=()=>this.state.category?(0,Oe.Z)("Vivaldi Settings: $1",[this.state.category.title]):(0,Oe.Z)("Vivaldi Settings");show=e=>{const t=this.state.category&&this.state.category===G1.all,n=this.state.category&&this.state.category===e;return t||n};onSettingsFilterChange=e=>{this.setState({filter:e}),this.state.category!==G1.all&&this._setCategory("all")};setCategory=e=>{this.setState({filter:""}),this._setCategory(e)};scrollTop=()=>{this.refContent.current&&(this.refContent.current.scrollTop=0)};_setCategory=e=>{const t=this.context.vivaldiWindowId;G.ZP.isSettings(t)?this.setState({category:G1[e]}):d.ZP.openURL(t,je.jk.internalUrl("settings",e),{inCurrent:!0})};render(){if(G.ZP.isGuest())return z1(q1,{windowId:this.context.vivaldiWindowId});const{filter:e}=this.state,t=e.length>=2?e:"";return(0,fs.jsxs)(fs.Fragment,{children:[z1("header",{className:"settings-header"},void 0,z1("h1",{},void 0,this.getWindowTitle())),(0,fs.jsxs)(da.Z,{ref:this.refFocusTrap,focusName:"focus_settings",className:As()("vivaldi-settings",{"mono-icons":this.props.prefValues[$.kSettingsMonoIcons]}),children:[z1(ij,{focusRef:this.refSidebar,filter:this.state.filter,onFilterChange:this.onSettingsFilterChange,selectedCategory:this.state.category,onCategorySelected:this.setCategory}),this.state.category&&(0,fs.jsxs)("div",{className:"settings-content",ref:this.refContent,children:[this.show(G1.general)&&(0,fs.jsxs)(fs.Fragment,{children:[z1("section",{className:"setting-section"},void 0,z1(bY,{filter:t})),z1("section",{className:"setting-section"},void 0,z1(lP,{filter:t})),z1("section",{className:"setting-section"},void 0,z1(wW,{filter:t})),z1("section",{className:"setting-section"},void 0,z1(QP,{filter:t})),z1(lK,{name:G1.general.title,filter:t,prefPaths:[$.kAcceptLanguages,$.kCalendarDateFormat,$.kCalendarStartOfWeek,$.kCalendarWeekNumberRule,$.kConfirmToQuitEnabled,$.kHomepage,$.kHomepageCache,$.kStartupCheckIsDefault,$.kSystemShowExitConfirmationDialog,$.kTabsAlwaysLoadPinnedAfterRestore,$.kTabsDeferLoadingAfterRestore,$.kTranslateEnabled,$.kURLsToRestoreOnStartup,$.kWelcomeReadPages,$.kWelcomeSeenPages,$.kWindowsShowWindowCloseConfirmationDialog]})]}),this.show(G1.appearance)&&(0,fs.jsxs)(fs.Fragment,{children:[z1("section",{className:"setting-section"},void 0,z1(iP,{filter:t})),z1("section",{className:"setting-section"},void 0,z1(fG,{filter:t})),z1(lK,{name:G1.appearance.title,filter:t,prefPaths:[$.kAppearanceCssUiModsDirectory,$.kAppearanceForceDarkModeTheme,$.kAppearanceRangeButtons,$.kMenuDisplay,$.kMenuIconType,$.kPopupsShowInTab,$.kPreferredColorScheme,$.kSettingsInTab,$.kSettingsMonoIcons,$.kStatusBarDisplay,$.kStatusBarMinimized,$.kThemeDimBlurred,$.kThemeSimpleScrollbar,$.kThemeUseAnimation,$.kToolbarsNavigation,$.kToolbarsPanel,$.kToolbarsStatus,$.kWindowsLinuxAltControls,$.kWindowsUseNativeDecoration]})]}),this.show(G1.themes)&&(0,fs.jsxs)(fs.Fragment,{children:[z1("section",{className:"setting-section"},void 0,z1(u0,{filter:t})),z1("section",{className:"setting-section"},void 0,z1(W$,{filter:t}),z1(TV,{filter:t})),z1(lK,{name:G1.themes.title,filter:t,prefPaths:[$.kHueBridgeIp,$.kHueEnabled,$.kHueLights,$.kHueUsername,$.kRazerChromaDevices,$.kRazerChromaEnabled,$.kSystemAccentColor,$.kThemeScheduleEnabled,$.kThemeScheduleOS,$.kThemeScheduleTimeline,$.kThemesCurrent,$.kThemesCurrentPrivate,$.kThemesPreview,$.kThemesSystem,$.kThemesUser]})]}),this.show(G1.startpage)&&(0,fs.jsxs)(fs.Fragment,{children:[z1("section",{className:"setting-section"},void 0,z1(Zj,{filter:t})),z1(lK,{name:G1.startpage.title,filter:t,prefPaths:[$.kStartpageNavigation,$.kStartpageSpeedDialAddButtonVisible,$.kStartpageSpeedDialAllowDnd,$.kStartpageSpeedDialColumns,$.kStartpageSpeedDialControlsVisible,$.kStartpageSpeedDialDeleteVisible,$.kStartpageSpeedDialFaviconVisible,$.kStartpageSpeedDialGameButtonShow,$.kStartpageSpeedDialPrivacyStatsShow,$.kStartpageSpeedDialTitlesVisible,$.kStartpageSpeedDialSize]})]}),this.show(G1.tabs)&&(0,fs.jsxs)(fs.Fragment,{children:[z1("section",{className:"setting-section"},void 0,z1(mJ,{filter:t,isWorkspacesEnabled:this.props.prefValues[$.kWorkspacesEnabled]})),z1(lK,{name:G1.tabs.title,filter:t,prefPaths:[$.kMouseWheelTabSwitch,$.kTabsActivationOnClone,$.kTabsActivationOnClose,$.kTabsActivationPreferRelated,$.kTabsActiveMinSize,$.kTabsAlignNext,$.kTabsAtEdge,$.kTabsAutoMuting,$.kTabsBarPosition,$.kTabsBarWidth,$.kTabsCloseButtonLeft,$.kTabsCloseButtonPermanent,$.kTabsClosePinned,$.kTabsCounterDetection,$.kTabsCycleByRecentOrder,$.kTabsDimHibernated,$.kTabsDoubleClickClose,$.kTabsFocusWebview,$.kTabsHorizontalScrolling,$.kTabsMinimize,$.kTabsNeverCloseLast,$.kTabsNewPageCustomUrl,$.kTabsNewPageLink,$.kTabsNewPlacement,$.kTabsOpenNewInBackground,$.kTabsPageLoadInfo,$.kTabsSelectionEnabled,$.kTabsSelectionIncludeActive,$.kTabsShowCloseButton,$.kTabsShowSeparator,$.kTabsShowSyncedTabsButton,$.kTabsShowTrashCan,$.kTabsStackingAllowDnd,$.kTabsStackingAutoExpand,$.kTabsStackingDndDelay,$.kTabsStackingMode,$.kTabsStackingOpenInCurrent,$.kTabsStackingPreferDotted,$.kTabsTilingCollapseBorder,$.kTabsThumbnails,$.kTabsTooltip,$.kTabsUnread,$.kTabsVisible,$.kTabsVisualSwitchEnable,$.kTabsVisualSwitchListLayout,$.kWorkspacesButtonShowInTabbar,$.kWorkspacesEnabled,$.kWorkspacesLinkRoutes]})]}),this.show(G1.panel)&&(0,fs.jsxs)(fs.Fragment,{children:[z1("section",{className:"setting-section"},void 0,z1(QG,{filter:t})),z1(lK,{name:G1.panel.title,filter:t,prefPaths:[$.kMailContactDefaultAction,$.kMailSingleClickTabs,$.kNotesCreationAddScreenshot,$.kNotesCreationNotify,$.kNotesCreationShowPanel,$.kPanelsAsOverlayAutoClose,$.kPanelsAsOverlayEnabled,$.kPanelsLazyLoad,$.kPanelsPosition,$.kPanelsShowCloseButton,$.kPanelsShowFolderBadge,$.kPanelsShowToggle,$.kPanelsTranslatePaste,$.kPanelsTranslateRedirect,$.kPanelsWindowDragToStack,$.kPanelsWindowShowPinnedGroup,$.kPanelsWindowShowUnread,$.kPanelsWindowSingleClickOpens,$.kReadingListPanelSingleClickOpens,$.kReadingListShowCounter]})]}),this.show(G1.addressbar)&&(0,fs.jsxs)(fs.Fragment,{children:[z1("section",{className:"setting-section"},void 0,z1(AN,{filter:t})),z1(lK,{name:G1.addressbar.title,filter:t,prefPaths:[$.kAddressBarAutocompleteEnabled,$.kAddressBarAutocompleteAutocompleteOnTitle,$.kAddressBarAutocompleteSuffixExpansionEnabled,$.kAddressBarAutocompleteSuffixExpansionValue,$.kAddressBarExtensionsRenderInDropdown,$.kAddressBarExtensionsShowAllToggle,$.kAddressBarHighlightBaseDomain,$.kAddressBarOmniboxCutcopyEncoded,$.kAddressBarOmniboxEnabled,$.kAddressBarOmniboxShowBookmarks,$.kAddressBarOmniboxShowBrowserHistory,$.kAddressBarOmniboxShowSearchHistory,$.kAddressBarOmniboxShowTopSites,$.kAddressBarOmniboxShowTypedHistory,$.kAddressBarPosition,$.kAddressBarSelectOnClick,$.kAddressBarShowFullUrl,$.kAddressBarShowProfile,$.kAddressBarShowProgress,$.kAddressBarShowQrGenerator,$.kAddressBarShowReadingList,$.kAddressBarStripJavascriptOnPaste,$.kAddressBarUrlOpenShortcut,$.kAddressBarVisible]})]}),this.show(G1.bookmarks)&&(0,fs.jsxs)(fs.Fragment,{children:[z1("section",{className:"setting-section"},void 0,z1($P,{filter:t}),z1(VP,{filter:t})),z1(lK,{name:G1.bookmarks.title,filter:t,prefPaths:[$.kBookmarksBarDisplay,$.kBookmarksBarPosition,$.kBookmarksBarVisible,$.kBookmarksConfirmAdding,$.kBookmarksConfirmOpening,$.kBookmarksConfirmOpeningThreshold,$.kBookmarksFetchPageMetadata,$.kBookmarksOpenInNewTab,$.kBookmarksSingleClickOpens,$.kBookmarksUnderlineMenuLetter]})]}),this.show(G1.qc)&&(0,fs.jsxs)(fs.Fragment,{children:[z1("section",{className:"setting-section"},void 0,z1(x$,{filter:t,category:this.state.category})),z1(lK,{name:G1.qc.title,filter:t,prefPaths:[$.kQuickCommandsKeepValue,$.kQuickCommandsLimitResults,$.kQuickCommandsMatchNickname,$.kQuickCommandsOpenUrlInNewTab,$.kQuickCommandsSearchEnglish,$.kQuickCommandsSearchPriority,$.kQuickCommandsShowBookmarks,$.kQuickCommandsShowCalculator,$.kQuickCommandsShowExtensions,$.kQuickCommandsShowHistory,$.kQuickCommandsShowNotes,$.kQuickCommandsShowPageActions,$.kQuickCommandsShowReadingList,$.kQuickCommandsUseNotesManager]})]}),this.show(G1.keyboard)&&(0,fs.jsxs)(fs.Fragment,{children:[z1("section",{className:"setting-section"},void 0,z1(oW,{filter:t,view:"editable"})),z1(lK,{name:G1.keyboard.title,filter:t,prefPaths:[$.kChainedCommandsCommandList,$.kKeyboardShortcutsAltOpensMenu,$.kKeyboardShortcutsEnable,$.kKeyboardShortcutsEnableSingleKey,$.kKeyboardShortcutsEnableSingleKeyForMail,$.kKeyboardShortcutsSpaceFastForwards,$.kKeyboardTabToAll,$.kKeyboardTabToAllUsesSystemDefault,$.kSystemMacKeyboardUiMode,$.kWebpagesAccessKeys,$.kWebpagesFocusTrap]})]}),this.show(G1.mouse)&&(0,fs.jsxs)(fs.Fragment,{children:[z1("section",{className:"setting-section"},void 0,z1(DG,{filter:t,category:this.state.category})),z1(lK,{name:G1.mouse.title,filter:t,prefPaths:[$.kMouseGesturesAltGesturesEnabled,$.kMouseGesturesDoubleClickMenuEnabled,$.kMouseGesturesEnabled,$.kMouseGesturesRockerGesturesEnabled,$.kMouseGesturesStrokeTolerance,$.kMouseGesturesRockerGesturesRightToLeft,$.kMouseGesturesRockerGesturesLeftToRight]})]}),this.show(G1.search)&&(0,fs.jsxs)(fs.Fragment,{children:[z1("section",{className:"setting-section"},void 0,z1(jK,{filter:t})),z1(lK,{name:G1.search.title,filter:t,prefPaths:[$.kAddressBarInlineSearchEnabled,$.kAddressBarInlineSearchSuggestEnabled,$.kAddressBarInlineSearchSuggestOnNickname,$.kAddressBarSearchAllowExtensionOverride,$.kAddressBarSearchDisplay,$.kAddressBarSearchInNewTab,$.kAddressBarSearchKeepSelected,$.kAddressBarSearchShowFavicon,$.kAddressBarSearchSuggestEnabled,$.kPageSearchInBackground,$.kStartpageSpeedDialDisplaySearch,$.kVivaldiAddressBarSearchDirectMatchEnabled]})]}),this.show(G1.privacy)&&(0,fs.jsxs)(fs.Fragment,{children:[z1("section",{className:"setting-section"},void 0,z1(f$,{filter:t})),z1("section",{className:"setting-section"},void 0,z1(GF,{filter:t})),k$.ZP.getSupportsProxy()&&z1("section",{className:"setting-section"},void 0,z1(I$,{filter:t})),z1("section",{className:"setting-section"},void 0,z1(qK,{filter:t})),z1("section",{className:"setting-section"},void 0,z1(TK,{filter:t})),z1("section",{className:"setting-section"},void 0,z1(o$,{filter:t})),z1("section",{className:"setting-section"},void 0,z1(aV,{filter:t})),!1,z1(lK,{name:G1.privacy.title,filter:t,prefPaths:[$.kAddressBarInlineSearchEnabled,$.kAddressBarInlineSearchSuggestEnabled,$.kAddressBarSearchSuggestEnabled,$.kAddressBarSearchTypedHistoryEnabled,$.kAddressBarTypedHistoryEnabled,$.kAllowJavascriptAppleEvents,$.kAlternateErrorPagesEnabled,$.kCredentialsEnableService,$.kEnableDoNotTrack,$.kHistoryDaysToKeepVisits,$.kIncognitoShowIntro,$.kPrivacyAdverseAdBlockEnabled,$.kPrivacyAutofillServerAssist,$.kPrivacyGoogleComponentExtensionsHangoutServices,$.kPrivacyGoogleComponentExtensionsWebStore,$.kSafeBrowsingEnabled,$.kSavingBrowserHistoryDisabled,$.kVivaldiCrashReportingConsentGranted,$.kWebRTCIPHandlingPolicy,$.kExceptionsAugmentedReality,$.kExceptionsAutoDownload,$.kExceptionsAutoplay,$.kExceptionsBackgroundSync,$.kExceptionsBluetooth,$.kExceptionsCamera,$.kExceptionsClipboard,$.kExceptionsFileEdit,$.kExceptionsFont,$.kExceptionsGeolocation,$.kExceptionsHID,$.kExceptionsIdle,$.kExceptionsImage,$.kExceptionsJavaScript,$.kExceptionsMIDI,$.kExceptionsMic,$.kExceptionsNotifications,$.kExceptionsPayment,$.kExceptionsPopUp,$.kExceptionsSensors,$.kExceptionsSerial,$.kExceptionsSound,$.kExceptionsSubResource,$.kExceptionsUSB,$.kExceptionsVirtualReality,$.kExceptionsWebID,$.kExceptionsWindowManagement]})]}),this.show(G1.downloads)&&(0,fs.jsxs)(fs.Fragment,{children:[z1("section",{className:"setting-section"},void 0,z1(pV,{filter:t})),z1(lK,{name:G1.downloads.title,filter:t,prefPaths:[$.kDownloadDefaultDirectory,$.kDownloadsNotifyOnComplete,$.kDownloadsOpenPanelOnNew,$.kDownloadsStartAutomatically,$.kDownloadsUpdateDefaultDownloadWhenSavingAs,$.kDownloadsUsePopout]})]}),this.show(G1.sync)&&z1("section",{className:"setting-section"},void 0,z1(PX,{url:this.props.url,category:this.state.category,filter:t})),this.show(G1.webpages)&&(0,fs.jsxs)(fs.Fragment,{children:[z1("section",{className:"setting-section"},void 0,z1(U1,{filter:t})),z1("section",{className:"setting-section"},void 0,z1(C0,{filter:t})),z1("section",{className:"setting-section"},void 0,z1(sK,{prefs:!0,filter:t})),z1("section",{className:"setting-section"},void 0,z1(TF,{filter:t})),z1("section",{className:"setting-section"},void 0,z1(bV,{filter:t})),z1(lK,{name:G1.webpages.title,filter:t,prefPaths:[$.kHardwareAccelerationModeEnabled,$.kMouseWheelPageZoom,$.kPageImageLoading,$.kPluginsAlwaysOpenPdfExternally,$.kPluginsWidevineEnabled,$.kWebKitCursiveFontFamily,$.kWebKitDefaultFontSize,$.kWebKitFantasyFontFamily,$.kWebKitFixedFontFamily,$.kWebKitMinimumFontSize,$.kWebKitSansSerifFontFamily,$.kWebKitSerifFontFamily,$.kWebKitStandardFontFamily,$.kWebpagesAllowSelectionInLinks,$.kWebpagesCaptureDirectory,$.kWebpagesCaptureSaveFilePattern,$.kWebpagesFullScreenHideMouse,$.kWebpagesFullScreenShowBubble,$.kWebpagesPictureInPictureButtonEnabled,$.kWebpagesSmoothScrollingEnabled,$.kWebpagesSpatialNavigationEnabled,$.kWebpagesTabFocusesLinks,$.kWebpagesTabZoomEnabled,$.kWebpagesTranslateSelectionButtonEnabled]})]}),this.show(G1.network)&&z1("section",{className:"setting-section"},void 0,z1(WG,{filter:t}),z1(lK,{name:G1.network.title,filter:t,prefPaths:[$.kVivaldiClientHintsBrandAppendVivaldi,$.kVivaldiClientHintsBrand,$.kVivaldiClientHintsBrandCustomBrand,$.kVivaldiClientHintsBrandCustomBrandVersion]})),this.show(G1.rss)&&z1("section",{className:"setting-section"},void 0,z1(OW,{filter:t})),this.show(G1.mail)&&z1("section",{className:"setting-section"},void 0,z1(Dz,{filter:t})),this.show(G1.calendar)&&z1("section",{className:"setting-section"},void 0,z1(vF,{filter:t})),ds.Z.isEnabled("chat")&&this.show(G1.chat)&&z1("section",{className:"setting-section"},void 0,z1(ZF,{filter:t})),this.show(G1.biscuit)&&z1("section",{className:"setting-section"},void 0,z1(EP,{filter:t})),!1]}),this.state.showThemePreview&&z1(sp,{onClose:this.closeThemePreview,themeName:this.state.showThemePreview.themeName,isUpdate:this.state.showThemePreview.isUpdate})]})]})}}const e2=sa(J1,K1);class t2 extends Ol.Z{_tasks=(0,te.aV)();getBackgroundTasks(){return this._tasks}dispatchAction(e){if("BACKGROUND_TASKS_SET"===e.actionType)this._tasks=(0,te.aV)(e.tasks),this.emitChange()}}const n2=new t2(y.Z);class s2{#G;#$=0;#K=(0,te.aV)();#j=new Event("undoredo");#Y=!0;#X=!0;constructor(e=500){if(e<1)throw new Error("Stack size must be greater than 0");this.#G=e}record(e){this.#K=this.#K.slice(this.#$,this.#G-1+this.#$).unshift(e),this.#$=0,this._onChange()}clear(){this.#K=(0,te.aV)(),this.#$=0,this._onChange()}undo(){this.#Y||(this.#K.get(this.#$)?.undo(),this.#$+=1,this._onChange(),document.dispatchEvent(this.#j))}redo(){this.#X||(this.#$-=1,this.#K.get(this.#$)?.redo(),this._onChange(),document.dispatchEvent(this.#j))}_onChange(){this.#Y=this.#$===this.#K.size,this.#X=0===this.#$}canUndo(){return!this.#Y}canRedo(){return!this.#X}}class i2{#Q;#q;constructor(e,t,n){this.#Q=e,this.#q=t,this._updateFunction=n}undo(){this._updateFunction(this.#Q)}redo(){this._updateFunction(this.#q)}}var o2,a2=n(64626);class r2{cut=g.Z.cut;copy=g.Z.copy;constructor(){this.undoStack=new s2}undo(){this.undoStack.undo()}redo(){this.undoStack.redo()}canUndo(){return this.undoStack.canUndo()}canRedo(){return this.undoStack.canRedo()}clearUndoStack(){this.undoStack.clear()}async paste(e,t,n){const s=ps.ZP.getCutIds(),i=s.length>0?ps.ZP.getItemById(s[0]).parentId:"",o=await g.Z.paste(e,t,n),{isCut:a,ids:r}=o;return this.undoStack.record(new i2({sourceId:i,isCut:a,ids:r},{sourceId:i,targetId:t,isCut:a,ids:r},(e=>{e.targetId?g.Z.move(e.ids,e.targetId,0):a?g.Z.move(e.ids,e.sourceId,0):g.Z.remove(e.ids)}))),o}async create(e){const t=await s.Z.bookmarks.create(e);if(t)return this.undoStack.record(new i2({createdId:t.id,remove:!0},{createdId:t.id,parentId:t.parentId},(e=>{e.remove?g.Z.remove([e.createdId]):g.Z.move([e.createdId],e.parentId||"",t.index||0)}))),t}async createWithPromise(e,t,n){const s=await g.Z.createWithPromise(e,t,n),i=s.map((e=>e.id));return this.undoStack.record(new i2({createdIds:i,parentId:t,index:n,remove:!0},{createdIds:i,parentId:t,index:n},(e=>{e.remove?g.Z.remove(e.createdIds):g.Z.move(e.createdIds,e.parentId,e.index||0)}))),s}update(e,t){const n=ps.ZP.getItemById(e);return s.Z.bookmarks.update(e,t).then((i=>(this.undoStack.record(new i2({nodeId:e,item:(0,a2.Z)(n,Object.keys(t))},{nodeId:e,item:t},(e=>{s.Z.bookmarks.update(e.nodeId,e.item)}))),i)))}async mergeWithPromise(e,t,n){const s=(await this.createWithPromise([{parentId:e.parentId,children:[],title:n}],e.parentId||"",t.index))[0].id;return await this.move([e.id,t.id],s,0),s}async move(e,t,n){const s=e.length>0?ps.ZP.getItemById(e[0]).parentId:"",i=await g.Z.move(e,t,n);return this.undoStack.record(new i2({ids:e,parentId:s,index:0},{ids:e,parentId:t,index:n},(e=>{g.Z.move(e.ids,e.parentId,e.index)}))),i}async reorder(e,t){const n={nodeId:t,order:ps.ZP.getItemById(t)?.children?.map((e=>e.id))??[]},s=await g.Z.reorder(e,t);return this.undoStack.record(new i2(n,{nodeId:t,order:e},(e=>{g.Z.reorder(e.order,e.nodeId)}))),s}async remove(e=[]){if(0===e.length)return;const t={removed:e,parentId:ps.ZP.getItemById(e[0]).parentId};await g.Z.remove(e),this.undoStack.record(new i2(t,{ids:e},(e=>{e.removed?g.Z.move(e.removed,e.parentId||"",0):g.Z.remove(e.ids)})))}async duplicate(e,t,n){const s=await g.Z.duplicate(e,t,n);return this.undoStack.record(new i2({ids:s,remove:!0},{ids:s,parentId:t,index:n},(e=>{e.remove?g.Z.remove(e.ids):g.Z.move(e.ids,e.parentId,e.index)}))),s}async createBookmarks(e,t,n){const s=await g.Z.createBookmarks(e,t,n,"none");return this.undoStack.record(new i2({ids:s,remove:!0},{ids:s,parentId:t,index:n},(e=>{e.remove?g.Z.remove(e.ids):g.Z.move(e.ids,e.parentId,e.index)}))),s}onDropEvent(e,t,n,s){if(e.dataTransfer.types.includes(Ds.yR)){const i=JSON.parse(e.nativeEvent.dataTransfer.getData(Ds.yR));Ds.ZP.isCopyModifierPressed(e)||s&&s.disableMove?this.duplicate(i,t,n):this.move(i,t,n)}else Ds.ZP.getUrlsFromEventPromise(e,!0).then((e=>this.createBookmarks(e,t,n)))}}function l2(e,t,n,s){o2||(o2="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:o2,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class d2 extends hs.PureComponent{_imageElementKey=0;_reloadRetryCount=0;componentDidUpdate(e){e.src!==this.props.src&&this.finishErrorRecovery()}componentWillUnmount(){this.finishErrorRecovery()}finishErrorRecovery(){this._reloadRetryCount=0,void 0!==this._reloadRetryTimer&&(clearTimeout(this._reloadRetryTimer),this._reloadRetryTimer=void 0)}onImageError=()=>{if(void 0!==this._reloadRetryTimer)return;if(this._reloadRetryCount>=4)return void(4===this._reloadRetryCount&&(this._reloadRetryCount=5,this.props.onImageLoadError&&this.props.onImageLoadError(this.props.src)));this._reloadRetryCount++;const e=1e3*Math.pow(2,this._reloadRetryCount);this._reloadRetryTimer=setTimeout(this.onTryReload,e)};onTryReload=()=>{this._reloadRetryTimer=void 0,this._imageElementKey++,this.forceUpdate()};render(){const e=this.props.className||"thumbnail-image";if(this.props.src)return l2("div",{className:e,onPointerEnter:this.props.onPointerEnter,onPointerLeave:this.props.onPointerLeave,onPointerDown:this.props.onPointerDown,onPointerUp:this.props.onPointerUp},void 0,l2("img",{width:"100%",height:"auto",src:this.props.src,onError:this.onImageError},this._imageElementKey));if(this.props.title&&!this.props.isFolder){const t=this.props.backgroundColor?B().contrast(this.props.backgroundColor,"#FFFFFF")>=3?"#FFFFFF":"#000000":"var(--colorFg)";return l2("div",{className:e,style:{backgroundColor:this.props.backgroundColor??"var(--colorBgDarker)"},onPointerEnter:this.props.onPointerEnter,onPointerLeave:this.props.onPointerLeave,onPointerDown:this.props.onPointerDown,onPointerUp:this.props.onPointerUp},void 0,l2("span",{style:{color:t}},void 0,this.props.title))}return l2("div",{className:e,onPointerEnter:this.props.onPointerEnter,onPointerLeave:this.props.onPointerLeave,onPointerDown:this.props.onPointerDown,onPointerUp:this.props.onPointerUp,dangerouslySetInnerHTML:this.props.isFolder?{__html:Ts.feS}:{__html:Ts.lrx}})}}const c2=d2;var h2,p2=n(30460),u2=n(34155);function g2(e,t,n,s){h2||(h2="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:h2,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const m2=[$.kBookmarksBarVisible],v2=Object.freeze({bookmarkbar:!1,description:"",id:"",nickname:"",partner:"",themeColor:"",speeddial:!1,thumbnail:"",title:"",trash:!1});var f2=g2("input",{type:"submit",hidden:!0});class y2 extends hs.Component{static contextType=xi.Z;refTitle=hs.createRef();refUrlField=hs.createRef();_isCreating=!1;_isMounted=!1;_disableSaveOnBlur=!1;_id=crypto.randomUUID();_pageContext={};state={item:v2,unmodifiedItem:v2,typedUrl:void 0};componentDidMount(){this._isMounted=!0,yy.addListener(this._onUrlFieldStoreChanged,(e=>e.get(this._id))),ps.ZP.addListener(this.onBookmarkStoreChange)}componentWillUnmount(){yy.removeListener(this._onUrlFieldStoreChanged),ps.ZP.removeListener(this.onBookmarkStoreChange),this._save(),u2.nextTick((()=>{py.Z.reset(this._id)})),hr.unlinkBookmarkComponent(this),this._isMounted=!1}setIsCreating=e=>{this._isCreating=e};getIsCreating=()=>this._isCreating;_onUrlFieldStoreChanged=()=>{const{autocompleteValue:e,typedUrl:t}=yy.getUrlfieldState(this._id);this.setState((n=>({typedUrl:t,item:{...n.item,url:e||t||n.unmodifiedItem.url}})))};onSubmit=()=>{this._save(),this.props.onFocusTree()};_save=async()=>{const{item:e,unmodifiedItem:t}=this.state;if(e===t||ps.ZP.isTrashed(e)||ps.ZP.isSeparator(e)||""===e.id)return;const n=Ds.ZP.verifyForUpdate({title:e.title,url:e.url,nickname:e.nickname,description:e.description,speeddial:e.speeddial},ps.ZP.isFolder(e));return s.Z.bookmarks.update(e.id,n)};_saveOnBlur=()=>{!1===this._disableSaveOnBlur&&this._save().then(this.setIsCreating(!1))};_updateStateWithItem=e=>{const t=e.id===this.state.item.id;return new Promise((n=>{this.setState((n=>{if(!t||e.id===n.item.id)return{item:e,unmodifiedItem:e}}),n)}))};handleKeyPress=e=>{if(e.stopPropagation(),"Escape"===e.key){e.preventDefault(),py.Z.reset(this._id);const t=this.state.item.id;if(!t)return;if(this.getIsCreating())this.setIsCreating(!1),this._updateStateWithItem(v2).then(this.props.onCancel(t,!0));else{const e=ps.ZP.getItemById(t);e?this._updateStateWithItem(e).then((()=>this.props.onCancel(t,!1))):this.props.onCancel(t,!1)}}};focusUrlField=()=>{this.refUrlField.current&&(0,cy.x0)(this.context,this._id)};focusTitleField=()=>{this.refTitle.current&&this.refTitle.current.focus()};handleFocus=e=>{this.props.updateLayout&&this.props.updateLayout();const{HTMLInputElement:t}=this.context;e.target instanceof t&&e.target.select()};handleUpdateThumbnail=e=>{if(e.stopPropagation(),ps.ZP.isFolder(this.state.item))return void s.Z.bookmarks.update(this.state.item.id,{thumbnail:""});const t=Ds.ZP.verifyForUpdate({url:this.state.item.url},!1);t.url&&hr.updateForBookmark(this.state.item.id,t.url)};onBookmarkStoreChange=()=>{const{item:e}=this.state;if(""!==e.id){const t=ps.ZP.getItemById(e.id);t&&t.id===e.id&&this._updateStateWithItem(t)}};handleSetCustomThumbnail=e=>{e&&"function"==typeof e.stopPropagation&&e.stopPropagation(),C.Z.utilities.selectLocalImage({windowId:this.context.vivaldiWindowId,title:(0,Oe.Z)("Select Custom Image"),thumbnailBookmarkId:this.state.item.id})};checkChangeSpeeddial=()=>{this.setState((e=>({item:{...e.item,speeddial:!e.item.speeddial}})),(()=>{this._save()}))};isBookmarkBarChecked=()=>ps.ZP.getBookmarkBarFolderId()===this.state.item.id&&this.props.prefValues[$.kBookmarksBarVisible];checkChangeBookmarkBar=()=>{g.Z.setBookmarkBarFolderAndToggleVisibility(this.state.item.id)};onInputChange=(e,t)=>{this.setState((n=>({item:{...n.item,[e]:t.target.value}})))};setItem=e=>{this._save().then((()=>{if(this._isMounted){const e=this.props.getSelectedItem();this._setItem(e??v2)}}))};_setItem=e=>(py.Z.reset(this._id),this._updateStateWithItem(e).then((()=>{this.getIsCreating()&&(this._disableSaveOnBlur=!0,ps.ZP.isFolder(this.state.item)?this.focusTitleField():ps.ZP.isTrashed(this.state.item)||this.focusUrlField(),this._disableSaveOnBlur=!1)})));render(){const{item:e,unmodifiedItem:t}=this.state,n=ps.ZP.isFolder(e),s=hr.linkAndQueryUpdatingBookmark(this,this.state.item.id),i=N()(e.dateAdded).format("LLL"),o=!e.id||ps.ZP.isSeparator(e)||ps.ZP.isTrashed(e)||function(e){return e.id===ps.wz}(e);return g2("div",{className:"manager-editor",onKeyDown:this.handleKeyPress},void 0,g2("form",{className:"addbookmark-cardwrapper cardview",onSubmit:this.onSubmit},void 0,g2("div",{className:"upper-half"},void 0,g2("div",{className:"title-and-address"},void 0,g2("div",{className:"fieldset"},void 0,(0,fs.jsx)("input",{className:"cardview title",ref:this.refTitle,placeholder:(0,Oe.Z)("Title"),onChange:this.onInputChange.bind(this,"title"),value:e.title,disabled:o,type:"text",onFocus:this.handleFocus,onBlur:this._saveOnBlur})),g2("div",{className:n?"fieldset collapse":"fieldset"},void 0,(0,fs.jsx)(pw,{ref:this.refUrlField,pageId:this._id,pageContext:this._pageContext,autocompletionEnabled:!0,typedHistoryEnabled:!1,autoFocus:!1,className:"cardview address",disabled:o||n,displayUrl:t.url===p2.p?"":t.url??"",typedUrl:this.state.typedUrl,handleDrop:!0,onBlur:this._saveOnBlur,onFocus:this.handleFocus,onKeyPress:this.handleKeyPress,placeholder:(0,Oe.Z)("Address"),title:e.url??(0,Oe.Z)("Enter webpage address"),inputId:this._id,urlFragments:null})),g2("div",{className:"fieldset"},void 0,g2("input",{className:"cardview nickname",placeholder:(0,Oe.Z)("Nickname"),value:e.nickname,onChange:this.onInputChange.bind(this,"nickname"),type:"text",disabled:o,onFocus:this.handleFocus,onBlur:this._saveOnBlur}))),g2("div",{className:"preview"},void 0,g2(c2,{isFolder:n,src:e.thumbnail,backgroundColor:this.state.item.themeColor||void 0,title:this.state.item.title?this.state.item.title:this.state.item.url?C.Z.utilities.urlToThumbnailText(this.state.item.url):""},e.id),!o&&g2("div",{className:"thumb-controls"},void 0,g2("button",{type:"button",tabIndex:"-1",className:As()({circular:!0,"update-thumbnail":!0,updating:s}),title:(0,Oe.Z)("Update thumbnail"),onClick:this.handleUpdateThumbnail,dangerouslySetInnerHTML:{__html:Ts.GO5.medium}}),g2("button",{type:"button",tabIndex:"-1",onClick:this.handleSetCustomThumbnail,className:As()({circular:!0,"set-custom-thumbnail":!0}),title:(0,Oe.Z)("Select custom thumbnail"),dangerouslySetInnerHTML:{__html:Ts.md4.medium}})))),g2("div",{className:"lower-half"},void 0,g2("div",{className:"fieldset resizable"},void 0,g2("textarea",{className:"description",placeholder:(0,Oe.Z)("Description"),value:e.description,onChange:this.onInputChange.bind(this,"description"),type:"text",disabled:o,onFocus:this.handleFocus,onBlur:this._saveOnBlur})),g2("div",{className:"speeddial-bookmarksbar"},void 0,g2("div",{className:n?"fieldset center cardview":"fieldset center collapse"},void 0,g2("label",{},void 0,g2("input",{className:"cardview",disabled:o||!n,checked:e.speeddial,onChange:this.checkChangeSpeeddial,onFocus:this.handleFocus,type:"checkbox"}),g2("span",{},void 0,(0,Oe.Z)("Speed Dial")))),g2("div",{className:n?"fieldset center cardview":"fieldset center collapse"},void 0,g2("label",{},void 0,g2("input",{className:"cardview",disabled:o||!n,checked:this.isBookmarkBarChecked(),onChange:this.checkChangeBookmarkBar,onFocus:this.handleFocus,type:"checkbox"}),g2("span",{},void 0,(0,Oe.Z)("Bookmark Bar"))))),e.dateAdded&&g2("div",{className:"fieldset"},void 0,g2("div",{className:"meta-icon date fieldset",dangerouslySetInnerHTML:{__html:Ts.V_c}}),g2("span",{className:"dateCreated bookmark",title:(0,Oe.Z)("Date created")},void 0,i))),f2))}}const C2=sa(y2,m2);var w2,b2=n(34155);function S2(e,t,n,s){w2||(w2="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:w2,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function I2(e){return!!e&&ps.ZP.isTrashed(e)}function k2(e){return!e.trash&&!M2(e)}function A2(e){return!I2(e)}function T2(e,t){const n=O2(t)?t.title:je.jk.getHoverUrl(ps.ZP.getUrlByNode(t));c.Z.setStatus(e,n)}function Z2(e){c.Z.clearStatus(e)}function E2(e,t){t.button===Hi.Z.kCenter&&(t.preventDefault(),t.stopPropagation())}function _2(e){return e&&Boolean(e.trash)}function M2(e){return e&&e.id===ps.wz}function N2(e,t){s.Z.bookmarks.update(e,{title:t})}function P2(e){return Boolean(e.speeddial)}function D2(e){return!_2(e)&&!M2(e)}function x2(e){return!!e.children&&e.children.length>0}function O2(e){return!(!e||!e.children&&e.url)}function L2(e){const{columns:t,level:n,isExpanded:s,node:i}=e,{onExpandClick:o,inManager:a,fullView:r,windowId:l}=e,d=ps.ZP.isSeparator(i),c=(n+1)*mo+"px";if(d){const e=t?t.findIndex((e=>"title"===e.id)):0,n=a&&0===e||!a?c:0;return S2("label",{"data-parent":i.parentId},"0",S2("hr",{style:{marginLeft:n},className:"separator"}))}return r?t.map((t=>{switch(t.id){case"title":return S2(bo,{node:i,inlineEditText:e.inlineEditText,onExpandClick:o,inManager:a,fullView:r,isExpanded:e.isExpanded,level:n,onChange:e.onChange,onBlur:e.onBlur,onFocus:e.onFocus,showBadge:e.showBadge,onMouseEnter:()=>T2(l,i),onMouseLeave:()=>Z2(l)},i.id);case"url":const s=(0,gy.dO)(ps.ZP.getUrlByNode(i));return S2("label",{},t.id,x2(i)&&r?S2("span",{className:"secondary"},void 0,(0,Oe.Z)("$1 item","$1 items",[i.children.length])):S2(WC,{windowId:l,urlFragments:s,displayUrl:i.url,shouldShowFullUrl:!0,onGoToPath:Aa.Z,onBaseDomainObscured:Aa.Z,shouldHighlightBaseDomain:!1,rawDisplay:!0}));case"nickname":return S2("label",{},t.id,S2("span",{},void 0,i.nickname));case"description":return S2("label",{},t.id,S2("span",{},void 0,i.description));case"dateAdded":return S2("label",{className:"right-aligned"},t.id,S2("span",{},void 0,N()(i.dateAdded).format("ll")))}})):S2(bo,{node:i,inlineEditText:e.inlineEditText,onExpandClick:o,inManager:a,fullView:r,isExpanded:s,level:n,onChange:e.onChange,onBlur:e.onBlur,onFocus:e.onFocus,showBadge:e.showBadge,onMouseEnter:()=>T2(l,i),onMouseLeave:()=>Z2(l)},i.id)}class R2 extends hs.PureComponent{refTreeList=hs.createRef();static contextType=xi.Z;winId=this.context.vivaldiWindowId;state={nodes:[],cutIds:[],showBadge:H.Z.get($.kPanelsShowFolderBadge)};_isMounted=!1;_hasSeenSelection=!1;expandModel={};componentDidMount(){this._isMounted=!0,ps.ZP.addListener(this._onStoreChange),H.Z.addListener($.kPanelsShowFolderBadge,this._onBadgeChanged),this.onFilterChange(this.props.filter,this._monitorInitialSelection)}componentDidUpdate(e,t){if(this.props.filter!==e.filter){const t=this.props.filter.length,n=e.filter.length;0===n&&t>0&&this.refTreeList.current&&(this.expandModel=this.refTreeList.current.getExpandModel()),this.onFilterChange(this.props.filter,(e=>{t>0?b2.nextTick((()=>{this.refTreeList.current?.expandAllExcept(e)})):n>0&&0===t&&b2.nextTick((()=>{this.refTreeList.current?.expandWithModel(this.expandModel)}))}))}0!==this.state.nodes.length&&t.nodes!==this.state.nodes&&b2.nextTick((()=>{this.onBookmarksUpdatedIsEmpty()}))}componentWillUnmount(){H.Z.removeListener($.kPanelsShowFolderBadge,this._onBadgeChanged),ps.ZP.removeListener(this._onStoreChange),this._isMounted=!1}_onStoreChange=()=>{this.onFilterChange(this.props.filter,this._monitorInitialSelection)};onBookmarksUpdatedIsEmpty=()=>{if(this.props.onBookmarksUpdatedIsEmpty&&0===this.props.filter.length){const e=!this.state.nodes||this.state.nodes.every((e=>(_2(e)||M2(e))&&0===e.children?.length));this.props.onBookmarksUpdatedIsEmpty(!e)}};onFilterChange=(e,t)=>{if(e&&e.length>0){const n={bookmarks:!0,folders:!0};if("tree"===this.refTreeList.current?.getSearchStyle()){const s=ps.ZP.getFilteredTree(e,n);this.setState({nodes:s.nodes,cutIds:ps.ZP.getCutIds()},t?.(s.collapsed))}else{const s=ps.ZP.getFilteredFlat(e,n);this.setState({nodes:s,cutIds:ps.ZP.getCutIds()},t?.([]))}}else this.setState({nodes:ps.ZP.getTopNodes(),cutIds:ps.ZP.getCutIds()},t?.([]))};_monitorInitialSelection=()=>{this._hasSeenSelection||b2.nextTick((()=>{if(this._isMounted){const e=this.refTreeList.current?.getSelectedItem();e&&(this._hasSeenSelection=!0,this.props.onSelect(e))}}))};_onBadgeChanged=(e,t)=>{this.setState({showBadge:Boolean(t)})};deleteSelectedItems=()=>this.refTreeList.current?.onDelete();expandAll=()=>{this.refTreeList.current?.expandAll()};collapseAll=()=>{this.refTreeList.current?.collapseAll()};setSearchStyle=e=>{this.refTreeList.current?.setSearchStyle(e)};onSearchStyleChanged=e=>{this.props.filter&&this.onFilterChange(this.props.filter,(t=>{"tree"===e&&b2.nextTick((()=>{this.refTreeList.current?.expandAllExcept(t)}))}))};scrollToId=e=>{this.refTreeList.current?.scrollToId(e)};getTargetSpec=(e,t)=>{const n={...Ds.ZP.getEmptyNode(),id:e.id,index:0,parentId:void 0};if((_2(e)||M2(e))&&"on"!==t){const e=ps.ZP.getLastTopNode();e?(n.parentId=e.parentId,n.index=(e.index||0)+1):n.parentId=ps.ZP.getRootNode().id}else if(O2(e)&&"on"===t)n.parentId=e.id;else{Boolean(this.refTreeList.current?.isExpanded(e.id))&&"below"===t?n.parentId=e.id:(n.parentId=e.parentId,n.index=(e.index||0)+("below"===t?1:0))}return n};onDrop=(e,t,n)=>{const s=this.getTargetSpec(t,n),i=s.parentId,o=s.index;return void 0===i||void 0===o?Promise.resolve([]):Ds.ZP.getUrlsFromEventPromise(e,!0).then((e=>{const t=e.map((e=>({...Ds.ZP.getEmptyNode(),url:e.url,title:e.title})));return this.onCreate(t,i,o,!1)}))};onAdd=e=>{const t={title:e?(0,Oe.Z)("title","New Folder"):void 0};this.refTreeList.current?.onAdd(e?"folder":"item",t)};bookmarkActivePage=async e=>{const t=ie.ZP.getActivePage(this.context.vivaldiWindowId);if(t){const n=this.refTreeList.current?.getParentAndIndex(e,!0);if(void 0!==n?.parentId){const e=await g.Z.bookmarkPages(t,!1,n.parentId,n.index);"string"==typeof e&&this.refTreeList.current?.selectById(e)}}};bookmarkAllOpenPages=async e=>{const t=this.refTreeList.current?.getParentAndIndex(e,!0);if(void 0!==t?.parentId){const e=await g.Z.bookmarkAllOpenPages(this.winId,t.parentId,t.index);"string"==typeof e&&this.refTreeList.current?.selectById(e)}};onRootPasteContextMenu=e=>{const{document:t}=this.context;t.addEventListener("paste",this.onRootPaste),t.execCommand("paste"),t.removeEventListener("paste",this.onRootPaste)};onRootPaste=e=>{g.Z.paste(e,ps.ZP.getRootNode().id,!0)};getSelectedBookmarks=()=>(this.refTreeList.current?.getAllSelectedItems()||[]).map((e=>Ds.ZP.getBookmarksByNode(e))).flat();getSelectedItem=()=>this.refTreeList.current?.getSelectedItem();_onNodesActivated=(e,t)=>{const n=this.context.vivaldiWindowId,s=(0,nl.Z)(n,{button:e.button,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey}),i=t.map((e=>Ds.ZP.getBookmarksByNode(e))).flat();Ds.ZP.open(n,i,s,!0)};_openInNewTab=e=>{const t={inCurrent:!1,inBackground:e||H.Z.get($.kTabsOpenNewInBackground),inNewWindow:!1,allowOverride:!1,incognito:!1};Ds.ZP.open(this.context.vivaldiWindowId,this.getSelectedBookmarks(),t,!0)};_openInNewWindow=(e,t)=>{const n={inCurrent:!1,inBackground:!1,inNewWindow:!0,allowOverride:!1,incognito:e};Ds.ZP.open(this.context.vivaldiWindowId,t,n,!0)};_openBookmark=()=>{Ds.ZP.open(this.context.vivaldiWindowId,this.getSelectedBookmarks(),{inCurrent:!0,inBackground:!1,inNewWindow:!1,allowOverride:!1,incognito:!1},!0)};_supportSingleClick=()=>H.Z.get($.kBookmarksSingleClickOpens)&&!this.props.inManager;getMenuCapability=async(e,t,n)=>{const i=this.winId,o=Boolean(n)&&!_2(n)&&!M2(n)&&!ps.ZP.isSeparator(n);switch(e.action){case"CONTEXT_OPEN_IN_NEW_TAB":return{handler:()=>this._openInNewTab(!1),isVisible:()=>o,...t(i,e,{})};case"CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB":return{handler:()=>this._openInNewTab(!0),isVisible:()=>o&&!H.Z.get($.kTabsOpenNewInBackground),...t(i,e,{})};case"CONTEXT_OPEN_IN_TAB":return{handler:this._openBookmark,isVisible:()=>o,...t(i,e,{})};case"CONTEXT_OPEN_IN_NEW_WINDOW":return{handler:()=>this._openInNewWindow(!1,this.getSelectedBookmarks()),isVisible:()=>o,...t(i,e,{})};case"CONTEXT_OPEN_IN_PRIVATE_WINDOW":return{handler:()=>this._openInNewWindow(!0,this.getSelectedBookmarks()),isVisible:()=>o,...t(i,e,{})};case"CONTEXT_CONTAINER_OPEN_IN_WINDOW":{const n=Ds.ZP.getUrlsByNodes(this.refTreeList.current?.getAllSelectedItems()||[]),s=await Kr.getMenu(i,!0,n);return{isVisible:()=>o&&s.length>0,items:s,...t(i,e,{})}}case"CONTEXT_SET_SPEEDDIAL":return{handler:()=>{g.Z.toggleSpeeddialFolder(n.id)},isVisible:()=>Boolean(n)&&!I2(n)&&!M2(n)&&!P2(n)&&O2(n)&&ps.ZP.validateForEdit(n.id),...t(i,e,{})};case"CONTEXT_UNSET_SPEEDDIAL":return{handler:()=>{g.Z.toggleSpeeddialFolder(n.id)},isVisible:()=>Boolean(n)&&!I2(n)&&!M2(n)&&P2(n)&&O2(n)&&ps.ZP.validateForEdit(n.id),...t(i,e,{})};case"CONTEXT_SET_BOOKMARK_BAR":{const s=Boolean(n)&&H.Z.get($.kBookmarksBarVisible)&&ps.ZP.getBookmarkBarFolderId()===n.id;return{handler:n?()=>g.Z.setBookmarkBarFolderAndToggleVisibility(n.id):()=>g.Z.setBookmarkBarFolderAndShow(ps.ZP.getRootId()),isVisible:()=>!n||O2(n)&&!s&&!_2(n)&&!M2(n),...t(i,e,{})}}case"CONTEXT_UNSET_BOOKMARK_BAR":{const s=Boolean(n)&&H.Z.get($.kBookmarksBarVisible)&&ps.ZP.getBookmarkBarFolderId()===n.id;return{handler:()=>g.Z.setBookmarkBarFolderAndToggleVisibility(n.id),isVisible:()=>s,...t(i,e,{})}}case"CONTEXT_MOVE_TO_BOOKMARK_BAR":return{handler:()=>async function(e){const t=ps.ZP.getBookmarkBarFolderId(),n=ps.ZP.getItemById(t);if(!n||ps.ZP.isDescendantOf(n,e))return;const i=ps.ZP.getItemById(e);i&&i.parentId!==t&&await s.Z.bookmarks.move(e,{parentId:t})}(n.id),isVisible:()=>Boolean(n)&&!_2(n)&&!M2(n),...t(i,e,{})};case"CONTEXT_BOOKMARK":return{handler:n?()=>this.bookmarkActivePage(n):()=>this.bookmarkActivePage(ps.ZP.getRootNode()),isVisible:()=>!_2(n),...t(i,e,{})};case"CONTEXT_BOOKMARK_ALL":return Promise.resolve({handler:n?()=>this.bookmarkAllOpenPages(n):()=>this.bookmarkAllOpenPages(ps.ZP.getRootNode()),isVisible:()=>!_2(n),...t(i,e,{})});case"CONTEXT_EMPTY_TRASH":return{handler:()=>{g.Z.emptyTrash()},isVisible:()=>Boolean(n)&&_2(n),...t(i,e,{})};default:return{...t(i,e,{})}}};getMenuVisibility=(e,t)=>{if(t)if(_2(t))switch(e.action){case"CONTEXT_IMPORT":case"CONTEXT_CONTAINER_SEARCH":return!0;default:return!1}else switch(e.action){case"CONTEXT_NEW_ITEM":case"CONTEXT_NEW_FOLDER":case"CONTEXT_PASTE":case"CONTEXT_EXPAND_ALL":case"CONTEXT_COLLAPSE_ALL":case"CONTEXT_IMPORT":case"CONTEXT_CONTAINER_SEARCH":return!0;case"CONTEXT_NEW_SEPARATOR":return this.props.sorting.sortOrder===Xi.Z.NO_SORTING;case"CONTEXT_RENAME":return ps.ZP.validateForEdit(t.id);case"CONTEXT_CUT":case"CONTEXT_COPY":return!ps.ZP.isSeparator(t)&&!M2(t);case"CONTEXT_DELETE":return!M2(t);default:return!1}else switch(e.action){case"CONTEXT_NEW_ITEM":case"CONTEXT_NEW_FOLDER":case"CONTEXT_PASTE":case"CONTEXT_EXPAND_ALL":case"CONTEXT_COLLAPSE_ALL":case"CONTEXT_IMPORT":case"CONTEXT_CONTAINER_SEARCH":return!0;case"CONTEXT_NEW_SEPARATOR":return this.props.sorting.sortOrder===Xi.Z.NO_SORTING;default:return!1}};onContextMenu=e=>{this.refTreeList.current?.onContextMenu(e)};getDropSupport=(e,t)=>{const n=t.dataTransfer.types.some((e=>Ds.ZP.isUriListType(e)||"text/plain"===e||e===Ds.yR));return{available:n,onto:n&&O2(e),edge:"both"}};handleExpandClick=(e,t)=>{this.refTreeList.current?.toggleSelectedExpansion(e,t)};onItemClick=(e,t)=>{e.button!==Hi.Z.kCenter&&this._supportSingleClick()&&!O2(t)&&void 0===this.refTreeList.current?.getInlineEditId()&&this.openWithEventModifiers(e)};onItemDoubleClick=(e,t)=>{e.button===Hi.Z.kCenter||this._supportSingleClick()||O2(t)||this.openWithEventModifiers(e)};onItemMouseUp=(e,t)=>{t.button===Hi.Z.kCenter&&(this._openInNewTab(!0),t.preventDefault(),t.stopPropagation())};openWithEventModifiers=e=>{const t=this.context.vivaldiWindowId,n=(0,nl.Z)(t,{button:e.button,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey});Ds.ZP.open(t,this.getSelectedBookmarks(),n,!0)};getRowComponentProps=e=>({...e,childCount:e.node.children?e.node.children.length:0,columns:this.props.columns||[],showBadge:this.state.showBadge,windowId:this.context.vivaldiWindowId});unSelectAll=()=>{this.refTreeList.current?.unSelectAll()};onSelect=async e=>{if(e){const t=ps.ZP.getItemById(e.id);t&&this.props.onSelect(t)}else this.props.onSelect()};onCreate=async(e,t,n,s)=>{const i=await g.Z.createWithPromise(e,t??"",n??0),o=1===i.length&&ps.ZP.isSeparator(Ds.ZP.convertToPrivateType(i[0]));return this.props.onCreate(!o&&s),i};onMove=(e,t)=>{const{parentId:n="",index:s}=t;return g.Z.move(e,n,s)};handleCut(e,t){const n=t.filter(k2).map((e=>e.id));g.Z.cut(e,n)}handleCopy(e,t){const n=t.filter(k2).map((e=>e.id));g.Z.copy(e,n)}menu={name:"bookmarklist",getCapability:this.getMenuCapability,getVisibility:this.getMenuVisibility};render(){return(0,fs.jsx)(yo,{ref:this.refTreeList,rowComponent:e=>(0,fs.jsx)(L2,{...e,onExpandClick:(e,t)=>this.handleExpandClick(e,t),inManager:this.props.inManager,fullView:this.props.fullView}),getRowComponentProps:this.getRowComponentProps,nodes:this.state.nodes,cutIds:this.state.cutIds,onSelect:this.onSelect,onItemClick:this.onItemClick,onItemDoubleClick:this.onItemDoubleClick,onItemMouseDown:E2,onItemMouseUp:this.onItemMouseUp,onItemsActivated:this._onNodesActivated,onCreate:this.onCreate,onSearchStyleChanged:this.onSearchStyleChanged,delete:g.Z.remove,onMove:this.onMove,onEdit:this.props.onEdit,onCut:this.handleCut,onCopy:this.handleCopy,onImport:()=>Ae.Z.showImportDataDialog(this.context.vivaldiWindowId),isFolder:O2,isSeparator:ps.ZP.isSeparator,supportsInlineEdit:!0,menu:this.menu,mimeType:Ds.yR,getDropSupport:this.getDropSupport,getDragData:ps.ZP.getDragData.bind(ps.ZP),hasChildren:x2,settings:this.props.inManager?"BOOKMARKS_MANAGER":"BOOKMARKS_PANEL",multiSelect:!this._supportSingleClick(),setCutIds:g.Z.setCutIds,getTitle:ps.ZP.getTitle,saveTitle:N2,getTargetSpec:this.getTargetSpec,sorting:this.props.sorting,onDrop:this.onDrop,rootId:ps.ZP.getRootId(),isValidAddTarget:A2,isValidDragSource:D2,isValidToEdit:ps.ZP.validateForEdit,validateForDrag:ps.ZP.validateForDrag,validateForDeletion:ps.ZP.validateForDeletion,columns:this.props.columns})}}const B2=R2;var F2;function V2(e,t,n,s){F2||(F2="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:F2,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const W2=[{text:(0,Oe.Z)("Title"),value:"title",fullScreenTitle:(0,Oe.Z)("Sort by title"),width:300,visible:!0,key:!0},{text:(0,Oe.Z)("Address"),value:"url",icon:Ts.iD7,fullScreenTitle:(0,Oe.Z)("Sort by address"),width:300,visible:!0},{text:(0,Oe.Z)("Nickname"),value:"nickname",icon:Ts.vvh.small,fullScreenTitle:(0,Oe.Z)("Sort by nickname"),width:100,visible:!0},{text:(0,Oe.Z)("Description"),value:"description",icon:Ts.sWI,fullScreenTitle:(0,Oe.Z)("Sort by description"),width:200,visible:!0},{text:(0,Oe.Z)("Date Created"),value:"dateAdded",icon:Ts.V_c,fullScreenTitle:(0,Oe.Z)("Sort by creation date"),width:150,visible:!1}];class U2 extends hs.PureComponent{static contextType=xi.Z;refEditor=hs.createRef();refTree=hs.createRef();state={filter:"",sorting:{sortOrder:Xi.Z.NO_SORTING,sortField:"manually",comparator:this.sortComparator},columns:io().bookmarks||oo(W2)};componentDidMount(){const e=H.Z.get($.kBookmarksManagerSorting);this.onSortChange(e.sortOrder,e.sortField)}onSortChange=(e,t)=>{const n={sortOrder:e,sortField:t,comparator:this.sortComparator};this.setState({sorting:n});const s={sortOrder:e,sortField:t};Ne.Z.set($.kBookmarksManagerSorting,s)};sortComparator=(e,t)=>ps.ZP.treeSortComparator(e,t,this.state.sorting);importData=()=>{Ae.Z.showImportDataDialog(this.context.vivaldiWindowId)};focusTree=()=>{this.refTree.current?.refTreeList.current?.focusTree()};onSelect=e=>{this.refEditor.current?.setItem(e)};onCreate=e=>{e&&this.refEditor.current?.setIsCreating(!0)};onEditorCanceled=(e,t)=>{const n=this.refTree.current;n&&t&&e?n.deleteSelectedItems()?.then((()=>{s.Z.bookmarks.remove(e),this.focusTree()})):this.focusTree()};onUpdateRow=e=>{this.setState({columns:e})};onSaveRow=()=>{so(this.state.columns,"bookmarks")};getSelectedItem=()=>this.refTree.current?.getSelectedItem();deleteItem=()=>{this.refTree.current?.deleteSelectedItems()};_updateThumbnails=()=>{const e=[],t=this.refTree.current?.getSelectedBookmarks();if(t)for(const n of ps.ZP.iterateTrees(t,!0))n.url&&e.push({id:n.id,url:n.url});hr.updateForBookmarks(e)};onSearchChange=e=>{this.setState({filter:e.target.value})};createBookmark=()=>{this.refTree.current?.onAdd(!1)};createFolder=()=>{this.refTree.current?.onAdd(!0)};onContextMenu=e=>{e.nativeEvent.buttons>0&&this.refTree.current?.unSelectAll(),this.refTree.current?.onContextMenu(e)};render(){return V2("div",{className:"bookmark manager"},void 0,V2("div",{className:"toolbar toolbar-default"},void 0,V2("input",{value:this.state.filter,onChange:this.onSearchChange,type:"search",tabIndex:"0",placeholder:(0,Oe.Z)("verb","Search")}),V2("div",{className:"toolbar-group"},void 0,V2(Fa,{onClick:this.createBookmark,image:Ts.md4.small,tooltip:(0,Oe.Z)("New Bookmark")}),V2(Fa,{onClick:this.deleteItem,image:Ts.M2k.small,tooltip:(0,Oe.Z)("other","Delete")})),V2(Fa,{onClick:this.createFolder,image:Ts._TQ.small,title:(0,Oe.Z)("command","New Folder")}),V2("div",{className:"toolbar-group",style:{marginLeft:"auto"}},void 0,V2(Fa,{onClick:this.importData,image:Ts.feZ.small,title:(0,Oe.Z)("Import...")}),V2(Fa,{onClick:this._updateThumbnails,image:Ts.GO5.small,title:(0,Oe.Z)("Update Thumbnails")}))),V2("div",{className:"manager-content"},void 0,V2("div",{className:"manager-treeview"},void 0,V2(gv,{fields:W2,onSortChange:this.onSortChange,fullsize:!0,sortField:this.state.sorting.sortField,sortOrder:this.state.sorting.sortOrder,columns:this.state.columns,onUpdateRow:this.onUpdateRow,onSaveRow:this.onSaveRow,keyAccess:H.Z.get($.kKeyboardTabToAll)}),V2("div",{className:"vivaldi-tree-container",onContextMenu:this.onContextMenu},void 0,(0,fs.jsx)(B2,{filter:this.state.filter,ref:this.refTree,fullView:!0,inManager:!0,onEdit:this.onSelect,onSelect:this.onSelect,onCreate:this.onCreate,sorting:this.state.sorting,columns:this.state.columns}))),(0,fs.jsx)(C2,{ref:this.refEditor,getSelectedItem:this.getSelectedItem,onCancel:this.onEditorCanceled,onFocusTree:this.focusTree})))}}const H2=U2;var z2,G2=n(29940);function $2(e,t,n,s){z2||(z2="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:z2,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class K2 extends hs.Component{cache={};state={eventsToRender:[]};static contextType=nx;constructor(e){super(e),this.cache=new G2.t1({defaultHeight:50})}static getDerivedStateFromProps=(e,t)=>{const n=Bd.Z.getEvents()||[];return{eventsToRender:Rd.Z.searchEvents(n,e.filterText).reduce(((e,t)=>{const n=N()(t.start).format("ll"),s=e.findIndex((e=>e.title===n));return-1===s?e.push({title:n,events:[t]}):e[s].events.unshift(t),e}),[])}};componentDidUpdate(e,t){this.props.filterText!==e.filterText&&this.cache.clearAll()}selectEvent=e=>{const t=N()(e.start);Gx.Z.selectDate(this.context.pageId,t)};setSelectedIndex=e=>{const{selectedEvent:t}=this.props,{eventsToRender:n}=this.state,s=n.flatMap((e=>e.events));if(t){let n=s.findIndex((e=>e.id===t));"Up"===e?n=Math.max(0,n-1):"Down"===e&&(n=Math.min(s.length-1,n+1)),Gx.Z.selectEvent(this.context.pageId,{event:s[n]})}else Gx.Z.selectEvent(this.context.pageId,{event:s[0]})};onKeyDown=e=>{switch(HT.Z[e.keyCode]){case"Up":case"Down":this.setSelectedIndex(HT.Z[e.keyCode])}};renderDay=({index:e,parent:t,key:n,style:s})=>{const{eventsToRender:i}=this.state;if(0===i.length)return;const o=i[e],a=o.events.map(((e,t)=>this.renderEvent(e))),{title:r}=o;return $2(G2.Z8,{cache:this.cache,parent:t,columnIndex:0,rowIndex:e},n,$2("div",{className:"cal-tasks-row",style:s},void 0,$2("div",{className:"cal-tasks-row-date"},void 0,r),$2("div",{className:As()("cal-tasks-row-events")},void 0,a)))};eventClick=e=>{this.props.onSelectEvent(e.id)};renderEvent=e=>{const t=Rd.Z.isMultiDayEvent(e),{selectedEvent:n}=this.props,s=n===e.id,i=!!this.props.editingEvent&&this.props.editingEvent.id===e.id,o=Rd.Z.isRecurringEvent(e),a=Boolean(this.props.filterText);let r;if(o){const t=e.rrule&&(0,KT.Qj)(e.rrule,e.start,e.timezone);if(t){const e=QT(t),n=(0,KT.qh)(t,new Date,N()().add(1,"y").toDate(),3).map((e=>N()(e).format("LL")));r=`${(0,Oe.Z)("Next occurrences:")}\n          ${n.join(", ")}. ${e}.`}}return $2("div",{onClick:this.eventClick.bind(null,e),className:"event-container"},e.id,$2(NO,{event:e,displayStyle:"transparent",isSelected:s,isEditing:i,isMultiDay:t,isFiltering:a}),r&&$2("div",{},void 0,r))};render(){const{eventsToRender:e}=this.state,t=e.reduce(((e,t)=>e+t.events.length),0);return $2("div",{className:"manager-content"},void 0,$2("div",{className:"calendar-viewport",onFocus:this.props.onFocus},void 0,$2("style",{},void 0,Rd.Z.getCalendarColors()),$2("div",{className:"search-results"},void 0,(0,Oe.Z)("$1 result for “$2”","$1 results for “$2”",[t,this.props.filterText]),$2("button",{onClick:this.props.onClose},void 0,$2("span",{dangerouslySetInnerHTML:{__html:Ts.vyJ}}))),$2("div",{className:"calendar-grid-agenda search-results-list",onKeyDown:this.onKeyDown},void 0,$2(QF.q,{},void 0,(({height:t,width:n})=>$2(lo.aV,{width:n,height:t,defferredMeasurementCache:this.cache,rowHeight:this.cache.rowHeight,rowRenderer:this.renderDay,rowCount:e.length}))))))}}const j2=K2;var Y2,X2=n(98035);function Q2(e,t,n,s){Y2||(Y2="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Y2,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class q2 extends hs.PureComponent{static contextType=nx;undeleteEvent=e=>{m.Z.restoreEvent(this.context.pageId,e)};undo=()=>{const{trashedEvents:e}=this.props;e.length>0&&this.undeleteEvent(e[0])};trimTitle=e=>(e.length>70&&(e=e.substring(0,70)+"..."),e);getContextMenuItems=()=>this.props.trashedEvents.sort(((e,t)=>(t.trash_time||0)-(e.trash_time||0))).map((e=>({mnemonic:!1,url:e.id,handler:this.undeleteEvent.bind(this,e),...ae.Z.makeLabelPair(e.title||"")}))).filter(Boolean).concat([ae.Z.separatorItem,{handler:this.clearAll,...(0,xs.Z)("other","Clear All")}]);clearAll=()=>{const{trashedEvents:e}=this.props;e.forEach((e=>{const{id:t,syncPending:n}=e;n?X2.Z.updateEvent({id:t,deletePending:!0}):m.Z.deleteEvent(t)}))};onDrop=e=>{const t=e.dataTransfer.getData(OO);if(t){e.preventDefault(),e.stopPropagation();const n=JSON.parse(t),{id:s}=n;m.Z.trashEvent(s)}};render(){return Q2(Fa,{className:"toggle-trash",onDrop:this.onDrop,onDragEnter:Aa.Z,disabled:0===this.props.trashedEvents.length,image:Ts.nre.small,onMiddleClick:this.undo,menu:this.getContextMenuItems,menuOrigin:"bottomLeft",mimeType:OO,edgeAmount:0,tooltip:(0,Oe.Z)("Trashed Events")})}}const J2=q2;var e5;function t5(e,t,n,s){e5||(e5="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:e5,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const n5=e=>{m.Z.toggleCalendarVisibility(e)},s5=e=>{const{key:t}=e;" "!==t&&"Enter"!==t||e.target.dispatchEvent(new Event("click",{bubbles:!0}))};var i5=t5("div",{className:"CalendarPicker-Separator"}),o5=t5("div",{className:"CalendarPicker-Separator"}),a5=t5("div",{className:"CalendarPicker-Separator"});const r5=function(e){const t=hs.useRef(),n=hs.useRef(),s=hs.useRef(),i=hs.useRef(!1),o=hs.useRef(),a=hs.useContext(xi.Z),{document:r}=a,[l,d]=hs.useState(!1);hs.useEffect((()=>(t.current&&t.current.focus(),()=>{o.current&&clearTimeout(o.current)})),[]);const c=e=>{m.Z.setDefaultCalendarId(e),t.current&&t.current.focus()},h=e=>{e.currentTarget.focus();const t=e.currentTarget.classList.contains("CalendarPicker-Item--Submenu")||e.currentTarget.closest(".CalendarPicker-Item--Submenu");t?l?o.current&&(o.current=clearTimeout(o.current)):d(!0):!t&&l&&(o.current=setTimeout((()=>{d(!1),o.current=null}),500))},p=e=>{t.current&&t.current.focus()},u=Rd.Z.getDefaultCalendar()?.id,g=i.current;i.current=!1;const{accounts:v,calendars:f}=e,y=[],C=[];let w=!1;return v.forEach((e=>{const t=f.filter((t=>t.accountId===e.id));y.push({account:e,calendars:t}),e.url&&t.length&&(w=!0),"ical"!==e.account_type&&C.push(...t)})),y.sort(((e,t)=>"local"===e.account.account_type?-1:"local"===t.account.account_type?1:0)),(0,fs.jsxs)("div",{className:"CalendarPicker",onKeyDown:e=>{const o=r.activeElement,{key:a}=e;if(o&&o.classList.contains("CalendarPicker-Item")){if(o){const e=((e,t)=>{const n=e.parentElement&&e.parentElement.children;return n&&n.length?[...n].filter((e=>e.classList.contains(t))):[]})(o,"CalendarPicker-Item"),n=e.indexOf(o);if(0===e.length||-1===n)return;if("ArrowDown"===a)e[(n+1)%e.length].focus();else if("ArrowUp"===a)e[(n-1+e.length)%e.length].focus();else if("ArrowLeft"===a){if(l&&t.current){const e=t.current.querySelector(".CalendarPicker-Item--Submenu");e&&e.focus(),d(!1)}}else if("ArrowRight"===a&&o.classList.contains("CalendarPicker-Item--Submenu"))if(l){const e=o.querySelectorAll(".CalendarPicker-Item");e.length&&e[0].focus()}else d(!0),i.current=!0}}else"ArrowUp"===a?s.current&&s.current.focus():"ArrowDown"===a&&(n.current?n.current.focus():s.current&&s.current.focus())},ref:t,tabIndex:0,children:[e.calendars.length>0&&(0,fs.jsxs)(fs.Fragment,{children:[y.map((e=>t5(hs.Fragment,{},e.account.id,y.length>1&&t5("h3",{className:"CalendarPicker-Account"},void 0,"local"===e.account.account_type?(0,Oe.Z)("Local Calendars"):e.account.name||e.account.url),!!e.calendars.length&&e.calendars.map(((e,t)=>{const s=Rd.Z.createCalendarIcon(e,16,!e.hidden);return(0,fs.jsxs)("button",{onMouseEnter:h,onMouseLeave:p,className:"CalendarPicker-Item",onClick:n5.bind(null,e.id),ref:0===t?n:null,children:[t5("span",{className:"CalendarPicker-Icon",dangerouslySetInnerHTML:{__html:s}}),t5("span",{className:As()("CalendarPicker-Title",{"CalendarPicker-Title--Default":e.id===u})},void 0,e.description||e.name)]},e.id)})),!e.calendars.length&&t5("div",{},void 0,t5("span",{className:"CalendarPicker-Title"},void 0,(0,Oe.Z)("No Calendars")))))),C.length>0&&(0,fs.jsxs)(fs.Fragment,{children:[i5,t5("div",{className:"CalendarPicker-Item CalendarPicker-Item--Submenu",onClick:()=>d(!l),onMouseEnter:h,onMouseLeave:p,onKeyUp:s5,tabIndex:0},void 0,t5("span",{className:"CalendarPicker-Title"},void 0,(0,Oe.Z)("Default Calendar")),t5("span",{className:"CalendarPicker-SubmenuIcon",dangerouslySetInnerHTML:{__html:Ts.nfH}}),l&&t5("div",{className:"CalendarPicker-Submenu"},void 0,C.map(((e,t)=>{const n=u===e.id,s=Rd.Z.createCalendarIcon(e,16,n);return t5("button",{className:"CalendarPicker-Item",onClick:c.bind(null,e.id),onMouseEnter:h,onMouseLeave:p,autoFocus:0===t&&g},e.id,t5("span",{className:"CalendarPicker-Icon",dangerouslySetInnerHTML:{__html:s}}),t5("span",{className:"CalendarPicker-Title"},void 0,e.description||e.name))}))))]}),o5]}),t5("button",{className:"CalendarPicker-Item",onClick:()=>{Ae.Z.showCreateCalendarDialog(a.vivaldiWindowId),e.requestClose&&e.requestClose()},onMouseEnter:h,onMouseLeave:p},void 0,t5("span",{className:"CalendarPicker-Icon",dangerouslySetInnerHTML:{__html:Ts.md4.medium}}),t5("span",{className:"CalendarPicker-Title"},void 0,(0,Oe.Z)("New Calendar"))),w&&(0,fs.jsxs)(fs.Fragment,{children:[t5("button",{className:"CalendarPicker-Item",onClick:async()=>{e.requestClose&&e.requestClose(),m.Z.pollAllCalDAVAccountsWithStatus()},onMouseEnter:h,onMouseLeave:p},void 0,t5("span",{className:"CalendarPicker-Icon",dangerouslySetInnerHTML:{__html:Ts.GO5.medium}}),t5("span",{className:"CalendarPicker-Title"},void 0,(0,Oe.Z)("Refresh"))),a5]}),(0,fs.jsxs)("button",{className:"CalendarPicker-Item",onClick:()=>{Ae.Z.showSettings(a.vivaldiWindowId,"calendar"),e.requestClose&&e.requestClose()},onMouseEnter:h,onMouseLeave:p,ref:s,children:[t5("span",{className:"CalendarPicker-Icon",dangerouslySetInnerHTML:{__html:Ts.bqs.medium}}),t5("span",{className:"CalendarPicker-Title"},void 0,(0,Oe.Z)("Calendar Settings"))]})]})};var l5;function d5(e,t,n,s){l5||(l5="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:l5,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const c5={width:"auto",minWidth:"unset"};const h5=function(e){const[t,n]=hs.useState(!1);return(0,fs.jsx)(fs.Fragment,{children:d5("div",{className:"toolbar-dropdown-container"},void 0,d5(Fa,{image:Ts.bcq.small,isPressed:t,onClick:()=>n(!t),popupPosition:"below",hidePopup:Aa.Z,title:(0,Oe.Z)("Calendars"),isMenuIndicatorVisible:!0,isMenuIndicatorDisabled:!0}),t&&d5(_r.Z,{style:c5,viewMode:"calendar-picker",onRequestClose:e=>{e&&e.target.addEventListener("click",to.ZP,{once:!0}),n(!1)}},void 0,d5(r5,{accounts:e.accounts,calendars:e.calendars,requestClose:()=>n(!1)})))})};var p5,u5=n(46884);function g5(e,t,n,s){p5||(p5="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:p5,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const{searchEvents:m5}=Rd.Z,v5={events:[],count:0,totalCount:0};var f5=g5("br",{});const y5=function(e){const t=hs.useContext(xi.Z),{document:n}=t,[s,i]=hs.useState(!1),[o,a]=hs.useState(v5),[r,l]=hs.useState(-1),d=hs.useRef(),c=hs.useRef();hs.useEffect((()=>{s&&d.current?.focus()}),[s]),hs.useEffect((()=>{function e(e){e===t.vivaldiWindowId&&(c.current?.focus(),i(!0))}return tl.Z.addListener("COMMAND_CALENDAR_SEARCH",e),()=>{tl.Z.removeListener("COMMAND_CALENDAR_SEARCH",e)}}),[t.vivaldiWindowId]);const h=t=>{g(),e.onSelectEvent(t)},p=()=>{g(),e.onShowSearchResults()},u=t=>{const n=Bd.Z.getEvents()||[];let s=m5(n,t||e.filterText);const i=s.length;return i>10&&(s=s.slice(0,10)),{events:s,count:s.length,totalCount:i}},g=()=>{i(!1),l(-1)},m=t=>{switch(HT.Z[t.keyCode]){case"Enter":a(u()),i(!0);break;case"Escape":e.onSearchChange(""),i(!1)}},v=hs.useRef(null),f=hs.useCallback((()=>g),[]),y=hs.useCallback((()=>v.current),[]);return(0,u5.Z)(y,f),(0,fs.jsxs)("div",{ref:v,className:"toolbar-group FilterAndSearch",children:[(0,fs.jsx)("input",{type:"search",className:"FilterAndSearch-Input no-page-focus",tabIndex:"0",ref:c,placeholder:(0,Oe.Z)("Filter and Search"),title:(0,Oe.Z)("Type to filter. Press enter or click button to search."),value:e.filterText,onChange:t=>{const{value:n}=t.target;e.onSearchChange(n),""===n&&g(),s&&a(u(n))},onKeyDown:m}),g5("input",{className:"FilterAndSearch-Button",type:"button",disabled:0===e.filterText.length,onClick:p,value:(0,Oe.Z)("verb","Search")}),s&&(0,fs.jsxs)("div",{className:"SearchDropdown",ref:d,tabIndex:"0",onFocus:e=>{e.target===d.current&&r<0&&l(0)},onKeyDown:e=>{switch(HT.Z[e.keyCode]){case"Space":case"Enter":r>=0&&r<o.count&&(h(o.events[r].id),e.stopPropagation());break;case"Escape":g(),c.current&&c.current.focus();break;case"Up":l((e=>Math.max(0,e-1)));break;case"Down":l((e=>Math.min(o.count-1,e+1)));break;case"Tab":n.activeElement===d.current&&(!e.shiftKey&&r<o.count-1?(l((e=>e+1)),e.preventDefault()):e.shiftKey&&r>0&&(l((e=>e-1)),e.preventDefault()))}},children:[0===o.count&&g5("div",{className:"SearchDropdown-NoItems"},void 0,(0,Oe.Z)("No events found")),o.count>0&&g5("ul",{},void 0,o.events.map(((t,n)=>{const s=Bd.Z.getCalendars(),{title:i,id:o}=t,{start:a,end:d}=(0,Bu.aE)(t),c=s.find((e=>e.id===t.calendarId)),p=c?Rd.Z.createCalendarIcon(c,9):"";return g5("li",{className:As()("SearchDropdown-Item",{"SearchDropdown-Item--Selected":r===n}),onKeyDown:m,onMouseUp:()=>h(o),onMouseOver:()=>l(n)},n,g5("div",{className:"SearchDropdown-ItemEvent"},void 0,g5("p",{className:"SearchDropdown-ItemEventTitle"},void 0,(0,Vl.CH)(i,e.filterText))),g5("div",{className:"SearchDropdown-ItemMetaData"},void 0,g5("div",{className:"SearchDropdown-ItemIcon"},void 0,g5("span",{dangerouslySetInnerHTML:{__html:p}})),g5("p",{className:"SearchDropdown-ItemEventCalendar"},void 0,!!c&&(c.description||c.name)),!!t.end&&g5("div",{className:"SearchDropdown-ItemDate"},void 0,function(e,t){if(e.valueOf()&&t.isAfter(e,"day"))return(0,Oe.Z)("$1 - $2 $3",[e.format(q.ZP.getShortDateFormat()),t.format(q.ZP.getShortDateFormat()),e.format("YYYY")]);const n=e.valueOf()?e:t;return(0,Oe.Z)("$1. $2",[n.format("ddd"),n.format("ll")])}(a,d),f5,!t.allDay&&function(e,t){return e.valueOf()?`${e.format("LT")}-${t.format("LT")}`:t.format("LT")}(a,d))))}))),o.count!==o.totalCount&&g5("div",{className:"SearchDropdown-MoreItems"},void 0,(0,Oe.Z)("More results, showing first $1 items out of $2 total.",[o.count,o.totalCount])),o.count>0&&g5("input",{className:"SearchDropdown-Button",type:"button",onClick:p,value:(0,Oe.Z)("Go to Search Results")})]})]})};var C5;function w5(e,t,n,s){C5||(C5="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:C5,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function b5(e){return"day"===e||"week"===e?"month":"year"}const S5=function(e){const{document:t,HTMLElement:n}=hs.useContext(xi.Z),s=hs.useRef(),i=hs.useRef(),o=hs.useRef(e.initialPeriod),a=(0,na.Z)([$.kKeyboardTabToAll]),[r,l]=hs.useState(e.mode),[d,c]=hs.useState((()=>e.initialPeriod.clone()));function h(){const e="year"===r?12:1,t=b5(r);c(d.clone().subtract(e,t))}function p(){const e="year"===r?12:1,t=b5(r);c(d.clone().add(e,t))}function u(t){e.setPeriod(t),e.requestClose()}function g(t){r===e.mode?u(t):(c(t),l(e.mode))}function m(e){const t=e.currentTarget;if(t instanceof n){const e=t.dataset.period;g("month"===r?d.clone().month(parseInt(e)):d.clone().year(parseInt(e)))}}function v(t){if("number"==typeof t.keyCode){const e=HT.Z[t.keyCode];if(t.repeat||"Space"!==e&&"Enter"!==e)return}t.stopPropagation(),t.preventDefault(),l(r===e.mode?b5(r):e.mode)}hs.useEffect((()=>(s.current=t.activeElement,i.current?.focus(),c(e.initialPeriod.clone()),l(e.mode),()=>{s.current?.focus()})),[t,e.initialPeriod,e.mode]);const f=d.year()-d.year()%12;let y="",C="",w="",b="";switch(r){case"year":C=(0,Oe.Z)("Previous Years"),w=(0,Oe.Z)("Next Years"),y=`${f} - ${f+11}`;break;case"month":C=(0,Oe.Z)("Previous Year"),w=(0,Oe.Z)("Next Year"),b="month"===e.mode?(0,Oe.Z)("Show Years"):(0,Oe.Z)("Show Month"),y=d.format("YYYY");break;case"week":case"day":C=(0,Oe.Z)("Previous Month"),w=(0,Oe.Z)("Next Month"),b=e.mode===r?(0,Oe.Z)("Show Year"):(0,Oe.Z)("Show Month"),y=d.format("MMMM YYYY")}let S="";if(d!==o.current){let e=!1;if("year"===r){Math.floor(o.current.year()/12)!==Math.floor(d.year()/12)&&(e=!0)}else{const t=b5(r);o.current.isSame(d,t)||(e=!0)}e&&(S=o.current.valueOf()<d.valueOf()?"DatePickerPopup-Contents--Increase":"DatePickerPopup-Contents--Decrease"),o.current=d}const I=d.get(b5(r));return(0,fs.jsxs)("div",{className:"DatePickerPopup",ref:i,onMouseDown:to.ZP,onClick:to.ZP,onKeyDown:function(t){let n;switch(HT.Z[t.keyCode]){case"Left":n=d.clone().subtract(1,r);break;case"Right":n=d.clone().add(1,r);break;case"Up":n="month"===r||"year"===r?d.clone().subtract(3,r):d.clone().subtract(1,"week");break;case"Down":n="month"===r||"year"===r?d.clone().add(3,r):d.clone().add(1,"week");break;case"PageUp":h(),(0,to.ZP)(t);break;case"PageDown":p(),(0,to.ZP)(t);break;case"Enter":if((0,to.ZP)(t),t.target!==t.currentTarget)return;g(d.clone());break;case"Escape":(0,to.ZP)(t),e.requestClose()}n&&(c(n),(0,to.ZP)(t))},tabIndex:"0",children:[w5("div",{className:"toolbar toolbar-default"},void 0,w5("h1",{className:"year"!==r?"button":"",onMouseDown:v,onKeyDown:v,tooltip:b,tabIndex:"year"!==r?a[$.kKeyboardTabToAll]:"-1"},void 0,y),w5("div",{className:"toolbar-group",style:{marginLeft:"auto"}},void 0,w5(Fa,{className:"button-narrow",onClick:h,tooltip:C,image:Ts.mgF.medium}),w5(Fa,{onClick:function(){c(N()().startOf("hour")),l(e.mode)},title:(0,Oe.Z)("Today")}),w5(Fa,{className:"button-narrow",onClick:p,tooltip:w,image:Ts.Zu.medium}))),w5("div",{className:`DatePickerPopup-Contents ${S}`,onAnimationEnd:function(e){const t=e.target;S&&t instanceof n&&t.classList.remove(S)}},I,("day"===r||"week"===r)&&w5(HL,{events:[],month:d,onSelect:u,selectedDate:d,showOutOfMonthDays:!0,showWeekNumber:!0,showWeekDays:!0,highlightMode:"week"===r?"week":"day",fixedHeight:!0}),"month"===r&&w5("div",{className:"DatePickerPopup-YearMonths"},void 0,N().months().map(((t,n)=>{const s=n===e.initialPeriod.month()&&e.initialPeriod.year()===d.year(),i=n===d.month();return w5("div",{className:As()("DatePickerPopup-YearMonth",{"DatePickerPopup-YearMonth--Selected":i,"DatePickerPopup-YearMonth--Highlighted":s}),"data-period":n,onClick:m},t,t)}))),"year"===r&&w5("div",{className:"DatePickerPopup-YearMonths"},void 0,(0,gL.Z)(f,f+12).map((t=>{const n=t===e.initialPeriod.year(),s=t===d.year();return w5("div",{className:As()("DatePickerPopup-YearMonth",{"DatePickerPopup-YearMonth--Selected":s,"DatePickerPopup-YearMonth--Highlighted":n}),"data-period":t,onClick:m},t,t)}))))]})};var I5;function k5(e,t,n,s){I5||(I5="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:I5,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const A5=function(e){const[t,n]=hs.useState(!1),s=(0,na.Z)([$.kKeyboardTabToAll]),i=hs.useContext(xi.Z);function o(){n(!1)}function a(e){if("number"==typeof e.keyCode){const t=HT.Z[e.keyCode];if(e.repeat||"Space"!==t&&"Enter"!==t||e.target!==e.currentTarget)return}n(!t)}let r,l;switch(hs.useEffect((()=>{function t(t){if(t!==i.vivaldiWindowId)return;const{area:s}=ee.Z.getContext(i.vivaldiWindowId);(!e.inPanel&&"panel"!==s||e.inPanel&&"panel"===s)&&n(!0)}return tl.Z.addListener("COMMAND_CALENDAR_GOTO_DATE",t),()=>{tl.Z.removeListener("COMMAND_CALENDAR_GOTO_DATE",t)}}),[e.inPanel,i]),e.displayMode){case"year":l="year",r=e.startDate.year();break;case"month":l="month",r=(0,Oe.Z)("$1 $2",[e.initialPeriod.format("MMMM"),e.initialPeriod.format("YYYY")]);break;case"multiweek":case"week":l="week",r=(0,Oe.Z)("$1 – $2",[e.startDate.format("ll"),e.endDate?.format("ll")]);break;case"day":l="day",r=N()(e.startDate).format("LL");break;case"agenda":l="day",r=(0,Oe.Z)("$1 – $2",[e.startDate.format("ll"),e.endDate?.format("ll")]);break;default:l="day"}return k5("div",{className:"PeriodPicker no-page-focus",onKeyDown:a,onMouseDown:a,tabIndex:s[$.kKeyboardTabToAll]},void 0,k5("h1",{title:(0,Oe.Z)("Click to Select Period")},void 0,r),k5(Fa,{tooltip:(0,Oe.Z)("Click to Select Period"),popupPosition:"below",image:Ts.yaZ.small,onClick:a,hidePopup:o,isPopupVisible:t,popupWidth:300,outsideClickIgnoreClass:"PeriodPicker",tabIndex:-1},void 0,k5(S5,{initialPeriod:e.initialPeriod,setPeriod:e.setPeriod,mode:l,requestClose:o})))};var T5=n(9126);const Z5=function(e,t){const n=hs.useContext(xi.Z).vivaldiWindowId,s=hs.useCallback((t=>t.get(e)),[e]),i=xT(ku.Z,s).get(e),o=t?.filter??i??(0,T5.l)(e),a=hs.useRef(),[r,l]=hs.useState((()=>{if(t?.draft){const n=Rd.Z.initializeEvent(e,t?.draft);return a.current=structuredClone(n),n}})),d=hs.useRef();d.current=r;const c=hs.useRef(a.current),h=hs.useRef(),p=hs.useRef(!1);hs.useEffect((()=>{Gx.Z.init(e)}),[e]);const{anchorDate:u,displayMode:g,filterText:v,selectedEvent:f,selectedDate:y}=o,{accounts:C,calendars:w,events:b,tasks:S,currentEdit:I}=xT(Bd.Z),k=hs.useCallback((function(t){a.current?.id===I.eventId&&n===I.windowId&&e===I.pageId&&m.Z.updateEditState(n,e,null);const s=t||d.current?.id;a.current=null,d.current=null,l(),Gx.Z.selectEvent(e,{eventId:s})}),[n,e,I]),A=hs.useCallback((async function(){if(!d.current)return;const t=d.current.id,n=await m.Z.saveEvent(d.current,a.current,e);return await new Promise((e=>setTimeout(e,1))),n.clearDraft&&!p.current&&k(t||n.event?.id),p.current=!1,n.event}),[k,e]),T=hs.useCallback((async function(e){"cancel"===H.Z.get($.kCalendarClickOutside)?k():await A(),e&&(l(e),a.current=e)}),[k,A]),Z=hs.useCallback((function(t){d.current&&T(),Gx.Z.selectEvent(e,t)}),[e,T]),E=hs.useCallback((function(e){const{eventDraft:t,cache:n}=function(e,t,n,s){let i=t?.start!==e.start||t?.end!==e.end?void 0:n;if(t&&t.task!==e.task)if(n||(i={start:e.start,end:e.end}),e.task)n?(e.start=n.start,e.end=n.end):(e.start=0,e.allDay&&e.end&&(e.end=e.end-Lu.hd));else if(e.allDay&&e.end&&(e.end=e.end+Lu.hd),!e.start&&n&&(e.start=n.start),!e.end&&n&&(e.end=n.end),!e.start){const t=H.Z.get($.kCalendarDefaultDuration);e.end?e.start=e.end-t:(s.selectedDate?e.start=s.selectedDate.valueOf():e.start=(0,Bu.zX)(Date.now()),e.end=e.start+H.Z.get($.kCalendarDefaultDuration))}return t&&t.allDay!==e.allDay&&(e.allDay?e.end&&!e.task&&(e.end=e.end+Lu.hd):(e.end&&!e.task&&(e.end=e.end-Lu.hd),e.timezone===Lu.$T&&(e.timezone=""))),{eventDraft:e,cache:i}}(e,c.current,h.current,o);h.current=n;const s=function(e,t,n){if(n.filterText&&""===e.id&&(e.filteredOut=!Rd.Z.eventHasText(e,n.filterText)&&"DELETE"!==Rd.Z.shouldSaveEvent(e)),!e.organizer&&e.invites?.length){const{invites:t}=e,n=ET.Z.getOrganizerForEvent(e);e.organizer=n,n&&!t.find((e=>e.address===n))&&t.push({id:"",event_id:e.id,address:n,partstat:"ACCEPTED"})}const{calendarId:s,task:i}=e;let{account:o,calendar:a}=Rd.Z.getAccountAndCalendar(s);return(i&&!a?.supportedCalendarComponent.vtodo||!i&&!a?.supportedCalendarComponent.vevent)&&(e.calendarId=Rd.Z.getDefaultCalendar(i)?.id||"",({account:o,calendar:a}=Rd.Z.getAccountAndCalendar(s))),"google"===o?.account_type&&i&&(e.allDay=!0,e.timezone=Lu.$T),!e.rrule||e.start||e.end||(e.rrule=""),e}(t,c.current,o);l({...s}),c.current=s}),[o]),_=hs.useCallback((function(t,n){d.current&&T(),f?Gx.Z.selectEvent(e,{date:t,allDay:n}):Gx.Z.selectDate(e,t,{allDay:n})}),[e,f,T]),M=hs.useCallback((async function(t,s){if(!Rd.Z.doesCalendarsExistsAndShowWarning(n))return;const i=s?Rd.Z.initializeEvent(e,s):structuredClone(t);if(d.current&&(d.current.uid===i?.uid?k():await T(),await new Promise((e=>setTimeout(e,1)))),l(i),a.current=structuredClone(i),c.current=a.current,h.current=null,m.Z.updateEditState(n,e,i?.id),i){const{start:e,end:t}=i,n=!!i.allDay||o.allDaySelected;if(e&&t&&e!==t){const s=y?.valueOf()??0;if(s<e||s>t){Rd.Z.getDisplayRange(u,g).contains(e)&&_(N()(e),n)}}else(e||t)&&_(N()(e||t),n)}}),[n,e,k,T,_,u,g,y,o.allDaySelected]),P=hs.useRef({selectDate:_,selectEvent:Z,editEvent:M,updateEventEdit:E,saveEventEdit:A,endEventEdit:T,cancelEventEdit:k});P.current.selectDate=_,P.current.selectEvent=Z,P.current.editEvent=M,P.current.updateEventEdit=E,P.current.saveEventEdit=A,P.current.endEventEdit=T,P.current.cancelEventEdit=k,!r||n===I.windowId&&e===I.pageId||T();const D=hs.useMemo((()=>new Set(w.filter((e=>!e.hidden)).map((e=>e.id)))),[w]),[x,O]=hs.useMemo((()=>{const e=b.filter((e=>D.has(e.calendarId)));return(0,WO.Z)(e,(e=>!e.trash))}),[b,D]),L=Ku.tV.call(x,u,g),R=hs.useMemo((()=>v?["agenda","year"].includes(g)?L.filter((e=>Rd.Z.eventSearchPredicate(e,v))):L.map((e=>Rd.Z.eventSearchPredicate(e,v)?e:{...e,filteredOut:!0})):L),[g,v,L]),{showCompletedTasks:B}=o,F=hs.useMemo((()=>S.filter((e=>D.has(e.calendarId)&&(!e.complete||B)))),[S,D,B]),V=hs.useMemo((()=>F.filter((e=>Rd.Z.eventSearchPredicate(e,v)))),[F,v]),W=""===a.current?.id,U=hs.useMemo((()=>{const e=a.current;return W&&e?e.uid?[...R.filter((t=>t.uid!==e.uid)),e]:[...R,e]:R}),[R,W]),z=hs.useMemo((()=>W&&a.current?.task?[...V,a.current]:V),[V,W]);if(o.editing){if(o.selectedEvent===r?.id)p.current=!0;else{const e=L.find((e=>e.id===o.selectedEvent));setTimeout((()=>M(e)),1)}Gx.Z.selectEvent(e,{eventId:o.selectedEvent,edit:!1})}return{stateHandler:P.current,calendarFilter:o,eventDraft:r,accounts:C,calendars:w,events:U,trashedEvents:O,tasks:z,hasTasks:S.length>0}};var E5,_5=n(34155);function M5(e,t,n,s){E5||(E5="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:E5,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const N5=(0,VO.extendMoment)(N()),{minimalCreateEvent:P5,doesCalendarsExistsAndShowWarning:D5}=Rd.Z,x5=[$.kCalendarDisplayDensity,$.kCalendarDisplayWeekNumber,$.kMailIsTurnedOff];function O5(){Ne.Z.set($.kCalendarDisplayDensity,"minimal")}function L5(){Ne.Z.set($.kCalendarDisplayDensity,"compact")}function R5(){Ne.Z.set($.kCalendarDisplayDensity,"full")}function B5(){Gx.Z.showCompletedTasks(jL.Q9)}function F5(e){const{mainFilter:t,mode:n,selectedDate:s}=e,i=hs.useRef({...t,displayMode:"tasks"===n?"agenda":"day"}),o=i.current;s&&(!o.anchorDate.isSame(s,"day")||"agenda"===o.displayMode&&"tasks"!==n)&&(i.current={...t,anchorDate:s??N5(),displayMode:"tasks"===n?"agenda":"day"});const a=Z5(jL.Q9,{filter:i.current}),r={displayDensity:H.Z.get($.kCalendarDisplayDensity),isPanel:!0,handler:a.stateHandler,pageId:jL.Q9};return M5("div",{className:"manager-detail"},void 0,M5("div",{className:"header"},void 0,M5("h1",{},void 0,e.title)),M5(nx.Provider,{value:r},void 0,M5(dR,{filter:a.calendarFilter,events:"tasks"===n?a.tasks:a.events,trashedEvents:a.trashedEvents,anchorDate:i.current.anchorDate,displayMode:"tasks"===n?"agenda":"day",eventDisplayStyle:"solid",editingEvent:a.eventDraft})),"tasks"===n&&M5("div",{className:"footer cal-tasks"},void 0,M5("label",{},void 0,M5("input",{type:"checkbox",checked:a.calendarFilter.showCompletedTasks,onChange:B5}),M5("span",{},void 0,(0,Oe.Z)("Show Completed Tasks")))))}const V5=Jq((function(e){const t=hs.useContext(xi.Z),{vivaldiWindowId:n}=t,{pageId:s}=e,[i,o]=hs.useState(H.Z.get($.kCalendarShowDaySidebar)),[a,r]=hs.useState(H.Z.get($.kCalendarShowTasksSidebar)),[l,d]=hs.useState(!1),c=(0,na.Z)(x5),{stateHandler:h,calendarFilter:p,accounts:u,calendars:g,events:v,eventDraft:f,trashedEvents:y}=Z5(s),{displayMode:C,anchorDate:w,selectedDate:b,filterText:S}=p,I=["week","multiweek","month","year"].includes(C)&&(!0===i||"year"===C)||"agenda"===C&&a;hs.useEffect((()=>()=>{_5.nextTick((()=>h.endEventEdit()))}),[n,s,h,t.selectWindow]),hs.useEffect((()=>{H.Z.get($.kCalendarOnboardingShown)||_5.nextTick((()=>{!Bd.Z.getAccounts().some((e=>"local"!==e.account_type))&&Ae.Z.showCalendarAccountDialog(t.vivaldiWindowId)}))}),[t]);const k=c[$.kCalendarDisplayDensity],A=hs.useMemo((()=>({pageId:e.pageId,displayDensity:k,isPanel:!1,handler:h})),[k,h,e.pageId]);function T(e){Gx.Z.setViewMode(s,e)}function Z(){Gx.Z.viewPreviousPeriod(e.pageId)}function E(){Gx.Z.viewNextPeriod(e.pageId)}function _(e){f&&h.endEventEdit(),Gx.Z.selectDate(s,e)}function M(){d(!1)}function N(e){const t=Bd.Z.getEvent(e);t&&Gx.Z.selectEvent(s,{event:t,allDay:t.allDay})}if(c[$.kMailIsTurnedOff])return M5(cT,{windowId:t.vivaldiWindowId});l&&!S&&M();const P=Rd.Z.getDisplayRange(w,C),D=["agenda","year"].includes(C)?0===v.length:v.every((e=>!0===e.filteredOut));let x="";"agenda"===C?x=(0,Oe.Z)("Tasks"):b&&(x=b.format(q.ZP.getWeekdayFormat("LL")));let O="";if(b){const e=c[$.kCalendarDisplayWeekNumber];if("day"===C)O=e&&(0,Oe.Z)("Week $1",[b.week()]);else if("week"===C)O=e&&(0,Oe.Z)("Week $1",[b.week()]);else if("multiweek"===C){const{start:t,end:n}=P;O=e&&(0,Oe.Z)("Weeks $1 - $2",[t.week(),n.week()])}else if("month"===C){const t=N5(w);O=e&&(0,Oe.Z)("Weeks $1 - $2",[t.startOf("month").week(),t.endOf("month").week()])}else if("agenda"===C){const{start:t,end:n}=P;O=e&&(0,Oe.Z)("Weeks $1 - $2",[t.week(),n.week()])}}const L=c[$.kCalendarDisplayDensity];return M5(nx.Provider,{value:A},void 0,M5(da.Z,{focusName:"focus_calendar"},void 0,M5("div",{className:"manager calendar",onClick:function(e){e.stopPropagation(),f&&h.endEventEdit()}},void 0,M5("div",{className:"toolbar toolbar-default"},void 0,M5(Fa,{onClick:function(){if(!D5(n))return;const e=p.selectedDate?.valueOf()??0;m.Z.addEventCommand(t.vivaldiWindowId,P5({start:e}))},title:(0,Oe.Z)("New Event"),image:Ts.md4.small}),M5(h5,{accounts:u,calendars:g}),M5("div",{className:"toolbar-group",style:{marginLeft:"auto"}},void 0,M5("span",{className:"density-label"},void 0,(0,Oe.Z)("calendar","View")),M5(Fa,{tooltip:(0,Oe.Z)("Minimal view"),isPressed:"minimal"===L,onClick:O5,image:Ts.NBh.small}),M5(Fa,{tooltip:(0,Oe.Z)("Compact view"),isPressed:"compact"===L,onClick:L5,image:Ts.EEk.small}),M5(Fa,{tooltip:(0,Oe.Z)("Full view"),isPressed:"full"===L,onClick:R5,image:Ts.Bd5.small})),M5(y5,{filterText:S,onSearchChange:function(e){Gx.Z.search(s,e)},onSelectEvent:N,onShowSearchResults:function(){d(!0)}})),M5("div",{className:"toolbar toolbar-default"},void 0,M5("div",{className:"toolbar-group",style:{marginRight:"auto"}},void 0,M5(Fa,{className:"button-narrow",onClick:Z,tooltip:(0,Oe.Z)("Previous"),image:Ts.mgF.small}),M5(Fa,{onClick:function(){_(N5((0,Bu.zX)(Date.now())))},disabled:!!b&&(0,Bu.KC)(b.toDate(),new Date),title:(0,Oe.Z)("Today")}),M5(Fa,{className:"button-narrow",onClick:E,tooltip:(0,Oe.Z)("Next"),image:Ts.Zu.small})),M5(A5,{initialPeriod:w,setPeriod:_,startDate:P.start,endDate:P.end,displayMode:C,inPanel:!1}),O&&M5("p",{className:"weeks"},void 0,O),M5("div",{className:"toolbar-group",style:{marginLeft:"auto"}},void 0,M5(Fa,{onClick:()=>T("day"),title:(0,Oe.Z)("Day"),tooltip:(0,Oe.Z)("Day (d)"),isPressed:"day"===C}),M5(Fa,{onClick:()=>T("week"),title:(0,Oe.Z)("Week"),tooltip:(0,Oe.Z)("Week (w)"),isPressed:"week"===C}),M5(Fa,{onClick:()=>T("multiweek"),title:(0,Oe.Z)("Multiweek"),tooltip:(0,Oe.Z)("Multiweek (n)"),isPressed:"multiweek"===C}),M5(Fa,{onClick:()=>T("month"),title:(0,Oe.Z)("Month"),tooltip:(0,Oe.Z)("Month (m)"),isPressed:"month"===C}),M5(Fa,{onClick:()=>T("year"),title:(0,Oe.Z)("Year"),tooltip:(0,Oe.Z)("Year (y)"),isPressed:"year"===C}),M5(Fa,{onClick:()=>T("agenda"),title:(0,Oe.Z)("Agenda"),tooltip:(0,Oe.Z)("Agenda (a)"),isPressed:"agenda"===C})),M5("div",{className:"toolbar-group"},void 0,M5(J2,{trashedEvents:y}),M5(Fa,{onClick:function(){"agenda"===p.displayMode?r((e=>(Ne.Z.set($.kCalendarShowTasksSidebar,!e),!e))):o((e=>(Ne.Z.set($.kCalendarShowDaySidebar,!e),!e)))},disabled:"day"===C||"year"===C,tooltip:(0,Oe.Z)("Show Sidebar"),isPressed:"agenda"===C?a:i||"year"===C,image:Ts.S8w.small}))),!l&&D&&S&&M5("div",{className:"no-search-results"},void 0,(0,Oe.Z)("Showing filtered results. Press “Search” for full results.")),M5("div",{className:`manager-view ${C}`,onWheel:function(e){const{deltaY:t,shiftKey:n}=e;n&&(e.stopPropagation(),e.preventDefault(),t>0?E():Z())}},void 0,l&&M5(j2,{selectedEvent:p.selectedEvent,onSelectEvent:N,filterText:S,onClose:M,editingEvent:f}),!l&&M5("div",{className:"manager-content"},void 0,M5(dR,{filter:p,events:v,trashedEvents:y,editingEvent:f,autoFocus:!0})),I&&M5(F5,{title:x,mainFilter:p,mode:"agenda"===C?"tasks":"events",selectedDate:b})))))}));var W5,U5=n(34155);function H5(e,t,n,s){W5||(W5="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:W5,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const z5=function(e){const[t,n]=(0,hs.useState)(void 0),s=(0,VO.extendMoment)(N()),i=s.range(e.minDate,e.maxDate),o=Array.from(i.by("month")),a=(0,hs.createRef)(),r=t=>{e.onSelect(t),n(void 0)},l=({index:n,parent:s,key:i,style:a})=>H5(HL,{style:e.isHeatMap?a:void 0,events:[],month:o[n],selectedDate:e.selectedDate,onSelect:r,showOutOfMonthDays:e.isHeatMap,renderMonthDay:e.renderMonthDay,highlightMode:"day",fixedHeight:!1,highlightedDate:t},i);return(0,fs.jsx)("div",{ref:a,onMouseDown:e=>{e.currentTarget?.focus()},onKeyDown:o=>{const l=t&&s(t).within(i)?t:e.selectedDate;let d;switch(HT.Z[o.keyCode]){case"Left":if(l.isSame(e.minDate.startOf("month"),"day"))break;d=l.clone().subtract(1,"day");break;case"Right":if(l.isSame(e.maxDate.endOf("month"),"day"))break;d=l.clone().add(1,"day");break;case"Up":if(l.isSame(e.minDate.startOf("month"),"day"))break;d=l.clone().subtract(1,"week"),l.isSame(e.minDate,"month")&&l.date()<8&&(d=l.clone().startOf("month"));break;case"Down":if(l.isSame(e.maxDate.endOf("month"),"day"))break;d=l.clone().add(1,"week"),l.isSame(e.maxDate,"month")&&l.clone().endOf("month").date()-l.date()<8&&(d=l.clone().endOf("month"));break;case"Space":case"Enter":o.preventDefault(),r(l);break;case"Escape":o.preventDefault(),n(void 0)}if(d&&(o.preventDefault(),n(d),e.isHeatMap)){const e=a.current?.children[0].querySelector(".CalendarMonth-Day--Highlighted");U5.nextTick((()=>e?.scrollIntoViewIfNeeded()))}},tabIndex:"0",className:e.isHeatMap?"timeline-grid":"month-view-grid",children:H5(QF.q,{},void 0,(({height:t,width:n})=>H5(lo.aV,{width:n,height:t,rowHeight:t=>e.isHeatMap?(({index:t})=>{const n=6===o[t].endOf("month").weekday()||o[t].endOf("month").isSame(e.maxDate)?0:1;return 50*(Math.ceil((o[t].daysInMonth()+o[t].startOf("month").weekday())/7)-n)})(t):e.maxHeight,rowRenderer:l,rowCount:o.length,estimatedRowSize:e.isHeatMap?250:e.maxHeight,overscanRowCount:1,scrollToIndex:e.isHeatMap?o.length-1:void 0},e.isHeatMap?void 0:e.selectedDate.format("YY-MM"))))})};var G5,$5=n(62510),K5=n(97891),j5=n(9740),Y5=n(76148),X5=n(97599);function Q5(e,t,n,s){G5||(G5="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:G5,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const q5={top:6,right:12,bottom:40,left:30},J5={axis:{stroke:"var(--colorFg)"},axisLabel:{fontSize:12,padding:20},grid:{stroke:"var(--colorFgAlpha)"},tickLabels:{angle:-45,textAnchor:"end",fontSize:11,padding:5,fontWeight:600,fontFamily:"inherit"}},e3={duration:400,onLoad:{duration:0}},t3={duration:0},n3={labels:{fontSize:13,padding:0,fontFamily:"inherit"}},s3={labels:{fontSize:13,padding:0,fontFamily:"inherit"}};var i3=Q5($5.Z,{mouseFollowTooltips:!0,voronoiDimension:"x"}),o3=Q5(Jg.Z,{dependentAxis:!0,standalone:!1,style:{axis:{stroke:"var(--colorFg)"},axisLabel:{fontSize:12,padding:20},grid:{stroke:"var(--colorFgAlpha)"},ticks:{stroke:"var(--colorFg)"},tickLabels:{fontSize:11,padding:5,fontFamily:"inherit"}}}),a3=Q5(K5.Z,{constrainToVisibleArea:!0,pointerLength:0,flyoutStyle:{stroke:"var(--colorBorder)",fill:"var(--colorBg)"}}),r3=Q5(K5.Z,{center:{x:80,y:80},pointerWidth:0,pointerLength:0,cornerRadius:0,flyoutStyle:{stroke:"none",fill:"transparent"}});class l3 extends hs.PureComponent{state={externalMutations:[]};getDiff=eo()((e=>{if(e.length>2){const t=[e[0].id,e[e.length-1].id];return N()(t[0]).diff(N()(t[1]),"days")}return e.length}));formatTick=e=>{const t=this.getDiff(this.props.nodes);let n;switch(!0){case t<6:n="H:00",0===N()(e).hour()&&(n="ddd D");break;case t<20:n="H:00",0===N()(e).hour()&&(n="ddd D"),1===N()(e).date()&&(n="MMM",0===N()(e).month()&&(n="MMM YYYY"));break;case t<80:n="ddd D",1===N()(e).date()&&(n="MMM D",0===N()(e).month()&&(n="MMM YYYY"));break;default:n="MMM",0===N()(e).month()&&(n="YYYY")}return N()(e).format(n)};formatTotalLabel=({datum:e})=>{if(!e)return null;const t=this.formatTick(new Date(Math.round(e.unixDate)));return e.visits<1?t:(0,Oe.Z)("$1\nViews: $2\nPages: $3",[t,Math.round(e.visits),Math.round(e.pages)])};formatPieLabel=e=>{const t=e.slice.data;if(Number.isInteger(t.count)){const{linkTypeTotal:e}=this.props.groupedHistoryData,n=(0,X5.Z)(t.count/e*100,0);if(n>0)return`${t.print}\n${n} %`}};removeMutation=()=>{this.setState({externalMutations:[]})};toggleLabel=(e,t)=>{this.setState({externalMutations:[{target:"labels",eventKey:"all",mutation:()=>({active:!1}),callback:()=>this.removeMutation()},{target:"data",eventKey:"all",mutation:()=>({style:void 0}),callback:()=>this.removeMutation()},{target:"labels",eventKey:String(e),mutation:()=>({active:t}),callback:()=>this.removeMutation()},{target:"data",eventKey:String(e),mutation:()=>t?{style:{opacity:.5,fill:this.props.groupedHistoryData.linkTypeColors[e],stroke:"var(--colorBg)",strokeWidth:2}}:{style:void 0},callback:()=>this.removeMutation()}]})};formatAreaXValue=e=>N()(e.unixDate).toDate();formatAreaYValue=e=>e.visits-e.pages;pieEvents=[{target:"data",eventHandlers:{onMouseEnter:()=>[{target:"labels",mutation:()=>({active:!0})},{target:"data",mutation:e=>{const{linkTypeColors:t}=this.props.groupedHistoryData;return{style:{...e.style,fill:t[e.index],opacity:.5,stroke:"var(--colorBg)",strokeWidth:2}}}}],onMouseOut:()=>[{target:"labels",mutation:()=>({active:!1})},{target:"data",mutation:()=>({style:void 0})}]}}];render(){const{title:e,nodes:t,max:n,scaleY:s,groupedHistoryData:i,chartData:o}=this.props;if(0===Object.keys(i).length)return null;const a=0===t.length,{linkTypeColors:r,linkTypes:l,combinedTopPages:d,pageCount:c,pageViewsCount:h,siteCount:p}=i,u=this.getDiff(t)<2,g={y:u?[0,n/2]:[0,n]},m={x:"time",y:s},v=[r[0],r[3]],f="linear",y=H.Z.get($.kThemeUseAnimation)&&this.props.pageIsActive?e3:t3;return Q5("div",{className:"manager-editor more-info"},void 0,Q5("div",{className:"header"},void 0,Q5("h1",{},void 0,e)),Q5("div",{className:"moreinfo-stats"},void 0,Q5("h2",{},void 0,(0,Oe.Z)("Browsing Activity")),Q5("div",{className:"moreinfo-activity"},void 0,!1===a&&Q5(em.Z,{containerComponent:i3,width:245,height:200,padding:q5,domain:g,scale:m},void 0,Q5(Jg.Z,{tickCount:u?13:void 0,tickFormat:this.formatTick,standalone:!1,style:J5}),o3,Q5(j5.Z,{animate:y,standalone:!0,responsive:!1,colorScale:v,style:n3,labels:this.formatTotalLabel,labelComponent:a3},void 0,Q5(tm.Z,{data:o,interpolation:f,standalone:!1,x:this.formatAreaXValue,y:"pages"}),Q5(tm.Z,{data:o,interpolation:f,standalone:!1,x:this.formatAreaXValue,y:this.formatAreaYValue})))),Q5("ul",{className:"moreinfo-activity-labels"},void 0,Q5("li",{className:"visits"},void 0,Q5("span",{style:{backgroundColor:v[1]}}),(0,Oe.Z)("Page Views: $1",[h])),Q5("li",{className:"pages"},void 0,Q5("span",{style:{backgroundColor:v[0]}}),(0,Oe.Z)("Pages: $1",[c]))),Q5("h2",{},void 0,(0,Oe.Z)("Link Transition Type")),Q5("div",{className:"moreinfo-link-types"},void 0,!1===a&&Q5(Y5.Z,{externalEventMutations:this.state.externalMutations,data:l,x:"type",y:"count",width:160,height:160,innerRadius:40,padding:10,colorScale:r,animate:y,style:s3,labels:this.formatPieLabel,labelComponent:r3,events:this.pieEvents}),!1===a&&Q5("ul",{className:"moreinfo-link-labels"},void 0,l.map(((e,t)=>Q5("li",{onMouseEnter:()=>this.toggleLabel(t,!0),onMouseOut:()=>this.toggleLabel(t,!1),title:e.print.length>7?e.print:null,className:0===e.count?"disabled":null},e.type,Q5("span",{style:{backgroundColor:e.color}}),e.print))))),Q5("h2",{},void 0,(0,Oe.Z)("Top Domains of $1 Total",[p])),d.length>0&&Q5("ul",{className:"moreinfo-top-domains"},void 0,d.map(((e,t)=>{if(t<5)return Q5("li",{onClick:this.props.onOpenDomain.bind(this,e.url),onContextMenu:this.props.onDomainContextMenu.bind(this,e.url)},"top_domain_"+t,Q5(Ss,{url:(0,vs.q9)(e.url),loadType:"page"}),Q5("span",{className:"title link"},void 0,e.url?e.url:"localhost"),Q5("span",{className:"item-count"},void 0,e.visitCount))})))))}}const d3=l3,c3=[(0,xs.Z)("keyword","title"),(0,xs.Z)("keyword","url")].map((e=>{const t=(0,ka.lp)({label:e.label});return{...e,labelMatch:t,wordMatch:new RegExp(t,"i")}})),h3=c3.map((e=>e.labelMatch)).join("|"),p3=new RegExp(`(${h3}):\\s*((['"])([^'"]*)\\3|\\S*([^:\\w]|\\w+\\b(?!:))*)`,"gi"),u3=function(e){const t=e.match(p3);if(!t)return{title:"",url:"",query:e.length?e.trim():""};const n=t[0],s=e.indexOf(n),i={query:e.substring(0,s).trim(),url:"",title:""};return t.forEach((e=>{const[t,n]=e.split(":"),s=c3.find((e=>e.wordMatch.test(t)));if(s){const{labelEnglish:e}=s;i[e]=n.trim()}})),i};var g3;function m3(e,t,n,s){g3||(g3="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:g3,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class v3 extends hs.Component{static contextType=xi.Z;refSearch=hs.createRef();refDatePicker=hs.createRef();search=e=>{this.props.search({...this.props.filter,...e})};focusField=()=>{this.refSearch.current?.focus()};onSearchChange=e=>{this.updateFilter(e.target.value)};updateFilter=e=>{const t=u3(e.trim()),n={text:e,parsedFilter:t};this.search(n)};onStartTimeChange=e=>{const t=N()(e.target.value).startOf("day");t.isValid()&&this.search({startTime:t})};onEndTimeChange=e=>{const t=N()(e.target.value).endOf("day");this.search({endTime:t})};onSelectOption=()=>{const e=function(e){const t=parseInt(e);if(!isNaN(t))return t;switch(e){case"today":case"yesterday":case"last_month":case"all":case"date_range":return e;default:return"today"}}(this.refDatePicker.current?.value),t=Z.Z.getTimeByRange({rangePicker:e},this.props.minDate.startOf("day"));this.search(t)};onClearBrowsingData=()=>{Ae.Z.showClearBrowsingHistoryDialog(this.context.vivaldiWindowId)};convertDate=e=>(0,q.SI)(N()(e));render(){const e=this.props.filter,t=this.convertDate(new Date);return(0,fs.jsxs)(fs.Fragment,{children:[m3("div",{className:"toolbar toolbar-default"},void 0,(0,fs.jsx)("input",{ref:this.refSearch,type:"search",tabIndex:"0",style:{flexShrink:2},value:e.text,onChange:this.onSearchChange,onFocus:this.props.onFocus,onBlur:this.props.onBlur,placeholder:(0,Oe.Z)("verb","Search"),disabled:!this.props.hasHistory}),this.props.showClearBtn&&m3(Fa,{onClick:this.onClearBrowsingData,tooltip:(0,Oe.Z)("title","Clear browsing data"),image:Ts.DwE.small})),this.props.showPicker&&m3("div",{className:"toolbar toolbar-default toolbar-wrap"},void 0,(0,fs.jsxs)("select",{ref:this.refDatePicker,value:this.props.filter.rangePicker,onChange:this.onSelectOption,children:[m3("option",{value:"today"},void 0,(0,Oe.Z)("Today")),m3("option",{value:"yesterday"},void 0,(0,Oe.Z)("Yesterday")),m3("option",{value:"7"},void 0,(0,Oe.Z)("Last 7 Days")),m3("option",{value:"30"},void 0,(0,Oe.Z)("Last 30 Days")),m3("option",{value:"date_range"},void 0,(0,Oe.Z)("Date Range...")),m3("option",{value:"all"},void 0,(0,Oe.Z)("All History"))]}),"date_range"===e.rangePicker&&m3("div",{className:"date-range"},void 0,m3(WT,{title:(0,Oe.Z)("Start Date"),max:t,value:this.convertDate(e.startTime),onChange:this.onStartTimeChange}),m3(WT,{title:(0,Oe.Z)("End Date"),max:t,value:this.convertDate(e.endTime),onChange:this.onEndTimeChange})))]})}}const f3=v3,y3=function(e){return class extends hs.Component{constructor(e){super(e),this.id=e.pageId||Z.Z.getPanelResourceKey(),this.state=this._getSearchStateById(this.id),Z.Z.addListener(this._onStoreChange),s.Z.tabs.onUpdated.addListener(this.handleChromeTabsUpdated)}componentWillUnmount(){Z.Z.removeListener(this._onStoreChange),s.Z.tabs.onUpdated.removeListener(this.handleChromeTabsUpdated)}handleChromeTabsUpdated=(e,t,n)=>{const s=Z.Z.getHistorySearchResults(this.id).items[0],i=s?s.children[s.children.length-1]:null;t.title&&"complete"===n.status&&i&&i?.title!==t.title&&x()};_onStoreChange=(e,t)=>{t!==this.id&&void 0!==t||("filterChange"===e?this.setState({filter:Z.Z.getFilter(this.id)}):"searchResultsReady"===e&&this.setState(this._getSearchStateById(this.id)))};_getSearchStateById=e=>{const t=Z.Z.getHistorySearchResults(e);return{nodes:t.items.map((e=>({id:e.id,folder:{id:e.id,pages:e.pages,visitCount:e.visitCount,visitTime:e.visitTime},children:e.children.map((e=>({id:e.id,child:e})))}))),filter:t.filter,statistics:Z.Z.getStatistics(e),oldestDate:t.oldestHistoryDate}};render(){return(0,fs.jsx)(e,{...this.props,...this.state})}}};var C3;function w3(e,t,n,s){C3||(C3="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:C3,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class b3 extends hs.Component{handleClick=(e,t)=>{e.preventDefault(),e.altKey?this.props.isExpanded?this.props.collapseAll():this.props.expandAll():this.props.toggle(t)};render(){const{folder:e,children:t}=this.props,n=t.reduce(((e,t)=>e+t.visitCount),0),s=q.ZP.getWeekdayFormat("LL"),i=N()(e.visitTime).format(s),o=e.id;return w3("label",{"data-parent":o,onClick:this.props.fullView?e=>this.handleClick(e,o):null},void 0,!this.props.fullView&&w3("span",{className:"expand-icon",onMouseDown:to.ZP,onMouseUp:e=>this.handleClick(e,o),dangerouslySetInnerHTML:{__html:Ts.nfH}}),w3("span",{className:"url"},void 0,i),!0===this.props.showBadge&&w3("span",{className:"item-count"},void 0,n))}}const S3=b3;var I3;function k3(e,t,n,s){I3||(I3="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:I3,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var A3=k3("svg",{width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},void 0,k3("path",{d:"M4.5,13.5v-12h7v12L8,10.7L4.5,13.5z"}));class T3 extends hs.Component{static contextType=xi.Z;onDragStart=e=>{const{document:t}=this.context,n=this.props.node;var s=t.createElement("img");s.srcset="chrome://favicon/size/16@1x/"+n.url+" 1x,chrome://favicon/size/16@2x/"+n.url+" 2x",e.dataTransfer.setDragImage(s,s.width-s.width/3,s.height-s.height/3),s.remove(),jr(e,n.url,n.title)};handleMouseEnter=e=>{c.Z.setStatus(this.context.vivaldiWindowId,e)};handleMouseLeave=()=>{c.Z.clearStatus(this.context.vivaldiWindowId)};render(){const{node:e}=this.props,t=N()(e.visitTime),n=e.url.split("\\").pop().split("/").pop()||e.url,s=q.ZP.getWeekdayFormat("LL"),i=(0,gy.dO)(e.url);return this.props.fullView?this.props.columns?(0,fs.jsx)(fs.Fragment,{children:this.props.columns.map((o=>{switch(o.id){case"visitTime":return k3("label",{className:"date",title:t.format(s),draggable:"true",onDragStart:this.onDragStart},o.id,k3("span",{},void 0,t.format("LTS")));case"title":return k3("label",{className:"title",title:e.title?e.title:n,draggable:"true",onDragStart:this.onDragStart},o.id,k3(Ss,{url:e.url,loadType:"page"}),k3("span",{},void 0,e.title?e.title:n));case"address":return k3("label",{className:"url",title:e.url,draggable:"true",onDragStart:this.onDragStart},o.id,e.isBookmarked&&A3,k3(WC,{windowId:this.context.vivaldiWindowId,urlFragments:i,displayUrl:e.url,shouldShowFullUrl:!0,onGoToPath:Aa.Z,onBaseDomainObscured:Aa.Z,shouldHighlightBaseDomain:!1,rawDisplay:!0}));case"visitCount":return k3("label",{className:"visits",draggable:"true",onDragStart:this.onDragStart},o.id,e.visitCount>1&&k3("span",{className:"item-count"},void 0,e.visitCount));default:console.warn("Unknown sorting field:",o.id)}}))}):null:k3("label",{title:t.format("LTS")+h.YV+t.format(s)+h.YV+(e.title?(0,Oe.Z)("Title: $1",[e.title])+h.YV:"")+(0,Oe.Z)("Address: $1",[e.url]),onMouseEnter:this.handleMouseEnter.bind(this,e.url),onMouseLeave:this.handleMouseLeave,draggable:"true",onDragStart:this.onDragStart},void 0,k3(Ss,{url:e.url,loadType:"page"}),k3("span",{className:"title"},void 0,k3("span",{className:"time"},void 0,t.format("LT")),e.title?e.title:e.url),e.visitCount>1&&k3("span",{className:"item-count"},void 0,e.visitCount))}}const Z3=T3;var E3;function _3(e,t,n,s){E3||(E3="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:E3,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function M3(e,t,n){Ds.ZP.openUrls(e,(0,VF.Z)(t),n,!0)}class N3 extends hs.PureComponent{static contextType=xi.Z;refTreeList=hs.createRef();_isPrivateWindow=G.ZP.isIncognito(this.context.vivaldiWindowId);state={showBadge:H.Z.get($.kPanelsShowFolderBadge)};componentDidMount(){H.Z.addListener($.kPanelsShowFolderBadge,this._onBadgeChanged)}componentWillUnmount(){H.Z.removeListener($.kPanelsShowFolderBadge,this._onBadgeChanged)}_onBadgeChanged=(e,t)=>{this.setState({showBadge:Boolean(t)})};setupExpandModel=(e,t,n)=>(t.forEach((t=>{this.isFolder(t)&&!e.hasOwnProperty(t.id)&&(e[t.id]=!0)})),e);hasChildren=e=>Boolean(e.children?.length);isFolder=e=>Boolean(e.children);unSelectAll=()=>{this.refTreeList.current?.unSelectAll()};getSelectedItems=()=>{const e=this.refTreeList.current?this.refTreeList.current.getAllSelectedItems().map((e=>e.id)):[];return this.getItemsByIds(e,!0)};getSelectedItem=()=>this.refTreeList.current?.getSelectedItem();getSelectedUrls=()=>this.getSelectedItems().map((e=>{if(e.child)return e.child.url})).filter(Boolean);getItemById=e=>{const t=function(n){for(let s=0;s<n.length;s++){let i=n[s];if(i.id===e)return i;if(i.children&&(i=t(i.children),i))return i}};return t(this.props.nodes)};getItemsByIds=(e,t)=>{const n=[];return e.forEach((e=>{const s=this.getItemById(e);s&&(s.children&&t?Array.prototype.push.apply(n,s.children):n.push(s))})),n};getUrlsByIds=e=>this.getItemsByIds(e,!0).map((e=>{if(e.child)return e.child.url})).filter(Boolean);openSelected=()=>{const e=this.getSelectedUrls();M3(this.context.vivaldiWindowId,e,{inCurrent:!0,inNewWindow:!1,inBackground:!1,allowOverride:!1,incognito:!1})};openSelectedInNewTab=e=>{const t=this.getSelectedUrls(),n={inCurrent:!1,inNewWindow:!1,inBackground:e||H.Z.get($.kTabsOpenNewInBackground),allowOverride:!1,incognito:!1};M3(this.context.vivaldiWindowId,t,n)};openSelectedInNewWindow=e=>{const t=this.getSelectedUrls(),n={inCurrent:!1,inNewWindow:!0,inBackground:!1,allowOverride:!1,incognito:e};M3(this.context.vivaldiWindowId,t,n)};copy=(e,t)=>{const{clipboardData:n}=e;if(n){const e=t.map((e=>e.id)),s=this.getUrlsByIds(e);n.setData("text/plain",s.join("\r\n")),n.setData("text/uri-list",s.join("\r\n")),n.setData("vivaldi/x-uri-list",s.join("\r\n"))}e.preventDefault()};delete=e=>{const t=[];return this.getItemsByIds(e,this.props.filter&&this.props.filter.text.length>0).forEach((e=>{e.folder?t.push({isFolder:!0,visitTime:e.folder.visitTime}):e.child&&t.push({isFolder:!1,url:e.child.url,visitTime:e.child.visitTime})})),L.deleteHistoryPromise(t)};_saveBookmarks=e=>{const t=this.getItemsByIds(e,!0).map((e=>{if(e.child)return{url:e.child.url,title:e.child.title}})).filter(Boolean);g.Z.createBookmarks(t,ps.ZP.getRootNode().id,0,"history")};handleExpandClick=e=>{this.refTreeList.current?.toggleSelectedExpansion(e)};expandAll=()=>{this.refTreeList.current?.expandAll()};collapseAll=()=>{this.refTreeList.current?.collapseAll()};getMenuCapability=async(e,t,n)=>{const s=this.context.vivaldiWindowId,i=this.getSelectedUrls(),o={address:n.child?n.child.address:"",selectedCount:i.length};switch(e.action){case"CONTEXT_OPEN_IN_NEW_TAB":return{handler:()=>this.openSelectedInNewTab(!1),isVisible:()=>Boolean(n),...t(s,e,o)};case"CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB":return{handler:()=>this.openSelectedInNewTab(!0),isVisible:()=>!H.Z.get($.kTabsOpenNewInBackground)&&Boolean(n),...t(s,e,o)};case"CONTEXT_OPEN_IN_TAB":return{handler:this.openSelected,isVisible:()=>Boolean(n),...t(s,e,o)};case"CONTEXT_OPEN_IN_NEW_WINDOW":return{handler:()=>this.openSelectedInNewWindow(!1),isVisible:()=>Boolean(n),...t(s,e,o)};case"CONTEXT_OPEN_IN_PRIVATE_WINDOW":return{handler:()=>this.openSelectedInNewWindow(!0),isVisible:()=>Boolean(n),...t(s,e,o)};case"CONTEXT_CONTAINER_OPEN_IN_WINDOW":{const o=await Kr.getMenu(s,!0,i);return{isVisible:()=>Boolean(n)&&o.length>0,items:o,...t(s,e,{})}}case"CONTEXT_FILTER_BY":return{handler:()=>this.props.onSearchDomain(o.address),isVisible:()=>Boolean(n)&&!this.isFolder(n),...t(s,e,o)};default:return{...t(s,e,o)}}};getMenuVisibility=(e,t)=>{if(t)switch(e.action){case"CONTEXT_COPY":case"CONTEXT_SAVE":case"CONTEXT_DELETE":case"CONTEXT_EXPAND_ALL":case"CONTEXT_COLLAPSE_ALL":return!0;default:return!1}else switch(e.action){case"CONTEXT_EXPAND_ALL":case"CONTEXT_COLLAPSE_ALL":return!0;default:return!1}};onContextMenu=e=>{this.refTreeList.current?.onContextMenu(e)};onItemMouseDown=(e,t)=>{t.button===Hi.Z.kCenter&&(t.preventDefault(),t.stopPropagation())};onItemMouseUp=(e,t)=>{t.button===Hi.Z.kCenter&&(this.openSelectedInNewTab(!0),t.preventDefault(),t.stopPropagation())};onItemDoubleClick=e=>{if(e.button!==Hi.Z.kCenter){const t=this.context.vivaldiWindowId;M3(t,this.getSelectedUrls(),{...(0,nl.Z)(t,{button:e.button,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey})})}};onItemsActivated=(e,t)=>{const n=this.context.vivaldiWindowId;M3(n,this.getUrlsByIds(t.map((e=>e.id))),{...(0,nl.Z)(n,{ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey})})};handleSelect=e=>{if(e&&!e.folder&&e.child?.dateKey&&this.refTreeList.current?.isItemSelected(e.id)){const t=this.refTreeList.current?.findTreeItem(e.child.dateKey);if(t&&this.refTreeList.current?._isFolderWithChildren(t)&&this.refTreeList.current?.isItemSelected(t.id)){const e=!1;this.refTreeList.current?.SelectionMixinSelectItem(t.id,!e,!1,e)}}};validateForDeletion=xz.Z;getRowComponentProps=e=>({...e,columns:this.props.columns,showBadge:this.state.showBadge});rowComponent=e=>{const{columns:t,node:n,isExpanded:s}=e,{folder:i,children:o,child:a}=n,r=[];return i&&o?r.push(_3(S3,{folder:i,children:o.map((e=>e.child)).filter(Boolean),isExpanded:s,toggle:this.handleExpandClick,expandAll:this.expandAll,collapseAll:this.collapseAll,showBadge:e.showBadge,fullView:this.props.fullView},"history_tree_folder_"+i.id+"_"+i.visitTime)):a&&r.push(_3(Z3,{node:a,columns:t,isPrivateWindow:this._isPrivateWindow,fullView:this.props.fullView},"history_tree_item_"+a.id+"_"+a.visitTime)),r};menu={name:"historylist",getCapability:this.getMenuCapability,getVisibility:this.getMenuVisibility};render(){if(!this.props.nodes)return null;const e={sortOrder:this.props.filter.sortOrder,sortField:this.props.filter.sortField,onlyScroll:!0},{filter:t,nodes:n}=this.props,{text:s,displayMode:i}=t,o=!n.some((e=>Boolean(e.children?.length))),a=n.some((e=>Boolean(e.children)));return(0,fs.jsx)(fs.Fragment,{children:o&&"week"!==i?_3("div",{className:"vivaldi-tree-empty"},void 0,(0,Oe.Z)("The search term “$1” did not return any results.",[s])):(0,fs.jsx)(yo,{settings:this.props.inManager?"HISTORY_MANAGER":"HISTORY_PANEL",ref:this.refTreeList,rowComponent:this.rowComponent,getRowComponentProps:this.getRowComponentProps,nodes:a?n.filter((e=>Boolean(e.children?.length))):n,columns:this.props.columns,folderMode:"custom",setupExpandModel:this.setupExpandModel,hasChildren:this.hasChildren,isFolder:this.isFolder,onItemDoubleClick:this.onItemDoubleClick,onItemMouseDown:this.onItemMouseDown,onItemMouseUp:this.onItemMouseUp,onItemsActivated:this.onItemsActivated,onCopy:this.copy,onSave:this._saveBookmarks,menu:this.menu,delete:this.delete,disableSelectAfterDelete:!1,enableDragAndDrop:!1,validateForDeletion:this.validateForDeletion,sorting:e,onSelect:this.handleSelect})})}}const P3=N3,D3=function(e,t,n){if(0===t.length)return{combinedTopPages:[],linkTypes:[],linkTypeColors:[],linkTypeTotal:0,pageCount:0,pageViewsCount:0,siteCount:0};const s={},i={};let o=z.Z.getState().theme.colorHighlightBg,a=B()(o).get("hsl.h"),r=B()(o).get("hsl.s");const l=B()(o).get("hsl.l");(r<.2||l<.4)&&(o="#006ed7",a=B()(o).get("hsl.h"),r=B()(o).get("hsl.s"));const d=B().scale([o,B()(o).set("hsl.h",a+50).desaturate(r),B()(o).set("hsl.h",a+130).desaturate(r),B()(o).set("hsl.h",a+180).desaturate(r),B()(o).set("hsl.h",a+230).desaturate(r),B()(o).set("hsl.h",a-50).desaturate(r)]).mode("lab").colors(6);let c=[{type:"auto_toplevel",count:0,color:d[0],print:(0,Oe.Z)("linktype","Direct")},{type:"typed",count:0,color:d[1],print:(0,Oe.Z)("linktype","Typed")},{type:"link",count:0,color:d[2],print:(0,Oe.Z)("linktype","Link")},{type:"reload",count:0,color:d[3],print:(0,Oe.Z)("linktype","Reload")},{type:"form_submit",count:0,color:d[4],print:(0,Oe.Z)("linktype","Form")},{type:"other",count:0,color:d[5],print:(0,Oe.Z)("linktype","Other")}],h=[];t.forEach((e=>{h=h.concat(n[e.id]?n[e.id].mostVisited:[]),c=(e.children||[]).map((e=>e.child?e.child.transition_type:void 0)).filter(Boolean).reduce(((e,t)=>{const n=e.find((e=>e.type===t));if(n)n.count=n.count+1;else{const t=e.find((e=>"other"===e.type));t&&(t.count=t.count+1)}return e}),c)}));const p=c.map((e=>e.color)),u=c.reduce(((e,t)=>e+t.count),0);t.forEach((e=>{(e.children||[]).forEach((e=>{const{child:t}=e;t&&(s[t.address]=s[t.address]?t.visitCount+s[t.address]||0:t.visitCount,i[t.url]=i[t.url]?t.visitCount+i[t.url]||0:t.visitCount)}))}));const g=Object.keys(i).length,m=Object.keys(s).length,v=Object.values(i).reduce(((e,t)=>e+parseInt(t)),0);return{linkTypeColors:p,linkTypeTotal:u,combinedTopPages:Object.keys(s).map((e=>({url:e,visitCount:s[e]}))).sort(((e,t)=>t.visitCount-e.visitCount)),linkTypes:c,pageCount:g,pageViewsCount:v,siteCount:m}};var x3;function O3(e,t,n,s){x3||(x3="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:x3,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const L3=[$.kStartpageNavigation],R3=[{text:(0,Oe.Z)("Date"),fullScreenTitle:(0,Oe.Z)("Sort by visit time"),value:"visitTime",icon:Ts.V_c,width:100,visible:!0},{text:(0,Oe.Z)("Title"),fullScreenTitle:(0,Oe.Z)("Sort by page title"),value:"title",width:300,visible:!0,key:!0},{text:(0,Oe.Z)("Address"),fullScreenTitle:(0,Oe.Z)("Sort by page address"),value:"address",icon:Ts.iD7,width:300,visible:!0},{text:(0,Oe.Z)("Views"),fullScreenTitle:(0,Oe.Z)("Sort by number of page views"),value:"visitCount",icon:Ts.boz,width:100,visible:!0}],B3=(0,VO.extendMoment)(N());class F3 extends hs.PureComponent{static contextType=xi.Z;_locale={weekdays:[],weekdaysShort:[],monthsShort:[],weekStartsOn:0};_weekdaysSorted;_selecting=!1;_selectionHighlight=!1;_anchorDate=B3();_shortDayFormat="";_searchHasFocus=!1;constructor(e){super(e),this.state={columns:io().history||oo(R3)};const t=q.ZP.getWeekdays("long"),n=B3.localeData().firstDayOfWeek();this._locale={weekdays:t,weekdaysShort:q.ZP.getWeekdays("short"),monthsShort:q.ZP.getMonths("short"),weekStartsOn:n},this._weekdaysSorted=t.slice(n).concat(t.slice(0,n)),this._shortDayFormat=q.ZP.getWeekdayFormat(q.ZP.getShortDateFormat())}componentDidMount(){L.loadAll()}_saveStateByFilter=(e,t)=>{const n={displayMode:t.displayMode,startTime:t.startTime.valueOf(),endTime:t.endTime.valueOf(),dayPickerVisible:t.dayPickerVisible,moreInfoVisible:t.moreInfoVisible,monthEntriesVisible:t.monthEntriesVisible};d.ZP.setHistoryManagerState(e,n),L.saveStateFromSearchQuery(e,t)};_setRange=(e,t,n=null,s=!1)=>{const{filter:i}=this.props,o=B3.range(B3(e).startOf("day"),B3(t).endOf("day")),a={...i,startTime:o.start,endTime:o.end,displayMode:n||i.displayMode,range:o};this._selectionHighlight=s,this.onSearch(a)};_setDayPickRange=(e,t)=>{const{filter:n}=this.props,s=B3.range(n.startTime,n.endTime),i=B3.range(B3(e).startOf("day"),B3(t).endOf("day"));if(B3(e).within(s)&&B3(t).within(s)){const e={...n,range:i};this.onSearch(e),this._selectionHighlight=!0}else if(i.overlaps(s)){const e=i.add(s);this._setRange(e.start,e.end,null,!1)}else this._setRange(B3(t).startOf(n.displayMode),B3(t).endOf(n.displayMode),null,!1)};toggleDayPicker=()=>{const e="dayPickerVisible",{filter:t}=this.props,n={...t,[e]:!t[e]};this.onSearch(n)};toggleMoreInfo=()=>{const e="moreInfoVisible",{filter:t}=this.props,n={...t,[e]:!t[e]};this.onSearch(n)};_setView=e=>{const t=e.target.value,{filter:n}=this.props,s={...n,[t]:!n[t]};this.onSearch(s)};onSortChange=(e,t)=>{const{filter:n}=this.props,s={...n,sortOrder:e,sortField:t};this.onSearch(s)};onUpdateRow=e=>{this.setState({columns:e})};onSaveRow=()=>{so(this.state.columns,"history")};onSelectAll=()=>{const e=B3(),t=this.props.oldestDate,{filter:n}=this.props,s={...n,startTime:t,endTime:e.endOf("day")};this.onSearch(s),this._setRange(t,e.endOf("day"),"range",!1)};onIncludeUrlChange=()=>{const{filter:e}=this.props,t=!e.searchURL,n={...e,searchURL:t};this.onSearch(n)};onClearBrowsingData=()=>{Ae.Z.showClearBrowsingHistoryDialog(this.context.vivaldiWindowId)};onCalendarSelect=(e,t)=>{if(!0===this._selecting)return this._selecting=!1,Promise.resolve();const n=B3(e);if(t?.shiftKey){const e=this.expandRange(n);this._setRange(e.start,e.end)}else this._anchorDate=n,this._setRange(n,n,null,!0);return this._selectionHighlight=!0,Promise.resolve()};expandRange=e=>{const t=this.props.filter.range,n=B3.range(e,e);return t.contains(n)?t:e.unix()>t.start.unix()?B3.range(t.start,n.end.endOf("day")):B3.range(n.start.startOf("day"),t.end)};handleMouseDown=(e,t)=>{const{button:n,ctrlKey:s,shiftKey:i}=t;if(n&&0!==n)return;const o=B3(e);let a;i?(a=this.expandRange(o),this._setDayPickRange(a.start,a.end)):this._setDayPickRange(o,o),this._selecting=!0,this._anchorDate=B3(e)};handleMouseUp=(e,t)=>{this._selecting&&this.props.filter.range&&(this._selecting=!1)};handleMouseEnter=(e,t)=>{if(!this._selecting||!this.props.filter.range)return;const n=this.expandRange(B3(e));this._setDayPickRange(n.start,n.end)};onSearch=e=>{const t=this.props.pageId;if(t){const n={...this.props.filter,...e};this._saveStateByFilter(t,n),L.searchHistory(t,n)}};onSearchDomain=e=>{e=UI(e);const{filter:t}=this.props,n={...t,text:e,parsedFilter:u3(e),searchURL:!0};this.onSearch(n)};onOpenDomain=e=>{d.ZP.openURL(this.context.vivaldiWindowId,(0,vs.q9)(e))};handleDisplayModeChange=(e="day")=>{if("range"===e)this._anchorDate=B3(),this._setRange(this.props.oldestDate,B3(),e,!1);else{const t=this._anchorDate||B3();this._setRange(B3(t).startOf(e),B3(t).endOf(e),e,!1)}};restoreSelection=()=>{this._selectionHighlight=!1;const{displayMode:e}=this.props.filter;this.handleDisplayModeChange(e)};viewCurrent=()=>{const{displayMode:e}=this.props.filter;this._setRange(B3().startOf(e),B3().endOf(e))};viewPrevious=e=>{const{startTime:t,displayMode:n}=this.props.filter,s="range"===n?"day":n,i=B3(t).subtract(1,s).startOf(s),o=B3(i).endOf(s);this._setRange(i,o)};viewNext=()=>{const{startTime:e,displayMode:t}=this.props.filter,n="range"===t?"day":t,s=B3(e).add(1,n).startOf(n),i=B3(s).endOf(n);this._setRange(s,i)};getNumWeeksForMonth=(e,t)=>{let n=new Date(e,t-1,1).getDay()-this._locale.weekStartsOn;n<0&&(n+=7);const s=new Date(e,t,0).getDate();return Math.ceil((s+n)/7)};getDomainMenuItems=e=>[{handler:()=>this.onSearchDomain(e),...(0,xs.Z)("Filter by “$1”",[e])},{handler:()=>this.onOpenDomain(e),...(0,xs.Z)("Go to “$1”",[e])}];onDomainContextMenu=(e,t)=>{(0,Qi.Z)(this.context,this.getDomainMenuItems(e))(t)};getActivityLevel=(e,t,n)=>e>=t-t/10?"max":e>=n&&e<t-t/10?"high":e>=n/2&&e<n?"mid":e>0&&e<n/2?"low":"min";renderMonthDay=(e,t,n,s,i)=>{i=B3(i);const{statistics:o,filter:a}=this.props,r=o[(0,q.SI)(i)];if(!r)return O3("div",{className:i.within(a.range)?"selected":null,onClick:e=>this.onCalendarSelect(i,e),style:{height:n}},i.valueOf(),O3("span",{className:"Cal__Day__day"},void 0,i.date()));const l=o[(0,q.SI)(i)].visits||0,d=this.getActivityLevel(l,e,t),c=Math.max(Math.floor((n-72)/15),1);let h=[];a.text.length>0?h=r.mostVisited.map((e=>e.url)):(h=r.mostVisited.map((e=>UI(e.url))),h=(0,VF.Z)(h));const p=h.map(((e,t)=>{if(t<c)return O3("li",{title:e,onContextMenu:this.onDomainContextMenu.bind(this,e)},i.unix()+"_"+t,e)}));return O3("div",{className:i.within(a.range)?"selected":null,onClick:e=>this.onCalendarSelect(i,e),style:{height:n}},void 0,O3("span",{className:"Cal__Day__day"},void 0,i.date()),O3("h4",{className:As()({heat:!0,[`${d}`]:!0})},void 0,O3("span",{className:"visits"},void 0,O3("strong",{},void 0,r.visits),(0,Oe.Z)("view","views",[r.visits])),O3("span",{className:"pages"},void 0,O3("strong",{},void 0,r.pages),(0,Oe.Z)("page","pages",[r.pages]))),O3("ul",{className:"top-links"},void 0,p))};renderCalWeek=()=>{const{nodes:e,filter:t}=this.props,{range:n}=t;let s=Array.from(n.by("days"));if(B3(s[0]).day()!==this._locale.weekStartsOn||s.length<7){const e=B3(s[0]).startOf("week"),t=B3(s[0]).endOf("week");s=Array.from(B3.range(e,t).by("days"))}else s.length>7&&(s=s.slice(0,6));return O3("div",{className:"week-container"},void 0,s.map((s=>{const i=B3(s).within(n),o=(0,q.SI)(s),a=e.find((e=>e.folder&&e.folder.id===o)),r=B3(s).within(B3.range(this.props.oldestDate,B3()));return O3("div",{className:"week-day"},"week_"+o,O3("header",{onClick:r?this._setDayPickRange.bind(this,s,s):null,className:As()({selected:i,disabled:!r})},void 0,s.format(this._shortDayFormat)),O3("div",{className:"tree"},void 0,a?.children&&O3(P3,{fullView:!1,inManager:!0,nodes:a.children,filter:t,onSearchDomain:this.onSearchDomain},"week_"+s.id)))})))};renderCalDay=(e,t,n)=>{n=B3(n);const{statistics:s,filter:i}=this.props,o=B3(this.props.oldestDate).within(i.range)&&B3().within(i.range);let a,r="min";return s[(0,q.SI)(n)]?(a=s[(0,q.SI)(n)].visits||0,r=this.getActivityLevel(a,e,t)):a=0,O3("span",{title:(0,Oe.Z)("$1 visit","$1 visits",[a]),className:As()({heat:!0,selected:!o&&n.within(i.range),[`${r}`]:!0}),onMouseDown:e=>this.handleMouseDown(n,e),onMouseUp:e=>this.handleMouseUp(n,e),onMouseEnter:e=>this.handleMouseEnter(n,e)},n.unix()+"_"+n,O3("span",{},void 0,n.format("D")),"1"===n.format("D")&&O3("span",{className:"Cal__Day__month"},void 0,n.format("MMM")),"1"===n.format("D")&&n.year()!==B3().year()&&O3("span",{className:"Cal__Day__year"},void 0,n.format("YYYY")))};padStats=e=>{const{statistics:t,filter:n,nodes:s}=this.props;let i=e.start.clone(),o=e.end.clone();s.length===e.duration("days")&&(i=i.startOf(n.displayMode),o=o.endOf(n.displayMode));const a=B3.range(i,o),r=new Map;for(const[e,n]of Object.entries(t)){const t=B3(e,"YYYY-MM-DD");t.within(a)&&r.set(e,{hour:0,pages:n&&"number"==typeof n.pages?n.pages:0,visits:n&&"number"==typeof n.visits?n.visits:0,unixDate:t.valueOf()})}for(;i.diff(o)<=0;){const e=(0,q.SI)(i);r.has(e)||r.set(e,{hour:0,pages:0,visits:0,unixDate:i.valueOf()}),i.add(1,"d")}return[...r.values()].sort(((e,t)=>e.unixDate>t.unixDate?1:t.unixDate>e.unixDate?-1:0))};render(){const{filter:e,statistics:t}=this.props,n=e.range,s=this.props.nodes.filter((e=>e.folder&&e.folder.id>=(0,q.SI)(n.start)&&e.folder.id<=(0,q.SI)(n.end)));let i=[];if(!s||"number"!=typeof this.props.maxHeight)return null;const o=e.text.length>1||e.moreInfoVisible?D3(this.context.vivaldiWindowId,s,t):{combinedTopPages:[],linkTypeColors:[],linkTypeTotal:0,linkTypes:[],pageCount:0,pageViewsCount:0,siteCount:0};e.moreInfoVisible&&(i=Object.keys(t).length>0&&1===s.length&&s[0].id&&t[s[0].id]?t[s[0].id].timeArr:this.padStats(n));const a=B3(e.startTime),r=this.getNumWeeksForMonth(a.year(),a.month()+1),l=(0,q.SI)(n.start)===(0,q.SI)(B3(this.props.oldestDate))&&(0,q.SI)(n.end)===(0,q.SI)(B3());let d,c,h,p=[],u="";if(s.length>1){const t=s[0].folder,n=s[s.length-1].folder;t&&n&&(p=[B3(t.visitTime).format("l"),B3(n.visitTime).format("l")],u="visitTime"===e.sortField&&2===e.sortOrder?p[0]+" – "+p[1]:p[1]+" – "+p[0])}switch(d="month"===e.displayMode?(0,Oe.Z)("$1 $2",[B3(a).format("MMMM"),B3(a).format("YYYY")]):"week"===e.displayMode?(0,Oe.Z)("Week $1, $2",[B3(a).week(),B3(a).year()]):s.length>1?u:B3(e.startTime).format("LL"),c=s.length>1?u:1===s.length?s[0].folder?B3(s[0].folder.visitTime).format("LL"):"":B3(e.startTime).format("LL"),e.displayMode){case"month":h=(0,Oe.Z)("This Month");break;case"week":h=(0,Oe.Z)("This Week");break;default:h=(0,Oe.Z)("Today")}const g=B3(Object.keys(t).sort()[0]).startOf("month"),m=B3(),v=B3(this.props.oldestDate).isBefore(m.subtract(2,"m"))?B3(this.props.oldestDate):m.subtract(2,"m"),f=Object.keys(t).map((e=>t[e].visits)),y=Math.max(Math.max.apply(Math,f),10);f.sort(((e,t)=>e-t));const C=(f[Math.floor((f.length-1)/2)]+f[Math.ceil((f.length-1)/2)])/2,w="on"===this.props.prefValues[$.kStartpageNavigation]?51:0,b=e.text.length>1?40:0,S=(this.props.maxHeight-(w+b+40+21))/r,I=Boolean(this.props.pageId&&ie.ZP.getPageInWindow(this.context.vivaldiWindowId,this.props.pageId)?.active);return O3("div",{className:"history manager"},void 0,O3("div",{className:"toolbar toolbar-default"},void 0,O3(Fa,{onClick:this.toggleDayPicker,tooltip:(0,Oe.Z)("Day picker calendar"),isPressed:e.dayPickerVisible,image:Ts.eVT}),O3(f3,{search:this.onSearch,onFocus:()=>{this._searchHasFocus=!0},onBlur:()=>{this._searchHasFocus=!1},filter:e,minDate:this.props.oldestDate,hasHistory:0!==s.length,showClearBtn:!1}),O3("h1",{onClick:this.restoreSelection,style:{marginLeft:"auto",marginRight:"auto",flexShrink:5}},void 0,d),O3(Fa,{onClick:this.viewCurrent,title:h}),O3("div",{className:"toolbar-group"},void 0,O3(Fa,{onClick:this.viewPrevious.bind(this,g),tooltip:(0,Oe.Z)("Previous"),className:"button-narrow",disabled:B3(this.props.oldestDate).within(n),image:Ts.mgF.small}),O3(Fa,{onClick:this.viewNext,className:"button-narrow",tooltip:(0,Oe.Z)("Next"),disabled:m.within(n),image:Ts.Zu.small})),O3("div",{className:"toolbar-group"},void 0,O3(Fa,{title:(0,Oe.Z)("List"),isPressed:"range"===e.displayMode,onClick:()=>this.handleDisplayModeChange("range")}),O3(Fa,{title:(0,Oe.Z)("Day"),isPressed:"day"===e.displayMode,onClick:()=>this.handleDisplayModeChange("day")}),O3(Fa,{title:(0,Oe.Z)("Week"),isPressed:"week"===e.displayMode,onClick:()=>this.handleDisplayModeChange("week")}),O3(Fa,{title:(0,Oe.Z)("Month"),isPressed:"month"===e.displayMode,onClick:()=>this.handleDisplayModeChange("month")})),O3(Fa,{onClick:this.onClearBrowsingData,tooltip:(0,Oe.Z)("title","Clear browsing data"),image:Ts.DwE.small}),O3(Fa,{onClick:this.toggleMoreInfo,tooltip:e.moreInfoVisible?(0,Oe.Z)("Hide info"):(0,Oe.Z)("More info"),image:Ts.GH$,isPressed:e.moreInfoVisible})),e.text.length>1&&O3("div",{className:"toolbar toolbar-default search-options"},void 0,O3(Fa,{onClick:this.onSelectAll,title:(0,Oe.Z)("Search All History"),disabled:l}),O3("label",{},void 0,O3("input",{type:"checkbox",checked:e.searchURL,onChange:this.onIncludeUrlChange}),(0,Oe.Z)("Include Address in Search Results")),O3("div",{className:"filtered-entries"},void 0,(0,Oe.Z)("$1 Entry","$1 Entries",[o.pageViewsCount]))),O3("div",{className:As()({"history-view":!0,selecting:this._selectionHighlight})},void 0,e.dayPickerVisible&&O3("div",{className:"manager-editor"},void 0,O3("div",{className:"CalendarMonth-Weekdays"},void 0,this._weekdaysSorted.map((e=>O3("span",{className:"CalendarMonth-DayOfWeek"},`hdr-${e.toString()}`,B3().day(e).format("ddd"))))),O3("div",{className:"timeline",onMouseLeave:this.handleMouseUp},void 0,O3(z5,{selectedDate:n.start,minDate:v,maxDate:m.endOf("month"),renderMonthDay:this.renderCalDay.bind(this,y,C),onSelect:this.onCalendarSelect,isHeatMap:!0}))),O3("div",{className:"manager-content history-calendar-container"},void 0,"range"===e.displayMode&&O3("div",{className:"view range"},void 0,O3(gv,{fields:R3,columns:this.state.columns,fullsize:!0,manualSorting:!1,keyAccess:this.props.keyAccess,onUpdateRow:this.onUpdateRow,onSaveRow:this.onSaveRow,onSortChange:this.onSortChange,sortField:e.sortField,sortOrder:e.sortOrder}),s.length>0?O3("div",{className:"history-tree"},void 0,O3(P3,{nodes:s,fullView:!0,inManager:!0,columns:this.state.columns,onSearchDomain:this.onSearchDomain,filter:e})):O3("div",{className:"vivaldi-tree-empty"},void 0,(0,Oe.Z)("No browsing history data for selected period"))),"day"===e.displayMode&&O3("div",{className:"view day"},void 0,O3(gv,{fields:R3,columns:this.state.columns,fullsize:!0,manualSorting:!1,keyAccess:this.props.keyAccess,onUpdateRow:this.onUpdateRow,onSaveRow:this.onSaveRow,onSortChange:this.onSortChange,sortField:e.sortField,sortOrder:e.sortOrder}),s.length>0?O3("div",{className:"history-tree"},void 0,O3(P3,{nodes:s,fullView:!0,inManager:!0,columns:this.state.columns,filter:e,onSearchDomain:this.onSearchDomain})):O3("div",{className:"vivaldi-tree-empty"},void 0,(0,Oe.Z)("No browsing history data for selected period"))),"week"===e.displayMode&&O3("div",{className:"view week"},void 0,this.renderCalWeek()),"month"===e.displayMode&&O3("div",{className:"view month"},void 0,O3("div",{className:"month-calendar"},void 0,O3("div",{className:"CalendarMonth-Weekdays"},void 0,this._weekdaysSorted.map((e=>O3("span",{className:"CalendarMonth-DayOfWeek"},`hdr-${e.toString()}`,B3().day(e).format("dddd"))))),O3(z5,{selectedDate:n.start,minDate:B3(a.startOf("month")),maxDate:B3(a.endOf("month")),renderMonthDay:this.renderMonthDay.bind(this,y,C,S,Math.floor(this.props.maxWidth/7)),onSelect:this.onCalendarSelect,maxHeight:this.props.maxHeight})),e.monthEntriesVisible&&O3("div",{className:"month-links"},void 0,O3("ul",{className:"CalendarMonth-Weekdays"},void 0,O3("li",{className:"CalendarMonth-DayOfWeek"},void 0,(0,Oe.Z)("Entries"))),O3(P3,{nodes:s,fullView:!1,inManager:!0,filter:e,onSearchDomain:this.onSearchDomain})),O3("button",{className:"toggle-month-entries",title:e.monthEntriesVisible?(0,Oe.Z)("Hide entries"):(0,Oe.Z)("Show entries"),onClick:this._setView,value:"monthEntriesVisible",tabIndex:this.props.keyAccess},void 0,e.monthEntriesVisible?">":"<"))),e.moreInfoVisible&&O3(d3,{title:c,nodes:s,groupedHistoryData:o,onOpenDomain:this.onOpenDomain,chartData:i,max:y,scaleY:"sqrt",onDomainContextMenu:this.onDomainContextMenu,pageIsActive:I})))}}const V3=sa(y3(F3),L3);var W3=n(62882),U3=n(50564),H3=n(60007),z3=n.n(H3),G3=n(89927),$3=n(63549),K3=n(57570),j3=n.n(K3),Y3=n(96936),X3=n.n(Y3),Q3=n(5460),q3=n.n(Q3),J3=n(61519),e4=n.n(J3),t4=n(56827),n4=n.n(t4),s4=n(6691),i4=n.n(s4),o4=n(74006),a4=n.n(o4),r4=n(4499),l4=n.n(r4),d4=n(91833),c4=n.n(d4),h4=n(45253),p4=n.n(h4),u4=n(27055),g4=n.n(u4),m4=n(85215),v4=n.n(m4),f4=n(29560),y4=n.n(f4),C4=n(37721),w4=n.n(C4),b4=n(96344),S4=n.n(b4),I4=n(82026),k4=n.n(I4),A4=n(23874),T4=n.n(A4),Z4=n(93839),E4=n.n(Z4),_4=n(61083),M4=n.n(_4),N4=n(41304),P4=n.n(N4),D4=n(42387),x4=n.n(D4),O4=n(61896),L4=n.n(O4),R4=n(78529),B4=n.n(R4),F4=n(30308),V4=n.n(F4),W4=n(58473),U4=n.n(W4),H4=n(36632),z4=n.n(H4),G4=n(19514),$4=n.n(G4),K4=n(97181),j4=n.n(K4),Y4=n(26306),X4=n.n(Y4),Q4=n(91533),q4=n.n(Q4),J4=n(17151),e6=n.n(J4),t6=n(42157),n6=n.n(t6);const s6={FORBID_TAGS:["style"],ALLOW_UNKNOWN_PROTOCOLS:!0};class i6{constructor(e){j3().registerLanguage("apache",X3()),j3().registerLanguage("applescript",q3()),j3().registerLanguage("bash",e4()),j3().registerLanguage("basic",n4()),j3().registerLanguage("coffeescript",i4()),j3().registerLanguage("cpp",a4()),j3().registerLanguage("css",l4()),j3().registerLanguage("diff",c4()),j3().registerLanguage("django",p4()),j3().registerLanguage("dockerfile",g4()),j3().registerLanguage("dos",v4()),j3().registerLanguage("ini",y4()),j3().registerLanguage("java",w4()),j3().registerLanguage("javascript",S4()),j3().registerLanguage("json",k4()),j3().registerLanguage("less",T4()),j3().registerLanguage("markdown",E4()),j3().registerLanguage("mathematica",M4()),j3().registerLanguage("matlab",P4()),j3().registerLanguage("nginx",x4()),j3().registerLanguage("objectivec",L4()),j3().registerLanguage("perl",B4()),j3().registerLanguage("python",V4()),j3().registerLanguage("ruby",U4()),j3().registerLanguage("scss",z4()),j3().registerLanguage("shell",$4()),j3().registerLanguage("sql",j4()),j3().registerLanguage("swift",X4()),j3().registerLanguage("typescript",q4()),j3().registerLanguage("vim",e6()),j3().registerLanguage("xml",n6()),this.remarkable=new G3._("commonmark",{emptyLines:!0,html:!0,breaks:!0,typographer:!1,quotes:e.quotes,highlight:(e,t)=>{if(t&&j3().getLanguage(t))try{return j3().highlight(t,e).value}catch(e){}return""}}),this.remarkable.use(z3()),this.remarkable.use($3.N);const t=this.remarkable.inline.validateLink,n=/^\s*data:([a-z]+\/[a-z]+(;[a-z-]+=[a-z-]+)?)?(;base64)?,[a-z0-9!$&',()*+,;=\-._~:@/?%\s]*\s*$/i,s=/^\s*blob:chrome-extension:\/\/[a-z0-9!$&',()*+,;=\-._~:@/?%\s]*\s*$/i,i=/^\s*file:\/\/[a-z0-9!$&',()*+,;=\-._~:@/?%\s]*\s*$/i;this.remarkable.inline.validateLink=e=>t(e)||e.match(n)||e.match(s)||e.match(i),this.remarkable.inline.ruler.enable(["del","mark","sub","sup"]),this.remarkable.block.ruler.enable(["table"])}getRawMarkup(e){return(0,Fu.sanitize)(this.remarkable.render(e),s6)}}var o6;function a6(e,t,n,s){o6||(o6="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:o6,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class r6 extends hs.Component{static contextType=xi.Z;refWebview=hs.createRef();constructor(e,t){super(e),this.state={startOffsetOnNewline:0,createLinkModalOpen:!1,caretState:{bold:!1,italic:!1,strikeThrough:!1,formatBlock:"p",insertOrderedList:!1,insertUnorderedList:!1},windowStyle:z.Z.getBaseStylesByWindowId(t.vivaldiWindowId,DA)}}componentDidMount(){z.Z.addListener(this.onThemeStoreChanged),this.refWebview.current?.addEventListener("consolemessage",this.handleConsoleMessage),this.refWebview.current?.addEventListener("contentload",this.handleContentLoad),this.refWebview.current?.addEventListener("newwindow",this.handleGoToURL)}componentWillUnmount(){z.Z.removeListener(this.onThemeStoreChanged),this.refWebview.current?.removeEventListener("consolemessage",this.handleConsoleMessage),this.refWebview.current?.removeEventListener("contentload",this.handleContentLoad),this.refWebview.current?.removeEventListener("newwindow",this.handleGoToURL)}onThemeStoreChanged=()=>{const e=z.Z.getBaseStylesByWindowId(this.context.vivaldiWindowId,DA);e!==this.state.windowStyle&&this.setState({windowStyle:e},this.setStyle)};postMessage=e=>{this.refWebview.current?.contentWindow?.postMessage?.(e,"*")};handleContentLoad=()=>{this.setStyle(),this.props.onContentLoad(),this.postMessage({type:"CONTENT_LOAD_REPLY",translatedStrings:{bold:(0,Oe.Z)("Strong text"),italic:(0,Oe.Z)("Emphasized text"),strikeThrough:(0,Oe.Z)("Deleted text"),quotes:(0,Oe.Z)("“”‘’")}})};handleGoToURL=e=>{e.preventDefault(),e.targetUrl.startsWith("#")||d.ZP.openURL(this.context.vivaldiWindowId,e.targetUrl)};onCaretStateEvent(e){if(!e)return;let t;try{t=JSON.parse(e)}catch(e){return}this._updateCaretState(t)}_updateCaretState(e){this.setState((t=>({caretState:{...t.caretState,...e}})),(()=>this.props.updateButtonState?.()))}focus(){this.refWebview.current?.focus()}blur(){this.refWebview.current?.blur()}hasFocus(){const{document:e}=this.context;return Boolean(this.refWebview.current)&&this.refWebview.current===e.activeElement}getContentAsBodyParts=()=>{const e=this.refWebview.current;return e?new Promise(((t,n)=>{e.executeScript({code:"document.body.innerText"},(e=>{e&&Array.isArray(e)&&"string"==typeof e[0]?t([{type:"text",content:e[0],charset:"UTF-8"}]):n("PlainTextEdit.getContentAsBodyParts: Couldn't get content from Webview")}))})):Promise.reject("RichTextEdit.getContentAsBodyParts: Webview doesn't exist")};onClick=e=>{if("createLink"===e)this.props.handleLinkEvent({type:e});else this.execCommand(e,""),this.props.updateButtonState?.()};onChange=(e,t)=>{this.execCommand(e,t.currentTarget.value),this.props.updateDropdownState?.()};execCommand(e,t){this.postMessage({type:"BUTTON_CLICK",command:e,value:t})}setContent=e=>{this.refWebview.current?.executeScript({code:`document.body.innerText = unescape('${escape(e)}');`},this.setStyle)};setStyle=()=>{this.refWebview.current?.executeScript({code:"document.head.innerHTML = `<style>"+Uk.Z.createStyleRoot(this.state.windowStyle)+"\n    html, body, iframe {\n      background-color: var(--colorBg);\n      padding: 0;\n      margin: 0;\n      font-family: sans-serif;\n      overflow: initial;\n    }\n    body[contenteditable=\"plaintext-only\"] {\n      font-family: monospace;\n    }\n    body {\n      --EditorPadding: 12px;\n      --MaxWidth: 700px;\n      margin-left: var(--EditorPadding);\n      padding-left: calc(calc(50% - calc(var(--MaxWidth) / 2) - var(--EditorPadding))) !important;\n      padding-right: calc(50% - calc(var(--MaxWidth) / 2)) !important;\n      padding-top: var(--EditorPadding);\n      padding-bottom: calc(var(--EditorPadding) * 3);\n      color: var(--colorFgIntense);\n      font-size: 100%;\n      cursor: text;\n    }\n    img {\n      display: inline-block;\n      vertical-align: top;\n      max-width: 100%;\n      height: auto;\n    }\n    a:-webkit-any-link {\n      color: var(--colorHighlightBg);\n      cursor: pointer;\n    }\n  \n    html {\n      width: calc(100% - 12px);\n    }\n    html, body, iframe {\n      font-size: 100%;\n    }\n    input[type=checkbox] {\n      appearance: none;\n      position: relative;\n      width: 16px;\n      height: 16px;\n      min-width: 16px;\n      min-height: 16px;\n      vertical-align: middle;\n      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1) inset;\n      margin: unset;\n      border-width: 1px;\n      border-style: solid;\n      border-color: rgba(0,0,0,0.2);\n      background-color: var(--colorBgIntense);\n    }\n    input[type='checkbox']:disabled {\n      opacity: 1;\n      filter: grayscale(1);\n    }\n    input[type=checkbox]:before,\n    input[type=checkbox]:after {\n      content: '';\n      position: absolute;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      background-color: var(--colorHighlightBg);\n      transform-origin: 0 0;\n    }\n    input[type=checkbox]:before {\n      transform: rotate(-45deg) translateY(45%) translateX(-30%) scaleX(0.25) scaleY(0);\n    }\n    input[type=checkbox]:checked:before {\n      transform: rotate(-45deg) translateY(45%) translateX(-30%) scaleX(0.25) scaleY(0.4);\n    }\n    input[type=checkbox]:after {\n      transform: rotate(225deg) translateY(-30%) translateX(-95%) scaleX(0.25) scaleY(0);\n    }\n    input[type=checkbox]:checked:after {\n      transform: rotate(225deg) translateY(-30%) translateX(-95%) scaleX(0.25) scaleY(1.2);\n    }\n    \n    .tooltip {\n      --TipWidth: 480px;\n      position: relative;\n    }\n    .tooltip .tooltip-text * {\n      user-select: none;\n    }\n    .tooltip-text input {\n      margin-left: 3px;\n      border: 1px solid var(--colorBorder);\n      border-radius: 2px;\n      font-size: 13px;\n      opacity: 0.8;\n      color: var(--colorFg);\n      background-color: var(--colorBg);\n    }\n    .tooltip-text input:active {\n      background-color: var(--colorBgDark);\n    }\n    .tooltip-text input:first-of-type {\n      margin-left: 12px;\n    }\n    .tooltip-text a {\n      white-space: nowrap;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      color: var(--colorFg);\n    }\n    .tooltip .tooltip-text {\n      cursor: default;\n      position: absolute;\n      z-index: 1;\n      display: flex;\n      align-items: center;\n      top: 100%;\n      left: -6px;\n      max-width: var(--TipWidth);\n      padding: 6px 6px 6px 12px;\n      color:var(--colorFg);\n      background-color: var(--colorBg);\n      border: 1px solid var(--colorBgDark);\n      box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.1), 0 3px 10px rgba(0, 0, 0, 0.3);\n      border-radius: 3px;\n    }\n  \n  ".replace(/\n|\r/g,"")+"</style>`;"})};debouncedUpdateState=(0,no.Z)((()=>{this.props.updateButtonState?.(),this.props.updateDropdownState?.()}),100);handleConsoleMessage=e=>{const[t,n]=e.message.split(" ",2);switch(t){case"caretState":this.onCaretStateEvent(n);break;case"selectionchange":this.debouncedUpdateState();break;case"input":this.debouncedUpdateState(),this.props.onChange(e);break;case"createLink":this.props.handleLinkEvent({type:t});break;default:throw new Error(e.message)}};setZoomLevel=e=>{const t=this.refWebview.current;t&&(t.setZoomMode("per-view"),t.setZoom(e))};render(){const{disabled:e,hidden:t}=this.props;return a6("div",{className:"editor-html"},void 0,(0,fs.jsx)("webview",{className:"editor-webview",name:"markdowneditor",ref:this.refWebview,style:t||e?{display:"none"}:{},allowtransparency:"on",src:'data:text/html,<html id="content" tabindex="-1">\n  <head><script src="chrome-extension://mpognobbkildjkofajifpdfhcoklimli/markdowneditor-bundle.js"><\/script></head>\n  <body contenteditable="plaintext-only"></body>\n</html>'}))}}var l6,d6,c6,h6=n(24925);function p6(e,t,n,s){l6||(l6="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:l6,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function u6({disabled:e,keyAccess:t,noteId:n,text:s,onOpenDialog:i}){const o=hs.useRef(null);return p6("label",{className:As()("button-toolbar",{disabled:e}),title:(0,Oe.Z)("Attach new file..."),tabIndex:t},void 0,(0,fs.jsx)("input",{ref:o,type:"file",style:{display:"none"},accept:"image/*",disabled:e,onChange:e=>Nn.Z.addFile(n,e.target.files[0])}),p6("button",{disabled:e,tabIndex:t,onClick:function(){i?.(),o.current?.click()}},void 0,p6("div",{style:{display:"contents"},dangerouslySetInnerHTML:{__html:Ts.onv}}),p6("span",{},void 0,s)))}function g6(e,t,n,s){d6||(d6="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:d6,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function m6({onDelete:e,onContextMenu:t,url:n,onOpen:s,onDragStart:i,draggable:o}){return g6("div",{className:"AttachmentItem",onDragStart:i?e=>i(e,n):null,draggable:o},void 0,g6("img",{className:"AttachmentItem-Image",src:n}),g6("button",{className:"AttachmentItem-DeleteButton",title:(0,Oe.Z)("Remove attachment"),onClick:()=>e(),tabIndex:"-1"}),g6("button",{className:As()({"AttachmentItem-ViewOverlayButton":!0,"dragging-enabled":o}),title:(0,Oe.Z)("View attachment"),onContextMenu:t,onClick:s}))}function v6(e,t,n,s){c6||(c6="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:c6,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function f6(e,t,n,s){const i={inCurrent:n,inBackground:s};d.ZP.openURL(e,t,i)}function y6(e,t,n){const s={inNewWindow:!0,incognito:n};d.ZP.openURL(e,t,s)}class C6 extends hs.Component{static contextType=xi.Z;onContextMenu=(e,t,n)=>{const s=this.context.vivaldiWindowId,i=[{items:[{handler:()=>f6(s,t,!0,!1),...(0,xs.Z)("Current Tab")},{handler:()=>f6(s,t,!1,H.Z.get($.kTabsOpenNewInBackground)),...(0,xs.Z)("open in","New Tab")},{handler:()=>f6(s,t,!1,!0),isVisible:()=>!H.Z.get($.kTabsOpenNewInBackground),...(0,xs.Z)("Background Tab")},ae.Z.separatorItem,{handler:()=>y6(s,t,!1),...(0,xs.Z)("open in","New Window")},{handler:()=>y6(s,t,!0),...(0,xs.Z)("open in","Private Window")}],...(0,xs.Z)("Open in")},ae.Z.separatorItem,{handler:(e=>{e&&this.props.onInsertMarkdown?.(e)}).bind(null,t),...(0,xs.Z)("Insert Markdown"),isVisible:()=>!!this.props.onInsertMarkdown},{handler:this.props.onRemoveAttachment.bind(null,e),...(0,xs.Z)("verb","Remove")}];(0,Qi.Z)(this.context,i)(n)};onDragStart=(e,t)=>{"html"===this.props.dragFormat?e.dataTransfer.setData("text/html",`<img src="${t}" />`):e.dataTransfer.setData("text/plain",`attachment:${t}`)};render(){const{attachments:e}=this.props;return v6("div",{className:"NotesAttachments"},void 0,e.map(((e,t)=>{const n=e.content?`chrome://vivaldi-data/synced-store/${e.content}`:"";return v6(m6,{url:n,onContextMenu:this.onContextMenu.bind(null,e.id,n),onOpen:e=>d.ZP.openURL(this.context.vivaldiWindowId,n),onDelete:this.props.onRemoveAttachment.bind(null,e.id),onDragStart:this.onDragStart,draggable:!!this.props.onInsertMarkdown},e.id)})))}}const w6=C6;var b6,S6;function I6(e,t,n,s){b6||(b6="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:b6,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function k6({noteId:e,attachments:t,onRemoveAttachment:n,onInsertMarkdown:s,dragFormat:i}){return I6("div",{className:"NotesAttachmentPopup"},void 0,I6(w6,{attachments:t,onRemoveAttachment:n,onInsertMarkdown:s,dragFormat:i}),I6(u6,{noteId:e,disabled:!1,keyAccess:-1,text:(0,Oe.Z)("Add attachment")}))}function A6(e,t,n,s){S6||(S6="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:S6,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const T6=[[{command:"bold",text:(0,Oe.Z)("Bold"),icon:Ts.q7H},{command:"italic",text:(0,Oe.Z)("Italic"),icon:Ts.znb},{command:"strikeThrough",text:(0,Oe.Z)("Strike through"),icon:Ts._QD}],[{command:"insertOrderedList",text:(0,Oe.Z)("Numbered list"),icon:Ts.o_D},{command:"insertUnorderedList",text:(0,Oe.Z)("Bullet list"),icon:Ts.rr$},{command:"outdent",text:(0,Oe.Z)("Remove indentation"),icon:Ts.XKb},{command:"indent",text:(0,Oe.Z)("Indent"),icon:Ts.b2r}],[{command:"createLink",text:(0,Oe.Z)("Create Link"),icon:Ts.v2I}],[{command:"undo",text:(0,Oe.Z)("win_linux","Undo"),icon:Ts.LwO},{command:"redo",text:(0,Oe.Z)("win_linux","Redo"),icon:Ts.W9w}]];class Z6 extends hs.Component{static contextType=xi.Z;isAnchor=!1;anchorOrSelection="";state={buttonState:[],createLinkModalOpen:!1,formatBlock:"p",isAttachmentPopupOpen:!1};updateButtonState=(e,t)=>{this.setState((n=>({buttonState:e||n.buttonState,formatBlock:t||n.formatBlock})))};updateLinkState=e=>{this.isAnchor=e.isAnchor,this.anchorOrSelection=e.anchorOrSelection};onCreateLink=e=>{this.setState({createLinkModalOpen:!1}),this.props.onCreateLink(e)};onCancelCreateLink=()=>{this.setState({createLinkModalOpen:!1}),this.props.onCancelCreateLink()};showCreateLinkModal=()=>this.setState({createLinkModalOpen:!0});cacheFocus=()=>{const{document:e}=this.context;e.activeElement?this._focusCache=e.activeElement:this._focusCache=void 0};restoreFocus=()=>{this._focusCache&&this._focusCache.focus()};toggleAttachmentPopup=()=>this.setState((e=>({isAttachmentPopupOpen:!e.isAttachmentPopupOpen})));hideAttachmentPopup=()=>this.setState({isAttachmentPopupOpen:!1});enableVisualMode=()=>this.props.setVisualMode(!0);disableVisualMode=()=>this.props.setVisualMode(!1);handleFindInPage=(e,t)=>Vv.Z.findInPage(this.context.vivaldiWindowId,this.props.pageId,e,t);handleFindNextInPage=(e,t,n)=>Vv.Z.findNextInPage(this.context.vivaldiWindowId,this.props.pageId,e,t,n);render(){const{noteId:e}=this.props;let t=0;return A6("div",{className:"NotesManager-Toolbar"},void 0,this.state.createLinkModalOpen&&A6(EA,{onCreateLink:this.onCreateLink,onCancelCreateLink:this.onCancelCreateLink,isAnchor:this.isAnchor,anchorOrSelection:this.anchorOrSelection}),A6("div",{className:"toolbar toolbar-default NotesManager-Buttons"},void 0,A6(Fa,{tooltip:this.props.inFullView?(0,Oe.Z)("Enter Full View"):(0,Oe.Z)("Exit Full View"),onClick:this.props.toggleFullEditor,image:this.props.inFullView?Ts.ADs.medium:Ts.BB1.medium}),A6("select",{onChange:e=>{this.props.onParagraphFormatChange("formatBlock",e),this.restoreFocus()},onMouseDown:this.cacheFocus,value:this.state.formatBlock,title:(0,Oe.Z)("Paragraph Format"),tabIndex:"-1",disabled:this.props.disabled},void 0,A6("option",{value:"h1"},void 0,(0,Oe.Z)("Heading 1")),A6("option",{value:"h2"},void 0,(0,Oe.Z)("Heading 2")),A6("option",{value:"h3"},void 0,(0,Oe.Z)("Heading 3")),A6("option",{value:"h4"},void 0,(0,Oe.Z)("Heading 4")),A6("option",{value:"p"},void 0,(0,Oe.Z)("Paragraph")),A6("option",{value:"pre"},void 0,(0,Oe.Z)("Preformatted"))),T6.map(((e,n)=>{const s=e.map(((e,n)=>A6(Fa,{tooltip:e.text,image:e.icon,onClick:()=>this.props.onStylingButtonClicked(e.command),tabIndex:-1,disabled:this.props.disabled,isPressed:!0===this.state.buttonState[t+n]},e.command)));return t+=s.length,A6("div",{className:"toolbar-group"},n,s)})),A6(Fa,{className:"attachment-button push-right",title:(0,Oe.Z)("$1 Attachment","$1 Attachments",[this.props.attachments.length]),onClick:this.toggleAttachmentPopup,isPopupVisible:this.state.isAttachmentPopupOpen,hidePopup:this.hideAttachmentPopup,popupClassName:"ToolbarButtonPopup-DefaultStyles",popupWidth:222,popupPosition:"below",image:Ts.onv,disabled:this.props.disabled},void 0,e&&A6(k6,{attachments:this.props.attachments,noteId:e,onRemoveAttachment:e=>{Nn.Z.removeNode(e)},onInsertMarkdown:this.props.handleAttachmentMarkdown,dragFormat:this.props.visualMode?"html":"url"})),A6("div",{className:"toolbar-group"},void 0,A6(Fa,{title:(0,Oe.Z)("Text"),onClick:this.disableVisualMode,isPressed:!this.props.visualMode,disabled:this.props.disabled}),A6(Fa,{title:(0,Oe.Z)("Visual"),onClick:this.enableVisualMode,isPressed:this.props.visualMode,disabled:this.props.disabled}))),A6(mk,{isActive:this.props.isActive,pageId:this.props.pageId,onFindInPage:this.handleFindInPage,onFindNextInPage:this.handleFindNextInPage}))}}function E6(e,t){if(e.title)return e.title;if(!e.content)return t||"";return e.content.split("\n")[0].trim().replace(/ {2,}/g," ").replace(/^#+ /g,"").substr(0,128).trim()}function _6({content:e}){return e?e.replace(/\n+/g,"").length:0}function M6({content:e}){return e?e.trim().split(/\s+/g).length:0}var N6,P6,D6=n(5846),x6=n(34155);function O6(e,t,n,s){N6||(N6="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:N6,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class L6 extends hs.Component{static contextType=xi.Z;refMarkdownEditor=hs.createRef();refVisualEditor=hs.createRef();refToolbar=hs.createRef();markdownFormatter=new i6({quotes:(0,Oe.Z)("“”‘’")});turndownService=(0,h6.Z)({headingStyle:"atx",codeBlockStyle:"fenced"});state={visualMode:!H.Z.get($.kNotesManagerShowMarkdown),attachments:this.props.note?.children?this.props.note.children:[]};componentDidMount(){W3.ZP.addListener(this._onNoteStoreChanged),this.turndownService.use(U3.r0),this.turndownService.addRule("strikethrough",{filter:["del","s","strike"],replacement:e=>"~~"+e+"~~"}),this.turndownService.addRule("listItem",{filter:"li",replacement:function(e,t,n){e=e.replace(/^\n+/,"").replace(/\n+$/,"\n").replace(/\n/gm,"\n    ");let s=n.bulletListMarker+" ",i=t.parentNode;if("OL"===i.nodeName){const e=i.getAttribute("start"),n=Array.prototype.indexOf.call(i.children,t);s=(e?Number(e)+n:n+1)+". "}let o=-1;for(;i&&("OL"===i.nodeName||"UL"===i.nodeName);)o+=1,i=i.parentNode;return"    ".repeat(o)+s+e+(t.nextSibling&&!/\n$/.test(e)?"\n":"")}})}componentDidUpdate(e){e.note!==this.props.note&&(this.hasFocus()||(this.onRichContentLoad(),this.onMarkdownContentLoad()),this.setState({attachments:this.props.note?.children?this.props.note.children:[]}))}componentWillUnmount(){W3.ZP.removeListener(this._onNoteStoreChanged)}_onNoteStoreChanged=e=>{if(this.props.note){const e=W3.ZP.getNodeById(this.props.note.id);e&&this.setState({attachments:e.children})}};focus=()=>{this.state.visualMode?this.refVisualEditor.current?.focus():this.refMarkdownEditor.current&&this.refMarkdownEditor.current.focus()};blur=()=>{this.state.visualMode?this.refVisualEditor.current?.blur():this.refMarkdownEditor.current&&this.refMarkdownEditor.current.blur()};hasFocus=()=>this.state.visualMode&&this.refVisualEditor.current?this.refVisualEditor.current.hasFocus():!!this.refMarkdownEditor.current&&this.refMarkdownEditor.current.hasFocus();handleAttachmentMarkdown=async e=>{this.refVisualEditor.current&&this.props.note&&this.refVisualEditor.current.execCommand("insertImage",e)};onHtmlChange=()=>{if(!this.refVisualEditor.current)throw new Error("VisualEditor: Building body parts after body is gone");return this.refVisualEditor.current.getContentAsBodyParts().then((e=>{if("html"===e[0].type){const t=this.turndownService.turndown(e[0].content);this.props.updateNoteContent(t,(()=>{this.refMarkdownEditor&&this.refMarkdownEditor.current&&this.refMarkdownEditor.current.setContent(t)}))}}))};onMarkDownChange=async()=>{if(!this.refMarkdownEditor.current)throw new Error("MarkdownEditor: Building body parts after body is gone");const e=await this.refMarkdownEditor.current.getContentAsBodyParts();if("text"!==e[0].type)return;const t=e[0].content;this.props.updateNoteContent(t,(()=>{}))};setZoomLevel=()=>{const e=sb.Z.getNotesZoom();this.refVisualEditor.current?.setZoomLevel(e),this.refMarkdownEditor.current?.setZoomLevel(e)};onRichContentLoad=()=>{const{note:e}=this.props,t=this.markdownFormatter.getRawMarkup(e?.content??"").replace(/<p><\/p>/g,"<p><br></p>");x6.nextTick((()=>{this.refVisualEditor.current?.setContent([{content:t,isPlainText:!1}]),this.setZoomLevel()}))};onMarkdownContentLoad=()=>{const{note:e}=this.props;x6.nextTick((()=>{this.refMarkdownEditor.current?.setContent(e?.content||""),this.setZoomLevel()}))};onStylingButtonClicked=e=>{this.state.visualMode?this.refVisualEditor.current?.onClick(e):this.refMarkdownEditor.current?.onClick(e)};onParagraphFormatChange=(e,t)=>{this.state.visualMode?this.refVisualEditor.current?.onChange(e,t):this.refMarkdownEditor.current?.onChange(e,t)};onCreateLink=e=>{const t=this.state.visualMode?this.refVisualEditor.current:this.refMarkdownEditor.current;t&&(""===e?t.execCommand("unlink"):"https://"!==e&&t.execCommand("createLink",e),t.focus())};onCancelCreateLink=()=>{this.focus()};handleLinkEvent=e=>{const t=this.refToolbar.current;if(!t)return;const{isAnchor:n,anchorOrSelection:s}=t;switch(e.type){case"selectionchange":t.updateLinkState(e);break;case"createLink":case"editLink":t.showCreateLinkModal();break;case"copyLink":break;case"unlink":n&&s&&this.refVisualEditor.current?.unlink();break;case"createLinkClicked":n&&s&&this.refVisualEditor.current?.selectSurrounding(),t.showCreateLinkModal()}};setActiveWebView=()=>{this.clearActiveWebViews();const e=this.refVisualEditor.current?.refWebview.current,t=this.refMarkdownEditor.current?.refWebview.current,n=this.context.vivaldiWindowId;this.state.visualMode&&e?HI.setActiveWebView(n,e):this.refMarkdownEditor&&t&&HI.setActiveWebView(n,t)};clearActiveWebViews=()=>{const e=this.refVisualEditor.current?.refWebview.current,t=this.refMarkdownEditor.current?.refWebview.current,n=this.context.vivaldiWindowId;e&&HI.clearIfActive(n,e),t&&HI.clearIfActive(n,t)};setVisualMode=e=>{this.setState({visualMode:e},(()=>{this.setActiveWebView(),this.onRichContentLoad(),Ne.Z.set($.kNotesManagerShowMarkdown,!e)}))};updateDropdownAndColorState=()=>{this.refVisualEditor.current?.executeScript({code:"['formatBlock'].map(command => document.queryCommandValue(command));"}).then((e=>{if(Array.isArray(e)&&1===e.length&&Array.isArray(e[0])){const[t]=e[0],n=""===t||"div"===t?"p":t;this.refToolbar.current?.updateButtonState(void 0,n)}}))};updateButtonState=()=>{const e=this.refToolbar.current;if(e)if(this.state.visualMode){const t=`[${'"'+T6.flat().map((e=>e.command)).join('","')+'"'}].map(command => document.queryCommandState(command));`;this.refVisualEditor.current?.executeScript({code:t}).then((t=>{const n=T6.flat().map((e=>e.command)).indexOf("createLink"),s=t&&t[0]||[];s[n]=!!e.state.anchor,e.updateButtonState(s)}))}else{const t=this.refMarkdownEditor.current;if(!t)return;const n=T6.flat().map((e=>e.command)).map((e=>t.state.caretState[e])).filter(D6.Z),{formatBlock:s}=t.state.caretState;e.updateButtonState(n,s)}};render(){const{note:e}=this.props;return(0,fs.jsxs)(fs.Fragment,{children:[(0,fs.jsx)(Z6,{ref:this.refToolbar,isActive:this.props.isActive,noteId:e?.id,pageId:this.props.pageId,attachments:this.state.attachments,disabled:!e||this.props.isFolder,inFullView:this.props.inFullView,visualMode:this.state.visualMode,handleAttachmentMarkdown:this.handleAttachmentMarkdown,onCreateLink:this.onCreateLink,onCancelCreateLink:this.onCancelCreateLink,onParagraphFormatChange:this.onParagraphFormatChange,onStylingButtonClicked:this.onStylingButtonClicked,setVisualMode:this.setVisualMode,toggleFullEditor:this.props.toggleFullEditor}),O6("div",{className:"NotesManager-Editor"},void 0,O6("div",{className:"editor-html"},void 0,(0,fs.jsx)(RA,{ref:this.refVisualEditor,onChange:this.onHtmlChange,onContentLoad:this.onRichContentLoad,focusPreviousElement:Aa.Z,isNote:!0,hidden:!this.state.visualMode,disabled:!e||this.props.isFolder,updateDropdownAndColorState:this.updateDropdownAndColorState,updateButtonState:this.updateButtonState,handleLinkEvent:this.handleLinkEvent})),(0,fs.jsx)(r6,{ref:this.refMarkdownEditor,onChange:this.onMarkDownChange,onContentLoad:this.onMarkdownContentLoad,hidden:this.state.visualMode,disabled:this.state.visualMode||!e||this.props.isFolder,updateDropdownState:this.updateDropdownAndColorState,updateButtonState:this.updateButtonState,handleLinkEvent:this.handleLinkEvent})),e&&O6("footer",{className:"NotesManager-Footer"},void 0,O6("div",{className:"NotesManager-WordCount"},void 0,(0,Oe.Z)("$1 word","$1 words",[M6(e)])+", "+(0,Oe.Z)("$1 character","$1 characters",[_6(e)])))]})}}function R6(e,t,n,s){P6||(P6="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:P6,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function B6(e,t){d.ZP.openURL(e,je.jk.internalUrl("notes",t.id),{singleton:!0})}class F6 extends hs.PureComponent{refTreeList=hs.createRef();static contextType=xi.Z;_isAdding=!1;state={nodes:[],populated:!1,cutIds:[],showBadge:H.Z.get($.kPanelsShowFolderBadge)};expandModel={};componentDidMount(){H.Z.addListener($.kPanelsShowFolderBadge,this._onBadgeChanged),W3.ZP.addListener(this._onStoreChange),this._onStoreChange({reason:"init",id:"-1"})}componentWillUnmount(){H.Z.removeListener($.kPanelsShowFolderBadge,this._onBadgeChanged),W3.ZP.removeListener(this._onStoreChange)}componentDidUpdate(e){if(this.props.filter!==e.filter){const t=this.props.filter.length,n=e.filter.length;0===n&&t>0&&this.refTreeList.current&&(this.expandModel=this.refTreeList.current.getExpandModel()),this.onFilterChange(this.props.filter,(e=>{t>0?this.refTreeList.current?.expandAllExcept(e):n>0&&0===t&&this.refTreeList.current?.expandWithModel(this.expandModel)}))}}isEmpty=()=>this.state.populated&&0===this.state.nodes.length;isInManager=()=>Boolean(this.props.columns);deleteSelectedItems=()=>this.refTreeList.current?.onDelete()||Promise.reject();delete=(e=[])=>Promise.all(e.map((e=>"string"!=typeof e?Promise.resolve():new Promise((t=>{C.Z.notes.get(e,(n=>{n&&n.length>0&&!this.isTrashCan(n[0])?C.Z.notes.remove(e,t):t()}))})))));isFolder=e=>W3.ZP.isFolder(e);isTrashCan=e=>Boolean("trash"===e.type);getUrlsByNodes=e=>e.map((e=>W3.ZP.getNodeById(e.id))).map((e=>e?.url?(0,vs.q9)(e.url):void 0)).filter(Boolean);onItemMouseDown=(e,t)=>{t.button===Hi.Z.kCenter&&(0,to.ZP)(t)};onItemMouseUp=(e,t)=>{if(t.button===Hi.Z.kCenter){const n=this.getUrlsByNodes([e]),s=this.context.vivaldiWindowId;n.length>0?d.ZP.openUrls(s,n,{...(0,nl.Z)(s,{button:t.button,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,metaKey:t.metaKey})}):B6(this.context.vivaldiWindowId,e),(0,to.ZP)(t)}};onItemDoubleClick=(e,t)=>{const n=this.getUrlsByNodes([t]),s=this.context.vivaldiWindowId;n.length>0?d.ZP.openUrls(s,n,{...(0,nl.Z)(s,{button:e.button,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey})}):B6(s,t)};onNodesActivated=(e,t)=>{const n=this.getUrlsByNodes(t),s=this.context.vivaldiWindowId;d.ZP.openUrls(s,n,{...(0,nl.Z)(s,{ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey})})};onFilterChange=(e,t=Aa.Z)=>{let n=[],s=[];if(W3.ZP.hasNotes())if(e.length>0){let t=e.toLowerCase();const i={};if(t.startsWith("url:")?(t=t.substring(4),i.url=t.length>0,i.content=!1):t.startsWith("content:")&&(t=t.substring(8),i.url=!1,i.content=t.length>0),"."===t&&(i.url=!1),"tree"===this.refTreeList.current?.getSearchStyle()){const e=W3.ZP.getFilteredTree(t,i);n=e.nodes,s=e.collapsed}else n=W3.ZP.getFilteredFlat(t,i)}else n=W3.ZP.getRootNode().children;this.setState({nodes:n,populated:!0,cutIds:W3.ZP.getCutIds()},(()=>{t(s)}))};_onStoreChange=(e,t)=>{this._isAdding&&"added"===e.reason||this.onFilterChange(this.props.filter,(()=>{"removed"!==e.reason&&"moved"!==e.reason||this.refTreeList.current?.pruneExpandModel(),this.props.onStoreChange(e,Boolean(t))}))};_onBadgeChanged=(e,t)=>{this.setState({showBadge:Boolean(t)})};hasChildren=e=>"note"!==e.type&&!!e.children&&e.children.length>0;handleExpandClick=(e,t)=>{const n=e.altKey;this.refTreeList.current?.toggleSelectedExpansion(t,n)};unSelectAll=()=>{this.refTreeList.current?.unSelectAll()};getSelectedItem=()=>this.refTreeList.current?.getSelectedItem();expandAll=()=>{this.refTreeList.current?.expandAll()};collapseAll=()=>{this.refTreeList.current?.collapseAll()};setSearchStyle=e=>{this.refTreeList.current?.setSearchStyle(e)};onSearchStyleChanged=e=>{this.props.filter&&this.onFilterChange(this.props.filter,(t=>{"tree"===e&&this.refTreeList.current?.expandAllExcept(t)}))};isValidForClipboard=e=>!this.isTrashCan(e);isValidDragSource=e=>!this.isTrashCan(e);isValidAddTarget=e=>!this.isTrashed(e);isTrashed=e=>!!e&&(!!this.isTrashCan(e)||!!e.parentId&&this.isTrashed(this.refTreeList.current?.findTreeItem(e.parentId)));onAddFolder=()=>{const e={title:(0,Oe.Z)("title","New Folder")};this.refTreeList.current?.onAdd("folder",e)};onAddNote=e=>{this.refTreeList.current?.onAdd("item",e)};selectById=e=>{this.refTreeList.current?.expandToId(e),this.refTreeList.current?.selectById(e)};onDrop=(e,t,n)=>{const s=e.dataTransfer.getData("text/plain");if(s.length>0){const e=this.getTargetSpec(t,n),i={id:"",content:s,title:"",type:"note"};return this.onCreate([i],e.parentId,e.index,!0)}return Promise.resolve()};getTargetSpec=(e,t)=>{const n={index:0,parentId:void 0,pageIndex:void 0};if(this.isTrashCan(e)&&"on"!==t){const e=W3.ZP.getLastTopNode();e?(n.parentId=e.parentId,n.index=(e.index||0)+1):n.parentId=W3.ZP.getRootNode().id}else if(this.isFolder(e)&&"on"===t)n.parentId=e.id;else{Boolean(this.refTreeList.current?.isExpanded(e.id))&&"below"===t?n.parentId=e.id:(n.parentId=e.parentId,n.index=(e.index||0)+("below"===t?1:0))}return n};buildNode=(e,t)=>({...t,type:"item"===e?"note":e});onCreate=async(e,t,n,s)=>{const i=void 0===e[0].children;this.props.onBeforeCreate(i),this._isAdding=!0;const o=await Nn.Z.createNotesFromTreeNodes(e,t||"",n);this._isAdding=!1,o.length>0&&this._onStoreChange({reason:"added",id:o[0].id},!0)};onMove=async(e,t,n)=>{if("number"!=typeof t.index)return[];const s=t.index,i=t.parentId??"",o=W3.ZP.validateForDrag(e);let a=0;for(let e=0;e<o.length;e++){const t=o[e],n=W3.ZP.getNodeById(t),r=n?.index??-1;if(!(r<0)){if(0===e)a=s;else{const e=i!==n?.parentId;a+=r<s&&!e?0:1}await C.Z.notes.move(t,{parentId:i,index:a})}}return[]};getText=()=>new Promise((e=>{const t=ie.ZP.getActivePage(this.context.vivaldiWindowId);t?C.Z.utilities.getSelectedText(t.id,e):e("")}));getMenuCapability=async(e,t,n)=>{const s=this.context.vivaldiWindowId,i={inManager:this.isInManager()};switch(e.action){case"CONTEXT_OPEN_ADDRESS":{const o=n?.url;return{handler:()=>!!o&&d.ZP.openUrls(s,[o],{inNewWindow:!1,inCurrent:!1,inBackground:H.Z.get($.kTabsOpenNewInBackground)}),isVisible:()=>!!o,...t(s,e,i)}}case"CONTEXT_CONTAINER_OPEN_IN_WINDOW":{const i=n?.url,o=await Kr.getMenu(s,!0,[i||""]);return{isVisible:()=>!!i&&o.length>0,items:o,...t(s,e,{})}}case"CONTEXT_NEW_FROM_SELECTION":return this.getText().then((n=>{const o=ie.ZP.getActivePage(s),a=o?.url??"";return{isVisible:()=>!!n&&!!o,handler:()=>{this.refTreeList.current?.onAdd("item",{content:n,url:a})},...t(s,e,i)}}));case"CONTEXT_EDIT":return{handler:()=>B6(this.context.vivaldiWindowId,n),isVisible:()=>Boolean(n)&&!this.isTrashCan(n),...t(s,e,i)};case"CONTEXT_EMPTY_TRASH":return{handler:()=>Nn.Z.emptyTrash(),isVisible:()=>Boolean(n)&&this.isTrashCan(n),...t(s,e,i)};default:return{...t(s,e,i)}}};getMenuVisibility=(e,t)=>{if(t)if(this.isTrashCan(t))switch(e.action){case"CONTEXT_EXPAND_ALL":case"CONTEXT_COLLAPSE_ALL":case"CONTEXT_CONTAINER_SEARCH":return!0;default:return!1}else{const n=this.isTrashCan(t)||W3.ZP.isSeparator(t);switch(e.action){case"CONTEXT_NEW_ITEM":case"CONTEXT_NEW_FOLDER":case"CONTEXT_CUT":case"CONTEXT_COPY":case"CONTEXT_PASTE":case"CONTEXT_DELETE":return!this.isTrashCan(t);case"CONTEXT_NEW_SEPARATOR":return!this.isTrashCan(t)&&this.props.sorting.sortOrder===Xi.Z.NO_SORTING;case"CONTEXT_RENAME":return!n;case"CONTEXT_EXPAND_ALL":case"CONTEXT_COLLAPSE_ALL":case"CONTEXT_CONTAINER_SEARCH":return!0;default:return!1}}else switch(e.action){case"CONTEXT_NEW_ITEM":case"CONTEXT_NEW_FOLDER":case"CONTEXT_PASTE":case"CONTEXT_EXPAND_ALL":case"CONTEXT_COLLAPSE_ALL":case"CONTEXT_CONTAINER_SEARCH":return!0;case"CONTEXT_NEW_SEPARATOR":return this.props.sorting.sortOrder===Xi.Z.NO_SORTING;default:return!1}};onContextMenu=e=>{this.refTreeList.current?.onContextMenu(e)};getDropSupport=(e,t)=>{const n={available:!1,onto:!1,edge:"both"};return n.available=t.dataTransfer.types.some((e=>Ds.ZP.isUriListType(e)||"text/plain"===e||e===W3.d0)),n.available&&(n.onto=this.isFolder(e)),n};saveTitle=(e,t)=>{C.Z.notes.update(e,{title:t})};handleCut=(e,t)=>{const n=t.filter(this.isValidForClipboard),s=n.map((e=>e.id));(0,to.ZP)(e),Nn.Z.setClipboard(e,n,!0),Nn.Z.setCutIds(s)};handleCopy=(e,t)=>{(0,to.ZP)(e),Nn.Z.setClipboard(e,t.filter(this.isValidForClipboard),!1)};renderTitleRow=e=>{const t=e.node,n=e.level,s=(n+1)*mo+"px",i=n*mo+"px",o=this.isFolder(t);return R6("label",{},t.id,o&&this.hasChildren(t)&&R6("span",{className:"expand-icon",style:{marginLeft:i},onMouseDown:to.ZP,onMouseUp:e=>this.handleExpandClick(e,t.id),dangerouslySetInnerHTML:{__html:Ts.nfH}}),o&&R6(Ps,{trash:this.isTrashCan(t),open:e.isExpanded,leftMargin:this.hasChildren(t)?0:s}),!o&&!t.url&&R6("span",{style:{marginLeft:s},className:"tree-icon",dangerouslySetInnerHTML:{__html:Ts.zKr}}),!o&&!!t.url&&R6("span",{style:{marginLeft:s},className:"tree-icon",dangerouslySetInnerHTML:{__html:Ts.NwZ}}),void 0!==e.inlineEditText&&R6("input",{type:"text",value:e.inlineEditText,onChange:e.onChange,onFocus:e.onFocus,onBlur:e.onBlur,autoFocus:!0}),void 0===e.inlineEditText&&R6("span",{className:"title",title:E6(t)},void 0,E6(t)),e.showBadge&&!this.props.fullView&&this.hasChildren(t)&&R6("span",{className:"item-count"},void 0,t.children?.length))};getRowComponentProps=e=>({...e,childCount:e.node.children&&"note"!==e.node.type?e.node.children.length:0,columns:this.props.columns,showBadge:this.state.showBadge});rowComponent=e=>{const t=e.node,n=e.level,s=W3.ZP.isSeparator(t),i=this.isFolder(t),o=(n+1)*mo+"px",{columns:a}=e,r=[];return s?r.push(R6("label",{"data-parent":t.parentId},`${t.id}__separator__${r.length}`,R6("hr",{style:{marginLeft:o},className:"separator"}))):this.props.fullView?(a||[]).map((n=>{switch(n.id){case"title":r.push(this.renderTitleRow(e));break;case"url":r.push(R6("label",{},n.id,R6("span",{},void 0,t.url)));break;case"content":r.push(R6("label",{},n.id,!i&&R6("span",{},void 0,t.content),i&&t.children&&t.children.length>0&&R6("span",{className:"secondary"},void 0,(0,Oe.Z)("$1 item","$1 items",[t.children.length]))));break;case"attachments":r.push(R6("label",{className:"right-aligned"},n.id,R6("span",{},void 0,"note"===t.type&&t.children&&t.children.length>0?t.children.length:"")));break;case"dateAdded":r.push(R6("label",{className:"right-aligned"},n.id,!i&&R6("span",{},void 0,N()(t.dateAdded).format("ll"))))}})):r.push(this.renderTitleRow(e)),r};menu={name:"noteslist",getCapability:this.getMenuCapability,getVisibility:this.getMenuVisibility};render(){if(!this.state.populated&&!this.props.filter)return null;const e=W3.ZP.getRootNode().id;return(0,fs.jsx)(yo,{ref:this.refTreeList,rowComponent:this.rowComponent,getRowComponentProps:this.getRowComponentProps,nodes:this.state.nodes,cutIds:this.state.cutIds,settings:this.props.settings,rootId:e,buildItem:this.buildNode,onSelect:this.props.onItemSelected,onItemDoubleClick:this.onItemDoubleClick,onItemMouseDown:this.onItemMouseDown,onItemMouseUp:this.onItemMouseUp,onItemsActivated:this.onNodesActivated,onCreate:this.onCreate,onSearchStyleChanged:this.onSearchStyleChanged,delete:this.delete,onMove:this.onMove,onDrop:this.onDrop,onCut:this.handleCut,onCopy:this.handleCopy,supportsInlineEdit:!0,mimeType:W3.d0,getDropSupport:this.getDropSupport,getDragData:W3.ZP.getDragData.bind(W3.ZP),isFolder:this.isFolder,isSeparator:W3.ZP.isSeparator,hasChildren:this.hasChildren,menu:this.menu,setCutIds:Nn.Z.setCutIds,getTitle:W3.ZP.getTitle,saveTitle:this.saveTitle,getTargetSpec:this.getTargetSpec,isValidAddTarget:this.isValidAddTarget,isValidDragSource:this.isValidDragSource,isValidToEdit:W3.ZP.validateForEdit,validateForDrag:W3.ZP.validateForDrag,validateForDeletion:W3.ZP.validateForDeletion,sorting:this.props.sorting,columns:this.props.columns})}}const V6=F6;var W6,U6;function H6(e,t,n,s){W6||(W6="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:W6,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function z6({onAddNote:e}){return H6("div",{className:"notes-welcome"},void 0,H6("div",{className:"note-empty-state",onClick:e},void 0,H6("span",{dangerouslySetInnerHTML:{__html:Ts.SXC}}),H6("h1",{},void 0,(0,Oe.Z)("Write your first note")),H6("p",{className:"faded-text"},void 0,(0,Oe.Z)("Click the “+” to create a new note, or select text on any webpage and create a note from the contextual menu."))))}function G6(e,t,n,s){U6||(U6="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:U6,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class $6 extends hs.PureComponent{refSearch=hs.createRef();focusSearch(){this.refSearch.current&&this.refSearch.current.focus()}render(){const{editorLayout:e,filter:t,onFilterValueChange:n,onAddNote:s,onDeleteSelectedItems:i,onAddFolder:o,onSetLayout:a,isDeleteDisabled:r}=this.props;return G6("div",{className:"toolbar toolbar-default toolbar-small toolbar-wrap"},void 0,(0,fs.jsx)("input",{ref:this.refSearch,type:"search",className:"notesearch",placeholder:(0,Oe.Z)("verb","Search"),value:t,title:(0,Oe.Z)("Limit the search to address or content by $1 or $2",["URL:","CONTENT:"]),disabled:!this.props.hasNotes,onChange:({currentTarget:e})=>n(e.value)}),G6("div",{className:"toolbar",style:e?{flexGrow:1}:{}},void 0,G6("div",{className:"toolbar-group"},void 0,G6(Fa,{onClick:s,tooltip:(0,Oe.Z)("New Note"),image:Ts.md4.small}),G6(Fa,{onClick:i,tooltip:(0,Oe.Z)("other","Delete"),image:Ts.M2k.small,disabled:r})),G6("div",{className:"toolbar-group"},void 0,G6(Fa,{onClick:o,image:Ts._TQ.small,tooltip:(0,Oe.Z)("command","New Folder")})),e&&G6(Fa,{className:"layout-toggle push-right",onClick:a,image:"vertical"===e?Ts.Q_G.small:Ts.s2Z.small,tooltip:(0,Oe.Z)("command","Toggle Layout")})))}}var K6,j6=n(34155);function Y6(e,t,n,s){K6||(K6="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:K6,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const X6=[{text:(0,Oe.Z)("Title"),value:"title",fullScreenTitle:(0,Oe.Z)("Sort by title"),width:300,visible:!0,key:!0},{text:(0,Oe.Z)("Content"),value:"content",icon:Ts.sWI,fullScreenTitle:(0,Oe.Z)("Sort by content"),width:300,visible:!1},{text:(0,Oe.Z)("Address"),value:"url",icon:Ts.iD7,fullScreenTitle:(0,Oe.Z)("Sort by address"),width:300,visible:!0},{text:(0,Oe.Z)("Date Created"),value:"dateAdded",icon:Ts.V_c,fullScreenTitle:(0,Oe.Z)("Sort by creation date"),width:120,visible:!0},{text:(0,Oe.Z)("Attachments"),value:"attachments",icon:Ts.onv,fullScreenTitle:(0,Oe.Z)("Sort by attachments"),width:60,visible:!0}],Q6=(0,no.Z)(q6,W3.mS,{trailing:!0,leading:!1});function q6({id:e,changes:t}){return new Promise(((n,i)=>{C.Z.notes.update(e,t,(()=>s.Z.runtime.lastError?i(s.Z.runtime.lastError):n()))}))}class J6 extends hs.PureComponent{static contextType=xi.Z;refBody=hs.createRef();_tree=hs.createRef();_treeWrapper=hs.createRef();constructor(e,t){super(e),this.winId=t.vivaldiWindowId;const n=H.Z.get($.kNotesManagerSorting),s=H.Z.get($.kNotesManagerLayout),i="horizontal"===s?"notes":"notes_vertical";this.state={filter:"",note:void 0,markdownScrollPosition:0,editorScrollPosition:0,isAttachmentPopupOpen:!1,editorCursorPosition:0,editorLayout:s,editLinkModal:!1,treeViewSize:"vertical"===s?H.Z.get($.kNotesManagerTreeWidth):H.Z.get($.kNotesManagerTreeHeight),sorting:{sortOrder:n.sortOrder,sortField:n.sortField,comparator:this.sortComparator},columns:io()[i]||oo(X6),showWelcome:!W3.ZP.hasNotes()}}componentDidMount(){const{selectWindow:e}=this.context;ie.ZP.addListener(this._onPageStoreChange,e),this.props.id&&"-1"!==this.props.id&&j6.nextTick((()=>{this.selectById(this.props.id)}))}componentWillUnmount(){ie.ZP.removeListener(this._onPageStoreChange)}_onPageStoreChange=()=>{const e=ie.ZP.getActivePage(this.context.vivaldiWindowId);if(e&&e.id===this.props.pageId)j6.nextTick((()=>{if(this.state.note){this.state.note.id!==this.props.id&&this.selectById(this.props.id);const e=E6(this.state.note);d.ZP.setTitle(this.props.pageId,this.winId,e)}this.refBody.current?.setActiveWebView()}));else{const e=this.refBody.current;e&&j6.nextTick(e.clearActiveWebViews)}};_onStoreChange=(e,t)=>{switch(e.reason){case"added":{if(this.setState({showWelcome:!1}),!t)return;const n=W3.ZP.getNodeById(e.id);return void this.setState({note:n},(()=>{if(n&&!W3.ZP.isSeparator(n))if(this.selectById(n.id),W3.ZP.isFolder(n)){const e=this._tree.current?.refTreeList.current;e?.startInlineEditForSelectedItem()}else this.refBody.current&&this.refBody.current.focus()}))}case"moved":e.id===this.state.note?.id&&this._tree?.current?.selectById(e.id);break;case"removed":e.id===this.state.note?.id&&this._tree?.current?.selectById(""),this.setState({showWelcome:!W3.ZP.hasNotes()});break;case"changed":if(!this.state.note||this.state.note.id!==e.id)return;this.setState({note:W3.ZP.getNodeById(this.props.id)});break;case"init":this.selectById(this.props.id),this.setState({note:W3.ZP.getNodeById(this.props.id),showWelcome:!W3.ZP.hasNotes()})}};selectById=e=>{this._tree.current?.selectById(e)};sortComparator=(e,t)=>{if("trash"===e.type)return 1;if("trash"===t.type)return-1;if(W3.ZP.isFolder(e)&&!W3.ZP.isFolder(t))return-1;if(W3.ZP.isFolder(t)&&!W3.ZP.isFolder(e))return 1;const{sortOrder:n,sortField:s}=this.state.sorting;if("title"===s)return this.sortByTitle(e,t,n);return Xi.Z.getDefaultComparator(n,s)(e,t)};sortByTitle=(e,t,n)=>{if(n<=Xi.Z.NO_SORTING)return 0;const s=e.title||E6(e),i=t.title||E6(t);return s||i?s?i?n===Xi.Z.ASCENDING_SORT?s.toLowerCase().localeCompare(i.toLowerCase()):i.toLowerCase().localeCompare(s.toLowerCase()):n===Xi.Z.ASCENDING_SORT?-1:1:n===Xi.Z.ASCENDING_SORT?1:-1:0};onSortChange=(e,t)=>{this.setState((n=>({sorting:{...n.sorting,sortOrder:e,sortField:t}}))),Ne.Z.set($.kNotesManagerSorting,{sortOrder:e,sortField:t})};onUpdateRow=e=>{this.setState({columns:e})};onSaveRow=()=>{so(this.state.columns,"horizontal"===this.state.editorLayout?"notes":"notes_vertical")};onItemSelected=(0,no.Z)((e=>{if(!e&&!this.state.note)return;this.setState({note:e,markdownScrollPosition:0,editorScrollPosition:0,isAttachmentPopupOpen:!1,editorCursorPosition:0});const t=e?.id||"";d.ZP.openURL(this.context.vivaldiWindowId,je.jk.internalUrl("notes",t),{inSpecificPageId:this.props.pageId})}),200);handleFilterChange=e=>{this.setState({filter:e})};onBeforeCreate=e=>{this.setState({filter:""})};onAddNote=()=>{this.refBody.current?.blur(),this._tree.current?.onAddNote()};onAddFolder=()=>{this._tree.current?.onAddFolder()};onDeleteSelectedItems=()=>{this.refBody.current?.blur(),this._tree.current?.deleteSelectedItems()};toggleFullEditor=()=>{this.setState((e=>{const t="vertical"===e.editorLayout?$.kNotesManagerTreeWidth:$.kNotesManagerTreeHeight;let n;return 0!==e.treeViewSize?(this.restoreSize=e.treeViewSize,n=0):n=this.restoreSize??H.Z.getDefault(t),Ne.Z.set(t,n),{treeViewSize:n}}))};onSlidebarPosition=(e,t)=>{if(!this._treeWrapper.current)return;const n=this._treeWrapper.current.getBoundingClientRect(),{width:s,height:i,top:o,left:a}=n,r="vertical"===this.state.editorLayout?(e-a)/s:(t-o)/i;this.setState((e=>({treeViewSize:Math.max(100*r,0)})))};onSlidebarStop=()=>{this.setState((e=>{const t="horizontal"===e.editorLayout?$.kNotesManagerTreeHeight:$.kNotesManagerTreeWidth,n=e.treeViewSize>5?e.treeViewSize:0;return Ne.Z.set(t,n),{treeViewSize:n}}))};updateNoteContent=(e,t)=>{this.setState((t=>t.note?{note:{...t.note,content:e}}:null),t),this.state.note&&Q6({id:this.state.note.id,changes:{content:e}})};onSaveLink=e=>{const{note:t}=this.state;t&&q6({id:t.id,changes:{url:e}}),this.setState({editLinkModal:!1})};onCancelEditLink=()=>this.setState({editLinkModal:!1});onEditLink=()=>this.setState({editLinkModal:!0});toggleManagerLayout=()=>this.setState((e=>{const t="horizontal"===e.editorLayout?"vertical":"horizontal",n="horizontal"===t?H.Z.get($.kNotesManagerTreeHeight):H.Z.get($.kNotesManagerTreeWidth),s="horizontal"===t?"notes":"notes_vertical";return Ne.Z.set($.kNotesManagerLayout,t),{editorLayout:t,treeViewSize:n,columns:io()[s]||oo(X6)}}));render(){const{note:e,editorLayout:t,showWelcome:n}=this.state,s=!!e&&W3.ZP.isFolder(e),i=e&&!s,o=!i&&!n;return(0,fs.jsxs)("div",{ref:this._treeWrapper,className:As()({"NotesManager manager":!0,"NotesManager--Horizontal":"horizontal"===t,"NotesManager--Vertical":"vertical"===t}),children:[this.state.editLinkModal&&Y6(EA,{onCreateLink:this.onSaveLink,onCancelCreateLink:this.onCancelEditLink,anchorOrSelection:e?.url??"",isAnchor:!0,useAddress:!0}),Y6("div",{className:As()({"NotesManager-Tree":!0,"NotesManager-Tree--Collapsed":0===this.state.treeViewSize}),style:{flexBasis:`${this.state.treeViewSize}%`}},void 0,Y6($6,{filter:this.state.filter,onFilterValueChange:this.handleFilterChange,onAddNote:this.onAddNote,onAddFolder:this.onAddFolder,onDeleteSelectedItems:this.onDeleteSelectedItems,onSetLayout:this.toggleManagerLayout,editorLayout:t,isDeleteDisabled:!this.state.note,hasNotes:W3.ZP.hasNotes()}),Y6("div",{className:"NotesManager-Tree-Container"},void 0,Y6(gv,{fields:X6,onSortChange:this.onSortChange,fullsize:!0,sortField:this.state.sorting.sortField,sortOrder:this.state.sorting.sortOrder,columns:this.state.columns,onUpdateRow:this.onUpdateRow,onSaveRow:this.onSaveRow,keyAccess:H.Z.get($.kKeyboardTabToAll),manualSorting:!0},this.state.editorLayout),(0,fs.jsx)(V6,{ref:this._tree,settings:`NOTES_MANAGER_TREE_${this.props.pageId}`,filter:this.state.filter,sorting:this.state.sorting,onItemSelected:this.onItemSelected,onStoreChange:this._onStoreChange,onBeforeCreate:this.onBeforeCreate,editLink:this.onEditLink,columns:this.state.columns,noteId:this.state.note?this.state.note.id:"-1",pageId:this.props.pageId,fullView:!0}))),n&&Y6(z6,{onAddNote:this.onAddNote}),Y6("div",{className:o?"NotesManager-EmptyPlaceholder":"NotesManager-Note",onClick:o?this.onAddNote:null},void 0,Y6(lv,{onSlidebarPosition:this.onSlidebarPosition,onStop:this.onSlidebarStop,onDoubleClick:this.toggleFullEditor,position:"vertical"===t?"right":"bottom"}),i&&(0,fs.jsx)(L6,{ref:this.refBody,inFullView:this.state.treeViewSize>0,note:this.state.note,pageId:this.props.pageId,isFolder:s,toggleFullEditor:this.toggleFullEditor,updateNoteContent:this.updateNoteContent,isActive:this.props.isActive}),o&&(0,Oe.Z)("Add a new note"))]})}}var e7;function t7(e,t,n,s){e7||(e7="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:e7,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class n7 extends hs.Component{static contextType=xi.Z;nodeRef=hs.createRef();constructor(e){super(e),this.state={suggestions:[]}}componentDidMount(){this.updateSuggestions()}updateSuggestions(){if(!G.ZP.isIncognitoOrGuest(this.context.vivaldiWindowId)){const e=ps.ZP.getSpeeddialFolders()[0].children,t=[];e.forEach((e=>{e.url?t.push(e.url):e.children.forEach((e=>{t.push(e.url)}))})),s.Z.topSites.get((e=>{const n=e.filter((e=>!t.includes(e.url)));this.setState({suggestions:n})}))}}keyDownHandler=(e,t)=>{switch(t.key){case"ArrowLeft":this.moveFocus(e,"left",!1);break;case"ArrowRight":this.moveFocus(e,"right",!1);break;case"ArrowUp":this.moveFocus(e,"up",!1);break;case"ArrowDown":this.moveFocus(e,"down",!1);break;default:return}t.preventDefault(),t.stopPropagation()};mouseBlockHandler=e=>{e.preventDefault()};moveFocus=(e,t,n)=>{const{document:s,HTMLElement:i}=this.context,o=this.nodeRef.current;if(o instanceof i&&(!0===n||sl(s,o))){const n=Array.from(o.querySelectorAll("button.dial")),s=n.map((e=>e.getAttribute("data-id"))).filter(Boolean);if(0===s.length||s.length!==n.length)return!1;let i,a=0,r=-1;switch(n.forEach((e=>{const t=e.getBoundingClientRect();r<t.left&&(a++,r=t.left)})),t){case"current":if(""===e||"first"===e?e=s[0]:"last"===e&&(e=s[0===this.props.keyAccess?s.length-1:0]),i=s.indexOf(e),-1===i)return!1;break;case"left":case"right":if(1===s.length)return!1;if(i=s.indexOf(e),-1===i)return!1;if("right"===t){if((i+1)%a==0)return!1;if(i+=1,i>=s.length)return!1}else{if(i%a==0)return!1;if(i-=1,i>=s.length)return!1}break;case"up":case"down":if(1===s.length)return!1;if(i=s.indexOf(e),-1===i)return!1;if("up"===t){if(i-=a,i<0)return!1}else if(i+=a,i>=s.length)return!1;break;default:return!1}e=s[i];const l=o.querySelector(`button.dial[data-id="${e}"]`);if(l)return l.focus(),!0}return!1};addSpeedDial(e,t){if(this.props.node){const n={parentId:this.props.node.id,title:e,url:(0,vs.q9)(t)};this.props.onSpeedDialDrawerDone(n)}else this.props.onSpeedDialDrawerDone()}closeDrawer=()=>{this.props.onSpeedDialDrawerDone()};render(){const e=2*Math.floor((this.props.width-36)/90),t=G.ZP.isIncognito(this.context.vivaldiWindowId),{suggestions:n}=this.state;return(0,fs.jsxs)("section",{ref:this.nodeRef,className:"drawer-suggestions",children:[t7("header",{},void 0,t7("h2",{},void 0,(0,Oe.Z)("Suggestions")),t7("button",{className:"close",tabIndex:"-1",dangerouslySetInnerHTML:{__html:Ts.kze},onClick:this.closeDrawer})),t&&t7("p",{},void 0,(0,Oe.Z)("Suggestions are not available in private window.")),!t&&t7("div",{className:"dials dial-suggestions",style:n.length>0?{display:"grid",gridTemplateColumns:"repeat(auto-fit, 90px)",gridTemplateRows:"repeat(2, 64px)"}:null},void 0,n.length>0?n.slice(0,e).map(((e,t)=>{const n=t.toString();return t7("button",{className:"dial",tabIndex:0===t?"0":this.props.keyAccess,"data-id":n,title:e.title+"\n"+e.url,onMouseDown:this.mouseBlockHandler,onMouseUp:this.mouseBlockHandler,onKeyDown:this.keyDownHandler.bind(this,n),onClick:this.addSpeedDial.bind(this,e.title,e.url),"data-dialurl":e.url},t,t7("div",{className:"dial-image suggest-thumbnail-image"},void 0,t7(Ss,{url:e.url,size:32,loadType:"page"})),t7("div",{className:"dial-title"},void 0,e.title))})):t7("p",{},void 0,(0,Oe.Z)("No history to choose from yet.")))]})}}const s7=n7;var i7;function o7(e,t,n,s){i7||(i7="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:i7,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function a7(e){const t=e.trim();return!!(0,vs.K2)((0,vs.q9)(t))||!(0,vs.Zj)(t)}class r7 extends hs.Component{_id=crypto.randomUUID();_pageContext={};state={addSpeedDialTitle:"",editUrl:"",isSpeedDialURLValid:!1};componentDidMount(){yy.addListener(this._onUrlFieldStoreChanged,(e=>e.get(this._id)))}componentWillUnmount(){yy.removeListener(this._onUrlFieldStoreChanged),py.Z.reset(this._id)}_onUrlFieldStoreChanged=()=>{const{autocompleteValue:e,typedUrl:t}=yy.getUrlfieldState(this._id),n=e||t||"";this.setState({editUrl:t,isSpeedDialURLValid:a7(n)})};addSpeedDialFolder=e=>{if(this.props.node){const e={parentId:this.props.node.id,title:this.state.addSpeedDialTitle||(0,Oe.Z)("title","New Folder")};this.props.onSpeedDialDrawerDone(e)}};updateSpeedDialTitle=e=>{this.setState({addSpeedDialTitle:e.currentTarget.value})};drawerSubmitHandler=e=>{e.stopPropagation(),e.preventDefault();const{autocompleteValue:t}=yy.getUrlfieldState(this._id);let n=(t||this.state.editUrl||"").trim();if(0===n.length)return;n=(0,vs.q9)(n);const s=this.state.addSpeedDialTitle||n;this.addSpeedDial(s,n)};addSpeedDial(e,t){if(this.props.node&&this.props.node.id){const n={parentId:this.props.node.id,title:e,url:(0,vs.q9)(t),thumbnail:void 0};py.Z.reset(this._id),this.props.onSpeedDialDrawerDone(n)}}focusUrlField=()=>{(0,cy.x0)(this.context)};render(){return o7(da.Z,{focusName:"focus-startpage-drawer",forceTrap:!0,style:{display:"contents"}},void 0,o7("aside",{className:"startpage-drawer"},"drawer",o7("section",{className:"drawer-adddial",style:{width:400}},void 0,o7("header",{},void 0,o7("h2",{},void 0,(0,Oe.Z)("Add Bookmark to Speed Dial"))),o7("form",{className:"drawer-addform",onSubmit:this.drawerSubmitHandler},void 0,o7("span",{},void 0,(0,Oe.Z)("Address")),o7(pw,{pageId:this._id,pageContext:this._pageContext,autoFocus:!0,autocompletionEnabled:!0,typedHistoryEnabled:!1,className:"address",displayUrl:"",typedUrl:this.state.editUrl,handleDrop:!0,title:(0,Oe.Z)("Enter page address"),showDropdown:!1,placeholder:"https://vivaldi.com",inputId:this._id}),o7("span",{},void 0,(0,Oe.Z)("Title")),o7("input",{type:"text",name:"title",className:"title",value:this.state.addSpeedDialTitle,onChange:this.updateSpeedDialTitle}),o7("span",{className:"controls"},void 0,o7("input",{className:"add-dial-submit primary",type:"submit",disabled:!this.state.isSpeedDialURLValid,value:(0,Oe.Z)("Add")}),o7("button",{type:"button",className:"FormButton",onClick:this.addSpeedDialFolder,dangerouslySetInnerHTML:{__html:Ts._TQ.medium+(0,Oe.Z)("command","New Folder")}})))),o7(s7,{width:this.props.maxWidth-400,onSpeedDialDrawerDone:this.props.onSpeedDialDrawerDone,onHandoverFocus:this.focusUrlField,keyAccess:this.props.keyAccess,node:this.props.node})))}}const l7=r7;var d7,c7=n(34844);function h7(e,t,n,s){d7||(d7="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:d7,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var p7,u7=h7(c2,{src:"",isFolder:!0});function g7(e){const{bookmark:t}=e,n=Array.isArray(t.children)&&0===t.children.length,s=Boolean(t.thumbnail);return h7("div",{className:As()("thumbnail-image",{"drop-hover":e.canDrop}),title:t.url,onPointerEnter:e.onPointerEnter,onPointerLeave:e.onPointerLeave,onPointerDown:e.onPointerDown,onPointerUp:e.onPointerUp,onPointerCancel:e.onPointerCancel,onDoubleClick:to.ZP,onDragOver:e.onDragOver,onDragLeave:e.onDragLeave,onDrop:e.onDrop},t.id,n&&!s&&u7,!n&&!s&&h7("div",{className:"preview"},void 0,function(e,t){const{children:n=[]}=e,s=[];for(let i=0;i<Math.min(n.length,4);i++){const o=n[i];s.push(h7(c2,{src:o.thumbnail?o.thumbnail:"",className:"Mini-Thumbnail",onImageLoadError:t,isFolder:!!o.children},`thumb__${e.id}__${i}`))}return s}(t,e.onImageLoadError)),s&&h7(c2,{className:"thumbnail-folder-image",src:t.thumbnail,onImageLoadError:e.onImageLoadError}))}function m7(e,t,n,s){p7||(p7="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:p7,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var v7=m7(c2,{src:"",isFolder:!0});function f7(e){const{bookmark:t}=e,n=Boolean(t.children);return"icon"===e.speedDialSize?n?m7("div",{className:As()("thumbnail-favicon-folder",{"drop-hover":e.canDrop}),title:t.url,onPointerEnter:e.onPointerEnter,onPointerLeave:e.onPointerLeave,onPointerDown:e.onPointerDown,onPointerUp:e.onPointerUp,onPointerCancel:e.onPointerCancel,onDoubleClick:to.ZP,onDragOver:e.onDragOver,onDragLeave:e.onDragLeave,onDrop:e.onDrop},t.id,t.children&&0===t.children.length?v7:function(e,t=[]){const n=[];for(let s=0;s<Math.min(t.length,4);s++){const i=t[s],{url:o=""}=i;n.push(m7(Ss,{className:"favicon",url:i.faviconUrl||je.jk.getFavicon(o)||o,loadType:i.faviconUrl?"faviconFromCache":"page"},`thumb__${e}__${s}`))}return n}(t.id,t.children)):m7("div",{className:"thumbnail-favicon",onPointerEnter:e.onPointerEnter,onPointerLeave:e.onPointerLeave,onPointerDown:e.onPointerDown,onPointerUp:e.onPointerUp},void 0,m7(Ss,{className:"favicon",url:e.faviconUrl,loadType:e.faviconLoadType,size:32})):n?m7(g7,{bookmark:t,canDrop:e.canDrop,onPointerEnter:e.onPointerEnter,onPointerLeave:e.onPointerLeave,onPointerDown:e.onPointerDown,onPointerUp:e.onPointerUp,onImageLoadError:e.onImageLoadError,onPointerCancel:e.onPointerCancel,onDragOver:e.onDragOver,onDragLeave:e.onDragLeave,onDrop:e.onDrop}):m7(c2,{onPointerEnter:e.onPointerEnter,onPointerLeave:e.onPointerLeave,onPointerDown:e.onPointerDown,onPointerUp:e.onPointerUp,src:t.thumbnail,title:t.title?t.title:t.url?C.Z.utilities.urlToThumbnailText(t.url):"",backgroundColor:t.themeColor||void 0,onImageLoadError:e.onImageLoadError},t.id)}var y7,C7=n(34155);function w7(e,t,n,s){y7||(y7="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:y7,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class b7 extends hs.PureComponent{static contextType=xi.Z;bookmarkActions=this.props.bookmarkActions||g.Z;nodeRef=hs.createRef();refInput=hs.createRef();state={isEditing:this.props.needsInitialEdit,title:this.props.bookmark.title,fallbackTitle:this.props.bookmark.title};componentDidMount(){this.state.isEditing&&this._focusInput()}componentDidUpdate(e,t){!1===e.needsInitialEdit&&!0===this.props.needsInitialEdit&&!1===this.state.isEditing&&this.enableEditing(),!1===t.isEditing&&!0===this.state.isEditing&&this._focusInput()}_documentClickHandler=e=>{const t=this.nodeRef.current,n=e.target,{document:s,HTMLElement:i}=this.context;t&&n instanceof i&&!t.contains(n)?this.refInput.current?.blur():s.removeEventListener("click",this._documentClickHandler)};_focusInput(){const e=this.refInput.current,t=e?.value;e&&t&&(e.setSelectionRange(0,t.length),e.focus())}enableEditing(){if(!1===this.state.isEditing){const{document:e}=this.context;e.addEventListener("click",this._documentClickHandler),this.setState({isEditing:!0})}}handleClick=e=>{(0,to.ZP)(e),"click"!==this.props.howToEdit?this.props.onSelect&&this.props.onSelect(e):C7.nextTick((()=>this.enableEditing()))};handleDoubleClick=e=>{"doubleClick"===this.props.howToEdit&&this.enableEditing()};finishEdit(e){if(!1===this.state.isEditing)return;const{document:t}=this.context;t.removeEventListener("click",this._documentClickHandler),this.props.needsInitialEdit&&this.props.setSpeedDialAwaitingEdit("");const n=this.props.bookmark.id;switch(e){case"save":this.setState({isEditing:!1},(()=>{s.Z.bookmarks.update(n,{title:this.state.title}).then((()=>{this.props.onFinished&&this.props.onFinished(!1)}))}));break;case"undo":this.setState((e=>({title:e.fallbackTitle,isEditing:!1})),(()=>{s.Z.bookmarks.update(n,{title:this.state.title}).then((()=>{this.props.onFinished&&this.props.onFinished(!1)}))}));break;case"delete":this.setState({isEditing:!1},(()=>{this.props.onFinished&&this.props.onFinished(!0),this.bookmarkActions.remove([n])}))}}handleBlur=e=>{this.finishEdit("save")};handleChange=e=>{const t=e.target.value;this.setState({title:t})};handleKeyDown=e=>{switch(e.stopPropagation(),e.key){case"Enter":this.finishEdit("save");break;case"Escape":{const e=this.props.bookmark.children??[];this.props.needsInitialEdit&&this.state.title===ps.ZP.getDefaultFolderName()&&0===e.length?this.finishEdit("delete"):this.finishEdit("undo");break}}};removeSpeedDial=()=>{s.Z.bookmarks.update(this.props.bookmark.id,{speeddial:!1})};onContextMenu=e=>{this.state.isEditing?e.stopPropagation():(e.persist(),e.preventDefault(),e.stopPropagation(),this.props.getContextMenuItemsPromise(this.props.bookmark).then((t=>{(0,Qi.Z)(this.context,t)(e)})))};render(){const e=As()({"editable-title-container":!0,edit:this.state.isEditing});return(0,fs.jsx)("span",{ref:this.nodeRef,className:e,onBlur:to.UW,onFocus:to.UW,onContextMenu:this.onContextMenu,draggable:!this.state.isEditing&&(this.props.draggable??!1),onDragEnter:this.props.onDragEnter??Aa.Z,onDragOver:this.props.onDragOver??Aa.Z,onDragStart:this.props.onDragStart??Aa.Z,onDragEnd:this.props.onDragEnd??Aa.Z,onDrop:this.props.onDrop??Aa.Z,children:this.state.isEditing?(0,fs.jsx)("input",{type:"text",ref:this.refInput,className:"sd-title-editor",value:this.state.title,onBlur:this.handleBlur,style:this.props.style,onKeyDown:this.handleKeyDown,onPointerUp:to.ZP,onChange:this.handleChange,autoFocus:!0}):w7("button",{className:this.props.className,"data-id":this.props.bookmark.id,tabIndex:this.props.keyAccess,onClick:this.handleClick,onDoubleClick:this.handleDoubleClick,onPointerUp:to.ZP,title:this.props.bookmark.title,onKeyDown:this.props.onKeyDown?this.props.onKeyDown.bind(this,this.props.bookmark.id):void 0},void 0,this.props.bookmark.title)})}}const S7=b7;var I7,k7=n(34155);function A7(e,t,n,s){I7||(I7="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:I7,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const T7=new Set;var Z7=A7(Ps,{rightMargin:0,className:"favicon"});class E7 extends hs.PureComponent{static contextType=xi.Z;nodeRef=hs.createRef();refTitle=hs.createRef();focusedElement=null;_hasClipboardListener=!1;_customThumbnail=!1;state={canDrop:!1,isHovered:!1};componentWillUnmount(){this.disableClipboardListener(),hr.unlinkBookmarkComponent(this)}isFolder(){return!this.props.node.url}isBookmark(){return!this.isFolder()}handleRemoveDial=()=>{const e=sl(this.context.document,this.nodeRef.current)?this.props.getNextFocusable(this.props.node.id):"";this.props.bookmarkActions.remove([this.props.node.id]).then((()=>{e&&this.props.moveFocus(e,"current",!1)}))};enableClipboardListener=()=>{if(this._hasClipboardListener)return;this._hasClipboardListener=!0;const{document:e}=this.context;e.addEventListener("cut",this.onCut),e.addEventListener("copy",this.onCopy),e.addEventListener("paste",this.onPaste)};disableClipboardListener=()=>{if(!this._hasClipboardListener)return;this._hasClipboardListener=!1;const{document:e}=this.context;e.removeEventListener("cut",this.onCut),e.removeEventListener("copy",this.onCopy),e.removeEventListener("paste",this.onPaste)};handleCutDial=()=>{const{document:e}=this.context,t=this._hasClipboardListener;t||e.addEventListener("cut",this.onCut),e.execCommand("cut"),t||e.removeEventListener("cut",this.onCut)};handleCopyDial=()=>{const{document:e}=this.context,t=this._hasClipboardListener;t||e.addEventListener("copy",this.onCopy),e.execCommand("copy"),t||e.removeEventListener("copy",this.onCopy)};handlePasteDial=()=>{const{document:e}=this.context,t=this._hasClipboardListener;t||e.addEventListener("paste",this.onPaste),e.execCommand("paste"),t||e.removeEventListener("paste",this.onPaste)};handleRename=()=>{this.refTitle.current?.enableEditing()};onRenameFinished=e=>{e?k7.nextTick((()=>{this.props.moveFocus("add","current",!1)})):this.props.moveFocus(this.props.node.id,"current",!1)};handleEdit=()=>{Ae.Z.showBookmarkDialog(this.context.vivaldiWindowId,{mode:"edit",id:this.props.node.id,index:-1})};handleUpdateThumbnail=()=>{this.props.node.url&&hr.updateForBookmark(this.props.node.id,this.props.node.url)};handleSetCustomThumbnail=()=>{C.Z.utilities.selectLocalImage({windowId:this.context.vivaldiWindowId,title:(0,Oe.Z)("Select Custom Image"),thumbnailBookmarkId:this.props.node.id})};handleClearCustomThumbnail=()=>{this.props.bookmarkActions.update(this.props.node.id,{thumbnail:""})};onThumbnailImageLoadError=e=>{e&&!(0,vs.Li)(e)&&C.Z.bookmarksPrivate.isCustomThumbnail(this.props.node.id,(t=>{e===this.props.node.thumbnail&&(t||T7.has(e)||(T7.add(e),this.props.node.url&&hr.updateForBookmark(this.props.node.id,this.props.node.url)))}))};openSpeedDialNodeHandler=e=>{const t=e.ctrlKey,n=this.context.vivaldiWindowId;let s=!1,i=!1;if(e.shiftKey&&!e.altKey&&t)return void cs.Z.openBrowserWindow(n,this.props.node.url,{incognito:!1,transition:C.Z.historyPrivate.TransitionType.AUTO_BOOKMARK});const o="number"==typeof e.button?e.button:Hi.Z.kNone;if(!e.shiftKey||e.altKey||t)if(e.shiftKey||e.altKey||!t){if(o===Hi.Z.kCenter)s=!0,i=!0,e.preventDefault();else if(Hi.Z.isContextMenuButton(o)||Hi.Z.isNavigationButton(o))return}else s=!0,i=!0;else s=!0;e.stopPropagation(),this.openSpeedDialNode(this.props.node,{openInBackground:i,openInNewTab:s}),c.Z.clearStatus(n)};openSpeedDialNode=(e,t)=>{this.props.openSpeedDialNode(e,t)};handleThumbnailPointerEnter=()=>{const{node:e}=this.props,{children:t}=e,n=t?(0,Oe.Z)("$1 Folder",[e.title||""]):e?je.jk.getHoverUrl(ps.ZP.getUrlByNode(e)):"";c.Z.setStatus(this.context.vivaldiWindowId,n)};handleThumbnailPointerLeave=()=>{c.Z.clearStatus(this.context.vivaldiWindowId)};handlePointerEnter=e=>{this.setState({isHovered:!0})};handlePointerLeave=e=>{this.setState({isHovered:!1})};dialPointerDownHandler=e=>{this.props.onPointerDown(this.props.node,e)};pointerDownHandler=e=>{e.button,Hi.Z.kCenter,e.button!==Hi.Z.kLeft&&e.preventDefault(),C.Z.bookmarksPrivate.isCustomThumbnail(this.props.node.id,(e=>{this._customThumbnail=e}))};pointerUpHandler=e=>{this.openSpeedDialNodeHandler(e),this.focusedElement&&setTimeout((()=>{this.focusedElement&&this.focusedElement.focus(),this.focusedElement=null}),1)};keyDownHandler=e=>{const t=e.ctrlKey||e.altKey||e.metaKey||e.shiftKey;switch(e.key){case" ":case"Enter":this.openSpeedDialNodeHandler(e);break;case"F2":this.handleRename();break;case"ArrowLeft":if(t||!this.props.moveFocus(this.props.node.id,"left",!1))return;break;case"ArrowRight":if(t||!this.props.moveFocus(this.props.node.id,"right",!1))return;break;case"ArrowUp":if(!this.props.moveFocus(this.props.node.id,"up",!1))return;break;case"ArrowDown":if(!this.props.moveFocus(this.props.node.id,"down",!1))return;break;default:return}(0,to.ZP)(e)};getContextMenuItems=(e,t)=>{const n=this.context.vivaldiWindowId,s=Pi.getOptionFunction(e),i="always"===this.props.titleVisibility;return Pi.getNamedMenu(n,e,(async e=>{switch(e.action){case"CONTEXT_OPEN_IN_NEW_TAB":return{handler:this.openSpeedDialNode.bind(this,t,{openInNewTab:!0,openInBackground:this.props.openTabsInBackground}),isVisible:()=>this.isBookmark(),...s(n,e,{})};case"CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB":return{handler:this.openSpeedDialNode.bind(this,t,{openInNewTab:!0,openInBackground:!0}),isVisible:()=>this.isBookmark()&&!this.props.openTabsInBackground,...s(n,e,{})};case"CONTEXT_OPEN_IN_TAB":return{handler:()=>this.openSpeedDialNode(t),isVisible:()=>this.isBookmark(),...s(n,e,{})};case"CONTEXT_OPEN_IN_NEW_WINDOW":return{handler:this.openSpeedDialNode.bind(this,t,{openInNewWindow:!0}),isVisible:()=>this.isBookmark(),...s(n,e,{})};case"CONTEXT_OPEN_IN_PRIVATE_WINDOW":return{handler:this.openSpeedDialNode.bind(this,t,{openInNewWindow:!0,incognito:!0}),isVisible:()=>this.isBookmark(),...s(n,e,{})};case"CONTEXT_CONTAINER_OPEN_IN_WINDOW":{const i=await Kr.getMenu(n,!0,[t.url||""]);return{isVisible:()=>this.isBookmark()&&i.length>0,items:i,...s(n,e,{})}}case"CONTEXT_OPEN_ALL":return{handler:this.openSpeedDialNode.bind(this,t,{openInBackground:!0}),isVisible:()=>this.isFolder(),...s(n,e,{})};case"CONTEXT_SET_THUMBNAIL":return{handler:this.handleSetCustomThumbnail,isVisible:()=>(this.isBookmark()||this.isFolder())&&!this.props.incognito,...s(n,e,{})};case"CONTEXT_CLEAR_THUMBNAIL":return{handler:this.handleClearCustomThumbnail,isVisible:()=>this._customThumbnail,...s(n,e,{})};case"CONTEXT_RELOAD":return{handler:this.handleUpdateThumbnail,isVisible:()=>(this.isBookmark()||this.isFolder())&&!this.props.incognito,...s(n,e,{})};case"CONTEXT_EDIT":return{handler:this.handleEdit,...s(n,e,{})};case"CONTEXT_RENAME":return{handler:this.handleRename,isVisible:()=>i,...s(n,e,{})};case"CONTEXT_CUT":return{handler:this.handleCutDial,...s(n,e,{})};case"CONTEXT_COPY":return{handler:this.handleCopyDial,...s(n,e,{})};case"CONTEXT_PASTE":return{handler:this.handlePasteDial,...s(n,e,{})};case"CONTEXT_DELETE":return{handler:this.handleRemoveDial,...s(n,e,{})};default:return{...s(n,e,{})}}}))};handleContextMenu=e=>{const t=this.props.node;e.persist(),(0,to.ZP)(e),this.getContextMenuItems("speeddialitem",t).then((t=>{(0,Qi.Z)(this.context,t)(e)}))};onDragOver=e=>{e.dataTransfer.types.some((e=>Ds.ZP.isUriListType(e)||"text/plain"===e||e===Ds.yR))&&((0,to.ZP)(e),e.dataTransfer.dropEffect=Ds.ZP.isCopyModifierPressed(e)?"copy":"move",this.setState({canDrop:!0}))};onDragLeave=e=>{this.state.canDrop&&this.setState({canDrop:!1})};onDrop=e=>{(0,to.ZP)(e),this.props.bookmarkActions.onDropEvent(e,this.props.node.id,0),this.setState({canDrop:!1})};onCut=e=>{this.props.bookmarkActions.cut(e,[this.props.node.id]),(0,to.ZP)(e)};onCopy=e=>{this.props.bookmarkActions.copy(e,[this.props.node.id]),(0,to.ZP)(e)};onPaste=e=>{this.props.bookmarkActions.paste(e,this.props.node.id),(0,to.ZP)(e)};getContextMenuItemsPromise=e=>this.getContextMenuItems("speeddialitem",e);getTitleStyle=eo()((e=>e?{}:{textAlign:"center"}));render(){const{node:e,showFavicon:t,titleVisibility:n,deleteVisible:s,controlsVisible:i}=this.props,{children:o,url:a=""}=e,r=hr.linkAndQueryUpdatingBookmark(this,e.id),l=e.faviconUrl||je.jk.getFavicon(a)||a,d=e.faviconUrl?"faviconFromCache":"page",c="never"!==n,h=c?45:10;return(0,fs.jsxs)("div",{ref:this.nodeRef,tabIndex:this.props.keyAccess,onPointerDown:this.dialPointerDownHandler,className:As()("draggable","dial",{dragging:this.props.dragging,dragover:this.props.highlight,folder:Boolean(o),isCut:this.props.isCut}),style:this.props.style,"data-id":e.id,onContextMenu:this.handleContextMenu,onBlur:this.disableClipboardListener,onFocus:this.enableClipboardListener,onKeyDown:this.keyDownHandler,onPointerEnter:this.handlePointerEnter,onPointerLeave:this.handlePointerLeave,onDoubleClick:to.ZP,onPointerUpCapture:this.props.onPointerUp,children:[A7(f7,{bookmark:e,canDrop:this.state.canDrop,faviconUrl:l,faviconLoadType:d,onPointerEnter:this.handleThumbnailPointerEnter,onPointerLeave:this.handleThumbnailPointerLeave,onPointerDown:this.pointerDownHandler,onPointerUp:this.pointerUpHandler,onImageLoadError:this.onThumbnailImageLoadError,onPointerCancel:this.pointerUpHandler,onDragOver:this.onDragOver,onDragLeave:this.onDragLeave,onDrop:this.onDrop,speedDialSize:this.props.size}),e.url&&i&&A7("div",{className:"thumb-controls",style:{bottom:h}},void 0,!this.props.incognito&&A7("button",{tabIndex:"-1",onClick:this.handleUpdateThumbnail,className:As()("circular","update-thumbnail",{updating:r}),disabled:r,title:(0,Oe.Z)("Update thumbnail"),dangerouslySetInnerHTML:{__html:Ts.GO5.medium}}),A7("button",{tabIndex:"-1",onClick:this.handleSetCustomThumbnail,className:"circular set-custom-thumbnail",title:(0,Oe.Z)("Select custom thumbnail"),dangerouslySetInnerHTML:{__html:Ts.md4.medium}})),s&&A7("button",{tabIndex:"-1",onClick:this.handleRemoveDial,title:(0,Oe.Z)("other","Delete"),className:"close circular",dangerouslySetInnerHTML:{__html:Ts.M2k.medium}}),c&&A7("div",{className:As()("thumbnail-title",{hidden:"hover"===n}),onPointerUp:this.pointerUpHandler},void 0,t&&!o&&A7(Ss,{className:"favicon",url:l,loadType:d}),t&&o&&Z7,(0,fs.jsx)(S7,{ref:this.refTitle,bookmark:e,bookmarkActions:this.props.bookmarkActions,className:"button-title",getContextMenuItemsPromise:this.getContextMenuItemsPromise,howToEdit:"doubleClick",keyAccess:-1,needsInitialEdit:this.props.awaitingInitialEditId===e.id,onSelect:this.pointerUpHandler,setSpeedDialAwaitingEdit:this.props.setSpeedDialAwaitingEdit,style:this.getTitleStyle(t),onFinished:this.onRenameFinished,titleMargin:this.props.titleMargin}))]})}}const _7=E7;var M7;function N7(e,t,n,s){M7||(M7="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:M7,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const P7="add",D7=[$.kStartpageSpeedDialFaviconVisible,$.kStartpageSpeedDialSize,$.kStartpageSpeedDialTitlesVisible];var x7=N7(Ss,{className:"favicon SpeedDialAddButton-Favicon",url:Ts.a8r,loadType:"faviconFromCache"});class O7 extends hs.Component{static contextType=xi.Z;_hasClipboardListener=!1;refOpenAddSpeedDial=hs.createRef();componentWillUnmount(){this._enableClipboardListener(!1)}_enableClipboardListener=e=>{if(this._hasClipboardListener!==e){this._hasClipboardListener=e,this.props.onSetClipboardListener(this._hasClipboardListener);const{document:t}=this.context;this._hasClipboardListener?t.addEventListener("paste",this.onPaste):t.removeEventListener("paste",this.onPaste)}};onPaste=e=>{this.props.onPaste(e)};keyDownHandler=e=>{if(" "===e.key||"Enter"===e.key)this.props.addItem();else switch(e.key){case"ArrowLeft":this.props.moveFocus(P7,"left",!1);break;case"ArrowRight":this.props.moveFocus(P7,"right",!1);break;case"ArrowUp":this.props.moveFocus(P7,"up",!1);break;case"ArrowDown":this.props.moveFocus(P7,"down",!1);break;default:return}e.preventDefault(),e.stopPropagation()};_handleItemMouseDown=e=>{e.button!==Hi.Z.kLeft&&e.preventDefault()};render(){const{prefValues:e}=this.props,t=e[$.kStartpageSpeedDialFaviconVisible]&&"icon"!==e[$.kStartpageSpeedDialSize],n=t?{}:{textAlign:"center"};return N7("div",{className:As()("dial","add",{active:this.props.drawerIsOpen,"SpeedDial-Dial--Favicon":t,"SpeedDial-Dial--Title":"never"!==e[$.kStartpageSpeedDialTitlesVisible]}),"data-id":P7,style:this.props.style,onBlur:()=>this._enableClipboardListener(!1),onFocus:()=>this._enableClipboardListener(!0),onMouseDown:this._handleItemMouseDown,tabIndex:this.props.keyAccess,onKeyDown:this.keyDownHandler},void 0,(0,fs.jsx)("button",{ref:this.refOpenAddSpeedDial,className:"thumbnail-image",title:this.props.title,tabIndex:this.props.keyAccess,onClick:this.props.addItem,dangerouslySetInnerHTML:{__html:Ts.irc}}),N7("div",{className:"thumbnail-title"},void 0,t&&x7,"never"!==e[$.kStartpageSpeedDialTitlesVisible]&&N7("span",{className:"button-title",style:n},void 0,(0,Oe.Z)("Add New Speed Dial"))))}}const L7=sa(O7,D7);var R7;function B7(e,t,n,s){R7||(R7="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:R7,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const F7={"":(0,Oe.Z)("No Image"),...$J};var V7,W7=B7(jo,{type:"close",size:16}),U7=B7(jo,{type:"checkmark"}),H7=B7("hr",{}),z7=B7("hr",{}),G7=B7("option",{value:1},void 0,"1"),$7=B7("option",{value:2},void 0,"2"),K7=B7("option",{value:3},void 0,"3"),j7=B7("option",{value:4},void 0,"4"),Y7=B7("option",{value:5},void 0,"5"),X7=B7("option",{value:6},void 0,"6"),Q7=B7("option",{value:7},void 0,"7"),q7=B7("option",{value:8},void 0,"8"),J7=B7("option",{value:10},void 0,"10"),e9=B7("option",{value:12},void 0,"12"),t9=B7(jo,{size:16,type:"settings"});function n9(e){const{prefValues:t}=e,{vivaldiWindowId:n}=(0,hs.useContext)(xi.Z),s=Ne.Z.getEventHandler,[i,o]=(0,hs.useState)(!1),[a,r]=(0,hs.useState)(F7),[l,c]=(0,hs.useState)(is.Z.getCurrentIdWithoutPreview(n)),[h,p]=(0,hs.useState)(Uk.Z.getThemeWithFallback(l));(0,hs.useEffect)((()=>{function e(){const e=is.Z.getCurrentIdWithoutPreview(n);c(e),p(Uk.Z.getThemeWithFallback(e))}return z.Z.addListener(e),()=>z.Z.removeListener(e)}),[n]),(0,hs.useEffect)((()=>{const e=t[$.kThemesSystem].concat(t[$.kThemesUser]).reduce(((e,t)=>{const n=t.backgroundImage,s=[...Object.keys(e),...Object.keys(F7)];return n&&!s.includes(n)&&n!==UJ&&(e[n]=(0,Oe.Z)("From $1",[t.name])),e}),{});r({...F7,...e})}),[t]),(0,hs.useEffect)((()=>{const e=()=>o(!1);return i&&Di.Z.bind("esc",e),()=>{Di.Z.unbind("esc",e)}}),[i]);const u=e=>{const t=function(e){return Uk.Z.getSystemThemes().some((t=>t.id===e))?$.kThemesSystem:$.kThemesUser}(l);(0,my.k)(t,(t=>{const n=t.findIndex((e=>e.id===l));-1!==n&&(t[n].backgroundImage=e)}))},g=()=>{C.Z.utilities.selectLocalImage({title:(0,Oe.Z)("Select Background Image"),themeId:l,windowId:n})},m=()=>d.ZP.openURL(n,"https://themes.vivaldi.net");return i?B7("div",{className:As()("SpeedDialView-Settings",{"navigation-title":"off"!==H.Z.get($.kStartpageNavigation)}),onDoubleClick:to.ZP},void 0,B7("div",{className:"SpeedDialView-Settings-Head"},void 0,B7("h1",{},void 0,(0,Oe.Z)("Quick Settings")),B7("button",{className:"close",onClick:()=>o(!1),title:(0,Oe.Z)("Close Quick Settings")},void 0,W7)),B7("div",{className:"SpeedDialView-Settings-BackgroundImages"},void 0,B7("h2",{},void 0,(0,Oe.Z)("Background Images")),B7("div",{className:"images"},void 0,Object.keys(a).sort().map((e=>B7("button",{title:a[e],className:As()("selectbox",{"selectbox-selected":e===h.backgroundImage}),onClick:()=>u(e)},e,B7("div",{className:"selectbox-image",style:{backgroundColor:""===e?h.colorWindowBg:void 0,backgroundImage:`url(${e})`}},void 0,U7))))),B7("div",{className:"actions"},void 0,B7("a",{href:"https://themes.vivaldi.net",onClick:m},void 0,(0,Oe.Z)("Get More Background Images")),B7("input",{type:"button",value:(0,Oe.Z)("Select Image..."),title:(0,Oe.Z)("Select Background Image"),onClick:g}))),H7,B7("div",{className:"SpeedDialView-Settings-StartPage"},void 0,B7("h2",{},void 0,(0,Oe.Z)("title","Start Page")),B7("div",{className:"row"},void 0,B7("label",{htmlFor:"navigationToggle",title:(0,Oe.Z)("Start Page Navigation")},void 0,(0,Oe.Z)("Start Page Navigation")),B7("select",{id:"navigationToggle",value:t[$.kStartpageNavigation],onChange:s($.kStartpageNavigation)},void 0,B7("option",{value:"on"},void 0,(0,Oe.Z)("Show on Internal Pages")),B7("option",{value:"speed_dial_only"},void 0,(0,Oe.Z)("Show on Speed Dial Page")),B7("option",{value:"off"},void 0,(0,Oe.Z)("radio","Hide")))),B7("div",{className:"row"},void 0,B7("label",{htmlFor:"searchFieldToggle"},void 0,(0,Oe.Z)("Search Field")),B7(fb,{inputId:"searchFieldToggle",checked:t[$.kStartpageSpeedDialDisplaySearch],onChange:s($.kStartpageSpeedDialDisplaySearch)})),e.showStats&&B7("div",{className:"row"},void 0,B7("label",{htmlFor:"privacyStatsToggle"},void 0,(0,Oe.Z)("Privacy Statistics")),B7(fb,{inputId:"privacyStatsToggle",checked:t[$.kStartpageSpeedDialPrivacyStatsShow],onChange:s($.kStartpageSpeedDialPrivacyStatsShow)})),B7("div",{className:"row"},void 0,B7("label",{htmlFor:"gameToggle"},void 0,(0,Oe.Z)("Vivaldia Game")),B7(fb,{inputId:"gameToggle",checked:t[$.kStartpageSpeedDialGameButtonShow],onChange:s($.kStartpageSpeedDialGameButtonShow)}))),z7,B7("div",{className:"SpeedDialView-Settings-Appearance"},void 0,B7("h2",{},void 0,(0,Oe.Z)("Speed Dial Appearance")),B7("div",{className:"row"},void 0,B7("label",{className:"dropdown",htmlFor:"thumbnailSelect",title:(0,Oe.Z)("Thumbnail Size")},void 0,(0,Oe.Z)("Thumbnail Size")),B7("select",{id:"thumbnailSelect",value:t[$.kStartpageSpeedDialSize],onChange:s($.kStartpageSpeedDialSize)},void 0,Array.from(dj).map((([e,{label:t}])=>B7("option",{value:e},e,t))))),B7("div",{className:"row"},void 0,B7("label",{className:"dropdown",htmlFor:"maxColumnSelect",title:(0,Oe.Z)("Maximum Columns")},void 0,(0,Oe.Z)("Maximum Columns")),B7("select",{id:"maxColumnSelect",value:t[$.kStartpageSpeedDialColumns],onChange:s($.kStartpageSpeedDialColumns),title:(0,Oe.Z)("Maximum number of Speed Dial columns")},void 0,G7,$7,K7,j7,Y7,X7,Q7,q7,J7,e9,B7("option",{value:99},void 0,(0,Oe.Z)("Unlimited")))),B7("div",{className:"row"},void 0,B7("label",{className:"dropdown",htmlFor:"titleSelect",title:(0,Oe.Z)("Speed Dial Title")},void 0,(0,Oe.Z)("Speed Dial Title")),B7("select",{id:"titleSelect",value:t[$.kStartpageSpeedDialTitlesVisible],onChange:s($.kStartpageSpeedDialTitlesVisible)},void 0,B7("option",{value:"always"},void 0,(0,Oe.Z)("verb","Show")),B7("option",{value:"hover"},void 0,(0,Oe.Z)("Show on Hover")),B7("option",{value:"never"},void 0,(0,Oe.Z)("verb","Hide")))),B7("div",{className:"row"},void 0,B7("label",{htmlFor:"addButtonToggle"},void 0,(0,Oe.Z)("Show Add Button")),B7(fb,{inputId:"addButtonToggle",checked:t[$.kStartpageSpeedDialAddButtonVisible],onChange:s($.kStartpageSpeedDialAddButtonVisible)})),B7("div",{className:"row"},void 0,B7("label",{htmlFor:"deleteButtonToggle"},void 0,(0,Oe.Z)("Show Delete Button")),B7(fb,{inputId:"deleteButtonToggle",checked:t[$.kStartpageSpeedDialDeleteVisible],onChange:s($.kStartpageSpeedDialDeleteVisible)}))),B7("div",{className:"toolbar toolbar-default SpeedDial-Show-Settings"},void 0,B7(Fa,{title:(0,Oe.Z)("Open Start Page Settings"),onClick:()=>{Ae.Z.showSettings(n,"startpage"),o(!1)},image:Ts.bqs.small,className:"button-show-setting",tabIndex:-1}))):B7("button",{className:"SpeedDialView-Settings-Button",onClick:()=>o(!0),title:(0,Oe.Z)("Show Quick Settings")},void 0,t9)}function s9(e,t,n,s){V7||(V7="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:V7,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var i9,o9=s9(jo,{className:"Blocker-Shield-Blocking",type:"blocker-shield",size:16}),a9=s9(jo,{className:"Info-Icon",type:"info",size:16});class r9 extends hs.PureComponent{static contextType=xi.Z;state={totalAdBlocked:0,totalTrackerBlocked:0};componentDidMount(){C.Z.contentBlocking.getBlockedCounters(this.getTotalBlockedData)}getTotalBlockedData=(e,t)=>{if(!t||!t.blocked_for_origin)return;const n=t.blocked_for_origin.ad_blocking.reduce(((e,t)=>e+t.blocked_count),0),s=t.blocked_for_origin.tracking.reduce(((e,t)=>e+t.blocked_count),0);this.setState({totalAdBlocked:n,totalTrackerBlocked:s})};formatPrivacyDataNumber(e){return e.split(/(\d+)/).map(((e,t)=>/\d/.test(e)?s9("strong",{},t,(0,q.uf)(e)):e))}render(){const{totalAdBlocked:e,totalTrackerBlocked:t}=this.state;return s9("div",{className:"SpeedDial-Blocked-Counter",onClick:()=>Ae.Z.showPrivacyStatsDialog(this.context.vivaldiWindowId),onDoubleClick:to.ZP},void 0,s9("div",{className:"SpeedDial-Blocked-Counter-Container"},void 0,o9,s9("p",{className:"Blocked-Info"},void 0,this.formatPrivacyDataNumber((0,Oe.Z)("$1 tracker and","$1 trackers and",[t]))," ",this.formatPrivacyDataNumber((0,Oe.Z)("$1 ad blocked","$1 ads blocked",[e]))),a9))}}function l9(e,t,n,s){i9||(i9="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:i9,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const d9=[$.kAddressBarSearchSuggestEnabled,$.kThemeUseAnimation,$.kStartpageSpeedDialAddButtonVisible,$.kStartpageSpeedDialAllowDnd,$.kStartpageSpeedDialColumns,$.kStartpageSpeedDialControlsVisible,$.kStartpageSpeedDialDeleteVisible,$.kStartpageSpeedDialFaviconVisible,$.kStartpageSpeedDialTitlesVisible,$.kStartpageSpeedDialSize,$.kTabsOpenNewInBackground,$.kStartpageNavigation,$.kStartpageSpeedDialDisplaySearch,$.kStartpageSpeedDialGameButtonShow,$.kStartpageSpeedDialOrder,$.kStartpageSpeedDialPrivacyStatsShow,$.kThemesSystem,$.kThemesUser,$.kStartpageSpeedDialTrackerSuggestionShow,$.kAddressBarSearchKeepSelected],c9={stiffness:400,damping:32,precision:.1};function h9(e){return!!e&&!e.url}function p9(e,t){const n=Array(e);for(let s=0;s<e;s++)n[s]=t(s);return n}let u9=null;var g9=l9(r9,{});class m9 extends hs.PureComponent{static contextType=xi.Z;animate=!1;dragStartX=0;dragStartY=0;dragDialStartPos=[0,0];refSpeedDial=hs.createRef();refParentFolderButton=hs.createRef();refSpeedDialDefaultSearchEngine=hs.createRef();constructor(e){super(e),this.state={dialNodes:[],pressed:"none",lastPress:null,dragDialXY:[0,0],transitionType:"down",dialId:null,highlightParentButton:!1,showSupportDialog:this.shouldShowSupportDialog(e.incognito),blockTrackers:!1,blockAds:!1,refreshHack:!1}}componentDidMount(){qa.Z.addListener(this._onWebpageViewStoreChanged),Gn.Z.addListener(this._handleSupportDialogDisplay),this.timeout=setTimeout((()=>this.animate=!0),300),(0,mS.pg)("tracking",(e=>{this.setState({blockTrackers:e.trackerBlockingEnabled})})),(0,mS.pg)("ad_blocking",(e=>{this.setState({blockAds:e.adBlockingEnabled})}))}componentDidUpdate(e,t){const{HTMLElement:n,DOMRect:s}=this.context,i=this.refParentFolderButton.current;if(i instanceof n){const e=i.getBoundingClientRect();e instanceof s&&(this.parentButtonRect=e)}}componentWillUnmount(){this.timeout&&clearTimeout(this.timeout),qa.Z.removeListener(this._onWebpageViewStoreChanged),Gn.Z.removeListener(this._handleSupportDialogDisplay),this.finishPointerClick(!1)}static getDerivedStateFromProps(e,t){const n=t.dialId,s=e.speedDialNode,i=s&&s.id,o=(s&&s.children||[]).filter((e=>!ps.ZP.isSeparator(e)));if(n===i){let{lastPress:e}=t;if(null===e||u9||o.every((t=>t.id!==e))&&(e=null),null===e)u9=null;else if(u9){const e=t.dialNodes;e.length===o.length&&e.every(((e,t)=>e.id===o[t].id))||(u9=null)}return{dialNodes:o,lastPress:e}}let a="down";if(s&&n&&n!==s.parentId)if(o.some((e=>e.id===n)))a="up";else{const t=e.prefValues[$.kStartpageSpeedDialOrder].length?e.prefValues[$.kStartpageSpeedDialOrder]:e.speedDialSet.map((e=>e.id));if(t){const e=t.findIndex((e=>e===n)),s=t.findIndex((e=>e===i));-1!==s&&-1!==e&&(s<e?a="right":s>e&&(a="left"))}}return{dialNodes:o,lastPress:null,transitionType:a,dialId:i}}doRefreshHack(){this.setState({refreshHack:!0},(()=>{this.setState({refreshHack:!1})}))}getLastPressPosition(){const{dialNodes:e,lastPress:t}=this.state;return u9?u9.findIndex((e=>e===t)):e.findIndex((e=>e.id===t))}maybeSpring(e,t){return this.animate&&this.props.prefValues[$.kThemeUseAnimation]?jq(e,t):e}_handleSupportDialogDisplay=()=>{const e=this.shouldShowSupportDialog(this.props.incognito);this.setState({showSupportDialog:e})};shouldShowSupportDialog(e){const t=this.refSpeedDialDefaultSearchEngine.current?.state.thanksState??!1,n=Gn.Z.getDefault(e),s=Gn.Z.getSpeeddialsSearch(e),i=n?.prepopulateId===Gn.A,o=s?.prepopulateId===Gn.A&&this.props.prefValues[$.kAddressBarSearchKeepSelected];return this.props.prefValues[$.kStartpageSpeedDialTrackerSuggestionShow]&&(i||o||t)}_onWebpageViewStoreChanged=e=>{e.winId===this.context.vivaldiWindowId&&"WEBPAGEVIEW_RELOAD"===e.type&&this._handlePageReload()};handleSpeedDialPointerDown=(e,t)=>{const{document:n}=this.context;"none"!==this.state.pressed&&this.finishPointerClick(!1,t),t.button!==Hi.Z.kLeft&&t.button!==Hi.Z.kCenter||!this.props.prefValues[$.kStartpageSpeedDialAllowDnd]||n.activeElement&&"sd-title-editor"===n.activeElement.className||(this.setState({pressed:"pressed",lastPress:e.id}),this.dragStartX=t.pageX,this.dragStartY=t.pageY)};onPointerMove=e=>{const{pressed:t}=this.state;if("none"===t||!this.props.prefValues[$.kStartpageSpeedDialAllowDnd])return;if(0===e.buttons)return void this.finishPointerClick(!1,e);if(!(1&e.buttons))return;const{lastPress:n}=this.state;if(null===n||"dragcancel"===t)return;this.setState({highlightParentButton:this.isPointerOverParentButton(e)});const s=e.pageX-this.dragStartX,i=e.pageY-this.dragStartY;if("pressed"===t&&Math.abs(s)<=5&&Math.abs(i)<=5)return;const o=this.getSpeedDialGeometry(),a=this.getLastPressPosition();"pressed"===t&&(this.setDialDragListeners(!0),this.dragDialStartPos=this.computeLayout(o,a),this.setState({pressed:"dragging"}));let[r,l]=this.dragDialStartPos;r+=s,l+=i,this.setState({dragDialXY:[r,l]});const{cols:d,rows:c,dialWidth:h,dialHeight:p,thumbnailWidth:u,backgroundHeight:g}=this.getSpeedDialGeometry(),m=this.state.dialNodes.length,v=r+Math.ceil(u/3.5),f=l+Math.ceil(g/3.5),y=s<0?Math.round:Math.floor,C=i<0?Math.round:Math.floor,w=(0,gb.Z)(y(v/h),0,d-1),b=(0,gb.Z)(C(f/p),0,c-1),S=Math.min(b*d+w,m-1);a!==S&&this.moveDial(S,a)};moveDial=(e,t)=>{u9=(0,V.Uy)(u9??this.state.dialNodes.map((e=>e.id)).slice(0),(n=>{const s=n.splice(t,1)[0];n.splice(e,0,s)}))};setDialDragListeners(e){if(!this.props.prefValues[$.kStartpageSpeedDialAllowDnd])return;const{addEventListener:t,removeEventListener:n,document:s}=this.context;e?(t("pointermove",this.onPointerMove,!0),t("pointerup",this.onPointerPressEnd,!1),t("pointercancel",this.onPointerPressEnd,!0),t("pointerdown",this.onPointerPressEnd,!0),Di.Z.bind("esc",this.onDragEscapeKey)):(n("pointermove",this.onPointerMove,!0),n("pointerup",this.onPointerPressEnd,!1),n("pointercancel",this.onPointerPressEnd,!0),n("pointerdown",this.onPointerPressEnd,!0),Di.Z.unbind("esc",this.onDragEscapeKey));const i=s.getElementById("browser");i&&(i.style.pointerEvents=e?"none":"auto")}onPointerPressEnd=e=>{const{pressed:t}=this.state;"dragging"!==t&&"dragcancel"!==t||(0,to.ZP)(e),this.finishPointerClick(!0,e)};onDragEscapeKey=()=>{u9=null,this.setState({pressed:"dragcancel"})};isPointerOverParentButton=e=>!(!e||!this.parentButtonRect)&&(e.pageX>this.parentButtonRect.x&&e.pageX<this.parentButtonRect.x+this.parentButtonRect.width&&e.pageY>this.parentButtonRect.y&&e.pageY<this.parentButtonRect.y+this.parentButtonRect.height);async finishPointerClick(e,t){const{pressed:n}=this.state;if("none"!==n){if(this.setDialDragListeners(!1),"dragging"===n||"dragcancel"===n){let s=!1;const i=this.getDraggedNode();if("dragging"===n&&e&&this.isPointerOverParentButton(t)){const e=this.props.speedDialNode&&this.props.speedDialNode.parentId;i&&e&&(await this.props.bookmarkActions.move([i.id],e,0),s=!0)}else if("dragging"===n&&e&&u9){const e=this.getLastPressPosition();if(!i)return;if(("number"==typeof i.index?i.index:e)!==e){const e=i.parentId||"";await this.props.bookmarkActions.reorder(u9,e),s=!0}}s?this.onBookmarksMoved():u9=null}this.setState({pressed:"none",highlightParentButton:!1})}}getDraggedNode=()=>{const{dialNodes:e}=this.state,t=this.getLastPressPosition();return u9?e.find((e=>e.id===u9?.[t])):e[t]};onSDPointerUp=async e=>{const{pressed:t}=this.state,n=e.currentTarget.getAttribute("data-id");if(!n||"dragging"!==t)return;const s=e.currentTarget.classList.contains("folder"),i=this.getDraggedNode();if(i&&i.id!==n){if((0,to.ZP)(e),s)await this.props.bookmarkActions.move([i.id],n,0);else if(h9(i))await this.props.bookmarkActions.move([n],i.id,0);else{const e=ps.ZP.getItemById(n),t=await this.props.bookmarkActions.mergeWithPromise(i,e,(0,Oe.Z)("title","New Folder"));this.props.setSpeedDialAwaitingEdit(t)}this.onBookmarksMoved(),this.setState({pressed:"dragcancel"})}else this.finishPointerClick(!0,e)};onBookmarksMoved=()=>{s.Z.runtime.lastError&&(u9=null,console.warn("Error moving bookmark: ",s.Z.runtime.lastError))};onDragOverHandler=e=>{e.preventDefault(),e.stopPropagation()};openParentNode=e=>{(0,to.ZP)(e),this.props.speedDialNode&&this.props.speedDialNode.parentId&&s.Z.bookmarks.getSubTree(this.props.speedDialNode.parentId,(e=>{if(s.Z.runtime.lastError)return;const t=e[0];t&&(this.props.openSpeedDialNode(t),this.doRefreshHack())}))};openSpeedDialNode=(e,t)=>{h9(e)&&this.doRefreshHack(),this.props.openSpeedDialNode(e,t)};isTopLevel=()=>!this.props.speedDialNode||!this.props.speedDialSetNode||this.props.speedDialNode.id===this.props.speedDialSetNode.id;_handlePageReload=()=>{!this.props.incognito&&this.props.speedDialNode&&s.Z.bookmarks.getChildren(this.props.speedDialNode.id,(e=>{if(!e)return;const t=[];e.forEach(((e,n,s)=>{C.Z.bookmarksPrivate.isCustomThumbnail(e.id,(i=>{!1===i&&e.url&&t.push({id:e.id,url:e.url}),n===s.length-1&&hr.updateForBookmarks(t)}))}))}))};onDragUrlOver=e=>{e.dataTransfer.types.some((e=>Ds.ZP.isUriListType(e)||"text/plain"===e||e===Ds.yR))&&((0,to.ZP)(e),e.dataTransfer.dropEffect="copy")};onDropUrlOn=e=>{const t=this.props.speedDialNode;if(t){const n=t.children?t.children.length:0,s={disableMove:!0};this.props.bookmarkActions.onDropEvent(e,t.id,n,s)}};onKeyDown=e=>{const t=e.key.toLowerCase();if(e.ctrlKey)switch(t){case"z":e.shiftKey?this.props.bookmarkActions.redo():this.props.bookmarkActions.undo();break;case"y":this.props.bookmarkActions.redo()}};onPaste=e=>{this.props.speedDialNode&&this.props.bookmarkActions.paste(e,this.props.speedDialNode.id,!0),(0,to.ZP)(e)};getSpeedDialGeometry(){const{prefValues:e}=this.props,t=e[$.kStartpageSpeedDialSize];let n=dj.get(t)?.value;const s="always"===e[$.kStartpageSpeedDialTitlesVisible];if(!n||"fit_to_columns"===t){const e=Math.round(this.props.maxWidth/(1.4*this.props.prefValues[$.kStartpageSpeedDialColumns]));n=Math.max(Math.min(e,320),120)}const i=n<150?26:33,o="icon"===t?n-i:Math.round(n/1.22),a=Math.round(n/12),r=this.state.dialNodes.length+(e[$.kStartpageSpeedDialAddButtonVisible]?1:0),l=6*a,d=e[$.kStartpageSpeedDialColumns],c=o+(s?i:0),h=n+2*a,p=c+2*a;let u=Math.max(1,Math.min(Math.floor((this.props.maxWidth-l)/h),d));this.props.maxWidth<h*u+l&&(u=1);return{backgroundHeight:c,count:r,cols:u,rows:Math.ceil(r/u),dialWidth:h,dialHeight:p,thumbnailWidth:n,thumbnailHeight:o,dialSpace:a}}computeLayout(e,t){const n=Math.floor(t/Number(e.cols)),s=t%Number(e.cols);return[Number(e.dialWidth)*s,Number(e.dialHeight)*n]}getNextFocusable=e=>{const{HTMLElement:t}=this.context,n=this.refSpeedDial.current;if(n instanceof t){const t=Array.from(n.querySelectorAll("div.dial")).map((e=>e.getAttribute("data-id"))).filter(Boolean);let s=t.indexOf(e);return-1===s?"":(s=s>0?s-1:s+1,s>=t.length?"":t[s])}return""};moveFocus=(e,t,n)=>{const{HTMLElement:s}=this.context,i=this.refSpeedDial.current;if(i instanceof s){const n=Array.from(i.querySelectorAll("div.dial")).map((e=>e.getAttribute("data-id"))).filter(Boolean);if(0===n.length)return!1;let s;const o=this.getSpeedDialGeometry();switch(t){case"current":if(""===e&&(e=n[0]),s=n.indexOf(e),-1===s)return!1;break;case"left":case"right":if(1===n.length)return!1;if(s=n.indexOf(e),-1===s)return!1;if("right"===t){if((s+1)%o.cols==0)return!1;if(s+=1,s>=n.length)return!1}else{if(s%o.cols==0)return!1;if(s-=1,s>=n.length)return!1}break;case"up":case"down":if(1===n.length)return!1;if(s=n.indexOf(e),-1===s)return!1;if("up"===t){if(s-=o.cols,s<0){const e=i.getElementsByClassName("button-startpage up-level")[0];return!!e&&(e.focus(),!0)}}else if(s+=o.cols,s>=n.length)return!1;break;default:return!1}e=n[s];const a=i.querySelector(`div.dial[data-id="${e}"]`);if(a)return a.focus(),!0}return!1};renderNavigation=()=>this.isTopLevel()?null:l9("nav",{className:"startpage-folder-navigation"},void 0,(0,fs.jsxs)("button",{ref:this.refParentFolderButton,onClick:this.openParentNode,title:(0,Oe.Z)("Show Parent Folder"),"data-name":"up-button",className:As()("button-startpage","up-level",{highlight:this.state.highlightParentButton}),children:[l9("span",{dangerouslySetInnerHTML:{__html:Ts.zwh}}),this.props.speedDialNode?this.props.speedDialNode.title:""]}));render(){if(this.state.refreshHack)return null;const{maxWidth:e,speedDialSet:t,prefValues:n}=this.props;if(!e)return null;const s=n[$.kStartpageSpeedDialAllowDnd],i="icon"===n[$.kStartpageSpeedDialSize],o=n[$.kStartpageSpeedDialFaviconVisible]&&!i,a=n[$.kStartpageSpeedDialTitlesVisible],r=n[$.kTabsOpenNewInBackground],l=n[$.kStartpageSpeedDialControlsVisible]&&!i,d=n[$.kStartpageSpeedDialDeleteVisible],c=n[$.kStartpageSpeedDialDisplaySearch],h=n[$.kStartpageSpeedDialPrivacyStatsShow]&&(this.state.blockTrackers||this.state.blockAds),p=h&&c?900:500,{pressed:u,dialId:g,dialNodes:m}=this.state,v=As()({dials:!0,speeddial:!0,"sd-titles-onhover":"hover"===a}),f=As()("dials-wrapper",{iconSizeIcon:"icon"===n[$.kStartpageSpeedDialSize]}),y=t.length>0,C=this.getSpeedDialGeometry(),{backgroundHeight:w,count:b,cols:S,rows:I,dialWidth:k,dialHeight:A,thumbnailWidth:T,thumbnailHeight:Z,dialSpace:E}=C,_=S*k-2*E,M=Math.round(T/20);return(0,fs.jsxs)("div",{ref:this.refSpeedDial,children:[l9("div",{className:"SpeedDialView-Head",style:{maxWidth:Math.min(_,p)}},void 0,this.state.showSupportDialog&&this.props.prefValues[$.kStartpageSpeedDialTrackerSuggestionShow]&&(0,fs.jsx)(LK,{ref:this.refSpeedDialDefaultSearchEngine,hideImg:S<3}),c&&l9("div",{className:"on-speeddial"},void 0,l9(Nee,{className:"SpeedDialView-SearchField",origin:"speed_dial_view",suggestEnabled:n[$.kAddressBarSearchSuggestEnabled],size:"large",name:"SearchField"},"speed_dial_search")),h&&g9),l9(c7.Z,{className:As()({"dials-wrapper":!0,dragging:"dragging"===u,"dragging-disabled":!s}),transitionName:this.state.transitionType,transitionEnterTimeout:300,transitionLeaveTimeout:300,overflowHidden:!1},void 0,l9("div",{onDragOver:this.onDragUrlOver,onDrop:this.onDropUrlOn,onKeyDown:this.onKeyDown,className:v},"node__"+(g||"unset"),this.renderNavigation(),l9("div",{className:f,onPointerMove:"pressed"===u&&s?this.onPointerMove:null,onPointerUp:this.onPointerPressEnd,onPointerCancel:this.onPointerPressEnd,style:{width:_,height:I*A,marginLeft:E,marginRight:E,"--thumbnailHeight":Z+"px","--thumbnailWidth":T+"px","--backgroundHeight":w+"px"}},void 0,p9(b,(e=>{let t=null;e<m.length&&(t=u9?m.find((t=>t.id===u9?.[e])):m[e]);const s=!!t&&t.id===this.state.lastPress,i=s&&"dragging"===u;let c;if(i){const[e,t]=this.state.dragDialXY;c={translateX:e,translateY:t,opacity:this.maybeSpring(.95,c9)}}else if(t){const[t,n]=this.computeLayout(C,e);c={translateX:this.maybeSpring(t,c9),translateY:this.maybeSpring(n,c9),opacity:this.maybeSpring(1,c9)}}else{const[t,n]=this.computeLayout(C,e);c={translateX:this.maybeSpring(t,c9),translateY:this.maybeSpring(n,c9),opacity:1}}return l9(zq,{style:c,children:Aa.Z},t?"node_"+t.id:"add_button",(({translateX:c,translateY:h,opacity:p})=>{const g="dragging"===u;return t?l9(_7,{incognito:this.props.incognito,onPointerDown:this.handleSpeedDialPointerDown,dragging:i,style:{transform:`translate3d(${c}px, ${h}px, 0)`,zIndex:s?999:e,opacity:p,pointerEvents:i?"none":"auto"},isCut:this.props.cutIds.includes(t.id),highlight:g,onPointerUp:this.onSDPointerUp,titleMargin:M,node:t,bookmarkActions:this.props.bookmarkActions,keyAccess:0===e?0:-1,moveFocus:this.moveFocus,getNextFocusable:this.getNextFocusable,openSpeedDialNode:(e,t)=>{"dragcancel"!==u&&this.openSpeedDialNode(e,t)},awaitingInitialEditId:this.props.awaitingInitialEditId,setSpeedDialAwaitingEdit:this.props.setSpeedDialAwaitingEdit,showFavicon:o,titleVisibility:a,openTabsInBackground:r,controlsVisible:l,deleteVisible:d,size:n[$.kStartpageSpeedDialSize]}):l9(L7,{style:{transform:`translate3d(${c}px, ${h}px, 0)`,zIndex:0,"--thumbnailHeight":Z+"px","--thumbnailWidth":T+"px","--backgroundHeight":w+"px"},id:this.props.speedDialNode?.id,drawerIsOpen:this.props.drawerIsOpen,title:y?(0,Oe.Z)("title","Add bookmark to Speed Dial"):(0,Oe.Z)("First add a new Speed Dial folder"),keyAccess:0===e?0:-1,moveFocus:this.moveFocus,onPaste:this.onPaste,onSetClipboardListener:this.props.onSetClipboardListener,addItem:this.props.toggleStartpageDrawer})}))}))))),l9(n9,{prefValues:this.props.prefValues,showStats:Boolean(this.state.blockTrackers||this.state.blockAds)})]})}}const v9=sa(m9,d9);var f9;function y9(e,t,n,s){f9||(f9="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:f9,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const C9=[$.kMailIsTurnedOff,$.kStartpageSpeedDialAddButtonVisible,$.kStartpageSpeedDialOrder];function w9(e){const t=(0,hs.useContext)(xi.Z),n=(0,na.Z)(C9),s=(0,hs.createRef)(),i=new Map,[o,a]=(0,hs.useState)([]),[r,l]=(0,hs.useState)(),[c,h]=(0,hs.useState)(""),[p,u]=(0,hs.useState)(""),g=(n,s,i)=>{n===zM.Mail?Ae.Z.showMail(t.vivaldiWindowId):e.section!==n&&((0,cy.gR)(t),d.ZP.openURL(t.vivaldiWindowId,je.jk.internals[n],{inCurrent:!0})),n===zM.SpeedDial&&e.openMenuItem(zM.SpeedDial,s,i)},m=e=>{const n="startpagebar",s=t.vivaldiWindowId,i=Pi.getOptionFunction(n);return Pi.getNamedMenu(s,n,(async t=>{switch(t.action){case"CONTEXT_RENAME":return{isVisible:()=>e.length>0,handler:()=>v(e),...i(s,t,{})};case"CONTEXT_REMOVE":return{isVisible:()=>e.length>0,handler:()=>f(e),...i(s,t,{})};default:return{...i(s,t,{})}}}))},v=e=>{i.get(e)?.enableEditing()},f=e=>{i.get(e)?.removeSpeedDial()},y=(e,t)=>{switch(t.key){case"ArrowLeft":C(e,"left",!1);break;case"ArrowRight":C(e,"right",!1);break;default:return}(0,to.ZP)(t)},C=(e,n,i)=>{const{document:o,HTMLElement:a}=t,r=s.current;if(r instanceof a&&(!0===i||sl(o,r))){const t=Array.from(r.querySelectorAll("button.button-startpage")).map((e=>e.getAttribute("data-id"))).filter(Boolean);if("current"===n){if(""===e){const t=o.getElementsByClassName("div.button-startpage active")[0];t instanceof a&&(e=t.dataset.id)}const n=t.indexOf(e);if(-1===n)return;e=t[n]}else if("right"===n||"left"===n){if(1===t.length)return;let s=t.indexOf(e);if(-1===s)return;s="right"===n?s+1>=t.length?0:s+1:s<=0?t.length-1:s-1,e=t[s]}const s=r.querySelector(`button.button-startpage[data-id="${e}"]`);s&&s.focus()}};let w=-1===e.keyAccess;const b=e=>{let t=-1;return!w&&e&&(w=!0,t=0),t},S=e=>o.findIndex((t=>t===e)),I=()=>{h(""),u(""),l(void 0)},k=e=>{if(c!==u){e.stopPropagation();let t=S(p);const n=S(c);n<t&&t--;let s=[...o];const i=s[n].slice();s=s.filter((e=>e!==i)),s.splice(t+("right"===r?1:0),0,i),a(s),Ne.Z.set($.kStartpageSpeedDialOrder,s)}h(""),u(""),l(void 0)},A=(0,hs.useMemo)((()=>{const t=n[$.kStartpageSpeedDialOrder];return[...e.speedDialSet].sort(((e,n)=>t.length?t.indexOf(e.id)>t.indexOf(n.id)?1:-1:0))}),[e.speedDialSet,n]);return(0,fs.jsxs)("nav",{ref:s,className:"startpage-navigation toolbar-medium",onContextMenu:e=>{e.persist(),(0,to.ZP)(e),m("").then((n=>{(0,Qi.Z)(t,n)(e)}))},onDragOver:to.PF,onDrop:k,children:[y9("div",{className:"startpage-navigation-group"},void 0,A.map(((t,n)=>{const s=e.section===zM.SpeedDial&&e.speedDialSetNode&&e.speedDialSetNode.id===t.id,o="title"+n,d={draggable:e.speedDialSet.length>1,onDragStart:e=>((e,t)=>{e.persist(),e.dataTransfer.dropEffect="move",e.dataTransfer.setData("vivaldi/x-speeddial-entry",t),e.dataTransfer.setData("text/plain",t),h(t),a(A.map((e=>e.id),[]))})(e,t.id),onDragEnter:()=>{return e=t.id,void(c!==e&&u(e));var e},onDragOver:e=>((e,t)=>{if(!c||t===c)return;e.preventDefault();const n=e.currentTarget.getBoundingClientRect(),s=e.clientX-n.left>n.width/2?"right":"left";l(s)})(e,t.id),onDragEnd:I,onDrop:k};return(0,fs.jsx)(S7,{className:As()({active:s,"button-startpage":!0,"no-page-focus":!0,collapsed:c===t.id,"hover-left":c!==t.id&&p===t.id&&"left"===r,"hover-right":c!==t.id&&p===t.id&&"right"===r}),ref:e=>{return t=o,void((n=e)?i.set(t,n):i.delete(t));var t,n},bookmark:t,howToEdit:"doubleClick",getContextMenuItemsPromise:()=>m(o),keyAccess:b(!!s),onSelect:e=>g(zM.SpeedDial,t,e),onKeyDown:y,needsInitialEdit:e.initialEditSpeedDialSet===t.id,setSpeedDialAwaitingEdit:e.setSpeedDialAwaitingEdit,...d},t.id)}),this),n[$.kStartpageSpeedDialAddButtonVisible]&&y9("button",{onClick:()=>{e.section!==zM.SpeedDial&&d.ZP.openURL(t.vivaldiWindowId,je.jk.internals[zM.SpeedDial],{inCurrent:!0}),e.createSpeedDialSet()},"data-id":"add",className:"button-startpage add-set no-page-focus",title:(0,Oe.Z)("Add new Speed Dial folder"),tabIndex:b(!0),onKeyDown:e=>y("add",e),dangerouslySetInnerHTML:{__html:Ts.md4.medium}})),y9("div",{className:"startpage-navigation-group"},void 0,y9(Fa,{name:"PanelBookmarks",onClick:e=>g(zM.Bookmarks,null,e),onKeyDown:e=>y(zM.Bookmarks,e),"data-id":zM.Bookmarks,tabIndex:b(!0),className:As()({"button-startpage":!0,"no-page-focus":!0,active:e.section===zM.Bookmarks}),title:(0,Oe.Z)("Bookmarks"),size:"medium",image:Ts.CLf.large}),y9(Fa,{name:"PanelHistory",onClick:e=>g(zM.History,null,e),onKeyDown:e=>y(zM.History,e),title:(0,Oe.Z)("History"),"data-id":zM.History,tabIndex:b(!0),className:As()({"button-startpage":!0,"no-page-focus":!0,active:e.section===zM.History}),size:"medium",image:Ts.hcy.large}),y9(Fa,{name:"PanelNotes",onClick:e=>g(zM.NotesManager,null,e),onKeyDown:e=>y(zM.NotesManager,e),title:(0,Oe.Z)("Notes"),"data-id":zM.NotesManager,tabIndex:b(!0),className:As()({"button-startpage":!0,"no-page-focus":!0,active:e.section===zM.NotesManager}),size:"medium",image:Ts.cyI.large}),!n[$.kMailIsTurnedOff]&&(0,fs.jsxs)(fs.Fragment,{children:[y9(Fa,{name:"PanelCalendar",onClick:e=>g(zM.Calendar,null,e),onKeyDown:e=>y(zM.Calendar,e),title:(0,Oe.Z)("Calendar"),"data-id":zM.Calendar,tabIndex:b(!0),className:As()({"button-startpage":!0,"no-page-focus":!0,active:e.section===zM.Calendar}),size:"medium",image:Ts.bcq.large}),y9(Fa,{name:"PanelMail",onClick:e=>g(zM.Mail,null,e),onKeyDown:e=>y(zM.Mail,e),title:(0,Oe.Z)("Mail"),"data-id":zM.Mail,tabIndex:b(!0),className:As()({"button-startpage":!0,"no-page-focus":!0,active:e.section===zM.Mail}),size:"medium",image:Ts.lvj.large})]}))]})}const b9=(0,hs.memo)(w9);var S9,I9=n(55667);function k9(e,t,n,s){S9||(S9="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:S9,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const A9=[$.kBookmarksConfirmOpening,$.kBookmarksConfirmOpeningThreshold,$.kKeyboardTabToAll,$.kStartpageNavigation,$.kStartpageSpeedDialAddButtonVisible,$.kStartpageSpeedDialGameButtonShow,$.kTabsBarPosition,$.kTabsBarWidth,$.kStartpageSpeedDialOrder];var T9=k9(H2,{}),Z9=k9("div",{className:"StartPage-GameButton"},void 0,k9(Rv,{isStartPage:!0}));class E9 extends hs.PureComponent{static contextType=xi.Z;refSDdWrapper=hs.createRef();_speeddialview=hs.createRef();bookmarkActions=new r2;_hasClipboardListener=!1;constructor(e,t){super(e);const n=ps.ZP.getSpeeddialFolders(),s=e.prefValues[$.kStartpageSpeedDialOrder][0],i=s?ps.ZP.getItemById(s):n[0],o=ud.ZP.getWidth(t.vivaldiWindowId),a=e.prefValues[$.kTabsBarWidth],r=e.prefValues[$.kTabsBarPosition],l="left"===r||"right"===r?a:0;this.state={section:e.view,bookmarksAvailable:ps.ZP.hasBeenInitialized(),speeddialFolders:n,menuSpeeddial:i,currentSpeeddial:i,drawerIsOpen:!1,awaitingInitialEditId:"",initialEditSpeedDialSet:"",viewWidth:t.innerWidth-o-l,viewHeight:t.innerHeight,wallpaperId:crypto.randomUUID(),cutIds:ps.ZP.getCutIds(),isResizing:!1}}componentDidMount(){ps.ZP.addListener(this._onStoreChange),n2.addListener(this._onTaskStoreChange),this.context.addEventListener("resize",this.handleWindowResize,!1)}componentWillUnmount(){ps.ZP.removeListener(this._onStoreChange),n2.removeListener(this._onTaskStoreChange),Di.Z.unbind("esc",this.closeStartpageDrawer),this.context.removeEventListener("resize",this.handleWindowResize,!1),clearTimeout(this._resizingTimeout)}componentDidUpdate(e,t){t.drawerIsOpen!==this.state.drawerIsOpen&&(this.state.drawerIsOpen?Di.Z.bind("esc",this.closeStartpageDrawer):Di.Z.unbind("esc",this.closeStartpageDrawer)),e.view!==this.props.view&&this.setState({section:this.props.view})}handleWindowResize=()=>{clearTimeout(this._resizingTimeout),this.setState({isResizing:!0}),this.freezeProps||(this.freezeProps={viewWidth:this.state.viewWidth,viewHeight:this.state.viewHeight}),this._resizingTimeout=setTimeout((()=>{this.setState({isResizing:!1}),this.freezeProps=void 0}),1e3)};_onStoreChange=()=>{const e=ps.ZP.getSpeeddialFolders(),t=this.props.prefValues[$.kStartpageSpeedDialOrder][0];let n=t?ps.ZP.getItemById(t):e[0],s=n;for(const t of e)this.getUpdatedNode(t,this.state.currentSpeeddial)&&(s=this.getUpdatedNode(t,this.state.currentSpeeddial)),this.getUpdatedNode(t,this.state.menuSpeeddial)&&(n=this.getUpdatedNode(t,this.state.menuSpeeddial));this.setState({bookmarksAvailable:!0,speeddialFolders:e,menuSpeeddial:n,currentSpeeddial:s,cutIds:ps.ZP.getCutIds()})};_onTaskStoreChange=()=>{this.forceUpdate()};jumpToTop=()=>{const{HTMLElement:e}=this.context,t=this.refSDdWrapper.current;t instanceof e&&(t.scrollTop=0)};onResize=e=>{const t=e[0].contentRect;(this.state.viewHeight!==t.height||this.state.viewWidth!==t.width)&&this.setState({viewWidth:t.width,viewHeight:t.height})};getUpdatedNode=(e,t)=>{if(e&&e.id&&t&&t.id){if(e.id===t.id)return e;if(e.children){for(var n=0;n<e.children.length;n++){var s=this.getUpdatedNode(e.children[n],t);if(s&&s.id===t.id)return s}return null}return null}return null};showStartpageDrawer=(e,t)=>{this.setState({drawerIsOpen:e},(()=>{!1===e&&""===this.state.awaitingInitialEditId&&this._speeddialview.current?.moveFocus(t||"add","current",!1)}))};closeStartpageDrawer=()=>{this.showStartpageDrawer(!1,"")};toggleStartpageDrawer=()=>{0===this.state.speeddialFolders.length?this.createSpeedDialSet():this.showStartpageDrawer(!this.state.drawerIsOpen)};handleDoubleClick=e=>{e.target.className&&this.state.section===zM.SpeedDial&&!this.props.prefValues[$.kStartpageSpeedDialAddButtonVisible]&&this.toggleStartpageDrawer()};onSetClipboardListener=e=>{this._hasClipboardListener=e};handlePaste=()=>{const{document:e}=this.context,t=this._hasClipboardListener;t||e.addEventListener("paste",this.onPaste),e.execCommand("paste"),t||e.removeEventListener("paste",this.onPaste)};onPaste=e=>{this.state.currentSpeeddial&&(this.bookmarkActions.paste(e,this.state.currentSpeeddial.id,!0),e.stopPropagation(),e.preventDefault())};createSpeedDialSet=async()=>{const e=await this.bookmarkActions.create({parentId:ps.ZP.getRootId(),title:ps.ZP.getDefaultFolderName()});e&&this.bookmarkActions.update(e.id,{speeddial:!0}).then((e=>{this.setState({initialEditSpeedDialSet:e.id})}))};openMenuItem=(e,t,n)=>{this.props.updatePageThumbnailWithActiveWebview(1e3);const s=t&&t.id&&t;this.jumpToTop(),this.setState({section:e,menuSpeeddial:s,currentSpeeddial:s})};isFolder=e=>!e.url;openFolder=(e,t)=>{!0===(t=t||{}).openInBackground?Ds.ZP.open(this.context.vivaldiWindowId,Ds.ZP.getBookmarksByNode(e),{inCurrent:!1,inBackground:!0,inNewWindow:!1,incognito:!1,allowOverride:!1},!0):(this.jumpToTop(),this.setState({currentSpeeddial:e},(()=>{this._speeddialview.current?.moveFocus("","current",!1),this.bookmarkActions.clearUndoStack()})))};openSpeedDialNode=(e,t)=>{t=t||{},this.isFolder(e)?this.openFolder(e,t):t.openInNewWindow?cs.Z.openBrowserWindow(this.context.vivaldiWindowId,e.url,{incognito:t.incognito,transition:C.Z.historyPrivate.TransitionType.AUTO_BOOKMARK}):e.url&&d.ZP.openURL(this.context.vivaldiWindowId,e.url,{inCurrent:!t.openInNewTab,inBackground:t.openInBackground,bookmarkId:e.id,addOpenerTabId:!0,inSpecificPageId:t.openInNewTab?void 0:this.props.pageId,transition:C.Z.historyPrivate.TransitionType.AUTO_BOOKMARK})};setSpeedDialAwaitingEdit=e=>{this.setState({awaitingInitialEditId:e})};onSpeedDialDrawerDone=async e=>{if(!e)return void this.closeStartpageDrawer();const t=await this.bookmarkActions.create(e);if(!t)return void this.closeStartpageDrawer();const n=t.url;n?G.ZP.isIncognito(this.context.vivaldiWindowId)||hr.updateForBookmark(t.id,n):this.setSpeedDialAwaitingEdit(t.id),this.showStartpageDrawer(!1,t.id)};customize=()=>{Ae.Z.showSettings(this.context.vivaldiWindowId,"startpage")};renderSection=e=>{if(this.state.section===zM.Bookmarks)return T9;if(this.state.section===zM.History)return k9(V3,{pageId:this.props.pageId,keyAccess:this.props.prefValues[$.kKeyboardTabToAll],maxWidth:this.freezeProps?.viewWidth??this.state.viewWidth,maxHeight:this.freezeProps?.viewHeight??this.state.viewHeight});if(this.state.section===zM.SpeedDial)return this.state.bookmarksAvailable?(0,fs.jsx)(v9,{ref:this._speeddialview,bookmarkActions:this.bookmarkActions,cutIds:this.state.cutIds,speedDialNode:this.state.currentSpeeddial,speedDialSetNode:this.state.menuSpeeddial,speedDialSet:this.state.speeddialFolders,keyAccess:this.props.prefValues[$.kKeyboardTabToAll],drawerIsOpen:this.state.drawerIsOpen,maxWidth:this.state.viewWidth,maxHeight:this.state.viewHeight,openSpeedDialNode:this.openSpeedDialNode,toggleStartpageDrawer:this.toggleStartpageDrawer,onSetClipboardListener:this.onSetClipboardListener,incognito:e,setSpeedDialAwaitingEdit:this.setSpeedDialAwaitingEdit,awaitingInitialEditId:this.state.awaitingInitialEditId}):null;if(this.state.section===zM.Calendar)return k9(V5,{pageId:this.props.pageId,url:this.props.url});if(this.state.section===zM.NotesManager){const e=new URL(this.props.url).searchParams.get("path")||"-1";return k9(J6,{id:e,pageId:this.props.pageId,isActive:this.props.isActive},`notes-manager-${this.props.pageId}`)}return console.warn("Unknown Startpage Section: ",this.state.section),null};getContextMenuItems=e=>{const t=this.context.vivaldiWindowId,n=!1===this.state.drawerIsOpen&&Boolean(this.state.currentSpeeddial)&&!G.ZP.isGuest(),s=!1===this.state.drawerIsOpen&&!this.state.currentSpeeddial&&!G.ZP.isGuest(),i=Pi.getOptionFunction(e);return Pi.getNamedMenu(t,e,(async e=>{switch(e.action){case"CONTEXT_ADD_BOOKMARK_TO_SPEEDDIAL":return{handler:this.toggleStartpageDrawer,isVisible:()=>n,...i(t,e,{})};case"CONTEXT_ADD_FOLDER_TO_SPEEDDIAL":return{handler:this.createSpeedDialSet,isVisible:()=>s,...i(t,e,{})};case"CONTEXT_PASTE":return{handler:this.handlePaste,...i(t,e,{})};case"CONTEXT_CUSTOMIZE":return{handler:this.customize,isVisible:()=>!G.ZP.isGuest(),...i(t,e,{})};case"CONTEXT_UNDO":return{handler:()=>this.bookmarkActions.undo(),isEnabled:()=>this.bookmarkActions.canUndo(),...i(t,e,{})};case"CONTEXT_REDO":return{handler:()=>this.bookmarkActions.redo(),isEnabled:()=>this.bookmarkActions.canRedo(),...i(t,e,{})};default:return Promise.resolve({...i(t,e,{})})}}))};onContextMenu=e=>{e.persist(),e.preventDefault(),e.stopPropagation(),this.getContextMenuItems("startpage").then((t=>{(0,Qi.Z)(this.context,t)(e)}))};render(){if(!this.props.open)return null;const e=G.ZP.isIncognito(this.context.vivaldiWindowId);return k9(Ri,{className:"startpage",onResize:this.onResize},void 0,("on"===this.props.prefValues[$.kStartpageNavigation]||"speed_dial_only"===this.props.prefValues[$.kStartpageNavigation]&&this.state.section===zM.SpeedDial)&&k9(b9,{openMenuItem:this.openMenuItem,section:this.state.section,speedDialSet:this.state.speeddialFolders,speedDialSetNode:this.state.menuSpeeddial,createSpeedDialSet:this.createSpeedDialSet,initialEditSpeedDialSet:this.state.initialEditSpeedDialSet,setSpeedDialAwaitingEdit:this.setSpeedDialAwaitingEdit,keyAccess:this.props.prefValues[$.kKeyboardTabToAll]}),k9("div",{className:"startpage-content",onContextMenu:this.state.section===zM.SpeedDial?this.onContextMenu:null,onDoubleClick:this.handleDoubleClick},void 0,(0,fs.jsx)("div",{className:"sdwrapper",ref:this.refSDdWrapper,children:this.renderSection(e)}),this.state.section===zM.SpeedDial&&this.props.prefValues[$.kStartpageSpeedDialGameButtonShow]&&Z9),k9(I9.Z,{className:"startpage-drawer-wrapper"},void 0,this.state.section===zM.SpeedDial&&this.state.drawerIsOpen&&k9(ga.Z,{classNames:"startpage-drawer-transition",timeout:{enter:500,exit:200}},void 0,k9(l7,{node:this.state.currentSpeeddial,keyAccess:this.props.prefValues[$.kKeyboardTabToAll],maxWidth:this.state.viewWidth,onSpeedDialDrawerDone:this.onSpeedDialDrawerDone}))))}}const _9=sa(E9,A9);var M9;function N9(e,t,n,s){M9||(M9="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:M9,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const P9={small:"toolbar toolbar-statusbar",medium:"toolbar toolbar-default",large:"toolbar toolbar-mainbar"};var D9=N9("h1",{},void 0,"Toolbar Test Page");class x9 extends hs.PureComponent{render(){return N9("div",{},void 0,D9,Object.keys(P9).map((e=>N9(Rne,{name:$.kToolbarsStatus,menuOrigin:"bottomLeft",className:"toolbar-statusbar",popupPosition:"above",size:e},e))))}}var O9;function L9(e,t,n,s){O9||(O9="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:O9,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var R9=L9(x9,{});class B9 extends hs.PureComponent{static contextType=xi.Z;state={windowStyle:z.Z.getState().windowStyles.get(this.context.vivaldiWindowId)||{}};componentDidMount(){z.Z.addListener(this.onThemeStoreChanged)}componentWillUnmount(){z.Z.removeListener(this.onThemeStoreChanged)}onThemeStoreChanged=()=>{const e=z.Z.getState().windowStyles.get(this.context.vivaldiWindowId);this.setState({windowStyle:e})};render(){const e=Object.entries(this.state.windowStyle),t=e.filter((([e,t])=>e.includes("colorSuccess")||e.includes("colorWarning")||e.includes("colorError"))),n=e.filter((([e,t])=>e.includes("radius"))),s=e.filter((([e,t])=>e.includes("colorBg"))),i=e.filter((([e,t])=>e.includes("colorFg"))),o=e.filter((([e,t])=>e.includes("colorAccent"))),a=e.filter((([e,t])=>e.includes("colorHighlight"))),r=e.filter((([e,t])=>e.includes("colorBorder")));return L9("div",{className:"theme-test",tabIndex:"0"},void 0,R9,L9("h1",{},void 0,(0,Oe.Z)("Theme Color Test Page")),L9("p",{},void 0,(0,Oe.Z)("$1 color and $2 radius variables created",[Object.entries(this.state.windowStyle).length,n.length])),L9("div",{},void 0,L9("h2",{},void 0,`${(0,Oe.Z)("Info Colors")} (${t.length})`),L9("div",{className:"list"},void 0,t.map((([e,t])=>L9("div",{style:{backgroundColor:t}},e,L9("input",{type:"text",value:e,readOnly:!0}),L9("input",{type:"text",value:t,readOnly:!0})))))),L9("div",{},void 0,L9("h2",{},void 0,`${(0,Oe.Z)("Foreground Colors")} (${i.length})`),L9("div",{className:"list"},void 0,i.map((([e,t])=>L9("div",{style:{backgroundColor:t}},e,L9("input",{type:"text",value:e,readOnly:!0}),L9("input",{type:"text",value:t,readOnly:!0})))))),L9("div",{},void 0,L9("h2",{},void 0,`${(0,Oe.Z)("Background Colors")} (${s.length})`),L9("div",{className:"list"},void 0,s.map((([e,t])=>L9("div",{style:{backgroundColor:t}},e,L9("input",{type:"text",value:e,readOnly:!0}),L9("input",{type:"text",value:t,readOnly:!0})))))),L9("div",{},void 0,L9("h2",{},void 0,`${(0,Oe.Z)("Border Colors")} (${r.length})`),L9("div",{className:"list"},void 0,r.map((([e,t])=>L9("div",{style:{backgroundColor:t}},e,L9("input",{type:"text",value:e,readOnly:!0}),L9("input",{type:"text",value:t,readOnly:!0})))))),L9("div",{},void 0,L9("h2",{},void 0,`${(0,Oe.Z)("Accent Colors")} (${o.length})`),L9("div",{className:"list"},void 0,o.map((([e,t])=>L9("div",{style:{backgroundColor:t}},e,L9("input",{type:"text",value:e,readOnly:!0}),L9("input",{type:"text",value:t,readOnly:!0})))))),L9("div",{},void 0,L9("h2",{},void 0,`${(0,Oe.Z)("Highlight Colors")} (${a.length})`),L9("div",{className:"list"},void 0,a.map((([e,t])=>L9("div",{style:{backgroundColor:t}},e,L9("input",{type:"text",value:e,readOnly:!0}),L9("input",{type:"text",value:t,readOnly:!0})))))),L9("div",{},void 0,L9("h2",{},void 0,`${(0,Oe.Z)("Border radius")} (${n.length})`),L9("div",{className:"list"},void 0,n.map((([e,t])=>L9("div",{style:{radius:t}},e,L9("input",{type:"text",value:e,readOnly:!0}),L9("input",{type:"text",value:t,readOnly:!0})))))))}}const F9=B9;var V9;function W9(e,t,n,s){V9||(V9="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:V9,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var U9=W9("div",{className:"card-outline"});class H9 extends hs.Component{render(){const e=this.props.style||{};return this.props.backgroundImage&&(e.backgroundImage=`url(${this.props.backgroundImage})`),W9("button",{className:As()({"welcome-card":!0,"card-has-background":this.props.backgroundImage,"card-has-image-zoom":this.props.hasImageZoom,"card-is-done":this.props.done,"card-is-selected":this.props.selected}),disabled:this.props.done,onClick:this.props.onClick,title:this.props.tooltip??this.props.title,style:e},void 0,U9,this.props.image&&W9("div",{className:"card-image"},void 0,W9("img",{src:this.props.image,height:"78",width:"78"})),this.props.svg&&W9("div",{className:"card-image",dangerouslySetInnerHTML:{__html:this.props.svg}}),this.props.renderContent&&this.props.renderContent(),W9("div",{className:"card-text"},void 0,this.props.title))}}const z9=H9;var G9;function $9(e,t,n,s){G9||(G9="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:G9,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const K9=[{names:["chrome"],imageName:"welcomepage-chrome.svg"},{names:["chromium"],imageName:"welcomepage-chromium.svg"},{names:["firefox"],imageName:"welcomepage-firefox.svg"},{names:["opera 12"],imageName:"welcomepage-opera-12.svg"},{names:["opera"],imageName:"welcomepage-opera.svg"},{names:["safari"],imageName:"welcomepage-safari.svg"},{names:["edge legacy"],imageName:"welcomepage-edge.svg"},{names:["explorer"],imageName:"welcomepage-explorer.svg"},{names:["vivaldi"],imageName:"welcomepage-vivaldi.svg"},{names:["brave"],imageName:"welcomepage-brave.svg"},{names:["edge"],imageName:"welcomepage-edge-chromium.svg"},{names:["yandex","яндекс"],imageName:"welcomepage-yandex.svg"}],j9=["safari","edge","explorer"],Y9=["Thunderbird"];class X9 extends hs.Component{static contextType=xi.Z;constructor(e){super(e),this.state={error:null,profileStatus:[],profiles:[],toImport:[]}}componentDidMount(){C.Z.importData.getProfiles((e=>{this.setState({profileStatus:e.map((()=>"IDLE")),profiles:e})})),C.Z.importData.onImportEnded.addListener(this.onImportEnded)}componentWillUnmount(){C.Z.importData.onImportEnded.removeListener(this.onImportEnded)}toggleImport=e=>{const{toImport:t}=this.state;t.includes(e)?t.splice(t.indexOf(e),1):t.push(e),this.setState({toImport:t})};importSelected=()=>{this.startImport(this.state.toImport[0]),this.toggleImport(this.state.toImport[0])};onImportEnded=e=>{const t=this.state.profileStatus.concat([]);for(let n=0;n<this.state.profileStatus.length;n++)"STARTED"===t[n]&&(t[n]=0===e?"COMPLETED":"FAILED");0===e?this.setState({error:null,profileStatus:t}):this.setState({error:(0,Oe.Z)("An error occurred during import"),profileStatus:t}),this.state.toImport.length>0&&this.importSelected()};startImport(e){const t=this.state.profiles[e];let n="";t.UserProfiles&&t.UserProfiles[0]&&t.UserProfiles[0].profileName&&(n=t.UserProfiles[0].profileName);const s={history:t.history,favorites:t.favorites,passwords:t.passwords,notes:t.notes,speeddial:t.speeddial};this.setState((t=>{const n=t.profileStatus.concat([]);return n[e]="STARTED",{profileStatus:n}}),(()=>{C.Z.importData.startImport(e,true,n,s,"","",(()=>{}))}))}render(){const e=this.state.profileStatus.some((e=>"COMPLETED"===e));return $9("div",{className:"welcome-content-outer"},void 0,$9("div",{className:"welcome-content-inner welcome-center-horizontal welcome-center-vertical"},void 0,$9("h1",{},void 0,this.props.title),this.props.callout.map(((e,t)=>$9("p",{},t,e))),$9("div",{className:"cards-container cards-container-import"},void 0,this.state.profiles.map(((e,t)=>{const{name:n,imageName:s}=function(e){const t=e.toLowerCase();for(let e=0;e<K9.length;e++)for(let n=0;n<K9[e].names.length;n++)if(t.includes(K9[e].names[n]))return{name:K9[e].names[n],imageName:K9[e].imageName};return{name:e,imageName:""}}(e.name),i=this.state.profileStatus[t];return!e.hasDefaultInstall&&!j9.includes(n)||Y9.includes(n)?null:$9(z9,{done:"COMPLETED"===i,onClick:()=>this.toggleImport(t),selected:this.state.toImport.includes(t),title:"COMPLETED"===i?(0,Oe.Z)("Imported"):e.name,image:`resources/${s}`},t)}))),$9("div",{className:"pad-top"},void 0,this.state.toImport.length?$9("input",{type:"submit",className:"welcome-button",onClick:this.importSelected,value:(0,Oe.Z)("Import Selected")}):$9("button",{tabIndex:0,className:"welcome-button primary",onClick:this.props.continue},void 0,e?this.props.continueText:(0,Oe.Z)("Skip"))),this.state.error&&$9("p",{},void 0,this.state.error)))}}const Q9=X9;var q9;function J9(e,t,n,s){q9||(q9="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:q9,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const e8=[$.kVivaldiCrashReportingConsentGranted];var t8=J9("div",{}),n8=J9("img",{className:"welcome-icon",src:"../../resources/vivaldi-icon-macos.png"});class s8 extends hs.Component{static contextType=xi.Z;componentDidMount(){H.Z.addListener(e8,this.onPrefsCacheChanged)}componentWillUnmount(){H.Z.removeListener(e8,this.onPrefsCacheChanged)}onPrefsCacheChanged=()=>this.forceUpdate();toggleCrashReportConsent=()=>{Ne.Z.set($.kVivaldiCrashReportingConsentGranted,!H.Z.get($.kVivaldiCrashReportingConsentGranted))};openPrivacyPage=()=>{d.ZP.openURL(this.context.vivaldiWindowId,h.fg)};renderCrashReportingConsent(){return t8}render(){return J9("div",{className:"welcome-content-outer"},void 0,J9("div",{className:"effect-container",style:{backgroundImage:`url('/resources/${navigator.deviceMemory<8||navigator.hardwareConcurrency<=4||screen.colorDepth<24||window.matchMedia("(prefers-reduced-motion: reduce)").matches?"startup-static":"startup"}.svg')`}}),J9("div",{className:"welcome-content-inner welcome-center-horizontal welcome-center-vertical"},void 0,n8,J9("h1",{},void 0,this.props.title),J9("p",{},void 0,this.props.callout[0]),J9("button",{tabIndex:0,className:"welcome-button primary",onClick:this.props.continue},void 0,this.props.continueText),this.renderCrashReportingConsent()))}}const i8=s8;var o8;function a8(e,t,n,s){o8||(o8="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:o8,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const r8=[$.kThemeScheduleEnabled,$.kThemeScheduleOS,$.kThemeScheduleTimeline,$.kThemesCurrent,$.kThemesSystem];class l8 extends hs.Component{static contextType=xi.Z;context;toggleOSSchedule=()=>{const e="system"===this.props.prefValues[$.kThemeScheduleEnabled]?"off":"system";Ne.Z.set($.kThemeScheduleEnabled,e)};render(){const{prefValues:e}=this.props,t=is.Z.getCurrentIdWithoutPreview();return a8("div",{className:"welcome-content-outer"},void 0,a8("div",{className:"welcome-content-inner welcome-center-horizontal welcome-center-vertical"},void 0,a8("h1",{},void 0,this.props.title),a8("p",{className:navigator.onLine&&"link",onClick:navigator.onLine?()=>d.ZP.openURL(this.context.vivaldiWindowId,"https://themes.vivaldi.net/",{inCurrent:!1,singleton:!0}):void 0},void 0,this.props.callout[0]),a8("label",{className:"welcome-pref-checkbox"},void 0,a8(fb,{value:"system",checked:"system"===e[$.kThemeScheduleEnabled],onChange:this.toggleOSSchedule}),a8("span",{},void 0,this.props.callout[1])),a8("div",{className:"cards-container"},void 0,e[$.kThemesSystem].slice(0,4).map((e=>{const n=e.id===t,s=As()("ThemePreview","ThemePreview-Welcome","welcome-card",{"card-is-selected":n});return a8("div",{onClick:()=>is.Z.setTheme(e.id)},e.id,a8(FJ,{className:s,theme:e,welcomePage:!0,isCurrent:!1,isSystem:!0}))}))),a8("button",{tabIndex:0,className:"welcome-button primary",onClick:this.props.continue},void 0,this.props.continueText)))}}const d8=sa(l8,r8);var c8;function h8(e,t,n,s){c8||(c8="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:c8,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const p8={essentials:n(5733),fullyLoaded:n(81794)},u8="https://vivaldi.com/getstarted/",g8="https://vivaldi.com/getstarted-mail/",m8=[$.kMailIsTurnedOff,$.kPanelsWindowDefaults,$.kStatusBarDisplay,$.kToolbarsNavigation];class v8 extends hs.Component{static contextType=xi.Z;context;getUIMode=()=>this.props.prefValues[$.kMailIsTurnedOff]?"essentials":"fullyLoaded";setEssentials=()=>{Ne.Z.set($.kMailIsTurnedOff,!0)};setFullyLoaded=()=>{Ne.Z.set($.kMailIsTurnedOff,!1)};render(){const e=this.context.vivaldiWindowId,t=this.getUIMode();return h8("div",{className:"welcome-content-outer"},void 0,h8("div",{className:"welcome-content-inner welcome-center-horizontal welcome-center-vertical"},void 0,h8("h1",{},void 0,this.props.title),h8("p",{},void 0,this.props.callout[0]),h8("div",{className:"cards-container"},void 0,h8(z9,{onClick:this.setEssentials,title:this.props.callout[1],selected:"essentials"===t,svg:p8.essentials}),h8(z9,{onClick:this.setFullyLoaded,title:this.props.callout[2],selected:"fullyLoaded"===t,svg:p8.fullyLoaded})),h8("link",{rel:"prefetch",href:"essentials"===t?u8:g8}),h8("button",{className:"welcome-button primary",onClick:()=>{"fullyLoaded"===t&&Ae.Z.showMailAccountDialog(e),navigator.onLine?d.ZP.openURL(e,"essentials"===t?u8:g8,{inCurrent:!0}):this.props.continue()}},void 0,"essentials"===t?this.props.callout[3]:this.props.callout[4])))}}const f8=sa(v8,m8);var y8;function C8(e,t,n,s){y8||(y8="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:y8,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const w8=[$.kTabsBarPosition],b8={top:{title:(0,Oe.Z)("Top"),image:n(48753)},left:{title:(0,Oe.Z)("title","Left"),image:n(31614)},bottom:{title:(0,Oe.Z)("Bottom"),image:n(34511)},right:{title:(0,Oe.Z)("title","Right"),image:n(76201)}};class S8 extends hs.Component{setPosition=e=>{Ne.Z.set($.kTabsBarPosition,e),Ne.Z.set($.kPanelsPosition,"left"===e?"right":"left")};render(){return C8("div",{className:"welcome-content-outer"},void 0,C8("div",{className:"welcome-content-inner welcome-center-horizontal welcome-center-vertical"},void 0,C8("h1",{},void 0,this.props.title),C8("p",{},void 0,this.props.callout[0]),C8("div",{className:"cards-container"},void 0,Object.keys(b8).map((e=>C8(z9,{onClick:this.setPosition.bind(this,e),title:b8[e].title,selected:e===this.props.prefValues[$.kTabsBarPosition],svg:b8[e].image},e)))),C8("button",{tabIndex:0,className:"welcome-button primary",onClick:this.props.continue},void 0,this.props.continueText)))}}const I8=sa(S8,w8);var k8;function A8(e,t,n,s){k8||(k8="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:k8,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class T8 extends hs.Component{state={trackerBlockingEnabled:!1,adBlockingEnabled:!1};componentDidMount(){this.updateRules(),C.Z.contentBlocking.onStateChanged.addListener(this.updateRules)}componentWillUnmount(){C.Z.contentBlocking.onStateChanged.removeListener(this.updateRules)}updateRules=()=>{["ad_blocking","tracking"].forEach((e=>{C.Z.contentBlocking.getActiveExceptionsList(e,(t=>{const n="tracking"===e?"trackerBlockingEnabled":"adBlockingEnabled";this.setState({[n]:"exempt_list"===t})}))}))};setNoBlocking=()=>{C.Z.contentBlocking.setActiveExceptionsList("tracking","process_list"),C.Z.contentBlocking.setActiveExceptionsList("ad_blocking","process_list"),this.updateRules()};setTrackerBlocking=()=>{C.Z.contentBlocking.setActiveExceptionsList("tracking","exempt_list"),C.Z.contentBlocking.setActiveExceptionsList("ad_blocking","process_list"),this.updateRules()};setTrackerAndAdBlocking=()=>{C.Z.contentBlocking.setActiveExceptionsList("tracking","exempt_list"),C.Z.contentBlocking.setActiveExceptionsList("ad_blocking","exempt_list"),this.updateRules()};getBlockLevel=()=>{let e=0;return this.state.trackerBlockingEnabled&&(e=1),this.state.trackerBlockingEnabled&&this.state.adBlockingEnabled&&(e=2),e};render(){const e=this.getBlockLevel();return A8("div",{className:"welcome-content-outer"},void 0,A8("div",{className:"welcome-content-inner welcome-center-horizontal welcome-center-vertical"},void 0,A8("h1",{},void 0,this.props.title),this.props.callout.map(((e,t)=>A8("p",{},t,e))),A8("div",{className:"cards-container card-blocker"},void 0,A8(z9,{onClick:this.setNoBlocking,title:(0,Oe.Z)("No Blocking"),hasImageZoom:!0,tooltip:(0,Oe.Z)("No content blocking will be applied to any site by default."),selected:0===e,svg:Ts.Tu3,style:{"--no-blocking":1,"--base":0}}),A8(z9,{onClick:this.setTrackerBlocking,title:(0,Oe.Z)("Block Trackers"),hasImageZoom:!0,tooltip:(0,Oe.Z)("Online trackers collect personal information and browsing habits across multiple sites."),selected:1===e,svg:Ts.Tu3,style:{"--trackers":1}}),A8(z9,{onClick:this.setTrackerAndAdBlocking,title:(0,Oe.Z)("Block Trackers and Ads"),hasImageZoom:!0,tooltip:(0,Oe.Z)("Web advertisement supports existence of many sites but can also be used to build a personal profile for monetization."),selected:2===e,svg:Ts.Tu3,style:{"--ads":1}})),A8("button",{tabIndex:0,className:"welcome-button primary",onClick:this.props.continue},void 0,this.props.continueText)))}}const Z8=T8,E8={intro:(0,Oe.Z)("Welcome to Vivaldi"),tracker_and_ad:(0,Oe.Z)("browser","Tracker and Ad Blocking"),import_data:(0,Oe.Z)("Bring your favorites to Vivaldi"),personalize:(0,Oe.Z)("Choose your style"),tabs:(0,Oe.Z)("How do you like your tabs?"),welcome_feature_amount:(0,Oe.Z)("Manage your email in the browser, with Vivaldi Mail")},_8={intro:[(0,Oe.Z)("Powerful. Personal. Private."),(0,Oe.Z)("Allow Vivaldi to Send Automatic Crash Reports"),(0,Oe.Z)("Crash reports include the most recently visited webpage. It may send more personal information which is promptly deleted."),(0,Oe.Z)("Privacy policy")],tracker_and_ad:[(0,Oe.Z)("Trackers want to record all your online activities and data. But you can limit them. Set your blocking preference.")],import_data:[(0,Oe.Z)("Select your old web browsers to import bookmarks, history, passwords, and other data.")],personalize:[(0,Oe.Z)("Get personal with even more themes from Vivaldi Themes."),(0,Oe.Z)("Follow Operating System Theme Color")],tabs:[(0,Oe.Z)("Keep the classic horizontal tab bar or try the vertical tab bar.")],welcome_feature_amount:[(0,Oe.Z)("Choose whether you want to start using the Vivaldi browser right away or set up the powerful built-in Mail client first. The choice is yours."),(0,Oe.Z)("Web Browser"),(0,Oe.Z)("Browser, Mail, and Calendar"),(0,Oe.Z)("Start browsing"),(0,Oe.Z)("Set up Vivaldi Mail")]},M8={getUnseenPageKeys:()=>Object.keys(E8).filter((e=>!H.Z.get($.kWelcomeSeenPages).includes(e))),hasUnseenPages:()=>M8.getUnseenPageKeys().length>0,getUnreadPageKeys:()=>Object.keys(E8).filter((e=>!H.Z.get($.kWelcomeReadPages).includes(e))),hasUnreadPages:()=>M8.getUnreadPageKeys().length>0,markAllAsSeen:()=>{const e=H.Z.get($.kWelcomeSeenPages),t=M8.getUnseenPageKeys();Ne.Z.set($.kWelcomeSeenPages,e.concat(t))}},N8=M8;var P8;function D8(e,t,n,s){P8||(P8="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:P8,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const x8=[$.kWelcomeReadPages],O8={enter:1e3,exit:1e3};var L8=D8("svg",{className:"guest-intro-background",viewBox:"0 0 1244 860"},void 0,D8("path",{fill:"url(#guest-intro-bg-gradient)",d:"M0 0h153.513c16.141 27.93 32.15 55.734 47.912 83.11 16.086 27.94 32.722 56.832 49.076 85.128 11.01 19.031 22.079 38.316 32.781 56.967 25.186 43.883 51.228 89.259 77.402 132.848 33.382 55.651 75.894 82.121 137.77 85.829 3.205.192 6.454.288 9.655.288 39.673 0 78.14-14.461 108.316-40.722 21.644-18.834 48.687-52.291 54.604-104.667.749-6.654 1.357-13.708 1.855-19.573-1.07-29.74-6.476-52.92-17.294-74.518C622.935 139.46 612.708 67.99 625.087 0h136.676C747.1 44.93 749.845 96.364 774.32 145.251c20.839 41.6 30.654 85.7 31.485 138.023-.568 6.192-1.472 18.273-2.83 30.356-17.572 155.524-149.172 263.318-294.866 263.318-5.816 0-11.67-.173-17.526-.521C382.84 569.97 301.9 518.174 246.822 426.358c-38.015-63.313-74.255-127.68-111.253-191.634C90.359 156.507 45.49 78.062 0 0zm1113.47 0H1244v140.1c-7.496 27.86-18.849 54.995-34.031 81.275a1299530.57 1299530.57 0 0 1-170.255 294.799A1223193.145 1223193.145 0 0 0 841.018 860.24H687.72c135.675-235.123 271.527-470.147 407.26-705.25 22.311-38.621 31.22-79.696 25.368-124.548A170.12 170.12 0 0 0 1113.471 0z"}));function R8(e){return D8("div",{className:"guest-intro"},void 0,L8,D8("div",{className:"guest-intro-content"},void 0,D8("h1",{},void 0,(0,Oe.Z)("Welcome Page Unavailable")),D8("p",{},void 0,(0,Oe.Z)("Welcome page is not available in guest windows.")),D8("p",{},void 0,D8("a",{tabIndex:0,href:uA,onClick:t=>gA(e.windowId,t)},void 0,(0,Oe.Z)("Learn more about Guest Profiles")))))}class B8 extends hs.Component{static contextType=xi.Z;nodeRef=hs.createRef();constructor(e,t){super(e);const n=this.getNextUnread(),s=Object.keys(E8),i=n||s[s.length-1];this.state={currentPageKey:i,minimalUI:"intro"===i&&N8.hasUnseenPages()}}componentDidMount(){N8.hasUnseenPages()&&"intro"===this.state.currentPageKey&&N8.markAllAsSeen()}componentDidUpdate(e,t){!t.minimalUI&&this.state.minimalUI||this.state.minimalUI&&this.setState({minimalUI:!1})}setPage=e=>()=>{this.setCurrentPageRead(),this.scrollToTop(),this.setState({currentPageKey:e})};getNextUnread=e=>{const t=Object.keys(E8),n=this.props.prefValues[$.kWelcomeReadPages],s=e?t.indexOf(e):-1;for(let e=-1;e<t.length;e++){const i=e+1;if(t[i]&&!n.includes(t[i])&&i>s)return t[i]}return N8.getUnreadPageKeys()[0]};getNextPageKey=()=>{const e=Object.keys(E8);return e.find(((t,n)=>this.state.currentPageKey===e[n-1]))};setCurrentPageRead=()=>{const e=this.props.prefValues[$.kWelcomeReadPages],t=this.state.currentPageKey;e.includes(t)||Ne.Z.set($.kWelcomeReadPages,e.concat([t]))};continue=()=>{this.setCurrentPageRead();const e=this.getNextPageKey();if(e)this.scrollToTop(),this.setState({currentPageKey:e});else{const e=this.context.vivaldiWindowId;d.ZP.openURL(e,ie.ZP.getDefaultStartpage(e),{inCurrent:!0})}};getContinueText=()=>N8.getUnreadPageKeys().length===Object.keys(E8).length&&this.state.currentPageKey===Object.keys(E8)[0]?(0,Oe.Z)("Let’s Go"):(0,Oe.Z)("Continue");scrollToTop=()=>{const{Element:e}=this.context,t=this.nodeRef.current?.firstChild;t instanceof e&&t.scrollTo({behavior:"smooth",top:0})};render(){if(G.ZP.isGuest())return D8(R8,{windowId:this.context.vivaldiWindowId});const e=this.getContinueText(),t="personalize"===this.state.currentPageKey,{prefValues:n}=this.props,s=N8.getUnreadPageKeys().length;return(0,fs.jsxs)("div",{ref:this.nodeRef,className:As()("welcome-wrapper",this.state.currentPageKey,{"welcome-wrapper-animate":5===s,"welcome-soft-background":!t,"welcome-minimal-ui":this.state.minimalUI}),children:[D8(I9.Z,{className:"welcome-content"},void 0,"intro"===this.state.currentPageKey&&D8(ga.Z,{classNames:"welcome-page",timeout:O8},void 0,D8(i8,{continue:this.continue,continueText:e,title:E8[this.state.currentPageKey],callout:_8[this.state.currentPageKey],prefValues:n})),"welcome_feature_amount"===this.state.currentPageKey&&D8(ga.Z,{classNames:"welcome-page",timeout:O8},void 0,D8(f8,{continue:this.continue,continueText:e,title:E8[this.state.currentPageKey],callout:_8[this.state.currentPageKey]})),"tracker_and_ad"===this.state.currentPageKey&&D8(ga.Z,{classNames:"welcome-page",timeout:O8},void 0,D8(Z8,{continue:this.continue,continueText:e,title:E8[this.state.currentPageKey],callout:_8[this.state.currentPageKey]})),"import_data"===this.state.currentPageKey&&D8(ga.Z,{classNames:"welcome-page",timeout:O8},void 0,D8(Q9,{continue:this.continue,continueText:e,title:E8[this.state.currentPageKey],callout:_8[this.state.currentPageKey]})),"personalize"===this.state.currentPageKey&&D8(ga.Z,{classNames:"welcome-page",timeout:O8},void 0,D8(d8,{continue:this.continue,continueText:e,title:E8[this.state.currentPageKey],callout:_8[this.state.currentPageKey]})),"tabs"===this.state.currentPageKey&&D8(ga.Z,{classNames:"welcome-page",timeout:O8},void 0,D8(I8,{continue:this.continue,continueText:e,title:E8[this.state.currentPageKey],callout:_8[this.state.currentPageKey]}))),D8("div",{className:"welcome-navigation"},void 0,Object.keys(E8).map((e=>D8("button",{onClick:this.setPage(e),title:E8[e],tabIndex:-1,className:As()("nav-page",{"nav-page-current":e===this.state.currentPageKey,"nav-page-completed":e!==this.state.currentPageKey&&n[$.kWelcomeReadPages].includes(e)})},e))))]})}}var F8;function V8(e,t,n,s){F8||(F8="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:F8,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var W8=V8(sa(B8,x8),{},"welcome"),U8=V8(F9,{},"welcome"),H8=V8(hA,{},"experiments"),z8=V8(fA,{},"guest-intro"),G8=V8(VM,{},"private-intro"),$8=V8(tA,{},"actionlog"),K8=V8(HM,{}),j8=V8("div",{},"mailmessage"),Y8=V8("div",{},"chat");class X8 extends hs.PureComponent{static contextType=xi.Z;refComponent=hs.createRef();focus=()=>{const e=this.refComponent.current,{document:t,HTMLDivElement:n}=this.context;if(!(e instanceof n))return;if(e.contains(t.activeElement))return;const s=e.querySelector('[tabindex="0"]:not(.no-page-focus)');s?.focus()};getComponent=()=>{const{url:e}=this.props;if(je.jk.matchInternal("welcome",e))return W8;if(je.jk.matchInternal("themecolors",e))return U8;if(je.jk.matchInternal("settings",e))return V8(e2,{url:e},"settings");if(je.jk.matchInternal("experiments",e))return H8;if(je.jk.matchInternal("guest-intro",e))return z8;if(je.jk.matchInternal("private-intro",e))return G8;if(je.jk.matchInternal("actionlog",e))return $8;if(je.jk.matchInternal("saga",e))return K8;if(je.jk.matchInternal("mailpage",e)){if(H.Z.get($.kMailIsTurnedOff))return V8(cT,{windowId:this.context.vivaldiWindowId});if(je.jk.matchUrl(je.jk.internalUrl("mailpage","composer"),e)){const t=(0,vs.DP)(e);let n;if(t.query)try{const e=JSON.parse(t.query);"object"==typeof e&&(n=e.id)}catch(e){console.warn(e)}return V8(rT,{pageId:this.props.pageId,searchListId:n,mailto:t.mailto,url:e,isActive:this.props.isActive},"mail")}if(je.jk.matchUrl(je.jk.internalUrl("mailpage","message"),e)){let t=-1;const n=(0,vs.DP)(e);if(n.path){const e=n.path.split("/");2===e.length&&(t=parseInt(e[1]))}return t>-1?V8(oE,{id:t,isActive:this.props.isActive},"mailmessage"):j8}return V8(PM,{id:this.props.pageId,isActive:this.props.isActive},"mailview")}if(je.jk.matchInternal("chat",e)&&ds.Z.isEnabled("chat")){const t=new URL(e).searchParams.get("path");t&&t.includes("@");return Y8}return null};render(){const{isVisible:e,url:t}=this.props;let n=zM.SpeedDial;const s=je.jk.isStartPage(t);return(0,je.rl)(t)&&(je.jk.matchInternal("bookmarks",t)?n=zM.Bookmarks:je.jk.matchInternal("history",t)?n=zM.History:je.jk.matchInternal("calendar",t)?n=zM.Calendar:je.jk.matchInternal("notes",t)&&(n=zM.NotesManager)),(0,fs.jsx)("div",{className:"internal-page",ref:this.refComponent,children:(0,fs.jsxs)(fs.Fragment,{children:[V8(_9,{open:s&&e||n!==zM.SpeedDial,pageId:this.props.pageId,url:t,view:n,updatePageThumbnailWithActiveWebview:this.props.updatePageThumbnailWithActiveWebview,isActive:this.props.isActive},"startpage"),this.getComponent()]})})}}const Q8=X8;var q8=n(7168);const J8=new class{setUtilityWebView(e,t){y.Z.dispatch({actionType:"UTILITY_WEBVIEW_SET_VIEW",windowId:e,webview:t})}};class eee extends hs.PureComponent{refWebView=hs.createRef();componentDidMount(){const e=this.refWebView.current;e&&(e.addEventListener("contentload",this.handleContentload),e.addEventListener("contentscreated",this.handleContentscreated),e.addEventListener("createsearch",this.handleCreatesearch),e.addEventListener("contentallowed",this.handleContentallowed),e.addEventListener("contentblocked",this.handleContentblocked),e.addEventListener("dialog",this.handleDialog),e.addEventListener("findupdate",this.handleFindupdate),e.addEventListener("fullscreen",this.handleFullscreen),e.addEventListener("loadabort",this.handleLoadabort),e.addEventListener("loadcommit",this.handleLoadcommit),e.addEventListener("loadprogress",this.handleLoadprogress),e.addEventListener("loadredirect",this.handleLoadredirect),e.addEventListener("loadstart",this.handleLoadstart),e.addEventListener("loadstop",this.handleLoadstop),e.addEventListener("newwindow",this.handleNewwindow),e.addEventListener("pasteandgo",this.handlePasteandgo),e.addEventListener("permissionrequest",this.handlePermissionrequest),e.addEventListener("sslstatechanged",this.handleSslstatechanged),e.addEventListener("targeturlchanged",this.handleTargetUrlChanged),e.addEventListener("windowblocked",this.handleWindowblocked),this.props.discarded&&this.props.isVisible&&s.Z.tabs.reload(this.props.id))}componentWillUnmount(){const e=this.refWebView.current;e&&(e.removeEventListener("contentload",this.handleContentload),e.removeEventListener("contentscreated",this.handleContentscreated),e.removeEventListener("createsearch",this.handleCreatesearch),e.removeEventListener("contentallowed",this.handleContentallowed),e.removeEventListener("contentblocked",this.handleContentblocked),e.removeEventListener("dialog",this.handleDialog),e.removeEventListener("findupdate",this.handleFindupdate),e.removeEventListener("fullscreen",this.handleFullscreen),e.removeEventListener("loadabort",this.handleLoadabort),e.removeEventListener("loadcommit",this.handleLoadcommit),e.removeEventListener("loadprogress",this.handleLoadprogress),e.removeEventListener("loadredirect",this.handleLoadredirect),e.removeEventListener("loadstart",this.handleLoadstart),e.removeEventListener("loadstop",this.handleLoadstop),e.removeEventListener("newwindow",this.handleNewwindow),e.removeEventListener("pasteandgo",this.handlePasteandgo),e.removeEventListener("permissionrequest",this.handlePermissionrequest),e.removeEventListener("sslstatechanged",this.handleSslstatechanged),e.removeEventListener("targeturlchanged",this.handleTargetUrlChanged),e.removeEventListener("windowblocked",this.handleWindowblocked))}componentDidUpdate(){this.props.discarded&&this.props.isVisible&&s.Z.tabs.reload(this.props.id)}handleContentload=e=>{this.props.onContentLoad?.(e)};handleContentscreated=e=>{this.props.onContentsCreated?.(e)};handleCreatesearch=e=>{this.props.onCreateSearch?.(e)};handleContentallowed=e=>{this.props.onContentAllowed?.(e)};handleContentblocked=e=>{this.props.onContentBlocked?.(e)};handleDialog=e=>{this.props.onDialog?.(e)};handleFindupdate=e=>{this.props.onFindUpdate?.(e)};handleFullscreen=e=>{this.props.onFullscreen?.(e)};handleLoadabort=e=>{this.props.onLoadAbort?.(e)};handleLoadcommit=e=>{this.props.onLoadCommit?.(e)};handleLoadprogress=e=>{this.props.onLoadProgress?.(e)};handleLoadredirect=e=>{this.props.onLoadRedirect?.(e)};handleLoadstart=e=>{this.props.onLoadStart?.(e)};handleLoadstop=e=>{this.props.onLoadStop?.(e)};handleNewwindow=e=>{this.props.onNewWindow?.(e)};handlePasteandgo=e=>{this.props.onPasteAndGo?.(e)};handlePermissionrequest=e=>{this.props.onPermissionRequest?.(e)};handleSslstatechanged=e=>{this.props.onSslStateChanged?.(e)};handleTargetUrlChanged=e=>{this.props.onTargetUrlChanged?.(e)};handleWindowblocked=e=>{this.props.onWindowBlocked?.(e)};canGoBack=()=>!!this.refWebView.current&&this.refWebView.current.canGoBack();canGoForward=()=>!!this.refWebView.current&&this.refWebView.current.canGoForward();executeScript=e=>new Promise(((t,n)=>{this.refWebView.current?.executeScript(e,(e=>{s.Z.runtime.lastError?n(s.Z.runtime.lastError.message):t(e)}))}));reload=()=>{this.refWebView.current?.reload()};stop=()=>{this.refWebView.current?.stop()};sendRequest=(e,t,n,s,i,o)=>{this.refWebView.current?.sendRequest(e,t,n,s,i,o)};render(){return(0,fs.jsx)("webview",{ref:this.refWebView,id:this.props.id,tab_id:this.props.id})}}var tee=n(2497);var nee=n(60339);var see,iee=n(34155);function oee(e,t,n,s){see||(see="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:see,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const aee=[$.kMailIsTurnedOff,$.kRssDetectFeeds,$.kWebpagesReaderControls,$.kWebpagesReaderStyle],ree=(0,no.Z)((e=>e()));var lee=oee(sK,{prefs:!1,filter:""});class dee extends hs.PureComponent{static contextType=xi.Z;captureScheduled=!1;viewUnchangedFlags={};_localStatus=!1;refInternalPage=hs.createRef();refWebview=hs.createRef();nodeRef=hs.createRef();constructor(e){super(e);const t=e.pinned&&H.Z.get($.kTabsAlwaysLoadPinnedAfterRestore);this.state={draggedLength:null,customData:null,dockingState:"off",undockedIsUnmounted:!0,undockedDevtoolsWindowId:void 0,pendingDockingState:void 0,viewWidth:"auto",viewHeight:"auto",viewTop:0,viewLeft:0,hideInspectedContents:!1,disableWebviewEvents:!1,tabIsFullscreen:!1,mediaState:q8.Z.getState().get(this.props.id)||(0,te.l4)(),mountWebView:e.isVisible||!e.discarded||t}}componentDidMount(){this.attachEventHandlers(),this.updateFocus(this.props.id,this.props.url),this.props.isActive&&iee.nextTick((()=>{const e=this.getWebviewElement();e&&J8.setUtilityWebView(this.context.vivaldiWindowId,e)})),q8.Z.addListener(this._onMediaStateStoreChanged),(0,je.cw)(this.props.url)||this.injectScripts(this.props.id)}componentDidUpdate(e,t){const{target:n}=this.props;if(n&&n!==e.target){const{transition:e,fromUrlField:t,postParams:s,headers:i}=n;this.props.url&&iee.nextTick((()=>{this.refWebview.current?.sendRequest(this.props.url,e,Boolean(t),void 0!==s&&""!==s,s||"",i||"")}))}if(this.props.url!==e.url){let t="",n="";try{t=new URL(e.url).origin}catch(e){}try{n=new URL(this.props.url).origin}catch(e){}t!==n&&iee.nextTick((()=>{aS.Z.resetPermissions(e.id),aS.Z.resetPageHasBlockedContent(e.id),aS.Z.resetBlockedPopups(e.id)}))}!e.discarded&&this.props.discarded?this.setState({mountWebView:!1}):!e.isVisible&&this.props.isVisible&&this.setState({mountWebView:!0}),(n&&n!==e.target||e.url!==this.props.url||e.isActive!==this.props.isActive||e.discarded!==this.props.discarded)&&this.updateFocus(this.props.id,this.props.url);const s=this.getWebviewElement();if(s){const t=e.discarded&&!this.props.discarded,n=(!e.isActive||t)&&this.props.isActive;if(n){iee.nextTick((()=>J8.setUtilityWebView(this.context.vivaldiWindowId,s)));!this.props.vivExtData.thumbnail&&iee.nextTick((()=>{this.updatePageThumbnailWithActiveWebview(0)}))}const i=e.isActive&&!this.props.isActive,o=(0,je.cw)(e.url),a=(0,je.cw)(this.props.url),r=!o&&a;a||!n&&!o?(i||r)&&iee.nextTick((()=>{if(this.clearWebview(),this.state.tabIsFullscreen){this.getWebviewElement()?.setIsFullscreen(!1)}})):iee.nextTick((()=>{const e=this.getWebviewElement();e&&HI.setActiveWebView(this.context.vivaldiWindowId,e)}))}this.props.vivExtData.readerMode&&!e.vivExtData.readerMode?this.injectReaderView():!this.props.vivExtData.readerMode&&e.vivExtData.readerMode&&this.refWebview.current?.reload(),this.props.prefValues[$.kWebpagesReaderStyle]!==e.prefValues[$.kWebpagesReaderStyle]&&this.updateReaderStyle(),this.updateViewUnchangedFlag(e,this.props);const i=e.prefValues[$.kRssDetectFeeds],o=!this.props.prefValues[$.kRssDetectFeeds];i&&o&&zn.resetRssFeeds(this.props.id)}componentWillUnmount(){this.state.tabIsFullscreen&&iee.nextTick((()=>{cs.Z.restoreStateAfterHTMLFullscreen(this.context.vivaldiWindowId)})),this.removeEventHandlers(),C.Z.devtoolsPrivate.closeDevtools(this.props.id,(e=>{})),this.state.undockedDevtoolsWindowId&&cs.Z.close(this.state.undockedDevtoolsWindowId),iee.nextTick(this.clearWebview),q8.Z.removeListener(this._onMediaStateStoreChanged),z.Z.ensureRemovedListener(this.updateReaderStyle)}_onMediaStateStoreChanged=()=>{this.setState({mediaState:q8.Z.getState().get(this.props.id)||(0,te.l4)()})};updateReaderStyle=()=>{if(!this.props.vivExtData.readerMode)return;const e={...this.props.prefValues[$.kWebpagesReaderStyle],...z.Z.getReaderThemeColor(this.context.vivaldiWindowId)};!function(e,t,n){new Promise(((i,o)=>{s.Z.tabs.sendMessage(e,t,n,(e=>{s.Z.runtime.lastError?o(s.Z.runtime.lastError.message):i(e)}))}))}(this.props.id,{readerStyle:e})};getWebviewElement=()=>this.refWebview.current?.refWebView.current;clearWebview=()=>{const e=this.getWebviewElement();e&&HI.clearIfActive(this.context.vivaldiWindowId,e)};toggleImageInspector=()=>{d.ZP.setImageInspector(this.props.id,this.context.vivaldiWindowId,!this.props.showImageInspector)};updateViewUnchangedFlag=(e,t)=>{e.isActive===t.isActive&&e.vivExtData.tiling===t.vivExtData.tiling||(this.viewUnchangedFlags={})};updatePageThumbnailWithActiveWebview=e=>{const t=G.ZP.isIncognitoOrGuest(this.context.vivaldiWindowId),n=crypto.randomUUID();this.viewUnchangedFlags[n]=!0===this.props.isActive,setTimeout((()=>{const e=this.getWebviewElement();if(e)if((0,je.cw)(this.props.url))this.viewUnchangedFlags[n]&&e&&hr.getPageThumbnail(e,{compact:!0},(e=>{this.props.isActive&&this.viewUnchangedFlags[n]&&e&&d.ZP.setThumbnail(this.props.id,e)}));else{const e={encodeFormat:"jpg",encodeQuality:80,fullPage:!1,width:330,height:270};C.Z.thumbnails.captureTab(this.props.id,e,((e,t)=>{!s.Z.runtime.lastError&&e&&d.ZP.setThumbnail(this.props.id,t)}))}}),e);const{bookmarkThumbnailQueue:i}=this.props.pageContext;if(!t&&i&&i.url===this.props.url){const e=i.bookmarkId;s.Z.bookmarks.get(e,(t=>{if(s.Z.runtime.lastError)console.warn("chrome.bookmarks.get failed:",e,s.Z.runtime.lastError);else{const e=t&&1===t.length?t[0]:null,i=this.getWebviewElement();e&&!e.thumbnail&&i&&hr.getPageThumbnail(i,{compact:!1},(t=>{t&&(this.props.isActive&&e&&this.viewUnchangedFlags&&this.viewUnchangedFlags[n]?s.Z.bookmarks.update(e.id,{thumbnail:t}):console.warn("Cannot update thumbnail as page was not active"))}))}})),this.props.pageContext.bookmarkThumbnailQueue=void 0}};attachEventHandlers=()=>{qa.Z.addListener(this._onWebpageviewStoreChanged),C.Z.devtoolsPrivate.onDockingSizesChanged.addListener(this.onDockingSizesChanged),C.Z.devtoolsPrivate.onDockingStateChanged.addListener(this.onDockingStateChanged),C.Z.devtoolsPrivate.onClosed.addListener(this.onDevtoolsClosed),C.Z.devtoolsPrivate.onDevtoolsUndocked.addListener(this.onDevtoolsUndocked),C.Z.tabsPrivate.onTabIsAttached.addListener(this.onWebViewElementIsAttached),C.Z.tabsPrivate.onTabIsDetached.addListener(this.onWebViewElementIsDetached)};removeEventHandlers=()=>{qa.Z.removeListener(this._onWebpageviewStoreChanged),C.Z.devtoolsPrivate.onDockingSizesChanged.removeListener(this.onDockingSizesChanged),C.Z.devtoolsPrivate.onDockingStateChanged.removeListener(this.onDockingStateChanged),C.Z.devtoolsPrivate.onClosed.removeListener(this.onDevtoolsClosed),C.Z.devtoolsPrivate.onDevtoolsUndocked.removeListener(this.onDevtoolsUndocked),C.Z.tabsPrivate.onTabIsAttached.removeListener(this.onWebViewElementIsAttached),C.Z.tabsPrivate.onTabIsDetached.removeListener(this.onWebViewElementIsDetached)};updateNavigationState=(e,t,n)=>{const s={canGoBack:Boolean(this.refWebview.current?.canGoBack()),canGoForward:Boolean(this.refWebview.current?.canGoForward()),isLoading:e,reason:n,trigger:t};aS.Z.setNavigationState(this.props.id,this.context.vivaldiWindowId,s,this.props.pageContext.isUrlFieldFocused)};handleLoadCommit=e=>{if(!e.isTopLevel||void 0===e.url)return;const{url:t}=e;zn.resetRssFeeds(this.props.id),(0,je.cw)(t)?T.Z.setFastForwardUrl(this.props.id,""):this.injectScripts(this.props.id);const n=this.getWebviewElement();n&&T.Z.setRewindInfo(n,this.props.id),this.updateNavigationState(!0,"commit")};handleLoadStart=e=>{if(!e.isTopLevel)return;const{urlForThumbnail:t}=this.props.vivExtData;t!==e.url&&d.ZP.setThumbnail(this.props.id,null),aS.Z.resetPermissions(this.props.id),Vv.Z.closeFindInPageToolbar(this.context.vivaldiWindowId,this.props.id),this.updateNavigationState(!0,"start"),aS.Z.resetPageHasBlockedContent(this.props.id),aS.Z.resetBlockedPopups(this.props.id),os.Z.resetTranslationParameters(this.props.id),this.props.pageContext.isUrlFieldFocused||py.Z.reset(this.props.id),this.captureScheduled=!1};handleLoadStop=e=>{this.updateNavigationState(!1,"stop"),this.props.vivExtData.thumbnail||this.updatePageThumbnailWithActiveWebview(0),!1===this.captureScheduled&&(this.captureScheduled=!0,this.updatePageThumbnailWithActiveWebview(5e3))};handleLoadRedirected=e=>{if(e.isTopLevel){const t=e.newUrl,n=e.oldUrl;d.ZP.setThumbnail(this.props.id,null),this.captureScheduled=!1;const{bookmarkThumbnailQueue:s}=this.props.pageContext;s&&s.url===n&&(s.url=t)}};handleContentAllowed=e=>{if("midi-sysex"===e.allowedType||"location"===e.allowedType||"notifications"===e.allowedType){const t=this.props.url?new URL(this.props.url).origin:"";aS.Z.setPermission(this.props.id,t,e.allowedType,null,"allowed")}};handleContentBlocked=e=>{if("popups"!==e.blockedType&&"sound"!==e.blockedType)if("midi-sysex"===e.blockedType||"location"===e.blockedType){const t=this.props.url?new URL(this.props.url).origin:"";aS.Z.setPermission(this.props.id,t,e.blockedType,null,"blocked")}else aS.Z.setPageHasBlockedContent(this.props.id,e.blockedType)};handleLoadAbort=e=>{e.preventDefault(),e.isTopLevel&&this.updateNavigationState(!1,"abort",e.reason)};handleOnLoadProgress=e=>{if((0,je.pM)(e.url))return;const t={url:e.url,progress:e.progress,loadedBytes:e.loadedBytes,loadedElements:e.loadedElements,totalElements:e.totalElements};(class{static setProgressState(e,t){y.Z.dispatch({actionType:"PAGE_SET_PROGRESS",pageId:e,progressState:t})}}).setProgressState(this.props.id,t)};handleOnFullscreen=e=>{!1===q8.Z.hasMediaState(this.props.id,"capturing")&&cs.Z.onHTML5FullScreen(e.enterFullscreen,e.windowId),this.setState({tabIsFullscreen:e.enterFullscreen})};handleBlockedPopup=e=>{aS.Z.addBlockedPopupEvent(this.props.id,e)};injectScripts=(0,oS.Z)((e=>{const t=ie.ZP.getPageById(e),n=this.props.prefValues[$.kRssDetectFeeds];this.refWebview.current?.executeScript({allFrames:!0,code:`window.__vivaldiDetectFeeds = ${n.toString()};\n             window.__vivaldiUseBossSelect = ${H.Z.get($.kWebpagesAllowSelectionInLinks)};\n             window.__vivaldiUseTranslateSelection =\n                      ${Boolean(!this.props.vivExtData.readerMode&&t&&!(0,je.pM)(t.url)).toString()};\n             window.__vivaldiContentScriptsInitialized;`,runAt:"document_start"}).then((e=>{if(e&&e.some((e=>!e)))return this.refWebview.current?.executeScript({file:"inject-root-bundle.js"}).catch((e=>{console.warn("Injecting inject-root-bundle failed:",e)})),this.refWebview.current?.executeScript({allFrames:!0,file:"inject-all-bundle.js"})})).catch((e=>{console.warn("Checking for inject-all-bundle failed:",e)})),this.props.vivExtData.readerMode&&this.injectReaderView()}),400);injectReaderView=()=>{z.Z.ensureAddedListener(this.updateReaderStyle);const e={code:'/* global chrome */\n\n/* This is the user file part of reader mode, it\'s injected after the\n   browserjs part of reader mode and does the real injecetion\n   (browserjs only does detection at an earlier stage so that we don\'t\n   need to wait for the page to load to update the indicator status of\n   the readability of the page */\nconst FEATURE_HIDE_PAGE = true;\n/* Hide page on load for better transition while navigating */\n\nconst AVERAGE_READ_WORDS = 225; // Add LI to scoring elements; Lower default character threshold (500)\n\nconst TAGS = "section,h2,h3,h4,h5,h6,p,li,td,pre";\nconst DEFAULT_TAGS_TO_SCORE = TAGS.toUpperCase().split(",");\nconst DEFAULT_CHAR_THRESHOLD = 300;\n\nfunction canSetStyle() {\n  return document && document.documentElement && document.documentElement.style;\n} // TODO: not working after delaying injection in the browserjs part of reader view\n\n\nif (FEATURE_HIDE_PAGE && canSetStyle()) {\n  document.documentElement.style.display = "none";\n}\n\nconst DEBUG_READABILITY = false;\nconst readabilityCss = `\nhtml {\n  margin: 0;\n  padding: 0;\n}\nbody {\n  color: #111111;\n  background-color: #f6f6f6;\n  font-family: sans-serif;\n  font-size: 1.3em;\n  font-style: normal;\n  font-weight: 400;\n  line-height: 1.5;\n  margin: 0 auto;\n  padding: 40px 10px 80px;\n  text-orientation: upright;\n  transition:\n    color 200ms cubic-bezier(0.4, 0, 1, 1),\n    background-color 200ms cubic-bezier(0.4, 0, 1, 1);\n}\nbody.vertical {\n  margin: 40px auto 0;\n  padding: 40px 60px 0;\n  max-height: calc(100vh - 120px);\n}\n.entry-content * {\n  max-width: 100%;\n  white-space: normal;\n  line-height: inherit;\n  vertical-align: baseline;\n  background: transparent;\n}\n.entry-content p {\n  margin: 1.5em 0;\n}\nbody.vertical .entry-content p {\n  margin: 0 1.5em;\n}\nh1 {\n  font-size: 1.8em;\n  line-height: 1.35;\n}\nh1, h2, h3, h4, h5, h6, b {\n  font-weight: 700;\n}\nhr {\n  border-style: solid;\n  border-width: 0 0 0.5px 0.5px;\n}\n.byline,\n.figcaption {\n  font-style: italic;\n}\n.entry-content img {\n  max-width: 100%;\n  height: auto;\n}\nbody.vertical .entry-content img {\n  max-height: 100%;\n  width: auto;\n}\n.entry-content code {\n  font-weight: 500;\n}\n.entry-content pre {\n  font-weight: 300;\n  background-color: rgba(128, 128, 128, 0.05);\n  border: 1px solid rgba(128, 128, 128, 0.1);\n  white-space: pre-wrap;\n  padding: 0.5em;\n  margin: 1.5em 0;\n}\n.entry-content code, .entry-content pre {\n  text-align: left;\n  max-width: 100%;\n  writing-mode: horizontal-tb;\n  overflow: auto;\n  white-space: pre-wrap;\n}\nbody.vertical .entry-content pre {\n  margin: 0 1.5em;\n  max-width: 80%;\n  max-height: 100%;\n}\nblockquote {\n  border-left: 2px solid currentColor;\n  padding-left: 1em;\n  margin-left: 0;\n}\nblockquote p {\n  font-style: italic;\n}\niframe, textarea, input {\n  display: none;\n}\n`;\n\nfunction __vivaldiGetHTML(article) {\n  const content = window.DOMPurify.sanitize(article.content);\n  const words = article.textContent.split(" ").filter(elem => {\n    return elem.length && !/\\r?\\n|\\r/.test(elem);\n  });\n  const readingTime = Math.round(words.length / AVERAGE_READ_WORDS);\n  const _ = window.Translate;\n\n  const readText = _("Read time: $1 minute", "Read time: $1 minutes", [readingTime]);\n\n  const byline = article.byline ? `${article.byline} — ` : "";\n  return `<!DOCTYPE html>\n<html dir="${article.dir}"><head>\n<title>${article.title}</title>\n<style>${readabilityCss}</style>\n</head><body>\n<h1>${article.title}</h1>` + `<p class="byline">${byline} ${readText}</p>` + `<hr />\n<article class="entry-content">${content}</article>\n</body></html>`;\n}\n\nfunction ready() {\n  if (typeof document !== "undefined" && ["complete", "loaded", "interactive"].indexOf(document.readyState) > -1) {\n    return true;\n  }\n\n  return false;\n}\n\nlet _numTriesLeft = 5;\n\nfunction onLoad() {\n  if (!window["Readability"] && _numTriesLeft-- > -1) {\n    setTimeout(onLoad, 500);\n  }\n\n  try {\n    if (!window["Readability"]) {\n      return;\n    } // TODO: should probably reuse this object when enabling, instead\n    // of running it again via the user script\n\n\n    const {\n      Readability\n    } = window;\n    const readability = new Readability(document.cloneNode(true), {\n      classesToPreserve: DEFAULT_TAGS_TO_SCORE,\n      charThreshold: DEFAULT_CHAR_THRESHOLD,\n      debug: DEBUG_READABILITY\n    });\n    const isProbablyReaderable = window.isProbablyReaderable(document);\n    let article;\n\n    if (isProbablyReaderable) {\n      article = readability.parse();\n    } else {\n      console.log("[readability] Probably not readable");\n    }\n\n    if (DEBUG_READABILITY) {\n      console.log("isReadable?", isProbablyReaderable, "article:", article);\n    }\n\n    if (article) {\n      // VB-22288 Cancel unload events\n      document.beforeunload = () => {};\n\n      document.unload = () => {};\n\n      const reader = document.implementation.createHTMLDocument(document.title);\n      reader.documentElement.innerHTML = __vivaldiGetHTML(article);\n      document.replaceChild(reader.documentElement, document.documentElement);\n\n      if (chrome && chrome.runtime && chrome.runtime.sendMessage) {\n        chrome.runtime.sendMessage({\n          type: "SET_RM_STYLE"\n        });\n      }\n    } else {\n      console.log("[readability] Nothing to show");\n    }\n  } finally {\n    // The page is rendered with display: none, so need to ensure this\n    // is always called\n    if (FEATURE_HIDE_PAGE && canSetStyle()) {\n      document.documentElement.style.display = "block";\n    }\n  }\n}\n\nif (ready()) {\n  onLoad();\n} else {\n  window.addEventListener("DOMContentLoaded", onLoad, false);\n}',runAt:"document_start"};this.refWebview.current?.executeScript(e).catch(Aa.Z)};onNewPopup=e=>{e.targetUrl||(e.targetUrl=h.f4);const t=G.ZP.isIncognito(this.context.vivaldiWindowId);Ae.Z.openNewPopAsTabOrWindow(this.context.vivaldiWindowId,e,t)};handleOnNewWindow=e=>{const t=G.ZP.isPopup(this.context.vivaldiWindowId);let n=t?0:this.context.vivaldiWindowId;const s=G.ZP.isIncognito(this.context.vivaldiWindowId);if(t)for(const[e]of G.ZP.getState()){if(s&&G.ZP.isIncognitoOrGuest(e)&&G.ZP.isTabbedBrowser(e)){n=e;break}if(G.ZP.isTabbedBrowser(e)){n=e;break}}let i=e.windowOpenDisposition;switch(0===n&&(i=s?"off_the_record":"new_window"),i){case"current_tab":case"new_foreground_tab":e.preventDefault(),e.window.accept(n+";1");break;case"new_background_tab":e.preventDefault(),e.window.accept(n+";0");break;case"off_the_record":case"new_window":e.preventDefault();const t="off_the_record"===e.windowOpenDisposition?{incognito:!0,transition:C.Z.historyPrivate.TransitionType.LINK}:{};cs.Z.openBrowserWindow(this.context.vivaldiWindowId,e.targetUrl,t);break;case"new_popup":e.preventDefault(),this.onNewPopup(e)}};showDialog=e=>{e.webview=this.getWebviewElement(),this.setState({customData:e})};handleOnCloseDialog=()=>{this.setState({customData:null})};handleOnJavascriptDialog=e=>{e.preventDefault(),e.dialogtype="javascript",this.showDialog(e)};handleOnPermissionRequest=e=>{e.preventDefault();const t=e.url?new URL(e.url).origin:"";switch(e.permission){case"geolocation":case"microphone":case"microphone_and_camera":case"camera":case"notifications":case"protocol_handling":aS.Z.setPermission(this.props.id,t,e.permission,e.request,"undecided",e.protocolDisplayName,e.suppressedPrompt);break;case"pointerLock":e.request.allow(),e.dialogtype=e.permission,this.showDialog(e);break;case"download":if(e.suggestedFilename.endsWith(".ics")&&!H.Z.get($.kMailIsTurnedOff)&&H.Z.get($.kCalendarHandleIcsDownloads))e.request.allow("open");else if(H.Z.get($.kDownloadsStartAutomatically)){if(e.request.allow(),H.Z.get($.kDownloadsOpenPanelOnNew)){const e=this.context.vivaldiWindowId;(0,bd.PK)("DownloadButton",e)?v.Z.executeActions("event",this.context,"COMMAND_SHOW_DOWNLOADS_POPOUT"):ud.ZP.canAutoOpen(e,"PanelDownloads")&&Pn.Z.toggleContent(e,"PanelDownloads")}}else e.dialogtype=e.permission,this.showDialog(e);break;case"media":e.request.allow();break;default:e.dialogtype=e.permission,this.showDialog(e)}};handleOnSSLStateChanged=e=>{if(e.SSLState){const t={state:e.SSLState,issuer:e.issuerstring};aS.Z.setSSLState(this.props.id,t)}};handleOnTargetURLChanged=e=>{const t=(0,uy.ZP)(e.newUrl);c.Z.setStatus(this.context.vivaldiWindowId,t),this._localStatus=!0};handleOnCreateSearch=e=>{e.dialogtype="createSearch",this.showDialog(e)};handleOnPasteAndGo=e=>{e.preventDefault();const t={ctrlKey:e.modifiers.includes("ctrl"),shiftKey:e.modifiers.includes("shift"),altKey:e.modifiers.includes("alt"),metaKey:!1},n=this.context.vivaldiWindowId,s=e.clipBoardText,i=(0,nl.Z)(n,t);"search"===e.pasteTarget&&Vv.Z.doAction(n,this.props.id,"searchPasteAndGo",{clipboardText:s,openOptions:i}),"url"===e.pasteTarget&&Vv.Z.doAction(n,this.props.id,"urlPasteAndGo",{clipboardText:s,openOptions:i})};handleOnContentsCreated=()=>{(0,je.cw)(this.props.url)||this.injectScripts(this.props.id)};_onWebpageviewStoreChanged=e=>{if(e.pageId!==this.props.id)return;const t=this.getWebviewElement();switch(e.type){case"WEBPAGEVIEW_CLOSE_FIND_IN_PAGE":return t?.stopFinding("keep"),void this.focusWebView(this.props.url);case"WEBPAGEVIEW_GO":return void t?.go(e.index);case"WEBPAGEVIEW_BACK":return void t?.back();case"WEBPAGEVIEW_FORWARD":return void t?.forward();case"WEBPAGEVIEW_GET_HISTORY":return void t?.getPageHistory(e.callback);case"WEBPAGEVIEW_STOP":{const e=oy.getNavigationInfo(this.props.id);return void((!e||e&&e.isLoading)&&this.refWebview.current?.stop())}case"WEBPAGEVIEW_RELOAD":return void(this.props.id===e.pageId&&s.Z.tabs.reload(e.pageId,{bypassCache:e.bypassCache}));case"WEBPAGEVIEW_ACTIONS":switch(e.action){case"focusWebView":return void this.focusWebView(this.props.url);case"pageScrollUp":return void this.pageScrollUp();case"pageScrollDown":return void this.pageScrollDown();case"pageScrollTop":return void this.pageScrollTop();case"pageScrollBottom":return void this.pageScrollBottom();case"print":{const e=this.context.vivaldiWindowId,n=Xw.Z.getActiveWebView(e);return void(n===t?C.Z.utilities.print(e):n&&n.print())}}}};focusWebView=e=>{(0,je.cw)(e)?this.refInternalPage.current?.focus():this.getWebviewElement()?.focus()};pageScrollUp=()=>{const e=ie.ZP.getActivePage(this.context.vivaldiWindowId);e&&C.Z.tabsPrivate.scrollPage(e.id,"pageup",0,(()=>{s.Z.runtime.lastError&&console.warn("vivaldi.tabsPrivate.scrollPage failed: "+(s.Z.runtime.lastError.message||""))}))};pageScrollDown=()=>{const e=ie.ZP.getActivePage(this.context.vivaldiWindowId);e&&C.Z.tabsPrivate.scrollPage(e.id,"pagedown",0,(()=>{s.Z.runtime.lastError&&console.warn("vivaldi.tabsPrivate.scrollPage failed: "+(s.Z.runtime.lastError.message||""))}))};pageScrollTop=()=>{const e=ie.ZP.getActivePage(this.context.vivaldiWindowId);e&&C.Z.tabsPrivate.scrollPage(e.id,"top",0,(()=>{s.Z.runtime.lastError&&console.warn("vivaldi.tabsPrivate.scrollPage failed: "+(s.Z.runtime.lastError.message||""))}))};pageScrollBottom=()=>{const e=ie.ZP.getActivePage(this.context.vivaldiWindowId);e&&C.Z.tabsPrivate.scrollPage(e.id,"bottom",0,(()=>{s.Z.runtime.lastError&&console.warn("vivaldi.tabsPrivate.scrollPage failed: "+(s.Z.runtime.lastError.message||""))}))};onKeyDown=e=>{"Escape"===e.key&&Vv.Z.closeFindInPageToolbar(this.context.vivaldiWindowId,this.props.id)&&e.preventDefault()};onMouseDown=()=>{d.ZP.activateTab(this.props.id,this.context.vivaldiWindowId)};onMouseLeave=()=>{this._localStatus&&(this._localStatus=!1,c.Z.clearStatus(this.context.vivaldiWindowId))};updateDockingSizes_=e=>{C.Z.devtoolsPrivate.getDockingStateSizes(e,(e=>{const t=e.hideInspectedContents,n=e.inspectedHeight,s=e.inspectedLeft,i=e.inspectedTop,o=e.inspectedWidth;C.Z.zoom.getVivaldiUIZoom((e=>this.setState({hideInspectedContents:t,viewWidth:o/e,viewHeight:n/e,viewTop:i/e,viewLeft:s/e,disableWebviewEvents:!0},(()=>{this._eventGuard&&clearTimeout(this._eventGuard),this._eventGuard=setTimeout((()=>{this.setState({disableWebviewEvents:!1})}),300)}))))}))};onDockingSizesChanged=e=>{e===this.props.id&&this.updateDockingSizes_(e)};onDockingStateChanged=(e,t)=>{e===this.props.id&&this.state.dockingState!==t&&("undocked"===this.state.dockingState?this.setState({pendingDockingState:t}):this.setState({dockingState:t}),d.ZP.setPageInspected(e,this.context.vivaldiWindowId,"off"!==t))};onDevtoolsClosed=e=>{e===this.props.id&&(this.setState({dockingState:"off",viewWidth:"auto",viewHeight:"auto",viewTop:0,viewLeft:0}),d.ZP.setPageInspected(e,this.context.vivaldiWindowId,!1))};onDevtoolsWindowClosed=e=>{if(this.state.pendingDockingState){const e=this.state.pendingDockingState;this.setState((t=>({pendingDockingState:void 0,dockingState:e})))}else C.Z.devtoolsPrivate.closeDevtools(e,(e=>{}));d.ZP.setPageInspected(e,this.context.vivaldiWindowId,!1)};onDevtoolsUndocked=(e,t,n)=>{e===this.props.id&&this.setState({dockingState:"undocked"},(async()=>{const t={bounds:{left:n.left,top:n.top,width:n.right-n.left,height:n.bottom-n.top},focused:!0,windowDecoration:!0,incognito:G.ZP.isIncognitoOrGuest(this.context.vivaldiWindowId),windowKey:"DevToolsUndocked_"+e.toString()},s=await cs.Z.openWindow(this.context.vivaldiWindowId,"devtools.html","devtools",t),i=(0,tee.Z)(s);if(i){i.vivaldiInspectTabId=e,i.vivaldiWindowId=this.context.vivaldiWindowId,this.setState({undockedIsUnmounted:!1,undockedDevtoolsWindowId:s});const t=n=>{n===s&&(this.setState({undockedIsUnmounted:!0,undockedDevtoolsWindowId:void 0}),this.onDevtoolsWindowClosed(e),C.Z.windowPrivate.onWindowClosed.removeListener(t))};C.Z.windowPrivate.onWindowClosed.addListener(t)}}))};onWebViewElementIsAttached=(e,t)=>{const{id:n,isActive:s,url:i}=this.props,o=this.getWebviewElement();e===n&&o&&s&&!(0,je.cw)(i)&&HI.setActiveWebView(t,o)};onWebViewElementIsDetached=(e,t)=>{e===this.props.id&&this.clearWebview()};updateFocus=(e,t)=>{if(!this.props.discarded)if(this.props.isActive){const e=this.nodeRef.current;e instanceof Node&&e.contains(this.activeElement)?ree((()=>{this.activeElement&&(this.activeElement.focus(),delete this.activeElement)})):this.props.pageContext.isUrlFieldFocused||function({winId:e,pageId:t,url:n,activeElement:s}){if(ie.ZP.getPageInWindow(e,t)?.isMailPage)return"";if(xl.getCapturingState(e))return"capture";if(ku.Z.getStateForPage(t).selectedEvent)return"calendarEditor";if("quick-command-search"===s?.className)return"quickCommands";let i=!1;try{i=!0===qa.Z.getFindResultsForPage(t).isFindInPageToolbarOpen}catch(e){console.warn(e)}return!0===i?"findInPage":""}({winId:this.context.vivaldiWindowId,pageId:this.props.id,url:t,activeElement:this.activeElement||this.context.document.activeElement})||ree((()=>this.focusWebView(t)))}else this.activeElement=this.context.document.activeElement};_onFindInPage=(e,t)=>{Vv.Z.findInPage(this.context.vivaldiWindowId,this.props.id,e,t)};_onFindNextInPage=(e,t,n)=>{Vv.Z.findNextInPage(this.context.vivaldiWindowId,this.props.id,e,t,n)};render(){const e=this.props.supportsReaderMode,t=this.props.vivExtData.readerMode&&e&&!(0,je.cw)(this.props.url),n=ie.ZP.isDisplayingImage(this.props.id),s="off"!==this.state.dockingState&&!(0,je.cw)(this.props.url),i="auto"===this.state.viewWidth||0===this.state.viewWidth?"100%":this.state.viewWidth+this.state.viewLeft,o=0!==this.state.viewWidth,a=0!==this.state.viewHeight,r=this.state.mediaState.has("recording")||this.state.mediaState.has("capturing"),l={visibility:r||this.props.isVisible?"inherit":"hidden",zIndex:this.props.isVisible?"initial":"-1",opacity:this.props.isVisible?1:0};if(this.state.tabIsFullscreen&&r){const e=1920,t=1080,n=this.props.contentWidth/e;l.transform=`scale(${n})`,l.left=(this.props.contentWidth-e)/2,l.top=(this.props.contentHeight-t)/2,l.width=e,l.height=t,l.position="absolute"}const d=Number(this.props.id),c=(0,je.cw)(this.props.url),h=As()("webpageview",{active:this.props.isActive,internal:c,tiled:(0,nee.Qz)(this.props.id),visible:this.props.isVisible,pagefocusstop:this.props.isVisible});return oee(fp,{level:"tabs"},void 0,(0,fs.jsxs)("div",{ref:this.nodeRef,className:h,style:l,"data-id":this.props.id,tabIndex:"-1",onKeyDown:this.onKeyDown,onMouseLeave:this.onMouseLeave,onMouseDown:this.onMouseDown,children:[t&&this.props.prefValues[$.kWebpagesReaderControls]&&!(s&&"undocked"!==this.state.dockingState)&&lee,!n&&!(0,je.Gp)(this.props.url)&&oee(mk,{isActive:this.props.isActive,pageId:this.props.id,onFindInPage:this._onFindInPage,onFindNextInPage:this._onFindNextInPage}),oee(QI,{tabId:d}),oee(ak,{url:this.props.url}),oee("div",{className:"row-wrapper"},void 0,oee("div",{className:"devtools-container"},void 0,oee(nk,{active:this.props.isActive,tabId:d,dockingState:c?"off":this.state.dockingState,undockedIsUnmounted:this.state.undockedIsUnmounted}),oee("div",{className:"webpage",style:s?{top:this.state.viewTop,left:this.state.viewLeft,width:o?this.state.viewWidth:"none",height:a?this.state.viewHeight:"none",pointerEvents:this.state.disableWebviewEvents?"none":null}:null},void 0,this.state.mountWebView&&(0,fs.jsx)(eee,{ref:this.refWebview,id:d,pinned:this.props.pinned,discarded:this.props.discarded,isVisible:this.props.isVisible,onContentsCreated:this.handleOnContentsCreated,onCreateSearch:this.handleOnCreateSearch,onContentAllowed:this.handleContentAllowed,onContentBlocked:this.handleContentBlocked,onDialog:this.handleOnJavascriptDialog,onFullscreen:this.handleOnFullscreen,onLoadAbort:this.handleLoadAbort,onLoadCommit:this.handleLoadCommit,onLoadProgress:this.handleOnLoadProgress,onLoadRedirect:this.handleLoadRedirected,onLoadStart:this.handleLoadStart,onLoadStop:this.handleLoadStop,onNewWindow:this.handleOnNewWindow,onPasteAndGo:this.handleOnPasteAndGo,onPermissionRequest:this.handleOnPermissionRequest,onSslStateChanged:this.handleOnSSLStateChanged,onTargetUrlChanged:this.handleOnTargetURLChanged,onWindowBlocked:this.handleBlockedPopup})),(0,fs.jsx)(Q8,{ref:this.refInternalPage,pageId:this.props.id,url:this.props.url,isVisible:this.props.isVisible,isActive:this.props.isActive,updatePageThumbnailWithActiveWebview:this.updatePageThumbnailWithActiveWebview}),n&&!this.props.showImageInspector&&oee("button",{className:"inspector",title:(0,Oe.Z)("Image Properties"),style:{left:i},onClick:this.toggleImageInspector,dangerouslySetInnerHTML:{__html:Ts.GH$}})),n&&oee(Qk,{url:this.props.url,open:this.props.showImageInspector,toggleImageInspector:this.toggleImageInspector}),this.props.isActive&&this.state.customData&&oee(ap,{customData:this.state.customData,closeDialog:this.handleOnCloseDialog}))]}))}}const cee=sa(dee,aee);var hee=n(34155);function pee(e,t){return function(n){n.stopPropagation(),uee(e,t.vivaldiWindowId)}}function uee(e,t){let n;n="content"===e?function(e){const t=ie.ZP.getActivePage(e);return t?.isMailPage?"mail":t?.url&&je.jk.getDisplayUrlFromMapping(t.url).startsWith("vivaldi://calendar")?"calendar":"browser"}(t):"panel"===e?function(e){switch(ud.ZP.getSelected(e)){case"PanelMail":case"PanelFeeds":case"PanelContacts":return"mail";case"PanelTasks":case"PanelCalendar":return"calendar";default:return"browser"}}(t):"browser";const s={actionType:"SWITCH_CONTEXT",context:{area:e,feature:n},windowId:t};y.Z.isDispatching()?hee.nextTick((()=>y.Z.dispatch(s))):y.Z.dispatch(s)}var gee,mee=n(34155);function vee(e,t,n,s){gee||(gee="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:gee,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const fee=[$.kAddressBarAutocompleteEnabled,$.kAddressBarExtensionsVisible,$.kAddressBarExtensionsRenderInDropdown,$.kAddressBarExtensionsShowAllToggle,$.kAddressBarInlineSearchEnabled,$.kAddressBarPosition,$.kAddressBarSearchSuggestEnabled,$.kAddressBarShowQrGenerator,$.kAddressBarTypedHistoryEnabled,$.kPopupsShowInTab,$.kKeyboardTabToAll,$.kAddressBarSearchShowFavicon,$.kAddressBarAutocompleteAutocompleteOnTitle,$.kAddressBarOmniboxShowSearchHistory,$.kAddressBarOmniboxShowSyncTabs];function yee(e){return{blockedPageContent:oy.getblockedPageContents(e),blockedPopups:oy.getBlockedPopupsById(e),permissionInfo:oy.getPermissionsById(e),sslInfo:oy.getSSLInfo(e)}}function Cee(e){if(!e)return;const t=Gn.Z.getByQuery(e);if(!t||!t.keyword)return;return e.substring(t.keyword.length)?t:void 0}function wee(e){const{blockedPageContent:t,blockedPopups:n,permissionInfo:s,sslInfo:i}=yee(e);return{prevPageId:e,blockedPageContent:t,blockedPopups:n,permissionInfo:s,sslInfo:i,typedUrl:yy.getUrlfieldState(e).typedUrl,feeds:CI.getState().get(e)}}function bee(e){const t=ps.ZP.findByUrl(e);return{prevPageUrl:e,bookmarkData:t?{...t}:void 0}}class See extends hs.PureComponent{static contextType=xi.Z;#h;refPageloadProgress=hs.createRef();refPopupBlockerNotificator=hs.createRef();urlBarRef=hs.createRef();passwordElm=hs.createRef();siteInfoElm=hs.createRef();refUrlField=hs.createRef();constructor(e,t){super(e),this.state={isBaseDomainObscured:!1,createBookmarkCallout:!1,showPasswordIcon:!1,defaultSearchEngine:Gn.Z.getDefault(G.ZP.isIncognito(t.vivaldiWindowId)),defaultTypedHistory:[],syncedTabs:[],...wee(e.id),...bee(e.url)},this.trackContextOnFocus=pee("tabBar",t)}static getDerivedStateFromProps(e,t){const n={};return e.id!==t.prevPageId&&Object.assign(n,wee(e.id)),e.url!==t.prevPageUrl&&Object.assign(n,bee(e.url)),n}componentDidUpdate(e,t){const n=e.id!==this.props.id;n&&this.hideDropdown(),n&&this.props.pageContext.isUrlFieldFocused&&ree((()=>(0,cy.i6)(this.context)))}componentDidMount(){this.#h=!0,ps.ZP.addListener(this._onBookmarkStoreChanged),qa.Z.addListener(this._onWebpageviewStoreChanged),yy.addListener(this._onUrlFieldStoreChanged,(e=>e.get(this.props.id))),oy.addListener(this._onNavigationStoreChanged),Gn.Z.addListener(this._onSearchEngineCacheChanged),C.Z.windowPrivate.onPositionChanged.addListener(this._onWindowPositionChanged),C.Z.utilities.onPasswordIconStatusChanged.addListener(this.togglePasswordIcon),s.Z.history.onVisited.addListener(this.updateDefaultTypedHistory),s.Z.history.onVisitRemoved.addListener(this.updateDefaultTypedHistory),CI.addListener(this._onRssDetectStoreChanged),C.Z.sync.onCycleCompleted.addListener(this.onSyncCycleCompleted),Jn.Z.addListener(this.onVivaldiAccountChange),this.onSyncCycleCompleted(),this.props.pageContext.isUrlFieldFocused&&ree((()=>(0,cy.i6)(this.context))),this.updateDefaultTypedHistory()}componentWillUnmount(){this.#h=!1,ps.ZP.removeListener(this._onBookmarkStoreChanged),qa.Z.removeListener(this._onWebpageviewStoreChanged),yy.removeListener(this._onUrlFieldStoreChanged),oy.removeListener(this._onNavigationStoreChanged),Gn.Z.removeListener(this._onSearchEngineCacheChanged),C.Z.windowPrivate.onPositionChanged.removeListener(this._onWindowPositionChanged),C.Z.utilities.onPasswordIconStatusChanged.removeListener(this.togglePasswordIcon),s.Z.history.onVisited.removeListener(this.updateDefaultTypedHistory),s.Z.history.onVisitRemoved.removeListener(this.updateDefaultTypedHistory),CI.removeListener(this._onRssDetectStoreChanged),C.Z.sync.onCycleCompleted.removeListener(this.onSyncCycleCompleted),Jn.Z.removeListener(this.onVivaldiAccountChange)}getUrlFragments=eo()(gy.dO);getReaderContextMenu=()=>{const e=this.context.vivaldiWindowId;return[{handler:()=>Ae.Z.showSettings(e,"webpages"),isVisible:()=>!G.ZP.isGuest(),...(0,xs.Z)("Configure Reader View")}]};_setBookmarkedState=(0,no.Z)((e=>{if(!this.#h)return;const t=ps.ZP.findByUrl(e);this.setState({bookmarkData:t?{...t}:void 0})}),100);_onUrlFieldStoreChanged=()=>{const{typedUrl:e}=yy.getUrlfieldState(this.props.id);this.setState({typedUrl:e})};_onNavigationStoreChanged=()=>{const e=yee(this.props.id);if(this.state.blockedPageContent===e.blockedPageContent&&this.state.blockedPopups===e.blockedPopups&&this.state.permissionInfo===e.permissionInfo&&this.state.sslInfo===e.sslInfo)return;const t=()=>{this.setState({blockedPageContent:e.blockedPageContent,blockedPopups:e.blockedPopups,permissionInfo:e.permissionInfo,sslInfo:e.sslInfo})};this.state.permissionInfo===e.permissionInfo?t():setTimeout(t,200)};_onSearchEngineCacheChanged=()=>{this.setState({defaultSearchEngine:Gn.Z.getDefault(G.ZP.isIncognito(this.context.vivaldiWindowId))})};_onRssDetectStoreChanged=()=>{const e=CI.getState().get(this.props.id);this.state.feeds!==e&&this.setState({feeds:e})};onSyncCycleCompleted=async()=>{this.props.prefValues[$.kAddressBarOmniboxShowSyncTabs]&&!G.ZP.isIncognitoOrGuest(this.context.vivaldiWindowId)&&this.setState({syncedTabs:await JC()})};onVivaldiAccountChange=()=>{const e=Jn.Z.getState(),t=(0,Jn.O)(e);"loggedIn"===t?this.onSyncCycleCompleted():"loggedOut"===t&&this.setState({syncedTabs:[]})};selectAddressField=()=>{this.#h&&(0,cy.i6)(this.context)};focusAddressField=()=>{this.#h&&(0,cy.x0)(this.context)};blurAddressField=()=>{this.#h&&((0,cy.gR)(this.context),mee.nextTick((()=>{this.hideDropdown()})))};_onBookmarkStoreChanged=()=>{this._setBookmarkedState(this.props.url)};_onWebpageviewStoreChanged=e=>{e.winId===this.context.vivaldiWindowId&&("WEBPAGEVIEW_ACTIONS"===e.type?"focusAddressField"===e.action?(this.onCloseCreateBookmarkCallout(),mee.nextTick((()=>{this.focusAddressField(),this.selectAddressField()}))):"urlPasteAndGo"===e.action&&e.payload&&this.urlPasteAndGo(e.payload):"WEBPAGEVIEW_URLFIELD_BLUR"===e.type&&mee.nextTick((()=>this.hideDropdown())))};urlPasteAndGo=async e=>{const{HTMLInputElement:t}=this.context,{clipboardText:n}=e;if(!n)return;const s=this.refUrlField.current?._urlInput.current?.refUrlInput.current?.inputField.current;s instanceof t&&(await Fy.Z.go(this.context.vivaldiWindowId,[n],{transition:C.Z.historyPrivate.TransitionType.TYPED,fromUrlField:!0,addTypedSearchHistory:!1,enableSearch:!0,...e.openOptions}),this.blurAddressField())};onPasswordFocus=e=>{C.Z.utilities.isDialogOpen("password",(e=>{C.Z.utilities.focusDialog("password",(e=>{}))}))};compareProtocol=e=>{if((0,vs.C3)(e)&&(0,vs.Zj)(e)&&this.props.url&&UI(e)===UI(this.props.url)){const t=(0,ms.Z)(this.props.url),n=(0,ms.Z)(e);if(n&&t&&(n.protocol=t.protocol,(0,vs.K2)(n.href)))return n.href}return e};handleUrlFieldSubmit=async({url:e,options:t})=>{const n=Cee(this.state.typedUrl),s=Boolean(n||this.props.prefValues[$.kAddressBarInlineSearchEnabled]);n||(e=this.compareProtocol(e)),await Fy.Z.go(this.context.vivaldiWindowId,[e],{...t,enableSearch:s,addTypedSearchHistory:!1})};easterEggNavigation=async()=>{const e=yy.getUrlfieldState(this.props.id);if(!e||!e.autocompleteValue&&!e.typedUrl)return;const t=e?.autocompleteValue||e?.typedUrl||"";this.hideDropdown(),await Fy.Z.go(this.context.vivaldiWindowId,[je.jk.getUrl(t)],{enableSearch:!0,transition:C.Z.historyPrivate.TransitionType.TYPED,addTypedSearchHistory:!1})};onSiteInfoButtonFieldGo=()=>{this.easterEggNavigation(),(0,cy.gR)(this.context)};showPasswordDialog=()=>{C.Z.utilities.showPasswordDialog(this.context.vivaldiWindowId)};onUrlFieldDrop=e=>{const t=this.context.vivaldiWindowId,n=e.dataTransfer;if(!n)return;const s=Ds.ZP.extractUriListFromEvent(e);if(s.length>0){const e=s.split("\n");e.length>0&&Fy.Z.go(t,e)}else{const e=n.getData("text/plain");e.length>0&&((0,vs.K2)(e)?Fy.Z.go(t,[e]):(py.Z.updateState(this.props.id,{typedUrl:e}),this.focusAddressField()))}};togglePasswordIcon=(e,t)=>{e===this.context.vivaldiWindowId&&this.setState((e=>({showPasswordIcon:t})))};updateDefaultTypedHistory=()=>{C.Z.historyPrivate.getTypedHistory("","-1",50).then((e=>{const t=gC(e);this.setState({defaultTypedHistory:t})}))};setUrlDragEvent=e=>{e.stopPropagation();const{document:t,devicePixelRatio:n,vivaldiWindowId:s}=this.context,i=t.createElement("img");i.src=this.props.favIconUrl||"/resources/default_favicon_64.png",i.width=32,i.height=32,e.dataTransfer.setDragImage(i,i.width*n,i.height*n),i.remove();const o=ie.ZP.getActivePage(s),a=this.state.typedUrl??this.props.url;jr(e,a,o?.title??""),e.dataTransfer.effectAllowed="all"};onReaderModeClicked=()=>{d.ZP.setReaderState(this.props.id,!this.props.isReaderModeActive)};onCreateBookmarkCallout=()=>{this.props.active&&this.props.url&&this.setState({createBookmarkCallout:!0})};onCloseCreateBookmarkCallout=()=>{this.setState({createBookmarkCallout:!1})};onPopupAllowed=e=>{aS.Z.removeBlockedPopup(this.props.id,e.targetUrl),this.refPopupBlockerNotificator.current?.onDialogClosed(),this.openNewPopAsTabOrWindow(e)};openNewPopAsTabOrWindow=e=>{const t=G.ZP.isIncognito(this.context.vivaldiWindowId);Ae.Z.openNewPopAsTabOrWindow(this.context.vivaldiWindowId,e,t)};hideDropdown=()=>{this.refUrlField.current?.hideDropdown()};toggleTypedHistory=e=>{e.preventDefault(),this.refUrlField.current?.toggleTypedHistory(e)};_storeDialogAnchorRect=(e,t)=>{const n="top"===this.props.prefValues[$.kAddressBarPosition]?"down":"up";C.Z.zoom.getVivaldiUIZoom((s=>{C.Z.utilities.setDialogPosition(t,this.context.vivaldiWindowId,{left:Math.round(e.left*s),top:Math.round(e.top*s),width:Math.round(e.width*s),height:Math.round(e.height*s)},n)}))};_updateDialogPositions=()=>{const e=this.passwordElm.current;if(e){const t=e.getRect();t&&this._passwordPopupPos!==t&&(this._passwordPopupPos=t,this._storeDialogAnchorRect({left:t.left,top:t.top,width:t.width,height:t.height},"password"))}const{Element:t}=this.context,n=this.siteInfoElm.current?.refSiteInfoButton.current;if(n instanceof t){const e=n.getBoundingClientRect();this._permissionPopupPos!==e&&(this._permissionPopupPos=e,this._storeDialogAnchorRect({left:e.left,top:e.top,width:e.width,height:e.height},"permission"))}s.Z.windows.get(this.context.vivaldiWindowId,{},(e=>{if(!s.Z.runtime.lastError){let{left:t=0,top:n=0,width:s,height:i}=e;s=s||0,i=i||0,this._storeDialogAnchorRect({left:Math.round(t+s/2),top:Math.round(n+i/2),width:0,height:0},"chromecast")}}))};_onWindowPositionChanged=e=>{e===this.context.vivaldiWindowId&&this._sendBatchedUpdatedBounds()};_sendBatchedUpdatedBounds=()=>{this._resizeDelayRunning||(this._resizeDelayRunning=!0,setTimeout((()=>{this._updateDialogPositions(),this._resizeDelayRunning=!1}),500))};onUrlbarResized=e=>{this._sendBatchedUpdatedBounds()};onSetBookmarked=e=>s.Z.bookmarks.create(e).then((t=>(Ae.Z.showBookmarkAddedPopup(G.ZP.getLastActiveBrowserWindowId(),{pageId:this.props.id,url:e.url??"",isActive:!0}),t)));blurUnfocused=e=>{this.context.document.activeElement!==this.refUrlField.current&&"Escape"===e.key&&(e.stopPropagation(),e.preventDefault(),this.refUrlField.current?._onEscPressed())};onBaseDomainObscured=e=>{this.setState({isBaseDomainObscured:e})};getOffsetWidth=()=>this.urlBarRef.current?.offsetWidth??0;render(){const{preview:e=!1}=this.props;if(e)return(0,fs.jsx)("input",{type:"text",className:"AddressField",value:(0,Oe.Z)("url","Address"),...qo({draggable:this.props.draggable,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,onDragEnter:this.props.onDragEnter,onDragOver:this.props.onDragOver,onDragLeave:this.props.onDragLeave,onDrop:this.props.onDrop}),readOnly:!0});const{isBaseDomainObscured:t,defaultTypedHistory:n,feeds:s,syncedTabs:i}=this.state,{prefValues:o,url:a}=this.props,r=Cee(this.state.typedUrl),l=je.jk.isInternalUrl(a)||a.startsWith("chrome://"),d=(0,vs.C3)(escape(a))&&!(l||(0,vs.Sc)(a)||(0,vs.tn)(a)),c=n.length>0?(0,Oe.Z)("Show typed history"):(0,Oe.Z)("Enter an address to activate typed history"),h=(0,Oe.Z)("Save your password"),p=o[$.kAddressBarTypedHistoryEnabled]&&!0!==this.props.readonly,u=this.props.menuOrigin||"bottomLeft",g=this.props.popupPosition||"below",m=this.getUrlFragments(this.props.url),v=(0,uy.gC)(m),f=function(e){return Boolean(e)&&!je.jk.isInternalUrl(e)&&!je.jk.isNewTabPage(e)}(a),y=(0,Ds.TR)(a),C=ps.ZP.isReady()&&void 0!==this.props.id&&y;return(0,fs.jsxs)("div",{ref:this.urlBarRef,className:As()("UrlBar-AddressField",this.props.buttonClasses,g),onFocus:this.trackContextOnFocus,...qo({draggable:this.props.draggable,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,onDragEnter:this.props.onDragEnter,onDragOver:this.props.onDragOver,onDragLeave:this.props.onDragLeave,onDrop:this.props.onDrop}),onKeyDown:this.blurUnfocused,children:[vee("div",{className:"toolbar-insideinput"},void 0,vee(kS,{blockerVisible:d,position:g,tabIndex:o[$.kKeyboardTabToAll],pageId:this.props.id,url:a})),(0,fs.jsx)(_I,{ref:this.siteInfoElm,draggable:!l,isInternal:l,onDragStart:this.setUrlDragEvent,fieldGo:this.onSiteInfoButtonFieldGo,sslIssuer:this.state.sslInfo.issuer,sslState:this.state.sslInfo.state,tabIndex:o[$.kKeyboardTabToAll],pageId:this.props.id,displayUrl:v}),vee("div",{className:"UrlBar-UrlFieldWrapper"},void 0,vee(Ri,{className:"observer",onResize:this.onUrlbarResized},void 0,(0,fs.jsx)(pw,{ref:this.refUrlField,getOffsetWidth:this.getOffsetWidth,onBaseDomainObscured:this.onBaseDomainObscured,urlFragments:m,onSubmit:this.handleUrlFieldSubmit,className:"UrlBar-UrlField url vivaldi-addressfield uifocusstop",typedUrl:this.state.typedUrl,displayUrl:v,pageId:this.props.id,pageContext:this.props.pageContext,onUrlDrag:this.setUrlDragEvent,autoFocus:!1,autocompletionEnabled:o[$.kAddressBarAutocompleteEnabled],typedHistoryEnabled:o[$.kAddressBarTypedHistoryEnabled],onDrop:this.onUrlFieldDrop,placeholder:o[$.kAddressBarInlineSearchEnabled]?(0,Oe.Z)("Search or enter an address"):(0,Oe.Z)("Enter an address"),showDropdown:!0,autocompleteOnTitle:o[$.kAddressBarAutocompleteAutocompleteOnTitle],defaultSearchEngine:this.state.defaultSearchEngine,typedSearchEngine:r,readonly:this.props.readonly,defaultTypedHistory:n,syncedTabs:i}))),vee("div",{className:"toolbar toolbar-small toolbar-insideinput"},void 0,t&&vee("div",{title:(0,Oe.Z)("Caution!\nThe entire domain name cannot be shown. Make sure you trust this website before submitting data."),className:"UrlBar-UrlObfuscationWarning",dangerouslySetInnerHTML:{__html:Ts.Si$.small}}),(0,fs.jsx)(DS,{pageId:this.props.id,ref:this.refPageloadProgress,open:!l}),vee(iI,{pageId:this.props.id,pagePermissions:this.state.permissionInfo,popupPosition:g}),this.state.blockedPopups.size>0&&(0,fs.jsx)(hI,{ref:this.refPopupBlockerNotificator,url:a,blockedPopups:this.state.blockedPopups,onPopupAllowed:this.onPopupAllowed,popupPosition:g}),this.state.blockedPageContent.length>0&&vee(uS,{pageId:this.props.id,url:a,position:g,blockedPageContent:this.state.blockedPageContent}),s&&s.length>0&&vee(fI,{feeds:s}),this.state.showPasswordIcon&&(0,fs.jsx)(Fa,{ref:this.passwordElm,className:"password-icon",tooltip:h,onClick:this.showPasswordDialog,image:Ts.hXX,tabIndex:0,onFocus:this.onPasswordFocus}),!l&&this.props.supportsReaderMode&&vee(Fa,{menu:this.getReaderContextMenu,menuOrigin:u,isPressed:this.props.isReaderModeActive,image:Ts.sWI,onClick:this.onReaderModeClicked,tooltip:(0,Oe.Z)("Reader View")}),f&&o[$.kAddressBarShowQrGenerator]&&vee(mI,{popupPosition:g,size:this.props.size,data:a}),f&&vee(WI,{popupPosition:g,size:this.props.size,tabId:this.props.id,url:a}),C&&vee(yr,{setBookmarked:this.onSetBookmarked,pageId:this.props.id,bookmarkData:this.state.bookmarkData,popupPosition:g},a),p&&vee("div",{className:"button-toolbar drop-down-menu"},void 0,vee("button",{title:c,tabIndex:o[$.kKeyboardTabToAll],disabled:0===n.length,onMouseDown:this.toggleTypedHistory,dangerouslySetInnerHTML:{__html:Ts.V34}})))]})}}const Iee=sa(ta(See),fee);var kee,Aee=n(34155);function Tee(e,t,n,s){kee||(kee="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:kee,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Zee=[$.kAddressBarSearchDisplay,$.kAddressBarSearchFieldWidth,$.kAddressBarSearchInNewTab,$.kAddressBarSearchKeepSelected,$.kAddressBarSearchShowFavicon,$.kAddressBarSearchShowKeyword,$.kAddressBarSearchSuggestEnabled,$.kAddressBarSearchTypedHistoryEnabled,$.kAddressBarVisible,$.kKeyboardTabToAll,$.kStartpageSpeedDialTrackerSuggestionShow,$.kVivaldiAddressBarSearchDirectMatchEnabled,$.kAddressBarSearchKeepTypedText];function Eee({disabled:e,tabIndex:t,onMouseDown:n,onClick:s}){return Tee("div",{className:"toolbar toolbar-insideinput ignore-react-onclickoutside"},void 0,Tee("div",{className:"button-toolbar drop-down-menu"},void 0,Tee("button",{disabled:e,tabIndex:t,title:(0,Oe.Z)("Show search history"),onMouseDown:n,onClick:s,dangerouslySetInnerHTML:{__html:Ts.V34}})))}function _ee({onClick:e,tabIndex:t}){return Tee("div",{className:"toolbar toolbar-insideinput"},void 0,Tee("div",{className:"button-toolbar"},void 0,Tee("button",{onMouseDown:e=>e.preventDefault(),tabIndex:t,title:(0,Oe.Z)("verb","Search"),className:"SearchField-ExecuteSearchButton ignore-react-onclickoutside",onClick:e,dangerouslySetInnerHTML:{__html:Ts.V34}})))}class Mee extends hs.PureComponent{static contextType=xi.Z;_isPasting=!1;_nav=new $C(this);_isIMEOpen=!1;_justClosedIME=!1;_isOnSpeedDial="speed_dial_view"===this.props.origin;_refSearchField=hs.createRef();_omniDropdownRef=hs.createRef();_suppressReplace=!1;_directMatchBlocks=null;state={dropdownSelectionIndex:0,editText:sS.getText(this.context.vivaldiWindowId),typedValue:"",filteredTypedHistoryStore:[],isOmniDropdownOpen:!1,searchSuggestionStore:[],directMatchItem:void 0,showAll:!1,showPopup:!1,searchEngineSelectItems:[],typedHistoryStore:[],currentSearchEngine:void 0,selectedItem:void 0,numberOfSelectableItems:0,isSearchEngineSelectOpen:!1};componentDidMount(){this._onSearchEngineCacheChanged(),this._onSearchFieldStoreChanged(),Gn.Z.addListener(this._onSearchEngineCacheChanged),sS.addListener(this._onSearchFieldStoreChanged),qa.Z.addListener(this._onWebpageviewStoreChanged)}componentWillUnmount(){Gn.Z.removeListener(this._onSearchEngineCacheChanged),sS.removeListener(this._onSearchFieldStoreChanged),qa.Z.removeListener(this._onWebpageviewStoreChanged)}_getDirectMatchUtils=()=>{this._directMatchBlocks=By.getDirectMatchBlocks()};_onWebpageviewStoreChanged=e=>{e.winId===this.context.vivaldiWindowId&&"WEBPAGEVIEW_ACTIONS"===e.type&&("searchPasteAndGo"===e.action?e.payload&&this.context.document.activeElement===this._refSearch&&Aee.nextTick((()=>this._pasteAndGo(e.payload))):"focusSearchField"===e.action&&("button"===this.props.prefValues[$.kAddressBarSearchDisplay]&&this.toggleHiddenSearchFieldPopup(),Aee.nextTick(this.focusField)))};_pasteAndGo=({openOptions:e,clipboardText:t})=>{this._search({value:t,openOptions:e})};_onSearchEngineCacheChanged=()=>{this.setState(((e,t)=>{const n=Gn.Z.get().map((e=>({name:e.name,faviconUrl:e.faviconUrl,shortcut:e.keyword,noPrettifying:!0,id:e.id}))),s=t.prefValues[$.kAddressBarSearchKeepSelected],i=G.ZP.isIncognito(this.context.vivaldiWindowId);let o;return o=this._isOnSpeedDial&&s?Gn.Z.getSpeeddialsSearch(i):Gn.Z.getSearchField(i),{currentSearchEngine:o,searchEngineSelectItems:n}}))};_onSearchFieldStoreChanged=()=>{const{document:e}=this.context,t=sS.getTypedHistory(),n={};if(n.typedHistoryStore=t,e.activeElement===this._refSearch){const e=sS.getText(this.context.vivaldiWindowId),s=e.trim()&&t.filter((t=>t.url.toLowerCase().startsWith(e.toLowerCase())))||[];n.editText=e,n.filteredTypedHistoryStore=s}this.setState(n)};_onCompositionStart=()=>{this._isIMEOpen=!0};_onCompositionEnd=()=>{this._isIMEOpen=!1,this._justClosedIME=!0};_updateCurrentEngine=e=>{this.setState({currentSearchEngine:e},(()=>{if(this.props.prefValues[$.kAddressBarSearchKeepSelected]){const t=G.ZP.isIncognitoOrGuest(this.context.vivaldiWindowId),n=this._isOnSpeedDial?t?"defaultSpeeddialsPrivate":"defaultSpeeddials":t?"defaultSearchFieldPrivate":"defaultSearchField";C.Z.searchEngines.setDefault(n,e.id)}}))};_search=({value:e,openOptions:t})=>{const{document:n}=this.context;this._abortController&&this._abortController.abort(),this._protectedSearchSuggest.cancel&&this._protectedSearchSuggest.cancel(),this._refSearch&&n.activeElement===this._refSearch&&this._refSearch.blur();const{typedValue:s,directMatchItem:i}=this.state,o=e===i?.url,a=this.props.prefValues[$.kAddressBarSearchKeepTypedText],r=o?s:e,l={editText:r};a||(l.editText="",l.typedValue=""),this.setState(l),$n.Z.setText(this.context.vivaldiWindowId,a?r:"");let d=!t||!1!==t.inCurrent;this.props.prefValues[$.kAddressBarSearchInNewTab]&&(this._isOnSpeedDial||(d=!1));const c=i&&(i.url===e||i.title===e),h={...t,inCurrent:d,addTypedSearchHistory:!c};if(i&&c&&t)return void this.directMatchSearch(i,{...t,fromUrlField:!1});const p=Gn.Z.getByQuery(s);if(e=rw(e,p),p&&this._updateCurrentEngine(p),e.length>0&&this.state.currentSearchEngine){this.onSearch(e,this.state.currentSearchEngine,h);const t=G.ZP.isIncognito(this.context.vivaldiWindowId),n=Gn.Z.getSearchField(t);!this.props.prefValues[$.kAddressBarSearchKeepSelected]&&n&&this._updateCurrentEngine(n)}};onSearch=(e,t,n={})=>{Fy.Z.goSearchUrl(this.context.vivaldiWindowId,e.trim(),{useSearchEngine:t,...n}),this._hideDropdown()};directMatchSearch=(e,t)=>{$y(e,this.context.vivaldiWindowId,t),this._hideDropdown()};onKeyDowned=e=>{this._justClosedIME=!1;const t=e.shiftKey&&!e.ctrlKey&&!e.altKey&&!e.metaKey,n=!(0,qi.Z)(e),{isOmniDropdownOpen:s}=this.state;switch(e.key){case"ArrowUp":return void(s&&(0,to.ZP)(e));case"ArrowDown":return void(t&&this.onKeyPressed(e));case"Tab":if(!s)return;return n&&((0,to.ZP)(e),Aee.nextTick(this._nav.down)),void(t&&((0,to.ZP)(e),Aee.nextTick(this._nav.up)));case"Escape":return(0,to.ZP)(e),"button"===this.props.prefValues[$.kAddressBarSearchDisplay]&&this.props.prefValues[$.kAddressBarVisible]||this.setState((e=>({editText:e.typedValue}))),void this._esc();case"Enter":return void(n||this.onKeyPressed(e))}};onExecuteSearchButtonClick=e=>{const t={ctrlKey:e.ctrlKey,altKey:!1,shiftKey:e.shiftKey||e.altKey,metaKey:e.metaKey},n=(0,nl.Z)(this.context.vivaldiWindowId,t),s=this.state.selectedItem?this.state.selectedItem.url||"":this.state.typedValue;this._search({value:s,openOptions:n})};onKeyPressed=e=>{const{key:t,shiftKey:n,currentTarget:s}=e;switch(t){case"Enter":{this._justClosedIME=!1,this._abortController&&this._abortController.abort(),this._protectedSearchSuggest.cancel&&this._protectedSearchSuggest.cancel();const t={ctrlKey:e.ctrlKey,altKey:!1,shiftKey:e.shiftKey||e.altKey,metaKey:e.metaKey},n=(0,nl.Z)(this.context.vivaldiWindowId,t);return void this._search({value:s.value,openOptions:n})}case"ArrowDown":if(!n)return;return void(this.state.typedHistoryStore.length>0&&this.props.prefValues[$.kAddressBarSearchTypedHistoryEnabled]&&this._showDropdown({showAll:!0}));case"Tab":return void this._hideDropdown()}};onSearchEngineChanged=e=>{const t=this._refSearch?this._refSearch.value:"";this._refSearch&&""===t&&this._refSearch.focus();const n=Gn.Z.getById(e);if(t.length>0&&n){const e={addTypedSearchHistory:!0,inCurrent:!0!==this.props.prefValues[$.kAddressBarSearchInNewTab]};this.onSearch(t,n,e)}n&&this._updateCurrentEngine(n),this.setState({searchSuggestionStore:[],directMatchItem:void 0,isSearchEngineSelectOpen:!1})};onTypedSearchHistoryDeleted=e=>{e.url?$n.Z.deleteTypedSearchHistory(e.url,-1):e.when&&$n.Z.deleteTypedSearchHistory("",e.when)};_showDropdown=e=>{if(!0===this._isPasting)return;const{document:t}=this.context;let n=e?.showAll;if("boolean"!=typeof n&&(n=!1),this.setState({showAll:n}),!this.state.isOmniDropdownOpen){this._refSearch&&t.activeElement!==this._refSearch&&this._refSearch.focus();const e=this.getDropdownItems(n).flatMap((e=>e.items));this.setState({isOmniDropdownOpen:!0,selectedItem:e[0]},(()=>{this.setAutocompleteHighlight(0,!0)}))}};_hideDropdown=()=>{this.state.isOmniDropdownOpen&&this.setState({selectedItem:void 0,isOmniDropdownOpen:!1,showAll:!1,searchSuggestionStore:[],directMatchItem:void 0})};componentDidUpdate(e,t){t.dropdownSelectionIndex!==this.state.dropdownSelectionIndex&&this._nav.setSelectionIndex(this.state.dropdownSelectionIndex);const n=(this.state.showAll?this.state.typedHistoryStore.length:this.state.filteredTypedHistoryStore.length)+this.state.searchSuggestionStore.length+(this.state.directMatchItem?1:0)+1;this._nav.setNumberOfSelectableItems(n)}getDropdown=()=>this._omniDropdownRef.current;setAutocompleteHighlight=(e,t)=>{this.setState({dropdownSelectionIndex:e}),t&&this.setState((e=>({editText:e.selectedItem&&e.selectedItem.url||e.editText})))};_esc=()=>{if(this._isIMEOpen||this._justClosedIME)this._justClosedIME=!1;else{if(this.state.isOmniDropdownOpen)this._hideDropdown();else if(this.state.isSearchEngineSelectOpen)this.closeSearchEngineSelect();else if(this.state.editText)this.setState({typedValue:""}),$n.Z.setText(this.context.vivaldiWindowId,"");else{this.state.showPopup&&this.hideSearchField(),this.onBlur();const e=ie.ZP.getActivePage(this.context.vivaldiWindowId);e&&Vv.Z.doAction(this.context.vivaldiWindowId,e.id,"focusWebView")}this._justClosedIME=!1}};_onDelete=()=>{this.state.selectedItem&&this.onTypedSearchHistoryDeleted(this.state.selectedItem)};_onKeyboardChanged=(e,t,n,s)=>{if(t&&0===n)switch(s){case oa.Z.KEY_DOWN:if(this._isIMEOpen)return;!0===this.state.isOmniDropdownOpen?this._nav.down():this.setState({isSearchEngineSelectOpen:!0});break;case oa.Z.KEY_UP:this._isIMEOpen||this._nav.up();break;case oa.Z.KEY_END:this.setAutocompleteHighlight(this.state.numberOfSelectableItems-1,!0);break;case oa.Z.KEY_ESCAPE:"button"===this.props.prefValues[$.kAddressBarSearchDisplay]&&this.props.prefValues[$.kAddressBarVisible]||this.context.document.activeElement===this._refSearch||this._esc();break;case oa.Z.KEY_HOME:this.setAutocompleteHighlight(0,!0);break;case oa.Z.KEY_PAGE_DOWN:this._nav.pageDown();break;case oa.Z.KEY_PAGE_UP:this._nav.pageUp();break;case oa.Z.KEY_DELETE:this._onDelete()}};onFocus=()=>{C.Z.tabsPrivate.onKeyboardChanged.addListener(this._onKeyboardChanged)};onBlur=()=>{const{getSelection:e}=this.context,t=e();t&&t.empty(),C.Z.tabsPrivate.onKeyboardChanged.removeListener(this._onKeyboardChanged)};onMouseDown=e=>{const{document:t}=this.context;this._focusedOnMouseDown=t.activeElement};onMouseUp=({currentTarget:e})=>{const{document:t}=this.context;t.activeElement===e&&(this._focusedOnMouseDown!==this._refSearch&&e.selectionStart===e.selectionEnd&&e.select(),this._focusedOnMouseDown=void 0)};onDoubleClick=e=>{(0,to.ZP)(e)};onPaste=e=>{this._isPasting=!0,setTimeout((()=>this._isPasting=!1),5)};_protectedSearchSuggest=(0,oS.Z)(((e,t,n)=>{this._abortController&&this._abortController.abort();const s=Cee(t),i=s?rw(t,s):t;this._abortController=new AbortController,sd({windowId:e,query:i,searchEngine:s??n,typedSearchEngine:s,abortSignal:this._abortController.signal}).then((e=>{this.setState({searchSuggestionStore:e},(()=>this._showDropdown()))}))}),500,{leading:!1});_updateDirectMatchItems(e){this.setState((t=>({directMatchItem:Ky(e,this._directMatchBlocks,this._refSearchField.current?.offsetWidth??0,t.directMatchItem)})),(()=>{this.state.directMatchItem&&this._showDropdown()}))}onChange=({currentTarget:{value:e}})=>{$n.Z.setText(this.context.vivaldiWindowId,e);const t=e.length>0&&e.indexOf(" ")>=1?Gn.Z.getByQuery(e):null;t&&this.setState({currentSearchEngine:t});if(!(e.trim().length>1))return void this.setState({searchSuggestionStore:[],directMatchItem:void 0,dropdownSelectionIndex:0,typedValue:e});this.props.prefValues[$.kVivaldiAddressBarSearchDirectMatchEnabled]&&!this._directMatchBlocks&&this._getDirectMatchUtils();const n={dropdownSelectionIndex:0,typedValue:e};this.props.prefValues[$.kAddressBarSearchSuggestEnabled]?this.state.currentSearchEngine&&this._protectedSearchSuggest(this.context.vivaldiWindowId,e,this.state.currentSearchEngine):n.searchSuggestionStore=[],this.props.prefValues[$.kVivaldiAddressBarSearchDirectMatchEnabled]?this._updateDirectMatchItems(e):n.directMatchItem=void 0,this.setState(n)};onDragStart=e=>{this._suppressReplace=!0};onDragOver=e=>{e.stopPropagation()};onDragEnter=e=>{if(e.stopPropagation(),this._suppressReplace)return;e.preventDefault();const{HTMLInputElement:t}=this.context,n=e.target;n instanceof t&&""!==n.value&&n.classList.add("pseudo-selected")};onDragLeave=e=>{if(!this._suppressReplace){const{HTMLInputElement:t}=this.context,n=e.target;n instanceof t&&n.classList.remove("pseudo-selected")}};onDropped=e=>{if(this._suppressReplace)this._suppressReplace=!1;else{const t=e.dataTransfer.getData("text/plain");""!==t&&(e.preventDefault(),this.setState({editText:t}),$n.Z.setText(this.context.vivaldiWindowId,t));const{HTMLInputElement:n}=this.context,s=e.target;s instanceof n&&s.classList.remove("pseudo-selected")}};onToggleDropdownClicked=e=>{if(e.preventDefault(),"click"!==e.type||0===e.clientX||0===e.clientY)return this.state.isOmniDropdownOpen?void this._hideDropdown():(this._onSearchFieldStoreChanged(),void this._showDropdown({showAll:!0}))};onSlidebarPosition=(e,t)=>{if(this._refSearchField.current){const t=this._refSearchField.current.getBoundingClientRect();Ne.Z.set($.kAddressBarSearchFieldWidth,Math.floor(t.right-e))}};getWidth=()=>(0,gb.Z)(this.props.prefValues[$.kAddressBarSearchFieldWidth],175,800);focusField=()=>{this._refSearch?.select()};onOmniDropdownItemClicked=(e,t)=>{this._search({value:e.url,openOptions:t})};onContextMenu=e=>{e.stopPropagation()};setSelectedItem=e=>{const t=e&&e.url?"OMNI_RESULT_DIRECT_MATCH"===e.type?e.title:e.url:"";this.setState({selectedItem:e,editText:t})};getDropdownItems=e=>{const t=e?this.state.typedHistoryStore:this.state.filteredTypedHistoryStore,{typedValue:n,directMatchItem:s}=this.state;return[{items:n.length?[{id:n,type:"OMNI_RESULT_TYPED_SEARCH",url:n}]:[],type:"SEARCH"},{items:s?[s]:[],type:"DIRECT_MATCH"},{items:t,type:"TYPED_HISTORY"},{items:this.props.prefValues[$.kAddressBarSearchSuggestEnabled]?this.state.searchSuggestionStore.map((e=>({...e,isDeleteDisabled:!0}))):[],type:"SUGGESTIONS"}]};renderDropdown=()=>{const e=this.getDropdownItems(this.state.showAll);return 0===e.length?null:(0,fs.jsx)(pC,{hideIcons:!0,defaultSearchEngine:this.state.currentSearchEngine,onDeleteItem:this.onTypedSearchHistoryDeleted,onLinkItemClicked:this.onOmniDropdownItemClicked,pattern:this.state.editText,ref:this._omniDropdownRef,selectionIndex:this.state.dropdownSelectionIndex,items:e,onMenuClosed:this._hideDropdown})};toggleSearchEngineSelectOpen=()=>{this.setState((e=>({isSearchEngineSelectOpen:!e.isSearchEngineSelectOpen,isOmniDropdownOpen:!1})))};closeSearchEngineSelect=()=>{this.setState({isSearchEngineSelectOpen:!1}),"button"===this.props.prefValues[$.kAddressBarSearchDisplay]&&this.focusField()};hideSearchField=()=>{this.setState({showPopup:!1})};toggleHiddenSearchFieldPopup=()=>{this.setState((e=>({showPopup:!e.showPopup})))};renderSearchField(){const{inEditor:e=!1}=this.props;if(e)return(0,fs.jsx)("input",{type:"text",value:(0,Oe.Z)("verb","Search"),...qo({draggable:this.props.draggable,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,onDragEnter:this.props.onDragEnter,onDragOver:this.props.onDragOver,onDragLeave:this.props.onDragLeave,onDrop:this.props.onDrop}),readOnly:!0});const t=this.state.currentSearchEngine?(0,Oe.Z)("Search $1",[this.state.currentSearchEngine.name]):"",n=0===this.state.typedHistoryStore.length,s=Boolean(this.state.typedValue),i=!s&&this.props.prefValues[$.kAddressBarSearchTypedHistoryEnabled],o=this.props.popupPosition||"below";return(0,fs.jsxs)("div",{ref:this._refSearchField,className:As()(this.props.buttonClasses,this.props.className,"iconmenu-container","SearchField",o),...qo({draggable:this.props.draggable,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,onDragEnter:this.props.onDragEnter,onDragOver:this.props.onDragOver,onDragLeave:this.props.onDragLeave,onDrop:this.props.onDrop}),onContextMenu:this.onContextMenu,style:{"--SearchFieldWidth":this.getWidth()},children:[!this._isOnSpeedDial&&"button"!==this.props.prefValues[$.kAddressBarSearchDisplay]&&Tee(lv,{className:"SearchField-SlideBar",onSlidebarPosition:this.onSlidebarPosition,offset:2,position:"left"}),Tee(Xb,{onItemClicked:this.onSearchEngineChanged,items:this.state.searchEngineSelectItems,isOpen:this.state.isSearchEngineSelectOpen,onClose:this.closeSearchEngineSelect,toggleOpen:this.toggleSearchEngineSelectOpen,icon:this.state.currentSearchEngine?this.state.currentSearchEngine.faviconUrl:"",useFavicon:this.props.prefValues[$.kAddressBarSearchShowFavicon],showKeywords:this.props.prefValues[$.kAddressBarSearchShowKeyword]}),(0,fs.jsx)("input",{ref:e=>this._refSearch=e,className:"vivaldi-searchfield searchfield-input",onBlur:this.onBlur,onChange:this.onChange,autoFocus:!this._isOnSpeedDial&&"button"===this.props.prefValues[$.kAddressBarSearchDisplay],onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onDoubleClick:this.onDoubleClick,onDragEnter:this.onDragEnter,onDragStart:this.onDragStart,onDragOver:this.onDragOver,onDragLeave:this.onDragLeave,onDrop:this.onDropped,onFocus:this.onFocus,onKeyDown:this.onKeyDowned,onKeyPress:this.onKeyPressed,onCompositionStart:this._onCompositionStart,onCompositionUpdate:this._onCompositionStart,onCompositionEnd:this._onCompositionEnd,onPaste:this.onPaste,placeholder:t,tabIndex:this._isOnSpeedDial?0:null,type:"search",value:this.state.editText}),this.state.isOmniDropdownOpen&&this.renderDropdown(),s&&Tee(_ee,{onClick:this.onExecuteSearchButtonClick,tabIndex:this.props.prefValues[$.kKeyboardTabToAll]}),i&&Tee(Eee,{disabled:n,tabIndex:this.props.prefValues[$.kKeyboardTabToAll],onMouseDown:this.onToggleDropdownClicked,onClick:this.onToggleDropdownClicked})]})}render(){if("button"===this.props.prefValues[$.kAddressBarSearchDisplay]&&!this._isOnSpeedDial||this.props.forceIcon){const{size:e="large"}=this.props;return Tee(Fa,{image:Ts.YvR[e],tooltip:(0,Oe.Z)("Show Search Field"),onClick:this.toggleHiddenSearchFieldPopup,customizeMenu:this.props.customizeMenu,menuOrigin:this.props.menuOrigin,popupPosition:this.props.popupPosition,draggable:this.props.draggable,onDragStart:this.props.onDragStart??Aa.Z,onDragEnd:this.props.onDragEnd??Aa.Z,onDragEnter:this.props.onDragEnter,onDragOver:this.props.onDragOver,onDragLeave:this.props.onDragLeave,onDrop:this.props.onDrop??Aa.Z,hidePopup:this.hideSearchField,isPopupVisible:this.state.showPopup,popupWidth:210,hasLightArrow:!0,size:e,popupClassName:"SearchField-Popup",mimeType:this.props.mimeType,name:this.props.name},void 0,this.renderSearchField())}return this.renderSearchField()}}const Nee=sa(ta(Mee),Zee);var Pee;function Dee(e,t,n,s){Pee||(Pee="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Pee,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class xee extends hs.Component{static contextType=xi.Z;state={taskInfo:this.props.taskInfo};onContextMenu=e=>{const{taskInfo:t}=this.props;(0,Qi.Z)(this.context,t.menuItems)};render(){const{taskInfo:e}=this.props;return Dee("p",{className:"button-toolbar-small in-progress",id:e.id,title:e.title+"\n"+e.description,onContextMenu:this.onContextMenu},void 0,this.state.taskInfo.text)}}const Oee=xee;var Lee;function Ree(e,t,n,s){Lee||(Lee="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Lee,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Bee extends hs.PureComponent{state={backgroundTasks:n2.getBackgroundTasks()};componentDidMount(){n2.addListener(this.onBackgroundTaskStoreChange)}componentWillUnmount(){n2.removeListener(this.onBackgroundTaskStoreChange)}onBackgroundTaskStoreChange=()=>{this.setState({backgroundTasks:n2.getBackgroundTasks()})};render(){return(0,fs.jsx)(fs.Fragment,{children:this.state.backgroundTasks.map((e=>Ree(Oee,{taskInfo:e},e.id)))})}}const Fee=Bee,Vee=Object.freeze({status:"",persistentStatuses:new Map});class Wee extends F.Z{getInitialState(){return new Map}getEntry(e){return this.getState().get(e)??Vee}reduce(e,t){switch(t.actionType){case"WINDOW_CLOSED":return(0,V.Uy)(e,(e=>{e.delete(t.windowId)}));case"STATUS_SET_STATUS":return(0,my.c)(e,t.windowId,(e=>{e.status=t.status}),Vee);case"STATUS_SET_PERSISTENT_STATUS":return(0,my.c)(e,t.windowId,(e=>{e.persistentStatuses.set(t.key,t.status)}),Vee);case"STATUS_CLEAR_PERSISTENT_STATUS":return(0,my.c)(e,t.windowId,(e=>{e.persistentStatuses.delete(t.key)}),Vee);case"PAGE_OPEN":return(0,my.c)(e,t.windowId,(e=>{e.status=""}),Vee)}return e}}const Uee=new Wee;var Hee;function zee(e,t,n,s){Hee||(Hee="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Hee,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var Gee=zee(Fee,{});class $ee extends hs.PureComponent{static contextType=xi.Z;state={status:Uee.getEntry(this.context.vivaldiWindowId).status,visible:!1};componentDidMount(){const{selectWindow:e}=this.context;Uee.addListener(this.onStoreChange,e),this._persistentStatusIndex=0}componentWillUnmount(){clearTimeout(this._statusTimeout),clearInterval(this._persistentStatusInterval),Uee.removeListener(this.onStoreChange)}onStoreChange=()=>{clearTimeout(this._statusTimeout),clearInterval(this._persistentStatusInterval);const{status:e,persistentStatuses:t}=Uee.getEntry(this.context.vivaldiWindowId);e?this.setState({status:e,visible:!0}):1===t.size?this.setState({status:[...t.values()][0],visible:!0}):t.size>1?this._persistentStatusInterval=setInterval((()=>{this._persistentStatusIndex=this._persistentStatusIndex%t.size;const e=[...t.values()][this._persistentStatusIndex++];this.setState({status:e,visible:!0})}),2e3):this._statusTimeout=setTimeout((()=>this.setState({visible:!1})),200)};urlSecurityDisplay=()=>{const e=(0,gy.dO)(this.state.status);return zee("div",{className:"StatusInfo-Content"},void 0,zee(WC,{windowId:this.context.vivaldiWindowId,urlFragments:e,displayUrl:this.state.status,shouldShowFullUrl:!0,onGoToPath:Aa.Z,onBaseDomainObscured:Aa.Z,shouldHighlightBaseDomain:!1,rawDisplay:!0}))};renderStatusInfoContent=()=>HC()(this.state.status)?this.urlSecurityDisplay():zee("span",{className:"StatusInfo-Content"},void 0,this.state.status);render(){const e=this.props.customizeMenu;return(0,fs.jsxs)(fs.Fragment,{children:[(0,fs.jsx)("span",{style:this.props.style,className:As()(this.props.buttonClasses,{StatusInfo:!0,"button-toolbar":this.props.preview,"StatusInfo--Visible":this.state.visible||this.props.preview}),...qo({draggable:this.props.draggable,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,onDragEnter:this.props.onDragEnter,onDragOver:this.props.onDragOver,onDragLeave:this.props.onDragLeave,onDrop:this.props.onDrop}),onContextMenu:e?t=>(0,Qi.Z)(this.context,e)(t):null,children:this.props.preview?zee("button",{className:"ToolbarButton-Button"},void 0,zee("span",{dangerouslySetInnerHTML:{__html:Ts.MSA[this.props.size||"medium"]+(0,Oe.Z)("Status")}})):this.renderStatusInfoContent()}),Gee]})}}const Kee=ta($ee);var jee;function Yee(e,t,n,s){jee||(jee="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:jee,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Xee extends hs.Component{static contextType=xi.Z;state={statusText:(0,Oe.Z)("Sync"),statusOverlay:"none",active:!1};componentDidMount(){TX.addListener(this.onStoreChange),Jn.Z.addListener(this.onStoreChange),this.onStoreChange()}componentWillUnmount(){TX.removeListener(this.onStoreChange),Jn.Z.removeListener(this.onStoreChange)}onStoreChange=()=>{const e=(0,Jn.O)(Jn.Z.getState()),t=Jn.Z.getState().accountInfo.username,n=TX.getState().engineData,s=TX.getState().cycleData,i=n.isFirstSetupComplete&&"stopped"!==n.engineState;let o="none";"loggedOut"!==e&&(n.isFirstSetupComplete&&("credentialsMissing"===e||"loginFailed"===e||n.needsDecryptionPassword)||"failed"===n.engineState&&!n.disableReasons.includes("not_signed_in")||"disable_sync_on_client"===n.protocolErrorClientAction?o="failed":["started","stopped"].includes(n.engineState)&&0===parseInt(s.nextRetryTime)||(o="waiting"));let a=(0,Oe.Z)("Sync");if("loggedOut"===e)a=(0,Oe.Z)("Sync not connected");else if("failed"===o)a=(0,Oe.Z)("Failed to start Sync for “$1”",[t]);else if("clearing_data"===n.engineState)a=(0,Oe.Z)("Clearing Sync server data for “$1”",[t]);else if("configuration_pending"===n.engineState)a=(0,Oe.Z)("Setting up Sync for “$1”",[t]);else if("started"===n.engineState){if(a=(0,Oe.Z)("Connected to Sync as “$1”",[t]),"not_synced"!==s.downloadUpdatesStatus){const[e,t]=function(e){return[cX(e.downloadUpdatesStatus,!0),cX(e.commitStatus,!1)]}(s);a+="\n"+(0,Oe.Z)("Last sync: $1",[N()(s.cycleStartTime).calendar()])+"\n"+e+"\n"+t}}else a=(0,Oe.Z)("Connecting to Sync as “$1”...",[t]);this.setState({active:i,statusOverlay:o,statusText:a})};openSyncSettings=()=>{Ae.Z.showSettings(this.context.vivaldiWindowId,"sync")};getImageForStatus=e=>{let t=Ts.UTS;return"failed"===this.state.statusOverlay?t=Ts.bBo:"waiting"===this.state.statusOverlay?t=Ts.rvX:this.state.active&&(t=Ts.ssx),t};render(){return Yee(Fa,{onClick:this.openSyncSettings,image:this.getImageForStatus(status)[this.props.size],tooltip:this.state.statusText,customizeMenu:this.props.customizeMenu,menuOrigin:this.props.menuOrigin,draggable:this.props.draggable,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,onDrop:this.props.onDrop,onDragEnter:this.props.onDragEnter,mimeType:this.props.mimeType,name:this.props.name,size:this.props.size})}}const Qee=Xee;var qee;function Jee(e,t,n,s){qee||(qee="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:qee,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const ete=[{title:(0,Oe.Z)("Always"),profile:"always"},{title:(0,Oe.Z)("Cached"),profile:"cache"},{title:(0,Oe.Z)("title","Never"),profile:"never"}],tte=[{title:(0,Oe.Z)("command","Loop"),profile:"allowed"},{title:(0,Oe.Z)("Once"),profile:"once"},{title:(0,Oe.Z)("command","Never"),profile:"none"}];class nte extends hs.PureComponent{static contextType=xi.Z;_isMounted=!1;state={imageLoading:H.Z.get($.kPageImageLoading),animationProfile:"allowed",drawerOpen:!1};componentDidMount(){this._isMounted=!0,s.Z.accessibilityFeatures.animationPolicy.onChange.addListener(this._onAnimationPolicyChanged),this._onAnimationPolicyChanged(),H.Z.addListener($.kPageImageLoading,this._onSettingsChanged)}componentWillUnmount(){this._isMounted=!1,s.Z.accessibilityFeatures.animationPolicy.onChange.removeListener(this._onAnimationPolicyChanged),H.Z.removeListener($.kPageImageLoading,this._onSettingsChanged)}_onSettingsChanged=(e,t)=>{this.setState({imageLoading:t})};_onAnimationPolicyChanged=()=>{s.Z.accessibilityFeatures.animationPolicy.get({},(({value:e})=>{this._isMounted&&this.setState({animationProfile:e})}))};onImageProfileSelected=e=>{switch(Ne.Z.set($.kPageImageLoading,e),e){case"never":this.updatePageImageState(!1,!1);break;case"cache":this.updatePageImageState(!0,!0);break;case"always":this.updatePageImageState(!0,!1)}};onAnimationsProfileSelected=e=>{this.setState({animationProfile:e},(()=>{s.Z.accessibilityFeatures.animationPolicy.set({value:e},(()=>{}))}))};updatePageImageState=(e,t)=>{const n=ie.ZP.getActivePage(this.context.vivaldiWindowId);n&&C.Z.tabsPrivate.update(n.id,{showImages:e,loadFromCacheOnly:t})};hidePopup=()=>{this.state.drawerOpen&&this.setState({drawerOpen:!1})};togglePopup=()=>{this.setState((e=>({drawerOpen:!e.drawerOpen})))};render(){const e=this.state.imageLoading,t=this.state.animationProfile,n=this.props.disabled;return Jee(Fa,{buttonStyle:{"--displayImagesAll":"always"===e?"block":"none","--displayImagesCached":"cache"!==e||n?"none":"block","--displayImagesNever":"never"!==e||n?"none":"block","--displayAnimationOnce":"once"===t?"block":"none","--displayAnimationNever":"none"===t?"block":"none"},tooltip:(0,Oe.Z)("Toggle images and animation"),onClick:this.togglePopup,disabled:this.props.disabled,image:Ts.myO[this.props.size],size:this.props.size,customizeMenu:this.props.customizeMenu,menuOrigin:this.props.menuOrigin,hidePopup:this.hidePopup,popupPosition:this.props.popupPosition,isPopupVisible:this.state.drawerOpen,draggable:this.props.draggable,onDragStart:this.props.onDragStart,hasLightArrow:"above"===this.props.popupPosition,onDragEnd:this.props.onDragEnd,onDrop:this.props.onDrop,onDragEnter:this.props.onDragEnter,mimeType:this.props.mimeType,popupClassName:"ToolbarButtonPopup-DefaultStyles",name:this.props.name},void 0,Jee("form",{},void 0,Jee("h2",{},void 0,(0,Oe.Z)("title","Load Images")),Jee("div",{className:"ToggleImages-Selection"},void 0,ete.map((({title:t,profile:n},s)=>Jee("label",{},"imagePolicy-"+n,Jee("input",{autoFocus:e===n,type:"radio",name:"toggle-image-group",checked:e===n,onChange:this.onImageProfileSelected.bind(this,n)}),t)))),Jee("h2",{},void 0,(0,Oe.Z)("Play Image Animation")),Jee("div",{className:"ToggleImages-Selection"},void 0,tte.map((({title:e,profile:n})=>Jee("label",{},"animationPolicy-"+n,Jee("input",{type:"radio",name:"toggle-animations-group",checked:t===n,onChange:this.onAnimationsProfileSelected.bind(this,n)}),e))))))}}const ste=nte;var ite;function ote(e,t,n,s){ite||(ite="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:ite,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const ate=function(e){const t=ie.ZP.unsafeGetActivePage(e),n=(0,ay.jA)(t);return{groupId:t.vivExtData.group??"",tileId:n&&ie.ZP.getTiles(n,e).count()>1?n:"",tileMode:t.vivExtData.tiling?.layout,disabled:1===ie.ZP.getPages(e).count()}};class rte extends hs.PureComponent{static contextType=xi.Z;_isMounted=!1;_focusRef=hs.createRef();constructor(e,t){super(e),this.state={drawerOpen:!1,...ate(t.vivaldiWindowId)}}componentDidMount(){const{selectWindow:e}=this.context;this._isMounted=!0,ie.ZP.addListener(this._onPageStoreChange,e)}componentDidUpdate(e){this._isMounted&&e.pageId!==this.props.pageId&&this.hidePopup()}componentWillUnmount(){this._isMounted=!1,ie.ZP.removeListener(this._onPageStoreChange)}_onPageStoreChange=()=>{this._isMounted&&this.setState(ate(this.context.vivaldiWindowId))};togglePopup=()=>{this.setState((e=>({drawerOpen:!e.drawerOpen})))};hidePopup=()=>{this.state.drawerOpen&&this.setState({drawerOpen:!1})};setTiling=e=>{if(e.hasOwnProperty("button")&&e.button!==Hi.Z.kLeft)return;const t=this.context.vivaldiWindowId,n=G.ZP.getActiveWorkspace(t),s=e.currentTarget.value,i=ie.ZP.getSelection(t).reduce(((e,s)=>{const i=ie.ZP.getPageInWindow(t,s);return i&&(0,ay.cm)(i)===n?e.push(i):e}),(0,te.aV)());if(i.size>1)d.ZP.tilePages(i,s);else if(this.state.tileId){const e=ie.ZP.getTiles(this.state.tileId,t);d.ZP.tilePages(e,s)}else ie.ZP.isGroup(this.state.groupId,t)?d.ZP.tileTabStack(t,this.state.groupId,s):d.ZP.tileLastActive(t,s);this.hidePopup()};untile=()=>{d.ZP.untileTileGroup(this.context.vivaldiWindowId,this.state.tileId),this.hidePopup()};keyDownHandler=e=>{const t=e.currentTarget,n=t.parentElement?.querySelectorAll(".PageTiling-Button:not([disabled])");if(n?.length)switch(e.key){case"ArrowUp":let s=[].indexOf.call(n,t)-1;s<0&&(s=n.length-1),n[s].focus();break;case"ArrowDown":let i=[].indexOf.call(n,t)+1;i>=n.length&&(i=0),n[i].focus();break;case" ":case"Enter":"none"===t.value?this.untile():this.setTiling(e);break;default:return}};focusPopup=()=>this._focusRef.current?.focus();render(){return ote(Fa,{customizeMenu:this.props.customizeMenu,tooltip:(0,Oe.Z)("Page tiling")+"\n"+(0,Oe.Z)("Tile the current tab selection, tab stack, or last active tab"),buttonStyle:{"--displayTileColumn":!this.state.tileId||"column"!==this.state.tileMode&&"grid"!==this.state.tileMode?"none":"unset","--displayTileRow":!this.state.tileId||"row"!==this.state.tileMode&&"grid"!==this.state.tileMode?"none":"unset"},className:`tilingtoggle ${this.props.size}`,disabled:this.state.disabled,image:Ts.Dx_[this.props.size],size:this.props.size,onClick:this.togglePopup,onPointerDown:this.togglePopup,isPopupVisible:this.state.drawerOpen,hidePopup:this.hidePopup,popupPosition:this.props.popupPosition,menuOrigin:this.props.menuOrigin,draggable:this.props.draggable,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,hasLightArrow:!0,onDrop:this.props.onDrop,onDragEnter:this.props.onDragEnter,mimeType:this.props.mimeType,popupClassName:`ToolbarButtonPopup-DefaultStyles ${this.props.size}`,name:this.props.name,onFocus:this.state.drawerOpen?this.focusPopup:Aa.Z},void 0,ote("h2",{},void 0,(0,Oe.Z)("Page Tiling")),(0,fs.jsx)("button",{ref:this._focusRef,className:As()("PageTiling-Button",{"button-on":"row"===this.state.tileMode}),title:(0,Oe.Z)("Tile vertically"),onKeyDown:this.keyDownHandler,onMouseUp:this.setTiling,value:"row",dangerouslySetInnerHTML:{__html:Ts.Dx_[this.props.size]+(0,Oe.Z)("Tile Vertically")},style:{"--displayTileColumn":"none","--displayTileRow":"unset"}}),ote("button",{className:As()("PageTiling-Button",{"button-on":"column"===this.state.tileMode}),title:(0,Oe.Z)("Tile horizontally"),onKeyDown:this.keyDownHandler,onMouseUp:this.setTiling,value:"column",dangerouslySetInnerHTML:{__html:Ts.Dx_[this.props.size]+(0,Oe.Z)("Tile Horizontally")},style:{"--displayTileColumn":"unset","--displayTileRow":"none"}}),ote("button",{className:As()("PageTiling-Button",{"button-on":"grid"===this.state.tileMode}),title:(0,Oe.Z)("Tile to grid"),onKeyDown:this.keyDownHandler,onMouseUp:this.setTiling,value:"grid",dangerouslySetInnerHTML:{__html:Ts.Dx_[this.props.size]+(0,Oe.Z)("Tile to Grid")},style:{"--displayTileColumn":"unset","--displayTileRow":"unset"}}),ote("button",{className:"PageTiling-Button",title:(0,Oe.Z)("Untile pages"),disabled:!this.state.tileMode,onKeyDown:this.keyDownHandler,onMouseUp:this.untile,value:"none",dangerouslySetInnerHTML:{__html:Ts.Dx_[this.props.size]+(0,Oe.Z)("Untile Pages")},style:{"--displayTileColumn":"none","--displayTileRow":"none"}}))}}const lte=rte;var dte;function cte(e,t,n,s){dte||(dte="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:dte,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const hte=[$.kBiscuitVersion,$.kPanelsPosition,$.kMailIsTurnedOff],pte=(0,Oe.Z)("$1 click to toggle panel floating",[(0,Oe.Z)("key","Shift")]),ute=function(e){const t=ie.ZP.unsafeGetActivePage(e);return{activePageUrl:t.url,activePageId:t.id,activePageContext:t.context,activePageSupportsReaderMode:t.supportsReaderMode,activePageIsReaderModeActive:Boolean(t.vivExtData.readerMode),active:t.active,favIconUrl:t.favIconUrl,isMailPage:t.isMailPage&&!H.Z.get($.kMailIsTurnedOff)}};let gte="";class mte extends hs.PureComponent{static contextType=xi.Z;_isMounted=!1;constructor(e,t){super(e),this.winId=t.vivaldiWindowId,this.state={panelBarVisible:ud.ZP.getIsBarVisible(this.winId),statusBarDisplay:G.ZP.getVisibleUI(this.winId).statusBar,...ute(this.winId)}}componentDidMount(){if(this.props.inEditor)return;const{selectWindow:e}=this.context;this._isMounted=!0,ie.ZP.addListener(this._onPageStoreChange,e),ud.ZP.addListener(this._onPanelStoreChanged),G.ZP.addListener(this._onWindowStoreChanged,e)}componentWillUnmount(){this.props.inEditor||(this._isMounted=!1,ud.ZP.removeListener(this._onPanelStoreChanged),ie.ZP.removeListener(this._onPageStoreChange),G.ZP.removeListener(this._onWindowStoreChanged))}_onPageStoreChange=()=>{this._isMounted&&this.setState(ute(this.winId))};_onPanelStoreChanged=()=>{this._isMounted&&this.setState({panelBarVisible:ud.ZP.getIsBarVisible(this.winId)})};_onWindowStoreChanged=()=>{const e=G.ZP.getVisibleUI(this.winId).statusBar;this._isMounted&&this.state.statusBarDisplay!==e&&this.setState({statusBarDisplay:e})};#J=()=>{Pn.Z.togglePanel(this.winId)};#ee=()=>{Ae.Z.showSettings(this.winId)};render(){const{preview:e,name:t,size:n,label:s,popupPosition:i,customizeMenu:o,draggable:a,onDragStart:r,onDragEnd:l,onDrop:d,onDragEnter:c,mimeType:h,menuOrigin:p}=this.props,u={size:n,name:t,customizeMenu:o,menuOrigin:p,draggable:a,popupPosition:i,onDragStart:r,onDragEnd:l,onDrop:d,onDragEnter:c,mimeType:h};switch(this.props.name){case"AddressField":return(0,fs.jsx)(Iee,{...u,readonly:!1,url:this.state.activePageUrl,id:this.state.activePageId,supportsReaderMode:this.state.activePageSupportsReaderMode,isReaderModeActive:this.state.activePageIsReaderModeActive,active:this.state.active,favIconUrl:this.state.favIconUrl,label:s,pageContext:this.state.activePageContext,preview:this.props.inEditor});case"SearchField":return(0,fs.jsx)(Nee,{...u,className:"UrlBar-SearchField",preview:this.props.preview,inEditor:this.props.inEditor,forceIcon:this.props.forceIcon});case"PanelToggle":return(0,fs.jsx)(Fa,{...u,className:"panel-clickoutside-ignore",tooltip:this.state.panelBarVisible?(0,Oe.Z)("Hide Panel")+"\n"+pte:(0,Oe.Z)("verb","Show Panel")+"\n"+pte,onClick:this.#J,onMiddleClick:Pn.Z.toggleFloating,style:{"--panelClosed":this.state.panelBarVisible?0:1,transform:"right"===this.props.prefValues[$.kPanelsPosition]?"scaleX(-1)":"unset"},image:Ts.sxI[this.props.size],label:s});case"SyncStatus":return!G.ZP.isIncognitoOrGuest(this.winId)&&(0,fs.jsx)(Qee,{...u});case"StatusInfo":return"overlay"!==this.state.statusBarDisplay||this.props.preview?(0,fs.jsx)(Kee,{...u,preview:e}):null;case"VersionInfo":return this.props.prefValues[$.kBiscuitVersion]?cte("div",{className:"biscuit-setting-version"},void 0,cte("span",{className:"application-icon-biscuit",dangerouslySetInnerHTML:{__html:Ts.Qa2}}),cte("span",{className:"biscuit-string"},void 0," ",function(){if(!gte){const{vivaldiVersion:e,chromiumVersion:t}=C.Z.utilities.getVersion();gte=`Vivaldi ${e} / Chrome ${t}`}return gte}()," ")):null;case"CaptureImages":return(0,fs.jsx)(zw,{...u,winId:this.context.vivaldiWindowId});case"TilingToggle":return(0,fs.jsx)(lte,{...u,pageId:this.state.activePageId,disabled:!1});case"ImagesToggle":return(0,fs.jsx)(ste,{...u,disabled:!1});case"PageActions":return(0,fs.jsx)(jw,{...u,pageId:this.state.activePageId,disabled:!1});case"Zoom":return(0,fs.jsx)(lb,{...u,pageId:this.state.activePageId,preview:this.props.inEditor});case"Settings":return(0,fs.jsx)(Fa,{...u,className:"panel-clickoutside-ignore",tooltip:(0,bd.wY)("Settings"),onClick:this.#ee,image:Ts.bqs[this.props.size],label:s});case"Proxy":return(0,fs.jsx)(xb,{...u,preview:this.props.inEditor});default:return null}}}const vte=sa(mte,hte);var fte;function yte(e,t,n,s){fte||(fte="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:fte,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Cte={onDidAbortWithError:(0,Oe.Z)("Update Failed"),onDidFindValidUpdate:(0,Oe.Z)("Update Available"),onUpdaterDidNotFindUpdate:(0,Oe.Z)("Up to Date"),onWillDownloadUpdate:(0,Oe.Z)("Downloading Update"),onDidDownloadUpdate:(0,Oe.Z)("Installing Update"),onWillInstallUpdateOnQuit:(0,Oe.Z)("Restart Required"),onUpdaterDidRelaunchApplication:(0,Oe.Z)("Vivaldi Updated")};class wte extends hs.Component{static contextType=xi.Z;state={hasAutoUpdates:!1};componentDidMount(){this.refreshAutoInstallUpdates()}refreshAutoInstallUpdates=()=>{C.Z.autoUpdate.getAutoInstallUpdates((e=>{this.setState({hasAutoUpdates:e})}))};openDownloadPage=()=>{d.ZP.openURL(this.context.vivaldiWindowId,"https://vivaldi.com/download/"),this.props.hidePopup()};render(){const{message:e,status:t,version:n,releaseNotesUrl:s}=this.props.updateState;if(!t)return null;const{vivaldiVersion:i}=C.Z.utilities.getVersion();return(0,fs.jsxs)(fs.Fragment,{children:[yte("h2",{},void 0,Cte[t]),yte("div",{className:"popup-scrollarea"},void 0,"onDidAbortWithError"===t&&(0,fs.jsxs)(fs.Fragment,{children:[yte("p",{className:"popup-infotext"},void 0,(0,Oe.Z)("Unable to check for update.")),e&&yte("p",{className:"popup-infotext"},void 0,(0,Oe.Z)("Error: $1",[e])),yte("p",{className:"popup-infotext"},void 0,(0,Oe.Z)("Please try again later or visit")," ",yte(hb,{onClick:this.openDownloadPage},void 0,"vivaldi.com/download"))]}),"onDidFindValidUpdate"===t&&!this.state.hasAutoUpdates&&yte("p",{className:"popup-infotext"},void 0,(0,Oe.Z)("An update to version $1 is available.",[n])),"onDidFindValidUpdate"===t&&this.state.hasAutoUpdates&&yte("p",{className:"popup-infotext"},void 0,(0,Oe.Z)("An update to version $1 is available and scheduled for download.",[n])),"onUpdaterDidNotFindUpdate"===t&&yte("p",{className:"popup-infotext"},void 0,(0,Oe.Z)("You are already running the latest version of Vivaldi ($1).",[i])),"onWillDownloadUpdate"===t&&(0,fs.jsxs)(fs.Fragment,{children:[yte("p",{className:"popup-infotext"},void 0,(0,Oe.Z)("An update to Vivaldi version $1 is being downloaded.",[n])),yte("p",{className:"popup-infotext"},void 0,(0,Oe.Z)("Please wait..."))]}),"onDidDownloadUpdate"===t&&(0,fs.jsxs)(fs.Fragment,{children:[yte("p",{className:"popup-infotext"},void 0,(0,Oe.Z)("Installing Vivaldi update version $1.",[n])),yte("p",{className:"popup-infotext"},void 0,(0,Oe.Z)("Please wait..."))]}),"onWillInstallUpdateOnQuit"===t&&""!==n&&yte("p",{className:"popup-infotext"},void 0,(0,Oe.Z)("Restart Vivaldi to begin using the new version $1.",[n])),"onWillInstallUpdateOnQuit"===t&&""===n&&yte("p",{className:"popup-infotext"},void 0,(0,Oe.Z)("Vivaldi has been updated in the background. Please restart now to complete the update.",[n])),"onUpdaterDidRelaunchApplication"===t&&yte("p",{className:"popup-infotext"},void 0,(0,Oe.Z)("Vivaldi successfully updated to version $1.",[i]))),yte("footer",{className:"dialog-footer"},void 0,"onDidFindValidUpdate"===t&&this.state.hasAutoUpdates&&yte("input",{type:"submit",className:"primary",onClick:()=>{d.ZP.openURL(this.context.vivaldiWindowId,s),this.props.hidePopup()},value:(0,Oe.Z)("Show Release Notes")}),"onDidFindValidUpdate"===t&&!this.state.hasAutoUpdates&&yte("input",{type:"submit",className:"primary",onClick:()=>{C.Z.autoUpdate.checkForUpdates(!0),this.props.hidePopup()},value:(0,Oe.Z)("Update Vivaldi")}),"onWillInstallUpdateOnQuit"===t&&yte("input",{type:"submit",className:"danger",onClick:()=>C.Z.autoUpdate.installUpdateAndRestart(),value:(0,Oe.Z)("browser","Restart")}))]})}}const bte=wte;var Ste;function Ite(e,t,n,s){Ste||(Ste="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Ste,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class kte extends hs.PureComponent{constructor(){super();this.state={autoUpdateEnabled:!1,popupVisible:!1,updateState:{message:void 0,status:void 0,version:void 0,releaseNotesUrl:void 0}}}componentDidMount(){if(this.props.inEditor)return;C.Z.autoUpdate.isUpdateNotifierEnabled((e=>{this.setState({autoUpdateEnabled:e})}));const{onDidAbortWithError:e,onDidFindValidUpdate:t,onWillDownloadUpdate:n,onDidDownloadUpdate:s,onWillInstallUpdateOnQuit:i,onUpdaterDidRelaunchApplication:o}=C.Z.autoUpdate;e.addListener(this.#te),t.addListener(this.#ne),n.addListener(this.#se),s.addListener(this.#ie),i.addListener(this.#oe),o.addListener(this.#ae)}componentWillUnmount(){if(this.props.inEditor)return;const{onDidAbortWithError:e,onDidFindValidUpdate:t,onWillDownloadUpdate:n,onDidDownloadUpdate:s,onWillInstallUpdateOnQuit:i,onUpdaterDidRelaunchApplication:o}=C.Z.autoUpdate;e.removeListener(this.#te),t.removeListener(this.#ne),n.removeListener(this.#se),s.removeListener(this.#ie),i.removeListener(this.#oe),o.removeListener(this.#ae)}#te=(e,t)=>{e&&console.warn(e,t),this.setState((0,V.Uy)((({updateState:e})=>{e.status="onDidAbortWithError",e.message=t})))};#ne=(e,t)=>{this.setState((0,V.Uy)((({updateState:n})=>{n.status="onDidFindValidUpdate",n.version=t,n.releaseNotesUrl=e})))};#se=e=>{this.setState((0,V.Uy)((({updateState:t})=>{t.status="onWillDownloadUpdate",t.version=e})))};#ie=e=>{this.setState((0,V.Uy)((({updateState:t})=>{t.status="onDidDownloadUpdate",t.version=e})))};#oe=e=>{this.setState((0,V.Uy)((({updateState:t})=>{t.status="onWillInstallUpdateOnQuit",t.version=e})))};#ae=()=>{this.setState((0,V.Uy)((({updateState:e})=>{e.status="onUpdaterDidRelaunchApplication"})))};togglePopup=()=>{this.setState((e=>({popupVisible:!e.popupVisible})))};hidePopup=()=>{this.setState({popupVisible:!1})};render(){let{status:e}=this.state.updateState;if(!e&&this.props.preview)e="onUpdaterDidNotFindUpdate";else if(!e||!this.state.autoUpdateEnabled)return null;return Ite(Fa,{image:Ts.nuh[this.props.size],title:Cte[e],onClick:this.togglePopup,customizeMenu:this.props.customizeMenu,menuOrigin:this.props.menuOrigin,popupClassName:"UpdatePopup ToolbarButtonPopup-DefaultStyles",popupPosition:this.props.popupPosition,hidePopup:this.hidePopup,isPopupVisible:this.state.popupVisible,size:this.props.size,draggable:this.props.draggable,onDragStart:this.props.onDragStart??Aa.Z,onDragEnd:this.props.onDragEnd??Aa.Z,onDrop:this.props.onDrop??Aa.Z,onDragEnter:this.props.onDragEnter??Aa.Z,onDragLeave:this.props.onDragLeave??Aa.Z,onDragOver:this.props.onDragOver??Aa.Z,mimeType:this.props.mimeType,name:this.props.name},void 0,Ite(bte,{hidePopup:this.hidePopup,updateState:this.state.updateState}))}}const Ate=ta(kte);var Tte;function Zte(e,t,n,s){Tte||(Tte="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Tte,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ete=[$.kMailViewLayout,$.kPanelsAsOverlayEnabled,$.kPanelsPosition],_te=".mainbar .toolbar-mailbar .toolbar-spacer-flexible";class Mte extends hs.PureComponent{static contextType=xi.Z;tryAgain=!0;state={enforcedWidth:0};componentDidMount(){this.props.inEditor||setTimeout((()=>this.setSpacerWidth()),200)}componentWillUnmount(){ud.ZP.ensureRemovedListener(this.setSpacerWidth)}shouldEnforceWidth=()=>{const{document:e}=this.context;if(!this.props.inEditor&&!this.props.preview&&this.props.index<=10&&"FlexibleSpacer"===this.props.name){const t=e.querySelector(_te);if(t?.parentElement)return this.props.index===[...t.parentElement.querySelectorAll("div.button-toolbar")].indexOf(t)}return!1};setSpacerWidth=()=>{if(!this.shouldEnforceWidth())return;ud.ZP.ensureAddedListener(this.setSpacerWidth);const e=this.getSpacerWidth();e>=0&&this.setState({enforcedWidth:e})};getSpacerWidth=()=>{const e=ud.ZP.getSelected(this.context.vivaldiWindowId);if(this.props.prefValues[$.kPanelsAsOverlayEnabled]||e&&ud.ZP.getSeparateFloating(e,this.context.vivaldiWindowId)||"left"!==this.props.prefValues[$.kPanelsPosition])return.1;const{document:t}=this.context,n=t.querySelector(_te),s=t.querySelector(_te+" ~ .SearchField")||n?.nextElementSibling;if(s&&n?.parentElement){const e=n.getClientRects()[0];if(!e)return-1;if(e.left+e.right>=this.context.innerWidth)return this.tryAgain&&(setTimeout((()=>this.setSpacerWidth()),200),this.tryAgain=!1),-1;const t=s.getClientRects()[0]?.left||6,i=ud.ZP.getWidth(this.context.vivaldiWindowId);return Math.max(i-e.left-(t-e.right),.1)}return.1};executeChain=e=>{const{ctrlKey:t,altKey:n,shiftKey:s,metaKey:i}=e,{chain:o}=H.Z.get($.kChainedCommandsCommandList).find((e=>e.name===this.props.name));(0,ka.hT)({origin:"button",context:this.context,windowId:this.context.vivaldiWindowId,keyState:{ctrlKey:t,altKey:n,shiftKey:s,metaKey:i,key:""}},o)};render(){if(this.props.commandButton){const e=H.Z.get($.kChainedCommandsCommandList).find((e=>e.name===this.props.name));return e?Zte(Fa,{name:e.name,customizeMenu:this.props.customizeMenu,image:Ts.Znx[this.props.size],draggable:this.props.draggable,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,onDrop:this.props.onDrop,onDragEnter:this.props.onDragEnter,className:"toolbar-command",tooltip:e.label,onClick:this.executeChain,mimeType:this.props.mimeType,size:this.props.size}):null}if("Divider"===this.props.name)return Zte(Fa,{customizeMenu:this.props.customizeMenu,name:this.props.name,image:Ts.Fm3[this.props.size],mimeType:this.props.mimeType,draggable:this.props.draggable,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,onDrop:this.props.onDrop,onDragEnter:this.props.onDragEnter,className:"toolbar-divider",tooltip:" ",disabled:!this.props.preview,alwaysMenu:!0});const e="FlexibleSpacer"===this.props.name,t=e?Ts.K3w[this.props.size]:Ts.Vzw[this.props.size],n=this.state.enforcedWidth?{minWidth:this.state.enforcedWidth,maxWidth:this.state.enforcedWidth}:{};return Zte(Fa,{style:n,customizeMenu:this.props.customizeMenu,name:this.props.name,image:t,mimeType:this.props.mimeType,draggable:this.props.draggable,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,onDrop:this.props.onDrop,onDragEnter:this.props.onDragEnter,className:e?"toolbar-spacer-flexible":"toolbar-spacer",disabled:!this.props.preview,tooltip:" ",alwaysMenu:!0})}}const Nte=sa(Mte,Ete);var Pte,Dte=n(79336);function xte(e,t,n,s){Pte||(Pte="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Pte,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Ote(e,t,n,s,i){if(!n||!s||!i)return{display:"none"};const o=n.x,[a,r]=t,l=e/2;return{transform:`translate(${o}px, ${(0,gb.Z)(i.y+(s.y-n.y),a+l,r-l)}px)`}}var Lte,Rte=xte("div",{className:"checkmark"},void 0,xte(jo,{type:"checkmark"})),Bte=xte(jo,{type:"reorder"});function Fte({windowId:e,itemHeight:t,refDragArea:n,refScrollArea:s,workspaceCount:i}){const{item:o,isDragging:a,initialClientOffset:r,initialSourceClientOffset:l,sourceClientOffset:d}=(0,Dte.f)((e=>({item:e.getItem(),isDragging:e.isDragging(),initialClientOffset:e.getInitialClientOffset(),initialSourceClientOffset:e.getInitialSourceClientOffset(),sourceClientOffset:e.getSourceClientOffset()})));if(!a)return null;const c=Kj.Z.getWorkspaceById(e,o.id);if(!c)return null;const{tabCount:h,isActive:p,isActiveInAnotherWindow:u}=o,{name:g,icon:m,emoji:v}=c,f=function(e,t){const n=e?.getBoundingClientRect(),s=t?.getBoundingClientRect();return n&&s?[Math.max(n.top,s.top),s.bottom]:[0,0]}(n.current,s.current),y=Boolean(s.current&&s.current.scrollHeight>s.current.clientHeight);return xte("div",{className:As()("workspace-custom-drag-layer",{"has-scrollbar":y})},void 0,xte("button",{style:Ote(t,f,l,d,r),className:As()("workspace-item-wrapper",{selected:p&&!u}),title:g},void 0,xte("div",{className:"avatar picker",dangerouslySetInnerHTML:{__html:v??m}}),xte("div",{className:"title"},void 0,xte("p",{},void 0,g),xte("p",{className:"tab-count"},void 0,u?(0,Oe.Z)("Active in another window"):(0,Oe.Z)("$1 tab","$1 tabs",[h]))),p&&!u?Rte:i>1?Bte:null))}function Vte(e,t,n,s){Lte||(Lte="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Lte,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Wte({windowId:e,activeWorkspaceId:t,toolbarSize:n,onClick:s}){const i=!t,o=(0,hs.useCallback)((()=>{const t=ie.ZP.getPages(e,{workspaceId:void 0}).size;return[{handler:()=>s(!1),...(0,xs.Z)("command","New Workspace")},{handler:()=>s(!0),...(0,xs.Z)("New Workspace with $1 Tab","New Workspace with $1 Tabs",[t])}]}),[s,e]);return Vte(Fa,{buttonClasses:"FormButton FormButton--WithIcon",menuOrigin:"bottomLeft",menu:i?o:void 0,isMenuIndicatorVisible:i,onClick:()=>s(!1),title:(0,Oe.Z)("command","New Workspace"),tabIndex:0})}const Ute="draggable-workspace";var Hte,zte=n(46408);function Gte(e,t,n,s){Hte||(Hte="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Hte,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const $te=Ts.S0Y;var Kte=Gte("div",{className:"checkmark"},void 0,Gte(jo,{type:"checkmark"})),jte=Gte(jo,{type:"reorder"});const Yte=hs.forwardRef((function({id:e,name:t,icon:n,emoji:s,audioStatus:i,tabCount:o,hibernatedCount:a,windowId:r,workspaceCount:l,isActive:d,isActiveInAnotherWindow:c,isRenaming:h,isPickingIcon:p,onSelect:u,onContextMenu:g,onShowIconModal:m,onToggleMuteWorkspaceTabs:v,findItem:f,moveItem:y,onDrop:C,nameInput:w,style:b,onKeyDown:S},I){const k=hs.useRef(),A=f(e)?.index,[{isDragging:T,handlerId:Z},E,_]=(0,Nq.c)((()=>({type:Ute,item:{id:e,originalIndex:A,name:t,tabCount:o,isActive:d,isActiveInAnotherWindow:c,workspaceCount:l},collect:e=>({isDragging:e.isDragging(),handlerId:e.getHandlerId()})})),[e,A,y]),[,M]=(0,Pq.L)((()=>({accept:Ute,hover(t,n){if(!k.current||"number"!=typeof A)return;const s=t.originalIndex,i=A;if(s===i)return;const o=k.current?.getBoundingClientRect(),a=(o.bottom-o.top)/2,r=n.getClientOffset().y-o.top;s<i&&r<a||s>i&&r>a||(y(t.id,e),t.originalIndex=i)},drop:C})),[e,y]);return hs.useEffect((()=>{_((0,zte.r)(),{captureDraggingState:!0})}),[_]),l>1&&(E(k),M(k)),(0,fs.jsxs)("button",{ref:k,style:{...b,opacity:T?0:1},className:As()("workspace-item-wrapper draggable",{selected:d&&!c}),title:t,onPointerUp:t=>t.button===Hi.Z.kLeft&&u(e),onClick:t=>{t.preventDefault(),u(e)},onContextMenu:t=>g(t,e),"data-handler-id":Z,onKeyDown:S,children:[(0,fs.jsx)("div",{ref:I,className:"avatar picker",onPointerDown:t=>m(t,e),onPointerUp:p?to.ZP:Aa.Z,onClick:to.ZP,dangerouslySetInnerHTML:{__html:s??n??$te}}),h&&w,!h&&Gte("div",{className:"title"},void 0,Gte("p",{},void 0,t),Gte("p",{className:"tab-count"},void 0,c?(0,Oe.Z)("Active in another window"):(0,Oe.Z)("$1 tab","$1 tabs",[o])," ",!c&&a>0&&(0,Oe.Z)("($1 hibernated)","($1 hibernated)",[a]))),i&&Gte("div",{className:As()("audio-container",{"workspace-inactive":!d||c}),onClick:t=>v(t,r,e,i)},void 0,Gte(Qo,{animated:H.Z.get($.kThemeUseAnimation),mediaState:(0,te.l4)([i]),src:"tab"})),d&&!c?Kte:l>1?jte:null]},e)})),Xte=hs.memo(Yte);function Qte({workspaceName:e,name:t,submitOnBlur:n,onSubmitEdit:s,onCancelEdit:i,onNameChange:o},a){const r=(0,hs.useContext)(xi.Z),[l,d]=(0,hs.useState)(!1),c=()=>{d(!0)};return(0,fs.jsx)("input",{ref:a,type:"text",name:t,value:e,onKeyDown:e=>{l||(e.keyCode===oa.Z.KEY_ENTER||e.keyCode===oa.Z.KEY_RETURN?s():e.keyCode===oa.Z.KEY_ESCAPE&&i())},onBlur:n?s:Aa.Z,onFocus:e=>{e.target instanceof r.HTMLInputElement&&e.target.select()},onChange:o,onCompositionStart:c,onCompositionUpdate:c,onCompositionEnd:()=>{d(!1)}})}const qte=(0,hs.forwardRef)(Qte);var Jte,ene=n(34155);function tne(e,t,n,s){Jte||(Jte="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Jte,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const nne={stiffness:500,damping:32};function sne(e,t){const n=ie.ZP.getPageHistory(e);for(let t=n.length-1;t>-1;t--){const s=n[t],i=ie.ZP.getPageInWindow(e,s);if(i&&void 0===(0,ay.cm)(i))return je.jk.getDisplayTitle(i)}return""}function ine(e,t,n,s){e.stopPropagation();const i=ie.ZP.getPages(t,{workspaceId:n});"playing"===s?d.ZP.setMuting(t,"selection","mute",i):d.ZP.setMuting(t,"selection","unmute",i)}function one(){return Kj.S[Math.floor(Math.random()*Kj.S.length)]}var ane=tne(Fa,{name:"WorkspaceButton",image:Ts.BmN,tooltip:" ",size:"small",className:"avatar",imageOnly:!0}),rne=tne("div",{className:"checkmark"},void 0,tne(jo,{type:"checkmark"})),lne=tne("hr",{});const dne=hs.forwardRef((function(e,t){const{windowId:n,activeWorkspaceId:s,hidePopup:i}=e,o=hs.useContext(xi.Z),a=eJ(),r=hs.useRef(!1),l=hs.useRef(null),c=hs.useRef(null),h=G.ZP.getActiveWorkspaces(n),[p,u]=hs.useState(),[g,m]=hs.useState(),[v,f]=hs.useState(""),[y,C]=hs.useState(),[w,b]=hs.useState(0),S=hs.useRef(),I=hs.useRef(),k=hs.useMemo((()=>new Map),[]),{counts:A,playingAudio:T}=function(e){const t=Kj.Z.getWorkspaces(e),n=G.ZP.isIncognitoOrGuest(e),s=new Map(t.map((e=>[e.id,[0,0]]))),i=new Map(t.map((e=>[e.id,void 0])));let o=new te.l4;for(const[t,a]of ie.ZP.getState())n===G.ZP.isIncognitoOrGuest(t)&&a.list.groupBy(ay.cm).forEach(((n,a)=>{let r;void 0===a&&e!==t||(n.some((e=>e.audible&&!e.vivExtData.vivaldi_tab_muted?(r="playing",!0):(e.audible&&e.vivExtData.vivaldi_tab_muted&&(r="muting"),!1))),i.set(a,r),!a||s.has(a)||G.ZP.isIncognitoOrGuest(t)||(console.warn(`Workspace ${a} no longer exists.`),o=o.add(a)),s.set(a,[n.size,n.count((e=>e.discarded))]))}));for(const t of o)kq.Z.addWorkspaceWithId(e,t,(0,Oe.Z)("Restored workspace"),one(),void 0);return{counts:s,playingAudio:i}}(n),[Z,E]=hs.useState(""),[_,M]=hs.useState(""),[N,P]=hs.useState(),[D,x]=hs.useState(!1),O=T.get(void 0),L=e.workspaces.length,R=hs.useRef(!0);hs.useEffect((()=>{if(!R.current||"number"!=typeof s)return;const e=k.get(s)?.current;e&&o.requestAnimationFrame((()=>{e.scrollIntoViewIfNeeded(!0),R.current=!1}))}));const[B,F]=hs.useState(e.workspaces),W=hs.useRef(e.workspaces);B!==e.workspaces&&(W.current=e.workspaces,F(e.workspaces));const U=hs.useCallback((async e=>{g&&e===g||(e!==s&&cs.Z.setActiveWorkspace(n,e),i())}),[s,i,g,n]),z=hs.useCallback(((e,t)=>{const o="workspacelist",a=Boolean(t&&h.has(t)),r=a&&t!==s,l=Pi.getOptionFunction(o),c=t?ie.ZP.getWorkspacePages(t):ie.ZP.getPages(n,{workspaceId:void 0});return Pi.getNamedMenu(n,o,(async e=>{switch(e.action){case"CONTEXT_WORKSPACE_RENAME":return{handler:()=>{m(t);const e=W.current?.find((e=>e.id===t))?.name??"";E(e),ene.nextTick((()=>{I.current?.select()}))},isVisible:()=>Boolean(t),...l(n,e,t)};case"CONTEXT_WORKSPACE_DELETE":return{isEnabled:()=>!r,handler:()=>{i(),t&&Ae.Z.showDeleteWorkspace(n,{workspaceId:t})},isVisible:()=>Boolean(t),...l(n,e,t)};case"CONTEXT_WORKSPACE_OPEN_IN_NEW_WINDOW":return{isEnabled:()=>!a,handler:e=>{t&&d.ZP.detachWorkspace(t).finally(i)},isVisible:()=>Boolean(t),...l(n,e,t)};case"CONTEXT_WORKSPACE_HIBERNATE":return{handler:()=>{c.filter((e=>!(e.active||e.discarded))).forEach(d.ZP.discardPage),i()},isVisible:()=>c.some((e=>!(e.active||e.discarded))),...l(n,e,t)};case"CONTEXT_WORKSPACE_COPY_URLS":case"COMMAND_PAGE_COPY_ALL_URLS":{const s=void 0===t?n===G.ZP.getActiveWindowId()&&void 0===G.ZP.getActiveWorkspace(n):t===G.ZP.getActiveWorkspace(n),o={...l(n,{...e,action:"COMMAND_PAGE_COPY_ALL_URLS"},t)};return{...o,handler:()=>{d.ZP.copyAllUrls(n,t),i()},shortcuts:s?o.shortcuts:[]}}default:return{...l(n,e,t)}}}))}),[s,h,i,n,W]),K=hs.useCallback(((e,t)=>{e.persist(),e.preventDefault(),e.stopPropagation(),z(e,t).then((t=>{(0,Qi.Z)(o,t)(e)}))}),[o,z]),j=e=>{const t=e.currentTarget,n=t.parentElement?.parentElement?.querySelectorAll(".this-window,.workspace-item-wrapper:not([disabled])");if(n?.length)switch(e.key){case"ArrowUp":let e=[].indexOf.call(n,t)-1;e<0&&(e=n.length-1),n[e].focus();break;case"ArrowDown":let s=[].indexOf.call(n,t)+1;s>=n.length&&(s=0),n[s].focus();break;default:return}},Y=hs.useCallback(((t,n)=>{if(t.button!==Hi.Z.kLeft)return;(0,to.ZP)(t);const s=S.current?.getBoundingClientRect().top??0,i=k.get(n)?.current?.getBoundingClientRect().top??0;if(i-30+266>o.window.innerHeight-133){b(-(s-i+30+266))}else{b(i-s+30)}const a=e.workspaces.find((e=>e.id===n));a?.emoji?C(a.emoji):a?.icon&&(f(a.icon),C(void 0)),u(n)}),[o.window.innerHeight,k,e.workspaces]),X=()=>{u(void 0)},Q=(e,t)=>{if(t){const n=hs.createRef();n.current=t,k.set(e,n)}else k.delete(e)},q=hs.useCallback((()=>{Z&&_&&(x(!1),m(void 0),kq.Z.addWorkspace(Z,_,N,r.current),i())}),[i,N,_,Z]),J=hs.useCallback((()=>{const e=g;m(void 0),Z&&e&&kq.Z.setName(e,Z)}),[g,Z]),ee=hs.useCallback((e=>{E(e.currentTarget.value)}),[]),ne=hs.useCallback((()=>{g?J():q()}),[q,J,g]),se=hs.useCallback((()=>{x(!1),m(void 0)}),[]),oe=hs.useCallback((e=>{const t=W.current??[],n=t.find((t=>t.id===e));if(n)return{item:n,index:t.indexOf(n)}}),[W]),ae=hs.useRef(null),re=hs.useCallback(((e,t)=>{const n=()=>{a(),ae.current=null},s=oe(e)?.index,i=W.current;if(i&&"number"==typeof s){const s=i.find((t=>t.id===e)),a=i.find((e=>e.id===t)),r=i.indexOf(s),l=i.indexOf(a);W.current=(0,V.Uy)(i,(e=>{const[t]=e.splice(r,1);e.splice(l,0,t)})),ae.current||(ae.current=o.requestAnimationFrame(n))}}),[o,oe,a]),le=hs.useCallback((()=>{const e=W.current?.map((e=>e.id))??[];kq.Z.setOrder(n,e)}),[n]),de=hs.useMemo((()=>({position:"relative",minHeight:44*L+8})),[L]),[ce,he]=A.get(void 0)??[0,0];return(0,fs.jsxs)("div",{ref:S,className:"WorkspacePopup",onDoubleClick:to.ZP,children:[(0,fs.jsxs)("div",{ref:c,className:"WorkspacePopup-Items",children:[L>0&&(0,fs.jsxs)(fs.Fragment,{children:[(0,fs.jsxs)("button",{ref:t,className:"this-window",onPointerUp:e=>e.button===Hi.Z.kLeft&&U(void 0),onClick:e=>{e.preventDefault(),U(void 0)},onContextMenu:K,onKeyDown:j,children:[ane,tne("div",{className:"title"},void 0,tne("p",{},void 0,sne(n)),tne("p",{className:"tab-count"},void 0,(0,Oe.Z)("$1 tab","$1 tabs",[ce])," ",he>0&&(0,Oe.Z)("($1 hibernated)","($1 hibernated)",[he]))),O&&tne("div",{className:As()("audio-container",{"workspace-inactive":void 0!==G.ZP.getActiveWorkspace(n)}),onClick:e=>ine(e,n,void 0,O)},void 0,tne(Qo,{animated:H.Z.get($.kThemeUseAnimation),mediaState:(0,te.l4)([O]),src:"tab"})),void 0===G.ZP.getActiveWorkspace(n)&&rne]}),lne]}),!D&&0===L&&tne("div",{className:"no-workspaces-note"},void 0,tne("h1",{},void 0,(0,Oe.Z)("Get organized with Workspaces")),tne("p",{className:"faded-text"},void 0,(0,Oe.Z)("Declutter your tabs by separating your social, work, and hobbies into workspaces. Alternatively, set up link routing to different workspaces based on the domain."))),(0,fs.jsx)("div",{ref:l,className:"WorkspacePopup-DragArea",style:de,children:W.current?.map((({name:e,icon:t,emoji:i,id:o},a)=>{const r=h.has(o),l=r&&o!==s,d=g===o,c=T.get(o);return tne(zq,{style:{posY:jq(44*a,nne)}},o,(({posY:s})=>{const[a,h]=A.get(o)??[0,0];return(0,fs.jsx)(Xte,{ref:e=>Q(o,e),id:o,windowId:n,name:e,icon:t,emoji:i,audioStatus:c,isActive:r,isActiveInAnotherWindow:l,isPickingIcon:!!p,isRenaming:d,tabCount:a,hibernatedCount:h,workspaceCount:L,onSelect:U,onContextMenu:K,onShowIconModal:Y,onToggleMuteWorkspaceTabs:ine,findItem:oe,moveItem:re,onDrop:le,style:{transform:`translate3d(0, ${s}px, 0)`},onKeyDown:j,nameInput:d?(0,fs.jsx)(qte,{ref:I,name:"",workspaceName:Z,submitOnBlur:!0,onNameChange:ee,onSubmitEdit:ne,onCancelEdit:se}):null})}))}))}),tne(Fte,{windowId:n,itemHeight:44,refDragArea:l,refScrollArea:c,workspaceCount:L}),D&&(0,fs.jsxs)(fs.Fragment,{children:[0===L&&tne("label",{htmlFor:"workspace-title",className:"first-workspace-info"},void 0,(0,Oe.Z)("Workspace Name")),tne("button",{className:"workspace-item-wrapper",title:(0,Oe.Z)("title","New Workspace")},"NEW_WORKSPACE",(0,fs.jsx)("div",{className:"avatar picker",ref:e=>Q(1,e),onClick:e=>Y(e,1),dangerouslySetInnerHTML:{__html:N??_}}),tne("div",{className:"title"},void 0,(0,fs.jsx)(qte,{name:"workspace-title",ref:I,workspaceName:Z,submitOnBlur:!D,onNameChange:ee,onSubmitEdit:ne,onCancelEdit:se})))]})]}),tne("div",{className:"actions"},void 0,D&&(0,fs.jsxs)(fs.Fragment,{children:[tne("input",{type:"button",className:"primary",value:(0,Oe.Z)("Create"),disabled:!Z,onClick:q}),tne("input",{type:"button",value:(0,Oe.Z)("Cancel"),onClick:se})]}),!D&&tne(Wte,{windowId:n,activeWorkspaceId:s,toolbarSize:"small",onClick:e=>{r.current=e&&!s;const t=one(),i=Aq(n);E(i),M(t),P(void 0),x(!0),ene.nextTick((()=>{I.current?.focus()}))}})),p&&tne(Sq,{closeModal:X,onPick:e=>{p?(1!==p?"number"==typeof e?kq.Z.setIcon(p,e):kq.Z.setEmoji(p,e):D&&("number"==typeof e?(M(Kj.S[e]),P(void 0)):P(e)),X()):X()},top:w,left:50,activeIcon:v,activeEmoji:y})]})})),cne=Jq(dne);var hne;function pne(e,t,n,s){hne||(hne="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:hne,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const une=[$.kWorkspacesEnabled];class gne extends hs.PureComponent{static contextType=xi.Z;refPopup=hs.createRef();constructor(e,t){super(e),this.windowId=t.vivaldiWindowId;const n=Kj.Z.getWorkspaces(this.windowId),s=G.ZP.getActiveWorkspace(this.windowId),i=n.find((e=>e.id===s));this.state={activeWorkspaceId:s,imageSrc:this.getIcon(i),workspaceName:i?.name,popupVisible:!1,workspaces:n,showName:this.getShowName(),pageIdPlayingAudio:void 0},this.props.inEditor||(G.ZP.addListener(this._onWindowStoreChanged),Kj.Z.addListener(this._onWorkspaceStoreChanged),ie.ZP.addListener(this._onPageStoreChanged),H.Z.addListener($.kWorkspacesButtonShowName,this._onPrefsChange),tl.Z.addListener("COMMAND_SHOW_WORKSPACE_MENU",this._onCommandSpy))}componentWillUnmount(){this.props.inEditor||(G.ZP.removeListener(this._onWindowStoreChanged),Kj.Z.removeListener(this._onWorkspaceStoreChanged),ie.ZP.removeListener(this._onPageStoreChanged),H.Z.removeListener($.kWorkspacesButtonShowName,this._onPrefsChange),tl.Z.removeListener("COMMAND_SHOW_WORKSPACE_MENU",this._onCommandSpy))}componentDidUpdate(e,t){!t.popupVisible&&this.state.popupVisible&&this.focusPopup()}_onCommandSpy=e=>{this.props.inTabbar&&e===this.context.vivaldiWindowId&&this.togglePopup()};_onPageStoreChanged=()=>{const e=G.ZP.getActiveWorkspace(this.windowId),t=G.ZP.isIncognitoOrGuest(this.windowId),{pageIdPlayingAudio:n}=this.state;if(void 0!==n){const t=ie.ZP.getPageById(n);if(t&&t.audible&&!t.vivExtData.vivaldi_tab_muted&&e!==(0,ay.cm)(t))return}let s;for(const[n,i]of ie.ZP.getState()){if(t!==G.ZP.isIncognitoOrGuest(n))continue;const o=i.list.groupBy(ay.cm).find(((t,s)=>{if(s!==e&&(void 0!==s||n===this.windowId))return t.find((e=>e.audible&&!e.vivExtData.vivaldi_tab_muted))}))?.first();if(o){s=o.id;break}}this.setState({pageIdPlayingAudio:s})};_onWindowStoreChanged=()=>{const e=G.ZP.getActiveWorkspace(this.windowId);if(e!==this.state.activeWorkspaceId){const t=Kj.Z.getWorkspaces(this.windowId).find((t=>t.id===e));this.setState({activeWorkspaceId:e,imageSrc:this.getIcon(t),workspaceName:t?.name})}};_onWorkspaceStoreChanged=()=>{const e=Kj.Z.getWorkspaces(this.windowId),t=G.ZP.getActiveWorkspace(this.windowId),n=e.find((e=>e.id===t));this.setState({workspaces:e,imageSrc:this.getIcon(n),workspaceName:n?.name})};_onPrefsChange=()=>{this.setState({showName:this.getShowName()})};getShowName=()=>{if(this.props.inTabbar){const e=H.Z.get($.kTabsBarPosition);return Boolean(H.Z.get($.kWorkspacesButtonShowName)||"left"===e||"right"===e)}return H.Z.get($.kWorkspacesButtonShowName)};getIcon=e=>e?.emoji??e?.icon??Ts.BmN;togglePopup=()=>{this.setState((e=>({popupVisible:!e.popupVisible})))};hidePopup=()=>this.setState({popupVisible:!1});focusPopup=()=>{this.refPopup.current?.focus()};getContextMenu=()=>[{handler:()=>Ne.Z.set($.kWorkspacesButtonShowName,!H.Z.get($.kWorkspacesButtonShowName)),type:"checkbox",checked:H.Z.get($.kWorkspacesButtonShowName),isEnabled:()=>{if(this.props.inTabbar){const e=H.Z.get($.kTabsBarPosition);return"top"===e||"bottom"===e}return!0},...(0,xs.Z)("Display Workspace Name")},{handler:()=>Ne.Z.set($.kWorkspacesButtonShowInTabbar,!H.Z.get($.kWorkspacesButtonShowInTabbar)),type:"checkbox",checked:H.Z.get($.kWorkspacesButtonShowInTabbar),...(0,xs.Z)("Show Workspaces in Tab Bar")}];render(){if(!this.props.prefValues[$.kWorkspacesEnabled]&&!this.props.inEditor&&!this.props.preview)return null;const{showName:e,workspaceName:t=(0,Oe.Z)("Workspaces"),pageIdPlayingAudio:n}=this.state;let s="";this.props.inEditor?s=(0,Oe.Z)("Workspaces"):e&&(s=t);const i=s||(0,Oe.Z)("Workspaces"),o=Math.min(i.length,16);return pne(Fa,{image:this.props.inEditor?Ts.BmN:this.state.imageSrc,imageOverride:this.props.inEditor||!this.state.activeWorkspaceId?"WorkspaceButton":"none",tooltip:i,onClick:this.togglePopup,onPointerDown:this.togglePopup,customizeMenu:this.props.customizeMenu,menuOrigin:this.props.menuOrigin,popupPosition:this.props.popupPosition,className:As()("workspace-popup",{"tabbar-workspace-button":this.props.inTabbar,label:H.Z.get($.kWorkspacesButtonShowName)&&this.state.activeWorkspaceId}),popupClassName:"ToolbarButtonPopup-DefaultStyles",popupWidth:250,hidePopup:this.hidePopup,isPopupVisible:this.state.popupVisible,size:this.props.size,draggable:this.props.draggable||!1,onDragStart:this.props.onDragStart??Aa.Z,onDragEnd:this.props.onDragEnd??Aa.Z,onDrop:this.props.onDrop??Aa.Z,onDragEnter:this.props.onDragEnter??Aa.Z,onDragLeave:this.props.onDragLeave??Aa.Z,onDragOver:this.props.onDragOver??Aa.Z,mimeType:this.props.mimeType,name:s?void 0:"WorkspaceButton",title:this.props.maxWidth&&this.props.maxWidth<80?void 0:s,isMenuIndicatorVisible:!this.props.maxWidth||this.props.maxWidth>=60,isMenuIndicatorDisabled:!0,menu:this.getContextMenu,style:this.props.maxWidth?{width:this.props.maxWidth}:{"--titleChars":o+"ex"},mediaState:void 0!==n,mediaStateType:"workspace",onFocus:this.focusPopup},void 0,(0,fs.jsx)(cne,{ref:this.refPopup,windowId:this.context.vivaldiWindowId,activeWorkspaceId:this.state.activeWorkspaceId,workspaces:this.state.workspaces,hidePopup:this.hidePopup}))}}const mne=sa(ta(gne),une);class vne extends hs.Component{render(){const{index:e,name:t,preview:n,label:s="",customizeMenu:i=[],popupPosition:o="below",menuOrigin:a="bottomLeft",mimeType:r,onDragStart:l,onDragEnd:d,onDrop:c,onDragEnter:h,draggable:p,inEditor:u=!1,forceIcon:g=!1}=this.props,m={name:t,label:s,customizeMenu:i,size:"large",popupPosition:o,menuOrigin:a,draggable:p,onDragStart:l,onDragEnd:d,onDrop:c,onDragEnter:h,mimeType:r,preview:n};if(t.startsWith("COMMAND_"))return(0,fs.jsx)(Nte,{...m,commandButton:!0,index:e,inEditor:u});if(Vp.Z.isWebPanel(t))return(0,hs.createElement)(Zw,{...m,key:t,inEditor:u});switch(t){case"Back":case"Forward":case"Rewind":case"FastForward":case"Reload":case"Stop":case"Home":return(0,fs.jsx)(ly,{...m,inEditor:u});case"BreakMode":return(0,fs.jsx)(Su,{...m,inEditor:u});case"Clock":return(0,fs.jsx)(Xg,{...m,inEditor:u});case"AccountButton":return(0,fs.jsx)(Jp,{...m});case"ReadingList":return(0,fs.jsx)(Ww,{...m,inEditor:u});case"Extensions":return(0,fs.jsx)(Ma,{...m,inEditor:u});case"UpdateButton":return(0,fs.jsx)(Ate,{...m,inEditor:u});case"MailStatus":return(0,fs.jsx)(Mf,{...m,inEditor:u});case"CalendarStatus":return(0,fs.jsx)(wg,{...m,inEditor:u});case"DownloadButton":return(0,fs.jsx)(Pv,{...m,inEditor:u});case"WorkspaceButton":return(0,fs.jsx)(mne,{...m,inEditor:u});case"AddressField":case"SearchField":case"PanelToggle":case"SyncStatus":case"StatusInfo":case"VersionInfo":case"CaptureImages":case"TilingToggle":case"ImagesToggle":case"PageActions":case"Zoom":case"Settings":case"Proxy":return(0,fs.jsx)(vte,{...m,inEditor:u,forceIcon:g});case"MailBack":case"MailForward":case"MailReload":case"MailRenderingMethod":case"MailViewLayout":case"MailViewThreading":return(0,fs.jsx)(ef,{...m,disabled:!1});case"MailSearch":return(0,fs.jsx)(Xv,{...m,inEditor:u});case"MailMsgEdit":case"MailMsgReply":case"MailMsgReplyToAll":case"MailMsgForward":case"MailMsgStatusRead":case"MailMsgStatusUnread":case"MailMsgFlag":case"MailMsgLabel":case"MailMsgSend":case"MailMsgShowHeaders":case"MailMsgSpam":case"MailMsgSpamRestore":case"MailMsgDiscard":case"MailMsgAttach":case"MailMsgTrash":case"MailMsgTrashRestore":case"MailMsgMove":case"MailMsgArchive":case"MailMsgArchiveRestore":case"MailCompose":return(0,fs.jsx)(ey,{...m,inEditor:u});case"PanelBookmarks":case"PanelReadingList":case"PanelDownloads":case"PanelHistory":case"PanelNotes":case"PanelWindow":case"PanelTranslate":case"PanelMail":case"PanelCalendar":case"PanelTasks":case"PanelFeeds":case"PanelContacts":case"PanelChat":case"PanelSession":case"PanelWeb":return(0,hs.createElement)(Zw,{...m,key:t,inEditor:u});case"Game":return(0,fs.jsx)(Rv,{...m,isStartPage:!1});case"Spacer":case"FlexibleSpacer":case"Divider":return(0,fs.jsx)(Nte,{...m,index:e});default:return console.warn(`ToolbarButton “${t}” not found`),null}}}class fne extends hs.PureComponent{static contextType=xi.Z;lastKeyWasAltDown=!1;componentDidMount(){const{selectWindow:e}=this.context;C.Z.tabsPrivate.onMouseChanged.addListener(this._onMouseChanged),C.Z.tabsPrivate.onKeyboardChanged.addListener(this._keyEventListener),C.Z.windowPrivate.onPositionChanged.addListener(this._onWindowPositionChanged),tl.Z.addListener("COMMAND_FOCUS_MAINMENU",this._onCommandSpy),G.ZP.addListener(this._onWindowStoreChanged,e)}componentWillUnmount(){C.Z.tabsPrivate.onMouseChanged.removeListener(this._onMouseChanged),C.Z.tabsPrivate.onKeyboardChanged.removeListener(this._keyEventListener),C.Z.windowPrivate.onPositionChanged.removeListener(this._onWindowPositionChanged),tl.Z.removeListener("COMMAND_FOCUS_MAINMENU",this._onCommandSpy),G.ZP.removeListener(this._onWindowStoreChanged)}_onCommandSpy=e=>{e===this.context.vivaldiWindowId&&G.ZP.isActive(this.context.vivaldiWindowId)&&this.props.changeFocus()};_onWindowStoreChanged=()=>{!G.ZP.isActive(this.context.vivaldiWindowId)&&this.props.showAccessKeys&&this.props.showAccessKeys(!1)};_onMouseChanged=e=>{!1===e&&(this.lastKeyWasAltDown=!1)};_onWindowPositionChanged=()=>{this.lastKeyWasAltDown=!1};_keyEventListener=(e,t,n,s,i,o)=>{if(s===oa.Z.KEY_ALT&&!o&&this.context.vivaldiWindowId===e&&G.ZP.isActive(e)){const e=t?4===n:0===n;e&&this.props.showAccessKeys&&this.props.showAccessKeys(t),!t&&!i&&this.lastKeyWasAltDown&&H.Z.get($.kKeyboardShortcutsAltOpensMenu)&&this.props.changeFocus(),this.lastKeyWasAltDown=e&&t}else this.lastKeyWasAltDown=!1};render(){return null}}const yne=fne;let Cne=0;const wne=new Map;let bne=!1;const Sne=function(e,t,n,s){return t.filter((t=>!t.isVisible||t.isVisible(e,!1))).map((t=>{const i=ae.Z.getDisplayName(t),o=Cne++;t.handler&&(i||t.url)&&wne.set(o,t.handler);const a={};if(t.container?.details)a.container=t.container.details;else if(ae.Z.isSeparator(t))a.separator={};else{const r=void 0!==t.id&&""!==n&&t.id===n;let l;switch((t.iconPNG||t.iconPNGWhite)&&(l=[t.iconPNG||"",t.iconPNGWhite||""]),t.type){case"checkbox":case"radio":a.item={id:o,name:i,type:t.type,radiogroup:t.radiogroup?t.radiogroup:-1,checked:t.checked,enabled:!t.isEnabled||t.isEnabled(e),shortcut:ae.Z.getShortcut(t,s),url:t.url,icons:l};break;default:a.item={id:o,name:i,type:t.items?"folder":"command",selected:r,persistent:t.persistent,enabled:!t.isEnabled||t.isEnabled(e),shortcut:ae.Z.getShortcut(t,s),url:t.url,icons:l},t.items&&(a.children=Sne(e,t.items,n,s))}}return a}))},Ine={show:function(e,t,n,s,i){Cne=0,wne.clear();const o=e.vivaldiWindowId,a=ae.Z.getShortcutSettings(),r=function(e){i&&i(e)},l=function(){i&&i(-1)},d=function(t){const n=wne.get(t.id);if(n){const s={origin:"menu",context:e,windowId:o,keyState:{shiftKey:t.state.shift,ctrlKey:t.state.ctrl,altKey:t.state.alt,metaKey:t.state.command,key:""}};t.state.left?s.button=0:t.state.right?s.button=2:t.state.center&&(s.button=1),n(s)}},c=function(e){console.warn(e)};!function(){if(!bne){bne=!0;const e=n.map((e=>(ae.Z.installMnemonics(e.menu.items,e.menu.preferred),{id:e.id,rect:e.rect,children:Sne(o,e.menu.items,e.menu.expandId,a)})));(function(e){return C.Z.zoom.getVivaldiUIZoom().then((t=>{e.forEach((e=>{e.rect.x=parseInt((e.rect.x+1)*t),e.rect.y=parseInt((e.rect.y+0)*t),e.rect.width=parseInt(e.rect.width*t),e.rect.height=parseInt(e.rect.height*t)}))}))})(e).then((()=>{C.Z.menubarMenu.onAction.addListener(d),C.Z.menubarMenu.onOpenBookmark.addListener(Lr.Z.onOpen),C.Z.menubarMenu.onBookmarkAction.addListener(Lr.Z.onAction),C.Z.menubarMenu.onHover.addListener(Lr.Z.onHover),C.Z.menubarMenu.onOpen.addListener(r),C.Z.menubarMenu.onClose.addListener(l),C.Z.menubarMenu.onError.addListener(c),C.Z.menubarMenu.show({windowId:o,id:t,siblings:e,icons:[re.Z,Fr.Z,Vr.Z,Wr.Z,Ur.Z,Rr.Z,Br.Z]},(()=>{Lr.Z.onHover(o,""),C.Z.menubarMenu.onAction.removeListener(d),C.Z.menubarMenu.onOpenBookmark.removeListener(Lr.Z.onOpen),C.Z.menubarMenu.onBookmarkAction.removeListener(Lr.Z.onAction),C.Z.menubarMenu.onHover.removeListener(Lr.Z.onHover),C.Z.menubarMenu.onOpen.removeListener(r),C.Z.menubarMenu.onClose.removeListener(l),C.Z.menubarMenu.onError.removeListener(c),setTimeout((()=>{bne=!1}),1)}))}))}}()}};var kne;function Ane(e,t,n,s){kne||(kne="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:kne,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Tne=[$.kKeyboardShortcutsAltOpensMenu,$.kMenuIconType],Zne="vivaldi";class Ene extends hs.PureComponent{static contextType=xi.Z;refButton=hs.createRef();shortcuts=[];hasMenu=!1;componentDidMount(){H.Z.addListener($.kKeyboardShortcutsAltOpensMenu,this._onPrefsChange),J.Z.addListener(this._onCommandStoreChange),this.hasMenu=J.Z.isNamedMenuAvailable(Zne),this.hasMenu?this._setupShortcuts(!0):this._requestMenu()}componentWillUnmount(){H.Z.removeListener($.kKeyboardShortcutsAltOpensMenu,this._onPrefsChange),J.Z.removeListener(this._onCommandStoreChange),this.shortcuts.forEach((e=>{e.shortcut&&Di.Z.unbind(e.shortcut,this._showSubMenu)}))}_onPrefsChange=()=>{this._setupShortcuts(!1)};_onCommandStoreChange=e=>{switch(e){case"init":this._requestMenu();break;case"menu":this.hasMenu=!0,this._setupShortcuts(!1);break;case"shortcut":this._setupShortcuts(!1)}};_changeFocus=()=>{this._showMenu(-1)};_requestMenu(){this.hasMenu||v.Z.requestNamedMenu(Zne)}_getMenuItems=e=>J.Z.getNamedMenu(this.context.vivaldiWindowId,Zne,e);_setupShortcuts=e=>{this.shortcuts.forEach((e=>{e.shortcut&&Di.Z.unbind(e.shortcut,this._showSubMenu)})),this.shortcuts=[],this.props.prefValues[$.kKeyboardShortcutsAltOpensMenu]?(this.shortcuts=ae.Z.getShortcutsForSubMenus(this._getMenuItems(!1)),this.shortcuts.forEach((e=>{e.shortcut&&Di.Z.bind(e.shortcut,this._showSubMenu)}))):e&&this._getMenuItems(!1)};_showMenu=e=>{const t=this.refButton.current?.getBoundingClientRect();if(!t)return;const n=this._getMenuItems(!0),s=e<0?"":n[e].id||"",i={id:0,rect:{x:parseInt(t.left),y:parseInt(t.top),width:parseInt(t.width),height:parseInt(t.height)},menu:{items:n,expandId:s,preferred:this.shortcuts}};Ine.show(this.context,i.id,[i],"bottom")};_showSubMenu=e=>{this.shortcuts.forEach((t=>{t.shortcut&&t.key===e.keyState.key&&this._showMenu(t.index)}))};_handleDoubleClick=e=>{e.preventDefault(),e.stopPropagation()};_handleKeyDown=e=>{switch(e.key){case"ArrowDown":case"Enter":this._showMenu(-1);break;case"Escape":v.Z.executeActions("shortcut",this.context,"COMMAND_FOCUS_WEBVIEW");break;default:return}(0,to.ZP)(e)};render(){return Ane(hs.Fragment,{},void 0,Ane(yne,{changeFocus:this._changeFocus}),(0,fs.jsxs)("button",{ref:this.refButton,className:"vivaldi",style:{boxShadow:"none",display:this.props.isHidden?"none":void 0},onMouseDown:()=>this._showMenu(-1),onKeyDown:this._handleKeyDown,onDoubleClick:this._handleDoubleClick,tabIndex:this.props.keyAccess,title:(0,Oe.Z)("Menu"),children:["icon"===this.props.prefValues[$.kMenuIconType]&&(0,fs.jsxs)(fs.Fragment,{children:[Ane("span",{className:"vivaldi-v",dangerouslySetInnerHTML:{__html:n(3783)}}),Ane("span",{className:"expand-arrow",dangerouslySetInnerHTML:{__html:n(39135)}})]}),"burger"===this.props.prefValues[$.kMenuIconType]&&Ane("span",{className:"burger-icon",dangerouslySetInnerHTML:{__html:n(37609)}})]}))}}const _ne=sa(Ene,Tne);var Mne;function Nne(e,t,n,s){Mne||(Mne="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Mne,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Pne="vivaldi/x-toolbar-name",Dne="vivaldi/x-button-index";let xne=!1;var One,Lne=Nne(Bp,{onMainBar:!0});class Rne extends hs.PureComponent{static contextType=xi.Z;_dropOnSelf=!1;_dragIndex=null;constructor(e,t){super(e),this.state={modifier:!1,editMode:""!==wa.getState(),isMailWindow:G.ZP.isMail(t.vivaldiWindowId),buttons:e.showDefaultSet?(0,bd.Gt)(t.vivaldiWindowId,!0,H.Z.getDefault(e.name)):(0,bd.Gt)(t.vivaldiWindowId,!1,H.Z.get(e.name)),dragging:!1}}componentDidMount(){this.props.showDefaultSet||(H.Z.addListener(this.props.name,this.onPrefsChanged),wa.addListener(this.editModeListener),G.ZP.addListener(this.onWindowStoreChanged),C.Z.tabsPrivate.onKeyboardChanged.addListener(this.modifierKeyListener))}componentWillUnmount(){this.props.showDefaultSet||(H.Z.removeListener(this.props.name,this.onPrefsChanged),wa.removeListener(this.editModeListener),G.ZP.removeListener(this.onWindowStoreChanged),C.Z.tabsPrivate.onKeyboardChanged.removeListener(this.modifierKeyListener))}onWindowStoreChanged=()=>{this.state.modifier&&this.setState({modifier:!1});const e=G.ZP.isMail(this.context.vivaldiWindowId);e!==this.state.isMailWindow&&this.setState({isMailWindow:e,buttons:(0,bd.Gt)(this.context.vivaldiWindowId,!1,H.Z.get(this.props.name))})};modifierKeyListener=(e,t,n,s)=>{this.context.vivaldiWindowId===e&&s===oa.Z.KEY_CONTROL&&this.setState({modifier:t})};editModeListener=()=>{this.setState({editMode:""!==wa.getState()})};onPrefsChanged=(e,t)=>{this.setState({buttons:(0,bd.Gt)(this.context.vivaldiWindowId,Boolean(this.props.showDefaultSet),t)})};editToolbar=e=>Wp.Z.edit(e);reset=()=>{const e=this.props.name;(0,bd.Np)(this.context.vivaldiWindowId,e),Ne.Z.reset(e)};removeButton=e=>{const t=this.props.name,n=this.state.buttons,s=n[e];Pn.Z.setRemovedButton(this.context.vivaldiWindowId,t,s),Ne.Z.set(t,n.filter(((t,n)=>e!==n))),Vp.Z.isWebPanel(s)&&Fl.Z.removeById(s,t)};onDragEnter=e=>this._dragIndex=e;onDragOver=e=>e.preventDefault();onDrop=(e,t,n)=>{this.setState({dragging:!1,modifier:!1});const s=e.dataTransfer.getData(xa);if(!s)return;e.stopPropagation(),xne=!0;let i=this.state.buttons.slice();const o=("vertical"===this.props.layout?"bottom"===n:"right"===t)?1:0,a=e.currentTarget.classList.contains("toolbar-droptarget")?i.length:(this._dragIndex||0)+o,r=parseInt(e.dataTransfer.getData(Dne));if(this._dropOnSelf=this.props.name===e.dataTransfer.getData(Pne),this._dropOnSelf)i[r]=null,i.splice(a,0,s),this.props.name&&Ne.Z.set(this.props.name,i.filter((e=>e)));else{i.splice(a,0,s),bd.aX.includes(s)||(i=i.filter(((e,t)=>e!==s||t===a)));const e=this.props.name;Ne.Z.set(e,i),Pn.Z.setAddedButton(this.context.vivaldiWindowId,e,s,!1)}};getButtonMenu=e=>G.ZP.isGuest()?[]:[ae.Z.separatorItem,{items:[{handler:this.removeButton.bind(this,e),...(0,xs.Z)("Remove from Toolbar")},ae.Z.separatorItem,{handler:()=>this.editToolbar(this.props.name||$.kToolbarsNavigation),...(0,xs.Z)("Customize Toolbar")},{handler:this.reset,...(0,xs.Z)("Reset Toolbar to Default")}],...(0,xs.Z)("command","Edit")}];getToolbarMenu=async e=>{if(e.target.classList?.contains("toolbar")){let t=[];if(this.props.menu){const e=this.props.menu();t=Array.isArray(e)?e:await e}(0,Qi.Z)(this.context,t.concat([ae.Z.separatorItem,{handler:()=>this.editToolbar(this.props.name||$.kToolbarsNavigation),...(0,xs.Z)("Customize Toolbar")},{handler:this.reset,...(0,xs.Z)("Reset Toolbar to Default")}]))(e)}};render(){const e=(this.props.name===$.kToolbarsNavigation||this.props.name===$.kToolbarsMail||this.props.name===$.kToolbarsMailComposer||this.props.name===$.kToolbarsMailMessage)&&this.props.controlButtonsVisible,t=this.props.menuDisplay;return Nne("div",{className:As()("toolbar","toolbar-droptarget",this.props.className,"toolbar-"+this.props.size,{dragging:this.state.dragging,"toolbar-vertical":"vertical"===this.props.layout}),onContextMenu:this.getToolbarMenu,onDragOver:this.onDragOver,onDrop:this.onDrop},void 0,e&&Lne,t&&Nne(_ne,{isHidden:!1,keyAccess:this.props.keyAccess??0}),this.state.buttons.map(((e,t)=>Nne(vne,{index:t,name:e,preview:this.props.showDefaultSet||this.state.editMode,menuOrigin:this.props.menuOrigin,customizeMenu:this.getButtonMenu(t),popupPosition:this.props.popupPosition,size:this.props.size,draggable:this.state.editMode||this.state.modifier,inEditor:this.props.showDefaultSet,onDragStart:e=>{xne=!1,this._dropOnSelf=!1,e.dataTransfer.setData(Dne,t),e.dataTransfer.setData(Pne,this.props.name),this.setState({dragging:!0})},onDragEnd:e=>{!this._dropOnSelf&&xne&&this.removeButton(t),this._dropOnSelf=!1,this._dragIndex=null,this.setState({dragging:!1,modifier:!1})},onDrop:this.onDrop,onDragEnter:()=>{this.onDragEnter(t)},mimeType:xa},e+"__"+(bd.aX.includes(e)?t:"")))),this.props.name===$.kToolbarsNavigation&&G.ZP.isIncognito(this.context.vivaldiWindowId)&&Nne("div",{className:"UrlBar-PrivateWindowIndicator",title:(0,Oe.Z)("Private Browsing Window"),dangerouslySetInnerHTML:{__html:n(2018)+(0,Oe.Z)("Private")}}))}}function Bne(e,t,n,s){One||(One="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:One,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Fne=[$.kToolbarsMail,$.kToolbarsMailComposer,$.kToolbarsMailMessage],Vne="toolbar-mainbar toolbar-mailbar";class Wne extends hs.PureComponent{render(){const{className:e,menuDisplay:t,menuOrigin:n,popupPosition:s,url:i}=this.props;return(0,fs.jsxs)(fs.Fragment,{children:[!(0,Gv.vE)(i)&&!(0,Gv.Ds)(i)&&Bne(Rne,{name:$.kToolbarsMail,className:`${Vne} ${e}`,controlButtonsVisible:this.props.controlButtonsVisible,menuDisplay:t,menuOrigin:n,popupPosition:s,size:"large"}),(0,Gv.Ds)(i)&&Bne(Rne,{name:$.kToolbarsMailMessage,className:`${Vne} ${e} message`,controlButtonsVisible:this.props.controlButtonsVisible,menuDisplay:t,menuOrigin:n,popupPosition:s,size:"large"}),(0,Gv.vE)(i)&&Bne(Rne,{name:$.kToolbarsMailComposer,className:`${Vne} ${e} composer`,controlButtonsVisible:this.props.controlButtonsVisible,menuDisplay:t,menuOrigin:n,popupPosition:s,size:"large"})]})}}const Une=sa(Wne,Fne);function Hne(){const e=H.Z.get($.kAppearanceDisableTitleBar),t=H.Z.get($.kTabsVisible),n="top"===H.Z.get($.kTabsBarPosition),s=H.Z.get($.kAddressBarVisible),i="top"===H.Z.get($.kAddressBarPosition),o="top"===H.Z.get($.kMenuDisplay);return!(e&&s&&i&&(!t||!n)&&!o)}var zne;function Gne(e,t,n,s){zne||(zne="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:zne,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const $ne=[$.kAddressBarPosition,$.kAddressBarVisible,$.kAppearanceDisableTitleBar,$.kKeyboardTabToAll,$.kMenuDisplay,$.kTabsBarPosition,$.kTabsVisible],Kne="toolbar-hidden",jne="toolbar-visible";function Yne(e){return{url:e.url,isMailPage:e.isMailPage&&!H.Z.get($.kMailIsTurnedOff)}}class Xne extends hs.PureComponent{static contextType=xi.Z;state={...Yne(ie.ZP.unsafeGetActivePage(this.context.vivaldiWindowId))};componentDidMount(){const{selectWindow:e}=this.context;ie.ZP.addListener(this.pageStoreChanged,e)}componentWillUnmount(){ie.ZP.removeListener(this.pageStoreChanged)}pageStoreChanged=()=>{const e=ie.ZP.getActivePage(this.context.vivaldiWindowId);e&&this.setState(Yne(e))};controlButtonsVisible=()=>{const e=Hne();return!(e&&this.props.fullScreenState||this.props.native)&&!e};render(){const e="top"===this.props.prefValues[$.kAddressBarPosition],t=e?"bottomLeft":"topLeft",n=e?"below":"above",s="vivaldi"===this.props.prefValues[$.kMenuDisplay]&&!Hne(),i=this.props.prefValues[$.kKeyboardTabToAll],o=this.controlButtonsVisible(),{isMailPage:a}=this.state;return Gne(da.Z,{focusName:"focus_mainbar",className:"mainbar"},void 0,a&&Gne(Une,{url:this.state.url,controlButtonsVisible:o,menuOrigin:t,popupPosition:n,className:a?jne:Kne,menuDisplay:s}),Gne(Rne,{name:$.kToolbarsNavigation,className:"toolbar-mainbar "+(a?Kne:jne),controlButtonsVisible:o,menuOrigin:t,menuDisplay:s,keyAccess:i,popupPosition:n,size:"large"}))}}const Qne=sa(Xne,$ne);var qne;function Jne(e,t,n,s){qne||(qne="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:qne,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class ese extends hs.PureComponent{constructor(e){super(e),this.state={folderName:""}}addMailFolder=()=>{Ie.Z.createMailbox(this.props.options.accountId,this.state.folderName),this.props.onClose()};onDismiss=()=>{this.props.onClose()};onChange=e=>{const{value:t}=e.target;this.setState({folderName:t})};render=()=>Jne("div",{className:"dialog-add-folder-name"},void 0,Jne("header",{className:"dialog-header"},void 0,Jne("h1",{},void 0,(0,Oe.Z)("Create Folder for $1",[this.props.options.accountId]))),Jne("div",{className:"dialog-content"},void 0,Jne("input",{type:"text",placeholder:(0,Oe.Z)("mail","New Folder"),onChange:this.onChange,title:(0,Oe.Z)("Folder Name"),value:this.state.folderName,name:"folderName"})),Jne("footer",{className:"dialog-footer"},void 0,Jne("input",{type:"button",value:(0,Oe.Z)("Create Folder"),className:"primary",onClick:this.addMailFolder,disabled:!this.state.folderName}),this.props.dismissable&&Jne("input",{type:"button",onClick:this.onDismiss,value:(0,Oe.Z)("Cancel")})))}const tse=ese;var nse,sse;function ise(e,t,n,s){nse||(nse="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:nse,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function ose(e){const[t,n]=hs.useState(!1);return hs.useEffect((()=>()=>{Ne.Z.set($.kCalendarOnboardingShown,!0)}),[]),ise("div",{className:"CalendarAccountSheet"},void 0,ise("button",{className:"CalendarAccountSheet-Exit",onClick:e.onClose},void 0,ise("span",{dangerouslySetInnerHTML:{__html:Ts.vyJ}})),!t&&ise("div",{className:"setting-section"},void 0,ise(PD,{searchableStrings:JD,filter:"",showTips:()=>n(!0),done:e.onClose,onboarding:!0})),t&&ise(zD,{onClose:e.onClose,windowId:e.windowId,onboarding:!0}))}function ase(e,t,n,s){sse||(sse="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:sse,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const{mixedToStrings:rse}=Mh;function lse(e){e&&e.target.addEventListener("click",to.ZP,{once:!0})}const dse=function(e){const t=hs.useContext(xi.Z),[n,s]=(0,hs.useState)(""),{document:i,requestAnimationFrame:o,HTMLElement:a}=t,{stateHandler:r,eventDraft:l}=Z5(jL.W$,{draft:e.event}),d=hs.useRef(!1),{cancelEventEdit:c,endEventEdit:h,saveEventEdit:p}=r;if(hs.useEffect((()=>()=>{d.current||h()}),[h]),!l)return null;function u(){o((()=>{const e=i.getElementsByClassName("calendar-grid")[0];e instanceof a&&e.focus()}))}async function g(n){d.current=!0,lse(n);try{const n=await p();n&&(e.onClose().then(u),function(e,t){const n=ie.ZP.getActivePage(e);if(n&&je.jk.getDisplayUrlFromMapping(n?.url).startsWith("vivaldi://calendar"))return;let s="";const i=t.start||t.end;if(i){const e=N()(i);s=t.allDay?e.format("L"):N()().isSame(i,"day")?e.format("LT"):`${e.format("L")} ${e.format("LT")}`}(0,Ke.c)({title:`${s} ${t.title}`,body:t.task?(0,Oe.Z)("New Task Created"):(0,Oe.Z)("New Event Created"),onClick:()=>{Ae.Z.showCalendar(e,t.id)},timeout:3e4,tag:"CALENDAR_CREATE_EVENT"})}(t.vivaldiWindowId,n))}catch(e){et.Z.warn("Calendar",["Event not created"],e),s(e)}}function v(t){d.current=!0,lse(t),c(),e.onClose().then(u)}return ase(nx.Provider,{value:{displayDensity:"full",pageId:jL.W$,isPanel:!1,handler:r}},void 0,ase("div",{className:"dialog-add-event",onKeyDown:function(e){const t=HT.Z[e.keyCode];"Enter"!==t||e.shiftKey?"Escape"===t&&v():(e.preventDefault(),e.stopPropagation(),g())}},void 0,ase("div",{className:"dialog-content"},void 0,ase(pR,{event:l}),n&&ase(tc,{type:"info"},void 0,rse([n]))),ase("footer",{className:"dialog-footer"},void 0,ase("input",{type:"button",className:"primary",value:l.id?(0,Oe.Z)("calendar","Done"):l.task?(0,Oe.Z)("Add Task"):(0,Oe.Z)("Add Event"),onClick:g}),ase("input",{type:"button",value:(0,Oe.Z)("Cancel"),onClick:v}),!!l.id&&ase("input",{type:"button",value:(0,Oe.Z)("verb","Delete"),onClick:function(t){d.current=!0,lse(t),m.Z.trashEvent(l.id),e.onClose().then(u)}}))))};var cse,hse;function pse(e,t,n,s){cse||(cse="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:cse,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function use(e){const{onClose:t}=e,[n,s]=(0,hs.useState)(""),i=(0,hs.useRef)(Aa.Z);const o=(0,hs.useCallback)((e=>{i.current=e}),[]),a=!!e.templateId,r=a?(0,Oe.Z)("Edit Event Template"):(0,Oe.Z)("Add an Event Template"),l=a?(0,Oe.Z)("Save Template"):(0,Oe.Z)("Create Template");return pse("div",{className:"dialog-add-template"},void 0,pse("div",{className:"dialog-header"},void 0,pse("h1",{className:"dialog-title"},void 0,r)),pse("form",{className:"dialog-content"},void 0,pse(fR,{templateId:e.templateId,event:e.event,name:e.name,properties:e.properties,setSaveTemplate:o},void 0,n&&pse(tc,{type:"error"},void 0,n))),pse("footer",{className:"dialog-footer"},void 0,pse("input",{type:"button",className:"primary",value:l,onClick:async function(e){s("");try{i.current(),t()}catch(e){s(e.message)}}}),pse("input",{type:"button",value:(0,Oe.Z)("Cancel"),onClick:t})))}function gse(e,t,n,s){hse||(hse="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:hse,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const mse=function(e){const{filePath:t}=e,[n,s]=(0,hs.useState)({state:"info",message:"",eventCount:0}),[i,o]=(0,hs.useState)(t.startsWith("webcal")),a=(0,hs.useMemo)((()=>{const e=t.replace(/^\w+:\/\//,"");return Bd.Z.getAccounts().some((t=>"ical"===t.account_type&&t.url.replace(/^\w+:\/\//,"")===e))}),[t]),[r,l]=(0,hs.useState)(!1),d=xT(Wc),c=(0,hs.useCallback)(((e,t,n)=>{s({message:e,eventCount:t,state:n?"error":"info"})}),[]);function h(){Fd.Z.clearImportProgress("Calendar","OpenIcsFileDialog"),e.onClose()}let p=0,u=0,g=0;d.Calendar&&Object.keys(d.Calendar).forEach((e=>{p+=d.Calendar[e].current,u=d.Calendar[e].total,g=Math.round(p/u*100)})),u>0&&p===u&&(h(),Ae.Z.showCalendar(e.windowId));const m=i?(0,Oe.Z)("Import Calendar"):(0,Oe.Z)("Import Calendar Events");return gse(da.Z,{className:"dialog-import-events",focusName:"import-events",onKeyDown:function(e){const t=HT.Z[e.keyCode];"Enter"!==t||e.shiftKey?"Escape"===t&&h():(e.preventDefault(),e.stopPropagation(),l(!0))},forceTrap:!0},void 0,gse("header",{className:"dialog-header"},void 0,gse("h1",{className:"dialog-title"},void 0,m)),gse("div",{className:"dialog-content"},void 0,i&&gse(rc,{showBody:!0,subscribe:r,onStatus:c,url:t}),!i&&gse($d,{standAlone:!0,file:t,import:r,onStatus:c}),gse("div",{},void 0,p>0&&gse(tc,{type:"info"},void 0,(0,Oe.Z)("Imported $1 of $2 ($3%)",[p,u,g])),0===p&&n.message&&gse(tc,{type:n.state},void 0,n.message),a&&!r&&gse(tc,{type:"warning"},void 0,(0,Oe.Z)("You are already subscribed to this calendar")))),gse("footer",{className:"dialog-footer"},void 0,i&&(0,fs.jsxs)(fs.Fragment,{children:[gse("input",{type:"button",disabled:!n.eventCount||r,className:"primary",onClick:()=>l(!0),value:(0,Oe.Z)("Subscribe")}),gse("input",{type:"button",onClick:()=>o(!1),disabled:!n.eventCount,value:n.eventCount?(0,Oe.Z)("Import $1 event","Import $1 events",[n.eventCount]):(0,Oe.Z)("Import")})]}),!i&&(0,fs.jsx)(fs.Fragment,{children:gse("input",{type:"button",disabled:!n.eventCount||r,className:"primary",onClick:()=>l(!0),value:(0,Oe.Z)("Import")})}),gse("input",{type:"button",value:(0,Oe.Z)("Close"),onClick:h})))};var vse;function fse(e,t,n,s){vse||(vse="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:vse,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const yse=function(e){const t=hs.useContext(xi.Z),{modal:n,resolve:s=(e=>{})}=e;function i(i){const{document:o,HTMLInputElement:a,HTMLTextAreaElement:r}=t,l=n.checks?.reduce(((e,{name:t})=>{const n=o.querySelector(`input[name="${t}"]`);return n instanceof a&&(e[t]=Boolean(n.checked)),e}),{}),d=n.inputs?.reduce(((e,{name:t})=>{const n=o.querySelector(`textarea[name="${t}"]`);return n instanceof r&&(e[t]=n.value),e}),{});s({action:i,checks:l,inputs:d}),e.onClose()}const o=n.actions.find((e=>e.default))??n.cancelAction;return fse(_r.Z,{viewMode:"calendar-dialog slide",onRequestClose:()=>s({action:n.cancelAction.action})},void 0,fse("form",{onSubmit:()=>i(o.action),onKeyDown:function(e){if("Escape"===HT.Z[e.keyCode])i(n.cancelAction.action),(0,to.ZP)(e)}},void 0,fse("header",{className:"dialog-header"},void 0,fse("h1",{className:"dialog-title"},void 0,n.title)),fse("div",{className:"dialog-content"},void 0,n.body,n.inputs&&fse("div",{className:"dialog-inputs"},void 0,n.inputs.map(((e,t)=>fse(hs.Fragment,{},t,fse("label",{htmlFor:e.name},void 0,e.label),fse("textarea",{name:e.name}))))),n.checks&&fse("div",{className:"dialog-inputs"},void 0,n.checks.map(((e,t)=>fse("label",{},t,fse("input",{type:"checkbox",name:e.name}),fse("span",{},void 0,e.label)))))),fse("footer",{className:"dialog-footer"},void 0,n.actions.concat([n.cancelAction]).map((e=>{const t=o.action===e.action;return fse("input",{autoFocus:t,onClick:()=>{i(e.action)},type:t?"submit":"button",value:e.title},e.title)})))))};var Cse=n(33499),wse=n(17673);var bse;function Sse(e,t,n,s){bse||(bse="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:bse,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ise=function(e){const t=hs.useRef(),n=hs.useRef({effects:null,isCaptured:!1,canvasReady:!1,imageData:""}).current,[s,i]=hs.useState(!1),o=hs.useContext(xi.Z),a=o.innerWidth,r=o.innerHeight,l=o.vivaldiWindowId,{children:d,effect:c,showDialog:h}=e,p=hs.useCallback((e=>{switch(e){case"showDialog":h();break;case"done":0===hs.Children.count(d)&&h(),i(!0)}}),[d,h]);function u(){n.isCaptured&&n.canvasReady&&("melt"===c?n.effects=function(e,t,n,s,i,o){const{document:a,requestAnimationFrame:r,cancelAnimationFrame:l,Image:d}=e,c=200,h=.04,p=1e3,u=Math.round(s/c),g=s/u,m=Math.round(i*h),v=4*m;let f="initial";const y=[];let C,w=0;const b=a.createElement("canvas");b.width=s,b.height=i;const S=b.getContext("2d"),I=new d(s,i);return I.onload=()=>S.drawImage(I,0,0,s,i),I.src=n,{effect:function e(n){if(!t.current)return;if(0===y.length){for(let e=0;e<g;e++)y[e]=0===e?-Math.floor(Math.random()*v):y[e-1]+(Math.floor(Math.random()*m)-m/2),y[e]>0?y[e]=0:y[e]<-v&&(y[e]=-v);w=n}if(w===n)return void(C=r(e));const a=t.current.getContext("2d");let l=!0,d=0,c=i;const h=i*(n-w)/p;w=n,a.clearRect(0,0,s,i);for(let e=0;e<g;e++)y[e]+=h,y[e]<0?(l=!1,d=0):y[e]<i?(l=!1,d=y[e]):d=i,c=Math.min(d,c),a.drawImage(b,e*u,0,u,i,e*u,d,u,i);"showDialog"!==f&&c>i/2&&!l&&(f="showDialog",o(f)),l?o("done"):C=r(e)},cleanUp:function(){C&&l(C)}}}(o,t,n.imageData,a,r,p):"burn"===c&&(n.effects=function(e,t,n,s,i,o){const{document:a,requestAnimationFrame:r,cancelAnimationFrame:l}=e,d=320,c=82,h=2,p=4.25,u=1600,g=1600;let m;const v=a.createElement("canvas");v.width=d,v.height=c;const f=v.getContext("2d"),y=f.getImageData(0,0,d,c),C=y.data,w=[];for(let e=0;e<256;e++)w[e]=B().hsl(Math.round(e/3),1,Math.min(1,e/192)).rgb();const b=[...Array(c).keys()].map((e=>Array(d)));for(let e=0;e<c;++e)for(let t=0;t<d;++t)b[e][t]=0;let S,I=h,k=p,A=0,T="initial";return{effect:function e(n){const a=t.current;if(!a)return;if(S=S||n,A===n)return void(m=r(e));const l=n-A;A=n;for(let e=0;e<d;e++)b[c-1][e]=Math.random()>.5?255:0;let p=0;for(let e=0;e<c-1;++e)for(let t=0;t<d;++t){let n=b[(e+1)%c][(t-1+d)%d]+b[(e+1)%c][t]+b[(e+1)%c][(t+1)%d]+b[(e+2)%c][t];n/=k,b[e][t]=Math.floor(n)}for(let e=0;e<c;++e)for(let t=0;t<d;++t){let n=e*d*4+4*t;p=b[e][t];const[s,i,o]=w[p],a=Math.min(255,2*(s+i+o));C[n]=s,C[++n]=i,C[++n]=o,C[++n]=a}f.putImageData(y,0,0);const Z=a.getContext("2d");Z.clearRect(0,0,s,i),Z.drawImage(v,0,0,d,c-I,0,0,s,i);const E=n-S;if(E>u){"showDialog"!==T&&(T="showDialog",o(T));const e=E-u;k+=l/g*3,I=Math.round(h+10*e/g)}E>u+g?o("done"):m=r(e)},cleanUp:function(){m&&l(m)}}}(o,t,n.imageData,a,r,p)),n.isCaptured=!0,n.effects?.effect?o.requestAnimationFrame(n.effects.effect):(console.warn("Failed to get notification effect"),i(!0),h()))}if(!n.isCaptured){const e={windowId:l,posX:0,posY:0,width:a,height:r,saveToDisk:!1};C.Z.thumbnails.captureUI(e,((e,t)=>{e?(n.isCaptured=!0,n.imageData=t,u()):(et.Z.warn("Calendar","Failed to capture UI for wipe effect"),n.isCaptured=!0,i(!0),h())}))}return hs.useEffect((()=>()=>{n.effects?.cleanUp}),[n.effects]),(0,fs.jsxs)(fs.Fragment,{children:[n.isCaptured&&hs.Children.count(e.children)&&Sse("div",{className:"wipe-container",onClick:e.showDialog},void 0,e.children),!s&&(0,fs.jsx)("canvas",{width:a,height:r,ref:e=>{e&&!t.current&&(t.current=e,n.canvasReady=!0,u())}})]})};var kse;function Ase(e,t,n,s){kse||(kse="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:kse,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Tse=[[1,(0,Oe.Z)("$1 minute","$1 minutes",[1]),"1 minute"],[2,(0,Oe.Z)("$1 minute","$1 minutes",[2]),"2 minutes"],[5,(0,Oe.Z)("$1 minute","$1 minutes",[5]),"5 minutes"],[10,(0,Oe.Z)("$1 minute","$1 minutes",[10]),"10 minutes"],[15,(0,Oe.Z)("$1 minute","$1 minutes",[15]),"15 minutes"],[20,(0,Oe.Z)("$1 minute","$1 minutes",[20]),"20 minutes"],[30,(0,Oe.Z)("$1 minute","$1 minutes",[30]),"30 minutes"],[45,(0,Oe.Z)("$1 minute","$1 minutes",[45]),"45 minutes"],[60,(0,Oe.Z)("$1 hour","$1 hours",[1]),"1 hour"],[120,(0,Oe.Z)("$1 hour","$1 hours",[2]),"2 hours"],[240,(0,Oe.Z)("$1 hour","$1 hours",[4]),"4 hours"],[360,(0,Oe.Z)("$1 hour","$1 hours",[6]),"6 hours"],[720,(0,Oe.Z)("$1 hour","$1 hours",[12]),"12 hours"],[1440,(0,Oe.Z)("$1 day","$1 days",[1]),"1 day"],[2880,(0,Oe.Z)("$1 day","$1 days",[2]),"2 days"],[4320,(0,Oe.Z)("$1 day","$1 days",[3]),"3 days"],[5760,(0,Oe.Z)("$1 day","$1 days",[4]),"4 days"],[7200,(0,Oe.Z)("$1 day","$1 days",[5]),"5 days"],[8640,(0,Oe.Z)("$1 day","$1 days",[6]),"6 days"],[10080,(0,Oe.Z)("$1 week","$1 weeks",[1]),"1 week"]],Zse=Tse.map((([e,t])=>Ase("option",{value:e.toString()},e,t)));function Ese(e){const[t,n]=hs.useState("5"),s=hs.useRef(!1);hs.useEffect((()=>(s.current=!0,()=>{s.current=!1})),[]);const{notification:i}=e,o=N()(i.eventTime),a=(0,Cse.y6)(o,i.allDay);return(0,fs.jsxs)(fs.Fragment,{children:[Ase("div",{className:"CalendarNotification-Content"},void 0,Ase("span",{className:"CalendarNotification-Time"},void 0,o.format(a)),Ase("span",{className:"CalendarNotification-Text"},void 0,i.title)),Ase("footer",{className:"dialog-footer CalendarNotifications-Footer"},void 0,Ase("input",{className:"CalendarNotification-Button primary",type:"button",autoFocus:!0,value:(0,Oe.Z)("Dismiss"),onClick:()=>e.onClose(e.notification.id)}),Ase("span",{},void 0,(0,Oe.Z)("or")),Ase("input",{className:"CalendarNotification-Button",type:"button",value:(0,Oe.Z)("Snooze"),onClick:()=>{const n=parseInt(t);Cse.ZP.snooze(e.notification,n||5),e.onClose(e.notification.id)}}),Ase("select",{onChange:e=>{n(e.target.value)},defaultValue:"5"},void 0,Zse))]})}var _se=Ase("div",{className:"CalendarNotification-HoverBackground"});function Mse(e){const t=N()(e.notification.eventTime),n=(0,Cse.y6)(t,e.notification.allDay);return Ase("div",{className:"CalendarNotification-Content"},void 0,Ase("span",{className:"CalendarNotification-Time"},void 0,t.format(n)),Ase("span",{className:"CalendarNotification-Text"},void 0,e.notification.title),Ase("div",{className:"CalendarNotification-Actions"},void 0,Ase(Fa,{title:(0,Oe.Z)("Snooze"),tabIndex:0,isMenuIndicatorVisible:!0,menu:()=>Tse.map((([t,n,s])=>({handler:()=>{return n=t,Cse.ZP.snooze(e.notification,n),void e.onClose(e.notification.id);var n},label:n,labelEnglish:s}))),menuOrigin:"bottomRight"}),Ase(Fa,{onClick:()=>{e.onClose(e.notification.id)},title:(0,Oe.Z)("Dismiss"),tabIndex:0}),_se))}function Nse(e){const t=e.notifications;hs.useEffect((()=>()=>{"number"==typeof e.windowToRestore&&G.ZP.isFullscreen(e.windowToRestore)&&cs.Z.toggleFullscreen(e.windowToRestore)}),[e.windowToRestore]);const[n,s]=hs.useState(1===t.length);return hs.useEffect((()=>{n&&t.length>1&&s(!1)}),[n,t.length]),Ase(da.Z,{focusName:"focus_notfications",forceTrap:!0},void 0,Ase("div",{className:As()("CalendarNotifications",{"CalendarNotifications--FadeUp":"up"===e.fade,"CalendarNotifications--FadeDown":"down"===e.fade})},void 0,Ase("header",{className:"dialog-header CalendarNotifications-Header"},void 0,Ase("span",{dangerouslySetInnerHTML:{__html:Ts.l0O.medium}}),Ase("span",{className:"CalendarNotifications-Title"},void 0,t.length>1?(0,Oe.Z)("Reminders"):(0,Oe.Z)("Reminder"))),!n&&(0,fs.jsxs)(fs.Fragment,{children:[Ase("div",{className:"CalendarNotifications-List"},void 0,t.map((t=>Ase(Mse,{notification:t,onClose:e.onClose},t.id)))),Ase("footer",{className:"dialog-footer CalendarNotifications-Footer"},void 0,Ase("input",{autoFocus:!0,className:"CalendarNotifications-Button primary",type:"button",value:(0,Oe.Z)("Dismiss All"),onClick:function(){e.notifications.forEach((t=>e.onClose(t.id)))}}))]}),n&&t[0]&&Ase(Ese,{notification:t[0],onClose:e.onClose})))}const Pse=function(e){const t=H.Z.get($.kCalendarNotificationType),[n,s]=hs.useState(!("melt"===t||"burn"===t)),[i,o]=hs.useState(wse.Z.getState().activeNotifications),a=e.onClose,r=0!==i.length;hs.useEffect((()=>{function e(){const e=wse.Z.getState().activeNotifications;0===e.length?r&&a():o(e)}return wse.Z.addListener(e),()=>wse.Z.removeListener(e)}),[a,r]);const l=hs.useCallback((()=>{s(!0)}),[]);hs.useEffect((()=>{let e;return"melt"!==t&&"burn"!==t||(e=setTimeout(l,8e3)),()=>{e&&clearTimeout(e)}}),[t,l]);const d={notifications:i,onClose:function(e){y.Z.dispatch({actionType:"MAIN_HIDE_CALENDAR_ALARM",notificationId:e})},fade:"melt"===t?"down":"up",windowToRestore:e.windowToRestore};return(0,fs.jsxs)(fs.Fragment,{children:[("melt"===t||"burn"===t)&&Ase(Ise,{effect:t,showDialog:l},void 0,n&&(0,fs.jsx)(Nse,{...d})),"dialog"===t&&(0,fs.jsx)(Nse,{...d})]})};var Dse;function xse(e,t,n,s){Dse||(Dse="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Dse,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ose=function(e){return xse(SA,{danger:!0,title:(0,Oe.Z)("title","Delete Filter"),prompt:[(0,Oe.Z)("The filter '$1' will be removed",[e.label])],negative:(0,Oe.Z)("Cancel"),positive:(0,Oe.Z)("command","Delete Filter"),onRequestClose:()=>{e.handleClose(e.dialog)},onClose:t=>{e.callback(t),e.handleClose(e.dialog)}},e.dialog)};var Lse;function Rse(e,t,n,s){Lse||(Lse="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Lse,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Bse=function(e){return Rse(SA,{danger:!0,title:(0,Oe.Z)("title","Delete Label"),prompt:[(0,Oe.Z)("The '$1' label will be removed from all messages",[e.label])],negative:(0,Oe.Z)("Cancel"),positive:(0,Oe.Z)("command","Delete Label"),onRequestClose:()=>{e.handleClose(e.dialog)},onClose:t=>{e.callback(t),e.handleClose(e.dialog)}},e.dialog)};var Fse;function Vse(e,t,n,s){Fse||(Fse="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Fse,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Wse=function(e){return Vse(SA,{title:(0,Oe.Z)("title","Upload messages to server?"),prompt:[(0,Oe.Z)("Do you want to upload imported messages to server for $1",[e.accountId])],negative:(0,Oe.Z)("No, keep them internal"),positive:(0,Oe.Z)("Yes, upload to server"),onRequestClose:()=>{e.handleClose(e.dialog)},onClose:t=>{e.callback(t),e.handleClose(e.dialog)}},e.dialog)};var Use;function Hse(e,t,n,s){Use||(Use="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Use,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const zse=function(e){return Hse(SA,{danger:!0,title:(0,Oe.Z)("Trigger Mail Action"),prompt:[(0,Oe.Z)("This saved filter ($1) has an action which will be applied to all its messages. Would you like to proceed?",[e.label])],negative:(0,Oe.Z)("Cancel"),positive:(0,Oe.Z)("Apply Action to Mails"),onRequestClose:()=>{e.callback(!1),e.handleClose(e.dialog)},onClose:t=>{e.callback(t),e.handleClose(e.dialog)}},e.dialog)};var Gse;function $se(e,t,n,s){Gse||(Gse="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Gse,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Kse(e){const t=Rd.Z.getDefaultAccountId();let n=e.find((e=>e.id===t));return!n&&e.length&&(n=e[0]),n}const jse=function(e){const t=Bd.Z.getAccounts().filter((e=>"ical"!==e.account_type)),[n,s]=(0,hs.useState)(""),[i,o]=(0,hs.useState)({vevent:!0,vtodo:"local"===Kse(t)?.account_type,vjournal:!1}),[a,r]=(0,hs.useState)(Rd.Z.getCalendarCreateColor()),[l,d]=(0,hs.useState)(""),[c,h]=(0,hs.useState)(!1),[p,u]=(0,hs.useState)(Kse(t)?.id||"");function g(e){d(e)}return $se("div",{className:"dialog-add-calendar"},void 0,$se("div",{className:"dialog-header"},void 0,$se("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("Add a New Calendar"))),0===t.length?(0,fs.jsxs)(fs.Fragment,{children:[$se("div",{className:"dialog-content"},void 0,(0,Oe.Z)("You have no suitable calendar account set up. Add one in Settings.")),$se("footer",{className:"dialog-footer"},void 0,$se("input",{type:"button",className:"primary",value:(0,Oe.Z)("Open Calendar Settings"),onClick:function(t){Ae.Z.showSettings(e.windowId,"calendar"),e.onClose()}}),$se("input",{type:"button",value:(0,Oe.Z)("Cancel"),onClick:e.onClose}))]}):$se("form",{onSubmit:async function(){if(""===p)return void g((0,Oe.Z)("No suitable calendar account found."));h(!0);const s=t.find((e=>e.id===p)),o={name:n,accountId:p,description:n,color:a,supportedCalendarComponent:i},{result:r}=await m.Z.createCalendar(o,s,!0);r.status?e.onClose():g(r.message)}},void 0,$se("div",{className:"dialog-content"},void 0,t.length>1&&$se("label",{className:"floating-label"},void 0,$se("span",{},void 0,(0,Oe.Z)("Account")),$se("select",{onChange:function(e){u(e.target.value)},value:p},void 0,t.map((e=>$se("option",{value:e.id},e.id,e.name))))),$se(sc.Z,{type:"text",onChange:function(e){s(e.target.value)},label:(0,Oe.Z)("Calendar Name"),value:n,autoFocus:!0}),$se(eB,{label:(0,Oe.Z)("Calendar color","Color"),colorKey:"color",colorValue:a,setColor:function(e,t,n=!1){r(e.hex())},predefinedColors:$D.h}),$se(rB,{supportedCalendarComponent:i,updateCalendarComponent:function(e){o(e)},disabled:!1}),l&&$se(tc,{type:"warning"},void 0,l)),$se("footer",{className:"dialog-footer"},void 0,$se("input",{type:"submit",value:(0,Oe.Z)("Add Calendar"),disabled:!Rd.Z.isCalendarValidToCreate({accountId:p,description:n,supportedCalendarComponent:i,name:""})||c}),$se("input",{type:"button",value:(0,Oe.Z)("Cancel"),onClick:e.onClose}))))};var Yse;function Xse(e,t,n,s){Yse||(Yse="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Yse,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Qse extends hs.PureComponent{constructor(e){super(e)}deleteMailFolder=()=>{const{accountId:e,path:t}=this.props.options;try{Ie.Z.deleteMailbox(e,t)}catch(n){et.Z.error("Mail",`Failed to remove folder ${(0,mc.kF)(t)} from ${e}`)}this.props.onClose()};onDismiss=()=>{this.props.onClose()};render=()=>Xse("div",{className:"dialog-delete-folder-name"},void 0,Xse("header",{className:"dialog-header"},void 0,Xse("h1",{},void 0,(0,Oe.Z)("Delete Folder $1 from $2",[(0,mc.kF)(this.props.options.path),this.props.options.accountId])),Xse("h2",{},void 0,(0,Oe.Z)("Note that all messages in that folder will also be deleted."))),Xse("footer",{className:"dialog-footer"},void 0,Xse("input",{type:"button",value:(0,Oe.Z)("Delete Folder"),className:"primary",onClick:this.deleteMailFolder}),this.props.dismissable&&Xse("input",{type:"button",onClick:this.onDismiss,value:(0,Oe.Z)("Cancel")})))}const qse=Qse;var Jse,eie,tie,nie;function sie(e,t,n,s){Jse||(Jse="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Jse,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class iie extends hs.Component{static contextType=xi.Z;context;state={saveDays:H.Z.get($.kSessionsSaveDays)};_onEnable=()=>{Ne.Z.set($.kSessionsSaveOnExit,"on"),Ne.Z.set($.kSessionsSaveDays,this.state.saveDays),this.props.onClose()};_onCancel=()=>{this.props.onClose()};_onSaveDaysChange=e=>{const{HTMLSelectElement:t}=this.context;e.target instanceof t&&this.setState({saveDays:parseInt(e.target.value)})};_renderSaveDays=()=>[1,3,5,30].map((e=>sie("option",{value:e},e,1===e?(0,Oe.Z)("Last day"):(0,Oe.Z)("$1 day","Last $1 days",[e]))));render(){const e="init"===this.props.options.mode?(0,Oe.Z)("title","Enable"):(0,Oe.Z)("Save");return sie(_r.Z,{onRequestClose:this._onCancel},void 0,sie("header",{className:"dialog-header"},void 0,sie("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("title","Automatic Session Backup"))),sie("form",{onSubmit:this._onEnable},void 0,sie("div",{className:"dialog-content"},void 0,sie("p",{},void 0,(0,Oe.Z)("Sessions back up on an hourly basis. Select how many days worth of backups to keep.")),sie("select",{value:this.state.saveDays,onChange:this._onSaveDaysChange},void 0,this._renderSaveDays()),"size"===this.props.options.mode&&(0,fs.jsx)(fs.Fragment,{children:sie("p",{},void 0,(0,Oe.Z)("Any excess sessions are moved to Trash."))})),sie("footer",{className:"dialog-footer"},void 0,sie("input",{type:"button",onClick:this._onCancel,value:(0,Oe.Z)("Cancel")}),sie("input",{type:"submit",onClick:this._onEnable,value:e}))))}}function oie(e,t,n,s){eie||(eie="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:eie,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class aie extends hs.Component{static contextType=xi.Z;state={enableWorkspaces:!0};_onWithWorkspaces=()=>{this.setState({enableWorkspaces:!0})};_onNoWorkspaces=()=>{this.setState({enableWorkspaces:!1})};_onCancel=()=>{this.props.onClose()};_onOpen=()=>{Ne.Z.set($.kWorkspacesEnabled,this.state.enableWorkspaces),this.props.onClose(),this.props.options.onClose(!this.state.enableWorkspaces)};render(){return oie(_r.Z,{onRequestClose:this._onCancel},void 0,oie("header",{className:"dialog-header"},void 0,oie("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("Enable Workspaces?"))),oie("form",{onSubmit:this._onOpen},void 0,oie("div",{className:"dialog-content"},void 0,oie("p",{},void 0,(0,Oe.Z)("Session contains tabs inside Workspaces")),oie("label",{className:"dialog-checkbox"},void 0,oie("input",{type:"radio",checked:this.state.enableWorkspaces,onChange:this._onWithWorkspaces}),oie("span",{},void 0,(0,Oe.Z)("Enable Workspaces and Open"))),oie("label",{className:"dialog-checkbox"},void 0,oie("input",{type:"radio",checked:!this.state.enableWorkspaces,onChange:this._onNoWorkspaces}),oie("span",{},void 0,(0,Oe.Z)("Open as Tabs")))),oie("footer",{className:"dialog-footer"},void 0,oie("input",{type:"button",onClick:this._onOpen,value:(0,Oe.Z)("Open"),autoFocus:!0}),oie("input",{type:"button",onClick:this._onCancel,value:(0,Oe.Z)("Cancel")}))))}}function rie(e,t,n,s){tie||(tie="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:tie,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class lie extends hs.Component{static contextType=xi.Z;state={workspaceAsTabs:!1};_onWithWorkspaces=()=>{this.setState({workspaceAsTabs:!1})};_onNoWorkspaces=()=>{this.setState({workspaceAsTabs:!0})};_onCancel=()=>{this.props.onClose()};_onOpen=()=>{this.props.onClose(),this.props.options.onClose(this.state.workspaceAsTabs)};render(){return rie(_r.Z,{onRequestClose:this._onCancel},void 0,rie("header",{className:"dialog-header"},void 0,rie("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("Open Session with Workspaces?"))),rie("form",{onSubmit:this._onWithWorkspaces},void 0,rie("div",{className:"dialog-content"},void 0,rie("p",{},void 0,(0,Oe.Z)("New Workspaces will be added next to existing")),rie("label",{className:"dialog-checkbox"},void 0,rie("input",{type:"radio",checked:!this.state.workspaceAsTabs,onChange:this._onWithWorkspaces}),rie("span",{},void 0,(0,Oe.Z)("Open with Workspaces"))),rie("label",{className:"dialog-checkbox"},void 0,rie("input",{type:"radio",checked:this.state.workspaceAsTabs,onChange:this._onNoWorkspaces}),rie("span",{},void 0,(0,Oe.Z)("Open as Tabs")))),rie("footer",{className:"dialog-footer"},void 0,rie("input",{type:"button",onClick:this._onOpen,value:(0,Oe.Z)("Open"),autoFocus:!0}),rie("input",{type:"button",onClick:this._onCancel,value:(0,Oe.Z)("Cancel")}))))}}function die(e,t,n,s){nie||(nie="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:nie,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class cie extends hs.PureComponent{_isMounted=!1;constructor(e){super(e),this.state={accounts:[],currentAccount:void 0,setupStep:"setup"}}componentDidMount(){this._isMounted=!0,this.loadAccountsAndCapabilities()}componentDidUpdate(e){if(e.prefValues[$.kMailAccounts]!==this.props.prefValues[$.kMailAccounts]){const e=!0;this.loadAccountsAndCapabilities(e)}}loadAccountsAndCapabilities=async e=>{const t=await fn.Z.loadAllAccounts();let n=this.state.currentAccount;if(t.length<this.state.accounts.length)n=void 0,this.setState({accounts:t,currentAccount:n});else{let s;e&&t.length>this.state.accounts.length&&(n=t.find((e=>!this.state.accounts.some((t=>t.MAIL_EMAIL===e.MAIL_EMAIL)))),s="signature"),this._isMounted&&(s?this.setState({accounts:t,setupStep:s,currentAccount:n}):this.setState({accounts:t,currentAccount:n}))}};showTips=()=>{this.setState({setupStep:"tips"})};onCreateItem=()=>{this.setState({setupStep:"setup"})};render(){return"tips"===this.state.setupStep?die("div",{className:"MailAccountSheet vivaldi-settings"},void 0,die("button",{className:"MailAccountSheet-exit",onClick:this.props.onClose},void 0,die("span",{dangerouslySetInnerHTML:{__html:Ts.vyJ}})),die(iH,{onClose:this.props.onClose,onCreateItem:this.onCreateItem})):die("div",{className:"MailAccountSheet vivaldi-settings"},void 0,die("button",{className:"MailAccountSheet-exit",onClick:this.props.onClose},void 0,die("span",{dangerouslySetInnerHTML:{__html:Ts.vyJ}})),die("div",{className:"setting-section"},void 0,"setup"===this.state.setupStep&&die(DU,{onClose:this.props.onClose,focusInput:!0,emptyAccounts:0===this.state.accounts.length,searchableStrings:MU},"create"),"signature"===this.state.setupStep&&this.state.currentAccount&&die(CH,{accountSettings:this.state.currentAccount,searchableStrings:vH,showTips:"signature"===this.state.setupStep?()=>this.showTips():void 0})))}}const hie=sa(cie,[$.kMailAccounts]);var pie,uie;function gie(e,t,n,s){pie||(pie="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:pie,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function mie(e){const[t,n]=hs.useState(e.options.account.MAIL_USER||""),[s,i]=hs.useState(e.options.account.MAIL_PASSWORD||""),[o,a]=hs.useState(!1);return gie("form",{onSubmit:function(n){n.preventDefault();const i={...e.options.account,MAIL_USER:t,MAIL_PASSWORD:s};(0,Yc.ZP)(i,e.options.account),Ie.Z.connectIMAPClient(i),e.onClose()}},void 0,gie("header",{className:"dialog-double-header"},void 0,gie("div",{className:"header-icon",dangerouslySetInnerHTML:{__html:Ts.Si$.large}}),gie("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("Authentication Error")),gie("p",{className:"info full-width"},void 0,(0,Oe.Z)("Enter credentials for $1",[e.options.account.MAIL_EMAIL]))),gie("div",{className:"dialog-content"},void 0,gie("h4",{},void 0,(0,Oe.Z)("IMAP Username")),gie("div",{className:"toolbar toolbar-default"},void 0,gie("input",{type:"text",placeholder:"user@vivaldi.net",value:t,onChange:function(e){n(e.target.value)}})),gie("h4",{},void 0,(0,Oe.Z)("IMAP Password")),gie("div",{className:"toolbar toolbar-default"},void 0,gie("input",{autoFocus:!0,type:o?"text":"password",placeholder:(0,Oe.Z)("My long safe password"),value:s,onChange:function(e){i(e.target.value)}}),gie(Fa,{tooltip:(0,Oe.Z)("tooltip","Show password"),image:Ts.sgm.medium,isPressed:o,onClick:function(){a(!o)}}))),gie("footer",{className:"dialog-footer"},void 0,gie("input",{type:"submit",value:(0,Oe.Z)("mail","Save"),autoFocus:!0}),gie("input",{type:"button",onClick:e.onClose,value:(0,Oe.Z)("Cancel")})))}function vie(e,t,n,s){uie||(uie="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:uie,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function fie(e,t){return vie("h1",{},void 0,t?(0,Oe.Z)("Permanently Delete $1 Message","Permanently Delete $1 Messages",[e]):(0,Oe.Z)("Delete $1 Message","Delete $1 Messages",[e]))}var yie=vie("input",{type:"radio",value:"selected",autoFocus:!0}),Cie=vie("input",{type:"radio",value:"folders"}),wie=vie("input",{type:"radio",value:"accounts"});const bie=function(e){const{options:t,onClose:n}=e,{entries:s,deletePermanently:i}=t,[o,a]=hs.useState((()=>{const e=new Map;return s.forEach((t=>{t.sources.forEach(((t,n)=>{if(!t.deleted){const t=tf.Z.get(n);e.set(t.accountId,!0)}}))})),e}));return vie("form",{onSubmit:function(t){t.preventDefault(),Pf.Z.delete(e.windowId,s,i,{accountIds:o}),n()}},void 0,vie("header",{className:"dialog-header"},void 0,fie(s.length,i),vie("p",{},void 0,(0,Oe.Z)("From which folders would you like to delete the message?","From which folders would you like to delete the messages?",[s.length]))),vie("div",{className:"dialog-content label-list"},void 0,[...o.entries()].map(((e,t)=>{const[n,s]=e;return vie("label",{},n,vie("input",{type:"checkbox",autoFocus:0===t,checked:s,onChange:()=>{o.set(n,!s),a(new Map([...o.entries()]))}}),vie("span",{},void 0,n))}))),vie("footer",{className:"dialog-footer"},void 0,vie("input",{type:"submit",className:"danger",value:(0,Oe.Z)("mail","Delete")}),vie("input",{type:"button",onClick:n,value:(0,Oe.Z)("Cancel"),autoFocus:!0})))},Sie=function(e){const{options:t,onClose:n}=e,{entries:s,deletePermanently:i}=t,o=new Set;s.forEach((e=>{e.sources.forEach(((e,t)=>{e.deleted||o.add(t)}))}));const a=tf.Z.getByIds([...o]);return vie("form",{onSubmit:function(t){t.preventDefault(),Pf.Z.delete(e.windowId,s,i,{setting:"accounts"}),n()}},void 0,vie("header",{className:"dialog-header"},void 0,fie(s.length,i),vie("p",{},void 0,(0,Oe.Z)("Are you sure you want to purge the message from the following folders?","Are you sure you want to purge your deleted messages from the following folders?",[s.length]))),vie("div",{className:"dialog-content label-list"},void 0,vie("ul",{},void 0,a.map((e=>{const{id:t,accountId:n,path:s}=e,i=mn.Z.getFolderName(n,s);return vie("li",{},t,vie("span",{},void 0,n),vie("span",{className:"folder-path"},void 0,i))})))),vie("footer",{className:"dialog-footer"},void 0,vie("input",{type:"submit",className:"danger",value:(0,Oe.Z)("mail","Delete")}),vie("input",{type:"button",onClick:n,value:(0,Oe.Z)("Cancel"),autoFocus:!0})))},Iie=function(e){const{options:t,onClose:n}=e,{entries:s,deletePermanently:i}=t,[o,a]=hs.useState((()=>{const e=new Map;return s.forEach((t=>{t.sources.forEach(((t,n)=>{t.deleted||e.set(n,!0)}))})),e})),r=tf.Z.getByIds([...o.keys()]);return vie("form",{onSubmit:function(t){t.preventDefault(),Pf.Z.delete(e.windowId,s,i,{sourceFilterIds:o}),n()}},void 0,vie("header",{className:"dialog-header"},void 0,fie(s.length,i),vie("p",{},void 0,(0,Oe.Z)("From which folders would you like to delete the message?","From which folders would you like to delete the messages?",[s.length]))),vie("div",{className:"dialog-content label-list"},void 0,r.map(((e,t)=>{const{id:n,accountId:s,path:i}=e,r=mn.Z.getFolderName(s,i),l=o.get(n);return vie("label",{},n,vie("input",{type:"checkbox",autoFocus:0===t,checked:l,onChange:()=>{o.set(n,!l),a(new Map([...o.entries()]))}}),vie("span",{},void 0,s," ",r))}))),vie("footer",{className:"dialog-footer"},void 0,vie("input",{type:"submit",className:"danger",value:(0,Oe.Z)("mail","Delete")}),vie("input",{type:"button",onClick:n,value:(0,Oe.Z)("Cancel"),autoFocus:!0})))},kie=function(e){const{options:t,onClose:n}=e,{entries:s,deletePermanently:i}=t;let o="folders",a=!1;return vie("form",{onSubmit:function(t){if(t.preventDefault(),Pf.Z.delete(e.windowId,s,i,{setting:o}),a){const e=i?$.kMailDeleteInOtherLocations:$.kMailMarkDeleteInOtherLocations;Ne.Z.set(e,o)}n()}},void 0,vie("header",{className:"dialog-header"},void 0,fie(s.length,i)),vie(vl,{className:"dialog-content label-list",name:"mail_delete_dialog_setting",value:o,onChange:e=>{o=e.target.value}},void 0,i&&vie("label",{},void 0,yie,vie("span",{},void 0,(0,Oe.Z)("From the Current Folder Only"))),vie("label",{},void 0,Cie,vie("span",{},void 0,(0,Oe.Z)("From All Folders on Current Account"))),vie("label",{},void 0,wie,vie("span",{},void 0,(0,Oe.Z)("From All Accounts and Folders")))),vie("footer",{className:"dialog-footer label-list"},void 0,vie("label",{},void 0,vie("input",{type:"checkbox",value:a,onChange:e=>a=e.target.value}),vie("span",{},void 0,(0,Oe.Z)("Don’t Ask Again"))),vie("input",{type:"submit",className:"danger",value:(0,Oe.Z)("mail","Delete")}),vie("input",{type:"button",onClick:n,value:(0,Oe.Z)("Cancel"),autoFocus:!0})))};var Aie,Tie;function Zie(e,t,n,s){Aie||(Aie="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Aie,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Eie(e){const t=(0,hs.useContext)(xi.Z),[n,s]=(0,hs.useState)(!1),{folder:i}=e.options,{accountId:o,path:a}=i,r=mn.Z.getFolderName(o,a);return Zie("form",{onSubmit:function(s){s.preventDefault(),l.Z.unsubscribeMailbox(t.vivaldiWindowId,i,n),e.onClose()}},void 0,Zie("header",{className:"dialog-double-header"},void 0,Zie("div",{className:"header-icon",dangerouslySetInnerHTML:{__html:Ts.Si$.large}}),Zie("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("Unsubscribe from IMAP folder $1",[r]))),Zie("div",{className:"dialog-content"},void 0,Zie("div",{className:"toolbar toolbar-default"},void 0,Zie("input",{autoFocus:!0,type:"checkbox",checked:n,onChange:function(){s(!n)}}),Zie("span",{},void 0,(0,Oe.Z)("Remove messages from this device"))),Zie("p",{className:"info"},void 0,(0,Oe.Z)("If checked, all message files for $1 on $2 will be deleted. Otherwise they will remain on disk.",[r,o]))),Zie("footer",{className:"dialog-footer"},void 0,Zie("input",{type:"submit",className:"danger",value:(0,Oe.Z)("mail","Unsubscribe"),autoFocus:!0}),Zie("input",{type:"button",onClick:e.onClose,value:(0,Oe.Z)("Cancel")})))}function _ie(e,t,n,s){Tie||(Tie="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Tie,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Mie extends hs.PureComponent{static contextType=xi.Z;refTreeList=hs.createRef();notes=W3.ZP.getRootNode().children.filter((e=>"trash"!==e.type));state={selectedId:void 0,filter:"",filteredNotes:this.notes};handleConfirm=()=>{this.state.selectedId&&(this.props.onSelected(this.state.selectedId),this.props.onClose())};handleSelected=e=>{e?.id&&this.setState({selectedId:e.id})};handleDoubleClick=(e,t)=>{t.id&&(this.props.onSelected(t.id),this.props.onClose())};hasChildren=e=>"note"!==e.type&&!!e.children&&e.children.length>0;handleExpandClick=(e,t)=>{const n=e.altKey;this.refTreeList.current?.toggleSelectedExpansion(t,n)};handleFilterChange=({currentTarget:e})=>{const t=e.value;if(0===t.length)return void this.setState({filteredNotes:this.notes,filter:""});let n=t.toLowerCase();const s={};n.startsWith("url:")?(n=n.substring(4),s.url=n.length>0,s.content=!1):n.startsWith("content:")&&(n=n.substring(8),s.url=!1,s.content=n.length>0),"."===n&&(s.url=!1);const{collapsed:i,nodes:o}=W3.ZP.getFilteredTree(n,s);this.setState({filteredNotes:o,filter:t},(()=>{this.refTreeList.current?.expandAllExcept(i)}))};renderTitleRow=e=>{const t=e.node,n=e.level,s=(n+1)*mo+"px",i=n*mo+"px",o=W3.ZP.isFolder(t);return _ie("label",{},t.id,o&&this.hasChildren(t)&&_ie("span",{className:"expand-icon",style:{marginLeft:i},onMouseDown:to.ZP,onMouseUp:e=>this.handleExpandClick(e,t.id),dangerouslySetInnerHTML:{__html:Ts.nfH}}),o&&_ie(Ps,{trash:!1,open:e.isExpanded,leftMargin:this.hasChildren(t)?0:s}),!o&&!t.url&&_ie("span",{style:{marginLeft:s},className:"tree-icon",dangerouslySetInnerHTML:{__html:Ts.zKr}}),!o&&!!t.url&&_ie("span",{style:{marginLeft:s},className:"tree-icon",dangerouslySetInnerHTML:{__html:Ts.NwZ}}),void 0!==e.inlineEditText&&_ie("input",{type:"text",value:e.inlineEditText,onChange:e.onChange,onFocus:e.onFocus,onBlur:e.onBlur,autoFocus:!0}),void 0===e.inlineEditText&&_ie("span",{className:"title",title:E6(t)},void 0,E6(t)),e.showBadge&&this.hasChildren(t)&&_ie("span",{className:"item-count"},void 0,t.children?.length))};rowComponent=e=>{const t=e.node,n=e.level,s=W3.ZP.isSeparator(t),i=(n+1)*mo+"px",o=[];return s?o.push(_ie("label",{"data-parent":t.parentId},`${t.id}__separator__${o.length}`,_ie("hr",{style:{marginLeft:i},className:"separator"}))):o.push(this.renderTitleRow(e)),o};render(){const{props:e}=this,t=W3.ZP.getRootNode().id;return _ie("div",{className:e.className,style:e.style},void 0,_ie("header",{className:"dialog-header"},void 0,_ie("h1",{},void 0,(0,Oe.Z)("notes","Choose a note to append your selected text"))),_ie("div",{className:"dialog-content"},void 0,_ie("input",{className:"notes-filter",type:"search",placeholder:(0,Oe.Z)("verb","Filter"),value:this.state.filter,onChange:this.handleFilterChange,autoFocus:!0,tabIndex:"0"}),(0,fs.jsx)(yo,{ref:this.refTreeList,rowComponent:this.rowComponent,nodes:this.state.filteredNotes,rootId:t,onSelect:this.handleSelected,onItemDoubleClick:this.handleDoubleClick,supportsInlineEdit:!1,isSeparator:W3.ZP.isSeparator,hasChildren:this.hasChildren,isFolder:W3.ZP.isFolder})),_ie("footer",{className:"dialog-footer"},void 0,_ie("input",{type:"button",value:(0,Oe.Z)("Add to Note"),className:"primary",disabled:!this.state.selectedId,onClick:this.handleConfirm}),_ie("input",{type:"button",value:(0,Oe.Z)("Cancel"),onClick:this.props.onClose})))}}const Nie=Mie;var Pie;function Die(e,t,n,s){Pie||(Pie="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Pie,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const xie="shift+alt+";class Oie extends hs.PureComponent{static contextType=xi.Z;state={accessKeys:[],shown:!1,page:null};componentDidMount(){const e=ie.ZP.getActivePage(this.context.vivaldiWindowId);e&&C.Z.accessKeys.getAccessKeysForPage(e.id,(t=>{this.setState({accessKeys:t,shown:!0,page:e},(()=>this.bindKeystrokes()))}))}componentWillUnmount(){this.unbindKeystrokes()}bindKeystrokes=()=>{const{accessKeys:e}=this.state;e.forEach((e=>{Di.Z.bind(e.access_key,this.pressKey),Di.Z.bind(xie+e.access_key,this.pressKey)}))};unbindKeystrokes=()=>{const{accessKeys:e}=this.state;e.forEach((e=>{Di.Z.unbind(e.access_key,this.pressKey),Di.Z.unbind(xie+e.access_key,this.pressKey)}))};onClose=()=>{this.state.shown&&(this.setState({shown:!1}),this.props.onClose())};getLink=e=>{const t=(0,ms.Z)(this.state.page?.url??"");if(t){if(e.startsWith("#")&&t.href)return t.href.split("#")[0]+e;if(e.startsWith("/")&&t.protocol&&t.host)return t.protocol+"//"+t.host+e}return e};pressKey=e=>{this.triggerKey(e.keyState.key)};triggerKey=e=>{const t=ie.ZP.getActivePage(this.context.vivaldiWindowId);t&&C.Z.accessKeys.action(t.id,e),this.onClose()};render(){if(!this.state.shown)return null;const{accessKeys:e,page:t}=this.state;return Die("div",{className:"dialog-access-keys"},void 0,Die("header",{className:"dialog-header"},void 0,Die("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("Access Key Shortcuts"),t&&Die("span",{className:"info"},void 0,(0,Oe.Z)("for $1",[t.title||t.url])))),Die("div",{className:"dialog-content"},void 0,0===e.length&&(0,Oe.Z)("This page doesn’t seem to contain access key shortcuts."),e.length>0&&e.map(((e,t)=>Die("label",{className:"keycombo",title:e.href},t,Die("input",{type:"button",className:"item",onClick:this.triggerKey.bind(null,e.access_key),value:e.access_key}),Die("span",{},void 0,e.title.replace(/\[.*?\]/g,"")||e.textContent.trim()||e.href))))),Die("footer",{className:"dialog-footer"},void 0,Die("p",{className:"info"},void 0,H.Z.get($.kWebpagesAccessKeys)?(0,Oe.Z)("Access key shortcuts are allowed in keyboard settings."):(0,Oe.Z)("Access key shortcuts are disabled in keyboard settings.")," ",(0,Oe.Z)("Run shortcuts on page with $1 modifier keys.",["Shift+Alt"])),Die("input",{type:"button",onClick:this.onClose,value:(0,Oe.Z)("Close"),className:"primary",autoFocus:!0})))}}const Lie=Oie;var Rie,Bie;function Fie(e,t,n,s){Rie||(Rie="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Rie,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Vie(e){return function(t){return Fie("div",{"data-selected":t.selected?"":null,className:"quick-command",style:t.style,onMouseOver:()=>t.onMouseOver(t.item),onClick:e=>t.onItemClick(t.item,e)},void 0,(0,fs.jsx)(e,{...t}))}}function Wie(e,t,n,s){Bie||(Bie="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Bie,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Uie extends hs.PureComponent{render(){const{name:e}=this.props.item;return(0,fs.jsxs)(fs.Fragment,{children:[Wie("span",{className:"quick-command-favicon",dangerouslySetInnerHTML:{__html:Ts.VLT}}),Wie("span",{className:"quick-command-title"},void 0,e),Wie("span",{className:"view quick-command-shortcut"},void 0,(0,Oe.Z)("Press Enter to Copy"))]})}}const Hie=Vie(Uie);var zie;function Gie(e,t,n,s){zie||(zie="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:zie,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class $ie extends hs.PureComponent{render(){const{item:e,searchTerm:t,workspaceIcon:n}=this.props,s=e.faviconUrl||e.pageUrlForFavicon||e.url||void 0,i=e.faviconUrl?"faviconFromCache":"page";return(0,fs.jsxs)(fs.Fragment,{children:[n&&Gie("span",{className:"quick-command-workspace-icon",dangerouslySetInnerHTML:{__html:n}}),s&&Gie(Ss,{className:"quick-command-favicon",url:s,loadType:i,style:e.read?{filter:"saturate(0) opacity(0.5)"}:{}}),t.length?oC(t,e.name,"quick-command-title"):Gie("span",{className:"quick-command-title"},void 0,e.name),e.url&&(t.length?oC(t,e.url,"quick-command-url"):Gie("span",{className:"view quick-command-url"},void 0,e.url)),e.nickname&&(t.length?oC(t,e.nickname,"view quick-command-nickname"):Gie("span",{className:"view quick-command-nickname"},void 0,e.nickname)),e.meta&&Gie("span",{className:"view quick-command-meta"},void 0,(0,tu.$)(e.meta))]})}}const Kie=Vie($ie);var jie;function Yie(e,t,n,s){jie||(jie="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:jie,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Xie extends hs.PureComponent{render(){const{name:e,url:t,faviconUrl:n,visitCount:s,visitTime:i}=this.props.item,{searchTerm:o}=this.props,a=N()(i).format("l, LT"),r=e||t;return(0,fs.jsxs)(fs.Fragment,{children:[Yie(Ss,{url:n||t,loadType:n?"faviconFromCache":"page",className:"quick-command-favicon"}),oC(o,r,"quick-command-title"),Yie("span",{className:"quick-command-timestamp"},void 0,a),Yie("span",{className:"item-count"},void 0,s)]})}}const Qie=Vie(Xie);var qie;function Jie(e,t,n,s){qie||(qie="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:qie,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const eoe="/resources/folder@2x.png";class toe extends hs.PureComponent{render(){const{item:e,searchTerm:t}=this.props,n=function(e,t){return t?eoe:e?Ts.NwZ:Ts.cyI.small}(e.hasOwnProperty("url"),Boolean(e.isFolder));return(0,fs.jsxs)(fs.Fragment,{children:[Jie(Ss,{url:n,loadType:"faviconFromCache",className:"quick-command-favicon"}),e.name&&oC(t,e.name,"quick-command-title"),!e.nickname&&e.url&&oC(t,e.url,"quick-command-url"),e.nickname&&oC(t,e.nickname,"quick-command-url"),e.hasAttachment&&Jie("span",{className:"quick-command-attachment",dangerouslySetInnerHTML:{__html:Ts.onv}})]})}}const noe=Vie(toe);var soe;function ioe(e,t,n,s){soe||(soe="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:soe,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class ooe extends hs.PureComponent{render(){const{item:e,style:t,selected:n}=this.props,{name:s,subtitle:i,count:o}=e;return ioe("div",{"data-selected":n?"":null,style:t,className:"quick-command-sectionheader"},void 0,s,i&&ioe("span",{className:"QuickCommand-Title--Subtitle"},void 0,i),o>0&&ioe("span",{className:"item-count"},void 0,o))}}const aoe=ooe;var roe,loe=n(34155);function doe(e,t,n,s){roe||(roe="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:roe,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class coe extends hs.PureComponent{static contextType=xi.Z;state={selectedIndex:1};_keyedNavigation=!1;_startIndex=0;_stopIndex=0;setKeyedNavigation=e=>{this._keyedNavigation=e};getSelectedIndex=()=>this.state.selectedIndex;selectByIndex=e=>{this.props.setNavigatingList(!0),this.props.hintChange(e),this.setState({selectedIndex:e}),this.rerenderVisibleTreeItems()};onKeyDown=e=>{const t={ctrl:Boolean(e.ctrlKey),alt:Boolean(e.altKey),shift:Boolean(e.shiftKey),command:!1},n=this.props.renderedArray;let s=this.getSelectedIndex(),i=s;if(!t.ctrl&&t.alt&&!t.shift&&!t.command)switch(e.key){case"ArrowUp":s>0&&"title"===n[s-1].type&&s--,i=0;for(let e=s-1;e>=0;e--)if("title"===n[e].type){i=e+1;break}e.preventDefault();break;case"ArrowDown":for(let e=s;e<n.length;e++)if("title"===n[e].type){i=e+1;break}e.preventDefault()}else if(!(t.ctrl||t.alt||t.shift||t.command)){const t=this._stopIndex-this._startIndex;switch(e.key){case"ArrowUp":i=Math.max(0,s-1),e.preventDefault();break;case"ArrowDown":i=Math.min(s+1,n.length-1),e.preventDefault();break;case"PageUp":i=Math.max(0,this._startIndex-t);break;case"PageDown":i=Math.min(this._stopIndex+t,n.length-1)}}i!==s&&("title"===n[i].type&&(i=i>s?++i:Math.max(0,--i)),this.selectByIndex(i))};_onMouseOver=e=>{this._keyedNavigation||void 0===e.index||(this.selectByIndex(e.index),loe.nextTick((()=>this.props.syncOffset())))};_onMouseMove=()=>{this.setKeyedNavigation(!1)};rerenderVisibleTreeItems=()=>{this.refList&&this.refList.forceUpdateGrid()};_onIndexChanged=e=>{this._startIndex=e.startIndex,this._stopIndex=e.stopIndex};_getWorkspaceIcon=e=>{const t=this.props.workspaces.find((t=>t.id===e));return t?.emoji??t?.icon??void 0};renderTreeItem=({index:e,style:t})=>{const{filtering:n,searchTerm:s}=this.props,i=this.props.renderedArray[e],o=`${i.type}__${e}`;"noteAdd"!==i.type&&"title"!==i.type&&(i.index=e);const a=this.state.selectedIndex===e,r=!n||"noteAdd"===i.type&&"search"===i.type&&"keywordSearch"===i.type&&"commandChain"===i.type?s:s.split(":")[1].trim();switch(i.type){case"title":return doe(aoe,{selected:a,item:i,style:t},o);case"history":return doe(Qie,{selected:a,item:i,style:t,searchTerm:r,onItemClick:this.props.onExecuteCommand,onMouseOver:this._onMouseOver},o);case"calculator":{const e=i;return doe(Hie,{style:t,selected:a,onItemClick:this.props.onExecuteCommand,onMouseOver:this._onMouseOver,item:e},o)}case"note":case"noteAdd":return doe(noe,{item:i,style:t,selected:a,onItemClick:this.props.onExecuteCommand,searchTerm:r,onMouseOver:this._onMouseOver},o);default:{const e=i;let n;return e.workspaceId&&(n=this._getWorkspaceIcon(e.workspaceId)),doe(Kie,{selected:a,item:e,style:t,searchTerm:r,onItemClick:this.props.onExecuteCommand,onMouseOver:this._onMouseOver,workspaceIcon:n},o)}}};render(){const{innerHeight:e}=this.context,t=28*this.props.renderedArray.length;let n=t>280?280:t;return e/3<n&&(n=e/3),doe("div",{className:"quick-commands",tabIndex:"1",onKeyDown:this.onKeyDown,onMouseMove:this._onMouseMove},void 0,(0,fs.jsx)(lo.aV,{ref:e=>this.refList=e,onRowsRendered:this._onIndexChanged,scrollToIndex:this.state.selectedIndex,height:n,rowHeight:28,width:520,rowRenderer:this.renderTreeItem,rowCount:this.props.renderedArray.length}))}}const hoe=coe;var poe,uoe=n(34155);function goe(e,t,n,s){poe||(poe="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:poe,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const moe=(0,Oe.Z)("Filter Quick Commands"),voe=[$.kAddressBarStripJavascriptOnPaste,$.kQuickCommandsKeepValue,$.kQuickCommandsOpenUrlInNewTab,$.kQuickCommandsSearchEnglish,$.kQuickCommandsSearchPriority,$.kQuickCommandsMatchNickname,$.kChainedCommandsCommandList,$.kQuickCommandsShowBookmarks,$.kQuickCommandsShowCalculator,$.kQuickCommandsShowExtensions,$.kQuickCommandsShowHistory,$.kQuickCommandsShowNotes,$.kQuickCommandsShowPageActions,$.kQuickCommandsLimitResults,$.kQuickCommandsShowReadingList,$.kQuickCommandsUseNotesManager,$.kWorkspacesEnabled],foe="text/plain";let yoe=!1;const Coe=(0,xs.Z)("keyword","bookmark"),woe=(0,xs.Z)("keyword","note"),boe=(0,xs.Z)("keyword","tab"),Soe=(0,xs.Z)("keyword","nick"),Ioe=(0,xs.Z)("keyword","history"),koe=(0,xs.Z)("keyword","command"),Aoe=(0,xs.Z)("keyword","action"),Toe=(0,xs.Z)("keyword","extension"),Zoe=[{...(0,ka.jn)({labelPair:Coe,initialPart:"^",endingPart:"$"}),...Coe,type:"bookmark"},{...(0,ka.jn)({labelPair:woe,initialPart:"^",endingPart:"$"}),...woe,type:"note"},{...(0,ka.jn)({labelPair:boe,initialPart:"^",endingPart:"$"}),...boe,type:"tab"},{...(0,ka.jn)({labelPair:Soe,initialPart:"^",endingPart:"$"}),...Soe,type:"bookmarkNick"},{...(0,ka.jn)({labelPair:Ioe,initialPart:"^",endingPart:"$"}),...Ioe,type:"history"},{...(0,ka.jn)({labelPair:koe,initialPart:"^",endingPart:"$"}),...koe,type:"command"},{...(0,ka.jn)({labelPair:Aoe,initialPart:"^",endingPart:"$"}),...Aoe,type:"contentScript"},{...(0,ka.jn)({labelPair:Toe,initialPart:"^",endingPart:"$"}),...Toe,type:"extension"}];class Eoe extends hs.PureComponent{static contextType=xi.Z;state={quickCommandSearchValue:this.props.quickCommandValue||"",typeAheadHint:moe,filtering:null,renderedArray:[]};#h=!1;_isIMEOpen=!1;_justClosedIME=!1;contentScripts=[];hasSearchedForFullHistory=!1;_imeProcessSpace=!1;defaultEngine;chainShortcuts=[];refQuickCommandInput=hs.createRef();refQuickCommandHint=hs.createRef();extensions=[];commandChains=[];constructor(e,t){super(e),yoe||(yoe=!0,L.loadAll()),this.defaultEngine=Gn.Z.getDefault(G.ZP.isIncognito(t.vivaldiWindowId))}componentDidMount(){this.#h=!0,qa.Z.addListener(this._onWebpageviewStoreChanged),this._initialSetup(),C.Z.pageActions.getScripts((e=>{this.contentScripts=e}))}_initialSetup=()=>{const e=(0,ka.IZ)(this.context.vivaldiWindowId,""),t=(0,ka.JQ)(""),n=H.Z.get($.kWorkspacesEnabled),s=n?(0,ka.fX)(this.context.vivaldiWindowId,""):[];this.chainShortcuts=J.Z.getChainCommandsShortcuts(),(0,ka.pN)().then((e=>this.extensions=e)),this.commandChains=this.props.prefValues[$.kChainedCommandsCommandList];const i=(0,ka.$J)(this.context,{searchText:"",chains:this.commandChains,shortcuts:this.chainShortcuts});let o=[];if(this.props.prefValues[$.kQuickCommandsSearchPriority].forEach((a=>{switch(a){case"OPEN_TABS":o=[...o,...t];break;case"NORMAL_COMMAND":o=[...o,...e];break;case"WORKSPACES":n&&(o=[...o,...s]);break;case"COMMAND_CHAIN":o=[...o,...i]}})),this.setState({renderedArray:o},(()=>{const{selectIndex:e}=this.getSelectPriority();this.hintChange(e)})),this.props.prefValues[$.kQuickCommandsKeepValue]&&this.refQuickCommandInput.current?.value===this.props.quickCommandValue){const e=this.state.quickCommandSearchValue;e.length&&(this.refQuickCommandInput.current?.setSelectionRange(0,e.length),this.searchChange(e))}};componentWillUnmount(){const e=this.state.quickCommandSearchValue;this.props.prefValues[$.kQuickCommandsKeepValue]&&e.length?this.props.storeQuickCommandValue(e):this.props.storeQuickCommandValue(""),qa.Z.removeListener(this._onWebpageviewStoreChanged),this.#h=!1}componentDidUpdate(){this._imeProcessSpace&&this._isIMEOpen&&(this._imeProcessSpace=!1),this.commandChains!==this.props.prefValues[$.kChainedCommandsCommandList]&&(this.commandChains=this.props.prefValues[$.kChainedCommandsCommandList])}_onWebpageviewStoreChanged=e=>{if(this.#h&&"qcPasteAndGo"===e.action&&e.payload){const t=this.refQuickCommandInput.current?.selectionStart??0,n=this.refQuickCommandInput.current?.selectionEnd??0,{clipboardText:s}=e.payload,{quickCommandSearchValue:i}=this.state,o=(0,zC.Z)({textToStrip:s,caretPosition:t,selectionEnd:n,currentValue:i}),{renderedArray:a,filtering:r}=this.processRenderedArray({qcInputText:o,renderedArray:[]});this.setState({renderedArray:a,filtering:r},(()=>{const{selectIndex:e}=this.getSelectPriority(),t=this.state.renderedArray[e];setTimeout((()=>{this.executeCommand(t,{ctrlKey:!1,altKey:!1,metaKey:!1,shiftKey:!1}),this.props.onClose()}),5)}))}};onKeyDown=e=>{switch(this.qclist.setKeyedNavigation(!0),e.key){case"Process":this._isIMEOpen&&(this._imeProcessSpace=!0);break;case"Escape":this.onEscape(),e.preventDefault(),e.stopPropagation();break;case"ArrowUp":case"ArrowDown":case"PageUp":case"PageDown":this.qclist.onKeyDown(e),e.preventDefault();break;case"Enter":{if(this._isIMEOpen||this.expireTimeout)break;const t=this.qclist.getSelectedIndex(),{renderedArray:n}=this.state,s=n[t];this.executeCommand(s,e),e.preventDefault(),e.stopPropagation();break}case"Tab":case"ArrowRight":if((0,qi.Z)(e)||this._isIMEOpen)break;this.autoCompleteHint(),"Tab"===e.key&&e.preventDefault()}this._justClosedIME=!1,uoe.nextTick((()=>this.syncOffset()))};onCompositionStart=()=>{this._isIMEOpen=!0};onCompositionEnd=()=>{this._isIMEOpen=!1,this._justClosedIME=!0,this.searchChange(this.state.quickCommandSearchValue)};onEscape=()=>{this._isIMEOpen||(this.state.quickCommandSearchValue.length>0&&!this._justClosedIME&&!this._isIMEOpen?(this.props.storeQuickCommandValue(""),this.setState({quickCommandSearchValue:"",typeAheadHint:moe},(()=>this.searchChange("")))):this._justClosedIME||this.props.onClose()),this._justClosedIME=!1};syncOffset=()=>{const{HTMLInputElement:e}=this.context,t=this.refQuickCommandInput.current?.scrollLeft??-1;t>-1&&this.refQuickCommandHint.current instanceof e&&(this.refQuickCommandHint.current.scrollLeft=t)};autoCompleteHint=()=>{const{typeAheadHint:e,renderedArray:t}=this.state,n=t[this.qclist.getSelectedIndex()];if(!e.length||"calculator"===n.type)return;const s="commandKeyword"===n.type&&n.searchString?n.searchString+" ":e;this.setState({quickCommandSearchValue:s},(()=>this.searchChange(s)))};executeCommand=(e,t)=>{const{ctrlKey:n,altKey:i,metaKey:o,shiftKey:a}=t,r={ctrlKey:n,altKey:i,metaKey:o,shiftKey:a},l=(0,ka.vD)(this.context.vivaldiWindowId,r),h=this.context.vivaldiWindowId;switch(e.type){case"openTab":if(e.windowId&&e.pageId){const{windowId:t,pageId:n,workspaceId:i}=e;i!==G.ZP.getActiveWorkspace(h)&&cs.Z.setActiveWorkspace(t,i),s.Z.windows.update(t,{focused:!0},(()=>{s.Z.tabs.update(n,{active:!0})}))}break;case"closedTab":e.command&&as.Z.undeleteTab(e.command);break;case"calculator":{const{name:t}=e;this.context.navigator.clipboard.writeText(t);break}case"commandChain":e.action&&e.action();break;case"bookmarkFolder":case"bookmarkNick":e.folderId?(0,ka.hV)(this.context.vivaldiWindowId,e.folderId):e.url&&d.ZP.openURL(h,e.url,{...l});break;case"bookmark":if(e.url){const{url:t}=e;d.ZP.openURL(h,t,{...l})}break;case"extension":if(e.id&&void 0!==e.enabled){const{id:t,enabled:n,optionsUrl:s=""}=e,i={id:t,enabled:n,optionsPage:(0,co.mT)(r),optionsUrl:s};(0,ka.de)(h,i)}break;case"url":{const{name:t}=e;d.ZP.openURL(h,t,{transition:C.Z.historyPrivate.TransitionType.TYPED,...l});break}case"keywordSearch":case"search":e.searchQuery&&"string"==typeof e.searchQuery&&Fy.Z.goSearchUrl(h,e.searchQuery,{...l});break;case"command":case"commandKeyword":if(e.commandName){const{commandName:t,value:n,name:s}=e;return void this.props.onClose().then((()=>{v.Z.executeActions("qc",this.context,t,n),c.Z.setStatus(h,(0,Oe.Z)("Command: $1",[s]),3e3),this.props.storeQuickCommandValue("")}))}break;case"history":if(e.url){const{url:t}=e;d.ZP.openURL(h,t,{...l})}break;case"contentScript":{const t=ie.ZP.getActivePage(h);if(t&&e.script){const n=t.id,{script:s}=e;C.Z.pageActions.getScriptOverridesForTab(n,(e=>{const t=e.find((e=>e.script===s)),i=t&&"enabled"===t.override?"no_override":"enabled";C.Z.pageActions.setScriptOverrideForTab(s,n,i,(()=>{}))}))}break}case"note":if(e.id){const{id:t}=e;this.handleNotesOpening(t,{...l})}break;case"noteAdd":if(e.value&&"string"==typeof e.value){const{value:t}=e;Nn.Z.createNote(h,{content:t,type:"note"})}break;case"workspace":{const{workspaceId:t}=e;cs.Z.setActiveWorkspace(h,t);break}}this.#h&&(this.setState({quickCommandSearchValue:""}),this.props.storeQuickCommandValue("")),uoe.nextTick(this.props.onClose)};onSearchChange=e=>{const t=e.target;this.searchChange(t.value)};handleNotesOpening=(e,t)=>{const n=this.props.prefValues,s=this.context.vivaldiWindowId;n[$.kQuickCommandsUseNotesManager]||!ud.ZP.hasPanel(s,"PanelNotes")?d.ZP.openURL(s,je.jk.internalUrl("notes",e),{...t}):Pn.Z.showContent(s,"PanelNotes",{setFocus:!0,selectId:e,reason:""})};handleHistoryFullSearchTimeout=(0,no.Z)((e=>{if(this.hasSearchedForFullHistory||!this.state.quickCommandSearchValue.length)return!1;if(this.isNavigatingList)return this.hasSearchedForFullHistory=!1,this.handleHistoryFullSearchTimeout(e),!1;this.hasSearchedForFullHistory=!0;const t=(0,ka.s1)({searchText:e,today:!1}),n=this.state.renderedArray[this.qclist?.getSelectedIndex()],{renderedArray:s,filtering:i}=this.processRenderedArray({qcInputText:e,renderedArray:t});this.setState({renderedArray:s,filtering:i},(()=>this.performFullSearchSelection(n)))}),750);performFullSearchSelection=e=>{const t=e;if("history"!==t.type||void 0===t.url)return;const n=this.state.renderedArray.findIndex((n=>{const s=n.url;return!(!s||!e)&&s.toLowerCase()===t.url.toLowerCase()}));-1!==n&&(this.selectByIndex(n),this.qclist.rerenderVisibleTreeItems())};setNavigatingList=e=>{this.isNavigatingList=e,this.debounceNavigationOfList()};debounceNavigationOfList=(0,no.Z)((()=>{this.isNavigatingList=!1}),500);processRenderedArray=e=>{const{qcInputText:t,renderedArray:n}=e,s=t.trim(),i=this.props.prefValues,o=this.props.prefValues[$.kQuickCommandsSearchPriority];let a,r,l,d=[];-1===s.indexOf(":")||(0,vs.K2)(s)||([r,l]=s.split(":"),a=Zoe.find((e=>(0,ka.Fm)(r,e))));const c=(0,ka.xh)(s);c.forEach((e=>d.push(e)));const h=s.length;if(i[$.kQuickCommandsShowCalculator]&&(0,ka.CD)(s).forEach((e=>d.push(e))),h&&!c.length){const e=(0,ka.JC)(s,this.defaultEngine);d.push(e)}i[$.kQuickCommandsShowNotes]&&(0,ka.Dj)(s).forEach((e=>d.push(e)));const p=l?.trim()||s,u=l?.trim()?.length||h,g=void 0!==a,m=Boolean(!g&&u);return o.forEach((e=>{switch(e){case"OPEN_TABS":{if(!("tab"===a?.type)&&g)break;const e=(0,ka.JQ)(p);d=[...d,...e];break}case"NORMAL_COMMAND":{if(!("command"===a?.type)&&g)break;const e=(0,ka.IZ)(this.context.vivaldiWindowId,p);d=[...d,...e];break}case"EXTENSIONS":{const e=i[$.kQuickCommandsShowExtensions]&&u,t="extension"===a?.type;if(!e||!t&&g)break;const n=(0,ka.nX)(p,this.extensions);d=[...d,...n];break}case"COMMAND_CHAIN":h&&(0,ka.$J)(this.context,{searchText:s,chains:this.commandChains,shortcuts:this.chainShortcuts}).forEach((e=>d.push(e)));break;case"BOOKMARK_ITEM_OR_FOLDER":{const e=i[$.kQuickCommandsShowBookmarks]&&u,t="bookmark"===a?.type,n="bookmarkNick"===a?.type;if(!e)break;(n||m)&&(0,ka.hm)(p).forEach((e=>d.push(e)));let s=[],o=[];(t||m)&&(s=(0,ka.Xz)(p),o=(0,ka.oE)(p)),d=[...d,...s,...o];break}case"READING_LIST":if(h&&i[$.kQuickCommandsShowReadingList]){const e=(0,ka.Lm)(s);d=[...d,...e]}break;case"NOTES_SEARCH":{const e=i[$.kQuickCommandsShowNotes]&&u,t="note"===a?.type;if(!e||!t&&g)break;const n=(0,ka.Kk)(p);d=[...d,...n];break}case"HISTORY":{const e=i[$.kQuickCommandsShowHistory]&&u>1,t="history"===a?.type;if(!e||!t&&g)break;if(!n.length){const e=this.throttleHistory(p);d=[...d,...e]}else d=[...d,...n];break}case"CLOSED_TABS":{if(!("tab"===a?.type)&&g)break;const e=(0,ka.S4)(p);d=[...d,...e];break}case"KEYWORD_SEARCH":(0,ka.Gr)(s).forEach((e=>d.push(e)));break;case"PAGE_ACTIONS":{const e=i[$.kQuickCommandsShowPageActions]&&u,t="contentScript"===a?.type,n=ie.ZP.isActiveExternal(this.context.vivaldiWindowId);if(!e||!t&&g||!n)break;const s=(0,ka.sh)(p,this.contentScripts);d=[...d,...s];break}case"WORKSPACES":if(H.Z.get($.kWorkspacesEnabled)){const e=(0,ka.fX)(this.context.vivaldiWindowId,p);d=[...d,...e]}}})),{renderedArray:d,filtering:a}};searchChange=(e,t=-1)=>{this.hasSearchedForFullHistory=!1;const{renderedArray:n,filtering:s}=this.processRenderedArray({qcInputText:e,renderedArray:[]});this.setState({renderedArray:n,filtering:s,quickCommandSearchValue:e},(()=>{-1!==t&&this.refQuickCommandInput.current?.setSelectionRange(t,t),this.performSelection()}))};throttleHistory=e=>(H.Z.get($.kQuickCommandsLimitResults)||this.handleHistoryFullSearchTimeout(e),(0,ka.s1)({searchText:e,today:!0}));onPaste=e=>{const{clipboardData:t}=e;if(t.types[0]!==foe)return;const n=t.getData(foe);n.trim()||e.preventDefault();const{prefValues:s}=this.props,{quickCommandSearchValue:i}=this.state,o=/^(\s*javascript:)+/i;if(s[$.kAddressBarStripJavascriptOnPaste]){const t=o.test(n),s=o.test(i+n);if(t||s){e.preventDefault();const{selectionEnd:t,selectionStart:s}=e.currentTarget,i=(0,zC.Z)({textToStrip:n,caretPosition:s,selectionEnd:t,currentValue:this.state.quickCommandSearchValue}),o=e.currentTarget.selectionStart+i.length-this.state.quickCommandSearchValue.length;this.searchChange(i,o)}}};getSelectPriority=()=>{const{renderedArray:e,filtering:t,quickCommandSearchValue:n}=this.state,{prefValues:s}=this.props;let i=0;const o=s[$.kQuickCommandsSearchEnglish];if(t){const{type:n}=t,s=e.findIndex((e=>void 0!==e.selectPriority&&e.type.toLowerCase().includes(n.toLowerCase())));if(s>-1){const t=e[s];return(0,ka.Jg)(t,s)}}const a=n.toLowerCase(),r=e.findIndex((e=>{const t=e.name.toLowerCase();if(o&&e.labelEnglish){const n=e.labelEnglish.toLowerCase();return a===t||a===n}return a===t}));if(r>-1){const t=e[r];return(0,ka.Jg)(t,r)}let l=s[$.kQuickCommandsSearchPriority].length;return e.forEach(((e,t)=>{void 0!==e.selectPriority&&e.selectPriority<l&&(i=t,l=e.selectPriority)})),{priority:l,selectIndex:i}};openBookmark=e=>{const t=this.props.prefValues;if(t[$.kQuickCommandsMatchNickname]){if(e.folderId)(0,ka.hV)(this.context.vivaldiWindowId,e.folderId);else if(e.url){const n={inCurrent:!1===t[$.kQuickCommandsOpenUrlInNewTab],inBackground:!1,inNewWindow:!1,allowOverride:!1,incognito:!1};Ds.ZP.openUrls(this.context.vivaldiWindowId,[e.url],n,!1)}this.expireTimeout=setTimeout((()=>{this.props.storeQuickCommandValue(""),this.setState({quickCommandSearchValue:""},(()=>{this.props.onClose()}))}),200)}};performSelection=()=>{const{quickCommandSearchValue:e}=this.state,{renderedArray:t}=this.state;let{priority:n,selectIndex:s}=this.getSelectPriority();const i=t[s],o=this.props.prefValues[$.kQuickCommandsSearchPriority];if("bookmarkNick"===i.type)this.openBookmark(i);else if(n===o.length){const n=t.findIndex((t=>"history"===t.type&&t.name.toLowerCase().includes(e.toLowerCase())));s=-1!==n?n:0}this.selectByIndex(s),this.hintChange(s),this.qclist?.rerenderVisibleTreeItems()};hintChange=e=>{let t;const{renderedArray:n,filtering:s,quickCommandSearchValue:i}=this.state,o=n[e];let a=i;switch(s&&(a=a.split(":")[1]),o.type){case"url":case"noteAdd":case"search":case"keywordSearch":t="";break;case"commandKeyword":case"command":if(o.value)t="";else{const{name:e}=o,n=(0,ka.ue)(e,a);t=i+e.substring(n+a.length)}break;case"calculator":if(o.searchString&&o.name){const{searchString:e,name:n}=o;t=e!==n?`${a} = ${n}`:""}break;default:{let e="";const{name:n="",url:s="",nickname:r=""}=o,l=(0,ka.ue)(n,a),d=s?(0,ka.ue)(s,a):-1,c=(0,ka.ue)(r,a);-1!==l?e=n.substring(l+a.length):s&&-1!==d?e=s.substring(d+a.length):-1!==c&&(e=r.substring(c+a.length)),t=i+e}}a.length||"title"!==o.type||(t=moe),this.setState({typeAheadHint:t}),this.qclist.rerenderVisibleTreeItems()};selectByIndex(e){this.qclist&&this.qclist.selectByIndex(e)}render(){const{renderedArray:e,filtering:t,quickCommandSearchValue:n}=this.state,s=H.Z.get($.kWorkspacesEnabled)?Kj.Z.getWorkspaces(this.context.vivaldiWindowId):[];return goe("div",{className:"quick-command-container"},void 0,goe("div",{className:"qc-entry"},void 0,(0,fs.jsx)("input",{tabIndex:"-1",readOnly:!0,ref:this.refQuickCommandHint,className:"quick-command-search-hint",value:this.state.typeAheadHint}),(0,fs.jsx)("input",{type:"search",autoFocus:!0,ref:this.refQuickCommandInput,className:"quick-command-search",onKeyDown:this.onKeyDown,onScroll:()=>uoe.nextTick(this.syncOffset),onCompositionStart:this.onCompositionStart,onCompositionEnd:this.onCompositionEnd,value:this.state.quickCommandSearchValue,onChange:this.onSearchChange,onPaste:this.onPaste})),(0,fs.jsx)(hoe,{ref:e=>this.qclist=e,renderedArray:e,onExecuteCommand:this.executeCommand,syncOffset:this.syncOffset,filtering:Boolean(t),setNavigatingList:this.setNavigatingList,searchTerm:n.trim(),hintChange:this.hintChange,workspaces:s}))}}const _oe=sa(Eoe,voe);var Moe;function Noe(e,t,n,s){Moe||(Moe="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Moe,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Poe=[$.kKeyboardShortcutsEnable,$.kKeyboardShortcutsEnableSingleKey];class Doe extends hs.Component{refComboFilter=hs.createRef();state={filter:""};componentDidMount(){this.refComboFilter.current?.focus()}onSettingsFilter=e=>{const t=e.target.value.toLowerCase().replace(/⌘/g,"meta").replace(/⌥/g,"alt").replace(/⇧/g,"shift").replace(/⌃/g,"ctrl");this.setState({filter:t})};onKeyDown=e=>{"Escape"===e.nativeEvent.code&&0===this.refComboFilter.current?.value.length&&(this.props.onClose(),e.stopPropagation(),e.preventDefault())};render(){let e="keystrokes";return this.props.prefValues[$.kKeyboardShortcutsEnable]?this.props.prefValues[$.kKeyboardShortcutsEnableSingleKey]||(e+=" singlekeydisabled"):e+=" shortcutsdisabled",Noe("div",{className:"keyboardShortcutsWrapper",tabIndex:"0",onKeyDown:this.onKeyDown},void 0,Noe("header",{},void 0,Noe("h1",{},void 0,(0,Oe.Z)("Keyboard Cheat Sheet")),(0,fs.jsx)("input",{className:"search",ref:this.refComboFilter,type:"search",placeholder:(0,Oe.Z)("Filter Commands"),onChange:this.onSettingsFilter}),Noe("button",{className:"close",onClick:this.props.onClose,dangerouslySetInnerHTML:{__html:Ts.kze}})),Noe("div",{className:e},void 0,Noe(oW,{filter:this.state.filter,view:"read-only"})))}}const xoe=sa(Doe,Poe);var Ooe;function Loe(e,t,n,s){Ooe||(Ooe="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Ooe,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Roe=[$.kThemeUseAnimation];class Boe extends hs.Component{static contextType=xi.Z;state={mediaState:q8.Z.getState().get(this.props.page.id)||(0,te.l4)()};componentDidMount(){q8.Z.addListener(this._onMediaStateStoreChanged)}componentDidUpdate(e,t){e.page.id!==this.props.page.id&&this._onMediaStateStoreChanged()}componentWillUnmount(){q8.Z.removeListener(this._onMediaStateStoreChanged)}_onMediaStateStoreChanged=()=>{this.setState({mediaState:q8.Z.getState().get(this.props.page.id)||(0,te.l4)()})};onClickAudio=(e,t,n)=>{if((0,to.ZP)(e),n.has("pip"))d.ZP.exitPictureInPicture(this.props.page.id);else{const e=n.has("muting")?"unmute":"mute";d.ZP.setMuting(this.context.vivaldiWindowId,"selection",e,te.aV.of(t))}};selectPage=e=>{(0,to.ZP)(e),this.props.selectPage?.(this.props.page)};_renderMediaIcon=(e,t)=>!(0===e.size||t.discarded)&&Loe("span",{className:"tab-audio",onMouseDown:n=>this.onClickAudio(n,t,e)},void 0,Loe(Qo,{animated:H.Z.get($.kThemeUseAnimation),mediaState:e,src:"tab"}));render(){const{page:e,selected:t,listType:n}=this.props,{active:s}=e,{mediaState:i}=this.state,o=je.jk.getFavicon(e.url);return(0,fs.jsxs)(fs.Fragment,{children:["minimal"===n&&Loe("li",{onContextMenu:to.ZP,onMouseDown:this.selectPage,className:As()({"visual-list":!0,selected:t,"active-page":s})},void 0,Loe(Ss,{className:"visual-tab-list-favicon",url:o||e.url,loadType:o?"faviconFromCache":"page"}),this._renderMediaIcon(i,e),je.jk.getDisplayTitle(e)),"visual"===n&&Loe("div",{className:"visual-tab-switcher-title"},void 0,this._renderMediaIcon(i,e),je.jk.getDisplayTitle(e))]})}}const Foe=sa(Boe,Roe);var Voe,Woe=n(71193);function Uoe(e,t,n,s){Voe||(Voe="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Voe,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Hoe=212;class zoe extends hs.PureComponent{static contextType=xi.Z;constructor(e,t){super(e),this.pages=(0,Woe.Z)(t.vivaldiWindowId),this.workingPageSet=this.pages.map((e=>({uid:Math.ceil(Math.random()*Math.pow(10,12)),page:e})));const n=this.props.forward?1:-1,s=ie.ZP.unsafeGetActivePage(t.vivaldiWindowId),i=this.getSelectedPageWithOffset(s,n);this.state={selected:i,offset:n}}getMaxAllowedWidth=()=>this.context.innerWidth-Hoe;getNumberOfPreviews=()=>{const{pages:e}=this;if(e.size*Hoe<this.getMaxAllowedWidth())return e.size;let t=1;for(;(t+1)*Hoe+24<this.getMaxAllowedWidth()&&t<e.size;)t++;return t};getSelectedPageWithOffset=(e,t)=>{const{pages:n}=this;let s=n.indexOf(e)+t;s=(s%n.size+n.size)%n.size;const i=n.get(s);return i||e};cancelEvent=e=>{e.stopPropagation(),e.preventDefault()};navigateWithOffset=e=>{const{document:t}=this.context;this.setState((t=>({selected:this.getSelectedPageWithOffset(t.selected,e),offset:e})),(()=>{const e=t.querySelector(".visual-list.selected");e&&e.scrollIntoViewIfNeeded()}))};selectBack=()=>{this.navigateWithOffset(-1)};selectForward=()=>{this.navigateWithOffset(1)};selectByUid=e=>{const t=this.workingPageSet.find((t=>t.uid===e));t&&this.selectPage(t.page)};selectPage=e=>{this.setState({selected:e})};renderMinimalList=()=>{const{pages:e}=this,{selected:t}=this.state;return Uoe("div",{className:"tabswitcher list"},void 0,Uoe("img",{className:As()({"visual-list-preview":!0,"active-page":t.active}),src:t.vivExtData.thumbnail,onContextMenu:this.cancelEvent,onMouseDown:()=>this.selectPage(t),title:je.jk.getDisplayUrlFromMapping(t.url)||je.jk.getDisplayTitle(t),alt:""}),Uoe("ul",{className:"listed-tabs"},void 0,e.map((e=>{const n=e.id===t.id;return Uoe(Foe,{selectPage:this.selectPage,listType:"minimal",page:e,selected:n},"visual-tab-list-"+e.id)}))))};renderVisualList=()=>{const{pages:e,workingPageSet:t}=this,{selected:n,offset:s}=this.state,i=this.getNumberOfPreviews(),o=i*Hoe+24,a=e.indexOf(this.state.selected);let r=t;if(t.size>i){const e=Math.min(Math.max(a-Math.floor(i/2)+(-1!==s||i%2?0:1),0),t.size-i);r=t.reduce(((t,n,s)=>(s>=e&&s<e+i&&t.push(n),t)),[])}return Uoe("div",{className:"tabswitcher",tabIndex:"1",style:{width:o},onContextMenu:this.cancelEvent},void 0,Uoe("div",{className:"visual-tabs"},void 0,r.map((e=>{const{page:t,uid:s}=e,{active:i,id:o,url:a}=t,r=je.jk.getFavicon(t.url);return Uoe("div",{onMouseDown:this.selectByUid.bind(this,s),style:{backgroundImage:`url('${t.vivExtData.thumbnail??""}')`},title:je.jk.getDisplayTitle(t),className:As()({"visual-tab":!0,selected:o===n.id,"active-page":i})},s,Uoe("div",{className:"visual-tab-favicon-container"},void 0,Uoe(Ss,{className:"visual-tab-favicon",url:r||a,loadType:r?"faviconFromCache":"page"})))}))),Uoe(Foe,{page:n,listType:"visual"}))};render(){return H.Z.get($.kTabsVisualSwitchListLayout)?this.renderMinimalList():this.renderVisualList()}}const Goe=zoe;var $oe;function Koe(e,t,n,s){$oe||($oe="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:$oe,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const joe=function({windowId:e,workspaceId:t,onClose:n}){const s=Kj.Z.getWorkspaceById(e,t),i=s?.id?$q.Z.getWorkspaceRules(s.id).length:0,o=s?.name??"",a=ie.ZP.getWorkspacePages(t).size,r=a>0||i>0;return Koe("div",{className:"dialog-delete-workspace"},void 0,Koe("header",{className:"dialog-header"},void 0,Koe("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("Delete the “$1” workspace?",[o]))),r&&Koe("div",{className:"dialog-content"},void 0,a>0&&Koe("p",{className:"error"},void 0,(0,Oe.Z)("Deleting the workspace will close the $1 tab inside it.","Deleting the workspace will close the $1 tabs inside it.",[a])),a>0&&i>0&&Koe("p",{className:"error"},void 0,(0,Oe.Z)("It will also delete the $1 link route associated with it.","It will also delete the $1 link routes associated with it.",[i])),0===a&&i>0&&Koe("p",{className:"error"},void 0,(0,Oe.Z)("Deleting the workspace will delete the $1 link route associated with it.","Deleting the workspace will delete the $1 link routes associated with it.",[i]))),Koe("footer",{className:"dialog-footer"},void 0,Koe("input",{type:"button",className:"danger",value:(0,Oe.Z)("verb","Delete"),onClick:async()=>{await kq.Z.removeWorkspace(e,t),n()}}),Koe("input",{type:"button",value:(0,Oe.Z)("Cancel"),autoFocus:!0,onClick:n})))};var Yoe;function Xoe(e,t,n,s){Yoe||(Yoe="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Yoe,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Qoe extends hs.Component{static contextType=xi.Z;refVisualTabSwitcher=hs.createRef();handleClose=e=>{const{dialog:t,onClose:n}=this.props;return e!==t?Promise.resolve():n()};render(){const{dialog:e,options:t}=this.props;let n="float";switch(e){case"MAIN_SHOW_TAB_CYCLER":n="modal-tabswitcher";break;case"MAIN_SHOW_QUICKCOMMANDS":n="qc-modal float top";break;case"MAIN_SHOW_KEYBOARDS_SHORTCUTS":n="show-keyboard-shortcuts-modal-top float top";break;case"MAIN_SHOW_PAGE_ACCESS_KEYS":n="page-access-keys";break;case"MAIN_SHOW_MAIL_ACCOUNT_DIALOG":case"MAIN_SHOW_CALENDAR_ACCOUNT_DIALOG":n="onboarding";break;case"MAIN_SHOW_CALENDAR_EDIT_EVENT":case"MAIN_SHOW_CALENDAR_EDIT_TEMPLATE":case"MAIN_SHOW_CREATE_CALENDAR_DIALOG":case"MAIN_SHOW_CALENDAR_IMPORT_EVENTS_DIALOG":n="calendar-new";break;case"MAIN_SHOW_ACCOUNT_SHEET":n="slide";break;case"MAIN_SHOW_CALENDAR_ALARM":n=t.fullscreen?"calendar-fullscreen-alarm":"calendar-alarm";break;case"MAIN_SHOW_WORKSPACE_DIALOG":n="workspace-new float";break;case"MAIN_SHOW_NOTE_SELECTION_DIALOG":n="note-selection-dialog"}return Xoe(fp,{level:"tabs"},void 0,Xoe(_r.Z,{onRequestClose:this.handleClose.bind(this,e),viewMode:n,ignoreClickOutside:"MAIN_SHOW_CALENDAR_ALARM"===e},void 0,"MAIN_SHOW_QUICKCOMMANDS"===e&&Xoe(_oe,{onClose:this.handleClose.bind(this,e),quickCommandValue:this.props.quickCommandValue,storeQuickCommandValue:this.props.storeQuickCommandSearch},"MAIN_SHOW_QUICKCOMMANDS"),"MAIN_SHOW_KEYBOARDS_SHORTCUTS"===e&&Xoe(xoe,{onClose:this.handleClose.bind(this,e)},"MAIN_SHOW_KEYBOARDS_SHORTCUTS"),"MAIN_SHOW_PAGE_ACCESS_KEYS"===e&&Xoe(Lie,{onClose:this.handleClose.bind(this,e)},"MAIN_SHOW_PAGE_ACCESS_KEYS"),"MAIN_SHOW_TAB_CYCLER"===e&&(0,fs.jsx)(Goe,{ref:this.refVisualTabSwitcher,forward:t.forward},"MAIN_SHOW_TAB_CYCLER"),"MAIN_SHOW_CALENDAR_ALARM"===e&&Xoe(Pse,{onClose:this.handleClose.bind(this,e),windowToRestore:t.windowToRestore},"MAIN_SHOW_CALENDAR_ALARM"),"MAIN_SHOW_CALENDAR_EDIT_EVENT"===e&&Xoe(dse,{event:t.event,onClose:this.handleClose.bind(this,e)}),"MAIN_SHOW_CALENDAR_EDIT_TEMPLATE"===e&&(0,fs.jsx)(use,{...t,onClose:this.handleClose.bind(this,e)}),"MAIN_SHOW_CALENDAR_IMPORT_EVENTS_DIALOG"===e&&Xoe(mse,{windowId:this.context.vivaldiWindowId,filePath:t.uri,onClose:this.handleClose.bind(this,e)}),"MAIN_SHOW_CREATE_CALENDAR_DIALOG"===e&&Xoe(jse,{windowId:this.context.vivaldiWindowId,onClose:this.handleClose.bind(this,e)}),"MAIN_SHOW_MAIL_AUTHENTICATION_DIALOG"===e&&Xoe(mie,{onClose:this.handleClose.bind(this,e),options:t}),"MAIN_SHOW_MAIL_DELETE_DIALOG_ACCOUNTS"===e&&Xoe(bie,{windowId:this.context.vivaldiWindowId,onClose:this.handleClose.bind(this,e),options:t}),"MAIN_SHOW_MAIL_DELETE_DIALOG_CONFIRM_ALL"===e&&Xoe(Sie,{windowId:this.context.vivaldiWindowId,onClose:this.handleClose.bind(this,e),options:t}),"MAIN_SHOW_MAIL_DELETE_DIALOG_FOLDERS"===e&&Xoe(Iie,{windowId:this.context.vivaldiWindowId,onClose:this.handleClose.bind(this,e),options:t}),"MAIN_SHOW_MAIL_DELETE_DIALOG_SETTING"===e&&Xoe(kie,{windowId:this.context.vivaldiWindowId,onClose:this.handleClose.bind(this,e),options:t}),"MAIN_SHOW_MAIL_UNSUBSCRIBE_DIALOG"===e&&Xoe(Eie,{onClose:this.handleClose.bind(this,e),options:t}),"MAIN_SHOW_MODAL_DIALOG"===e&&Xoe(yse,{onClose:this.handleClose.bind(this,e),modal:t.modal,resolve:t.resolve}),"MAIN_SHOW_MODAL_INFO"===e&&Xoe(SA,{onClose:t=>{this.handleClose(e)},title:t.title,prompt:[t.body],positive:(0,Oe.Z)("Close"),hideNegative:!0}),"MAIN_SHOW_ADD_FEED"===e&&Xoe(Pc,{onClose:this.handleClose.bind(this,e),options:t,dismissable:!0},e),"MAIN_SHOW_ADD_MAIL_FOLDER"===e&&Xoe(tse,{onClose:this.handleClose.bind(this,e),options:t,dismissable:!0},e),"MAIN_SHOW_CREATE_LABEL"===e&&Xoe(Kf,{windowId:this.context.vivaldiWindowId,onClose:this.handleClose.bind(this,e),viewMode:"float"},e),"MAIN_SHOW_DELETE_MAIL_FOLDER"===e&&Xoe(qse,{onClose:this.handleClose.bind(this,e),options:t,dismissable:!0},e),"MAIN_SHOW_DELETE_WORKSPACE"===e&&Xoe(joe,{windowId:this.context.vivaldiWindowId,workspaceId:t.workspaceId,onClose:this.handleClose.bind(this,e)},e),"MAIN_SHOW_DELETE_LABEL_CONFIRMATION"===e&&Bse({dialog:e,handleClose:this.handleClose,label:t.label,callback:t.callback}),"MAIN_SHOW_DELETE_FILTER_CONFIRMATION"===e&&Ose({dialog:e,handleClose:this.handleClose,label:t.label,callback:t.callback}),"MAIN_SHOW_MAIL_VIEW_FILTER_CONFIRMATION"===e&&zse({dialog:e,handleClose:this.handleClose,label:t.label,callback:t.callback}),"MAIN_SHOW_MAIL_UPLOAD_CONFIRMATION"===e&&Wse({dialog:e,handleClose:this.handleClose,accountId:t.accountId,callback:t.callback}),"MAIN_SHOW_MAIL_MESSAGE_MOVE_CONFIRMATION"===e&&Xoe(SA,{onClose:n=>{t.callback(n),this.handleClose(e)},title:t.title,prompt:[t.body],positive:(0,Oe.Z)("Move All Messages"),negative:(0,Oe.Z)("Cancel"),danger:!0}),"MAIN_SHOW_MAIL_CREATE_ARCHIVE_FOLDER_CONFIRMATION"===e&&Xoe(SA,{onClose:n=>{t.callback(n),this.handleClose(e)},title:t.title,prompt:[t.body],positive:(0,Oe.Z)("Create Archive Folder"),negative:(0,Oe.Z)("Cancel")}),"MAIN_SHOW_ACCOUNT_SHEET"===e&&Xoe(sX,{onClose:this.handleClose.bind(this,e),view:t,autoFocus:!0},e),"MAIN_SHOW_MAIL_ACCOUNT_DIALOG"===e&&Xoe(hie,{onClose:this.handleClose.bind(this,e)},e),"MAIN_SHOW_CALENDAR_ACCOUNT_DIALOG"===e&&Xoe(ose,{windowId:this.context.vivaldiWindowId,onClose:this.handleClose.bind(this,e)},e),"MAIN_SHOW_WORKSPACE_DIALOG"===e&&Xoe(_q,{windowId:this.context.vivaldiWindowId,onClose:this.handleClose.bind(this,e),createInBackground:t.createInBackground}),"MAIN_SHOW_NOTE_SELECTION_DIALOG"===e&&Xoe(Nie,{windowId:this.context.vivaldiWindowId,onClose:()=>this.handleClose(e),onSelected:t.onSelected}),"MAIN_SHOW_ENABLE_WORKSPACE_DIALOG"===e&&Xoe(aie,{options:t,onClose:()=>this.handleClose(e)}),"MAIN_SHOW_ENABLE_SESSION_AUTOSAVE_DIALOG"===e&&Xoe(iie,{options:t,onClose:()=>this.handleClose(e)}),"MAIN_SHOW_INCLUDE_WORKSPACE_DIALOG"===e&&Xoe(lie,{options:t,onClose:()=>this.handleClose(e)})))}}const qoe=Qoe;class Joe extends Ol.Z{dispatchAction(e){switch(e.actionType){case"MAIN_SHOW_CLEAR_BROWSING_HISTORY_DIALOG":case"MAIN_SHOW_MAIL_ACCOUNT_DIALOG":case"MAIN_SHOW_CALENDAR_ACCOUNT_DIALOG":case"MAIN_SHOW_CREATE_CALENDAR_DIALOG":case"MAIN_SHOW_IMPORT_DATA_DIALOG":case"MAIN_SHOW_KEYBOARDS_SHORTCUTS":case"MAIN_SHOW_PAGE_ACCESS_KEYS":case"MAIN_SHOW_OPEN_SESSION_DIALOG":case"MAIN_SHOW_QUICKCOMMANDS":case"MAIN_SHOW_PRIVACY_STATS":case"MAIN_SHOW_CREATE_LABEL":this.emitChange({winId:e.winId,type:e.actionType});break;case"MAIN_SELECTING_TOOLBAR":this.emitChange({winId:e.winId,type:"MAIN_SELECTING_TOOLBAR",options:e.options});break;case"MAIN_SHOW_CONFIRM_OPEN_LINKS_DIALOG":this.emitChange({winId:e.winId,type:"MAIN_SHOW_CONFIRM_OPEN_LINKS_DIALOG",options:e.options});break;case"MAIN_SHOW_CONFIRM_CLOSE_OTHER_TABS_DIALOG":this.emitChange({winId:e.winId,type:"MAIN_SHOW_CONFIRM_CLOSE_OTHER_TABS_DIALOG",options:e.options});break;case"MAIN_SHOW_BOOKMARK_DIALOG":this.emitChange({winId:e.winId,type:"MAIN_SHOW_BOOKMARK_DIALOG",options:e.options});break;case"MAIN_SHOW_SAVE_SESSION_DIALOG":this.emitChange({winId:e.winId,type:"MAIN_SHOW_SAVE_SESSION_DIALOG",options:e.options});break;case"MAIN_SHOW_ADD_FEED":this.emitChange({winId:e.winId,type:"MAIN_SHOW_ADD_FEED",options:e.options});break;case"MAIN_SHOW_ADD_MAIL_FOLDER":this.emitChange({winId:e.winId,type:"MAIN_SHOW_ADD_MAIL_FOLDER",options:e.options});break;case"MAIN_SHOW_DELETE_MAIL_FOLDER":this.emitChange({winId:e.winId,type:"MAIN_SHOW_DELETE_MAIL_FOLDER",options:e.options});break;case"MAIN_SHOW_DELETE_WORKSPACE":this.emitChange({winId:e.winId,type:"MAIN_SHOW_DELETE_WORKSPACE",options:e.options});break;case"MAIN_SHOW_WORKSPACE_DIALOG":this.emitChange({winId:e.winId,type:"MAIN_SHOW_WORKSPACE_DIALOG",options:e.options});break;case"MAIN_SHOW_NOTE_SELECTION_DIALOG":this.emitChange({winId:e.winId,type:"MAIN_SHOW_NOTE_SELECTION_DIALOG",options:e.options});break;case"MAIN_SHOW_MAIL_AUTHENTICATION_DIALOG":this.emitChange({winId:e.winId,type:"MAIN_SHOW_MAIL_AUTHENTICATION_DIALOG",options:e.options});break;case"MAIN_SHOW_MAIL_UNSUBSCRIBE_DIALOG":this.emitChange({winId:e.winId,type:"MAIN_SHOW_MAIL_UNSUBSCRIBE_DIALOG",options:e.options});break;case"MAIN_SHOW_MAIL_DELETE_DIALOG_ACCOUNTS":this.emitChange({winId:e.winId,type:"MAIN_SHOW_MAIL_DELETE_DIALOG_ACCOUNTS",options:e.options});break;case"MAIN_SHOW_MAIL_DELETE_DIALOG_CONFIRM_ALL":this.emitChange({winId:e.winId,type:"MAIN_SHOW_MAIL_DELETE_DIALOG_CONFIRM_ALL",options:e.options});break;case"MAIN_SHOW_DELETE_LABEL_CONFIRMATION":this.emitChange({winId:e.winId,type:"MAIN_SHOW_DELETE_LABEL_CONFIRMATION",options:e.options});break;case"MAIN_SHOW_DELETE_FILTER_CONFIRMATION":this.emitChange({winId:e.winId,type:"MAIN_SHOW_DELETE_FILTER_CONFIRMATION",options:e.options});break;case"MAIN_SHOW_MAIL_VIEW_FILTER_CONFIRMATION":this.emitChange({winId:e.winId,type:"MAIN_SHOW_MAIL_VIEW_FILTER_CONFIRMATION",options:e.options});break;case"MAIN_SHOW_MAIL_UPLOAD_CONFIRMATION":this.emitChange({winId:e.winId,type:"MAIN_SHOW_MAIL_UPLOAD_CONFIRMATION",options:e.options});break;case"MAIN_SHOW_MAIL_MESSAGE_MOVE_CONFIRMATION":this.emitChange({winId:e.winId,type:"MAIN_SHOW_MAIL_MESSAGE_MOVE_CONFIRMATION",options:e.options});break;case"MAIN_SHOW_MAIL_CREATE_ARCHIVE_FOLDER_CONFIRMATION":this.emitChange({winId:e.winId,type:"MAIN_SHOW_MAIL_CREATE_ARCHIVE_FOLDER_CONFIRMATION",options:e.options});break;case"MAIN_SHOW_MAIL_DELETE_DIALOG_FOLDERS":this.emitChange({winId:e.winId,type:"MAIN_SHOW_MAIL_DELETE_DIALOG_FOLDERS",options:e.options});break;case"MAIN_SHOW_MAIL_DELETE_DIALOG_SETTING":this.emitChange({winId:e.winId,type:"MAIN_SHOW_MAIL_DELETE_DIALOG_SETTING",options:e.options});break;case"MAIN_SHOW_ACCOUNT_SHEET":this.emitChange({winId:e.winId,type:"MAIN_SHOW_ACCOUNT_SHEET",options:e.options});break;case"MAIN_SHOW_CALENDAR_ALARM":this.emitChange({winId:e.winId,type:"MAIN_SHOW_CALENDAR_ALARM",options:e.options});break;case"MAIN_SHOW_CALENDAR_EDIT_EVENT":this.emitChange({winId:e.winId,type:"MAIN_SHOW_CALENDAR_EDIT_EVENT",options:e.options});break;case"MAIN_SHOW_CALENDAR_EDIT_TEMPLATE":this.emitChange({winId:e.winId,type:"MAIN_SHOW_CALENDAR_EDIT_TEMPLATE",options:e.options});break;case"MAIN_SHOW_CALENDAR_IMPORT_EVENTS_DIALOG":this.emitChange({winId:e.winId,type:"MAIN_SHOW_CALENDAR_IMPORT_EVENTS_DIALOG",options:e.options});break;case"MAIN_SHOW_MODAL_DIALOG":this.emitChange({winId:e.winId,type:"MAIN_SHOW_MODAL_DIALOG",options:e.options});break;case"MAIN_SHOW_MODAL_INFO":this.emitChange({winId:e.winId,type:"MAIN_SHOW_MODAL_INFO",options:e.options});break;case"MAIN_SHOW_DIALOG":this.emitChange({winId:e.winId,type:e.actionType,options:e.options,onAfterClose:e.onAfterClose});break;case"MAIN_SHOW_BOOKMARK_ADDED_POPUP":this.emitChange({winId:e.winId,type:"MAIN_SHOW_BOOKMARK_ADDED_POPUP",options:e.options});break;case"MAIN_SHOW_ENABLE_SESSION_AUTOSAVE_DIALOG":this.emitChange({type:"MAIN_SHOW_ENABLE_SESSION_AUTOSAVE_DIALOG",winId:e.winId,options:e.options});break;case"MAIN_SHOW_ENABLE_WORKSPACE_DIALOG":this.emitChange({winId:e.winId,type:"MAIN_SHOW_ENABLE_WORKSPACE_DIALOG",options:e.options});break;case"MAIN_SHOW_INCLUDE_WORKSPACE_DIALOG":this.emitChange({winId:e.winId,type:"MAIN_SHOW_INCLUDE_WORKSPACE_DIALOG",options:e.options})}}}const eae=new Joe(y.Z);var tae,nae=n(18237),sae=n(14022);function iae(e,t,n,s){tae||(tae="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:tae,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class oae extends hs.PureComponent{static contextType=xi.Z;state={dummy:!1};onHistoryClicked=e=>{e.stopPropagation(),this.props.onToggleHistory(this.props.node.id)};render(){const{node:e}=this.props,t=nae.ZP.isTrashFolder(e.id),n="history"===e.type,s=nae.ZP.isHistoryParent(e.id);return iae("div",{style:{minHeight:`${this.props.height}px`},className:"SessionItem-Wrapper",title:sae.Z.getTooltipString(e)},void 0,!t&&!n&&(0,fs.jsxs)(fs.Fragment,{children:[iae("div",{className:"SessionItem-Entry"},void 0,void 0!==this.props.inlineEditText?iae("input",{type:"text",value:this.props.inlineEditText,onChange:this.props.onChange,onFocus:this.props.onFocus,onBlur:this.props.onBlur,autoFocus:!0}):iae("div",{className:"SessionItem-Title"},void 0,sae.Z.getNameString(e)),iae("div",{className:"SessionItem-Info"},void 0,sae.Z.getContentString(e)),iae("div",{className:"SessionItem-Date"},void 0,sae.Z.getDateModifyString(e))),s&&iae("button",{type:"button",className:"ActionButton",onClick:this.onHistoryClicked,title:(0,Oe.Z)("Show history"),tabIndex:"-1",dangerouslySetInnerHTML:{__html:Ts.V34}})]}),!t&&n&&iae("div",{className:"SessionItem-Entry"},void 0,iae("div",{className:"SessionItem-Info"},void 0,sae.Z.getContentString(e)),iae("div",{className:"SessionItem-Date"},void 0,sae.Z.getDateModifyString(e))),t&&void 0===this.props.inlineEditText&&iae("span",{className:"SessionItem-Title"},void 0,sae.Z.getNameString(e)))}}const aae=oae;var rae;function lae(e,t,n,s){rae||(rae="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:rae,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function dae(e,t){const n=function(e,s){const i={id:e.id,containerId:e.containerId,type:e.type,name:e.name,createDateJS:e.createDateJS,modifyDateJS:e.modifyDateJS,windows:e.windows,tabs:e.tabs,quarantined:e.quarantined,workspaces:e.workspaces,parentId:e.parentId,index:s};if(e.children){if(!t&&"folder"===e.type)return;i.children=e.children.map(((e,t)=>n(e,t))).filter(Boolean)}return i},s=nae.ZP.getFiltered(e).map(((e,t)=>n(e,t))).filter(Boolean);return 1===s.length&&nae.ZP.isTrashFolder(s[0].id)&&!s[0].children?.length?[]:s}class cae extends hs.PureComponent{static contextType=xi.Z;refTreeList=hs.createRef();id=crypto.randomUUID();checkSelection=!0;historyIds=[];constructor(e){super(e),this.state={nodes:dae(e.filter,e.showFolders)}}componentDidMount(){nae.ZP.addListener(this.onStoreChanged),nae.ZP.hasSessions()&&this.focusTree(),this.setInitialSelection(),this.reportContentCount()}componentWillUnmount(){nae.ZP.removeListener(this.onStoreChanged)}componentDidUpdate(e){this.props.filter!==e.filter&&this.setState({nodes:dae(this.props.filter,this.props.showFolders)},(()=>this.reportContentCount()))}onStoreChanged=e=>{switch(e.reason){case"init":this.setState({nodes:dae(this.props.filter,this.props.showFolders)},(()=>this.setInitialSelection()));break;case"added":this.setState({nodes:dae(this.props.filter,this.props.showFolders)},(()=>{e.info&&e.owner===this.id?this.selectById(e.info.item.id):this.setInitialSelection(),this.reportContentCount()}));break;case"changed":case"moved":this.setState({nodes:dae(this.props.filter,this.props.showFolders)});break;case"deleted":this.setState({nodes:dae(this.props.filter,this.props.showFolders)},(()=>{this.state.nodes.length||(this.checkSelection=!0),this.reportContentCount()}))}};setInitialSelection=()=>{this.checkSelection&&this.state.nodes.length>0&&(0===this.getSelected().length&&(this.refTreeList.current?.setSelectedIds([this.state.nodes[0].id]),this.reportSelectionState()),this.checkSelection=!1)};reportContentCount=()=>{this.props.onContentCount&&this.props.onContentCount(this.state.nodes.length)};reportSelectionState=()=>{this.props.onSelectionState&&this.props.onSelectionState(this.getSelected().length>0)};getNodeById=e=>{const t=function(n){for(let s=0;s<n.length;s++){const i=n[s];if(i.id===e)return i;if(i.children){const e=t(i.children);if(e)return e}}};return t(this.state.nodes)};isPanel=()=>!this.props.columns;focusTree=()=>{this.refTreeList.current?.focusTree()};isFolder=e=>"folder"===e.type||this.isHistoryParent(e);isTrashFolder=e=>nae.ZP.isTrashFolder(e.id);isHistoryParent=e=>"node"===e.type&&Boolean(e.children);isHistoryChild=e=>"history"===e.type;canMoveUpDown=(e,t)=>!this.isTrashFolder(e)&&!this.isHistoryChild(e);hasChildren=e=>this.isFolder(e)&&Boolean(e.children?.length);hasHistoryId=e=>-1!==e.containerId;isValidForEdit=e=>!nae.ZP.isTrash(e,!0)&&!nae.ZP.isHistoryChild(e);allowDoubleClick=e=>!this.isFolder(e)||this.isHistoryParent(e);isValidDragSource=e=>!this.isTrashFolder(e);validateForDrag=e=>{const t=e.filter((e=>!nae.ZP.isTrashFolder(e))).map((e=>this.getNodeById(e))).filter(Boolean),n=t.some((e=>this.hasHistoryId(e))),s=t.some((e=>!this.hasHistoryId(e)));return n&&s||n&&t.some((e=>-1===e.containerId||e.containerId!==t[0].containerId))?[]:t.map((e=>e.id))};getDragData=(e,t)=>{const n=t.map((e=>this.getNodeById(e))).filter(Boolean);switch(e){case"text/plain":case"vivaldi/x-title":{const e=[];return n.forEach((t=>{e.push(t.name)})),e.join("\r\n")}default:return""}};setDragData=(e,t)=>{const n=t.map((e=>this.getNodeById(e))).filter(Boolean);n.some((e=>this.hasHistoryId(e)))?(this.historyIds=n.map((e=>e.containerId)),e.setData(nae.iq,JSON.stringify(n.map((e=>e.id))))):(this.historyIds=[],e.setData(nae.m8,JSON.stringify(n.map((e=>e.id)))))};getDropSupport=(e,t)=>{let n={available:!1,onto:!1,edge:"both"};return this.isHistoryParent(e)&&t.dataTransfer.types.some((e=>e===nae.iq))?this.historyIds.some((t=>t!==e.id))?n:{available:!0,onto:!0,edge:"none"}:this.isHistoryChild(e)?t.dataTransfer.types.some((e=>e===nae.iq))?this.historyIds.some((t=>t!==e.containerId))?n:{available:!0,onto:!1,edge:"both"}:n:t.dataTransfer.types.some((e=>e===nae.iq))?(this.isTrashFolder(e)?n={available:!0,onto:!0,edge:"none"}:nae.ZP.isTrash(e.id,!1)?n={available:!0,onto:!1,edge:"both"}:this.historyIds.some((t=>t===e.id))&&(n={available:!0,onto:!0,edge:"none"}),n):(this.isHistoryParent(e)&&this.refTreeList.current?.isExpanded(e.id)&&(n.edge="above"),n.available=t.dataTransfer.types.some((e=>e===nae.m8)),n.available&&(n.onto=this.isFolder(e)&&!this.isHistoryParent(e)),n)};getTargetSpec=(e,t)=>{const n={index:0,parentId:void 0,pageIndex:void 0};switch(t){case"above":n.index=parseInt(e.index),n.parentId=e.parentId;break;case"on":n.parentId=e.id;break;case"below":this.refTreeList.current&&this.refTreeList.current.isExpanded(e.id)?n.parentId=e.id:(n.index=parseInt(e.index)+1,n.parentId=e.parentId)}return n};handleExpandClick=(e,t)=>{const n=e.altKey;this.refTreeList.current?.toggleSelectedExpansion(t,n)};onMove=(e,t)=>void 0!==t.parentId?Kn.Z.move(e,t.parentId,t.index??0):Promise.resolve([]);getMenuCapability=async(e,t,n)=>{const s=this.context.vivaldiWindowId;switch(e.action){case"CONTEXT_OPEN_IN_NEW_WINDOW":return{handler:()=>this.onOpen(!0),isVisible:()=>this.getSelected().length>0&&!nae.ZP.isTrash(n.id,!0),...t(s,e,{})};case"CONTEXT_OPEN":return{handler:()=>this.onOpen(!1),isVisible:()=>this.getSelected().length>0&&!G.ZP.isIncognito(this.context.vivaldiWindowId)&&!nae.ZP.isTrash(n.id,!0),...t(s,e,{})};case"CONTEXT_UPDATE":return{handler:()=>{const e=this.getSelected().map((e=>e.id));1===e.length&&this.onUpdate(e[0])},isVisible:()=>1===this.getSelected().length&&!nae.ZP.isTrash(n.id,!0)&&!nae.ZP.isAutoSaveNode(n.id)&&!nae.ZP.isHistoryChild(n.id),...t(s,e,{})};case"CONTEXT_RESTORE":return{handler:()=>Kn.Z.restore(this.getSelected().map((e=>e.id))),isVisible:()=>nae.ZP.isTrash(n.id,!1)&&!nae.ZP.isTrashFolder(n.id),...t(s,e,{})};case"CONTEXT_EMPTY_TRASH":return{handler:()=>{Kn.Z.emptyTrash()},isVisible:()=>nae.ZP.isTrashFolder(n.id),...t(s,e,{})};case"CONTEXT_DUPLICATE":return{handler:()=>{Kn.Z.duplicate(n.id,nae.ZP.getRootId(),0,this.id)},isVisible:()=>nae.ZP.isHistoryChild(n.id),...t(s,e,{})};case"CONTEXT_MOVE_TO_TOP":return{handler:()=>{const e=this.getSelected().map((e=>e.id));1===e.length&&Kn.Z.makeContainer(e[0]).then((()=>{this.refTreeList.current?.setSelectedIds([n.parentId])}))},isVisible:()=>1===this.getSelected().length&&this.isHistoryChild(n),...t(s,e,{})};case"CONTEXT_AUTOMATIC_BACKUP":return{handler:()=>{"on"===H.Z.get($.kSessionsSaveOnExit)?Ne.Z.set($.kSessionsSaveOnExit,"off"):Ae.Z.showEnableSessionAutosaveDialog(s,{mode:"size"})},checked:"on"===H.Z.get($.kSessionsSaveOnExit),...t(s,e,{})};case"CONTEXT_AUTOSAVE_SIZE":return{handler:()=>{},isVisible:()=>!1,...t(s,e,{})};case"CONTEXT_HISTORY":return{handler:()=>{this.refTreeList.current?.toggleSelectedExpansion(n.id,!1)},isVisible:()=>this.isHistoryParent(n),checked:Boolean(this.refTreeList.current?.isExpanded(n.id)),...t(s,e,{})};default:return{...t(s,e,{})}}};getMenuVisibility=(e,t)=>{switch(e.action){case"CONTEXT_NEW_ITEM":return!nae.ZP.isTrash(t.id,!0);case"CONTEXT_RENAME":return 1===this.getSelected().length&&this.isValidForEdit(t.id);case"CONTEXT_EDIT":return 1===this.getSelected().length&&!this.isTrashFolder(t);case"CONTEXT_DELETE":return this.getSelected().length>0&&!nae.ZP.isTrashFolder(t.id)}return!0};getSelected=()=>(this.refTreeList.current?.getAllSelectedItems()??[]).map((e=>this.getNodeById(e.id))).filter(Boolean);selectById=e=>{this.refTreeList.current?.selectById(e)};onKeyDown=e=>{"Enter"===HT.Z[e.keyCode]&&this.onOpen(!!this.isPanel()||void 0),("Escape"===HT.Z[e.keyCode]||"."===HT.Z[e.keyCode]&&e.metaKey)&&this.props.onClose&&this.props.onClose(),"Up"!==HT.Z[e.keyCode]&&"Down"!==HT.Z[e.keyCode]||this.reportSelectionState()};add=()=>{this.refTreeList.current?.onAdd("item")};onCreate=async(e,t,n,s)=>new Promise((e=>{Ae.Z.showSaveSessionDialog(this.context.vivaldiWindowId,{mode:"all",parentId:t??-1,index:n??-1,owner:this.id,onClose:t=>{e()}})}));onUpdate=async e=>new Promise((t=>{Ae.Z.showSaveSessionDialog(this.context.vivaldiWindowId,{mode:"all",updateId:e,onClose:e=>{t()}})}));onEdit=()=>{const e=this.getSelected().map((e=>e.id));1===e.length&&this.props.onEdit&&this.props.onEdit(e[0])};deleteSelected=()=>this.refTreeList.current?.onDelete()||Promise.reject();onDelete=e=>Kn.Z.remove(e);onOpen=e=>{const t=this.getSelected().filter((e=>!nae.ZP.isTrash(e.id,!1))).map((e=>e.id));this.props.onOpen(t)};getRowHeight=e=>this.getRowHeightById(this.refTreeList.current?.getId(e.index)??-1);getRowHeightById=e=>nae.ZP.isTrashFolder(e)?uo:nae.ZP.isHistoryChild(e)?46:70;getRowComponentProps=e=>({...e,columns:this.props.columns??[]});rowComponent=e=>{const t=e.node,n=nae.ZP.isTrashFolder(t.id),s=nae.ZP.isTrash(t.id,!1),i=this.hasHistoryId(t),o=e.level,a=(o+1)*mo+"px",r=o*mo+"px";return this.isPanel()?lae("div",{className:As()("SessionItem",{"SessionItem-Trash":n,"SessionItem-Trashed":s})},t.id,n&&this.hasChildren(t)&&lae("span",{className:"expand-icon",style:{marginLeft:r},onMouseUp:e=>this.handleExpandClick(e,t.id),dangerouslySetInnerHTML:{__html:Ts.nfH}}),n&&lae(Ps,{trash:!0,open:e.isExpanded,leftMargin:this.hasChildren(t)?0:a}),(s||i)&&lae("span",{style:{marginLeft:r},className:"tree-icon"}),lae(aae,{node:t,height:this.getRowHeightById(t.id),inlineEditText:e.inlineEditText,onChange:e.onChange,onFocus:e.onFocus,onBlur:e.onBlur,onToggleHistory:e=>{this.refTreeList.current?.toggleSelectedExpansion(e,!1)}})):n?null:(this.props.columns??[]).map((e=>{switch(e.id){case"name":return lae("label",{},"0",lae("span",{},void 0,sae.Z.getNameString(t)));case"createDateJS":return lae("label",{},"1",lae("span",{},void 0,sae.Z.getDateCreateString(t)));case"modifyDateJS":return lae("label",{},"2",lae("span",{},void 0,sae.Z.getDateModifyString(t)));case"tabs":return lae("label",{},"3",lae("span",{},void 0,sae.Z.getContentString(t)));default:console.warn("Unknown sorting field:",e.id)}})).filter(Boolean)};onItemDoubleClick=()=>this.onOpen(!!this.isPanel()||void 0);onItemsActivated=()=>this.onOpen(!!this.isPanel()||void 0);menu={name:"sessionlist",getCapability:this.getMenuCapability,getVisibility:this.getMenuVisibility};render(){return(0,fs.jsx)(yo,{ref:this.refTreeList,rootId:nae.ZP.getRootId(),nodes:this.state.nodes,settings:this.isPanel()?"SETTINGS_TREE":void 0,rowComponent:this.rowComponent,getRowComponentProps:this.getRowComponentProps,overrideDoubleClick:this.allowDoubleClick,onItemMouseDown:this.reportSelectionState,onItemDoubleClick:this.onItemDoubleClick,onItemsActivated:this.onItemsActivated,onMove:this.onMove,onKeyDown:this.onKeyDown,onCreate:this.onCreate,onEdit:this.onEdit,delete:this.isPanel()?this.onDelete:void 0,isFolder:this.isFolder,isTrashFolder:this.isTrashFolder,hasChildren:this.hasChildren,supportsUpDownMove:this.canMoveUpDown,getTitle:nae.ZP.getTitle,saveTitle:Kn.Z.setTitle,disableClipboard:!0,isValidToEdit:this.isValidForEdit,isValidDragSource:this.isValidDragSource,validateForDrag:this.validateForDrag,mimeType:nae.m8,setCustomDragData:this.setDragData,getDragData:this.getDragData,getDropSupport:this.getDropSupport,getTargetSpec:this.getTargetSpec,menu:this.isPanel()?this.menu:void 0,supportsInlineEdit:!0,multiSelect:!0,sorting:this.props.sorting,columns:this.props.columns,rowHeight:this.isPanel()?this.getRowHeight:void 0})}}const hae=cae;var pae;function uae(e,t,n,s){pae||(pae="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:pae,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const gae=[$.kSessionsDialogSorting,$.kKeyboardTabToAll],mae={width:800,minWidth:"unset"},vae=[{text:(0,Oe.Z)("title","Name"),value:"name",fullScreenTitle:(0,Oe.Z)("Sort by Name"),width:350,visible:!0,key:!0},{text:(0,Oe.Z)("Creation Date"),value:"createDateJS",fullScreenTitle:(0,Oe.Z)("Sort by Creation Date"),width:260,visible:!0},{text:(0,Oe.Z)("Modified Date"),value:"modifyDateJS",fullScreenTitle:(0,Oe.Z)("Sort by Modifcation Date"),width:260,visible:!1},{text:(0,Oe.Z)("Info"),value:"tabs",fullScreenTitle:(0,Oe.Z)("Sort by Info"),width:150,visible:!0}];class fae extends hs.Component{static contextType=xi.Z;refSessionTree=hs.createRef();constructor(e){super(e);const t=this.props.prefValues[$.kSessionsDialogSorting];this.state={columns:io().sessions||oo(vae),hasSelection:!1,hasContent:!0,sorting:{sortOrder:t.sortOrder,sortField:t.sortField,comparator:this.sortComparator}}}sortComparator=(e,t)=>{const{sortOrder:n,sortField:s}=this.state.sorting;return Xi.Z.getDefaultComparator(n,s)(e,t)};getSelected=()=>this.refSessionTree.current?.getSelected()??[];onContentCount=e=>{this.setState({hasContent:e>0})};onSelectionState=e=>{this.setState({hasSelection:e})};onDelete=()=>{Kn.Z.remove(this.getSelected().map((e=>e.id)))};onOpen=e=>{Kn.Z.open(this.context.vivaldiWindowId,e,!0),this.props.onClose()};onSortChange=(e,t)=>{this.setState((n=>({sorting:{sortOrder:e,sortField:t,comparator:n.sorting.comparator}}))),Ne.Z.set($.kSessionsDialogSorting,{sortOrder:e,sortField:t})};onUpdateRow=e=>{this.setState({columns:e})};onSaveRow=()=>{so(this.state.columns,"sessions")};render(){return uae(_r.Z,{onRequestClose:this.props.onClose,style:mae},void 0,uae("div",{className:"open-session"},void 0,uae("form",{className:"dialog-session",onSubmit:()=>{this.onOpen(this.getSelected().map((e=>e.id)))}},void 0,uae("header",{className:"dialog-header"},void 0,uae("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("Open Session"))),uae("div",{className:"dialog-content"},void 0,this.state.hasContent?uae("div",{className:"session-list"},void 0,uae(gv,{fields:vae,fullsize:!0,onSortChange:this.onSortChange,onSaveRow:this.onSaveRow,onUpdateRow:this.onUpdateRow,columns:this.state.columns,sortField:this.state.sorting.sortField,sortOrder:this.state.sorting.sortOrder,keyAccess:this.props.prefValues[$.kKeyboardTabToAll],manualSorting:!1}),(0,fs.jsx)(hae,{ref:this.refSessionTree,filter:"",showFolders:!1,columns:this.state.columns,sorting:this.state.sorting,onOpen:this.onOpen,onClose:this.props.onClose,onContentCount:this.onContentCount,onSelectionState:this.onSelectionState})):uae("div",{},void 0,(0,Oe.Z)("No saved session."))),uae("footer",{className:"dialog-footer"},void 0,uae("input",{type:"submit",disabled:!this.state.hasSelection,value:(0,Oe.Z)("session","Open")}),uae("input",{type:"button",onClick:this.props.onClose,value:(0,Oe.Z)("session","Cancel")})))))}}const yae=sa(fae,gae);var Cae,wae=n(34155);function bae(e,t,n,s){Cae||(Cae="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Cae,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Sae=[$.kBookmarksPanelEditorHeight],Iae=[{text:(0,Oe.Z)("Title"),value:"title",fullScreenTitle:(0,Oe.Z)("Sort by Title")},{text:(0,Oe.Z)("Address"),value:"url",fullScreenTitle:(0,Oe.Z)("Sort by Address")},{text:(0,Oe.Z)("Nickname"),value:"nickname",fullScreenTitle:(0,Oe.Z)("Sort by Nickname")},{text:(0,Oe.Z)("Description"),value:"description",fullScreenTitle:(0,Oe.Z)("Sort by Description")},{text:(0,Oe.Z)("Created"),value:"dateAdded",fullScreenTitle:(0,Oe.Z)("Sort by Date Created")}];class kae extends hs.PureComponent{static contextType=xi.Z;nodeRef=hs.createRef();#re=hs.createRef();#le=hs.createRef();state={filter:"",editorHeight:this.props.prefValues[$.kBookmarksPanelEditorHeight],failedUpgrade:!1,sorting:{sortOrder:Xi.Z.NO_SORTING,sortField:"manually",comparator:this.sortComparator},hasBookmark:!0};componentDidMount(){const e=H.Z.get($.kBookmarksPanelSorting);this.onSortChange(e.sortOrder,e.sortField),ud.ZP.addListener(this.onPanelStoreChange),ps.ZP.addListener(this.onBookmarkStoreChange)}componentWillUnmount(){ud.ZP.removeListener(this.onPanelStoreChange),ps.ZP.removeListener(this.onBookmarkStoreChange)}componentDidUpdate(e,t){!e.open&&this.props.open&&wae.nextTick((()=>this.focusTree()))}hasFocus=()=>{const{document:e,HTMLElement:t}=this.context,n=this.nodeRef.current;return n instanceof t&&sl(e,n)};onPanelStoreChange=()=>{const e=ud.ZP.getChangeReason();this.props.open&&"setFocus"===e&&!this.hasFocus()&&this.focusTree()};onBookmarkStoreChange=()=>{this.setState({failedUpgrade:ps.ZP.isFailedUpgrade()})};onSelect=e=>{this.#re.current?.setItem(e)};addBookmark=()=>{this.onAdd(!1)};addFolder=()=>{this.onAdd(!0)};onAdd=e=>{this.setState({filter:""}),this.state.editorHeight>h.mT&&this.#re.current?this.#re.current._save().then((()=>this.#le.current?.onAdd(e))):(this.setEditorVisible(),this.#le.current?.onAdd(e))};onCreate=e=>{e&&(this.setEditorVisible(),this.#re.current&&this.#re.current.setIsCreating(!0))};onEditorCanceled=(e,t)=>{t&&e&&this.#le.current?this.#le.current.deleteSelectedItems()?.then((()=>{s.Z.bookmarks.remove(e),this.focusTree()})):this.focusTree()};setEditorVisible=()=>{const e=this.state.editorHeight<230?Math.max(this.props.prefValues[$.kBookmarksPanelEditorHeight],230):this.state.editorHeight;this.updateEditorVisiblityWithHeight(e,!0)};focusTree=()=>{this.#le.current?.refTreeList.current?.focusTree()};deleteSelectedItems=()=>{this.#le.current?.deleteSelectedItems()};onSortChange=(e,t)=>{const n={sortOrder:e,sortField:t,comparator:this.sortComparator};this.setState({sorting:n});const s={sortOrder:e,sortField:t};Ne.Z.set($.kBookmarksPanelSorting,s)};sortComparator=(e,t)=>ps.ZP.treeSortComparator(e,t,this.state.sorting);getSelectedItem=()=>this.#le.current?.getSelectedItem();onContextMenu=e=>{e.nativeEvent.buttons>0&&this.#le.current?.unSelectAll(),this.#le.current?.onContextMenu(e)};onSearchChange=e=>{this.setState({filter:e.target.value})};onSlidebarPosition=(e,t)=>{this.setState((e=>({editorHeight:Math.max(Math.min(e.editorHeight-t,600),h.mT)})))};onSlideBarStop=()=>{this.updateEditorVisiblityWithHeight(this.state.editorHeight,!0)};onSlidebarToggle=()=>{const e=this.state.editorHeight>h.Cn?h.mT:230;this.updateEditorVisiblityWithHeight(e,!0)};updateEditorVisiblityWithHeight=(e,t)=>{e<h.Cn?e=h.mT:e>600&&(e=600),t&&Ne.Z.set($.kBookmarksPanelEditorHeight,e),this.setState({editorHeight:e})};renderEmptyState=()=>bae("div",{className:"panel-empty-state"},void 0,bae("span",{dangerouslySetInnerHTML:{__html:Ts.Zgq}}),bae("h1",{},void 0,(0,Oe.Z)("Add your first bookmark")),bae("p",{className:"faded-text"},void 0,(0,Oe.Z)("Click the “+” button to add a new bookmark.")));render(){if(!this.props.open)return null;const e=this.props.title+(this.state.failedUpgrade?" (needs upgrade)":"");return(0,fs.jsxs)("div",{ref:this.nodeRef,className:"panel panel-bookmarks",children:[bae("header",{},void 0,bae(Dm,{title:e,showCloseButton:this.props.showCloseButton}),bae("div",{className:"toolbar toolbar-default toolbar-wrap"},void 0,bae("input",{type:"search",placeholder:(0,Oe.Z)("verb","Search"),value:this.state.filter,disabled:!this.state.hasBookmark,onChange:this.onSearchChange}),bae("div",{className:"toolbar"},void 0,bae("div",{className:"toolbar-group"},void 0,bae(Fa,{onClick:this.addBookmark,tooltip:(0,Oe.Z)("New Bookmark"),image:Ts.md4.small}),bae(Fa,{onClick:this.deleteSelectedItems,tooltip:(0,Oe.Z)("other","Delete"),image:Ts.M2k.small})),bae(Fa,{onClick:this.addFolder,tooltip:(0,Oe.Z)("command","New Folder"),image:Ts._TQ.small})))),!this.state.hasBookmark&&this.renderEmptyState(),this.state.hasBookmark&&bae(gv,{fields:Iae,onSortChange:this.onSortChange,keyAccess:this.props.keyAccess,sortField:this.state.sorting.sortField,sortOrder:this.state.sorting.sortOrder}),bae("section",{onContextMenu:this.onContextMenu,className:this.state.hasBookmark?"outerScrollbar":"hide-bookmark-tree"},void 0,(0,fs.jsx)(B2,{ref:this.#le,filter:this.state.filter,fullView:!1,inManager:!1,onSelect:this.onSelect,onCreate:this.onCreate,sorting:this.state.sorting,onBookmarksUpdatedIsEmpty:e=>this.setState({hasBookmark:e})})),this.state.hasBookmark&&bae("section",{className:As()("panel-bookmarks-edit","limited",{collapsed:this.state.editorHeight===h.mT}),style:{flexBasis:this.state.editorHeight}},void 0,bae(lv,{onStop:this.onSlideBarStop,onSlidebarPosition:this.onSlidebarPosition,onDoubleClick:this.onSlidebarToggle,returnOffset:!0,position:"bottom"}),this.state.editorHeight>0&&(0,fs.jsx)(C2,{ref:this.#re,updateLayout:this.setEditorVisible,getSelectedItem:this.getSelectedItem,onCancel:this.onEditorCanceled,onFocusTree:this.focusTree}))]})}}const Aae=sa(kae,Sae);var Tae;function Zae(e,t,n,s){Tae||(Tae="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Tae,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Eae=[$.kCalendarDisplayDensity,$.kCalendarOnboardingShown],_ae=jL.G6;let Mae=!1;const Nae=()=>Gx.Z.viewPreviousPeriod(_ae),Pae=()=>Gx.Z.viewNextPeriod(_ae);function Dae(e){Gx.Z.selectDate(_ae,e)}const xae=e=>{Gx.Z.setViewMode(_ae,e)};function Oae(e){return Zae("div",{className:"panel-empty-state"},void 0,Zae("span",{dangerouslySetInnerHTML:{__html:Ts.VA7}}),Zae("h1",{},void 0,(0,Oe.Z)("Add your first calendar account")),Zae("p",{className:"faded-text"},void 0,(0,Oe.Z)("You can add a local or online calendar to Vivaldi Calendar.")),Zae("input",{type:"button",onClick:()=>Ae.Z.showCalendarAccountDialog(e.windowId),value:(0,Oe.Z)("Add Calendar Account")}))}function Lae(e){return Zae("div",{className:"panel-empty-state",onClick:e.onCreateEvent},void 0,Zae("span",{dangerouslySetInnerHTML:{__html:Ts.VA7}}),Zae("h1",{},void 0,(0,Oe.Z)("Your calendar is empty")),Zae("p",{className:"faded-text"},void 0,(0,Oe.Z)("Click the “+” button to add a new event.")))}function Rae(e){const t=hs.useContext(xi.Z),{stateHandler:n,calendarFilter:s,eventDraft:i,events:o,trashedEvents:a}=Z5(_ae),r=(0,na.Z)(Eae),l=hs.useMemo((()=>({pageId:_ae,displayDensity:r[$.kCalendarDisplayDensity],isPanel:!0,handler:n})),[r,n]);if(!e.open)return Mae=!1,null;function d(){n.editEvent(null,Rd.Z.minimalCreateEvent({}))}!1===Mae&&e.open&&(m.Z.pollAllCalDAVAccounts(!0),Mae=!0);const{anchorDate:c,selectedDate:h,displayMode:p}=s,u=Rd.Z.getDisplayRange(c,p),g=0===Bd.Z.getCalendars().length||!r[$.kCalendarOnboardingShown]&&!Bd.Z.getAccounts().some((e=>"local"!==e.account_type)),v=!i&&!Bd.Z.getEvents().length;return Zae("div",{className:"panel",id:"calendar_panel",onClick:function(e){e.stopPropagation(),i&&n.endEventEdit()}},void 0,Zae("header",{},void 0,Zae(Dm,{title:(0,Oe.Z)("Calendar"),showCloseButton:e.showCloseButton}),!g&&(0,fs.jsxs)(fs.Fragment,{children:[Zae("div",{className:"toolbar toolbar-default"},void 0,Zae(A5,{initialPeriod:c,setPeriod:Dae,startDate:u.start,endDate:u.end,displayMode:p,inPanel:!0}),Zae(Fa,{className:"left-gap",onClick:d,tooltip:(0,Oe.Z)("title","Create New Event"),image:Ts.md4.small}),Zae(Fa,{onClick:()=>Ae.Z.showCalendar(t.vivaldiWindowId),tooltip:(0,Oe.Z)("Open Calendar in Tab"),image:Ts.bcq.small})),Zae("div",{className:"toolbar toolbar-default toolbar-wrap"},void 0,Zae("div",{className:"toolbar-group",style:{marginRight:"auto"}},void 0,Zae(Fa,{className:"button-narrow",onClick:Nae,tooltip:(0,Oe.Z)("Previous"),image:Ts.mgF.small}),Zae(Fa,{onClick:()=>Gx.Z.selectToday(_ae),disabled:!!h&&(0,Bu.KC)(h.toDate(),new Date),title:(0,Oe.Z)("Today")}),Zae(Fa,{className:"button-narrow",onClick:Pae,tooltip:(0,Oe.Z)("Next"),image:Ts.Zu.small})),Zae("div",{className:"toolbar-group"},void 0,Zae(Fa,{onClick:()=>xae("day"),title:(0,Oe.Z)("Day"),isPressed:"day"===p}),Zae(Fa,{onClick:()=>xae("week"),title:(0,Oe.Z)("Week"),isPressed:"week"===p}),Zae(Fa,{onClick:()=>xae("agenda"),title:(0,Oe.Z)("Agenda"),isPressed:"agenda"===p})))]})),g&&Zae(Oae,{windowId:t.vivaldiWindowId}),!g&&v&&Zae(Lae,{onCreateEvent:d}),!v&&Zae(nx.Provider,{value:l},void 0,Zae(dR,{filter:s,events:o,trashedEvents:a,editingEvent:i})))}const Bae=hs.memo(Rae);var Fae,Vae=n(92521);function Wae(e,t,n,s){Fae||(Fae="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Fae,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Uae=[{text:(0,Oe.Z)("other","Name"),value:"name",fullScreenTitle:(0,Oe.Z)("Sort by Name")}];class Hae extends hs.PureComponent{refTreeList=hs.createRef();static contextType=xi.Z;winId=this.context.vivaldiWindowId;state={sorting:H.Z.get($.kContactPanelSorting)};onSortChange=(e,t)=>{const n={sortOrder:e,sortField:t};this.setState({sorting:n}),Ne.Z.set($.kContactPanelSorting,{sortOrder:e,sortField:t})};sortComparator=(e,t)=>{if(e.trash)return 1;if(t.trash)return-1;if(this.isFolder(e)&&!this.isFolder(t))return-1;if(this.isFolder(t)&&!this.isFolder(e))return 1;const n=e=>e.emailAddresses&&e.emailAddresses.length>0?e.emailAddresses[0].emailAddress:"";e.name||(e.name=n(e)),t.name||(t.name=n(t));const{sortOrder:s,sortField:i}=this.state.sorting;return Xi.Z.getDefaultComparator(s,i)(e,t)};getSelectedIds=()=>(this.refTreeList.current?.getAllSelectedItems()||[]).map((e=>e.id));getSelectedItems=()=>{const e=[];for(const t of this.getSelectedIds()){const n=Hc.Z.getNodeById(t);n&&e.push(n)}return e};getSelectedItem=()=>this.refTreeList.current?.getSelectedItem();getNodeName=e=>e.name?e.name:e.emailAddresses&&e.emailAddresses.length>0?e.emailAddresses[0].emailAddress:"";isFolder=xE.Z;hasChildren=e=>!!e.children&&e.children.length>0;unSelectAll=()=>{this.refTreeList.current?.unSelectAll()};deleteSelected=()=>{this.refTreeList.current?.onDelete()};deleteByIds=e=>{this.refTreeList.current?.onDeleteItems(e)};validateForEdit=Vae.Z;isValidAddTarget=Vae.Z;getTitle=e=>{if("string"==typeof e){const t=Hc.Z.getNodeById(e);return t?this.getNodeName(t):""}return""};saveTitle=(e,t)=>{const n=Hc.Z.getNodeById(e);n&&(n.name=t,a.Z.updateContact(n))};onAdd=e=>{this.refTreeList.current?.onAdd(e?"folder":"item")};getMenuCapability=async(e,t,n)=>{const s=this.winId;switch(e.action){case"CONTEXT_COMPOSE_MAIL":return{handler:this.compose,isVisible:()=>Boolean(n),...t(s,e,{})};case"CONTEXT_VIEW_ALL_MESSAGES":return{handler:this.viewAll,isVisible:()=>Boolean(n),...t(s,e,{})};case"CONTEXT_CONTAINER_DEFAULT_ACTION":{const n=this.props.prefValues[$.kMailContactDefaultAction];return{items:[{type:"radio",radiogroup:1,checked:"compose"===n,handler:()=>this.setDefaultAction("compose"),...(0,xs.Z)("Compose")},{type:"radio",radiogroup:1,checked:"viewAllMessages"===n,handler:()=>this.setDefaultAction("viewAllMessages"),...(0,xs.Z)("View All Messages")}],...t(s,e,{})}}default:return{...t(s,e,{})}}};getMenuVisibility=(e,t)=>{if(!t)return"CONTEXT_NEW_ITEM"===e.action;switch(e.action){case"CONTEXT_NEW_ITEM":case"CONTEXT_EDIT":case"CONTEXT_DELETE":return!0;default:return!1}};onContextMenu=e=>{this.refTreeList.current?.onContextMenu(e)};setDefaultAction=e=>{Ne.Z.set($.kMailContactDefaultAction,e)};onDoubleClick=e=>{0!==e.button||this.props.prefValues[$.kMailSingleClickTabs]||this.openTabForSelectedNode()};onNodeMouseDown=(e,t)=>{this.props.focusTree(),0===t.button&&this.props.prefValues[$.kMailSingleClickTabs]&&this.openTabForSelectedNode()};openTabForSelectedNode=()=>{const e=this.props.prefValues[$.kMailContactDefaultAction];"compose"===e?this.compose():"viewAllMessages"===e&&this.viewAll()};compose=()=>{const e=this.getSelectedItems();if(e&&e.length>0){const t=e.flatMap((e=>e.emailAddresses)).map((({emailAddress:e})=>({address:e})));ke.Z.createDraft({to:t})}};viewAll=()=>{const e=this.getSelectedItems();if(e&&e.length>0){const t=this.context.vivaldiWindowId;a.Z.selectContact(e[0]),l.Z.selectContactById(t,e[0].id),d.ZP.openURL(t,je.jk.internals.mailpage,{singleton:!0})}};rowComponent=e=>{const t=e.node,n=t?this.getNodeName(t):"";return Wae("label",{tabIndex:"-1"},`contact__list__${t.id}`,Wae("span",{className:"tree-row-image"},void 0,Wae("img",{src:t.avatarUrl?t.avatarUrl:rZ.g,alt:""})),Wae("span",{className:"title",title:n},void 0,n))};selectById=e=>{this.refTreeList.current?.selectById(e)};menu={name:"contactlist",getCapability:this.getMenuCapability,getVisibility:this.getMenuVisibility};render(){const e={sortOrder:this.state.sorting.sortOrder,sortField:this.state.sorting.sortField,comparator:this.sortComparator};return(0,fs.jsxs)(fs.Fragment,{children:[Wae(gv,{fields:Uae,manualSorting:!1,onSortChange:this.onSortChange,keyAccess:this.props.keyAccess,compact:!0,sortField:this.state.sorting.sortField,sortOrder:this.state.sorting.sortOrder}),Wae("section",{className:"outerScrollbar"},void 0,(0,fs.jsx)(yo,{ref:this.refTreeList,settings:"CONTACT_TREE",rowComponent:this.rowComponent,nodes:this.props.nodes,menu:this.menu,delete:a.Z.deleteContactsByIds,enableDragAndDrop:!1,isFolder:this.isFolder,hasChildren:this.hasChildren,supportsInlineEdit:!1,isValidToEdit:xE.Z,getTitle:this.getTitle,saveTitle:this.saveTitle,isValidAddTarget:this.isValidAddTarget,sorting:e,onSelect:this.props.onItemSelected,onItemMouseDown:this.onNodeMouseDown,onCreate:this.props.onCreate,onEdit:this.props.onEdit,onItemsActivated:this.openTabForSelectedNode,onItemDoubleClick:this.onDoubleClick}))]})}}const zae=Hae;var Gae;function $ae(e,t,n,s){Gae||(Gae="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Gae,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Kae=256,jae=["../resources/contact-person.png","../resources/contact-company.png"];class Yae extends hs.PureComponent{static contextType=xi.Z;nodeRef=hs.createRef();refPhotoPicker=hs.createRef();state={drawerOpen:!1,isDropTarget:!1,initialPhoto:"",id:""};componentDidUpdate(e,t){const n=this.props.id;n&&n!==e.id&&this.setState({initialPhoto:this.props.photo,id:n}),!0===t.drawerOpen&&!1===this.state.drawerOpen?this.props.disableOnClickOutside?.():!1===t.drawerOpen&&!0===this.state.drawerOpen&&this.props.enableOnClickOutside()}getNode(){return this.nodeRef.current}onToggleOverlay=()=>{this.setState((e=>({drawerOpen:!e.drawerOpen})))};handleClickOutside=()=>{this.setState({drawerOpen:!1})};photoChange=()=>{this.refPhotoPicker.current?.click()};setContactPhoto=e=>{if(e.target.files&&e.target.files.length>0){var t=e.target.files[0],n=new FileReader;n.onloadend=()=>{this.setState({drawerOpen:!1,isDropTarget:!1}),"string"==typeof n.result&&this.props.attributeChange(n.result)},n.readAsDataURL(t)}};photoDragOver=e=>{e.preventDefault()};photoDragEnter=()=>{this.setState({isDropTarget:!0})};photoDragLeave=()=>{this.setState({isDropTarget:!1})};photoDrop=e=>{const t=e.dataTransfer.files[0];if(this.setState({isDropTarget:!1}),t&&/image.*/.test(t.type)){const e=new FileReader;e.onloadend=()=>{"string"==typeof e.result&&this.setPhoto(e.result)},e.readAsDataURL(t)}};getGravatar=()=>{const e=nt()(this.props.emailAddress);fetch(`https://secure.gravatar.com/avatar/${e}?s=512&d=404`).then((e=>{e.ok&&e.blob().then((e=>{const t=new FileReader;t.addEventListener("loadend",(()=>{"string"==typeof t.result&&this.setPhoto(t.result),this.setState({drawerOpen:!1,isDropTarget:!1})})),t.readAsDataURL(e)}))}))};setPhoto=e=>{const{document:t}=this.context;if(!e)return this.props.attributeChange(""),void this.setState({drawerOpen:!1,isDropTarget:!1});const n=t.createElement("canvas"),s=n.getContext("2d"),i=t.createElement("img");let o=0,a=0;n.width=Kae,n.height=Kae,i.onload=()=>{i.height>i.width?(i.height*=Kae/i.width,i.width=Kae,a=.5*-(i.height-Kae)):(i.width*=Kae/i.height,i.height=Kae,o=.5*-(i.width-Kae)),s.drawImage(i,o,a,i.width,i.height),this.props.attributeChange(n.toDataURL("image/jpeg",.9)),this.setState({drawerOpen:!1})},i.src=e};render(){const e=this.props.photo,t=As()({"contact-photo-is-droptarget":this.state.isDropTarget,"contact-photo":!0});return(0,fs.jsxs)("span",{ref:this.nodeRef,className:"contact-photo-picker",children:[$ae("button",{className:t,onDrop:this.photoDrop,onDragEnter:this.photoDragEnter,onDragLeave:this.photoDragLeave,onDragOver:this.photoDragOver,style:e?{backgroundImage:`url(${e})`}:{backgroundImage:`url(${rZ.g})`},disabled:-1===this.props.id,onClick:this.onToggleOverlay}),(0,fs.jsx)("input",{type:"file",tabIndex:"-1",accept:"image/*",ref:this.refPhotoPicker,disabled:-1===this.props.id,onChange:this.setContactPhoto,style:{position:"absolute",visibility:"hidden",height:0,width:0}}),this.state.drawerOpen&&$ae("div",{className:"contact-photo-picker-overlay"},void 0,$ae("div",{className:"photo-picker-suggestions"},void 0,$ae("button",{className:"photo-picker-suggestion",onClick:this.props.disabled?void 0:this.setPhoto.bind(this,this.state.initialPhoto),style:{backgroundImage:this.state.initialPhoto?`url(${this.state.initialPhoto})`:`url(${rZ.g})`}}),jae.map(((e,t)=>$ae("button",{className:"photo-picker-suggestion",onClick:this.setPhoto.bind(this,jae[t]),style:{backgroundImage:`url(${e})`}},`photo-picker-suggestion-${t}`)))),$ae("input",{type:"button",onClick:this.getGravatar,value:(0,Oe.Z)("Get Gravatar")}),$ae("input",{type:"button",className:"primary",onClick:this.photoChange,value:(0,Oe.Z)("Browse...")}))]})}}const Xae=(0,ua.Z)(Yae);var Qae,qae;function Jae(e,t,n,s){Qae||(Qae="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Qae,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class ere extends hs.PureComponent{isIMEOpen=!1;nodeRef=hs.createRef();state={values:this.props.values};resetValues(){this.setState({values:this.props.values})}_handleChange=(e,t)=>{if(this.isIMEOpen)return!1;const n=t.target.value,s=t.target.name;this.setState((t=>{const i=[...t.values];return i[e]={...t.values[e],[s]:n},{values:i}}))};_handleAdd=e=>{0===e.button&&this._handleChange(this.props.values.length,e)};_handleRemove=(e,t)=>{0===t.button&&(e?this.props.onRemove(e):this.resetValues())};_handleSubmit=()=>{this.props.onChange(this.state.values)};_handleFormSubmit=e=>{e.preventDefault(),this._handleSubmit()};_handleInputKeyDown=e=>{switch(e.key){case"Escape":return void this.resetValues();case"Enter":return void this._handleSubmit()}};onCompositionUpdate=()=>{this.isIMEOpen=!0};onCompositionEnd=(e,t)=>{this.isIMEOpen=!1,this._handleChange(e,t)};renderSimpleForm(e,t){return Jae("form",{},void 0,this.renderTypes(e,0),this.props.label&&Jae("input",{className:"contact-field",type:e,defaultValue:this.props.values[0],placeholder:t,title:t,name:"value",onChange:e=>this._handleChange(0,e),onKeyDown:this._handleInputKeyDown,onBlur:this._handleFormSubmit,onCompositionStart:this.onCompositionUpdate,onCompositionUpdate:this.onCompositionUpdate,onCompositionEnd:e=>this.onCompositionEnd(0,e)}))}renderTypes(e,t){return Jae("select",{className:"contact-type-picker",name:"type",onChange:this._handleChange.bind(this,t),onBlur:this._handleFormSubmit,value:e},void 0,Jae("option",{value:""},void 0,(0,Oe.Z)("contact type","default")),Jae("option",{value:"home"},void 0,(0,Oe.Z)("home")),Jae("option",{value:"work"},void 0,(0,Oe.Z)("work")))}render(){const{values:e}=this.state,{inputType:t="text",label:n}=this.props;return 0===e.length?this.renderSimpleForm(t,n):(0,fs.jsx)(fs.Fragment,{children:(0,fs.jsx)("form",{ref:this.nodeRef,onSubmit:this._handleFormSubmit,children:e.map(((s,i)=>Jae(hs.Fragment,{},s.id+"_"+i,this.renderTypes(s.type||"",i),Jae("span",{className:"contact-field"},void 0,this.props.label&&Jae("input",{type:t,name:"value",defaultValue:s.value||"",placeholder:n,title:n,onChange:this._handleChange.bind(this,i),onBlur:this._handleFormSubmit,onKeyDown:this._handleInputKeyDown,onCompositionStart:this.onCompositionUpdate,onCompositionUpdate:this.onCompositionUpdate,onCompositionEnd:this.onCompositionEnd,autoFocus:i===e.length-1}),Jae("button",{type:"button",className:"remove",title:(0,Oe.Z)("verb","Remove"),onMouseUp:this._handleRemove.bind(this,s.id),onClick:this._handleRemove.bind(this,s.id)},void 0,"–")),i===e.length-1&&Jae("input",{type:"button",value:this.props.actionLabel,className:"add",onMouseUp:this._handleAdd,onClick:this._handleAdd}))))})})}}function tre(e,t,n,s){qae||(qae="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:qae,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var nre=tre("span",{className:"spacer"}),sre=tre("span",{className:"spacer"}),ire=tre("span",{className:"spacer"}),ore=tre("span",{className:"spacer"}),are=tre("span",{className:"spacer"}),rre=tre("span",{className:"spacer"}),lre=tre("span",{className:"spacer"}),dre=tre("span",{className:"spacer"}),cre=tre("span",{className:"spacer"});class hre extends hs.Component{static contextType=xi.Z;refName=hs.createRef();refPhotoPicker=hs.createRef();state={contact:this.props.contact,editMode:!1};static getDerivedStateFromProps(e,t){return{contact:e.contact}}focus=()=>{this.refName.current?.focus()};changeProperty=(e,t)=>{const{contact:n}=this.state;switch(e){case"birthday":{const e=N()(t.target.value).valueOf();n.birthday!==e&&(n.birthday=e,this.setState({contact:n}));break}case"note":case"name":{const s=t.target.value;n[e]!==s&&(n[e]=s,this.setState({contact:n}));break}}};updateCheckboxProperty=e=>{const{contact:t}=this.state;-1!==t.id&&a.Z.update(t.id,{trusted:e.target.checked})};updateAvatar=e=>{const{contact:t}=this.state;a.Z.update(t.id,{avatarUrl:e}),this.setState((t=>({contact:{...t.contact,avatarUrl:e}})))};update=e=>{const{contact:t}=this.state;switch(e){case"name":return a.Z.update(t.id,{name:t.name,generatedFromSentMail:!1});case"birthday":return a.Z.update(t.id,{birthday:t.birthday,generatedFromSentMail:!1});case"note":return a.Z.update(t.id,{note:t.note,generatedFromSentMail:!1})}};_handleEmailsChanged=e=>{const{contact:t}=this.state;e.forEach((e=>{const n=e.id,s=t.emailAddresses.find((e=>e.id===n));s?(0,xA.Z)(s,e)||a.Z.updateEmailAddress(n,{contactId:t.id,emailAddress:e.value,type:e.type}):a.Z.addEmailAddress({contactId:t.id,emailAddress:e.value,type:e.type})}))};_handleEmailsRemoved=e=>{a.Z.removeEmailAddress({contactId:this.props.contact.id,emailAddressId:e})};_handlePropertyValueChanged=({propertyName:e,propertyCollectionName:t,values:n})=>{if(0===n.length)return;const{contact:s}=this.state,i=s.id;n.forEach((n=>{const o=n.id,r=s[t].find((e=>e.id===o));(r||n.value)&&(r?a.Z.updatePropertyItem({contactId:i,propertyName:e,propertyId:o,type:n.type,propertyValue:n.value}):a.Z.addPropertyItem({contactId:i,propertyName:e,type:n.type||"",propertyValue:n.value}))}))};_handlePhoneNumbersChanged=e=>{this._handlePropertyValueChanged({values:e,propertyName:"phoneNumber",propertyCollectionName:"phoneNumbers"})};_handlePhoneNumbersRemoved=e=>{a.Z.removePropertyItem({propertyName:"phoneNumber",contactId:this.state.contact.id,propertyId:e})};_handlePostalAddressesChanged=e=>{this._handlePropertyValueChanged({values:e,propertyName:"postalAddress",propertyCollectionName:"postalAddresses"})};_handlePostalAddressesRemoved=e=>{a.Z.removePropertyItem({propertyName:"postalAddress",contactId:this.state.contact.id,propertyId:e})};onKeyDown=(e,t)=>{"Enter"!==t.key||this.update(e)};call=(e="",t)=>{const n=e.replace(/[^\d]/g,"");n&&(t.stopPropagation(),d.ZP.openURL(this.context.vivaldiWindowId,`tel:+${n}`))};compose=(e="",t)=>{e&&(t.stopPropagation(),ke.Z.createDraft({to:(0,ft.D$)(e)}))};showMap=(e="",t)=>{e&&(t.stopPropagation(),d.ZP.openURL(this.context.vivaldiWindowId,`map:+${e}`))};enableEditMode=()=>{this.setState({editMode:!0},(()=>this.focus()))};toggleEditMode=()=>{this.setState((e=>({editMode:!e.editMode})))};addSpaces=e=>e.split("").reverse().join("").replace(/(.{3})/g,"$1 ").split("").reverse().join("").replace("+ ","+");renderDisplayMode=()=>{const{contact:e}=this.state;return tre("div",{className:"contact-view cardview",onClick:this.props.onEdit},void 0,tre("div",{className:"contact-header"},void 0,(0,fs.jsx)(Xae,{ref:this.refPhotoPicker,id:e.id,disabled:!0,attributeChange:this.updateAvatar,photo:e.avatarUrl||"",emailAddress:e.emailAddresses.length>0?e.emailAddresses[0].emailAddress:""}),tre("div",{className:As()({"contact-name":!0,selectable:e.name,disabled:!e.name})},void 0,e.name||(0,Oe.Z)("noun","Name"))),nre,e.emailAddresses.map((e=>{if(e.emailAddress)return tre(hs.Fragment,{},e.id,tre("div",{className:"contact-field-type"},void 0,tre("span",{className:"info"},void 0,e.type),tre("span",{dangerouslySetInnerHTML:{__html:Ts.HXY},className:"contact-action-button",onClick:this.compose.bind(null,e.emailAddress),title:(0,Oe.Z)("Compose new mail"),tooltip:(0,Oe.Z)("Compose new mail")+" "+J.Z.getShortcut("COMMAND_MAIL_COMPOSE_NEW_MESSAGE")})),tre("p",{className:"contact-email selectable"},void 0,e.emailAddress))})),sre,e.phoneNumbers.map((e=>{if(e.phoneNumber)return tre(hs.Fragment,{},e.id,tre("div",{className:"contact-field-type"},void 0,tre("span",{className:"info"},void 0,e.type),tre("span",{dangerouslySetInnerHTML:{__html:Ts.Mqy},className:"contact-action-button",onClick:this.call.bind(null,e.phoneNumber),title:(0,Oe.Z)("Call")})),tre("p",{className:"contact-phone selectable"},void 0,this.addSpaces(e.phoneNumber)))})),ire,e.postalAddresses.map((e=>{if(e.postalAddress)return tre(hs.Fragment,{},e.id,tre("div",{className:"contact-field-type"},void 0,tre("span",{className:"info"},void 0,e.type),tre("span",{dangerouslySetInnerHTML:{__html:Ts.rnU},className:"contact-action-button",onClick:this.showMap.bind(null,e.postalAddress),title:(0,Oe.Z)("Open map")})),tre("p",{className:"contact-phone selectable"},void 0,e.postalAddress))})),0!==e.birthday&&(0,fs.jsxs)(fs.Fragment,{children:[ore,tre("span",{dangerouslySetInnerHTML:{__html:Ts.bcq.small},className:"contact-field-type contact-action-button"}),tre("p",{className:"contact-birthday selectable"},void 0,N()(e.birthday).format("LL"))]}),e.note&&(0,fs.jsxs)(fs.Fragment,{children:[are,tre("span",{dangerouslySetInnerHTML:{__html:Ts.NNg.small},className:"contact-field-type contact-action-button",onClick:this.toggleEditMode,title:(0,Oe.Z)("Edit note")}),tre("p",{className:"contact-note selectable"},void 0,e.note)]}))};render(){const{contact:e}=this.state,t=e.emailAddresses[0]&&e.emailAddresses[0].emailAddress;return this.state.editMode?tre("div",{className:"contact-view cardview"},void 0,tre("div",{className:"contact-header"},void 0,tre(Xae,{id:e.id,attributeChange:this.updateAvatar,photo:e.avatarUrl||"",emailAddress:t}),tre("span",{className:"contact-name"},void 0,(0,fs.jsx)("input",{ref:this.refName,type:"text",value:e.name||"",placeholder:(0,Oe.Z)("other","Name"),onChange:this.changeProperty.bind(this,"name"),onKeyDown:this.onKeyDown.bind(this,"name"),onBlur:this.update.bind(this,"name")}))),tre(ere,{values:e.emailAddresses.map((({emailAddress:e,id:t,type:n})=>({value:e,id:t,type:n}))),label:(0,Oe.Z)("Email"),actionLabel:(0,Oe.Z)("Add another Email"),inputType:"email",onChange:this._handleEmailsChanged,onRemove:this._handleEmailsRemoved},`emailAddresses-${Math.max(e.emailAddresses.length,1)}`),tre("label",{className:"contact-trusted"},void 0,tre("input",{type:"checkbox",checked:e.trusted||!1,onChange:this.updateCheckboxProperty}),tre("span",{},void 0,(0,Oe.Z)("Always allow external content in emails"))),rre,tre(ere,{values:e.phoneNumbers.map((({phoneNumber:e,id:t,type:n})=>({value:e,id:t,type:n}))),label:(0,Oe.Z)("Phone Number"),actionLabel:(0,Oe.Z)("Add another Phone Number"),inputType:"tel",onChange:this._handlePhoneNumbersChanged,onRemove:this._handlePhoneNumbersRemoved},`phoneNumbers-${e.phoneNumbers.length}`),lre,tre(ere,{values:e.postalAddresses.map((({postalAddress:e,id:t,type:n})=>({value:e,id:t,type:n}))),label:(0,Oe.Z)("Postal Address"),actionLabel:(0,Oe.Z)("Add another Postal Address"),inputType:"text",onChange:this._handlePostalAddressesChanged,onRemove:this._handlePostalAddressesRemoved},`postalAddresses-${e.postalAddresses.length}`),dre,tre("span",{className:"contact-field"},void 0,tre(WT,{className:"contact-bday",value:e.birthday?N()(e.birthday).format("YYYY-MM-DD"):"",title:(0,Oe.Z)("title","Birthday"),onChange:this.changeProperty.bind(this,"birthday"),onKeyDown:this.onKeyDown.bind(this,"birthday"),onBlur:this.update.bind(this,"birthday"),placeholder:(0,Oe.Z)("title","Birthday")}),tre("button",{type:"button",className:"remove",title:(0,Oe.Z)("Remove Birthday"),onMouseUp:this.changeProperty.bind({target:{value:0}},"birthday")},void 0,"–")),cre,tre("textarea",{className:"contact-edit-note",type:"text",value:e.note||"",title:e.note||"",onChange:this.changeProperty.bind(this,"note"),onKeyDown:this.onKeyDown.bind(this,"note"),onBlur:this.update.bind(this,"note"),placeholder:(0,Oe.Z)("Note")})):this.renderDisplayMode()}}const pre=hre;var ure;function gre(e,t,n,s){ure||(ure="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:ure,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var mre=gre("input",{type:"checkbox",disabled:!0}),vre=gre("span",{className:"spacer"}),fre=gre("span",{className:"spacer"}),yre=gre("span",{className:"spacer"}),Cre=gre("span",{className:"spacer"});function wre(){return gre("div",{className:"contact-view cardview"},void 0,gre("div",{className:"contact-header"},void 0,gre("span",{className:"contact-photo-picker"},void 0,gre("div",{className:"contact-photo",style:{backgroundImage:"url('/resources/contact-person.png')"}})),gre("input",{className:"contact-name",type:"text",placeholder:(0,Oe.Z)("other","Name"),disabled:!0})),gre("input",{className:"contact-email",type:"email",placeholder:(0,Oe.Z)("Email"),disabled:!0}),gre("label",{className:"contact-trusted"},void 0,mre,gre("span",{},void 0,(0,Oe.Z)("Always allow external content in emails"))),vre,gre("input",{className:"contact-email",type:"tel",placeholder:(0,Oe.Z)("Phone number"),disabled:!0}),fre,gre("input",{className:"contact-email",type:"text",placeholder:(0,Oe.Z)("Postal address"),disabled:!0}),yre,gre("input",{className:"contact-email",type:"text",placeholder:(0,Oe.Z)("title","Birthday"),disabled:!0}),Cre,gre("input",{className:"contact-postal",type:"text",placeholder:(0,Oe.Z)("Notes"),disabled:!0}))}var bre,Sre=n(34155);function Ire(e,t,n,s){bre||(bre="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:bre,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const kre=[$.kContactPanelEditorHeight,$.kMailContactDefaultAction,$.kMailSingleClickTabs];var Are=Ire(wre,{});class Tre extends hs.PureComponent{static contextType=xi.Z;winId=this.context.vivaldiWindowId;nodeRef=hs.createRef();_tree=hs.createRef();_editor=hs.createRef();state={items:Hc.Z.getAsTree(""),filter:"",editorHeight:this.props.prefValues[$.kContactPanelEditorHeight],contact:{id:Hc.s}};componentDidMount(){0===this.state.items.length&&a.Z.initialize(),ud.ZP.addListener(this.onPanelStoreChange),Hc.Z.addListener(this.onContactStoreChange)}componentWillUnmount(){ud.ZP.removeListener(this.onPanelStoreChange),Hc.Z.removeListener(this.onContactStoreChange)}componentDidUpdate(e,t){!e.open&&this.props.open&&Sre.nextTick((()=>this._applyTransitionState()))}_applyTransitionState=()=>{const e=ud.ZP.getTransitionState(this.winId,"PanelContacts");Pn.Z.clearTransitionState(this.winId,"PanelContacts"),this._tree.current&&e?(e.selectId&&this._tree.current.selectById(e.selectId),"edit"===e.reason?this.onEdit():e.setFocus&&this.focusTree()):this.focusTree()};onPanelStoreChange=()=>{const e=ud.ZP.getChangeReason();if(this.props.open)switch(e){case"setFocus":sl(this.context.document,this.nodeRef.current)||this.focusTree();break;case"display":Sre.nextTick((()=>this._applyTransitionState()))}};onContactStoreChange=e=>{switch(e.reason){case"selectedContact":{const t=e.focusContactView;return this.onContactSelectedChange(e.contact,t)}case"newContact":{const t=e.focusContactView;return this.onContactSelectedChange(e.contact,t,{items:Hc.Z.getAsTree(this.state.filter)})}case"startup":{const e=E.Z.getSync("SELECTION_CONTACT_TREE")?.selectedIds_[0]?.id,t=e&&Hc.Z.getNodeById(e)||{id:Hc.s};this.setState((e=>({contact:t,items:Hc.Z.getAsTree(e.filter)})));break}case"addContacts":case"deleteContact":case"updatedContact":return this.setState((e=>({contact:Hc.Z.getSelected()||{id:Hc.s},items:Hc.Z.getAsTree(e.filter)})))}};onContactSelectedChange=(e,t,n)=>{this.setState({...n,contact:e},(()=>{t&&e.id!==Hc.s&&(this._editor.current&&this._editor.current.enableEditMode(),this._tree.current&&this._tree.current.selectById(e.id))}))};newItem=e=>{this._tree.current&&this._tree.current.onAdd(e)};onCreate=(e,t,n,s)=>(this.onEdit(),a.Z.newEmptyContact());onEdit=()=>{this.state.editorHeight<h.Cn&&this.onSlidebarToggle();(this.state.contact||Hc.Z.getSelected()||{id:Hc.s})&&this._editor.current&&this._editor.current.enableEditMode()};deleteSelected=()=>{this._tree.current&&this._tree.current.deleteSelected()};handleFilterChange=e=>{const t=e.target.value;this.setState({filter:t,items:Hc.Z.getAsTree(t)})};onCompose=()=>{this._tree.current&&this._tree.current.compose()};focusTree=()=>{this._tree.current&&this._tree.current.refTreeList.current?.focusTree()};onItemSelected=e=>{if(e){if(e.id===this.state.contact.id)return;a.Z.selectContact(e,!1)}else this.setState({contact:{id:Hc.s}})};onContextMenu=e=>{this._tree.current&&(e.nativeEvent.buttons>0&&this._tree.current.unSelectAll(),this._tree.current.onContextMenu(e))};onSlidebarPosition=(e,t)=>{this.setState((e=>({editorHeight:Math.max(Math.min(e.editorHeight-t,800),h.mT)})))};onSlideBarStop=()=>{this.setState((e=>{let t=e.editorHeight;return t<=h.Cn&&(t=h.mT),Ne.Z.set($.kContactPanelEditorHeight,t),{editorHeight:t}}))};onSlidebarToggle=()=>{this.setState((e=>{let t=e.editorHeight;return t>h.Cn?(t=h.mT,Ne.Z.set($.kContactPanelEditorHeight,t)):(t=320,Ne.Z.reset($.kContactPanelEditorHeight)),{editorHeight:t}}))};renderEmptyState=()=>Ire("div",{className:"panel-empty-state"},void 0,Ire("span",{dangerouslySetInnerHTML:{__html:Ts.h5j}}),Ire("h1",{},void 0,(0,Oe.Z)("Your contact list is empty")),Ire("p",{className:"faded-text"},void 0,(0,Oe.Z)("Click the “+” button to add a new contact.")));renderNoContactFound=()=>Ire("div",{className:"panel-empty-state"},void 0,Ire("span",{dangerouslySetInnerHTML:{__html:Ts.h5j}}),Ire("h1",{},void 0,(0,Oe.Z)("No contact found")));render(){if(!this.props.open)return null;const e=this.state.contact&&this.state.contact.id!==Hc.s?this.state.contact:void 0;return(0,fs.jsxs)("div",{ref:this.nodeRef,className:"panel",id:"contacts",children:[Ire("header",{},void 0,Ire(Dm,{title:this.props.title,showCloseButton:this.props.showCloseButton}),Ire("div",{className:"toolbar toolbar-default toolbar-wrap"},void 0,Ire("input",{type:"search",placeholder:(0,Oe.Z)("verb","Search"),value:this.state.filter,onChange:this.handleFilterChange}),Ire("div",{className:"toolbar"},void 0,Ire("div",{className:"toolbar-group"},void 0,Ire(Fa,{onClick:this.newItem.bind(this,!1),tooltip:(0,Oe.Z)("New Contact"),image:Ts.md4.small}),Ire(Fa,{onClick:this.deleteSelected,disabled:this.state.contact.id===Hc.s,image:Ts.M2k.small,tooltip:(0,Oe.Z)("other","Delete")})),Ire(Fa,{onClick:this.onCompose,tooltip:(0,Oe.Z)("Compose mail to contact"),disabled:this.state.contact.id===Hc.s,image:Ts.XTV.small})))),0===this.state.items.length&&(this.state.filter?this.renderNoContactFound():this.renderEmptyState()),(0,fs.jsx)(zae,{ref:this._tree,nodes:this.state.items,keyAccess:this.props.keyAccess,onCreate:this.onCreate,onEdit:this.onEdit,focusTree:this.focusTree,prefValues:this.props.prefValues,onItemSelected:this.onItemSelected}),this.state.items.length>0&&Ire("section",{className:As()("panel-contacts-edit","outerScrollbar",{collapsed:this.state.editorHeight===h.mT}),style:{flexBasis:this.state.editorHeight}},void 0,Ire(lv,{onSlidebarPosition:this.onSlidebarPosition,onStop:this.onSlideBarStop,onDoubleClick:this.onSlidebarToggle,returnOffset:!0,position:"bottom"}),this.state.editorHeight>h.mT&&e?(0,fs.jsx)(pre,{ref:this._editor,contact:e,onEdit:this.onEdit},e.id):Are)]})}}const Zre=sa(Tre,kre);var Ere;function _re(e,t,n,s){Ere||(Ere="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Ere,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Mre=[{text:(0,Oe.Z)("Date"),value:"visitTime",fullScreenTitle:(0,Oe.Z)("Sort by Date")},{text:(0,Oe.Z)("Title"),value:"title",fullScreenTitle:(0,Oe.Z)("Sort by Title")},{text:(0,Oe.Z)("Address"),value:"address",fullScreenTitle:(0,Oe.Z)("Sort by Address")},{text:(0,Oe.Z)("Views"),value:"visitCount",fullScreenTitle:(0,Oe.Z)("Sort by Page Views")}];class Nre extends hs.PureComponent{static contextType=xi.Z;hasLoadedData=!1;refSearch=hs.createRef();componentDidUpdate(e){!e.open&&this.props.open&&this.refSearch.current?.focusField(),this.props.open&&!this.hasLoadedData&&(this.hasLoadedData=!0,L.loadAll())}onSearch=e=>{const t=Z.Z.getPanelResourceKey();L.saveStateFromSearchQuery(t,e),L.searchHistory(t,e)};onSearchDomain=e=>{e=UI(e);const{filter:t}=this.props,n={...t,text:e,parsedFilter:u3(e),searchURL:!0};this.onSearch(n)};onSortChange=(e,t)=>{const{filter:n}=this.props,s={...n,sortOrder:e,sortField:t};this.onSearch(s)};renderHistory=()=>0===Z.Z.getTotalHistory()?_re("div",{className:"panel-empty-state"},void 0,_re("span",{dangerouslySetInnerHTML:{__html:Ts.dgq}}),_re("h1",{},void 0,(0,Oe.Z)("No browsing history to show")),_re("p",{},void 0,(0,Oe.Z)("As soon as you start browsing, your history will show here."))):this.props.nodes.length>0?_re("section",{className:"outerScrollbar"},void 0,_re(P3,{fullView:!1,inManager:!1,nodes:this.props.nodes,filter:this.props.filter,onSearchDomain:this.onSearchDomain})):_re("section",{},void 0,_re("p",{},void 0,(0,Oe.Z)("No browsing history data for selected period.")));render(){if(!this.props.open)return null;const{filter:e,nodes:t}=this.props;return _re("div",{className:"panel",id:"history-panel"},void 0,_re("header",{},void 0,_re(Dm,{title:this.props.title,showCloseButton:this.props.showCloseButton}),_re("div",{className:"toolbar toolbar-default toolbar-wrap"},void 0,(0,fs.jsx)(f3,{ref:this.refSearch,showPicker:!0,search:this.onSearch,filter:e,minDate:this.props.oldestDate,hasHistory:0!==t.length,showClearBtn:!0}))),t.length>0&&_re(gv,{fields:Mre,onSortChange:this.onSortChange,keyAccess:this.props.keyAccess,sortField:e.sortField,sortOrder:e.sortOrder,fullsize:!1,manualSorting:!1}),this.renderHistory())}}const Pre=y3(Nre);var Dre;function xre(e,t,n,s){Dre||(Dre="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Dre,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Ore extends hs.PureComponent{static contextType=xi.Z;markdownFormatter=new i6({quotes:(0,Oe.Z)("“”‘’")});refRender=hs.createRef();constructor(e){super(e);const t=this.props.attachments.map((e=>e.content?`[${e.content}]: chrome://vivaldi-data/synced-store/${e.content}`:"")).join("\n"),n=`${this.props.body}\n\n${t}\n`;this.state={markup:n}}componentDidMount(){this.refRender.current&&(this.refRender.current.scrollTop=this.props.initialScrollPosition||0)}onScroll=({currentTarget:e})=>{this.props.onScrollValueChange&&this.props.onScrollValueChange(e.scrollTop)};selectAll=e=>{const{document:t,getSelection:n}=this.context;e.focus();const s=n();s&&s.removeAllRanges();const i=t.createRange();i.selectNodeContents(e),s&&s.addRange(i)};onKeyDown=e=>{const{getSelection:t}=this.context;switch(e.key){case"a":return void(e.ctrlKey&&(e.preventDefault(),this.selectAll(e.currentTarget)));case"Escape":{const e=t();return void(e&&e.removeAllRanges())}}};render(){const{className:e}=this.props,t=this.markdownFormatter.getRawMarkup(this.state.markup);return(0,fs.jsx)("div",{ref:this.refRender,onMouseUp:e=>function(e,t){if(t.button!==Hi.Z.kLeft)return;const{vivaldiWindowId:n,HTMLAnchorElement:s}=e,i=t.target;if(i instanceof s&&i.href){const e=i.getAttribute("href");if(!e||e&&e.startsWith("#"))return;const{metaKey:s,shiftKey:o,ctrlKey:a,altKey:r,button:l}=t,{allowOverride:c,...h}=(0,nl.Z)(n,{metaKey:s,shiftKey:o,ctrlKey:a,altKey:r,button:l});if(!c)return;d.ZP.openURL(n,i.href,{...h,inCurrent:!1,inBackground:c?H.Z.get($.kTabsOpenNewInBackground):h.inBackground})}}(this.context,e),onKeyDown:this.onKeyDown,className:As()("MarkdownRender",e),tabIndex:"0",onScroll:this.onScroll,children:xre("div",{dangerouslySetInnerHTML:{__html:t}})})}}const Lre=Ore;class Rre extends hs.PureComponent{_isIMEOpen=!1;state={content:this.props.content};refContent=hs.createRef();focus=()=>{this.refContent.current?.focus()};reset=(0,no.Z)((()=>{this.setState({content:this.props.content})}),W3.mS,{leading:!1,trailing:!0});_save=(0,no.Z)((()=>{this.waitForCompositionEnd.then((()=>{this.props.onSave(this.state.content)}))}),W3.mS,{leading:!1,trailing:!0});handleContentChange=({currentTarget:e})=>{this.props.onChange(e.value),this.setState({content:e.value},this._save)};waitForCompositionEnd=Promise.resolve();resolveComposition=Aa.Z;_handleCompositionStart=()=>{this._isIMEOpen=!0,this.waitForCompositionEnd=(()=>new Promise((e=>{this.resolveComposition=e})))()};_handleCompositionEnd=()=>{this._isIMEOpen=!1,this.resolveComposition()};handleKeyDown=e=>{(e.metaKey||e.ctrlKey)&&"s"===e.key&&(e.preventDefault(),this.props.onSave(this.state.content)),"Escape"===e.key&&this._isIMEOpen&&(e.preventDefault(),e.stopPropagation())};handleFocus=e=>{e.persist(),e.currentTarget.selectionStart=this.props.content.length,e.currentTarget.selectionEnd=this.props.content.length};render(){const{disabled:e,className:t}=this.props,{content:n}=this.state;return(0,fs.jsx)("textarea",{ref:this.refContent,className:t,placeholder:(0,Oe.Z)("Note"),title:(0,Oe.Z)("Write a note"),value:n,disabled:e,onFocus:this.handleFocus,onChange:this.handleContentChange,onCompositionStart:this._handleCompositionStart,onCompositionEnd:this._handleCompositionEnd,onKeyDown:this.handleKeyDown,onBlur:this.props.onBlur})}}var Bre,Fre=n(81213),Vre=n(99250);function Wre(e,t,n,s){Bre||(Bre="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Bre,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Ure({windowId:e,disabled:t,onToggleMarkDown:n,onDoCapture:s,onOpenDialog:i,keyAccess:o,viewMarkdown:a,noteId:r}){const l=t?-1:o;return Wre("div",{className:"toolbar toolbar-default"},void 0,Wre("div",{className:"toolbar-group"},void 0,Wre("div",{className:"button-toolbar"},void 0,Wre("button",{disabled:t,onClick:s,title:(0,Oe.Z)("Add capture of selected area or full page"),tabIndex:l,dangerouslySetInnerHTML:{__html:Ts.F_h}})),Wre(u6,{onOpenDialog:i,disabled:t,keyAccess:l,noteId:r}),Wre("div",{className:"button-toolbar"},void 0,Wre("button",{className:"button-toolbar"+(a?" button-pressed":""),disabled:t,onClick:n,title:a?(0,Oe.Z)("Switch to Editor"):(0,Oe.Z)("Switch Markdown View"),tabIndex:l,dangerouslySetInnerHTML:{__html:Ts.Pje}}))),Wre("div",{className:"button-toolbar open-in-tab-button"},void 0,Wre("button",{disabled:t,onClick:()=>function(e,t){d.ZP.openURL(e,je.jk.internalUrl("notes",t),{singleton:!0})}(e,r),title:(0,Oe.Z)("Open in Tab"),tabIndex:l,dangerouslySetInnerHTML:{__html:Ts.vvh.medium}})))}function Hre(e,{title:t,content:n,url:i}){return async function(e,t){const n=await C.Z.notes.update(e,t);if(!s.Z.runtime.lastError)return n}(e,(0,Fre.Z)({url:"string"==typeof i?(0,vs.q9)(i.trim()):void 0,title:t,content:n},Vre.Z))}function zre(e){return{id:e.note?.id??"",url:e.note?.url,title:e.note?.title,content:e.note?.content,attachments:"note"===e.note?.type?e.note.children:void 0}}class Gre extends hs.Component{static contextType=xi.Z;refFolderName=hs.createRef();refContainer=hs.createRef();refTextEditor=hs.createRef();_id=crypto.randomUUID();_pageContext={};state=zre(this.props);componentDidMount(){py.Z.updateState(this._id,{typedUrl:this.props.note?.url??""}),yy.addListener(this._onUrlFieldStoreChanged,(e=>e.get(this._id))),W3.ZP.addListener(this._onNoteStoreChanged)}componentDidUpdate(e,t){this.props.note&&this.props.note.content!==t.content&&this.updateState()}componentWillUnmount(){if(yy.removeListener(this._onUrlFieldStoreChanged),W3.ZP.removeListener(this._onNoteStoreChanged),py.Z.reset(this._id),!this.props.note)return;const{id:e,content:t,url:n}=this.state;Hre(e,{content:t,url:n})}updateState=(0,no.Z)((()=>{sl(this.context.document,this.refTextEditor.current?.refContent.current??null)||this.setState({...zre(this.props)},(()=>this.refTextEditor.current?.reset()))}),W3.mS,{trailing:!0,leading:!1});focusPrimaryInput=()=>{if(!this.props.note)return;W3.ZP.isFolder(this.props.note)?this.refFolderName.current?.focus():this.refTextEditor.current?.focus()};_doCapture=()=>{const e=this.props.note;var t;e&&(t=this.context.vivaldiWindowId,new Promise((e=>{H.Z.get($.kPanelsAsOverlayEnabled)&&Pn.Z.toggleContent(t,"PanelNotes"),setTimeout((()=>e()),200)}))).then((()=>{ul.Z.captureFromNote(this.context.vivaldiWindowId,e.id)}))};_openUrl=e=>{if(Hi.Z.isContextMenuButton(e.button))return;const t=(0,vs.q9)(this.props.note?.url??"");if(!t)return;const n=this.context.vivaldiWindowId,{metaKey:s,shiftKey:i,ctrlKey:o,altKey:a,button:r}=e,{allowOverride:l,...c}=(0,nl.Z)(n,{metaKey:s,shiftKey:i,ctrlKey:o,altKey:a,button:r});d.ZP.openURL(n,t,c)};_toggleMarkdown=()=>{this._saveUrlAndContent(),this.props.toggleMarkdown()};_saveUrlAndContent=async()=>{const{note:e}=this.props;if(!e||"trash"===e.type)return Promise.resolve();py.Z.updateState(this._id,{typedUrl:""});const{url:t,content:n}=this.state;return await Hre(e.id,{url:t,content:n})};_saveContent=e=>{const{note:t}=this.props;t&&Hre(t.id,{content:e})};_onUrlFieldStoreChanged=()=>{const{typedUrl:e}=yy.getUrlfieldState(this._id);e!==this.state.url&&this.setState({url:e})};_onNoteStoreChanged=e=>{if("note"===this.props.note?.type){const e=W3.ZP.getNodeById(this.props.note.id);e&&this.setState({attachments:e.children})}};handleTitleChange=({currentTarget:e})=>{const{note:t}=this.props;if(!t)return;const n=e.value;this.setState({title:n},(()=>{Hre(this.state.id,{title:n})}))};handleTitleKeyUp=e=>{e.keyCode!==oa.Z.KEY_RETURN&&e.keyCode!==oa.Z.KEY_ENTER||(e.stopPropagation(),e.preventDefault(),this.props.focusTree())};onUrlBlur=()=>{const{note:e}=this.props;if(!e||"trash"===e.type)return;const{id:t,url:n}=this.state;Hre(t,{url:n})};onTextBlur=()=>{const{note:e}=this.props;if(!e||"trash"===e.type)return;const{id:t,content:n}=this.state;Hre(t,{content:n})};deleteAttachment=e=>{this.props.note&&Nn.Z.removeNode(e)};handleTextEditorChange=e=>{this.setState({content:e})};handleFocus=e=>{e.currentTarget.select()};render(){const{note:e}=this.props,t=e&&!W3.ZP.isFolder(e),n=e&&W3.ZP.isFolder(e),s=!e,i=e?N()(e.dateAdded).format("LLL"):"",o=Boolean(!e||W3.ZP.isSeparator(e)||n);return(0,fs.jsxs)("div",{className:As()("NotesEditor","cardview",{"NotesEditor--HasAttachments":e&&"note"===e.type&&e.children&&e.children.length>0}),ref:this.refContainer,onKeyDown:this.props.onKeyDown,children:[Wre(Ure,{windowId:this.context.vivaldiWindowId,disabled:o,onToggleMarkDown:this._toggleMarkdown,onDoCapture:this._doCapture,keyAccess:this.props.keyAccess,viewMarkdown:this.props.viewMarkdown,noteId:e?e.id:"-1",onOpenDialog:this.props.onOpenDialog}),t&&!this.props.viewMarkdown&&e&&Wre("span",{className:"NotesEditor-Editor-Background"},void 0,(0,fs.jsx)(Rre,{ref:this.refTextEditor,onBlur:this.onTextBlur,className:"NotesEditor-Editor",disabled:o,content:e.content||"",onChange:this.handleTextEditorChange,onSave:this._saveContent},e.id)),t&&this.props.viewMarkdown&&e&&Wre(Lre,{body:e.content||"",attachments:[]},e.content?e.content.length:"-1"),n&&e&&Wre("div",{className:"folder"},void 0,(0,fs.jsx)("input",{ref:this.refFolderName,type:"text",placeholder:(0,Oe.Z)("Folder"),title:(0,Oe.Z)("Edit folder name"),value:this.state.title,disabled:"trash"===e.type,onFocus:this.handleFocus,onChange:this.handleTitleChange,onKeyUp:this.handleTitleKeyUp})),s&&Wre("div",{className:"NotesEditor-EmptyPlaceholder ",onClick:this.props.onAdd},void 0,(0,Oe.Z)("Add a new note")),e&&"note"===e.type&&Wre(w6,{className:"NotesEditor-Attachments",attachments:this.state.attachments||[],onRemoveAttachment:this.deleteAttachment}),Wre("div",{className:As()("NotesEditor-Metadata",{disabled:o})},void 0,Wre("button",{className:"NotesEditor-MetaIcon NotesEditor-MetaIcon--Url",title:(0,Oe.Z)("Go to address"),disabled:o,tabIndex:o?-1:this.props.keyAccess,onClick:this._openUrl,onAuxClick:this._openUrl,dangerouslySetInnerHTML:{__html:Ts.iD7}}),Wre(pw,{onBlur:this.onUrlBlur,autoFocus:!1,title:(0,Oe.Z)("Enter webpage address"),className:"cardview address",disabled:o,displayUrl:e?.url??"",typedUrl:this.state.url,autocompletionEnabled:!0,typedHistoryEnabled:!1,pageId:this._id,pageContext:this._pageContext,placeholder:e?(0,Oe.Z)("Address"):null,inputId:this._id,urlFragments:null}),Wre("div",{className:"NotesEditor-Created dateCreated",title:(0,Oe.Z)("Date created")},void 0,Wre("div",{className:"NotesEditor-MetaIcon fieldset",dangerouslySetInnerHTML:{__html:Ts.V_c}}),Wre("span",{},void 0,i)))]})}}const $re=Gre;var Kre,jre=n(34155);function Yre(e,t,n,s){Kre||(Kre="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Kre,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Xre=[$.kKeyboardTabToAll,$.kNotesPanelEditorHeight,$.kNotesPanelShowMarkdown],Qre=[{text:(0,Oe.Z)("Title"),value:"title",fullScreenTitle:(0,Oe.Z)("Sort by Title")},{text:(0,Oe.Z)("Address"),value:"url",fullScreenTitle:(0,Oe.Z)("Sort by Address")},{text:(0,Oe.Z)("Content"),value:"content",fullScreenTitle:(0,Oe.Z)("Sort by Content")},{text:(0,Oe.Z)("Created"),value:"dateAdded",fullScreenTitle:(0,Oe.Z)("Sort by Date Created")}];class qre extends hs.PureComponent{static contextType=xi.Z;_editor=hs.createRef();_tree=hs.createRef();canDrop=!1;editorMaxHeight=900;refPanel=hs.createRef();refToolbar=hs.createRef();constructor(e){super(e);const t=H.Z.get($.kNotesPanelSorting);this.state={hasNotes:W3.ZP.hasNotes(),selectedNote:void 0,filter:"",editorHeight:this.props.prefValues[$.kNotesPanelEditorHeight],sorting:{sortOrder:t.sortOrder,sortField:t.sortField,comparator:this.sortComparator}}}componentDidMount(){ud.ZP.addListener(this._onPanelStoreChange),this.context.addEventListener("resize",this._onWindowResize,!1),this._onWindowResize()}componentWillUnmount(){ud.ZP.removeListener(this._onPanelStoreChange),this.context.removeEventListener("resize",this._onWindowResize)}componentDidUpdate(e,t){!e.open&&this.props.open&&jre.nextTick((()=>this._applyTransitionState()))}_onWindowResize=()=>{const e=this.refPanel.current?.getBoundingClientRect().height;this.editorMaxHeight=e?e-250:900};_onStoreChange=(e,t)=>{switch(e.reason){case"added":{if(!t)return void this.setState({hasNotes:!0});const n=W3.ZP.getNodeById(e.id);this.setState({selectedNote:n},(()=>{n&&(this._tree.current?.selectById(e.id),this._editor.current?.focusPrimaryInput())}));break}case"changed":if(this.state.selectedNote?.id!==e.id)return;case"init":if(this.state.selectedNote){const e=this.state.selectedNote.id;this.setState({selectedNote:W3.ZP.getNodeById(e)})}}const n=W3.ZP.hasNotes();!n&&this.state.hasNotes&&(this.setState({selectedNote:void 0}),this.focusSearch()),this.setState({hasNotes:n})};onDropPanelButton=e=>{const t=e.dataTransfer.getData("text/plain"),n=this.context.vivaldiWindowId;(async function(e,t){const n=ie.ZP.getActivePage(e);if(n){const{id:e,url:s}=n;if(await C.Z.utilities.getSelectedText(e)===t)return s}})(n,t).then((e=>{this.onBeforeCreate(!0),e?Nn.Z.createNote(n,{content:t,url:e,type:"note"}):Nn.Z.createNote(n,{content:t,type:"note"})}))};_applyTransitionState=()=>{const e=this.context.vivaldiWindowId,t=ud.ZP.getTransitionState(e,"PanelNotes");Pn.Z.clearTransitionState(e,"PanelNotes"),this._tree.current&&t?(t.selectId&&this._tree.current.selectById(t.selectId),t.setFocus&&this.focusTree()):this._tree.current&&!0===this.state.hasNotes?this.focusTree():this.focusSearch()};_onPanelStoreChange=()=>{const e=ud.ZP.getChangeReason();if(this.props.open)switch(e){case"setFocus":sl(this.context.document,this.refPanel.current)||this.focusTree();break;case"display":jre.nextTick((()=>this._applyTransitionState()))}};onItemSelected=e=>{this.setState({selectedNote:e})};unSelectAll=()=>{this._tree.current?.unSelectAll(),this.setState({selectedNote:void 0})};onSortChange=(e,t)=>{this.setState((n=>({sorting:{...n.sorting,sortOrder:e,sortField:t}}))),Ne.Z.set($.kNotesPanelSorting,{sortOrder:e,sortField:t})};sortComparator=(e,t)=>{if("trash"===e.type)return 1;if("trash"===t.type)return-1;if(W3.ZP.isFolder(e)&&!W3.ZP.isFolder(t))return-1;if(W3.ZP.isFolder(t)&&!W3.ZP.isFolder(e))return 1;const{sortOrder:n,sortField:s}=this.state.sorting;if("title"===s)return this.sortByTitle(e,t,n);return Xi.Z.getDefaultComparator(n,s)(e,t)};sortByTitle=(e,t,n)=>{if(n<=Xi.Z.NO_SORTING)return 0;const s=e.title||E6(e),i=t.title||E6(t);return s||i?s?i?n===Xi.Z.ASCENDING_SORT?s.toLowerCase().localeCompare(i.toLowerCase()):i.toLowerCase().localeCompare(s.toLowerCase()):n===Xi.Z.ASCENDING_SORT?-1:1:n===Xi.Z.ASCENDING_SORT?1:-1:0};getSelectedItem=()=>this._tree.current?.getSelectedItem();onBeforeCreate=e=>{e&&(this.props.prefValues[$.kNotesPanelShowMarkdown]&&this.toggleMarkdown(),this.state.editorHeight===h.mT&&this.resizeToDefault()),this.setState({filter:""})};onAddNote=()=>{this._tree.current?.onAddNote()};onAddFolder=()=>{this._tree.current?.onAddFolder()};deleteSelectedItems=()=>{this._tree.current?.deleteSelectedItems()};handleFilterChange=e=>{this.setState({filter:e})};onSlidebarPosition=(e,t)=>{this.setState((e=>({editorHeight:Math.max(Math.min(e.editorHeight-t,this.editorMaxHeight),h.mT)})))};onSlidebarStop=()=>{this.setState((e=>{let t=e.editorHeight;return t<=h.Cn&&(t=h.mT),Ne.Z.set($.kNotesPanelEditorHeight,parseInt(t)),{editorHeight:t}}))};toggleMarkdown=()=>{Ne.Z.toggle($.kNotesPanelShowMarkdown,!0,!1)};resizeToDefault=()=>{this.setState((e=>{let t=e.editorHeight;return t>h.Cn?(t=h.mT,Ne.Z.set($.kNotesPanelEditorHeight,parseInt(t))):(t=300,Ne.Z.reset($.kNotesPanelEditorHeight)),{editorHeight:t}}))};focusSearch=()=>{this.refToolbar.current?.focusSearch()};focusTree=()=>{this._tree.current?.refTreeList.current?.focusTree()};onContextMenu=e=>{e.nativeEvent.buttons>0&&this.unSelectAll(),this._tree.current?.onContextMenu(e)};onDragEnter=e=>{this.canDrop=-1!==e.dataTransfer.types.findIndex((e=>"text/plain"===e)),e.preventDefault(),e.stopPropagation()};onDragOver=e=>{this.canDrop&&e.nativeEvent.dataTransfer&&(e.nativeEvent.dataTransfer.dropEffect="copy"),e.preventDefault(),e.stopPropagation()};onDrop=e=>{if(this.canDrop){const t=e.dataTransfer.getData("text/plain");t.length>0&&this._tree.current?.onAddNote({content:t})}e.preventDefault(),e.stopPropagation()};_onKeyDown=e=>{if("Escape"===e.key)return this.focusTree(),e.stopPropagation(),void e.preventDefault()};render(){if(!this.props.open)return null;const e=this.state.editorHeight>h.mT,t=Boolean(!this.state.selectedNote||this.state.selectedNote&&"trash"===this.state.selectedNote.type);return(0,fs.jsxs)("div",{ref:this.refPanel,className:"panel",id:"notes-panel",children:[Yre("header",{},void 0,Yre(Dm,{title:this.props.title,showCloseButton:this.props.showCloseButton}),(0,fs.jsx)($6,{ref:this.refToolbar,filter:this.state.filter,hasNotes:this.state.hasNotes,isDeleteDisabled:t,onFilterValueChange:this.handleFilterChange,onAddNote:this.onAddNote,onDeleteSelectedItems:this.deleteSelectedItems,onAddFolder:this.onAddFolder})),!0===this.state.hasNotes&&Yre(gv,{fields:Qre,onSortChange:this.onSortChange,keyAccess:this.props.prefValues[$.kKeyboardTabToAll],sortField:this.state.sorting.sortField,sortOrder:this.state.sorting.sortOrder}),Yre("section",{className:"outerScrollbar",onClick:this.unSelectAll,onContextMenu:!0===this.state.hasNotes?this.onContextMenu:null},void 0,!1===this.state.hasNotes&&Yre("div",{className:"no-notes",onDragEnter:this.onDragEnter,onDragOver:this.onDragOver,onDrop:this.onDrop},void 0,Yre(z6,{onAddNote:this.onAddNote})),(0,fs.jsx)(V6,{ref:this._tree,settings:"NOTES_TREE",filter:this.state.filter,sorting:this.state.sorting,onBeforeCreate:this.onBeforeCreate,onItemSelected:this.onItemSelected,onStoreChange:this._onStoreChange})),Yre("div",{className:As()("notes-editor",{collapsed:this.state.editorHeight===h.mT}),onDragEnter:!0===this.state.hasNotes?null:this.onDragEnter,onDragOver:!0===this.state.hasNotes?null:this.onDragOver,onDrop:!0===this.state.hasNotes?null:this.onDrop,style:{height:this.state.editorHeight}},void 0,Yre(lv,{onSlidebarPosition:this.onSlidebarPosition,onStop:this.onSlidebarStop,onDoubleClick:this.resizeToDefault,returnOffset:!0,position:"bottom"}),e&&(0,fs.jsx)($re,{ref:this._editor,note:this.state.selectedNote,onAdd:this.onAddNote,onOpenDialog:this.props.onOpenDialog,toggleMarkdown:this.toggleMarkdown,viewMarkdown:this.props.prefValues[$.kNotesPanelShowMarkdown],keyAccess:this.props.prefValues[$.kKeyboardTabToAll],onKeyDown:this._onKeyDown,focusTree:this.focusTree},this.state.selectedNote?this.state.selectedNote.id:-1))]})}}const Jre=sa(qre,Xre);var ele;function tle(e,t,n,s){ele||(ele="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:ele,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const nle=[{text:(0,Oe.Z)("title","Title"),value:"title",fullScreenTitle:(0,Oe.Z)("Sort by Title")},{text:(0,Oe.Z)("Read state"),value:"read",fullScreenTitle:(0,Oe.Z)("Sort by Read State")},{text:(0,Oe.Z)("Date"),value:"lastUpdate",fullScreenTitle:(0,Oe.Z)("Sort by Date Updated")},{text:(0,Oe.Z)("Address"),value:"url",fullScreenTitle:(0,Oe.Z)("Sort by Address")}];class sle extends hs.PureComponent{refTreeList=hs.createRef();static contextType=xi.Z;state={sorting:this.props.prefValues[$.kReadingListPanelSorting]};onSortChange=(e,t)=>{const n={sortOrder:e,sortField:t};this.setState({sorting:n}),Ne.Z.set($.kReadingListPanelSorting,{sortOrder:e,sortField:t})};sortComparator=(e,t)=>{const{sortOrder:n,sortField:s}=this.state.sorting;return Xi.Z.getDefaultComparator(n,s)(e,t)};getSelectedIds=()=>(this.refTreeList.current?.getAllSelectedItems()||[]).map((e=>e.id));deleteSelected=()=>{this.refTreeList.current?.onDelete()};onClickUrl=e=>{d.ZP.openURL(this.context.vivaldiWindowId,e,{singleton:!0}),Hn.Z.setReadStatus(e,!0)};onClick=(e,t)=>{this.onClickUrl(t.url)};onItemsActivated=(e,t)=>{t.forEach((e=>{e.url&&this.onClickUrl(e.url)}))};onOpenSelected=()=>{const e=this.getSelectedIds();e&&e.forEach((e=>{e&&this.onClickUrl(e)}))};onClickMark=(e,t,n)=>{n&&(0,to.ZP)(n),Hn.Z.setReadStatus(e,t)};copy=e=>{yi.Z.copyTextToClipboard(e)};onRemoveSelected=async e=>{e.forEach((e=>Hn.Z.remove(e)))};rowComponent=e=>{const t=e.node;return tle("div",{className:"readinglist-item-large"},t.url,tle(Nw,{onClickMark:this.onClickMark,onClickRemove:()=>{},entry:t}))};getMenuCapability=async(e,t,n)=>{const s=this.context.vivaldiWindowId;switch(e.action){case"CONTEXT_OPEN":return{handler:()=>this.onOpenSelected(),isVisible:()=>Boolean(n),...t(s,e,{})};case"CONTEXT_MARK_READ":return{handler:()=>this.onClickMark(n.url,!0),isVisible:()=>Boolean(n)&&!n.read,...t(s,e,{})};case"CONTEXT_MARK_UNREAD":return{handler:()=>this.onClickMark(n.url,!1),isVisible:()=>Boolean(n)&&n.read,...t(s,e,{})};case"CONTEXT_COPY_URL":return{handler:()=>this.copy(n.url),isVisible:()=>Boolean(n),...t(s,e,{})};default:return{...t(s,e,{})}}};getMenuVisibility=(e,t)=>{if(!t)return!1;switch(e.action){case"CONTEXT_OPEN":case"CONTEXT_COPY_URL":case"CONTEXT_MARK_READ":case"CONTEXT_MARK_UNREAD":case"CONTEXT_DELETE":return!0;default:return!1}};menu={name:"readinglist",getCapability:this.getMenuCapability,getVisibility:this.getMenuVisibility};render(){const e=this.props.prefValues[$.kReadingListPanelSingleClickOpens],t={sortOrder:this.state.sorting.sortOrder,sortField:this.state.sorting.sortField,comparator:this.sortComparator};return(0,fs.jsxs)(fs.Fragment,{children:[tle(gv,{fields:nle,manualSorting:!1,onSortChange:this.onSortChange,keyAccess:this.props.keyAccess,compact:!0,sortField:this.state.sorting.sortField,sortOrder:this.state.sorting.sortOrder}),tle("section",{className:"outerScrollbar"},void 0,(0,fs.jsx)(yo,{ref:this.refTreeList,settings:"READING_LIST_TREE",rowComponent:this.rowComponent,nodes:this.props.nodes,onSelect:this.props.onItemSelected,menu:this.menu,hasChildren:xE.Z,isFolder:xE.Z,onItemsActivated:this.onItemsActivated,onItemClick:e?this.onClick:void 0,onItemDoubleClick:e?void 0:this.onClick,delete:this.onRemoveSelected,enableDragAndDrop:!1,supportsInlineEdit:!1,sorting:t,rowHeight:68}))]})}}const ile=sle;var ole;function ale(e,t,n,s){ole||(ole="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:ole,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const rle=[$.kReadingListPanelSingleClickOpens,$.kReadingListPanelSorting];function lle(e){return e.map((e=>({...e,id:e.url})))}class dle extends hs.PureComponent{static contextType=xi.Z;winId=this.context.vivaldiWindowId;_tree=hs.createRef();state={items:[],selected:"",isUrlSupported:!1,filter:""};componentDidMount(){const{selectWindow:e}=this.context;Sw.Z.addListener(this._onStoreChanged),ie.ZP.addListener(this._onPageStoreChanged,e),this._onStoreChanged(),this._onPageStoreChanged()}componentWillUnmount(){Sw.Z.removeListener(this._onStoreChanged),ie.ZP.removeListener(this._onPageStoreChanged)}_onStoreChanged=()=>{const e=this.state.filter?Sw.Z.getFilter(this.state.filter):Sw.Z.getList();this.setState({items:lle(e)})};_onPageStoreChanged=()=>{const{url:e}=ie.ZP.unsafeGetActivePage(this.winId);this.setState({isUrlSupported:(0,Hn.M)(e)})};addCurrentPage=()=>Hn.Z.add(this.context.vivaldiWindowId);deleteSelected=()=>this._tree.current?.deleteSelected();onToggleReadStatus=()=>{this.setState((e=>{const t=e.items.find((t=>t.id===e.selected));t&&Hn.Z.setReadStatus(t.url,!t.read)}))};handleFilterChange=e=>{const t=e.target.value;this.setState({filter:t}),hs.startTransition((()=>{const e=lle(t?Sw.Z.getFilter(t):Sw.Z.getList());this.setState({items:e})}))};focusTree=()=>{this._tree.current&&this._tree.current.refTreeList.current?.focusTree()};onItemSelected=e=>{if(e){if(e.id===this.state.selected)return;this.setState({selected:e.id})}else this.setState({selected:""})};renderEmptyState=()=>ale("div",{className:"panel-empty-state"},void 0,ale("span",{dangerouslySetInnerHTML:{__html:Ts.MLu}}),ale("h1",{},void 0,(0,Oe.Z)("Add your first entry to the reading list")),ale("p",{className:"faded-text"},void 0,(0,Oe.Z)("Click the “+“ button to add the current webpage to the reading list.")));render(){if(!this.props.open)return null;const e=this.state.items.find((e=>e.url===this.state.selected)),t=0===this.state.items.length&&!this.state.filter;return ale("div",{className:"panel",id:"readinglist"},void 0,ale("header",{},void 0,ale(Dm,{title:this.props.title,showCloseButton:this.props.showCloseButton}),ale("div",{className:"toolbar toolbar-default toolbar-wrap"},void 0,ale("input",{type:"search",placeholder:(0,Oe.Z)("verb","Search"),value:this.state.filter,disabled:t,onChange:this.handleFilterChange}),ale("div",{className:"toolbar"},void 0,ale("div",{className:"toolbar-group"},void 0,ale(Fa,{onClick:this.addCurrentPage,tooltip:(0,Oe.Z)("Add current page"),disabled:!this.state.isUrlSupported,image:Ts.md4.small}),ale(Fa,{onClick:this.deleteSelected,disabled:""===this.state.selected,image:Ts.M2k.small,tooltip:(0,Oe.Z)("other","Delete")})),ale(Fa,{onClick:this.onToggleReadStatus,tooltip:e?.read?(0,Oe.Z)("Set as Unread"):(0,Oe.Z)("Set as Read"),disabled:""===this.state.selected,image:e?.read?Ts.sgm.small:Ts.D7r.small})))),t?this.renderEmptyState():(0,fs.jsx)(ile,{ref:this._tree,nodes:this.state.items,keyAccess:this.props.keyAccess,focusTree:this.focusTree,prefValues:this.props.prefValues,onItemSelected:this.onItemSelected}))}}const cle=sa(dle,rle);var hle;function ple(e,t,n,s){hle||(hle="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:hle,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var ule=ple("g",{fill:"none",stroke:"currentColor"},void 0,ple("path",{d:"M1 1.5h3.5v-1h7v1h-8H15"}),ple("path",{d:"M3.5 3.5v11h9v-11zm3 8v-4zm3 0v-4z"})),gle=ple("g",{fill:"none",stroke:"currentColor"},void 0,ple("path",{d:"M1.5,1.5 L1.5,9.5"}),ple("path",{d:"M9.5,1.5 L9.5,9.5"}),ple("path",{d:"M1.5,9.5 L9.5,9.5"}),ple("path",{d:"M1.5,1.5 L9.5,1.5"}),ple("path",{d:"M3.5,9.5 L3.5,11.5"}),ple("path",{d:"M11.5,3.5 L11.5,11.5"}),ple("path",{d:"M3.5,11.5 L11.5,11.5"}),ple("path",{d:"M9.5,3.5 L11.5,3.5"}),ple("path",{d:"M5.5,11.5 L5.5,13.5"}),ple("path",{d:"M13.5,5.5 L13.5,13.5"}),ple("path",{d:"M5.5,13.5 L13.5,13.5"}),ple("path",{d:"M11.5,5.5 L13.5,5.5"})),mle=ple("g",{transform:"translate(3, 2)",fill:"none",stroke:"currentColor"},void 0,ple("polygon",{points:"2.5 5.5 6.5 9.5 7.5 9.5 7.5 5.5 11.5 2.5 9.5 0.5 6.5 4.5 2.5 4.5"}),ple("polygon",{points:"0 12 3 8 4 9"})),vle=ple("g",{fill:"none",stroke:"currentColor"},void 0,ple("path",{d:"M13.246 7.338C14.268 7.668 15 8.558 15 9.6c0 1.326-1.17 2.9-2.634 2.9H3.5C2.044 12.5 1 10.922 1 9.6c0-1.051.735-1.944 1.77-2.269C2.913 6.354 3.827 5.6 4.936 5.6c.584 0 1.114.208 1.505.549C6.92 4.899 8.22 4 9.75 4c1.934 0 3.5 1.432 3.5 3.2l-.004.138Z"})),fle=ple("polygon",{points:"16.5 3.5 16.5 0.5 1.5 0.5 1.5 3.5"}),yle=ple("path",{d:"M1.5,3.5 L1.5,12.5"}),Cle=ple("path",{d:"M16.5,3.5 L16.5,12.5"}),wle=ple("path",{d:"M1.5,12.5 L16.5,12.5"}),ble=ple("path",{d:"M4.5,0.5 L4.5,3.5"}),Sle=ple("path",{d:"M7.5,0.5 L7.5,3.5"}),Ile=ple("polygon",{points:"4.5 6.5 4.5 8.5 7.5 6.5",strokeWidth:"2"});class kle extends hs.PureComponent{render(){const e="trash"===this.props.shape,t=As()({"folder-icon":!e,"folder-trash":e});return"emoji"===this.props.shape||"workspace"===this.props.shape?this.props.url?ple(Ss,{className:"workspace-icon",url:this.props.url,loadType:"emoji"===this.props.shape?"emoji":"faviconFromCache"}):(console.warn("Url missing for workspace/emoji type"),null):ple("svg",{width:"16",height:"16",viewBox:"0 0 16 16",className:t,style:this.props.leftMargin?{marginLeft:this.props.leftMargin}:null},void 0,e&&ule,"stack"===this.props.shape&&gle,"pinned"===this.props.shape&&mle,"sync"===this.props.shape&&vle,"folder"===this.props.shape&&ple("g",{transform:"translate(-1, 1)",fill:"none",stroke:"currentColor"},void 0,fle,yle,Cle,wle,ble,Sle,this.props.activeWindow&&Ile))}}const Ale=kle;var Tle;function Zle(e,t,n,s){Tle||(Tle="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Tle,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ele=!1;function _le(e,t,n){const s=(e,t,n,s,i)=>{const o=(e,t,n,s)=>{const i=[];for(let o=0;o<n.length;o++){const a=n[o];if(a.group){let n=i.find((e=>"stack"===e.type&&e.group===a.group));if(n||(n={type:"stack",id:a.id.toString()+"_tabstack",index:t+i.length,parentId:e,group:a.group,url:"",name:(0,Oe.Z)("title","Stack")+" - "+(a.groupName||a.name),rawName:a.groupName||a.name,quarantine:!1,children:[]},i.push(n)),n.children){const e=n.children.length;n.children.push({type:"tab",id:a.id.toString(),index:e,parentId:n.id,group:"",url:a.url,name:(0,je.d6)(a.url,a.name||a.url),quarantine:a.quarantine})}}else void 0!==s&&s!==a.quarantine||i.push({type:"tab",id:a.id.toString(),index:t+i.length,parentId:e,group:"",url:a.url,name:(0,je.d6)(a.url,a.name||a.url),quarantine:a.quarantine})}return i},a=s.filter((e=>e.pinned===n)).map(((n,s)=>{if(void 0===i||i===n.quarantine)return{type:"tab",id:n.id.toString(),index:t+s,parentId:e,group:n.group,groupName:n.group?n.groupName:void 0,url:n.url,name:(0,je.d6)(n.url,n.name||n.url),quarantine:n.quarantine}})).filter(Boolean);if(n){const n=e+"_pinned";return[{type:"pinned",id:n,parentId:e,index:t,group:"",url:"",name:(0,Oe.Z)("Pinned Tabs"),children:o(n,0,a,i),quarantine:!1}]}return o(e,t,a)},i=(e,n,i)=>t.windows.map((t=>{const n=t.id.toString()+"_"+e,o=s(n,0,!0,t.tabs,i),a=s(n,o.length,!1,t.tabs,i),r=[...o,...a];if(r.length)return{type:"window",id:n,index:0,parentId:e,group:"",name:(0,Oe.Z)("title","Window"),url:"",quarantine:!1,children:r}})).filter(Boolean).map(((e,t)=>({...e,index:t+n}))),o=(e,n,i)=>t.workspaces.map((t=>{const n=t.id.toString()+"_"+e,o=s(n,0,!0,t.tabs,i),a=s(n,o.length,!1,t.tabs,i),r=[...o,...a];if(r.length)return{type:"workspace",id:n,index:0,parentId:e,group:"",name:(0,Oe.Z)("title","Workspace")+" - "+t.name,rawName:t.name,url:"",icon:t.icon,emoji:t.emoji,quarantine:!1,children:r}})).filter(Boolean).map(((e,t)=>({...e,index:t+n}))),a=i(e,0,void 0),r=o(e,a.length,void 0);let l=[];if(n){const t="trash",n=i(t,0,!0),s=o(t,n.length,!0);l=[{type:"trash",id:t,index:a.length+r.length,parentId:e,group:"",name:(0,Oe.Z)("Trash"),url:"",quarantine:!1,children:[...n,...s]}]}return[...a,...r,...l]}function Mle(e,t,n){if(!t.trim())return _le(e,n,Ele);const s=(e,t)=>e.name.toLowerCase().includes(t),i=function(e,t,n){let o=!1;for(let a=0;a<e.length;a++){const r=e[a];let l=!1;if(r.children){const e={...r,children:[]};i(r.children,e.children,n)&&(t.push(e),o=!0,l=!0)}if(!l&&s(r,n)){const e={...r};t.push(e),o=!0}}return o},o=[];return i(_le(e,n,Ele),o,t.toLowerCase()),o}class Nle extends hs.PureComponent{static contextType=xi.Z;refTreeList=hs.createRef();constructor(e){super(e),this.state={rootId:"0",nodes:Mle("0",e.filter,e.content)}}componentDidUpdate(e){this.props.content===e.content&&this.props.filter===e.filter||this.setState({nodes:Mle("0",this.props.filter,this.props.content)})}_getNodeById=e=>{const t=function(n){for(let s=0;s<n.length;s++){const i=n[s];if(i.id===e)return i;if(i.children){const e=t(i.children);if(e)return e}}};return t(this.state.nodes)};_isFolder=e=>"tab"!==e.type;_isTab=e=>"tab"===e.type;_isStack=e=>"stack"===e.type;_isPin=e=>"pinned"===e.type;_isWorkspace=e=>"workspace"===e.type;_isWindow=e=>"window"===e.type;_isPinnable=e=>this._isTab(e)||this._isStack(e);_isPinned=e=>{if(this._isPinnable(e)){let t=this._getNodeById(e.parentId);for(;t;){if("pinned"===t.type)return!0;t=this._getNodeById(t.parentId)}}return!1};_isStacked=e=>{if(this._isTab(e)){let t=this._getNodeById(e.parentId);for(;t;){if(this._isStack(t))return!0;t=this._getNodeById(t.parentId)}}return!1};_isValidForEdit=e=>{const t=this._getNodeById(e);return!!t&&(this._isWorkspace(t)||this._isStack(t))};_hasChildren=e=>this._isFolder(e)&&Boolean(e.children?.length);_handleExpandClick=(e,t)=>{const n=e.altKey;this.refTreeList.current?.toggleSelectedExpansion(t,n)};_getChildren=e=>e.children??[];_getWindow=e=>{let t=e;for(;t&&!this._isWindow(t);)t=this._getNodeById(t.parentId);return t};_getWorkspace=e=>{let t=e;for(;t&&!this._isWorkspace(t);)t=this._getNodeById(t.parentId);return t};_getGroup=e=>{let t=e;for(;t&&!this._isStack(t);)t=this._getNodeById(t.parentId);return t};_getSelected=()=>(this.refTreeList.current?.getAllSelectedItems()??[]).map((e=>this._getNodeById(e.id))).filter(Boolean);_getSelectedUrls=()=>this._getSelected().filter((e=>this._isTab(e))).map((e=>e.url));_openSession=e=>{const t=this._getSelected().filter((e=>this._isTab(e))).map((e=>Number(e.id)));Kn.Z.open(this.context.vivaldiWindowId,[this.props.content.id],e,t)};_openInTab=(e,t)=>{const n={inCurrent:e,inBackground:!e&&(t||H.Z.get($.kTabsOpenNewInBackground)),inNewWindow:!1,allowOverride:!1,incognito:!1};Ds.ZP.openUrls(this.context.vivaldiWindowId,this._getSelectedUrls(),n,!0)};_openInNewWindow=e=>{const t={inCurrent:!1,inBackground:!1,inNewWindow:!0,allowOverride:!1,incognito:e};Ds.ZP.openUrls(this.context.vivaldiWindowId,this._getSelectedUrls(),t,!0)};_onNodeDoubleClick=(e,t)=>{this._isTab(t)&&e.button!==Hi.Z.kCenter&&this._openSession(!0)};_onNodeMouseUp=(e,t)=>{this._isTab(e)&&t.button===Hi.Z.kCenter&&(this._openSession(!0),t.preventDefault(),t.stopPropagation())};_openWithEventModifiers=e=>{this._openSession(!0)};_isValidDragSource=e=>this._isTab(e)||this._isStack(e);_validateForDrag=e=>{const t=e.map((e=>this._getNodeById(e))).filter(Boolean);if(1===t.length&&this._isStack(t[0]))return[t[0].id];return t.filter((e=>this._isStack(e))).length>1?[]:e.map((e=>this._getNodeById(e))).filter(Boolean).filter((e=>this._isTab(e))).map((e=>e.id))};_getDragData=(e,t)=>{const n=t.map((e=>this._getNodeById(e))).filter(Boolean).filter((e=>this._isTab(e)));switch(e){case"text/plain":case"vivaldi/x-title":{const e=[];return n.forEach((t=>{e.push(t.name)})),e.join("\r\n")}case"text/uri-list":case"vivaldi/x-uri-list":{const e=[];return n.forEach((t=>{this._isTab(t)&&e.push(t.url)})),e.join("\r\n")}default:return""}};_getDropSupport=(e,t)=>{const n={available:!1,onto:!1,edge:"both"};return t.dataTransfer.types.some((e=>e===nae.AP))&&(n.available=!0,n.onto=this._isFolder(e),this._isWindow(e)?n.edge="none":this._isPin(e)&&(n.edge="below")),n};_copy=(e,t)=>{const{clipboardData:n}=e;if(n){const e=t.map((e=>e.url)).filter(Boolean).map((e=>je.jk.getHoverUrl(e))).join("\n");n.setData("text/plain",e),n.setData("text/uri-list",e),n.setData("vivaldi/x-uri-list",e)}e.preventDefault()};_onDelete=e=>Kn.Z.modifyContent(this.props.content.id,{ids:this._validateForDeletion(e).map((e=>Number(e))),remove:!0});_onDeleteWithoutQuarantine=()=>{const e=this._getSelected().filter((e=>this._isTab(e))).map((e=>Number(e.id)));return Kn.Z.modifyContent(this.props.content.id,{ids:e,remove:!0})};_setPinned=e=>{const t=this._getSelected(),n=t.filter((e=>"stack"===e.type)).map((e=>this._getChildren(e))).filter(Boolean).reduce(((e,t)=>e.concat(t)),[]),s=t.filter((e=>this._isTab(e))).filter((e=>-1===n.findIndex((t=>t===e.id)))),i=[...n,...s].map((e=>Number(e.id)));Kn.Z.modifyContent(this.props.content.id,{pin:e,ids:i})};_getNodesForNewStack=()=>this._getSelected().filter((e=>!this._isWindow(e)&&!this._isWorkspace(e))).flatMap((e=>e.children||e)).flatMap((e=>e.children||e));_setTabStack=e=>{const t=this._getNodesForNewWindow();if(t.length>0){const n=t.map((e=>Number(e.id)));e?Kn.Z.modifyContent(this.props.content.id,{tabstack:!0,ids:n,target:{beforeTabId:-1,group:crypto.randomUUID()}}):Kn.Z.modifyContent(this.props.content.id,{tabstack:!1,ids:n})}};_getNodesForNewWindow=()=>this._getSelected().filter((e=>!this._isWindow(e)&&!this._isWorkspace(e))).flatMap((e=>e.children||e)).flatMap((e=>e.children||e));_setWindow=()=>{const e=this._getNodesForNewWindow();if(e.length>0){const t=[];e.forEach((e=>{const n=this._getGroup(e);n&&!t.find((e=>e.group===n.group))&&t.push({group:n.group,alias:crypto.randomUUID()})})),Kn.Z.modifyContent(this.props.content.id,{window:!0,ids:e.map((e=>Number(e.id))),groupAliases:t})}};_setWorkspace=()=>{const e=this._getNodesForNewWindow();if(e.length>0){const t=[];e.forEach((e=>{const n=this._getGroup(e);n&&!t.find((e=>e.group===n.group))&&t.push({group:n.group,alias:crypto.randomUUID()})})),Kn.Z.modifyContent(this.props.content.id,{workspace:!0,ids:e.map((e=>Number(e.id))),groupAliases:t,workspaceId:Date.now(),workspaceState:{groups:t,item:{id:Date.now(),name:(0,Oe.Z)("command","New Workspace"),icon:Kj.Z.getDefaultIcon(),emoji:""}}})}};_validateForDeletion=e=>e.map((e=>this._getNodeById(e))).filter(Boolean).filter((e=>Boolean(e?.quarantine))).map((e=>e.id));_setQuarantine=async e=>{const t=this._getSelected().filter((e=>this._isTab(e))).map((e=>Number(e.id)));Kn.Z.modifyContent(this.props.content.id,{ids:t,quarantine:e})};_getTitle=e=>{const t=this._getNodeById(e);return t?t.rawName??t.name:""};_getId=e=>e.split("_")[0];_setTitle=(e,t)=>{const n=this._getNodeById(e);if(n)switch(n.type){case"workspace":Kn.Z.modifyContent(this.props.content.id,{ids:[Number(this._getId(e))],type:"workspace",title:t});break;case"stack":n.children?.length&&Kn.Z.modifyContent(this.props.content.id,{ids:[Number(n.children[0].id)],type:"group",title:t})}};_canMoveUpDown=(e,t)=>this._isTab(e)||this._isStack(e);_onMove=(e,t,n)=>{const s=e=>{for(const t of e){if(this._isTab(t))return t;if(this._isStack(t)&&t.children){const e=s(t.children);if(e)return e}}for(const t of e)if(t.children){const e=s(t.children);if(e)return e}},i=void 0===t.parentId?void 0:this._getNodeById(t.parentId),o=this._getNodeById(e[0]);if(i&&o){let n,a,r;this._isPin(i)||this._isPinned(i)?this._isPinned(o)||(n=!0):this._isPinned(o)&&(n=!1),this._isStack(i)?(this._getGroup(o)?.group??"")!==i.group&&(a=i.group):this._getGroup(o)&&(this._isStack(o)||(a=""));const l=this._getWorkspace(i);let d;l?(this._getWorkspace(o)?.id??"")!==l.id&&(r=Number(this._getId(l.id))):this._getWorkspace(o)&&(r=-1),this._isStack(o)&&(e=o.children?o.children.map((e=>e.id)):[]);const c=t.index??0;if(i.children&&i.children.length>c){const e=i.children,t=e[c];d=this._isTab(t)?t:s(e.slice(c))}const h=this._getWindow(i),p={beforeTabId:d?Number(d.id):-1};void 0!==a&&(p.group=a),void 0!==n&&(p.pinned=n),h&&(p.windowId=Number(this._getId(h.id))),void 0!==r&&(p.workspace=r),Kn.Z.modifyContent(this.props.content.id,{move:!0,ids:e.map((e=>Number(this._getId(e)))),target:p})}return Promise.resolve([])};_handleMouseEnter=(e,t)=>{this._isTab(t)&&c.Z.setStatus(e,je.jk.getHoverUrl(t.url))};_handleMouseLeave=e=>{c.Z.clearStatus(e)};getMenuCapability=async(e,t,n)=>{const s=this.context.vivaldiWindowId,i="tab"===n.type;switch(e.action){case"CONTEXT_OPEN_SESSION_IN_NEW_WINDOW":return{handler:()=>this._openSession(!0),isVisible:()=>i,...t(s,e,{})};case"CONTEXT_OPEN_SESSION":return{handler:()=>this._openSession(!1),isVisible:()=>i,...t(s,e,{})};case"CONTEXT_OPEN_IN_NEW_TAB":return{handler:()=>this._openInTab(!1,!1),isVisible:()=>i,...t(s,e,{})};case"CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB":return{handler:()=>this._openInTab(!1,!0),isVisible:()=>i&&!H.Z.get($.kTabsOpenNewInBackground),...t(s,e,{})};case"CONTEXT_OPEN_IN_TAB":return{handler:()=>this._openInTab(!0,!1),isVisible:()=>i,...t(s,e,{})};case"CONTEXT_OPEN_IN_NEW_WINDOW":return{handler:()=>this._openInNewWindow(!1),isVisible:()=>i,...t(s,e,{})};case"CONTEXT_OPEN_IN_PRIVATE_WINDOW":return{handler:()=>this._openInNewWindow(!0),isVisible:()=>i,...t(s,e,{})};case"CONTEXT_OPEN_LINK_MENU":return{handler:()=>{},isVisible:()=>i,...t(s,e,{})};case"CONTEXT_QUARANTINE":return{handler:()=>this._setQuarantine(!n.quarantine),isVisible:()=>i,checked:n.quarantine,...t(s,e,{})};case"CONTEXT_DELETE_WITHOUT_QUARANTINE":return{handler:()=>this._onDeleteWithoutQuarantine(),isVisible:()=>i,...t(s,e,{})};case"CONTEXT_PIN":return{handler:()=>this._setPinned(!this._isPinned(n)),isVisible:()=>this._isPinnable(n)&&!this._isPinned(n),...t(s,e,{})};case"CONTEXT_UNPIN":return{handler:()=>this._setPinned(!this._isPinned(n)),isVisible:()=>this._isPinnable(n)&&this._isPinned(n),...t(s,e,{})};case"CONTEXT_NEW_STACK":return{handler:()=>this._setTabStack(!0),isVisible:()=>this._getNodesForNewStack().length>=2,...t(s,e,{})};case"CONTEXT_REMOVE_STACK":return{handler:()=>this._setTabStack(!1),isVisible:()=>1===this._getSelected().length&&this._isStack(n),...t(s,e,{})};case"CONTEXT_NEW_WINDOW":return{handler:()=>this._setWindow(),isVisible:()=>this._getNodesForNewWindow().length>0,...t(s,e,{})};case"CONTEXT_NEW_WORKSPACE":return{handler:()=>this._setWorkspace(),isVisible:()=>this._getNodesForNewWindow().length>0,...t(s,e,{})};default:return{...t(s,e,{})}}};getMenuVisibility=(e,t)=>{if(t)switch(e.action){case"CONTEXT_COPY":return this._isTab(t);case"CONTEXT_RENAME":return this._isValidForEdit(t.id);case"CONTEXT_DELETE":return t.quarantine;case"CONTEXT_EXPAND_ALL":case"CONTEXT_COLLAPSE_ALL":return!0;default:return!1}else switch(e.action){case"CONTEXT_EXPAND_ALL":case"CONTEXT_COLLAPSE_ALL":return!0;default:return!1}};getFolderShape=e=>{switch(e.type){case"trash":return"trash";case"stack":return"stack";case"pinned":return"pinned";case"workspace":if(e.emoji)return"emoji";if(e.icon)return"workspace"}return"folder"};getFolderIconUrl=e=>{if("workspace"===e.type){if(e.emoji)return e.emoji;if(e.icon)return e.icon}return""};_getChildCount=e=>{let t=0;const n=e=>{e.forEach((e=>{this._isFolder(e)&&e.children?n(e.children):t++}))};return this._isFolder(e)&&e.children&&(n(e.children),0===t&&this._isWindow(e)&&(t=1)),t};rowComponent=e=>{const t=e.node,n=e.level,s=(n+1)*mo,i=n*mo,o=i+10,a=t.url,r=t.quarantine&&!0,l=t.children?this._getChildCount(t):0,{favIconUrl:d,favIconLoadType:c}=(0,je.yl)(a,""),h=this.context.vivaldiWindowId;return[Zle("label",{title:t.name,onMouseEnter:()=>this._handleMouseEnter(h,t),onMouseLeave:()=>this._handleMouseLeave(h)},"window__panel__"+t.id,this._hasChildren(t)&&Zle("span",{className:"expand-icon",style:{marginLeft:i},onMouseUp:e=>this._handleExpandClick(e,t.id),dangerouslySetInnerHTML:{__html:Ts.nfH}}),this._isFolder(t)&&Zle(Ale,{leftMargin:this._hasChildren(t)?0:s,shape:this.getFolderShape(t),url:this.getFolderIconUrl(t)}),!this._isFolder(t)&&(0,fs.jsxs)(fs.Fragment,{children:[Zle("span",{style:{marginLeft:o}}),a.startsWith("<svg")?Zle("span",{className:"svg-icon",dangerouslySetInnerHTML:{__html:a}}):Zle(Ss,{className:"fav-icon",url:d,loadType:c})]}),void 0!==e.inlineEditText&&Zle("input",{type:"text",value:e.inlineEditText,onChange:e.onChange,onFocus:e.onFocus,onBlur:e.onBlur,autoFocus:!0}),void 0===e.inlineEditText&&r&&Zle("span",{},void 0,Zle("s",{},void 0,t.name)),void 0===e.inlineEditText&&!r&&Zle("span",{},void 0,t.name),this._hasChildren(t)&&Zle("span",{className:"item-count"},void 0,l))]};getRowComponentProps=e=>({...e});menu={name:"sessioncontentlist",getCapability:this.getMenuCapability,getVisibility:this.getMenuVisibility};render(){return(0,fs.jsx)(yo,{ref:this.refTreeList,rootId:this.state.rootId,nodes:this.state.nodes,folderMode:"expand",settings:"CONTENT_TREE",onItemMouseUp:this._onNodeMouseUp,onItemDoubleClick:this._onNodeDoubleClick,onItemsActivated:this._openWithEventModifiers,supportsUpDownMove:this._canMoveUpDown,onMove:this._onMove,isValidToEdit:this._isValidForEdit,validateForDeletion:this._validateForDeletion,isValidDragSource:this._isValidDragSource,validateForDrag:this._validateForDrag,mimeType:nae.AP,getDragData:this._getDragData,getDropSupport:this._getDropSupport,getTitle:this._getTitle,saveTitle:this._setTitle,onCopy:this._copy,delete:this._onDelete,rowComponent:this.rowComponent,getRowComponentProps:this.getRowComponentProps,hasChildren:this._hasChildren,isFolder:this._isFolder,menu:this.menu,supportsInlineEdit:!0})}}const Ple=Nle;var Dle;function xle(e,t,n,s){Dle||(Dle="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Dle,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var Ole=xle("br",{});function Lle({onAdd:e}){return xle("div",{className:"notes-welcome"},void 0,xle("div",{className:"note-empty-state",onClick:e},void 0,xle("span",{dangerouslySetInnerHTML:{__html:Ts.vOf}}),xle("h1",{},void 0,(0,Oe.Z)("Sessions")),xle("p",{className:"faded-text"},void 0,(0,Oe.Z)("Save and restore your tabs and Workspaces with Sessions.")),Ole,xle("p",{className:"faded-text"},void 0,(0,Oe.Z)("Click the “+” button above to save your first Session backup."))))}var Rle,Ble=n(34155);function Fle(e,t,n,s){Rle||(Rle="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Rle,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Vle=[{text:(0,Oe.Z)("Title"),value:"name",fullScreenTitle:(0,Oe.Z)("Sort by Title")},{text:(0,Oe.Z)("Created"),value:"createDateJS",fullScreenTitle:(0,Oe.Z)("Sort by Date Created")},{text:(0,Oe.Z)("Modified"),value:"modifyDateJS",fullScreenTitle:(0,Oe.Z)("Sort by Date Modified")}],Wle={id:-1,windows:[],workspaces:[]},Ule=[$.kKeyboardTabToAll,$.kSessionsPanelSorting,$.kSessionsSaveDays,$.kSessionsSaveOnExit];class Hle extends hs.PureComponent{static contextType=xi.Z;refTree=hs.createRef();nodeRef=hs.createRef();id=crypto.randomUUID();constructor(e){super(e);const t=this.props.prefValues[$.kSessionsPanelSorting];this.state={mode:"main",content:Wle,contentTitle:"",hasSessions:nae.ZP.hasSessions(),autoSave:!0,sessionFilter:"",contentFilter:"",sorting:{sortOrder:t.sortOrder,sortField:t.sortField,comparator:this._sortComparator}}}componentDidMount(){nae.ZP.addListener(this._onStoreChanged)}componentWillUnmount(){nae.ZP.removeListener(this._onStoreChanged)}componentDidUpdate(e,t){!e.open&&this.props.open&&nae.ZP.hasSessions()&&Ble.nextTick((()=>this._focusTree()))}_onStoreChanged=e=>{const t=e=>void 0!==e&&e===this.state.content.id;switch(e.reason){case"init":case"added":this.setState({hasSessions:nae.ZP.hasSessions()});break;case"deleted":this.setState({hasSessions:nae.ZP.hasSessions()}),t(e.info?.item.id)&&this._onLeaveEdit();break;case"changed":if(e.info?.item){const n=e.info.item.id;t(n)&&this.setState({contentTitle:nae.ZP.getTitle(n)})}break;case"content":if(e.info?.item.content){const n=e.info.item.content;(e.owner===this.id||t(n.id))&&this.setState({mode:"edit",content:n,contentTitle:nae.ZP.getTitle(n.id)})}}};_onSortChange=(e,t)=>{this.setState((n=>({sorting:{sortOrder:e,sortField:t,comparator:n.sorting.comparator}}))),Ne.Z.set($.kSessionsPanelSorting,{sortOrder:e,sortField:t})};_sortComparator=(e,t)=>{if(nae.ZP.isTrashFolder(e.id))return 1;if(nae.ZP.isTrashFolder(t.id))return-1;if(nae.ZP.isAutoSaveNode(e.id))return 1;if(nae.ZP.isAutoSaveNode(t.id))return-1;const{sortOrder:n,sortField:s}="history"===e.type&&"history"===t.type?{sortOrder:Xi.Z.DESCENDING_SORT,sortField:"modifyDateJS"}:this.state.sorting;return Xi.Z.getDefaultComparator(n,s)(e,t)};_getSelected=()=>this.refTree.current?.getSelected()??[];_focusTree=()=>{this.refTree.current?.focusTree()};_onSessionFilterChange=e=>{this.setState({sessionFilter:e.target.value})};_onContentFilterChange=e=>{this.setState({contentFilter:e.target.value})};_onAdd=()=>{this.refTree.current?.add()};_onDelete=()=>{this.refTree.current?.deleteSelected()};_onOpen=e=>{Kn.Z.open(this.context.vivaldiWindowId,e,!0)};_onEdit=e=>{Kn.Z.requestContent(e,this.id)};_onLeaveEdit=()=>{this.setState({mode:"main",content:Wle,contentTitle:""})};_onEditFromButton=()=>{const e=this._getSelected();1===e.length&&Kn.Z.requestContent(e[0].id,this.id)};_onUpdateAutoSave=()=>{this.setState((e=>({autoSave:!e.autoSave})))};onAutosaveChanged=()=>{"on"!==this.props.prefValues[$.kSessionsSaveOnExit]?Ae.Z.showEnableSessionAutosaveDialog(this.context.vivaldiWindowId,{mode:"intro"}):Ne.Z.toggle($.kSessionsSaveOnExit,"on","off")};getSaveDaysText=()=>{if("on"!==this.props.prefValues[$.kSessionsSaveOnExit])return"";const e=this.props.prefValues[$.kSessionsSaveDays];return 1===e?(0,Oe.Z)("Last day"):(0,Oe.Z)("$1 day","Last $1 days",[e])};renderHeader=()=>{const e="edit"===this.state.mode?(0,Oe.Z)('Edit "$1"',[this.state.contentTitle]):this.props.title;return Fle("header",{},void 0,Fle("div",{className:"toolbar-back-navigation"},void 0,"edit"===this.state.mode&&Fle(Fa,{tooltip:(0,Oe.Z)("command","Go Back to Session List"),tabIndex:this.props.prefValues[$.kKeyboardTabToAll],onClick:this._onLeaveEdit,image:Ts.mgF.small}),Fle(Dm,{title:e,showCloseButton:this.props.showCloseButton})),Fle("div",{className:"toolbar toolbar-default toolbar-wrap"},void 0,"main"===this.state.mode&&(0,fs.jsxs)(fs.Fragment,{children:[Fle("input",{type:"search",className:"tabsearch",placeholder:(0,Oe.Z)("verb","Search"),value:this.state.sessionFilter,onChange:this._onSessionFilterChange}),Fle("div",{className:"toolbar-group"},void 0,Fle(Fa,{tooltip:(0,Oe.Z)("command","Save Tabs as Session"),tabIndex:this.props.prefValues[$.kKeyboardTabToAll],onClick:this._onAdd,image:Ts.md4.small}),Fle(Fa,{tooltip:(0,Oe.Z)("command","Delete Session"),tabIndex:this.props.prefValues[$.kKeyboardTabToAll],onClick:this._onDelete,image:Ts.M2k.small})),Fle(Fa,{tooltip:(0,Oe.Z)("command","Edit Session"),tabIndex:this.props.prefValues[$.kKeyboardTabToAll],onClick:this._onEditFromButton,image:Ts.NNg.small})]}),"edit"===this.state.mode&&(0,fs.jsx)(fs.Fragment,{children:Fle("input",{type:"search",className:"tabsearch",placeholder:(0,Oe.Z)("verb","Search"),value:this.state.contentFilter,onChange:this._onContentFilterChange})})))};renderMain=()=>(0,fs.jsxs)(fs.Fragment,{children:[this.state.hasSessions&&Fle(gv,{fields:Vle,onSortChange:this._onSortChange,keyAccess:this.props.keyAccess,sortField:this.state.sorting.sortField,sortOrder:this.state.sorting.sortOrder}),!this.state.hasSessions&&Fle(Lle,{onAdd:this._onAdd}),Fle("section",{className:"outerScrollbar"},void 0,(0,fs.jsx)(hae,{ref:this.refTree,filter:this.state.sessionFilter,showFolders:!0,sorting:this.state.sorting,onOpen:this._onOpen,onEdit:this._onEdit})),Fle("footer",{},void 0,Fle("label",{title:this.getSaveDaysText()},void 0,Fle("input",{type:"checkbox",checked:"on"===this.props.prefValues[$.kSessionsSaveOnExit],onChange:this.onAutosaveChanged}),Fle("span",{},void 0,(0,Oe.Z)("verb","Automatic Session Backup"))))]});renderEdit=()=>Fle("section",{className:"outerScrollbar"},void 0,Fle(Ple,{content:this.state.content,filter:this.state.contentFilter}));render(){return this.props.open?(0,fs.jsxs)("div",{ref:this.nodeRef,className:"panel",id:"session-panel",children:[this.renderHeader(),"main"===this.state.mode&&this.renderMain(),"edit"===this.state.mode&&this.renderEdit()]}):null}}const zle=sa(Hle,Ule);var Gle;function $le(e,t,n,s){Gle||(Gle="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Gle,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const{minimalCreateEvent:Kle}=Rd.Z,jle=[$.kCalendarDisplayDensity,$.kCalendarOnboardingShown],Yle=jL.Nw;let Xle=!1;function Qle(e){return $le("div",{className:"panel-empty-state"},void 0,$le("span",{dangerouslySetInnerHTML:{__html:Ts.C1I}}),$le("h1",{},void 0,(0,Oe.Z)("Add your first calendar account")),$le("p",{className:"faded-text"},void 0,(0,Oe.Z)("You can add a local or online calendar to Vivaldi Calendar.")),$le("input",{type:"button",onClick:()=>Ae.Z.showCalendarAccountDialog(e.windowId),value:(0,Oe.Z)("Add Calendar Account")}))}function qle(e){return $le("div",{className:"panel-empty-state",onClick:e.onCreateTask},void 0,$le("span",{dangerouslySetInnerHTML:{__html:Ts.C1I}}),$le("h1",{},void 0,(0,Oe.Z)("Your task list is empty")),$le("p",{},void 0,(0,Oe.Z)("Click the “Add Task” button to add a new task.")))}function Jle(e){return $le("div",{className:"panel-empty-state",onClick:e.onCreateTask},void 0,$le("span",{dangerouslySetInnerHTML:{__html:Ts.C1I}}),$le("h1",{},void 0,(0,Oe.Z)("No tasks found.")))}function ede(e){const t=hs.useContext(xi.Z),{stateHandler:n,calendarFilter:s,eventDraft:i,tasks:o,hasTasks:a,trashedEvents:r}=Z5(Yle),[l,d]=hs.useState(!1),c=(0,na.Z)(jle),h=hs.useMemo((()=>({pageId:Yle,displayDensity:c[$.kCalendarDisplayDensity],isPanel:!0,handler:n})),[c,n]);if(!e.open)return Xle=!1,null;function p(){d(!0),n.editEvent(null,Kle({task:!0}))}!1===Xle&&e.open&&(m.Z.pollAllCalDAVAccounts(!0),Xle=!0),l&&!i&&d(!1);let u=null;return 0===Bd.Z.getCalendars().length||!c[$.kCalendarOnboardingShown]&&!Bd.Z.getAccounts().some((e=>"local"!==e.account_type))?u=$le(Qle,{windowId:t.vivaldiWindowId}):o.length||s.filterText||l?o.length||!s.filterText||l||(u=$le(Jle,{onCreateTask:p})):u=$le(qle,{onCreateTask:p}),$le("div",{className:"panel",id:"tasks_panel",onClick:function(e){e.stopPropagation(),i&&n.endEventEdit()}},void 0,$le("header",{},void 0,$le(Dm,{title:e.title,showCloseButton:e.showCloseButton}),$le("div",{className:"toolbar toolbar-default"},void 0,$le("input",{type:"search",placeholder:(0,Oe.Z)("verb","Search"),title:(0,Oe.Z)("Type to filter tasks"),value:s.filterText,onChange:function(e){Gx.Z.search(Yle,e.target.value)}}),$le("button",{className:"FormButton FormButton--WithIcon",onClick:p,dangerouslySetInnerHTML:{__html:`${Ts.md4.small} ${(0,Oe.Z)("Add Task")}`}}))),u,(!!o.length||l)&&$le(nx.Provider,{value:h},void 0,$le(dR,{filter:s,events:o,trashedEvents:r,editingEvent:i,displayMode:"agenda"})),a&&$le("footer",{},void 0,$le("label",{},void 0,$le("input",{type:"checkbox",checked:s.showCompletedTasks,onChange:function(){Gx.Z.showCompletedTasks(Yle)}}),$le("span",{},void 0,(0,Oe.Z)("Show Completed Tasks")))))}const tde=hs.memo(ede);var nde;function sde(e,t,n,s){nde||(nde="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:nde,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class ide extends hs.PureComponent{refTreeList=hs.createRef();static contextType=xi.Z;winId=this.context.vivaldiWindowId;_languageFromCode=e=>{const t=this.props.languages.findIndex((t=>t.id===e));return-1===t?e:this.props.languages[t].historyName};_onNodesActivated=(e,t)=>{this.props.onActivated(t[0].id)};_onNodeDoubleClick=(e,t)=>{this.props.onActivated(t.id)};_onCopyAll=()=>{const{document:e}=this.context,t=e=>{const t=(this.refTreeList.current?.getAllSelectedItems()||[]).map((e=>e.id));this.props.onItemsCopy(e,t,!0)};e.addEventListener("copy",t),e.execCommand("copy"),e.removeEventListener("copy",t)};_onCopy=(e,t)=>{const n=t.map((e=>e.id));this.props.onItemsCopy(e,n,!1)};_getMenuCapability=async(e,t,n)=>{const s=this.winId;return"CONTEXT_COPY_ALL"===e.action?{handler:this._onCopyAll,isVisible:()=>Boolean(n),...t(s,e,{})}:{...t(s,e,{})}};_getMenuVisibility=(e,t)=>{if(!t)return!1;switch(e.action){case"CONTEXT_COPY":case"CONTEXT_DELETE":return!0;default:return!1}};clipByWord=e=>{if(e.length<=560)return e;const t=e.substring(0,560),n=t.lastIndexOf(" ");return t.substring(0,n)+"..."};getRowHeight=({index:e})=>this.props.nodes[e].translatedItem?.text?.length>140?98:68;rowComponent=e=>{const t=e.node,n=`${this._languageFromCode(t.srcItem.code)} → ${this._languageFromCode(t.translatedItem.code)}`;return sde("div",{className:["TranslatePanel-Row",t.translatedItem.text?.length<=140?"TranslatePanel-Row-Narrow":""].join(" "),title:(0,Oe.Z)("Go to full translation")},void 0,sde("label",{className:"TranslatePanel-Row-Heading"},t.id,sde("span",{},void 0,n)),sde("label",{className:"TranslatePanel-Row-Source"},void 0,sde("span",{},void 0,this.clipByWord(t.srcItem.text))),sde("label",{className:"TranslatePanel-Row-Result"},void 0,sde("span",{},void 0,this.clipByWord(t.translatedItem.text))))};menu={name:"translatehistory",getCapability:this._getMenuCapability,getVisibility:this._getMenuVisibility};render(){return sde("section",{className:"outerScrollbar"},void 0,(0,fs.jsx)(yo,{ref:this.refTreeList,settings:"TRANSLATE_HISTORY_TREE",rowComponent:this.rowComponent,nodes:this.props.nodes,menu:this.menu,isFolder:xE.Z,hasChildren:xE.Z,delete:this.props.onItemsDelete,onSelect:Aa.Z,onCopy:this._onCopy,enableDragAndDrop:!1,onItemDoubleClick:this._onNodeDoubleClick,onItemsActivated:this._onNodesActivated,rowHeight:this.getRowHeight}))}}const ode=ide;var ade;function rde(e,t,n,s){ade||(ade="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:ade,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class lde extends hs.PureComponent{render(){return this.props.showPlaceholder?rde("textarea",{className:"TranslatePanel-TranslatedText",type:"text",placeholder:(0,Oe.Z)("Please wait"),readOnly:!0}):rde("textarea",{className:"TranslatePanel-TranslatedText",type:"text",value:this.props.text,readOnly:!0})}}const dde=lde;var cde,hde=n(34155);function pde(e,t,n,s){cde||(cde="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:cde,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function ude(){return NI.ZP.getTranslationLocales().map((e=>({id:NI.ZP.getTranslationCode(e.key),name:PI(e),historyName:e.value})))}var gde=pde(Ss,{url:Ts.eIC,loadType:"faviconFromCache"});class mde extends hs.PureComponent{static contextType=xi.Z;_errorId=null;_hasLoadedHistory=!1;_idleId=null;_pending=void 0;constructor(e){super(e),this.state={autoTranslate:H.Z.get($.kPanelsTranslateAutomatic),busy:!1,error:"none",history:[],languages:ude(),pageId:0,showPlaceholder:!1,srcLanguage:"auto",srcStrings:[""],translatedText:"",targetLanguage:NI.ZP.getTargetTranslationCode(),viewMode:"main",translatePageIndex:0,langDetectedForPages:""}}componentDidMount(){const{selectWindow:e}=this.context;this._isMounted=!0,ie.ZP.addListener(this._onPageStoreChanged,e),H.Z.addListener([$.kPanelsTranslateAutomatic,$.kVivaldiTranslateLanguageList,$.kTranslateTargetLanguage],this._onPrefChanged),C.Z.tabsPrivate.onWebviewClickCheck.addListener(this._onWebviewClicked),C.Z.utilities.onBroadcastMessage.addListener(this._onBroadcastMessage),this._loadHistory(),this.props.open&&0===this.state.pageId&&this._onPageStoreChanged()}componentWillUnmount(){this._isMounted=!1,this._idleId&&clearTimeout(this._idleId),ie.ZP.removeListener(this._onPageStoreChanged),H.Z.removeListener([$.kPanelsTranslateAutomatic,$.kVivaldiTranslateLanguageList,$.kTranslateTargetLanguage],this._onPrefChanged),C.Z.utilities.onBroadcastMessage.removeListener(this._onBroadcastMessage),C.Z.tabsPrivate.onWebviewClickCheck.removeListener(this._onWebviewClicked),this._hasLoadedHistory&&(C.Z.translateHistory.onAdded.removeListener(this._onAdded),C.Z.translateHistory.onMoved.removeListener(this._onMoved),C.Z.translateHistory.onRemoved.removeListener(this._onRemoved)),this._setError("none")}componentDidUpdate(e,t){!e.open&&this.props.open?(this._loadHistory(),0===this.state.pageId&&this._onPageStoreChanged()):e.open&&!this.props.open&&this._setError("none")}_loadHistory=()=>{this.props.open&&!this._hasLoadedHistory&&C.Z.translateHistory.get().then((e=>{this._isMounted&&(this._hasLoadedHistory=!0,C.Z.translateHistory.onAdded.addListener(this._onAdded),C.Z.translateHistory.onMoved.addListener(this._onMoved),C.Z.translateHistory.onRemoved.addListener(this._onRemoved),this.setState({history:e}))}))};_getItemById=e=>this.state.history.find((t=>t.id===e));_detectLanguage=async(e,t,n)=>{const s=await NI.ZP.detectTextLanguage(e,n);return s&&t!==s?s:t};_getLanguageByPageId=e=>BI.ZP.getPageState(e).pageLanguage||"";_onPageStoreChanged=()=>{const e=ie.ZP.unsafeGetActivePage(this.context.vivaldiWindowId).id;this.state.pageId!==e&&this.setState({pageId:e})};_onPrefChanged=(e,t,n)=>{switch(n){case $.kPanelsTranslateAutomatic:this.setState({autoTranslate:Boolean(t)});break;case $.kVivaldiTranslateLanguageList:this.setState({languages:ude()});break;case $.kTranslateTargetLanguage:this.setState({targetLanguage:String(t)})}};_onBroadcastMessage=e=>{if(e.translate){const{winId:t,lang:n,text:s}=e.translate;t===this.context.vivaldiWindowId&&this.setState({srcStrings:[s],translatePageIndex:0},(()=>{this._onTranslate(n)}))}};_onAdded=(e,t)=>{this.setState((n=>{const s=[...n.history];return e.forEach(((e,n)=>{s.splice(t+n,0,e)})),{history:s}}))};_onMoved=(e,t)=>{const n=this.state.history.findIndex((t=>t.id===e));-1!==n&&n!==t&&this.setState((e=>{const s=[...e.history],i=s.splice(n,1);return s.splice(t>n?t-1:t,0,i[0]),{history:s}}))};_onRemoved=e=>{0===e.length?this.setState({history:[]}):this.setState((t=>{const n=[...t.history];return e.forEach((e=>{const t=n.findIndex((t=>t.id===e));-1!==t&&n.splice(t,1)})),{history:n}}))};_onSourceLanguageSelected=e=>{const{value:t}=e.currentTarget;this.setState({srcLanguage:t})};_onTargetLanguageSelected=e=>{const{value:t}=e.currentTarget;NI.ZP.setTargetTranslationCode(t),this.setState({targetLanguage:t})};_onSrcEditChanged=e=>{this._setError("none");let t=[e.target.value];if(t[0].length>NI.ky){if(-1===t[0].search(/[ ,\n.]/))return void this._setError("system");this._setError("NbCharExceeded"),t=this.splitSrcTextInPages(t[0])}this.setState({srcStrings:t,translatePageIndex:0,langDetectedForPages:"",translatedText:"",showPlaceholder:!1})};_onKeyDown=e=>{const{ctrlKey:t,altKey:n,shiftKey:s,metaKey:i}=e,o={ctrlKey:t,altKey:n,shiftKey:s,metaKey:i};"Enter"===e.key&&(0,co.VV)(o)&&(e.stopPropagation(),e.preventDefault(),this._onTranslate())};_onKeyDownMonitor=e=>{this._setError("none")};_onPaste=e=>{hde.nextTick((()=>{(H.Z.get($.kPanelsTranslatePaste)||this.state.srcStrings.length>1)&&this._onTranslate()}))};_onWebviewClicked=(e,t,n,s,i)=>{const{document:o}=this.context;if(this.props.open&&this.state.autoTranslate&&e===this.context.vivaldiWindowId&&!1===t&&0===n){"WEBVIEW"===o.elementFromPoint(Math.round(s),Math.round(i))?.tagName&&this._getSelectionAndTranslate()}};_getSelectionAndTranslate=()=>{C.Z.utilities.getSelectedText(this.state.pageId,(e=>{if(!e)return;const t=BI.ZP.getPageState(this.state.pageId).pageLanguage||"";e===this.getCurrentSrcText()&&(e=""),this.setState({srcStrings:[e],translatePageIndex:0},(()=>{this._onTranslate(t)}))}))};_toggleAutoTranslate=()=>{this.setState((e=>({autoTranslate:!e.autoTranslate})),(()=>{Ne.Z.set($.kPanelsTranslateAutomatic,this.state.autoTranslate),this.state.autoTranslate&&(this.getCurrentSrcText()||this._getSelectionAndTranslate())}))};_onTranslateFromButton=()=>{this._onTranslate()};_onTranslate=e=>{Ne.Z.set($.kTranslateTargetLanguage,this.state.targetLanguage);const t=this.getCurrentSrcText().trim();if(!NI.ZP.canTranslateText(t))return void this.setState({translatedText:"",showPlaceholder:!1});if(this.state.busy)return void(this._pending={lang:e,text:t});this._setError("none"),this.setState({translatedText:"",showPlaceholder:!0,busy:!0});const n="auto"===this.state.srcLanguage&&void 0!==e?e:this.state.srcLanguage;this._detectLanguage(this.state.pageId,n,t).then((e=>{"auto"===e&&(e="");const n=e?NI.ZP.getTranslationCode(e.toString()):"",s=NI.ZP.getTranslationCode(this.state.targetLanguage);C.Z.utilities.translateText(n,s,[t],(e=>{if(this._isMounted){if("no_error"!==e.error){this.setState({showPlaceholder:!1});let t="system";"unknown_language"===e.error?t="unknownLangServer":n&&(t="noDetect"),this._setError(t)}else{const t={id:"",srcItem:{code:e.detectedSourceLanguage,text:e.sourceText[0]},translatedItem:{code:s,text:e.translatedText[0]}};this._addToHistory(t),this.state.srcStrings.length>1&&this.setState({langDetectedForPages:e.detectedSourceLanguage})}this._idleId&&clearTimeout(this._idleId),this._idleId=setTimeout(this._idleEnds,1e3)}}))}))};_idleEnds=()=>{if(this._idleId&&clearTimeout(this._idleId),this._pending){const e=this._pending.lang,t=this._pending.text;this._pending=void 0,this.setState({busy:!1,srcStrings:[t],translatePageIndex:0},(()=>{this._onTranslate(e)}))}else this.setState({busy:!1})};_errorEnds=()=>{this._errorId&&clearTimeout(this._errorId),this._setError("none")};_addToHistory=e=>{G.ZP.isIncognitoOrGuest(this.context.vivaldiWindowId)?(this.setState({translatedText:e.translatedItem.text,showPlaceholder:!1}),this._setError("none")):C.Z.translateHistory.add(e,0).then((t=>{const n=s.Z.runtime.lastError;n&&console.error(n.message),this.setState({translatedText:e.translatedItem.text,showPlaceholder:!1}),this._setError("none")}))};_onItemActivated=e=>{const t=this._getItemById(e);t&&this.setState({viewMode:"main"},(()=>{this.setState({srcLanguage:t.srcItem.code,targetLanguage:t.translatedItem.code,srcStrings:[t.srcItem.text],translatePageIndex:0,translatedText:t.translatedItem.text,showPlaceholder:!1})}))};_onItemsDelete=e=>C.Z.translateHistory.remove(e).then((()=>Promise.resolve()));_onClearHistory=()=>{C.Z.translateHistory.reset(0)};_onClearText=()=>{this._pending=void 0,this.setState({srcStrings:[""],translatePageIndex:0,translatedText:""})};_onSwapLanguage=()=>{"auto"!==this.state.srcLanguage&&this.setState((e=>{const t=e.translatedText.length>0;return{srcLanguage:e.targetLanguage,targetLanguage:e.srcLanguage,srcStrings:t?[e.translatedText]:e.srcStrings,translatePageIndex:t?0:e.translatePageIndex,translatedText:t?e.srcStrings[e.translatePageIndex]:e.translatedText}}))};_onItemsCopy=(e,t,n)=>{const s=t.map((e=>this._getItemById(e))).filter(Boolean),i=[];s.forEach((e=>{n&&i.push(e.srcItem.text),i.push(e.translatedItem.text)})),e.clipboardData&&(e.clipboardData.setData("text/plain",i.join("\r\n")),e.stopPropagation(),e.preventDefault())};_setError=e=>{const{document:t}=this.context;"none"===e?"none"!==this.state.error&&(t.removeEventListener("keydown",this._onKeyDownMonitor),this._errorId&&clearTimeout(this._errorId)):"none"===this.state.error&&(t.addEventListener("keydown",this._onKeyDownMonitor),this._errorId&&clearTimeout(this._errorId),this._errorId=setTimeout(this._errorEnds,3e3)),this._isMounted&&this.setState({error:e})};_errorMessage=e=>{switch(e){case"unknownLangServer":return(0,Oe.Z)("Translation failed. Server could not determine the language.");case"noDetect":return(0,Oe.Z)("Translation failed. Try selecting another language.");case"system":return(0,Oe.Z)("Translation failed.");case"NbCharExceeded":return(0,Oe.Z)("You cannot translate more than $1 characters. Use the arrows to translate more.",[NI.ky]);default:return""}};_onCopyText=()=>{const{document:e}=this.context,t=e=>{e.clipboardData&&(e.clipboardData.setData("text/plain",this.state.translatedText),e.stopPropagation(),e.preventDefault())};e.addEventListener("copy",t),e.execCommand("copy"),e.removeEventListener("copy",t)};_renderToolbar=()=>{if("main"===this.state.viewMode){const e=[{id:"auto",name:(0,Oe.Z)("Automatic Detection")}].concat(this.state.languages).map((e=>pde("option",{value:e.id},e.id,e.name))),t=this.state.languages.map((e=>pde("option",{value:e.id},e.id,e.name)));return pde("div",{className:"TranslatePanel-FromTo toolbar toolbar-default"},void 0,pde("select",{autoFocus:!0,value:this.state.srcLanguage,onChange:this._onSourceLanguageSelected},void 0,e),pde("input",{type:"button",style:{paddingLeft:6,paddingRight:6},value:"⇆",disabled:"auto"===this.state.srcLanguage,onClick:this._onSwapLanguage}),pde("select",{value:this.state.targetLanguage,onChange:this._onTargetLanguageSelected},void 0,t))}return pde("div",{className:"toolbar toolbar-default toolbar-wrap"},void 0,pde("input",{type:"button",onClick:()=>this.setState({viewMode:"main"}),value:(0,Oe.Z)("navigation","Back")}),pde("input",{type:"button",className:"danger",onClick:this._onClearHistory,value:(0,Oe.Z)("Clear Translate History")}))};splitText=e=>{let t=0;const n=e.split(/([ ,\n])/).reduce(((e,n)=>(n.length+e[t].length>NI.ky?(e.push(n),t+=1):e[t]=e[t]+n,e)),[""]);return!n[0].length&&n.shift(),n};splitSrcTextInPages=e=>{let t=0;const n=e.split(/(\.)/).reduce(((e,n)=>"."===n?(e[t].concat("."),e):((n=n.trim()).length>NI.ky?e.push(...this.splitText(n)):n.length+e[t].length>NI.ky?(e.push(n),t+=1):e[t]=e[t]+n,e)),[""]);return!n[0].length&&n.shift(),n};changeTranslationPage=e=>{this.setState({translatePageIndex:e}),this._onTranslate(this.state.langDetectedForPages??"auto")};getCurrentSrcText=()=>{const{srcStrings:e,translatePageIndex:t}=this.state;return t>=e.length?(this.setState({translatePageIndex:0}),e[0]):e[t]};_renderTranslatePages=()=>{const{translatePageIndex:e,srcStrings:t,busy:n}=this.state,s=e<t.length-1;return pde("div",{className:"TranslatePanel-Pages"},void 0,pde("div",{className:"Translate-Characters"},void 0,pde("p",{},void 0,t[e]?.length??0),gde),pde("p",{className:"Translate-Page-Index"},void 0,e+1,"/",t.length),pde(Fa,{className:"Previous-Translate",image:Ts.eFz.small,tooltip:(0,Oe.Z)("Previous"),disabled:e<1||n,onClick:()=>this.changeTranslationPage(e-1)}),pde(Fa,{image:Ts.S$A.small,tooltip:(0,Oe.Z)("Next"),disabled:!s||n,onClick:()=>this.changeTranslationPage(e+1)}))};_renderMain=()=>{const e=this.state.srcStrings[this.state.translatePageIndex],t=!this.state.busy&&NI.ZP.canTranslateText(e);return pde("div",{className:"TranslatePanel"},void 0,pde("div",{className:"TranslatePanel-Content"},void 0,pde("textarea",{className:"TranslatePanel-SrcText",type:"text",value:e,placeholder:(0,Oe.Z)("Enter text to translate"),onChange:this._onSrcEditChanged,onKeyDown:this._onKeyDown,onPaste:this._onPaste,autoFocus:!e}),"none"!==this.state.error&&pde("div",{onPointerDown:()=>this._setError("none")},void 0,pde(tc,{type:"system"===this.state.error?"error":"warning"},void 0,this._errorMessage(this.state.error))),this.state.srcStrings.length>1&&this._renderTranslatePages(),pde("div",{className:"TranslatePanel-BottomToolbar"},void 0,pde("input",{type:"submit",disabled:!t,autoFocus:t,value:(0,Oe.Z)("verb","Translate")}),pde("input",{type:"button",title:(0,Oe.Z)("Copy translation"),value:(0,Oe.Z)("verb","Copy"),onClick:this._onCopyText,disabled:!this.state.translatedText}),pde("input",{type:"button",className:"clear",onClick:this._onClearText,value:(0,Oe.Z)("Clear")})),pde(dde,{text:this.state.translatedText,showPlaceholder:this.state.showPlaceholder})),pde("div",{className:"TranslatePanel-CheckboxArea"},void 0,pde("label",{},void 0,pde("input",{type:"checkbox",checked:this.state.autoTranslate,onChange:this._toggleAutoTranslate}),pde("span",{},void 0,(0,Oe.Z)("Auto-translate selected text")))),pde("div",{className:"TranslatePanel-ShowTranslateHistory"},void 0,pde("input",{type:"button",onClick:()=>this.setState({viewMode:"history"}),value:(0,Oe.Z)("Show Translate History")}),pde("span",{className:"credits"},void 0,(0,Oe.Z)("Powered by Lingvanex, hosted by Vivaldi."))))};_renderHistory=()=>pde("div",{className:"TranslatePanel TranslatePanel-History"},void 0,pde(ode,{nodes:this.state.history,languages:this.state.languages,onActivated:this._onItemActivated,onItemsCopy:this._onItemsCopy,onItemsDelete:this._onItemsDelete}));render(){return this.props.open?pde("div",{className:"panel",id:"translate-panel"},void 0,pde("header",{},void 0,pde(Dm,{title:this.props.title,showCloseButton:this.props.showCloseButton})),pde("form",{className:"main"===this.state.viewMode?"Translate-Main-Form":"Translate-History-Form",onSubmit:this._onTranslateFromButton},void 0,this._renderToolbar(),"main"===this.state.viewMode&&this._renderMain()),"history"===this.state.viewMode&&this._renderHistory()):null}}const vde=sa(mde,[]);var fde;function yde(e,t,n,s){fde||(fde="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:fde,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Cde={contentload:"handleContentLoad",dialog:"handleDialog",loadabort:"handleAbort",loadstop:"handleLoadStop",newwindow:"handleNewWindow",permissionrequest:"handleOnPermissionRequest",targeturlchanged:"handleTargetURLChanged"};var wde=yde(jo,{type:"close",size:16});class bde extends hs.PureComponent{static contextType=xi.Z;nodeRef=hs.createRef();refWebpanelwebview=hs.createRef();winId=this.context.vivaldiWindowId;messageId="webPanelTitleChanged"+this.props.webPanel.id;state={title:(0,Oe.Z)("Loading..."),tooltip:void 0,canGoBack:!1,canGoForward:!1,canReload:!1,muted:!1};_lookupFavicon=!0;componentDidMount(){const e=this.refWebpanelwebview.current;e&&(this.props.webPanel.mobileMode&&e.setUserAgentOverride(this.getMobileUAString()),1!==this.props.webPanel.zoom&&e.setZoom(this.props.webPanel.zoom),this.attachWebViewEventHandlers(e),Fl.Z.isExtPanel(this.props.webPanel.id)||this.props.webPanel.activeUrl?e.src=this.props.webPanel.activeUrl:e.src=this.props.webPanel.url),ud.ZP.addListener(this.onPanelStoreChange),oe.Z.addListener(this._alarmsChanged),s.Z.runtime.onMessage.addListener(this._onMessageReceived)}componentWillUnmount(){const e=this.refWebpanelwebview.current;e&&this.removeWebViewEventHandlers(e),oe.Z.removeListener(this._alarmsChanged),s.Z.runtime.onMessage.removeListener(this._onMessageReceived)}attachWebViewEventHandlers=e=>{Object.keys(Cde).forEach((t=>{e.addEventListener(t,this[Cde[t]])}))};removeWebViewEventHandlers=e=>{Object.keys(Cde).forEach((t=>{e.removeEventListener(t,this[Cde[t]])}))};_alarmsChanged=e=>{const t=e?.find((e=>e&&"RELOAD"===e.type&&this.props.webPanel.id.endsWith(e.id)));t&&this.reload()};componentDidUpdate(e){const{document:t}=this.context,n=this.refWebpanelwebview.current;this.props.webPanel.mobileMode!==n?.isUserAgentOverridden()&&(this.props.webPanel.mobileMode?n?.setUserAgentOverride(this.getMobileUAString()):n?.setUserAgentOverride(navigator.userAgent),this.home()),n?.setZoom(this.props.webPanel.zoom||1);const s=e.webPanel,i=this.props.webPanel,o=Fl.Z.isExtPanel(i.id);!this.props.isVisible||!this.props.focusContent&&!o||!t.activeElement||t.activeElement===this.refWebpanelwebview.current||e.isVisible&&i.activeUrl===s.activeUrl||(o&&n&&n.src!==i.activeUrl&&(n.src=i.activeUrl),t.activeElement.blur(),this.refWebpanelwebview.current?.focus())}onPanelStoreChange=()=>{const e=ud.ZP.getWindowData(this.winId),t=ud.ZP.getChangeReason();if(!e)return;const{document:n}=this.context;if("setFocus"===t)this.props.isVisible&&n.activeElement&&!sl(n,this.nodeRef.current)&&(n.activeElement.blur(),this.refWebpanelwebview.current?.focus());else{const e=ud.ZP.getIsMuted(this.winId,this.props.webPanel.id);this.state.muted!==e&&this.setState({muted:e},(()=>{const t=this.refWebpanelwebview.current;t&&t.setAudioMuted(e)}))}};_onMessageReceived=(e,t,n)=>{if(e&&t.id===s.Z.runtime.id&&e.action===this.messageId&&"string"==typeof e.title){const t=e.title;Pn.Z.setWebPanelValue(this.props.webPanel.id,"title",t),this.setTitle(t)}};getMobileUAString=()=>{let e=navigator.userAgent;const t=e.indexOf("("),n=e.indexOf(")",t);return t>=0&&n>t&&(e=e.substr(0,t+1)+"Linux; Android 8.0.0; SM-G965F Build/R16NW"+e.substr(n)),e=e.replace("Safari","Mobile Safari"),e};handleNewWindow=async e=>{switch(e.windowOpenDisposition){case"current_tab":case"new_foreground_tab":e.preventDefault(),e.window.accept(this.winId+";1");break;case"new_background_tab":e.preventDefault(),e.window.accept(this.winId+";0");break;case"new_window":case"off_the_record":e.preventDefault(),cs.Z.openBrowserWindow(this.winId,e.targetUrl,{incognito:"off_the_record"===e.windowOpenDisposition});break;case"new_popup":e.preventDefault()}};handleDialog=e=>{"confirm"===e.messageType||"prompt"===e.messageType?e.dialog.cancel():"alert"===e.messageType&&e.dialog.ok("")};handleTargetURLChanged=({newUrl:e})=>{const t=(0,uy.ZP)(e);c.Z.setStatus(this.winId,t)};getFaviconHost=()=>{const e=(0,ms.Z)(this.refWebpanelwebview.current?.src??"");return e?.protocol&&e?.host?e.protocol+"//"+e.host+"/":""};handleLoadStop=e=>{const t=this.refWebpanelwebview.current;if(Fl.Z.isExtPanel(this.props.webPanel.id))this.setState({canGoBack:!1,canGoForward:!1,canReload:!1});else{this.setState({canGoBack:t?.canGoBack(),canGoForward:t?.canGoForward(),canReload:!0});const e=this.refWebpanelwebview.current?.src??"";Pn.Z.setWebPanelValue(this.props.webPanel.id,"activeUrl",e)}if(this._lookupFavicon){const e=this.props.webPanel;Fl.Z.isExtPanel(e.id)?Pn.Z.setWebPanelValue(e.id,"faviconUrl",e.url):setTimeout(this.onSetFaviconUrl.bind(this),1e3),this._lookupFavicon=!1}t?.setZoomMode("per-view")};handleContentLoad=e=>{this.refWebpanelwebview.current?.executeScript({code:"document.title"},(e=>{if(Array.isArray(e)&&e.length>0&&"string"==typeof e[0]){const[t]=e;this.setState({title:t,tooltip:void 0}),Pn.Z.setWebPanelValue(this.props.webPanel.id,"title",t)}}));const t=`(function() {\n      const elm = document.getElementsByTagName('title')[0];\n      if (elm) {\n        elm.addEventListener('DOMSubtreeModified', function() {\n        chrome.runtime.sendMessage({\n          action: '${this.messageId}',\n          title: document.title\n        });\n      }, false);\n    }\n    })()`;this.refWebpanelwebview.current?.executeScript({code:t},(()=>{s.Z.runtime.lastError&&console.warn("listenForTitleChange:",s.Z.runtime.lastError)})),this.refWebpanelwebview.current?.executeScript({file:"inject-all-bundle.js"})};handleAbort=e=>{const t=(0,Oe.Z)("Aborted"),n=(0,Oe.Z)("Loading aborted with reason $1",[e.reason]);this.setState({title:t,tooltip:n})};onSetFaviconUrl=()=>{const e=this.refWebpanelwebview.current?.src??"";Pn.Z.setWebPanelValue(this.props.webPanel.id,"faviconUrl",e)};reload=()=>{this.setState({title:(0,Oe.Z)("Loading..."),tooltip:void 0,canReload:!1}),this.refWebpanelwebview.current?.reload()};home=()=>{if(Fl.Z.isExtPanel(this.props.webPanel.id))return;this.setState({title:(0,Oe.Z)("Loading..."),tooltip:void 0,canReload:!1});const e=this.refWebpanelwebview.current;e&&(e.src=this.props.webPanel.url)};back=()=>{this.refWebpanelwebview.current?.back()};forward=()=>{this.refWebpanelwebview.current?.forward()};setTitle=e=>{this.setState({title:e})};onContextMenu=e=>{e.persist(),e.preventDefault(),e.stopPropagation(),bw.getPromise(this.winId,this.props.webPanel.id,{title:this.props.webPanel.title,url:this.props.webPanel.url,activeUrl:this.props.webPanel.activeUrl,faviconUrl:this.props.webPanel.faviconUrl,muted:ud.ZP.getIsMuted(this.winId,this.props.webPanel.id),mobileMode:this.props.webPanel.mobileMode}).then((t=>{(0,Qi.Z)(this.context,t)(e)}))};handleOnPermissionRequest=e=>{if(e.preventDefault(),"download"===e.permission)H.Z.get($.kDownloadsStartAutomatically)?(e.request.allow(),H.Z.get($.kDownloadsOpenPanelOnNew)&&((0,bd.PK)("DownloadButton",this.winId)?v.Z.executeActions("event",this.context,"COMMAND_SHOW_DOWNLOADS_POPOUT"):ud.ZP.canAutoOpen(this.winId,"PanelDownloads")&&Pn.Z.toggleContent(this.winId,"PanelDownloads"))):this.showDialog(e)};showDialog=e=>{const t=this.refWebpanelwebview.current;e.webview=t,e.dialogtype=e.permission,Ae.Z.showDialog(this.winId,e,null)};setZoomLevel=e=>{if(!this.refWebpanelwebview.current)return;const{zoom:t=1,id:n}=this.props.webPanel,s=e?t+ib.Zh:t-ib.Zh,i=Math.min(Math.max(s,ib.XF),ib.qt),o=Number(i.toFixed(1));Fl.Z.setZoom(n,o)};resetZoom=()=>Fl.Z.setZoom(this.props.webPanel.id,1);decreaseZoom=()=>this.setZoomLevel(!1);increaseZoom=()=>this.setZoomLevel(!0);render(){const e=As()({panel:!0,webpanel:!0,visible:this.props.isVisible});return(0,fs.jsxs)("div",{ref:this.nodeRef,className:e,children:[this.props.isVisible&&this.props.panelUI.showToolbar&&yde("header",{className:"webpanel-header",onContextMenu:this.onContextMenu},void 0,yde("div",{className:"toolbar toolbar-default full-width"},void 0,yde("h1",{className:"webpanel-title",title:this.state.tooltip||this.state.title},void 0,yde("span",{},void 0,this.state.title)),yde("div",{className:"toolbar toolbar-group"},void 0,this.props.panelUI.zoomControls&&yde("div",{className:"toolbar-group pad-right"},void 0,yde("div",{className:"button-toolbar"},void 0,yde("button",{className:"ToolbarButton-Button",title:(0,Oe.Z)("Reset Zoom"),onClick:this.resetZoom,disabled:!this.refWebpanelwebview||1===this.props.webPanel.zoom,dangerouslySetInnerHTML:{__html:Ts.kze}})),yde("div",{className:"button-toolbar"},void 0,yde("button",{className:"ToolbarButton-Button",title:(0,Oe.Z)("Zoom Out"),onClick:this.decreaseZoom,disabled:!this.refWebpanelwebview,dangerouslySetInnerHTML:{__html:Ts.M2k.small}})),yde("div",{className:"button-toolbar"},void 0,yde("button",{className:"ToolbarButton-Button",title:(0,Oe.Z)("Zoom In"),onClick:this.increaseZoom,disabled:!this.refWebpanelwebview,dangerouslySetInnerHTML:{__html:Ts.md4.small}}))),this.props.panelUI.allControls&&(0,fs.jsxs)(fs.Fragment,{children:[yde("div",{className:"button-toolbar"},void 0,yde("button",{className:"button-toolbar back",title:(0,Oe.Z)("navigation","Back"),onClick:this.back,disabled:!this.state.canGoBack,dangerouslySetInnerHTML:{__html:Ts.mgF.small}})),yde("div",{className:"button-toolbar"},void 0,yde("button",{className:"button-toolbar forward",title:(0,Oe.Z)("navigation","Forward"),onClick:this.forward,disabled:!this.state.canGoForward,dangerouslySetInnerHTML:{__html:Ts.Zu.small}})),yde("div",{className:"button-toolbar"},void 0,yde("button",{className:"button-toolbar reload",title:(0,Oe.Z)("Reload"),onClick:this.reload,disabled:!this.state.canReload,dangerouslySetInnerHTML:{__html:Ts.GO5.small}}))]}),yde("div",{className:"button-toolbar"},void 0,yde("button",{className:"button-toolbar home",title:(0,Oe.Z)("Home"),onClick:this.home,disabled:!this.state.canReload,dangerouslySetInnerHTML:{__html:Ts.PaK.small}}))),this.props.showCloseButton&&yde("button",{className:"close transparent",onClick:()=>Pn.Z.closePanel(this.winId),tooltip:(0,Oe.Z)("Close Panel")},void 0,wde))),yde("section",{className:"webpanel-content"},void 0,(0,fs.jsx)("webview",{vivaldi_view_type:this.props.webPanel.id,ref:this.refWebpanelwebview,name:"vivaldi-webpanel"}))]})}}const Sde=bde;var Ide,kde=n(63365),Ade=n(60842),Tde=n(42578),Zde=n(34155);function Ede(e,t,n,s){Ide||(Ide="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Ide,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const _de=[$.kPanelsShowFolderBadge,$.kPanelsWindowDragToStack,$.kPanelsWindowSingleClickOpens,$.kPanelsWindowShowPinnedGroup,$.kTabsAutoMuting,$.kTabsDimHibernated,$.kTabsShowCloseButton,$.kTabsStackingMode,$.kTabsStackingNameMap,$.kTabsUnread,$.kThemeUseAnimation,$.kWorkspacesEnabled],Mde="root",Nde="sync",Pde="trash",Dde="vivaldi/x-window-item";var xde=Ede("g",{transform:"translate(2, 2)",fill:"none",stroke:"currentColor"},void 0,Ede("polygon",{points:"2.5 5.5 6.5 9.5 7.5 9.5 7.5 5.5 11.5 2.5 9.5 0.5 6.5 4.5 2.5 4.5"}),Ede("polygon",{points:"0 12 3 8 4 9"}));class Ode extends hs.PureComponent{refTreeList=hs.createRef();static contextType=xi.Z;isDroppingOnWindowOrWorkspace=!1;constructor(e,t){super(e),this.state={windowIds:this.getWindowIds(t.vivaldiWindowId),nodes:[]}}expandModel={};blockPageStoreChange=!1;lastActivePinnedId="";centerDownId="";componentDidMount(){q8.Z.addListener(this._onPageStoreChanged),ie.ZP.addListener(this._onPageStoreChanged),qn.addListener(this._onSyncedTabsStoreChanged),kde.Z.addListener(this._onTrashStoreChanged),G.ZP.addListener(this._onWindowStoreChanged),Kj.Z.addListener(this._onWorkspaceStoreChanged),this._onFilterChange(this.props.filter,Aa.Z)}componentWillUnmount(){q8.Z.removeListener(this._onPageStoreChanged),ie.ZP.removeListener(this._onPageStoreChanged),qn.removeListener(this._onSyncedTabsStoreChanged),kde.Z.removeListener(this._onTrashStoreChanged),G.ZP.removeListener(this._onWindowStoreChanged),Kj.Z.removeListener(this._onWorkspaceStoreChanged)}componentDidUpdate(e){if(this.props.filter!==e.filter){const t=this.props.filter.length,n=e.filter.length;0===n&&t>0&&this.refTreeList.current&&(this.expandModel=this.refTreeList.current.getExpandModel()),this._onFilterChange(this.props.filter,(e=>{t>0?Zde.nextTick((()=>{this.refTreeList.current?.expandAllExcept(e)})):n>0&&0===t&&Zde.nextTick((()=>{this.refTreeList.current?.expandWithModel(this.expandModel)}))}))}else(this.props.prefValues[$.kThemeUseAnimation]!==e.prefValues[$.kThemeUseAnimation]||this.props.prefValues[$.kTabsStackingMode]!==e.prefValues[$.kTabsStackingMode]||this.props.prefValues[$.kTabsUnread]!==e.prefValues[$.kTabsUnread]||this.props.prefValues[$.kTabsStackingNameMap]!==e.prefValues[$.kTabsStackingNameMap]||this.props.prefValues[$.kPanelsWindowShowPinnedGroup]!==e.prefValues[$.kPanelsWindowShowPinnedGroup]||this.props.prefValues[$.kWorkspacesEnabled]!==e.prefValues[$.kWorkspacesEnabled]||this.props.sorting!==e.sorting&&"manually"===this.props.sorting.sortField)&&Zde.nextTick((()=>{this.setState({nodes:this._getNodes()})}))}focusTree=()=>{this.refTreeList.current?.focusTree()};_onPageStoreChanged=()=>{this.blockPageStoreChange||this._onFilterChange(this.props.filter,Aa.Z);const e=ie.ZP.getActivePage(this.context.vivaldiWindowId);e&&e.pinned&&(this.lastActivePinnedId=e.id.toString())};_onSyncedTabsStoreChanged=()=>{this._onFilterChange(this.props.filter,Aa.Z)};_onTrashStoreChanged=()=>{this._onFilterChange(this.props.filter,Aa.Z)};_onWindowStoreChanged=()=>{this.setState({windowIds:this.getWindowIds(this.context.vivaldiWindowId)})};_getWorkspaces=e=>this.props.prefValues[$.kWorkspacesEnabled]?Kj.Z.getWorkspaces(e):[];_onWorkspaceStoreChanged=()=>{this.setState({nodes:this._getNodes()})};getWindowIds=e=>{const t=G.ZP.isIncognito(e);return G.ZP.getIds("normal").filter((e=>t===G.ZP.isIncognito(e)))};_getFavicon=e=>je.jk.getFaviconWithFallback(e.url||"",e.favIconUrl||"");_getNodes=()=>{const e="off"===this.props.prefValues[$.kTabsStackingMode],t=G.ZP.isIncognito(this.context.vivaldiWindowId)?"faviconSkipCache":"faviconFromCache",n=function(e){return e&&e.startsWith("www.")?e.substring(4):e},s=e=>{const s=(0,ms.Z)(e.url)?.hostname||"",i=!e.url||!e.favIconUrl&&!(0,je.pM)(e.url)&&!(0,je.QB)(e.url);return{page:e,hostname:s,url:e.url,domain:n(s),loadType:t,faviconUrl:this._getFavicon(e),useDefaultIcon:i,active:ie.ZP.isActivePage(e.windowId,e.id)}},i=(e,t,n,i)=>e.flatMap(((e,o)=>{if("tab"===e.type){return[{id:e.id.toString(),type:"tab",parentId:t,title:je.jk.getDisplayTitle(e.page),index:o,pageIndex:e.page.index,wid:n,workspaceId:i,pageItem:s(e.page)}]}return"group"===e.type?[{id:e.id,type:"stack",parentId:t,title:this.props.prefValues[$.kTabsStackingNameMap][e.id]||je.jk.getDisplayTitle(e.page),index:o,pageIndex:void 0,wid:n,workspaceId:i,children:e.pages.map(((t,o)=>({id:t.id.toString(),type:"tab",parentId:e.id,title:je.jk.getDisplayTitle(t),index:o,pageIndex:t.index,wid:n,workspaceId:i,pageItem:s(t)}))).toArray()}]:[]})).toArray(),o=this.state.windowIds.map(((t,n)=>{const s=ie.ZP.getWorkspaceTabsInWindow(t,void 0,e);if(0===s.size)return;const o=this.props.prefValues[$.kPanelsWindowShowPinnedGroup],a=o?s.filter((e=>e.page.pinned)):(0,te.aV)(),r=o?s.filter((e=>!e.page.pinned)):s,l=`window-${t}`,d=[];if(!a.isEmpty()){const e=`pinned-${t}`,n=i(a,e,t,void 0);d.push({id:e,type:"pinned",parentId:l,title:(0,Oe.Z)("title","Pinned Tabs"),index:0,pageIndex:void 0,wid:t,workspaceId:void 0,children:n})}const c=i(r,l,t,void 0),h=ie.ZP.getActivePage(t);return{id:l,type:"window",parentId:Mde,title:h?je.jk.getDisplayTitle(h):"",index:n,pageIndex:void 0,wid:t,workspaceId:void 0,children:[...d,...c]}})).filter(Boolean),a=this._getWorkspaces(this.context.vivaldiWindowId).map(((e,t)=>{const n=ie.ZP.getWorkspaceTabs(e.id),s=this.props.prefValues[$.kPanelsWindowShowPinnedGroup],a=s?n.filter((e=>e.page.pinned)):(0,te.aV)(),r=s?n.filter((e=>!e.page.pinned)):n,l=e.id,d=`workspace-${l}`,c=n.first()?.page?.windowId,h=[];if(c&&!a.isEmpty()){const e=`pinned-${l}`,t=i(a,e,c,l);h.push({id:e,type:"pinned",parentId:d,title:(0,Oe.Z)("title","Pinned Tabs"),index:0,pageIndex:void 0,wid:c,workspaceId:l,children:t})}const p=c?i(r,d,c,l):[];return{id:d,type:"workspace",parentId:Mde,title:e.name,index:t+o.length,pageIndex:void 0,wid:c,workspaceId:l,children:[...h,...p]}})),r=(e,t,s)=>{const i=(0,ms.Z)(t.url??"")?.hostname??"",{favIconUrl:o,favIconLoadType:a}=je.jk.getBookmarkFavicon(t.url);return{id:t.sessionId??"",parentId:e,type:"trash",index:s,title:je.jk.getDisplayTitle(t),wid:this.context.vivaldiWindowId,workspaceId:void 0,pageIndex:void 0,trashItem:{tab:{handle:t,url:t.url??"",hostname:i,domain:n(i),loadType:a,faviconUrl:o,useDefaultIcon:!1}}}};let l;qn.hasSupport()&&(l={id:Nde,type:"syncFolder",parentId:Mde,title:(0,Oe.Z)("title","Synced Tabs"),index:o.length+a.length,pageIndex:void 0,wid:this.context.vivaldiWindowId,workspaceId:void 0,children:qn.getDeviceTree().map(((e,n)=>{let s=[];return e.windows?.length?s=e.windows.map(((n,s)=>({id:n.id,type:"syncWindow",parentId:e.id,title:n.name,index:s,pageIndex:void 0,wid:this.context.vivaldiWindowId,workspaceId:void 0,children:(n.tabs??[]).map(((e,s)=>({id:e.id,type:"tab",parentId:n.id,title:e.name,index:s,pageIndex:void 0,wid:this.context.vivaldiWindowId,workspaceId:void 0,syncItem:{url:e.url,loadType:t,faviconUrl:this._getFavicon(e.tab),windowId:n.id}})))}))):e.tabs&&(s=e.tabs.map(((n,s)=>({id:n.id,type:"tab",parentId:e.id,title:n.name,index:s,pageIndex:void 0,wid:this.context.vivaldiWindowId,workspaceId:void 0,syncItem:{url:n.url,loadType:t,faviconUrl:this._getFavicon(n.tab),windowId:n.windowId}})))),{id:e.id,type:"syncDevice",parentId:Nde,title:e.name,index:n,pageIndex:void 0,wid:this.context.vivaldiWindowId,workspaceId:void 0,children:s}}))});const d={id:Pde,type:"trash",parentId:Mde,title:(0,Oe.Z)("title","Closed Tabs"),index:o.length+a.length+(l?1:0),pageIndex:void 0,wid:this.context.vivaldiWindowId,workspaceId:void 0,children:kde.Z.getTrash().map(((e,t)=>{if(e.tab)return r(Pde,e.tab,t);if(e.window&&e.window.tabs&&e.window.sessionId){const n=e.window,s=e.window.tabs,i=e.window.sessionId;return{id:i,parentId:Pde,type:"trash",index:t,title:(0,Oe.Z)("Window with $1 Tab","Window with $1 Tabs",[s.length]),wid:this.context.vivaldiWindowId,workspaceId:void 0,pageIndex:void 0,trashItem:{window:{handle:n}},children:s.map(((e,t)=>r(i,e,t)))}}})).filter(Boolean)};return l?this._getRootNode([...o,...a,l,d]).children||[]:this._getRootNode([...o,...a,d]).children||[]};_getRootNode=e=>({id:Mde,parentId:"",type:"root",title:"",index:0,pageIndex:void 0,wid:this.context.vivaldiWindowId,workspaceId:void 0,children:e});_getChildren=e=>e?.children??[];_hasSyncChildren=e=>{switch(e.type){case"syncFolder":if(e.children)for(let t=0;t<e.children.length;t++)if(this._hasSyncChildren(e.children[t]))return!0;break;case"syncWindow":return Boolean(e.children?.length);case"syncDevice":if(e.children)for(let t=0;t<e.children.length;t++){const n=e.children[t];if("tab"===n.type)return!0;if("syncWindow"===n.type&&Boolean(n.children?.length))return!0}}return!1};_getPageIndex=e=>e.pageIndex;_getFilteredTree=(e,t)=>{const n=function(e,t,n){let s=!1;return!1!==n.url&&(e.pageItem?s=e.pageItem.url.includes(t):e.syncItem&&(s=e.syncItem.url.includes(t))),s||!1===n.title||(s=e.title.toLowerCase().includes(t)),s},s=function(e,t,i,o,a){let r=!1;for(let l=0;l<e.length;l++){const d=e[l];let c=!1;if(d.children){const e={...d,children:[]};s(d.children,e.children,i,o,a)&&(t.push(e),r=!0,c=!0)}if(!c&&n(d,o,a)){const e={...d};t.push(e),d.children&&i.push(d),r=!0}}return r},i=[],o=[];return s(this._getNodes(),i,o,e.toLowerCase(),t),{nodes:i,collapsed:o}};_onFilterChange=(e,t)=>{if(e&&e.length>0){const n={url:!0,title:!0},s=this._getFilteredTree(e,n);s.nodes.forEach(((e,t)=>{e.index=t})),this.setState({nodes:s.nodes},t(s.collapsed))}else this.setState({nodes:this._getNodes()},t([]))};getSelectedItem=()=>this.refTreeList.current?.getSelectedItem();getSelectedItems=()=>this.refTreeList.current?.getAllSelectedItems()||[];unSelectAll=()=>{this.refTreeList.current?.unSelectAll()};_isTrashFolder=e=>"trash"===e.type&&!e.trashItem;_isPinnedFolder=e=>"pinned"===e.type;_getSelectedBackgroundPages=()=>{const e=this.getSelectedItems(),t=e.filter((e=>"window"===e.type||"workspace"===e.type));return t.length>0?t.flatMap((e=>e.children||[e])).flatMap((e=>e.children||[e])).map((e=>e.pageItem)).filter(Boolean).filter((e=>e.page!==ie.ZP.getActivePage(e.page.windowId))).map((e=>e.page)):e.flatMap((e=>e.children||[e])).map((e=>e.pageItem)).filter(Boolean).filter((e=>e.page!==ie.ZP.getActivePage(e.page.windowId))).map((e=>e.page))};_getDiscardablePages=()=>this._getSelectedBackgroundPages().filter((e=>!e.discarded&&!e.isInspected));_getStackableSelectedNodes=()=>{let e=this.getSelectedItems();if(1===e.length&&"stack"===e[0].type)return[];return e=e.filter((e=>"tab"===e.type||"stack"===e.type)).flatMap((e=>e.children??[e])).filter((e=>e.pageItem)),(e=>{const t=[];return e.forEach((e=>{e.pageItem&&-1===t.findIndex((t=>e.wid))&&t.push(e.wid)})),t})(e).length>1?[]:e};_getStackableNodesForHost=(e,t)=>this.state.nodes.filter((t=>"window"===t.type&&t.wid===e)).flatMap((e=>e.children||e)).filter((e=>e.pageItem&&!e.pageItem.page.pinned&&e.pageItem.hostname===t.hostname));_getTileableSelectedNodes=()=>{const e=this.context.vivaldiWindowId,t=this.getSelectedItems();if(1===t.length&&"stack"===t[0].type){const e=new Map,n=this._getChildren(t[0]);for(let t=0;t<n.length;t++){const s=n[t].pageItem,i=s?(0,ay.jA)(s.page):void 0;if(void 0===i){e.clear();break}e.set(i,"")}if(1===e.size)return[]}const n=this._filterNodesToTabs().filter((e=>void 0!==e.pageItem)),s=(0,VF.Z)(n.map((e=>e.pageItem?.page&&(0,ay.jA)(e.pageItem.page))));return 1===s.length&&s[0]&&ie.ZP.getTiles(s[0],e).size===n.length?[]:n};_filterNodesToTabs=()=>this.getSelectedItems().filter((e=>"tab"===e.type||"stack"===e.type||"pinned"===e.type)).flatMap((e=>e.children||e));_getSelectedTilingItems=()=>this._filterNodesToTabs().map((e=>{const t=e.pageItem?(0,ay.jA)(e.pageItem.page):void 0;return t?{node:e,tid:t}:void 0})).filter(Boolean).filter(((e,t,n)=>n.indexOf(e)===t));_getNodesWithMediaState=(e,t)=>{let n=[];return"selection"===t?n=this.getSelectedItems():"all"===t?n=this.state.nodes:"active"===t&&(n=this.state.nodes.filter((e=>Boolean(e.pageItem&&e.pageItem.page.active)))),n.filter((e=>"window"===e.type||"tab"===e.type||"stack"===e.type||"pinned"===e.type)).map((e=>e.children||e)).reduce(((e,t)=>e.concat(t)),[]).filter((t=>{const n=t.pageItem?.page;return n&&("playing"===e?q8.Z.hasMediaState(n.id,"playing")&&!q8.Z.hasMediaState(n.id,"muting"):q8.Z.hasMediaState(n.id,e))&&!n.discarded}))};_getMuteableNodesFrom=e=>this._getNodesWithMediaState("playing",e);_muteOthers=e=>{if(e.pageItem)d.ZP.muteAllExcept(e.wid,[e.pageItem.page]);else{const t=this._getChildren(e).map((e=>e.pageItem?.page)).filter(Boolean);d.ZP.muteAllExcept(e.wid,t)}};_getPlayableNodesFrom=(e,t)=>{const n=this._getNodesWithMediaState("muting",e),s=t.pageItem?.page;switch(this.props.prefValues[$.kTabsAutoMuting]){case"onlyActive":return n.filter((e=>e.pageItem?.page?.active));case"prioritizeActive":if(n.length>1){const e=ie.ZP.getActivePage(t.wid);return e&&q8.Z.hasMediaState(e.id,"playing")?[]:n.filter((e=>e.pageItem?.page===s))}}return n};_isUnread=e=>!(!this.props.prefValues[$.kTabsUnread]||!e.pageItem?.page)&&ie.ZP.isUnread(e.pageItem.page);_isInStackFolder=e=>"stack"===e.type||Boolean(e.pageItem&&(0,ay.av)(e.pageItem.page));_isInTrashFolder=e=>"trash"===e.type||Boolean(e.trashItem);_isInPinnedFolder=e=>"pinned"===e.type||Boolean(e.pageItem?.page.pinned);_isSyncFolder=e=>"syncFolder"===e.type||"syncDevice"===e.type||"syncWindow"===e.type;_isInSyncFolder=e=>this._isSyncFolder(e)||Boolean(e.syncItem);_hasSyncUrls=e=>this._isSyncFolder(e)&&Boolean(e.children?.length)||Boolean(e.syncItem);_isWithinFolder=(e,t)=>{if(this._isFolder(e)){const n=Boolean(this.refTreeList.current?.isExpanded(e.id));return"on"===t||n&&"below"===t}return void 0!==e.parentId};_getStackFolderByNode=e=>{let t=e;return t.pageItem&&(t=this._getNodeById(t.parentId)),"stack"===t?.type?t:void 0};_getPageByNode=e=>{if("stack"===e.type){const t=this._getChildren(e);return t.length>0?t[0].pageItem?.page:void 0}return e.pageItem?.page};_getPageIdByNode=e=>this._getPageByNode(e)?.id;_getNodeById=e=>{const t=n=>{for(let s=0;s<n.length;s++){let i=n[s];if(i.id===e)return i;if(i.children&&(i=t(i.children),i))return i}};return e===Mde?this._getRootNode(this.state.nodes):t(this.state.nodes)};_getNodeByParentAndIndex=(e,t)=>{const n=this._getNodeById(e);return n&&n.children&&n.children.length>0?(t<0?t=0:t>=n.children.length&&(t=n.children.length-1),n.children[t]):n};_getNodeByParentAndPageIndex=(e,t)=>{const n=this._getNodeById(e)?.wid??this.context.vivaldiWindowId,s=ie.ZP.getPages(n).find((e=>e.index===t));if(s)return this._getNodeById(s.id.toString())};_hasChildren=e=>Boolean(e.children&&e.children.length>0);_isFolder=e=>Boolean(e.children);expandAll=()=>{this.refTreeList.current?.expandAll()};_onNodeClick=(e,t)=>{Hi.Z.isNoModifierPressed(e)&&e.button===Hi.Z.kLeft&&this.props.prefValues[$.kPanelsWindowSingleClickOpens]&&this._onNodesActivated(e,[t])};_onNodeMouseDown=(e,t)=>{Hi.Z.isNoModifierPressed(t)&&t.button===Hi.Z.kCenter&&(this.centerDownId=e.id)};_onNodeMouseUp=(e,t)=>{Hi.Z.isNoModifierPressed(t)&&t.button===Hi.Z.kCenter&&this.centerDownId===e.id&&e.pageItem&&!e.pageItem.page.pinned&&this._closeWithId(e.id),this.centerDownId=""};_onNodeDoubleClick=(e,t)=>{e.button!==Hi.Z.kLeft||this.props.prefValues[$.kPanelsWindowSingleClickOpens]||this._onNodesActivated(e,[t])};handleNodesActivated=(e,t)=>{this._onNodesActivated(e,t)};_activateTab=e=>{if(e.pageItem){const t=e.pageItem.page.id,n=ie.ZP.getPageById(t)?.windowId??e.wid,s=this.context.vivaldiWindowId,i=G.ZP.getActiveWorkspace(s);if(s===n)e.workspaceId!==i&&cs.Z.setActiveWorkspace(s,e.workspaceId);else{const t=G.ZP.getActiveWorkspaces(this.context.vivaldiWindowId);e.workspaceId&&!t.has(e.workspaceId)?cs.Z.setActiveWorkspace(s,e.workspaceId):e.workspaceId||cs.Z.setActiveWorkspace(n,e.workspaceId)}cs.Z.focus(n).then((()=>{d.ZP.activateTab(t,n)}))}else e.syncItem&&ss.openTabs([e.id])};_openSyncItems=e=>{const t=(e,n,s)=>{for(let i=0;i<e.length;i++){const o=e[i];if("syncFolder"===o.type)o.children?.length&&t(o.children,n,void 0);else if("syncDevice"===o.type){if(o.children?.length){const e=o.children[0];e.syncItem?n.push(e.syncItem.windowId):t(o.children,n,void 0)}}else"syncWindow"===o.type?n.push(o.id):Boolean(o.syncItem)&&void 0!==s&&s.push(o.id)}},n=[],s=[];t(e,n,s),ss.openTabs(s),ss.openWindows(n)};_onNodesActivated=(e,t)=>{const n=t[0];if(n.trashItem)n.trashItem.tab?as.Z.undeleteTab(n.trashItem.tab.handle):n.trashItem.window&&as.Z.undeleteWindow(n.trashItem.window.handle);else if(n.pageItem)this._activateTab(n);else if(n.syncItem)this._activateTab(n);else if(this._isPinnedFolder(n)){let e=this._getNodeById(this.lastActivePinnedId);!e&&n.children&&n.children.length>0&&(e=n.children[0]),e?.pageItem&&this._activateTab(e)}};_closeByIds=e=>{let t=e.map((e=>this._getNodeById(e))).filter(Boolean);const n=t.filter((e=>"stack"===e.type)),s=t.filter((e=>"workspace"===e.type)),i=t.filter((e=>"window"===e.type)),o=t.filter((e=>"trash"===e.type)),a=n.map((e=>e.children)).filter(Boolean).reduce(((e,t)=>e.concat(t)),[]);if(t=t.filter((e=>"stack"!==e.type&&"workspace"!==e.type)).filter((e=>-1===a.findIndex((t=>t.id===e.id)))),i.length>0)return i.forEach((e=>cs.Z.close(e.wid))),Promise.resolve([]);if(1===s.length&&1===e.length){const e=s[0]?.workspaceId;if(e)return Ae.Z.showDeleteWorkspace(this.context.vivaldiWindowId,{workspaceId:e}),Promise.resolve([])}n.forEach((e=>{const t=this._getPageIdByNode(e);"number"==typeof t&&d.ZP.closeTabStack(t)})),d.ZP.closePage((0,te.aV)(t.map((e=>e.pageItem?.page)).filter(Boolean)));const r=o.map((e=>e.trashItem?.tab?.handle.sessionId)).filter(Boolean);return as.Z.removeTabs(r),Promise.resolve([])};_getPagesByIds=e=>{const t=[];return e.map((e=>this._getNodeById(e))).filter(Boolean).forEach((e=>{e.pageItem?t.push(e.pageItem.page):e.children&&("window"===e.type?Array.prototype.push.apply(t,this._getChildren(e).map((e=>e.children||e)).reduce(((e,t)=>e.concat(t)),[]).map((e=>e.pageItem?.page)).filter(Boolean)):Array.prototype.push.apply(t,this._getChildren(e).map((e=>e.pageItem?e.pageItem.page:void 0)).filter(Boolean)))})),t};_getSyncNodesByIds=e=>{const t=[];for(let n=0;n<e.length;n++){const s=this._getNodeById(e[n]);if(s?.syncItem)t.push(s);else if(s?.children){const e=s.children.map((e=>e.id));Array.prototype.push.apply(t,this._getSyncNodesByIds(e))}}return t};_saveBookmarkByIds=e=>{if(0===e.length)g.Z.bookmarkAllOpenPages(this.context.vivaldiWindowId,ps.ZP.getRootNode().id);else{const t=this._getNodeById(e[0]);if(t&&this._isInSyncFolder(t)){const t=this._getSyncNodesByIds(e).map((e=>{if(e.syncItem)return{url:e.syncItem.url,title:e.title}})).filter(Boolean);g.Z.createBookmarks(t,ps.ZP.getRootNode().id,0,"sync")}else g.Z.bookmarkPages((0,te.aV)(this._getPagesByIds(e)),!1,ps.ZP.getRootNode().id)}};_saveSessionByIds=e=>{const t=this.context.vivaldiWindowId;if(0===e.length)Ae.Z.showSaveSessionDialog(t,{mode:"all"});else{const n=this._getPagesByIds(e).map((e=>e.id));n.length>0&&Ae.Z.showSaveSessionDialog(t,{mode:"ids",ids:n})}};_handleExpandClick=(e,t)=>{(0,to.ZP)(e);const n=e.altKey;this.refTreeList.current?.toggleSelectedExpansion(t,n)};_validateForDrag=e=>{const t=e.map((e=>this._getNodeById(e))).filter(Boolean).filter((e=>e&&!this._isSyncFolder(e)));return t.every((e=>"workspace"===e.type))?t.map((e=>e.id)):t.filter((e=>"window"!==e.type&&"workspace"!==e.type&&!this._isPinnedFolder(e)&&!this._isTrashFolder(e))).map((e=>e.id))};_getDragData=(e,t)=>{const n=t.map((e=>this._getNodeById(e))).filter(Boolean);if("text/plain"===e){return n.map((e=>e.pageItem?e.pageItem.url:e.trashItem?.tab?e.trashItem.tab.url:e.syncItem?.url?e.syncItem.url:e.title)).join("\r\n")}if(Ds.ZP.isUriListType(e)){return n.map((e=>e.pageItem?e.pageItem.url:e.trashItem?.tab?.url||"")).filter(Boolean).join("\r\n")}return""};_setCustomDragData=(e,t)=>{const n=t.map((e=>this._getNodeById(e))).filter(Boolean),s=n.map((e=>Boolean(e.trashItem))),i=n.map((e=>Boolean(e.pageItem?.page.pinned))),o=n.map((e=>Boolean(e.syncItem)));if(s.some((e=>!0===e))&&e.setData("vivaldi/x-tab-closed",JSON.stringify(s)),i.some((e=>!0===e))&&e.setData("vivaldi/x-tab-pinned",JSON.stringify(i)),o.some((e=>!0===e))&&e.setData("vivaldi/x-tab-sync",JSON.stringify(o)),1===n.length){const t=this._getTitle(n[0].id);t&&e.setData("vivaldi/x-title",t)}};_getDropSupport=(e,t)=>{const n={available:!1,onto:!1,edge:"both"};if(this._isInSyncFolder(e))return n.edge="none",n;if(-1!==t.dataTransfer.types.findIndex((e=>"vivaldi/x-tab-sync"===e)))return n.edge="none",n;if(-1!==t.dataTransfer.types.findIndex((e=>"vivaldi/x-tab-closed"===e)))return n.available=!this._isInTrashFolder(e),n.onto=n.available&&this._canDropOnto(e,t),n;if(-1!==t.dataTransfer.types.findIndex((e=>"vivaldi/x-tab-pinned"===e))){if(!this.props.prefValues[$.kPanelsWindowShowPinnedGroup])return n.available=Boolean(e.pageItem?.page.pinned),n.onto=n.available&&this._canDropOnto(e,t),n;if(this._isInTrashFolder(e))return n}return t.dataTransfer.types.some((e=>Ds.ZP.isUriListType(e)||"text/plain"===e))&&(t.dataTransfer.types.includes(Dde)?(n.available=!0,this._isTrashFolder(e)&&(n.edge="none")):n.available=!this._isInTrashFolder(e),n.onto=n.available&&this._canDropOnto(e,t)),n};_canDropOnto=(e,t)=>!this._isInSyncFolder(e)&&(!!this._isFolder(e)||!(t.dataTransfer.types.includes(Dde)&&(!this.props.prefValues[$.kPanelsWindowDragToStack]||this._isInPinnedFolder(e)||this._isInStackFolder(e)))&&!this._isInTrashFolder(e));_getDropIndexByNode=(e,t)=>{let n=0;if(e.pageItem){const s=e.pageItem.page.id;n=ie.ZP.getTabs(e.wid,!0).findIndex((e=>e.page.id===s)),"below"===t&&(n+=1)}else if(e.children){const s=this._getChildren(e);if(s.length>0){if("above"===t||"below"===t){const e=s[0];if(e.pageItem){const t=e.pageItem.page.id;n=ie.ZP.getTabs(e.wid,!0).findIndex((e=>e.page.id===t))}}"below"===t&&(n+=1)}}return n};_onDrop=async(e,t,n)=>{const s=Ds.ZP.extractUriListFromEvent(e).split("\n").map((e=>e));if(s.length>0)if("on"===n&&t.pageItem)d.ZP.openURL(t.wid,s[0],{inCurrent:!0,inSpecificPageId:t.pageItem.page.id,vivExtData:JSON.stringify({workspaceId:t.workspaceId})});else{const e=this._getTargetSpec(t,n),i=this._getDropIndexByNode(t,n),o=t.wid,a=this._getStackFolderByNode(t),r=this._getPageByNode(t),l=a&&r&&(0,ay.av)(r);try{const c=await d.ZP.newTab(o,s[0],{index:i,workspaceId:t.workspaceId,groupId:l}),h=ie.ZP.getPageById(c);if(h&&this._isWithinFolder(t,n)&&this._isInPinnedFolder(t)){d.ZP.setPinned(te.aV.of(h),!0);const t=e.pageIndex??e.index??0;await d.ZP.moveToIndex(h.windowId,h,t)}else if(h&&l&&a){const e=r?.index??this._getPageIndex(a)??0;d.ZP.moveToIndex(o,h,e)}this.refTreeList.current?.selectById(c.toString())}catch(e){console.warn(e)}}return Promise.resolve([])};_moveWorkspaces(e,t,n){const s=this.context.vivaldiWindowId,i=e.workspaceId,o=Kj.Z.getWorkspaces(s).map((e=>e.id)),a=t.map((e=>e.workspaceId)).filter(Boolean).toArray(),r=[];if("workspace"===e.type||e.parentId.startsWith("workspace"))for(const e of o)a.includes(e)||(e===i?"above"===n?r.push(...a,e):r.push(e,...a):r.push(e));else if(e.parentId.startsWith("window")){r.push(...a);for(const e of o)r.includes(e)||r.push(e)}r.length===o.length&&kq.Z.setOrder(s,r)}_getTargetPage=(e,t,n)=>{const s=t.pageIndex,i=e?.index??0;if(!s||e?.windowId!==t.wid)return this._getPageByNode(t);let o=0;i<s?o="above"===n?-1:0:i>s&&(o="below"===n?1:0);const a=s+o;return ie.ZP.getPages(t.wid).find((e=>e.index===a))};_onMove=async(e,t,n)=>{const{parentId:s=""}=t;let i=t.index??0;const o=this._getNodeById(s);if(!o||!s)return;this.isDroppingOnWindowOrWorkspace&&"above"===n?n="below":this.isDroppingOnWindowOrWorkspace&&!this._isTrashFolder(o)&&"on"===n?n="above":"stack"===o.type&&"on"===n&&(n="below",i=this._getChildren(o).length),this.isDroppingOnWindowOrWorkspace=!1;const a=void 0!==t.pageIndex?this._getNodeByParentAndPageIndex(s,t.pageIndex):this._getNodeByParentAndIndex(s,i);if(!a)return;const r=(0,te.aV)(e).map(this._getNodeById).filter(Boolean),l=r.flatMap((e=>e.children?(0,te.aV)(e.children):te.aV.of(e))).map(this._getPageByNode).filter(Boolean);let c=this._getTargetPage(l.first(),a,n);c||(c=this._isInPinnedFolder(o)?ie.ZP.getTabs(o.wid,!1).find((e=>e.page.pinned))?.page??null:ie.ZP.getTabs(o.wid,!1).find((e=>!e.page.pinned))?.page??null);const h=this._getNodeById(e[0]);if(!h)return;const p=h.wid;if(this._isInTrashFolder(a))return void this._closeByIds(e);if(h.trashItem)return void r.forEach((e=>{e.trashItem?.tab?as.Z.undeleteTab(e.trashItem.tab.handle):e.trashItem?.window&&as.Z.undeleteWindow(e.trashItem.window.handle)}));const u=a.workspaceId;if(r.every((e=>"workspace"===e.type)))return void this._moveWorkspaces(a,r,n);const g=a.pageItem&&(0,ay.av)(a.pageItem.page),m=e.filter((e=>ie.ZP.isGroup(e,p)));if("stack"===o.type&&ie.ZP.isGroup(g,a.wid))await d.ZP.treeMove({pages:l,groups:m,targetPage:c,area:"stack",group:g,windowId:p,targetWorkspaceId:u});else if(this.props.prefValues[$.kPanelsWindowShowPinnedGroup]&&this._isInPinnedFolder(o)){const e=l.first();let t=e?(0,ay.av)(e):"";t&&l.size>1&&(ie.ZP.getGroup(t,p).size!==l.size||l.some((e=>(0,ay.av)(e)!==t)))&&(t=""),await d.ZP.treeMove({pages:l,groups:m,targetPage:c,group:t,area:"pinned",windowId:p,targetWorkspaceId:u})}else if("on"===n&&void 0!==t.pageIndex&&this.props.prefValues[$.kPanelsWindowDragToStack]){if(c){const e=c.id,t=l.filter((t=>t.id!==e));let n=c.index,s=0;for(let e=0;e<t.size;e++){const i=t.get(e);i&&n>i.index&&s++}n-=s;const i=ie.ZP.getNewGroupId();d.ZP.createTabStack(t.splice(0,0,c),n,i),this.refTreeList.current?.selectById(i)}}else await d.ZP.treeMove({pages:l,groups:m,targetPage:c,area:"regular",windowId:p,targetWorkspaceId:u});l.some((e=>e.active))&&cs.Z.setActiveWorkspace(p,u);const v=new Map([...Kj.Z.getWorkspacePageCounts(p)]);for(const[e,t]of v)if(0===t){const{pageId:t}=await d.ZP.openURL(p,"",{inBackground:!0}),n=await ie.ZP.getPageInWindow(p,t);n&&d.ZP.moveToWorkspace(n,e)}};_onCopy=(e,t)=>{const n=t.filter(this._isValidForClipboard),s=n.map((e=>e.pageItem?.page)).filter(Boolean),i=n.map((e=>e.syncItem?.url)).filter(Boolean);d.ZP.copyUrls((0,te.aV)(s),(0,te.aV)(i)),e.preventDefault()};_isValidForClipboard=e=>Boolean(e.pageItem||e.syncItem||e.trashItem?.tab);_isValidToDelete=e=>e.map((e=>this._getNodeById(e))).filter(Boolean).filter((e=>!this._isInPinnedFolder(e))).filter((e=>!this._isInSyncFolder(e))).map((e=>e.id));_getTargetSpec=(e,t)=>{const n={index:0,parentId:void 0,pageIndex:e.pageIndex},s=Boolean(this.refTreeList.current?.isExpanded(e.id)),i=this._isFolder(e);if(!i||"window"!==e.type&&"workspace"!==e.type&&"trash"!==e.type)i&&("on"===t||s&&"below"===t)?n.parentId=e.id:e.parentId?(n.parentId=e.parentId,n.index=e.index+("below"===t?1:0)):(n.parentId=e.id,n.index=0);else if(this.isDroppingOnWindowOrWorkspace=!0,"above"===t){const t=this.state.nodes.findIndex((t=>t.id===e.id)),s=this.state.nodes[Math.max(0,t-1)];n.parentId=s.id,n.index=s.children?.length}else n.parentId=e.id;return n};_reload=()=>{const e=this.getSelectedItems().filter((e=>"window"===e.type)).map((e=>this._getChildren(e))).filter(Boolean).reduce(((e,t)=>e.concat(t)),[]).map((e=>e.children||e)).reduce(((e,t)=>e.concat(t)),[]),t=this.getSelectedItems().filter((e=>"stack"===e.type||"pinned"===e.type)).map((e=>this._getChildren(e))).filter(Boolean).reduce(((e,t)=>e.concat(t)),[]).filter((t=>-1===e.findIndex((e=>e===t.id)))),n=this.getSelectedItems().filter((e=>"tab"===e.type&&Boolean(e.pageItem))).filter((t=>-1===e.findIndex((e=>e===t.id)))).filter((e=>-1===t.findIndex((t=>t===e.id))));[e,t,n].forEach((e=>{const t=e.map((e=>e.pageItem?.page.id)).filter(Boolean);d.ZP.reloadPage((0,te.aV)(t))}))};_tile=()=>{const e=this._getTileableSelectedNodes();e.length>1&&d.ZP.tilePages((0,te.aV)(e.map((e=>e.pageItem?.page)).filter(Boolean)),"row")};_removeTile=()=>{this._getSelectedTilingItems().forEach((e=>{d.ZP.untileTileGroup(e.node.wid,e.tid)}))};_setMediaState=(e,t)=>{if("playing"===e){const e=this._getPlayableNodesFrom("selection",t).map((e=>e.pageItem?.page)).filter(Boolean);d.ZP.setMuting(t.wid,"selection","unmute",(0,te.aV)(e))}else if("muting"===e){const e=this._getMuteableNodesFrom("selection").map((e=>e.pageItem?.page)).filter(Boolean);d.ZP.setMuting(t.wid,"selection","mute",(0,te.aV)(e))}};newTab=e=>{const t=G.ZP.getActiveWorkspace(e);d.ZP.newTab(e,"",{workspaceId:t}).then((e=>{this.refTreeList.current?.expandToId(e.toString()),this.refTreeList.current?.selectById(e.toString())})).catch((e=>{console.warn(e)}))};_newTabAfter=e=>{const t=this._getNodeById(e);if(!t)return;const n=this._getTargetSpec(t,"below"),s="window"===t.type||"workspace"===t.type?"on":"below",i=this._getDropIndexByNode(t,s);this.blockPageStoreChange=!0,d.ZP.newTab(t.wid,"",{index:i,workspaceId:t.workspaceId}).then((e=>{if(this._isWithinFolder(t,"below")){const s=ie.ZP.getPages(t.wid).find((t=>t.id===e));if(this._isInPinnedFolder(t)){const e=this._getPageIndex(t);s&&void 0!==e&&(d.ZP.setPinned(te.aV.of(s),!0),d.ZP.moveToIndex(s.windowId,s,e))}else if(this._isInStackFolder(t)){const e=this._getPageByNode(t),i=this._getStackFolderByNode(t);if(e&&i){const t=this._getChildren(i).map((e=>e.pageItem?.page)).filter(Boolean);t.splice(n.index??0,0,s),d.ZP.createTabStack((0,te.aV)(t.filter(Boolean)),this._getPageIndex(i),e.vivExtData.group)}}}this.blockPageStoreChange=!1,this._onPageStoreChanged(),this.refTreeList.current?.expandToId(e.toString()),this.refTreeList.current?.selectById(e.toString())})).catch((e=>{console.warn(e)}))};_cloneTab=()=>{const e=this.getSelectedItems().map((e=>e.pageItem?.page)).filter(Boolean);d.ZP.clonePages((0,te.aV)(e))};_pinTab=()=>{const e=this.getSelectedItems().filter((e=>!this._isInStackFolder(e))).map((e=>e.pageItem?.page)).filter(Boolean).filter((e=>!e.pinned));d.ZP.setPinned((0,te.aV)(e),!0)};_pinStack=e=>{const t=ie.ZP.getGroup(e,this.context.vivaldiWindowId);d.ZP.setPinned(t,!0)};_unpinStack=e=>{const t=ie.ZP.getGroup(e,this.context.vivaldiWindowId);d.ZP.setPinned(t,!1)};_unpinTab=()=>{const e=this.getSelectedItems().map((e=>e.pageItem?.page)).filter(Boolean).filter((e=>e.pinned));d.ZP.setPinned((0,te.aV)(e),!1)};_closeWithId=(e,t)=>{t&&(0,to.ZP)(t);const n=this._getNodeById(e);if(n)if("tab"===n.type)this.refTreeList.current?.onDeleteItems([n.id]);else if("stack"===n.type){const e=this._getPageIdByNode(n);"number"==typeof e&&d.ZP.closeTabStack(e)}};_deleteWithId=(e,t)=>{t&&(0,to.ZP)(t);const n=this._getNodeById(e);if(n){const e=[n].map((e=>e.trashItem?.tab?.handle.sessionId)).filter(Boolean);as.Z.removeTabs(e)}};_close=()=>{const e=this.getSelectedItems().filter((e=>"stack"===e.type)),t=e.map((e=>this._getChildren(e))).filter(Boolean).reduce(((e,t)=>e.concat(t)),[]),n=this.getSelectedItems().filter((e=>Boolean(e.pageItem))).filter((e=>-1===t.findIndex((t=>t===e.id))));this.blockPageStoreChange=!0;let s=e.map((e=>this._getPageByNode(e))).filter(Boolean);s.forEach((e=>{d.ZP.closeTabStack(e.id)})),s=n.map((e=>e.pageItem?.page)).filter(Boolean).filter((e=>!e.pinned)),d.ZP.closePage((0,te.aV)(s)),this.blockPageStoreChange=!1,this._onPageStoreChanged()};_reopen=()=>{const e=this.getSelectedItems().filter((e=>Boolean(e.trashItem))),t=e.filter((e=>Boolean(e.trashItem?.window))),n=t.map((e=>e.children)).filter(Boolean).reduce(((e,t)=>e.concat(t)),[]),s=e.filter((e=>-1===n.findIndex((t=>t===e.id))));t.forEach((e=>{e.trashItem?.window&&as.Z.undeleteWindow(e.trashItem.window.handle)})),s.forEach((e=>{e.trashItem?.tab&&as.Z.undeleteTab(e.trashItem.tab.handle)}))};_createTabStack=()=>{this._createTabStackWithNodes(this._getStackableSelectedNodes())};_createTabStackForHost=(e,t)=>{const n=this._createTabStackWithNodes(t);n&&(0,Ade.ZP)(t[0].wid,n,e)};_createTabStackWithNodes=e=>{if(e.length<2)return;let t=-1;for(let n=0;n<e.length;n++){let s=e[n];if(this._isInStackFolder(s)&&(s=this._getNodeById(s.parentId)),!s)return;{const e=this._getPageIndex(s);(-1===t||t>e)&&(t=e)}}const n=e.map((e=>e.pageItem?.page)).filter(Boolean);if(n.length<2)return;const s=ie.ZP.getNewGroupId();return d.ZP.createTabStack((0,te.aV)(n),-1===t?0:t,s),this.refTreeList.current?.selectById(s),s};_disolveTabStack=()=>{const e=this.getSelectedItems(),t=e.filter((e=>"stack"===e.type)),n=t.map((e=>this._getPageByNode(e))).filter(Boolean);n.forEach((e=>{const t=(0,ay.av)(e);t&&d.ZP.expandTabStack(e.windowId,t)})),n.length>0&&e.length===t.length&&this.refTreeList.current?.selectById(n[0].id.toString())};_hibernate=()=>{this._getDiscardablePages().forEach((e=>{d.ZP.discardPage(e)}))};_reopenLastClosedTab=()=>{as.Z.undeletePreviousTab()};_validateForEdit=e=>{const t=this._getNodeById(e);return!!t&&("workspace"===t.type||ie.ZP.isGroup(e,t.wid))};_getTitle=e=>this._getNodeById(e)?.title||"";_setTitle=(e,t)=>{const n=this._getNodeById(e);if(n)if("workspace"===n.type&&n.workspaceId){if(!t)return;kq.Z.setName(n.workspaceId,t)}else(0,Ade.ZP)(n.wid,e,t)};_getMenuCapability=async(e,t,n)=>{const s=n?n.wid:this.context.vivaldiWindowId,i=n?.pageItem?.page,o="tab"===n?.type,a=o||"stack"===n?.type,r=a||"window"===n?.type,l="workspace"===n?.type,c=Boolean(n&&this._isInTrashFolder(n)),h=n&&this._isInSyncFolder(n),p=this._getStackableSelectedNodes(),u={hostname:i?(0,Tde.q)(i):"",selectedCount:p.length,isInTrashFolder:c};let g,m=!1;if(i)g=(0,ay.av)(i);else if(!o&&n?.children&&"stack"===n?.type){const e=n.children[0]?.pageItem?.page;e?.pinned&&(m=!0),g=e&&(0,ay.av)(e)}switch(e.action){case"CONTEXT_NEW":return{handler:()=>{n?this._newTabAfter(n.id):this.newTab(s)},isVisible:()=>!n||!c&&!h,...t(s,e,u)};case"CONTEXT_NEW_STACK":return{handler:()=>{this._createTabStack()},isVisible:()=>{const e=p.filter((e=>e.pageItem?.page.pinned)).length;return(0===e||e===p.length)&&!h&&a&&u.selectedCount>1},...t(s,e,u)};case"CONTEXT_NEW_STACK_FOR_HOST":const v=n?this._getNodeById(n.id)?.pageItem:void 0,f=v?.hostname||"",y=n&&v?this._getStackableNodesForHost(n.wid,v):[];return{handler:()=>this._createTabStackForHost(f,y),isVisible:()=>o&&!h&&f.length>0&&1===this.getSelectedItems().length&&y.length>1,...t(s,e,u)};case"CONTEXT_TABSTACK_UNGROUP":return{handler:()=>{this._disolveTabStack()},isVisible:()=>"stack"===n?.type,...t(s,e,u)};case"CONTEXT_CLONE":return{handler:()=>{this._cloneTab()},isVisible:()=>o&&!c&&!h,...t(s,e,u)};case"CONTEXT_ACTIVATE":return{handler:()=>{if(cs.Z.focus(s),i){const e=(0,ay.cm)(i);e!==G.ZP.getActiveWorkspace(s)&&cs.Z.setActiveWorkspace(s,e),d.ZP.activateTab(i.id,s)}},isVisible:()=>("window"!==n?.type||s!==this.context.vivaldiWindowId)&&(r&&!c&&!h),...t(s,e,u)};case"CONTEXT_RELOAD":return{handler:()=>{this._reload()},isVisible:()=>r&&!c&&!h,...t(s,e,u)};case"CONTEXT_HIBERNATE":return{handler:()=>{this._hibernate()},isEnabled:()=>this._getDiscardablePages().length>0,isVisible:()=>(r||l)&&!c&&!h,...t(s,e,u)};case"CONTEXT_PIN":return{handler:()=>{this._pinTab()},isVisible:()=>Boolean(i&&!i.pinned&&!c&&!g),...t(s,e,u)};case"CONTEXT_PIN_STACK":return{handler:()=>{g&&this._pinStack(g)},isVisible:()=>!m&&ie.ZP.isGroup(g,s)&&"stack"===n?.type,...t(s,e,u)};case"CONTEXT_UNPIN":return{handler:()=>{this._unpinTab()},isVisible:()=>Boolean(i?.pinned)&&!c&&!g,...t(s,e,u)};case"CONTEXT_UNPIN_STACK":return{handler:()=>{g&&this._unpinStack(g)},isVisible:()=>m,...t(s,e,u)};case"CONTEXT_TILE_TABS":return{handler:()=>{this._tile()},isVisible:()=>{if(a&&!h){const e=G.ZP.getActiveWorkspace(s);return!this._getTileableSelectedNodes().some((t=>{const n=t?.pageItem?.page;return!n||t.wid!==s||(0,ay.cm)(n)!==e}))}return!1},...t(s,e,u)};case"CONTEXT_UNTILE_TABS":return{handler:()=>{this._removeTile()},isVisible:()=>a&&this._getSelectedTilingItems().length>0,...t(s,e,u)};case"CONTEXT_MUTE":return{handler:()=>{n&&this._setMediaState("muting",n)},isVisible:()=>r&&!c&&!h&&this._getMuteableNodesFrom("selection").length>0,...t(s,e,u)};case"CONTEXT_MUTE_OTHER":{const i="window"===n?.type&&Boolean(n.wid!==this.context.vivaldiWindowId);return{handler:()=>{n&&this._muteOthers(n)},isVisible:()=>!!n&&((a||i)&&this._getMuteableNodesFrom("all").filter((e=>e.id!==n.id)).length>0),...t(s,e,u)}}case"CONTEXT_UNMUTE":return{handler:()=>{n&&this._setMediaState("playing",n)},isVisible:()=>!!n&&(r&&this._getPlayableNodesFrom("selection",n).length>0),...t(s,e,u)};case"CONTEXT_EMPTY_TRASH":return{handler:()=>{as.Z.emptyTrash()},isVisible:()=>Boolean(n&&this._isTrashFolder(n)&&kde.Z.getTrash().length>0),...t(s,e,u)};case"CONTEXT_REOPEN":return{handler:()=>{n?this._reopen():this._reopenLastClosedTab()},isVisible:()=>Boolean((!n||n.trashItem)&&kde.Z.getTrash().length>0),...t(s,e,u)};case"CONTEXT_OPEN_IN_NEW_WINDOW":return{handler:()=>n?.workspaceId&&d.ZP.detachWorkspace(n.workspaceId),isVisible:()=>"workspace"===n?.type,isEnabled:()=>{const e=G.ZP.getActiveWorkspaces(s);return"number"==typeof n?.workspaceId&&!e.has(n.workspaceId)},...t(s,e,u)};case"CONTEXT_OPEN_SYNC_ITEMS":return{handler:()=>{n&&this._openSyncItems(this.getSelectedItems())},isVisible:()=>void 0!==n&&this._isInSyncFolder(n)&&this._hasSyncUrls(n),...t(s,e,u)};case"CONTEXT_REGISTER_SYNC":return{handler:()=>{Ae.Z.showSettings(this.context.vivaldiWindowId,"sync",{view:"register"})},isVisible:()=>void 0!==n&&this._isInSyncFolder(n)&&!qn.getLoggedIn(),...t(s,e,u)};case"CONTEXT_SIGNIN_SYNC":return{handler:()=>{Ae.Z.showSettings(this.context.vivaldiWindowId,"sync")},isVisible:()=>void 0!==n&&this._isInSyncFolder(n)&&!qn.getLoggedIn(),...t(s,e,u)};case"COMMAND_PAGE_COPY_ALL_URLS":{const i={...t(s,e,u)};let o=!1;return n&&("workspace"===n.type?o=n.workspaceId===G.ZP.getActiveWorkspace(n.wid):"window"===n.type&&(o=n.wid===G.ZP.getActiveWindowId()&&void 0===G.ZP.getActiveWorkspace(n.wid))),{...i,shortcuts:o?i.shortcuts:[],handler:()=>{n&&d.ZP.copyAllUrls(n.wid,n.workspaceId)},isVisible:()=>"workspace"===n?.type||"window"===n?.type}}default:return{...t(s,e,u)}}};_getMenuVisibility=(e,t)=>{if(t)if(this._isTrashFolder(t))switch(e.action){case"CONTEXT_EXPAND_ALL":case"CONTEXT_COLLAPSE_ALL":return!0;default:return!1}else if("workspace"===t.type)switch(e.action){case"CONTEXT_RENAME":return this._validateForEdit(t.id)&&1===this.getSelectedItems().length;case"CONTEXT_SAVE":case"CONTEXT_SAVE_ALL":case"CONTEXT_DELETE":case"CONTEXT_EXPAND_ALL":case"CONTEXT_COLLAPSE_ALL":return!0;default:return!1}else{const n=this._isValidToDelete([t.id]).length>0,s=!G.ZP.isGuest()&&(this._isInSyncFolder(t)?this._hasSyncUrls(t):this._isInTrashFolder(t)),i=s&&!this._isInSyncFolder(t);switch(e.action){case"CONTEXT_RENAME":return this._validateForEdit(t.id)&&1===this.getSelectedItems().length;case"CONTEXT_COPY":return this._isValidForClipboard(t);case"CONTEXT_SAVE":case"CONTEXT_SAVE_ALL":return s;case"CONTEXT_EXPORT_ALL":return i;case"CONTEXT_EXPORT":return i&&this.getSelectedItems().length>0;case"CONTEXT_DELETE":return n;case"CONTEXT_EXPAND_ALL":case"CONTEXT_COLLAPSE_ALL":return!0;default:return!1}}else switch(e.action){case"CONTEXT_EXPAND_ALL":case"CONTEXT_COLLAPSE_ALL":return!0;default:return!1}};_getMenuState=e=>{const t=e?.pageItem?.page,n=this._getStackableSelectedNodes(),s=Boolean(e&&this._isInTrashFolder(e));return{hostname:t?(0,Tde.q)(t):"",selectedCount:n.length,isInTrashFolder:s}};onContextMenu=e=>{this.refTreeList.current?.onContextMenu(e)};_handleMouseEnter=e=>{e&&c.Z.setStatus(this.context.vivaldiWindowId,je.jk.getHoverUrl(e))};_handleMouseLeave=()=>{c.Z.clearStatus(this.context.vivaldiWindowId)};getRowComponentProps=e=>({...e,showBadge:this.props.prefValues[$.kPanelsShowFolderBadge]});getDisplayTitle=e=>{switch(e.type){case"window":return`${(0,Oe.Z)("title","Window")} - ${e.title}`;case"workspace":return`${(0,Oe.Z)("title","Workspace")} - ${e.title}`;default:return e.title}};getFolderShape=(e,t)=>{switch(e.type){case"pinned":return"pinned";case"stack":return"stack";case"syncFolder":return"sync";case"syncDevice":case"syncWindow":return"folder";case"trash":return"trash";case"workspace":if(t?.emoji)return"emoji";if(t?.icon)return"workspace"}return"folder"};getFolderIconUrl=e=>{if(e){if(e.emoji)return e.emoji;if(e.icon)return e.icon}return""};rowComponent=e=>{const t=e.node,n=e.level,s=(n+1)*mo,i=n*mo,o=this._isInPinnedFolder(t)&&!this.props.prefValues[$.kPanelsWindowShowPinnedGroup],a=this._isUnread(t),r=Boolean(t.pageItem?.discarded)&&this.props.prefValues[$.kTabsDimHibernated],l=this.props.prefValues[$.kTabsShowCloseButton]&&!this._isInPinnedFolder(t)&&!this._isInTrashFolder(t)&&!this._isInSyncFolder(t)&&"window"!==t.type&&"workspace"!==t.type,c=!l&&this._isInTrashFolder(t),h=t.pageItem?.page&&q8.Z.getState().get(t.pageItem.page.id)||(0,te.l4)(),p=0===h.size||r;let u=0;this._hasChildren(t)&&(u="window"===t.type||"workspace"===t.type?ie.ZP.getPages(t.wid,{workspaceId:t.workspaceId}).size:this._getChildren(t).length);const g=this._isFolder(t)||o?{url:"",loadType:"faviconFromCache"}:function(e){return{url:e.pageItem?.faviconUrl||e.syncItem?.faviconUrl||e.trashItem?.tab?.faviconUrl||"",loadType:e.pageItem?.loadType||e.syncItem?.loadType||e.trashItem?.tab?.loadType||"faviconFromCache"}}(t),m="workspace"===t.type?Kj.Z.getWorkspaceById(this.context.vivaldiWindowId,t.workspaceId):void 0;return[Ede("label",{onMouseEnter:()=>this._handleMouseEnter(t.pageItem?.url||t.syncItem?.url||t.trashItem?.tab?.url),onMouseLeave:this._handleMouseLeave,title:t.url},"window__panel__"+t.id,this._hasChildren(t)&&Ede("span",{className:"expand-icon",style:{marginLeft:i},onClick:to.ZP,onMouseDown:to.ZP,onMouseUp:e=>this._handleExpandClick(e,t.id),dangerouslySetInnerHTML:{__html:Ts.nfH}}),!p&&!this._isFolder(t)&&Ede("span",{className:"tab-audio",onClick:h.has("pip")?()=>d.ZP.exitPictureInPicture(t.pageItem.page.id):()=>this._setMediaState(h.has("muting")?"playing":"muting",t)},void 0,Ede(Qo,{animated:this.props.prefValues[$.kThemeUseAnimation],mediaState:h,src:"tab"})),this._isFolder(t)&&Ede(Ale,{leftMargin:this._hasChildren(t)?0:s,shape:this.getFolderShape(t,m),url:this.getFolderIconUrl(m)}),!this._isFolder(t)&&!o&&(0,fs.jsx)(fs.Fragment,{children:g.url.startsWith("<svg")?Ede("span",{className:"svg-icon",style:p?{marginLeft:s}:void 0,dangerouslySetInnerHTML:{__html:g.url}}):(0,fs.jsx)(Ss,{...g,className:As()({discarded:r}),style:p?{marginLeft:s}:void 0})}),o&&Ede("svg",{width:"16",height:"16",viewBox:"0 0 16 16",className:"pinned-icon",style:p?{marginLeft:s}:null},void 0,xde),void 0!==e.inlineEditText&&Ede("input",{type:"text",value:e.inlineEditText,onChange:e.onChange,onFocus:e.onFocus,onBlur:e.onBlur,autoFocus:!0}),void 0===e.inlineEditText&&Ede("span",{className:As()({title:!0,active:t.pageItem?.active,unread:a})},void 0,this.getDisplayTitle(t)),e.showBadge&&this._hasChildren(t)&&Ede("span",{className:"item-count"},void 0,u),l&&Ede("span",{className:"close",title:(0,Oe.Z)("Close"),tabIndex:"-1",onClick:()=>this._closeWithId(t.id),dangerouslySetInnerHTML:{__html:Ts.vyJ}}),c&&Ede("span",{className:"close",title:(0,Oe.Z)("verb","Delete"),tabIndex:"-1",onClick:()=>this._deleteWithId(t.id),dangerouslySetInnerHTML:{__html:Ts.vyJ}}))]};menu={name:"windowlist",getCapability:this._getMenuCapability,getVisibility:this._getMenuVisibility,getState:this._getMenuState};render(){const e=this.state.nodes[0];return e&&this._getChildren(e).find((e=>"syncDevice"===e.type&&this._hasSyncChildren(e)||"syncWindow"===e.type&&this._hasSyncChildren(e)||"tab"===e.type||"stack"===e.type||"pinned"===e.type&&this._getChildren(e).length>0))?(0,fs.jsx)(yo,{ref:this.refTreeList,settings:"WINDOWS_PANEL",rowComponent:this.rowComponent,getRowComponentProps:this.getRowComponentProps,nodes:this.state.nodes,folderMode:"expand",hasChildren:this._hasChildren,isFolder:this._isFolder,supportsInlineEdit:!0,isValidToEdit:this._validateForEdit,getTitle:this._getTitle,saveTitle:this._setTitle,onItemClick:this._onNodeClick,onItemDoubleClick:this._onNodeDoubleClick,onItemMouseDown:this._onNodeMouseDown,onItemMouseUp:this._onNodeMouseUp,onItemsActivated:this.handleNodesActivated,delete:this._closeByIds,onExport:this._saveSessionByIds,onSave:this._saveBookmarkByIds,onDrop:this._onDrop,onMove:this._onMove,onCopy:this._onCopy,validateForDeletion:this._isValidToDelete,menu:this.menu,mimeType:Dde,validateForDrag:this._validateForDrag,getDropSupport:this._getDropSupport,getTargetSpec:this._getTargetSpec,getDragData:this._getDragData,setCustomDragData:this._setCustomDragData,supportsDeepCopy:!1,sorting:this.props.sorting}):this.props.filter?Ede("p",{},void 0,(0,Oe.Z)("Nothing found")):null}}const Lde=sa(Ode,_de);var Rde,Bde=n(34155);function Fde(e,t,n,s){Rde||(Rde="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Rde,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Vde=[{text:"",value:"title",fullScreenTitle:(0,Oe.Z)("Sort by Title")},{text:"",value:"pageItem.hostname",fullScreenTitle:(0,Oe.Z)("Sort by Host")},{text:"",value:"pageItem.domain",fullScreenTitle:(0,Oe.Z)("Sort by Domain")},{text:"",value:"sound",fullScreenTitle:(0,Oe.Z)("Sort by Audio Status")}],Wde=[$.kKeyboardTabToAll,$.kPanelsWindowSorting];class Ude extends hs.PureComponent{refTree=hs.createRef();static contextType=xi.Z;nodeRef=hs.createRef();constructor(e){super(e);const t=this.props.prefValues[$.kPanelsWindowSorting];this.state={filter:"",sorting:{sortOrder:t.sortOrder,sortField:t.sortField,comparator:this.sortComparator}}}componentDidMount(){ud.ZP.addListener(this.onPanelStoreChange)}componentWillUnmount(){ud.ZP.removeListener(this.onPanelStoreChange)}componentDidUpdate(e,t){!e.open&&this.props.open&&Bde.nextTick((()=>this.focusTree()))}onPanelStoreChange=()=>{const e=ud.ZP.getWindowData(this.context.vivaldiWindowId),t=ud.ZP.getChangeReason();this.props.open&&e?.focusContent&&"setFocus"===t&&!sl(this.context.document,this.nodeRef.current)&&this.focusTree()};onSortChange=(e,t)=>{this.setState((n=>({sorting:{sortOrder:e,sortField:t,comparator:n.sorting.comparator}}))),Ne.Z.set($.kPanelsWindowSorting,{sortOrder:e,sortField:t})};sortComparator=(e,t)=>{if("trash"===e.type)return 1;if("trash"===t.type)return-1;if("pinned"===e.type)return-1;if("pinned"===t.type)return 1;if("stack"===e.type&&"stack"!==t.type)return-1;if("stack"===t.type&&"stack"!==e.type)return 1;const{sortOrder:n,sortField:s}=this.state.sorting;if("sound"===s)return this.sortForSound(e,t,n);return Xi.Z.getDefaultComparator(n,s)(e,t)};sortForSound=(e,t,n)=>{if(n<=Xi.Z.NO_SORTING)return 0;let s="";if(e.pageItem){const{page:t}=e.pageItem;t.discarded||(q8.Z.hasMediaState(t.id,"playing")||q8.Z.hasMediaState(t.id,"muting"))&&(s="playing")}let i="";if(t.pageItem){const{page:e}=t.pageItem;e.discarded||(q8.Z.hasMediaState(e.id,"playing")||q8.Z.hasMediaState(e.id,"muting"))&&(i="playing")}if("playing"===s)return-1;if("playing"===i)return 1;return Xi.Z.getDefaultComparator(n,"title")(e,t)};focusTree=()=>{this.refTree.current?.focusTree()};handleFilterChange=e=>{const t=e.target.value;this.setState({filter:t})};onContextMenu=e=>{this.refTree.current?.onContextMenu(e)};onAddTab=e=>{this.refTree.current?.newTab(this.context.vivaldiWindowId)};onAddWindow=e=>{const t=this.context.vivaldiWindowId;G.ZP.isGuest()?cs.Z.openIncognitoWindow(t):cs.Z.openBrowserWindow(t)};render(){if(!this.props.open)return null;return(0,fs.jsxs)("div",{ref:this.nodeRef,className:"panel",id:"window-panel",children:[Fde("header",{},void 0,Fde(Dm,{title:this.props.title,showCloseButton:this.props.showCloseButton}),Fde("div",{className:"toolbar toolbar-default toolbar-wrap"},void 0,Fde("input",{type:"search",className:"tabsearch",placeholder:(0,Oe.Z)("verb","Search"),value:this.state.filter,onChange:this.handleFilterChange}),Fde("div",{className:"toolbar-group"},void 0,Fde(Fa,{tooltip:(0,Oe.Z)("command","New Tab"),tabIndex:this.props.prefValues[$.kKeyboardTabToAll],onClick:this.onAddTab,image:Ts.md4.small}),Fde(Fa,{tooltip:G.ZP.isGuest()?(0,Oe.Z)("action","New Private Window"):(0,Oe.Z)("action","New Window"),tabIndex:this.props.prefValues[$.kKeyboardTabToAll],onClick:this.onAddWindow,image:Ts.NxY.small})))),Fde(gv,{fields:Vde,onSortChange:this.onSortChange,keyAccess:this.props.keyAccess,sortField:this.state.sorting.sortField,sortOrder:this.state.sorting.sortOrder}),Fde("section",{className:"outerScrollbar",onContextMenu:this.onContextMenu},void 0,(0,fs.jsx)(Lde,{ref:this.refTree,sorting:this.state.sorting,filter:this.state.filter}))]})}}const Hde=sa(Ude,Wde);var zde;function Gde(e,t,n,s){zde||(zde="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:zde,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function $de(e){return{selectedPanel:ud.ZP.getSelected(e),panelWidth:ud.ZP.getWidth(e),barVisible:ud.ZP.getIsBarVisible(e),contentVisible:ud.ZP.getIsContentVisible(e),focusContent:ud.ZP.getFocusContent(e),isMailWindow:G.ZP.isMail(e),regPanels:ud.ZP.getRegPanels(e),webPanels:ud.ZP.getWebPanels(e),changeReason:ud.ZP.getChangeReason()}}function Kde(e,t){const n=e.faviconUrl?e.faviconUrl:e.url;return{id:e.id,title:e.title,faviconUrl:n,faviconUrlValid:!1!==e.faviconUrlValid,hasBeenActive:t,activeUrl:e.activeUrl}}function jde(e){const t=$de(e),n=Yde(t),s=[];return t.webPanels.forEach((e=>{const i=e.id===t.selectedPanel&&!n;s.push(Kde(e,i))})),t.webPanelData=s,t}function Yde(e){const t=(e.panelToggleVisible?ud.fG:0)+(e.barVisible?ud.Pv:0);return e.panelWidth<=t}const Xde=[$.kKeyboardTabToAll,$.kPanelsAsOverlayAutoClose,$.kPanelsAsOverlayEnabled,$.kPanelsLazyLoad,$.kPanelsShowCloseButton,$.kThemeUseAnimation,$.kTabsBarPosition,$.kPanelsWebToolbar,$.kToolbarsPanel,$.kMailDisplayMailPanelViewingMail,$.kMailOpenPanelAutomaticallyViewingMail];class Qde extends hs.PureComponent{static contextType=xi.Z;refPanelsContainer=hs.createRef();refFocusContainer=hs.createRef();nodeRef=hs.createRef();isDraggingOverButton=!1;blockNextBlur=!1;delayTimeout=null;dndTimerId=null;resizingTimeout=null;dropMode={support:!1,copy:!1};panelResource={};constructor(e,t){super(e),this.winId=t.vivaldiWindowId,this.trackContextOnFocus=pee("panel",t),this.panelResource={PanelBookmarks:{title:(0,Oe.Z)("Bookmarks"),panel:Aae},PanelMail:{title:(0,Oe.Z)("Mail"),panel:lM},PanelFeeds:{title:(0,Oe.Z)("Feeds"),panel:lM},PanelContacts:{title:(0,Oe.Z)("Contacts"),panel:Zre},PanelDownloads:{title:(0,Oe.Z)("Downloads"),panel:Ev},PanelNotes:{title:(0,Oe.Z)("Notes"),panel:Jre},PanelHistory:{title:(0,Oe.Z)("History"),panel:Pre},PanelWindow:{title:(0,Oe.Z)("title","Windows"),panel:Hde},PanelCalendar:{title:(0,Oe.Z)("Calendar"),panel:Bae},PanelTasks:{title:(0,Oe.Z)("Tasks"),panel:tde},PanelChat:{title:(0,Oe.Z)("Chat"),panel:ZF},PanelTranslate:{title:(0,Oe.Z)("title","Translate"),panel:vde},PanelReadingList:{title:(0,Oe.Z)("Reading List"),panel:cle},PanelSession:{title:(0,Oe.Z)("Sessions"),panel:zle}},this.state={isResizing:!1,panelToggleVisible:G.ZP.getVisibleUI(this.winId).panelToggle,webPanelData:[],minimized:ud.ZP.getIsBarVisible(this.winId)&&!ud.ZP.getIsContentVisible(this.winId)?"buttons":"auto",...jde(this.winId)}}componentDidMount(){const{selectWindow:e}=this.context;this.context.addEventListener("resize",this.onWindowResize,!1),ud.ZP.addListener(this._onPanelStoreChange),G.ZP.addListener(this._onWindowStoreChanged,e),tl.Z.addListener("COMMAND_FOCUS_PANELBAR",this.onCommandSpy),this._onPanelStoreChange()}componentWillUnmount(){this.context.addEventListener("resize",this.onWindowResize,!1),ud.ZP.removeListener(this._onPanelStoreChange),G.ZP.removeListener(this._onWindowStoreChanged),tl.Z.removeListener("COMMAND_FOCUS_PANELBAR",this.onCommandSpy),this.clearDndTimer(),clearTimeout(this.resizingTimeout)}getNode(){return this.refFocusContainer.current}onWindowResize=()=>{this.state.panelWidth<=Vp.E||(this.setState({isResizing:!0}),clearTimeout(this.resizingTimeout),this.resizingTimeout=setTimeout((()=>{this.setState({isResizing:!1}),this.state.selectedPanel&&Pn.Z.setWidth(this.winId,this.state.selectedPanel,this.limitPanelWidth(this.state.panelWidth))}),1e3))};_onPanelStoreChange=()=>{const e=$de(this.winId),{selectedPanel:t,contentVisible:n=!1,regPanels:s,webPanels:i,focusContent:o=!1,barVisible:a=!1,panelWidth:r,isMailWindow:l,changeReason:d}=e,c=i.length===this.state.webPanelData.length&&t===this.state.selectedPanel&&Yde(this.state)===Yde(e)?void 0:e.selectedPanel,h=this.setupWebPanelData(i,c);this.setState((e=>{let{minimized:c,isResizing:p}=e;!n&&r<=ud.fG?c="auto":!n&&r<=ud.Pv+ud.fG&&(c="buttons");return{panelWidth:p?e.panelWidth:r,webPanelData:h,minimized:c,selectedPanel:t,regPanels:s,webPanels:i,contentVisible:n,focusContent:o,barVisible:a,isMailWindow:l,isResizing:p,changeReason:d}}))};_onWindowStoreChanged=()=>{const e=G.ZP.getVisibleUI(this.winId).panelToggle,t=G.ZP.isMail(this.winId);this.state.panelToggleVisible===e&&this.state.isMailWindow===t||this.setState({panelToggleVisible:e,isMailWindow:t,panelWidth:ud.ZP.getWidth(this.winId)})};onCommandSpy=e=>{e===this.winId&&(sl(this.context.document,this.refPanelsContainer.current?.focusRef.current??null)||this.moveFocus("current",!0))};setSelected=e=>{Pn.Z.toggleContent(this.winId,e)};handleDoubleClick=()=>{this.props.prefValues[$.kPanelsAsOverlayEnabled]&&this.props.prefValues[$.kPanelsAsOverlayAutoClose]||this.handlePanelSwitch()};handleClickOutside=()=>{if(!this.state.contentVisible)return;this.autoClosePanel(0);const e=this.refPanelsContainer.current,{document:t,Element:n}=this.context;e instanceof n&&e.contains(t.activeElement)&&Pn.Z.removeFocus(this.winId)};onSlidebarPosition=(e,t)=>{let n;switch(this.props.position){case"left":n=Math.round(e);break;case"right":n=Math.round(this.context.innerWidth-e);break;default:throw new Error("Unknown tabbar position")}this.setState({panelWidth:this.limitPanelWidth(n)})};limitPanelWidth=e=>(0,gb.Z)(e,Vp.E,.618*this.context.innerWidth);handlePanelSwitch=()=>Pn.Z.togglePanel(this.winId);shouldShowCloseButton=e=>this.props.prefValues[$.kPanelsShowCloseButton]&&!((ud.ZP.getSeparateFloating(e,this.winId)||this.props.prefValues[$.kPanelsAsOverlayEnabled])&&this.props.prefValues[$.kPanelsAsOverlayAutoClose]);autoClosePanel=(e=600)=>{const t=!!this.state.selectedPanel&&ud.ZP.getSeparateFloating(this.state.selectedPanel,this.winId);this.props.prefValues[$.kPanelsAsOverlayAutoClose]&&(t||this.props.prefValues[$.kPanelsAsOverlayEnabled])&&(this.cancelTimeout(),this.delayTimeout=setTimeout((()=>{"PanelMail"===this.state.selectedPanel&&!1===ud.ZP.getSeparateFloating("PanelMail",this.winId)&&this.props.prefValues[$.kMailDisplayMailPanelViewingMail]&&(this.props.prefValues[$.kMailOpenPanelAutomaticallyViewingMail]||this.state.contentVisible)||this.state.contentVisible&&Pn.Z.closePanel(this.winId)}),e))};cancelTimeout=()=>clearTimeout(this.delayTimeout);onDialogOpen=()=>{this.props.prefValues[$.kPanelsAsOverlayEnabled]&&this.props.prefValues[$.kPanelsAsOverlayAutoClose]&&this.state.contentVisible&&(this.blockNextBlur=!0)};handleBlur=e=>{const{Element:t}=this.context;this.blockNextBlur||e.target instanceof t&&e.target.classList.contains("home")?(this.blockNextBlur=!1,this.cancelTimeout()):this.autoClosePanel()};getWebPanelDataById=e=>this.state.webPanelData.find((t=>t.id===e));setupWebPanelData=(e,t)=>e.map((e=>{const{faviconUrl:n,url:s,faviconUrlValid:i}=e,o=e.id,a=o===t,r=this.getWebPanelDataById(o);return r?{...r,faviconUrl:n||s,faviconUrlValid:!1!==i,hasBeenActive:!(r.hasBeenActive||!a)||r.hasBeenActive}:Kde(e,a)}));isPanelOpen=e=>this.state.contentVisible&&this.state.selectedPanel===e;clearDndTimer=()=>{this.dndTimerId&&clearTimeout(this.dndTimerId),this.dndTimerId=null};onDragEnterBar=e=>{if(e.preventDefault(),e.stopPropagation(),G.ZP.isGuest())this.dropMode={support:!1,copy:!1};else{const t=e.dataTransfer.types.some((e=>Ds.ZP.isUriListType(e)||"text/plain"===e)),n=t&&!e.dataTransfer.types.some((e=>e===h.Up));this.dropMode={copy:n,support:t}}};onDragOverBar=e=>{e.preventDefault(),this.dropMode.support?(this.clearDndTimer(),this.dropMode.copy,e.dataTransfer.dropEffect=this.dropMode.copy?"copy":"move"):e.dataTransfer.dropEffect="none"};onDropBar=e=>{this.dropMode.support&&Ds.ZP.getUrlsFromEventPromise(e,!0).then((e=>{e.forEach((e=>{Fl.Z.addByUrl(this.winId,e.url,!0)}))}))};onDragLeave=e=>{e.preventDefault(),e.stopPropagation(),this.clearDndTimer(),this.dndTimerId=setTimeout((()=>{this.isDraggingOverButton=!1,this.dndTimerId=null}),h._p)};handleSliderDown=()=>{this.setState({isResizing:!0})};handleSliderUp=()=>{this.setState({isResizing:!1}),this.state.selectedPanel&&Pn.Z.setWidth(this.winId,this.state.selectedPanel,this.state.panelWidth)};handlePanelButtonKeyDown=e=>{switch(e.key){case"ArrowUp":this.moveFocus("left",!1);break;case"ArrowDown":this.moveFocus("right",!1);break;case"Escape":this.leaveBar();break;default:return}e.preventDefault(),e.stopPropagation()};moveFocus=(e,t)=>{const{document:n}=this.context,s=this.refPanelsContainer.current?.focusRef.current??null,i=n.querySelector(".toolbar-panel .uifocusstop");if(!0===t||sl(n,s))if("current"===e)i?.focus();else if("left"===e||"right"===e){const t=Array.from(n.querySelectorAll(".toolbar-panel > *:not(.toolbar-spacer-flexible, .toolbar-spacer, .toolbar-divider)"));if(1===t.length)return;let s=t.indexOf(n.activeElement?.parentElement||i?.parentElement);s="right"===e?s+1>=t.length?0:s+1:s<=0?t.length-1:s-1,t[s].querySelector("input[type=text], input[type=search], button")?.focus()}};leaveBar=()=>{Ae.Z.setPaneFocus(this.winId,!1),v.Z.executeActions("event",this.context,"COMMAND_FOCUS_WEBVIEW")};getBarContextMenu=e=>{const t=this.winId,n=Pi.getOptionFunction(e);return Pi.getNamedMenu(t,e,(async e=>{if("CONTAINER_CLOSED_WEBPANEL"===e.action){const s={...n(t,e,{})};return 0===s.items?.length&&(s.isVisible=()=>!1),s}return{...n(t,e,{})}}))};renderAllPanels=()=>{const e=this.state.selectedPanel&&ud.ZP.getIsWebPanel(this.state.selectedPanel);return(0,fs.jsxs)(fs.Fragment,{children:[this.state.regPanels.map((e=>{const t=e.id,n=this.panelResource[t];if(n)return Gde(fp,{level:"tabs"},"panel-"+t,Gde(n.panel,{keyAccess:this.props.prefValues[$.kKeyboardTabToAll],title:n.title,panelId:t,open:this.isPanelOpen(t),onOpenDialog:this.onDialogOpen,showCloseButton:this.shouldShowCloseButton(t),focusContent:"layout"!==this.state.changeReason}))})).filter(Boolean),Gde("div",{className:e?"webpanel-stack":"webpanel-stack hidden"},void 0,this.state.webPanels.map((e=>{const t=this.getWebPanelDataById(e.id),{prefValues:n}=this.props;if(!n[$.kPanelsLazyLoad]||t?.hasBeenActive)return this.renderWebPanel(e)})))]})};renderWebPanel=e=>{const t=this.state.contentVisible&&this.state.selectedPanel===e.id;return Gde(Sde,{isVisible:t,focusContent:this.state.focusContent&&t,panelUI:this.props.prefValues[$.kPanelsWebToolbar],webPanel:e,showCloseButton:this.shouldShowCloseButton(e.id)},e.id)};renderSlidebar=e=>Gde(lv,{style:e?{left:e}:void 0,onSlidebarPosition:this.onSlidebarPosition,onStart:this.handleSliderDown,onStop:this.handleSliderUp,onDoubleClick:this.handleDoubleClick,offset:1,position:this.props.position});render(){const{barVisible:e,contentVisible:t,panelWidth:n,isResizing:s}=this.state,i=this.props.prefValues,{position:o}=this.props,a=(this.state.panelToggleVisible?ud.fG:0)+(e?ud.Pv:0),r=Yde(this.state),l=i[$.kPanelsAsOverlayEnabled],d=this.state.selectedPanel?ud.ZP.getSeparateFloating(this.state.selectedPanel,this.winId):void 0;let c;c=void 0===d?l:d;const h=As()({[o]:!0,button:this.state.panelToggleVisible,switcher:n<=ud.fG,icons:e&&!t,overlay:c,minimized:c&&"buttons"===this.state.minimized,resizing:s||"layout"===this.state.changeReason}),p="right"===o&&e||"left"===o&&!e?"0 0 0 8 4 4":"4 0 4 8 0 4",u=i[$.kThemeUseAnimation]&&!s&&"layout"!==this.state.changeReason?t?128:64:0,g=n-a+(c?0:1),m=c&&i[$.kPanelsAsOverlayAutoClose]&&t,v="left"===o?2:3,f="left"===o?n-v:-(n-a+v);return(0,fs.jsxs)(da.Z,{focusName:"focus_panel",id:"panels-container",ref:this.refPanelsContainer,className:h,style:{width:c?n-g:n,"--duration":u+"ms",transition:`width ${c?"0ms":"var(--duration)"} ease-out`},children:[(0,fs.jsxs)("div",{id:"panels",ref:this.refFocusContainer,onBlur:m?this.handleBlur:null,onFocus:e=>{this.trackContextOnFocus(e),m&&this.cancelTimeout()},children:[this.state.panelToggleVisible&&Gde("div",{id:"panel_switch",title:e?(0,Oe.Z)("Hide Panel"):(0,Oe.Z)("verb","Show Panel"),onClick:this.handlePanelSwitch},void 0,Gde("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"4px",height:"8px",viewBox:"0 0 4 8"},void 0,Gde("polygon",{points:p}))),Gde("div",{id:"switch",className:"slim-scrollbar",onDragEnter:this.onDragEnterBar,onDragLeave:this.onDragLeave,onDragOver:this.onDragOverBar,onDrop:this.onDropBar,onKeyDown:this.handlePanelButtonKeyDown},void 0,Gde(Rne,{name:$.kToolbarsPanel,className:"toolbar-panel",menuOrigin:"left"===o?"topRight":"topLeft",popupPosition:"left"===o?"right":"left",menu:()=>this.getBarContextMenu("panelbar"),layout:"vertical",size:"medium"})),this.state.selectedPanel&&Gde("div",{className:"panel-group",inert:this.props.editToolbar?"true":null,style:c?{width:r?0:n-a,[o]:a}:null},void 0,Gde("div",{className:"panel-collapse-guard",style:{minWidth:s?"unset":g-1,maxWidth:s?"unset":g-1}},void 0,this.renderAllPanels())),!r&&c&&this.renderSlidebar(f)]}),!r&&!c&&this.renderSlidebar()]})}}const qde=sa((0,ua.Z)(Qde),Xde);var Jde;function ece(e,t,n,s){Jde||(Jde="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Jde,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class tce extends hs.Component{render(){const{domain:e,trackersCount:t}=this.props.blockedData,{columns:n}=this.props;if(n.length<1||!this.props.blockedData)return null;var s=ece("span",{},void 0,e);return n.map((e=>{switch(e.id){case"domain":return ece("label",{},e.id,s);case"trackersCount":return ece("label",{className:"count"},e.id,ece("span",{},void 0,(0,q.uf)(t)));default:return null}}))}}const nce=tce;var sce;function ice(e,t,n,s){sce||(sce="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:sce,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const oce="privacy_stats_domain",ace=[{text:(0,Oe.Z)("Address"),value:"domain",fullScreenTitle:(0,Oe.Z)("Sort by Address"),width:300,visible:!0,key:!0},{text:(0,Oe.Z)("Trackers"),value:"trackersCount",fullScreenTitle:(0,Oe.Z)("Sort by Trackers"),width:90,visible:!0}];class rce extends hs.PureComponent{constructor(e){super(e);const t=io().privacy_stats_domain;this.state={sorting:{sortOrder:1,sortField:"manually"},columns:t||oo(ace)}}onSortChange=(e,t)=>{this.setState({sorting:{sortOrder:e,sortField:t}})};onUpdateRow=e=>{this.setState({columns:e})};onSaveRow=()=>so(this.state.columns,oce);getRowComponentProps=e=>({columns:this.state.columns,blockedData:e.node});render(){const{columns:e,sorting:t}=this.state,{blockedData:n}=this.props,s=n.blocked_domains.tracking.reduce(((e,t)=>(e.push({domain:t.domain,trackersCount:t.blocked_count}),e)),[]).sort(((e,t)=>e.trackersCount>t.trackersCount?-1:1));return(0,fs.jsxs)(fs.Fragment,{children:[ice(gv,{fields:ace,fullsize:!0,columns:e,keyAccess:0,manualSorting:!1,sortField:t.sortField,sortOrder:t.sortOrder,onSortChange:this.onSortChange,onSaveRow:this.onSaveRow,onUpdateRow:this.onUpdateRow}),Array.isArray(s)&&s.length&&ice(yo,{rowComponent:nce,getRowComponentProps:this.getRowComponentProps,nodes:s,enableDragAndDrop:!1,isFolder:xE.Z,disableClipboard:!0,hasChildren:xE.Z,sorting:t,columns:e,multiSelect:!1,onItemDoubleClick:Aa.Z})]})}}const lce=rce;var dce;function cce(e,t,n,s){dce||(dce="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:dce,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class hce extends hs.Component{render(){const{domain:e,adsCount:t,trackersCount:n}=this.props.blockedData,{columns:s}=this.props;if(s.length<1||!this.props.blockedData)return null;var i=cce("span",{},void 0,e);return s.map((e=>{switch(e.id){case"domain":return cce("label",{},e.id,i);case"trackersCount":return cce("label",{className:"count"},e.id,cce("span",{},void 0,(0,q.uf)(n)));case"adsCount":return cce("label",{className:"count"},e.id,cce("span",{},void 0,(0,q.uf)(t)));default:return null}}))}}const pce=hce;var uce;function gce(e,t,n,s){uce||(uce="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:uce,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const mce="privacy_stats_origin",vce=[{text:(0,Oe.Z)("Address"),value:"domain",fullScreenTitle:(0,Oe.Z)("Sort by Address"),width:300,visible:!0,key:!0},{text:(0,Oe.Z)("Trackers"),value:"trackersCount",fullScreenTitle:(0,Oe.Z)("Sort by Trackers"),width:90,visible:!0},{text:(0,Oe.Z)("Ads"),value:"adsCount",fullScreenTitle:(0,Oe.Z)("Sort by Ads"),width:90,visible:!0}];class fce extends hs.PureComponent{constructor(e){super(e);const t=io().privacy_stats_origin;this.state={sorting:{sortOrder:1,sortField:"manually"},columns:t||oo(vce)}}getFormattedData=()=>{const{blockedData:e}=this.props,t=e.blocked_for_origin.ad_blocking.reduce(((e,t)=>(e.push({domain:t.domain,adsCount:t.blocked_count,trackersCount:0}),e)),[]);return e.blocked_for_origin.tracking.reduce(((e,n)=>{if(t.find((e=>e.domain===n.domain))){const t=e.findIndex((e=>e.domain===n.domain));e[t].trackersCount=n.blocked_count}else e.push({domain:n.domain,adsCount:0,trackersCount:n.blocked_count});return e}),t).sort(((e,t)=>e.adsCount+e.trackersCount>t.adsCount+t.trackersCount?-1:1))};onSortChange=(e,t)=>{this.setState({sorting:{sortOrder:e,sortField:t}})};onUpdateRow=e=>this.setState({columns:e});onSaveRow=()=>so(this.state.columns,mce);getRowComponentProps=e=>({columns:this.state.columns,blockedData:e.node});render(){const{columns:e,sorting:t}=this.state,n=this.getFormattedData();return(0,fs.jsxs)(fs.Fragment,{children:[gce(gv,{fields:vce,fullsize:!0,columns:e,keyAccess:0,manualSorting:!1,sortField:t.sortField,sortOrder:t.sortOrder,onSortChange:this.onSortChange,onSaveRow:this.onSaveRow,onUpdateRow:this.onUpdateRow}),Array.isArray(n)&&n.length&&gce(yo,{rowComponent:pce,getRowComponentProps:this.getRowComponentProps,nodes:n,enableDragAndDrop:!1,isFolder:xE.Z,disableClipboard:!0,hasChildren:xE.Z,sorting:t,columns:e,multiSelect:!1,onItemDoubleClick:Aa.Z})]})}}const yce=fce;var Cce;function wce(e,t,n,s){Cce||(Cce="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Cce,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const bce=["tracking","ad_blocking"];var Sce=wce(jo,{type:"blocker-shield",size:40,className:"Blocker-Shield-Trackers Modal-Shield"}),Ice=wce(jo,{type:"blocker-shield",size:40,className:"Blocker-Shield-Ads Modal-Shield"});class kce extends hs.PureComponent{static contextType=xi.Z;isMounted=!1;websiteId=crypto.randomUUID();trackerId=crypto.randomUUID();constructor(e){super(e),this.state={totalAdBlocked:0,totalTrackerBlocked:0,blockedData:{blocked_domains:{tracking:[],ad_blocking:[]},blocked_for_origin:{tracking:[],ad_blocking:[]}},originDomainData:{domain:"",adsCount:0,trackersCount:0},currentTabId:this.websiteId,startBlockingDate:0,trackerBlockingEnabled:!1,adBlockingEnabled:!1}}componentDidMount(){C.Z.contentBlocking.getBlockedCounters(this.handleBlockedCounter),this.getRules(),this.isMounted=!0}handleCloseModal=()=>{this.props.onClose()};handleBlockedCounter=(e,t)=>{if(!t||!t.blocked_for_origin)return;const n=t.blocked_for_origin.ad_blocking.reduce(((e,t)=>e+t.blocked_count),0),s=t.blocked_for_origin.tracking.reduce(((e,t)=>e+t.blocked_count),0);this.setState({totalAdBlocked:n,totalTrackerBlocked:s,blockedData:t,startBlockingDate:e})};clearBlockedData=()=>{C.Z.contentBlocking.clearBlockedCounters(),this.setState({totalAdBlocked:0,totalTrackerBlocked:0,blockedData:{blocked_domains:{tracking:[],ad_blocking:[]},blocked_for_origin:{tracking:[],ad_blocking:[]}},startBlockingDate:0})};setDefaultBlocking=e=>{const{value:t}=e.target;switch(t){case"0":C.Z.contentBlocking.setActiveExceptionsList("tracking","process_list"),C.Z.contentBlocking.setActiveExceptionsList("ad_blocking","process_list");break;case"1":C.Z.contentBlocking.setActiveExceptionsList("tracking","exempt_list"),C.Z.contentBlocking.setActiveExceptionsList("ad_blocking","process_list");break;case"2":C.Z.contentBlocking.setActiveExceptionsList("tracking","exempt_list"),C.Z.contentBlocking.setActiveExceptionsList("ad_blocking","exempt_list")}this.getRules()};getRules=()=>bce.forEach((e=>(0,mS.pg)(e,(e=>{this.setState(e)}))));render(){if(!this.isMounted)return null;const{startBlockingDate:e,totalTrackerBlocked:t,totalAdBlocked:n,currentTabId:s,blockedData:i,trackerBlockingEnabled:o,adBlockingEnabled:a}=this.state,r=0+(o?1:0)+(a?1:0);return wce(_r.Z,{viewMode:"slide Privacy-Stats-Modal",onRequestClose:this.handleCloseModal},void 0,wce("header",{className:"dialog-header"},void 0,wce("h1",{},void 0,(0,Oe.Z)("Privacy Statistics")),wce("p",{},void 0,e?(0,Oe.Z)("Trackers and ads blocked since: $1",[N()(e).format("LLL")]):(0,Oe.Z)("Nothing has been blocked yet. Please select an appropriate blocking level below."))),wce("div",{className:"dialog-content"},void 0,wce("div",{className:"Blocked-Stats-Container"},void 0,wce("div",{className:"Blocked-Stats"},void 0,Sce,wce("div",{},void 0,wce("p",{className:"Number-Blocked"},void 0,(0,q.uf)(t)),wce("p",{},void 0,(0,Oe.Z)("Tracker prevented from profiling you","Trackers prevented from profiling you",[t])))),wce("div",{className:"Blocked-Stats"},void 0,Ice,wce("div",{},void 0,wce("p",{className:"Number-Blocked"},void 0,(0,q.uf)(n)),wce("p",{},void 0,(0,Oe.Z)("Ad blocked","Ads blocked",[n]))))),(t>0||n>0)&&wce(lH,{className:"Privacy-Stats-Board",activeTabId:s,onTabClick:e=>this.setState({currentTabId:e})},void 0,wce("div",{label:(0,Oe.Z)("Websites"),id:this.websiteId},void 0,wce(yce,{blockedData:i})),wce("div",{label:(0,Oe.Z)("Trackers"),id:this.trackerId},void 0,wce(lce,{blockedData:i}))),wce("div",{className:"Blocking-Level"},void 0,wce("h3",{},void 0,(0,Oe.Z)("Blocking Level:")),wce("select",{className:"Blocking-Level-Select",value:r,onChange:this.setDefaultBlocking,title:(0,Oe.Z)("Select default level of protection.")},void 0,wce("option",{value:0},void 0,(0,Oe.Z)("No Blocking")),wce("option",{value:1},void 0,(0,Oe.Z)("Block Trackers")),wce("option",{value:2},void 0,(0,Oe.Z)("Block Trackers and Ads"))))),wce("footer",{className:"dialog-footer"},void 0,wce("button",{className:"privacy-btn-icon",title:(0,Oe.Z)("Privacy Settings"),dangerouslySetInnerHTML:{__html:Ts.sgm.medium+(0,Oe.Z)("Privacy Settings")},onClick:()=>{Ae.Z.showSettings(this.context.vivaldiWindowId,"privacy"),this.handleCloseModal()}}),wce("input",{type:"button",className:"danger",value:(0,Oe.Z)("Reset Statistics"),onClick:this.clearBlockedData}),wce("input",{type:"button",value:(0,Oe.Z)("Close"),onClick:()=>this.handleCloseModal()})))}}const Ace=kce;var Tce;function Zce(e,t,n,s){Tce||(Tce="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Tce,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ece=[$.kRazerChromaHasShownPromotion],_ce={width:400,minWidth:"unset"};class Mce extends hs.Component{static contextType=xi.Z;constructor(e){super(e)}onClose=()=>{Ne.Z.set($.kRazerChromaHasShownPromotion,!0),this.props.onClose()};openSettings=()=>{Ae.Z.showSettings(this.context.vivaldiWindowId,"themes"),this.onClose()};render(){return Zce(_r.Z,{onRequestClose:Aa.Z,style:_ce,viewMode:"slide"},void 0,Zce("header",{className:"dialog-header"},void 0,Zce("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("Razer Chroma device detected."))),Zce("div",{className:"dialog-content"},void 0,Zce("p",{},void 0,(0,Oe.Z)("Vivaldi supports connected Razer Chroma devices. You can enable them with Vivaldi from the Themes section in settings."))),Zce("footer",{className:"dialog-footer"},void 0,Zce("input",{type:"submit",value:(0,Oe.Z)("Go to Theme Settings"),onClick:this.openSettings,autoFocus:!0}),Zce("input",{type:"button",value:(0,Oe.Z)("Close"),onClick:this.onClose})))}}const Nce=sa(Mce,Ece);var Pce;function Dce(e,t,n,s){Pce||(Pce="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Pce,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const xce=Ne.Z.getEventHandler,Oce=[$.kSessionsSaveAllWorkspaces];class Lce extends hs.Component{static contextType=xi.Z;state={shown:!0,name:void 0===this.props.options.updateId?"":nae.ZP.getTitle(this.props.options.updateId),errorSaving:!1,saveOnlyCurrentWindow:!1};_getSaveByIds=()=>"ids"===this.props.options.mode&&Boolean(this.props.options.ids?.length);_close=()=>{this.state.shown&&this.setState((e=>({shown:!1})),(()=>{this.props.options.onClose&&this.props.options.onClose(0),this.props.onClose()}))};_onSaveSession=async()=>{const e=this.state.saveOnlyCurrentWindow?this.context.vivaldiWindowId:0;let t=[];switch((()=>this._getSaveByIds()?"ids":this.props.prefValues[$.kSessionsSaveAllWorkspaces]?"all":"visible")()){case"ids":t=this.props.options.ids??[];break;case"visible":(()=>{const e=new Map;return G.ZP.getIds("normal").forEach((t=>{e.set(t,G.ZP.getActiveWorkspace(t))})),e})().forEach(((n,s)=>{0!==e&&e!==s||(n?t.push(...ie.ZP.getWorkspacePages(n).map((e=>e.id)).toArray()):t.push(...ie.ZP.getPages(s,{workspaceId:void 0}).map((e=>e.id)).toArray()))}))}const n=void 0===this.props.options.updateId?await Kn.Z.add(this.state.name,this.props.options.parentId??-1,this.props.options.index??-1,this.props.options.owner??"",e,t):await Kn.Z.update(this.props.options.updateId,e,t);0===n?(this.props.options.onClose&&this.props.options.onClose(n),this.props.onClose()):this.setState({errorSaving:!0})};_nameChange=e=>{this.setState({name:e.target.value})};_toggleSaveOnlyCurrentWindow=()=>{this.setState((e=>({saveOnlyCurrentWindow:!e.saveOnlyCurrentWindow})))};render(){const e=this.state.errorSaving?(0,Oe.Z)("Error saving the session."):"",t=void 0!==this.props.options.updateId,n=t?(0,Oe.Z)("Update Session"):this._getSaveByIds()?(0,Oe.Z)("session","Save Selected Tabs as Session"):(0,Oe.Z)("session","Save Open Tabs as Session");return Dce(_r.Z,{onRequestClose:this._close},void 0,Dce("div",{className:"save-session"},void 0,Dce("header",{className:"dialog-header"},void 0,Dce("h1",{className:"dialog-title"},void 0,n)),Dce("form",{},void 0,Dce("div",{className:"dialog-content session-dialog"},void 0,Dce("input",{type:"text",placeholder:(0,Oe.Z)("Session Name"),value:this.state.name,onChange:this._nameChange,spellCheck:"false",readOnly:t,autoFocus:!t}),!this._getSaveByIds()&&Dce("label",{className:"dialog-checkbox"},void 0,Dce("input",{type:"checkbox",checked:this.props.prefValues[$.kSessionsSaveAllWorkspaces],onChange:xce($.kSessionsSaveAllWorkspaces)}),Dce("span",{},void 0,(0,Oe.Z)("Include All Workspaces"))),!this._getSaveByIds()&&Dce("label",{className:"dialog-checkbox"},void 0,Dce("input",{type:"checkbox",checked:this.state.saveOnlyCurrentWindow,disabled:this.props.prefValues[$.kSessionsSaveAllWorkspaces],onChange:this._toggleSaveOnlyCurrentWindow}),Dce("span",{},void 0,(0,Oe.Z)("Save Only Tabs In Current Window"))),""!==e&&Dce("div",{className:"error-validation"},void 0,e)),Dce("footer",{className:"dialog-footer"},void 0,Dce("input",{type:"submit",className:"primary",onClick:this._onSaveSession,value:(0,Oe.Z)("Save"),autoFocus:t}),Dce("input",{type:"button",onClick:this._close,value:(0,Oe.Z)("Cancel")})))))}}const Rce=sa(Lce,Oce);var Bce;function Fce(e,t,n,s){Bce||(Bce="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Bce,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Vce extends hs.Component{handleClick=()=>{this.props.onClose()};render(){return Fce(_r.Z,{onRequestClose:Aa.Z,viewMode:"default-browser",asToolbar:!0},void 0,Fce(fY,{onClose:this.handleClick}))}}const Wce=Vce;var Uce;function Hce(e,t,n,s){Uce||(Uce="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Uce,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const zce={width:400,minWidth:"unset"};class Gce extends hs.Component{static contextType=xi.Z;state={visible:!1};componentDidMount(){TX.addListener(this.onStoreChange),Jn.Z.addListener(this.onStoreChange),C.Z.utilities.onSharedDataUpdated.addListener(this.onSharedDataChanged),this.onStoreChange()}componentWillUnmount(){TX.removeListener(this.onStoreChange),Jn.Z.removeListener(this.onStoreChange)}onSharedDataChanged=(e,t)=>{"syncErrorReport"===e&&"reported"===t&&this.setState({visible:!1})};onStoreChange=()=>{const e=(0,Jn.O)(Jn.Z.getState()),t=TX.getState().engineData;(t.isFirstSetupComplete||"disable_sync_on_client"===t.protocolErrorClientAction)&&("credentialsMissing"===e||"loginFailed"===e||"started"===t.engineState&&t.needsDecryptionPassword||"failed"===t.engineState||"disable_sync_on_client"===t.protocolErrorClientAction?C.Z.utilities.getSharedData({key:"syncErrorReport",value:"canReport"},(e=>{"canReport"===e&&this.setState({visible:!0})})):"loggedIn"!==e||"started"!==t.engineState||t.needsDecryptionPassword||C.Z.utilities.setSharedData({key:"syncErrorReport",value:"canReport"}))};onClose=()=>{C.Z.utilities.setSharedData({key:"syncErrorReport",value:"reported"})};openSettings=()=>{Ae.Z.showSettings(this.context.vivaldiWindowId,"sync"),this.onClose()};render(){return this.state.visible?Hce(_r.Z,{onRequestClose:this.onClose,style:zce,viewMode:"slide"},void 0,Hce("header",{className:"dialog-header"},void 0,Hce("h1",{className:"dialog-title"},void 0,(0,Oe.Z)("Sync Disabled"))),Hce("div",{className:"dialog-content"},void 0,Hce("p",{},void 0,(0,Oe.Z)("An issue caused Vivaldi Sync to stop working. You can find more details in the Sync Settings."))),Hce("footer",{className:"dialog-footer"},void 0,Hce("input",{type:"submit",value:(0,Oe.Z)("Go to Sync Settings"),onClick:this.openSettings,autoFocus:!0}),Hce("input",{type:"button",value:(0,Oe.Z)("Close"),onClick:this.onClose}))):null}}const $ce=Gce;var Kce;function jce(e,t,n,s){Kce||(Kce="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Kce,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Yce="https://vivaldi.com/downloadapp/";class Xce extends hs.PureComponent{static contextType=xi.Z;state={syncedTabs:qn.getDevices(),popupVisible:!1,isLoggedIn:qn.getLoggedIn(),qrImage:""};componentDidMount(){qn.addListener(this._onSyncedTabsStoreChanged)}componentWillUnmount(){qn.removeListener(this._onSyncedTabsStoreChanged)}_onSyncedTabsStoreChanged=()=>{this.setState({syncedTabs:qn.getDevices(),isLoggedIn:qn.getLoggedIn()})};onSignin=()=>{Ae.Z.showSettings(this.context.vivaldiWindowId,"sync"),this.hidePopup()};onRegister=()=>{Ae.Z.showSettings(this.context.vivaldiWindowId,"sync",{view:"register"}),this.hidePopup()};trimTitle=e=>(e.length>70&&(e=e.substring(0,70)+"..."),e);getContextMenuItems=()=>{const e=this.state.syncedTabs.reduce(((e,t)=>e.concat(t.sessions.map((e=>{const n=e.window;if(n?.sessionId){const e=n.sessionId,s=n.tabs||[];return{items:s.map((e=>{if(e.sessionId){const t=e.sessionId;return{mnemonic:!1,url:e.url,handler:()=>ss.openTabs([t]),...ae.Z.makeLabelPair(this.trimTitle(e.title||""))}}})).filter(Boolean).concat([ae.Z.separatorItem,{handler:()=>ss.openWindows([e]),...(0,xs.Z)("Open All")}]),...(0,xs.Z)("Window with $1 Tab on $2","Window with $1 Tabs on $2",[s.length,t.deviceName])}}})))),[]).filter(Boolean);return Promise.resolve(e)};togglePopup=()=>{this.setState((e=>({popupVisible:!e.popupVisible})))};hidePopup=()=>{this.setState({popupVisible:!1})};tabPosToPopupPos=()=>{const{tabPosition:e}=this.props;return"top"===e?"below":"bottom"===e?"above":"right"===e?"left":"right"};getQRCode=()=>{C.Z.utilities.generateQRCode(Yce,"dataurl",(e=>{this.setState({qrImage:e})}))};renderNoTabSynced=()=>(this.getQRCode(),jce("div",{className:"synced-tab-dialog"},void 0,jce("img",{className:"tab-sync-qr-code",src:this.state.qrImage}),jce("h3",{},void 0,(0,Oe.Z)("Tabs from your other devices will show here.")),jce("p",{},void 0,(0,Oe.Z)("Scan the QR code to install Vivaldi on your smartphone.")),jce("input",{type:"button",value:(0,Oe.Z)("Get Vivaldi for Mobile"),onClick:()=>{d.ZP.openURL(this.context.vivaldiWindowId,Yce),this.hidePopup()}})));renderNotLoggedIn=()=>jce("div",{className:"synced-tab-dialog"},void 0,jce("span",{dangerouslySetInnerHTML:{__html:n(71665)}}),jce("p",{},void 0,(0,Oe.Z)("See your tabs from other devices by signing in to Sync.")),jce("div",{className:"toolbar toolbar-wrap toolbar-space toolbar-center"},void 0,jce("input",{type:"button",className:"primary",value:(0,Oe.Z)("Create Account"),onClick:this.onRegister}),jce("input",{type:"button",value:(0,Oe.Z)("Log In"),onClick:this.onSignin})));render(){const{isLoggedIn:e}=this.state;let t=null;return e&&0===this.state.syncedTabs.length?t=this.renderNoTabSynced():e||(t=this.renderNotLoggedIn()),t?jce(Fa,{className:"synced-tabs-button",tooltip:(0,Oe.Z)("Synced Tabs"),image:Ts.ssx.large,onClick:this.togglePopup,hidePopup:this.hidePopup,isPopupVisible:this.state.popupVisible,popupWidth:260,popupPosition:this.tabPosToPopupPos(),popupClassName:"ToolbarButtonPopup-DefaultStyles"},void 0,t):jce(Fa,{className:"synced-tabs-button",tooltip:(0,Oe.Z)("Synced Tabs"),image:Ts.ssx.large,menu:this.getContextMenuItems,menuOrigin:"bottomLeft"})}}const Qce=Xce;class qce extends Ol.Z{dispatchAction(e){switch(e.actionType){case"TAB_SWITCH_BACK_SETTING":this.emitChange({action:"switchTabBackBySetting",winId:e.winId,event:e.event});break;case"TAB_SWITCH_FORWARD_SETTING":this.emitChange({action:"switchTabForwardBySetting",winId:e.winId,event:e.event});break;case"TAB_VIEW_PAGE_SOURCE":this.emitChange({action:"viewPageSource",winId:e.winId});break;case"TAB_STACK_CREATE":this.emitChange({action:"stackCreate",winId:e.winId});break;case"TAB_STACK_DISSOLVE":this.emitChange({action:"stackDissolve",winId:e.winId});break;case"TAB_STACK_REMOVE":this.emitChange({action:"stackRemove",winId:e.winId});break;case"DISBAND_TILE_GROUP":this.emitChange({action:"disbandTileGroup",winId:e.winId});break;case"TAB_STACK_TILE_GRID":this.emitChange({action:"stackTileGrid",winId:e.winId});break;case"TAB_STACK_TILE_HORIZONTAL":this.emitChange({action:"stackTileHorizontal",winId:e.winId});break;case"TAB_STACK_TILE_VERTICAL":this.emitChange({action:"stackTileVertical",winId:e.winId});break;case"TAB_TOGGLE_THUMBNAIL":this.emitChange({action:"tabThumbnail",winId:e.winId});break;case"UNLOAD_DIALOG_CLOSED":this.emitChange({action:"unloadDialogClosed",winId:e.windowId})}}}const Jce=new qce(y.Z);var ehe;function the(e,t,n,s){ehe||(ehe="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:ehe,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const nhe=function({isActive:e,orientation:t="right",onClick:n,style:s,title:i}){const o=["left","up"].includes(t)?"expanded":"closed";return the("div",{className:As()("tab-position","accordion-toggle-arrow",o,{active:e}),style:s,onClick:n,title:i},void 0,the(jo,{type:"folder-arrow",className:t}))};var she;function ihe(e,t,n,s){she||(she="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:she,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class ohe extends hs.PureComponent{_isHorizontal=()=>"top"===this.props.tabPosition||"bottom"===this.props.tabPosition;_handleKeyDown=e=>{switch(e.key){case"ArrowLeft":case"ArrowRight":case"ArrowDown":case"ArrowUp":if(this._isHorizontal()?"ArrowLeft"===e.key||"ArrowRight"===e.key:"ArrowUp"===e.key||"ArrowDown"===e.key){const t="ArrowLeft"===e.key||"ArrowUp"===e.key?"left":"right";this.props.onMoveFocus(this.props.id,t,!1)}break;case"Escape":this.props.onLeaveBar();break;default:return}e.preventDefault(),e.stopPropagation()};handleClick=e=>{this.props.onCreateTab()};render(){return ihe(Fa,{style:this.props.style,className:"newtab",onKeyDown:this._handleKeyDown,onClick:this.handleClick,tooltip:(0,Oe.Z)("Open a New Tab"),image:Ts.Wjz.large})}}const ahe=ohe;var rhe;function lhe(e,t,n,s){rhe||(rhe="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:rhe,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class dhe extends hs.PureComponent{nodeRef=hs.createRef();render(){const{faviconUrl:e,isPrivate:t,progress:n,progressType:s}=this.props,i=Math.round(100*n),o=n<1,a=e.startsWith("<svg");return o&&"spinner"===s?(0,fs.jsx)("span",{ref:this.nodeRef,className:"favicon spinner",dangerouslySetInnerHTML:{__html:Ts.H0I}}):o&&"progress_icon"===s?(0,fs.jsx)("span",{ref:this.nodeRef,className:"favicon progress",style:{"--progressInPercent":i+"%"}}):(0,fs.jsx)("span",{ref:this.nodeRef,className:"favicon jstest-favicon-image "+(a?"svg":""),children:lhe(Ss,{refFavicon:this.props.refFavicon,url:e,loadType:t?"faviconSkipCache":"faviconFromCache"})})}}const che=dhe;var hhe;function phe(e,t,n,s){hhe||(hhe="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:hhe,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function uhe({onClick:e,onMouseDown:t}){const n=(0,Oe.Z)("Close Tab")+"\n"+(0,Oe.Z)("$1 click to close other tabs except this one",[(0,Oe.Z)("key","Alt")]);return phe("button",{className:"close",dangerouslySetInnerHTML:{__html:Ts.kze},onClick:e,onAuxClick:e,onMouseDown:t,title:n})}var ghe;function mhe(e,t,n,s){ghe||(ghe="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:ghe,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class vhe extends hs.Component{render(){const e=this.props.progress;return mhe("progress",{className:As()({"page-progress-indicator":!0,"progress-done":1===e}),value:100*e,max:100})}}const fhe=vhe,yhe=function(e,t,n,s){const i=()=>{e.removeEventListener("mousemove",l),e.removeEventListener("mouseup",c)},o=(e,n,i,a)=>{C.Z.tabsPrivate.onDragEnd.removeListener(o),C.Z.utilities.broadcastMessage({endDragging:!0}),!e&&n&&d.ZP.detachPage((0,te.aV)(t),i,a),s&&s.onDragEnd()},a=n.pageX,r=n.pageY,l=e=>{if(Math.abs(e.pageX-a)>5||Math.abs(e.pageY-r)>5){i();const n=(s?s.element:e.target).getBoundingClientRect(),a=s?s.offsetLeft:0,r=s?s.offsetTop:0,l=s?s.offsetHeight:0,d=s?s.offsetWidth:0;C.Z.utilities.broadcastMessage({startDragging:!0}),C.Z.tabsPrivate.onDragEnd.addListener(o);const[c]=t;C.Z.tabsPrivate.startDrag({windowId:c.windowId,mimeType:h.Up,customData:JSON.stringify({ids:t.map((e=>e.id)),active:(t.find((e=>e.active))||c).id}),url:c.url,title:c.title,posX:n.left+a,posY:n.top+r,width:n.width+d,height:n.height+l,cursorX:10,cursorY:10}),s&&s.onDragStart(t)}},c=()=>{i()};e.addEventListener("mousemove",l),e.addEventListener("mouseup",c)},Che=function(){let e,t,n,s,i;return function(o,a,r,l){const d=(new Date).getTime();o!==e||a!==t?(e=o,t=a,n=d):o===e&&a===t&&o!==s&&a!==i&&n&&d-n>r&&(l(),s=o,i=a,e=t=n=void 0)}},whe=(e,t,n=!0)=>Boolean(t&&e.ctrlKey),bhe=(e,t,n=!0)=>Boolean(t&&e.shiftKey);var She,Ihe=n(34155);function khe(e,t,n,s){She||(She="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:She,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ahe=Che(),The=.15,Zhe=.85;function Ehe(e,t){if(t)return 1;const{trigger:n}=oy.getNavigationInfo(e);switch(n){case"start":return 0;case"stop":return 1;case"commit":case"content":{const t=ZS.getProgressInfo(e);return t?Math.min(Math.max(t.progress,0),1):1}}return 1}var _he=khe("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"3px",className:"svg-tab-selection"},void 0,khe("line",{className:"inner",x1:"0",y1:"0",x2:"100%",y2:"0"}),khe("line",{className:"outer",x1:"0",y1:"0",x2:"100%",y2:"0"})),Mhe=khe("rect",{className:"inner",width:"100%",height:"100%"}),Nhe=khe("rect",{className:"outer",width:"100%",height:"100%"}),Phe=khe("rect",{className:"stack-frame",width:"100%",height:"100%"});class Dhe extends hs.PureComponent{static contextType=xi.Z;#h=!1;refTab=hs.createRef();refFavicon=hs.createRef();constructor(e){super(e),this.indicators={},this.isIMEOpen=!1;const t=je.jk.getDisplayTitleByUrl(e.url,e.title),n=kw(t,e.url,9),s=e.isStack&&!e.isSubstrip?(0,Oe.Z)("Tab stack with $1 tab","Tab stack with $1 tabs",[e.stackSize]):t;this.state={dragOver:"none",awaitingEdit:null,fadeDiscardedTabs:e.prefValues[$.kTabsDimHibernated],loadingProgress:Ehe(e.pageId,e.isInternalPage),timeLeft:void 0,displayTitle:t,titleNumber:n,tabTitle:s}}componentDidMount(){ZS.addListener(this._onProgressStateStoreChanged),this.props.doMonitorAlarms&&oe.Z.ensureAddedListener(this._alarmsChanged),this.#h=!0,this.props.active&&Ihe.nextTick((()=>this._scrollIntoView()))}componentWillUnmount(){this.#h=!1,ZS.removeListener(this._onProgressStateStoreChanged),oe.Z.ensureRemovedListener(this._alarmsChanged)}componentDidUpdate(e){!e.active&&this.props.active&&this._scrollIntoView(),!0===e.active&&!1===this.props.active&&null!==this.state.awaitingEdit&&this.setState({awaitingEdit:null}),!1===e.discarded&&!0===this.props.discarded&&(this.discardedFadeInTimeId&&(clearTimeout(this.discardedFadeInTimeId),delete this.discardedFadeInTimeId),this.props.prefValues[$.kTabsDimHibernated]||(this.discardedFadeInTimeId=setTimeout(this.clearFadedDiscardedTabs,2e3)),this.setState({fadeDiscardedTabs:!0}));const t=e.stackSize!==this.props.stackSize;if(e.url!==this.props.url||e.title!==this.props.title){const e=je.jk.getDisplayTitleByUrl(this.props.url,this.props.title),n=kw(e,this.props.url,9);let s;s=t&&this.props.isStack&&!this.props.isSubstrip?(0,Oe.Z)("Tab stack with $1 tab","Tab stack with $1 tabs",[this.props.stackSize]):e,this.setState({displayTitle:e,titleNumber:n,tabTitle:s})}!e.doMonitorAlarms&&this.props.doMonitorAlarms&&oe.Z.ensureAddedListener(this._alarmsChanged)}_scrollIntoView=()=>{const e=this.refTab.current;if(e){const t=this.isHorizontal();this.context.requestAnimationFrame((function(){t?e.scrollIntoView():e.scrollIntoViewIfNeeded(!0)}))}};_alarmsChanged=e=>{if(!e)return;const t=e.find((e=>e?.id===this.props.extId));if(t)switch(t.type){case"RELOAD":if(this.props.extId===t.id){const e=ie.ZP.getPageByReloadId(t.id);e&&d.ZP.reloadPage(e.id)}break;case"TIME_CHANGED":this.setState({timeLeft:t.remainingTime})}else this.state.timeLeft&&this.setState({timeLeft:null})};_onProgressStateStoreChanged=()=>{this.setState({loadingProgress:Ehe(this.props.pageId,this.props.isInternalPage)})};clearFadedDiscardedTabs=()=>{this.#h&&this.setState({fadeDiscardedTabs:!1})};discardPages=e=>{e.forEach(d.ZP.discardPage)};cloneTab=e=>{d.ZP.clonePages(te.aV.of(e))};cloneTabs=e=>{d.ZP.clonePages(e)};async reloadTabStack(e){const t=ie.ZP.getActivePage(e),n=t?(0,ay.av)(t):null,s=ie.ZP.getGroup(n,e);t&&s.size>1&&await Promise.all(s.map((async e=>{this.reloadTab(e.id)})))}reloadTab=e=>{d.ZP.clearSelection(this.context.vivaldiWindowId),d.ZP.reloadPage(e)};renameTabStack=()=>{const e=this.props.groupId;e&&this.setState({awaitingEdit:e})};toggleMediaRemoting=()=>{const e=this.props.prefValues[$.kMediaRouterMediaRemotingEnabled];Ne.Z.set($.kMediaRouterMediaRemotingEnabled,!e)};setPinned=(e,t)=>{d.ZP.clearSelection(this.context.vivaldiWindowId);const n=this.context.vivaldiWindowId,s=e.map(ay.av).toSet().flatMap((e=>ie.ZP.isGroup(e,n)?ie.ZP.getGroup(e,n):(0,te.aV)())).union(e).toList();t?d.ZP.setPinned(s,t):d.ZP.setPinned(s.reverse(),t)};bookmarkAllOpenPages=()=>{d.ZP.clearSelection(this.context.vivaldiWindowId),g.Z.bookmarkAllOpenPages(this.context.vivaldiWindowId,ps.ZP.getRootNode().id)};bookmarkTab=(e,t)=>{d.ZP.clearSelection(this.context.vivaldiWindowId),g.Z.bookmarkPages(e,t,ps.ZP.getRootNode().id)};handleClose=e=>{const t=ie.ZP.getPageById(this.props.pageId);t&&e.button===Hi.Z.kLeft&&(e.altKey?this.closeAllButTab(t):e.shiftKey||e.ctrlKey||e.metaKey||this.props.closePage(t),e.preventDefault())};closeToLeft=(e,t)=>{d.ZP.closeToLeft(this.context.vivaldiWindowId,e,t)};closeToRight=(e,t)=>{d.ZP.closeToRight(this.context.vivaldiWindowId,e,t)};closeTabStack=()=>{d.ZP.closeTabStack(this.props.pageId)};handleMedia=()=>{if(this.props.mediaState.has("pip"))d.ZP.exitPictureInPicture(this.props.pageId);else{const e=ie.ZP.getPageById(this.props.pageId);e&&this.togglePagesMuted(this.context.vivaldiWindowId,te.aV.of(e))}};togglePagesMuted=(e,t)=>{d.ZP.toggleMuting(e,t)};closeAllButTab=(e,t)=>{const n=!t,s=G.ZP.getActiveWorkspace(this.context.vivaldiWindowId);d.ZP.closeOther(e,s,n)};blockEvent=e=>{e.stopPropagation(),e.preventDefault()};containEvent=e=>{e.stopPropagation()};customize=()=>{Ae.Z.showSettings(this.context.vivaldiWindowId,"tabs")};disolveTabStack=()=>{const e=this.context.vivaldiWindowId;d.ZP.clearSelection(e),d.ZP.expandTabStack(e,this.props.groupId)};isTabstackingEnabled=()=>"off"!==this.props.prefValues[$.kTabsStackingMode];isTabStack=e=>{const t=(0,ay.av)(e);return!!t&&ie.ZP.isGroup(t,this.context.vivaldiWindowId)};isPinned=e=>e.pinned;tileTabStack=()=>{d.ZP.tileTabStack(this.context.vivaldiWindowId,this.props.groupId),d.ZP.clearSelection(this.context.vivaldiWindowId)};isPageTiledWithType=e=>{const t=ie.ZP.getPageById(this.props.pageId);return Boolean(t&&(0,nee.gO)(t)&&this.props.tilingType===e)};tileSelection=e=>{const t=e.count()<4?"row":"grid";d.ZP.tilePages(e.toList(),t),d.ZP.clearSelection(this.context.vivaldiWindowId)};untile=()=>{const e=ie.ZP.getPageInWindow(this.context.vivaldiWindowId,this.props.pageId);e&&d.ZP.untilePages(te.aV.of(e))};untileTabStack=e=>{const t=this.context.vivaldiWindowId,n=ie.ZP.getGroup(e,t);d.ZP.untilePages(n)};untileSelection=async e=>{await d.ZP.untilePages(e);const t=this.context.vivaldiWindowId,n=this.props.tilingId;ie.ZP.getTiles(n,t).size<2&&await d.ZP.untileTileGroup(this.context.vivaldiWindowId,n),d.ZP.clearSelection(this.context.vivaldiWindowId)};untileTileGroup=()=>{d.ZP.untileTileGroup(this.context.vivaldiWindowId,this.props.tilingId),d.ZP.clearSelection(this.context.vivaldiWindowId)};mouseEnterHandler=()=>{this.props.clearForceHover()};indicatorOnDragStart=e=>{this.props.setPageIdsHiddenForDrag((0,te.l4)(e.map((e=>e.id))))};indicatorOnDragEnd=()=>{this.props.setPageIdsHiddenForDrag((0,te.l4)())};onTabIndicatorPress=(e,t,n)=>{n.preventDefault(),n.stopPropagation(),this.props.prefValues[$.kTabsStackingAllowDnd]&&this.onTabIndicatorDragOut(e,t,n)};onTabIndicatorClick=(e,t)=>{t.preventDefault(),t.stopPropagation();const{prefValues:n}=this.props;if(t.button===Hi.Z.kLeft){const s=G.ZP.isActive(this.context.vivaldiWindowId);whe(t,n[$.kTabsSelectionEnabled],s)?d.ZP.setSelection(e,{multiSelect:!1,addGroup:!1}):bhe(t,n[$.kTabsSelectionEnabled],s)?d.ZP.setSelection(e,{multiSelect:!0,addGroup:!1}):(0,qi.Z)(t)||this.props.onActivate(e)}else t.button,Hi.Z.kCenter};onTabIndicatorDragOut=(e,t,n)=>{const s=this.props.getDraggedPages(e);yhe(this.context,s,n,{offsetLeft:2,offsetTop:3,offsetHeight:-6,offsetWidth:-2,onDragStart:this.indicatorOnDragStart,onDragEnd:this.indicatorOnDragEnd,element:this.indicators[t]})};renderTabGroupIndicator=()=>khe("div",{className:"tab-group-indicator"},void 0,ie.ZP.getGroup(this.props.groupId,this.context.vivaldiWindowId).map((e=>{const t=As()("tab-indicator",{active:this.props.highlightId===e.id,marked:this.props.isSelecting&&this.props.checkSelected(e.id),unread:this.props.prefValues[$.kTabsUnread]&&this.props.isUnread&&e.id!==this.props.highlightId,"hidden-for-drag":this.props.isHiddenForDrag}),n=`stack-${e.id}`;return(0,fs.jsx)("div",{ref:e=>{e&&(this.indicators[n]=e)},className:t,title:je.jk.getDisplayTitle(e),onContextMenu:this.onContextMenu.bind(this,!0),onClick:this.onTabIndicatorClick.bind(this,e),onMouseDown:this.onTabIndicatorPress.bind(this,e,n),children:this.props.isSelecting&&this.props.checkSelected(e.id)&&_he},n)})));keyDown=e=>{if(this.state.awaitingEdit)return;const{prefValues:t}=this.props,{ctrlKey:n,altKey:s,shiftKey:i,metaKey:o}=e,a={ctrlKey:n,altKey:s,shiftKey:i,metaKey:o},r=t[$.kTabsSelectionEnabled];switch(e.key){case"Enter":case" ":const n=ie.ZP.getPageById(this.props.pageId);n&&this.props.onActivate(n);break;case"ArrowLeft":case"ArrowRight":case"ArrowDown":case"ArrowUp":const s=this.isHorizontal();if((0,co.Mr)(a)&&r){const t=ie.ZP.getPageById(this.props.pageId);t&&(("ArrowLeft"===e.key&&s||"ArrowUp"===e.key&&!s)&&d.ZP.expandSelectionPrevious(t),("ArrowRight"===e.key&&s||"ArrowDown"===e.key&&!s)&&d.ZP.expandSelectionNext(t))}if((0,co.S2)(a)){const n="dotted"===t[$.kTabsStackingMode];if(s){if("ArrowLeft"===e.key||"ArrowRight"===e.key){const t=ie.ZP.getPageById(this.props.pageId);t&&(d.ZP.stepPage(t,"ArrowRight"===e.key,n,this.context.vivaldiWindowId),r&&Ihe.nextTick((()=>{d.ZP.setSelection(t,{multiSelect:!1,addGroup:!1,excludeActive:!0})})))}}else if("ArrowUp"===e.key||"ArrowDown"===e.key){const t=ie.ZP.getPageById(this.props.pageId);t&&(d.ZP.stepPage(t,"ArrowDown"===e.key,n,this.context.vivaldiWindowId),r&&Ihe.nextTick((()=>{d.ZP.setSelection(t,{multiSelect:!1,addGroup:!1,excludeActive:!0})})))}}if((0,co.VV)(a)){if(s?"ArrowLeft"===e.key||"ArrowRight"===e.key:"ArrowUp"===e.key||"ArrowDown"===e.key){const t="ArrowLeft"===e.key||"ArrowUp"===e.key?"left":"right";d.ZP.clearSelection(this.context.vivaldiWindowId),Ihe.nextTick((()=>this.props.onMoveFocus(this.props.id,t,!1)))}else if(!this.props.isSubstrip&&this.props.isStack){const e=this.refTab.current,{Element:t}=this.context;e instanceof t&&this.props.onStackMenu(this.props.pageId,e)}}break;case"Escape":d.ZP.clearSelection(this.context.vivaldiWindowId),this.props.onLeaveBar();break;default:return}e.preventDefault(),e.stopPropagation()};createGroup=(e,t)=>{const n=e.sort(((e,t)=>e.index-t.index)),s=t.index-n.findIndex((e=>e===t));d.ZP.createTabStack(n,s,(0,ay.av)(t))};createGroupByHost=(e,t)=>{const n=ie.ZP.getNewGroupId();(0,Ade.ZP)(this.context.vivaldiWindowId,n,t),d.ZP.createTabStack(e,void 0,n)};getGroupsForHosts=e=>{const t=ie.ZP.getPages(this.context.vivaldiWindowId,{workspaceId:e}).filter((e=>!this.isTabStack(e))).filter((e=>!e.pinned));let n=(0,te.aV)();return t.forEach((e=>{let s=!1;if(n.forEach((t=>{if(s=t.contains(e),s)return!1})),!s){const s=(0,Tde.q)(e),i=t.filter((e=>(0,Tde.q)(e)===s));i.size>1&&(n=n.push(i))}})),n};createGroupByHosts=e=>{this.getGroupsForHosts(e).forEach((e=>{this.createGroupByHost(e,(0,Tde.q)(e.first()))}))};isHorizontal=()=>{const{tabPosition:e}=this.props;return"top"===e||"bottom"===e};onContextMenu=(e,t)=>(t.persist(),t.preventDefault(),t.stopPropagation(),this.getContextMenuItemsPromise("tab",e,t).then((e=>{(0,Qi.Z)(this.context,e)(t)})),!1);getContextMenuItemsPromise=(e,t,n)=>{const i=this.context.vivaldiWindowId,o=ie.ZP.getPageById(this.props.pageId);if(!o)return Promise.reject("Tab.jsx: Expected page not found");const a=this.context.vivaldiWindowId,r=G.ZP.getActiveWorkspace(a),{isStack:l,groupId:c,isSubstrip:h,isInsideAccordion:p}=this.props,u=this.props.isSelecting&&this.props.isSelected&&this.props.selectionCount>1,g=ie.ZP.getSelectedPages(a),m=g.filter((e=>ie.ZP.canClosePage(e))),v=ie.ZP.getPages(a).filter((e=>(0,ay.cm)(e)===r&&!g.some((t=>t.id===e.id)))),f=G.ZP.isGuest(),[y,C]=(0,Tde.d)(o,ie.ZP.getWorkspaceTabsInWindow(a,r,!this.isTabstackingEnabled())),w=!o.active&&!o.discarded&&!o.isInspected&&o.url!==ie.ZP.getDefaultStartpage(this.context.vivaldiWindowId),b=l&&ie.ZP.getGroup(c,this.context.vivaldiWindowId).some((e=>!e.active&&!e.discarded&&!e.isInspected&&e.url!==ie.ZP.getDefaultStartpage(this.context.vivaldiWindowId))),S=ie.ZP.getDiscardablePages(a),I=ie.ZP.getPages(a).count(),k=ie.ZP.isGroup(c,this.context.vivaldiWindowId),A=t||!k?I>=2:I-ie.ZP.getGroup(c,this.context.vivaldiWindowId).count()>=1;let T;T=u?g:!t&&l?ie.ZP.getGroup(c,this.context.vivaldiWindowId):te.aV.of(o);const Z={isMultiSelect:u,count:g.size,closableCount:m.size,unSelectedCount:v.size,unpinned:g.count((e=>!this.isPinned(e))),pinned:g.count(this.isPinned),playing:g.count((e=>q8.Z.hasMediaState(e.id,"playing")||q8.Z.hasMediaState(e.id,"muting"))),canHibernateCount:g.count((e=>!e.active&&!e.isInspected)),hostname:y,hostnameCount:C.size,horizontal:this.isHorizontal(),someIncognito:g.some((e=>o.incognito)),canCloneCount:g.count((e=>!(0,je.m7)(e)))},E=Pi.getOptionFunction(e),_=this.props.extId,M=async()=>{const e=[],{document:t,vivaldiWindowId:i}=this.context,r=G.ZP.getState().get(i);for(const[n,h]of G.ZP.getState()){if(n===i||"normal"!==h.type||r?.incognito!==h.incognito)continue;const p=(await s.Z.windows.get(n,{populate:!0})).tabs||[],m=p.find((e=>e.active)),v=m&&m.url?je.jk.getDisplayTitleByUrl(m.url,m.title||m.url):String(e.length+1);e.push({handler:()=>{const e=u?g:l?ie.ZP.getGroup(c,a):te.aV.of(o);e.count()===ie.ZP.getPages(i).count()&&t.querySelectorAll("webview").forEach((e=>e.parentElement?.removeChild(e))),d.ZP.moveToWindow(e,n)},...(0,xs.Z)("Window with $1 Active Tab ($2)","Window with $1 Active Tabs ($2)",[p.length,v])})}return e.length>0&&e.unshift(ae.Z.separatorItem),G.ZP.isIncognitoOrGuest(i)||(e.push(ae.Z.separatorItem),e.push({handler:()=>{T.count()===ie.ZP.getPages(i).count()&&t.querySelectorAll("webview").forEach((e=>e.parentElement?.removeChild(e))),d.ZP.detachPage(T,n.screenX,n.screenY)},...(0,xs.Z)("To New Window")})),e},N=async e=>{const t=[],{vivaldiWindowId:n}=this.context,s=Kj.Z.getWorkspaces(n);if(s.length>0){const e=u?g:l?ie.ZP.getGroup(c,a):te.aV.of(o),n=()=>{const e=ie.ZP.getActivePage(a);e&&(0,ay.cm)(e)===r||d.ZP.cycleByHistory(a)};t.push(ae.Z.separatorItem),r&&t.push({handler:async()=>{await d.ZP.moveToWorkspace(e,void 0),n()},...(0,xs.Z)("To This Window")}),s.forEach((s=>{s.id!==r&&t.push({handler:async()=>{await d.ZP.moveToWorkspace(e,s.id),n()},label:s.name,labelEnglish:s.name})}))}return t};return Pi.getNamedMenu(i,e,(async e=>{const n=this.isPageTiledWithType("selection"),s=this.isPageTiledWithType("group");switch(e.action){case"CONTEXT_NEW":return{handler:()=>this.props.onCreateTab(!u&&k&&c?c:void 0),...E(i,e,Z)};case"CONTEXT_RELOAD":return{handler:u?this.reloadTab.bind(this,g.map((e=>e.id))):this.reloadTab.bind(this,o.id),...E(i,e,Z)};case"CONTEXT_CLONE":return{isVisible:()=>u?!g.every(je.m7):!(0,je.m7)(o),handler:u?()=>d.ZP.clonePages(g):()=>d.ZP.clonePages(te.aV.of(o)),...E(i,e,Z)};case"CONTEXT_PIN":return{handler:()=>{const e=u?g:te.aV.of(o);this.setPinned(e,!0)},isVisible:()=>!(h||p)&&(u?!g.some(this.isTabStack)&&g.every((e=>!this.isPinned(e))):!l&&!o.pinned),...E(i,e,Z)};case"CONTEXT_PIN_STACK":return{handler:()=>{this.setPinned(g,!0)},isVisible:()=>l&&!h&&!o.pinned&&!u,...E(i,e,Z)};case"CONTEXT_UNPIN":return{handler:()=>{const e=u?g:te.aV.of(o);this.setPinned(e,!1)},isVisible:()=>!l&&!h&&!p&&(u?!g.some(this.isTabStack)&&g.some(this.isPinned):o.pinned),...E(i,e,Z)};case"CONTEXT_UNPIN_STACK":return{handler:()=>{const e=u?g:te.aV.of(o);this.setPinned(e,!1)},isVisible:()=>l&&!u&&o.pinned&&!h,...E(i,e,Z)};case"CONTEXT_MUTE":return{handler:u?()=>this.togglePagesMuted(i,g):()=>this.togglePagesMuted(i,te.aV.of(o)),isVisible:()=>!u||g.some((e=>q8.Z.hasMediaState(e.id,"playing")||q8.Z.hasMediaState(e.id,"muting"))),checked:u?g.every((e=>q8.Z.hasMediaState(e.id,"muting"))):q8.Z.hasMediaState(o.id,"muting"),...E(i,e,Z)};case"CONTEXT_CONTAINER_PERIODIC_TIMER":const I=u?"select":l?"stack":"tab",T=u||"tab"===I?_:c;return{items:Cw.Z.getMenu(T,I,o.windowId),isVisible:()=>!this.props.isInternalPage,...E(i,e,Z)};case"CONTEXT_MUTE_OTHER":return{handler:()=>d.ZP.muteAllExcept(i,[o]),isVisible:()=>!u&&ie.ZP.getPages(i).some((e=>e.id!==o.id&&q8.Z.hasMediaState(e.id,"playing"))),...E(i,e,Z)};case"CONTEXT_OPTIMIZE_FS_VIDEOS":return{handler:this.toggleMediaRemoting,type:"checkbox",checked:this.props.prefValues[$.kMediaRouterMediaRemotingEnabled],isVisible:()=>this.props.mediaState.has("capturing"),...E(i,e,Z)};case"CONTEXT_BOOKMARK":return{handler:u?this.bookmarkTab.bind(this,g,!1):this.bookmarkTab.bind(this,o,!1),isVisible:()=>!f,...E(i,e,Z)};case"CONTEXT_BOOKMARK_STACK":return{handler:this.bookmarkTab.bind(this,ie.ZP.getGroup(c,this.context.vivaldiWindowId),!0),isVisible:()=>l&&!f,...E(i,e,Z)};case"CONTEXT_BOOKMARK_ALL":return{handler:this.bookmarkAllOpenPages,isVisible:()=>!f,...E(i,e,Z)};case"CONTEXT_COPY_LINK":return{handler:()=>d.ZP.copyUrls(te.aV.of(o)),isVisible:()=>!u,...E(i,e,Z)};case"CONTEXT_COPY_LINKS":return{handler:()=>{const e=l?ie.ZP.getGroup((0,ay.av)(o),i):g;d.ZP.copyUrls(e)},isVisible:()=>u||l,...E(i,e,Z)};case"CONTEXT_SAVE_SESSION":return{handler:g.count()>0?()=>Ae.Z.showSaveSessionDialog(i,{mode:"ids",ids:g.map((e=>e.id)).toArray()}):()=>Ae.Z.showSaveSessionDialog(i,{mode:"all"}),isVisible:()=>!f,...E(i,e,Z)};case"CONTEXT_TABSTACK_BY_SELECTION":{const t=Z.pinned;return{handler:()=>this.createGroup(g,o),isVisible:()=>u&&this.isTabstackingEnabled()&&this.props.isSelecting&&(0===t||t===g.size)&&!g.some((e=>{const t=(0,ay.av)(e);return t&&ie.ZP.isGroup(t,e.windowId)})),...E(i,e,Z)}}case"CONTEXT_TABSTACK_BY_HOST":return{handler:()=>{this.createGroupByHost(C,y)},isVisible:()=>this.isTabstackingEnabled()&&!l&&C.count()>1,...E(i,e,Z)};case"CONTEXT_TABSTACK_BY_HOSTS":return{handler:()=>this.createGroupByHosts(r),isVisible:()=>this.isTabstackingEnabled()&&!this.getGroupsForHosts(r).isEmpty(),...E(i,e,Z)};case"CONTEXT_TABSTACK_RELOAD":return{handler:()=>this.reloadTabStack(i),isVisible:()=>l,...E(i,e,Z)};case"CONTEXT_TABSTACK_RENAME":return{handler:this.renameTabStack,isVisible:()=>l&&!this.props.isSubstrip&&!this.props.isInsideAccordion,...E(i,e,Z)};case"CONTEXT_TABSTACK_REMOVE_FROM":return{handler:()=>this.props.removeFromTabStack(this.props.pageId),isVisible:()=>t,...E(i,e,Z)};case"CONTEXT_TABSTACK_UNGROUP":return{handler:this.disolveTabStack,isVisible:()=>l,...E(i,e,Z)};case"CONTEXT_TILE_TABSTACK":return{handler:this.tileTabStack,isVisible:()=>l&&!this.props.isSelecting&&!s&&!n,...E(i,e,Z)};case"CONTEXT_UNTILE_TABSTACK":return{handler:()=>this.untileTabStack(c),isVisible:()=>l&&!this.props.isSelecting&&(s||n),...E(i,e,Z)};case"CONTEXT_TILE_TABS":return{handler:this.tileSelection.bind(this,g),isVisible:()=>u&&!n&&this.props.isSelecting&&g.count()>1,...E(i,e,Z)};case"CONTEXT_UNTILE_TAB":return{handler:this.untile,isVisible:()=>!this.props.isSelecting&&n&&!l,...E(i,e,Z)};case"CONTEXT_UNTILE_TABS":return{handler:this.untileTileGroup,isVisible:()=>!this.props.isSelecting&&n,...E(i,e,Z)};case"CONTEXT_UNTILE_SELECTION":return{handler:()=>this.untileSelection(g),isVisible:()=>this.props.isSelecting&&n&&!l,...E(i,e,Z)};case"CONTEXT_HIBERNATE_TAB":return{handler:this.discardPages.bind(this,te.aV.of(o)),isVisible:()=>!u&&w&&(this.props.isSubstrip||!l),...E(i,e,Z)};case"CONTEXT_HIBERNATE_SELECTED_BACKGROUND_TABS":return{handler:this.discardPages.bind(this,g.filter((e=>!e.active))),isVisible:()=>Boolean(g.filter((e=>S.find((t=>t.id===e.id)))).count()),...E(i,e,Z)};case"CONTEXT_HIBERNATE_TABSTACK":return{handler:this.discardPages.bind(this,ie.ZP.getGroup(c,this.context.vivaldiWindowId).filter((e=>!e.active))),isVisible:()=>b,...E(i,e,Z)};case"CONTEXT_HIBERNATE_BACKGROUND":const P=S.filter((e=>!(0,nee.ZN)(e)));return{handler:this.discardPages.bind(this,P),isVisible:()=>P.count()>0,...E(i,e,Z)};case"CONTEXT_CLOSE":return{handler:u?()=>this.props.closePage(m):()=>this.props.closePage(o),isVisible:()=>ie.ZP.canClosePage(o),...E(i,e,Z)};case"CONTEXT_CLOSE_TABSTACK":return{handler:this.closeTabStack,isVisible:()=>l,...E(i,e,Z)};case"CONTEXT_CLOSE_OTHER":return{handler:u&&v.count()>0?this.closeAllButTab.bind(this,g,t):this.closeAllButTab.bind(this,o,t),isVisible:()=>u&&v.count()>0||!u&&A,...E(i,e,Z)};case"CONTEXT_CLOSE_LEFT":return{handler:()=>this.closeToLeft(o,t),isVisible:()=>!u&&A&&ie.ZP.getPages(this.context.vivaldiWindowId).filter((e=>(0,ay.cm)(e)===r)).takeUntil((e=>e.id===o.id)).count()>0,...E(i,e,Z)};case"CONTEXT_CLOSE_RIGHT":return{handler:()=>this.closeToRight(o,t),isVisible:()=>!u&&A&&ie.ZP.getPages(this.context.vivaldiWindowId).skipUntil((e=>e.id===o.id)).skip(1).takeUntil((e=>(0,ay.cm)(e)!==r)).count()>0,...E(i,e,Z)};case"CONTEXT_REOPEN":return{isVisible:()=>Boolean(kde.Z.getTrash().length),...E(i,e,Z)};case"CONTEXT_CONTAINER_PWA":return{isVisible:()=>o.active&&!this.props.isInternalPage,container:{content:"pwa"},...E(i,e,Z)};case"CONTEXT_CUSTOMIZE":return{handler:this.customize,isVisible:()=>!f,...E(i,e,Z)};case"CONTEXT_MOVE":return{isVisible:()=>u&&!g.some((e=>o.incognito))||!u&&(t||!l),...E(i,e,Z)};case"CONTEXT_TABSTACK_MOVE":return{isVisible:()=>!u&&!t&&l,...E(i,e,Z)};case"CONTEXT_MOVE_LEFT":return{handler:()=>d.ZP.stepPage(o,!1,!1,a),isVisible:()=>!u,...E(i,e,Z)};case"CONTEXT_MOVE_RIGHT":return{handler:()=>d.ZP.stepPage(o,!0,!1,a),isVisible:()=>!u,...E(i,e,Z)};case"CONTEXT_MOVE_STACK_LEFT":return{handler:()=>d.ZP.stepPage(o,!1,!0,a),isVisible:()=>!u,...E(i,e,Z)};case"CONTEXT_MOVE_STACK_RIGHT":return{handler:()=>d.ZP.stepPage(o,!0,!0,a),isVisible:()=>!u,...E(i,e,Z)};case"CONTEXT_CONTAINER_MOVE_TO_WINDOW":return{items:await M(),...E(i,e,Z)};case"CONTEXT_CONTAINER_MOVE_TO_WORKSPACE":return{items:await N(),isVisible:()=>this.props.prefValues[$.kWorkspacesEnabled],...E(i,e,Z)};default:return{...E(i,e,Z)}}}))};isKnownDropMimeType=e=>e.dataTransfer.types.some((e=>e===h.Up||Ds.ZP.isUriListType(e)||"text/plain"===e));onDragEnterHandler=e=>{const{groupId:t,prefValues:n,isInsideAccordion:s,handleExpandAccordion:i}=this.props;t&&"accordion"===n[$.kTabsStackingMode]&&!s&&i&&(clearTimeout(this.accordionExpandTimeout),this.accordionExpandTimeout=setTimeout((()=>i(t)),1e3)),this.isKnownDropMimeType(e)&&(e.preventDefault(),e.stopPropagation())};onDragLeaveHandler=e=>{e.persist();this.props.groupId&&"accordion"===this.props.prefValues[$.kTabsStackingMode]&&!this.props.isInsideAccordion&&clearTimeout(this.accordionExpandTimeout),this.props.onDragLeave(e)};onDragOverHandler=e=>{if(this.isKnownDropMimeType(e)&&(e.preventDefault(),e.stopPropagation()),e.dataTransfer.types.includes("vivaldi/x-button-toolbar"))return;const t=this.props.handleTabPosition;if(t&&this.props.isExpectingDrop&&e.dataTransfer.types.some((e=>e===h.Up))){const{pageX:n,pageY:s}=e,i=this.getDropSide(n,s);t(this.props.pageId,i)}else{e.dataTransfer.types.some((e=>Ds.ZP.isUriListType(e)||sae.Z.isSessionType(e)||"text/plain"===e))&&(e.dataTransfer.dropEffect="copy");const t=ie.ZP.getPageById(this.props.pageId);t&&Ahe(e.screenX,e.screenY,250,(()=>this.props.onActivate(t)))}};getDropSide=(e,t)=>{const{Element:n}=this.context;if(!(this.refTab.current instanceof n))return"before";const{prefValues:s,direction:i,isSubstrip:o,isInsideAccordion:a}=this.props,r=!(this.props.pinned&&!o)&&s[$.kTabsStackingAllowDnd]&&"off"!==s[$.kTabsStackingMode]&&!o&&!a,l=this.refTab.current.getBoundingClientRect(),[d,c]=[e-l.left,t-l.top];return"row"===i?r?d<l.width*The?"before":d>l.width*Zhe?"after":"over":d<l.width/2?"before":"after":"column"===i?r?c<l.height*The?"before":c>l.height*Zhe?"after":"over":c<l.height/2?"before":"after":"before"};onDropHandler=e=>{this.isKnownDropMimeType(e)&&(e.preventDefault(),e.stopPropagation());const t=e.dataTransfer.getData(h.Up);if(t)return void this.props.droppedTabHandler(t);const n=Ds.ZP.extractUriListFromEvent(e);if(n)return void n.split("\n").forEach(((e,t)=>d.ZP.openURL(this.context.vivaldiWindowId,e,{incognito:this.props.incognito,inCurrent:0===t,inSpecificPageId:0===t?this.props.pageId:void 0,inBackground:0!==t})));const s=sae.Z.getSessionData(e);if(s)return void Kn.Z.open(this.context.vivaldiWindowId,s,!1);const i=e.dataTransfer.getData("text/plain");i&&(0,vs.K2)(i)&&d.ZP.openURL(this.context.vivaldiWindowId,i,{inCurrent:!0,inSpecificPageId:this.props.pageId,incognito:this.props.incognito})};onFocusHandler=e=>{if(this.state.awaitingEdit)return;const t=ie.ZP.getPageById(this.props.pageId);t&&d.ZP.setSelection(t,{multiSelect:!1,addGroup:!1,excludeActive:!0})};renderCustomTabStackTitle=e=>{const t=this.props.groupId,n=(0,Ade.aD)(t,e),s=()=>{this.isIMEOpen=!0},i=()=>{this.isIMEOpen=!1},o=e=>{if("Enter"!==e.key||this.isIMEOpen)"Escape"===e.key&&(e.preventDefault(),e.stopPropagation(),this.setState({awaitingEdit:null}));else{e.preventDefault(),e.stopPropagation();const{HTMLInputElement:t}=this.context;e.target instanceof t&&l(e.target.value)}},a=e=>{const{document:t}=this.context;e&&t.activeElement!==e&&e.select()},r=e=>{l(e.target.value)},l=async e=>{await(0,Ade.ZP)(this.context.vivaldiWindowId,t,e),this.setState({awaitingEdit:null})},{awaitingEdit:d}=this.state;return t&&t===d?(0,fs.jsx)("input",{className:"tab-title-edit",defaultValue:n,ref:a,onBlur:r,onKeyDown:o,onMouseDown:this.containEvent,onCompositionStart:s,onCompositionUpdate:s,onCompositionEnd:i}):n};renderStackFrame=(e,t)=>{const{prefValues:n,isHiddenForDrag:s,accordionFrameSize:i,isDragging:o}=this.props,a=this.isHorizontal(),r="accordion"===n[$.kTabsStackingMode],l=t||this.props.isInsideAccordion&&this.props.isFirstInGroup;let d,c,h=null;if(r&&l){if(i>0)a?d=i-1+"px":c=`${i}px`;else{const e=o||s?0:16;a?d=`calc(var(--Width) + ${e-1}px)`:c=`calc(var(--Height) + ${e}px)`}h={width:d,height:c}}return khe("svg",{xmlns:"http://www.w3.org/2000/svg",width:t&&!a?"100%":null,height:t&&a?"100%":null,style:h,className:As()({"svg-tab-selection":e,"svg-tab-stack":l})},void 0,e&&Mhe,e&&Nhe,l&&Phe)};render(){const{discarded:e,prefValues:t,faviconUrl:n,isInternalPage:s,isStack:i,isUnread:o,isHidden:a,shouldShowCloseButton:r,mediaState:l}=this.props,{loadingProgress:d,timeLeft:c,displayTitle:h,titleNumber:p,tabTitle:u}=this.state,g=this.props.pinned&&!this.props.isSubstrip,m=this.props.active,v=Boolean(this.props.smallTab),f=0===l.size||e,y=Boolean(this.props.isSelecting&&(!this.props.isHidden&&this.props.isSelected||this.props.highlighted)),C=t[$.kTabsStackingMode],w=i&&!this.props.isSubstrip&&"off"!==C&&("dotted"===C||t[$.kTabsStackingPreferDotted]),b=As()("tab",{"tab-acceptsdrop":this.props.acceptsDrop,marked:y,pinned:g,active:m,uifocusstop:m&&!a,highlighted:this.props.highlighted&&!t[$.kTabsSelectionEnabled],"tab-small":v&&!g,"tab-mini":this.props.miniTab&&!g,"tab-accordion":this.props.isStack&&"accordion"===C,"tab-in-accordion":this.props.isInsideAccordion,"tab-first-in-group":this.props.isFirstInGroup,"tab-last-in-group":this.props.isLastInGroup,"force-hover":this.props.forceHover,"tab-group":w,"audio-on":l.has("playing")||l.has("pip"),"audio-muted":l.has("muting"),"tab-captured":l.has("capturing"),"button-off":!r,unread:t[$.kTabsUnread]&&o&&!m&&!i&&!s,isdiscarded:this.state.fadeDiscardedTabs&&e,insubstrip:this.props.isSubstrip}),S="progress_bar"===t[$.kTabsPageLoadInfo]&&!s&&(m&&!this.props.addressBarVisible||m&&!t[$.kAddressBarShowProgress]||!m),I=c||S,k=c||d,A=m?t[$.kKeyboardTabToAll]:"-1";return(0,fs.jsxs)(fs.Fragment,{children:[(0,fs.jsxs)("div",{id:this.props.id,className:b,ref:this.refTab,"data-id":this.props.id,title:t[$.kTabsTooltip]?null:u,onContextMenu:e=>this.onContextMenu(this.props.isSubstrip||this.props.isInsideAccordion,e),onMouseEnter:this.mouseEnterHandler,onMouseDown:to.PF,onDragEnter:this.onDragEnterHandler,onDragOver:this.onDragOverHandler,onDragLeave:this.onDragLeaveHandler,onDrop:this.onDropHandler,onKeyDown:this.keyDown,onFocus:t[$.kTabsSelectionEnabled]?this.onFocusHandler:null,tabIndex:A,children:[khe("div",{className:As()("tab-header",{"expecting-drop":this.props.isExpectingDrop})},void 0,I&&khe(fhe,{progress:k}),khe(che,{isPrivate:G.ZP.isIncognitoOrGuest(this.context.vivaldiWindowId),refFavicon:this.refFavicon,faviconUrl:n,progress:this.state.loadingProgress,progressType:"progress_icon"===t[$.kTabsPageLoadInfo]||"spinner"===t[$.kTabsPageLoadInfo]?t[$.kTabsPageLoadInfo]:void 0}),khe("span",{className:"title",onDoubleClick:t[$.kTabsMinimize]||t[$.kTabsDoubleClickClose]?null:this.renameTabStack},void 0,!i||this.props.isSubstrip||this.props.isInsideAccordion?h:this.renderCustomTabStackTitle(h)),this.props.shouldShowStackCounter&&khe("div",{className:"stack-counter"},void 0,this.props.stackSize),r&&khe(uhe,{onClick:this.handleClose,onMouseDown:this.blockEvent}),!f&&khe("span",{className:"tab-audio",onClick:this.handleMedia,onAuxClick:this.handleClose,onMouseDown:this.blockEvent},void 0,khe(Qo,{color:v||g?"#111":void 0,animated:t[$.kThemeUseAnimation],mediaState:l,src:"tab"})),t[$.kTabsCounterDetection]&&p&&khe("span",{className:"button-badge"},void 0,p)),t[$.kTabsThumbnails]&&khe(c2,{src:this.props.thumbnail||""}),(y||(i||this.props.isInsideAccordion&&this.props.isFirstInGroup)&&!this.props.isSubstrip&&!w)&&this.renderStackFrame(y,i)]}),w&&this.renderTabGroupIndicator()]})}}const xhe=Dhe;var Ohe=n(65810);class Lhe extends F.Z{getInitialState(){return null}allHidden(){return null===this.getState()}getShowTooltip(e){return this.getState()===e}reduce(e,t){switch(t.actionType){case"WEBPAGEVIEW_ACTIONS":if(["focusSearchField","focusAddressField"].indexOf(t.subAction)>-1)return null;break;case"TOOLTIP_SET":if(!pl.Z.getState().isActive)return t.id}return e}}const Rhe=new Lhe;var Bhe,Fhe=n(20745),Vhe=n(34155);function Whe(e,t,n,s){Bhe||(Bhe="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Bhe,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Uhe="vivaldi-tooltip";function Hhe(e){let t=e.getElementById(Uhe);if(!t){const n=e.getElementById("browser");t=e.createElement("div"),t.id=Uhe,n&&n.appendChild(t)}return t}let zhe;Rhe.addListener((()=>{Rhe.allHidden()&&(zhe?.unmount(),zhe=void 0)}));class Ghe extends hs.Component{static contextType=xi.Z;nodeRef=hs.createRef();state={show:Rhe.getShowTooltip(this.props.id)};#de=!1;componentWillUnmount(){Rhe.removeListener(this._onStoreChange),Vhe.nextTick(Ohe.Z.hideTooltip)}componentDidMount(){Rhe.addListener(this._onStoreChange),this.props.disabled||this.renderToolTip()}componentDidUpdate(e,t){this.props.disabled||t.show===this.state.show&&e.stackSize===this.props.stackSize||this.renderToolTip()}_onStoreChange=()=>{this.setState({show:!this.props.disabled&&Rhe.getShowTooltip(this.props.id)})};onDragEnter=()=>{Ohe.Z.hideTooltip(0),this.#de=!0};onDragLeave=()=>{this.#de=!1};onMouseEnter=()=>{if(!this.props.disabled&&!this.#de){const e=Rhe.allHidden()?this.props.appearDelay:0;Ohe.Z.showTooltip(this.props.id,e)}};onMouseLeave=()=>{this.props.disabled||Ohe.Z.hideTooltip(this.props.disappearDelay)};onClick=()=>{Ohe.Z.hideTooltip(0)};tooltipIsOpen=()=>{const{document:e}=this.context,t=Hhe(e).firstChild,{Element:n}=this.context;return Boolean(t instanceof n&&t.classList.contains("tooltip"))};getPosition=(e,t)=>{const{Element:n}=this.context,s=this.nodeRef.current;let i,o;if(!(s&&s.firstChild instanceof n))return{left:i,top:o};const a=s.firstChild.getBoundingClientRect(),r=this.props.noPadding?0:4;if("above"===this.props.placement){i=a.left+a.width/2-e/2,o=a.top-t-r}else if("after"===this.props.placement)i=a.left+a.width+r,o=a.top;else if("before"===this.props.placement)i=a.left-e-r,o=a.top;else{i=a.left+a.width/2-e/2,o=a.top+a.height+r}return i<0&&(i=0),o<0&&(o=0),i+e>this.context.innerWidth&&(i-=i+e-this.context.innerWidth),o+t>this.context.innerHeight&&(o-=o+t-this.context.innerHeight),{left:i,top:o}};renderToolTip=()=>{this.context.requestAnimationFrame(this._renderToolTip)};_renderToolTip=()=>{if(!this.state.show)return;const{document:e}=this.context,{width:t,height:n,content:s}=this.props.content(this.props.id),{left:i,top:o=0}=this.getPosition(t,n),a=o+n>=this.context.innerHeight,r=a?"flex-end":"flex-start",l=this.props.noPadding?0:4,d=0===o?l:0,c=a?l:0,h=this.props.pointerEvents,p=["after","before"].includes(this.props.placement)?`top ${this.props.transitionSpeed}ms`:`left ${this.props.transitionSpeed}ms`,u="before"===this.props.placement||"after"===this.props.placement;zhe||(zhe=(0,Fhe.s)(Hhe(e))),zhe.render(Whe("div",{className:"tooltip",style:{top:o,left:i,pointerEvents:h,height:u?"auto":n,width:t,paddingTop:d,paddingBottom:c,alignItems:r,transition:p},onClick:this.onClick,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},void 0,s))};render(){return(0,fs.jsx)("span",{ref:this.nodeRef,onDragEnter:this.onDragEnter,onDragLeave:this.onDragLeave,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:this.props.children})}}const $he=Ghe;const Khe=1e3/60;function jhe(e,t,n){const s=t;return null==s?e.map(((e,t)=>({key:e.key,data:e.data,style:n[t]}))):e.map(((e,t)=>{for(let i=0;i<s.length;i++)if(s[i].key===e.key)return{key:s[i].key,data:s[i].data,style:n[t]};return{key:e.key,data:e.data,style:n[t]}}))}function Yhe(e,t,n,s,i,o,a,r,l){const d=function(e,t,n){const s={};for(let t=0;t<e.length;t++)s[e[t].key]=t;const i={};for(let e=0;e<t.length;e++)i[t[e].key]=e;const o=[];for(let e=0;e<t.length;e++)o[e]=t[e];for(let t=0;t<e.length;t++)if(!Object.prototype.hasOwnProperty.call(i,e[t].key)){const s=n(t,e[t]);null!=s&&o.push(s)}return o.sort(((e,n)=>{const o=i[e.key],a=i[n.key],r=s[e.key],l=s[n.key];if(null!=o&&null!=a)return i[e.key]-i[n.key];if(null!=r&&null!=l)return s[e.key]-s[n.key];if(null!=o){for(let e=0;e<t.length;e++){const n=t[e].key;if(Object.prototype.hasOwnProperty.call(s,n)){if(o<i[n]&&l>s[n])return-1;if(o>i[n]&&l<s[n])return 1}}return 1}for(let e=0;e<t.length;e++){const n=t[e].key;if(Object.prototype.hasOwnProperty.call(s,n)){if(a<i[n]&&r>s[n])return 1;if(a>i[n]&&r<s[n])return-1}}return-1}))}(s,i,((e,s)=>{const i=t(s);return null==i||Fq(o[e],i,a[e])?(n({key:s.key,data:s.data}),null):{key:s.key,data:s.data,style:i}})),c=[],h=[],p=[],u=[];for(let t=0;t<d.length;t++){const n=d[t];let i=null;for(let e=0;e<s.length;e++)if(s[e].key===n.key){i=e;break}if(null==i){const s=e(n);c[t]=s,p[t]=s;const i=Bq(n.style);h[t]=i,u[t]=i}else c[t]=o[i],p[t]=r[i],h[t]=a[i],u[t]=l[i]}return[d,c,h,p,u]}class Xhe extends hs.Component{static contextType=xi.Z;context;static defaultProps={willEnter:e=>Uq(e.style),willLeave:()=>null,didLeave:()=>{}};unmounting=!1;animationID=null;prevTime=0;accumulatedTime=0;unreadPropStyles=null;constructor(e){super(e),this.state=this.defaultState()}defaultState(){const{defaultStyles:e,styles:t,willEnter:n,willLeave:s,didLeave:i}=this.props,o="function"==typeof t?t(e):t;let a;a=null==e?o:e.map((e=>{for(let t=0;t<o.length;t++)if(o[t].key===e.key)return o[t];return e}));const r=null==e?o.map((e=>Uq(e.style))):e.map((e=>Uq(e.style))),l=null==e?o.map((e=>Bq(e.style))):e.map((e=>Bq(e.style))),[d,c,h,p,u]=Yhe(n,s,i,a,o,r,l,r,l);return{currentStyles:c,currentVelocities:h,lastIdealStyles:p,lastIdealVelocities:u,mergedPropsStyles:d}}clearUnreadPropStyle=e=>{const[t,n,s,i,o]=Yhe(this.props.willEnter,this.props.willLeave,this.props.didLeave,this.state.mergedPropsStyles,e,this.state.currentStyles,this.state.currentVelocities,this.state.lastIdealStyles,this.state.lastIdealVelocities);for(let a=0;a<e.length;a++){const r=e[a].style;let l=!1;for(const e in r){if(!Object.prototype.hasOwnProperty.call(r,e))continue;const d=r[e];"number"==typeof d&&(l||(l=!0,n[a]={...n[a]},s[a]={...s[a]},i[a]={...i[a]},o[a]={...o[a]},t[a]={key:t[a].key,data:t[a].data,style:{...t[a].style}}),n[a][e]=d,s[a][e]=0,i[a][e]=d,o[a][e]=0,t[a].style[e]=d)}}this.setState({currentStyles:n,currentVelocities:s,mergedPropsStyles:t,lastIdealStyles:i,lastIdealVelocities:o})};startAnimationIfNecessary=()=>{if(this.unmounting||null!=this.animationID)return;const{requestAnimationFrame:e}=this.context;this.animationID=e((e=>{if(this.unmounting)return;const t=this.props.styles,n="function"==typeof t?t(jhe(this.state.mergedPropsStyles,this.unreadPropStyles,this.state.lastIdealStyles)):t;if(function(e,t,n,s){if(s.length!==t.length)return!1;for(let e=0;e<s.length;e++)if(s[e].key!==t[e].key)return!1;for(let i=0;i<s.length;i++)if(!Fq(e[i],t[i].style,n[i]))return!1;return!0}(this.state.currentStyles,n,this.state.currentVelocities,this.state.mergedPropsStyles))return this.animationID=null,void(this.accumulatedTime=0);const s=e||performance.now(),i=s-this.prevTime;if(this.prevTime=s,this.accumulatedTime=this.accumulatedTime+i,this.accumulatedTime>166.66666666666669&&(this.accumulatedTime=0),0===this.accumulatedTime)return this.animationID=null,void this.startAnimationIfNecessary();const o=(this.accumulatedTime-Math.floor(this.accumulatedTime/Khe)*Khe)/Khe,a=Math.floor(this.accumulatedTime/Khe),[r,l,d,c,h]=Yhe(this.props.willEnter,this.props.willLeave,this.props.didLeave,this.state.mergedPropsStyles,n,this.state.currentStyles,this.state.currentVelocities,this.state.lastIdealStyles,this.state.lastIdealVelocities);for(let e=0;e<r.length;e++){const t=r[e].style,n={},s={},i={},p={};for(const r in t){if(!Object.prototype.hasOwnProperty.call(t,r))continue;const l=t[r];if("number"==typeof l)n[r]=l,s[r]=0,i[r]=l,p[r]=0;else{let t=c[e][r],d=h[e][r];for(let e=0;e<a;e++)[t,d]=Wq(.016666666666666666,t,d,l.val,l.stiffness,l.damping,l.precision);const[u,g]=Wq(.016666666666666666,t,d,l.val,l.stiffness,l.damping,l.precision);n[r]=t+(u-t)*o,s[r]=d+(g-d)*o,i[r]=t,p[r]=d}}c[e]=i,h[e]=p,l[e]=n,d[e]=s}this.animationID=null,this.accumulatedTime-=a*Khe,this.setState({currentStyles:l,currentVelocities:d,lastIdealStyles:c,lastIdealVelocities:h,mergedPropsStyles:r}),this.unreadPropStyles=null,this.startAnimationIfNecessary()}))};componentDidMount(){this.prevTime=performance.now(),this.startAnimationIfNecessary()}UNSAFE_componentWillReceiveProps(e){this.unreadPropStyles&&this.clearUnreadPropStyle(this.unreadPropStyles);const t=e.styles;this.unreadPropStyles="function"==typeof t?t(jhe(this.state.mergedPropsStyles,this.unreadPropStyles,this.state.lastIdealStyles)):t,null==this.animationID&&(this.prevTime=performance.now(),this.startAnimationIfNecessary())}componentWillUnmount(){this.unmounting=!0,null!=this.animationID&&(this.context.cancelAnimationFrame(this.animationID),this.animationID=null)}render(){const e=jhe(this.state.mergedPropsStyles,this.unreadPropStyles,this.state.currentStyles),t=this.props.children(e);return t&&hs.Children.only(t)}}var Qhe=n(10695),qhe=n.n(Qhe),Jhe=n(7065),epe=n(34155);function tpe({accordionIsOpen:e,draggedActive:t,droppedTabs:n,isSubstrip:i,isTabStackingEnabled:o,maybeResetDragging:a,tabStackingMode:r,allTabs:l,substripTabs:c,yieldAfter:h,yieldBefore:p,yieldOver:u,windowId:g}){const m=JSON.parse(n),v=m.ids.map((e=>parseInt(e))).sort(((e,t)=>e-t)),f=(0,te.aV)(l).filter((e=>v.some((t=>e.id===t)))).map(Jhe.OK),y=u?ie.ZP.getPages(g).find((e=>e.id===u&&!e.pinned)):void 0;if(y){let e=(0,ay.av)(y);const n=o&&ie.ZP.isGroup(e,g),s=y.windowId===f.first().windowId;let i,r,l;if(n)i=ie.ZP.getGroup(e,g).first().index,r=ie.ZP.getGroup(e,g).concat(f);else{i=y.index,r=te.aV.of(y).concat(f),e=ie.ZP.getNewGroupId();const n=t&&(0,ay.av)(t);n&&ie.ZP.isGroup(n,g)&&(l=(0,Ade.aD)(n,""))}const c=()=>d.ZP.createTabStack(r,i,e).then((()=>{e&&l&&(0,Ade.ZP)(g,e,l)}));if(s){const e=f.reduce(((e,t)=>t.index<i?e+1:e),0);i-=e,c()}else{const e=G.ZP.getActiveWorkspace(y.windowId);d.ZP.moveToWorkspace(f,e).then(c)}a()}else{const t=()=>epe.nextTick(a),n=m.active,s=function(e,t,n,s,i,o,a,r){if(a){const e=ie.ZP.getPages(r).find((e=>e.id===a));return e?e.index:-1}const l=ie.ZP.getPages(r).find((e=>e.id===i||e.id===o));if(!l)return-1;const d=(0,ay.av)(l);let c;if(n&&ie.ZP.isGroup(d,r))if("accordion"===s&&e(d))c=l.id;else{const e=ie.ZP.getGroup(d,r);c=i?e.first().id:e.last().id}else c=l.id;return ie.ZP.getPages(r).filter((e=>e.id!==t)).findIndex((e=>e.id===c))+(o?1:0)}(e,v[0],o,r,p,h,u,g);if(i)if(1===c.size)d.ZP.createTabStack(c.map((e=>e.page)).concat(f),s,ie.ZP.getNewGroupId());else{const e=(0,ay.av)(c.first()?.page);e&&d.ZP.moveDroppedTabs(f,n,s,e,g).then(t)}else if("accordion"===r){const i=l.map(Jhe.OK).map((e=>(0,ay.av)(e)??"")),o=(0,te.aV)(i).countBy((e=>e)),a=f.reduce(((e,t)=>e.add((0,ay.av)(t)??"")),new te.l4),r=m.sourceWindow===g,c=i[s]??"",h=i[s+(s<m.activeIndex?-1:1)]??"";let p;p=r?c&&e(c)&&h===c?c:1===a.size&&o.get(a.first())===f.size?void 0:"":void 0,d.ZP.moveDroppedTabs(f,n,s,p,g).then(t)}else{const e="main"!==m.dragSource?"":void 0;d.ZP.moveDroppedTabs(f,n,s,e,g).then(t)}}s.Z.windows.update(g,{focused:!0})}var npe,spe=n(74678),ipe=n(42941),ope=n(37441);function ape(e,t,n,s){npe||(npe="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:npe,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const rpe=180,lpe=150,dpe=30,cpe=31,hpe={stiffness:400,damping:32,precision:.1},ppe=Che();var upe=ape("hr",{}),gpe=ape("span",{className:"dragspace"});class mpe extends hs.PureComponent{static contextType=xi.Z;currentHoveredId=0;#h;refTabStrip=hs.createRef();refTabs=new Map;#ce=!1;#he;start=[0,0];delta=[0,0];isMouseOverScrollArrow=!1;enterSide="none";state={isDragging:!1,draggedActive:null,draggedPages:(0,te.aV)(),pageIdsHiddenForDrag:(0,te.l4)(),isYielding:!1,yieldBefore:null,yieldAfter:null,yieldOver:null,freeze:null,animate:!1,highlightedId:"",isDraggingPinnedTab:!1,activeAlarms:new te.l4,canScrollLeft:!1,canScrollRight:!1,mouse:[0,0],hoveredPageId:-1};componentDidMount(){const{addEventListener:e}=this.context;this.setOverflowClass(),tl.Z.addListener("COMMAND_FOCUS_TABBAR",this.onCommandSpy),tl.Z.addListener("COMMAND_RENAME_TAB_STACK",this.onCommandSpy),tl.Z.addListener("COMMAND_TAB_MOVE_FIRST",this.onCommandSpy),tl.Z.addListener("COMMAND_TAB_MOVE_END",this.onCommandSpy),e("dragenter",this.windowDragEnterHandler),e("dragleave",this.windowDragLeaveHandler),e("dragover",this.windowDragOverHandler),e("drop",this.windowDropHandler),oe.Z.addListener(this._alarmsChanged),this.#h=!0}componentWillUnmount(){this.#h=!1,this.animateTimeoutId&&clearTimeout(this.animateTimeoutId),this.#he&&URL.revokeObjectURL(this.#he),tl.Z.removeListener("COMMAND_FOCUS_TABBAR",this.onCommandSpy),tl.Z.removeListener("COMMAND_RENAME_TAB_STACK",this.onCommandSpy),tl.Z.removeListener("COMMAND_TAB_MOVE_FIRST",this.onCommandSpy),tl.Z.removeListener("COMMAND_TAB_MOVE_END",this.onCommandSpy),this.context.removeEventListener("dragenter",this.windowDragEnterHandler),this.context.removeEventListener("dragleave",this.windowDragLeaveHandler),this.context.removeEventListener("dragover",this.windowDragOverHandler),this.context.removeEventListener("drop",this.windowDropHandler),oe.Z.removeListener(this._alarmsChanged)}componentDidUpdate(e){this.props.tabs===e.tabs&&this.props.maxWidth===e.maxWidth&&this.props.maxHeight===e.maxHeight||setTimeout((()=>{this.setOverflowClass(),this.updateScrollStatus()}),16),this.props.pages!==e.pages&&(this.maybeResetDragging(),this.props.pages.size>e.pages.size&&this.state.freeze&&this.setState({freeze:null})),this.state.freeze&&this.props.openAccordions?.length!==e.openAccordions?.length&&this.cleanUpFreezeHandler(),this.props.maxWidth!==e.maxWidth&&(this.props.maxWidth<=0&&(clearTimeout(this.animateTimeoutId),this.setState({animate:!1})),e.maxWidth<=0&&this.props.maxWidth>0&&this.allowDelayedAnimation())}_alarmsChanged=e=>{e&&this.setState((t=>{const n=e.map((e=>e?.id||""));return{activeAlarms:t.activeAlarms.union(n)}}))};isTabStackingEnabled=()=>!this.props.isSubstrip&&"off"!==this.props.prefValues[$.kTabsStackingMode];setOverflowClass=()=>{const{Element:e}=this.context,t=this.refTabStrip.current;if(t&&("left"===this.props.tabPosition||"right"===this.props.tabPosition))if(t instanceof e&&t.clientHeight<t.scrollHeight){if(this.props.setOverflowClass(!0,this.props.isSubstrip),this.props.switchByScroll){const e=t.getElementsByClassName("tab active")[0];e&&"function"==typeof e.scrollIntoViewIfNeeded&&e.scrollIntoViewIfNeeded()}}else this.props.setOverflowClass(!1,this.props.isSubstrip)};maybeSpring=(e,t)=>this.state.animate&&this.props.prefValues[$.kThemeUseAnimation]&&!this.props.isResizing&&this.fitsInView()?jq(e,t):e;fitsInView=()=>"row"===this.props.direction?this.props.tabs.size*dpe<this.props.maxWidth:this.props.tabs.size*dpe<this.props.maxHeight;allowDelayedAnimation(){this.state.animate||(this.animateTimeoutId=setTimeout((()=>{this.setState({animate:!0})}),1e3))}onCommandSpy=(e,t)=>{if(e===this.context.vivaldiWindowId)switch(t){case"COMMAND_FOCUS_TABBAR":sl(this.context.document,this.refTabStrip.current)||this.moveFocus("","current",!0);break;case"COMMAND_RENAME_TAB_STACK":{const t=ie.ZP.getActivePage(e);if(t&&(0,ay.av)(t)){this.refTabs.get(t.id)?.current?.renameTabStack()}break}case"COMMAND_TAB_MOVE_FIRST":d.ZP.stepTabsToStart(e);break;case"COMMAND_TAB_MOVE_END":d.ZP.stepTabsToEnd(e)}};accordionIsOpen=e=>Boolean(e&&this.props.openAccordions?.some((t=>t.groupId===e)));getNewTabButtonId(){return"newtab-"+(this.props.isSubstrip?"sub":"main")}moveFocus=(e,t,n)=>{const{document:s,HTMLElement:i}=this.context;if(!0===n||sl(s,this.refTabStrip.current)){let n=[];const s=this.refTabStrip.current;if(s instanceof i&&(n=Array.from(s.querySelectorAll("div.tab")).map((e=>e.dataset.id)).filter(Boolean)),0===n.length)return;if("current"===t){if(""===e&&s instanceof i){const t=s.getElementsByClassName("tab active")[0];t instanceof i&&(e=t.dataset.id)}const t=n.indexOf(e);if(-1===t)return;e=n[t]}else if("right"===t||"left"===t){if(1===n.length)return;let s=n.indexOf(e);if(-1===s)return;s="right"===t?s+1>=n.length?0:s+1:s<=0?n.length-1:s-1,e=n[s]}if(s instanceof i){const t=e===this.getNewTabButtonId()?s.querySelector("div.toolbar-tabbar button"):s.querySelector(`div.tab[data-id="${e}"]`);t&&(t.focus(),this.setState({highlightedId:String(e)}))}}};openStackMenu=(e,t)=>{if(this.isTabStackingEnabled()){const n=ie.ZP.getPageById(e);if(n){const e=(0,ay.av)(n);if(ie.ZP.isGroup(e,this.context.vivaldiWindowId)){const n=ie.ZP.getGroup(e,this.context.vivaldiWindowId).toArray().map(((e,t)=>({url:e.url,handler:()=>d.ZP.activateTab(e.id,this.context.vivaldiWindowId),...ae.Z.makeNumberMnemonic(e.title,t)}))),s="top"===this.props.tabPosition||"bottom"===this.props.tabPosition?"bottomLeft":"left"===this.props.tabPosition?"topRight":"topLeft";(0,Qi.Z)(this.context,n,void 0,s,t)()}}}};handleLeaveBar=()=>{this.setState({highlightedId:""});const e=this.context.vivaldiWindowId;Ae.Z.setPaneFocus(e,!1),v.Z.executeActions("event",this.context,"COMMAND_FOCUS_WEBVIEW")};closeAndFreeze=e=>{const t=(0,d.nq)(e)?e:te.aV.of(e),n="on"===this.props.prefValues[$.kTabsClosePinned]?t:t.filter((e=>!e.pinned));if(0!==n.size){if(1===n.size){const e=n.first();!e.pinned&&this.props.prefValues[$.kTabsAlignNext]&&this.freezeTabSize(e)}this.setState({animate:!1},(()=>{this.props.closePage(n).then((()=>{this.allowDelayedAnimation()}))}))}};freezeTabSize=e=>{const t=e=>{const t=this.createFlexBoxLayout(this.props.tabs,this.props.direction,this.props.maxWidth,this.props.maxHeight,{pageIdsHiddenForDrag:this.state.pageIdsHiddenForDrag,freeze:this.state.freeze,yieldBefore:this.state.yieldBefore,yieldAfter:this.state.yieldAfter,tabStackingEnabled:this.isTabStackingEnabled(),isThumb:this.props.prefValues[$.kTabsThumbnails]}).children.map((e=>"tab"===e.type?e:void 0)).filter(Boolean),n=t.findIndex((t=>t.page.id===e)),s=t[n];if(s){let e;e=s.page.active?t[n+1]:s;const i=e.page.id;i&&this.setState({freeze:{width:e.layout?.width||this.props.maxWidth,height:s.layout?.height||this.props.maxHeight,nextId:i}}),this.context.addEventListener("mousemove",this.detectFinishFreezeHandler)}},n=this.props.tabs.getIn([-1,"page","id"]);e.id!==n?t(e.id):this.cleanUpFreezeHandler()};cleanUpFreezeHandler=()=>{this.setState({freeze:null}),this.context.removeEventListener("mousemove",this.detectFinishFreezeHandler)};detectFinishFreezeHandler=e=>{const{Element:t}=this.context,n=this.refTabStrip.current;if(n instanceof t){const t=n.getBoundingClientRect();(t.left>e.clientX||t.left+t.width<e.clientX||t.top>e.clientY||t.top+t.height<e.clientY)&&this.cleanUpFreezeHandler()}};handleTouchMove=e=>{e.preventDefault(),this.maybeStartDragging(e.touches[0])};handleMouseMove=e=>{e.preventDefault(),e.button===Hi.Z.kLeft?this.maybeStartDragging(e):this.endInternalDragging()};handleMouseUp=e=>{this.endInternalDragging()};handleAccordionToggle=(e,t)=>{e&&(t?this.setState({animate:!1},(()=>{this.props.handleCompressAccordion?.(e),this.allowDelayedAnimation()})):this.props.handleExpandAccordion?.(e))};handleClick=(e,t)=>{const{prefValues:n,isSubstrip:s}=this.props,i=G.ZP.isActive(this.context.vivaldiWindowId);if(whe(t,n[$.kTabsSelectionEnabled],i))d.ZP.setSelection(e,{multiSelect:!1,addGroup:!1});else if(bhe(t,n[$.kTabsSelectionEnabled],i)){let t=!1;if("accordion"===this.props.prefValues[$.kTabsStackingMode]){const n=ie.ZP.unsafeGetActivePage(this.context.vivaldiWindowId),s=n&&(0,ay.av)(n);if(s&&!this.props.openAccordions?.find((e=>e.groupId===s)))t=!0;else{const n=ie.ZP.getSelectedPages(this.context.vivaldiWindowId),s=e?(0,ay.av)(e):null;s&&!this.props.openAccordions?.find((e=>e.groupId===s))&&n.some((e=>s!==(0,ay.av)(e)))&&(t=!0)}}else t=!s;d.ZP.setSelection(e,{multiSelect:!0,addGroup:t})}};handleMouseUpGuard=e=>{e.button===Hi.Z.kCenter&&(e.preventDefault(),e.stopPropagation())};handleAuxClick=(e,t)=>{t.button===Hi.Z.kCenter&&(this.closeAndFreeze(e),t.preventDefault(),t.stopPropagation())};handleMouseDown=(e,t,n,s)=>{const i=s.detail%2==0;if(s.button===Hi.Z.kLeft&&!i){s.preventDefault();G.ZP.isActive(this.context.vivaldiWindowId);(0,qi.Z)(s)||(this.props.onActivateTab(e),this.initDragging(s,e,t,n))}};handleDoubleClick=(e,t)=>{t.preventDefault(),t.stopPropagation();const{prefValues:n}=this.props,s=G.ZP.isActive(this.context.vivaldiWindowId);whe(t,n[$.kTabsSelectionEnabled],s)?d.ZP.toggleRelatedSelection(e):n[$.kTabsDoubleClickClose]?d.ZP.closePage(e):"accordion"===n[$.kTabsStackingMode]&&this.props.toggleAutoExpandAccordion?.((0,ay.av)(e))};handleTouchStart=(e,t,n,s)=>{this.initDragging(s.touches[0],e,t,n)};onDragEnterHandler=e=>{if(e.dataTransfer.types.some((e=>e===h.Up))&&this.props.isExpectingDrop)return e.preventDefault(),void e.stopPropagation();e.dataTransfer.types.some((e=>Ds.ZP.isUriListType(e)||sae.Z.isSessionType(e)||"text/plain"===e))&&(e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="copy")};onDragLeaveHandler=()=>{clearTimeout(this.removeYieldTimeoutId),this.removeYieldTimeoutId=setTimeout((()=>{this.#h&&(this.setState({yieldAfter:null,yieldBefore:null,yieldOver:null,hoveredPageId:void 0}),clearTimeout(this.removeYieldAnimationTimeoutId),this.removeYieldAnimationTimeoutId=setTimeout((()=>{this.state.yieldBefore||this.state.yieldAfter||!this.#h||this.setState({isYielding:!1})}),2e3))}),200)};onDragOverHandler=e=>{if(clearTimeout(this.removeYieldTimeoutId),e.dataTransfer.types.some((e=>e===h.Up))&&this.props.isExpectingDrop){e.preventDefault(),e.stopPropagation();const t=300;this.removeYieldTimeoutId=setTimeout((()=>{this.#h&&this.setState({yieldAfter:null,yieldBefore:null})}),t)}else e.dataTransfer.types.some((e=>Ds.ZP.isUriListType(e)||"text/plain"===e))&&(e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="copy")};onDropHandler=e=>{e.preventDefault(),e.stopPropagation();const t=this.context.vivaldiWindowId,n=e.dataTransfer.getData(h.Up);if(this.props.isExpectingDrop&&n)return void this.droppedTabHandler(n);const s=Ds.ZP.extractUriListFromEvent(e);if(s){const e="directrightofcurrent"===this.props.prefValues[$.kTabsNewPlacement];let n=0;const i=s.split("\n");return e&&(i.reverse(),n=i.length-1),void i.forEach(((e,s)=>d.ZP.openURL(t,e,{inCurrent:!1,inBackground:n!==s,groupId:this.props.isSubstrip?this.props.activeGroupId:void 0})))}const i=sae.Z.getSessionData(e);if(i.length>0)return void Kn.Z.open(t,i,!1);const o=e.dataTransfer.getData("text/plain");o&&Fy.Z.go(t,[o],{inCurrent:!1,enableSearch:this.props.prefValues[$.kAddressBarInlineSearchEnabled],groupId:this.props.isSubstrip?this.props.activeGroupId:void 0})};droppedTabHandler=e=>{const{yieldAfter:t,yieldBefore:n,yieldOver:i}=this.state;s.Z.tabs.query({},(s=>{this.setState({animate:!1},(()=>{tpe({accordionIsOpen:this.accordionIsOpen,draggedActive:this.state.draggedActive,droppedTabs:e,isSubstrip:this.props.isSubstrip,isTabStackingEnabled:this.isTabStackingEnabled(),maybeResetDragging:this.maybeResetDragging,tabStackingMode:this.props.prefValues[$.kTabsStackingMode],allTabs:s,substripTabs:this.props.tabs,yieldAfter:t,yieldBefore:n,yieldOver:i,windowId:this.context.vivaldiWindowId}),this.allowDelayedAnimation()}))}))};showSubStack=(0,no.Z)((e=>this.props.showSubStack?.(e)),100);doPositionUpdate=()=>{this.pendingPositionInfo&&this.setState(this.pendingPositionInfo),this.pendingPositionInfo=void 0,this.requestedFrame=void 0};scheduleTabPositionUpdate(e){const{requestAnimationFrame:t}=this.context;this.pendingPositionInfo=e,this.requestedFrame||(this.requestedFrame=t(this.doPositionUpdate))}handleTabPosition=(e,t)=>{clearTimeout(this.removeYieldTimeoutId),"before"===t?this.scheduleTabPositionUpdate({isYielding:!0,yieldBefore:e,yieldAfter:null,yieldOver:null}):"after"===t?this.scheduleTabPositionUpdate({isYielding:!0,yieldBefore:null,yieldAfter:e,yieldOver:null}):"over"===t?(this.scheduleTabPositionUpdate({yieldOver:e}),this.props.isSubstrip||this.showSubStack(e)):"none"===t&&(this.scheduleTabPositionUpdate({yieldBefore:null,yieldAfter:null,yieldOver:null}),clearTimeout(this.expireYieldTimeoutId),this.expireYieldTimeoutId=setTimeout((()=>{if(this.#h){const{yieldBefore:e,yieldAfter:t,yieldOver:n}=this.state;e||t||n||this.scheduleTabPositionUpdate({isYielding:!1})}}),1e3))};setPageIdsHiddenForDrag=e=>{this.setState({pageIdsHiddenForDrag:e})};windowDragEnterHandler=e=>{e.dataTransfer&&e.dataTransfer.types.some((e=>e===h.Up))&&(e.preventDefault(),e.stopPropagation(),this.windowDragOverHandler(e))};windowDragLeaveHandler=e=>{if(e.dataTransfer&&e.dataTransfer.types.some((e=>e===h.Up))){e.preventDefault(),e.stopPropagation();0===e.pageX&&0===e.pageY&&this.handleTabPosition(-1,"none")}};windowDragOverHandler=e=>{if(e.dataTransfer&&e.dataTransfer.types.some((e=>e===h.Up))){e.preventDefault(),e.stopPropagation(),this.delayedActivateWindow(e);const{yieldBefore:t,yieldAfter:n,yieldOver:s}=this.state;if(!s&&!t&&!n){const e=this.state.pageIdsHiddenForDrag.first();if(!e||!this.props.pages.some((t=>t.id===e))){const e=this.props.pages.getIn([-1,"id"]);e&&this.handleTabPosition(e,"after")}}}};windowDropHandler=e=>{const{dataTransfer:t}=e;if(t&&t.types.some((e=>e===h.Up))){e.preventDefault(),e.stopPropagation();const n=t.getData(h.Up),i=JSON.parse(n),o=i.ids.map((e=>parseInt(e))).sort(((e,t)=>e-t));s.Z.tabs.query({},(t=>{if(t.find((e=>o.includes(e.id)&&e.windowId!==this.context.vivaldiWindowId))){const e=(0,te.aV)(t).filter((e=>o.some((t=>e.id===t)))).map(Jhe.OK);d.ZP.moveDroppedTabs(e,i.active,-1,void 0,this.context.vivaldiWindowId)}else{const t=ie.ZP.getPages(this.context.vivaldiWindowId),n=o.map((e=>t.find((t=>t.id===parseInt(e))))).filter(Boolean);if(n.length===t.size)return void this.maybeResetDragging();n.length?d.ZP.detachPage((0,te.aV)(n),e.screenX,e.screenY):(this.maybeResetDragging(),console.warn("Dropped Page(s) does not exist:",o))}}))}};delayedActivateWindow({screenX:e,screenY:t}){ppe(e,t,250,(()=>s.Z.windows.update(this.context.vivaldiWindowId,{focused:!0})))}maybeResetDragging=()=>{if(!this.#h)return;const{pageIdsHiddenForDrag:e,isYielding:t,yieldOver:n}=this.state;(!e.isEmpty()||t||n)&&this.setState({isYielding:!1,yieldBefore:null,yieldAfter:null,yieldOver:null,pageIdsHiddenForDrag:(0,te.l4)(),isDragging:!1,hoveredPageId:void 0})};handleEscKey=()=>{this.abortAndRevertDragging()};abortAndRevertDragging=()=>{this.state.draggedPages.forEach((e=>d.ZP.moveToIndex(e.windowId,e,e.index))),setTimeout((()=>{this.cleanupDragging(),this.maybeResetDragging()}),500)};initDragging=({pageX:e,pageY:t},n,s,i)=>{let o;this.context.addEventListener("touchmove",this.handleTouchMove,!0),this.context.addEventListener("mousemove",this.handleMouseMove,!0),this.context.addEventListener("touchend",this.handleMouseUp,!0),this.context.addEventListener("mouseup",this.handleMouseUp,!0),Hi.Z.setWebviewPointerEvents(!1,this.context.document),Di.Z.bind("esc",this.handleEscKey);const{isSelecting:a,isSubstrip:r}=this.props,l=this.props.getSelectedPages(),d=(0,ay.av)(n),c=this.isTabStackingEnabled()&&ie.ZP.isGroup(d,this.context.vivaldiWindowId),h=a&&l.some((e=>e.id===n.id)),p=this.props.prefValues[$.kTabsStackingMode];o=h?l:c&&("dotted"===p||"substrip"===p&&!r||"accordion"===p&&!this.accordionIsOpen(d))?ie.ZP.getGroup(d,this.context.vivaldiWindowId):te.aV.of(n),this.start=[e,t],this.delta=[e-s,t-i],this.setState({draggedActive:n,draggedPages:o,isDragging:!1,mouse:[s,i],yieldBefore:null,yieldAfter:null})};maybeStartDragging=e=>{let{isDragging:t}=this.state;const{tabs:n,direction:s,maxWidth:i,maxHeight:o,prefValues:a}=this.props,{pageX:r,pageY:l}=e,[d,c]=this.start;if(!t){if(!(Math.abs(d-r)>5||Math.abs(c-l)>5))return;t=!0}const h=this.createFlexBoxLayout(n,s,i,o,{freeze:this.state.freeze,pageIdsHiddenForDrag:this.state.pageIdsHiddenForDrag,yieldBefore:this.state.yieldBefore,yieldAfter:this.state.yieldAfter,tabStackingEnabled:this.isTabStackingEnabled(),isThumb:a[$.kTabsThumbnails]}),p=this.props.tabs.find((e=>this.state.draggedActive?.id===e.page.id));if(!p)return;const u="group"===p.type?this.accordionIsOpen(p.id)?String(p.page.id):p.id:String(p.page.id),g={top:0,right:0,bottom:0,left:0,width:0,height:0},m=h.children?.find((e=>"tab"===e.type&&e.tabId===u))?.layout??g,[v,f]=this.delta;let[y,C]=[r-v,l-f];const w=h.children?.filter((e=>"tab"===e.type)),b=(0,spe.Z)(w).layout??g,S=(0,ipe.Z)(w).layout??g;"column"===s&&(y+50<b.left||y-50>S.left)||"row"===s&&(C+50<b.top||C-50>S.top||this.isHorizontalScrollingEnabled()&&this.isMouseOverScrollArrow)?this.startDragging(p,0,0):(y="row"===s?y:m.left,C="column"===s?C:m.top,y=(0,gb.Z)(y,b.left-5,S.left+5),C=(0,gb.Z)(C,b.top-5,S.top+5),this.setState({mouse:[y,C],isDragging:t,isDraggingPinnedTab:p.page.pinned}),this.props.setIsInternalDragging?.(!0),this.detectInternalOverlap(p,m,h,s,y,C))};detectInternalOverlap=async(e,t,n,s,i,o)=>{if(this.#ce)return;const a="accordion"===this.props.prefValues[$.kTabsStackingMode],r=a&&this.accordionIsOpen((0,ay.av)(e.page))?String(e.page.id):String(e.id),l=this.state.draggedPages.map((e=>String(e.id)));let c;for(let e=0;e<n.children?.length;e+=1){const a=n.children[e];if("tab"===a.type&&(a.tabId!==r&&a.layout&&!l.find((e=>e===a.tabId)))){let e;if("row"===s){const{width:n,left:s}=a.layout,o=t.width-n,r=i+(t.left<s?n*The:n*Zhe);e=r>s-o&&r<s+n}else{const{height:n,top:s}=a.layout,i=o+(t.top<s?n*The:n*Zhe);e=i>s&&i<s+n}if(e){c=a;break}}}if(c){const t=this.context.vivaldiWindowId,n=c.page;if(n){const s=this._getPagesFromDraggedSet(),i=(0,ay.av)(n);let o=n.index;if(!this.props.isSubstrip&&i&&!this.accordionIsOpen(i)&&ie.ZP.isGroup(i,t)){const e=ie.ZP.getGroup(i,t);o=o<s.first().index?e.first().index:e.last().index}const r=this.state.draggedPages.size>1;this.#ce=!0,!r&&a&&("string"==typeof i&&this.accordionIsOpen(i)?await(0,ope.V)(e.page.id,{group:i}):await(0,ope.V)(e.page.id,{group:void 0})),await d.ZP.moveToIndex(e.page.windowId,this.accordionIsOpen(i)?e.page:s,o),this.#ce=!1}}else{if(this.isTabStackingEnabled()&&this.props.prefValues[$.kTabsStackingAllowDnd]){const e={...t,left:i,top:o},l=n.children??[];let d,c=0;for(let t=0;t<l.length;t+=1){const n=l[t],{type:s,layout:i}=n,o=a&&n.page&&this.accordionIsOpen((0,ay.av)(n.page));if(i&&"tab"===s&&n.tabId!==r&&!o){if(c=(h=i,p=e,Math.max(0,Math.min(h.left+h.width,p.left+p.width)-Math.max(h.left,p.left))*Math.max(0,Math.min(h.top+h.height,p.top+p.height)-Math.max(h.top,p.top)))/(i.width*i.height),c<Zhe&&c>The){d=n;break}}}if(!d)return this.currentHoveredId=0,this.enterSide="none",this.setState({hoveredPageId:-1}),void(this.dragOverTimeoutId&&this.resetDragOver());const{layout:u,page:g}=d??{};if(!u||!g)return;const{left:m,width:v,top:f,height:y}=u;let C;C="row"===s?i<m+(t.left<m?v*The:v*Zhe)?"before":"after":o<f+(t.top<f?y*The:y*Zhe)?"before":"after";const w=this.enterSide,b=g.id;this.currentHoveredId!==b&&(this.enterSide=C),this.currentHoveredId=b??-1,"none"===w&&w!==C?this.startDragOverTimer(c):w!==C&&this.resetDragOver(),-1!==this.state.hoveredPageId&&this.state.hoveredPageId!==this.currentHoveredId&&(this.resetDragOver(),this.startDragOverTimer(c))}var h,p}};startDragOverTimer=e=>{const t=this.props.prefValues[$.kTabsStackingDndDelay];clearTimeout(this.dragOverTimeoutId),this.dragOverTimeoutId=setTimeout((()=>{this.state.isDragging&&this.setState({hoveredPageId:this.currentHoveredId})}),t)};resetDragOver=()=>{clearTimeout(this.dragOverTimeoutId),delete this.dragOverTimeoutId,this.setState({hoveredPageId:-1})};_getPagesFromDraggedSet=()=>{const e=ie.ZP.getPages(this.context.vivaldiWindowId);return this.state.draggedPages.flatMap((t=>[e.find((e=>e.id===t.id))]))};getDragImageData=(e,t,n)=>{this.#he&&URL.revokeObjectURL(this.#he);const{document:s,HTMLImageElement:i,HTMLSpanElement:o,devicePixelRatio:a}=this.context,r=sb.Z.getUIZoom(),l=s.createElement("canvas"),d=l.getContext("2d"),c=Math.floor((e?.width||180)*r),h=Math.floor(e?.height||27)*r;let p;return l.style.width=`${c}px`,l.style.height=`${h}px`,l.width=Math.floor(c),l.height=Math.floor(h),d.fillStyle=this.props.theme.colorBg,function(e,t,n,s){e.beginPath(),e.moveTo(s,0),e.lineTo(t-s,0),e.quadraticCurveTo(t,0,t,s),e.lineTo(t,n-s),e.quadraticCurveTo(t,n,t-s,n),e.lineTo(s,n),e.quadraticCurveTo(0,n,0,n-s),e.lineTo(0,s),e.quadraticCurveTo(0,0,s,0),e.closePath(),e.clip()}(d,c,h,this.props.theme.radius),d.fill(),d.fillStyle=this.props.theme.colorFg,d.font=12*r+"px system-ui",d.fillText(n,16*r+6*r+4*r,h/2+12*r/3),p=t instanceof i?new Promise(((e,n)=>{const s=new Image;s.crossOrigin="Anonymous",t.srcset?s.srcset=t.srcset:s.src=t.src,s.onload=()=>{const t=6*r/a,n=16*r/a;d.drawImage(s,t,t,n,n),e(d.getImageData(0,0,c,h))},s.onerror=t=>{console.warn(t),e()}})):t instanceof o?new Promise((e=>{this.#he=URL.createObjectURL(new Blob([t.innerHTML],{type:"image/svg+xml"}));const n=new Image;n.onload=()=>{const t=6*r/a,s=16*r/a;d.drawImage(n,t,t,s,s),e(d.getImageData(0,0,c,h))},n.src=this.#he})):Promise.resolve(),d.scale(a,a),{width:c,height:h,imageDataPromise:p}};messageDragging=e=>{G.ZP.isIncognitoOrGuest(this.context.vivaldiWindowId)?this.props.setIsExpectingDrop(e):C.Z.utilities.broadcastMessage(e?{startDragging:!0}:{endDragging:!0})};createDropData=(e,t)=>JSON.stringify({ids:t.map((e=>e.id)).toJS(),active:e.id,activeIndex:e.index,dragSource:this.props.isSubstrip?"stack":"main",sourceWindow:this.context.vivaldiWindowId});startDragging=async(e,t,n)=>{const{Element:s,ClientRect:i}=this.context,{draggedPages:o}=this.state;this.cleanupDragging();const a=o.find((e=>e.active))||o.first();if(!(this.refTabStrip.current instanceof s))return;const r=this.refTabs.get(e.page.id)?.current;if(!r)return;const l=r.refTab.current,d=l instanceof s?l.getBoundingClientRect():void 0,c=(0,ay.av)(a),p=this.isTabStackingEnabled()&&ie.ZP.isGroup(c,this.context.vivaldiWindowId)?4:0,u=r.refFavicon.current,g=je.jk.getDisplayTitleByUrl(a.url,a.title),m=d?.left??0,v=(d?.top??0)-p,{width:f,height:y,imageDataPromise:w}=this.getDragImageData(d,u,g),b=await w;this.setState({isDragging:!0},(()=>{this.messageDragging(!0),this.setupDragEndHandler(o),C.Z.tabsPrivate.startDrag({windowId:this.context.vivaldiWindowId,mimeType:h.Up,customData:this.createDropData(a,o),imageData:b?.data.buffer,url:a.url,title:g,posX:m,posY:v,width:f,height:y,cursorX:t,cursorY:n}),this.setState({pageIdsHiddenForDrag:o.toSet().map((e=>e.id)),isDraggingPinnedTab:e.page.pinned})}))};endInternalDragging=()=>{const{vivaldiWindowId:e}=this.context,t=-1!==this.state.hoveredPageId&&ie.ZP.getPages(e).find((e=>e.id===this.state.hoveredPageId));if(t){let n,s=this._getPagesFromDraggedSet();const i=(0,ay.av)(t);if(n=ie.ZP.isGroup(i,e)?ie.ZP.getGroup(i,e).sort(((e,t)=>e.index-t.index)):te.aV.of(t),n.size>0&&s.size>0){const e=n.first().index,i=s.count((t=>t.index<e)),o=e-i;s=s.first().index<n.first().index?s.concat(n):n.concat(s),d.ZP.createTabStack(s,o,(0,ay.av)(t))}}this.cleanupDragging()};cleanupDragging=()=>{this.context.removeEventListener("touchmove",this.handleTouchMove,!0),this.context.removeEventListener("mousemove",this.handleMouseMove,!0),this.context.removeEventListener("touchend",this.handleMouseUp,!0),this.context.removeEventListener("mouseup",this.handleMouseUp,!0),Hi.Z.setWebviewPointerEvents(!0,this.context.document),Di.Z.unbind("esc",this.handleEscKey),!this.state.isDragging&&this.state.draggedActive?.active&&(this.state.draggedActive.pinned&&"bury"===this.props.prefValues[$.kTabsClosePinned]||this.props.prefValues[$.kTabsMinimize])&&d.ZP.minimizePage(this.context.vivaldiWindowId),this.props.setIsInternalDragging?.(!1),this.#h&&(this.start=[0,0],this.delta=[0,0],this.isMouseOverScrollArrow=!1,this.setState({isDragging:!1,isDraggingPinnedTab:!1,hoveredPageId:-1}))};setupDragEndHandler(e){const t=(n,s,i,o)=>{if(C.Z.tabsPrivate.onDragEnd.removeListener(t),this.messageDragging(!1),n)this.abortAndRevertDragging();else if(s){const t=this.context.vivaldiWindowId;if(e.size===ie.ZP.getPages(t).size)return void this.maybeResetDragging();e.size&&d.ZP.detachPage(e,i,o)}else{const t=i-this.context.screenLeft,n=o-this.context.screenTop,{document:s}=this.context,a=s.elementFromPoint(t,n);a&&"WEBVIEW"===a.tagName&&e.size&&d.ZP.detachPage(e,i,o)}setTimeout((()=>this.maybeResetDragging()),100)};C.Z.tabsPrivate.onDragEnd.addListener(t)}clearForceHover=()=>{this.setState((e=>e.freeze?{freeze:{...e.freeze,nextId:-1}}:null))};getScrollTabWidth=e=>e/Math.round(e/rpe);getTabStyle(e,t,n,s,i){const{prefValues:o,isSubstrip:a}=this.props;if(e){let e;return e=n?cpe:o[$.kTabsHorizontalScrolling]?this.scrollableAreaWidth?this.getScrollTabWidth(this.scrollableAreaWidth)-(s&&"accordion"===o[$.kTabsStackingMode]?16:0):rpe:t?parseInt(o[$.kTabsActiveMinSize])||cpe:void 0,{flex:n?0:1,zIndex:0,maxWidth:n?cpe:rpe,maxHeight:lpe,minHeight:a?lpe:dpe,minWidth:e}}{let e;return e=s&&"off"!==o[$.kTabsStackingMode]&&("dotted"===o[$.kTabsStackingMode]||o[$.kTabsStackingPreferDotted])?37:dpe,{flex:n?0:1,zIndex:0,maxWidth:360,maxHeight:i&&!n?lpe:dpe,minHeight:e,minWidth:void 0}}}createFlexBoxLayout=eo()(((e,t,n,s,i)=>{const o=parseInt(this.props.prefValues[$.kTabsActiveMinSize]),a="row"===t;let r=!this.props.isSubstrip&&e.first()?.page.pinned&&!a&&this.props.prefValues[$.kTabsShowSeparator];const l=this.props.prefValues[$.kTabsStackingMode],d="accordion"===l&&this.props.openAccordions&&this.props.openAccordions.length>0?e.flatMap((e=>{if("group"===e.type&&this.accordionIsOpen((0,ay.av)(e.page))){const t=e.pages.size,n=t-1;return e.pages.map(((e,s)=>({type:"accordionTab",page:e,id:e.id,isFirst:0===s,isLast:s===n,accordionSize:t})))}return[e]})):e,c={style:{flexDirection:t,width:n,height:s},children:d.reduce(((e,t)=>{const d=(!this.props.isSubstrip||"substrip"!==l)&&t.page.pinned,c=t.page.active,h=i.tabStackingEnabled&&!this.props.isSubstrip&&"group"===t.type,p=this.getTabStyle(a,c,d,h,i.isThumb);if(i.freeze&&!d){const e=c&&i.freeze.width<o?o:i.freeze.width,t=i.freeze.height;p.width=p.maxWidth=p.minWidth=e,p.height=p.maxHeight=p.minHeight=t}const{isDragging:u,draggedPages:g,draggedActive:m}=this.state;u&&m&&m.id!==t.page.id&&g.some((e=>e.id===t.page.id))&&(p.width=p.maxWidth=p.minWidth=0,p.height=p.maxHeight=p.minHeight=0);const v=!h&&i.pageIdsHiddenForDrag.has(t.page.id),f=h&&"group"===t.type&&t.pages.every((e=>i.pageIdsHiddenForDrag.has(e.id)));(v||f)&&(a?p.width=p.maxWidth=p.minWidth=0:p.height=p.maxHeight=p.minHeight=0),r&&!d&&(e.push({type:"separator",style:{...p,maxHeight:20,minHeight:20,height:20}}),r=!1);i.yieldBefore===t.page.id&&e.push({type:"blank",style:this.getTabStyle(a,c,d,h,i.isThumb)});const y="accordionTab"===t.type?t.accordionSize:0,C="accordionTab"===t.type&&t.isFirst,w="accordionTab"===t.type&&t.isLast,b="group"===t.type?t.pages:(0,te.aV)();e.push({type:"tab",tabId:t.id.toString(),page:t.page,stackPages:b,style:p,isFirst:C,isLast:w,isStack:h,accordionSize:y}),"accordion"!==l||u||!h&&!t.isLast||v||f||e.push({type:"accordionToggle",page:t.page,style:{width:a?16:n,height:a?s:15,alignSelf:a?"flex-end":"center"}});return i.yieldAfter===t.page.id&&e.push({type:"blank",style:this.getTabStyle(a,c,d,h,i.isThumb)}),e}),[])};return this.isHorizontalScrollingEnabled()&&(!this.isHorizontalScrollingEnabled()||this.state.canScrollLeft||this.state.canScrollRight)||(c.children=c.children.concat({type:"button",style:{width:30,height:30,alignSelf:a?"flex-end":"center"}})),qhe()(c),c}));removeFromTabStack=e=>{if(this.props.isSelecting){const e=this.props.getSelectedPages();e.isEmpty()||d.ZP.removeFromTabStack(e)}else{const t=ie.ZP.getPageById(e);t&&d.ZP.removeFromTabStack(t)}};getDraggedPages=e=>{const{isSelecting:t}=this.props,n=this.props.getSelectedPages();return t&&n.some((t=>t.id===e.id))?n.toArray():[e]};checkSelected=e=>this.props.getSelectedPages().some((t=>t.id===e));getStyles=()=>{const{direction:e,tabs:t,isExpectingDrop:n}=this.props,s=this.props.prefValues[$.kTabsThumbnails],i="row"===e,o=this.createFlexBoxLayout(t,e,this.props.maxWidth,this.props.maxHeight,{pageIdsHiddenForDrag:this.state.pageIdsHiddenForDrag,freeze:this.state.freeze,yieldBefore:this.state.yieldBefore,yieldAfter:this.state.yieldAfter,tabStackingEnabled:this.isTabStackingEnabled(),isThumb:s}),a=[];for(let e=0;e<o.children.length;e++){const s=o.children[e],{layout:r}=s;if(r){if(isNaN(r.left)||isNaN(r.width)||isNaN(r.top)||isNaN(r.height)){0;const t=this.state.freeze?.width??rpe;r.left=i?e*t:0,r.width=t,r.top=i?0:e*dpe,r.height=dpe}switch(s.type){case"tab":{const{tabId:e,page:t,isFirst:n,isLast:i,isStack:o,stackPages:l,accordionSize:d}=s;if(!e||!t)continue;a.push({key:e,data:{type:"tab",page:t,isFirst:n,isLast:i,isStack:o,stackPages:l,zIndex:n||t.active?2:1,accordionSize:d},style:{x:this.maybeSpring(r.left,hpe),y:this.maybeSpring(r.top,hpe),width:r.width,height:r.height}});break}case"blank":a.push({key:`space-${e}`,data:{type:"space"},style:{x:r.left,y:r.top,width:this.state.isDraggingPinnedTab&&i?cpe:r.width,height:r.height}});break;case"button":let o,l;n||t.isEmpty()?(o=r.left,l=r.top):(o=this.maybeSpring(r.left,hpe),l=this.maybeSpring(r.top,hpe)),a.push({key:"button",data:{type:"button"},style:{x:o,y:l,width:r.width,height:r.height}});break;case"separator":a.push({key:"separator",data:{type:"separator"},style:{x:this.maybeSpring(r.left),y:this.maybeSpring(r.top),width:r.width,height:r.height}});break;case"accordionToggle":a.push({key:`accordionToggle-${e}`,data:{type:"accordionToggle",page:s.page},style:{x:r.left,y:i?0:r.top,width:r.width,height:r.height}});break;default:console.warn("Unknown Element",s.type)}}}return a};getFavicon=eo()(((e,t)=>je.jk.getFaviconWithFallback(e,t)),{maxSize:50});getElementStyle=(e,t,n,s,i,o,a,r)=>{const l=r>0&&a?"fixed":void 0;return{"--PositionX":`${Math.floor(e)-r}px`,"--PositionY":`${Math.floor(t)}px`,"--Opacity":n,"--Height":`${Math.floor(s)}px`,"--Width":`${Math.floor(i)}px`,"--ZIndex":o,position:l}};setTabRef=(e,t)=>{if(t){const n=hs.createRef();n.current=t,this.refTabs.set(e,n)}else this.refTabs.delete(e)};getNewTabButtonStyle=eo()(((e,t,n,s,i,o)=>({"--PositionX":`${e}px`,"--PositionY":`${t}px`,"--Opacity":n,"--Height":`${s}px`,"--Width":`${i}px`,"--ZIndex":o,left:`${e}px`,top:`${t}px`})));isHorizontalScrollingEnabled=()=>this.props.prefValues[$.kTabsHorizontalScrolling]&&("top"===this.props.tabPosition||"bottom"===this.props.tabPosition);horizontalScroll=e=>{const t=(this.scrollableAreaWidth??this.props.maxWidth)*("left"===e?-1:1),n=this.refTabStrip.current,{HTMLElement:s}=this.context;n instanceof s&&n.scrollBy(t,0)};scrollRight=e=>{e.stopPropagation(),this.horizontalScroll("right")};scrollLeft=e=>{e.stopPropagation(),this.horizontalScroll("left")};updateScrollStatus=e=>{if(!this.isHorizontalScrollingEnabled())return;const{HTMLDivElement:t}=this.context,n=e??this.refTabStrip.current;if(n instanceof t){const{clientWidth:e,scrollWidth:t,scrollLeft:s}=n,i=n.getBoundingClientRect();this.scrollableAreaWidth=i.width,this.setState({canScrollLeft:s>0,canScrollRight:(s+e)/t<1})}};handleScroll=e=>{this.updateScrollStatus(e.currentTarget)};getOverflowMenu=()=>{const e=this.props.tabs.map((({page:e},t)=>{return{...ae.Z.makeNumberMnemonic((n=je.jk.getDisplayTitle(e),n.length>70?n.substring(0,70)+"...":n),t),url:e.url,handler:()=>this.props.onActivateTab(e)};var n})),t=Pi.getOptionFunction("taboverflow"),n=this.context.vivaldiWindowId;return Pi.getNamedMenu(n,"taboverflow",(async s=>"CONTEXT_CONTAINER_TAB_OVERFLOW"===s.action?{items:e.toArray(),...t(n,s,{})}:{...t(n,s,{})}))};handleWheel=e=>{if(e.deltaX||e.shiftKey||this.props.prefValues[$.kMouseWheelTabSwitch]||!this.isHorizontalScrollingEnabled())return;const{Element:t}=this.context,n=(this.scrollableAreaWidth?this.getScrollTabWidth(this.scrollableAreaWidth):rpe)*(e.deltaY<0?-2:2),s=this.refTabStrip.current;s instanceof t&&s.scrollBy({top:0,left:n,behavior:"smooth"})};setMouseIsOverScrollArrow=()=>{this.state.isDragging&&(this.isMouseOverScrollArrow=!0)};setMouseIsNotOverScrollArrow=()=>{this.state.isDragging&&(this.isMouseOverScrollArrow=!1)};render(){const e=this.props.prefValues[$.kTabsStackingMode],t=this.getStyles(),n=this.isHorizontalScrollingEnabled(),s=this.isTabStackingEnabled(),i={top:"below",bottom:"above",left:"after",right:"before"}[this.props.tabPosition];const o=this.props.prefValues[$.kThemeUseAnimation]?150:0,a=Boolean(!this.props.prefValues[$.kTabsTooltip]||!this.state.pageIdsHiddenForDrag.isEmpty()),r=(0,Oe.Z)("Hold to show open tabs"),l="row"===this.props.direction,{isDraggingPinnedTab:d}=this.state,c=n?this.props.pinnedWidth:0;return(0,fs.jsxs)(fs.Fragment,{children:[n&&ape("div",{className:"toolbar toolbar-tabbar",onMouseEnter:this.setMouseIsOverScrollArrow,onMouseOut:this.setMouseIsNotOverScrollArrow},void 0,ape(Fa,{className:As()("horizontal-scroll-arrow",{disabled:!this.state.canScrollLeft}),style:{paddingRight:c},image:Ts.mgF.medium,onClick:this.scrollLeft,menu:this.getOverflowMenu,menuOrigin:"top"===this.props.tabPosition?"bottomLeft":"topLeft",mimeType:h.Up,edgeAmount:0,tooltip:(0,Oe.Z)("Scroll left")+"\n"+r})),ape(Xhe,{styles:t,children:t=>(0,fs.jsx)("div",{ref:this.refTabStrip,className:As()("tab-strip",{"horizontal-scrolling":n,"horizontal-scrolling-smooth":n&&this.state.animate}),onDragEnter:this.onDragEnterHandler,onDragLeave:this.onDragLeaveHandler,onDragOver:this.onDragOverHandler,onDrop:this.onDropHandler,onDoubleClick:this.state.freeze?to.UW:null,onContextMenu:e=>this.props.onContextMenu(e,this.props.isSubstrip),onWheel:this.handleWheel,onScroll:this.handleScroll,children:t.map(((n,r)=>{const h=n.data;if(h){if("tab"===h.type){const{page:p,stackPages:u=(0,te.aV)(),isStack:g=!1,isFirst:m=!1,isLast:v=!1,accordionSize:f=0}=h,y=p.vivExtData.ext_id,C=p.url,w=this.props.prefValues[$.kTabsShowCloseButton]&&ie.ZP.canClosePage(p),b=(0,ay.av)(p)||"",S=this.state.pageIdsHiddenForDrag.has(p.id),I="accordion"===e&&f>1&&this.accordionIsOpen(b),k=!g&&S,A=g&&u.every((e=>this.state.pageIdsHiddenForDrag.has(e.id))),T=k||A||!this.props.prefValues[$.kTabsVisible],Z=this.props.mediaState.get(p.id)||(0,te.l4)(),E=Boolean(this.state.freeze?.nextId===p.id||this.props.prefValues[$.kTabsCloseButtonPermanent]&&n.style.width>66),_=p.pinned&&!d||d&&!p.pinned?void 0:this.handleTabPosition,M=this.props.isSubstrip||I,N=p.active&&this.props.isSubstripVisible&&!this.props.isSubstrip?p.id+1e3:p.id;let P=0;if(I&&m){let e=0;for(let n=r;n<t.length;n++){const s=t[n],i=s.data;if(e===f)break;0===n&&"space"===i?.type||("tab"===i?.type&&(e+=1),P+=l?s.style.width:s.style.height)}P>0&&!this.state.isDragging&&(P+=16)}const D=g&&s&&"substrip"===e&&!this.props.prefValues[$.kTabsStackingPreferDotted]&&!this.props.isSubstrip,x=this.state.isDragging&&this.state.draggedActive?.id===p.id,[O,L]=this.state.mouse,R=x&&l&&!d?Math.max(O,this.props.pinnedWidth):n.style.x,B=!x||l||d?n.style.y:Math.max(L,this.props.pinnedWidth),F=this.getElementStyle(R,B,n.style.opacity,n.style.height,this.props.isSubstrip&&!l?Math.max(dpe,this.props.maxWidth):n.style.width,h.zIndex,!this.props.isSubstrip&&p.pinned,this.props.isSubstrip?0:c),V=g&&!this.state.isDragging&&!this.props.isSubstrip&&!I&&!this.props.prefValues[$.kTabsStackingPreferDotted]&&("substrip"===e||"accordion"===e);return ape($he,{id:N,noPadding:this.props.isSubstripVisible&&!this.props.isSubstrip,disabled:a||x,pointerEvents:s&&g?"auto":"none",placement:i,appearDelay:200,transitionSpeed:o,disappearDelay:s?200:1,content:()=>this.props.getTooltipContent(N,M),stackSize:u.size},n.key,ape("div",{className:As()("tab-position",{"is-substack":D,"is-pinned":p.pinned}),style:F,onMouseDown:this.handleMouseDown.bind(null,p,n.style.x,n.style.y),onMouseUp:this.handleMouseUpGuard,onAuxClick:this.handleAuxClick.bind(null,p),onClick:this.handleClick.bind(null,p),onDoubleClick:this.handleDoubleClick.bind(null,p),onTouchStart:this.handleTouchStart.bind(null,p,n.style.x,n.style.y)},void 0,(0,fs.jsx)(xhe,{ref:e=>this.setTabRef(p.id,e),id:`tab-${n.key}`,pageId:p.id,url:C,active:p.active,acceptsDrop:p.id===this.state.yieldOver||p.id===this.state.hoveredPageId,discarded:p.discarded,incognito:p.incognito,pinned:p.pinned,isUnread:ie.ZP.isUnread(p),groupId:b,tilingType:p.vivExtData.tiling?.type??"",tilingId:(0,ay.jA)(p)||"",extId:y,faviconUrl:this.getFavicon(C,p.favIconUrl),title:p.title,thumbnail:this.props.prefValues[$.kTabsThumbnails]&&p.vivExtData.thumbnail,stackSize:u.size,isInsideAccordion:I,isFirstInGroup:m,isLastInGroup:v,isExpectingDrop:this.props.isExpectingDrop,isSelecting:this.props.isSelecting,selectionCount:this.props.getSelectedPages().size,isStack:g,isSubstrip:this.props.isSubstrip,isInternalPage:(0,vs.to)(p.url),removeFromTabStack:this.removeFromTabStack,getDraggedPages:this.getDraggedPages,isSelected:this.checkSelected(p.id),checkSelected:this.checkSelected,isHiddenForDrag:S,isHidden:T,smallTab:n.style.width<=66,miniTab:n.style.width<=cpe,highlightId:s?p.id:void 0,direction:this.props.direction,prefValues:this.props.prefValues,tabPosition:this.props.tabPosition,addressBarVisible:this.props.addressBarVisible,highlighted:this.state.highlightedId===`tab-${n.key}`,forceHover:E,clearForceHover:this.clearForceHover,onMoveFocus:this.moveFocus,onStackMenu:this.openStackMenu,onLeaveBar:this.handleLeaveBar,setPageIdsHiddenForDrag:this.setPageIdsHiddenForDrag,closePage:this.closeAndFreeze,onActivate:this.props.onActivateTab,onDragLeave:this.onDragLeaveHandler,droppedTabHandler:this.droppedTabHandler,accordionFrameSize:P,handleTabPosition:_,shouldShowCloseButton:w,onCreateTab:this.props.onCreateTab,handleExpandAccordion:this.props.handleExpandAccordion,handleCompressAccordion:this.props.handleCompressAccordion,doMonitorAlarms:this.state.activeAlarms.has(y),shouldShowStackCounter:V,isDragging:this.state.isDragging,mediaState:Z})))}if("space"===h.type){const e=this.getElementStyle(n.style.x,n.style.y,n.style.opacity,n.style.height,n.style.width,0,!1,c);return ape("div",{className:As()({"tab-position":this.props.isSubstrip||!this.state.yieldOver,"tab-yield-space":this.props.isSubstrip||!this.state.yieldOver}),style:e,onDragEnter:this.onDragEnterHandler,onDragLeave:this.onDragLeaveHandler,onDragOver:this.onDragOverHandler,onDrop:this.onDropHandler},n.key)}if("separator"===h.type){return ape("div",{className:"separator",style:this.getElementStyle(n.style.x,n.style.y,n.style.opacity,n.style.height,n.style.width,0,!1,0)},n.key,upe)}if("accordionToggle"===h.type){const{page:e}=h,t=(0,ay.av)(e),s=this.accordionIsOpen(t),i=s?l?"left":"up":l?"right":"down",o=this.getElementStyle(n.style.x,n.style.y,n.style.opacity,n.style.height,n.style.width,0,e.pinned,c);return ape(nhe,{orientation:i,isActive:e.active,style:o,onClick:()=>this.handleAccordionToggle(t,s),title:s?(0,Oe.Z)("Reduce Tab Stack"):(0,Oe.Z)("Expand Tab Stack")},n.key)}return"button"!==h.type||this.props.isSubstrip&&!this.props.isSubstripVisible?void 0:ape("div",{className:"toolbar toolbar-tabbar toolbar-large tab-position"},n.key,ape(ahe,{id:this.getNewTabButtonId(),style:this.getNewTabButtonStyle(n.style.x-c,this.props.isSubstrip&&"row"===this.props.direction?this.props.maxHeight-dpe:n.style.y,n.style.opacity,n.style.height,n.style.width,0),tabPosition:this.props.tabPosition,onCreateTab:this.props.onCreateTab,onMoveFocus:this.moveFocus,onLeaveBar:this.handleLeaveBar}))}}))})}),n&&(0,fs.jsxs)(fs.Fragment,{children:[ape("div",{onMouseEnter:this.setMouseIsOverScrollArrow,onMouseOut:this.setMouseIsNotOverScrollArrow,className:"toolbar toolbar-tabbar"},void 0,ape(Fa,{className:As()("horizontal-scroll-arrow",{disabled:!this.state.canScrollRight}),image:Ts.Zu.medium,onClick:this.scrollRight,menu:this.getOverflowMenu,menuOrigin:"top"===this.props.tabPosition?"bottomRight":"topRight",mimeType:h.Up,edgeAmount:0,tooltip:(0,Oe.Z)("Scroll right")+"\n"+r})),(this.state.canScrollLeft||this.state.canScrollRight)&&ape("div",{className:"toolbar toolbar-tabbar"},void 0,ape(ahe,{id:this.getNewTabButtonId(),tabPosition:this.props.tabPosition,onCreateTab:this.props.onCreateTab,onMoveFocus:this.moveFocus,onLeaveBar:this.handleLeaveBar}),gpe)]})]})}}const vpe=mpe;class fpe extends hs.PureComponent{static contextType=xi.Z;trashButton=hs.createRef();state={trash:kde.Z.getTrash()};componentDidMount(){kde.Z.addListener(this.onTrashStoreChange),tl.Z.addListener("COMMAND_SHOW_CLOSED_TABS",this._onCommandSpy)}componentWillUnmount(){kde.Z.removeListener(this.onTrashStoreChange),tl.Z.removeListener("COMMAND_SHOW_CLOSED_TABS",this._onCommandSpy)}onTrashStoreChange=()=>{this.setState({trash:kde.Z.getTrash()})};emptyTrash=()=>{as.Z.emptyTrash()};undeleteTab=e=>{as.Z.undeleteTab(e)};undeleteWindow=e=>{as.Z.undeleteWindow(e)};undo=()=>{if(this.state.trash.length>0){const e=this.state.trash[0];e.tab?this.undeleteTab(e.tab):e.window&&this.undeleteWindow(e.window)}};_onCommandSpy=e=>{e===this.context.vivaldiWindowId&&this.trashButton.current&&this.trashButton.current.showMenu()};_getContextMenuPromise=()=>{const e=this.context.vivaldiWindowId,t=Pi.getOptionFunction("closedtab");return Pi.getNamedMenu(e,"closedtab",(async n=>"CONTEXT_CONTAINER_CLOSED_TAB"===n.action?{items:J.Z.getClosedTabContainer(),...t(e,n,{})}:{...t(e,n,{})}))};onDrop=e=>{const t=e.dataTransfer.getData(h.Up);if(t){e.preventDefault(),e.stopPropagation();const n=JSON.parse(t).ids.map((e=>parseInt(e))).map((e=>ie.ZP.getPages(this.context.vivaldiWindowId).find((t=>t.id===e)))).filter(Boolean);d.ZP.closePage((0,te.aV)(n))}};handleContextMenuVisibilityChanged=e=>{e||this.props.onMenuClosed?.()};render(){return(0,fs.jsx)(Fa,{ref:this.trashButton,className:As()("toggle-trash",{hidden:this.props.hidden}),onDrop:this.onDrop,onDragEnter:Aa.Z,onContextMenuVisibilityChanged:this.handleContextMenuVisibilityChanged,image:Ts.nre.large,onMiddleClick:this.undo,menu:this._getContextMenuPromise,menuOrigin:"bottomLeft",mimeType:h.Up,edgeAmount:0,tooltip:(0,Oe.Z)("Show Closed Tabs")+"\n"+(0,Oe.Z)("$1 click to reopen last closed tab",[(0,Oe.Z)("key","Shift")])})}}const ype=fpe;var Cpe,wpe=n(5531),bpe=n(9719),Spe=n(34155);function Ipe(e,t,n,s){Cpe||(Cpe="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Cpe,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const kpe=320,Ape=[$.kAddressBarInlineSearchEnabled,$.kAddressBarShowProgress,$.kKeyboardTabToAll,$.kMediaRouterMediaRemotingEnabled,$.kMouseWheelTabSwitch,$.kPanelsPosition,$.kTabsActiveMinSize,$.kTabsAlignNext,$.kTabsBarWidth,$.kTabsCloseButtonPermanent,$.kTabsClosePinned,$.kTabsCounterDetection,$.kTabsCycleByRecentOrder,$.kTabsDimHibernated,$.kTabsDoubleClickClose,$.kTabsBarHeight,$.kTabsMinimize,$.kTabsPageLoadInfo,$.kTabsNeverCloseLast,$.kTabsSelectionEnabled,$.kTabsBarSliderXpos,$.kTabsBarSliderYpos,$.kTabsHorizontalScrolling,$.kTabsShowCloseButton,$.kTabsShowSeparator,$.kTabsStackingAllowDnd,$.kTabsStackingAllowRename,$.kTabsStackingMode,$.kTabsShowTrashCan,$.kTabsShowSyncedTabsButton,$.kTabsStackingOpenAccordions,$.kTabsStackingSubstripLocked,$.kTabsThumbnails,$.kTabsTooltip,$.kTabsUnread,$.kTabsVisualSwitchEnable,$.kTabsVisible,$.kThemeUseAnimation,$.kTabsStackingPreferDotted,$.kTabsStackingAutoExpand,$.kTabsStackingDndDelay,$.kWorkspacesEnabled,$.kWorkspacesButtonShowInTabbar,$.kWorkspacesButtonShowName,$.kTabsNewPlacement],Tpe=function(e,t,n,s){const i=(0,ay.av)(e)||"",o=i&&("substrip"===n||"accordion"===n)?ie.ZP.getWorkspaceTabsForPages(ie.ZP.getGroup(i,t),s,!0):(0,te.aV)(),a="off"===n,r=ie.ZP.getWorkspaceTabsInWindow(t,s,a);return{tabs:r,pages:ie.ZP.getPages(t),activePageId:e.id,url:e.url,incognito:e.incognito,tilingId:(0,ay.jA)(e)??"",groupId:i,pinned:e.pinned,isSelecting:ie.ZP.isSelecting(t),pageSelection:ie.ZP.getSelection(t),stackTabs:o,pinnedWidth:Zpe(r),workspaceId:s,mediaState:q8.Z.getState()}};function Zpe(e){const t=e.findIndex((e=>!e.page.pinned)),n=H.Z.get($.kTabsStackingOpenAccordions),s="accordion"===H.Z.get($.kTabsStackingMode);let i=0;for(let o=0;o<t;o++){const t=e.get(o);if(!t)return i;i=i+("group"===t.type&&s&&n.includes(t.id)?t.pages.size:1)*cpe+("group"===t.type&&s?16:0)}return i}class Epe extends hs.PureComponent{static contextType=xi.Z;#h;#pe=!1;visibleOnMount=this.props.visible;refMainBar=hs.createRef();refTabBarContainer=hs.createRef();#ue=!1;constructor(e,t){super(e);const n=t.vivaldiWindowId,s=ie.ZP.unsafeGetActivePage(n),i=G.ZP.getActiveWorkspace(n),o=this.props.prefValues[$.kTabsStackingOpenAccordions].map((e=>({groupId:e,auto:!1})));this.state={tabStripWidth:0,tabStripHeight:0,isResizing:!1,tabBarOverflow:!1,tabStripOverflow:!1,tabBarHeight:this.props.prefValues[$.kTabsBarHeight],tabBarWidth:this.props.prefValues[$.kTabsBarWidth],...Tpe(s,n,e.prefValues[$.kTabsStackingMode],i),tabBarSliderYpos:this.props.prefValues[$.kTabsBarSliderYpos],tabBarSliderXpos:this.props.prefValues[$.kTabsBarSliderXpos],tabBarContainerWidth:0,isExpectingDrop:!1,openAccordions:o,isInternalDragging:!1,addressBarVisible:G.ZP.getVisibleUI(n).addressBar,showTrashCan:e.prefValues[$.kTabsShowTrashCan]}}componentDidUpdate(e,t){"top"!==this.props.tabPosition&&"bottom"!==this.props.tabPosition||!0!==this.props.prefValues[$.kTabsThumbnails]||!1!==e.prefValues[$.kTabsThumbnails]||this.setTabBarHeight(lpe),t.openAccordions!==this.state.openAccordions&&Ne.Z.set($.kTabsStackingOpenAccordions,this.state.openAccordions.map((e=>e.groupId))),e.prefValues[$.kTabsStackingMode]===this.props.prefValues[$.kTabsStackingMode]&&t.openAccordions===this.state.openAccordions||this._onPageStoreChange(),e.prefValues[$.kTabsShowTrashCan]!==this.props.prefValues[$.kTabsShowTrashCan]&&this.setState({showTrashCan:this.props.prefValues[$.kTabsShowTrashCan]})}componentDidMount(){const{selectWindow:e}=this.context;C.Z.utilities.onBroadcastMessage.addListener(this.onBroadcastMessageReceived),ie.ZP.addListener(this._onPageStoreChange,e),Jce.addListener(this.onTabStoreChange),G.ZP.addListener(this.onWindowStoreChanged,e),q8.Z.addListener(this._onMediaStateStoreChanged),tl.Z.addListener("COMMAND_SAVE_SELECTED_SESSION",this._onCommandSpy),tl.Z.addListener("COMMAND_BOOKMARK_SELECTED_TABS",this._onCommandSpy),tl.Z.addListener("COMMAND_NEW_TAB",this._onCommandSpy),tl.Z.addListener("COMMAND_SHOW_CLOSED_TABS",this._onCommandSpy),C.Z.tabsPrivate.onKeyboardChanged.addListener(this.handleKeyboardChange),this.updateDocumentTitleById(this.state.activePageId),this.#h=!0,this.context.addEventListener("resize",this.onWindowResize,!1),this.cleanUpOpenAccordions(),0===this.state.tabs.size&&Spe.nextTick((()=>{this.createTab("keyboard")}))}handleKeyboardChange=(e,t,n)=>{this.#pe=0!==n};componentWillUnmount(){C.Z.utilities.onBroadcastMessage.removeListener(this.onBroadcastMessageReceived),ie.ZP.removeListener(this._onPageStoreChange),Jce.removeListener(this.onTabStoreChange),G.ZP.removeListener(this.onWindowStoreChanged),q8.Z.removeListener(this._onMediaStateStoreChanged),tl.Z.removeListener("COMMAND_SAVE_SELECTED_SESSION",this._onCommandSpy),tl.Z.removeListener("COMMAND_BOOKMARK_SELECTED_TABS",this._onCommandSpy),tl.Z.removeListener("COMMAND_NEW_TAB",this._onCommandSpy),tl.Z.removeListener("COMMAND_SHOW_CLOSED_TABS",this._onCommandSpy),C.Z.tabsPrivate.onKeyboardChanged.removeListener(this.handleKeyboardChange),this.#h=!1,this.context.removeEventListener("resize",this.onWindowResize,!1),clearTimeout(this._resizingTimeout)}updateDocumentTitleById=e=>{const t=ie.ZP.getPageById(e);t&&this.updateDocumentTitle(t)};cleanUpOpenAccordions(){const e=this.state.pages.reduce(((e,t)=>(e.push((0,ay.av)(t)),e)),[]),t=(0,wpe.Z)(this.state.openAccordions,"groupId").filter((t=>e.includes(t.groupId)));t.length!==this.state.openAccordions.length&&this.setState((e=>({openAccordions:t})))}updateDocumentTitle=e=>{const t=je.jk.getDisplayTitle(e);t!==this.context.document.title&&(this.context.document.title=t)};onWindowResize=()=>{clearTimeout(this._resizingTimeout),this.setState({isResizing:!0}),this._resizingTimeout=setTimeout((()=>{this.setState({isResizing:!1})}),1e3)};setIsExpectingDrop=(e,t)=>{this.setState({isExpectingDrop:e},t)};closePage=async e=>{this.#ue=!0,await d.ZP.closePage(e),this.#ue=!1,await this._onPageStoreChange(),this.handleClosePageAccordion(e)};handleClosePageAccordion=e=>{if(this.#ue||this.props.prefValues[$.kTabsStackingAutoExpand]||"accordion"!==this.props.prefValues[$.kTabsStackingMode])return;const t=(0,d.nq)(e)?e:te.aV.of(e);0!==t.size&&t.some((e=>{if(e.active){const t=(0,ay.av)(e);return t&&1===this.state.pages.count((e=>(0,ay.av)(e)===t))&&this.handleCompressAccordion(t),!0}}))};onBroadcastMessageReceived=e=>{e.startDragging?this.setIsExpectingDrop(!0):e.endDragging&&this.setIsExpectingDrop(!1,(()=>{this._onPageStoreChange()}))};_onMediaStateStoreChanged=()=>{this.setState({mediaState:q8.Z.getState()})};setTabBarWidth=(e,t=!0)=>{this.setState({tabBarWidth:e},(()=>t&&Ne.Z.set($.kTabsBarWidth,Math.round(e))))};setTabBarHeight=(e,t=!0)=>{this.setState({tabBarHeight:e},(()=>t&&Ne.Z.set($.kTabsBarHeight,Math.round(e))))};setInnerTabBarWidth=(e,t=!0)=>{this.setState({tabBarSliderXpos:e},(()=>t&&Ne.Z.set($.kTabsBarSliderXpos,Math.round(e))))};setInnerTabBarHeight=(e,t=!0)=>{this.setState({tabBarSliderYpos:e},(()=>t&&Ne.Z.set($.kTabsBarSliderYpos,Math.round(e))))};_onPageStoreChange=()=>{if(this.#ue||this.state.isExpectingDrop)return;const e=this.context.vivaldiWindowId,t=ie.ZP.unsafeGetActivePage(e),n=G.ZP.getActiveWorkspace(e);this.updateDocumentTitle(t),this.setState((s=>({...Tpe(t,e,this.props.prefValues[$.kTabsStackingMode],n),openAccordions:this.updateAccordionStatus(s,t)})))};updateAccordionStatus=(e,t)=>{const n=t.id!==this.state.activePageId,s=(0,ay.av)(t);return!n&&s===this.state.groupId||!this.props.prefValues[$.kTabsStackingAutoExpand]||"accordion"!==this.props.prefValues[$.kTabsStackingMode]?e.openAccordions:(0,V.Uy)(e.openAccordions,(e=>{const t=e.findIndex((e=>e.auto));-1!==t&&e.splice(t,1),s&&!e.some((e=>e.groupId===s))&&e.push({groupId:s,auto:!0})}))};isSelecting=()=>this.props.prefValues[$.kTabsSelectionEnabled]&&this.state.isSelecting&&!this.state.pageSelection.isEmpty();getSelectedPages=()=>{if(!this.isSelecting())return(0,te.aV)();const e=ie.ZP.getPages(this.context.vivaldiWindowId,{workspaceId:this.state.workspaceId});return this.state.pageSelection.reduce(((t,n)=>{const s=e.find((e=>e.id===n));return s?t.push(s):t}),(0,te.aV)()).sortBy((e=>e.index))};_onCommandSpy=(e,t)=>{if(e===this.context.vivaldiWindowId)switch(t){case"COMMAND_BOOKMARK_SELECTED_TABS":g.Z.bookmarkPages(this.getSelectedPages(),!1,ps.ZP.getRootNode().id);break;case"COMMAND_SAVE_SELECTED_SESSION":const t=this.getSelectedPages().map((e=>e.id)).toArray();t.length>0&&Ae.Z.showSaveSessionDialog(e,{mode:"ids",ids:t});break;case"COMMAND_NEW_TAB":this.createTab("keyboard");break;case"COMMAND_SHOW_CLOSED_TABS":this.setState({showTrashCan:!0})}};onTabStoreChange=e=>{if(e.winId!==this.context.vivaldiWindowId)return;const t=this.context.vivaldiWindowId,n="off"===this.props.prefValues[$.kTabsStackingMode];switch(e.action){case"switchTabBackBySetting":this.switchBackBySetting(e.event);break;case"switchTabForwardBySetting":this.switchForwardBySetting(e.event);break;case"viewPageSource":this.state.url.startsWith("view-source:")||Spe.nextTick((()=>d.ZP.openURL(e.winId,`view-source:${this.state.url}`,{incognito:this.state.incognito})));break;case"disbandTileGroup":Spe.nextTick((()=>{this.isSelecting()?this.getSelectedPages().map((e=>e.vivExtData.tiling?.id)).filter(Boolean).toSet().forEach((e=>d.ZP.untileTileGroup(t,e))):Spe.nextTick((()=>d.ZP.untileTileGroup(t,this.state.tilingId)))}));break;case"stackCreate":if(n)break;Spe.nextTick((async()=>{if(this.isSelecting())d.ZP.createTabStack(this.getSelectedPages());else{const e=ie.ZP.getPages(t).filter((e=>!(0,ay.av)(e)&&!1===e.pinned));if(e.count()>1){const[s,i]=(0,Tde.d)(ie.ZP.unsafeGetActivePage(t),ie.ZP.getTabs(t,n));if(i.count()>1){const e=ie.ZP.getNewGroupId();await(0,Ade.ZP)(t,e,s),d.ZP.createTabStack(i,void 0,e)}else d.ZP.createTabStack(e)}}}));break;case"stackDissolve":if(n)break;Spe.nextTick((()=>d.ZP.expandTabStack(e.winId,this.state.groupId))),this.handleCompressAccordion(this.state.groupId);break;case"stackRemove":if(n)break;Spe.nextTick((()=>this.removeFromTabStack(this.state.pageSelection)));break;case"stackTileGrid":case"stackTileHorizontal":case"stackTileVertical":const s="stackTileGrid"===e.action?"grid":"stackTileHorizontal"===e.action?"column":"row";Spe.nextTick((()=>{this.isSelecting()?d.ZP.tilePages(this.getSelectedPages(),s):this.state.groupId?d.ZP.tileTabStack(t,this.state.groupId,s):d.ZP.tileLastActive(t,s)}));break;case"tabThumbnail":this.switchTabViewAndEnablePreview();break;case"unloadDialogClosed":this.#ue=!1,this._onPageStoreChange()}};onWindowStoreChanged=()=>{const e=this.context.vivaldiWindowId,t=G.ZP.getVisibleUI(e).addressBar,n=G.ZP.getActiveWorkspace(e);if(n!==this.state.workspaceId){const s=ie.ZP.unsafeGetActivePage(e);this.setState((i=>({addressBarVisible:t,workspaceId:n,...Tpe(s,e,this.props.prefValues[$.kTabsStackingMode],n)})))}else this.setState({addressBarVisible:t,workspaceId:n})};onActivateTab=e=>{if(Ohe.Z.hideTooltip(),e.active)d.ZP.clearSelection(this.context.vivaldiWindowId);else{const t="dotted"===this.props.prefValues[$.kTabsStackingMode];d.ZP.activateTab(e.id,this.context.vivaldiWindowId,t)}};createTab=async(e,t)=>{const n=this.context.vivaldiWindowId;if(t)return void d.ZP.openURL(n,"",{groupId:t});const s=this.props.prefValues[$.kTabsStackingMode],i=ie.ZP.getPageById(this.state.activePageId),o=i&&(0,ay.av)(i);if("dotted"!==s&&"accordion"!==s)if("substrip"!==s)d.ZP.openURL(n,"");else{const t=this.props.prefValues[$.kTabsStackingSubstripLocked]||this.state.stackTabs.size>1;if("mainStrip"===e||!t)return void d.ZP.openURL(n,"");if(o)d.ZP.openURL(n,"",{groupId:o});else{const e=ie.ZP.unsafeGetActivePage(n),t=await d.ZP.createTabStack((0,te.aV)([e]),e.index);d.ZP.openURL(n,"",{groupId:t})}}else o&&"keyboard"===e&&ie.ZP.isGroup(o,n)?d.ZP.openURL(n,"",{groupId:o}):d.ZP.openURL(n,"")};onCreateTab=e=>this.createTab("mainStrip",e);onCreateGroupTab=e=>this.createTab("subStrip",e);removeFromTabStack=e=>{if(this.isSelecting()){const e=this.getSelectedPages();e.isEmpty()||d.ZP.removeFromTabStack(e)}else{const e=ie.ZP.getActivePage(this.context.vivaldiWindowId);e&&d.ZP.removeFromTabStack(e)}};muteTab=(e,t,n)=>{n&&n.stopPropagation(),d.ZP.toggleMuting(e,te.aV.of(t))};closeSingleTab=(e,t)=>{t?.stopPropagation&&t.stopPropagation(),d.ZP.closePage(e)};switchBackBySetting=e=>{this.props.prefValues[$.kTabsVisualSwitchEnable]?this.props.switchTabVisualTabSwitcher(e,!1,this.#pe):this.props.prefValues[$.kTabsCycleByRecentOrder]?Spe.nextTick((()=>d.ZP.cycleByHistory(this.context.vivaldiWindowId,e,{goBack:!0}))):Spe.nextTick((()=>d.ZP.cycleByOrder(this.context.vivaldiWindowId,e,{goBack:!0})))};switchForwardBySetting=e=>{this.props.prefValues[$.kTabsVisualSwitchEnable]?this.props.switchTabVisualTabSwitcher(e,!0,this.#pe):this.props.prefValues[$.kTabsCycleByRecentOrder]?Spe.nextTick((()=>d.ZP.cycleByHistory(this.context.vivaldiWindowId,e,{goBack:!1}))):Spe.nextTick((()=>d.ZP.cycleByOrder(this.context.vivaldiWindowId,e,{goBack:!1})))};switchTabViewAndEnablePreview=()=>{const e=this.props.prefValues[$.kTabsThumbnails],t=this.props.tabPosition,{tabBarWidth:n}=this.state,s="left"===t||"right"===t;e?s?Ne.Z.set($.kTabsThumbnails,!1):this.switchTabView():(Ne.Z.set($.kTabsThumbnails,!0),s&&n===dpe&&this.switchTabView())};switchTabView=()=>{const e=this.props.tabPosition,{tabBarWidth:t,tabBarHeight:n}=this.state;if("top"===e||"bottom"===e){const e=n<75?lpe:dpe;this.setTabBarHeight(e)}else{const e=t!==rpe?rpe:dpe;this.setTabBarWidth(e)}};onSlidebarPosition=(0,oS.Z)(((e,t)=>{const n=this.refTabBarContainer.current,{Element:s}=this.context;if(!(n instanceof s))return;const i=n.getBoundingClientRect();switch(this.props.tabPosition){case"top":this.setTabBarHeight(Math.round(t-i.top),!1);break;case"bottom":this.setTabBarHeight(Math.round(i.bottom-t),!1);break;case"left":this.setTabBarWidth(Math.min(e-i.left,330),!1);break;case"right":this.setTabBarWidth(Math.min(i.right-e,330),!1);break;default:throw new Error("Unknown tabbar position")}}),64);handleSliderDown=()=>{this.setState({isResizing:!0})};handleSliderUp=()=>{this.setState({isResizing:!1}),"top"===this.props.tabPosition||"bottom"===this.props.tabPosition?(Ne.Z.set($.kTabsBarHeight,Math.round(this.state.tabBarHeight)),this.snapToEdge()):Ne.Z.set($.kTabsBarWidth,Math.round(this.state.tabBarWidth))};onInnerSlidebarPosition=(0,oS.Z)(((e,t)=>{const{HTMLElement:n}=this.context,s=this.refMainBar.current?.firstElementChild;if(!(s instanceof n))return;const i=s.getBoundingClientRect(),{tabBarWidth:o,tabBarHeight:a}=this.state;switch(this.props.tabPosition){case"top":t-i.top>a-dpe&&this.setTabBarHeight(t-i.top+31,!1),this.setInnerTabBarHeight((0,gb.Z)(t-i.top,dpe,120),!1);break;case"bottom":i.bottom-t>a-dpe&&this.setTabBarHeight(i.bottom-t+dpe,!1),this.setInnerTabBarHeight((0,gb.Z)(i.bottom-t,dpe,120),!1);break;case"left":e-i.left-dpe>o&&o<330&&this.setTabBarWidth(e-i.left+dpe,!1),this.setInnerTabBarWidth((0,gb.Z)(e-i.left,dpe,330),!1);break;case"right":i.right-e+dpe>o&&o<330&&this.setTabBarWidth(i.right-e+dpe,!1),this.setInnerTabBarWidth((0,gb.Z)(i.right-e,dpe,330),!1);break;default:throw new Error("Unknown tabbar position")}}),64);handleInnerSliderDown=()=>{this.setState({isResizing:!0})};handleInnerSliderUp=()=>{this.setState({isResizing:!1}),"top"===this.props.tabPosition||"bottom"===this.props.tabPosition?(Ne.Z.set($.kTabsBarSliderYpos,Math.round(this.state.tabBarSliderYpos)),this.snapToEdge()):this.setInnerTabBarWidth(this.state.tabBarSliderXpos)};switchInnerTabView=()=>{const e=this.props.tabPosition,{tabBarWidth:t,tabBarHeight:n,tabBarSliderXpos:s}=this.state;if("top"===e||"bottom"===e){const e=n<75?lpe:31;this.setInnerTabBarHeight(e)}else{const e=s!==t/2?t/2:dpe;this.setInnerTabBarWidth(e)}};snapToEdge=()=>{const e=this.refTabBarContainer.current,{HTMLElement:t}=this.context;if(!(e instanceof t))return;let n=parseInt(e.style.height);n>dpe&&n<50?n=31:n<lpe&&n>130&&(n=lpe),this.setTabBarHeight(n)};getGroupHighlightId=(e,t)=>ie.ZP.getGroupHighlightId(e,t);getTabStackThumbnailsContextMenu=(e,t)=>{const n=this.context.vivaldiWindowId,s=Pi.getOptionFunction(e);return Pi.getNamedMenu(n,e,(e=>{switch(e.action){case"CONTEXT_CLOSE":return Promise.resolve({handler:()=>this.closeSingleTab(t),...s(n,e,{})});case"CONTEXT_TABSTACK_REMOVE_FROM":return Promise.resolve({handler:()=>this.removeFromTabStack(this.state.pageSelection),...s(n,e,{})});default:return Promise.resolve({...s(n,e,{})})}}))};getTabBarContextMenu=(e,t)=>{const{prefValues:n}=this.props,s=G.ZP.isGuest(),i=Pi.getOptionFunction(e),o=this.context.vivaldiWindowId;return Pi.getNamedMenu(o,e,(async e=>{switch(e.action){case"CONTEXT_NEW":return{handler:()=>this.createTab(t?"subStrip":"mainStrip"),...i(o,e,{})};case"CONTEXT_TOGGLE_SUBSTRIP_LOCK":{const t=n[$.kTabsStackingSubstripLocked];return{handler:()=>Ne.Z.set($.kTabsStackingSubstripLocked,!t),isVisible:()=>"substrip"===n[$.kTabsStackingMode],checked:t,...i(o,e,{})}}case"CONTEXT_BOOKMARK_ALL":return{handler:()=>g.Z.bookmarkAllOpenPages(this.context.vivaldiWindowId,ps.ZP.getRootNode().id),isVisible:()=>!s,...i(o,e,{})};case"CONTEXT_SAVE_SESSION":return{isVisible:()=>!s,...i(o,e,{})};case"CONTEXT_REOPEN":return{isVisible:()=>Boolean(kde.Z.getTrash().length),...i(o,e,{})};default:return{...i(o,e,{})}}}))};onAuxClick=(e,t)=>{e.button===Hi.Z.kCenter&&this.createTab(t?"subStrip":"mainStrip"),e.preventDefault()};onDoubleClick=(e,t)=>{e.button===Hi.Z.kLeft&&"top"!==this.props.tabPosition&&this.createTab(t?"subStrip":"mainStrip")};getTooltipPlacement=()=>({top:"below",bottom:"above",left:"after",right:"before"}[this.props.tabPosition]);getTooltipMediaState=e=>this.state.mediaState.get(e)||(0,te.l4)();getTooltipContent=(e,t)=>{const n=ie.ZP.getPageById(e);if(!n)return{width:0,height:0,content:null};const{prefValues:s}=this.props;let i,o;const a=(0,nee.xz)(n)&&!t;if("off"!==s[$.kTabsStackingMode]&&a){const e=(0,ay.av)(n);i=ie.ZP.getGroup(e,this.context.vivaldiWindowId),o=e?this.getGroupHighlightId(e,this.context.vivaldiWindowId):null}else i=te.aV.of(n),o=null;const r=!a&&(0,nee.ZN)(n),l=a?Ipe("div",{className:"tab-group"},void 0,i.map((e=>Ipe("div",{className:As()({"tooltip-item":!0,active:e.active,"last-active":o&&o===e.id}),onMouseDown:t=>yhe(this.context,[e],t),onContextMenu:t=>this.onTabStackTooltipContextMenu(e,t),onClick:()=>this.onActivateTab(e),onAuxClick:t=>{t.button===Hi.Z.kCenter&&(t.preventDefault(),t.stopPropagation(),this.closeSingleTab(e))}},e.id,Ipe(c2,{src:e.vivExtData.thumbnail??""}),Ipe("div",{className:"thumbnail-caption"},void 0,this.renderThumbnailText(e),Ipe("span",{className:"thumbnail-buttons"},void 0,Ipe(Ss,{className:"favicon",url:je.jk.getFavicon(e.url)??e.url,loadType:je.jk.getFavicon(e.url)?"faviconFromCache":"page"}),Ipe("button",{className:"close",dangerouslySetInnerHTML:{__html:Ts.kze},tabIndex:s[$.kKeyboardTabToAll],onClick:t=>this.closeSingleTab(e,t)}),this.renderAudioIcon(e))))))):Ipe("div",{className:"tab-solo"},void 0,Ipe("div",{className:As()({"tooltip-item":!0,active:n.active})},"tabbar_tooltip",!r&&Ipe(c2,{src:n.vivExtData.thumbnail??""}),Ipe("div",{className:"thumbnail-caption"},void 0,this.renderThumbnailText(n),Ipe("span",{className:"thumbnail-buttons"},void 0,this.renderAudioIcon(n))))),d=r?dpe:282,c=this.context.innerWidth-("left"===this.props.tabPosition||"right"===this.props.tabPosition?this.getWidth():0),h=this.context.innerHeight-("top"===this.props.tabPosition||"bottom"===this.props.tabPosition?this.getHeight():0);if(!a)return{width:222,height:d,content:l};let p=kpe,u=92*i.count();if(u>h){const e=Math.floor(h/92),t=Math.ceil(i.count()/e);p=kpe*t,u=92*Math.ceil(i.count()/t)}return{width:Math.min(p,Math.floor(c/kpe)*kpe),height:Math.min(u,92*Math.floor(h/92)),content:l}};renderThumbnailText=e=>{const t=je.jk.getDisplayTitle(e);return Ipe("span",{className:"thumbnail-text"},void 0,Ipe("strong",{className:"title"},void 0,t.length>245?t.substring(0,240)+"...":t),!je.jk.isInternalUrl(e.url)&&(0,vs.C3)(e.url)&&Ipe("span",{className:"url"},void 0,new URL(e.url).hostname))};renderAudioIcon=e=>{const t=this.getTooltipMediaState(e.id);return t.has("playing")||t.has("muting")?Ipe("button",{className:"tooltip-audio-button",tabIndex:this.props.prefValues[$.kKeyboardTabToAll],onClick:()=>this.muteTab(this.context.vivaldiWindowId,e)},void 0,Ipe(Qo,{color:this.props.theme.colorFg,animated:this.props.prefValues[$.kThemeUseAnimation],mediaState:t,src:"tab"})):null};getTabDirection=()=>{const e=this.props.tabPosition;return"left"===e||"right"===e?"column":"row"};setOverflowClass=(e,t)=>{t?this.setState({tabStripOverflow:e}):this.setState({tabBarOverflow:e})};onResize=([e])=>{if(!this.#h)return;const t=e.target;this.setState((e=>({tabStripWidth:t.clientWidth,tabStripHeight:t.clientHeight,tabBarContainerWidth:t.parentElement?.clientWidth})))};isSubstripVisible(){const{prefValues:e,visible:t}=this.props;return t&&!this.state.isInternalDragging&&"substrip"===e[$.kTabsStackingMode]&&(e[$.kTabsStackingSubstripLocked]||this.state.stackTabs.size>1)}setIsInternalDragging=e=>{this.setState({isInternalDragging:e})};getScrollbarWidth=()=>this.props.prefValues[$.kThemeSimpleScrollbar]?bpe.eF:bpe.nn;getWidth=()=>{if(!this.props.visible)return 0;const e=this.getScrollbarWidth(),{tabBarWidth:t}=this.state,n=dpe*(this.isSubstripVisible()?2:1)+(this.state.tabBarOverflow?e:0)+(this.state.tabStripOverflow?e:0);return(0,gb.Z)(t,n,360)||n};getHeight=()=>{if(!this.props.visible)return 0;const{tabBarHeight:e}=this.state,t=this.isSubstripVisible()?61:dpe;if(!this.props.prefValues[$.kTabsThumbnails])return t;return(0,gb.Z)(e,t,150)||dpe};clearDisplay=e=>{const t=e[0],{HTMLElement:n}=this.context;t instanceof n&&"none"===t.style.display&&t.style.removeProperty("display")};showSubStack=e=>{const t=ie.ZP.getPageById(e);if(!t)return;const n=(0,ay.av)(t);if(n){const e=ie.ZP.getTabsForPages(ie.ZP.getGroup(n,this.context.vivaldiWindowId),!0);this.setState({stackTabs:e})}else{if(1===this.state.stackTabs.size&&this.state.stackTabs.first().id===t.id)return;const e=te.aV.of({type:"tab",page:t,id:t.id});this.setState({stackTabs:e})}};onContextMenu=(e,t)=>{e.persist(),e.preventDefault(),e.stopPropagation(),this.getTabBarContextMenu("tabbar",t).then((t=>{(0,Qi.Z)(this.context,t)(e)}))};onTabStackTooltipContextMenu=(e,t)=>{t.persist(),t.preventDefault(),t.stopPropagation(),this.getTabStackThumbnailsContextMenu("tabstackthumbnails",e).then((e=>{(0,Qi.Z)(this.context,e)(t)}))};handleExpandAccordion=e=>{this.setState((t=>({openAccordions:t.openAccordions.concat({groupId:e,auto:!1})})))};handleCompressAccordion=e=>{this.setState((t=>({openAccordions:t.openAccordions.filter((t=>t.groupId!==e&&!1===t.auto))})))};handleTrashMenuClosed=()=>{const e=this.props.prefValues[$.kTabsShowTrashCan];e!==this.state.showTrashCan&&this.setState({showTrashCan:e})};toggleAutoExpandAccordion=e=>{e&&this.setState((t=>{const n=t.openAccordions.find((t=>t.groupId===e)),s=!!n&&!n.auto;return{openAccordions:t.openAccordions.filter((t=>t.groupId!==e)).concat({groupId:e,auto:s})}}))};toggleSubstripLock=()=>{Ne.Z.toggle($.kTabsStackingSubstripLocked,!0,!1)};getTabStripWidth=(e,t)=>{const{tabStripWidth:n,showTrashCan:s}=this.state;return"row"===e?t||s?n-32:n-8:n};render(){const e=this.props.prefValues,t=this.getTabDirection(),n=e[$.kTabsShowSyncedTabsButton],s=this.getTabStripWidth(t,n),i="row"===t,o="column"===t,a=o?this.state.tabStripHeight-32:this.state.tabStripHeight,r=o?Math.max(this.state.tabBarWidth-s,32):this.state.tabBarContainerWidth-32,l=this.getScrollbarWidth(),d=o||i&&e[$.kTabsThumbnails],c=this.props.prefValues[$.kTabsStackingSubstripLocked],h=this.isSubstripVisible(),p=c&&this.state.stackTabs.isEmpty()?te.aV.of({type:"tab",page:ie.ZP.unsafeGetActivePage(this.context.vivaldiWindowId),id:this.state.activePageId}):this.state.stackTabs,u=Math.round(h&&o?Math.max(this.getWidth()-this.state.tabBarSliderXpos-(this.state.tabBarOverflow?l:0),dpe):Math.max(this.getHeight()-this.state.tabBarSliderYpos-(this.state.tabBarOverflow?l:0),dpe)),g=e[$.kWorkspacesEnabled]&&e[$.kWorkspacesButtonShowInTabbar],m=i?{height:this.getHeight()}:{width:this.getWidth(),height:"100%"};return Ipe("div",{className:"tabbar-wrapper"},void 0,g&&o&&this.props.visible&&Ipe(mne,{name:"WorkspaceButton",size:"large",popupPosition:"below",inTabbar:!0,maxWidth:this.getWidth()}),(0,fs.jsxs)("div",{id:"tabs-tabbar-container",ref:this.refTabBarContainer,style:m,className:As()({[this.props.visible?this.props.tabPosition:"none"]:!0,accordion:"accordion"===e[$.kTabsStackingMode],dotted:"dotted"===e[$.kTabsStackingMode]||e[$.kTabsStackingPreferDotted]}),children:[(0,fs.jsxs)("div",{id:"tabs-container",ref:this.refMainBar,onAuxClick:e=>this.onAuxClick(e,!1),onDoubleClick:e=>this.onDoubleClick(e,!1),className:As()({overflow:this.state.tabBarOverflow,[this.props.visible?this.props.tabPosition:"none"]:!0}),children:[g&&i&&Ipe(mne,{name:"WorkspaceButton",size:"medium",popupPosition:"bottom"===this.props.tabPosition?"above":"below",inTabbar:!0}),Ipe(Ri,{className:"resize",onResize:this.onResize},void 0,Ipe(vpe,{isSubstrip:!1,isSubstripVisible:h,maxWidth:s,maxHeight:a,direction:t,onActivateTab:this.onActivateTab,getTooltipContent:this.getTooltipContent,getGroupHighlightId:this.getGroupHighlightId,setOverflowClass:this.setOverflowClass,prefValues:e,tabPosition:this.props.tabPosition,isSelecting:this.isSelecting(),isResizing:this.state.isResizing,getSelectedPages:this.getSelectedPages,pages:this.state.pages,tabs:this.state.tabs,switchByScroll:e[$.kMouseWheelTabSwitch],onCreateTab:this.onCreateTab,showSubStack:this.showSubStack,isExpectingDrop:this.state.isExpectingDrop,onContextMenu:this.onContextMenu,setIsExpectingDrop:this.setIsExpectingDrop,activeGroupId:this.state.groupId,openAccordions:this.state.openAccordions,handleExpandAccordion:this.handleExpandAccordion,handleCompressAccordion:this.handleCompressAccordion,toggleAutoExpandAccordion:this.toggleAutoExpandAccordion,closePage:this.closePage,theme:this.props.theme,pinnedWidth:this.state.pinnedWidth,setIsInternalDragging:this.setIsInternalDragging,addressBarVisible:this.state.addressBarVisible,mediaState:this.state.mediaState})),Ipe("div",{className:As()("toolbar toolbar-tabbar sync-and-trash-container",{narrow:o&&s<60})},void 0,!G.ZP.isIncognitoOrGuest(this.context.vivaldiWindowId)&&n&&Ipe(Qce,{tabPosition:this.props.tabPosition}),Ipe(ype,{hidden:!this.state.showTrashCan,onMenuClosed:this.handleTrashMenuClosed})),d&&h&&Ipe(lv,{onSlidebarPosition:this.onInnerSlidebarPosition,onStart:this.handleInnerSliderDown,onStop:this.handleInnerSliderUp,onDoubleClick:this.switchInnerTabView,style:"top"===this.props.tabPosition?{top:a+4}:"bottom"===this.props.tabPosition?{bottom:a-4}:{},position:this.props.tabPosition})]}),h&&Ipe("div",{id:"tabs-subcontainer",onAuxClick:e=>this.onAuxClick(e,!0),onDoubleClick:e=>this.onDoubleClick(e,!0),className:As()({overflow:this.state.tabStripOverflow,[this.props.visible?this.props.tabPosition:"none"]:!0,visible:h}),style:{flexBasis:u}},void 0,Ipe(vpe,{isSubstrip:!0,isSubstripVisible:h,maxWidth:r,maxHeight:u,direction:t,onActivateTab:this.onActivateTab,getTooltipContent:this.getTooltipContent,getGroupHighlightId:this.getGroupHighlightId,setOverflowClass:this.setOverflowClass,prefValues:e,tabPosition:this.props.tabPosition,isSelecting:this.isSelecting(),isResizing:this.state.isResizing,getSelectedPages:this.getSelectedPages,pages:this.state.pages,tabs:p,switchByScroll:e[$.kMouseWheelTabSwitch],onCreateTab:this.onCreateGroupTab,isExpectingDrop:this.state.isExpectingDrop,onContextMenu:this.onContextMenu,setIsExpectingDrop:this.setIsExpectingDrop,activeGroupId:this.state.groupId,closePage:this.closePage,theme:this.props.theme,pinnedWidth:0,addressBarVisible:this.state.addressBarVisible,mediaState:this.state.mediaState}),Ipe("div",{className:As()("toolbar toolbar-tabbar toolbar-large subcontainer-lock",{[this.props.tabPosition]:!0})},void 0,Ipe(Fa,{onClick:this.toggleSubstripLock,menuOrigin:"bottomLeft",className:c?"tabs-locked":"tabs-unlocked",tooltip:c?(0,Oe.Z)("Unlock second tab level"):(0,Oe.Z)("Lock second tab level"),image:c?Ts.zlZ.small:Ts.KuK.small}))),d&&Ipe(lv,{onSlidebarPosition:this.onSlidebarPosition,onStart:this.handleSliderDown,onStop:this.handleSliderUp,onDoubleClick:this.switchTabView,offset:1,position:this.props.tabPosition})]}))}}const _pe=sa(Epe,Ape);var Mpe;function Npe(e,t,n,s){Mpe||(Mpe="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Mpe,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ppe=[$.kMenuDisplay];var Dpe=Npe(Bp,{});class xpe extends hs.PureComponent{static contextType=xi.Z;constructor(e,t){super(e),this.state={altHover:!1,activeTitle:"",activeUrl:""}}componentDidMount(){const{selectWindow:e,vivaldiWindowId:t}=this.context;G.ZP.isSettings(t)||ie.ZP.addListener(this._onPageStoreChange,e)}componentWillUnmount(){ie.ZP.ensureRemovedListener(this._onPageStoreChange)}_onPageStoreChange=()=>{const e=ie.ZP.getActivePage(this.context.vivaldiWindowId);if(e&&e.windowId===this.context.vivaldiWindowId){const t={activeTitle:e.title,activeUrl:e.url};this.state.activeTitle===t.activeTitle&&this.state.activeUrl===t.activeUrl||this.setState(t)}};close=e=>{e.stopPropagation(),cs.Z.close(this.context.vivaldiWindowId)};minimize=e=>{cs.Z.minimize(this.context.vivaldiWindowId)};maximize=e=>{e.persist(),G.ZP.isMaximized(this.context.vivaldiWindowId)||G.ZP.isFullscreen(this.context.vivaldiWindowId)?cs.Z.restore(this.context.vivaldiWindowId):cs.Z.maximize(this.context.vivaldiWindowId)};skipFocusOnSystemButtonMouseDown=e=>{e.preventDefault()};keyDownListener=e=>{e.altKey&&this.setState({altHover:!0})};keyUpListener=e=>{"Alt"===e.key&&this.setState({altHover:!1})};render(){const e=je.jk.getDisplayTitleByUrl(this.state.activeUrl,this.state.activeTitle)||"Vivaldi",t="top"!==this.props.tabPosition?"tabless":null,n=!this.props.isPopupWindow&&"vivaldi"===this.props.prefValues[$.kMenuDisplay];return this.props.isHidden?n?Npe(_ne,{keyAccess:this.props.keyAccess,isHidden:!0}):null:Npe("div",{id:"titlebar",className:t},void 0,n&&Npe(_ne,{keyAccess:this.props.keyAccess,isHidden:!1}),!this.props.native&&Dpe,"top"!==this.props.tabPosition&&("vivaldi"===this.props.prefValues[$.kMenuDisplay]||this.props.isPopupWindow||!1)&&Npe("div",{id:"pagetitle"},void 0,Npe("span",{},void 0,e)))}}const Ope=sa(xpe,Ppe);var Lpe,Rpe=n(34155);function Bpe(e,t,n,s){Lpe||(Lpe="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Lpe,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Fpe=[],Vpe=["MailMsgArchiveRestore","MailMsgStatusRead","MailMsgSpamRestore","MailMsgTrashRestore","Stop","VersionInfo"];class Wpe extends hs.PureComponent{static contextType=xi.Z;state={open:!0,currentToolbar:this.props.toolbar,userCommands:H.Z.get($.kChainedCommandsCommandList),confirmReset:!1};componentDidMount(){H.Z.addListener($.kToolbarsPanel,this.onPrefChanged),Rpe.nextTick((()=>Pf.Z.refreshActiveMessage()))}componentWillUnmount(){H.Z.removeListener($.kToolbarsPanel,this.onPrefChanged),Rpe.nextTick((()=>Pf.Z.refreshActiveMessage()))}changeCurrent=e=>{const{value:t}=e.currentTarget;this.setState({currentToolbar:t})};onClose=()=>Wp.Z.stopEditing();onDragStart=(e,t)=>{e.dataTransfer.setData(Dne,t),e.dataTransfer.setData(Pne,"toolbar-editor")};onConfirmReset=()=>this.setState({confirmReset:!0});onReset=e=>{if(e){const e=bd.ww.find((e=>e.pref===this.state.currentToolbar));if(!e)return;(0,bd.Np)(this.context.vivaldiWindowId,e.pref),Ne.Z.reset(e.pref)}this.setState({confirmReset:!1})};onPrefChanged=()=>{this.state.currentToolbar===$.kToolbarsPanel&&this.forceUpdate()};onEditChains=()=>{Ae.Z.showSettings(this.context.vivaldiWindowId,"qc"),this.onClose()};canRender=e=>{let t=e.filter((e=>!bd.e3.includes(e.id)));return k$.ZP.getSupportsProxy()||(t=t.filter((e=>"Proxy"!==e.id))),t};appendDynamicContent=(e,t)=>{if("panel"===e){const e=H.Z.get($.kToolbarsPanel).filter((e=>Vp.Z.isWebPanel(e))),n=e.map((e=>{const t=ud.ZP.getWebPanels(this.context.vivaldiWindowId).find((t=>t.id===e));if(t)return{id:e,label:t.url};{const t=H.Z.getDefault($.kPanelsWebElements).find((t=>t.id===e));if(t)return{id:e,label:t.url}}})).filter(Boolean),s=t.findIndex((e=>"PanelWeb"===e.id));return-1!==s?t.slice(0,s).concat(n).concat(t.slice(s)):t.concat(n)}return t};render(){const e=H.Z.get($.kMailIsTurnedOff)||!G.ZP.isMail(this.context.vivaldiWindowId),t=bd.ww.filter((t=>e?!t.category.includes("mail"):t)).map((e=>({category:e.category,label:e.label,pref:e.pref})));let n=Vpe;H.Z.get($.kMailIsTurnedOff)&&(n=n.concat(["PanelMail","PanelCalendar","PanelTasks","PanelFeeds","PanelContacts","MailStatus","CalendarStatus"]));const s="chains"!==this.state.currentToolbar?bd.ww.find((e=>e.pref===this.state.currentToolbar)):void 0;return Bpe(_r.Z,{ignoreClickOutside:!0,onRequestClose:this.onClose,viewMode:"toolbar-editor"},void 0,Bpe("header",{className:"dialog-header"},void 0,this.state.confirmReset&&Bpe(SA,{title:(0,Oe.Z)("Reset $1",[s?.label]),prompt:[(0,Oe.Z)("$1 will be reset to default layout.",[s?.label])],positive:(0,Oe.Z)("Reset"),negative:(0,Oe.Z)("Cancel"),onClose:this.onReset,danger:!0}),Bpe("h1",{},void 0,(0,Oe.Z)("Toolbar Editor"),Bpe(jM,{position:"bottom",label:Bpe("div",{},void 0,Bpe("p",{},void 0,(0,Oe.Z)("Choose a set of toolbar buttons, or your Command Chains. Drag buttons to toolbars, rearrange, or remove them from toolbar by dropping them on the background area.")),Bpe("p",{},void 0,(0,Oe.Z)("You can always rearrange toolbar buttons by dragging them while pressing the $1 key.",["Ctrl"])),!1)},void 0," ")),Bpe("select",{defaultValue:this.state.currentToolbar,onChange:this.changeCurrent},void 0,t.map((e=>{const{pref:t,label:n}=e;return Bpe("option",{value:t},t,n)})),Bpe("option",{value:"chains"},void 0,(0,Oe.Z)("Command Chains")))),Bpe("section",{className:"dialog-content toolbar-large"},void 0,s&&this.appendDynamicContent(s.category,this.canRender(s.buttons)).filter((e=>!n.includes(e.id))).map(((e,t)=>Bpe("div",{className:"draggable-button"},t,Bpe(vne,{index:t,name:e.id,label:e.label,menuOrigin:"pointer",popupPosition:"below",size:"large",onDragStart:e=>this.onDragStart(e,t),onDragEnd:Aa.Z,onDrop:Aa.Z,onDragEnter:Aa.Z,customizeMenu:Fpe,mimeType:xa,preview:!0,inEditor:!0,draggable:!0},t),Bpe("span",{},void 0,e.label)))),"chains"===this.state.currentToolbar&&this.state.userCommands.map(((e,t)=>Bpe("div",{className:"draggable-button"},t,Bpe(vne,{index:t,name:e.name,label:e.label,size:"large",onDragStart:e=>this.onDragStart(e,t),onDragEnd:Aa.Z,onDrop:Aa.Z,onDragEnter:Aa.Z,customizeMenu:Fpe,menuOrigin:"pointer",popupPosition:"below",mimeType:xa,preview:!0,inEditor:!0,draggable:!0},e.key),e.label)))),"chains"!==this.state.currentToolbar&&(0,fs.jsxs)(fs.Fragment,{children:[Bpe("h3",{},void 0,(0,Oe.Z)("Default Toolbar Preview")),Bpe("section",{className:"dialog-preview"},void 0,s?.pref&&Bpe("span",{className:"default-toolbar"},void 0,Bpe(Rne,{showDefaultSet:!0,name:s.pref,menuOrigin:"pointer",popupPosition:"below",size:"large"},s.pref)))]}),Bpe("div",{className:"dialog-footer"},void 0,"chains"===this.state.currentToolbar?Bpe("input",{type:"button",value:(0,Oe.Z)("Manage Command Chains"),onClick:this.onEditChains}):Bpe("input",{type:"button",className:"ignore-react-onclickoutside",value:(0,Oe.Z)("Reset $1 to Default",[s?.label]),onClick:this.onConfirmReset}),Bpe("input",{type:"button",className:"primary",value:(0,Oe.Z)("process","Done"),onClick:this.onClose})))}}var Upe;function Hpe(e,t,n,s){Upe||(Upe="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Upe,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class zpe extends hs.PureComponent{componentDidMount(){this._handleShortcutChange(this.props.shortcut.shortcut,!0)}componentWillUnmount(){this._handleShortcutChange(this.props.shortcut.shortcut,!1)}componentDidUpdate(e){this.props.shortcut!==e.shortcut&&(this._handleShortcutChange(e.shortcut.shortcut,!1),this._handleShortcutChange(this.props.shortcut.shortcut,!0))}_handleShortcutChange=(e,t)=>{e&&(t?Di.Z.bind(e,this._handleMenuShortcut):Di.Z.unbind(e,this._handleMenuShortcut))};_getDisplayName=()=>{const e=ae.Z.getMenuBarString(this.props.item,this.props.shortcut);if(this.props.underlineAccessKeys&&-1!==e.offset){const t=e.offset;return Hpe("span",{},void 0,t>0?e.name.substring(0,t):"",Hpe("span",{className:"underlined"},void 0,e.name.substring(t,t+1)),e.name.substring(t+1))}return Hpe("span",{},void 0,e.name)};_handleMenuShortcut=()=>{this.props.onItemActivated(this.props.id)};_handleKeyDown=e=>{const{ctrlKey:t,altKey:n,shiftKey:s,metaKey:i}=e,o={ctrlKey:t,altKey:n,shiftKey:s,metaKey:i};switch(e.key){case"ArrowUp":case"ArrowDown":case"Enter":this.props.onItemActivated(this.props.id);break;case"ArrowLeft":this.props.moveFocus(this.props.id,"left",!1);break;case"ArrowRight":this.props.moveFocus(this.props.id,"right",!1);break;case"Escape":if(-1!==this.props.openMenuId)return;this.props.onLeaveBar();break;default:if((0,co.VV)(o)&&this.props.onAccessKey(e.key))break;return}e.preventDefault(),e.stopPropagation()};_handleMouseDown=e=>{e.button===Hi.Z.kLeft&&Hi.Z.isNoModifierPressed(e)&&this.props.onItemActivated(this.props.id),e.preventDefault(),e.stopPropagation()};_handleMouseEnter=e=>{this.props.onItemEnter(this.props.id)};_handleMouseLeave=e=>{this.props.onItemLeave(this.props.id)};_handleBlur=()=>{this.props.onItemBlur(this.props.id)};_handleFocus=()=>{this.props.highlighted||this.props.onItemHighlightMissing(this.props.id)};render(){return Hpe("button",{"data-id":this.props.id,"data-offset":0,tabIndex:this.props.keyAccess,className:As()({menubarItem:!0,uifocusstop:0===this.props.id,highlighted:this.props.highlighted,menubar:!0}),onBlur:this._handleBlur,onFocus:this._handleFocus,onKeyDown:this._handleKeyDown,onMouseEnter:this._handleMouseEnter,onMouseLeave:this._handleMouseLeave,onMouseDown:this._handleMouseDown},void 0,this._getDisplayName())}}const Gpe=zpe;var $pe,Kpe=n(34155);function jpe(e,t,n,s){$pe||($pe="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:$pe,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ype="menubar";class Xpe extends hs.PureComponent{static contextType=xi.Z;nodeRef=hs.createRef();acceptEnterId=-1;timer=null;hasMenu=!1;#h=!1;constructor(e,t){super(e),this.hasMenu=J.Z.isNamedMenuAvailable(Ype);const n=this._getMenuItems(t.vivaldiWindowId,!1);this.state={items:n,shortcuts:ae.Z.getShortcutsForSubMenus(n),openMenuId:-1,highlightedId:-1,underlineAccessKeys:!1}}componentDidMount(){H.Z.addListener([$.kKeyboardShortcutsAltOpensMenu,$.kMailIsTurnedOff],this._onPrefsChange),J.Z.addListener(this._onCommandStoreChange),this._requestMenu(),this.#h=!0}componentWillUnmount(){this.timer&&clearTimeout(this.timer),H.Z.removeListener([$.kKeyboardShortcutsAltOpensMenu,$.kMailIsTurnedOff],this._onPrefsChange),J.Z.removeListener(this._onCommandStoreChange),this.#h=!1}_requestMenu(){this.hasMenu||v.Z.requestNamedMenu(Ype)}_getMenuItems=(e,t)=>J.Z.getNamedMenu(e,Ype,t).filter((t=>!t.isVisible||t.isVisible(e,!1)));_onPrefsChange=(e,t,n)=>{switch(n){case $.kMailIsTurnedOff:this.setState({items:this._getMenuItems(this.context.vivaldiWindowId,!1)});break;case $.kKeyboardShortcutsAltOpensMenu:this._setupShortcuts(this.state.items)}};_onCommandStoreChange=e=>{switch(e){case"init":this._requestMenu();break;case"menu":this.hasMenu=!0;const e=this._getMenuItems(this.context.vivaldiWindowId,!1);this.setState({items:e,shortcuts:ae.Z.getShortcutsForSubMenus(e)});break;case"shortcut":this._setupShortcuts(this.state.items)}};_handleItemActivated=e=>{Ine.show(this.context,e,this._getSiblings(),"bottom",this._onMenuVisibilityChanged)};_handleItemEnter=e=>{-1!==this.acceptEnterId&&this.acceptEnterId!==e||(sl(this.context.document,this.nodeRef.current)&&this._moveFocus(e,"current",!0),this.setState({highlightedId:e}))};_handleItemLeave=e=>{-1===this.state.openMenuId&&this.setState({highlightedId:-1})};_handleItemBlur=e=>{Kpe.nextTick((()=>{sl(this.context.document,this.nodeRef.current)||this.setState({highlightedId:-1})}))};_handleLeaveBar=()=>{this.setState({highlightedId:-1}),v.Z.executeActions("event",this.context,"COMMAND_FOCUS_WEBVIEW")};_handleDoubleClick=e=>{e.preventDefault(),e.stopPropagation()};_changeFocus=()=>{sl(this.context.document,this.nodeRef.current)?this._handleLeaveBar():this._moveFocus(this.state.highlightedId,"current",!0)};_moveFocus=(e,t,n)=>{const{document:s,HTMLButtonElement:i}=this.context;if(!0===n||sl(s,this.nodeRef.current)){const n=this.state.items.map(((e,t)=>this.state.shortcuts[t]?t:-1)).filter((e=>-1!==e));if(0===n.length)return;if("current"===t){const t=e<0?0:n.indexOf(e);if(-1===t)return;e=n[t]}else if("right"===t||"left"===t){if(1===n.length)return;let s=n.indexOf(e);s="right"===t?s+1>=n.length?0:s+1:s<=0?n.length-1:s-1,e=n[s]}const o=s.querySelector(`button.menubarItem.menubar[data-id="${e}"]`);o&&o instanceof i&&this.setState({highlightedId:e},(()=>o.focus()))}};_handleItemHighlightMissing=e=>{this.setState({highlightedId:e})};_onMenuVisibilityChanged=e=>{this.#h&&(-1===e?(this.acceptEnterId=this.state.openMenuId,this.timer=setTimeout((()=>{this.acceptEnterId=-1,this.timer=null}),100),sl(this.context.document,this.nodeRef.current)?this._moveFocus(this.state.openMenuId,"current",!0):this.setState({highlightedId:-1})):(this.setState({highlightedId:e}),this._moveFocus(e,"current",!1)),this.setState({openMenuId:e}),this._showAccessKeys(!1))};_showAccessKeys=e=>{this.setState({underlineAccessKeys:e})};_setupShortcuts=e=>{this.setState({shortcuts:ae.Z.getShortcutsForSubMenus(e)})};_activateByAccessKey=e=>{for(let t=0;t<this.state.items.length;t++)if(this.state.shortcuts[t]&&this.state.shortcuts[t].key===e)return this._handleItemActivated(t),!0;return!1};_getSiblings=()=>{const e=this._getMenuItems(this.context.vivaldiWindowId,!0);return Array.from(this.context.document.querySelectorAll("button.menubarItem.menubar")).map(((t,n)=>{const s=t.getBoundingClientRect();return{id:parseInt(t.dataset.id),rect:{x:parseInt(s.left),y:parseInt(s.top),width:parseInt(s.width),height:parseInt(s.height)},menu:{items:e[n].items||[],expandId:"",preferred:[]}}}))};renderAll=()=>this.state.items.map(((e,t)=>{if(!this.state.shortcuts[t])return null;const n=0===t?this.props.keyAccess:-1,s=t.toString();return jpe(Gpe,{id:t,keyAccess:n,item:e,shortcut:this.state.shortcuts[t],underlineAccessKeys:this.state.underlineAccessKeys,openMenuId:this.state.openMenuId,highlighted:this.state.highlightedId===t,moveFocus:this._moveFocus,onItemActivated:this._handleItemActivated,onItemEnter:this._handleItemEnter,onItemLeave:this._handleItemLeave,onItemBlur:this._handleItemBlur,onItemHighlightMissing:this._handleItemHighlightMissing,onAccessKey:this._activateByAccessKey,onLeaveBar:this._handleLeaveBar},s)}));render(){return jpe(hs.Fragment,{},void 0,jpe(yne,{changeFocus:this._changeFocus,showAccessKeys:this._showAccessKeys}),(0,fs.jsx)("div",{ref:this.nodeRef,className:As()({menubar:!0,horizontal:this.props.horizontal}),onDoubleClick:this._handleDoubleClick,tabIndex:"-1",children:this.renderAll()}))}}const Qpe=Xpe;var qpe;function Jpe(e,t,n,s){qpe||(qpe="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:qpe,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const eue=[$.kKeyboardTabToAll,$.kMenuIconType];class tue extends hs.PureComponent{static contextType=xi.Z;state={activePage:ie.ZP.unsafeGetActivePage(this.context.vivaldiWindowId)};componentDidMount(){const{selectWindow:e}=this.context;ie.ZP.addListener(this._onPageStoreChange,e)}componentWillUnmount(){ie.ZP.removeListener(this._onPageStoreChange)}_onPageStoreChange=()=>{this.setState({activePage:ie.ZP.unsafeGetActivePage(this.context.vivaldiWindowId)})};close=e=>{e.stopPropagation(),cs.Z.close(this.context.vivaldiWindowId)};render(){return Jpe("div",{className:"topmenu"},void 0,"icon"===this.props.prefValues[$.kMenuIconType]&&Jpe("button",{className:"vivaldi-horizontal-icon",onDoubleClick:this.close,title:(0,Oe.Z)("Double Click to Close"),tabIndex:"-1"},void 0,Jpe("span",{className:"application-icon",dangerouslySetInnerHTML:{__html:Ts.Qa2}}),Jpe("span",{className:"vivaldi-v",dangerouslySetInnerHTML:{__html:n(3783)}})),"burger"===this.props.prefValues[$.kMenuIconType]&&Jpe("button",{className:"vivaldi-horizontal-icon",onDoubleClick:this.close,title:(0,Oe.Z)("Double Click to Close"),tabIndex:"-1"},void 0,Jpe("span",{className:"burger-icon",dangerouslySetInnerHTML:{__html:n(37609)}})),Jpe(Qpe,{horizontal:!0,keyAccess:this.props.prefValues[$.kKeyboardTabToAll]}),Jpe("div",{className:"horizontal-menu-pagetitle"},void 0,je.jk.getDisplayTitle(this.state.activePage)))}}const nue=sa(tue,eue);var sue;function iue(e,t,n,s){sue||(sue="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:sue,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function oue(e){return e.hasOwnProperty("direction")}function aue(e){return e?oue(e)&&"number"!=typeof e?aue(e.first)?.concat(aue(e.second)||[]):[e]:[]}function rue(e,t){if(aue(e.first.second).at(-1)===parseInt(t))return e;if(e?.first===parseInt(t))return e;let n;for(const s in e)if(e.hasOwnProperty(s)&&"object"==typeof e[s]&&(n=rue(e[s],t),n))return n;return n}const lue=function(e){const t=t=>t===e.value,n=(s,i)=>{const{direction:o,first:a,second:r,splitPercentage:l=50}=s,d={gridTemplateRows:"column"===o?`${l}% auto`:" unset",gridTemplateColumns:"row"===o?`${l}% auto`:" unset"};t(s)&&(d.visibility=e.visible?"inherit":"hidden",d.zIndex=e.visible?"initial":-1,d.opacity=e.visible?1:0);const c="number"==typeof a?a:void 0,h="number"==typeof r?r:void 0;return iue("div",{className:As()("tiled",{visible:e.visible&&t(s)}),style:d},void 0,iue("div",{className:"tile","data-id":c},void 0,"number"==typeof a?e.renderTile(a):n(a,"first"),iue(lv,{onSlidebarPosition:(t,n,s)=>((t,n,s)=>{const i=s.target?.parentElement;let o=i.dataset.id;if(i&&!o){const e=i.firstElementChild;e?.querySelectorAll&&(o=[...e.querySelectorAll(".tile[data-id]")].pop().dataset.id)}if(!o)return void console.warn("Unable to locate tile.");const a={...e.value},r=rue(a,parseInt(o));if(r&&"number"!=typeof r&&oue(r)){const s=i.parentElement?.getBoundingClientRect();if(!s)return;switch(r.direction){case"row":const e=(t-s.left)/s.width*100;r.splitPercentage=(0,gb.Z)(e,10,90);break;case"column":const i=(n-s.top)/s.height*100;r.splitPercentage=(0,gb.Z)(i,10,90)}e.onChange(a,e.tilingId)}})(t,n,s),position:"row"===o?"left":"top"})),iue("div",{className:"tile","data-id":h},void 0,"number"==typeof r?e.renderTile(r):n(r,"second")))};return e.value?n(e.value):null};var due=n(69787),cue=n(34540);const hue=(0,no.Z)(cue.Z,500);class pue extends F.Z{getInitialState(){return{}}reduce(e,t){const n=e;switch(t.actionType){case"TILE_INITIALIZED":return{...e,...t.tilesState};case"TILE_SET_LAYOUT":{const{id:n,mosaicLayout:s}=t;e={...e,[n]:s};break}case"PAGE_TILE_PAGES":{const{pages:n,id:s}=t;e=gue(e,n),s||(e=vue(e,n));break}case"CHROME_TABS_CREATE":const n=ie.ZP.getPageById(t.page.id);n&&(e=mue(e,te.aV.of(n)));break;case"PAGE_TILE_REMOVE_PAGES":case"PAGE_TABSTACK_REMOVE_FROM":case"PAGE_CLOSE":{const{pages:n}=t;e=gue(e,n);break}case"PAGE_TABSTACK_CREATE":{const{pages:n}=t;e=mue(e,n);break}default:return e}return e!==n&&hue(t.windowId,{tiles:e}),e}}function uue(e,t){if("object"!=typeof e)return e;if(e.first===t)return"object"==typeof e.second?{...e.second}:e.second;if(e.second===t)return"object"==typeof e.first?{...e.first}:e.first;const n=uue(e.first,t),s=uue(e.second,t);return e.first!==n||e.second!==s?{...e,first:n,second:s}:e}function gue(e,t){return t.reduce(((t,n,s)=>{const i=n.vivExtData.tiling?.id;if(!i||!e[i])return t;const o=t[i],a=uue(o,ie.ZP.getTiles(i,n.windowId).findIndex((e=>e.id===n.id)));if(o===a)return t;if("object"==typeof a)return function(e){(function e(t,n){"object"==typeof t.first?e(t.first,n):t.first=n.count++,"object"==typeof t.second?e(t.second,n):t.second=n.count++})(e,{count:0})}(a),{...t,[i]:a};const r={...t};return delete r[i],r}),e)}function mue(e,t){return vue(e,t)}function vue(e,t){return t.map((e=>(0,ay.jA)(e))).forEach((t=>{t&&e[t]&&delete(e={...e})[t]})),e}function fue(e,t){if(e<2)return;const n=t||(e<4?"row":"grid");if("grid"===n){const t=3===e?2:Math.floor(Math.sqrt(e));return yue((0,lW.Z)(e),t)}return Cue((0,lW.Z)(e),n)}function yue(e,t){if(e.length<=t)return Cue(e,"column");const n=e.slice(0,t),s=e.slice(t),i=n.length/e.length*100;return{direction:"row",first:Cue(n,"column"),second:yue(s,t),...50===i?null:{splitPercentage:i}}}function Cue(e,t){if(1===e.length)return e[0];const n=Math.floor(e.length/2),s=e.slice(0,n),i=e.slice(n),o=s.length/e.length*100;return{direction:t,first:Cue(s,t),second:Cue(i,t),...50===o?null:{splitPercentage:o}}}const wue=new pue;var bue,Sue=n(77398);function Iue(e,t,n,s){bue||(bue="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:bue,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const kue=function(e){return{activePageId:ie.ZP.getActivePage(e)?.id??0,pages:ie.ZP.getPages(e)}};class Aue extends hs.PureComponent{static contextType=xi.Z;constructor(e,t){super(e);const n=(0,Sue.Z)(H.Z.get($.kPanelsState),["width"],0);this.state={...kue(t.vivaldiWindowId),contentWidth:t.innerWidth-n,contentHeight:t.innerHeight,tiles:wue.getState()}}async componentDidMount(){const{selectWindow:e}=this.context;ie.ZP.addListener(this._onPageStoreChange,e),wue.addListener(this._onTilingStoreChange)}componentWillUnmount(){ie.ZP.removeListener(this._onPageStoreChange),wue.removeListener(this._onTilingStoreChange)}_onPageStoreChange=()=>{const e=kue(this.context.vivaldiWindowId);this.setState(e)};_onTilingStoreChange=()=>{this.setState({tiles:wue.getState()})};onResize=e=>{const t=e[0].target;let n,s;if(t&&t.clientWidth&&t.clientHeight)n=t.clientWidth,s=t.clientHeight;else{const e=(0,Sue.Z)(H.Z.get($.kPanelsState),["width"],0);n=this.context.innerWidth-e,s=this.context.innerHeight}this.setState({contentWidth:n,contentHeight:s})};handleFocus=e=>{e&&e.nativeEvent&&e.nativeEvent.relatedTarget&&"WEBVIEW"===e.nativeEvent.relatedTarget.tagName&&!0===this.props.cycleFocus&&Vv.Z.doAction(this.context.vivaldiWindowId,this.state.activePageId,"focusWebView")};onMosaicLayoutChange=(e,t)=>{due.Z.setTileLayout(this.context.vivaldiWindowId,e,t)};getLayoutSize(e){return"number"==typeof e.second?e.second+1:this.getLayoutSize(e.second)}renderTileSet=e=>{const t=e.map(ay.jA).toSet(),n=ie.ZP.getPageById(this.state.activePageId),s=n?(0,ay.jA)(n):void 0;return t.map((e=>{if(!e)return;const t=ie.ZP.getTiles(e,this.context.vivaldiWindowId).sortBy((e=>e.index)).map((e=>this.renderPage(e))),i=e===s;let o=this.state.tiles[e];if(n&&i&&(!o||this.getLayoutSize(o)!==t.size)){const s=n.vivExtData.tiling?.layout;o=fue(t.size,s),o&&due.Z.setTileLayout(this.context.vivaldiWindowId,o,e)}return o?Iue(lue,{tilingId:e,visible:i,renderTile:e=>t.get(e,null),value:o,onChange:this.onMosaicLayoutChange},e):null}))};renderPage=e=>{const t=(0,nee.ZN)(e);return Iue(cee,{id:e.id,pageContext:e.context,url:e.url,target:e.target,vivExtData:e.vivExtData,showImageInspector:e.showImageInspector,discarded:e.discarded,contentWidth:this.state.contentWidth,contentHeight:this.state.contentHeight,isVisible:t,isActive:e.active,supportsReaderMode:e.supportsReaderMode,pinned:e.pinned},`page-component-${e.id}`)};render(){const e=hs.Fragment,t=this.props.cycleFocus?"0":"-1",[n,s]=this.state.pages.partition((e=>{const t=(0,ay.jA)(e);return t&&ie.ZP.getTiles(t,this.context.vivaldiWindowId).size>1}));return Iue(e,{},"webpage__collection",Iue("span",{tabIndex:t,onFocus:this.handleFocus}),Iue(Ri,{id:"webpage-stack",onResize:this.onResize},void 0,s.size>0&&this.renderTileSet(s),n.size>0&&n.sortBy((e=>e.id)).map(this.renderPage)),Iue("span",{tabIndex:t,onFocus:this.handleFocus}))}}const Tue=Aue;var Zue=n(40893);const Eue=e=>{let t=e;return t&&(t=t.replace(/^data\:([^\;]+)\;base64,/gim,"")),t};function _ue(e,t,n){return{isVisible:()=>!e.isGuest&&n.selection.length>0,isEnabled:()=>W3.ZP.hasNotes(),handler:()=>{Ae.Z.showNoteSelectionDialog(e.winId,{onSelected:e=>Nn.Z.appendToNode(e,n.selection)})}}}const Mue=(e,t,n,s=9,i)=>{const o=Eue(n.faviconUrl);return{handler:()=>{Rs.setSearchEngine(e,n),Zue.Z.withTextAndEngine(e,t,n.id)},emphasized:n.id===i?.id,iconPNG:o,iconPNGWhite:o,...ae.Z.makeNumberMnemonic(n.name,s)}},Nue=(e,t)=>{if(0===t.length)return[];const n=Rs.getSearchEngine(e,!0);return Gn.Z.get().map(((s,i)=>Mue(e,t,s,i,n)))},Pue=e=>[{commandName:"DOCUMENT_DIRECTION_DEFAULT",type:"checkbox",...(0,xs.Z)("command","Default")},{commandName:"DOCUMENT_DIRECTION_LTR",type:"checkbox",...(0,xs.Z)("Left to Right")},{commandName:"DOCUMENT_DIRECTION_RTL",type:"checkbox",...(0,xs.Z)("Right to Left")}],Due=e=>[{commandName:"DOCUMENT_LOOP",type:"checkbox",...(0,xs.Z)("context","Loop")},{commandName:"DOCUMENT_SHOW_CONTROLS",type:"checkbox",...(0,xs.Z)("Show Controls")},ae.Z.separatorItem,{commandName:"DOCUMENT_OPEN_AV_NEW_TAB",...e.support.audio?(0,xs.Z)("Open Audio in New Tab"):(0,xs.Z)("Open Video in New Tab")},{commandName:"DOCUMENT_SAVE_AV",ellipsis:!0,...e.support.audio?(0,xs.Z)("Save Audio As"):(0,xs.Z)("Save Video As")},{commandName:"DOCUMENT_COPY_AV_ADDRESS",ellipsis:!0,...e.support.audio?(0,xs.Z)("Copy Audio Address"):(0,xs.Z)("Copy Video Address")},{commandName:"DOCUMENT_CAST",ellipsis:!0,...(0,xs.Z)("Cast")},ae.Z.separatorItem,{commandName:"DOCUMENT_PICTURE_IN_PICTURE",isVisible:()=>e.support.video&&e.support.pictureinpicture,...(0,xs.Z)("Picture in Picture")}],xue=async(e,t,n,s,i)=>{switch(s.action){case"DOCUMENT_CONTAINER_DEVELOPER_TOOLS":return{isVisible:()=>!n&&!t.isdevtools,items:await Oue(e,t,n,i),...i(e.winId,s,t)};case"DOCUMENT_VALIDATE_URL":return{isVisible:()=>!(t.iswebpanel||t.isimage||t.isdevtools||t.ismailcontent),handler:()=>{const n=E.Z.getSync("VALIDATION_URL");d.ZP.openURL(e.winId,n.replace("%s",t.pageurl),{inCurrent:!1})},...i(e.winId,s,t)};case"DOCUMENT_VIEW_SOURCE":{const n=t.isimage&&t.pageurl===t.srcurl;return{isVisible:()=>!n&&!t.isdevtools&&!t.ismailcontent,commandName:"DOCUMENT_VIEW_SOURCE",...i(e.winId,s,t)}}case"DOCUMENT_VIEW_FRAME_SOURCE":return{isVisible:()=>t.isframe&&!t.isdevtools&&!t.ismailcontent,commandName:"DOCUMENT_VIEW_FRAME_SOURCE",...i(e.winId,s,t)};case"DOCUMENT_RELOAD_FRAME":return{isVisible:()=>t.isframe&&!t.isdevtools&&!t.ismailcontent,commandName:"DOCUMENT_RELOAD_FRAME",...i(e.winId,s,t)};case"DOCUMENT_INSPECT":return{commandName:"DOCUMENT_INSPECT",isVisible:()=>!t.isdevtools,...i(e.winId,s,t)};default:return Promise.resolve({...i(e.winId,s,t)})}},Oue=async(e,t,n,s)=>Promise.all(["DOCUMENT_VALIDATE_URL","DOCUMENT_VIEW_SOURCE","DOCUMENT_VIEW_FRAME_SOURCE","DOCUMENT_RELOAD_FRAME","DOCUMENT_INSPECT"].map((i=>xue(e,t,n,{id:"",type:"command",action:i},s)))),Lue=e=>[{commandName:"DOCUMENT_LANGUAGE_SETTINGS",...(0,xs.Z)("Language Settings")}],Rue=async(e,t,n,s,i)=>{switch(s.action){case"DOCUMENT_LOOK_UP":return{isVisible:()=>e.isMac&&t.printableselection.length>0&&!n,...i(e.winId,s,t)};case"DOCUMENT_COPY":case"DOCUMENT_PRINT":return{...i(e.winId,s,t)};case"DOCUMENT_CONTAINER_LINK_TO_HIGHLIGHT":return{container:{content:"linktohighlight"},isVisible:()=>!t.ismailcontent,...i(e.winId,s,t)};case"DOCUMENT_GOTO_URL":return{handler:()=>{d.ZP.openURL(e.winId,t.selectionurl,{inCurrent:!1,inBackground:H.Z.get($.kTabsOpenNewInBackground)})},isVisible:()=>t.selectionurl.length>0,...i(e.winId,s,t)};case"DOCUMENT_SEARCH":case"DOCUMENT_SEARCH_LAST_USED":{const n=Rs.getSearchEngine(e.winId,"DOCUMENT_SEARCH_LAST_USED"===s.action);return n?{...Mue(e.winId,t.selection,n),mnemonic:!0,...i(e.winId,s,t)}:Promise.reject()}case"DOCUMENT_CONTAINER_SEARCH_WITH":return{items:Nue(e.winId,t.selection),...i(e.winId,s,t)};case"DOCUMENT_CONTAINER_EXTENSIONS":return{isVisible:()=>!t.iswebpanel&&t.support.extensions&&!n,container:{content:"extensions"},...i(e.winId,s,t)};case"DOCUMENT_SEND_BY_MAIL":return{handler:()=>{ke.Z.createDraft({subject:t.pagetitle||t.pageurl,body:`${t.selection} \n\n ${t.pageurl}`})},isVisible:()=>!H.Z.get($.kMailIsTurnedOff),...i(e.winId,s,t)};case"COMMAND_COPY_SELECTION_TO_NOTE":{const n={...i(e.winId,s,t)};return t.ismailcontent&&(n.handler=()=>{const n=u.Z.getActiveMessageUrl();Nn.Z.createNote(e.winId,{content:t.selection,url:n,type:"note"})}),n}case"COMMAND_APPEND_SELECTION_TO_NOTE":return{...i(e.winId,s,t),...t.ismailcontent?_ue(e,0,t):null};case"DOCUMENT_ADD_TO_CALENDAR":return{handler:()=>{m.Z.showAddEvent(e.winId,t.selection,t.pageurl)},isVisible:()=>!e.isGuest&&!H.Z.get($.kMailIsTurnedOff),...i(e.winId,s,t)};case"DOCUMENT_CONTAINER_SPEECH":return{isVisible:()=>e.isMac,container:{content:"speech"},...i(e.winId,s,t)};case"COMMAND_FULLSCREEN":return{...i(e.winId,s,t),isVisible:()=>!n};case"COMMAND_TRANSLATE_SELECTION":{const{id:n,url:o}=ie.ZP.unsafeGetActivePage(e.winId);return{isVisible:()=>NI.ZP.canTranslateText(t.selection,o,n),...i(e.winId,s,t),handler:()=>{os.Z.translateSelection(e.winId,n,t.selection)}}}default:return Bs.actions().includes(s.action)?xue(e,t,n,s,i):Promise.resolve({...i(e.winId,s,t)})}},Bue=async(e,t,n,s,i)=>{switch(s.action){case"DOCUMENT_OPEN_IMAGE_IN_TAB":return{isVisible:()=>!t.ismailcontent,...i(e.winId,s,t)};case"DOCUMENT_OPEN_IMAGE_IN_NEW_TAB":return{isVisible:()=>!e.isPopup,...i(e.winId,s,t)};case"DOCUMENT_OPEN_IMAGE_IN_NEW_BACKGROUND_TAB":return{isVisible:()=>!e.isPopup&&!H.Z.get($.kTabsOpenNewInBackground),...i(e.winId,s,t)};case"DOCUMENT_OPEN_IMAGE_IN_NEW_WINDOW":return{isVisible:()=>!e.isIncognito||e.isGuest,...i(e.winId,s,t)};case"DOCUMENT_OPEN_IMAGE_IN_PRIVATE_WINDOW":return{isVisible:()=>!e.isGuest,...i(e.winId,s,t)};case"DOCUMENT_CONTAINER_OPEN_IMAGE_IN_PROFILE":return{container:{content:"imageinprofile"},...i(e.winId,s,t)};case"DOCUMENT_SEARCH_FOR IMAGE":{const n=Gn.Z.getImageSearch(),o=n?Eue(n.faviconUrl):"";return{isVisible:()=>Boolean(n?.imageUrl),iconPNG:o,iconPNGWhite:o,...i(e.winId,s,t)}}case"DOCUMENT_SHOW_IMAGE_PROPERTIES":return{handler:async()=>{const n=ie.ZP.getActivePage(e.winId);if(n){const s=n.windowId;if(ie.ZP.isDisplayingImage(n.id))d.ZP.setImageInspector(n.id,s,!0);else{await d.ZP.openURL(e.winId,t.srcurl,{inCurrent:!1,transition:C.Z.historyPrivate.TransitionType.AUTO_TOPLEVEL}),await new Promise((t=>{const n=()=>{ie.ZP.removeListener(n),t()};ie.ZP.addListener(n,(t=>t.get(e.winId)))}));const n=ie.ZP.getPages(s).last();d.ZP.setImageInspector(n.id,s,!0)}}},isVisible:()=>!e.isPopup,isEnabled:()=>t.isimage,...i(e.winId,s,t)};case"DOCUMENT_USE_IMAGE_AS_STARTPAGE_BACKGROUND":return{handler:()=>{is.Z.setThemeBackgroundImageFromUrl(e.winId,t.srcurl)},...i(e.winId,s,t)};case"DOCUMENT_QR_CODE":return{isVisible:()=>t.support.qrcode&&!e.isPopup,...i(e.winId,s,t)};case"DOCUMENT_CONTAINER_TEXT_SELECTION":return t.selection.length>0?{items:await Uue(e,t,!0),...i(e.winId,s,t)}:{items:[],isVisible:()=>!1,...i(e.winId,s,t)};case"DOCUMENT_CONTAINER_EXTENSIONS":return{isVisible:()=>!t.iswebpanel&&t.support.extensions&&!n,container:{content:"extensions"},...i(e.winId,s,t)};case"COMMAND_FULLSCREEN":return{...i(e.winId,s,t),isVisible:()=>!n};default:return Bs.actions().includes(s.action)?xue(e,t,n,s,i):Promise.resolve({...i(e.winId,s,t)})}},Fue=async(e,t,n,s,i)=>{switch(s.action){case"DOCUMENT_CONTAINER_AV":return{items:Due(t),...i(e.winId,s,t)};case"DOCUMENT_CONTAINER_EXTENSIONS":return{isVisible:()=>!t.iswebpanel&&t.support.extensions&&!n,container:{content:"extensions"},...i(e.winId,s,t)};default:return Bs.actions().includes(s.action)?xue(e,t,!1,s,i):Promise.resolve({...i(e.winId,s,t)})}},Vue=(e,t,n)=>{const s="image",i=Pi.getOptionFunction(s);return Pi.getNamedMenu(e.winId,s,(async s=>Bue(e,t,n,s,i)))},Wue=({winId:e},{linkurl:t})=>{const n=[],s=G.ZP.getActiveWorkspace(e),i=Kj.Z.getWorkspaces(e).filter((e=>e.id!==s));s&&i.length>0&&n.push({handler:async()=>{await d.ZP.newTab(e,t,{workspaceId:void 0})},...(0,xs.Z)("This Window")});for(let s=0;s<i.length;s++){const o=i[s];n.push({handler:async()=>{const n=Kj.Z.getWindowId(o.id)??e;await cs.Z.setActiveWorkspace(e,o.id),await d.ZP.newTab(n,t,{workspaceId:o.id,ignoreLinkRouting:!0})},label:o.name,labelEnglish:o.name})}return n},Uue=(e,t,n)=>{const s="selection",i=Pi.getOptionFunction(s);return Pi.getNamedMenu(e.winId,s,(async s=>Rue(e,t,n,s,i)))},Hue={show:(e,t,n)=>{const i=(e,t,n,s)=>{(0,Qi.Z)(e,n,void 0,"pointer",void 0,t,s)()},o={winId:e.vivaldiWindowId,isGuest:G.ZP.isGuest(),isIncognito:G.ZP.isIncognito(e.vivaldiWindowId),isPopup:G.ZP.isPopup(e.vivaldiWindowId),isMac:!1};n.iseditable?"regular"===n.textfield?((e,t)=>{const n="uiedit",s=Pi.getOptionFunction(n);return Pi.getNamedMenu(e.winId,n,(async n=>{switch(n.action){case"DOCUMENT_CONTAINER_SPELLCHECK":return{container:{content:"spellcheck"},...s(e.winId,n,t)};case"DOCUMENT_LOOK_UP":return{isVisible:()=>e.isMac&&t.printableselection.length>0,...s(e.winId,n,t)};case"DOCUMENT_EMOJI":return{isVisible:()=>t.support.emoji,...s(e.winId,n,t)};case"DOCUMENT_CONTAINER_NOTES":return{container:{content:"notes"},isVisible:()=>!e.isGuest,...s(e.winId,n,t)};case"DOCUMENT_CONTAINER_SPELLCHECK_OPTIONS":return e.isMac?{isVisible:()=>t.support.editoptions,items:Lue(),...s(e.winId,n,t)}:{isVisible:()=>t.support.editoptions,container:{content:"spellcheckoptions"},...s(e.winId,n,t)};case"DOCUMENT_CONTAINER_WRITING_DIRECTION":return{isVisible:()=>t.support.editoptions,items:Pue(),...s(e.winId,n,t)};case"DOCUMENT_CONTAINER_SPEECH":return{isVisible:()=>e.isMac,container:{content:"speech"},...s(e.winId,n,t)};case"COMMAND_COPY_SELECTION_TO_NOTE":return{...s(e.winId,n,t),isVisible:()=>!e.isGuest&&t.selection.length>0,handler:()=>{Nn.Z.createNote(e.winId,{content:t.selection,url:"",type:"note"})}};case"COMMAND_APPEND_SELECTION_TO_NOTE":return{...s(e.winId,n,t),..._ue(e,0,t)};case"COMMAND_TRANSLATE_SELECTION":{const{id:i,url:o}=ie.ZP.unsafeGetActivePage(e.winId);return{isVisible:()=>NI.ZP.canTranslateText(t.selection,o,i),...s(e.winId,n,t),handler:()=>{os.Z.translateSelection(e.winId,i,t.selection)}}}default:return Promise.resolve({...s(e.winId,n,t)})}}))})(o,n).then((n=>{i(e,t,n)})):["addressfield","searchfield"].includes(n.textfield)?((e,t)=>{const n="urledit",s=Pi.getOptionFunction(n);return Pi.getNamedMenu(e.winId,n,(async n=>{switch(n.action){case"DOCUMENT_CONTAINER_SPELLCHECK":return{container:{content:"spellcheck"},...s(e.winId,n,t)};case"DOCUMENT_LOOK_UP":return{isVisible:()=>e.isMac&&t.printableselection.length>0,...s(e.winId,n,t)};case"DOCUMENT_EMOJI":return{isVisible:()=>t.support.emoji,...s(e.winId,n,t)};case"COMMAND_CLIPBOARD_PASTE_AS_PLAIN_TEXT_OR_PASTE_AND_GO":return{...s(e.winId,n,t),isEnabled:()=>t.support.paste};case"DOCUMENT_CONTAINER_NOTES":return{container:{content:"notes"},isVisible:()=>!e.isGuest,...s(e.winId,n,t)};case"DOCUMENT_CONTAINER_SPELLCHECK_OPTIONS":return e.isMac?{isVisible:()=>t.support.editoptions,items:Lue(),...s(e.winId,n,t)}:{isVisible:()=>t.support.editoptions,container:{content:"spellcheckoptions"},...s(e.winId,n,t)};case"DOCUMENT_CONTAINER_WRITING_DIRECTION":return{isVisible:()=>t.support.editoptions,items:Pue(),...s(e.winId,n,t)};case"DOCUMENT_CUSTOMIZE":const i="addressfield"===t.textfield?"addressbar":"search";return{isVisible:()=>!e.isGuest,handler:()=>Ae.Z.showSettings(e.winId,i),...s(e.winId,n,t)};case"DOCUMENT_SHOW_FULL_ADDRESS":const o=H.Z.get($.kAddressBarShowFullUrl);return{isEnabled:()=>!e.isGuest,checked:o,isVisible:()=>"addressfield"===t.textfield,handler:()=>{Ne.Z.set($.kAddressBarShowFullUrl,!o)},...s(e.winId,n,t)};case"DOCUMENT_CONTAINER_SPEECH":return{isVisible:()=>e.isMac,container:{content:"speech"},...s(e.winId,n,t)};case"COMMAND_COPY_SELECTION_TO_NOTE":return{isVisible:()=>!e.isGuest&&t.selection.length>0,...s(e.winId,n,t),handler:()=>{Nn.Z.createNote(e.winId,{content:t.selection,url:"",type:"note"})}};case"COMMAND_APPEND_SELECTION_TO_NOTE":return{...s(e.winId,n,t),..._ue(e,0,t)};case"COMMAND_TRANSLATE_SELECTION":{const{id:i,url:o}=ie.ZP.unsafeGetActivePage(e.winId);return{isVisible:()=>NI.ZP.canTranslateText(t.selection,o,i),...s(e.winId,n,t),handler:()=>{os.Z.translateSelection(e.winId,i,t.selection)}}}default:return Promise.resolve({...s(e.winId,n,t)})}}))})(o,n).then((n=>{i(e,t,n)})):((e,t)=>{const n="docedit",s=Pi.getOptionFunction(n);return Pi.getNamedMenu(e.winId,n,(async n=>{switch(n.action){case"DOCUMENT_SUGGEST_PASSWORD":return{isVisible:()=>t.support.passwordgeneration,...s(e.winId,n,t)};case"DOCUMENT_SHOW_PASSWORDS":return{isVisible:()=>t.support.passwordshowall,handler:()=>Ae.Z.showSettings(e.winId,"privacy"),...s(e.winId,n,t)};case"DOCUMENT_CONTAINER_SPELLCHECK":return{container:{content:"spellcheck"},...s(e.winId,n,t)};case"DOCUMENT_LOOK_UP":return{isVisible:()=>e.isMac&&t.printableselection.length>0,...s(e.winId,n,t)};case"DOCUMENT_EMOJI":return{isVisible:()=>t.support.emoji,...s(e.winId,n,t)};case"DOCUMENT_PASTE_AS_PLAIN_TEXT":return{isVisible:()=>t.support.editoptions,...s(e.winId,n,t)};case"DOCUMENT_ADD_AS_SEARCH_ENGINE":return{isVisible:()=>!e.isGuest&&t.keywordurl.length>0,...s(e.winId,n,t)};case"DOCUMENT_CONTAINER_NOTES":return{container:{content:"notes"},isVisible:()=>!e.isGuest,...s(e.winId,n,t)};case"DOCUMENT_CONTAINER_SPELLCHECK_OPTIONS":return e.isMac?{isVisible:()=>t.support.editoptions,items:Lue(),...s(e.winId,n,t)}:{isVisible:()=>t.support.editoptions,container:{content:"spellcheckoptions"},...s(e.winId,n,t)};case"DOCUMENT_CONTAINER_WRITING_DIRECTION":return{isVisible:()=>t.support.editoptions,items:Pue(),...s(e.winId,n,t)};case"DOCUMENT_SEARCH":case"DOCUMENT_SEARCH_LAST_USED":{const i=Rs.getSearchEngine(e.winId,"DOCUMENT_SEARCH_LAST_USED"===n.action);return i?{...Mue(e.winId,t.selection,i),mnemonic:!0,isVisible:()=>t.selection.length>0,...s(e.winId,n,t)}:Promise.reject()}case"DOCUMENT_CONTAINER_SEARCH_WITH":return{items:Nue(e.winId,t.selection),isVisible:()=>t.selection.length>0,...s(e.winId,n,t)};case"DOCUMENT_CONTAINER_EXTENSIONS":return{isVisible:()=>!t.iswebpanel&&t.support.extensions,container:{content:"extensions"},...s(e.winId,n,t)};case"DOCUMENT_CONTAINER_SPEECH":return{isVisible:()=>e.isMac,container:{content:"speech"},...s(e.winId,n,t)};case"DOCUMENT_GOTO_URL":return{handler:()=>{d.ZP.openURL(e.winId,t.selectionurl,{inCurrent:!1,inBackground:H.Z.get($.kTabsOpenNewInBackground)})},isVisible:()=>t.selectionurl.length>0,...s(e.winId,n,t)};case"COMMAND_COPY_SELECTION_TO_NOTE":return{...s(e.winId,n,t),isVisible:()=>!e.isGuest&&t.selection.length>0,handler:()=>{const n=ie.ZP.getActivePage(e.winId);n&&Nn.Z.createNote(e.winId,{content:t.selection,url:n.url,type:"note"})}};case"COMMAND_APPEND_SELECTION_TO_NOTE":return{...s(e.winId,n,t),..._ue(e,0,t)};case"COMMAND_TRANSLATE_SELECTION":{const{id:i,url:o}=ie.ZP.unsafeGetActivePage(e.winId);return{isVisible:()=>NI.ZP.canTranslateText(t.selection,o,i),...s(e.winId,n,t),handler:()=>{os.Z.translateSelection(e.winId,i,t.selection)}}}default:return Bs.actions().includes(n.action)?xue(e,t,!1,n,s):Promise.resolve({...s(e.winId,n,t)})}}))})(o,n).then((n=>{i(e,t,n)})):n.linkurl.length>0?((e,t)=>{const n="link",i=Pi.getOptionFunction(n),o=Pi.getActionList("image")(),a=Pi.getActionList("selection")(),r=Pi.getActionList("audiovideo")();return Pi.getNamedMenu(e.winId,n,(async n=>{switch(n.action){case"DOCUMENT_OPEN_IN_NEW_TAB":case"DOCUMENT_OPEN_IN_TAB":return{isVisible:()=>!t.ismailto&&!e.isPopup,...i(e.winId,n,t)};case"DOCUMENT_OPEN_IN_NEW_WINDOW":return{isVisible:()=>!t.ismailto&&(!e.isIncognito||e.isGuest),...i(e.winId,n,t)};case"DOCUMENT_OPEN_IN_NEW_BACKGROUND_TAB":return{isVisible:()=>!t.ismailto&&!e.isPopup&&!H.Z.get($.kTabsOpenNewInBackground),...i(e.winId,n,t)};case"DOCUMENT_OPEN_IN_PRIVATE_WINDOW":return{isVisible:()=>!t.ismailto&&!e.isGuest,...i(e.winId,n,t)};case"DOCUMENT_CONTAINER_OPEN_IN_PWA":return{isVisible:()=>!t.ismailto,container:{content:"linkinpwa"},...i(e.winId,n,t)};case"DOCUMENT_CONTAINER_OPEN_IN_PROFILE":return{isVisible:()=>!t.ismailto,container:{content:"linkinprofile"},...i(e.winId,n,t)};case"DOCUMENT_CONTAINER_OPEN_IN_WINDOW":{const s=await Kr.getMenu(e.winId,!1,[t.linkurl]);return{isVisible:()=>s.length>0,items:s,...i(e.winId,n,t)}}case"DOCUMENT_CONTAINER_OPEN_IN_WORKSPACE":return{isVisible:()=>!t.ismailto&&Kj.Z.getWorkspaces(e.winId).length>0,items:Wue(e,t),...i(e.winId,n,t)};case"DOCUMENT_ADD_LINK_TO_BOOKMARKS":return{handler:()=>{s.Z.bookmarks.create({parentId:ps.ZP.getRootNode().id,title:t.linktitle,url:t.linkurl})},isVisible:()=>!t.ismailto&&!t.iswebpanel&&!e.isGuest,...i(e.winId,n,t)};case"DOCUMENT_ADD_LINK_TO_WEBPANEL":return{handler:()=>{Fl.Z.addByUrl(e.winId,t.linkurl,!0)},isVisible:()=>!t.ismailto&&!t.iswebpanel&&!e.isGuest,...i(e.winId,n,t)};case"DOCUMENT_ADD_LINK_TO_READING_LIST":return{handler:()=>{Hn.Z.add(e.winId,t.linkurl,t.linktitle)},isVisible:()=>!e.isGuest,...i(e.winId,n,t)};case"DOCUMENT_SEND_LINK_BY_MAIL":return{handler:()=>{ke.Z.createDraft({subject:t.linktitle||t.linkurl,body:t.linkurl})},isVisible:()=>!H.Z.get($.kMailIsTurnedOff),...i(e.winId,n,t)};case"DOCUMENT_SAVE_LINK":return{isVisible:()=>!t.ismailto,...i(e.winId,n,t)};case"DOCUMENT_COPY_LINK_TEXT":return{isVisible:()=>!t.isimage&&t.linktitle.length>0,...i(e.winId,n,t)};case"DOCUMENT_CONTAINER_SEND_TO_DEVICES":return{isVisible:()=>!t.iswebpanel&&t.support.sendlinktodevices,container:{content:"sendlinktodevices"},...i(e.winId,n,t)};case"DOCUMENT_CONTAINER_EXTENSIONS":return{isVisible:()=>!t.iswebpanel&&t.support.extensions,container:{content:"extensions"},...i(e.winId,n,t)};case"DOCUMENT_CONTAINER_LINK_SELECTION":return t.selection.length>0&&!t.isimage&&!t.support.canvas?{items:await Uue(e,t,!0),...i(e.winId,n,t)}:{items:[],isVisible:()=>!1,...i(e.winId,n,t)};case"DOCUMENT_CONTAINER_LINKED_IMAGE":return t.isimage||t.support.canvas?{items:await Vue(e,t,!0),...i(e.winId,n,t)}:{items:[],isVisible:()=>!1,...i(e.winId,n,t)};default:return Bs.actions().includes(n.action)?xue(e,t,!1,n,i):a.includes(n.action)?t.selection.length>0&&!t.isimage&&!t.support.canvas?Rue(e,t,!1,n,i):{isVisible:()=>!1,...i(e.winId,n,t)}:o.includes(n.action)?t.isimage||t.support.canvas?Bue(e,t,!1,n,i):{isVisible:()=>!1,...i(e.winId,n,t)}:r.includes(n.action)?t.support.audio||t.support.video?Fue(e,t,!1,n,i):{isVisible:()=>!1,...i(e.winId,n,t)}:Promise.resolve({...i(e.winId,n,t)})}}))})(o,n).then((s=>{i(e,t,s,n)})):n.isimage||n.support.canvas?Vue(o,n,!1).then((s=>{i(e,t,s,n)})):n.support.audio||n.support.video?((e,t)=>{const n="audiovideo",s=Pi.getOptionFunction(n);return Pi.getNamedMenu(e.winId,n,(async n=>Fue(e,t,!1,n,s)))})(o,n).then((n=>{i(e,t,n)})):n.selection.length>0?Uue(o,n,!1).then((s=>{i(e,t,s,n)})):n.ismailcontent?((e,t)=>{const n="mailcontent",s=Pi.getOptionFunction(n);return Pi.getNamedMenu(e.winId,n,(async n=>{switch(n.action){case"COMMAND_PAGE_BACK":return{...s(e.winId,n,t),isVisible:()=>Fv.Z.canGoBack()};case"COMMAND_PAGE_FORWARD":return{...s(e.winId,n,t),isVisible:()=>Fv.Z.canGoForward()};case"COMMAND_TAB_VIEW_PAGE_SOURCE":return{checked:Boolean(u.Z.getIsRawMode()),...s(e.winId,n,t)};default:return Bs.actions().includes(n.action)?xue(e,t,!1,n,s):Promise.resolve({...s(e.winId,n,t)})}}))})(o,n).then((n=>{i(e,t,n)})):((e,t)=>{const n="page",s=Pi.getOptionFunction(n);return Pi.getNamedMenu(e.winId,n,(async n=>{switch(n.action){case"COMMAND_ADD_BOOKMARK":return{...s(e.winId,n,t),isVisible:()=>!t.iswebpanel&&!e.isGuest};case"DOCUMENT_ADD_TO_WEBPANEL":return{handler:()=>{Fl.Z.addByUrl(e.winId,t.pageurl,!0)},isVisible:()=>!t.iswebpanel&&!e.isGuest,...s(e.winId,n,t)};case"DOCUMENT_SEND_BY_MAIL":return{handler:()=>{ke.Z.createDraft({subject:t.pagetitle||t.pageurl,body:t.pageurl})},isVisible:()=>!H.Z.get($.kMailIsTurnedOff),...s(e.winId,n,t)};case"DOCUMENT_COPY_ADDRESS":return{handler:()=>{yi.Z.copyUrlToClipboard(t.pageurl)},...s(e.winId,n,t)};case"DOCUMENT_CONTAINER_LINK_TO_HIGHLIGHT":return{isVisible:()=>t.support.highlight,container:{content:"linktohighlight"},...s(e.winId,n,t)};case"DOCUMENT_SAVE":case"DOCUMENT_CAST":return{isVisible:()=>!t.iswebpanel,...s(e.winId,n,t)};case"DOCUMENT_QR_CODE":return{isVisible:()=>t.support.qrcode,...s(e.winId,n,t)};case"DOCUMENT_CONTAINER_SEND_TO_DEVICES":return{isVisible:()=>!t.iswebpanel&&t.support.sendpagetodevices,container:{content:"sendpagetodevices"},...s(e.winId,n,t)};case"DOCUMENT_CONTAINER_EXTENSIONS":return{isVisible:()=>!t.iswebpanel&&t.support.extensions,container:{content:"extensions"},...s(e.winId,n,t)};case"DOCUMENT_CONTAINER_PLUGIN_ROTATION":{const i=!t.iswebpanel&&t.support.plugin;return{isVisible:()=>i,items:i?[{commandName:"DOCUMENT_ROTATE_CLOCKWISE",...(0,xs.Z)("Rotate Clockwise")},{commandName:"DOCUMENT_ROTATE_COUNTERCLOCKWISE",...(0,xs.Z)("Rotate Counterclockwise")}]:[],...s(e.winId,n,t)}}case"CONTAINER_PERIODIC_RELOAD":if(t.iswebpanel){const i=ud.ZP.getSelected(e.winId);return i&&ud.ZP.getIsWebPanel(i)?{...s(e.winId,n,t),items:Cw.Z.getMenu(i,"panel",e.winId)}:{isVisible:()=>!1,...s(e.winId,n,t)}}return{...s(e.winId,n,t)};default:return Bs.actions().includes(n.action)?xue(e,t,!1,n,s):Promise.resolve({...s(e.winId,n,t)})}}))})(o,n).then((s=>{i(e,t,s,n)}))}},zue=Hue;var Gue=n(43656);function $ue(e,t){const{body:n}=e;if(!n)return;const s=getComputedStyle(t.srcElement).getPropertyValue("user-select");if(!t.srcElement.matches("a[href], area[href], input:not([disabled]), select:not([disabled]), option:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]")&&"text"!==s&&"all"!==s){let s=t.target;for(;s!==n&&null!==s;){if(s.draggable){const t=e.activeElement,i=function(s){this.removeEventListener("mouseup",i),this.removeEventListener("dragend",i),e.activeElement===n&&t.focus()};return s.addEventListener("mouseup",i),void s.addEventListener("dragend",i)}s=s.parentElement}t.preventDefault()}}function Kue(e){const{body:t}=e;if(!t)return Aa.Z;const n=$ue.bind(null,e);return t.addEventListener("mousedown",n),function(){t.removeEventListener("mousedown",n)}}let jue="";C.Z.utilities.onScroll.addListener((e=>{1===e?jue="mouse":2===e?jue="trackpad":3===e&&(jue="inertial")}));let Yue="";function Xue(e){this.vivaldiWindowId===e&&function(e){Yue="";const t=Uee.getEntry(e).status;if(t){const{urlValid:e,isBrowserUrl:n}=C.Z.utilities.isUrlValid(t);e&&n&&(Yue=t)}}(e)}function Que(e,t,n,s){if(this.vivaldiWindowId!==e)return;const i=J.Z.getCommandsForGestures();let o;if(Yue&&(o=i["e"+s]),!o){if(o=i[s],!o)return;const a=sge(this,t,n);if(a){const[t]=a;t.active||d.ZP.activateTab(t.id,e)}}const a=o[0];a.function({...(0,Qi.m)("gesture",this),param:Yue}),Yue="",c.Z.setStatus(e,(0,Oe.Z)("Gesture: $1",[a.label]),3e3)}function que(e,t,n,s,i){if(this.vivaldiWindowId!==e)return;const o=this.document.elementFromPoint(Math.round(s),Math.round(i));if(o&&"WEBVIEW"===o.tagName){t&&o.focus();const e=new MouseEvent(t?"mousedown":"mouseup",{button:n,clientX:s,clientY:i,bubbles:!0});o.dispatchEvent(e)}}let Jue=null;function ege(){Jue=setTimeout((()=>{Jue=null}),100)}function tge(e,t,n,s){if(this.vivaldiWindowId!==e||null!==Jue||"inertial"===jue)return;let i;const o=nee.kG(e);if(o.count()>=2){const t=sge(this,n,s,o);if(!t)return;const[a,r]=t;if(a.active||d.ZP.activateTab(a.id,e),je.jk.isInternalPage(a))return;if("WEBVIEW"!==r.tagName)return void console.error("An external page has "+r.tagName+" tag when WEBVIEW was expected");i=r}else{const t=Xw.Z.getActiveWebView(e);if(!t)return;i=t}ege();const a=.1*t;i.getZoom((t=>{let n=Math.round(10*t)/10+a;n=Math.min(Math.max(n,.2),5),i.setZoom(n),"overlay"!==H.Z.get($.kStatusBarDisplay)&&H.Z.get($.kToolbarsStatus).includes("Zoom")||c.Z.setStatus(e,(0,Oe.Z)("Page Zoom $1%",[Math.round(100*n)]),2e3)}))}function nge(e){const t=this.vivaldiWindowId,n=e.target;if(n.classList.contains("UrlBar-UrlField")&&n.scrollWidth>=n.clientWidth&&n!==this.document.activeElement)return void e.preventDefault();if(!H.Z.get($.kMouseWheelTabSwitch)||function(e){return!1===e.altKey&&!1===e.ctrlKey&&!0===e.shiftKey&&!1===e.metaKey}(e))return;let s=!1;if(n.closest("div#tabs-tabbar-container")&&(s=!0),2===e.buttons||function(e){return!0===e.altKey&&!1===e.ctrlKey&&!1===e.shiftKey&&!1===e.metaKey}(e)||s){if(e.preventDefault(),"inertial"===jue)return;const n=e.wheelDelta;let s;if(n>0)s=1;else{if(!(n<0))return;s=-1}const i=false,o=i?"COMMAND_TAB_SWITCH_BACK_SETTING":"COMMAND_TAB_SWITCH_FORWARD_SETTING",a=i?"COMMAND_TAB_SWITCH_BACK_ORDER":"COMMAND_TAB_SWITCH_FORWARD_ORDER",r=i?"COMMAND_TAB_SWITCH_FORWARD_SETTING":"COMMAND_TAB_SWITCH_BACK_SETTING",l=i?"COMMAND_TAB_SWITCH_FORWARD_ORDER":"COMMAND_TAB_SWITCH_BACK_ORDER";let d;if("trackpad"===jue){if(null!==Jue)return;ege(),d=s<0?2===e.buttons||e.altKey?o:a:2===e.buttons||e.altKey?r:l}else d=s<0?2===e.buttons||e.altKey?o:a:2===e.buttons||e.altKey?r:l;for(const n of eW.CN)if(n.name===d){n.action({origin:"gesture",context:this,windowId:t,keyState:{shiftKey:e.shiftKey,ctrlKey:e.ctrlKey,altKey:e.altKey,metaKey:e.metaKey,key:""},param:e});break}}}function sge(e,t,n,s){s=s||nee.kG(e.vivaldiWindowId);for(const i of s){const s=e.document.getElementById(String(i.id));if(!s)continue;const o=s.getBoundingClientRect();if(o.left<=t&&t<o.right&&o.top<=n&&n<o.bottom)return[i,s]}return null}var ige;function oge(e,t,n,s){ige||(ige="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:ige,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function age(){const e=hs.useContext(xi.Z);return hs.useEffect((()=>{function t(t,n,s){t===e.vivaldiWindowId&&zue.show(e,n,s)}function n(t,n,s,i){t===e.vivaldiWindowId&&Di.Z.handleShortcut(e,n,s,i,e.document.activeElement)}function s(t,n){H.Z.get($.kBiscuitLogRockerGestures)&&console.log("onRockerGesture",t,e.vivaldiWindowId,n),t===e.vivaldiWindowId&&v.Z.handleRockerGesture(e,n)}C.Z.contextMenu.onDocumentMenu.addListener(t),C.Z.tabsPrivate.onKeyboardShortcut.addListener(n),C.Z.tabsPrivate.onRockerGesture.addListener(s);const i=function(e){const t={onDetection:Xue.bind(e),onGesture:Que.bind(e),onClick:que.bind(e),onZoom:tge.bind(e),onWheel:nge.bind(e)};return C.Z.tabsPrivate.onMouseGestureDetection.addListener(t.onDetection),C.Z.tabsPrivate.onMouseGesture.addListener(t.onGesture),C.Z.tabsPrivate.onWebviewClickCheck.addListener(t.onClick),C.Z.tabsPrivate.onPageZoom.addListener(t.onZoom),e.document.addEventListener("wheel",t.onWheel,{passive:!1}),t}(e),o=Gue.Z.attachSpatnavListeners(e.vivaldiWindowId),a=Kue(e.document);return()=>{C.Z.contextMenu.onDocumentMenu.removeListener(t),C.Z.tabsPrivate.onKeyboardShortcut.removeListener(n),C.Z.tabsPrivate.onRockerGesture.removeListener(s),function(e,t){C.Z.tabsPrivate.onMouseGestureDetection.removeListener(t.onDetection),C.Z.tabsPrivate.onMouseGesture.removeListener(t.onGesture),C.Z.tabsPrivate.onWebviewClickCheck.removeListener(t.onClick),C.Z.tabsPrivate.onPageZoom.removeListener(t.onZoom),e.document.removeEventListener("wheel",t.onWheel,{passive:!1})}(e,i),Gue.Z.detachSpatnavListeners(o),a()}}),[e]),oge("svg",{version:"1.1",width:"0",height:"0",dangerouslySetInnerHTML:{__html:n(46639)}})}var rge,lge=n(39180),dge=n(80921),cge=n(80419),hge=n(34155);function pge(e,t,n,s){rge||(rge="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:rge,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const uge=[$.kAddressBarPosition,$.kAppearanceDisableTitleBar,$.kBookmarksBarDisplay,$.kBookmarksBarPosition,$.kKeyboardTabToAll,$.kKeyboardTabToAllUsesSystemDefault,$.kMenuDisplay,$.kPanelsPosition,$.kPanelsAsOverlayEnabled,$.kRazerChromaHasShownPromotion,$.kStartupShowGitDirectoryWarning,$.kStartupShowMediaAvailableInformation,$.kStartupShowFfmpegInformation,$.kStatusBarDisplay,$.kTabsAtEdge,$.kTabsBarPosition,$.kTabsBarWidth,$.kTabsCloseButtonLeft,$.kTabsStackingMode,$.kTabsTilingCollapseBorder,$.kThemesPreview,$.kThemeUseAnimation,$.kThemeDimBlurred,$.kThemeSimpleScrollbar,$.kThemesUser,$.kWindowsLinuxAltControls,$.kAddressBarVisible,$.kStartupShowCrashReportingDialog,$.kVivaldiCrashReportingConsentGranted,$.kStartupCrashReportingLastRequested,$.kStartupCrashReportingTimesShown],gge=lge.Z.call(),mge=!1;const vge=(0,no.Z)(((e,t)=>{t?d.ZP.cycleByHistory(e,void 0,{goBack:!1}):d.ZP.cycleByOrder(e,void 0,{goBack:!1})}),0),fge=(0,no.Z)(((e,t)=>{t?d.ZP.cycleByHistory(e,void 0,{goBack:!0}):d.ZP.cycleByOrder(e,void 0,{goBack:!0})}),0);var yge=pge(age,{}),Cge=pge(nue,{}),wge=pge($ce,{}),bge=pge(Rne,{name:$.kToolbarsStatus,menuOrigin:"bottomLeft",className:"toolbar-statusbar",popupPosition:"above",size:"medium"});class Sge extends hs.PureComponent{static contextType=xi.Z;refWebpageView=hs.createRef();refMainDialog=hs.createRef();hasNotch=!1;constructor(e,t){super(e);const n=G.ZP.getWindowState(t.vivaldiWindowId),{theme:s}=z.Z.getState(),i=z.Z.getState().windowStyles.get(t.vivaldiWindowId)||Uk.Z.getFallbackStyle(),o=Uk.Z.createClassnames(s,i);if(!n)throw new Error("MainWindow constructor: Expected windowState");this.state={bookmarkDialogParent:!1,bookmarkDialogOptions:null,capturing:xl.getCapturingState(t.vivaldiWindowId),clearBrowsingHistoryOptions:null,confirmOpenLinksOptions:null,confirmCloseOtherTabs:null,onAfterCloseDialog:null,dialogCustomData:null,extensionErrors:[],importData:!1,isBreakModeActive:pl.Z.getState().isActive,isDraggingButton:!1,panelWidth:ud.ZP.getWidth(t.vivaldiWindowId)+6,mainDialogOptions:null,mainDialogType:null,openSession:!1,paneSelection:!1,preventAppRegionDrag:!1,quickCommandValue:"",saveSession:!1,saveSessionOptions:null,windowClassNames:o,windowStyle:i,windowState:n,theme:s,showPrivacyStats:!1,showBookmarkAddedPopup:!1,bookmarkAddedPopupOptions:null,startupDialogQueue:new Map,editToolbar:""},this._updateKeyUIMode(),this.trackContextOnFocus=pee("content",t)}async componentDidMount(){const{selectWindow:e,vivaldiWindowId:t,screen:n}=this.context;eae.addListener(this._onMainStoreChanged),ud.ZP.addListener(this._onPanelStoreChanged),xl.addListener(this.#ge),pl.Z.addListener(this.onBreakModeStoreChanged),z.Z.addListener(this.onThemeStoreChanged),wa.addListener(this._onToolbarStoreChanged),G.ZP.addListener(this._onWindowStoreChanged,e),C.Z.extensionActionUtils.onAdded.addListener(this.onActionAdded),C.Z.extensionActionUtils.onRemoved.addListener(this.onActionRemoved),C.Z.extensionActionUtils.onSidePanelOptionChanged.addListener(this.onSidepanelChanged),C.Z.extensionActionUtils.onExtensionDisabledInstallErrorAdded.addListener(this.onExtensionInstallErrorAdded),C.Z.extensionActionUtils.onExtensionDisabledInstallErrorRemoved.addListener(this.onExtensionInstallErrorRemoved),C.Z.utilities.onBroadcastMessage.addListener(this.onBroadcastMessageReceived),C.Z.utilities.onShowQRCode.addListener(this.onShowQRCode),C.Z.windowPrivate.onActiveTabStatusText.addListener(this._onActiveTabStatusText),C.Z.utilities.browserWindowReady(t),s.Z.contextMenus.removeAll(),await this.createStartupDialogQueue()}componentDidUpdate(e,t){if(e.prefValues[$.kThemesPreview].length<this.props.prefValues[$.kThemesPreview].length){const e=Uk.Z.getPreview();G.ZP.isActive(this.context.vivaldiWindowId)&&this.showDialog({dialogtype:"themePreview",themeName:e?.name||"",isUpdate:this.props.prefValues[$.kThemesUser].findIndex((t=>t.id===e?.id))>-1},null)}else e.prefValues[$.kThemesPreview].length>this.props.prefValues[$.kThemesPreview].length&&this.handleOnCloseDialog()}componentWillUnmount(){eae.removeListener(this._onMainStoreChanged),ud.ZP.removeListener(this._onPanelStoreChanged),xl.removeListener(this.#ge),pl.Z.removeListener(this.onBreakModeStoreChanged),wa.removeListener(this._onToolbarStoreChanged),G.ZP.removeListener(this._onWindowStoreChanged),z.Z.removeListener(this.onThemeStoreChanged),C.Z.utilities.onBroadcastMessage.removeListener(this.onBroadcastMessageReceived),C.Z.utilities.onShowQRCode.removeListener(this.onShowQRCode),C.Z.windowPrivate.onActiveTabStatusText.removeListener(this._onActiveTabStatusText),C.Z.extensionActionUtils.onAdded.removeListener(this.onActionAdded),C.Z.extensionActionUtils.onRemoved.removeListener(this.onActionRemoved),C.Z.extensionActionUtils.onSidePanelOptionChanged.removeListener(this.onSidepanelChanged),C.Z.extensionActionUtils.onExtensionDisabledInstallErrorAdded.removeListener(this.onExtensionInstallErrorAdded),C.Z.extensionActionUtils.onExtensionDisabledInstallErrorRemoved.removeListener(this.onExtensionInstallErrorRemoved)}onSidepanelChanged=(e,t)=>{Fl.Z.updateByExtension(e,t)};onActionAdded=e=>{Fl.Z.addByExtension(this.context.vivaldiWindowId,e)};onActionRemoved=e=>{Fl.Z.removeByExtension(this.context.vivaldiWindowId,e)};onExtensionInstallErrorAdded=e=>{this.setState((t=>({extensionErrors:t.extensionErrors.concat(e)})),(()=>{this.showDialog({dialogtype:"extensionError",errors:this.state.extensionErrors},null)}))};onExtensionInstallErrorRemoved=e=>{this.setState((t=>{const n=t.extensionErrors.findIndex((t=>t.id===e.id));if(-1===n)return void console.info("onExtensionInstallErrorRemoved: Error not found from id.");const s=t.extensionErrors.slice();return s.splice(n,1),{extensionErrors:s}}))};#ge=()=>{const e=xl.getCapturingState(this.context.vivaldiWindowId);e?this.clearAppRegion():this.restoreAppRegion(),this.setState({capturing:e})};onBreakModeStoreChanged=()=>{const e=pl.Z.getState().isActive;this.setState({isBreakModeActive:e})};onThemeStoreChanged=()=>{const e=this.context.vivaldiWindowId,t=z.Z.getState().windowStyles.get(e)||Uk.Z.getFallbackStyle(),{theme:n}=z.Z.getState();if(t!==this.state.windowStyle||n!==this.state.theme){const e=Uk.Z.createClassnames(n,t);this.setState({windowClassNames:e,windowStyle:t,theme:n})}};_onToolbarStoreChanged=()=>{this.setState({editToolbar:wa.getState()})};onDragStart=e=>{e.dataTransfer.getData("vivaldi/x-button-toolbar")&&this.setState({isDraggingButton:!0})};onDragEnd=e=>{this.state.isDraggingButton&&this.setState({isDraggingButton:!1})};shouldRenderCrashReportingConsentDialog=()=>{if(!this.props.prefValues[$.kStartupShowCrashReportingDialog]||this.props.prefValues[$.kVivaldiCrashReportingConsentGranted])return!1;const e=[0,6048e5,24192e5],t=this.props.prefValues[$.kStartupCrashReportingTimesShown]>=e.length?e[e.length-1]:e[this.props.prefValues[$.kStartupCrashReportingTimesShown]];return Date.now()-this.props.prefValues[$.kStartupCrashReportingLastRequested]>t};createStartupDialogQueue=async()=>{let e=!1;const t=this.context.vivaldiWindowId,n=new Map,i=async t=>{const s=await C.Z.utilities.getSharedData({key:t,value:!1}),i=this.refWebpageView.current;i&&!s&&(n.set(t,{active:!e,anchor:i}),e=!0,await C.Z.utilities.setSharedData({key:t,value:!0}))};await C.Z.utilities.getSharedData({key:h.oj,value:!1},(i=>{if(!i){H.Z.get($.kStartupCheckIsDefault)&&!G.ZP.isGuest()&&G.ZP.isActive(t)&&C.Z.utilities.isVivaldiDefaultBrowser((t=>{!1===t&&s.Z.history.search({startTime:Date.now()-2592e5,endTime:Date.now(),text:""},(t=>{const s=this.refWebpageView.current;t.length>=10&&s&&(n.set(h.oj,{active:!e,anchor:s}),e=!0,this.setState({startupDialogQueue:n}),C.Z.utilities.setSharedData({key:h.oj,value:!0}))}))}))}})),G.ZP.isIncognitoOrGuest(t)||await C.Z.utilities.isRazerChromaAvailable()&&!this.props.prefValues[$.kRazerChromaHasShownPromotion]&&await i(h.Bo),"linux"===lge.Z.call()&&this.props.prefValues[$.kStartupShowFfmpegInformation]&&!0===await C.Z.utilities.getFFMPEGState()&&await i(h.d7),"win"===lge.Z.call()&&this.props.prefValues[$.kStartupShowMediaAvailableInformation]&&!1===await C.Z.utilities.getMediaAvailableState&&await i(h.yl),""!==this.props.prefValues[$.kStartupShowGitDirectoryWarning]&&await i(h.Yd),this.shouldRenderCrashReportingConsentDialog()&&!0===await C.Z.utilities.detectNewCrashes()&&await i(h.HC),!G.ZP.isIncognitoOrGuest(this.context.vivaldiWindowId)&&(await C.Z.extensionActionUtils.triggerGlobalErrors()).length&&(await C.Z.extensionActionUtils.triggerGlobalErrors((e=>{this.setState({extensionErrors:e})})),await i(h.tI)),this.setState({startupDialogQueue:n})};storeQuickCommandSearch=e=>{this.setState({quickCommandValue:e})};closeStartupDialog=e=>{const t=this.state.startupDialogQueue;t.get(e)&&t.delete(e);for(const[e]of t){const n=t.get(e);if(n){n.active=!0;break}}this.setState(((e,n)=>({startupDialogQueue:t}))),this.forceUpdate()};shouldShowStartupDialog=e=>{const t=this.state.startupDialogQueue.get(e);return t&&t.active};_onActiveTabStatusText=(e,t)=>{e===this.context.vivaldiWindowId&&c.Z.setStatus(e,t)};_updateKeyUIMode=()=>{const e=this.props.prefValues;if(e[$.kKeyboardTabToAllUsesSystemDefault]){const t=this.props.prefValues[$.kSystemMacKeyboardUiMode];2===t&&0!==e[$.kKeyboardTabToAll]?Ne.Z.set($.kKeyboardTabToAll,0):0===t&&-1!==e[$.kKeyboardTabToAll]&&Ne.Z.set($.kKeyboardTabToAll,-1)}};_onMainStoreChanged=e=>{if(e.winId===this.context.vivaldiWindowId)switch(e.type){case"MAIN_SHOW_CONFIRM_OPEN_LINKS_DIALOG":this.showConfirmOpenLinksDialog(e.options);break;case"MAIN_SHOW_CONFIRM_CLOSE_OTHER_TABS_DIALOG":this.setConfirmCloseOtherTabsDialog(e.options);break;case"MAIN_SHOW_CLEAR_BROWSING_HISTORY_DIALOG":this.showClearBrowsingHistoryDialog();break;case"MAIN_SHOW_BOOKMARK_DIALOG":this.showBookmarkDialog(e.options);break;case"MAIN_SHOW_SAVE_SESSION_DIALOG":this.showSaveSession(e.options);break;case"MAIN_SHOW_OPEN_SESSION_DIALOG":this.showOpenSession();break;case"MAIN_SHOW_IMPORT_DATA_DIALOG":this.showDialog({dialogtype:"import"},null);break;case"MAIN_SHOW_PAGE_ACCESS_KEYS":{const t=ie.ZP.getActivePage(this.context.vivaldiWindowId);t&&!(0,vs.xl)(t.url)&&this.toggleMainDialog(e.type);break}case"MAIN_SHOW_KEYBOARDS_SHORTCUTS":case"MAIN_SHOW_QUICKCOMMANDS":case"MAIN_SHOW_MAIL_ACCOUNT_DIALOG":case"MAIN_SHOW_CALENDAR_ACCOUNT_DIALOG":case"MAIN_SHOW_CREATE_CALENDAR_DIALOG":case"MAIN_SHOW_CREATE_LABEL":this.toggleMainDialog(e.type);break;case"MAIN_SHOW_CALENDAR_EDIT_EVENT":case"MAIN_SHOW_CALENDAR_EDIT_TEMPLATE":case"MAIN_SHOW_CALENDAR_IMPORT_EVENTS_DIALOG":case"MAIN_SHOW_ENABLE_SESSION_AUTOSAVE_DIALOG":case"MAIN_SHOW_MAIL_AUTHENTICATION_DIALOG":case"MAIN_SHOW_MAIL_DELETE_DIALOG_ACCOUNTS":case"MAIN_SHOW_MAIL_DELETE_DIALOG_CONFIRM_ALL":case"MAIN_SHOW_MAIL_DELETE_DIALOG_FOLDERS":case"MAIN_SHOW_MAIL_DELETE_DIALOG_SETTING":case"MAIN_SHOW_MAIL_UNSUBSCRIBE_DIALOG":case"MAIN_SHOW_MAIL_UPLOAD_CONFIRMATION":case"MAIN_SHOW_MAIL_MESSAGE_MOVE_CONFIRMATION":case"MAIN_SHOW_MAIL_CREATE_ARCHIVE_FOLDER_CONFIRMATION":case"MAIN_SHOW_ACCOUNT_SHEET":case"MAIN_SHOW_MODAL_INFO":case"MAIN_SHOW_ENABLE_WORKSPACE_DIALOG":case"MAIN_SHOW_INCLUDE_WORKSPACE_DIALOG":case"MAIN_SHOW_WORKSPACE_DIALOG":case"MAIN_SHOW_NOTE_SELECTION_DIALOG":this.toggleMainDialog(e.type,e.options);break;case"MAIN_SHOW_ADD_FEED":case"MAIN_SHOW_ADD_MAIL_FOLDER":case"MAIN_SHOW_DELETE_LABEL_CONFIRMATION":case"MAIN_SHOW_DELETE_FILTER_CONFIRMATION":case"MAIN_SHOW_MAIL_VIEW_FILTER_CONFIRMATION":case"MAIN_SHOW_DELETE_MAIL_FOLDER":case"MAIN_SHOW_DELETE_WORKSPACE":G.ZP.isActive(this.context.vivaldiWindowId)&&this.toggleMainDialog(e.type,e.options);break;case"MAIN_SHOW_MODAL_DIALOG":case"MAIN_SHOW_CALENDAR_ALARM":this.state.mainDialogType!==e.type?this.toggleMainDialog(e.type,e.options):this.state.mainDialogOptions?.windowToRestore||"number"!=typeof e.options.windowToRestore||this.setState({mainDialogOptions:e.options});break;case"MAIN_SELECTING_TOOLBAR":this.setPaneSelection(e.options.enable);break;case"MAIN_SHOW_DIALOG":this.showDialog(e.options,e.onAfterClose);break;case"MAIN_SHOW_BOOKMARK_ADDED_POPUP":this.props.prefValues[$.kAddressBarVisible]&&!G.ZP.isMinimalUI(this.context.vivaldiWindowId)||this.showBookmarkAddedPopup(e.options);break;case"MAIN_SHOW_PRIVACY_STATS":this.showPrivacyStats()}};_onPanelStoreChanged=()=>{this.setState({panelWidth:ud.ZP.getWidth(this.context.vivaldiWindowId)+6})};onCloseMainDialog=()=>new Promise((e=>{this.setState({mainDialogType:null,mainDialogOptions:null},e)}));setPaneSelection=e=>{this.setState({paneSelection:e})};toggleMainDialog=(e,t)=>{this.state.mainDialogType===e?this.onCloseMainDialog():this.setState({mainDialogType:e,mainDialogOptions:t||null})};handleTabSwitcherActivation=e=>{const t=this.refMainDialog.current?.refVisualTabSwitcher.current;if(!e&&t){const e=t.state.selected;d.ZP.activateTab(e.id,this.context.vivaldiWindowId)}this.onCloseMainDialog()};switchTabVisualTabSwitcher=(e,t,n)=>{if(!n&&"wheel"!==e?.type)return void((e,t)=>{const n=H.Z.get($.kTabsCycleByRecentOrder);t?vge(e,n):fge(e,n)})(this.context.vivaldiWindowId,t);if(ie.ZP.getPages(this.context.vivaldiWindowId).size<2)return;const{mainDialogType:s}=this.state;if("MAIN_SHOW_TAB_CYCLER"===s){const e=this.refMainDialog.current?.refVisualTabSwitcher.current;t?e?.selectForward():e?.selectBack()}else this.toggleMainDialog("MAIN_SHOW_TAB_CYCLER",{forward:t}),(0,cge.g)(e,this.handleTabSwitcherActivation,this.context.document)};_onWindowStoreChanged=()=>{const e=this.context.vivaldiWindowId,t=G.ZP.getWindowState(e);t&&this.setState({windowState:t})};onBroadcastMessageReceived=e=>{e.startDragging?this.clearAppRegion():e.endDragging&&this.restoreAppRegion()};_onMacMenuAction=(e,t,n)=>{if(e===this.context.vivaldiWindowId&&!G.ZP.isMinimized(e)){const s=J.Z.getHandlerByAction(e,t,n);s?s():v.Z.executeActions("menu",this.context,t)}};_onMacWindowDidChangeScreens=(e,t)=>{e===this.context.vivaldiWindowId&&(this.hasNotch=t)};clearAppRegion=()=>{this.setState({preventAppRegionDrag:!0})};restoreAppRegion=()=>{this.setState({preventAppRegionDrag:!1})};handleDoubleClick=()=>{"top"===this.props.prefValues[$.kTabsBarPosition]&&this.state.windowState.nativeDecorations?d.ZP.openURL(this.context.vivaldiWindowId,""):G.ZP.isMaximized(this.context.vivaldiWindowId)||(G.ZP.isFullscreen(this.context.vivaldiWindowId),0)?cs.Z.restore(this.context.vivaldiWindowId):cs.Z.maximize(this.context.vivaldiWindowId)};closeConfirmOpenLinksDialog=()=>{this.setState({confirmOpenLinksOptions:null})};showConfirmOpenLinksDialog=e=>{this.setState({confirmOpenLinksOptions:e})};setConfirmCloseOtherTabsDialog=e=>{this.setState({confirmCloseOtherTabs:e})};showClearBrowsingHistoryDialog=()=>{G.ZP.isIncognitoOrGuest(this.context.vivaldiWindowId)||this.setState({clearBrowsingHistoryOptions:!0})};closeClearBrowsingHistoryDialog=()=>{this.setState({clearBrowsingHistoryOptions:null})};closeImportContacts=()=>{this.setState({importData:Boolean(this.refWebpageView.current)})};showBookmarkDialog=e=>{this.setState({bookmarkDialogParent:Boolean(this.refWebpageView.current),bookmarkDialogOptions:e})};showBookmarkAddedPopup=e=>{this.setState({showBookmarkAddedPopup:!0,bookmarkAddedPopupOptions:e})};closeBookmarkDialog=()=>{this.setState({bookmarkDialogParent:!1})};onShowQRCode=e=>{this.showDialog({dialogtype:"qrcode",url:e},null)};closeSaveSession=()=>{this.setState({saveSession:!1})};showSaveSession=e=>{this.setState({saveSession:Boolean(this.refWebpageView.current),saveSessionOptions:e})};closeOpenSession=()=>{this.setState({openSession:!1})};showOpenSession=()=>{this.setState({openSession:Boolean(this.refWebpageView.current)})};showDialog=(e,t)=>{this.setState({dialogCustomData:e,onAfterCloseDialog:t})};showPrivacyStats=()=>{this.setState({showPrivacyStats:!0})};handleOnCloseDialog=()=>{this.setState({dialogCustomData:null}),hge.nextTick((()=>{this.state.onAfterCloseDialog?.()}))};hasHorizontalMenu=()=>Boolean("top"===this.props.prefValues[$.kMenuDisplay]&&!0);showTitleBar=e=>{const{html5FullScreen:t,state:n,type:s,visibleUI:i}=e;return!i.addressBar||Hne()||t||"fullscreen"!==n&&("popup"===s||"settings"===s)};getBrowserClasses=(e,t)=>{const{prefValues:n}=this.props,{visibleUI:s,type:i,active:o,state:a,nativeDecorations:r,fullscreenMenubarShown:l}=t,{addressBar:d,bookmarksBar:c,tabs:h}=s,{windowClassNames:p,isBreakModeActive:u,isDraggingButton:g,preventAppRegionDrag:m,paneSelection:v,editToolbar:f}=this.state,y=n[$.kTabsBarPosition],C=(0,G.WV)(t),w="settings"===i,b="normal"===i,S="popup"===i,I="substrip"===n[$.kTabsStackingMode],k="accordion"===n[$.kTabsStackingMode],A="bottom"===y||"top"===y,T="maximized"===a||"fullscreen"===a,Z=n[$.kAddressBarPosition],E=n[$.kBookmarksBarPosition],_=h&&b?y:"off",M=n[$.kTabsAtEdge]&&A&&T;return As()(gge,C,{...p,"minimal-ui":G.ZP.isMinimalUI(e),"disable-titlebar":!this.showTitleBar(t),hasfocus:o,isblurred:!o,native:r,"mac-fullscreen-hover":l&&o&&!this.hasNotch,"mac-fullscreen-hover-notch":l&&o&&this.hasNotch,"mac-menubar-permanent":this.props.prefValues[$.kSystemMacMenubarVisibleInFullscreen],popup:S,"is-settingspage":w,"simple-scrollbar":this.props.prefValues[$.kThemeSimpleScrollbar],"dim-blurred":this.props.prefValues[$.kThemeDimBlurred],"horizontal-menu":this.hasHorizontalMenu(),"tabs-at-edge":M,alt:n[$.kWindowsLinuxAltControls]&&false,"alt-tabs":n[$.kTabsCloseButtonLeft],"substrip-tabs-on":I,"accordion-tabs-on":k,"full-key-access":0===n[$.kKeyboardTabToAll],"break-mode":u,[`stacks-${n[$.kTabsStackingMode]}`]:!0,[`address-${Z}`]:d,[`address-${Z}-off`]:!d,[`bookmark-bar-${E}`]:c,[`bookmark-bar-${E}-off`]:!c,[`tabs-${_}`]:!0,"narrow-tiling":this.props.prefValues[$.kTabsTilingCollapseBorder],"is-dragging-button":g,"no-app-dragging":m,"active-pane-selection":v,"animation-off":!n[$.kThemeUseAnimation],"toolbar-edit-mode":""!==f})};onInnerOver=e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"};onInnerClick=()=>Wp.Z.stopEditing();onInnerDrop=e=>{e.preventDefault();const t=e.dataTransfer.getData(Dne),n=e.dataTransfer.getData(Pne);if("toolbar-editor"!==n){const e=[...H.Z.get(n)];e.splice(parseInt(t),1),Ne.Z.set(n,e)}};render(){const e=this.props.prefValues,{capturing:t}=this.state,n=""!==this.state.editToolbar,s=e[$.kTabsBarPosition],{html5FullScreen:i,state:o,visibleUI:a}=this.state.windowState,r="left"===s||"right"===s?{[`padding${(0,dge.Z)(s)}`]:e[$.kTabsBarWidth]}:void 0,l="fullscreen"===o&&!(a.tabs&&"top"===s);return pge("div",{id:"browser",lang:q.ZP.UI_LANGUAGE,className:this.getBrowserClasses(this.context.vivaldiWindowId,this.state.windowState),style:this.state.windowStyle,onDragStart:n?this.onDragStart:null,onDragEnd:n?this.onDragEnd:null,onDrop:n?this.onDragEnd:null},void 0,pge(fp,{level:"nothing"},void 0,yge,pge("div",{id:"header",onDoubleClick:this.handleDoubleClick},void 0,this.showTitleBar(this.state.windowState)&&pge(Ope,{isHidden:l,native:this.state.windowState.nativeDecorations,isPopupWindow:!1,tabPosition:a.tabs?s:"none",keyAccess:e[$.kKeyboardTabToAll]}),this.hasHorizontalMenu()&&Cge,("top"===s||!a.tabs)&&pge(_pe,{switchTabVisualTabSwitcher:this.switchTabVisualTabSwitcher,mainDialogType:this.state.mainDialogType,tabPosition:s,theme:this.state.theme,visible:a.tabs},"tabbar")),pge("div",{id:"main",className:e[$.kPanelsPosition]},void 0,pge(Qne,{native:this.state.windowState.nativeDecorations,fullScreenState:false,size:"large"}),a.bookmarksBar&&pge(cl,{display:e[$.kBookmarksBarDisplay],statusOff:"off"===a.statusBar,keyAccess:e[$.kKeyboardTabToAll]}),this.shouldShowStartupDialog(h.oj)&&pge(Wce,{onClose:this.closeStartupDialog.bind(this,h.oj)}),pge("div",{className:"inner",onClick:n?this.onInnerClick:null,onDragEnter:n?e=>e.preventDefault():null,onDragOver:n?this.onInnerOver:null,onDrop:n?this.onInnerDrop:null},void 0,this.state.dialogCustomData&&pge(ap,{customData:this.state.dialogCustomData,closeDialog:this.handleOnCloseDialog}),this.state.confirmOpenLinksOptions&&pge(nd,{options:this.state.confirmOpenLinksOptions,onRequestClose:this.closeConfirmOpenLinksDialog}),this.state.confirmCloseOtherTabs&&pge(ed,{options:this.state.confirmCloseOtherTabs,onRequestClose:()=>this.setConfirmCloseOtherTabsDialog(null)}),this.state.clearBrowsingHistoryOptions&&pge(ql,{onClose:this.closeClearBrowsingHistoryDialog}),this.state.bookmarkDialogParent&&this.state.bookmarkDialogOptions&&pge(Dr,{onClose:this.closeBookmarkDialog,options:this.state.bookmarkDialogOptions}),this.state.saveSession&&this.state.saveSessionOptions&&pge(Rce,{onClose:this.closeSaveSession,options:this.state.saveSessionOptions}),!G.ZP.isIncognitoOrGuest(this.context.vivaldiWindowId)&&wge,this.shouldShowStartupDialog(h.Bo)&&pge(Nce,{onClose:this.closeStartupDialog.bind(this,h.Bo)}),this.shouldShowStartupDialog(h.d7)&&pge(Ip,{onClose:this.closeStartupDialog.bind(this,h.d7)}),this.shouldShowStartupDialog(h.yl)&&pge(Op,{onClose:this.closeStartupDialog.bind(this,h.yl)}),this.shouldShowStartupDialog(h.Yd)&&pge(_p,{onClose:this.closeStartupDialog.bind(this,h.Yd)}),this.shouldShowStartupDialog(h.HC)&&pge(pp,{onClose:this.closeStartupDialog.bind(this,h.HC)}),this.shouldShowStartupDialog(h.tI)&&pge(_d,{errors:this.state.extensionErrors,onClose:this.closeStartupDialog.bind(this,h.tI)}),this.state.openSession&&pge(yae,{onClose:this.closeOpenSession}),this.state.showPrivacyStats&&pge(Ace,{onClose:()=>this.setState({showPrivacyStats:!1})}),pge(qde,{position:e[$.kPanelsPosition],outsideClickIgnoreClass:"panel-clickoutside-ignore",editToolbar:n},"panel"),pge("div",{className:"tabbar-wrapper"},"webview-anchor","left"===s&&a.tabs&&pge(_pe,{switchTabVisualTabSwitcher:this.switchTabVisualTabSwitcher,mainDialogType:this.state.mainDialogType,tabPosition:s,theme:this.state.theme,visible:a.tabs},"tabbar")),(0,fs.jsx)("div",{ref:this.refWebpageView,id:"webview-container",inert:n?"true":null,onFocus:this.trackContextOnFocus,children:pge(Tue,{cycleFocus:H.Z.get($.kWebpagesFocusTrap)})}),"overlay"===a.statusBar&&!i&&pge(Kee,{name:"StatusInfo",draggable:!1,style:{[e[$.kPanelsPosition]]:this.state.panelWidth,...r}}),"right"===s&&a.tabs&&pge(_pe,{switchTabVisualTabSwitcher:this.switchTabVisualTabSwitcher,mainDialogType:this.state.mainDialogType,tabPosition:s,theme:this.state.theme,visible:a.tabs},"tabbar"))),pge("footer",{},void 0,"bottom"===s&&a.tabs&&pge(_pe,{switchTabVisualTabSwitcher:this.switchTabVisualTabSwitcher,mainDialogType:this.state.mainDialogType,tabPosition:s,theme:this.state.theme,visible:!0},"tabbar"),"on"===a.statusBar&&bge),this.state.mainDialogType&&(0,fs.jsx)(qoe,{ref:this.refMainDialog,onClose:this.onCloseMainDialog,dialog:this.state.mainDialogType,options:this.state.mainDialogOptions,quickCommandValue:this.state.quickCommandValue,storeQuickCommandSearch:this.storeQuickCommandSearch}),n&&pge(Wpe,{toolbar:this.state.editToolbar}),pge(ga.Z,{classNames:"HUD",in:this.state.isBreakModeActive,mountOnEnter:!0,unmountOnExit:!0,timeout:{enter:500,exit:100}},void 0,pge("button",{className:"HUD",onClick:hl.Z.toggleBreakMode,dangerouslySetInnerHTML:{__html:Ts._qK.large}})),!this.state.windowState.visibleUI.addressBar&&pge(ga.Z,{in:this.state.showBookmarkAddedPopup,classNames:"Bookmark-Added-Popup",mountOnEnter:!0,unmountOnExit:!0,onExited:()=>this.setState({bookmarkAddedPopupOptions:null}),timeout:{enter:300,exit:150}},void 0,pge("div",{className:"Bookmark-Added-Popup"},void 0,this.state.bookmarkAddedPopupOptions&&pge(Sr,{options:this.state.bookmarkAddedPopupOptions,onClose:()=>this.setState({showBookmarkAddedPopup:!1})}))),t&&pge(Pl,{capturing:t,winId:this.context.vivaldiWindowId})))}}const Ige=sa(Sge,uge);var kge;function Age(e,t,n,s){kge||(kge="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:kge,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Tge extends hs.Component{render(){const e=this.props.page;return Age("div",{className:"inner"},void 0,Age(cee,{id:e.id,pageContext:e.context,url:e.url,target:e.target,vivExtData:e.vivExtData,showImageInspector:e.showImageInspector,discarded:e.discarded,isVisible:!0,contentWidth:0,contentHeight:0,isActive:this.props.active,supportsReaderMode:e.supportsReaderMode,pinned:!1},`page-component-${e.id}`))}}const Zge=Tge;var Ege;function _ge(e,t,n,s){Ege||(Ege="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Ege,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Mge=[$.kAddressBarPosition,$.kKeyboardTabToAll,$.kSystemMacMenubarVisibleInFullscreen,$.kThemeDimBlurred,$.kThemeSimpleScrollbar,$.kThemeUseAnimation,$.kWindowsLinuxAltControls];function Nge(e){const{html5FullScreen:t,state:n,type:s,visibleUI:i}=e;return!i.addressBar||Hne()||t||"fullscreen"!==n&&("popup"===s||"settings"===s)}function Pge(e){const{vivaldiWindowId:t,selectWindow:n}=e,[s,i]=hs.useState(!1);const o=xT(z.Z),a=xT(G.ZP,n),r=(0,na.Z)(Mge),l=a.get(t),{theme:d,windowStyles:c}=o,h=c.get(t);if(!l||!h)return;const p=function(e,t,n,s,i){const{visibleUI:o,type:a,active:r,nativeDecorations:l,fullscreenMenubarShown:d}=t,c=s[$.kAddressBarPosition],h=(0,G.WV)(t);return As()(lge.Z.call(),h,{...n,"minimal-ui":(0,G.TF)(t),"disable-titlebar":!Nge(t),hasfocus:r,isblurred:!r,native:l,"mac-fullscreen-hover":d&&r&&!i,"mac-fullscreen-hover-notch":d&&r&&i,"mac-menubar-permanent":s[$.kSystemMacMenubarVisibleInFullscreen],normal:!1,popup:"popup"===a,"is-settingspage":"settings"===a,"simple-scrollbar":s[$.kThemeSimpleScrollbar],"dim-blurred":s[$.kThemeDimBlurred],"animation-off":!s[$.kThemeUseAnimation],alt:s[$.kWindowsLinuxAltControls]&&!1,[`address-${c}`]:o.addressBar,[`address-${c}-off`]:!o.addressBar,"tabs-off":!0})}(0,l,Uk.Z.createClassnames(d,h),r,s);return{windowStyle:h,titleBarEnabled:Nge(l),className:p,keyAccess:r[$.kKeyboardTabToAll],nativeDecorations:l.nativeDecorations}}var Dge,xge=_ge(age,{});function Oge(e){const t=Pge(hs.useContext(xi.Z));if(!t)return null;const{className:n,titleBarEnabled:s,windowStyle:i,keyAccess:o,nativeDecorations:a}=t;return _ge("div",{id:"browser",style:i,className:n},void 0,xge,_ge("div",{id:"header"},void 0,s&&_ge(Ope,{isHidden:!1,tabPosition:"none",isPopupWindow:!0,keyAccess:o,native:a})),_ge("div",{id:"main"},void 0,_ge(fp,{level:"title_bar"},void 0,e.children)))}function Lge(e,t,n,s){Dge||(Dge="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Dge,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Rge=[$.kAddressBarPosition];function Bge(e){const t=ie.ZP.unsafeGetActivePage(e);return{page:t,url:t.url,id:t.id,active:G.ZP.isActive(e),favIconUrl:t.favIconUrl}}class Fge extends hs.PureComponent{static contextType=xi.Z;state=Bge(this.context.vivaldiWindowId);componentDidMount(){const{selectWindow:e}=this.context;ie.ZP.addListener(this.onPageStoreChanged,e),G.ZP.addListener(this.onWindowStoreChanged,e),this.updateTitle()}componentWillUnmount(){ie.ZP.removeListener(this.onPageStoreChanged),G.ZP.removeListener(this.onWindowStoreChanged)}onWindowStoreChanged=()=>{this.setState({active:G.ZP.isActive(this.context.vivaldiWindowId)})};onPageStoreChanged=()=>{this.setState(Bge(this.context.vivaldiWindowId),(()=>{this.updateTitle()}))};updateTitle=()=>{const e=(0,je.d6)(this.state.page.url,this.state.page.title);this.context.document.title!==e&&(this.context.document.title=e)};render(){const e="top"===this.props.prefValues[$.kAddressBarPosition],t=e?"bottomLeft":"topLeft",n=e?"below":"above";return Lge(Oge,{},void 0,Lge("div",{id:"main"},void 0,Lge("div",{className:"mainbar"},void 0,Lge("div",{className:"toolbar toolbar-mainbar toolbar-large"},void 0,Lge(Iee,{readonly:!0,url:this.state.url,id:this.state.id,pageContext:this.state.page.context,supportsReaderMode:this.state.page.supportsReaderMode,isReaderModeActive:Boolean(this.state.page.vivExtData.readerMode),active:this.state.active,favIconUrl:this.state.favIconUrl,popupPosition:n,menuOrigin:t}),Lge(Ma,{name:"Extensions",customizeMenu:[],size:"large",popupPosition:n,menuOrigin:t}))),0!==this.state.id&&Lge(Zge,{page:this.state.page,active:this.state.active})))}}const Vge=sa(Fge,Rge);var Wge,Uge;function Hge(e,t,n,s){Wge||(Wge="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Wge,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function zge(e){const t=hs.useContext(xi.Z);return hs.useEffect((()=>{function e(e){Ne.Z.set($.kSettingsSizeWidth,Math.max(t.outerWidth,h.MK)),Ne.Z.set($.kSettingsSizeHeight,Math.max(t.outerHeight,h.mR)),Ne.Z.set($.kSettingsSizeLeft,t.screenLeft),Ne.Z.set($.kSettingsSizeTop,t.screenTop)}return C.Z.windowPrivate.onWindowClosed.addListener(e),()=>{C.Z.windowPrivate.onWindowClosed.removeListener(e)}}),[t]),Hge(Oge,{},void 0,Hge("div",{className:"webpageview"},void 0,Hge(e2,{url:$1+e.settingsCategory})))}function Gge(e,t,n,s){Uge||(Uge="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Uge,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class $ge extends hs.PureComponent{state={appElm:void 0,contentWindow:void 0};onAppWindowCreated=async(e,t)=>{const n=t.document;if(!n.body)return void console.error(`Application document creation failed: ${e}`);const s=n.body.appendChild(n.createElement("div"));s.id="app",this.setState({appElm:s,contentWindow:t})};onWebContentsHasWindow=async(e,t)=>{if(e===this.props.windowId){if(C.Z.windowPrivate.onWebContentsHasWindow.removeListener(this.onWebContentsHasWindow),t||(t=s.Z.extension.getViews().find((t=>t.vivaldiWindowId===e))),!t)throw new Error("BrowserWindow ContentWindow does not exist.");await this.onAppWindowCreated(e,t)}};componentDidMount(){const e=s.Z.extension.getViews().find((e=>e.vivaldiWindowId===this.props.windowId));e&&this.props.windowId?this.onWebContentsHasWindow(this.props.windowId,e):C.Z.windowPrivate.onWebContentsHasWindow.addListener(this.onWebContentsHasWindow)}componentWillUnmount(){const{contentWindow:e}=this.state;e?e.close():console.error("WindowPortal.componentWillUnmount: Expected to find contentWindow")}render(){const{appElm:e,contentWindow:t}=this.state;return e&&t?pa.createPortal(Gge(xi.Z.Provider,{value:t},void 0,Gge(fp,{level:"nothing"},void 0,this.props.children)),e):null}}const Kge=$ge;var jge;function Yge(e,t,n,s){jge||(jge="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:jge,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var Xge=Yge(Ige,{}),Qge=Yge(Vge,{});class qge extends hs.PureComponent{state={windows:G.ZP.getState()};componentDidMount(){G.ZP.addListener(this._onWindowStoreChanged)}componentWillUnmount(){G.ZP.removeListener(this._onWindowStoreChanged)}_onWindowStoreChanged=()=>{const e=G.ZP.getState();e.size!==this.state.windows.size&&this.setState({windows:e})};renderWindows=()=>{const e=[];for(const[t,n]of this.state.windows){let s;"normal"===n.type?s=Xge:"popup"===n.type?s=Qge:"settings"===n.type&&(s=Yge(zge,{settingsCategory:G.ZP.settingsCategory})),s&&e.push(Yge(Kge,{windowId:t},t,s))}return e};render(){return Yge("div",{lang:q.ZP.UI_LANGUAGE},void 0,this.renderWindows())}}const Jge=qge;var eme=n(11795),tme=n.n(eme);const nme=function(){const e=ps.ZP.getSpeeddialFolders();if(!e||0===e.length||!e[0].children)return;const t=e[0].children.map((e=>e.url?{title:e.title,url:e.url}:void 0)).filter(Boolean);C.Z.bookmarksPrivate.updateSpeedDialsForWindowsJumplist(t)};const sme={start:function(){nme(),ps.ZP.addListener(nme)}};n(34155);function ime(e,t){return e.displayName=t,tme().log(e)()}function ome(e,t){const n=Date.now(),s=e(),i=Date.now();return console.log(`Non-promise from ${t||"[anonymous]"} with time ${i-n} ms`),s}navigator.serviceWorker?.ready.then((()=>Re.Z.open()));async function ame(){const e=await C.Z.utilities.getSystemDateFormat();e.longDateFormat&&N().defineLocale(q.ZP.fixMomentLocale(s.Z.i18n.getUILanguage())+"-viv",q.ZP.getLocale(e))}console.time("JS init startup"),(0,V.MD)();try{if(!o)throw new Error("Expected portalWindow to be defined");const e=document.getElementById("portals");if(!e)throw"No root element.";!async function(e){y.Z.reorderRegistrations([u.Z,ie.ZP]),window.isGuestSession=await C.Z.runtimePrivate.isGuestSession(),await Promise.all([ime(H.Z.loadPromise,"PrefsCache").then((()=>ime(E.Z.loadPromise,"vivaldiSettings"))).then((()=>Promise.all([ime(cs.Z.loadPromise,"WindowActions").then((()=>ime(is.Z.loadPromise,"ThemeActions"))),ime(Gn.Z.load,"SearchEngineCache"),ime(xn.Z.loadPlatformSupport,"ProxyActions.loadPlatformSupport")]))),ime(ds.Z.loadPromise,"VivaldiFeatureFlags"),ame()]),d.ZP.load();const t=(0,Fhe.s)(e);await new Promise((e=>t.render((0,fs.jsx)(Jge,{ref:e})))),(0,et.a)(),T.Z.initFastForward(),Un.Z.init(),os.Z.init(),Pn.Z.init();const n=window.isGuestSession?Promise.resolve():ime(g.Z.loadPromise,"BookmarkActions");await Promise.all([ime((()=>I.loadPromise().then((()=>ime(v.Z.loadPromise,"CommandActions")))),"ContentScriptActions"),ime(ae.Z.loadPromise,"Menu"),ime(Nn.Z.loadPromise,"NoteActions"),n,ime(L.loadPromise,"HistoryActions"),ime(Xn.loadPromise,"SyncActions"),ime(as.Z.loadPromise,"TrashActions"),ime(ls.loadPromise,"VivaldiAccountActions"),ime(kq.Z.loadPromise,"WorkspaceActions"),ime(Gq.Z.loadPromise,"WorkspaceLinkRoutingActions"),ome(Hn.Z.init,"ReadingListActions"),ome($n.Z.load,"SearchFieldActions"),ime(Dn.Z.load,"PeriodicReloadActions"),ime(Kn.Z.loadPromise,"SessionActions"),ime(xn.Z.loadPromise,"ProxyActions"),ime(Q.loadPromise,"HueActions")&&void 0,ime(A.Z.load,"DownloadActions")&&void 0,ime((()=>Mn.startPortalLoad()),"Mail")&&void 0,ime(k.loadPromise,"DirectMatchActions"),ime(ss.loadPromise,"SyncedTabsActions")]),ome(sme.start,"updateJumplist"),s.Z.extension.inIncognitoContext||(m.Z.init(),zn.initPortalDocument()),Wn.init(),C.Z.utilities.cleanUnusedImages(0),console.timeEnd("JS init startup")}(e)}catch(e){console.log("Startup Process Failure: "+e)}},27770:(e,t,n)=>{"use strict";n.d(t,{TR:()=>y,ZP:()=>w,yR:()=>f});var s=n(59486),i=n(46382),o=n(53576),a=n(29087),r=n(63153),l=n(92292),d=n(98010),c=n(45454),h=n(7064),p=n(30460),u=n(36436),g=n(44850),m=n(89175),v=n(1407);const f="vivaldi/x-bookmarks";function y(e){return!(0,g.$0)(e)}const C={openUrls:function(e,t,n,s){const i=t.map((e=>({...this.getEmptyNode(),url:e})));this.open(e,i,n,s)},open:function(e,t,n,o){if(o&&a.Z.get(m.kBookmarksConfirmOpening)&&t.length>=a.Z.get(m.kBookmarksConfirmOpeningThreshold))i.Z.showConfirmOpenLinksDialog(e,{urls:t.map((({url:e})=>e)).filter(Boolean),openOptions:{inCurrent:n.inCurrent,inNewWindow:n.inNewWindow,inBackground:n.inBackground,incognito:n.incognito,allowOverride:!1}});else{let i=!1===n.inCurrent;const o=!0===n.inNewWindow;let l=!0===n.inBackground;const d=!0===n.incognito;if(!1===i&&!1===o&&!1===l&&!0===n.allowOverride&&(!0===a.Z.get(m.kBookmarksOpenInNewTab)&&(i=!0,!0===a.Z.get(m.kTabsOpenNewInBackground)&&(l=!0)),1===t.length&&(t[0].url||"").startsWith("javascript:")&&(i=!1)),!0===o){0;const n=t.map((e=>e.url)).filter(Boolean).filter((e=>s.ZP.filterUrl(e).length>0));r.Z.openBrowserWindow(e,n,{incognito:d,transition:h.Z.historyPrivate.TransitionType.AUTO_BOOKMARK})}else{let n=t.filter((e=>e.url&&s.ZP.filterUrl(e.url).length>0));"directrightofcurrent"===a.Z.get(m.kTabsNewPlacement)&&(i?n.reverse():(n=[n[0],...n.toSpliced(0,1).toReversed()],l=!0));const o=n.length-1;n.forEach(((t,n)=>{i?this.openInNewTab(e,t,l||n!==o):(this.openInCurrentTab(e,t),i=!0)}))}}},openInNewTab:function(e,t,n){o.ZP.openURL(e,t.url,{bookmarkId:t.id,inCurrent:!1,inBackground:n,transition:h.Z.historyPrivate.TransitionType.AUTO_BOOKMARK})},openInCurrentTab:function(e,t){o.ZP.openURL(e,t.url,{bookmarkId:t.id,inCurrent:!0,transition:h.Z.historyPrivate.TransitionType.AUTO_BOOKMARK})},getBookmarksByNode:function(e){let t=[];return e.children?t=t.concat(e.children.filter((e=>s.ZP.isBookmark(e)))):s.ZP.isBookmark(e)&&t.push(e),t},getUrlsByNodes:function(e){return e.map((e=>C.getBookmarksByNode(e))).flat().map((e=>e.url)).filter(Boolean).filter((e=>s.ZP.filterUrl(e).length>0))},getOpenOptionsFromDisposition:function(e,t,n,s){const i={inCurrent:!1,inBackground:!1,inNewWindow:!1,allowOverride:!1,incognito:!1};switch(t){case"setting":return(0,c.Z)(e,s);case"current":return{...i,inCurrent:!0};case"new-tab":return{...i,inBackground:n||a.Z.get(m.kTabsOpenNewInBackground)};case"new-window":return{...i,inNewWindow:!0};case"new-private-window":return{...i,inNewWindow:!0,incognito:!0};default:return i}},isCopyModifierPressed:function(e){return e.ctrlKey},makeEventFlagsFromApiResponse:function(e){const t={altKey:void 0,button:void 0,ctrlKey:void 0,metaKey:void 0,shiftKey:void 0};return e.left?t.button=0:e.right?t.button=2:e.center&&(t.button=1),e.ctrl&&(t.ctrlKey=!0),e.alt&&(t.altKey=!0),e.shift&&(t.shiftKey=!0),e.command&&(t.metaKey=!0),t},verifyForUpdate(e,t){const n={...e};if(n.url&&(n.url=n.url.trim()),n.title&&(n.title=n.title.trim()),n.nickname&&(n.nickname=n.nickname.trim()),n.description&&(n.description=n.description.trim()),t)n.url="";else{let e=n.url||p.p;const{schemeParsed:t}=h.Z.utilities.isUrlValid(e);""===t&&(e=(0,u.q9)(e)),n.url=e}return n},verifyForCreate(e,t){const n={...e};if(n.url&&(n.url=n.url.trim()),n.title&&(n.title=n.title.trim()),n.nickname&&(n.nickname=n.nickname.trim()),n.description&&(n.description=n.description.trim()),t)n.url="";else{let e=n.url||p.p;const{schemeParsed:t}=h.Z.utilities.isUrlValid(e);""===t&&(e=(0,u.q9)(e)),n.url=e}return n},convertToPrivateType(e){const t={id:e.id,title:e.title,nickname:e.nickname,description:e.description,thumbnail:e.thumbnail,partner:e.partner,speeddial:e.speeddial,themeColor:e.themeColor,bookmarkbar:e.bookmarkbar,trash:e.trash};return e.parentId&&(t.parentId=e.parentId),e.index&&(t.index=e.index),e.url&&(t.url=e.url),e.dateAdded&&(t.dateAdded=e.dateAdded),e.dateGroupModified&&(t.dateGroupModified=e.dateGroupModified),e.children&&(t.children=[]),t},getEmptyNode:()=>({id:"",title:"",nickname:"",description:"",thumbnail:"",partner:"",speeddial:!1,themeColor:"",bookmarkbar:!1,trash:!1}),extractTitleFromEvent:function(e){const{dataTransfer:t}=e.nativeEvent;if(!t)return"";let n=t.getData("vivaldi/x-title");if(""===n){const e=t.getData("text/html");if(""!==e){const t=document.createElement("div");t.innerHTML=e;const s=t.getElementsByTagName("a");if(s&&s[0]){const e=s[0].textContent;""!==e&&(n=e)}}}return n||(n=e.dataTransfer.getData("text/plain")??""),n},isUriListType:e=>"text/uri-list"===e||"vivaldi/x-uri-list"===e,extractUriListFromEvent:function(e){const{dataTransfer:t}=e.nativeEvent;if(!t)return"";let n=t.getData("vivaldi/x-uri-list");return n||(n=t.getData("text/uri-list")),n??""},getUrlsFromEventPromise(e,t){return new Promise(((n,s)=>{const i=e.dataTransfer.getData(v.Up),o=this.extractUriListFromEvent(e);if(i){const e=JSON.parse(i).ids.map((e=>parseInt(e))).sort(((e,t)=>e-t));l.Z.tabs.query({},(t=>n(t.filter((t=>e.some((e=>t.id===e)))).filter((({url:e=""})=>e&&!(0,g.pM)(e))).map((({title:e,url:t=""},n)=>({title:e||(0,d.ZP)(t),url:t}))))))}else{if(o.length>0){const t=C.extractTitleFromEvent(e);return n(o.split("\n").map(((e,n)=>({url:e,title:0===n&&""!==t?t:(0,d.ZP)(e)}))))}if(!0!==t)return s();{let t=e.dataTransfer.getData("text/plain");if(t.length>0){if((0,u.K2)(t))return n([{url:t,title:(0,d.ZP)(t)}]);if(t=t.trim(),t.length>0&&!/\s/.test(t)){const e=t.indexOf(".");if(e>0&&e<t.length-1&&(t=(0,u.q9)(t),(0,u.K2)(t)))return n([{url:t,title:(0,d.ZP)(t)}])}return s()}}}}))},isBookmarkable:y},w=C},30460:(e,t,n)=>{"use strict";n.d(t,{p:()=>s});const s="http://bookmark.placeholder.url/"},9126:(e,t,n)=>{"use strict";n.d(t,{R:()=>l,l:()=>d});var s=n(15800),i=n(29087),o=n(30381),a=n.n(o),r=n(87852);function l(e){const t=s.Z.getCalendarFilterPrefsKey(e),n=e===r.Nw||e===r.G6?"day":"month",o=i.Z.get(t);return{displayMode:o.displayMode??n,showCompletedTasks:o.showCompletedTasks??!1}}function d(e){return"number"==typeof e?{displayMode:"month",filterText:"",anchorDate:(new(a())).startOf("hour"),selectedDate:(new(a())).startOf("hour"),allDaySelected:!1,showCompletedTasks:!1,selectedEvent:"",editing:!1,...l(e)}:{displayMode:"month",filterText:"",anchorDate:(new(a())).startOf("hour"),selectedDate:(new(a())).startOf("hour"),allDaySelected:!1,selectedEvent:"",editing:!1,showCompletedTasks:!1}}},87265:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var s=n(45660),i=n(25372),o=n(7064);const a={constructUrl:e=>e.filter(Boolean).map((e=>("/"===e.charAt(0)&&(e=e.substring(1)),e.endsWith("/")&&(e=e.substring(0,e.length-1)),e))).join("/"),concatUrl(e,t){const n=(0,i.Z)(e);if(!n)return"";const{protocol:s,host:o}=n;return(s||"")+"//"+(o||"")+t},stripDoubleQuotes:e=>e.split('"').join(""),parseHttpStatusCode(e){try{return parseInt(e.split(" ")[1],10)}catch(e){s.Z.error("Calendar",["network"],"Error parsing http status",e)}return-1},httpStatusSuccess(e){const t=a.parseHttpStatusCode(e);return t>=200&&t<300},getCalDAVUrl(e,t){const n=(0,i.Z)(e);if(!n)return"";const{protocol:s,host:o}=n;return s&&o&&t?`${s}//${a.constructUrl([o,t])}`:""},urlForEvent(e,t,n){const{uid:s,href:r}=n;let l="",d="";const c=(0,i.Z)(e);if(c){const{protocol:e,host:n}=c;if(e&&n&&r){const{urlValid:t}=o.Z.utilities.isUrlValid(r);l=t?r:`${e}//${n}${r}`}else{if(!e||!n||!s)throw"Error. Missing protocol, host uid ";const{urlValid:i}=o.Z.utilities.isUrlValid(t);if(i)l=`${a.constructUrl([t,s])}.ics`;else{const i=e+"//"+n;d=`/${a.constructUrl([t,s])}.ics`,l=a.constructUrl([i,d])}}}return{eventServerUrl:l,eventHref:d}}},r=a},1712:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var s=n(2934),i=n(50522),o=n(48735),a=n(15800),r=n(56371),l=n(25201);const d={getCalendarCreateParams:()=>({name:"",description:(0,r.Z)("New Calendar"),accountId:a.Z.getDefaultAccountId(),color:a.Z.getCalendarCreateColor(),timezone:"",active:!1,supportedCalendarComponent:{vevent:!0,vtodo:!0,vjournal:!1}}),getAccountCreateParams:()=>({name:(0,r.Z)("Local Calendars"),url:"",account_type:"local",username:""}),createLocalAccountAndCalendar:async(e,t)=>{t={...d.getCalendarCreateParams(),...t};const n=d.getLocalAccount();if(n){return await s.Z.createCalendar({...t,accountId:n.id},n)}{e={...d.getAccountCreateParams(),...e};const n=await s.Z.createAccount(e);return{...await s.Z.createCalendar({...t,accountId:n.id,description:e.name},n),account:n}}},getLocalAccount:()=>i.Z.getAccounts().find((e=>"local"===e.account_type)),startDeletingAccount:async e=>{const t=i.Z.getAccounts().find((t=>t.id===e));if(!t)return;const{username:n,url:a}=t;s.Z.stopListeners();try{await s.Z.deleteAccount(e),(0,l.QN)({username:n,url:a})}finally{s.Z.startListeners(),o.Z.doneDeleteAccount(e)}}},c=d},15800:(e,t,n)=>{"use strict";n.d(t,{Z:()=>R});var s=n(50522),i=n(6320),o=n(65792),a=n.n(o),r=n(45502),l=n(46382),d=n(80008),c=n.n(d),h=n(96951),p=n(29087),u=n(2699),g=n(19486),m=n(56371),v=n(45660),f=n(42568),y=n.n(f),C=n(25372),w=n(24522),b=n(23542),S=n(25765),I=n(87852),k=n(74400),A=n(36436),T=n(58821),Z=n(65741),E=n(89175),_=n(47543);const M=new Set(["id","uid","calendarId","start","end","allDay","task","timezone","etag","href","sequence","syncPending","deletePending","filteredOut"]),N=(0,b.extendMoment)(c()),P=y()((function(e){let t=a()(e);t.get("lab.l")<12.5?t=t.set("lab.l",12.5):t.get("lab.l")>77.5&&(t=t.set("lab.l",77.5));const n=t.set("lab.l",t.get("lab.l")<70?"+70":"-70");return{"--colorCalendarBg":t.css(),"--colorCalendarBgAlpha":t.alpha(.2).css(),"--colorCalendarFg":n.css()}}),{maxSize:100});function D(e){const t=Math.abs(e);return`${e<=0?"+":"-"}${Math.floor(t/60).toString().padStart(2,"0")}${Math.floor(t%60).toString().padStart(2,"0")}${Number.isInteger(e)?"":Math.round(t%1*60).toString().padStart(2,"0")}`}function x(e,t,n){return`BEGIN:${t.toUpperCase()}\nDTSTART:${N.tz(e.dtStart,n).format("YYYYMMDDTHHmmss")}\nTZOFFSETFROM:${D(e.offsetFrom??0)}\nTZOFFSETTO:${D(e.offsetTo??0)}\nTZNAME:${e.name??""}\n${e.rDates.map((e=>`RDATE:${N.tz(e,n).format("YYYYMMDDTHHmmss")}\n`)).join("")}END:${t.toUpperCase()}\r\n`}function O(e,t,n){const s=N.tz.zone(e);if(!s)return"";const i=Math.min(n,Date.now()+3650*w.hd),o=`BEGIN:VTIMEZONE\r\nTZID:${e}`;let a="";const{untils:r=[],offsets:l=[],abbrs:d=[]}=s;if(1===r.length)a+=`BEGIN:STANDARD\nDTSTART:19700101T000000\nTZOFFSETFROM:${D(l[0])}\nTZOFFSETTO:${D(l[0])}\nTZNAME:${d[0]}\nEND:STANDARD\r\n`;else{let n=r.findIndex((e=>e>t));n=Math.max(n,1);const s={standard:null,daylight:null};do{const t=l[n]-l[n-1],i=t>=0||t%15!=0?"standard":"daylight";!s[i]||s[i].offsetFrom===l[n-1]&&s[i].offsetTo===l[n]||(a+=x(s[i],i.toUpperCase(),e),s[i]=null);const o=s[i];o?o.rDates.push(r[n-1]):s[i]={dtStart:r[n-1],offsetFrom:l[n-1],offsetTo:l[n],name:d[n],rDates:[]},n++}while(n<r.length&&r[n-1]<i);s.standard&&(a+=x(s.standard,"STANDARD",e)),s.daylight&&(a+=x(s.daylight,"DAYLIGHT",e))}return`${o}\r\n${a}END:VTIMEZONE\r\n`}const L={validColor:function(e){return(e??"").match(/^#?([0-9a-f]{6})([0-9a-f]{2})?$/i)?.[1]??!1},getCalendarColor:e=>{const t=L.validColor(e?.color);return t?`#${t}`:g.Z.getThemeWithFallback(u.Z.getCurrentId()).colorHighlightBg},getCalendarColorStyles:e=>P(L.getCalendarColor(e)),getEventColors:e=>{const t=s.Z.getCalendars().find((t=>t.id===e));return L.getCalendarColorStyles(t)},getCalendarColors:()=>{let e="";for(const t of s.Z.getCalendars()){e+=`.calendar${t.id} {`;const n=L.getCalendarColorStyles(t);for(const[t,s]of Object.entries(n))e+=`${t}: ${String(s)};`;e+="}"}return e},getEventSquircle:()=>'<svg\n      viewBox="0 0 8 8"\n      xmlns="http://www.w3.org/2000/svg"\n    >\n      <rect width="8" height="8" rx="3" />\n    </svg>',createCalendarIcon:(e,t,n=!1)=>{const s=L.getCalendarColor(e);let i="";if(n){i=`<path d="M 8 17 l 7 7 l 11 -11 l -3 -3 l -8 8 l -4 -4  z" fill="#${a()(s).luminance()>.9?"000":"FFF"}" />`}return`<svg viewBox="0 0 32 32">\n      <circle cx="16" cy="16" r="${t}" fill="${s}" />\n      ${i}\n    </svg>`},createCalendarIconPNG:e=>{const t=L.getCalendarColor(e),n=document.createElement("canvas");n.width=32,n.height=32;const s=n.getContext("2d");return s.beginPath(),s.arc(16,16,Math.floor(32/3),0,2*Math.PI,!1),s.fillStyle=t,s.fill(),n.toDataURL("image/png").replace("data:image/png;base64,","")},initializeEvent:(e,t)=>{const n=i.Z.getStateForPage(e),o=e===I.G6?"day"!==n.displayMode:!["day","week"].includes(n.displayMode),{start:a,end:r,task:l=!1,allDay:d=!o&&n.allDaySelected,title:c=""}=t||{};let h=0,u=0;if(a)h=a;else if(!l&&n.selectedDate){const e=n.selectedDate.valueOf();h=o&&0===(0,T.oR)(e)?e+10*w.QI:e}u=l?r??0:r?d?N(r).startOf("day").add(1,"day").valueOf():r:d?N(h).add(1,"day").valueOf():h+p.Z.get(E.kCalendarDefaultDuration);let g,m=-1;d?p.Z.get(E.kCalendarDefaultAlldayNotification)&&(m=p.Z.get(E.kCalendarDefaultAlldayNotificationTime)):m=p.Z.get(E.kCalendarDefaultNotification),-1!==m&&(g=[{id:"",name:"",when:m*w.lb}]);const v=L.getDefaultCalendar(l);let f=v?.id||"";if(l&&!v?.supportedCalendarComponent?.vtodo||!l&&!v?.supportedCalendarComponent?.vevent){const e=s.Z.getAccounts().find((e=>e.id===v?.accountId));if(!e)throw new Error("Can not create event, no account found! Broken data.");const t=l?"vtodo":"vevent",n=s.Z.getCalendars().find((n=>n.accountId===e.id&&n.supportedCalendarComponent?.[t]));n&&(f=n.id)}const{is_template:y,exceptionEvents:C,...b}=t;return{...b,title:c,calendarId:f,uid:crypto.randomUUID(),id:"",start:h,end:u,allDay:d,task:l,notifications:g,invites:[],attachment:[]}},shouldSaveEvent:(e,t)=>{const n=!e.id,s=Object.entries(e).every((([t,n])=>!n||M.has(t)||"notifications"===t&&function(e){return 1===e.notifications?.length&&(!e.allDay&&p.Z.get(E.kCalendarDefaultNotification)*w.lb===e.notifications?.[0].when||!!e.allDay&&p.Z.get(E.kCalendarDefaultAlldayNotification)&&p.Z.get(E.kCalendarDefaultAlldayNotificationTime)===e.notifications?.[0].when)}(e)||Array.isArray(n)&&0===n.length));if(n)return s?"DELETE":"SAVE";{const{notifications:n,...i}=e,{notifications:o,...a}=t||{},r=(0,Z.Z)(i,a),l=(0,Z.Z)(n,o);return r&&l?"IGNORE":r?"SAVE_INVITED":s?"DELETE":"SAVE"}},isOwnEvent(e){const{account:t}=L.getAccountAndCalendar(e.calendarId);if("ical"===t?.account_type)return!1;if(!e.organizer)return!0;return p.Z.get(E.kMailAccounts).some((t=>t.MAIL_EMAIL===e.organizer))},shouldIncrementSequence:(e,t)=>{const n=e=>[e.address,e.partstat];if(!t)return!1;const s=(t.invites||[]).map(n),i=(e.invites||[]).map(n);return t.start!==e.start||t.end!==e.end||t.allDay!==e.allDay||!(0,Z.Z)(t.rrule,e.rrule)||!(0,Z.Z)(s,i)||!(0,Z.Z)(t.recurrenceExceptions||[],e.recurrenceExceptions||[])},getDisplayRange:(e,t)=>{let n,s;switch(t){case"agenda":n=N(e).startOf("day"),s=N(e).add(1,"month").endOf("day");break;case"month":n=N(e).startOf("month").weekday(0),s=N(e).endOf("month").weekday(6);break;case"multiweek":n=N(e).subtract(1,"week").startOf("week"),s=N(e).add(1,"week").endOf("week");break;default:n=e.clone().startOf(t),s=e.clone().endOf(t)}return N.range(n,s)},getEventRange:e=>{const t=e.task?e.start||e.end:e.start,n=e.end||e.start;if(t&&n)return N.range(t,n)},isMultiDayEvent:e=>{if(e.allDay)return!0;if(e.task&&e.end&&!e.start)return!1;const t=N(e.start),n=N(e.end);return!t.isSame(e.end,"day")&&!(n.diff(t,"day",!0)<1&&n.isSame(n.clone().startOf("day")))},isRecurringEvent:e=>Boolean(e.rrule),isGeneratedRecurringEvent:e=>-1!==("string"==typeof e?e:e.id).indexOf(":"),getGeneratedSourceEvent:e=>{const[t]=e.id.split("-")[0].split(":"),n=s.Z.getEvents().find((e=>e.id===t));if(!n)throw new Error(`Source event not found for recurring event id: ${e.id}`);return n},getBaseEventIfException:e=>{const[t]=e.id.split("-")[0].split(":"),n=s.Z.getEvent(t);if(n?.recurrenceExceptions?.length&&!e.recurrenceExceptions?.length)return n},generateKey:(e,t)=>{const{calendarId:n,id:s,uid:i,sequence:o}=e;return`${n}-${s}-${i??""}-${o??""}-${t??""}`},eventHasText:(e,t)=>{const n=t.toLowerCase();return["title","description","location","url","invites","organizer"].some((t=>(Array.isArray(e[t])?function(t){return"invites"===t&&e.invites?e.invites.map((e=>e.address)).join(""):""}(t):e[t]||"").toLowerCase().indexOf(n)>=0&&!e.trash))},eventSearchPredicate:(e,t)=>""===e.id||L.eventHasText(e,t),searchEvents:(e,t)=>e.filter((e=>L.eventSearchPredicate(e,t))).sort(((e,t)=>t.start-e.start)),filterEventsByPeriod:(e,t,n,s=1)=>{const i=t.clone();let o,a;"allday"===n?(o=i.startOf("day").valueOf(),a=i.add(s-1,"day").endOf("day").valueOf()):(o=i.startOf(n).valueOf(),a=i.add(s-1,n).endOf(n).valueOf());const r=t.dayOfYear(),l=e.filter((e=>e.id.indexOf("-")>0)).map((e=>e.id.split("-"))).filter((([e,t])=>parseInt(t)<=r)).reduce(((e,[t,n])=>(e[t]=Math.max(e[t]||0,parseInt(n)),e)),{}),d=e.filter((e=>{if(e.task){let t=e.end;return t||(t=e.start),e.start&&t?e.start<=a&&t>o||e.start===t&&e.start>=o&&e.start<a:!!t&&(t>=o&&t<=a)}return e.start<a&&(e.end||e.start)>o||e.start<a&&e.start>=o})).filter((e=>{const[t,n]=e.id.split("-");return n?l[t]===parseInt(n):!(t in l)}));return"hour"===n?d.filter((e=>!L.isMultiDayEvent(e))):"allday"===n?d.filter((e=>L.isMultiDayEvent(e))):d},foldIcal:function(e){return e.split(/\r?\n/).map((e=>{if(e.length<=75)return e;let t="",n=0;for(;n<e.length;)n+75>=e.length?t+=e.substr(n):t+=e.substr(n,73)+"\r\n ",n+=73;return t})).join("\r\n")},notificationToVAlarm:function(e){const{name:t,when:n}=e;return`BEGIN:VALARM\nACTION:DISPLAY\nDESCRIPTION:${t}\nTRIGGER:${n>0?"-":""}${N.duration(Math.abs(n)).toString()}\nEND:VALARM`},eventsToICalendar:function(e,t={}){const{method:n,includeRecurrenceId:s=!0}=t,i=N.tz().format(w.FI),o=["BEGIN:VCALENDAR","PRODID:-Vivaldi Calendar V1.0//EN","VERSION:2.0","CALSCALE:GREGORIAN","DTSTAMP:"+i];n&&o.push(`METHOD:${n}`),o.push("");let a=o.join("\r\n");const r=(0,T.EP)()||"utc",l=e.reduce(((e,t)=>{if((t.start||t.end)&&!t.allDay&&(t.rrule||t.timezone)){const n=t.timezone||r,s=t.start||1/0;let i=t.end||-1/0;if(t.rrule){const{rrule:e,start:n,timezone:s}=t,o=(0,_.Qj)(e,n,s);i=o?.options.until?o.options.until.valueOf():o?.options.count?o.all().pop().valueOf():1/0}e[n]?e[n]={firstOccurrence:Math.min(s,e[n].firstOccurrence),lastOccurrence:Math.max(i,e[n].lastOccurrence)}:e[n]={firstOccurrence:s,lastOccurrence:i}}return e}),{});for(const e in l)e!==w.$T&&"utc"!==e.toLowerCase()&&(a+=O(e,l[e].firstOccurrence,l[e].lastOccurrence));return e.map((e=>{let t=[];e.organizer&&(t=[`ORGANIZER:mailto:${e.organizer}`]),e.invites&&e.invites.length&&(t=t.concat(e.invites.map((e=>`ATTENDEE;RSVP=TRUE${e.partstat?`;PARTSTAT=${e.partstat}`:""}${`;CN=${e.name||e.address}`}:mailto:${e.address}`))));const{uid:n,recurrenceId:o}=e,a=Boolean(o&&s);let r="",l="",d="",c="",h="";e.allDay?(c=";VALUE=DATE",r=e.start&&N(e.start).format(w.O5),l=e.end&&N(e.end).format(w.O5),e.task&&(h=N().format(w.O5)),d=a&&N(o).format(w.O5)):e.timezone===w.$T?(r=e.start&&N(e.start).format(w.A),l=e.end&&N(e.end).format(w.A),e.task&&(h=N().format(w.A)),d=a&&N(o).format(w.A)):e.timezone&&"utc"!==e.timezone.toLowerCase()?(c=`;TZID=${e.timezone}`,r=e.start&&N.tz(e.start,e.timezone).format(w.A),l=e.end&&N.tz(e.end,e.timezone).format(w.A),e.task&&(h=N.tz(N(),e.timezone).format(w.A)),d=a&&N.tz(o,e.timezone).format(w.A)):(r=e.start&&N.tz(e.start,"utc").format(w.FI),l=e.end&&N.tz(e.end,"utc").format(w.FI),e.task&&(h=N.tz(N(),"utc").format(w.FI)),d=a&&N.tz(o,e.timezone).format(w.A));const p=e.notifications&&e.notifications.map(L.notificationToVAlarm).join("\n"),u=[],{rrule:g,recurrenceExceptions:m}=e;g&&u.push(function(e){let t=e.replace(/^DTSTART.*\n/,"");return t.startsWith("RRULE:")||(t="RRULE:"+t),t}(g)),m&&m.forEach((t=>{const{date:n,cancelled:s}=t;if(s){let t="",s="";e.allDay?(t=";VALUE=DATE",s=`${N.tz(n,"utc").format(w.O5)}`):e.timezone===w.$T?s=N(n).format(w.A):e.timezone?(t=`;TZID=${e.timezone}`,s=N.tz(n,e.timezone).format(w.A)):s=N.tz(n,"utc").format(w.FI),u.push(`EXDATE${t}:${s}`)}}));const v=e.task?"DUE":"DTEND";return[e.task?"BEGIN:VTODO":"BEGIN:VEVENT","DTSTAMP;VALUE=DATE-TIME:"+i,e.description?`DESCRIPTION:${(0,k.ES)(e.description)}`:"",e.location?`LOCATION:${(0,k.ES)(e.location)}`:"",e.url?`URL:${e.url}`:"",l?`${v}${c}:${l}`:"",r?`DTSTART${c}:${r}`:"",d?`RECURRENCE-ID${c}:${d}`:"",Number.isInteger(e.sequence)?`SEQUENCE:${e.sequence||0}`:"",`SUMMARY:${(0,k.ES)(e.title)}`,n?`UID:${n}`:"",...t,...u,L.attachmentsToString(e.attachment),e.complete?"STATUS:COMPLETED":"",e.complete?`COMPLETED${c}:${h}`:"",p||"",e.task?"END:VTODO\r\n":"END:VEVENT\r\n"].filter(Boolean).join("\r\n")})).forEach((e=>{a+=e})),L.foldIcal(a+"END:VCALENDAR")},attachmentsToString:e=>(e||[]).map((e=>{const{filename:t,fmttype:n,url:s}=e;if(s){return`ATTACH${t?`;FILENAME=${(0,k.ES)(t)}`:""}${n?`;FMTTYPE=${n}`:""}:${s}`}})).filter(Boolean).join("\r\n"),stringToAttachments:(e="")=>e.split("\r\n").filter((e=>Boolean(e)&&-1!==e.indexOf("ATTACH")&&-1===e.indexOf("ENCODING")&&-1===e.indexOf("BINARY"))).map((e=>{const[t,n]=(0,k.Vl)(e,":",2),s=t.match(/FILENAME=([^;:]+)/),i=t.match(/FMTTYPE=([^;:]+)/);return{url:n,filename:s?s[1]:void 0,fmttype:i?i[1]:void 0}})),getDefaultCalendar:(e=!1)=>{const t=e?E.kCalendarDefaultTaskCalendarId:E.kCalendarDefaultCalendarId,n=p.Z.get(t),i=s.Z.getWritableCalendars();let o=i.find((e=>e.id===n));return!o&&i.length>0&&(o=e?i.find((e=>e.supportedCalendarComponent?.vtodo)):i.find((e=>e.supportedCalendarComponent?.vevent))),o||(o=i[0]),o},getAccountAndCalendar:e=>{const t={account:void 0,calendar:void 0},n=s.Z.getAccounts();if(t.calendar=s.Z.getCalendars().find((t=>t.id===e)),!t.calendar)return t;const{accountId:i}=t.calendar;return t.account=n.find((e=>e.id===i)),t},getDefaultAccountId:()=>{const e=L.getDefaultCalendar(),t=s.Z.getAccounts(),n=t.find((t=>t.id===e?.accountId));return!n&&t.length>0?t[0].id:n?.id??""},isRemoteCalendar:e=>{const t=s.Z.getCalendars().find((t=>t.id===e));if(!t?.active)return!1;const{accountId:n}=t;return!!s.Z.getAccounts().find((e=>e.id===n))?.url},isGoogleCalendar:e=>{const t=s.Z.getCalendars().find((t=>t.id===e));if(!t)return!1;const{accountId:n}=t,i=s.Z.getAccounts().find((e=>e.id===n));return!(!t||!i||"google"!==i.account_type)},isLocalCalendar:e=>{const t=s.Z.getAccounts(),n=s.Z.getCalendars().find((t=>t.id===e));if(!n)return!1;const{accountId:i}=n,o=t.find((e=>e.id===i));return!!o&&"local"===o.account_type},isCalendarValidToCreate:e=>{const{description:t,supportedCalendarComponent:n}=e,{vevent:s,vtodo:i}=n||{vevent:!1,vtodo:!1};return Boolean(t)&&(s||i)},isCalDAV:e=>"vivaldi"===e||"caldav"===e||"google"===e||"fastmail"===e,isOAuthProvider:e=>"vivaldi"===e||"google"===e||"fastmail"===e,ensureAccountType:e=>"icloud"===e?"caldav":Object.keys(S.d).find((t=>t===e))||"local",doesCalendarsExistsAndShowWarning:e=>0===s.Z.getCalendars().length?(l.Z.showCalendarAccountDialog(e),!1):0!==s.Z.getWritableCalendars().length||(l.Z.showModal(e,{modal:{title:(0,m.Z)("No Writable Calendar Defined"),body:(0,m.Z)("At least one calendar that supports creating events is required to add an event."),actions:[{title:(0,m.Z)("Open Calendar Settings"),action:"settings",default:!0}],cancelAction:{title:(0,m.Z)("Cancel"),action:"cancel"}}}).then((({action:t})=>{"settings"===t&&l.Z.showSettings(e,"calendar")})),!1),getLocalGoogleTasksCalendars:e=>"google"!==e.account_type?[]:s.Z.getCalendars().filter((t=>t.accountId===e.id&&t.supportedCalendarComponent?.vtodo)),getPollResultText(e){const{calendars:t,error:n,message:s,didPoll:i}=e;if(n)return s||(0,m.Z)("Unknown error.");if(!i)return(0,m.Z)("Poll already in progress.");const o=t.reduce(((e,t)=>e+t.numberOfChangedCalendars),0);return 0===o?(0,m.Z)("Refresh complete. No change."):(0,m.Z)("Refresh complete. $1 calendar was updated.","Refresh complete. $1 calendars were updated.",[o])},getPageId:e=>"panel"===r.Z.getContext(e).area?I.G6:h.ZP.getActivePage(e)?.id,minimalCreateEvent:e=>({calendarId:"",is_template:!1,title:"",...e}),validateEventTypes:e=>(e.sequence||0)>2147483647?(v.Z.warn("Calendar",["Validating Event"],"Value in field: Sequence is to high. Sequence set to 0"),{...e,sequence:0}):e,ensureHttpsForWebcal(e){const t=(0,C.Z)(e);if(!t)throw new Error("Can not parse invalid URL for webcal");return"webcal:"===t.protocol&&(t.protocol="https:"),(0,A.q9)(t.href)},getCalendarCreateColor:()=>{const e=S.h.map((e=>e.value.toLocaleLowerCase().replace("#",""))),t=[];s.Z.getCalendars().forEach((n=>{const s=n.color?.toLowerCase().replace("#","")||"";e.includes(s)&&t.push(s)}));let n=e.filter((e=>!t.includes(e)));return n.length||(n=e),`#${n[Math.floor(Math.random()*n.length)]}`},getCalendarFilterPrefsKey:e=>{let t="";return t=e===I.Nw?E.kCalendarTaskPanelFilter:e===I.G6?E.kCalendarPanelFilter:E.kCalendarManagerFilter,t}},R=L},58821:(e,t,n)=>{"use strict";n.d(t,{EP:()=>m,FL:()=>f,FY:()=>h,KC:()=>k,PX:()=>u,Ro:()=>p,VV:()=>v,Xq:()=>c,Yu:()=>C,aE:()=>b,bn:()=>w,oJ:()=>S,oR:()=>A,sG:()=>y,zX:()=>I});var s=n(29087),i=n(88212),o=n(80008),a=n.n(o),r=n(24522),l=n(47543),d=n(89175);function c(e,t){const n=t?t.clone():e.clone(),s=n.startOf("month");return Math.floor((e.diff(n,"day")+1+s.weekday()-1)/7)}function h(e,t,n,s=!0){const i=n.clone();let o=7*e+1-i.startOf("month").weekday()+t;if(s){const e=i.endOf("month").date();o=Math.max(1,Math.min(o,e))}return i.date(o)}function p(e,t,n=!1){const s=t.clone(),i=s.endOf("month").weekday(),o=n?i-e:(i-e+7)%7;return s.subtract(o,"day")}function u(e,t,n=!1){const s=t.clone(),i=s.startOf("month").weekday(),o=n?e-i:(e-i+7)%7;return s.add(o,"day")}let g=null;function m(){return null===g&&(g=Intl.DateTimeFormat().resolvedOptions().timeZone??"",setTimeout((()=>g=null),1e4)),g}function v(e,t){t&&t!==r.$T||(t=m());const n=a().tz(e,t);return new Date(Date.UTC(n.year(),n.month(),n.date(),n.hour(),n.minute(),n.second()))}function f(e,t){return t&&t!==r.$T||(t=m()),a().tz([e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds()],t).toDate()}function y(e){const{start:t=0,end:n=0,allDay:o}=e;if(e.task&&!t&&!n)return e;if(n&&n<t&&(e.end=t+(o?r.hd:s.Z.get(d.kCalendarDefaultDuration))),e.task||n||(e.end=e.allDay?t+r.hd:t),e.allDay){if(e.timezone=r.$T,e.start){const t=new Date(e.start),n=new Date(t.getFullYear(),t.getMonth(),t.getDate());e.start=n.valueOf()}if(e.task){const t=new Date(e.end||0),n=new Date(t.getFullYear(),t.getMonth(),t.getDate());e.end=n.valueOf()}else if(!e.task&&e.end){const t=new Date(e.end),n=new Date(t.getFullYear(),t.getMonth(),t.getDate());e.end=n.valueOf(),e.start===e.end&&(e.end=e.end+r.hd)}}const{start:a=0,end:c=0}=e;if(e.rrule&&a&&c-a>r.S){const t=(0,l.Qj)(e.rrule,a);if(t){const n=(0,l.xL)(t,new Date(a));n&&n.valueOf()<c&&(e.end=n.valueOf(),i.ZP.warn("Calendar",`Event '${e.title}' truncated to prevent overlapping instances.`))}}return e}function C(e){return e.timezone&&e.timezone!==r.$T?e.timezone:m()||""}function w(e,t){const n=m(),s=e.timezone||n;if(t===r.$T)return e.timezone=t,e;if(t===r.ad)e.timezone=n,t=n||"UTC";else{if(!a().tz.zone(t))return e;e.timezone=t}if(e.start){const n=a().tz(e.start,s);e.start=a().tz(n.format(r.A),t).valueOf()}if(e.end){const n=a().tz(e.end,s);e.end=a().tz(n.format(r.A),t).valueOf()}return e}function b(e,t=!1){const n=t?m():C(e),s=a().tz(e.start,n),i=a().tz(e.end,n);return e.allDay&&e.start&&e.end&&i.subtract(1,"day"),{start:s,end:i}}function S(e){return e.task?e.start?e.start:e.end?e.end:NaN:e.start}function I(e){return Math.ceil(e/r.QI)*r.QI}function k(e,t){return Math.abs(e-t)<r.hd&&e.getDate()===t.getDate()}function A(e){return(e-new Date(e).getTimezoneOffset()*r.lb)%r.hd}},34930:(e,t,n)=>{"use strict";n.d(t,{Z:()=>Z});var s,i=n(12442),o=n(15800),a=n(72010),r=n(46382),l=n(29087),d=n(67294),c=n(94283),h=n(15489),p=n(56371),u=n(88951),g=n(97823),m=n(80008),v=n.n(m),f=n(13311),y=n(27569),C=n(89175),w=n(34155);function b(e,t,n,i){s||(s="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=i;else if(a>1){for(var r=new Array(a),l=0;l<a;l++)r[l]=arguments[l+3];t.children=r}if(t&&o)for(var d in o)void 0===t[d]&&(t[d]=o[d]);else t||(t=o||{});return{$$typeof:s,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function S(e){const t=g.Z.getAccountsAndAliases();let n=(0,y.o$)([e],t,!1,!1);return n&&(n=(0,y.SG)(n)),n}function I(e){const{document:t,HTMLTextAreaElement:n}=d.useContext(c.Z),[s,i]=d.useState("");d.useEffect((()=>{const e=t.querySelector('textarea[name="note"]');e instanceof n&&e.addEventListener("input",(e=>{i(e.target.value.replace(/(?:\r\n|\r|\n)/g,"<br />"))}))}),[t,n]);const o=d.useMemo((()=>S(e.from)),[e.from]),a=`${A(e.event,e.sendAction)}<br /><br />${s}${o}`;return b("div",{},void 0,(0,p.Z)("Send email invitation to notify $1 participant about the event.","Send email invitations to notify $1 participants about the event.",[e.recipients.length]),b("div",{className:"Invitation-Preview"},void 0,b("div",{className:"Invitation-Preview-Title"},void 0,(0,p.Z)("Invitation Message Preview:")),b("div",{className:"Invitation-Preview-Body",dangerouslySetInnerHTML:{__html:a}})))}function k(e,t,n){const s=new Set(n.map((([e])=>e)));let i="create";i=s.has("create")?"create":s.has("update")?"update":"cancel";const o=[{title:(0,p.Z)("Send"),action:"send",default:!0}];return"cancel"!==i&&o.push({title:(0,p.Z)("Edit Event"),action:"edit",default:!1}),{title:e.task?(0,p.Z)("Invite Task Participants"):(0,p.Z)("Invite Event Participants"),body:b(I,{event:e,from:t,recipients:n,sendAction:i}),actions:o,cancelAction:{title:(0,p.Z)("Don’t Notify Participants"),action:"cancel",default:!1},inputs:[{name:"note",label:(0,p.Z)("Add a Custom Note to the Message (optional):")}]}}function A(e,t){const n=e.organizer;if(!n)throw new Error(`Event organizer not found for event uid ${String(e.uid)}`);const s=`<strong>${a.Z.getContactsWithAddress(n)?.name||n}</strong>`,i=`<strong>${e.title}</strong>`,o=`<strong>${e.location??""}</strong>`,r=v().tz(e.start||e.end,e.timezone).toLocaleString();let l="";switch(t){case"create":l=(e.start||e.end)&&e.location?(0,p.Z)("$1 has invited you to an event “$2”, on $3, at “$4”.",[s,i,r,o]):e.start||e.end?(0,p.Z)("$1 has invited you to an event “$2”, on $3.",[s,i,r]):e.location?(0,p.Z)("$1 has invited you to an event “$2”, at “$3”.",[s,i,o]):(0,p.Z)("$1 has invited you to an event “$2”.",[s,i]);break;case"update":l=(e.start||e.end)&&e.location?(0,p.Z)("$1 has updated event “$2”, on $3, at “$4”.",[s,i,r,o]):e.start||e.end?(0,p.Z)("$1 has updated event “$2”, on $3.",[s,i,r]):e.location?(0,p.Z)("$1 has updated event “$2”, at “$3”.",[s,i,o]):(0,p.Z)("$1 has updated event “$2”.",[s,i]);break;case"cancel":l=(0,p.Z)("$1 has cancelled event “$2”.",[s,i])}return e.description&&(l+=`<br /><br />${e.description}`),l}async function T(e,t,n,s){const i=[t],o={type:"html",content:s.body+S(t)},a={type:"attachment",filename:"invite.ics",content:(new TextEncoder).encode(s.iCal),mimeType:"application/ics",fileSize:s.iCal.length},r=s.iCal.match(/METHOD:\s*(\w+)/);r&&(a.method=r[1]);const l=Date.now();f.Z.sendExternalMessage(e,{bcc:[],bodyParts:[o,a],cc:[],flags:[],forwarded:void 0,from:i,listId:"",listPost:"",inReplyTo:"",internal:!1,messageId:(0,u.Z)(i[0].address),replied:void 0,sentDate:l,subject:s.subject,threadKey:void 0,to:n})}const Z={getOrganizerForEvent:function(e){const{account:t}=o.Z.getAccountAndCalendar(e.calendarId);if(t)return"google"===t?.account_type?t.username:l.Z.get(C.kCalendarMailAccount)},sendAttendeeMails:async function(e,t,n,s=!1){if(o.Z.isGoogleCalendar(t.calendarId))return"cancelled";const a=h.ZP.getLastActiveBrowserWindowId(),l=t.organizer;if(!l)throw new Error(`Event organizer not found for event uid ${String(t.uid)}`);const d={address:l},c=await r.Z.showModal(a,{modal:k(t,d,n)});if(await new Promise((e=>w.nextTick(e))),"cancel"===c.action)return"cancelled";if("edit"===c.action)return e&&Number.isInteger(e)&&i.Z.selectEvent(e,{event:t,edit:!0}),"edit";let u="",g="",m="REQUEST";const v=n.map((([e,n])=>{switch(e){case"create":u=(0,p.Z)("Event invitation: $1",[t.title]),m="REQUEST";break;case"update":u=(0,p.Z)("Event updated: $1",[t.title]),m="REQUEST";break;case"cancel":u=(0,p.Z)("Event cancelled: $1",[t.title]),m="CANCEL"}g=A(t,e);const{note:i}=c.inputs||{};i&&(g+="<br/><br/><strong>"+(0,p.Z)("Event organiser added the following note:")+"</strong><br/>"+i.replace(/(?:\r\n|\r|\n)/g,"<br />"));const r={method:m,includeRecurrenceId:s},l=o.Z.eventsToICalendar([t],r),h=n.filter((e=>e.address!==t.organizer)).map((e=>({address:e.address,...e.name?{name:e.name}:null})));if(0===h.length)return;return T(a,d,h,{subject:u,body:g,iCal:l})}));return await Promise.all(v),"sent"},sendReplyMails:async function(e,t,n,s,i){let a="",r="";const l=t.organizer;if(!l)throw new Error(`Event organizer not found for event uid ${String(t.uid)}`);const d={address:"DECLINECOUNTER"===i?l:s},c=`<strong>${n}</strong>`,h=`<strong>${t.title}</strong>`;switch(i){case"ACCEPTED":a=(0,p.Z)("Accepted: $1",[t.title]),r=(0,p.Z)("$1 has accepted your invitation to “$2”",[c,h]);break;case"TENTATIVE":a=(0,p.Z)("Tentatively accepted: $1",[t.title]),r=(0,p.Z)("$1 has tentatively accepted your invitation to “$2”",[c,h]);break;case"DECLINED":a=(0,p.Z)("Declined: $1",[t.title]),r=(0,p.Z)("$1 has declined your invitation to “$2”",[c,h]);break;case"DECLINECOUNTER":a=(0,p.Z)("Event change proposal declined: $1",[t.title]),r=(0,p.Z)("$1 has declined your proposed changes to “$2”",[c,h])}const u={method:"DECLINECOUNTER"===i?"DECLINECOUNTER":"REPLY"};return T(e,d,[{address:"DECLINECOUNTER"===i?c:l}],{subject:a,body:r,iCal:o.Z.eventsToICalendar([t],u)})}}},25765:(e,t,n)=>{"use strict";n.d(t,{d:()=>i,h:()=>o});var s=n(56371);const i={local:(0,s.Z)("data storage","Local"),google:(0,s.Z)("Google Calendar"),vivaldi:(0,s.Z)("Vivaldi.net"),caldav:(0,s.Z)("CalDAV"),ical:(0,s.Z)("Web Calendar"),fastmail:"Fastmail"},o=[{value:"#e73359",name:(0,s.Z)("calendar","Red")},{value:"#ee8835",name:(0,s.Z)("calendar","Orange")},{value:"#696969",name:(0,s.Z)("calendar","Gray")},{value:"#14a434",name:(0,s.Z)("calendar","Green")},{value:"#4facf2",name:(0,s.Z)("calendar","Blue")},{value:"#b260d3",name:(0,s.Z)("calendar","Purple")},{value:"#8b7251",name:(0,s.Z)("calendar","Brown")}]},8336:(e,t,n)=>{"use strict";n.d(t,{CP:()=>v,Km:()=>u,tV:()=>f});var s=n(50522),i=n(15800),o=n(80008),a=n.n(o),r=n(42568),l=n.n(r),d=n(23542),c=n(47543),h=n(90870);const p=(0,d.extendMoment)(a());function u(e,t){const n={...t},i=(t.recurrenceExceptions||[]).filter((t=>e.valueOf()===t.date));if(!(i.length>0)){const{start:s,end:i}=function(e,t){const n={start:0,end:0};if(t.task)if(t.start&&t.end){const s=t.end-t.start;n.start=e.valueOf(),n.end=e.valueOf()+s}else n.end=e.valueOf();else{const s=(t.end||t.start)-t.start;n.start=e.valueOf(),n.end=e.valueOf()+s}return n}(e,t);return n.start=s,n.end=i,n.id=`${t.id}:${e.valueOf()}`,n.uid=t.uid,{event:n}}{const t=i[0],{cancelled:n,parent_event_id:o,exception_event_id:a}=t;if(!n&&o&&a){const t=s.Z.getEvent(o),n=s.Z.getEvent(a);if(t&&n){const s={...n},i=s.start||s.end;return s.id=`${t.id}:${i}`,s.rrule=t.rrule,s.recurrenceId=e.valueOf(),{event:s,exceptionId:a}}}}return{event:null}}const g=l()((function(e){return(0,h.Z)(e,i.Z.isRecurringEvent)}));function m(e,t){let n=[];const[i,o]=g(e);let a=[];i.forEach((e=>{if(function(e){return Boolean(e.task&&!e.end)}(e))return;const{start:i,end:o,end_recurring:r,rrule:l,timezone:d}=e;if(r&&r<t.start.valueOf())return;const h=(0,c.Qj)(l,i||o,d),p=i&&o?o-i:0,g=(0,c.YE)(h?.toString()||"",{from:t.start.valueOf()-p,to:t.end.valueOf(),eventStart:i,timezone:e.timezone}),[m,v]=((e,t,n)=>{const s=[],i=[],o=n.start.valueOf(),a=n.end.valueOf();return t.forEach((t=>{const{event:n,exceptionId:r}=u(t,e);if(n){const e=n.start||n.end,t=n.end||n.start;e<=a&&t>o&&s.push(n)}r&&i.push(r)})),[s,i]})(e,g,t);a=a.concat(m);for(const i of e.recurrenceExceptions??[]){const{cancelled:e,exception_event_id:o}=i;if(!e&&o&&!v.includes(o)){const e=s.Z.getEvent(o);let{start:i,end:r}=e??{};if(!(e&&i&&r))continue;i?r||(r=i):i=r,i<=t.end.valueOf()&&r>t.start.valueOf()&&(a.push(e),n.push(o))}}n=n.concat(v)}));return o.filter((e=>{if(n.includes(e.id))return!1;if(e.task){if(!e.start&&!e.end)return!1;if(e.start){const{start:n,end:s}=e;return(s&&s!==n?s:n+1)>t.start.valueOf()&&n<=t.end.valueOf()}return t.contains(e.end)}{const{start:n,end:s}=e;return(s&&s!==n?s:n+1)>t.start.valueOf()&&n<=t.end.valueOf()}})).concat(a)}const v={call:e=>m(e,p.range(p(),p().add(1,"week"))).filter((e=>!(e.task&&e.complete))).sort(((e,t)=>e.start!==t.start?e.start-t.start:e.allDay!==t.allDay?e.allDay?-1:1:e.end!==t.end?e.end-t.end:parseInt(e.id||0)-parseInt(t.id||0)))},f={call:l()(((e,t,n)=>m(e,i.Z.getDisplayRange(t,n))),{maxSize:3})}},48735:(e,t,n)=>{"use strict";n.d(t,{Z:()=>ze});var s=n(2934),i=n(34929),o=n(50522),a=n(87265),r=n(15800),l=n(79706),d=n(60331),c=n(56371),h=n(64877),p=n(25372);var u=n(98035),g=n(28773);const{urlForEvent:m}=a.Z;function v(e){switch(e){case"get":return"GET";case"delete":return"DELETE";case"update":case"create":return"PUT"}}function f(e,t,n,s,i){const{etag:o}=t,{url:a,username:l,password:d,accessToken:c,account_type:h}=e,{eventHref:p,eventServerUrl:u}=m(a,n,t),f={};let y;"delete"!==i&&(!o||"update"!==i&&"get"!==i?"create"===i&&(f["If-None-Match"]="*"):f["If-Match"]=`"${o}"`,y="text/calendar; charset=utf-8");const C=s.length?r.Z.eventsToICalendar(s):null;return{username:l,password:d,accessToken:c,account_type:h,url:u,href:p,...(0,g.Z)(Object.keys(f).length?{headers:f}:null),...(0,g.Z)(y?{contentType:y}:null),...(0,g.Z)(C?{body:C}:null),method:v(i)}}var y=n(45660),C=n(23796),w=n(84384),b=n(29526);const{stripDoubleQuotes:S}=a.Z;var I=n(15805),k=n(34006),A=n(12964);const{stripDoubleQuotes:T}=a.Z;function Z(e,t){y.Z.error("Calendar",["iCal","Error creating: "],t.SUMMARY,t,e)}function E(e,t){let n=[];const s=(0,w.Z)(e);return!s.parsererror&&"d_multistatus"===s.root&&s.d_multistatus.d_response&&(n=s.d_multistatus.d_response.map((e=>{if(-1===e?.d_status?.content?.indexOf("200"))return null;const n=e.d_href?(0,b.Z)(e.d_href.content):"",s=T(e?.d_propstat?.d_prop?.d_getetag?.content||""),i=!!e?.d_propstat?.d_prop?.d_resourcetype?.c_calendar,o=(0,A.Z)(e?.d_propstat);if(i||o)return;const a=e.d_propstat?.d_prop?.c_calendarData?.content||"",r=(0,I.Z)(a);if(r.VEVENT.length)try{return(0,k.rP)(r.VEVENT[0],t,{href:n,etag:s})}catch(e){Z(e,r.VEVENT[0])}else{if(!r.VTODO?.length)return r.VJOURNAL?.length?void 0:{href:n,etag:s};try{return{...(0,k.rP)(r.VTODO[0],t,{href:n,etag:s}),task:!0}}catch(e){Z(e,r.VTODO[0])}}})).filter(Boolean)),n}var _=n(8687),M=n(7064),N=n(24522),P=n(1407);function D(e,t,n){t||(t=r.Z.getCalendarCreateColor());const{vevent:s,vtodo:i}=n||{vevent:!0,vtodo:!1};return`<?xml version="1.0" encoding="utf-8"?>\n    <C:mkcalendar xmlns:C="urn:ietf:params:xml:ns:caldav"><set xmlns="DAV:">\n      <prop><displayname>${e}</displayname>\n        <C:supported-calendar-component-set>\n        ${s?'<C:comp name="VEVENT" />':""}\n        ${i?'<C:comp name="VTODO" />':""}\n        </C:supported-calendar-component-set>\n        <calendar-color xmlns="http://apple.com/ns/ical/">${t}</calendar-color>\n      </prop></set>\n    </C:mkcalendar>`}var x=n(82164);const{constructUrl:O,stripDoubleQuotes:L}=a.Z;function R(e){let t="";return e.split("/").forEach((e=>{e.includes("@")&&(t=e)})),t}async function B(e,t){const n=await i.Z.getAuthentication(e),{accessToken:s}=n,o=[(0,N.fP)(),"/v3/calendars",`?key=${await(0,x.w)()}`],a=O(o),r=await fetch(a,{method:"POST",headers:{Authorization:`Bearer ${s}`,Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({summary:t})}),l={status:!1,message:"",description:"",name:""};if(r.ok){const e=function(e){const{id:t,summary:n,etag:s,timeZone:i}=e;return{name:t,description:n,ctag:L(s),timezone:i}}(await r.json());l.status=!0,l.description=e.description,l.name=`/caldav/v2/${e.name}/events/`,l.ctag=e.ctag}return l}var F=n(80008),V=n.n(F),W=n(81723),U=n(90870),H=n(58821);const{getLocalGoogleTasksCalendars:z}=r.Z,{constructUrl:G,stripDoubleQuotes:$}=a.Z,K="YYYY-MM-DDTHH:mm:ss[Z]";function j(e){const{items:t=[],etag:n}=e;return{...e,etag:$(n),items:t.map((e=>({...e,etag:$(e.etag)})))}}function Y(e,t){const{title:n,notes:i,etag:o,due:a,id:r,completed:l}=e,d=a?V().tz(V()(a),"UTC").valueOf():void 0,c=l?V().tz(V()(l),"UTC").valueOf():void 0,h={id:t.id,calendarId:t.calendarId,title:n,task:!0,description:i??"",end:d,etag:$(o),status,uid:r,complete:Boolean(l),completed:c,timezone:N.$T,allDay:!0},[p]=s.Z.transformVivaldiEvents([h]);return p}function X(e,t){const{title:n,notes:s,due:i,etag:o,id:a,completed:r}=e,l=r?V()(r).valueOf():void 0;return{calendarId:t,title:n,is_template:!1,task:!0,description:s,end:i?V()(i).valueOf():void 0,etag:$(o),status,uid:a,complete:Boolean(r),completed:l,timezone:N.$T,allDay:!0}}async function Q(e){const t=await i.Z.getAuthentication(e),{parsed:n,status:a}=await q(t),r={numberOfCalendarsPolled:0,numberOfChangedCalendars:0};if(n.error){const t=new Date;return o.Z.getState().calendars.filter((t=>t.accountId===e.id)).forEach((async e=>await s.Z.updateCalendar(e.id,{lastChecked:t.valueOf()},!1))),y.Z.log("Calendar",["google","tasks"],"Error fetching TaskList: ",a,n),r}const l=j(n),d=z(e);r.numberOfCalendarsPolled=l.items.length;const c=(0,W.Z)(l.items,d,((e,t)=>{const{id:n}=e;return n===t.name})),h=await async function(e,t,n){return await Promise.all(e.map((async e=>{const i={accountId:t.id,name:e.id,description:e.title,active:n,supportedCalendarComponent:{vevent:!1,vtodo:!0,vjournal:!1}},o=await s.Z.createCalendar(i,t);return o.calendar?o.calendar:Promise.reject()})))}(c,e,d.length>0),[p,u]=(0,U.Z)(d,(e=>l.items.some((t=>t.id===e.name))));await Promise.all(u.map((async e=>{await s.Z.deleteCalendar(e)})));const g=h.concat(p),m=(0,W.Z)(g,l.items,((e,t)=>{const{name:n}=e;return n===t.id&&e.ctag===t.etag}));await Promise.all(m.map((async e=>{const n=function(e){const{items:t=[],etag:n}=e;return{...e,etag:$(n),items:t.map((e=>({...e,etag:$(e.etag)})))}}(await async function(e,t){const{accessToken:n}=e,s=["showCompleted=true","showHidden=true"],i=`${(0,N.fL)()}/tasks/v1/lists/${t}/tasks?${s.join("&")}&key=${await(0,x.w)()}`,o=await fetch(i,{method:"GET",headers:{Accept:"application/json",Authorization:`Bearer ${n}`}}),{status:a,ok:r,statusText:l}=o;if(!r)throw y.Z.log("Calendar",["google, tasks"],"Error getting tasks",a,l),Error(`Error getting tasks", ${a} ${l}`);return await o.json()}(t,e.name)),i=o.Z.getEventsPerCalendar(e.id),a=n.items.filter((e=>!i.some((t=>t.uid===e.id)))),d=i.filter((e=>-1===n.items.findIndex((t=>t.id===e.uid)))),c=i.map((e=>{const t=n.items.find((t=>t.id===e.uid&&$(t.etag)!==e.etag));return t?{...Y(t,e)}:null})).filter(Boolean),h=a.map((t=>X(t,e.id)));await Promise.all(h.map((e=>s.Z.createEvent(e,!1)))),await Promise.all(d.map((e=>s.Z.deleteEvent(e.id)))),await Promise.all(c.map((e=>{const t=e.rrule?"all":"single";return s.Z.updateEvent(e,t)})));const p=l.items.find((t=>e.name===t.id));let u={ctag:n.etag};p?.title!==e.description&&(u={...u,description:p?.title}),(h.length||d.length||c.length)&&r.numberOfChangedCalendars++,await s.Z.updateCalendar(e.id,u,!1)})));const v=new Date;return g.forEach((async e=>await s.Z.updateCalendar(e.id,{lastChecked:v.valueOf()},!1))),r}async function q(e){const{accessToken:t}=e,n=`${(0,N.fL)()}/tasks/v1/users/@me/lists?maxResults=200&key=${await(0,x.w)()}`,s=await fetch(n,{method:"GET",headers:{Accept:"application/json",Authorization:`Bearer ${t}`}}),{status:i,ok:o,statusText:a}=s;if(!o)throw y.Z.log("Calendar",["google, tasks"],"Error fetching task lists ",i,a),Error(`Error fetching task lists, ${i} ${a}`);return{status:i,parsed:await s.json()}}const{httpStatusSuccess:J,parseHttpStatusCode:ee,stripDoubleQuotes:te}=a.Z;async function ne(e,t,n,s){const i={staleSyncToken:!0,createdUpdated:[],deletedHrefs:[],error:!0,serverThrottlesEvents:!1,syncToken:""},o=await(0,_.ZP)((a=e,r=t,{...a,method:"REPORT",headers:{depth:"0"},body:`<?xml version="1.0" encoding="UTF-8"?>\n    <D:sync-collection xmlns:D="DAV:"\n      xmlns:CS="http://calendarserver.org/ns/"\n      xmlns:C="urn:ietf:params:xml:ns:caldav">\n    <D:sync-token>${encodeURI(r??"")}</D:sync-token>\n    <D:sync-level>1</D:sync-level>\n    <D:prop>\n      <D:getetag />\n    </D:prop>\n    </D:sync-collection>`}),n);var a,r;const{status:l,ok:d}=o;return d||403!==l?function(e,t){const n=(0,w.Z)(e),s={createdUpdated:[],deletedHrefs:[],syncToken:"",serverThrottlesEvents:!1,error:!0,staleSyncToken:!1};if(n.parsererror)return s;const{d_syncToken:i,d_response:o}=n.d_multistatus;if(i&&(s.syncToken=i.content,s.error=!1),!o)return s;const a=[];o.forEach((e=>{let n=e.d_status?.content;if(!n)try{n=e.d_propstat.d_status.content}catch(e){y.Z.error("Calendar",["parser"],"parseSyncCollection: ",e)}const i=J(n);t===e.d_href.content?e?.d_status?.content&&507===ee(e.d_status.content)&&(s.serverThrottlesEvents=!0):a.push({etag:e.d_propstat?.d_prop?.d_getetag?te(e.d_propstat.d_prop.d_getetag.content):"",href:(0,b.Z)(e.d_href.content),isDeletedOnServer:i})}));const[r,l]=(0,U.Z)(a,(e=>e.isDeletedOnServer));return{...s,createdUpdated:r.map((({href:e,etag:t})=>({href:e,etag:t}))),deletedHrefs:l.map((({href:e})=>e)),error:!1}}(o.response,s):i}var se=n(36154);const{concatUrl:ie}=a.Z;var oe=n(89873);async function ae(e,t,n,s,i){let o=1e3,a=[];const r=n.length,l=[...n];return await async function d(){if(1===o)throw new Error("Error fetching events from server");const h=(0,oe.Z)(l,o);for(const p of h){const h=await(0,_.ZP)(re(t,p),e),{status:u,ok:g}=h;if(!g){if(u>=500&&u<=599){o=Math.max(1,Math.min(o,n.length)/2),await d();break}throw new Error("Error fetching events from server (multiget)")}{l.splice(0,p.length),a=a.concat(E(h.response,s));const e=a.length,t=Math.round(e/r*100);i((0,c.Z)("Fetching events $1 of $2 ($3%)",[e,r,t]))}}}(),a}function re(e,t){return{...e,method:"REPORT",body:`<?xml version="1.0" encoding="UTF-8"?>\n    <c:calendar-multiget xmlns:d="DAV:" xmlns:c="urn:ietf:params:xml:ns:caldav">\n    <d:prop>\n        <d:getetag />\n        <c:calendar-data />\n    </d:prop>\n      ${t.map((e=>`<d:href>${e}</d:href>`)).join("\n")}\n    </c:calendar-multiget>`}}var le=n(88545),de=n(25201),ce=n(9141);const{stripDoubleQuotes:he,getCalDAVUrl:pe,concatUrl:ue}=a.Z,{getLocalGoogleTasksCalendars:ge,isOAuthProvider:me}=r.Z,{VERIFYING:ve,OK:fe,ERROR:ye}=N.LB,{isCalDAV:Ce}=r.Z;let we,be=!1;const Se=new Map;let Ie=!1,ke=!1;const Ae={},Te=new Set,Ze=new Set,Ee=new Set,_e=new Set;function Me(e){const t=(0,p.Z)(e);if(!t)return;const{protocol:n,host:s}=t;return n&&s?n+"//"+s:void 0}async function Ne(){const e=o.Z.getEvents().filter((e=>e.syncPending));for(const t of e)if(r.Z.isRemoteCalendar(t.calendarId))if(t.trash){const{eventNotFound:e,ok:n}=await He.deleteEvent(t.id);(e||n)&&await s.Z.deleteEvent(t.id)}else await He.updateEvent(t);else await u.Z.updateEvent({id:t.id,syncPending:!1})}let Pe=navigator.onLine;function De(){!Pe&&navigator.onLine&&Ne(),Pe=navigator.onLine}function xe(){o.Z.getAccounts().filter((e=>!!e.url)).forEach((e=>{o.Z.getCalendars().filter((t=>t.accountId===e.id)).forEach((t=>{t.active?Ze.has(t.id)||(Ze.add(t.id),Ee.add(e.id)):Ze.has(t.id)&&Ze.delete(t.id)})),Te.has(e.id)||(Te.add(e.id),Ee.add(e.id))})),Ee.size>0&&(we&&clearTimeout(we),we=setTimeout((()=>{He.pollCalDAV(Array.from(Ee)),Ee.clear()}),1e3))}function Oe(e){d.Z.setStatus(P.Ex,e,5e3)}const Le=(e,t)=>{const n=Math.round(e/t*100);Oe((0,c.Z)("Imported $1 of $2 ($3%)",[e,t,n]))};async function Re(e,t,n=!1){const a={calendarId:e.id,ctag:e.ctag,lastCalendarPoll:Date.now(),changed:!1},r=Me(t.url);if(!r)return Promise.reject();const{urlValid:l}=M.Z.utilities.isUrlValid(e.name),d=l?e.name:ue(r,e.name),h=await i.Z.getAuthentication(t);Oe((0,c.Z)('Checking calendar "$1".',[e.description]));const p=e.ctag,u=await(0,_.ZP)(function(e){const{account_type:t}=e,n={Depth:"google"===t?"0":"1"};return{...e,headers:n,method:"PROPFIND",body:'<?xml version="1.0" encoding="UTF-8"?>\n    <D:propfind xmlns:D="DAV:"\n      xmlns:CS="http://calendarserver.org/ns/"\n      xmlns:C="urn:ietf:params:xml:ns:caldav">\n    <D:prop>\n    <D:displayname />\n    <CS:getctag />\n    <D:sync-token />\n    </D:prop>\n    </D:propfind>'}}(h),d),{ctag:g,syncToken:m}=function(e){const t=(0,w.Z)(e),n={displayName:"",ctag:"",syncToken:""};if(!t.parserror){const e=t.d_multistatus.d_response[0].d_propstat.d_prop,s=e.cs_getctag;s&&(n.ctag=S(s.content));const i=e.d_displayname;i&&(n.displayName=i.content);const o=e.d_syncToken;o&&(n.syncToken=(0,b.Z)(o.content))}return n}(u.response);return a.ctag=n&&m?m:g,""===g||p!==g?(a.changed=!0,await async function(e,t,n){const{response:i}=await(0,_.ZP)((a=t,{...a,method:"PROPFIND",headers:{Depth:"1"},body:'<?xml version="1.0" encoding="UTF-8"?>\n    <D:propfind xmlns:D="DAV:">\n      <D:prop>\n        <D:getcontenttype/>\n        <D:resourcetype/>\n        <D:getetag/>\n      </D:prop>\n    </D:propfind>'}),n);var a;const r=E(i,e.id),l=o.Z.getEventsPerCalendar(e.id);let d=l.filter((e=>!r.some((t=>t.href===e.href))));const c=r.filter((e=>!l.some((t=>t.etag===e.etag)))).map((e=>e.href||""));if(0===c.length)return void d.forEach((e=>s.Z.deleteEvent(e.id)));const h=await ae(n,t,c,e.id,(e=>{Oe(e)}));d=d.filter((e=>h.some((t=>e.uid!==t.uid)))),await Promise.all(d.map((e=>s.Z.deleteEvent(e.id)))),await(0,ce.Wy)(l,h);const p=h.filter((e=>!l.some((t=>t.uid===e.uid))));try{await(0,k.nj)(p,Le)}catch(e){y.Z.error("Calendar",["caldav"],"Error creating events",e)}}(e,h,d),a):a}async function Be(e,t){const n={calendarId:e.id,ctag:e.ctag,lastCalendarPoll:Date.now(),changed:!1},a=Me(t.url);if(!a)throw new Error("Missing URL prefix");const r=e.id,l=a+e.name,d=await i.Z.getAuthentication(t),h=o.Z.getEventsPerCalendar(r),p=new Map;h.forEach((e=>{e.href&&p.set(e.href,e.etag)}));let u=[];const g=[],m=[];let v;do{const s=e.ctag,i=await ne(d,s,l,e.name);v=i.serverThrottlesEvents,u=u.concat(i.deletedHrefs);const{staleSyncToken:o,createdUpdated:a,syncToken:r,error:c}=i;if(e={...e,ctag:r},n.ctag=r,o)return await Re(e,t,!0);if(c&&y.Z.warn("Calendar",["caldav"],"CalDAV. Error parsing sync-collection",e.name),s===r)return n;n.changed=!0;const h=new Set,f=a.filter((({etag:e,href:t})=>{const n=!p.has(t);n&&h.add(t);const s=p.has(t)&&p.get(t)!==e;return p.set(t,e),n||s})).map((({href:e})=>e||"")),C=(f.length?await ae(l,d,f,e.id,Oe):[]).filter((e=>!_e.has(e.uid??""))),[w,b]=(0,U.Z)(C,(e=>h.has(e.href??"")));g.push(...w),m.push(...b)}while(v);await(0,ce.Wy)(h,m);const f=h.filter((e=>u.some((t=>t===e.href))));await Promise.all(f.map((e=>s.Z.deleteEvent(e.id)))),Oe((0,c.Z)("Importing $1 events",[g.length]));try{await(0,k.nj)(g,Le)}catch(e){y.Z.error("Calendar",["caldav"],"Error creating events",e)}return n}async function Fe(e,t){const n={calendars:[],error:!1,message:""};t=t??await i.Z.getAuthentication(e);const s=await(0,_.ZP)((0,h.ZP)(t),e.url),{status:o,response:a,ok:r}=s;if(!(r&&o>=200&&o<300))return n.message=He.getStatusMessageAndLog(e,s),n.error=!0,n;if(n.calendars=(0,C.Z)(a),0===n.calendars.length&&y.Z.warn("Calendar",["caldav"],(0,c.Z)("No calendars found on the server for the account “$1”.",[e.name])),"google"===e.account_type){let e;try{e=await async function(e){const{parsed:t,status:n}=await q(e);if(t.error)return y.Z.error("Calendar",["google","tasks"],"Error fetching TaskList: ",n,t),[];const s=j(t);return s.items.map((e=>({ctag:s.etag,name:e.id,description:e.title,color:"",supportedCalendarComponent:{vevent:!1,vtodo:!0,vjournal:!1},supportsSyncCollection:!1,syncToken:""})))}(t)}catch(e){return n.error=!0,n.message=e.message,n}n.calendars.push(...e)}return n}async function Ve(e,t){return Promise.all(e.map((async e=>{const{ctag:n,supportsSyncCollection:i,syncToken:o,...a}=e,r={...a,accountId:t.id,active:e.active??!0,hidden:e.hidden??!1},{calendar:l}=await s.Z.createCalendar(r,t);return l||Promise.reject()})))}async function We(e,t){const n=o.Z.getCalendars().filter((t=>{if("google"===e.account_type){if(!t.supportedCalendarComponent)return;const{vevent:n}=t.supportedCalendarComponent;return t.accountId===e.id&&n}return t.accountId===e.id})),i=t.filter((e=>!n.some((t=>e.name===t.name)))),a=await Ve(i,e),[l,d]=(0,U.Z)(n,(e=>t.some((t=>t.name===e.name))));await Promise.all(d.map((async e=>await s.Z.deleteCalendar(e))));const c=a.concat(l);t.forEach((async e=>{const t=c.find((t=>t.name===e.name));if(!t)return;const n={},i=r.Z.validColor(e.color);i!==t.color&&i&&(n.color=i),e.description!==t.description&&(n.description=e.description),Object.keys(n).length&&await s.Z.updateCalendar(t.id,n,!1)}));const h=c.filter((t=>t.active&&t.accountId===e.id)),p=[];for(const n of h){const s=t.find((e=>e.name===n.name));if(!s)break;s?.supportsSyncCollection?s.syncToken!==n.ctag&&p.push(await Be(n,e)):p.push(await Re(n,e))}await Promise.all(p.filter(Boolean).map((async e=>{const{calendarId:t,ctag:n}=e;await s.Z.updateCalendar(t,{ctag:n},!1)})));const u=p.filter(Boolean).reduce(((e,t)=>(t.changed&&e++,e)),0);return{numberOfCalendarsPolled:h.length,numberOfChangedCalendars:u}}async function Ue(e){navigator.onLine&&!be&&(be=!0,await Ne());const t={didPoll:!1,calendars:[],error:!1,message:""};Ie=!0;let n=o.Z.getAccounts().filter((e=>e.url.length));if(n=n.filter((e=>!Se.has(e.id))),e?.length&&(n=e.map((e=>n.find((t=>t.id===e)))).filter(Boolean)),Se.size&&!ke){ke=!0;try{await Promise.all(Array.from(Se.values()).map((async e=>await e.onRemoval(e.accountId))))}catch(e){y.Z.error("Calendar","Error removing account",e)}finally{ke=!1}}try{for(const a of n){const{url:n,account_type:r,name:d}=a;if(!(!!e&&e.includes(a.id))){const e=o.Z.getState().calendars.filter((e=>e.accountId===a.id)).map((e=>e.lastChecked)).filter(Boolean).reduce(((e,t)=>(t??0)>e?t:e),0),t=Date.now(),n=e?e+1e3*N.jC:t;if(!(n<=t))continue}try{if(s.Z.stopAPIChangeListeners(),t.didPoll=!0,Ce(r)){const e=await i.Z.getAuthentication(a),l=await(0,_.ZP)((0,h.ZP)(e),n),{status:p,response:u,ok:g}=l;let m=[];if(p>=200&&p<300?(m=(0,C.Z)(u),0===m.length&&y.Z.warn("Calendar",["caldav"],(0,c.Z)("No calendars found on the server for the account “$1”.",[d]))):(t.message=He.getStatusMessageAndLog(a,l),t.error=!0),g){if("google"===r){let e;try{e=await Q(a)}catch(e){return t.error=!0,t.message=e.message,t}t.calendars.push(e)}const e=await We(a,m);t.calendars.push(e)}else{const e=o.Z.getState().calendars.filter((e=>e.accountId===a.id)).map((e=>e.id));await Promise.all(e.filter(Boolean).map((async e=>await s.Z.updateCalendar(e,{lastChecked:Date.now()},!1))))}}else if("ical"===r){const e=await l.Z.fetchAndCreate(a);t.calendars.push(e)}}catch(e){t.message=He.getStatusMessageAndLog(a,e),t.error=!0}finally{const e=o.Z.getState().calendars.filter((e=>e.accountId===a.id)).map((e=>e.id));await Promise.all(e.filter(Boolean).map((async e=>await s.Z.updateCalendar(e,{lastChecked:Date.now()},!1)))),s.Z.startAPIChangeListeners()}}}finally{Ie=!1,_e.clear();o.Z.getAccounts().some((e=>e.url))&&(we=setTimeout((()=>Ue()),2e4))}return t}const He={calendarServiceStart(){o.Z.addListener(xe),navigator.connection.addEventListener("change",De)},calendarServiceStop(){o.Z.removeListener(xe),navigator.connection.removeEventListener("change",De),clearTimeout(we)},resetStatus(e){Ae[e]&&(Ae[e].authenticationErrorCount=0)},resetEventRemoteData:e=>(e.href=void 0,e.url=void 0,e.etag=void 0,e),pollCalDAV:e=>(we&&clearTimeout(we),Ie?Promise.resolve({didPoll:!1,calendars:[],message:"",error:!1}):Ue(e)),prepareForDeleteAccount:e=>(Se.set(e.accountId,e),Ue([e.accountId])),doneDeleteAccount(e){Se.delete(e)},async deleteEvent(e){const t=o.Z.getEvents().find((t=>t.id===e)),n={ok:!1,eventNotFound:!1};if(!t||!navigator.onLine)return n;const s=o.Z.getCalendars().find((e=>e.id===t.calendarId));if(!s)return n;const a=o.Z.getAccounts(),{accountId:r}=s,l=a.find((e=>e.id===r));if(l?.url&&s.active){const e=await i.Z.getAuthentication(l);if("google"===l.account_type&&t.task){if(!t.uid)return n;!async function(e,t){const{accessToken:n}=e,s=`${(0,N.fL)()}/tasks/v1/lists/@default/tasks/${t}?key=${await(0,x.w)()}`,i=await fetch(s,{method:"DELETE",headers:{Authorization:`Bearer ${n}`}}),{status:o,ok:a,statusText:r}=i;if(!a)throw y.Z.log("Calendar",["google, tasks"],"Error deleting task",o,r),Error(`Error deleting task", ${o} ${r}`)}(e,t.uid)}else if(t.href){const{href:n}=t,i=await(0,_.ZP)(f(e,{href:n},s.name,[],"delete"));return{ok:i.ok,eventNotFound:404===i.status}}}return n},async updateEvent(e,t){if(!navigator.onLine)return await u.Z.updateEvent({id:e.id,syncPending:!0}),!1;const n={...e},s=o.Z.getCalendars().find((e=>e.id===n.calendarId)),a=o.Z.getAccounts();if(!s)return!1;const{accountId:r}=s,l=a.find((e=>e.id===r));if(!l)return!1;const h=await i.Z.getAuthentication(l);if("google"===l.account_type&&n.task){const t=await async function(e,t,n){const{accessToken:s}=e,{etag:i="",title:o,uid:a="",end:r,description:l}=t,d=`${(0,N.fL)()}/tasks/v1/lists/${n}/tasks/${a}?key=${await(0,x.w)()}`;let c;r&&(c=V().tz(V()(r),"UTC").format(K));const h={status:t.complete?"completed":"needsAction",...(0,g.Z)(t.complete?{completed:V().tz(V()(),"UTC").format(K)}:null)},p={kind:"tasks#taskList",id:`${a}`,etag:`${i}`,title:`${o}`,...(0,g.Z)(c?{due:c}:null),...(0,g.Z)(l?{notes:l}:null),...h},u=await fetch(d,{method:"PUT",headers:{Accept:"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(p)}),{status:m,ok:v,statusText:f}=u;if(!v)throw y.Z.error("Calendar",["google, tasks"],"Error updating task",m,f),Error(`Error updating task", ${m} ${f}`);return await u.json()}(h,n,s.name),{etag:i}=t;return await u.Z.updateEvent({id:e.id,syncPending:!1,etag:i}),!0}if(n.href){const{etag:i,href:a,uid:r}=n,l={etag:i,href:a,uid:r},p=[n];(n.recurrenceExceptions||[]).forEach((e=>{const s=e.exception_event_id;if(s){const i=s===t?.id?t:o.Z.getEvent(s);i&&p.push({...i,recurrenceId:e.date,sequence:n.sequence})}}));const g=await(0,_.ZP)(f(h,l,s.name,p,"update"));let m="";const{ok:v}=g;if(!v){if(!n.href)return!1;const t=await async function(e,t,n){return(await Promise.all(t.map((async t=>{const{urlValid:n}=M.Z.utilities.isUrlValid(t),s=n?t:ie(e.url,t),i=await(0,_.ZP)({...e,method:"GET",url:s,headers:{"Content-Type":"text/calendar"}});if(i.ok){const{etag:e,response:n}=i;return{response:n,etag:e,href:t}}})))).filter(Boolean).map((e=>{const{etag:t,response:s,href:i}=e,{VEVENT:o,VTODO:a}=(0,I.Z)(s);return(0,k.rP)(o.length?o[0]:a[0],n,{etag:t,href:i})}))}(h,[n.href],s.id),{recurrenceExceptions:i,invites:o,notifications:a,...r}=t[0],l={...r,etag:m,syncPending:!1};await u.Z.updateEventFromServer(e.id,l);const p=(0,c.Z)("Calendar. Error synching updates to server. Changes not saved");return y.Z.error("Calendar",["caldav"],p,e),d.Z.setStatus(P.Ex,p,5e3),!1}if(g.etag)m=he(g.etag);else{const e=await(0,_.ZP)(f(h,{uid:n.uid},s.name,[],"get"));m=he(e.etag||"")}return await u.Z.updateEvent({id:n.id,syncPending:!v,etag:m}),v}return n.sequence=0,await He.createEvent(n),!0},async createEvent(e){if(!navigator.onLine)return;const t={...e,uid:e.uid||crypto.randomUUID()},n=o.Z.getAccounts();let s=o.Z.getCalendars().find((e=>e.id===t.calendarId));if(!s)return;const{etag:a,href:r,uid:l}=t,{accountId:d}=s,c=n.find((e=>e.id===d));if(!c)return;const h={etag:a,href:r,uid:l};l&&_e.add(l);const p=await i.Z.getAuthentication(c),m=s.id;if("google"===c.account_type&&t.task){const e=ge(c);if(!e.find((e=>e.id===m))){if(!(e.length>0))return void y.Z.log("Calendar",["google","tasks"],"Warning. No Google Task list found. Task not created.");s=e[0]}const n=await async function(e,t,n){const{accessToken:s}=e,{etag:i="",title:o,uid:a="",end:r,description:l}=n,d=[(0,N.fL)(),"/tasks/v1/lists/",t,`tasks?key=${await(0,x.w)()}`],c=G(d),h=r?V()((0,H.VV)(new Date(r))).format(K):void 0,p={kind:"tasks#taskList",id:`${a}`,etag:`${i}`,title:`${o}`,due:h?`${h}`:void 0,...(0,g.Z)(l?{notes:l}:null)},u=await fetch(c,{method:"POST",headers:{Accept:"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(p)}),{status:m,ok:v,statusText:f}=u;if(!v)throw y.Z.error("Calendar",["google, tasks"],"Error creating task",m,f),Error(`Error creating task", ${m} ${f}`);return await u.json()}(p,s.name,t);t.etag=he(n.etag),t.uid=n.id}else{const e=await(0,_.ZP)(f(p,h,s.name,[t],"create"));let n="";if(t.href=(0,b.Z)(e.href||""),e.etag)n=he(e.etag);else{const e=await(0,_.ZP)(f(p,{uid:t.uid},s.name,[],"get"));n=he(e.etag||"")}t.etag=n}t.syncPending=!1,await u.Z.updateEvent(t),l&&_e.delete(l)},updateCalendar:(e,t)=>new Promise(((n,s)=>{const l=o.Z.getAccounts(),d=o.Z.getCalendars().find((t=>t.id===e));if(!d)return void n();const{accountId:c}=d,h=l.find((e=>e.id===c));if(!h?.url)return void n();const u={};t.description!==d.description&&(u.description=t.description);const g=r.Z.validColor(t.color);t.color===d.color||!g||"google"===h?.account_type&&d.supportedCalendarComponent?.vtodo||(u.color=g),0!==Object.keys(u).length?i.Z.getAuthentication(h).then((e=>{(0,_.ZP)(function(e,t,n,s){let i="";const o=(0,p.Z)(t);if(o){const{protocol:e,host:t}=o;if(e&&t){const s=e+"//"+t;i=a.Z.constructUrl([s,n])}}const r=[];return s.description&&r.push(`<D:displayname>${s.description}</D:displayname>`),s.color&&r.push(`<calendar-color xmlns="http://apple.com/ns/ical/">${s.color}</calendar-color>`),{...e,url:i,method:"PROPPATCH",body:`<?xml version="1.0" encoding="UTF-8"?>\n<D:propertyupdate xmlns:D="DAV:"\nxmlns:CS="http://calendarserver.org/ns/"\nxmlns:C="urn:ietf:params:xml:ns:caldav">\n<D:set>\n<D:prop>\n${r.join("\n")}\n</D:prop>\n</D:set>\n</D:propertyupdate>`}}(e,h.url,d.name,u)).then((e=>{e.ok&&n()})).catch((e=>{s(e)}))})):n()})),async createCalendar(e,t){if("google"===e.account_type){const{name:n,description:s}=t,i=n||s||"";return await B(e,i)}return await async function(e,t){const n={message:"",status:!1,name:"",description:""},{name:s,color:o,description:a,supportedCalendarComponent:r}=t,l=s||a||"";let d;try{d=await i.Z.getAuthentication(e)}catch(e){return n.message=e,n}const{url:h}=d,p=`${h.endsWith("/")?h:h+"/"}${l}`,u={...d,url:p,method:"MKCALENDAR",contentType:"application/xml, text/xml",body:D(l,o,r)},g=await(0,_.ZP)(u);if(g.ok){const e={...u,method:"PROPFIND",headers:{Brief:"t",Depth:"1"},body:'<?xml version="1.0" encoding="utf-8"?><D:propfind xmlns:D="DAV:">\n                  <D:prop><D:getetag /><D:getcontenttype /></D:prop></D:propfind>'},t=await(0,_.ZP)(e);if(t.ok){const e=await t.response,s=(0,w.Z)(e);if(s.d_error||s.parsererror||!s.d_multistatus)return n;s.d_multistatus.d_response.forEach((e=>{const{d_href:t}=e;n.name=t.content,n.status=!0,n.message=(0,c.Z)("Success")}))}}else 405===g.status?n.message=(0,c.Z)("Error creating Calendar. It might already exist."):n.message=(0,c.Z)("Error creating Calendar on Server");return n}(e,t)},async deleteCalendar(e,t){const{account_type:n,url:s}=e;if("google"===n){const n=o.Z.getCalendars().find((e=>e.name===t));if(!n?.supportedCalendarComponent)return{message:(0,c.Z)("Calendar not found"),status:!1};const{supportedCalendarComponent:s}=n,{vtodo:a}=s;if(a){return async function(e,t){const{accessToken:n}=e,s=`${(0,N.fL)()}/tasks/v1/users/@me/lists/${t}?key=${await(0,x.w)()}`,i=await fetch(s,{method:"DELETE",headers:{Authorization:`Bearer ${n}`}}),{status:o,ok:a,statusText:r}=i;if(!a)throw y.Z.log("Calendar",["google, tasks"],"Error deleting Tasklist",o,r),Error(`Error deleting tasklist", ${o} ${r}`);return{status:!0,message:r}}(await i.Z.getAuthentication(e),t)}return await async function(e,t){const n=await i.Z.getAuthentication(e),{accessToken:s}=n,o=[(0,N.fP)(),"/v3/calendars",(a=R(t),a.endsWith("/")?a.slice(0,-1):a),`?key=${await(0,x.w)()}`];var a;const r=O(o);return{status:(await fetch(r,{method:"DELETE",headers:{Authorization:`Bearer ${s}`,Accept:"application/json"}})).ok,message:""}}(e,t)}const a=await i.Z.getAuthentication(e);return await(0,_.ZP)({...a,url:pe(s,t),method:"DELETE",headers:{Depth:"infinity"}})},getCalendarUrl(e,t){if("google"===e)return(0,N.A2)(t);if("vivaldi"===e)return(0,N.Mf)(t);if("fastmail"===e)return(0,N.L9)(t);throw Error("getCalendarUrl. Unsupported account type")},async getCalDAVAccountDetails(e,t){const{name:n,url:s,account_type:o,username:a,password:r}=e,l={id:"",name:n,url:s,account_type:o,username:a,interval:N.jC},d={account:l,password:r,calendars:[]};"vivaldi"===o?l.username=(0,se.JI)(l.username):"fastmail"===o?a&&-1===a.indexOf("@")&&(l.username=`${a}@fastmail.com`):"google"===o&&(l.username=l.username.toLowerCase(),a&&-1===a.indexOf("@")&&(l.username=`${a}@gmail.com`)),t((0,c.Z)("Verifying..."),ve,l);let h={statusMessage:"",foundService:!1};if("caldav"===o){if(h=await(0,le.k)(l,r),!h.foundService){throw t(h.statusMessage||(0,c.Z)("Unknown connection error. Please check your account information."),ye),new Error(h.statusMessage)}l.url=h.calendarHomeSetURL,t((0,c.Z)("Connected to CalDAV, found $1 calendar.","Connected to CalDAV, found $1 calendars.",[h.calendars.length]),fe,l)}else if(me(o)){l.url=He.getCalendarUrl(o,l.username);try{const e=await i.Z.getAuthentication(l);e.username!==l.username&&(l.username=e.username,l.url=He.getCalendarUrl(o,l.username))}catch(e){throw t((0,c.Z)("Login aborted. Please try again."),ye),e}h=await(0,le.P)(l,r)}if(!h?.foundService)return t(h.statusMessage,ye),d;const p=await i.Z.getAuthentication(l,r),u=await Fe(l,p);return u.error?(t((0,c.Z)("Error getting calendars.")+u.message,ye),d):(d.calendars=u.calendars,d)},async saveCalendarAccount(e,t){let{account:n,password:i}=e;try{n.url=new URL(n.url).href;const{url:e,username:t,account_type:s}=n;(["caldav","vivaldi"].includes(s)||"ical"===s&&t)&&(0,de.vW)({url:e,username:t},i)}catch(e){throw t(e.message,ye),e}try{const{id:e,...i}=n;n=await s.Z.createAccount(i),t((0,c.Z)("Account saved"),fe)}catch(e){return t((0,c.Z)("Error saving account:")+String(e?.message||e),ye),!1}try{await Ve(e.calendars,n)}catch(e){return t((0,c.Z)("Error saving calendars:")+String(e?.message||e),ye),!1}return!0},getStatusMessageAndLog(e,t){const{status:n}=t,{name:s}=e;let i="";return Ae[s]||(Ae[s]={authenticationErrorCount:0}),401===n||403===n?(i=(0,c.Z)("Authentication for the account “$1” failed. Check your username and password in your calendar account settings, or contact your account provider.",[s]),y.Z.error("Calendar",["caldav","polling"],i)):429===n?(i=(0,c.Z)("The account server is temporarily refusing more requests for account “$1”.",[s]),y.Z.info("Calendar",["caldav","polling"],i,t)):n>=400&&n<500?(i=(0,c.Z)("Unexpected client-side problem (HTTP $2) for account “$1”.",[s,n]),y.Z.warn("Calendar",["caldav","polling"],i,t)):503===n?(i=(0,c.Z)("The account server is temporarily unavailable (HTTP 503) for account “$1”.",[s]),y.Z.info("Calendar",["caldav","polling"],i,t)):n>=500?(i=(0,c.Z)("Unexpected server-side problem (HTTP $2) for account “$1”.",[s,n]),y.Z.warn("Calendar",["caldav","polling"],i,t)):-1===n?(i=(0,c.Z)("Network problem for account “$1”.",[s]),navigator.onLine&&y.Z.warn("Calendar",["caldav","polling"],i,t)):(i=(0,c.Z)("Unexpected problem when retring server data for account “$1”.",[s]),navigator.onLine&&y.Z.warn("Calendar",["caldav","polling"],i,n,t)),i}},ze=He},84384:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var s=n(45660);const i=":";function o(e){return(e=e.replace(/[^0-9a-z]+([a-z]|$)/gi,((e,t)=>t.toUpperCase())))||(e=i),e}function a(e,t,n,s){let r="",l="";for(let d=0;d<e.childNodes.length;d++){const c=e.childNodes[d];if(c instanceof Element){let l=o(c.localName);const d=e.nodeType===Node.DOCUMENT_NODE||n.simplify.some((e=>c.parentNode instanceof Element&&(e.parentns===(c.parentNode.namespaceURI||"")&&e.parent===c.parentNode.localName&&e.elementns===(c.namespaceURI||"")&&e.element===c.localName))),h=c.namespaceURI||i,p=c.namespaceURI||"";l=n.prefixes&&n.prefixes.hasOwnProperty(h)?n.prefixes[h]+"_"+l:p+":"+l,r=l;const u={attributes:{}};for(let e=0;e<c.attributes.length;e++){const t=c.attributes[e];let s=o(t.localName);const a=t.namespaceURI||i,r=t.namespaceURI||"";s=n.prefixes&&n.prefixes.hasOwnProperty(a)?n.prefixes[a]+"_"+s:r+":"+s,u.attributes[s]=t.nodeValue}a(c,u,n,s),d?t[l]?(s.simplifyerror=!0,t.simplifyerror||(t.simplifyerror={}),t.simplifyerror[l]instanceof Array||(t.simplifyerror[l]=[]),t.simplifyerror[l].push(u)):t[l]=u:(t[l]instanceof Array||(t[l]=[]),t[l].push(u))}else c.nodeType!==Node.TEXT_NODE&&c.nodeType!==Node.CDATA_SECTION_NODE||(l+=c.nodeValue)}return e.nodeType===Node.ELEMENT_NODE&&(t.content=l.replace(/^\s+$/,"")),r}function r(e,t){const n=(new DOMParser).parseFromString(e,"text/xml");if(!n||n.getElementsByTagNameNS("http://www.w3.org/1999/xhtml","parsererror").length)return{parsererror:!0,root:"",simplifyerror:!1};const s={prefixes:(t||{}).prefixes||{[i]:""},simplify:(t||{}).simplify||[]},o={parsererror:!1,root:"",simplifyerror:!1};return o.root=a(n,o,s,o),o.root||(o.parsererror=!0),o}const l="DAV:",d="urn:ietf:params:xml:ns:caldav",c="http://calendarserver.org/ns/",h={prefixes:{":":"",[l]:"d",[d]:"c",[c]:"cs"},simplify:[{parentns:d,parent:"calendar-home-set",elementns:l,element:"href"},{parentns:d,parent:"calendar-multiget",elementns:l,element:"prop"},{parentns:d,parent:"calendar-query",elementns:d,element:"filter"},{parentns:d,parent:"calendar-query",elementns:l,element:"prop"},{parentns:d,parent:"comp-filter",elementns:d,element:"comp-filter"},{parentns:l,parent:"current-user-principal",elementns:l,element:"href"},{parentns:d,parent:"filter",elementns:d,element:"comp-filter"},{parentns:l,parent:"multistatus",elementns:l,element:"sync-token"},{parentns:l,parent:"prop",elementns:d,element:"calendar-data"},{parentns:l,parent:"prop",elementns:d,element:"calendar-home-set"},{parentns:l,parent:"prop",elementns:l,element:"current-user-principal"},{parentns:l,parent:"prop",elementns:l,element:"displayname"},{parentns:l,parent:"prop",elementns:c,element:"getctag"},{parentns:l,parent:"prop",elementns:l,element:"getetag"},{parentns:l,parent:"prop",elementns:l,element:"resourcetype"},{parentns:l,parent:"prop",elementns:d,element:"supported-calendar-component-set"},{parentns:l,parent:"prop",elementns:l,element:"sync-token"},{parentns:l,parent:"propfind",elementns:l,element:"prop"},{parentns:l,parent:"propstat",elementns:l,element:"prop"},{parentns:l,parent:"propstat",elementns:l,element:"status"},{parentns:l,parent:"response",elementns:l,element:"href"},{parentns:l,parent:"response",elementns:l,element:"status"},{parentns:d,parent:"sync-collection",elementns:l,element:"prop"},{parentns:l,parent:"sync-collection",elementns:c,element:"sync-level"},{parentns:l,parent:"sync-collection",elementns:c,element:"sync-token"}]};function p(e){const t=r(e,h);return Array.isArray(t?.d_multistatus?.d_response)&&(t.d_multistatus.d_response=t.d_multistatus.d_response.map((e=>{if(!Array.isArray(e.d_propstat))return e;const t=e.d_propstat.filter((e=>{var t;return-1!==(t=e.d_status,Array.isArray(t)?t[0]:t).content.indexOf("200")})),n=t.reduce(((e,t)=>e.d_prop?(e.d_prop=Object.assign(e.d_prop,t.d_prop),e):Object.assign(e,t)),{});return e.d_propstat=n,e}))),t.d_error&&(s.Z.error("Calendar",["caldav"],"caldavtojson error",t),t.parsererror=!0),t}},64877:(e,t,n)=>{"use strict";function s(e){return{...e,headers:{Depth:"1"},method:"PROPFIND",body:'<?xml version="1.0" encoding="UTF-8"?>\n    <D:propfind xmlns:D="DAV:"\n      xmlns:CS="http://calendarserver.org/ns/">\n      <D:prop>\n        <D:getetag />\n        <D:displayname />\n        <CS:getctag />\n        <D:resourcetype />\n        <supported-calendar-component-set xmlns="urn:ietf:params:xml:ns:caldav" />\n        <supported-address-data xmlns="urn:ietf:params:xml:ns:carddav" />\n        <xmpp-uri xmlns="http://calendarserver.org/ns/" />\n        <calendar-color xmlns="http://apple.com/ns/ical/" />\n        <D:supported-report-set />\n        <D:sync-token />\n      </D:prop>\n    </D:propfind>'}}function i(){return'<?xml version="1.0" encoding="utf-8"?>\n    <D:propfind xmlns:D="DAV:">\n      <D:prop>\n        <D:current-user-principal />\n        <D:resourcetype xmlns:D="DAV:" />\n      </D:prop>\n    </D:propfind>'}function o(){return'<?xml version="1.0" encoding="utf-8"?>\n    <D:propfind xmlns:D="DAV:">\n      <D:prop>\n        <D:displayname />\n        <schedule-inbox-URL xmlns="urn:ietf:params:xml:ns:caldav" />\n        <schedule-outbox-URL xmlns="urn:ietf:params:xml:ns:caldav" />\n        <calendar-user-address-set xmlns="urn:ietf:params:xml:ns:caldav" />\n        <default-calendar-URL xmlns="http://icewarp.com/ns/" />\n        <default-tasks-URL xmlns="http://icewarp.com/ns/" />\n        <default-contacts-URL xmlns="http://icewarp.com/ns/" />\n        <default-notes-URL xmlns="http://icewarp.com/ns/" />\n        <calendar-home-set xmlns="urn:ietf:params:xml:ns:caldav" />\n        <addressbook-home-set xmlns="urn:ietf:params:xml:ns:carddav" />\n        <D:resourcetype xmlns:D="DAV:" />\n        <supported-calendar-component-set xmlns="urn:ietf:params:xml:ns:caldav" />\n      </D:prop>\n    </D:propfind>'}n.d(t,{P_:()=>i,ZP:()=>s,sp:()=>o})},23796:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var s=n(84384),i=n(45660),o=n(29526);function a(e){const t=(0,s.Z)(e),n=[];return t.d_error?(i.Z.error("Calendar",["caldav"],"Parser error",t.d_error),[]):t.parsererror||!t.d_multistatus?[]:(t.d_multistatus.d_response.forEach((e=>{const{d_href:t,d_propstat:s}=e,{content:i}=t,{d_prop:a}=s,{d_displayname:r,cs_getctag:l,d_syncToken:d,d_supportedReportSet:c,c_calendarColor:h,d_resourcetype:p}=a,u=r?r.content:"";let g="";g=h||a["http://apple.com/ns/ical/:calendarColor"];const m=g?g[0].content:"#",v={vevent:!1,vjournal:!1,vtodo:!1};if(a.c_supportedCalendarComponentSet){const{c_comp:e}=a.c_supportedCalendarComponentSet;v.vevent=e.some((e=>"VEVENT"===e.attributes._name)),v.vtodo=e.some((e=>"VTODO"===e.attributes._name))}let f=!1;c&&c[0].d_supportedReport&&c[0].d_supportedReport.forEach((e=>{e.d_report.forEach((e=>{e.d_syncCollection&&(f=!0)}))}));const{c_calendar:y}=p,C=l?l.content:"",w=d?d.content:"",{vevent:b,vtodo:S}=v;if(!y||b||S||(v.vevent=!0),(v.vevent||v.vtodo)&&y){const e=(0,o.Z)(w),t={syncToken:e,supportsSyncCollection:!!e&&f,ctag:(0,o.Z)(C),description:u,name:(0,o.Z)(i),color:"#"===m?"":m,supportedCalendarComponent:v};n.push(t)}})),n)}},88545:(e,t,n)=>{"use strict";n.d(t,{P:()=>I,k:()=>C});var s=n(34929),i=n(87265),o=n(48735),a=n(15800),r=n(56371),l=n(84384),d=n(64877),c=n(45660);var h=n(23796);var p=n(8687),u=n(7064),g=n(90305),m=n(24522),v=n(25372);const{concatUrl:f}=i.Z,{isOAuthProvider:y}=a.Z;async function C(e,t){const n={contextPath:"",currentUserPrincipalURL:"",calendarHomeSetURL:"",foundService:!1,calendars:[],statusMessage:""},{url:s,username:i}=e;if(s)n.contextPath=s;else{const e=i.indexOf("@");if(!(e>0))return n.statusMessage=(0,r.Z)("Please provide valid server address."),n;{const t=i.substring(e+1,i.length);n.contextPath=`https://${t}`}}const o=await S(e,t,"");if(o.userPrincipal){const{urlValid:s}=u.Z.utilities.isUrlValid(o.userPrincipal);n.currentUserPrincipalURL=s?o.userPrincipal:f(n.contextPath,o.userPrincipal);const i=await b(e,t,n.currentUserPrincipalURL);u.Z.utilities.isUrlValid(i).urlValid?n.calendarHomeSetURL=i:n.calendarHomeSetURL=f(n.contextPath,i);const a=await w(e,t,n.calendarHomeSetURL);return n.calendars=a,n.foundService=!0,n.contextPath=e.url,n}const a=await async function(e,t,n){let s="";const i=(0,v.Z)(e);i&&({host:s}=i);const o=(0,m.II)(s);try{const s=await fetch(o,{method:"GET",headers:{Authorization:(0,p.Y8)(t,n)}}),{status:i,ok:a}=s;if(a){if(404===i)return{redirectedUrl:"",message:(0,r.Z)("Service not found.")};if(401===i||403===i)return{redirectedUrl:"",message:(0,r.Z)("Authentication error. Check your credentials and try again.")}}const l=(0,v.Z)(s.url),d=(0,v.Z)(e);return!(l?.href===d?.href)&&l?{redirectedUrl:l.href,message:""}:{redirectedUrl:"",message:""}}catch(e){return{redirectedUrl:"",message:(0,r.Z)("Network error.")}}}(n.contextPath,i,t);a.redirectedUrl&&(n.contextPath=a.redirectedUrl);const l=await S(e,t,n.contextPath);if(!l.authenticated)return n.statusMessage=l.message,n;const{userPrincipal:d}=l;if(d){n.currentUserPrincipalURL=d;const{urlValid:s}=u.Z.utilities.isUrlValid(d);s||(n.currentUserPrincipalURL=f(n.contextPath,d));const i=await b(e,t,n.currentUserPrincipalURL);u.Z.utilities.isUrlValid(i).urlValid?n.calendarHomeSetURL=i:n.calendarHomeSetURL=f(n.contextPath,i);const o=await w(e,t,n.calendarHomeSetURL);n.foundService=!0,n.calendars=o}return n}async function w(e,t,n){const s={...e,accessToken:"",password:t},i=await(0,p.ZP)((0,d.ZP)(s),n||e.url);return(0,h.Z)(i.response)}async function b(e,t,n){const s={username:e.username,password:t,url:n||e.url,accessToken:"",method:"PROPFIND",headers:{Brief:"t",Depth:"0"},body:(0,d.sp)()},{ok:i,response:o,status:a}=await(0,p.ZP)(s);if(i){const e=await o,t=function(e){const t=(0,l.Z)(e),n={calendarHomeSet:"",errorMsg:""};if(t.d_error)return n.errorMsg="Error parsing calendar HomeSet",n;if(!t.parserror){if(!t.d_multistatus)return n.errorMsg="Error parsing calendar HomeSet",n;t.d_multistatus.d_response.forEach((e=>{const{d_propstat:t,d_href:s}=e,{d_prop:i}=t,{c_calendarHomeSet:o}=i;if(!o)return n.calendarHomeSet=s.content,n;const a=o.d_href.content;n.calendarHomeSet=a}))}return n}(e);if(t.calendarHomeSet)return t.calendarHomeSet;c.Z.warn("Calendar","Error fetching homeset",a,e)}return""}async function S(e,t,n){const{username:s}=e,i={authenticated:!1,userPrincipal:"",message:"",isCalendarUrl:!1};try{const o=await fetch(function(e){return e+(e.endsWith("/")?"":"/")}(n||e.url),{method:"PROPFIND",credentials:"omit",headers:{Brief:"t",Depth:"0","Content-Type":"text/xml;charset=UTF-8",Authorization:(0,p.Y8)(s,t)},body:(0,d.P_)()}),{status:a,ok:c}=o;if(c)a>=200&&a<=299&&(i.authenticated=!0);else{if(401===a)return i.message=(0,r.Z)("Authentication failed. Check your username and password."),i;if(403===a)return i.message=(0,r.Z)("Not authorized. Check your username and password or contact your server administrator for further assistance."),i;if(404===a)return i.message=(0,r.Z)("No CalDAV service found. Check your account info."),i;if(405===a)return i}const h=await o.text(),u=(0,l.Z)(h);if(u.d_error||!u.d_multistatus)return i.message=(0,r.Z)("Error parsing response data from server."),i;const g=function(e){let t="";const n=(0,l.Z)(e);return!n.parsererror&&"d_multistatus"===n.root&&n.d_multistatus.d_response&&n.d_multistatus.d_response.forEach((e=>{if(e?.d_propstat?.d_prop?.d_currentUserPrincipal){const{d_href:n}=e.d_propstat.d_prop.d_currentUserPrincipal;t=n.content}else e?.d_href?.content&&(t=e.d_href.content)})),t}(h);g&&(i.userPrincipal=g)}catch(t){i.message=(0,r.Z)("CalDAV service not found at ‘$1’. Please check if the URL is correctly typed. Error message ‘$2’.",[n||e.url,t.message])}return i}async function I(e,t){const{account_type:n,username:i,url:a}=e,{urlValid:l}=u.Z.utilities.isUrlValid(a),c={calendars:[],eventCount:0,foundService:!1,statusMessage:""};if(!l)return{statusMessage:(0,r.Z)("Invalid URL"),...c};let m;try{m=y(n)?await s.Z.getAuthentication(e):{accessToken:"",id:"",name:"",url:a,username:i,password:t}}catch(e){return Promise.resolve(c)}try{const t=await(0,p.ZP)((0,d.ZP)(m),a);if(!t.ok){const n=o.Z.getStatusMessageAndLog(e,t);return{...c,statusMessage:n}}const n=(0,h.Z)(t.response);return{...c,foundService:!0,calendars:n}}catch(e){return e.status&&(0,g.oy)(m.username,s.Z.getOAuthServiceProvider(n)),{...c,statusMessage:e.statusText}}}},9141:(e,t,n)=>{"use strict";n.d(t,{$E:()=>m,Wy:()=>h,YQ:()=>p});var s=n(2934),i=n(50522),o=n(98035),a=n(45660),r=n(28773),l=n(7064),d=n(34006);async function c(e,t,n){function a(e,t){for(const s of n.values())if(s.parent_event_id===e&&(s.date??0)===t)return s}t.recurrenceExceptions&&s.Z.trimExceptions(e,t);let r=0;e.start&&t.start?r=e.start-t.start:e.end&&t.end&&(r=e.end-t.end);for(const n of e.recurrenceExceptions??[]){const{date:d,cancelled:c}=n;if(!d)break;const h=a(t.id,d-r);if(c)h?(!r&&h.cancelled||l.Z.calendar.updateRecurrenceException(h.exception_id??"",{date:(h.date??0)+r,cancelled:c}),h.exception_event_id&&s.Z.deleteEvent(h.exception_event_id)):s.Z.createException(t.id,"0",c||!1,d);else{const n=h?.exception_event_id&&i.Z.getEvent(h.exception_event_id),a=e.exceptionEvents?.find((e=>e.recurrenceId=d));if(n&&a){const{recurrenceId:t,recurrenceExceptions:s,invites:i,notifications:r,...l}=a;l.calendarId=e.calendarId,await o.Z.updateEventFromServer(n.id,l)}if(h)await l.Z.calendar.updateRecurrenceException(h.exception_id??"",{date:(h.date??0)+r});else{if(!a||c)return void s.Z.createException(t.id,"0",!0,d);const{start:n,end:i,title:r,description:l}=a,{rrule:h,exceptionEvents:p,attachment:u,invites:g,notifications:m,...v}=e;if(!n||!i)return;v.start=n,v.end=i,v.title=r,v.description=l;const f=await s.Z.createEvent({...v,is_template:!1},!1);s.Z.createException(t.id,f.id,!1,d),o.Z.updateEvent({id:t.id,sequence:e.sequence,etag:e.etag})}}}}async function h(e,t){return u(e,t,(function(e,t){return e.uid===t.uid&&e.etag!==t.etag}))}async function p(e,t){return u(e,t,(function(e,t){return e.uid===t.uid&&function(e,t){if(!g(e,t))return!0;const n=t.recurrenceExceptions||[],s=new Map(e.recurrenceExceptions?.map((e=>[e.date,e])));if(n.length!==s.size)return!0;return n.some((e=>{const n=s.get(e.date);if(!n||n.cancelled!==e.cancelled)return!0;if(e.cancelled||!n.exception_event_id)return!1;const o=i.Z.getEvent(n.exception_event_id),{recurrenceId:a,...r}=t.exceptionEvents?.find((t=>t.recurrenceId===e.date))||{};if(!o||!r)throw new Error("Unexpected missing exception event!");return!g(o,r)}))}(e,t)}))}async function u(e,t,n){if(!t.length)return 0;const i=new Map(e.flatMap((e=>(e.recurrenceExceptions??[]).filter((e=>"string"==typeof e.exception_event_id)).map((e=>[String(e.exception_event_id),e]))))),o=[];for(const a of e){if(i.has(a.id))continue;const e=t.find((e=>n(a,e)));e&&!e.recurrenceExceptions?.length&&a.recurrenceExceptions?.length?s.Z.deleteExceptions(a):e?.recurrenceExceptions?.length&&c(e,a,i),e&&o.push((0,d.KU)(e,a))}try{const e=o.map((e=>{const t=e.rrule?"all":"single";return s.Z.updateEvent(e,t)}));await Promise.all(e)}catch(e){a.Z.error("Calendar",["caldav"],"Error updating event",e)}return o.length}function g(e,t){return!!t&&((t.etag??"")===(e.etag??"")&&(t.sequence??0)===(e.sequence??0)&&t.title===e.title&&(t.description??"")===(e.description??"")&&(t.start??0)===e.start&&(t.end??t.start??0)===e.end&&!!t.complete==!!e.complete&&!!t.allDay==!!e.allDay&&(t.rrule??"")===(e.rrule??"")&&(t.organizer??"")===(e.organizer??"")&&(t.location??"")===(e.location??"")&&(t.url??"")===(e.url??""))}async function m(e){const{exceptionEvents:t,...n}=e,i=[];for(const e of t||[]){const{recurrenceId:t,recurrenceExceptions:n,...s}=e,a=await o.Z.createEvent(s),{id:r}=a;i.push({date:t,cancelled:!1,exception_event_id:r})}const a={...n,...(0,r.Z)(i.length>0?{recurrenceExceptions:i}:null)};await s.Z.createEvent(a,!1)}},68172:(e,t,n)=>{"use strict";n.d(t,{$u:()=>h,VK:()=>u,Z1:()=>g,e$:()=>m,tE:()=>c,tL:()=>p});var s=n(15800),i=n(80008),o=n.n(i),a=n(15805),r=n(41851),l=n(24522),d=n(58821);async function c(e,t){const n=await r.Z.loadTemplate(e);return n?h(n,t):(console.error("Template not found.",n),t)}function h(e,t){const n={...t};if(void 0!==e.start&&(n.start=e.start+o()(n.start).startOf("day").valueOf()),void 0!==e.end&&(n.end=e.end+o()(n.end).startOf("day").valueOf(),n.end<n.start&&(n.end+=l.hd)),void 0!==e.duration){const{duration:t}=e;n.start?n.end=n.start+t:n.end?n.start=n.end-t:(n.start=(0,d.zX)(Date.now()),n.end=n.start+t)}return void 0!==e.calendarId&&(n.calendarId=e.calendarId),void 0!==e.title&&(n.title=e.title),void 0!==e.description&&(n.description=e.description),void 0!==e.location&&(n.location=e.location),void 0!==e.url&&(n.url=e.url),void 0!==e.rrule&&(n.rrule=e.rrule),void 0!==e.timezone&&(n.timezone=e.timezone),void 0!==e.allDay&&(n.allDay=e.allDay),void 0!==e.organizer&&(n.organizer=e.organizer),Array.isArray(e.invites)&&(n.invites=e.invites.map((e=>({...e,event_id:n.id})))),Array.isArray(e.notifications)&&(n.notifications=e.notifications.map((e=>({...e,event_id:n.id})))),n}function p(e,t){const n={name:""};if(t.time||t.duration){const{start:s,end:i}=(0,d.aE)(e);t.time&&(n.start=s.hours()*l.QI+s.minutes()*l.lb,n.end=i.hours()*l.QI+i.minutes()*l.lb),t.duration&&(n.duration=i.diff(s))}return t.calendar&&(n.calendarId=e.calendarId),t.title&&(n.title=e.title),t.description&&(n.description=e.description),t.allDay&&(n.allDay=e.allDay),t.timezone&&(n.timezone=e.timezone),t.task&&(n.task=e.task),t.location&&(n.location=e.location),t.url&&(n.url=e.url),t.recurrence&&(n.rrule=e.rrule),t.reminders&&(n.notifications=e.notifications||[]),t.participants&&(n.organizer=e.organizer,n.invites=e.invites||[]),n}function u(e){const t=[];return void 0!==e.start&&t.push(`DTSTART:${o().tz(e.start,"utc").format(l.A)}`),void 0!==e.end&&t.push(`DTEND:${o().tz(e.end,"utc").format(l.A)}`),void 0!==e.duration&&t.push(`DURATION:${o().duration(e.duration).toISOString()}`),void 0!==e.calendarId&&t.push(`X-VIV-CALID:${e.calendarId}`),void 0!==e.title&&t.push(`SUMMARY:${e.title}`),void 0!==e.description&&t.push(`DESCRIPTION:${e.description}`),void 0!==e.location&&t.push(`LOCATION:${e.location}`),void 0!==e.url&&t.push(`URL:${e.url}`),void 0!==e.rrule&&t.push(`RRULE:${e.rrule}`),void 0!==e.timezone&&t.push(`X-VIV-TZ:${e.timezone}`),void 0!==e.allDay&&t.push("X-VIV-ALLDAY:"+(e.allDay?"TRUE":"FALSE")),void 0!==e.organizer&&t.push(`ORGANIZER:mailto:${e.organizer}`),e.invites&&(0===e.invites.length&&t.push("X-VIV-NO-ATTENDEE:TRUE"),e.invites.forEach((e=>{const n=e.name?`;CN=${e.name}`:"";t.push(`ATTENDEE${n}:mailto:${e.address}`)}))),e.notifications&&(0===e.notifications.length&&t.push("X-VIV-NO-REMINDER:TRUE"),e.notifications.forEach((e=>{t.push(s.Z.notificationToVAlarm(e))}))),`BEGIN:VCALENDAR\nBEGIN:${e.task?"VTODO":"VEVENT"}\n${t.join("\n")}\nEND:${e.task?"VTODO":"VEVENT"}\nEND:VCALENDAR\n`}function g(e,t){const n={name:e};let s={};t&&(s=(0,a.Z)(t));const i=[...s.VEVENT||[],...s.VTODO||[]];if(!t||1!==i.length)throw new Error("Invalid template data");s.VTODO&&s.VTODO.length&&(n.task=!0);const r=i[0];if(void 0!==r.DTSTART&&(n.start=o().tz(r.DTSTART.value,"utc").valueOf()),void 0!==r.DTEND&&(n.end=o().tz(r.DTEND.value,"utc").valueOf()),void 0!==r.DURATION&&(n.duration=o().duration(r.DURATION).asMilliseconds()),void 0!==r.SUMMARY&&(n.title=r.SUMMARY),void 0!==r.DESCRIPTION&&(n.description=r.DESCRIPTION),void 0!==r.LOCATION&&(n.location=r.LOCATION),void 0!==r.URL&&(n.url=r.URL.value),void 0!==r.RRULE&&(n.rrule=r.RRULE),void 0!==r["X-VIV-CALID"]&&(n.calendarId=r["X-VIV-CALID"]),void 0!==r["X-VIV-ALLDAY"]&&(n.allDay="TRUE"===r["X-VIV-ALLDAY"]),void 0!==r["X-VIV-TZ"]&&(n.timezone=r["X-VIV-TZ"]),void 0!==r.ORGANIZER&&(n.organizer=r.ORGANIZER.value),void 0!==r["X-VIV-NO-ATTENDEE"]&&(n.invites=[]),Array.isArray(r.ATTENDEE)){const e=[];r.ATTENDEE.map((t=>{e.push({event_id:"",id:"",address:t.value,name:t?.params.CN})})),n.invites=e}if(void 0!==r["X-VIV-NO-REMINDER"]&&(n.notifications=[]),Array.isArray(r.VALARM)){const e=[];r.VALARM.map((t=>{t.TRIGGER&&e.push({name:"",id:"",when:-o().duration(t.TRIGGER).asMilliseconds()})})),n.notifications=e}return n}function m(e){return{title:void 0!==e.title,description:void 0!==e.description,time:void 0!==e.start,duration:void 0!==e.duration,allDay:void 0!==e.allDay,timezone:void 0!==e.timezone,task:void 0!==e.task,location:void 0!==e.location,recurrence:void 0!==e.rrule,url:void 0!==e.url,reminders:void 0!==e.notifications,participants:void 0!==e.invites,calendar:void 0!==e.calendarId}}},79706:(e,t,n)=>{"use strict";n.d(t,{Z:()=>b});var s=n(2934),i=n(34929),o=n(50522),a=n(15800),r=n(56371),l=n(11430),d=n(7064),c=n(24522),h=n(8687),p=n(34006);function u(e,t){return e.filter((e=>e.UID&&!t.has(e.UID)))}function g(e,t){const n=new Set;t.forEach((e=>{e.recurrenceExceptions&&e.recurrenceExceptions.forEach((e=>{n.add(e.exception_event_id)}))}));const s=new Set(e.map((e=>e.UID)));return t.filter((e=>{const t=s.has(e.uid),i=n.has(e.id);return!(t||i&&!e.uid)}))}function m(e,t){return e.filter((e=>e.UID&&t.has(e.UID)))}var v=n(89555),f=n(9141);let y=null;async function C(e,t,n){return await fetch(e,{Authorization:t&&n?(0,h.Y8)(t,n):void 0,Accept:"text/calendar"})}const w={probeWebCalendar:async(e,t)=>{const{url:n,username:s}=e;let i=0;const o={calendars:[],eventCount:0,foundService:!1,statusMessage:""},{urlValid:c}=d.Z.utilities.isUrlValid(n);if(!c)return{...o,statusMessage:(0,r.Z)("Invalid URL $1",[n])};try{const d=await C(n,s,t),{status:c,statusText:h}=d;if(c>=200&&c<300){const t=await d.text();if(!t)return{...o,statusMessage:(0,r.Z)("Empty response from server. No calendar data.")};let s;try{s=await l.Z.parseICalendar(t)}catch(e){return{...o,statusMessage:(0,r.Z)("No Web Calendar found at ‘$1’. Error message ‘$2’.",[n,e.message])}}y={url:n,timestamp:Date.now(),calendarData:s};const c={name:e.name,description:(s["X-WR-CALNAME"]||"").trim(),color:a.Z.getCalendarCreateColor(),ctag:"",supportedCalendarComponent:{vevent:!0,vtodo:!1,vjournal:!1},supportsSyncCollection:!1,syncToken:"",active:!0};return i=s.VEVENT.length,{...o,foundService:!0,calendars:[c],eventCount:i,statusMessage:(0,r.Z)("Success")}}if(401===c||403===c)return{...o,statusMessage:(0,r.Z)("Not authorized, check your username and password. ‘$1’",[h])};if(404===c)return{...o,statusMessage:(0,r.Z)("Calendar not found, check your URL. ‘$1’",[h])};if(c>=500)return{...o,statusMessage:(0,r.Z)("Server error, try again later. ‘$1’.",[h])};throw new Error(h)}catch(e){return{...o,statusMessage:(0,r.Z)("Network error, check your URL. ‘$1’.",[e.message])}}},fetchAndCreate:async(e,t)=>{const{url:n}=e;if(!n)throw"Url missing";const a={numberOfCalendarsPolled:1,numberOfChangedCalendars:0};let r;if(y&&y.url===n&&y.timestamp+5*c.lb>Date.now())r=y.calendarData;else{let t="",s="";try{const n=await i.Z.getAuthentication(e);t=n.username,s=n.password}catch(e){}const o=await C(n,t,s);if(200!==o.status)throw`Fetch remote calendar. Status code: ${o.status}`;const a=await o.text();r=await l.Z.parseICalendar(a)}y=null,t||(t=(r["X-WR-CALNAME"]||e.name).trim());try{s.Z.stopAPIChangeListeners();const n=await w.getCalendar(e,t),{id:i}=n,l=r.VEVENT,d=o.Z.getEventsPerCalendar(i),{create:c,deleteEvents:h,update:f}=function(e,t){const n=new Set(t.map((e=>e.uid)).filter(Boolean));return{create:u(e,n),deleteEvents:g(e,t),update:m(e,n)}}(l,d);(c.length||h.length)&&(a.numberOfChangedCalendars=1);for(const e of h)s.Z.deleteEvent(e.id);const y=e=>(0,p.rP)(e,n.id);await(0,p.nj)(c.map(y),v.Z);await w.updateEvents(f,n.id)&&(a.numberOfChangedCalendars=1)}finally{s.Z.startAPIChangeListeners()}return a},getCalendar:(e,t)=>new Promise(((n,i)=>{const r=o.Z.getCalendars().filter((t=>t.accountId===e.id)),l=r.find((t=>t.accountId===e.id));if(l)n(l);else{const i={name:t,description:t,accountId:e.id,active:!0,color:a.Z.getCalendarCreateColor(),supportedCalendarComponent:{vevent:!0,vtodo:!0,vjournal:!1}};s.Z.createCalendar(i,e,!1,!0).then((e=>{e.calendar&&n(e.calendar)}))}})),updateEvents:async(e,t)=>{const n=e.map((e=>(0,p.rP)(e,t))),s=o.Z.getEventsPerCalendar(t);return(0,f.YQ)(s,n)}},b=w},74400:(e,t,n)=>{"use strict";n.d(t,{ES:()=>i,RO:()=>s,Vl:()=>o});const s=e=>e.replace(/\\\\|\\;|\\,|\\[Nn]/g,(e=>{switch(e){case"\\\\":return"\\";case"\\;":return";";case"\\,":return",";case"\\n":case"\\N":return"\n";default:return e}})),i=e=>e.replace(/\\|;|,|\r\n|\n/g,(e=>{switch(e){case"\\":return"\\\\";case";":return"\\;";case",":return"\\,";case"\r\n":case"RN":case"\n":case"N":return"\\n";default:return e}}));function o(e,t,n){let s=!1;if(n&&n<2)return[e];n=n||1/0;const i=[0];for(let o=0;o<e.length;o++){const a=e[o];if('"'===a)0!==o&&"\\"===e[o-1]||(s=!s);else if(a===t&&!s&&(i.push(o+1),i.length>=n))break}return 1===i.length?[e]:i.map(((t,n)=>{const s=i[n+1];return e.slice(t,s?s-1:s)}))}},15805:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var s=n(24522),i=n(74400);function o(e){try{if(e.startsWith('"')&&e.endsWith('"'))return e.slice(1,-1)}catch(t){console.error("Calendar: Parsing error in stripQuotes",e,t)}return e}const a=e=>{const t={};for(;e.length>1;){const n=e.shift(),[l,d]=(0,i.Vl)(n,":",2);if(void 0===d)throw new Error(`Error parsing iCal line: "${n}". Value not found.`);const[c,h]=l.split(/;(.*)/,2),p=h?(0,i.Vl)(h,";").reduce(((e,t)=>{const[n,s]=t.split("=");return e[n]=o(s),e}),{}):{};switch(c){case"BEGIN":const i=d;let o=a(e);switch(t[i]&&(o=[].concat(t[i],o)),i){case"VEVENT":case"VTODO":case"VJOURNAL":case"VALARM":case"VTIMEZONE":case"STANDARD":case"DAYLIGHT":t[i]=Array.isArray(o)?o:[o];break;default:t[i]=o}break;case"END":return["VEVENT","VTODO","VJOURNAL","VFREEBUSY"].includes(d)&&!t.UID&&(t.UID=crypto.randomUUID()),t;case"RECURRENCE-ID":case"DTSTART":case"DTEND":case"DTSTAMP":case"DUE":if("DTSTART"===c&&t.DTSTART&&e[0]?.startsWith("RRUL"))continue;/^\d{8}$/.test(d)&&(p.VALUE="DATE"),/\d+T\d+Z/.test(d)?p.TZID="UTC":p.TZID||(p.TZID=s.$T),t[c]={value:d,params:p};break;case"ATTENDEE":t[c]=(t[c]||[]).concat([{value:r(d),params:p}]);break;case"EXDATE":d.indexOf(",")>=0?t[c]=d.split(",").map((e=>({value:e,params:p}))):t[c]=(t[c]||[]).concat([{value:d,params:p}]);break;case"ORGANIZER":t[c]={value:r(d),params:p};break;case"URL":t[c]={value:d,params:p};break;case"ATTACH":t[c]=t[c]?[t[c],n].join("\r\n"):n;break;case"UID":case"CLASS":case"CREATED":case"DESCRIPTION":case"GEO":case"LAST-MODIFIED":case"LOCATION":case"PRIORITY":case"RRULE":case"SEQUENCE":case"STATUS":case"SUMMARY":case"TRANSP":case"X-WR-CALNAME":case"X-WR-CALDESC":t[c]=d;break;default:t[c]?t[c]=[].concat(t[c]||[],d):t[c]=d}}return t},r=e=>e.toLowerCase().startsWith("mailto:")?e.substr(7):e,l=e=>{const t=(e=>{const t=e.replace(/\n\\n/g,"\\n").split(/\r\n|\n|\r/).filter((e=>""!==e.trim())),n=[];let s="";for(;t.length>0;){const e=t.shift();" "===e[0]||"\t"===e[0]?s+=e.substr(1):(s&&n.push(s),s=e.trim())}return s&&n.push(s),n})(e),n=a(t);if(!n.VCALENDAR)return{VEVENT:[],VTODO:[],VJOURNAL:[]};if(n.VCALENDAR.VEVENT){const e=n.VCALENDAR.VEVENT.reduce(((e,t)=>{const n=e.findIndex((e=>e.UID===t.UID));return-1===n?e.push({UID:t.UID,VEVENT:[t]}):e[n].VEVENT.push(t),e}),[]).reduce(((e,t)=>{const n=t.VEVENT.reduce(((e,t)=>(t["RECURRENCE-ID"]?e.EXCEPTIONS?e.EXCEPTIONS.push(t):e.EXCEPTIONS=[t]:e={...e,...t},e)),{});return e.push(n),e}),[]);n.VCALENDAR.VEVENT=e}else n.VCALENDAR.VEVENT=[];return{...n.VCALENDAR}}},34006:(e,t,n)=>{"use strict";n.d(t,{rP:()=>z,nj:()=>$,BC:()=>Y,KU:()=>G,ig:()=>X,PU:()=>Q,Uq:()=>H});var s=n(2934),i=n(34929),o=n(1712),a=n(48735),r=n(15800),l=n(22616),d=n(33499),c=n(56371),h=n(45660);var p=n(28773),u=n(42568),g=n.n(u),m=n(80008),v=n.n(m),f=n(8687),y=n(15805),C=n(87265),w=n(25372);const{constructUrl:b}=C.Z;function S(e,t,n){const s=e.url,i=crypto.randomUUID();let o="",a="";const{username:r,password:l,accessToken:d}=e,c=(0,w.Z)(s);if(c){const{protocol:e,host:n}=c;if(!e||!n||!i)return{};const s=e+"//"+n;a="/"+b([t,i])+".ics",o=b([s,a])}return{username:r,password:l,accessToken:d,headers:{"If-None-Match":"*"},url:o,href:a,method:"PUT",contentType:"text/calendar; charset=utf-8",body:n}}var I=n(7064),k=n(24522),A=n(9141),T=n(74400),Z=n(39190),E=n(58821);const _=(0,n(23542).extendMoment)(v());function M(e){const t=["BEGIN:VCALENDAR","PRODID:-Vivaldi Calendar V1.0//EN","VERSION:2.0","CALSCALE:GREGORIAN","DTSTAMP:"+_.tz().format(k.FI)],n=e=>e.reduce(((e,{EXCEPTIONS:t,...s})=>(e.push(s),t&&e.push(...n(t)),e)),[]),s=n(e.VEVENT).map((e=>function(e){const t=e=>e?e.map((e=>{const t=["BEGIN:VALARM"];for(const n in e)t.push(`${n}:${e[n]}`);return t.push("END:VALARM"),t})).flat():[""];let n=["BEGIN:VEVENT"];for(const s in e)switch(s){case"VALARM":const i=t(e[s]);n=[...n,...i];break;case"ATTENDEE":n.push(D(s,e[s]));break;case"ORGANIZER":n.push(P(s,e[s]));break;case"DTSTART":case"RECURRENCE-ID":case"DTSTAMP":case"DTEND":n.push(N(s,e[s]));break;default:n.push(`${s}:${e[s]}`)}return n.push("END:VEVENT\r\n"),n.join("\r\n")}(e)));t.push("");let i=t.join("\r\n");return s.forEach((e=>{i+=e})),r.Z.foldIcal(i+"END:VCALENDAR\r\n")}function N(e,t){if(!t)return"";const{params:n}=t;return"DATE"===n.VALUE?`${e};VALUE=DATE:${t.value}`:`${e}:${t.value}`}function P(e,t){if(!t)return"";const n=[],{value:s,params:i}=t;for(const e in i)n.push(`${e}=${i[e]}`);return`${e};${n.join("=")}:mailto:${s}`}function D(e,t){const n=[],s=[];return t?(t.forEach((t=>{const{value:i,params:o}=t;for(const e in o)n.push(`${e}=${o[e]}`);const a=`${n.join(";")}`,r=`mailto:${i}`;s.push(`${e};${a}:${r}`)})),s.join("\r\n")):""}var x=n(89555);const{ensureHttpsForWebcal:O}=r.Z,{setImportProgress:L}=l.Z,{createLocalAccountAndCalendar:R}=o.Z,B=new Map([["SUMMARY","title"],["LOCATION","location"],["DESCRIPTION","description"]]);function F(e,t){return t&&t!==k.$T?v().tz(e,t):v()(e)}function V(e){if(s.z.has(e)||e===k.$T)return e;const t=(0,E.EP)(),n=(0,Z.findIana)(e);return t&&n&&n.includes(t)?t:n&&n.length?n[0]:""}function W(e){return"DATE"===e.params.VALUE?k.GL:k.jS}function U(e,t){if(e)return!t&&e?.value?.match(/\d+T\d+Z/)?(0,E.EP)():V(e.params.TZID)}function H(e,t){const n=V(t??e?.params.TZID),s=W(e),{value:i}=e;if(n===k.$T){const e=v().tz(i,s,"UTC").toDate();return(0,E.FL)(e).valueOf()}return n?v().tz(i,s,n).valueOf():v()(i,s).valueOf()}const z=(e,t,n={})=>{const s=[];let i=[];const o={title:""};B.forEach(((t,n)=>{"string"==typeof e[n]&&(o[t]=(0,T.RO)(e[n]))}));const a=(e.EXCEPTIONS??[]).map((e=>{const i=z(e,t,n),o=e["RECURRENCE-ID"];if(o?.value){const e=H(o);s.push({date:e,cancelled:!1});const{exceptionEvents:t,...n}=i;return{...n,recurrenceId:e}}})).filter(Boolean);e.ATTENDEE&&(i=e.ATTENDEE.map((e=>({name:e.params.CN||"",address:e.value,partstat:e.params.PARTSTAT||"NEEDS-ACTION"}))));const r=Boolean(e.RRULE);let l,d=!1,c=0;const h=U(e.DTSTART,r);e.DTSTART?.value&&("DATE"===e.DTSTART.params.VALUE&&(d=!0),c=H(e.DTSTART,h));const u=U(e.DTEND,r);if(e.DTEND?.value&&(l=H(e.DTEND,u)),e.DURATION){l=c+v().duration(e.DURATION).asMilliseconds()}let g=[];e.VALARM&&(g=e.VALARM.map((t=>{const{TRIGGER:n=""}=t;return{when:-v().duration(n).asMilliseconds(),name:e.SUMMARY||""}})));let m=e.LOCATION;"string"!=typeof m&&(m="");let f={};const y=U(e.DUE,r);e.DUE&&("DATE"===e.DUE.params.VALUE&&(d=!0),f={end:H(e.DUE,y)}),e.EXDATE&&e.EXDATE.forEach((e=>{const t=W(e),n=V(e.params.TZID),i=n?v().tz(e.value,t,n):v()(e.value,t);s.push({cancelled:!0,date:i.valueOf()})}));const C=e.URL?.value;if(c&&l){const e=F(c,h),t=F(l,u),n=e.startOf("day").valueOf()===c,s=t.startOf("day").valueOf()===l,i=1===t.diff(e,"d");n&&s&&i&&(d=!0)}let w=!1;return e.STATUS&&(w="COMPLETED"===e.STATUS),e.RRULE&&"DATE"===e.DTSTART?.params.VALUE&&(e.RRULE=e.RRULE.replace(/\d{8}T\d{6}Z/g,(e=>v()(e).add(12,"hour").format(k.O5)))),e.RRULE&&"DATE"!==e.DTSTART?.params.VALUE&&(e.RRULE=e.RRULE.replace(/\d{8}T\d{6}Z/g,(e=>v().tz(e,h||y).format(k.A)))),{...o,rrule:e.RRULE,url:C,start:c,end:l,...(0,p.Z)(f),timezone:h||y,allDay:d,is_recurring:!!e.RRULE,calendarId:t,href:n.href,etag:n.etag,uid:e.UID?e.UID:"",organizer:e.ORGANIZER&&e.ORGANIZER.value,notifications:g,sequence:parseInt(e.SEQUENCE)||0,...(0,p.Z)(a.length>0?{exceptionEvents:a}:null),...(0,p.Z)(s.length>0?{recurrenceExceptions:s}:null),...(0,p.Z)(i.length>0?{invites:i}:null),attachment:e.ATTACH,is_template:!1,complete:w}};function G(e,t){const{is_template:n,exceptionEvents:s,...i}=e,o=function(e,t){if(e.invites)return e.invites.map((e=>{const n=t.invites&&t.invites.find((t=>t.address===e.address));return{...e,id:n?.id||"",event_id:n?.event_id||""}}))}(e,t),a=function(e,t){if(!e.notifications)return t.notifications;const n=t.notifications;if(!n)return e.notifications.map((e=>({...e,id:"",event_id:t.id})));const s=e.notifications.filter((e=>!n.some((t=>t.when===e.when)))).map((e=>({...e,id:"",event_id:t.id})));return[...n,...s]}(e,t);return{...i,attachment:r.Z.stringToAttachments(e.attachment),...(0,p.Z)(o?{invites:o}:null),...(0,p.Z)(a?{notifications:a}:null),id:t.id,start:e.start||0,end:e.end||0}}const $=async(e,t)=>{if(0===e.length)return;const n=[[]];let i=0;for(const t of e)100===n[i].length&&(n.push([]),i++),t.exceptionEvents?.length?await(0,A.$E)(t):n[i].push(t);s.Z.stopAPIChangeListeners();let o=0;try{for(const i of n){o+=(await s.Z.createEvents(i)).created_count,t(o,e.length),s.Z.loadPromise()}}catch(e){throw h.Z.error("Calendar",["import"],e),e}finally{s.Z.startAPIChangeListeners(),d.ZP.updateAllAlarms()}};async function K(e,t,n){const s=n?(e,t)=>L("Calendar",n,e,t):x.Z;try{const n=t=>z(t,e);$(t.map(n),s)}catch(e){l.Z.addImportError("Calendar",n,e),h.Z.error("Calendar",["import"],e)}}const j=g()((async function(e){let t;try{if("string"==typeof e)t=e.startsWith("http")||e.startsWith("webcal")?await async function(e){try{const t=await fetch(e,{method:"GET"});if(200!==t.status)throw`Fetch remote calendar. Status code: ${t.status}`;return t.text()}catch(e){throw h.Z.warn("Calendar",["network"],"Error fetching calendar",e),e}}(O(e)):await I.Z.mailPrivate.readFileToText(e);else{const n=await e.getFile();t=await n.text()}return(0,y.Z)(t)}catch(e){throw h.Z.warn("Calendar",["import","load"],e),e}}),{isPromise:!0,maxSize:10,onCacheChange:e=>{const t=e.keys[0];setTimeout((()=>{const n=e.getKeyIndex(t);-1!==n&&(e.keys.splice(n,1),e.values.splice(n,1))}),5*k.lb)}}),Y=async(e,t)=>{const{file:n}=e,i=await j(n);if(i.VEVENT[0]){const e=z(i.VEVENT[0],r.Z.getDefaultCalendar()?.id||"");s.Z.addEventCommand(t,e)}else h.Z.warn("Calendar",["import"],"No event found in file")},X=async e=>{try{const{file:t}=e,n=await j(t);return n.VEVENT.length?{eventCount:n.VEVENT.length,message:"",error:!1,calendarName:n["X-WR-CALNAME"]||n["X-WR-CALDESC"]||""}:{eventCount:0,message:(0,c.Z)("No events found"),error:!0,calendarName:""}}catch(e){return h.Z.warn("Calendar",["import","parse"],e),{eventCount:0,message:e.message,error:!0,calendarName:""}}},Q=async e=>{const{file:t}=e,n=await j(t);try{!async function(e,t){const{calendarId:n,createNew:s,newCalendarName:o}=t,p=e.VEVENT;if(L("Calendar",o,0,p.length),s){const{calendar:e}=await R(null,{name:"",description:o,accountId:"",supportedCalendarComponent:{vevent:!0,vtodo:!0,vjournal:!1}});if(!e)return l.Z.addImportError("Calendar",o,(0,c.Z)("Error creating calendar.")),void h.Z.error("Calendar",["import"],"Error creating calendar.");await K(e.id,p,o)}else{const{account:t,calendar:s}=r.Z.getAccountAndCalendar(n);if(!t||!s)return void h.Z.error("Calendar",["import"],"Import error. Calendar not found.");const{account_type:u}=t;if("caldav"===u||"vivaldi"===u||"google"===u){const n=e.VEVENT,{VEVENT:r,...h}=e,p=[];for(const e of n){const t=M({...h,VEVENT:[e]});p.push(t)}let u=0;for(const e of p){const n=await i.Z.getAuthentication(t);(await(0,f.ZP)(S(n,s.name,e))).ok?L("Calendar",o,++u,p.length):l.Z.addImportError("Calendar",o,(0,c.Z)("Error uploading event to server."))}d.ZP.updateAllAlarms(),setTimeout((()=>{a.Z.pollCalDAV([t.id])}),1e3)}else await K(n,p,o)}}(n,e)}catch(e){throw h.Z.warn("Calendar",["import","parse"],e),e}}},87852:(e,t,n)=>{"use strict";n.d(t,{G6:()=>s,Nw:()=>o,Q9:()=>a,W$:()=>i});const s=-999,i=-997,o=-996,a=-995},47543:(e,t,n)=>{"use strict";n.d(t,{EE:()=>v,IK:()=>I,Ns:()=>u,QX:()=>A,Qj:()=>p,YE:()=>f,Zm:()=>g,_7:()=>h,_v:()=>C,jw:()=>T,qh:()=>y,v1:()=>b,xL:()=>w,yu:()=>m,z3:()=>c});var s=n(45660),i=n(42568),o=n.n(i),a=n(30381),r=n.n(a),l=n(82191),d=n(58821);const c=[l.Ci.MO,l.Ci.TU,l.Ci.WE,l.Ci.TH,l.Ci.FR,l.Ci.SA,l.Ci.SU];function h(e){const t=c[(e+6)%7];if(!t)throw new Error("Invalid weekday number");return t}function p(e,t,n){if(e)try{const s=t?(0,d.VV)(new Date(t),n):void 0;return(0,l.SA)(e,{dtstart:s})}catch(t){s.Z.warn("Calendar",["parser"],"Error parsing rrule string",e,t)}}function u(e){return e.dtstart&&(e.dtstart=(0,d.VV)(e.dtstart)),e.until&&(e.until=(0,d.VV)(e.until)),l.Ci.optionsToString(e)}function g(e){let{dtstart:t,until:n}=e;return t=t&&(0,d.VV)(t),n=n&&(0,d.VV)(n),new l.Ci({...e,dtstart:t,until:n})}function m(e,t){let{dtstart:n,until:s}=t;return n=n?(0,d.VV)(n):e.origOptions.dtstart,t.hasOwnProperty("until")?s&&(s=(0,d.VV)(s)):s=e.origOptions.until&&(0,d.FL)(e.origOptions.until),new l.Ci({...e.origOptions,...t,dtstart:n,until:s})}function v(e,t){function n(e){return e.weeks()-e.clone().startOf("month").weeks()}function s(e,t,n){const s="number"==typeof n?n:n.weekday,i=c[((s+e)%7+7)%7];if(!i)throw new Error("Weekday not found. Should not happen.");return i&&n.hasOwnProperty("n")&&"number"==typeof n.n?i.nth(n.n+t):i}if(!e?.dtstart)return{freq:1};const i=(0,d.FL)(e.dtstart),o=r()(i),a=r()(i).add(t,"millisecond"),l=a.diff(o,"day");if(!l)return e;const h=n(a)-n(o),{byweekday:p,bymonthday:u}=e;return p?Array.isArray(p)?e.byweekday=p.map((e=>s(l,h,e))):e.byweekday=s(l,h,p):u&&(Array.isArray(u)?e.bymonthday=u.map((e=>o.clone().date(e).add(l,"day").date())):"number"==typeof u&&(e.bymonthday=o.clone().date(u).add(l,"day").date())),e}const f=o()((function(e,t){const{from:n,to:s,eventStart:i,timezone:o}=t,a=p(e,i,o);return a?a.between((0,d.VV)(new Date(n),o),(0,d.VV)(new Date(s),o),!0).map((e=>(0,d.FL)(e,o))):[]}),{maxSize:250});function y(e,t,n,s,i){return e.between((0,d.VV)(t,i),(0,d.VV)(n,i),!0,((e,t)=>t<s)).map((e=>(0,d.FL)(e,i)))}function C(e,t,n,s){const i=e.before((0,d.VV)(t,n),s);return i instanceof Date?(0,d.FL)(i):null}function w(e,t,n,s){const i=e.after((0,d.VV)(t,n),s);return i instanceof Date?(0,d.FL)(i):null}function b(e){const{bymonthday:t}=e.origOptions;return t?Array.isArray(t)?t:[t]:[]}function S(e){return"number"==typeof e?e:e.weekday}function I(e){const{byweekday:t}=e.origOptions;return t?Array.isArray(t)?t.map(S):[S(t)]:[]}function k(e){return"number"==typeof e?new l.OG(e):e}function A(e){const{byweekday:t}=e.origOptions;return t?Array.isArray(t)?t.map(k):[k(t)]:[]}function T(e,t){if(!e)return 0;if(["UNTIL","COUNT"].some((t=>e.indexOf(t)>0))){const n=p(e);if(n?.options.until)return(0,d.FL)(n.options.until,t).valueOf();if(n?.options.count)return(0,d.FL)(n.all().pop(),t).valueOf()}return 0}},98035:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var s=n(2934),i=n(15800),o=n(45660),a=n(28773),r=n(7064),l=n(24522),d=n(58821);function c(e){if(e.timezone!==l.$T&&!e.allDay)return e;const t={...e},{start:n=0,end:s=0}=e;return n&&(t.start=(0,d.VV)(new Date(n)).valueOf()),s&&(t.end=(0,d.VV)(new Date(s)).valueOf()),t}function h(e,t){o.Z.error("Calendar",[e,"event"],t)}async function p(e,t){let n;try{n=await r.Z.calendar.updateEvent(e,c({...t}))}catch(e){throw h("update",e),e}return s.Z.transformVivaldiEvents([n])[0]}const u={createEvent:async function(e){let t;try{t=await r.Z.calendar.eventCreate(c(e))}catch(e){throw h("create",e),e}return s.Z.transformVivaldiEvents([t])[0]},createEvents:async function(e){let t;try{t=await r.Z.calendar.eventsCreate(e.map(c))}catch(e){throw h("create",e),e}return t},updateEvent:async function(e){const{filteredOut:t,id:n,invites:s,notifications:o,recurrenceId:r,recurrenceExceptions:l,trash_time:d,attachment:c,...h}=e;return p(n,{...h,...(0,a.Z)(c?{attachment:i.Z.attachmentsToString(c)}:null)})},updateEventFromServer:async function(e,t){const{invites:n,notifications:s,recurrenceExceptions:i,is_template:o,exceptionEvents:a,...r}=t;return p(e,r)},updateExceptions:async function(e){let t;for(const n of e){const{exception_id:e,...s}=n;e&&(t=await r.Z.calendar.updateRecurrenceException(e,s))}return t&&s.Z.transformVivaldiEvents([t])[0]}}},41851:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var s=n(7064),i=n(68172);const o={saveTemplate:async function(e,t){const n=(0,i.VK)(t);if(e)return await s.Z.calendar.updateEventTemplate(e,{name:t.name,ical:n}),{id:e,name:t.name};return{id:(await s.Z.calendar.createEventTemplate(t.name,n)).id,name:t.name}},deleteTemplate:async function(e){return s.Z.calendar.deleteEventTemplate(e)},loadTemplate:async function(e){const t=(await s.Z.calendar.getAllEventTemplates()).find((t=>t.id===e));if(t)return(0,i.Z1)(t.name,t.ical)},loadTemplatesList:async function(){return(await s.Z.calendar.getAllEventTemplates()).map((({id:e,name:t})=>({name:t,id:e})))}}},69417:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var s,i=n(67294),o=n(94184),a=n.n(o),r=n(86088),l=n(48521);function d(e,t,n,i){s||(s="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=i;else if(a>1){for(var r=new Array(a),l=0;l<a;l++)r[l]=arguments[l+3];t.children=r}if(t&&o)for(var d in o)void 0===t[d]&&(t[d]=o[d]);else t||(t=o||{});return{$$typeof:s,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class c extends i.PureComponent{inputRef=i.createRef();componentDidMount(){if(this.props.focusInput&&this.inputRef.current){const e=this.inputRef.current;e.focus(),e.setSelectionRange(0,e.value.length)}}componentDidUpdate(e){if(!e.focusInput&&this.props.focusInput&&this.inputRef.current){const e=this.inputRef.current;e.focus(),e.setSelectionRange(0,e.value.length)}}render(){const{placeholder:e="",label:t,labelImportant:n,className:s="",isVerified:i,hasError:o,focusInput:c,...h}=this.props,p=a()(s,{"floating-label":!0,verified:i&&!this.props.disabled});let u;return t&&(u=d(n?"strong":"span",{},void 0,t)),d("label",{className:p},void 0,u,"textarea"!==h.type?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("input",{...h,ref:this.inputRef,className:"floating-input",type:this.props.type,placeholder:e}),o&&!this.props.disabled&&d("span",{className:"error",dangerouslySetInnerHTML:{__html:r.viW}})]}):(0,l.jsx)("textarea",{...h,ref:this.inputRef,className:"floating-input",placeholder:e}))}}const h=c},63377:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var s,i=n(67294),o=n(29087),a=n(94283),r=n(89175),l=n(48521);function d(e,t,n,i){s||(s="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=i;else if(a>1){for(var r=new Array(a),l=0;l<a;l++)r[l]=arguments[l+3];t.children=r}if(t&&o)for(var d in o)void 0===t[d]&&(t[d]=o[d]);else t||(t=o||{});return{$$typeof:s,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const c=[r.kWebpagesFocusTrap];class h extends i.PureComponent{static contextType=a.Z;focusRef=i.createRef();constructor(e,t){super(e),this._lastFocused=t.document.activeElement}componentDidMount(){this._getFocusable();(0===o.Z.get(r.kKeyboardTabToAll)&&!this.props.preventTrap||this.props.forceTrap)&&this.focus(),o.Z.addListener(c,this.onPrefsCacheChanged)}componentWillUnmount(){const{document:e}=this.context;this.focusRef?.current?.contains(e.activeElement)&&setTimeout((()=>{"BODY"===e.activeElement?.tagName&&this._lastFocused?.isConnected&&this._lastFocused.focus()}),1),delete this._focusable,o.Z.removeListener(c,this.onPrefsCacheChanged)}onPrefsCacheChanged=()=>this.forceUpdate();_getFocusable=()=>{const{HTMLElement:e}=this.context,t=this.focusRef.current;let n;t instanceof e&&(n=t.querySelectorAll(`a[href]:not([tabindex='-1']),\n        button:not([disabled],[disabled=true],[tabindex='-1']),\n        input:not([disabled],[disabled=true],[tabindex='-1'],[hidden]),\n        select:not([disabled],[disabled=true],[tabindex='-1']),\n        textarea:not([disabled],[disabled=true],[tabindex='-1']),\n        p[contenteditable]:not([tabindex='-1']),\n        [tabindex]:not([tabindex='-1'],.${this.props.focusName})`)),this._focusable=n};focus=()=>{this.focusRef?.current?.contains(this.context.document.activeElement)||(this.props.forceTrap?this.focusRef?.current?.focus():this._focusable?.length&&this._focusable[0].focus())};isFocusOrigin=e=>Boolean(e.relatedTarget instanceof this.context.HTMLElement&&this.focusRef?.current?.contains(e.relatedTarget)&&this.focusRef?.current!==e.relatedTarget);handleTopFocus=e=>{if(this._getFocusable(),this._focusable&&this._focusable.length>0){const t=this._focusable[0],n=this._focusable[this._focusable.length-1];if(!t||!n)return;this.isFocusOrigin(e)?n.focus():t.focus()}};handleBottomFocus=e=>{if(this._focusable&&this._focusable.length>0){const t=this._focusable[0],n=this._focusable[this._focusable.length-1];if(!t||!n)return;this.isFocusOrigin(e)?t.focus():n.focus()}};render(){const{children:e,focusName:t,forceTrap:n,preventTrap:s,...i}=this.props,a=n?0:null,c=!0===o.Z.get(r.kWebpagesFocusTrap);return n||c&&!s?(0,l.jsxs)("div",{...i,ref:this.focusRef,tabIndex:a,children:[d("span",{tabIndex:"0",className:t,onFocus:this.handleTopFocus}),e,d("span",{tabIndex:"0",className:t,onFocus:this.handleBottomFocus})]}):(0,l.jsx)("div",{...i,ref:this.focusRef,tabIndex:a,children:e})}}const p=h},52250:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var s=n(67294),i=n(94283),o=n(46884),a=n(48521);function r(e){return(0,s.forwardRef)((function(t,n){if("function"==typeof n)throw Error("Callback refs not supported");const{Element:r}=s.useContext(i.Z),[l,d]=(0,s.useState)(!1),c=(0,s.useCallback)((()=>d(!1)),[]),h=(0,s.useCallback)((()=>d(!0)),[]),p=(0,s.useRef)(null),u=n||p,g=(0,s.useCallback)((()=>{const e=u.current?.getNode();return e instanceof r?e:null}),[u,r]),m=(0,s.useCallback)((()=>u.current?u.current.handleClickOutside:null),[u]),{disableOnClickOutside:v,outsideClickIgnoreClass:f}=t;return(0,o.Z)(g,m,f,v?.()||l),(0,a.jsx)(e,{...t,ref:u,enableOnClickOutside:c,disableOnClickOutside:h})}))}},5298:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});const s=Object.freeze({KEY_CANCEL:3,KEY_HELP:6,KEY_BACK_SPACE:8,KEY_TAB:9,KEY_CLEAR:12,KEY_RETURN:13,KEY_ENTER:14,KEY_SHIFT:16,KEY_CONTROL:17,KEY_ALT:18,KEY_PAUSE:19,KEY_CAPS_LOCK:20,KEY_ESCAPE:27,KEY_SPACE:32,KEY_PAGE_UP:33,KEY_PAGE_DOWN:34,KEY_END:35,KEY_HOME:36,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_PRINTSCREEN:44,KEY_INSERT:45,KEY_DELETE:46,KEY_0:48,KEY_1:49,KEY_2:50,KEY_3:51,KEY_4:52,KEY_5:53,KEY_6:54,KEY_7:55,KEY_8:56,KEY_9:57,KEY_SEMICOLON:59,KEY_EQUALS:61,KEY_A:65,KEY_B:66,KEY_C:67,KEY_D:68,KEY_E:69,KEY_F:70,KEY_G:71,KEY_H:72,KEY_I:73,KEY_J:74,KEY_K:75,KEY_L:76,KEY_M:77,KEY_N:78,KEY_O:79,KEY_P:80,KEY_Q:81,KEY_R:82,KEY_S:83,KEY_T:84,KEY_U:85,KEY_V:86,KEY_W:87,KEY_X:88,KEY_Y:89,KEY_Z:90,KEY_META:91,KEY_CONTEXT_MENU:93,KEY_NUMPAD0:96,KEY_NUMPAD1:97,KEY_NUMPAD2:98,KEY_NUMPAD3:99,KEY_NUMPAD4:100,KEY_NUMPAD5:101,KEY_NUMPAD6:102,KEY_NUMPAD7:103,KEY_NUMPAD8:104,KEY_NUMPAD9:105,KEY_MULTIPLY:106,KEY_ADD:107,KEY_SEPARATOR:108,KEY_SUBTRACT:109,KEY_DECIMAL:110,KEY_DIVIDE:111,KEY_F1:112,KEY_F2:113,KEY_F3:114,KEY_F4:115,KEY_F5:116,KEY_F6:117,KEY_F7:118,KEY_F8:119,KEY_F9:120,KEY_F10:121,KEY_F11:122,KEY_F12:123,KEY_F13:124,KEY_F14:125,KEY_F15:126,KEY_F16:127,KEY_F17:128,KEY_F18:129,KEY_F19:130,KEY_F20:131,KEY_F21:132,KEY_F22:133,KEY_F23:134,KEY_F24:135,KEY_NUM_LOCK:144,KEY_SCROLL_LOCK:145,KEY_COMMA:188,KEY_PERIOD:190,KEY_SLASH:191,KEY_BACK_QUOTE:192,KEY_OPEN_BRACKET:219,KEY_BACK_SLASH:220,KEY_CLOSE_BRACKET:221,KEY_QUOTE:222})},76632:(e,t,n)=>{"use strict";n.d(t,{Z:()=>g});var s,i=n(67294),o=n(64473),a=n(56551),r=n(56371),l=n(94184),d=n.n(l),c=n(67074);function h(e,t,n,i){s||(s="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=i;else if(a>1){for(var r=new Array(a),l=0;l<a;l++)r[l]=arguments[l+3];t.children=r}if(t&&o)for(var d in o)void 0===t[d]&&(t[d]=o[d]);else t||(t=o||{});return{$$typeof:s,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const p={width:450,minWidth:"unset"};class u extends i.Component{constructor(e){super(e),this.state={selectedIndex:this.props.initialSelectedIndex||(this.props.items.length>0?0:-1),isCreating:!1,isDeleting:!1,showDeleteConfirmation:!1}}componentDidUpdate(e){this.props.items.length!==e.items.length&&this.cancelRemoval()}onSelectItem=e=>{this.setState({selectedIndex:e})};onDeleteInProgress=e=>{this.setState({isDeleting:e})};onCreateItem=e=>{this.setState({isCreating:!0}),"function"==typeof this.props.onCreateItem&&this.props.onCreateItem(e)};onCancelCreate=e=>{this.setState({isCreating:!1}),"function"==typeof this.props.onCancelCreateItem&&this.props.onCancelCreateItem()};considerRemovingItem=()=>{this.setState({showDeleteConfirmation:!0})};cancelRemoval=()=>{this.setState({showDeleteConfirmation:!1})};renderContentElement=(e,t,n,s)=>{if(!e||t)return s(n);const i=e&&n&&function(e,t){let n=!1;const s={...t};for(const i of Object.keys(t)){const o=t[i];o.toLowerCase().includes(e)&&(s[i]=(0,c.CH)(o,e),n=!0)}return n?s:null}(e,n);return e&&!i?null:s(i||n)};render(){const{items:e,masterLayout:t}=this.props,n=this.state.selectedIndex,s=null!=n&&e[n];let i;const l=(this.props.title||this.props.subtitle||"").toLowerCase().includes(this.props.filter)?"":this.props.filter,u=!l||e.some((e=>"string"==typeof e.name&&e.name.toLowerCase().includes(l)));if((this.state.isCreating||this.props.isCreating)&&this.props.renderCreate?i=this.renderContentElement(l,u,this.props.createStrings?this.props.createStrings:this.props.contentStrings,this.props.renderCreate.bind(this)):s?i=this.renderContentElement(l,u,this.props.contentStrings,this.props.renderContent.bind(this,n)):this.props.renderEmpty&&(i=this.renderContentElement(l,u,this.props.emptyStrings?this.props.emptyStrings:this.props.contentStrings,this.props.renderEmpty.bind(this))),!i&&!u)return null;const{className:g=""}=this.props;return h("div",{"data-anchor":this.props.dataAnchor,className:g+" master-detail-wrapper"},void 0,this.props.title&&h("h2",{},void 0,(0,c.CH)(this.props.title,this.props.filter)),this.props.subtitle&&h("h3",{},void 0,(0,c.CH)(this.props.subtitle,this.props.filter)),h("div",{className:g+" master-detail"},void 0,this.state.showDeleteConfirmation&&s&&this.props.deleteDialog&&h(o.Z,{onRequestClose:this.cancelRemoval,viewMode:"float",ignoreClickOutside:this.state.isDeleting,ignoreEscape:this.state.isDeleting,style:p},void 0,this.props.deleteDialog({item:s,onClose:this.cancelRemoval,onDeleteInProgress:this.onDeleteInProgress})),this.state.showDeleteConfirmation&&s&&this.props.deleteTitle&&h(o.Z,{onRequestClose:this.cancelRemoval,viewMode:"float"},void 0,h("header",{className:"dialog-header"},void 0,h("h1",{className:"dialog-title"},void 0,this.props.deleteTitle)),h("div",{className:"dialog-content"},void 0,h("p",{className:"error"},void 0,(0,r.Z)("Are you sure you would like to delete “$1”?",[s.label||s.name]))),h("footer",{className:"dialog-footer"},void 0,h("input",{type:"button",className:"danger",value:(0,r.Z)("verb","Delete"),onClick:"function"==typeof this.props.onRemove?this.props.onRemove.bind(this,n):null}),h("input",{type:"button",value:(0,r.Z)("Cancel"),autoFocus:!0,onClick:this.cancelRemoval}))),h("div",{className:d()({master:!0,"master-layout-double":0===t,"master-layout-single":1===t})},void 0,h(a.Z,{items:e,emptyListGraphic:this.props.emptyListGraphic,emptyListString:this.props.emptyListString,renderListItem:this.props.renderListItem,onSelectItem:this.onSelectItem,onCreateItem:this.onCreateItem,isCreating:this.props.isCreating,moveItem:this.props.moveItem,onRemove:this.props.onRemove,filter:this.props.filter,selectedIndex:this.state.selectedIndex,onContextMenu:this.props.onContextMenu,onActivate:this.props.onActivate,onCancelCreate:this.onCancelCreate,addTipString:this.props.addTipString,considerRemovingItem:this.considerRemovingItem,deleteTipString:this.props.deleteTipString,supportDragAndDrop:this.props.supportDragAndDrop,disableAutoFocus:this.props.disableAutoFocus,mimeType:this.props.mimeType?this.props.mimeType.toString():void 0,renderCreateListItem:this.props.renderCreateListItem})),i))}}const g=u},56551:(e,t,n)=>{"use strict";n.d(t,{Z:()=>y});var s,i=n(67294),o=n(84451),a=n(94283),r=n(56371),l=n(94184),d=n.n(l),c=n(1407),h=n(67074),p=n(13302),u=n(86088),g=n(48521),m=n(34155);function v(e,t,n,i){s||(s="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=i;else if(a>1){for(var r=new Array(a),l=0;l<a;l++)r[l]=arguments[l+3];t.children=r}if(t&&o)for(var d in o)void 0===t[d]&&(t[d]=o[d]);else t||(t=o||{});return{$$typeof:s,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class f extends i.Component{static contextType=a.Z;dropSupport=!1;moveUpCombo=(0,p.$)("alt+up");moveDownCombo=(0,p.$)("alt+down");refItems=i.createRef();constructor(e){super(e),this.state={selectedIndex:this.props.selectedIndex||(this.props.items.length>0?0:-1),isCreating:!1,dragIndex:-1,dropIndex:-1,dropPosition:""}}componentWillUnmount(){this.clearDndTimer()}componentDidUpdate(e){if(e.items.length!==this.props.items.length){let t=-1;if(this.props.items.length>0)if(0===e.items.length)t=0;else if(this.props.items.length>e.items.length){const n=this.props.items.filter((({key:t})=>!e.items.some((({key:e})=>e===t))));t=this.props.items.indexOf(n[0])}else-1!==this.state.selectedIndex&&(t=Math.min(this.state.selectedIndex,this.props.items.length-1),this.props.disableAutoFocus||t!==this.props.items.length-1||this.focusItem(t));this.setSelected(t,!1)}e.isCreating!==this.props.isCreating&&this.props.isCreating&&this.setIsCreating()}setSelected=(e,t)=>{void 0!==t&&(this.setState({isCreating:this.props.onCancelCreate&&t}),t&&this.props.onCreateItem?this.props.onCreateItem():!t&&this.props.onCancelCreate&&this.props.onCancelCreate()),this.setState({selectedIndex:e}),"function"==typeof this.props.onSelectItem&&this.props.onSelectItem(e)};loadItemAt=e=>{this.setSelected(e),m.nextTick((()=>{const e=this.refItems.current;if(e){const t=e.querySelector(".item-selected");t&&!this.props.disableAutoFocus&&t.focus()}}))};setIsCreating=()=>{this.setSelected(this.props.items.length,!0),m.nextTick((()=>{const e=this.refItems.current;e&&(e.scrollTop=e.scrollHeight)}))};removeItem=e=>{e>=this.props.items.length?("function"==typeof this.props.onCancelCreate&&this.props.onCancelCreate(),this.setSelected(this.props.items.length-1,!1)):"function"==typeof this.props.considerRemovingItem?this.props.considerRemovingItem():"function"==typeof this.props.onRemove&&this.props.onRemove(this.state.selectedIndex)};moveDown=()=>{this.props.moveItem&&this.props.items&&this.props.items.length>1&&this.state.selectedIndex+1<this.props.items.length&&(this.props.moveItem(this.state.selectedIndex,this.state.selectedIndex+1),this.loadItemAt(this.state.selectedIndex+1))};moveUp=()=>{this.props.moveItem&&this.props.items&&this.props.items.length>1&&this.state.selectedIndex>0&&(this.props.moveItem(this.state.selectedIndex,this.state.selectedIndex-1),this.loadItemAt(this.state.selectedIndex-1))};focusItem=(e,t)=>{if(this.state.isCreating||this.props.isCreating)return;this.state.selectedIndex!==e&&this.loadItemAt(e);const n=this.refItems.current;n&&!this.props.disableAutoFocus&&n.focus(),t&&t.stopPropagation()};onDoubleClick=(e,t)=>{this.props.onActivate&&this.props.onActivate(e,t),t.stopPropagation()};clearDndTimer=()=>{this.dndTimerId&&(clearTimeout(this.dndTimerId),delete this.dndTimerId)};onDragStartButton=(e,t)=>{this.props.supportDragAndDrop&&this.props.mimeType&&(t.dataTransfer.effectAllowed="move",t.dataTransfer.setData(this.props.mimeType,e),this.setState({dragIndex:e}))};onDragEnter=e=>{this.props.supportDragAndDrop&&this.props.mimeType&&(e.preventDefault(),e.stopPropagation(),this.dropSupport=e.dataTransfer.types.some((e=>e===this.props.mimeType)),e.dataTransfer.dropEffect=this.dropSupport?"move":"none")};onDragLeave=e=>{this.props.supportDragAndDrop&&(e.preventDefault(),e.stopPropagation(),this.clearDndTimer(),this.dndTimerId=setTimeout((()=>{delete this.dndTimerId,this.setState({dropIndex:-1,dropPosition:""})}),c._p))};getDropPosition=e=>{let t=0;const n=e.currentTarget.getBoundingClientRect(),s=n.height;return t=(e.clientY-n.top)/s,t<=.5?"above":"below"};onDragOverButton=(e,t)=>{if(t.preventDefault(),t.stopPropagation(),this.dropSupport){t.dataTransfer.dropEffect="move",this.clearDndTimer();const n=this.getDropPosition(t);this.state.dropIndex===e&&this.state.dropPosition===n||this.setState({dropIndex:e,dropPosition:n})}};onDragOver=e=>{if(e.preventDefault(),e.stopPropagation(),this.dropSupport){e.dataTransfer.dropEffect="move",this.clearDndTimer();const t=this.props.items.length>0?this.props.items.length-1:0,n="below";this.state.dropIndex===t&&this.state.dropPosition===n||this.setState({dropIndex:t,dropPosition:n})}};onDropButton=(e,t)=>{if(t.preventDefault(),t.stopPropagation(),this.dropSupport&&this.props.mimeType){const n=Number(t.dataTransfer.getData(this.props.mimeType));if(void 0!==n){let s=e+("below"===this.getDropPosition(t)?1:0);n<s&&(s-=1),this.props.moveItem&&(this.props.moveItem(n,s),this.loadItemAt(s))}}this.onDragEnd()};onDrop=e=>{if(e.preventDefault(),e.stopPropagation(),this.dropSupport&&this.props.mimeType){const t=Number(e.dataTransfer.getData(this.props.mimeType));if(void 0!==t){let e=this.props.items.length;t<e&&(e-=1),this.props.moveItem&&(this.props.moveItem(t,e),this.loadItemAt(e))}}this.onDragEnd()};onDragEnd=()=>{this.setState({dragIndex:-1,dropIndex:-1,dropPosition:""})};onKeyDown=e=>{const t=o.Z.keyComboFromEvent(e.nativeEvent);if("tab"!==t&&this.props.items&&this.props.items.length>0){let n=!0;const s=this.props.items.length;switch(t){case"up":this.loadItemAt(this.state.selectedIndex<=0?s-1:this.state.selectedIndex-1);break;case"down":this.loadItemAt(this.state.selectedIndex+1>=s?0:this.state.selectedIndex+1);break;case"del":case"backspace":this.removeItem(this.state.selectedIndex);break;case"home":this.loadItemAt(0);break;case"end":this.loadItemAt(s-1);break;case"alt+up":this.moveUp();break;case"alt+down":this.moveDown();break;case"enter":case"space":this.props.onActivate&&(this.props.onActivate(this.state.selectedIndex,e),n=!1);break;default:n=!1}n&&e.preventDefault()}};getButtonClassByIndex=e=>d()({item:!0,"item-is-static":this.props.items[e].isStatic,"item-default":this.props.items[e].isDefault,"item-selected":e===this.state.selectedIndex&&!(this.state.isCreating||this.props.isCreating),"item-dragged":this.state.selectedIndex===e&&this.state.dragIndex===e,dragoverAbove:e===this.state.dropIndex&&"above"===this.state.dropPosition,dragoverBelow:e===this.state.dropIndex&&"below"===this.state.dropPosition});render(){const{items:e,filter:t,emptyListGraphic:n,emptyListString:s}=this.props,{selectedIndex:i}=this.state,o=this.state.isCreating||this.props.isCreating,a=null!=i&&e[i],l=!!a&&e[i].isDefault,d=0===e.length&&!o,c=e[i]?.isStatic,p=0!==e.length&&e[i-1]?.isStatic,m=e.length<i+1&&e[i+1]?.isStatic;return v("div",{className:"master-detail sortable-list"},void 0,(0,g.jsxs)("div",{ref:this.refItems,className:"master-items",onDragEnter:this.onDragEnter,onDragLeave:this.onDragLeave,onDragOver:this.onDragOver,onDrop:this.onDrop,onKeyDown:this.onKeyDown,tabIndex:d?-1:0,children:[d&&n&&s&&v("div",{className:"master-items-empty",dangerouslySetInnerHTML:{__html:`${n}<div>${s}</div>`}}),e.map(((e,n)=>v("button",{type:"button",title:e.label,className:this.getButtonClassByIndex(n),tabIndex:-1,draggable:this.props.supportDragAndDrop,onContextMenu:this.props.onContextMenu?this.props.onContextMenu.bind(this,n):null,onDragStart:this.onDragStartButton.bind(this,n),onDragEnter:this.onDragEnter,onDragLeave:this.onDragLeave,onDragOver:this.onDragOverButton.bind(this,n),onDrop:this.onDropButton.bind(this,n),onDragEnd:this.onDragEnd,onMouseDown:this.focusItem.bind(this,n),onDoubleClick:this.onDoubleClick.bind(this,n)},n,this.props.renderListItem((0,h.CH)(e.name,t),e)))),"function"==typeof this.props.renderCreateListItem&&o&&this.props.renderCreateListItem()&&v("button",{className:"item item-selected"},void 0,this.props.renderCreateListItem())]}),(this.props.optionsList||this.props.onRemove||this.props.moveItem)&&v("div",{className:"master-toolbar"},void 0,this.props.optionsList&&v("select",{className:"button-toolbar sortable-list-options",onChange:this.props.onCreateItem,title:this.props.addTipString,defaultValue:null},void 0,this.props.optionsList&&this.props.optionsList.map((e=>v("option",{value:e.key},e.key,e.value,""!==e.key&&` [${e.key}]`)))),this.props.onRemove&&(0,g.jsxs)(g.Fragment,{children:[v("button",{className:"button-toolbar",style:this.props.optionsList?{pointerEvents:"none"}:null,tabIndex:this.props.optionsList?-1:null,title:this.props.addTipString,onClick:this.setIsCreating,disabled:this.props.onCancelCreate&&o,dangerouslySetInnerHTML:{__html:u.md4.medium}}),v("button",{className:"button-toolbar",title:this.props.deleteTipString,onClick:this.removeItem.bind(this,i),disabled:!o&&e.length<1||l||c||a&&!1===e[i].isRemovable,dangerouslySetInnerHTML:{__html:u.M2k.medium}})]}),this.props.moveItem&&(0,g.jsxs)(g.Fragment,{children:[v("button",{className:"button-toolbar button-move-up",title:(0,r.Z)("Move Up ($1)",[this.moveUpCombo]),onClick:this.moveUp,disabled:c||p,dangerouslySetInnerHTML:{__html:u.OCp.medium}}),v("button",{className:"button-toolbar button-move-down",title:(0,r.Z)("Move Down ($1)",[this.moveDownCombo]),onClick:this.moveDown,disabled:c||m,dangerouslySetInnerHTML:{__html:u.yaZ.medium}})]})))}}const y=f},20676:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var s=n(76747),i=n(96951),o=n(14481),a=n(32921),r=n(26036),l=n(35369),d=n(36436);const c=[1,2,5,10,30,60,90],h=(e,t,n)=>{const h=i.ZP.getPageByReloadId(e);if("tab"===t&&h&&(0,d.xl)(h.url))return[];const p=a.Z.existingAlarms(),u=a.Z.getAlarmFromReloadId(e),g="panel"===t?"panel":"tab",m=c.map((s=>({type:"checkbox",checked:u?.periodInMinutes===s,handler:()=>{let r;if("stack"===t)r=i.ZP.getGroup(e,n).filter((e=>!(0,d.xl)(e.url)));else if("select"===t)r=i.ZP.getSelectedPages(n).filter((e=>!(0,d.xl)(e.url)));else{if("tab"!==t){const t={alarm:u,id:e,interval:s,from:g};return void o.Z.createOrDestroyAlarm(t)}r=l.aV.of(h)}r.forEach((e=>{const t=e?.vivExtData.ext_id;if(t){const e={alarm:a.Z.getAlarmFromReloadId(t),id:t,interval:s,from:g};o.Z.createOrDestroyAlarm(e)}}))},commandName:"PERIODIC_RELOAD",parameter:s.toString(),...(0,r.Z)("$1 Minute","$1 Minutes",[s])})));return[...m,...[s.Z.separatorItem,{isVisible:()=>Boolean(u?.id.includes(e)),handler:()=>{o.Z.destroyPeriodicAlarm({id:e,from:g})},commandName:"PERIODIC_RELOAD_DISABLE",parameter:"",...(0,r.Z)("timer","Disable")},{isVisible:()=>p,handler:()=>{"panel"===g?o.Z.destroyAllPanelPeriodicAlarms():o.Z.destroyTabPeriodicAlarms(n)},commandName:"PERIODIC_RELOAD_DISABLE",parameter:"all",...(0,r.Z)("timers","Disable All")}]]},p={getForActivePage:e=>{const t=i.ZP.getActivePage(e),n=t?t.vivExtData.ext_id:void 0;return n?h(n,"tab",e):[]},getMenu:h,getHandlerByAction:(e,t,n)=>{let s;switch(t){case"PERIODIC_RELOAD":const t=i.ZP.getActivePage(e),r=t?t.vivExtData.ext_id:"";if(r){const e=a.Z.getAlarmFromReloadId(r),t=parseInt(n);s=()=>o.Z.createOrDestroyAlarm({alarm:e,id:r,interval:t,from:"tab"})}break;case"PERIODIC_RELOAD_DISABLE":if("all"===n)s=()=>o.Z.destroyTabPeriodicAlarms(e);else{const t=i.ZP.getActivePage(e),n=t?t.vivExtData.ext_id:"";n&&(s=()=>o.Z.destroyPeriodicAlarm({id:n,from:"tab"}))}}return s}}},73132:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o,g:()=>i});var s=n(78614);const i="/resources/contact-person.png";function o(e){const t={toString:function(){return(0,s.gU)(this)},isEmpty:function(){return!(this.name||0!==this.emailAddresses.length||this.birthday||this.note||0!==this.postalAddresses.length||0!==this.phonenumbers.length||this.avatarUrl)},clearGenerated:function(){this.isGeneratedFromSentMail&&(this.isGeneratedFromSentMail=!1)}};return Object.assign(Object.create(t),e)}},64473:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var s,i=n(67294),o=n(63377),a=n(84451),r=n(94283),l=n(52250),d=n(48521);function c(e,t,n,i){s||(s="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=i;else if(a>1){for(var r=new Array(a),l=0;l<a;l++)r[l]=arguments[l+3];t.children=r}if(t&&o)for(var d in o)void 0===t[d]&&(t[d]=o[d]);else t||(t=o||{});return{$$typeof:s,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var h=c("div",{className:"modal-faded-background"});class p extends i.Component{static contextType=r.Z;focusTrapRef=i.createRef();modalRef=i.createRef();componentDidMount(){this.props.ignoreEscape||a.Z.bind("meta+.",this.closeModalHandler)}componentWillUnmount(){this.props.ignoreEscape||a.Z.unbind("meta+.",this.closeModalHandler)}getNode(){return this.modalRef.current}closeModalHandler=()=>{this.props.onRequestClose()};handleClickOutside=e=>{this.props.ignoreClickOutside&&!e.target.closest(".window-close")||this.props.onRequestClose(e)};keyDownModal=e=>{"Escape"!==e.key||this.props.ignoreEscape||(e.preventDefault(),e.stopPropagation(),this.props.onRequestClose(e.nativeEvent))};renderBackground=()=>h;render(){const e="float"===this.props.viewMode||"onboarding"===this.props.viewMode;return(0,d.jsxs)(d.Fragment,{children:[e&&this.renderBackground(),(0,d.jsx)(o.Z,{focusName:"focus_modal",forceTrap:!this.props.asToolbar,id:"modal-bg",ref:this.focusTrapRef,className:this.props.viewMode?this.props.viewMode:"slide",style:this.props.style,onKeyDown:this.keyDownModal,children:(0,d.jsx)("div",{ref:this.modalRef,className:"modal-wrapper",children:this.props.children})})]})}}const u=(0,l.Z)(p)},71193:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var s=n(96951),i=n(29087),o=n(15489),a=n(35369),r=n(89175);function l(e){const t=o.ZP.getActiveWorkspace(e),n=s.ZP.getPages(e,{workspaceId:t});if(i.Z.get(r.kTabsCycleByRecentOrder)){const t=s.ZP.getPageHistory(e);return(0,a.aV)(t.map((e=>n.find((t=>t.id===e)))).filter(Boolean).reverse())}return n}},46884:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var s=n(94283),i=n(67294);function o(e,t,n="ignore-react-onclickoutside",o=!1){const{document:a,Element:r}=(0,i.useContext)(s.Z);(0,i.useEffect)((()=>{if(!o)return setTimeout((()=>{a.addEventListener("mousedown",s),a.addEventListener("pointerdown",s),a.addEventListener("touchstart",s)})),()=>{a.removeEventListener("mousedown",s),a.removeEventListener("pointerdown",s),a.removeEventListener("touchstart",s)};function s(s){const i=e(),o=t();if(!i||!o)return;let a=s.target;for(;a instanceof r;){const{classList:e}=a;if(Array.isArray(n)){if(n.some((t=>e.contains(t))))return}else if(e.contains(n))return;a=a.parentNode}s.target instanceof r&&!i.contains(s.target)&&o(s)}}),[r,o,a,t,e,n])}},4668:(e,t,n)=>{"use strict";n.d(t,{BZ:()=>o,JX:()=>r,Ve:()=>a,up:()=>c});var s=n(83784),i=n(92292);function o(e){return e.replace(/["~*\/:<>?\\|\p{Cc}\p{Cf}]+/gu," ").replace(/^[ .]+|[ .]+$/g,"")}function a(e,t){d(l(e),o(e.filename),t)}function r(e){const t=l(e),n=o(e.filename);return{suggestedFilename:n,url:t,request:{deny:()=>URL.revokeObjectURL(t),allow:e=>d(t,n,e)}}}function l(e){const t=c(e);return URL.createObjectURL(t)}function d(e,t,n){i.Z.downloads.download({url:e,filename:t,saveAs:"saveas"===n},(t=>{URL.revokeObjectURL(e),"open"===n&&s.Z.addOpenAfterDownload(t)}))}function c(e){const t=e.content,n=e.mimeType;return new Blob([t],{type:n})}},88630:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var s=n(62366),i=n(29087),o=n(10124),a=n(7064),r=n(70611),l=n(89175),d=n(78614);async function c(e,t){const n="string"==typeof t.content?await(0,o.Z)(t.content):t.content;return e.setContent(n)}function h(e){const t=e.method?`text/calendar; charset=utf-8; method=${e.method}`:"text/calendar; charset=utf-8";return c(new s.Z(t),e)}const p={build:async function(e,t,n){let o;const p=await(0,r.iT)(t),u=n.filter((e=>(e.mimeType.startsWith("multipart/")&&(e.mimeType="application/octet-stream"),"application/ics"===e.mimeType)));if("string"==typeof p){const e=new s.Z("text/plain; charset=utf-8");e.setContent(p),u.length?(o=new s.Z("multipart/alternative"),o.appendChild(e),o.appendChild(await h(u[0]))):o=e}else{const e=(0,r.yy)(t);o=new s.Z("multipart/alternative");const i=new s.Z("text/plain; charset=utf-8");i.setContent(e),o.appendChild(i);const a=n.filter((e=>e.id)),l=new s.Z("text/html; charset=utf-8");if(l.setContent(t),a.length>0){const e=new s.Z("multipart/related");e.appendChild(l);for(const t of a){const n=e.createChild(t.mimeType,{filename:t.filename});await c(n,t),n.setHeader("Content-Disposition","inline").setHeader("Content-Id",t.id)}o.appendChild(e)}else o.appendChild(l);u.length&&o.appendChild(await h(u[0]))}const g=n.filter((e=>!e.id));let m;if(g.length>0){m=new s.Z("multipart/mixed"),m.appendChild(o);for(const e of g){const t=m.createChild(e.mimeType,{filename:e.filename});t.setHeader("Content-Disposition","attachment"),await c(t,e)}}else m=o;return m.addHeader("message-id","<"+e.messageId+">"),m.addHeader("from",(0,d.Rz)(e.from)),m.addHeader("to",(0,d.Rz)(e.to)),m.addHeader("cc",(0,d.Rz)(e.cc)),m.addHeader("subject",e.subject),m.addHeader("date",new Date(e.sentDate).toUTCString().replace(/GMT/,"+0000")),e.inReplyTo&&e.inReplyTo.length>0&&m.addHeader("in-reply-to","<"+e.inReplyTo+">"),e.references&&e.references.length>0&&m.addHeader("references","<"+e.references.join("> <")+">"),e.listId&&m.addHeader("list-id",e.listId),e.listPost&&m.addHeader("list-post",e.listPost),i.Z.get(l.kMailIncludeIdentifyingHeaders)&&(m.addHeader("X-Mailer","Vivaldi Mail"),m.addHeader("User-Agent",`Vivaldi Mail/${a.Z.utilities.getVersion().vivaldiVersion}`)),m.build()}}},13933:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});const s=new class{#me;set(e){this.#me=e}get(){return this.#me}}},36943:(e,t,n)=>{"use strict";n.d(t,{Z:()=>N});var s=n(58537),i=n(3184),o=n(99827),a=n(98611),r=n(46382),l=n(29087),d=n(15489),c=n(56371),h=n(78347),p=n(48868),u=n(51501),g=n(45709),m=n(10671),v=n(95752),f=n(45660),y=n(68906),C=n(6977),w=n(35458),b=n(5204),S=n(5863),I=n(6129),k=n(89175),A=n(8684);class T{updatedSources=new Map;imapAddCustomFlags=[];imapDelete=[];imapCopy=[];addSourceUpdate(e,t,n){const s=this.updatedSources.get(t);s?s.set(e,n):this.updatedSources.set(t,new Map([[e,n]]))}addSource(e,t,n=!0){const{id:s,accountId:i,path:o}=e,a={read:n,deleted:!1,internal:!m.Z.isOnline(i,o)};this.addSourceUpdate(s,t,a)}removeSource(e,t){this.addSourceUpdate(e,t,void 0)}deleteSource(e,t){const{id:n,accountId:s,path:i}=e,o=m.Z.isOnline(s,i)?{read:true,deleted:true,internal:!0}:{read:true,deleted:true};this.addSourceUpdate(n,t,o)}undeleteSource(e,t){const{id:n,accountId:s,path:i}=e,o=m.Z.isOnline(s,i)?{deleted:false,internal:!1}:{deleted:false};this.addSourceUpdate(n,t,o)}addImapDelete(e,t,n){this.imapDelete.push({accountId:e,path:t,searchListId:n})}addImapCopy(e,t,n){const s=t.find((t=>{const n=e.sources.get(t);return n&&!n.internal}));if(s){const t=a.Z.get(s);if(!t)throw new Error("Filter not found "+s);const{accountId:i,path:o}=t;this.imapCopy.push({accountId:i,path:o,destinationPath:n,searchListId:e.id});const r=e.sources.get(s);r&&!r.read&&this.imapAddCustomFlags.push([i,o,e.id])}}}function Z(e){const t=new Map;return[...e.keys()].forEach((e=>{const n=a.Z.get(e);if(!n)throw new Error("Filter not found "+e);const{accountId:s}=n,i=t.get(s);i?i.push(e):t.set(s,[e])})),t}async function E(e,t){const{updatedSources:n,imapAddCustomFlags:i,imapCopy:a,imapDelete:r}=e,l=new Set;if(n.size>0&&(l.add(p.Z.searchList),l.add(p.Z.filteringQueue),l.add(p.Z.filters),l.add(p.Z.hasRaw)),(r.length>0||a.length>0||i.length>0)&&(l.add(p.Z.imap),l.add(p.Z.buffer)),l.size>0){let e=[];await p.Z.transaction("rw",[...l],(async()=>{if(n.size>0){e=await w.Z.call(n);const s=[];n.forEach(((e,t)=>{const n=[...e.keys()],i=s.find((({filterIds:e})=>e.length===n.length&&e.every((e=>n.includes(e)))));i?i.searchListIds.push(t):s.push({filterIds:n,searchListIds:[t]})}));for(const{filterIds:e,searchListIds:n}of s)y.Z.call({type:"RE_RUN_SLES",priority:S.Un.HIGH,searchListIds:n,filterIds:e,folderIds:[[S.of,t]]})}if(i.length>0){const e={[S.T4.SEEN]:!0};await C.Z.addCustomFlagsImapKeys(i,e)}a.length>0&&await C.Z.addCopy(a),r.length>0&&await C.Z.addDelete(r)})),b.Z.filter(),s.Z.flushBuffer(),e.length>0&&o.Z.updateIndex({sleUpdates:e})}}async function _(e,t,n){const s=new T;for(const p of e){const{id:e,sources:g}=p,m=Z(g);for(const g of m){const m=g[0],v=g[1];if(!(0,I.ZA)(m)){f.Z.warn("Mail",`Can not move message to ${n} on ${m} as it is not an IMAP account`);continue}let y=h.Z.getSubscribedFoldersOfType(m,t);if((!y||0===y.length)&&t===S.hn){if(l.Z.get(k.kMailAddArchiveFolder)||await new Promise((e=>{r.Z.showCreateArchiveFolderConfirmation(d.ZP.getMailWindowId(),(t=>e(t)),(0,c.Z)("Create missing archive folder?"),(0,c.Z)("No archive folder was detected for $1. In order to archive mail an archive folder must be present. Should a new archive folder be created?",[m]))}))){if(!navigator.onLine){(0,A.c)({title:(0,c.Z)("Can not create Archive folder without a network connection"),timeout:3e4,tag:"VIVALDI_MAIL_CREATE_ARCHIVE_FOLDER"}),f.Z.log("Mail",`Can not create Archive folder without a network connection - ${m}`);continue}(0,A.c)({title:(0,c.Z)(`Creating Archive folder for ${m}`),timeout:3e4,tag:"VIVALDI_MAIL_CREATE_ARCHIVE_FOLDER"});const e=h.Z.getFoldersOfType(m,S.e9);if(0===e.length)throw new Error(`No inbox folder found on imap account ${m}`);const t=e[0];await i.Z.createMailbox(m,S.$T),y=[{path:S.$T,name:S.$T,type:S.hn,subscribed:!0,delimiter:t.delimiter}];const n=u.Z.getDefaultFilterForPath(m,S.$T,S.hn);await o.Z.addFilter(n,!1)}else f.Z.warn("Mail",["Move to Archive"],"No archive folder and hence nothing moved")}if(y&&y.length>0){y.length>1&&y.sort(((e,t)=>e.path.split(e.delimiter).length-t.path.split(t.delimiter).length));const t=y[0],{path:n}=t,i=a.Z.getByFolder(m,n);if(!i)throw new Error("Filter not found "+m+" "+n);const{id:o}=i,r=p.sources.get(o);r?r.internal&&s.addImapCopy(p,v,n):(s.addSource(i,e),s.addImapCopy(p,v,n)),v.forEach((t=>{if(o===t)return;const n=p.sources.get(t);if(!n)throw new Error("Source not found "+t+" on listEntry "+p.id);if(n.read||s.addSourceUpdate(t,p.id,{read:!0}),!n.internal){const n=a.Z.get(t);if(!n)throw new Error("Filter not found "+t);s.addImapDelete(m,n.path,e),s.deleteSource(n,e)}}))}}}await E(s,n)}async function M(e,t,n){const s=new T;e.forEach((e=>{const{id:n,sources:i}=e;Z(i).forEach(((o,r)=>{const l=a.Z.getByIds(o),d=l.some((({accountId:e,path:t})=>m.Z.getFolderType(e,t)===S.uT));if(d)l.forEach((({id:e,accountId:i,path:o})=>{m.Z.getFolderType(i,o)===t&&(s.removeSource(e,n),s.addImapDelete(i,o,n))}));else{let d=!1;if(l.forEach((a=>{const{id:r,accountId:l,path:c}=a;if(m.Z.getFolderType(l,c)===t)s.removeSource(r,n),s.addImapDelete(l,c,n);else{d=!0;const t=i.get(r);if(!t)throw new Error("Source not found");t.deleted&&(s.undeleteSource(a,n),s.addImapCopy(e,o,c))}})),!d){const t=h.Z.getFoldersOfType(r,S.e9);if(0===t.length)throw new Error("No inbox found on account "+r);const l=t[0].path,d=a.Z.getByFolder(r,l);if(!d)throw new Error("Inbox filter not found "+r+" "+l);const c=v.Z.call(i);s.addSource(d,n,c),s.addImapCopy(e,o,l)}}}))})),await E(s,n)}const N={moveToJunk:async function(e){g.Z.setJunk(e,!0),await _(e,S.Hd,S.rp)},restoreFromJunk:async function(e){g.Z.setJunk(e,!1),await M(e,S.Hd,S.rp)},moveToArchive:async function(e){await _(e,S.hn,S.$T)},restoreFromArchive:async function(e){await M(e,S.hn,S.$T)}}},75995:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o,o:()=>i});var s=n(95752);function i(e){delete e.isParent,delete e.parentId,delete e.isChild,delete e.children,delete e.unreadInThread}const o={getThreadsAsTree:function(e,t=!0){if(0===e.length)return[];let n;t||e.reverse();let o=[];const a=[e[0]];i(e[0]);for(let t=1;t<e.length;t++){const r=e[t-1],l=e[t];if(i(l),l.threadKey[0]===r.threadKey[0]&&l.threadKey[1]===r.threadKey[1]){if((!n||l.threadKey.length>r.threadKey.length)&&(n?o.push(n):o.push(r),n=r,r.isParent=!0),o.length>0&&l.threadKey.length<r.threadKey.length){const e=l.threadKey.length-1;o=o.slice(0,e),n=o[o.length-1]}l.parentId=n.id,l.isChild=!0,n.children=n.children||[],n.children.push(l),s.Z.call(l.sources)||n.unreadInThread||(n.unreadInThread=!0,o.forEach((e=>e.unreadInThread=!0)))}else a.push(l),n=void 0,o=[]}return t?a:a.reverse()}}},91834:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});const s={updateCounterFolders:function(e,t,n,s){s.forEach((({viewIntersections:s,counter:i})=>{let o=!1,a=!1,r=!1;for(const n of t){if(!o){s.total.get(n)?.every((t=>e.has(t)))&&(o=!0)}if(!a){s.unseen.get(n)?.every((t=>e.has(t)))&&(a=!0)}if(!r){s.unread.get(n)?.every((t=>e.has(t)))&&(r=!0)}}o&&(i.total+=n),a&&(i.unseen+=n),r&&(i.unread+=n)}))}}},77312:(e,t,n)=>{"use strict";n.d(t,{MT:()=>a,TP:()=>r,fN:()=>l});var s=n(45660),i=n(9112),o=n(7064);async function a(e){const t=["attached-pending"];try{await o.Z.mailPrivate.deleteMessageFile(t,e)}catch(t){s.Z.warn("Mail",["attachment"],`Failed to delete pending attachment file ${e} - error: ${t}`)}}async function r(e){const t=[],n=await(0,i.Z)(e);for(const e of n)if(e.bodyParts)for(const n of e.bodyParts)"attachment"===n.type&&"string"==typeof n.content&&t.push(n.content);return t}async function l(e){const t=await r([e]);for(const e of t)await a(e)}},45709:(e,t,n)=>{"use strict";n.d(t,{Z:()=>g});var s=n(58537),i=n(71320),o=n(10671),a=n(45660),r=n(48868);const l={call:async function(e){0!==e.searchListIds.length?await r.Z.flaggingQueue.add(e):console.warn("Not queueing flag update request with no searchListIds")}};var d=n(18787),c=n(5863),h=n(49168);function p(e,t,n,s){return u(e,{[t]:n},void 0,s)}function u(e,t,n=new Map,i){const o=e.map((e=>e.id)),r=new Map,c=[];e.forEach((e=>{const s={},i=(0,h.hY)(e.flags,t);e.flags=s.flags=i;const o=n.get(e.id);if(o&&o.size>0){const t=new Map,n=new Map;o.forEach(((i,o)=>{t.set(o,i),!0===i.read&&(e.unseen=s.unseen=!1);const a=e.sources.get(o);if(a){const e={};for(const t of Object.keys(i))i[t]!==a[t]&&(e[t]=a[t]);Object.keys(e).length>0&&n.set(o,e)}})),s.sources=t,r.set(e.id,n)}const{id:a}=e;c.push({id:a,updates:s})}));const p={searchListIds:o,sourcesPerSle:n,flagUpdates:t};if(a.Z.log("Mail",["add to flagging queue"],p),l.call(p),s.Z.updateFlags(),i){const n={};for(const e of Object.keys(t))n[e]=!t[e];d.Z.push({operation:"setFlags",updates:n,sourcesPerSle:r,updateItems:e})}return c}const g={setRead:function(e,t,n=!0){const s=[],a=new Map;return e.forEach((e=>{const{id:n,sources:r}=e,l=new Map;r.forEach(((e,n)=>{const s=i.Z.get(n);if(!s)throw new Error(`filter for sourceFilterId ${n} not found!`);const a=o.Z.getFolderType(s.accountId,s.path)===c.Nz&&!t;e.read===t||a||l.set(n,{read:t})})),l.size>0&&(s.push(e),a.set(n,l))})),u(e,{},a,n)},setFlagged:function(e,t){return p(e,c.T4.FLAGGED,t,!0)},setForwarded:function(e,t){return p(e,c.T4.FORWARDED,t,!1)},setReplied:function(e,t){return p(e,c.T4.ANSWERED,t,!1)},setCustomFlags:function(e,t,n=new Map,s=!0){return u(e,t,n,s)},getStandardFlagList:function(){return[c.T4.RED,c.T4.ORANGE,c.T4.YELLOW,c.T4.GREEN,c.T4.BLUE,c.T4.PURPLE,c.T4.GRAY,c.T4.CLEAR_FLAGS]},setJunk:function(e,t){let n={[c.T4.JUNK]:t,[c.T4.NOT_JUNK]:!t};return t&&(n={...n,NonJunk:!1,NotJunk:!1}),u(e,n,void 0,!0)}}},32593:(e,t,n)=>{"use strict";n.d(t,{C7:()=>k,Gb:()=>T,KJ:()=>I,NQ:()=>A,jm:()=>Z,m6:()=>E,oN:()=>S});var s=n(39045),i=n(58537),o=n(82227),a=n(99827),r=n(29087),l=n(78347),d=n(60308),c=n(9982),h=n(71320),p=n(51501),u=n(10671),g=n(24651),m=n(5204),v=n(11430),f=n(99895),y=n(5863),C=n(76257),w=n(83065),b=n(89175);async function S(e,t){const n=u.Z.getFolders();if(!("inbox"===t.toLowerCase()&&n[e]&&Object.keys(n[e]).some((e=>"inbox"===e.toLowerCase()))||n[e]&&n[e][t])){const n=k(t),i=l.Z.getAccounts(),o=i[e]?i[e].folders:{},a="/",r=t.split(a),d={name:(0,w.kF)(r[r.length-1]),path:t,delimiter:a,type:n};o[n]=o[n]||[],o[n].push(d),await s.Z.addFolders(e,o),m.Z.addFolders(e,o)}}async function I(e,t){let n=h.Z.getByFolderId([e,t]);if(!n&&(n=await o.Z.get(e,t),!n)){const s=k(t);n=p.Z.getDefaultFilterForPath(e,t,s),await a.Z.addFilter(n,!1)}}function k(e){let t=y.Oi,n=e.toLowerCase();switch(n.startsWith("[gmail]/")&&(n=n.split("/")[1]),n){case"archive":t=y.hn;break;case"drafts":t=y.kY;break;case"inbox":t=y.e9;break;case"junk":case"spam":t=y.Hd;break;case"sent":case"sent mail":t=y.Nz;break;case"trash":t=y.uT}return t}function A(e,...t){return"/"!==e[e.length-1]&&(e+="/"),e+t.join("/")}async function T(){return new Promise((e=>{l.Z.addListener((function t(){l.Z.removeListener(t),e()}))}))}async function Z(e,t,n){const s=(0,C.Zp)(n),i=(0,C.PW)(s);let o=[],a=n;if(i){const e=await v.Z.parseMail(n,i.mimeTree);o=e.bodyParts,a=e.raw}const r=(0,C.Dc)(s);return{to:e.to,from:e.from,cc:e.cc,inReplyTo:e.inReplyTo,replyTo:e.replyTo,subject:e.subject,sentDate:e.sentDate,messageId:e.messageId||"",listId:e.listId,listPost:e.listPost,references:e.references,flags:t,internal:!0,raw:a,attachment:r.length,bodyParts:o}}async function E(e,t,n){r.Z.get(b.kMailAutoGenerateContacts)&&await(0,c.Z)(e,t,n);const{indexUpdates:s,slesToDisk:o}=await(0,d.Z)(e,t,k(t),n);a.Z.updateIndex(s);const l=[];for(const t of o){const s=n.find((e=>e.messageId===t.messageId&&(!e.sentDate&&!t.sentDate||e.sentDate===t.sentDate)&&e.subject===t.subject));if(!s)throw new Error(`Added sle not found in incoming batch, ${t.messageId}, ${t.sentDate}, ${t.subject}`);l.push(t.id),await f.Z.call(e,t.sentDate,t.id,s.raw)}l.length>0&&await g.Z.setHasRaws(e,l),m.Z.filter(),i.Z.updateThreads()}},54773:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});const s=new class{mailAddresses=[];addressMap=new Map;nameMap=new Map;clear=()=>{this.mailAddresses=[],this.addressMap=new Map,this.nameMap=new Map};add=e=>{const{address:t,name:n=""}=e,s=this.addressMap.get(t)||[],i=this.nameMap.get(n)||[];let o=s.find((e=>i.includes(e)));return void 0!==o||(o=this.mailAddresses.length,this.mailAddresses.push(e),0===s.length?this.addressMap.set(t,[o]):s.push(o),0===i.length?this.nameMap.set(n,[o]):i.push(o)),o};get=e=>e.map((e=>{if(void 0===this.mailAddresses[e])throw new Error(`MailAddressCache.get: Requested index ${e} not found in cache.`);return this.mailAddresses[e]}))}},19842:(e,t,n)=>{"use strict";n.d(t,{Ds:()=>r,Rr:()=>l,Wm:()=>d,vE:()=>a});var s=n(39005),i=n(96951),o=n(44850);function a(e){return!!o.jk.matchUrl(o.jk.internalUrl("mailpage","composer"),e)}function r(e){return!!o.jk.matchUrl(o.jk.internalUrl("mailpage","message"),e)}function l(e){const t=i.ZP.getTabs(e).find((e=>e.page.active));return!(!t||!t.page)&&r(t.page.url)}function d(e){return Boolean(i.ZP.getActivePage(e)?.isMailPage)&&Boolean(s.Z.getActiveMessage())}},88951:(e,t,n)=>{"use strict";function s(e){const t=e?e.substring(e.indexOf("@")+1):"vivaldi.com",n=new Uint32Array(2);return crypto.getRandomValues(n),Date.now()+"."+n.join(".")+"@"+t}n.d(t,{Z:()=>s})},59552:(e,t,n)=>{"use strict";n.d(t,{Z:()=>A});var s=n(43630),i=n(58537),o=n(3184),a=n(99827),r=n(46382),l=n(56371),d=n(48868),c=n(83204),h=n(71320),p=n(10671),u=n(45660),g=n(68906),m=n(6977),v=n(35489),f=n(24651),y=n(35458),C=n(5204),w=n(83507),b=n(99895),S=n(5863),I=n(6129);async function k(e,t){return(await v.Z.getBySearchListId(t)).sort(((t,n)=>t.accountId===e&&t.hasRaw?-1:n.hasRaw-t.hasRaw))}const A=async function(e,t,n,v,A){const{accountId:T,path:Z}=n.find((e=>e.accountId===v))||n.slice(-1)[0];u.Z.log("Mail",["move"],`${T}/${Z}->${v}${A}`);const E=T===v;let _=T;for(const n of t){const{id:t}=n,s=await k(T,t);if(s[0].hasRaw)continue;let i=!1;for(const e of s)if((0,I.mq)(e.accountId)){u.Z.log("Mail",["move"],`Need to fetch source on ${e.accountId}`);if(await o.Z.fetchRawOfMessage(e.accountId,e.searchListId)){await f.Z.setHasRaw(e.accountId,e.searchListId),i=!0,E||(_=e.accountId);break}}if(!i){const t=(0,l.Z)("Aborting the move action because of failure to locate or fetch body for message with subject: $1",[n.subject]);return u.Z.warn("Mail",["move"],t),void r.Z.showModalInfo(e,{title:(0,l.Z)("No messages moved between accounts"),body:t})}}const M=h.Z.getByFolderIds(n.map((e=>[e.accountId,e.path]))),N=h.Z.getByFolderId([v,A]);if(!N)throw new Error(`Could not move messages.\n      No filter found for ${T}/${Z}\n      or ${v}/${A}\n      when trying to move ${t.length} messages`);const P=new Map;t.forEach((e=>{const t=M.filter((t=>e.sources.has(t.id))),n=(s=t).find((e=>e.accountId===v))||s.slice(-1)[0];var s;if(!n)throw new Error(`Can not move message to ${v}/${A}\n        No origin filter found for entry:\n        ${e.subject}\n        with origin filters: ${t.map((e=>`${e.accountId}/${e.path}`)).join(", ")}`);const i=e.sources.get(n.id);if(!i)throw new Error(`Can not move message from ${T}/${Z}\n        No source found for entry:\n        ${e.subject}\n        in filter: ${n.name}`);const o={...i};n.accountId===v||(0,I.mq)(v)||i.internal||(o.internal=!0);const a=new Map;M.forEach((e=>{a.set(e.id,void 0)})),a.set(N.id,o),P.set(e.id,a)}));let D=[];const x=[],O=[],L=[];t.forEach((e=>{if((0,I.mq)(v)){let t=!1;if([...e.sources].some((([n,s])=>{const i=h.Z.get(n);i&&!s.internal&&M.some((e=>e.id===i?.id))&&(i.accountId===v?(t=!0,x.push({accountId:i.accountId,path:i.path,destinationPath:A,searchListId:e.id})):L.push({accountId:i.accountId,path:i.path,searchListId:e.id}))})),!t){const t=[...e.flags].filter((e=>e!==S.T4.DELETED&&e!==S.T4.JUNK));M.some((t=>e.sources.get(t.id)?.read))&&(t.includes(S.T4.SEEN)||t.push(S.T4.SEEN)),O.push({accountId:v,path:A,searchListId:e.id,flags:t})}}}));const R=[d.Z.searchList,d.Z.filteringQueue,d.Z.filters,d.Z.hasRaw];if(x.length>0||L.length>0?R.push(d.Z.buffer,d.Z.imap,d.Z.flaggingQueue):O.length>0&&R.push(d.Z.buffer,d.Z.flaggingQueue),await d.Z.transaction("rw",R,(async()=>{if(x.length>0&&(u.Z.log("Mail",["move"],"Issuing a server side move action"),await s.Z.clearJunkFlags(e,t),await s.Z.clearDeletedFlags(e,t),await m.Z.addMove(x)),O.length>0&&(u.Z.log("Mail",["move"],"Issuing an upload to destination server",v),await m.Z.addUpload(O)),L.length>0)for(const e of M)e.accountId!==v&&(u.Z.log("Mail",["move"],"Issuing a deletion from source server",T),await m.Z.addDelete(L));u.Z.log("Mail",["move"],"Update source data"),D=await y.Z.call(P);const n=h.Z.getByFolderIds([...M.map((e=>[S.Ry,`${e.accountId}/${e.path}`])),[S.Ry,`${v}/${A}`]]).map((e=>e.id)),i=[...M.map((e=>[e.accountId,e.path])),[v,A]],o=t.map((e=>e.id));1===M.length&&p.Z.getFolderType(T,Z)===p.Z.getFolderType(v,A)?(u.Z.log("Mail",["move"],"Requesting filtering (FILTERS_SLES)"),await g.Z.call({type:"FILTERS_SLES",priority:S.Un.HIGH,folderIds:i,filterIds:n,searchListIds:o})):(u.Z.log("Mail",["move"],"Requesting filtering (RE_RUN_SLES)"),await g.Z.call({type:"RE_RUN_SLES",priority:S.Un.HIGH,folderIds:i,filterIds:n,searchListIds:o}))})),E){u.Z.log("Mail",["move"],"Set hasRaw to true for all in-account source updates");for(const e of t)f.Z.setHasRaw(T,e.id)}else{u.Z.log("Mail",["move"],"Writing raw files to destination account");for(const e of t){const t=await w.Z.call(_,e.id,e.sentDate);t?(await b.Z.call(v,e.sentDate,e.id,t),await f.Z.setHasRaw(v,e.id)):u.Z.error("Mail",["move"],`Failed to write raw for message ${e.id} to destination account ${v}`)}u.Z.log("Mail",["move"],"Deleting raw files from source account");for(const e of t)await c.Z.call(T,e.id,e.sentDate)}i.Z.flushBuffer(),C.Z.filter(),D.length>0&&a.Z.updateIndex({sleUpdates:D})}},307:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var s=n(53576),i=n(44850);function o(e,t){var n="message/"+t.id,o=t.subject,a=i.jk.internalUrl("mailpage",n,o);s.ZP.openURL(e,a)}},13311:(e,t,n)=>{"use strict";n.d(t,{Z:()=>Y});var s=n(58537),i=n(4660),o=n(99827),a=n(88630),r=n(98611),l=n(60331),d=n(56371),c=n(42315),h=n(45660),p=n(5863),u=n(90305),g=n(6271);let m=!1;const v=function(e,t,n,s){if(this.alreadySending)return void h.Z.log("Mail",["smtp","onidle"],`[${e.MAIL_EMAIL}]Already Sending!`);h.Z.log("Mail",["smtp","onidle"],`[${e.MAIL_EMAIL}]`),this.alreadySending=!0;const i=[...t,...n,...s].map((e=>e.address));this.useEnvelope({from:e.MAIL_EMAIL,to:i})},f=function(e,t,n){h.Z.log("Mail",["smtp","onready"],"failedRecipients:",n.length),n.length>0?t({message:(0,d.Z)("Rejected recipients: $1",[n.join()])}):(this.send(e),this.end())},y=function(e,t,n,s,i){h.Z.log("Mail",["smtp","ondone"],`subject:"${t}" success:${i}`),m=!1,i?l.Z.setStatus(e,(0,d.Z)("Sent message: $1",[t]),p.QM):l.Z.setStatus(e,(0,d.Z)("Failed to send message: $1",[t])),this.quit(),i?n():s((0,d.Z)("Failed to send message: $1",[t]))},C=function(e,t,n,s){s||m?(h.Z.log("Mail",["smtp","onclose"],"Closed because of an error!"),l.Z.setStatus(e,(0,d.Z)("Failed to send message: $1",[m])),m=!1,n({message:(0,d.Z)("SMTP client closed on error")})):(h.Z.log("Mail",["smtp","onclose"],""),t())},w=function(e,t,n,s){h.Z.log("Mail",["smtp","onclose"],`[${t.MAIL_EMAIL}]${s.message}`),t.useOAuth&&(0,u.oy)(t.MAIL_EMAIL,(0,g.dn)(t)),m=!1;const i=t.MAIL_SMTP_SERVER||"",o=t.MAIL_SMTP_USER||"";l.Z.setStatus(e,(0,d.Z)("$1 - Server: $2 - User: $3",[s.message,i,o])),this.quit(),n(s)},b={send:function(e,t,n,s,i,o,a){return h.Z.log("Mail",["smtp","send"],`[${t.MAIL_EMAIL}]subject:"${n}"`),-1===t.MAIL_SMTP_PORT?(console.warn("not gonna send as the smtp port is missing"),l.Z.setStatus(e,(0,d.Z)("SMTP client not configured for sending mail")),Promise.reject()):(l.Z.setStatus(e,(0,d.Z)("Sending")),new Promise(((r,l)=>{c.Z.getSMTPClient(t).then((d=>{m=`subject: ${n||""}, from: ${t.MAIL_EMAIL}`,d.onidle=v.bind(d,t,s,i,o),d.onready=f.bind(d,a,l),d.ondone=y.bind(d,e,n,r,l),d.onerror=w.bind(d,e,t,l),d.onclose=C.bind(d,e,r,l),d.connect()})).catch((e=>l(e)))})))}};var S=n(46382),I=n(68247),k=n(29087),A=n(78347),T=n(45709),Z=n(97823),E=n(21285),_=n(61839);var M=n(68906),N=n(33956),P=n(6977),D=n(55346),x=n(93818),O=n(89846),L=n(24651),R=n(5204),B=n(30628),F=n(40382),V=n(77312),W=n(27569),U=n(89175),H=n(8684);let z=!1;async function G(e,t){t||(e.queued=!0);const n=await async function(e){const{addedSles:t,forSearchDb:n}=await(0,E.Z)(p.of,p.J8,p.fZ,[e],{filteringPriority:p.Un.HIGH});(0,_.Z)(n);const[s]=t;if(!s)throw new Error("Failed to store message in outbox folder");return s}(e);return o.Z.updateIndex({addedSles:[n]}),R.Z.filter(),s.Z.updateThreads(),n}async function $(e,t){if(!t.from||0===t.from.length)throw new Error((0,d.Z)("Can not send. No sender specified!"));const n=await Z.Z.loadAllAccountsAndAliases(),r=t.from.map((e=>e.address)),l=n.find((e=>e.MAIL_EMAIL===r[0]));if(!l)throw new Error((0,d.Z)("Can not send. No account set up for sender $1",[r[0]]));const c=Z.Z.getAccountIdForEmail(l.MAIL_EMAIL)||l.MAIL_EMAIL,u=A.Z.getFoldersOfType(c,p.Nz);let g,m,v=!1;u.length?(g=c,m=u[0].path,v=!0):(g=p.of,m=p.N1);let f=0;if(t.bodyParts?.forEach((e=>{e.fileSize?f+=e.fileSize:f+=e.content.length})),f>p.gh){const{action:t}=await S.Z.showModal(e,{modal:{title:(0,d.Z)("A Large Message in Outbox"),body:(0,d.Z)("A large message ($1MB) is about to be sent. The mail servers might not accomodate it and sending may fail.",[Number(f/1e6).toFixed(1)]),actions:[{title:(0,d.Z)("mail","Send anyway"),action:"continue"}],cancelAction:{title:(0,d.Z)("mail","Do not send"),action:"cancel",default:!0}}});if("cancel"===t)return void h.Z.log("Mail",["outbox"],"Sending of large message cancelled by user")}const y=t.bodyParts&&t.bodyParts[0];if(!y)throw new Error("No bodyPart found in message");const C=y.content;if("string"!=typeof C)throw new Error("The first bodyPart must be of type string, it is of type: "+typeof C);const w=1e3*Math.floor(Date.now()/1e3),E=(0,W.yN)(t.bodyParts),_=await a.Z.build({...t,sentDate:w},C,E),{id:D,subject:B,to:H,cc:z,bcc:G}=t;await b.send(e,l,B,H,z,G||[],_);const $={searchList:{sentDate:w},messages:{sentDate:w},threading:{sentDate:w}},K={searchList:["queued"]};v&&(await(0,F.Z)(c,w,t.id,_),await L.Z.setHasRaw(c,t.id),K.messages=["bodyParts"],await(0,V.fN)(D));const j={addedProperties:$,removedProperties:K,filteringPriority:p.Un.HIGH},{sleUpdate:Y}=await(0,O.Z)(t.id,p.of,p.J8,g,m,j);g!==p.of&&M.Z.call({type:"FILTERS_SLES",priority:p.Un.HIGH,searchListIds:[t.id],folderIds:[[p.of,p.N1]]}),await(0,N.Z)([t.id]),o.Z.updateIndex({sleUpdates:[Y]}),R.Z.filter(),I.Z.set(U.kMailLastSentFrom,l.MAIL_EMAIL),v&&l.accountType===p.s9.IMAP&&(l.uploadSent??1)?(await P.Z.addUpload([{accountId:c,path:m,searchListId:t.id,flags:[p.T4.SEEN]}]),s.Z.flushBuffer()):l.accountType===p.s9.IMAP&&(l.uploadSent??1)&&console.warn("No sent folder found for account",c);const X=t.forwarded||t.replied;if(void 0!==X){const e=await(0,x.Z)(X);if(!e)return void console.warn(`Referenced message with id ${X} not found`);const n=t.forwarded?T.Z.setForwarded([e],!0):T.Z.setReplied([e],!0);o.Z.updateIndex({sleUpdates:n})}k.Z.get(U.kMailAutoGenerateContacts)&&i.Z.addIfNotAddressExists(t.to)}async function K(e,t,n){if(0===t.length)return void l.Z.setStatus(e,(0,d.Z)("No messages to send"),2e3);if(z)return;z=!0;let s=0,i=0;const o=r.Z.getByFolder(p.of,p.J8);if(o){l.Z.setStatus(e,(0,d.Z)("Preparing to send $1 messages",[t.length]),2e3);try{for(const a of t){const t=a.sources.get(o.id);if(t&&!t.deleted&&(n||!a.queued)){const t=await D.Z.call(a.id);if(t)try{await $(e,t),++s}catch(e){++i,h.Z.error("Mail",["outbox"],"Failed to send:",e.message||e)}}}if(s+i>0){const t=[];s>0&&t.push((0,d.Z)("$1 message successfully sent","$1 messages successfully sent",[s])),i>0&&t.push((0,d.Z)("Failed to send $1 message","Failed to send $1 messages",[i])),(i>0||k.Z.get(U.kMailNotifications)&&k.Z.get(U.kMailNotificationsOnSuccessfullySent))&&(0,H.c)({title:(0,d.Z)("Sending mail"),body:t.join("\n"),icon:"resources/mail_notification_icon.png",timeout:3e4,tag:"VIVALDI_MAIL_OUTBOX_SENT_MESSAGES"}),l.Z.setStatus(e,t.join(" ")),h.Z.info("Mail",["outbox"],t.join(" "))}}catch(e){console.error(e)}finally{z=!1}}else console.error("Outbox filter missing!")}const j={sendAll:function(e,t=!0){B.Z.m3GetAll().then((n=>K(e,n,t)))},sendExternalMessage:async function(e,t,n=!0){const s=await G(t,n);n&&j.sendSelected(e,[s])},sendForAccount:function(e,t){B.Z.m3GetAll().then((n=>K(e,n.filter((e=>e.from&&e.from[0]&&e.from[0].address===t)),!0)))},sendSelected:function(e,t){K(e,t,!0)},storeMessage:G},Y=j},70611:(e,t,n)=>{"use strict";n.d(t,{yy:()=>r,iT:()=>o});n(20244);var s=n(56371);var i=n(97781);async function o(e){let t;if(function(e){const t=(new DOMParser).parseFromString(e,"text/html");return Boolean(t.body&&Array.from(t.body.getElementsByTagName("*")).every((e=>e instanceof HTMLDivElement||e instanceof HTMLSpanElement||e instanceof HTMLBRElement)))}(e)){const n=document.createElement("iframe");n.setAttribute("style","position:fixed; z-index:-1"),document.body&&document.body.appendChild(n);const s=n.contentDocument.body;s?(s.innerHTML=e,t=await function(e){let t="";const n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT);let s,i=n.nextNode();for(;i;)"BR"===i.nodeName?("DIV"!==i.parentNode?.nodeName||i.parentNode?.firstChild!==i&&i.parentNode?.lastChild!==i)&&(t+="\n"):i.nodeType===Node.TEXT_NODE?("DIV"!==s?.parentNode?.nodeName||i.parentNode===s||"BR"===s?.nodeName&&s.parentNode===i.parentNode||(t+="\n"),t+=i.nodeValue):"DIV"===i.nodeName&&s&&(t+="\n"),s=i,i=n.nextNode();return t}(s)):console.warn("Could not get plain text because iframe could not be made"),n.remove()}return t?a(t):void 0}function a(e){return e.replace(/\u00A0/g," ")}function r(e){const t=document.createElement("iframe");t.setAttribute("style","position:fixed; z-index:-1"),document.body&&document.body.appendChild(t);const n=t.contentDocument.body;let o="";if(n){const{sanitized:t}=(0,i.Nw)(e,{blockHTTPLeaks:!0});n.innerHTML=t,n.innerText&&(n.querySelectorAll("a").forEach((e=>{""===e.href.trim()||((e.parentElement||e).innerText||"").includes(e.href)||e.after(document.createTextNode(` <${e.href}> `))})),n.querySelectorAll("img").forEach((e=>{e.height&&e.height<=1&&e.width&&e.width<=1||(e.hasAttribute("alt")?""!==e.alt&&e.alt.trim().length>=1&&!(n.innerText||"").includes(e.alt)&&e.after(document.createTextNode(` [${e.alt.trim()}] `)):e.after(document.createTextNode(" ["+(0,s.Z)("Unlabeled Image")+"]")))}))),o=n.innerText||""}else console.warn("Could not get innerText because iframe could not be made");return t.remove(),a(o.trim())}},10124:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var s=n(7064);async function i(e){const t=["attached-pending"];try{const n=await s.Z.mailPrivate.readMessageFileToBuffer(t,e);return new Uint8Array(n)}catch(t){throw new Error(`Failed to read attachment buffer (${e}) from disk: ${t}`)}}},40348:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var s=n(7064);async function i(e){const t=await s.Z.mailPrivate.readFileToBuffer(e);return new Uint8Array(t)}},67103:(e,t,n)=>{"use strict";n.d(t,{Z:()=>S});var s=n(58537),i=n(99827),o=n(98611),a=n(78347),r=n(71320),l=n(45709),d=n(10671),c=n(97823),h=n(48868),p=n(42228);const u=async function(e){const t=await(0,p.Z)(e),n=[];return await h.Z.searchList.where("id").anyOf([...e.keys()]).modify((s=>{const{id:i,sourceFilterIds:o,sources:a}=s,r=e.get(i),l={sourceFilterIds:[],sources:new Map};r&&r.forEach(((e,s)=>{if(!t.has(s))throw new Error("Can not add a source for a non-existing filter ID "+s);o.includes(s)||(o.push(s),l.sourceFilterIds.push(s)),a.has(s)||(a.set(s,{...e}),l.sources.set(s,{...e})),(l.sourceFilterIds.length>0||l.sources.size>0)&&n.push({id:i,updates:l})}))})),n};var g=n(68906),m=n(6977),v=n(35489),f=n(9467),y=n(93789),C=n(5204),w=n(51501),b=n(5863);const S=async function(e,t){const n=[],h=[],p=[],S=[],I=[],k=new Map,A=[];for(const t of e){const{sources:e}=t;e.forEach(((e,s)=>{const{accountId:i,path:a}=o.Z.get(s),r=d.Z.getFolderType(i,a);i===b.u4?I.push({sourceFilterId:s,listEntry:t}):r===b.uT?e.internal?n.push({sourceFilterId:s,listEntry:t}):h.push({sourceFilterId:s,listEntry:t}):e.internal?p.push({sourceFilterId:s,listEntry:t}):e.deleted&&S.push({sourceFilterId:s,listEntry:t})}))}const T=new Map;if(p.length>0){const e=await c.Z.loadAllAccounts(),n=[],s=[],i=[];for(const o of p){const{sourceFilterId:a,listEntry:l}=o,{id:c,unseen:h,flags:p,sources:u}=l,g=r.Z.get(a),{accountId:m,path:f}=g,y=e.find((e=>e.MAIL_EMAIL===m));if(!y){console.warn("Account not found for accountId "+m);continue}if(y.accountType===b.s9.IMAP){let e=!1;for(const[n,o]of u){if(o.internal||n===a)continue;const l=r.Z.get(n);if(!l||l.accountId!==m)continue;const{path:d}=l;t?.has(c)&&i.push([m,d,c]),s.push({accountId:m,path:d,destinationPath:f,searchListId:c}),e=!0;break}if(!e){(await v.Z.getBySearchListId(c)).some((e=>e.hasRaw))&&n.push({accountId:m,path:f,searchListId:c,flags:p})}}let C=T.get(c);C||(C={id:c,unseen:h,flags:p,sources:u},T.set(c,C));const w=!d.Z.isOnline(m,f),S={read:!t?.has(c)&&!!u.get(a)?.read,internal:w,deleted:!1};let I=k.get(c);I?I.set(a,S):(I=new Map([[a,S]]),k.set(c,I))}if(i.length>0){const e={[b.T4.SEEN]:!1};await m.Z.addCustomFlagsImapKeys(i,e)}s.length>0&&await m.Z.addCopy(s),n.length>0&&await m.Z.addUpload(n)}function Z(e){const{sourceFilterId:n,listEntry:s}=e,{id:i,unseen:o,flags:a,sources:r}=s;let l=T.get(i);l||(l={id:i,unseen:o,flags:a,sources:r},T.set(i,l));const d={read:!t?.has(i)&&!!r.get(n)?.read,deleted:!1};let c=k.get(i);c?c.set(n,d):(c=new Map([[n,d]]),k.set(i,c))}if(S.length>0){const e=new Map;for(const t of S){Z(t);const{sourceFilterId:n,listEntry:s}=t,{id:i}=s,o=e.get(n);o?o.push(i):e.set(n,[i])}for(const[t,n]of e){const e=o.Z.get(t);if(!e)throw new Error("Filter not found, id "+t);const{accountId:s,path:i}=e;await f.Z.deleteImapEntries(s,i,n)}}for(const e of I)Z(e);if(T.size>0){const e=l.Z.setCustomFlags([...T.values()],{[b.T4.SEEN]:!1},k,!1);A.push(...e)}const E=new Map;function _(e,t,n){const s=E.get(e);s?s.set(t,n):E.set(e,new Map([[t,n]]))}const M=new Map;function N(e,t){const n=M.get(e);n?n.push(t):M.set(e,[t])}if(h.length>0){const e=[],n=[],i=[];for(const s of h){const{sourceFilterId:o,listEntry:l}=s,{id:d,sourceFilterIds:c,sources:h}=l,p=r.Z.getByIds(c),u=p.find((e=>e.id===o)),g=p.filter((e=>e.accountId===u.accountId)),{accountId:m,path:v}=u;if(1===g.length){const n=a.Z.getFoldersOfType(m,b.e9)[0];if(!n)throw new Error("Can not undelete, an inbox folder was not found for "+m);const{path:s}=n;t?.has(d)&&i.push([m,v,d]),e.push({accountId:m,path:v,destinationPath:s,searchListId:d});const l=r.Z.getByFolderId([m,s]),c=!t?.has(d)&&!!h.get(o)?.read;_(d,l.id,{read:c,deleted:!1,internal:!0})}else n.push({accountId:m,path:v,searchListId:d});N(d,o)}const o=await u(E);A.push(...o);const l=new w.R;for(const{id:e,updates:t}of o){const{sourceFilterIds:n}=t;n&&l.add(n,e)}for(const{filterIds:e,searchListIds:t}of l.batches)g.Z.call({type:"FILTERS_SLES",priority:b.Un.NORMAL,filterIds:[...e],searchListIds:t});if(i.length>0){const e={[b.T4.SEEN]:!1};await m.Z.addCustomFlagsImapKeys(i,e)}e.length>0&&await m.Z.addMove(e),n.length>0&&await m.Z.addDelete(n),s.Z.flushBuffer()}if(n.length>0){const e=new Map;for(const t of n){const{listEntry:n,sourceFilterId:s}=t,{id:i}=n;N(i,s);const o=e.get(s);o?o.push(i):e.set(s,[i])}for(const[t,n]of e){const e=o.Z.get(t);if(!e)throw new Error("Filter not found, id "+t);const{accountId:s,path:i}=e;await f.Z.uploadEntries(s,i,new Set(n)),await f.Z.copyAndMoveEntries(s,i,n)}}if(M.size>0){const e=[];M.forEach(((t,n)=>{const s=e.find((e=>e.filterIds.size===t.length&&t.every((t=>e.filterIds.has(t)))));s?s.searchListIds.push(n):e.push({filterIds:new Set(t),searchListIds:[n]})}));for(const{searchListIds:t,filterIds:n}of e){const e=[...n],{sleUpdates:s}=await y.Z.call(t,e);A.push(...s);const i=new Map(e.map((e=>[e,void 0])));g.Z.call({type:"UPDATE_SLE",priority:b.Un.HIGH,searchListIds:t,sources:i})}}A.length>0&&i.Z.updateIndex({sleUpdates:A}),C.Z.filter()}},18787:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});const s=new class{buffer=[];maxSize=200;clear(){this.buffer=[],this.maxSize=200}push(e){this.buffer.length===this.maxSize&&this.buffer.shift(),this.buffer.push(e)}pop(){return this.buffer.pop()}removeEntries(e){this.buffer.forEach((t=>{switch(t.operation){case"setFlags":t.updateItems=t.updateItems.filter((t=>!e.has(t.id)));break;case"delete":t.listEntries=t.listEntries.filter((t=>!e.has(t.id)))}}))}}},17776:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var s=n(7064);async function i(e){const t=["attached-pending"],n=crypto.randomUUID();try{return await s.Z.mailPrivate.writeBufferToMessageFile(t,n,e),n}catch(e){throw new Error(`Failed to write attachment buffer (${n}) to disk: ${e}`)}}},40382:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var s=n(26067),i=n(92292),o=n(7064);function a(e,t,n,a){return r=a,l=(0,s.Z)(e,t,n),new Promise(((e,t)=>{const{pathArray:n,fileName:s}=l;o.Z.mailPrivate.writeTextToMessageFile(n,s,r,!1,(()=>{i.Z.runtime.lastError&&t({lastError:i.Z.runtime.lastError,pathArray:n,fileName:s}),e()}))})).catch((e=>{console.warn("writeToDisk %o",e)}));var r,l}},94283:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});const s=(0,n(67294).createContext)(window)},80225:(e,t,n)=>{"use strict";n.d(t,{T$:()=>w,aT:()=>v});var s=n(22616),i=n(62882),o=n(56371),a=n(92292),r=n(2497),l=n(7064),d=n(8684);const c="----",h=new RegExp("^(\ufeff)?----$"),p=new RegExp(`.(${["md","markdown","txt"].join("|")})$`,"i"),u=(e,t,n="")=>{const i=""===n?t:`${t}: ${n}`;"import"===e&&s.Z.addImportError("Notes Folder","Notes",i),console.error(`Notes ${e}: ${i}`)},g=(e,t,n)=>{const{title:s="",content:i="",url:o="",dateAdded:a=0,id:r}=n,l=[];if(""!==s&&l.push(`title: ${s}`),""!==o&&l.push(`url: ${o}`),a>0){const e=new Date(a).toISOString();l.push(`date: ${e}`)}const d=l.length>0?`----\n${l.join("\n")}\n----\n\n${i}\n`:`${i}\n`,c=new Blob([d]),h=`${(s||i).split("\n")[0].replace(/[/\\?%*:|"<>]/g,"_").trim().substring(0,24)}_${n.id}.md`;e.chrome.fileSystem.getWritableEntry(t,(e=>{e.getFile(h,{create:!0},(e=>{e.createWriter((e=>{let t=!1;e.onwriteend=function(e){if(!t)return t=!0,void this.truncate(c.size)},e.onerror=function(e){u("export",`Failed to export note ID "${r}"`,e.stack)},e.write(c)}))}))}))},m=(e,t,n,s)=>{s>=100?u("export","Exceeded folder recursion depth limit (100)."):n.forEach((n=>{if("folder"===n.type&&n.children&&n.children.length>0){const{title:i,id:o,children:a}=n,r=`${(i||o).split("\n")[0].replace(/[/\\?%*:|"<>]/g,"_").trim().substring(0,24)}`;e.chrome.fileSystem.getWritableEntry(t,(t=>{t.getDirectory(r,{create:!0},(t=>{m(e,t,a,s+1)}))}))}else"note"===n.type&&g(e,t,n)}))},v=e=>{const t=(0,r.Z)(e),n=i.ZP.getFilteredTree("",{inTrash:!1}).nodes;f(t,(e=>{if(!e)return void u("export","Could not read or write from the selected folder.");const s=[{title:(0,o.Z)("Vivaldi Notes"),type:"folder",id:"-1",children:n}];m(t,e,s,0),(0,d.c)({title:(0,o.Z)("Finished Exporting Notes"),tag:"VIVALDI_NOTES_EXPORT_DONE"})}))},f=(e,t)=>new Promise((n=>{e.chrome.fileSystem.chooseEntry({type:"openDirectory"},(e=>{const s=a.Z.runtime.lastError;s?(u("import","Folder selector problem",s.message),n()):n(t(e))}))})),y=(e,t)=>{t.file((n=>{const s=new FileReader;s.onerror=e=>{const n=e.currentTarget.error.message;u("import",`Failed to read file "${t.name}"`,n)},s.onload=i=>{const o=s.result;if(!o)return;const{headers:a,body:r}=(e=>{const t=e.split("\n"),n={};let s=0;for(let e=0;e<t.length&&!(e>=200);e++){const i=t[e];if(0===e){if(h.test(i))continue;break}if(/^(\w|-)+:\s*.+/i.test(i)){const e=i.match(/^(?<headerKey>(\w|-)+):\s*(?<headerValue>.+)/i);if(e&&e.groups){const t="created"===e.groups.headerKey?"date":e.groups.headerKey,s=e.groups.headerValue;["date","title","url"].includes(t)&&(n[t]=s)}}else{if(i===c){s=e+1,""===t[s+1]&&s++;break}if(""!==i)break}}return{headers:n,body:t.slice(s).join("\n").trim()}})(o);if(r){const s={parentId:e.toString(),type:"note",title:a.title||t.name.replace(/\.[^.]+$/,"")||"",url:a.url||"",content:r,date:n.lastModified};if(a.date){const e=Date.parse(a.date);!isNaN(e)&&e>0&&(s.date=e)}l.Z.notes.create(s)}},s.readAsText(n)}),(e=>{u("import",`Failed to read file "${t.name}"`,e.stack)}))},C=(e,t,n)=>{if(!e)return void u("import","Could not read from the selected folder.");if(n>=100)return void u("import","Exceeded folder recursion depth limit (100).");e.createReader().readEntries((function(e){e.filter((e=>!e.name.startsWith(".")&&(e.isDirectory||e.isFile&&p.test(e.name)))).forEach((e=>{e.isDirectory?l.Z.notes.create({parentId:t.toString(),type:"folder",title:e.name}).then((t=>C(e,Number(t.id),n+1))):e.isFile&&y(t,e)}))}))},w=e=>{const t=(0,r.Z)(e);return f(t,(e=>{l.Z.notes.beginImport(),s.Z.setImportProgress("Notes Folder","Notes",0,1),C(e,Number(i.R0),0)})).then((()=>s.Z.setImportProgress("Notes Folder","Notes",1,1))).finally((()=>l.Z.notes.endImport()))}},10334:(e,t,n)=>{"use strict";n.d(t,{UL:()=>G,g2:()=>Me,v$:()=>K,a5:()=>$,te:()=>z,Ff:()=>j,hT:()=>J,Xz:()=>ge,hm:()=>re,oE:()=>ve,CD:()=>de,$J:()=>ee,S4:()=>Ae,IZ:()=>we,sh:()=>ke,Dj:()=>Ce,JC:()=>ye,nX:()=>pe,pN:()=>he,jn:()=>ae,s1:()=>ue,xh:()=>fe,Kk:()=>be,JQ:()=>ce,Lm:()=>le,ue:()=>te,Jg:()=>oe,Gr:()=>Se,vD:()=>Q,fX:()=>Te,de:()=>me,Xf:()=>Ee,lp:()=>ie,Fm:()=>se,hV:()=>Ie,AE:()=>q});var s=n(27770),i=n(59486),o=n(56284),a=n(15544),r=n(31186),l=n(62882),d=n(53576),c=n(96951),h=n(29087),p=n(80342),u=n(39206),g=n(63365),m=n(53454),v=n(56371),f=n(92292),y=n(45454),C=n(26036),w=n(36246);const b=(0,C.Z)("keyword zoom","reset"),S=(e,t,n)=>t.every((t=>{const s=e.label.toLowerCase(),i=e.labelEnglish.toLowerCase();return n?s.includes(t)||i.includes(t):s.includes(t)}));function I(e,t,n){const s=e.trim().toLowerCase().split(" ").filter(Boolean),i=t.filter((e=>function(e,t,n){return((e,t,n)=>{const{keyword:s}=e;if(!s)return;const{validity:i}=s;let o=!1,a=!1,r=t.find((e=>{let t=!1;return o=n&&e===b.labelEnglish||e===b.label,i&&(t=i.test(e)),isNaN(e)||(a=!0),o||a||t}));const l=t.filter((e=>!e.includes(String(r))));if(l.length&&S(e,l,n)){const{min:t,max:n,type:i,defaultValue:l}=s;return o?Object.assign(e,{foundKeyword:!0},{paramValue:l}):("number"==typeof r||a?r=(0,w.Z)(r,t,n):"mixed"===i&&(r=r?{keyword:s,param:r}:void 0),Object.assign(e,{paramValue:r},{foundKeyword:Boolean(r)}))}})(e,t,n)||S(e,t,n)}(e,s,n)));return i}var k=n(7064),A=n(5422),T=n(75968),Z=n(36436),E=n(29489),_=n(30330),M=n(47380),N=n(60339),P=n(721),D=n(89175),x=n(86088),O=n(13302),L=n(44850);const R={"⁰":"0","¹":"1","²":"2","³":"3","⁴":"4","⁵":"5","⁶":"6","⁷":"7","⁸":"8","⁹":"9"},B=(0,v.Z)("textselection","selection"),F=(0,v.Z)("pageurl","page url"),V=(0,v.Z)("websitelink","link url"),W=(0,v.Z)("webpagetitle","page title"),U=(0,v.Z)("elementsource","src url"),H=e=>(e=`{${e=e.replace(/\s+/g,"_")}}`,{regex:new RegExp(e,"gi"),description:e}),z=H(B),G=H(V),$=H(F),K=H(W),j=H(U),Y=20,X=new T._b,Q=(e,t)=>{const n=(0,P.mT)(t),s=(0,P.Mr)(t),i=(0,y.Z)(e,t),o=h.Z.get(D.kQuickCommandsOpenUrlInNewTab);return n?(i.inCurrent=!1,i.inBackground=!0):s&&o?i.inCurrent=!0:o&&(i.inCurrent=!1,i.inBackground=!1),i},q=e=>{if("number"==typeof e||!isNaN(e)){const{min:t,max:n}=(0,_.xU)("COMMAND_TAB_PERIODIC_RELOAD");return(0,w.Z)(Number(e),t,n)}const{param:t}=e,{min:n,max:s,validity:i}=e.keyword,o=i.exec(t).groups,a=o.min||0,r=o.sec1||o.sec2||0,l=60*parseInt(a)+parseInt(r);return(0,w.Z)(l,n,s)};async function J(e,t){const n=(await a.Z.getVivDefinedCommands()).map((e=>{const t=(0,_.xU)(e.name);return{...e,...t&&{keyword:t}}})).concat(A.Y);for(const s of t){const{key:t,param:i}=s,o=n.find((e=>e.guid.includes(t)));if(!o){console.error(`chainedCommandExecution: Command ${t} not found`);break}const{action:a,keyword:r}=o;let l;if(r){const t=r.defaultValue;switch(l=void 0!==i?i:t,typeof l!==r.type&&"mixed"!==r.type&&"3a8efd62-4c8a-4545-8a6c-9cb65518f507"!==o.guid&&(l=r.defaultValue),typeof l){case"string":l=l.length?l.replace(z.regex,e.menuData?e.menuData.selection:"").replace(G.regex,e.menuData?e.menuData.linkurl:"").replace($.regex,e.menuData?e.menuData.pageurl:"").replace(K.regex,e.menuData?e.menuData.pagetitle:"").replace(j.regex,e.menuData?e.menuData.srcurl:""):r.defaultValue;break;case"number":l=(0,w.Z)(l,r.min,r.max)}}delete e.param,l&&(e.param=l),await a(e)}}const ee=(e,t)=>{const{searchText:n,chains:s,shortcuts:i}=t,o=n.toLowerCase().split(" "),a=h.Z.get(D.kQuickCommandsLimitResults),r=h.Z.get(D.kQuickCommandsSearchPriority),l=(0,M.m)("qc",e);let d=s.filter((e=>o.every((t=>e.label.toLowerCase().includes(t)&&e.chain.length)))).map((e=>{const{chain:t,key:n,label:s,name:o}=e,a=i.find((e=>e.name===o));return{name:s,id:n,meta:a&&a.shortcuts?.length?a.shortcuts[0]:"",type:"commandChain",selectPriority:r.indexOf("COMMAND_CHAIN"),action:()=>J(l,t)}}));return a&&(d=d.slice(0,Y)),ne({title:(0,v.Z)("Command Chains"),array:d})};function te(e,t){const n=e.toLowerCase(),s=t.toLowerCase();return n.indexOf(s)}function ne(e){const{title:t,array:n,subtitle:s}=e;return n.length?(n.unshift({name:t,type:"title",subtitle:s??null,count:n.length}),n):[]}function se(e,t){return h.Z.get(D.kQuickCommandsSearchEnglish)?!0===(t.regex.test(e)||t.regexSearchEnglish.test(e)):t.regex.test(e)}function ie(e){const{label:t,initialPart:n="",endingPart:s=""}=e;return`${n}${`${t.substring(0,2)}?`}${`${t.split("").slice(2).join("?")}?`}${s}`}function oe(e,t){const n=h.Z.get(D.kQuickCommandsSearchPriority).length,{selectPriority:s=n}=e;return{priority:s,selectIndex:t}}function ae(e){const{initialPart:t,endingPart:n}=e,{label:s,labelEnglish:i}=e.labelPair,o=ie({label:s,initialPart:t,endingPart:n}),a=ie({label:i,initialPart:t,endingPart:n});return{regex:new RegExp(o,"i"),regexSearchEnglish:new RegExp(a,"i")}}function re(e){const t=i.ZP.getNicknamed(e,!1).map((e=>{const{url:t=""}=e;return{folderId:e.children?e.id:void 0,type:"bookmarkNick",name:e.title,url:e.children?void 0:t,selectPriority:-1,nickname:e.nickname,faviconUrl:e.children?x._TQ.small:L.jk.getFavicon(t)}}));return ne({title:(0,v.Z)("Nickname Match"),array:t})}function le(e){const t=e?p.Z.getFilter(e):[],n=h.Z.get(D.kQuickCommandsSearchPriority),s=t.map((e=>({type:"readingList",name:e.title,selectPriority:n.indexOf("READING_LIST"),url:e.url,faviconUrl:L.jk.getFavicon(e.url),read:e.read})));return ne({title:(0,v.Z)("Reading List"),array:s})}function de(e){const t=e.replace(/,/g,".").replace(/x/gi,"*").replace(/×/g,"*").replace(/÷/g,"/").replace(/−/g,"-").replace(/√/g,"sqrt").replace(/([^\s])([⁰¹²³⁴⁵⁶⁷⁸⁹]+)/gu,"$1 ^ $2 ").replace(/[⁰¹²³⁴⁵⁶⁷⁸⁹]/gu,(e=>R[e]));if(!t)return[];let n;try{n=X.evaluate(t)}catch(e){}if(void 0===n||"function"==typeof n)return[];let s=n;const i=`${String.fromCharCode(8722)}0`,o=`${String.fromCharCode(45)}0`,a=h.Z.get(D.kQuickCommandsSearchPriority);s!==i&&s!==o||(s="0");return[{name:s.toString(),searchString:e,selectPriority:a.indexOf("CALCULATOR"),type:"calculator"}]}function ce(e){const t=e.toLowerCase().split(" "),n=h.Z.get(D.kQuickCommandsSearchPriority).indexOf("OPEN_TABS"),s=h.Z.get(D.kWorkspacesEnabled),i=c.ZP.filterPagesInAllWindows((e=>Ze(e.title,e.url,t))).toArray().map((e=>{const{url:t,id:i}=e;return{name:L.jk.getDisplayTitle(e),url:(0,Z.xl)(t)?"":t,type:"openTab",selectPriority:n,pageId:i,windowId:e.windowId,pageUrlForFavicon:t,faviconUrl:L.jk.getFavicon(t),workspaceId:s?e.vivExtData.workspaceId:void 0}}));return ne({title:(0,v.Z)("Tabs"),array:i})}async function he(){return k.Z.extensionActionUtils.getToolbarExtensions()}function pe(e,t){const n=h.Z.get(D.kQuickCommandsSearchPriority),s=h.Z.get(D.kQuickCommandsLimitResults),i=e.toLowerCase().split(" ");let o=t.filter((e=>{const t=e.name?.toLowerCase();return i.every((e=>t?.includes(e)))})).map((e=>{const t=e.enabled?e.badgeIcon:x.N_W;return{name:e.name,faviconUrl:t,id:e.id,type:"extension",enabled:e.enabled,optionsUrl:e.optionspage,selectPriority:n.indexOf("EXTENSIONS")}}));s&&(o=o.slice(0,Y));const a=(0,O.$)("ctrl");return ne({title:(0,v.Z)("Extensions"),array:o,subtitle:(0,v.Z)("Open Options Page with $1",[a])})}function ue(e){const t=h.Z.get(D.kQuickCommandsSearchPriority),n=h.Z.get(D.kQuickCommandsLimitResults),{searchText:s,today:i}=e;let o=r.Z.getFilteredHistory(s,i).map((e=>{const{url:n,title:s,lastVisitTime:i,visitCount:o,visitTime:a}=e;return{type:"history",faviconUrl:L.jk.getFavicon(n),selectPriority:t.indexOf("HISTORY"),url:n,name:s,visitTime:i||a,visitCount:o}}));return n&&(o=o.slice(0,Y)),ne({title:(0,v.Z)("History"),array:o})}function ge(e){const t=h.Z.get(D.kQuickCommandsSearchPriority),n=h.Z.get(D.kQuickCommandsLimitResults),s=e.toLowerCase();let o=i.ZP.getFilteredFlat(s,{bookmarks:!1,folders:!0,inTrash:!1}).filter((e=>e.nickname.toLowerCase()!==s)).map((e=>({folderId:e.id,type:"bookmarkFolder",name:e.title,selectPriority:t.indexOf("BOOKMARK_ITEM_OR_FOLDER"),nickname:e.nickname,faviconUrl:x._TQ.small})));return n&&(o=o.slice(0,Y)),ne({title:(0,v.Z)("Open All Bookmarks in Folder"),array:o})}async function me(e,t){const{id:n,enabled:s,optionsPage:i,optionsUrl:o}=t;s||await f.Z.management.setEnabled(n,!0),i&&o.length?d.ZP.openURL(e,o,{inCurrent:!i}):Me.emitChange(n)}function ve(e){const t=h.Z.get(D.kQuickCommandsSearchPriority),n=h.Z.get(D.kQuickCommandsLimitResults),s=e.toLowerCase();let o=i.ZP.getFilteredFlat(s,{bookmarks:!0,folders:!1,inTrash:!1}).filter((e=>e.nickname.toLowerCase()!==s&&i.ZP.isBookmark(e))).map((e=>{const{url:n="",nickname:s,title:i}=e;return{type:"bookmark",name:i,url:n,selectPriority:t.indexOf("BOOKMARK_ITEM_OR_FOLDER"),nickname:s,faviconUrl:L.jk.getFavicon(n)}}));return n&&(o=o.slice(0,Y)),ne({title:(0,v.Z)("Bookmarks"),array:o})}function fe(e){const t=e.split(" ")[0],n=u.Z.getByKeyword(t);if(!n)return[];const s=e.substring(t.length).trim();return[{name:(0,v.Z)("Keyword Search “$1” on $2",[s,n.name]),nickname:n.keyword,type:"keywordSearch",faviconUrl:n.faviconUrl,selectPriority:-1,searchQuery:e}]}function ye(e,t){const n=h.Z.get(D.kQuickCommandsSearchPriority);return{name:(0,v.Z)("Search “$1” on $2",[e,t?.name]),type:"search",faviconUrl:t?t.faviconUrl:"",selectPriority:n.indexOf("KEYWORD_SEARCH"),searchQuery:e}}function Ce(e){return e.length<4?[]:[{name:(0,v.Z)("Create Note “$1”",[e]),type:"noteAdd",value:e}]}function we(e,t){const n=a.Z.getQuickCommands(e).map((e=>{const t=(0,_.xU)(e.name);return{...e,foundKeyword:!1,...t&&{keyword:t}}})),s=h.Z.get(D.kQuickCommandsSearchEnglish),i=I(t,n,s).map((e=>{const t=a.Z.getCommandConfiguration(e.name),{label:n,foundKeyword:i,keyword:o,paramValue:r,labelEnglish:l}=e;let d=n;const c=r&&i?r:void 0;o&&(d=i?(0,v.Z)("Run $1",[n]):n+" #");const p=h.Z.get(D.kQuickCommandsSearchPriority);return{name:d,type:o?"commandKeyword":"command",meta:t?.shortcuts?t.shortcuts[0]:"",commandName:e.name,searchString:n,selectPriority:i?-1:p.indexOf("NORMAL_COMMAND"),value:c,...s&&{labelEnglish:l}}}));return ne({title:(0,v.Z)("Commands"),array:i})}function be(e){const t=h.Z.get(D.kQuickCommandsSearchPriority),n=h.Z.get(D.kQuickCommandsLimitResults);let s=l.ZP.getFilteredFlat(e,{inTrash:!1}).map((e=>{const{id:n,title:s,children:i,content:o,url:a,type:r}=e,l="note"===r&&i&&i.length>0;return{type:"note",id:n,url:a||"",name:s||o||"",isFolder:void 0!==i?.length&&"note"!==r,selectPriority:t.indexOf("NOTES_SEARCH"),nickname:s&&o?o:"",hasAttachment:l}}));return n&&(s=s.slice(0,Y)),ne({title:(0,v.Z)("Notes"),array:s})}function Se(e){const t=(0,Z.q9)(e);if(!(0,Z.C3)(e)&&!(0,Z.xl)(e)||!t.length)return[];const n=h.Z.get(D.kQuickCommandsSearchPriority),s={name:t,type:"url",selectPriority:(0,Z.Zj)(e)?n.indexOf("KEYWORD_SEARCH")-1:-1,pageUrlForFavicon:t,faviconUrl:L.jk.getFavicon(t)};return ne({title:t.toLowerCase().startsWith("javascript:")?(0,v.Z)("Execute"):(0,v.Z)("Go to Address"),array:[s]})}async function Ie(e,t){const n=i.ZP.getItemById(t);if(n&&i.ZP.isFolder(n)){const t=s.ZP.getBookmarksByNode(n),i={inCurrent:!h.Z.get(D.kBookmarksOpenInNewTab),inBackground:!1,inNewWindow:!1,allowOverride:!1,incognito:!1};s.ZP.open(e,t,i,!0)}}function ke(e,t){const n=e.toLowerCase().split(" "),s=h.Z.get(D.kQuickCommandsSearchPriority),i=t.filter((e=>n.every((t=>(0,E.gD)(e).toLowerCase().includes(t))))).map((e=>({type:"contentScript",selectPriority:s.indexOf("PAGE_ACTIONS"),script:e,name:(0,E.gD)(e)})));return ne({title:(0,v.Z)("Page Actions"),array:i})}function Ae(e){const t=h.Z.get(D.kQuickCommandsSearchPriority),n=h.Z.get(D.kQuickCommandsLimitResults),s=e.toLowerCase().split(" ");let i=g.Z.getTrash().flatMap((e=>e.window?.tabs?e.window.tabs.flatMap((t=>({lastModified:e.lastModified,...t}))):{lastModified:e.lastModified,...e.tab})).filter((e=>Ze(e.title||"",e.url||"",s))).map((e=>{const n=e.url||"";return{name:e.title||"",url:(0,Z.xl)(n)?"":n,type:"closedTab",selectPriority:t.indexOf("CLOSED_TABS"),pageUrlForFavicon:n,faviconUrl:L.jk.getFavicon(n),command:e}}));return n&&(i=i.slice(0,Y)),ne({title:(0,v.Z)("Closed Tabs"),array:i})}function Te(e,t){const n=h.Z.get(D.kQuickCommandsSearchPriority),s=t.toLowerCase().split(" "),i=m.Z.getWorkspaces(e).flatMap((e=>s.some((t=>e.name.toLowerCase().includes(t)))?[{name:e.name,type:"workspace",selectPriority:n.indexOf("WORKSPACES"),workspaceId:e.id}]:[]));let o;return o=s.some((e=>(0,v.Z)("This Window").toLowerCase().includes(e)))?[{name:(0,v.Z)("This Window"),type:"workspace",selectPriority:n.indexOf("WORKSPACES"),workspaceId:void 0}].concat(i):i,ne({title:(0,v.Z)("Workspaces"),array:o})}function Ze(e,t,n){const s=(0,Z.xl)(t)?e:`${e} ${t}`;return n.every((e=>s.toLowerCase().includes(e)))}function Ee(e){c.ZP.getDiscardablePages(e).filter((e=>!(0,N.ZN)(e))).forEach(d.ZP.discardPage)}class _e extends o.Z{}const Me=new _e},14022:(e,t,n)=>{"use strict";n.d(t,{Z:()=>m});var s=n(19789),i=n(29087),o=n(18237),a=n(56371),r=n(30381),l=n.n(r),d=n(1407),c=n(89175);const h=s.ZP.getWeekdayFormat("LL")+" LT",p={lastWeek:h,sameElse:h},u=/^\d{4}(?:-\d{2}){2}(?:_\d{2}){3}$/;function g(e){return e===o.m8||e===o.iq}const m={getLoadingWorkspaceName:function(e){const t=o.ZP.getWorkspace(e);return t?(0,a.Z)("$1 (session)",[t.name]):(0,a.Z)("Session workspace")},getTooltipString:function(e){if(o.ZP.isTrashFolder(e.id))return(0,a.Z)("Trash");let t=e.name;return e.workspaces.length>0&&(t+="\n"+(0,a.Z)("with Workspaces:")),e.workspaces.forEach((e=>{t+=d.YV+e.name})),t},getNameString:function(e){if(o.ZP.isTrashFolder(e.id))return(0,a.Z)("Trash");if(u.test(e.name)){const t=e.name.substring(0,10)+" "+e.name.substring(11,19).split("_").join(":");return l()(t).format("LLL")}return e.name},getContentString:function(e){if(o.ZP.isTrashFolder(e.id))return"";if(e.tabs-e.quarantined>0){const t=0===e.quarantined?(0,a.Z)("$1 tab","$1 tabs",[e.tabs-e.quarantined]):(0,a.Z)("$1 tab (of $2)","$1 tabs (of $2)",[e.tabs-e.quarantined,e.tabs]),n=(0,a.Z)("$1 window","$1 windows",[e.windows]);if(0===e.workspaces.length)return(0,a.Z)("$1 in $2",[t,n]);{const s=(0,a.Z)("$1 workspace","$1 workspaces",[e.workspaces.length]);return(0,a.Z)("$1, $2 in $3",[t,s,n])}}return(0,a.Z)("All tabs are quarantined")},getDateCreateString:function(e){return o.ZP.isTrashFolder(e.id)?"":i.Z.get(c.kCalendarRelativeDates)?l()(e.createDateJS).calendar(null,p):l()(e.createDateJS).format(h)},getDateModifyString:function(e){return o.ZP.isTrashFolder(e.id)?"":i.Z.get(c.kCalendarRelativeDates)?l()(e.modifyDateJS).calendar(null,p):l()(e.modifyDateJS).format(h)},getSessionData:function(e){for(const t of e.dataTransfer.types)if(g(t))return JSON.parse(e.dataTransfer.getData(t));return[]},isSessionType:g}},66777:(e,t,n)=>{"use strict";n.d(t,{C:()=>l,j:()=>d});n(67294);var s,i=n(60203),o=n(94184),a=n.n(o);function r(e,t,n,i){s||(s="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=i;else if(a>1){for(var r=new Array(a),l=0;l<a;l++)r[l]=arguments[l+3];t.children=r}if(t&&o)for(var d in o)void 0===t[d]&&(t[d]=o[d]);else t||(t=o||{});return{$$typeof:s,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function l({children:e,text:t,className:n,label:s,leadingText:i,highlight:o}){const l=o?t.split(o.regExp).reduce(((e,t,n)=>n?e.concat([r("mark",{},n,o.matches[n-1])]).concat([t]):e.concat([t])),[]):t;return r("div",{className:a()("setting-single",n,{"setting-single--LeadingText":i})},void 0,r("label",{title:s},void 0,e,r("span",{},void 0,l)))}function d({children:e,heading:t,className:n,filter:s}){return r(i.Z,{filter:s},void 0,r("div",{className:a()("setting-group",n)},void 0,t&&r("h3",{},void 0,t),e))}},60203:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var s,i=n(67294),o=n(67074);function a(e,t,n,i){s||(s="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=i;else if(a>1){for(var r=new Array(a),l=0;l<a;l++)r[l]=arguments[l+3];t.children=r}if(t&&o)for(var d in o)void 0===t[d]&&(t[d]=o[d]);else t||(t=o||{});return{$$typeof:s,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class r extends i.PureComponent{render(){const{children:e,filter:t}=this.props;return t?Array.isArray(e)?e.map(((e,n)=>a(i.Fragment,{},n,(0,o.ZP)(e,t)))):(0,o.ZP)(e,t):e}}const l=r},67074:(e,t,n)=>{"use strict";n.d(t,{CH:()=>u,ZP:()=>g,zR:()=>h});var s,i=n(67294),o=n(74117),a=n(66777);function r(e,t,n,i){s||(s="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=i;else if(a>1){for(var r=new Array(a),l=0;l<a;l++)r[l]=arguments[l+3];t.children=r}if(t&&o)for(var d in o)void 0===t[d]&&(t[d]=o[d]);else t||(t=o||{});return{$$typeof:s,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const l=new RegExp(/[‘’]/gi),d="'";const c=function(e,t){if(!e)return[!1,e];if("string"==typeof e){const n=h(e,t);return[n,n?u(e,t):e]}if(e.type===a.C){const n=h(e.props.text,t);return[n,n?u(e,t):e]}if(!("input"!==e.type&&"textarea"!==e.type||"string"!=typeof e.props.value&&"string"!=typeof e.props.defaultValue||"radio"===e.props.type||"checkbox"===e.props.type||"password"===e.props.type)){const n=h("string"==typeof e.props.value?e.props.value:e.props.defaultValue,t);return[n,n?p(e,t):e]}if("select"===e.type){let n=!1;return i.Children.forEach(e.props.children,(e=>{e?.props.children&&"string"==typeof e?.props.children&&h(e?.props.children,t)&&(n=!0)})),[n,n?p(e,t):e]}if(n=e.props?.children,Boolean(n?.forEach||Symbol.iterator in Object(n)||Object.keys(Object(n)).length)){let n=!1;const s=i.cloneElement(e,e.props,i.Children.map(e.props.children,(e=>{const[s,i]=c(e,t);return n=n||s,[n,i]})));return[n,s]}return[!1,e];var n};function h(e,t){return e.toLowerCase().replace(l,d).includes(t.toLowerCase().replace(l,d))}const p=(e,t)=>r("div",{className:"settings-text-bubble-highlight-wrapper"},void 0,e,r("mark",{className:"settings-text-bubble-highlight"},void 0,t));const u=(e,t)=>{if(!t||!e)return e;if(e.type===a.C)return function(e,t){const n=new RegExp((0,o.Z)(t),"gi"),s=e.props.text.replace(l,d).match(n)||[];return i.cloneElement(e,{highlight:{matches:s,regExp:n}})}(e,t);if("string"!=typeof e)return e;const n=new RegExp((0,o.Z)(t),"gi"),s=e.replace(l,d),c=s.match(n)||[];return r("span",{},void 0,s.split(n).reduce(((e,t,n)=>{let s=e;return n&&(s=s.concat([r("mark",{},n,c[n-1])])),s=s.concat([t]),s}),[]))};function g(e,t){if(!t)return e;const[n,s]=c(e,t);return n?s:null}},5422:(e,t,n)=>{"use strict";n.d(t,{Y:()=>K,Z:()=>ie});var s,i=n(67294),o=n(15544),a=n(69417),r=n(29087),l=n(39206),d=n(56371),c=n(89175);function h(e,t,n,i){s||(s="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=i;else if(a>1){for(var r=new Array(a),l=0;l<a;l++)r[l]=arguments[l+3];t.children=r}if(t&&o)for(var d in o)void 0===t[d]&&(t[d]=o[d]);else t||(t=o||{});return{$$typeof:s,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const p=e=>{const t=t=>e.changeParameter(t.target.value,e.index);return h("div",{className:"ChainedCommand-Item--Parameter",title:(e=>{const{keyword:t}=e;if(!t)return null;const{max:n,min:s,defaultValue:i,type:o,unit:a}=t;return("number"===o||"mixed"===o?(0,d.Z)("Min: $1",[s])+"\n"+(0,d.Z)("Max: $1",[n])+"\n":"")+(0,d.Z)("Default: $1",[i])+"\n"+(0,d.Z)("Parameter Unit: $1",[a])})(e.originalCommand)},void 0,(()=>{const{command:n}=e;switch(n.name){case"COMMAND_SEARCH_SELECTION_WITH_CUSTOM_ENGINE":{const e=l.Z.get();return h("label",{className:"floating-label"},void 0,h("span",{},void 0,S.parameter),h("select",{onChange:t,value:n.param},void 0,e.map((e=>{const{name:t,id:n}=e;return h("option",{value:n},t,t)}))))}case"COMMAND_TOGGLE_INTERFACE_COLOR_BY_NAME":{const e=r.Z.get(c.kThemesSystem).concat(r.Z.get(c.kThemesUser));return h("label",{className:"floating-label"},void 0,h("span",{},void 0,S.parameter),h("select",{onChange:t,value:n.param},void 0,e.map((e=>{const{name:t}=e;return h("option",{},t,t)}))))}default:return h(a.Z,{label:S.parameter,type:(s=e.command.defaultValue,"string"==typeof s?"text":"number"),placeholder:String(e.command.defaultValue),value:e.command.param,onChange:e=>t(e),draggable:"true",onDragStart:e=>e.preventDefault()})}var s})())};var u=n(92571),g=n(94283),m=n(81157),v=n(10334),f=n(47380);const y=()=>{const[e,t]=(0,i.useState)(!1);return(0,i.useEffect)((()=>(t(!0),()=>{t(!1)})),[e]),e};var C;function w(e,t,n,s){C||(C="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:C,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const b=["COMMAND_OPEN_LINK_DEFAULT","COMMAND_OPEN_LINK_CURRENT","COMMAND_OPEN_LINK_BACKGROUND"],S={name:(0,d.Z)("title","Chain Name"),emptyTitle:(0,d.Z)("Add your First Command Chain"),emptyDescription:(0,d.Z)("Press the “Add” button to the left to add a new Chain."),parameter:(0,d.Z)("chainedcommand","Command Parameter")},I="ChainedCommand-Item--Over",k="vivaldi/x-oldIndex";let A=-1;const T=({windowId:e,chain:t,commands:n,removeFrom:s,chainOptions:o,changeParameter:r,addToChain:l,nameChange:c,name:h,shouldFocusSelector:C,moveItem:b,searchableStrings:S})=>{const T=y(),Z=i.useContext(g.Z),E=e=>{(0,m.ZP)(e);const{classList:t}=e.currentTarget;t?.contains("ChainedCommand-Item")&&t.add(I)},_=e=>{(0,m.ZP)(e);const{classList:t}=e.currentTarget;t?.contains(I)&&t.remove(I)};return w("div",{className:"detail"},void 0,w("div",{className:"detail-content"},void 0,w("div",{className:"setting-group"},void 0,w("div",{className:"setting-single"},void 0,w(a.Z,{label:S.name,type:"text",value:h||"",onChange:e=>c(e.target.value)}))),w("div",{className:"ChainedCommand setting-group-unlimited",onDragOver:e=>{(0,m.ZP)(e),e.dataTransfer.dropEffect="move"}},void 0,t.map(((e,i)=>{const a=o.findIndex((t=>t.key===e.key)),c=o[a],h=n[a],g={val:c?.key,position:i+1,shouldDelete:!1},v={position:i,shouldDelete:!0},f=T&&C&&i===A,y=`ChainedCommand-Item--${t.length}--${i}`;return w("div",{className:"ChainedCommand-Item",draggable:t.length>1,onClick:e=>e.preventDefault(),onDrop:e=>((e,t)=>{(0,m.ZP)(e);const n=e.dataTransfer.getData(k),s=parseInt(n);isNaN(s)||b(s,t),_(e)})(e,i),onDragStart:e=>((e,t)=>{e.dataTransfer.setData(k,t)})(e,i),onDragEnter:E,onDragLeave:_},y,w("div",{className:"ChainedCommand-Item--Title floating-label"},void 0,w("span",{className:"ChainedCommand-Item--Name"},void 0,`Command ${i+1}`),w(u.Z,{className:"ChainedCommand--Selector",placeholder:(0,d.Z)("Filter Commands"),isClearable:!0,selectedCommand:h,autoFocus:f,openMenuOnFocus:!1,isMulti:!1,commands:o,setSelectedItem:e=>{A=i+1,l({val:e.key,...v})}})),h&&void 0!==e.param&&w(p,{originalCommand:h,command:e,index:i,changeParameter:r}),w("div",{className:"ChainedCommand-Item--Controls"},void 0,w("input",{type:"button",className:"circular remove",title:(0,d.Z)("Remove Command"),disabled:1===t.length,onClick:()=>{A=-1,s(i)}}),w("input",{type:"button",className:"circular add",title:(0,d.Z)("Add Command"),onClick:()=>{A=i+1,l(g)}})))}))),w("input",{type:"button",value:(0,d.Z)("Test Chain"),onClick:()=>{(0,v.hT)((0,f.m)("qc",Z),t)}})))};var Z,E=n(76632),_=n(53576),M=n(68247),N=n(40893),P=n(60203),D=n(2699),x=n(15489),O=n(26036),L=n(14507),R=n(30330),B=n(21191),F=n(86088),V=n(93513),W=n(44850);function U(e,t,n,s){Z||(Z="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=s;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&i)for(var l in i)void 0===t[l]&&(t[l]=i[l]);else t||(t=i||{});return{$$typeof:Z,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const H=[c.kChainedCommandsCommandList,c.kChainedCommandsDeletedCommandList],z=W.jk.settingCategories,G="https://vivaldi.com",$=(0,d.Z)("Valid URL"),K=[{name:"COMMAND_CHAINED_SLEEP",action:e=>"number"==typeof e.param?new Promise((t=>setTimeout(t,e.param))):(console.error("Parameter to action is not a number",e.param),Promise.resolve()),category:"CATEGORY_COMMAND_APPLICATION",showInQC:!1,isEnabled:()=>!0,isVisible:()=>!0,keyword:{type:"number",defaultValue:1e3,unit:(0,d.Z)("Milliseconds"),min:1,max:3e4},guid:"2eb81004-6703-46db-9933-6afcfde924e4",...(0,O.Z)("command","Delay")},{name:b[0],action:async e=>{const t="string"==typeof e.param?e.param:"";return await _.ZP.openURL(e.windowId,t,{inCurrent:!1,inBackground:!1})},category:"CATEGORY_COMMAND_APPLICATION",showInQC:!1,isEnabled:()=>!0,isVisible:()=>!0,keyword:{type:"string",defaultValue:G,unit:$},guid:"f57b8092-9426-4bc8-8e39-fcf3e315b065",...(0,O.Z)("command","Open Link in New Tab")},{name:b[1],action:async e=>{const t="string"==typeof e.param?e.param:"";return await _.ZP.openURL(e.windowId,t,{inCurrent:!0})},category:"CATEGORY_COMMAND_APPLICATION",showInQC:!1,isEnabled:()=>!0,isVisible:()=>!0,keyword:{type:"string",defaultValue:G,unit:$},guid:"0b01337b-4c13-4197-90c8-179c5c91cfff",...(0,O.Z)("command","Open Link in Current Tab")},{name:b[2],action:async e=>{const t="string"==typeof e.param?e.param:"";return await _.ZP.openURL(e.windowId,t,{inBackground:!0})},category:"CATEGORY_COMMAND_APPLICATION",showInQC:!1,isEnabled:()=>!0,isVisible:()=>!0,keyword:{type:"string",defaultValue:G,unit:$},guid:"00e0e4ad-de61-4e36-8d7e-6aead10cf1c5",...(0,O.Z)("command","Open Link in Background Tab")},{name:"COMMAND_TOGGLE_INTERFACE_COLOR_BY_NAME",action:async e=>{const t="string"==typeof e.param?e.param:"";D.Z.setThemeByNameWithFallback(t)},showInQC:!1,category:"CATEGORY_COMMAND_APPEARANCE",guid:"e12a5194-0153-439b-98f6-9dcd99ca0d7e",isEnabled:()=>!0,isVisible:()=>!0,keyword:{type:"string",unit:(0,d.Z)("Theme Name"),defaultValue:"Vivaldi"},...(0,O.Z)("Switch to Theme...")},{name:"COMMAND_SEARCH_SELECTION_WITH_CUSTOM_ENGINE",action:async e=>{const t=String(e.param),n=l.Z.getById(t)??l.Z.getDefault(x.ZP.isIncognitoOrGuest(e.windowId));n&&N.Z.withPageSelection(e.windowId,n)},showInQC:!1,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"3a8efd62-4c8a-4545-8a6c-9cb65518f507",isEnabled:()=>!0,isVisible:()=>!0,keyword:{type:"string",unit:(0,d.Z)("Search Engine"),defaultValue:""},...(0,O.Z)("Search Selection with Engine...")}],j=["b6ddaabf-d87f-4c2c-affa-ce81bb30bfca","176ff9a8-a516-4015-9b0a-14434746ce9b","1453aae1-130d-465f-98eb-cbda5061445d","172583c9-c8d5-45f7-9e4d-65cff9333679","d03d4bc8-26c4-49f6-b3ce-23980637ae76","855ad23f-900b-42bf-af4d-4ce6b419ce09","9f6124ef-e8ed-4143-b9ca-5a4beb646e3d"],Y=e=>{const{keyword:t}=e;let n,s;if("COMMAND_SEARCH_SELECTION_WITH_CUSTOM_ENGINE"===e.name){const e=l.Z.getDefault(!1);n=e?.id,s=e?.id}return{...t&&{param:n||t.defaultValue,defaultValue:s||t.defaultValue}}},X=e=>({name:e.name,label:e.label,key:e.guid,...Y(e)});var Q=U("br",{}),q=U("br",{}),J=U("br",{}),ee=U("br",{}),te=U("br",{}),ne=U("br",{}),se=U("br",{});function ie({filter:e,category:t}){const n=(0,L.Z)(H),s=y(),a=(0,i.useContext)(g.Z),[r,l]=(0,i.useState)([]),[h,p]=(0,i.useState)(n[c.kChainedCommandsCommandList]),u=(0,i.useRef)(0),m=t!==z.all,C=r.map((e=>X(e)));(0,i.useEffect)((()=>{w().then((e=>{const t=e.filter((e=>!(0,B.jD)(e.name)&&!(0,B.Ed)(e.name)&&!j.includes(e.guid)&&e.isVisible(a.vivaldiWindowId,!1))).map((e=>{const t=(0,R.xU)(e.name);return{...e,...t&&{keyword:t}}})).concat(K);l(t)}))}),[a.vivaldiWindowId]);const w=async()=>await o.Z.getVivDefinedCommands();(0,i.useEffect)((()=>{M.Z.set(c.kChainedCommandsCommandList,h)}),[h]);const b=e=>{const{val:t,position:n,shouldDelete:i}=e,o=r.find((e=>e.guid===t));if(!o||!s)return;const a=X(o),l=(0,V.Uy)(h,(e=>{const t={...e[u.current]},s=[...t.chain];s.splice(n,Number(i),a),t.chain=s,e[u.current]=t}));p(l)},I=(e,t)=>{const n=(0,V.Uy)(h,(n=>{const s={...n[u.current]},i=[...s.chain],o=i.splice(e,1)[0];i.splice(t,0,o),s.chain=i,n[u.current]=s}));p(n)},k=(e,t)=>{const n=!isNaN(e)&&e.length?Number(e):e,s=(0,V.Uy)(h,(e=>{const s={...e[u.current]},i=[...s.chain],o={...i[t]};o.param=n,i[t]=o,s.chain=i,e[u.current]=s}));p(s)},A=e=>{const t=(0,V.Uy)(h,(t=>{const n={...t[u.current]},s=[...n.chain];s.splice(e,1),n.chain=s,t[u.current]=n}));p(t)},Z=e=>{const t=(0,V.Uy)(h,(t=>{const n={...t[u.current]};n.label=e,t[u.current]=n}));p(t)},_=()=>{const e=(0,V.Uy)(h,(e=>{const t=e[u.current],n=crypto.randomUUID(),s={...t,chain:t.chain.slice(),key:n,name:`COMMAND_${n}`,label:(0,d.Z)("$1 copy",[t.label])};e.splice(u.current+1,0,s)}));p(e)},N=h.map((e=>({key:e.key,name:e.name,isDefault:!1,label:e.label})));return U(P.Z,{filter:e},void 0,U("p",{className:"info"},void 0,(0,d.Z)("A Command Chain is a group of commands executed in a sequence. You can trigger a Chain from Quick Commands, or assign it a custom Keyboard Shortcut or Mouse Gesture."),Q,q,(0,d.Z)("Some commands support parameters and placeholders. Placeholders can be used through Context Menus on websites, images and videos:"),J,(0,d.Z)("Selected Text: $1",[v.te.description]),ee,(0,d.Z)("Clicked Link: $1",[v.UL.description]),te,(0,d.Z)("Active Page URL: $1",[v.a5.description]),ne,(0,d.Z)("Active Page Title: $1",[v.v$.description]),se,(0,d.Z)("Source Element URL: $1",[v.Ff.description])),U(E.Z,{className:"Setting--ChainedCommand",masterLayout:1,contentStrings:S,items:N,filter:e,deleteTitle:(0,d.Z)("title","Delete Command Chain"),deleteTipString:(0,d.Z)("tooltip","Delete Command Chain"),addTipString:(0,d.Z)("Add Command Chain"),onRemove:e=>{const t=(0,V.Uy)(h,(t=>{const s=t.splice(e,1)[0],{key:i}=s,o=n[c.kChainedCommandsDeletedCommandList];M.Z.set(c.kChainedCommandsDeletedCommandList,[i,...o])}));p(t)},onContextMenu:(e,t)=>{const n=[{handler:_,...(0,O.Z)("Duplicate Command Chain")}];(0,f.Z)(a,n)(t)},renderEmpty:e=>U("div",{className:"detail"},void 0,U("div",{className:"detail-content"},void 0,U("h3",{},void 0,e.emptyTitle),U("p",{},void 0,e.emptyDescription))),moveItem:(e,t)=>{const n=(0,V.Uy)(h,(n=>{const s=n.splice(e,1)[0];n.splice(t,0,s)}));p(n)},emptyListString:(0,d.Z)("Add a Chain to Start"),emptyListGraphic:F.Yaj,deleteLabel:h[u.current]?.label,onCreateItem:()=>{const e=(0,d.Z)("create","New Chain"),t=crypto.randomUUID(),n={label:e,name:`COMMAND_${t}`,chain:[X(K[0])],key:t,category:"CATEGORY_COMMAND_CHAIN"};p((e=>[...e,n]))},renderCreate:e=>{const t=h.length-1,{chain:n,label:s}=h[t];return u.current=t,U(T,{chainOptions:C,changeParameter:k,removeFrom:A,commands:r,shouldFocusSelector:m,cloneChain:_,addToChain:b,searchableStrings:e,moveItem:I,nameChange:Z,windowId:a.vivaldiWindowId,name:s,chain:n})},mimeType:"vivaldi/x-settings-chained-command-type",supportDragAndDrop:!0,renderListItem:(e,t)=>U("div",{className:"item-title"},void 0,t.label),renderContent:(e,t)=>{const{chain:n,label:s}=h[e];return u.current=e,U(T,{chainOptions:C,changeParameter:k,removeFrom:A,commands:r,shouldFocusSelector:m,cloneChain:_,addToChain:b,searchableStrings:t,moveItem:I,nameChange:Z,windowId:a.vivaldiWindowId,name:s,chain:n})}}))}},87159:(e,t,n)=>{"use strict";n.d(t,{GO:()=>r,ZP:()=>l,uw:()=>a});var s=n(29087),i=n(89175);let o=!1;const a=1e3,r=5e3,l={getSupportsProxy:()=>o,setSupportsProxy:e=>{o=!1},showSurveyNow:()=>{const e=s.Z.get(i.kProxySeen);return 0!==e&&-1!==e&&Date.now()-e>15e3}}},60842:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>c,aD:()=>p,vo:()=>h});var s=n(68247),i=n(29087),o=n(34540),a=n(92292),r=n(35369),l=n(89175),d=n(20349);async function c(e,t,n){const i={...await h()};n?i[t]=n:delete i[t],s.Z.set(l.kTabsStackingNameMap,i),await(0,o.Z)(e,{groupTitles:i})}async function h(){const e=await a.Z.tabs.query({}),t=(0,r.l4)(e.map((e=>JSON.parse(e.vivExtData||"{}").group)).filter(Boolean)),n=i.Z.get(l.kTabsStackingNameMap)||{},o=(0,d.Z)(n,((e,n)=>t.includes(n)));return s.Z.set(l.kTabsStackingNameMap,o),o}function p(e,t){return(i.Z.get(l.kTabsStackingNameMap)||{})[e]||t}},93197:(e,t,n)=>{"use strict";n.d(t,{$J:()=>r,Cj:()=>l,E5:()=>d,ZP:()=>b});var s=n(65792),i=n.n(s),o=n(42568),a=n.n(o);const r=.4,l=i()("#fff"),d=i()("#000"),c=i()("#06a700"),h=i()("#FFCC00"),p=i()("#c64539");function u(e,t,n){return i().deltaE(e,t)>=n}function g(e,t,n,s=!1){return u(e,t,n)?e:e.luminance()>t.luminance()?function(e,t,n,s=!1){do{if((e=e.brighten(.1)).num()===l.num()){if(!s)return l;do{if((e=e.darken(.1)).num()===d.num())return d}while(!u(e,t,n))}}while(!u(e,t,n));return e}(e,t,n,s):function(e,t,n,s=!1){let o=i()(e.hex());do{if(o=o.darken(.1),o.num()===d.num()){if(!s)return d;let o=i()(e.hex());do{if(o=o.brighten(.1),o.num()===l.num())return l}while(!u(o,t,n));return o}}while(!u(o,t,n));return o}(e,t,n,s)}function m(e,t,n){const s=e.luminance()>r?e.brighten(.75):e.darken(.75),o=i().mix(e,t,.1),a=i().mix(e,t,.2),l=i().mix(e,t,.4);return{colorFg:e,colorFgAlpha:e.alpha(.1),colorFgIntense:g(s,t,n),colorFgFaded:g(o,t,n),colorFgFadedMore:g(a,t,n),colorFgFadedMost:g(l,t,n)}}function v(e,t,n,s,o){const a=e.luminance()>r,d=e.darken(.15),c=e.darken(.3),h=e.brighten(.1),p=e.brighten(.5),u=e.brighten(.2),m=a?e.brighten(.3):e.darken(.5),v=a?e.brighten(.5):e.darken(.7),f=a?e.darken(.1):e.brighten(.1),y=a?e.darken(.4):e.brighten(.4),C=a?e.darken(.3):e.brighten(.3),w=a?i().mix(l,e,.4).alpha(.95):v.darken(.1).alpha(.92);return{colorBg:e,colorBgAlpha:e.alpha(.9),colorBgAlphaHeavy:e.alpha(.65),colorBgAlphaHeavier:e.alpha(.25),colorBgAlphaBlur:e.alpha(s),colorBgDark:g(d,t,n),colorBgDarker:g(c,t,n),colorBgLight:g(h,t,n),colorBgLighter:g(p,t,n),colorBgLightIntense:g(u,t,n),colorBgIntense:g(m,t,n),colorBgIntenser:g(v,t,n),colorBgIntserAlpha:w,colorBgInverse:g(f,t,n),colorBgInverser:g(y,t,n),colorBgFaded:g(C,t,n),backgroundBlur:o?`blur(${o}px)`:""}}function f(e,t,n){const s=e.brighten(1),i=e.darken(.5),o=e.luminance()>r?d:l;return{colorHighlightBg:e,colorHighlightBgFaded:s,colorHighlightBgAlpha:e.alpha(.1),colorHighlightBgDark:g(i,t,n),colorHighlightFg:o,colorHighlightFgAlpha:o.alpha(.5),colorHighlightFgAlphaHeavy:o.alpha(.25)}}function y(e,t,n,s){s&&e.luminance()>.8&&(e=e.darken(.55));const o=e.luminance()>r,a=o?d:l,c=i().mix(a,e,.4),h=e.darken(.4),p=e.darken(1),u=o?e.brighten(.3).desaturate(.5):e.darken(.3).desaturate(.5),m=e.brighten(.5),v=e.brighten(1.2),f=v.luminance()>r,y=g(e,t,n,!0),C=y.darken(.25);return{colorAccentBg:e,colorAccentBgAlpha:v.alpha(f?.45:.55),colorAccentBgAlphaHeavy:v.alpha(f?.25:.35),colorAccentBgDark:h,colorAccentBgDarker:p,colorAccentBgFaded:u,colorAccentBgFadedMore:m,colorAccentBgFadedMost:v,colorAccentBorder:y,colorAccentBorderDark:C,colorAccentFg:a,colorAccentFgFaded:c,colorAccentFgAlpha:a.alpha(.15),colorAccentFgAlphaHeavy:a.alpha(.05)}}function C(e,t){const n=.003*t,s=e.luminance()<n?e.brighten(1):e.darken(.5),o=g(s,e,t),a=o.luminance()>e.luminance(),l=e.luminance()<=r?i().mix(o,e,.35):i().mix(o,e,.7),d=a?o.brighten(.4):o.darken(.4),c=g(s,e,t/2);return{colorBorder:o,colorBorderDisabled:g(l,e,t/2),colorBorderSubtle:i().mix(c,e,.25),colorBorderIntense:g(d,e,1.25*t)}}function w(e,t){const n=g(c,e,t),s=n.alpha(.1),i=n.luminance()>r?d:l,o=g(h,e,t),a=o.alpha(.1),u=o.luminance()>r?d:l,m=g(p,e,t),v=m.alpha(.1),f=m.luminance()>r?d:l;return{colorSuccessBg:n,colorSuccessBgAlpha:s,colorSuccessFg:i,colorWarningBg:o,colorWarningBgAlpha:a,colorWarningFg:u,colorErrorBg:m,colorErrorBgAlpha:v,colorErrorFg:f}}const b={forTheme:a()((e=>{const t=6*e.contrast,n=2*e.contrast,s=1.5*e.contrast,o=3*e.contrast,a=3*e.contrast,c=6*e.contrast,h=g(i()(e.colorFg),i()(e.colorBg),t),p=g(i()(e.colorBg),i()(e.colorFg),n),u=g(i()(e.colorHighlightBg),i()(e.colorBg),s),b=g(i()(e.colorAccentBg),i()(e.colorBg),o,!0),S=e.colorWindowBg?i()(e.colorWindowBg):p,I=S.luminance()>r?d:l;return{...m(h,p,t),...v(p,h,n,e.alpha,e.blur),...f(u,p,s),...y(b,p,o,!1),...C(p,a),...w(p,c),colorWindowBg:S,colorWindowFg:I}}),{maxSize:5}),accentOnly:function(e,t,n,s,i){const o=2*s,a=3*s;return t=g(t,n,6*s),n=g(n,t,o),y(e=g(e,n,a),n,a,i)},fgBgHighlight:function(e,t,n){return e=g(e,t,6),t=g(t,e,2),n=g(n,t,1.5),{...m(e,t,6),...v(t,e,2,.75,10),...f(n,t,1.5)}}}},9719:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>o,eF:()=>i,nn:()=>s});const s=16,i=12,o=(e,t)=>({radiusRound:e>-1?"100px":0,radiusRounded:e>-1?"2px":0,radiusRoundedLess:e>0?e-1+"px":0,radius:`${e}px`,radiusHalf:`${Math.round(e/2)}px`,radiusCap:`${Math.min(e,8)}px`,scrollbarWidth:`${t?i:s}px`})},86461:(e,t,n)=>{"use strict";n.d(t,{Gt:()=>T,LM:()=>E,Np:()=>_,PK:()=>Z,aX:()=>k,e3:()=>u,wY:()=>A,ww:()=>I});var s=n(96951),i=n(15285),o=n(34197),a=n(29087),r=n(87159),l=n(70864),d=n(15489),c=n(56371),h=n(89175);const p=["PanelWeb","Settings"],u=["PanelChat"],g=[{id:"Spacer",label:(0,c.Z)("Space")},{id:"FlexibleSpacer",label:(0,c.Z)("Flexible Space")},{id:"Divider",label:(0,c.Z)("Separator")}],m={category:"navigation",label:(0,c.Z)("title","Address Bar"),pref:h.kToolbarsNavigation,buttons:[{id:"Back",label:(0,c.Z)("navigation","Back")},{id:"Forward",label:(0,c.Z)("navigation","Forward")},{id:"Rewind",label:(0,c.Z)("Rewind")},{id:"FastForward",label:(0,c.Z)("Fast Forward")},{id:"Reload",label:(0,c.Z)("Reload")},{id:"Stop",label:(0,c.Z)("verb","Stop")},{id:"Home",label:(0,c.Z)("Home")},{id:"AddressField",label:(0,c.Z)("Address Field")},{id:"SearchField",label:(0,c.Z)("Search Field")},{id:"DownloadButton",label:(0,c.Z)("Downloads")},{id:"ReadingList",label:(0,c.Z)("Reading List")},{id:"AccountButton",label:(0,c.Z)("Account")},{id:"UpdateButton",label:(0,c.Z)("Update Status")},{id:"Extensions",label:(0,c.Z)("Extensions")},{id:"WorkspaceButton",label:(0,c.Z)("Workspaces")},{id:"Proxy",label:(0,c.Z)("Privacy Guard")},...g]},v={category:"status",label:(0,c.Z)("title","Status Bar"),pref:h.kToolbarsStatus,buttons:[{id:"BreakMode",label:(0,c.Z)("Break Mode")},{id:"MailStatus",label:(0,c.Z)("Mail Status")},{id:"CalendarStatus",label:(0,c.Z)("Calendar Status")},{id:"SyncStatus",label:(0,c.Z)("Sync Status")},{id:"StatusInfo",label:(0,c.Z)("Status Info")},{id:"VersionInfo",label:(0,c.Z)("Version Info")},{id:"CaptureImages",label:(0,c.Z)("Capture Images")},{id:"TilingToggle",label:(0,c.Z)("Page Tiling")},{id:"ImagesToggle",label:(0,c.Z)("Toggle Images")},{id:"PageActions",label:(0,c.Z)("Page Actions")},{id:"Zoom",label:(0,c.Z)("Page Zoom")},{id:"Clock",label:(0,c.Z)("Clock")},{id:"Settings",label:(0,c.Z)("Settings")},...g]},f={category:"panel",label:(0,c.Z)("toolbar","Panel"),pref:h.kToolbarsPanel,buttons:[{id:"PanelToggle",label:(0,c.Z)("Panel Toggle")},{id:"PanelBookmarks",label:(0,c.Z)("Bookmarks")},{id:"PanelReadingList",label:(0,c.Z)("Reading List")},{id:"PanelDownloads",label:(0,c.Z)("Downloads")},{id:"PanelHistory",label:(0,c.Z)("History")},{id:"PanelNotes",label:(0,c.Z)("Notes")},{id:"PanelWindow",label:(0,c.Z)("panel","Window")},{id:"PanelTranslate",label:(0,c.Z)("panel","Translate")},{id:"PanelMail",label:(0,c.Z)("Mail")},{id:"PanelCalendar",label:(0,c.Z)("Calendar")},{id:"PanelTasks",label:(0,c.Z)("Tasks")},{id:"PanelFeeds",label:(0,c.Z)("Feeds")},{id:"PanelContacts",label:(0,c.Z)("Contacts")},{id:"PanelChat",label:(0,c.Z)("Chat")},{id:"PanelSession",label:(0,c.Z)("Sessions")},{id:"PanelWeb",label:(0,c.Z)("Add Web Panel")},...g]},y=[{id:"MailBack",label:(0,c.Z)("navigation","Back")},{id:"MailForward",label:(0,c.Z)("navigation","Forward")},{id:"MailReload",label:(0,c.Z)("Reload")}],C=[{id:"MailMsgReply",label:(0,c.Z)("Reply")},{id:"MailMsgReplyToAll",label:(0,c.Z)("Reply to All")},{id:"MailMsgForward",label:(0,c.Z)("mail","Forward")}],w={id:"MailMsgStatusRead",label:(0,c.Z)("Mark Unread")},b={id:"MailMsgStatusUnread",label:(0,c.Z)("Mark Read")},S=[w,b,{id:"MailMsgFlag",label:(0,c.Z)("Flag")},{id:"MailMsgLabel",label:(0,c.Z)("Label")},{id:"MailMsgMove",label:(0,c.Z)("Move to Folder")},{id:"MailMsgSpam",label:(0,c.Z)("Mark Message as Spam")},{id:"MailMsgSpamRestore",label:(0,c.Z)("Not Spam")},{id:"MailMsgArchive",label:(0,c.Z)("Move to Archive")},{id:"MailMsgArchiveRestore",label:(0,c.Z)("Restore from Archive")},{id:"MailMsgTrash",label:(0,c.Z)("Move to Trash")},{id:"MailMsgTrashRestore",label:(0,c.Z)("Undelete")},{id:"MailRenderingMethod",label:(0,c.Z)("Rendering Method")},{id:"MailViewThreading",label:(0,c.Z)("Threads")},{id:"MailViewLayout",label:(0,c.Z)("Toggle Layout")}],I=[{...m},{...v},{...f},{...{category:"mail",label:(0,c.Z)("Mail Bar"),pref:h.kToolbarsMail,buttons:[...y,{id:"MailSearch",label:(0,c.Z)("Mail Search")},{id:"MailCompose",label:(0,c.Z)("Compose New Mail")},{id:"MailMsgEdit",label:(0,c.Z)("mail","Edit")},...C,...S,...g]}},{...{category:"mail_composer",label:(0,c.Z)("Mail Composer Bar"),pref:h.kToolbarsMailComposer,buttons:[...y,{id:"MailMsgSend",label:(0,c.Z)("Send")},{id:"MailMsgAttach",label:(0,c.Z)("Add Attachment")},{id:"MailMsgShowHeaders",label:(0,c.Z)("Show Headers")},{id:"MailMsgDiscard",label:(0,c.Z)("Discard Draft")},w,b,...g]}},{...{category:"mail_message",label:(0,c.Z)("Mail Message Bar"),pref:h.kToolbarsMailMessage,buttons:[...y,...C,...S,...g]}}],k=["Spacer","FlexibleSpacer","Divider"];function A(e){let t="";for(const n of I){const s=n.buttons.find((t=>t.id===e));if(s){t=s.label;break}}return t}function T(e,t,n){let s=n.filter((e=>!u.includes(e)));return r.ZP.getSupportsProxy()||(s=s.filter((e=>"Proxy"!==e))),t?s:d.ZP.isGuest()?s.filter((e=>!p.includes(e))):s}function Z(e,t){const n=a.Z.get(h.kToolbarsNavigation),i=a.Z.get(h.kToolbarsPanel),o=a.Z.get(h.kToolbarsStatus),r=a.Z.get(h.kToolbarsMail).concat(a.Z.get(h.kToolbarsMailComposer)).concat(a.Z.get(h.kToolbarsMailMessage));if(!n.concat(i).concat(o).concat(r).includes(e))return!1;const{isMailPage:l}=s.ZP.getActivePage(t)||{isMailPage:!1},d=a.Z.get(h.kAddressBarVisible),c="on"===a.Z.get(h.kStatusBarDisplay);return n.includes(e)&&d&&!l||o.includes(e)&&c||r.includes(e)&&d&&l}function E(e,t){const n=t===h.kToolbarsNavigation?[]:a.Z.get(h.kToolbarsNavigation),s=t===h.kToolbarsStatus?[]:a.Z.get(h.kToolbarsStatus),i=t===h.kToolbarsPanel?[]:a.Z.get(h.kToolbarsPanel),o=t===h.kToolbarsMail?[]:a.Z.get(h.kToolbarsMail);return n.concat(s).concat(i).concat(o).includes(e)}function _(e,t){const n=[...a.Z.get(t)].filter((e=>o.Z.isWebPanel(e))),s=[...a.Z.getDefault(t)].filter((e=>o.Z.isWebPanel(e)));s.forEach((t=>{if(!n.find((e=>e===t))){const n=i.ZP.getWebPanels(e).find((e=>t.endsWith(e.id)));n||l.Z.restoreById(e,t,!1)}})),n.forEach((e=>{s.find((t=>t===e))||l.Z.removeById(e,t)}))}},10373:(e,t,n)=>{"use strict";function s(e,t,n,s){return e.substring(0,n)+t+e.substring(s)}n.d(t,{C:()=>a,i:()=>s});const i=/^(.*?:\/\/\/*)(.*)$/,o=/(.*?)\/*([#?].*)/;function a(e){if(e.startsWith("data:"))return{schema:"data:",host:"",postfix:"",path:e.substring("data:".length)};let t;try{t=new URL(e)}catch(e){return{schema:"",host:"",path:"",postfix:""}}const n=e.match(i),s=n&&n[1]||"",a=e.match(o),r=a&&a[2]||"",l=t.hostname+(t.port?`:${t.port}`:"");let d;try{d=decodeURI(t.pathname)}catch(e){d=t.pathname}return"vivaldi://"===s?{schema:s,host:l,path:d.startsWith("//")?d.substring(2,d.length-1):d,postfix:r}:{schema:s,host:l,path:d,postfix:r}}},92571:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var s=n(3822),i=n(56371),o=n(94184),a=n.n(o),r=n(46884),l=n(67294),d=n(48521);const c={clearIndicator:()=>({}),container:()=>({}),control:()=>({}),dropdownIndicator:()=>({}),group:()=>({}),groupHeading:()=>({}),indicatorsContainer:()=>({}),indicatorSeparator:()=>({}),input:()=>({}),loadingIndicator:()=>({}),menu:()=>({}),menuList:()=>({}),menuPortal:()=>({}),multiValue:()=>({}),multiValueLabel:()=>({}),multiValueRemove:()=>({}),noOptionsMessage:()=>({}),option:()=>({}),placeholder:()=>({}),singleValue:()=>({}),valueContainer:()=>({})};const h=function(e){const{autoFocus:t,placeholder:n,commands:o,isClearable:h,openMenuOnFocus:p,isMulti:u,customStyles:g,selectedCommand:m}=e,v={...c,...g},f=()=>{y.current?.select?.blur()},y=(0,l.useRef)(null),C=(0,l.useRef)(null),w=(0,l.useCallback)((()=>C.current),[]),b=(0,l.useCallback)((()=>f),[]);(0,r.Z)(w,b);const S=a()("VivaldiSelector",e.className);return(0,d.jsx)("div",{ref:C,children:(0,d.jsx)(s.ZP,{ref:y,className:S,classNamePrefix:"Inner",autoFocus:t||!1,value:m,isClearable:h||!1,openMenuOnFocus:p||!1,isMulti:u||!1,onChange:t=>{return n=t,void e.setSelectedItem(n);var n},styles:v,onInputChange:(e,t)=>{"menu-close"===t.action&&f()},placeholder:n,options:o,loadingMessage:()=>(0,i.Z)("Loading..."),noOptionsMessage:()=>(0,i.Z)("No options")})})}},70864:(e,t,n)=>{"use strict";n.d(t,{Z:()=>y});var s=n(21788),i=n(53576),o=n(18350),a=n(34197),r=n(14481),l=n(68247),d=n(29087),c=n(26591),h=n(86461),p=n(36436),u=n(89175);const g="webpanel",m="EXT_PANEL_",v="about:blank",f={_createWebPanelItem:function(e){let t=e.id;return t&&0!==t.length||(t=f.getWebPanelId()),{activeUrl:e.activeUrl,faviconUrl:c.Z,faviconUrlValid:!0,id:t,mobileMode:!0,origin:"user",resizable:!1,title:e.title??"",url:e.url,width:-1,zoom:1}},restoreById:function(e,t,n){const s=d.Z.get(u.kPanelsWebRemovedElements).findIndex((e=>e.id===t));if(-1!==s)this.recoverWebPanel(e,s,n);else{const e=d.Z.getDefault(u.kPanelsWebElements).find((e=>e.id===t));e&&f.addPanels(-1,[e],-1,n)}},isExtPanel:e=>!!e&&e.startsWith(m),getWebPanelId:()=>"WEBPANEL_"+crypto.randomUUID(),getExtPanelIdFromExtensionId:e=>m+e,getExtPanelId:function(e){if(e.sidePanel)return f.getExtPanelIdFromExtensionId(e.id)},removeByExtension:function(e,t){const n=f.getExtPanelId(t);if(!n)return;f.removeById(n,u.kToolbarsPanel);const s=d.Z.get(u.kToolbarsPanel).slice();l.Z.set(u.kToolbarsPanel,s.filter((e=>e!==n)))},hasPanelUrl:function(e){if(!e)return!1;return d.Z.get(u.kPanelsWebElements).find((t=>{const n=new URL(t.url),s=new URL(e);return(0,p.uu)(n.toString(),s.toString())}))},hasPanelId:function(e){return!!d.Z.get(u.kToolbarsPanel).find((t=>t===e))},addByExtension:function(e,t){const n=f.getExtPanelId(t);if(!n)return;if(d.Z.get(u.kToolbarsPanel).find((e=>e===n)))return;const s=t.sidePanel;if(!s)return;const i={id:n,url:s.url??"",activeUrl:s.activeUrl??v,title:t.badgeTooltip};f.addBySpec(e,i)},updateByExtension:function(e,t){const n=f.getExtPanelIdFromExtensionId(e);t.enabled?t.resourceUrl&&f.setActiveUrl(n,t.resourceUrl):f.setNoContent(n)},addBySpec:function(e,t){const n=this._createWebPanelItem(t);f.addPanels(e,[n],t.index??-1,t.showButton??!0)},addByUrl:function(e,t,n){f.addByUrls(e,[t],-1,n)},addByUrls:function(e,t,n,s){const i=t.map((e=>this._createWebPanelItem({url:e,activeUrl:e})));f.addPanels(e,i,n,s)},addPanels:function(e,t,n,s){const i=d.Z.get(u.kPanelsWebElements).slice();if(t.forEach((e=>{i.find((t=>t.id===e.id))?console.warn("Panel data already installed",e.id):i.push(e)})),l.Z.set(u.kPanelsWebElements,i),s){let s;n<0&&(n=a.Z.getNewIndex());const i=d.Z.get(u.kToolbarsPanel).slice();t.forEach((e=>{i.find((t=>t===e.id))||(n>=i.length?i.push(e.id):i.splice(n,0,e.id)),s||(s=e.id)})),l.Z.set(u.kToolbarsPanel,i),s&&o.Z.setAddedButton(e,u.kToolbarsPanel,s,!0)}},removeById:function(e,t){if((0,h.LM)(e,t))return;const n=d.Z.get(u.kPanelsWebElements);if(0===n.length)return;const s=n.filter((t=>t.id===e))[0];if(!s)return;r.Z.destroyPeriodicAlarm({id:e,from:"panel"});const i=n.filter((t=>t.id!==e));l.Z.set(u.kPanelsWebElements,i);const o=d.Z.get(u.kPanelsWebRemovedElements).slice();if(o.push(s),l.Z.set(u.kPanelsWebRemovedElements,o),"bundle"===s.origin){const t=d.Z.get(u.kPanelsWebModifiedElements).slice();t.includes(e)||(t.push(e),l.Z.set(u.kPanelsWebModifiedElements,t))}},updatePanelData:function(e,t){const n=[...d.Z.get(u.kPanelsWebElements)],s=n?.findIndex((t=>t.id===e));-1!==s&&(n[s]={...n[s],...t},l.Z.set(u.kPanelsWebElements,n))},setZoom:(e,t)=>f.updatePanelData(e,{zoom:t}),setPeriodicReload:(e,t)=>f.updatePanelData(e,{interval:t}),setTitle:(e,t)=>f.updatePanelData(e,{title:t}),setUrl:(e,t)=>f.updatePanelData(e,{url:t}),setMobileMode:(e,t)=>f.updatePanelData(e,{mobileMode:t}),setActiveUrl:(e,t)=>f.updatePanelData(e,{activeUrl:t}),setNoContent:e=>{f.setActiveUrl(e,v)},setFaviconUrl:(e,t)=>f.updatePanelData(e,{faviconUrl:t,faviconUrlValid:!0}),recoverWebPanel:function(e,t,n){const s=d.Z.get(u.kPanelsWebRemovedElements);if(s.length>0&&t<s.length){const i=s[t];if("bundle"===i.origin){const e=d.Z.get(u.kPanelsWebModifiedElements).slice(),t=e.findIndex((e=>e===i.id));-1!==t&&(e.splice(t,1),l.Z.set(u.kPanelsWebModifiedElements,e))}f.addPanels(e,[i],-1,n);const o=s.slice();o.splice(t,1),l.Z.set(u.kPanelsWebRemovedElements,o)}},emptyTrash:function(){l.Z.set(u.kPanelsWebRemovedList,[]),l.Z.set(u.kPanelsWebRemovedItems,[]),l.Z.set(u.kPanelsWebRemovedElements,[])},copyWebPanelAdress:function(e){const t=this.getUrlById(e);t.length>0&&s.Z.copyUrlToClipboard(t)},getUrlById:function(e){const t=d.Z.get(u.kPanelsWebElements).filter((t=>t.id===e)).map((e=>e.activeUrl||e.url));return t.length>0?t[0]:""},openInTab:function(e,t,n,s){const o=this.getUrlById(t);o.length>0&&i.ZP.openURL(e,o,{inCurrent:n,inBackground:s})},openInNewWindow:function(e,t,n){const s=this.getUrlById(t);s.length>0&&i.ZP.openURL(e,s,{inNewWindow:!0,incognito:n})},getIndexByShortcut:function(e){const t=g.length,n=e.substr(0,t),s=e.substr(t).trim();return n===g&&s>="1"&&s<="9"?parseInt(s):-1},setUIContent:function(e){const t={...d.Z.get(u.kPanelsWebToolbar)};t.showToolbar=e.showToolbar,t.allControls=e.allControls??t.allControls,t.zoomControls=e.zoomControls??t.zoomControls,l.Z.set(u.kPanelsWebToolbar,t)}},y=f},71828:(e,t,n)=>{"use strict";n.d(t,{OK:()=>o,VH:()=>u,Wp:()=>r,XF:()=>d,XZ:()=>p,Zh:()=>h,an:()=>s,bI:()=>i,m6:()=>v,oJ:()=>g,pL:()=>a,qt:()=>c,rM:()=>l,s5:()=>m});const s=1,i=.5,o=2,a=.25,r=.05,l=1,d=.2,c=5,h=.1,p=1,u=.5,g=2,m=.05,v=1},30330:(e,t,n)=>{"use strict";n.d(t,{FD:()=>he,CN:()=>ye,xU:()=>pe,os:()=>ge});var s=n(36964),i=n(43630),o=n(39005),a=n(15590),r=n(2934),l=n(12442),d=n(15800),c=n(84675),h=n(21788),p=n(57082),u=n(87210),g=n(5198),m=n(99827),v=n(2431),f=n(46382),y=n(21838),C=n(62882),w=n(53576),b=n(96951),S=n(18350),I=n(15285),k=n(14481),A=n(68247),T=n(29087),Z=n(98974),E=n(87159),_=n(92413),M=n(54614),N=n(40893),P=n(43656),D=n(33638);const x=new class{switchTabBackBySetting(e,t){D.Z.dispatch({actionType:"TAB_SWITCH_BACK_SETTING",winId:e,event:t})}switchTabForwardBySetting(e,t){D.Z.dispatch({actionType:"TAB_SWITCH_FORWARD_SETTING",winId:e,event:t})}disbandTileGroup(e){D.Z.dispatch({actionType:"DISBAND_TILE_GROUP",winId:e})}stackCreate(e){D.Z.dispatch({actionType:"TAB_STACK_CREATE",winId:e})}stackDissolve(e){D.Z.dispatch({actionType:"TAB_STACK_DISSOLVE",winId:e})}stackRemove(e){D.Z.dispatch({actionType:"TAB_STACK_REMOVE",winId:e})}stackTileGrid(e){D.Z.dispatch({actionType:"TAB_STACK_TILE_GRID",winId:e})}stackTileHorizontal(e){D.Z.dispatch({actionType:"TAB_STACK_TILE_HORIZONTAL",winId:e})}stackTileVertical(e){D.Z.dispatch({actionType:"TAB_STACK_TILE_VERTICAL",winId:e})}viewPageSource(e){D.Z.dispatch({actionType:"TAB_VIEW_PAGE_SOURCE",winId:e})}toggleTabThumbnail(e){D.Z.dispatch({actionType:"TAB_TOGGLE_THUMBNAIL",winId:e})}};var O=n(2699),L=n(32773),R=n(54058),B=n(76501),F=n(83526),V=n(63153),W=n(15489),U=n(29104),H=n(22303),z=n(56371),G=n(78347),$=n(92292),K=n(26036),j=n(7064),Y=n(71828),X=n(35369),Q=n(19626),q=n(80225),J=n(69046),ee=n(10334),te=n(86461),ne=n(36436),se=n(19842),ie=n(89175),oe=n(21191),ae=n(92521),re=n(6826),le=n(44850);const de=!1,ce=e=>"object"==typeof e&&"wheel"===e.type,he={COMMAND_OPEN_LINK:"https://www.vivaldi.com"},pe=e=>fe[e],ue=["COMMAND_CLIPBOARD_UNDO","COMMAND_CLIPBOARD_REDO","COMMAND_CLIPBOARD_CUT","COMMAND_CLIPBOARD_COPY","COMMAND_CLIPBOARD_PASTE","COMMAND_CLIPBOARD_SELECT_ALL","COMMAND_HIDE_OTHERS","COMMAND_HIDE_VIVALDI","COMMAND_SHOW_ALL"],ge=e=>ue.includes(e);function me(){return!W.ZP.isGuest()&&!T.Z.get(ie.kMailIsTurnedOff)}function ve(e){const t=b.ZP.getActivePage(e)?.url??"";return(0,ne.xl)(t)&&t.includes("mail.html?path=composer")}const fe={COMMAND_TAB_PERIODIC_RELOAD:{type:"mixed",defaultValue:60,unit:(0,z.Z)("time","Seconds"),min:60,max:31556926,validity:/^((?<min>\d+)['′m]\s*((?<sec1>\d+)["″s])?|((?<sec2>\d+)["″s])$)/i},COMMAND_MAIN_ZOOM:{type:"number",unit:(0,z.Z)("Percentage"),defaultValue:100*Y.m6,min:100*Y.XF,max:100*Y.qt},COMMAND_MAIN_UI_ZOOM:{type:"number",unit:(0,z.Z)("Percentage"),defaultValue:100*Y.m6,min:100*Y.bI,max:100*Y.OK},COMMAND_DEFAULT_MAIN_ZOOM:{type:"number",unit:(0,z.Z)("Percentage"),defaultValue:100*Y.m6,min:100*Y.bI,max:100*Y.OK}},ye=[{name:"COMMAND_NEW_WINDOW",action:e=>{if(W.ZP.isGuest())f.Z.openGuestWindow();else{const t={focused:!0,incognito:!1};V.Z.openWindow(e.windowId,"window.html","normal",t)}},isEnabled:ae.Z,isVisible:ae.Z,withNoWindow:!0,showInQC:!0,category:"CATEGORY_COMMAND_APPLICATION",guid:"b6ddaabf-d87f-4c2c-affa-ce81bb30bfca",...(0,K.Z)("command","New Window")},{name:"COMMAND_NEW_PRIVATE_WINDOW",action:e=>V.Z.openIncognitoWindow(e.windowId),isEnabled:ae.Z,isVisible:e=>!W.ZP.isGuest(),withNoWindow:!0,showInQC:!0,category:"CATEGORY_COMMAND_APPLICATION",guid:"176ff9a8-a516-4015-9b0a-14434746ce9b",...(0,K.Z)("New Private Window")},{name:"COMMAND_NEW_GUEST_WINDOW",action:()=>f.Z.openGuestWindow(),isEnabled:ae.Z,isVisible:e=>!W.ZP.isIncognito(e),category:"CATEGORY_COMMAND_APPLICATION",showInQC:!0,guid:"1453aae1-130d-465f-98eb-cbda5061445d",...(0,K.Z)("New Guest Window")},{name:"COMMAND_MANAGE_PEOPLE",action:()=>f.Z.managePeople(),category:"CATEGORY_COMMAND_APPLICATION",isEnabled:ae.Z,isVisible:ae.Z,showInQC:!0,guid:"49023738-dc53-4fce-8fd8-68bcdc89be34",...(0,K.Z)("Manage Profiles")},{name:"COMMAND_CLOSE_WINDOW",action:e=>V.Z.close(e.windowId),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"172583c9-c8d5-45f7-9e4d-65cff9333679",...(0,K.Z)("command","Close Window")},{name:"COMMAND_SHOW_QUICK_COMMANDS",action:e=>f.Z.showQuickCommand(e.windowId),showInQC:!1,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"f8d653f3-1371-4cf2-ab83-b8c62ad98add",...(0,K.Z)("Quick Commands")},{name:"COMMAND_CUSTOMIZE_TOOLBAR",action:e=>L.Z.edit(ie.kToolbarsNavigation),showInQC:!0,isEnabled:ae.Z,isVisible:e=>!W.ZP.isGuest(),category:"CATEGORY_COMMAND_APPEARANCE",guid:"fd9a4bd8-25a8-4006-8e63-251f166aa862",...(0,K.Z)("Customize Toolbar")},{name:"COMMAND_FULLSCREEN",action:e=>V.Z.toggleFullscreen(e.windowId),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"7420368f-565e-409f-8eec-5b5c578429af",...(0,K.Z)("Fullscreen Mode")},{name:"COMMAND_TASK_MANAGER",action:e=>j.Z.utilities.openTaskManager(e.windowId),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"3aed82ac-e497-4f75-9f13-c5a7df0ac448",...(0,K.Z)("Task Manager")},{name:"COMMAND_SHOW_SETTINGS",action:e=>f.Z.showSettings(e.windowId),isEnabled:ae.Z,isVisible:e=>!W.ZP.isGuest(),withNoWindow:de,showInQC:!0,category:"CATEGORY_COMMAND_APPLICATION",guid:"1e05a540-7261-427f-a902-8a75f5e81cdd",...(0,K.Z)("Settings")},{name:"COMMAND_SHOW_EXTENSIONS",action:e=>f.Z.showExtensions(e.windowId),withNoWindow:!0,showInQC:!0,isEnabled:ae.Z,isVisible:e=>!W.ZP.isGuest(),category:"CATEGORY_COMMAND_APPLICATION",guid:"ef8d7f53-627c-4286-a03e-7affc92b5ff3",...(0,K.Z)("Extensions")},{name:"COMMAND_SHOW_HISTORY",action:e=>f.Z.showHistory(e.windowId),withNoWindow:!0,isEnabled:ae.Z,isVisible:e=>!W.ZP.isGuest(),showInQC:!0,category:"CATEGORY_COMMAND_APPLICATION",guid:"dd8723f0-b05a-4d22-b55b-b1c1a6e282e2",...(0,K.Z)("History")},{name:"COMMAND_SHOW_NOTES",action:e=>f.Z.showNotes(e.windowId),withNoWindow:!0,showInQC:!0,isEnabled:ae.Z,isVisible:e=>!W.ZP.isGuest(),category:"CATEGORY_COMMAND_APPLICATION",guid:"97006589-839d-4c3e-aa37-311a864618b5",...(0,K.Z)("Notes")},{name:"COMMAND_SHOW_BOOKMARKS",action:e=>f.Z.showBookmarks(e.windowId),withNoWindow:!0,isEnabled:ae.Z,isVisible:e=>!W.ZP.isGuest(),showInQC:!0,category:"CATEGORY_COMMAND_APPLICATION",guid:"9cde01a4-9df7-4a2e-84a1-27997c6df705",...(0,K.Z)("Bookmarks")},{name:"COMMAND_SHOW_WELCOME",action:e=>f.Z.showWelcome(e.windowId),isEnabled:ae.Z,isVisible:e=>!W.ZP.isGuest(),withNoWindow:!0,showInQC:!0,category:"CATEGORY_COMMAND_APPLICATION",guid:"3e27424f-656a-48bf-85e4-01364ec27b57",...(0,K.Z)("Vivaldi Welcome Tour")},{name:"COMMAND_SHOW_CLEAR_PRIVATE_DATA",action:e=>f.Z.showClearBrowsingHistoryDialog(e.windowId),isEnabled:ae.Z,isVisible:e=>!W.ZP.isIncognitoOrGuest(e),showInQC:!0,category:"CATEGORY_COMMAND_APPLICATION",guid:"10a45d9e-c539-4c67-92fd-c2332fb41127",...(0,K.Z)("command","Delete Browsing Data")},{name:"COMMAND_SHOW_BOOKMARK_BAR",action:e=>V.Z.toggleBookmarksBar(e.windowId),behavior:"checkbox",showInQC:!0,isEnabled:ae.Z,isVisible:e=>!W.ZP.isGuest(),category:"CATEGORY_COMMAND_APPEARANCE",guid:"42b84fc2-a9c1-425d-a08f-f349dbb6e8a6",...(0,K.Z)("Bookmarks Bar")},{name:"COMMAND_TOGGLE_APPLE_EVENTS",action:()=>A.Z.toggle(ie.kAllowJavascriptAppleEvents,!0,!1),inMenu:()=>de,showInQC:de,isEnabled:ae.Z,isVisible:()=>de,platforms:["mac"],category:"CATEGORY_COMMAND_APPLICATION",guid:"c8908d2a-9b77-4eb3-bdcf-327f5d78fe60",...(0,K.Z)("Apple Events")},{name:"COMMAND_TOGGLE_MENU_POSITION",action:()=>A.Z.toggle(ie.kMenuDisplay,"vivaldi","top"),inMenu:()=>!0,showInQC:!0,isEnabled:ae.Z,isVisible:()=>!0,platforms:["linux","windows"],behavior:"checkbox",category:"CATEGORY_COMMAND_APPEARANCE",guid:"6c186895-cfb1-4ce5-8d9b-21484a438ef6",...(0,K.Z)("command","Menu Position")},{name:"COMMAND_TOGGLE_FOOTER",action:e=>V.Z.toggleStatusBar(e.windowId),behavior:"checkbox",showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"ea570117-f29e-4fd2-b4de-649a4660a4f2",...(0,K.Z)("other","Status Bar")},{name:"COMMAND_TOGGLE_STARTPAGE_NAVIGATION",action:()=>A.Z.toggle(ie.kStartpageNavigation,"off","on"),behavior:"checkbox",showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"a1563471-d01b-4e7f-8a40-552120443cd5",...(0,K.Z)("other","Start Page Navigation")},{name:"COMMAND_TOGGLE_PRIVACY_STATS",action:()=>A.Z.toggle(ie.kStartpageSpeedDialPrivacyStatsShow,!1,!0),behavior:"checkbox",showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"dad8a820-629c-4146-b105-9ad0b3755b25",...(0,K.Z)("other","Show Privacy Statistics")},{name:"COMMAND_TOGGLE_INTERFACE_COLOR",action:()=>O.Z.setNextTheme(),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"0a9303d7-c8b0-4b0d-b6e0-02a5ba457360",...(0,K.Z)("Next Theme")},{name:"COMMAND_EXIT",action:e=>{j.Z.runtimePrivate.exit("menu"!==e.origin&&T.Z.get(ie.kSystemShowExitConfirmationDialog))},inMenu:()=>!0,showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"842121fd-5e5a-48f3-95ad-947d37aebedb",...(0,K.Z)("verb","Exit")},{name:"COMMAND_QUIT_MAC_MAYBE_WARN",action:()=>{},inMenu:()=>de,showInQC:!1,isEnabled:ae.Z,isVisible:()=>de,platforms:["mac"],category:"CATEGORY_COMMAND_APPLICATION",withNoWindow:!0,guid:"ff0ac033-0fcf-4c77-b664-7f7c3e4a2044",...(0,K.Z)("Quit $1",["Vivaldi"])},{name:"COMMAND_TOGGLE_WARN_ON_QUIT",action:()=>{A.Z.toggle(ie.kSystemShowExitConfirmationDialog,!0,!1)},behavior:"checkbox",showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"16b932e4-0a18-4c50-bcdf-089fd60fb1d8",...(0,K.Z)("Show Exit Confirmation Dialog")},{name:"COMMAND_SHOW_HELP",action:e=>w.ZP.openURL(e.windowId,"https://help.vivaldi.com/?pk_campaign=v-menu"),withNoWindow:!0,showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"643fde7b-ac28-4241-b0d0-bc221ee88785",...(0,K.Z)("browser","Vivaldi Help")},{name:"COMMAND_SHOW_KEYBOARDSHORTCUTS",action:e=>f.Z.showKeyboardShortcuts(e.windowId),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"12ab9d03-8327-4e5d-a905-609af0ab5528",...(0,K.Z)("Keyboard Cheat Sheet")},{name:"COMMAND_REPORT_BUG",action:e=>w.ZP.openURL(e.windowId,"https://help.vivaldi.com/desktop/troubleshoot/reporting-a-bug-in-vivaldi/?pk_campaign=v-menu"),withNoWindow:!0,showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"f9f6da04-7ebc-4fb4-8633-f122ca145217",...(0,K.Z)("Report a Problem")},{name:"COMMAND_SHOW_PAGE_ACCESS_KEYS",action:e=>f.Z.showPageAccessKeys(e.windowId),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"7838709a-7042-4913-b541-25ff2268f774",...(0,K.Z)("Show Webpage Access Key Shortcuts")},{name:"COMMAND_BREAKMODE_TOGGLE",action:e=>a.Z.toggleBreakMode(e.windowId),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"a3596917-8095-42e9-8efb-31ad8ad0cbaa",...(0,K.Z)("command","Break Mode")},{name:"COMMAND_START_CHROMECAST",action:e=>f.Z.startCasting(e.windowId),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"8b650af8-6342-48f5-a45b-2d56933fb389",...(0,K.Z)("Cast")},{name:"COMMAND_PROXY_TOGGLE",action:e=>Z.Z.toggle(),behavior:"checkbox",withNoWindow:!0,isEnabled:()=>E.ZP.getSupportsProxy(),isVisible:()=>E.ZP.getSupportsProxy(),showInQC:()=>E.ZP.getSupportsProxy(),inMenu:()=>E.ZP.getSupportsProxy(),category:"CATEGORY_COMMAND_APPLICATION",guid:"",...(0,K.Z)("Use Privacy Guard")},{name:"COMMAND_MAIN_TOGGLE_TAB_BAR",action:e=>V.Z.toggleTabs(e.windowId),behavior:"checkbox",showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"c4bfbdc9-1e24-4b60-bbfe-a706be090f7b",...(0,K.Z)("command","Tab Bar")},{name:"COMMAND_MAIN_TOGGLE_PANEL_TOGGLE",action:e=>V.Z.togglePanelToggle(e.windowId),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"1ad09f05-6a12-41e9-9bf3-ddf58f24bea4",...(0,K.Z)("Panel Toggle")},{name:"COMMAND_MAIN_TOGGLE_ADDRESS_BAR",action:e=>V.Z.toggleAddressBar(e.windowId),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"14fc610b-d5dc-49fc-973d-4d666394948b",...(0,K.Z)("other","Address Bar")},{name:"COMMAND_MAIN_TOGGLE_UI",action:e=>V.Z.toggleMinimalUI(e.windowId),behavior:"checkbox",showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"3b773be0-6af6-47f4-807c-19ad590693a2",...(0,K.Z)("Toggle UI")},{name:"COMMAND_CAPTURE_AREA_TO_DISK",action:e=>c.Z.captureArea(e.windowId,"file"),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"6ae02ffe-8039-4689-9e73-a7cd5ae792b3",...(0,K.Z)("Capture Area to File")},{name:"COMMAND_CAPTURE_AREA_TO_CLIPBOARD",action:e=>c.Z.captureArea(e.windowId,"clipboard"),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"2c2057eb-ec79-4d9e-a8de-5bbb0c2a6249",...(0,K.Z)("Capture Area to Clipboard")},{name:"COMMAND_FOCUS_NEXT",action:e=>f.Z.stepFocus(e.context,!0),repeat:!0,showInQC:!1,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"8202e8f1-c0d1-4a85-bbab-f66a52656a30",...(0,K.Z)("Focus Next Pane")},{name:"COMMAND_FOCUS_PREVIOUS",action:e=>f.Z.stepFocus(e.context,!1),repeat:!0,showInQC:!1,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"0dc4e130-6728-46e0-a632-3a2e7d817f2a",...(0,K.Z)("Focus Previous Pane")},{name:"COMMAND_NEW_TAB",action:e=>{const t="COMMAND_NEW_TAB";if(!p.Z.hasListener(t))return w.ZP.openURL(e.windowId,"");p.Z.onCommand(e.windowId,t)},withNoWindow:!0,showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"b3515e1b-9cf2-4ba0-ba34-fac6ce308b08",...(0,K.Z)("command","New Tab")},{name:"COMMAND_NEW_TAB_OUTSIDE_GROUP",action:e=>w.ZP.openURL(e.windowId,""),withNoWindow:!0,showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"4b4d97fa-f94d-4bc1-80b6-2849a56dbe42",...(0,K.Z)("command","New Top Level Tab")},{name:"COMMAND_NEW_BACKGROUND_TAB",action:e=>w.ZP.openURL(e.windowId,"",{inBackground:!0}),withNoWindow:!0,showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"5c2631d5-69cd-4bd5-b6e2-93b8a6ca0281",...(0,K.Z)("New Background Tab")},{name:"COMMAND_CLONE_TAB",action:e=>b.ZP.isSelecting(e.windowId)?w.ZP.clonePages(b.ZP.getSelectedPages(e.windowId)):w.ZP.clonePages(X.aV.of(b.ZP.getActivePage(e.windowId)).filter(Boolean)),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"74393bfb-4c31-4b25-afc4-471cb9d621ca",...(0,K.Z)("Duplicate Selected Tabs")},{name:"COMMAND_MOVE_TAB_TO_NEW_WINDOW",action:e=>{const t=b.ZP.getActivePage(e.windowId);t&&w.ZP.detachPage(t)},showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"d03d4bc8-26c4-49f6-b3ce-23980637ae76",...(0,K.Z)("Move Tab to New Window")},{name:"COMMAND_PIN_TAB",action:e=>w.ZP.toggleSelectedPagesPinned(e.windowId),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"8b413c0e-9024-4fbe-8813-68c76096c87b",...(0,K.Z)("Pin / Unpin Tab")},{name:"COMMAND_CLOSE_TAB",action:e=>w.ZP.close(e.windowId),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"f0a3a628-6977-4812-ab11-96a1d1fbc08d",...(0,K.Z)("Close Tab")},{name:"COMMAND_POSITION_TAB_TOP",action:()=>A.Z.set(ie.kTabsBarPosition,"top"),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"7be0e09e-a13a-4438-ad6b-2d43734e2a7d",...(0,K.Z)("Tabs on Top")},{name:"COMMAND_POSITION_TAB_BOTTOM",action:()=>A.Z.set(ie.kTabsBarPosition,"bottom"),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"1585fbcb-db49-4b0c-afd0-e3abc19456fd",...(0,K.Z)("Tabs on Bottom")},{name:"COMMAND_POSITION_TAB_LEFT",action:()=>A.Z.set(ie.kTabsBarPosition,"left"),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"35cac9b1-4c5e-433a-abbb-b69f123b26b9",...(0,K.Z)("Tabs on Left")},{name:"COMMAND_POSITION_TAB_RIGHT",action:()=>A.Z.set(ie.kTabsBarPosition,"right"),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"f3016405-4ac9-45a2-91d4-ddc8127cd9de",...(0,K.Z)("Tabs on Right")},{name:"COMMAND_CLOSE_TAB_TO_LEFT",action:e=>{const t=b.ZP.getActivePage(e.windowId);if(t){const n=b.ZP.isGroup((0,J.av)(t),e.windowId);w.ZP.closeToLeft(e.windowId,t,n)}},showInQC:!0,isVisible:(e,t)=>t||W.ZP.isTabbedBrowser(e),isEnabled:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"cd97956b-c939-4271-9037-1676c70e4fa4",...(0,K.Z)("Close Tabs to the Left")},{name:"COMMAND_CLOSE_TAB_TO_RIGHT",action:e=>{const t=b.ZP.getActivePage(e.windowId);if(t){const n=b.ZP.isGroup((0,J.av)(t),e.windowId);w.ZP.closeToRight(e.windowId,t,n)}},showInQC:!0,isVisible:(e,t)=>t||W.ZP.isTabbedBrowser(e),isEnabled:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"cfb3068d-5e79-4dac-a741-50879d4e81db",...(0,K.Z)("Close Tabs to the Right")},{name:"COMMAND_CLOSE_ALL_BUT_ACTIVE_TAB",action:e=>{const t=b.ZP.getActivePage(e.windowId);if(t){const n=W.ZP.getActiveWorkspace(e.windowId);w.ZP.closeOther(t,n,!1)}},showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"275ca3f7-ecfb-4445-bf87-686cd473536e",...(0,K.Z)("Close Other Tabs")},{name:"COMMAND_TAB_THUMBNAIL",action:e=>x.toggleTabThumbnail(e.windowId),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"c46c994e-81a8-4b4b-ae15-4e64a643af7b",...(0,K.Z)("Tab Thumbnail")},{name:"COMMAND_SHOW_ABOUT",action:e=>w.ZP.openURL(e.windowId,le.jk.internals.about),category:"CATEGORY_COMMAND_APPLICATION",withNoWindow:!0,isEnabled:ae.Z,isVisible:ae.Z,showInQC:!0,guid:"b5396606-e86b-4cca-bd74-029f3c538423",...(0,K.Z)("About")},{name:"COMMAND_CHECK_FOR_UPDATES",action:()=>j.Z.autoUpdate.checkForUpdates(!0),showInQC:e=>!W.ZP.isGuest()&&!0,isEnabled:ae.Z,isVisible:e=>!W.ZP.isGuest()&&!0,platforms:["windows","mac"],withNoWindow:!0,category:"CATEGORY_COMMAND_APPLICATION",guid:"b4ef4439-df4a-4634-95f7-509c95e42b69",...(0,K.Z)("Check for Updates")},{name:"COMMAND_SHOW_COMMUNITY",action:e=>w.ZP.openURL(e.windowId,"https://vivaldi.net/?pk_campaign=v-menu"),withNoWindow:!0,showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"cb626c77-47cd-46e3-9cf7-d976f50aadbd",...(0,K.Z)("Community Blogs")},{name:"COMMAND_TAB_SWITCH_BACK_SETTING",action:e=>x.switchTabBackBySetting(e.windowId,ce(e.param)?e.param:e.keyState),inMenu:re.Z,isEnabled:ae.Z,isVisible:ae.Z,repeat:!0,showInQC:!1,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"ee5eec5e-9ebf-4faf-b2ec-4fdba8b328d0",...(0,K.Z)("Tab Cycler Back")},{name:"COMMAND_TAB_SWITCH_FORWARD_SETTING",action:e=>x.switchTabForwardBySetting(e.windowId,ce(e.param)?e.param:e.keyState),inMenu:re.Z,repeat:!0,isEnabled:ae.Z,isVisible:ae.Z,showInQC:!1,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"7c2836f2-93e5-445f-9674-46a29759ff34",...(0,K.Z)("Tab Cycler Forward")},{name:"COMMAND_TAB_SWITCH_BACK_ORDER",action:e=>{const t=ce(e.param)?e.param:e.keyState;w.ZP.cycleByOrder(e.windowId,t,{goBack:!0})},repeat:!0,showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"9693c49b-29e0-442e-925d-d34d95f977a4",...(0,K.Z)("Previous Tab (by Order)")},{name:"COMMAND_TAB_SWITCH_FORWARD_ORDER",action:e=>{const t=ce(e.param)?e.param:e.keyState;w.ZP.cycleByOrder(e.windowId,t,{goBack:!1})},repeat:!0,showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"037d899d-b191-49c7-a932-87d8881d7037",...(0,K.Z)("Next Tab (by Order)")},{name:"COMMAND_TAB_SWITCH_FORWARD_HISTORY",action:e=>{const t=ce(e.param)?e.param:e.keyState;w.ZP.cycleByHistory(e.windowId,t,{goBack:!1})},repeat:!0,showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"a645ffdf-6235-425a-896e-3dfd8d4eebb1",...(0,K.Z)("Previous Tab (Recent)")},{name:"COMMAND_TAB_SWITCH_BACK_HISTORY",action:e=>{const t=ce(e.param)?e.param:e.keyState;w.ZP.cycleByHistory(e.windowId,t,{goBack:!0})},repeat:!0,showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"0c39ac37-1deb-4dc8-bea4-54672978af06",...(0,K.Z)("Next Tab (Recent)")},{name:"COMMAND_TAB_MOVE_FIRST",action:e=>p.Z.onCommand(e.windowId,"COMMAND_TAB_MOVE_FIRST"),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"d15338f7-43e6-4e36-b813-aaab299554df",...(0,K.Z)("Move Tabs to Beginning")},{name:"COMMAND_TAB_MOVE_END",action:e=>p.Z.onCommand(e.windowId,"COMMAND_TAB_MOVE_END"),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"478e7f24-51b6-499e-be8d-eda14148f4a7",...(0,K.Z)("Move Tabs to End")},{name:"COMMAND_TAB_MOVE_BACKWARD",action:e=>{const t=b.ZP.getActivePage(e.windowId);t&&w.ZP.stepPage(t,!1,"dotted"===T.Z.get(ie.kTabsStackingMode),e.windowId)},showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"bb5e2bde-67dd-40ff-9d87-43032f048b7a",...(0,K.Z)("Move Active Tab Backward")},{name:"COMMAND_TAB_MOVE_FORWARD",action:e=>{const t=b.ZP.getActivePage(e.windowId);t&&w.ZP.stepPage(t,!0,"dotted"===T.Z.get(ie.kTabsStackingMode),e.windowId)},showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"8338b153-b32d-4a29-962e-cb3bbc5861d0",...(0,K.Z)("Move Active Tab Forward")},{name:"COMMAND_TAB_DISABLE_ALL_RELOADS",action:e=>{"button"===e.origin?k.Z.destroyAllPanelPeriodicAlarms():k.Z.destroyTabPeriodicAlarms(e.windowId)},showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"7d40d732-b025-4722-bc23-b66ada752339",...(0,K.Z)("Disable Periodic Timers")},{name:"COMMAND_TAB_PERIODIC_RELOAD",action:async e=>{if(e.param){const t=(0,ee.AE)(e.param),n=b.ZP.getActivePage(e.windowId);if(n){const e=n.vivExtData.ext_id;if(e){const n=t/60;await k.Z.createPeriodicReloadAlarm({id:e,interval:n,from:"tab"})}}}},showInQC:!0,inMenu:re.Z,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"bf7a3a4a-565a-46c7-835c-fa2a6d4b7fdf",...(0,K.Z)("tab","Periodic Reload")},{name:"COMMAND_PAGE_COPY_ALL_URLS",action:e=>w.ZP.copyAllUrls(e.windowId,W.ZP.getActiveWorkspace(e.windowId)),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"259f485f-3892-43e3-b29e-e8f4ccb29a5e",...(0,K.Z)("other","Copy All Links")},{name:"COMMAND_PAGE_SELECTION_CURRENT",action:e=>{const t=b.ZP.getActivePage(e.windowId);t&&w.ZP.setSelection(t)},showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"2cd718aa-76d4-4bd4-9c55-6117822d402e",...(0,K.Z)("other","Select Current Tab")},{name:"COMMAND_PAGE_SELECTION_EXPAND_PREVIOUS",action:e=>{const t=b.ZP.getActivePage(e.windowId);t&&w.ZP.expandSelectionPrevious(t)},showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"e245bce5-20a7-481f-910e-23bf1de86748",...(0,K.Z)("other","Select Previous Tab")},{name:"COMMAND_PAGE_SELECTION_EXPAND_NEXT",action:e=>{const t=b.ZP.getActivePage(e.windowId);t&&w.ZP.expandSelectionNext(t)},showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"23e27390-f1bf-4ec3-92b5-7634daeabc5b",...(0,K.Z)("other","Select Next Tab")},{name:"COMMAND_PAGE_SELECTION_TOGGLE_RELATED",action:e=>{const t=b.ZP.getActivePage(e.windowId);t&&w.ZP.toggleRelatedSelection(t)},showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"7ef25cfa-632f-4872-832c-ca6c9dfb5769",...(0,K.Z)("other","Select Related Tabs")},{name:"COMMAND_PAGE_SELECTION_CLEAR",action:e=>w.ZP.clearSelection(e.windowId),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"cf44c36e-ab42-4700-a80e-93f5f504c72b",...(0,K.Z)("other","Deselect Tabs")},{name:"COMMAND_RENAME_TAB_STACK",action:e=>p.Z.onCommand(e.windowId,"COMMAND_RENAME_TAB_STACK"),showInQC:!0,isEnabled:ae.Z,isVisible:(e,t)=>{if(t)return!0;{const t=b.ZP.getActivePage(e);return!!t&&b.ZP.isGroup((0,J.av)(t),e)}},category:"CATEGORY_COMMAND_TAB_ACTION",guid:"a453b19c-8c8e-48e4-8e5b-f9d494086b0d",...(0,K.Z)("Rename Tab Stack")},{name:"COMMAND_TAB_SWITCH_1",action:e=>w.ZP.activateTabByIndex(e.windowId,0),showInQC:!1,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"a4d46cc3-e258-4c20-ab39-3174ec9acbb9",...(0,K.Z)("Switch to Tab 1")},{name:"COMMAND_TAB_SWITCH_2",action:e=>w.ZP.activateTabByIndex(e.windowId,1),showInQC:!1,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"3a792281-c3a3-4501-b64c-b5173206195d",...(0,K.Z)("Switch to Tab 2")},{name:"COMMAND_TAB_SWITCH_3",action:e=>w.ZP.activateTabByIndex(e.windowId,2),showInQC:!1,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"5e570a93-4779-4266-aebe-f2abe0e081ae",...(0,K.Z)("Switch to Tab 3")},{name:"COMMAND_TAB_SWITCH_4",action:e=>w.ZP.activateTabByIndex(e.windowId,3),showInQC:!1,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"34281a36-77c7-4f3c-99e1-73529174cfb6",...(0,K.Z)("Switch to Tab 4")},{name:"COMMAND_TAB_SWITCH_5",action:e=>w.ZP.activateTabByIndex(e.windowId,4),showInQC:!1,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"71cd67b0-77bb-4cf3-a7ee-8e26462eb42e",...(0,K.Z)("Switch to Tab 5")},{name:"COMMAND_TAB_SWITCH_6",action:e=>w.ZP.activateTabByIndex(e.windowId,5),showInQC:!1,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"d8b8a23c-f47b-4341-8adc-844cc52562b1",...(0,K.Z)("Switch to Tab 6")},{name:"COMMAND_TAB_SWITCH_7",action:e=>w.ZP.activateTabByIndex(e.windowId,6),showInQC:!1,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"c537cc07-a3ff-4151-997c-40e25056e65d",...(0,K.Z)("Switch to Tab 7")},{name:"COMMAND_TAB_SWITCH_8",action:e=>w.ZP.activateTabByIndex(e.windowId,7),showInQC:!1,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"710bb550-7dea-4436-9d0c-fea152299507",...(0,K.Z)("Switch to Tab 8")},{name:"COMMAND_TAB_SWITCH_9",action:e=>w.ZP.activateTabByIndex(e.windowId,8),showInQC:!1,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"91f469f5-f527-433c-a1fa-2e3f399c7820",...(0,K.Z)("Switch to Tab 9")},{name:"COMMAND_TAB_SWITCH_LAST",action:e=>w.ZP.openLastPage(e.windowId),showInQC:!1,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"750d7779-97ec-493d-afa8-a62c179d6d82",...(0,K.Z)("Switch to the Last Tab")},{name:"COMMAND_HIBERNATE_OTHER_TABS",action:e=>(0,ee.Xf)(e.windowId),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"62655c2c-509d-40f9-aec9-d4428af56884",...(0,K.Z)("Hibernate Background Tabs")},{name:"COMMAND_SHOW_CLOSED_TABS",action:e=>p.Z.onCommand(e.windowId,"COMMAND_SHOW_CLOSED_TABS"),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"ba89f260-0036-4f93-95aa-11b65790621d",...(0,K.Z)("Show Closed Tabs")},{name:"COMMAND_TAB_REOPEN_RECENTLY_CLOSED",action:()=>B.Z.undeletePreviousTab(),tweakedShortcut:"ctrl+z",withNoWindow:!0,showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"7e925f03-11a3-47b4-b092-e1c355661796",...(0,K.Z)("Reopen Closed Tab")},{name:"COMMAND_TAB_STACK_TILE_VERTICAL",action:e=>x.stackTileVertical(e.windowId),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"854f8a44-50bd-41bc-8277-acd51e719d1b",...(0,K.Z)("Tile Vertically")},{name:"COMMAND_TAB_STACK_TILE_HORIZONTAL",action:e=>x.stackTileHorizontal(e.windowId),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"2991fb16-2df8-42b5-898a-25a0d028ac41",...(0,K.Z)("Tile Horizontally")},{name:"COMMAND_TAB_STACK_TILE_GRID",action:e=>x.stackTileGrid(e.windowId),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"83c2d2d0-a53b-4521-82b5-4c2e61ed024b",...(0,K.Z)("Tile to Grid")},{name:"COMMAND_DISBAND_TILE_GROUP",action:e=>x.disbandTileGroup(e.windowId),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"a0294e45-6204-406e-b456-2664e4d23b24",...(0,K.Z)("Untile Tabs")},{name:"COMMAND_TAB_STACK_CREATE",action:e=>x.stackCreate(e.windowId),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"cdd99010-5477-4508-aa28-d671de35dcb2",...(0,K.Z)("Stack Tabs")},{name:"COMMAND_TAB_STACK_DISSOLVE",action:e=>x.stackDissolve(e.windowId),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"61ab7d82-7602-4f72-9f00-07a426ff47c1",...(0,K.Z)("Unstack Tabs")},{name:"COMMAND_TAB_STACK_REMOVE",action:e=>x.stackRemove(e.windowId),showInQC:!0,category:"CATEGORY_COMMAND_TAB_ACTION",isEnabled:ae.Z,isVisible:ae.Z,guid:"56cf9bd1-63b1-4ebf-92b0-c909e5d479c6",...(0,K.Z)("Remove from Tab Stack")},{name:"COMMAND_TAB_STACK_CLOSE",action:e=>{const t=b.ZP.getActivePage(e.windowId);t&&w.ZP.closeTabStack(t.id)},showInQC:!0,category:"CATEGORY_COMMAND_TAB_ACTION",isEnabled:ae.Z,isVisible:(e,t)=>{if(t)return!0;{const t=b.ZP.getActivePage(e);return!!t&&b.ZP.isGroup((0,J.av)(t),e)}},guid:"44fabfe1-fd65-4e7e-a540-5e4d6c742ab8",...(0,K.Z)("Close Tab Stack")},{name:"COMMAND_TAB_STACK_RELOAD",action:async e=>{const t=b.ZP.getActivePage(e.windowId),n=t?(0,J.av)(t):null,s=b.ZP.getGroup(n,e.windowId);t&&s.size>1&&await Promise.all(s.map((async t=>{F.Z.reload(e.windowId,t.id,!1)})))},showInQC:!0,category:"CATEGORY_COMMAND_TAB_ACTION",isEnabled:ae.Z,isVisible:(e,t)=>{if(t)return!0;{const t=b.ZP.getActivePage(e);return!!t&&b.ZP.isGroup((0,J.av)(t),e)}},guid:"7eef8423-ea56-4df8-bad4-e3eccd57c8b6",...(0,K.Z)("Reload Tab Stack")},{name:"COMMAND_TOGGLE_MOUSE_GESTURES",action:()=>A.Z.toggle(ie.kMouseGesturesEnabled,!0,!1),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"01f9d07d-5ec6-41a4-927c-129cef008d65",...(0,K.Z)("Toggle Mouse Gestures")},{name:"COMMAND_TOGGLE_IMAGES",action:e=>{const t=b.ZP.getActivePage(e.windowId);t&&w.ZP.toggleImageLoading(t)},showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"6777b0a7-25d2-4e5e-a4e1-b5fcc0fcdef8",...(0,K.Z)("other","Load Images")},{name:"COMMAND_SET_LOAD_IMAGES_ALWAYS",action:e=>{const t=b.ZP.getActivePage(e.windowId);t&&w.ZP.setImageLoading(t,"always")},behavior:"radio",showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"8d1f63a0-6e3c-42dd-a1b8-9a740f65bafe",...(0,K.Z)("other","Images On")},{name:"COMMAND_SET_LOAD_IMAGES_NEVER",action:e=>{const t=b.ZP.getActivePage(e.windowId);t&&w.ZP.setImageLoading(t,"never")},behavior:"radio",showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"e346b0a7-74c6-4e69-952e-420d33e54a8e",...(0,K.Z)("other","Images Off")},{name:"COMMAND_SET_LOAD_IMAGES_CACHE",action:e=>{const t=b.ZP.getActivePage(e.windowId);t&&w.ZP.setImageLoading(t,"cache")},behavior:"radio",showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"f016e79c-a799-465f-9d01-2869a751774c",...(0,K.Z)("other","Load Images From Cache")},{name:"COMMAND_SET_ANIMATIONS_LOOP",action:()=>$.Z.accessibilityFeatures.animationPolicy.set({value:"allowed"},(()=>{})),behavior:"radio",category:"CATEGORY_COMMAND_TAB_ACTION",isEnabled:ae.Z,isVisible:ae.Z,showInQC:!0,guid:"080beb50-b815-4416-8a69-246907b2805a",...(0,K.Z)("other","Loop Animations")},{name:"COMMAND_SET_ANIMATIONS_NEVER",action:()=>$.Z.accessibilityFeatures.animationPolicy.set({value:"none"},(()=>{})),behavior:"radio",showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"1d4df136-9d8e-4541-b0b9-1a66a5b23444",...(0,K.Z)("other","No Animations")},{name:"COMMAND_SET_ANIMATIONS_ONCE",action:()=>$.Z.accessibilityFeatures.animationPolicy.set({value:"once"},(()=>{})),behavior:"radio",showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"8159b932-9a12-4cef-bf84-f046ab3a2030",...(0,K.Z)("other","Play Animations Once")},{name:"COMMAND_PAGE_TOGGLE_MUTE",action:e=>{const t=b.ZP.getActivePage(e.windowId);t&&w.ZP.toggleMuting(e.windowId,X.aV.of(t))},showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"a6f425df-46e7-48f9-8be2-3b03329fa8d0",...(0,K.Z)("Mute / Unmute Tab")},{name:"COMMAND_PAGE_MUTE_OTHER",action:e=>w.ZP.setMuting(e.windowId,"other","mute"),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"4cb148ba-cb83-4e4a-be3e-43b60a3f3982",...(0,K.Z)("Mute Other Tabs")},{name:"COMMAND_PAGE_MUTE_ALL",action:e=>w.ZP.setMuting(e.windowId,"all","mute"),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"431a57f8-a637-41e5-a4de-1b1c3be081db",...(0,K.Z)("Mute All Tabs")},{name:"COMMAND_PAGE_UNMUTE_OTHER",action:e=>w.ZP.setMuting(e.windowId,"other","unmute"),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"4dc07cbf-4c8b-42ed-8117-c123834a76c5",...(0,K.Z)("Unmute Other Tabs")},{name:"COMMAND_PAGE_UNMUTE_ALL",action:e=>w.ZP.setMuting(e.windowId,"all","unmute"),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"9badb24d-1a7b-46fd-8e95-d50f93812911",...(0,K.Z)("Unmute All Tabs")},{name:"COMMAND_CAPTURE_PAGE_TO_DISK",action:e=>c.Z.captureActivePage(e.windowId,"file"),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"2fe0abe5-421c-4d9d-83ef-16e9f9deb9bb",...(0,K.Z)("Capture Page to File")},{name:"COMMAND_CAPTURE_PAGE_TO_CLIPBOARD",action:e=>c.Z.captureActivePage(e.windowId,"clipboard"),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"2a8349df-be2b-44e8-8db9-4f349a470790",...(0,K.Z)("Capture Page to Clipboard")},{name:"COMMAND_TAB_TRANSLATE_PAGE",action:e=>{const t=b.ZP.getActivePage(e.windowId);if(t&&g.ZP.canTranslatePage(t.id))return R.Z.translatePage(t.id)},isEnabled:ae.Z,isVisible:(e,t)=>{if(t)return!0;{const t=b.ZP.getActivePage(e);return!!t&&g.ZP.canTranslatePage(t.id)}},showInQC:!0,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"8d7a4844-f2d5-4cfe-abcd-e2fd99005a41",...(0,K.Z)("tab","Translate Page")},{name:"COMMAND_IMPORT_DATA",action:e=>f.Z.showImportDataDialog(e.windowId),isEnabled:ae.Z,isVisible:e=>!W.ZP.isGuest(),showInQC:!0,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"6c851825-1e73-4ec5-ad5e-2ec9c826524c",...(0,K.Z)("command","Import from Applications or Files")},{name:"COMMAND_EXPORT_DATA",action:e=>j.Z.bookmarksPrivate.export(e.windowId),isEnabled:ae.Z,isVisible:e=>!W.ZP.isGuest(),showInQC:!0,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"fba8ba2b-f317-463a-b685-6d3fb7040845",...(0,K.Z)("Export Bookmarks")},{name:"COMMAND_EXPORT_NOTES",action:e=>(0,q.aT)(e.windowId),showInQC:!0,isEnabled:ae.Z,isVisible:e=>!W.ZP.isGuest(),category:"CATEGORY_COMMAND_APPLICATION",guid:"fe0e224c-a903-4952-ae3d-d69d8777c24a",...(0,K.Z)("Export Notes")},{name:"COMMAND_IMPORT_NOTES",action:e=>(0,q.T$)(e.windowId),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"db20661f-37e9-4376-94c8-9aebc7a27628",...(0,K.Z)("Import Notes")},{name:"COMMAND_NEW_TAB_LINK",action:e=>{"string"==typeof e.param&&w.ZP.openURL(e.windowId,e.param,{addOpenerTabId:!0})},inMenu:re.Z,isEnabled:ae.Z,isVisible:ae.Z,showInQC:!1,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"62966533-b4f6-4f86-a02c-9753948c6277",...(0,K.Z)("Open Link in New Tab (Over a Link)")},{name:"COMMAND_NEW_BACKGROUND_TAB_LINK",action:e=>{"string"==typeof e.param&&w.ZP.openURL(e.windowId,e.param,{inBackground:!0,addOpenerTabId:!0})},inMenu:re.Z,isEnabled:ae.Z,isVisible:ae.Z,showInQC:!1,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"db3df40a-0d5f-4f87-a57a-cf9640e401c3",...(0,K.Z)("Open Link in Background Tab (Over a Link)")},{name:"COMMAND_READERVIEW_TOGGLE",action:e=>{const t=b.ZP.getActivePage(e.windowId);t&&_.Z.toggleReaderMode(t)},showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"8dd47fc9-4c1f-4487-a475-f55bfa61aaf2",...(0,K.Z)("Toggle Reader View")},{name:"COMMAND_BOOKMARK_SELECTED_TABS",action:e=>p.Z.onCommand(e.windowId,"COMMAND_BOOKMARK_SELECTED_TABS"),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"12bef254-49e1-4205-b14e-acd4d3b4238b",...(0,K.Z)("Bookmark Selected Tabs")},{name:"COMMAND_SAVE_SESSION",action:e=>f.Z.showSaveSessionDialog(e.windowId,{mode:"all"}),isEnabled:ae.Z,isVisible:e=>!W.ZP.isGuest(),showInQC:!0,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"ec8eb1b8-53ef-48f8-bbdc-d0c44af2d5cd",...(0,K.Z)("command","Save All Tabs as Session")},{name:"COMMAND_SAVE_SELECTED_SESSION",action:e=>p.Z.onCommand(e.windowId,"COMMAND_SAVE_SELECTED_SESSION"),isEnabled:ae.Z,isVisible:e=>!W.ZP.isGuest(),showInQC:!0,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"0fe4c500-31cf-4d73-8dc1-281eb4259fe7",...(0,K.Z)("command","Save Selected Tabs as Session")},{name:"COMMAND_OPEN_SESSION",action:e=>f.Z.showOpenSessionDialog(e.windowId),isEnabled:ae.Z,isVisible:e=>!W.ZP.isGuest(),showInQC:!0,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"4a65bd2a-ec3c-42ca-ac7a-67040fe8cebc",...(0,K.Z)("Open Saved Session")},{name:"COMMAND_ADD_BOOKMARK",action:e=>{const t=b.ZP.getActivePage(e.windowId);t&&F.Z.doAction(e.windowId,t.id,"addBookmark")},isEnabled:ae.Z,isVisible:e=>!W.ZP.isGuest(),showInQC:!0,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"844219eb-ed35-4b17-a9f4-7789466c233c",...(0,K.Z)("Create Bookmark")},{name:"COMMAND_ADD_TO_READING_LIST",action:e=>M.Z.addSeveral(e.windowId,b.ZP.getSelectedPages(e.windowId)),isEnabled:ae.Z,isVisible:e=>!W.ZP.isGuest(),showInQC:!0,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"a73687bc-ddc6-4011-9255-d2ff6a742279",...(0,K.Z)("Add Page to Reading List")},{name:"COMMAND_BLOCK_TRACKING",action:e=>{const t=b.ZP.getActivePage(e.windowId);t&&(0,Q.Fe)(t.id,t.url,"tracking")},isEnabled:ae.Z,isVisible:e=>!W.ZP.isGuest(),showInQC:!0,category:"CATEGORY_COMMAND_APPLICATION",guid:"9afb77f2-d3d3-4596-8a04-58ab48a345fa",...(0,K.Z)("Block / Unblock Tracking")},{name:"COMMAND_BLOCK_TRACKING_AND_ADS",action:e=>{const t=b.ZP.getActivePage(e.windowId);t&&(0,Q.Fe)(t.id,t.url,"ad_blocking")},isEnabled:ae.Z,isVisible:e=>!W.ZP.isGuest(),showInQC:!0,category:"CATEGORY_COMMAND_APPLICATION",guid:"da2af162-2140-4aae-8366-3add4793ac17",...(0,K.Z)("Block / Unblock Ads and Tracking")},{name:"COMMAND_FOCUS_ADDRESSFIELD",action:e=>{const t=b.ZP.getActivePage(e.windowId);t&&F.Z.doAction(e.windowId,t.id,"focusAddressField")},showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"96a396d8-d485-4f61-926b-bdab1eddaf94",...(0,K.Z)("Focus Address Field")},{name:"COMMAND_SHOW_DOWNLOADS_POPOUT",action:e=>p.Z.onCommand(e.windowId,"COMMAND_SHOW_DOWNLOADS_POPOUT"),showInQC:!0,category:"CATEGORY_COMMAND_APPLICATION",guid:"a1244975-7c9b-465d-90cf-da919d4598bf",isEnabled:ae.Z,isVisible:e=>(0,te.PK)("DownloadButton",e),...(0,K.Z)("Open Downloads Popup")},{name:"COMMAND_PAGE_REFRESH",action:e=>{const t=b.ZP.getActivePage(e.windowId);t&&F.Z.reload(e.windowId,t.id,!1)},showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"bc31a027-870d-40ba-b3f1-20adcff8fff2",...(0,K.Z)("Reload Page")},{name:"COMMAND_PAGE_RELOAD_NOCACHE",action:e=>{const t=b.ZP.getActivePage(e.windowId);t&&F.Z.reload(e.windowId,t.id,!0)},showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"d92c060c-a9f7-490c-a4a0-8c5cccfa09dd",...(0,K.Z)("Force Page Reload")},{name:"COMMAND_PAGE_SCROLL_UP",action:e=>{const t=b.ZP.getActivePage(e.windowId);t&&F.Z.doAction(e.windowId,t.id,"pageScrollUp")},repeat:!0,showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"078f10b2-1901-4f9e-97b3-1018f7633099",...(0,K.Z)("Page Up")},{name:"COMMAND_PAGE_SCROLL_DOWN",action:e=>{const t=b.ZP.getActivePage(e.windowId);t&&F.Z.doAction(e.windowId,t.id,"pageScrollDown")},repeat:!0,showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"eae41430-4ed9-48e5-9e91-90aeefdb4b4e",...(0,K.Z)("Page Down")},{name:"COMMAND_PAGE_SCROLL_TOP",action:e=>{const t=b.ZP.getActivePage(e.windowId);t&&F.Z.doAction(e.windowId,t.id,"pageScrollTop")},showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"f74cd1f0-c90c-4a2e-8b7b-f06d88cad75a",...(0,K.Z)("Scroll Page to Top")},{name:"COMMAND_PAGE_SCROLL_BOTTOM",action:e=>{const t=b.ZP.getActivePage(e.windowId);t&&F.Z.doAction(e.windowId,t.id,"pageScrollBottom")},showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"29bbb63b-b356-4dfe-aa45-9cf39d94d279",...(0,K.Z)("Scroll Page to Bottom")},{name:"COMMAND_FOCUS_WEBVIEW",action:e=>{const t=b.ZP.getActivePage(e.windowId);t&&F.Z.doAction(e.windowId,t.id,"focusWebView")},showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"f71373d5-f966-4603-b7c5-a4a1722b3989",...(0,K.Z)("Focus Page")},{name:"COMMAND_PAGE_DISABLE_KEYBOARD_SHORTCUTS",action:()=>A.Z.toggle(ie.kKeyboardShortcutsEnable,!0,!1),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"88d6a31d-9d50-4c8f-a9a2-207ac2b600c3",...(0,K.Z)("Disable Keyboard Shortcuts")},{name:"COMMAND_FOCUS_SEARCHFIELD",action:e=>{const t=b.ZP.getActivePage(e.windowId);t&&F.Z.doAction(e.windowId,t.id,"focusSearchField")},showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"eead069f-a0b5-4f2c-add7-051003353311",...(0,K.Z)("Focus Search Field")},{name:"COMMAND_FIND_IN_PAGE",action:e=>{const t=b.ZP.getActivePage(e.windowId);t&&F.Z.doAction(e.windowId,t.id,"findInPage")},showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"3686e24b-c64b-4402-9b79-d58dc92c29a8",...(0,K.Z)("Find in Page")},{name:"COMMAND_FIND_NEXT_IN_PAGE",action:e=>{const t=b.ZP.getActivePage(e.windowId);t&&F.Z.doAction(e.windowId,t.id,"findNextInPage")},repeat:!0,showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"055c6e9c-2b9c-4170-aeb0-43f3caf35c3e",...(0,K.Z)("Find Next in Page")},{name:"COMMAND_FIND_PREVIOUS_IN_PAGE",action:e=>{const t=b.ZP.getActivePage(e.windowId);t&&F.Z.doAction(e.windowId,t.id,"findPreviousInPage")},repeat:!0,showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"ef2ad516-3e00-4e9f-9dc3-b1bccd1cc317",...(0,K.Z)("Find Previous in Page")},{name:"COMMAND_PAGE_BACK",action:e=>{const t=b.ZP.getActivePage(e.windowId);t&&F.Z.back(e.windowId,t.id)},showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"f8f93b48-b1ed-43c3-bd65-e7240fd76d3f",...(0,K.Z)("History Back")},{name:"COMMAND_PAGE_FORWARD",action:e=>{const t=b.ZP.getActivePage(e.windowId);t&&F.Z.forward(e.windowId,t.id)},showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"b00e2d3c-a9ba-49b8-bce7-1faf1894a5f3",...(0,K.Z)("History Forward")},{name:"COMMAND_PAGE_REWIND",action:e=>u.Z.navigateRewind(e.windowId),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"67c60e96-fab2-433b-a012-107daa3856ef",...(0,K.Z)("History Rewind")},{name:"COMMAND_PAGE_FAST_FORWARD",action:e=>u.Z.navigateFastforward(e.windowId),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"964655e4-0274-4e26-82a7-b15161958009",...(0,K.Z)("Fast Forward")},{name:"COMMAND_GO_TO_PARENT_DIRECTORY",action:e=>{const t=b.ZP.getActivePage(e.windowId);t&&w.ZP.gotoParentDirectory(e.windowId,t)},showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"c74300b6-635c-4471-b930-8707f29aa94c",...(0,K.Z)("Go to Parent Directory")},{name:"COMMAND_PRINT_PAGE",action:e=>{const t=b.ZP.getActivePage(e.windowId);t&&F.Z.doAction(e.windowId,t.id,"print")},showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"9fbbe402-d11b-479d-ab97-e7e6deb10d36",...(0,K.Z)("Print")},{name:"COMMAND_STOP_PAGE",action:e=>{const t=b.ZP.getActivePage(e.windowId);t&&F.Z.stop(e.windowId,t.id)},showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"77dfb30f-d825-4089-a042-c3f664c656b5",...(0,K.Z)("Stop Loading")},{name:"COMMAND_OPEN_PAGE",action:e=>{j.Z.utilities.openPage(e.windowId)},withNoWindow:!0,showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"e513ed70-7241-4722-83cb-4e8d10da8f02",...(0,K.Z)("a file","Open File")},{name:"COMMAND_SAVE_PAGE",action:e=>{const t=b.ZP.getActivePage(e.windowId);t&&(0,oe.Jq)(e.windowId,t.id)},showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"a60f2f63-dd5a-46a6-b425-40e423e88fc0",...(0,K.Z)("Save Page As")},{name:"COMMAND_SEARCH_WITH_SELECTION",action:e=>N.Z.withPageSelection(e.windowId),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"1599c08b-51f2-413b-a572-dcacb43560b2",...(0,K.Z)("Search with Selection")},{name:"COMMAND_DEFAULT_MAIN_ZOOM",action:e=>{"number"==typeof e.param&&H.Z.setDefaultWebPageZoom(e.param)},category:"CATEGORY_COMMAND_APPEARANCE",isEnabled:ae.Z,isVisible:ae.Z,showInQC:!0,guid:"e918fdc6-64f0-47a1-aa29-d0f057dedb60",...(0,K.Z)("Default Page Zoom")},{name:"COMMAND_MAIN_ZOOM",action:e=>{"number"==typeof e.param&&H.Z.setPageZoomPercentage(e.windowId,e.param)},category:"CATEGORY_COMMAND_APPEARANCE",isEnabled:ae.Z,isVisible:ae.Z,showInQC:!0,guid:"9a6682a0-9a28-4e44-b9f9-fc554f02c363",...(0,K.Z)("Page Zoom")},{name:"COMMAND_MAIN_ZOOM_IN",action:e=>H.Z.pageZoomIn(e.windowId),isEnabled:ae.Z,isVisible:ae.Z,showInQC:!0,category:"CATEGORY_COMMAND_APPEARANCE",guid:"9f04836a-e0cb-4220-93dd-57d0a606ee11",...(0,K.Z)("Page Zoom In")},{name:"COMMAND_MAIN_ZOOM_OUT",action:e=>H.Z.pageZoomOut(e.windowId),isEnabled:ae.Z,isVisible:ae.Z,showInQC:!0,category:"CATEGORY_COMMAND_APPEARANCE",guid:"f68b5e96-3c0c-49cb-a8f9-d23b43182bc0",...(0,K.Z)("Page Zoom Out")},{name:"COMMAND_MAIN_ZOOM_HALF",action:e=>H.Z.pageZoomHalf(e.windowId),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"d5959c06-f090-4f5e-8470-7871986393ab",...(0,K.Z)("Page Zoom Out Half")},{name:"COMMAND_MAIN_ZOOM_DOUBLE",action:e=>H.Z.pageZoomDouble(e.windowId),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"dd72265d-01e1-483e-a50f-5b018ca20151",...(0,K.Z)("Page Zoom In Double")},{name:"COMMAND_MAIN_ZOOM_RESET",action:e=>H.Z.pageZoomReset(e.windowId),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"483984bb-e647-4ed5-aae8-f82ef947b450",...(0,K.Z)("Page Zoom Reset")},{name:"COMMAND_MAIN_UI_ZOOM",action:e=>{"number"==typeof e.param&&H.Z.setUIZoomPercentage(e.param)},category:"CATEGORY_COMMAND_APPEARANCE",showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,guid:"6884b1a9-0cfc-4456-8d1b-9cb73c99703f",...(0,K.Z)("UI Zoom")},{name:"COMMAND_MAIN_UI_ZOOM_IN",action:()=>H.Z.uiZoomIn(),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"b56f4b61-eff8-4d57-af15-a19fba06c587",...(0,K.Z)("UI Zoom In")},{name:"COMMAND_MAIN_UI_ZOOM_OUT",action:()=>H.Z.uiZoomOut(),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"d62013de-e829-4454-ab03-71a864341009",...(0,K.Z)("UI Zoom Out")},{name:"COMMAND_MAIN_UI_ZOOM_RESET",action:()=>H.Z.setUIZoomPercentage(100),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"a62aaffc-305b-4892-90c3-5839c0650260",...(0,K.Z)("UI Zoom Reset")},{name:"COMMAND_TAB_VIEW_PAGE_SOURCE",action:e=>{b.ZP.getActivePage(e.windowId)?.isMailPage?p.Z.onCommand(e.windowId,"COMMAND_TAB_VIEW_PAGE_SOURCE"):x.viewPageSource(e.windowId)},showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"7c42ad51-fab5-46c5-acff-663947a13c96",...(0,K.Z)("View Page Source")},{name:"COMMAND_DEVELOPER_TOOLS",action:e=>j.Z.devtoolsPrivate.toggleDevtools(e.windowId,"default"),showInQC:!0,isEnabled:ae.Z,isVisible:e=>!b.ZP.isActiveInternal(e),category:"CATEGORY_COMMAND_APPLICATION",guid:"cdc3b594-d57f-417d-89ee-69be8facd3aa",...(0,K.Z)("Developer Tools")},{name:"COMMAND_DEVTOOLS_INSPECTOR",action:e=>j.Z.devtoolsPrivate.toggleDevtools(e.windowId,"inspect"),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"e6a1c7d5-21ad-4195-bc9e-95ebcb6ee2eb",...(0,K.Z)("Toggle Developer Tools")},{name:"COMMAND_DEVTOOLS_CONSOLE",action:e=>j.Z.devtoolsPrivate.toggleDevtools(e.windowId,"console"),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"1e335c06-1036-4b76-be45-20fea16ab840",...(0,K.Z)("Developer Tools Console")},{name:"COMMAND_SHOW_HOMEPAGE",action:e=>w.ZP.showHomepage(e.windowId,{inCurrent:!0}),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"51eac690-a178-4a3e-99dd-32c73f923559",...(0,K.Z)("title","Homepage")},{name:"COMMAND_TOGGLE_PANEL",action:e=>S.Z.togglePanel(e.windowId),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"5cbd037c-973a-4c3d-aa43-5454bc0ec0e4",...(0,K.Z)("command","Panel")},{name:"COMMAND_FOCUS_PANEL",action:e=>S.Z.setFocus(e.windowId),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"efaed294-3e8e-42fa-9a47-d121e6a11e5f",...(0,K.Z)("Focus Panel")},{name:"COMMAND_FOCUS_PANELBAR",action:e=>p.Z.onCommand(e.windowId,"COMMAND_FOCUS_PANELBAR"),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"454b1c03-0570-4977-99e8-337a1aafdb70",...(0,K.Z)("Focus Panel Controls")},{name:"COMMAND_FOCUS_MAINMENU",action:e=>p.Z.onCommand(e.windowId,"COMMAND_FOCUS_MAINMENU"),inMenu:()=>!0,showInQC:!0,isEnabled:ae.Z,isVisible:()=>!0,platforms:["linux","windows"],category:"CATEGORY_COMMAND_APPEARANCE",guid:"bb1fc5ee-68bd-4e4f-ae16-43269ada0f69",...(0,K.Z)("Focus Main Menu")},{name:"COMMAND_FOCUS_BOOKMARKBAR",action:e=>p.Z.onCommand(e.windowId,"COMMAND_FOCUS_BOOKMARKBAR"),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"d2c3cb39-c495-4aca-bac5-23f2db06ccca",...(0,K.Z)("Focus Bookmarks Bar")},{name:"COMMAND_FOCUS_TABBAR",action:e=>p.Z.onCommand(e.windowId,"COMMAND_FOCUS_TABBAR"),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"ab5fd96a-effc-448f-afdf-2bef8cba6527",...(0,K.Z)("Focus Tab Bar")},{name:"COMMAND_TOGGLE_FLOATING_PANEL",action:()=>S.Z.toggleFloating(),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"b70131d8-1022-411e-89aa-096a8528ab45",...(0,K.Z)("Toggle Floating Panel")},{name:"COMMAND_SHOW_NEXT_PANEL",action:e=>S.Z.showNextPanel(e.windowId,"next"),showInQC:!0,isEnabled:ae.Z,isVisible:(e,t)=>t||Boolean(I.ZP.getNextPanel(e,"next")),category:"CATEGORY_COMMAND_APPEARANCE",guid:"302fdcd3-d914-418f-895d-c4ede9b6c02e",...(0,K.Z)("Open Next Panel")},{name:"COMMAND_SHOW_PREVIOUS_PANEL",action:e=>S.Z.showNextPanel(e.windowId,"previous"),showInQC:!0,isEnabled:ae.Z,isVisible:(e,t)=>t||Boolean(I.ZP.getNextPanel(e,"previous")),category:"CATEGORY_COMMAND_APPEARANCE",guid:"4569302b-1f24-440c-965c-da7f9bfca097",...(0,K.Z)("Open Previous Panel")},{name:"COMMAND_TOGGLE_CURRENT_PANEL",action:e=>S.Z.toggleCurrentPanel(e.windowId),showInQC:!0,isEnabled:ae.Z,isVisible:(e,t)=>t||Boolean(I.ZP.getSelected(e)),category:"CATEGORY_COMMAND_APPEARANCE",guid:"4128d533-256b-41f1-ba47-3c435ca3f2b4",...(0,K.Z)("Toggle Current Panel")},{name:"COMMAND_SHOW_BOOKMARK_PANEL",action:e=>S.Z.toggleContent(e.windowId,"PanelBookmarks"),isEnabled:ae.Z,isVisible:e=>I.ZP.hasPanel(e,"PanelBookmarks"),showInQC:!0,category:"CATEGORY_COMMAND_APPEARANCE",guid:"48ee057a-93c3-4be5-903b-6d2e701ecb96",...(0,K.Z)("title","Bookmarks Panel")},{name:"COMMAND_SHOW_READING_LIST_PANEL",action:e=>S.Z.toggleContent(e.windowId,"PanelReadingList"),showInQC:!0,isEnabled:ae.Z,isVisible:e=>I.ZP.hasPanel(e,"PanelReadingList"),category:"CATEGORY_COMMAND_APPEARANCE",guid:"9e7b130e-f0af-40db-896d-1a29668bf694",...(0,K.Z)("title","Reading List Panel")},{name:"COMMAND_SHOW_DOWNLOADS_PANEL",action:e=>S.Z.toggleContent(e.windowId,"PanelDownloads"),showInQC:!0,isEnabled:ae.Z,isVisible:e=>I.ZP.hasPanel(e,"PanelDownloads"),category:"CATEGORY_COMMAND_APPEARANCE",guid:"4fcaed1c-c5db-42a8-b47d-7e6674ecd252",...(0,K.Z)("title","Downloads Panel")},{name:"COMMAND_SHOW_HISTORY_PANEL",action:e=>S.Z.toggleContent(e.windowId,"PanelHistory"),isEnabled:ae.Z,isVisible:e=>I.ZP.hasPanel(e,"PanelHistory"),showInQC:!0,category:"CATEGORY_COMMAND_APPEARANCE",guid:"d26038ee-d140-42c5-98b0-27f14b9a8645",...(0,K.Z)("title","History Panel")},{name:"COMMAND_SHOW_NOTES_PANEL",action:e=>S.Z.toggleContent(e.windowId,"PanelNotes"),isEnabled:ae.Z,isVisible:e=>I.ZP.hasPanel(e,"PanelNotes"),showInQC:!0,category:"CATEGORY_COMMAND_APPEARANCE",guid:"96dc03a2-7c99-49ff-9055-f03ac6eb90fe",...(0,K.Z)("title","Notes Panel")},{name:"COMMAND_SHOW_TRANSLATE_PANEL",action:e=>S.Z.toggleContent(e.windowId,"PanelTranslate"),showInQC:!0,isEnabled:ae.Z,isVisible:e=>I.ZP.hasPanel(e,"PanelTranslate"),category:"CATEGORY_COMMAND_APPEARANCE",guid:"ccba139c-9b00-42aa-88cf-6a04a8a15fa5",...(0,K.Z)("title","Translate Panel")},{name:"COMMAND_SHOW_WINDOW_PANEL",action:e=>S.Z.toggleContent(e.windowId,"PanelWindow"),showInQC:!0,isEnabled:ae.Z,isVisible:e=>I.ZP.hasPanel(e,"PanelWindow"),category:"CATEGORY_COMMAND_APPEARANCE",guid:"7dc09b96-d5f1-4999-b2da-d8dd1f1e1651",...(0,K.Z)("title","Window Panel")},{name:"COMMAND_SHOW_SESSION_PANEL",action:e=>S.Z.toggleContent(e.windowId,"PanelSession"),showInQC:!0,isEnabled:ae.Z,isVisible:e=>I.ZP.hasPanel(e,"PanelSession"),category:"CATEGORY_COMMAND_APPEARANCE",guid:"7cc70878-1af1-4df6-af17-bf843efead3e",...(0,K.Z)("title","Session Panel")},{name:"COMMAND_SHOW_MAIL_PANEL",action:e=>S.Z.toggleContent(e.windowId,"PanelMail"),showInQC:e=>W.ZP.isMail(e),isEnabled:ae.Z,isVisible:e=>I.ZP.hasPanel(e,"PanelMail"),category:"CATEGORY_COMMAND_APPEARANCE",guid:"66a51de3-2c98-468a-ac92-0728cd798ca5",...(0,K.Z)("title","Mail Panel")},{name:"COMMAND_SHOW_CALENDAR_PANEL",action:e=>S.Z.toggleContent(e.windowId,"PanelCalendar"),isEnabled:ae.Z,isVisible:e=>I.ZP.hasPanel(e,"PanelCalendar"),showInQC:!0,category:"CATEGORY_COMMAND_APPEARANCE",guid:"a01cf36b-2f32-4919-924b-80e4e14a41b2",...(0,K.Z)("title","Calendar Panel")},{name:"COMMAND_SHOW_TASKS_PANEL",action:e=>S.Z.toggleContent(e.windowId,"PanelTasks"),isEnabled:ae.Z,isVisible:e=>I.ZP.hasPanel(e,"PanelTasks"),showInQC:!0,category:"CATEGORY_COMMAND_APPEARANCE",guid:"2a76f559-b679-40cc-b3cc-a308d65fa853",...(0,K.Z)("title","Tasks Panel")},{name:"COMMAND_SHOW_FEEDS_PANEL",action:e=>S.Z.toggleContent(e.windowId,"PanelFeeds"),showInQC:e=>W.ZP.isMail(e),isEnabled:ae.Z,isVisible:e=>I.ZP.hasPanel(e,"PanelFeeds"),category:"CATEGORY_COMMAND_APPEARANCE",guid:"9e682c56-34e8-48b8-88d4-b1f716e0bc9c",...(0,K.Z)("title","Feeds Panel")},{name:"COMMAND_SHOW_CONTACTS_PANEL",action:e=>S.Z.toggleContent(e.windowId,"PanelContacts"),showInQC:e=>W.ZP.isMail(e),isEnabled:ae.Z,isVisible:e=>I.ZP.hasPanel(e,"PanelContacts"),category:"CATEGORY_COMMAND_APPEARANCE",guid:"9492e500-30da-44fc-a28b-88c22a06c304",...(0,K.Z)("title","Contacts Panel")},{name:"COMMAND_SHOW_WEB_PANEL_1",action:e=>S.Z.toggleContent(e.windowId,"webpanel 1"),showInQC:!0,isEnabled:ae.Z,isVisible:(e,t)=>t||I.ZP.hasWebPanel(e,1),category:"CATEGORY_COMMAND_APPEARANCE",guid:"9a724d62-6b4f-4bec-affe-31a05966ccf9",...(0,K.Z)("Web Panel 1")},{name:"COMMAND_SHOW_WEB_PANEL_2",action:e=>S.Z.toggleContent(e.windowId,"webpanel 2"),showInQC:!0,isEnabled:ae.Z,isVisible:(e,t)=>t||I.ZP.hasWebPanel(e,2),category:"CATEGORY_COMMAND_APPEARANCE",guid:"a0ed3813-af8f-42af-8466-bbaf197bb5a6",...(0,K.Z)("Web Panel 2")},{name:"COMMAND_SHOW_WEB_PANEL_3",action:e=>S.Z.toggleContent(e.windowId,"webpanel 3"),showInQC:!0,isEnabled:ae.Z,isVisible:(e,t)=>t||I.ZP.hasWebPanel(e,3),category:"CATEGORY_COMMAND_APPEARANCE",guid:"a28d673c-5242-4330-aff1-b5df09dfad7c",...(0,K.Z)("Web Panel 3")},{name:"COMMAND_SHOW_WEB_PANEL_4",action:e=>S.Z.toggleContent(e.windowId,"webpanel 4"),showInQC:!0,isEnabled:ae.Z,isVisible:(e,t)=>t||I.ZP.hasWebPanel(e,4),category:"CATEGORY_COMMAND_APPEARANCE",guid:"a13f216c-d341-4057-a573-0b954dcde28f",...(0,K.Z)("Web Panel 4")},{name:"COMMAND_SHOW_WEB_PANEL_5",action:e=>S.Z.toggleContent(e.windowId,"webpanel 5"),showInQC:!0,isEnabled:ae.Z,isVisible:(e,t)=>t||I.ZP.hasWebPanel(e,5),category:"CATEGORY_COMMAND_APPEARANCE",guid:"e859c95a-52fc-4c30-87cc-768fd35cd5b9",...(0,K.Z)("Web Panel 5")},{name:"COMMAND_SHOW_WEB_PANEL_6",action:e=>S.Z.toggleContent(e.windowId,"webpanel 6"),showInQC:!0,isEnabled:ae.Z,isVisible:(e,t)=>t||I.ZP.hasWebPanel(e,6),category:"CATEGORY_COMMAND_APPEARANCE",guid:"61c088f8-a1b3-4a73-a359-08796372e33a",...(0,K.Z)("Web Panel 6")},{name:"COMMAND_SHOW_WEB_PANEL_7",action:e=>S.Z.toggleContent(e.windowId,"webpanel 7"),showInQC:!0,isEnabled:ae.Z,isVisible:(e,t)=>t||I.ZP.hasWebPanel(e,7),category:"CATEGORY_COMMAND_APPEARANCE",guid:"6fff7b4d-a154-4945-aacf-e57bc67afde8",...(0,K.Z)("Web Panel 7")},{name:"COMMAND_SHOW_WEB_PANEL_8",action:e=>S.Z.toggleContent(e.windowId,"webpanel 8"),showInQC:!0,isEnabled:ae.Z,isVisible:(e,t)=>t||I.ZP.hasWebPanel(e,9),category:"CATEGORY_COMMAND_APPEARANCE",guid:"26e5191f-7c81-4d3b-a499-e8945a9a6ec3",...(0,K.Z)("Web Panel 8")},{name:"COMMAND_SHOW_WEB_PANEL_9",action:e=>S.Z.toggleContent(e.windowId,"webpanel 9"),showInQC:!0,isEnabled:ae.Z,isVisible:(e,t)=>t||I.ZP.hasWebPanel(e,9),category:"CATEGORY_COMMAND_APPEARANCE",guid:"b0732781-fdf6-4ba8-8fcf-6d94f24edc37",...(0,K.Z)("Web Panel 9")},{name:"COMMAND_COPY_SELECTION_TO_NOTE",action:async e=>{const t=b.ZP.getActivePage(e.windowId);if(t){const n=await j.Z.utilities.getSelectedText(t.id);await y.Z.createNote(e.windowId,{content:n,url:t.url,type:"note"})}},isEnabled:ae.Z,isVisible:e=>!W.ZP.isGuest(),showInQC:!0,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"fa2d0620-4233-4d59-ab5d-e868fb52ad03",...(0,K.Z)("Copy Selected Text to Note")},{name:"COMMAND_APPEND_SELECTION_TO_NOTE",action:async e=>{const t=b.ZP.getActivePage(e.windowId);if(t){const n=await j.Z.utilities.getSelectedText(t.id);f.Z.showNoteSelectionDialog(e.windowId,{onSelected:e=>y.Z.appendToNode(e,n)})}},isEnabled:()=>C.ZP.hasNotes(),isVisible:e=>!W.ZP.isGuest(),showInQC:!0,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"1fe5dfa8-c044-4b3c-a36d-24a8d00de8be",...(0,K.Z)("Append Selected Text to Note")},{name:"COMMAND_TRANSLATE_SELECTION",action:async e=>{const t=b.ZP.getActivePage(e.windowId);if(t){const n=t.id,s=await j.Z.utilities.getSelectedText(n);s&&g.ZP.canTranslateText(s,t.url,n)&&R.Z.translateSelection(e.windowId,n,s)}},isEnabled:ae.Z,isVisible:ae.Z,showInQC:!0,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"25326646-7412-4be5-b478-6e74f1190a56",...(0,K.Z)("Translate Selected Text")},{name:"COMMAND_PAGE_QR_CODE",action:e=>{const t=b.ZP.getActivePage(e.windowId);t&&j.Z.utilities.createQRCode(t.id)},showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"fef3ca9a-341e-4814-9709-d9a070263882",...(0,K.Z)("Create QR Code for Active Page")},{name:"COMMAND_SPATNAV_LEFT",action:e=>P.Z.left(e.windowId),repeat:!0,inMenu:re.Z,showInQC:!1,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"466272ae-7b00-4113-bdb3-159ae29e848c",...(0,K.Z)("Spatial Navigation Left")},{name:"COMMAND_SPATNAV_UP",action:e=>P.Z.up(e.windowId),repeat:!0,inMenu:re.Z,showInQC:!1,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"527416b5-8d0f-4d05-b251-9a1c70cbbb11",...(0,K.Z)("Spatial Navigation Up")},{name:"COMMAND_SPATNAV_RIGHT",action:e=>P.Z.right(e.windowId),repeat:!0,inMenu:re.Z,showInQC:!1,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"0a095dee-caba-457d-b119-6a9cc12c9496",...(0,K.Z)("Spatial Navigation Right")},{name:"COMMAND_SPATNAV_DOWN",action:e=>P.Z.down(e.windowId),repeat:!0,inMenu:re.Z,showInQC:!1,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"b554b968-c3b1-4522-a927-07d3d5bf74a3",...(0,K.Z)("Spatial Navigation Down")},{name:"COMMAND_CLIPBOARD_UNDO",action:e=>h.Z.undo(e.windowId),showInQC:!1,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"fb89c51c-3fe7-4bab-b9f6-27174e89b76d",...(0,K.Z)("win_linux","Undo")},{name:"COMMAND_CLIPBOARD_REDO",action:e=>h.Z.redo(e.windowId),showInQC:!1,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"cfd7113d-8501-4fee-b8e3-c776297620d5",...(0,K.Z)("win_linux","Redo")},{name:"COMMAND_CLIPBOARD_CUT",action:e=>h.Z.cut(e.windowId),showInQC:!1,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"ef5d4a31-9ca0-424e-a3af-ec9770084dca",...(0,K.Z)("win_linux","Cut")},{name:"COMMAND_CLIPBOARD_COPY",action:e=>h.Z.copy(e.windowId),showInQC:!1,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"6dae1e1a-695b-41c5-9ca9-deb1fabe9cc9",...(0,K.Z)("win_linux","Copy")},{name:"COMMAND_CLIPBOARD_PASTE",action:e=>h.Z.paste(e.windowId),showInQC:!1,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"aa12b05a-94cf-4660-8272-37da19294192",...(0,K.Z)("win_linux","Paste")},{name:"COMMAND_CLIPBOARD_SELECT_ALL",action:e=>h.Z.selectAll(e.windowId),showInQC:!1,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"ce41214f-6878-42ef-b120-3deb06cfcf2e",...(0,K.Z)("win_linux","Select All")},{name:"COMMAND_CLIPBOARD_PASTE_AS_PLAIN_TEXT",action:e=>{b.ZP.getActivePage(e.windowId)&&h.Z.pasteAsPlainText(e.windowId)},showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"bac47f7e-084f-4255-b27e-24f767aa300b",...(0,K.Z)("Paste as Plain Text")},{name:"COMMAND_CLIPBOARD_PASTE_AS_PLAIN_TEXT_OR_PASTE_AND_GO",action:e=>{const t=b.ZP.getActivePage(e.windowId);t&&h.Z.pasteAsPlainTextOrPasteAndGo(e.windowId,t.id)},category:"CATEGORY_COMMAND_APPLICATION",showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,guid:"1ca0b67d-f911-4141-949b-09c728430f2f",...(0,K.Z)("Paste and Go")},{name:"COMMAND_CLIPBOARD_PASTE_AS_NOTE",action:e=>h.Z.createNoteFromSelection(e.windowId),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"eb19c8a1-019b-4eea-a159-4e7efaa7737a",...(0,K.Z)("Paste to New Note")},{name:"COMMAND_WINDOW_MINIMIZE",action:e=>V.Z.minimize(e.windowId),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"855ad23f-900b-42bf-af4d-4ce6b419ce09",...(0,K.Z)("Minimize")},{name:"COMMAND_WINDOW_MINIMIZE_ALL",action:()=>V.Z.minimizeAll(),showInQC:!0,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"9f6124ef-e8ed-4143-b9ca-5a4beb646e3d",...(0,K.Z)("Minimize All")},{name:"COMMAND_HIDE_OTHERS",action:()=>{},showInQC:!1,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"f1a77d87-7c3c-45be-9402-91d111381491",...(0,K.Z)("Hide Others")},{name:"COMMAND_HIDE_VIVALDI",action:()=>{},showInQC:!1,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"75e245b8-1cce-44e3-87f5-2cade5e26f6a",...(0,K.Z)("Hide $1",["Vivaldi"])},{name:"COMMAND_SHOW_ALL",action:()=>{},showInQC:!1,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"776628a4-a989-4373-922b-b16477bbb811",...(0,K.Z)("mac","Show All")},{name:"COMMAND_OPEN_LINK",action:()=>{},withNoWindow:!0,inMenu:re.Z,showInQC:!1,isEnabled:ae.Z,isVisible:ae.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"e1ecbf58-47e1-4eb1-92f5-3ff610aadd53",...(0,K.Z)("Open Link")},{name:"COMMAND_SHOW_CALENDAR",action:e=>f.Z.showCalendar(e.windowId),withNoWindow:!0,isEnabled:ae.Z,isVisible:()=>me(),showInQC:!0,category:"CATEGORY_COMMAND_APPLICATION",guid:"67287254-750b-4dbd-b290-cdc1b4906c2c",...(0,K.Z)("Calendar")},{name:"COMMAND_ADD_CALENDAR_EVENT",action:e=>r.Z.showAddEvent(e.windowId,"",""),isEnabled:ae.Z,isVisible:()=>me(),showInQC:!0,category:"CATEGORY_COMMAND_APPLICATION",guid:"594afe15-9134-49e6-9aa8-1f50b0925ef8",...(0,K.Z)("Add Calendar Event (Dialog)")},{name:"COMMAND_ADD_NEW_CALENDAR_ACCOUNT",action:e=>f.Z.showCalendarAccountDialog(e.windowId),isEnabled:ae.Z,isVisible:()=>me(),showInQC:!0,category:"CATEGORY_COMMAND_APPLICATION",guid:"a379c8cf-024b-49b5-94ac-9a8ac279e048",...(0,K.Z)("Add New Calendar Account")},{name:"COMMAND_CALENDAR_VIEWMODE_DAY",action:e=>{const t=d.Z.getPageId(e.windowId);"number"==typeof t&&l.Z.setViewMode(t,"day")},isEnabled:ae.Z,isVisible:()=>me(),feature:"calendar",showInQC:!0,category:"CATEGORY_COMMAND_CALENDAR",guid:"34b14e6c-de7d-4b66-819f-7ab80b1bb255",...(0,K.Z)("Day View")},{name:"COMMAND_CALENDAR_VIEWMODE_WEEK",action:e=>{const t=d.Z.getPageId(e.windowId);"number"==typeof t&&l.Z.setViewMode(t,"week")},isEnabled:ae.Z,isVisible:()=>me(),feature:"calendar",showInQC:!0,category:"CATEGORY_COMMAND_CALENDAR",guid:"4c6371b0-0217-4c6d-b4f7-7a5f100375c3",...(0,K.Z)("Week View")},{name:"COMMAND_CALENDAR_VIEWMODE_MULTIWEEK",action:e=>{const t=d.Z.getPageId(e.windowId);"number"==typeof t&&l.Z.setViewMode(t,"multiweek")},isEnabled:ae.Z,isVisible:()=>me(),feature:"calendar",showInQC:!0,category:"CATEGORY_COMMAND_CALENDAR",guid:"0f2eaffe-fbad-452e-858e-1edcfd8a746e",...(0,K.Z)("Multi Week View")},{name:"COMMAND_CALENDAR_VIEWMODE_MONTH",action:e=>{const t=d.Z.getPageId(e.windowId);"number"==typeof t&&l.Z.setViewMode(t,"month")},isEnabled:ae.Z,isVisible:()=>me(),feature:"calendar",showInQC:!0,category:"CATEGORY_COMMAND_CALENDAR",guid:"2a5db361-313a-43b6-a0e9-f51d304aec7c",...(0,K.Z)("Month View")},{name:"COMMAND_CALENDAR_VIEWMODE_YEAR",action:e=>{const t=d.Z.getPageId(e.windowId);"number"==typeof t&&l.Z.setViewMode(t,"year")},isEnabled:ae.Z,isVisible:()=>me(),feature:"calendar",showInQC:!0,category:"CATEGORY_COMMAND_CALENDAR",guid:"1f261447-d1b1-473f-bb07-6139fd878ea2",...(0,K.Z)("Year View")},{name:"COMMAND_CALENDAR_VIEWMODE_AGENDA",action:e=>{const t=d.Z.getPageId(e.windowId);"number"==typeof t&&l.Z.setViewMode(t,"agenda")},isEnabled:ae.Z,isVisible:()=>me(),feature:"calendar",showInQC:!0,category:"CATEGORY_COMMAND_CALENDAR",guid:"925c843d-4813-4ea5-8837-211412707dbf",...(0,K.Z)("Agenda View")},{name:"COMMAND_CALENDAR_VIEW_NEXT_PERIOD",action:e=>{const t=d.Z.getPageId(e.windowId);"number"==typeof t&&l.Z.viewNextPeriod(t)},isEnabled:ae.Z,isVisible:()=>me(),feature:"calendar",showInQC:!0,category:"CATEGORY_COMMAND_CALENDAR",guid:"0f8df2a2-343b-43db-a16c-16418dc9f241",...(0,K.Z)("View Next Period")},{name:"COMMAND_CALENDAR_VIEW_PREVIOUS_PERIOD",action:e=>{const t=d.Z.getPageId(e.windowId);"number"==typeof t&&l.Z.viewPreviousPeriod(t)},isEnabled:ae.Z,isVisible:()=>me(),feature:"calendar",showInQC:!0,category:"CATEGORY_COMMAND_CALENDAR",guid:"4601bd8c-4229-442c-8dec-df8171c4da1d",...(0,K.Z)("View Previous Period")},{name:"COMMAND_CALENDAR_VIEW_TODAY",action:e=>{const t=d.Z.getPageId(e.windowId);"number"==typeof t&&l.Z.selectToday(t)},isEnabled:ae.Z,isVisible:()=>me(),feature:"calendar",showInQC:!0,category:"CATEGORY_COMMAND_CALENDAR",guid:"44e98ded-fa2d-4ee4-a7f6-e705ac809503",...(0,K.Z)("View Today")},{name:"COMMAND_CALENDAR_VIEW_ZOOM_IN",action:e=>{const t=d.Z.getPageId(e.windowId);"number"==typeof t&&l.Z.zoomViewMode(t,-1)},isEnabled:ae.Z,isVisible:()=>me(),feature:"calendar",showInQC:!0,category:"CATEGORY_COMMAND_CALENDAR",guid:"940d0a90-6337-4d42-b317-13630fa38697",...(0,K.Z)("Zoom View In")},{name:"COMMAND_CALENDAR_VIEW_ZOOM_OUT",action:e=>{const t=d.Z.getPageId(e.windowId);"number"==typeof t&&l.Z.zoomViewMode(t,1)},isEnabled:ae.Z,isVisible:()=>me(),feature:"calendar",showInQC:!0,category:"CATEGORY_COMMAND_CALENDAR",guid:"8c03403a-77fd-4920-aad9-c47ecee1a115",...(0,K.Z)("Zoom View Out")},{name:"COMMAND_CALENDAR_CREATE_EVENT",action:e=>p.Z.onCommand(e.windowId,"COMMAND_CALENDAR_CREATE_EVENT"),isEnabled:ae.Z,isVisible:()=>me(),showInQC:!0,feature:"calendar",category:"CATEGORY_COMMAND_CALENDAR",guid:"1559362f-6274-4590-a260-a660b71dfcd5",...(0,K.Z)("Create Event")},{name:"COMMAND_CALENDAR_GOTO_DATE",action:e=>p.Z.onCommand(e.windowId,"COMMAND_CALENDAR_GOTO_DATE"),isEnabled:ae.Z,isVisible:()=>me(),showInQC:!0,feature:"calendar",category:"CATEGORY_COMMAND_CALENDAR",guid:"6c6537e4-75a3-43f0-93e1-9f3765d0c686",...(0,K.Z)("Go to Date")},{name:"COMMAND_CALENDAR_SEARCH",action:e=>p.Z.onCommand(e.windowId,"COMMAND_CALENDAR_SEARCH"),isEnabled:ae.Z,isVisible:()=>me(),showInQC:!0,feature:"calendar",category:"CATEGORY_COMMAND_CALENDAR",guid:"55a8cf5d-e711-4ce4-a02f-55cf31ffcda8",...(0,K.Z)("Search in Calendar")},{name:"COMMAND_CALENDAR_REFRESH",action:e=>r.Z.pollAllCalDAVAccountsWithStatus(),isVisible:()=>me(),isEnabled:ae.Z,showInQC:!0,feature:"calendar",category:"CATEGORY_COMMAND_CALENDAR",guid:"1d59f64f-9e47-491c-93eb-fe66fc099279",...(0,K.Z)("Refresh Calendar")},{name:"COMMAND_MAIL_COMPOSE_NEW_MESSAGE",action:()=>v.Z.createDraft(),showInQC:!0,isEnabled:()=>Object.keys(G.Z.getAccounts()).length>0,isVisible:()=>me(),feature:"mail",guid:"1c54b411-5b73-4eba-b5bf-6787d1f377fe",category:"CATEGORY_COMMAND_MAIL",...(0,K.Z)("command","Compose New Message")},{name:"COMMAND_SHOW_MAIL",action:e=>f.Z.showMail(e.windowId),withNoWindow:!0,showInQC:!0,isEnabled:ae.Z,isVisible:()=>me(),guid:"670dbed7-f692-4fa4-a926-fe46183b82bb",category:"CATEGORY_COMMAND_APPLICATION",...(0,K.Z)("Mail")},{name:"COMMAND_MAIL_REPLY",action:()=>i.Z.reply(),isEnabled:e=>(0,se.Wm)(e),isVisible:()=>me(),feature:"mail",showInQC:!0,category:"CATEGORY_COMMAND_MAIL",guid:"fa9e273b-11fd-4be9-b77e-461a1e9fcc4e",...(0,K.Z)("Reply to Message")},{name:"COMMAND_MAIL_REPLY_ALL",action:()=>i.Z.replyAll(),showInQC:!0,isEnabled:e=>(0,se.Wm)(e),isVisible:()=>me(),feature:"mail",category:"CATEGORY_COMMAND_MAIL",guid:"cc59e4b7-c907-48b7-9057-f4dc2ae9c552",...(0,K.Z)("Reply All")},{name:"COMMAND_MAIL_REPLY_LIST",action:()=>i.Z.replyList(),showInQC:!0,isEnabled:e=>o.Z.isListPost(),isVisible:()=>me(),feature:"mail",category:"CATEGORY_COMMAND_MAIL",guid:"aa09df31-0dbc-41c9-be62-265cd2906b88",...(0,K.Z)("Reply List")},{name:"COMMAND_MAIL_FORWARD",action:()=>i.Z.forward(),isEnabled:e=>(0,se.Wm)(e),isVisible:()=>me(),feature:"mail",showInQC:!0,category:"CATEGORY_COMMAND_MAIL",guid:"f45c60df-9ca1-444e-8108-656b0a15c68e",...(0,K.Z)("mail","Forward Message")},{name:"COMMAND_MAIL_DELETE_PERMANENTLY",action:e=>i.Z.prepareDelete(e.windowId,!0),isEnabled:e=>(0,se.Wm)(e),isVisible:()=>me(),feature:"mail",showInQC:!1,category:"CATEGORY_COMMAND_MAIL",guid:"7b0de3f1-2173-4bde-96bf-f9fa1063abe7",...(0,K.Z)("Delete Permanently")},{name:"COMMAND_MAIL_MARK_READ",action:e=>i.Z.markRead(e.windowId),isEnabled:e=>(0,se.Wm)(e),isVisible:()=>me(),feature:"mail",showInQC:!0,category:"CATEGORY_COMMAND_MAIL",guid:"02a17cf8-4e45-4d32-b06c-38edf99544da",...(0,K.Z)("mail","Mark Message as Read")},{name:"COMMAND_MAIL_MARK_JUNK",action:e=>i.Z.markAsJunk(e.windowId),isEnabled:e=>(0,se.Wm)(e),isVisible:()=>me(),feature:"mail",showInQC:!0,category:"CATEGORY_COMMAND_MAIL",guid:"4266577c-0e3b-4237-aadd-868b122976f6",...(0,K.Z)("mail","Mark Message as Spam")},{name:"COMMAND_MAIL_MARK_NOT_JUNK",action:e=>i.Z.markAsNotJunk(e.windowId),isEnabled:e=>(0,se.Wm)(e),isVisible:()=>me(),feature:"mail",showInQC:!0,category:"CATEGORY_COMMAND_MAIL",guid:"b0546fb8-3dbf-47d7-9265-01d5c90e53cc",...(0,K.Z)("mail","Not Spam")},{name:"COMMAND_MAIL_MOVE_TO_ARCHIVE",action:e=>i.Z.moveToArchive(e.windowId),isEnabled:e=>(0,se.Wm)(e),isVisible:()=>me(),feature:"mail",showInQC:!0,category:"CATEGORY_COMMAND_MAIL",guid:"88b88583-3976-4f56-a906-067928fd809f",...(0,K.Z)("mail","Move Message to Archive")},{name:"COMMAND_MAIL_RESTORE_FROM_ARCHIVE",action:e=>i.Z.restoreFromArchive(e.windowId),isEnabled:e=>(0,se.Wm)(e),isVisible:()=>me(),feature:"mail",showInQC:!0,category:"CATEGORY_COMMAND_MAIL",guid:"7ff15fcb-6812-404c-8d27-f2100f585476",...(0,K.Z)("mail","Restore Message from Archive")},{name:"COMMAND_MAIL_GOTO_NEXT_UNREAD",action:e=>i.Z.goToNextUnread(e.windowId),isEnabled:e=>(0,se.Wm)(e),isVisible:()=>me(),feature:"mail",showInQC:!1,category:"CATEGORY_COMMAND_MAIL",guid:"75f673af-21e8-43f2-8aa8-b96b8dbd0245",...(0,K.Z)("mail","Next Unread")},{name:"COMMAND_MAIL_GOTO_PREVIOUS_UNREAD",action:e=>i.Z.goToPreviousUnread(e.windowId),isEnabled:e=>(0,se.Wm)(e),isVisible:()=>me(),feature:"mail",showInQC:!1,category:"CATEGORY_COMMAND_MAIL",guid:"24aab8e7-7bd0-470d-88f8-5ecdb1f19224",...(0,K.Z)("mail","Previous Unread")},{name:"COMMAND_MAIL_MARK_ALL_READ",action:()=>m.Z.markAllReadCmd(),isEnabled:e=>(0,se.Wm)(e),isVisible:()=>me(),feature:"mail",showInQC:!1,category:"CATEGORY_COMMAND_MAIL",guid:"c929109f-99fa-45a5-80ca-9a3fdd17bd63",...(0,K.Z)("mail","Mark All as Read")},{name:"COMMAND_MAIL_MARK_THREAD_READ",action:e=>i.Z.markThreadRead(e.windowId),isEnabled:e=>(0,se.Wm)(e),isVisible:()=>me(),feature:"mail",showInQC:!0,category:"CATEGORY_COMMAND_MAIL",guid:"3110cb8a-11eb-4643-b834-f88ee1bf0155",...(0,K.Z)("mail","Mark Message Thread as Read")},{name:"COMMAND_MAIL_MARK_THREAD_UNREAD",action:e=>i.Z.markThreadUnread(e.windowId),isEnabled:e=>(0,se.Wm)(e),isVisible:()=>me(),feature:"mail",showInQC:!0,category:"CATEGORY_COMMAND_MAIL",guid:"655c64c3-8e8f-44ff-a7bf-a05f2c9a6115",...(0,K.Z)("mail","Mark Message Thread as Unread")},{name:"COMMAND_MAIL_MARK_UNREAD",action:e=>i.Z.markUnread(e.windowId),isEnabled:e=>(0,se.Wm)(e),isVisible:()=>me(),feature:"mail",showInQC:!0,category:"CATEGORY_COMMAND_MAIL",guid:"6b193cc2-62ca-41a8-9a17-d311541aef54",...(0,K.Z)("mail","Mark Message as Unread")},{name:"COMMAND_MAIL_ENABLE_SENDER_VIEW",action:e=>i.Z.enableCorrespondentView(e.windowId),isEnabled:e=>(0,se.Wm)(e),isVisible:()=>me(),feature:"mail",showInQC:!0,category:"CATEGORY_COMMAND_MAIL",guid:"61ab202a-46ad-45ce-92b9-85c3295ef801",...(0,K.Z)("mail","Show Messages for Sender")},{name:"COMMAND_MAIL_ENABLE_THREADED_VIEW",action:e=>i.Z.enableThreadedView(e.windowId),isEnabled:e=>(0,se.Wm)(e),isVisible:()=>me(),feature:"mail",showInQC:!0,category:"CATEGORY_COMMAND_MAIL",guid:"5c21bfa1-f0b2-4804-a395-71243d99dad8",...(0,K.Z)("mail","Show Message Thread")},{name:"COMMAND_MAIL_MARK_READ_AND_GOTO_NEXT_UNREAD",action:e=>i.Z.markAsReadAndGoToNextUnread(e.windowId),isEnabled:e=>(0,se.Wm)(e),isVisible:()=>me(),feature:"mail",showInQC:!0,category:"CATEGORY_COMMAND_MAIL",guid:"92f285b0-90dc-4051-940e-eefee7b4692f",...(0,K.Z)("mail","Mark Message as Read and Go to Next Unread")},{name:"COMMAND_MAIL_ADD_NEW_MAIL_ACCOUNT",action:e=>f.Z.showMailAccountDialog(e.windowId),isEnabled:ae.Z,isVisible:()=>me(),showInQC:!0,category:"CATEGORY_COMMAND_MAIL",guid:"2b65911f-8bfc-4e9b-bf43-b78bfc7c4587",...(0,K.Z)("mail","Add New Mail Account")},{name:"COMMAND_MAIL_SHOW_PLAINTEXT",action:e=>p.Z.onCommand(e.windowId,"COMMAND_MAIL_SHOW_PLAINTEXT"),isEnabled:()=>"plaintext"!==o.Z.getRenderingMethod(),isVisible:()=>me(),showInQC:!0,category:"CATEGORY_COMMAND_MAIL",guid:"ca91db92-59ae-40b6-9c69-10f7d4da2041",...(0,K.Z)("Show Message as Text")},{name:"COMMAND_MAIL_SHOW_HTML",action:e=>p.Z.onCommand(e.windowId,"COMMAND_MAIL_SHOW_HTML"),isEnabled:()=>"prefer_html"!==o.Z.getRenderingMethod(),isVisible:()=>me(),showInQC:!0,category:"CATEGORY_COMMAND_MAIL",guid:"6c080636-1fd2-41d2-826a-9652ae4de5d8",...(0,K.Z)("Show Message as HTML")},{name:"COMMAND_MAIL_SHOW_SETTINGS",action:e=>f.Z.showSettings(e.windowId,"mail"),isEnabled:ae.Z,isVisible:()=>me(),showInQC:!0,category:"CATEGORY_COMMAND_MAIL",guid:"68FEE23D-B0DB-41D1-996B-C62BA4FD5F7A",...(0,K.Z)("Mail Settings")},{name:"COMMAND_MAIL_SEND_MESSAGE",action:e=>s.Z.sendMessage(e.windowId),isEnabled:()=>!T.Z.get(ie.kMailIsTurnedOff),isVisible:e=>ve(e),feature:"mail",showInQC:!0,category:"CATEGORY_COMMAND_MAIL",guid:"c604b094-c4a6-4825-a626-ac02dcb4f9f2",...(0,K.Z)("mail","Send Mail From Mail Composer")},{name:"COMMAND_MAIL_QUEUE_MESSAGE",action:e=>s.Z.queueMessage(e.windowId,!1),isEnabled:()=>!T.Z.get(ie.kMailIsTurnedOff),isVisible:e=>ve(e),feature:"mail",showInQC:!0,category:"CATEGORY_COMMAND_MAIL",guid:"401ded53-2b1e-4138-9730-64a3b9cb852a",...(0,K.Z)("mail","Queue Mail From Mail Composer")},{name:"COMMAND_WORKSPACE_SWITCH_FORWARD_ORDER",action:e=>U.Z.activateNextByOrder(e.windowId),showInQC:!0,isEnabled:()=>T.Z.get(ie.kWorkspacesEnabled),isVisible:()=>T.Z.get(ie.kWorkspacesEnabled),category:"CATEGORY_COMMAND_WORKSPACE_ACTION",guid:"629d1445-7c11-4047-a419-e50f948d1eb6",...(0,K.Z)("Next Workspace")},{name:"COMMAND_WORKSPACE_SWITCH_BACK_ORDER",action:e=>U.Z.activatePreviousByOrder(e.windowId),showInQC:!0,isEnabled:()=>T.Z.get(ie.kWorkspacesEnabled),isVisible:()=>T.Z.get(ie.kWorkspacesEnabled),category:"CATEGORY_COMMAND_WORKSPACE_ACTION",guid:"d0ee5c21-ba2d-4435-8f69-b6cf8a2911d2",...(0,K.Z)("Previous Workspace")},{name:"COMMAND_WORKSPACE_CREATE_NEW",action:e=>f.Z.showWorkspaceDialog(e.windowId,{createInBackground:!1}),isEnabled:ae.Z,isVisible:()=>T.Z.get(ie.kWorkspacesEnabled),showInQC:!0,category:"CATEGORY_COMMAND_WORKSPACE_ACTION",guid:"eee152db-570a-4d6c-94d0-3ce684b623cb",...(0,K.Z)("workspaces","Create New Workspace")},{name:"COMMAND_WORKSPACE_SWITCH_1",action:e=>U.Z.activateWorkspaceByIndex(e.windowId,void 0),showInQC:!1,isEnabled:ae.Z,isVisible:()=>T.Z.get(ie.kWorkspacesEnabled),category:"CATEGORY_COMMAND_WORKSPACE_ACTION",guid:"84839d33-4378-426f-ab95-a013bda152c0",...(0,K.Z)("Switch to Window")},{name:"COMMAND_WORKSPACE_SWITCH_2",action:e=>U.Z.activateWorkspaceByIndex(e.windowId,0),showInQC:!1,isEnabled:ae.Z,isVisible:()=>T.Z.get(ie.kWorkspacesEnabled),category:"CATEGORY_COMMAND_WORKSPACE_ACTION",guid:"0bc9d92d-05f7-4e49-8a87-c6e4f85565aa",...(0,K.Z)("Switch to Workspace 1")},{name:"COMMAND_WORKSPACE_SWITCH_3",action:e=>U.Z.activateWorkspaceByIndex(e.windowId,1),showInQC:!1,isEnabled:ae.Z,isVisible:()=>T.Z.get(ie.kWorkspacesEnabled),category:"CATEGORY_COMMAND_WORKSPACE_ACTION",guid:"1bbf445e-1787-4af4-ac01-e0ef0fb4054d",...(0,K.Z)("Switch to Workspace 2")},{name:"COMMAND_WORKSPACE_SWITCH_4",action:e=>U.Z.activateWorkspaceByIndex(e.windowId,2),showInQC:!1,isEnabled:ae.Z,isVisible:()=>T.Z.get(ie.kWorkspacesEnabled),category:"CATEGORY_COMMAND_WORKSPACE_ACTION",guid:"f3ba55d2-e1c1-48d2-9bf2-0464b3444499",...(0,K.Z)("Switch to Workspace 3")},{name:"COMMAND_WORKSPACE_SWITCH_5",action:e=>U.Z.activateWorkspaceByIndex(e.windowId,3),showInQC:!1,isEnabled:ae.Z,isVisible:()=>T.Z.get(ie.kWorkspacesEnabled),category:"CATEGORY_COMMAND_WORKSPACE_ACTION",guid:"cafeffc8-984a-4c0f-a9f2-4ccf1dd5577a",...(0,K.Z)("Switch to Workspace 4")},{name:"COMMAND_WORKSPACE_SWITCH_6",action:e=>U.Z.activateWorkspaceByIndex(e.windowId,4),showInQC:!1,isEnabled:ae.Z,isVisible:()=>T.Z.get(ie.kWorkspacesEnabled),category:"CATEGORY_COMMAND_WORKSPACE_ACTION",guid:"5ccdd631-2dcd-46b2-9b39-7720e98fa376",...(0,K.Z)("Switch to Workspace 5")},{name:"COMMAND_WORKSPACE_SWITCH_7",action:e=>U.Z.activateWorkspaceByIndex(e.windowId,5),showInQC:!1,isEnabled:ae.Z,isVisible:()=>T.Z.get(ie.kWorkspacesEnabled),category:"CATEGORY_COMMAND_WORKSPACE_ACTION",guid:"fe8c273a-9a21-4547-8d6e-6befed835a84",...(0,K.Z)("Switch to Workspace 6")},{name:"COMMAND_WORKSPACE_SWITCH_8",action:e=>U.Z.activateWorkspaceByIndex(e.windowId,6),showInQC:!1,isEnabled:ae.Z,isVisible:()=>T.Z.get(ie.kWorkspacesEnabled),category:"CATEGORY_COMMAND_WORKSPACE_ACTION",guid:"0be9f4ad-da3f-47aa-b03d-2b6b2aa16084",...(0,K.Z)("Switch to Workspace 7")},{name:"COMMAND_WORKSPACE_SWITCH_9",action:e=>U.Z.activateWorkspaceByIndex(e.windowId,7),showInQC:!1,isEnabled:ae.Z,isVisible:()=>T.Z.get(ie.kWorkspacesEnabled),category:"CATEGORY_COMMAND_WORKSPACE_ACTION",guid:"cb808c2b-9b79-4914-a25c-861818dd86be",...(0,K.Z)("Switch to Workspace 8")},{name:"COMMAND_WORKSPACE_SWITCH_10",action:e=>U.Z.activateWorkspaceByIndex(e.windowId,8),showInQC:!1,isEnabled:ae.Z,isVisible:()=>T.Z.get(ie.kWorkspacesEnabled),category:"CATEGORY_COMMAND_WORKSPACE_ACTION",guid:"e32ce875-6d68-4d49-8fdf-5586908275b4",...(0,K.Z)("Switch to Workspace 9")},{name:"COMMAND_HIBERNATE_INACTIVE_WORKSPACES",action:e=>U.Z.hibernateInactive(e.windowId),showInQC:!0,isEnabled:ae.Z,isVisible:()=>T.Z.get(ie.kWorkspacesEnabled),category:"CATEGORY_COMMAND_WORKSPACE_ACTION",guid:"d06e09c2-b95f-47fb-a3f1-c67872fdb8c4",...(0,K.Z)("workspaces","Hibernate Inactive Workspaces")},{name:"COMMAND_SHOW_WORKSPACE_MENU",action:e=>p.Z.onCommand(e.windowId,"COMMAND_SHOW_WORKSPACE_MENU"),showInQC:!0,isEnabled:ae.Z,isVisible:()=>T.Z.get(ie.kWorkspacesEnabled),category:"CATEGORY_COMMAND_WORKSPACE_ACTION",guid:"d8df3703-4bef-43a8-aebe-cf53222c9927",...(0,K.Z)("workspaces","Show Workspace Menu")}]},9761:(e,t,n)=>{"use strict";n.d(t,{YI:()=>l,jq:()=>r,lE:()=>o,sK:()=>a});var s=n(70253),i=n(56371);const o=s.M.pb.map((([e,t,n])=>({key:e,value:(0,i.Z)(t),local:n}))),a=[{key:"am",value:(0,i.Z)("Amharic"),local:"amarəñña"},{key:"ar",value:(0,i.Z)("Arabic"),local:"اَلْعَرَبِيَّةُ"},{key:"bn",value:(0,i.Z)("Bengali"),local:"baɛṅlā"},{key:"bs",value:(0,i.Z)("Bosnian"),local:"bosanski"},{key:"ceb",value:(0,i.Z)("Cebuano"),local:"Sinugboanon"},{key:"co",value:(0,i.Z)("Corsican"),local:"corsu"},{key:"cy",value:(0,i.Z)("Welsh"),local:"Cymraeg"},{key:"eo",value:(0,i.Z)("Esperanto"),local:"Esperanto"},{key:"eu",value:(0,i.Z)("Basque"),local:"euskara"},{key:"ga",value:(0,i.Z)("Irish Gaelic"),local:"Gaeilge"},{key:"gu",value:(0,i.Z)("Gujarati"),local:"gujarātī"},{key:"ha",value:(0,i.Z)("Hausa"),local:"ḥawsa"},{key:"haw",value:(0,i.Z)("Hawaiian"),local:"ʻōlelo Hawaiʻi"},{key:"he",value:(0,i.Z)("Hebrew"),local:"עברית / עִבְרִית"},{key:"hi",value:(0,i.Z)("Hindi"),local:"हिन्दी"},{key:"hmn",value:(0,i.Z)("Hmong, Mong"),local:"Hmong"},{key:"ht",value:(0,i.Z)("Haitian Creole"),local:"Kreyòl ayisyen"},{key:"ig",value:(0,i.Z)("Igbo"),local:"igbo"},{key:"jv",value:(0,i.Z)("Javanese"),local:"basa Jawa"},{key:"ka",value:(0,i.Z)("Georgian"),local:"ქართული"},{key:"kk",value:(0,i.Z)("Kazakh"),local:"Қазақ тілі"},{key:"km",value:(0,i.Z)("Khmer"),local:"ភាសាខ្មែរ"},{key:"kn",value:(0,i.Z)("Kannada"),local:"ಕನ್ನಡ (kannaḍa)"},{key:"ky",value:(0,i.Z)("Kyrgyz"),local:"قىرعىز تىلى"},{key:"la",value:(0,i.Z)("Latin"),local:"Lingua Latina"},{key:"lb",value:(0,i.Z)("Luxembourgish"),local:"Lëtzebuergesch"},{key:"lo",value:(0,i.Z)("Lao"),local:"ພາສາລາວ"},{key:"lv",value:(0,i.Z)("Latvian"),local:"latviešu valoda"},{key:"mg",value:(0,i.Z)("Malagasy"),local:"Fiteny Malagasy"},{key:"mi",value:(0,i.Z)("Maori"),local:"te Reo Māori"},{key:"mk",value:(0,i.Z)("Macedonian"),local:"македонски"},{key:"ml",value:(0,i.Z)("Malayalam"),local:"മലയാളം"},{key:"mn",value:(0,i.Z)("Mongolian"),local:"монгол"},{key:"mr",value:(0,i.Z)("Marathi"),local:"मराठी"},{key:"ms",value:(0,i.Z)("Malay"),local:"Bahasa melayu"},{key:"mt",value:(0,i.Z)("Maltese"),local:"Malti"},{key:"my",value:(0,i.Z)("Burmese"),local:"ဗမာစကား"},{key:"ne",value:(0,i.Z)("Nepali"),local:"नेपाली"},{key:"ny",value:(0,i.Z)("Chichewa"),local:"Chicheŵa"},{key:"or",value:(0,i.Z)("Oriya"),local:"ଓଡ଼ିଆ"},{key:"ps",value:(0,i.Z)("Pashto"),local:"پښتو"},{key:"rw",value:(0,i.Z)("Kinyarwanda"),local:"Ikinyarwanda"},{key:"sd",value:(0,i.Z)("Sindhi"),local:"سنڌي"},{key:"si",value:(0,i.Z)("Sinhala"),local:"සිංහල"},{key:"sm",value:(0,i.Z)("Samoan"),local:"Gagana Samoa"},{key:"sn",value:(0,i.Z)("Shona"),local:"chiShona"},{key:"so",value:(0,i.Z)("Somali"),local:"af Soomaali"},{key:"st",value:(0,i.Z)("Southern Sotho"),local:"seSotho"},{key:"su",value:(0,i.Z)("Sundanese"),local:"Basa Sunda"},{key:"sw",value:(0,i.Z)("Swahili"),local:"Kiswahili"},{key:"ta",value:(0,i.Z)("Tamil"),local:"தமிழ்"},{key:"te",value:(0,i.Z)("Telugu"),local:"తెలుగు"},{key:"tg",value:(0,i.Z)("Tajik"),local:"тоҷики / toçikī / تاجيكي"},{key:"th",value:(0,i.Z)("Thai"),local:"ภาษาไทย"},{key:"tk",value:(0,i.Z)("Turkmen"),local:"түркmенче"},{key:"tl",value:(0,i.Z)("Tagalog"),local:"Tagalog"},{key:"tt",value:(0,i.Z)("Tatar"),local:"татарча / tatar tele / تاتارچا"},{key:"ug",value:(0,i.Z)("Uyghur"),local:"Уйғур /ئۇيغۇر"},{key:"ur",value:(0,i.Z)("Urdu"),local:"اُردُو"},{key:"uz",value:(0,i.Z)("Uzbek"),local:"o’zbek tili ўзбек тили"},{key:"xh",value:(0,i.Z)("Xhosa"),local:"isiXhosa"},{key:"yi",value:(0,i.Z)("Yiddish"),local:"ײִדיש"},{key:"yo",value:(0,i.Z)("Yoruba"),local:"Yorùbá"},{key:"zu",value:(0,i.Z)("Zulu"),local:"isiZulu"}],r={en:"en-US",es:"es-ES",no:"nb",pt:"pt-PT","sr-Cyrl":"sr","zh-Hans":"zh-CN","zh-Hant":"zh-TW"},l=Object.entries(r).reduce(((e,[t,n])=>(e[n]=t,e)),{"de-CH":"de","en-GB":"en","ja-KS":"ja","sr-Latn":"sr",nn:"no","pt-BR":"pt",iw:"he"})},33638:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});n(20244);const s=new class{_stores=new Set;register(e){const t=this._stores.size;if(this._stores.add(e),t===this._stores.size)throw new Error(`register() in ${this.constructor.name} was called with store ${e.constructor?.name} that was already registered.`)}reorderRegistrations(e){const t=this._stores.size;e.forEach((e=>{if(this._stores.delete(e),this._stores.add(e),t!==this._stores.size)throw new Error(`reorderRegistrations() in ${this.constructor.name} was called with store ${e.constructor?.name} that was not already registered.`)}))}isDispatching(){return Boolean(this._dispatching)}setLogCallback(e){this._logCallback=e}dispatch(e){if(this._dispatching){let t=`VivaldiAppDispatcher.dispatch(...): Cannot dispatch action ${e.actionType} the middle of a ${this._dispatching.actionType} dispatch.`;throw new Error(t)}this._dispatching=e;try{for(const t of this._stores)t.dispatchAction(e)}finally{this._dispatching=void 0,this._logCallback&&this._logCallback(e)}}}},30628:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var s=n(48868),i=n(5863);class o{static m3GetAll(){return s.Z.transaction("rw",[s.Z.searchList,s.Z.filters],(()=>s.Z.filters.where("[accountId+path]").equals([i.of,i.J8]).first().then((e=>{if(!e)throw new Error("Outbox filter not found");return s.Z.searchList.where("sourceFilterIds").equals(e.id).toArray()}))))}}},60308:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var s=n(48868),i=n(71320),o=n(10671),a=n(21285),r=n(61839),l=n(5863),d=n(84321);async function c(e,t,n,c){let h=[];const p=await s.Z.transaction("rw",a.E.concat([s.Z.filters]),(async()=>{let s;if(n===l.kY)s=c.map((e=>({message:e})));else{s=await(0,d.kb)(c);for(const e of s){const{searchListEntry:t}=e;if(t){const n=i.Z.getByIds(t.sourceFilterIds);o.Z.getFolderTypes(n).has(l.kY)&&delete e.searchListEntry}}}const{newMessageGroups:r,duplicates:p}=(0,d.RA)(s),u=r.map((e=>e[0])),g=await(0,a.Z)(e,t,n,u),m=g.addedSles;h=g.forSearchDb;const v=[...m],f=[];if(p.length>0){const s=await(0,d.yR)(e,t,n,p,!0);f.push(...s);for(const{searchListEntry:e}of p)v.push(e)}return{indexUpdates:{addedSles:m,sleUpdates:f},slesToDisk:v}}));return(0,r.Z)(h),p}},28918:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var s=n(48868);const i=function(e){return s.Z.buffer.add(e)}},93789:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var s=n(48868),i=n(71320);const o={call:async function(e,t){const n=[],o=[],a=[];return await s.Z.transaction("rw",[s.Z.searchList,s.Z.hasRaw],(async()=>{await s.Z.searchList.where("id").anyOf(e).modify((e=>{e.sourceFilterIds=e.sourceFilterIds.filter((e=>!t.includes(e))),t.forEach((t=>{e.sources.delete(t)}));const s=new Set(i.Z.getByIds([...e.sources.keys()]).map((({accountId:e})=>e))),r=new Set(i.Z.getByIds(t).map((({accountId:e})=>e)).filter((e=>!s.has(e))));for(const t of r)n.push([e.id,t]),o.push({accountId:t,searchListId:e.id,sentDate:e.sentDate});a.push({id:e.id,updates:{sourceFilterIds:e.sourceFilterIds,sources:new Map(t.map((e=>[e,void 0])))}})})),n.length>0&&s.Z.hasRaw.bulkDelete(n)})),{fileKeys:o,sleUpdates:a}}}},44850:(e,t,n)=>{"use strict";n.d(t,{$0:()=>M,CS:()=>Z,D1:()=>G,Gp:()=>W,Gr:()=>U,QB:()=>R,Rf:()=>K,YC:()=>T,Z7:()=>D,cw:()=>B,d6:()=>z,jk:()=>j,m7:()=>F,mh:()=>m,pD:()=>$,pM:()=>L,rl:()=>N,w$:()=>y,xy:()=>S,yl:()=>_});var s=n(96951),i=n(29087),o=n(15489),a=n(56371),r=n(1407),l=n(36436),d=n(89175),c=n(86088),h=n(16716),p=n(98010);function u(e,t){let n=e;if(t.displayUrl){const s=(0,l.DP)(e);n=t.displayUrl+(t.copyParams&&s.path?"/"+s.path+"/":"/")}else n="";return n}function g(e,t){const n=(t.url||"").includes("?")?"&":"?",[s,i]=e.slice(t.displayUrl.length).split("?"),o=new URLSearchParams(i);s&&"/"!==s&&o.append("path",(0,l.Iw)(s));const a=t.copyParams&&e.length>t.displayUrl.length?o.toString():"";return(t.url||"")+(a?n+a:"")}const m={general:{title:(0,a.Z)("General"),icon:c.Wt6,group:1},sync:{title:(0,a.Z)("Sync"),icon:c.FWJ,group:1},appearance:{title:(0,a.Z)("Appearance"),icon:c.Eo7,group:2},themes:{title:(0,a.Z)("Themes"),icon:c.U9f,group:2},startpage:{title:(0,a.Z)("title","Start Page"),icon:c.bMS,group:2},tabs:{title:(0,a.Z)("Tabs"),icon:c.Xt4,group:3},panel:{title:(0,a.Z)("title","Panel"),icon:c.bu$,group:3},addressbar:{title:(0,a.Z)("title","Address Bar"),icon:c.gO6,group:3},bookmarks:{title:(0,a.Z)("Bookmarks"),icon:c.Dvg,group:3},search:{title:(0,a.Z)("noun","Search"),icon:c.Hsf,group:3},qc:{title:(0,a.Z)("Quick Commands"),icon:c.f$U,group:4},keyboard:{title:(0,a.Z)("Keyboard"),icon:c.EkX,group:4},mouse:{title:(0,a.Z)("Mouse"),icon:c.j7Q,group:4},privacy:{title:(0,a.Z)("Privacy and Security"),icon:c.xGh,group:5},downloads:{title:(0,a.Z)("Downloads"),icon:c.GEU,group:5},webpages:{title:(0,a.Z)("Webpages"),icon:c.AWt,group:5},network:{title:(0,a.Z)("Network"),icon:c.f2R,group:5},mail:{title:(0,a.Z)("Mail"),icon:c.FbK,group:6},calendar:{title:(0,a.Z)("Calendar"),icon:c.a1L,group:6},rss:{title:(0,a.Z)("Feeds"),icon:c.eGc,group:6},chat:{title:(0,a.Z)("Chat"),icon:c.PyL,group:6},all:{title:(0,a.Z)("Display All"),icon:c.ih3,group:7},reset:{title:(0,a.Z)("Reset All Settings"),icon:c.NQk,group:7}},v={"vivaldi://settings/":"settings","vivaldi://startpage/":"startpage","vivaldi://bookmarks/":"bookmarks","vivaldi://history/":"history","vivaldi://calendar/":"calendar","vivaldi://chat/":"chat","vivaldi://mailpage/":"mailpage","vivaldi://saga/":"saga","chrome://saga/":"saga","vivaldi://guest-intro/":"guest-intro","vivaldi://private-intro/":"private-intro","vivaldi://welcome/":"welcome","vivaldi://themecolors/":"themecolors","vivaldi://experiments/":"experiments","vivaldi://actionlog/":"actionlog","vivaldi://notes/":"notes"},f={"vivaldi://settings/":c.bqs.medium,"vivaldi:settings":c.bqs.medium,"vivaldi://startpage/":c.VPD,"vivaldi:startpage":c.VPD,"vivaldi://bookmarks/":c.CLf.medium,"vivaldi:bookmarks":c.CLf.medium,"vivaldi://history/":c.hcy.medium,"vivaldi:history":c.hcy.medium,"vivaldi://calendar/":c.bcq.medium,"vivaldi:calendar":c.bcq.medium,"vivaldi://chat/":c.yt5.medium,"vivaldi:chat":c.yt5.medium,"vivaldi://mailpage/":c.lvj.medium,"vivaldi:mailpage":c.lvj.medium,"vivaldi://themecolors/":c.jL_,"vivaldi:themecolors":c.jL_,"vivaldi://notes/":c.cyI.medium,"vivaldi:notes":c.cyI.medium,"vivaldi://welcome/":c.UQS,"vivaldi:welcome":c.UQS,"vivaldi://game/":"chrome://game/","vivaldi:game":"chrome://game/","vivaldi://saga/":"chrome://saga/","vivaldi:saga":"chrome://saga/"};function y(e){return e.startsWith("vivaldi:")?f[e]||c.ZuY:e}const C=["settings","startpage","bookmarks","history","calendar","chat","notes","mailpage","private-intro","experiments","vivaldi://flags/","chrome://flags/"],w=["chrome://settings/","chrome://apps/"],b={settings:`${r.oP}/components/settings/settings.html`,startpage:`${r.u7}/startpage`,bookmarks:`${r.u7}/startpage?section=bookmarks`,history:`${r.u7}/startpage?section=history`,notes:`${r.u7}/startpage?section=notes`,calendar:`${r.u7}/startpage?section=calendar`,mailpage:`${r.oP}/components/mail/mail.html`,chat:`${r.oP}/components/mail/chat.html`,saga:`${r.oP}/saga/saga.html`,"guest-intro":`${r.oP}/components/guest-intro/guest-intro.html`,"private-intro":`${r.oP}/components/private-intro/private-intro.html`,welcome:`${r.oP}/components/welcome/welcome.html`,themecolors:`${r.oP}/components/themecolors/themecolors.html`,experiments:`${r.oP}/components/experiments/experiments.html`,actionlog:`${r.oP}/components/actionlog/actionlog.html`},S={...b,about:"chrome://version","vivaldi-urls":"chrome://chrome-urls",blankpage:"about:blank",extensions:"chrome://extensions",game:"chrome://game",saga:"chrome://saga"},I=[S.settings,S.bookmarks,S.history,S.notes,S.calendar,S.mailpage,S.chat,S.themecolors,S.experiments,S.actionlog,S.game],k=[{displayUrl:"vivaldi://history",url:S.history,copyParams:!0},{displayUrl:"vivaldi://calendar",url:S.calendar,copyParams:!0},{displayUrl:"vivaldi://notes",url:S.notes,copyParams:!0},{displayUrl:"vivaldi://bookmarks",url:S.bookmarks,copyParams:!0},{displayUrl:"vivaldi://settings",url:S.settings,copyParams:!0},{displayUrl:"",url:S.startpage,copyParams:!1},{displayUrl:"vivaldi://startpage",url:S.startpage,copyParams:!1,mapDisplayUrlToUrl:(e,t)=>s.ZP.getStartpage(o.ZP.getLastActiveBrowserWindowId())},{displayUrl:"",url:"chrome://newtab",copyParams:!1},{displayUrl:"",url:S.blankpage,copyParams:!1},{displayUrl:"vivaldi://mail",url:S.mailpage,copyParams:!0},{displayUrl:"vivaldi://saga",url:S.saga,copyParams:!0},{displayUrl:"vivaldi://chat",url:S.chat,copyParams:!0},{displayUrl:"vivaldi://about",url:S.about,copyParams:!0},{displayUrl:"vivaldi://help",url:"https://vivaldi.com/help",copyParams:!0},{displayUrl:"vivaldi://vivaldi-urls",url:S["vivaldi-urls"],copyParams:!0},{displayUrl:"vivaldi://extensions",url:"chrome://extensions",copyParams:!0},{displayUrl:"vivaldi://guest-intro",url:S["guest-intro"],copyParams:!0},{displayUrl:"",url:S["private-intro"],copyParams:!0},{displayUrl:"vivaldi://welcome",url:S.welcome,copyParams:!0},{displayUrl:"vivaldi://themecolors",url:S.themecolors,copyParams:!0},{displayUrl:"vivaldi://experiments",url:S.experiments,copyParams:!0},{displayUrl:"vivaldi://actionlog",url:S.actionlog,copyParams:!0},{displayUrl:"vivaldi://game",url:S.game,copyParams:!1},{displayUrl:r.f4,url:r.f4,copyParams:!1,mapUrlToDisplayUrl:e=>e},{displayUrl:"about:about",url:S.about,copyParams:!1},{displayUrl:"chrome://history",url:S.history,copyParams:!0},{displayUrl:"chrome://bookmarks",url:S.bookmarks,copyParams:!0},{displayUrl:"chrome://newtab",mapDisplayUrlToUrl:e=>M(e)?s.ZP.getStartpage(o.ZP.getLastActiveBrowserWindowId()):e,copyParams:!1},{displayUrl:"vivaldi://",url:"chrome://",copyParams:!0,mapDisplayUrlToUrl:(e,t)=>"vivaldi://"===e?S.about:function(e,t){const n=t.copyParams&&e.length>t.displayUrl.length?(0,l.Iw)(e.slice(t.displayUrl.length)):"";return(t.url||"")+n}(e,t),mapUrlToDisplayUrl:(e,t)=>function(e,t){const n=t.copyParams&&e.length>(t.url||"").length?(0,l.Iw)(e.slice((t.url||"").length)):"";return t.displayUrl+n}(e,t)},{displayUrl:"vivaldi:",copyParams:!1,mapDisplayUrlToUrl:e=>{const t=e.indexOf("/"),n=-1===t?e.length:t,s=S[e.substring(8,n)];return s?g(e,{displayUrl:e.substring(0,n),url:s,copyParams:!0}):e}}];function A(e){let t=e;if(-1===t.indexOf("://")){const e=t.indexOf(":");e>-1&&(t=t.slice(0,e)+"://"+t.slice(e+1))}return"/"!==t[t.length-1]&&(t+="/"),t}function T(e){const t=A(e);if(!(t in v))return C.includes(t);const n=v[t];return C.includes(n)}function Z(e){const t=A(e);for(let e=0;e<w.length;e++){const n=w[e];if((0,l.uu)(n,t)||t.startsWith(n))return!0}return!1}function E(e){return D(e)?c.bqs.small:e===S.history?c.hcy.small:e===S.bookmarks?c.CLf.small:e===S.calendar?c.bcq.small:e.startsWith(S.notes)?c.cyI.small:e===S.welcome?c.UQS:M(e)?c.VPD:V(e)?c.lvj.small:function(e){return"string"==typeof e&&0===e.indexOf(S.chat)}(e)?"/resources/vivaldi_chat_default.png":e.startsWith(S.game)?"chrome://favicon/chrome://game/":e.startsWith(S.extensions)?"chrome://favicon/chrome://extensions/":e===S["private-intro"]?c.d7l:void 0}function _(e,t){if(t)return{favIconUrl:t,favIconLoadType:"faviconFromCache"};const n=e?E(e):"";return e&&B(e)&&n?{favIconUrl:n,favIconLoadType:"faviconFromCache"}:{favIconUrl:e??"",favIconLoadType:"page"}}function M(e){const t=i.Z.get(d.kExtensionURLOverrides)?.newtab?.find((e=>e.active)),n=i.Z.get(d.kTabsNewPageLink)===r.Fp.EXTENSION;return t&&n?e===t.entry:e.startsWith("chrome://newtab")||e.startsWith(S.startpage)||e.startsWith("vivaldi://startpage")}function N(e){return e.startsWith("vivaldi://startpage?section=")||e.startsWith(S.bookmarks)||e.startsWith(S.history)||e.startsWith(S.notes)||e.startsWith(S.calendar)||e.startsWith(S.mailpage)||e.startsWith(S.chat)}function P(e,t){return t.length>0&&0===t.indexOf(e)}function D(e){return P(S.settings,e)}const x=Object.keys(S).map((e=>S[e])),O=[...Object.keys(b).map((e=>b[e])),...Object.keys(v)];function L(e){return x.some((t=>e.startsWith(t)))}function R(e){return e.startsWith(S.game)||e.startsWith(S.extensions)}function B(e){return O.some((t=>e.startsWith(t)))}function F(e){return I.some((t=>e.url.startsWith(t)))}function V(e){return"string"==typeof e&&0===e.indexOf(S.mailpage)}function W(e){return 0===e.indexOf(S.notes)}function U(e){const t=e=e.trim();if(e=e?e.toLowerCase():e,h.Z.isEnabled("chrome_pages")&&!e.startsWith("vivaldi:"))return t;const n=k.find((t=>t.displayUrl&&P(t.displayUrl,e)));if(!n)return t;return n.mapDisplayUrlToUrl?n.mapDisplayUrlToUrl(e,n):g(e,n)}function H(e){if($(e))return"";if(""===e||e===r.f4)return r.f4;if(h.Z.isEnabled("chrome_pages")&&!e.startsWith("chrome-extension:"))return e;for(let t=0;t<k.length;t++){const n=k[t];if(n.url&&P(n.url,e)){e=n.mapUrlToDisplayUrl?n.mapUrlToDisplayUrl(e,n):u(e,n);break}}return e}function z(e,t){if(e){if(t||!e.startsWith("https:")&&!e.startsWith("http:")){if(e===S.blankpage)t=(0,a.Z)("title","Blank Page");else if(e.startsWith(S.bookmarks))t=(0,a.Z)("Bookmarks");else if(e.startsWith(S.history))t=(0,a.Z)("History");else if(e.startsWith(S.calendar))t=(0,a.Z)("Calendar");else if(e.startsWith(S.chat)){const n=(0,l.DP)(e).path;t=n?(0,a.Z)(`Chat: ${n}`):(0,a.Z)("Chat")}else if(e.startsWith(S.mailpage)){const n=(0,l.DP)(e).title;n?t=n:t&&"Mail"!==t||(t=(0,a.Z)("Mail"))}else if(e.startsWith(S.notes))t.startsWith(S.notes)&&(t=(0,a.Z)("Notes"));else if(M(e)||M(t))t=(0,a.Z)("browser","Start Page");else if(e===S.experiments)t=(0,a.Z)("Experimental Features");else if(e===S.actionlog)t=(0,a.Z)("Action Log");else if(e===S["guest-intro"])t=(0,a.Z)("Guest Profile Introduction");else if(e===S["private-intro"])t=(0,a.Z)("Private Window Introduction");else if(e===S.welcome)t=(0,a.Z)("Welcome");else if(e.startsWith(S.settings)){const n=(0,l.DP)(e).path,s=n?n.split("/")[0]:"general";t=(0,a.Z)("$1 Settings",m[s]?[m[s].title]:[s])}}else t=(0,p.x0)(e);t===e&&(t=(0,l.Dy)(H(e)))}return t}function G(e){const{title:t="",url:n=""}=e;return z(n,t)}function $(e){return e.startsWith(r.P1)||e.startsWith(r.aI)||e.startsWith(r.Cd)||i.Z.get(d.kExtensionURLOverrides)?.newtab?.some((t=>t.active&&t.entry===e))}function K(e){return e.startsWith(r.P1)||e.startsWith(r.aI)||e.startsWith(r.Cd)||e===r.f4||function(e){return i.Z.get(d.kTabsNewPageLink)===r.Fp.CUSTOM&&i.Z.get(d.kTabsNewPageCustomUrl)===e}(e)||function(e){return i.Z.get(d.kTabsNewPageLink)===r.Fp.HOMEPAGE&&i.Z.get(d.kHomepageCache)===e}(e)||Boolean(i.Z.get(d.kExtensionURLOverrides)?.newtab?.some((t=>t.active&&t.entry===e)))}const j={internals:S,settingCategories:m,isNewTabPage:K,isBannedFromGuestMode:T,isBannedFromPrivateProfileWindows:Z,getExtensionUrlFromInternalProtocolUrl:function(e){return e in v?b[v[e]]:e},getFavicon:function(e){if(B(e)||R(e)){const t=E(e);if(t)return t}},getFaviconWithFallback:function(e,t){if(B(e)||R(e)){const n=E(e);if(n)return n;if(""===t)return"/resources/favicon@2x.png"}else if(""===t)return"/resources/default_favicon_64.png";return t},getBookmarkFavicon:_,getDisplayUrlFromMapping:H,getHoverUrl:function(e){let t=H(e);return""===t&&M(e)&&(t="vivaldi://startpage/"),t},getDisplayTitleByUrl:z,getDisplayTitle:G,hasCustomFavicon:R,removeTrailingSlashWhenNoPath:l.Dy,getUrl:U,isMailPage:V,isNotesManager:W,isStartPage:M,isInternalUrl:L,isVivaldiComponent:B,isExtensionProtocol:function(e){return e.startsWith(r.Fv)},isOurExtension:function(e){return e.substring(0,r.oP.length)===r.oP},isInternalPage:function(e){return L(e.url||"")},isSettingsUrl:D,matchInternal:function(e,t){return P(S[e],t)},matchUrl:P,equalUrl:function(e,t,n){return n?e&&t&&(0,l.OI)(e)===(0,l.OI)(t):e&&t&&(0,l.Iw)(e)===(0,l.Iw)(t)},internalUrl:function(e,t,n,s){const i=S[e],o=i.includes("?")?"&":"?";return i+o+"path="+encodeURIComponent((0,l.Iw)(t))+(n?"&title="+encodeURIComponent(n):"")+(s?"&query="+encodeURIComponent(s):"")}}},14507:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var s=n(67294),i=n(29087);const o=function(e){const[t,n]=s.useState((()=>i.Z.getList(e)));return s.useEffect((()=>{function t(e,t,s){n((e=>({...e,[s]:t})))}return i.Z.addListener(e,t),()=>{i.Z.removeListener(e,t)}}),[e]),t}},86088:(e,t,n)=>{"use strict";n.d(t,{$6R:()=>Eo.a,$II:()=>dl,$O3:()=>p.a,$zT:()=>on.a,ADs:()=>fl,AE4:()=>Sr,AWt:()=>so.a,AXs:()=>ne.a,B$9:()=>qr,BB1:()=>yl,Bd5:()=>sr,Bi0:()=>yo.a,BmN:()=>jo.a,C1I:()=>ye.a,CE8:()=>Fr,CKA:()=>gt.a,CLf:()=>Ka,Clf:()=>c.a,CnO:()=>Br,CtH:()=>dr,D7r:()=>el,DDW:()=>ea.a,DvK:()=>T.a,Dvg:()=>Ci.a,DwE:()=>ol,Dx_:()=>Dl,E2S:()=>ya.a,EEk:()=>nr,EO4:()=>un.a,ERJ:()=>jt.a,EkX:()=>Ni.a,Eki:()=>_n.a,EnF:()=>ur,Eo7:()=>Qs.a,Erb:()=>aa.a,FWJ:()=>Qi.a,F_h:()=>$e.a,FbK:()=>Di.a,Fib:()=>j.a,Fii:()=>$t.a,Fm3:()=>ed,FsT:()=>fs.a,GAD:()=>pr,GEU:()=>Zi.a,GF3:()=>On.a,GH$:()=>Tt.a,GO5:()=>Ga,GmL:()=>en.a,Gpq:()=>X.a,GqE:()=>br,GtN:()=>kl,Gvk:()=>Al,Gyd:()=>xo.a,H0I:()=>Ut.a,HXY:()=>Rs.a,Hj9:()=>Qn.a,Hsf:()=>Ki.a,IJb:()=>$.a,I_V:()=>l.a,Ibx:()=>Hr,IeE:()=>Vt.a,IrQ:()=>co.a,JLz:()=>Pt.a,JUc:()=>bs.a,K08:()=>Ea.a,K30:()=>Gn.a,K3w:()=>Fa,Kt8:()=>Er,KuK:()=>Ul,Kuf:()=>dn.a,KyY:()=>Le.a,L$F:()=>ze.a,LDV:()=>kr,LXK:()=>Bo.a,LaO:()=>cr,LwO:()=>Ds.a,M2k:()=>sl,MEU:()=>ia.a,MLu:()=>we.a,MSA:()=>Ra,MU4:()=>Ta.a,Mqy:()=>Fs.a,NBh:()=>tr,NNg:()=>il,NQk:()=>Wi.a,N_W:()=>nt.a,Nek:()=>Kl,NwZ:()=>Xe.a,NxY:()=>Ml,O$M:()=>Pa.a,OCp:()=>pl,OXd:()=>ro.a,Ofb:()=>na.a,PPL:()=>Fn.a,PaK:()=>za,PbG:()=>bn.a,Pje:()=>xt.a,PyL:()=>Ai.a,Q9E:()=>Gr,QPh:()=>mr,Q_G:()=>Sl,Qa2:()=>Ue.a,Qwh:()=>vr,RXs:()=>ce.a,R_e:()=>Jl,RaS:()=>Mr,Rs2:()=>Nn.a,Rx8:()=>pe.a,S$A:()=>ml,S0Y:()=>Mo.a,S1h:()=>v.a,S8w:()=>qa,SXC:()=>je.a,S_k:()=>Xo.a,Sap:()=>wr,Si$:()=>La,SpM:()=>hi.a,T4m:()=>Vr,T6H:()=>go.a,TVZ:()=>Hl,Tu3:()=>L.a,U9f:()=>bi.a,UEH:()=>Zr,UQS:()=>nn.a,USP:()=>Rl,UTS:()=>xr,U_X:()=>or,Us1:()=>le.a,V34:()=>zt.a,V3h:()=>Lo.a,VA7:()=>ge.a,VLT:()=>et.a,VPD:()=>ti.a,V_c:()=>P.a,Vzw:()=>Ba,W4h:()=>zl,W9U:()=>M.a,W9w:()=>As.a,WHX:()=>Gs.a,W_c:()=>Cs.a,Whf:()=>Me.a,Wjz:()=>$r,Wmx:()=>Ua,Wt6:()=>ri.a,XKb:()=>Is.a,XQw:()=>Ll,XTV:()=>lr,XkM:()=>zo.a,Xt4:()=>Hi.a,XyR:()=>So.a,Y41:()=>Yn.a,YPt:()=>ca.a,YVA:()=>$a,Y_k:()=>Ql,Yaj:()=>Xt.a,YvR:()=>hl,ZU_:()=>Pr,Zgq:()=>ke.a,Znx:()=>Oa,ZsG:()=>Se.a,Zu:()=>Wa,ZuY:()=>oi.a,_9b:()=>Rn.a,_QD:()=>_s.a,_TQ:()=>al,_ZF:()=>di.a,_qK:()=>Tl,_w1:()=>_r,a1L:()=>Ii.a,a8r:()=>yt.a,aAJ:()=>Ar,awi:()=>Gl,b0l:()=>V.a,b2r:()=>os.a,bBV:()=>q.a,bBo:()=>Or,bMS:()=>Yi.a,b_H:()=>To.a,bcq:()=>Ya,boz:()=>x.a,bqs:()=>Zl,bu$:()=>Ji.a,c02:()=>Ys.a,cyI:()=>Nr,d$r:()=>Xr,d7l:()=>Os.a,dHk:()=>S.a,dMx:()=>Tr,dYD:()=>wl,dgq:()=>ae.a,eCP:()=>Ir,eFz:()=>gl,eGc:()=>_i.a,eIC:()=>Js.a,eTI:()=>vo.a,eTS:()=>Xa,eVT:()=>kt.a,ebB:()=>nl,efb:()=>wo.a,f$U:()=>Fi.a,f2R:()=>Ri.a,fHR:()=>ll,fIz:()=>In.a,fSD:()=>pa.a,fbI:()=>mi.a,feS:()=>St.a,feZ:()=>ja,fph:()=>rl,g0V:()=>cl,g1e:()=>ve.a,g4W:()=>Bl,gO6:()=>fi.a,gYX:()=>ko.a,gep:()=>a.a,gpy:()=>Wr,h5j:()=>ie.a,h6:()=>Et.a,hCY:()=>Jn.a,hGk:()=>Cr,hR9:()=>Il,hXX:()=>it.a,hcy:()=>ar,heI:()=>Pe.a,iD7:()=>E.a,ibx:()=>Wn.a,ih3:()=>Gi.a,irc:()=>vt.a,izi:()=>Ur,j7Q:()=>Oi.a,jBF:()=>qo.a,jL_:()=>si.a,jLt:()=>la.a,jVs:()=>Ol,jtA:()=>Ha,kY4:()=>er,kkq:()=>rs.a,kze:()=>Bt.a,l0O:()=>Ja,lIQ:()=>ct.a,lOb:()=>Cl,lku:()=>ui.a,lqP:()=>va.a,lrx:()=>i.a,lvj:()=>rr,mHT:()=>Zs.a,mU8:()=>Xl,mXV:()=>rn.a,md4:()=>tl,mgF:()=>Va,mhq:()=>$o.a,myO:()=>Nl,nY6:()=>Yl,nfH:()=>xe.a,nl:()=>$l,nlo:()=>jl,nre:()=>Fl,nuh:()=>ql,nyn:()=>El,nzH:()=>wa.a,o7J:()=>Ks.a,oG:()=>Ma.a,oJy:()=>B.a,oMs:()=>Qr,o_8:()=>Po.a,o_D:()=>ds.a,oa7:()=>g.a,och:()=>fr,onV:()=>Uo.a,onv:()=>y.a,ooy:()=>Cn.a,owS:()=>k.a,q7H:()=>ts.a,qHs:()=>An.a,qR:()=>ka.a,rNG:()=>Kr,rR8:()=>Vo.a,rnU:()=>Ws.a,rpm:()=>_l,rr$:()=>hs.a,rvX:()=>Lr,s2Z:()=>bl,sBl:()=>Kn.a,sWI:()=>at.a,saO:()=>ga.a,sgm:()=>Jr,slH:()=>Ns.a,sss:()=>Be.a,ssx:()=>Dr,svj:()=>Sa.a,sxI:()=>xl,sxZ:()=>zr,tD0:()=>Hn.a,tG3:()=>hn.a,tRc:()=>xa.a,u0H:()=>U.a,uIM:()=>Lt.a,uN0:()=>wt.a,uUH:()=>oo.a,uWq:()=>Hs.a,uZ2:()=>fn.a,upG:()=>yr,uw2:()=>ee.a,v2I:()=>ss.a,v5q:()=>jr,v9y:()=>Rr,vOf:()=>pt.a,vh3:()=>qt.a,viW:()=>Mt.a,vvh:()=>vl,vxN:()=>ms.a,vyJ:()=>Te.a,wHY:()=>w.a,wTH:()=>Zn.a,weK:()=>lt.a,wo7:()=>Qa,x6W:()=>hr,xGh:()=>to.a,xwB:()=>po.a,yYJ:()=>mn.a,yaZ:()=>ul,yhu:()=>Yr,yt5:()=>ir,z8c:()=>Pl,zDC:()=>Ve.a,zKr:()=>qe.a,zLp:()=>gr,zTz:()=>Dn.a,ze0:()=>Ee.a,zlZ:()=>Wl,znb:()=>us.a,zpg:()=>Vl,zwh:()=>z.a});var s=n(19458),i=n.n(s),o=n(72864),a=n.n(o),r=n(89237),l=n.n(r),d=n(36561),c=n.n(d),h=n(32721),p=n.n(h),u=n(379),g=n.n(u),m=n(24461),v=n.n(m),f=n(51843),y=n.n(f),C=n(55070),w=n.n(C),b=n(81766),S=n.n(b),I=n(99634),k=n.n(I),A=n(95460),T=n.n(A),Z=n(72103),E=n.n(Z),_=n(96569),M=n.n(_),N=n(79537),P=n.n(N),D=n(72796),x=n.n(D),O=n(19096),L=n.n(O),R=n(4044),B=n.n(R),F=(n(62525),n(69710)),V=n.n(F),W=n(4799),U=n.n(W),H=n(78297),z=n.n(H),G=n(6055),$=n.n(G),K=n(12340),j=n.n(K),Y=n(85749),X=n.n(Y),Q=(n(31789),n(77448)),q=n.n(Q),J=n(44231),ee=n.n(J),te=n(66413),ne=n.n(te),se=n(50108),ie=n.n(se),oe=n(534),ae=n.n(oe),re=n(71632),le=n.n(re),de=n(31039),ce=n.n(de),he=n(98254),pe=n.n(he),ue=n(87338),ge=n.n(ue),me=n(62133),ve=n.n(me),fe=n(98258),ye=n.n(fe),Ce=n(95912),we=n.n(Ce),be=n(19500),Se=n.n(be),Ie=n(97272),ke=n.n(Ie),Ae=n(57396),Te=n.n(Ae),Ze=n(86839),Ee=n.n(Ze),_e=n(10307),Me=n.n(_e),Ne=n(61065),Pe=n.n(Ne),De=n(4103),xe=n.n(De),Oe=n(9428),Le=n.n(Oe),Re=n(36186),Be=n.n(Re),Fe=n(79026),Ve=n.n(Fe),We=n(3783),Ue=n.n(We),He=n(41868),ze=n.n(He),Ge=n(42450),$e=n.n(Ge),Ke=n(96019),je=n.n(Ke),Ye=n(90014),Xe=n.n(Ye),Qe=n(53001),qe=n.n(Qe),Je=n(49336),et=n.n(Je),tt=n(1652),nt=n.n(tt),st=(n(33851),n(54558)),it=n.n(st),ot=n(50983),at=n.n(ot),rt=n(44425),lt=n.n(rt),dt=n(38037),ct=n.n(dt),ht=n(28186),pt=n.n(ht),ut=(n(3335),n(94220)),gt=n.n(ut),mt=n(35732),vt=n.n(mt),ft=n(63267),yt=n.n(ft),Ct=n(42822),wt=n.n(Ct),bt=n(23641),St=n.n(bt),It=(n(92800),n(23942)),kt=n.n(It),At=n(28676),Tt=n.n(At),Zt=n(76667),Et=n.n(Zt),_t=n(25531),Mt=n.n(_t),Nt=n(75124),Pt=n.n(Nt),Dt=n(32783),xt=n.n(Dt),Ot=n(39135),Lt=n.n(Ot),Rt=n(43380),Bt=n.n(Rt),Ft=n(43951),Vt=n.n(Ft),Wt=(n(83159),n(82474)),Ut=n.n(Wt),Ht=n(67905),zt=n.n(Ht),Gt=n(24073),$t=n.n(Gt),Kt=n(34166),jt=n.n(Kt),Yt=n(83035),Xt=n.n(Yt),Qt=n(27063),qt=n.n(Qt),Jt=n(98353),en=n.n(Jt),tn=n(83557),nn=n.n(tn),sn=(n(74314),n(457)),on=n.n(sn),an=n(68914),rn=n.n(an),ln=n(83),dn=n.n(ln),cn=(n(95174),n(52725)),hn=n.n(cn),pn=n(40695),un=n.n(pn),gn=n(4464),mn=n.n(gn),vn=n(77298),fn=n.n(vn),yn=n(24885),Cn=n.n(yn),wn=n(59678),bn=n.n(wn),Sn=n(50973),In=n.n(Sn),kn=n(34755),An=n.n(kn),Tn=n(75291),Zn=n.n(Tn),En=n(77729),_n=n.n(En),Mn=n(88609),Nn=n.n(Mn),Pn=n(85847),Dn=n.n(Pn),xn=n(72897),On=n.n(xn),Ln=n(37966),Rn=n.n(Ln),Bn=n(62681),Fn=n.n(Bn),Vn=n(71387),Wn=n.n(Vn),Un=n(24566),Hn=n.n(Un),zn=n(4856),Gn=n.n(zn),$n=n(49244),Kn=n.n($n),jn=n(17737),Yn=n.n(jn),Xn=n(29622),Qn=n.n(Xn),qn=n(90205),Jn=n.n(qn),es=(n(6836),n(25650)),ts=n.n(es),ns=n(41028),ss=n.n(ns),is=n(22713),os=n.n(is),as=n(57842),rs=n.n(as),ls=n(71360),ds=n.n(ls),cs=n(92636),hs=n.n(cs),ps=n(70773),us=n.n(ps),gs=n(37362),ms=n.n(gs),vs=n(76992),fs=n.n(vs),ys=n(41885),Cs=n.n(ys),ws=n(7246),bs=n.n(ws),Ss=n(10681),Is=n.n(Ss),ks=n(54472),As=n.n(ks),Ts=n(269),Zs=n.n(Ts),Es=n(86721),_s=n.n(Es),Ms=n(65438),Ns=n.n(Ms),Ps=n(94537),Ds=n.n(Ps),xs=n(2018),Os=n.n(xs),Ls=n(19194),Rs=n.n(Ls),Bs=n(19914),Fs=n.n(Bs),Vs=n(74836),Ws=n.n(Vs),Us=n(61373),Hs=n.n(Us),zs=n(1149),Gs=n.n(zs),$s=n(19016),Ks=n.n($s),js=n(26055),Ys=n.n(js),Xs=(n(98913),n(8197)),Qs=n.n(Xs),qs=n(37032),Js=n.n(qs),ei=(n(63818),n(95331)),ti=n.n(ei),ni=n(35024),si=n.n(ni),ii=n(43893),oi=n.n(ii),ai=(n(20277),n(2035)),ri=n.n(ai),li=n(87710),di=n.n(li),ci=n(67651),hi=n.n(ci),pi=n(16761),ui=n.n(pi),gi=n(21922),mi=n.n(gi),vi=n(80224),fi=n.n(vi),yi=n(99353),Ci=n.n(yi),wi=n(59818),bi=n.n(wi),Si=n(66969),Ii=n.n(Si),ki=n(33181),Ai=n.n(ki),Ti=n(85730),Zi=n.n(Ti),Ei=n(81456),_i=n.n(Ei),Mi=n(31415),Ni=n.n(Mi),Pi=n(99366),Di=n.n(Pi),xi=n(40068),Oi=n.n(xi),Li=n(90913),Ri=n.n(Li),Bi=n(21684),Fi=n.n(Bi),Vi=n(23390),Wi=n.n(Vi),Ui=n(26680),Hi=n.n(Ui),zi=n(82128),Gi=n.n(zi),$i=n(78781),Ki=n.n($i),ji=n(84440),Yi=n.n(ji),Xi=n(22670),Qi=n.n(Xi),qi=n(69478),Ji=n.n(qi),eo=n(84854),to=n.n(eo),no=n(91689),so=n.n(no),io=n(76611),oo=n.n(io),ao=n(81606),ro=n.n(ao),lo=n(23389),co=n.n(lo),ho=n(33802),po=n.n(ho),uo=n(62759),go=n.n(uo),mo=n(52496),vo=n.n(mo),fo=n(86696),yo=n.n(fo),Co=n(33674),wo=n.n(Co),bo=n(15633),So=n.n(bo),Io=n(40216),ko=n.n(Io),Ao=n(15479),To=n.n(Ao),Zo=n(59250),Eo=n.n(Zo),_o=n(329),Mo=n.n(_o),No=n(37689),Po=n.n(No),Do=n(47304),xo=n.n(Do),Oo=n(92732),Lo=n.n(Oo),Ro=n(5231),Bo=n.n(Ro),Fo=n(27514),Vo=n.n(Fo),Wo=n(10311),Uo=n.n(Wo),Ho=n(94192),zo=n.n(Ho),Go=n(98835),$o=n.n(Go),Ko=n(35533),jo=n.n(Ko),Yo=n(16433),Xo=n.n(Yo),Qo=n(90801),qo=n.n(Qo),Jo=n(16228),ea=n.n(Jo),ta=n(3843),na=n.n(ta),sa=n(84175),ia=n.n(sa),oa=n(32148),aa=n.n(oa),ra=n(39281),la=n.n(ra),da=n(60439),ca=n.n(da),ha=n(66246),pa=n.n(ha),ua=n(13450),ga=n.n(ua),ma=(n(72225),n(33663),n(40469)),va=n.n(ma),fa=n(26944),ya=n.n(fa),Ca=n(43059),wa=n.n(Ca),ba=n(61637),Sa=n.n(ba),Ia=n(16097),ka=n.n(Ia),Aa=n(18972),Ta=n.n(Aa),Za=n(46736),Ea=n.n(Za),_a=n(53629),Ma=n.n(_a),Na=n(29680),Pa=n.n(Na),Da=n(72823),xa=n.n(Da);const Oa={small:n(24319),medium:n(24319),large:n(19222)},La={small:n(70913),medium:n(20643),large:n(32727)},Ra={small:n(39567),medium:n(28676),large:n(39293)},Ba=(n(53548),n(74169),n(85880),{small:n(15275),medium:n(15275),large:n(15275)}),Fa={small:n(19713),medium:n(19713),large:n(19713)},Va={small:n(46685),medium:n(29629),large:n(83766)},Wa={small:n(6198),medium:n(89654),large:n(73175)},Ua={small:n(27308),medium:n(4819),large:n(41381)},Ha={small:n(23588),medium:n(79257),large:n(21656)},za={small:n(79639),medium:n(10737),large:n(61977)},Ga={small:n(81315),medium:n(95574),large:n(42606)},$a={small:n(61947),medium:n(52893),large:n(92624)},Ka={small:n(31734),medium:n(48446),large:n(80401)},ja=(n(16508),n(16508),n(16508),{small:n(20477),medium:n(20477),large:n(97624)}),Ya={small:n(92529),medium:n(33395),large:n(30324)},Xa=(n(2365),n(2365),n(2365),{small:n(28586),medium:n(28586),large:n(28586)}),Qa={small:n(52504),medium:n(81693),large:n(24042)},qa={small:n(83303),medium:n(83303),large:n(83303)},Ja=(n(34167),n(34167),n(34167),n(46708),n(46708),n(46708),{small:n(34923),medium:n(34923),large:n(34923)}),er={small:n(68777),medium:n(14021),large:n(62234)},tr={small:n(38368),medium:n(38368),large:n(38368)},nr={small:n(82152),medium:n(82152),large:n(82152)},sr={small:n(82453),medium:n(82453),large:n(82453)},ir={small:n(51555),medium:n(5096),large:n(46292)},or=(n(30135),n(30135),n(30135),{small:n(43951),medium:n(37512),large:n(17554)}),ar={small:n(3335),medium:n(66089),large:n(61701)},rr=(n(91273),n(91273),n(91273),{small:n(90658),medium:n(54255),large:n(77927)}),lr=(n(52462),n(52462),n(52462),{small:n(67955),medium:n(31408),large:n(66665)}),dr={small:n(44309),medium:n(37893),large:n(37893)},cr={small:n(83075),medium:n(54098),large:n(20334)},hr=(n(38546),n(38546),n(38546),{small:n(30808),medium:n(96387),large:n(7096)}),pr={small:n(71311),medium:n(25259),large:n(25259)},ur={small:n(89316),medium:n(94543),large:n(76047)},gr={small:n(39139),medium:n(64827),large:n(82720)},mr={small:n(64207),medium:n(11331),large:n(61921)},vr={small:n(15901),medium:n(66706),large:n(74486)},fr={small:n(58530),medium:n(58530),large:n(58530)},yr={small:n(56475),medium:n(59168),large:n(2157)},Cr={small:n(10945),medium:n(51299),large:n(6672)},wr={small:n(70531),medium:n(67461),large:n(31916)},br={small:n(39530),medium:n(82032),large:n(50252)},Sr={small:n(31560),medium:n(98626),large:n(49494)},Ir={small:n(97888),medium:n(49602),large:n(80848)},kr={small:n(15331),medium:n(73391),large:n(50112)},Ar={small:n(44895),medium:n(58480),large:n(96409)},Tr=(n(77298),n(77298),n(77298),n(8431),n(8431),n(8431),n(52529),n(52529),n(52529),{small:n(53165),medium:n(53165),large:n(53165)}),Zr={small:n(27476),medium:n(34830),large:n(41601)},Er={small:n(14737),medium:n(71318),large:n(4504)},_r={small:n(7773),medium:n(5211),large:n(59753)},Mr={small:n(2039),medium:n(2039),large:n(2039)},Nr={small:n(60381),medium:n(10933),large:n(5597)},Pr=(n(91329),n(91329),n(91329),{small:n(28481),medium:n(81346),large:n(45146)}),Dr=(n(21287),n(21287),n(21287),{small:n(45016),medium:n(45016),large:n(39414)}),xr={small:n(29832),medium:n(29832),large:n(59936)},Or={small:n(71775),medium:n(71775),large:n(67159)},Lr={small:n(30249),medium:n(30249),large:n(5843)},Rr={small:n(17792),medium:n(34861),large:n(5713)},Br={small:n(21956),medium:n(21956),large:n(11628)},Fr={small:n(44042),medium:n(44042),large:n(44042)},Vr={small:n(79645),medium:n(79645),large:n(79645)},Wr={small:n(51474),medium:n(51474),large:n(51474)},Ur={small:n(55430),medium:n(61063),large:n(25075)},Hr=(n(15902),n(15902),n(15902),{small:n(44474),medium:n(52381),large:n(47062)}),zr={small:n(59098),medium:n(19423),large:n(71303)},Gr={small:n(70636),medium:n(70636),large:n(28786)},$r={small:n(89702),medium:n(89702),large:n(96837)},Kr={small:n(82418),medium:n(48082),large:n(47802)},jr={small:n(94411),medium:n(94411),large:n(94411)},Yr={small:n(95846),medium:n(95846),large:n(95846)},Xr={small:n(71475),medium:n(71475),large:n(71475)},Qr={small:n(89576),medium:n(89576),large:n(89576)},qr={small:n(95369),medium:n(95369),large:n(95369)},Jr={small:n(96970),medium:n(37028),large:n(37028)},el={small:n(17183),medium:n(96676),large:n(96676)},tl=(n(78754),n(78754),n(78754),{small:n(28796),medium:n(43099),large:n(3009)}),nl={small:n(42041),medium:n(1587),large:n(20939)},sl={small:n(78670),medium:n(58579),large:n(91086)},il={small:n(83947),medium:n(84435),large:n(64086)},ol={small:n(59607),medium:n(78553),large:n(78553)},al={small:n(64750),medium:n(94012),large:n(94012)},rl={small:n(4103),medium:n(4103),large:n(4103)},ll={small:n(27139),medium:n(27139),large:n(27139)},dl={small:n(31102),medium:n(31102),large:n(31102)},cl={small:n(16441),medium:n(16441),large:n(16441)},hl=(n(67567),n(67567),n(67567),n(43085),n(43085),n(43085),{small:n(5983),medium:n(4868),large:n(80526)}),pl={small:n(89170),medium:n(89170),large:n(89170)},ul={small:n(60018),medium:n(60018),large:n(77737)},gl={small:n(10307),medium:n(10307),large:n(99785)},ml={small:n(86839),medium:n(86839),large:n(91004)},vl={small:n(80162),medium:n(80162),large:n(80162)},fl={small:n(23634),medium:n(23634),large:n(23634)},yl={small:n(88111),medium:n(88111),large:n(88111)},Cl={small:n(4266),medium:n(4266),large:n(60839)},wl={small:n(68189),medium:n(68189),large:n(33329)},bl={small:n(385),medium:n(44278),large:n(82003)},Sl={small:n(29086),medium:n(98434),large:n(705)},Il={small:n(16619),medium:n(16619),large:n(82450)},kl={small:n(29047),medium:n(50227),large:n(42225)},Al=(n(59260),n(32132),n(24344),{small:n(58615),medium:n(97093),large:n(61401)}),Tl={small:n(57358),medium:n(82214),large:n(61364)},Zl={small:n(89052),medium:n(62675),large:n(25382)},El={small:n(27436),medium:n(30651),large:n(46202)},_l={small:n(46038),medium:n(51008),large:n(1691)},Ml={small:n(32545),medium:n(2144),large:n(9652)},Nl=(n(31866),n(31866),n(31866),{small:n(78823),medium:n(78823),large:n(32376)}),Pl={small:n(56035),medium:n(56035),large:n(39705)},Dl={small:n(1313),medium:n(1313),large:n(83062)},xl={small:n(64916),medium:n(64916),large:n(40178)},Ol={small:n(53514),medium:n(53514),large:n(65961)},Ll={small:n(78990),medium:n(87268),large:n(87268)},Rl={small:n(45243),medium:n(45243),large:n(45243)},Bl={small:n(61453),medium:n(61453),large:n(61453)},Fl={small:n(3895),medium:n(14302),large:n(38146)},Vl={small:n(42705),medium:n(42705),large:n(42705)},Wl={small:n(24638),medium:n(24638),large:n(24638)},Ul={small:n(3638),medium:n(3638),large:n(3638)},Hl={small:n(49823),medium:n(43927),large:n(43927)},zl={small:n(4072),medium:n(9326),large:n(9326)},Gl={small:n(36055),medium:n(9027),large:n(9027)},$l={small:n(35237),medium:n(72272),large:n(72272)},Kl={small:n(59301),medium:n(90077),large:n(90077)},jl={small:n(62067),medium:n(22485),large:n(22485)},Yl={small:n(23217),medium:n(49989),large:n(49989)},Xl={small:n(39564),medium:n(39564),large:n(39564)},Ql={small:n(80490),medium:n(33520),large:n(33520)},ql={small:n(1293),medium:n(27470),large:n(33943)},Jl={small:n(81789),medium:n(66510),large:n(66627)},ed=(n(8797),n(92484),n(70204),{small:n(85569),medium:n(85569),large:n(85569)})},28515:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var s=n(65398),i=n(33638);let o;class a extends s.Z{getDraftIdAndCancelDraftUpdates(){if(o)return o.cancelPendingChanges(),o.props.searchListId}getMessagePromise(){return o?o.buildMessage():Promise.resolve()}getComposer(){return o}dispatchAction(e){switch(e.actionType){case"MAIL_SET_ACTIVE_COMPOSER":o!==e.mailComposer&&(o=e.mailComposer);break;case"MAIL_CLEAR_ACTIVE_COMPOSER":o===e.mailComposer&&(o=void 0);break;case"MAIL_ACTIVE_COMPOSER_MODAL":e.noRecipients&&this.emitChange("noRecipients")}}}const r=new a(i.Z)},39005:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var s=n(65398),i=n(29087),o=n(33638),a=n(75401),r=n(84283),l=n(89165),d=n(89175),c=n(27569),h=n(76257);class p extends s.Z{#ve;getActiveMessage(){return this.#ve&&this.#ve.state.message}getActiveMessageUrl(){const e=this.getActiveMessage();return e?`vivaldi://mail/message/${e.id}`:void 0}getActiveListEntry(){return this.#ve&&this.#ve.props.listEntry}getAttachments(){return this.#ve&&this.#ve.state.message?this.#ve.state.message.bodyParts?(0,c.yN)(this.#ve.state.message.bodyParts).filter((e=>!e.inUse)):this.#ve.state.raw?(0,h.Dc)(this.#ve.state.raw.mimeTree):[]:[]}getRaw(){return this.#ve&&this.#ve.state.raw}getRenderingMethod(){return this.#ve?.state.renderingMethod??i.Z.get(d.kMailPreferredRendering)}getIsRawMode(){return Boolean("raw"===this.#ve?.state.renderingMethod)}isTrash(){return!(!this.#ve||!this.#ve.props.listEntry)&&r.Z.isMessageDeleted(this.#ve.props.listEntry.sources)}isJunk(){if(this.#ve&&this.#ve.props.listEntry){const{sources:e,flags:t}=this.#ve.props.listEntry;return(0,l.Z)(e,t)}return!1}isArchived(){return!(!this.#ve||!this.#ve.props.listEntry)&&(0,a.Z)(this.#ve.props.listEntry.sources)}isListPost(){return!!this.#ve?.state.message?.listPost}toggleRenderingMethod(e){this.#ve&&this.#ve.toggleRenderingMethod(e)}dispatchAction(e){switch(e.actionType){case"MAIL_SET_ACTIVE_COMPONENT":this.#ve!==e.mailDetail&&(this.#ve=e.mailDetail,this.emitChange());break;case"MAIL_SET_ACTIVE_MESSAGE":this.#ve&&(this.#ve.setState({message:e.message}),this.emitChange());break;case"MAIL_CLEAR_IF_ACTIVE":this.#ve===e.mailDetail&&(this.#ve=void 0,this.emitChange());break;case"MAIL_INDEX_UPDATE":{const{updates:t}=e;if(!this.#ve||!this.#ve.props.listEntry||!t.sleUpdates)return;const{id:n}=this.#ve.props.listEntry;t.sleUpdates.some((e=>e.id===n))&&this.emitChange();break}case"MAIL_REFRESH_ACTIVE_MESSAGE":this.emitChange()}}}const u=new p(o.Z)},30626:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var s=n(65398),i=n(33638);const o=new Map;class a extends s.Z{getActiveWebView(e){return o.get(e)}dispatchAction(e){switch(e.actionType){case"WEBVIEW_CLEAR_IF_ACTIVE":this.getActiveWebView(e.windowId)===e.component&&(o.delete(e.windowId),this.emitChange());break;case"WEBVIEW_SET_ACTIVE":o.set(e.windowId,e.component),this.emitChange()}}}const r=new a(i.Z)},59486:(e,t,n)=>{"use strict";n.d(t,{Ei:()=>C,SZ:()=>w,ZP:()=>$,q3:()=>v,wz:()=>y});var s=n(65398),i=n(68247),o=n(29087),a=n(93974),r=n(33638),l=n(56371),d=n(92292),c=n(30460),h=n(65741),p=n(20511),u=n(89175),g=n(44850);const m="0",v="1",f="2",y="3",C=(0,l.Z)("Bookmarks"),w=v;let b={id:v,url:"",title:"",nickname:"",description:"",thumbnail:"",partner:"",speeddial:!1,themeColor:"",bookmarkbar:!1,trash:!1,children:[]};const S=(new Map).set(b.id,b),I=new Map;let k=!1,A=b,T=[],Z={},E=[],_=[],M=!1,N=!1,P=!1;function D(e,t){const{url:n,title:s,description:i,nickname:o}=e;return t.toLowerCase().split(" ").every((e=>n!==c.p&&n?.toLowerCase().includes(e)||s.toLowerCase().includes(e)||i.toLowerCase().includes(e)||o.toLowerCase().includes(e)))}class x extends s.Z{hasBeenInitialized(){return k}getRootNode(){return b}getRootId(){return b.id}getTopNodes(){return b.children||[]}getLastTopNode(){const e=G.getTopNodes();if(e.length>1)return e[e.length-2]}getBookmarkBarFolderId(){return A.id}getBookmarksBarNodes(){return T}getSpeeddialFolders(){return E}isFailedUpgrade(){return P}getItemById(e){return S.get(e)}getUrlByNode(e){return e.url&&G.filterUrl(e.url)||""}filterUrl(e){return e===c.p?"":e}getDragData(e,t){const n=t.map((e=>G.getItemById(e))).filter(Boolean);if("text/plain"===e){const e=[];return n.forEach((t=>{const n=G.isFolder(t)?t.title:g.jk.getHoverUrl(G.getUrlByNode(t));e.push(n)})),e.join("\r\n")}if("text/html"===e){const e=n&&1===n.length?n[0]:void 0;if(e){const t=g.jk.getHoverUrl(G.getUrlByNode(e));if(t&&e.title)return"<a href="+t+">"+e.title+"</a>"}return""}if("vivaldi/x-title"===e)return n[0]&&n[0].title||"";if("text/uri-list"===e||"vivaldi/x-uri-list"===e){const e=[];return n.forEach((t=>{G.isFolder(t)||e.push(g.jk.getHoverUrl(G.getUrlByNode(t)))})),e.join("\r\n")}return""}getCutIds(){return _}getFilteredTree(e,t){e=e.toLowerCase();const n=[];function s(i){const o=[];for(const a of i)if(t.inTrash||!a.trash){if(a.children?.length){const e=s(a.children);if(e.length&&t.folders){o.push({...a,children:e});continue}}if(D(a,e)){const e={...a};a.children&&t.folders&&n.push(a.id),e.children&&t.folders&&o.push({...e,children:s(e.children)}),!e.children&&t.bookmarks&&o.push(e)}}return o}return{nodes:t.root?s([G.getRootNode()]):s(G.getTopNodes()),collapsed:n}}getFilteredFlat(e,t){e=e.toLowerCase();const n=[],s=G.iterateTrees(G.getTopNodes(),t.inTrash);for(const i of s)(i.children&&t.folders||!i.children&&t.bookmarks)&&D(i,e)&&(i.children?n.push({...i,children:[]}):n.push({...i}));return n}treeSortComparator(e,t,n){if(e.trash)return 1;if(t.trash)return-1;if(G.isFolder(e)&&!G.isFolder(t))return-1;if(G.isFolder(t)&&!G.isFolder(e))return 1;const{sortOrder:s}=n;let{sortField:i}=n;e[i]||t[i]||(i="title",e[i]||t[i]||(i="dateAdded"));return a.Z.getDefaultComparator(s,i)(e,t)}getFoldersWithin(e,t){return e.filter((e=>!e.trash&&e.children&&!e.url)).reduce(((e,{id:n,title:s,children:i})=>(e.push({id:n,title:s,level:t}),i?e.concat(G.getFoldersWithin(i,t+1)):e)),[])}hasNickname(e){if(""===e.trim())return!1;e=e.toLowerCase();for(const t of G.iterateTree())if(e===t.nickname.toLowerCase())return!0;return!1}getNicknamed(e,t){if("string"!=typeof e||e.length<1)return[];e=e.toLowerCase();const n=[];for(const s of G.iterateTree())e===s.nickname.toLowerCase()&&(s.children?t?s.children.forEach((e=>G.isBookmark(e)&&n.push(e))):n.push(s):G.isBookmark(s)&&n.push(s));return n}getDefaultFolderName(){return(0,l.Z)("title","New Folder")}isTrashed(e){return G.isDescendantOf(e,Z.id)}isDescendantOf(e,t){for(;;){if(e.id===t)return!0;if(!e.parentId)break;const n=e.parentId?S.get(e.parentId):void 0;if(!n)break;e=n}return!1}isFolder(e){return e.children&&e.children.length>0||void 0===e.url}isPartner(e){return Boolean(e.partner)}isSeparator(e){return"---"===e.title&&"separator"===e.description}isBookmark(e){return!G.isFolder(e)&&!G.isSeparator(e)&&Boolean(e.url?.length)&&e.url!==c.p}validateAsBookmarkBarFolder(e){const t=G.getItemById(e);if(t&&t.children&&!G.isTrashed(t))return t}validateForClipboard(e){return e.filter((e=>e!==Z.id&&e!==y))}validateForDrag(e){return e.filter((e=>e!==Z.id&&e!==y))}validateForDeletion(e){return e.filter((e=>e!==Z.id&&e!==y))}validateForEdit(e){if(-1!==[m,v,f,y,Z.id].indexOf(e))return!1;const t=G.getItemById(e);return!(!t||G.isSeparator(t))}getTitle(e){const t=G.getItemById(e);return t?t.title:""}*iterateTree(){yield*G.iterateTrees(b.children||[])}*iterateTrees(e,t){for(const n of e)n.trash&&!t||(yield n,n.children&&(yield*G.iterateTrees(n.children,t)))}findByUrl(e){for(const t of G.iterateTree())if(t.url===e)return t}isReady(){return k}emitChange(){M?N=!0:super.emitChange()}__reset({bookmarks:e}){b=e}dispatchAction(e){switch(e.actionType){case"BOOKMARKS_INIT":!function(e,t,n){k=!0;const s=e[0];b=s.children[0],b.id!==v&&console.error("Unexpcted root bookmark id");b.parentId=void 0;const i=s.children.find((e=>e.id===y));i&&(i.parentId=b.id,i.index=b.children.length,b.children.push(i));if(Z=s.children.find((e=>Boolean(e.trash))),Z.parentId=b.id,Z.index=b.children.length,b.children.push(Z),I.clear(),Array.isArray(n.folders))for(const e of n.folders)I.set(e.guid,e.title);S.clear(),B(b),V(),P=t}(e.bookmarks,e.failedUpgrade,e.partnerDB),this.emitChange();break;case"BOOKMARKS_SET_BATCH_MODE":e.edit?M=!0:(M=!1,N&&(this.emitChange(),N=!1));break;case"BOOKMARKS_ADD_ITEM":W(e.changes);break;case"BOOKMARKS_CHANGE_ITEM":!function(e,t){let n=S.get(e);if(!n)return;let s=!1;for(const e of Object.keys(t))if(t[e]!==n[e]){s=!0;break}if(!s)return;const i=n.bookmarkbar||t.bookmarkbar!==n.bookmarkbar,o=n.speeddial||t.speeddial!==n.speeddial;n={...n,...t},S.set(n.id,n);let a=null;n.parentId?(a=S.get(n.parentId),a&&a.children&&(void 0!==n.index?a.children[n.index]=n:(a.children[0]=n,console.error("Bookmark node not properly changed. index is missing")))):b.children=n.children||[];a&&z(a,i,o);G.emitChange()}(e.id,e.changes);break;case"BOOKMARKS_MOVE_ITEM":!function(e,t){const n=G.getItemById(e);if(!n)return;U(e,!1),n.parentId=t.parentId,n.index=t.index,W(n)}(e.id,e.changes);break;case"BOOKMARKS_REMOVE_ITEM":U(e.id,!0);break;case"BOOKMARKS_SET_CUT_IDS":L(e.ids),this.emitChange();break;case"WINDOW_READY":_.length>0&&R(!0)}}}function O(e){"Escape"===e.key&&L([])}function L(e){_=e,R(e.length>0),G.emitChange()}function R(e){e?d.Z.extension.getViews().forEach((e=>{e.addEventListener("keydown",O,!0)})):d.Z.extension.getViews().forEach((e=>e.removeEventListener("keydown",O,!0)))}function B(e){if(e.partner){const t=I.get(e.partner);if(t)switch(t){case"Bookmarks":e.title=C;break;case"Speed Dial":e.title=(0,l.Z)("Speed Dial");break;case"Vivaldi":e.title=(0,l.Z)("Vivaldi")}}if(S.set(e.id,e),e.children)for(const t of e.children)B(t)}function F(e){if(S.delete(e.id),e.children)for(const t of e.children)F(t)}function V(){const e={speeddial:[],bookmarkbar:void 0},t=function(n){n.url||n.trash||(n.speeddial&&e.speeddial.push(n),n.bookmarkbar&&(e.bookmarkbar=n),n.children&&n.children.forEach(t))};b.children&&b.children.forEach(t),E=function(e){if(e.length<2)return e;let t=[...o.Z.get(u.kStartpageSpeedDialOrder)];if(t.length){const n=e.map((e=>e.id),[]);n.length&&t.length&&((0,h.Z)(n.sort(),t.sort())||(t=t.filter((e=>n.includes(e))),t=(0,p.Z)(t,n),i.Z.set(u.kStartpageSpeedDialOrder,t))),e.sort(((e,n)=>t.indexOf(e.id)>t.indexOf(n.id)?1:-1))}return e}(e.speeddial),A=e.bookmarkbar||b,T=(A.children||[]).filter((e=>!e.trash))}function W(e){const t=e.parentId?S.get(e.parentId):void 0;if(t){const n=t;void 0===e.url&&(e.children||(e.children=[])),B(e),n.children?.splice(e.index||0,0,e),H(n);z(n,!1,Boolean(e.speeddial))}G.emitChange()}function U(e,t){const n=S.get(e);if(!n)return;F(n);const s=n.parentId?S.get(n.parentId):void 0;if(s){const t=s;void 0!==n.index?t.children?.splice(n.index,1):console.error("Bookmark node not removed. index is missing"),H(t);z(t,G.getBookmarkBarFolderId()===e,Boolean(n.speeddial))}t&&G.emitChange()}function H(e){e.children&&e.children.forEach(((e,t)=>{e.index=t}))}function z(e,t,n){for(;e;){e.children=e.children?.slice(),G.getBookmarkBarFolderId()===e.id&&(t=!0),e.speeddial&&(n=!0);const s=e.parentId?S.get(e.parentId):void 0;if(!s)break;e=s}(t||n)&&V()}const G=new x(r.Z),$=G},27508:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var s=n(24602);class i extends s.Z{getInitialState(){return{isActive:!1}}reduce(e,t){return"BREAKMODE"===t.actionType?{isActive:!e.isActive}:e}}const o=new i},50522:(e,t,n)=>{"use strict";n.d(t,{Z:()=>y});var s=n(2934),i=n(24602),o=n(42568),a=n.n(o),r=n(30381),l=n.n(r),d=n(58821),c=n(8336),h=n(93513);let p=(0,d.EP)();const u=new Map,g=a()((function(e,t){const n=new Map(e.map((e=>[e.id,e.account_type])));return t.filter((e=>n.has(e.accountId)&&"ical"!==n.get(e.accountId)))})),m=a()((function(e){return e.filter((e=>!e.hidden))})),v=a()((function(e,t){const n=new Set(e.map((e=>e.id)));return t.filter((e=>n.has(e.calendarId))).filter((e=>!(e.trash||e.deletePending)))}));class f extends i.Z{getInitialState(){return{accounts:[],calendars:[],events:[],tasks:[],templates:[],currentEdit:{windowId:0,pageId:0,eventId:null}}}reduce(e,t){switch(t.actionType){case"CALENDAR_INIT":return u.clear(),(0,h.Uy)(e,(e=>{const{accounts:n,calendars:s,events:i}=t,o=i.filter((e=>e.task));e.accounts=n,e.calendars=s,e.events=i,e.tasks=o}));case"CALENDAR_INIT_TEMPLATES":return(0,h.Uy)(e,(e=>{const{templates:n}=t;e.templates=n}));case"CALENDAR_EVENT_EDIT":return(0,h.Uy)(e,(e=>{e.currentEdit=t.edit}));case"CALENDAR_ADD_TEMPLATE":return(0,h.Uy)(e,(e=>{const{template:n}=t;e.templates.push(n)}));case"CALENDAR_UPDATE_TEMPLATE":return(0,h.Uy)(e,(e=>{const{templateId:n,template:s}=t,i=e.templates.findIndex((e=>e.id===n));-1!==i&&e.templates.splice(i,1,s)}));case"CALENDAR_REMOVE_TEMPLATE":return(0,h.Uy)(e,(e=>{const{templateId:n}=t,s=e.templates.findIndex((e=>e.id===n));-1!==s&&e.templates.splice(s,1)}));default:return e}}getState(){const e=(0,d.EP)();return e!==p&&(s.Z.loadPromise(),p=e),super.getState()}getAccounts(){return this.getState().accounts}getCalendars(){return this.getState().calendars}getEvents(){return this.getState().events}getTasks(){return this.getState().tasks}getTemplates(){return this.getState().templates}getEvent(e){const[t,n]=e.split("-")[0].split(":"),s=this.getEvents().find((e=>e.id===t));return n&&s?c.tV.call([s],l()(parseInt(n)),"day")[0]:s}getEventsPerCalendar(e){const t=u.get(e);if(t)return t;const n=(0,h.Uy)([],(t=>this.getEvents().filter((t=>t.calendarId===e&&!t.trash))));return u.set(e,n),n}getWritableCalendars(){return g(this.getAccounts(),this.getCalendars())}getVisibleCalendars(){return m(this.getCalendars())}getVisibleEvents(){return v(this.getVisibleCalendars(),this.getEvents())}}const y=new f},6320:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var s=n(24602),i=n(30381),o=n.n(i),a=n(9126),r=n(93513);class l extends s.Z{getInitialState(){return new Map}reduce(e,t){return"CALENDAR_UPDATE_UI"===t.actionType?(0,r.Uy)(e,(e=>{const{pageId:n,calendarUI:s}=t;let i=e.get(n);i||(i=(0,a.l)());const r={...i,...s};r.anchorDate.localeData()!==o().localeData()&&(r.anchorDate.locale(o().locale()),r.selectedDate?.locale(o().locale())),e.set(n,r)})):e}getStateForPage(e){return this.getState().get(e)??(0,a.l)(e)}}const d=new l},65398:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var s=n(56284);class i extends s.Z{constructor(e){super(),e.register(this)}dispatchAction(e){throw new TypeError(`dispatchAction() is not overwritten in ${this.constructor.name}`)}}const o=i},15544:(e,t,n)=>{"use strict";n.d(t,{Z:()=>Ve});var s=n(27770),i=n(48603),o=n(59486),a=n(65398),r=n(27033),l=n(45502),d=n(84451),c=n(76747),h=n(53576),p=n(96951),u=n(18350),g=n(15285),m=n(20676),v=n(29087),f=n(67044),y=n(66971),C=n(18237),w=n(76501),b=n(63365),S=n(93974),I=n(33638),k=n(70864),A=n(63153),T=n(15489),Z=n(53454),E=n(56371);var _=n(92292);const M=function(e){if(null===e||"object"!=typeof e)return e;const t=e.constructor();for(const n in e)e.hasOwnProperty(n)&&(t[n]=M(e[n]));return t},N=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(M(e[n]));return t};var P=n(26036);const D="iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABFUlEQVR4AWJwL/ChCOOUsLKy2m9tbf0fhIHs9SQbACidvK0yCGIgHGISTEj0d4D3tgPoADrgOoAOoIMt6UrQ2XhLAH3vSTzhzwRr5WZGuxpYHh4e7hwfHy80gfyXgIDn09PTpM47FxcXr7pm7q+vr9dBgU3v73SfTk5OipgAp4U5PeoqGvxCIDa3690TSW0Vt3v1xBgqHL4gigluqAyNIOKDVeT+PlLlTmlcf9IAfigfHKXv+1URWSZRFNeDPUFEUQYEua7rraZpNqkY26vj9icRBYEiBbvLkYKLSHs/EqC6izJkgML9Y5vEBMqsXsHfgr0NodX4uD1qUIAEftbWNwIZBJhtBxs0Bj9lCyqn/IU06zMNHe/UfCL6J8KbGwAAAABJRU5ErkJggg==",x="iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAVFBMVEX////ExMTFxcXExMS/v7/FxcXExMTDw8PExMTFxcXHx8e/v7/ExMTExMTFxcXFxcXDw8PGxsbKysrFxcXCwsLDw8PFxcXExMTGxsbGxsbExMTExMQtledLAAAAG3RSTlMA79+fEJ/PgN9/ICCPvzBgkG8wr1BAT18/cHDxOv8OAAAAdUlEQVR4AQXBhQHDIAAAsOBQnRv//7kEAABgn/MOAOptiQBaOS5BnuWRvrDOa98y6wgjZqQEQCp49sYZ4psWP/DY6QTqBzwrgcj+grUPzh7ejLhgKwDsBWtsoS3kS7yGBX7bK82cw3akAaDejgoA0px3AADAH03KBE7hRjloAAAAAElFTkSuQmCC";var O=n(7064);var L=n(69046),R=n(10334),B=n(30330),F=n(29489),V=n(60842),W=n(21191),U=n(89175),H=n(44850);let z=!1;const G={windowId:void 0,name:"",items:[],installed:!1,radioCounter:1,radioGroup:{},hasBookmarkContainer:!1,bookmarkExtrasEdge:"below"},$=!1,K="CONTAINER_WEBPANEL",j="CONTAINER_CLOSED_WEBPANEL",Y="CONTAINER_TAB",X="CONTAINER_PINNED_TAB",Q="CONTAINER_CLOSED_TAB",q="CONTAINER_ALL_WINDOW",J="CONTAINER_ALL_WINDOW_LIST",ee="CONTAINER_OTHER_WINDOW",te="CONTAINER_OTHER_WINDOW_LIST",ne="CONTAINER_OTHER_WORKSPACE",se="CONTAINER_OTHER_WORKSPACE_LIST",ie="CONTAINER_SESSIONS",oe="CONTAINER_BOOKMARK",ae="CONTAINER_PERIODIC_RELOAD",re="CONTAINER_MAC_SERVICES",le="CONTAINER_SHARE_MENU",de=["COMMAND_OPEN_LINK","COMMAND_OPEN_LINK_BACKGROUND","COMMAND_OPEN_LINK_CURRENT","COMMAND_OPEN_LINK_DEFAULT","COMMAND_HIDE_OTHERS","COMMAND_HIDE_VIVALDI","COMMAND_SHOW_ALL"],ce=[{name:K,hideInSettings:!1},{name:j,hideInSettings:!1},{name:Y,hideInSettings:!1},{name:X,hideInSettings:!1},{name:Q,hideInSettings:!1},{name:q,hideInSettings:!1},{name:J,hideInSettings:!1},{name:ee,hideInSettings:!1},{name:te,hideInSettings:!1},{name:ne,hideInSettings:!1},{name:se,hideInSettings:!1},{name:ie,hideInSettings:!1},{name:ae,hideInSettings:!1},{name:oe,hideInSettings:$},{name:re,hideInSettings:!0},{name:le,hideInSettings:!0}];let he=[];const pe={},ue=new Map(B.CN.map((e=>[e.name,e.feature]))),ge=["COMMAND_CLOSE_TAB","COMMAND_CLOSE_WINDOW","COMMAND_EXIT","COMMAND_QUIT_MAC_MAYBE_WARN","COMMAND_NEW_WINDOW","COMMAND_NEW_PRIVATE_WINDOW","COMMAND_SHOW_HELP"],me=B.CN;let ve;function fe(e){const t=ve||(ve={MENU_FILE:{...(0,P.Z)("win_linux","File")},MENU_EDIT:{...(0,P.Z)("win_linux","Edit")},MENU_VIEW:{...(0,P.Z)("win_linux","View")},MENU_BOOKMARKS:{isVisible:()=>!T.ZP.isGuest(),...(0,P.Z)("win_linux","Bookmarks")},MENU_TOOLS:{...(0,P.Z)("win_linux","Tools")},MENU_MAIL:{isVisible:()=>!v.Z.get(U.kMailIsTurnedOff),...(0,P.Z)("win_linux","Mail")},MENU_WINDOW:{...(0,P.Z)("win_linux","Window")},MENU_HELP:{...(0,P.Z)("win_linux","Help")},MENU_IMAGES_AND_ANIMATION:{...(0,P.Z)("win_linux","Images and Animations")},MENU_CAPTURE:{iconPNG:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADCSURBVHgB1ZHBEcIgEEXB5JBjSsASvDFwoRMtQSvQDqwhlXiCqyXEDsydYfDvIRlEUK/5h7Cz87O8zzK2evFSU2s94hBpL8b4cM5t2S8ZY4RSaiwMfUopRd5v6YMfDpzzK8reez+hPuZGEJyaprlhkCAaeC7W2mFBLk3/RklEKV7MTURFJoqDc88+I8UlQklAPIcQdl3XMcS6ozWUfBtWVz8XyDzVTFWC+dFwe1961DfVVlRTuuo2vY1W9M+A2qpXqhfDA07BmbR5ZAAAAABJRU5ErkJggg==",iconPNGWhite:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAAXNSR0IArs4c6QAAAGRJREFUeNq9j8EVwCAIQx2FzeqmvcTnGBmBEegBq/hKjy3ckk+Mpfw5IMy3MbFPWTK0S7BahcKgOIJCWONQwI0PmVAHLGbNu+UsAOwy71JAu2xl7fkEY9kb0LeSI8s/lWzI+nQuBXxjN95EoeQAAAAASUVORK5CYII=",...(0,P.Z)("win_linux","Capture")},MENU_EXPORT:{...(0,P.Z)("win_linux","Export")},COMMAND_OPEN_PAGE:{ellipsis:!0},COMMAND_FOCUS_ADDRESSFIELD:{ellipsis:!0,...(0,P.Z)("Open Location")},COMMAND_SAVE_PAGE:{ellipsis:!0},COMMAND_PRINT_PAGE:{ellipsis:!0},COMMAND_START_CHROMECAST:{ellipsis:!0},COMMAND_IMPORT_DATA:{ellipsis:!0},COMMAND_EXPORT_DATA:{ellipsis:!0},COMMAND_EXPORT_NOTES:{ellipsis:!0},COMMAND_OPEN_SESSION:{ellipsis:!0},COMMAND_SAVE_SESSION:{ellipsis:!0},COMMAND_TOGGLE_WARN_ON_QUIT:{prefs:{pref:U.kSystemShowExitConfirmationDialog,isChecked:()=>!0===v.Z.get(U.kSystemShowExitConfirmationDialog)}},COMMAND_FIND_IN_PAGE:{ellipsis:!0},COMMAND_TOGGLE_MENU_POSITION:{prefs:{pref:U.kMenuDisplay,isChecked:()=>{const e=v.Z.get(U.kMenuDisplay);return!0===e||"top"===e||"on"===e}},...(0,P.Z)("Horizontal Main Menu")},COMMAND_MAIN_TOGGLE_TAB_BAR:{prefs:{windowState:"tabs",isChecked:e=>T.ZP.getVisibleUI(e).tabs},...(0,P.Z)("command","Show Tab Bar")},COMMAND_MAIN_TOGGLE_ADDRESS_BAR:{prefs:{windowState:"addressBar",isChecked:e=>T.ZP.getVisibleUI(e).addressBar},...(0,P.Z)("command","Show Address Bar")},COMMAND_SHOW_BOOKMARK_BAR:{prefs:{windowState:"bookmarksBar",isChecked:e=>T.ZP.getVisibleUI(e).bookmarksBar},...(0,P.Z)("command","Show Bookmarks Bar")},COMMAND_TOGGLE_FOOTER:{prefs:{windowState:"statusBar",isChecked:e=>"on"===T.ZP.getVisibleUI(e).statusBar},...(0,P.Z)("command","Show Status Bar")},COMMAND_TOGGLE_STARTPAGE_NAVIGATION:{prefs:{pref:U.kStartpageNavigation,isChecked:()=>{const e=v.Z.get(U.kStartpageNavigation);return"on"===e||"speed_dial_only"===e}},...(0,P.Z)("command","Show Start Page Navigation")},COMMAND_TOGGLE_PRIVACY_STATS:{prefs:{pref:U.kStartpageSpeedDialPrivacyStatsShow,isChecked:()=>{const e=v.Z.get(U.kStartpageSpeedDialPrivacyStatsShow);return!0===e||"speed_dial_only"===e}},...(0,P.Z)("command","Show Privacy Statistics")},COMMAND_TOGGLE_PANEL:{prefs:{panelState:"SHOW_PANEL",isChecked:e=>g.ZP.getIsBarVisible(e)},...(0,P.Z)("command","Show Panel")},COMMAND_SHOW_BOOKMARK_PANEL:{iconPNG:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACJSURBVHgB7ZKxCoAgEIavaG3wBcJGt2ZdnHurXiR6itY2X6Pew8HOUAgREaWtH0Tvzv87Dg6gUk2YEEKceNHYZ2PMpZQaISUEmCDV+xOpQQuV+gFfA6SUlDE2FAGsWWt9EEL2FKRLmXHzNhs7yJwN8GZc28XGnPMHArkjvM1W7r1CjrDbVFIr1g1wAzRdx1+LFgAAAABJRU5ErkJggg==",iconPNGWhite:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAAXNSR0IArs4c6QAAAE9JREFUeNpjYCAWHLl/5D8CHr2PqeA/hP7PC4Iw3jBVsF/hmjYeBfsVjtw/+hCkBKsCsHT90XqQEqwKQNIgFkgJVgUQaYgSLAqOGuDm4QUAABBqP/s39jMAAAAASUVORK5CYII="},COMMAND_SHOW_MAIL_PANEL:{iconPNG:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACFSURBVHgB7ZHRDYAgDETBMAhuoL8wBZOyBb+6gWyCVyOmQSAMwCWkTem7tKkQUzIn1toLQY9AKaUYQlgpV6yu8bEjejyHhpNDxphNSunR4xCPXF940ws5MiGgBpfGqhyPGgBkE/fs2YB/E9Qm6cFNA27Sg6srVEy64gYRp0xiQHRGMfXpBmxdTd/71HkZAAAAAElFTkSuQmCC",iconPNGWhite:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAATklEQVR42s3PsQ3AMAgEwB+J/ev/ORiFFAhjKxTuEqiAkwDgJ0FnvFPeIGRyWdUyuoyxAaBJjrO7gSI1HkASrlUDAGR9yQiO3+L+zY/jAaekW1uCzRxFAAAAAElFTkSuQmCC"},COMMAND_SHOW_CONTACTS_PANEL:{iconPNG:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAF0SURBVHgBtVM7boNAEOVnic72BSwiX8DpIn8UcgIfIeEEzg1QTuA6nW8Q5wZE4lcmXTrb0KTcBgnxzRuLtQhQIEUeabXLm3lvZ98IQfhniH2KFovFnSiK93TO89z3PO+D56Q+AmVZakVRqLQgpCNGPKfUCymRZdkzCJsK2g0Ggxfse+AbEiAwjmMSYK0O0jTdgjwE6QbrFtAYmGlZVozWv7q6E+u3o/jgOM64iZFgFEUa9jUu+IEHry0PqC0kWV0dN9M3S5JkKMvyOYddrXvQy0QKPOFMgg/k0yMXuQj4vn+Ew8JyudQ5Np/PZ+hKcF33pCiKxnESQcdrOv+ZAgQMEN5WqxXtjM6SJBlV6wzEeu2oJYDQiQjjPlVVpamQyAz43rZti2xp1Atyrd0nmj9ueaDnINh0On3H27eTyYSFYdg5RpmTsZmczJNcBPhO07RTEATfTQGpek+LzAOjJHMN5M2uDi4ewKQDfpquGvoXaB2Fa8QvffXhZBpebQgAAAAASUVORK5CYII=",iconPNGWhite:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAvklEQVR42pWQMQ7CMAxFMzLmBvgIjGx0ZOzIVjbGjh3bG/QIcBNL2EkkFo7gI+QIILeiTSMqgS1FSfzy429j/g/eU0ONP6wC7uRaTbTJJVrqOHLkHi1uqFEgQCp7HUrAN+6N8ccMQMtx3qF97FzrL8n7AE4mLXHbAK6lOukhB1QhQ1ioGBzsFPXl6CNUE0AFx3s5rnoaAV/PQOckAAILdd9Gc9by4AJYuFotfxD9Jh2SLGam/TwzgF/LnE3/EG8smIVnSsnf6AAAAABJRU5ErkJggg=="},COMMAND_SHOW_DOWNLOADS_PANEL:{iconPNG:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADPSURBVHgBxZLBDYIwFIZblTtMAIYpBA51BKfwzAS6gUePzuAGvUC4OoFNF5B7k9a/Rkw1QCQQ/ZKmf1/7+t5rHyEjoV0baZpeMUVWG2NEWZZLMgRcYNr0JzMykv9fsGgEY8xXSt26Drrv4HlewDmv3zKwBkrpGlJorfOiKF4/9NQ5Ro091jhb5m4UKaWI4/iMbzuGYRhgza09y7I9bFs4r6qqurg+rX2AciKUc4LTIxIy85H2xo38FUmS7FD7gfyEvm7rOztdHwA+IAtOpuIO/nhVS2EDB78AAAAASUVORK5CYII=",iconPNGWhite:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAb0lEQVR42mNgIAUcuX/k/5H/R+/jVvAfQdJbwX4BkONAEKIAAvcLICk57HDk/rECuEkFR94fs0c3ReHI/cMNYMUNR+8fV8Digv0KR/YfXX90/ZH9KIajgqP1R/oZyADYfY4kSljBfpjfUeB+oqwHAI1/WdoNOXPUAAAAAElFTkSuQmCC"},COMMAND_SHOW_NOTES_PANEL:{iconPNG:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACgSURBVHgB7VLBDYQgENw1FnAlWAeEGrSEK+GugrsOtAU70CKgDkuwAnBMNFHCRhM/PpwPsDPsLuwQXQRvD0qpNzPX2L5S4hDCAP5vrW3XWLbLxvyTLi98gaXZxvJIU6BK5ZzrUwmMMaX3viMJWutAB4g1GV1EfqbKCnwen0qQEj4dyIjHOMLOpSSGkarZzmIHIL+wa4MnJN0GF47gP3QrTBi9PG385uw1AAAAAElFTkSuQmCC",iconPNGWhite:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAASklEQVR42mNgIA4cTTjy/sh/BDx6/0g8ioIj95GlwfA9qoL/R/2R+Yf8j/xHU4BuKTkKkF0wRE14jxZQAUfvo8cFamC/R4sLCgAAKuF43sJZFFMAAAAASUVORK5CYII="},COMMAND_SHOW_HISTORY_PANEL:{iconPNG:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAD8SURBVHgB3VJLDoIwEG1BYMsR8Aa647fgKHAC4gn0BsQTKCfwCOCChB3eQI9QtxDAmYQmTW2NOxMnadKZad983iPk10blQJIk3jAMJ7hu4LhCis3zXE/TtGvb9sGDhuJzhw8ty1o3TUP5QZ9SejVNs/N93yMqC8PwEgRBLsXukr+PoqhSdgAVEsdxSinmib5t28dlvHcAnLmua0Y+2JJ3dQBK0878JUBpGEalA5EBGDAhUkeAgRS3DyAF+kue6QBufd/nchUEgeVleAeaU6SZ51biQ+A6Qx0AlU9g4ywvNI7jA3zOQUxbHlMqEbookFIiKRE7HMcxE5X4B/YCuLpojZ4/JTwAAAAASUVORK5CYII=",iconPNGWhite:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAf0lEQVR42rWQ3RWAIAiFHcER2jA3sFHawBF46GJjNAIj2Kn879RT4QMIH4hXqc+MBhAE4TzCbh36srAlHW8aBtIg7PwYoy16C6oASOpGyFOkBsJb1KXT20/AzNuFtEDe4UTcfQdiW31aKwVzYI0O3hQdlqnT4UDYFSVBXflP2wFyclxBF22/4AAAAABJRU5ErkJggg=="},COMMAND_SHOW_WINDOW_PANEL:{iconPNG:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABYSURBVHgB7ZLdCcAgDIQvpYO0c2T+ZI26SWofCgriDwqC+L3kOMiFkACzoV8w8+PLVdNkZk5V78j0AVbSKe9AJ5SblENEKDJaAoausAOAM9Cu9hLfJ2IdXuDHHKAeH9NrAAAAAElFTkSuQmCC",iconPNGWhite:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAALElEQVR42mNgoAo4cv/If0x49D5CwX90EpVFjALskAGLWmSXDTUFhEKStgAAWEdiK3NU7WoAAAAASUVORK5CYII="},COMMAND_SHOW_CALENDAR_PANEL:{iconPNG:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACISURBVHgB1ZLBDYAgDEVr4wCOwBgEhnEGN3AEV3AST8whI7ABloQmmCgQ5aAvIfxC+wsEgNYopXat9Z7TKR0L2hxpWmgMhR6WxmyMWUOAvOq9nyuKAyI2OkMn8FBJmovwErxy5w53OmvwmGZv8O8rOCmlKBXHHMtxz4J+4oSIG7mLgocLufAZDrWyPsrbeWhUAAAAAElFTkSuQmCC",iconPNGWhite:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACSSURBVHgB1ZLBDYAgDEVLwwCOwBps4wg6gW6gKziJFwhj6AgOAMFyICFR0agHfQnJb9r+hqYAb6O1nsLL6RSWNJbe+45kkRvAGJsRsZVSDiHGJNecNQdoiHDO9ZuEUsrDRdJahIfgnnuccKSzBrd5bQf//sJijBFnzaGGjmmOMY+CTrS21o7kLnIGVLNwziv4DCvpcHNLdZSTOwAAAABJRU5ErkJggg=="},COMMAND_SHOW_TASKS_PANEL:{iconPNG:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAERSURBVHgBzVLLjcIwFLQ3Th9sB3DMT5vtYLcEOoAKklRACdABdAAoykfKATqAOhIlYR6ykSXicISRLP9m5o2fzNg74LruVK25WoRhOGmaZk1Lndz3/TXP82+19zxvgWlV1/WsqqqzUBcQb0HegfxrqiyLrMDbkJjOhHY/hXjGRgDxnhJ1XZeosy/24o0Kvu/HmCaWZS3LsrwaDUjMOT9JwR1BEPyhcoQRp2m60/mPJqI5fZZlXJpEMIkxEiHERkZnejONCQggJlSNqqLbe4qOdw82d9BAN0EKEi/0dyPh5UlATxgychznZ4xrTKBQFMVx7F43OOidN0Fyzmr/+Ei2bc/pNyJeNGaAvhzatv1nH4Mbqq2RljjZ0ywAAAAASUVORK5CYII=",iconPNGWhite:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAEKSURBVHgBzVLLrcIwELQjp4+8DuCa3yMdQAl0ABWEVEAJ0AF0ACi/I3QAfeTHrJRFlojDEUaysl7vzO6sIsQ3kOf5hGPJQVmWTtM0O4QzvbjrukcQBH98z7Jshc9WSjn1PO+m+AHkA5JHJCNT577JFuGeyJRT2vsEyakYQdu2J5qoruuEc5b44JGRpukGZAdnHUXRwyhAZBRdicC5oijmsBfjbMIwPOr1ryViOZ3v+7IXiSFCHROl1J5GxxH6Mo0TELCLhLpR1963A9+Dyx0U0EWIbFnWSveNCe9vBLIwJAT//2O1xgkYrutext51gbO+eRP6mhvfXz9SVVVL27YPGC/+oHFG7UL8DJ7QEZCpKicQ5QAAAABJRU5ErkJggg=="},COMMAND_SHOW_READING_LIST_PANEL:{iconPNG:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADUSURBVHgB3VI9DoIwFC5EAiOOMNUbOANDb+B13AgnMd6EiXALewMZbZq2vhJryrPKYmLiG6B8fd8PyUfIryeyj7quL/Ci+NIYw6NoXgneDcOw2zy+aZIk277vJ38JhE9KqW4cR+7jjLFcSnm1ZydALLmqqha7WDLGYbcD8YWTIYHBRJTOLBJ8ImAc/r0Lqq0R/z0BpTRbI7qBHmQvCYqiaMuyvPmL0ELWNM2ktc59HEr0NHMCPI7jY8gNyrQHoTyA89mEvBmISYUQB3tO0/SMa/61uQN54WmwgBUnOAAAAABJRU5ErkJggg==",iconPNGWhite:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADGSURBVHgB3VJBDsIgEISEJh7rD+oPvPdiX+B3vDV9ifElvRS+IT+wRxMIOHvAINDUg4lJ98CSYWdnEoaxfxenQ0p599432SPnmvrSW9u2BxEGjDH7ruvmeGiapivwAbiO8XEc66qqHnQXASQynPSJkCZyikN5wPIPJc8KVViYccQ3hJKD4rY14tYd4G93a8RQNJs5QDB6EJ7xIAJ2UkrN6HWCv8VCEjWieUHP1JxzR7Q6xYlDnbOFgs1GCHGmu7X2lsb8Z/UCQg+R4phOstoAAAAASUVORK5CYII="},COMMAND_SHOW_TRANSLATE_PANEL:{iconPNG:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAE5SURBVHgB3VI7UoRAEB0QqggnNKAo9gaYAsFwAr0BG5pZnkD3BLqZmXoDPYEkfIyWGzgBB5gUKMDXyFqL5a6x21Wvunv697qBsX8hvu/fEH6LafuKgiC4G4aBj0ma5pGGX06+StP0mmx9XwMkJ1AcyS70PWFqxKfYYQYkQgi3bdtN13VnlmUx2B+wF0VRyG3OyW4B9lw6jrOxbVtVVfUupVTwT3Vdv+z7fonJD3mev+7WzFYAxfFQKLjYvpmmuSIygIcmzz9Zfq8QhqHAhDfgFo0IkWEYZdM0j1QMXyLmwk6AdZZl5YwBgjEgEaCJCvY59hUo5Jgc4eoR3ld0VCCeMcCxOB0IRYomIEFAc9BfJEmi2AEZGYAm7Uzf/AmQwAv5dV3H7A8x2NfxrqDKif4o+JG86ZhrdtzyCZCjjl4nqbGPAAAAAElFTkSuQmCC",iconPNGWhite:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAEiSURBVHgB3VDLbYNQEHxAgAsHSiAdkCtw8Ksg6YB0kKSCxBXEVGC7A3eAJeBsOjAlICFx4edZtEi25c/ZXmned2d3doR4iMiy7Jdw6U+5RkrT9F9RFJuvLu85LcMwlEEQ/NBZvVYA5G3f9zaSHWDBcOmN/u4qoIjj2NF1fadp2hvdu67bN03zKqUsLhbAnJ/oslRV9dvzvGgahUbgcTa+78+POecjjEZB5sf0gI5EmJF8FF6L81GnQ5IkM3SJgT8kE6RlWXld10sUJAUF4CB1C0RQkp8oQPUQpIIllkh+r6qKOttt20q4LuHBnE0NTxTALBtm7UEqucNIZMNKcSNGBYZh0Mxk0gooQN7Q3TTNUNyJF1pA+MKWHzsM9102MxLPHQec65fa3EMkXwAAAABJRU5ErkJggg=="},COMMAND_SHOW_SESSION_PANEL:{iconPNG:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABhmlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw1AUhU9TpSoVh3YQcchQnSyKigguWoUiVCi1QqsOJi/9gyYNSYqLo+BacPBnserg4qyrg6sgCP6AODs4KbpIifclhRYxXni8j/PuObx3HyDUy0w1O8YAVbOMVDwmZrKrYuAVPoTQjRmMSszU55LJBDzr6566qe6iPMu778/qVXImA3wi8SzTDYt4g3hq09I57xOHWVFSiM+JRwy6IPEj12WX3zgXHBZ4ZthIp+aJw8RioY3lNmZFQyWeJI4oqkb5QsZlhfMWZ7VcZc178hcGc9rKMtdpDSKORSwhCREyqiihDAtR2jVSTKToPObhH3D8SXLJ5CqBkWMBFaiQHD/4H/yerZmfGHeTgjGg88W2P4aAwC7QqNn297FtN04A/zNwpbX8lTow/Ul6raVFjoC+beDiuqXJe8DlDtD/pEuG5Eh+WkI+D7yf0TdlgdAt0LPmzq15jtMHIE2zStwAB4fAcIGy1z3e3dU+t397mvP7AcU6cshc5dfNAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH6AETCgAkeJuDiQAAAQdJREFUOMul0r1KA1EQBeAvWSFFSKkIgqLYWtgYFYtF8OcZ8jRpfQHRF/AptNfKwtpCEkXdUhCEDbGZwGXd/IAHBu6ePWfmztnlLzZxjQFKjKPK4K5CA5oV8xnuMUSOFhpRreDeQnNaN/kD++bjILQbWUJe4BY3FfEyVrGE7+CGaOO8kQgHccXnhNvFWvL8isc4b+MubVDGnqNkcrfm+g8okOEnDTFLzNCZsv+EHyFrzgjqaw6fYZQ26FWEReyskkER5y0MGzUTupH2U5JFJyYXia6Plao5x+eU8FIc4h3rdeZ8iimLT9ePn+gkfdkO83hGlXjBZXXyBEfR+dg/sGgGM7GHnUXFvzNAPn779Pc/AAAAAElFTkSuQmCC",iconPNGWhite:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAC6HpUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHja7ZdbktwgDEX/WUWWgCSExHIwmKrsIMvPBT+me2byquQnVW3KgAUW8j2Cngn7t68jfMFFJXNIap5LzhFXKqlwRcfjcZVVU0yrPh/i1Xmyh3uAYRK0cjxaPedX2PXthWsN2p7twc8R9tPR5fl0KHNlRqc/Bgk7H3ZKp6OyH51c3B5D3fho2zlxhXLe4wrLjmY+h0dDMqjUFQsJ8y4kcdV+RCDzTlLREmqSwrM3+yweVpPPSCDI0+fdAsZHgZ5Evnrhvfp37534XE+7vNMynxqh8+kA6efiL4kfFpY7In4eMLlcfSLy6D7GfnxdTRmK5jOjlth0ucHEDZLLei2jGG5F31YpKB5rbEDeY4sbSqNCDCojUKJOlQbtq23UEGLinQ0tc2NZNhfjwm0RS7PQYJMiXRywGu9BBGa+Y6G1blnrNXKs3AlTmeCM8MoPS/jZ4J+UMEabElH0WyvExTOvEcYkN2vMAhAaJzddAl/lxB8f8gepCoK6ZHZ8YI3b4WJTesstWZwF8xTtsYUoWD8dQCKsrQgGaZ8oZhKlTNGYjQg6OgBVRI59whsIkCp3BMlJBOeRsfNcG+8YrbmsnHmacTYBhEoWA5siFbBSUuSPJUcOVRVNqprV1IMWrVlyyppztjwPuWpiydSymbkVqy6eXD27uXvxWrgIzkAtuVjxUkqtHCoWqvBVMb/CsvEmW9p0y5ttvpWtNqRPS01bbta8lVY7d+k4Jnru1r2XXncKO06KPe26591238teB3JtyEhDRx42fJRRb2on1Q/lD6jRSY0XqTnPbmqwBrPLBc3jRCczEONEIG6TABKaJ7PolBJPcpNZLIxNoYwgdbIJnSYxIEw7sQ662b2R+y1uQf23uPGvyIWJ7l+QC0D3kdsn1Pr8nWuL2LELp6ZRsPswp7IH3DGi+tv25ejl6OXo5ejl6OXo5ej/dyQDfzzgn9jwHXUtnbaAnZZ1AAAAZnpUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHjaPUwxEoAwCNt5hU8oJFfb53jUwc3B/5+RwXAQSHLYdT9pW4HdMBicXI2qHxGeLbBrPRBoasYSu6ZjlptyT10OZfToI/QKlIRhL/aAF2jrZm+xAAABhmlDQ1BJQ0MgcHJvZmlsZQAAeJx9kT1Iw1AUhU9TpSoVh3YQcchQnSyKigguWoUiVCi1QqsOJi/9gyYNSYqLo+BacPBnserg4qyrg6sgCP6AODs4KbpIifclhRYxXni8j/PuObx3HyDUy0w1O8YAVbOMVDwmZrKrYuAVPoTQjRmMSszU55LJBDzr6566qe6iPMu778/qVXImA3wi8SzTDYt4g3hq09I57xOHWVFSiM+JRwy6IPEj12WX3zgXHBZ4ZthIp+aJw8RioY3lNmZFQyWeJI4oqkb5QsZlhfMWZ7VcZc178hcGc9rKMtdpDSKORSwhCREyqiihDAtR2jVSTKToPObhH3D8SXLJ5CqBkWMBFaiQHD/4H/yerZmfGHeTgjGg88W2P4aAwC7QqNn297FtN04A/zNwpbX8lTow/Ul6raVFjoC+beDiuqXJe8DlDtD/pEuG5Eh+WkI+D7yf0TdlgdAt0LPmzq15jtMHIE2zStwAB4fAcIGy1z3e3dU+t397mvP7AcU6cshZ7VMUAAAPRGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNC40LjAtRXhpdjIiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgeG1sbnM6aXB0Y0V4dD0iaHR0cDovL2lwdGMub3JnL3N0ZC9JcHRjNHhtcEV4dC8yMDA4LTAyLTI5LyIKICAgIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIgogICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgIHhtbG5zOnBsdXM9Imh0dHA6Ly9ucy51c2VwbHVzLm9yZy9sZGYveG1wLzEuMC8iCiAgICB4bWxuczpHSU1QPSJodHRwOi8vd3d3LmdpbXAub3JnL3htcC8iCiAgICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iCiAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iCiAgIHhtcE1NOkRvY3VtZW50SUQ9ImdpbXA6ZG9jaWQ6Z2ltcDpiYjJkZWQ3Yy1lZjU2LTQwNTUtODEzNC1iNjdiMTUxNDY5ZWEiCiAgIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6Y2NkOTQ1M2EtMzZmMy00ZDYyLTgwNGMtYzkzM2E2NGVjMWE5IgogICB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6OTliOTYwYmQtYWIwYi00ZTY0LWFhZTMtY2JmZWU4YzllMDU3IgogICBHSU1QOkFQST0iMi4wIgogICBHSU1QOlBsYXRmb3JtPSJMaW51eCIKICAgR0lNUDpUaW1lU3RhbXA9IjE3MDU2NjAxMDgwMjM0MTkiCiAgIEdJTVA6VmVyc2lvbj0iMi4xMC4xOCIKICAgZGM6Rm9ybWF0PSJpbWFnZS9wbmciCiAgIHhtcDpDcmVhdG9yVG9vbD0iR0lNUCAyLjEwIj4KICAgPGlwdGNFeHQ6TG9jYXRpb25DcmVhdGVkPgogICAgPHJkZjpCYWcvPgogICA8L2lwdGNFeHQ6TG9jYXRpb25DcmVhdGVkPgogICA8aXB0Y0V4dDpMb2NhdGlvblNob3duPgogICAgPHJkZjpCYWcvPgogICA8L2lwdGNFeHQ6TG9jYXRpb25TaG93bj4KICAgPGlwdGNFeHQ6QXJ0d29ya09yT2JqZWN0PgogICAgPHJkZjpCYWcvPgogICA8L2lwdGNFeHQ6QXJ0d29ya09yT2JqZWN0PgogICA8aXB0Y0V4dDpSZWdpc3RyeUlkPgogICAgPHJkZjpCYWcvPgogICA8L2lwdGNFeHQ6UmVnaXN0cnlJZD4KICAgPHhtcE1NOkhpc3Rvcnk+CiAgICA8cmRmOlNlcT4KICAgICA8cmRmOmxpCiAgICAgIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiCiAgICAgIHN0RXZ0OmNoYW5nZWQ9Ii8iCiAgICAgIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6NzYzMWJlMDUtYTNiNy00YWJkLThjZmUtMjJmNTU1NWVmYWY5IgogICAgICBzdEV2dDpzb2Z0d2FyZUFnZW50PSJHaW1wIDIuMTAgKExpbnV4KSIKICAgICAgc3RFdnQ6d2hlbj0iKzAxOjAwIi8+CiAgICA8L3JkZjpTZXE+CiAgIDwveG1wTU06SGlzdG9yeT4KICAgPHBsdXM6SW1hZ2VTdXBwbGllcj4KICAgIDxyZGY6U2VxLz4KICAgPC9wbHVzOkltYWdlU3VwcGxpZXI+CiAgIDxwbHVzOkltYWdlQ3JlYXRvcj4KICAgIDxyZGY6U2VxLz4KICAgPC9wbHVzOkltYWdlQ3JlYXRvcj4KICAgPHBsdXM6Q29weXJpZ2h0T3duZXI+CiAgICA8cmRmOlNlcS8+CiAgIDwvcGx1czpDb3B5cmlnaHRPd25lcj4KICAgPHBsdXM6TGljZW5zb3I+CiAgICA8cmRmOlNlcS8+CiAgIDwvcGx1czpMaWNlbnNvcj4KICA8L3JkZjpEZXNjcmlwdGlvbj4KIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0idyI/PueZfIMAAAAGYktHRAD/AP8A/6C9p5MAAAAJcEhZcwAADdcAAA3XAUIom3gAAAAHdElNRQfoARMKHBy27mZKAAABF0lEQVQ4y5WSvUoDURCFv2SLFGKpCEJEyQvYGBWLIKjv4MsY8B3EPIy9VhbWFpIo/pQBRdjw2czG63WT6IGB3cPMOXNnBpUsNtWBOlRLv1EGdxk5qDT5iRPgGhgBPaAFNCJawT1FzjFA7vyi7tZ0lcde5G401Mp9EM7nWVcrwDIwBt4S/gxYSwWG0eJ9krQNrCf/j8BtfHeAq1SgjHdOEucuv3ETnRTAZzrEIikm2q5DxU+AoslsjBfwBTBJBU6zxLd4M9kMqkFuAaN0BhW6wDtwt2ALfWA1329PfVW7C+5gX31W23XFvRlFhdpR+3FER+r0EpeieB5K9UG9UNuVcOpwEMqHfzhl6gT+M4Np1G1hB/hItjAXX/ppnhihX/8aAAAAAElFTkSuQmCC"},COMMAND_SHOW_FEEDS_PANEL:{iconPNG:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAD5SURBVHgB7VA7DoJQEHxIoLYnIXoEOwIkPo9gZ6c30BvoDdQTSGsnN3iGTw0nwAR6KQUCOBhsUFFLEyfZ7L7Pzs4sIT8PrnmhadoZ6VSWpcfzvGlZ1qGNoNO8EAShXxTFguM4grxWVTVQFKVHPlXQBAiWIFtA0ch1Xa/5zpMnFmRZniAuYRj6iCPqBCQ7SZL2URTF7ywMMG2LcnWX7zjOBmcDO9l9ZQFqDJANRVEcVOcsywIoGdu2zV4q0HWdonFKKe1i8gwNcZqmc8ZYDLINFjtttYBPlUwjSZLbRzQYIKFVDQs+Em0lABgizvOc1YQmoldb8MgfD7gCpH9zwi7KjVoAAAAASUVORK5CYII=",iconPNGWhite:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAD1SURBVHgB7VHLDYJAFNyFAFdL0BI4Ej5CCVaAHUgH2oFYgdiBVgDhE65YgXQgZ74OBhKDEbyaOJfdN7s7b+YtIT8POiTCMLxjSSmlSVVVF03TzmMCzJAoimLBMIzVNA2ByD6Kolscx3PyrYMhILCFmAUxQ5blZFKgj8CyrC1J0qnjLCxbcCK4lExEEOu6PpRluevtK4pi48jBTI6TDl7h+76Drss8z8W25jjuhjgrVVW9jw6CINDR1XRdd4YfWONBxvP8xjCMDHOwMWBzNAIuHGHVEQTB7GoHInq7B39FPH1UAPDarrDuPTNSekE97yIk5I83PADL5XR/KpV1NwAAAABJRU5ErkJggg=="},CONTAINER_WEBPANEL:{...(0,P.Z)("Web Panels"),settingsLabel:(0,E.Z)("[All Web Panels]")},CONTAINER_CLOSED_WEBPANEL:{...(0,P.Z)("Closed Web Panels"),settingsLabel:(0,E.Z)("[All Closed Web Panels]")},COMMAND_SET_LOAD_IMAGES_ALWAYS:{prefs:{imageLoadingPref:"always",isChecked:e=>"always"===v.Z.get(U.kPageImageLoading)}},COMMAND_SET_LOAD_IMAGES_NEVER:{prefs:{imageLoadingPref:"never",isChecked:e=>"never"===v.Z.get(U.kPageImageLoading)}},COMMAND_SET_LOAD_IMAGES_CACHE:{prefs:{imageLoadingPref:"cache",isChecked:e=>"cache"===v.Z.get(U.kPageImageLoading)},...(0,P.Z)("Load Images from Cache")},COMMAND_SET_ANIMATIONS_LOOP:{prefs:{animationPref:"allowed"}},COMMAND_SET_ANIMATIONS_NEVER:{prefs:{animationPref:"none"}},COMMAND_SET_ANIMATIONS_ONCE:{prefs:{animationPref:"once"}},COMMAND_MAIN_ZOOM_IN:{persistent:!0},COMMAND_MAIN_ZOOM_OUT:{persistent:!0},CONTAINER_BOOKMARK:{settingsLabel:(0,E.Z)("[All Bookmarks]"),settingsRename:!1,isVisible:()=>!T.ZP.isGuest()},COMMAND_MAIL_SHOW_SETTINGS:{iconPNG:D,iconPNGWhite:x,ellipsis:!0},COMMAND_SHOW_SETTINGS:{iconPNG:D,iconPNGWhite:x,ellipsis:!0},COMMAND_SHOW_QUICK_COMMANDS:{ellipsis:!0},COMMAND_CAPTURE_PAGE_TO_DISK:{...(0,P.Z)("Page to File")},COMMAND_CAPTURE_PAGE_TO_CLIPBOARD:{...(0,P.Z)("Page to Clipboard")},COMMAND_TAB_TRANSLATE_PAGE:{...(0,P.Z)("command","Translate Page")},COMMAND_CAPTURE_AREA_TO_DISK:{...(0,P.Z)("Area to File")},COMMAND_CAPTURE_AREA_TO_CLIPBOARD:{...(0,P.Z)("Area to Clipboard")},COMMAND_SHOW_CLEAR_PRIVATE_DATA:{ellipsis:!0},COMMAND_PROXY_TOGGLE:{prefs:{proxyState:!0,isChecked:()=>f.Z.getIsConnected()}},COMMAND_FULLSCREEN:{...(0,P.Z)("Fullscreen")},COMMAND_MAIN_TOGGLE_UI:{prefs:{windowState:"minimalUI",isChecked:e=>!T.ZP.isMinimalUI(e)},...(0,P.Z)("Show UI")},CONTAINER_PINNED_TAB:{...(0,P.Z)("title","Pinned Tabs"),settingsLabel:(0,E.Z)("[All Pinned Tabs in Window]")},CONTAINER_CLOSED_TAB:{...(0,P.Z)("title","Closed Tabs"),settingsLabel:(0,E.Z)("[All Closed Tabs]")},CONTAINER_ALL_WINDOW:{...(0,P.Z)("title","All Windows and Tabs"),settingsLabel:(0,E.Z)("[All Windows and Tabs]")},CONTAINER_ALL_WINDOW_LIST:{...(0,P.Z)("title","All Windows"),settingsLabel:(0,E.Z)("[All Windows]")},CONTAINER_OTHER_WINDOW:{...(0,P.Z)("title","Other Windows and Tabs"),settingsLabel:(0,E.Z)("[Other Windows and Tabs]")},CONTAINER_OTHER_WINDOW_LIST:{...(0,P.Z)("title","Other Windows"),settingsLabel:(0,E.Z)("[Other Windows]")},CONTAINER_OTHER_WORKSPACE:{isVisible:()=>v.Z.get(U.kWorkspacesEnabled),...(0,P.Z)("title","Other Workspaces and Tabs"),settingsLabel:(0,E.Z)("[Other Workspaces and Tabs]")},CONTAINER_OTHER_WORKSPACE_LIST:{isVisible:()=>v.Z.get(U.kWorkspacesEnabled),...(0,P.Z)("title","Other Workspaces"),settingsLabel:(0,E.Z)("[Other Workspaces]")},CONTAINER_TAB:{...(0,P.Z)("title","Tabs"),settingsLabel:(0,E.Z)("[All Tabs in Window]")},CONTAINER_PERIODIC_RELOAD:{...(0,P.Z)("title","Periodic Reload"),settingsLabel:(0,E.Z)("[Periodic Reload]")},CONTAINER_SESSIONS:{...(0,P.Z)("Sessions"),settingsLabel:(0,E.Z)("[All Sessions]")},COMMAND_CHECK_FOR_UPDATES:{ellipsis:!0},COMMAND_SHOW_ABOUT:{iconPNG:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAEySURBVHgBzVLLTcQwEHU+yjkN5EMHHPM75MgROqADditIOHKDClg6gAowUn43tgQraYAjRErCG5FFjjd7hifZ4xm9eTNjm7G/hkFbkiS54zivruv6Xde9nCLHcUycned5Wtu2nGI6bdM0ZTPnOgzDzVoyiqQwqcL/EQD4b0DXszRNbVXANM09zMfs7hcCmqbdSly77/sbVYBzTsmCzsMwXC0EiqLgaOv5EITgJggCnx3DBm/XNI1YCBAsy9pKLdqGYTzKo9BFw/jjOMrdMk12oijKUD0/+KgmaF7EfNhz+HlVVQsBXXbQxYPUBY3iY13OyQLVn5gCQ3aEEJ945y8cL1Qi3Utd129HcbYCfJh3qiqPgtbP1rj6WhDVtoqfsxMw1oL4pgKj0AsEWPdlWd6xf4tvaZVsnjSI7BsAAAAASUVORK5CYII=",iconPNGWhite:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAjUlEQVR42q1QSRGAMAysBCQgBSdYwAE4qAQkICEPtvBEAhIqYZm2FAIDvEhe2dlrYswPM3Yg+isGAccuHww7NUpSJUyxQXgpMkEKeBDLje9aFbGAc3mcbkgeJ4TV6VZSRktCUkyorfTRo91jVjcEex2nazHTbvqY2pwE1I8PC9ZJ//bR6lMfPSwIa36eDUlAgXmKiZFsAAAAAElFTkSuQmCC"}},ve);const n=t[e.action],i=n?.label??"",o=n?.labelEnglish??"",a=function(e){const t=e.parameter;if(void 0===t)return;if("COMMAND_OPEN_LINK"===e.action)return{handler:e=>{const n=s.ZP.getOpenOptionsFromDisposition(e.windowId,"setting",!1,e.keyState);h.ZP.openURL(e.windowId,t,{...n})},url:t};return}(e);return a?{...n,...a,label:i,labelEnglish:o}:{...n,label:i,labelEnglish:o}}function ye(e,t){e.forEach((e=>{const{name:n,function:s,feature:i}=e,o={autoRepeat:e.onAutoRepeat||!1,isEnabled:e.isEnabled,isFeatureShortcut:"browser"!==e.feature,feature:e.feature};d.Z.bind(t,s,o),he.push({name:n,key:t,func:s,feature:i})}))}function Ce(e,t,n){for(let s=n.length-1;s>=0;s--)if(n[s].items)Ce(e,t,n[s].items);else if(n[s].commandName===e){t.shortcuts?n[s].shortcuts=t.shortcuts:delete n[s].shortcuts;break}}function we(e){const t=r.Z.getState(),n=v.Z.get(U.kActions)[0];[...t.map((e=>{const t=(0,F.IN)(e),s=n[t.name];if(s)return{key:t.name,value:{...s,feature:"browser"}}})).filter(Boolean),...e].forEach((e=>be(e))),function(){he.forEach((e=>{d.Z.unbind(e.key,e.func)})),he=[];const e=Fe.getCommandsForShortcuts();Object.keys(e).forEach((t=>{ye(e[t],t)}))}(),z=!0}function be(e){pe[e.key]=e.value,G.installed&&Ce(e.key,e.value,G.items)}function Se(e){if(pe[e]){const{shortcuts:t}=pe[e];delete pe[e],t?.length&&d.Z.unbind(t)}O.Z.menuContent.removeAction([e])}function Ie(e){return t=>{const n=v.Z.get(U.kChainedCommandsCommandList);for(let s=n.length-1;s>=0;s--)if(n[s].key===e)return void(0,R.hT)(t,n[s].chain);console.warn("No chain match for: ",e)}}function ke(e,t){const n={},s=r.Z.getScripts().map((e=>(0,F.IN)(e))),i=me.concat(v.Z.get(U.kChainedCommandsCommandList)).concat(s);for(const s in pe){const o=pe[s];if(!o)continue;const a=o[e];a&&i.filter((e=>e.name===s&&(!0===t||!(0,B.os)(e.name)))).forEach((e=>{a.forEach((t=>{n[t]=(n[t]||[]).concat({function:e.chain?Ie(e.key):e.action,label:e.label,name:e.name,onAutoRepeat:e.repeat,isEnabled:t=>"CATEGORY_COMMAND_CHAIN"===e.category||e.isVisible(t,!1)&&e.isEnabled(t),feature:e.feature||"browser"})}))}))}return n}function Ae(e,t){let n=c.Z.commandItem;const s=fe(e),i=e.type;if("folder"===i)n={id:e.id,commandName:e.action,items:[],type:i,...s,withNoWindow:!0},e.children&&e.children.forEach((e=>{const s=Ae(e,t);s&&n.items&&n.items.push(s)}));else if("command"===i)n={id:e.id,commandName:e.action,type:i,...s};else if("checkbox"===i)n={id:e.id,commandName:e.action,type:i,...s};else if("radio"===i){if(!e.radiogroup)return;{let t=G.radioGroup[e.radiogroup];void 0===t&&(G.radioGroup[e.radiogroup]=G.radioCounter++,t=G.radioGroup[e.radiogroup]),n={id:e.id,commandName:e.action,type:i,radiogroup:t,...s}}}else if("container"===i){if(-1!==ce.findIndex((t=>t.name===e.action))){const o={content:e.action,mode:e.containermode,edge:e.containeredge,cpp:e.action===oe||e.action===le||e.action===re};n={id:e.id,type:i,...s,container:o,withNoWindow:!0},t&&e.action===oe&&(G.hasBookmarkContainer=!0,e.containeredge&&(G.bookmarkExtrasEdge=e.containeredge))}}else"separator"===e.type&&(n={...c.Z.separatorItem,id:e.id});void 0!==e.title&&(n.label=e.title,n.settingsLabel&&delete n.settingsLabel,n.ellipsis=!1),void 0!==e.custom&&(n.custom=e.custom),n.showshortcut=e.showshortcut,n.feature=ue.get(e.action)||"browser";const o=pe[e.action];return n.shortcuts=o?.shortcuts,n}function Te(e){for(const t of e){if(t.items){Te(t.items);continue}const e=t.prefs;if(!e)continue;const{callback:n}=e;n&&(e.pref?v.Z.removeListener(e.pref,n):e.animationPref?_.Z.accessibilityFeatures.animationPolicy.onChange.removeListener(n):e.proxyState?f.Z.removeListener(n):e.panelState?g.ZP.removeListener(n):e.windowState&&T.ZP.removeListener(n),e.callback=void 0)}}function Ze(e,t,n){const s=(e,t)=>{e.statestrings&&(e.label=e.statestrings[t?1:0].label,e.labelEnglish=e.statestrings[t?1:0].labelEnglish),e.checked=t},i=(e,t)=>{const n=()=>{if("function"==typeof t.isChecked){const n=void 0!==t.windowId&&t.isChecked(t.windowId);e.checked!==n&&(s(e,n),Fe.emitChange("menuState"))}};return t.callback=n,n};for(const o of t){if(o.items){Ze(e,o.items,n);continue}const t=o.prefs;if(!t)continue;t.windowId=e;const a=t.pref;if(a){if("function"==typeof t.isChecked){const e=void 0!==t.windowId&&t.isChecked(t.windowId);s(o,e),n&&v.Z.addListener(a,i(o,t))}}else if(t.animationPref){if(n){const e=function(){_.Z.accessibilityFeatures.animationPolicy.get({},(({value:e})=>{const n=e===t.animationPref;this.checked!==n&&(s(this,n),Fe.emitChange("menuState"))}))}.bind(o);t.callback=e,e(),_.Z.accessibilityFeatures.animationPolicy.onChange.addListener(e)}}else if(t.proxyState){if("function"==typeof t.isChecked){const e=void 0!==t.windowId&&t.isChecked(t.windowId);s(o,e),n&&f.Z.addListener(i(o,t))}}else if(t.panelState)switch(t.panelState){case"SHOW_PANEL":case"SHOW_CONTENT":if("function"==typeof t.isChecked){const e=void 0!==t.windowId&&t.isChecked(t.windowId);s(o,e),n&&g.ZP.addListener(i(o,t))}}else if(t.windowState&&"function"==typeof t.isChecked){const e=void 0!==t.windowId&&t.isChecked(t.windowId);s(o,e),n&&T.ZP.addListener(i(o,t))}}}function Ee(e,t,n){const s=v.Z.get(U.kChainedCommandsCommandList),i=t=>{for(let a=0;a<t.length;a++){const r=t[a];let d=!1;if(r.commandName){for(let e=s.length-1;e>=0;e--){const t=s[e];if(t.name===r.commandName){r.handler||(r.handler=Ie(t.key)),r.label||(r.label=t.label||""),r.labelEnglish||(r.labelEnglish=t.labelEnglish||t.label||""),d=!0;break}}if(!d)for(let e=0;e<me.length;e++){const t=me[e];if(t.name===r.commandName){r.isEnabled||(r.isEnabled=t.isEnabled),r.isVisible||(r.isVisible=t.isVisible),r.handler||(r.handler=t.action),r.withNoWindow=t.withNoWindow,r.label||(r.label=t.label||""),r.labelEnglish||(r.labelEnglish=t.labelEnglish||""),d=!0;break}}}if(d||"command"!==r.type||(console.warn("No match for menu item",r,r.commandName),void 0===r.label&&(r.label=r.commandName||""),void 0===r.labelEnglish&&(r.labelEnglish=r.commandName||""),r.isVisible=()=>!1,r.handler=()=>{}),Ze(e,[r],n.updateCallbacks),r.commandName){const t=pe[r.commandName]?.shortcuts;if(t){const n=l.Z.getContext(e)?.feature||"browser",s=r.feature||"browser";r.shortcuts=t.filter((e=>s===n||("browser"===s?!he.some((t=>t.key===e&&t.feature===n)):void 0)))}}if(r.items)i(r.items);else if(r.container&&n.expandContainers)if(!0===r.container.cpp)if(r.container.content===oe){const e=r.container.edge||G.bookmarkExtrasEdge,t=v.Z.get(U.kBookmarksManagerSorting),n=S.Z.toMenuSorting(t.sortOrder,t.sortField),s={id:o.ZP.getRootId(),type:O.Z.menubarMenu.ContainerType.BOOKMARKS,offset:0,edge:e,groupFolders:t.sortOrder!==S.Z.NO_SORTING,sortField:n.field,sortOrder:n.order};r.container&&(r.container.details=s)}else r.container.content===re||r.container.content;else{let n,s,i=[];if(r.container.content===K)i=_e(e);else if(r.container.content===j)i=Me();else if(r.container.content===X){const t=T.ZP.getActiveWorkspace(e);i=Le(e,!0,t),n="iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAD5SURBVHgBtVHBDYJAEOTQvz59WoJvIPFKwA6kEqES7UCtAPwQflqCDwrgSUIAZ8iRXIAE0DjJZfcuO3O7s4bxIxZziqWU6w2QpmnWvpkzyNuiKJ6maYaWZe1mC4B8ruv6gvSAc2U3kwUcx/EZ4zgO0IHLPM/zRkAMFMuqqvbtXQixxs8uiB7iiW9lWXpJkryZL7sCJIMkURzxjkjDAsRmBHah1/cEgDsKj4wofvEBpvHnW5dM9DxQpMYo3W3ViTEqQA9U2hMZFeCuOSs8CHURejJJgLtGoEiGs2rHoaHYwmNIQGit+2pNkb6mSWDrtm3Xyu3vMGbW3/ABNRKFPPHD6XUAAAAASUVORK5CYII=",s="iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAMFBMVEX///+/v7/Hx8e/v7/ExMTFxcXFxcXExMTFxcXDw8PDw8PExMTFxcXExMTExMTGxsbQpf+eAAAAEHRSTlMAECAg398wv3+AQI9g7/8/FKJcHQAAAFFJREFUeAFjQAWMClCGSRiUUZEqAKY5C6aC5FZ0bF1eBOK3d/R4gCVSEzg2gBlsYRwNYMay1Awwg9k3LRzMYH/6IWMBiDEPqBUs8wJmYQKaAwANFhLITP6v6wAAAABJRU5ErkJggg=="}else if(r.container.content===Q)i=Ne();else if(r.container.content===q)i=De(T.Ex);else if(r.container.content===J)i=Pe(T.Ex);else if(r.container.content===ee)i=De(e);else if(r.container.content===te)i=Pe(e);else if(r.container.content===ne)i=Oe(e);else if(r.container.content===se)i=xe(e);else if(r.container.content===Y){const t=T.ZP.getActiveWorkspace(e);i=Le(e,!1,t)}else r.container.content===ae?i=m.Z.getForActivePage(e):r.container.content===ie&&(i=Re(e));"folder"===r.container.mode?(delete r.container,r.type="folder",r.items=i,r.iconPNG=n,r.iconPNGWhite=s):(t.splice(a,1,...i),a+=i.length-1)}}},a=N(t);return i(a),a}function _e(e){return g.ZP.getOrderedWebPanels(e).map(((t,n)=>{const s=pe["COMMAND_SHOW_WEB_PANEL_"+(n+1)];return{...c.Z.makeNumberMnemonic(t.title||t.url||(0,E.Z)("Unknown Web Panel"),n),commandName:"JS_LOCAL_TOGGLE_WEBPANEL",parameter:t.id,handler:()=>u.Z.toggleContent(e,t.id),url:t.activeUrl,shortcuts:s?.shortcuts??[]}}))}function Me(){const e=v.Z.get(U.kPanelsWebRemovedElements).map(((e,t)=>({mnemonic:!1,commandName:"JS_LOCAL_RESTORE_WEBPANEL",parameter:e.id,handler:t=>k.Z.restoreById(t.windowId,e.id,!0),...c.Z.makeLabelPair(e.title||e.url||(0,E.Z)("Unknown Web Panel"))})));return e.length&&(e.push(c.Z.separatorItem),e.push({handler:k.Z.emptyTrash,...(0,P.Z)("panel","Clear All")})),e}function Ne(){const e=e=>{return(t=H.jk.getDisplayTitle(e)).length>70&&(t=t.substring(0,70)+"..."),t;var t},t=b.Z.getTrash().map(((t,n)=>{if(t.tab){const s=t.tab;return{...c.Z.makeNumberMnemonic(e(s),n),url:s.url,handler:()=>w.Z.undeleteTab(s)}}const s=t.window;if(s?.tabs){const{tabs:t}=s;return{...(0,P.Z)("Window with $1 Tab","Window with $1 Tabs",[t.length]),items:t.map(((t,n)=>({...c.Z.makeNumberMnemonic(e(t),n),url:t.url,handler:()=>w.Z.undeleteTab(t)}))).concat([c.Z.separatorItem,{handler:()=>w.Z.undeleteWindow(s),...(0,P.Z)("Restore All")}])}}})).filter(Boolean),n=t.length;return t.push(c.Z.separatorItem),t.push({handler:w.Z.emptyTrash,isVisible:()=>n>0,...(0,P.Z)("verb","Clear All")}),t}function Pe(e){let t=0;return T.ZP.getIds("normal").map((n=>{if(n===e)return;const s=p.ZP.getActivePage(n),i=(0,E.Z)("title","Window")+" - "+(s?H.jk.getDisplayTitle(s):"");return{...c.Z.makeNumberMnemonic(i,t++),handler:()=>A.Z.focus(n)}})).filter(Boolean)}function De(e){let t=[];const n=T.ZP.getIds("normal"),s=T.ZP.getActiveWorkspace(e);let i=0;return t=n.map((t=>{if(t===e)return;const n=[{handler:()=>A.Z.focus(t),commandName:"JS_LOCAL_ACTIVATE_WINDOW",parameter:t.toString(),...c.Z.makeLabelPair((0,E.Z)("Activate"))},{...c.Z.separatorItem},{...c.Z.makeLabelPair((0,E.Z)("Pinned Tabs")),items:Le(t,!0,s)},...Le(t,!1,s)],o=p.ZP.getActivePage(t),a=(0,E.Z)("title","Window")+" - "+(o?H.jk.getDisplayTitle(o):"");return{...c.Z.makeNumberMnemonic(a,i++),items:n}})).filter(Boolean),t}function xe(e){const t=[],n=T.ZP.getActiveWorkspace(e),s=Z.Z.getWorkspaces(e).filter((e=>e.id!==n));for(let n=0;n<s.length;n++){const i=s[n];t.push({...c.Z.makeNumberMnemonic(i.name,n),handler:()=>{const t=T.ZP.getActiveWorkspaces(e).get(i.id);t?A.Z.focus(t):A.Z.setActiveWorkspace(e,i.id)}})}return t}function Oe(e){const t=[],n=T.ZP.getActiveWorkspace(e),s=Z.Z.getWorkspaces(e).filter((e=>e.id!==n)),i=T.ZP.getActiveWorkspaces(e);for(let n=0;n<s.length;n++){const o=s[n],a=[{handler:()=>{const t=i.get(o.id);t?A.Z.focus(t):A.Z.setActiveWorkspace(e,o.id)},...c.Z.makeLabelPair((0,E.Z)("Activate"))},{...c.Z.separatorItem},...Le(i.get(o.id)??e,!1,o.id)];t.push({...c.Z.makeNumberMnemonic(o.name,n),items:a})}return void 0!==n?[...t,{...c.Z.separatorItem},...Le(e,!1,void 0)]:t}function Le(e,t,n){const s=async e=>{const t=(0,L.cm)(e);A.Z.focus(e.windowId),await A.Z.setActiveWorkspace(e.windowId,t),await h.ZP.activateTab(e.id,e.windowId)};return p.ZP.getWorkspaceTabs(n,"off"===v.Z.get(U.kTabsStackingMode)).filter((e=>e.page.pinned===t)).map(((e,t)=>{if("tab"===e.type){const n=e.page;return{...c.Z.makeNumberMnemonic(H.jk.getDisplayTitle(n),t),handler:()=>s(n),commandName:"JS_LOCAL_ACTIVATE_TAB",url:n.url,parameter:n.id.toString(),emphasized:n.active}}if("group"===e.type)return{...c.Z.makeNumberMnemonic((0,V.aD)(e.id,e.page.title),t),type:"folder",iconPNG:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABtSURBVHgBvZJLCsAgDERj8SD2Gnp+vYbeJDXQRQlNiB98C7NweAwkAIs4elJKtY8ghRCxlVJu0dIFCAra/wVGSBJjrNOCnLPrhGmB1GRYwJsMCzjLAv/Opq2K7gAsWO/hm/Msc7bJX4O9TY7wAFQ4MpFfIoDNAAAAAElFTkSuQmCC",iconPNGWhite:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAPElEQVR42mNgIAyO3D/yHxkevY+u4D9+PhYFaKZgMwFFDLsCJFNwmQAXp4ICLOFApEMJhCYRAUZqnJAJALGlehnFYWcIAAAAAElFTkSuQmCC",items:e.pages.toArray().map(((e,t)=>({...c.Z.makeNumberMnemonic(H.jk.getDisplayTitle(e),t),handler:()=>s(e),commandName:"JS_LOCAL_ACTIVATE_TAB",url:e.url,parameter:e.id.toString(),emphasized:e.active})))}})).filter(Boolean).toArray()}function Re(e){return C.ZP.getAll().map(((t,n)=>({...c.Z.makeNumberMnemonic(t.name,n),commandName:"JS_LOCAL_OPEN_SESSION",parameter:t.id.toString(),handler:()=>y.Z.open(e,[t.id],!0)})))}class Be extends a.Z{getIsInitialized(){return z}getClosedTabContainer(){return Ne()}getCommandsForShortcuts(){return ke("shortcuts",!1)}getCommandsForGestures(){return ke("gestures",!0)}getCommands(){return me}getShortcut(e){const t=pe[e];if(t?.shortcuts){const n=c.Z.formatShortcut(e,t.shortcuts);return n?(0,E.Z)("($1)",[n]):""}return""}getQuickCommands(e){return this.getCommands().filter((t=>{const n=pe[t.name];n?.shortcuts&&(t.shortcuts=n.shortcuts);const s=t.isVisible(e,!1)&&t.isEnabled(e),i=l.Z.getContext(e),o=t.feature||"browser",a="browser"===o||o===i.feature;let r;return r="function"==typeof t.showInQC?t.showInQC(e):t.showInQC,s&&a&&r}))}getCommandConfiguration(e){return pe[e]}getAllCommands(e){const t=v.Z.get(U.kChainedCommandsCommandList).map((e=>{const{shortcuts:t,gestures:n,feature:s}=pe[e.name]||{};return{...e,shortcuts:t,gestures:n,feature:s}}));return me.reduce(((t,n)=>{if(e!==T.Ex&&!n.isEnabled(e))return t;if(n.platforms&&!n.platforms.some((e=>"windows"===e)))return t;const{shortcuts:s,gestures:i,feature:o}=pe[n.name]||{};return t.push({...n,shortcuts:s,gestures:i,feature:o}),t}),[]).concat(t)}getVivDefinedCommands(){const e=this.getUserEditableCommands(),t=r.Z.getState().map((e=>({...(0,F.IN)(e),gestures:[],shortcuts:[],feature:"browser"})));return e.filter((e=>"CATEGORY_COMMAND_CHAIN"!==e.category)).concat(t)}getChainCommandsShortcuts(){return this.getUserEditableCommands().filter((e=>"CATEGORY_COMMAND_CHAIN"===e.category)).map((e=>{const t=this.getCommandConfiguration(e.name);return{name:e.name,...t&&{shortcuts:t.shortcuts}}}))}getSettingsList(e){const t=Fe.getUserEditableCommands(),n=r.Z.getState().map((e=>{const t=(0,F.IN)(e),n=Fe.getCommandConfiguration(t.name);return{...t,...n&&{shortcuts:n.shortcuts,gestures:n.gestures},feature:"browser"}}));return e?t.filter((e=>!(0,B.xU)(e.name)&&!(0,W.Ed)(e.name))).concat(n):t.filter((e=>!(0,B.xU)(e.name)&&!(0,W.jD)(e.name)&&!(0,W.Ed)(e.name))).concat(n)}isShortcutWhitelisted(e,t){if(T.ZP.isSettings(e)){for(const e in pe)if(void 0!==pe[e]){const n=pe[e];if(n.shortcuts&&n.shortcuts.includes(t))return ge.includes(e)}return!1}return!0}isActionWhitelistedForSettings(e){return ge.includes(e)}isNamedMenuAvailable(e){return G.name===e}getNamedMenu(e,t,n){if(this.isNamedMenuAvailable(t)){const t=G.windowId!==e;return t&&Te(G.items),G.windowId=e,Ee(e,G.items,{expandContainers:n,inSettings:!1,updateCallbacks:t})}return[]}getBookmarkExtrasEdge(){return G.bookmarkExtrasEdge}makeMenuWithContent(e,t,n){const s=[];return t.forEach((e=>{const t=Ae(e,!1);t&&s.push(t)})),Ee(e,s,n)}getMenuItem(e,t,n){let s=t;if("folder"===s.type)return{label:t.action,labelEnglish:t.action};"container"!==s.type||n||(s={...t,containermode:"folder"});const i=this.makeMenuWithContent(e,[s],{expandContainers:!n,inSettings:n,updateCallbacks:!1});return 1!==i.length||"separator"!==i[0].type&&void 0===i[0].label?{label:t.action,labelEnglish:t.action}:(Ze(e,i,!1),i[0])}getHandlerByAction(e,t,n){let o;switch(t){case"JS_LOCAL_ACTIVATE_TAB":{const e=parseInt(n),t=p.ZP.getPageById(e);t&&(o=()=>{h.ZP.activateTab(t.id,t.windowId),A.Z.focus(t.windowId)});break}case"JS_LOCAL_ACTIVATE_WINDOW":o=()=>A.Z.focus(parseInt(n));break;case"JS_LOCAL_ADD_ACTIVE_TAB_TO_BOOKMARKS":{const t=n,s=p.ZP.getActivePage(e);s&&t&&(o=()=>i.Z.bookmarkPageInFolder(s,t));break}case"JS_LOCAL_TOGGLE_WEBPANEL":{const t=n;t&&(o=()=>u.Z.toggleContent(e,t));break}case"JS_LOCAL_RESTORE_WEBPANEL":{const t=n;t&&(o=()=>k.Z.restoreById(e,t,!0));break}case"COMMAND_OPEN_LINK":n&&(o=()=>{const t=s.ZP.getOpenOptionsFromDisposition(e,"setting",!1,{});h.ZP.openURL(e,n,{...t})});break;case"JS_LOCAL_OPEN_SESSION":n&&(o=()=>y.Z.open(e,[Number(n)],!0));break;default:void 0!==n&&(o=m.Z.getHandlerByAction(e,t,n))}return o}getUserEditableCommands(){return this.getAllCommands(T.Ex).filter((e=>!de.includes(e.name)))}makeCommandList(e,t){const n=me.filter((n=>t?t===n.name:!(n.inMenu&&!n.inMenu(e,!0))));return void 0===t&&n.push.apply(n,ce.filter((e=>!(e=>!!(e.hideInSettings||e.name===oe&&G.hasBookmarkContainer))(e))).map((e=>({name:e.name,behavior:"container"})))),this.makeMenuWithContent(e,n.map((e=>{switch(e.behavior){case"checkbox":return{id:e.name,action:e.name,type:"checkbox"};case"radio":return{id:e.name,action:e.name,type:"radio"};case"container":return{id:e.name,action:e.name,containermode:"folder",type:"container"};default:return{id:e.name,action:e.name,type:"command"}}})),{expandContainers:!1,inSettings:!0,updateCallbacks:!1})}getCommandParameter(e){if(1===me.filter((t=>t.name===e)).length)return B.FD[e]}getCommandLabel(e){const t=me.filter((t=>t.name===e));if(1===t.length)return t[0].label}getOpenLinkName(){return"COMMAND_OPEN_LINK"}getCommandByGuid(e){return this.getAllCommands(T.Ex).find((t=>t.guid===e))}getIsContainer(e){return ce.some((t=>t.name===e))}dispatchAction(e){switch(e.actionType){case"COMMAND_INITIALIZE":we(e.items),this.emitChange("init");break;case"COMMAND_RESET":s=e.items,Object.keys(pe).forEach((e=>{delete pe[e]})),we(s),this.emitChange("init");break;case"COMMAND_SET_NAMED_MENU":t=e.name,n=e.content,G.installed&&Te(G.items),G.windowId=void 0,G.name=t,G.radioCounter=1,G.radioGroup={},G.items=[],G.hasBookmarkContainer=!1,G.bookmarkExtrasEdge="below",n?n.forEach((e=>{const t=Ae(e,!0);t&&G.items.push(t)})):console.error("No entries in menu:",t),Ze(G.windowId,G.items,!0),G.installed=!0,this.emitChange("menu");break;case"COMMAND_UPDATE_COMMAND":be(e.item),function(e){const t=Fe.getCommandsForShortcuts();he.map(((e,t)=>({...e,index:t}))).filter((t=>t.name===e.key)).forEach((e=>{d.Z.unbind(e.key,e.func),he.splice(e.index,1)})),e.value.shortcuts?.forEach((e=>{ye(t[e],e)}))}(e.item),this.emitChange("shortcut");break;case"COMMAND_REMOVE_COMMAND":Se(e.key),this.emitChange("shortcut");break;case"CONTENT_SCRIPTS_UPDATED":e.updated.forEach((e=>Se(e))),this.emitChange("shortcut")}var t,n,s}}const Fe=new Be(I.Z),Ve=Fe},72010:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r,s:()=>o});var s=n(65398),i=n(33638);const o=-1;class a extends s.Z{_contacts=new Map;_selectedContact;getAsArray(){return[...this._contacts.values()]}getAsTree(e){const t=e?e.toLowerCase():e;return t?this.getAsArray().filter((e=>this._hasFilter(e,t))):this.getAsArray()}getSelected(){return this._selectedContact}getNodeById(e){return this._contacts.get(e)}getAddressesById(e){return this._contacts.get(e)?.emailAddresses.map((e=>e.emailAddress))}getContactsWithAddress(e){const t=this.getAsArray().filter((t=>{if(t.emailAddresses&&t.emailAddresses.length>0)return t.emailAddresses.some((t=>t.emailAddress.toLowerCase()===e.toLowerCase()))}));if(t.length>0)return t[0]}hasContact(e,t){return this.getAsArray().some((n=>!!(n.emailAddresses&&n.emailAddresses.length>0)&&(n.emailAddresses.some((e=>e.emailAddress.toLowerCase()===t.toLowerCase()))&&n.name===e)))}isTrustedEmailAddress(e){for(const t of this.getAsArray())for(const n of t.emailAddresses)if(n.emailAddress.toLowerCase()===e.toLowerCase()&&t.trusted)return!0;return!1}getMailAddresses(){const e=new Map;for(const t of this._contacts.values())t.emailAddresses.forEach((n=>{const s=n.emailAddress.toLowerCase(),i=e.get(s);i?i.add(t.name):e.set(s,new Set([t.name]))}));return e}dispatchAction(e){switch(e.actionType){case"CONTACT_ADD_CONTACT":this._addContact(e.contact);break;case"CONTACT_ADD_CONTACTS":this._addContacts(e.contacts);break;case"CONTACT_DELETE_CONTACTS":this._delete(e.ids);break;case"CONTACT_INITIALIZE":this._initialize(e.contacts,e.newContact);break;case"CONTACT_SELECT_CONTACT":this._select(e.contact,e.focusContactView);break;case"CONTACT_UPDATE_CONTACT":this._update(e.contact)}}_update(e){this._contacts.set(e.id,e),this._selectedContact?.id===e.id&&(this._selectedContact=e),this.emitChange({reason:"updatedContact"})}_initialize(e,t){e.forEach((e=>{this._contacts.set(e.id,e)})),t?(this._selectedContact=t,this.emitChange({reason:"newContact",contact:t,focusContactView:!0})):this.emitChange({reason:"startup"})}_addContact(e){this._contacts.set(e.id,e),this.emitChange({reason:"addContacts"})}_addContacts(e){e.forEach((e=>{this._contacts.set(e.id,e)})),this.emitChange({reason:"addContacts"})}_delete(e){e.forEach((e=>{this._contacts.delete(e),this._selectedContact?.id===e&&(this._selectedContact=void 0)})),this.emitChange({reason:"deleteContact"})}_select(e,t){this._selectedContact=e,this.emitChange({reason:"selectedContact",contact:e,focusContactView:t})}_hasFilter(e,t){if(!t||0===t.length)return!0;if(e.name&&e.name.toLowerCase().indexOf(t)>-1)return!0;if(e.emailAddresses){let n=!1;if(e.emailAddresses.forEach((e=>{e.emailAddress.toLowerCase().indexOf(t)>-1&&(n=!0)})),n)return!0}return!1}}const r=new a(i.Z)},27033:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var s=n(24602),i=n(33638);class o extends s.Z{getInitialState(){return[]}getScripts(){return this.getState()}reduce(e,t){switch(t.actionType){case"CONTENT_SCRIPTS_UPDATED":case"CONTENT_SCRIPTS_INITIALIZE":return t.scripts}return e}}const a=new o(i.Z)},45502:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var s=n(24602),i=n(93513);const o={area:"content",feature:"browser"};class a extends s.Z{getInitialState(){return new Map}isBrowserFeature(e){return"browser"===(e||"browser")}getContext(e){const t=this.getState().get(e);return t||o}reduce(e,t){return"SWITCH_CONTEXT"===t.actionType?(0,i.Uy)(e,(e=>{e.set(t.windowId,t.context)})):e}}const r=new a},1567:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var s=n(65398),i=n(33638);class o extends s.Z{ready=new Promise((e=>this.resolveReady=e));openAfterDownload=new Set;_downloadItems=[];_totalNumberOfDownloads=0;_totalProgress=0;_filter="";dispatchAction(e){switch(e.actionType){case"DOWNLOAD_PANEL_UPDATED":return this._downloadItems=e.downloadItems,void this.emitChange({reason:"download_panel_updated"});case"DOWNLOAD_COMPLETED":return void this.emitChange({reason:"download_completed",downloadItem:e.downloadItem});case"DOWNLOAD_STARTED":return void this.emitChange({reason:"download_started",downloadItem:e.downloadItem});case"DOWNLOAD_SET_TOTAL_PROGRESS":return this._totalProgress=e.totalProgress,this._totalNumberOfDownloads=e.totalNumberOfDownloads,void this.emitChange({reason:"download_total_progress_changed"});case"DOWNLOAD_SET_FILTER":return this._filter=e.filter,this._downloadItems=e.downloadItems,void this.emitChange({reason:"download_panel_updated"});case"DOWNLOAD_SET_ORDER_BY":return this._orderBy=e.orderBy,this._downloadItems=e.downloadItems,void this.emitChange({reason:"download_panel_updated"})}}getTotalNumberOfDownloads(){return this._totalNumberOfDownloads}hasDownloads(e){return this.getItems(e).length>0}getTotalProgress(){return this._totalProgress}getFilter(){return this._filter}getOrderBy(){return this._orderBy}getItems(e){return this._downloadItems.filter((t=>!(!e.isIncognitoWindow&&t.incognito))).filter((e=>!("interrupted"===e.state&&""===e.filename)))}}const a=new o(i.Z)},16875:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var s=n(24602),i=n(25372),o=n(48588);const a=Object.freeze({rewindHistory:[],rewindIndexes:[],forwardUrl:""});function r(e,t){const n=(0,i.Z)(e),s=(0,i.Z)(t);return n?.hostname===s?.hostname}function l(e,t,n,s){e.rewindHistory||(e.rewindHistory=[],e.rewindIndexes=[]);const i=e.prev&&e.prev.url&&r(e.prev.url,t.url);return n!==s.length-1&&(e.prev&&!i&&n<s.length-1?(s.length-1-n>1&&(e.rewindHistory.length>0&&r(e.rewindHistory[e.rewindHistory.length-1].url,e.prev.url)&&e.rewindHistory[e.rewindHistory.length-1].url!==e.prev.url||r(s[s.length-1].url,e.prev.url)&&s[s.length-1].url!==e.prev.url)&&(e.rewindHistory.push(e.prev),e.rewindIndexes.push(s.length-n-2)),e.rewindHistory.push(t),e.rewindIndexes.push(s.length-n-1)):0===n&&s.length>0&&(e.rewindHistory.push(t),e.rewindIndexes.push(s.length-n-1))),e.prev=t,e}class d extends s.Z{getInitialState(){return new Map}getStateById(e){return this.getState().get(e)||a}getFastForwardUrl(e){return this.getStateById(e).forwardUrl}getRewindRelativeIndex(e){const t=this.getState().get(e);if(t){const{rewindIndexes:e}=t;if(e.length>0)return e[0]}return 0}getRewindHistory(e){return this.getStateById(e.id).rewindHistory}getRewindIndexes(e){return this.getStateById(e.id).rewindIndexes}reduce(e,t){switch(t.actionType){case"FAST_FORWARD_SET_FORWARD_URL":const{forwardUrl:n,pageId:s}=t;return(0,o.c)(e,s,(e=>{e.forwardUrl=n}),a);case"CHROME_TABS_UPDATED":{const{tabId:n,changeInfo:s}=t;return"loading"!==s.status?e:(0,o.c)(e,n,(e=>{e.forwardUrl=""}),a)}case"FAST_FORWARD_SET_REWIND_INFO":{const{currentIndex:n,history:s,pageId:i}=t;return(0,o.c)(e,i,(e=>{const{rewindHistory:t,rewindIndexes:i}=(o=n,s.slice(0,o+1).reduceRight(l,{}));var o;0===e.rewindHistory.length&&0===t.length||(e.rewindHistory=t),0===e.rewindIndexes.length&&0===i.length||(e.rewindIndexes=i)}),a)}case"PAGE_CLOSE":{const{pages:n}=t;let s=e;return n.forEach((e=>{s.has(e.id)&&(s=new Map(s),s.delete(e.id))})),s}default:return e}}}const c=new d},31186:(e,t,n)=>{"use strict";n.d(t,{Z:()=>O});var s=n(65398),i=n(30381),o=n.n(i),a=n(96951),r=n(93974),l=n(33638),d=n(16920),c=n(35369),h=n(88594),p=n(81277),u=n(15467),g=n(5531),m=n(23542),v=n(19789);function f(e){return{text:"",startTime:o()().startOf("day"),endTime:o()().endOf("day"),rangePicker:"today",displayMode:"day",parsedFilter:{title:"",url:"",query:""},dayPickerVisible:!1,moreInfoVisible:!0,monthEntriesVisible:!0,searchURL:!0,searchTitle:!0,range:null,sortOrder:r.Z.DESCENDING_SORT,sortField:"visitTime",...e}}function y(e){const{items:t,filterText:n,titleFilter:s,urlFilter:i,shouldSearchUrl:o}=e,a=(i||s||n).toLowerCase().split(" ");return t.map((e=>{const t=e.children.filter((e=>{const t=e.title.toLowerCase(),n=e.url.toLowerCase();return i?a.every((e=>n.includes(e))):s||!o?a.every((e=>t.includes(e))):a.every((e=>n.includes(e)||t.includes(e)))}));return{...e,children:t}}))}var C=n(34155);const w=(0,m.extendMoment)(o()),b="PANEL";let S=null,I=new c.D5,k=new c.D5({today:[],other:[]});const A={};let T=r.Z.DESCENDING_SORT,Z="";class E extends s.Z{getPanelResourceKey(){return b}isPanel(e){return e===b}getHistorySearchResults(e){let t=[];const n=this.getFilter(e);if(n.sortOrder!==T||n.sortField!==Z){const{sortOrder:e,sortField:t}=n;k=k.set("today",this.sortHistory(e,t,k.get("today"))),k=k.set("other",this.sortHistory(e,t,k.get("other"))),T=n.sortOrder,Z=n.sortField}if(t=n.sortOrder===r.Z.DESCENDING_SORT?k.get("today").concat(k.get("other")):k.get("other").concat(k.get("today")),t=t.filter((e=>e.visitTime>=n.startTime.valueOf()&&e.visitTime<=n.endTime.valueOf())),n.parsedFilter.query||n.parsedFilter.title||n.parsedFilter.url){t=y({items:t,filterText:n.parsedFilter.query.toLowerCase(),titleFilter:n.parsedFilter.title.toLowerCase(),urlFilter:n.parsedFilter.url.toLowerCase(),shouldSearchUrl:n.searchURL})}return{items:t,filter:n,oldestHistoryDate:S||w()}}getTotalHistory(){return k.get("today",[]).length+k.get("other",[]).length}getFilteredHistory(e,t){const n=k.get("today",[]),s=k.get("other",[]),i=y({items:t?n.concat(s.slice(0,10)):n.concat(s),filterText:e,shouldSearchUrl:!0}),o=new Map;for(let e=i.length;e--;){const t=i[e].children;for(let e=t.length;e--;){const n=t[e],s=o.get(n.url);o.set(n.url,{...n,visitCount:s?s.visitCount+n.visitCount:n.visitCount,visitTime:s?Math.max(s.visitTime,n.visitTime):n.visitTime})}}return[...o.values()]}sortHistory(e,t,n){const s=r.Z.getDefaultComparator(e,t);return r.Z.treeSort(n,s),n}getStatistics(e){const t={...k.get("todaysStats",{}),...k.get("olderStats",{})},n=I.get(e,f());return this.getFilteredStatistics(t,n.parsedFilter.query.toLowerCase())}getFilteredStatistics(e,t){const n={};return Object.keys(e).forEach((s=>{const i=e[s].mostVisited.filter((e=>-1!==e.url.indexOf(t)));i.length&&(n[s]={mostVisited:i,timeArr:e[s].timeArr,pages:i.length,visits:i.reduce(((e,t)=>e+t.visitCount),0)})})),n}getFilter(e){let t=I.get(e);if("number"!=typeof e){if(t||(t=f({range:w.range(w().startOf("day"),w().endOf("day"))})),e!==b)return console.error("Unkonwn subscriber id",e),t;{const e=this.getTimeByRange({rangePicker:t.rangePicker});t={...t,endTime:e.endTime?e.endTime:t.endTime,startTime:e.startTime?e.startTime:t.startTime}}}else if(!t){t=f({range:w.range(w().startOf("day"),w().endOf("day"))});let n={...a.ZP.getHistoryManagerState(e)};0===Object.getOwnPropertyNames(n).length?(n={...d.Z.getSync("HISTORY_MANAGER_STATE")},n.endTime=w(),"range"===n.displayMode?(n.startTime?n.startTime=w(n.startTime):S?n.startTime=S:w().startOf("month"),n.range=w.range(n.startTime,n.endTime)):(n.startTime=w().startOf(n.displayMode),n.range=w.range(w(n.startTime).startOf(n.displayMode),w(n.endTime).endOf(n.displayMode)))):(n.startTime=n.startTime?w(n.startTime):w(),n.endTime=n.endTime?w(n.endTime):w(),n.range=w.range(w(n.startTime).startOf("day"),w(n.endTime).endOf("day"))),t={...t,...n}}return I=I.set(e,t),t}getTimeByRange(e,t){return isNaN(parseInt(e.rangePicker))?"today"===e.rangePicker?(e.startTime=w().startOf("day"),e.endTime=w().endOf("day")):"yesterday"===e.rangePicker?(e.startTime=w().subtract(1,"day").startOf("day"),e.endTime=w().subtract(1,"day").endOf("day")):"last_month"===e.rangePicker?(e.startTime=w().subtract(1,"month").startOf("month"),e.endTime=w().subtract(1,"month").endOf("month")):"all"===e.rangePicker?(t&&(e.startTime=t.startOf("day")),e.endTime=w().endOf("day")):"date_range"===e.rangePicker||console.warn("Unknown date range",e.rangePicker):(e.startTime=w().subtract(parseInt(e.rangePicker),"day").startOf("day"),e.endTime=w().endOf("day")),e}dispatchAction(e){switch(e.actionType){case"CHROME_TABS_REMOVED":t=e.tabId,I=I.delete(t);break;case"HISTORY_INIT":_("start");break;case"HISTORY_INIT_FILTER":!function(e,t){if(!e.startTime||!e.endTime)return void console.error("Initializing history filter failed. Missing timestamps");const n=x.getTimeByRange({rangePicker:e.rangePicker,startTime:w(e.startTime),endTime:w(e.endTime)}),s=I.get(t,f());I=I.set(t,{...s,...n}),x.emitChange("filterChange",t)}(e.setting,e.id);break;case"HISTORY_LOAD_TODAY":!function(e){const t=k.get("today",[]);if(t.length>0){if(w(t[0].visitTime).endOf("day")<w().startOf("day")){const e=t.concat(k.get("other"));k=k.set("other",e);const n=k.get("todaysStats"),s=k.get("olderStats"),i=Object.assign(n,s);k=k.set("olderStats",i)}}const n=N(e),s=P(n);if(T===r.Z.ASCENDING_SORT){const e=r.Z.getDefaultComparator(T,"visitTime");r.Z.treeSort(s,e)}k=k.set("today",s);const i=D(s),o=M(n,i);k=k.set("todaysStats",o),x.emitChange("searchResultsReady")}(e.items);break;case"HISTORY_LOAD_YESTERDAY_AND_OLDER":!function(e){const t=N(e),n=P(t),s=D(n);k=k.set("other",k.get("other",[]).concat(n)),S=w(k.get("other",[]).reduce(((e,t)=>e<t.id?e:t.id),w().valueOf()));const i=M(t,s);k=k.set("olderStats",{...k.get("olderStats"),...i}),x.emitChange("searchResultsReady")}(e.items);break;case"HISTORY_REMOVE_AFTER":!function(e){if(0===e)k=new c.D5,k=k.set("today",[]),k=k.set("other",[]),k=k.set("todaysStats",{}),k=k.set("olderStats",{}),x.emitChange("searchResultsReady");else{const t=w();let n="today",s="todaysStats";e<t.startOf("d").valueOf()&&(n="other",s="olderStats",k=k.set("today",[])),k=k.set("todaysStats",{});let i=!1;const o=[],a=k.get(n,[]);a.forEach((t=>{const n=t.children.slice().filter((t=>t.visitTime<=e));i=i||n.length!==t.children.length,n.length>0&&(n.length!==t.children.length?o.push({...t,children:n}):o.push(t))})),k=k.set(n,i?o:a);const r=k.get(s,{}),l=new w(e);Object.keys(r).forEach((e=>{w(e).startOf("day")>=l.startOf("day")&&delete r[e]})),k=k.set(s,r),x.emitChange("searchResultsReady")}}(e.since);break;case"HISTORY_REMOVE_VISITS":e.visits.forEach((e=>{e.isFolder?function(e){const t=w(e.visitTime).startOf("day"),n=w(e.visitTime).endOf("day"),s=(0,v.SI)(t);let i="other",o="olderStats";w().isBetween(t,n)&&(i="today",o="todaysStats"),k.get(i,[]).forEach(((e,t)=>{if(e.id===s){const e=k.get(i),n=k.get(o);k=k.set(o,(0,h.Z)(n,s)),e?.splice(t,1),k=k.set(i,e)}}))}(e):void 0===e.url?console.error("Can not remove history element. Url missing"):function(e){const t=w(e.visitTime).startOf("day"),n=w(e.visitTime).endOf("day"),s=(0,v.SI)(t);let i="other",o="olderStats";w().isBetween(t,n)&&(i="today",o="todaysStats");const a=[];k.get(i)?.forEach((t=>{if(t.id===s){const n=k.get(o,{});n[s].mostVisited.forEach(((t,i)=>{t.url===e.url&&n[s].mostVisited.splice(i,1)}));const i=t.children.filter((t=>t.url!==e.url));i.length>0&&(i.length!==t.children.length?a.push({...t,children:i}):a.push(t))}else a.push(t)})),k=k.set(i,a)}(e)})),x.emitChange("searchResultsReady");break;case"HISTORY_SEARCH":!function(e,t){const n=I.get(t);I=I.set(t,e);n?.text!==e.text&&x.emitChange("filterChange",t);C.nextTick((()=>{x.emitChange("searchResultsReady",t)}))}(e.filter,e.id)}var t}}function _(e){if("start"===e)A.id||(A.id=setInterval(_,6e5,"tick"),A.date=w());else if("stop"===e)A.id&&(clearInterval(A.id),A.id=void 0);else if("tick"===e){const e=w();A.date.date()!==e.date()&&(A.date=e,x.emitChange("searchResultsReady"))}}function M(e,t){const n={};return(0,p.Z)(e,((e,s)=>{const i={},o=(0,u.Z)(e,"hour");(0,p.Z)(o,((e,t)=>{const n=(0,g.Z)(e,"url");i[t]={pages:n.length,visits:e.reduce(((e,t)=>e+t.visitCount),0)}}));const a=[];for(let e=0;e<=24;e++)a.push({hour:e,pages:i[e]?i[e].pages:0,visits:i[e]?i[e].visits:0,unixDate:w(s+"T"+(e<10?"0":"")+e).valueOf()});n[e[0].dateKey]={mostVisited:t[e[0].dateKey],timeArr:a}})),n}function N(e){return(0,u.Z)(e,"dateKey")}function P(e){const t=[];return(0,p.Z)(e,((e,n)=>{const s=(0,u.Z)(e,"url"),i=[];(0,p.Z)(s,((e,t)=>{const n=e[0],s=e.reduce(((e,t)=>e.visitTime>t.visitTime?e:t)).visitTime,o=e.reduce(((e,t)=>e+t.visitCount),0);i.push({address:n.address,isBookmarked:n.isBookmarked,protocol:n.protocol,title:n.title,hour:n.hour,transition_type:n.transition_type,url:t,id:n.id+"_"+s,visitCount:o,visitTime:s,dateKey:n.dateKey,source:n.source})})),t.push({children:i,id:e[0].dateKey,pages:Object.keys(s).length,visitCount:i.reduce(((e,t)=>e+t.visitCount),0),visitTime:w(e[0].dateKey).valueOf()})})),t}function D(e){const t={};return e.forEach((e=>{const n=e.children.slice().sort(((e,t)=>e.visitCount-t.visitCount));t[e.id]=n.map((e=>({url:e.url,visitCount:e.visitCount})))})),t}const x=new E(l.Z),O=x},98611:(e,t,n)=>{"use strict";n.d(t,{Z:()=>$});var s=n(65398),i=n(99827),o=n(54162),a=n(29087),r=n(33638),l=n(47513),d=n.n(l),c=n(91834),h=n(71320),p=n(51501),u=n(10671),g=n(75401),m=n(84283),v=n(89165),f=n(95752),y=n(45660),C=n(54773),w=n(18787),b=n(5863),S=n(75995),I=n(51733),k=n(89175),A=n(34155);let T,Z,E,_,M,N=[],P=[],D=[],x={},O=!1,L=!1,R=[],B=[];function F(e,t){e.forEach((e=>{const{accountId:n,path:s,counter:i}=e;if(x[n]||(x[n]={}),t&&x[n][s]){const e=x[n][s];e.total+=i.total,e.unseen+=i.unseen,e.unread+=i.unread}else x[n][s]=i}))}function V(e){const{addedSles:t,removedSles:n}=e,{sleUpdates:s}=e,i=G.getListEntryComparator(),o=new Set;let a=!1;const r=new Set,l=[],h=[];function u(e){const t=G.createListEntry(e,[]),n=d()(P,t,I.PN);n<0&&P.splice(-n-1,0,t);const s=d()(D,t,i);s<0&&D.splice(-s-1,0,t),function(e){R.length>0&&(R=R.filter((t=>t.id!==e.id||(S(t),y.Z.log("Mail",`Doing postponed index update for ${e.id}`),!1)))),B.length>0&&(B=B.filter((({id:t,newThreadKey:n})=>t!==e.id||(U(new Map([[t,n]])),y.Z.log("Mail",`Doing postponed thread key update for ${e.id}`),!1))))}(e)}function S(e){const t=G.getListEntry(e.id);if(!t)return R.push(e),void y.Z.log("Mail","Entry not found in index. Index update postponed until entry arrives.");const n=new Set([...t.viewIds]),s=new Set([...t.totalViewIds]),{updates:o}=e;void 0!==o.sentDate&&(t.sentDate=o.sentDate),Object.keys(o).includes("queued")&&(void 0===o.queued?delete t.queued:t.queued=o.queued),void 0!==o.attachment&&(t.attachment=o.attachment),void 0!==o.flags&&(t.flags=o.flags),void 0!==o.from&&(t.fromIds=o.from.map(C.Z.add)),void 0!==o.sourceFilterIds&&(t.sourceFilterIds=o.sourceFilterIds),void 0!==o.subject&&(t.subject=o.subject),void 0!==o.to&&(t.toIds=o.to.map(C.Z.add));const c=o.removedViewIds||[],u=o.addedViewIds||[];if(void 0!==o.unseen)if(t.unseen=o.unseen,o.unseen)o.unseen&&y.Z.warn("Mail",["filter","store"],"updateIndex is trying to mark a message unseen",o);else{const e=[...n].filter((e=>e%b.XN===b.ZC));c.push(...e)}if(void 0!==o.sources){let e=!1,s=!1;if(o.sources.forEach(((n,i)=>{if(n){const o=t.sources.get(i);if(o){if(void 0!==n.read&&o.read!==n.read){const t=i*b.XN+b.aD;n.read?c.push(t):u.push(t),e=!0}if(void 0!==n.deleted&&o.deleted!==n.deleted&&!(0,v.Z)(t.sources,t.flags)&&!(0,g.Z)(t.sources)){const e=i*b.XN+b.IK;n.deleted?c.push(e):u.push(e),s=!0}t.sources.set(i,{...o,...n})}else{const{read:e,deleted:s,internal:o}=n;if(void 0===e||void 0===s||void 0===o)throw new Error("Cannot add invalid source "+JSON.stringify(n));t.sources.set(i,{read:e,deleted:s,internal:o})}}else t.sources.delete(i)})),e||s){const i=new Set;n.forEach((e=>{const t=Math.floor(e/b.XN);i.add(t)}));const o=[...i].filter((e=>!t.sources.has(e)));if(o.length>0){if(e){const e=o.map((e=>e*b.XN+b.aD));f.Z.call(t.sources)?c.push(...e):u.push(...e)}if(s){const e=o.map((e=>e*b.XN+b.IK));m.Z.isMessageDeleted(t.sources)?c.push(...e):u.push(...e)}}}}n.forEach((e=>r.add(e)));const w=new Set([...n]);if(c.length>0)for(const e of c)t.viewIds.delete(e),w.delete(e),r.add(e),p.Z.isViewIdOfType(e,b.xE)&&t.totalViewIds.delete(e);if(u.length>0)for(const e of u)t.viewIds.add(e),w.add(e),r.add(e),p.Z.isViewIdOfType(e,b.xE)&&t.totalViewIds.add(e);h.push(n),l.push(w);const S=G.isVisible({...t,viewIds:n,totalViewIds:s}),I=G.isVisible(t);if(S||I){if(!S&&I){const e=d()(N,t,i);N.splice(-e-1,0,t)}else if(S){let n=d()(N,t,i),s=!1;if(n<0&&(n=N.findIndex((e=>e===t)),s=!0),n>=0)if(I){if(s){N.splice(n,1);const e=d()(N,t,i);N.splice(-e-1,0,t)}}else N.splice(n,1);else console.warn("Message not found in _listEntries",{sleUpdate:e})}a=!0;let n=d()(D,t,i);if(n<0)if(n=D.findIndex((e=>e===t)),n>=0){D.splice(n,1);const e=d()(D,t,i);D.splice(-e-1,0,t)}else console.warn("Message not found in _sortedIndex",{sleUpdate:e})}}if(n&&n.forEach((e=>{!function(e){const t=d()(P,{id:e},I.PN);if(t>=0){const[n]=P.splice(t,1),s=d()(D,n,i);s>=0&&D.splice(s,1),n.viewIds.forEach((e=>r.add(e))),h.push(n.viewIds);const l=d()(N,n,i);l>=0&&(N.splice(l,1),a=!0),o.add(e)}}(e)})),o.size>0&&w.Z.removeEntries(o),t&&t.forEach((e=>{u(e)})),s&&s.forEach((e=>{S(e)})),a&&(N=N.slice(),G.emitChange({target:"listEntries",updateSelection:!0})),r.size>0){const e=G.getCounterFolders([...r]);e.length>0&&(h.forEach((t=>{const n=[...t].filter((e=>e%b.XN===b.xE));c.Z.updateCounterFolders(t,n,-1,e)})),l.forEach((t=>{const n=[...t].filter((e=>e%b.XN===b.xE));c.Z.updateCounterFolders(t,n,1,e)})),F(e,!0),G.emitChange({target:"counters"}))}}function W(){const e=Date.now();N=D.filter((e=>G.isVisible(e))),y.Z.log("Mail",["filter","store"],`initListEntries took ${Date.now()-e}ms.`),O=!1}function U(e){const t=a.Z.get(k.kMailSearchSortField),n=G.getListEntryComparator();let s,r=!1;e.forEach(((e,i)=>{const a=d()(P,{id:i},I.PN);if(a<0)return B.push({id:i,newThreadKey:e}),void y.Z.log("Mail","Entry not found in index. Thread key update postponed until entry arrives.");const l=P[a],c=l.threadKey;if("threads"===t){const t=d()(D,l,n),s=d()(N,l,n);l.threadKey=e,t>=0&&D.splice(t,1);const i=d()(D,l,n);D.splice(-i-1,0,l);if(G.isVisible(l)){s>=0&&N.splice(s,1);const e=d()(N,l,n);N.splice(-e-1,0,l),r=!0}}else l.threadKey=e;const h=o.Z.getSelectedThreadPrefix();if(h){const e=c.splice(0,2);h.every(((t,n)=>e[n]===t))&&(s=P[a])}})),s&&A.nextTick(s&&i.Z.selectThread(s)),r&&G.emitChange({target:"listEntries"})}function H(){T=void 0;(()=>{const e=o.Z.getSelectedFolder();if(e){const{accountId:t,path:n}=e;if(t!==b.tQ){const e=G.getByFolder(t,n);e&&(Z=p.Z.getViewIntersections(e))}}})(),W(),G.emitChange({target:"listEntries"})}class z extends s.Z{getByAccountId(e){return h.Z.getByAccountId(e)}getByFolder(e,t=b.ym){if(e)return h.Z.getByFolderId([e,t])}get(e){return h.Z.get(e)}getByIds(e){return h.Z.getByIds(e)}getByFolderId(e){return h.Z.getByFolderId(e)}getSourceFilters(e){const t=d()(P,{id:e},I.PN);if(t>=0){const{sourceFilterIds:e}=P[t];return h.Z.getByIds(e)}return[]}isLoading(){return O}isInitialized(){return L}getKnownFlags(){const e=this.getByAccountId(b.ut).map((e=>e.path)),t=Object.keys(b.T4).map((e=>b.T4[e]));return e.concat(t)}isSenderMailingList(e){const t=b.cs+"/"+e,n=b.W4+"/"+e;return void 0!==h.Z.getAll().find((e=>e.accountId===b.wC&&(e.path===t||e.path===n)))}isCounterFolder(e){return e?.accountId!==b.tQ}getCounters(e,t=b.ym){return x[e]&&x[e][t]}isCounterViewId(e,t){const n=e%b.XN,{showRead:s,showMailingLists:i,showFeeds:o,showJunk:a,showCustomFolder:r,showArchived:l}=p.Z.getFilterOptions(t);switch(n){case b.xE:return!!s&&!!i&&!!o;case b.ZC:return!0;case b.aD:return!s;case b.EO:return!i;case b.Fz:return!o;case b.Jq:return!a;case b.js:return!r;case b.pF:return!l;default:return!1}}getCounterFolders(e){const t=new Set;for(const n of e){const e=Math.floor(n/b.XN);if(t.has(e))continue;const s=G.get(e);s&&(G.isCounterFolder(s)&&G.isCounterViewId(n,s)&&t.add(e))}if(0===t.size)return[];const n=new Map;for(const e of t){const t=G.get(e);if(!t)continue;const{id:s,accountId:i,path:o}=t,a=h.Z.getByFolderId([i,b.ym]),r=a?[a]:[];if(u.Z.getFolderType(i,o)===b.Oi){const e=h.Z.getByFolderId([b.Ry,b.ym]);e&&r.push(e)}let l=o.substring(0,o.lastIndexOf("/"));for(;l.length>0;){const e=h.Z.getByFolderId([i,l]);e&&r.push(e),l=l.substring(0,l.lastIndexOf("/"))}for(const e of r){const{id:t,filterValue:s}=e;if(s.showSubFolders&&!n.has(t)){const s=G.createCounterFolder(e);n.set(t,s)}}if(!n.has(s)){const e=G.createCounterFolder(t);n.set(s,e)}}return[...n.values()]}createCounterFolder(e){const{accountId:t,path:n}=e;return{accountId:t,path:n,viewIntersections:G.getViewIntersections(e),counter:{total:0,unseen:0,unread:0}}}getViewIntersections(e){const{showDeleted:t,showMailingLists:n,showFeeds:s,showJunk:i,showCustomFolder:o,showSubFolders:a,showArchived:r}=p.Z.getFilterOptions(e),l=[e];if(a){const t=p.Z.getSubFilters(e);l.push(...t)}const d={total:new Map,unseen:new Map,unread:new Map};for(const e of l){const{id:a}=e,l=a*b.XN+b.xE,c=a*b.XN+b.ZC,h=a*b.XN+b.aD,p=n?0:a*b.XN+b.EO,u=t?0:a*b.XN+b.IK,g=s?0:a*b.XN+b.Fz,m=i?0:a*b.XN+b.Jq,v=o?0:a*b.XN+b.js,f=r?0:a*b.XN+b.pF;if(p||u||g||m||v||f){const e=[];p&&e.push(p),u&&e.push(u),g&&e.push(g),m&&e.push(m),v&&e.push(v),f&&e.push(f),d.total.set(l,e),d.unseen.set(l,[c,...e]),d.unread.set(l,[h,...e])}else d.total.set(l,[l]),d.unseen.set(l,[c]),d.unread.set(l,[h])}return d}getIndex(){return P}getIndexSearchListIds(){return P.map((e=>e.id))}getListEntry(e){const t=d()(P,{id:e},I.PN);if(t>=0)return P[t]}matchesViewIntersection(e,t,n){for(const s of n||e){if(t.get(s)?.every((t=>e.has(t))))return!0}return!1}getListEntryComparator(){const e=a.Z.get(k.kMailSearchSortField);let t;switch(e){case"sentDate":t=I.rQ;break;case"subject":t=I.Ji;break;case"sender":const e=o.Z.getSelectedFolder(),n=!!e&&[b.Nz,b.kY,b.fZ].includes(u.Z.getFolderType(e.accountId,e.path));t=(0,I.S5)(n,C.Z.get);break;case"threads":t=I.HT}if(!t)throw new Error("Comparator not found for sort field "+e);return"ascending"===a.Z.get(k.kMailSearchSortOrder)?t:(0,I.g4)(t)}isVisible(e){if(void 0!==E);else{if(!Z)return!1;if(!G.matchesViewIntersection(e.viewIds,Z,e.totalViewIds))return!1}if(null!=M){if(0===M&&e.attachment>0)return!1;if(M>0&&0===e.attachment)return!1}return!(_&&_>e.sentDate)&&((!E||!E.some(((t,n)=>t!==e.threadKey[n])))&&!(T&&d()(T,e,I.dc)<0))}hasNoListEntries(){return 0===N.length}createListEntry(e,t){const{id:n,messageId:s,attachment:i,flags:o,replied:a,sentDate:r,subject:l,threadKey:d,unseen:c,queued:h,sourceFilterIds:p,sources:u,size:g}=e,m=e.to.map((e=>C.Z.add(e))),v=e.from.map((e=>C.Z.add(e))),f=new Set,y=new Set;for(const e of t)f.add(e),e%b.XN===b.xE&&y.add(e);return{id:n,messageId:s,attachment:i,flags:o,replied:a,sentDate:r,subject:l,threadKey:d,unseen:c,queued:h,viewIds:f,totalViewIds:y,sourceFilterIds:p,sources:u,toIds:m,fromIds:v,size:g}}getListEntries(){return N}getQueryNumFound(){return T?.length}getListEntriesByFolder(e,t){const n=this.getByFolder(e,t);if(!n)throw new Error("Filter not found "+[e,t].join());const s=p.Z.getViewIntersections(n);return P.filter((e=>this.matchesViewIntersection(e.viewIds,s,e.totalViewIds)))}getListEntryIdsByViewIds(e){return P.filter((t=>e.some((e=>t.viewIds.has(e))))).map((e=>e.id))}dispatchAction(e){switch(e.actionType){case"MAIL_INIT_INDEX_FINISHED":!function(){P.sort(I.PN);const e=G.getListEntryComparator();D.sort(e),W(),L=!0,G.emitChange({target:"finishIndexProgress"}),G.emitChange({target:"listEntries",updateSelection:!0})}();break;case"MAIL_INIT_INDEX_BATCH":!function(e,t,n){const s=new Set;for(const e of t)for(const t of e.viewIds)s.add(t);const i=G.getCounterFolders([...s]);for(let n=0;n<e.length;n++){const s=e[n],{searchListId:o,viewIds:a}=t[n];if(s.id>o)throw new Error(`Database inconsistency: extra viewIds entry ${o}.`);if(s.id<o)throw new Error(`Database inconsistency: viewIds entry for SLE ${s.id} not found.`);const r=G.createListEntry(s,a);if(P.push(r),D.push(r),i.length>0){const{viewIds:e,totalViewIds:t}=r;c.Z.updateCounterFolders(e,t,1,i)}}F(i,!0),G.emitChange({target:"updateIndexProgress",indexCount:P.length,total:n})}(e.sleBatch,e.viewIdsBatch,e.total);break;case"MAIL_UPDATE_QUERY_RESULTS":{const{queryResults:t,folder:n,filterOptions:s,threadPrefix:i,attachments:o,sentDate:a,updateScrollPosition:r}=e;!function(e,t,n,s,i,o,a){if(E=s,T=e,M=i,_=o,t){const e=G.getByFolder(t.accountId,t.path);e&&(e.filterValue={...e.filterValue,...n},Z=p.Z.getViewIntersections(e))}W(),G.emitChange({target:"listEntries",updateScrollPosition:a})}(t,n,s,i,o,a,r);break}case"MAIL_CLEAR_SEARCH":M=void 0,_=void 0,H();break;case"MAIL_CLEAR_QUERY":H();break;case"MAIL_INDEX_UPDATE":V(e.updates);break;case"MAIL_SORT_LIST_ENTRIES":!function(e){e&&P.forEach(S.o);const t=G.getListEntryComparator();D.sort(t),W(),G.emitChange({target:"listEntries",updateSelection:!0})}(e.wasThreads);break;case"MAIL_FILTERS_CHANGED":{const{filterIds:t}=e;!function(e){const t=o.Z.getSelectedFolder();if(t){const{accountId:n,path:s}=t;if(n!==b.tQ){const t=G.getByFolder(n,s);t&&e.includes(t.id)&&(Z=p.Z.getViewIntersections(t),W(),G.emitChange({target:"listEntries",updateSelection:!0}))}}G.emitChange({target:"filters",filterIds:e,updateSelection:!0,updateScrollPosition:!0})}(t);break}case"MAILING_LIST_GROUP_CHANGED":G.emitChange({target:"mailingLists"});break;case"MAIL_UPDATE_COUNTERS":{const{countedFolders:t,deltaValues:n}=e;F(t,n),G.emitChange({target:"counters"});break}case"MAIL_INIT_MESSAGES":e.folderIntersections?(t=e.folderIntersections,T=void 0,E=void 0,M=void 0,_=void 0,Z=t,W(),G.emitChange({target:"listEntries",updateSelection:!0})):function(){N=[],T=void 0,Z=void 0,E=void 0,M=void 0,_=void 0;const e=a.Z.get(k.kMailAccounts);O=!!e&&e.length>0,G.emitChange({target:"listEntries",isLoading:O})}();break;case"MAIL_UPDATE_THREAD_KEYS":{const{updates:t}=e;U(t);break}case"MAIL_SELECT_THREAD":const{threadPrefix:n}=e;H(),function(e){E=e,W(),G.emitChange({target:"listEntries",updateSelection:!0,updateScrollPosition:!0})}(n);break;case"MAIL_GOTO_UNREAD":G.emitChange({target:"gotoUnread"});break;case"MAIL_GOTO_NEXT_UNREAD":G.emitChange({target:"gotoNextUnread"});break;case"MAIL_GOTO_PREVIOUS_UNREAD":G.emitChange({target:"gotoPreviousUnread"});break;case"MAIL_STOP":N=[],T=void 0,P=[],D=[],x={},O=!1,Z=void 0,E=void 0,L=!1,M=void 0,_=void 0,G.emitChange({target:"counters"}),G.emitChange({target:"listEntries"})}var t}}const G=new z(r.Z),$=G},54162:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var s=n(43630),i=n(65398),o=n(33638),a=n(16920),r=n(10671),l=n(26036),d=n(5863),c=n(65741);class h extends i.Z{_selectionHistory=[];_historyIndex=-1;_optionsHistory=[];clear(){this._selectedFolder=void 0,this._selectionHistory=[],this._historyIndex=-1,this._optionsHistory=[],this.emitChange("clear")}getSelectedFolder(){return this._selectedFolder}getSelectionHistory(){return this._selectionHistory}getHistoryIndex(){return this._historyIndex}getOptions(){return this._optionsHistory[this._historyIndex]||{}}changeQuery(e){const t=this._optionsHistory[this._historyIndex];this._optionsHistory[this._historyIndex]={...t,query:e}}changeQueryAddition(e){const t=this._optionsHistory[this._historyIndex];this._optionsHistory[this._historyIndex]={...t,queryAddition:e}}getQuery(){return this._optionsHistory[this._historyIndex]?.query||""}clearQuery(){this._optionsHistory[this._historyIndex]&&delete this._optionsHistory[this._historyIndex].query}clearSearchOptions(){this._optionsHistory[this._historyIndex]&&(delete this._optionsHistory[this._historyIndex].query,delete this._optionsHistory[this._historyIndex].queryOptions,delete this._optionsHistory[this._historyIndex].queryFolder,delete this._optionsHistory[this._historyIndex].queryAddition,delete this._optionsHistory[this._historyIndex].attachments,delete this._optionsHistory[this._historyIndex].sentDate,this.emitChange("selectFolder"))}toggleMailSearchOptions(){this.emitChange("toggleShowMailSearchOptions")}setOptions(e){this._optionsHistory[this._historyIndex]={...e},this.emitChange("setOptions")}getSelectedThreadPrefix(){return this.getOptions().threadPrefix}getOptionsFromHistory(e){return this._optionsHistory[e]}getFolderFromHistory(e){return this._selectionHistory[e]}isFolderAnEditMailFolder(){const e=this.getSelectedFolder(),t=e&&r.Z.getFolderType(e.accountId,e.path);return[d.kY,d.fZ,d.Nz].includes(t)}isTrashFolderSelected(){if(!this._selectedFolder)return!1;const{accountId:e,path:t,type:n=""}=this._selectedFolder;return n===d.uT||e===d.of&&t===d.cm}isSentFolderSelected(){if(!this._selectedFolder)return!1;const{accountId:e,path:t,type:n=""}=this._selectedFolder;return n===d.Nz||e===d.of&&t===d.N1}canGoBack(){return this.getSelectionHistory().length>1&&this.getHistoryIndex()>0}canGoForward(){const e=this.getSelectionHistory();return e.length>1&&this.getHistoryIndex()<e.length-1}getGoToMenuItems=(e,t)=>[{handler:()=>s.Z.goToNextUnread(e),..."list"===t?(0,l.Z)("command","Next Unread"):(0,l.Z)("Go to Next Unread")},{handler:()=>s.Z.goToPreviousUnread(e),..."list"===t?(0,l.Z)("command","Previous Unread"):(0,l.Z)("Go to Previous Unread")},{handler:()=>s.Z.markAsReadAndGoToNextUnread(e),...(0,l.Z)("Mark Read and Go to Next Unread")}];dispatchAction(e){switch(e.actionType){case"MAIL_SELECT_FOLDER":this._addToHistory(e.folder,e.options),this.emitChange("selectFolder");break;case"MAIL_FOLDER_SELECT_HISTORY_INDEX":const{historyIndex:t}=e;void 0!==t&&(this._selectFromHistory(t),this.emitChange("selectFolder"));break;case"MAIL_SEARCH_SET_OPTIONS":this.setOptions(e.options);break;case"MAIL_STOP":this.clear();break;case"MAIL_QUERY_CHANGE":this.changeQuery(e.query);break;case"MAIL_CLEAR_QUERY":this.clearQuery();break;case"MAIL_CLEAR_SEARCH":this.clearSearchOptions();break;case"SHOW_MAIL_SEARCH_OPTION":this.toggleMailSearchOptions()}}_storeSelectedFolder(){a.Z.set({FOLDER_SELECTION:this._selectedFolder},(e=>{e&&console.error("Failed to store selected folder",this._selectedFolder,e)}))}_selectFromHistory(e){e>=0&&e<this._selectionHistory.length&&(this._historyIndex=e,this._selectedFolder=this._selectionHistory[this._historyIndex],this._storeSelectedFolder())}_addToHistory(e,t){if(this._historyIndex>-1){const e=this._historyIndex+1;this._selectionHistory=this._selectionHistory.slice(0,e),this._optionsHistory=this._optionsHistory.slice(0,e)}var n,s;((n=this._selectionHistory[this._selectionHistory.length-1])===(s=e)||n&&s&&n.accountId===s.accountId&&n.path===s.path)&&(0,c.Z)(this._optionsHistory[this._optionsHistory.length-1],t)||(this._historyIndex=this._selectionHistory.length,this._selectionHistory.push(e),this._optionsHistory.push(t)),this._selectedFolder=e,this._storeSelectedFolder()}}const p=new h(o.Z)},7168:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var s=n(24602),i=n(35369);class o extends s.Z{getInitialState(){return new i.D5}reduce(e,t){switch(t.actionType){case"PAGE_SET_MEDIASTATE":const{tabId:n,mediastate:s}=t;return function(e,t,n){const s=e.get(n);if(s){const i=s.intersect(t).union(t);return e.set(n,i)}return t.length>0?e.set(n,(0,i.l4)(t)):e}(e,s,n);case"PAGE_CLOSE":return function(e,t){let n=e;return t.forEach((e=>{n.has(e.id)&&(n=n.remove(e.id))})),n}(e,t.pages);default:return e}}hasMediaState(e,t){const n=this.getState().get(e);return!!n&&n.has(t)}}const a=new o},62882:(e,t,n)=>{"use strict";n.d(t,{R0:()=>d,ZP:()=>T,d0:()=>r,mS:()=>l});var s=n(65398),i=n(33638),o=n(92292),a=n(89555);const r="vivaldi/x-notes",l=500,d="1",c={children:[],content:"",dateAdded:0,id:d,index:0,parentId:"0",title:"Notes",type:"folder"};let h=c,p={id:-1},u=[];class g extends s.Z{_resolveReady=a.Z;ready=(()=>new Promise((e=>{this._resolveReady=e})))();getRootNode(){return h}getLastTopNode(){const e=this.getRootNode(),t=e&&e.children?e.children:[];if(t.length>1)return t[t.length-2]}hasNotes(){const e=this.getRootNode();if(e&&e.children){if(e.children.length>1)return!0;const t=e.children[0];if(t&&"trash"===t.type)return Boolean(t.children&&t.children.length>0)}return!1}isFolder(e){return Boolean(e.children)&&"note"!==e.type}isSeparator(e){return"separator"===e.type}isAttachment(e){return"attachment"===e.type}isNodeEmpty(e){const t=A.getNodeById(e);return Boolean(t&&!t.title&&!t.content&&(!t.children||0===t.children.length))}hasChildren(e){return Boolean(e.children&&e.children.length>0)}getNodeById(e){const t=function(n){if(n)for(let s=0;s<n.length;s++){const i=n[s];if(i.id===e)return i;if(i.children){const e=t(i.children);if(e)return e}}};return t(h.children)}getDragData(e,t){const n=t.map((e=>A.getNodeById(e))).filter(Boolean);switch(e){case"text/plain":case"vivaldi/x-title":{const e=[];return n.forEach((t=>{e.push(A.isFolder(t)?t.title:t.content)})),e.join("\r\n")}case"text/html":{const e=n&&1===n.length?n[0]:void 0;return e&&e.url&&e.title?"<a href="+e.url+">"+e.title+"</a>":""}case"text/uri-list":case"vivaldi/x-uri-list":return n.filter((e=>!!e.url)).join("\r\n");default:return""}}getFilteredTree(e,t){const n=function(e,t,s,i,o){if(!e)return!1;let a=!1;return e.forEach((e=>{let r=!1;if(e.children&&"note"!==e.type){const l={...e,children:[]};n(e.children,l.children,s,i,o)&&(t.push(l),a=!0,r=!0)}if(!r&&"separator"!==e.type&&A._matchNode(e,i,o)){const n={...e};t.push(n),e.children&&"note"!==e.type&&s.push(e.id),a=!0}})),a},s=this.getRootNode().children,i=[],o=[];return n(s,i,o,e,t),{nodes:i,collapsed:o}}getFilteredFlat(e,t){const n=(e,t,s,i)=>{e&&e.forEach((e=>{!i.inTrash&&"trash"===e.type||"attachment"===e.type||"separator"===e.type||(A._matchNode(e,s,i)&&(e.children&&"note"!==e.type?t.push({...e,children:[]}):t.push({...e})),e.children&&"note"!==e.type&&n(e.children,t,s,i))}))},s=this.getRootNode().children,i=[];return n(s,i,e.toLowerCase(),t),i}_matchNode(e,t,n){let s=!1;const i=t.toLowerCase().split(" "),o=e.title?e.title.toLowerCase():"",a=e.content?e.content.toLowerCase():"",r=e.url?e.url.toLowerCase():"";return o.length&&(s=i.every((e=>o.includes(e)))),!s&&a&&!1!==n.content&&(s=i.every((e=>a.includes(e)))),!s&&r&&!1!==n.url&&(s=i.every((e=>r.includes(e)))),s}validateForDrag(e){return e.filter((e=>e!==p.id))}validateForDeletion(e){return e.filter((e=>e!==p.id))}validateForEdit(e){return e!==p.id}getTitle(e){const t=A.getNodeById(e);return t&&(t.title||t.content)||""}getCutIds(){return u}init=e=>{const t={...e[0],children:e[0].children??[]};h=e[0]?t:c,p=y(h)||{id:-1},A.emitChange({reason:"init",id:""}),this._resolveReady()};dispatchAction(e){switch(e.actionType){case"NOTES_INIT":this.init(e.notes);break;case"NOTES_ADD_ITEM":C(e.item,"added");break;case"NOTES_CHANGE_ITEM":!function(e,t){const n=h.children;if(h!==c&&n){!0===I(h,e,t)&&(h.children=[...n],A.emitChange({reason:"changed",id:e}))}}(e.id,e.changes);break;case"NOTES_MOVE_ITEM":!function(e,t,n){if(h!==c&&h.children){const s=A.getNodeById(e);void 0!==s&&(w(e,!0),s.parentId=t,s.index=n,C(s,"moved"))}}(e.id,e.targetFolder,e.targetIndex);break;case"NOTES_REMOVE_ITEM":w(e.id,!1);break;case"NOTES_SET_CUT_IDS":v(e.ids);break;case"WINDOW_READY":u.length>0&&f(!0)}}}function m(e){"Escape"===e.key&&v([])}function v(e){u=e,f(e.length>0),A.emitChange({reason:"cutids",id:""})}function f(e){e?o.Z.extension.getViews().forEach((e=>{e.addEventListener("keydown",m,!0)})):o.Z.extension.getViews().forEach((e=>e.removeEventListener("keydown",m,!0)))}function y(e){if(e.children)for(let t=0;t<e.children.length;t++){const n=e.children[t];if("trash"===n.type)return n;if(n.children){const e=y(n);if(void 0!==e)return e}}}function C(e,t){const n=h.children;if(h!==c&&n){!0===S(h,e)&&(h.children=[...n],A.emitChange({reason:t,id:e.id}))}}function w(e,t){const n=h.children;if(h!==c&&n){!0===k(h,e)&&(h.children=[...n],t||A.emitChange({reason:"removed",id:e}))}}function b(e){if(e.children)for(let t=0;t<e.children.length;t++){e.children[t].index=t}}function S(e,t){if(e.id===t.parentId)return e.children&&e.children.splice(t.index||0,0,t),b(e),!0;if(e.children)for(let n=0;n<e.children.length;n++){const s=e.children[n],i=s.children;if(i){if(S(s,t))return s.children=[...i],!0}}return!1}function I(e,t,n){if(!e.children)return!1;for(let s=0;s<e.children.length;s++){const i=e.children[s];if(i.id===t&&(i.title!==n.title||void 0!==n.content&&i.content!==n.content||void 0!==n.url&&i.url!==n.url)){const t={...e.children[s],...n};return e.children.splice(s,1,t),!0}if(i.children){const e=i.children;if(!0===I(i,t,n))return i.children=[...e],!0}}return!1}function k(e,t){if(!e.children)return!1;for(let n=0;n<e.children.length;n++){const s=e.children[n];if(s.id===t)return e.children.splice(n,1),b(e),!0;if(s.children){const e=s.children;if(!0===k(s,t))return s.children=[...e],!0}}return!1}const A=new g(i.Z),T=A},17673:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var s=n(24602);function i(e){return t=>t.id!==e}function o(e,t){return e.when-t.when}class a extends s.Z{getInitialState(){return{notifications:[],activeNotifications:[]}}reduce(e,t){switch(t.actionType){case"NOTIFICATIONS_INIT":return{...e,notifications:t.notifications};case"MAIN_SHOW_CALENDAR_ALARM":return{...e,activeNotifications:e.activeNotifications.filter(i(t.options.reminder.id)).concat(t.options.reminder).sort(o)};case"MAIN_HIDE_CALENDAR_ALARM":return{...e,activeNotifications:e.activeNotifications.filter(i(t.notificationId))}}return e}}const r=new a},96951:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>ne});var s=n(7065),i=n(29087),o=n(24602),a=n(37330),r=n(19486),l=n(15489),d=n(92292),c=n(42568),h=n.n(c),p=n(7064),u=n(1407),g=n(35369),m=n(53576),v=n(69046),f=n(16152),y=n(42578),C=n(36436),w=n(44850),b=n(89175),S=n(14789);function I(e){const t=new Map;return t.set(void 0,[]),Object.freeze({windowId:e,list:(0,g.aV)(),history:[],minimizeHistory:null,lastHistory:null,isSelecting:!1,selection:(0,g.l4)(),selectionAnchor:null,selectionLead:null,cycleByHistory:t,cycledByHistoryPageId:null})}class k extends o.Z{getInitialState(){return new Map}findPageToActivateAfterClosingPage(e,t){return function(e,t){let n;if(i.Z.get(b.kTabsActivationPreferRelated)&&(n=function(e){const t=(0,v.cm)(e),n=te.getPages(e.windowId);let s;if(e.openerTabId){const o=i.Z.get(b.kTabsActivationOnClose);if("activation_order"===o){const i=n.filter((n=>n.id!==e.id&&(n.openerTabId===e.openerTabId||n.id===e.openerTabId)&&(0,v.cm)(n)===t)),o=T(e.windowId).history.filter((t=>i.some((e=>e.id===t))&&t!==e.id)).pop();s=i.find((e=>e.id===o))}else{const i=()=>n.takeUntil((t=>t.id===e.id)).filter((n=>(n.openerTabId===e.openerTabId||n.id===e.openerTabId)&&(0,v.cm)(n)===t)).reverse(),a=()=>n.slice(e.index+1).filter((n=>(n.openerTabId===e.openerTabId||n.id===e.openerTabId)&&(0,v.cm)(n)===t));s="right"===o?a().first()||i().first():i().first()||a().first()}}s||(s=n.skipUntil((t=>t.id===e.id)).skip(1).find((n=>n.openerTabId===e.id&&(0,v.cm)(n)===t)));return s}(e),n))return n;const s=i.Z.get(b.kTabsActivationOnClose),o=(0,v.cm)(e),a=te.getPages(t,{workspaceId:o});switch(s){case"left":const t=a.findIndex((t=>t.index===e.index))-1;n=t<0?a.find((t=>t.id!==e.id)):a.get(t);break;case"right":n=a.find((t=>t.index===e.index+1)),n||(n=a.reverse().find((t=>t.id!==e.id)));break;case"activation_order":n=void 0;break;default:0,n=void 0}if(!n){const s=T(t).history.filter((t=>a.some((e=>e.id===t))&&t!==e.id)).pop();n=a.find((e=>e.id===s))}n===e&&(n=null);return n}(e,t)}getPages(e,t){const n=T(e).list;return t?n.filter((e=>(0,v.cm)(e)===t.workspaceId)):n}getWorkspacePages(e){if(!e)return(0,g.aV)();const t=[];for(const[,n]of this.getState())t.push(n.list.filter((t=>(0,v.cm)(t)===e)));return(0,g.aV)(t).flatten()}getPinnedCount(e){return T(e).list.count((e=>e.pinned))}findPageInAllWindows(e){let t;const n=n=>{!t&&e(n)&&(t=n)};return this.getState().forEach((e=>{e.list.forEach(n)})),t}filterPagesInAllWindows(e){const t=[],n=n=>{e(n)&&t.push(n)};return this.getState().forEach((e=>{e.list.forEach(n)})),(0,g.aV)(t)}getTabs(e,t){const n=T(e);return E(n.list,n.history,t)}getWorkspaceTabsInWindow(e,t,n){const s=T(e),i=s.list.filter((e=>(0,v.cm)(e)===t));return E(i,s.history,n)}getWorkspaceTabs(e,t){for(const n of l.ZP.getIds("normal")){const s=T(n),i=s.list.filter((t=>(0,v.cm)(t)===e));if(i.size>0)return E(i,s.history,t)}return(0,g.aV)()}getTabsForPages(e,t){const n=e.size;if(0===n)return(0,g.aV)();const s=e.first().windowId;for(let t=1;t<n;++t)if(e.get(t)?.windowId!==s)throw new Error("Getting tabs for pages from different windows is not supported");const i=T(s);return E(e,i.history,t)}getWorkspaceTabsForPages(e,t,n){const s=e.size;if(0===s)return(0,g.aV)();const i=e.first().windowId;for(let t=1;t<s;++t)if(e.get(t)?.windowId!==i)throw new Error("Getting tabs for pages from different windows is not supported");const o=T(i),a=e.filter((e=>(0,v.cm)(e)===t));return E(a,o.history,n)}getPageById(e){return this.findPageInAllWindows((t=>t.id===e))}getPagesByUrl(e,t){return this.getPages(e).filter((e=>e.url===t))}getPageInWindow(e,t){return T(e).list.find((e=>e.id===t))}getPageByReloadId(e){return this.findPageInAllWindows((t=>t.vivExtData.ext_id===e))}getPageHistory(e){return T(e).history}unsafeGetActivePage(e){return _(T(e).list)??(0,v.SJ)()}getActivePage(e){return _(T(e).list)}getLastVisited(e){const t=T(e);return t.history[t.history.length-2]}isActivePage(e,t){return this.getActivePage(e)?.id===t}isUnread(e){return e.unread&&!e.discarded}getGroup(e,t){const n=T(t);return e?M(n.list,e):(0,g.aV)()}isDisplayingImage(e){const t=this.getPageById(e);return!!t&&["image/avif","image/jpeg","image/pjpeg","image/jpg","image/webp","image/png","image/gif","image/bmp","image/vnd.microsoft.icon","image/x-icon","image/x-xbitmap","image/x-png"].includes(t.mimeType)}isGroup(e,t){if(!e)return!1;if("off"===i.Z.get(b.kTabsStackingMode))return!1;const n=T(t);return!!e&&N(n.list,e)>1}isPinnedGroup(e,t){return this.isGroup(e,t)&&this.getGroup(e,t).some((e=>e.pinned))}getGroupHighlightId(e,t){const n=T(t);return P(n.list,n.history,e)}getTiles(e,t){const n=T(t);return D(n.list,e)}isSelecting(e){return T(e).isSelecting}getSelection(e){return T(e).selection}getSelectedPages(e){const t=l.ZP.getActiveWorkspace(e),n=T(e),s=n.selection.reduce(((e,s)=>{const i=n.list.find((e=>e.id===s));return i&&(0,v.cm)(i)===t?[...e,i]:e}),[]);return(0,g.aV)(s).sortBy((e=>e.index))}getReloadingPages(){return this.filterPagesInAllWindows((e=>Number(e.vivExtData.interval)>0))}getDiscardablePages(e){const t=T(e);return this._getDiscardablePages(e,t.list)}getNewGroupId(){return crypto.randomUUID()}getUnreadCount(e){let t=0;return T(e).list.forEach((e=>{this.isUnread(e)&&t++})),t}getHistoryManagerState(e){return this.getPageById(e)?.vivExtData.historyManagerState}canClosePage(e){if(e.pinned&&"on"!==i.Z.get(b.kTabsClosePinned))return!1;return!(i.Z.get(b.kTabsNeverCloseLast)&&(0,w.Rf)(e.url)&&this.isLastPage(e))}isLastPage(e){const t=(0,v.cm)(e);return this.getPages(e.windowId,{workspaceId:t}).size<2}getStepInfo(e,t,n,s){const i=this.getTabs(s,!0),o=(0,v.av)(e);if(o&&!n){const n=i.flatMap(((e,t)=>(0,v.av)(e.page)===o?[t]:[])),s=n.get(0)??0,a=n.get(-1)??0;let r;return r=t?e.index+1>a?a:e.index+1:e.index-1<s?s:e.index-1,{pages:g.aV.of(e),index:r}}{const a=o&&n?this.getGroup(o,s):g.aV.of(e);if(t){const t=o&&n?a.last().index:e.index;if(t===i.last().page.index)return;const r=i.get(t+1),l=r?(0,v.av)(r.page):null;let d;if(l){d=this.getGroup(l,s).last().index}else d=t+1;return{pages:a,index:d}}{const t=o&&n?a.first().index:e.index;if(t===(i.find((e=>!e?.page.pinned))?.page.index||0))return;const r=i.get(t-1)?.page,l=r?(0,v.av)(r):null;let d;if(l){d=this.getGroup(l,s).first().index}else d=t-1;return{pages:a,index:d}}}}isActiveInternal(e){const t=this.getActivePage(e)?.url??"";return w.jk.isInternalUrl(t)}isActiveExternal(e){const t=this.getActivePage(e)?.url??"";return!w.jk.isInternalUrl(t)}getStartpage(e){const t=l.ZP.isIncognito(e),n=0===te.getPages(e).size,s=t&&i.Z.get(b.kIncognitoShowIntro)&&n?w.jk.internals["private-intro"]:`${w.jk.internals.startpage}?section=Speed-dials`,o=r.Z.getWindowBackgroundColor(a.Z.getBaseStylesByWindowId(e,["colorBg"]));return o&&!t?s+"&background-color="+o.toString():s}getDefaultStartpage(e){if(l.ZP.isGuest())return w.jk.internals["guest-intro"];let t=i.Z.get(b.kTabsNewPageLink);if(t===u.Fp.EXTENSION){const e=i.Z.get(b.kExtensionURLOverrides).newtab?.some((e=>e.active));e||(t=u.Fp.STARTPAGE)}switch(t){case u.Fp.EXTENSION:return u.P1;case u.Fp.BLANKPAGE:return w.jk.internals.blankpage;case u.Fp.HOMEPAGE:const t=i.Z.get(b.kHomepage);return t===u.QG?this.getStartpage(e):t;case u.Fp.CUSTOM:const n=i.Z.get(b.kTabsNewPageCustomUrl);return(0,C.C3)(n)||(0,C.xl)(n)?w.jk.getUrl(n):w.jk.internals.blankpage;case u.Fp.STARTPAGE:default:return this.getStartpage(e)}}canUseForMenu(e,t){const n=T(e).list;return n.size===t.size&&!t.some(((e,t)=>{const s=n.get(t);return e!==s&&(e.title!==s?.title||e.url!==s?.url)}))}getCyclePageByOrder(e,t,n){const s=te.getPages(e,{workspaceId:t}),i=((s.findIndex((e=>e.active))+(n?-1:1))%s.size+s.size)%s.size;return s.get(i)?.id??-1}reduce(e,t){switch(t.actionType){case"PAGE_CLEAR":return te.getInitialState();case"CHROME_TABS_INIT":return Z(A,e,t.windowId,t.tabs,t.historystack);case"WINDOW_CLOSED":if(e.has(t.windowId)){const n=new Map(e);return n.delete(t.windowId),n}return e;case"CHROME_TABS_CREATE":return Z(B,e,t.page.windowId,t.page,t.tabActivationHistory,t.deactivatePageId,t.openerMissingGroupId);case"NAVIGATION_SET_STATE":return Z(L,e,t.windowId,t.pageId,t.navigationState);case"CHROME_TABS_REMOVED":return Z(F,e,t.removeInfo.windowId,t.tabId);case"CHROME_TABS_REPLACED":{const n=te.getPageById(t.removedTabId);return n?Z(O,e,n.windowId,t.removedTabId,"id",t.addedTabId):e}case"CHROME_TABS_UPDATED":return Z(V,e,t.windowId,t.tabId,t.changeInfo);case"CHROME_TABS_MOVED":return Z(W,e,t.windowId,t.tabId,t.index);case"PAGE_OPEN_URL":return Z(G,e,t.windowId,t.pageId,t.url,t.postParams,t.headers,t.transition,t.fromUrlField,t.bookmarkId);case"PAGE_OPEN":return Z(H,e,t.windowId,t.pageId,t.activatedByChrome??!1,t.selectGroup);case"PAGE_MINIMIZE":return Z(z,e,t.windowId,t.workspaceId);case"PAGE_SET_IS_INSPECTED":return Z(O,e,t.windowId,t.pageId,"isInspected",t.inspected);case"PAGE_TABSTACK_CREATE":return Z(j,e,t.pages.first().windowId);case"PAGE_SET_TITLE":return Z(O,e,t.windowId,t.pageId,"title",t.title);case"PAGE_SET_IMAGE_INSPECTOR":return Z(O,e,t.windowId,t.pageId,"showImageInspector",t.showImageInspector);case"READERMODE":return Z(O,e,t.windowId,t.pageId,"supportsReaderMode",t.supportsReaderMode);case"VIVALDI_TABS_UPDATED":return Z(U,e,t.windowId,t.pageId,t.tabInfo);case"PAGE_SELECTION_SET":return Z(Q,e,t.page.windowId,t.page,t.multiSelect,t.addGroup,t.excludeActive);case"PAGE_SELECTION_TOGGLE_RELATED":return Z(Y,e,t.page.windowId,t.page);case"PAGE_SELECTION_EXPAND_PREVIOUS":return Z(X,e,t.page.windowId,t.page,"previous");case"PAGE_SELECTION_EXPAND_NEXT":return Z(X,e,t.page.windowId,t.page,"next");case"PAGE_SELECTION_CLEAR":return Z(j,e,t.windowId);case"PAGE_CYCLE_HISTORY_MODIFIER_UP":return Z(J,e,t.windowId,t.workspaceId);case"PAGE_SET_CYCLE_BY_HISTORY":return Z(q,e,t.windowId,t.goBack,t.activateEventModifierUp,t.workspaceId);case"WINDOW_SET_ACTIVE_WORKSPACE":return Z(ee,e,t.windowId,t.id);default:return e}}_getDiscardablePages(e,t){return t.filter((t=>!t.discarded&&!t.active&&!t.isInspected&&t.url!==this.getDefaultStartpage(e)))}}function A(e,t,n=[]){const i=(0,g.aV)(t.map((e=>(e.favIconUrl||(e.favIconUrl=function(e){if(!e.favIconUrl||e.favIconUrl.startsWith("file://"))return"chrome://favicon/size/16@2x/"+(e.url||"");e.favIconUrl&&w.jk.isExtensionProtocol(e.favIconUrl)&&w.jk.isOurExtension(e.favIconUrl);return e.favIconUrl}(e)),s.ZP.tabToPage(e)))));x(e.windowId),e.list=i,e.history=function(e,t){const n=[];t.forEach((t=>{const s=e.find((e=>e.vivExtData.ext_id===t));s&&n.push(s.id)})),e.forEach((e=>{n.includes(e.id)||n.unshift(e.id)}));const s=e.find((e=>e.active));s&&(0,S.AL)(n,s.id);return n}(i,n),j(e)}function T(e){return te.getState().get(e)??I(e)}function Z(e,t,n,s,i,o,a,r,l,d){if("number"!=typeof n)return t;const c=t.get(n)??I(n),h={...c};if(e(h,s,i,o,a,r,l,d),!function(e,t){let n=!1;for(const s of Object.keys(t)){const i=t[s];i!==e[s]&&(Array.isArray(i)&&Object.freeze(i),n=!0)}return!!n&&(Object.freeze(t),!0)}(c,h))return t;const p=new Map(t);return p.set(n,h),p}const E=h()(((e,t,n)=>n?e.map((e=>({type:"tab",id:e.id,page:e}))):e.groupBy((e=>(0,v.av)(e)||e.id)).map(((n,s,i)=>n.count()>=2?{type:"group",id:String(s),pages:n,page:e.find((n=>n.id===P(e,t,`${s}`)))}:{type:"tab",page:n.first(),id:n.first().id})).toList())),_=h()((e=>e.find((e=>e.active))));const M=h()((function(e,t){return t?e.filter((e=>(0,v.av)(e)===t)):(0,g.aV)()}),{maxSize:10}),N=h()(((e,t)=>e.count((e=>(0,v.av)(e)===t))),{maxSize:10}),P=h()(((e,t,n)=>{const s=M(e,n);for(let e=t.length-1;e>=0;e--)if(s.some((n=>n.id===t[e])))return t[e];return s.first()?.id}),{maxSize:10});const D=h()((function(e,t){return t?e.filter((e=>(0,v.jA)(e)===t)):(0,g.aV)()}),{maxSize:10});const x=(0,f.Z)((e=>d.Z.tabs.query({windowId:e},(e=>e.forEach((e=>{const t=te.getPageById(e.id?e.id:-1);if(t){let n;try{n=JSON.parse(e.vivExtData||"{}")}catch(e){n={}}const s=(0,g.D5)(n);(0,g.is)(s,t.vivExtData)||d.Z.tabs.update(t.id,{vivExtData:JSON.stringify(n)},(()=>{d.Z.runtime.lastError}))}}))))),160);function O(e,t,n,s){const i=e.list.findIndex((e=>e.id===t));-1!==i&&(e.list=e.list.setIn([i,n],s))}function L(e,t,n){if("stop"!==n.trigger&&"abort"!==n.trigger)return;const s=e.list.findIndex((e=>e.id===t));if(-1===s)return;const i=e.list.get(s);if(!i||!i.target)return;const{target:o}=i;e.list=e.list.set(s,{...i,url:o.committedUrl,target:void 0})}function R(e,t){return e.index!==t?{...e,index:t}:e}function B(e,t,n,s,i){e.list=e.list.splice(t.index,0,t).map(((e,n)=>(e.id===s&&(e={...e,active:!1}),e.id===i&&(e={...e,vivExtData:{...e.vivExtData,group:t.vivExtData.group}}),R(e,n)))),e.history=n,j(e)}function F(e,t){e.list=e.list.filter((e=>e.id!==t)).map(R);const n=e.history.indexOf(t);if(-1!==n){const t=[...e.history];t.splice(n,1),e.history=t}j(e)}function V(e,t,n){e.list=s.ZP.updatePage(e.list,t,n)}function W(e,t,n){const s=e.list.find((e=>e.id===t));s&&(j(e),function(e,t,n){const s=e.list.findIndex((e=>e.id===t.id));n===s&&t.index===n||(e.list=e.list.delete(s).splice(n,0,t).map(R))}(e,s,n))}function U(e,t,n){n.hasOwnProperty("mimeType")&&O(e,t,"mimeType",n.mimeType)}function H(e,t,n=!1,s=!0){const i=e.list;if(function(e,t){const n=e.list.findIndex((e=>e.id===t));if(-1===n)return void console.warn("PageStore.activatePage: page to activate not found");const s=e.list.findIndex((e=>e.active));-1!==s&&s!==n&&(e.list=e.list.setIn([s,"active"],!1)),e.list=e.list.mergeIn([n],{unread:!1,active:!0})}(e,t),e.list===i)return;j(e,s),n||d.Z.tabs.update(t,{active:!0},(()=>{d.Z.runtime.lastError}));const o=[...e.history];(0,S.AL)(o,t),e.history=o,(0,m.y9)(e.windowId,e.history)}function z(e,t){let n=e.minimizeHistory?.get(t);n&&(0,g.is)(e.lastHistory,e.history)||(n=e.history.filter((n=>{const s=e.list.find((e=>e.id===n));return s&&(0,v.cm)(s)===t}))),n=(0,S.JA)(n,!0);const s=e.minimizeHistory??new Map;s.set(t,n),e.minimizeHistory=s,H(e,n[n.length-1]),e.lastHistory=e.history}function G(e,t,n,s,i="",o=p.Z.historyPrivate.TransitionType.LINK,a=!1,r){const l=e.list.findIndex((e=>e.id===t));if(-1===l)return;const d=e.list.get(l);if(!d)return;const c={committedUrl:d.url,postParams:s,headers:i,transition:o,fromUrlField:a};r&&(d.context.bookmarkThumbnailQueue={bookmarkId:r,url:n}),e.list=e.list.set(l,{...d,target:c,url:n,mimeType:"text/html"})}function $(e,t,n){if(n){const n=e.windowId,s=(0,v.av)(t);let i=(0,g.aV)();te.isGroup(s,n)?i=te.getGroup(s,n):e.selection=e.selection.add(t.id);const o=te.getActivePage(e.windowId),a=o&&(0,v.av)(o);if(a!==s&&te.isGroup(a,n)&&(i=i.concat(te.getGroup(a,n))),i.size>1)return void(e.selection=e.selection.union(i.map((e=>e.id))))}else e.selection=e.selection.add(t.id)}function K(e,t){const n=e.toList().filter((e=>e!==t.id)).map((e=>{const t=te.getPageById(e);return t?t.index:-1}));if(!n.isEmpty()){const e=n.insert(0,t.index).toArray();d.Z.tabs.highlight({tabs:e,windowId:t.windowId})}}function j(e,t=!0){e.isSelecting=!1;const n=_(e.list);e.selectionAnchor=n??null,e.selectionLead=n??null,0!==e.selection.size&&(e.selection=(0,g.l4)());i.Z.get(b.kTabsSelectionIncludeActive)&&n&&$(e,n,t)}function Y(e,t){e.isSelecting||j(e),e.selectionLead=t;if(te.isGroup((0,v.av)(t),e.windowId)){$(e,t,!0)}else{const n=te.getTabs(e.windowId),[,s]=(0,y.d)(t,n);e.selection=s.reduce(((e,t)=>e.add(t.id)),e.selection),e.isSelecting=!0}}function X(e,t,n){const s=t=>{const s="next"===n?t.index+1:t.index-1;return e.list.get(s)},o=e.windowId,a=i.Z.get(b.kTabsStackingMode),r=(0,v.av)(t),l=te.isGroup(r,o),d=l&&"accordion"===a&&i.Z.get(b.kTabsStackingOpenAccordions).includes(r);if(e.isSelecting){const t=e.selection.map((t=>{const n=e.list.find((e=>e.id===t));return n&&"number"==typeof n.index?n.index:-1})).filter((e=>e>-1)).sort(),i="next"===n,l=i?t.last():t.first(),c=i?l+1:l-1,h=e.selectionLead,p=te.getActivePage(o);if(h&&p){const n=e.selection.size>1&&!(p.index<=h.index&&h.index<=c&&i||p.index>=h.index&&h.index>=c&&!i);if(!n&&(c<0||c>e.list.size))return;if(n){const n=e.list.get(i?t.first():t.last());if(!n)return;if(n!==p){const t=!(("substrip"===a||d)&&r===(0,v.av)(n));Q(e,n,!1,t)}else{const n=e.list.get(i?t.last():t.first()),o=n&&s(n);if(o){const t=!(("substrip"===a||d)&&r===(0,v.av)(o));Q(e,o,!1,t)}}}else{const t=e.list.get(c);if(t){const n=r!==(0,v.av)(t)||"substrip"!==a&&"accordion"!==a;Q(e,t,!1,n)}}}}else if(l&&!d&&"substrip"!==a&&i.Z.get(b.kTabsSelectionIncludeActive))Q(e,t,!1,!0);else{const n=s(t);if(n){const t=!l||r!==(0,v.av)(n)&&("substrip"===a||"accordion"===a);return void Q(e,n,!1,t)}}}function Q(e,t,n,s,o=!1){e.isSelecting||(o?(e.selectionAnchor=te.unsafeGetActivePage(e.windowId),e.selectionLead=e.selectionAnchor,e.selection=(0,g.l4)()):j(e,s)),n?function(e,t,n){const s=e.selectionAnchor,o=e.selectionLead;if(!s||!o)return;const a=o.index,r=s.index,l=e.windowId,d=e.list.filter((e=>e.index>=Math.min(r,a)&&e.index<=Math.max(r,a))).flatMap((e=>{const t=(0,v.av)(e);return te.isGroup(t,l)?te.getGroup(t,l):[e]})).map((e=>e.id)),c=t.index,h=!i.Z.get(b.kTabsSelectionIncludeActive),p=e.list.filter((e=>e.index>=Math.min(r,c)&&e.index<=Math.max(r,c)&&!(h&&e.active))).flatMap((e=>{const t=(0,v.av)(e);return n&&te.isGroup(t,l)?te.getGroup(t,l):[e]})).map((e=>e.id)),u=e.selection.subtract(d).union(p);e.selection=u,e.selectionLead=t,K(e.selection,te.unsafeGetActivePage(l)),e.isSelecting=!0}(e,t,s):function(e,t,n){e.selectionLead=t,e.isSelecting||(e.selectionAnchor=t);!e.isSelecting&&t.active||!e.selection.contains(t.id)?$(e,t,n):function(e,t,n){if(n&&te.isGroup((0,v.av)(t),e.windowId)){const n=te.getGroup((0,v.av)(t),e.windowId).map((e=>e.id));e.selection=e.selection.subtract(n)}else e.selection=e.selection.remove(t.id)}(e,t,n);K(e.selection,te.unsafeGetActivePage(e.windowId)),e.isSelecting=!0}(e,t,s)}function q(e,t,n,s){const i=e.history.filter((t=>{const n=e.list.find((e=>e.id===t));return n&&(0,v.cm)(n)===s}));let o;if(n){let n=e.cycleByHistory?.get(s);n?n=function(e,t){if(e===t)return t;const n=new Set(e),s=new Set;for(let e=0;e<t.length;++e)n.has(t[e])&&s.add(t[e]);if(s.size===n.size&&s.size===t.length)return t;for(const t of e)s.add(t);return Array.from(s)}(i,n):(n=i,e.cycledByHistoryPageId=n[n.length-1]),n=(0,S.JA)(n,!1===t),e.cycleByHistory||(e.cycleByHistory=new Map,e.cycleByHistory.set(void 0,[])),e.cycleByHistory?.set(s,n),o=n[n.length-1]}else{const n=i.length>0;do{e.history=(0,S.JA)(e.history,!1===t),o=e.history[e.history.length-1]}while(n&&!i.includes(o));(0,m.y9)(e.windowId,e.history)}H(e,o,!1,!0)}function J(e,t){const n=e.cycleByHistory?.get(t),s=e.cycledByHistoryPageId,i=n&&n[n.length-1];if(s&&i){const t=e.history.filter((e=>e!==s&&e!==i));t.push(s),s!==i&&t.push(i),e.history=t,(0,m.y9)(e.windowId,e.history)}e.cycleByHistory?.set(t,null),e.cycledByHistoryPageId=null}function ee(e,t){const n=e.list.filter((e=>(0,v.cm)(e)===t)).map((e=>e.id)),s=e.history.findLast((e=>n.includes(e)))??n.first();if(s)H(e,s,!1,!0);else{const n=te.getDefaultStartpage(e.windowId),s={url:n,windowId:e.windowId,index:0,active:!0,vivExtData:JSON.stringify({workspaceId:t})};d.Z.tabs.create(s).then((t=>{t.id&&G(e,t.id,n)}))}}const te=new k,ne=te},15285:(e,t,n)=>{"use strict";n.d(t,{Pv:()=>m,ZP:()=>P,fG:()=>v});var s=n(96951),i=n(34197),o=n(68247),a=n(29087),r=n(24602),l=n(16716),d=n(15489),c=n(34540),h=n(86461),p=n(16152),u=n(89175),g=n(93513);const m=35,v=10,f=["PanelDownloads","PanelWindow"],y=["PanelMail","PanelContacts","PanelFeeds"],C=["PanelCalendar","PanelTasks"],w=h.e3,b=(0,p.Z)(c.Z,500);function S(e){const{draft:t,winId:n,visible:s}=e,i=t.windowData.get(n);i&&(s?(i.barVisible=!0,i.contentVisible=!0,i.selectedPanel=i.selectedPanel||M.getFirstAvailablePanel(n)):(t.previousPanelBarVisible=i.barVisible,i.contentVisible=!1),t.changeReason="")}function I(e,t){const n=e.windowData.get(t);if(!n)return;const{contentVisible:s}=n;s?e.changeReason="setFocus":(n.barVisible=!0,n.contentVisible=!0,n.selectedPanel=n.selectedPanel||M.getFirstAvailablePanel(t),e.changeReason="")}function k(e){const{setFocus:t,selectId:n,panelId:s,draft:i,reason:o,winId:a}=e,r=i.windowData.get(a);if(!r)return;const{contentVisible:l,selectedPanel:d,expandedWidth:c}=r,h=r.transitionMap.get(s);l&&d===s&&h?.selectId===n||M.canRender({windowData:r,winId:r.winId,panelId:s})&&(r.transitionMap.set(s,{...h,setFocus:t,selectId:n,reason:o}),r.barVisible=!0,r.contentVisible=!0,r.expandedWidth=0===c?400:c,r.focusContent=t,r.selectedPanel=s,i.changeReason="display",N(i,a))}function A(e,t){const n=e.windowData.get(t);if(!n)return;const{contentVisible:s,lastFocused:i,expandedWidth:o,barVisible:a}=n;s?(i?.focus(),n.barVisible=!1,n.contentVisible=!1,n.lastFocused=null,n.expandedWidth=0===o?400:o):a?(n.barVisible=!1,n.selectedPanel=void 0):(n.barVisible=!0,n.selectedPanel&&E({draft:e,winId:t,panelId:n.selectedPanel})),n.contentVisible||(e.previousPanelBarVisible=n.barVisible??!1),e.changeReason=""}function T(e){const{draft:t,windowId:n,leavePage:s,enterPage:i}=e,o=s?.isMailPage,a=i?.isMailPage,r=t.windowData.get(n)?.selectedPanel;!o&&a&&"PanelFeeds"!==r&&"PanelContacts"!==r?function(e,t){const n=e.windowData.get(t);if(!n)return e;e.previousMailPanel={selectedPanel:n.selectedPanel??"PanelMail",barVisible:n.barVisible??!1,contentVisible:n.contentVisible??!1},k({draft:e,winId:t,setFocus:!1,panelId:"PanelMail",selectId:"",reason:""}),e.changeReason="layout"}(t,n):M.shouldRestorePrevPanelState({draft:t,winId:n,isEnterPageMail:a,isLeavePageMail:o})&&(!function(e,t){const n=e.previousMailPanel;n&&(n.selectedPanel&&k({draft:e,winId:t,setFocus:!1,panelId:n.selectedPanel,selectId:"",reason:""}),S({draft:e,winId:t,visible:n.contentVisible}),n.barVisible||(A(e,t),N(e,t)),e.changeReason="")}(t,n),t.changeReason="layout")}function Z(e){const{draft:t,winId:n,minimal:s}=e,i=t.windowData?.get(n);if(!i)return;const o=M.getIsBarVisible(n);(s?o:o!==i.visibilityBeforeMinimalUI)&&(A(t,n),t.changeReason=""),s&&(i.visibilityBeforeMinimalUI=o)}function E(e){const{draft:t,winId:n,panelId:s}=e,i=t.windowData?.get(n);if(!M.canRender({windowData:i,winId:n,panelId:s})||!i)return;const o=!i?.contentVisible,{contentVisible:a,selectedPanel:r,lastFocused:l}=i,d=!a;s===r?(d||l?.focus(),i.barVisible=!0,i.contentVisible=d,i.focusContent=d,i.lastFocused=d?document.activeElement:null):(i.barVisible=!0,i.contentVisible=!0,i.selectedPanel=s,i.lastFocused=d?document.activeElement:null,i.focusContent=!0),o||(t.previousPanelBarVisible=i?.barVisible??!1),t.changeReason=""}class _ extends r.Z{getInitialState(){return{windowData:new Map,webPanelList:[],regPanelList:[],webPanelMap:new Map,previousPanelBarVisible:!1,previousMailPanel:void 0,changeReason:""}}reduce(e,t){switch(t.actionType){case"PANEL_INIT_COMMON":return(0,g.Uy)(e,(e=>{!function(e,t){const{regPanels:n,webPanels:s,barVisible:i}=t,o=s.map((e=>({...e}))),a=new Map(o.map((e=>[e.id,!0])));e.regPanelList=n.map((e=>({...e}))),e.webPanelList=o,e.webPanelMap=a,e.previousPanelBarVisible=i,e.changeReason=""}(e,t.state)}));case"PANEL_ADDED":if(t.showContent&&i.Z.isWebPanel(t.panelId)){const n=(0,g.Uy)(e,(e=>{!function(e,t,n){e.windowData.get(t)&&(E({draft:e,winId:t,panelId:n}),e.changeReason="")}(e,t.winId,t.panelId)}));return N(n,t.winId),n}break;case"PANEL_REMOVED":{const n=(0,g.Uy)(e,(e=>{!function(e,t,n){e.windowData.forEach((s=>{if(s.selectedPanel===n){const o=i.Z.getPanelList().filter((e=>{M.canRender({winId:t,panelId:e})}));let a;if(o.length>1){const e=o.findIndex((e=>e===n));-1!==e&&(a=o[e+(e===o.length-1?-1:1)])}a?s.contentVisible?E({draft:e,winId:t,panelId:n}):s.selectedPanel=a:(s.selectedPanel=void 0,s.contentVisible=!1,e.previousPanelBarVisible=s.barVisible)}e.changeReason=""}))}(e,t.winId,t.panelId)}));return N(n,t.winId),n}case"PANEL_SET_CONTENT_VISIBLE":{const{winId:n,visible:s}=t,i=(0,g.Uy)(e,(e=>{S({draft:e,winId:n,visible:s})}));return N(i,n),i}case"PANEL_SET_FOCUS":return(0,g.Uy)(e,(e=>{I(e,t.winId)}));case"PANEL_TOGGLE_CURRENT":{const n=(0,g.Uy)(e,(e=>{!function(e,t){const n=e.windowData.get(t)?.selectedPanel||M.getFirstAvailablePanel(t);n&&(E({draft:e,winId:t,panelId:n}),e.changeReason="")}(e,t.winId)}));return N(n,t.winId),n}case"PANEL_TOGGLE_FLOATING":o.Z.toggle(u.kPanelsAsOverlayEnabled,!0,!1);break;case"PANEL_SET_MUTED":return(0,g.Uy)(e,(e=>{!function(e){const{draft:t,winId:n,panelId:s,muted:i}=e,o=t.windowData.get(n);o&&(o.mutedMap.set(s,i),t.changeReason="")}({draft:e,winId:t.winId,panelId:t.panelId,muted:t.muted})}));case"PANEL_SET_RESIZABLE":{const{panelId:n,resizable:s}=t,i=(0,g.Uy)(e,(e=>{!function(e){const{draft:t,panelId:n,resizable:s}=e;if(M.getIsWebPanel(n)){const e=t.webPanelList.findIndex((e=>e.id===n));if(-1!==e){const n=t.webPanelList[e];n.resizable=s,n.resizable||(n.width=-1),t.webPanelList[e]=n}}else{const e=t.regPanelList.findIndex((e=>e.id===n));if(-1!==e){const n=t.regPanelList[e];n.resizable=s,n.resizable||(n.width=-1),t.regPanelList[e]=n}}t.changeReason=""}({draft:e,panelId:n,resizable:s})}));return this.getIsWebPanel(n)?o.Z.set(u.kPanelsWebElements,i.webPanelList):o.Z.set(u.kPanelsElements,i.regPanelList),i}case"PANEL_SET_REG_PANELS":return function(e,t){let n=e.previousPanelBarVisible;const s=new Map(Array.from(e.windowData).map((([e,t])=>(t.selectedPanel&&!M.canRender({winId:e,windowData:t,panelId:t.selectedPanel})&&(t.selectedPanel=void 0,t.contentVisible=!1,n=t.barVisible),[e,t]))));return{...e,regPanelList:t,windowData:s,changeReason:"",previousPanelBarVisible:n}}(e,t.list);case"PANEL_SET_WEB_PANELS":return function(e,t){const n=new Map(t.map((e=>[e.id,!0])));let s=e.previousPanelBarVisible;const i=new Map(Array.from(e.windowData).map((([e,t])=>(t.selectedPanel&&!M.canRender({windowData:t,panelId:t.selectedPanel,winId:e})&&(t.selectedPanel=void 0,t.contentVisible=!1,s=t.barVisible),[e,t]))));return{...e,changeReason:"",webPanelList:t,webPanelMap:n,previousPanelBarVisible:s,windowData:i}}(e,t.list);case"PANEL_SET_WIDTH":{const{winId:n,panelId:s,width:i}=t,a=(0,g.Uy)(e,(e=>{!function(e){const{winId:t,panelId:n,width:s,draft:i}=e;if(M.getIsWebPanel(n)){const e=i.webPanelList.find((e=>e.id===n));e&&e?.width!==s&&(e.width=s)}else{const e=i.regPanelList.find((e=>e.id===n));e&&e?.width!==s&&(e.width=s)}if(!M.getResizableByPanel(n)){const e=i.windowData.get(t);if(!e)return;e.expandedWidth=s}i.changeReason=""}({draft:e,winId:n,panelId:s,width:i})}));return N(a,n),M.getIsWebPanel(s)?o.Z.set(u.kPanelsWebElements,a.webPanelList):o.Z.set(u.kPanelsElements,a.regPanelList),a}case"PANEL_REMOVE_FOCUS":return(0,g.Uy)(e,(e=>{const n=e.windowData.get(t.winId);n&&(n.focusContent=!1,e.changeReason="")}));case"PANEL_SHOW_NEXT":{const{winId:n,direction:s}=t,i=(0,g.Uy)(e,(e=>{!function(e){const{draft:t,winId:n,direction:s}=e,i=t.windowData?.get(n);if(!i)return;if(!i.contentVisible)return void I(t,i.winId);const o=M.getNextPanel(n,s);o&&(E({draft:t,winId:n,panelId:o}),t.changeReason="")}({draft:e,winId:n,direction:s})}));return N(i,n),i}case"PANEL_SHOW_CONTENT":{const{setFocus:n,selectId:s,panelId:i,winId:o,reason:a}=t;return(0,g.Uy)(e,(e=>{k({draft:e,setFocus:n,selectId:s,panelId:i,winId:o,reason:a})}))}case"PANEL_TOGGLE_CONTENT":{const{winId:n,panelId:s}=t,i=(0,g.Uy)(e,(e=>{E({draft:e,winId:n,panelId:s})}));return N(i,n),i}case"PANEL_CLEAR_TRANSITION_STATE":{const{winId:n,panelId:s}=t;return(0,g.Uy)(e,(e=>{!function(e){const{draft:t,winId:n,panelId:s}=e,i=t.windowData.get(n);i&&(i.transitionMap.has(s)&&i.transitionMap.delete(s),t.changeReason="")}({draft:e,winId:n,panelId:s})}))}case"PANEL_TOGGLE_PANEL":{const n=(0,g.Uy)(e,(e=>{A(e,t.winId)}));return N(n,t.winId),n}case"WINDOW_STATE_CHANGED":{const{oldState:n,change:s,windowId:i}=t;if("fullscreen"===n.state||"fullscreen"===s){const t=(0,d.TF)(n),o=(0,d.TF)({...n,state:s});if(t!==o){const t=(0,g.Uy)(e,(e=>{Z({draft:e,winId:i,minimal:o})}));return a.Z.get(u.kStartupRememberFullScreen)&&N(t,i),t}}return e}case"WINDOW_MINIMAL_UI":if(!d.ZP.isFullscreen(t.windowId)){const n=(0,g.Uy)(e,(e=>{Z({draft:e,winId:t.windowId,minimal:t.minimalUI})}));return N(n,t.windowId),n}return e;case"WINDOW_SET_STATE":return e.windowData.has(t.windowId)?e:(0,g.Uy)(e,(e=>{!function(e,t){t.forEach((t=>{const n=i.Z.panelInitWindow(t);n.selectedPanel&&!M.canRender({windowData:n,winId:n.winId,panelId:n.selectedPanel})&&(n.selectedPanel=M.getFirstAvailablePanel(n.winId,n)),e.windowData.set(n.winId,n)})),e.changeReason=""}(e,[i.Z.getNewWindowSettings(t.windowId,t.windowExtData)]),e.changeReason=""}));case"WINDOW_CLOSED":return(0,g.Uy)(e,(e=>{e.windowData.delete(t.windowId),e.changeReason=""}));case"PAGE_OPEN":{const n=t.windowId;if(!t.activatedByChrome)return e;const i=s.ZP.getPageById(s.ZP.getLastVisited(n)),o=s.ZP.getActivePage(n);if(n&&i&&o&&function(e,t){const{windowData:n}=e,s=Boolean(n.get(t)?.contentVisible)||!n.get(t)?.contentVisible&&a.Z.get(u.kMailOpenPanelAutomaticallyViewingMail),i=a.Z.get(u.kPanelsAsOverlayEnabled)&&(!a.Z.get(u.kPanelsAsOverlayAutoClose)||!1===M.getSeparateFloating("PanelMail",t));return a.Z.get(u.kMailDisplayMailPanelViewingMail)&&(i&&s||!a.Z.get(u.kPanelsAsOverlayEnabled)&&s)}(e,n)){const t=(0,g.Uy)(e,(e=>{T({draft:e,windowId:n,leavePage:i,enterPage:o})}));return N(t,n),t}return e}case"PANEL_CLOSE":{const{panelId:n,winId:s}=t;if(e.previousPanelBarVisible){const t=(0,g.Uy)(e,(e=>{E({draft:e,winId:s,panelId:n})}));return N(t,s),t}{const t=(0,g.Uy)(e,(e=>{A(e,s)}));return N(t,s),t}}}return e}getIsMuted(e,t){return Boolean(this.getWindowData(e)?.mutedMap?.get(t))}shouldRestorePrevPanelState(e){const{draft:t=this.getState(),winId:n,isEnterPageMail:s,isLeavePageMail:i}=e,o=t.windowData.get(n);return i&&!s&&Boolean("PanelMail"===o?.selectedPanel&&o?.contentVisible&&o?.barVisible)}getWidth(e){const t=this.getWindowData(e);if(!t)return m+v;const n=d.ZP.getVisibleUI(e).panelToggle;if(!n||t.barVisible||t.contentVisible){if(n&&t.barVisible&&!t.contentVisible)return m+v;if(t.barVisible&&!t.contentVisible)return m;if(t.barVisible&&t.contentVisible){let e=t.expandedWidth;const n=t.selectedPanel;if(n&&this.getResizableByPanel(n)){const t=this.getWidthByPanel(n);t>0&&(e=t)}return e<=0?400:e}return 0}return v}getWidthByPanel(e){const{regPanelList:t,webPanelList:n}=this.getState();return[...t,...n].find((t=>t.id===e))?.width??-1}getFocusContent(e){return Boolean(this.getWindowData(e)?.focusContent)}getIsVisible(e,t){return Boolean(this.getWindowData(e)?.contentVisible)&&this.getWindowData(e)?.selectedPanel===t}getIsBarVisible(e){return Boolean(this.getWindowData(e)?.barVisible)}getFirstAvailablePanel(e,t=M.getWindowData(e)){const n=i.Z.getPanelList();for(let s=0;s<n.length;s++){const i=n[s];if(M.canRender({windowData:t,winId:e,panelId:i}))return i}}getIsContentVisible(e){return Boolean(this.getWindowData(e)?.contentVisible)}getSelected(e){return this.getWindowData(e)?.selectedPanel}getSeparateFloating(e,t){return[...this.getWebPanels(t),...this.getRegPanels(t)].find((t=>t.id===e))?.floating??void 0}getOrderedWebPanels(e){const t=a.Z.get(u.kToolbarsPanel).filter((e=>i.Z.isWebPanel(e))),n=M.getWebPanels(e),s=t.map((e=>n.find((t=>t.id===e)))).filter(Boolean);return n.forEach((e=>{s.some((t=>t.id===e.id))||(0,h.LM)(e.id,u.kToolbarsPanel)&&s.push(e)})),s}getNextPanel(e,t){const n=this.getWindowData(e);if(n){if(n.selectedPanel){const s=i.Z.getPanelList().filter((t=>M.canRender({winId:e,panelId:t})));let o=s.indexOf(n.selectedPanel);if(-1!==o)return o+="next"===t?1:-1,s[(o+s.length)%s.length]}return M.getFirstAvailablePanel(e)}}getRegPanels(e){return this.getState().regPanelList.filter((t=>M.canRender({winId:e,panelId:t.id})))}getWebPanels(e){return this.getState().webPanelList.filter((t=>M.canRender({winId:e,panelId:t.id})))}getWebPanel(e,t){return M.getWebPanels(e).find((e=>e.id===t))}getIsWebPanel(e){return this.getState().webPanelMap.has(e)}hasWebPanel(e,t){return Boolean(M.getOrderedWebPanels(e)[t-1])}canRender(e){const{winId:t,windowData:n=this.getWindowData(e.winId),panelId:s}=e;if(d.ZP.isGuest()&&!f.includes(s))return!1;if(!i.Z.isWebPanel(s))if(y.includes(s)){if(!d.ZP.isMail(t)||a.Z.get(u.kMailIsTurnedOff))return!1}else if(C.includes(s)){if(a.Z.get(u.kMailIsTurnedOff))return!1}else if(w.includes(s)){"PanelChat"===s&&l.Z.isEnabled("chat");return!1}return Boolean(n||d.ZP.isSettings(t))}hasPanel(e,t){return!!M.canRender({winId:e,panelId:t})&&Boolean(a.Z.get(u.kToolbarsPanel).find((e=>e===t))||a.Z.get(u.kToolbarsNavigation).find((e=>e===t))||a.Z.get(u.kToolbarsStatus).find((e=>e===t))||a.Z.get(u.kToolbarsMail).find((e=>e===t)))}getChangeReason(){return this.getState().changeReason}getWindowData(e){return this.getState().windowData.get(e)}getMutedMap(e){return this.getWindowData(e)?.mutedMap}getResizableByPanel(e){const{regPanelList:t,webPanelList:n}=this.getState();for(let n=0;n<t.length;n++)if(t[n].id===e)return t[n].resizable;for(let t=0;t<n.length;t++)if(n[t].id===e)return n[t].resizable;return!1}canAutoOpen(e,t){return!(this.getSelected(e)===t&&this.getWidth(e)>50)}getTransitionState(e,t){return this.getWindowData(e)?.transitionMap.get(t)}}const M=new _;function N(e,t){const n=e.windowData.get(t);n&&(o.Z.set(u.kPanelsWindowDefaults,{barVisible:n.barVisible,panelVisible:n.contentVisible,selectedPanel:n.selectedPanel?n.selectedPanel:void 0,width:n.expandedWidth}),b(n.winId,{SHOW_PANEL:n.barVisible,SELECTED_PANEL:n.selectedPanel?n.selectedPanel:void 0,PANEL_WIDTH:n.expandedWidth,SHOW_PANEL_CONTENT:n.contentVisible}))}const P=M},32921:(e,t,n)=>{"use strict";n.d(t,{Z:()=>f,d:()=>r});var s=n(65398),i=n(14481),o=n(33638),a=n(93513);const r=e=>{const{lastAlarmTime:t,periodInMinutes:n,currentTime:s=Date.now()}=e,i=6e4*n;if(t){return t+i*Math.ceil((s-t)/i)}return s+i};let l,d=new Map;class c extends s.Z{getAlarmFromReloadId(e){return d.get(e)}existingAlarms(){return Boolean(d.size)}getPanelAlarms(){const e=[];for(const[t,n]of d)"panel"===n.from&&e.push([t,n]);return new Map(e)}dispatchAction(e){switch(e.actionType){case"PERIODIC_RELOAD_ALL":h(e.alarms);break;case"PERIODIC_RELOAD_CREATE":p(e.alarm);break;case"PAGE_CLOSE":e.pages.forEach((e=>{const t=e.vivExtData.ext_id;t&&u([t])}));break;case"PERIODIC_RELOAD_DESTROY":u(e.alarmIds);break;case"PERIODIC_RELOAD_UPDATE":d=(0,a.Uy)(d,(t=>{t.set(e.alarm.alarmId,e.alarm.alarm)}))}}}const h=e=>{d=(0,a.Uy)(d,(t=>{e.forEach(((e,n)=>{t.set(n,e)}))})),!l&&d.size&&(g(),m())},p=e=>{d=(0,a.Uy)(d,(t=>{t.set(e.alarmId,e.alarm)})),l||(g(),m())},u=e=>{d=(0,a.Uy)(d,(t=>{e.forEach((e=>t.delete(e)))}))},g=()=>{const e=Date.now(),t=[];d.forEach(((n,s)=>{const{scheduledTime:o,periodInMinutes:a,id:l,from:d}=n,c=(o-e)/6e4/a;if(c<=0){const n={id:l,scheduledTime:r({periodInMinutes:a,lastAlarmTime:o,currentTime:e}),periodInMinutes:a,from:d};t.push({type:"RELOAD",id:s}),i.Z.updateRunningAlarm(s,n)}else t.push({type:"TIME_CHANGED",remainingTime:c,id:s,from:d})})),v.emitChange(t)},m=()=>l=setInterval((()=>{if(0===d.size)return clearInterval(l),l=void 0,void v.emitChange([]);g()}),1e3),v=new c(o.Z),f=v},67044:(e,t,n)=>{"use strict";n.d(t,{Z:()=>g});var s=n(65398),i=n(87159),o=n(33638),a=n(56371),r=n(93513);const l=[{key:"random",name:(0,a.Z)("Random"),host:"random.pgpp.stations.invisv.com"},{key:"fastest",name:(0,a.Z)("Fastest"),host:"fastest.pgpp.stations.invisv.com"}],d=["*.local","*.home.arpa","localhost","fd00::/8","10.0.0.0/8","172.16.0.0/12","192.168.0.0/16","*.vivaldi.com"];let c={apiMode:"",bypassList:[],connectStrategy:"random",levelOfControl:"not_controllable",location:h(0),otherProxy:!1,publicIp:"",proxyState:"stopped",showSurvey:void 0,tokenData:{message:"",state:"idle",token:""}};function h(e){if(void 0===e)return(0,a.Z)("Disconnected");switch(e){case 1:return(0,a.Z)("Tokyo");case 2:return(0,a.Z)("Singapore");case 3:return(0,a.Z)("Frankfurt");case 4:return(0,a.Z)("London");case 5:return(0,a.Z)("Sao Paulo");case 6:return(0,a.Z)("US-East");case 7:return(0,a.Z)("US-Central");case 8:return(0,a.Z)("US-West");default:return(0,a.Z)("Unknown")}}class p extends s.Z{getHasToken(){return c.tokenData.token.length>0}getTokenData(){return c.tokenData}getLocal(){return{host:"localhost",port:32190}}getRemote(){const e=l.findIndex((e=>e.key===c.connectStrategy));return{host:l[-1===e?0:e].host,port:443}}getConnectStrategy(){return c.connectStrategy}getConnectStrategies(){return l}getHasOtherProxy(){return c.otherProxy}getHasApiAccess(){return"controllable_by_this_extension"===c.levelOfControl||"controlled_by_this_extension"===c.levelOfControl}getApiRejectReason(){switch(c.levelOfControl){case"controlled_by_other_extensions":return(0,a.Z)("Another proxy is active");case"not_controllable":return(0,a.Z)("Proxy API is not available");default:return""}}getRunsApi(){return"controlled_by_this_extension"===c.levelOfControl&&"fixed_servers"===c.apiMode}getIsConnected(){return"controlled_by_this_extension"===c.levelOfControl&&"fixed_servers"===c.apiMode&&"running"===c.proxyState}getBypassList(e){return e?d.concat(c.bypassList):c.bypassList}getLocation(){return c.location}getPublicIp(){return c.publicIp}getShowSurvey(){return void 0===c.showSurvey?i.ZP.showSurveyNow():c.showSurvey}dispatchAction(e){switch(e.actionType){case"PROXY_INIT":c=(0,r.Uy)(c,(t=>{t.apiMode=e.apiMode,t.bypassList=e.bypassList,t.connectStrategy=e.connectStrategy,t.levelOfControl=e.levelOfControl,t.otherProxy=e.otherProxy,t.tokenData={message:t.tokenData.message,state:t.tokenData.state,token:e.token}})),u.emitChange();break;case"PROXY_SET_BYPASS_LIST":c=(0,r.Uy)(c,(t=>{t.bypassList=e.bypassList})),u.emitChange();break;case"PROXY_SET_CONNECT_STRATEGY":c=(0,r.Uy)(c,(t=>{t.connectStrategy=e.connectStrategy})),u.emitChange();break;case"PROXY_SET_SHOW_SURVEY":c=(0,r.Uy)(c,(t=>{t.showSurvey=e.state})),u.emitChange();break;case"PROXY_SET_NETWORK_INFO":c=(0,r.Uy)(c,(t=>{t.publicIp=e.publicIp,t.location=h(e.location)})),u.emitChange();break;case"PROXY_SET_PROXY_STATE":c=(0,r.Uy)(c,(t=>{t.proxyState=e.proxyState,t.publicIp=e.publicIp,t.location=h(e.location)})),u.emitChange();break;case"PROXY_SET_TOKEN_STATE":c=(0,r.Uy)(c,(t=>{t.tokenData=e.tokenData})),u.emitChange()}}}const u=new p(o.Z),g=u},80342:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var s=n(24602);class i extends s.Z{getInitialState(){return[]}getList(){return this.getState()}getUnreadCount(){return this.getState().filter((e=>!e.read)).length}getFilter(e){return this.getState().filter((t=>{const n=e.split(" "),{title:s,url:i}=t;return i.toLowerCase().includes(e.toLowerCase())||n.every((e=>s.toLowerCase().includes(e.toLowerCase())))}))}reduce(e,t){return"READING_LIST_UPDATE"===t.actionType?t.entries:e}}const o=new i},24602:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var s=n(65398),i=n(33638);class o extends s.Z{constructor(e){super(e??i.Z),this._state=this.getInitialState(),this._wrappedListeners=new Map}getState(){return this._state}getInitialState(){throw new TypeError(`getInitialState() is not overwritten in ${this.constructor.name}`)}addListener(e,t){if(t){if(this._wrappedListeners.has(e))throw new Error(`addListener() in ${this.constructor.name} was called with a listener that was already added as a callback. Use ensureAddedListener() if this was intentional.`);let n;const s=()=>{const s=t(this.getState());s!==n&&e(),n=s};this._wrappedListeners.set(e,s),super.addListener(s)}else super.addListener(e)}removeListener(e){const t=this._wrappedListeners.get(e);t?(this._wrappedListeners.delete(e),super.removeListener(t)):super.removeListener(e)}ensureRemovedListener(e){const t=this._wrappedListeners.get(e);t?(this._wrappedListeners.delete(e),super.ensureRemovedListener(t)):super.ensureRemovedListener(e)}reduce(e,t){throw new TypeError(`reduce() is not overwritten in ${this.constructor.name}`)}dispatchAction(e){const t=this._state,n=this.reduce(t,e);if(void 0===n)throw new Error(`reduce() in ${this.constructor.name} returned undefined, did you forget to return the state in the default case?`);n!==t&&(this._state=n,this.emitChange())}}const a=o},81538:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});const s=new Map},18237:(e,t,n)=>{"use strict";n.d(t,{AP:()=>l,ZP:()=>g,iq:()=>r,m8:()=>a});var s=n(65398),i=n(33638),o=n(93513);const a="vivaldi/x-session",r="vivaldi/x-session-history",l="vivaldi/x-session-content",d=3e5;let c={items:[],rootId:0,autosaveId:0,trashId:0},h={opening:!1,workspaceAsTabs:!1,persistentTabs:!1,workspaceMap:new Map,groupIdMap:new Map,groupNameMap:new Map};class p extends s.Z{backupId=null;backupSumTick=0;getAll(){return c.items}hasSessions(){const e=u.getAll();return e.length>1||Boolean(e[0]?.children?.length)}getFiltered(e){const t=e.trim();if(!t)return u.getAll();const n=t.toLowerCase().split(" "),s=[];return u.getAll().forEach((e=>{let t=!1;e.name&&(t=n.every((t=>e.name.includes(t)))),t&&s.push(e)})),s}getById(e){const t=function(n){for(let s=0;s<n.length;s++){const i=n[s];if(i.id===e)return{index:s,item:i};if(i.children){const e=t(i.children);if(e)return e}}};return t(c.items)}isTrash(e,t){if(e===c.trashId)return t;let n=u.getById(e);for(;n;){if(n.item.id===c.trashId)return!0;n=u.getById(n.item.parentId)}return!1}isTrashFolder(e){return e===c.trashId}isAutoSaveNode(e){return e===c.autosaveId}isHistoryParent(e){const t=u.getById(e);return"node"===t?.item.type&&Boolean(t?.item.children)}isHistoryChild(e){return"history"===u.getById(e)?.item.type}getRootId(){return c.rootId}getAutoSaveId(){return c.autosaveId}getTrashId(){return c.trashId}getTitle(e){return u.getById(e)?.item.name??""}getWorkspace(e){const t=function(n){for(let s=0;s<n.length;s++){const i=n[s],o=i.workspaces.find((t=>t.id===e));if(o)return o;if(i.children){const e=t(i.children);if(e)return e}}};return t(c.items)}getIsLoading(){return h.opening}getLoadWorkspaceId(e){return h.workspaceMap.get(e)}getLoadGroup(e,t){if(h.opening){let n="";if(h.groupIdMap.has(t)?n=h.groupIdMap.get(t)??"":(n=crypto.randomUUID(),h.groupIdMap.set(t,n)),h.groupNameMap.has(t)){const s=h.groupNameMap.get(t)?.name??"";h.groupNameMap.set(n,{windowId:e,name:s}),h.groupNameMap.delete(t)}return n}return""}getLoadGroupNameMap(){return h.groupNameMap}getLoadWorkspaceAsTabs(){return h.workspaceAsTabs}getLoadPersistentTabs(){return h.persistentTabs}dispatchAction(e){const t=(e,t,n)=>{const s=(e,t,n)=>{for(let i=0;i<e.length;i++)if(e[i].children){if(e[i].id===t)return n>e[i].children.length?void 0:{items:e[i].children,index:n,id:t};const o=s(e[i].children,t,n);if(o)return o}};return t===c.rootId?n>e.length?void 0:{items:e,index:n,id:t}:s(e,t,n)},n=(e,t,n)=>{const s=(e,t,n)=>{for(let i=0;i<e.length;i++){if(e[i].id===t&&"node"===e[i].type)return n&&void 0===e[i].children?e[i].children=[]:n||void 0===e[i].children||delete e[i].children,!0;if(e[i].children){const o=s(e[i].children,t,n);if(o)return o}}return!1};return t===c.rootId?void 0:s(e,t,n)},s=e=>{e&&null===this.backupId?(this.backupSumTick=0,this.backupId=setTimeout(i,d)):null!==this.backupId&&(clearTimeout(this.backupId),this.backupSumTick=0,this.backupId=null)},i=()=>{this.backupSumTick+=d,this.backupSumTick>=36e5?(this.backupSumTick=0,u.emitChange({reason:"autosave"})):u.emitChange({reason:"backup"}),this.backupId=setTimeout(i,d)};switch(e.actionType){case"SESSION_INIT":c=(0,o.Uy)(c,(t=>{t.rootId=e.model.rootId,t.autosaveId=e.model.autosaveId,t.trashId=e.model.trashId,e.model.items.forEach((e=>{t.items.push(e)}))})),e.backup&&s(!0),u.emitChange({reason:"init"});break;case"SESSION_ADDED":{let s;c=(0,o.Uy)(c,(i=>{n(i.items,e.parentId,!0);const o=t(i.items,e.parentId,e.index);o&&(o.items.splice(o.index,0,e.item),s={index:o.index,item:o.items[o.index]})})),s&&u.emitChange({reason:"added",info:s,owner:e.owner});break}case"SESSION_CHANGED":{const n=u.getById(e.id);if(n){let s;c=(0,o.Uy)(c,(i=>{const o=t(i.items,n.item.parentId,n.index);if(o){const t={...e.item,content:o.items[o.index].content};o.items.splice(o.index,1,t),s={index:o.index,item:o.items[o.index]}}})),s&&u.emitChange({reason:"changed",info:s})}break}case"SESSION_CONTENT":const i=u.getById(e.id);if(i){let n;c=(0,o.Uy)(c,(s=>{const o=t(s.items,i.item.parentId,i.index);if(o){const t={...o.items[o.index],content:e.content};o.items.splice(o.index,1,t),n={index:o.index,item:o.items[o.index]}}})),n&&u.emitChange({reason:"content",info:n,owner:e.owner})}break;case"SESSION_DELETED":{const n=u.getById(e.id);if(n){let e;c=(0,o.Uy)(c,(s=>{const i=t(s.items,n.item.parentId,n.index);i&&(e={index:i.index,item:{...i.items[i.index]}},i.items.splice(i.index,1))})),e&&u.emitChange({reason:"deleted",info:e})}break}case"SESSION_MOVED":{const s=u.getById(e.id);if(s){let i;c=(0,o.Uy)(c,(o=>{n(o.items,e.parentId,!0);const a=t(o.items,s.item.parentId,s.index),r=t(o.items,e.parentId,e.index);r&&a&&(i={index:r.index,item:e.item},a.items.splice(a.index,1),r.items.splice(r.index,0,i.item),0===a.items.length&&n(o.items,s.item.parentId,!1))})),i&&u.emitChange({reason:"moved",info:i})}break}case"SESSION_SET_TIMED_BACKUP":s(e.backup);break;case"SESSION_SET_LOADING_PARAMETERS":h={opening:e.opening,workspaceAsTabs:e.workspaceAsTabs,persistentTabs:e.persistentTabs,workspaceMap:new Map(e.workspaceMap),groupIdMap:new Map,groupNameMap:new Map(e.groupNameMap)}}}}const u=new p(i.Z),g=u},37330:(e,t,n)=>{"use strict";n.d(t,{Z:()=>A});var s=n(65792),i=n.n(s),o=n(93197),a=n(96951),r=n(29087),l=n(24602),d=n(2699),c=n(19486),h=n(15489),p=n(25372),u=n(25356),g=n(89175),m=n(93513),v=n(44850);const f=new Map,y=[],C=new Set,w=["colorFg","colorBg","colorHighlightBg","colorAccentBg"];function b(e){if(e.preferSystemAccent&&i().valid(r.Z.get(g.kSystemAccentColor))){const t={...e};return t.colorHighlightBg=r.Z.get(g.kSystemAccentColor),c.Z.createStyle(t)}return c.Z.createStyle(e)}function S(e,t,n){const s=i().contrast(e,t)>n?50:0,o=e.get("lch.l")>5&&e.get("lch.l")<95?50:0;let a=e.get("lch.c")>10?50:0;return(e.get("lch.l")<20||e.get("lch.l")>75)&&(a=e.get("lch.c")>50?a:0),s+o+a}function I(e,t,n,s,r=!1){const l=i()(n.colorFg),d=i()(n.colorBg),c=function(e,t,n){let s;if(t.accentFromPage&&e){s=function(e,t){const n=t?.favIconUrl||"",s=t?.url||"";if(!t||C.has(s)||v.jk.isInternalPage(t)||n.startsWith("chrome://favicon/"))return i()(e.colorAccentBg);const o=e.accentSaturationLimit,a=new Map,r=y.find((e=>e.favIconUrl===n))||y.find((e=>s.includes(e.hostname))),l=f.get(t.id);l&&a.set(l,3),r?.colors.forEach(((e,t)=>{switch(t){case 0:a.set(e,2.25);break;case 1:a.set(e,1.5);break;case 2:a.set(e,1.25);break;default:a.set(e,1)}}));const d=[...a.keys()];a.size>2&&d[0].get("lch.c")<1&&d.forEach((e=>{e.get("lch.c")>1&&a.set(e,2)}));const c=i()(e.colorBg),h=[...a].sort(((t,n)=>S(n[0],c,e.contrast)*n[1]-S(t[0],c,e.contrast)*t[1]));return h.length>0&&o<1&&h[0][0].get("hsl.s")>o&&(h[0][0]=h[0][0].set("hsl.s",o)),h[0]&&h[0][0]||i()(e.colorAccentBg)}(t,n||a.ZP.getActivePage(e))}else s=i()(t.colorAccentBg);if(t.accentSaturationLimit<1){const e=s.get("hsl.s");s=s.set("hsl.s",e*t.accentSaturationLimit)}return s}(t,n,s),h=r&&c!==n.colorAccentBg,p={...o.ZP.accentOnly(c,l,d,n.contrast,h)};Object.keys(p).forEach((t=>{e[`--${t}`]=p[t].toString()}))}class k extends l.Z{getInitialState(){return{windowStyles:new Map,theme:{engineVersion:1,version:1,id:"Vivaldi1",url:"",name:"Vivaldi",accentFromPage:!0,accentOnWindow:!0,accentSaturationLimit:1,backgroundImage:"",backgroundPosition:"stretch",radius:4,colorAccentBg:"#ef3939",colorBg:"#f6f6f6",colorFg:"#222222",colorHighlightBg:"#4c70f0",colorWindowBg:"#EDEEF2",contrast:0,preferSystemAccent:!1,alpha:.92,blur:5,transparencyTabs:!1,transparencyTabBar:!1}}}getBaseStylesByWindowId=(e,t)=>{const n=this.getState().windowStyles.get(e)||c.Z.getFallbackStyle();return n?this.getBaseStylesByStyle(n,t):{}};getReaderThemeColor(e){let t;switch(r.Z.get(g.kWebpagesReaderStyle).themeStyle){case"light":t="Vivaldi1";break;case"dark":t="Vivaldi2";break;default:t=void 0}return t?this.getBaseStylesByThemeId(t):this.getBaseStylesByWindowId(e)}getBaseStylesByThemeId=(e,t)=>{const n=c.Z.getTheme(e),s=n?c.Z.createStyle(n):null;return s?this.getBaseStylesByStyle(s,t):{}};getBaseStylesByStyle=(e,t)=>{const n=t&&t.length>0?t:w,s={};for(const[t,i]of Object.entries(e))n.includes(t.replace("--",""))&&i&&(s[t]=i);return t?.includes("backgroundBlur")&&void 0===s["--backgroundBlur"]&&(s["--backgroundBlur"]="none"),s};getThemeImageSet=e=>{if(e){let t=new Set;if(t=c.Z.getThemeWithFallback(e).buttons,t)return t}return this.getState().theme.buttons};getToolbarButtonImage=e=>{if(!r.Z.get(g.kThemesPreferCustomButtons))return null;const t=r.Z.get(g.kThemesPreview)[0]?"":r.Z.get(g.kThemesCurrentButtons),n=this.getThemeImageSet(t);return n&&n[e]?"string"==typeof n[e]?n[e]:n[e].large:null};hasDarkBackground=e=>{const t=this.getBaseStylesByWindowId(e,["colorBg"]);return c.Z.isThemeDark(t)};reduce(e,t){if("THEME_WINDOW_CREATED"===t.actionType)return(0,m.Uy)(e,(n=>{const{windowId:s}=t,{theme:i}=e,o=b(i);Object.assign(o,t.style),I(o,s,i),n.windowStyles.set(s,o)}));if("WINDOW_CLOSED"===t.actionType)return(0,m.Uy)(e,(e=>{e.windowStyles.delete(t.windowId)}));if("THEME_SET"===t.actionType)return(0,m.Uy)(e,(e=>{const{theme:n,init:s}=t;e.theme=n,s&&(e.windowStyles=new Map(Array.from(h.ZP.getState()).map((([e])=>[e,{}]))));const i=b(n);e.windowStyles.forEach(((e,s)=>{Object.assign(e,i),Object.keys(e).forEach((t=>{i.hasOwnProperty(t)||delete e[t]})),Object.assign(e,t.style),I(e,s,n)}))}));if("PAGE_OPEN"===t.actionType||"PAGE_OPEN_URL"===t.actionType){const{windowId:n,pageId:s}=t,i=a.ZP.getPageById(s);return(0,m.Uy)(e,(t=>{const{theme:s}=e,o=t.windowStyles.get(n);if(o&&i){const e=s.accentFromPage&&s.accentOnWindow;I(o,n,s,i,e)}}))}if("THEME_SET_META"===t.actionType)return f.get(t.tabId)?.hex()!==t.color.hex()&&f.set(t.tabId,t.color),(0,m.Uy)(e,(t=>{t.windowStyles.forEach(((t,n)=>{const{theme:s}=e;I(t,n,s,null,!0)}))}));if("THEME_SET_FAILED_FAVICON_URL"===t.actionType)return C.has(t.url)||C.add(t.url),(0,m.Uy)(e,(t=>{t.windowStyles.forEach(((t,n)=>{const{theme:s}=e;I(t,n,s)}))}));if("THEME_SET_PAGE_PALETTE"===t.actionType){const{windowId:n,favIconUrl:s,hostname:i,colors:o}=t;return y.push({favIconUrl:s,hostname:i,colors:o}),(0,m.Uy)(e,(t=>{const s=t.windowStyles.get(n),{theme:i}=e;s&&I(s,n,i,null,!0)}))}if("CHROME_TABS_CREATE"===t.actionType||"CHROME_TABS_UPDATED"===t.actionType){const n="CHROME_TABS_CREATE"===t.actionType?t.page:a.ZP.getPageById(t.tabId),s=n?.windowId,i=n?.favIconUrl,o=n?.url,r=Boolean(i&&!i.startsWith("chrome://favicon/")&&y.find((e=>e.favIconUrl===i)));if(!Boolean(!n||!o||C.has(o)||v.jk.isInternalPage(n)||r||n.incognito)&&n&&o){const t=(0,p.Z)((0,u.Z)(o))?.hostname;if(t&&s&&i){if(y.find((e=>e.hostname===t)))return d.Z.loadFavicon(n,t),(0,m.Uy)(e,(t=>{const n=t.windowStyles.get(s),{theme:i}=e;n&&I(n,s,i)}));d.Z.loadFavicon(n,t)}}}return"ZOOM_SET_UI"===t.actionType?(0,m.Uy)(e,(e=>{e.windowStyles.forEach(((n,s)=>{n["--uiZoomLevel"]=t.zoomData,e.windowStyles.set(s,n)}))})):e}}const A=new k},85374:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>l});var s=n(24602),i=n(35369);const o=Object.freeze({pageLanguage:"",translateStep:"idle"});class a extends s.Z{getInitialState(){return new i.D5}getPageState(e){return this.getState().get(e)??o}reduce(e,t){switch(t.actionType){case"VIVALDI_TABS_LANGUAGE_DETERMINED":{const{tabId:n,pageLanguage:s}=t;return r(e,n,{pageLanguage:s})}case"VIVALDI_TABS_PAGE_TRANSLATED":{const{tabId:n}=t;let{isTranslated:s,originalLang:i,translatedLang:o,error:a}=t.message;return s&&"no_error"!==a&&(s=!1),r(e,n,{isTranslated:s,originalLang:i,translatedLang:o,error:a})}case"PAGE_CLOSE":return function(e,t){return t.forEach((t=>{e=e.remove(t.id)})),e}(e,t.pages);case"PAGE_RESET_TRANSLATION_PARAMETERS":return e.remove(t.tabId);case"VIVALDI_TABS_PAGE_TRANSLATED_REVERT":{const{tabId:n}=t;return r(e,n,{isTranslated:!1})}case"VIVALDI_TABS_TRANSLATION_PROGRESS":{const{tabId:n,translateStep:s,error:i,autoTranslate:o}=t;return r(e,n,{translateStep:s,error:i,autoTranslate:o})}default:return e}}}function r(e,t,n){let s=e.get(t)??o;return s=(0,i.TS)(s,n),s===o?e:e.set(t,s)}const l=new a},63365:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var s=n(65398),i=n(33638);class o extends s.Z{_trash=[];getTrash(){return this._trash}dispatchAction(e){if("CHROME_SET_SESSION"===e.actionType)this._trash=e.session,this.emitChange()}}const a=new o(i.Z)},61670:(e,t,n)=>{"use strict";n.d(t,{O:()=>i,Z:()=>a});var s=n(24602);function i(e){return e.hasToken?"loggedIn":"invalid_credentials"===e.lastTokenFetchError.errorType?"loginFailed":0!==e.tokenRequestTime?"loggingIn":e.accountInfo.accountId?"credentialsMissing":"loggedOut"}class o extends s.Z{getInitialState(){return{accountInfo:{accountId:"",username:"",pictureUrl:""},hasSavedPassword:!1,hasToken:!1,accessToken:"",hasEncryptedToken:!1,tokenRequestTime:0,nextTokenRequestTime:0,lastTokenFetchError:{errorType:"no_error",serverMessage:"",errorCode:0},lastAccountInfoFetchError:{errorType:"no_error",serverMessage:"",errorCode:0},isReady:!1}}reduce(e,t){return"VIVALDI_ACCOUNT_STATE_UPDATED"===t.actionType?t.state:e}}const a=new o},57904:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var s=n(65398),i=n(33638);const o={},a={};class r extends s.Z{isFindInPageOpen(e){return!0===o[e]}getFindResultsForPage(e){let t=a[e];return void 0===t&&(t={activeMatchOrdinal:0,numberOfMatches:0,searchText:"",canceled:!1,matchCase:!1,isFindInPageToolbarOpen:!1,selectionRect:{left:0,top:0,width:0,height:0}}),t.isFindInPageToolbarOpen=!0===o[e],t}dispatchAction(e){switch(e.actionType){case"WEBPAGEVIEW_ACTIONS":switch(e.subAction){case"findInPage":o[e.pageId]=!0,this.emitChange({type:"WEBPAGEVIEW_ACTIONS",action:"findInPage",winId:e.windowId,pageId:e.pageId});break;case"findNextInPage":case"findPreviousInPage":!0!==o[e.pageId]&&(o[e.pageId]=!0,this.emitChange({type:"WEBPAGEVIEW_ACTIONS",action:"findInPage",winId:e.windowId,pageId:e.pageId})),this.emitChange({type:"WEBPAGEVIEW_ACTIONS",action:e.subAction,winId:e.windowId,pageId:e.pageId});break;case"addBookmark":case"focusAddressField":case"pageScrollBottom":case"pageScrollDown":case"pageScrollTop":case"pageScrollUp":case"print":this.emitChange({type:"WEBPAGEVIEW_ACTIONS",action:e.subAction,winId:e.windowId,pageId:e.pageId});break;case"focusSearchField":this.emitChange({type:"WEBPAGEVIEW_URLFIELD_BLUR",winId:e.windowId}),this.emitChange({type:"WEBPAGEVIEW_ACTIONS",action:"focusSearchField",winId:e.windowId,pageId:e.pageId});break;case"focusWebView":this.emitChange({type:"WEBPAGEVIEW_URLFIELD_BLUR",winId:e.windowId}),this.emitChange({type:"WEBPAGEVIEW_ACTIONS",action:"focusWebView",winId:e.windowId,pageId:e.pageId});break;case"searchPasteAndGo":case"urlPasteAndGo":case"qcPasteAndGo":e.payload&&this.emitChange({type:"WEBPAGEVIEW_ACTIONS",action:e.subAction,winId:e.windowId,pageId:e.pageId,payload:e.payload})}break;case"WEBPAGEVIEW_BACK":case"WEBPAGEVIEW_FORWARD":case"WEBPAGEVIEW_STOP":this.emitChange({type:e.actionType,winId:e.windowId,pageId:e.pageId});break;case"WEBPAGEVIEW_CLOSE_FIND_IN_PAGE":o[e.pageId]&&(o[e.pageId]=!1,this.emitChange({type:"WEBPAGEVIEW_CLOSE_FIND_IN_PAGE",winId:e.windowId,pageId:e.pageId}));break;case"WEBPAGEVIEW_GET_HISTORY":this.emitChange({type:"WEBPAGEVIEW_GET_HISTORY",winId:e.windowId,pageId:e.pageId,callback:e.callback});break;case"WEBPAGEVIEW_GO":this.emitChange({type:"WEBPAGEVIEW_GO",winId:e.windowId,pageId:e.pageId,index:e.index});break;case"WEBPAGEVIEW_RELOAD":this.emitChange({type:e.actionType,winId:e.windowId,pageId:e.pageId,bypassCache:e.bypassCache});break;case"WEBPAGEVIEW_RESULTS_FROM_FIND_IN_PAGE":o[e.pageId]&&(a[e.pageId]={...e.results,matchCase:e.matchCase,searchText:e.searchText,isFindInPageToolbarOpen:!1},this.emitChange({type:"WEBPAGEVIEW_RESULTS_FROM_FIND_IN_PAGE",winId:e.windowId,pageId:e.pageId}));break;case"MAIN_SHOW_QUICKCOMMANDS":case"PANEL_SET_FOCUS":this.emitChange({type:"WEBPAGEVIEW_URLFIELD_BLUR",winId:e.winId})}}}const l=new r(i.Z)},15489:(e,t,n)=>{"use strict";n.d(t,{Ex:()=>u,TF:()=>m,WV:()=>w,ZP:()=>C});var s=n(96951),i=n(29087),o=n(24602),a=n(33638),r=n(34540),l=n(69046),d=n(44850),c=n(89175),h=n(93513),p=n(48588);const u=-1,g=[];function m(e){if(!e)return!1;const{state:t,minimalUI:n}=e;return n||"fullscreen"===t}class v extends o.Z{settingsCategory="general&";getInitialState(){return new Map}_updateUIState(e,t){const n=m(this.getState().get(e)),s=m(t);n&&!s?t.visibleUI=this.getUIFromPrefs():!n&&s&&(t.visibleUI={bookmarksBar:!1,addressBar:!1,panelToggle:!1,tabs:!1,statusBar:i.Z.get(c.kStatusBarMinimized)})}reduce(e,t){switch(t.actionType){case"WINDOW_SET_STATE":return(0,h.Uy)(e,(e=>{const{windowId:n,windowState:s}=t;e.set(n,s)}));case"WINDOW_CLOSED":return(0,h.Uy)(e,(e=>{const{windowId:n}=t;e.delete(n)}));case"WINDOW_UPDATE_FROM_PREFS":{const{windowId:n}=t;return m(e.get(t.windowId))?e:(0,p.c)(e,n,(e=>{e.visibleUI=this.getUIFromPrefs()}))}case"WINDOW_ACTIVATED":{const{windowId:n,activated:s}=t;s&&this.initializingWindowId&&(this.initializingWindowId=void 0);const i=e.get(n);return i&&i.active!==s?new Map(e).set(n,{...i,active:s}):e}case"WINDOW_STATE_CHANGED":return(0,p.c)(e,t.windowId,(e=>{const{windowId:n,change:s}=t;"fullscreen"===e.state&&"fullscreen"!==s&&(e.html5FullScreen=!1),e.state&&"fullscreen"!==e.state&&"fullscreen"===s&&(e.restoreStateFullscreen=e.state),e.state=s,this._updateUIState(n,e)}));case"WINDOW_FULL_SCREEN_MENU_BAR":return(0,p.c)(e,t.windowId,(e=>{e.fullscreenMenubarShown=t.shown}));case"WINDOW_HTML5_FULL_SCREEN":return(0,p.c)(e,t.windowId,(e=>{const{windowId:n,html5FullScreen:s}=t;s?(e.restoreStateHtml5Fullscreen=e.state?e.state:"normal",e.state="fullscreen"):e.state=e.restoreStateHtml5Fullscreen,e.html5FullScreen=s,this._updateUIState(n,e)}));case"WINDOW_MINIMAL_UI":return(0,p.c)(e,t.windowId,(e=>{e.minimalUI=t.minimalUI,this._updateUIState(t.windowId,e)}));case"WINDOW_TOGGLE_BOOKMARKS_BAR":return m(e.get(t.windowId))?(0,p.c)(e,t.windowId,(e=>{e.visibleUI.bookmarksBar=!e.visibleUI.bookmarksBar})):(console.warn("Attempting to toggle toolbars for a window without minimal UI"),e);case"WINDOW_TOGGLE_ADDRESS_BAR":return m(e.get(t.windowId))?(0,p.c)(e,t.windowId,(e=>{e.visibleUI.addressBar=!e.visibleUI.addressBar})):(console.warn("Attempting to toggle toolbars for a window without minimal UI"),e);case"WINDOW_TOGGLE_TABS":return m(e.get(t.windowId))?(0,p.c)(e,t.windowId,(e=>{e.visibleUI.tabs=!e.visibleUI.tabs})):(console.warn("Attempting to toggle toolbars for a window without minimal UI"),e);case"WINDOW_TOGGLE_PANEL_TOGGLE":return m(e.get(t.windowId))?(0,p.c)(e,t.windowId,(e=>{e.visibleUI.panelToggle=!e.visibleUI.panelToggle})):(console.warn("Attempting to toggle toolbars for a window without minimal UI"),e);case"WINDOW_TOGGLE_STATUS_BAR":return m(e.get(t.windowId))?(0,p.c)(e,t.windowId,(e=>{e.visibleUI.statusBar="on"===e.visibleUI.statusBar?i.Z.get(c.kStatusBarMinimized):"on"})):(console.warn("Attempting to toggle toolbars for a window without minimal UI"),e);case"WINDOW_SET_ACTIVE_WORKSPACE":const n=t.id||void 0;return(0,r.Z)(t.windowId,{activeWorkspaceId:n}),(0,p.c)(e,t.windowId,(e=>{e.activeWorkspaceId=n}));case"PAGE_OPEN":{const n=t.windowId,o=s.ZP.getActivePage(n);if(i.Z.get(c.kWorkspacesEnabled)&&t.activatedByChrome){const i=s.ZP.getPageInWindow(n,t.pageId),a=i?(0,l.cm)(i):void 0;if(i&&o&&!(0,d.pD)(i.url)&&a!==(0,l.cm)(o))return(0,r.Z)(n,{activeWorkspaceId:a}),(0,p.c)(e,n,(e=>{e.activeWorkspaceId=a}))}return e}}return e}getWindowState(e){return this.getState().get(e)}getActiveWindowId(){for(const[e,t]of this.getState())if(t.active)return e;return u}getActiveWorkspaces(e){const t=this.isIncognito(e),n=new Map;for(const[e,s]of this.getState())if("normal"===s.type&&s.incognito===t){const t=this.getActiveWorkspace(e);t&&n.set(t,e)}return n}getIds(e){const t=[];for(const[n,s]of this.getState())s.type===e&&t.push(n);return t}getLastActiveBrowserWindowId(){return 0===g.length?u:g[0]}isFullscreen(e){return"fullscreen"===this.getState().get(e)?.state}isHTML5Fullscreen(e){return this.getState().get(e)?.html5FullScreen||!1}isIncognito(e){return this.getState().get(e)?.incognito||!1}isMaximized(e){return"maximized"===this.getState().get(e)?.state}isMinimized(e){return"minimized"===this.getState().get(e)?.state}isActive(e){return this.getState().get(e)?.active||!1}isPopup(e){return"popup"===this.getState().get(e)?.type}isSettings(e){return"settings"===this.getState().get(e)?.type}isTabbedBrowser(e){return"normal"===this.getState().get(e)?.type}isMinimalUI(e){return m(this.getState().get(e))}getMailWindowId(){let e=u;for(const[t]of this.getState())(e===u||t<e)&&this.isTabbedBrowser(t)&&!this.isIncognitoOrGuest(t)&&(e=t);return e}isMail(e){return this.getMailWindowId()===e}isGuest(){if(void 0===window.isGuestSession)throw new Error("WindowStore.isGuest() called before guest information has been set up");return window.isGuestSession}getVisibleUI(e){const t=this.getState().get(e);return t?t.visibleUI:this.getUIFromPrefs()}isIncognitoOrGuest(e){return this.isIncognito(e)||this.isGuest()}getRestoreStateFullscreen(e){const t=this.getState().get(e);if(!t)throw new Error("WindowStore.getRestoreStateFullscreen: Expected a valid windowId");return t.restoreStateFullscreen}getRestoreStateHtml5Fullscreen(e){const t=this.getState().get(e);if(!t)throw new Error("WindowStore.getRestoreStateHtml5Fullscreen: Expected a valid windowId");return t.restoreStateHtml5Fullscreen}getUIFromPrefs(){return{bookmarksBar:i.Z.get(c.kBookmarksBarVisible),addressBar:i.Z.get(c.kAddressBarVisible),panelToggle:i.Z.get(c.kPanelsShowToggle),tabs:i.Z.get(c.kTabsVisible),statusBar:i.Z.get(c.kStatusBarDisplay)}}getActiveWorkspace(e){return this.getState().get(e)?.activeWorkspaceId??void 0}}const f=new v(a.Z),y={_oldState:f.getState(),updateLastActiveBrowserWindowStack(e){this.removeFromLastActiveBrowserWindowStack(e),f.isTabbedBrowser(e)&&g.unshift(e)},removeFromLastActiveBrowserWindowStack(e){const t=g.indexOf(e);-1!==t&&g.splice(t,1)},recordState(){const e=this._oldState,t=f.getState();this._oldState=t;for(const[n]of e)t.has(n)||this.removeFromLastActiveBrowserWindowStack(n);for(const[n,s]of t){const t=e.get(n);(s.active&&!t?.active||0===g.length)&&this.updateLastActiveBrowserWindowStack(n),s.html5FullScreen||t&&s!==t&&(m(t)===m(s)&&("fullscreen"===t.state&&"fullscreen"===s.state||"fullscreen"!==t.state&&"fullscreen"!==s.state)&&t.visibleUI===s.visibleUI||(0,r.Z)(n,{minimalUI:s.minimalUI,fullScreen:"fullscreen"===s.state,visibleUI:s.visibleUI}))}}};f.addListener(y.recordState.bind(y));const C=f;function w(e){return e.html5FullScreen?"fullscreen inner":"fullscreen"===e.state?"fullscreen":"maximized"===e.state?"maximized":"normal"}},92:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var s=n(68247),i=n(29087),o=n(24602),a=n(89175),r=n(93513);class l extends o.Z{getInitialState(){return[]}getRules(){return this.getState()}getRuleById(e){return this.getState().find((t=>t.id===e))}getWorkspaceRules(e){return this.getState().filter((t=>t.workspaceId===e))}reduce(e,t){switch(t.actionType){case"WORKSPACE_LINK_ROUTES_INIT":return t.rules;case"CREATE_WORKSPACE_LINK_ROUTE":{const n=(0,r.Uy)(e,(e=>{e.push({id:t.id,type:t.type,expression:t.expression,workspaceId:t.workspaceId})}));return s.Z.set(a.kWorkspacesLinkRoutes,n),n}case"REMOVE_WORKSPACE_LINK_ROUTES":{const{ids:n}=t,i=e.filter((e=>!n.includes(e.id)));return s.Z.set(a.kWorkspacesLinkRoutes,i),i}case"UPDATE_WORKSPACE_LINK_ROUTE":{const n=(0,r.Uy)(e,(e=>{const n=e.findIndex((e=>e.id===t.id));n>-1&&e.splice(n,1,{id:t.id,type:t.type,expression:t.expression,workspaceId:t.workspaceId})}));return s.Z.set(a.kWorkspacesLinkRoutes,n),n}case"CREATE_WORKSPACE":{const n=(0,r.Uy)(e,(e=>{for(let n=0;n<e.length;n++)void 0===e[n].workspaceId&&(e[n].workspaceId=t.id)}));return s.Z.set(a.kWorkspacesLinkRoutes,n),n}case"REORDER_WORKSPACE_LINK_ROUTES":{const n=t.ids.map((t=>e.find((e=>e.id===t)))).filter(Boolean);return n.length===e.length?(s.Z.set(a.kWorkspacesLinkRoutes,n),n):(console.error("Sanity check failed after reordering workspace rules."),e)}case"UPDATE_LINK_ROUTES_FROM_PREFS":return i.Z.get(a.kWorkspacesLinkRoutes)}return e}}const d=new l},53454:(e,t,n)=>{"use strict";n.d(t,{S:()=>h,Z:()=>u});var s=n(96951),i=n(68247),o=n(24602),a=n(15489),r=n(69046),l=n(86088),d=n(89175),c=n(93513);const h=[l.xwB,l.T6H,l.Gyd,l.eTI,l.Bi0,l.S0Y,l.efb,l.XyR,l.gYX,l.b_H,l.$6R,l.o_8,l.V3h,l.LXK,l.rR8,l.onV,l.XkM,l.IrQ,l.mhq,l.BmN];class p extends o.Z{getInitialState(){return{workspaces:[],privateWorkspaces:[]}}getWorkspaces(e){return a.ZP.isIncognito(e)?this.getState().privateWorkspaces:this.getState().workspaces}getWorkspaceById(e,t){return this.getWorkspaces(e).find((e=>e.id===t))}getWindowId(e){return s.ZP.getWorkspacePages(e).first()?.windowId}getWorkspacePageCounts(e){const t=this.getWorkspaces(e),n=new Map(t.map((e=>[e.id,0])));for(const[,e]of s.ZP.getState())e.list.groupBy(r.cm).forEach(((e,t)=>{t&&n.set(t,e.size)}));return n}getDefaultIcon(){return l.BmN}reduce(e,t){switch(t.actionType){case"WORKSPACES_INIT":return{workspaces:[...t.workspaces],privateWorkspaces:[]};case"CREATE_WORKSPACE":{const n=(0,c.Uy)(e.workspaces,(e=>{e.push({id:t.id,name:t.name,icon:t.icon,emoji:t.emoji})}));return i.Z.set(d.kWorkspacesList,n),{...e,workspaces:n}}case"SET_WORKSPACE_NAME":{const n=(0,c.Uy)(e.workspaces,(e=>{const n=e.findIndex((e=>e.id===t.id));n>-1&&(e[n]={...e[n],name:t.name})}));return i.Z.set(d.kWorkspacesList,n),{...e,workspaces:n}}case"REMOVE_WORKSPACE":{const n=(0,c.Uy)(e.workspaces,(e=>{const n=e.findIndex((e=>e.id===t.id));n>-1&&e.splice(n,1)}));return i.Z.set(d.kWorkspacesList,n),{...e,workspaces:n}}case"SET_WORKSPACE_ICON":{const n=(0,c.Uy)(e.workspaces,(e=>{const n=e.findIndex((e=>e.id===t.id));n>-1&&(e[n]={...e[n],icon:h[t.icon],emoji:void 0})}));return i.Z.set(d.kWorkspacesList,n),{...e,workspaces:n}}case"SET_WORKSPACE_EMOJI":{const n=(0,c.Uy)(e.workspaces,(e=>{const n=e.findIndex((e=>e.id===t.id));n>-1&&(e[n]={...e[n],emoji:t.emoji})}));return i.Z.set(d.kWorkspacesList,n),{...e,workspaces:n}}case"REORDER_WORKSPACES":{const n=t.ids.map((t=>e.workspaces.find((e=>e.id===t)))).filter(Boolean);return n.length===e.workspaces.length?(i.Z.set(d.kWorkspacesList,n),{...e,workspaces:n}):e}case"CREATE_PRIVATE_WORKSPACE":{const n=(0,c.Uy)(e.privateWorkspaces,(e=>{e.push({id:t.id,name:t.name,icon:t.icon,emoji:t.emoji})}));return{...e,privateWorkspaces:n}}case"SET_PRIVATE_WORKSPACE_NAME":{const n=(0,c.Uy)(e.privateWorkspaces,(e=>{const n=e.findIndex((e=>e.id===t.id));n>-1&&(e[n]={...e[n],name:t.name})}));return{...e,privateWorkspaces:n}}case"REMOVE_PRIVATE_WORKSPACE":{const n=(0,c.Uy)(e.privateWorkspaces,(e=>{const n=e.findIndex((e=>e.id===t.id));n>-1&&e.splice(n,1)}));return{...e,privateWorkspaces:n}}case"SET_PRIVATE_WORKSPACE_ICON":{const n=(0,c.Uy)(e.privateWorkspaces,(e=>{const n=e.findIndex((e=>e.id===t.id));n>-1&&(e[n]={...e[n],icon:h[t.icon],emoji:void 0})}));return{...e,privateWorkspaces:n}}case"SET_PRIVATE_WORKSPACE_EMOJI":{const n=(0,c.Uy)(e.privateWorkspaces,(e=>{const n=e.findIndex((e=>e.id===t.id));n>-1&&(e[n]={...e[n],emoji:t.emoji})}));return{...e,privateWorkspaces:n}}case"REORDER_PRIVATE_WORKSPACES":{const n=t.ids.map((t=>e.privateWorkspaces.find((e=>e.id===t)))).filter(Boolean);return n.length===e.privateWorkspaces.length?{...e,privateWorkspaces:n}:e}}return e}}const u=new p},47825:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var s=n(24602),i=n(71828);class o extends s.Z{getInitialState(){return{zoom:i.rM,defaultPageZoom:i.rM,uiZoom:i.an,notesZoom:i.rM}}getZoom(){return this.getState().zoom}getDefaultPageZoom(){return this.getState().defaultPageZoom}getUIZoom(){return this.getState().uiZoom}getNotesZoom(){return this.getState().notesZoom}reduce(e,t){switch(t.actionType){case"ZOOM_PAGE":return{...e,zoom:t.zoomData};case"ZOOM_NOTES":return{...e,notesZoom:t.zoomData};case"ZOOM_SET_UI":return{...e,uiZoom:t.zoomData};case"ZOOM_PAGE_DEFAULT":return{...e,defaultPageZoom:t.zoomData}}return e}}const a=new o},44147:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var s=n(27770),i=n(48603),o=n(59486),a=n(46382),r=n(96951),l=n(60331),d=n(44850);const c={onAction:function(e,t){const n=function(e,t){i.Z.copy(t,[e])},s=function(e,t){i.Z.cut(t,[e])},l=function(e,t){i.Z.paste(t,e,!0)},d=o.ZP.getItemById(t.id);if(d){const c=void 0!==d.index?d.index+1:-1;switch(t.command){case"addactivetab":{const t=r.ZP.getActivePage(e);t&&(o.ZP.isFolder(d)?i.Z.bookmarkPageInFolder(t,d.id):i.Z.bookmarkPageInFolder(t,d.parentId||"",c));break}case"edit":a.Z.showBookmarkDialog(e,{mode:t.command,id:t.id,index:-1});break;case"addfolder":case"addbookmark":a.Z.showBookmarkDialog(e,{mode:t.command,id:t.id,index:c});break;case"addseparator":o.ZP.isFolder(d)?i.Z.createSeparator(t.id,d.children?d.children.length:0):d.parentId&&i.Z.createSeparator(d.parentId,c);break;case"cut":const h=s.bind(null,t.id);document.addEventListener("cut",h),document.execCommand("cut"),document.removeEventListener("cut",h);break;case"copy":const p=n.bind(null,t.id);document.addEventListener("copy",p),document.execCommand("copy"),document.removeEventListener("copy",p);break;case"paste":const u=l.bind(null,t.id);document.addEventListener("paste",u),document.execCommand("paste"),document.removeEventListener("paste",u)}}},onHover:function(e,t){l.Z.setStatus(e,d.jk.getHoverUrl(o.ZP.filterUrl(t)))},onOpen:function(e,t){const n=o.ZP.getItemById(t.id);if(n){const i=s.ZP.getOpenOptionsFromDisposition(e,t.disposition,t.background,s.ZP.makeEventFlagsFromApiResponse(t.state));s.ZP.open(e,s.ZP.getBookmarksByNode(n),i,!0)}}}},57082:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var s=n(34155);const i=Array();const o={onCommand:function(e,t){s.nextTick((()=>{i.forEach((n=>{n.name===t&&n.callback(e,t)}))}))},hasListener:function(e){return i.filter((t=>t.name===e)).length>0},addListener:function(e,t){-1===i.findIndex((n=>n.name===e&&n.callback===t))&&i.push({name:e,callback:t})},removeListener:function(e,t){const n=i.findIndex((n=>n.name===e&&n.callback===t));-1!==n&&i.splice(n,1)}}},84451:(e,t,n)=>{"use strict";n.d(t,{Z:()=>I});var s=n(45502),i=n(96951),o=n(29087),a=n(15489),r=n(49550),l=n(7064),d=n(89175);let c="off";var h=["f1","f2","f3","f4","f5","f6","f7","f8","f9","f10","f11","f12","f13","f14","f15","f16","f17","f18","f19"],p={delete:"del",option:"alt",command:"meta",return:"enter",escape:"esc",comma:",",period:".",del:"del",mod:"ctrl"},u=["left","right","shift+left","shift+right","shift+up","shift+down","enter","shift+enter"];u=u.concat(["ctrl+a","ctrl+z","ctrl+y","ctrl+u","ctrl+left","ctrl+right","ctrl+backspace","ctrl+delete","ctrl+home","ctrl+end","ctrl+shift+left","ctrl+shift+right","shift+home","shift+end"]);const g={};function m(e){var t=e.split("+");t=t.map((e=>p[e]||e));var n="";function s(e){t.indexOf(e)>-1&&(n+=e+"+",t.splice(t.indexOf(e),1))}return s("ctrl"),s("alt"),s("shift"),s("meta"),t.sort(),t.forEach(((e,s)=>{n+=e,s+1<t.length&&(n+="+")})),n.toLowerCase()}function v(e){return{ctrlKey:-1!==e.indexOf("ctrl"),altKey:-1!==e.indexOf("alt"),metaKey:-1!==e.indexOf("meta"),shiftKey:-1!==e.indexOf("shift"),key:e.split("+").pop()}}function f(e,t,n,s){s({origin:"shortcut",context:e,windowId:t,keyState:n})}function y(e){return 1===e.length||e.startsWith("numpad")}function C(e){var t=v(e),n=e.split("+").pop();if(-1!==u.indexOf(e))return!1;if("esc"===n||"down"===n||"up"===n||"home"===n||"end"===n||"pagedown"===n||"pageup"===n)return!0;if(h.indexOf(n)>-1)return!0;if(t.ctrlKey||t.altKey||t.shiftKey||t.metaKey){if("backspace"===n||"del"===n)return!0;if(t.ctrlKey||t.metaKey||t.altKey)return!0}return!1}const w=["INPUT","FRAME","IFRAME","SELECT","TEXTAREA"],b=["submit","button","reset","radio","checkbox"],S=["chrome://game/","docs.google.com"];const I={bind:function(e,t,n){const{autoRepeat:s,isFeatureShortcut:i,isEnabled:o,feature:a}=n??{};return[].concat(e).filter(Boolean).map((e=>e.trim())).forEach((e=>function(e,t,n,s,i,o){const a=m(e),r=g[a]||[];r.push({callback:s,onAutoRepeat:Boolean(t),isFeatureShortcut:Boolean(n),isEnabled:i||(e=>!0),feature:o||"browser"}),g[a]=r}(e,s,i,t,o,a))),this},unbind:function(e,t){return[].concat(e).forEach((e=>function(e,t){if(e){const n=m(e);g[n]&&(t?g[n]=g[n].filter((e=>e.callback!==t)):delete g[n])}}(e,t))),this},keyComboFromEvent:function(e){if(!(["Alt","Shift","Control","Meta","CapsLock","NumLock","AltGraph"].indexOf(e.key)>-1)&&"keydown"===e.type){const t=function(e){if(e.code.startsWith("Numpad")){var t=r.Z[e.keyCode].substr(6);if(t>="0"&&t<="9")return e.code}return r.Z[e.keyCode]}(e);if("None"===t)return"";{let n=function(e){var t="";return e.metaKey&&(t+="meta+"),e.altKey&&(t+="alt+"),e.ctrlKey&&(t+="ctrl+"),e.shiftKey&&(t+="shift+"),t}(e);return n+=t,m(n.toLowerCase())}}return""},shortcutAllowedInText:C,isSingleKeyShortcut:y,setDevToolsDockingState:function(e){c=e},handleShortcut:function(e,t,r,c,h){const p=e.vivaldiWindowId;let u=t.toLowerCase().replace(" ","");u.endsWith("arrow")&&(u=u.substring(0,u.length-5)),u=m(u);const I=function(e,t){const n=g[e];if(n?.length)return n.reduce(((e,n)=>e||"browser"!==n.feature?n.feature===t?n:e:n),null)}(u,s.Z.getContext(p).feature);if(I){if(!I.isEnabled(p))return;if(!0===r&&!1===I.onAutoRepeat)return;!async function(e,t,r,c,h,p){const u=e.vivaldiWindowId;if(y(r)){if(c){if(!o.Z.get(d.kKeyboardShortcutsEnableSingleKeyForMail))return;if("browser"===s.Z.getContext(u).feature)return}else if(!o.Z.get(d.kKeyboardShortcutsEnableSingleKey))return;const e=i.ZP.getActivePage(u);if(e)for(const t of S)if(e.url.includes(t))return}if(a.ZP.isSettings(u)&&!n(15544).Z.isShortcutWhitelisted(u,r))return;if(!o.Z.get(d.kKeyboardShortcutsEnable)){const e=(await n(15544).Z.getAllCommands(u)).find((e=>"COMMAND_PAGE_DISABLE_KEYBOARD_SHORTCUTS"===e.name));if(!e)return;const t=n(15544).Z.getCommandConfiguration(e.name);if(!Array.isArray(t.shortcuts)||!t.shortcuts.some((e=>e===r)))return}const g=h?h.tagName:"",m=h instanceof e.HTMLInputElement?h.type:"",I=!!h&&h.isContentEditable;w.includes(g)&&!b.includes(m)||I?C(r)&&f(e,u,v(r),t):"WEBVIEW"===g?l.Z.windowPrivate.getFocusedElementInfo(u).then((({tagName:n,editable:s,role:i})=>{if(!s||C(r)){const s="SELECT"===n,o="SPAN"===n&&"spinbutton"===i;(!s&&!o||s&&C(r))&&f(e,u,v(r),t)}})):f(e,u,v(r),t)}(e,I.callback,u,I.isFeatureShortcut,h)}}}},5198:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>m,ky:()=>p});var s=n(9761),i=n(19789),o=n(68247),a=n(29087),r=n(85374),l=n(56371),d=n(7064),c=n(36436),h=n(89175);const p=2e3;let u=[];const g={canTranslateText(e,t="",n=-1){return!(n>=0&&!a.Z.get(h.kPanelsTranslateRedirect)&&!this.canTranslatePage(n,!0))&&Boolean(e.length>4&&!(0,c.xl)(t))},canTranslatePage(e,t=!1){const n=r.ZP.getPageState(e);return t?Boolean(n.pageLanguage):Boolean(n.pageLanguage)&&!n.isTranslated},getTranslationCode:(e=i.ZP.UI_LANGUAGE)=>s.YI[e]||e,getTargetTranslationCode(){return a.Z.get(h.kTranslateTargetLanguage)||this.getTranslationCode()},setTargetTranslationCode(e){o.Z.set(h.kTranslateTargetLanguage,e)},getTranslationLocales(){if(!u.length){const e=a.Z.get(h.kVivaldiTranslateLanguageList);u=e.map((e=>{"es-ES"===(e=s.jq[e]??e)&&(e="es");let t=s.lE.find((t=>t.key===e));return t||(t=s.sK.find((t=>t.key===e))),t})).filter(Boolean).sort(((e,t)=>e.value.localeCompare(t.value)))}return u},getHumanReadableLanguageFromCode(e){const t=g.getTranslationLocales().find((t=>{const n=g.getTranslationCode(t.key);return t.key===e||n===e}));return t?t.value:(0,l.Z)("Unknown ($1)",[e])},async detectTextLanguage(e,t){let n=await d.Z.tabsPrivate.determineTextLanguage(e,t);return"und"===n&&(n=""),n}},m=g},76747:(e,t,n)=>{"use strict";n.d(t,{Z:()=>A});var s=n(15544),i=n(45502),o=n(84451),a=n(29087),r=n(56371),l=n(7064),d=n(13302),c=n(89175);let h,p="";function u(){return(0,r.Z)("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefhiklmnorstuvwxz")}function g(){return void 0===h&&(h=["zh-CN","zh-TW","ja","ko"].indexOf(p)>-1),h}function m(e){const t=e.indexOf("&");if(-1===t||" "===e[t+1])return-1===t?-1:-2;if("&"!==e[t+1])return t;let n=1;for(let s=t+1;s<e.length&&"&"===e[s];s++)n++;return n%2==0?-1:t}function v(e,t,n,s,i){let o=0;for(;-1!==o;){const i=t.charAt(o),a=i.toUpperCase();if(-1!==s.indexOf(i)&&-1===e.indexOf(a)&&(0!==o&&!0!==n||i===a))return o;o=t.indexOf(" ",o+1),-1!==o&&o++}for(let n=0;n<t.length;n++){const i=t.charAt(n);if(-1!==s.indexOf(i)&&-1===e.indexOf(i.toUpperCase()))return n}return i?-1:v("",t,n,s,!0)}function f(e){return!!i.Z.isBrowserFeature(e.feature)||!e.commandName}function y(){return{enabled:a.Z.get(c.kKeyboardShortcutsEnable),singleKey:a.Z.get(c.kKeyboardShortcutsEnableSingleKey),mailSingleKey:a.Z.get(c.kKeyboardShortcutsEnableSingleKeyForMail)}}function C(e,t){if(t.enabled&&e.shortcuts&&!1!==e.showshortcut)for(let n=0;n<e.shortcuts.length;n++){const s=e.shortcuts[n];if(o.Z.isSingleKeyShortcut(s))if(f(e)){if(!1===t.singleKey)continue}else if(!1===t.mailSingleKey)continue;if(0!==s.length)return(0,d.G)(s)}return""}function w(e){return"separator"===e.type}function b(e){return"folder"===e.type}function S(e){return{label:e,labelEnglish:e}}function I(){return(0,r.Z)("...")}const k={commandItem:{type:"command",label:"",labelEnglish:""},ellipsisString:I,hasBrowserFeature:f,formatShortcut:function(e,t){return C({commandName:e,shortcuts:t,...S("")},y())},getDisplayName:function(e){if(w(e))return"";let t=e.labelWithMnemonic||e.label||"";return e.emphasized&&(t=`• ${t}`),e.ellipsis?t+I():t},getMenuBarString:function(e,t){if(!e.label)return{name:"",offset:-1};let n=e.label;const s=void 0===t.offset?-1:t.offset,i=m(n);if(i>=0&&(n=n.substring(0,i)+n.substring(i+1)),g()&&-1!==s){let t=e.labelEnglish;const i=m(t);i>=0&&(t=t.substring(0,i)+t.substring(i+1)),n=n+" ("+t.charAt(s).toUpperCase()+")"}return{name:n,offset:s}},getShortcut:C,getShortcutSettings:y,getShortcutsForSubMenus:function(e){const t=Object.keys(s.Z.getCommandsForShortcuts()).filter((e=>e.includes("alt+")&&5===e.length)),n=u(),i=a.Z.get(c.kKeyboardShortcutsAltOpensMenu),o=[],r=[];e.forEach((e=>{if(!1!==e.mnemonic&&e.label&&!w(e)){const t=e.label.indexOf("&");if(-1!==t&&t+1<e.label.length){const n=e.label.toUpperCase().charCodeAt(t+1);-1===o.indexOf(n)&&o.push(n)}}}));for(let s=0;s<e.length;s++){const a=e[s];if(!a.label||!b(a)||!1===i||!1===a.mnemonic){r.push({index:s});continue}const l=g()?a.labelEnglish:a.label;if(void 0===l){r.push({index:s});continue}if(o.length>0){const e=l.indexOf("&");if(-1!==e&&e+1<l.length){const n=l.toUpperCase().charCodeAt(e+1),i=String.fromCharCode(n).toLowerCase(),o="alt+"+i;t.includes(o)?r.push({index:s,key:i,offset:e}):(r.push({index:s,shortcut:o,key:i,offset:e}),t.push(o));continue}}let d=!1;for(let e=0;e+1<l.length&&!d;e++){const i=l.toUpperCase().charCodeAt(e);if(-1!==o.indexOf(i))continue;const a=String.fromCharCode(i).toLowerCase();if(-1===n.indexOf(a))continue;const c="alt+"+a;t.includes(c)||(r.push({index:s,shortcut:c,key:a,offset:e}),t.push(c),d=!0)}d||r.push({index:s})}return r},installMnemonics:function e(t,n){const s=u(),i=0===p.indexOf("en"),o=g();let a="";for(let e=0;e<t.length;e++){const s=t[e];if(s.label)if(w(s)||!1===s.mnemonic){if(!1===s.mnemonic){const e=m(s.label);(e>=0||-2===e)&&(s.labelWithMnemonic=s.label.replace(/\&/g,"&&"))}}else if(n.length>e){const t=o?s.labelEnglish:s.label;let i=n[e].offset;void 0!==i&&i+1<=s.label.length?("&"===s.label[i]?s.labelWithMnemonic=s.label:s.labelWithMnemonic=o?s.label+" (&"+t.charAt(i).toUpperCase()+")":s.label.slice(0,i)+"&"+s.label.slice(i),a+=s.label.charAt(i+1).toUpperCase()):(i=s.label.indexOf("&"),s.labelWithMnemonic=-1!==i?s.label:void 0)}else{const e=m(s.label);e>=0&&e+1<s.label.length?(s.labelWithMnemonic=s.label,a+=s.label.charAt(e+1).toUpperCase()):s.labelWithMnemonic=-2===e?s.label.replace(/\&/g,"&&"):void 0}}for(let n=0;n<t.length;n++){const r=t[n];if(!r.label)continue;const l=o?r.labelEnglish:r.label;if(void 0!==l&&!w(r)&&!1!==r.mnemonic&&void 0===r.labelWithMnemonic){const e=v(a,l,i,s,!1);e>=0&&(a+=l.charAt(e).toUpperCase(),r.labelWithMnemonic=o?r.label+" (&"+l.charAt(e).toUpperCase()+")":r.label.slice(0,e)+"&"+r.label.slice(e))}r.items&&e(r.items,[])}},isSeparator:w,loadPromise:function(){return new Promise((e=>{l.Z.utilities.getLanguage((t=>{p=t,e()}))}))},makeLabelPair:S,makeNumberMnemonic:function(e,t){const n=t<9&&!0;if(n){return{...S("&"+(t+1)+" "+e.replace(/\&/g,"&&")),mnemonic:n}}return{...S(e),mnemonic:n}},separatorItem:{type:"separator",label:"",labelEnglish:""}},A=k},40893:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var s=n(96951),i=n(29087),o=n(39206),a=n(2004),r=n(15489),l=n(7064),d=n(89175);const c={withPageSelection:async function(e,t){const n=s.ZP.unsafeGetActivePage(e).id,i=await l.Z.utilities.getSelectedText(n),a=t?t.id:o.Z.getDefault(r.ZP.isIncognito(e))?.id;a&&await c.withTextAndEngine(e,i,a)},withTextAndEngine:async function(e,t,n){const s=o.Z.getById(n);if(t&&s){const n=i.Z.get(d.kPageSearchInBackground);await a.Z.goSearchUrl(e,t,{inCurrent:r.ZP.isPopup(e),inBackground:n,useSearchEngine:s,addOpenerTabId:!0})}}},h=c},19486:(e,t,n)=>{"use strict";n.d(t,{Z:()=>b,t:()=>f});var s=n(65792),i=n.n(s),o=n(93197),a=n(9719),r=n(27856),l=n.n(r),d=n(29087),c=n(47825),h=n(42568),p=n.n(h),u=n(65741),g=n(89175),m=n(93513);const v=["center","top","right","bottom","left"];function f(e){const t=(new TextDecoder).decode(e),n=l().sanitize(t,{USE_PROFILES:{svg:!0,svgFilters:!0},FORBID_TAGS:["style"],ADD_TAGS:["feDropShadow"],ADD_ATTR:["from","to"]});if(!n.startsWith("<svg "))throw new Error("ThemeUtils: Malformed SVG file");return(new TextEncoder).encode(n)}function y(e,t,n,s,i){let o;for(let a=0;a<e[t].length;a++){const r=e[t][a];if(n===r[0]&&s===r[1]&&i===r[2]){o=a;break}}void 0===o?e[t].push([n,s,i,1]):e[t][o][3]++}function C(e){return 60*e.hours+e.minutes}const w={getDefaultTheme:()=>d.Z.getDefault(g.kThemesSystem)[0],getFallbackStyle:()=>w.createStyle(w.getDefaultTheme()),getTheme:e=>{const t=d.Z.get(g.kThemesPreview),n=w.getSystemThemes(),s=d.Z.get(g.kThemesUser);return t.concat(n.concat(s)).find((t=>t?.id===e))},getThemeWithFallback:e=>e&&w.getTheme(e)||w.getDefaultTheme(),getPreview:()=>d.Z.get(g.kThemesPreview)&&d.Z.get(g.kThemesPreview)[0],getSystemThemes:()=>(0,m.Uy)(d.Z.get(g.kThemesSystem),(e=>{const t=d.Z.get(g.kThemesSystem);e.forEach(((n,s)=>{const i=t.find((e=>e.id===n.id));i&&(e[s]=i)}))})),getWindowBackgroundColor:e=>{const t=String(e["--colorBg"]);if(i().valid(t))return i()(t);console.warn(`getWindowBackgroundColor: Unable to find style for ${t}`)},getImageVars:p()((async(e,t)=>{const n={backgroundImage:"unset"};if(e)try{const s=await async function(e){const t=document.createElement("img"),n=new Promise(((e,n)=>{t.addEventListener("load",e,{once:!0}),t.addEventListener("error",n,{once:!0})}));return t.src=e,await n,t}(e),a=s.naturalHeight,r=s.naturalWidth,l=function(e){const t=document.createElement("canvas"),n=t.getContext("2d"),s=16,o=[15,31,47,63,79,95,111,127,143,159,175,191,207,223,239,255],a={center:[],top:[],right:[],bottom:[],left:[]};t.width=s,t.height=s,n.imageSmoothingEnabled=!1,n.drawImage(e,0,0,s,s);const r=n.getImageData(0,0,s,s).data;for(let e=0;e<r.length/4;e++){const t=4*e,n=r[t],i=r[t+1],l=r[t+2],d=o.includes(e),c=e>240,h=!d&&e%s==0;y(a,!c&&e<s?"top":c?"bottom":d?"right":h?"left":"center",n,i,l)}return v.reduce(((e,t)=>{a[t].sort(((e,t)=>t[3]-e[3]));const n=a[t][0];return e[t]=i()(n[0],n[1],n[2]),e}),{})}(s);switch(Object.assign(n,function(e){return Object.entries(e).reduce(((e,[t,n])=>{const s=t[0].toUpperCase()+t.slice(1),a=n.luminance()>o.$J,r=i().mix(n,a?o.Cj:o.E5),l=a?o.E5:o.Cj;return e[`--colorImage${s}Fg`]=l.css(),e[`--colorImage${s}FgAlpha`]=l.alpha(.6).css(),e[`--colorImage${s}FgAlphaHeavy`]=l.alpha(.05).css(),e[`--colorImage${s}Bg`]=r.css(),e[`--colorImage${s}BgAlpha`]=a?r.alpha(.55).css():r.alpha(.55).brighten(1).css(),e[`--colorImage${s}BgAlphaHeavy`]=a?r.alpha(.35).css():r.alpha(.35).brighten(1).css(),e}),{})}(l)),n.backgroundImage=`url("${e}")`,t){case"stretch":n.backgroundSize="cover";break;case"center":n.backgroundSize=`${r}px ${a}px`,n.backgroundRepeat="no-repeat";break;case"repeat":n.backgroundSize=`${r}px ${a}px`,n.backgroundPosition="50% 0"}}catch(t){console.error("Error loading background image",e)}return n}),{maxSize:40}),createStyleRoot:e=>":root {"+Object.entries(e).filter((([e,t])=>e.startsWith("--"))).map((([e,t])=>`${e}:${String(t)}`)).join(";")+";}",getPalette:(e,t)=>{const n=document.createElement("canvas"),s=t||16,i=n.getContext("2d"),o=[],a=[];n.width=s,n.height=s,i.imageSmoothingEnabled=!1,i.drawImage(e,0,0,s,s);const r=i.getImageData(0,0,s,s).data;for(let e=0;e<r.length/4;e++){const t=4*e,n=r[t],s=r[t+1],i=r[t+2];let a;if(!(0===r[t+3]||n>240&&i>240&&s>240)){for(let e=0;e<o.length;e++)if(n===o[e][0]&&s===o[e][1]&&i===o[e][2]){a=e;break}void 0===a?o.push([n,s,i,1]):o[a][3]++}}o.sort(((e,t)=>t[3]-e[3]));for(let e=0;e<Math.min(10,o.length);e++)a.push([o[e][0],o[e][1],o[e][2]]);return a},getTimerByDate:(e,t)=>{const n=60*e.getHours()+e.getMinutes(),s=d.Z.get(g.kThemeScheduleTimeline),i="next"===t?s.reduce(((e,t)=>[...e,t,{...t,hours:t.hours+24}]),[]).sort(((e,t)=>C(e)-C(t))).find((({hours:e,minutes:t})=>60*e+t>n)):s.reduce(((e,t)=>[...e,t,{...t,hours:t.hours-24}]),[]).sort(((e,t)=>C(t)-C(e))).find((({hours:e,minutes:t})=>60*e+t<=n));if(!i)throw new Error("ThemeUtilities: Error getting theme schedule.");return i},convertColorsToVariables:e=>{const t={};return Object.keys(e).forEach((n=>{t[`--${n}`]=e[n]})),t},createStyle:e=>{const t={...o.ZP.forTheme(e),...(0,a.ZP)(e.radius,d.Z.get(g.kThemeSimpleScrollbar))},n={};return e.transparencyTabBar?n["--colorTabBar"]="transparent":e.accentOnWindow?n["--colorTabBar"]="var(--colorAccentBg)":e.accentOnWindow||(n["--colorTabBar"]="var(--colorBg)"),Object.keys(t).forEach((e=>{n[`--${e}`]=t[e].toString()})),n["--uiZoomLevel"]=c.Z.getUIZoom(),n},isThemeDark:e=>{const t=e["--colorBg"];return void 0!==t?i()(t).luminance()<=o.$J:(console.warn("Unable to determine if theme is dark",{style:e}),!1)},isThemeHighlightDark:e=>{const t=e["--colorHighlightBg"];return void 0!==t?i()(t).luminance()<=o.$J:(console.warn("Unable to determine if theme highlight is dark",{style:e}),!0)},isThemeAccentDark:(e,t,n)=>{const s=e["--colorAccentBg"],a=e["--colorImageTopBg"];return!(!a||!s)&&(n&&t&&(i().blend(a,s,"multiply").luminance(),o.$J),i()(s).luminance()<=o.$J)},isThemeBackgroundImageDark:(e,t,n)=>{const s=e["--colorImageTopBg"],a=e["--colorAccentBg"];return!(!s||!a)&&(n&&t?i().blend(s,a,"multiply").luminance()<=o.$J:i()(s).luminance()<=o.$J)},isSystemThemeModified:e=>{const t=d.Z.getDefault(g.kThemesSystem).find((t=>t.id===e.id));return t||console.warn(e.id,"is not a valid system theme"),(0,u.Z)(e,t)},createClassnames:(e,t)=>{let n,s,i;return t?(n=w.isThemeDark(t),s=w.isThemeAccentDark(t,e.accentFromPage,e.transparencyTabBar),i=w.isThemeBackgroundImageDark(t,e.accentFromPage,e.transparencyTabBar)):(n=!1,s=!1,i=!1),{"theme-light":!n,"theme-dark":n,"acc-light":!s,"acc-dark":s,"bg-light":!i,"bg-dark":i,"color-behind-tabs-on":e.accentOnWindow,"color-behind-tabs-off":!e.accentOnWindow,"color-accent-from-page":e.accentFromPage,"ui-transparent-tabs":e.transparencyTabs,"transparent-tabbar":e.transparencyTabBar,[`theme-id-${e.id}`]:!0}}},b=w},93974:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var s=n(7064),i=n(77398);const o=(e=2,t)=>(n,s)=>{if(e<=1)return 0;if(t&&(n=(0,i.Z)(n,t),s=(0,i.Z)(s,t)),!n&&!s)return 0;if(!n&&0!==n)return 2===e?1:-1;if(!s&&0!==s)return 2===e?-1:1;if("number"==typeof n&&"number"==typeof s)return 2===e?n-s:s-n;const o=n.toString().localeCompare(s.toString());return o>0?2===e?1:-1:o<0?2===e?-1:1:0},a={treeSort:function(e,t=o(),n="children"){const s=e=>{for(const t of e){const e=t[n];Array.isArray(e)&&s(e)}e.sort(t)};s(e)},getDefaultComparator:o,toMenuSorting:function(e,t){let n,i;if(e===a.ASCENDING_SORT?n=s.Z.menubarMenu.SortOrder.ASCENDING:e===a.DESCENDING_SORT&&(n=s.Z.menubarMenu.SortOrder.DESCENDING),void 0!==n)switch(t){case"title":i=s.Z.menubarMenu.SortField.TITLE;break;case"url":i=s.Z.menubarMenu.SortField.URL;break;case"nickname":i=s.Z.menubarMenu.SortField.NICKNAME;break;case"description":i=s.Z.menubarMenu.SortField.DESCRIPTION;break;case"dateadded":i=s.Z.menubarMenu.SortField.DATEADDED}return{order:n,field:i}},NO_SORTING:1,ASCENDING_SORT:2,DESCENDING_SORT:3},r=a},19626:(e,t,n)=>{"use strict";n.d(t,{Fe:()=>l,fs:()=>r,pg:()=>d});var s=n(53576),i=n(7064),o=n(36436);const a=["ad_blocking","tracking"],r=(e,t,n,i)=>{const o={tracking:{process:!1,exempt:!1},ad_blocking:{process:!1,exempt:!1}};if(parseInt(t)!==i)switch(t){case"0":o.tracking.exempt=!0,o.ad_blocking.exempt=!0;break;case"1":o.tracking.process=!0,o.ad_blocking.exempt=!0;break;case"2":o.tracking.process=!0,o.ad_blocking.process=!0}Object.keys(o).forEach((t=>{o[t].process?c(e,t,"process_list"):h(e,t,"process_list"),o[t].exempt?c(e,t,"exempt_list"):h(e,t,"exempt_list")})),"number"==typeof n&&s.ZP.reloadPage(n)},l=(e,t,n)=>{if((0,o.xl)(t))return;const{hostname:s}=new URL(t);i.Z.contentBlocking.getAllExceptionLists((t=>{let i=0;a.forEach((e=>{t[e].process_list.find((e=>{s.includes(e)&&i++}))}));let o="0";switch(n){case"ad_blocking":o=0===i||1===i?"2":"0";break;case"tracking":o=2===i||0===i?"1":"0";break;default:return}r(s,o,e)}))},d=(e,t)=>{i.Z.contentBlocking.getActiveExceptionsList(e,(n=>{t({["tracking"===e?"trackerBlockingEnabled":"adBlockingEnabled"]:"exempt_list"===n})}))},c=(e,t,n)=>{i.Z.contentBlocking.addExceptionForDomain(t,n,e)},h=(e,t,n)=>{i.Z.contentBlocking.removeExceptionForDomain(t,n,e)}},84675:(e,t,n)=>{"use strict";n.d(t,{Z:()=>f});var s=n(29717),i=n(21838),o=n(96951),a=n(68247),r=n(29087),l=n(56371),d=n(7064),c=n(16152),h=n(89175),p=n(89555),u=n(8684);const g="VIVALDI_CAPTURE_IMAGE_TO_CLIPBOARD";let m;const v={captureActivePage:async(e,t)=>{const n=o.ZP.getActivePage(e);if(n){const e=r.Z.get(h.kWebpagesCaptureCompressionFormat),{success:s}=await v.captureFullpage(n.id,e,t);s&&"clipboard"===t&&(0,u.c)({title:(0,l.Z)("Page Captured"),body:(0,l.Z)("Image stored in the clipboard."),tag:g})}},captureArea:async(e,t)=>{s.Z.enableCapture(e);try{return a.Z.set(h.kWebpagesCaptureSaveLocation,t),await v.beginCaptureArea()}catch(e){return""}},captureFullpage:(e,t,n)=>{const s={encodeFormat:t,encodeQuality:85,fullPage:!0,height:3e4,saveToDisk:"file"===n,showFileInPath:"file"===n,copyToClipboard:"clipboard"===n,saveFilePattern:r.Z.get(h.kWebpagesCaptureSaveFilePattern)};return new Promise((t=>{d.Z.thumbnails.captureTab(e,s,((e,n)=>{t({success:e,image:n})}))}))},beginCaptureArea:()=>new Promise(((e,t)=>{m?t("Capture in Progress"):m=(n,s)=>{n&&t("Capture Cancelled"),e(s)}})),performCapture:(0,c.Z)((e=>{const{windowId:t,mode:n,opts:i,noteId:o}=e;v.beginCaptureArea().then((e=>{v.handleCaptureLocation({windowId:t,mode:n,base64:e,noteId:o})})).catch(p.Z),s.Z.disableCapture(t),v.doCapture(t,i)}),25),doCapture:(e,t)=>{const{x:n,y:s,width:i,height:o}=t,a=r.Z.get(h.kWebpagesCaptureSaveLocation),l=r.Z.get(h.kWebpagesCaptureCompressionFormat),c=r.Z.get(h.kWebpagesCaptureSaveFilePattern),p="note"===a,u="clipboard"===a;d.Z.thumbnails.captureUI({windowId:e,posX:n,posY:s,width:i,height:o,encodeFormat:l,encodeQuality:85,saveToDisk:!0!==p,showFileInPath:!0!==p,copyToClipboard:u,saveFilePattern:c},((e,t)=>{m&&(m(!e,t),m=void 0)}))},handleCaptureLocation:async e=>{const{windowId:t,mode:n,base64:s,noteId:o}=e,a=r.Z.get(h.kWebpagesCaptureSaveLocation);if("clipboard"===a){const e="area"===n?(0,l.Z)("Area Captured"):(0,l.Z)("Page Captured");(0,u.c)({title:e,body:(0,l.Z)("Image Stored in the Clipboard"),tag:g})}else"note"===a&&s&&(o?(i.Z.addScreenshotToNote(t,o,s),v.cancelCallback(t)):await i.Z.createNoteFromCapture(t,s))},cancelCallback:e=>{s.Z.disableCapture(e),m&&(m(!0,""),m=void 0)},captureFromNote:async(e,t)=>{s.Z.enableCapture(e,t),a.Z.set(h.kWebpagesCaptureSaveLocation,"note")}},f=v},21191:(e,t,n)=>{"use strict";n.d(t,{Ed:()=>h,Jq:()=>l,jD:()=>c});var s=n(39005),i=n(30626),o=n(87159),a=n(7064),r=n(4668);function l(e,t){const n=s.Z.getRaw();if(n){const e=s.Z.getActiveListEntry(),t=e?(0,r.BZ)(e.subject):"message";n.saveAs(t+".eml")}else i.Z.getActiveWebView(e)&&a.Z.utilities.savePage(t)}const d=["COMMAND_NEW_BACKGROUND_TAB_LINK","COMMAND_NEW_TAB_LINK"];function c(e){return d.includes(e)}function h(e){return"COMMAND_PROXY_TOGGLE"===e&&!o.ZP.getSupportsProxy()}},47380:(e,t,n)=>{"use strict";n.d(t,{Z:()=>b,m:()=>m});var s=n(44147),i=n(76747),o=n(65810),a=n(62077),r=n(72536),l=n(92292),d=n(26591),c=n(86635),h=n(68551),p=n(13253),u=n(89661),g=n(7064);const m=(e,t)=>({origin:e,context:t,windowId:t.vivaldiWindowId,keyState:{ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,key:""}});let v={x:0,y:0,width:0,height:0},f="topLeft",y=!1,C="none",w=null;const b=function(e,t,n,m="pointer",b,S=-1,I){const k=i.Z.getShortcutSettings(),A=e.vivaldiWindowId;let T=0;const Z=new Map,E=function(t){const n=Z.get(t.id);if(n){const s={origin:"menu",context:e,windowId:A,keyState:{shiftKey:t.state.shift,ctrlKey:t.state.ctrl,altKey:t.state.alt,metaKey:t.state.command,key:""},menuData:I};t.state.left?s.button=0:t.state.right?s.button=2:t.state.center&&(s.button=1),n(s)}},_=function(e){C="none",s.Z.onHover(A,""),g.Z.menubarMenu.onOpen.removeListener(M),g.Z.menubarMenu.onClose.removeListener(N),g.Z.menubarMenu.onHover.removeListener(s.Z.onHover),g.Z.menubarMenu.onAction.removeListener(E);const t=w;t&&(w=null,e||t())},M=function(){C="shown","function"==typeof n&&n(!0)},N=function(){"function"==typeof n&&n(!1),_(!1)},P=function(e){return e.filter((e=>!e.isVisible||e.isVisible(A,!1))).map((e=>{const t={};if(i.Z.isSeparator(e))t.separator={};else if("container"===e.type){if(e.container)switch(e.container.content){case"extensions":case"imageinprofile":case"linkinprofile":case"linktohighlight":case"notes":case"pwa":case"linkinpwa":case"sendpagetodevices":case"sendlinktodevices":case"speech":case"spellcheck":case"spellcheckoptions":const n=T++;t.container={id:n,content:e.container.content,mode:e.container.mode||"folder",name:i.Z.getDisplayName(e)};break;default:console.warn("Unknown container content",e.container.content)}}else{const n=T++,s=i.Z.getDisplayName(e);let o,a;switch(e.handler&&(s||e.url)&&Z.set(n,e.handler),e.commandName&&0===e.commandName.indexOf("DOCUMENT_")&&(o=e.commandName),(e.iconPNG||e.iconPNGWhite)&&(a=[e.iconPNG||"",e.iconPNGWhite||""]),e.persistent&&(y=!0),e.type){case"checkbox":case"radio":t.item={id:n,action:o,name:s,type:e.type,radiogroup:e.radiogroup?e.radiogroup:-1,checked:!(!e.checked||e.statestrings)&&e.checked,shortcut:i.Z.getShortcut(e,k),showshortcut:e.showshortcut,url:e.url,enabled:!e.isEnabled||e.isEnabled(A),persistent:e.persistent,icons:a};break;default:t.item={id:n,action:o,name:s,type:e.items?"folder":"command",shortcut:i.Z.getShortcut(e,k),showshortcut:e.showshortcut,url:e.url,enabled:!e.isEnabled||e.isEnabled(A),persistent:e.persistent,icons:a},e.items&&(t.children=P(e.items))}}return t}))},D=function(e){if("none"!==C)return void("shown"===C?w=D.bind(null,e):console.error("Attempt to show another context menu while one is initializing"));const n="function"==typeof t?t():t;if(0!==n.length){C="initializing",i.Z.installMnemonics(n,[]),g.Z.menubarMenu.onOpen.addListener(M),g.Z.menubarMenu.onClose.addListener(N),g.Z.menubarMenu.onHover.addListener(s.Z.onHover),g.Z.menubarMenu.onAction.addListener(E);try{y="pointer"!==m;const e=P(n);g.Z.contextMenu.show({windowId:A,documentId:S,forceViews:y,rect:v,origin:f,icons:[d.Z,c.Z,h.Z,p.Z,u.Z,a.Z,r.Z],children:e},(()=>{const e=l.Z.runtime.lastError;e&&(console.error(e.message),_(!0))}))}catch(e){console.error(e)}}};return function(e){e&&e?.nativeEvent?.path?.find((e=>"vivaldi-tooltip"===e.id))||o.Z.hideTooltip(),e&&(e.persist(),e.preventDefault(),e.stopPropagation());if(v={x:0,y:0,width:0,height:0},f=m,"pointer"===m)v.x=e?e.clientX:0,v.y=e?e.clientY:0;else{let t=b?b.getBoundingClientRect():null;!t&&e&&(t=e.nativeEvent.srcElement.getBoundingClientRect()),t&&(v.x=t.left+1,v.y=t.top,v.width=t.width,v.height=t.height)}D(e)}}},2497:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var s=n(92292);function i(e){const t=s.Z.extension.getViews({windowId:e});if(!t||0===t.length)throw new Error(`chrome.extension.getViews ( ${e} ) returned no views. `);return t[0]}},26036:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var s=n(56371);const i="Ð";function o(e,t,n){const o=Array.from(arguments);o[0]=i+o[0];let a=(0,s.Z)(...o);return a.startsWith(i)&&(a=a.substr(1)),{label:(0,s.Z)(...arguments),labelEnglish:a}}},97781:(e,t,n)=>{"use strict";n.d(t,{Gx:()=>d,Nw:()=>y,ZR:()=>l,o6:()=>I});var s=n(27856),i=n.n(s),o="https://240.0.0.0/?url=",a=/(url\("?)(?!data:)/gim;const r="lang",l="type",d="name";function c(e,t){for(var n=t.length-1;n>=0;n--){if(t[t[n]]){var s=t[t[n]].replace(a,"$1"+o);t[t[n]]=s}t[t[n]]&&e.push(t[n]+":"+t[t[n]]+";")}}function h(e,t){for(var n=t.length-1;n>=0;n--){var s=t[n];if(1===s.type&&s.selectorText)e.push(s.selectorText+"{"),s.style&&c(e,s.style),e.push("}");else if(s.type===s.MEDIA_RULE)e.push("@media "+s.media.mediaText+"{"),h(e,s.cssRules),e.push("}");else if(s.type===s.FONT_FACE_RULE)e.push("@font-face {"),s.style&&c(e,s.style),e.push("}");else if(s.type===s.KEYFRAMES_RULE){e.push("@keyframes "+s.name+"{");for(var i=s.cssRules.length-1;i>=0;i--){var o=s.cssRules[i];8===o.type&&o.keyText&&(e.push(o.keyText+"{"),o.style&&c(e,o.style),e.push("}"))}e.push("}")}}}const p=function(e,t){if("style"===t.tagName){var n=[];e.sheet&&h(n,e.sheet.cssRules),e.textContent=n.join("\n")}};var u=["action","background","poster","src"];let g=!1;const m=function(e){if(u.forEach((t=>{e.hasAttribute(t)&&!/^(data|blob):/i.test(e.getAttribute(t))&&(g=!0,e.removeAttribute(t))})),e.hasAttribute("style")){for(var t=e.style,n=[],s=t.length-1;s>=0;s--){if(e.style[t[s]]&&a.test(e.style[t[s]])){var i=e.style[t[s]].replace(a,"$1"+o);e.style[t[s]]=i}n.push(t[s]+":"+e.style[t[s]]+";")}n.length?e.setAttribute("style",n.join("")):e.removeAttribute("style")}},v=function(e){"target"in e&&e.setAttribute("target","_blank"),e.hasAttribute("target")||!e.hasAttribute("xlink:href")&&!e.hasAttribute("href")||e.setAttribute("xlink:show","new")},f=function(e,t){const n=e[t.src];if(n){const e=new Blob([n.content],{type:n.mimeType});t.setAttribute(r,t.src),t.setAttribute("src",URL.createObjectURL(e)),n.inUse=!0}};function y(e,t){const n=t?.attachments??{},s=t?.blockHTTPLeaks??!0;i().addHook("afterSanitizeAttributes",v),i().addHook("afterSanitizeAttributes",f.bind(void 0,n)),s&&(i().addHook("afterSanitizeAttributes",m),i().addHook("uponSanitizeElement",p)),g=!1;const o=i().sanitize(e,{ADD_TAGS:s?[]:["iframe"],ADD_ATTR:s?[]:["allowfullscreen"],ALLOW_UNKNOWN_PROTOCOLS:!0,FORBID_TAGS:s?["svg"]:[],WHOLE_DOCUMENT:!0});return i().removeHooks("afterSanitizeAttributes"),i().removeHooks("uponSanitizeElement"),{sanitized:o,leakPrevented:g}}function C(){return Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString()}let w=[],b=[];function S(e){if("string"==typeof e.src)if(e.src.startsWith("blob:")){const t=e.getAttribute(r);if(t)w.push(t),e.removeAttribute(r),e.setAttribute("src",t);else{const t=C();b.push({dataOrBlobUrl:e.src,cid:t,mimeType:e.getAttribute(l),filename:e.getAttribute(d)}),e.setAttribute("src","cid:"+t),e.removeAttribute(l),e.removeAttribute(d)}}else if(e.src.startsWith("data:image/")){const t=C(),n=e.src.match(/^data:([^,;]+)/)[1];b.push({dataOrBlobUrl:e.src,cid:t,mimeType:n,filename:""}),e.setAttribute("src","cid:"+t)}}function I(e){i().addHook("afterSanitizeAttributes",S);const t={blobFreeHTML:i().sanitize(e,{ALLOW_UNKNOWN_PROTOCOLS:!0,WHOLE_DOCUMENT:!0}),cidsInUse:w,newImages:b};return i().removeHooks("afterSanitizeAttributes"),w=[],b=[],t}},48588:(e,t,n)=>{"use strict";n.d(t,{c:()=>a,k:()=>r});var s=n(68247),i=n(29087),o=n(93513);function a(e,t,n,s){const i=e.get(t)??s;if(void 0===i)return e;const a=(0,o.Uy)(i,(e=>{n(e)}));if(i===a)return e;const r=new Map(e);return r.set(t,a),(0,o.vV)(r)}function r(e,t){const n=i.Z.get(e),a=(0,o.Uy)(n,t);return n!==a&&(s.Z.set(e,a),!0)}},721:(e,t,n)=>{"use strict";n.d(t,{Kz:()=>c,Mr:()=>r,Np:()=>l,S2:()=>a,VV:()=>o,mT:()=>d});var s=n(84847),i=n(7064);function o(e){return!(e.altKey||e.shiftKey||e.ctrlKey||e.metaKey)}function a(e){return e.altKey&&!e.shiftKey&&!e.ctrlKey&&!e.metaKey}function r(e){return!e.altKey&&e.shiftKey&&!e.ctrlKey&&!e.metaKey}function l(e){return!e.altKey&&!e.shiftKey&&e.ctrlKey&&!e.metaKey}function d(e){const{altKey:t,shiftKey:n,ctrlKey:s,metaKey:i}=e;return!t&&!n&&s&&!i}const c=function(){let e=!1;return function(t,n){(0,s.Z)(t)?!0!==e&&(e=!0,i.Z.tabsPrivate.onKeyboardChanged.addListener((function s(o,a,r,l){!a&&function(e,t){const n={ctrlKey:[17],altKey:[18],metaKey:[91,93]};return Object.keys(n).filter((t=>e)).filter((e=>-1!==n[e].indexOf(t))).some(Boolean)}(t,l)&&(e=!1,n(),i.Z.tabsPrivate.onKeyboardChanged.removeListener(s))}))):n()}}()},49550:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});const s=Object.freeze({3:"Break",8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"Capslock",27:"Escape",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",41:"Select",42:"Print",43:"Execute",44:"PrintScreen",45:"Insert",46:"Del",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",58:":",59:"None",60:"<",61:"=",63:"ß",64:"@",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",91:"Meta",92:"None",93:"Meta",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9",106:"*",107:"+",108:",",109:"-",110:".",111:"/",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",124:"F13",125:"F14",126:"F15",127:"F16",128:"F17",129:"F18",130:"F19",131:"F20",132:"F21",133:"F22",134:"F23",135:"F24",144:"NumLock",145:"Scrolllock",160:"^",161:"!",163:"#",164:"$",165:"None",166:"BrowserBack",167:"BrowserForward",169:")",170:"*",171:"+",173:"None",174:"None",175:"None",176:"Next",177:"Previous",178:"Stop",179:"None",180:"None",181:"None",182:"None",183:"None",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"None",193:"None",194:".",219:"[",220:"\\",221:"]",222:"'",223:"`",224:"Meta",225:"AltGraph",226:"None",230:"None",233:"None",234:"None",255:"None"})},13302:(e,t,n)=>{"use strict";function s(e){return Array.isArray(e)&&(e=e.join(", ")),e&&(e=(e=e.toLowerCase().replace(/left/g,"←").replace(/right/g,"→").replace(/up/g,"↑").replace(/down/g,"↓")).toLowerCase().replace(/(^|\+)(\w)/g,(e=>e.toUpperCase()))),e}function i(e){return Array.isArray(e)&&(e=e.join(", ")),e&&(e=e.replace(/(^|\+)(\w)/g,(e=>e.toUpperCase()))),e}n.d(t,{$:()=>s,G:()=>i})},45660:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u,a:()=>h});n(20244);var s=n(17751),i=n(29087),o=n(88212),a=n(89175),r=n(89555),l=n(34155);function d(e){return"object"!=typeof e||e instanceof Error?e:JSON.stringify(e)}function c(e,t){let n;switch(e){case"log":case"info":n=["debug","info"].includes(t)?console.log:null;break;case"warn":n=["debug","info","warn"].includes(t)?console.warn:null;break;case"error":n=["debug","info","warn","error"].includes(t)?console.error:null}return(t,...r)=>{const[c,h]=(0,o.NJ)(r);i.Z.get(a.kBiscuitLogComponents)[t]&&n&&(n(...(0,o.Zr)(t,c),...h),l.nextTick((()=>s.Z.log({timestamp:Date.now(),level:e,component:t,tags:c,args:h.map(d)}))))}}function h(){p(),i.Z.addListener(a.kBiscuitLogLevel,p)}function p(){const e=i.Z.get(a.kBiscuitLogLevel)||"info";o.kg.debug="debug"===e?console.log:r.Z,o.kg.log=c("info",e),o.kg.info=o.kg.log,o.kg.warn=c("warn",e),o.kg.error=c("error",e)}const u=o.kg},60007:e=>{let t=!0;const n=(e,t)=>{const n=e[t].level-1;for(let s=t-1;s>=0;s--)if(e[s].level===n)return s;return-1};e.exports=(e,s)=>{s&&(t=!0===s.enabled),e.block.ruler.after("list","todo",((e,t,n)=>{const s=((e,t)=>{const n=e.bMarks[t]+e.blkIndent,s=e.eMarks[t];return e.src.substr(n,s-n)})(e,t);return"list"===e.parentType&&("[ ]"===s.substring(0,3)||"[x]"===s.substring(0,3).toLowerCase())&&(e.tokens.push({type:"todo",content:s,block:!0,lines:[t],level:e.level}),e.line=t+1,!0)}),{}),e.renderer.rules.todo=(e,s,i)=>((e,s,i)=>{const o=e[s],a=e[s-1],r=e[n(e,s-1)];let l=o.content;if(a&&"list_item_open"===a.type&&r&&"bullet_list_open"===r.type){const e=1===l.toLowerCase().indexOf("x");return l=l.slice(3).trim(),'<input type="checkbox"'+(e?" checked":"")+(t?"":" disabled")+" />"+l}return l})(e,s);const i=e.renderer.rules.list_item_open;e.renderer.rules.list_item_open=(e,t,s,o)=>{const a=e[t+1],r=e[n(e,t)];return r&&"bullet_list_open"===r.type&&a&&"todo"===a.type?'<li class="todo">':i(e,t,s,o)}}},4027:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});const s={kNone:-1,kLeft:0,kCenter:1,kRight:2,kBack:3,kForward:4,isContextMenuButton:e=>2===e,isNavigationButton:e=>3===e||4===e,isNoModifierPressed:e=>!(e.altKey||e.shiftKey||e.ctrlKey||e.metaKey),setWebviewPointerEvents:(e,t)=>{const n=e?"":"none";for(const e of t.getElementsByTagName("WEBVIEW"))e.style.pointerEvents=n}}},81157:(e,t,n)=>{"use strict";function s(e){e.preventDefault(),e.stopPropagation()}function i(e){e.stopPropagation()}function o(e){e.preventDefault()}n.d(t,{PF:()=>o,UW:()=>i,ZP:()=>s})},8684:(e,t,n)=>{"use strict";n.d(t,{c:()=>s});function s(e){const t=new Notification(e.title,{body:e.body,icon:e.icon?e.icon:"/resources/icon_notifications.png",silent:Boolean(e.silent),tag:e.tag,renotify:!0});t.onclick=()=>{e.onClick&&e.onClick(),t.close()},setTimeout((()=>t.close()),e.timeout||18e4)}},26219:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var s=n(56371);async function i(e,t){const{chrome:n}=e;return new Promise(((e,i)=>{n.fileSystem.chooseEntry({type:"openFile",acceptsMultiple:!0,accepts:[{mimeTypes:["text/*"],extensions:t,description:(0,s.Z)("files of type $1",[t])}]},(t=>{n.runtime.lastError||!t?i(n.runtime.lastError||"Cancelled opening files"):e(t)}))}))}},51370:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var s=n(85834),i=n(78614);function o(e){try{return decodeURIComponent(e)}catch(e){return""}}function a(e){const[,t]=e.split(":",2),[n,a=""]=t.split("?",2),r={to:(0,i.D$)((0,s.Mf)(o(n)))};return a.split("&").forEach((e=>{const t=["cc","bcc","body","subject"].find((t=>e.startsWith(t+"=")));if(t){const n=o(e.substr(t.length+1));switch(t){case"cc":case"bcc":r[t]=(0,i.D$)((0,s.Mf)(n));break;case"subject":r[t]=(0,s.Mf)(n);break;case"body":r[t]=n}}})),r}},94595:(e,t,n)=>{"use strict";n.d(t,{M:()=>l,Z:()=>r});var s=n(29087),i=n(89175),o=n(10373);const a=/^(\s*javascript:)+/i;function r(e){const{textToStrip:t,caretPosition:n,selectionEnd:a,currentValue:r=""}=e,d=s.Z.get(i.kAddressBarStripJavascriptOnPaste),c=(0,o.i)(r,t,n,a);return d&&l(c)?c.replace(/javascript:/gi,""):c}function l(e){return a.test(e)}},80419:(e,t,n)=>{"use strict";n.d(t,{g:()=>o});var s=n(7064);let i=!1;function o(e,t,n){function o(e){i=!1,n.removeEventListener("mouseup",l),n.removeEventListener("mousedown",l),s.Z.tabsPrivate.onKeyboardChanged.removeListener(a),s.Z.tabsPrivate.onTabSwitchEnd.removeListener(r),t(e)}function a(e,t,n,s){!0===t?27===s&&o(!0):!1===t&&(17!==s&&18!==s&&13!==s||o(!1))}function r(){o(!1)}function l(e){if(e.target){const t=e.target.classList;if("mousedown"===e.type&&0===e.button&&t&&["visual-tab","visual-list","visual-list-preview"].includes(t)||"audioicon"===e.target.className)return}(2===e.button||e.button<=1&&e.buttons<=2)&&(e.preventDefault(),e.stopPropagation(),o(!1))}!0!==i&&(i=!0,n.addEventListener("mouseup",l),n.addEventListener("mousedown",l),s.Z.tabsPrivate.onKeyboardChanged.addListener(a),s.Z.tabsPrivate.onTabSwitchEnd.addListener(r))}},751:(e,t,n)=>{"use strict";n.d(t,{IY:()=>s,gR:()=>o,i6:()=>a,x0:()=>i});n(94283);const s="urlFieldInput";function i(e,t){const n=e.document.getElementById(t??s);n&&n.focus()}function o(e,t){const n=e.document.getElementById(t??s);n&&n.blur()}function a(e,t){const n=e.document.getElementById(t??s);n instanceof e.HTMLInputElement&&n.select()}},7065:(e,t,n)=>{"use strict";n.d(t,{OK:()=>d,ZP:()=>h});var s=n(29087),i=n(44850),o=n(35369),a=n(69046),r=n(65741),l=n(89175);function d(e){const t=e.id;if(void 0===t)throw new Error("Chrome.tabToPage: tab ID missing");const n={ext_id:crypto.randomUUID()};let r=(0,a.SJ)({id:t,vivExtData:n});var d;return r=c(o.aV.of(r),t,e).first(),r.context.isUrlFieldFocused=(d=r.url,!s.Z.get(l.kTabsFocusWebview)&&((0,i.Rf)(d)||d===i.xy["private-intro"])),r}function c(e,t,n){const s=e.findIndex((e=>e.id===t));if(-1===s)return e;for(const[t,a]of Object.entries(n))switch(t){case"vivExtData":if("string"!=typeof a)continue;try{const t=e.getIn([s,"vivExtData"])??{ext_id:crypto.randomUUID()},n=JSON.parse(a);"string"==typeof n.tiling&&delete n.tiling,(0,r.Z)(t,n)||(e=e.setIn([s,"vivExtData"],n))}catch(e){}break;case"active":if("boolean"!=typeof a)continue;e=e.setIn([s,"active"],a),a&&(e=e.setIn([s,"unread"],!1));break;case"pendingUrl":case"url":if("string"!=typeof a)continue;if("url"===t&&n.pendingUrl)continue;e=(e=(e=e.setIn([s,"isMailPage"],i.jk.isMailPage(a))).setIn([s,"url"],(o=a).startsWith("vivaldi://")?i.jk.getUrl(o):o)).setIn([s,"target"],void 0);break;case"favIconUrl":if("string"!=typeof a)continue;e=e.setIn([s,"favIconUrl"],a);break;case"index":case"windowId":case"openerTabId":case"pinned":case"audible":case"title":case"incognito":case"sessionId":case"discarded":e=e.setIn([s,t],a)}var o;return e}const h={tabToPage:d,updatePage:c}},69046:(e,t,n)=>{"use strict";function s(e){return e.vivExtData.group}function i(e){return e.vivExtData.tiling?.id}function o(e){return e.vivExtData.workspaceId}function a(e){return{id:0,index:-1,windowId:-1,openerTabId:void 0,active:!1,pinned:!1,audible:!1,discarded:!1,url:"",title:"",favIconUrl:"",incognito:!1,sessionId:"",vivExtData:{ext_id:""},context:{},target:void 0,favIcon:"",showImageInspector:!1,mimeType:"text/html",unread:!0,isInspected:!1,isMailPage:!1,supportsReaderMode:!1,...e}}n.d(t,{SJ:()=>a,av:()=>s,cm:()=>o,jA:()=>i})},39206:(e,t,n)=>{"use strict";n.d(t,{A:()=>d,Z:()=>u});var s=n(68247),i=n(29087),o=n(16920),a=n(25372),r=n(7064),l=n(89175);const d=1,c=new Set;let h={templateUrls:[],defaultSearch:"",defaultPrivate:"",defaultSearchField:"",defaultSearchFieldPrivate:"",defaultSpeeddials:"",defaultSpeeddialsPrivate:"",defaultImage:""};const p={load:async()=>{r.Z.searchEngines.onTemplateUrlsChanged.addListener(p._onTemplateUrlsChanged),await p._onTemplateUrlsChanged(),await p._migrateOldSearches()},_onTemplateUrlsChanged:async()=>{try{h=await r.Z.searchEngines.getTemplateUrls()}catch(e){console.log("Failed loading template URLs:"+e)}c.forEach((e=>e()))},get:()=>h.templateUrls,getByKeyword:e=>h.templateUrls.find((t=>t.keyword===e)),getByQuery:e=>h.templateUrls.find((t=>e.toLowerCase().startsWith(t.keyword+" "))),isDefault:(e,t)=>t?h.defaultPrivate===e:h.defaultSearch===e,isRemovable:e=>h.defaultSearch!==e&&h.defaultPrivate!==e&&h.defaultImage!==e,getDefault:e=>p.getById(e?h.defaultPrivate:h.defaultSearch),getSearchField:e=>p.getById(e?h.defaultSearchFieldPrivate:h.defaultSearchField),getSpeeddialsSearch:e=>p.getById(e?h.defaultSpeeddialsPrivate:h.defaultSpeeddials),getImageSearch:()=>p.getById(h.defaultImage),getById:e=>h.templateUrls.find((t=>t.id===e)),getByPrepopulateId:e=>h.templateUrls.find((t=>t.prepopulateId===e)),addListener:e=>{c.add(e)},removeListener:e=>{c.delete(e)},_migrateOldSearches:async()=>{const e={Google:1,"Yahoo!":2,Bing:3,Ecosia:4,"Startpage.com":5,Wikipedia:6,DuckDuckGo:7,Яндекс:8,Neeva:9,"Wolfram|Alpha":10,OZON:11,Amazon:12,eBay:13,"Поиск Mail.ru":14,Qwant:15};async function t(e){const[t,n]=e.post?function(e){const t=(0,a.Z)(e);if(!t)return["",""];const n=t.href.replace(t.search||"",""),s=t.search?.startsWith("?")?t.search.replace("?",""):t.search;return[n||"",s?s.replace("&",","):""]}(e.url):[e.url,""];if(""===t)return"";const s={id:"",extensionId:"",readOnly:!1,name:e.name,keyword:e.keyword?e.keyword:await r.Z.searchEngines.getKeywordForUrl(t),faviconUrl:e.faviconUrl,url:t,postParams:n,suggestUrl:e.suggestUrl??"",suggestPostParams:"",imageUrl:"",imagePostParams:"",prepopulateId:0},i=p.getByKeyword(e.keyword);if(i){if(s.url===i.url&&s.postParams===i.postParams&&s.suggestUrl===i.suggestUrl)return i.id;let t=1;const n=e.keyword;let o="";do{o=`${n}${t}`,t++}while(p.getByKeyword(o));0!==i.prepopulateId?(i.keyword=o,r.Z.searchEngines.updateTemplateUrl(i)):s.keyword=o}return await r.Z.searchEngines.addTemplateUrl(s)}let n=[...i.Z.get(l.kChainedCommandsCommandList)];function d(e,t,s){var i,o;i=t,o=s,n=n.map((e=>{const t=e.chain.map((e=>{const{key:t,param:n}=e;return"3a8efd62-4c8a-4545-8a6c-9cb65518f507"===t&&n===i?{...e,param:o}:{...e}}));return{...e,chain:[...t]}}));const a=e.default===t,l=e.defaultPrivate===t;a&&r.Z.searchEngines.setDefault("defaultSearch",s),l&&(r.Z.searchEngines.setDefault("defaultPrivate",s),r.Z.searchEngines.setDefault("defaultSpeeddialsPrivate",s)),(!e.current&&a||e.current===t)&&r.Z.searchEngines.setDefault("defaultSearchField",s),(!e.currentSD&&a||e.currentSD===t)&&r.Z.searchEngines.setDefault("defaultSpeeddials",s),(!e.currentPrivate&&l||e.currentPrivate===t)&&r.Z.searchEngines.setDefault("defaultSearchFieldPrivate",s)}const c=o.Z.getSync("SEARCH_ENGINE_COLLECTION"),h=o.Z.getDefaultSearchEngines();if(void 0===c)return;for await(const n of h.engines){const s=c.engines.find((e=>e.id===n.id));if(!s)continue;const i=e[s.name],o=p.getByPrepopulateId(i);if(!0===s.removed)o&&r.Z.searchEngines.removeTemplateUrl(o.id);else{if(s.custom&&o){if(s.url!==(n.url||"")||s.suggestUrl!==(n.suggestUrl||"")||s.name!==(n.name||"")||s.post!==Boolean(n.post)){const e=await t(s);""!==e&&d(c,s.id,e);continue}o.keyword=s.keyword,r.Z.searchEngines.updateTemplateUrl(o)}c.defaultChanged&&o&&d(c,s.id,o.id)}}const u=c.engines.map((e=>(-1!==h.engines.findIndex((t=>t.id===e.id))||!1!==Boolean(e.custom)||c.default!==e.id&&c.defaultPrivate!==e.id||(e.custom=!0),e))).filter((e=>-1===h.engines.findIndex((t=>t.id===e.id))&&!1!==Boolean(e.custom)&&!0!==Boolean(e.removed)));for await(const e of u){const n=await t(e);""!==n&&d(c,e.id,n)}await new Promise((e=>{o.Z.remove("SEARCH_ENGINE_COLLECTION",(()=>{s.Z.set(l.kChainedCommandsCommandList,n),e()}))}))}},u=p},20244:(e,t,n)=>{"use strict";n(89907)},98010:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>u,gC:()=>p,x0:()=>g});var s=n(29087),i=n(25372),o=n(99498);const a=function(e){try{return decodeURI((0,o.Z)(e))}catch(t){return e}};var r=n(1407),l=n(50503),d=n(89175),c=n(36436),h=n(44850);function p(e){const t=(0,l.ME)(e,["scheme","host","tld","port","path","query","ref"]);return(0,l.Aq)(t).substring(0,r.RL)}function u(e){if(!e)return"";const t=(0,i.Z)(e);t&&"view-source:"!==t.protocol&&"mailto:"!==t.protocol&&(t.username="",t.password="",e=t.href);const n=s.Z.get(d.kAddressBarShowFullUrl)?h.jk.getDisplayUrlFromMapping(e):(0,c.Dy)(h.jk.getDisplayUrlFromMapping(e));return a(n)}function g(e){const t=(0,i.Z)(e);return t&&t.hostname?t.hostname.replace(/^(www\.)/,""):""}},42578:(e,t,n)=>{"use strict";n.d(t,{d:()=>r,q:()=>a});var s=n(25356),i=n(44850),o=n(25372);function a(e){if(i.jk.isInternalUrl(e.url)){if(Object.keys(i.jk.internals).find((t=>e.url.startsWith(i.jk.internals[t]))))return i.jk.getDisplayTitle(e)}return(0,o.Z)((0,s.Z)(e.url))?.hostname||""}function r(e,t){const n=a(e),s=t.filter((e=>"tab"===e.type&&!e.page.pinned&&a(e.page)===n)).map((e=>e.page));return[n,s]}},45454:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o,k:()=>i});var s=n(15489);const i={openInBackgroundTab:{inCurrent:!1,inBackground:!0,inNewWindow:!1,allowOverride:!1,incognito:!1}};function o(e,t){const n={ctrl:Boolean(t.ctrlKey),alt:Boolean(t.altKey),shift:Boolean(t.shiftKey),command:!1},i=n.ctrl,o=!n.shift&&!i&&!n.alt,a={inCurrent:!0,inBackground:!1,inNewWindow:!1,allowOverride:!1,incognito:!1};return n.shift&&i&&n.alt?(a.inNewWindow=!0,a.incognito=!0):n.shift&&i&&!n.alt?(a.inNewWindow=!0,a.incognito=s.ZP.isIncognito(e)):!n.shift||i||n.alt?n.shift||!i||n.alt?o&&1===t.button?(a.inCurrent=!1,a.inBackground=!0):o&&2===t.button?a.inCurrent=!1:o&&(a.allowOverride=!0):(a.inCurrent=!1,a.inBackground=!0):a.inCurrent=!1,a}},84847:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});const s=e=>Boolean(e&&(e.ctrlKey||e.altKey||e.metaKey||e.shiftKey))},60339:(e,t,n)=>{"use strict";n.d(t,{Qz:()=>a,ZN:()=>l,gO:()=>r,kG:()=>d,xz:()=>h});var s=n(96951),i=n(35369),o=n(69046);function a(e){const t=s.ZP.getPageById(e);return!!t&&r(t)}function r(e){const t=(0,o.jA)(e);if(!t)return!1;return s.ZP.getPages(e.windowId).count((e=>e.vivExtData.tiling?.id===t))>1}function l(e){if(e.active)return!0;const t=c(e);return!!t&&t.some((e=>e.active))}function d(e){if(!s.ZP.getPages(e))return(0,i.aV)();const t=s.ZP.getActivePage(e);return t?c(t)||i.aV.of(t):(0,i.aV)()}function c(e){const t=(0,o.jA)(e);return r(e)&&t?s.ZP.getTiles(t,e.windowId):null}function h(e){return!!e&&s.ZP.isGroup(e.vivExtData.group,e.windowId)}},29489:(e,t,n)=>{"use strict";n.d(t,{IN:()=>l,gD:()=>r});var s=n(96951),i=n(26036),o=n(7064);const a=[(0,i.Z)("Transitions Forced"),(0,i.Z)("Filter Obscure"),(0,i.Z)("Filter Grayscale"),(0,i.Z)("Filter Black and White"),(0,i.Z)("Fonts Monospace"),(0,i.Z)("Transform 3D"),(0,i.Z)("Highlight Hover"),(0,i.Z)("CSS Debugger"),(0,i.Z)("Filter Sepia"),(0,i.Z)("Filter Intensify"),(0,i.Z)("Skewed Images"),(0,i.Z)("Highlight Focus"),(0,i.Z)("Transitions Removed"),(0,i.Z)("Filter Invert"),(0,i.Z)("Inline Access Keys"),(0,i.Z)("Page Minimap")];function r(e){const t=e.lastIndexOf("\\"),n=-1===t?e:e.substr(t+1),s=n.lastIndexOf("."),i=n.substr(0,s).replace(/_/g," "),o=a.findIndex((e=>e.labelEnglish===i));return-1===o?i:a[o].label}function l(e){const t=r(e),n=`COMMAND_${t}`.toUpperCase().replace(/\s+/,"_");return{name:n,action:t=>async function(e,t){const n=s.ZP.getActivePage(e);if(n){const e="enabled"===(await o.Z.pageActions.getScriptOverridesForTab(n.id)).find((e=>e.script===t))?.override?"no_override":"enabled";await o.Z.pageActions.setScriptOverrideForTab(t,n.id,e)}}(t.windowId,e),guid:n,showInQC:!1,isEnabled:()=>!0,isVisible:()=>!0,category:"CATEGORY_COMMAND_TAB_ACTION",...(0,i.Z)(t)}}},25356:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var s=n(60910);const i=function(e,t){try{return(0,s.Z)(e,t)}catch(t){return e}}},14789:(e,t,n)=>{"use strict";function s(e,t){const n=e.indexOf(t);if(n<0)return void e.push(t);const s=e[n];e.copyWithin(n,n+1),e[e.length-1]=s}function i(e,t){const n=e.indexOf(t);if(n<0)return void e.unshift(t);const s=e[n];e.copyWithin(1,0,n),e[0]=s}function o(e,t=!1){if(e.length<=1)return e;const n=[...e];if(!0===t){const e=n[n.length-1];n.copyWithin(1,0,n.length-1),n[0]=e}else{const e=n[0];n.copyWithin(0,1),n[n.length-1]=e}return n}n.d(t,{AL:()=>s,EQ:()=>i,JA:()=>o})},50503:(e,t,n)=>{"use strict";n.d(t,{Aq:()=>p,Lk:()=>C,ME:()=>g,dO:()=>v,gC:()=>f,gG:()=>u,kG:()=>h,n9:()=>y});var s=n(29087),i=n(29526),o=n(7064),a=n(36436),r=n(88778),l=n(42941),d=n(89175),c=n(44850);function h(){return{scheme:null,username:null,password:null,host:null,path:null,ref:null,query:null,port:null,tld:null}}function p(e){const t=e.scheme&&!a.kO.includes(`${e.scheme}:`)&&"vivaldi"!==e.scheme,n=e.path&&"/"!==e.path||e.query||e.ref?e.path:"",s=null!==e.query?`?${e.query}`:"",i=null!==e.ref?`#${e.ref}`:"";return(e.scheme?`${e.scheme}:${t?"//":""}`:"")+(e.username?e.username:"")+(e.password?`:${e.password}`:"")+(e.username||e.password?"@":"")+(e.host?e.host:"")+(e.port?`:${e.port}`:"")+(n||"")+(s||"")+(i||"")}function u(e){const t=s.Z.get(d.kAddressBarShowFullUrl),n=g(e,["tld","host","port","path",...t?["scheme"]:[],...t?["ref"]:[],...t?["query"]:[]]),i=n.path&&"/"!==n.path||n.query?n.path:"";return{...n,path:i}}function g(e,t){const n=t.includes("username"),s=t.includes("password"),i=t.includes("tld"),o=t.includes("host"),a=t.includes("port"),r=t.includes("path"),l=t.includes("scheme"),d=t.includes("ref"),c=t.includes("query");return{scheme:l?e.scheme:"",username:n?e.username:"",password:s?e.password:"",host:o?e.host:"",path:r?e.path:"",ref:d?e.ref:"",query:c?e.query:"",port:a?e.port:"",tld:i?e.tld:""}}function m(e){return void 0===e?null:e}function v(e){const t=c.jk.getDisplayUrlFromMapping(e);if(!t)return{scheme:null,username:null,password:null,host:null,path:null,ref:null,query:null,port:null,tld:null};const n=o.Z.utilities.getUrlFragments(t),s=n.hostForSecurityDisplay?.length?n.hostForSecurityDisplay:n.host,a=n.tldForSecurityDisplay?.length?n.tldForSecurityDisplay:n.tld,r=n.pathForSecurityDisplay??(0,i.Z)(n.path??""),l=n.queryForSecurityDisplay??n.query,d=n.refForSecurityDisplay??(0,i.Z)(n.ref??"");return{scheme:m(n.scheme),username:m(n.username),password:m(n.password),host:m(s),path:m(r),ref:d?m(d):null,query:l?m(l):null,port:m(n.port),tld:m(a)}}function f(e,t){if(!e)return null;if(!t){if(n=(n=e).replace(/\[|\]/g,""),/(?:^(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)){3}$)|(?:^(?:(?:[a-fA-F\d]{1,4}:){7}(?:[a-fA-F\d]{1,4}|:)|(?:[a-fA-F\d]{1,4}:){6}(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)(?:\\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)){3}|:[a-fA-F\d]{1,4}|:)|(?:[a-fA-F\d]{1,4}:){5}(?::(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)(?:\\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)){3}|(?::[a-fA-F\d]{1,4}){1,2}|:)|(?:[a-fA-F\d]{1,4}:){4}(?:(?::[a-fA-F\d]{1,4}){0,1}:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)(?:\\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)){3}|(?::[a-fA-F\d]{1,4}){1,3}|:)|(?:[a-fA-F\d]{1,4}:){3}(?:(?::[a-fA-F\d]{1,4}){0,2}:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)(?:\\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)){3}|(?::[a-fA-F\d]{1,4}){1,4}|:)|(?:[a-fA-F\d]{1,4}:){2}(?:(?::[a-fA-F\d]{1,4}){0,3}:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)(?:\\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)){3}|(?::[a-fA-F\d]{1,4}){1,5}|:)|(?:[a-fA-F\d]{1,4}:){1}(?:(?::[a-fA-F\d]{1,4}){0,4}:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)(?:\\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)){3}|(?::[a-fA-F\d]{1,4}){1,6}|:)|(?::(?:(?::[a-fA-F\d]{1,4}){0,5}:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)(?:\\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]\d|\d)){3}|(?::[a-fA-F\d]{1,4}){1,7}|:)))(?:%[0-9a-zA-Z]{1,})?$)/gm.test(n)||/(^|\.)localhost(\.localdomain)?\.?$/.test(e))return{basedomain:e,subdomain:"",hostTld:""};if(-1===e.indexOf("."))return null;const t=e.split("."),s=t.splice(-1).join();return{basedomain:t.splice(-1).join(),subdomain:t.join("."),hostTld:s}}var n;const s=e.substring(0,e.length-t.length).split(".").filter(Boolean),i=(0,r.Z)(s).join(".");return{basedomain:(0,l.Z)(s),subdomain:i,hostTld:t}}function y(e){return""!==v((0,a.q9)(e)).tld}function C(e){const{path:t}=v((0,a.q9)(e));return!("/"===t&&!e.endsWith("/"))&&(null!==t&&t?.length>0)}},58537:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});n(20244);var s=n(1407);const i=new Map;let o=0;function a(e,t){return new Promise(((n,s)=>{const a=o++;i.set(a,{resolve:n,reject:s});const r={promiseId:a,func:e,args:t};navigator.serviceWorker?.ready.then((e=>e.active?.postMessage({background:r})))}))}function r(e){if(e.origin!==s.oP)return;const{background:t}=e.data;if(!t)return;const{promiseId:n,results:o,error:a}=t,r=i.get(n);if(!r)return void console.error("BackgroundActions: Missing promise ",n);const{resolve:l,reject:d}=r;i.delete(n),a?d(a):l(o)}const l=new class{updateThreads(){return a("updateThreads",[])}stop(){return a("stop",[])}start(){return a("start",[])}addAccount(e){return a("addAccount",[e])}flushBuffer(){return a("flushBuffer",[])}updateFlags(){return a("updateFlags",[])}runSystemTasks(){return a("runSystemTasks",[])}startBackgroundActions(){navigator.serviceWorker?.addEventListener("message",r,!1)}}},42225:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 21">\n  <path fill-rule="evenodd" d="M14.6 3c-1.4-.6-3.3-1-5.6-1s-4.2.4-5.6 1l-1.2.8L2 4l7-2-7 2 .2.2 1.2.8c1.4.6 3.3 1 5.6 1s4.2-.4 5.6-1l1.2-.8.2-.2-.2-.2-1.2-.8zM9 0C4 0 0 1.8 0 4v13c0 2.2 4 4 9 4s9-1.8 9-4V4c0-2.2-4-4-9-4zM2 13.3v-2.8c1.6 1 4.2 1.5 7 1.5s5.3-.6 7-1.5v2.8l-1 .6c-1.5.7-3.6 1.1-6 1.1s-4.5-.4-6-1l-1-.7zM15 10l1-.6V6.5C14.3 7.5 11.8 8 9 8s-5.4-.6-7-1.5v2.8l1 .6c1.5.7 3.6 1.1 6 1.1s4.5-.4 6-1zM2 14.5c1.6 1 4.2 1.5 7 1.5s5.3-.6 7-1.5V17l-.2.2-1.2.8c-1.4.6-3.3 1-5.6 1s-4.2-.4-5.6-1l-1.2-.8A.8.8 0 012 17v-2.5zM16 4zm0 13zM2 17zM2 4zm2 4.5a.5.5 0 11-1 0 .5.5 0 011 0zm0 4a.5.5 0 11-1 0 .5.5 0 011 0zm0 4a.5.5 0 11-1 0 .5.5 0 011 0z"/>\n</svg>\n'},50227:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path fill-rule="evenodd" d="M8 2c1.72 0 3.2.3 4.15.73.23.1.41.2.55.28-.14.08-.31.18-.54.27C11.2 3.7 9.73 4 8 4s-3.2-.3-4.16-.72c-.23-.1-.4-.19-.54-.27.14-.09.32-.18.55-.28C4.8 2.3 6.28 2 8 2zm7 1.02V3c0-1.66-3.13-3-7-3S1 1.34 1 3v9.95C1 14.64 4.13 16 8 16s7-1.36 7-3.05V3.02zm-2 6.91v-1.9c-1.27.57-3.04.92-5 .92s-3.73-.35-5-.92v1.9l.37.18c1.14.5 2.78.83 4.63.83a12.02 12.02 0 005-1zm-10 .85c1.27.57 3.04.92 5 .92s3.73-.35 5-.92v1.98a2.9 2.9 0 01-.85.51C11.2 13.7 9.72 14 8 14c-1.72 0-3.2-.3-4.15-.73a2.9 2.9 0 01-.85-.5v-1.99zm9.63-3.42a6 6 0 00.37-.18V5.1c-1.27.56-3.04.9-5 .9a12.9 12.9 0 01-5-.9v2.08l.37.18c1.14.5 2.78.83 4.63.83s3.49-.33 4.63-.83z"/>\n</svg>\n'},29047:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path fill-rule="evenodd" d="M8 1c1.55 0 2.9.28 3.84.7.46.2.78.42.96.62.1.1.15.19.18.25a.79.79 0 01-.15.2c-.19.17-.5.38-.97.57-.94.4-2.3.66-3.86.66s-2.92-.26-3.86-.66a3.1 3.1 0 01-.97-.58.78.78 0 01-.15-.2.8.8 0 01.18-.24c.18-.2.5-.42.96-.63C5.1 1.3 6.45 1 8 1zm6 1.58V2.5C14 1.12 11.31 0 8 0S2 1.12 2 2.5v8.83C2 12.81 4.69 14 8 14s6-1.2 6-2.67V2.67v-.09zm-1 3.38V3.88C11.93 4.56 10.09 5 8 5s-3.93-.44-5-1.12v2.08c.23.22.57.45 1.03.65.98.44 2.38.72 3.97.72 1.59 0 2.99-.28 3.97-.72.46-.2.8-.43 1.03-.65zM3 6.8C4.07 7.53 5.91 8 8 8s3.93-.47 5-1.2v2.01c-.23.22-.57.45-1.03.65-.98.44-2.38.72-3.97.72-1.59 0-2.99-.28-3.97-.72-.46-.2-.8-.43-1.03-.65v-2zm0 4.52V9.66c1.07.72 2.91 1.2 5 1.2s3.93-.48 5-1.2v1.67c0 .05-.02.16-.2.35-.18.2-.5.42-.96.63-.93.4-2.29.69-3.84.69-1.55 0-2.9-.28-3.84-.7-.46-.2-.78-.42-.96-.62-.18-.19-.2-.3-.2-.35z"/>\n</svg>\n'},3009:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path d="M12 14H9C8.44772 14 8 13.5523 8 13V13C8 12.4477 8.44772 12 9 12H12V9C12 8.44772 12.4477 8 13 8V8C13.5523 8 14 8.44772 14 9V12H17C17.5523 12 18 12.4477 18 13V13C18 13.5523 17.5523 14 17 14H14V17C14 17.5523 13.5523 18 13 18V18C12.4477 18 12 17.5523 12 17V14Z"/>\n</svg>\n'},43099:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M7 7V5C7 4.44772 7.44772 4 8 4C8.55228 4 9 4.44772 9 5V7H11C11.5523 7 12 7.44772 12 8C12 8.55228 11.5523 9 11 9H9V11C9 11.5523 8.55228 12 8 12C7.44772 12 7 11.5523 7 11V9H5C4.44772 9 4 8.55228 4 8C4 7.44772 4.44772 7 5 7H7Z"/>\n</svg>\n'},20939:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M7.25 9.25C7.25 8.14543 8.14543 7.25 9.25 7.25H18.75C19.8546 7.25 20.75 8.14543 20.75 9.25V18.75C20.75 19.8546 19.8546 20.75 18.75 20.75H9.25C8.14543 20.75 7.25 19.8546 7.25 18.75V9.25Z" stroke="currentColor" stroke-width="1.5"/>\n<path d="M11 14H17" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n<path d="M14 17V11" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n</svg>\n'},1587:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M2 2h11v11H2V2ZM0 2a2 2 0 0 1 2-2h11a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2Zm7 2h1v3h3v1H8v3H7V8H4V7h3V4Z"/>\n</svg>'},42041:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M3 2h9a1 1 0 011 1v9a1 1 0 01-1 1H3a1 1 0 01-1-1V3a1 1 0 011-1zM1 3a2 2 0 012-2h9a2 2 0 012 2v9a2 2 0 01-2 2H3a2 2 0 01-2-2V3zm6 1h1v3h3v1H8v3H7V8H4V7h3V4z"/>\n</svg>\n'},28796:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M8.5 4C8.22386 4 8 4.22386 8 4.5V8H4.5C4.22386 8 4 8.22386 4 8.5C4 8.77614 4.22386 9 4.5 9H8V12.5C8 12.7761 8.22386 13 8.5 13C8.77614 13 9 12.7761 9 12.5V9H12.5C12.7761 9 13 8.77614 13 8.5C13 8.22386 12.7761 8 12.5 8H9V4.5C9 4.22386 8.77614 4 8.5 4Z"/>\n</svg>\n'},35732:e=>{e.exports='<svg class="add-speeddial-large-plus" width="48" height="48" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M25 3C25 2.44772 24.5523 2 24 2C23.4477 2 23 2.44772 23 3V23L3 23C2.44772 23 2 23.4477 2 24C2 24.5523 2.44772 25 3 25L23 25V45C23 45.5523 23.4477 46 24 46C24.5523 46 25 45.5523 25 45V25L45 25C45.5523 25 46 24.5523 46 24C46 23.4477 45.5523 23 45 23L25 23V3Z"/>\n</svg>\n'},98913:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M3 6.5C3 6.22386 3.22386 6 3.5 6H6.5C6.77614 6 7 6.22386 7 6.5V9.5C7 9.77614 6.77614 10 6.5 10H3.5C3.22386 10 3 9.77614 3 9.5V6.5Z"/>\n  <path fill-rule="evenodd" d="M3 3C1.34315 3 0 4.34315 0 6V10C0 11.6569 1.34315 13 3 13H13C14.6569 13 16 11.6569 16 10V6C16 4.34315 14.6569 3 13 3H3ZM2 6C2 5.44772 2.44772 5 3 5H13C13.5523 5 14 5.44772 14 6V10C14 10.5523 13.5523 11 13 11H3C2.44772 11 2 10.5523 2 10V6Z"/>\n</svg>\n'},77737:e=>{e.exports='<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\r\n    <path fill-rule="evenodd" d="M12.5 16L8.86568 12.3657C8.36171 11.8617 8.71865 11 9.43137 11L15.5686 11C16.2814 11 16.6383 11.8617 16.1343 12.3657L12.5 16Z"/>\r\n</svg>\r\n'},60018:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M8.5 11L4.86568 7.36568C4.36171 6.86171 4.71865 6 5.43137 6L11.5686 6C12.2814 6 12.6383 6.86171 12.1343 7.36569L8.5 11Z"/>\n</svg>\n'},99785:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 13l3.634-3.634c.504-.504 1.366-.147 1.366.566v6.137c0 .713-.862 1.07-1.366.566l-3.634-3.634z"/></svg>'},10307:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M5 8L8.63432 4.36568C9.13829 3.86171 10 4.21865 10 4.93137L10 11.0686C10 11.7814 9.13829 12.1383 8.63431 11.6343L5 8Z"/>\n</svg>\n'},91004:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M16 13l-3.634 3.634c-.504.504-1.366.147-1.366-.566v-6.137c0-.713.862-1.07 1.366-.566l3.634 3.634z"/></svg>'},86839:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M11 8L7.36568 11.6343C6.86171 12.1383 6 11.7814 6 11.0686L6 4.93137C6 4.21865 6.86171 3.86171 7.36569 4.36569L11 8Z"/>\n</svg>\n'},89170:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M8.5 6L12.1343 9.63432C12.6383 10.1383 12.2814 11 11.5686 11L5.43137 11C4.71865 11 4.36171 10.1383 4.86569 9.63431L8.5 6Z"/>\n</svg>\n'},51843:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M1 8c0-2.182 1.75-4 3.85-4h7.35C13.74 4 15 5.31 15 6.91s-1.26 3.15-2.8 3.15H6.25C5.27 10.06 4.5 9.018 4.5 8s.77-2 1.75-2h5.753v1.063H6.25c-.42 0-.7.5-.7.937 0 .436.28.97.7.97h5.95c.98 0 1.75-1.043 1.75-2.06 0-1.02-.77-1.82-1.75-1.82H4.85c-1.54 0-2.8 1.31-2.8 2.91s1.26 2.91 2.8 2.91l6.155.148V12H4.85C2.75 12 1 10.182 1 8z"/>\n</svg>\n'},55070:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16Z" fill="var(--colorSuccessBg)"/>\n  <path d="M7.544 8.703 10.819 4.8l1.839 1.542-4.82 5.752L4 8.866l1.542-1.839 2.002 1.676Z" fill="var(--colorSuccessFg)"/>\n</svg>\n'},81766:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16Z" fill="var(--colorErrorBg)"/>\n  <path d="M4 5.6 5.6 4 8 6.4 10.4 4 12 5.6 9.6 8l2.4 2.4-1.6 1.6L8 9.6 5.6 12 4 10.4 6.4 8 4 5.6Z" fill="var(--colorErrorFg)"/>\n</svg>\n'},99634:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16Z" fill="var(--colorBg)"/>\n  <path d="M7.544 8.703 10.819 4.8l1.839 1.542-4.82 5.752L4 8.866l1.542-1.839 2.002 1.676Z" fill="var(--colorFg)"/>\n</svg>\n'},95460:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16Z" fill="var(--colorWarningBg)"/>\n  <path d="M6.987 10.019h1.594c.004-.321.048-.598.132-.831.087-.234.25-.457.487-.67.275-.258.527-.508.756-.75.23-.24.415-.501.556-.78.142-.284.213-.607.213-.97 0-.52-.11-.962-.331-1.324a2.079 2.079 0 0 0-.957-.831c-.416-.192-.916-.288-1.5-.288-.529 0-1.006.092-1.43.275-.426.18-.765.456-1.02.831-.25.371-.38.842-.393 1.413h1.812c.004-.259.054-.467.15-.625a.929.929 0 0 1 .381-.35c.155-.08.321-.119.5-.119.217 0 .396.042.538.125a.762.762 0 0 1 .325.369c.075.158.112.358.112.6 0 .208-.041.398-.125.569a2.13 2.13 0 0 1-.343.487 7.419 7.419 0 0 1-.513.5 3.45 3.45 0 0 0-.562.656c-.138.221-.236.469-.294.744a5.31 5.31 0 0 0-.088.969ZM7.075 11.287a.877.877 0 0 0-.275.663c0 .258.092.477.275.656.183.18.43.269.737.269.305 0 .548-.09.732-.269a.873.873 0 0 0 .281-.656.867.867 0 0 0-.281-.662c-.184-.18-.427-.27-.732-.27-.308 0-.554.09-.737.27Z" fill="var(--colorWarningFg)"/>\n</svg>\n'},72103:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M9.02555 3.6815L9.02548 3.68157L7.35355 5.3535C7.15829 5.54876 6.84171 5.54876 6.64645 5.3535C6.45118 5.15824 6.45118 4.84165 6.64645 4.64639L8.31845 2.97439L8.31852 2.97432C8.94279 2.3503 9.78933 1.99976 10.672 1.99976C11.5547 1.99976 12.4012 2.3503 13.0255 2.97432L12.672 3.32795L13.0256 2.97446C13.6496 3.59873 14.0002 4.44527 14.0002 5.32795C14.0002 6.21062 13.6496 7.05716 13.0256 7.68143L13.0256 7.6815L11.3536 9.3535C11.1583 9.54876 10.8417 9.54876 10.6464 9.3535C10.4512 9.15824 10.4512 8.84165 10.6464 8.64639L12.3184 6.97446L12.3184 6.97439C12.755 6.53765 13.0002 5.94544 13.0002 5.32795C13.0002 4.71049 12.755 4.1183 12.3185 3.68157C11.8818 3.245 11.2895 2.99976 10.672 2.99976C10.0545 2.99976 9.46229 3.24498 9.02555 3.6815ZM10.8536 5.14645C11.0488 5.34171 11.0488 5.65829 10.8536 5.85355L5.85355 10.8536C5.65829 11.0488 5.34171 11.0488 5.14645 10.8536C4.95118 10.6583 4.95118 10.3417 5.14645 10.1464L10.1464 5.14645C10.3417 4.95118 10.6583 4.95118 10.8536 5.14645ZM5.3535 7.35355C5.54876 7.15829 5.54876 6.84171 5.3535 6.64645C5.15824 6.45118 4.84165 6.45118 4.64639 6.64645L2.97439 8.31845L2.97432 8.31852C2.3503 8.94279 1.99976 9.78933 1.99976 10.672C1.99976 11.5547 2.3503 12.4012 2.97432 13.0255L3.32795 12.672L2.97446 13.0256C3.59873 13.6496 4.44527 14.0002 5.32795 14.0002C6.21062 14.0002 7.05716 13.6496 7.68143 13.0256L7.6815 13.0256L9.3535 11.3536C9.54876 11.1583 9.54876 10.8417 9.3535 10.6464C9.15824 10.4512 8.84165 10.4512 8.64639 10.6464L6.97446 12.3184L6.97439 12.3184C6.53765 12.755 5.94544 13.0002 5.32795 13.0002C4.71049 13.0002 4.1183 12.755 3.68157 12.3185C3.245 11.8818 2.99976 11.2895 2.99976 10.672C2.99976 10.0545 3.24498 9.46229 3.6815 9.02555L3.68157 9.02548L5.3535 7.35355Z"/>\n</svg>\n'},96569:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M2 11v1.857S2 14 3.077 14h9.846S14 14 14 12.857V11h-1v1.857c0 .064-.007.1-.012.12A.289.289 0 0112.9 13H3.077c-.017 0-.03 0-.04-.002A.485.485 0 013 12.841V11H2z"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 8H4.762L8 10.698 11.238 8H9V3H7v5zm7-1l-6 5-6-5h4V3a1 1 0 011-1h2a1 1 0 011 1v4h4z"/>\n</svg>\n'},79537:e=>{e.exports='<svg width="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M7.5 4C7.22386 4 7 4.22386 7 4.5V7.5C7 7.70662 7.12533 7.88397 7.30412 7.96017C7.3329 8.02199 7.37279 8.07992 7.42381 8.13093L8.7304 9.43752C8.96449 9.67161 9.34402 9.67161 9.5781 9.43752C9.81219 9.20344 9.81219 8.82391 9.5781 8.58982L8.27151 7.28323C8.19356 7.20527 8.09947 7.15328 8 7.12725V4.5C8 4.22386 7.77614 4 7.5 4Z"/>\n  <path fill-rule="evenodd" d="M13 7.5C13 10.5376 10.5376 13 7.5 13C4.46243 13 2 10.5376 2 7.5C2 4.4624 4.46243 2 7.5 2C10.5376 2 13 4.4624 13 7.5ZM12 7.5C12 9.98535 9.98528 12 7.5 12C5.01472 12 3 9.98535 3 7.5C3 5.01465 5.01472 3 7.5 3C9.98528 3 12 5.01465 12 7.5Z"/>\n</svg>\n'},72796:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M8 11c2.652 0 4.854-1.276 5.872-3C12.854 6.276 10.652 5 8 5 5.344 5 3.14 6.28 2.123 8.007 3.132 9.777 5.325 11 8 11zm0 1c-3.181 0-5.918-1.572-7-4 1.082-2.346 3.819-4 7-4s5.918 1.654 7 4c-1.082 2.346-3.819 4-7 4zm1-4a1 1 0 11-2 0 1 1 0 012 0zm1 0a2 2 0 11-4 0 2 2 0 014 0z"/>\n</svg>\n'},19096:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n  \x3c!-- base paths defined in defs.svg --\x3e\n  <g class="no-blocking" opacity="var(--no-blocking)">\n    <use xlink:href="#shield-shadow"/>\n    <use xlink:href="#shield-outline" mask="url(#shield-mask)"/>\n    <path d="M3 13L14 2" stroke="currentColor" stroke-linecap="round"/>\n  </g>\n  <g class="blocking" opacity="var(--blocking)">\n    <path d="M5.455 7.243 8 3v4h2.117a.5.5 0 0 1 .429.757L8 12V8H5.883a.5.5 0 0 1-.428-.757z"/>\n  </g>\n  <g class="trackers" opacity="var(--trackers)">\n    <path d="M8 12c1.459-.724 2.46-1.672 2.998-3L11 4.2l-3-.5V12Z" fill-opacity=".5"/>\n  </g>\n  <g class="ads" opacity="var(--ads)">\n    <path d="m8 3.7-3 .5V9c.539 1.328 1.539 2.277 3 3 1.459-.724 2.459-1.672 2.998-3L11 4.2l-3-.5Z" fill-opacity=".5"/>\n  </g>\n  <g class="base" opacity="var(--base)">\n    <use xlink:href="#shield-shadow"/>\n    <use xlink:href="#shield-outline"/>\n  </g>\n</svg>\n'},24325:e=>{e.exports='<svg class="bookmarklet" width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M3 13V2C3 1.44772 3.44772 1 4 1H8.79289C8.9255 1 9.05268 1.05268 9.14645 1.14645L12.8536 4.85355C12.9473 4.94732 13 5.0745 13 5.20711V13C13 13.5523 12.5523 14 12 14H4C3.44772 14 3 13.5523 3 13ZM7.53033 4.96967C7.23744 4.67678 6.76256 4.67678 6.46967 4.96967C6.17678 5.26256 6.17678 5.73744 6.46967 6.03033L8.43934 8L6.46967 9.96967C6.17678 10.2626 6.17678 10.7374 6.46967 11.0303C6.76256 11.3232 7.23744 11.3232 7.53033 11.0303L10.0303 8.53033L10.5607 8L10.0303 7.46967L7.53033 4.96967Z"/>\n</svg>\n'},80401:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M9.25 20.0053V9.25C9.25 8.14543 10.1454 7.25 11.25 7.25H16.75C17.8546 7.25 18.75 8.14543 18.75 9.25V20.0053C18.75 20.2103 18.5168 20.3281 18.3517 20.2065L14 17L9.6483 20.2065C9.48323 20.3281 9.25 20.2103 9.25 20.0053Z" stroke="currentColor" stroke-width="1.5"/>\n</svg>\n'},4044:e=>{e.exports='<svg width="16px" height="16px" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <defs>\n    <clipPath id="addBookmarkPath">\n      <path fill-rule="evenodd" d="M11.1425 14.123L8 10.9091L4.8575 14.123C4.54419 14.4435 4 14.2216 4 13.7734V2C4 1.44775 4.44771 1 5 1H11C11.5523 1 12 1.44775 12 2V13.7734C12 14.2216 11.4558 14.4435 11.1425 14.123Z"/>\n    </clipPath>\n  </defs>\n  <g clip-path="url(#addBookmarkPath)">\n    <path class="bookmark-animated-fill" fill-rule="evenodd" d="M11.1425 14.123L8 10.9091L4.8575 14.123C4.54419 14.4435 4 14.2216 4 13.7734V2C4 1.44775 4.44771 1 5 1H11C11.5523 1 12 1.44775 12 2V13.7734C12 14.2216 11.4558 14.4435 11.1425 14.123Z"/>\n    <path class="bookmark-outline" fill-rule="evenodd" d="M11.1425 14.123L8 10.9091L4.8575 14.123C4.54418 14.4434 4 14.2216 4 13.7734V2C4 1.44772 4.44772 1 5 1H11C11.5523 1 12 1.44772 12 2V13.7734C12 14.2216 11.4558 14.4434 11.1425 14.123ZM8 9.47872L5 12.5469V2L11 2V12.5469L8 9.47872Z"/>\n    <path class="add-bookmark-shadow" d="M8 2H11V12.55L8 9.47656V2Z"/>\n  </g>\n</svg>\n'},97624:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path d="M13 6C11.8954 6 11 6.89543 11 8V14H8L13 19L18 14H15V8C15 6.89543 14.1046 6 13 6Z"/>\n</svg>\n'},20477:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M7 9V4C7 3.44772 7.44772 3 8 3V3C8.55228 3 9 3.44772 9 4V9H12L8 13L4 9H7Z"/>\n</svg>\n'},48446:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M5 2C4.44772 2 4 2.44772 4 3V13.5858C4 14.4767 5.07714 14.9229 5.70711 14.2929L8 12L10.2929 14.2929C10.9229 14.9229 12 14.4767 12 13.5858V3C12 2.44772 11.5523 2 11 2H5ZM6 4H10V11.5L8.70711 10.2071C8.31658 9.81658 7.68342 9.81658 7.29289 10.2071L6 11.5V4Z"/>\n</svg>\n'},31734:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M5 1C3.89543 1 3 1.89543 3 3V14.0329C3 14.6319 3.66761 14.9892 4.16603 14.6569L8 12.1009L11.834 14.6569C12.3324 14.9892 13 14.6319 13 14.0329V3C13 1.89543 12.1046 1 11 1H5ZM4 3C4 2.44772 4.44772 2 5 2H11C11.5523 2 12 2.44772 12 3V13.5657L8 10.8991L4 13.5657V3Z"/>\n</svg>\n'},16508:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path class="small-icon-fill" d="M9 0H4S3 0 3 1v14l5-3 5 3V1s0-1-1-1H9z"/>\n  <path class="small-icon-outline" fill-rule="evenodd" d="M7.486 11.143a1 1 0 011.029 0L12 13.232V1.024A.261.261 0 0011.996 1H4.024A.287.287 0 004 1.003V13.234l3.486-2.091zM4 14.4L3 15V1c0-1 1-1 1-1h8c1 0 1 1 1 1v14l-1-.6L8 12l-4 2.4zm8.054-13.396h.002zM4.004.946V.945z"/>\n</svg>\n'},61401:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M6.75 10.75C6.75 9.64543 7.64543 8.75 8.75 8.75H19.25C20.3546 8.75 21.25 9.64543 21.25 10.75V17.25C21.25 18.3546 20.3546 19.25 19.25 19.25H8.75C7.64543 19.25 6.75 18.3546 6.75 17.25V10.75Z" stroke="currentColor" stroke-width="1.5"/>\n<rect x="11.5" y="11" width="1.5" height="6" rx="0.75" fill="currentColor"/>\n<rect x="15" y="11" width="1.5" height="6" rx="0.75" fill="currentColor"/>\n</svg>\n'},97093:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path fill-rule="evenodd" d="M3 2a3 3 0 00-3 3v6a3 3 0 003 3h10a3 3 0 003-3V5a3 3 0 00-3-3zM2 5a1 1 0 011-1h10a1 1 0 011 1v6a1 1 0 01-1 1H3a1 1 0 01-1-1z"/>\n  <path d="M5 6a1 1 0 012 0v4a1 1 0 11-2 0zm4 0a1 1 0 012 0v4a1 1 0 11-2 0z"/>\n</svg>\n'},58615:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path fill-rule="evenodd" d="M3 3h10a1 1 0 011 1v8a1 1 0 01-1 1H3a1 1 0 01-1-1V4a1 1 0 011-1zM1 4c0-1.1.9-2 2-2h10a2 2 0 012 2v8a2 2 0 01-2 2H3a2 2 0 01-2-2zm5.4 1c-.2 0-.4 0-.4.5v5c0 .5.2.5.4.5a3.6 3.6 0 01.2 0c.2 0 .4 0 .4-.5v-5C7 5 6.8 5 6.6 5a4.2 4.2 0 01-.2 0zm3 0c-.2 0-.4 0-.4.5v5c0 .5.2.5.4.5a3.6 3.6 0 01.2 0c.2 0 .4 0 .4-.5v-5c0-.5-.2-.5-.4-.5a4.2 4.2 0 01-.2 0z"/>\n</svg>\n'},61364:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M6.75 10.75C6.75 9.64543 7.64543 8.75 8.75 8.75H19.25C20.3546 8.75 21.25 9.64543 21.25 10.75V17.25C21.25 18.3546 20.3546 19.25 19.25 19.25H8.75C7.64543 19.25 6.75 18.3546 6.75 17.25V10.75Z" stroke="currentColor" stroke-width="1.5"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M17 14L13.2998 11.0398C12.7759 10.6207 12 10.9937 12 11.6645V16.3355C12 17.0063 12.7759 17.3792 13.2998 16.9602L17 14Z" fill="currentColor"/>\n</svg>\n'},82214:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path d="M11 8l-3.7 3a.8.8 0 01-1.3-.7V5.7A.8.8 0 017.3 5z" fill-rule="evenodd"/>\n  <path d="M3 2a3 3 0 00-3 3v6a3 3 0 003 3h10a3 3 0 003-3V5a3 3 0 00-3-3zM2 5a1 1 0 011-1h10a1 1 0 011 1v6a1 1 0 01-1 1H3a1 1 0 01-1-1z"/>\n</svg>\n'},57358:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path fill-rule="evenodd" d="M3 3h10a1 1 0 011 1v8a1 1 0 01-1 1H3a1 1 0 01-1-1V4a1 1 0 011-1zM1 4c0-1.1.9-2 2-2h10a2 2 0 012 2v8a2 2 0 01-2 2H3a2 2 0 01-2-2zm6.3 1L11 8l-3.7 3a.8.8 0 01-1.3-.7V5.7A.8.8 0 017.3 5zM7 6l2.4 2L7 10z"/>\n</svg>\n'},59678:e=>{e.exports='<svg viewBox="6 6 14 14" xmlns="http://www.w3.org/2000/svg">\n  <path d="M12 14H9C8.44772 14 8 13.5523 8 13V13C8 12.4477 8.44772 12 9 12H12V9C12 8.44772 12.4477 8 13 8V8C13.5523 8 14 8.44772 14 9V12H17C17.5523 12 18 12.4477 18 13V13C18 13.5523 17.5523 14 17 14H14V17C14 17.5523 13.5523 18 13 18V18C12.4477 18 12 17.5523 12 17V14Z"/>\n</svg>\n'},82152:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M0 3a1 1 0 011-1h14a1 1 0 011 1v1a1 1 0 01-1 1H1a1 1 0 01-1-1v-1zm0 5a1 1 0 011-1h14a1 1 0 110 2H1a1 1 0 01-1-1zm0 4a1 1 0 011-1h14a1 1 0 011 1v1a1 1 0 01-1 1H1a1 1 0 01-1-1v-1z"/></svg>'},50973:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill="none" d="M1.75 4.25C1.75 3.42157 2.42157 2.75 3.25 2.75H12.75C13.5784 2.75 14.25 3.42157 14.25 4.25V12.75C14.25 13.5784 13.5784 14.25 12.75 14.25H3.25C2.42157 14.25 1.75 13.5784 1.75 12.75V4.25Z" stroke-width="1.5"/>\n  <path stroke="none" d="M4 2C4 1.44772 4.44772 1 5 1C5.55228 1 6 1.44772 6 2H4Z"/>\n  <path stroke="none" d="M7 2C7 1.44772 7.44772 1 8 1C8.55228 1 9 1.44772 9 2H7Z"/>\n  <path stroke="none" d="M10 2C10 1.44772 10.4477 1 11 1C11.5523 1 12 1.44772 12 2H10Z"/>\n  <rect stroke="none" x="2" y="3" width="12" height="1.5"/>\n  <path stroke="none" opacity="0.35" fill-rule="evenodd" clip-rule="evenodd" d="M7 6H9V8H7V6ZM10 6H12V8H10V6ZM6 9H4V11H6V9ZM7 9H9V11H7V9ZM6 6H4V8H6V6Z"/>\n  <rect stroke="none" x="10" y="9" width="2" height="2"/>\n</svg>\n'},34755:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n<path fill="none" d="M2.5 11L8 5.5L10.5 8L5 13.5H2.5V11Z" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n<path fill="none" d="M10.25 3.25L9.5 4L12 6.5L12.75 5.75C13.4404 5.05964 13.4404 3.94036 12.75 3.25C12.0596 2.55964 10.9404 2.55964 10.25 3.25Z" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n'},75291:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill="none" d="M4.96289 6.99843L3.49999 8.42031C2.37342 9.54689 2.37342 11.3734 3.49999 12.5C4.62657 13.6266 6.45311 13.6266 7.57968 12.5L9.00157 11.0371" stroke-width="1.5" stroke-linecap="round"/>\n  <path fill="none" d="M11.0371 9.00158L12.5 7.57969C13.6266 6.45312 13.6266 4.62658 12.5 3.5C11.3734 2.37343 9.54689 2.37343 8.42032 3.5L6.99843 4.96289" stroke-width="1.5" stroke-linecap="round"/>\n  <path fill="none" d="M6 10L10 6" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n'},72897:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill="none" d="M8 1.25C6 1.25 3.25 2.25 3.25 6C3.25 9.75 8 14.25 8 14.25C8 14.25 12.75 9.79688 12.75 6C12.75 2.25 10 1.25 8 1.25Z" stroke-width="1.5"/>\n  <circle fill="none" cx="8" cy="6" r="2" stroke-width="1.5"/>\n</svg>\n'},62681:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill="none" d="M8 1.75C6.20507 1.75 4.75 3.20507 4.75 5V8C4.75 9.5 4 11.25 2 11.25H14C12 11.25 11.25 9.5 11.25 8V5C11.25 3.20507 9.79493 1.75 8 1.75Z" stroke-width="1.5" stroke-linejoin="round"/>\n  <path fill="none" d="M5.5 13.75C5.66667 14.25 6.4 15.25 8 15.25C9.6 15.25 10.3333 14.25 10.5 13.75" stroke-width="1.5" stroke-linecap="round"/>\n</svg>\n'},88609:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill="none" d="M7.35345 9.33616L6.69643 9.85486L7.28391 10.4512L9.55664 12.7581C9.71041 12.9142 9.89536 13.186 10.0431 13.4859C10.1147 13.6312 10.1701 13.7682 10.2062 13.8835C10.2241 13.9407 10.2358 13.9877 10.2427 14.024C10.2492 14.0586 10.2499 14.0755 10.25 14.0772C10.25 14.0773 10.25 14.0773 10.25 14.0772C10.25 14.1856 10.2178 14.2178 10.2158 14.2198L10.2157 14.2199L10.2157 14.2199C10.2148 14.2209 10.1885 14.25 10.0909 14.25H1.90909C1.81154 14.25 1.78522 14.2209 1.7843 14.2199L1.78427 14.2199L1.78421 14.2198C1.78223 14.2178 1.75 14.1856 1.75 14.0772C1.75 13.4799 1.99815 13.21 2.44336 12.7581L4.71609 10.4512L5.30357 9.85486L4.64655 9.33616C3.99428 8.82121 3.56818 8.01675 3.56818 7.15653V6.23377C3.56818 4.81156 4.75978 3.68347 6.14281 3.75309C7.40471 3.82109 8.43182 4.99358 8.43182 6.41832V7.15653C8.43182 8.01675 8.00572 8.82121 7.35345 9.33616Z" stroke-width="1.5"/>\n  <path stroke="none" opacity="0.5" d="M10.1383 9.15699C10.4859 8.42321 10.6899 7.6266 10.6899 6.82998V6.11244C10.6899 4.5643 10.0335 3.16461 9 2.22087C9.42021 1.42507 9.86201 1 11.1209 1C12.4139 1 13.2759 2.166 13.2759 3.2423V4.13922C13.2759 5.03612 12.845 5.48456 12.414 5.93301L14.138 7.72688C14.569 8.17534 15 8.6238 15 9.07226C15 9.52072 14.569 9.96918 14.138 10H10.9485L10.1383 9.15699Z"/>\n</svg>\n'},77729:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill="none" d="M6.75 11.25H12.75C13.5784 11.25 14.25 10.5784 14.25 9.75V5.75C14.25 4.92157 13.5784 4.25 12.75 4.25H12.25" stroke-width="1.5"/>\n  <path fill="none" d="M9 8.75L6.5 11.25L9 13.75" stroke-width="1.5" stroke-linecap="round"/>\n  <path fill="none" d="M9.25 4.25H3.25C2.42157 4.25 1.75 4.92157 1.75 5.75V9.75C1.75 10.5784 2.42157 11.25 3.25 11.25H4" stroke-width="1.5"/>\n  <path fill="none" d="M7 6.75L9.5 4.25L7 1.75" stroke-width="1.5" stroke-linecap="round"/>\n</svg>\n'},37966:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill="none" d="M8.5 2.75H4.25C3.42157 2.75 2.75 3.42157 2.75 4.25V11.75C2.75 12.5784 3.42157 13.25 4.25 13.25H11.75C12.5784 13.25 13.25 12.5784 13.25 11.75V9.5" stroke-width="1.5" stroke-linecap="round"/>\n  <path fill="none" d="M5.5 6.49971L8.5 9.49971L13.5 2.49971" stroke-width="1.5" stroke-linecap="round"/>\n</svg>\n'},85847:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path stroke="none" d="M7.5 4.75C7.22386 4.75 7 4.97386 7 5.25V8.75C7 8.88807 7.05596 9.01307 7.14645 9.10355L7.42381 9.38093L8.7304 10.6875C8.96449 10.9216 9.34402 10.9216 9.5781 10.6875C9.81219 10.4534 9.81219 10.0739 9.5781 9.83982L8 8.25V5.25C8 4.97386 7.77614 4.75 7.5 4.75Z"/>\n  <path fill="none" d="M1.75 8C1.75 5.90118 1.75 4.85177 2.13404 4.03978C2.52971 3.20321 3.20321 2.52971 4.03978 2.13404C4.85177 1.75 5.90118 1.75 8 1.75V1.75C10.0988 1.75 11.1482 1.75 11.9602 2.13404C12.7968 2.52971 13.4703 3.20321 13.866 4.03978C14.25 4.85177 14.25 5.90118 14.25 8V8C14.25 10.0988 14.25 11.1482 13.866 11.9602C13.4703 12.7968 12.7968 13.4703 11.9602 13.866C11.1482 14.25 10.0988 14.25 8 14.25V14.25C5.90118 14.25 4.85177 14.25 4.03978 13.866C3.20321 13.4703 2.52971 12.7968 2.13404 11.9602C1.75 11.1482 1.75 10.0988 1.75 8V8Z" stroke-width="1.5"/>\n</svg>\n'},82453:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M0 2a1 1 0 011-1h14a1 1 0 110 2H1a1 1 0 01-1-1zm0 8a1 1 0 011-1h14a1 1 0 011 1v5a1 1 0 01-1 1H1a1 1 0 01-1-1v-5zm1-5a1 1 0 000 2h14a1 1 0 100-2H1z"/></svg>'},38368:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M0 5a1 1 0 011-1h14a1 1 0 110 2H1a1 1 0 01-1-1zm0 3a1 1 0 011-1h14a1 1 0 110 2H1a1 1 0 01-1-1zm1 2a1 1 0 100 2h14a1 1 0 100-2H1z"/></svg>'},49336:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n    <path stroke-width="0" fill-rule="evenodd" d="M5 3h6c.6 0 1 .4 1 1v2c0 .6-.4 1-1 1H5a1 1 0 0 1-1-1V4c0-.6.4-1 1-1zm6 1H5v2h6V4z"/>\n    <path stroke-width="0" d="M5 10a1 1 0 1 1 0-2 1 1 0 0 1 0 2zM7 9a1 1 0 1 0 2 0 1 1 0 0 0-2 0zM11 10a1 1 0 1 1 0-2 1 1 0 0 1 0 2zM4 12a1 1 0 1 0 2 0 1 1 0 0 0-2 0zM8 11h3a1 1 0 1 1 0 2H8a1 1 0 1 1 0-2z"/>\n    <path stroke-width="0" fill-rule="evenodd" d="M4 1a2 2 0 0 0-2 2v10c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2H4zm8 1H4a1 1 0 0 0-1 1v10c0 .6.4 1 1 1h8c.6 0 1-.4 1-1V3c0-.6-.4-1-1-1z"/>\n</svg>\n'},87922:e=>{e.exports='<svg class="onboarding-illustration" fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 220 164">\n  <g clip-path="url(#clip-0-calendar-density)">\n    <rect class="bg-fill" width="220" height="164" rx="3"/>\n    <g clip-path="url(#clip-1-calendar-density)" class="highlight-fill">\n      <path opacity=".32" fill-rule="evenodd" clip-rule="evenodd" d="M52 0v164h1V0h-1zm113 0v164h1V0h-1z" fill-opacity=".25"/>\n      <path opacity=".3" fill-rule="evenodd" clip-rule="evenodd" d="M-50 19a3 3 0 00-3 3v62a3 3 0 003 3h93a3 3 0 003-3V22a3 3 0 00-3-3h-93zm223 3a3 3 0 013-3h93a3 3 0 013 3v6a3 3 0 01-3 3h-93a3 3 0 01-3-3v-6zM60 78a3 3 0 013-3h93a3 3 0 013 3v62a3 3 0 01-3 3H63a3 3 0 01-3-3V78zm113-28a3 3 0 013-3h93a3 3 0 013 3v34a3 3 0 01-3 3h-93a3 3 0 01-3-3V50zm3 53a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3h-93zm-229 3a3 3 0 013-3h93a3 3 0 013 3v6a3 3 0 01-3 3h-93a3 3 0 01-3-3v-6zm229 25a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3h-93z"/>\n      <rect x="60" y="19" width="99" height="40" rx="3"/>\n    </g>\n  </g>\n  <defs>\n    <clipPath id="clip-0-calendar-density">\n      <rect class="bg-fill" width="220" height="164" rx="3"/>\n    </clipPath>\n    <clipPath id="clip-1-calendar-density">\n      <path class="bg-fill" d="M0 0h220v164H0z" rx="3"/>\n    </clipPath>\n  </defs>\n</svg>\n'},18767:e=>{e.exports='<svg class="onboarding-illustration" fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 220 164">\n  <rect width="220" height="164" rx="3" class="bg-fill"/>\n  <g clip-path="url(#clip-0-calendar-density)" class="highlight-fill">\n    <path opacity=".32" fill-rule="evenodd" clip-rule="evenodd" d="M52 0v164h1V0h-1zm113 0v164h1V0h-1z" fill-opacity=".25"/>\n    <path opacity=".3" fill-rule="evenodd" clip-rule="evenodd" d="M-50 19a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3h-93zm110 3a3 3 0 013-3h93a3 3 0 013 3v6a3 3 0 01-3 3H63a3 3 0 01-3-3v-6zm0 84a3 3 0 013-3h93a3 3 0 013 3v6a3 3 0 01-3 3H63a3 3 0 01-3-3v-6zm3 25a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3H63zM173 22a3 3 0 013-3h93a3 3 0 013 3v6a3 3 0 01-3 3h-93a3 3 0 01-3-3v-6zm0 28a3 3 0 013-3h93a3 3 0 013 3v6a3 3 0 01-3 3h-93a3 3 0 01-3-3v-6zm-223-3a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3h-93zm-3 31a3 3 0 013-3h93a3 3 0 013 3v6a3 3 0 01-3 3h-93a3 3 0 01-3-3v-6zm229 25a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3h-93zm-229 3a3 3 0 013-3h93a3 3 0 013 3v6a3 3 0 01-3 3h-93a3 3 0 01-3-3v-6zm229 25a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3h-93z"/>\n    <rect x="60" y="75" width="99" height="12" rx="3"/>\n  </g>\n  <defs>\n    <clipPath id="clip-0-calendar-density">\n      <path class="bg-fill" d="M0 0h220v164H0z" rx="3"/>\n    </clipPath>\n  </defs>\n</svg>\n'},36502:e=>{e.exports='<svg class="onboarding-illustration" fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 220 164">\n  <g clip-path="url(#clip-calendar-inline-editor)">\n    <rect class="bg-fill" width="220" height="164" rx="3"/>\n    <rect class="highlight-stroke" x="62" y="40" width="97" height="83" rx="3" stroke-width="2"/>\n    <path class="highlight-stroke" opacity=".32" stroke-opacity=".25" d="M53.5 0v164"/>\n    <path class="highlight-stroke" opacity=".32" stroke-opacity=".25" d="M166.5 0v164"/>\n    <path class="highlight-fill" opacity=".1" fill-rule="evenodd" clip-rule="evenodd" d="M-49 19a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3h-93zm113 0a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3H64zm0 112a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3H64zM174 22a3 3 0 013-3h93a3 3 0 013 3v6a3 3 0 01-3 3h-93a3 3 0 01-3-3v-6zm0 28a3 3 0 013-3h93a3 3 0 013 3v6a3 3 0 01-3 3h-93a3 3 0 01-3-3v-6zm-223-3a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3h-93zm223 31a3 3 0 013-3h93a3 3 0 013 3v6a3 3 0 01-3 3h-93a3 3 0 01-3-3v-6zm-223-3a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3h-93zm223 31a3 3 0 013-3h93a3 3 0 013 3v6a3 3 0 01-3 3h-93a3 3 0 01-3-3v-6zm-223-3a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3h-93zm223 31a3 3 0 013-3h93a3 3 0 013 3v6a3 3 0 01-3 3h-93a3 3 0 01-3-3v-6zm-223-3a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3h-93z"/>\n    <path class="highlight-stroke" stroke-opacity=".25" d="M69 54.5h83"/>\n    <path class="highlight-stroke" stroke-opacity=".25" d="M69 67.5h83"/>\n    <path class="highlight-stroke" stroke-opacity=".25" d="M69 80.5h83"/>\n    <path class="highlight-stroke" stroke-opacity=".25" d="M69 93.5h83"/>\n    <rect class="highlight-fill" x="69" y="102" width="41" height="14" rx="2"/>\n    <rect class="highlight-stroke" opacity=".5" x="117" y="103" width="34" height="12" rx="1" stroke-width="2"/>\n  </g>\n  <defs>\n    <clipPath id="clip-calendar-inline-editor">\n      <path class="bg-fill" d="M0 0h220v164H0z"/>\n    </clipPath>\n  </defs>\n</svg>\n'},46647:e=>{e.exports='<svg class="onboarding-illustration" fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 220 164">\n  <rect class="bg-fill" width="220" height="164" rx="3"/>\n  <g clip-path="url(#clip-calendar-popup-editor)">\n    <path class="highlight-stroke" opacity=".32" stroke-opacity=".25" d="M52.5 0v164"/>\n    <path class="highlight-stroke" opacity=".32" stroke-opacity=".25" d="M165.5 0v164"/>\n    <path class="highlight-fill" opacity=".1" fill-rule="evenodd" clip-rule="evenodd" d="M-50 19a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3h-93zm113 0a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3H63zm0 112a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3H63zM173 22a3 3 0 013-3h93a3 3 0 013 3v6a3 3 0 01-3 3h-93a3 3 0 01-3-3v-6zm0 28a3 3 0 013-3h93a3 3 0 013 3v6a3 3 0 01-3 3h-93a3 3 0 01-3-3v-6zm-223-3a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3h-93zm223 31a3 3 0 013-3h93a3 3 0 013 3v6a3 3 0 01-3 3h-93a3 3 0 01-3-3v-6zm-223-3a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3h-93zm223 31a3 3 0 013-3h93a3 3 0 013 3v6a3 3 0 01-3 3h-93a3 3 0 01-3-3v-6zm-223-3a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3h-93zm223 31a3 3 0 013-3h93a3 3 0 013 3v6a3 3 0 01-3 3h-93a3 3 0 01-3-3v-6zm-223-3a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3h-93z"/>\n  </g>\n  <path class="bg-fill" fill-rule="evenodd" clip-rule="evenodd" d="M32 25a3 3 0 00-3 3v102a3 3 0 003 3h74l4.5 4.5 4.5-4.5h74a3 3 0 003-3V28a3 3 0 00-3-3H32z"/>\n  <path class="highlight-fill" d="M106 133l.7-.7-.29-.3H106v1zm4.5 4.5l-.7.7.7.71.7-.7-.7-.71zm4.5-4.5v-1h-.41l-.3.3.71.7zM30 28c0-1.1.9-2 2-2v-2a4 4 0 00-4 4h2zm0 102V28h-2v102h2zm2 2a2 2 0 01-2-2h-2a4 4 0 004 4v-2zm74 0H32v2h74v-2zm5.2 4.8l-4.5-4.5-1.4 1.4 4.5 4.5 1.4-1.4zm3.1-4.5l-4.5 4.5 1.4 1.4 4.5-4.5-1.4-1.4zm74.7-.3h-74v2h74v-2zm2-2a2 2 0 01-2 2v2a4 4 0 004-4h-2zm0-102v102h2V28h-2zm-2-2a2 2 0 012 2h2a4 4 0 00-4-4v2zM32 26h157v-2H32v2z"/>\n  <rect class="highlight-fill" x="41" y="108" width="46" height="14" rx="2"/>\n  <rect class="highlight-stroke" opacity=".5" x="94" y="109" width="44" height="12" rx="1" stroke-width="2"/>\n  <path class="highlight-fill" fill-rule="evenodd" clip-rule="evenodd" d="M41 46h134v-1H41v1zm0 14h134v-1H41v1zm134 14H41v-1h134v1zM41 88h134v-1H41v1z" fill-opacity=".25"/>\n  <defs>\n    <clipPath id="clip-calendar-popup-editor">\n      <path class="bg-fill" d="M0 0h220v164H0z"/>\n    </clipPath>\n  </defs>\n</svg>\n'},9371:e=>{e.exports='<svg width="140" height="96" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <rect x=".5" y=".5" width="139" height="95" rx="1.5" class="border" opacity=".5"/>\n  <g opacity=".3">\n    <path d="M35 0v96h1V0h-1ZM104 0v96h1V0h-1ZM109 9a3 3 0 0 1 3-3h28v12h-28a3 3 0 0 1-3-3V9ZM0 6v12h28a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3H0ZM40 9a3 3 0 0 1 3-3h54a3 3 0 0 1 3 3v6a3 3 0 0 1-3 3H43a3 3 0 0 1-3-3V9ZM112 24a3 3 0 0 0-3 3v6a3 3 0 0 0 3 3h28V24h-28ZM0 24h28a3 3 0 0 1 3 3v6a3 3 0 0 1-3 3H0V24ZM112 42a3 3 0 0 0-3 3v6a3 3 0 0 0 3 3h28V42h-28ZM0 42h28a3 3 0 0 1 3 3v6a3 3 0 0 1-3 3H0V42ZM112 60a3 3 0 0 0-3 3v6a3 3 0 0 0 3 3h28V60h-28ZM0 60h28a3 3 0 0 1 3 3v6a3 3 0 0 1-3 3H0V60ZM112 78a3 3 0 0 0-3 3v6a3 3 0 0 0 3 3h28V78h-28ZM0 78h28a3 3 0 0 1 3 3v6a3 3 0 0 1-3 3H0V78ZM42 78a3 3 0 0 0-3 3v6a3 3 0 0 0 3 3h54a3 3 0 0 0 3-3v-6a3 3 0 0 0-3-3H42Z"/>\n  </g>\n  <rect class="background-intenser" x="40" y="24" width="60" height="48" rx="3"/>\n  <path class="highlight" fill-rule="evenodd" clip-rule="evenodd" d="M43 24a3 3 0 0 0-3 3v42a3 3 0 0 0 3 3h54a3 3 0 0 0 3-3V27a3 3 0 0 0-3-3H43Zm54 1H43a2 2 0 0 0-2 2v42a2 2 0 0 0 2 2h54a2 2 0 0 0 2-2V27a2 2 0 0 0-2-2Z"/>\n  <g class="highlight" opacity=".2">\n    <path d="M49 35h42v-1H49v1ZM49 43h42v-1H49v1ZM91 51H49v-1h42v1Z"/>\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M72 59a1 1 0 0 1 1-1h17a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1H73a1 1 0 0 1-1-1v-6Zm1 0h17v6H73v-6Z"/>\n  </g>\n  <rect class="highlight" x="49" y="58" width="21" height="8" rx="1"/>\n</svg>\n'},97487:e=>{e.exports='<svg width="140" height="96" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <rect x=".5" y=".5" width="139" height="95" rx="1.5" class="border" opacity=".5"/>\n  <g opacity=".3">\n    <path d="M35 0v96h1V0h-1ZM104 0v96h1V0h-1ZM109 9a3 3 0 0 1 3-3h28v12h-28a3 3 0 0 1-3-3V9ZM0 6v12h28a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3H0ZM40 9a3 3 0 0 1 3-3h54a3 3 0 0 1 3 3v6a3 3 0 0 1-3 3H43a3 3 0 0 1-3-3V9ZM112 24a3 3 0 0 0-3 3v6a3 3 0 0 0 3 3h28V24h-28ZM0 24h28a3 3 0 0 1 3 3v6a3 3 0 0 1-3 3H0V24ZM112 42a3 3 0 0 0-3 3v6a3 3 0 0 0 3 3h28V42h-28ZM0 42h28a3 3 0 0 1 3 3v6a3 3 0 0 1-3 3H0V42ZM112 60a3 3 0 0 0-3 3v6a3 3 0 0 0 3 3h28V60h-28ZM0 60h28a3 3 0 0 1 3 3v6a3 3 0 0 1-3 3H0V60ZM112 78a3 3 0 0 0-3 3v6a3 3 0 0 0 3 3h28V78h-28ZM0 78h28a3 3 0 0 1 3 3v6a3 3 0 0 1-3 3H0V78ZM42 78a3 3 0 0 0-3 3v6a3 3 0 0 0 3 3h54a3 3 0 0 0 3-3v-6a3 3 0 0 0-3-3H42Z"/>\n  </g>\n  <path class="background-intenser" d="M27 13a3 3 0 0 0-3 3v62a3 3 0 0 0 3 3h40l2.75 2.75L72.5 81H113a3 3 0 0 0 3-3V16a3 3 0 0 0-3-3H27Z"/>\n  <path class="highlight" fill-rule="evenodd" clip-rule="evenodd" d="M23.5 16a3.5 3.5 0 0 1 3.5-3.5h86a3.5 3.5 0 0 1 3.5 3.5v62a3.5 3.5 0 0 1-3.5 3.5H72.707l-2.957 2.957-2.957-2.957H27a3.5 3.5 0 0 1-3.5-3.5V16Zm3.5-2.5a2.5 2.5 0 0 0-2.5 2.5v62a2.5 2.5 0 0 0 2.5 2.5h40.207l2.543 2.543 2.543-2.543H113a2.5 2.5 0 0 0 2.5-2.5V16a2.5 2.5 0 0 0-2.5-2.5H27Z"/>\n  <g class="highlight" opacity=".2">\n    <path d="M105 25H35v-1h70v1ZM105 34H35v-1h70v1ZM35 43h70v-1H35v1ZM105 52H35v-1h70v1Z"/>\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M58 65a1 1 0 0 1 1-1h18a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1H59a1 1 0 0 1-1-1v-6Zm1 0h18v6H59v-6Z"/>\n  </g>\n  <rect class="highlight" x="35" y="64" width="21" height="8" rx="1"/>\n</svg>\n'},30324:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M6.75 10.75C6.75 9.64543 7.64543 8.75 8.75 8.75H19.25C20.3546 8.75 21.25 9.64543 21.25 10.75V18.25C21.25 19.3546 20.3546 20.25 19.25 20.25H8.75C7.64543 20.25 6.75 19.3546 6.75 18.25V10.75Z" stroke="currentColor" stroke-width="1.5"/>\n<path d="M10 8C10 7.44772 10.4477 7 11 7C11.5523 7 12 7.44772 12 8H10Z" fill="currentColor"/>\n<path d="M13 8C13 7.44772 13.4477 7 14 7C14.5523 7 15 7.44772 15 8H13Z" fill="currentColor"/>\n<path d="M16 8C16 7.44772 16.4477 7 17 7C17.5523 7 18 7.44772 18 8H16Z" fill="currentColor"/>\n<rect x="7" y="9" width="14" height="1.5" fill="currentColor"/>\n<path opacity="0.35" fill-rule="evenodd" clip-rule="evenodd" d="M13 12H15V14H13V12ZM16 12H18V14H16V12ZM12 15H10V17H12V15ZM13 15H15V17H13V15ZM12 12H10V14H12V12Z" fill="currentColor"/>\n<rect x="16" y="15" width="2" height="2" fill="currentColor"/>\n</svg>\n'},28888:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72">\n  <path fill-rule="evenodd" d="M66.27 66.27C60.55 72 51.77 72 36 72c-15.78 0-24.55 0-30.27-5.73C0 60.54 0 51.77 0 36S0 11.46 5.73 5.73C11.45 0 20.23 0 36 0c15.78 0 24.55 0 30.27 5.73C72 11.46 72 20.23 72 36s0 24.54-5.73 30.27zM51.16 20.21c2.79 0 5.05 2.26 5.05 5.05v25.27c0 2.79-2.26 5.05-5.05 5.05H20.84a5.05 5.05 0 01-5.05-5.05V25.26c0-2.79 2.26-5.05 5.05-5.05h2.53v-2.53a2.53 2.53 0 015.05 0v2.53h5.05v-2.53a2.53 2.53 0 015.06 0v2.53h5.05v-2.53a2.53 2.53 0 015.05 0v2.53h2.53zm-2.53 30.32c1.4 0 2.53-1.13 2.53-2.53V30.32c0-1.4-1.13-2.53-2.53-2.53H23.37a2.53 2.53 0 00-2.53 2.53V48c0 1.4 1.13 2.53 2.53 2.53h25.26zM30.95 32.84h-5.06v5.05h5.06v-5.05zm7.58 5.05v-5.05h-5.06v5.05h5.06zm-7.58 2.53h-5.06v5.05h5.06v-5.05zm7.58 5.05v-5.05h-5.06v5.05h5.06zm7.58-12.63h-5.06v5.05h5.06v-5.05zm0 7.58h-5.06v5.05h5.06v-5.05z" opacity=".3"/>\n  <path fill-rule="evenodd" d="M24.9 31.84h7.05v7.05h-7.06v-7.05zm14.63 0v7.05h-7.06v-7.05h7.06zm-14.64 7.58h7.06v7.05h-7.06v-7.05zm14.64 0v7.05h-7.06v-7.05h7.06zm.52-7.58h7.06v7.05h-7.06v-7.05zm0 7.58h7.06v7.05h-7.06v-7.05zM54.76 70.3c4.76-.7 8.15-2.07 10.8-4.73 2.66-2.65 4.04-6.04 4.73-10.8.7-4.8.71-10.84.71-18.76 0-7.92 0-13.97-.7-18.76-.7-4.76-2.08-8.15-4.73-10.8C62.9 3.78 59.52 2.4 54.76 1.7 49.96 1 43.92 1 36 1c-7.92 0-13.97 0-18.76.7-4.76.7-8.15 2.08-10.8 4.74-2.66 2.65-4.04 6.04-4.73 10.8C1 22.04 1 28.08 1 36c0 7.92 0 13.97.7 18.76.7 4.76 2.08 8.15 4.73 10.8 2.66 2.66 6.05 4.04 10.81 4.73 4.8.7 10.84.71 18.76.71 7.92 0 13.97 0 18.76-.7zm-3.6-51.08a6.05 6.05 0 016.05 6.05v25.27a6.05 6.05 0 01-6.05 6.05H20.84a6.05 6.05 0 01-6.05-6.05V25.26a6.05 6.05 0 016.05-6.05h1.53v-1.53a3.53 3.53 0 017.05 0v1.53h3.05v-1.53a3.53 3.53 0 017.06 0v1.53h3.05v-1.53a3.53 3.53 0 017.05 0v1.53h1.53zm-2.53 30.32c.84 0 1.53-.69 1.53-1.53V30.32c0-.85-.69-1.53-1.53-1.53H23.37c-.84 0-1.53.68-1.53 1.53V48c0 .84.69 1.53 1.53 1.53h25.26zM36 72c15.78 0 24.55 0 30.27-5.73C72 60.54 72 51.77 72 36s0-24.54-5.73-30.27C60.55 0 51.77 0 36 0 20.22 0 11.45 0 5.73 5.73 0 11.46 0 20.23 0 36s0 24.54 5.73 30.27C11.45 72 20.23 72 36 72zm20.21-46.74a5.05 5.05 0 00-5.05-5.05h-2.53v-2.53a2.53 2.53 0 00-5.05 0v2.53h-5.05v-2.53a2.53 2.53 0 00-5.06 0v2.53h-5.05v-2.53a2.53 2.53 0 00-5.05 0v2.53h-2.53a5.05 5.05 0 00-5.05 5.05v25.27c0 2.79 2.26 5.05 5.05 5.05h30.32c2.79 0 5.05-2.26 5.05-5.05V25.26zM51.16 48c0 1.4-1.13 2.53-2.53 2.53H23.37A2.53 2.53 0 0120.84 48V30.32c0-1.4 1.13-2.53 2.53-2.53h25.26c1.4 0 2.53 1.13 2.53 2.53V48zM30.95 32.84v5.05h-5.06v-5.05h5.06zm7.58 5.05h-5.06v-5.05h5.06v5.05zm-7.58 2.53v5.05h-5.06v-5.05h5.06zm7.58 5.05h-5.06v-5.05h5.06v5.05zm7.58-12.63v5.05h-5.06v-5.05h5.06zm0 7.58v5.05h-5.06v-5.05h5.06z"/>\n</svg>\n'},33395:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M4 8V6H6V8H4Z"/>\n  <path d="M7 6V8H9V6H7Z"/>\n  <path d="M12 8V6H10V8H12Z"/>\n  <path d="M6 11V9H4V11H6Z"/>\n  <path d="M7 9V11H9V9H7Z"/>\n  <path d="M12 11V9H10V11H12Z"/>\n  <path fill-rule="evenodd" d="M4 1C3.44772 1 3 1.44772 3 2C1.89543 2 1 2.89543 1 4V12C1 13.1046 1.89543 14 3 14H13C14.1046 14 15 13.1046 15 12V4C15 2.89543 14.1046 2 13 2C13 1.44772 12.5523 1 12 1C11.4477 1 11 1.44772 11 2L9 2C9 1.44772 8.55228 1 8 1C7.44772 1 7 1.44772 7 2L5 2C5 1.44772 4.55228 1 4 1ZM13 5V12H3L3 5H13Z"/>\n</svg>\n'},28586:e=>{e.exports='<svg viewBox="0 0 26 26"  xmlns="http://www.w3.org/2000/svg">\n    <path fill-rule="evenodd" d="M19 6a2 2 0 012 2v4.299a5.243 5.243 0 00-2-.293V10a1 1 0 00-1-1H8a1 1 0 00-1 1v7a1 1 0 001 1h1.256a4.493 4.493 0 00-.229 2H7a2 2 0 01-2-2V8a2 2 0 012-2h1V5a1 1 0 012 0v1h2V5a1 1 0 112 0v1h2V5a1 1 0 112 0v1h1zm-8 9.758a4.514 4.514 0 00-.329.242H9v-2h2v1.758zm6-3.253c-.294.14-.572.306-.833.495H15v-2h2v1.505zM11 13v-2H9v2h2zm3 0v-2h-2v2h2z" />\n    <path d="M22.372 17.338A2.406 2.406 0 0124 19.6c0 1.326-1.086 2.4-2.446 2.4h-8.108C12.094 22 11 20.922 11 19.6c0-1.051.682-1.944 1.643-2.269a2.021 2.021 0 012.013-1.731c.542 0 1.034.208 1.398.549A3.25 3.25 0 0119.125 14c1.796 0 3.25 1.432 3.25 3.2l-.003.138z"/>\n</svg>'},83303:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M1.5 4C1.5 3.17157 2.17157 2.5 3 2.5H13C13.8284 2.5 14.5 3.17157 14.5 4V12C14.5 12.8284 13.8284 13.5 13 13.5H3C2.17157 13.5 1.5 12.8284 1.5 12V4Z" stroke="currentColor"/>\n  <path opacity="0.35" fill-rule="evenodd" clip-rule="evenodd" d="M10.75 5.5C10.75 5.22386 10.9739 5 11.25 5H12.75C13.0261 5 13.25 5.22386 13.25 5.5C13.25 5.77614 13.0261 6 12.75 6H11.25C10.9739 6 10.75 5.77614 10.75 5.5ZM10.75 7.5C10.75 7.22386 10.9739 7 11.25 7H12.75C13.0261 7 13.25 7.22386 13.25 7.5C13.25 7.77614 13.0261 8 12.75 8H11.25C10.9739 8 10.75 7.77614 10.75 7.5ZM11.25 9C10.9739 9 10.75 9.22386 10.75 9.5C10.75 9.77614 10.9739 10 11.25 10H12.75C13.0261 10 13.25 9.77614 13.25 9.5C13.25 9.22386 13.0261 9 12.75 9H11.25Z" fill="currentColor"/>\n  <line x1="9.5" y1="3" x2="9.5" y2="13" stroke="currentColor"/>\n</svg>\n'},92529:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M5 1C4.44772 1 4 1.44772 4 2H2.5C1.11929 2 0 3.11929 0 4.5V12.5C0 13.8807 1.11929 15 2.5 15H13.5C14.8807 15 16 13.8807 16 12.5V4.5C16 3.11929 14.8807 2 13.5 2H12C12 1.44772 11.5523 1 11 1C10.4477 1 10 1.44772 10 2H9C9 1.44772 8.55229 1 8 1C7.44772 1 7 1.44772 7 2H6C6 1.44772 5.55228 1 5 1ZM1 4.5C1 4.32468 1.03008 4.15639 1.08535 4H14.9146C14.9699 4.15639 15 4.32468 15 4.5V12.5C15 13.3284 14.3284 14 13.5 14H2.5C1.67157 14 1 13.3284 1 12.5V4.5ZM12 11V9H10V11H12Z"/>\n  <path opacity="0.4" fill-rule="evenodd" clip-rule="evenodd" d="M7 6H9V8H7V6ZM10 6H12V8H10V6ZM6 9H4V11H6V9ZM7 9H9V11H7V9ZM6 6H4V8H6V6Z"/>\n</svg>\n'},2365:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path class="small-icon-fill" fill-rule="evenodd" d="M14 3H2v10h12V3zM4 5h2v2H4V5zm0 3h2v2H4V8zm5-3H7v2h2V5zM7 8h2v2H7V8zm5-3h-2v2h2V5zm-2 3h2v2h-2V8z"/>\n  <path class="small-icon-outline" fill-rule="evenodd" d="M4 1a1 1 0 012 0h1a1 1 0 012 0h1a1 1 0 112 0h.5A2.5 2.5 0 0115 3.5v8a2.5 2.5 0 01-2.5 2.5h-9A2.5 2.5 0 011 11.5v-8A2.5 2.5 0 013.5 1H4zM2 4v7.5A1.5 1.5 0 003.5 13h9a1.5 1.5 0 001.5-1.5V4a1 1 0 00-1-1H3a1 1 0 00-1 1z"/>\n</svg>\n'},81693:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n    <path fill-rule="evenodd" d="M15.3137 3.08132C15.6347 2.6319 15.5307 2.00735 15.0812 1.68634C14.6318 1.36534 14.0073 1.46943 13.6863 1.91884L9.37239 7.95826L7.20711 5.79297C6.81658 5.40245 6.18342 5.40245 5.79289 5.79297C5.40237 6.18349 5.40237 6.81666 5.79289 7.20718L8.79289 10.2072L9.6276 11.0419L10.3137 10.0813L15.3137 3.08132ZM3 1.99999C1.89543 1.99999 1 2.89542 1 3.99999V13C1 14.1046 1.89543 15 3 15H13C14.1046 15 15 14.1046 15 13V9.99999C15 9.4477 14.5523 8.99999 14 8.99999C13.4477 8.99999 13 9.4477 13 9.99999V13H3V3.99999H9C9.55228 3.99999 10 3.55227 10 2.99999C10 2.4477 9.55228 1.99999 9 1.99999H3Z"/>\n</svg>\n'},52504:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M14.1103 2.93562C14.3511 2.59856 14.273 2.13015 13.9359 1.88939C13.5989 1.64864 13.1305 1.7267 12.8897 2.06376L8.4043 8.34333L6.03033 5.96936C5.73744 5.67647 5.26256 5.67647 4.96967 5.96936C4.67678 6.26226 4.67678 6.73713 4.96967 7.03002L7.96967 10.03L8.5957 10.6561L9.1103 9.93562L14.1103 2.93562ZM4.5 1.99994C3.11929 1.99994 2 3.11922 2 4.49994V11.4999C2 12.8806 3.11929 13.9999 4.5 13.9999H11.5C12.8807 13.9999 14 12.8806 14 11.4999V9.49994C14 9.22379 13.7761 8.99994 13.5 8.99994C13.2239 8.99994 13 9.22379 13 9.49994V11.4999C13 12.3284 12.3284 12.9999 11.5 12.9999H4.5C3.67157 12.9999 3 12.3284 3 11.4999V4.49994C3 3.67151 3.67157 2.99994 4.5 2.99994H8.5C8.77614 2.99994 9 2.77608 9 2.49994C9 2.22379 8.77614 1.99994 8.5 1.99994H4.5Z"/>\n</svg>\n'},39705:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M7.25 12.125V17.25C7.25 18.3546 8.14543 19.25 9.25 19.25H18.75C19.8546 19.25 20.75 18.3546 20.75 17.25V12.125C20.75 11.0895 19.9105 10.25 18.875 10.25H18C17.4477 10.25 17 9.80228 17 9.25C17 8.69772 16.5523 8.25 16 8.25H12C11.4477 8.25 11 8.69772 11 9.25C11 9.80228 10.5523 10.25 10 10.25H9.125C8.08947 10.25 7.25 11.0895 7.25 12.125Z" stroke="currentColor" stroke-width="1.5"/>\n  <circle cx="14" cy="15" r="1.5" stroke="currentColor"/>\n</svg>\n'},56035:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M8 11C9.10457 11 10 10.1046 10 9C10 7.89543 9.10457 7 8 7C6.89543 7 6 7.89543 6 9C6 10.1046 6.89543 11 8 11Z"/>\n  <path fill-rule="evenodd" d="M6 2C4.89543 2 4 2.89543 4 4H3C1.34315 4 0 5.34315 0 7V11C0 12.6569 1.34315 14 3 14H13C14.6569 14 16 12.6569 16 11V7C16 5.34315 14.6569 4 13 4H12C12 2.89543 11.1046 2 10 2H6ZM6 4H10C10 5.10457 10.8954 6 12 6H13C13.5523 6 14 6.44772 14 7V11C14 11.5523 13.5523 12 13 12H3C2.44772 12 2 11.5523 2 11V7C2 6.44772 2.44772 6 3 6H4C5.10457 6 6 5.10457 6 4Z"/>\n</svg>\n'},46292:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M20.1464 9.75H8.75H8.25L11.75 13.25V18.75L20.3232 10.1768C20.4807 10.0193 20.3692 9.75 20.1464 9.75Z" stroke="currentColor" stroke-width="1.5"/>\n<path d="M15 11.5H10L12 14L15 11.5Z" fill="currentColor"/>\n</svg>\n'},5096:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M16 3.869c0-.557-.461-.869-1.111-.869h-14.889l3.282 3.2 9.35-1.6-7.709 4v6.4l10.667-10.4c.186-.178.41-.473.41-.731z"/></svg>'},51555:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M0 2h14.546c.359 0 .715.09.992.31.292.231.461.579.461.991 0 .25-.098.471-.189.625-.095.162-.213.304-.319.411l-10.492 10.664v-8l-5-5zm2.5.95l2.5 2.55 7-1.5-6 3.5.003 5 8.863-8.848.176-.225.054-.125c0-.117-.038-.183-.101-.232-.077-.061-.223-.119-.45-.119h-12.046z"/>\n</svg>\n'},30135:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path class="small-icon-fill" d="M1.5 2.5H15l.5 1-9.5 10V7L1.5 2.5z"/>\n  <path class="small-icon-outline" fill-rule="evenodd" d="M0 2h14.546c.359 0 .715.09.992.31.292.231.461.579.461.991 0 .25-.098.471-.189.625-.095.162-.213.304-.319.411l-10.492 10.664v-8l-5-5zm2.5.95l2.5 2.55 7-1.5-6 3.5.003 5 8.863-8.848.176-.225.054-.125c0-.117-.038-.183-.101-.232-.077-.061-.223-.119-.45-.119h-12.046z"/>\n</svg>\n'},78297:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M4.5 3L3 4.5 6.5 8 3 11.5 4.414 13 9.5 8l-5-5zm5 0L8 4.5 11.5 8 8 11.5 9.414 13 14.5 8l-5-5z"/>\n</svg>\n'},4799:e=>{e.exports='<svg width="11" height="6" xmlns="http://www.w3.org/2000/svg">\n  <path d="M1.354 4.894a.497.497 0 1 0 .702.702l3.423-3.423L8.9 5.596a.491.491 0 1 0 .695-.695L5.851 1.156a.49.49 0 0 0-.27-.137.496.496 0 0 0-.48.128L1.354 4.894z"/>\n</svg>\n'},87268:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <circle\n    fill="var(--kIconCircleFill)"\n    stroke="var(--kIconCircleStroke)"\n    stroke-width="1.1"\n    stroke-opacity="0.8"\n    cx="8" cy="8" r="4.5" />\n</svg>\n'},78990:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <circle cx="8" cy="8" r="3" />\n</svg>\n'},78553:e=>{e.exports='<svg wisth="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <g clip-path="url(#clear-downloads-clip)" fill-rule="evenodd" clip-rule="evenodd">\n    <path d="M9.385.077a1 1 0 01.538 1.308L7.775 6.54l.238.089c.536.201.78.813.682 1.377-.345 2.006.867 3.83 2.152 5.277.589.662.156 1.716-.73 1.716H2a.968.968 0 01-.979-1c.193-4.414 1.683-6.152 3.523-8.036a.999.999 0 011.065-.236l.292.11L8.077.615A1 1 0 019.385.077zM6.3 13h1.79c-.858-1.282-1.576-2.902-1.438-4.745l-1.13-.423c-.673.716-1.182 1.343-1.578 2.114-.376.734-.689 1.68-.842 3.054h1.98l-.464-1.854a.6.6 0 111.164-.292l.5 2A.602.602 0 016.3 13z"/>\n    <path opacity=".35" d="M14.985 7H11V6h3.985v1zm0 2H11V8h3.985v1zM12 11h3v-1h-3v1z"/>\n  </g>\n  <defs>\n    <clipPath id="clear-downloads-clip">\n      <path fill="white" d="M0 0h16v16H0z"/>\n    </clipPath>\n  </defs>\n</svg>\n'},59607:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M9.455 1.207a.5.5 0 00-.91-.414L6.2 5.95l-.592-.222a.999.999 0 00-1.065.236C2.704 7.848 1.214 9.586 1.021 14a.968.968 0 00.98 1h8.116c.886 0 1.319-1.053.73-1.716-1.285-1.448-2.497-3.27-2.152-5.277.097-.564-.146-1.176-.682-1.377l-.874-.328 2.316-5.095zM6.382 14H5.4a.601.601 0 00-.02-.155l-.8-3a.6.6 0 10-1.16.31L4.18 14H2.022c.095-2.072.489-3.45 1.032-4.51.553-1.078 1.292-1.892 2.204-2.825l2.403.9v.001a.133.133 0 01.024.038c.025.054.04.14.025.234-.43 2.503 1.09 4.647 2.39 6.11.009.01.012.017.014.02a.033.033 0 01.003.01.05.05 0 01-.003.022H7.6a.601.601 0 00-.018-.146l-.5-2a.6.6 0 10-1.164.292L6.382 14z"/>\n  <path opacity=".35" fill-rule="evenodd" clip-rule="evenodd" d="M14.985 7H11V6h3.985v1zm0 2H11V8h3.985v1zM12 11h3v-1h-3v1z"/>\n</svg>\n'},62234:e=>{e.exports='<svg viewBox=" 0 0 28 28" fill="currentColor" xmlns="http://www.w3.org/2000/svg">\n  <path class="ClockIcon-AlarmBell" d="M5.053 5.053a3.536 3.536 0 0 0 0 5l5-5a3.536 3.536 0 0 0-5 0zm17.947 0a3.536 3.536 0 0 1 0 5l-5-5a3.536 3.536 0 0 1 5 0z"/>\n  <circle class="ClockIcon-CountdownHour" cx="14" cy="14" r="4"/>\n  <circle class="ClockIcon-CountdownMinute" cx="14" cy="14" r="4"/>\n  <path class="ClockIcon-TimeMinute" d="M14.5 8.5s0-.5-.5-.5-.5.5-.5.5l-.5 5.357c0 .631.448 1.143 1 1.143s1-.512 1-1.143L14.5 8.5z"/>\n  <path class="ClockIcon-TimeHour" d="M13 11v3a1 1 0 1 0 2 0v-3a1 1 0 1 0-2 0z" />\n  <circle cx="14" cy="14" r="7" stroke="currentColor" stroke-width="1.5" fill="none"/>\n</svg>\n'},72864:e=>{e.exports='<svg class="ClockGraphic" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">\n  <circle class="ClockGraphic-Hour-Indicator" r="17" cx="50" cy="50"/>\n  <circle class="ClockGraphic-Minute-Indicator" r="29" cx="50" cy="50"/>\n  <path d="M50 1C50.5523 1 51 1.44772 51 2L51 12C51 12.5523 50.5523 13 50 13C49.4477 13 49 12.5523 49 12L49 2C49 1.44771 49.4477 1 50 1ZM31.5 17.9571C31.0217 18.2332 30.4101 18.0693 30.134 17.591L25.134 8.93078C24.8578 8.45249 25.0217 7.8409 25.5 7.56475C25.9783 7.28861 26.5899 7.45249 26.866 7.93078L31.866 16.591C32.1422 17.0693 31.9783 17.6809 31.5 17.9571ZM12 51C12.5523 51 13 50.5523 13 50C13 49.4477 12.5523 49 12 49L2 49C1.44772 49 1 49.4477 1 50C1 50.5523 1.44772 51 2 51L12 51ZM17.591 69.866C18.0693 69.5899 18.2332 68.9783 17.9571 68.5C17.6809 68.0217 17.0693 67.8578 16.591 68.134L7.93078 73.134C7.45249 73.4101 7.28861 74.0217 7.56475 74.5C7.8409 74.9783 8.45249 75.1422 8.93078 74.866L17.591 69.866ZM51 88C51 87.4477 50.5523 87 50 87C49.4477 87 49 87.4477 49 88L49 98C49 98.5523 49.4477 99 50 99C50.5523 99 51 98.5523 51 98L51 88ZM31.5 82.0429C31.9783 82.3191 32.1422 82.9307 31.866 83.409L26.866 92.0692C26.5899 92.5475 25.9783 92.7114 25.5 92.4352C25.0217 92.1591 24.8578 91.5475 25.134 91.0692L30.134 82.409C30.4101 81.9307 31.0217 81.7668 31.5 82.0429ZM16.591 31.866C17.0693 32.1422 17.6809 31.9783 17.9571 31.5C18.2332 31.0217 18.0693 30.4101 17.591 30.134L8.93078 25.134C8.45249 24.8578 7.8409 25.0217 7.56476 25.5C7.28862 25.9783 7.45249 26.5899 7.93078 26.866L16.591 31.866ZM92.0692 26.866C92.5475 26.5899 92.7114 25.9783 92.4353 25.5C92.1591 25.0217 91.5475 24.8578 91.0692 25.134L82.409 30.134C81.9307 30.4101 81.7668 31.0217 82.0429 31.5C82.3191 31.9783 82.9307 32.1422 83.409 31.866L92.0692 26.866ZM74.5 7.56476C74.9783 7.8409 75.1422 8.45249 74.866 8.93078L69.866 17.591C69.5899 18.0693 68.9783 18.2332 68.5 17.9571C68.0217 17.6809 67.8578 17.0693 68.134 16.591L73.134 7.93078C73.4101 7.45249 74.0217 7.28861 74.5 7.56476ZM98 51C98.5523 51 99 50.5523 99 50C99 49.4477 98.5523 49 98 49L88 49C87.4477 49 87 49.4477 87 50C87 50.5523 87.4477 51 88 51L98 51ZM74.5 92.4352C74.0217 92.7114 73.4101 92.5475 73.134 92.0692L68.134 83.409C67.8578 82.9307 68.0217 82.3191 68.5 82.0429C68.9783 81.7668 69.5899 81.9307 69.866 82.409L74.866 91.0692C75.1422 91.5475 74.9783 92.1591 74.5 92.4352ZM91.0692 74.866C91.5475 75.1422 92.1591 74.9783 92.4352 74.5C92.7114 74.0217 92.5475 73.4101 92.0692 73.134L83.409 68.134C82.9307 67.8578 82.3191 68.0217 82.0429 68.5C81.7668 68.9783 81.9307 69.5899 82.409 69.866L91.0692 74.866Z" />\n  <path class="ClockGraphic-Hour-Hand" d="M71.1642 50.4857C71.6384 50.4918 72 50.4964 72 50C72 49.4925 71.622 49.4955 71.1322 49.4993C71.089 49.4997 71.0448 49.5 71 49.5L52.0706 48.5986C51.621 47.9356 50.8614 47.5 50 47.5C48.6193 47.5 47.5 48.6193 47.5 50C47.5 51.3807 48.6193 52.5 50 52.5C50.8621 52.5 51.6222 52.0637 52.0717 51.3998L71 50.4844C71.0559 50.4844 71.1108 50.4851 71.1642 50.4857Z"/>\n  <path class="ClockGraphic-Minute-Hand" d="M50.4858 16.8358C50.4918 16.3616 50.4964 16 50 16C49.4925 16 49.4955 16.378 49.4993 16.8678C49.4997 16.911 49.5 16.9552 49.5 17L48.562 47.9547C47.9196 48.4072 47.5 49.1546 47.5 50C47.5 51.3807 48.6193 52.5 50 52.5C51.3807 52.5 52.5 51.3807 52.5 50C52.5 49.1542 52.0799 48.4064 51.437 47.954L50.4844 17C50.4844 16.9441 50.4851 16.8892 50.4858 16.8358Z" />\n  <path class="ClockGraphic-Second-Hand" d="M50.5 6H49.5V47.55C48.3589 47.7816 47.5 48.7905 47.5 50C47.5 51.3807 48.6193 52.5 50 52.5C51.3807 52.5 52.5 51.3807 52.5 50C52.5 48.7905 51.6411 47.7816 50.5 47.55V6Z" />\n  <circle class="ClockGraphic-CenterCutout" cx="50" cy="50" r="1.5" />\n</svg>'},14021:e=>{e.exports='<svg class="ClockIcon ClockIcon--medium" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n<rect class="ClockIcon-TimeMinute" x="7" y="4" width="2" height="5" rx="1" />\n<rect class="ClockIcon-TimeHour" x="7" y="7" width="4" height="2" rx="1" />\n<path fill-rule="evenodd" d="M8 13.4C10.9823 13.4 13.4 10.9823 13.4 8C13.4 5.01766 10.9823 2.6 8 2.6C5.01766 2.6 2.6 5.01766 2.6 8C2.6 10.9823 5.01766 13.4 8 13.4ZM8 15C11.866 15 15 11.866 15 8C15 4.13401 11.866 1 8 1C4.13401 1 1 4.13401 1 8C1 11.866 4.13401 15 8 15Z" />\n<path class="ClockIcon-AlarmBell" d="M1.00001 0.99996C-0.114362 2.11433 -0.114362 3.92107 1.00001 5.03544L5.03549 0.99996C3.92112 -0.114407 2.11437 -0.114407 1.00001 0.99996Z"/>\n<path class="ClockIcon-AlarmBell" d="M15.0355 0.99996C16.1499 2.11433 16.1499 3.92107 15.0355 5.03544L11 0.99996C12.1144 -0.114407 13.9211 -0.114407 15.0355 0.99996Z"/>\n<circle class="ClockIcon-CountdownHour" cx="8" cy="8" r="3"/>\n<circle class="ClockIcon-CountdownMinute" cx="8" cy="8" r="3"/>\n</svg>\n'},68777:e=>{e.exports='<svg class="ClockIcon ClockIcon--small" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n<rect class="ClockIcon-TimeMinute" x="7.5" y="3" width="1" height="5.5" rx="0.5"/>\n<rect class="ClockIcon-TimeHour" x="7.5" y="7.5" width="3.5" height="1" rx="0.5"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M8 14C11.3137 14 14 11.3137 14 8C14 4.68629 11.3137 2 8 2C4.68629 2 2 4.68629 2 8C2 11.3137 4.68629 14 8 14ZM8 15C11.866 15 15 11.866 15 8C15 4.13401 11.866 1 8 1C4.13401 1 1 4.13401 1 8C1 11.866 4.13401 15 8 15Z"/>\n<path class="ClockIcon-AlarmBell" d="M1.00001 0.99996C-0.114362 2.11433 -0.114362 3.92107 1.00001 5.03544L5.03549 0.99996C3.92112 -0.114407 2.11437 -0.114407 1.00001 0.99996Z"/>\n<path class="ClockIcon-AlarmBell" d="M15.0355 0.99996C16.1499 2.11433 16.1499 3.92107 15.0355 5.03544L11 0.99996C12.1144 -0.114407 13.9211 -0.114407 15.0355 0.99996Z"/>\n<circle class="ClockIcon-CountdownHour" cx="8" cy="8" r="3"/>\n<circle class="ClockIcon-CountdownMinute" cx="8" cy="8" r="3"/>\n</svg>'},57396:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M4.29289 4.29289C4.68342 3.90237 5.31658 3.90237 5.70711 4.29289L8 6.58579L10.2929 4.29289C10.6834 3.90237 11.3166 3.90237 11.7071 4.29289C12.0976 4.68342 12.0976 5.31658 11.7071 5.70711L9.41421 8L11.7071 10.2929C12.0976 10.6834 12.0976 11.3166 11.7071 11.7071C11.3166 12.0976 10.6834 12.0976 10.2929 11.7071L8 9.41421L5.70711 11.7071C5.31658 12.0976 4.68342 12.0976 4.29289 11.7071C3.90237 11.3166 3.90237 10.6834 4.29289 10.2929L6.58579 8L4.29289 5.70711C3.90237 5.31658 3.90237 4.68342 4.29289 4.29289Z"/>\n</svg>\n'},24344:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26">\n  <path d="M13 4.2c.4-1.2-1.5-2-2.5-2.2.2 0 .7.5.7 1.6C11.3 5 9 5.7 9 7.4c.1 1.4 2.1 2.3 3.1 2.6l-1.4-1.4c-1-1 1.6-2.9 2.2-4.4zM16 7.4c.2-.8-.7-1.3-1.2-1.4 0 0 .3.3.3 1 0 .8-1.2 1.3-1.1 2.4 0 .9 1 1.4 1.6 1.6l-.8-.8c-.5-.7.9-1.9 1.2-2.8z"/>\n  <path fill-rule="evenodd" d="M6.2 12c0 1.5.4 5.2 3.2 7H6.2c0 .7.6 2 2.4 2h8.8c.8-.1 2.3-.6 2.2-2h-3.4l1.2-1c2.8-.3 4-1.2 4-3a2 2 0 00-1.8-2v-.8-.2H6.3zm13.3 1.8a8.2 8.2 0 01-1.2 3.1c.5.2 2-.5 2.2-1.4.3-1-.4-1.5-1-1.7z"/>\n</svg>\n'},32132:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path d="M7.4 1.7C7.8.7 6.4.2 5.6 0c.2 0 .5.4.5 1.2.1 1.1-1.7 1.7-1.6 3 0 1.1 1.6 1.8 2.3 2l-1-1c-.9-.9 1.1-2.3 1.6-3.5zM9.6 4.2c.2-.6-.5-1-.8-1 0 0 .2.1.2.7s-.9 1-.8 1.9c0 .6.8 1 1.2 1.2l-.6-.7c-.4-.5.6-1.4.8-2.1z"/>\n  <path fill-rule="evenodd" d="M2.7 7c0 1.1.3 3.6 2.3 5H2.7c0 .5.4 2 1.7 2h7.3c.6 0 1.6-1 1.6-2H11l.7-.5c1.6 0 2.8-.7 2.8-2 0-1-.8-1.4-1.2-1.4v-.8V7H2.7zm10.5 1.7A4.4 4.4 0 0112 11c.4 0 1.8-.4 2-1.1 0-.7-.4-1.1-.8-1.2z"/>\n</svg>\n'},59260:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path d="M7.4 1.7C7.8.7 6.4.2 5.6 0c.2 0 .5.4.5 1.2.1 1.1-1.7 1.7-1.6 3 0 1.1 1.6 1.8 2.3 2l-1-1c-.9-.9 1.1-2.3 1.6-3.5zM9.6 4.2c.2-.6-.5-1-.8-1 0 0 .2.1.2.7s-.9 1-.8 1.9c0 .6.8 1 1.2 1.2l-.6-.7c-.4-.5.6-1.4.8-2.1z"/>\n  <path fill-rule="evenodd" d="M12.7 8.1a13 13 0 00.1-1L3.2 7a8.4 8.4 0 000 1c0 1.2.3 2.8 1 4a3.3 3.3 0 001 1H3c0 .5.3 1 1.5 1h6.6c.6 0 1.6-.6 1.6-1h-2.1l.8-.8h.4c.3.2.7 0 .9 0l.6-.3c.4-.3.9-.7 1-1.4a2 2 0 00-.3-1.6 2 2 0 00-1.1-.7h-.3zm-2.5 4l-1.3.9h-2l-1.1-.8c-.6-.4-1-1.3-1.3-2.5L4.2 8h7.6l-.4 2c-.3 1.1-.8 1.9-1.2 2.2zm3.3-1.8c-.2.7-1 1-1.4 1a3.6 3.6 0 00.6-1.5v-.6c.5 0 .9.4.8 1.1z"/>\n</svg>\n'},12340:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M13 5l3 2.5-3 2.5v-5zM0 4h11v1h-11zM0 6h11v1h-11zM0 8h11v1h-11zM0 10h7v1h-7z"/></svg>'},85749:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M15 10l-3-2.5 3-2.5v5zM3 4h7v1h-7zM3 6h7v1h-7zM3 8h7v1h-7zM3 10h4v1h-4z"/></svg>'},74836:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.5 3c-1.933 0-3.5 1.567-3.5 3.5 0 .763.244 1.468.659 2.044l.015.021 2.393 4.173c.192.335.675.335.868 0l2.393-4.173.015-.021c.414-.574.658-1.28.658-2.044 0-1.933-1.567-3.5-3.5-3.5zm-4.5 3.5c0-2.485 2.015-4.5 4.5-4.5s4.5 2.015 4.5 4.5c0 .971-.308 1.871-.832 2.607l-2.367 4.129c-.576 1.005-2.026 1.005-2.603 0l-2.367-4.129c-.523-.736-.832-1.636-.832-2.607zm2.4 0c0-1.16.94-2.1 2.1-2.1 1.16 0 2.1.94 2.1 2.1 0 1.16-.94 2.1-2.1 2.1-1.16 0-2.1-.94-2.1-2.1zm2.1-1.1c-.608 0-1.1.492-1.1 1.1 0 .608.492 1.1 1.1 1.1.608 0 1.1-.492 1.1-1.1 0-.608-.492-1.1-1.1-1.1z"/>\n</svg>\n'},19194:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M11.293 5h-6.586l3.293 3.293 3.293-3.293zm-8 0h-.293v6h10v-6h-.293l-4.354 4.354-.354.354-.354-.354-4.354-4.354zm-1.293 0c0-.552.448-1 1-1h10c.552 0 1 .448 1 1v6c0 .552-.448 1-1 1h-10c-.552 0-1-.448-1-1v-6z"/>\n</svg>\n'},19914:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M6.962 2.392c.481.347.867.895 1.078 1.55.211.655.22 1.333.043 1.906-.176.571-.555 1.083-1.145 1.295l-.31.078c.117.414.284.828.504 1.231.203.372.437.707.691 1.002l.204-.225c.465-.43 1.085-.53 1.664-.4.576.129 1.137.484 1.572 1.009.435.525.688 1.151.73 1.751.043.598-.123 1.213-.582 1.638-.467.431-1.377.845-2.536.761-1.898-.137-3.372-1.757-4.509-3.838-.571-1.045-1.013-2.2-1.226-3.306-.211-1.097-.207-2.198.179-3.096.169-.393.549-.758.888-1.024.351-.275.756-.517 1.069-.63.595-.214 1.205-.052 1.686.296zm-.585.811c-.286-.206-.553-.241-.763-.166-.178.064-.49.24-.792.476-.313.245-.521.481-.585.631-.275.641-.308 1.515-.116 2.512.19.988.592 2.046 1.122 3.016 1.114 2.039 2.359 3.223 3.704 3.32.895.065 1.53-.263 1.785-.498.18-.167.291-.452.264-.833-.027-.378-.191-.808-.503-1.184-.312-.377-.687-.597-1.02-.671-.33-.074-.592-.003-.767.159-.116.107-.201.26-.242.457l-.175.846-.646-.573c-.532-.472-1.008-1.066-1.388-1.761-.386-.706-.635-1.448-.753-2.177l-.13-.808.778.252c.164.053.314.051.45.003.215-.077.417-.287.528-.649.111-.359.115-.826-.039-1.305s-.425-.84-.712-1.046z" />\n</svg>\n'},20334:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M13.3534 15.3362L12.6964 15.8549L13.2839 16.4512L15.5566 18.7581C15.7104 18.9142 15.8954 19.186 16.0431 19.4859C16.1147 19.6312 16.1701 19.7682 16.2062 19.8835C16.2241 19.9407 16.2358 19.9877 16.2427 20.024C16.2492 20.0586 16.2499 20.0755 16.25 20.0772C16.25 20.0773 16.25 20.0773 16.25 20.0772C16.25 20.1856 16.2178 20.2178 16.2158 20.2198L16.2157 20.2199L16.2157 20.2199C16.2148 20.2209 16.1885 20.25 16.0909 20.25H7.90909C7.81154 20.25 7.78522 20.2209 7.7843 20.2199L7.78427 20.2199L7.78421 20.2198C7.78223 20.2178 7.75 20.1856 7.75 20.0772C7.75 19.4799 7.99815 19.21 8.44336 18.7581L10.7161 16.4512L11.3036 15.8549L10.6466 15.3362C9.99428 14.8212 9.56818 14.0167 9.56818 13.1565V12.2338C9.56818 10.8116 10.7598 9.68347 12.1428 9.75309C13.4047 9.82109 14.4318 10.9936 14.4318 12.4183V13.1565C14.4318 14.0167 14.0057 14.8212 13.3534 15.3362Z" stroke="currentColor" stroke-width="1.5"/>\n<path d="M10.9453 14.75L11.56 15.0414C11.8377 15.1731 12.1606 15.1697 12.4356 15.0322L13 14.75V17H11L10.9453 14.75Z" fill="currentColor"/>\n<path opacity="0.5" d="M16.1383 15.157C16.4859 14.4232 16.6899 13.6266 16.6899 12.83V12.1124C16.6899 10.5643 16.0335 9.16461 15 8.22087C15.4202 7.42507 15.862 7 17.1209 7C18.4139 7 19.2759 8.166 19.2759 9.2423V10.1392C19.2759 11.0361 18.845 11.4846 18.414 11.933L20.138 13.7269C20.569 14.1753 21 14.6238 21 15.0723C21 15.5207 20.569 15.9692 20.138 16H16.9485L16.1383 15.157Z" fill="currentColor"/>\n</svg>\n'},54098:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path opacity="0.5" d="M15.3601 14.0944C15.7634 13.2763 16 12.3882 16 11.5V10.7C16 8.97393 15.2386 7.41339 14.0397 6.36118C14.5271 5.47393 15.0397 5 16.5 5C18 5 19 6.3 19 7.5V8.5C19 9.49998 18.5 9.99995 18.0001 10.4999L20 12.5C20.5 13 21 13.5 21 14C21 14.5 20.5 15 20 15.0343H16.3L15.3601 14.0944Z"/>\n  <path d="M15 17L12.5 14.5C13.4 13.8 14 12.7 14 11.5V10.7C14 8.79999 12.6 7.09999 10.7 6.99999C8.7 6.89999 7 8.49999 7 10.5V11.5C7 12.7 7.6 13.8 8.5 14.5L6 17C5.5 17.5 5 18 5 19C5 19.6 5.4 20 6 20H15C15.6 20 16 19.6 16 19C16 18.5 15.5 17.5 15 17Z"/>\n</svg>\n'},83075:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M6.32251 9.83154L7.19854 9.13994C7.79551 8.66865 8.18182 7.93438 8.18182 7.15653V6.41832C8.18182 5.10311 7.23661 4.06267 6.1298 4.00275C4.89183 3.94068 3.81818 4.95267 3.81818 6.23377V7.15653C3.81818 7.93438 4.20449 8.66865 4.80146 9.13994L5.67749 9.83154L4.89418 10.6266L2.62145 12.9335C2.38143 13.1772 2.24309 13.3243 2.14494 13.4903C2.07175 13.6141 2.0124 13.7656 2.00172 14H9.98007C9.97658 13.9875 9.97247 13.9736 9.96766 13.9582C9.93608 13.8575 9.88589 13.7325 9.81884 13.5964C9.67866 13.3118 9.50782 13.0648 9.37855 12.9335L7.10582 10.6266L6.32251 9.83154ZM6.18182 3.0041C7.90909 3.09638 9.18182 4.66507 9.18182 6.41832V7.15653C9.18182 7.98554 8.87609 8.76283 8.37907 9.37224C8.21222 9.57682 8.02382 9.76248 7.81818 9.92482L8.52329 10.6405L10.0909 12.2317C10.5455 12.6931 11 13.6159 11 14.0772C11 14.6309 10.6364 15 10.0909 15H1.90909C1.36364 15 1 14.6309 1 14.0772C1 13.1545 1.45455 12.6931 1.90909 12.2317L3.47671 10.6405L4.18182 9.92482C3.97618 9.76248 3.78778 9.57682 3.62093 9.37224C3.12391 8.76283 2.81818 7.98554 2.81818 7.15653V6.23377C2.81818 4.38824 4.36364 2.91183 6.18182 3.0041Z"/>\n  <path opacity="0.5" d="M10.1383 9.15699C10.4859 8.42321 10.6899 7.6266 10.6899 6.82998V6.11244C10.6899 4.5643 10.0335 3.16461 9 2.22087C9.42021 1.42507 9.86201 1 11.1209 1C12.4139 1 13.2759 2.166 13.2759 3.2423V4.13922C13.2759 5.03612 12.845 5.48456 12.414 5.93301L14.138 7.72688C14.569 8.17534 15 8.6238 15 9.07226C15 9.52072 14.569 9.96918 14.138 10H10.9485L10.1383 9.15699Z"/>\n</svg>\n'},38546:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path class="small-icon-fill" d="M4 4h4l.5 3-1 3 2.5 3 .5 1.5h-9l1-2 2-2.5-1-3L4 4z"/>\n  <path class="small-icon-outline" fill-rule="evenodd" d="M6.323 9.832l.876-.692c.597-.471.983-1.206.983-1.983v-.739c0-1.315-.945-2.355-2.052-2.415-1.238-.062-2.312.95-2.312 2.23v.924c0 .777.386 1.512.983 1.983l.876.692-.783.795-2.273 2.306c-.24.244-.378.391-.476.557a1.038 1.038 0 00-.143.51H9.98a2.621 2.621 0 00-.161-.404 2.758 2.758 0 00-.44-.662l-2.273-2.307-.783-.795zm-.141-6.828c1.727.092 3 1.661 3 3.414v.739c0 .829-.306 1.606-.803 2.215-.167.205-.355.39-.56.553l.704.715 1.568 1.592c.455.461.909 1.384.909 1.845 0 .554-.364.923-.91.923H1.91c-.546 0-.91-.37-.91-.923 0-.922.455-1.384.91-1.845l1.567-1.591.705-.716a3.616 3.616 0 01-.561-.553 3.516 3.516 0 01-.803-2.215v-.923c0-1.846 1.546-3.322 3.364-3.23z"/>\n  <path class="small-icon-outline" opacity=".5" d="M10.138 9.157c.348-.734.552-1.53.552-2.327v-.718A5.267 5.267 0 009 2.221C9.42 1.425 9.862 1 11.12 1c1.294 0 2.156 1.166 2.156 2.242v.897c0 .897-.431 1.346-.862 1.794l1.724 1.794c.431.448.862.897.862 1.345 0 .449-.431.897-.862.928h-3.19l-.81-.843z"/>\n</svg>\n'},31789:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M2.5 2C2.22386 2 2 2.22386 2 2.5V12.5C2 12.7761 2.22386 13 2.5 13H5.5C5.77614 13 6 12.7761 6 12.5C6 12.2239 5.77614 12 5.5 12H3V3H10V4.5C10 4.77614 10.2239 5 10.5 5C10.7761 5 11 4.77614 11 4.5V2.5C11 2.22386 10.7761 2 10.5 2H2.5ZM7.5 6C7.22386 6 7 6.22386 7 6.5V13.5C7 13.7761 7.22386 14 7.5 14H13.5C13.7761 14 14 13.7761 14 13.5V6.5C14 6.22386 13.7761 6 13.5 6H7.5ZM8 13V7H13V13H8Z"/>\n</svg>'},77448:e=>{e.exports='<svg width="140" height="129" viewBox="0 0 140 129" xmlns="http://www.w3.org/2000/svg">\n<g>\n<g clip-path="url(#clip0_1_63)">\n<rect y="0.5" width="140" height="128" fill="var(--colorBg)"/>\n<rect y="101" width="140" height="27" fill="var(--colorBgDark)"/>\n<rect x="21" y="24" width="102" height="68" rx="5" fill="var(--colorBgLighter)" stroke="var(--colorFg)" stroke-width="2"/>\n<g>\n<path fill="none" d="M70.125 40.8125H71.8438C72.7932 40.8125 73.5625 41.5818 73.5625 42.5312V55.1049C73.5625 55.6481 73.7234 56.1788 74.0245 56.6305L74.9375 58L74.0245 59.3695C73.7234 59.8212 73.5625 60.3519 73.5625 60.8951V73.4688C73.5625 74.4182 72.7932 75.1875 71.8438 75.1875H70.1903" stroke="var(--colorErrorBg)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n<path fill="none" d="M39.875 40.8125H38.1562C37.2068 40.8125 36.4375 41.5818 36.4375 42.5312V55.1049C36.4375 55.6481 36.2766 56.1788 35.9755 56.6305L35.0625 58L35.9755 59.3695C36.2766 59.8212 36.4375 60.3519 36.4375 60.8951V73.4688C36.4375 74.4182 37.2068 75.1875 38.1562 75.1875H39.8097" stroke="var(--colorErrorBg)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n<path fill="none" d="M46.0625 40.8125H47.4375V49.0625" stroke="var(--colorErrorBg)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n<path fill="none" d="M61.875 40.8125H63.25V49.0625" stroke="var(--colorErrorBg)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n<path fill="none" d="M56.0312 40.8125H53.9688C53.0195 40.8125 52.25 41.582 52.25 42.5312V47.3438C52.25 48.293 53.0195 49.0625 53.9688 49.0625H56.0312C56.9805 49.0625 57.75 48.293 57.75 47.3438V42.5312C57.75 41.582 56.9805 40.8125 56.0312 40.8125Z" stroke="var(--colorErrorBg)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n<path fill="none" d="M46.0625 66.9375H47.4375V75.1875" stroke="var(--colorErrorBg)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n<path fill="none" d="M61.875 66.9375H63.25V75.1875" stroke="var(--colorErrorBg)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n<path fill="none" d="M56.0312 66.9375H53.9688C53.0195 66.9375 52.25 67.707 52.25 68.6562V73.4688C52.25 74.418 53.0195 75.1875 53.9688 75.1875H56.0312C56.9805 75.1875 57.75 74.418 57.75 73.4688V68.6562C57.75 67.707 56.9805 66.9375 56.0312 66.9375Z" stroke="var(--colorErrorBg)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n<path fill="none" d="M54.3125 53.875H55.6875V62.125" stroke="var(--colorErrorBg)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n<path fill="none" d="M48.4688 53.875H46.4062C45.457 53.875 44.6875 54.6445 44.6875 55.5938V60.4062C44.6875 61.3555 45.457 62.125 46.4062 62.125H48.4688C49.418 62.125 50.1875 61.3555 50.1875 60.4062V55.5938C50.1875 54.6445 49.418 53.875 48.4688 53.875Z" stroke="var(--colorErrorBg)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n<path fill="none" d="M64.2812 53.875H62.2188C61.2695 53.875 60.5 54.6445 60.5 55.5938V60.4062C60.5 61.3555 61.2695 62.125 62.2188 62.125H64.2812C65.2305 62.125 66 61.3555 66 60.4062V55.5938C66 54.6445 65.2305 53.875 64.2812 53.875Z" stroke="var(--colorErrorBg)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n</g>\n<g>\n<path fill="none" d="M107 48H87V68H107V48Z" stroke="var(--colorFgFadedMost)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n<path fill="none" d="M92 54L96 58L92 62" stroke="var(--colorFgFadedMost)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n<path fill="none" d="M98 54H102" stroke="var(--colorFgFadedMost)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n<path fill="none" d="M98 62H102" stroke="var(--colorFgFadedMost)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n<path fill="none" d="M100 58H102" stroke="var(--colorFgFadedMost)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n</g>\n<rect width="18" height="8" transform="matrix(1 0 0 -1 63 101)" fill="var(--colorFg)"/>\n<rect width="52" height="5" rx="2.5" transform="matrix(1 0 0 -1 46 106)" fill="var(--colorFgFadedMore)"/>\n</g>\n</g>\n<defs>\n<clipPath>\n<rect y="0.5" width="140" height="128" rx="5" fill="var(--colorBgLighter)"/>\n</clipPath>\n</defs>\n</svg>\n'},6055:e=>{e.exports='<svg width="48" height="48" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M24 14a1 1 0 00-1 1v8h-8a1 1 0 100 2h8v8a1 1 0 102 0v-8h8a1 1 0 100-2h-8v-8a1 1 0 00-1-1z"/>\n</svg>\n'},46639:e=>{e.exports='\x3c!--  Mask definitions for SVG icons --\x3e\n<defs>\n  \x3c!-- shared paths --\x3e\n  <path id="folder-shape"\n    d="M0 3 1 2 7 2 8 3 8 4 15 4 16 5 16 13 15 14 1 14 0 13 Z"\n    stroke="#fff"\n    stroke-width="2"\n    stroke-opacity="1" />\n\n  <path id="sync-cloud"\n    d="M13.996 7.172C15.164 7.585 16 8.697 16 10c0 1.657-1.337 3-3.01 3H3.01C1.346 13 0 11.653 0 10c0-1.314.84-2.43 2.022-2.836C2.187 5.942 3.232 5 4.5 5c.667 0 1.272.26 1.72.686C6.765 4.123 8.25 3 10 3c2.21 0 4 1.79 4 4 0 .058 0 .115-.004.172z"/>\n\n  <g id="sd-group">\n    <path fill="#000" d="M8 8h8v8h-8z"/>\n    <path fill="#fff" d="M13 9h3v3h-3z"/>\n    <path fill="#fff" d="M13 13h3v3h-3z"/>\n    <path fill="#fff" d="M9 9h3v3h-3z"/>\n    <path fill="#fff" d="M9 13h3v3h-3z"/>\n  </g>\n\n  <path id="sd-bookmark"\n    d="M44 29v34l11-5.667 11 5.667v-34h-22zm11 24.5l-8 4.41v-25.91h16v26l-8-4.5z"/>\n\n  <filter id="sd-bookmark-filter" x="-50%" y="-50%" width="200%" height="200%" filterUnits="objectBoundingBox">\n    <feOffset dx="1" dy="1" in="SourceAlpha" result="shadowOffset"/>\n    <feGaussianBlur stdDeviation=".5" in="shadowOffset" result="shadowBlur"/>\n    <feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.08 0" in="shadowBlur"/>\n  </filter>\n\n  \x3c!-- content blocker --\x3e\n  <path id="shield-shadow" d="M8 14.5c2.432-1.085 4.601-3.009 5.5-5v-7L8 1.5v13z" fill-opacity=".1"/>\n  <path id="shield-outline" d="m8 1.5-5.5 1v7C4 12 5 13 8 14.5c3-1.5 4-2.5 5.5-5v-7L8 1.5z" stroke="currentColor" fill="none"/>\n  <mask id="shield-mask">\n    <path d="M2 11 12 1H2v10zm12-6L4 15h10V5z" fill="#fff"/>\n  </mask>\n\n  \x3c!-- gradients --\x3e\n  <linearGradient id="border-gradient" x1="0" y1="0" x2="0" y2="1">\n    <stop stop-color="#fff" stop-opacity="0.3" offset="0"/>\n    <stop stop-color="#fff" stop-opacity="0.6" offset="1"/>\n  </linearGradient>\n\n  <linearGradient id="icon-gradient" x1="0" y1="0" x2="0" y2="1">\n    <stop stop-color="#fff" stop-opacity="0" offset="0.3"/>\n    <stop stop-color="#fff" stop-opacity="0.2" offset="1"/>\n  </linearGradient>\n\n  <linearGradient id="sd-bookmark-gradient" x1="0" y1="1" x2="1" y2="1">\n    <stop stop-color="#000" stop-opacity="0" offset="0.5"/>\n    <stop stop-color="#000" stop-opacity="1" offset="0.5"/>\n  </linearGradient>\n\n  <linearGradient id="sd-folder-gradient" x1="20%" y1="111%" x2="90%" y2="80%">\n    <stop stop-color="var(--colorBgLight)" offset="0%"/>\n    <stop stop-color="var(--colorBgLight)" offset="82%"/>\n    <stop stop-color="var(--colorBg)" offset="83%"/>\n    <stop stop-color="var(--colorBg)" offset="100%"/>\n  </linearGradient>\n\n  <linearGradient id="bookmark-graphic-gradient" x1="0%" y1="0%" x2="100%" y2="100%">\n    <stop stop-color="rgba(0,0,0, 0.1)" offset="0%"/>\n    <stop stop-color="transparent" offset="70%"/>\n  </linearGradient>\n\n  <linearGradient x1="0.15" y1="0.3" x2="0.3" y2="0.5" id="guest-intro-bg-gradient">\n    <stop offset="0" stop-color="var(--colorFg)" stop-opacity="0.03" />\n    <stop offset="1" stop-color="var(--colorFg)" stop-opacity="0.003" />\n  </linearGradient>\n\n  <linearGradient x1="1" y1="0" x2="0" y2="1" id="guest-intro-accent-gradient">\n    <stop offset="0" stop-color="var(--colorAccentBg)" stop-opacity="0" />\n    <stop offset="0.5" stop-color="var(--colorAccentBg)" stop-opacity="1" />\n    <stop offset="1" stop-color="var(--colorAccentBg)" stop-opacity="0" />\n  </linearGradient>\n\n  <linearGradient id="private-ghost-gradient" x1="35" y1="0" x2="35" y2="80" gradientUnits="userSpaceOnUse">\n    <stop stop-color="var(--colorFg)" stop-opacity=".8"/>\n    <stop stop-color="var(--colorFg)" offset="1" stop-opacity=".2"/>\n  </linearGradient>\n\n\n  \x3c!-- masks --\x3e\n  <mask id="trash-folder-mask">\n    <path d="M11 1v-1h-6v1h-4v1h14v-1h-4z" fill="#fff" />\n    <path d="M3 3h10v12h-10v-12z" fill="#000"\n      stroke="#fff" stroke-width="2" stroke-opacity="1" />\n    <path d="M6 6h1v6h-1z" fill="#fff" />\n    <path d="M9 6h1v6h-1z" fill="#fff" />\n  </mask>\n\n  <mask id="icon-mask">\n    <path d="M4 14v-12h7v12l-3.5-2.8-3.5 2.8z"\n      stroke="url(#border-gradient)"\n      stroke-width="2"\n      stroke-opacity="1"/>\n  </mask>\n\n  <mask id="mail-mask-unseen">\n    <circle cx="8" cy="8" r="4" fill="#fff" />\n    <circle cx="8" cy="8" r="2" fill="#000" />\n  </mask>\n\n  <mask id="sync-cloud-mask" x="0" y="0" width="16" height="10" fill="#fff">\n    <use xlink:href="#sync-cloud" />\n    <use mask="url(#sync-cloud-mask)"\n      xlink:href="#sync-cloud" />\n  </mask>\n\n  \x3c!-- patterns --\x3e\n  <pattern id="diagonalLinePattern" x="4" y="4" width="8" height="8" patternUnits="userSpaceOnUse" patternTransform="rotate(45)">\n    <rect x="0" y="0" width="4" height="8" style="stroke: none; fill: var(--colorHighlightBg)" />\n  </pattern>\n\n</defs>\n'},85569:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <rect x="8" y="0" width="1" height="16" />\n</svg>\n'},66413:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path d="M3.88 2.5h-.69v2.75h1.37V3.91A8.21 8.21 0 0 1 9.2 5.83l-.95.95 1 1 .95-.95a8.21 8.21 0 0 1 1.92 4.63h-1.37v1.38h2.75v-.69A9.64 9.64 0 0 0 3.88 2.5z"/>\n  <path d="M8.28 8.69l-1-1-1.83 1.89a2 2 0 0 0-.88-.21 2.06 2.06 0 1 0 2.06 2.06 2 2 0 0 0-.21-.88z"/>\n</svg>\n'},44231:e=>{e.exports='<svg class="download-empty-state" width="46" height="46" viewBox="0 0 46 46" xmlns="http://www.w3.org/2000/svg">\n  <path class="border-color" d="M8 34C8 33.4477 7.55228 33 7 33V33C6.44772 33 6 33.4477 6 34V39C6 40.6569 7.34315 42 9 42H37C38.6569 42 40 40.6569 40 39V34C40 33.4477 39.5523 33 39 33V33C38.4477 33 38 33.4477 38 34V39C38 39.5523 37.5523 40 37 40H9C8.44772 40 8 39.5523 8 39V34Z"/>\n  <path class="main-fill-color" fill-rule="evenodd" clip-rule="evenodd" d="M29 6H17V21H13L23 30L33 21H29V6Z"/>\n  <path class="secondary-color" d="M29 6H23V30L33 21H29V6Z"/>\n  <rect class="download-progressbar" x="9" y="35" width="22" height="4" rx="1"/>\n</svg>\n'},55430:e=>{e.exports='<svg width="16" height="16" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path class="progress-bar-container" fill-rule="evenodd" clip-rule="evenodd" d="M1 14.857V12h1v2.841a.505.505 0 00.037.157l.04.002h11.822a.323.323 0 00.089-.024.447.447 0 00.012-.119v-2.856L15 12v2.857C15 16 13.923 16 13.923 16H2.077C1 16 1 14.857 1 14.857zm12.984.131a.017.017 0 01-.002.003l.002-.003z"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 0H6v6H2l6 5 6-5h-4V0zM7 7V1h2v6h2.238L8 9.698 4.762 7H7z"/>\n</svg>\n'},15902:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path class="small-icon-fill progress-bar-container" fill-rule="evenodd" clip-rule="evenodd" d="M1 12v2.857S1 16 2.077 16h11.846S15 16 15 14.857V12h-1v2.857c0 .064-.007.1-.012.12A.289.289 0 0113.9 15H2.076c-.017 0-.03 0-.04-.002A.485.485 0 012 14.841V12H1zm1.01 2.993l.003.001a.023.023 0 01-.003 0zm11.972-.002l.002-.003-.002.003z"/>\n  <path class="small-icon-fill" d="M6 6V0h4v6h4l-6 5-6-5h4z"/>\n  <path class="small-icon-outline" fill-rule="evenodd" d="M7 7H4.762L8 9.698 11.238 7H9V1H7v6zm2-7h1v6h4l-1.2 1L8 11 3.2 7 2 6h4V0h3z"/>\n</svg>\n'},25075:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M8.25 18V19.25C8.25 19.8023 8.69772 20.25 9.25 20.25H18.75C19.3023 20.25 19.75 19.8023 19.75 19.25V18" stroke="currentColor" stroke-width="1.5"/>\n  <path d="M14 7.5V15.5M14 15.5L10.5 12M14 15.5L17.5 12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n</svg>\n'},64086:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M17 7.12132L17.7071 6.41422C18.4882 5.63317 19.7545 5.63317 20.5355 6.41422C21.3166 7.19527 21.3166 8.4616 20.5355 9.24264L19.8284 9.94975L17 7.12132Z" fill="currentColor"/>\n<path d="M8.00424 16.1758L16.4895 7.69052L19.318 10.5189L10.8327 19.0042H8.00424V16.1758Z" fill="currentColor"/>\n<path d="M8 21H20" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n</svg>\n'},84435:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\r\n  <rect x="2" y="14" width="12" height="1" rx="0.5"/>\r\n  <path d="M3 10.5L9.5 4L12 6.5L5.5 13L3 13L3 10.5Z"/>\r\n  <path d="M10.7929 2.70711L10 3.5L12.5 6L13.2929 5.20711C13.6834 4.81658 13.6834 4.18342 13.2929 3.79289L12.2071 2.70711C11.8166 2.31658 11.1834 2.31658 10.7929 2.70711Z"/>\r\n</svg>\r\n'},83947:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M11.1464 3.06066C11.3417 2.8654 11.6583 2.8654 11.8535 3.06066L12.9393 4.14645C13.1346 4.34171 13.1346 4.65829 12.9393 4.85356L12 5.7929L10.2071 4L11.1464 3.06066ZM12.5607 2.35356C11.9749 1.76777 11.0251 1.76777 10.4393 2.35355L9.14644 3.64645L8.79289 4L9.14644 4.35356L11.6464 6.85356L12 7.20711L12.3535 6.85356L13.6464 5.56066C14.2322 4.97488 14.2322 4.02513 13.6464 3.43934L12.5607 2.35356ZM2.42215 10.3707L2.25491 10.538L2.27811 10.7733L2.50241 13.049L2.54265 13.4573L2.95095 13.4976L5.22666 13.7219L5.46202 13.7451L5.62925 13.5778L10.9629 8.24418L11.3165 7.89063L10.9629 7.53707L8.46292 5.03707L8.10937 4.68352L7.75582 5.03707L2.42215 10.3707ZM3.45734 12.5427L3.29649 10.9106L8.10937 6.09773L9.90226 7.89063L5.08938 12.7035L3.45734 12.5427Z"/>\n</svg>\n'},34830:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M14.5 1.28a1.04 1.04 0 00-1.42 0l-.7.67 2.12 2.01.7-.67c.4-.37.4-.97 0-1.34l-.7-.67zM13.79 4.63l-2.12-2.01L5 8.99V11h2.12l6.67-6.37z"/>\n  <path fill-rule="evenodd" d="M4 2a3 3 0 00-3 3v7a3 3 0 003 3h4a3 3 0 003-3v-2h-1l-1 1v1a1 1 0 01-1 1H4a1 1 0 01-1-1V5a1 1 0 011-1h3l1-1V2H4z"/>\n</svg>'},27476:e=>{e.exports='<svg width="22" height="22" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">\n  <path d="M6.777 16.002c-1.32-1.32-1.362-3.48-.09-4.753l5.198-5.2c.932-.932 2.488-.902 3.456.067.97.968 1.146 2.67.214 3.602l-5.1 5.1c-.594.593-1.69.428-2.307-.188s-.745-1.677-.152-2.27l4.98-4.98.644.642-4.98 4.98c-.256.255-.122.728.142.992.265.264.756.417 1.01.163l5.1-5.1c.594-.595.43-1.69-.186-2.308-.617-.616-1.567-.634-2.16-.04l-5.2 5.198c-.932.932-.902 2.487.067 3.456.968.97 2.524.998 3.456.066l3.815-3.636.57.57-3.726 3.726c-1.272 1.272-3.432 1.23-4.753-.09z"/>\n</svg>\n'},59753:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M6.25 11V8.75C6.25 8.19772 6.69772 7.75 7.25 7.75H20.75C21.3023 7.75 21.75 8.19772 21.75 8.75V11H21.25C20.9739 11 20.75 11.2239 20.75 11.5V17.75C20.75 18.8546 19.8546 19.75 18.75 19.75H9.25C8.14543 19.75 7.25 18.8546 7.25 17.75V11.5C7.25 11.2239 7.02614 11 6.75 11H6.25Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n  <path d="M7.5 11.5H20.5" stroke="currentColor" stroke-linecap="round"/>\n  <rect x="11" y="14" width="6" height="1.5" rx="0.75" fill="currentColor"/>\n</svg>\n'},5211:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M13 7v6H3V7h10zM1 6h14v7a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V6zm5.5 2h3a1 1 0 1 1 0 2h-3a1 1 0 0 1 0-2z"/>\n  <path fill-rule="evenodd" d="M14 4v3H2V4h12zM0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v3H0V4z"/>\n</svg>\n'},7773:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M13 7v5a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V7h10zM2 6h12v6a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6zm4.5 2h3a1 1 0 1 1 0 2h-3a1 1 0 0 1 0-2z"/>\n  <path fill-rule="evenodd" d="M13 4a1 1 0 0 1 1 1v1H2V5a1 1 0 0 1 1-1h10zM1 5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v2H1V5z"/>\n</svg>\n'},41601:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M14.857 11.3569L11.852 14.3619C11.169 15.0449 11.169 16.1529 11.852 16.8369C12.535 17.5199 13.643 17.5199 14.327 16.8369L18.393 12.7709C19.76 11.4039 19.76 9.1879 18.393 7.8209C17.026 6.4539 14.81 6.4539 13.443 7.8209L9.02395 12.2409C6.97395 14.2909 6.97395 17.6149 9.02395 19.6659C11.074 21.7159 14.398 21.7159 16.449 19.6659L20.514 15.5999" stroke="currentColor" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n'},31408:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M14.05 1.28a.96.96 0 00-1.35 0l-.68.67 2.03 2.01.67-.67a.95.95 0 000-1.34l-.67-.67zM13.37 4.63l-2.02-2.01L5 8.99V11h2.02l6.35-6.37z"/>\n  <path fill-rule="evenodd" d="M4 2a3 3 0 00-3 3v7a3 3 0 003 3h5a3 3 0 003-3V8l-1 1-1 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V5a1 1 0 011-1h4l1-1 .87-.87A3 3 0 009 2H4z"/>\n</svg>'},67955:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M13.414.5c-.398 0-.779.158-1.061.439l-1.061 1.061 2.707 2.707 1-1c.32-.32.5-.754.5-1.207 0-.453-.18-.887-.5-1.207l-.354-.354c-.281-.281-.663-.439-1.061-.439h-.172zm-.353 1.146c.094-.094.221-.146.353-.146h.172c.133 0 .26.053.353.146l.354.354c.133.133.207.312.207.5s-.075.367-.207.5l-.293.293-1.293-1.293.354-.354zM10.5 2.793l-5.5 5.5v2.707h2.707l5.5-5.5-2.707-2.707zm-4.5 7.207v-1.293l4.5-4.5 1.293 1.293-4.5 4.5h-1.293z"/><path d="M4 3h4l-1 1h-3c-.5 0-1 .5-1 1v7c0 .5.5 1 1 1h5c.552 0 1-.448 1-1v-1l1-1v2c0 1.105-.895 2-2 2h-5c-1.105 0-2-.895-2-2v-7c0-1 .895-2 2-2z"/></svg>'},50252:e=>{e.exports='<svg width="28" height="28" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path opacity=".3" fill-rule="evenodd" clip-rule="evenodd" d="M10 9h6v1h-6V9zm0 2h6v1h-6v-1zm3 2h-3v1h3v-1z" fill="currentColor"/>\n  <path d="M12 20H9a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M18.5 23a4.5 4.5 0 1 0 0-9 4.5 4.5 0 0 0 0 9zm-2-5.25c-.276 0-.5.336-.5.75s.224.75.5.75h4c.276 0 .5-.336.5-.75s-.224-.75-.5-.75h-4z" fill="currentColor"/>\n</svg>\n'},82032:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M11.5 7.091v-3.646c0-.544-.448-.985-1-.985h-6c-.5 0-1 .493-1 .985v8.093c0 .493.5.985 1 .985h2.5c.002.512.074 1.008.207 1.478h-3.207c-1.105 0-2-.882-2-1.97v-9.078c0-1.088.895-1.97 2-1.97h7c1.105 0 2 .882 2 1.97v4.048l-.054.018-.446-.018c-.341 0-.676.031-1 .091zM5 4h5v1h-5v-1zM10 6h-5v1h5v-1zM5 8h3v1h-3v-1z"/><path fill-rule="evenodd" clip-rule="evenodd" d="M16 12.5c0 1.933-1.567 3.5-3.5 3.5s-3.5-1.567-3.5-3.5 1.567-3.5 3.5-3.5 3.5 1.567 3.5 3.5zm-6 0c0-.276.224-.5.5-.5h4c.276 0 .5.224.5.5s-.224.5-.5.5h-4c-.276 0-.5-.224-.5-.5z"/></svg>'},39530:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M7.256 13h-2.256c-1.105 0-2-1-2-2v-7c0-1.105.895-2 2-2h5c1.105 0 2 .895 2 2v3.027c-.164-.018-.331-.027-.5-.027-.169 0-.336.009-.5.027v-3.027c0-.552-.448-1-1-1h-5c-.5 0-1 .5-1 1v7c0 .5.5 1 1 1h2.028c.038.347.116.682.229 1zm-2.256-9h5v1h-5v-1zm0 2h5v1h-5v-1zm2 2h-2v1h2v-1zm8 3.5c0 1.933-1.567 3.5-3.5 3.5s-3.5-1.567-3.5-3.5 1.567-3.5 3.5-3.5 3.5 1.567 3.5 3.5zm-6 0c0-.276.224-.5.5-.5h4c.276 0 .5.224.5.5s-.224.5-.5.5h-4c-.276 0-.5-.224-.5-.5z"/></svg>'},46202:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M9 7H14.6972L14.7173 7.00161C14.9592 7.01527 15.1782 7.11495 15.344 7.27055L15.4376 7.36609C15.8458 8.02551 16.0789 8.40484 16.1369 8.50409C16.3105 8.80127 16.632 9 17 9C17.0344 9 18.0344 9 20 9V15C20 15.5128 19.614 15.9355 19.1166 15.9933L15 16L14.8834 15.9933C14.5973 15.96 14.348 15.8061 14.1879 15.5836L13.5298 14.5341C13.3653 14.2072 13.0268 13.983 12.636 13.983L11 14C10.4872 14 10.0645 14.386 10.0067 14.8834L10 15V20C10 20.5523 9.55228 21 9 21C8.48717 21 8.06449 20.614 8.00673 20.1166L8 20V8C8 7.48717 8.38604 7.06449 8.88338 7.00673L9 7Z" fill="currentColor"/>\n</svg>\n'},30651:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M4 3h4.697l.02.002c.242.014.461.113.627.269l.094.096.699 1.138c.174.297.495.496.863.496h2v5c0 .513-.386.935-.883.993l-3.117.007-.117-.007c-.286-.033-.535-.187-.695-.41l-.658-1.05c-.165-.327-.503-.551-.894-.551l-.636.017c-.513 0-.936.386-.993.883l-.007.117v3c0 .552-.448 1-1 1-.513 0-.936-.386-.993-.883l-.007-.117v-9c0-.513.386-.936.883-.993l.117-.007z"/></svg>'},27436:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8.581 3h-3.581l-.117.007c-.497.058-.883.48-.883.993v8.5c0 .276.224.5.5.5s.5-.223.5-.5l.006-3.617c.058-.497.392-.883.993-.883.602 0 .865.207 1.03.534l.658 1.05c.16.222.409.376.695.41h2.733c.497-.058.883-.48.883-.993v-4h-1.117c-.368 0-.69-.199-.863-.496l-.699-1.138-.094-.096c-.166-.156-.385-.255-.627-.269l-.02-.002z"/></svg>'},4504:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M12.2929 8.29289L13.7071 9.70711C13.8946 9.89464 14.149 10 14.4142 10H19C20.1046 10 21 10.8954 21 12V18C21 19.1046 20.1046 20 19 20H9C7.89543 20 7 19.1046 7 18V10C7 8.89543 7.89543 8 9 8H11.5858C11.851 8 12.1054 8.10536 12.2929 8.29289ZM19 15L16 12V14H12.5C12.2239 14 12 14.2239 12 14.5V15.5C12 15.7761 12.2239 16 12.5 16H16V18L19 15Z" fill="currentColor"/>\n</svg>\n'},71318:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n\t<path fill-rule="evenodd" d="M8 4.958L6.8 3H3.2C2.54 3 2 3.563 2 4.25v7.5c0 .688.54 1.25 1.2 1.25h9.6c.66 0 1.2-.563 1.2-1.25V5.9c0-.688-.54-.942-1.2-.942H8zM12 9L9 6v2H5.5a.5.5 0 00-.5.5v1a.5.5 0 00.5.5H9v2l3-3z"/>\n</svg>\n'},14737:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n\t<path fill-rule="evenodd" d="M2.357 3.36A1.238 1.238 0 002 4.213v7.575a1.183 1.183 0 00.339.87 1.159 1.159 0 00.861.342h9.6c.317-.005.619-.134.843-.36.224-.227.352-.532.357-.852V6c0-.5-.5-1-1-1H8L6.8 3H3.2a1.214 1.214 0 00-.843.36zM3 11.823L3 11.805V4.223a.238.238 0 01.068-.159A.214.214 0 013.212 4h3.034L7.5 6h5.3c.11 0 .2.088.2.198v5.578a.238.238 0 01-.068.159.215.215 0 01-.144.064H3.165a.15.15 0 01-.115-.046.173.173 0 01-.05-.131z"/>\n\t<path fill-rule="evenodd" d="M3 11.822V4.223a.238.238 0 01.068-.159A.214.214 0 013.212 4h3.034L7.5 6h5.3c.11 0 .2.088.2.198v5.578a.238.238 0 01-.068.159.215.215 0 01-.144.064H3.165a.15.15 0 01-.115-.046.173.173 0 01-.05-.131z" fill-opacity=".1"/>\n\t<path d="M9.354 6.646a.5.5 0 10-.708.708L9.793 8.5H6a.5.5 0 000 1h3.793l-1.147 1.146a.5.5 0 00.708.708L11.707 9 9.354 6.646z"/>\n</svg>\n'},2157:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M13.0068 9.00685C13.0023 8.97012 13 8.93271 13 8.89474C13 8.40059 13.3944 8 13.881 8C14.1482 8 14.3876 8.12078 14.5491 8.31152C14.5705 8.32738 14.5909 8.3451 14.6102 8.36469L19.3389 13.3088C19.7087 13.6954 19.7087 14.3046 19.3389 14.6912L14.6102 19.6353C14.5909 19.6549 14.5705 19.6727 14.5491 19.6885C14.3875 19.8792 14.1482 20 13.881 20C13.3944 20 13 19.5994 13 19.1053C13 19.0673 13.0023 19.0299 13.0068 18.9932L13 19V9L13.0068 9.00685Z" fill="currentColor"/>\n<rect x="8" y="12" width="8" height="4" rx="1" fill="currentColor"/>\n</svg>\n'},59168:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8.006 3.839l-.006-.093c0-.412.338-.746.755-.746.229 0 .434.101.573.26l.052.044 3.93 3.995c.383.389.383 1.013 0 1.403l-3.93 3.995-.052.044c-.138.159-.344.26-.573.26-.417 0-.755-.334-.755-.746l.006-.093-.006.006v-8.333l.006.006z"/><rect x="3" y="6" width="8" height="4" rx="1"/></svg>'},56475:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M8 6.5h.5v-2.754c0-.13.108-.246.255-.246.08 0 .149.034.196.088l.038.043.043.031 3.922 3.987c.191.195.191.507 0 .701l-3.922 3.987-.043.031-.038.043c-.047.054-.116.088-.196.088-.147 0-.255-.116-.255-.246v-2.754h-4.5c-.276 0-.5-.224-.5-.5v-2c0-.276.224-.5.5-.5h4z"/>\n</svg>'},7096:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<mask id="path-1-inside-1_244_547" fill="white">\n<rect x="7" y="8" width="6" height="6" rx="1"/>\n</mask>\n<rect x="7" y="8" width="6" height="6" rx="1" stroke="currentColor" stroke-width="3" mask="url(#path-1-inside-1_244_547)"/>\n<mask id="path-2-inside-2_244_547" fill="white">\n<rect x="7" y="15" width="6" height="6" rx="1"/>\n</mask>\n<rect x="7" y="15" width="6" height="6" rx="1" stroke="currentColor" stroke-width="3" mask="url(#path-2-inside-2_244_547)"/>\n<mask id="path-3-inside-3_244_547" fill="white">\n<rect x="14" y="15" width="6" height="6" rx="1"/>\n</mask>\n<rect x="14" y="15" width="6" height="6" rx="1" stroke="currentColor" stroke-width="3" mask="url(#path-3-inside-3_244_547)"/>\n<path d="M15 11L17 13L21 8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n</svg>\n'},96387:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M2 1C1.44772 1 1 1.44772 1 2V6C1 6.55228 1.44772 7 2 7H6C6.55228 7 7 6.55228 7 6V2C7 1.44772 6.55228 1 6 1H2ZM3 3V5H5V3H3Z"/>\n  <path fill-rule="evenodd" d="M2 9C1.44772 9 1 9.44772 1 10V14C1 14.5523 1.44772 15 2 15H6C6.55228 15 7 14.5523 7 14V10C7 9.44772 6.55228 9 6 9H2ZM3 11V13H5V11H3Z"/>\n  <path fill-rule="evenodd" d="M9 10C9 9.44772 9.44772 9 10 9H14C14.5523 9 15 9.44772 15 10V14C15 14.5523 14.5523 15 14 15H10C9.44772 15 9 14.5523 9 14V10ZM11 13V11H13V13H11Z"/>\n  <path d="M11.0009 6.99992H11.0559C11.1963 6.9923 11.3336 6.95513 11.4587 6.89086C11.5838 6.82659 11.6939 6.73665 11.7819 6.62692L15.7819 1.62692C15.9479 1.41978 16.0249 1.15518 15.9958 0.891317C15.9667 0.627453 15.834 0.385944 15.6269 0.219918C15.5243 0.137711 15.4066 0.0765093 15.2804 0.0398084C15.1542 0.0031075 15.022 -0.00837419 14.8913 0.00601889C14.6274 0.035087 14.3859 0.167784 14.2199 0.374918L10.9179 4.49992L9.70791 3.28992C9.61487 3.19707 9.50445 3.12346 9.38296 3.07329C9.26147 3.02312 9.13129 2.99737 8.99985 2.99751C8.73439 2.99779 8.47992 3.10351 8.29241 3.29142C8.1049 3.47932 7.99972 3.73402 8 3.99948C8.00028 4.26494 8.106 4.51941 8.29391 4.70692L10.2939 6.70692C10.4814 6.89447 10.7357 6.99986 11.0009 6.99992Z"/>\n</svg>\n'},30808:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M10.4243 7.42417L14.4243 3.42417C14.6586 3.18985 14.6586 2.80995 14.4243 2.57564C14.1899 2.34132 13.8101 2.34132 13.5757 2.57564L10 6.15137L8.42426 4.57564C8.18995 4.34132 7.81005 4.34132 7.57574 4.57564C7.34142 4.80995 7.34142 5.18985 7.57574 5.42417L9.57574 7.42417L10 7.84843L10.4243 7.42417ZM3 5.9999V3.9999H5V5.9999H3ZM2 3.4999C2 3.22376 2.22386 2.9999 2.5 2.9999H5.5C5.77614 2.9999 6 3.22376 6 3.4999V6.4999C6 6.77604 5.77614 6.9999 5.5 6.9999H2.5C2.22386 6.9999 2 6.77604 2 6.4999V3.4999ZM3 11.9999V9.9999H5V11.9999H3ZM2 9.4999C2 9.22376 2.22386 8.9999 2.5 8.9999H5.5C5.77614 8.9999 6 9.22376 6 9.4999V12.4999C6 12.776 5.77614 12.9999 5.5 12.9999H2.5C2.22386 12.9999 2 12.776 2 12.4999V9.4999ZM9 9.9999V11.9999H11V9.9999H9ZM8.5 8.9999C8.22386 8.9999 8 9.22376 8 9.4999V12.4999C8 12.776 8.22386 12.9999 8.5 12.9999H11.5C11.7761 12.9999 12 12.776 12 12.4999V9.4999C12 9.22376 11.7761 8.9999 11.5 8.9999H8.5Z"/>\n</svg>\n'},1691:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M13.1454 7.39088C13.0522 7.30052 12.9274 7.25 12.7975 7.25H7.25V12.7438C7.25 12.8731 7.30007 12.9973 7.3897 13.0905L14.2932 20.2654C14.6813 20.6688 15.325 20.675 15.7209 20.2791L20.2816 15.7184C20.6765 15.3235 20.6714 14.6817 20.2703 14.2931L13.1454 7.39088Z" stroke="currentColor" stroke-width="1.5"/>\n  <circle cx="11.5" cy="11.5" r="1.5"  stroke="currentColor" stroke-width="1"/>\n</svg>\n'},50112:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M8.5 11L14 16.5L19.5 11" stroke="currentColor"/>\n  <path d="M7.11243 11.7001L13.6812 6.26382C13.8662 6.11075 14.1338 6.11075 14.3188 6.26382L20.8876 11.7001C21.1171 11.89 21.25 12.1725 21.25 12.4705V17.25C21.25 18.3546 20.3546 19.25 19.25 19.25H8.75C7.64543 19.25 6.75 18.3546 6.75 17.25V12.4705C6.75 12.1725 6.88288 11.89 7.11243 11.7001Z" stroke="currentColor" stroke-width="1.5"/>\n</svg>\n'},73391:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.293 7.293l6-6c.391-.391 1.024-.391 1.414 0l6 6c.188.188.293.442.293.707v6c0 .552-.448 1-1 1h-12c-.552 0-1-.448-1-1v-6c0-.265.105-.52.293-.707zm1.707 5.707v-4.586l.811-.811 4.189 4.189 4.189-4.189.811.811v4.586h-10zm8.482-6.104l-3.482-3.482-3.482 3.482 3.482 3.482 3.482-3.482z"/></svg>'},15331:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="m7.29386.706223c.39053-.390524 1.02175-.390524 1.41228 0l4.70996 4.709977c.3751.37507.5839.88188.5839 1.41231v5.17159c0 .2652-.1054.5196-.2929.7071s-.4419.2929-.7071.2929h-10c-.26522 0-.51957-.1054-.70711-.2929-.18753-.1875-.29289-.4419-.29289-.7071v-5.17159c0-.53043.20882-1.03724.58389-1.41231zm-2.7332 4.147417 3.43934-3.43934 3.4393 3.43934-3.08575 3.08579c-.19526.19526-.51184.19526-.7071 0zm-.70711.70711-.56255.56255c-.18653.18653-.291.43857-.291.70521v5.17159h10v-5.17159c0-.26664-.1045-.51868-.291-.7052l-.5626-.56256-3.08574 3.08578c-.58579.58579-1.53553.58579-2.12132 0z" fill-rule="evenodd"/>\n</svg>'},61921:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M20.929 12.9999L20.9999 12.9999L20.9999 8.20698C20.9999 7.76153 20.4614 7.53845 20.1464 7.85343L18.9497 9.05015C17.6829 7.78341 15.9329 6.99991 13.9999 6.99991C10.4734 6.99991 7.55602 9.60764 7.07081 13L8.5906 13C9.06084 10.4398 11.3038 8.49991 13.9999 8.49991C15.5187 8.49991 16.8937 9.11551 17.889 10.1108L15.8535 12.1463C15.5385 12.4613 15.7616 12.9999 16.207 12.9999L19.4092 12.9999C19.4092 12.9999 19.4092 12.9999 19.4092 13L20.929 13C20.929 12.9999 20.929 12.9999 20.929 12.9999ZM11.7928 14.9999L6.99993 14.9999L6.99993 19.7928C6.99993 20.2382 7.5385 20.4613 7.85348 20.1463L9.05016 18.9496C10.3169 20.2164 12.0669 20.9999 13.9999 20.9999C17.5264 20.9999 20.4438 18.3922 20.929 15L19.4092 15C18.939 17.5601 16.696 19.4999 13.9999 19.4999C12.4811 19.4999 11.1061 18.8843 10.1108 17.889L12.1464 15.8534C12.4614 15.5384 12.2383 14.9999 11.7928 14.9999Z" fill="currentColor"/>\n</svg>\n'},11331:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M10.065 7.082l4.292.227-.227-4.292c-.021-.399-.514-.624-.781-.357l-1.118 1.118c-1.092-1.088-2.601-1.762-4.269-1.762-3.038 0-5.551 2.235-5.969 5.143h2.032c.395-1.792 2.001-3.143 3.938-3.143 1.118 0 2.126.45 2.854 1.176l-1.109 1.109c-.267.267-.042.76.357.781zM5.922 8.949l-4.292-.227.227 4.292c.021.399.514.624.781.357l1.088-1.088c1.089 1.071 2.586 1.732 4.238 1.732 3.038 0 5.551-2.235 5.969-5.143h-2.032c-.395 1.791-2.001 3.143-3.938 3.143-1.103 0-2.098-.438-2.824-1.146l1.14-1.14c.267-.267.042-.76-.357-.781z"/></svg>'},64207:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M9.915 6.939h3.389l-.001-3.389c0-.315-.381-.473-.604-.25l-1.164 1.164c-.905-.905-2.155-1.464-3.536-1.464-2.419 0-4.437 1.718-4.9 4h1.026c.444-1.725 2.01-3 3.874-3 1.105 0 2.105.448 2.828 1.172l-1.164 1.164c-.223.223-.065.603.25.604zm-3.829 2.122h-3.389v3.389c0 .315.381.473.603.25l1.164-1.164c.905.905 2.155 1.464 3.536 1.464 2.419 0 4.437-1.718 4.9-4h-1.026c-.444 1.725-2.01 3-3.874 3-1.105 0-2.105-.448-2.828-1.171l1.164-1.164c.223-.223.065-.603-.25-.603z"/></svg>'},60839:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M16 8L12 20" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n<path d="M9.5 11.5L7 14L9.5 16.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n<path d="M18.5 11.5L21 14L18.5 16.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n</svg>\n'},6672:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M14.9932 9.00685C14.9977 8.97012 15 8.93271 15 8.89474C15 8.40059 14.6056 8 14.119 8C13.8519 8 13.6125 8.12078 13.4509 8.31152C13.4295 8.32738 13.4091 8.3451 13.3898 8.36469L8.66111 13.3088C8.29135 13.6954 8.29135 14.3046 8.66111 14.6912L13.3898 19.6353C13.4091 19.6549 13.4296 19.6727 13.4509 19.6885C13.6125 19.8792 13.8519 20 14.119 20C14.6056 20 15 19.5994 15 19.1053C15 19.0673 14.9977 19.0299 14.9932 18.9932L15 19V9L14.9932 9.00685Z" fill="currentColor"/>\n<path d="M21 17.5C21 14.1863 18.3137 12 15 12H14V16H15.8571C17.8853 16 19.6392 17.174 20.4764 18.8794C20.7883 18.7101 21 17.8798 21 17.5Z" fill="currentColor"/>\n</svg>\n'},31916:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M16 19.1053C16 19.5994 15.6056 20 15.119 20C14.8519 20 14.6125 19.8792 14.4509 19.6885C14.4296 19.6727 14.4091 19.6549 14.3898 19.6353L9.66111 14.6912C9.29135 14.3046 9.29135 13.6954 9.66111 13.3088L14.3898 8.36469C14.4091 8.3451 14.4295 8.32738 14.4509 8.31152C14.6125 8.12078 14.8519 8 15.119 8C15.6056 8 16 8.40059 16 8.89474V12H16.0001C19.3138 12 22.0001 14.1863 22.0001 17.5C22.0001 17.8798 21.7883 18.7101 21.4765 18.8794C20.6392 17.174 18.8853 16 16.8572 16H16V19.1053Z" fill="currentColor"/>\n<path opacity="0.5" d="M12 8.89474C12 9.08695 11.9417 9.26501 11.8425 9.41084C11.8422 9.42654 11.8285 9.44896 11.7975 9.48116L8.16676 13.2557C7.77134 13.6668 7.77135 14.3332 8.16676 14.7443L11.7046 18.4223L11.7034 18.4295C11.8851 18.5935 12 18.8355 12 19.1053C12 19.5994 11.6147 20 11.1393 20C10.8784 20 10.6445 19.8792 10.4867 19.6885C10.4658 19.6727 10.4458 19.6549 10.427 19.6353L6.56517 15.459C5.81161 14.6441 5.81161 13.3559 6.56517 12.541L10.427 8.36469C10.4458 8.3451 10.4658 8.32738 10.4866 8.31152C10.6445 8.12078 10.8783 8 11.1393 8C11.6147 8 12 8.40059 12 8.89474Z" fill="currentColor"/>\n</svg>\n'},67461:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M6.203 3.914c0 .192-.058.37-.158.516l-.045.07-2.833 2.756c-.395.411-.395 1.078 0 1.489l2.833 2.756-.001.007c.182.164.297.406.297.676 0 .494-.385.895-.861.895-.261 0-.495-.121-.653-.312l-.06-.053-3.157-3.254c-.754-.815-.754-2.103 0-2.918l3.064-3.157.06-.053c.158-.191.392-.312.653-.312.475 0 .861.401.861.895zM15 11.5c0-3.314-2.686-5.5-6-5.5h-1v4h1.857c2.028 0 3.782 1.174 4.619 2.879.312-.169.524-1 .524-1.379zM9.994 3.839l.006-.093c0-.412-.338-.746-.755-.746-.229 0-.434.101-.573.26l-.052.044-3.93 3.995c-.383.389-.383 1.013 0 1.403l3.93 3.995.052.044c.138.159.344.26.573.26.417 0 .755-.334.755-.746l-.006-.094.006.006v-8.333l-.006.006z"/></svg>'},70531:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8.5 6.001l.001.499h.499c3.097 0 5.5 2.018 5.5 5 0 .08-.017.213-.051.363-1.023-1.43-2.698-2.363-4.592-2.363h-1.357v2.754c0 .13-.108.246-.255.246-.08 0-.149-.034-.196-.088l-.038-.043-.043-.031-3.922-3.987c-.191-.195-.191-.507 0-.701l3.922-3.987.043-.031.038-.043c.047-.054.116-.088.196-.088.084 0 .135.028.168.063s.081.114.081.276v.001l.006 2.161z" stroke="#3B3B3B"/><path d="M1.287 7.299l3.93-3.995.052-.044c.138-.159.344-.26.573-.26.417 0 .749.304.749.839v.569l-1 1v-1.059l-3.592 3.651 3.597 3.657v-.657l-.001-.404 1.001 1.001v.657c0 .412-.338.746-.755.746-.229 0-.434-.101-.573-.26l-.052-.044-3.93-3.995c-.383-.389-.383-1.013 0-1.403z"/></svg>'},51299:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M7.994 3.839l.006-.093c0-.412-.338-.746-.755-.746-.229 0-.434.101-.573.26l-.052.044-3.93 3.995c-.383.389-.383 1.013 0 1.403l3.93 3.995.052.044c.138.159.344.26.573.26.417 0 .755-.334.755-.746l-.006-.094.006.006v-8.333l-.006.006zM14 11.5c0-3.314-2.686-5.5-6-5.5h-1v4h1.857c2.028 0 3.782 1.174 4.619 2.879.312-.169.524-1 .524-1.379z"/></svg>'},10945:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M7.5 6.001l.001.499h.499c3.097 0 5.5 2.018 5.5 5 0 .08-.017.213-.051.363-1.023-1.43-2.698-2.363-4.592-2.363h-1.357v2.754c0 .13-.108.246-.255.246-.08 0-.149-.034-.196-.088l-.038-.043-.043-.031-3.922-3.987c-.191-.195-.191-.507 0-.701l3.922-3.987.043-.031.038-.043c.047-.054.116-.088.196-.088.084 0 .135.028.168.063s.081.114.081.276v.001l.006 2.161z"/></svg>\n'},82720:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M23 9.08606C23 8.39027 22.4527 8 21.6808 8H4L7.89744 12L19 10L9.84615 15V23L22.5128 10C22.7342 9.7771 23 9.40879 23 9.08606Z" fill="currentColor"/>\n</svg>\n'},64827:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M16 3.869c0-.557-.461-.869-1.111-.869h-14.889l3.282 3.2 9.35-1.6-7.709 4v6.4l10.667-10.4c.186-.178.41-.473.41-.731z"/></svg>'},39139:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M0 2h14.546c.359 0 .715.09.992.31.292.231.461.579.461.991 0 .25-.098.471-.189.625-.095.162-.213.304-.319.411l-10.492 10.664v-8l-5-5zm2.5.95l2.5 2.55 7-1.5-6 3.5.003 5 8.863-8.848.176-.225.054-.125c0-.117-.038-.183-.101-.232-.077-.061-.223-.119-.45-.119h-12.046z"/></svg>'},74486:e=>{e.exports='<svg width="28" height="28" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M7.25 9.793V8.25a1 1 0 0 1 1-1h11.5a1 1 0 0 1 1 1v1.543a.5.5 0 0 1-.146.354l-.733.732a.5.5 0 0 0-.143.29l-1.116 8.708a1 1 0 0 1-.992.873h-7.24a1 1 0 0 1-.992-.873L8.272 11.17a.5.5 0 0 0-.143-.29l-.733-.732a.5.5 0 0 1-.146-.354Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n  <path d="m11.5 18 5-5m-5 0 5 5M8 10.5h12" stroke="currentColor" stroke-linecap="round"/>\n</svg>\n'},66706:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path fill-rule="evenodd" d="M13 3v2H3V3h10zM2.12 6H2a1 1 0 01-1-1V3c0-1.1.78-2 1.75-2h10.5c.97 0 1.75.9 1.75 2v2a1 1 0 01-1 1h-.12l-.74 7.3c0 .94-.76 1.7-1.71 1.7H4.57a1.7 1.7 0 01-1.71-1.7L2.12 6zm1.72 0l.73 6.46c0 .47.39.85.86.85h5.14c.47 0 .86-.38.86-.85L12.16 6H3.84zm6.65 1.86l-.6-.6-1.82 1.8-1.82-1.8-.6.6 1.81 1.8-1.82 1.79.6.6 1.83-1.8 1.82 1.8.6-.6-1.82-1.8 1.82-1.8z"/>\n</svg>\n'},58530:e=>{e.exports='<svg width="28" height="28" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M7.25 9.793V8.25a1 1 0 0 1 1-1h11.5a1 1 0 0 1 1 1v1.543a.5.5 0 0 1-.146.354l-.733.732a.5.5 0 0 0-.143.29l-1.116 8.708a1 1 0 0 1-.992.873h-7.24a1 1 0 0 1-.992-.873L8.272 11.17a.5.5 0 0 0-.143-.29l-.733-.732a.5.5 0 0 1-.146-.354Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n  <path d="M8 10.5h12m-8.5 5 2.5-2 2.5 2" stroke="currentColor" stroke-linecap="round"/>\n</svg>\n'},15901:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M3 3h10v1H3V3ZM2 3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v2h-1.09l-.73 7.6c-.08.8-.66 1.4-1.36 1.4H5.18c-.7 0-1.28-.6-1.36-1.4L3.09 5H2V3Zm2 2 .72 7.49c.03.26.22.46.46.46h5.64c.24 0 .43-.2.46-.46L12 5H4Zm6.5 1.86-.61-.6-1.82 1.8-1.82-1.8-.6.6 1.81 1.8-1.82 1.79.6.6 1.83-1.8 1.82 1.8.6-.6-1.82-1.8 1.82-1.8.01.01Z"/>\n</svg>\n'},80848:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<g opacity="0.5">\n<circle cx="9" cy="9" r="1.5" stroke="currentColor"/>\n<circle cx="9" cy="19" r="1.5" stroke="currentColor"/>\n<circle cx="9" cy="14" r="1.5" stroke="currentColor"/>\n</g>\n<line x1="13.75" y1="8.75" x2="21.25" y2="8.75" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n<line x1="13.75" y1="13.75" x2="21.25" y2="13.75" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n<line x1="13.75" y1="18.75" x2="21.25" y2="18.75" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n</svg>\n'},49602:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M8 16c1.105 0 2 .895 2 2s-.895 2-2 2-2-.895-2-2 .895-2 2-2zm10.5 1c.276 0 .5.224.5.5v1c0 .276-.224.5-.5.5h-6c-.276 0-.5-.224-.5-.5v-1c0-.276.224-.5.5-.5h6zm-10.5 0c-.552 0-1 .448-1 1s.448 1 1 1 1-.448 1-1-.448-1-1-1zm0-6c1.105 0 2 .895 2 2s-.895 2-2 2-2-.895-2-2 .895-2 2-2zm10.5 1c.276 0 .5.224.5.5v1c0 .276-.224.5-.5.5h-6c-.276 0-.5-.224-.5-.5v-1c0-.276.224-.5.5-.5h6zm-10.5 0c-.552 0-1 .448-1 1s.448 1 1 1 1-.448 1-1-.448-1-1-1zm0-6c1.105 0 2 .895 2 2s-.895 2-2 2-2-.895-2-2 .895-2 2-2zm10.5 1c.276 0 .5.224.5.5v1c0 .276-.224.5-.5.5h-6c-.276 0-.5-.224-.5-.5v-1c0-.276.224-.5.5-.5h6zm-10.5 0c-.552 0-1 .448-1 1s.448 1 1 1 1-.448 1-1-.448-1-1-1z"/></svg>'},97888:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M3 4c0-.552.448-1 1-1h1c.552 0 1 .448 1 1v1c0 .552-.448 1-1 1h-1c-.552 0-1-.448-1-1v-1zm1 0h1v1h-1v-1zM3 8c0-.552.448-1 1-1h1c.552 0 1 .448 1 1v1c0 .552-.448 1-1 1h-1c-.552 0-1-.448-1-1v-1zm1 0h1v1h-1v-1zM6 12c0-.552-.448-1-1-1h-1c-.552 0-1 .448-1 1v1c0 .552.448 1 1 1h1c.552 0 1-.448 1-1v-1zm-1 0h-1v1h1v-1z"/><path d="M13 4.5c0-.276-.224-.5-.5-.5h-5c-.276 0-.5.224-.5.5s.224.5.5.5h5c.276 0 .5-.224.5-.5zM7 8.5c0-.276.224-.5.5-.5h5c.276 0 .5.224.5.5s-.224.5-.5.5h-5c-.276 0-.5-.224-.5-.5zM13 12.5c0-.276-.224-.5-.5-.5h-5c-.276 0-.5.224-.5.5s.224.5.5.5h5c.276 0 .5-.224.5-.5z"/></svg>'},49494:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<g opacity="0.5">\n<circle cx="9" cy="9" r="1.5" stroke="currentColor"/>\n<circle cx="13" cy="19" r="1.5" stroke="currentColor"/>\n<circle cx="13" cy="14" r="1.5" stroke="currentColor"/>\n<path d="M9 10.5V14M11.5 19H10.5C9.67157 19 9 18.3284 9 17.5V14M11.5 14H9" stroke="currentColor" stroke-linecap="round"/>\n</g>\n<line x1="13.75" y1="8.75" x2="21.25" y2="8.75" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n<line x1="17.75" y1="13.75" x2="21.25" y2="13.75" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n<line x1="17.75" y1="18.75" x2="21.25" y2="18.75" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n</svg>\n'},98626:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M8 6c1.105 0 2 .895 2 2 0 .932-.637 1.714-1.499 1.937l-.001 2.563h1.563c.222-.863 1.005-1.5 1.937-1.5 1.105 0 2 .895 2 2s-.895 2-2 2c-.932 0-1.714-.637-1.937-1.499l-1.564-.001v3.006l.008.111c.058.497.48.883.993.883l.563-.001c.222-.862 1.005-1.499 1.937-1.499 1.105 0 2 .895 2 2s-.895 2-2 2c-.932 0-1.715-.637-1.937-1.5h-.563c-1.105 0-2-.895-2-2v-6.563c-.863-.222-1.5-1.005-1.5-1.937 0-1.105.895-2 2-2zm4 11c-.552 0-1 .448-1 1s.448 1 1 1 1-.448 1-1-.448-1-1-1zm7.5 0c.276 0 .5.224.5.5v1c0 .276-.224.5-.5.5h-3c-.276 0-.5-.224-.5-.5v-1c0-.276.224-.5.5-.5h3zm-7.5-5c-.552 0-1 .448-1 1s.448 1 1 1 1-.448 1-1-.448-1-1-1zm7.5 0c.276 0 .5.224.5.5v1c0 .276-.224.5-.5.5h-3c-.276 0-.5-.224-.5-.5v-1c0-.276.224-.5.5-.5h3zm-11.5-5c-.552 0-1 .448-1 1s.448 1 1 1 1-.448 1-1-.448-1-1-1zm11.5 0c.276 0 .5.224.5.5v1c0 .276-.224.5-.5.5h-7c-.276 0-.5-.224-.5-.5v-1c0-.276.224-.5.5-.5h7z"/></svg>'},31560:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M6 4c0-.552-.448-1-1-1h-1c-.552 0-1 .448-1 1v1c0 .552.448 1 1 1v6c0 .552.448 1 1 1h2c0 .552.448 1 1 1h1c.552 0 1-.448 1-1v-1c0-.552-.448-1-1-1h-1c-.552 0-1 .448-1 1h-2v-3h2c0 .552.448 1 1 1h1c.552 0 1-.448 1-1v-1c0-.552-.448-1-1-1h-1c-.552 0-1 .448-1 1h-2v-2c.552 0 1-.448 1-1v-1zm-1 0h-1v1h1v-1zm4 4h-1v1h1v-1zm-1 4h1v1h-1v-1z"/><path d="M7 4.5c0-.276.224-.5.5-.5h6c.276 0 .5.224.5.5s-.224.5-.5.5h-6c-.276 0-.5-.224-.5-.5zM14 8.5c0-.276-.224-.5-.5-.5h-2c-.276 0-.5.224-.5.5s.224.5.5.5h2c.276 0 .5-.224.5-.5zM11 12.5c0-.276.224-.5.5-.5h2c.276 0 .5.224.5.5s-.224.5-.5.5h-2c-.276 0-.5-.224-.5-.5z"/></svg>'},2039:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="none">\n  <path stroke="currentColor" stroke-linecap="round" stroke-width="1.5" d="M18.75 19.75h-9.5a2 2 0 0 1-2-2V10l3-3h7.5l3 3v7.75a2 2 0 0 1-2 2Z"/>\n  <path stroke="currentColor" stroke-linecap="round" d="m11.5 15.5 2.5-2 2.5 2M7.5 10.25h13"/>\n</svg>'},42705:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="none">\n  <path stroke="currentColor" stroke-width="1.5" d="M9.25 12s-.454 2.411-.5 4c-.027.952.102 2.161.236 3.12.132.95.957 1.63 1.915 1.63h6.174c.969 0 1.8-.695 1.926-1.656.125-.943.249-2.126.249-3.094 0-1.943-.5-5-.5-5"/>\n  <path fill="currentColor" d="M17.896 7.31a.5.5 0 0 1-.58-.406.5.5 0 0 0-.579-.406L10.83 7.54a.5.5 0 0 0-.406.58.5.5 0 0 1-.406.578l-1.477.26c-.544.097-.95.37-.854.913.095.544.57.661 1.115.565l10.833-1.91c.543-.096.95-.368.854-.912-.096-.544-.571-.661-1.115-.565l-1.477.26Z"/>\n  <path stroke="currentColor" stroke-linecap="round" stroke-width="1.5" d="M12.25 12.75v4.5M15.75 11.75v5.5" opacity=".35"/>\n</svg>'},96409:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M16.3368 8H8.75C7.23122 8 6 9.23122 6 10.75V17.25C6 18.7688 7.23122 20 8.75 20H19.25C20.7688 20 22 18.7688 22 17.25V11.9495C21.5902 12.3678 21.0762 12.6836 20.5 12.8551V17.25C20.5 17.9404 19.9404 18.5 19.25 18.5H8.75C8.05965 18.5 7.5 17.9404 7.5 17.25V10.75C7.5 10.7359 7.50023 10.7218 7.5007 10.7078L13.6464 16.8536L14 17.2071L14.3536 16.8536L18.3876 12.8195C18.0503 12.7066 17.736 12.5436 17.4533 12.3396L14 15.7929L7.97572 9.76861C8.18863 9.6004 8.45759 9.5 8.75 9.5H16C16 8.9632 16.1208 8.45463 16.3368 8Z" fill="currentColor"/>\n  <circle cx="19.5" cy="9.5" r="2.5" fill="currentColor"/>\n</svg>\n'},58480:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M14 5c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM15 12v-5.126c-.32.082-.655.126-1 .126s-.68-.044-1-.126v4.126h-10v-6h.793l4.207 4.207 3.277-3.277c-.245-.228-.462-.487-.644-.77l-2.633 2.633-2.793-2.793h5.328c-.34-.588-.535-1.271-.535-2h-8c-.552 0-1 .448-1 1v8c0 .552.448 1 1 1h12c.552 0 1-.448 1-1z"/></svg>'},44895:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M14 5c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z"/><path fill-rule="evenodd" clip-rule="evenodd" d="M14 11v-5c-.351 0-.687-.06-1-.171v5.171h-10v-6h.293l4.707 4.707 4.262-4.262c-.498-.355-.883-.858-1.091-1.445h-8.171c-.552 0-1 .448-1 1v6c0 .552.448 1 1 1h10c.552 0 1-.448 1-1zm-6-2.707l3.293-3.293h-6.586l3.293 3.293z"/></svg>'},97272:e=>{e.exports='<svg width="140" height="140" xmlns="http://www.w3.org/2000/svg">\n  <g opacity=".7">\n    <path opacity=".2" fill-rule="evenodd" clip-rule="evenodd" d="M122 87.962c1.944-5.629 3-11.672 3-17.962 0-6.29-1.056-12.333-3-17.962v35.924ZM107.749 110H32.251c9.85 9.299 23.134 15 37.749 15 14.615 0 27.9-5.701 37.749-15ZM18 87.962A54.925 54.925 0 0 1 15 70c0-6.29 1.056-12.333 3-17.962v35.924ZM32.25 30h75.499C97.899 20.7 84.615 15 70 15c-14.615 0-27.9 5.7-37.75 15Z" fill="var(--colorFgFadedMost)"/>\n    <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M107.749 110c-9.85 9.299-23.134 15-37.749 15-14.615 0-27.9-5.701-37.75-15h-2.858C39.73 120.494 54.105 127 70 127c15.895 0 30.27-6.506 40.608-17h-2.859ZM122 87.962v5.418A56.804 56.804 0 0 0 127 70a56.804 56.804 0 0 0-5-23.38v5.418c1.944 5.629 3 11.672 3 17.962 0 6.29-1.056 12.333-3 17.962ZM32.25 30C42.1 20.7 55.386 15 70 15c14.615 0 27.9 5.7 37.749 15h2.859C100.27 19.506 85.895 13 70 13c-15.895 0-30.27 6.506-40.608 17h2.859ZM18 52.038V46.62A56.796 56.796 0 0 0 13 70a56.796 56.796 0 0 0 5 23.38v-5.418A54.925 54.925 0 0 1 15 70c0-6.29 1.056-12.333 3-17.962Z" fill="var(--colorFgFadedMost)"/>\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M23 32h94a3 3 0 0 1 3 3v4H20v-4a3 3 0 0 1 3-3Zm-3 9v64a3 3 0 0 0 3 3h94a3 3 0 0 0 3-3V41H20Zm-2-6a5 5 0 0 1 5-5h94a5 5 0 0 1 5 5v70a5 5 0 0 1-5 5H23a5 5 0 0 1-5-5V35Z" fill="var(--colorFgFadedMost)"/>\n    <path opacity=".2" d="M70 59h9v26l-9-6V59Z" fill="var(--colorFgFadedMost)"/>\n    <path fill="none" d="M71.897 80.513 70.5 79.149l-1.397 1.364-7.574 7.394a.29.29 0 0 1-.16.089.374.374 0 0 1-.2-.026.317.317 0 0 1-.138-.1c-.014-.019-.031-.049-.031-.12V57.245c0-.09.089-.245.3-.245h18.4c.211 0 .3.155.3.245V87.75c0 .071-.017.101-.031.12a.317.317 0 0 1-.139.1.374.374 0 0 1-.198.026.291.291 0 0 1-.161-.09l-7.574-7.393Z" stroke="var(--colorFgFadedMost)" stroke-width="4"/>\n    <rect x="120" y="14" width="2" height="12" rx="1" fill="var(--colorFgFadedMost)"/>\n    <rect x="138" y="32" width="2" height="12" rx="1" transform="rotate(90 138 32)" fill="var(--colorFgFadedMost)"/>\n    <rect x="133.485" y="18" width="2" height="12" rx="1" transform="rotate(45 133.485 18)" fill="var(--colorFgFadedMost)"/>\n    <circle opacity=".2" cx="8" cy="37" r="3" fill="var(--colorFgFadedMost)"/>\n    <circle opacity=".2" cx="22.5" cy="125.5" r="4.5" fill="var(--colorFgFadedMost)"/>\n    <path opacity=".5" d="M20 35a3 3 0 0 1 3-3h94a3 3 0 0 1 3 3v4H20v-4Z" fill="var(--colorFgFadedMost)"/>\n    <circle cx="24.5" cy="35.5" r="1.5" fill="var(--colorFgFadedMost)"/>\n    <circle cx="28.5" cy="35.5" r="1.5" fill="var(--colorFgFadedMost)"/>\n    <circle cx="32.5" cy="35.5" r="1.5" fill="var(--colorFgFadedMost)"/>\n  </g>\n</svg>'},87338:e=>{e.exports='<svg width="140" height="140" viewBox="0 0 140 140" xmlns="http://www.w3.org/2000/svg">\n  <g opacity="0.7">\n  <path opacity="0.4" fill-rule="evenodd" clip-rule="evenodd" d="M101.631 115C92.6841 121.3 81.7741 125 70 125C58.2259 125 47.3159 121.3 38.3692 115H38C36.694 115 35.4368 114.791 34.2597 114.406C44.0358 122.284 56.4671 127 70 127C83.313 127 95.5599 122.436 105.262 114.787C104.529 114.927 103.773 115 103 115H101.631ZM115 101.631V103C115 103.773 114.927 104.529 114.787 105.262C122.436 95.5599 127 83.313 127 70C127 56.6871 122.436 44.4401 114.787 34.7384C114.927 35.4709 115 36.2269 115 37V38.3692C121.3 47.3159 125 58.2259 125 70C125 81.7741 121.3 92.6841 115 101.631ZM38.3692 25C47.3159 18.6997 58.2259 15 70 15C81.7741 15 92.6841 18.6997 101.631 25H103C103.773 25 104.529 25.0731 105.262 25.2128C95.5599 17.564 83.313 13 70 13C56.4671 13 44.0358 17.7161 34.2597 25.5944C35.4368 25.2086 36.694 25 38 25H38.3692ZM26 36.9946C26.0006 35.5615 26.2525 34.1872 26.7139 32.9132C18.1649 42.8819 13 55.8378 13 70C13 84.1622 18.1649 97.1181 26.7139 107.087C26.2525 105.813 26.0006 104.438 26 103.005C19.093 93.8122 15 82.3841 15 70C15 57.6159 19.093 46.1878 26 36.9946Z" fill="var(--colorFgFadedMost)"/>\n  <path opacity="0.2" fill-rule="evenodd" clip-rule="evenodd" d="M115 101.631C121.3 92.6841 125 81.7741 125 70C125 58.2259 121.3 47.3159 115 38.3692V101.631ZM100.161 116H39.839C48.4995 121.69 58.8632 125 70 125C81.1368 125 91.5005 121.69 100.161 116ZM26 103.005C19.093 93.8122 15 82.3841 15 70C15 57.6159 19.093 46.1878 26 36.9946V103.005ZM38.3692 25H101.631C92.6841 18.6997 81.7741 15 70 15C58.2259 15 47.3159 18.6997 38.3692 25Z" fill="var(--colorFgFadedMost)"/>\n  <path d="M103.074 25H78.1191H36.9318C30.8586 25.4646 26 30.9235 26 37.4278V66H115V37.4278C114.89 30.5751 109.589 25 103.074 25ZM47.5323 34.4533C46.0968 34.4533 44.9926 33.2918 44.9926 31.7819C44.9926 30.272 46.0968 29.1105 47.5323 29.1105C48.9677 29.1105 50.072 30.272 50.072 31.7819C49.9615 33.1756 48.8573 34.4533 47.5323 34.4533ZM92.5844 34.4533C91.1489 34.4533 90.0447 33.2918 90.0447 31.7819C90.0447 30.272 91.1489 29.1105 92.5844 29.1105C94.0198 29.1105 95.1241 30.272 95.1241 31.7819C95.0136 33.1756 93.9094 34.4533 92.5844 34.4533Z" fill="var(--colorFgFadedMost)" fill-opacity="0.2"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M36.8936 24H103.074C110.191 24 115.882 30.0702 116 37.4117L116 37.4197V67H25V37.4278C25 30.445 30.2182 24.5107 36.8555 24.0029L36.8936 24ZM36.9709 26C31.4787 26.4409 27 31.4156 27 37.4278V65H114V37.436C113.894 31.0757 108.985 26 103.074 26H36.9709ZM47.5323 30.1105C46.6961 30.1105 45.9926 30.776 45.9926 31.7819C45.9926 32.7877 46.6961 33.4533 47.5323 33.4533C48.1888 33.4533 48.9735 32.7455 49.0716 31.7423C49.0534 30.7586 48.3574 30.1105 47.5323 30.1105ZM43.9926 31.7819C43.9926 29.7679 45.4975 28.1105 47.5323 28.1105C49.5671 28.1105 51.072 29.7679 51.072 31.7819V31.8214L51.0688 31.8608C50.9291 33.6244 49.5173 35.4533 47.5323 35.4533C45.4975 35.4533 43.9926 33.7958 43.9926 31.7819ZM92.5844 30.1105C91.7482 30.1105 91.0447 30.776 91.0447 31.7819C91.0447 32.7877 91.7482 33.4533 92.5844 33.4533C93.2409 33.4533 94.0256 32.7455 94.1237 31.7423C94.1055 30.7586 93.4095 30.1105 92.5844 30.1105ZM89.0447 31.7819C89.0447 29.7679 90.5496 28.1105 92.5844 28.1105C94.6192 28.1105 96.1241 29.7679 96.1241 31.7819V31.8214L96.1209 31.8608C95.9812 33.6244 94.5694 35.4533 92.5844 35.4533C90.5496 35.4533 89.0447 33.7958 89.0447 31.7819Z" fill="var(--colorFgFadedMost)"/>\n  <path d="M26 66V103.084C26 109.655 31.3068 115 37.8298 115H103.17C109.693 115 115 109.655 115 103.084V66H26Z" fill="white"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M25 65H116V103.084C116 110.2 110.252 116 103.17 116H37.8298C30.7477 116 25 110.2 25 103.084V65ZM27 67V103.084C27 109.109 31.8659 114 37.8298 114H103.17C109.134 114 114 109.109 114 103.084V67H27Z" fill="var(--colorFgFadedMost)"/>\n  <path d="M26.3956 67L22.119 45.8542C21.132 41.0625 26.3956 37 33.8524 37H108.42C115.877 37 121.031 41.0625 119.825 45.8542L114.781 67" fill="var(--colorFgFadedMost)"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M25.4242 40.4264C23.5255 41.8693 22.701 43.7234 23.0983 45.6524L23.099 45.6559L27.3757 66.8018L25.4154 67.1982L21.1394 46.0559C21.1393 46.0553 21.1392 46.0547 21.139 46.0541C20.5503 43.1922 21.8641 40.6199 24.2141 38.834C26.5498 37.0591 29.9569 36 33.8523 36H108.42C112.314 36 115.7 37.0584 117.986 38.8417C120.293 40.6411 121.513 43.2316 120.796 46.0922C120.795 46.0942 120.795 46.0963 120.794 46.0983L115.753 67.232L113.808 66.768L118.855 45.61C119.34 43.6814 118.587 41.8472 116.756 40.4187C114.902 38.9728 111.983 38 108.42 38H33.8523C30.291 38 27.3379 38.9721 25.4242 40.4264Z" fill="var(--colorFgFadedMost)"/>\n  <circle opacity="0.5" cx="52.5" cy="79.5" r="3.5" fill="var(--colorFgFadedMost)"/>\n  <circle opacity="0.5" cx="52.5" cy="91.5" r="3.5" fill="var(--colorFgFadedMost)"/>\n  <path d="M90.2136 80.6552H60.4083C60.2041 80.6552 60 80.3449 60 79.8276C60 79.4138 60.2041 79 60.4083 79H90.2136C90.4178 79 90.6219 79.3104 90.6219 79.8276C90.6219 80.2414 90.4178 80.6552 90.2136 80.6552Z" fill="var(--colorFgFadedMost)"/>\n  <path d="M90.2136 92.6552H60.4083C60.2041 92.6552 60 92.3449 60 91.8276C60 91.4138 60.2041 91 60.4083 91H90.2136C90.4178 91 90.6219 91.3104 90.6219 91.8276C90.6219 92.2414 90.4178 92.6552 90.2136 92.6552Z" fill="var(--colorFgFadedMost)"/>\n  </g>\n</svg>\n'},50108:e=>{e.exports='<svg width="140" height="140" fill="none" xmlns="http://www.w3.org/2000/svg">\r\n  <g opacity=".7">\r\n    <path opacity=".2" fill-rule="evenodd" clip-rule="evenodd" d="M122 87.962c1.944-5.629 3-11.672 3-17.962 0-6.29-1.056-12.333-3-17.962v35.924ZM107.749 110H32.251c9.85 9.299 23.134 15 37.749 15 14.615 0 27.9-5.701 37.749-15ZM18 87.962A54.925 54.925 0 0 1 15 70c0-6.29 1.056-12.333 3-17.962v35.924ZM32.25 30H39v6a3 3 0 0 0 3 3h9a3 3 0 0 0 3-3v-6h31v6a3 3 0 0 0 3 3h9a3 3 0 0 0 3-3v-6h7.749C97.899 20.7 84.615 15 70 15c-14.615 0-27.9 5.7-37.75 15Z" fill="var(--colorFgFadedMost)"/>\r\n    <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M107.749 110c-9.85 9.299-23.134 15-37.749 15-14.615 0-27.9-5.701-37.75-15h-2.858C39.73 120.494 54.105 127 70 127c15.895 0 30.27-6.506 40.608-17h-2.859ZM122 87.962v5.418A56.804 56.804 0 0 0 127 70a56.804 56.804 0 0 0-5-23.38v5.418c1.944 5.629 3 11.672 3 17.962 0 6.29-1.056 12.333-3 17.962ZM32.25 30C42.1 20.7 55.386 15 70 15c14.615 0 27.9 5.7 37.749 15h2.859C100.27 19.506 85.895 13 70 13c-15.895 0-30.27 6.506-40.608 17h2.859ZM18 52.038V46.62A56.796 56.796 0 0 0 13 70a56.796 56.796 0 0 0 5 23.38v-5.418A54.925 54.925 0 0 1 15 70c0-6.29 1.056-12.333 3-17.962Z" fill="var(--colorFgFadedMost)"/>\r\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M47.325 64.137a5.137 5.137 0 1 1 10.274 0 5.137 5.137 0 0 1-10.274 0ZM52.462 55a9.137 9.137 0 0 0-6.075 15.962C42.022 73.2 39 77.757 39 82.954a2 2 0 1 0 4 0c0-5.167 4.295-9.462 9.462-9.462s9.462 4.295 9.462 9.462a2 2 0 1 0 4 0c0-5.197-3.022-9.754-7.388-11.992A9.137 9.137 0 0 0 52.461 55Zm21.356 7.84a2 2 0 0 1 2-2h23.14a2 2 0 1 1 0 4h-23.14a2 2 0 0 1-2-2Zm2 9.677a2 2 0 0 0 0 4h9.083a2 2 0 0 0 0-4h-9.083Z" fill="var(--colorFgFadedMost)"/>\r\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M85 30H54v2h31v-2Zm15 2h17a3 3 0 0 1 3 3v70a3 3 0 0 1-3 3H23a3 3 0 0 1-3-3V35a3 3 0 0 1 3-3h16v-2H23a5 5 0 0 0-5 5v70a5 5 0 0 0 5 5h94a5 5 0 0 0 5-5V35a5 5 0 0 0-5-5h-17v2Z" fill="var(--colorFgFadedMost)"/>\r\n    <circle opacity=".2" cx="8" cy="50" r="3" fill="var(--colorFgFadedMost)"/>\r\n    <circle opacity=".2" cx="127" cy="24" r="3" fill="var(--colorFgFadedMost)"/>\r\n    <circle opacity=".2" cx="135.5" cy="49.5" r="4.5" fill="var(--colorFgFadedMost)"/>\r\n    <rect x="41" y="25" width="11" height="12" rx="1" stroke="var(--colorFgFadedMost)" stroke-width="2"/>\r\n    <rect x="87" y="25" width="11" height="12" rx="1" stroke="var(--colorFgFadedMost)" stroke-width="2"/>\r\n  </g>\r\n</svg>'},19500:e=>{e.exports='<svg width="140" height="140" xmlns="http://www.w3.org/2000/svg">\r\n  <g opacity=".7">\r\n    <path opacity=".2" fill-rule="evenodd" clip-rule="evenodd" d="M114.872 101.812C121.25 92.832 125 81.854 125 70c0-30.376-24.624-55-55-55S15 39.624 15 70a54.761 54.761 0 0 0 11.543 33.716L21.1 74.6c-.1-.3-.1-.6-.1-.9 0-3.4 2.8-6.3 6.3-6.3h34.4c3 0 5.9-1.1 8.1-2.9l8-6.5c2.3-1.9 5.1-2.9 8.1-2.9h30.4c.3 0 .7 0 1-.1 3.5.7 5.8 3.8 5.2 7.3l-7.628 39.512ZM103.27 113.8H36.73A54.758 54.758 0 0 0 70 125a54.759 54.759 0 0 0 33.27-11.2Z" fill="var(--colorFgFadedMost)"/>\r\n    <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M103.27 113.8A54.759 54.759 0 0 1 70 125a54.758 54.758 0 0 1-33.27-11.2H33.7c-.06 0-.122-.001-.182-.003A56.765 56.765 0 0 0 70 127a56.767 56.767 0 0 0 36.479-13.2h-3.209Zm-76.727-10.084A54.761 54.761 0 0 1 15 70c0-30.376 24.624-55 55-55s55 24.624 55 55c0 11.854-3.75 22.832-10.128 31.812l-.849 4.398A56.765 56.765 0 0 0 127 70c0-31.48-25.52-57-57-57S13 38.52 13 70c0 14.482 5.401 27.703 14.299 37.758l-.756-4.042Z" fill="var(--colorFgFadedMost)"/>\r\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M30 51.1c0-2.322 1.927-4.1 4.1-4.1h72.1c2.348 0 4.1 1.752 4.1 4.1v4h2v-4c0-3.452-2.648-6.1-6.1-6.1H34.1c-3.227 0-6.1 2.622-6.1 6.1v16.3h2V51.1Z" fill="var(--colorFgFadedMost)"/>\r\n    <path fill="none" d="M116.3 55.1H85.9c-3 0-5.8 1-8.1 2.9l-8 6.5c-2.2 1.8-5.1 2.9-8.1 2.9H27.3c-3.5 0-6.3 2.9-6.3 6.3 0 .3 0 .6.1.9l6.3 33.7c.5 3.2 3.2 5.5 6.3 5.5h73.6c3.2 0 5.8-2.2 6.3-5.4l8.9-46.1c.6-3.5-1.7-6.6-5.2-7.3-.3.1-.7.1-1 .1Z" stroke="var(--colorFgFadedMost)" stroke-width="2" stroke-miterlimit="10"/>\r\n    <path d="M69.429 79.313c0-.725.575-1.313 1.285-1.313h2.572c.71 0 1.285.588 1.285 1.313v5.25h5.143L72 92.436l-7.714-7.874h5.143v-5.25ZM63 97.688c0-.725.576-1.313 1.286-1.313h15.428c.71 0 1.286.588 1.286 1.313 0 .724-.576 1.312-1.286 1.312H64.286c-.71 0-1.286-.588-1.286-1.313Z" fill="var(--colorFgFadedMost)"/>\r\n  </g>\r\n</svg>'},62133:e=>{e.exports='<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M45.5 16.5H3.5" stroke="var(--colorFgFadedMore)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M21.5 42.5H7.5C5.291 42.5 3.5 40.709 3.5 38.5V10.5C3.5 8.291 5.291 6.5 7.5 6.5H41.5C43.709 6.5 45.5 8.291 45.5 10.5V25.512" stroke="var(--colorFgFadedMore)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M13.5 2.5V10.5" stroke="var(--colorFgFadedMore)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M35.5 2.5V10.5" stroke="var(--colorFgFadedMore)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M35.5 46.5C40.4706 46.5 44.5 42.4706 44.5 37.5C44.5 32.5294 40.4706 28.5 35.5 28.5C30.5294 28.5 26.5 32.5294 26.5 37.5C26.5 42.4706 30.5294 46.5 35.5 46.5Z" stroke="var(--colorFgFadedMore)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M35.5 33.5V41.5" stroke="var(--colorFgFadedMore)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M31.5 37.5H39.5" stroke="var(--colorFgFadedMore)" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n'},71632:e=>{e.exports='<svg width="140" height="140" xmlns="http://www.w3.org/2000/svg">\r\n  <g opacity=".7" fill="var(--colorFgFadedMost)">\r\n    <path opacity=".2" fill-rule="evenodd" clip-rule="evenodd" d="M122 87.962c1.944-5.629 3-11.672 3-17.962 0-6.29-1.056-12.333-3-17.962v35.924ZM107.749 110H32.251c9.85 9.299 23.134 15 37.749 15 14.615 0 27.9-5.701 37.749-15ZM18 87.962A54.925 54.925 0 0 1 15 70c0-6.29 1.056-12.333 3-17.962v35.924ZM32.25 30h75.499C97.899 20.7 84.615 15 70 15c-14.615 0-27.9 5.7-37.75 15Z"/>\r\n    <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M107.749 110c-9.85 9.299-23.134 15-37.749 15-14.615 0-27.9-5.701-37.75-15h-2.858C39.73 120.494 54.105 127 70 127c15.895 0 30.27-6.506 40.608-17h-2.859ZM122 87.962v5.418A56.804 56.804 0 0 0 127 70a56.804 56.804 0 0 0-5-23.38v5.418c1.944 5.629 3 11.672 3 17.962 0 6.29-1.056 12.333-3 17.962ZM32.25 30C42.1 20.7 55.386 15 70 15c14.615 0 27.9 5.7 37.749 15h2.859C100.27 19.506 85.895 13 70 13c-15.895 0-30.27 6.506-40.608 17h2.859ZM18 52.038V46.62A56.796 56.796 0 0 0 13 70a56.796 56.796 0 0 0 5 23.38v-5.418A54.925 54.925 0 0 1 15 70c0-6.29 1.056-12.333 3-17.962Z"/>\r\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M23 32h94a3 3 0 0 1 3 3v4H20v-4a3 3 0 0 1 3-3Zm-3 9v64a3 3 0 0 0 3 3h94a3 3 0 0 0 3-3V41H20Zm-2-6a5 5 0 0 1 5-5h94a5 5 0 0 1 5 5v70a5 5 0 0 1-5 5H23a5 5 0 0 1-5-5V35Z"/>\r\n    <path d="M64.64 80.68a4.32 4.32 0 1 1-8.64 0 4.32 4.32 0 0 1 8.64 0ZM81.917 85c1.193 0 2.169-.968 2.077-2.158a28.074 28.074 0 0 0-25.836-25.836c-1.19-.092-2.158.884-2.158 2.077v.22c0 1.194.969 2.15 2.157 2.26a23.536 23.536 0 0 1 21.28 21.28c.11 1.188 1.067 2.157 2.26 2.157h.22Z"/>\r\n    <path d="M73.278 85c1.193 0 2.172-.97 2.04-2.155a19.434 19.434 0 0 0-11.88-15.803 19.434 19.434 0 0 0-5.283-1.36C56.97 65.55 56 66.529 56 67.722v.18c0 1.192.972 2.143 2.152 2.315a14.943 14.943 0 0 1 11.65 9.066c.474 1.146.803 2.343.98 3.565.173 1.18 1.124 2.152 2.316 2.152h.18Z"/>\r\n    <rect x="120" y="14" width="2" height="12" rx="1"/>\r\n    <rect x="138" y="32" width="2" height="12" rx="1" transform="rotate(90 138 32)"/>\r\n    <rect x="133.485" y="18" width="2" height="12" rx="1" transform="rotate(45 133.485 18)"/>\r\n    <circle opacity=".2" cx="8" cy="37" r="3"/>\r\n    <circle opacity=".2" cx="22.5" cy="125.5" r="4.5"/>\r\n    <path opacity=".5" d="M20 35a3 3 0 0 1 3-3h94a3 3 0 0 1 3 3v4H20v-4Z"/>\r\n    <circle cx="24.5" cy="35.5" r="1.5"/>\r\n    <circle cx="28.5" cy="35.5" r="1.5"/>\r\n    <circle cx="32.5" cy="35.5" r="1.5"/>\r\n  </g>\r\n</svg>'},534:e=>{e.exports='<svg width="140" height="140" xmlns="http://www.w3.org/2000/svg">\r\n  <g opacity=".7">\r\n    <path opacity=".2" fill-rule="evenodd" clip-rule="evenodd" d="M70 125c30.376 0 55-24.624 55-55s-24.624-55-55-55-55 24.624-55 55 24.624 55 55 55Zm0-10c24.853 0 45-20.147 45-45S94.853 25 70 25 25 45.147 25 70s20.147 45 45 45Z" fill="var(--colorFgFadedMost)"/>\r\n    <path d="M68.096 65.378s-1.028.614-1.596 1.122c-.838.749-1.784 2.258-1.784 2.258L44.76 49.14c-1.015-1.014-1.015-2.535 0-3.38 1.014-1.014 2.534-1.014 3.38 0l19.955 19.618Z" fill="var(--colorFgFadedMost)" fill-opacity=".2" stroke="var(--colorFgFadedMost)" stroke-width="1.978" stroke-miterlimit="10"/>\r\n    <path fill="none" d="M75.5 68.5s-.914-1.414-1.5-2c-.586-.586-1.5-1-1.5-1l14.002-14.332c1.014-1.014 2.535-1.014 3.38 0 1.014 1.014 1.014 2.535 0 3.38L75.5 68.5Z" stroke="var(--colorFgFadedMost)" stroke-width="1.978" stroke-miterlimit="10"/>\r\n    <path d="M81.144 103.38a.331.331 0 0 1-.056-.021v-.052l-.026-.077-10.984-33.123-.012-.034-.008-.015v-.004a.356.356 0 0 1 .045-.117.65.65 0 0 1 .217-.23.358.358 0 0 1 .117.044.66.66 0 0 1 .227.207l10.97 33.08.011.034.008.016a.695.695 0 0 1-.198.307H81.263a.481.481 0 0 1-.12-.015Z" fill="var(--colorFgFadedMost)" stroke="var(--colorFgFadedMost)"/>\r\n    <path fill="none" d="M66.585 66.521c2.197-2.028 5.577-2.028 7.605 0 2.197 2.028 2.197 5.408 0 7.605s-5.577 2.028-7.605 0c-2.028-2.028-2.197-5.577 0-7.605Z" stroke="var(--colorFgFadedMost)" stroke-width="2" stroke-miterlimit="10"/>\r\n    <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M70 125c30.376 0 55-24.624 55-55s-24.624-55-55-55-55 24.624-55 55 24.624 55 55 55Zm0 2c31.48 0 57-25.52 57-57s-25.52-57-57-57-57 25.52-57 57 25.52 57 57 57Z" fill="var(--colorFgFadedMost)"/>\r\n    <path opacity=".2" fill-rule="evenodd" clip-rule="evenodd" d="M70 115c24.853 0 45-20.147 45-45S94.853 25 70 25 25 45.147 25 70s20.147 45 45 45Zm0 2c25.957 0 47-21.043 47-47S95.957 23 70 23 23 44.043 23 70s21.043 47 47 47Z" fill="var(--colorFgFadedMost)"/>\r\n    <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M69 29a1 1 0 0 0-1 1v7a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-7a1 1 0 0 0-1-1h-3Zm43 40a1 1 0 0 0-1-1h-7a1 1 0 0 0-1 1v3a1 1 0 0 0 1 1h7a1 1 0 0 0 1-1v-3Zm-44 35a1 1 0 0 1 1-1h3a1 1 0 0 1 1 1v7a1 1 0 0 1-1 1h-3a1 1 0 0 1-1-1v-7ZM38 69a1 1 0 0 0-1-1h-7a1 1 0 0 0-1 1v3a1 1 0 0 0 1 1h7a1 1 0 0 0 1-1v-3Z" fill="var(--colorFgFadedMost)"/>\r\n  </g>\r\n</svg>'},31039:e=>{e.exports='<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">\n<rect x="10" y="6" width="28" height="36" rx="5" stroke="var(--colorFgFadedMore)" stroke-width="1.5"/>\n<path d="M16.5 16.5H31.5" stroke="var(--colorBgDarker)" stroke-width="1.5" stroke-linecap="round"/>\n<path d="M16.5 22.5H31.5" stroke="var(--colorBgDarker)" stroke-width="1.5" stroke-linecap="round"/>\n<path d="M16.5 28.5H26.5" stroke="var(--colorBgDarker)" stroke-width="1.5" stroke-linecap="round"/>\n</svg>\n'},98254:e=>{e.exports='<svg width="140" height="140" xmlns="http://www.w3.org/2000/svg">\r\n  <g opacity="0.7">\r\n    <path opacity="0.2" fill-rule="evenodd" clip-rule="evenodd" d="M103 33C105.742 33 108.483 33.0973 111.117 33.4696C101.042 22.1385 86.3548 15 70 15C39.6243 15 15 39.6243 15 70C15 100.376 39.6243 125 70 125C72.7172 125 75.3884 124.803 78 124.422V97H57V33H103ZM94 97V119.501C104.08 114.605 112.44 106.721 117.928 97H94Z" fill="var(--colorFgFadedMost)"/>\r\n    <path fill="none" d="M79 97H93V120.874C92.9579 120.894 92.9138 120.915 92.8676 120.937C92.4341 121.144 91.8271 121.43 91.1341 121.744C89.7385 122.377 88.0292 123.108 86.6871 123.55C84.7319 124.194 82.5394 124.637 80.8185 124.92C80.11 125.036 79.4868 125.125 79 125.188V97Z" stroke="var(--colorFgFadedMost)" stroke-width="2"/>\r\n    <path opacity="0.5" fill-rule="evenodd" clip-rule="evenodd" d="M117.928 97C108.491 113.715 90.5635 125 70 125C39.6243 125 15 100.376 15 70C15 39.6243 39.6243 15 70 15C86.3548 15 101.042 22.1385 111.117 33.4696C111.365 33.5047 111.612 33.5422 111.858 33.5823C112.72 33.7657 113.568 33.9895 114.399 34.251C103.95 21.291 87.9434 13 70 13C38.5198 13 13 38.5198 13 70C13 101.48 38.5198 127 70 127C91.7114 127 110.588 114.861 120.212 97H117.928Z" fill="var(--colorFgFadedMost)"/>\r\n    <path opacity="0.5" d="M65.6187 114C63.9881 116.446 62.0082 120.406 60.8435 123.667C60.727 123.9 60.6105 124.249 60.6105 124.482C59.7953 124.366 58.98 124.133 58.1647 123.9C57.4659 122.269 57 120.522 57 120.522C57.4659 119.94 57.8153 119.474 58.2812 119.008C60.4941 116.329 62.8234 114.466 65.6187 114Z" fill="var(--colorFgFadedMost)"/>\r\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M60.1602 124.335C60.2663 124.362 60.3724 124.388 60.4785 124.388C60.3724 124.07 60.2663 123.752 60.0541 123.54C59.6075 122.721 59.0564 121.745 58.4375 120.65C58.1742 120.184 57.8986 119.696 57.6136 119.189C55.3854 115.475 52.2022 110.913 48.4885 107.836C45.5175 105.395 43.5015 103.91 42.2282 103.061C41.8553 102.812 41.5188 102.637 41.24 102.491C41.0429 102.388 40.8746 102.3 40.7427 102.212C40.2122 102 40 102 40 102L40 102C40.1061 102.106 40.1061 102.106 40.1061 102.212C40.6085 103.698 41.0696 105.102 41.5065 106.432C43.2842 111.844 44.6615 116.036 46.7908 119.614C49.3227 120.88 51.9595 122.041 54.7012 122.888C49.8321 113.181 44.34 106.95 41.1672 103.354C40.8489 102.929 40.5306 102.611 40.2123 102.293L40.2123 102.293C40.2123 102.248 40.2123 102.222 40.2041 102.199C40.1931 102.167 40.1672 102.141 40.1061 102.08C40.1061 102.08 40.3184 102.08 40.8489 102.293C40.9807 102.381 41.149 102.468 41.3461 102.571C41.6249 102.717 41.9614 102.893 42.3344 103.142C42.3773 103.191 42.4206 103.242 42.4642 103.292C45.7586 107.117 51.2719 113.519 56.0772 123.304C56.0942 123.311 56.1112 123.319 56.1282 123.327C56.3934 123.38 56.6322 123.46 56.8709 123.54C57.1096 123.619 57.3484 123.699 57.6136 123.752L57.6137 123.752C58.3564 123.964 59.0991 124.176 59.8419 124.282C59.948 124.282 60.0541 124.309 60.1602 124.335Z" fill="var(--colorFgFadedMost)"/>\r\n    <path fill="none" d="M134 61V97H57V33H103C106 33 109 33.1165 111.858 33.5823C117.333 34.747 122.224 37.5423 125.951 41.2693C131.192 46.5104 134 53.1966 134 61Z" stroke="var(--colorFgFadedMost)" stroke-width="2" stroke-miterlimit="10"/>\r\n    <path opacity="0.4" fill-rule="evenodd" clip-rule="evenodd" d="M93.6973 70.6417L96 67.8503V78.274V80H88V67.8212L90.4044 70.6527C91.2667 71.6681 92.8259 71.6681 93.6882 70.6527L93.6928 70.6472L93.6973 70.6417ZM98 66.5525C98 65.0884 96.1755 64.4417 95.2935 65.5639L92.1611 69.3611C92.0972 69.433 91.9917 69.432 91.9289 69.3581L88.6882 65.5418L88.6588 65.5072L88.6263 65.4753C87.6034 64.4715 86 65.2399 86 66.5525V80V81V81V82V83V84H87H116.479C117.438 86.3724 119.739 88 122.5 88C126.04 88 129 85.1641 129 81.5C129 77.8359 126.04 75 122.5 75C119.461 75 116.849 77.0901 116.171 80H98V78.274V66.5525ZM122.5 86C120.888 86 119.515 85.2189 118.723 84H122.13C122.784 84 123.423 83.8711 123.937 83.5961C124.43 83.3325 125 82.8111 125 82C125 81.1889 124.43 80.6675 123.937 80.4039C123.423 80.1289 122.784 80 122.13 80H118.252C118.87 78.23 120.554 77 122.5 77C124.96 77 127 78.9641 127 81.5C127 84.0359 124.96 86 122.5 86ZM123.073 82.2191C123.073 82.2191 123.07 82.2167 123.065 82.2115C123.071 82.2164 123.074 82.219 123.073 82.2191ZM123.065 81.7885C123.07 81.7833 123.073 81.7809 123.073 81.7809C123.074 81.781 123.071 81.7836 123.065 81.7885Z" fill="var(--colorFgFadedMost)"/>\r\n    <path d="M79 93V97H3.04963C1.91095 97 1 96.0857 1 95.0571C1 93.9143 1.91095 93 3.04963 93H79Z" fill="#F1F3F9" stroke="var(--colorFgFadedMost)" stroke-width="2" stroke-miterlimit="10"/>\r\n    <circle opacity="0.2" cx="117" cy="24" r="3" fill="var(--colorFgFadedMost)"/>\r\n    <circle opacity="0.2" cx="25.5" cy="122.5" r="4.5" fill="var(--colorFgFadedMost)"/>\r\n    <circle opacity="0.2" cx="121.5" cy="110.5" r="3.5" fill="var(--colorFgFadedMost)"/>\r\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M103.845 102.942C103.796 102.968 103.747 102.991 103.698 103.012C101.351 104.21 98.9519 105.973 96.7057 108.567L96.4466 108.866C95.9282 109.465 95.4166 110.156 94.905 110.848C92.2671 114.5 90.5137 118.742 89.4454 123.404C89.6184 123.391 92.1501 122.482 94.6728 121.147C94.7353 121.024 94.7899 120.961 94.7899 120.961C94.8353 120.822 94.884 120.67 94.9362 120.508C96.0323 117.109 98.6745 108.914 103.704 103.105L103.845 102.942ZM95.9216 120.495C96.0154 120.442 96.1142 120.386 96.2171 120.328C97.2536 119.745 98.7164 118.923 99.9149 118.066C100.008 118.06 100.094 117.96 100.094 117.96C100.141 117.957 100.162 117.932 100.184 117.907C100.206 117.882 100.227 117.857 100.274 117.853C101.599 111.836 104.778 104.861 105.786 102.65L105.819 102.579L106.058 102C106.029 102.002 106.002 102.013 105.972 102.024C105.933 102.039 105.89 102.055 105.836 102.057C105.821 102.1 105.806 102.15 105.792 102.206C105.795 102.253 105.774 102.278 105.752 102.303C105.73 102.328 105.709 102.353 105.712 102.399C101.206 107.002 97.917 114.384 95.9216 120.495Z" fill="var(--colorFgFadedMost)"/>\r\n    <path d="M79 55V93H35V55C35 42.8497 44.8497 33 57 33C69.1503 33 79 42.8497 79 55Z" fill="var(--colorFg)" stroke="var(--colorFgFadedMost)" stroke-width="2"/>\r\n  </g>\r\n</svg>\r\n'},96019:e=>{e.exports='<svg width="140" height="140" xmlns="http://www.w3.org/2000/svg">\r\n  <g opacity=".7">\r\n    <path opacity=".2" fill-rule="evenodd" clip-rule="evenodd" d="M110 107.749c9.299-9.85 15-23.134 15-37.749 0-14.615-5.701-27.9-15-37.75v75.499Zm-80.303-.323C20.577 97.61 15 84.456 15 70c0-14.084 5.294-26.931 14-36.661v6.866a3.349 3.349 0 0 0 2.75 3.295 3.349 3.349 0 0 1 2.75 3.295v42.543a6 6 0 0 1-.855 3.087l-2.846 4.743a6 6 0 0 0-.852 2.884l-.25 7.374ZM43.128 22h53.744C88.925 17.542 79.76 15 70 15c-9.76 0-18.925 2.542-26.872 7Z" fill="var(--colorFgFadedMost)"/>\r\n    <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M29 33.339C20.294 43.069 15 55.916 15 70s5.294 26.931 14 36.661v2.937C19.094 99.344 13 85.384 13 70s6.094-29.344 16-39.598v2.937ZM96.872 22C88.925 17.542 79.76 15 70 15c-9.76 0-18.925 2.542-26.872 7h-3.882c8.872-5.696 19.427-9 30.754-9 11.327 0 21.882 3.304 30.754 9h-3.882ZM110 107.749c9.299-9.85 15-23.134 15-37.749 0-14.615-5.701-27.9-15-37.75v-2.858C120.494 39.73 127 54.105 127 70c0 15.895-6.506 30.27-17 40.608v-2.859Z" fill="var(--colorFgFadedMost)"/>\r\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M29 109.598C39.365 120.328 53.903 127 70 127c15.585 0 29.71-6.255 40-16.392v-2.859C99.972 118.371 85.76 125 70 125c-16.292 0-30.929-7.083-41-18.339v2.937Z" fill="var(--colorFgFadedMost)"/>\r\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M31 111.535V96.167L29 99v10.5a30.662 30.662 0 0 0 2 2.035ZM29 42.5l2 .364V28a5 5 0 0 1 5-5h67a5 5 0 0 1 5 5v84.486a56.329 56.329 0 0 0 2-1.878V28a7 7 0 0 0-7-7H36a7 7 0 0 0-7 7v14.5Z" fill="var(--colorFgFadedMost)"/>\r\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M71.921 39H47.039c-1.4-.024-1.37-3.988 0-4H71.92c.584 0 1.078.931 1.078 2.006 0 1.075-.494 1.994-1.078 1.994Zm-17.655 8h-7.462c-1.078.024-1.066-4.024 0-4h7.392c1.078-.012 1.043 3.964.07 4ZM92.18 64H46.83c-.42 0-.831.835-.831 1.992 0 1.002.33 2.004.831 2.004H92.1c1.181.144 1.191-3.96.08-3.996Zm.019 24.001H46.817c-1.016-.083-1.16 3.999 0 3.999H92.2c1.088.012 1.047-3.987 0-3.999Zm-45.382-8H92.2c1.047.024 1.088 3.999 0 3.999H46.817c-1.15 0-1.027-4.07 0-4ZM92.245 72H46.84c-.42 0-.841.836-.841 2.006 0 1.002.33 1.993.841 1.993h45.323c1.002.06 1.192-3.94.08-3.999Zm-36.822 33.001h-8.846c-.764-.059-.775 4.052 0 3.993h8.846c.764.19.775-4.076 0-3.993Z" fill="var(--colorFgFadedMost)"/>\r\n    <path fill="none" d="M28 43h4a3 3 0 0 1 3 3v44.92l-5 8.165-5-8.165V46a3 3 0 0 1 3-3Z" stroke="var(--colorFgFadedMost)" stroke-width="2"/>\r\n    <path fill="var(--colorFgFadedMost)" d="M26 51h8v2h-8zM26 89h8v2h-8z"/>\r\n  </g>\r\n</svg>'},95912:e=>{e.exports='<svg width="140" height="140" xmlns="http://www.w3.org/2000/svg">\r\n  <g opacity=".7" fill="var(--colorFgFadedMost)">\r\n    <path opacity=".2" fill-rule="evenodd" clip-rule="evenodd" d="M121.63 89A54.887 54.887 0 0 0 125 70c0-5.2-.722-10.232-2.07-15H32a5 5 0 0 1-5-5V35.704A54.79 54.79 0 0 0 16.313 58H102a5 5 0 0 1 5 5v18a5 5 0 0 1-5 5H17.364A54.854 54.854 0 0 0 27 104.296V94a5 5 0 0 1 5-5h89.63Zm-23.049 28H41.42c8.33 5.076 18.114 8 28.581 8 10.468 0 20.252-2.924 28.581-8ZM35.704 27h68.592A54.767 54.767 0 0 0 70 15a54.767 54.767 0 0 0-34.296 12Z"/>\r\n    <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M98.581 117c-8.33 5.076-18.114 8-28.581 8-10.467 0-20.252-2.924-28.581-8h-3.677c9.172 6.308 20.284 10 32.258 10 11.974 0 23.085-3.692 32.258-10h-3.677ZM27 104.296A54.854 54.854 0 0 1 17.363 86h-2.087A56.887 56.887 0 0 0 27 107.418v-3.122ZM14.265 58h2.048A54.79 54.79 0 0 1 27 35.704v-3.122A56.82 56.82 0 0 0 14.265 58Zm18.317-31C42.594 18.28 55.681 13 70 13c14.32 0 27.406 5.28 37.418 14h-3.122A54.767 54.767 0 0 0 70 15a54.768 54.768 0 0 0-34.296 12h-3.122Zm90.348 28A55.065 55.065 0 0 1 125 70c0 6.678-1.19 13.078-3.37 19h2.127A56.92 56.92 0 0 0 127 70c0-5.191-.694-10.22-1.994-15h-2.076Z"/>\r\n    <circle opacity=".2" cx="8" cy="37" r="3"/>\r\n    <circle opacity=".2" cx="134" cy="60" r="3"/>\r\n    <circle opacity=".2" cx="22.5" cy="125.5" r="4.5"/>\r\n    <circle opacity=".2" cx="135.5" cy="80.5" r="4.5"/>\r\n    <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M126 29H32a3 3 0 0 0-3 3v18a3 3 0 0 0 3 3h94a3 3 0 0 0 3-3V32a3 3 0 0 0-3-3Zm-94-2a5 5 0 0 0-5 5v18a5 5 0 0 0 5 5h94a5 5 0 0 0 5-5V32a5 5 0 0 0-5-5H32Z"/>\r\n    <circle cx="41" cy="41" r="8" fill-opacity=".3" stroke="var(--colorFgFadedMost)" stroke-width="2"/>\r\n    <rect opacity=".5" x="55" y="36" width="54" height="3" rx="1.5"/>\r\n    <rect opacity=".5" x="55" y="43" width="41" height="3" rx="1.5"/>\r\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M42.414 43.828a1 1 0 1 0 1.414-1.414L42.414 41l1.414-1.414a1 1 0 0 0-1.414-1.414L41 39.586l-1.414-1.414a1 1 0 1 0-1.414 1.414L39.586 41l-1.414 1.414a1 1 0 1 0 1.414 1.414L41 42.414l1.414 1.414Z"/>\r\n    <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M102 60H8a3 3 0 0 0-3 3v18a3 3 0 0 0 3 3h94a3 3 0 0 0 3-3V63a3 3 0 0 0-3-3ZM8 58a5 5 0 0 0-5 5v18a5 5 0 0 0 5 5h94a5 5 0 0 0 5-5V63a5 5 0 0 0-5-5H8Z"/>\r\n    <circle cx="17" cy="72" r="8" fill-opacity=".3" stroke="var(--colorFgFadedMost)" stroke-width="2"/>\r\n    <rect opacity=".5" x="31" y="67" width="54" height="3" rx="1.5"/>\r\n    <rect opacity=".5" x="31" y="74" width="41" height="3" rx="1.5"/>\r\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M15.894 75.417a1 1 0 0 1-1.201-.163l-2.133-2.133a1 1 0 0 1 1.414-1.414l1.452 1.452 3.988-3.987a1 1 0 0 1 1.414 1.414l-4.617 4.617a.998.998 0 0 1-.317.214Z"/>\r\n    <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M126 91H32a3 3 0 0 0-3 3v18a3 3 0 0 0 3 3h94a3 3 0 0 0 3-3V94a3 3 0 0 0-3-3Zm-94-2a5 5 0 0 0-5 5v18a5 5 0 0 0 5 5h94a5 5 0 0 0 5-5V94a5 5 0 0 0-5-5H32Z"/>\r\n    <circle cx="41" cy="103" r="8" fill-opacity=".3" stroke="var(--colorFgFadedMost)" stroke-width="2"/>\r\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M42.414 105.828a1 1 0 1 0 1.414-1.414L42.414 103l1.414-1.414a1 1 0 1 0-1.414-1.414L41 101.586l-1.414-1.414a1 1 0 1 0-1.414 1.414L39.586 103l-1.414 1.414a1 1 0 1 0 1.414 1.414L41 104.414l1.414 1.414Z"/>\r\n    <rect opacity=".5" x="55" y="98" width="54" height="3" rx="1.5"/>\r\n    <rect opacity=".5" x="55" y="105" width="41" height="3" rx="1.5"/>\r\n  </g>\r\n</svg>'},98258:e=>{e.exports='<svg width="140" height="140" fill="none" xmlns="http://www.w3.org/2000/svg">\r\n  <g opacity=".7" fill="var(--colorFgFadedMost)">\r\n    <path opacity=".4" fill-rule="evenodd" clip-rule="evenodd" d="M90.63 121c-6.37 2.58-13.334 4-20.63 4-7.296 0-14.26-1.42-20.63-4h-4.854c7.669 3.839 16.324 6 25.484 6s17.815-2.161 25.484-6H90.63ZM110 107.749v2.859C120.494 100.27 127 85.895 127 70c0-15.895-6.506-30.27-17-40.608v2.859c9.299 9.85 15 23.134 15 37.749 0 14.615-5.701 27.9-15 37.749ZM43.128 22C51.075 17.542 60.24 15 70 15c9.76 0 18.925 2.542 26.872 7h3.882C91.881 16.304 81.327 13 70 13c-11.479 0-22.165 3.393-31.11 9.23.36-.148.76-.23 1.19-.23h3.048ZM37 25.996v-.853c0-.879.342-1.688.92-2.265C22.876 33.139 13 50.416 13 70c0 19.182 9.475 36.151 24 46.481v-2.477C23.641 103.97 15 87.994 15 70c0-17.994 8.641-33.97 22-44.004Z"/>\r\n    <path opacity=".2" fill-rule="evenodd" clip-rule="evenodd" d="M110 107.749c9.299-9.85 15-23.134 15-37.749 0-14.615-5.701-27.9-15-37.75v75.499ZM90.63 121H49.37c6.37 2.58 13.334 4 20.63 4 7.296 0 14.26-1.42 20.63-4ZM37 114.004C23.641 103.97 15 87.994 15 70c0-17.994 8.641-33.97 22-44.004v88.008ZM43.128 22h53.744C88.925 17.542 79.76 15 70 15c-9.76 0-18.925 2.542-26.872 7Z"/>\r\n    <path d="M106.921 22c1.668 0 3.079 1.31 3.079 3.143v92.714c0 1.703-1.283 3.143-3.079 3.143H40.079c-1.668 0-3.079-1.31-3.079-3.143V25.143C37 23.44 38.283 22 40.08 22h66.841Z" fill-opacity=".1"/>\r\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M40.08 23c-1.199 0-2.08.946-2.08 2.143v92.714c0 1.273.956 2.143 2.08 2.143h66.841c1.198 0 2.079-.946 2.079-2.143V25.143c0-1.273-.956-2.143-2.079-2.143H40.079ZM36 25.143C36 22.935 37.685 21 40.08 21h66.841c2.212 0 4.079 1.75 4.079 4.143v92.714c0 2.208-1.685 4.143-4.079 4.143H40.079c-2.212 0-4.079-1.749-4.079-4.143V25.143Z"/>\r\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M40 28.009C40 26.761 41.011 26 41.992 26h64.016c1.267 0 1.992 1.052 1.992 2.009v.026l-2.124 81.971c-.008 1.239-1.015 1.994-1.992 1.994H41.992c-1.267 0-1.992-1.052-1.992-2.009V28.009ZM42 28v81.999l.001.001h61.875V109.965L106 28.005l-.001-.004V28H42Z"/>\r\n    <path d="M105.972 27.002a.984.984 0 0 1 .993 1.02c-.096 2.606-.441 11.122-1.626 35.58v.636c-1.917 31.01-29.515 37.491-32.837 37.872-1.534.127-4.472.382-9.711.382-6.516.254-16.483.381-32.07.508-.512 0-.895-.508-.64-1.017 9.883-19.777 10.774-66.603 10.853-73.894.006-.55.453-.963 1.004-.964l64.034-.123Z" fill="var(--colorBgLighter)"/>\r\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M105.97 26.002a1.985 1.985 0 0 1 1.995 2.056c-.096 2.613-.442 11.128-1.626 35.568V64.269l-.002.031c-.979 15.843-8.54 25.473-16.298 31.167-7.714 5.661-15.615 7.43-17.423 7.638l-.016.002-.016.001-.105.009c-1.573.13-4.52.375-9.669.376-6.535.254-16.513.381-32.082.508h-.008c-1.157 0-2.164-1.206-1.533-2.464 4.848-9.703 7.533-26.179 9.002-41.28 1.464-15.048 1.706-28.546 1.745-32.178.013-1.139.945-1.95 2.002-1.953l64.034-.123Zm-.004 1.983Zm-.001.017c-.096 2.62-.442 11.147-1.625 35.552l-.001.024V64.207c-.945 15.148-8.137 24.255-15.483 29.647-7.371 5.41-14.906 7.078-16.453 7.261l-.093.008c-1.548.128-4.44.369-9.519.369h-.039c-6.431.251-16.244.378-31.563.504 4.898-10.119 7.544-26.68 8.99-41.545 1.47-15.096 1.715-28.63 1.755-32.326h.006l64.025-.123Z" fill="#9E9E9E"/>\r\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M51.243 50.093c.218.215.437.322.655.322.219 0 .437-.107.656-.215l5.789-5.7c.328-.323.328-.968 0-1.291-.328-.323-.983-.323-1.31 0l-5.135 5.055-2.512-2.474c-.328-.322-.983-.322-1.31 0-.328.323-.328.968 0 1.291l3.167 3.012Zm43.341-4.643h-30.61c-.21 0-.42-.31-.42-.828 0-.414.21-.828.42-.828h30.61c.21 0 .42.31.42.828 0 .517-.21.828-.42.828Zm-34.76 37.242h29.704c.306 0 .51-.413.51-.827 0-.517-.204-.828-.408-.828H59.825c-.205 0-.409.414-.409.828 0 .517.204.827.409.827Zm-.016 4.966h14.113c.196 0 .392-.414.392-.828 0-.517-.196-.827-.392-.827H59.808c-.196 0-.392.414-.392.828 0 .517.196.827.392.827Zm22.354-38.07h11.614c.2 0 .4-.31.4-.828 0-.517-.2-.828-.4-.828H82.162c-.2 0-.4.414-.4.828 0 .517.2.828.4.828Zm-3.297 0H63.968c-.207 0-.414-.31-.414-.828 0-.414.207-.828.414-.828h14.897c.207 0 .414.31.414.828 0 .517-.207.828-.414.828Zm14.075 14.07H63.135c-.204 0-.408-.311-.408-.828 0-.414.204-.828.408-.828H92.94c.204 0 .409.31.409.828 0 .413-.205.827-.409.827Zm-29.822 4.965h14.089c.293 0 .49-.414.391-.828 0-.517-.195-.827-.391-.827h-14.09c-.195 0-.39.414-.39.827 0 .518.195.828.39.828Zm-12.461 0c-.202 0-.403-.108-.605-.323l-2.823-3.011c-.303-.323-.303-.969 0-1.291.302-.323.907-.323 1.21 0l2.319 2.474 4.739-5.056c.302-.322.907-.322 1.21 0 .302.323.302.968 0 1.291L51.261 68.3c-.1.215-.303.323-.605.323ZM46.74 87.335c.202.216.404.323.605.323.303 0 .505-.108.605-.323l5.445-5.593c.303-.323.303-.968 0-1.29-.303-.323-.907-.323-1.21 0l-4.739 5.055-2.319-2.474c-.302-.323-.907-.323-1.21 0-.302.323-.302.968 0 1.29l2.823 3.012Z" fill="#9E9E9E"/>\r\n    <path d="M105 66c-1.766 29.183-28 35-31.5 36-3.5.5-5.329.5-10.5.5 13.622-5.98 20.937-17.244 20.81-25.616 6.56.478 17.911 0 21.19-10.884Z" fill="var(--colorBgLighter)"/>\r\n    <path fill-rule="evenodd" clip-rule="evenodd" d="m106.516 57.502-.518 8.558c-1.736 28.696-26.583 35.382-31.671 36.751-.224.06-.409.109-.552.151l-.066.018-.068.01c-3.57.51-5.463.51-10.606.51h-4.801l4.364-1.916c13.378-5.873 20.331-16.836 20.213-24.685l-.017-1.092 1.09.08c3.234.235 7.548.224 11.421-1.128 3.825-1.336 7.207-3.968 8.737-9.047l2.474-8.21ZM84.789 77.946c-.42 7.843-6.6 17.43-17.499 23.535 2.25-.038 3.779-.146 6.002-.462l.5-.136c4.753-1.287 25.267-6.838 29.525-29.358-1.977 2.555-4.587 4.156-7.352 5.122-3.83 1.337-7.965 1.463-11.176 1.3Z" fill="#9E9E9E"/>\r\n    <path d="M88.428 22.65v3.936c-.383 2.158-2.168 3.935-4.465 3.935H62.66c-2.296 0-4.082-1.777-4.465-3.935V22.65c0-.508.383-1.143 1.02-1.143h10.462V21c0-2.03 1.785-3.808 3.827-3.808 2.04 0 3.827 1.777 3.827 3.808v.508h10.46c.255.127.638.508.638 1.143Z" fill="var(--colorBgLighter)"/>\r\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M73.503 18.192c-1.494 0-2.828 1.334-2.828 2.808V22.508H59.252a.282.282 0 0 0-.057.143V26.492c.341 1.717 1.753 3.029 3.465 3.029h21.304c1.712 0 3.125-1.312 3.465-3.028V22.65c0-.061-.01-.108-.022-.143H76.33V21c0-1.474-1.334-2.808-2.827-2.808Zm-4.8 2.316c.26-2.37 2.377-4.316 4.8-4.316 2.422 0 4.538 1.945 4.8 4.316h9.722l.21.105c.544.27 1.193.969 1.193 2.038V26.674l-.015.086c-.454 2.56-2.596 4.76-5.45 4.76H62.66c-2.853 0-4.995-2.2-5.45-4.76l-.015-.086V22.65c0-.483.174-.986.487-1.382.325-.412.85-.76 1.534-.76h9.488Z" fill="#9E9E9E"/>\r\n    <path d="M73.486 23.104c.946 0 1.655-.71 1.655-1.655 0-.946-.71-1.656-1.655-1.656-.946 0-1.655.71-1.655 1.656 0 .945.827 1.655 1.655 1.655Z" fill="var(--colorBgLighter)"/>\r\n  </g>\r\n</svg>\r\n'},85880:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n<path d="M11.256 4.73144L2.67246 20.0209C1.924 21.3541 2.88751 23 4.41643 23H21.5836C23.1125 23 24.076 21.3541 23.3275 20.0209L14.744 4.73144C13.9798 3.3702 12.0202 3.3702 11.256 4.73144Z" fill-opacity="0.2"/>\n<path d="M11.9059 10.4231C11.5644 10.4231 11.2975 10.7153 11.3314 11.0521L11.7933 15.6284C11.8228 15.9208 12.0712 16.1435 12.3678 16.1435H13.6322C13.9288 16.1435 14.1772 15.9208 14.2067 15.6284L14.6686 11.0521C14.7026 10.7153 14.4357 10.4231 14.0941 10.4231H11.9059Z" />\n<path d="M12.4227 17.2876C12.1038 17.2876 11.8453 17.5437 11.8453 17.8596V19.0037C11.8453 19.3197 12.1038 19.5758 12.4227 19.5758H13.5774C13.8962 19.5758 14.1547 19.3197 14.1547 19.0037V17.8596C14.1547 17.5437 13.8962 17.2876 13.5774 17.2876H12.4227Z" />\n</svg>\n'},74169:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n<path d="M7.13381 2.50139L1.36522 12.5003C0.980609 13.1669 1.46175 14 2.23141 14H13.7686C14.5382 14 15.0194 13.1669 14.6348 12.5003L8.86619 2.50139C8.48136 1.83435 7.51864 1.83435 7.13381 2.50139Z" fill-opacity="0.2"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M7.32878 5.00012C6.88506 5.00012 6.53835 5.38324 6.5825 5.82475L6.9325 9.32475C6.97084 9.70815 7.29346 10.0001 7.67878 10.0001H8.3213C8.70661 10.0001 9.02923 9.70815 9.06757 9.32475L9.41757 5.82475C9.46173 5.38324 9.11501 5.00012 8.6713 5.00012H7.32878ZM7.75001 11C7.33579 11 7.00001 11.3358 7.00001 11.75V12.25C7.00001 12.6642 7.33579 13 7.75001 13H8.25001C8.66422 13 9.00001 12.6642 9.00001 12.25V11.75C9.00001 11.3358 8.66422 11 8.25001 11H7.75001Z"/>\n</svg>\n'},53548:e=>{e.exports='<svg width="16" height="16" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M7 6a1 1 0 1 1 2 0v3a1 1 0 0 1-2 0V6ZM7 12a1 1 0 1 1 2 0 1 1 0 0 1-2 0Z" fill="var(--colorFg)"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.118 1.654a1 1 0 0 1 1.764 0l6.334 11.875A1 1 0 0 1 14.333 15H1.667a1 1 0 0 1-.883-1.47L7.118 1.653ZM2 14a.2.2 0 0 1-.176-.294l6-11.25a.2.2 0 0 1 .352 0l6 11.25A.2.2 0 0 1 14 14H2Z" fill="var(--colorFg)"/>\n</svg>\n'},34861:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M7.279 1c-.895 0-1.583.79-1.583 1.679V3.82H3.357C2.643 3.821 2 4.464 2 5.18v1.91h1.036c.866 0 1.535.745 1.535 1.632 0 .884-.666 1.6-1.535 1.6H2v2.322C2 13.357 2.643 14 3.357 14H5.68v-1.036c0-.87.716-1.535 1.6-1.535.887 0 1.632.669 1.632 1.535V14h1.946c.715 0 1.357-.643 1.357-1.357v-2.34h1.107c.889 0 1.679-.687 1.679-1.582 0-.893-.79-1.614-1.679-1.614h-1.107V5.18c0-.715-.642-1.358-1.357-1.358H8.893V2.68c0-.891-.738-1.68-1.614-1.68z"/>\n</svg>\n'},17792:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M5.357 3c0-1.03.8-2 1.91-2 1.079 0 1.94.952 1.94 2v.25h1.75c.906 0 1.7.794 1.7 1.7V6.7h.25c1.044 0 2 .843 2 1.94 0 1.11-.97 1.91-2 1.91h-.25v1.75c0 .906-.794 1.7-1.7 1.7h-2.6v-1.4c0-.542-.473-1-1.09-1-.605 0-1.06.446-1.06 1V14h-2.6c-.906 0-1.7-.794-1.7-1.7V9.7h1.4c.553 0 1-.455 1-1.06 0-.618-.459-1.09-1-1.09h-1.4v-2.6c0-.906.794-1.7 1.7-1.7h1.75V3zm1.91-1c-.48 0-.91.44-.91 1v1.25h-2.75c-.354 0-.7.346-.7.7v1.6h.4c1.168 0 2 .998 2 2.09 0 1.105-.844 2.06-2 2.06h-.4v1.6c0 .354.346.7.7.7h1.6v-.4c0-1.156.955-2 2.06-2 1.092 0 2.09.832 2.09 2v.4h1.6c.354 0 .7-.346.7-.7V9.55h1.25c.56 0 1-.43 1-.91 0-.493-.455-.94-1-.94h-1.25V4.95c0-.354-.346-.7-.7-.7h-2.75V3c0-.542-.46-1-.94-1z"/></svg>\n'},5713:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">\n  <path fill="none" fill-rule="evenodd" clip-rule="evenodd" d="M13.0907 6C12.059 6 11.2651 6.91179 11.2651 7.93681V9.25549L8.31641 9.25C7.49204 9.25 6.75047 9.99706 6.75047 10.8214V13.0261H7.94553C8.94526 13.0261 9.71751 13.8854 9.71751 14.9093C9.71751 15.9293 8.9489 16.7555 7.94553 16.7555H6.75047V19.4341C6.75047 20.2584 7.49204 21 8.31641 21H11.2445V19.8049C11.2445 18.8016 12.0707 18.033 13.0907 18.033C14.1146 18.033 14.9739 18.8052 14.9739 19.8049V21H17.2198C18.0441 21 18.7857 20.2584 18.7857 19.4341V16.7349H20.0632C21.0882 16.7349 22 15.941 22 14.9093C22 13.8788 21.0893 13.0467 20.0632 13.0467H18.7857V10.8214C18.7857 9.99706 18.0441 9.25549 17.2198 9.25549H14.9533V7.93681C14.9533 6.91039 14.1024 6 13.0907 6Z" stroke="currentColor" stroke-width="1.5"/>\n</svg>\n'},70942:e=>{e.exports='<svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M10.146 5.146 8.854 3.854l-3 3a.5.5 0 1 1-.708-.708l3-3-1.292-1.292A.5.5 0 0 1 7.207 1H11v3.793a.5.5 0 0 1-.854.353ZM1.5 2A1.5 1.5 0 0 0 0 3.5v7A1.5 1.5 0 0 0 1.5 12h7a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0v2a.5.5 0 0 1-.5.5h-7a.5.5 0 0 1-.5-.5v-7a.5.5 0 0 1 .5-.5h3a.5.5 0 0 0 0-1h-3Z"/>\n</svg>\n'},6836:e=>{e.exports='<svg width="46" height="46" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M23 45c9.64 0 15 0 18.5-3.5S45 32.64 45 23s0-15-3.5-18.5S32.64 1 23 1 8 1 4.5 4.5 1 13.36 1 23s0 15 3.5 18.5S13.36 45 23 45Z" fill="var(--colorAccentBg)"/>\n  <path d="M41.5 41.5C38 45 32.64 45 23 45c-1.819 0-3.485 0-5.016-.023L11 34.5a3.716 3.716 0 0 1 1.714-3.759l1.891-1.168-4.004-6.84 4.004-3.396-4.004-5.603c0-1.019.962-1.764 1.948-1.508l11.955 3.095a11.5 11.5 0 0 1 5.146 2.9L32.5 21l10.552 18.447a9.28 9.28 0 0 1-1.552 2.052Z" fill="url(#a)"/>\n  <path d="M36.879 33.431c.134 1.414-1.03 2.569-2.45 2.569-1.42 0-2.556-1.156-2.722-2.567-1.175-10.005-9.135-17.965-19.14-19.14C11.157 14.127 10 12.992 10 11.57c0-1.42 1.155-2.584 2.569-2.45C25.41 10.34 35.66 20.59 36.879 33.431ZM13.857 36a3.857 3.857 0 1 0 0-7.714 3.857 3.857 0 0 0 0 7.714Z" fill="#fff"/>\n  <path d="M25.429 36c1.42 0 2.59-1.158 2.389-2.564-1.128-7.878-7.376-14.126-15.254-15.254-1.406-.201-2.564.97-2.564 2.39 0 1.42 1.163 2.544 2.555 2.826a12.896 12.896 0 0 1 10.047 10.047C22.884 34.837 24.008 36 25.43 36Z" fill="#fff"/>\n  <defs>\n    <linearGradient id="a" x1="18.809" y1="9.472" x2="41.713" y2="48.206" gradientUnits="userSpaceOnUse">\n      <stop stop-opacity=".2"/>\n      <stop offset=".791" stop-opacity=".05"/>\n    </linearGradient>\n  </defs>\n</svg>\n'},4103:e=>{e.exports='<svg width="10" height="10" xmlns="http://www.w3.org/2000/svg">\n  <path fill="currentColor" stroke-width="0" d="M7 5L3.366 8.634A.8.8 0 012 8.07V1.93a.8.8 0 011.366-.565L7 5z"/>\n</svg>\n'},94012:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n<path d="M6.8801 6.95769L5.6801 5H4V11H12V6.95769H6.8801ZM12.8425 6.96C12.8423 6.96029 12.8363 6.96 12.8254 6.95824C12.8373 6.95882 12.8428 6.9597 12.8425 6.96ZM6.8 3L8 4.95769H12.8C13.46 4.95769 14 5.2125 14 5.9V11.75C14 12.4375 13.46 13 12.8 13H3.2C2.54 13 2 12.4375 2 11.75V4.25C2 3.5625 2.54 3 3.2 3H6.8Z"/>\n</svg>\n'},27139:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M2.00071 4.21203C2.00586 3.89221 2.13395 3.58693 2.35788 3.36075C2.58182 3.13457 2.88406 3.0052 3.20071 3H6.80071L8.00072 5H13.0007C13.5007 5 14.0007 5.5 14.0007 6L14.0007 11.7872C13.9956 12.1071 13.8675 12.4123 13.6435 12.6385C13.4196 12.8647 13.1174 12.9941 12.8007 12.9993H3.20071C3.04162 13.0049 2.88308 12.9774 2.73497 12.9185C2.58685 12.8596 2.45232 12.7705 2.33976 12.6568C2.22719 12.5431 2.139 12.4073 2.08067 12.2577C2.02234 12.1081 1.99513 11.9479 2.00071 11.7872V8H2V7H2.00071V4.21203ZM3.00071 8V11.8046L3.00011 11.822C2.99924 11.847 3.0035 11.8717 3.01236 11.8944C3.02122 11.9171 3.03435 11.9371 3.05038 11.9533C3.06639 11.9694 3.08492 11.9815 3.10455 11.9893C3.12415 11.9971 3.14478 12.0006 3.16526 11.9999L3.18298 11.9993H12.7891C12.8414 11.9972 12.893 11.9753 12.9329 11.935C12.9733 11.8942 12.9985 11.8376 13.0007 11.7761L13.0007 8H3.00071ZM13.0007 7H3.00071V4.22318C3.00294 4.16171 3.02812 4.10511 3.06851 4.06432C3.10845 4.02398 3.16001 4.00208 3.21233 4H6.24661L7.50072 6H12.8007C12.9112 6 13.0007 6.08796 13.0007 6.19842V7Z"/>\n  <path fill-rule="evenodd" d="M2.99938 11.822L2.99998 11.8046L2.99938 8H12.8C12.9104 8 13 8.08938 13 8.19983C13 8.87896 13 11.0937 13 11.7761C12.9978 11.8376 12.9726 11.8942 12.9322 11.935C12.8922 11.9753 12.8407 11.9972 12.7884 11.9993H3.18225L3.16453 11.9999C3.14404 12.0006 3.12342 11.9971 3.10382 11.9893C3.08419 11.9815 3.06565 11.9694 3.04965 11.9533C3.03362 11.9371 3.02049 11.9171 3.01163 11.8944C3.00276 11.8717 2.99851 11.847 2.99938 11.822Z" fill-opacity="0.1"/>\n</svg>\n'},64750:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M2.35717 3.36075C2.13323 3.58693 2.00515 3.89221 2 4.21203V11.7872C1.99441 11.9479 2.02163 12.1081 2.07996 12.2577C2.13828 12.4073 2.22648 12.5431 2.33904 12.6568C2.4516 12.7705 2.58613 12.8596 2.73425 12.9185C2.88237 12.9774 3.04091 13.0049 3.2 12.9993H12.8C13.1167 12.9941 13.4189 12.8647 13.6428 12.6385C13.8668 12.4123 13.9948 12.1071 14 11.7872L14 6C14 5.5 13.5 5 13 5H8L6.8 3H3.2C2.88334 3.0052 2.5811 3.13457 2.35717 3.36075ZM2.99939 11.822L3 11.8046V4.22318C3.00223 4.16171 3.02741 4.10511 3.06779 4.06432C3.10773 4.02398 3.15929 4.00208 3.21161 4H6.24589L7.5 6H12.8C12.9105 6 13 6.08796 13 6.19842C13 7.13107 13 11.0636 13 11.7761C12.9978 11.8376 12.9726 11.8942 12.9322 11.935C12.8923 11.9753 12.8407 11.9972 12.7884 11.9993H3.18227L3.16455 11.9999C3.14406 12.0006 3.12343 11.9971 3.10383 11.9893C3.08421 11.9815 3.06567 11.9694 3.04966 11.9533C3.03364 11.9371 3.02051 11.9171 3.01165 11.8944C3.00278 11.8717 2.99853 11.847 2.99939 11.822Z"/>\n  <path fill-rule="evenodd" d="M2.99939 11.822L3 11.8046V4.22318C3.00223 4.16171 3.02741 4.10511 3.06779 4.06432C3.10773 4.02398 3.15929 4.00208 3.21161 4H6.24589L7.5 6H12.8C12.9105 6 13 6.08796 13 6.19842C13 7.13107 13 11.0636 13 11.7761C12.9978 11.8376 12.9726 11.8942 12.9322 11.935C12.8923 11.9753 12.8407 11.9972 12.7884 11.9993H3.18227L3.16455 11.9999C3.14406 12.0006 3.12343 11.9971 3.10383 11.9893C3.08421 11.9815 3.06567 11.9694 3.04967 11.9533C3.03364 11.9371 3.02051 11.9171 3.01165 11.8944C3.00278 11.8717 2.99853 11.847 2.99939 11.822Z" fill-opacity="0.1"/>\n</svg>\n'},16441:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M10 10H12V12H10V10ZM15 10H13V12H15V10ZM15 13H13V15H15V13ZM12 13H10V15H12V13Z"/>\n  <path fill-rule="evenodd" d="M2.35788 3.36075C2.13395 3.58693 2.00586 3.89221 2.00071 4.21203V7H2V8H2.00071V11.7872C1.99513 11.9479 2.02234 12.1081 2.08067 12.2577C2.139 12.4073 2.22719 12.5431 2.33976 12.6568C2.45232 12.7705 2.58685 12.8596 2.73497 12.9185C2.88308 12.9774 3.04162 13.0049 3.20071 12.9993H9V11.9993H3.18298L3.16526 11.9999C3.14478 12.0006 3.12415 11.9971 3.10455 11.9893C3.08492 11.9815 3.06639 11.9694 3.05038 11.9533C3.03435 11.9371 3.02122 11.9171 3.01236 11.8944C3.0035 11.8717 2.99924 11.847 3.00011 11.822L3.00071 11.8046V8H13.0007V9H14.0007L14.0007 6C14.0007 5.5 13.5007 5 13.0007 5H8.00072L6.80071 3H3.20071C2.88406 3.0052 2.58182 3.13457 2.35788 3.36075ZM3.00071 7H13.0007V6.19842C13.0007 6.08796 12.9112 6 12.8007 6H7.50072L6.24661 4H3.21233C3.16001 4.00208 3.10845 4.02398 3.06851 4.06432C3.02812 4.10511 3.00294 4.16171 3.00071 4.22318V7Z"/>\n  <path fill-rule="evenodd" d="M2.99998 11.8046L2.99938 11.822C2.99851 11.847 3.00276 11.8717 3.01163 11.8944C3.02049 11.9171 3.03362 11.9371 3.04965 11.9533C3.06565 11.9694 3.08419 11.9815 3.10382 11.9893C3.12342 11.9971 3.14404 12.0006 3.16453 11.9999L3.18225 11.9993H9V9H13V8.19983C13 8.08938 12.9104 8 12.8 8H2.99938L2.99998 11.8046Z" fill-opacity="0.1"/>\n</svg>\n'},31102:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M10 10H12V12H10V10ZM15 10H13V12H15V10ZM15 13H13V15H15V13ZM12 13H10V15H12V13Z"/>\n  <path fill-rule="evenodd" d="M2 4.21203C2.00515 3.89221 2.13323 3.58693 2.35717 3.36075C2.5811 3.13457 2.88334 3.0052 3.2 3H6.8L8 5H13C13.5 5 14 5.5 14 6L14 9H13L13 6.19842C13 6.08796 12.9105 6 12.8 6H7.5L6.24589 4H3.21161C3.15929 4.00208 3.10773 4.02398 3.06779 4.06432C3.02741 4.10511 3.00223 4.16171 3 4.22318V11.8046L2.99939 11.822C2.99853 11.847 3.00278 11.8717 3.01165 11.8944C3.02051 11.9171 3.03364 11.9371 3.04966 11.9533C3.06567 11.9694 3.08421 11.9815 3.10383 11.9893C3.12343 11.9971 3.14406 12.0006 3.16455 11.9999L3.18227 11.9993H9V12.9993H3.2C3.04091 13.0049 2.88237 12.9774 2.73425 12.9185C2.58613 12.8596 2.4516 12.7705 2.33904 12.6568C2.22648 12.5431 2.13828 12.4073 2.07996 12.2577C2.02163 12.1081 1.99441 11.9479 2 11.7872V4.21203Z" />\n  <path fill-rule="evenodd" d="M3 11.8046L2.99939 11.822C2.99853 11.847 3.00278 11.8717 3.01165 11.8944C3.02051 11.9171 3.03364 11.9371 3.04967 11.9533C3.06567 11.9694 3.08421 11.9815 3.10383 11.9893C3.12343 11.9971 3.14406 12.0006 3.16455 11.9999L3.18227 11.9993H9V9H13L13 6.19842C13 6.08796 12.9105 6 12.8 6H7.5L6.24589 4H3.21161C3.15929 4.00208 3.10773 4.02398 3.06779 4.06432C3.02741 4.10511 3.00223 4.16171 3 4.22318V11.8046Z" fill-opacity="0.1"/>\n</svg>\n'},47802:e=>{e.exports='<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <rect x="6" y="17" width="15" height="4" rx="1"/>\n  <rect x="15" y="10" width="2" height="8"/>\n  <circle cx="16" cy="9" r="4"/>\n  <rect x="7" y="16" width="5" height="4" rx="0.5"/>\n</svg>\n'},48082:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <rect x="2" y="10" width="12" height="4" rx="1" />\n  <rect x="9" y="6" width="2" height="5" />\n  <circle cx="10" cy="4" r="3" />\n  <rect x="3" y="9" width="3" height="2" rx="0.5" />\n</svg>\n'},82418:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M13.1429 11H2.85714V12H13.1429V11ZM2.85714 10C2.38376 10 2 10.4477 2 11V12C2 12.5523 2.38376 13 2.85714 13H13.1429C13.6162 13 14 12.5523 14 12V11C14 10.4477 13.6162 10 13.1429 10H2.85714Z"/>\n  <path fill-rule="evenodd" d="M10.5 2.80208C9.56227 2.80208 8.80208 3.56227 8.80208 4.5C8.80208 5.43773 9.56227 6.19792 10.5 6.19792C11.4377 6.19792 12.1979 5.43773 12.1979 4.5C12.1979 3.56227 11.4377 2.80208 10.5 2.80208ZM7.95312 4.5C7.95312 3.0934 9.0934 1.95312 10.5 1.95312C11.9066 1.95312 13.0469 3.0934 13.0469 4.5C13.0469 5.9066 11.9066 7.04688 10.5 7.04688C9.0934 7.04688 7.95312 5.9066 7.95312 4.5Z"/>\n  <rect x="4" y="9" width="3" height="2" rx="0.5"/>\n  <rect x="10" y="7" width="1" height="4"/>\n</svg>\n'},19458:e=>{e.exports='<svg viewBox="0 0 110 90" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" preserveAspectRatio="xMidYMid slice">\n  <g>\n    <path fill="transparent" d="M0 0h110v90h-110z" class="folderoutline"/>\n    <polygon fill="url(#bookmark-graphic-gradient)" class="bookmark-shadow" points="66 30 65 62 55 57 44 64 60 90 98 90" />\n    <g>\n      <use class="bookmark-shape" xlink:href="#sd-bookmark"/>\n      <use fill="url(#sd-bookmark-gradient)" fill-opacity="0.1" xlink:href="#sd-bookmark"/>\n    </g>\n  </g>\n</svg>\n'},37893:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path d="M18.7273 17.309L15.5455 14.2331C16.6909 13.3719 17.4545 12.0185 17.4545 10.542V9.55776C17.4545 7.2201 15.6727 5.1285 13.2545 5.00547C10.7091 4.88243 8.54545 6.85099 8.54545 9.31169V10.542C8.54545 12.0185 9.30909 13.3719 10.4545 14.2331L7.27273 17.309C6.63636 17.9241 6 18.5393 6 19.7697C6 20.5079 6.50909 21 7.27273 21H18.7273C19.4909 21 20 20.5079 20 19.7697C20 19.1545 19.3636 17.9241 18.7273 17.309Z"/>\n</svg>\n'},44309:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.66246 8.98453L9.57295 8.28569C10.3331 7.70226 10.8182 6.80023 10.8182 5.84928V4.98804C10.8182 3.40644 9.64227 2.08083 8.1676 2.00351C6.53688 1.92376 5.18182 3.21192 5.18182 4.77273V5.84928C5.18182 6.80023 5.66693 7.70226 6.42705 8.28569L7.33754 8.98453L6.52059 9.79073L3.79332 12.4821C3.25655 13.0118 3 13.2918 3 13.9234C3 13.9567 3.00377 13.9782 3.00682 13.9903C3.02052 13.9943 3.04748 14 3.09091 14H12.9091C12.9525 14 12.9795 13.9943 12.9932 13.9902C12.9962 13.9782 13 13.9567 13 13.9234C13 13.9262 13 13.9259 12.9995 13.9224C12.9977 13.9093 12.9896 13.8515 12.9545 13.7425C12.9139 13.6165 12.8504 13.4634 12.7671 13.2989C12.5942 12.9577 12.3797 12.6528 12.2067 12.4821L9.47941 9.79073L8.66246 8.98453ZM8.21818 1.00479C10.2909 1.11244 11.8182 2.94258 11.8182 4.98804V5.84928C11.8182 6.79262 11.4692 7.67856 10.8986 8.38135C10.6878 8.641 10.4467 8.87565 10.1818 9.07896L10.8991 9.78676L12.9091 11.7703C13.4545 12.3086 14 13.3852 14 13.9234C14 14.5694 13.5636 15 12.9091 15H3.09091C2.43636 15 2 14.5694 2 13.9234C2 12.8469 2.54545 12.3086 3.09091 11.7703L5.10095 9.78676L5.81818 9.07896C5.5533 8.87565 5.31224 8.641 5.10142 8.38135C4.53083 7.67856 4.18182 6.79262 4.18182 5.84928V4.77273C4.18182 2.61962 6.03636 0.89713 8.21818 1.00479Z"/>\n</svg>\n'},61701:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M7.75 14C7.75 11.9012 7.75 10.8518 8.13404 10.0398C8.52971 9.20321 9.20321 8.52971 10.0398 8.13404C10.8518 7.75 11.9012 7.75 14 7.75V7.75C16.0988 7.75 17.1482 7.75 17.9602 8.13404C18.7968 8.52971 19.4703 9.20321 19.866 10.0398C20.25 10.8518 20.25 11.9012 20.25 14V14C20.25 16.0988 20.25 17.1482 19.866 17.9602C19.4703 18.7968 18.7968 19.4703 17.9602 19.866C17.1482 20.25 16.0988 20.25 14 20.25V20.25C11.9012 20.25 10.8518 20.25 10.0398 19.866C9.20321 19.4703 8.52971 18.7968 8.13404 17.9602C7.75 17.1482 7.75 16.0988 7.75 14V14Z" stroke="currentColor" stroke-width="1.5"/>\n<line x1="13.5" y1="10.5" x2="13.5" y2="14.5" stroke="currentColor" stroke-linecap="round"/>\n<line x1="13.8107" y1="14.5" x2="15.75" y2="16.4393" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n</svg>\n'},66089:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M7 5.5C7 5.22386 7.22386 5 7.5 5H8.5C8.77614 5 9 5.22386 9 5.5V8.70711L10.2289 9.70014C10.4366 9.86798 10.4758 10.1694 10.3179 10.3847L9.80837 11.0795C9.6402 11.3088 9.31488 11.3519 9.09282 11.1743L7 9.5V5.5Z"/>\n  <path fill-rule="evenodd" d="M1 8C1 6.13872 1 5.20808 1.24472 4.45492C1.73931 2.93273 2.93273 1.73931 4.45492 1.24472C5.20808 1 6.13872 1 8 1C9.86128 1 10.7919 1 11.5451 1.24472C13.0673 1.73931 14.2607 2.93273 14.7553 4.45492C15 5.20808 15 6.13872 15 8C15 9.86128 15 10.7919 14.7553 11.5451C14.2607 13.0673 13.0673 14.2607 11.5451 14.7553C10.7919 15 9.86128 15 8 15C6.13872 15 5.20808 15 4.45492 14.7553C2.93273 14.2607 1.73931 13.0673 1.24472 11.5451C1 10.7919 1 9.86128 1 8ZM8 13C5.98305 13 5.44891 12.9753 5.07295 12.8532C4.15964 12.5564 3.44358 11.8404 3.14683 10.9271C3.02467 10.5511 3 10.0169 3 8C3 5.98305 3.02467 5.44891 3.14683 5.07295C3.44358 4.15964 4.15964 3.44358 5.07295 3.14683C5.44891 3.02467 5.98305 3 8 3C10.0169 3 10.5511 3.02467 10.9271 3.14683C11.8404 3.44358 12.5564 4.15964 12.8532 5.07295C12.9753 5.44891 13 5.98305 13 8C13 10.0169 12.9753 10.5511 12.8532 10.9271C12.5564 11.8404 11.8404 12.5564 10.9271 12.8532C10.5511 12.9753 10.0169 13 8 13Z"/>\n</svg>\n'},3335:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M6 2h4a4 4 0 014 4v4a4 4 0 01-4 4H6a4 4 0 01-4-4V6a4 4 0 014-4zM1 6a5 5 0 015-5h4a5 5 0 015 5v4a5 5 0 01-5 5H6a5 5 0 01-5-5V6zm6-2h1v4h2v1H7V4z"/>\n</svg>\n'},91273:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path class="small-icon-fill" fill-rule="evenodd" d="M6 1a5 5 0 00-5 5v4a5 5 0 005 5h4a5 5 0 005-5V6a5 5 0 00-5-5H6zm1 3h1v4h2v1H7V4z"/>\n  <path class="small-icon-outline" fill-rule="evenodd" d="M10 2H6a4 4 0 00-4 4v4a4 4 0 004 4h4a4 4 0 004-4V6a4 4 0 00-4-4zM6 1a5 5 0 00-5 5v4a5 5 0 005 5h4a5 5 0 005-5V6a5 5 0 00-5-5H6z"/>\n</svg>\n'},89237:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 285">\n  <path d="M123 280.7c-.9-.1-1.6-.3-1.4-1.2 3.2-13.9 4.9-28.3 9.7-41.8.7-2 1.8-3.9 2.8-6-.5-.4-.9-.8-1-.8-34.6 20.6-69.8 21-105.5 4.4C16 229.9 6.6 221 4 208c-3-14.9-4.9-30.2.4-45.1 6-16.7 18.7-26.9 34.7-33.4 18.6-7.6 37.9-10.2 57.9-8 .5.1 1.1 0 1.4-.3 12.6-9.5 26.9-16.1 40.6-23.7 8.6-4.8 15.9-11.5 24.5-16.3.3-.2.6-.5.7-.8 1.8-5.2 6.3-7.3 10.7-9.3 14.6-6.5 29.4-12.8 44-19.4 23-10.4 44.6-23 64.6-38.4 4.3-3.3 9-6.3 13.5-9.3.8.2 1.1.7 1.3 1.6-4.1 2.8-8.3 5.7-12.5 8.6-12.7 8.9-24.9 18.4-38.6 25.7-22.8 12.2-46.6 22.4-70.3 32.7-4.5 2-9.1 3.9-11.1 9.1-.7 1.9-3.1 2.4-4.7 3.6-17 12.8-36.5 21.6-54.5 32.8-7.7 4.8-15 10.3-21.1 17-2.8 3.1-2.3 5.4 1.7 6.7 4.2 1.3 8.3 1.4 12.3-.9 11.3-6.4 23.4-10.5 36-13.2 2.3-.5 4.6-1.5 6.8-2.5 5.9-2.5 11.9-3.5 18.3-3.3 5.3.2 10.6.5 15.9-.2.7-.1 1.4 0 1.5.9.1.9-.4 1.1-1.2 1.2-1.5.1-2.9.5-4.4.5-5.6.1-11.1 0-16.6 0-1.5 7-3.3 15.1 3.5 20.9 4.2 3.6 8.2 7.5 12.8 11.6-.2-8.1 5.3-12.3 10.7-16.6-2.4-3.1-6-4-9.3-2.8-3.1 1.1-6.2 2-9.3 3-.2.1-.5-.1-.7-.1-.6-1.2 0-1.7 1-2.1 3.5-1.2 7-2.3 10.5-3.6 5.4-2 6.7-5.5 4.2-11.2.7-1 1.9-1.2 3-.9 1.5.3 2.2 1.5 2.4 2.9.6 3.6 1.2 7.2 1.8 11.2 2.1-2 3.3-4 4-6.2 1.2-3.9 2.4-7.9 2.3-12 0-.7.3-1.4 1.3-1.4.8 0 1 .7.9 1.3-.7 7.8-1.8 15.3-8.1 21-2.5 2.3-4.8 4.7-7.4 6.7-4.2 3.2-5 8-5.7 12.7-.9 7.1 3.4 12.7 12 16 1.2.5 2.4.9 3 2.4 4.4-1.9 9.2-3 11.8-7.9 2.2-4.2 6.5-6.3 10.4-8.7 5.3-3.4 10.9-6.3 15.9-10.2 2.6-2 5.6-3.2 8.6-4.5 13-5.4 24.5-13 33.9-23.4 5.9-6.5 9.7-14.7 13.4-22.7 3.1-6.9 7-13 14.6-16.3.4.1.7.7.9 1.4-.3.3-.6.6-1 .8-5.8 3.1-9.3 8-12 13.8-2.8 6.2-6.2 12.1-9.7 18-6.3 10.7-16.4 17.1-26.3 23.7-.5.4-1.1.7-1.6.9-.3 4.1.1 7.8 2.2 11.5 2 3.4 1.5 7.2-1 10.3-2.3 2.8-5.5 2.5-8.8 2-5.5-.8-9.9-4.4-14.9-6.4-4.3-1.7-8-2-10.9 2.1 5 6.1 5.5 10 1.9 14.4-3.4 4.1-7.8 3.8-17.1-1.3-4.1 2.2-8.3 4.2-12.9 5.1-9.2 2-17.4-4.2-15.7-13.3 1.5-7.7-2.8-11.1-7.3-15-4.9-4.3-10.5-8.2-10.9-15.6-.1-3.1.5-6.2.8-9.4.1-.6.1-1.2.2-2.2-8.4 1.5-15.7 6.1-24.4 7.1 19.2 12 32 27.3 29.6 51.1 3.7.5 7.2 1 10.8 1.6-.1 1.9-.3 3.6-.4 5.4 5.7 1.9 11.6 2.8 17.5 3.5 10.9 1.5 22 2.3 33 2.4 15.2.1 29.9-2.8 44-8.4 4.2-1.6 8.4-3.5 12.5-5.3 1.1-.4 2.1-.8 3 .3-36 19.5-73.7 17.3-112 9-1.5 2-1.9 4.5-2.5 7.2 40 7.2 79.3 8.6 117.1-10.2.9 1.1 0 1.8-1.1 2.4-8.4 4.7-17.5 7.3-26.7 9.8-18.6 5-37.5 5.5-56.6 4.2-10.6-.7-21-2.1-31.4-4h-.7c-.6 1.3-1.1 2.5-1.7 3.7-3.7-.5-7.2-1-10.8-1.5-.4.7-.7 1.2-1.2 2 1.9.6 3.7 1.2 5.4 1.8 2.3.9 3.2 2.7 2 4.9-3.4 6.4-6.8 12.8-10.4 19-1.3 2.3-3.2 4.2-4.9 6.4-1.5-.6-3.1-1.1-4.7-1.8-6.3 14.7-7.3 31-13.1 45.8 3.7-16.1 5.7-32.6 12-48.2 1.6.6 3.1 1.2 4.7 1.8-.2-1.2 0-2.3-1-3.1-.8-.6-1.6-1.3-2.5-2 .7-1.6 1.2-3.2 2-4.6.4-.7.9-2 1.9-1.7 1.8.5 3.3 1.6 4.1 3.4.2.5.3 1.1.6 2.2 3.4-6.4 6.6-12.3 9.7-18.4.6-1.1-.4-1.8-1.5-2.2-4.5-1.4-9-3.3-13.7-3.9-4.2 3.1-4.8 9.1-1 11.3-.9 1.4-1.7 2.8-2.7 4.3 1.1.6 2.1 1.1 3.4 1.7-1.3 2.3-2.6 4.6-3.9 7-1.3-.7-2.3-1.4-3.4-2-1.2 1.1-1.2 1.1 1.9 5.2-8.1 15.4-8.3 32.9-13.1 49.3zM92.4 125.6c-10.7-1.2-21-.7-31.2 1.2-14.7 2.7-28.3 7.9-39.5 18.3-13.2 12.2-15 28.9-4.6 42.4 7.5 9.6 17.6 15.4 28.9 19.4 17.5 6.2 35.5 7.3 53.7 4.2 14.8-2.4 28.5-7.7 40-17.8 10.8-9.4 14.9-22.8 10.1-34.7-5-12.5-15.3-19.6-26.9-25.1-.5-.2-1.3.1-1.9.2-7.5 2.3-14.5 5.6-21.4 9.3-4.8 2.6-9.8 1.9-14.5 0-3.7-1.5-4.5-5.4-2-8.4 2.7-3.2 5.8-6 9.3-9zm57.7 76.8c-1.8-.9-4.3.5-5.1-1.6-.9-2.7-1.9-5.5.6-8.2 1.8-1.9 3.3-4.3 4.6-6.6 1.4-2.5 1.9-5.9 6.1-3.7.3-9.6.1-18.7-5.4-26.8 2.8 6.4 4 12.9 2.3 19.8-3.1 12.8-11.8 21.2-22.7 27.4-19.7 11.1-41 14.1-63.2 11.4-17.2-2.1-33.1-7.4-46.4-19.2-11.9-10.5-15.8-25-10-38.3 1.1-2.6 2.8-5.1 4.6-8.4-4.5 5.2-7.4 10.4-9.5 16.1-3.4 9.3-2.4 18.9-2 28.4.3 5.6.3 11.3 2.2 16.7 3.9 11 11.6 18.7 21.7 23.8 25 12.6 51.3 14.7 78.3 7.6 9.2-2.4 17.8-6.5 23.9-11 3.2-5.5 5.4-9.4 7.7-13.3-1-.4-1.8-1-1.8-2-.2-4 .2-7.8 2.6-11.2.7-.9 1.5-1.8 2.9-1.4 2.5.7 5 1.4 7.6 2.2.4-.8.7-1.2 1-1.7zm72.3-46.3c.7.2 1.5.6 2.3.8 5.4 1.3 9.6 5.4 15.2 6.5 5.4 1.1 8.7-.6 8.8-5.2.1-4.5-2.3-8-5.1-11.2-.8-.9-2-1.8-3.6-1.2-6.5 2.3-12.4 5.8-17.6 10.3zm-55.5 29.4c-4.6-.6-8.9-1.2-13.2-1.8-1.4 4-4.2 7-6.6 10.4 5.1.7 10 1.3 14.9 2 1.6-3.6 3.2-7 4.9-10.6zm33.9-12.6c5.6 4.4 11.5 4.8 14 1.1 2.8-4.2 1.6-8.8-3.2-11.7-4.4 2.6-8.8 5.4-10.8 10.6zm-39.4 25c-5.2-.7-10.3-1.4-15.6-2.2.4 1.5.7 2.8.9 4.1 5 .7 9.8 1.3 14.7 2v-3.9zm11.1-31.6c-.9 3.9.8 7.3 4.3 9.8 3 2.2 6.2 2.2 10.4.9-6.6-1.9-11.2-5.5-14.7-10.7zm6.5-31.5c1.9 1.2 3.6 2.3 6.2 3.8-1.4-3.8-1.8-7.1-2.3-10.5-1.4 4.4-1.4 4.4-3.9 6.7z"/>\n  <path d="M80.9 151.5c2.8 0 6.7.8 10.2 3 5.4 3.4 5.6 8.8.3 12.4-6.5 4.4-17.8 4.2-24.1-.4-4.5-3.3-4.5-8.1 0-11.4 3.1-2.4 7.3-3.6 13.6-3.6zM79.4 166c3.1 0 5.5-.6 7.4-1.8 3.4-2.1 3.6-5.4.5-7.6-4.1-3-11.6-2.9-15.7.1-2.8 2.1-2.8 5.2.1 7.2 2.4 1.5 5 2.1 7.7 2.1zm-25.7 2.1c-1.2-.1-2.7-.3-2.6-1.7 0-1.5 1.6-1.7 2.8-1.6 1.2 0 2.8.1 2.7 1.8-.2 1.5-1.7 1.4-2.9 1.5zm1.9-12.5c-1.5 0-2.9-.1-3-1.6 0-1.6 1.5-1.7 2.7-1.7 1.2 0 2.8.2 2.7 1.7.1 1.6-1.5 1.5-2.4 1.6zm11.4 22c-1.4 0-3 0-3-1.6 0-1.4 1.5-1.6 2.7-1.6 1.2 0 2.8 0 2.9 1.5.1 1.7-1.5 1.7-2.6 1.7z"/>\n</svg>\n'},83159:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n\t<circle cx="7.5" cy="2.5" r="1.5"/>\n\t<circle cx="7.5" cy="7.5" r="1.5"/>\n\t<circle cx="7.5" cy="12.5" r="1.5"/>\n</svg>\n'},24461:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20">\n  <path d="M11.14 2L9 6h8a7.68 7.68 0 0 0-5.86-4zm-.47 3l1-1.9A6.65 6.65 0 0 1 15 5z" stroke-opacity="0" />\n  <path d="M17.45 7H13l3.92 7a8.15 8.15 0 0 0 .52-7zm-.66 4.71L14.71 8h2a7.18 7.18 0 0 1 .06 3.71zM13.69 11L10 18h.08A7.37 7.37 0 0 0 16 15zm-1.91 5.77l2-3.71 1.06 1.83a6.38 6.38 0 0 1-3.07 1.88zM3 14a7.68 7.68 0 0 0 5.86 4L11 14zm5.32 2.9A6.66 6.66 0 0 1 5 15h4.33zM5.41 10.17L3.08 6a8.12 8.12 0 0 0-.52 7H7zM3.27 12a7.14 7.14 0 0 1-.06-3.71L5.29 12zM9.92 2A7.37 7.37 0 0 0 4 5l2.31 4L10 2zM6.27 6.93L5.21 5.1a6.38 6.38 0 0 1 3-1.88z" stroke-opacity="0" />\n</svg>\n'},69710:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 44 34">\n  <path d="M40.5 32.5H3.7c-1.1 0-2-.9-2-2v-23c0-1.1.9-2 2-2h36.8c1.1 0 2 .9 2 2v23c0 1.1-.9 2-2 2z" fill-opacity="0" />\n  <circle cx="20" cy="20" r="9.5" fill="none" stroke-width="1.1" />\n  <circle cx="20" cy="20" r="5.5" fill="none" stroke-width="1.1" />\n  <path d="M37.5 8.5h-4c-1.1 0-2 .9-2 2s.9 2 2 2h4c1.1 0 2-.9 2-2s-.9-2-2-2z" />\n  <circle cx="7" cy="10" r="1.5" />\n  <path d="M11 1h5c2 0 3 1 3 3v1H8V4c0-2 1-3 3-3z" />\n</svg>\n'},61065:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20">\n  <path d="M13.89 6.23l-2.79.93a4.16 4.16 0 0 1 0 5.22l3 1.18a6.94 6.94 0 0 0-.12-7.34z" fill-opacity="0" />\n  <path d="M15 13.94a7.93 7.93 0 0 0-.09-8L17.66 5l-.32-1-3.07 1-1 .34-3 1-1.23.41-4.11 1.41-1.25.42L1 9.46l2.53 1 1.16.46 4.39 1.76 1.16.46 3.15 1.26 1 .38L17.31 16l.37-.93zM4.5 9.76a3.2 3.2 0 0 1 0-.4l5.58-1.86a3.23 3.23 0 0 1 0 4.5zm6.56 2.62a4.16 4.16 0 0 0 0-5.22l2.79-.93a6.94 6.94 0 0 1 .15 7.34z" stroke-opacity="0" />\n</svg>\n'},9428:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20">\n  <path stroke-opacity="0" d="M18 5H2a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2zM4.29 13.12H3V6.9h1.29zm5.41-.4a2.78 2.78 0 0 1-1.86.56 3 3 0 0 1-1.93-.55 1.84 1.84 0 0 1-.7-1.53h1.23a1.26 1.26 0 0 0 .24.64 1.38 1.38 0 0 0 1.11.38 2.39 2.39 0 0 0 .76-.1.72.72 0 0 0 .56-.72.53.53 0 0 0-.27-.48 3 3 0 0 0-.84-.29l-.67-.15a4.19 4.19 0 0 1-1.4-.48 1.52 1.52 0 0 1-.63-1.34 1.79 1.79 0 0 1 .61-1.39 2.62 2.62 0 0 1 1.81-.55 2.77 2.77 0 0 1 1.7.52 1.85 1.85 0 0 1 .74 1.51H8.91a.89.89 0 0 0-.5-.8 1.72 1.72 0 0 0-.77-.16 1.47 1.47 0 0 0-.82.2.64.64 0 0 0-.31.57.53.53 0 0 0 .3.5 3.76 3.76 0 0 0 .83.26l1.09.26A2.77 2.77 0 0 1 9.8 10a1.52 1.52 0 0 1 .56 1.27 1.78 1.78 0 0 1-.66 1.45zm6.36-.15a2.71 2.71 0 0 1-2 .73 2.71 2.71 0 0 1-2-.73A3.36 3.36 0 0 1 11 10a3.29 3.29 0 0 1 1-2.57 2.71 2.71 0 0 1 2-.73 2.71 2.71 0 0 1 2 .73A3.3 3.3 0 0 1 17 10a3.36 3.36 0 0 1-.94 2.57z"/>\n  <path stroke-opacity="0" d="M14 7.81a1.5 1.5 0 0 0-1.23.57 2.52 2.52 0 0 0-.44 1.62 2.52 2.52 0 0 0 .46 1.62 1.5 1.5 0 0 0 1.23.57 1.48 1.48 0 0 0 1.23-.57A2.55 2.55 0 0 0 15.7 10a2.55 2.55 0 0 0-.45-1.62A1.48 1.48 0 0 0 14 7.81z"/>\n</svg>\n'},94220:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20">\n  <circle cx="10" cy="10" r="8" fill="none" stroke-width="1.1" />\n  <circle cx="10" cy="10" r="1.5" fill="none" />\n  <path d="M11.48 10.483l3.537 3.535-.955.955-3.535-3.536zM15.495 1.494l3.02 3.02-1.5 1.498-3.02-3.02z"/>\n</svg>\n'},32376:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <g style="display: var(--displayImagesCached)">\n    <path opacity="0.3" d="M13 16L11 14L7.5 18.5L8.5 19H19.5L20.5 18.5L16 12L13 16Z" fill="currentColor"/>\n    <path d="M7.75 10.75C7.75 9.64543 8.64543 8.75 9.75 8.75H18.25C19.3546 8.75 20.25 9.64543 20.25 10.75V17.25C20.25 18.3546 19.3546 19.25 18.25 19.25H9.75C8.64543 19.25 7.75 18.3546 7.75 17.25V10.75Z" stroke="currentColor" stroke-width="1.5"/>\n    <path d="M18 22C20.2091 22 22 20.2091 22 18C22 15.7909 20.2091 14 18 14C15.7909 14 14 15.7909 14 18C14 20.2091 15.7909 22 18 22Z" fill="var(--colorWarningBg)"/>\n    <path d="M17 16H18V18H20V19H17V16Z" fill="var(--colorWarningFg)"/>\n  </g>\n  <g style="display: var(--displayImagesAll)">\n    <path d="M13 16L11 14L7.5 18.5L8.5 19H19.5L20.5 18.5L16 12L13 16Z" fill="currentColor"/>\n    <path d="M7.75 10.75C7.75 9.64543 8.64543 8.75 9.75 8.75H18.25C19.3546 8.75 20.25 9.64543 20.25 10.75V17.25C20.25 18.3546 19.3546 19.25 18.25 19.25H9.75C8.64543 19.25 7.75 18.3546 7.75 17.25V10.75Z" stroke="currentColor" stroke-width="1.5"/>\n  </g>\n  <g style="display: var(--displayImagesNever)">\n    <path opacity="0.3" fill-rule="evenodd" clip-rule="evenodd" d="M9 9.5H19C19.2761 9.5 19.5 9.72386 19.5 10V17.0556L16 12L13 16L11 14L8.5 17.2143V10C8.5 9.72386 8.72386 9.5 9 9.5ZM7 10C7 8.89543 7.89543 8 9 8H19C20.1046 8 21 8.89543 21 10V18C21 19.1046 20.1046 20 19 20H9C7.89543 20 7 19.1046 7 18V10Z" fill="currentColor"/>\n    <path d="M18 22C20.2091 22 22 20.2091 22 18C22 15.7909 20.2091 14 18 14C15.7909 14 14 15.7909 14 18C14 20.2091 15.7909 22 18 22Z" fill="var(--colorWarningBg)"/>\n    <path d="M20 17.25H16V18.75H20V17.25Z" fill="white"/>\n  </g>\n  <g style="display: var(--displayAnimationNever)">\n    <path d="M10 14C12.2091 14 14 12.2091 14 10C14 7.79086 12.2091 6 10 6C7.79086 6 6 7.79086 6 10C6 12.2091 7.79086 14 10 14Z" fill="var(--colorErrorBg)"/>\n  <g>\n    <path d="M8 8H9.5V12H8V8Z" fill="white"/>\n    <path d="M10.5 8H12V12H10.5V8Z" fill="white"/>\n  </g>\n  </g>\n  <g style="display: var(--displayAnimationOnce)">\n    <path d="M10 14C12.2091 14 14 12.2091 14 10C14 7.79086 12.2091 6 10 6C7.79086 6 6 7.79086 6 10C6 12.2091 7.79086 14 10 14Z" fill="var(--colorWarningBg)"/>\n    <path d="M9 7V13L12 10L9 7Z" fill="var(--colorWarningFg)"/>\n  </g>\n</svg>\n'},78823:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <g style="display: var(--displayImagesAll)">\n    <path d="M16 4C16 2.89543 15.1046 2 14 2H2C0.895431 2 0 2.89543 0 4V12C0 13.1046 0.895431 14 2 14H14C15.1046 14 16 13.1046 16 12V4ZM4.89 7.5L7.11 10.5L10.223 6L14.223 12H1.778L4.888 7.5H4.89Z"/>\n  </g>\n  <g style="display: var(--displayImagesCached)">\n    <path opacity="0.3" d="M16 4C16 2.89543 15.1046 2 14 2H2C0.895431 2 0 2.89543 0 4V12C0 13.1046 0.895431 14 2 14H14C15.1046 14 16 13.1046 16 12V4ZM4.89 7.5L7.11 10.5L10.223 6L14.223 12H1.778L4.888 7.5H4.89Z"/>\n    <path d="M12 16C14.2091 16 16 14.2091 16 12C16 9.79086 14.2091 8 12 8C9.79086 8 8 9.79086 8 12C8 14.2091 9.79086 16 12 16Z" fill="var(--colorWarningBg)" />\n    <path d="M11 10H12V12H14V13H11V10Z" fill="var(--colorWarningFg)"/>\n  </g>\n  <g style="display: var(--displayImagesNever)">\n    <path opacity="0.3" d="M16 4C16 2.89543 15.1046 2 14 2H2C0.895431 2 0 2.89543 0 4V12C0 13.1046 0.895431 14 2 14H14C15.1046 14 16 13.1046 16 12V4ZM4.89 7.5L7.11 10.5L10.223 6L14.223 12H1.778L4.888 7.5H4.89Z"/>\n    <path d="M12 16C14.2091 16 16 14.2091 16 12C16 9.79086 14.2091 8 12 8C9.79086 8 8 9.79086 8 12C8 14.2091 9.79086 16 12 16Z" fill="var(--colorErrorBg)"/>\n    <path d="M14 11H10V13H14V11Z" fill="var(--colorErrorFg)"/>\n  </g>\n  <g style="display: var(--displayAnimationNever)">\n    <path d="M4 8C6.20914 8 8 6.20914 8 4C8 1.79086 6.20914 0 4 0C1.79086 0 0 1.79086 0 4C0 6.20914 1.79086 8 4 8Z" fill="var(--colorErrorBg)"/>\n    <path d="M2 2H3.5V6H2V2Z" fill="var(--colorErrorFg)"/>\n    <path d="M4.5 2H6V6H4.5V2Z" fill="var(--colorErrorFg)"/>\n  </g>\n  <g style="display: var(--displayAnimationOnce)">\n    <circle fill="var(--colorWarningBg)" cx="4" cy="4" r="4"/>\n    <polygon fill="var(--colorWarningFg)" points="3 1 3 7 6 4" />\n  </g>\n</svg>\n'},39293:e=>{e.exports='<svg width="26" height="26" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M13 20a7 7 0 1 0 0-14 7 7 0 0 0 0 14zm0-11a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm0 3a1 1 0 0 0-1 1v3a1 1 0 1 0 2 0v-3a1 1 0 0 0-1-1z"/>\n</svg>\n'},28676:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zM8 4a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm0 3a1 1 0 0 0-1 1v3a1 1 0 1 0 2 0V8a1 1 0 0 0-1-1z"/>\n</svg>\n'},39567:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M7 8a1 1 0 0 1 2 0v3a1 1 0 1 1-2 0V8zm1-2a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/>\n  <path fill-rule="evenodd" d="M15 8A7 7 0 1 1 1 8a7 7 0 0 1 14 0zm-1 0A6 6 0 1 1 2 8a6 6 0 0 1 12 0z"/>\n</svg>\n'},44042:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n\t<path d="M6.95577 9.93301L14 5.86603L21.0442 9.93301V18.067L14 22.134L6.95577 18.067V9.93301Z" stroke="var(--colorHighlightBg)" stroke-width="1.5"/>\n\t<path d="M14 8L19.1962 11V17L14 20L8.80385 17V11L14 8Z" fill="var(--colorHighlightBg)"/>\n</svg>\n'},51474:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M6.95577 9.93301L14 5.86603L21.0442 9.93301V18.067L14 22.134L6.95577 18.067V9.93301Z" stroke="var(--colorErrorBg)" style="stroke:var(--colorErrorBg);stroke:color(display-p3 0.7765 0.2706 0.2235);stroke-opacity:1;" stroke-width="1.5"/>\n<rect x="13.5" y="9.5" width="1" height="5" rx="0.5" fill="var(--colorErrorBg)" stroke="var(--colorErrorBg)" style="fill:var(--colorErrorBg);fill:color(display-p3 0.9208 0.3607 0.3607);fill-opacity:1;stroke:var(--colorErrorBg);stroke:color(display-p3 0.7765 0.2706 0.2235);stroke-opacity:1;"/>\n<rect x="12.5" y="16" width="3" height="3" rx="1.5" fill="var(--colorErrorBg)" style="fill:var(--colorErrorBg);fill:color(display-p3 0.7765 0.2706 0.2235);fill-opacity:1;"/>\n</svg>\n'},79645:e=>{e.exports='<svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28">\n  <path d="M6.956 9.933 14 5.866l7.044 4.067v8.134L14 22.134l-7.044-4.067V9.933Z" stroke="currentColor" stroke-width="1.5"/>\n  <path d="M9.554 11.433 14 8.866l4.446 2.567v5.134L14 19.134l-4.446-2.567v-5.134Z" stroke="currentColor" stroke-width="1.5"/>\n</svg>\n'},37032:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M0 4C0 3.44772 0.447715 3 1 3H15C15.5523 3 16 3.44772 16 4V11C16 11.5523 15.5523 12 15 12H1C0.447715 12 0 11.5523 0 11V4ZM1 8H3V10H1V8ZM3 5H1V7H3V5ZM4 5H6V7H4V5ZM9 5H7V7H9V5ZM10 5H12V7H10V5ZM15 5H13V7H15V5ZM13 8H15V10H13V8ZM12 8H4V10H12V8Z"/>\n</svg>\n'},51008:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n\t<path d="M7.146 1.146A.5.5 0 006.793 1H1v5.793a.5.5 0 00.146.353l7.147 7.147a1 1 0 001.414 0l4.586-4.586a1 1 0 000-1.414L7.146 1.146zM4.93 6.4a1.48 1.48 0 11-.02-2.96 1.48 1.48 0 01.02 2.96z"/>\n</svg>\n'},46038:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M4 3h3.586l5 5L8 12.586l-5-5V4a1 1 0 011-1zm3.586-1a1 1 0 01.707.293L14 8l-6 6-5.707-5.707A1 1 0 012 7.586V4a2 2 0 012-2h3.586zM7 6a1 1 0 11-2 0 1 1 0 012 0zm1 0a2 2 0 11-4 0 2 2 0 014 0z"/>\n</svg>\n'},36186:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M5.5 14l2.5-3 2.5 3h-5zM10.5 1l-2.5 3-2.5-3h5zM2 5h12v1h-12zM2 7h12v1h-12zM2 9h12v1h-12z"/></svg>'},79026:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M5 3l2.5-3 2.5 3h-5zM10 12l-2.5 3-2.5-3h5zM2 4h11v1h-11zM2 7h11v1h-11zM2 10h11v1h-11z"/></svg>'},34167:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M8.01009 13.0077L4.9503 7.76232C3.62689 5.09401 5.39275 2.5 8.01009 2.5C10.6274 2.5 12.3933 5.09401 11.0699 7.76232L8.01009 13.0077ZM8.01009 1.5C4.63204 1.5 2.39952 4.89687 4.06288 8.22361L4.07009 8.23802L4.0782 8.25194L7.14631 13.5116C7.53219 14.1731 8.48799 14.1731 8.87387 13.5116L11.942 8.25194L11.9501 8.23802L11.9573 8.22361C13.6207 4.89686 11.3881 1.5 8.01009 1.5ZM9.0101 6C9.0101 6.55228 8.56239 7 8.0101 7C7.45782 7 7.0101 6.55228 7.0101 6C7.0101 5.44772 7.45782 5 8.0101 5C8.56239 5 9.0101 5.44772 9.0101 6ZM10.0101 6C10.0101 7.10457 9.11467 8 8.0101 8C6.90553 8 6.0101 7.10457 6.0101 6C6.0101 4.89543 6.90553 4 8.0101 4C9.11467 4 10.0101 4.89543 10.0101 6Z"/>\n</svg>\n'},62469:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12">\n\n  <circle cx="6" cy="6" />\n\n  <g class="window-close-glyph dpi-standard">\n    <path fill="#93120F" d="M8 7v-2h1v-2h-2v1h-2v-1h-2v2h1v2h-1v2h2v-1h2v1h2v-2h-1z" />\n    <path fill="#7E0200" d="M5 5h2v2h-2v-2zm-1-1h1v1h-1v-1zm-1-1h1v1h-1v-1zm5 0h1v1h-1v-1zm-1 1h1v1h-1v-1zm-3 3h1v1h-1v-1zm-1 1h1v1h-1v-1zm4-1h1v1h-1v-1zm1 1h1v1h-1v-1z" />\n  </g>\n  <g class="window-close-glyph dpi-high">\n    <polygon fill="#4c0102" points="9 3 8.29 3 6 5.29 3.71 3 3 3 3 3.71 5.29 6 3 8.29 3 9 3.71 9 6 6.71 8.29 9 9 9 9 8.29 6.71 6 9 3.71 9 3" />\n  </g>\n\n</svg>\n'},3141:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12">\n\n  <circle cx="6" cy="6" />\n\n  <g class="window-zoom-glyph dpi-standard">\n    <polygon points="9 5 7 5 7 3 5 3 5 5 3 5 3 7 5 7 5 9 7 9 7 7 9 7 9 5" fill="#0a630c"/>\n    <rect x="5" y="2" width="2" height="1" fill="#157e1b" class="semi"/>\n    <rect x="5" y="9" width="2" height="1" fill="#157e1b" class="semi"/>\n    <rect x="9" y="5" width="1" height="2" fill="#157e1b" class="semi"/>\n    <rect x="2" y="5" width="1" height="2" fill="#157e1b" class="semi"/>\n  </g>\n  <g class="window-zoom-glyph dpi-high">\n    <polygon points="9.5 5.5 6.5 5.5 6.5 2.5 5.5 2.5 5.5 5.5 2.5 5.5 2.5 6.5 5.5 6.5 5.5 9.5 6.5 9.5 6.5 6.5 9.5 6.5 9.5 5.5" fill="#0a630c"/>\n    <rect x="5.5" y="2" width="1" height="0.5" fill="#1b8e25" class="semi"/>\n    <rect x="5.5" y="9.5" width="1" height="0.5" fill="#1b8e25" class="semi"/>\n    <rect x="9.5" y="5.5" width="0.5" height="1" fill="#1b8e25" class="semi"/>\n    <rect x="2" y="5.5" width="0.5" height="1" fill="#1b8e25" class="semi"/>\n  </g>\n\n  <g class="window-fullscreen-glyph dpi-standard">\n    <polygon points="9 7.6 4.4 3 8.38 3.1 8.9 3.63" fill="#0a630c"/>\n    <polygon points="3 4.5 7.5 9 3.63 8.9 3.1 8.38" fill="#0a630c"/>\n  </g>\n  <g class="window-fullscreen-glyph dpi-high">\n    <polygon points="3 4.5 7.5 9 3.63 9 3 8.38 3 4.5" fill="#0a630c"/>\n    <polygon points="9 7.5 4.5 3 8.38 3 9 3.63 9 7.5" fill="#0a630c"/>\n  </g>\n\n  <g class="window-restore-glyph dpi-standard">\n    <polygon points="6 10 2 6 6 6 6 10" fill="#0a630c"/>\n    <polygon points="6 2 10 6 6 6 6 2" fill="#0a630c"/>\n  </g>\n  <g class="window-restore-glyph dpi-high">\n    <polygon points="6 1.5 10.5 6 6.50 6 6 5.50 6 1.5" fill="#0a630c"/>\n    <polygon points="6 10.5 1.5 6 5.50 6 6 6.50 6 10.5" fill="#0a630c"/>\n  </g>\n</svg>\n'},91313:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12">\n\n  <circle cx="6" cy="6" />\n\n  <g class="window-minimize-glyph dpi-standard">\n    <rect x="3" y="5" width="6" height="2" fill="#965612"/>\n    <rect x="9" y="5" width="1" height="2" fill="#ab6e1c" class="semi" />\n    <rect x="2" y="5" width="1" height="2" fill="#ab6e1c" class="semi"/>\n  </g>\n  <g class="window-minimize-glyph dpi-high">\n    <rect x="2.5" y="5.5" width="7" height="1" fill="#965612"/>\n    <rect x="2" y="5.5" width="0.5" height="1" fill="#ab6e1c" class="semi"/>\n    <rect x="9.5" y="5.5" width="0.5" height="1" fill="#ab6e1c" class="semi"/>\n  </g>\n\n</svg>\n'},77927:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M6.75 10.75C6.75 9.64543 7.64543 8.75 8.75 8.75H19.25C20.3546 8.75 21.25 9.64543 21.25 10.75V17.25C21.25 18.3546 20.3546 19.25 19.25 19.25H8.75C7.64543 19.25 6.75 18.3546 6.75 17.25V10.75Z" stroke="currentColor" stroke-width="1.5"/>\n<path d="M8.5 9L14 14.5L19.5 9" stroke="currentColor" stroke-width="1.5"/>\n</svg>\n'},49244:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M3 3a2 2 0 0 0-2 2v1h14V5a2 2 0 0 0-2-2H3z"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M14 12.5V7H2v5.5A1.5 1.5 0 0 0 3.5 14h9a1.5 1.5 0 0 0 1.5-1.5zM6.5 8h3a1 1 0 1 1 0 2h-3a1 1 0 0 1 0-2z"/>\n</svg>\n'},83:e=>{e.exports='<svg class="onboarding-illustration" fill="none" xmlns="http://www.w3.org/2000/svg" width="242" height="195">\n  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M28.88 71.14a34.2 34.2 0 005.32 67.98h.07a58.8 58.8 0 00101.55 37.37 34.18 34.18 0 0053.24-8 31.7 31.7 0 0031.75-54.11 40.46 40.46 0 00-29.75-59.96A60.07 60.07 0 0078.44 36.44a42.13 42.13 0 00-49.55 34.69z" class="highlight-fill" fill-opacity=".25"/>\n  <path d="M130.5 111v50.5m0 0H173a8 8 0 008-8V145m-50.5 16.5H99" class="highlight-stroke" stroke-width="3"/>\n  <mask id="path-3-inside-1" class="bg-fill">\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M94.33 178.47h.03a16.64 16.64 0 005.76-32.25 16.64 16.64 0 00-27-11.5 16.65 16.65 0 00-32.42.06 15.83 15.83 0 00-17.06 10.4 16.64 16.64 0 000 33.3h70.69z"/>\n  </mask>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M94.33 178.47h.03a16.64 16.64 0 005.76-32.25 16.64 16.64 0 00-27-11.5 16.65 16.65 0 00-32.42.06 15.83 15.83 0 00-17.06 10.4 16.64 16.64 0 000 33.3h70.69z" class="bg-fill"/>\n  <path d="M94.33 178.47v-3 3zm5.79-32.25l-2.99.26.17 1.9 1.78.65 1.04-2.81zm-27-11.5l-2.92.68 1.09 4.64 3.71-2.98-1.88-2.34zm-32.42.06l-.72 2.91 2.96.75.69-2.98-2.93-.68zM23.95 145.2l-.06 3 2.47.05.52-2.41-2.93-.64zm-.28 33.28v-3 3zm70.66 3h.03v-6h-.02l-.01 6zm.03 0c10.85 0 19.64-8.8 19.64-19.64h-6c0 7.53-6.1 13.64-13.64 13.64v6zM114 161.83c0-8.46-5.35-15.66-12.84-18.43l-2.08 5.63a13.65 13.65 0 018.92 12.8h6zm-10.9-15.88a19.64 19.64 0 00-19.56-17.9v6c7.13 0 12.98 5.46 13.6 12.43l5.97-.53zm-19.56-17.9c-4.65 0-8.93 1.62-12.3 4.33l3.76 4.68c2.34-1.89 5.3-3.01 8.54-3.01v-6zm-7.5 5.98a19.65 19.65 0 00-19.12-15.13v6c6.45 0 11.86 4.48 13.28 10.5l5.84-1.37zM56.92 118.9c-9.33 0-17.13 6.5-19.14 15.21l5.85 1.35a13.65 13.65 0 0113.29-10.56v-6zm-15.49 12.97c-1.3-.32-2.66-.5-4.06-.5v6c.9 0 1.78.12 2.6.32l1.46-5.82zm-4.06-.5a16.73 16.73 0 00-16.35 13.2l5.86 1.26a10.73 10.73 0 0110.49-8.45v-6zM24 142.2h-.36v6h.25l.11-6zm-.36 0A19.64 19.64 0 004 161.83h6c0-7.53 6.1-13.64 13.64-13.64v-6zM4 161.83c0 10.85 8.8 19.64 19.64 19.64v-6c-7.53 0-13.64-6.1-13.64-13.64H4zm19.64 19.64h.03v-6h-.03v6zm70.7-6H23.66v6h70.66v-6z" class="highlight-fill" mask="url(#path-3-inside-1)"/>\n  <mask id="path-5-inside-2" class="bg-fill">\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M227.92 148.22a13.89 13.89 0 004.8-26.92 13.9 13.9 0 00-22.53-9.6 13.9 13.9 0 00-27.06.06 11.46 11.46 0 00-13.98 8.69h-.26a13.89 13.89 0 000 27.77h59.03z"/>\n  </mask>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M227.92 148.22a13.89 13.89 0 004.8-26.92 13.9 13.9 0 00-22.53-9.6 13.9 13.9 0 00-27.06.06 11.46 11.46 0 00-13.98 8.69h-.26a13.89 13.89 0 000 27.77h59.03z" class="bg-fill"/>\n  <path d="M227.92 148.22v-3h-3v3h3zm4.8-26.92l-2.98.26.16 1.9 1.79.66 1.04-2.82zm-22.53-9.6l-2.92.69 1.09 4.64 3.71-2.99-1.88-2.34zm-27.06.06l-.72 2.9 2.96.75.69-2.98-2.93-.67zm-13.98 8.69l-.06 3 2.47.04.52-2.41-2.93-.63zm-.26 27.77h3v-3h-3v3zm0 0h-3v3h3v-3zm59.03 0v3h3v-3h-3zm0 3v-6 6zm0 0c9.33 0 16.89-7.56 16.89-16.88h-6c0 6-4.88 10.88-10.9 10.88v6zm16.89-16.88a16.9 16.9 0 00-11.04-15.85l-2.08 5.63a10.9 10.9 0 017.12 10.22h6zm-9.1-13.3c-.75-8.63-8-15.4-16.82-15.4v6c5.69 0 10.36 4.36 10.85 9.92l5.98-.52zm-16.82-15.4c-4 0-7.69 1.4-10.58 3.72l3.76 4.68c1.87-1.5 4.24-2.4 6.82-2.4v-6zm-5.78 5.38A16.9 16.9 0 00196.67 98v6a10.9 10.9 0 0110.6 8.39l5.84-1.37zM196.67 98a16.9 16.9 0 00-16.46 13.08l5.85 1.35a10.9 10.9 0 0110.6-8.43v-6zm-12.81 10.85c-1.13-.28-2.3-.43-3.51-.43v6c.71 0 1.4.08 2.06.25l1.45-5.82zm-3.51-.43a14.46 14.46 0 00-14.14 11.4l5.87 1.26a8.46 8.46 0 018.27-6.66v-6zm-11.15 9.03h-.31v6h.2l.11-6zm-.31 0A16.89 16.89 0 00152 134.33h6c0-6.02 4.88-10.9 10.89-10.9v-6zM152 134.33c0 9.32 7.56 16.88 16.89 16.88v-6A10.89 10.89 0 01158 134.34h-6zm19.89 13.88h-6 6zm56.03-3h-59.03v6h59.03v-6zm-3 3h6-6z" class="highlight-fill" mask="url(#path-5-inside-2)"/>\n  <path d="M126 105h9v11.5a4.5 4.5 0 01-9 0V105z" class="bg-fill highlight-stroke" stroke-width="2"/>\n  <path d="M107.27 31.25l-9.02 9.02-5-5a4 4 0 010-5.66l3.36-3.37a4 4 0 015.66 0l5 5.01z" class="bg-fill highlight-stroke" stroke-width="2"/>\n  <path d="M156.41 31.25l9.03 9.02 5-5a4 4 0 000-5.66l-3.36-3.37a4 4 0 00-5.66 0l-5 5.01z" class="bg-fill highlight-stroke" stroke-width="2"/>\n  <circle cx="131.66" cy="64.66" r="45.72" class="bg-fill"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M99.03 32.63a45.72 45.72 0 00.6 64.66l32.03-32.03 32.03 32.03.3-.3a45.72 45.72 0 00.3-64.36l-32.63 32.63-32.63-32.63z" class="highlight-fill"/>\n  <circle cx="131.66" cy="64.66" r="45.72" class="highlight-stroke" stroke-width="4"/>\n  <path class="highlight-stroke" d="M99.26 97.21l64.95-64.95"/>\n  <path class="highlight-stroke" d="M164.06 97.2L99.11 32.27"/>\n  <circle cx="131.66" cy="64.66" r="17.52" class="highlight-stroke bg-fill" stroke-width="2"/>\n</svg>\n'},68914:e=>{e.exports='<svg class="onboarding-illustration" fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 144 81">\n  <rect x="46" y="35" width="46" height="46" rx="5" class="success"/>\n  <path d="M65 68.83L54.17 58 57 55.17l8 8 16-16L83.83 50 65 68.83z" fill="white"/>\n  <path opacity=".2" fill-rule="evenodd" clip-rule="evenodd" d="M68 17a1 1 0 01-1-1V1a1 1 0 112 0v15a1 1 0 01-1 1zm33.28 5.8a1 1 0 010-1.41l10.6-10.6a1 1 0 111.42 1.4L102.7 22.8a1 1 0 01-1.42 0zM36.73 21.4a1 1 0 01-1.42 1.41l-10.6-10.6a1 1 0 011.41-1.42l10.6 10.6zM114 57a1 1 0 011-1h28a1 1 0 010 2h-28a1 1 0 01-1-1zM1 56a1 1 0 100 2h28a1 1 0 100-2H1z" class="success"/>\n</svg>\n'},66665:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M11 17H13.5333L19.5226 10.9687L16.9913 8.56249L11 14.4667V17ZM21.8 8.66667C22.0667 8.4 22.0667 8 21.8 7.73333L20.2667 6.2C20 5.93333 19.6 5.93333 19.3333 6.2L18.1333 7.4L20.6667 9.93333L21.8 8.66667Z" fill="currentColor"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M15.5 7.5H10.2522C8.73345 7.5 7.50224 8.73122 7.50224 10.25V17.75C7.50224 19.2688 8.73345 20.5 10.2522 20.5H15.814C17.3328 20.5 18.564 19.2688 18.564 17.75V14.436L17.064 15.936V17.75C17.064 18.4404 16.5044 19 15.814 19H10.2522C9.56188 19 9.00224 18.4404 9.00224 17.75V10.25C9.00224 9.55964 9.56188 9 10.2522 9H14L15 8L15.5 7.5Z" fill="currentColor"/>\n</svg>\n'},89182:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72">\n  <path fill-opacity=".3" fill-rule="evenodd" d="M66.27 66.27C60.55 72 51.77 72 36 72c-15.78 0-24.55 0-30.27-5.73C0 60.54 0 51.77 0 36S0 11.46 5.73 5.73C11.45 0 20.23 0 36 0c15.78 0 24.55 0 30.27 5.73C72 11.46 72 20.23 72 36s0 24.54-5.73 30.27zm-7.6-13.73H13.19a3.8 3.8 0 01-3.79-3.79V27.57l26.22 14.9 26.84-15.41v21.7a3.8 3.8 0 01-3.8 3.78zM13.19 19.07a3.8 3.8 0 00-3.66 2.82L35.61 36.7l26.57-15.26a3.8 3.8 0 00-3.51-2.38H13.19z"/>\n  <path fill-rule="evenodd" d="M8.4 25.85l27.22 15.47 27.84-16v23.43a4.8 4.8 0 01-4.8 4.8H13.2a4.8 4.8 0 01-4.79-4.8v-22.9zm27.22 16.62L9.4 27.57v21.18a3.8 3.8 0 003.8 3.8h45.47a3.8 3.8 0 003.79-3.8v-21.7L35.62 42.48zM8.37 22.37l.2-.74a4.8 4.8 0 014.62-3.56h45.48a4.8 4.8 0 014.44 3l.33.81L35.6 37.87 8.37 22.37zM54.76 70.3c4.76-.7 8.15-2.07 10.8-4.73 2.66-2.65 4.04-6.04 4.73-10.8.7-4.8.71-10.84.71-18.76 0-7.92 0-13.97-.7-18.76-.7-4.76-2.08-8.15-4.73-10.8C62.9 3.78 59.52 2.4 54.76 1.7 49.96 1 43.92 1 36 1c-7.92 0-13.97 0-18.76.7-4.76.7-8.15 2.08-10.8 4.74-2.66 2.65-4.04 6.04-4.73 10.8C1 22.04 1 28.08 1 36c0 7.92 0 13.97.7 18.76.7 4.76 2.08 8.15 4.73 10.8 2.66 2.66 6.05 4.04 10.81 4.73 4.8.7 10.84.71 18.76.71 7.92 0 13.97 0 18.76-.7zM35.61 36.71L9.53 21.9a3.8 3.8 0 013.66-2.82h45.48a3.8 3.8 0 013.51 2.38L35.61 36.7zM36 72c15.78 0 24.55 0 30.27-5.73C72 60.54 72 51.77 72 36s0-24.54-5.73-30.27C60.55 0 51.77 0 36 0 20.22 0 11.45 0 5.73 5.73 0 11.46 0 20.23 0 36s0 24.54 5.73 30.27C11.45 72 20.23 72 36 72z"/>\n</svg>\n'},29622:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M2.35717 3.36075C2.13323 3.58693 2.00515 3.89221 2 4.21203V11.7872C1.99441 11.9479 2.02163 12.1081 2.07996 12.2577C2.13828 12.4073 2.22648 12.5431 2.33904 12.6568C2.4516 12.7705 2.58613 12.8596 2.73425 12.9185C2.88237 12.9774 3.04091 13.0049 3.2 12.9993H12.8C13.1167 12.9941 13.4189 12.8647 13.6428 12.6385C13.8668 12.4123 13.9948 12.1071 14 11.7872L14 6C14 5.5 13.5 5 13 5H8L6.8 3H3.2C2.88334 3.0052 2.5811 3.13457 2.35717 3.36075Z"/>\n</svg>\n'},52529:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.29386 0.706223C7.68439 0.315699 8.31561 0.315699 8.70614 0.706223L13.4161 5.4162C13.7912 5.79127 14 6.29808 14 6.82851V12.0001C14 12.2653 13.8946 12.5197 13.7071 12.7072C13.5196 12.8947 13.2652 13.0001 13 13.0001H3C2.73478 13.0001 2.48043 12.8947 2.29289 12.7072C2.10536 12.5197 2 12.2653 2 12.0001V6.82851C2 6.29808 2.20882 5.79127 2.58389 5.4162L7.29386 0.706223ZM4.56066 4.85364L8 1.4143L11.4393 4.85364L8.35355 7.93943C8.15829 8.13469 7.84171 8.13469 7.64645 7.93943L4.56066 4.85364ZM3.85355 5.56075L3.291 6.1233C3.10447 6.30983 3 6.56187 3 6.82851L3 12.0001H13V6.82851C13 6.56187 12.8955 6.30983 12.709 6.12331L12.1464 5.56075L9.06066 8.64653C8.47487 9.23232 7.52513 9.23232 6.93934 8.64653L3.85355 5.56075Z"/>\n</svg>\n'},90205:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M4 1C2.89543 1 2 1.89543 2 3V12C2 13.1046 2.89543 14 4 14H13C14.1046 14 15 13.1046 15 12V3C15 1.89543 14.1046 1 13 1H4ZM11.2774 8.9856C11.6015 9.7681 11.7968 10.5966 11.857 11.439C11.8791 11.7483 12.1284 12 12.4385 12C12.7486 12 13.0018 11.7484 12.9825 11.4389C12.9733 11.2922 12.9606 11.1459 12.9443 11C12.8505 10.1614 12.6391 9.33849 12.3149 8.55585C11.8626 7.46392 11.1997 6.47177 10.364 5.63604C9.52823 4.80031 8.53608 4.13738 7.44415 3.68508C6.66151 3.3609 5.83859 3.14949 5 3.05573C4.85414 3.03942 4.70781 3.02667 4.56114 3.01751C4.25163 2.99817 4 3.25139 4 3.5615C4 3.87161 4.25171 4.12092 4.56103 4.14301C5.40342 4.20316 6.2319 4.39848 7.0144 4.7226C7.97008 5.11846 8.83843 5.69867 9.56988 6.43012C10.3013 7.16157 10.8815 8.02992 11.2774 8.9856ZM9.43123 12C9.11711 12 8.86589 11.7445 8.82923 11.4325C8.7771 10.9889 8.66397 10.5536 8.49233 10.1392C8.24797 9.54928 7.8898 9.01324 7.43828 8.56172C6.98676 8.1102 6.45073 7.75203 5.86078 7.50767C5.44641 7.33603 5.01114 7.2229 4.56748 7.17077C4.2555 7.13411 4 6.88289 4 6.56877C4 6.25465 4.25521 5.9972 4.56792 6.02694C4.71267 6.0407 4.85679 6.05971 5 6.08392C5.44363 6.15891 5.87847 6.28373 6.2961 6.45672C7.02405 6.75825 7.68549 7.20021 8.24264 7.75736C8.79979 8.31451 9.24175 8.97595 9.54328 9.7039C9.71627 10.1215 9.84109 10.5564 9.91608 11C9.94029 11.1432 9.9593 11.2873 9.97306 11.4321C10.0028 11.7448 9.74535 12 9.43123 12ZM5.25 12C5.94036 12 6.5 11.4404 6.5 10.75C6.5 10.0596 5.94036 9.5 5.25 9.5C4.55964 9.5 4 10.0596 4 10.75C4 11.4404 4.55964 12 5.25 12Z"/>\n</svg>\n'},53165:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M2.35715 3.36075C2.13321 3.58693 2.00513 3.89221 1.99998 4.21203V11.7872C1.9944 11.9479 2.02161 12.1081 2.07994 12.2577C2.13827 12.4073 2.22646 12.5431 2.33902 12.6568C2.45159 12.7705 2.58612 12.8596 2.73423 12.9185C2.88235 12.9774 3.04089 13.0049 3.19998 12.9993H12.8C13.1166 12.9941 13.4189 12.8647 13.6428 12.6385C13.8668 12.4123 13.9948 12.1071 14 11.7872L14 6C14 5.5 13.5 5 13 5H7.99998L6.79998 3H3.19998C2.88333 3.0052 2.58109 3.13457 2.35715 3.36075ZM2.99938 11.822L2.99998 11.8046V4.22318C3.00221 4.16171 3.02739 4.10511 3.06778 4.06432C3.10771 4.02398 3.15927 4.00208 3.2116 4H6.24588L7.49998 6H12.8C12.9104 6 13 6.08796 13 6.19842C13 7.13107 13 11.0636 13 11.7761C12.9978 11.8376 12.9726 11.8942 12.9322 11.935C12.8922 11.9753 12.8407 11.9972 12.7884 11.9993H3.18225L3.16453 11.9999C3.14404 12.0006 3.12342 11.9971 3.10382 11.9893C3.08419 11.9815 3.06565 11.9694 3.04965 11.9533C3.03362 11.9371 3.02049 11.9171 3.01163 11.8944C3.00276 11.8717 2.99851 11.847 2.99938 11.822Z"/>\n</svg>\n'},17737:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M10 2.5C10 2.77614 10.2239 3 10.5 3H12C12.5523 3 13 3.44772 13 4H3C3 3.44772 3.44772 3 4 3H5.5C5.77614 3 6 2.77614 6 2.5C6 2.22386 6.22386 2 6.5 2H9.5C9.77614 2 10 2.22386 10 2.5Z"/>\n  <path d="M4 5H12V12.5C12 13.3284 11.3284 14 10.5 14H5.5C4.67157 14 4 13.3284 4 12.5V5Z"/>\n</svg>\n'},8431:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M10.5 3a.5.5 0 0 1-.5-.5.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5.5.5 0 0 1-.5.5H4a1 1 0 0 0-1 1h10a1 1 0 0 0-1-1h-1.5ZM4 5v7.5A1.5 1.5 0 0 0 5.5 14h5a1.5 1.5 0 0 0 1.5-1.5V5h-1v7.5a.5.5 0 0 1-.5.5h-5a.5.5 0 0 1-.5-.5V5H4Z"/>\n  <path opacity=".3" d="M6 5v7h4V5H6Z"/>\n</svg>\n'},76047:e=>{e.exports='<svg width="26" height="26" xmlns="http://www.w3.org/2000/svg">\n  <path d="M4.5 6a.5.5 0 00-.5.5v1a.5.5 0 00.5.5h17a.5.5 0 00.5-.5v-1a.5.5 0 00-.5-.5h-17zm2 4a.5.5 0 00-.5.5v1a.5.5 0 00.5.5h13a.5.5 0 00.5-.5v-1a.5.5 0 00-.5-.5h-13zM8 14.5a.5.5 0 01.5-.5h9a.5.5 0 01.5.5v1a.5.5 0 01-.5.5h-9a.5.5 0 01-.5-.5v-1zm2.5 3.5a.5.5 0 00-.5.5v1a.5.5 0 00.5.5h5a.5.5 0 00.5-.5v-1a.5.5 0 00-.5-.5h-5z"/>\n</svg>'},94543:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M1 3.5a.5.5 0 01.5-.5h13a.5.5 0 01.5.5v1a.5.5 0 01-.5.5h-13a.5.5 0 01-.5-.5v-1zm2 4a.5.5 0 01.5-.5h9a.5.5 0 01.5.5v1a.5.5 0 01-.5.5h-9a.5.5 0 01-.5-.5v-1zM5.5 11a.5.5 0 00-.5.5v1a.5.5 0 00.5.5h5a.5.5 0 00.5-.5v-1a.5.5 0 00-.5-.5h-5z"/>\n</svg>'},89316:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M3 5.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm1.5 3A.5.5 0 0 1 5 8h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5Zm2 2.5a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1h-3Z"/>\n</svg>\n'},71387:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M0 3.5C0 3.22386 0.223858 3 0.5 3H8.5C8.77614 3 9 3.22386 9 3.5C9 3.77614 8.77614 4 8.5 4H0.5C0.223858 4 0 3.77614 0 3.5ZM0 5.5C0 5.22386 0.223858 5 0.5 5H2.5C2.77614 5 3 5.22386 3 5.5C3 5.77614 2.77614 6 2.5 6H0.5C0.223858 6 0 5.77614 0 5.5ZM3 7.5C3 7.22386 2.77614 7 2.5 7H0.5C0.223858 7 0 7.22386 0 7.5C0 7.77614 0.223858 8 0.5 8H2.5C2.77614 8 3 7.77614 3 7.5Z"/>\n  <path fill-rule="evenodd" d="M4.45459 5.16169L9.64645 10.3536L10 10.7071L10.3536 10.3536L15.5454 5.16169C15.8191 5.34012 16 5.64893 16 6V12C16 12.5523 15.5523 13 15 13H5C4.44772 13 4 12.5523 4 12V6C4 5.64893 4.18091 5.34012 4.45459 5.16169ZM5.70711 5H14.2929L10 9.29289L5.70711 5Z"/>\n</svg>\n'},25259:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path d="m3 7h9v1h-9zm0 2h4v1h-4zm0 2h4v1h-4z"/>\n  <path d="m8 11c0-1.10457.89543-2 2-2h12c1.1046 0 2 .89543 2 2v6c0 1.1046-.8954 2-2 2h-12c-1.10457 0-2-.8954-2-2zm11.2929 0h-6.5858l3.2929 3.2929zm-8 0h-1.2929v6h12v-6h-1.2929l-4.7071 4.7071z" fill-rule="evenodd"/>\n  </svg>'},71311:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="m9 3.5c0-.27614-.22386-.5-.5-.5h-8c-.276142 0-.5.22386-.5.5s.223858.5.5.5h8c.27614 0 .5-.22386.5-.5z"/><path d="m5 5c-.55228 0-1 .44772-1 1v6c0 .5523.44771 1 1 1h10c.5523 0 1-.4477 1-1v-6c0-.55228-.4477-1-1-1zm5 4.29289-3.29289-3.29289h6.58579zm-5-3.29289h.29289l4.70711 4.7071 4.7071-4.7071h.2929v6h-10z"/><path d="m0 5.5c0-.27614.223858-.5.5-.5h2c.27614 0 .5.22386.5.5s-.22386.5-.5.5h-2c-.276142 0-.5-.22386-.5-.5z"/><path d="m3 7.5c0-.27614-.22386-.5-.5-.5h-2c-.276142 0-.5.22386-.5.5s.223858.5.5.5h2c.27614 0 .5-.22386.5-.5z"/></svg>'},54255:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M1.64645 2.64645C1.84171 2.45118 2.15829 2.45118 2.35355 2.64645L7.64645 7.93934C7.84171 8.1346 8.15829 8.1346 8.35355 7.93934L13.6464 2.64645C13.8417 2.45118 14.1583 2.45118 14.3536 2.64645C14.5488 2.84171 14.5488 3.15829 14.3536 3.35355L9.06066 8.64645C8.47487 9.23223 7.52513 9.23223 6.93934 8.64645L1.64645 3.35355C1.45118 3.15829 1.45118 2.84171 1.64645 2.64645Z"/>\n  <path fill-rule="evenodd" d="M14 4H2V11H14V4ZM2 2C0.895431 2 0 2.89543 0 4V11C0 12.1046 0.895431 13 2 13H14C15.1046 13 16 12.1046 16 11V4C16 2.89543 15.1046 2 14 2H2Z"/>\n</svg>\n'},24073:e=>{e.exports='<svg width="46" height="48" xmlns="http://www.w3.org/2000/svg">\n  <g clip-path="url(#clip0)">\n    <path d="M16.293 11.293A1 1 0 0017 13h12a1 1 0 000-2H17a1 1 0 00-.707.293zM16.293 19.293A1 1 0 0117 19h12a1 1 0 010 2H17a1 1 0 01-.707-1.707z"/>\n    <path fill-rule="evenodd" d="M8.293 1.293A1 1 0 008 2v13.69L.419 21.185a1 1 0 00-.419.841V43a4 4 0 004 4h38a4 4 0 004-4V22.026a1 1 0 00-.417-.839L38 15.689V2a1 1 0 00-1-1H9a1 1 0 00-.707.293zM36 16.174v9.506l-12.972 6.938-.027.016L10 25.68v-9.45V3h26v13.174zM8 18.16l-5.12 3.712L8 24.611v-6.45zm30 6.45v-6.45l5.12 3.712L38 24.61zM2 43V23.67L41.879 45H4a2 2 0 01-2-2zm42 0c0 .27-.055.536-.159.78L25.12 33.769 44 23.669V43z"/>\n  </g>\n  <defs>\n    <clipPath id="clip0">\n      <path fill="#fff" d="M0 0h46v48H0z"/>\n    </clipPath>\n  </defs>\n</svg>\n'},95174:e=>{e.exports='<svg class="onboarding-illustration" width="209" height="187" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <rect x=".5" y=".5" width="208" height="27" rx="2.5" class="form-field"/>\n  <path d="M128 9.5a.5.5 0 00-.5-.5h-8a.5.5 0 000 1h8a.5.5 0 00.5-.5z" class="color-fg"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M124 11a1 1 0 00-1 1v6a1 1 0 001 1h10a1 1 0 001-1v-6a1 1 0 00-1-1h-10zm5 4.293L125.707 12h6.586L129 15.293zM124 12h.293L129 16.707 133.707 12H134v6h-10v-6z" class="color-fg"/>\n  <path d="M119 11.5a.5.5 0 01.5-.5h2a.5.5 0 010 1h-2a.5.5 0 01-.5-.5zM122 13.5a.5.5 0 00-.5-.5h-2a.5.5 0 000 1h2a.5.5 0 00.5-.5z" class="color-fg"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M166 8h10v1h-10V8zm-1 0a1 1 0 011-1h10a1 1 0 011 1v2h-1.085l-.735 7.605c-.077.795-.661 1.395-1.356 1.395h-5.648c-.696 0-1.28-.601-1.356-1.396L166.085 10H165V8zm2.001 2l.723 7.488c.025.265.22.465.452.465h5.648c.233 0 .427-.2.452-.464l.723-7.489h-7.998zm6.491 1.859l-.607-.598-1.818 1.794-1.818-1.794-.606.598 1.818 1.795-1.818 1.795.606.598 1.818-1.795 1.818 1.795.607-.598-1.819-1.795 1.819-1.795z" class="color-fg"/>\n  <path d="M195.5 8a.5.5 0 01-.5-.5.5.5 0 00-.5-.5h-3a.5.5 0 00-.5.5.5.5 0 01-.5.5H189a1 1 0 00-1 1h10a1 1 0 00-1-1h-1.5zM189 10v7.5a1.5 1.5 0 001.5 1.5h5a1.5 1.5 0 001.5-1.5V10h-1v7.5a.5.5 0 01-.5.5h-5a.5.5 0 01-.5-.5V10h-1z" class="color-fg"/>\n  <path opacity=".3" d="M191 10v7h4v-7h-4z" class="color-fg"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M99.357 9.36a1.239 1.239 0 00-.357.852v7.575a1.185 1.185 0 00.339.87 1.158 1.158 0 00.861.342h9.6c.316-.005.619-.134.843-.36.224-.227.352-.532.357-.852V12c0-.5-.5-1-1-1h-5l-1.2-2h-3.6c-.317.005-.62.135-.843.36zm.642 8.462v-7.599a.236.236 0 01.069-.159.211.211 0 01.143-.064h3.035l1.254 2h5.3c.11 0 .2.088.2.198v5.578a.24.24 0 01-.068.159.216.216 0 01-.144.064h-9.624a.16.16 0 01-.153-.105.2.2 0 01-.012-.072z" class="highlight-fill"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M100 17.822v-7.599a.236.236 0 01.068-.159.211.211 0 01.143-.064h3.035l1.254 2h5.3c.11 0 .2.088.2.198v5.578a.24.24 0 01-.068.159.216.216 0 01-.144.064h-9.624a.16.16 0 01-.153-.105.2.2 0 01-.012-.072z" class="highlight-fill"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M142 9.154c0-1.19.964-2.154 2.154-2.154h9.692c1.19 0 2.154.964 2.154 2.154v9.692c0 1.19-.964 2.154-2.154 2.154h-9.692A2.154 2.154 0 01142 18.846V9.154zm2.154-1.077h9.692c.595 0 1.077.482 1.077 1.077v9.692c0 .595-.482 1.077-1.077 1.077h-9.692a1.078 1.078 0 01-1.077-1.077V9.154c0-.595.482-1.077 1.077-1.077z" class="color-fg"/>\n  <path d="M153.5 18.5v-1a8.001 8.001 0 00-8-8h-1v1.4h1a6.602 6.602 0 016.6 6.6v1h1.4zM147.5 17a1.501 1.501 0 11-3.002 0 1.501 1.501 0 013.002 0z" class="color-fg"/>\n  <path d="M150.5 17.5v1h-1.4v-1a3.6 3.6 0 00-3.6-3.6h-1v-1.4h1a4.994 4.994 0 013.536 1.464A4.998 4.998 0 01150.5 17.5z" class="color-fg"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M77 13.829V18a1 1 0 001 1h10a1 1 0 001-1V13.83c0-.53-.209-1.038-.584-1.413l-1.063-1.062-3.292 3.293a1.5 1.5 0 01-2.122 0l-3.292-3.293-1.063 1.062A1.994 1.994 0 0077 13.828zm2.354-3.183l3.293 3.293a.5.5 0 00.706 0l3.293-3.293-2.94-2.94a.998.998 0 00-1.412 0l-2.94 2.94z" class="highlight-fill"/>\n  <rect opacity=".6" x="8" y="43" width="187" height="12" rx="2" class="color-fg-faded"/>\n  <rect opacity=".3" x="8" y="58" width="166" height="12" rx="2" class="color-fg-faded"/>\n  <rect opacity=".6" x="8" y="82" width="187" height="12" rx="2" class="color-fg-faded"/>\n  <rect opacity=".3" x="8" y="97" width="166" height="12" rx="2" class="color-fg-faded"/>\n  <rect opacity=".6" x="8" y="121" width="187" height="12" rx="2" class="color-fg-faded"/>\n  <rect opacity=".3" x="8" y="136" width="166" height="12" rx="2" class="color-fg-faded"/>\n  <rect opacity=".6" x="8" y="160" width="187" height="12" rx="2" class="color-fg-faded"/>\n  <rect opacity=".3" x="8" y="175" width="166" height="12" rx="2" class="color-fg-faded"/>\n</svg>\n'},52725:e=>{e.exports='<svg class="onboarding-illustration" width="216" height="200" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <g filter="url(#filter0_d)">\n    <path d="M7 9a5 5 0 015-5h192a5 5 0 015 5v156.03a5 5 0 01-4.55 4.98l-192 17.5A5 5 0 017 182.51V9z" class="bg-fill"/>\n  </g>\n  <rect fill-opacity=".2" x="46" y="24" width="77" height="12" rx="2" class="color-fg-faded"/>\n  <rect fill-opacity=".2" x="46" y="48" width="77" height="12" rx="2" class="color-fg-faded"/>\n  <rect fill-opacity=".2" x="46" y="72" width="60" height="12" rx="2" class="color-fg-faded"/>\n  <rect fill-opacity=".2" x="46" y="96" width="77" height="12" rx="2" class="color-fg-faded"/>\n  <rect fill-opacity=".2" x="46" y="120" width="77" height="12" rx="2" class="color-fg-faded"/>\n  <rect fill-opacity=".2" x="46" y="144" width="60" height="12" rx="2" class="color-fg-faded"/>\n  <path d="M33 26a2 2 0 100-4 2 2 0 000 4z" class="color-fg"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M33 32v-5c-.35 0-.687-.06-1-.17V32H22v-6h.293L27 30.707l4.262-4.262A3.01 3.01 0 0130.17 25H22a1 1 0 00-1 1v6a1 1 0 001 1h10a1 1 0 001-1zm-6-2.707L30.293 26h-6.586L27 29.293zM21.357 121.361a1.237 1.237 0 00-.357.851v7.575a1.187 1.187 0 00.339.87 1.156 1.156 0 00.86.342h9.6c.317-.005.62-.134.844-.36.224-.227.352-.532.357-.852V124c0-.5-.5-1-1-1h-5l-1.2-2h-3.6a1.214 1.214 0 00-.843.361zm.642 8.461v-7.599a.24.24 0 01.069-.159.215.215 0 01.143-.064h3.035l1.254 2h5.3c.11 0 .2.088.2.198v5.578a.238.238 0 01-.068.159.215.215 0 01-.144.064h-9.606l-.018.001a.142.142 0 01-.06-.011.169.169 0 01-.092-.095.179.179 0 01-.013-.072z" class="color-fg"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M22 129.822v-7.599a.24.24 0 01.067-.159.215.215 0 01.144-.064h3.035l1.254 2h5.3c.11 0 .2.088.2.198v5.578a.238.238 0 01-.068.159.215.215 0 01-.144.064h-9.606l-.018.001a.142.142 0 01-.06-.011.169.169 0 01-.092-.095.179.179 0 01-.013-.072z" class="color-fg" fill-opacity=".1"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M32.414 94.5a1.5 1.5 0 00-1.06.44L30.292 96 33 98.707l1-1a1.707 1.707 0 000-2.414l-.354-.354a1.5 1.5 0 00-1.06-.439h-.172zm-.354 1.146a.5.5 0 01.354-.146h.172a.5.5 0 01.353.146l.354.354a.707.707 0 010 1l-.293.293L31.707 96l.353-.354zM29.5 96.793l-5.5 5.5V105h2.707l5.5-5.5-2.707-2.707zM25 104v-1.293l4.5-4.5 1.293 1.293-4.5 4.5H25z" class="color-fg"/>\n  <path d="M23 97h4l-1 1h-3c-.5 0-1 .5-1 1v7c0 .5.5 1 1 1h5a1 1 0 001-1v-1l1-1v2a2 2 0 01-2 2h-5a2 2 0 01-2-2v-7c0-1 .895-2 2-2z" class="color-fg"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M19 72h14.546c.36 0 .715.09.992.31.293.23.462.578.462.99 0 .25-.099.47-.19.626a2.14 2.14 0 01-.318.41L24 85v-8l-5-5zm2.5.95L24 75.5l7-1.5-6 3.5.003 5 8.864-8.849c.062-.063.129-.144.176-.225.045-.076.053-.118.054-.125 0-.117-.038-.183-.1-.232-.078-.06-.223-.12-.45-.12H21.5zM26.294 47.706a.998.998 0 011.412 0l4.71 4.71c.375.375.584.882.584 1.413V59a1 1 0 01-1 1H22a1 1 0 01-1-1v-5.172c0-.53.209-1.037.584-1.412l4.71-4.71zm-2.733 4.148L27 48.414l3.44 3.44-3.086 3.085a.5.5 0 01-.708 0l-3.085-3.085zm-.707.707l-.563.562a.994.994 0 00-.291.706V59h10v-5.172a.994.994 0 00-.291-.705l-.563-.562-3.085 3.086a1.5 1.5 0 01-2.122 0l-3.085-3.086z" class="color-fg"/>\n  <path d="M159 38h-19a3 3 0 01-3-3V25a3 3 0 013-3h19v16z" class="color-fg"/>\n  <path fill-opacity="0.2" d="M159 22h19a3 3 0 013 3v10a3 3 0 01-3 3h-19V22z" class="color-fg-faded"/>\n  <path d="M145.181 34h1.011v-8.103h-1.005l-2.156 1.55v1.067l2.061-1.494h.089V34zm3.381-5.823v.006h.977v-.006c0-.955.64-1.59 1.589-1.59.893 0 1.583.624 1.583 1.433 0 .651-.252 1.09-1.297 2.223l-2.802 3.06V34h5.245v-.91h-3.796V33l1.949-2.094c1.33-1.426 1.712-2.083 1.712-2.925 0-1.286-1.112-2.275-2.566-2.275-1.505 0-2.594 1.034-2.594 2.471z" class="bg-fill"/>\n  <path d="M166.485 34h1.011v-8.103h-1.006l-2.156 1.55v1.067l2.061-1.494h.09V34zm6.199.19c1.718 0 2.92-.97 2.92-2.357 0-1.056-.668-1.876-1.685-2.067v-.09c.837-.23 1.354-.92 1.354-1.808 0-1.263-1.073-2.162-2.589-2.162s-2.589.899-2.589 2.162c0 .882.528 1.584 1.354 1.808v.09c-1.017.191-1.685 1.01-1.685 2.067 0 1.386 1.202 2.358 2.92 2.358zm0-.864c-1.123 0-1.898-.64-1.898-1.567 0-.926.775-1.566 1.898-1.566 1.123 0 1.898.64 1.898 1.566 0 .927-.775 1.567-1.898 1.567zm0-3.987c-.955 0-1.595-.55-1.595-1.375 0-.837.635-1.393 1.595-1.393s1.595.556 1.595 1.393c0 .825-.64 1.375-1.595 1.375z" class="color-fg"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M22 144h10v1H22v-1zm-1 0a1 1 0 011-1h10a1 1 0 011 1v2h-1.085l-.735 7.605c-.077.795-.661 1.395-1.356 1.395h-5.648c-.695 0-1.28-.601-1.356-1.396L22.085 146H21v-2zm2 2l.724 7.488c.025.265.22.466.452.466h5.648c.233 0 .427-.201.452-.465L31 146h-7.998zm6.491 1.859l-.606-.598-1.818 1.794-1.818-1.794-.606.598 1.818 1.795-1.818 1.795.606.598 1.818-1.795 1.818 1.795.606-.598-1.818-1.795 1.819-1.795z" class="color-fg"/>\n  <defs>\n    <filter id="filter0_d" x="0" y="0" width="216" height="197.52" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">\n      <feFlood flood-opacity="0" result="BackgroundImageFix"/>\n      <feColorMatrix in="SourceAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/>\n      <feOffset dy="3"/>\n      <feGaussianBlur stdDeviation="3.5"/>\n      <feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.13 0"/>\n      <feBlend in2="BackgroundImageFix" result="effect1_dropShadow"/>\n      <feBlend in="SourceGraphic" in2="effect1_dropShadow" result="shape"/>\n    </filter>\n  </defs>\n</svg>\n'},24566:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M2 7.82852V12.0001C2 12.2653 2.10536 12.5197 2.29289 12.7072C2.48043 12.8947 2.73478 13.0001 3 13.0001H13C13.2652 13.0001 13.5196 12.8947 13.7071 12.7072C13.8946 12.5197 14 12.2653 14 12.0001V7.82852C14 7.29808 13.7912 6.79127 13.4161 6.4162L12.3535 5.3536L9.06066 8.64645C8.47487 9.23223 7.52513 9.23223 6.93934 8.64645L3.64649 5.3536L2.58389 6.4162C2.20882 6.79127 2 7.29808 2 7.82852ZM4.3536 4.64649L7.64645 7.93934C7.84171 8.1346 8.15829 8.1346 8.35355 7.93934L11.6464 4.64649L8.70614 1.70622C8.31561 1.3157 7.68439 1.3157 7.29386 1.70622L4.3536 4.64649Z"/>\n</svg>\n'},77298:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none">\n  <path fill="currentColor" fill-rule="evenodd" d="M2.75 1.5a.5.5 0 0 1 .5.5v4.667a.5.5 0 0 1-1 0V2a.5.5 0 0 1 .5-.5Zm.5 8.583h1.5a.75.75 0 1 0 0-1.5h-4a.75.75 0 0 0 0 1.5h1.5V14a.5.5 0 0 0 1 0v-3.917ZM8.5 8a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V8ZM8 1.5a.5.5 0 0 1 .5.5v2.583h1.583a.75.75 0 0 1 0 1.5h-4a.75.75 0 1 1 0-1.5H7.5V2a.5.5 0 0 1 .5-.5Zm4.5 10H11a.75.75 0 0 1 0-1.5h4a.75.75 0 0 1 0 1.5h-1.5V14a.5.5 0 1 1-1 0v-2.5Zm.5-10a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V2a.5.5 0 0 1 .5-.5Z" clip-rule="evenodd"/>\n</svg>'},40695:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="138" height="22">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M15.706 4.293a.998.998 0 0 0-1.412 0l-4.71 4.71A1.994 1.994 0 0 0 9 10.415v5.172a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1v-5.172c0-.53-.209-1.037-.584-1.412l-4.71-4.71ZM15 5l-3.44 3.44 3.086 3.085a.5.5 0 0 0 .707 0L18.44 8.44 15 5.001ZM10.291 9.71l.563-.563 3.085 3.086a1.5 1.5 0 0 0 2.122 0l3.085-3.086.563.563a.994.994 0 0 1 .291.705v5.172H10v-5.172c0-.266.104-.518.291-.705ZM31 7.799c.005-.32.133-.625.357-.852.224-.226.526-.355.843-.36h3.6l1.2 2h5c.5 0 1 .5 1 1v5.787c-.005.32-.133.625-.357.851a1.214 1.214 0 0 1-.843.36h-9.6a1.15 1.15 0 0 1-.861-.341 1.173 1.173 0 0 1-.339-.87V7.799Zm1 7.592v.018a.173.173 0 0 0 .05.131.15.15 0 0 0 .115.047l.017-.001h9.606a.214.214 0 0 0 .144-.064.238.238 0 0 0 .068-.16V9.786c0-.11-.09-.198-.2-.198h-5.3l-1.254-2h-3.034a.214.214 0 0 0-.144.064.238.238 0 0 0-.068.159v7.581Zm28-8.304a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0 0 1h8a.5.5 0 0 0 .5-.5Zm-4 1.5a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1v-6a1 1 0 0 0-1-1H56Zm5 4.293-3.293-3.293h6.586L61 12.88Zm-5-3.293h.293L61 14.294l4.707-4.707H66v6H56v-6Zm-4.5-1a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1h-2Zm2.5 2.5a.5.5 0 0 0-.5-.5h-2a.5.5 0 1 0 0 1h2a.5.5 0 0 0 .5-.5Zm22.154-6.5C74.964 4.587 74 5.55 74 6.74v9.692a2.154 2.154 0 0 0 2.154 2.154h9.692c1.19 0 2.154-.964 2.154-2.154V6.74c0-1.19-.964-2.154-2.154-2.154h-9.692Zm9.692 1.077h-9.692c-.595 0-1.077.482-1.077 1.077v9.692a1.077 1.077 0 0 0 1.077 1.077h9.692c.595 0 1.077-.482 1.077-1.077V6.74c0-.595-.482-1.077-1.077-1.077Zm-.346 9.423a8 8 0 0 0-8-8h-1v1.4h1a6.6 6.6 0 0 1 6.6 6.6v1h1.4v-1Zm-6-.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Zm3 1.5v-1a5 5 0 0 0-5-5h-1v1.4h1a3.6 3.6 0 0 1 3.6 3.6v1h1.4Zm15.5-9.5h10v1H98v-1Zm-1 0a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v2h-1.085l-.735 7.604c-.077.796-.661 1.396-1.356 1.396h-5.648c-.695 0-1.28-.602-1.356-1.397l-.735-7.603H97v-2Zm2 2 .724 7.488c.025.265.22.465.452.465h5.648c.233 0 .427-.2.452-.464l.723-7.49h-7.998Zm6.492 1.859-.607-.599-1.818 1.795-1.818-1.795-.606.599 1.818 1.794-1.818 1.796.606.598 1.818-1.796 1.818 1.796.607-.598-1.819-1.796 1.819-1.794ZM127 6.086a.5.5 0 0 0 .5.5h1.5a1 1 0 0 1 1 1h-10a1 1 0 0 1 1-1h1.5a.5.5 0 0 0 .5-.5.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5Zm-6 2.5v7.5a1.5 1.5 0 0 0 1.5 1.5h5a1.5 1.5 0 0 0 1.5-1.5v-7.5h-1v7.5a.5.5 0 0 1-.5.5h-5a.5.5 0 0 1-.5-.5v-7.5h-1Zm2 7v-7h4v7h-4Z" fill="var(--colorFgFaded)"/>\n</svg>'},4464:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="138" height="22">\n  <g fill="var(--colorFgFaded)">\n    <path d="M121 8a.5.5 0 0 0 0 1h8a.5.5 0 0 0 0-1h-8ZM121.5 11.5a.5.5 0 0 1 .5-.5h6a.5.5 0 0 1 0 1h-6a.5.5 0 0 1-.5-.5ZM123 14a.5.5 0 0 0 0 1h4a.5.5 0 0 0 0-1h-4Z"/>\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M133 11a8 8 0 1 1-16 0 8 8 0 0 1 16 0Zm-1 0a7 7 0 1 1-14 0 7 7 0 0 1 14 0Z"/>\n  </g>\n  <rect x="32" y="7" width="78" height="8" rx="2" fill="var(--colorBorderSubtle)"/>\n</svg>'},90658:e=>{e.exports='<svg width="16" height="16" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M2 3h12a1 1 0 01.96.721L8 7.433 1.04 3.721A1 1 0 012 3zM1 4.833V12a1 1 0 001 1h12a1 1 0 001-1V4.833L8.235 8.441 8 8.567l-.235-.126L1 4.833zM0 4a2 2 0 012-2h12a2 2 0 012 2v8a2 2 0 01-2 2H2a2 2 0 01-2-2V4z"/>\n</svg>\n'},52462:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path class="small-icon-fill" fill-rule="evenodd" clip-rule="evenodd" d="M2 2C0.895431 2 0 2.89543 0 4V12C0 13.1046 0.895431 14 2 14H14C15.1046 14 16 13.1046 16 12V4C16 2.89543 15.1046 2 14 2H2ZM1 3.70001V4.83335L8 8.56668L15 4.83335V3.70001L8 7.43335L1 3.70001Z"/>\n  <path class="small-icon-outline" fill-rule="evenodd" clip-rule="evenodd" d="M14 3H2C1.44772 3 1 3.44772 1 4V12C1 12.5523 1.44772 13 2 13H14C14.5523 13 15 12.5523 15 12V4C15 3.44772 14.5523 3 14 3ZM2 2C0.895431 2 0 2.89543 0 4V12C0 13.1046 0.895431 14 2 14H14C15.1046 14 16 13.1046 16 12V4C16 2.89543 15.1046 2 14 2H2Z"/>\n</svg>\n'},4856:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M3 2C2.44772 2 2 2.44772 2 3V5H3.08537L3.81966 12.6037C3.89644 13.3987 4.48049 14.0002 5.17571 14.0002H10.8242C11.5188 14.0002 12.1033 13.4005 12.1802 12.6048L12.9146 5H14V3C14 2.44772 13.5523 2 13 2H3ZM10.4916 6.85906L9.88546 6.26074L8.06682 8.05543L6.24891 6.26074L5.64282 6.85906L7.46082 8.65367L5.64282 10.449L6.24891 11.0473L8.06682 9.2519L9.88546 11.0473L10.4916 10.449L8.67282 8.65367L10.4916 6.85906Z"/>\n</svg>\n'},4266:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M5.7 14.9c.1.1.2.1.3.1.4 0 .8-.3 1-.7l4-12c.2-.6-.1-1.1-.6-1.3-.6-.2-1.1.1-1.3.6l-4 12c-.2.6.1 1.1.6 1.3Zm-2.4-3.2-3-3c-.4-.4-.4-1 0-1.4l3-3 1.4 1.4L2.4 8l2.3 2.3-1.4 1.4Zm9.4 0-1.4-1.4L13.6 8l-2.3-2.3 1.4-1.4 3 3c.4.4.4 1 0 1.4l-3 3Z"/>\n</svg>\n'},33329:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M8 8V12.5H8.75L10.25 10.25H12.5V17.75L10.25 19.25V20H17.75V19.25L15.5 17.75V10.25H17.75L19.25 12.5H20V8H8Z" fill="currentColor"/>\n</svg>\n'},68189:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M2 2v4.5h.75l1.5-2.25H6.5v7.5l-2.25 1.5V14h7.5v-.75l-2.25-1.5v-7.5h2.25l1.5 2.25H14V2H2Z"/>\n</svg>\n'},39564:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M6.24988 3.91421L2.06424 8.09985L6.24988 12.2855L7.31789 11.2175L4.93251 8.83211L4.2254 8.125L4.93251 7.41789L7.34303 5.00737L6.24988 3.91421ZM6.95698 12.9926L8.02499 11.9246L9.09307 12.9927L9.80018 13.6998L10.5073 12.9927L14.6679 8.83211L15.375 8.125L14.6679 7.41789L10.5073 3.25733L9.80018 2.55022L9.09307 3.25733L8.05014 4.30026L6.95698 3.20711L6.24988 2.5L5.54277 3.20711L1.35713 7.39275L0.650024 8.09985L1.35713 8.80696L5.54277 12.9926L6.24988 13.6997L6.95698 12.9926ZM9.80018 3.96444L8.75725 5.00737L11.1426 7.39275L11.8497 8.09985L11.1426 8.80696L8.7321 11.2175L9.80018 12.2856L13.9607 8.125L9.80018 3.96444Z"/>\n</svg>\n'},41868:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M4.5 11C5.38054 11 6.20201 10.7471 6.89574 10.31L10.2929 13.7071C10.6834 14.0976 11.3166 14.0976 11.7071 13.7071C12.0976 13.3166 12.0976 12.6834 11.7071 12.2929L8.30995 8.89574C8.74709 8.20201 9 7.38054 9 6.5C9 4.01472 6.98528 2 4.5 2C2.01472 2 0 4.01472 0 6.5C0 8.98528 2.01472 11 4.5 11ZM4.5 9C5.88071 9 7 7.88071 7 6.5C7 5.11929 5.88071 4 4.5 4C3.11929 4 2 5.11929 2 6.5C2 7.88071 3.11929 9 4.5 9Z"/>\n  <path d="M13 8L14.9757 6.02426C15.3537 5.64629 15.086 5 14.5515 5H11.4485C10.914 5 10.6463 5.64629 11.0243 6.02426L13 8Z"/>\n</svg>\n'},83766:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M16 8L10 14L16 20" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n</svg>\n'},29629:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M10.2071 4.20711C10.5977 3.81658 10.5977 3.18342 10.2071 2.79289C9.81661 2.40237 9.18345 2.40237 8.79292 2.79289L3.58582 8L8.79292 13.2071C9.18345 13.5976 9.81661 13.5976 10.2071 13.2071C10.5977 12.8166 10.5977 12.1834 10.2071 11.7929L6.41424 8L10.2071 4.20711Z"/>\n</svg>\n'},46685:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M10.354 13.354a.5.5 0 01-.708 0l-5-5L4.293 8l.353-.354 5-5a.5.5 0 01.708.708L5.707 8l4.647 4.646a.5.5 0 010 .708z"/>\n</svg>\n'},41381:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M14.5 10.5L18 14L14.5 17.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n  <path d="M9.5 10.5L13 14L9.5 17.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n</svg>\n'},4819:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M10 13C9.44772 13 9 12.5523 9 12L9 9L5.70711 12.2929C5.07714 12.9229 4 12.4767 4 11.5858L4 4.41421C4 3.52331 5.07714 3.07714 5.70711 3.70711L9 7L9 4C9 3.44771 9.44772 3 10 3C10.5523 3 11 3.44771 11 4L11 12C11 12.5523 10.5523 13 10 13Z"/>\n</svg>\n'},27308:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M10.5 4.2a.5.5 0 00-1 0v3.3L5.854 3.854A.5.5 0 005 4.207v7.586a.5.5 0 00.854.354L9.5 8.5v3.3a.5.5 0 101 0V4.2zM8.586 8L6 10.586V5.414L8.586 8z"/>\n</svg>\n'},73175:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M12 8L18 14L12 20" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n</svg>\n'},89654:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M5.79286 11.7929C5.40234 12.1834 5.40234 12.8166 5.79286 13.2071C6.18339 13.5976 6.81655 13.5976 7.20708 13.2071L12.4142 8L7.20708 2.79289C6.81655 2.40237 6.18339 2.40237 5.79287 2.79289C5.40234 3.18342 5.40234 3.81658 5.79287 4.20711L9.58576 8L5.79286 11.7929Z"/>\n</svg>\n'},6198:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M5.646 2.646a.5.5 0 01.708 0l5 5 .353.354-.353.354-5 5a.5.5 0 01-.708-.708L10.293 8 5.646 3.354a.5.5 0 010-.708z"/>\n</svg>\n'},61977:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M7.75 14V19.7617C7.75 20.0378 7.97386 20.2617 8.25 20.2617H11.5C11.7761 20.2617 12 20.0378 12 19.7617V17.0429C12 16.5429 12.8 15.5429 14 15.5429C15.2 15.5429 16 16.5429 16 17.0429V19.7617C16 20.0378 16.2239 20.2617 16.5 20.2617H19.75C20.0261 20.2617 20.25 20.0378 20.25 19.7617V14C20.25 13.8674 20.1973 13.7402 20.1036 13.6465L14.3536 7.89646C14.1583 7.7012 13.8417 7.7012 13.6464 7.89646L7.89645 13.6465C7.80268 13.7402 7.75 13.8674 7.75 14Z" stroke="currentColor" stroke-width="1.5"/>\n</svg>\n'},10737:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n\t<path fill-rule="evenodd" d="M8 10.5C8.85199 10.5 8.97809 11.1049 8.99676 11.6963C9 11.799 9 11.9013 9 12V14C9 14.5523 9.44772 15 10 15H14C14.5523 15 15 14.5523 15 14V8.41421C15 8.149 14.8946 7.89464 14.7071 7.70711L8.70711 1.70711C8.31658 1.31658 7.68342 1.31658 7.29289 1.70711L1.29289 7.70711C1.10536 7.89464 1 8.149 1 8.41421V14C1 14.5523 1.44772 15 2 15H6C6.55228 15 7 14.5523 7 14V12C7 11.9013 7 11.799 7.00324 11.6963C7.02191 11.1049 7.14801 10.5 8 10.5ZM13 13V8.82843L8 3.82843L3 8.82843V13H5V12L4.99965 11.9448C4.99723 11.6655 4.9906 10.9031 5.28671 10.2122C5.47659 9.76911 5.8086 9.29298 6.35625 8.94816C6.89191 8.61089 7.47399 8.5 8 8.5C8.52601 8.5 9.10809 8.61089 9.64375 8.94816C10.1914 9.29298 10.5234 9.76911 10.7133 10.2122C11.0094 10.9031 11.0028 11.6655 11.0003 11.9448L11 12V13H13ZM6.99038 11.645C6.98978 11.6405 6.98933 11.6384 6.98933 11.6384L6.98953 11.6401C6.98953 11.6401 6.98997 11.6428 6.99038 11.645Z"/>\n</svg>\n'},79639:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M13 13V7.414l-5-5-5 5V13h3v-2-.052c-.001-.294-.003-.855.206-1.342.126-.294.339-.595.683-.812C7.227 8.581 7.612 8.5 8 8.5s.773.081 1.11.294c.345.217.558.518.684.812.209.487.207 1.048.206 1.342V13h3zm1 0V7.414a1 1 0 00-.293-.707l-5-5a1 1 0 00-1.414 0l-5 5A1 1 0 002 7.414V13a1 1 0 001 1h3a1 1 0 001-1v-2c0-.667 0-1.5 1-1.5s1 .833 1 1.5v2a1 1 0 001 1h3a1 1 0 001-1z"/>\n</svg>\n'},42606:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M16.2071 13H21V8.20711C21 7.76165 20.4614 7.53857 20.1464 7.85355L15.8536 12.1464C15.5386 12.4614 15.7617 13 16.2071 13Z" fill="currentColor"/>\n<path d="M18.65 10.9543C17.5938 9.12846 15.6197 7.90002 13.3586 7.90002C9.98492 7.90002 7.25 10.6349 7.25 14.0086C7.25 17.3823 9.98492 20.1172 13.3586 20.1172C15.1678 20.1172 16.7933 19.3308 17.9118 18.081" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n</svg>\n'},95574:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M14 2.20711C14 1.76166 13.4614 1.53857 13.1464 1.85356L11.7246 3.27543C11.3372 2.96859 10.911 2.7088 10.4541 2.50391C9.21538 1.94834 7.82481 1.82932 6.50965 2.16629C5.19448 2.50327 4.03248 3.27631 3.2135 4.35912C2.39451 5.44193 1.96697 6.77049 2.00073 8.12771C2.03448 9.48494 2.52754 10.7906 3.39933 11.8314C4.27113 12.8721 5.47012 13.5864 6.80041 13.8576C8.1307 14.1288 9.51363 13.9408 10.7233 13.3244C11.4465 12.9557 12.0823 12.447 12.5968 11.8333C12.6276 11.7965 12.6581 11.7593 12.688 11.7218C12.7896 11.5946 12.886 11.4632 12.9771 11.3278C13.2826 10.8737 13.0562 10.2799 12.558 10.0533C12.1616 9.87286 11.7138 9.98233 11.3753 10.2501C11.3189 10.2948 11.2654 10.3439 11.2158 10.3968C11.1891 10.4252 11.1635 10.4548 11.1391 10.4853C10.7843 10.9298 10.3368 11.2969 9.82334 11.5585C9.01328 11.9714 8.08715 12.0973 7.19628 11.9157C6.30542 11.734 5.50247 11.2557 4.91865 10.5587C4.33482 9.86172 4.00463 8.98735 3.98203 8.07844C3.95942 7.16953 4.24574 6.27982 4.7942 5.55468C5.34265 4.82955 6.12082 4.31185 7.00156 4.08619C7.88231 3.86052 8.81354 3.94023 9.64312 4.31228C9.87802 4.41763 10.1008 4.54465 10.309 4.69096L8.85356 6.14645C8.53857 6.46143 8.76166 7 9.20711 7H14V2.20711Z"/>\n</svg>\n'},81315:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M7.5 3.5a4.5 4.5 0 104.032 6.5h1.093A5.502 5.502 0 012 8a5.5 5.5 0 019.39-3.89l1.256-1.256a.5.5 0 01.854.353V7H9.707a.5.5 0 01-.353-.854l1.328-1.328A4.486 4.486 0 007.5 3.5z"/>\n</svg>\n'},21656:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M13.5 10.5L10 14L13.5 17.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n  <path d="M18.5 10.5L15 14L18.5 17.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n</svg>\n'},79257:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M6 3C6.55228 3 7 3.44772 7 4V7L10.2929 3.70711C10.9229 3.07714 12 3.52331 12 4.41421V11.5858C12 12.4767 10.9229 12.9229 10.2929 12.2929L7 9V12C7 12.5523 6.55228 13 6 13C5.44772 13 5 12.5523 5 12V4C5 3.44772 5.44772 3 6 3Z"/>\n</svg>\n'},23588:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M5.5 11.8a.5.5 0 001 0V8.5l3.646 3.646a.5.5 0 00.854-.353V4.207a.5.5 0 00-.854-.353L6.5 7.5V4.2a.5.5 0 00-1 0v7.6zM7.414 8L10 5.414v5.172L7.414 8z"/>\n</svg>\n'},92624:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M9 9L19 19" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n<path d="M19 9L9 19" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n</svg>\n'},52893:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M11.7071 5.70711C12.0976 5.31658 12.0976 4.68342 11.7071 4.29289C11.3166 3.90237 10.6834 3.90237 10.2929 4.29289L8 6.58579L5.70711 4.29289C5.31658 3.90237 4.68342 3.90237 4.29289 4.29289C3.90237 4.68342 3.90237 5.31658 4.29289 5.70711L6.58579 8L4.29289 10.2929C3.90237 10.6834 3.90237 11.3166 4.29289 11.7071C4.68342 12.0976 5.31658 12.0976 5.70711 11.7071L8 9.41421L10.2929 11.7071C10.6834 12.0976 11.3166 12.0976 11.7071 11.7071C12.0976 11.3166 12.0976 10.6834 11.7071 10.2929L9.41421 8L11.7071 5.70711Z"/>\n</svg>\n'},61947:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646Z"/>\n</svg>\n'},63818:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M6 1C5.44772 1 5 1.44772 5 2V4C5 4.55228 5.44772 5 6 5C6.55228 5 7 5.44772 7 6C7 6.55228 6.55228 7 6 7H2C1.44772 7 1 7.44772 1 8V10.5C1 10.7761 0.776142 11 0.5 11C0.223858 11 0 11.2239 0 11.5V13C0 13.5523 0.447715 14 1 14H3C3.55228 14 4 13.5523 4 13V11.5C4 11.2239 3.77614 11 3.5 11C3.22386 11 3 10.7761 3 10.5V10C3 9.44771 3.44772 9 4 9H6C6.55228 9 7 9.44771 7 10V10.5C7 10.7761 6.77614 11 6.5 11C6.22386 11 6 11.2239 6 11.5V13C6 13.5523 6.44772 14 7 14H9C9.55229 14 10 13.5523 10 13V11.5C10 11.2239 9.77614 11 9.5 11C9.22386 11 9 10.7761 9 10.5V10C9 9.44771 9.44771 9 10 9H12C12.5523 9 13 9.44771 13 10V10.5C13 10.7761 12.7761 11 12.5 11C12.2239 11 12 11.2239 12 11.5V13C12 13.5523 12.4477 14 13 14H15C15.5523 14 16 13.5523 16 13V11.5C16 11.2239 15.7761 11 15.5 11C15.2239 11 15 10.7761 15 10.5V8C15 7.44772 14.5523 7 14 7H10C9.44772 7 9 6.55228 9 6C9 5.44772 9.44771 5 10 5C10.5523 5 11 4.55228 11 4V2C11 1.44772 10.5523 1 10 1H6Z"/>\n</svg>\n'},90014:e=>{e.exports='<svg version="1.1" viewBox="0 0 16 16" height="16" width="16" class="note-icon" fill="none" stroke="currentColor" xmlns="http://www.w3.org/2000/svg">\n  <polygon points="9.5,8.5 9.5,14.9 11.5,13.3 13.5,14.9 13.5,8.5 "/>\n  <path stroke-opacity="0" d="M8,14c-1.6,0-3.4,0-5,0c0-3.7,0-8.3,0-12h10c0,1.3,0,3.7,0,5H8V14z"/>\n  <path fill-opacity="0" d="M8,13.5c-1.6,0-2.9,0-4.5,0c0-3.7,0-7.3,0-11h9c0,1.3,0,3.2,0,4.5"/>\n  <line fill-opacity="0" stroke-width="2" x1="4" y1="3" x2="12" y2="3"/>\n  <line fill-opacity="0" x1="5" y1="6.5" x2="11" y2="6.5"/>\n  <line fill-opacity="0" x1="5" y1="8.5" x2="8" y2="8.5"/>\n  <line fill-opacity="0" x1="5" y1="10.5" x2="8" y2="10.5"/>\n</svg>\n'},53001:e=>{e.exports='<svg version="1.1" viewBox="0 0 16 16" height="16" width="16" class="note-icon" fill="none" stroke="currentColor" xmlns="http://www.w3.org/2000/svg">\n\t<rect x="3.5" y="2.5" width="9" height="11" rx="0.1" ry="0.1" />\n\t<line fill-opacity="0" stroke-width="2" x1="4" y1="3" x2="12" y2="3"/>\n\t<line fill-opacity="0" x1="5" y1="6.5" x2="11" y2="6.5"/>\n\t<line fill-opacity="0" x1="5" y1="8.5" x2="11" y2="8.5"/>\n\t<line fill-opacity="0" x1="5" y1="10.5" x2="11" y2="10.5"/>\n</svg>\n'},42450:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M2 11V7a1 1 0 011-1h1a2 2 0 002-2h4c0 1.1.9 2 2 2h1a1 1 0 011 1v4a1 1 0 01-1 1H3a1 1 0 01-1-1zM1 7v4c0 1.1.9 2 2 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-1a1 1 0 01-1-1 1 1 0 00-1-1H6a1 1 0 00-1 1 1 1 0 01-1 1H3a2 2 0 00-2 2zm8 2a1 1 0 11-2 0 1 1 0 012 0zm1 0a2 2 0 11-4 0 2 2 0 014 0z"/>\n</svg>'},33851:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <circle cx="7.5" cy="7.5" r="4.5" fill-opacity="0.1"/>\n  <path d="M7.5 3C10 3 12 5 12 7.5S10 12 7.5 12 3 10 3 7.5 5 3 7.5 3m0-1C4.5 2 2 4.5 2 7.5S4.5 13 7.5 13 13 10.5 13 7.5 10.5 2 7.5 2z" fill-opacity="0.3"/>\n  <path d="M8 7V0H7v7H0v1h7v7h1V8h7V7H8zm0 0v1H7V7h1z"/>\n</svg>\n'},5597:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M17.75 7.25H11.25C10.1454 7.25 9.25 8.14543 9.25 9.25V18.75C9.25 19.8546 10.1454 20.75 11.25 20.75H16.75C17.8546 20.75 18.75 19.8546 18.75 18.75V18.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n  <path d="M13.75 17.25V15.25L19.4906 9.50943C20.0481 8.95194 20.9519 8.95194 21.5094 9.50943C22.0595 10.0595 22.0679 10.9487 21.5283 11.5091L16 17.25H13.75Z" stroke="currentColor" stroke-width="1.5"/>\n  <line x1="18.3536" y1="11.6464" x2="20.3536" y2="13.6464" stroke="currentColor"/>\n</svg>\n'},10933:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M2 13a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3a2 2 0 0 0-1.999-2H4a2 2 0 0 0-2 2v10Zm2-9h8v9H4V4Zm1 1.956h6v1H5v-1Zm0 2h6v1H5v-1Zm0 2h6v1H5v-1Z"/>\n</svg>'},60381:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M3 3.5C3 2.11929 4.11929 1 5.5 1H10.75C11.0261 1 11.25 1.22386 11.25 1.5C11.25 1.77614 11.0261 2 10.75 2H5.5C4.67157 2 4 2.67157 4 3.5V12.5C4 13.3284 4.67157 14 5.5 14H10.5C11.3284 14 12 13.3284 12 12.5V12C12 11.7239 12.2239 11.5 12.5 11.5C12.7761 11.5 13 11.7239 13 12V12.5C13 13.8807 11.8807 15 10.5 15H5.5C4.11929 15 3 13.8807 3 12.5V3.5Z"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M12.379 2.91391C12.9953 2.2976 13.971 2.22825 14.6683 2.75121C15.5099 3.38243 15.6091 4.60794 14.8799 5.36628L9.46287 11H7V8.29289L12.379 2.91391ZM14.0683 3.55121C13.7691 3.32684 13.3505 3.35659 13.0861 3.62101L13.0607 3.64645L14.1239 4.70972L14.1591 4.67317C14.4719 4.34782 14.4294 3.82203 14.0683 3.55121ZM13.4307 5.43069L12.3536 4.35355L8 8.70711V10H9.03713L13.4307 5.43069Z"/>\n</svg>\n'},91329:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path class="small-icon-fill" fill-rule="evenodd" d="M13 3H3v11h10V3zM5 5h6v1H5V5zm0 3h6v1H5V8zm0 3h6v1H5v-1z"/>\n  <path class="small-icon-outline" fill-rule="evenodd" d="M2 2a1 1 0 011-1h10a1 1 0 011 1v12a1 1 0 01-1 1H3a1 1 0 01-1-1V2zm11 1H3v11h10V3z"/>\n</svg>\n'},34923:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.00001 2C6.93914 2 5.92172 2.42143 5.17158 3.17157C4.42143 3.92172 4.00001 4.93913 4.00001 6V8.48188C3.96952 8.87419 3.79988 9.24291 3.5214 9.5214C3.23918 9.80362 2.86427 9.97406 2.46606 10.0012C2.19715 10.0195 1.99114 10.2476 2.00029 10.517C2.00945 10.7864 2.23047 11 2.50001 11H13.5C13.7695 11 13.9906 10.7864 13.9997 10.517C14.0089 10.2476 13.8029 10.0195 13.534 10.0012C13.1357 9.97406 12.7608 9.80362 12.4786 9.5214C12.2001 9.24291 12.0305 8.87419 12 8.48189V6C12 4.93913 11.5786 3.92172 10.8284 3.17157C10.0783 2.42143 9.06087 2 8.00001 2ZM5.87868 3.87868C6.44129 3.31607 7.20436 3 8.00001 3C8.79565 3 9.55872 3.31607 10.1213 3.87868C10.6839 4.44129 11 5.20435 11 6V8.5C11 8.51133 11.0004 8.52265 11.0012 8.53395C11.0377 9.07104 11.2367 9.58173 11.568 10H4.43204C4.76336 9.58173 4.9623 9.07104 4.99885 8.53395C4.99962 8.52265 5.00001 8.51133 5.00001 8.5V6C5.00001 5.20435 5.31608 4.44129 5.87868 3.87868ZM7.06415 12.3355C6.9733 12.0747 6.68826 11.937 6.42749 12.0278C6.16672 12.1187 6.02897 12.4037 6.11982 12.6645C6.25579 13.0548 6.50984 13.3931 6.84674 13.6325C7.18365 13.8719 7.58669 14.0005 7.99999 14.0005C8.41328 14.0005 8.81632 13.8719 9.15323 13.6325C9.49013 13.3931 9.74418 13.0548 9.88015 12.6645C9.971 12.4037 9.83325 12.1187 9.57248 12.0278C9.31171 11.937 9.02667 12.0747 8.93582 12.3355C8.86814 12.5298 8.74169 12.6981 8.574 12.8173C8.40631 12.9365 8.2057 13.0005 7.99999 13.0005C7.79427 13.0005 7.59366 12.9365 7.42597 12.8173C7.25828 12.6981 7.13183 12.5298 7.06415 12.3355Z"/>\n</svg>\n'},5733:e=>{e.exports='<svg class="ui-choice" width="167" height="129" viewBox="0 0 167 129" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <rect x="1" y="1" width="165" height="127" rx="6" stroke="currentColor" stroke-width="2"/>\n  <line x1="1" y1="18" x2="166" y2="18" stroke="currentColor" stroke-width="2"/>\n  <rect x="5" y="5" width="38" height="9" rx="3" fill="currentColor"/>\n</svg>\n'},81794:e=>{e.exports='<svg class="ui-choice" xmlns="http://www.w3.org/2000/svg" width="167" height="129" viewBox="0 0 167 129" fill="none">\n  <rect x="1" y="1" width="165" height="127" rx="6" stroke="currentColor" stroke-width="2"/>\n  <path stroke="currentColor" stroke-width="2" d="M2 18h165"/>\n  <rect x="5" y="5" width="38" height="9" rx="3" fill="currentColor"/>\n  <rect x="46" y="5" width="38" height="9" rx="3" fill="currentColor" opacity=".35"/>\n  <path stroke="currentColor" stroke-width="2" d="M44 63h123"/>\n  <path d="M15.75 38.75a2 2 0 0 1 2-2h10.5a2 2 0 0 1 2 2v6.5a2 2 0 0 1-2 2h-10.5a2 2 0 0 1-2-2v-6.5Z" stroke="currentColor" stroke-width="1.5"/>\n  <path d="m17.5 37 5.5 5.5 5.5-5.5M15.75 68.75a2 2 0 0 1 2-2h10.5a2 2 0 0 1 2 2v7.5a2 2 0 0 1-2 2h-10.5a2 2 0 0 1-2-2v-7.5Z" stroke="currentColor" stroke-width="1.5"/>\n  <path d="M19 66a1 1 0 1 1 2 0h-2ZM22 66a1 1 0 1 1 2 0h-2ZM25 66a1 1 0 1 1 2 0h-2ZM16 67h14v1.5H16z" fill="currentColor"/>\n  <path opacity=".35" fill-rule="evenodd" clip-rule="evenodd" d="M22 70h2v2h-2v-2Zm3 0h2v2h-2v-2Zm-4 3h-2v2h2v-2Zm1 0h2v2h-2v-2Zm-1-3h-2v2h2v-2Z" fill="currentColor"/>\n  <path fill="currentColor" d="M25 73h2v2h-2z"/>\n  <circle cx="19.75" cy="107.25" r="1.75" fill="currentColor"/>\n  <path d="M28.182 109c.468 0 .852-.38.816-.848A11.024 11.024 0 0 0 25.8 101.2a11.033 11.033 0 0 0-6.952-3.198c-.468-.036-.848.348-.848.816v.087c0 .469.38.844.847.887a9.254 9.254 0 0 1 5.691 2.67 9.238 9.238 0 0 1 2.67 5.691c.043.466.418.847.887.847h.087Z" fill="currentColor"/>\n  <path d="M24.788 109c.468 0 .853-.381.801-.847a7.633 7.633 0 0 0-6.742-6.742c-.466-.052-.847.333-.847.801v.071c0 .468.382.842.846.909a5.868 5.868 0 0 1 4.962 4.962c.067.464.44.846.91.846h.07Z" fill="currentColor"/>\n  <path stroke="currentColor" stroke-width="2" d="M45 19v109"/>\n</svg>'},24638:e=>{e.exports='<svg width="26" height="26" xmlns="http://www.w3.org/2000/svg">\n  <path d="M17.2 11.7C17.2 9 15.5 7 13 7c-2.2 0-4.2 2-4.2 4.7v.3h-.3a.5.5 0 00-.5.5V18a1 1 0 001 1h8a1 1 0 001-1v-5.5a.5.5 0 00-.5-.5h-.3v-.3zM15.7 13h-5.4v-1.3c0-1.7 1.4-3 2.8-3 1.7 0 2.8 1.3 2.8 3V13h-.2z"/>\n</svg>\n'},3638:e=>{e.exports='<svg width="26" height="26" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M17.2 12h-1.3v1H10.3v-1.3c0-1.7 1.4-3 2.8-3 .323 0 .624.047.9.134v-1.72A4.336 4.336 0 0013 7c-2.2 0-4.2 2-4.2 4.7v.3h-.3a.5.5 0 00-.5.5V18a1 1 0 001 1h8a1 1 0 001-1v-5.5a.5.5 0 00-.5-.5h-.3z"/>\n</svg>\n'},32721:e=>{e.exports='<svg width="28" height="28" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path opacity=".3" d="M24 0H4v28h20V0z"/>\n  <path d="M24 23H4c-1.1 0-2-.9-2-2V7c0-1.1.9-2 2-2h20c1.1 0 2 .9 2 2v14c0 1.1-.9 2-2 2zM4 7v14h20V7H4z"/>\n</svg>\n'},379:e=>{e.exports='<svg width="28" height="28" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <rect opacity=".3" x="2" y="5" width="24" height="18" rx="2"/>\n  <path d="M21.2 23h-4v-2h4v2zm-8 0h-4v-2h4v2zm-8 0H4c-1.1 0-2-.9-2-2v-1.3h2V21h1.1v2h.1zm20.6-1.1l-1.8-.8v-3.6h2v3.6c0 .2 0 .5-.2.8zM4 15.7H2v-4h2v4zm22-2.2h-2v-4h2v4zM4 7.7H2V7c0-1.1.9-2 2-2h4v2H4v.7zM24 7h-4V5h4v2zm-8 0h-4V5h4v2z"/>\n</svg>\n'},65961:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M12.5 10.5L9.5 13.5L12.5 16.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n<path d="M15.5 12.5L18.5 15.5L15.5 18.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n</svg>\n'},53514:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M5.79289 3.79285L2.08578 7.49995L5.79289 11.2071L7.20711 9.79285L4.91421 7.49995L7.20711 5.20706L5.79289 3.79285Z"/>\n  <path d="M8.79289 7.20706L11.0858 9.49995L8.79289 11.7928L10.2071 13.2071L13.9142 9.49995L10.2071 5.79285L8.79289 7.20706Z"/>\n</svg>\n'},40178:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M6.75 9.25C6.75 8.42157 7.42157 7.75 8.25 7.75H19.75C20.5784 7.75 21.25 8.42157 21.25 9.25V18.75C21.25 19.5784 20.5784 20.25 19.75 20.25H8.25C7.42157 20.25 6.75 19.5784 6.75 18.75V9.25Z" stroke="currentColor" stroke-width="1.5"/>\n  <path opacity="0.35" fill-rule="evenodd" clip-rule="evenodd" d="M8.5 11.5C8.5 11.2239 8.72386 11 9 11H10.5C10.7761 11 11 11.2239 11 11.5C11 11.7761 10.7761 12 10.5 12H9C8.72386 12 8.5 11.7761 8.5 11.5ZM8.5 13.5C8.5 13.2239 8.72386 13 9 13H10.5C10.7761 13 11 13.2239 11 13.5C11 13.7761 10.7761 14 10.5 14H9C8.72386 14 8.5 13.7761 8.5 13.5ZM9 15C8.72386 15 8.5 15.2239 8.5 15.5C8.5 15.7761 8.72386 16 9 16H10.5C10.7761 16 11 15.7761 11 15.5C11 15.2239 10.7761 15 10.5 15H9Z" fill="currentColor"/>\n  <line x1="12.75" y1="8" x2="12.75" y2="20" stroke="currentColor" stroke-width="1.5"/>\n</svg>\n'},11628:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<circle opacity="0.3" cx="15.5" cy="12.5" r="3" fill="currentColor"/>\n<path d="M8.75 13V10.75C8.75 8.54086 10.5409 6.75 12.75 6.75H17.25C19.4591 6.75 21.25 8.54086 21.25 10.75V14.25C21.25 16.4591 19.4591 18.25 17.25 18.25H8.5M8.5 18.25L11 15.75M8.5 18.25L11 20.75" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n</svg>\n'},54558:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M14 9H13V10H12V9V11H11V9H8V11H2L2 5H8V7L14 7V9ZM4 7V9H6V7H4Z"/>\n</svg>\n'},28786:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path d="M9 9v8h3v-8zM14 9v8h3v-8z"/>\n</svg>\n'},70636:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M5 5C5 4.44772 5.44772 4 6 4C6.55228 4 7 4.44772 7 5V11C7 11.5523 6.55228 12 6 12C5.44772 12 5 11.5523 5 11V5Z"/>\n  <path d="M9 5C9 4.44772 9.44772 4 10 4C10.5523 4 11 4.44772 11 5V11C11 11.5523 10.5523 12 10 12C9.44772 12 9 11.5523 9 11V5Z"/>\n</svg>\n'},16433:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M5 13H1.5C.672 13 0 12.267 0 11.364V3.636C0 2.733.672 2 1.5 2h13c.828 0 1.5.733 1.5 1.636v7.728c0 .903-.672 1.636-1.5 1.636H11v.454c0 .302-.224.546-.5.546h-5c-.276 0-.5-.244-.5-.546V13zM1.5 3h13c.276 0 .5.335.5.636v7.818c0 .302-.224.546-.5.546h-13c-.276 0-.5-.244-.5-.546V3.636c0-.3.224-.636.5-.636z"/>\n  <path d="M11.26 7.068a.5.5 0 0 1 0 .864l-4.508 2.63A.5.5 0 0 1 6 10.13V4.87a.5.5 0 0 1 .752-.431l4.508 2.63z"/>\n</svg>\n'},90801:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="m7.932 5.956 2.624-2.88L7.932.199C7.547-.225 7 .079 7 .677V2.5C4.25 2.806 2 5.15 2 8c0 .96.242 1.862.669 2.649.151.28.53.307.747.074l.179-.192a.541.541 0 0 0 .075-.61A4.314 4.314 0 0 1 3.222 8c0-2.17 1.705-3.96 3.778-4.26v1.746c0 .598.547.893.932.47zm-2.757 6.165 1.893-2.077c.385-.423.932-.141.932.456v1.746c2.073-.299 3.778-2.076 3.778-4.246 0-.696-.164-1.353-.455-1.935a.541.541 0 0 1 .075-.612l.178-.191c.217-.232.594-.206.746.073A5.54 5.54 0 0 1 13 8c0 2.85-2.25 5.18-5 5.486v1.824c0 .597-.547.915-.932.492l-2.624-2.879.182-.2-.008-.005.557-.597z"/>\n</svg>\n'},16228:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.145 14.834a.544.544 0 0 1 0-.8l3.164-2.994-5.68-5.256a.544.544 0 0 1 0-.8.622.622 0 0 1 .846 0l6.134 5.693a.5.5 0 0 1 .004.73L7.99 14.834a.622.622 0 0 1-.845 0z"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.145 1.166a.544.544 0 0 0 0 .8l3.164 2.994-5.68 5.256a.544.544 0 0 0 0 .8c.234.22.613.22.846 0l6.134-5.693a.5.5 0 0 0 .004-.73L7.99 1.166a.622.622 0 0 0-.845 0z"/>\n  <path d="M6.97 1.636h1.258v12.727H6.97z"/>\n</svg>\n'},3843:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M5 2.677a1 1 0 0 1 .629-.928l1.5-.6a1 1 0 0 1 .742 0l1.5.6a1 1 0 0 1 .629.928V3h1a1 1 0 0 1 1 1v9a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h1v-.323zM5 4H4v9h7V4h-1a1 1 0 0 1-1 1H6a1 1 0 0 1-1-1zm3-1.5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0z"/>\n</svg>\n'},84175:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="m8.011 1.5.14.001-.002.135a3.684 3.684 0 0 0 3.827 3.68 3.683 3.683 0 0 0 2.48 3.62A6.51 6.51 0 0 1 8.01 14.5C4.414 14.5 1.5 11.59 1.5 8s2.914-6.5 6.511-6.5Z" fill="none" stroke="currentColor"/>\n  <path d="M8 7.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Zm3 2.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM7.25 12a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z"/>\n</svg>\n'},32148:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M12.5 4h-9a.5.5 0 0 0-.5.5v7a.5.5 0 0 0 .5.5h9a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.5-.5zm-9-1A1.5 1.5 0 0 0 2 4.5v7A1.5 1.5 0 0 0 3.5 13h9a1.5 1.5 0 0 0 1.5-1.5v-7A1.5 1.5 0 0 0 12.5 3h-9z"/>\n  <rect x="1" y="11" width="14" height="2" rx=".5"/>\n</svg>\n'},39281:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M2 12.571V11h1v1.571c0 .237.224.429.5.429h8c.276 0 .5-.192.5-.429V11h1v1.714c0 .71-.672 1.286-1.5 1.286h-8c-.828 0-1.5-.719-1.5-1.429z"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.5 2a.5.5 0 0 1 .5.5v6.793l2.646-2.647a.5.5 0 0 1 .708.708L7.5 11.207 3.646 7.354a.5.5 0 1 1 .708-.708L7 9.293V2.5a.5.5 0 0 1 .5-.5z"/>\n</svg>\n'},66246:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M4 13h7V6H9a1 1 0 0 1-1-1V3H4v10zm5-9.586L10.586 5H9V3.414zM12 5 9 2H4a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h7a1 1 0 0 0 1-1V5zM8 7a.5.5 0 0 0-1 0v2.898L5.83 8.874a.5.5 0 0 0-.66.752l2.33 2.038 2.33-2.038a.5.5 0 0 0-.66-.752L8 9.898V7z"/>\n</svg>\n'},13450:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M3.5 3h9a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5zM2 3.5A1.5 1.5 0 0 1 3.5 2h9A1.5 1.5 0 0 1 14 3.5v9a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 12.5v-9zm4.951.5L4 12h1.867l.63-1.94h3l.63 1.94H12L9.043 4H6.95zm-.047 4.807 1.043-3.21h.106l1.037 3.21H6.904z"/>\n</svg>\n'},60439:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M0 7.5A4.5 4.5 0 0 1 4.5 3H11a5 5 0 0 1 5 5v2.005a3.8 3.8 0 0 1-2.791 3.663 4.558 4.558 0 0 1-2.418 0l-1.465-.403a5 5 0 0 0-2.652 0l-1.465.403a4.557 4.557 0 0 1-2.418 0A3.799 3.799 0 0 1 0 10.005V7.5zM4.95 4A3.95 3.95 0 0 0 1 7.95v1.071c0 1.292.88 2.418 2.132 2.731.57.143 1.166.143 1.736 0l1.677-.419a6.001 6.001 0 0 1 2.91 0l1.677.42a3.59 3.59 0 0 0 1.736 0A2.815 2.815 0 0 0 15 9.02V8a4 4 0 0 0-4-4H4.95zM13 7a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm-2 2a1 1 0 1 1-2 0 1 1 0 0 1 2 0zM3.875 5.625a.625.625 0 1 1 1.25 0v1.25h1.25a.625.625 0 1 1 0 1.25h-1.25v1.25a.625.625 0 1 1-1.25 0v-1.25h-1.25a.625.625 0 1 1 0-1.25h1.25v-1.25z"/>\n</svg>\n'},61637:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M1 4a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V4zm2-1h10a1 1 0 0 1 1 1v8a.996.996 0 0 1-.23.639L9.845 6.5l-2.77 4-1.845-2-2.985 4.157A.996.996 0 0 1 2 12V4a1 1 0 0 1 1-1z"/>\n</svg>\n'},72225:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M13.5 8h-7a.5.5 0 0 0-.5.5v5a.5.5 0 0 0 .5.5h7a.5.5 0 0 0 .5-.5v-5a.5.5 0 0 0-.5-.5zm-7-1A1.5 1.5 0 0 0 5 8.5v5A1.5 1.5 0 0 0 6.5 15h7a1.5 1.5 0 0 0 1.5-1.5v-5A1.5 1.5 0 0 0 13.5 7h-7z"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M1.64 1.42C2.177.577 3.09 0 4.5 0s2.324.578 2.86 1.42C7.87 2.222 8 3.21 8 4v3.5H7V4c0-.71-.121-1.473-.484-2.044C6.176 1.422 5.59 1 4.5 1c-1.09 0-1.676.422-2.016.956C2.121 2.526 2 3.29 2 4v1a.5.5 0 0 1-1 0V4c0-.79.129-1.777.64-2.58z"/>\n</svg>\n'},16097:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M5.86 4.146a.518.518 0 0 1 0 .708L3.346 7.5l2.516 2.646a.519.519 0 0 1 0 .708.46.46 0 0 1-.673 0L2 7.5l3.188-3.354a.459.459 0 0 1 .673 0zm4.28 0a.519.519 0 0 0 0 .708L12.654 7.5l-2.516 2.646a.519.519 0 0 0 0 .708.46.46 0 0 0 .673 0L14 7.5l-3.188-3.354a.459.459 0 0 0-.673 0z"/>\n</svg>\n'},33663:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M10.371 2.146 8.5 0 6.629 2.146c-.275.315-.08.854.308.854H8v7.691L5.276 9.329A.5.5 0 0 1 5 8.882v-.967a1.5 1.5 0 1 0-1 0v.967a1.5 1.5 0 0 0 .83 1.342L8 11.809v1.276a1.5 1.5 0 1 0 1 0v-2.739l3.027-1.135A1.5 1.5 0 0 0 13 7.807v-.892a1.5 1.5 0 1 0-1 0v.892a.5.5 0 0 1-.324.468L9 9.278V3h1.063c.389 0 .583-.539.308-.854zM8.5 14a.5.5 0 1 0 0 1 .5.5 0 0 0 0-1zm-4-7a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1zM13 5.5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0z"/>\n</svg>\n'},40469:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M15 11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h11a2 2 0 0 1 2 2v7zM2 3h11a1 1 0 0 1 1 1v1H1V4a1 1 0 0 1 1-1zM1 7v4a1 1 0 0 0 1 1h11a1 1 0 0 0 1-1V7H1z"/>\n</svg>\n'},26944:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.611 4a.5.5 0 0 0 0-1H3.5a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h9a.5.5 0 0 0 .5-.5v-4a.5.5 0 0 0-1 0V12H4V4h3.611zm-.465 4.854a.5.5 0 0 1 0-.708L13.293 2H9.5a.5.5 0 0 1 0-1h5.003a.498.498 0 0 1 .497.5v5a.5.5 0 0 1-1 0V2.707L7.854 8.854a.5.5 0 0 1-.708 0z"/>\n</svg>\n'},18972:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M5 5h2v3H5V5zm2 4H5v1h2V9zm1-4h2v1H8V5zm2 2H8v3h2V7z"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M12 9V8h.5a.5.5 0 0 0 0-1H12V6h.5a.5.5 0 0 0 0-1H12V4a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1v7a1 1 0 0 0 1 1h7a1 1 0 0 0 1-1v-1h.5a.5.5 0 0 0 0-1H12zM4 4h7v7H4V4z"/>\n</svg>\n'},46736:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.008 13.75a7 7 0 1 1 1.01.585 6.996 6.996 0 0 1-1.01-.584zm6.898-.5A5.97 5.97 0 0 1 8 14a5.973 5.973 0 0 1-2.906-.75 3.001 3.001 0 0 1 5.812 0zm.866-.584a4.013 4.013 0 0 0-1.993-2.25 3 3 0 1 0-3.557 0 4.013 4.013 0 0 0-1.994 2.25 6 6 0 1 1 7.544 0zM8 10a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"/>\n</svg>\n'},53629:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M12.3 2c.126 0 .241.047.33.124l.027.03a8 8 0 0 1 .226 11.077l-.193.202a.5.5 0 1 1-.739-.671l-.001-.002a7 7 0 0 0 0-9.9.511.511 0 0 1-.15-.36.5.5 0 0 1 .5-.5zm-2.1 2.145c.097 0 .188.028.264.075l.072.054a5 5 0 0 1 .172 6.89l-.186.193a.5.5 0 0 1-.747-.646l.053-.073a4 4 0 0 0 0-5.656.5.5 0 0 1 .372-.837zM8 11.793V4.207a.5.5 0 0 0-.854-.353l-2 2A.5.5 0 0 1 4.793 6H2.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h2.293a.5.5 0 0 1 .353.146l2 2A.5.5 0 0 0 8 11.793z"/>\n</svg>\n'},29680:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M10.371 2.146 8.5 0 6.629 2.146c-.275.315-.08.854.308.854H8v7.691L5.276 9.329A.5.5 0 0 1 5 8.882v-.967a1.5 1.5 0 1 0-1 0v.967a1.5 1.5 0 0 0 .83 1.342L8 11.809v1.276a1.5 1.5 0 1 0 1 0v-2.739l3.027-1.135A1.5 1.5 0 0 0 13 7.807v-.892a1.5 1.5 0 1 0-1 0v.892a.5.5 0 0 1-.324.468L9 9.278V3h1.063c.389 0 .583-.539.308-.854zM8.5 14a.5.5 0 1 0 0 1 .5.5 0 0 0 0-1zm-4-7a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1zM13 5.5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0z"/>\n</svg>\n'},43059:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M1 5a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 2 2 0 0 0 2 2h2a2 2 0 0 0 2-2h2a2 2 0 0 0 2 2h2a2 2 0 0 0 2-2 1 1 0 0 0 1-1V6a1 1 0 0 0-1-1H1zm4.5 2h-3a.5.5 0 0 0-.5.5V9a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1V7.5a.5.5 0 0 0-.5-.5zm8 0h-3a.5.5 0 0 0-.5.5V9a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1V7.5a.5.5 0 0 0-.5-.5z"/>\n</svg>\n'},72823:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M4 10H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v2h2a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2v-2zM2 9h8a1 1 0 0 0 1-1V3H1v5a1 1 0 0 0 1 1zm3 1v2a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V7h-3v1a2 2 0 0 1-2 2H5z"/>\n</svg>\n'},43927:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path class="permission-icon" d="M3 4c-.552 0-1 .448-1 1v5c0 .552.448 1 1 1h7c.552 0 1-.448 1-1v-1.625l2.171 1.899c.323.283.829.053.829-.376v-4.796c0-.43-.506-.659-.829-.376l-2.171 1.899v-1.625c0-.552-.448-1-1-1h-7z"/>\n  <g class="permission-denied">\n    <circle fill="#c30000" cx="4" cy="12" r="4"/>\n    <path d="M2 11h4v2h-4v-2z" fill="#fff"/>\n  </g>\n</svg>\n'},49823:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <mask id="pcams" fill="#fff">\n    <path d="M3 4c-.552 0-1 .448-1 1v5c0 .552.448 1 1 1h7c.552 0 1-.448 1-1v-1.625l2.171 1.899c.323.283.829.053.829-.376v-4.796c0-.43-.506-.659-.829-.376l-2.171 1.899v-1.625c0-.552-.448-1-1-1h-7z"/>\n  </mask>\n  <path class="permission-icon" mask="url(#pcams)" d="M11 8.375l.659-.753-1.659-1.451v2.204h1zm2.171 1.899l.659-.753-.659.753zm0-5.549l.659.753-.659-.753zm-2.171 1.899h-1v2.204l1.659-1.451-.659-.753zm-8-1.625v-2c-1.105 0-2 .895-2 2h2zm0 5v-5h-2v5h2zm0 0h-2c0 1.105.895 2 2 2v-2zm7 0h-7v2h7v-2zm0 0v2c1.105 0 2-.895 2-2h-2zm0-1.625v1.625h2v-1.625h-2zm.341.753l2.171 1.899 1.317-1.505-2.171-1.899-1.317 1.505zm2.171 1.899c.97.849 2.488.16 2.488-1.129h-2c0-.43.506-.659.829-.376l-1.317 1.505zm2.488-1.129v-4.796h-2v4.796h2zm0-4.796c0-1.289-1.518-1.978-2.488-1.129l1.317 1.505c-.323.283-.829.053-.829-.376h2zm-2.488-1.129l-2.171 1.899 1.317 1.505 2.171-1.899-1.317-1.505zm-2.512 1.027v1.625h2v-1.625h-2zm0 0h2c0-1.105-.895-2-2-2v2zm-7 0h7v-2h-7v2z"/>\n  <g class="permission-denied">\n    <circle fill="#c30000" cx="4" cy="12" r="4"/>\n    <path d="M2 11h4v2h-4v-2z" fill="#fff"/>\n  </g>\n</svg>\n'},9326:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path class="permission-icon" d="M6 1.207c0-.445-.539-.669-.854-.354l-2.793 2.793c-.195.195-.195.512 0 .707l2.793 2.793c.315.315.854.092.854-.354v-1.793h5.5c.276 0 .5-.224.5-.5v-1c0-.276-.224-.5-.5-.5h-5.5v-1.793zM10 12.793c0 .445.539.668.854.354l2.793-2.793c.195-.195.195-.512 0-.707l-2.793-2.793c-.315-.315-.854-.092-.854.354v1.793h-5.5c-.276 0-.5.224-.5.5v1c0 .276.224.5.5.5h5.5v1.793z"/>\n  <g class="permission-denied">\n    <circle fill="#c30000" cx="4" cy="12" r="4"/>\n    <path d="M2 11h4v2h-4v-2z" fill="#fff"/>\n  </g>\n</svg>\n'},4072:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path class="permission-icon" d="M5.854 2.354c.195-.195.195-.512 0-.707-.195-.195-.512-.195-.707 0l-2.288 2.288-.106.131c-.151.086-.252.248-.252.434s.102.348.252.434l.106.131 2.288 2.288c.195.195.512.195.707 0 .195-.195.195-.512 0-.707l-1.646-1.646h6.793c.276 0 .5-.224.5-.5s-.224-.5-.5-.5h-6.793l1.646-1.646zM9.646 11.646c-.195.195-.195.512 0 .707.195.195.512.195.707 0l2.288-2.288.106-.131c.151-.086.252-.248.252-.434s-.102-.348-.252-.434l-.106-.131-2.288-2.288c-.195-.195-.512-.195-.707 0-.195.195-.195.512 0 .707l1.646 1.646h-6.793c-.276 0-.5.224-.5.5s.224.5.5.5h6.793l-1.646 1.646z"/>\n  <g class="permission-denied">\n    <circle fill="#c30000" cx="4" cy="12" r="4"/>\n    <path d="M2 11h4v2h-4v-2z" fill="#fff"/>\n  </g>\n</svg>\n'},9027:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path class="permission-icon" d="M3.941 7.92c-.592-.822-.941-1.83-.941-2.92 0-2.761 2.239-5 5-5s5 2.239 5 5c0 1.09-.349 2.099-.941 2.92l-3.191 5.567c-.384.67-1.351.67-1.735 0l-3.191-5.567zm4.059-.92c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z"/>>\n  <g class="permission-denied">\n    <circle fill="#c30000" cx="4" cy="12" r="4"/>\n    <path d="M2 11h4v2h-4v-2z" fill="#fff"/>\n  </g>\n</svg>\n'},36055:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path class="permission-icon" d="M8 2.5c-1.933 0-3.5 1.567-3.5 3.5 0 .763.244 1.468.659 2.044l.015.021 2.393 4.173c.192.335.675.335.868 0l2.393-4.173.015-.021c.414-.574.658-1.28.658-2.044 0-1.933-1.567-3.5-3.5-3.5zm-4.5 3.5c0-2.485 2.015-4.5 4.5-4.5s4.5 2.015 4.5 4.5c0 .971-.308 1.871-.832 2.607l-2.367 4.129c-.576 1.005-2.026 1.005-2.603 0l-2.367-4.129c-.523-.736-.832-1.636-.832-2.607zm2.4 0c0-1.16.94-2.1 2.1-2.1 1.16 0 2.1.94 2.1 2.1 0 1.16-.94 2.1-2.1 2.1-1.16 0-2.1-.94-2.1-2.1zm2.1-1.1c-.608 0-1.1.492-1.1 1.1 0 .608.492 1.1 1.1 1.1.608 0 1.1-.492 1.1-1.1 0-.608-.492-1.1-1.1-1.1z"/>\n  <g class="permission-denied">\n    <circle fill="#c30000" cx="4" cy="12" r="4"/>\n    <path d="M2 11h4v2h-4v-2z" fill="#fff"/>\n  </g>\n</svg>\n'},72272:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path class="permission-icon" d="M4 6V7.333C4 9.358 5.791 11 8 11C10.209 11 12 9.358 12 7.333V6C12 5.448 12.448 5 13 5C13.552 5 14 5.448 14 6V7.667C14 10.31 11.838 12.503 9 12.927V14.001C9 14.553 8.552 15.001 8 15.001C7.448 15.001 7 14.553 7 14.001V12.927C4.162 12.504 2 10.31 2 7.667V6C2 5.448 2.448 5 3 5C3.552 5 4 5.448 4 6ZM5 3C5 1.343 6.343 0 8 0C9.657 0 11 1.343 11 3V7C11 8.657 9.657 10 8 10C6.343 10 5 8.657 5 7V3Z"/>\n  <g class="permission-denied">\n    <circle fill="#c30000" cx="4" cy="12" r="4"/>\n    <path d="M2 11h4v2h-4v-2z" fill="#fff"/>\n  </g>\n</svg>\n'},35237:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <g class="permission-icon">\n    <path d="M3.021 5.5c.276 0 .5.224.5.5 0 .967.148 2.365.786 3.506.616 1.1 1.704 1.994 3.714 1.994s3.098-.894 3.714-1.994c.639-1.14.786-2.539.786-3.506 0-.276.224-.5.5-.5s.5.224.5.5c0 1.033-.152 2.635-.914 3.994-.728 1.299-1.997 2.345-4.086 2.489v1.517c0 .276-.224.5-.5.5s-.5-.224-.5-.5v-1.517c-2.09-.144-3.359-1.19-4.086-2.489-.761-1.36-.914-2.961-.914-3.994 0-.276.224-.5.5-.5z"/>\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M8 1c-1.105 0-2 .895-2 2v4c0 1.105.895 2 2 2s2-.895 2-2v-4c0-1.105-.895-2-2-2zm0-1c-1.657 0-3 1.343-3 3v4c0 1.657 1.343 3 3 3s3-1.343 3-3v-4c0-1.657-1.343-3-3-3z"/>\n  </g>\n  <g class="permission-denied">\n    <circle fill="#c30000" cx="4" cy="12" r="4"/>\n    <path d="M2 11h4v2h-4v-2z" fill="#fff"/>\n  </g>\n</svg>\n'},90077:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <g class="permission-icon">\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M3 1c-.552 0-1 .448-1 1v11c0 .552.448 1 1 1h10c.552 0 1-.448 1-1v-11c0-.552-.448-1-1-1h-10zm1 4h1v4h1v3.4c0 .331-.269.6-.6.6h-.9c-.276 0-.5-.224-.5-.5v-7.5zm3 0h2v7.5c0 .276-.224.5-.5.5h-1c-.276 0-.5-.224-.5-.5v-7.5zm3 7.5v-3.5h1v-4h1v7.5c0 .276-.224.5-.5.5h-1c-.276 0-.5-.224-.5-.5z"/>\n  </g>\n  <g class="permission-denied">\n    <circle fill="#c30000" cx="4" cy="12" r="4"/>\n    <path d="M2 11h4v2h-4v-2z" fill="#fff"/>\n  </g>\n</svg>\n'},59301:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <g class="permission-icon">\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M4 2c-.552 0-1 .448-1 1v9c0 .552.448 1 1 1h8c.552 0 1-.448 1-1v-9c0-.552-.448-1-1-1h-8zm1 3h-1v6.5c0 .276.224.5.5.5h.9c.331 0 .6-.269.6-.6v-3.4h-1v-3zm2 0h2v6.5c0 .276-.224.5-.5.5h-1c-.276 0-.5-.224-.5-.5v-6.5zm3 3v3.5c0 .276.224.5.5.5h1c.276 0 .5-.224.5-.5v-6.5h-1v3h-1z"/>\n  </g>\n  <g class="permission-denied">\n    <circle fill="#c30000" cx="4" cy="12" r="4"/>\n    <path d="M2 11h4v2h-4v-2z" fill="#fff"/>\n  </g>\n</svg>\n'},22485:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path class="permission-icon" d="M9 3.308c1.722.408 3 1.95 3 3.692v2.586c0 .265.105.52.293.707l.414.414c.188.188.293.442.293.707v.088c0 .276-.224.5-.5.5h-9c-.276 0-.5-.224-.5-.5v-.088c0-.265.105-.52.293-.707l.414-.414c.188-.188.293-.442.293-.707v-2.586c.047-1.742 1.294-3.284 3-3.692v-.308c0-.598.518-1 1-1 .514 0 1 .402 1 1v.308zm-2.5 10.192c0-.175.03-.344.085-.5h2.829c.055.156.085.325.085.5 0 .828-.672 1.5-1.5 1.5s-1.5-.672-1.5-1.5z"/>\n  <g class="permission-denied">\n    <circle fill="#c30000" cx="4" cy="12" r="4"/>\n    <path d="M2 11h4v2h-4v-2z" fill="#fff"/>\n  </g>\n</svg>\n'},62067:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path class="permission-icon" d="M8 4.099v-.002l-.767.184c-1.262.302-2.192 1.45-2.233 2.734v2.778c0 .398-.158.779-.439 1.061l-.148.148h7.175l-.148-.148c-.281-.281-.439-.663-.439-1.061v-2.793c0-1.251-.932-2.411-2.231-2.719l-.769-.182zm-4 2.901c.047-1.742 1.294-3.284 3-3.692v-.308c0-.598.518-1 1-1 .514 0 1 .402 1 1v.308c1.722.408 3 1.95 3 3.692v2.793c0 .133.053.26.146.354l.707.707c.094.094.146.221.146.354v.295c0 .276-.224.5-.5.5h-9c-.276 0-.5-.224-.5-.5v-.295c0-.133.053-.26.146-.354l.707-.707c.094-.094.146-.221.146-.354v-2.793zm2.585 6.002c-.055.156-.085.323-.085.498s.03.344.085.5c.206.583.762 1 1.415 1s1.209-.417 1.415-1c.055-.156.085-.325.085-.5s-.03-.342-.085-.498l-.001-.002h-2.829l-.001.002z"/>\n  <g class="permission-denied">\n    <circle fill="#c30000" cx="4" cy="12" r="4"/>\n    <path d="M2 11h4v2h-4v-2z" fill="#fff"/>\n  </g>\n</svg>\n'},49989:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <g class="permission-icon">\n    <path opacity="0.5" d="M3 9C3 9.55228 2.55228 10 2 10V10C1.44772 10 1 9.55228 1 9V2C1 1.44772 1.44772 1 2 1H9C9.55228 1 10 1.44772 10 2V2C10 2.55228 9.55228 3 9 3H3.5C3.22386 3 3 3.22386 3 3.5V9Z"/>\n    <path d="M5 4C4.44772 4 4 4.44772 4 5V12C4 12.5523 4.44772 13 5 13H12C12.5523 13 13 12.5523 13 12V5C13 4.44772 12.5523 4 12 4H5ZM6 6.5C6 6.22386 6.22386 6 6.5 6H10.5C10.7761 6 11 6.22386 11 6.5V10.5C11 10.7761 10.7761 11 10.5 11H6.5C6.22386 11 6 10.7761 6 10.5V6.5Z" />\n  </g>\n  <g class="permission-denied">\n    <circle fill="#c30000" cx="4" cy="12" r="4"/>\n    <path d="M2 11h4v2h-4v-2z" fill="#fff"/>\n  </g>\n</svg>\n'},23217:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <g class="permission-icon">\n    <path opacity=".5" d="M4 10.5c0 .276-.224.5-.5.5s-.5-.224-.5-.5v-7.5c0-.552.448-1 1-1h7.5c.276 0 .5.224.5.5s-.224.5-.5.5h-7c-.276 0-.5.224-.5.5v7z"/>\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M6 5v6h6v-6h-6zm-.5-1c-.276 0-.5.224-.5.5v7c0 .276.224.5.5.5h7c.276 0 .5-.224.5-.5v-7c0-.276-.224-.5-.5-.5h-7z"/>\n  </g>\n  <g class="permission-denied">\n    <circle fill="#c30000" cx="4" cy="12" r="4"/>\n    <path d="M2 11h4v2h-4v-2z" fill="#fff"/>\n  </g>\n</svg>\n'},33520:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M13.58 2.153l.077.067c3.124 3.124 3.124 8.19 0 11.314-.293.293-.768.293-1.061 0-.293-.293-.293-.768 0-1.061 2.538-2.538 2.538-6.654 0-9.192-.293-.293-.293-.768 0-1.061.268-.268.69-.291.984-.067zm-10.176.067c.268.268.291.69.067.984l-.067.077c-2.483 2.483-2.537 6.476-.162 9.025l.162.168c.293.293.293.768 0 1.061-.293.293-.768.293-1.061 0-3.124-3.124-3.124-8.19 0-11.314.293-.293.768-.293 1.061 0zm8.055 2.054l.077.067c1.953 1.953 1.953 5.118 0 7.071-.293.293-.768.293-1.061 0-.293-.293-.293-.768 0-1.061 1.367-1.367 1.367-3.583 0-4.95-.293-.293-.293-.768 0-1.061.268-.268.69-.291.984-.067zm-5.934.067c.268.268.291.69.067.984l-.067.077c-1.321 1.321-1.365 3.436-.132 4.81l.132.139c.293.293.293.768 0 1.061-.293.293-.768.293-1.061 0-1.953-1.953-1.953-5.118 0-7.071.293-.293.768-.293 1.061 0zm2.475 1.536c1.105 0 2 .895 2 2s-.895 2-2 2-2-.895-2-2 .895-2 2-2z"/>\n  <g class="permission-denied">\n    <circle fill="#c30000" cx="4" cy="12" r="4"/>\n    <path d="M2 11h4v2h-4v-2z" fill="#fff"/>\n  </g>\n</svg>\n'},80490:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M13.3 2c.126 0 .241.047.329.124l.027.029c3.047 3.047 3.122 7.94.226 11.078l-.193.202c-.092.114-.232.187-.39.187-.276 0-.5-.224-.5-.5 0-.141.058-.268.151-.358l-.002-.002c2.734-2.734 2.734-7.166 0-9.899-.092-.093-.15-.22-.15-.36 0-.276.224-.5.5-.5zm-10.6 0c.276 0 .5.224.5.5 0 .141-.058.268-.15.36-2.672 2.672-2.732 6.965-.182 9.711l.182.189c.092.093.15.22.15.36 0 .276-.224.5-.5.5-.126 0-.242-.047-.33-.124l-.254-.265c-2.833-3.07-2.822-7.819.032-10.877l.222-.23c.088-.077.203-.124.33-.124zm8.5 2.145c.097 0 .188.028.264.075l.071.054c1.893 1.893 1.951 4.928.172 6.89l-.186.193c-.087.073-.199.118-.322.118-.276 0-.5-.224-.5-.5 0-.097.027-.187.075-.263l.053-.073c1.562-1.562 1.562-4.095 0-5.657-.079-.089-.128-.207-.128-.337 0-.276.224-.5.5-.5zm-6.4 0c.276 0 .5.224.5.5 0 .129-.049.247-.128.337-1.51 1.51-1.56 3.927-.151 5.498l.151.159.054.073c.047.076.075.167.075.263 0 .276-.224.5-.5.5-.092 0-.178-.025-.252-.068l-.07-.049-.186-.193c-1.725-1.903-1.723-4.814.005-6.715l.167-.175.071-.054c.077-.048.167-.075.264-.075zm3.2 1.665c1.105 0 2 .895 2 2s-.895 2-2 2-2-.895-2-2 .895-2 2-2z"/>\n  <g class="permission-denied">\n    <circle fill="#c30000" cx="4" cy="12" r="4"/>\n    <path d="M2 11h4v2h-4v-2z" fill="#fff"/>\n  </g>\n</svg>\n'},80224:e=>{e.exports='<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">\n  <path d="M15.5 3.74939H2.5C1.5335 3.74939 0.75 4.53289 0.75 5.49939V12.4994C0.75 13.4659 1.5335 14.2494 2.5 14.2494H15.5C16.4665 14.2494 17.25 13.4659 17.25 12.4994V5.49939C17.25 4.53289 16.4665 3.74939 15.5 3.74939Z" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" fill="none"/>\n  <path d="M5.5 11.4994V6.49939" stroke-linecap="round" stroke-linejoin="round" fill="none"/>\n  <path d="M4.5 6.49939H6.5" stroke-linecap="round" stroke-linejoin="round" fill="none"/>\n  <path d="M4.5 11.4994H6.5" stroke-linecap="round" stroke-linejoin="round" fill="none"/>\n</svg>\n'},8197:e=>{e.exports='<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">\n  <rect x="2" y="2.25" width="14" height="4" fill-opacity="0.3"/>\n  <rect x="2" y="6.25" width="9" height="6" fill-opacity="0.3"/>\n  <path d="M1.84067 6.25H16.5" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M16.5 12.25H1.84067" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M11.5 6.25V12.25" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M6.5 6.25V12.25" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M1.50001 3.75C1.50001 2.64543 2.39544 1.75 3.50001 1.75H14.5C15.6046 1.75 16.5 2.64543 16.5 3.75V14.75C16.5 15.8546 15.6046 16.75 14.5 16.75H3.5C2.39543 16.75 1.5 15.8546 1.5 14.75L1.50001 3.75Z" stroke-width="1.5" fill="none"/>\n</svg>\n'},99353:e=>{e.exports='<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">\n  <path d="M9 2H13V16L9 12.1818V2Z" fill-opacity="0.3" stroke="none"/>\n  <path d="M4.75 16.4214V2.75C4.75 1.92157 5.42157 1.25 6.25 1.25H11.75C12.5784 1.25 13.25 1.92157 13.25 2.75V16.4214C13.25 16.6405 12.9882 16.7536 12.8287 16.6034L9 13L5.17134 16.6034C5.0118 16.7536 4.75 16.6405 4.75 16.4214Z" stroke-width="1.5" stroke-linecap="round" fill="none"/>\n</svg>\n'},66969:e=>{e.exports='<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">\n  <path d="M1 4.5C1 3.39543 1.89543 2.5 3 2.5H15C16.1046 2.5 17 3.39543 17 4.5V6.25H1V4.5Z" fill-opacity="0.3"/>\n  <path d="M1.25 4.25C1.25 3.14543 2.14543 2.25 3.25 2.25H14.75C15.8546 2.25 16.75 3.14543 16.75 4.25V13.75C16.75 14.8546 15.8546 15.75 14.75 15.75H3.25C2.14543 15.75 1.25 14.8546 1.25 13.75V4.25Z" stroke-width="1.5" fill="none"/>\n  <path d="M1.5 6.5H16.5" stroke-linecap="round" stroke-linejoin="round" fill="none"/>\n  <path d="M5.5 3.25V0.75" stroke-linecap="round" stroke-linejoin="round" fill="none"/>\n  <path d="M12.5 3.25V0.75" stroke-linecap="round" stroke-linejoin="round" fill="none"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.5 9.25C8.5 9.80228 8.05228 10.25 7.5 10.25C6.94772 10.25 6.5 9.80228 6.5 9.25C6.5 8.69772 6.94772 8.25 7.5 8.25C8.05228 8.25 8.5 8.69772 8.5 9.25ZM5.5 12.25C5.5 12.8023 5.05228 13.25 4.5 13.25C3.94772 13.25 3.5 12.8023 3.5 12.25C3.5 11.6977 3.94772 11.25 4.5 11.25C5.05228 11.25 5.5 11.6977 5.5 12.25ZM10.5 10.25C11.0523 10.25 11.5 9.80228 11.5 9.25C11.5 8.69772 11.0523 8.25 10.5 8.25C9.94772 8.25 9.5 8.69772 9.5 9.25C9.5 9.80228 9.94772 10.25 10.5 10.25ZM8.5 12.25C8.5 12.8023 8.05228 13.25 7.5 13.25C6.94772 13.25 6.5 12.8023 6.5 12.25C6.5 11.6977 6.94772 11.25 7.5 11.25C8.05228 11.25 8.5 11.6977 8.5 12.25ZM13.5 10.25C14.0523 10.25 14.5 9.80228 14.5 9.25C14.5 8.69772 14.0523 8.25 13.5 8.25C12.9477 8.25 12.5 8.69772 12.5 9.25C12.5 9.80228 12.9477 10.25 13.5 10.25Z" stroke="none"/>\n  <circle cx="10.5" cy="12.25" r="1" fill-opacity="0.3" stroke="none"/>\n</svg>\n'},33181:e=>{e.exports='<svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M3.1444 11.1705C2.89591 11.1705 2.65418 11.0921 2.45572 10.9472C2.25726 10.8022 2.11287 10.5986 2.04436 10.3671C1.97585 10.1356 1.98694 9.88878 2.07596 9.66392C2.16498 9.43906 2.32709 9.24839 2.5378 9.12072L15.2495 1.41884C15.4381 1.30446 15.657 1.24586 15.8794 1.25023C16.1018 1.25459 16.3181 1.32172 16.5017 1.44341C16.6854 1.56509 16.8284 1.73604 16.9134 1.93532C16.9983 2.1346 17.0214 2.35356 16.9799 2.56539L14.504 15.3461C14.4629 15.5575 14.3593 15.7528 14.2057 15.9082C14.0521 16.0635 13.8552 16.1723 13.639 16.2211C13.4228 16.2699 13.1966 16.2567 12.988 16.1831C12.7794 16.1096 12.5974 15.9788 12.4641 15.8067L8.88094 11.1705H3.1444Z" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M9 11.25H6.73334L6.73334 15.1166C6.73333 15.3183 6.78832 15.5162 6.8924 15.6889C6.99648 15.8616 7.1457 16.0027 7.324 16.0969C7.5023 16.1911 7.70292 16.235 7.90427 16.2236C8.10562 16.2123 8.30006 16.1463 8.46667 16.0326L11 14.25L9 11.25Z" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M8.5 11.25L16.5 1.75" stroke-linecap="round" stroke-linejoin="round"/>\n\n</svg>\n'},61063:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M2 9.99988H0V14.9998C0 15.5521 0.447715 15.9998 1 15.9998H15C15.5523 15.9998 16 15.5521 16 14.9998V9.99988H14V13.9998H2V9.99988Z"/>\n  <path d="M10 1C10 0.447715 9.55228 0 9 0H7C6.44772 0 6 0.447715 6 1V5.99995H3L8 10.9999L13 5.99995H10V1Z"/>\n</svg>\n'},85730:e=>{e.exports='<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">\n  <path d="M2 12V15C2 15.5523 2.44772 16 3 16H15C15.5523 16 16 15.5523 16 15V12" stroke-width="1.5" fill="none"/>\n  <path d="M11 2C11 1.44772 10.5523 1 10 1H8C7.44772 1 7 1.44772 7 2V6.99995H4L9 11.9999L14 6.99995H11V2Z"/>\n</svg>\n'},81456:e=>{e.exports='<svg width="18" height="18" stroke="none" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">\n  <path d="M15.9744 14.4338C16.0027 14.884 15.6343 15.2501 15.1832 15.2501C14.7322 15.2501 14.3695 14.8839 14.3372 14.434C14.2498 13.2207 13.9681 12.0274 13.5013 10.9003C12.93 9.52124 12.0928 8.26821 11.0373 7.21273C9.98184 6.15726 8.72881 5.32001 7.34977 4.74879C6.22264 4.28192 5.02938 4.00023 3.81606 3.9129C3.36615 3.88051 3 3.51789 3 3.06681C3 2.61573 3.36604 2.24738 3.81623 2.2757C5.24422 2.36554 6.64953 2.69064 7.97488 3.23962C9.55212 3.89293 10.9852 4.8505 12.1924 6.05766C13.3996 7.26483 14.3571 8.69794 15.0104 10.2752C15.5594 11.6005 15.8845 13.0058 15.9744 14.4338Z"/>\n  <path d="M11.9646 14.4525C12.0037 14.8918 11.6425 15.2501 11.2014 15.2501C10.7604 15.2501 10.4073 14.8915 10.3598 14.453C10.2842 13.7544 10.1093 13.0688 9.83937 12.4171C9.46734 11.5189 8.92204 10.7029 8.23462 10.0154C7.5472 9.32801 6.73112 8.78272 5.83296 8.41069C5.18126 8.14075 4.49562 7.96586 3.79702 7.89021C3.35855 7.84272 3 7.48965 3 7.04861C3 6.60758 3.35822 6.24638 3.79752 6.28546C4.70606 6.36628 5.59861 6.5849 6.44415 6.93514C7.53608 7.38743 8.52823 8.05036 9.36396 8.88609C10.1997 9.72182 10.8626 10.714 11.3149 11.8059C11.6652 12.6514 11.8838 13.544 11.9646 14.4525Z"/>\n  <path d="M5 15.25C6.10457 15.25 7 14.3546 7 13.25C7 12.1454 6.10457 11.25 5 11.25C3.89543 11.25 3 12.1454 3 13.25C3 14.3546 3.89543 15.25 5 15.25Z"/>\n</svg>\n'},2035:e=>{e.exports='<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">\n  <path d="M1.25 9C1.25 6.43531 1.25 5.15297 1.70928 4.1567C2.20771 3.07554 3.07554 2.20771 4.1567 1.70928C5.15297 1.25 6.43531 1.25 9 1.25V1.25C11.5647 1.25 12.847 1.25 13.8433 1.70928C14.9245 2.20771 15.7923 3.07554 16.2907 4.1567C16.75 5.15297 16.75 6.43531 16.75 9V9C16.75 11.5647 16.75 12.847 16.2907 13.8433C15.7923 14.9245 14.9245 15.7923 13.8433 16.2907C12.847 16.75 11.5647 16.75 9 16.75V16.75C6.43531 16.75 5.15297 16.75 4.1567 16.2907C3.07554 15.7923 2.20771 14.9245 1.70928 13.8433C1.25 12.847 1.25 11.5647 1.25 9V9Z" fill-opacity="0.3" stroke-width="1.5"/>\n  <path d="M5 6.75H9" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M13 11.75L9 11.75" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M11 8.75C12.1046 8.75 13 7.85457 13 6.75C13 5.64543 12.1046 4.75 11 4.75C9.89543 4.75 9 5.64543 9 6.75C9 7.85457 9.89543 8.75 11 8.75Z" stroke-linecap="round" stroke-linejoin="round" fill="none"/>\n  <path d="M7 13.75C5.89543 13.75 5 12.8545 5 11.75C5 10.6454 5.89543 9.75 7 9.75C8.10457 9.75 9 10.6454 9 11.75C9 12.8545 8.10457 13.75 7 13.75Z" stroke-linecap="round" stroke-linejoin="round" fill="none"/>\n</svg>\n'},31415:e=>{e.exports='<svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M0.75 6.25C0.75 5.14543 1.64543 4.25 2.75 4.25H15.25C16.3546 4.25 17.25 5.14543 17.25 6.25V12.25C17.25 13.3546 16.3546 14.25 15.25 14.25H2.75C1.64543 14.25 0.75 13.3546 0.75 12.25V6.25Z" stroke-width="1.5"/>\n  <path d="M5.5 7.5H6.5" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M11.5 7.5H12.5" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M8.5 7.5H9.5" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M4 9.5H5" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M7 9.5H8" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M10 9.5H11" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M13 9.5H14" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M5.5 11.5H12.5" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n'},99366:e=>{e.exports='<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">\n  <path d="M1.25 4.75C1.25 3.92157 1.92157 3.25 2.75 3.25H15.25C16.0784 3.25 16.75 3.92157 16.75 4.75V13.25C16.75 14.0784 16.0784 14.75 15.25 14.75H2.75C1.92157 14.75 1.25 14.0784 1.25 13.25V4.75Z" stroke-width="1.5" fill="none"/>\n  <path d="M1 4.5L1.5 3.5H16.5L17 4.5L9 10.5L1 4.5Z" fill-opacity="0.3"/>\n  <path d="M1 4.5L9 10.5L17 4.5" stroke-width="1.5" fill="none"/>\n</svg>\n'},40068:e=>{e.exports='<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">\n  <path d="M9 8.75C8.73478 8.75 8.48043 8.64464 8.29289 8.45711C8.10536 8.26957 8 8.01522 8 7.75V5.75C8 5.48478 8.10536 5.23043 8.29289 5.04289C8.48043 4.85536 8.73478 4.75 9 4.75C9.26522 4.75 9.51957 4.85536 9.70711 5.04289C9.89464 5.23043 10 5.48478 10 5.75V7.75C10 8.01522 9.89464 8.26957 9.70711 8.45711C9.51957 8.64464 9.26522 8.75 9 8.75Z" fill-opacity="0.3" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M3.25 7C3.25 3.82436 5.82436 1.25 9 1.25V1.25C12.1756 1.25 14.75 3.82436 14.75 7V11.5C14.75 14.6756 12.1756 17.25 9 17.25V17.25C5.82436 17.25 3.25 14.6756 3.25 11.5V7Z" stroke-width="1.5" fill="none"/>\n</svg>\n'},90913:e=>{e.exports='<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">\n  <path d="M6.5 11.25H2C1.44772 11.25 1 11.6977 1 12.25V14.75C1 15.3023 1.44772 15.75 2 15.75H6.5C7.05228 15.75 7.5 15.3023 7.5 14.75V12.25C7.5 11.6977 7.05228 11.25 6.5 11.25Z" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" fill="none"/>\n  <path d="M2.5 17.75H6" stroke-linecap="round" stroke-linejoin="round" fill="none"/>\n  <path d="M4.25 16.25L4.25 17.25" stroke-linecap="round" stroke-linejoin="round" fill="none"/>\n  <path d="M16 11.25H11.5C10.9477 11.25 10.5 11.6977 10.5 12.25V14.75C10.5 15.3023 10.9477 15.75 11.5 15.75H16C16.5523 15.75 17 15.3023 17 14.75V12.25C17 11.6977 16.5523 11.25 16 11.25Z" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" fill="none"/>\n  <path d="M12 17.75H15.5" stroke-linecap="round" stroke-linejoin="round" fill="none"/>\n  <path d="M13.75 16.25L13.75 17.25" stroke-linecap="round" stroke-linejoin="round" fill="none"/>\n  <path d="M11.25 1.25H6.75C6.19772 1.25 5.75 1.69772 5.75 2.25V4.75C5.75 5.30228 6.19772 5.75 6.75 5.75H11.25C11.8023 5.75 12.25 5.30228 12.25 4.75V2.25C12.25 1.69772 11.8023 1.25 11.25 1.25Z" fill-opacity="0.2" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M7.25 8.25H10.75" stroke-linecap="round" stroke-linejoin="round" fill="none"/>\n  <path d="M9 6.25V8.25" stroke-linecap="round" stroke-linejoin="round" fill="none"/>\n</svg>\n'},69478:e=>{e.exports='<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">\n  <rect x="7" y="2" width="9" height="14" fill-opacity="0.30" stroke="none"/>\n  <path d="M7 2L7 16" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M1.25 3.25C1.25 2.14543 2.14543 1.25 3.25 1.25H14.75C15.8546 1.25 16.75 2.14543 16.75 3.25V14.75C16.75 15.8546 15.8546 16.75 14.75 16.75H3.25C2.14543 16.75 1.25 15.8546 1.25 14.75V3.25Z" stroke-width="1.5" fill="none"/>\n  <line x1="3" y1="4.5" x2="5.5" y2="4.5"/>\n  <line x1="3" y1="6.5" x2="5.5" y2="6.5"/>\n  <line x1="3" y1="8.5" x2="5.5" y2="8.5"/>\n</svg>\n'},64916:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M14.0046 2C15.1092 2 16 2.89543 16 4V12C16 13.1046 15.1077 14 14.0031 14C10.988 14 5.77574 14 1.99884 14C0.894274 14 0 13.1046 0 12V4C0 2.89543 0.890411 2 1.99498 2C5.09826 2 10.9258 2 14.0046 2ZM6 12.0418V4.01465H3C2.44772 4.01465 2 4.46068 2 5.01297C2 6.48887 2 9.25247 2 10.8705C2 10.9217 2 10.9797 2 11.0417C2 11.594 2.44772 12.0418 3 12.0418H6Z"/>\n</svg>\n'},84854:e=>{e.exports='<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">\n  <path d="M10.8544 15.3845L8.99938 16.25L7.14559 15.3845C5.93956 14.8622 4.65742 13.9933 3.92188 12.8825C3.18633 11.7717 2.77878 10.4665 2.75 9.124V4.5L8.99938 2.25L15.25 4.5V9.124C15.2209 10.4664 14.7355 11.7718 14 12.8825C13.2645 13.9933 12.0603 14.862 10.8544 15.3845Z" fill-opacity="0.3" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M6.5 9.64956L8.1659 11.25L11.5 7.25" stroke-linecap="round" stroke-linejoin="round" fill="none"/>\n</svg>\n'},21684:e=>{e.exports='<svg width="18" height="19" viewBox="0 0 18 19" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M11 13.25H16" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M7 4.25L11 8.25L7 12.25" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M2 4.25L6 8.25L2 12.25" stroke-opacity="0.3" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n'},23390:e=>{e.exports='<svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M6.15968 4.0343C3.29041 5.66198 2.30732 9.26691 3.9639 12.0861C5.62048 14.9054 9.2894 15.8713 12.1587 14.2436C15.028 12.6159 16.011 9.01101 14.3545 6.19179M3.96389 6.19179C2.30732 9.01101 3.2904 12.6159 6.15968 14.2436C9.02896 15.8713 12.6979 14.9054 14.3545 12.0861C16.011 9.26691 15.028 5.66198 12.1587 4.0343" stroke-width="1.5" stroke-linecap="round"/>\n  <path d="M9.15918 2.0343V8.0343" stroke-width="2" stroke-linecap="round"/>\n</svg>\n'},78781:e=>{e.exports='<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">\n  <path d="M4 6.75C4 7.94347 4.47411 9.08807 5.31802 9.93198C6.16193 10.7759 7.30653 11.25 8.5 11.25C9.69347 11.25 10.8381 10.7759 11.682 9.93198C12.5259 9.08807 13 7.94347 13 6.75C13 5.55653 12.5259 4.41193 11.682 3.56802C10.8381 2.72411 9.69347 2.25 8.5 2.25C7.30653 2.25 6.16193 2.72411 5.31802 3.56802C4.47411 4.41193 4 5.55653 4 6.75Z" fill-opacity="0.3" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M12 10.25L17 15.25" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" fill="none"/>\n</svg>\n'},82128:e=>{e.exports='<svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M10.7108 2.54578L10.9179 4.36283C11.4084 4.55585 11.8629 4.82059 12.2683 5.14413L13.9486 4.41928C14.1194 4.3207 14.3023 4.44036 14.3511 4.52485L15.7694 6.98138C15.8669 7.15034 15.8303 7.28412 15.6595 7.38271L14.1889 8.47108C14.2267 8.72523 14.2462 8.98533 14.2462 9.25C14.2462 9.52593 14.225 9.79688 14.1839 10.0613L15.6072 11.208C15.7779 11.3066 15.8145 11.4403 15.717 11.6093L14.3748 13.934C14.3261 14.0185 14.1431 14.1381 13.9724 14.0395L12.2798 13.3466C11.8671 13.6779 11.4033 13.948 10.9021 14.1434L10.6561 15.9542C10.6561 16.1513 10.461 16.2499 10.3634 16.2499H7.67912C7.48402 16.2499 7.38647 16.1513 7.38647 15.9542L7.10518 14.1491C6.59829 13.9533 6.12941 13.6811 5.71266 13.3467L4.02018 14.0395C3.84943 14.1381 3.66648 14.0185 3.6177 13.934L2.27554 11.6093C2.17799 11.4403 2.21461 11.3066 2.38537 11.208L3.80856 10.0613C3.76753 9.7969 3.74625 9.52594 3.74625 9.25C3.74625 8.98532 3.76583 8.72522 3.80364 8.47106L2.333 7.38271C2.16225 7.28412 2.12563 7.15034 2.22318 6.98138L3.64146 4.52485C3.69024 4.44036 3.87318 4.3207 4.04394 4.41928L5.7242 5.14411C6.13022 4.82013 6.58536 4.5551 7.07666 4.36201L7.28891 2.54578C7.28891 2.3486 7.48402 2.25 7.58157 2.25H10.4181C10.6132 2.25 10.7108 2.3486 10.7108 2.54578ZM8.99625 11.2502C10.1008 11.2502 10.9962 10.3548 10.9962 9.25024C10.9962 8.14567 10.1008 7.25024 8.99625 7.25024C7.89168 7.25024 6.99625 8.14567 6.99625 9.25024C6.99625 10.3548 7.89168 11.2502 8.99625 11.2502Z" stroke-width="1.5"/>\n</svg>\n'},84440:e=>{e.exports='<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">\n  <path d="M1.75 2.75C1.75 2.19772 2.19772 1.75 2.75 1.75H6.25C6.80229 1.75 7.25 2.19772 7.25 2.75V6.25C7.25 6.80228 6.80229 7.25 6.25 7.25H2.75C2.19772 7.25 1.75 6.80228 1.75 6.25V2.75Z" fill-opacity="0.3" stroke-width="1.5"/>\n  <path d="M1.75 11.75C1.75 11.1977 2.19772 10.75 2.75 10.75H6.25C6.80229 10.75 7.25 11.1977 7.25 11.75V15.25C7.25 15.8023 6.80229 16.25 6.25 16.25H2.75C2.19772 16.25 1.75 15.8023 1.75 15.25V11.75Z" fill-opacity="0.3" stroke-width="1.5"/>\n  <path d="M10.75 2.75C10.75 2.19772 11.1977 1.75 11.75 1.75H15.25C15.8023 1.75 16.25 2.19772 16.25 2.75V6.25C16.25 6.80228 15.8023 7.25 15.25 7.25H11.75C11.1977 7.25 10.75 6.80228 10.75 6.25V2.75Z" fill-opacity="0.3" stroke-width="1.5"/>\n  <path d="M13.75 11V16" stroke-width="1.5" stroke-linecap="round" fill="none"/>\n  <path d="M11.25 13.5H16.25" stroke-width="1.5" stroke-linecap="round" fill="none"/>\n</svg>\n'},22670:e=>{e.exports='<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">\n  <path d="M15.2167 7.125C15.2167 7.3765 15.1935 7.62274 15.1491 7.86182C16.3022 8.36276 17.1056 9.48615 17.1056 10.7917C17.1056 12.5636 15.8256 14.25 14 14.25H4.30555C2.47995 14.25 0.799995 12.5636 0.799995 10.7917C0.799995 9.42851 1.67589 8.26391 2.91123 7.79914C3.39009 6.60014 4.58997 5.75 5.99444 5.75C6.55197 5.75 7.07725 5.88397 7.53799 6.12055C8 4.5 9.50974 3 11.5 3C13.8472 3 15.2167 4.84683 15.2167 7.125Z" fill-opacity="0.3" stroke-width="1.5"/>\n</svg>\n'},26680:e=>{e.exports='<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">\n  <path d="M0.75 12.75V6.71875C0.75 5.61418 1.64543 4.71875 2.75 4.71875H7C8.10457 4.71875 9 5.61418 9 6.71875V9.75H17.25V12.75C17.25 13.0261 17.0261 13.25 16.75 13.25H1.25C0.973858 13.25 0.75 13.0261 0.75 12.75Z" stroke-width="1.5" fill="none"/>\n  <path d="M9 6.75V9.75H17.25V6.75C17.25 5.64543 16.3546 4.75 15.25 4.75H11C9.89543 4.75 9 5.64543 9 6.75Z" fill-opacity="0.3" stroke-width="1.5"/>\n</svg>\n'},59818:e=>{e.exports='<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">\n  <path d="M4.13274 8.51048C6.14553 7.40279 7.99805 8.34999 8.84418 9.85103C9.6903 11.3521 9.53002 13.407 7.51724 14.5146C5.50445 15.6223 3.14713 15.1415 1.29619 14.0049C3.27767 12.9145 1.94067 9.71683 4.13274 8.51048Z" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" fill="none"/>\n  <path d="M6.96982 8.00395C7.10031 8.05225 7.35165 8.1694 7.35165 8.1694C8.30577 8.64562 9.0071 9.48652 9.38544 10.4305C9.42744 10.5353 9.46569 10.6419 9.5 10.75L14.992 6.24293C16.0632 5.38601 16.1517 3.78827 15.1817 2.8183C14.2118 1.84833 12.6141 1.93682 11.7571 3.00797L6.96982 8.00395Z" fill-opacity="0.3" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n'},91689:e=>{e.exports='<svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M9 16.75C13.1421 16.75 16.5 13.3921 16.5 9.25C16.5 5.10786 13.1421 1.75 9 1.75C4.85786 1.75 1.5 5.10786 1.5 9.25C1.5 13.3921 4.85786 16.75 9 16.75Z" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M7.58665 16.6166C6.53998 15.15 5.83331 12.3966 5.83331 9.28329C5.83331 6.16996 6.53998 3.34996 7.58665 1.91663" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M10.4133 16.6166C11.46 15.15 12.1667 12.3966 12.1667 9.28329C12.1667 6.16996 11.46 3.34996 10.4133 1.91663" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M1.5 9.25H16.5" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M2.36664 12.75H15.6333" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M2.36664 5.75H15.6333" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n'},20277:e=>{e.exports='<svg  viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M8 1C4.134 1 1 4.134 1 8C1 11.866 4.134 15 8 15C11.866 15 15 11.866 15 8C15 4.134 11.866 1 8 1ZM3 8C3 7.216 3.197 6.484 3.52 5.823C3.522 5.829 3.524 5.839 3.527 5.844L4.125 7.106C4.173 7.209 4.306 7.295 4.419 7.295H4.665C4.778 7.295 4.918 7.376 4.974 7.474L5.492 8.367C5.549 8.467 5.672 8.602 5.764 8.668L6.868 9.463C6.959 9.531 7.128 9.584 7.24 9.584H7.587C7.7 9.584 7.792 9.679 7.792 9.792V11.096C7.792 11.211 7.884 11.304 7.998 11.304H8.231C8.343 11.304 8.435 11.398 8.435 11.513V11.751C8.435 11.866 8.343 11.96 8.231 11.96H7.998C7.884 11.96 7.792 12.053 7.792 12.168V12.979C5.133 12.867 3 10.686 3 8ZM10.372 12.374C10.435 12.297 10.497 12.209 10.531 12.136L11.055 11.01C11.103 10.907 11.143 10.728 11.143 10.613V10.55C11.143 10.435 11.06 10.296 10.961 10.243L9.223 9.319C9.123 9.266 8.948 9.223 8.836 9.221H7.472C7.36 9.221 7.195 9.162 7.107 9.09L6.29 8.423C6.202 8.35 6.131 8.198 6.131 8.083L6.134 7.503C6.135 7.389 6.227 7.295 6.34 7.295H6.893C7.007 7.295 7.099 7.389 7.099 7.503V8.222C7.099 8.336 7.191 8.43 7.304 8.43H7.36C7.473 8.43 7.566 8.336 7.566 8.222L7.565 6.974C7.565 6.858 7.639 6.708 7.729 6.638L8.143 6.316C8.233 6.246 8.398 6.189 8.511 6.189H9.523C9.636 6.189 9.728 6.119 9.728 6.031C9.728 5.944 9.636 5.872 9.523 5.872H9.193C9.08 5.872 8.988 5.779 8.988 5.664L8.99 4.913C8.99 4.797 8.896 4.703 8.785 4.703H8.492C8.379 4.702 8.35 4.635 8.427 4.551L8.866 4.08C8.944 3.996 9.007 3.854 9.007 3.761C9.007 3.667 8.915 3.592 8.802 3.592H8.497C8.385 3.592 8.217 3.537 8.125 3.471L7.741 3.197C7.692 3.162 7.65 3.103 7.619 3.038C7.747 3.029 7.87 3 8 3C8.433 3 8.846 3.073 9.247 3.177C9.25 3.289 9.339 3.38 9.45 3.38H9.747C9.86 3.38 9.952 3.474 9.952 3.589V4.268C9.952 4.384 10.044 4.478 10.157 4.478H10.246C10.359 4.478 10.525 4.422 10.616 4.353C10.616 4.353 10.792 4.215 11.013 4.036C12.213 4.951 13 6.379 13 8C13 9.894 11.929 11.526 10.372 12.374Z"/>\n</svg>\n'},457:e=>{e.exports='<svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 221 56">\n  <path d="M87.001 14.722 110 1.443l22.999 13.279v26.556L110 54.557 87.001 41.278V14.722Z" fill="var(--colorBgLighter)" stroke="var(--colorHighlightBg)" stroke-width="2.5"/>\n  <path d="M93.314 18.366 110 8.732l16.687 9.634v19.268L110 47.268l-16.686-9.634V18.366Z" fill="var(--colorHighlightBg)" stroke="var(--colorHighlightBg)" stroke-width="3"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M31 19a1 1 0 1 0 0 2h3.125a1 1 0 1 0 0-2H31Zm9.375 0a1 1 0 1 0 0 2h6.25a1 1 0 1 0 0-2h-6.25Zm12.5 0a1 1 0 1 0 0 2H56a1 1 0 1 0 0-2h-3.125ZM20 35a1 1 0 1 0 0 2h3.417a1 1 0 1 0 0-2H20Zm10.25 0a1 1 0 1 0 0 2h6.833a1 1 0 1 0 0-2H30.25Zm13.667 0a1 1 0 1 0 0 2h6.833a1 1 0 1 0 0-2h-6.833Zm13.666 0a1 1 0 0 0 0 2H61a1 1 0 1 0 0-2h-3.417ZM0 28a1 1 0 0 1 1-1h2.938a1 1 0 1 1 0 2H1a1 1 0 0 1-1-1Zm8.813 0a1 1 0 0 1 1-1h5.874a1 1 0 1 1 0 2H9.814a1 1 0 0 1-1-1Zm11.75 0a1 1 0 0 1 1-1h5.875a1 1 0 1 1 0 2h-5.875a1 1 0 0 1-1-1Zm11.75 0a1 1 0 0 1 1-1h5.874a1 1 0 1 1 0 2h-5.874a1 1 0 0 1-1-1Zm11.75 0a1 1 0 0 1 1-1H48a1 1 0 1 1 0 2h-2.938a1 1 0 0 1-1-1ZM190 19a1 1 0 0 1 0 2h-3.125a1 1 0 0 1 0-2H190Zm-9.375 0a1 1 0 0 1 0 2h-6.25a1 1 0 0 1 0-2h6.25Zm-12.5 0a1 1 0 0 1 0 2H165a1 1 0 0 1 0-2h3.125ZM202 36a1 1 0 0 0-1-1h-3.417a1 1 0 0 0 0 2H201a1 1 0 0 0 1-1Zm-10.25 0a1 1 0 0 0-1-1h-6.833a1 1 0 1 0 0 2h6.833a1 1 0 0 0 1-1Zm-13.667 0a1 1 0 0 0-1-1h-6.833a1 1 0 0 0 0 2h6.833a1 1 0 0 0 1-1Zm-13.666 0a1 1 0 0 0-1-1H160a1 1 0 0 0 0 2h3.417a1 1 0 0 0 1-1ZM220 27a1 1 0 0 1 0 2h-2.938a1 1 0 0 1 0-2H220Zm-8.812 0a1 1 0 0 1 0 2h-5.876a1 1 0 0 1 0-2h5.876Zm-11.75 0a1 1 0 0 1 0 2h-5.876a1 1 0 0 1 0-2h5.876Zm-11.75 0a1 1 0 0 1 0 2h-5.876a1 1 0 0 1 0-2h5.876Zm-11.75 0a1 1 0 0 1 0 2H173a1 1 0 0 1 0-2h2.938Z" fill="var(--colorHighlightBgFaded)"/>\n  <path d="M118.625 25.29h-7.432l1.427-8.84a.39.39 0 0 0-.216-.416.368.368 0 0 0-.446.11L101.083 30.08a.395.395 0 0 0-.046.41c.062.134.193.22.338.22h7.432l-1.427 8.839a.389.389 0 0 0 .216.417.37.37 0 0 0 .446-.11l10.875-13.936a.395.395 0 0 0 .046-.41.374.374 0 0 0-.338-.22Z" fill="var(--colorBgLighter)"/>\n</svg>\n'},37028:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M8 13c3.636 0 6.764-2.067 8-5-1.236-2.933-4.364-5-8-5s-6.764 2.067-8 5c1.236 3.035 4.364 5 8 5zm0-1c2.209 0 4-1.791 4-4s-1.791-4-4-4-4 1.791-4 4 1.791 4 4 4zm0-2c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z"/>\n</svg>\n'},96970:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M8 11c2.273 0 4.161-1.276 5.033-3-.872-1.724-2.76-3-5.033-3-2.276 0-4.166 1.28-5.037 3.007C3.827 9.777 5.707 11 8 11zm0 1c-2.727 0-5.073-1.572-6-4 .927-2.346 3.273-4 6-4s5.073 1.654 6 4c-.927 2.346-3.273 4-6 4zm1-4a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm1 0a2 2 0 1 1-4 0 2 2 0 0 1 4 0z"/>\n</svg>\n'},27063:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M2 2h11a1 1 0 0 1 1 1v9a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1ZM0 3a2 2 0 0 1 2-2h11a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3Zm6.46.803a.5.5 0 0 0-.92 0L4.17 7H2.5a.5.5 0 0 0 0 1h2a.5.5 0 0 0 .46-.303L6 5.269l2.54 5.928a.5.5 0 0 0 .92 0L10.83 8h1.67a.5.5 0 0 0 0-1h-2a.5.5 0 0 0-.46.303L9 9.731 6.46 3.803Z"/>\n</svg>'},51491:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 70 80">\n  <path d="M35.002 0c-.772 0-1.549.028-2.33.083-8.999.87-17.366 5.457-23.425 12.843C3.188 20.312-.113 29.951.003 39.91v33.27c-.001.482.084.96.252 1.406.167.446.414.851.724 1.192.31.34.679.61 1.084.792a3.045 3.045 0 002.535-.01 3.25 3.25 0 001.061-.797c.82-.905 1.933-1.413 3.093-1.413s2.273.508 3.094 1.413l2.563 2.825c.82.905 1.933 1.413 3.093 1.413s2.273-.508 3.094-1.413l2.562-2.825c.82-.905 1.933-1.413 3.094-1.413 1.16 0 2.273.508 3.093 1.413l2.563 2.825C32.728 79.492 33.84 80 35 80s2.273-.508 3.094-1.413l2.563-2.825c.82-.905 1.933-1.413 3.093-1.413s2.273.508 3.093 1.413l2.563 2.825c.82.905 1.933 1.413 3.094 1.413 1.16 0 2.273-.508 3.093-1.413l2.563-2.825c.82-.905 1.933-1.413 3.093-1.413s2.273.508 3.094 1.413c.302.34.662.611 1.06.796a3.042 3.042 0 002.535.01 3.305 3.305 0 001.085-.791c.31-.34.557-.746.724-1.192.168-.445.253-.924.252-1.406V38.587c0-10.234-3.688-20.048-10.251-27.285C53.185 4.066 44.284 0 35 0zm-8.75 36.176c0 1.43-.385 2.83-1.106 4.02-.721 1.189-1.746 2.116-2.945 2.664-1.2.547-2.519.69-3.792.412-1.272-.28-2.442-.969-3.36-1.98-.917-1.012-1.542-2.302-1.795-3.705a7.927 7.927 0 01.373-4.18c.497-1.322 1.338-2.452 2.417-3.247a6.137 6.137 0 013.646-1.22c1.74 0 3.41.763 4.64 2.12 1.23 1.356 1.922 3.197 1.922 5.116zm30.624 0c0 1.43-.385 2.83-1.106 4.02-.722 1.189-1.746 2.116-2.945 2.664-1.2.547-2.519.69-3.792.412-1.273-.28-2.442-.969-3.36-1.98-.918-1.012-1.543-2.302-1.796-3.705a7.928 7.928 0 01.374-4.18c.496-1.322 1.337-2.452 2.417-3.247a6.137 6.137 0 013.645-1.22c1.74 0 3.41.763 4.64 2.12 1.231 1.356 1.923 3.197 1.923 5.116z" fill="url(#private-ghost-gradient)"/>\n</svg>\n'},2018:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path d="M8 2c-.11 0-.221.004-.333.013-1.285.13-2.48.818-3.346 1.926-.866 1.108-1.337 2.554-1.32 4.047v4.99c0 .073.011.145.035.212a.56.56 0 00.104.178.474.474 0 00.155.12.419.419 0 00.362-.002.468.468 0 00.151-.12.585.585 0 01.442-.212c.166 0 .325.077.442.212l.366.424A.585.585 0 005.5 14a.585.585 0 00.442-.212l.366-.424a.585.585 0 01.442-.212c.166 0 .325.077.442.212l.366.424A.585.585 0 008 14a.585.585 0 00.442-.212l.366-.424a.585.585 0 01.442-.212c.166 0 .325.077.442.212l.366.424A.585.585 0 0010.5 14a.585.585 0 00.442-.212l.366-.424a.585.585 0 01.442-.212c.166 0 .325.077.442.212a.469.469 0 00.152.12.411.411 0 00.362.001.474.474 0 00.155-.118.56.56 0 00.103-.18.623.623 0 00.036-.21V7.788c0-1.535-.527-3.007-1.464-4.093C10.598 2.61 9.326 2 8 2zM6.75 7.426c0 .215-.055.425-.158.603a.982.982 0 01-.42.4.82.82 0 01-.542.062.906.906 0 01-.48-.297 1.147 1.147 0 01-.257-.556 1.245 1.245 0 01.054-.627c.07-.198.19-.368.345-.487a.85.85 0 01.52-.183c.25 0 .488.114.664.318.176.203.274.48.274.767zm4.375 0c0 .215-.055.425-.158.603a.982.982 0 01-.42.4.82.82 0 01-.542.062.906.906 0 01-.48-.297 1.147 1.147 0 01-.257-.556 1.245 1.245 0 01.054-.627c.07-.198.19-.368.345-.487a.85.85 0 01.52-.183c.25 0 .488.114.664.318.175.203.274.48.274.767z"/>\n</svg>\n'},34166:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M3 3H5V5H3V3ZM2 2H3H5H6V3V5V6H5H3H2V5V3V2ZM10 3H13V6H10V3ZM9 2H10H13H14V3V6V7H13H10H9V6V3V2ZM6 10H3V13H6V10ZM3 9H2V10V13V14H3H6H7V13V10V9H11V10H12V11H11V12H10H9V11H10V10H9H8V11V12H9V13V14H10V13H11H12V14H13V13H14V11H13V10H14V9H13V8H12V9H11V8H7V9H6H3ZM12 9H13V10H12V9ZM13 11H12V13H13V11ZM6 7H2V8H6V7ZM8 7V4H7V7H8ZM8 2V3L7 3V2H8ZM11 4H12V5H11V4ZM5 11H4V12H5V11Z"/>\n</svg>\n'},48783:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12">\n  <path d="M10 0H2a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zM5 9H3V3h2zm4 0H7V3h2z"/>\n</svg>'},83035:e=>{e.exports='<svg width="72" height="72" xmlns="http://www.w3.org/2000/svg">\n    <path d="M71 52a1 1 0 00-1-1H36a1 1 0 00-1 1v7a1 1 0 001 1h34a1 1 0 001-1v-7z" fill-opacity=".3"/>\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M2.397 10.5c-1.333 0-2.004 1.608-1.066 2.555l15.435 15.593a.5.5 0 010 .704L1.331 44.945c-.938.947-.267 2.555 1.066 2.555h6.095c.4 0 .784-.16 1.066-.445l16.828-17a1.5 1.5 0 000-2.11l-16.828-17a1.5 1.5 0 00-1.066-.445H2.397zm-.355 1.852a.5.5 0 01.355-.852h6.095a.5.5 0 01.355.148l16.828 17a.5.5 0 010 .704l-16.828 17a.5.5 0 01-.355.148H2.397a.5.5 0 01-.355-.852l15.435-15.593a1.5 1.5 0 000-2.11L2.042 12.352zM20.215 10.5c-1.332 0-2.003 1.608-1.066 2.555l15.436 15.593a.5.5 0 010 .704L19.149 44.945c-.937.947-.267 2.555 1.066 2.555h10.55c.4 0 .784-.16 1.066-.445l16.828-17a1.5 1.5 0 000-2.11l-16.828-17a1.5 1.5 0 00-1.066-.445h-10.55zm-.355 1.852a.5.5 0 01.355-.852h10.55a.5.5 0 01.355.148l16.828 17a.5.5 0 010 .704l-16.828 17a.5.5 0 01-.355.148h-10.55a.5.5 0 01-.355-.852l15.435-15.593a1.5 1.5 0 000-2.11L19.86 12.352zM36 50.5a1.5 1.5 0 00-1.5 1.5v7a1.5 1.5 0 001.5 1.5h34a1.5 1.5 0 001.5-1.5v-7a1.5 1.5 0 00-1.5-1.5H36zm-.5 1.5a.5.5 0 01.5-.5h34a.5.5 0 01.5.5v7a.5.5 0 01-.5.5H36a.5.5 0 01-.5-.5v-7z"/>\n</svg>\n'},19222:e=>{e.exports='<svg width="26" height="26" viewbox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path d="M6.207 9.207a.707.707 0 1 1 1-1l3.086 3.086a1 1 0 0 1 0 1.414l-3.086 3.086a.707.707 0 0 1-1-1l2.086-2.086a1 1 0 0 0 0-1.414L6.207 9.207z"/>\n  <path d="M10.707 9.707c-.63-.63-.184-1.707.707-1.707h.172a1 1 0 0 1 .707.293l3 3a1 1 0 0 1 0 1.414l-3 3a1 1 0 0 1-.707.293h-.172c-.89 0-1.337-1.077-.707-1.707l1.586-1.586a1 1 0 0 0 0-1.414l-1.586-1.586zM21 18a1 1 0 0 0-1-1h-6a1 1 0 1 0 0 2h6a1 1 0 0 0 1-1z"/>\n</svg>\n'},24319:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M1.20711 4.20711C0.761654 3.76165 1.07714 3 1.70711 3C1.89464 3 2.0745 3.0745 2.20711 3.20711L5.29289 6.29289C5.68342 6.68342 5.68342 7.31658 5.29289 7.70711L2.20711 10.7929C2.0745 10.9255 1.89464 11 1.70711 11C1.07714 11 0.761653 10.2383 1.20711 9.79289L3.29289 7.70711C3.68342 7.31658 3.68342 6.68342 3.29289 6.29289L1.20711 4.20711Z"/>\n  <path d="M5.70711 4.70711C5.07714 4.07714 5.52331 3 6.41421 3H6.58579C6.851 3 7.10536 3.10536 7.29289 3.29289L10.2929 6.29289C10.6834 6.68342 10.6834 7.31658 10.2929 7.70711L7.29289 10.7071C7.10536 10.8946 6.851 11 6.58579 11H6.41421C5.52331 11 5.07714 9.92286 5.70711 9.29289L7.29289 7.70711C7.68342 7.31658 7.68342 6.68342 7.29289 6.29289L5.70711 4.70711Z"/>\n  <path d="M16 13C16 12.4477 15.5523 12 15 12H9C8.44771 12 8 12.4477 8 13C8 13.5523 8.44771 14 9 14H15C15.5523 14 16 13.5523 16 13Z"/>\n</svg>\n'},50983:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M3 4h10v1H3zM3 6h10v1H3zM3 8h10v1H3zM3 10h6v1H3z"/>\n</svg>\n'},44425:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M1 8h14v1h-14zM1 6h14v1h-14zM1 4h14v1h-14zM1 10h8v1h-8z"/></svg>'},38037:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M5 1h1v8h-1zM7 1h1v14h-1zM9 1h1v14h-1zM11 1h1v14h-1z"/></svg>'},66627:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M7.74963 7.75H12.5C13.3284 7.75 14 8.42157 14 9.25V18.25C14 18.8023 13.5523 19.25 13 19.25H7.74965C7.19737 19.25 6.74965 18.8023 6.74965 18.25L6.74963 8.75C6.74963 8.19772 7.19735 7.75 7.74963 7.75Z" stroke="currentColor" stroke-width="1.5"/>\n<path d="M15.5 7.75241H20.25C20.8023 7.75241 21.25 8.20013 21.25 8.75241V18.25C21.25 18.8023 20.8023 19.25 20.25 19.25H15C14.4477 19.25 14 18.8023 14 18.25V9.25241C14 8.42398 14.6716 7.75241 15.5 7.75241Z" stroke="currentColor" stroke-width="1.5"/>\n<path d="M13 19.25C13.3333 19.816 14.2 20.6083 15 19.25" stroke="currentColor" stroke-width="1.5"/>\n<line opacity="0.35" x1="9" y1="10.5" x2="12" y2="10.5" stroke="currentColor" stroke-linecap="round"/>\n<line opacity="0.35" x1="16" y1="10.5" x2="19" y2="10.5" stroke="currentColor" stroke-linecap="round"/>\n<line opacity="0.35" x1="9" y1="12.5" x2="12" y2="12.5" stroke="currentColor" stroke-linecap="round"/>\n<line opacity="0.35" x1="16" y1="12.5" x2="19" y2="12.5" stroke="currentColor" stroke-linecap="round"/>\n<line opacity="0.35" x1="9" y1="14.5" x2="12" y2="14.5" stroke="currentColor" stroke-linecap="round"/>\n<line opacity="0.35" x1="16" y1="14.5" x2="19" y2="14.5" stroke="currentColor" stroke-linecap="round"/>\n<line opacity="0.35" x1="9" y1="16.5" x2="12" y2="16.5" stroke="currentColor" stroke-linecap="round"/>\n<line opacity="0.35" x1="16" y1="16.5" x2="19" y2="16.5" stroke="currentColor" stroke-linecap="round"/>\n</svg>\n'},70204:e=>{e.exports='<svg width="26" height="26" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M11 5H6a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h5c0 .552.895 1 2 1s2-.448 2-1h5a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-5a2 2 0 0 0-2 2 2 2 0 0 0-2-2zm8 4V8h-5v1h5zm-7 0V8H7v1h5zm7 1v1h-5v-1h5zm0 3v-1h-5v1h5zm0 1v1h-5v-1h5zm-7-3v-1H7v1h5zm0 1v1H7v-1h5zm0 3v-1H7v1h5z"/>\n</svg>\n'},92484:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M6 1H1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h5c0 .552.895 1 2 1s2-.448 2-1h5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1h-5a2 2 0 0 0-2 2 2 2 0 0 0-2-2zm8 4V4H9v1h5zM7 5V4H2v1h5zm7 1v1H9V6h5zm0 3V8H9v1h5zm0 1v1H9v-1h5zM7 7V6H2v1h5zm0 1v1H2V8h5zm0 3v-1H2v1h5z"/>\n</svg>\n'},8797:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M1.875 2h5.25c.483 0 .875.384.875.857C8 2.384 8.392 2 8.875 2h5.25c.483 0 .875.384.875.857v10.286a.866.866 0 0 1-.875.857h-4.71c-.206.291-.762.5-1.415.5s-1.209-.209-1.415-.5h-4.71A.866.866 0 0 1 1 13.143V2.857C1 2.384 1.392 2 1.875 2zM7 4v1H3V4h4zm6 0v1H9V4h4zm0 2v1H9V6h4zm0 2v1H9V8h4zm0 2v1H9v-1h4zM7 6v1H3V6h4zm0 2v1H3V8h4zm0 2v1H3v-1h4z"/>\n</svg>\n'},66510:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M1 1h5a2 2 0 0 1 2 2 2 2 0 0 1 2-2h5a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1h-5c0 .552-.895 1-2 1s-2-.448-2-1H1a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zm1 11.5a.5.5 0 0 0 .5.5H7c.182 0 .353.049.5.134V4a1 1 0 0 0-1-1h-4a.5.5 0 0 0-.5.5v9zM8 4a1 1 0 0 1 1-1h4.5a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5H9a1 1 0 0 0-1 1V4z"/>\n  <path opacity=".5" d="M7 4v1H3V4h4zm6 0v1H9V4h4zm0 2v1H9V6h4zm0 2v1H9V8h4zm0 2v1H9v-1h4zM7 6v1H3V6h4zm0 2v1H3V8h4zm0 2v1H3v-1h4zm-4.5 3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 0 .5.5H7c.182 0 .353.049.5.134v1A.995.995 0 0 0 7 13H2.5zM8 13a1 1 0 0 1 1-1h4.5a.5.5 0 0 0 .5-.5v1a.5.5 0 0 1-.5.5H9a1 1 0 0 0-1 1v-1z"/>\n</svg>\n'},81789:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M1.875 2h5.25c.483 0 .875.384.875.857C8 2.384 8.392 2 8.875 2h5.25c.483 0 .875.384.875.857v10.286a.866.866 0 0 1-.875.857h-4.71c-.206.291-.762.5-1.415.5s-1.209-.209-1.415-.5h-4.71A.866.866 0 0 1 1 13.143V2.857C1 2.384 1.392 2 1.875 2zM2.5 3a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5H7c.182 0 .353.049.5.134V4a1 1 0 0 0-1-1h-4zM8 4v10a1 1 0 0 1 1-1h4.5a.5.5 0 0 0 .5-.5v-9a.5.5 0 0 0-.5-.5H9a1 1 0 0 0-1 1z"/>\n  <path opacity=".5" fill-rule="evenodd" d="M7 4v1H3V4h4zm6 0v1H9V4h4zm0 2v1H9V6h4zm0 2v1H9V8h4zm0 2v1H9v-1h4zM7 6v1H3V6h4zm0 2v1H3V8h4zm0 2v1H3v-1h4zm-4.5 3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 0 .5.5H7c.182 0 .353.049.5.134v1A.995.995 0 0 0 7 13H2.5zM8 13a1 1 0 0 1 1-1h4.5a.5.5 0 0 0 .5-.5v1a.5.5 0 0 1-.5.5H9a1 1 0 0 0-1 1v-1z"/>\n</svg>\n'},46708:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M7.35355 1.64645C7.15829 1.45118 6.84171 1.45118 6.64645 1.64645C6.45118 1.84171 6.45118 2.15829 6.64645 2.35355L8.29289 4H3.5C2.11929 4 1 5.11929 1 6.5V9.5C1 10.8807 2.11929 12 3.5 12V11C2.67157 11 2 10.3284 2 9.5V6.5C2 5.67157 2.67157 5 3.5 5H8.29289L6.64645 6.64645C6.45118 6.84171 6.45118 7.15829 6.64645 7.35355C6.84171 7.54882 7.15829 7.54882 7.35355 7.35355L9.85355 4.85355C9.90149 4.80561 9.93766 4.75036 9.96206 4.69139C9.98425 4.63777 9.9967 4.58107 9.99943 4.52399C9.99981 4.516 10 4.508 10 4.5M9.96206 4.30861C9.93766 4.24964 9.90149 4.19439 9.85355 4.14645L7.35355 1.64645M9.96206 4.30861C9.98615 4.36669 9.9996 4.4303 9.99999 4.497Z"/>\n  <path fill-rule="evenodd" d="M15 6.5C15 5.11929 13.8807 4 12.5 4V5C13.3284 5 14 5.67157 14 6.5V9.5C14 10.3284 13.3284 11 12.5 11H7.70711L9.35355 9.35355C9.54882 9.15829 9.54882 8.84171 9.35355 8.64645C9.15829 8.45118 8.84171 8.45118 8.64645 8.64645L6.14645 11.1464C5.95118 11.3417 5.95118 11.6583 6.14645 11.8536L8.64645 14.3536C8.84171 14.5488 9.15829 14.5488 9.35355 14.3536C9.54882 14.1583 9.54882 13.8417 9.35355 13.6464L7.70711 12H12.5C13.8807 12 15 10.8807 15 9.5V6.5Z"/>\n</svg>\n'},91086:e=>{e.exports='<svg width="26" height="26" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M8 13a1 1 0 001 1h8a1 1 0 100-2H9a1 1 0 00-1 1z"/>\n</svg>\n'},58579:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M4 8C4 8.55228 4.44772 9 5 9H11C11.5523 9 12 8.55228 12 8C12 7.44772 11.5523 7 11 7H5C4.44772 7 4 7.44772 4 8Z"/>\n</svg>\n'},78670:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <rect x="4" y="8" width="8" height="1" rx="0.5"/>\n</svg>\n'},47062:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n      <path d="M13 6c-3.866 0-7 3.133-7 7h2c0-2.758 2.243-5 5-5s5 2.242 5 5c0 2.757-2.243 5-5 5-1.61 0-3.03-.78-3.946-1.966H6.7C7.83 18.378 10.222 20 13 20c3.866 0 7-3.135 7-7 0-3.867-3.134-7-7-7"/>\n      <path d="M13 13H6V6l7 7z"/>\n    <path d="M12 11h2v4h-2z"/>\n</svg>'},52381:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M7.60744 11.9857C6.6858 11.895 5.82411 11.4876 5.16904 10.833L5.16806 10.832L5.17 10.8301C5.00333 10.6634 4.40001 10.6 4.00001 11C3.60003 11.4 3.59334 12.0733 3.75998 12.24L3.75736 12.2427C3.99548 12.4807 4.25234 12.6975 4.5238 12.8904C5.37123 13.4928 6.36578 13.8681 7.4119 13.9711C8.79334 14.1072 10.1792 13.76 11.3334 12.9888C12.4876 12.2176 13.3387 11.0701 13.7416 9.74172C14.1446 8.41336 14.0745 6.98638 13.5433 5.70391C13.0121 4.42144 12.0526 3.36284 10.8284 2.70848C9.60416 2.05412 8.19092 1.84449 6.82946 2.1153C5.468 2.38611 4.24256 3.12061 3.36194 4.19365C3.3366 4.22452 3.3116 4.25561 3.28693 4.28693L1.85355 2.85355C1.53857 2.53857 1 2.76165 1 3.20711V8H5.79289C6.23835 8 6.46143 7.46143 6.14645 7.14645L4.71252 5.71252C4.77282 5.62587 4.83671 5.54137 4.90409 5.45926C5.49191 4.74301 6.30989 4.25273 7.21866 4.07196C8.12744 3.8912 9.07078 4.03113 9.88795 4.46791C10.7051 4.9047 11.3456 5.61132 11.7001 6.46736C12.0547 7.32341 12.1015 8.27592 11.8325 9.1626C11.5636 10.0493 10.9955 10.8153 10.2251 11.33C9.45464 11.8448 8.52956 12.0765 7.60744 11.9857Z"/>\n  <path d="M8 6.00001C7.44772 6.00001 7 6.44772 7 7.00001V9.00001C7 9.55229 7.44772 10 8 10C8.55228 10 9 9.55229 9 9.00001V7.00001C9 6.44772 8.55228 6.00001 8 6.00001Z"/>\n</svg>\n'},44474:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M5.01415 3.98943C4.43062 4.42386 3.9526 4.97755 3.60883 5.60883L2 4V8H6L4.47786 6.47786C4.74354 5.86311 5.16683 5.32572 5.70868 4.92232C6.3855 4.41843 7.20954 4.15169 8.05325 4.16341C8.89697 4.17512 9.71329 4.46462 10.3759 4.9871C11.0384 5.50958 11.5103 6.2359 11.7184 7.05362C11.9265 7.87134 11.8593 8.73487 11.5271 9.51053C11.1949 10.2862 10.6163 10.9307 9.88088 11.3443C9.14542 11.758 8.29413 11.9176 7.45877 11.7986C6.62397 11.6797 5.85162 11.289 5.26111 10.6871L5.25992 10.6859L4.42936 11.5001C4.66585 11.7413 4.92474 11.9566 5.20151 12.1435C5.82559 12.565 6.5406 12.8426 7.29472 12.95C8.38328 13.1051 9.49262 12.8971 10.451 12.358C11.4094 11.819 12.1634 10.9792 12.5962 9.96839C13.0291 8.95762 13.1167 7.83235 12.8455 6.76676C12.5743 5.70117 11.9594 4.7547 11.096 4.07385C10.2326 3.393 9.16885 3.01574 8.0694 3.00048C6.96994 2.98522 5.89612 3.3328 5.01415 3.98943Z"/>\n  <path d="M8 6C7.44772 6 7 6.44772 7 7V9C7 9.55229 7.44772 10 8 10C8.55228 10 9 9.55229 9 9V7C9 6.44772 8.55228 6 8 6Z"/>\n</svg>\n'},71303:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n    <path d="M16 13l-6 5V8l6 5z" />\n</svg>'},19423:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M10.2929 7.29289C10.6834 7.68342 10.6834 8.31658 10.2929 8.70711L7.70711 11.2929C7.07714 11.9229 6 11.4767 6 10.5858L6 5.41421C6 4.52331 7.07714 4.07714 7.70711 4.70711L10.2929 7.29289Z"/>\n</svg>\n'},59098:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <polygon points="6,4 11,8.5 6,12"></polygon>\n</svg>\n'},98353:e=>{e.exports='<svg width="17" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M8.5 0A5.5 5.5 0 0 1 14 5.5v5a5.5 5.5 0 1 1-11 0v-5A5.5 5.5 0 0 1 8.5 0zM13 8H4v2.5a4.5 4.5 0 0 0 8.995.212L13 10.5V8zM9 1.027V7h4V5.5a4.501 4.501 0 0 0-3.79-4.444L9 1.027zm-1 0A4.5 4.5 0 0 0 4 5.5V7h4V1.027z"/>\n  <path d="M8 1.027A4.5 4.5 0 0 0 4 5.5V7h4V1.027z" class="lmb" opacity="0"/>\n  <path d="M9 1.027V7h4V5.5a4.501 4.501 0 0 0-3.79-4.444L9 1.027z" class="rmb" opacity="0.5"/>\n</svg>\n'},45146:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<circle cx="10.75" cy="17.25" r="1.75" fill="currentColor"/>\n<path d="M19.1818 19C19.6504 19 20.0337 18.6196 19.9977 18.1523C19.9084 16.9941 19.6366 15.8554 19.1906 14.7789C18.6363 13.4406 17.8238 12.2247 16.7996 11.2004C15.7753 10.1762 14.5594 9.36368 13.2211 8.80936C12.1446 8.36345 11.0059 8.09162 9.84766 8.00235C9.38044 7.96634 9 8.34961 9 8.81821V8.90503C9 9.37363 9.38067 9.74947 9.8473 9.79241C10.7711 9.87742 11.6784 10.1011 12.5385 10.4574C13.6603 10.922 14.6796 11.6031 15.5383 12.4617C16.3969 13.3204 17.078 14.3397 17.5426 15.4615C17.8989 16.3216 18.1226 17.2289 18.2076 18.1527C18.2505 18.6193 18.6264 19 19.095 19H19.1818Z" fill="currentColor"/>\n<path d="M15.7879 19C16.2565 19 16.6412 18.619 16.5893 18.1533C16.5098 17.4411 16.3303 16.7423 16.0551 16.0777C15.6713 15.1512 15.1088 14.3094 14.3997 13.6003C13.6906 12.8912 12.8488 12.3287 11.9223 11.9449C11.2577 11.6697 10.5589 11.4902 9.84674 11.4107C9.38103 11.3588 9 11.7435 9 12.2121V12.2828C9 12.7514 9.38182 13.125 9.84554 13.1925C10.3254 13.2624 10.7958 13.3916 11.2459 13.578C11.9579 13.8729 12.6049 14.3052 13.1498 14.8502C13.6948 15.3951 14.1271 16.0421 14.422 16.7541C14.6084 17.2042 14.7376 17.6746 14.8075 18.1545C14.875 18.6182 15.2486 19 15.7172 19H15.7879Z" fill="currentColor"/>\n</svg>\n'},55592:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72">\n  <path fill-rule="evenodd" d="M66.27 66.27C60.55 72 51.77 72 36 72c-15.78 0-24.55 0-30.27-5.73C0 60.54 0 51.77 0 36S0 11.46 5.73 5.73C11.45 0 20.23 0 36 0c15.78 0 24.55 0 30.27 5.73C72 11.46 72 20.23 72 36s0 24.54-5.73 30.27zM52.71 54.32a2.8 2.8 0 002.86-2.97A38.63 38.63 0 0020.02 15.8a2.8 2.8 0 00-2.97 2.86v.3a3.2 3.2 0 002.97 3.1A32.38 32.38 0 0149.3 51.36a3.2 3.2 0 003.1 2.97h.31zm-23.77-5.95a5.94 5.94 0 11-11.89 0 5.94 5.94 0 0111.89 0zm14.7 2.98c.18 1.63-1.17 2.97-2.81 2.97h-.25c-1.64 0-2.95-1.34-3.19-2.97a20.55 20.55 0 00-17.38-17.37c-1.62-.24-2.96-1.55-2.96-3.19v-.25c0-1.64 1.34-2.99 2.97-2.8a26.74 26.74 0 0123.61 23.61z" opacity=".3"/>\n  <path fill-rule="evenodd" d="M54.76 70.3c4.76-.7 8.15-2.08 10.8-4.73 2.66-2.66 4.04-6.05 4.73-10.81.7-4.8.71-10.84.71-18.76 0-7.92 0-13.97-.7-18.76-.7-4.76-2.08-8.15-4.73-10.8C62.9 3.78 59.52 2.4 54.76 1.7 49.96 1 43.92 1 36 1c-7.92 0-13.97 0-18.76.7-4.76.7-8.15 2.08-10.8 4.74-2.66 2.65-4.04 6.04-4.73 10.8C1 22.04 1 28.08 1 36c0 7.92 0 13.97.7 18.76.7 4.76 2.08 8.15 4.73 10.8 2.66 2.66 6.05 4.04 10.81 4.73 4.8.7 10.84.71 18.76.71 7.92 0 13.97 0 18.76-.7zm1.8-19.03a3.8 3.8 0 01-3.85 4.05h-.3a4.2 4.2 0 01-4.1-3.88 31.38 31.38 0 00-28.38-28.38 4.2 4.2 0 01-3.88-4.1v-.3a3.8 3.8 0 014.05-3.86 39.63 39.63 0 0136.47 36.47zm-26.62-2.9a6.94 6.94 0 11-13.89 0 6.94 6.94 0 0113.89 0zm14.69 2.87c.25 2.3-1.64 4.08-3.8 4.08h-.25c-2.22 0-3.88-1.8-4.18-3.82a19.55 19.55 0 00-16.53-16.53c-2.03-.3-3.82-1.96-3.82-4.18v-.25c0-2.16 1.78-4.05 4.08-3.8a27.75 27.75 0 0124.5 24.5zM36 72c15.78 0 24.55 0 30.27-5.73C72 60.54 72 51.77 72 36s0-24.54-5.73-30.27C60.55 0 51.77 0 36 0 20.22 0 11.45 0 5.73 5.73 0 11.46 0 20.23 0 36s0 24.54 5.73 30.27C11.45 72 20.23 72 36 72zm19.57-20.65a2.8 2.8 0 01-2.86 2.97h-.3a3.2 3.2 0 01-3.1-2.97 32.38 32.38 0 00-29.29-29.28 3.2 3.2 0 01-2.97-3.11v-.3a2.8 2.8 0 012.97-2.86 38.63 38.63 0 0135.55 35.55zM23 54.32a5.94 5.94 0 100-11.9 5.94 5.94 0 000 11.9zm17.83 0c1.64 0 2.99-1.34 2.8-2.97a26.75 26.75 0 00-23.61-23.61c-1.63-.19-2.97 1.16-2.97 2.8v.25c0 1.64 1.34 2.95 2.96 3.19A20.55 20.55 0 0137.4 51.35c.24 1.63 1.55 2.97 3.19 2.97h.25z"/>\n</svg>\n'},24885:e=>{e.exports='<svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 160">\n  <path opacity=".2" stroke="#F60" stroke-width="3" stroke-linecap="round" stroke-dasharray="9 10" d="M2.5 56.5v55M50.5 29.5v125M98.5 6.5v124"/>\n  <path opacity=".1" stroke="#F60" stroke-width="3" stroke-linecap="round" stroke-dasharray="9 10" d="M146.5 5.5v106"/>\n  <path opacity=".5" stroke="#F60" stroke-width="3" stroke-linecap="round" stroke-dasharray="9 10" d="M18.5 43.5v95"/>\n  <path opacity=".2" stroke="#F60" stroke-width="3" stroke-linecap="round" stroke-dasharray="9 10" d="M66.5 43.5v95"/>\n  <path opacity=".5" stroke="#F60" stroke-width="3" stroke-linecap="round" stroke-dasharray="9 10" d="M114.5 43.5v95"/>\n  <path opacity=".2" stroke="#F60" stroke-width="3" stroke-linecap="round" stroke-dasharray="9 10" d="M162.5 43.5v95M34.5 24.5v95"/>\n  <path opacity=".1" stroke="#F60" stroke-width="3" stroke-linecap="round" stroke-dasharray="9 10" d="M82.5 24.5v105"/>\n  <path opacity=".2" stroke="#F60" stroke-width="3" stroke-linecap="round" stroke-dasharray="9 10" d="M130.5 24.5v95"/>\n  <path opacity=".5" stroke="#F60" stroke-width="3" stroke-linecap="round" stroke-dasharray="9 10" d="M178.5 24.5v84"/>\n  <path opacity=".2" stroke="#F60" stroke-width="3" stroke-linecap="round" stroke-dasharray="9 10" d="M194.5 34.5v60"/>\n  <path d="M98.5 117c18.186 0 28.296 0 34.898-6.603C140 103.794 140 93.684 140 75.5c0-18.184 0-28.294-6.602-34.897C126.796 34 116.686 34 98.5 34c-18.186 0-28.296 0-34.898 6.603C57 47.206 57 57.316 57 75.5c0 18.184 0 28.294 6.602 34.897C70.204 117 80.314 117 98.5 117Z" fill="#F60"/>\n  <path d="M82.102 99.156c3.833 0 6.94-3.132 6.94-6.995 0-3.862-3.107-6.993-6.94-6.993s-6.94 3.13-6.94 6.993c0 3.863 3.107 6.995 6.94 6.995ZM123.529 94.533c.237 2.544-1.857 4.623-4.412 4.623-2.556 0-4.599-2.081-4.892-4.62-2.1-18.146-16.411-32.59-34.409-34.737-2.557-.306-4.654-2.364-4.654-4.939s2.094-4.686 4.657-4.44c23.102 2.225 41.536 20.822 43.71 44.113Z" fill="#fff"/>\n  <path d="M107.227 94.542c.357 2.53-1.749 4.614-4.304 4.614s-4.58-2.093-5.079-4.599c-1.823-9.15-8.98-16.38-18.05-18.246-2.523-.518-4.632-2.557-4.632-5.132 0-2.575 2.1-4.698 4.648-4.327 14.17 2.06 25.403 13.4 27.417 27.69Z" fill="#fff"/>\n</svg>\n'},81346:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M5 12C5 13.1045 4.10457 14 3 14C1.89543 14 1 13.1045 1 12C1 10.8954 1.89543 9.99997 3 9.99997C4.10457 9.99997 5 10.8954 5 12Z"/>\n  <path d="M13 14C13.5523 14 14.004 13.5516 13.9616 13.0009C13.8563 11.6359 13.536 10.2938 13.0104 9.02508C12.3571 7.44785 11.3996 6.01474 10.1924 4.80758C8.98523 3.60042 7.55212 2.64284 5.97488 1.98953C4.70613 1.464 3.36409 1.14362 1.99903 1.03841C1.44837 0.995969 1 1.44768 1 1.99997V2.10229C1 2.65457 1.44865 3.09753 1.99861 3.14813C3.08735 3.24832 4.15675 3.51197 5.17036 3.93182C6.49253 4.47948 7.69388 5.2822 8.70582 6.29414C9.71777 7.30609 10.5205 8.50744 11.0681 9.82961C11.488 10.8432 11.7516 11.9126 11.8518 13.0014C11.9024 13.5513 12.3454 14 12.8977 14H13Z"/>\n  <path d="M9 14C9.55229 14 10.0057 13.5509 9.9445 13.002C9.85086 12.1627 9.63936 11.3391 9.31492 10.5558C8.86262 9.46389 8.19969 8.47173 7.36396 7.63601C6.52823 6.80028 5.53608 6.13734 4.44415 5.68505C3.66087 5.36061 2.83725 5.14911 1.99795 5.05547C1.44907 4.99423 1 5.44768 1 5.99997V6.08323C1 6.63551 1.45001 7.07582 1.99653 7.15539C2.56208 7.23773 3.11654 7.39004 3.64692 7.60973C4.4861 7.95733 5.2486 8.46682 5.89087 9.10909C6.53315 9.75137 7.04264 10.5139 7.39023 11.353C7.60993 11.8834 7.76223 12.4379 7.84458 13.0034C7.92415 13.55 8.36446 14 8.91674 14H9Z"/>\n</svg>\n'},28481:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M1 3.154C1 1.964 1.964 1 3.154 1h9.692C14.036 1 15 1.964 15 3.154v9.692c0 1.19-.964 2.154-2.154 2.154H3.154A2.154 2.154 0 011 12.846V3.154zm2.154-1.077h9.692c.595 0 1.077.482 1.077 1.077v9.692c0 .595-.482 1.077-1.077 1.077H3.154a1.077 1.077 0 01-1.077-1.077V3.154c0-.595.482-1.077 1.077-1.077z"/>\n  <path class="small-icon-outline" d="M12.5 12.5v-1a8 8 0 00-8-8h-1v1.4h1a6.6 6.6 0 016.6 6.6v1h1.4z"/>\n  <path class="small-icon-outline" d="M6.5 11a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z"/>\n  <path class="small-icon-outline" d="M9.5 11.5v1H8.1v-1a3.6 3.6 0 00-3.6-3.6h-1V6.5h1a5 5 0 015 5z"/>\n</svg>\n'},21287:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path ss="small-icon-fill" fill-rule="evenodd" clip-rule="evenodd" d="M14 2H2v12h12V2zm-1.5 10.5v-1a8 8 0 00-8-8h-1v1.4h1a6.6 6.6 0 016.6 6.6v1h1.4zm-6-1.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zm3 1.5v-1a5 5 0 00-5-5h-1v1.4h1a3.6 3.6 0 013.6 3.6v1h1.4z"/>\n  <path class="small-icon-outline" fill-rule="evenodd" clip-rule="evenodd" d="M1 3.154C1 1.964 1.964 1 3.154 1h9.692C14.036 1 15 1.964 15 3.154v9.692c0 1.19-.964 2.154-2.154 2.154H3.154A2.154 2.154 0 011 12.846V3.154zM3 2h10c.595 0 1 .405 1 1v10c0 .595-.405 1-1 1H3c-.595 0-1-.405-1-1V3c0-.595.405-1 1-1z"/>\n</svg>\n'},25650:e=>{e.exports='<svg height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M8.805 12h-5.805v-1h1v-7h-1v-1h5.866c.703 0 1.747.5 3.134 1.5l-.092 2.183c-.167.192-1.294.311-1.609.47.462.176 1.472 1.126 1.7 1.346v2c-.543.703-2.011 1.5-3.195 1.5zm-.644-1.042c.33 0 .566-.205.706-.615.088-.259.133-.573.133-.94 0-.619-.129-1.041-.387-1.265-.137-.12-.318-.18-.544-.18h-1.069v3zm-.077-3.941c.251 0 .447-.077.587-.231.22-.242.329-.677.329-1.305 0-.633-.117-1.059-.35-1.279-.132-.123-.327-.185-.587-.185h-1.063v3z" fill-rule="evenodd"/></svg>'},41028:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8.295 9.866l-.991.991c-.286.286-.67.444-1.081.444-.411 0-.794-.158-1.081-.444-.596-.596-.596-1.565 0-2.161l.991-.991-1.178-1.178-.991.991c-1.243 1.242-1.243 3.276 0 4.518.621.621 1.44.932 2.259.932s1.638-.311 2.259-.932l.991-.991-1.178-1.178M7.705 6.134l.991-.991c.286-.286.67-.444 1.081-.444.411 0 .794.158 1.081.444.286.286.444.67.444 1.081 0 .411-.158.794-.444 1.081l-.991.991 1.178 1.178.991-.991c1.242-1.242 1.242-3.276 0-4.518-.621-.621-1.44-.932-2.259-.932s-1.638.311-2.259.932l-.991.991 1.178 1.179"/></svg>\n'},22713:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path class="hl" d="M5 7.5l-4 3.5v-7z"/>\n  <g>\n    <path d="M2 2h3v1h-3zm4 0h8v1h-8zm.001 2h8v1h-8zm0 2h8v1h-8zM6.001 8h8v1h-8zm0 2h8v1h-8z"/>\n    <path d="M2 12h3v1h-3zm4 0h4v1h-4z"/>\n  </g>\n</svg>\n'},57842:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M4 1.5C4 1.22386 4.22386 1 4.5 1H11.5C11.7761 1 12 1.22386 12 1.5C12 1.77614 11.7761 2 11.5 2H4.5C4.22386 2 4 1.77614 4 1.5Z"/>\n  <path d="M7 10L5 8L3 12H13L10 6L7 10Z"/>\n  <path fill-rule="evenodd" d="M2 3H14C14.5523 3 15 3.44772 15 4V13C15 13.5523 14.5523 14 14 14H2C1.44772 14 1 13.5523 1 13V4C1 3.44772 1.44772 3 2 3ZM14 4H2V13H14L14 4Z"/>\n</svg>\n'},71360:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M6 2h8v1h-8zm0 5h8v1h-8zm0 5h8v1h-8z"/>\n  <g class="hl">\n    <path d="M3 2v-1h1v3h1v1h-3v-1h1v-1h-1v-1zm1 7h1v1h-3v-1h1v-1h1v1zm-2-3h2v1h-2v-1zm2 1h1v1h-1v-1zm0 5v1h-1v-1h-1v-1h3v1h-1zm0 1h1v1h-1v-1zm-2 1h2v1h-2v-1z"/>\n    <path opacity=".5" style="mix-blend-mode:multiply" d="M3 1h2v4h-2zm0 5h2v4h-2zm0 5h2v4h-2z"/>\n  </g>\n</svg>\n'},92636:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M6 2h8v1h-8zm0 5h8v1h-8zm0 5h8v1h-8z"/>\n  <g class="hl" transform="translate(2 1)">\n    <circle id="Oval" cx="1.5" cy="1.5" r="1.5"/>\n    <circle cx="1.5" cy="6.5" r="1.5"/>\n    <circle cx="1.5" cy="11.5" r="1.5"/>\n  </g>\n</svg>\n'},70773:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M7 11h2v1h-6v-1h2l3-7h-2v-1h6v1h-2z"/></svg>\n'},37362:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M2 2h12v1h-12zm1 2h10v1h-10zm-1 2h12v1h-12zM2 10h12v1h-12zm2-2h8v1h-8z"/><path d="M5 12h6v1h-6z"/></svg>\n'},76992:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M2 2h12v1h-12zm0 2h12v1h-12zm0 2h12v1h-12zm0 2h12v1h-12zm0 2h12v1h-12zm0 2h6v1h-6z"/></svg>\n'},41885:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M2 2h11v1h-11zm0 2h10v1h-10zm0 2h12v1h-12zm0 2h9v1h-9zm0 2h11v1h-11zm0 2h6v1h-6z"/></svg>\n'},7246:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M3 2h11v1h-11zm1 2h10v1h-10zM2 6h12v1h-12zm3 2h9v1h-9z"/><path d="M3 10h11v1h-11zm5 2h6v1h-6z"/></svg>\n'},10681:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M2 2h3v1h-3zm4 0h8v1h-8zm.001 2h8v1h-8zm0 2h8v1h-8zm0 2h8v1h-8zm0 2h8v1h-8zm-4.001 2h3v1h-3zm4 0h4v1h-4z"/><path class="hl" d="M1 7.5l4-3.5v7z"/></svg>\n'},54472:e=>{e.exports='<svg height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><path class="hl" d="M11.046 6.954c-.629-1.387-2.026-2.354-3.646-2.354-2.206 0-4 1.794-4 4s2.394 4 4.6 4v1.599c-3.093 0-6.2-2.507-6.2-5.599 0-3.094 2.507-5.6 5.6-5.6 2.06 0 3.86 1.112 4.832 2.768l1.768-1.768v5h-5z"/></svg>\n'},269:e=>{e.exports='<svg height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M13.923 3.854c.59-.851.476-2.296-.423-2.854-.902-.557-2.25-.017-2.842.834-.557.804-.53 2.076-.949 2.987-.541 1.176-2.627 1.026-4.709 0-1.144 2.095-2.424 4.639-4 6.467l1.498.928c.674-.109 1.509-.662 1.849-1.269-.027.729-.316 1.375-.885 1.865l2.831 1.748c.361-.34.698-.61 1.07-.84-.211.402-.352.828-.417 1.244l1.676 1.036c.993-1.803 2.924-4.59 4.274-6.171-1.867-1.42-2.421-3.085-1.413-4.034.725-.685 1.903-1.165 2.441-1.942zm-.805-2.155c.427.242.546.743.264 1.112-.276.373-.851.476-1.276.234-.429-.243-.547-.74-.267-1.112.278-.372.851-.477 1.279-.234zm-3.091 10.029l-5.445-3.366 1.07-1.543 5.443 3.366z" fill-rule="evenodd"/></svg>'},86721:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M5 13H7V4H6.32005C6.11005 4 5.88005 4.02 5.62005 4.05C5.36005 4.09 5.10005 4.19 4.84005 4.35C4.58005 4.51 4.34005 4.78 4.10005 5.13C3.86005 5.49 3.65005 5.98 3.47005 6.61H3.30005V3H12.69V6.61H12.52C12.35 5.98 12.14 5.49 11.9 5.13C11.66 4.78 11.41 4.52 11.14 4.35C10.88 4.19 10.62 4.08 10.36 4.05C10.1 4.01 9.87005 4 9.66005 4H9V13H11V14H5V13Z"/>\n  <path d="M14 8H2V9H14V8Z"/>\n</svg>\n'},65438:e=>{e.exports='<svg height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><g fill-rule="evenodd"><path d="M3 13h9v1h-9zM7.5 10.75l1.5-.75v-6h-1v-1h4v1h-1v6l-2 2h-3l-2-2v-6h-1v-1h4v1h-1v6z"/></g></svg>'},94537:e=>{e.exports='<svg height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><path class="hl" d="M3.768 5.768c.973-1.656 2.773-2.768 4.832-2.768 3.093 0 5.6 2.506 5.6 5.6 0 3.092-3.107 5.599-6.2 5.599v-1.599c2.206 0 4.6-1.794 4.6-4s-1.794-4-4-4c-1.619 0-3.017.967-3.646 2.354l2.046 2.046h-5v-5z"/></svg>\n'},61453:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M7.26579 2H8.50199L14 14H12.2038L10.5646 10.4651H5.33978L3.8099 14H2L7.26579 2ZM9.84747 8.94352L7.86682 4.61794L6.0296 8.94352H9.84747Z"/>\n</svg>\n'},80526:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<circle cx="13" cy="13" r="4.25" stroke="currentColor" stroke-width="1.5"/>\n<path d="M19.47 20.53a.75.75 0 1 0 1.06-1.06l-1.06 1.06zm-4-4 4 4 1.06-1.06-4-4-1.06 1.06z" fill="currentColor"/>\n</svg>\n'},4868:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M6.5 11C7.38054 11 8.20201 10.7471 8.89574 10.31L12.2929 13.7071C12.6834 14.0976 13.3166 14.0976 13.7071 13.7071C14.0976 13.3166 14.0976 12.6834 13.7071 12.2929L10.3099 8.89574C10.7471 8.20201 11 7.38054 11 6.5C11 4.01472 8.98528 2 6.5 2C4.01472 2 2 4.01472 2 6.5C2 8.98528 4.01472 11 6.5 11ZM6.5 9C7.88071 9 9 7.88071 9 6.5C9 5.11929 7.88071 4 6.5 4C5.11929 4 4 5.11929 4 6.5C4 7.88071 5.11929 9 6.5 9Z"/>\n</svg>\n'},5983:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M9.47244 10.3917C8.9108 10.7755 8.23162 11 7.5 11C5.567 11 4 9.433 4 7.5C4 5.567 5.567 4 7.5 4C9.433 4 11 5.567 11 7.5C11 8.23162 10.7755 8.9108 10.3917 9.47244L12.4596 11.5404C12.7135 11.7942 12.7135 12.2058 12.4596 12.4596C12.2058 12.7135 11.7942 12.7135 11.5404 12.4596L9.47244 10.3917ZM9.9 7.5C9.9 8.82548 8.82548 9.9 7.5 9.9C6.17452 9.9 5.1 8.82548 5.1 7.5C5.1 6.17452 6.17452 5.1 7.5 5.1C8.82548 5.1 9.9 6.17452 9.9 7.5Z"/>\n</svg>\n'},96676:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="selectbox-checkmark" viewBox="0 0 16 16">\n  <path d="M5.3 13.3L1.5 9.5 3 8l2.3 2.5L13 2.7 14.6 4l-8 8z"/>\n</svg>\n'},17183:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M13.207 5.707 6.5 12.5 2.646 8.646l.708-.707L6.5 11.086 12.5 5l.707.707z"/>\n</svg>\n'},45243:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M9.57087 9.63143H5.15509L4.85492 10.3844C4.408 11.4698 4.18788 12.182 4.18788 12.5144C4.18788 12.8672 4.30795 13.1385 4.54141 13.3217C4.78155 13.5048 5.08171 13.5998 5.45525 13.5998V14H2V13.5998C2.51362 13.5184 2.9005 13.3352 3.1473 13.0435C3.39411 12.7518 3.70094 12.1481 4.05447 11.2256C4.08116 11.1374 4.22123 10.7982 4.46804 10.2148L7.84992 2H8.18344L12.0656 11.3951L12.5992 12.6365C12.7193 12.9146 12.8794 13.1317 13.0862 13.2945C13.2863 13.4573 13.5931 13.5591 14 13.5998V14H9.4308V13.5998C9.99111 13.5998 10.3713 13.5591 10.5648 13.4709C10.7649 13.3895 10.8583 13.2199 10.8583 12.9689C10.8583 12.84 10.7248 12.4601 10.4647 11.8293L9.57087 9.63143ZM9.42412 9.23799L7.36965 4.19785L5.32185 9.23799H9.42412Z"/>\n</svg>\n'},28186:e=>{e.exports='<svg width="140" height="140" viewBox="0 0 140 140" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <g opacity="0.7">\n    <path opacity="0.2" fill-rule="evenodd" clip-rule="evenodd" d="M106.095 111.5H33.9051C43.5646 119.909 56.1877 125 70 125C83.8123 125 96.4354 119.909 106.095 111.5ZM124.854 65.9555L121 60L123.325 56.477C124.1 59.5422 124.618 62.7098 124.854 65.9555ZM112.428 35C102.34 22.785 87.0794 15 70 15C52.9206 15 37.6595 22.785 27.5716 35H112.428ZM16.2877 58.1141C15.4445 61.9418 15 65.919 15 70C15 75.7276 15.8755 81.2507 17.5 86.4429V60L16.2877 58.1141Z" fill="var(--colorFgFadedMost)"/>\n    <path opacity="0.4" fill-rule="evenodd" clip-rule="evenodd" d="M106.095 111.5C96.4354 119.909 83.8123 125 70 125C56.1877 125 43.5646 119.909 33.9051 111.5H30.9261C41.1295 121.111 54.877 127 70 127C85.123 127 98.8705 121.111 109.074 111.5H106.095ZM124.829 65.6309L126.988 68.8055C126.884 63.7654 126.126 58.886 124.796 54.2488L123.325 56.477C124.074 59.4399 124.583 62.4985 124.829 65.6309ZM27.5716 35C37.6595 22.785 52.9206 15 70 15C87.0794 15 102.34 22.785 112.428 35H114.992C104.562 21.6113 88.2866 13 70 13C51.7134 13 35.438 21.6113 25.0078 35H27.5716ZM16.2877 58.1141L14.7878 55.781C13.6207 60.3262 13 65.0906 13 70C13 77.8888 14.6026 85.4033 17.5 92.2357V86.4429C15.8755 81.2507 15 75.7276 15 70C15 65.919 15.4445 61.9418 16.2877 58.1141Z" fill="var(--colorFgFadedMost)"/>\n    <path opacity="0.45" d="M94.423 58.5L79.7344 36H135.531L120.849 58.5H94.423Z" fill="var(--colorFgFadedMost)"/>\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M0 34H76.0317H78.4204H139.227L122.327 59.8782L135.169 79.3482C136.484 81.3428 135.054 84 132.664 84H122.379V104.5C122.379 108.366 119.245 111.5 115.379 111.5H92.8792L24.3792 111.5C20.5132 111.5 17.3792 108.366 17.3792 104.5V59.8054L0 34ZM120.879 82H132.664C133.461 82 133.938 81.1143 133.499 80.4494L120.341 60.5H95.7366L108.435 79.753C109.361 81.1558 110.929 82 112.609 82L120.879 82ZM94.8792 109.5V62.8324L106.766 80.8542C108.061 82.8181 110.257 84 112.609 84H120.379V104.5C120.379 107.261 118.141 109.5 115.379 109.5H94.8792ZM19.3792 60.5H92.8792V109.5H24.3792C21.6177 109.5 19.3792 107.261 19.3792 104.5V60.5ZM18.9113 58.5H92.0317L77.3378 36H3.75821L18.9113 58.5ZM94.4206 58.5L79.7266 36H135.532L120.838 58.5H94.4206Z" fill="var(--colorFgFadedMost)"/>\n    <path d="M49 86H80" stroke="var(--colorFgFadedMost)" stroke-width="2" stroke-linecap="round"/>\n    <path d="M49 92H80" stroke="var(--colorFgFadedMost)" stroke-width="2" stroke-linecap="round"/>\n    <path d="M49 98H65" stroke="var(--colorFgFadedMost)" stroke-width="2" stroke-linecap="round"/>\n    <path opacity="0.45" d="M94.8799 109.5L94.88 62.7L106.923 80.8677C108.22 82.8238 110.411 84 112.758 84H120.359V104.5C120.359 107.261 118.121 109.5 115.359 109.5H94.8799Z" fill="var(--colorFgFadedMost)"/>\n    <circle opacity="0.2" cx="35.5" cy="91.75" r="3" fill="var(--colorFgFadedMost)"/>\n    <path d="M28.75 92.25V90C28.75 87.7909 30.5409 86 32.75 86H37.25C39.4591 86 41.25 87.7909 41.25 90V94C41.25 96.2091 39.4591 98 37.25 98H28.5M28.5 98L31 95.5M28.5 98L31 100.5" stroke="var(--colorFgFadedMost)" stroke-width="2" stroke-linecap="round"/>\n  </g>\n</svg>\n'},21956:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <circle opacity="0.3" cx="9.5" cy="6.5" r="3"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.50001 1C5.01473 1 3.00001 3.01472 3.00001 5.5V8C3.00001 8.27614 2.77616 8.5 2.50001 8.5C2.22387 8.5 2.00001 8.27614 2.00001 8V5.5C2.00001 2.46243 4.46245 0 7.50001 0H10.5C13.5376 0 16 2.46243 16 5.5V7.5C16 10.5376 13.5376 13 10.5 13H3.70712L5.35357 14.6464C5.54883 14.8417 5.54883 15.1583 5.35357 15.3536C5.15831 15.5488 4.84172 15.5488 4.64646 15.3536L2.14646 12.8536L1.79291 12.5L2.14646 12.1464L4.64646 9.64645C4.84172 9.45118 5.15831 9.45118 5.35357 9.64645C5.54883 9.84171 5.54883 10.1583 5.35357 10.3536L3.70712 12H10.5C12.9853 12 15 9.98528 15 7.5V5.5C15 3.01472 12.9853 1 10.5 1H7.50001Z"/>\n</svg>\n'},16761:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.892 2.298a.5.5 0 01.707 0l1.085 1.086a.5.5 0 010 .707l-.939.94-1.793-1.793.94-.94zm1.414-.707a1.5 1.5 0 00-2.122 0L8.892 2.884l-.354.354.354.353 2.5 2.5.353.354.354-.354 1.293-1.293a1.5 1.5 0 000-2.12L12.306 1.59zM2 9.776v3.207h3.207l5.855-5.855-3.208-3.207L2 9.776zM3 12v-1.852l4.854-4.812 1.793 1.792L4.834 12H3z"/><path d="M2 14h10v1H2z"/></svg>\n'},71665:e=>{e.exports='<svg opacity=".7" fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 140 126" width="140" height="126">\n  <circle opacity=".2" cx="67" cy="63" r="55" fill="var(--colorFgFadedMost)"/>\n  <circle opacity=".2" cx="67" cy="63" r="59" stroke="var(--colorFgFadedMost)" stroke-width="2" stroke-dasharray="6 6"/>\n  <rect x="12" y="21" width="111" height="77" rx="4" fill="var(--colorBg)" stroke="var(--colorFgFadedMost)" stroke-width="2"/>\n  <path d="M4 98h128v1a6 6 0 0 1-6 6H10a6 6 0 0 1-6-6v-1Z" fill="var(--colorBgDark)" stroke="var(--colorFgFadedMost)" stroke-width="2"/>\n  <rect x="100" y="42" width="36" height="70" rx="4" fill="var(--colorBgDarker)" stroke="var(--colorFgFadedMost)" stroke-width="2"/>\n  <rect x="111" y="45" width="15" height="3" rx="1.5" fill="var(--colorFgFadedMost)"/>\n  <path d="M31.25 79.005V68.25a2 2 0 0 1 2-2h5.5a2 2 0 0 1 2 2v10.755a.25.25 0 0 1-.398.202L36 76l-4.352 3.207a.25.25 0 0 1-.398-.202Z" stroke="var(--colorFgFadedMore)" stroke-width="1.5"/>\n  <path d="M67.75 66.25h-6.5a2 2 0 0 0-2 2v9.5a2 2 0 0 0 2 2h5.5a2 2 0 0 0 2-2v-.25" stroke="var(--colorFgFadedMore)" stroke-width="1.5" stroke-linecap="round"/>\n  <path d="M63.75 76.25v-2l5.74-5.74a1.427 1.427 0 0 1 2.038 2L66 76.25h-2.25Z" stroke="var(--colorFgFadedMore)" stroke-width="1.5"/>\n  <path stroke="var(--colorFgFadedMore)" d="m68.354 70.646 2 2"/>\n  <path d="M29.75 38.75h4.75a1.5 1.5 0 0 1 1.5 1.5v9a1 1 0 0 1-1 1h-5.25a1 1 0 0 1-1-1v-9.5a1 1 0 0 1 1-1ZM37.5 38.752h4.75a1 1 0 0 1 1 1v9.498a1 1 0 0 1-1 1H37a1 1 0 0 1-1-1v-8.998a1.5 1.5 0 0 1 1.5-1.5ZM35 50.25c.333.566 1.2 1.358 2 0" stroke="var(--colorFgFadedMore)" stroke-width="1.5"/>\n  <path opacity=".35" stroke="var(--colorFgFadedMore)" stroke-linecap="round" d="M31 41.5h3M38 41.5h3M31 43.5h3M38 43.5h3M31 45.5h3M38 45.5h3M31 47.5h3M38 47.5h3"/>\n  <path d="M64.5 39.25h-4.25a2 2 0 0 0-2 2v7.5a2 2 0 0 0 2 2h7.5a2 2 0 0 0 2-2V46.5" stroke="var(--colorFgFadedMore)" stroke-width="1.5" stroke-linecap="round"/>\n  <path d="m61.5 43.5 3 3 6-8" stroke="var(--colorFgFadedMore)" stroke-width="1.5" stroke-linecap="round"/>\n  <path d="M123.996 72.172A2.998 2.998 0 0 1 122.99 78h-9.98a3.006 3.006 0 0 1-3.01-3c0-1.314.84-2.43 2.022-2.836a2.5 2.5 0 0 1 4.198-1.478A4.004 4.004 0 0 1 120 68c2.21 0 4 1.79 4 4l-.004.172Z" fill="var(--colorFg)"/>\n</svg>\n'},67651:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2 12v1.857S2 15 3.077 15h9.846S14 15 14 13.857V12h-1v1.857c0 .064-.007.1-.012.12A.289.289 0 0112.9 14H3.077c-.017 0-.03 0-.04-.002A.485.485 0 013 13.841V12H2zM7 7H4l4 2.698L11.935 7H9V2H7v5zm1 4L2.935 7.415C2.361 6.935 2.7 6 3.448 6H6V2a1 1 0 011-1h2a1 1 0 011 1v4h2.488c.748 0 1.087.936.512 1.415L8 11z"/></svg>\n'},87710:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.5 7a.501.501 0 00-.502.5v7c0 .274.224.5.502.5h11a.501.501 0 00.502-.5v-7c0-.274-.224-.5-.502-.5h-11zm-1.498.5c0-.83.672-1.5 1.498-1.5h11a1.5 1.5 0 011.498 1.5v7A1.5 1.5 0 0113.5 16h-11a1.5 1.5 0 01-1.498-1.5v-7z"/><path fill-rule="evenodd" clip-rule="evenodd" d="M8 1a3 3 0 00-3.002 3v2.5a.5.5 0 11-.996 0V4a4 4 0 117.996 0v2.5a.5.5 0 11-.996 0V4A3 3 0 008 1zM8 10a1 1 0 10-.002 2.002A1 1 0 008 10zm-1.998 1A2 2 0 1110 10.998 2 2 0 016.002 11z"/></svg>\n'},21922:e=>{e.exports='<svg width="17" height="16" xmlns="http://www.w3.org/2000/svg"><path d="M5 6h7v1H5V6zM5 8h7v1H5V8zM5 10h7v1H5v-1z"/><path fill-rule="evenodd" clip-rule="evenodd" d="M3 4a2 2 0 012-2h7a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V4zm2.2 0A1.2 1.2 0 004 5.2v7.6A1.2 1.2 0 005.2 14h6.6a1.2 1.2 0 001.2-1.2V5.2A1.2 1.2 0 0011.8 4H5.2z"/></svg>\n'},25382:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M19.25 14.5v.335l.25.224 1.622 1.452-1.334 2.187-1.685-.663-.38-.15-.332.238c-.41.294-.823.494-1.3.721l-.353.17-.063.385-.306 1.851h-2.635l-.416-1.89-.079-.357-.33-.159c-.477-.227-.89-.427-1.3-.721l-.332-.238-.38.15-1.685.663-1.321-2.167 1.498-1.147.295-.225v-2.318l-.295-.225-1.498-1.147 1.32-2.167 1.686.663.304.12.294-.14c.268-.129.528-.285.755-.42l.013-.008a8.21 8.21 0 0 1 .646-.362l.352-.168.064-.386.306-1.851h2.62l.306 1.851.064.386.352.168c.477.228.89.428 1.3.722l.332.238.38-.15 1.685-.663 1.324 2.17-1.458 1.15-.286.225V14.5z" stroke="currentColor" stroke-width="1.5"/>\n  <circle cx="14" cy="14" r="1.5" stroke="currentColor"/>\n</svg>\n'},62675:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M9.99999 8C9.99999 9.10457 9.10456 10 7.99999 10C6.89542 10 5.99999 9.10457 5.99999 8C5.99999 6.89543 6.89542 6 7.99999 6C9.10456 6 9.99999 6.89543 9.99999 8ZM8.99999 8C8.99999 8.55228 8.55227 9 7.99999 9C7.4477 9 6.99999 8.55228 6.99999 8C6.99999 7.44772 7.4477 7 7.99999 7C8.55227 7 8.99999 7.44772 8.99999 8Z"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M6.50546 0.5C6.32854 0.5 6.14679 0.570922 6.00834 0.676865C5.86445 0.786974 5.71486 0.977906 5.69784 1.24507L5.43462 2.83971C5.2906 2.91839 5.15118 3.00174 5.02158 3.07923L5.01204 3.08493C4.87369 3.16764 4.74588 3.24385 4.62293 3.31104L2.99288 2.66901H2.89796L2.88745 2.66892C2.78672 2.66775 2.30173 2.66209 2.05177 3.11738L0.63919 5.43371C0.442282 5.67614 0.499334 5.96375 0.544761 6.09411C0.599954 6.25249 0.699423 6.39174 0.800138 6.48808L0.820033 6.50711L2.19182 7.55684V8.44281L0.820033 9.49289L0.800138 9.51192L0.79149 9.52008C0.747288 9.56155 0.623866 9.67736 0.555623 9.84055C0.461447 10.0658 0.49362 10.2965 0.599567 10.4992L0.60721 10.5139L2.0506 12.8807C2.10748 12.9879 2.21372 13.1676 2.40428 13.277C2.64912 13.4175 2.90092 13.3787 3.09487 13.2908L4.58788 12.7028C4.88321 12.8928 5.17464 13.042 5.45104 13.1762L5.80132 14.7677C5.8121 14.9365 5.8687 15.1321 6.031 15.2874C6.20998 15.4586 6.4338 15.5 6.60853 15.5H9.49452C9.67144 15.5 9.85319 15.4291 9.99164 15.3231C10.1355 15.213 10.2851 15.0221 10.3021 14.7549L10.5639 13.1689C10.8359 13.0366 11.1221 12.8894 11.4121 12.7028L13.0071 13.331H13.102L13.1125 13.3311C13.2133 13.3323 13.6983 13.3379 13.9482 12.8826L15.3608 10.5663C15.5577 10.3239 15.5006 10.0362 15.4552 9.90589C15.4 9.74751 15.3006 9.60826 15.1998 9.51192L15.1938 9.50619L13.75 8.21398V7.55242L15.0795 6.50463L15.0968 6.48808L15.1054 6.47992C15.1496 6.43845 15.273 6.32264 15.3413 6.15945C15.4355 5.93424 15.4033 5.70346 15.2973 5.50077L15.2897 5.48615L13.8463 3.1193C13.7894 3.01213 13.6832 2.8324 13.4926 2.72304C13.2478 2.58252 12.996 2.62133 12.802 2.70918L11.309 3.29723C11.019 3.11064 10.7328 2.96338 10.4609 2.83108L10.1995 1.24789C10.1913 1.07563 10.1363 0.872686 9.96898 0.712626C9.79 0.54143 9.56618 0.5 9.39145 0.5H6.50546ZM6.6693 1.5H9.22761L9.559 3.50762L9.79415 3.62008C10.21 3.81899 10.5839 3.99897 10.9553 4.26542L11.1766 4.42418L13.0264 3.69557L14.3255 5.82565L12.75 7.0673V8.66102L14.4329 10.1672L13.1295 12.3044L11.2796 11.5758L11.0583 11.7346C10.6869 12.001 10.3131 12.181 9.89722 12.3799L9.66208 12.4924L9.33068 14.5H6.76633L6.32289 12.4852L6.10276 12.3799C5.68686 12.181 5.31304 12.001 4.94163 11.7346L4.72034 11.5758L2.87046 12.3044L1.57259 10.1762L3.19182 8.93712V7.06288L1.57259 5.82379L2.87046 3.69557L4.6695 4.40415L4.8659 4.31022C5.09309 4.20156 5.316 4.0683 5.51564 3.94894L5.52517 3.94324C5.73539 3.81756 5.92128 3.70687 6.10276 3.62008L6.3379 3.50762L6.6693 1.5Z"/>\n</svg>\n'},89052:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M8.992 3.823l-.208-1.823h-1.571l-.213 1.823-.558.219c-.397.156-.765.37-1.095.633l-.469.374-1.687-.728-.786 1.361 1.475 1.092-.088.594c-.031.206-.046.417-.046.632 0 .224.017.444.05.658l.088.57-1.439 1.159.727 1.259 1.706-.698.46.369c.338.271.717.491 1.127.649l.539.208.284 1.825h1.454l.248-1.825.549-.214c.405-.158.78-.376 1.115-.645l.46-.369 1.706.698.727-1.259-1.439-1.159.088-.57c.033-.214.05-.434.05-.658 0-.215-.016-.426-.046-.632l-.088-.594 1.475-1.092-.786-1.361-1.687.728-.469-.374c-.329-.262-.696-.476-1.093-.632l-.559-.22zm-5.948-.654c-.171-.099-.354.021-.402.106l-1.418 2.457c-.098.169-.061.303.11.401l1.471 1.088c-.038.254-.057.514-.057.779 0 .276.021.547.062.811l-1.423 1.147c-.171.099-.207.232-.11.401l1.342 2.325c.049.085.232.204.402.106l1.692-.693c.417.334.886.607 1.393.802l.281 1.805c0 .197.098.296.293.296h2.684c.098 0 .293-.099.293-.296l.246-1.811c.501-.195.965-.466 1.378-.797l1.693.693c.171.099.354-.021.402-.106l1.342-2.325c.098-.169.061-.303-.11-.401l-1.423-1.147c.041-.264.062-.535.062-.811 0-.265-.02-.525-.057-.779l1.471-1.088c.171-.099.207-.232.11-.401l-1.418-2.457c-.049-.084-.232-.204-.402-.106l-1.68.725c-.405-.324-.86-.588-1.35-.781l-.207-1.817c0-.197-.098-.296-.293-.296h-2.837c-.098 0-.293.099-.293.296l-.212 1.816c-.491.193-.946.458-1.352.782l-1.68-.725zM8 9c.552 0 1-.448 1-1s-.448-1-1-1-1 .448-1 1 .448 1 1 1zm0 1c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z"/>\n</svg>\n'},78754:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M8.376.17a.5.5 0 0 0-.752 0l-3.5 4A.5.5 0 0 0 4.5 5H6v5.5a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5V5h1.5a.5.5 0 0 0 .376-.83l-3.5-4ZM6.5 4h-.898L8 1.26 10.398 4H9.5a.5.5 0 0 0-.5.5V10H7V4.5a.5.5 0 0 0-.5-.5ZM2 7.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 0 0-1h-1A1.5 1.5 0 0 0 1 7.5v7A1.5 1.5 0 0 0 2.5 16h11a1.5 1.5 0 0 0 1.5-1.5v-7A1.5 1.5 0 0 0 13.5 6h-1a.5.5 0 0 0 0 1h1a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-7Z"/>\n</svg>\n'},15275:e=>{e.exports='<svg width="28" height="28" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="m7.234 21.848.383-.924A.994.994 0 0 0 8 21h1v1H8c-.271 0-.53-.054-.766-.152zM19 22v-1h1a.994.994 0 0 0 .383-.076l.383.924A1.994 1.994 0 0 1 20 22h-1zm3-13h-1V8a.994.994 0 0 0-.076-.383l.924-.383c.098.236.152.495.152.766v1zM9 6H8c-.271 0-.53.054-.766.152l.383.923A.994.994 0 0 1 8 7h1V6zM6 19h1v1c0 .137.027.266.075.383l-.923.383A1.994 1.994 0 0 1 6 20v-1zm0-2h1v-2H6v2zm0-4h1v-2H6v2zm0-4h1V8c0-.137.027-.266.075-.383l-.923-.383A1.994 1.994 0 0 0 6 8v1zm5-3v1h2V6h-2zm4 0v1h2V6h-2zm4 0v1h1c.137 0 .266.027.383.075l.383-.923A1.994 1.994 0 0 0 20 6h-1zm3 5h-1v2h1v-2zm0 4h-1v2h1v-2zm0 4h-1v1a.994.994 0 0 1-.076.383l.924.383c.098-.236.152-.495.152-.766v-1zm-5 3v-1h-2v1h2zm-4 0v-1h-2v1h2z" fill="currentColor"/>\n</svg>\n'},19713:e=>{e.exports='<svg width="28" height="28" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="m7.234 21.848.383-.924A.994.994 0 0 0 8 21h1v1H8c-.271 0-.53-.054-.766-.152zM19 22v-1h1a.994.994 0 0 0 .383-.076l.383.924A1.994 1.994 0 0 1 20 22h-1zm3-13h-1V8a.994.994 0 0 0-.076-.383l.924-.383c.098.236.152.495.152.766v1zM9 6H8c-.271 0-.53.054-.766.152l.383.923A.994.994 0 0 1 8 7h1V6zM6 19h1v1c0 .137.027.266.075.383l-.923.383A1.994 1.994 0 0 1 6 20v-1zm0-2h1v-2H6v2zm0-4h1v-2H6v2zm0-4h1V8c0-.137.027-.266.075-.383l-.923-.383A1.994 1.994 0 0 0 6 8v1zm5-3v1h2V6h-2zm4 0v1h2V6h-2zm4 0v1h1c.137 0 .266.027.383.075l.383-.923A1.994 1.994 0 0 0 20 6h-1zm3 5h-1v2h1v-2zm0 4h-1v2h1v-2zm0 4h-1v1a.994.994 0 0 1-.076.383l.924.383c.098-.236.152-.495.152-.766v-1zm-5 3v-1h-2v1h2zm-4 0v-1h-2v1h2z" fill="currentColor"/>\n  <path d="M10.833 9h-.458C9.615 9 9 9.672 9 10.5v7c0 .828.616 1.5 1.375 1.5h.458v-1c-.506 0-.916-.448-.916-1v-6c0-.552.41-1 .916-1V9zm6.334 9v1h.458c.76 0 1.375-.672 1.375-1.5v-7c0-.828-.616-1.5-1.375-1.5h-.458v1c.506 0 .916.448.916 1v6c0 .552-.41 1-.916 1z" fill="currentColor"/>\n</svg>\n'},63267:e=>{e.exports='<svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M4 1V7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n  <path d="M1 4H7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n</svg>\n'},42822:e=>{e.exports='<svg viewBox="0 0 8 8" version="1.1" xmlns="http://www.w3.org/2000/svg">\n  <polygon points="0 3 0 5 8 5 8 3" />\n</svg>\n'},92800:e=>{e.exports='<svg viewBox="0 0 110 4" xmlns="http://www.w3.org/2000/svg">\n  <path d="M44 2.011c1.1-.011 2.2 1.989 3.3 1.989h62.7v-4l-110 .018v1.993s43.703.003 44 0z" class="folder-tab-color"/>\n</svg>\n'},23641:e=>{e.exports='<svg viewBox="0 0 110 90" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none">\n  <g>\n    <path class="folderoutline" fill="url(#sd-folder-gradient)" d="M0 0h110v90h-110z" />\n    <path class="folder-tab-color" d="M44 2.011c1.1-.011 2.2 1.989 3.3 1.989h62.7v-4l-110 .018v1.993s43.703.003 44 0z" />\n  </g>\n</svg>\n'},82474:e=>{e.exports='<svg class="spinner" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path class="spinner-part1" d="M8 5c-.6 0-1-.4-1-1V1c0-.5.4-1 1-1 .5 0 1 .4 1 1v3c0 .6-.4 1-1 1z"/>\n  <path class="spinner-part2" d="M13.7 3.7L11.5 6c-.4.3-1 .3-1.4 0-.3-.5-.3-1 0-1.5l2.3-2.2c.4-.4 1-.4 1.4 0 .4.4.4 1 0 1.4z"/>\n  <path class="spinner-part3" d="M15 9h-3c-.5 0-1-.4-1-1 0-.5.4-1 1-1h3c.5 0 1 .4 1 1s-.4 1-1 1z"/>\n  <path class="spinner-part4" d="M13.7 13.6c-.4.4-1 .4-1.4 0L10 11.4c-.3-.4-.3-1 0-1.4.5-.4 1-.4 1.5 0l2.2 2.2c.4.4.4 1 0 1.4z"/>\n  <path class="spinner-part5" d="M8 16c-.6 0-1-.4-1-1v-3c0-.5.4-1 1-1 .5 0 1 .4 1 1v3c0 .6-.4 1-1 1z"/>\n  <path class="spinner-part6" d="M6 11.5l-2.3 2.2c-.4.4-1 .4-1.4 0-.4-.4-.4-1 0-1.4L4.5 10c.4-.3 1-.3 1.4 0 .3.5.3 1 0 1.5z"/>\n  <path class="spinner-part7" d="M4 9H1c-.6 0-1-.4-1-1 0-.5.4-1 1-1h3c.5 0 1 .4 1 1s-.4 1-1 1z"/>\n  <path class="spinner-part8" d="M6 6c-.5.3-1 .3-1.5 0L2.3 3.6c-.4-.4-.4-1 0-1.4.4-.4 1-.4 1.4 0L6 4.5c.3.4.3 1 0 1.4z"/>\n</svg>\n'},86484:e=>{e.exports='<svg width="196" height="32" xmlns="http://www.w3.org/2000/svg">\n  <rect class="border" x=".5" y=".5" width="195" height="31" rx="1.5" />\n  <path class="highlight" fill-rule="evenodd" d="M109 13h-8v8h8v-8zm-9-1v10h10V12h-10z"/>\n  <path fill-rule="evenodd" d="M9 9H1v16h8V9zM0 8v18h10V8H0z" class="border"/>\n  <path class="highlight" d="M12 25V6h1v19z"/>\n  <path class="highlight" fill-rule="evenodd" d="M177 25V7H12V6h173v19h10v1H93V9H15v17H1v-1h13V8h80v17h2V8h80v17h1zM97 9h78v16H97V9zm-79 4h8v8h-8v-8zm-1 9V12h10v10H17zm165-8.598L179 16l3 2.598v-5.196z"/>\n</svg>\n'},18998:e=>{e.exports='<svg width="196" height="32" xmlns="http://www.w3.org/2000/svg">\n  <rect x=".5" y=".5" width="195" height="31" rx="1.5" class="border"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M1 9h8v16H1V9zM0 26V8h10v18H0zM177 9H97v16h80V9zM96 8v18h82V8H96zm13 5h-8v8h8v-8zm-9-1v10h10V12h-10z"/>\n  <path class="highlight" fill-rule="evenodd" clip-rule="evenodd" d="M25 13h-8v8h8v-8zm-9-1v10h10V12H16z"/>\n  <path class="highlight" fill-rule="evenodd" clip-rule="evenodd" d="M13 9h80v17h1V8H12v18h1V9z"/>\n  <path class="highlight" d="M94 25h101v1H94zM1 25h11v1H1zM13 5h26v3H13zM40 5h26v2H40zM67 5h26v2H67z"/>\n</svg>\n'},86681:e=>{e.exports='<svg width="196" height="48" xmlns="http://www.w3.org/2000/svg">\n  <path class="border" d="M2 .5h192a1.5 1.5 0 011.5 1.5v44a1.5 1.5 0 01-1.5 1.5H2A1.5 1.5 0 01.5 46V2A1.5 1.5 0 012 .5z"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M4 28h80v16H4V28zM3 45V27h82v18H3zm5-13h8v8H8v-8zm-1 9V31h10v10H7zm161-13H88v16h80V28zm-81-1v18h82V27H87zm5 5h8v8h-8v-8zm-1 9V31h10v10H91zm93-9h-8v8h8v-8zm-9-1v10h10V31h-10zm-4-4h24v1h-23v16h23v1h-24V27z" class="highlight"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M9 8H1v16h8V8zM0 7v18h10V7H0z"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M25 12h-8v8h8v-8zm-9-1v10h10V11H16z" class="highlight"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M97 8h80v16H97V8zm-1 17V7h82v18H96zm5-13h8v8h-8v-8zm-1 9V11h10v10h-10z"/>\n  <path class="highlight" d="M93 24h103v1H93z"/>\n  <path class="highlight" d="M1 24h12v1H1z"/>\n  <g class="default-style">\n    <path fill-rule="evenodd" clip-rule="evenodd" class="highlight" d="M92 9H14v14h78V9zM14 7a2 2 0 00-2 2v14a2 2 0 002 2h78a2 2 0 002-2V9a2 2 0 00-2-2H14z"/>\n    <path opacity=".25" d="M90 11H80v10h10V11z" class="highlight"/>\n  </g>\n  <g class="dotted-style">\n    <path d="M39 4H13V7H12V25H13V8H93V25H94V7H39V4Z" class="highlight"/>\n    <path d="M66 4H40V6H66V4Z" class="highlight"/>\n    <path d="M67 4H93V6H67V4Z" class="highlight"/>\n  </g>\n</svg>\n'},95331:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M3 2C2.44772 2 2 2.44772 2 3V6C2 6.55228 2.44772 7 3 7H6C6.55228 7 7 6.55228 7 6V3C7 2.44772 6.55228 2 6 2H3ZM3 3H6V6H3V3Z"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M2 10C2 9.44771 2.44772 9 3 9H6C6.55228 9 7 9.44771 7 10V13C7 13.5523 6.55228 14 6 14H3C2.44772 14 2 13.5523 2 13V10ZM6 10H3V13H6V10Z"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M9 10C9 9.44771 9.44771 9 10 9H13C13.5523 9 14 9.44771 14 10V13C14 13.5523 13.5523 14 13 14H10C9.44771 14 9 13.5523 9 13V10ZM13 10H10V13H13V10Z"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M9 3C9 2.44772 9.44771 2 10 2H13C13.5523 2 14 2.44772 14 3V6C14 6.55228 13.5523 7 13 7H10C9.44771 7 9 6.55228 9 6V3ZM13 3H10V6H13V3Z"/>\n</svg>\n'},23942:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M9 5h2v2h-2z"/>\n  <path fill-opacity=".35" d="M5 1h2v2h-2v-2zm4 0h2v2h-2v-2zm4 0h2v2h-2v-2zm-12 4h2v2h-2v-2zm4 0h2v2h-2v-2zm8 0h2v2h-2v-2zm-12 4h2v2h-2v-2zm4 0h2v2h-2v-2zm4 0h2v2h-2v-2zm4 0h2v2h-2v-2zm-12 4h2v2h-2v-2zm4 0h2v2h-2v-2zm4 0h2v2h-2v-2z"/>\n  <path fill-opacity=".1" d="M5 5h-4v10h10v-4h4v-10h-10z"/>\n</svg>\n'},25531:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M9 1.288a1 1 0 00-1 0L2.5 4.461a1 1 0 00-.5.867v6.344a1 1 0 00.5.867L8 15.712a1 1 0 001 0l5.5-3.173a1 1 0 00.5-.867V5.328a1 1 0 00-.5-.867L9 1.288zM7.004 5.825A.75.75 0 017.75 5h1.343a.75.75 0 01.746.825l-.35 3.5a.75.75 0 01-.746.675H8.1a.75.75 0 01-.746-.675l-.35-3.5zm.417 5.925a.75.75 0 01.75-.75h.5a.75.75 0 01.75.75v.5a.75.75 0 01-.75.75h-.5a.75.75 0 01-.75-.75v-.5z"/></svg>\n'},32783:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg"><path d="M1 11V5h1.935l1.936 2.206L6.806 5h1.936v6H6.806V7.559L4.871 9.765 2.935 7.559V11H1zM13.097 11l-2.903-2.912h1.935V5h1.936v3.088H16L13.097 11z"/></svg>\n'},75124:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M12.125 2.344a7 7 0 101.44 1.408L7.918 11.03a1 1 0 01-1.44.147.998.998 0 01-.345-.288L4.32 8.499A1 1 0 115.913 7.29l1.175 1.548 5.037-6.494z"/></svg>\n'},39135:e=>{e.exports='<svg width="9" height="5" viewBox="0 0 9 5" xmlns="http://www.w3.org/2000/svg">\r\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M4.5 5L0.865676 1.36568C0.361706 0.86171 0.718646 0 1.43137 0H7.5686C8.2814 0 8.6383 0.86171 8.1343 1.36569L4.5 5Z"/>\r\n</svg>\r\n'},62525:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n      <path d="M12.6 7C9.507 7 7 9.506 7 12.6h1.6c0-2.206 1.794-4 4-4s4 1.794 4 4-1.794 4-4 4c-1.29 0-2.425-.623-3.157-1.573H7.56c.905 1.875 2.818 3.172 5.04 3.172 3.093 0 5.6-2.508 5.6-5.6 0-3.094-2.507-5.6-5.6-5.6"/>\n      <path d="M13 13H7V7l6 6z"/>\n</svg>'},76667:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M.784 13.53L7.118 1.653a1 1 0 011.764 0l6.334 11.875A1 1 0 0114.333 15H1.667a1 1 0 01-.883-1.47zm5.799-7.705A.75.75 0 017.329 5H8.67a.75.75 0 01.747.825l-.35 3.5A.75.75 0 018.32 10H7.68a.75.75 0 01-.746-.675l-.35-3.5zM7 11.75a.75.75 0 01.75-.75h.5a.75.75 0 01.75.75v.5a.75.75 0 01-.75.75h-.5a.75.75 0 01-.75-.75v-.5z"/></svg>\n'},39414:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M19.996 13.172C21.164 13.585 22 14.697 22 16C22 17.657 20.663 19 18.99 19H9.01C7.346 19 6 17.653 6 16C6 14.686 6.84 13.57 8.022 13.164C8.187 11.942 9.232 11 10.5 11C11.167 11 11.772 11.26 12.22 11.686C12.765 10.123 14.25 9 16 9C18.21 9 20 10.79 20 13L19.996 13.172Z" fill="currentColor"/>\n</svg>\n'},5843:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M19.2465 13.3376C20.2685 13.668 21 14.5576 21 15.6C21 16.9256 19.8301 18 18.3662 18H9.63375C8.17775 18 7 16.9224 7 15.6C7 14.5488 7.735 13.656 8.76925 13.3312C8.91363 12.3536 9.828 11.6 10.9375 11.6C11.5211 11.6 12.0505 11.808 12.4425 12.1488C12.9194 10.8984 14.2188 10 15.75 10C17.6838 10 19.25 11.432 19.25 13.2L19.2465 13.3376Z" stroke="currentColor" stroke-width="1.5"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M12 15C12 15.5523 11.5523 16 11 16C10.4477 16 10 15.5523 10 15C10 14.4477 10.4477 14 11 14C11.5523 14 12 14.4477 12 15ZM15 15C15 15.5523 14.5523 16 14 16C13.4477 16 13 15.5523 13 15C13 14.4477 13.4477 14 14 14C14.5523 14 15 14.4477 15 15ZM17 16C17.5523 16 18 15.5523 18 15C18 14.4477 17.5523 14 17 14C16.4477 14 16 14.4477 16 15C16 15.5523 16.4477 16 17 16Z" fill="currentColor"/>\n</svg>\n'},30249:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M5 10C5.55228 10 6 9.55228 6 9C6 8.44772 5.55228 8 5 8C4.44772 8 4 8.44772 4 9C4 9.55228 4.44772 10 5 10Z"/>\n  <path d="M8 10C8.55228 10 9 9.55228 9 9C9 8.44772 8.55228 8 8 8C7.44772 8 7 8.44772 7 9C7 9.55228 7.44772 10 8 10Z"/>\n  <path d="M12 9C12 9.55228 11.5523 10 11 10C10.4477 10 10 9.55228 10 9C10 8.44772 10.4477 8 11 8C11.5523 8 12 8.44772 12 9Z"/>\n  <path fill-rule="evenodd" d="M6.06137 4.79152C6.88693 3.69117 8.2498 3 9.75 3C11.971 3 13.9354 4.53945 14.2158 6.67358C15.2565 7.2517 16 8.31987 16 9.6C16 11.5612 14.2953 13 12.3663 13H3.63375C1.71373 13 0 11.559 0 9.6C0 8.25863 0.810198 7.14916 1.93276 6.59292C2.38358 5.39217 3.6016 4.6 4.9375 4.6C5.33032 4.6 5.70959 4.66698 6.06137 4.79152ZM9.75 5C8.60263 5 7.6952 5.67043 7.37686 6.50514L6.86674 7.84271L5.7864 6.90347C5.57817 6.72244 5.28239 6.6 4.9375 6.6C4.26343 6.6 3.82196 7.04773 3.75852 7.4773L3.66694 8.09744L3.06887 8.28526C2.39216 8.49778 2 9.04475 2 9.6C2 10.2858 2.64177 11 3.63375 11H12.3663C13.365 11 14 10.29 14 9.6C14 9.05326 13.6102 8.50615 12.9389 8.28911L12.2278 8.05923L12.25 7.18864C12.2431 6.05963 11.2128 5 9.75 5Z"/>\n</svg>\n'},81606:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M8 1a7 7 0 100 14A7 7 0 008 1zm.648 10.758l3.084-2.68c.357-.323.357-.946 0-1.269a.989.989 0 00-1.297 0L9 9.179V5c0-.5-.494-1-1-1s-1 .5-1 1v4.178L5.565 7.81a.989.989 0 00-1.297 0c-.357.323-.357.946 0 1.27l3.084 2.679a.989.989 0 001.296 0z"/></svg>\n'},67159:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M16 9C16.8495 9 17.6369 9.26446 18.2844 9.71557L9.00002 19C7.34062 18.9946 6 17.6497 6 16C6 14.686 6.84 13.57 8.022 13.164C8.187 11.942 9.232 11 10.5 11C11.167 11 11.772 11.26 12.22 11.686C12.765 10.123 14.25 9 16 9Z" fill="currentColor"/>\n<path d="M19.2844 10.7156L11 19H18.99C20.663 19 22 17.657 22 16C22 14.697 21.164 13.585 19.996 13.172L20 13C20 12.1505 19.7356 11.3631 19.2844 10.7156Z" fill="currentColor"/>\n</svg>\n'},71775:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M10 3C10.8495 3 11.6369 3.26446 12.2844 3.71557L3.00002 13C1.34062 12.9946 0 11.6497 0 10C0 8.686 0.84 7.57 2.022 7.164C2.187 5.942 3.232 5 4.5 5C5.167 5 5.772 5.26 6.22 5.686C6.765 4.123 8.25 3 10 3Z"/>\n  <path d="M13.2844 4.71558L5 13H12.99C14.663 13 16 11.657 16 10C16 8.69701 15.164 7.58501 13.996 7.17201L14 7.00001C14 6.15055 13.7356 5.36314 13.2844 4.71558Z"/>\n</svg>\n'},45016:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M13.996 7.172C15.164 7.585 16 8.697 16 10C16 11.657 14.663 13 12.99 13H3.01C1.346 13 0 11.653 0 10C0 8.686 0.84 7.57 2.022 7.164C2.187 5.942 3.232 5 4.5 5C5.167 5 5.772 5.26 6.22 5.686C6.765 4.123 8.25 3 10 3C12.21 3 14 4.79 14 7L13.996 7.172Z"/>\n</svg>\n'},59936:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M19.2465 13.3376C20.2685 13.668 21 14.5576 21 15.6C21 16.9256 19.8301 18.25 18.3663 18.25H9.5C8.044 18.25 7 16.9224 7 15.6C7 14.5488 7.735 13.656 8.76925 13.3312C8.91363 12.3536 9.828 11.6 10.9375 11.6C11.5211 11.6 12.0505 11.808 12.4425 12.1488C12.9194 10.8984 14.2188 10 15.75 10C17.6838 10 19.25 11.432 19.25 13.2L19.2465 13.3376Z" stroke="currentColor" stroke-width="1.5"/>\n</svg>\n'},29832:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M9.75 3C8.2498 3 6.88693 3.69117 6.06137 4.79152C5.70959 4.66698 5.33032 4.6 4.9375 4.6C3.6016 4.6 2.38358 5.39217 1.93276 6.59292C0.810198 7.14916 0 8.25863 0 9.6C0 11.559 1.71373 13 3.63375 13H12.3663C14.2953 13 16 11.5612 16 9.6C16 8.31987 15.2565 7.2517 14.2158 6.67358C13.9354 4.53945 11.971 3 9.75 3ZM7.37686 6.50514C7.6952 5.67043 8.60263 5 9.75 5C11.2128 5 12.2431 6.05963 12.25 7.18864L12.2278 8.05923L12.9389 8.28911C13.6102 8.50615 14 9.05326 14 9.6C14 10.29 13.365 11 12.3663 11H3.63375C2.64177 11 2 10.2858 2 9.6C2 9.04475 2.39216 8.49778 3.06887 8.28526L3.66694 8.09744L3.75852 7.4773C3.82196 7.04773 4.26343 6.6 4.9375 6.6C5.28239 6.6 5.57817 6.72244 5.7864 6.90347L6.86674 7.84271L7.37686 6.50514Z"/>\n</svg>\n'},76611:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M8 15A7 7 0 108 1a7 7 0 000 14zM7.352 4.242l-3.084 2.68c-.357.323-.357.946 0 1.269a.989.989 0 001.297 0L7 6.821V11c0 .5.494 1 1 1s1-.5 1-1V6.822l1.435 1.369a.989.989 0 001.296 0c.358-.323.358-.946 0-1.27L8.649 4.243a.989.989 0 00-1.296 0z"/></svg>\n'},43380:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16">\n  <path d="m12.5 5-1.4-1.4-3.1 3-3.1-3L3.5 5l3.1 3.1-3 2.9 1.5 1.4L8 9.5l2.9 2.9 1.5-1.4-3-2.9"/>\n</svg>\n'},61373:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M8 16A8 8 0 108 0a8 8 0 000 16zm0-2A6 6 0 108 2a6 6 0 000 12z"/>\n</svg>\n'},1149:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M7.998 0C5.24 0 4 2 4 4v2h-.502A2.5 2.5 0 001 8.5v5A2.5 2.5 0 003.498 16h9a2.5 2.5 0 002.498-2.5v-5A2.5 2.5 0 0012.498 6h-.502V4c0-2-1.239-4-3.998-4zm1.999 6V4c0-1-.344-2-1.999-2C6.344 2 6 3 6 4v2h3.997zM3 8.5a.5.5 0 01.498-.5h9a.5.5 0 01.498.5v5a.5.5 0 01-.498.5h-9A.5.5 0 013 13.5v-5zM8 13a2 2 0 100-4 2 2 0 000 4zm0-1a1 1 0 100-2 1 1 0 000 2z"/>\n</svg>\n'},19016:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M7.2 0C3.157.402 0 3.822 0 7.98 0 12.41 3.582 16 8 16a7.983 7.983 0 006.494-3.335l-1.738-1.006A6 6 0 117.2 2.053V0z"/>\n  <path opacity=".5" fill-rule="evenodd" d="M16 7.98c0 1.175-.252 2.29-.705 3.296l-1.74-1.006A6.001 6.001 0 008.8 2.053V0c4.044.402 7.201 3.822 7.201 7.98z"/>\n</svg>\n'},26055:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M7.352 1.242l-3.084 2.68c-.357.323-.357.946 0 1.269a.989.989 0 001.297 0L7 3.821V11c0 .5.494 1 1 1s1-.5 1-1V3.822l1.435 1.369a.989.989 0 001.296 0c.358-.323.358-.946 0-1.27L8.649 1.243a.989.989 0 00-1.296 0z"/>\n  <path d="M0 11v2.5A2.5 2.5 0 002.498 16h11a2.5 2.5 0 002.498-2.5V11h-2v2.5a.5.5 0 01-.498.5h-11A.5.5 0 012 13.5V11H0z"/>\n</svg>\n'},83062:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="currentColor" xmlns="http://www.w3.org/2000/svg">\n  <path d="M6.75 9.25C6.75 8.42157 7.42157 7.75 8.25 7.75H19.75C20.5784 7.75 21.25 8.42157 21.25 9.25V18.75C21.25 19.5784 20.5784 20.25 19.75 20.25H8.25C7.42157 20.25 6.75 19.5784 6.75 18.75V9.25Z" stroke="currentColor" stroke-width="1.5" fill="none"/>\n  <rect opacity="0.1" x="13.25" y="8" width="1.5" height="12"/>\n  <rect opacity="0.1" x="7" y="13.25" width="14" height="1.5"/>\n  <rect style="display: var(--displayTileRow)" opacity="0.9" x="13.25" y="8" width="1.5" height="12"/>\n  <rect style="display: var(--displayTileColumn)" opacity="0.9" x="7" y="13.25" width="14" height="1.5"/>\n</svg>\n'},1313:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M3 2C1.34315 2 0 3.34315 0 5V11C0 12.6569 1.34315 14 3 14H13C14.6569 14 16 12.6569 16 11V5C16 3.34315 14.6569 2 13 2H3ZM2 5C2 4.44772 2.44772 4 3 4H13C13.5523 4 14 4.44772 14 5V11C14 11.5523 13.5523 12 13 12H3C2.44772 12 2 11.5523 2 11V5Z"/>\n  <rect opacity="0.1" x="7" y="4" width="2" height="8"/>\n  <rect opacity="0.1" x="2" y="7" width="12" height="2"/>\n  <rect style="display: var(--displayTileRow)" opacity="0.9" x="7" y="4" width="2" height="8"/>\n  <rect style="display: var(--displayTileColumn)" opacity="0.9" x="2" y="7" width="12" height="2"/>\n</svg>\n'},67567:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M8 6C8 5.44772 7.55228 5 7 5H1C0.447715 5 0 5.44772 0 6V10C0 10.5523 0.447715 11 1 11H15C15.5523 11 16 10.5523 16 10C16 9.44772 15.5523 9 15 9H9C8.44771 9 8 8.55228 8 8V6Z"/>\n  <rect opacity="0.35" x="9" y="5" width="7" height="3" rx="1"/>\n</svg>\n'},96837:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M13.5 19.25C13.5 19.6642 13.8358 20 14.25 20C14.6642 20 15 19.6642 15 19.25V15H19.25C19.6642 15 20 14.6642 20 14.25C20 13.8358 19.6642 13.5 19.25 13.5H15V9.25C15 8.83579 14.6642 8.5 14.25 8.5C13.8358 8.5 13.5 8.83579 13.5 9.25V13.5H9.25C8.83579 13.5 8.5 13.8358 8.5 14.25C8.5 14.6642 8.83579 15 9.25 15H13.5V19.25Z" fill="currentColor"/>\n</svg>\n'},89702:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" d="M4 2C2.89543 2 2 2.89543 2 4V12C2 13.1046 2.89543 14 4 14H12C13.1046 14 14 13.1046 14 12V4C14 2.89543 13.1046 2 12 2H4ZM7 4H9V7H12V9H9V12H7V9H4V7H7V4Z"/>\n</svg>\n'},43085:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path opacity=".6" d="M8.531 12.067a1 1 0 01-1.062 0L2.628 9.03a1 1 0 00-1.058-.003l-.203.126a1 1 0 00-.004 1.698L7.47 14.67a1 1 0 001.06 0l6.107-3.817a1 1 0 00-.004-1.698l-.203-.126a1 1 0 00-1.058.003l-4.84 3.036z"/>\n  <path d="M1.357 6.848a1 1 0 010-1.696l6.113-3.82a1 1 0 011.06 0l6.113 3.82a1 1 0 010 1.696l-6.113 3.82a1 1 0 01-1.06 0l-6.113-3.82z"/>\n</svg>\n'},24042:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M14.5 8.25H10.25C9.14543 8.25 8.25 9.14543 8.25 10.25V17.75C8.25 18.8546 9.14543 19.75 10.25 19.75H17.75C18.8546 19.75 19.75 18.8546 19.75 17.75V15.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n<path d="M11.5 12.4997L14.5 15.4997L20.5 7.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n</svg>\n'},95846:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M2 1a1 1 0 0 0-1 1v9.293l2.146-2.147a.5.5 0 0 1 .708 0L5.5 10.793l4.646-4.647a.5.5 0 0 1 .708 0L15 10.293V2a1 1 0 0 0-1-1H2ZM0 12.5V14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2a2 2 0 0 0-2 2v10.5ZM15 14v-2.293l-4.5-4.5-4.646 4.647a.5.5 0 0 1-.708 0L3.5 10.207l-2.5 2.5V14a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1ZM4 5a1 1 0 1 1 2 0 1 1 0 0 1-2 0Zm1-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4Z"/>\n</svg>\n'},89576:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M13.996 5.86C15.243 6.83 16 8.103 16 9.5c0 3.038-3.582 5.5-8 5.5s-8-2.462-8-5.5c0-1.396.757-2.67 2.004-3.64C2.114 3.714 4.757 2 8 2c3.243 0 5.885 1.715 5.996 3.86zm-10.985.329a1.67 1.67 0 0 1-.009-.278c.033-.637.443-1.33 1.31-1.907l.058-.038C5.268 3.386 6.545 3 8 3s2.732.386 3.63.966a5.44 5.44 0 0 1 .165.11c.794.563 1.171 1.224 1.203 1.835a1.659 1.659 0 0 1-.015.324 1.944 1.944 0 0 1-.274.746c-.214.354-.55.701-1.021 1.015C10.788 8.596 9.487 9 8 9s-2.788-.404-3.688-1.004C3.49 7.448 3.08 6.801 3.011 6.19zm-.575 1.31a3.156 3.156 0 0 1-.242-.486C1.401 7.769 1 8.634 1 9.5c0 1.095.645 2.195 1.91 3.065C4.17 13.432 5.967 14 8 14s3.83-.568 5.09-1.435c1.265-.87 1.91-1.97 1.91-3.065 0-.866-.4-1.731-1.194-2.487-.063.16-.14.318-.232.47l-.01.017c.281.463.436.97.436 1.5 0 2.21-2.686 4-6 4s-6-1.79-6-4c0-.53.155-1.037.436-1.5zm10.433.839c.088.22.131.44.131.662 0 .666-.405 1.392-1.312 1.996C10.788 11.596 9.487 12 8 12s-2.788-.404-3.688-1.004C3.405 10.392 3 9.666 3 9c0-.221.043-.443.13-.662C4.22 9.345 5.996 10 8 10s3.78-.655 4.87-1.662z"/></svg>\n'},94411:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n    <path fill-rule="evenodd" d="M3.055 6.549c.052.082.111.156.176.222l4.905 6.065c.45.693 1.34.868 2.193.79.899-.084 1.94-.453 2.93-1.069.99-.614 1.783-1.384 2.256-2.152.449-.73.687-1.604.266-2.316l-3.26-7.088a1.329 1.329 0 0 0-.141-.287c-.243-.374-.638-.572-1.055-.658-.424-.086-.916-.068-1.433.023-1.037.183-2.276.682-3.49 1.435-1.213.753-2.209 1.643-2.833 2.49-.311.423-.546.857-.656 1.275-.11.415-.106.86.128 1.247l.014.023Zm8.477-5.303c-.056-.076-.17-.161-.408-.21-.258-.053-.615-.05-1.058.028-.883.156-2.003.596-3.136 1.3-1.133.703-2.024 1.512-2.556 2.234-.266.362-.427.68-.494.936-.061.233-.037.373.007.457l.08.099a.765.765 0 0 0 .351.15c.259.052.616.05 1.058-.028.883-.156 2.004-.597 3.136-1.3 1.133-.703 2.025-1.512 2.556-2.234.267-.362.427-.681.494-.936a.763.763 0 0 0 .022-.383l-.052-.113Zm.687 1.493c-.1.178-.216.356-.345.532-.625.847-1.62 1.737-2.834 2.49-1.213.754-2.453 1.252-3.49 1.435a5.116 5.116 0 0 1-.629.074l4.01 4.96a.498.498 0 0 1 .036.05c.138.222.524.418 1.27.35.714-.066 1.607-.371 2.494-.922.887-.55 1.557-1.217 1.932-1.827.393-.639.388-1.072.25-1.293a.499.499 0 0 1-.03-.055L12.22 2.739ZM4.5 13.5a2 2 0 0 1-4 0c0-2 2-4 2-4s2 2 2 4Z"/>\n</svg>\n'},95369:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path d="m3 6.5-.4-.1L.1 3.9c-.1-.2-.1-.6 0-.8l3-3c.2-.1.6-.1.8 0l2.5 2.5c.2.2.2.5 0 .7s-.5.2-.7 0L3.5 1.2 1.2 3.5l2.1 2.1c.2.2.2.5 0 .7 0 .2-.2.2-.3.2zM15.5 16h-.1l-4-1-.2-.1-1.5-1.5c-.2-.2-.2-.5 0-.7s.5-.2.7 0l1.4 1.4 3.1.8-.9-3.1-1.4-1.4c-.2-.2-.2-.5 0-.7s.5-.2.7 0l1.5 1.5.1.2 1 4-.1.5-.3.1zm-11 0-.4-.1-4-4-.1-.4.1-.4 11-11c.2-.2.5-.2.7 0l4 4c.2.2.2.5 0 .7l-11 11c0 .2-.2.2-.3.2zm-3.3-4.5 3.3 3.3L14.8 4.5l-3.3-3.3L1.2 11.5z" />\n  <path d="m4.5 11-.4-.1-1.5-1.5c-.2-.2-.2-.5 0-.7s.5-.2.7 0l1.5 1.5c.2.2.2.5 0 .7l-.3.1zm2-2-.4-.1-1.5-1.5c-.2-.2-.2-.5 0-.7s.5-.2.7 0l1.5 1.5c.2.1.2.5.1.7l-.4.1zm2-2-.4-.1-1.5-1.5c-.2-.2-.2-.5 0-.7s.5-.2.7 0l1.5 1.5c.2.1.2.5.1.7l-.4.1zm2-2-.4-.1-1.5-1.5c-.2-.2-.2-.5 0-.7s.5-.2.7 0l1.5 1.5c.2.2.2.5 0 .7l-.3.1z" />\n</svg>'},36561:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48">\n  <path fill-rule="evenodd" d="M41 4a3 3 0 0 0-2.1.9L23.5 19.5a8.2 8.2 0 0 1 3 1.9 8.3 8.3 0 0 1 2 3L43 9.2A3 3 0 0 0 41 4ZM29 26.8l15.5-16.2a5 5 0 0 0-7-7.1L21.1 19a8.3 8.3 0 0 0-6.4 2.4c-1 1-1.6 2.4-2 3.8a34.1 34.1 0 0 0-1.7 9 60.2 60.2 0 0 0 0 1.6l-.1.1 1 .1h-1v1h1v-1 1h.2a37.8 37.8 0 0 0 5.8-.7c1.6-.2 3.3-.6 4.8-1a9.6 9.6 0 0 0 3.8-2 8.3 8.3 0 0 0 2.4-6.5ZM3 7a4 4 0 0 1 4-4h21v2H7a2 2 0 0 0-2 2v34c0 1.1.9 2 2 2h34a2 2 0 0 0 2-2V20h2v21a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V7Zm17.7 14A6.3 6.3 0 0 1 25 31.8c-.5.6-1.5 1-3 1.5a32.2 32.2 0 0 1-8.4 1.6H13a62.3 62.3 0 0 1 1.6-9c.4-1.5 1-2.5 1.5-3a6.3 6.3 0 0 1 4.5-2Z" />\n  <circle cx="41" cy="41" r="7" fill="var(--colorFgIntense)" />\n  <path fill-rule="evenodd" d="M40 42v2h2v-2h2v-2h-2v-2h-2v2h-2v2h2Z" fill="var(--colorBgIntense)" />\n</svg>\n'},71475:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M7 0a.5.5 0 0 0-.493.418l-.311 1.865a5.957 5.957 0 0 0-.963.398L3.694 1.583a.5.5 0 0 0-.644.053L1.636 3.05a.5.5 0 0 0-.053.644l1.098 1.54c-.16.306-.293.627-.398.962l-1.865.31A.5.5 0 0 0 0 7v2a.5.5 0 0 0 .418.493l1.865.311c.105.335.239.656.398.963l-1.098 1.539a.5.5 0 0 0 .053.644l1.414 1.414a.5.5 0 0 0 .644.053l1.54-1.098c.306.16.627.293.962.398l.31 1.865A.5.5 0 0 0 7 16h2a.5.5 0 0 0 .493-.418l.311-1.865c.335-.105.656-.239.963-.398l1.538 1.099a.5.5 0 0 0 .645-.053l1.414-1.414a.5.5 0 0 0 .053-.644l-1.098-1.54c.16-.307.293-.628.398-.963l1.865-.31A.5.5 0 0 0 16 9V7a.5.5 0 0 0-.418-.493l-1.865-.311a5.955 5.955 0 0 0-.398-.963l1.099-1.538a.5.5 0 0 0-.054-.645L12.95 1.636a.5.5 0 0 0-.643-.053l-1.54 1.098a5.958 5.958 0 0 0-.962-.398L9.494.418A.5.5 0 0 0 9 0H7Zm.13 2.76L7.424 1h1.152l.294 1.76a.5.5 0 0 0 .37.401c.465.12.903.302 1.305.54a.5.5 0 0 0 .546-.022l1.451-1.036.816.815L12.32 4.91a.5.5 0 0 0-.023.546c.239.402.421.84.54 1.306a.5.5 0 0 0 .403.37L15 7.423v1.152l-1.76.294a.5.5 0 0 0-.401.37c-.12.465-.302.903-.54 1.305a.5.5 0 0 0 .022.545l1.036 1.453-.815.815-1.451-1.037a.5.5 0 0 0-.546-.023c-.402.239-.84.421-1.306.54a.5.5 0 0 0-.37.403L8.577 15H7.424l-.294-1.76a.5.5 0 0 0-.37-.401 4.964 4.964 0 0 1-1.305-.54.5.5 0 0 0-.545.022l-1.452 1.036-.815-.815 1.036-1.451a.5.5 0 0 0 .023-.546 4.963 4.963 0 0 1-.54-1.306.5.5 0 0 0-.403-.37L1 8.577V7.424l1.76-.294a.5.5 0 0 0 .401-.37c.12-.465.302-.903.54-1.305a.5.5 0 0 0-.022-.545L2.643 3.458l.815-.815L4.91 3.679a.5.5 0 0 0 .545.023c.402-.239.84-.421 1.306-.54a.5.5 0 0 0 .37-.403ZM6 8a2 2 0 1 1 4 0 2 2 0 0 1-4 0Zm2-3a3 3 0 1 0 0 6 3 3 0 0 0 0-6Z"/>\n</svg>\n'},35024:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M5.976 11c-1.92.537-1.91 1.258-2.323 2.9C3.24 15.54 1 15.673 1 15.673c8.832 1.68 7.978-3.656 7.978-3.656C6.798 12.267 5.976 11 5.976 11M14 1.127c-.868-.316-1.91-.022-2.316.652l-.17.28c-.94.748-1.934 1.895-2.758 3.264C7.932 6.692 7.436 8.02 7.3 9.062l-.16.265c-.406.674-.03 1.484.838 1.8.866.316 1.908.023 2.314-.652l.202-.336c.92-.75 1.884-1.872 2.686-3.205s1.293-2.627 1.445-3.656l.212-.353c.406-.674.03-1.484-.838-1.8" />\n</svg>\n'},67905:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M8.5 11L4.86568 7.36568C4.36171 6.86171 4.71865 6 5.43137 6L11.5686 6C12.2814 6 12.6383 6.86171 12.1343 7.36569L8.5 11Z"/>\n</svg>\n'},17554:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M7 19L9.5 12H11L14 19" stroke="currentColor" stroke-width="1.5" stroke-miterlimit="16" stroke-linecap="round"/>\n<path d="M9 15.75L12 15.75" stroke="currentColor" stroke-width="1.5" stroke-linecap="square"/>\n<path d="M19 10C18.5415 11.441 17 14 14.8911 15" stroke="currentColor" stroke-width="1.5" stroke-linecap="square"/>\n<path d="M16 8V9" stroke="currentColor" stroke-width="1.5" stroke-linecap="square"/>\n<path d="M12.75 9.25L21.25 9.25" stroke="currentColor" stroke-width="1.5" stroke-linecap="square"/>\n<path d="M14 10C14.6 11.8857 17.28 15.04 20 16" stroke="currentColor" stroke-width="1.5" stroke-linecap="square"/>\n</svg>\n'},37512:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M13.848 3.349V4.339H12.63C12.173 5.603 11.556 6.636 10.778 7.489C11.649 8.164 12.715 8.669 14 8.959C13.755 9.206 13.433 9.684 13.281 9.974C11.92 9.624 10.821 9.052 9.93198 8.292C9.49998 9 8.99998 9.5 7.99998 10L7.36198 9.031C8.05298 8.708 8.99998 8 9.16198 7.533C8.40198 6.653 7.81798 5.586 7.36198 4.339H6.15198V3.349H9.46698V2H10.491V3.349H13.848ZM9.99198 6.773C10.6 6.107 11.082 5.304 11.446 4.339H8.47798C8.84098 5.261 9.33998 6.081 9.99198 6.773Z"/>\n  <path d="M5.846 11.558H3.15L2.636 13H1L3.78 6H5.205L8 13H6.364L5.846 11.558ZM3.564 10.389H5.431L4.492 7.769L3.564 10.389Z"/>\n</svg>\n'},43951:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M13.848 3.349v.99H12.63c-.457 1.264-1.074 2.297-1.852 3.15.871.675 1.937 1.18 3.222 1.47-.245.247-.567.725-.719 1.015-1.361-.35-2.46-.922-3.349-1.682C9.5 9 9 9.5 8 10l-.638-.969C8.053 8.708 9 8 9.162 7.533c-.76-.88-1.344-1.947-1.8-3.194h-1.21v-.99h3.315V2h1.024v1.349h3.357zM9.992 6.773c.608-.666 1.09-1.469 1.454-2.434H8.478c.363.922.862 1.742 1.514 2.434z"/>\n  <path d="M5.846 11.558H3.15L2.636 13H1l2.78-7h1.425L8 13H6.364l-.518-1.442zm-2.282-1.169h1.867l-.939-2.62-.928 2.62z"/>\n</svg>\n'},38146:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M9.25 11V18.75C9.25 19.8546 10.1454 20.75 11.25 20.75H16.75C17.8546 20.75 18.75 19.8546 18.75 18.75V11" stroke="currentColor" stroke-width="1.5"/>\n  <path d="M18 8C17.7239 8 17.5 7.77614 17.5 7.5C17.5 7.22386 17.2761 7 17 7H11C10.7239 7 10.5 7.22386 10.5 7.5C10.5 7.77614 10.2761 8 10 8H8.5C7.94772 8 7.5 8.19772 7.5 8.75C7.5 9.30228 7.94772 9.5 8.5 9.5H19.5C20.0523 9.5 20.5 9.30228 20.5 8.75C20.5 8.19772 20.0523 8 19.5 8H18Z" fill="currentColor"/>\n  <line opacity="0.35" x1="12.25" y1="11.75" x2="12.25" y2="17.25" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n  <line opacity="0.35" x1="15.75" y1="11.75" x2="15.75" y2="17.25" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n</svg>\n'},14302:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path opacity="0.35" d="M7 5V12H9V5H7Z"/>\n  <path d="M10.5 2C10.2239 2 10 1.77614 10 1.5C10 1.22386 9.77614 1 9.5 1H6.5C6.22386 1 6 1.22386 6 1.5C6 1.77614 5.77614 2 5.5 2H4C3.44772 2 3 2.44772 3 3C3 3.55228 3.44772 4 4 4H12C12.5523 4 13 3.55228 13 3C13 2.44772 12.5523 2 12 2H10.5Z"/>\n  <path d="M4 5V12C4 13.6569 5.34315 15 7 15H9C10.6569 15 12 13.6569 12 12V5H10V12C10 12.5523 9.55228 13 9 13H7C6.44772 13 6 12.5523 6 12V5H4Z"/>\n</svg>\n'},3895:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M10.5 3a.5.5 0 0 1-.5-.5.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5.5.5 0 0 1-.5.5H4a1 1 0 0 0-1 1h10a1 1 0 0 0-1-1h-1.5ZM4 5v7.5A1.5 1.5 0 0 0 5.5 14h5a1.5 1.5 0 0 0 1.5-1.5V5h-1v7.5a.5.5 0 0 1-.5.5h-5a.5.5 0 0 1-.5-.5V5H4Z"/>\n  <path opacity=".3" d="M6 5v7h4V5H6Z"/>\n</svg>\n'},85382:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8Zm2.5-4a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0Z"/>\n</svg>'},88826:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8Z"/>\n</svg>'},33271:e=>{e.exports='<svg width="196" height="32" xmlns="http://www.w3.org/2000/svg">\n  <path class="border" d="M2 .5h192a1.5 1.5 0 011.5 1.5v28a1.5 1.5 0 01-1.5 1.5H2A1.5 1.5 0 01.5 30V2A1.5 1.5 0 012 .5z"/>\n  <path d="M1 24h12v1H1z"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M0 25V7h10v18H0zM1 8h8v16H1V8zM100 11v10h10V11h-10zm9 1h-8v8h8v-8z"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M13 8h80v17h102v-1h-17V7H96v17h-2V7H12v18h1V8zm84 16h80V8H97v16z"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M16 11v10h10V11H16zm9 1h-8v8h8v-8z"/>\n  <path fill="var(--colorBg)" d="M166 6a2 2 0 012-2h11a2 2 0 012 2v11a2 2 0 01-2 2h-11a2 2 0 01-2-2V6z"/>\n  <path class="highlight" fill-rule="evenodd" clip-rule="evenodd" d="M179 5h-11a1 1 0 00-1 1v11a1 1 0 001 1h11a1 1 0 001-1V6a1 1 0 00-1-1zm-11-1a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2V6a2 2 0 00-2-2h-11z"/>\n  <path class="highlight" d="M170 7h8v8l-8-8z"/>\n</svg>\n'},33943:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg">\n<path d="M14.8534 11.5799L18.9396 7.49372L14.8534 3.40752C14.5384 3.09254 13.9999 3.31562 13.9999 3.76107L13.9999 11.2264C13.9999 11.6718 14.5384 11.8949 14.8534 11.5799Z" fill="currentColor"/>\n<circle cx="21" cy="14" r="3" fill="var(--colorHighlightBg)"/>\n<path fill="none" d="M14 7C9.85786 7 6.5 10.3579 6.5 14.5C6.5 18.6421 9.85786 22 14 22C16.2212 22 18.217 21.0344 19.5903 19.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>\n</svg>\n'},27470:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path d="M10.31 4.55L8.87 5.98a.5.5 0 01-.85-.35V3.87a4.2 4.2 0 00-2.98 7.2 4.22 4.22 0 005.19.62l1.4 1.47a6.22 6.22 0 11-3.6-11.29V.5a.5.5 0 01.84-.35l2.92 2.91-.04.05-1.44 1.44zm1.2 5.91a4.2 4.2 0 00.73-2.18l2-.25a6.2 6.2 0 01-1.33 3.9l-1.4-1.47zm2.56-3.83l-2 .25a4.2 4.2 0 00-.5-1.08L13 4.37c.52.69.88 1.46 1.07 2.26z" clip-rule="evenodd"/>\n</svg>\n'},1293:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path d="M10.74 4.14L8.95 5.93a.5.5 0 01-.85-.36V3.31a4.59 4.59 0 00-3.25 7.86 4.6 4.6 0 005.8.57l.7.74A5.6 5.6 0 118.1 2.3v-1.1a.5.5 0 01.85-.36l2.54 2.54-.04.04-.71.71zm1.07 6.5c.58-.79.88-1.72.89-2.66l1-.12a5.58 5.58 0 01-1.2 3.51l-.7-.73zm1.73-4.04l-1 .12c-.13-.5-.36-1-.67-1.44l.72-.72c.46.62.78 1.32.95 2.04z" clip-rule="evenodd"/>\n</svg>\n'},1652:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg"><path d="M14 6V2h-4c0-1.1-.9-2-2-2S6 .9 6 2H2v4c1.1 0 2 .9 2 2s-.9 2-2 2v4h4c0-1.1.9-2 2-2s2 .9 2 2h4v-4c1.1 0 2-.9 2-2s-.9-2-2-2z"/></svg>'},44278:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path opacity=".35" fill-rule="evenodd" clip-rule="evenodd" d="M3 1a3 3 0 00-3 3v8a3 3 0 003 3h10a3 3 0 003-3V4a3 3 0 00-3-3H3zM2 4a1 1 0 011-1h10a1 1 0 011 1v8a1 1 0 01-1 1H3a1 1 0 01-1-1V4z"/>\n  <rect x="3" y="4" width="10" height="5" rx="1"/>\n</svg>\n'},385:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path opacity="0.5" d="M1.5 4.5C1.5 3.39543 2.39543 2.5 3.5 2.5H12.5C13.6046 2.5 14.5 3.39543 14.5 4.5V11.5C14.5 12.6046 13.6046 13.5 12.5 13.5H3.5C2.39543 13.5 1.5 12.6046 1.5 11.5V4.5Z" stroke="currentColor"/>\n  <rect x="3" y="4" width="10" height="4" rx="1" fill="currentColor"/>\n</svg>\n'},82003:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<rect x="9" y="10" width="10" height="5" rx="0.5" fill="currentColor"/>\n<rect opacity="0.35" x="7" y="8" width="14" height="12" rx="2" stroke="currentColor" stroke-width="1.5"/>\n</svg>\n'},98434:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path opacity=".35" fill-rule="evenodd" clip-rule="evenodd" d="M3 1a3 3 0 00-3 3v8a3 3 0 003 3h10a3 3 0 003-3V4a3 3 0 00-3-3H3zM2 4a1 1 0 011-1h10a1 1 0 011 1v8a1 1 0 01-1 1H3a1 1 0 01-1-1V4z"/>\n  <rect x="3" y="4" width="5" height="8" rx="1"/>\n</svg>\n'},29086:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M7 4H4C3.44772 4 3 4.44772 3 5V11C3 11.5523 3.44772 12 4 12H7C7.55228 12 8 11.5523 8 11V5C8 4.44772 7.55228 4 7 4Z" fill="currentColor"/>\n  <path opacity="0.5" d="M1.5 4.5C1.5 3.39543 2.39543 2.5 3.5 2.5H12.5C13.6046 2.5 14.5 3.39543 14.5 4.5V11.5C14.5 12.6046 13.6046 13.5 12.5 13.5H3.5C2.39543 13.5 1.5 12.6046 1.5 11.5V4.5Z" stroke="currentColor"/>\n</svg>\n'},16619:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path opacity="0.35" fill-rule="evenodd" clip-rule="evenodd" d="M8 6C6.34315 6 5 7.34315 5 9V17C5 18.6569 6.34315 20 8 20H18C19.6569 20 21 18.6569 21 17V9C21 7.34315 19.6569 6 18 6H8ZM7 9C7 8.44772 7.44772 8 8 8H18C18.5523 8 19 8.44772 19 9V17C19 17.5523 18.5523 18 18 18H8C7.44772 18 7 17.5523 7 17V9Z"/>\n  <rect x="8" y="9" width="7" height="8" rx="1"/>\n</svg>\n'},82450:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<rect x="9" y="10" width="7" height="8" rx="0.5" fill="currentColor"/>\n<rect opacity="0.35" x="7" y="8" width="14" height="12" rx="2" stroke="currentColor" stroke-width="1.5"/>\n</svg>\n'},705:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<rect x="9" y="10" width="5" height="8" rx="0.5" fill="currentColor"/>\n<rect opacity="0.35" x="7" y="8" width="14" height="12" rx="2" stroke="currentColor" stroke-width="1.5"/>\n</svg>\n'},88111:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M4 1.167h8a3 3 0 013 3v7.666a3 3 0 01-3 3H4a3 3 0 01-3-3V4.167a3 3 0 013-3zm0 1a2 2 0 00-2 2v7.666a2 2 0 002 2h8a2 2 0 002-2V4.167a2 2 0 00-2-2H4z"/>\n  <path d="M11.691 11.962a.499.499 0 00.16-.106l.005-.005A.498.498 0 0012 11.5v-5a.5.5 0 00-1 0v3.793L6.854 6.146a.5.5 0 10-.708.708L10.293 11H6.5a.5.5 0 000 1h5.003a.501.501 0 00.188-.038z"/>\n</svg>\n'},23634:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M4 1.167h8a3 3 0 013 3v7.666a3 3 0 01-3 3H4a3 3 0 01-3-3V4.167a3 3 0 013-3zm0 1a2 2 0 00-2 2v7.666a2 2 0 002 2h8a2 2 0 002-2V4.167a2 2 0 00-2-2H4z"/>\n  <path d="M4.309 4.038A.498.498 0 004 4.5v5a.5.5 0 001 0V5.707l4.146 4.147a.5.5 0 00.708-.708L5.707 5H9.5a.5.5 0 000-1h-5-.003a.5.5 0 00-.188.038z"/>\n</svg>\n'},80162:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M13.962 2.309A.5.5 0 0013.5 2h-5a.5.5 0 000 1h3.793L8.146 7.146a.5.5 0 10.708.708L13 3.707V7.5a.5.5 0 001 0v-5-.003a.5.5 0 00-.038-.188zM2 9.5a.5.5 0 01.5-.5h4a.5.5 0 01.5.5v4a.5.5 0 01-.5.5h-4a.5.5 0 01-.5-.5v-4zm1 .5v3h3v-3H3z" />\n</svg>'},37609:e=>{e.exports='<svg width="22" height="22" xmlns="http://www.w3.org/2000/svg">\n  <path d="M4 6.75A.75.75 0 0 1 4.75 6h12.5a.75.75 0 0 1 0 1.5H4.75A.75.75 0 0 1 4 6.75zm0 4a.75.75 0 0 1 .75-.75h12.5a.75.75 0 0 1 0 1.5H4.75a.75.75 0 0 1-.75-.75zm0 4a.75.75 0 0 1 .75-.75h12.5a.75.75 0 0 1 0 1.5H4.75a.75.75 0 0 1-.75-.75z"/>\n</svg>\n'},3783:e=>{e.exports='\x3c!-- Monochrome --\x3e\n<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 22" width="22" height="22">\n  <path d="M18.6 3.4C17.1 2 14.9 2 11 2S4.9 2 3.4 3.4C2 4.9 2 7.1 2 11s0 6.1 1.4 7.6C4.9 20 7.1 20 11 20s6.1 0 7.6-1.4C20 17.1 20 14.9 20 11s0-6.1-1.4-7.6zm-2.2 5.2l-4.2 7.2c-.3.4-.6.7-1.1.8-.6 0-1-.2-1.3-.7-.9-1.5-1.7-3-2.6-4.5-.5-.9-1.1-1.8-1.6-2.8-.6-.9 0-2 1.1-2.1.6 0 1 .2 1.3.7.4.7.8 1.3 1.2 2 .3.5.6 1 .8 1.5.4.7 1 1.1 1.8 1.1 1.2.1 2.2-.8 2.4-2v-.2c0-.4-.1-.7-.2-1-.4-.9 0-1.8 1-2 .8-.2 1.6.4 1.7 1.2 0 .2-.1.5-.3.8z"/>\n</svg>\n'},83557:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M13.911 2.089C12.744 1 11.033 1 8 1 4.967 1 3.256 1 2.089 2.089 1 3.256 1 4.967 1 8c0 3.033 0 4.744 1.089 5.911C3.256 15 4.967 15 8 15c3.033 0 4.744 0 5.911-1.089C15 12.744 15 11.033 15 8c0-3.033 0-4.744-1.089-5.911ZM12.2 6.133l-3.267 5.6c-.233.311-.466.545-.855.623-.467 0-.778-.156-1.011-.545-.7-1.167-1.323-2.333-2.023-3.5-.388-.7-.855-1.4-1.244-2.178-.467-.7 0-1.555.856-1.633.466 0 .777.156 1.01.544.312.545.623 1.012.934 1.556.233.389.467.778.622 1.167.311.544.778.855 1.4.855.934.078 1.711-.622 1.867-1.555V6.91c0-.311-.078-.544-.156-.778-.31-.7 0-1.4.778-1.555.622-.156 1.245.31 1.322.933 0 .156-.077.389-.233.622Z"/>\n</svg>\n'},38151:e=>{e.exports='<svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">\n  <path d="M16 32c7.011 0 10.91 0 13.454-2.546C32 26.91 32 23.011 32 16c0-7.011 0-10.909-2.546-13.454C26.91 0 23.011 0 16 0 8.989 0 5.091 0 2.546 2.546 0 5.09 0 8.989 0 16c0 7.01 0 10.909 2.546 13.454C5.09 32 8.989 32 16 32" fill="#4c70f0"/>\n  <path d="M23.547 12.942c-1.957 3.406-3.917 6.81-5.87 10.217-.364.633-.892 1.016-1.616 1.068-.811.06-1.448-.283-1.857-.987-1.239-2.135-2.463-4.278-3.693-6.417-.748-1.302-1.499-2.602-2.243-3.905-.752-1.315.096-2.913 1.603-2.99.796-.042 1.41.325 1.814 1.018.552.947 1.094 1.9 1.64 2.85.395.684.78 1.374 1.186 2.05.586.984 1.449 1.538 2.597 1.607a3.163 3.163 0 0 0 3.328-2.812c.015-.13.024-.259.03-.325-.009-.56-.113-1.033-.335-1.478-.607-1.217.04-2.581 1.358-2.874 1.074-.238 2.186.553 2.328 1.645.062.48-.032.92-.27 1.333m.71-5.463c-4.634-4.639-12.147-4.639-16.781 0-4.635 4.638-4.635 12.158 0 16.795 4.634 4.638 12.147 4.638 16.782 0 4.634-4.637 4.634-12.157 0-16.795" fill="#fff"/>\n</svg>\n'},43893:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M10.9604 4.44569C10.4629 3.42529 10.9928 2.28123 12.0753 2.03561C12.9563 1.83607 13.8679 2.4994 13.9847 3.41546C14.0358 3.81793 13.958 4.18653 13.763 4.5331C12.1575 7.38833 10.55 10.2422 8.94712 13.0988C8.64918 13.6293 8.2163 13.9505 7.62207 13.9945C6.95657 14.044 6.43394 13.757 6.09839 13.1662C5.08249 11.3768 4.07782 9.58024 3.06885 7.78674C2.45515 6.69519 1.83948 5.605 1.22842 4.51209C0.612089 3.41004 1.30728 2.06983 2.54391 2.00479C3.19687 1.97057 3.70069 2.27852 4.03195 2.85919C4.48497 3.65295 4.9294 4.45213 5.37779 5.2486C5.70114 5.82249 6.01788 6.40011 6.35014 6.96825C6.83152 7.79216 7.53892 8.25696 8.48058 8.31489C9.81355 8.3962 11.0512 7.40798 11.2109 5.95665C11.2227 5.84824 11.2307 5.73983 11.2356 5.68427C11.2284 5.21472 11.1426 4.81903 10.9604 4.44569Z"/>\n</svg>\n'},32727:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n<path d="M11.256 4.73144L2.67246 20.0209C1.924 21.3541 2.88751 23 4.41643 23H21.5836C23.1125 23 24.076 21.3541 23.3275 20.0209L14.744 4.73144C13.9798 3.3702 12.0202 3.3702 11.256 4.73144Z" fill-opacity="0.2"/>\n<path d="M11.9059 10.4231C11.5644 10.4231 11.2975 10.7153 11.3314 11.0521L11.7933 15.6284C11.8228 15.9208 12.0712 16.1435 12.3678 16.1435H13.6322C13.9288 16.1435 14.1772 15.9208 14.2067 15.6284L14.6686 11.0521C14.7026 10.7153 14.4357 10.4231 14.0941 10.4231H11.9059Z" />\n<path d="M12.4227 17.2876C12.1038 17.2876 11.8453 17.5437 11.8453 17.8596V19.0037C11.8453 19.3197 12.1038 19.5758 12.4227 19.5758H13.5774C13.8962 19.5758 14.1547 19.3197 14.1547 19.0037V17.8596C14.1547 17.5437 13.8962 17.2876 13.5774 17.2876H12.4227Z" />\n</svg>\n'},20643:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n<path d="M7.13381 2.50139L1.36522 12.5003C0.980609 13.1669 1.46175 14 2.23141 14H13.7686C14.5382 14 15.0194 13.1669 14.6348 12.5003L8.86619 2.50139C8.48136 1.83435 7.51864 1.83435 7.13381 2.50139Z" fill-opacity="0.2"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M7.32878 5.00012C6.88506 5.00012 6.53835 5.38324 6.5825 5.82475L6.9325 9.32475C6.97084 9.70815 7.29346 10.0001 7.67878 10.0001H8.3213C8.70661 10.0001 9.02923 9.70815 9.06757 9.32475L9.41757 5.82475C9.46173 5.38324 9.11501 5.00012 8.6713 5.00012H7.32878ZM7.75001 11C7.33579 11 7.00001 11.3358 7.00001 11.75V12.25C7.00001 12.6642 7.33579 13 7.75001 13H8.25001C8.66422 13 9.00001 12.6642 9.00001 12.25V11.75C9.00001 11.3358 8.66422 11 8.25001 11H7.75001Z"/>\n</svg>\n'},70913:e=>{e.exports='<svg width="16" height="16" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M7 6a1 1 0 1 1 2 0v3a1 1 0 0 1-2 0V6ZM7 12a1 1 0 1 1 2 0 1 1 0 0 1-2 0Z" fill="var(--colorFg)"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.118 1.654a1 1 0 0 1 1.764 0l6.334 11.875A1 1 0 0 1 14.333 15H1.667a1 1 0 0 1-.883-1.47L7.118 1.653ZM2 14a.2.2 0 0 1-.176-.294l6-11.25a.2.2 0 0 1 .352 0l6 11.25A.2.2 0 0 1 14 14H2Z" fill="var(--colorFg)"/>\n</svg>\n'},34511:e=>{e.exports='<svg width="220" height="140" viewBox="0 0 220 140" xmlns="http://www.w3.org/2000/svg">\n  <path fill="var(--colorBg)" d="M0 0H220V140H0V0Z"/>\n  <path class="active-tab-preview" d="M0 114H220V140H0V114Z"/>\n  <path fill="var(--colorAccentFg)" d="M6 120H75V134H6V120Z"/>\n  <path fill="var(--colorAccentFgAlpha)" d="M76 120H144V134H76V120ZM145 120H214V134H145V120Z"/>\n</svg>\n'},31614:e=>{e.exports='<svg width="220" height="140" xmlns="http://www.w3.org/2000/svg">\n  <path fill="var(--colorBg)" d="M3 0H217C217.796 0 218.559 0.283653 219.121 0.788559C219.684 1.29346 220 1.97826 220 2.69231V140H0V2.69231C0 1.97826 0.31607 1.29346 0.87868 0.788559C1.44129 0.283653 2.20435 0 3 0V0Z"/>\n  <path class="active-tab-preview" d="M0 0H81V140H0V0Z" rx="10px" ry="10px"/>\n  <path fill="var(--colorAccentFg)" d="M6 6H75V20H6V6Z"/>\n  <path fill="var(--colorAccentFgAlpha)" d="M6 21H75V35H6V21ZM6 36H75V50H6V36Z"/>\n</svg>\n'},76201:e=>{e.exports='<svg width="220" height="140" xmlns="http://www.w3.org/2000/svg">\n  <path fill="var(--colorBg)" d="M3 0H217C217.796 0 218.559 0.283653 219.121 0.788559C219.684 1.29346 220 1.97826 220 2.69231V140H0V2.69231C0 1.97826 0.31607 1.29346 0.87868 0.788559C1.44129 0.283653 2.20435 0 3 0V0Z"/>\n  <path class="active-tab-preview" d="M139 0H220V140H139V0Z"/>\n  <path fill="var(--colorAccentFg)" d="M145 6H214V20H145V6Z"/>\n  <path fill="var(--colorAccentFgAlpha)" d="M145 21H214V35H145V21ZM145 36H214V50H145V36Z"/>\n</svg>\n'},48753:e=>{e.exports='<svg width="220" height="140" xmlns="http://www.w3.org/2000/svg">\n  <path fill="var(--colorBg)" d="M3 0h214a3.18 3.18 0 0 1 2.121.789c.563.504.879 1.19.879 1.903V140H0V2.692C0 1.978.316 1.293.879.79A3.183 3.183 0 0 1 3 0Z"/>\n  <path class="active-tab-preview" d="M0 0h220v26H0V0Z"/>\n  <path fill="var(--colorAccentFg)" d="M6 6h69v14H6V6Z"/>\n  <path fill="var(--colorAccentFgAlpha)" d="M76 6h68v14H76V6Zm69 0h69v14h-69V6Z"/>\n</svg>\n'},76259:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 116 116">\n  <path fill="#ef3939" d="M58 115c25 0 38.9 0 47.9-9.1C115 96.9 115 83 115 58s0-38.9-9.1-47.9C96.9 1 83 1 58 1s-38.9 0-47.9 9.1C1 19.1 1 33 1 58s0 38.9 9.1 47.9C19.1 115 33 115 58 115z"/>\n  <linearGradient id="a" x1="36.55" x2="91.02" y1="21.06" y2="115.39" gradientUnits="userSpaceOnUse">\n    <stop offset="0" stop-opacity=".2"/>\n    <stop offset=".79" stop-opacity=".05"/>\n  </linearGradient>\n  <path fill="url(#a)" d="M95.1 36.9A42.7 42.7 0 1 0 21.2 80l20.1 34.8 10.8.1h5.7c11.1 0 20 0 27.3-.8 9.1-1 15.6-3.2 20.7-8.3 7.3-7.3 8.7-17.9 9-34.9a3101.9 3101.9 0 0 1-19.7-34z"/>\n  <path fill="#fff" d="M88 27.8a42.7 42.7 0 1 0-60.3 60.5A42.7 42.7 0 1 0 88 27.8zm-2.5 19.7L64.4 84.2c-1.3 2.3-3.2 3.7-5.8 3.8-2.9.2-5.2-1-6.7-3.6L38.6 61.3l-8.1-14a7.1 7.1 0 0 1 5.8-10.8 6.8 6.8 0 0 1 6.5 3.7l5.9 10.3 4.3 7.4c2.1 3.5 5.2 5.5 9.3 5.8 5.8.3 11.3-3.9 12-10.1l.1-1.2c0-2-.4-3.7-1.2-5.3a7 7 0 0 1 4.9-10.3 7 7 0 0 1 8.4 5.9 8 8 0 0 1-1 4.8z"/>\n</svg>\n'},51759:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 10 10">\n  <path d="M10.2.5l-.7-.7L5 4.3.5-.2l-.7.7L4.3 5-.2 9.5l.7.7L5 5.7l4.5 4.5.7-.7L5.7 5"/>\n</svg>\n'},9592:e=>{e.exports='<svg class="window-maximize" xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 10 10">\n\n  <g class="window-maximize-glyph">\n    <path fill-rule="evenodd" d="M8.5 1h-7a.5.5 0 0 0-.5.5v7a.5.5 0 0 0 .5.5h7a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.5-.5zm-7-1A1.5 1.5 0 0 0 0 1.5v7A1.5 1.5 0 0 0 1.5 10h7A1.5 1.5 0 0 0 10 8.5v-7A1.5 1.5 0 0 0 8.5 0h-7z"/>\n  </g>\n\n  <g class="window-restore-glyph">\n    <path d="M3.618 0C2.933 0 2.306.387 2 1h5a2 2 0 0 1 2 2v5c.613-.306 1-.933 1-1.618V3a3 3 0 0 0-3-3H3.618z"/>\n    <path fill-rule="evenodd" d="M6.5 10A1.5 1.5 0 0 0 8 8.5v-5A1.5 1.5 0 0 0 6.5 2h-5A1.5 1.5 0 0 0 0 3.5v5A1.5 1.5 0 0 0 1.5 10h5zM7 8.5a.5.5 0 0 1-.5.5h-5a.5.5 0 0 1-.5-.5v-5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 .5.5v5z"/>\n  </g>\n</svg>\n'},96375:e=>{e.exports='<svg width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">\n  <path d="M0 5H10V6H0V5Z"/>\n</svg>\n'},9652:e=>{e.exports='<svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M6.75 9.75C6.75 8.64543 7.64543 7.75 8.75 7.75H19.25C20.3546 7.75 21.25 8.64543 21.25 9.75V18.25C21.25 19.3546 20.3546 20.25 19.25 20.25H8.75C7.64543 20.25 6.75 19.3546 6.75 18.25V9.75Z" stroke="currentColor" stroke-width="1.5"/>\n<line x1="7" y1="11.25" x2="21" y2="11.25" stroke="currentColor" stroke-width="1.5"/>\n<line x1="12.25" y1="11" x2="12.25" y2="8" stroke="currentColor" stroke-width="1.5"/>\n<line x1="15.75" y1="11" x2="15.75" y2="8" stroke="currentColor" stroke-width="1.5"/>\n</svg>\n'},2144:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M1 4C1 2.89543 1.89543 2 3 2H13C14.1046 2 15 2.89543 15 4V12C15 13.1046 14.1046 14 13 14H3C1.89543 14 1 13.1046 1 12V4ZM9 4H13V6H9V4ZM8 4H6V6H8V4ZM5 4H3V6H5V4ZM3 7L3 12H13V7H3Z"/>\n</svg>\n'},32545:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M14 3H2a1 1 0 00-1 1v2h14V4a1 1 0 00-1-1zM1 12V7h14v5a1 1 0 01-1 1H2a1 1 0 01-1-1zM2 2a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V4a2 2 0 00-2-2H2zm4 2H2v1h4V4z"/>\n</svg>\n'},31866:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path class="small-icon-fill" fill-rule="evenodd" clip-rule="evenodd" d="M1 4C1 3.44772 1.44772 3 2 3H14C14.5523 3 15 3.44772 15 4V6H1V4ZM1 7V12C1 12.5523 1.44772 13 2 13H14C14.5523 13 15 12.5523 15 12V7H1ZM2 4H6V5H2V4Z"/>\n  <path class="small-icon-outline" fill-rule="evenodd" clip-rule="evenodd" d="M2 3H14C14.5523 3 15 3.44772 15 4V6H16V4C16 2.89543 15.1046 2 14 2H2C0.895431 2 0 2.89543 0 4V6H1V4C1 3.44772 1.44772 3 2 3ZM1 7H0V12C0 13.1046 0.895431 14 2 14H14C15.1046 14 16 13.1046 16 12V7H15V12C15 12.5523 14.5523 13 14 13H2C1.44772 13 1 12.5523 1 12V7Z"/>\n</svg>\n'},33802:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" xmlns="http://www.w3.org/2000/svg">\n  <path d="M3.493 10.168L1.17 9.99498C1.04212 9.98491 0.914222 10.0143 0.803571 10.0792C0.692919 10.1441 0.604836 10.2414 0.551204 10.3579C0.497572 10.4744 0.480973 10.6046 0.503646 10.7309C0.52632 10.8571 0.587174 10.9734 0.677999 11.064L2.331 12.7L3.493 10.168Z"/>\n  <path d="M5.83205 12.507L6.00605 14.831C6.01612 14.9589 5.98672 15.0868 5.92183 15.1974C5.85693 15.3081 5.75965 15.3962 5.64313 15.4498C5.5266 15.5034 5.39642 15.52 5.27016 15.4974C5.1439 15.4747 5.02764 15.4138 4.93705 15.323L3.30005 13.67L5.83205 12.507Z"/>\n  <path d="M9.05696 3.96301L3.83396 1.41101C3.45962 1.22818 3.03753 1.16682 2.62663 1.23548C2.21573 1.30415 1.83652 1.49941 1.54196 1.79401L0.761963 2.57401L6.57296 6.44801" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M9.55298 9.42797L13.427 15.239L14.207 14.459C14.5014 14.1643 14.6965 13.785 14.765 13.3741C14.8335 12.9632 14.7719 12.5412 14.589 12.167L12.038 6.94397" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M7.02104 11.962L2.12104 14.211C2.07461 14.2322 2.0228 14.2387 1.97257 14.2296C1.92234 14.2205 1.87609 14.1963 1.84005 14.1601C1.804 14.124 1.77989 14.0777 1.77095 14.0274C1.76201 13.9771 1.76867 13.9253 1.79004 13.879L4 9L11.91 1.10898C12.3054 0.713699 12.8415 0.491638 13.4005 0.491638C13.9596 0.491638 14.4957 0.713699 14.891 1.10898C15.2863 1.5043 15.5084 2.04044 15.5084 2.59948C15.5084 3.15851 15.2863 3.69466 14.891 4.08998L7.02104 11.962Z" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n'},62759:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" xmlns="http://www.w3.org/2000/svg">\n  <path d="M7.5 13.5V10.5L5.5 8.50002C5 8.00003 4.99999 7.25 5.5 7.00003C6.86254 6.31887 7 6.5 7.99999 6.00002C8.99999 5.50003 9.5 5.50001 10 7.00002L10.5 8.50004L13.5 8.50002" stroke-linecap="round"/>\n  <path d="M3 15.5C4.38071 15.5 5.5 14.3807 5.5 13C5.5 11.6193 4.38071 10.5 3 10.5C1.61929 10.5 0.5 11.6193 0.5 13C0.5 14.3807 1.61929 15.5 3 15.5Z" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M12 15.5C13.3807 15.5 14.5 14.3807 14.5 13C14.5 11.6193 13.3807 10.5 12 10.5C10.6193 10.5 9.5 11.6193 9.5 13C9.5 14.3807 10.6193 15.5 12 15.5Z" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M11 1.5C11.3978 1.5 11.7794 1.65804 12.0607 1.93934C12.342 2.22064 12.5 2.60218 12.5 3C12.5 3.39782 12.342 3.77936 12.0607 4.06066C11.7794 4.34196 11.3978 4.5 11 4.5C10.172 4.5 8 3 8 3C8 3 10.172 1.5 11 1.5Z" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n'},47304:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" xmlns="http://www.w3.org/2000/svg">\n  <path d="M4.5 3.5H11.5" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M4.5 6.5H11.5" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M4.5 9.5H7.5" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M13.5 0.5H2.5C1.94772 0.5 1.5 0.947715 1.5 1.5V14.5C1.5 15.0523 1.94772 15.5 2.5 15.5H13.5C14.0523 15.5 14.5 15.0523 14.5 14.5V1.5C14.5 0.947715 14.0523 0.5 13.5 0.5Z" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M1.5 12.5H14.5" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n'},52496:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" xmlns="http://www.w3.org/2000/svg">\n  <path d="M4.5 12.5V14.5H0.5V12.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M15.5 12.5V14.5H11.5V12.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M15.5 7.5H0.5V12.5H15.5V7.5Z" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M3 11C3.55228 11 4 10.5523 4 10C4 9.44772 3.55228 9 3 9C2.44772 9 2 9.44772 2 10C2 10.5523 2.44772 11 3 11Z"/>\n  <path d="M13 11C13.5523 11 14 10.5523 14 10C14 9.44772 13.5523 9 13 9C12.4477 9 12 9.44772 12 10C12 10.5523 12.4477 11 13 11Z"/>\n  <path d="M0.5 7.5L2.272 2.184C2.408 1.775 2.79 1.5 3.221 1.5H12.779C13.209 1.5 13.592 1.775 13.728 2.184L15.5 7.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n'},86696:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" xmlns="http://www.w3.org/2000/svg">\n  <path d="M3.5 8.5V11.9648C3.5 12.2992 3.66819 12.6099 3.97304 12.7472C4.63034 13.0433 5.97266 13.5 8 13.5C10.0273 13.5 11.3697 13.0433 12.027 12.7472C12.3318 12.6099 12.5 12.2992 12.5 11.9648V8.5M14.4182 5.54402L8.0237 8.98724C8.00891 8.9952 7.99109 8.9952 7.9763 8.98724L1.58176 5.54402C1.5467 5.52515 1.5467 5.47485 1.58176 5.45598L7.9763 2.01276C7.99109 2.0048 8.00891 2.0048 8.0237 2.01276L14.4182 5.45598C14.4533 5.47485 14.4533 5.52515 14.4182 5.54402Z" stroke-linecap="round"/>\n  <path d="M14.5 5.5V10.5" stroke-linecap="round"/>\n  <path d="M14.5 12.5V13.5" stroke-linecap="round"/>\n</svg>\n'},329:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" xmlns="http://www.w3.org/2000/svg">\n  <path d="M9.5 0.5H6.5V15.5H9.5V0.5Z" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M3.5 10.5H0.5V15.5H3.5V10.5Z" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M15.5 5.5H12.5V15.5H15.5V5.5Z" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n'},33674:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" xmlns="http://www.w3.org/2000/svg">\n  <path d="M14.5 0.5V15.5" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M14.5 10.5H10.5V4.5C10.5 3.43913 10.9214 2.42172 11.6716 1.67157C12.4217 0.921427 13.4391 0.5 14.5 0.5V0.5" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M4.5 8.5V15.5" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M7.5 0.5V5.5C7.5 6.29565 7.18393 7.05871 6.62132 7.62132C6.05871 8.18393 5.29565 8.5 4.5 8.5V8.5C3.70435 8.5 2.94129 8.18393 2.37868 7.62132C1.81607 7.05871 1.5 6.29565 1.5 5.5V0.5" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M4.5 0.5V5.5" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n'},15633:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" xmlns="http://www.w3.org/2000/svg">\n  <path d="M4.5 6.5V8.5" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M3.5 7.5H5.5" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M15.475 12.28L14.5 6.00002C14.5006 5.38004 14.2709 4.78195 13.8553 4.32185C13.4398 3.86175 12.8681 3.57247 12.2513 3.51016C11.6344 3.44785 11.0164 3.61697 10.5173 3.98467C10.0181 4.35238 9.67339 4.89244 9.55002 5.50002H6.45002C6.32664 4.89244 5.98192 4.35238 5.48275 3.98467C4.98359 3.61697 4.3656 3.44785 3.74877 3.51016C3.13193 3.57247 2.56025 3.86175 2.1447 4.32185C1.72916 4.78195 1.49939 5.38004 1.50002 6.00002L0.525016 12.28C0.482593 12.4695 0.496246 12.6672 0.56431 12.8491C0.632373 13.0309 0.751903 13.189 0.908308 13.304C1.06471 13.4191 1.25123 13.4861 1.44509 13.497C1.63895 13.5078 1.83177 13.4619 2.00002 13.365L6.50002 10.5H9.50002L14 13.365C14.1683 13.4619 14.3611 13.5078 14.5549 13.497C14.7488 13.4861 14.9353 13.4191 15.0917 13.304C15.2481 13.189 15.3677 13.0309 15.4357 12.8491C15.5038 12.6672 15.5174 12.4695 15.475 12.28Z" stroke-linecap="round" stroke-linejoin="round"/>\n  <line x1="11.5" y1="6" x2="11.5" y2="7"/>\n  <line x1="10.5" y1="8" x2="10.5" y2="9"/>\n  <line x1="12.5" y1="8" x2="12.5" y2="9"/>\n</svg>\n'},40216:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" xmlns="http://www.w3.org/2000/svg">\n  <path d="M2.5 2.5C2.47884 1.99197 2.65985 1.49625 3.00341 1.1214C3.34696 0.746547 3.82505 0.523105 4.333 0.5C7.045 0.5 8 4.5 8 4.5H4.333C3.82496 4.47716 3.34671 4.25379 3.0031 3.87888C2.65949 3.50397 2.47857 3.0081 2.5 2.5V2.5Z" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M13.5 2.5C13.5212 1.99197 13.3401 1.49625 12.9966 1.1214C12.653 0.746547 12.1749 0.523105 11.667 0.5C8.955 0.5 8 4.5 8 4.5H11.667C12.175 4.47716 12.6533 4.25379 12.9969 3.87888C13.3405 3.50397 13.5214 3.0081 13.5 2.5V2.5Z" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M13.5 9.5V14C13.5 14.3978 13.342 14.7794 13.0607 15.0607C12.7794 15.342 12.3978 15.5 12 15.5H4C3.60218 15.5 3.22064 15.342 2.93934 15.0607C2.65804 14.7794 2.5 14.3978 2.5 14V9.5" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M15.5 4.5H0.5V7.5H15.5V4.5Z" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n'},15479:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" xmlns="http://www.w3.org/2000/svg">\n  <path d="M14.328 2.67201C12.766 1.11001 10.233 1.11001 8.67101 2.67201C8.39101 2.95201 8.18001 3.27001 8.00001 3.60101C7.82001 3.27001 7.60901 2.95101 7.32801 2.67101C5.76601 1.10901 3.23301 1.10901 1.67101 2.67101C0.109012 4.23301 0.109012 6.76601 1.67101 8.32801L8.00001 14.5L14.328 8.32801C15.891 6.76601 15.891 4.23401 14.328 2.67201Z" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n'},59250:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" xmlns="http://www.w3.org/2000/svg">\n  <path d="M14 6.50001C13.8875 6.50106 13.7755 6.51448 13.666 6.54001C13.2596 5.3606 12.4952 4.33742 11.4795 3.61314C10.4639 2.88886 9.24747 2.49957 8 2.49957C6.75253 2.49957 5.53614 2.88886 4.52046 3.61314C3.50478 4.33742 2.74044 5.3606 2.334 6.54001C2.22447 6.51448 2.11246 6.50106 2 6.50001C1.60218 6.50001 1.22064 6.65805 0.93934 6.93935C0.658035 7.22066 0.5 7.60219 0.5 8.00001C0.5 8.39784 0.658035 8.77937 0.93934 9.06067C1.22064 9.34198 1.60218 9.50001 2 9.50001C2.03 9.50001 2.059 9.49301 2.089 9.49101C2.32152 10.8908 3.04325 12.1626 4.1257 13.0801C5.20814 13.9975 6.58105 14.5011 8 14.5011C9.41895 14.5011 10.7919 13.9975 11.8743 13.0801C12.9567 12.1626 13.6785 10.8908 13.911 9.49101C13.941 9.49101 13.97 9.50001 14 9.50001C14.3978 9.50001 14.7794 9.34198 15.0607 9.06067C15.342 8.77937 15.5 8.39784 15.5 8.00001C15.5 7.60219 15.342 7.22066 15.0607 6.93935C14.7794 6.65805 14.3978 6.50001 14 6.50001V6.50001Z" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M5.5 8.5C6.05228 8.5 6.5 8.05228 6.5 7.5C6.5 6.94772 6.05228 6.5 5.5 6.5C4.94772 6.5 4.5 6.94772 4.5 7.5C4.5 8.05228 4.94772 8.5 5.5 8.5Z"/>\n  <path d="M10.5 8.5C11.0523 8.5 11.5 8.05228 11.5 7.5C11.5 6.94772 11.0523 6.5 10.5 6.5C9.94772 6.5 9.5 6.94772 9.5 7.5C9.5 8.05228 9.94772 8.5 10.5 8.5Z"/>\n  <path d="M6.39301 11.107C6.88932 11.3652 7.44054 11.5 8.00001 11.5C8.55947 11.5 9.11069 11.3652 9.60701 11.107" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M7.99999 2.5C7.75336 2.50011 7.51057 2.56103 7.29311 2.67737C7.07564 2.79371 6.89022 2.96187 6.75325 3.16697C6.61629 3.37207 6.532 3.60777 6.50787 3.85322C6.48374 4.09866 6.5205 4.34627 6.61489 4.57412C6.70929 4.80196 6.85841 5.00302 7.04905 5.15949C7.23969 5.31595 7.46597 5.423 7.70785 5.47114C7.94973 5.51929 8.19975 5.50705 8.43578 5.43551C8.6718 5.36397 8.88654 5.23534 9.06099 5.061" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n'},37689:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" xmlns="http://www.w3.org/2000/svg">\n  <path d="M11.5 10.75C11.5 10.75 15.5 8.00001 15.5 5.75001C15.5024 5.28342 15.3591 4.82771 15.0901 4.44646C14.8211 4.06522 14.4398 3.77745 13.9994 3.62331C13.559 3.46917 13.0814 3.45634 12.6334 3.58661C12.1853 3.71688 11.7891 3.98376 11.5 4.35001C11.2109 3.98376 10.8147 3.71688 10.3667 3.58661C9.91863 3.45634 9.44109 3.46917 9.00068 3.62331C8.56028 3.77745 8.17897 4.06522 7.90995 4.44646C7.64094 4.82771 7.49763 5.28342 7.50003 5.75001C7.50003 8.00001 11.5 10.75 11.5 10.75Z" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M11.5 10.753C11.0645 11.1891 10.8199 11.7802 10.8199 12.3965C10.8199 13.0128 11.0645 13.6039 11.5 14.04C11.8899 14.4307 12.1253 14.9493 12.163 15.5" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M5.85599 15.5C6.01057 15.0489 6.03574 14.5636 5.92863 14.0989C5.82153 13.6343 5.58644 13.2089 5.24999 12.871C5.01218 12.6333 4.82354 12.351 4.69483 12.0404C4.56612 11.7297 4.49988 11.3968 4.49988 11.0605C4.49988 10.7242 4.56612 10.3913 4.69483 10.0806C4.82354 9.76998 5.01218 9.48773 5.24999 9.25" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M9.385 1.51802C9.13837 1.21327 8.82932 0.964891 8.47866 0.789589C8.12799 0.614287 7.74384 0.516132 7.35207 0.501731C6.96029 0.487329 6.56997 0.557015 6.20738 0.706098C5.84479 0.855181 5.51834 1.0802 5.25 1.36602C4.87267 0.964714 4.38343 0.686071 3.84578 0.566244C3.30813 0.446417 2.74688 0.490937 2.23484 0.694027C1.7228 0.897117 1.28362 1.2494 0.974269 1.70518C0.664919 2.16095 0.499683 2.69918 0.5 3.25002C0.5 6.00002 5.25 9.25002 5.25 9.25002C5.25 9.25002 5.714 8.93202 6.35 8.41102" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n'},92732:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" xmlns="http://www.w3.org/2000/svg">\n  <path d="M13.5 15.5H2.5L0.5 12.5H15.5L13.5 15.5Z" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M7.5 0.5V9.5H1.5L7.5 0.5Z" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M10.5 9.5V3.5L14.5 9.5H10.5Z" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n'},5231:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" xmlns="http://www.w3.org/2000/svg">\n  <path d="M4.5 3.5H11.5C12.2956 3.5 13.0587 3.81607 13.6213 4.37868C14.1839 4.94129 14.5 5.70435 14.5 6.5V15.5H1.5V6.5C1.5 5.70435 1.81607 4.94129 2.37868 4.37868C2.94129 3.81607 3.70435 3.5 4.5 3.5V3.5Z" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M5.5 5.5V3C5.5 2.33696 5.76339 1.70107 6.23223 1.23223C6.70107 0.763392 7.33696 0.5 8 0.5V0.5C8.3283 0.5 8.65339 0.564664 8.95671 0.690301C9.26002 0.815938 9.53562 1.00009 9.76777 1.23223C9.99991 1.46438 10.1841 1.73998 10.3097 2.04329C10.4353 2.34661 10.5 2.6717 10.5 3V5.5" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M6.5 8.5H9.5C10.0304 8.5 10.5391 8.71071 10.9142 9.08579C11.2893 9.46086 11.5 9.96957 11.5 10.5V12.5H4.5V10.5C4.5 9.96957 4.71071 9.46086 5.08579 9.08579C5.46086 8.71071 5.96957 8.5 6.5 8.5V8.5Z" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n'},27514:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" xmlns="http://www.w3.org/2000/svg">\n  <path d="M8 0.73999L9.731 6.26899H15.5L10.916 9.71399L12.718 15.26L8 11.832L3.282 15.26L5.084 9.71399L0.5 6.26899H6.269L8 0.73999Z" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n'},10311:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" xmlns="http://www.w3.org/2000/svg">\n  <path d="M3.5 4.5V14.5" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M12.5 4.5V14.5" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M5.5 4.5V1.5H10.5V4.5" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M14 4.5H2C1.17157 4.5 0.5 5.17157 0.5 6V13C0.5 13.8284 1.17157 14.5 2 14.5H14C14.8284 14.5 15.5 13.8284 15.5 13V6C15.5 5.17157 14.8284 4.5 14 4.5Z" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n'},94192:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" xmlns="http://www.w3.org/2000/svg">\n  <path d="M7.729 11.229L14.5 5.5L15.5 0.5L10.5 1.5L4.771 8.271" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M12.5 3.5L7.5 8.5" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M0.5 14L4.086 10.414L1.586 7.914L3 6.5L9.5 13L8.086 14.414L5.586 11.914L2 15.5L0.5 14Z" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n'},23389:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" xmlns="http://www.w3.org/2000/svg">\n  <path d="M12.5 1.5H13.5C13.7652 1.5 14.0196 1.60536 14.2071 1.79289C14.3946 1.98043 14.5 2.23478 14.5 2.5V14.5C14.5 14.7652 14.3946 15.0196 14.2071 15.2071C14.0196 15.3946 13.7652 15.5 13.5 15.5H2.5C2.23478 15.5 1.98043 15.3946 1.79289 15.2071C1.60536 15.0196 1.5 14.7652 1.5 14.5V2.5C1.5 2.23478 1.60536 1.98043 1.79289 1.79289C1.98043 1.60536 2.23478 1.5 2.5 1.5H3.5" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M10.5 0.5H5.5V2.5H10.5V0.5Z" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M5 9L7 11L11 7" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n'},98835:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" fill="none" stroke="currentColor" xmlns="http://www.w3.org/2000/svg">\n  <path d="M13.5 3.5H15.5" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M10.5 6.5H2C1.60218 6.5 1.22064 6.34196 0.93934 6.06066C0.658035 5.77936 0.5 5.39782 0.5 5V2C0.5 1.60218 0.658035 1.22064 0.93934 0.93934C1.22064 0.658035 1.60218 0.5 2 0.5H10.5L13.5 1.5V5.5L10.5 6.5Z" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M7.5 6.5L6.687 10.565C6.63667 10.8169 6.68525 11.0786 6.82266 11.2957C6.96006 11.5128 7.17575 11.6687 7.425 11.731L9.364 12.216C9.68846 12.2972 9.97649 12.4844 10.1823 12.7481C10.3881 13.0117 10.5 13.3365 10.5 13.671V15.5H0.5V13.427C0.499917 13.1484 0.57743 12.8753 0.723853 12.6382C0.870276 12.4012 1.07982 12.2096 1.329 12.085L2.063 11.719C2.19933 11.6507 2.31824 11.5521 2.41062 11.4308C2.503 11.3094 2.56641 11.1686 2.596 11.019L3.5 6.5" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M10.5 0.5V6.5" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M2.5 4.5H5.5" stroke-linecap="round" stroke-linejoin="round"/>\n  <path d="M2.5 2.5H5.5" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n'},35533:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n<path d="M2 4.54545L8 1L14 4.54545L8 8L2 4.54545Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M14 8L8 11.5L2 8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n<path d="M14 11.5L8 15L2 11.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n</svg>\n'},74314:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 229 137">\n  <g fill-rule="evenodd" class="world-map">\n    <path d="M115.628 29.371v-.008l.009-.017-.009.025zm-2.821 16.41-.049.45.205.165-.156-.615z"/>\n    <path d="m214.485 13.354.074-1.5-.491-1.113-2.47.172.254.9-2.6-1.097-5.782-.795-3.336.615.163.942.769.483-.164 1.123-1.21-.697-.654-1.196-1.987 1.475-7.801.328-.851-.533-1.365-.197-1.849-1.204-4.391 1.073-.368.287.401.656.319 1.27-1.824.303-2.15.286-1.48.91-.794-.344.376-.295-.686-.64-.81-1.138-2.928.877-1.717.516h-.286l-.826-.27-3.295.122-.9.066-.965.458.63.18-1.153.353.335-4.965-.891-.639-.197.09-1.226-.77-1.627.893-1.268-.786-.973-.893-.981 2.957-.098.23-1.096 1.196-.736-.45-.605.483-.769.975-2.494 3.006 1.357 1.278-2.387.754.073 1.991 2.257 1.303-.016 1.565-.442-1.737-3.173-.967-.106.655-.016.066v-.066l-.262.443 1.267 1.31-1.692-.385-.81-1.18.761 3.024 2.069 1.704-.368 2.237-.834 2.163-1.211-.492 1.112-2.589-2.706-6.251-2.225 2.261.385 2.31.531.82.385.024.801.623-.998.098-4.587-1.368.024.77.458 1.655-.18-.065-2.747.598-.842-.508-2.405 1.786-1.545.155-1.366-1.114.597 1.852-.482.926-1.309.933.115 1.107-2.045-.132.565 1.549-2.29-2.802-1.03-.885 3.99-1.761-4.399-1.54-.401-.599-.769.189-.801-.254.793-.721-1.521-.238-.139-.287-.924.394-.45-.5-1.602.696-.287.353-1.594.844.016-.017h-.196l.024.017-.507.303-.016.016-.376 1.008-.728.082-.041-.631-.736 1.27.924.14-.286.286-.335.672-.63.925-.589 2.016-.703.827-1.349 1.155-.049.476-1.799 1.155.253 2.515-.114 1.286 3.238-.459.859 2.172.531 1.425 1.358-.197.826-.319.188-.77.858-2.188-.736-3.613 2.012-2.482 2.012-1.614-1.906 2.958.826 3.146 4.539.245-3.083.844-.769.926.196.287.532 1.335-1.537 1.893-4.285 1.548-.614-.77-2.02.131.622-.237.057-.557-.58-.476.294-.663-1.423-.566-2.134 3.941-1.701 2.024-.851.95-1.39.205-.049.664-1.782.294 1.39 1.467.474 2.9h-3.614l-1.448.656-.261 3.31 2.191 2.416 1.881-.36 2.339-1.852 1.921-3.31 2.192-.368 3.704 1.155 2.298 3.13-1.832.5 2.601-.37 1.235-1.67-1.669-1.688-2.347-1.958.597-.762.728.311.973 1.016 2.642 3.072 1.014 1.917 1.48.787.777-.901-1.064-2.098.982-.41 1.145 1.377.498.164-.458.508.581.434.703.991 2.061.18 1.865.328 1.799-.516-1.284 4.301-7.744-1.147-4.457 1.18-4.015-1.892.123-1.745.032-.787-2.093.016-4.375.386-4.048.761-1.529 1.344-1.88 3.228-2.127 1.614-1.88 2.515-.63 3.843-.72 3.236 1.366 2.195 1.496 1.893 4.007 3.474 6.714-1.303 4.35 1.262.376 3.9 3.206 6.759-.605 2.097 1.005 7.267 2.331 6.652 2.232 2.18 4.408-.942 3.95-5.547 2.06-2.974 4.016-6.718-.638-2.843-.156-1.909 7.965-10.822.147-2.483-4.734.868-.704-1.433-1.946-1.794-1.096-1.73-1.48-2.94-1.161-1.582-1.03-3.383 2.42 2.76 1.006 1.852 2.633 3.597 4.318 2.27 3.295-1.926 2.813-1.745.475-.82.973-2.162-2.601-2.663-3.312.172-.695.27-1.725-2.72 1.161-.655 1.546 1.729 3.516.77 6.967 1.171 2.658 1.844-.736.303 2.428.385 1.153 4.49 3.549 5.636 1.309-2.72.376-2.802 2.519-2.31 1.774-2.155 2.756-.827 1.57 1.999.769 1.229 1.962 1.22.736 1.09.671 4.646 1.562 2.843 2.616 3.105h.058l-.115-1.156-2.061-3.203-1.398-2.18.834-2.547 1.685 1.36 1.504 2.032 1.554-1.107-.376-5.284-1.063-1.31 2.11-2.073 1.087.376.017.017v-.05l2.126-1.302 3.622-2.384.221-1.295.245-3.113-.016-1.262-.899-2.056-.099-2.573.916-.671-1.308-.516-1.047.614-.801-.655-.605-.476.834-.868 1.701-1.491-.115 1.122-.065.615.646-.221 2.78 1.188.638.77-.033.295.336 1.442.695.434-.736-4.515.85-2.498 1.047-1.835 2.085-1.008 1.554-5.915v-3.122l2.322 5.842.728.024-.908-1.45.139-2.441-3.598-5.686.098 1.008.327 1.523-.817-1.474-2.257.09-.728-.197-1.284-.794 1.349-4.99 2.642-2.392 1.545-.508.425-.647 1.742.925 1.439-.77-.408-.795.13-2.883 1.791-.942 1.848-.345.148-1.777.735 2.883-1.136 5.211 2.805 8.16 1.275-.754.409-1.007.45-2.237-.54-2.343.425-.32-.891-.876-.662-1.442-.221.303-.867-2.917.941-1.229.695.303 2.51-.819 2.576-5.03-1.21-2.114-.066.033-.662-.918-1.047-.524.18-3.056.229-.418 1.603-.582 1.406.27.998-.27-.638-.893-.319-.827-.008.008zm-52.008-2.18.049.042-.098-.074.057.033h-.008zm-41.288 18.754.18-.246.033.27-.213-.024zm1.865 13.314-.033-.058.09.09-.049-.032h-.008zm-17.361 41.12.082.065.016.032-.106-.09.008-.008zm21.114 9.077.646 1.9.433 1.27-1.071-3.17h-.008zm1.235-4.138.016-.04.041-.025-.057.065zm1.055 2.958-.344-1.294 1.063-.558-.719 1.852zm-1.587-33.77-2.78-1.295 1.963-2.884 1.087.582-.033.524.736.639 1.317-.959-1.079-.417 2.657-1.098-1.03 1.835 3.189 3.343-6.043-.27h.016zm12.324.827-2.576-4.326 3.279-1.532-.237 1.335-.654.844 1.48 2.065.776 2.212.205.401.679 2.18-2.944-3.171-.008-.008zm15.479-46.798.058.033.204.205-.262-.238zm3.181 2.139-.155 1.384-1.079-1.425h1.259l-.025.04zm.131-.164.573-.721.016-.025.303.246-.892.5zm8.636 35.147v-.04l.065.056-.065-.016zm7.735-4.408-1.3 1.025.221-.443 1.603-4.498-.524 3.924v-.008zM75.011 92.357l-2.91-.917-.876-.73-1.03-.032V87.94l-4.203-1.884-2.78-2.007-.998-1.123.065-.204-1.292-.156-1.112.401-1.685-.262-.695-.491-.613-.517-.638.697-.335-.828-2.854 1.09-1.178 1.827-4.325-1.237-.393-3.949-3.41-.516.4-1.45.581-1.082-1.455-1.499-1.292 1.884-1.022.238-2.928-1.475.409-5.767 4.17-1.369 2.012-.737 2.78.491 1.137 1.27 1.922 1.188-.368-3.957 2.674-2.064 1.226-.943.27-.827.924-2.163.5-.54 1.471-1.369-.033-.393 1.611-.189 1.399-2.482 1.488-.36.916-.295-.106 1.319 1.398-.877 2.65-1.098-.172-.819-2.356.401-.834-1.646-3.328.278 2.053-1.614 1.733-.966 4.98-.762 1.088-2.36-.622-.614-1.022-1.303-.458-1.942-1.202-4.039-2.674-.713-1.815-2.056-.924-.172h-2.2l-.376 1.54-1.03 2.982-2.028 4.35-.916 3.393-1.153-1.63.605-2.377-5.953-2.965.049-2.13-.597-.476 3.213-4.44.95-.967 1.152-.516.801.106 2.061-2.146-1.087 2.769.973.63 2.371-.048-.155-1.065-1.407-1.991-.687-.312.27-.278.098-.721 3.002-.344.4-2.147.883-1.163-.637-.795-.77-.45.025.024-.826 1.32-1.275 1.31-.94.623.057-2.729-1.08.91-.433-1.819.826-2.843.94-2.425 2.396-1.933-4.097 3.031-.548.77-1.096 1.106.606 2.425-.377.901-1.872 2.212.147-1.556-.474-.54.098.097-.025-.024 1.26-.901.466-.64-1.022-.639-.85 2.024-.033-.024.024.024-1.186.934-1.226-.164-1.865-1.048-.965-.697-1.39.885-.523 1.155-3.467-2.466.94-1.294-2.29-1.352-2.24-.86.155-1.188-1.218-1.516-1.047 1.008-.425-.156h-.066l-3.099.189-1.513.32-1.055-1.18-1.815-1.95-1.26-.427-2.526-1.515-.523-1.385-.916-.786-2.02-.27-1.513.458-5.037 1.696-.687.131-.393 1.72.524 2.22-.221.312.294.598.025.205-1.162.434-.662-1.302-3.034.9.188 1.082-.425.877 3.386.696-.327.508-1.489 1.295-1.145.508-.597-.312-2.183 2.008-.294 1.728 1.243 1.327-.434 1.647-.114.73.744-.197 1.815.606L0 36.597l2.764-.836 1.153.025 4.767-2.67 1.407-.918.049-.975 3.36-2.147.352.508-1.087.131-.932 1.72 2.02-.139.547-.377.385-.335.155-.705.802.172 1.03 1.655 1.529.63.973.59.466 1.082.998.647-.352 1.983-.024-.016v.049l.04 1.27.516-.615 1.161-1.18.057 1.565-.973.508-.114.418v.967l.662-.246.237.082.213.459-.164.188.524.492-.279.606-.245.32-.155.524.94.14-.327 1.048.36 1.04v.025l.016-.016 1.341 2.04.221.893-.376 1.384.016.033-.032-.025-1.808-3.13 1.66 2.967-.024-.017-1.627 5.653v5.612l.588 2.655 1.587 1.483 1.488 3.834.115 1.68 1.627 1.679 1.308 2.228-.49-2.187-1.8-5.047 1.145 1.614 1.824 3.097 2.47 3.891-.123 1.369 5.225 2.933 2.633.049 4.359 2.114 1.21 1.409.425.991 1.063.713 1.538.598 1.153-.156 1.799 1.237.147 2.155-2.085 2.155.09 2.466-.687 2.654 3.508 5.162 4.563 5.342.082 10.798-.442 4.317.336 2.671.556 1.385-.074 2.4-.303-.287-.793 1.27.973.975-.212 1.368.531 1.229.025-.024.474.147-.229 1.237.769.639.9.951-1.08-.393 1.897.991.45.631.777.647 1.112.254.433-.262.834-.41.859-.426-2.094-1.204-1.52-.025.416-.885.205-.999 1.267-4.08-.335-2.425.573-1.991.139-.803-.68-1.04 1.653-.214 2.51-1.958.499-1.966-.908-1.54 4.024-2.188.016.025v-.025l.711-1.204.442.074 1.382-4.236 2.412-1.802 2.396-.951 1.317-6.398 2.216-5.539-3.01-1.81-3.377-.344v-.017zm-10.908-44.97.032.025h-.049l.017-.025zm-9.044 7.963-.761.762-1.235-.336 1.995-.434v.008zm-3.173-1.065-.875 1.582-.802-.525-.826-1.507-1.831 3.301.147-2.859 2.78-1.245 1.415 1.253h-.008zm-5.561-2.883 3.058-.386.614.705-.156.901-1.807-.385-.163-.147-1.358.204-1.137-.171.949-.721zm-4.686-6.26.385-.893-.017.066-.351.835h-.017l.058.615-.23-.262.172-.36zM21.098 36.68l-.041.017.04-.074v.065-.008zm9.845-17.008-.049.049.066-.082-.017.033zm.32 14.386-.034.025.058-.066-.033.05.008-.009zm1.316 7.03-.074-.017h.14l-.074.017h.008zm1.292-7.906-.05-.041.083.057-.033-.016zm.155-5.874.425-1.164.54-.197-1.742-.68 2.617.361 1.44.197-.573.934-.409.139-1.922.82-.376-.41zm2.388 6.488-1.905-.237 1.537-.533.123-1.139 3.418.262-3.173 1.647zm25.08 101.714-.106.237-.36-.229h.466v-.008zM70.4 91.022l-.237-.336.319.18-.09.156h.008z"/>\n    <path d="m44.559 23.833.834.598.302-.189-1.136-.41zm46.93 4.072.744-1.221 1.717-.5-1.128-2.18 1.333.09-.94-.917 1.234-.819.908-.147.024-1.467.605-.942-.155-.934-.425-.533-.205-.204 1.407.761-.23-2.048-.138-.327-.254-.992 1.603-3.211.597-1.057.442-.697-.115-.262.973-.401.115-.344-.524-2.024-1.308.664-.515-.115-2.404 1.606 1.21-2.786-.76.787-.95-.156-2.78-.418 5.823-1.335-1.954-1.205-4.31-.77 4.179-.467-4.915-.753.025.188-.704.23-1.79-.14-.606 1.278-1.202 2.016.074-.435-1.022-1.523-1.219 1.843-.253-1.663-.982 1.77.336-2.139-2.731 1.024-1.44 1.221-1.022.033-1.48 2.36-1.251 1.638-3.304 2.236L73.4 13.56l-1.782 1.327-.385.557 1.153.746.262-.09 1.496.13 2.102 1.582.082 1.352.114.598v.704l.033 1.696-.278.68.057.328v.508l-.237.172v.025l.017-.017.605 1.024.613-.147-.025-.025.14.074-.148 1.32.336.425-1.399-.672-.466.762.826.328 1.047.918.024-.025-.49.869-.892 1.065-.728 1.81-.384 1.696 1.03 1.237-.425 1.81v.05l.23.795.245 1.04.703 1 1.202.04 2.625-1.867.907-1.074.328-1.13.286-.721 2.15-.82 3.427-2.63 5.634-2.35-1.987-.713.04-.041zM90.377 2.548l.024.008v-.025l-.024.017zm122.154 105.687-2.486-3.031-.507-2.917-1.014-1-1.006-2.228-4.015 3.695.155-2.95-1.275-.04-2.151-.656-2.053 2.597-.711.14-1.129-.721-1.889 1.753-.425.131-.302.639-1.603 1.524-3.933 1.384-1.358.869-.507.287-.392 1.745-.123 1.851.008-.016.483 5.26-.18 1.843 3.025-.467 3.836-1.04 4.473-.869 4.342 1.647-.973 1.876.842-.221.074.639.523.139.262 2.278 3.074.663.671 1.09 4.105-3.744 2.674-3.843.875-3.613.237-2.433-1.014-.852-.613-1.409zM65.869 8.586l-.04.016h.007l.033-.016z"/>\n    <path d="m65.305 14.108.441.582 1.358-1.45 1.284-1.238.36-.393.768-.467 1.12-1.712.597-.385-.278-.287 1.358-.45h1.161l3.917-3.163 3.214-1.9-.434-.648-1.52-.688-.377-1.032L76.41.336l-.278-.352-1.611.655-.287-.508-1.112.385-.94-.287-.712.934L70.457.32l-.442 1.36-.916-.385-.442-.254-.785.123-.85 1 .229-.066-.164.377.09.991.426 1.082 1.52.573 2.421-.163.54.688-3.042.139-.376.967-1.906-.475.278 2.818-2.584.369.417 1.155-.245.729-.409-.852-.621 1.335-.017.017-2.388.434 2.593 1.475 1.513.32.008.032zm2.461-9.668-.057.033.073-.074-.016.033v.008zm-1.496 7.824v.066l-.172.156.172-.222zm-.892-1.974-.024.041-.041.016.065-.065v.008zm-.409 1.442-.032-.057.082.057h-.05zm3.598 21.613 1.235-2.753.025.016v-.213l-.67-.77-.27-.377-1.268-.991.229-.877.646-.794-1.464-2.376-.687-1.057-.703-.213.123-.582-1.12-1.458-1.383.237-.613.156-1.979-1.966-.63 1.499-.523.573-.245-.352 2.003-2.58-3.508 4.03-.793 1.188.916.476 1.619.638 1.447.189.54.41.752-1.254.475.623-.066.63.524 1.328-.278.434.736.05-.14.556.704 2.032-1.071.836-.385 1.188-2.952.663 3.197 1.762.753 1.327 1.316-.926 2.102 1.696.474-1.417-.45-1.59-.866-1.589.638-.45 1.594 2.015.016.033zm-5.985-11.92-.025-.026.074-.081-.05.106z"/>\n    <path d="m64.626 20.875.016.025h.009l-.025-.025zm-.85 14.747-.009-.016h-.008l.017.016zM44.567 15.181h.008l.025-.008-.033.008z"/>\n    <path d="m48.942 21.154.147-1.942 1.905-2.99-1.382.54-2.494 2.114-.09-2.31-1.136.59-.94-.828.17-1.335-.547.188-3.058 1.622.875 1.303-1.431.352 2.805 2.327-2.061 1.622 2.126 1.287 2.093-.517 2.584.754-.36-.762.638-.237.156-1.778zm152.443 72.563 2.821.762.941 1.63.359.697 1.374.68 2.756-1.032 2.355 1.86.769-.746-1.922-2.728-4.342-2.425-3.451.606-1.407-1.852-1.987.418.736.5 1.268.418-.965.262.695.95zm-12.16-7.889-2.142 2.236-1.497 1.393-1.554 1.016.843 2.155.834.385.695.336 1.823.426 1.023-.934 1.635-2.704-.523-1.327.245-2.368-1.382-.614zm-50.365 15.984-1.856 3.392 1.349 3.858 2.658-9.708-.638.852-1.513 1.606zm-1.766-75.358-1.218-4.915 2.216-4.367 1.635-1.868-2.134.574-1.979 1.048-.867 1.524-.376.328-.401.328.033 3.023-.123 1.466-.4 1.303 1.357.565 2.257.991zm61.707 35.991-.638 1.27 1.079-.45v-1.156l.516.73 2.355-1.04.564-.615.262.344v-3.023l-1.096-3.679-.164 2-1.431 2.383-1.3 1.86-1.472 1.794.335-.172.982-.23.008-.016zm3.083-7.275.032-.016-.057.049.017-.033h.008zm-5.365 9.348v.033l.875 1.049-.18-2.417-.85 1.032.155.303zm.679-1.524.016.189.27-.336-.286.147zM63.179 7.16l-.696 2.319 1.464-.033.008.041 1.546-1.229.785-1.614-.278-2.27-.335-2.244-.646.303.335.279-1.022.91-.524.106-.67.426.613.86-1.455 1.237.875.91zm1.815 1.59-.016.008-.017.025.033-.033zm116.135 83.5-.76-.794-.033-.827-1.782-1.491-4.294-2.581 2.511 3.211 5.258 3.196.417-.172-1.317-.541zM39.587 17.23l1.235-.55 2.878-1.335 1.063-2.302-3.36-.918-2.97 3.409.083 1.163 1.07.532zm4.138-1.893-.025.008-.008.016.033-.024zm59.752 31.427-.401 1.459-.351 1.319 1.095.688-.785.352 3.042.115.573-.942-.556-1.311-1.963-2.999.433-1.319-1.087-.524-.802-.467-.719 1.098.801 1.655.72.876zm9.805-31.919-.319 1.655.449 1.254 1.914-2.999.564 1.991 1.464-.852-1.071-.836-.246-.713-1.259-.974-2.061-.943v.36l-.858-.171-.949 1.163 1.75.828.622.245v-.008zm-.401-1.376-.033-.025-.033-.049.074.074h-.008zm-51.698-.361-.924-.909-1.799-1.188.14 1.508.703 1.605-.59 1.54 1.342.5.286.566 3.925.696.81-1.925-3.328-.68-1.309-1.082.205-.32.049.009-.017.016.507-.336zM48.885 9.127 47.143 10.2l.008.745-.949.697 2.167.688.949.82 2.69-.107.597-1.786-.4.246-.254-.394-.842-1.171-.336 1.032-.237.77-1.177-1.966-.474-.647zm168.961 124.579 3.77-1.147 1.611-1.138 1.553-3.105-1.12-.287-5.814 5.677zM97.556 34.418l-.441-.828-.752-.057-1.203.221-.842.058-.679.803-.989-1.057-.826.77.744.68-.654.245.744.934 2.29.96 2.608-2.73zm50.152-28.97.532 1.139 3.492.098-1.987-2.17-1.636.483.319-1.057-.491-.836-1.512-.64-.27 2.459.948.524h.605zm79.436 118.296-.736-2.728-.352-.213-.613 5.26.311 1.892 1.831-1.18.736-.434.679-1.655-1.856-.942zM177.213 7.734l.899-.336.605-1.204-1.627-1.016.123 1.384-.54-1.007-.981.54-1.472 1.016 1.431 1.303 1.57-.672-.008-.008zm.122-1.057.033.033-.082-.074.049.033v.008zm-1.537-.54v.04l-.106-.09.106.05zM52.45 17.033l.016 1.048-1.333-.139.466 1.336.5 1.614.694-.295 1.546-1.32-.335-1.482.948-.738-1.055-.688.017.025-1.464.639zM192.373 90.53l.066 1.049 2.895-1.999-2.961.95zm-.932 3.45.564.843.254-1.835 1.186 1.303.474-.615-.45-.827.9-1.024-1.922-.172-.008-.074-1.317.91.319 1.49zM69.197 49.345l-2.077 3.007 2.502.5.189.377.637.163.867-.745-.016-.836-.164-.54-1.382-.574-.474-.344-.082-1.008zM47.699 7.988l-.352 1.147 1.398-.606.916-1.967h-1.234L44.6 8.89l1.864.23 1.235-1.131zm69.066 5.162 1.276-1.942-1.742-.344-.229-.082-.679.278-1.112-.336-.409.992 1.276.483 1.619.95zm-61.805-.918-.72-1.77.524 1.794.196-.024zm1.088 1.696 1.308-2.581-1.586.811-.81.074.327.795.76.9z"/>\n    <path d="m102.103 48.042.237-1.327-1.684-.18-1.006 1.172-.107 1.999 2.56-1.664zm99.225 2.319-.074 2.376-.335.237-.246.705.679 1.106.548-.614-.278-.55 1.619.238.892-1.966-.352-.352-2.453-1.18zM59.327 6.595l-.793-.762-1.17.172-.506.525-.14.704 1.153 1.745 1.456-2.384zm127.502 89.662.295-.41-2.086-.212-2.281-.517-.589 1 4.22.827.441-.688zm5.872-19.638-1.497 1.942.695 1.204.491.721.916-.033-.458-.623-.27-.68.417-1.736-.294-.795zm1.431 4.424-.507-.598h-.066l-.253.008.858 1.18-.032-.59zM47.061 74.341l1.873-.204 2.804 1.196.041.385 2.16.065-4.916-2.466-1.962 1.024zM153.31 8.766l1.644-1.827-2.486-.123.016.131.826 1.82zm39.93 76.431.205.164 2.273 1.09.327-1-.319-2.302-1.137 1.204-1.349.844zM55.124 76.652l-.859.614 1.668.336 2.282-.705-2.862-1.065-.23.82zm5.896-67.91-.025.024-1.545.336 1.57-.32v-.04zm67.185-.352-1.177.393.024-.025-.384.147-.106.615 1.03.188.613-1.319zm1.456-.77.163.122.63.54.581-1.089h-.188v.017l-.025-.017h.016l-.441-1.27-.793.91.049.344v.442h.008zm.679-.214-.041-.016-.041-.058.082.074zm-73.106 6.358-.041.008.024.016.017-.024zm156.245 80.764.671.738.801-1.467-1.464.68-.008.05zm-34.566-84.156-.032.393 1.946-.639-1.914.246zm16.273 72.596.221-.377-.458-1.4.041.647.098.172.098.958zM132.22 7.21l-.294.155.957.672-.663-.827zm58.886 89.883-1.03-.099-1.162.279 2.192-.18zm2.846-14.739-.025.025.335.852.025.024-.016-.524-.319-.377z"/>\n    <path d="m193.764 82.526-.017.033.017-.008.163-.172-.809-.64.646.787zM52.932 7.455l-1.447-.762-.074.082-.081.082 1.602.598zM8.398 34.82l1.44-1.631-.025-.025-1.415 1.655zm185.873 47.91.016-.007v-.017l-.016.025zm3.311 8.489.238-.664.278-.508-.156-.467.049-.377-.588 1.835-.025-.016.098.098-.302.148.408-.05zm15.717 6.537.483.18-.008-.04-.475-.14zM98.48 7.136l-.065-.131.008.262.058-.131zM77.244 24.89l.024-.025h-.024v.025zm-1.251-1.172.04.107v-.148l-.04.041zM3.41 36.499l.025-.008-.017-.017-.008.025zm150.113-24.931-.082-.049.008.04.074.01zM14.654 30.993l.008.041v-.073l-.008.032zm.008.041v.09l.025-.008v-.008l-.025-.074z"/>\n  </g>\n</svg>\n'},62077:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});const s="iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACfSURBVHgBvZIxCgMhEEXHkEZPscex1s7LZHMWwU5bvU1yCW3NuoEQwoy6BPY1Mvh9OirAn7Dvwhjz2IYFya3OuTsmuPzUC+Csm/w2I+iBSo4IUAkpkFKC1hqVTAkaSilK8uFKTaSUQAixC0opEGNEc90TMPZ+Zc45mSEFbefWgvceQgikgGwh5wzW2r2VHt07mOHoPxgKnqMFtdZh5lxeJo4r4FiF0c8AAAAASUVORK5CYII="},72536:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});const s="iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACfSURBVHgBvZIxCgMhEEXHkEZPscex1s7LZHMWwU5bvU1yCW3NuoEQwoy6BPY1Mvh9OirAn7Dvwhjz2IYFya3OuTsmuPzUC+Csm/w2I+iBSo4IUAkpkFKC1hqVTAkaSilK8uFKTaSUQAixC0opEGNEc90TMPZ+Zc45mSEFbefWgvceQgikgGwh5wzW2r2VHt07mOHoPxgKnqMFtdZh5lxeJo4r4FiF0c8AAAAASUVORK5CYII="},26591:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});const s="iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAyUlEQVR42q3TvQrCMBDAcV+ro7vvURx9AXVyaUGwuzinfsw66OYD+AJ2K21DUlooDaXEXOGki7mCDfy4G5L/lslsvvjLuAFz1j9MBwe01queped5F8dxthAZGti0bfvFGHsIISRGyEDTNDsjAEqpAALanH7EGqjr+tDnuu4+DMM78H3/DHesgaqqjhYnMlCW5bUoihuAHSciA+bBM8/zDuw4cScDUsqXDRngnL9RlmURTtzJQJIkPE3TDuw4ERmI41jZkIEhRv2NH2DDzUU+EiSYAAAAAElFTkSuQmCC"},86635:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});const s="iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAqUlEQVR4AWP4z4gfElbAYMNQw9AAhSkMzBgKgNIiDOxQGMXgg6mgQYVdBSgJwgx8DLkMtUiwgsEXqKCBBwGTeKP5ENBbkKEBpEAAAftBGEKC+WAFlaK4IVhBjhQCFkiCMAKCFYTKIWCELAhHyMbJgXCcHFiBk7KTsicYI6CLEgi7KIEV6KnrqauDMAJARIAQpKCWz1RQBzvkMgWGBYMjkGjADoEyjpTHJgCRpZrxxM2tswAAAABJRU5ErkJggg=="},68551:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});const s="iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAZElEQVR42mNgoBj8if/9/vd/MHz/ux6Lgl/3//j+NwbBP76/n/2u/y+ApuD3f4g0VMlmqGlg+Of+n3gUBejwj+/v93gV/Df+/X+IKHgPCyhs3vxzn+FXwq/7yIGDAt//SqA8MgF9hfa1XsQ+LgAAAABJRU5ErkJggg=="},13253:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});const s="iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAACxMAAAsTAQCanBgAAAAHdElNRQfiAxMIBBzsKlp7AAAA6klEQVQoz42RP04CURDGf8MObmyk8QSElhtQYGdBYSgJhhvABTCEI+AFJJGaUEDiRewojKEBJWGzBXlRGQoWeKsJOJN5k5l8b/59YsJJyXBGhBJlNIlmPNnmN6TNNWGiNSomaVW0EMOUAlMY05C29/mLV4V69pDYvPedN/QqmLQUDhMARSJyQESOCGyCgjtWYJHY/gWF2AOofYuav4PC3GsR2I+MeoDcNUePQF5hmYUQR5iALAMQXexurPCp4AhxKcCb7rzwcPUSrP2uR3bc5fpWuKFEkLptFYAhVYwP+cumDAA6993nf7G5BYxPRUIY3xtuAAAAAElFTkSuQmCC"},89661:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});const s="iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAbElEQVR42mNgoBj8if/9/vd/MHz/ux6Lgl/3//j+NwbBP76/n/2u/y+ApuD3f4g0VMlmqGlg+Of+n3gUBejwj+/v93gV/Df+/Z90BRi+wFQAcSCcpoKC97CAwuGGXwm/7iMHDoYJDFicTZICAK40+w1CznHyAAAAAElFTkSuQmCC"},78491:()=>{},70253:e=>{"use strict";e.exports=JSON.parse('{"M":{"pb":[["af","Afrikaans","Afrikaans"],["az","Azerbaijani","Azərbaycanca"],["be","Belarusian","Беларуская"],["bg","Bulgarian","български"],["ca","Catalan","Català"],["ca-valencia","Valencian","Valencià"],["cs","Czech","Čeština"],["da","Danish","Dansk"],["de","German","Deutsch"],["de-CH","German (Switzerland)","Deutsch (Schweiz)"],["el","Greek","Ελληνικά"],["en-US","English (US)","English (US)"],["en-GB","English (UK)","English (UK)"],["es","Spanish","Español"],["et","Estonian","Eesti keel"],["fa","Persian","فارسی"],["fi","Finnish","Suomi"],["fr","French","Français"],["fy","Frisian","Frysk"],["gd","Scots Gaelic","Gàidhlig"],["gl","Galician","Galego"],["hu","Hungarian","Magyar"],["hr","Croatian","Hrvatski"],["hy","Armenian","Հայերեն"],["id","Indonesian","Bahasa Indonesia"],["is","Icelandic","Íslenska"],["it","Italian","Italiano"],["ja-KS","Japanese (Kansai)","関西弁"],["ja","Japanese","日本語"],["kab","Kabyle","Taqbaylit"],["ko","Korean","한국어"],["ku","Kurdish","Kurdî"],["lt","Lithuanian","Lietuvių"],["nb","Norwegian (Bokmål)","Norsk (bokmål)"],["nn","Norwegian (Nynorsk)","Norsk (nynorsk)"],["nl","Dutch","Nederlands"],["pa","Punjabi","ਪੰਜਾਬੀ"],["pl","Polish","Polski"],["pt-BR","Portuguese (Brazil)","Português (Brasil)"],["pt-PT","Portuguese (Portugal)","Português (Europeu)"],["ro","Romanian","Română"],["ru","Russian","Русский"],["sk","Slovak","Slovenčina"],["sl","Slovenian","Slovenščina"],["sq","Albanian","Shqip"],["sr","Serbian","Српски"],["sr-Latn","Serbian (Latin)","Srpski"],["sv","Swedish","Svenska"],["tr","Turkish","Türkçe"],["uk","Ukrainian","Українська"],["vi","Vietnamese","Tiếng Việt"],["zh-CN","Chinese (Simplified)","简体中文"],["zh-TW","Chinese (Traditional)","正體中文"]]}}')}},n={};function s(e){var i=n[e];if(void 0!==i)return i.exports;var o=n[e]={id:e,loaded:!1,exports:{}};return t[e].call(o.exports,o,o.exports,s),o.loaded=!0,o.exports}s.m=t,e=[],s.O=(t,n,i,o)=>{if(!n){var a=1/0;for(c=0;c<e.length;c++){for(var[n,i,o]=e[c],r=!0,l=0;l<n.length;l++)(!1&o||a>=o)&&Object.keys(s.O).every((e=>s.O[e](n[l])))?n.splice(l--,1):(r=!1,o<a&&(a=o));if(r){e.splice(c--,1);var d=i();void 0!==d&&(t=d)}}return t}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[n,i,o]},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),s.j=296,(()=>{var e={296:0};s.O.j=t=>0===e[t];var t=(t,n)=>{var i,o,[a,r,l]=n,d=0;if(a.some((t=>0!==e[t]))){for(i in r)s.o(r,i)&&(s.m[i]=r[i]);if(l)var c=l(s)}for(t&&t(n);d<a.length;d++)o=a[d],s.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return s.O(c)},n=self.webpackChunkgapp_browser_react=self.webpackChunkgapp_browser_react||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var i=s.O(void 0,[739,277],(()=>s(34820)));i=s.O(i)})();