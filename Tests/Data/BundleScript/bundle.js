(()=>{var e,t={8429:(e,t,n)=>{"use strict";n.d(t,{Z:()=>he});var i=n(39005),s=n(9185),o=n(98611),a=n(36943),r=n(2431),l=n(54162),d=n(46382),c=n(63353),h=n(29087),p=n(81538),u=n(84990),g=n(56371),m=n(78347),v=n(21754),f=n(48868),y=n(26591),w=n(97823),b=n(68906),C=n(20570),S=n(93043);const T={call:async function(e,t){await f.Z.transaction("rw",[f.Z.searchList],(()=>{f.Z.searchList.where("id").anyOf(e).modify((e=>{e.sourceFilterIds=e.sourceFilterIds.filter((e=>!t.includes(e))),t.forEach((t=>{e.sources.delete(t)}))}))}))}};var I=n(5204),k=n(5863),A=n(51501);const Z={call:async function(e,t){const n=[],i={},a=[],r=await w.Z.loadAllAccounts(),l=[],d=[],c=new A.R;e.forEach((e=>{const{id:s,sentDate:h,messageId:p,sources:u}=e,g=t.get(s);g&&(u.size===g.length?d.push(s):c.add(g,s),g.forEach((e=>{const t=o.C.get(e);if(!t)return;const{accountId:d,path:c}=t;if(d===k.of)return;if(n.push({accountId:d,searchListId:s,sentDate:h}),d===k.u4)return void l.push({path:c,messageId:p});const u=r.find((e=>e.MAIL_EMAIL===d));u?u.accountType===k.s9.POP?i[d]?i[d].push(s):i[d]=[s]:u.accountType===k.s9.IMAP&&a.push({accountId:d,path:c,searchListId:s}):console.warn("Account "+d+" not found")})))}));const h=[f.Z.messages,f.Z.searchList,f.Z.threading,f.Z.filteringQueue,f.Z.viewIds];(a.length>0||Object.keys(i).length>0)&&(h.push(f.Z.buffer),a.length>0&&h.push(f.Z.imap),Object.keys(i).length>0&&h.push(f.Z.pop)),l.length>0&&h.push(f.Z.deletedFeedItems),await f.Z.transaction("rw",h,(async()=>{for(const{filterIds:e,searchListIds:t}of c.batches){const n=[...e];T.call(t,n);const i=new Map(n.map((e=>[e,void 0])));b.Z.call({type:"UPDATE_SLE",priority:k.Un.HIGH,searchListIds:t,sources:i})}l.length>0&&f.Z.deletedFeedItems.bulkAdd(l),d.length>0&&S.Z.call(d),a.length>0&&C.Z.addDelete(a);const e=Object.keys(i);if(e.length>0){const t=[];for(const n of e)t.push({accountId:n,searchListIds:i[n],operation:"BUFFER_OPERATION_DELETE_POP"});t.length>0&&f.Z.buffer.bulkAdd(t)}})),s.Z.updateIndex({removedSles:d}),v.Z.flushBuffer(),I.Z.filter();for(const e of n){const{accountId:t,searchListId:n,sentDate:i}=e;await y.Z.call(t,n,i).catch((()=>console.warn("Error deleting file. May not exist!",e)))}}};var E=n(71320),_=n(45709),N=n(61472),M=n(84283),P=n(45660),D=n(35458);const x=async function(e,t,n,i,o){const a=E.Z.getByFolderId([t,n]),r=E.Z.getByFolderId([i,o]);if(!a||!r)throw new Error(`Could not move messages.\n      No filter found for ${t}/${n}\n      or ${i}/${o}\n      when trying to move ${e.length} messages`);const l=new Map;e.forEach((e=>{const i=e.sources.get(a.id);if(!i)throw new Error(`Can't move message from ${t}/${n}\n        No source found for entry:\n        ${e.subject}\n        in filter: ${a.name}`);const s=new Map;s.set(a.id,void 0),s.set(r.id,{...i}),l.set(e.id,s)}));const d=e.map((e=>e.id));let c=[];await f.Z.transaction("rw",[f.Z.searchList,f.Z.buffer,f.Z.imap,f.Z.filteringQueue,f.Z.filters],(async()=>{await C.Z.addMove(d.map((e=>({accountId:t,path:n,destinationAccountId:i,destinationPath:o,searchListId:e})))),c=await D.Z.call(l);const e=E.Z.getByFolderIds([[k.Ry,`${t}/${n}`],[k.Ry,`${i}/${o}`]]).map((e=>e.id)),s=[[t,n],[i,o]];N.Z.getFolderType(t,n)===N.Z.getFolderType(i,o)?await b.Z.call({type:"FILTERS_SLES",priority:k.Un.HIGH,folderIds:s,filterIds:e,searchListIds:d}):await b.Z.call({type:"RE_RUN_SLES",priority:k.Un.HIGH,folderIds:s,filterIds:e,searchListIds:d})})),v.Z.flushBuffer(),I.Z.filter(),c.length>0&&s.Z.updateIndex({sleUpdates:c})};var O=n(6129),L=n(8684);const R={call:async function(e,t){const n=new Map,i=[],a=[],r=[],l=new Set,d=new Map;function c(e,t,i){const s=n.get(t),o={deleted:i,read:!0};s?s.set(e,o):n.set(t,new Map([[e,o]]))}function h(e,t,n){const{id:i,sources:s}=e;l.add(e),s.forEach(((e,s)=>{const o={...e,read:!0};t.has(s)&&(o.deleted=n);if(Object.keys(e).some((t=>e[t]!==o[t]))){const e=d.get(i);e?e.set(s,o):d.set(i,new Map([[s,o]]))}}))}function p(e,t,n){const i=t.find((t=>{const n=e.sources.get(t);return n&&!n.internal}));if(i){const{accountId:t,path:s}=o.C.get(i);a.push({key:[t,s,e.id],destinationPath:n})}}e.forEach((e=>{const{id:s}=e,a=t.get(s),l=new Map;a&&0!==a.length?(a.forEach((e=>{const t=o.C.get(e),{accountId:n}=t,i=l.get(n);i?i.push(e):l.set(n,[e])})),l.forEach(((t,a)=>{const l=(0,O.ZA)(a)&&m.Z.getFoldersOfType(a,k.uT);if(l&&l.length>0){const d=new Set;l.forEach((i=>{const{path:l}=i,u=o.C.getByFolder(a,l),{id:g}=u,m=e.sources.get(g);if(m)if(m.internal)p(e,t,l),m.deleted&&c(g,s,!1);else if(m.deleted){const t=new Set([g]);h(e,t,!1)}else r.push(e);else!function(e,t,i,s){const o=n.get(t),a={deleted:i,internal:s,read:!0};o?o.set(e,a):n.set(t,new Map([[e,a]]))}(g,s,!1,!0),p(e,t,l);d.add(g)}));const u=t.filter((e=>!d.has(e)));h(e,new Set(u),!0),u.forEach((t=>{if(!e.sources.get(t).internal){const e=o.C.get(t);i.push([a,e.path,s])}c(t,s,!0)}))}else h(e,new Set(t),!0)}))):console.warn("No deleteSourceFilterIds for id "+s)}));const u=new Set;if(n.size>0&&(u.add(f.Z.searchList),u.add(f.Z.filteringQueue),u.add(f.Z.filters)),(i.length>0||a.length>0)&&(u.add(f.Z.imap),u.add(f.Z.buffer)),l.size>0&&u.add(f.Z.flaggingQueue),u.size>0){const e=[];await f.Z.transaction("rw",[...u],(async()=>{if(l.size>0){const t=_.ZP.setCustomFlags([...l],{},d);e.push(...t)}if(n.size>0){const t=await D.Z.call(n);e.push(...t);const i=new A.R;n.forEach(((e,t)=>{const n=[...e.keys()];i.add(n,t)}));for(const{filterIds:e,searchListIds:t}of i.batches)b.Z.call({type:"RE_RUN_SLES",priority:k.Un.HIGH,searchListIds:t,filterIds:[...e],folderIds:[[k.of,k.cm]]})}if(a.length>0||i.length>0){const e=i.slice();if(a.forEach((t=>{const{key:n}=t;e.find((e=>e.every(((e,t)=>e===n[t]))))||e.push(n)})),a.length>0){const e=[];for(const t of a){const{key:n,destinationPath:i}=t,[s,o,a]=n;e.push({accountId:s,path:o,searchListId:a,destinationPath:i})}await C.Z.addCopy(e)}if(i.length>0){const e=[];for(const t of i){const[n,i,s]=t;e.push({accountId:n,path:i,searchListId:s})}await C.Z.addDelete(e)}}})),I.Z.filter(),v.Z.flushBuffer(),e.length>0&&s.Z.updateIndex({sleUpdates:e})}r.length>0&&(e.length===r.length?(0,L.c)({title:(0,g.Z)("Already in trash"),icon:"resources/mail_notification_icon.png"}):(0,L.c)({title:(0,g.Z)("Some were already in trash"),icon:"resources/mail_notification_icon.png"}))}};var B=n(307),F=n(42228);const U=async function(e){const t=await(0,F.Z)(e),n=[];return await f.Z.searchList.where("id").anyOf([...e.keys()]).modify((i=>{const{id:s,sourceFilterIds:o,sources:a}=i,r=e.get(s);r&&r.forEach(((e,s)=>{let r=!1;if(!t.has(s))throw new Error("Can not add a source for a non-existing filter ID "+s);o.includes(s)||(o.push(s),r=!0),a.has(s)||(a.set(s,{...e}),r=!0),r&&n.push(i)}))})),n};var V=n(9467),W=n(83507),H=n(70520);const z=async function(e){const t=[],n=[],i=[],a=[],r=new Map,l=[];for(const s of e){const{sources:e}=s;e.forEach(((e,r)=>{const{accountId:l,path:d}=o.C.get(r);N.Z.getFolderType(l,d)===k.uT?e.internal?t.push({sourceFilterId:r,listEntry:s}):n.push({sourceFilterId:r,listEntry:s}):e.internal?i.push({sourceFilterId:r,listEntry:s}):e.deleted&&a.push({sourceFilterId:r,listEntry:s})}))}const d=new Map;if(i.length>0){const e=await w.Z.loadAllAccounts(),t=[],n=[];for(const s of i){const{sourceFilterId:i,listEntry:o}=s,{id:a,sentDate:l,unseen:c,flags:h,sources:p}=o,u=E.Z.get(i),{accountId:g,path:m}=u,v=e.find((e=>e.MAIL_EMAIL===g));if(!v){console.warn("Account not found for accountId "+g);continue}if(v.accountType===k.s9.IMAP){let e=!1;for(const[t,s]of p){if(s.internal||t===i)continue;const o=E.Z.get(t);if(!o||o.accountId!==g)continue;const{path:r}=o;n.push({accountId:g,path:r,destinationPath:m,searchListId:a}),e=!0;break}if(!e){const e=await W.Z.call(g,a,l);e&&t.push({accountId:g,path:m,operation:"BUFFER_OPERATION_UPLOAD_MESSAGE",message:(0,H.Z)(e),searchListId:a})}}let f=d.get(a);f||(f={id:a,unseen:c,flags:h,sources:p},d.set(a,f));const y=p.get(i),w={read:void 0!==y&&y.read,internal:!0,deleted:!1};let b=r.get(a);b?b.set(i,w):(b=new Map([[i,w]]),r.set(a,b))}await C.Z.addCopy(n),await f.Z.buffer.bulkAdd(t)}if(a.length>0){const e=new Map;for(const t of a){const{sourceFilterId:n,listEntry:i}=t,{id:s,unseen:o,flags:a,sources:l}=i;let c=d.get(s);c||(c={id:s,unseen:o,flags:a,sources:l},d.set(s,c));const h=l.get(n),p={read:void 0!==h&&h.read,internal:!1,deleted:!1};let u=r.get(s);u?u.set(n,p):(u=new Map([[n,p]]),r.set(s,u));const g=e.get(n);g?g.push(s):e.set(n,[s])}for(const[t,n]of e){const e=o.C.get(t);if(!e)throw new Error("Filter not found, id "+t);const{accountId:i,path:s}=e;await V.Z.deleteImapEntries(i,s,n)}}if(d.size>0){const e=_.ZP.setCustomFlags([...d.values()],{[k.T4.SEEN]:!1},r,!1);l.push(...e)}const c=new Map;function h(e,t){const{id:n}=e;let i=c.get(n);if(!i){const{sourceFilterIds:t,sources:s}=e,o=new Map;for(const[e,t]of s)o.set(e,{...t});i={sourceFilterIds:t.slice(),sources:o},c.set(n,i)}const{sourceFilterIds:s,sources:o}=i;t.forEach(((e,t)=>{if(e)s.includes(t)||s.push(t);else{const e=s.indexOf(t);e>=0&&s.splice(e,1)}o.set(t,{...e})}))}const p=new Map;function u(e,t){const n=p.get(e);n?n.push(t):p.set(e,[t])}if(n.length>0){const e=[],t=[],i=new Map,s=new A.R;for(const s of n){const{sourceFilterId:n,listEntry:o}=s,{id:a,sourceFilterIds:r,sources:l}=o,d=E.Z.getByIds(r),c=d.find((e=>e.id===n)),p=d.filter((e=>e.accountId===c.accountId)),{accountId:g,path:v}=c;if(1===p.length){const t=m.Z.getFoldersOfType(g,k.e9)[0];if(!t)throw new Error("Can not undelete, an inbox folder was not found for "+g);const{path:s}=t;e.push({accountId:g,path:v,destinationPath:s,searchListId:a});const r=E.Z.getByFolderId([g,s]),d=l.get(n),c=void 0!==d&&d.read,p=new Map([[r.id,{read:c,deleted:!1,internal:!0}]]),u=new Map([[a,p]]),[f]=await U(u);if(f){h(o,p);const e=i.get(a);e?e.push(r.id):i.set(a,[r.id])}}else t.push({accountId:g,path:v,searchListId:a});u(a,n);h(o,new Map([[n,void 0]]))}C.Z.addMove(e),C.Z.addDelete(t),v.Z.flushBuffer(),i.forEach(((e,t)=>s.add(e,t)));for(const{filterIds:e,searchListIds:t}of s.batches)b.Z.call({type:"FILTERS_SLES",priority:k.Un.NORMAL,filterIds:[...e],searchListIds:t})}if(t.length>0){const e=new Map;for(const n of t){const{listEntry:t,sourceFilterId:i}=n,{id:s}=t;u(s,i);h(t,new Map([[i,void 0]]));const o=e.get(i);o?o.push(s):e.set(i,[s])}for(const[t,n]of e){const e=o.C.get(t);if(!e)throw new Error("Filter not found, id "+t);const{accountId:i,path:s}=e;await V.Z.uploadEntries(i,s,new Set(n)),await V.Z.copyAndMoveEntries(i,s,n)}}if(c.size>0&&c.forEach(((e,t)=>{const{sourceFilterIds:n,sources:i}=e;l.push({id:t,updates:{sourceFilterIds:n,sources:i}})})),p.size>0){const e=[];p.forEach(((t,n)=>{const i=e.find((e=>e.filterIds.size===t.length&&t.every((t=>e.filterIds.has(t)))));i?i.searchListIds.push(n):e.push({filterIds:new Set(t),searchListIds:[n]})}));for(const{searchListIds:t,filterIds:n}of e){const e=[...n];await T.call(t,e);const i=new Map(e.map((e=>[e,void 0])));b.Z.call({type:"UPDATE_SLE",priority:k.Un.HIGH,searchListIds:t,sources:i})}}l.length>0&&s.Z.updateIndex({sleUpdates:l}),I.Z.filter()};var G=n(1407),$=n(95412),K=n(59042),j=n(89175),Y=n(59275),X=n(26036),Q=n(19842),q=n(86088);const J={Red:"#f01",Orange:"#f80",Yellow:"#fd0",Green:"#3c0",Blue:"#08f",Purple:"#a09",Grey:"#666"},ee=new Image;ee.src=`data:image/svg+xml;base64,${btoa(q.nyn.medium)}`;const te=[k.hn,k.e9,k.Hd,k.Oi,k.Nz,k.uT];function ne(e){const t=document.createElement("canvas");t.width=32,t.height=32;const n=t.getContext("2d");return n.drawImage(ee,0,0),n.globalCompositeOperation="source-in",n.fillStyle=J[e],n.fillRect(0,0,32,32),t.toDataURL("image/png").replace("data:image/png;base64,","")}function ie(e,t){e.push(t),t.children&&t.children.forEach((t=>ie(e,t)))}function se(e,t){const n=(0,Q.Rr)(e);let s=[];if(!n){const e=p.Z.get(G.uP);if(!e)return s;e.selectedIds.forEach((e=>{const n=o.C.getListEntry(e.id);n&&(t?ie(s,n):s.push(n))}))}if(!s.length||n){const e=i.Z.getActiveListEntry();if(e){const t=o.C.getListEntry(e.id);t&&(s=[t])}}return s}function oe(e,t,n){const o=e.filter((e=>e&&(void 0===n||n(e)))),a=t(o);s.Z.updateIndex({sleUpdates:a});const r=i.Z.getActiveListEntry();if(r){const e=o.find((e=>e.id===r.id));e&&(r.flags=e.flags)}}function ae(e,t,n){oe(se(e),t,n)}function re(e){return Boolean(c.Z.getActivePage(e)?.isMailPage)}function le(e){return h.Z.get(e?j.kMailDeleteInOtherLocations:j.kMailMarkDeleteInOtherLocations)}async function de(e){let t=i.Z.getActiveMessage();if(!t)return;let n=i.Z.getRenderingMethod();"raw"===n&&(n=h.Z.get(j.kMailPreferredRendering));const s=i.Z.getRaw();if(s&&!t.bodyParts){let i=await s.parseMainPart(n);e&&(i=i.concat(await s.parseAttachments())),t={...t,bodyParts:i}}return t}const ce=new class{enableThreadedView(e){if(!re(e))return;const t=se(e);t&&t.length>0&&t[0]&&s.Z.selectThread(t[0])}enableCorrespondentView(e,t){if(re(e))if(t)s.Z.selectContact(e,t);else{const t=i.Z.getActiveMessage(),n=l.Z.getSelectedFolder();if(t&&n){const i=N.Z.getFolderType(n.accountId,n.path),{from:o,to:a,cc:r,bcc:l=[]}=t,d=i===k.Nz?a[0]||r[0]||l[0]:o[0];d&&d.address&&s.Z.selectContact(e,d.address)}}}setActiveMailDetail(e){u.Z.dispatch({actionType:"MAIL_SET_ACTIVE_COMPONENT",mailDetail:e})}setActiveMessage(e){u.Z.dispatch({actionType:"MAIL_SET_ACTIVE_MESSAGE",message:e})}markAsReadAndGoToNextUnread(e){re(e)&&(ce.markRead(e),u.Z.dispatch({actionType:"MAIL_GOTO_UNREAD"}))}goToNextUnread(e){re(e)&&u.Z.dispatch({actionType:"MAIL_GOTO_NEXT_UNREAD"})}goToPreviousUnread(e){re(e)&&u.Z.dispatch({actionType:"MAIL_GOTO_PREVIOUS_UNREAD"})}openMessage=e=>{const t=i.Z.getActiveListEntry(),n=i.Z.getActiveMessage();if(!t||!n)return;const s=o.C.getByIds(t.sourceFilterIds),a=N.Z.getFolderTypes(s),l=a.has(k.kY),d=a.has(k.fZ),c=a.has(k.Nz);return l||d?r.Z.open(n,t.threadKey):c?ce.createDraftFromSent():void(0,B.Z)(e,n)};clearIfActive(e){setTimeout((()=>{u.Z.dispatch({actionType:"MAIL_CLEAR_IF_ACTIVE",mailDetail:e})}),100)}refreshActiveMessage(){u.Z.dispatch({actionType:"MAIL_REFRESH_ACTIVE_MESSAGE"})}async createDraftFromSent(){const e=await de(!0);e&&r.Z.createDraftFromSent(e)}async reply(){const e=await de(!1);e&&await r.Z.reply(e)}async replyAll(){const e=await de(!1);e&&await r.Z.replyToAll(e)}async forward(){const e=await de(!0);e&&await r.Z.forward(e)}markRead(e){re(e)&&ae(e,(e=>_.ZP.setRead(e,!0)))}markUnread(e){re(e)&&ae(e,(e=>_.ZP.setRead(e,!1)))}markThreadRead(e){if(!re(e))return;oe(se(e,!0),(e=>_.ZP.setRead(e,!0)))}markThreadUnread(e){if(!re(e))return;oe(se(e,!0),(e=>_.ZP.setRead(e,!1)))}markFlagged(e){ae(e,(e=>_.ZP.setFlagged(e,!0)),(e=>!(0,$.u9)(e)))}markUnflagged(e){ae(e,(e=>_.ZP.setFlagged(e,!1)),(e=>(0,$.u9)(e)))}setCustomFlags(e,t){ae(e,(e=>_.ZP.setCustomFlags(e,t)))}async prepareDelete(e,t,n,i){const s=n||se(e);let a;if(a=t?s.some((e=>e.sources.size>1)):s.some((e=>[...e.sources.entries()].filter((([e,t])=>!M.Z.isSourceDeleted(e,t))).length>1)),a||i){const a=l.Z.getSelectedFolder();if(!a)return void console.warn("No folder selected");const{accountId:r,path:c=k.ym,type:h}=a,p=h===k.Nz,u=function(e){let t=0;for(const n of e)for(const[e,i]of[...n.sources.entries()]){const{accountId:n,path:s}=o.C.get(e);N.Z.getFolderType(n,s)===k.Nz||i.deleted||++t}return t}(s);if(p||u<=1&&!i);else{const i=o.C.getByFolderId([r,c]),a=s.some((e=>e.sources.has(i.id))),l=le(t);if(a){if("ask"===l)return void d.Z.showMailDeleteDialogSetting(e,{entries:s,deletePermanently:t})}else{if(n)return void d.Z.showMailDeleteDialogConfirmAll(e,{entries:s,deletePermanently:t});if(s.length>1){if(["selected","folders","ask"].includes(l))return void d.Z.showMailDeleteDialogConfirmAll(e,{entries:s,deletePermanently:t})}else{if("selected"===l)return void d.Z.showMailDeleteDialogFolders(e,{entries:s,deletePermanently:t});if(["folders","ask"].includes(l)){const n=new Set;if(s[0].sources.forEach(((e,t)=>{if(!M.Z.isSourceDeleted(t,e)){const e=E.Z.get(t);if(!e)throw new Error("Filter not found "+t);n.add(e.accountId)}})),n.size>1)return void d.Z.showMailDeleteDialogAccounts(e,{entries:s,deletePermanently:t})}}}}}await this.delete(e,s,t)}async delete(e,t,n,i={}){const{setting:s,accountIds:a,sourceFilterIds:d}=i,c=s||le(n),h=new Map,p=l.Z.getSelectedFolder();if(!p)return void console.warn("No folder selected");const{accountId:u,path:g=k.ym}=p,m=o.C.getByFolderId([u,g]),v=m&&t.some((e=>e.sources.has(m.id))),f=l.Z.isSentFolderSelected();if(t.forEach((e=>{const t=[];e.sources.forEach(((e,i)=>{if(!n&&M.Z.isSourceDeleted(i,e))return void P.Z.log("Mail",["delete"],`No need to re-delete - sourceFilterId: ${i}`);if(!function(e,t,n){const{accountId:i,path:s}=o.C.get(t),a=N.Z.getFolderType(i,s);return e.deleted||a===k.Nz===n}(e,i,f))return void P.Z.log("Mail",["delete"],`Will not delete from sent unless Sent folder is selected - isSentSelected: ${f.toString()} - sourceFilterId: ${i}`);const s=o.C.get(i);if(s)return a||d?a&&!a.get(s.accountId)?void P.Z.log("Mail",["delete"],`Accounts selected to delete from do not match filter - sourceFilterId: ${s.id}`):d&&!d.get(i)?void P.Z.log("Mail",["delete"],`Folders selected to delete from do not match filter - sourceFilterId: ${i}`):void t.push(i):void("selected"===c&&v?m?.id===i?t.push(i):P.Z.log("Mail",["delete"],`filter not found - selectedFilter: ${m?m.id:"undefined"} - sourceFilterId: ${i}`):"folders"===c&&v?s.accountId===u?t.push(i):P.Z.log("Mail",["delete"],`filter not found -  source accountId: ${s.accountId} - selected accountId: ${u} - sourceFilterId: ${i}`):t.push(i));P.Z.log("Mail",["delete"],`sourceFilter not found! sourceFilterId: ${i}`)})),t.length>0&&h.set(e.id,t)})),0===h.size)return void P.Z.log("Mail",["delete"],"Nothing to delete");const y=t.filter((e=>h.has(e.id)));y.forEach((t=>{r.Z.closeComposer(e,t.id)})),n?Z.call(y,h):R.call(y,h)}undelete(e){const t=se(e);z(t)}getMoveToFolderMenu=e=>{const t=se(e),n=t.map((e=>{const t=[];return e.sources.forEach(((e,n)=>{e.internal||e.deleted||t.push(n)})),t}));if(0===n.length)return[];const i=n.reduce(((e,t)=>e.filter((e=>t.includes(e))))),s=[];if(o.C.getByIds(i).forEach((e=>{const{accountId:t,path:n}=e,i=N.Z.getFolderType(t,n);m.Z.isMailAccount(t)&&te.includes(i)&&s.push([t,n])})),0===s.length){return[{...1===t.length?(0,X.Z)("Can not move from this folder."):(0,X.Z)("No common folder. Can not move this selection."),enabled:!1,mnemonic:!1}]}const a=m.Z.getAccounts(),r=[];return s.forEach((([e,n])=>{const i=m.Z.getFolderName(e,n);let o=[];for(const t of te)o.push(...N.Z.getPathsByType(e,t));if(o=o.filter((e=>e!==n)),o.length>0){const l=o.map((i=>{const s=m.Z.getFolderName(e,i);return{handler:()=>x(t,e,n,e,i),label:(0,Y.e)(s),labelEnglish:s}})),d=[];for(const i in a)if(!s.find((e=>e[0]===i))){const s=a[i].folders;for(const o in s)for(const a of s[o]){const s=a.path;if(te.includes(o)){const o=m.Z.getFolderName(i,s);d.push({handler:()=>x(t,e,n,i,s),label:`${i}/${(0,Y.e)(o)}`,labelEnglish:`${i}/${o}`})}}}const c=l.concat(d);r.push({items:c,label:(0,g.Z)("Move from $1 to ...",[e+"/"+(0,Y.e)(i)]),labelEnglish:`Move from ${e}/${i} to ...`})}})),r};getCustomLabelsMenu=(e,t)=>{const n=o.C.getByAccountId(k.ut).sort($.jp),i=[];let s=!1;return n.forEach((n=>{!s&&n.path.startsWith("$labelviv")&&i.length>0&&(i.push({type:"separator",label:"",labelEnglish:""}),s=!0),i.push({type:"checkbox",checked:t.indexOf(n.path)>-1,handler:this.toggleLabel(e,n.path,t),...(0,X.Z)((0,K.X)(n.name))})})),i};clearAllLabels=(e,t)=>{const n=t.reduce(((e,t)=>({...e,[t]:!1})),{});this.setCustomFlags(e,n)};toggleLabel=(e,t,n)=>()=>{const i=-1===n.indexOf(t);this.setCustomFlags(e,{[t]:i})};getStandardFlagsMenu=(e,t)=>{const n=[];for(const i of _.ZP.getStandardFlagList()){let s=ne(i);i===k.T4.CLEAR_FLAGS&&(n.push({type:"separator",label:"",labelEnglish:""}),s=void 0),n.push({type:"checkbox",checked:i===t,handler:()=>this.toggleStandardFlag(e,i,t),label:_.ZP.translateFlag(i),labelEnglish:i,iconPNG:s,iconPNGWhite:s})}return n};toggleStandardFlag=(e,t,n)=>{const i=n===t?(0,$.KR)(k.T4.CLEAR_FLAGS):(0,$.KR)(t);this.setCustomFlags(e,i)};markAsJunk(e){const t=se(e);a.Z.markAsJunk(t)}markAsNotJunk(e){const t=se(e);a.Z.markAsNotJunk(t)}moveToArchive(e){const t=se(e);a.Z.moveToArchive(t)}restoreFromArchive(e){const t=se(e);a.Z.restoreFromArchive(t)}};const he=ce},21754:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(1407);const s={};let o=0;const a={updateThreads:function(){return r("updateThreads",[...arguments])},rerunThreading:function(e,t){return r("rerunThreading",[...arguments])},filter:function(){return r("filter",[...arguments])},start:function(){return r("start",[...arguments])},stop:function(){return r("stop",[...arguments])},addAccount:function(e,t){return r("addAccount",[...arguments])},flushBuffer:function(){return r("flushBuffer",[...arguments])},updateFlags:function(){return r("updateFlags",[...arguments])},startBackgroundActions:()=>{navigator.serviceWorker?.addEventListener("message",l,!1)},stopBackgroundActions:()=>{navigator.serviceWorker?.removeEventListener("message",l,!1)}};function r(e,t){return new Promise(((n,i)=>{const a=o++;s[a]={resolve:n,reject:i};const r={promiseId:a,func:e,args:t};navigator.serviceWorker?.ready.then((e=>e.active?.postMessage({background:r})))}))}function l(e){if(e.origin!==i.oP)return;const{background:t}=e.data;if(t){const{promiseId:e,results:n,error:i}=t,{resolve:o,reject:a}=s[e];delete s[e],i?a(i):o(n)}}},48603:(e,t,n)=>{"use strict";n.d(t,{Z:()=>j});var i=n(27770),s=n(68247),o=n(29087),a=n(15672),r=n(92292),l=n(7064),d=n(89175);const c="[bookmark update]",h=function(){return new Promise((e=>{l.Z.bookmarksPrivate.updatePartners(((t,n,i)=>{r.Z.runtime.lastError&&(console.warn(c,"failed to call vivaldi.bookmarksPrivate.updatePartners:",r.Z.runtime.lastError.message),t=!1,n=!1),e([t,n,i])}))}))},p=function(e){const t=function(e,n){for(let i=0;i<e.length;i++){const s=e[i];s.url&&(s.partner?console.warn(c,"partner id in bookmark tree without version:",s.partner,s.url):n.set(s.url,s.id)),s.children&&t(s.children,n)}};return Promise.all([new Promise((e=>{r.Z.bookmarks.getTree((t=>{r.Z.runtime.lastError&&console.warn(c,"failed to call chrome.bookmarks.getTree:",r.Z.runtime.lastError.message),e(t)}))})).then((e=>{const n=new Map;return e&&t(e,n),n})),fetch("./default-bookmarks/fallback-partner-ids.json",{method:"GET"}).then((e=>e.json())).then((t=>{let n=t[e];return n||(n=t[a.Z.getFallbackLocale()]),n}))]).then((([e,t])=>{const n={numMatch:0,size:0};return t?Promise.all(function*(e,t,n){const i=Object.keys(t);e:for(const s of i){const i=t[s];n.size+=1;for(const t of i){const i=e.get(t);if(i){console.warn(c,"Match",s,t),n.numMatch+=1,yield new Promise((e=>{r.Z.bookmarks.update(i,{partner:s},(()=>{r.Z.runtime.lastError&&console.warn(c,"failed to update partner:",s,r.Z.runtime.lastError.message),e()}))}));continue e}}console.warn(c,"No match for",s,i.join(" "))}}(e,t,n)).then((()=>n)):n})).then((e=>{console.warn(c,"Urls matched",e.numMatch,"of",e.size)}))},u={init:()=>h().then((([e,t,n])=>t?p(n).then((()=>(s.Z.set(d.kBookmarksVersion,"0"),h().then((([e])=>e))))):e)).catch((e=>(console.warn(c,"error while updating bookmarks:",e),!1))).then((e=>(e||console.warn(c,"failed to update bookmarks, current version:",o.Z.get(d.kBookmarksVersion)),e)))};var g=n(59486),m=n(63353),v=n(84990),f=n(56371),y=n(24899),w=n(28773),b=n(30381),C=n.n(b),S=n(35369),T=n(30460),I=n(44850);const k="BookmarkCutIds";let A=!0,Z=!0;var E=new Map;function _(){A=!0}function N(){A=!1,D()}function M(){v.Z.dispatch({actionType:"BOOKMARKS_SET_BATCH_MODE",edit:!0})}function P(){v.Z.dispatch({actionType:"BOOKMARKS_SET_BATCH_MODE",edit:!1})}function D(e=!1){const t=r.Z.bookmarks.getTree(),n=fetch("./default-bookmarks/partners.json").then((e=>e.json())).catch((()=>(console.warn("Failed to load partner bookmarks"),{bookmarks:[],folders:[]})));return Promise.all([t,n]).then((([t,n])=>{v.Z.dispatch({actionType:"BOOKMARKS_INIT",bookmarks:t,failedUpgrade:e,partnerDB:n})}))}function x(e,t){A||v.Z.dispatch({actionType:"BOOKMARKS_ADD_ITEM",id:e,changes:t})}function O(e,t){A||v.Z.dispatch({actionType:"BOOKMARKS_CHANGE_ITEM",id:e,changes:t})}function L(e,t){A||v.Z.dispatch({actionType:"BOOKMARKS_MOVE_ITEM",id:e,changes:t})}function R(e){v.Z.dispatch({actionType:"BOOKMARKS_REMOVE_ITEM",id:e})}function B(e,t){A||D()}function F(e,t){if(A)return;g.ZP.getItemById(e)&&v.Z.dispatch({actionType:"BOOKMARKS_CHANGE_ITEM",id:e,changes:{faviconUrl:t}})}function U(e,t){A||v.Z.dispatch({actionType:"BOOKMARKS_CHANGE_ITEM",id:e,changes:t})}function V(){!1===Z&&(Z=!0,l.Z.bookmarksPrivate.onFaviconChanged.removeListener(F))}function W(){!0===Z&&(Z=!1,l.Z.bookmarksPrivate.onFaviconChanged.addListener(F))}function H(e){"Escape"===e.key&&K.setCutIds([])}function z(e,t){if(e===k){const e=t.length>0?t.split(","):[];e.length>0?window.addEventListener("keydown",H,!0):window.removeEventListener("keydown",H,!0),v.Z.dispatch({actionType:"BOOKMARKS_SET_CUT_IDS",ids:e})}}async function G(e){const t=m.Z.getTabsForPages(e.pages,!1).map((e=>({page:"group"===e.type?void 0:e.page,url:"group"===e.type?void 0:e.page.url,title:"group"===e.type?m.Z.getTitleByGroupId(e.id,(0,f.Z)("Stack")):(0,I.D1)(e.page),children:"group"===e.type?e.pages.map((e=>({page:e,url:e.url,title:(0,I.D1)(e)}))).toArray():void 0}))).filter((e=>e.children||e.url));if(!t.size)return;const{parentId:n,index:i}=e;if(1!==t.size||e.forceFolder){if(e.isStack){return await Promise.all(t.map((async({children:e,title:t})=>{if(!e?.length)return;const i=await r.Z.bookmarks.create({parentId:n,title:t});return await K.createBookmarks(e,i.id,0),i.id}))).then((e=>e.filter(Boolean)[0]))}{const s={parentId:n,..."number"==typeof i?{index:i}:null},o=await r.Z.bookmarks.create(s),a=C()(o.dateAdded).format("YYYY-MM-DD, HH:mm:ss"),l=e.isSelection?(0,f.Z)("Saved Tab Selection ($1)",[a]):(0,f.Z)("Saved Tabs ($1)",[a]);return await r.Z.bookmarks.update(o.id,{title:l}),await Promise.all(t.map((async e=>{const{children:t,title:n,url:i}=e;if(t?.length){const e=await r.Z.bookmarks.create({parentId:o.id,title:n});await K.createBookmarks(t,e.id,0)}else await r.Z.bookmarks.create({parentId:o.id,title:n,url:i})}))),o.id}}{const{children:e,title:s,page:o}=t.first();if(e?.length){const t={parentId:n,title:s,..."number"==typeof i?{index:i}:null},o=await r.Z.bookmarks.create(t);return await K.createBookmarks(e,o.id,0),o.id}return o&&!e?K.bookmarkPageInFolder(o,n,i):void 0}}function $({clipboardData:e},t,n){e&&(t=g.ZP.validateForClipboard(t),e.setData("vivaldi/x-cut",n),e.setData(i.yR,JSON.stringify(t)),e.setData("text/plain",g.ZP.getDragData("text/plain",t)))}const K=new class{loadPromise(){return u.init().then((e=>D(!e))).then((()=>{A=!1,Z=!1,r.Z.bookmarks.onImportBegan.addListener(_),r.Z.bookmarks.onImportEnded.addListener(N),r.Z.bookmarks.onChanged.addListener(O),r.Z.bookmarks.onCreated.addListener(x),r.Z.bookmarks.onRemoved.addListener(R),r.Z.bookmarks.onMoved.addListener(L),r.Z.bookmarks.onChildrenReordered.addListener(B),l.Z.bookmarkContextMenu.onOpen.addListener(V),l.Z.bookmarkContextMenu.onClose.addListener(W),l.Z.menubarMenu.onOpen.addListener(V),l.Z.menubarMenu.onClose.addListener(W),l.Z.bookmarksPrivate.onFaviconChanged.addListener(F),l.Z.bookmarksPrivate.onMetaInfoChanged.addListener(U),l.Z.utilities.onSharedDataUpdated.addListener(z),l.Z.utilities.getSharedData({key:k,value:""},(e=>{e&&z(k,e)}))}))}setBookmarkBarFolderAndToggleVisibility(e){const t=g.ZP.getBookmarkBarFolderId()!==e||!o.Z.get(d.kBookmarksBarVisible);return K.setBookmarkBarFolder(e).then((e=>{e&&s.Z.set(d.kBookmarksBarVisible,t)}))}setBookmarkBarFolderAndShow(e){return K.setBookmarkBarFolder(e).then((e=>{e&&s.Z.set(d.kBookmarksBarVisible,!0)}))}async setBookmarkBarFolder(e){const t=g.ZP.getItemById(e);if(!t||!g.ZP.isFolder(t))return!1;const n=g.ZP.getRootId();if(e===n)return!1;const i=g.ZP.getBookmarkBarFolderId();if(i===e)return!0;M();try{i!==n&&await r.Z.bookmarks.update(i,{bookmarkbar:!1}),await r.Z.bookmarks.update(e,{bookmarkbar:!0})}catch(e){console.warn(`BookmarkActions: Failed to set bookmark bar folder: ${e}`)}finally{P()}return!0}toggleSpeeddialFolder(e){const t=g.ZP.getItemById(e);t&&g.ZP.isFolder(t)&&r.Z.bookmarks.update(t.id,{speeddial:!t.speeddial})}setCutIds(e){l.Z.utilities.setSharedData({key:k,value:e.length>0?e.join():""})}async move(e,t,n){const i=g.ZP.validateForDrag(e).map((e=>g.ZP.getItemById(e)?.id)).filter(Boolean);M();const s=await function(e,{parentId:t,index:n}){return e.reduce((async(e,i)=>{const s=await e,o=s[s.length-1]?.index,a=await r.Z.bookmarks.move(i,{parentId:t,index:void 0!==o?o+1:n});return s.push(a),Promise.resolve(s)}),Promise.resolve([]))}(i,{parentId:t,index:n});return P(),s.map((e=>e.id))}reorder(e,t){return e=g.ZP.validateForDrag(e),M(),Promise.all(e.reverse().map((e=>r.Z.bookmarks.move(e,{parentId:t,index:0}).then((e=>e.id))))).then((e=>(P(),e)))}async duplicate(e,t,n){const i=(0,y.Z)(e.map((e=>g.ZP.getItemById(e))).filter((e=>e&&!e.trash)));M();const s=await Promise.all(i.map((async e=>{const{title:i,url:s,description:o,nickname:a,children:l}=e,d=await r.Z.bookmarks.create({index:n++,parentId:t,title:i,...(0,w.Z)(s?{url:s}:null),...(0,w.Z)(o?{description:o}:null),...(0,w.Z)(a?{nickname:a}:null)});if(!d)throw new Error("Bookmark was not created");if(l?.length){const e=l.map((({id:e})=>e));await this.duplicate(e,d.id,0)}return d.id})));return P(),s}async createWithPromise(e,t,n){M();const i=await((e,t,n)=>Promise.all(e.map((async e=>{if(e.separator)return this.createSeparator(t,void 0===n?void 0:n++);const i=await r.Z.bookmarks.create({title:e.title,url:e.url||(e.children?null:T.p),parentId:t,description:e.description||null,nickname:e.nickname||null,index:void 0===n?void 0:n++});return e.children?.length?await K.createWithPromise(e.children,i.id,0):i}))))(e,t,n);return P(),i}createSeparator(e,t){return r.Z.bookmarks.create({title:"---",url:T.p,parentId:e,description:"separator",nickname:"",index:t})}async createBookmarks(e,t,n){M();const i=await Promise.all(e.map((({url:e,title:i})=>r.Z.bookmarks.create({parentId:t,url:e,title:i,index:n++}).then((({id:e})=>e)))));return P(),i}remove(e=[]){return M(),Promise.all(e.map((e=>{if(E.get(e))return E.get(e);const t=g.ZP.getItemById(e);return t&&g.ZP.isFolder(t)&&t.id===o.Z.get(d.kBookmarksSaveFolder)&&s.Z.set(d.kBookmarksSaveFolder,g.SZ),t&&g.ZP.isFolder(t)?r.Z.bookmarks.removeTree(e).catch((()=>console.warn(`Error removing bookmark tree: ${e}`))).then((()=>E.delete(e))):r.Z.bookmarks.remove(e).catch((()=>console.warn(`Error removing bookmark: ${e}`))).then((()=>E.delete(e)))}))).then((()=>P()))}async emptyTrash(){!1===await new Promise((e=>l.Z.bookmarksPrivate.emptyTrash(e)))&&console.warn("Empty trash failed.")}bookmarkAllOpenPages(e,t,n){return G({pages:m.Z.getPages(e),windowId:e,parentId:t,index:n,isStack:!1,isSelection:!1,forceFolder:!0})}bookmarkPages(e,t,n,i,s){return G({pages:e instanceof S.aV?e:S.aV.of(e),windowId:t,parentId:i,index:s,isStack:n,isSelection:!0,forceFolder:e instanceof S.aV})}async bookmarkPageInFolder(e,t=g.ZP.getRootNode().id,n){const{url:i}=e,s=(0,I.D1)(e),{id:o}=await r.Z.bookmarks.create({parentId:t,url:i,title:s,..."number"==typeof n?{index:n}:null});return o}cut(e,t){$(e,t,"true"),K.setCutIds(t),e.stopPropagation(),e.preventDefault()}copy(e,t){$(e,t,"false"),e.stopPropagation(),e.preventDefault()}paste({clipboardData:e},t,n){const s=g.ZP.getItemById(t);if(!s||!e)return Promise.resolve({isCut:!1,ids:[]});let o,a;if(g.ZP.isFolder(s))o=s.id,!0===n&&s.children?(a=s.children.length,a>0&&s.children[a-1].trash&&a--):a=0;else if(o=s.parentId,a=(s.index||0)+1,void 0===o)return console.log("error","Can not paste, target has no parent"),Promise.resolve({isCut:!1,ids:[]});const r=-1!==e.types.findIndex((e=>e===i.yR))?JSON.parse(e.getData(i.yR)):[];if(0===r.length)return Promise.resolve({isCut:!1,ids:[]});return g.ZP.getCutIds().length>0&&"true"===e.getData("vivaldi/x-cut")?K.move(r,o,a).then((e=>(K.setCutIds([]),{isCut:!0,ids:e}))):K.duplicate(r,o,a).then((e=>({isCut:!1,ids:e})))}async onDropEvent(e,t,n,s){if(e.dataTransfer.types.includes(i.yR)){const o=JSON.parse(e.nativeEvent.dataTransfer.getData(i.yR));i.ZP.isCopyModifierPressed(e)||s&&s.disableMove?await K.duplicate(o,t,n):await K.move(o,t,n)}else{const s=await i.ZP.getUrlsFromEventPromise(e,!0);await K.createBookmarks(s,t,n)}}},j=K},91380:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(52345),s=n(84990);const o=new class{add(e,t,n){s.Z.dispatch({actionType:"BOOKMARK_THUMBNAIL_QUEUE_ADD_ITEM",pageId:e,id:t,url:n})}update(e,t,n){const o=i.Z.getQueue(e);o&&0!==o.get("id")&&o.get("url")===t&&s.Z.dispatch({actionType:"BOOKMARK_THUMBNAIL_QUEUE_UPDATE_ITEM",pageId:e,id:o.get("id"),url:n})}remove(e){s.Z.dispatch({actionType:"BOOKMARK_THUMBNAIL_QUEUE_REMOVE_ITEM",pageId:e})}}},15590:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var i=n(27508),s=n(53576),o=n(84990),a=n(92292),r=n(7064);const l="BreakModeId";function d(e,t){e===l&&"boolean"==typeof t&&o.Z.dispatch({actionType:"BREAKMODE",isActive:t})}const c={toggleBreakMode:async function(e){const t=!i.Z.getState().isActive;await async function(e,t){const n=t?"mute":"unmute";t&&o.Z.dispatch({actionType:"TOOLTIP_SET",id:null});await s.Z.setMuting(e,"all",n),await r.Z.utilities.setSharedData({key:l,value:t});const i=await a.Z.tabs.query({});await Promise.all(i.map((async e=>{await new Promise((n=>{if(!(e.id&&e.id>=0))return n();a.Z.tabs.sendMessage(e.id,{breakmode:t},n)}))})))}(e,t)},loadPromise:async function(){r.Z.utilities.onSharedDataUpdated.addListener(d),await new Promise((e=>{r.Z.utilities.getSharedData({key:l,value:!1},e)}))&&d(l,!0)}}},61757:(e,t,n)=>{"use strict";n.d(t,{Z:()=>X});var i=n(34929),s=n(55351),o=n(29194),a=n(15800),r=n(34930),l=n(46382),d=n(5646),c=n(96682),h=n(63353),p=n(68247),u=n(29087),g=n(60331),m=n(84990),v=n(15489),f=n(56371),y=n(92292),w=n(45660);const b=function(e){const t=o.Z.getCalendars().find((t=>t.id===e)),{name:n=(0,f.Z)("Events")}=t||{};y.Z.fileSystem.chooseEntry({type:"saveFile",suggestedName:`${n}.ics`,accepts:[{extensions:["ics"]}],acceptsAllTypes:!0},(t=>function(e,t){if(!e)return;const n=o.Z.getEventsPerCalendar(t);n.forEach((e=>{e.recurrenceExceptions?.length&&e.recurrenceExceptions.forEach((t=>{const i=n.find((e=>e.id===t.exception_event_id));i&&(i.recurrenceId=t.date,i.sequence=e.sequence)}))}));const i=a.Z.eventsToICalendar(n);e.createWriter((e=>{const t=new Blob([i]);e.onwriteend=n=>{0===e.length&&e.write(t)},e.truncate(0),e.onerror=e=>{w.Z.error("Calendar",["export"],"Exporting events failed.",e)}}))}(t,e)))};var C=n(28773),S=n(80008),T=n.n(S),I=n(7064),k=n(24522),A=n(89175),Z=n(82191),E=n(90870),_=n(13289),N=n(42151),M=n(47543),P=n(58821),D=n(23750),x=n(8684),O=n(44850),L=n(34155);const{getLocalGoogleTasksCalendars:R,getPollResultText:B,validateEventTypes:F}=a.Z,U=new Set(T().tz.names()),V=["day","week","multiweek","month","year","agenda"],W=["day","week","agenda"];const H=()=>({title:(0,f.Z)("Change External Event"),body:(0,f.Z)("You’re changing an external event. Changes you make will only show locally and may be overwritten by changes from event organiser."),actions:[{title:(0,f.Z)("Apply Change"),action:"confirm"}],cancelAction:{title:(0,f.Z)("Cancel"),action:"cancel",default:!0}}),z=e=>{let t="",n="";switch(e){case"save":t=(0,f.Z)("Change Recurring Event"),n=(0,f.Z)("You’re changing a repeating event. Do you want to change this occurrence only, this and upcoming events or change all events from start?");break;case"trash":t=(0,f.Z)("Delete Recurring Event"),n=(0,f.Z)("You’re deleting a repeating event. Do you want to delete this occurrence only, this and upcoming events or delete all events from start?");break;case"move":t=(0,f.Z)("Reschedule Recurring Event"),n=(0,f.Z)("You’re rescheduling a repeating event. Do you want to change this occurrence only, this and upcoming events or reschedule all events from start by same amount?");break;case"copy":t=(0,f.Z)("Copy Recurring Event"),n=(0,f.Z)("You’re copying a repeating event. Do you want to copy this occurrence only, this and upcoming events or copy all events from start?")}return{title:t,body:n,actions:[{title:(0,f.Z)("Only this Event"),action:"single",default:!0},{title:(0,f.Z)("This and Upcoming"),action:"upcoming"},{title:(0,f.Z)("All Events"),action:"all"}],cancelAction:{title:(0,f.Z)("Cancel"),action:"cancel"}}};function G(e,t){const n={start:0,end:0},i=T()(t.start),s=t.end&&T()(t.end);return e.task?s?t.byDateOnly?(n.start=e.start?T()(e.start).year(i.year()).month(i.month()).date(i.date()).valueOf():t.start,n.end=e.end?T()(e.end).year(s.year()).month(s.month()).date(s.date()).valueOf():t.end||0):(n.start=t.start,n.end=t.end||0):(t.byDateOnly?n.end=e.end?T()(e.end).year(i.year()).month(i.month()).date(i.date()).valueOf():t.start:n.end=t.start,n.start=e.start&&e.end?n.end-(e.end-e.start):0):t.byDateOnly?(n.start=T()(e.start).year(i.year()).month(i.month()).date(i.date()).valueOf(),n.end=s?T()(e.end).year(s.year()).month(s.month()).date(s.date()).valueOf():e.end?n.start+e.end-e.start:0):(n.start=t.start,n.end=t.end||(e.end?n.start+e.end-e.start:0)),t.hasOwnProperty("allDay")&&(n.allDay=t.allDay),n}function $(e,t,n){const i=o.Z.getFilter(e),{anchorDate:s,displayMode:r,selectedDate:l}=i;let d;switch(r){case"agenda":case"multiweek":d="week";break;default:d=r}const c="previous"===t?s.clone().subtract(1,d):s.clone().add(1,d);let h;if(n&&a.Z.getDisplayRange(c,r).contains(n))h=n.clone();else if("month"===r){const e=a.Z.getDisplayRange(c,r),t=(0,P.Xq)(l,s);h=(0,P.FY)(t,l.weekday(),c,!1),h.isAfter(e.end,"day")&&(h=(0,P.Ro)(l.weekday(),c,!0))}else h="previous"===t?l.clone().subtract(1,d):l.clone().add(1,d);j.updateCalendarUI(e,{anchorDate:c,selectedDate:h})}function K(e,t=!0){return t&&a.Z.isCalDAV(o.Z.getAccountForCalendar(e.calendarId)?.account_type)}const j=new class{#e=!1;async loadAccounts(){return new Promise((e=>I.Z.calendar.getAllAccounts(e)))}async loadCalendars(){return new Promise((e=>I.Z.calendar.getAll(e)))}async loadEvents(){return j.transformVivaldiEvents(await I.Z.calendar.getAllEvents())}async loadPromise(){if(!u.Z.get(A.kMailIsTurnedOff)){const[e,t,n]=await Promise.all([j.loadAccounts(),j.loadEvents(),j.loadCalendars(),d.Z.loadNotifications()]);m.Z.dispatch({actionType:"CALENDAR_INIT",accounts:e,events:t,calendars:n}),j.loadAlarms()}}transformVivaldiEvents(e){return e.map((e=>{const{rrule:t,start:n=0,end:i,attachment:s,...o}=e;let r,l=0,d=0;if(e.timezone===k.$T||e.allDay){const e=(0,P.EP)()||"",t=T().tz.zone(e);t&&(l=t.utcOffset(n||0)*k.lb,d=t.utcOffset(i||0)*k.lb)}else U.has(o.timezone)||(o.timezone=(0,P.EP)());return t&&(e.task?n?r=(0,M.Qj)(t,n+l,e.timezone):i&&(r=(0,M.Qj)(t,i+d,e.timezone)):r=(0,M.Qj)(t,n+l,e.timezone)),{...o,...(0,C.Z)(r?{recurrence:r}:null),start:n?n+l:0,end:i?i+d:0,attachment:a.Z.stringToAttachments(s)}}))}loadAlarms(){y.Z.alarms.getAll((e=>{m.Z.dispatch({actionType:"CALENDAR_ALARMS_INIT",alarms:e})}))}createException(e,t,n,i){return new Promise((s=>{I.Z.calendar.createEventException(e,t,n,i,(e=>s(j.transformVivaldiEvents([e])[0])))}))}createEvent(e,t,n=!0){return new Promise(((i,r)=>{const l=(0,P.sG)(t),c=o.Z.getCalendars().find((e=>e.id===l.calendarId));c?(c.hidden&&j.updateCalendar(c.id,{hidden:!1}),l.syncPending=K(l,n),I.Z.calendar.eventCreate(l,(t=>{if(y.Z.runtime.lastError)w.Z.error("Calendar",["create","event"],new Error(y.Z.runtime.lastError.message)),r("Error creating event");else{const o=j.transformVivaldiEvents([t])[0];n&&a.Z.isRemoteCalendar(o.calendarId)&&s.Z.createEvent(e,o),o.notifications&&o.notifications.forEach((e=>{(0,d.r)(e,o)})),i(o)}}))):r("Can not create event, calendar not found")}))}createEvents(e){return new Promise(((t,n)=>{const i=e.map((e=>{const{recurrence:t,...n}=e;return{rrule:t?Z.Ci.optionsToString({...t.origOptions,count:0===t.origOptions.count?1:t.origOptions.count}):"",...n,syncPending:!1}})).map((e=>(0,P.sG)(e)));I.Z.calendar.eventsCreate(i,(e=>{const i=y.Z.runtime.lastError;i&&(w.Z.error("Calendar",["create","events"],new Error(i.message)),n(i.message)),t(e)}))}))}eventToCreateDetails(e){const{alarmId:t,id:n,recurrence:i,recurrenceExceptions:s,trash:o,trash_time:r,notifications:l,filteredOut:d,invites:c,attachment:h,recurrenceId:p,...u}=e,g={...u,attachment:a.Z.attachmentsToString(h),is_template:!1};return i&&(g.rrule=Z.Ci.optionsToString({...i.origOptions,count:0===i.origOptions.count?1:i.origOptions.count})),g.timezone=g.timezone||(0,P.EP)(),g.notifications=l?.map((e=>({name:e.name,when:e.when}))),g.invites=c?.map((e=>({address:e.address,name:e.name||"",partstat:e.partstat||"NEEDS-ACTION"}))),g}async updateEvent(e,t,n,i=!1){function l(e){const n=parseInt(t.id.split(":")[1]);let i=0,s=t.recurrence;if(n!==t.start){i=t.start-n;const e=(0,M.EE)(t.recurrence?.origOptions,i);s=e&&(0,M.Zm)({...e,...(0,C.Z)(e.dtstart?{dtstart:new Date((0,P.FL)(e.dtstart).valueOf()+i)}:null)})}const o=e.start+i,a=o+t.end-t.start;return{...t,uid:e.uid,id:e.id,start:o,end:a,recurrence:s}}function h(e){const{id:t,trash_time:n,recurrenceExceptions:i,recurrence:s,notifications:o,invites:r,eventExceptions:l,filteredOut:d,attachment:c,recurrenceId:h,...p}=e;return p.rrule=s?s.toString():"",new Promise((e=>I.Z.calendar.updateEvent(t,{...p,attachment:a.Z.attachmentsToString(c)},(t=>e(j.transformVivaldiEvents([t])[0])))))}let p,u=(0,P.sG)(t,!1);if(u.id=u.id.split("-")[0],u.syncPending||(u.syncPending=K(u,i)),a.Z.isGeneratedRecurringEvent(t)){const o=u.id.split(":")[0],r=parseInt(u.id.split(":")[1]),c=a.Z.getGeneratedSourceEvent(t);switch(n){case"single":if(a.Z.getBaseEventIfException(u)){const e=c.recurrenceExceptions?.find((e=>e.date===u.recurrenceId))?.exception_event_id;if(!e)throw new Error("Could not find exception event id");u.id=e,u.recurrence=void 0,u.recurrenceExceptions=[],p=await h(u),d.Z.updateAlarmsForEvent(p),u=c}else{const n=j.eventToCreateDetails({...t,calendarId:t.calendarId,start:t.start,sequence:0,recurrence:void 0});p=await j.createEvent(e,n,!1),u=await j.createException(o,p.id,!1,r),c.recurrenceExceptions=(c.recurrenceExceptions??[]).concat({date:r}),d.Z.updateAlarmsForEvent(c)}p.recurrenceId=r;break;case"upcoming":if(!r||!c)throw new Error(`Invalid event id to update, ${u.id}`);const{recurrence:n}=c;if(!n)throw new Error(`No recurrence on event to update, ${u.id}`);const g=new Date(r),m=(0,M._v)(n,g);if(!m){u=l(c);break}const{origOptions:v}=n,f=t.start-r,w=u.recurrence&&(0,M.EE)({...u.recurrence.origOptions},f),b=(0,M.Zm)({...v,until:m});let C,S;const T=v.count;if(T){const e=b.all().length;C=Z.Ci.optionsToString({...v,count:e});const t=T-e;S=w&&(0,M.Zm)({...w,count:t,dtstart:g})}else C=Z.Ci.optionsToString({...v,until:(0,P.VV)(m)}),S=w&&(0,M.Zm)({...w,dtstart:g});const k=await new Promise((e=>{I.Z.calendar.updateEvent(c.id,{rrule:C},(t=>{if(y.Z.runtime.lastError)throw new Error(y.Z.runtime.lastError.message);e(j.transformVivaldiEvents([t])[0])}))}));return a.Z.isRemoteCalendar(k.calendarId)&&i&&s.Z.updateEvent(e,k),d.Z.updateAlarmsForEvent(k),u.uid=a.Z.generateGUID(),u.href="",u.etag="",u.trash||(u.recurrence=S,u=await j.createEvent(e,j.eventToCreateDetails(u))),u;default:if(!c)throw new Error(`Source event for ${t.id} not found`);u=l(c)}}(u.timezone===k.$T||u.allDay)&&(u.start&&(u.start=(0,P.VV)(new Date(u.start)).valueOf()),u.end&&(u.end=(0,P.VV)(new Date(u.end)).valueOf()));const g=o.Z.getEvents(),m=g.find((e=>e.id===u.id)),v=a.Z.isOwnEvent(u),f=a.Z.shouldIncrementSequence(u,g);if(v&&f){const{sequence:t}=u;u.sequence=t?t+1:1,u.trash||function(e,t,n,i,s=!1){if(!(n.invites&&0!==n.invites.length||i&&i.invites&&0!==i.invites.length))return;if(!n.invites||!t)throw new Error("Missing invites from draft or invalid event Id");const o=i?.invites?i.invites:[],l=(0,_.Z)(n.invites,o,"address"),d=(0,_.Z)(o,n.invites,"address"),c=(0,_.Z)(o,d,"address");if(l.forEach((e=>{I.Z.calendar.createInvite({event_id:t,name:e.name||"",address:e.address,partstat:e.partstat})})),c.forEach((e=>{const t=n.invites&&n.invites.find((t=>t.address===e.address));t&&I.Z.calendar.updateInvite({id:e.id,name:t.name,partstat:t.partstat})})),d.forEach((e=>I.Z.calendar.deleteInvite(e.id))),a.Z.isOwnEvent(n)){const t=[];l.length&&t.push(["create",l]),s&&c.length&&t.push(["update",c]),d.length&&t.push(["cancel",d]),r.Z.sendAttendeeMails(e,n,t)}}(e,u.id,u,m,!0)}return u.trash||function(e){const t=e.notifications||[];if(!e.id)throw new Error("Can not save event reminders, invalid event Id.");const[n,i]=(0,E.Z)(t,(e=>!e.id)),s=c.Z.getState().notifications.filter((t=>t.event_id===e.id)),o=s.filter((e=>!i.some((t=>t.id===e.id))));n.filter((e=>!s.some((t=>e.when===t.when)))).forEach((t=>{d.Z.createNotification({event_id:e.id,when:t.when,period:t.period||0,delay:t.delay||0,name:t.name||"",description:t.description||""},e)})),i.forEach((t=>{d.Z.updateNotification(t,e)})),o.forEach((e=>{d.Z.deleteNotification(e)}))}(u),i&&(m&&m.calendarId!==u.calendarId?(a.Z.isRemoteCalendar(m.calendarId)&&s.Z.deleteEvent(m.id),a.Z.isRemoteCalendar(u.calendarId)&&s.Z.createEvent(e,s.Z.resetEventRemoteData(u))):a.Z.isRemoteCalendar(u.calendarId)&&s.Z.updateEvent(e,u,p)),h(u)}selectEvent(e,t){m.Z.dispatch({actionType:"CALENDAR_EVENT_SELECT",editor:e,options:t})}showAddEvent(e,t,n){j.addEventCommand(e,a.Z.minimalCreateEvent({title:t,url:n}))}addEventCommand(e,t){t.task||t.start||(t.start=(0,P.zX)(Date.now())),t.url?.startsWith("data:")&&(t.url="");const n={pageId:o.Z.getDialogResourceKey(),uid:Symbol("AddEventDialog")};j.editEvent(n,null,t),m.Z.dispatch({actionType:"MAIN_SHOW_CALENDAR_EDIT_EVENT",winId:e,options:{editor:n}})}editEventCommand(e){const t=function(e){if(null==e){const e=new Error("No page Id given when opening editor");throw w.Z.error("Calendar",["editing"],e),e}let{editor:t}=o.Z.getCalendarState(e);if(e!==t.pageId&&(t=o.w.get(e)),!t){const t=new Error(`Could not find editor for page ${e}`);throw w.Z.error("Calendar",["editing"],t),t}return t}(a.Z.getPageId(e));j.editEvent(t,null,a.Z.minimalCreateEvent({title:""}))}async editEvent(e,t,n){const i=v.ZP.getId();let s;if(!t){const t=o.Z.getFilter(e.pageId),r=e.pageId===o.Z.getPanelResourceKey()?"day"!==t.displayMode:!["day","week"].includes(t.displayMode),{start:l,end:d,task:c=!1,allDay:h=!r&&t.allDaySelected,title:p=""}=n||{};let g=0,m=0;if(!c){if(l)g=l;else{const e=t.selectedDate.valueOf();g=r&&0===(0,P.oR)(e)?e+10*k.QI:e}m=d?h?T()(d).startOf("day").add(1,"day").valueOf():d:h?T()(g).add(1,"day").valueOf():g+u.Z.get(A.kCalendarDefaultDuration)}let v,f=-1;if(h?u.Z.get(A.kCalendarDefaultAlldayNotification)&&(f=u.Z.get(A.kCalendarDefaultAlldayNotificationTime)):f=u.Z.get(A.kCalendarDefaultNotification),-1!==f&&(v=[{id:"",name:"",when:f*k.lb}]),!a.Z.doesCalendarsExistsAndShowWarning(i))return!1;const y=o.Z.getDefaultCalendar();let w=y?.id??"";const b=o.Z.getAccounts().find((e=>e.id===y?.accountId));if("google"===b?.account_type)if(c&&!y?.supportedCalendarComponent?.vtodo){const e=R(b);e.length>0&&(w=e[0].id)}else if(!y?.supportedCalendarComponent?.vevent){const e=o.Z.getCalendars().find((e=>e.accountId===b.id&&e.supportedCalendarComponent?.vevent));e&&(w=e.id)}if(n){const{is_template:e,...t}=n;s={...t,title:p,calendarId:w,uid:a.Z.generateGUID(),id:"",start:g,end:m,allDay:h,task:c,notifications:v,invites:[],attachment:[]}}}const r=o.Z.getEditState();r.eventDraft&&this.endEventEdit(i,r.editor,t||s),m.Z.dispatch({actionType:"CALENDAR_EVENT_EDIT",editor:e,eventDraft:t?(0,N.Z)(t):s})}async pollAllCalDAVAccountsWithStatus(e){const t=await j.pollAllCalDAVAccounts(e);g.Z.setStatus(e,B(t),6e3)}async pollAllCalDAVAccounts(e,t){const n=o.Z.getAccounts().filter((e=>e.url)).map((e=>e.id)),i={didPoll:!1,calendars:[],message:"",error:!1};if(0===n.length)return i;const s=o.Z.getCalendars().filter((e=>n.some((t=>t===e.accountId)))).filter((e=>e.active)).map((e=>e.lastChecked)).filter(Boolean).reduce(((e,t)=>t>e?t:e),0)+6e4<=Date.now();return t&&!s?i:await j.pollCalDAVAccounts(e,n)}async pollCalDAVAccounts(e,t){return await s.Z.pollCalDAV(e,t)}updateEventEdit(e,t){const{eventDraft:n}=o.Z.getEditState();if(n&&n.task!==t.task)if(t.task)t.allDay?t.end=n.end-k.hd:t.end=n.end;else if(!t.start&&!t.end){const e=(0,P.zX)(Date.now());t.start=e,t.end=e+u.Z.get(A.kCalendarDefaultDuration)}if(n&&n.allDay!==t.allDay&&(t.allDay?t.end&&(t.end=t.end+k.hd):(t.end&&(t.end=t.end-k.hd),t.timezone===k.$T&&(t.timezone=""))),!t.organizer&&t.invites?.length){const{invites:e}=t,n=r.Z.getOrganizerForEvent(t);t.organizer=n,n&&!e.find((e=>e.address===n))&&e.push({id:"",event_id:t.id,address:n,partstat:"ACCEPTED"})}const{calendarId:i,task:s}=t,l=o.Z.getAccountForCalendar(i);if("google"===l?.account_type&&s&&n&&!n.task){const e=a.Z.getLocalGoogleTasksCalendars(l);e.length&&(t.calendarId=e[0].id,t.allDay=!0,t.timezone=k.$T)}m.Z.dispatch({actionType:"CALENDAR_EVENT_EDIT",editor:e,eventDraft:t})}async endEventEdit(e,t,n){"cancel"===u.Z.get(A.kCalendarClickOutside)?this.cancelEventEdit(t):await this.saveEventEdit(e,t,n)}cancelEventEdit(e){m.Z.dispatch({actionType:"CALENDAR_EVENT_EDIT",editor:e,eventDraft:null})}async saveEventEdit(e,t,n){const{eventDraft:i,editor:s,events:d}=o.Z.getCalendarState(t.pageId);if(!i||s.pageId!==t.pageId||s.uid!==t.uid)return!1;if(!a.Z.doesCalendarsExistsAndShowWarning(e))return!1;i.calendarId||(i.calendarId=o.Z.getDefaultCalendar()?.id??""),i.id=i.id.split("-")[0];const c=d.find((e=>e.id===i.id)),h=a.Z.shouldSaveEvent(i,c);if("IGNORE"===h)return j.cancelEventEdit(t),!0;if("DELETE"===h)return await j.trashEvent(e,t,i.id);if(j.cancelEventEdit(t),i.id){if("SAVE_INVITED"!==h&&!a.Z.isOwnEvent(i)){const{action:t}=await l.Z.showModal(e,{modal:H()});if("cancel"===t)return!0}let s="all";if(c&&a.Z.isRecurringEvent(c)){const{action:t}=await l.Z.showModal(e,{modal:z("save")});s=t}"all"!==s&&"upcoming"!==s&&"single"!==s||j.updateEvent(e,i,s,!0),j.cancelEventEdit(t),n&&j.editEvent(t,n)}else{const n=await j.createEvent(e,F(j.eventToCreateDetails({...i,title:i.title||""})));n?.invites?.length&&r.Z.sendAttendeeMails(e,n,[["create",n.invites]]),j.selectEvent(t,{event:n,publish:!1})}return!0}async moveEvent(e,t,n,i){const s=o.Z.getEvent(n);if(!s)return;if(!a.Z.isOwnEvent(s)){const{action:t}=await l.Z.showModal(e,{modal:H()});if("cancel"===t)return s}const r=G(s,i);!1===i.allDay&&s.allDay&&s.end-s.start===k.hd&&(r.end=r.start+u.Z.get(A.kCalendarDefaultDuration));const d={...s,...r};if(!a.Z.isRecurringEvent(s))return j.cancelEventEdit(t),j.updateEvent(e,d,void 0,!0);{const{action:t}=await l.Z.showModal(e,{modal:z("move")});if("all"===t||"upcoming"===t||"single"===t)return j.updateEvent(e,d,t,!0)}}async copyEvent(e,t,n,i){const s=o.Z.getEvent(n);if(s){let t="";const n=G(s,i),o={...s,...n,uid:a.Z.generateGUID(),etag:"",href:""},{recurrence:d}=s;if(d){if(t=await l.Z.showModal(e,{modal:z("copy")}),"cancel"===t)return;if("single"===t)o.recurrence=void 0;else{const e=i.start-s.start,n=(0,M.EE)(d.origOptions,e);if("upcoming"===t){n.dtstart=new Date(o.start);const e=d.origOptions.count;if(e){let t=0;const i=(0,P.VV)(new Date(s.start));d.all(((e,n)=>!(e>=i)||(t=n,!1))),n.count=e-t}}else"all"===t&&d.origOptions.dtstart&&(n.dtstart=(0,P.FL)(new Date(d.origOptions.dtstart.valueOf()+e)),o.start=n.dtstart?.valueOf()||0,o.end=o.start+s.end-s.start);d.origOptions.until&&(n.until=(0,P.FL)(new Date(d.origOptions.until.valueOf()+e))),o.recurrence=(0,M.Zm)(n)}}const c=r.Z.getOrganizerForEvent(o);return o.organizer&&o.organizer!==c&&(o.organizer=c,o.invites=[]),j.createEvent(e,j.eventToCreateDetails(o))}}async trashEvent(e,t,n,i){function c(e,t){return e.invites?.length&&a.Z.isOwnEvent(e)&&t.pageId!==o.Z.getMailResourceKey()}function h(e,t){const i=n.split(":")[0],{recurrenceExceptions:s}=e;if(s){o.Z.getEventsPerCalendar(e.calendarId).forEach((e=>{s.forEach((e=>{const{exception_event_id:n,parent_event_id:s,date:o}=e;n&&i===s&&(void 0===t||o&&o>=t)&&j.deleteEvent(n)}))}))}}async function p(e,n){h(n);const i=await j.updateEvent(e,{...n,trash:!0,syncPending:K(n,!0)},"all");return j.cancelEventEdit(t),a.Z.isRemoteCalendar(n.calendarId)&&await s.Z.deleteEvent(n.id),c(n,t)&&await r.Z.sendAttendeeMails(e,n,[["cancel",n.invites??[]]]),i}if(n){const[u,g]=n.split("-")[0].split(":"),m=parseInt(g),v=o.Z.getEvent(u);if(!v)return!1;let f;if(a.Z.isRecurringEvent(v)){switch(i??(await l.Z.showModal(e,{modal:z("trash")})).action){case"single":if(f=await j.createException(u,"0",!0,m),v.notifications&&(f.notifications?.length??0)<v.notifications.length&&(f.notifications=[...v.notifications]),a.Z.isRemoteCalendar(f.calendarId)){const t=parseInt(f.sequence)+1,n=await I.Z.calendar.updateEvent(f.id,{sequence:t});s.Z.updateEvent(e,j.transformVivaldiEvents([n])[0])}if(j.cancelEventEdit(t),c(v,t)){const{recurrence:t,...n}=v;r.Z.sendAttendeeMails(e,n,[["cancel",v.invites??[]]],!0)}break;case"upcoming":{const{recurrence:n}=v;if(!n||!v.start)return!1;const i=(0,M._v)(n,new Date(m));if(!i){p(e,v);break}const{count:o,...l}=n.origOptions,d=(0,M.Zm)({...l,until:i}),g=parseInt(v.sequence)+1,y=await I.Z.calendar.updateEvent(u,{rrule:d.toString(),sequence:g});f=j.transformVivaldiEvents([y])[0],h(v,i.valueOf()),j.cancelEventEdit(t),c(f,t)&&r.Z.sendAttendeeMails(e,f,[["update",f.invites??[]]]),a.Z.isRemoteCalendar(f.calendarId)&&s.Z.updateEvent(e,f);break}case"all":f=await p(e,v)}}else f=await p(e,v);f&&d.Z.updateAlarmsForEvent(f)}else j.cancelEventEdit(t);return!0}restoreEvent(e,t,n){n||(n=o.Z.getCalendarState(t.pageId).trashedEvents.slice(-1)[0]),n&&(n.trash=!1,j.updateEvent(e,n),n.invites?.length&&r.Z.sendAttendeeMails(e,n,[["create",n.invites]]),a.Z.isRemoteCalendar(n.calendarId)&&s.Z.createEvent(e,n),j.selectEvent(t,{event:n}))}cancelEventChange(e){const t=o.Z.getEditState();if(!t||!t.eventDraft)return;const n=o.Z.getPendingEvent();j.cancelEventEdit(e),n&&j.editEvent(e,n)}createAccount(e){return new Promise(((t,n)=>{I.Z.calendar.createAccount(e,(i=>{const s=y.Z.runtime.lastError;if(s)return w.Z.error("Calendar",["create","account"],e,new Error(s.message)),n(s.message);t(i)}))}))}updateAccount(e){const{id:t,...n}=e;I.Z.calendar.updateAccount(t,n,(e=>{y.Z.runtime.lastError&&w.Z.error("Calendar",["update","account"],n,new Error(y.Z.runtime.lastError.message))}))}async updateCalendar(e,t,n=!0){const i=o.Z.getAccountForCalendar(e);return!!i&&(a.Z.isCalDAV(i.account_type)&&n&&await s.Z.updateCalendar(e,t),(async(e,t)=>new Promise((n=>{I.Z.calendar.update(e,t,(t=>{const i=y.Z.runtime.lastError;if(i){const t=o.Z.getCalendars().find((t=>t.id===e)),n=t?.description??t?.name??"Calendar not found";w.Z.error("Calendar",["update","calendar"],n,t,new Error(i.message))}n(t)}))})))(e,t))}toggleCalendarVisibility(e){const t=o.Z.getCalendars().find((t=>t.id===e));t&&this.updateCalendar(e,{hidden:!t.hidden},!1)}setDefaultCalendarId(e){u.Z.get(A.kCalendarDefaultCalendarId)!==e&&(p.Z.set(A.kCalendarDefaultCalendarId,e),m.Z.dispatch({actionType:"CALENDAR_SET_DEFAULT"}))}async createCalendar(e,t=!1,n=!1){const i=o.Z.getAccounts().find((t=>t.id===e.accountId));if(!n&&"ical"===i?.account_type)return{result:{status:!1,message:(0,f.Z)("Can not create a calendar in a web calendar account")}};if(i&&t&&!(!e||!i?.url)){const{status:t,message:n,name:o,ctag:a}=await s.Z.createCalendar(i,e);if(!t)return{result:{status:t,message:n}};e.name=o,e.ctag=a||""}try{const t=await I.Z.calendar.create(e);return{result:{status:!0,message:(0,f.Z)("Success")},calendar:t}}catch(n){w.Z.error("Calendar",["create","calendar"],n);const i=o.Z.getAccounts().find((t=>t.id===e.accountId)),a=!(!i||!i.url);return t&&i&&a&&await s.Z.deleteCalendar(i,e.name),{result:{status:!1,message:n}}}}async deleteAccount(e){const t=o.Z.getAccounts().find((t=>t.id=e));if(!t)return!1;const{account_type:n,username:s}=t,a=await I.Z.calendar.deleteAccount(e);return y.Z.runtime.lastError?(w.Z.error("Calendar",["delete","account"],e,new Error(y.Z.runtime.lastError.message)),!1):("google"===n&&i.Z.clearAccessAndRefreshTokens(s),a)}async deleteCalendar(e,t=!1){const n=o.Z.getAccounts().find((t=>t.id===e.accountId));if(!n)return{status:!1,message:(0,f.Z)("No account found")};const i=!!n.url,a="ical"===n.account_type;t&&n&&i&&!a&&await s.Z.deleteCalendar(n,e.name);try{const t=await I.Z.calendar.delete(e.id);if(a){return{status:await j.deleteAccount(n.id),message:""}}return{status:t,message:""}}catch(t){const n=e.description??e.name;return w.Z.error("Calendar",["delete","calendar"],n,t),{status:!1,message:t}}}deleteEvent(e){const t=e.split("-")[0].split(":")[0],{notifications:n}=c.Z.getState(),i=n.filter((e=>e.event_id===t));return i.forEach((e=>{d.Z.deleteNotification(e)})),new Promise(((n,i)=>{I.Z.calendar.deleteEvent(t,(()=>{const t=y.Z.runtime.lastError;t&&(w.Z.error("Calendar",["delete","event"],e,new Error(t.message)),i(t.message)),n()}))}))}setViewMode(e,t){const n=a.Z.getPageId(e);"number"==typeof n&&(n!==o.Z.getPanelResourceKey()||W.includes(t))&&j.updateCalendarUI(n,{displayMode:t})}zoomViewMode(e,t){const n=a.Z.getPageId(e);if("number"!=typeof n)return;const i=o.Z.getCalendarState(n).calendarFilter.displayMode,s=n===o.Z.getPanelResourceKey()?W:V;let r=s.findIndex((e=>e===i))+t;r<0?r=0:r>=s.length&&(r=s.length-1),j.updateCalendarUI(n,{displayMode:s[r]})}updateCalendarUI(e,t){const{displayMode:n}=t,i=o.Z.getFilter(e);if(n&&n!==i.displayMode){const s=e===o.Z.getPanelResourceKey()?A.kCalendarPanelDisplayMode:A.kCalendarDisplayMode;p.Z.set(s,n);const{anchorDate:r,selectedDate:l}=i;a.Z.getDisplayRange(r,n).contains(l)||(t={...t,anchorDate:l.clone(),selectedDate:l})}m.Z.dispatch({actionType:"CALENDAR_UPDATE_UI",calendarUI:t,pageId:e})}async selectDate(e,t,n,i={}){if(!n.isValid())return void w.Z.error("Calendar",["actions"],new Error("Invalid date selected"));const s=o.Z.getEditState();s.eventDraft&&this.endEventEdit(e,s.editor);const{isAllDay:r,setToday:l}=i,d=o.Z.getFilter(t),{anchorDate:c,displayMode:h}=d;let p;p=!a.Z.getDisplayRange(c,h).contains(n)||l&&"agenda"===h?{anchorDate:n,selectedDate:n,allDaySelected:r??!1}:{selectedDate:n,allDaySelected:r??!1},j.updateCalendarUI(t,{...d,...p})}selectToday(e,t){const n=T()((0,P.zX)(Date.now()));j.selectDate(e,t,n,{setToday:!0})}viewPreviousPeriod(e,t){$(e,"previous",t)}viewNextPeriod(e,t){$(e,"next",t)}async pickFilesForImport(){return await(0,D.WJ)()}startCalendarImport(e,t){return(0,D.J9)(e,t)}importEventsDialog(e){m.Z.dispatch({actionType:"MAIN_SHOW_CALENDAR_IMPORT_EVENTS_DIALOG",winId:v.ZP.getLastActiveBrowserWindowId(),options:{uri:e}})}init(){I.Z.utilities.onBroadcastMessage.addListener(j._onBroadcastMessage),u.Z.addListener(A.kMailIsTurnedOff,Y),j.startAPIChangeListeners(!0),s.Z.calendarServiceStart(),I.Z.calendar.onIcsFileOpened.addListener(j.importEventsDialog),I.Z.calendar.onWebcalUrlOpened.addListener(j.importEventsDialog)}_onBroadcastMessage(e){const t=e.calendar?.message;t&&!v.ZP.isMail()&&("startListeners"===t?j.startAPIChangeListeners():"stopListeners"===t?j.stopAPIChangeListeners():"loadData"===t&&j.loadPromise())}startListeners(){j.startAPIChangeListeners(),s.Z.calendarServiceStart()}stopListeners(){s.Z.calendarServiceStop(),j.stopAPIChangeListeners()}eventCreated(e){const t=v.ZP.getId();if(j.loadPromise(),v.ZP.isActive(t))return;const n=h.Z.getActivePage(t);!!n&&O.jk.getDisplayUrl(n.url).startsWith("vivaldi://calendar")||(0,x.c)({title:(0,f.Z)("New Event Created"),onClick:()=>{l.Z.showCalendar(t,e.id)}})}startAPIChangeListeners(e=!1){this.#e||u.Z.get(A.kMailIsTurnedOff)||(v.ZP.isMail()&&I.Z.utilities.broadcastMessage({calendar:{message:"startListeners"}}),I.Z.calendar.onEventCreated.addListener(this.eventCreated),I.Z.calendar.onCalendarDataChanged.addListener(j.loadPromise),e?L.nextTick((()=>j.loadPromise())):j.loadPromise(),d.Z.startAPIChangeListeners(),this.#e=!0)}stopAPIChangeListeners(){this.#e&&(v.ZP.isMail()&&I.Z.utilities.broadcastMessage({calendar:{message:"stopListeners"}}),I.Z.calendar.onEventCreated.removeListener(this.eventCreated),I.Z.calendar.onCalendarDataChanged.removeListener(j.loadPromise),this.#e=!1)}exportEvents(e){b(e)}};function Y(e,t,n){n===A.kMailIsTurnedOff&&(t?j.stopAPIChangeListeners():j.startAPIChangeListeners())}const X=j},29717:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(84990);const s={enableCapture:function(e){i.Z.dispatch({actionType:"CAPTURE_ENABLE",winId:e})},disableCapture:function(e){i.Z.dispatch({actionType:"CAPTURE_DISABLE",winId:e})}}},37441:(e,t,n)=>{"use strict";n.d(t,{V:()=>s});var i=n(92292);async function s(e,t){const n=await i.Z.tabs.get(e);if(!n)return;let s;try{s=JSON.parse(n.vivExtData||"{}")}catch(e){s={}}const o={...s,...t};let a=!1;const r=Object.entries(o).reduce(((e,[t,n])=>void 0===n&&void 0!==s[t]?(a=!0,e):{...e,[t]:n}),{}),l=JSON.stringify(r);l===n.vivExtData||!a&&"{}"===l||await i.Z.tabs.update(e,{vivExtData:l})}},21788:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var i=n(55022),s=n(63353),o=n(83526),a=n(15489),r=n(7064);const l=["INPUT","FRAME","IFRAME","OBJECT","SELECT","TEXTAREA","EMBED"];function d(){let e;const t=function(t){const{clipboardData:n}=t;n&&n.types.indexOf("text/plain")>-1&&(e=n.getData("text/plain"),t.preventDefault())};return document.addEventListener("paste",t),document.execCommand("paste"),document.removeEventListener("paste",t),e}const c=new class{undo(e){r.Z.editcommand.execute("undo",e)}redo(e){r.Z.editcommand.execute("redo",e)}cut(e){r.Z.editcommand.execute("cut",e)}copy(e){r.Z.editcommand.execute("copy",e)}paste(e){r.Z.editcommand.execute("paste",e)}selectAll(e){r.Z.editcommand.execute("selectAll",e)}set(e){const{body:t}=document;if(!e||!t)return;const n=document.createElement("input");n.style.position="absolute",n.style.zIndex="-1",n.value=e,t.appendChild(n),n.select(),document.execCommand("copy")||console.error("Failed to copy text."),t.removeChild(n)}pasteAsPlainText(e){r.Z.editcommand.execute("pasteAndMatchStyle",e)}pasteAsPlainTextOrPasteAndGo(e,t){const n=d();let i=!1;if(!a.ZP.isPopup(e)){const{activeElement:s}=document;s?.classList.contains("url")?(o.Z.doAction(e,t,"urlPasteAndGo",{clipboardText:n}),i=!0):s?.classList.contains("vivaldi-searchfield")?(o.Z.doAction(e,t,"searchPasteAndGo",{clipboardText:n}),i=!0):(l.indexOf(s?.tagName)>-1||s?.isContentEditable)&&(r.Z.editcommand.execute("pasteAndMatchStyle",e),i=!0)}i||r.Z.windowPrivate.getFocusedElementInfo(e).then((({editable:i})=>{i?r.Z.editcommand.execute("pasteAndMatchStyle",e):o.Z.doAction(e,t,"urlPasteAndGo",{clipboardText:n})}))}copyWithFilter(e){const t=e.indexOf("?");-1!==t&&(e=e.slice(0,t)),this.copyTextToClipboard(e)}async createNoteFromSelection(e){const t=s.Z.getActivePage(e);if(t){const n=d(),s=await r.Z.utilities.getSelectedText(t.id);await i.Z.createNote(e,{content:n,url:s===n?t.url:void 0})}}copyUrlToClipboard(e){const t=function(t){t.clipboardData&&(t.clipboardData.setData("text/plain",e),t.stopPropagation(),t.preventDefault())};document.addEventListener("copy",t),document.execCommand("copy"),document.removeEventListener("copy",t)}copyTextToClipboard=e=>{const t=t=>{t.clipboardData&&(t.clipboardData.setData("text/plain",e),t.stopPropagation(),t.preventDefault())};return document.addEventListener("copy",t),document.execCommand("copy"),document.removeEventListener("copy",t),Promise.resolve()}}},47995:(e,t,n)=>{"use strict";n.d(t,{Z:()=>w});var i=n(88083),s=n(68247),o=n(29087),a=n(84990),r=n(56371),l=n(24899),d=n(7064),c=n(10334),h=n(46601),p=n(47380),u=n(89175);const g={version:1,chains:[{category:"CATEGORY_COMMAND_CHAIN",key:"ckqjhvf430003c5429ni7i7bz",label:(0,r.Z)("command chain","Close Other and Open Defined Tab"),name:"COMMAND_ckqjhvf430003c5429ni7i7bz",chain:[{defaultValue:"https://vivaldi.com",key:"f57b8092-9426-4bc8-8e39-fcf3e315b065",param:"https://vivaldi.com",label:"COMMAND_OPEN_LINK_DEFAULT",name:(0,r.Z)("Open Link in New Tab")},{key:"275ca3f7-ecfb-4445-bf87-686cd473536e"}]},{category:"CATEGORY_COMMAND_CHAIN",key:"ckqkoqycf0003wv4210uduu8n",label:(0,r.Z)("command chain","Toggle Fullscreen and Reader Mode"),name:"COMMAND_ckqkoqycf0003wv4210uduu8n",chain:[{key:"7420368f-565e-409f-8eec-5b5c578429af"},{key:"8dd47fc9-4c1f-4487-a475-f55bfa61aaf2"}]},{category:"CATEGORY_COMMAND_CHAIN",key:"ckqjdk4o7000001l58zh17egm",label:(0,r.Z)("command chain","Open Links and Tile"),name:"COMMAND_ckqjdk4o7000001l58zh17egm",chain:[{defaultValue:"https://vivaldi.com",key:"0b01337b-4c13-4197-90c8-179c5c91cfff",param:"https://vivaldi.com",label:"COMMAND_OPEN_LINK_CURRENT"},{defaultValue:"https://vivaldi.net",key:"f57b8092-9426-4bc8-8e39-fcf3e315b065",param:"https://vivaldi.net",label:"COMMAND_OPEN_LINK_DEFAULT"},{defaultValue:"https://help.vivaldi.com",key:"f57b8092-9426-4bc8-8e39-fcf3e315b065",param:"https://help.vivaldi.com",label:"COMMAND_OPEN_LINK_DEFAULT"},{defaultValue:1e3,key:"2eb81004-6703-46db-9933-6afcfde924e4",param:150},{key:"e245bce5-20a7-481f-910e-23bf1de86748"},{key:"e245bce5-20a7-481f-910e-23bf1de86748"},{defaultValue:1e3,key:"2eb81004-6703-46db-9933-6afcfde924e4",param:125},{key:"cdd99010-5477-4508-aa28-d671de35dcb2"},{key:"854f8a44-50bd-41bc-8277-acd51e719d1b"}]}]},m=function(e){i.Z.isNamedMenuAvailable(e)&&d.Z.menuContent.get(e,((t,n,i)=>{a.Z.dispatch({actionType:"COMMAND_SET_NAMED_MENU",name:e,content:i})}))},v=function(e){e.actionChanged?function(e,t,n){const i=f(e);if(!i)return;const s={shortcuts:t,gestures:n,feature:h.CN.concat(o.Z.get(u.kChainedCommandsCommandList)).find((t=>t.name===e))?.feature||"browser"};a.Z.dispatch({actionType:"COMMAND_UPDATE_COMMAND",item:{key:i,value:s}})}(e.actionChanged.command,e.actionChanged.shortcuts,e.actionChanged.gestures):e.actionsRestored&&function(){const e=h.CN.concat(o.Z.get(u.kChainedCommandsCommandList)),t=o.Z.get(u.kActions)[0],n=e.map((e=>{const n=t[e.name];if(n)return{key:e.name,value:{...n,feature:e.feature||"browser"}}})).filter(Boolean);a.Z.dispatch({actionType:"COMMAND_RESET",items:n})}()};function f(e){if(e.startsWith("COMMAND_"))return e}const y=new class{loadPromise(){const{version:e}=g;e!==o.Z.get(u.kChainedCommandsVersion)&&(e=>{const{chains:t}=g,n=o.Z.get(u.kChainedCommandsDeletedCommandList),i=o.Z.get(u.kChainedCommandsCommandList),a=i.map((e=>e.key)),r=t.filter((e=>!n.includes(e.key)&&!a.includes(e.key))),l=[...i,...r];s.Z.set(u.kChainedCommandsCommandList,l),s.Z.set(u.kChainedCommandsVersion,e)})(e);const t=h.CN.concat(o.Z.get(u.kChainedCommandsCommandList)),n=o.Z.get(u.kActions)[0],i=t.map((e=>{const t=n[e.name];if(t)return{key:e.name,value:{...t,feature:e.feature||"browser"}}})).filter(Boolean);return a.Z.dispatch({actionType:"COMMAND_INITIALIZE",items:i}),d.Z.menuContent.onChanged.addListener(m),o.Z.addListener(u.kChainedCommandsCommandList,y.chainListChanged),d.Z.utilities.onBroadcastMessage.addListener(v),Promise.resolve()}requestNamedMenu(e){i.Z.getIsInitialized()&&!i.Z.isNamedMenuAvailable(e)&&d.Z.menuContent.get(e,((t,n,i)=>{a.Z.dispatch({actionType:"COMMAND_SET_NAMED_MENU",name:e,content:i})}))}restoreShortcuts(){const e=(0,l.Z)(o.Z.getDefault(u.kActions))[0];i.Z.getUserEditableCommands().forEach((t=>{const n=i.Z.getCommandConfiguration(t.name)?.gestures;n?e[t.name]={...e[t.name],gestures:n}:e[t.name]?.gestures&&delete e[t.name].gestures})),s.Z.set(u.kActions,[e]),d.Z.utilities.broadcastMessage({actionsRestored:{}})}restoreGestures(){const e=(0,l.Z)(o.Z.getDefault(u.kActions))[0];i.Z.getUserEditableCommands().forEach((t=>{const n=i.Z.getCommandConfiguration(t.name)?.shortcuts;n?e[t.name]={...e[t.name],shortcuts:n}:e[t.name]?.shortcuts&&delete e[t.name].shortcuts})),s.Z.set(u.kActions,[e]),d.Z.utilities.broadcastMessage({actionsRestored:{}})}setShortcuts(e,t){const n=o.Z.get(u.kActions)[0],i={...n};i[e]={...n[e]},t&&t.length>0?i[e].shortcuts=t:delete i[e].shortcuts,s.Z.set(u.kActions,[i]),d.Z.utilities.broadcastMessage({actionChanged:{command:e,shortcuts:t,gestures:i[e].gestures}})}setGestures(e,t){const n=o.Z.get(u.kActions)[0],i={...n};i[e]={...n[e]},t&&t.length>0?i[e].gestures=t:delete i[e].gestures,s.Z.set(u.kActions,[i]),d.Z.utilities.broadcastMessage({actionChanged:{command:e,shortcuts:i[e].shortcuts,gestures:t}})}chainListChanged(e,t){if(t.length<e.length){const n=e.filter((e=>-1===t.findIndex((t=>t.key===e.key))));if(1===n.length){const e=f(n[0].name);e&&a.Z.dispatch({actionType:"COMMAND_REMOVE_COMMAND",key:e})}else console.warn("Wrong number of elements removed")}}executeActions(e,t,n){const s=(0,p.m)(e),a=i.Z.getCommands().find((e=>e.name===t));if(!a){const e=o.Z.get(u.kChainedCommandsCommandList);for(let n=e.length-1;n>=0;n--)if(e[n].name===t){(0,c.hT)(s,e[n].chain);break}return}let r=n;void 0===r&&(r=(0,h.xU)(a.name)?.defaultValue),void 0!==r&&(s.param=r),a.action(s)}},w=y},17751:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(84990);const s=new class{log(e){i.Z.dispatch({actionType:"COMPONENT_LOGGER_LOG",entry:e})}clear(e){i.Z.dispatch({actionType:"COMPONENT_LOGGER_CLEAR",component:e})}}},4660:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i=n(73132),s=n(72010),o=n(84990),a=n(7064);const r=new class{initialize(e,t){a.Z.contacts.getAll((n=>{o.Z.dispatch({actionType:"CONTACT_INITIALIZE",windowId:e,contacts:n.map((e=>(0,i.Z)(e))),newContact:t})}))}updateContact(e,t){o.Z.dispatch({actionType:"CONTACT_UPDATE_CONTACT",windowId:e,contact:t})}addGeneratedContacts(e){o.Z.dispatch({actionType:"CONTACT_ADD_CONTACTS",contacts:e.map((e=>(0,i.Z)(e)))})}async addContact(e){const t=await a.Z.contacts.create({name:e.name,birthday:e.birthday,note:e.note,generatedFromSentMail:e.generatedFromSentMail,avatarUrl:e.avatarUrl,separator:e.separator,trusted:e.trusted});for(const n of e.emailAddresses)await a.Z.contacts.addEmailAddress({contactId:t.id,emailAddress:n.emailAddress,type:n.type});for(const n of e.postalAddresses)await a.Z.contacts.addPropertyItem({propertyName:"postalAddress",contactId:t.id,propertyValue:n.postalAddress,type:n.type});for(const n of e.phoneNumbers)await a.Z.contacts.addPropertyItem({propertyName:"phoneNumber",contactId:t.id,propertyValue:n.phoneNumber,type:n.type});e.id=t.id,o.Z.dispatch({actionType:"CONTACT_ADD_CONTACT",contact:e})}selectContact(e,t,n=!1){o.Z.dispatch({actionType:"CONTACT_SELECT_CONTACT",windowId:e,contact:t,focusContactView:n})}deleteContactsByIds(e){const t=[],n=[];for(const i of e)"string"==typeof i&&(t.push(i),n.push(a.Z.contacts.delete(i)));return Promise.all(n).then((()=>{o.Z.dispatch({actionType:"CONTACT_DELETE_CONTACTS",ids:t})}))}newEmptyContact(e){return new Promise((t=>{a.Z.contacts.create({},(n=>{const s=(0,i.Z)(n);return r.initialize(e,s),t(s)}))}))}newContactFromMailAddress(e,t,n){a.Z.contacts.create({name:t.name||""},(n=>a.Z.contacts.addEmailAddress({contactId:n.id,emailAddress:t.address},(t=>{r.initialize(e,(0,i.Z)(t))}))))}putTrustedEmailAddress(e,t){let n=!1;s.Z.getAsArray().forEach((i=>i.emailAddresses.forEach((s=>{t.address===s.emailAddress&&(n=!0,r.update(e,i.id,{trusted:!0}))})))),!1===n&&a.Z.contacts.create({name:t.name||"",generatedFromSentMail:!0,trusted:!0},(e=>a.Z.contacts.addEmailAddress({contactId:e.id,emailAddress:t.address},(e=>r.addGeneratedContacts([e])))))}async update(e,t,n){Object.keys(n).length>0&&await a.Z.contacts.update(t,n,(t=>r.updateContact(e,(0,i.Z)(t))))}updatePropertyItem(e,t){a.Z.contacts.updatePropertyItem(t,(t=>r.updateContact(e,(0,i.Z)(t))))}updateEmailAddress(e,t,n){a.Z.contacts.updateEmailAddress(t,n,(t=>r.updateContact(e,(0,i.Z)(t))))}addPropertyItem(e,t){a.Z.contacts.addPropertyItem(t,(t=>r.updateContact(e,(0,i.Z)(t))))}removePropertyItem(e,t){a.Z.contacts.removePropertyItem(t,(t=>r.updateContact(e,(0,i.Z)(t))))}addEmailAddress(e,t){a.Z.contacts.addEmailAddress(t,(t=>r.updateContact(e,(0,i.Z)(t))))}removeEmailAddress(e,t){a.Z.contacts.removeEmailAddress(t,(t=>r.updateContact(e,(0,i.Z)(t))))}addIfNotAddressExists(e){a.Z.contacts.getAll((t=>{const n=new Set;t.forEach((e=>e.emailAddresses.forEach((e=>{e.emailAddress&&n.add(e.emailAddress.toLowerCase())}))));const i=[];e.forEach((e=>{n.has(e.address.toLowerCase())||(a.Z.contacts.create({name:e.name||"",generatedFromSentMail:!0},(t=>{a.Z.contacts.addEmailAddress({contactId:t.id,emailAddress:e.address},(e=>r.addGeneratedContacts([e])))})),i.push(e))}))}))}},l=r},83784:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var i=n(1567),s=n(84990),o=n(63153),a=n(15489),r=n(92292),l=n(28773),d=n(7064);const c=[];function h(e){return new Promise((t=>{r.Z.downloads.search(e,t)}))}const p=new class{_isPolling=!1;_openAfterDownload=new Set;ready=new Promise((e=>this._resolveReady=e));_dispatchUpdate=e=>{s.Z.dispatch({actionType:"DOWNLOAD_PANEL_UPDATED",downloadItems:e})};_replaceDownloadItem=(e,t)=>{const n=i.Z.getItems({isIncognitoWindow:!1}),s=n.find((t=>t.id===e.id));if(!s)return;const o=n.indexOf(s),a=[...n.slice(0,o),t,...n.slice(o+1)];this._dispatchUpdate(a)};_startPolling=()=>{this._isPolling||(this._intervalId=setInterval(this._pollInProgressDownloads,500),this._isPolling=!0)};_stopPolling=()=>{this._isPolling=!1,clearInterval(this._intervalId)};_handleNewDownloadItem=e=>{const t=i.Z.getFilter(),n=i.Z.getOrderBy(),o={...(0,l.Z)(t?{query:t.split(" ")}:null),...(0,l.Z)(n?{orderBy:[n]}:null)};r.Z.downloads.search(o,(t=>{this._dispatchUpdate(t);const n=i.Z.getItems({isIncognitoWindow:!1}).find((t=>t.id===e));n&&s.Z.dispatch({actionType:"DOWNLOAD_STARTED",downloadItem:n})}))};_updateState=e=>{const t=i.Z.getItems({isIncognitoWindow:!1}),n=t.findIndex((t=>t.id===e.id));if(-1===n)return void this._handleNewDownloadItem(e.id);const s=[...t.slice(0,n),e,...t.slice(n+1)];this._dispatchUpdate(s)};_updateStateForDownloadItems=e=>{e.forEach(this._updateState)};_handleInProgressSearch=e=>{e.filter((e=>!e.paused)).length||this._stopPolling(),this._setTotalProgress(e),this._updateStateForDownloadItems(e)};_handleFileDeleted=(e,t)=>{this._pollInProgressDownloads(),e?r.Z.downloads.search({id:e,limit:1},(n=>{if(!n||!Array.isArray(n))return void console.warn(`DownloadActions: _handleFileDeleted: Failed to search downloads for ID ${e} (${t})`);const i=n[0];i&&this._updateState(i)})):console.warn(`DownloadActions: _handleFileDeleted: Invalid download ID ${e} (${t})`)};_pollInProgressDownloads=()=>{r.Z.downloads.search({state:"in_progress"},this._handleInProgressSearch)};_setTotalProgress=e=>{const t=e.filter((e=>!e.paused)),n=t.length,i=function(e){return e.length?e.map((e=>e.bytesReceived/e.totalBytes)).reduce(((e,t)=>e*t)):0}(t);s.Z.dispatch({actionType:"DOWNLOAD_SET_TOTAL_PROGRESS",totalNumberOfDownloads:n,totalProgress:i})};_handleDangerousFileDownload=e=>{r.Z.windows.getLastFocused((t=>{t.id===window.vivaldiWindowId&&(a.ZP.isMinimized(window.vivaldiWindowId)&&o.Z.restore(window.vivaldiWindowId),async function(e){if(c.push(e),!(c.length>1))do{e=c[0];try{await r.Z.downloads.acceptDanger(e)}catch(e){}c.shift()}while(c.length>0)}(e))}))};_onTransferChanged=e=>{e.paused&&e.paused.previous&&!e.paused.current?this._onTransferCreated():(e.filename&&this._handleNewDownloadItem(e.id),e.danger&&e.danger.current!==e.danger.previous&&this._handleDangerousFileDownload(e.id),e.exists&&!e.exists.current&&this._handleFileDeleted(e.id,"Deleted from disk"),e.state&&("interrupted"===e.state.current&&this._handleFileDeleted(e.id,"Interrupted"),"complete"===e.state.current&&(r.Z.downloads.search({id:e.id,limit:1},(([e])=>{this._updateState(e),this._pollInProgressDownloads(),s.Z.dispatch({actionType:"DOWNLOAD_COMPLETED",downloadItem:e})})),this._openAfterDownload.has(e.id)&&(r.Z.downloads.open(e.id),this._openAfterDownload.delete(e.id)))))};_onTransferErased=e=>{const t=i.Z.getItems({isIncognitoWindow:!1}),n=t.findIndex((t=>t.id===e));if(-1===n)return;const s=[...t.slice(0,n),...t.slice(n+1)];this._dispatchUpdate(s)};_onTransferCreated=()=>{this._startPolling()};_showDownload=e=>{r.Z.downloads.show(e)};_openDownload=e=>{r.Z.downloads.open(e)};_pauseDownload=e=>{r.Z.downloads.pause(e)};_resumeDownload=e=>{r.Z.downloads.resume(e)};_eraseDownload=e=>{r.Z.downloads.erase({id:e})};_restartDownload=e=>h({id:e}).then((([t])=>{return(n={url:t.url},new Promise((e=>{r.Z.downloads.download(n,e)}))).then((e=>h({id:e}))).then((([e])=>this._replaceDownloadItem(t,e))).then((()=>{return t={id:e},new Promise((e=>{r.Z.downloads.erase(t,e)}));var t}));var n}));_searchDownloads({filter:e,orderBy:t}){return new Promise((n=>{const i={...(0,l.Z)(e?{query:e.split(" ")}:null),...(0,l.Z)(t?{orderBy:[t]}:null)};r.Z.downloads.search(i,(e=>{n(e)}))}))}_setSearchFilter(e){if(e===i.Z.getFilter())return Promise.resolve();const t=i.Z.getOrderBy();return this._searchDownloads({filter:e,orderBy:t}).then((t=>{s.Z.dispatch({actionType:"DOWNLOAD_SET_FILTER",downloadItems:t,filter:e})}))}_setOrderBy(e){if(e===i.Z.getOrderBy())return Promise.resolve();const t=i.Z.getFilter();return this._searchDownloads({filter:t,orderBy:e}).then((t=>{s.Z.dispatch({actionType:"DOWNLOAD_SET_ORDER_BY",downloadItems:t,orderBy:e})}))}_validateDownload=e=>{r.Z.downloads.acceptMixed(e)};forceUpdate=()=>{const e=i.Z.getFilter(),t=i.Z.getOrderBy();this._searchDownloads({filter:e,orderBy:t}).then((e=>{s.Z.dispatch({actionType:"DOWNLOAD_SET_ORDER_BY",downloadItems:e,orderBy:t})}))};startResolvingReady=()=>{let e,t,n;return Promise.race([function(){let t=0;return new Promise((n=>{!function i(){d.Z.utilities.isDownloadManagerReady((e=>{e&&n()})),t++,e=setTimeout(i,1e3*t)}()}))}(),new Promise((e=>{n=()=>{e()},d.Z.utilities.onDownloadManagerReady.addListener(n)})),new Promise((e=>{t=setTimeout(e,2e4)}))]).then((()=>{clearTimeout(e),clearTimeout(t),d.Z.utilities.onDownloadManagerReady.removeListener(n),this._resolveReady()}))};addOpenAfterDownload=e=>{this._openAfterDownload.add(e)};setSearchFilter=e=>this.ready.then((()=>this._setSearchFilter(e)));setOrderBy=e=>this.ready.then((()=>this._setOrderBy(e)));showDownload=e=>{this.ready.then((()=>{this._showDownload(e)}))};eraseDownload=e=>{this.ready.then((()=>{this._eraseDownload(e)}))};openDownload=e=>{this.ready.then((()=>{this._openDownload(e)}))};pauseDownload=e=>{this.ready.then((()=>{this._pauseDownload(e)}))};resumeDownload=e=>{this.ready.then((()=>{this._resumeDownload(e)}))};restartDownload=e=>this.ready.then((()=>this._restartDownload(e)));validateMixedDownload=e=>{this.ready.then((()=>{this._validateDownload(e)}))};load=()=>{r.Z.downloads.setShelfEnabled(!1),r.Z.downloads.onChanged.addListener(this._onTransferChanged),r.Z.downloads.onCreated.addListener(this._onTransferCreated),r.Z.downloads.onErased.addListener(this._onTransferErased),this.startResolvingReady(),this.ready.then(this._startPolling)}}},87210:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var i=n(16875),s=n(63353),o=n(29087),a=n(84990),r=n(83526),l=n(92292),d=n(89175);const c=new class{setFastForwardUrl(e,t,n){a.Z.dispatch({actionType:"FAST_FORWARD_SET_FORWARD_URL",pageId:e,forwardUrl:t})}_updateRewindInfo(e,t,n){a.Z.dispatch({actionType:"FAST_FORWARD_SET_REWIND_INFO",pageId:e,history:n,currentIndex:t})}setRewindInfo(e,t){e.getPageHistory(((e,n)=>{l.Z.runtime.lastError||c._updateRewindInfo(t,e,n)}))}copyFastForwardState(e,t){a.Z.dispatch({actionType:"FAST_FORWARD_COPY_STATE",pageId:e,fastForwardState:t})}navigateRewind(e){const t=s.Z.getActivePage(e);if(t){const n=i.Z.getRewindRelativeIndex(t.id);r.Z.go(e,t.id,-1*n)}}navigateFastforward(e){const t=s.Z.getActivePage(e);t&&l.Z.tabs.sendMessage(t.id,{navigateFastforward:!0})}isFFWEnabled(){return o.Z.get(d.kKeyboardShortcutsSpaceFastForwards)}sendMessage(e,t,n={}){l.Z.tabs.sendMessage(e,{...n,action:t,pageId:e})}onIsFFWEnabled(e){this.isFFWEnabled()&&c.sendMessage(e,"ffwGoForward")}initTab(e){const t=this.isFFWEnabled();c.sendMessage(e,"fastForwardInit",{enabled:t})}initFastForward(){l.Z.runtime.onMessage.addListener(((e,t)=>{if(!function(e){return l.Z.runtime.id===e.id&&0===e.frameId}(t)||!e)return;if("string"!=typeof e.action||"number"!=typeof e.pageId)return;const{action:n,pageId:i}=e;"fastforwardUrlChanged"===n&&"string"==typeof e.nextUrl?c.setFastForwardUrl(i,e.nextUrl,t.url):"canFFWGoForward"===n&&c.onIsFFWEnabled(i)}))}},h=c},68884:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(1407);const s={};let o=0;const a={fetchRawOfMessage:function(e,t,n){return r("fetchRawOfMessage",[...arguments])},connectIMAPClient:function(e){return r("connectIMAPClient",[...arguments])},connectIMAPClients:function(){return r("connectIMAPClients",[...arguments])},disconnectIMAPClient:function(e){return r("disconnectIMAPClient",[...arguments])},reconnectIMAPClient:function(e){return r("reconnectIMAPClient",[...arguments])},reconnectIMAPClients:function(){return r("reconnectIMAPClients",[...arguments])},disconnectIMAPClients:function(){return r("disconnectIMAPClients",[...arguments])},checkNewDeletedModified:function(e,t){return r("checkNewDeletedModified",[...arguments])},rescanUnreadFlags:function(e,t){return r("rescanUnreadFlags",[...arguments])},checkForMail:function(e){return r("checkForMail",[...arguments])},setCheckInterval:function(e,t){return r("setCheckInterval",[...arguments])},preFetch:function(e){return r("preFetch",[...arguments])},subscribeMailbox:function(e,t){return r("subscribeMailbox",[...arguments])},unsubscribeMailbox:function(e,t,n){return r("unsubscribeMailbox",[...arguments])},createMailbox:function(e,t){return r("createMailbox",[...arguments])},deleteMailbox:function(e,t){return r("deleteMailbox",[...arguments])},moveMessagesBetweenAccounts:function(e,t,n,i,s){return r("moveMessagesBetweenAccounts",[...arguments])}};function r(e,t){return new Promise(((n,i)=>{const a=o++;s[a]={resolve:n,reject:i};const r={promiseId:a,func:e,args:t};navigator.serviceWorker?.ready.then((e=>e.active?.postMessage({imap:r})))}))}navigator.serviceWorker?.addEventListener("message",(function(e){if(e.origin!==i.oP)return;const{imap:t}=e.data;if(t){const{promiseId:e,results:n,error:i}=t,{resolve:o,reject:a}=s[e];delete s[e],i?a(i):o(n)}}),!1)},22616:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(84990);class s{static setImportProgress(e,t,n,s,o){i.Z.dispatch({actionType:"IMPORT_PROGRESS",importType:e,importItemType:t,current:n,total:s,key:o})}static addImportWarning(e,t,n){i.Z.dispatch({actionType:"IMPORT_PROGRESS_WARN",importType:e,importItemType:t,message:n})}static addImportError(e,t,n){i.Z.dispatch({actionType:"IMPORT_PROGRESS_ERROR",importType:e,importItemType:t,message:n})}static clearImportProgress(e,t){i.Z.dispatch({actionType:"IMPORT_PROGRESS_CLEAR",importType:e,importItemType:t})}}},9185:(e,t,n)=>{"use strict";n.d(t,{Z:()=>J});var i=n(42315),s=n(91834),o=n(29087),a=n(15489),r=n(56371),l=n(92292),d=n(54773),c=n(25051),h=n(89175),p=n(78614),u=n(8684),g=n(44850);var m=n(61472),v=n(95752),f=n(45660),y=n(95412),w=n(39045),b=n(8429),C=n(21754),S=n(82227),T=n(68884),I=n(98611),k=n(36943),A=n(54162),Z=n(60331),E=n(84990),_=n(78347),N=n(95095),M=n(48868),P=n(71320),D=n(51501),x=n(45709),O=n(28918),L=n(68906);const R=async function(e,t){const{id:n}=e;return await M.Z.searchList.update(n,{unseen:t}),[{id:n,updates:{unseen:t}}]};var B=n(5204),F=n(95538),U=n(34198),V=n(81830),W=n(18787),H=n(5863),z=n(1407),G=n(65741),$=n(90808),K=n(7064);function j(e,t,n){const i=D.Z.parseQuery(t),s=Date.now();return Z.Z.setStatus(e,(0,r.Z)("Searching for $1...",[i])),f.Z.log("Mail",["search"],`query:${t}, refined:${i}`),async function(e){return new Promise((t=>{try{K.Z.mailPrivate.searchMessages(e,t)}catch(t){console.error(`Search failed for query: ${e}`,t)}}))}(i).then((t=>{if(n()){const e=`Discarding results for outdated query: ${i}`;throw f.Z.log("Mail",["search"],`${e}`),new Error(e)}{const n=Date.now()-s;return Z.Z.setStatus(e,(0,r.Z)("Search for $2 returned $1 result in $3ms.","Search for $2 returned $1 results in $3ms.",[t.length,i,n])),f.Z.log("Mail",["search"],`search for ${i} returned ${t.length} results in ${n}ms`),t}}))}var Y=n(92868);const X=new class{constructor(){P.Z.addListener((e=>{"updateFilters"===e.target&&X.updateFilters(e.filterIds)}))}updateThreadKeys(e){E.Z.dispatch({actionType:"MAIL_UPDATE_THREAD_KEYS",updates:e})}markSeenDebounced=(0,$.Z)((async e=>{const t=await R(e,!1);await L.Z.call({priority:H.Un.HIGH,type:"RE_RUN_SLES",searchListIds:[e.id]}),X.updateIndex({sleUpdates:t}),B.Z.filter()}),1e3);setDisconnected(e,t,n){n&&f.Z.error("Mail",[e],n),E.Z.dispatch({actionType:"MAIL_IS_DISCONNECTED",accountId:e,isDisconnected:t,errorMessage:n})}setConnecting(e,t){E.Z.dispatch({actionType:"MAIL_IS_CONNECTING",accountId:e,isConnecting:t})}markAllReadCmd(){const e=A.Z.getSelectedFolder();let t;if(e){const{accountId:n,path:i}=e;t=I.C.getByFolderId([n,i])}const n=I.C.getListEntries().filter((e=>!v.Z.call(e.sources,t)));X.markAllListEntriesRead(n)}markAllRead(e,t){const n=I.C.getListEntriesByFolder(e,t),i=I.C.getByFolderId([e,t]);if(!i)throw new Error("Filter not found");const s=n.filter((e=>!v.Z.call(e.sources,i)));X.markAllListEntriesRead(s)}async deleteEntriesFromFolderCmd(e){const t=I.C.getListEntries();await b.Z.prepareDelete(e,!0,t)}async deleteEntriesFromFolder(e,t,n){const i=I.C.getListEntriesByFolder(t,n);await b.Z.prepareDelete(e,!0,i)}moveAllToTrash(e,t,n,i){const s=I.C.getListEntriesByFolder(t,n);b.Z.prepareDelete(e,!1,s,i)}markAllListEntriesRead(e){const t=x.ZP.setRead(e,!0);X.updateIndex({sleUpdates:t})}async removeAccount(e,t,n){await M.Z.transaction("rw",[M.Z.buffer,M.Z.accounts],(async()=>{await(0,O.Z)({accountId:e,path:"",operation:"BUFFER_OPERATION_REMOVE_ACCOUNT",deleteFiles:t}),await M.Z.accounts.delete(e)})),n===H.s9.IMAP&&await T.Z.disconnectIMAPClient(e),await _.Z.removeAccount(e),B.Z.removeFolders(e),C.Z.flushBuffer(),i.Z.clearAccessAndRefreshTokens(e)}async removeAccountPath(e,t,n){await M.Z.transaction("rw",[M.Z.buffer,M.Z.accounts],(async()=>{await(0,O.Z)({accountId:e,path:t,operation:"BUFFER_OPERATION_REMOVE_ACCOUNT_PATH",deleteFiles:!0}),n===H.s9.IMAP&&await M.Z.accounts.where("accountId").equals(e).modify((e=>{delete e.folders[t]}))})),C.Z.flushBuffer()}setSearchOptions(e){E.Z.dispatch({actionType:"MAIL_SEARCH_SET_OPTIONS",options:e})}async addLabelsFilter(e){const t={name:e,accountId:H.ut,path:e,filterValue:{include:[[{flag:e}]],...D.Z.getSearchListButtons(H.ut)}},n=await S.Z.add(t,H.Un.NORMAL);await P.Z.updateFilters(n)}async addFilter(e,t=!0,n){const{query:i}=e.filterValue;let s;i&&!n&&(n=await(0,V.Z)(i),s=!0);const o=await M.Z.transaction("rw",[M.Z.filters,M.Z.filteringQueue],(async()=>t?await S.Z.add(e,H.Un.LOW,n,s):await S.Z.add(e)));await P.Z.updateFilters(o),t&&B.Z.filter()}async putFilter(e,t){const n=function(e,t){if(e.filterValue.query!==t.filterValue.query)return!0;const{filterValue:n}=e,{filterValue:i}=t;return!(0,G.default)(n.include,i.include)||!(0,G.default)(n.exclude||[],i.exclude||[])||!(0,G.default)(e.triggers||[],t.triggers||[])}(e,t),i=await M.Z.transaction("rw",[M.Z.filters,M.Z.filteringQueue],(async()=>{const t=await S.Z.put(e);return n&&L.Z.call({type:"RUN_FILTERS",priority:H.Un.LOW,filterIds:[e.id],triggerFilterIdCandidates:[e.id]}),t}));await P.Z.updateFilters(i),n&&B.Z.filter()}async runSystemTasks(e){await(0,Y.y)(e)}async runSystemTask(e,t){await(0,Y.U)(e,t)}async removeFilter(e){await S.Z.remove([e]),P.Z.updateFilters([e]),B.Z.filter()}async rerunFilter(e,t){await L.Z.call({type:"RUN_FILTERS",priority:H.Un.LOW,folderIds:[[e,t]]}),B.Z.filter()}async runStoredQueryFilters(e){const t=I.C.getByAccountId(H.Kz);if(0===t.length)return;const n=t.map((e=>[e.accountId,e.path]));await L.Z.call({type:"FILTERS_SLES",priority:H.Un.NORMAL,folderIds:n,searchListIds:e}),B.Z.filter()}async updateFilters(e){E.Z.dispatch({actionType:"MAIL_FILTERS_CHANGED",filterIds:e});const t=[];e.forEach((e=>D.Z.getAllViewTypes().forEach((n=>t.push(e*H.XN+n))))),X.updateCounters(t)}async toggleMoveToOther(e){const t=e.path;let n,i,s="";t.startsWith(H.cs)?(n=H.W4,s=H.cs,i=t.substr(H.cs.length+1)):(n=H.cs,s=H.W4,i=t.substr(H.W4.length+1));const o=await S.Z.move(e.accountId,s,n,i);await P.Z.updateFilters(o),X.selectFolder({...e,path:[n,i].join("/"),id:H.jT+"_"+[n,i].join("/")},A.Z.getOptions()),B.Z.filter()}async removeMailingListFilter(e,t){const n=t.filterValue.include,i=n&&n[0],s=i&&i[0];if(s?.listId){const e=s.listId,n={listId:e,name:e,parentFolderType:"matches",subFolderType:"none",isIgnored:!0};await B.Z.updateMailingListGroup(n),await S.Z.remove([t.id]),await P.Z.updateFilters([t.id]),E.Z.dispatch({actionType:"MAILING_LIST_GROUP_CHANGED",mailingListGroup:n}),B.Z.filter()}else s?.senderIsMailingList&&await X.toggleSenderAsMailingList(e,s.senderIsMailingList)}async toggleSenderAsMailingList(e,t){const n=H.wC,i=[H.W4,H.cs],s=[{senderIsMailingList:t}],o=i.map((e=>I.C.getByFolder(n,[e,t].join("/")))).find((e=>void 0!==e));if(o)await S.Z.remove([o.id]),await P.Z.updateFilters([o.id]);else{const i={name:t,accountId:n,path:`${H.W4}/${t}`,filterValue:{include:[s],exclude:[[{flag:H.T4.DELETED}]],...D.Z.getSearchListButtons(H.wC)}},o=await j(e,`from:${t}`,(()=>!1)),a=await S.Z.add(i,H.Un.LOW,o);await P.Z.updateFilters(a)}B.Z.filter()}updateQueryResults(e,t,n,i){if(t.length>0){if(X.changeQuery(t),t.length>2){const s=A.Z.getOptions().allMessages||!1;j(e,t,(function(){return t!==A.Z.getQuery()})).then((e=>{E.Z.dispatch({actionType:"MAIL_UPDATE_QUERY_RESULTS",queryResults:e,queryAllMessages:s,threadPrefix:i,folder:n})})).catch((()=>{}))}}else Z.Z.clearStatus(e),X.clearQuery()}changeQuery(e){E.Z.dispatch({actionType:"MAIL_QUERY_CHANGE",query:e})}clearQuery(){E.Z.dispatch({actionType:"MAIL_CLEAR_QUERY"})}async regenerateUncategorizedMailingLists(){const e=I.C.getByAccountId(H.wC),t=U.Z.mailingListGroupToFilters(e),n=F.Z.getGroups(),i=t.filter((e=>!n.some((t=>t.listId===e.path.split("/")[1]))));await X.regenerateMailingLists(i,!0)}async regenerateAllMailingLists(){const e=I.C.getByAccountId(H.wC),t=U.Z.mailingListGroupToFilters(e);await X.regenerateMailingLists(t,!0)}async regenerateExistingMailingListGroup(e,t){const n=I.C.getByAccountId(H.wC),i=U.Z.mailingListGroupToFilters(n,t);if(F.Z.get(H.ZW)?.isIgnored)await X.regenerateMailingLists(i,!0);else{const e=U.Z.mailingListGroupToFilters(n,t),s=[...new Set([...i,...e])];await X.regenerateMailingLists(s,!1)}}async regenerateMailingListGroup(e,t=!1){const n=I.C.getByAccountId(H.wC),i=U.Z.mailingListGroupToFilters(n,e);await X.regenerateMailingLists(i,t)}async regenerateMailingLists(e,t=!1){let n;if(!t){const t=e.map((e=>D.Z.getTotalViewIdByFilterId(e.id)));n=I.C.getListEntryIdsByViewIds(t)}await S.Z.remove(e.map((({id:e})=>e)));const i=new Set;for(const t of e)i.add(t.id);await P.Z.updateFilters([...i]),await L.Z.call({priority:H.Un.LOW,type:"RE_RUN_SLES",searchListIds:n,runMailingLists:!0}),B.Z.filter()}async refreshMailingList(){await L.Z.call({priority:H.Un.LOW,type:"RE_RUN_SLES",runMailingLists:!0}),B.Z.filter()}async removeMailingListGroup(e){await B.Z.removeMailingListGroup(e),await X.regenerateMailingListGroup(e),E.Z.dispatch({actionType:"MAILING_LIST_GROUP_CHANGED",mailingListGroup:e})}async removeIgnoredMailingList(e){await B.Z.removeMailingListGroup(e),await X.refreshMailingList(),E.Z.dispatch({actionType:"MAILING_LIST_GROUP_CHANGED",mailingListGroup:e})}async initializeMailAccounts(){const e=await w.Z.getAccountsAndFolders();await _.Z.initAccounts(e.accounts),await m.Z.initFolders(e.folders)}async initializeMailFiltersStore(){await X.initMailingLists(),await X.initFilters(),await X.initIndex()}async initIndex(){const e=await M.Z.searchList.count();let t=1e3,n=-1;await async function i(){const s=Date.now(),[o,a]=await Promise.all([M.Z.searchList.where("id").above(n).limit(t).toArray(),M.Z.viewIds.where("searchListId").above(n).limit(t).toArray()]);if(E.Z.dispatch({actionType:"MAIL_INIT_INDEX_BATCH",sleBatch:o,viewIdsBatch:a,total:e}),o.length===t){const{id:e}=o[t-1];n=e;const a=Date.now();t=N.Z.adjustBatchSize(1e3,1e5,50,t,a-s),await i()}}(),E.Z.dispatch({actionType:"MAIL_INIT_INDEX_FINISHED"})}lastNotificationSentDates=new Map;updateIndex(e){E.Z.dispatch({actionType:"MAIL_INDEX_UPDATE",updates:e});const{sleUpdates:t=[]}=e,n=A.Z.getQuery(),i=X.getViewIntersections();let s=!1;const v=new Set(o.Z.get(h.kMailAccounts).filter((e=>e.offline)).map((e=>e.MAIL_EMAIL))),f=new Map,w=new Map,b=[],C=[];function S(e,t){let n;switch(t.type){case"ADD_LABEL":n=f.get(t.label),n?n.push(e):f.set(t.label,[e]);break;case"REMOVE_LABEL":n=w.get(t.label),n?n.push(e):w.set(t.label,[e]);break;case"MARK_READ":b.push(e);break;case"SET_FLAG":const i=(0,y.KR)(t.flag);for(const t in i)i[t]?(n=f.get(t),n?n.push(e):f.set(t,[e])):(n=w.get(t),n?n.push(e):w.set(t,[e]));break;case"MARK_AS_SPAM":C.push(e)}}t.forEach((e=>{const t=I.C.getListEntry(e.id),{addedViewIds:f,runTriggerFilterIds:y}=e.updates;if(t){if(n){const{updates:n}=e;i&&(s=I.C.matchesViewIntersection(t.viewIds,i,t.totalViewIds)||Array.isArray(n.viewIds)&&I.C.matchesViewIntersection(n.viewIds,i))}if(o.Z.get(h.kMailNotifications)){const e=f?.some((e=>{if(e%H.XN!=0)return!1;const n=e/H.XN,i=P.Z.get(n);if(!i)return!1;const{accountId:s,path:o}=i;if(v.has(s))return!1;if(!(m.Z.getFolderType(s,o)===H.e9))return!1;const a=X.lastNotificationSentDates.get(s)||0;return t.sentDate>a&&(X.lastNotificationSentDates.set(s,t.sentDate),!0)}));e&&function(e){const t=(0,p.Rz)(d.Z.get(e.fromIds)),n=(0,p.Rz)(d.Z.get(e.toIds));(0,u.c)({title:e.subject,body:(0,r.Z)("New mail from $1 to $2",[t,n]),icon:"resources/mail_notification_icon.png",silent:!o.Z.get(h.kMailNotificationsSoundOn),onClick:()=>{const t=`message/${e.id}`,n=g.jk.internalUrl("mailpage",t,(0,r.Z)("Mail"));c.QJ.openURL(a.ZP.getId(),n);const i=a.ZP.getMailWindowId();l.Z.windows.update(i,{drawAttention:!0})}})}(t)}if(f)for(const e of f){if(e%H.XN!=0)continue;const n=e/H.XN,i=P.Z.get(n);if(!i)throw new Error("Filter not found "+n);if(i.triggers)for(const e of i.triggers)S(t,e)}y&&y.forEach((e=>{const n=P.Z.get(e);if(!n)throw new Error("Filter not found "+e);if(n.triggers)for(const e of n.triggers)S(t,e)}))}else console.warn("ListEntry not found "+JSON.stringify(e))})),s&&X.updateQueryResults(z.A4,n),f.forEach(((e,t)=>{x.ZP.setCustomFlags(e,{[t]:!0})})),w.forEach(((e,t)=>{x.ZP.setCustomFlags(e,{[t]:!1})})),b.length>0&&x.ZP.setRead(b,!0),C.length>0&&k.Z.markAsJunk(C)}async initMailingLists(){await F.Z.initMailingLists(),E.Z.dispatch({actionType:"MAILING_LIST_GROUPS_INIT"})}async updateMailingListGroupName(e){await B.Z.updateMailingListGroup(e),await S.Z.updateName([[H.wC,H.W4+"/"+e.listId],[H.wC,H.cs+"/"+e.listId]],e.name),E.Z.dispatch({actionType:"MAILING_LIST_GROUP_CHANGED",mailingListGroup:e})}async updateMailingListGroup(e){const t=F.Z.get(e.listId);if(await B.Z.updateMailingListGroup(e),"uncategorized"===e.parentFolderType)await X.regenerateUncategorizedMailingLists();else if(t?.isIgnored&&!e.isIgnored)await X.refreshMailingList();else if(t)await X.regenerateExistingMailingListGroup(t,e);else{const t=!0;await X.regenerateMailingListGroup(e,t)}E.Z.dispatch({actionType:"MAILING_LIST_GROUP_CHANGED",mailingListGroup:e})}async initFilters(){await P.Z.initFilters(),E.Z.dispatch({actionType:"MAIL_FILTERS_INIT"})}async start(e){try{Z.Z.setPersistentStatus(e,"MAIL_DB_OPEN",(0,r.Z)("Opening mail DB - This may take time if upgrades are due...")),await M.Z.open()}finally{Z.Z.clearPersistentStatus(e,"MAIL_DB_OPEN")}await X.initializeMailAccounts(),await X.initializeMailFiltersStore()}stop(){E.Z.dispatch({actionType:"MAIL_STOP"}),P.Z.clear(),W.Z.clear(),d.Z.clear(),m.Z.clear(),_.Z.clear()}setAccountIndicator(e,t,n=0,i=0,s=0){E.Z.dispatch({actionType:"MAIL_INDICATOR_ADD_ACCOUNT",accountId:e,indicatorType:t,priority:n,current:i,total:s})}setPathIndicator(e,t,n,i,s,o){E.Z.dispatch({actionType:"MAIL_INDICATOR_ADD_PATH",accountId:e,path:t,indicatorType:n,priority:i,current:s,total:o})}removeAccountIndicator(e,t){E.Z.dispatch({actionType:"MAIL_INDICATOR_REMOVE_ACCOUNT",accountId:e,indicatorType:t})}removePathIndicator(e,t,n){E.Z.dispatch({actionType:"MAIL_INDICATOR_REMOVE_PATH",accountId:e,path:t,indicatorType:n})}removeAllIndicators(e){E.Z.dispatch({actionType:"MAIL_INDICATOR_REMOVE_ALL",accountId:e})}updateCounters(e){const t=Date.now(),n=I.C.getCounterFolders(e);0!==n.length&&(I.C.getIndex().forEach((e=>{const{viewIds:t,totalViewIds:i}=e;s.Z.updateCounterFolders(t,i,1,n)})),E.Z.dispatch({actionType:"MAIL_UPDATE_COUNTERS",countedFolders:n,deltaValues:!1}),f.Z.log("Mail",["counters"],`updateCounters took ${Date.now()-t}ms.`))}pageForward(e){if(A.Z.canGoForward()){const t=A.Z.getHistoryIndex();X.selectFolderFromHistory(e,t+1)}}pageBack(e){if(A.Z.canGoBack()){const t=A.Z.getHistoryIndex();X.selectFolderFromHistory(e,t-1)}}selectFolderFromHistory(e,t){const n=A.Z.getOptionsFromHistory(t),i=A.Z.getFolderFromHistory(t);E.Z.dispatch({actionType:"MAIL_FOLDER_SELECT_HISTORY_INDEX",historyIndex:t}),n.threadPrefix&&Q(n.threadPrefix,n.query),n.query&&X.updateQueryResults(e,n.query,i,n.threadPrefix),n.query||n.threadPrefix||q()}selectFolder(e,t={}){E.Z.dispatch({actionType:"MAIL_SELECT_FOLDER",folder:e,options:t}),t.threadPrefix?Q(t.threadPrefix):q()}selectFolderOnSubscriptionChange(e,t){const n={...e,subscribed:t},i=(e&&P.Z.getByFolderId([n.accountId,n.path]))?.filterValue.query||"";X.selectFolder(n,{query:i})}getImapFolderInfo(e){let t=e.accountId,n=e.path;if(e.accountId===H.Ry){const i=e.path.indexOf("/");t=e.path.slice(0,i),n=e.path.slice(i+1)}return{imapAccountId:t,imapPath:n}}async subscribeMailbox(e,t){const{imapAccountId:n,imapPath:i}=X.getImapFolderInfo(t);X.selectFolderOnSubscriptionChange(t,!0);try{await T.Z.subscribeMailbox(n,i)}catch(n){X.selectFolderOnSubscriptionChange(t,!1),Z.Z.setStatus(e,(0,r.Z)("Failed to subscribe to mailbox: $1",[n])),console.error(n)}}async unsubscribeMailbox(e,t,n){const{imapAccountId:i,imapPath:s}=X.getImapFolderInfo(t);try{X.selectFolderOnSubscriptionChange(t,!1);try{await T.Z.unsubscribeMailbox(i,s,n)}catch(e){throw X.selectFolderOnSubscriptionChange(t,!0),e}n&&X.removeAccountPath(i,s,H.s9.IMAP)}catch(t){Z.Z.setStatus(e,(0,r.Z)("Failed to unsubscribe from mailbox: $1",[t])),console.error(t)}}selectThread(e){const t=[e.threadKey[0],e.threadKey[1]],n={accountId:H.tQ,path:String(t),id:String(t),name:e.subject},i={threadPrefix:t};X.selectFolder(n,i)}selectContact(e,t){const n={accountId:H.of,path:H.ym,id:t,name:t},i=D.Z.getContactQuery(t,new Set(["to","from"])),s={forSender:t,query:i};E.Z.dispatch({actionType:"MAIL_SELECT_FOLDER",folder:n,options:s});X.updateQueryResults(e,i,n,undefined)}sortListEntries(e,t=!1){E.Z.dispatch({actionType:"MAIL_SORT_LIST_ENTRIES",wasThreads:t});const n=A.Z.getQuery();n&&X.updateQueryResults(e,n)}getViewIntersections(e){if(e||(e=A.Z.getSelectedFolder()),!e)return;const{accountId:t,path:n=H.ym}=e,i=I.C.getByFolder(t,n);return i?D.Z.getViewIntersections(i):void 0}undo(){const e=W.Z.pop();if(!e)return;const{updates:t,updateItems:n,operation:i,sourcesPerSle:s}=e;if(0!==n.length&&"setFlags"===i){const e=x.ZP.setCustomFlags(n,t,s,!1);X.updateIndex({sleUpdates:e})}}};function Q(e,t){E.Z.dispatch({actionType:"MAIL_SELECT_THREAD",threadPrefix:e,query:t})}function q(e){E.Z.dispatch({actionType:"MAIL_INIT_MESSAGES",folderIntersections:X.getViewIntersections(e)})}const J=X},2431:(e,t,n)=>{"use strict";n.d(t,{J:()=>Z,Z:()=>R});var i=n(72010),s=n(13933),o=n(98611),a=n(54162),r=n(53576),l=n(63353),d=n(29087),c=n(15489),h=n(56371),p=n(88951),u=n(50399),g=n(97823),m=n(55346),v=n(93818),f=n(30381),y=n.n(f),w=n(51370),b=n(5863),C=n(44850),S=n(22288),T=n(78614),I=n(89175),k=n(97781);async function A(e,t,n){const{inReplyTo:i,references:o}=_(e),{bodyParts:a=[]}=e,{cidAttachments:r}=O(a),l=x(a),d=function(e,t,n){let i=D(e,t);i=(0,S.$P)(n,i);const s=y()(e.sentDate).format("LLLL (Z)"),o=e.from,a=n?"\n\n":"<br><br>",r=o.length>0?o[0].name||o[0].address:"unknown",l=(0,h.Z)("On $1, $2 wrote:",[s,r])+a;return i?n?a+l+"> "+i.replace(/\r?\n/g,"\n> "):`${a}${l}<blockquote style="margin: 0 0 0.80ex; border-left: #0000FF 2px solid; padding-left: 1ex">${i}</blockquote>`:l}(e,r,l),{selectedAccount:c,from:p,messageId:u}=L(e),g=Date.now(),m={selectedAccount:c,messageId:u,from:[...p],subject:P(e,"Re: "),sentDate:g,threadKey:[g,e.id,g],attachments:[],to:t,cc:n,bcc:[],plaintext:l,cidAttachments:r,body:d,inReplyTo:i,references:o,focusOnBody:!0,replied:e.id};s.Z.set(m),await N()}function Z(e){const{from:t,messageId:n,selectedAccount:i}=L(void 0,"account");return{bcc:[],body:"",cc:[],subject:"",to:[],...(0,w.Z)(e),attachments:[],from:t,messageId:n,plaintext:!0,selectedAccount:i,sentDate:Date.now()}}function E(e,t){const{bodyParts:n=[]}=e,i=x(n),{attachments:s,cidAttachments:o}=O(n),a=D(e,o),{inReplyTo:r,references:l,messageId:d,to:c,cc:h,bcc:p,subject:u,sentDate:g}=e,{selectedAccount:m,from:v}=L(e,"message");return{plaintext:i,attachments:s,cidAttachments:o,body:a,inReplyTo:r,references:l,messageId:d,to:c,cc:h,bcc:p||[],subject:u,sentDate:g,selectedAccount:m,from:[...v],threadKey:t}}function _(e){const{messageId:t,inReplyTo:n,references:i}=e,s={inReplyTo:t,references:i?i.slice():[]};return 0===s.references.length&&n&&s.references.push(n),t&&s.references.push(t),s}async function N(e){const t=c.ZP.getId(),n=M(e);await r.Z.openURL(t,n,{singleton:Boolean(e)})}function M(e){return C.jk.internalUrl("mailpage","composer/draft",(0,h.Z)("Mail - Draft"),e?JSON.stringify({id:e}):void 0)}function P(e,t=""){if(!e)return"";const n=e.subject||"";return 0===n.indexOf(t)?n:t+n}function D(e,t){const n=(0,u.Z)(!0,e.bodyParts);return n&&n.content?"html"===n.type?function(){const s={};t.forEach((e=>{e.id&&(s["cid:"+e.id]=e)}));const o=(r=e.from,r&&r.length>0&&i.Z.isTrustedEmailAddress(r[0].address)),a=(0,k.Nw)(n.content,{attachments:s,blockHTTPLeaks:!e.trusted&&!o});var r;return a.sanitized}():n.content:""}function x(e){const t=(0,u.Z)(!0,e);return!t||"html"!==t.type}function O(e){const t=[],n=[];return(0,S.yN)(e).forEach((e=>{if(e.inUse)n.push(e);else{const{id:n,inUse:i,...s}=e;t.push(s)}})),{attachments:t,cidAttachments:n}}function L(e,t){const n=d.Z.get(I.kMailDefaultAccount)||b.Y6,i=d.Z.get(I.kMailLastSentFrom),s=g.Z.getAccountsAndAliases();let r,l,c;if(s.length>0){if("account"===t){const e=a.Z.getSelectedFolder();if(e?.accountId&&(r=s.find((t=>t.MAIL_EMAIL===e.accountId))),!r&&e?.accountId===b.Ry){const t=e?.path.split("/")[0];r=s.find((e=>e.MAIL_EMAIL===t))}}else if(e){const{from:n,to:i}=e,a=n.map((e=>e.address)),l=i.map((e=>e.address));if("message"===t?a.length>0&&(r=s.find((e=>a.includes(e.MAIL_EMAIL)))):l.length>0&&(r=s.find((e=>l.includes(e.MAIL_EMAIL)))),!r){const t=o.C.getSourceFilters(e.id),n=new Set(t.map((e=>e.accountId)));r=s.find((e=>n.has(e.MAIL_EMAIL)))}}!r&&n===b.Y6&&i&&(r=s.find((e=>e.MAIL_EMAIL===i))),r||n===b.Y6||(r=s.find((e=>e.MAIL_EMAIL===n))),r||(r=s[0])}return r?(l=[{name:r.MAIL_NAME,address:r.MAIL_EMAIL}],c=(0,p.Z)(r.MAIL_EMAIL)):(l=[],c=(0,p.Z)()),{selectedAccount:r,from:l,messageId:c}}const R={closeComposer:function(e,t){const n=M(t);r.Z.closeUrl(e,n)},createDraft:async function(e={}){const{selectedAccount:t,from:n,messageId:i}=L(void 0,"account"),{to:o,cc:a,bcc:r,subject:l="",body:d=""}=e;if(!t)return;const c={selectedAccount:t,messageId:i,subject:l,body:d,from:[...n],sentDate:Date.now(),to:o||[],cc:a||[],bcc:r||[],plaintext:!0,attachments:[]};s.Z.set(c),await N()},createDraftFromSent:function(e){const{bodyParts:t=[]}=e,n=x(t),{attachments:i,cidAttachments:o}=O(t),a=D(e,o),{selectedAccount:r,from:l,messageId:d}=L(e,"message"),{to:c,cc:h,bcc:p}=e,u={to:c,cc:h,bcc:p||[],sentDate:Date.now(),subject:P(e),plaintext:n,attachments:i,cidAttachments:o,body:a,focusOnBody:!0,selectedAccount:r,from:[...l],messageId:d};s.Z.set(u),N()},forward:async function(e){const{inReplyTo:t,references:n}=_(e),{bodyParts:i=[]}=e,{attachments:o,cidAttachments:a}=O(i),r=x(i),l=function(e,t,n){const i=D(e,t),s=new Date(parseInt(e.sentDate)),o=(0,T.Rz)(e.from),a=(0,T.Rz)(e.to),r=(0,T.Rz)(e.cc);let l=`\n\n----- ${(0,h.Z)("Forwarded message")} -----\n`;o&&(l+=(0,h.Z)("From: $1",[o])+"\n");a&&(l+=(0,h.Z)("To: $1",[a])+"\n");r&&(l+=(0,h.Z)("Cc: $1",[r])+"\n");e.subject&&(l+=(0,h.Z)("Subject: $1",[e.subject])+"\n");return l+=(0,h.Z)("Date: $1",[s.toString()])+"\n\n\n",(n?l:l.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>"))+i}(e,a,r),{selectedAccount:d,from:c,messageId:p}=L(e),u=Date.now(),g={selectedAccount:d,messageId:p,from:[...c],sentDate:u,threadKey:[u,e.id,u],to:[],cc:[],bcc:[],subject:P(e,"Fwd: "),plaintext:r,attachments:o,cidAttachments:a,body:l,inReplyTo:t,references:n,forwarded:e.id};s.Z.set(g),await N()},open:function(e,t){const n=E(e,t);s.Z.set({...n,fromDraft:!0}),N(e.id)},prepareDraft:async function(e){const[t,n]=await Promise.all([m.Z.call(e),(0,v.Z)(e)]);if(!t||!n)return!1;const i=E(t,n.threadKey);return s.Z.set(i),!0},reply:async function(e){let t;t=a.Z.isSentFolderSelected()?e.to:e.replyTo&&e.replyTo.length>0?e.replyTo:e.from,await A(e,t,[])},replyToAll:async function(e){const t=g.Z.getAccountsAndAliases()||[],{from:n,to:i,replyTo:s,cc:o}=e,a=(0,T.Yn)(...s,...n,...i).filter((e=>t.every((t=>t.MAIL_EMAIL!==e.address)))),r=(0,T.Yn)(...o).filter((e=>t.every((t=>t.MAIL_EMAIL!==e.address))));await A(e,[...a],[...r])},closeMailPages:function(){const e=C.xy.mailpage,t=l.Z.filterPagesInAllWindows((t=>t.url.startsWith(e)));r.Z.closePage(t)}}},46382:(e,t,n)=>{"use strict";n.d(t,{Z:()=>m});var i=n(61757),s=n(53576),o=n(29087),a=n(84990),r=n(62830),l=n.n(r),d=n(7064),c=n(12964),h=n(89175),p=n(44850);let u;const g=new class{openGuestWindow(){d.Z.runtimePrivate.switchToGuestSession((e=>{e||console.warn("Guest mode is disabled.")}))}closeGuestSession(){d.Z.runtimePrivate.closeGuestSession((e=>{e||console.warn("Guest mode is disabled.")}))}managePeople(){return d.Z.runtimePrivate.openProfileSelectionWindow()}closeActiveProfile(){d.Z.runtimePrivate.closeActiveProfile((e=>{e||console.warn("Failed to open profile window.")}))}showAddFeed(e,t){a.Z.dispatch({actionType:"MAIN_SHOW_ADD_FEED",winId:e,options:t})}showAddMailFolder(e,t){a.Z.dispatch({actionType:"MAIN_SHOW_ADD_MAIL_FOLDER",winId:e,options:t})}showDeleteMailFolder(e,t){a.Z.dispatch({actionType:"MAIN_SHOW_DELETE_MAIL_FOLDER",winId:e,options:t})}showQuickCommand(e){a.Z.dispatch({actionType:"MAIN_SHOW_QUICKCOMMANDS",winId:e})}async showCalendar(e,t){try{const n=await s.Z.openURL(e,"vivaldi://calendar",{singleton:!0});t&&i.Z.selectEvent({pageId:n.pageId},{eventId:t})}catch(e){console.error(e)}}showCalendarNotification(e,t){a.Z.dispatch({actionType:"MAIN_SHOW_CALENDAR_ALARM",winId:e,options:t})}showKeyboardShortcuts(e){a.Z.dispatch({actionType:"MAIN_SHOW_KEYBOARDS_SHORTCUTS",winId:e})}showPageAccessKeys(e){a.Z.dispatch({actionType:"MAIN_SHOW_PAGE_ACCESS_KEYS",winId:e})}showConfirmOpenLinksDialog(e,t){a.Z.dispatch({actionType:"MAIN_SHOW_CONFIRM_OPEN_LINKS_DIALOG",winId:e,options:t})}showConfirmCloseOtherTabsDialog(e,t){a.Z.dispatch({actionType:"MAIN_SHOW_CONFIRM_CLOSE_OTHER_TABS_DIALOG",winId:e,options:t})}showClearBrowsingHistoryDialog(e){a.Z.dispatch({actionType:"MAIN_SHOW_CLEAR_BROWSING_HISTORY_DIALOG",winId:e})}showModal(e,t){return new Promise((n=>a.Z.dispatch({actionType:"MAIN_SHOW_MODAL_DIALOG",winId:e,options:{...t,resolve:n}})))}showImportDataDialog(e){a.Z.dispatch({actionType:"MAIN_SHOW_IMPORT_DATA_DIALOG",winId:e})}showBookmarkDialog(e,t){a.Z.dispatch({actionType:"MAIN_SHOW_BOOKMARK_DIALOG",winId:e,options:t})}showBookmarkAddedPopup(e,t){a.Z.dispatch({actionType:"MAIN_SHOW_BOOKMARK_ADDED_POPUP",winId:e,options:t})}async showMail(e){await s.Z.openURL(e,p.jk.internals.mailpage,{singleton:!0})}showMailUnsubscribeDialog(e,t){const n={actionType:"MAIN_SHOW_MAIL_UNSUBSCRIBE_DIALOG",winId:e,options:t};a.Z.dispatch(n)}showMailAuthenticationDialog(e,t){const n={actionType:"MAIN_SHOW_MAIL_AUTHENTICATION_DIALOG",winId:e,options:t};a.Z.dispatch(n)}showMailDeleteDialogSetting(e,t){const n={actionType:"MAIN_SHOW_MAIL_DELETE_DIALOG_SETTING",winId:e,options:t};a.Z.dispatch(n)}showMailDeleteDialogFolders(e,t){const n={actionType:"MAIN_SHOW_MAIL_DELETE_DIALOG_FOLDERS",winId:e,options:t};a.Z.dispatch(n)}showMailDeleteDialogAccounts(e,t){const n={actionType:"MAIN_SHOW_MAIL_DELETE_DIALOG_ACCOUNTS",winId:e,options:t};a.Z.dispatch(n)}showMailDeleteDialogConfirmAll(e,t){const n={actionType:"MAIN_SHOW_MAIL_DELETE_DIALOG_CONFIRM_ALL",winId:e,options:t};a.Z.dispatch(n)}showSaveSessionDialog(e,t){a.Z.dispatch({actionType:"MAIN_SHOW_SAVE_SESSION_DIALOG",winId:e,options:t})}showOpenSessionDialog(e){a.Z.dispatch({actionType:"MAIN_SHOW_OPEN_SESSION_DIALOG",winId:e})}showDialog(e,t,n){const i={actionType:"MAIN_SHOW_DIALOG",winId:e,options:t,onAfterClose:n};a.Z.dispatch(i)}async showExtensions(e){await s.Z.openURL(e,"vivaldi://extensions",{singleton:!0})}async showHistory(e){await s.Z.openURL(e,"vivaldi://history",{singleton:!0})}async showNotes(e){await s.Z.openURL(e,"vivaldi://notes",{singleton:!0})}async showBookmarks(e){await s.Z.openURL(e,"vivaldi://bookmarks",{singleton:!0})}async showWelcome(e){await s.Z.openURL(e,"vivaldi://welcome")}async showSettings(e,t="general",n){const i=(0,c.Z)(n)?"":Object.keys(n).map((e=>`${e}=${n[e]}`)).join("&");o.Z.get(h.kSettingsInTab)?await s.Z.openURL(e,`vivaldi://settings/${t}/?${i}`,{singleton:!0,skipParams:!0}):d.Z.utilities.broadcastMessage({showSettingsWindow:{settingsCategory:`${t}&${i}`}})}showAccountSheet(e,t="login"){const n={actionType:"MAIN_SHOW_ACCOUNT_SHEET",winId:e,options:t};a.Z.dispatch(n)}showAddCustomLabel(e){a.Z.dispatch({actionType:"MAIN_SHOW_CREATE_LABEL",winId:e})}showDeleteCustomLabelConfirmation(e,t,n){a.Z.dispatch({actionType:"MAIN_SHOW_DELETE_LABEL_CONFIRMATION",winId:e,options:{label:t,callback:n}})}showMailAccountDialog(e){const t={actionType:"MAIN_SHOW_MAIL_ACCOUNT_DIALOG",winId:e};a.Z.dispatch(t)}showCalendarAccountDialog(e){const t={actionType:"MAIN_SHOW_CALENDAR_ACCOUNT_DIALOG",winId:e};a.Z.dispatch(t)}showCreateCalendarDialog(e){a.Z.dispatch({actionType:"MAIN_SHOW_CREATE_CALENDAR_DIALOG",winId:e})}showPrivacyStatsDialog(e){a.Z.dispatch({actionType:"MAIN_SHOW_PRIVACY_STATS",winId:e})}openNewPopAsTabOrWindow(e,t,n){if(o.Z.get(h.kPopupsShowInTab))t.window.accept(e+";1");else{const i={identifier:l()(),incognito:n,windowBounds:{left:t.initialLeft,top:t.initialTop,width:t.initialWidth,height:t.initialHeight},ownerWindowId:e,acceptOrBlockCallback:e=>{t.window?t.window.accept(e+";1"):s.Z.openURL(e,t.targetUrl)}};a.Z.dispatch({actionType:"POPUPWINDOW_OPENED",popupWindow:i})}}startCasting(e){d.Z.utilities.startChromecast(e)}setPaneFocus(e,t){a.Z.dispatch({actionType:"MAIN_SELECTING_TOOLBAR",winId:e,options:{enable:t}})}stepFocus(e,t){s.Z.clearSelection(e);const i=function(e,t){return Array.from(document.querySelectorAll(e)).map((e=>{const t=e.getBoundingClientRect(),n=function(e){let t=0,n=0;for(;e instanceof HTMLElement&&(t+=e.offsetTop,n+=e.offsetLeft,e.offsetParent);)e=e.offsetParent;return{left:n,top:t}}(e);return{elm:e,rect:{left:n.left,top:n.top,width:t.width,height:t.height}}})).sort(((e,n)=>t?e.rect.left<n.rect.left?-1:e.rect.left>n.rect.left?1:e.rect.top<n.rect.top?-1:e.rect.top>n.rect.top?1:0:e.rect.top<n.rect.top?-1:e.rect.top>n.rect.top?1:e.rect.left<n.rect.left?-1:e.rect.left>n.rect.left?1:0))},o=function(e,t){const n=t.children;let i=!1;for(let t=0;t<n.length;t++){if(n[t]===e)return!0;if(o(e,n[t])){i=!0;break}}return i},a=i(".pagefocusstop",!0),r=i(".uifocusstop",!1).concat(a);if(r.length>0){let i=-1;const l=document.activeElement;for(let e=0;e<r.length;e++)if(r[e].elm===l||o(l,r[e].elm)){i=e;break}i=-1===i?t?0:r.length-1:t?i+1<r.length?i+1:0:0===i?r.length-1:i-1;if(-1!==a.findIndex((e=>e===r[i]))){const t=parseInt(r[i].elm.getAttribute("data-id"));s.Z.activateTab(t,e),n(47995).Z.executeActions(e,"COMMAND_FOCUS_WEBVIEW"),u=setTimeout((()=>g.setPaneFocus(e,!1)),1e3)}else r[i].elm.focus(),u&&clearTimeout(u);g.setPaneFocus(e,!0)}}},m=g},8074:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(84990);const s=new class{setNavigationState(e,t,n){i.Z.dispatch({actionType:"NAVIGATION_SET_STATE",pageId:e,windowId:t,navigationState:n})}setSSLState(e,t){i.Z.dispatch({actionType:"PAGE_SET_SSL_STATE",pageId:e,info:t})}addBlockedPopupEvent(e,t){i.Z.dispatch({actionType:"NAVIGATION_ADD_POPUP",pageId:e,popupEvent:t})}removeBlockedPopup(e,t){i.Z.dispatch({actionType:"NAVIGATION_REMOVE_POPUP",pageId:e,targetUrl:t})}resetBlockedPopups(e){i.Z.dispatch({actionType:"NAVIGATION_RESET_BLOCKED_POPUPS",pageId:e})}setPermission(e,t,n,s,o){i.Z.dispatch({actionType:"NAVIGATION_SET_PERMISSION",pageId:e,origin:t,permission:n,requestEvent:s,state:o})}resetPermissions(e){i.Z.dispatch({actionType:"NAVIGATION_RESET_PERMISSIONS",pageId:e})}setPageHasBlockedContent(e,t){i.Z.dispatch({actionType:"NAVIGATION_SET_BLOCKED_CONTENT",pageId:e,contentType:t})}resetPageHasBlockedContent(e){i.Z.dispatch({actionType:"NAVIGATION_RESET_BLOCKED_CONTENT",pageId:e})}}},55022:(e,t,n)=>{"use strict";n.d(t,{Z:()=>R});var i=n(30626),s=n(84675),o=n(62882),a=n(53576),r=n(63353),l=n(18350),d=n(15285),c=n(29087),h=n(84990),p=n(15489),u=n(56371),g=n(92292),m=n(7064),v=n(89175),f=n(8684),y=n(44850);const w="NotesCutIds";let b=!0;const C=function(){b=!0},S=function(){b=!1,T()};async function T(){const e=await new Promise((e=>m.Z.notes.getTree(e)));h.Z.dispatch({actionType:"NOTES_INIT",notes:e})}function I(e,t){if(b)return;if(h.Z.dispatch({actionType:"NOTES_ADD_ITEM",id:e,item:t}),p.ZP.getActiveWindowId()===p.Ex)return;const n=p.ZP.getId(),i=r.Z.getActivePage(n);!!i&&y.jk.getDisplayUrl(i.url).startsWith("vivaldi://notes")||(c.Z.get(v.kNotesCreationNotify)&&!d.ZP.getIsVisible(n,"notes")&&(0,f.c)({title:(0,u.Z)("New Note Created"),onClick:()=>l.Z.showContent(n,"notes",{setFocus:!0,selectId:e,reason:""})}),c.Z.get(v.kNotesCreationShowPanel)&&l.Z.showContent(n,"notes"))}const k=function(e,t){b||h.Z.dispatch({actionType:"NOTES_MOVE_ITEM",id:e,targetFolder:t.parentId,targetIndex:t.index})},A=function(e,t){b||h.Z.dispatch({actionType:"NOTES_CHANGE_ITEM",id:e,changes:t})},Z=function(e){b||h.Z.dispatch({actionType:"NOTES_REMOVE_ITEM",id:e})},E={scale:1,width:0,height:0};function _({id:e,url:t,content:n}){if(!n)return Promise.reject();const i=o.ZP.getNodeById(e);if(!i)return Promise.reject();const s={attachments:[...i.attachments||[],{content:n}],...!i.url&&t?{url:t}:null};return new Promise((t=>{m.Z.notes.update(e,s,t)}))}function N(e){"Escape"===e.key&&O([])}function M(e,t){if(e!==w||"string"!=typeof t)return;const n=t.length>0?t.split(","):[];n.length>0?window.addEventListener("keydown",N,!0):window.removeEventListener("keydown",N,!0),h.Z.dispatch({actionType:"NOTES_SET_CUT_IDS",ids:n})}function P({clipboardData:e},t,n){e&&(e.setData("vivaldi/x-cut",n?"true":"false"),e.setData(o.d0,JSON.stringify(t)),e.setData("text/plain",o.ZP.getDragData("text/plain",t)))}function D(e){return new Promise((t=>{m.Z.notes.create(e,t)}))}function x(e){return new Promise(((t,n)=>{const i=new FileReader;i.onloadend=({target:e})=>{t(e.result)},i.onerror=()=>{i.abort(),n()},i.readAsDataURL(e)}))}function O(e){m.Z.utilities.setSharedData({key:w,value:e.length>0?e.join():""})}async function L(e,t){const n=i.Z.getActiveWebView(e);if(!n)return;const s=["richtexteditor","markdowneditor"].includes(n.name)?"":n.src,o=await function(e,t=E){return new Promise(((n,i)=>{e.getThumbnail(t,(e=>{g.Z.runtime.lastError&&i(g.Z.runtime.lastError.message),n(e)}))}))}(n);return _({id:t,url:s,content:o})}const R={loadPromise:async function(){await T(),b=!1,m.Z.notes.onImportBegan.addListener(C),m.Z.notes.onImportEnded.addListener(S),m.Z.notes.onCreated.addListener(I),m.Z.notes.onMoved.addListener(k),m.Z.notes.onChanged.addListener(A),m.Z.notes.onRemoved.addListener(Z),m.Z.utilities.onSharedDataUpdated.addListener(M),m.Z.utilities.getSharedData({key:w,value:""},(e=>{e&&M(w,e)}))},emptyTrash:function(){return new Promise(((e,t)=>{m.Z.notes.emptyTrash((n=>{!1===n&&(console.warn("Empty trash failed."),t("Empty trash failed.")),e()}))}))},addScreenshot:L,addAreaCapture:async function(e,t){const n=i.Z.getActiveWebView(e),o=!n||y.jk.isInternalUrl(n.src),a=!n||o?void 0:n.src,r=await s.Z.captureArea(e,"note");if(r.length>0)return _({id:t,url:a,content:r})},addImageFile:async function(e,t){return _({id:e,content:await x(t)})},createNoteFromCapture:async function(e,t){const n=[{content:t}],i=r.Z.getActivePage(e)?.url??"",s=await D({type:"note",attachments:n,url:i}),o=d.ZP.getPanelAvailable("notes");if(s)if(o){const t={selectId:s.id,setFocus:!0,reason:""};l.Z.showContent(e,"notes",t)}else{const t=y.jk.internalUrl("notes",s.id);a.Z.openURL(e,t,{inCurrent:!1})}},readFileAsDataURL:x,removeAttachment:function(e,t){const n=o.ZP.getNodeById(e);if(!n||!n.attachments)return Promise.resolve();const i=n.attachments.filter((e=>e.checksum!==t.checksum));return new Promise((t=>{m.Z.notes.update(e,{attachments:i},(()=>t()))}))},createNotesFromTreeNodes:function e(t,n="",i,s){return Promise.all(t.map((async(t,a)=>{const r=i?i+a:void 0;if(t.separator)return void D({index:r,parentId:n,type:"separator"});const l=await D({parentId:n,index:r,type:o.ZP.isFolder(t)?"folder":"note",attachments:t.attachments,content:t.content,title:t.title,url:t.url});return t.children?await e(t.children,l.id,0,s):void 0}))).then((()=>{}))},createNote:async function(e,t,n=!0){const{content:i,url:s}=t,o=await D({type:"note",content:i,url:s});return s&&c.Z.get(v.kNotesCreationAddScreenshot)&&n?L(e,o.id):o},cut:function(e,t){P(e,t,!0),O(t),e.stopPropagation(),e.preventDefault()},copy:function(e,t){P(e,t,!1),e.stopPropagation(),e.preventDefault()},setCutIds:O}},5646:(e,t,n)=>{"use strict";n.d(t,{r:()=>A,Z:()=>E});var i=n(29194),s=n(15800),o=n(46382),a=n(96682),r=n(68247),l=n(29087),d=n(84990),c=n(63153),h=n(15489),p=n(92292),u=n(30381),g=n.n(u),m=n(7064),v=n(24522),f=n(89175),y=n(47543),w=n(58821),b=n(8684),C=n(34155);const{createEventNotificationString:S,parseEventNotificationString:T}=s.Z;let I;async function k(e){const t=await new Promise((e=>p.Z.alarms.getAll(e)));await Promise.all(t.map((async t=>{const{notificationId:n,snooze:i}=T(t.name);e!==n||i||await new Promise((e=>p.Z.alarms.clear(t.name,e)))})))}function A(e,t){const{id:n,event_id:s,when:o}=e,a=t||s&&i.Z.getEvent(s);if(!a)return console.warn("Can not create alarms, event not found",e),void m.Z.calendar.deleteNotification(n);if(a.trash)return;const r=l.Z.get(f.kCalendarLastNotificationTime)||Date.now();let d=[];const{recurrence:c}=a;if(e.period)e.when>r&&d.push(e.when);else if(c){const e=s?.split(":")[1],t=new Set((a.recurrenceExceptions??[]).map((e=>e.date))),n=r+o+1e3;d=(0,y.YE)(c.toString(),n,n+7*v.hd,a.timezone).map((e=>e.valueOf()-o)).filter((t=>!e||t===e)).filter((e=>!t.has(e)))}else{const e=(0,w.oJ)(a)-o;e>r&&d.push(e)}d.forEach((t=>{p.Z.alarms.create(S(n,a.id,t,Boolean(e.period)),{when:t})}))}const Z=new class{init(e){const t=t=>async function(e,t){const n=l.Z.get(f.kCalendarNotificationType);if("none"===n)return;try{const s=h.ZP.getLastActiveBrowserWindowId();if(s!==e&&-1!==s)return;const{notificationId:o}=T(t.name);if(!o)return;const{notifications:r}=a.Z.getState(),d=r.find((e=>o===e.id));if(!d)return;const c=i.Z.getEvent(d.event_id||"");if(!c)return;if(l.Z.get(f.kCalendarHiddenHidesNotifications)){if(i.Z.getCalendars().find((e=>e.id===c.calendarId))?.hidden)return}Z.showNotification(d,c,n,e)}catch(t){console.error("alarmHandler: Failed to retrive window id",t)}}(e,t);p.Z.alarms.onAlarm.addListener(t),l.Z.addListener(f.kMailIsTurnedOff,(function(e,n,i){i===f.kMailIsTurnedOff&&(n?p.Z.alarms.onAlarm.removeListener(t):p.Z.alarms.onAlarm.addListener(t))}))}async loadNotifications(){await m.Z.calendar.getAllNotifications((e=>{d.Z.dispatch({actionType:"NOTIFICATIONS_INIT",notifications:e})}))}deleteNotification(e){const{id:t,event_id:n}=e;n&&(m.Z.calendar.deleteNotification(t),k(t))}createNotification(e,t){e.event_id&&(e.event_id=e.event_id.split(":")[0]),m.Z.calendar.createNotification(e,(e=>{e.event_id&&A(e,t)}))}snooze(e,t,n){const{id:i,delay:s,...o}=e;o.when=Date.now()+n*v.lb,o.period=parseInt((0,w.oJ)(t)),this.createNotification(o)}async updateNotification(e,t){let{id:n,event_id:i,...s}=e;i&&(i=i.split(":")[0]);const o=await new Promise((e=>m.Z.calendar.updateNotification(n,s,(t=>e(t)))));o.event_id&&(await k(n),await A(o,t))}async updateAlarmsForEvent(e){return Promise.all((e.notifications??[]).map((t=>this.updateAlarmsForNotification(t,e))))}async updateAlarmsForNotification(e,t){await k(e.id),await A(e,t)}async updateAllAlarms(){const e=await s.Z.getAllNotifications();await Promise.all(e.map((e=>k(e.id)))),await Promise.all(e.map((e=>A(e))))}startAPIChangeListeners(){l.Z.get(f.kMailIsTurnedOff)?console.warn("Calendar is disabled. Not starting Notifications API listeners."):(m.Z.calendar.onNotificationChanged.addListener(Z.loadNotifications),I||(I=setInterval((()=>Z.updateAllAlarms()),30*v.lb)),C.nextTick((()=>Z.updateAllAlarms())))}stopAPIChangeListeners(){m.Z.calendar.onNotificationChanged.removeListener(Z.loadNotifications),I&&(clearInterval(I),I=null)}async showNotification(e,t,n,i){const s=l.Z.get(f.kCalendarNotificationSound);if("system"===n){const n=t.title||e.name||"",s=g()((0,w.oJ)(t)).format("LT");(0,b.c)({title:`${s} - ${n}`,onClick:()=>{o.Z.showCalendar(i,t.id)}})}else{let s;if("dialog"!==n&&l.Z.get(f.kCalendarNotificationFullscreen)){const e=h.ZP.getWindowState(i);e?.state&&"fullscreen"!==e?.state&&(c.Z.setFullscreen(i),s=i,await new Promise((e=>C.nextTick(e))))}const a={notification:e,event:t,fullscreen:"dialog"!==n,windowToRestore:s};o.Z.showCalendarNotification(i,a)}if(s){new Audio(s).play()}r.Z.set(f.kCalendarLastNotificationTime,Date.now()),e.period&&m.Z.calendar.deleteNotification(e.id)}};const E=Z},53576:(e,t,n)=>{"use strict";n.d(t,{Z:()=>Te,y:()=>Q});var i=n(91380),s=n(7065),o=n(46382),a=n(84990);var r=n(8074),l=n(63353),d=n(14481),c=n(29087),h=n(54058),p=n(71860),u=n(83526),g=n(63153),m=n(15489),v=n(34540),f=n(92292),y=n(48764).Buffer;const w=function(e){const t=e.match(/^(data:)(.*?)?(;charset=.*?)?(;base64)?,(.*)$/);if(!t)return e;const n=t[2],i=t[5],s=new y(i,"base64").toString("binary"),o=new Array(s.length);for(let e=0;e<s.length;e++)o[e]=s.charCodeAt(e);const a=new Uint8Array(o),r=new Blob([a],{type:n});return URL.createObjectURL(r)};var b=n(62830),C=n.n(b),S=n(12467),T=n(7064),I=n(1407),k=n(44850),A=n(35369),Z=n(69046),E=n(90808),_=n(42941),N=n(36436),M=n(89175),P=n(14789),D=n(37441);let x=(0,A.D5)(),O=0;const L=(0,E.Z)((e=>{const{toStart:t,windowId:n}=e,i=l.Z.getActivePage(n);if(!i)return;const s=l.Z.getSelectedPages(n);let o;o=l.Z.isSelecting(n)&&s.size>1?s:A.aV.of(i);const a=(0,Z.av)(i),r=l.Z.getTabs(n,!0);if(a){const e=r.flatMap(((e,t)=>(0,Z.av)(e.page)===a?[t]:[])),s=o.filter((e=>(0,Z.av)(e)===a)),l=t?e.get(0):e.get(e.size-1);"number"==typeof l&&Se.moveDroppedTabs(s,i.id,l,a,n)}else{const e=t?0:r.size-1;if(!o)return;Se.moveDroppedTabs(o,i.id,e,void 0,n)}}),50),R={bookmarkId:"",inBackground:!1,inCurrent:!1,inSpecificPageId:void 0,incognito:!1,transition:T.Z.historyPrivate.TransitionType.AUTO_TOPLEVEL,fromUrlField:!1,index:void 0,postParams:void 0,contentType:void 0,singleton:!1,skipParams:!1,groupId:void 0};async function B(e,t="",n=R){const s=(0,k.Gr)(t),o=s&&"_blank"!==s?s:l.Z.getDefaultStartpage(e);if(!m.ZP.getWindowState(e))return Promise.reject("Unknown window");if(m.ZP.isSettings(e)&&!0!==n.inNewWindow){let t=m.ZP.getLastActiveBrowserWindowId();if(m.ZP.isGuestSession(t)&&(t=-1),-1===t){const e=m.ZP.getIds("normal").filter((e=>!m.ZP.isGuestSession(e)));e.length>0&&(t=e[0])}-1===t?(e=-1,n.inNewWindow=!0,n.inBackground=!1):(e=t,n.inNewWindow=!1,n.inCurrent=!1)}if(m.ZP.isGuestSession(e)&&(0,k.YC)(o))return Promise.reject("Illegal URL for Guest mode");if(m.ZP.isIncognito(e)&&(0,k.CS)(o)){const t=m.ZP.getIds("normal").filter((e=>!m.ZP.isIncognitoOrGuest(e)));n.incognito=!1,t.length>0?e=t[0]:n.inNewWindow=!0}if(m.ZP.isPopup(e)&&(n.inNewWindow=!0,n.inBackground=!1),o===k.xy.welcome&&T.Z.utilities.setSharedData({key:"has_shown_welcome_page",value:!0}),n.inNewWindow)return g.Z.openBrowserWindow(e,o,{incognito:n.incognito,transition:n.transition,fromUrlField:n.fromUrlField}).then((e=>{if(e&&e.tabs&&e.tabs.length>0){const t=e.tabs[0];return{windowId:parseInt(e.id),pageId:parseInt(t.id)}}return{windowId:-1,pageId:-1}}));let r="";if(n.contentType&&(r="Content-Type: "+n.contentType+"\r\n\r\n",console.assert(n.postParams)),n.singleton){const t=l.Z.getPages(e).find((e=>(0,N.uu)(o,e.url,n.skipParams)));if(t)return(0,k.Z7)(o)&&a.Z.dispatch({actionType:"PAGE_OPEN_URL",windowId:e,pageId:t.id,url:o}),a.Z.dispatch({actionType:"PAGE_OPEN",windowId:e,pageId:t.id}),Promise.resolve({windowId:e,pageId:t.id})}const h=n.inSpecificPageId?l.Z.getPageInWindow(e,n.inSpecificPageId):l.Z.getActivePage(e);if((n.inCurrent||n.inSpecificPageId)&&h&&!m.ZP.isPopup(e)){n.bookmarkId&&i.Z.add(h.id,n.bookmarkId,o);const t=h.vivExtData.ext_id;return d.Z.destroyPeriodicAlarm(t),a.Z.dispatch({actionType:"PAGE_OPEN_URL",pageId:h.id,windowId:e,url:o,postParams:n.postParams,headers:r,transition:n.transition,fromUrlField:n.fromUrlField}),Promise.resolve({windowId:e,pageId:h.id})}const p={url:n.postParams?"about:blank":w(o),windowId:e,index:n.index,active:!n.inBackground,transition:n.transition,fromUrlField:n.fromUrlField,openerTabId:n.addOpenerTabId&&h?h.id:void 0};n.groupId&&(p.vivExtData=JSON.stringify({group:n.groupId}));const v=(await f.Z.tabs.create(p)).id;return void 0===v?Promise.reject("Failed to create tab"):(c.Z.get(M.kTabsFocusWebview)&&u.Z.doAction(e,v,"focusWebView"),n.bookmarkId&&i.Z.add(v,n.bookmarkId,o),n.postParams&&a.Z.dispatch({actionType:"PAGE_OPEN_URL",pageId:v,windowId:e,url:o,postParams:n.postParams,headers:r,transition:n.transition,fromUrlField:n.fromUrlField}),n.inBackground||await function(e,t){return new Promise((n=>{f.Z.windows.update(e,t,n)}))}(e,{focused:!0}),{windowId:e,pageId:v})}function F(e,t,n){const i=n.windowId;(m.ZP.isPopup(i)||i===window.vivaldiWindowId)&&("complete"===t.status&&(t.title=n.title),a.Z.dispatch({actionType:"CHROME_TABS_UPDATED",tabId:e,windowId:i,changeInfo:t}))}function U(e,t,n){(class{static setMediaState(e,t){a.Z.dispatch({actionType:"PAGE_SET_MEDIASTATE",tabId:e,mediastate:t})}}).setMediaState(e,n)}function V(e,t){let n=t.adoptedLanguage;"und"===n&&(n=t.cldLanguage,"und"===n&&(n="")),h.Z.setDeterminedLanguage(e,n)}function W(e,t,n,i){h.Z.setPageTranslated(e,{isTranslated:!0,originalLang:t,translatedLang:n,error:i})}function H(e,t){!1===t&&h.Z.revertTranslation(e)}function z(e,t,n,i){let s="undecided";switch(i){case"allow":s="allowed";break;case"block":s="blocked";break;default:s="undecided"}let o=null;try{o=new URL(n)}catch(e){return}r.Z.setPermission(e,o.origin,t,null,s)}function G(e,t){const n=l.Z.getActivePage(e);n&&(t?u.Z.back(e,n.id):u.Z.forward(e,n.id))}function $(e,t,n){a.Z.dispatch({actionType:"VIVALDI_TABS_ATTACHED",tabId:e,fromWindowId:t}),U(e,window.vivaldiWindowId,n)}function K(e,t){a.Z.dispatch({actionType:"VIVALDI_TABS_DETACHED",tabId:e,toWindowId:t})}function j(e,t,n){a.Z.dispatch({actionType:"VIVALDI_TABS_UPDATED",pageId:e,windowId:t,tabInfo:n})}function Y(e,t){if(!m.ZP.getWindowState(e))return;const n=l.Z.getActivePage(e);n&&n.id===t||re(t,e)}function X(e,t){if(!m.ZP.isPopup(t.windowId)&&t.windowId!==window.vivaldiWindowId)return;const n={actionType:"CHROME_TABS_REMOVED",tabId:e,removeInfo:t};a.Z.dispatch(n)}async function Q(e,t){if(0===t.length)return;const n=[],i=l.Z.getPages(e);for(let e=0;e<t.length;e++){const s=t[e],o=i.find((e=>e.id===s));if(o){const e=o.vivExtData.ext_id;n.push(e)}}await(0,v.Z)(e,{historystack:n})}let q;async function J(e){if(!m.ZP.isPopup(e.windowId)&&e.windowId!==window.vivaldiWindowId)return;let t=s.ZP.tabToPage(e);const n=t.windowId,i=l.Z.getPages(n)?l.Z.getActivePage(n):void 0,o={ext_id:C()()},r=[...l.Z.getPageHistory(n)];if(t.active?(0,P.AL)(r,t.id):(0,P.EQ)(r,t.id),q){const{index:e}=await f.Z.tabs.get(t.id);t=t.set("index",e),q=void 0}else{let e=l.Z.findRepositionedIndex(t,n,i);if(e!==t.index){const n=await f.Z.tabs.move([t.id],{index:e});e=Array.isArray(n)?n[0].index:n.index,t=t.set("index",e)}}const d=t.openerTabId,h=c.Z.get(M.kTabsNewPlacement),p="number"==typeof d&&l.Z.getPageById(d);if(p){const e="openintabstackwithrelated"===h&&!(0,k.pM)(p.url)&&!p.pinned?await ge((0,A.aV)([p,t])):(0,Z.av)(p),i=c.Z.get(M.kTabsStackingOpenInCurrent);if(e&&i){const t=l.Z.getGroup(e,p.windowId).size>1;t&&(o.group=e);const{tiling:i}=p.vivExtData;t&&i&&l.Z.getTiles(i.id,n).size>1&&(o.tiling=i)}}a.Z.dispatch({actionType:"CHROME_TABS_CREATE",page:t.mergeIn(["vivExtData"],o),tabActivationHistory:r,deactivatePageId:t.active?i?.id:void 0,windowId:n}),await(0,D.V)(t.id,o);const u="number"==typeof t.openerTabId?l.Z.getActivePage(n)?.imageLoading:c.Z.get(M.kPageImageLoading);u&&await new Promise((e=>{T.Z.tabsPrivate.update(t.id,{showImages:"never"!==u,loadFromCacheOnly:"cache"===u},e)})),await Q(n,r),await new Promise((e=>{n&&f.Z.windows.update(t.windowId,{focused:!0,drawAttention:!0},e)}))}function ee(e){e.windowId===window.vivaldiWindowId&&a.Z.dispatch({actionType:"CHROME_TABS_ACTIVATED",activeInfo:e})}function te(e,t){t.newWindowId===window.vivaldiWindowId&&a.Z.dispatch({actionType:"CHROME_TABS_ATTACHED",tabId:e,attachInfo:t})}function ne(e,t){t.oldWindowId===window.vivaldiWindowId&&a.Z.dispatch({actionType:"CHROME_TABS_DETACHED",tabId:e,detachInfo:t})}function ie(e,t){const n=t.windowId;n===window.vivaldiWindowId&&a.Z.dispatch({actionType:"CHROME_TABS_MOVED",tabId:e,windowId:n,index:t.toIndex})}let se=!1,oe=null;async function ae(e,t,n){a.Z.dispatch({actionType:"UNLOAD_DIALOG_CLOSED",windowId:e,tabId:t,proceed:n}),se=!1,!n&&oe?.id&&(await f.Z.tabs.remove(oe.id),oe=null)}function re(e,t,n=!0){a.Z.dispatch({actionType:"PAGE_OPEN",pageId:e,windowId:t,selectGroup:n})}function le(e){a.Z.dispatch({actionType:"PAGE_MINIMIZE",windowId:e})}async function de(e){return!se&&(!(!m.ZP.isPopup(e)&&!m.ZP.isSettings(e))&&(se=!0,await g.Z.close(e),se=!1,!0))}async function ce(e,t=!1){if(se)return;const n=e instanceof A.aV?e:A.aV.of(e);if(0===n.size)return;const i=n.first().windowId,s=function(e,t){const n=l.Z.getPages(t);if(1===n.size&&!l.Z.canClosePage(n.first()))return(0,A.aV)([]);const i=c.Z.get(M.kTabsClosePinned);return"off"===i||"bury"===i?e.filter((e=>!e.pinned)):e}(n,i);if(!t&&c.Z.get(M.kTabsConfirmClosingTabs)&&s.size>=c.Z.get(M.kTabsConfirmClosingThreshold))return void o.Z.showConfirmCloseOtherTabsDialog(i,{pages:e});se=!0,a.Z.dispatch({actionType:"PAGE_CLOSE",pages:s});const r=n.find((e=>e.pinned&&e.active)),d=c.Z.get(M.kTabsClosePinned);r&&"bury"===d&&le(i);const h=c.Z.get(M.kTabsNeverCloseLast),p=s.count()===l.Z.getPages(i).count();h&&p&&!oe&&(oe=await f.Z.tabs.create({url:m.ZP.isGuestSession(i)?I.Cd:l.Z.getDefaultStartpage(i),active:!1,transition:T.Z.historyPrivate.TransitionType.AUTO_TOPLEVEL,windowId:i}));const u=s.map((e=>e.id)).toArray();!oe&&await async function(e,t){const n=e.some((e=>e.pinned)),i=c.Z.get(M.kTabsClosePinned),s=e.some((e=>e.active));if("bury"===i&&n){const e=l.Z.getPageHistory(t),n=e[e.length-2];return void 0!==n&&await f.Z.tabs.update(n,{active:!0})}if(1===e.size&&s){const n=l.Z.findPageToActivateAfterClosingPage(e.first(),t)?.id;return void 0!==n&&await f.Z.tabs.update(n,{active:!0})}}(s,i);try{await f.Z.tabs.remove(u)}catch(e){console.warn(e)}oe=null,se=!1;const g=n.get(0);await async function(e,t){l.Z.getPageInWindow(e.windowId,e.id)&&await new Promise((n=>{const i=setTimeout(s,t);function s(){n&&(l.Z.removeListener(o),clearTimeout(i),n(),n=null)}function o(){l.Z.getPageInWindow(e.windowId,e.id)||s()}l.Z.addListener(o)}))}(g,100),oe&&void 0!==oe.id&&(await f.Z.tabs.update(oe.id,{active:!0}),oe=null)}async function he(e,t,n,i){if(0!==O)return;let s;if("other"===t){const t=l.Z.getActivePage(e);if(!t)return;s=l.Z.getPages(e).filter((e=>e.id!==t.id))}else if("all"===t)s=l.Z.getPages(e);else if(i&&"selection"===t)s=i;else{const t=l.Z.getActivePage(e);if(!t)return;s=A.aV.of(t)}await Promise.all(s.map((async e=>{O++;try{await T.Z.tabsPrivate.update(e.id,{muteTab:"mute"===n})}finally{O--}})))}async function pe(e,t){const n=window.vivaldiWindowId;if(e instanceof A.aV){const i=e;let s=i.some((e=>e.index<t))?t+1:t;for(let e=0;e<i.size;e+=1){const t=i.get(e);if(!t)break;0===e?s>t.index&&s--:e>0&&s<t.index&&s++,t.index===s&&n===t.windowId||await f.Z.tabs.move(t.id,{index:s,windowId:n})}}else{const i=e;await f.Z.tabs.move(i.id,{windowId:n,index:t})}}async function ue(e,t){const n=await f.Z.tabs.move(e.map((e=>e.id)).toArray(),{windowId:t,index:-1});await new Promise((e=>{f.Z.windows.update(t,{focused:!0},e)}));const i=e.find((e=>e.active));return i&&await f.Z.tabs.update(i.id,{active:!0}),n}async function ge(e,t,n){if(e.some((e=>e.pinned)))return console.warn("Can't group pinned pages."),"";const i=e.find(Z.av),s=i?(0,Z.av)(i):"",o=n||s||l.Z.getNewGroupId();return await Promise.all(e.filter((e=>Z.av!==o)).map((({id:e})=>(0,D.V)(e,{group:o})))),"number"==typeof t&&await pe(e,t),a.Z.dispatch({actionType:"PAGE_TABSTACK_CREATE",pages:e}),o}async function me(e){const t=e instanceof A.aV?e:A.aV.of(e);a.Z.dispatch({actionType:"PAGE_TABSTACK_REMOVE_FROM",pages:t}),await Promise.all(t.map((e=>(0,D.V)(e.id,{group:void 0,tiling:void 0}))));const n=t.first().windowId,i=l.Z.getPages(n).last().index+1;await Se.moveToIndex(t,i)}async function ve(e,t){await Promise.all(e.map((e=>f.Z.tabs.update(e.id,{pinned:t}))))}async function fe(e,t){let n,i;"always"===t?(n=!0,i=!1):"cache"===t?(n=!0,i=!0):"never"===t&&(n=!1,i=!1),await T.Z.tabsPrivate.update(e.id,{showImages:n,loadFromCacheOnly:i,enablePlugins:n})}async function ye(e,t,n="selection"){const i=t||(e.count()<4?"row":"grid"),s=C()();await Promise.all(e.map((e=>(0,D.V)(e.id,{tiling:{layout:i,type:n,id:s}})))),a.Z.dispatch({actionType:"PAGE_TILE_PAGES",pages:e,id:s})}function we(e,t){const n=l.Z.getTiles(e,t);n&&be(n)}async function be(e){await Promise.all(e.map((e=>(0,D.V)(e.id,{tiling:void 0})))),a.Z.dispatch({actionType:"PAGE_TILE_PAGES",pages:e,id:""})}function Ce(e){a.Z.dispatch({actionType:"PAGE_SELECTION_CLEAR",windowId:e})}const Se={attachPageEventsPromise:async function(){f.Z.tabs.onCreated.addListener(J),f.Z.tabs.onUpdated.addListener(F),f.Z.tabs.onRemoved.addListener(X),f.Z.tabs.onMoved.addListener(ie),f.Z.tabs.onActivated.addListener(ee),f.Z.tabs.onDetached.addListener(ne),f.Z.tabs.onAttached.addListener(te),function(){const{tabsPrivate:e}=T.Z;e.onMediaStateChanged.addListener(U),e.onPermissionAccessed.addListener(z),e.onRockerGesture.addListener(G),e.onTabIsAttached.addListener($),e.onTabIsDetached.addListener(K),e.onTabUpdated.addListener(j),e.onBeforeUnloadDialogClosed.addListener(ae),e.onLanguageDetermined.addListener(V),e.onPageTranslated.addListener(W),e.onIsPageTranslatedChanged.addListener(H)}(),function(){const{windowPrivate:e}=T.Z;e.onBeforeUnloadDialogOpened.addListener(Y)}(),c.Z.addListener(M.kTabsSelectionIncludeActive,Ce)},clear:function(){a.Z.dispatch({actionType:"PAGE_CLEAR"})},clearSelection:Ce,clonePages:async function(e){return q=new Promise((t=>{e.sort(((e,t)=>e.index-t.index)).filter((e=>!(0,k.m7)(e))).map(((e,t)=>async()=>{const n=e.index,i=await f.Z.tabs.duplicate(e.id);if(!i)return-1;const o=i.id;if(!o)return-1;"alwayslast"===c.Z.get(M.kTabsActivationOnClone)&&await f.Z.tabs.move(o,{index:-1}),"rightofcurrent"===c.Z.get(M.kTabsActivationOnClone)&&await f.Z.tabs.move(o,{index:n+1+t});const a=(0,Z.av)(e);if(a&&l.Z.getGroup(a,e.windowId).size>1){const t=s.ZP.tabToPage(i);await ge((0,A.aV)([e,t])),t.setIn(["vivExtData","group"],a)}return o})).reduce((async(e,t)=>[...await e,await t()]),Promise.resolve([])).then(t)})),q},close:async function(e){if(l.Z.isSelecting(e)){const t=l.Z.getSelectedPages(e);return void await ce(t)}if(!await de(e)){const t=l.Z.getActivePage(e);t&&await ce(A.aV.of(t))}},closeOther:function(e,t){const n=e instanceof A.aV?e:A.aV.of(e);let i;i=t?n.flatMap((e=>l.Z.isGroup((0,Z.av)(e),e.windowId)?l.Z.getGroup((0,Z.av)(e),e.windowId):A.aV.of(e))):n;const s=i.first().windowId;ce(l.Z.getPages(s).filterNot((e=>i.some((t=>t.id===e.id)))))},closePage:ce,closeTabStack:async function(e){const t=l.Z.getPageById(e);if(!t)return;const n=(0,Z.av)(t);ce(l.Z.getGroup(n,t.windowId))},closeToLeft:async function(e,t,n=!1){const i=(0,Z.av)(t);let s;if(s=n?l.Z.getPages(e).skipUntil((e=>(0,Z.av)(e)===i)).takeUntil((e=>e.id===t.id)):l.Z.isGroup((0,Z.av)(t),t.windowId)?l.Z.getPages(e).takeUntil((e=>e.id===t.id)).filter((e=>(0,Z.av)(e)!==i)):l.Z.getPages(e).takeUntil((e=>e.id===t.id)),!s.isEmpty())return ce(s)},closeToRight:async function(e,t,n=!1){let i=l.Z.getPages(e).skipUntil((e=>e.id===t.id)).skip(1);const s=(0,Z.av)(t);if(n?i=i.takeUntil((e=>(0,Z.av)(e)!==s)):l.Z.isGroup((0,Z.av)(t),t.windowId)&&(i=i.filter((e=>(0,Z.av)(e)!==s))),!i.isEmpty())return ce(i)},closeUrl:function(e,t){ce(l.Z.getPages(e).filter((e=>(0,N.uu)(t,e.url))))},closePopupOrSettingsWindow:de,createTabStack:ge,changePeriodicReloadForPages:async function(e,t){await Promise.all(e.map((e=>(0,D.V)(e,{interval:t}))))},cycleByHistory:function(e,t,n={goBack:!1}){a.Z.dispatch({actionType:"PAGE_CYCLE_BY_HISTORY",windowId:e,maybeEvent:t,goBack:n.goBack})},cycleByOrder:function(e,t,n={goBack:!1}){a.Z.dispatch({actionType:"PAGE_CYCLE_BY_ORDER",windowId:e,maybeEvent:t,goBack:n.goBack})},detachPage:async function(e,t,n){const i=e instanceof A.aV?e:A.aV.of(e);1===i.size&&await me(i);const s=i.first(),o=i.rest(),a=await g.Z.openBrowserWindow(s.windowId,[],{tabId:s.id,left:t,top:n,vivExtData:JSON.stringify({isDropped:!0})});a?.id&&o.count()&&await ue(o,a.id)},discardPage:function(e){e.isInspected||f.Z.tabs.discard(e.id)},exitPictureInPicture:function(e){f.Z.scripting.executeScript({target:{tabId:e},function:()=>{document.pictureInPictureElement&&document.exitPictureInPicture()}}).catch((e=>{}))},expandSelectionNext:function(e,t=!0){a.Z.dispatch({actionType:"PAGE_SELECTION_EXPAND_NEXT",page:e,addGroup:t})},expandSelectionPrevious:function(e,t=!0){a.Z.dispatch({actionType:"PAGE_SELECTION_EXPAND_PREVIOUS",page:e,addGroup:t})},expandTabStack:async function(e,t){const n=l.Z.getPages(e).filter((e=>(0,Z.av)(e)===t));await Promise.all(n.map((e=>(0,D.V)(e.id,{group:void 0,tiling:void 0}))))},gotoParentDirectory:function(e,t){const{url:n}=t,i=n.lastIndexOf("/");if(-1===i)return;let s;if(i+1===n.length){const e=n.substr(0,n.length-1).lastIndexOf("/");-1!==e&&(s=n.substr(0,e+1))}else s=n.substr(0,i+1);s&&!s.endsWith("://")&&Se.openURL(e,s,{inSpecificPageId:t.id})},loadPromise:async function(){const e=window.vivaldiWindowId;if(void 0===e)return;const t=await async function(e,t){return new Promise((n=>{f.Z.windows.get(e,t,n)}))}(e,{populate:!0}),n=t.tabs||[],i=t.vivExtData&&function(e){try{return JSON.parse(e)}catch(e){}}(t.vivExtData)?.historystack||[];if(a.Z.dispatch({actionType:"CHROME_TABS_INIT",tabs:n,windowId:e,historystack:i}),!m.ZP.isSettings(e)&&!m.ZP.isPopup(e)&&!m.ZP.isIncognitoOrGuest(e)){const t=await l.Z.isUrlInAnyWindowPromise(k.xy.welcome);s=e,o=t,T.Z.utilities.canShowWhatsNewPage((e=>{if(e.show){const{vivaldiVersion:e}=T.Z.utilities.getVersion(),t="W",n="https://vivaldi.com/newfeatures?hl="+(0,S.Z)()+"&version="+e+"&os="+t;B(s,n,{inCurrent:!1,inBackground:o})}}))}var s,o},minimizePage:le,moveDroppedTabs:async function(e,t,n,i,s){void 0!==i&&await Promise.all(e.map((e=>(0,D.V)(e.id,{group:i})))),await pe(e,n),(t?e.find((e=>e.id===parseInt(t))):e.first())&&re(t,s),await new Promise((e=>setTimeout(e,100))),ve(e.filter((e=>e.pinned)),!0)},moveToIndex:pe,moveToWindow:ue,muteAllExcept:function(e,t){he(e,"selection","mute",l.Z.getPages(e).filter((e=>-1===t.findIndex((t=>t.id===e.id)))))},newTab:async function(e,t,n){const i=(0,k.Gr)(t),s=i&&"_blank"!==i?i:l.Z.getDefaultStartpage(e),o={url:s,windowId:e,index:n,active:!0},r=await f.Z.tabs.create(o);if(void 0!==r?.id){const t=r.id;return a.Z.dispatch({actionType:"PAGE_OPEN_URL",pageId:t,windowId:e,url:s,postParams:void 0}),t}throw new Error("Failed to create tab")},openLastPage:function(e){const t="off"===c.Z.get(M.kTabsStackingMode),n=l.Z.getTabs(e,t).last();n&&re(n.page.id,e)},activateTab:re,activateTabByIndex:function(e,t){const n="off"===c.Z.get(M.kTabsStackingMode),i=l.Z.getTabs(e,n).get(t);if(!i)return;const s="group"===i.type?i.pages:(0,A.aV)();if(!(s.size>0)||!i.page.active)return void re(i.page.id,i.page.windowId);if(s.last()===i.page)return void re(s.first().id,e);const o=s.findIndex((e=>e.active))+1,a=s.get(o)?.id;a&&re(a,e)},openURL:B,openUrls:async function(e,t,n){n.inNewWindow?await g.Z.openBrowserWindow(e,t,{incognito:n.incognito}):await Promise.all(t.map(((i,s)=>n.inCurrent?Se.openURL(e,i,{...n,inCurrent:0===s,inBackground:0!==s}):Se.openURL(e,i,{...n,inBackground:n.inBackground||i!==(0,_.default)(t)}))))},reloadPage:async function(e){const t=e instanceof A.aV?e:A.aV.of(e);await Promise.all(t.map((e=>f.Z.tabs.reload(e))))},removeFromTabStack:me,setHistoryManagerState:async function(e,t){await(0,D.V)(e,{historyManagerState:t})},setImageInspector:function(e,t,n){a.Z.dispatch({actionType:"PAGE_SET_IMAGE_INSPECTOR",pageId:e,windowId:t,showImageInspector:n})},setImageLoading:fe,setIsRestored:function(e,t){a.Z.dispatch({actionType:"PAGE_SET_IS_RESTORED",extId:e,restored:t})},setMuting:he,setOrigin:function(e,t,n){let i=x.get(e);i&&clearTimeout(i.id),n&&n.length>0?(i={},i.url=n,i.id=setTimeout((()=>{i=x.get(e),a.Z.dispatch({actionType:"PAGE_SET_ORIGIN",pageId:e,windowId:t,url:i?.url||""})}),1e3),x=x.set(e,i)):(i&&(x=x.delete(e)),a.Z.dispatch({actionType:"PAGE_SET_ORIGIN",pageId:e,windowId:t,url:""}))},setPageInspected:function(e,t,n){a.Z.dispatch({actionType:"PAGE_SET_IS_INSPECTED",pageId:e,windowId:t,inspected:n})},setPinned:ve,setReaderState:async function(e,t){await(0,D.V)(e,{readerMode:t})},setSelection:function(e,t=!1,n=!0,i=!1){a.Z.dispatch({actionType:"PAGE_SELECTION_SET",page:e,multiSelect:t,addGroup:n,excludeActive:i})},setThumbnail:async function(e,t){const n=l.Z.getPageById(e);n&&(t?await(0,D.V)(e,{urlForThumbnail:n.url,thumbnail:t}):await(0,D.V)(e,{urlForThumbnail:void 0,thumbnail:void 0}))},setTitle:function(e,t,n){a.Z.dispatch({actionType:"PAGE_SET_TITLE",pageId:e,windowId:t,title:n})},showHomepage:async function(e,t){if(t.inCurrent){const t=l.Z.getActivePage(e);t&&p.Z.setUrlFieldActive(t.id,!1)}const n=c.Z.get(M.kHomepage),i=l.Z.getDefaultStartpage(e),s=n===I.QG&&i===I.P1?i:n;await B(e,s,t)},stepPage:async function(e,t,n,i){const s=l.Z.getStepInfo(e,t,n,i);if(!s)return;const{pages:o,index:a}=s;await Se.moveDroppedTabs(o,e.id,a,void 0,i)},stepTabsToStart:function(e){L({toStart:!0,windowId:e})},stepTabsToEnd:function(e){L({toStart:!1,windowId:e})},tileLastActive:async function(e="row",t){const n=(0,A.aV)([l.Z.getActivePage(t),l.Z.getPageById(l.Z.getLastVisited(t))].filter(Boolean));n.count()>1&&(n.forEach((e=>{const n=(0,Z.jA)(e);n&&we(n,t)})),await ye(n,e))},tilePages:ye,tileTabStack:async function(e,t,n){const i=l.Z.getGroup(e,t),s=n||(i.count()<4?"row":"grid");await ye(i,s,"group")},toggleImageLoading:async function(e){const t=e.imageLoading;"always"===t?await fe(e,"never"):"never"===t?await fe(e,"cache"):await fe(e,"always")},toggleMuting:async function(e,t){const n=t.filter((e=>!e.vivExtData.vivaldi_tab_muted)),i=t.filter((e=>e.vivExtData.vivaldi_tab_muted));await he(e,"selection","mute",n),await he(e,"selection","unmute",i)},toggleRelatedSelection:function(e){a.Z.dispatch({actionType:"PAGE_SELECTION_TOGGLE_RELATED",page:e})},toggleSelectedPagesPinned:async function(e){const t=l.Z.isSelecting(e)?l.Z.getSelection(e).map((t=>l.Z.getPages(e).find((e=>e.id===t)))).filter(Boolean).toList():A.aV.of(l.Z.getActivePage(e)).filter(Boolean);if(t.size)for(let e=0;e<t.size;e+=1){const n=t.get(e);if(!n)return;const i=(0,Z.av)(n),s=l.Z.getGroup(i,n.windowId),o=n.pinned||s?.some((e=>e.pinned));if(s.size>1)for(let e=0;e<s.size;e+=1){const t=o?s.size-1-e:e,n=s.get(t);n&&await f.Z.tabs.update(n.id,{pinned:!o})}else await f.Z.tabs.update(n.id,{pinned:!o})}},treeMove:async function({pages:e,groups:t,targetPage:n,after:i,area:s,group:o="",windowId:a}){await Promise.all(e.map((async e=>{switch(s){case"pinned":return await(0,D.V)(e.id,{group:o,tiling:void 0}),void await f.Z.tabs.update(e.id,{pinned:!0});case"stack":{const t=l.Z.getPages(a).find((e=>(0,Z.av)(e)===o&&Boolean(e.vivExtData.tiling)))?.vivExtData.tiling;return await(0,D.V)(e.id,{group:o,tiling:t}),void await f.Z.tabs.update(e.id,{pinned:!1})}case"regular":{const n=(0,Z.av)(e),i=t.includes(n)?n:void 0,s=e.vivExtData.tiling;return await(0,D.V)(e.id,{group:i,tiling:i?s:void 0}),void await f.Z.tabs.update(e.id,{pinned:!1})}}})));let r=(n?n.index:0)+(i?1:0);await Promise.all(e.map((async(e,t)=>{0===t?r>e.index&&r--:t>0&&r<e.index&&r++,await f.Z.tabs.move(e.id,{windowId:a,index:r})})))},untilePages:be,untileTileGroup:we},Te=Se},18350:(e,t,n)=>{"use strict";n.d(t,{Z:()=>m});var i=n(15285),s=n(68247),o=n(29087),a=n(84990),r=n(70864),l=n(15489),d=n(92292),c=n(7064),h=n(89175),p=n(34155);function u(){const{vivaldiVersion:e}=c.Z.utilities.getVersion();r.Z.upgrade(e),e&&e!==o.Z.get(h.kPanelsVersion)&&function(e){const t=o.Z.get(h.kPanelsList),n=[...o.Z.get(h.kPanelsList)],i=o.Z.getDefault(h.kPanelsList);t.forEach((e=>{let t=i.findIndex((t=>t.id===e.id));-1===t&&(t=n.findIndex((t=>t.id===e.id)),-1===t?console.error("Failed to remove old panel",e.id):n.splice(t,1))})),i.forEach(((e,t)=>{if(-1===n.findIndex((t=>t.id===e.id))){const i=t>n.length?n.length:t;n.splice(i,0,e)}})),s.Z.set(h.kPanelsVersion,e),s.Z.set(h.kPanelsList,n)}(e)}const g=new class{async loadPromise(){a.Z.dispatch({actionType:"PANEL_INIT_COMMON",state:{regPanels:o.Z.get(h.kPanelsList),webPanels:o.Z.get(h.kPanelsWebItems)}}),l.ZP.getIds("normal").forEach((e=>{!async function(e){const t=await d.Z.windows.get(e),n=t.vivExtData?JSON.parse(t.vivExtData):{},i=o.Z.get(h.kPanelsState),s={winId:e,showBar:i.barVisible,showContent:i.panelVisible,width:i.width,selectedPanel:i.selectedPanel};n.hasOwnProperty("SHOW_PANEL")&&(s.showBar=n.SHOW_PANEL),n.hasOwnProperty("SHOW_PANEL_CONTENT")&&(s.showContent=n.SHOW_PANEL_CONTENT),n.hasOwnProperty("PANEL_WIDTH")&&(s.width=n.PANEL_WIDTH),n.hasOwnProperty("SELECTED_PANEL")&&(s.selectedPanel=n.SELECTED_PANEL),o.Z.get(h.kMailIsTurnedOff)&&["calendar","contacts","feeds","mail"].includes(s.selectedPanel)&&(s.selectedPanel=""),a.Z.dispatch({actionType:"PANEL_INIT_WINDOW",state:s})}(e)})),u(),o.Z.addListener(h.kPanelsList,g.setPanels),o.Z.addListener(h.kPanelsWebItems,g.setPanels),o.Z.addListener(h.kMailIsTurnedOff,((e,t,n)=>{g.setPanels(null,o.Z.get(h.kPanelsList),h.kPanelsList)}))}setFocus(e){a.Z.dispatch({actionType:"PANEL_SET_FOCUS",winId:e})}removeFocus(e){a.Z.dispatch({actionType:"PANEL_REMOVE_FOCUS",winId:e})}toggleFloating(){a.Z.dispatch({actionType:"PANEL_TOGGLE_FLOATING"})}showNextPanel(e,t){a.Z.dispatch({actionType:"PANEL_SHOW_NEXT",winId:e,direction:t})}setContentVisible(e,t){a.Z.dispatch({actionType:"PANEL_SET_CONTENT_VISIBLE",winId:e,visible:t})}togglePanel(e){a.Z.dispatch({actionType:"PANEL_TOGGLE_PANEL",winId:e})}toggleContent(e,t){switch(t){case"webpanel 1":case"webpanel 2":case"webpanel 3":case"webpanel 4":case"webpanel 5":case"webpanel 6":case"webpanel 7":case"webpanel 8":case"webpanel 9":{const n=r.Z.getIndexByShortcut(t);if(-1!==n){const t=i.ZP.getWebPanels(e);n>=1&&n<=t.length&&a.Z.dispatch({actionType:"PANEL_TOGGLE_CONTENT",winId:e,panel:t[n-1].id})}break}default:a.Z.dispatch({actionType:"PANEL_TOGGLE_CONTENT",winId:e,panel:t})}}move(e,t,n,i){a.Z.dispatch({actionType:"PANEL_MOVE",winId:e,from:t,to:n,position:i})}showContent(e,t,n={selectId:"",reason:""}){const{setFocus:i=!1,selectId:s,reason:o}=n;a.Z.dispatch({actionType:"PANEL_SHOW_CONTENT",winId:e,panel:t,setFocus:i,selectId:s,reason:o})}setAvailable(e,t){a.Z.dispatch({actionType:"PANEL_SET_AVAILABLE",panel:e,available:t})}setWidth(e,t,n){a.Z.dispatch({actionType:"PANEL_SET_WIDTH",winId:e,panel:t,width:n})}toggleCurrentPanel(e){a.Z.dispatch({actionType:"PANEL_TOGGLE_CURRENT",winId:e})}setSeparateFloating(e,t){let n=o.Z.get(h.kPanelsWebItems).slice(),i=n.findIndex((t=>t.id===e));if(-1!==i){const e={...n[i]};return e.floating=t,n[i]=e,void s.Z.set(h.kPanelsWebItems,n)}if(n=o.Z.get(h.kPanelsList).slice(),i=n.findIndex((t=>t.id===e)),-1!==i){const e={...n[i]};e.floating=t,n[i]=e,s.Z.set(h.kPanelsList,n)}}setPanelResizable(e,t){a.Z.dispatch({actionType:"PANEL_SET_RESIZABLE",panel:e,resizable:t})}setPanels(e,t,n){p.nextTick((()=>a.Z.dispatch({actionType:"PANEL_SET_PANELS",key:n,value:t})))}translateWithPanel(e,t,n){i.ZP.getIsVisible(e,"translate")||this.toggleContent(e,"translate"),c.Z.utilities.broadcastMessage({translate:{winId:e,lang:t,text:n}})}clearTransitionState(e,t){a.Z.dispatch({actionType:"PANEL_CLEAR_TRANSITION_STATE",winId:e,panel:t})}closePanel(e){const t=i.ZP.getSelectedPanel(e);t&&a.Z.dispatch({actionType:"PANEL_CLOSE",winId:e,panel:t})}},m=g},14481:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(53576),s=n(63353),o=n(84990),a=n(32921);const r={load:async function(){const e=new Map,t=Date.now();s.Z.getReloadingPages().forEach((n=>{const i=n.vivExtData.interval,s=n.vivExtData.ext_id;if(!i||!s)return;const o={id:s,periodInMinutes:i,scheduledTime:(0,a.m)({periodInMinutes:i,scheduledTime:t}),from:"tab"};e.set(s,o)})),o.Z.dispatch({actionType:"PERIODIC_RELOAD_ALL",alarms:e})},createOrDestroyAlarm:async function(e){const{alarm:t,id:n,interval:i,from:s}=e;t?.periodInMinutes===i?await this.destroyPeriodicAlarm(n):await this.createPeriodicReloadAlarm({id:n,interval:i,from:s})},createPeriodicReloadAlarm:async function(e){const{id:t,from:n,interval:r}=e;if(!r)return;const l={id:t,scheduledTime:(0,a.m)({periodInMinutes:r,scheduledTime:Date.now()}),periodInMinutes:r,from:n},d=s.Z.getPageByReloadId(t);d&&await i.Z.changePeriodicReloadForPages([d.id],r),o.Z.dispatch({actionType:"PERIODIC_RELOAD_CREATE",alarm:{alarmId:t,alarm:l}})},destroyAllPeriodicAlarms:async function(){const e=s.Z.getReloadingPages().map((e=>e.id)).toArray();await i.Z.changePeriodicReloadForPages(e,0),o.Z.dispatch({actionType:"PERIODIC_RELOAD_DESTROY_ALL"})},destroyPeriodicAlarm:async function(e){const t=s.Z.getPageByReloadId(e);t&&await i.Z.changePeriodicReloadForPages([t.id],0),o.Z.dispatch({actionType:"PERIODIC_RELOAD_DESTROY",alarmId:e})},updateRunningAlarm:function(e,t){const n={alarmId:e,alarm:t};o.Z.dispatch({actionType:"PERIODIC_RELOAD_UPDATE",alarm:n})}}},92413:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var i=n(53576),s=n(84990),o=n(83526),a=n(15489),r=n(92292),l=n(68079),d=n.n(l);const c=new class{setReaderModeStyle(e){s.Z.dispatch({actionType:"READERMODE_SET_STYLE",windowId:e})}resetReaderModeStyle(e){s.Z.dispatch({actionType:"READERMODE_RESET",windowId:e})}async toggleReaderMode(e){d()(e.url)&&(e.vivExtData.readerMode?await i.Z.setReaderState(e.id,!1):await i.Z.setReaderState(e.id,!0),o.Z.doAction(e.windowId,e.id,"focusWebView"))}};r.Z.runtime.onMessage.addListener((function(e){if(e&&e.type)switch(e.type){case"SET_RM":if(!e.payload||"boolean"!=typeof e.payload.isReaderable||"number"!=typeof e.payload.pageId)return;const t=e.payload.pageId,n=e.payload.isReaderable;r.Z.tabs.get(t,(e=>{s.Z.dispatch({actionType:"READERMODE",supportsReaderMode:n,pageId:t,windowId:e.windowId})}));break;case"SET_RM_STYLE":c.setReaderModeStyle(a.ZP.getActiveBrowserOrPopupWindowId())}}));const h=c},54614:(e,t,n)=>{"use strict";n.d(t,{M:()=>d,Z:()=>h});var i=n(63353),s=n(60331),o=n(84990),a=n(56371),r=n(7064);const l=["http://","https://","file://"];function d(e){return l.some((t=>e?.toLowerCase().startsWith(t)))}function c(){r.Z.readingListPrivate.getAll((e=>{o.Z.dispatch({actionType:"READING_LIST_UPDATE",entries:e})}))}class h{static init(){c(),r.Z.readingListPrivate.onModelChanged.addListener((()=>c()))}static addSeveral(e,t){let n=0;t.forEach((t=>{d(t.url)&&r.Z.readingListPrivate.add(t.url,t.title,(t=>{t&&(n+=1,s.Z.setStatus(e,(0,a.Z)("$1 page has been added to Reading List.","$1 pages have been added to Reading List.",[n])))}))}))}static add(e,t,n=""){if(!t){const s=i.Z.getActivePage(e);s?(t=s.url,n=s.title):t=""}d(t)&&r.Z.readingListPrivate.add(t,n,(t=>{t&&s.Z.setStatus(e,(0,a.Z)("Page “$1” added to Reading List.",[n]))}))}static remove(e){r.Z.readingListPrivate.remove(e,(()=>{}))}static setReadStatus(e,t){r.Z.readingListPrivate.setReadStatus(e,t,(()=>{}))}}},10589:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var i=n(63353),s=n(29087),o=n(84990),a=n(15672),r=n(15489),l=n(89175),d=n(34155);const c=new class{setText(e,t){const n=i.Z.getActivePage(e);n&&o.Z.dispatch({actionType:"SEARCH_FIELD_SET_TEXT",tabId:n.id,text:t})}addTypedSearchHistory(e,t){s.Z.get(l.kAddressBarSearchTypedHistoryEnabled)&&!r.ZP.isIncognito(e)&&d.nextTick((()=>{o.Z.dispatch({actionType:"SEARCH_FIELD_ADD_TYPED_HISTORY",query:t})}))}deleteTypedSearchHistory(e){o.Z.dispatch({actionType:"SEARCH_FIELD_DELETE_TYPED_HISTORY",query:e})}load(){const e=a.Z.getSync("TYPED_SEARCH_HISTORY");o.Z.dispatch({actionType:"SEARCH_FIELD_INIT_TYPED_HISTORY",typedHistory:e})}};s.Z.addListener(l.kHistoryDaysToKeepVisits,((e,t)=>{0===t?o.Z.dispatch({actionType:"SEARCH_FIELD_DELETE_TYPED_HISTORY_FROM_DATABASE"}):0===e&&t>0&&o.Z.dispatch({actionType:"SEARCH_FIELD_WRITE_TYPED_HISTORY_TO_DATABASE"})}));const h=c},62645:(e,t,n)=>{"use strict";n.d(t,{Z:()=>K});var i=n(5298),s=n(84451),o=n(63353),a=n(29087);function r(e,t){return e*(1+t)}function l(e,t,n){var i=Number.MAX_VALUE;for(let s=0;s<e.length;s++){const o=e[s],a=d(o,t),l=r(o.w,a);a<=n&&l<i&&(i=l)}var s=[];for(let o=0;o<e.length;o++){const a=e[o],l=d(a,t),c=r(a.w,l);l<=n&&c===i&&s.push(a)}return s}function d(e,t){let n;return n=180===t&&e.d&&e.d<0?t+e.d:Math.abs((e.d||0)-t),n}function c(e,t){var n=e.filter((e=>e.d===t));if(n.length)return n[0];var i=function(e,t){var n=Number.MAX_VALUE;for(let i=0;i<e.length;i++){const s=d(e[i],t);s<n&&(n=s)}var i=[];for(let s=0;s<e.length;s++){const o=e[s];d(o,t)===n&&i.push(o)}return{pts:i,dev:n}}(e,t);return(n=i.pts).reduce(((e,n)=>{const i=e.d||NaN,s=n.d||NaN;return 180===t&&i>s?e:180===t&&s>i?n:i<s?e:n}))}function h(e,t){e.forEach((e=>{var n;e.d=function(e,t){var n=e.x-e.sx,i=e.y-e.sy;if(0===n&&0===i)return t;var s=Math.atan2(i,n);return s*=180/Math.PI,Math.round(s)}(e,t),e.w=(n=e,Math.round(Math.pow(n.x-n.sx,2)+Math.pow(n.y-n.sy,2)))}));var n,i=l(e,t,90),s=l(e,t,45),o=s.length?s:i;return 0===o.length?console.log("No point in this direction. Should wrap!"):n=1===o.length?o[0]:c(o,t),n}function p(e,t){Array.isArray(e.below)?e.below.push(t):e.below=[t]}function u(e,t){Array.isArray(e.above)?e.above.push(t):e.above=[t]}function g(e,t){Array.isArray(e.toRight)?e.toRight.push(t):e.toRight=[t]}function m(e,t){Array.isArray(e.toLeft)?e.toLeft.push(t):e.toLeft=[t]}function v(e,t){return e>=t.left&&e<=t.right}function f(e,t){return e>=t.top&&e<=t.bottom}function y(e){return e.left+(e.right-e.left)/2}function w(e,t){const n=y(e),i=y(t);return v(n,t)?(e.quality=1,n):v(i,e)?(e.quality=1,i):v(e.left,t)?(e.quality=2,e.left):v(e.right,t)?(e.quality=2,e.right):v(t.left,e)?(e.quality=2,t.left):v(t.right,e)?(e.quality=2,t.right):e.left>t.right?(e.quality=2,e.left):e.right<t.left?(e.quality=2,e.right):(e.quality=1,n)}function b(e){return e.top+(e.bottom-e.top)/2}function C(e,t){const n=b(e),i=b(t);return f(n,t)?(e.quality=1,n):f(i,e)?(e.quality=1,i):f(e.top,t)?(e.quality=2,e.top):f(e.bottom,t)?(e.quality=2,e.bottom):f(t.top,e)?(e.quality=2,t.top):f(t.bottom,e)?(e.quality=2,t.bottom):e.top>t.bottom?(e.quality=2,e.top):e.bottom<t.top?(e.quality=2,e.bottom):(e.quality=1,n)}function S(e){const t=e.filter((e=>1===e.quality)),n=e.filter((e=>2===e.quality));return t.length>0?t:n}function T(e,t){return e.left>=t.left&&e.top>=t.top&&e.right<=t.right&&e.bottom<=t.bottom}function I(e,t){return e.bottom>=t.top&&e.bottom<=t.bottom&&e.right>=t.left&&e.right<=t.right||e.top<=t.bottom&&e.top>=t.top&&e.left>=t.left&&e.left<=t.right}const k={buildPoints:function(e){var t=0;return e.map((n=>{var i=n;return i.id=++t,function(e,t){for(var n=0;n<t.length;n++){const i=t[n];i.id!==e.id&&(I(e,i)?(i.left<e.left&&m(e,i),i.right>e.right&&g(e,i),i.top<e.top&&u(e,i),i.bottom>e.bottom&&p(e,i)):(i.top>e.top?p(e,i):i.bottom<=e.top&&u(e,i),i.left>e.left?g(e,i):i.right<=e.left&&m(e,i)))}return e}(i,e)}))},buildPointsDeprecated:function(e){var t=0;return e.map((n=>{var i=n[0];return i.id=++t,i.data=n[1],function(e,t){for(var n=0;n<t.length;n++){const i=t[n][0];i.id!==e.id&&(I(e,i)?(i.left<e.left&&m(e,i),i.right>e.right&&g(e,i),i.top<e.top&&u(e,i),i.bottom>e.bottom&&p(e,i)):(i.top>e.top?p(e,i):i.bottom<=e.top&&u(e,i),i.left>e.left?g(e,i):i.right<=e.left&&m(e,i)))}return e}(i,e)}))},nextUp:function(e){if(!e.above)return;var t=h(S(e.above.map(((t,n)=>{var i=w(e,t);return{sx:i,sy:I(t,e)?Math.min(e.bottom,t.bottom):e.top,x:t.right<i?t.right:t.left>i?t.left:i,y:t.bottom,i:n,w:1,quality:e.quality}}))),-90);return t&&e?e.above&&e.above[t.i]:void 0},nextDown:function(e){if(!e.below)return;var t=h(S(e.below.map(((t,n)=>{var i=w(e,t);return{sx:i,sy:T(t,e)?e.top:I(t,e)?Math.max(e.top,t.top):e.bottom,x:t.right<i?t.right:t.left>i?t.left:i,y:t.top,i:n,w:1,quality:e.quality}}))),90);return t&&e?e.below&&e.below[t.i]:void 0},nextRight:function(e){if(!e.toRight)return;var t=h(S(e.toRight.map(((t,n)=>{var i=T(t,e)?e.left:I(t,e)?Math.max(e.left,t.left):e.right,s=C(e,t);return{sx:i,sy:s,x:t.left,y:t.bottom<s?t.bottom:t.top>s?t.top:s,i:n,w:1,quality:e.quality}}))),0);return t&&e?e.toRight&&e.toRight[t.i]:void 0},nextLeft:function(e){if(!e.toLeft)return;var t=h(S(e.toLeft.map(((t,n)=>{var i=C(e,t);return{sx:I(t,e)?Math.min(e.right,t.right):e.left,sy:i,x:t.right,y:t.bottom<i?t.bottom:t.top>i?t.top:i,i:n,w:1,quality:e.quality}}))),180);return t&&e?e.toLeft&&e.toLeft[t.i]:void 0}};var A=n(60331),Z=n(15489),E=n(7064),_=n(89175);const N=new Map;let M;function P(e){return e.map((e=>({left:e.left,top:e.top,right:e.right,bottom:e.bottom,path:e.path,url:e.href})))}function D(e){return N.get(e)??{indicator:void 0,navigablePoints:[],tabId:-1,point:void 0,scrollx:-1,scrolly:-1,url:"",needsUpdate:!0,path:""}}function x(){E.Z.tabsPrivate.onWebviewClickCheck.addListener(z),E.Z.tabsPrivate.onKeyboardChanged.addListener(B),s.Z.bind("ctrl+enter",U),s.Z.bind("shift+enter",V),s.Z.bind("ctrl+shift+enter",W)}function O(e,t){const n=document.activeElement;if(n){if(!N.get(e)?.indicator){const t=function(e){const t=document.createElement("div");return t.id="spatnav-indicator",t.style.position="absolute",t.style.boxShadow="0 0 10px 4px rgba(255,122,0,0.70), 0 0 0 2px #FF7A00",t.style.borderRadius="2px",t.style.backgroundColor="transparent",t.style.zIndex="0","visible"!==t.style.visibility&&(t.style.visibility="visible",x()),N.set(e,{...D(e),indicator:t}),t}(e);M&&M.appendChild(t)}E.Z.zoom.getVivaldiUIZoom((i=>{const s=N.get(e);if(s?.indicator){const o=n.getBoundingClientRect(),a=o.top,r=o.left,l=s.indicator;l.style.left=r+t.left/i+"px",l.style.top=a+t.top/i+"px",l.style.width=(t.right-t.left)/i+"px",l.style.height=(t.bottom-t.top)/i+"px","visible"!==l.style.visibility&&(l.style.visibility="visible",x()),N.set(e,{...s,indicator:l}),A.Z.setStatus(e,t.url)}}))}}function L(e){const t=N.get(e);if(t?.indicator){const n=t.indicator;n.style.visibility="hidden",N.set(e,{...t,indicator:n})}E.Z.tabsPrivate.onWebviewClickCheck.removeListener(z),E.Z.tabsPrivate.onKeyboardChanged.removeListener(B),s.Z.unbind("ctrl+enter",U),s.Z.unbind("shift+enter",V),s.Z.unbind("ctrl+shift+enter",W),A.Z.clearStatus(e)}function R(e,t){switch(t){case"up":return function(e){const t=N.get(e)?.navigablePoints;if(!t||0===t.length)return;let n=t[0];return t.forEach((e=>{e.top>n.top&&(n=e)})),n}(e);case"left":return function(e){const t=N.get(e)?.navigablePoints;if(!t||0===t.length)return;let n=t[0];return t.forEach((e=>{e.left>n.left&&(n=e)})),n}(e);default:return function(e){const t=N.get(e)?.navigablePoints;if(!t||0===t.length)return;let n=t[0];return t.forEach((e=>{n.left+n.top>e.left+e.top&&(n=e)})),n}(e)}}function B(e,t,n,s){"WEBVIEW"!==document.activeElement?.tagName||s===i.Z.KEY_ESCAPE&&0===n?L(e):s!==i.Z.KEY_RETURN&&s!==i.Z.KEY_ENTER||0!==n||F(e,0)}function F(e,t){L(e);const n=N.get(e),i=document.activeElement;if(n?.point&&i){const s=n.point,o=parseInt(i.getAttribute("tab_id")),a=(s.right-s.left)/2,r=(s.bottom-s.top)/2;E.Z.tabsPrivate.activateElementFromPoint(o,Math.round(s.left+a),Math.round(s.top+r),t),N.set(e,{...n,needsUpdate:!0})}}function U(e){F(e.windowId,2)}function V(e){F(e.windowId,1)}function W(e){F(e.windowId,3)}function H(e,t,n){const i=document.activeElement;if(!i)return;const s=i.getBoundingClientRect(),o="up"===n||"down"===n?Math.round(s.height/2):Math.round(s.width/2),a=N.get(e)?.path??"";E.Z.tabsPrivate.scrollPage(t,n,o,(()=>{E.Z.tabsPrivate.getSpatialNavigationRects(t,(t=>{const i=k.buildPoints(P(t));if(N.set(e,{...D(e),navigablePoints:i}),0===i.length)L(e),N.set(e,{...D(e),needsUpdate:!0});else{let t=i.find((e=>e.path===a));t||(t=R(e,n)),N.set(e,{...D(e),point:t}),t&&(N.set(e,{...D(e),path:""}),O(e,t),N.set(e,{...D(e),needsUpdate:!1}))}}))})),E.Z.tabsPrivate.getScrollPosition(t,((t,n)=>{N.set(e,{...D(e),scrollx:t,scrolly:n})}))}function z(e,t,n,i,s){L(e)}function G(e){if(e!==Z.ZP.getActiveWindowId())return;const t=o.Z.getActivePage(e)?.url??"",n=N.get(e)?.url??"";if(n){if(n!==t){const n=N.get(e)?.indicator;n&&"visible"===n.style.visibility&&L(e),N.set(e,{...D(e),url:t,needsUpdate:!0})}}else N.set(e,{...D(e),url:t})}async function $(e,t){const n=document.activeElement;if(!n)return;const i=parseInt(n.getAttribute("tab_id"));if(!a.Z.get(_.kWebpagesSpatialNavigationEnabled)&&i)return;let s=N.get(e)?.needsUpdate??!1;const{scrollx:o,scrolly:r}=await function(e){return new Promise((t=>{E.Z.tabsPrivate.getScrollPosition(e,((e,n)=>{t({scrollx:e,scrolly:n})}))}))}(i);o===N.get(e)?.scrollx&&r===N.get(e)?.scrolly&&i===N.get(e)?.tabId||(s=!0),N.set(e,{...D(e),scrollx:o,scrolly:r,tabId:i});const l=await E.Z.tabsPrivate.getSpatialNavigationRects(i);if(s){const n=k.buildPoints(P(l));N.set(e,{...D(e),navigablePoints:n});const i=R(e,t);N.set(e,{...D(e),point:i})}if(N.set(e,{...D(e),needsUpdate:!1}),M=document.getElementById("app"),0===l.length)return void H(e,i,t);const d=N.get(e)?.indicator;if(d)if("visible"!==d.style.visibility){const t=N.get(e)?.point;t&&O(e,t)}else{let n;const s=N.get(e)?.point;n=s?function(e,t){switch(t){case"left":return k.nextLeft(e);case"up":return k.nextUp(e);case"right":return k.nextRight(e);case"down":return k.nextDown(e)}}(s,t):R(e,t),n?(O(e,n),N.set(e,{...D(e),point:n})):H(e,i,t)}else{const n=R(e,t);N.set(e,{...D(e),point:n}),n&&O(e,n)}}const K=new class{attachSpatnavListeners(e){const t={onPageStore:G.bind(this,e)};return o.Z.addListener(t.onPageStore),t}detachSpatnavListeners(e){o.Z.removeListener(e.onPageStore)}async left(e){await $(e,"left")}async up(e){await $(e,"up")}async right(e){await $(e,"right")}async down(e){await $(e,"down")}}},60331:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i=n(84990),s=n(15489),o=n(1407);let a;const r=new class{setStatus(e,t,n){(e=this.rerouteWindowId(e))!==o.Ex&&(clearTimeout(a),i.Z.dispatch({actionType:"STATUS_SET_STATUS",windowId:e,status:t}),n&&(a=setTimeout(r.clearStatus.bind(this,e),n)))}clearStatus(e){(e=this.rerouteWindowId(e))!==o.Ex&&(clearTimeout(a),i.Z.dispatch({actionType:"STATUS_SET_STATUS",windowId:e,status:""}))}setPersistentStatus(e,t,n){(e=this.rerouteWindowId(e))!==o.Ex&&i.Z.dispatch({actionType:"STATUS_SET_PERSISTENT_STATUS",windowId:e,key:t,status:n})}clearPersistentStatus(e,t){(e=this.rerouteWindowId(e))!==o.Ex&&i.Z.dispatch({actionType:"STATUS_CLEAR_PERSISTENT_STATUS",windowId:e,key:t})}rerouteWindowId(e){return e===o.A4?s.ZP.getMailWindowId():e===o.Ex||s.ZP.isSettings(e)?s.ZP.getLastActiveBrowserWindowId():s.ZP.isTabbedBrowser(e)?e:o.Ex}},l=r},2699:(e,t,n)=>{"use strict";n.d(t,{Z:()=>k});var i=n(65792),s=n.n(i),o=n(68247),a=n(29087),r=n(19486),l=n(84990),d=n(15489),c=n(56371),h=n(7064),p=n(42151),u=n(65741),g=n(89175);const m=[g.kSystemAccentColor,g.kSystemDesktopThemeColor,g.kSystemHasDesktopWallpaperProtocol,g.kThemePrivateWindow,g.kThemeScheduleEnabled,g.kThemeScheduleOS,g.kThemeScheduleTimeline,g.kThemeUseAnimation,g.kThemesCurrent,g.kThemesPreview,g.kThemesCurrentPrivate,g.kThemesSystem,g.kThemesUser];let v;function f(e,t){s().valid(t)?l.Z.dispatch({actionType:"THEME_SET_META",tabId:e,color:s()(t)}):console.warn("Invalid meta theme color supplied for tabId",t,e)}function y(e){return r.Z.getPreview()?.id||w(e)}function w(e){if(e&&d.ZP.isIncognito(e))return a.Z.get(g.kThemesCurrentPrivate);switch(a.Z.get(g.kThemeScheduleEnabled)){case"timeline":return r.Z.getTimerByDate(new Date,"current").themeId;case"system":return a.Z.get(g.kThemeScheduleOS)[a.Z.get(g.kSystemDesktopThemeColor)];default:return a.Z.get(g.kThemesCurrent)}}function b(e){switch(a.Z.get(g.kThemeScheduleEnabled)){case"timeline":const t=(0,p.Z)(a.Z.get(g.kThemeScheduleTimeline)),n=r.Z.getTimerByDate(new Date,"current"),i=t.findIndex((e=>e.id===n.id));t[i].themeId=e,o.Z.set(g.kThemeScheduleTimeline,t);break;case"system":const s=(0,p.Z)(a.Z.get(g.kThemeScheduleOS));s[a.Z.get(g.kSystemDesktopThemeColor)]=e,o.Z.set(g.kThemeScheduleOS,s);break;default:o.Z.set(g.kThemesCurrent,e)}I()}function C(){const e=new Date,t=r.Z.getTimerByDate(e,"next");if(T(),t&&"timeline"===a.Z.get(g.kThemeScheduleEnabled)){const n=60*(t.minutes+60*t.hours-60*e.getHours()-e.getMinutes())-e.getSeconds();v=setTimeout((async()=>{const e=r.Z.getThemeWithFallback(t.themeId),n=await r.Z.getImageVars(e.backgroundImage,e.backgroundPosition);l.Z.dispatch({actionType:"THEME_SET",style:n}),C()}),1e3*n)}}async function S(){const e=a.Z.get(g.kThemeScheduleEnabled);if(["system","timeline"].includes(e)){const e=await new Promise((e=>h.Z.windowPrivate.getCurrentId(e))),t=r.Z.getThemeWithFallback(y(e)),{backgroundImage:n,backgroundPosition:i}=t,s=await r.Z.getImageVars(n,i);l.Z.dispatch({actionType:"THEME_SET",style:s})}"timeline"===e?C():T()}function T(){v&&clearTimeout(v)}function I(){a.Z.get(g.kThemesPreview)?.length>0&&o.Z.reset(g.kThemesPreview)}const k={getCurrentId:y,getCurrentIdWithoutPreview:w,createTheme:function(e){const t=(0,p.Z)(a.Z.get(g.kThemesUser)),n=(0,p.Z)(r.Z.getThemeWithFallback(e));return n.id=h.Z.utilities.generateGUID(),n.name=(0,c.Z)("$1 copy",[n.name]),t.push(n),o.Z.set(g.kThemesUser,t),b(n.id),n.id},deleteTheme:function(e){const t=(0,p.Z)(a.Z.get(g.kThemesUser)),n=(0,p.Z)(a.Z.get(g.kThemeScheduleOS)),i=(0,p.Z)(a.Z.get(g.kThemeScheduleTimeline)),s=t.findIndex((t=>t.id===e));let r;if(-1!==s){if(t[s+1])r=t[s+1].id;else if(t[s-1])r=t[s-1].id;else{const e=a.Z.get(g.kThemesSystem);r=e[e.length-1].id}if(a.Z.get(g.kThemesCurrent)===e&&o.Z.set(g.kThemesCurrent,r),[n.light,n.dark].includes(e)&&(n.dark===e&&(n.dark=r),n.light===e&&(n.light=r),o.Z.set(g.kThemeScheduleOS,n)),i.some((t=>t.themeId===e))){for(let t=0;t<i.length;t++){const n=i[t];n.themeId===e&&(n.themeId=r)}o.Z.set(g.kThemeScheduleTimeline,i)}o.Z.set(g.kThemesUser,t.filter((t=>t.id!==e)))}else console.warn(`Theme ${e} is not a user theme and cannot be deleted.`)},exportTheme:async function(e,t){await h.Z.themePrivate.export({...e,engineVersion:1},{windowId:t,dialogTitle:(0,c.Z)("Select Export Location")})},installTheme:function(){const e=(0,p.Z)(a.Z.get(g.kThemesPreview)[0]);if(e){const t=(0,p.Z)(a.Z.get(g.kThemesUser));t.push(e),o.Z.set(g.kThemesUser,t),b(e.id),I()}},updateTheme:function(){const e=a.Z.get(g.kThemesPreview)[0];if(e){const t=(0,p.Z)(a.Z.get(g.kThemesUser)),n=t.findIndex((t=>t.id===e.id));t[n]=e,o.Z.set(g.kThemesUser,t),b(e.id),I()}},clearThemePreview:I,loadFavicon:function(e,t){const n=new Image,i=e.url;n.crossOrigin="Anonymous",n.onload=()=>{n.height=16,n.width=16;const i=r.Z.getPalette(n).map((e=>s()(e)));l.Z.dispatch({actionType:"THEME_SET_PAGE_PALETTE",favIconUrl:e.favIconUrl,hostname:t,windowId:e.windowId,colors:i})},n.onerror=()=>{l.Z.dispatch({actionType:"THEME_SET_FAILED_FAVICON_URL",url:i})},n.src=e.favIconUrl},loadPromise:async function(){I();for(const[e]of d.ZP.getState()){const t=r.Z.getThemeWithFallback(y(e)),{backgroundImage:n,backgroundPosition:i}=t,s=await r.Z.getImageVars(n,i);l.Z.dispatch({actionType:"THEME_INIT",style:s,windowId:e})}C(),a.Z.addListener(m,((e,t,n)=>async function(e,t,n,i){if((0,u.default)(n,i))return;const s=r.Z.getThemeWithFallback(y(e)),o=(0,p.Z)(await r.Z.getImageVars(s.backgroundImage,s.backgroundPosition)),d=r.Z.getThemeWithFallback(a.Z.get(g.kThemesCurrentPrivate)),c=(0,p.Z)(await r.Z.getImageVars(d.backgroundImage,d.backgroundPosition));switch(t){case g.kThemeScheduleEnabled:case g.kThemeScheduleTimeline:l.Z.dispatch({actionType:"THEME_SET",style:o}),"timeline"===a.Z.get(g.kThemeScheduleEnabled)?C():T();break;case g.kThemeScheduleOS:case g.kThemesCurrent:case g.kSystemHasDesktopWallpaperProtocol:case g.kSystemDesktopThemeColor:l.Z.dispatch({actionType:"THEME_SET",style:o});break;case g.kThemesCurrentPrivate:l.Z.dispatch({actionType:"THEME_SET_PRIVATE",style:c});break;case g.kThemesSystem:case g.kThemesUser:case g.kSystemAccentColor:case g.kThemeUseAnimation:case g.kThemesPreview:l.Z.dispatch({actionType:"THEME_SET",style:o}),l.Z.dispatch({actionType:"THEME_SET_PRIVATE",style:c})}}(window.vivaldiWindowId,n,t,e))),h.Z.tabsPrivate.onThemeColorChanged.addListener(f),h.Z.utilities.onSuspend.addListener(T),h.Z.utilities.onResume.addListener(S)},revertSystemTheme:function(e){const t=(0,p.Z)(a.Z.get(g.kThemesSystem)),n=t.findIndex((t=>t.id===e)),i=a.Z.getDefault(g.kThemesSystem),s=(0,p.Z)(i.find((t=>t.id===e)));void 0!==n&&void 0!==s?(t[n]=s,o.Z.set(g.kThemesSystem,t)):console.warn(e,"is not a valid system theme id")},setNextTheme:function(){const e=a.Z.get(g.kThemesSystem),t=a.Z.get(g.kThemesUser),n=(0,p.Z)(e.concat(t));let i;switch(a.Z.get(g.kThemeScheduleEnabled)){case"timeline":i=r.Z.getTimerByDate(new Date,"current").themeId;break;case"system":const e=a.Z.get(g.kThemeScheduleOS),t=a.Z.get(g.kSystemDesktopThemeColor);i=e[t];break;default:i=a.Z.get(g.kThemesCurrent)}const s=n.findIndex((e=>e.id===i));b(n[s+1]?n[s+1].id:n[0].id)},setPreviousTheme:function(){const e=a.Z.get(g.kThemesSystem),t=a.Z.get(g.kThemesUser),n=(0,p.Z)(e.concat(t));let i;switch(a.Z.get(g.kThemeScheduleEnabled)){case"timeline":i=r.Z.getTimerByDate(new Date,"current").themeId;break;case"system":const e=a.Z.get(g.kThemeScheduleOS),t=a.Z.get(g.kSystemDesktopThemeColor);i=e[t];break;default:i=a.Z.get(g.kThemesCurrent)}const s=n.findIndex((e=>e.id===i));b(n[s-1]?n[s-1].id:n[n.length-1].id)},setTheme:b,setThemeBackgroundImageFromUrl:function(e,t){const n=w(e);t.startsWith("file:")?h.Z.utilities.storeImage({themeId:n,url:t}):fetch(t).then((e=>e.blob())).then((e=>{e.arrayBuffer().then((t=>{h.Z.utilities.storeImage({themeId:n,mimeType:e.type,data:t})}))}))},setThemeByNameWithFallback:function(e){const t=a.Z.get(g.kThemesSystem),n=a.Z.get(g.kThemesUser),i=t.concat(n).find((t=>t?.name===e))?.id;i?b(i):console.warn((0,c.Z)("Unable to find a theme named $1",[e]))}}},32773:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(84990);class s{static edit(e){i.Z.dispatch({actionType:"TOOLBAR_EDIT_MODE",toolbar:e})}static stopEditing(){i.Z.dispatch({actionType:"TOOLBAR_STOP_EDIT_MODE"})}}},65810:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(84990);const s=(e,t)=>t?setTimeout(e,t):e();let o;const a=new class{showTooltip(e,t=0){clearTimeout(o),o=s((()=>i.Z.dispatch({actionType:"TOOLTIP_SET",id:e})),t)}hideTooltip(e=0){clearTimeout(o),o=s((()=>i.Z.dispatch({actionType:"TOOLTIP_SET",id:null})),e)}}},54058:(e,t,n)=>{"use strict";n.d(t,{Z:()=>f});var i=n(5198),s=n(63353),o=n(18350),a=n(29087),r=n(37330),l=n(19486),d=n(85374),c=n(84990),h=n(15489),p=n(92292),u=n(12467),g=n(7064),m=n(89175);const v={translateSelection(e,t){i.Z.detectTextLanguage(e,t).then((n=>{if(a.Z.get(m.kPanelsTranslateRedirect)){if(!n){n=d.Z.getPageState(e).pageLanguage||""}const i=s.Z.getPageById(e)?.windowId;i&&o.Z.translateWithPanel(i,n,t)}else{let s=(0,u.Z)();s=s.substring(0,2);const o=i.Z.getTranslationCode(s);p.Z.tabs.sendMessage(e,{action:"translateSelection",tabId:e,text:t,textLanguage:n,destLanguage:i.Z.getTranslationCode(o),allLanguages:i.Z.getTranslationLocales()},(()=>{}))}}))},async sendInitDataToInjectedScript(e,t){let n=(0,u.Z)();n=n.substring(0,2);const o=i.Z.getTranslationCode(n),d=await g.Z.utilities.getCommandLineValue("translate-server-url");d&&console.warn("Translate server overridden: "+d);const c=s.Z.getPageById(e)?.windowId,h=c?r.Z.getState().windowStyles.get(c):l.Z.getFallbackStyle();p.Z.tabs.sendMessage(e,{action:"initData",tabId:e,pageLanguage:i.Z.getTranslationCode(t),destLanguage:i.Z.getTranslationCode(o),allLanguages:i.Z.getTranslationLocales(),buttonEnabled:a.Z.get(m.kWebpagesTranslateSelectionButtonEnabled),resultInPanel:a.Z.get(m.kPanelsTranslateRedirect),styles:h,overrideServer:d},(()=>{p.Z.runtime.lastError}))},sendTextLanguageToInjectedScript(e,t){p.Z.tabs.sendMessage(e,{action:"textLanguage",tabId:e,textLanguage:t,textLanguageName:i.Z.getHumanReadableLanguageFromCode(t)},(()=>{}))},init(){g.Z.tabsPrivate.onShowTranslationUI.addListener(((e,t,n,i)=>{c.Z.dispatch({actionType:"VIVALDI_TABS_TRANSLATION_PROGRESS",tabId:e,translateStep:t,error:n,autoTranslate:i})})),v.dispatchLanguageChanges(),a.Z.addListener(m.kVivaldiTranslateLanguageList,(()=>{v.dispatchLanguageChanges()})),p.Z.runtime.onMessage.addListener((function(e,t,n){if("translateSelectionReady"===e.action){const t=e.tabId,i=d.Z.getPageState(t);return v.sendInitDataToInjectedScript(t,i.pageLanguage?i.pageLanguage:""),n(),!0}if("translateDetermineLanguage"===e.action){const t=e.tabId;i.Z.detectTextLanguage(t,e.text).then((e=>{v.sendTextLanguageToInjectedScript(t,e)}))}else if("translateResult"===e.action){const t=s.Z.getPageById(e.tabId)?.windowId;t&&h.ZP.isActive(t)&&g.Z.translateHistory.add(e.item,0)}else if("translateInPanel"===e.action){const t=s.Z.getPageById(e.tabId)?.windowId;t&&o.Z.translateWithPanel(t,e.lang,e.text)}return!1}))},dispatchLanguageChanges(){const e=a.Z.get(m.kVivaldiTranslateLanguageList);e.length>0&&(i.Z.invalidateTranslationLocales(),c.Z.dispatch({actionType:"VIVALDI_SET_SERVER_LANGUAGES",languages:e}))},setDeterminedLanguage(e,t){c.Z.dispatch({actionType:"VIVALDI_TABS_LANGUAGE_DETERMINED",tabId:e,pageLanguage:t}),v.sendInitDataToInjectedScript(e,t)},setPageTranslated(e,t){c.Z.dispatch({actionType:"VIVALDI_TABS_PAGE_TRANSLATED",tabId:e,message:t})},revertTranslation(e){c.Z.dispatch({actionType:"VIVALDI_TABS_PAGE_TRANSLATED_REVERT",tabId:e})},resetTranslationParameters(e){c.Z.dispatch({actionType:"PAGE_RESET_TRANSLATION_PARAMETERS",tabId:e})},async translatePage(e){let t=(0,u.Z)();t=t.substring(0,2);const n=i.Z.getTranslationCode(t),s=d.Z.getPageState(e);n&&s&&await g.Z.tabsPrivate.translatePage(e,s.pageLanguage?s.pageLanguage:"auto",n)}},f=v},76501:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var i=n(53576),s=n(63365),o=n(84990),a=n(92292),r=n(75256),l=n(7064);const d=new class{emptyTrash(){l.Z.utilities.clearAllRecentlyClosedSessions()}undeleteTab(e){return new Promise(((t,n)=>{const s=JSON.parse(e.vivExtData||"{}").ext_id;i.Z.setIsRestored(s,!0),a.Z.sessions.restore(e.sessionId,(i=>{a.Z.runtime.lastError&&(console.warn("Error restoring tab: ",e,a.Z.runtime.lastError),n()),t()}))}))}async undeletePreviousTab(){const e=s.Z.getTrash().find((e=>e.tab));e?.tab&&await d.undeleteTab(e.tab)}undeleteWindow(e){a.Z.sessions.restore(e.sessionId,(t=>{a.Z.runtime.lastError&&console.warn("Error restoring page: ",e,a.Z.runtime.lastError.message)}))}loadPromise(){return new Promise(((e,t)=>a.Z.sessions.getRecentlyClosed((t=>{a.Z.windows.getAll({},(n=>{const i=t.filter((e=>{if(e.tab)return!0;if(!e.window)return!1;let t=!0;const i=(0,r.Z)(e.window.vivExtData);for(let e=0;e<n.length;e++){if(t=(0,r.Z)(n[e].vivExtData).ext_id!==i.ext_id,!t)break}return t}));o.Z.dispatch({actionType:"CHROME_SET_SESSION",session:i}),e()}))}))))}};a.Z.sessions.onChanged.addListener(d.loadPromise);const c=d},90349:(e,t,n)=>{"use strict";n.d(t,{Z:()=>S});var i=n(53576),s=n(29087),o=n(39206),a=n(10589),r=n(84990),l=n(15672),d=n(15489),c=n(92292);const h=function(e){const t=e.replace(/^.*?\:\/\//,"");return!!t.includes('"')&&(!t.includes("/")||t.indexOf('"')<t.indexOf("/"))};var p=n(7064),u=n(36436),g=n(86662),m=n(89175),v=n(34155);async function f({windowId:e,url:t,options:n}){await i.Z.openURL(e,t.replace(/ /g,"%20"),{inCurrent:!n.hasOwnProperty("inBackground"),...n})}function y(e,t,n){n&&a.Z.addTypedSearchHistory(e,t)}function w({url:e}){v.nextTick((()=>{r.Z.dispatch({actionType:"URLFIELD_TYPED_HISTORY_UPDATE"})}))}async function b(e,t,n={}){const i=t,{addTypedSearchHistory:s,enableSearch:a,allowOverride:r,useSearchEngine:l,...c}=n;if(l){y(e,i,s);const{url:t,contentType:n,postParams:o}=await p.Z.searchEngines.getSearchRequest(l.id,i);return{url:t,options:{...c,postParams:o,contentType:n,transition:p.Z.historyPrivate.TransitionType.GENERATED}}}const h=o.Z.getByQuery(i);if(h){const t=i.substr(h.keyword.length+1),{url:n,contentType:o,postParams:a}=await p.Z.searchEngines.getSearchRequest(h.id,t);return y(e,t,s),{url:n,options:{...c,postParams:a,contentType:o,transition:p.Z.historyPrivate.TransitionType.KEYWORD}}}const u=o.Z.getDefault(d.ZP.isIncognito(e));if(u){const{url:t,contentType:n,postParams:o}=await p.Z.searchEngines.getSearchRequest(u.id,i);return y(e,i,s),{url:t,options:{...c,postParams:o,contentType:n,transition:p.Z.historyPrivate.TransitionType.GENERATED}}}return{url:t,options:{...c}}}async function C(e,t,n){if(function(e){const t=e.split(" ");return t.length>=2&&void 0!==o.Z.getByKeyword(t[0])}(t))return b(e,t,n);const{addTypedSearchHistory:i,enableSearch:s,allowOverride:a,useSearchEngine:r,...l}=n,d=t.trimEnd().replace(/^https:\/(?!\/)/i,"https://").replace(/^https:\/{3,}/i,"https://").replace(/^http:\/(?!\/)/i,"http://").replace(/^http:\/{3,}/i,"http://"),{urlValid:c,isBrowserUrl:m,schemeParsed:v,normalizedUrl:f}=p.Z.utilities.isUrlValid(d);if((0,g.A)(d)){const e=(0,u.q9)(d);return Promise.resolve({url:e,options:l})}const y=c&&m&&("http"===v||"https"===v)||""===v||!f,w=/\s/.test(d),C=w&&/^(\w{1,}\:(\/\/)?)?(\w{1,}(\.\w{1,})?(:\d{1,5})?[/?#])/.test(d),S=/\.(.{2,})(\/)/.test(d.split(" ")[0]),T=/^([a-zA-Z0-9\-\._~!$&'()\*+,;=%]*(:[a-zA-Z0-9\-\._~!$&'()\*+,;=%]*)?)?@\S*/.test(d),I=/^[^/^ ]{1,}:(\/\/)?[^/^ ]{1,}(\/|\?|#)/.test(d);let k;function A(){return k||(k=p.Z.utilities.canOpenUrlExternally(d)),k}const Z=function(e){if(!e.includes(":"))return!1;if(e.includes(" ")&&e.indexOf(" ")<e.indexOf(":"))return!1;try{const t=parseInt(e.split(":")[1].split("/")[0]);return t>=0&&t<=65535}catch(e){return!1}}(d);if(n.enableSearch&&!I&&!T&&!S&&!Z&&(y&&w&&!C||""!==v&&!m&&!await A()))return b(e,d,n);if(c&&(m||await A()))return Promise.resolve({url:d,options:l});const E=d.startsWith("?");if(E||(0,u.HZ)(d)||n.enableSearch&&h(d))return b(e,E?d.substr(1):d,n);const _=(0,u.q9)(d),N=/[a-z]+\/$/.test(d),M=/(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}/.test(d),P=p.Z.utilities.getUrlFragments(_),D=Boolean(P.tld);if(n.enableSearch&&!M&&!D&&!N)return b(e,d,n);try{return new URL(_),Promise.resolve({url:_,options:l})}catch(t){return n.enableSearch?b(e,d,n):Promise.resolve({url:"vivaldi://network-error/-300",options:l})}}c.Z.history.onVisitRemoved.addListener((function(e){r.Z.dispatch({actionType:"URLFIELD_TYPED_HISTORY_UPDATE"}),e&&e.allHistory&&r.Z.dispatch({actionType:"NAVIGATION_HISTORY_ALL_DELETED"})}));const S={clearUrlfieldState:function(e){r.Z.dispatch({actionType:"URLFIELD_CLEAR_STATE",pageId:e})},setUrlfieldState:function(e,t){r.Z.dispatch({actionType:"URLFIELD_SET_STATE",pageId:e,state:t})},clearSelection:function(e){r.Z.dispatch({actionType:"URLFIELD_SET_STATE",state:{selectionStart:-1,selectionEnd:-1},pageId:e})},goSearchURL:async function(e,t,n){const{url:i,options:s}=await b(e,t,n);i&&await f({windowId:e,url:i,options:s})},deleteHistory:function(e){r.Z.dispatch({actionType:"URLFIELD_HISTORY_DELETE",url:e})},copyUrlfieldState:function(e,t){r.Z.dispatch({actionType:"URLFIELD_COPY_STATE",pageId:e,state:t})},go:async function(e,t,n){await Promise.all(t.map(((i,s)=>{const o=i.trimStart();if(!o)return Promise.resolve();const a={...n};return t.length>1&&(a.inBackground=s!==t.length-1),C(e,o,a).then((({url:t,options:n})=>f({windowId:e,url:t,options:n})))})))},migrateTypedHistory:function(){v.nextTick((()=>{let e;try{e=JSON.parse(l.Z.getSync("TYPED_HISTORY"))}catch(e){return}if(!e||!e.h)return;const t=p.Z.historyPrivate.TransitionType.TYPED,n=s.Z.get(m.kAddressBarInlineSearchEnabled);e.h.forEach((e=>C(d.Ex,e.u,{enableSearch:n,transition:t}).then((({url:n,options:i})=>{p.Z.historyPrivate.migrateOldTypedUrl(n,e.w,i.transition||t)})))),l.Z.remove("TYPED_HISTORY")})),c.Z.history.onVisited.addListener(w),r.Z.dispatch({actionType:"URLFIELD_TYPED_HISTORY_UPDATE"})}}},83526:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i=n(30626),s=n(9185),o=n(63353),a=n(84990),r=n(57904);const l=new class{doAction(e,t,n,i){a.Z.dispatch({actionType:"WEBPAGEVIEW_ACTIONS",windowId:e,pageId:t,subAction:n,...i?{payload:i}:null})}findInPage(e,t,n,s){const o=i.Z.getActiveWebView(e);if(o){const i={findNext:!1,matchCase:s||!1};o.find(n,i,this._findCallback.bind(this,e,t,n,s))}}findNextInPage(e,t,n,s,o){const a=i.Z.getActiveWebView(e);if(a){const i={backward:s||!1,findNext:!0,matchCase:o||!1};a.find(n,i,this._findCallback.bind(this,e,t,n,o))}}_findCallback(e,t,n,i,s){s&&!s.canceled&&a.Z.dispatch({actionType:"WEBPAGEVIEW_RESULTS_FROM_FIND_IN_PAGE",windowId:e,pageId:t,searchText:n,matchCase:i,results:s})}closeFindInPageToolbar(e,t){return!0===r.Z.isFindInPageOpen(t)&&(a.Z.dispatch({actionType:"WEBPAGEVIEW_CLOSE_FIND_IN_PAGE",windowId:e,pageId:t}),!0)}go(e,t,n){a.Z.dispatch({actionType:"WEBPAGEVIEW_GO",windowId:e,pageId:t,index:n||0})}back(e,t){o.Z.getPageInWindow(e,t)?.isMailPage?s.Z.pageBack(e):a.Z.dispatch({actionType:"WEBPAGEVIEW_BACK",windowId:e,pageId:t})}forward(e,t){o.Z.getPageInWindow(e,t)?.isMailPage?s.Z.pageForward(e):a.Z.dispatch({actionType:"WEBPAGEVIEW_FORWARD",windowId:e,pageId:t})}getPageHistory(e,t,n){a.Z.dispatch({actionType:"WEBPAGEVIEW_GET_HISTORY",windowId:e,pageId:t,callback:n})}stop(e,t){a.Z.dispatch({actionType:"WEBPAGEVIEW_STOP",windowId:e,pageId:t})}reload(e,t,n){a.Z.dispatch({actionType:"WEBPAGEVIEW_RELOAD",windowId:e,pageId:t,bypassCache:n})}}},63153:(e,t,n)=>{"use strict";n.d(t,{Z:()=>S});var i=n(63353),s=n(68247),o=n(29087),a=n(60331),r=n(84990),l=(n(15672),n(15489)),d=n(56371),c=n(92292),h=n(62830),p=n.n(h),u=n(75256),g=n(7064),m=n(44850),v=n(89175),f=n(34155);function y(){0}function w(e,t){r.Z.dispatch({actionType:"WINDOW_STATE_CHANGED",windowId:e,state:t})}function b(e,t){r.Z.dispatch({actionType:"WINDOW_ACTIVATED",windowId:e,activated:t}),g.Z.utilities.broadcastMessage({windowActiveStateChanged:{windowId:e,activated:t}})}function C(e,t,n,i){l.ZP.isMinimalUI(e)||r.Z.dispatch({actionType:"WINDOW_UPDATE_FROM_PREFS",windowId:e})}const S=new class{constructor(){g.Z.windowPrivate.onStateChanged.addListener(w),g.Z.windowPrivate.onActivated.addListener(b)}minimize(e){g.Z.windowPrivate.setState(e,"minimized"),r.Z.dispatch({actionType:"WINDOW_STATE_CHANGED",windowId:e,state:"minimized"})}minimizeAll(){g.Z.utilities.broadcastMessage({minimizeAll:!0})}maximize(e){g.Z.windowPrivate.setState(e,"maximized"),r.Z.dispatch({actionType:"WINDOW_STATE_CHANGED",windowId:e,state:"maximized"})}restore(e){g.Z.windowPrivate.setState(e,"normal"),r.Z.dispatch({actionType:"WINDOW_STATE_CHANGED",windowId:e,state:"normal"})}setFullscreen(e){g.Z.windowPrivate.setState(e,"fullscreen"),r.Z.dispatch({actionType:"WINDOW_STATE_CHANGED",windowId:e,state:"fullscreen"})}toggleFullscreen(e){if(l.ZP.isFullscreen(e)){const t=l.ZP.getRestoreStateFullscreen(e);g.Z.windowPrivate.setState(e,t),r.Z.dispatch({actionType:"WINDOW_STATE_CHANGED",windowId:e,state:t})}else this.setFullscreen(e)}restoreStateAfterHTMLFullscreen(e){const t=l.ZP.getRestoreStateHtml5Fullscreen(e);g.Z.windowPrivate.setState(e,t),r.Z.dispatch({actionType:"WINDOW_STATE_CHANGED",windowId:e,state:t})}async close(e){return function(e){return new Promise((t=>c.Z.windows.remove(e,t)))}(e)}onHTML5FullScreen(e,t){if(e)g.Z.windowPrivate.setState(t,"fullscreen");else{const e=l.ZP.getRestoreStateHtml5Fullscreen(t);g.Z.windowPrivate.setState(t,e)}r.Z.dispatch({actionType:"WINDOW_HTML5_FULL_SCREEN",windowId:t,html5FullScreen:e})}toggleMinimalUI(e){r.Z.dispatch({actionType:"WINDOW_MINIMAL_UI",windowId:e,minimalUI:!l.ZP.isMinimalUI(e)})}toggleBookmarksBar(e){l.ZP.isMinimalUI(e)?r.Z.dispatch({actionType:"WINDOW_TOGGLE_BOOKMARKS_BAR",windowId:e}):l.ZP.isGuestSession(e)||s.Z.toggle(v.kBookmarksBarVisible,!0,!1)}toggleAddressBar(e){l.ZP.isMinimalUI(e)?r.Z.dispatch({actionType:"WINDOW_TOGGLE_ADDRESS_BAR",windowId:e}):s.Z.toggle(v.kAddressBarVisible,!0,!1)}toggleTabs(e){l.ZP.isMinimalUI(e)?r.Z.dispatch({actionType:"WINDOW_TOGGLE_TABS",windowId:e}):s.Z.toggle(v.kTabsVisible,!0,!1)}togglePanelToggle(e){l.ZP.isMinimalUI(e)?r.Z.dispatch({actionType:"WINDOW_TOGGLE_PANEL_TOGGLE",windowId:e}):s.Z.toggle(v.kPanelsShowToggle,!0,!1)}toggleStatusBar(e){l.ZP.isMinimalUI(e)?r.Z.dispatch({actionType:"WINDOW_TOGGLE_STATUS_BAR",windowId:e}):(s.Z.toggle(v.kStatusBarDisplay,"on",o.Z.get(v.kStatusBarMinimized)),f.nextTick((()=>{"overlay"===o.Z.get(v.kStatusBarDisplay)&&a.Z.setStatus(e,(0,d.Z)("Status Info set to Overlay"),2e3)})))}openWindow(e,t,n,s){const a={incognito:!1,...s};if(a.tabUrl)a.tabUrl=(0,m.Gr)(a.tabUrl);else{const t=o.Z.get(v.kIncognitoShowIntro);a.tabUrl=a.incognito&&t?m.xy["private-intro"]:i.Z.getDefaultStartpage(e)}return a.vivExtData=JSON.stringify({ext_id:p()(),windowType:n,...a.vivExtData?JSON.parse(a.vivExtData):null}),y(),new Promise((e=>{g.Z.windowPrivate.create(t,a,n,(t=>{let n;if(-1!==t){const e=c.Z.extension.getViews({windowId:t});e&&e.length>0&&(n=e[0])}e({windowId:t,contentWindow:n})}))}))}openBrowserWindow(e,t,n={},s="normal"){"string"==typeof t&&(t=(0,m.Gr)(t));const a=l.ZP.isMaximized(e),r={url:t,incognito:!1,transition:g.Z.historyPrivate.TransitionType.AUTO_TOPLEVEL,...n},d={ext_id:p()(),windowType:s,...n.vivExtData?JSON.parse(n.vivExtData):null};if(r.vivExtData=JSON.stringify(d),y(),void 0===r.url){const t=o.Z.get(v.kIncognitoShowIntro);r.url=r.incognito&&t?m.xy["private-intro"]:i.Z.getDefaultStartpage(e)}return new Promise(a?e=>{c.Z.windows.create(r,(t=>{t&&t.id&&g.Z.windowPrivate.setState(t.id,"maximized"),e(t)}))}:e=>c.Z.windows.create(r,e))}openIncognitoWindow(e,t){return this.openBrowserWindow(e,t,{incognito:!0})}__initForTests(){window.vivaldiWindowId=42,r.Z.dispatch({actionType:"WINDOW_SET_STATE",windowState:{active:!0,state:"maximized",restoreStateFullscreen:"normal",restoreStateHtml5Fullscreen:"normal",fullscreenMenubarShown:!1,guest:!1,html5FullScreen:!1,incognito:!1,nativeDecorations:!1,minimalUI:!1,type:"normal",visibleUI:{addressBar:!1,bookmarksBar:!1,panelToggle:!1,tabs:!0,statusBar:"on"}},windowId:42})}async loadPromise(){const e=await g.Z.windowPrivate.getCurrentId();window.vivaldiWindowId=e,o.Z.addListener([v.kAddressBarVisible,v.kBookmarksBarVisible,v.kPanelsShowToggle,v.kStatusBarDisplay,v.kTabsVisible],C.bind(null,window.vivaldiWindowId));const t=await g.Z.runtimePrivate.isGuestSession(e),n=await c.Z.windows.getAll({populate:!0,windowTypes:["normal","popup"]});for(const i of n){const n=i.id;if("number"!=typeof n)continue;const s=(0,u.Z)(i.vivExtData),a=e===n?t:await g.Z.runtimePrivate.isGuestSession(n),d=s.windowType?s.windowType:"normal",c={active:i.focused,state:"locked-fullscreen"===i.state?"normal":i.state,restoreStateFullscreen:"maximized"===i.state?"maximized":"normal",restoreStateHtml5Fullscreen:"normal",fullscreenMenubarShown:!1,guest:a,html5FullScreen:!1,incognito:i.incognito&&!t,minimalUI:s.minimalUI,nativeDecorations:o.Z.get(v.kWindowsUseNativeDecoration),type:d,visibleUI:l.ZP.getUIFromPrefs()};s.visibleUI&&(0,l.TF)(c)&&(c.visibleUI=s.visibleUI),e===n&&("fullscreen"===c.state&&(o.Z.get(v.kStartupRememberFullScreen)?g.Z.windowPrivate.setState(e,"fullscreen"):c.state="normal"),g.Z.utilities.broadcastMessage({windowAdded:{windowId:e,windowState:c}}),"object"==typeof s.tiles&&r.Z.dispatch({actionType:"TILE_INITIALIZED",tilesState:s.tiles})),r.Z.dispatch({actionType:"WINDOW_SET_STATE",windowState:c,windowId:n})}}}},22303:(e,t,n)=>{"use strict";n.d(t,{Z:()=>v});var i=n(30626),s=n(63353),o=n(29087),a=n(60331),r=n(84990),l=n(47825),d=n(56371),c=n(7064),h=n(71828),p=n(89175),u=n(44850);const g=new class{async setUIZoomPercentage(e){await g.setUIZoom(e/100)}async setUIZoom(e){const t=Math.min(Math.max(e,h.bI),h.OK);await c.Z.zoom.setVivaldiUIZoom(t)}setPageZoomPercentage(e,t){g.setPageZoom(e,t/100)}setPageZoom(e,t){const n=Math.min(Math.max(t,h.XF),h.qt);(s.Z.getActivePage(e)?.url??"").startsWith(u.jk.internals.notes)?r.Z.dispatch({actionType:"ZOOM_NOTES",zoomData:n}):r.Z.dispatch({actionType:"ZOOM_PAGE",zoomData:n});const l=i.Z.getActiveWebView(e);l&&(l.setZoom(n),"overlay"!==o.Z.get(p.kStatusBarDisplay)&&o.Z.get(p.kToolbarsStatus).includes("Zoom")||a.Z.setStatus(e,(0,d.Z)("Page Zoom $1%",[Math.round(100*n)]),2e3))}async uiZoomIn(){const{uiZoom:e}=l.Z.getState(),t=parseFloat(e+h.pL);await g.setUIZoom(t)}async uiZoomOut(){const{uiZoom:e}=l.Z.getState(),t=parseFloat(e-h.pL);await g.setUIZoom(t)}async pageZoomIn(e){const t=await g.getActiveZoom(e);g.setPageZoom(e,parseFloat((t+h.Zh).toFixed(2)))}async pageZoomOut(e){const t=await g.getActiveZoom(e);g.setPageZoom(e,parseFloat((t-h.Zh).toFixed(2)))}async pageZoomHalf(e){const t=await g.getActiveZoom(e);g.setPageZoom(e,parseFloat((t/2).toFixed(2)))}async pageZoomReset(e){const t=await c.Z.zoom.getDefaultZoom();g.setPageZoom(e,t)}async pageZoomDouble(e){const t=await g.getActiveZoom(e);g.setPageZoom(e,parseFloat((2*t).toFixed(2)))}getActiveZoom(e){return new Promise((t=>{const n=i.Z.getActiveWebView(e);n?n.getZoom((e=>{t(e)})):t(h.rM)})).then((e=>e))}dispatchZoomUI(e){r.Z.dispatch({actionType:"ZOOM_SET_UI",zoomData:e})}};function m(e){r.Z.dispatch({actionType:"ZOOM_PAGE_DEFAULT",zoomData:e})}c.Z.zoom.getVivaldiUIZoom((e=>{g.dispatchZoomUI(e)})),c.Z.zoom.onUIZoomChanged.addListener((e=>{g.dispatchZoomUI(e)})),c.Z.zoom.getDefaultZoom(m),c.Z.zoom.onDefaultZoomChanged.addListener(m);const v=g},82882:(e,t,n)=>{"use strict";n(44620);var i=n(48603),s=n(15590),o=n(61757),a=n(47995),r=n(27033),l=n(84990),d=n(7064),c=n(29489);function h(){const e=r.Z.getScripts();p((({scripts:t})=>{const n=e.filter((e=>!t.includes(e))).map((e=>function(e){return`COMMAND_${(0,c.gD)(e).toUpperCase()}`.replace(/\s+/g,"_")}(e)));l.Z.dispatch({actionType:"CONTENT_SCRIPTS_UPDATED",updated:n,scripts:t})}))}function p(e){d.Z.pageActions.getScripts((t=>{const n=t.map((e=>`COMMAND_${(0,c.gD)(e)}`.toUpperCase().replace(/\s+/g,"_")));e({scriptNames:n,scripts:t})}))}const u={loadPromise:function(){return d.Z.pageActions.onScriptsChanged.addListener(h),new Promise((e=>{p((({scriptNames:t,scripts:n})=>{l.Z.dispatch({actionType:"CONTENT_SCRIPTS_INITIALIZE",scripts:n}),e()}))}))}};var g=n(83784),m=n(87210),v=n(31186),f=n(15672),y=n(92292),w=n(30381),b=n.n(w);let C=!1;const S=[];function T(){const e=b()().startOf("date"),t=b()().endOf("date");return new Promise((n=>{d.Z.historyPrivate.visitSearch({startTime:e.valueOf(),endTime:t.valueOf()},(e=>{l.Z.dispatch({actionType:"HISTORY_LOAD_TODAY",items:e}),n()}))}))}function I(e){for(;e.timeRemaining()>0&&S.length>0;){const e=S.pop();e.length>0&&l.Z.dispatch({actionType:"HISTORY_LOAD_YESTERDAY_AND_OLDER",items:e}),S.length>0&&requestIdleCallback(I)}}const k=new class{loadPromise(){return T().then((()=>{l.Z.dispatch({actionType:"HISTORY_INIT"});const e="HISTORY_"+v.Z.getPanelResourceKey(),t=f.Z.getSync(e);t&&l.Z.dispatch({actionType:"HISTORY_INIT_FILTER",id:v.Z.getPanelResourceKey(),setting:t}),y.Z.history.onVisited.addListener(T)}))}loadAll(){if(!C){C=!0;const e="month",t=b()().subtract(1,"d").endOf("d"),n=36,i=[],s=b()().subtract(n+1,e).endOf(e),o=b()("1970-01-01");i.push({e:s.valueOf(),s:o.valueOf()});for(let s=n;s>=0;s--){const n=b()(t).subtract(s,e).endOf(0===s?"d":e),o=b()(n).startOf(e);i.push({e:n.valueOf(),s:o.valueOf()})}i.forEach((e=>{d.Z.historyPrivate.visitSearch({startTime:e.s.valueOf(),endTime:e.e.valueOf()},(e=>{e.length>0&&(S.push(e),requestIdleCallback(I))}))}))}}deleteHistoryPromise(e){return l.Z.dispatch({actionType:"HISTORY_REMOVE_VISITS",visits:e}),Promise.all(e.map((e=>new Promise((t=>{const n=b()(e.at);let i={startTime:b()(n.startOf("day")).valueOf(),endTime:b()(n.endOf("day")).valueOf()};e.isFolder?y.Z.history.deleteRange(i,(()=>{t()})):(i={...i,url:e.url||""},d.Z.historyPrivate.deleteVisits(i,(()=>{t()})))})))))}removeLocalHistory(e){b()(e).isSame(b()(),"day")?T():l.Z.dispatch({actionType:"HISTORY_REMOVE_AFTER",since:e})}searchHistory(e,t){l.Z.dispatch({actionType:"HISTORY_SEARCH",filter:t,id:e})}saveStateFromSearchQuery(e,t){v.Z.isPanel(e)?f.Z.set({["HISTORY_"+e]:{rangePicker:t.rangePicker,startTime:t.startTime.valueOf(),endTime:t.endTime.valueOf()}}):f.Z.set({HISTORY_MANAGER_STATE:{displayMode:t.displayMode,startTime:t.startTime.valueOf(),endTime:t.endTime.valueOf(),dayPickerVisible:t.dayPickerVisible,moreInfoVisible:t.moreInfoVisible,monthEntriesVisible:t.monthEntriesVisible}})}},A=k;var Z=n(24602),E=n(18172);class _ extends Z.Z{getInitialState(){return{lights:new Map,groups:new Map}}reduce(e,t){return"HUE_LIGHTS_UPDATE"===t.actionType?(0,E.ZP)(e,(e=>(e.groups=t.groups,e.lights=t.lights,e))):"HUE_LIGHTS_SET"===t.actionType?(0,E.ZP)(e,(t=>e||t)):e}}const N=new _;var M=n(29087),P=n(37330),D=n(89175);const x=[D.kHueBridgeIp,D.kHueEnabled,D.kHueLights,D.kHueUsername];async function O(){const e=M.Z.get(D.kHueBridgeIp),t=M.Z.get(D.kHueUsername);if(!e||!t)return void l.Z.dispatch({actionType:"HUE_LIGHTS_UPDATE",groups:new Map,lights:new Map});const n=await fetch(`http://${e}/api/${t}/lights`);n.ok||console.warn(`Unable to retrieve lights from bridge at ${e}`);const i=await n.json(),s=new Map(Object.entries(i)),o=await fetch(`http://${e}/api/${t}/groups`);o.ok||console.warn(`Unable to retrieve lights from bridge at ${e}`);const a=await o.json(),r=new Map(Object.entries(a));for(const[e,t]of r){t.lights.map((e=>s.get(e))).some((e=>e?.capabilities?.control?.colorgamuttype))||r.delete(e)}l.Z.dispatch({actionType:"HUE_LIGHTS_UPDATE",groups:r,lights:s})}function L(){const e=M.Z.get(D.kHueBridgeIp),t=M.Z.get(D.kHueUsername),n=M.Z.get(D.kHueLights);if(!e||!t||!n)return;const i=function(e){let t=e.get("rgb.r"),n=e.get("rgb.g"),i=e.get("rgb.b");t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92,n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/13.02,i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92;const s=.664511*t+.154324*n+.162028*i,o=.283881*t+.668433*n+.047685*i,a=88e-6*t+.07231*n+.986039*i;return[s/(s+o+a),o/(s+o+a)]}(P.Z.getState().browserColor),s=`http://${e}/api/${t}`;for(const[e,t]of N.getState().lights)n.includes(t.uniqueid)&&fetch(`${s}/lights/${e}/state/`,{method:"put",body:JSON.stringify({transitiontime:3,xy:i})}).catch((e=>{console.warn("Unable to set Hue light",t.name,e)}))}async function R(e,t,n){switch(n){case D.kHueEnabled:await O(),t?(L(),P.Z.ensureAddedListener(L)):P.Z.ensureRemovedListener(L);break;case D.kHueLights:l.Z.dispatch({actionType:"HUE_LIGHTS_SET",lights:t})}}const B={loadPromise:async function(){M.Z.get(D.kHueEnabled)&&(P.Z.ensureAddedListener(L),await O(),L()),M.Z.addListener(x,R)},updateLights:O,flash:function(e){const t=M.Z.get(D.kHueBridgeIp),n=M.Z.get(D.kHueUsername);fetch(`http://${t}/api/${n}/lights/${e}/state`,{method:"put",body:JSON.stringify({alert:"select"})})}};var F=n(19789),U=n(88083),V=n(45502),W=n(63353),H=n(32921),z=n(15489),G=n(76747),$=n(9414);var K=n(4660),j=n(9185),Y=n(53576),X=n(60331),Q=n(1407);const q={contact:K.Z,mail:j.Z,page:Y.Z,status:X.Z};function J(e){if(e.origin!==Q.oP||!e.data||!e.data.actions)return;const{actionType:t,action:n,args:i}=e.data.actions,s=q[t];if(!s)throw new Error("Action creator not found for action type "+t);if("function"!=typeof s[n])throw new Error("Action "+s+"."+n+" not found");s[n](...i)}var ee=n(21754),te=n(68884),ne=n(2431),ie=n(46382);const se={};let oe=0;const ae={checkForMail:function(e){return re("checkForMail",[...arguments])},deletePopMail:function(e,t){return re("deletePopMail",[...arguments])},getPopMessage:function(e,t,n){return re("getPopMessage",[...arguments])},setCheckInterval:function(e,t){return re("setCheckInterval",[...arguments])},verifyPopLogin:function(e){return re("verifyPopLogin",[...arguments])}};function re(e,t){return new Promise(((n,i)=>{const s=oe++;se[s]={resolve:n,reject:i};const o={promiseId:s,func:e,args:t};navigator.serviceWorker?.ready.then((e=>e.active?.postMessage({pop:o})))}))}navigator.serviceWorker?.addEventListener("message",(function(e){if(e.origin!==Q.oP)return;const{pop:t}=e.data;if(t){const{promiseId:e,results:n,error:i}=t,{resolve:s,reject:o}=se[e];delete se[e],i?o(new Error(i)):s(n)}}),!1);var le=n(56371),de=n(45660),ce=n(5204),he=n(36809),pe=n(51370),ue=n(5863);const ge=/\b(?:https?:\/\/|ftp:\/\/|www\.)\S+/gi;function me(e,t,n){let i="";for(;e.endsWith(".")||e.endsWith(":");)i=e[e.length-1]+i,e=e.substr(0,e.length-1);"&lt;"===n.substr(t-4,4)&&e.endsWith("&gt;")?(i="&gt;"+i,e=e.substr(0,e.length-4)):[["(",")"],["[","]"]].forEach((([s,o])=>{n[t-1]===s&&e.endsWith(o)&&(i=o+i,e=e.substr(0,e.length-1))}));return`<a href="${e.startsWith("www.")?"http://"+e:e}" target="_blank">${e}</a>${i}`}function ve(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(ge,me).replace(/(^|[^\/:=])\b([A-Z0-9\-\_\.]+@(?:[A-Z\_-]+\.)+[A-Z]+)/gi,'$1<a href="mailto:$2">$2</a>')}function fe(e){const t=function(e){return`https://www.youtube-nocookie.com/embed/${e}?rel=0`}(e);return`<iframe src="${t}" frameborder="0" allowfullscreen></iframe>`}var ye=n(78614);function we(e,t){const n=e[t];return"string"==typeof n?n:""}function be(e,t){if(e.match(/^\s*#/g))return e;try{return new URL(e,t).href}catch(t){return e}}function Ce(e){try{return new URL(e),!0}catch(e){return!1}}function Se(e,t){const n=[...e.attributes].find((e=>e.nodeName.toLowerCase()===t));return n?n.nodeName:""}const Te=/^\s*(https?|ftp|file):/i;function Ie(e,t){if(!(t&&t.match(Te)&&Ce(t)&&e.match(/<[a-z][\w\-:]*[\s\/][^>]*=|<style\b/i)))return e;const n=(new DOMParser).parseFromString(e,"text/html"),i=n.documentElement,s=n.head,o=n.body;if(!(n&&i instanceof Element&&s instanceof Element&&o instanceof Element))return e;const a=e.match(/<html\b/i),r=e.match(/<head\b/i),l=e.match(/<(body|frameset)\b/i),d=i.attributes.length,c=s.attributes.length,h=o.attributes.length,p=s.childNodes.length,u=o.childNodes.length;let g;if(r||c||p||!s.parentNode||s.parentNode.removeChild(s),l||h||u||!o.parentNode||o.parentNode.removeChild(o),a||d)g=n.createElement("div"),g.appendChild(i);else{if(!i.children.length)return e;g=l||h||r||c||p&&u?i:p?s:o}return ke(g,t).innerHTML}function ke(e,t){if(!t||!t.match(Te)||!Ce(t))return e;const n=document.implementation.createDocument("http://www.w3.org/1999/xhtml","html",null),i=[...e.getElementsByTagName("base")].filter((e=>Se(e,"href")));if(i.length){const e=i[0].getAttribute(Se(i[0],"href"));if(e&&e.match(Te)&&Ce(e))t=e;else if(e&&!e.match(/^\s*[a-z0-9\-\+\.]+:/i)){const n=be(e,t);!n.match(Te)&&Ce(n)||(t=n)}i.forEach((e=>{e.parentNode&&e.parentNode.removeChild(e)}))}const s=n.documentElement;if(!s)return e;const o=n.createElement("base");o instanceof HTMLBaseElement&&(o.href=t,s.appendChild(o));const a=n.importNode(e,!0);s&&s.appendChild(a);const r=[{attr:"action",prop:"action",check:"",pattern:null,replacer:null},{attr:"archive",prop:"",check:"archive",pattern:/([^\s]+)/g,replacer:function(e,n){return be(n,t)}},{attr:"background",prop:"",check:"background",pattern:null,replacer:null},{attr:"cite",prop:"cite",check:"",pattern:null,replacer:null},{attr:"data",prop:"data",check:"",pattern:null,replacer:null},{attr:"formaction",prop:"formAction",check:"",pattern:null,replacer:null},{attr:"longdesc",prop:"longDesc",check:"",pattern:null,replacer:null},{attr:"href",prop:"href",check:"",pattern:null,replacer:null},{attr:"poster",prop:"poster",check:"",pattern:null,replacer:null},{attr:"src",prop:"src",check:"",pattern:null,replacer:null},{attr:"srcset",prop:"",check:"srcset",pattern:/([^,\s]+)(\s+[^,\s]+)/g,replacer:function(e,n,i){return be(n,t)+i}},{attr:"xml:link",prop:"",check:"",pattern:null,replacer:null}],l=a.getElementsByTagName("*");for(let e=0;e<l.length;e++){const i=l[e];let o;try{o=n.createElement(i.localName.toLowerCase())}catch(e){o=n.createElement(i.localName.toLowerCase().replace(/[^\w:\-].*$/,""))}s.appendChild(o);for(const{attr:e,prop:n,check:s,pattern:a,replacer:l}of r){const r=Se(i,e);if(r){const d=i.getAttribute(r)||"";if(o.setAttribute(e,d),a&&l){if(s&&we(o,s)||!s){const e=d.replace(a,l);d!==e&&i.setAttribute(r,e)}}else if(n){const e=we(o,n);e&&(d===e||d.match(/^\s*#/g)||i.setAttribute(r,e))}else if(s&&we(o,s)||!s){const e=be(d,t);d!==e&&i.setAttribute(r,e)}}}const a=function(e,n){return'url("'+be(n,t)+'")'},d=/\burl\("([^"]+)"\)/g,c=Se(i,"style");if(c){o.setAttribute("style",i.getAttribute(c)||"");const e=o.style.cssText;if(e){const t=e.replace(d,a);e!==t&&i.setAttribute(c,t)}}if(o instanceof HTMLStyleElement&&i.textContent.length&&o.sheet instanceof CSSStyleSheet){o.textContent=i.textContent;const e=[...o.sheet.cssRules].map((e=>e.cssText)).join("\n"),t=e.replace(d,a);e!==t&&(i.textContent=t)}s.removeChild(o)}return e.ownerDocument.adoptNode(a)}function Ae(){}function Ze(){this.category=[],this.cloud=[],this.people=new De,this.feeditems=[],this.generator=null,this.haserrors=!1,this.htmlrights="",this.htmldescription="",this.htmltitle="",this.icon=null,this.id="",this.image=null,this.language="",this.lastbuilddate="",this.links=new Ne,this.plaintitle="",this.pubdate="",this.publishdate="",this.rating="",this.skipdays=new Be,this.skiphours=[],this.textinput=[],this.ttl="",this.updated="",this.updatedate="",this.updatefrequency="",this.updateperiod=""}function Ee(){this.category=[],this.people=new De,this.htmlbody="",this.htmlcontent="",this.htmldescription="",this.htmlrights="",this.htmlsummary="",this.htmltitle="",this.id="",this.links=new Ne,this.plaintitle="",this.pubdate="",this.publishdate="",this.published="",this.source=null,this.updated="",this.updatedate="",this.xmloriginal=""}function _e(){this.description="",this.height="",this.link="",this.title="",this.url="",this.width=""}function Ne(){this.alternate=[],this.comments=[],this.docs=[],this.enclosure=[],this.next=[],this.prev=[],this.related=[],this.self=[],this.serviceedit=[],this.servicepost=[],this.via=[]}function Me(){this.hreflang="",this.bytelength="",this.mimetype="",this.title="",this.url=""}function Pe(){this.label="",this.scheme="",this.term=""}function De(){this.author=[],this.contributor=[],this.managingeditor=[],this.webmaster=[]}function xe(){this.email="",this.name="",this.url=""}function Oe(){this.name="",this.url="",this.version=""}function Le(){this.domain="",this.path="",this.port="",this.protocol="",this.registerprocedure=""}function Re(){this.htmldescription="",this.link="",this.name="",this.title=""}function Be(){this.sunday=this.monday=this.tuesday=this.wednesday=this.thursday=this.friday=this.saturday=!1}function Fe(){this.htmltitle="",this.items=[],this.ownername="",this.owneremail="",this.ownerurl="",this.plaintitle="",this.publishdate="",this.updatedate=""}function Ue(){this.category="",this.created="",this.feedurl="",this.htmldescription="",this.htmltitle="",this.items=[],this.language="",this.pageurl="",this.plaintitle="",this.supported=!0}const Ve="http://www.w3.org/1999/xhtml";function We(e){return(e||"").replace(/^\s+|\s+$/g,"")}function He(e){return(e||"").replace(/^\s*[\r\n]|\s+$/g,"")}function ze(e){return document.createElementNS(Ve,"div").appendChild(document.createTextNode(e)).parentNode.innerHTML}function Ge(e){const t=document.implementation.createHTMLDocument().createElementNS(Ve,"div");return t.innerHTML=e,We(t.textContent)}function $e(e,t,n){return e.match(/&(#\d+|#x[0-9a-e]+|[a-z][0-9a-z]*);|<[a-z][a-z0-9\-]*\b[^>]*>/i)?Ie(We(e),Je("",t,n)):ve(ze(He(e)))}function Ke(e){return e.toLowerCase()}function je(e,t){return We(e||t).toLowerCase()}function Ye(e){let t="";for(let n=0;n<e.childNodes.length;n++)e.childNodes[n].nodeType!==Node.TEXT_NODE&&e.childNodes[n].nodeType!==Node.CDATA_SECTION_NODE||(t+=e.childNodes[n].nodeValue);return t}function Xe(e,t,n){for(let i=t.length-1;i>=0;i--)if(t[i]){if(e.hasAttributeNS(t[i],n))return e.getAttributeNS(t[i],n);if(e.namespaceURI===t[i]&&(!i||e.hasAttributeNS("",n)))return e.getAttributeNS("",n);if(!i)return null}else{if(!i&&e.namespaceURI)return null;if(!i||!e.namespaceURI&&e.hasAttributeNS("",n))return e.getAttributeNS("",n)}}function Qe(e,t,n){for(let i=t.length-1;i>=0;i--)if(t[i]){if(e.hasAttributeNS(t[i],n))return!0;if(e.namespaceURI===t[i]&&(!i||e.hasAttributeNS("",n)))return!!i||e.hasAttributeNS("",n);if(!i)return!1}else{if(!i&&e.namespaceURI)return!1;if(!i||!e.namespaceURI&&e.hasAttributeNS("",n))return!!i||e.getAttributeNS("",n)}}function qe(e){try{return new URL(e),!0}catch(e){return!1}}function Je(e,t,n){const i=/^[a-z0-9\-\+\.]+:/i;if(e.match(i))return e;const s=/^(https?|ftp|file):/i,o=[e];let a,r=!1;for(;!r&&t.nodeType===Node.ELEMENT_NODE;){if(t.hasAttribute("xml:base")&&(a=We(t.getAttribute("xml:base")),a.length)){const e=a.match(i);r=a.match(s)&&qe(a),e&&!r||(o[o.length]=a)}t=t.parentNode}if(!r){if(!n.match(s)||!qe(n))return e;o[o.length]=n}for(n=o.pop();void 0!==(a=o.pop());)try{n=new URL(a,n).href}catch(t){return e}return n||(n=e),n}const et=new RegExp("^[\\p{Ps}\\p{Pi}\"'<]+|[\\p{Pe}\\p{Pf}\"'>]+$","ug");Ae.prototype.parseFeed=function(e,t,n){const i="http://www.w3.org/2005/Atom",s="http://www.w3.org/1999/02/22-rdf-syntax-ns#",o="http://purl.org/rss/1.0/",a="http://channel.netscape.com/rdf/simple/0.9/",r="http://purl.org/dc/elements/1.1/";function l(e,t){let n="";const i=new XMLSerializer;e=e.cloneNode(!0);const s=document.createTreeWalker(e,NodeFilter.SHOW_CDATA_SECTION);for(;s.nextNode();)s.currentNode.parentNode.replaceChild(s.currentNode.ownerDocument.createTextNode(s.currentNode.nodeValue),s.currentNode);if(t)for(let t=0;t<e.childNodes.length;t++)n+=i.serializeToString(e.childNodes[t]);else n=i.serializeToString(e).replace(/^<[^>]+>|<[^>]+>$/g,"");return n}function d(e,t,n){if(1===t.length)return e.getElementsByTagNameNS(t[0],n);const i=e.getElementsByTagName("*"),s=[];for(let e=0;e<i.length;e++)i[e].localName===n&&-1!==t.indexOf(i[e].namespaceURI)&&(s[s.length]=i[e]);return s}function c(e,t){const i=je(Xe(e,A,"type"),"");if(e.children.length){if(e.children.length>1||e.children[0]!==(e.getElementsByTagNameNS(Ve,"div")[0]||e.getElementsByTagNameNS(e.namespaceURI,"div")[0])||function(e){for(let t=0;t<e.childNodes.length;t++)if(e.childNodes[t].nodeType===Node.TEXT_NODE&&e.childNodes[t].nodeValue.replace(/^\s+|\s+$/g,"")||e.childNodes[t].nodeType===Node.CDATA_SECTION_NODE)return!0;return!1}(e)){return l(ke(e,Je("",e,n)))}return l(ke(e.children[0],Je("",e.children[0],n)),e.children[0].namespaceURI===Ve)}if("html"===i||"text/html"===i||"xhtml"===i||i.match(/^application\/.*\+xml$/))return Ie(We(Ye(e)),Je("",e,n));if(i&&"text"!==i&&!i.match(/^text\/plain$/)&&i.match(/^[\-\w]+\/[\-\w\+]+$/)){if(t){const n=new Me;n.url="data:"+i+";base64,"+We(Ye(e)).replace(/\s+/g,""),n.mimetype=i,u(n,t)}return""}return ve(ze(He(Ye(e))))}function h(e){if(e.children.length){return l(ke(e,Je("",e,n)))}return $e(Ye(e),e,n)}function p(e){const t=new _e;if(e.children.length){for(let i,s,o=0;o<e.children.length;o++)if(i=e.children[o],s=Ke(i.localName),-1!==A.indexOf(i.namespaceURI))if("url"===s||"link"===s){const e=We(Ye(i));e&&(t[s]=Je(e,i,n))}else if("feedlink"===s){const e=We(Ye(i));e&&(t.link=Je(e,i,n))}else"title"===s||"feedtitle"===s?t.title=We(Ye(i)):"description"!==s&&"width"!==s&&"height"!==s||(t[s]=We(Ye(i)))}else{const i=We(Ye(e));i&&(t.url=Je(i,e,n))}return t}function u(e,t){const n=t.find((t=>t.url===e.url&&t.title===e.title&&t.hreflang===e.hreflang));n?(!n.mimetype&&e.mimetype&&(n.mimetype=e.mimetype),!n.bytelength&&e.bytelength&&(n.bytelength=e.bytelength)):t[t.length]=e}function g(e,t){let i,s;if("enclosure"===e.localName||"comments"===e.localName||"docs"===e.localName?i=e.localName:"source"===e.localName||"feedsource"===e.localName?i="via":"relation"===e.localName?i="related":(i=je(Xe(e,A,"rel"),"alternate"),i=i.replace(/\W/g,"")),"source"!==e.localName&&"feedsource"!==e.localName&&e.childNodes.length?s=We(Ye(e)):Qe(e,A,"href")?s=We(Xe(e,A,"href")):Qe(e,A,"url")?s=We(Xe(e,A,"url")):e.namespaceURI===r&&(s=We(Ye(e))),s&&i&&t.links.hasOwnProperty(i)){const o=new Me;o.url=Je(s,e,n),"source"===e.localName||"feedsource"===e.localName?o.title=We(Ye(e)):o.title=We(Xe(e,A,"title")),o.mimetype=We(Xe(e,A,"type")),o.hreflang=We(Xe(e,A,"hreflang")),o.bytelength=We(Xe(e,A,"length")),u(o,t.links[i])}}function m(e){const t=new Pe,n=We(Ye(e));return n.length?(t.label=t.term=n,t.scheme=We(Xe(e,A,"domain"))):(t.term=We(Xe(e,A,"term")),t.label=We(Xe(e,A,"label")||t.term),t.scheme=We(Xe(e,A,"scheme"))),t}function v(e){const t=new Oe;t.name=We(Ye(e));const i=We(Xe(e,A,"uri"));return i&&(t.url=Je(i,e,n)),t.version=We(Xe(e,A,"version")),t}function f(e){let t;if(e.children.length){t=new xe;for(let i,o,a=0;a<e.children.length;a++)if(i=e.children[a],o=Ke(i.localName),-1!==A.indexOf(i.namespaceURI)){if("name"===o||"email"===o)t[o]=We(Ye(i));else if("uri"===o){const e=We(Ye(i));e&&(t.url=Je(e,i,n))}}else if("http://xmlns.com/foaf/0.1"===i.namespaceURI)if("name"===o)t[o]=We(Ye(i));else if("homepage"===o){const e=We(i.getAttributeNS(s,"resource"));e&&(t.url=Je(e,i,n))}else"mbox"===o&&(t.email=We(i.getAttributeNS(s,"resource")).replace(/^[a-z]+:/i,""))}else{const n=We(Ye(e));(0,ye.HZ)(n)?(t=new xe,t.email=n):t=y(null,n)}return t}function y(e,t){const n=new xe,i=e?Ye(e):t;n.name=We(i.replace(/[\s<(]*(mailto\s*:\s*)?[^\s<>():,@]+@[^\s<>():,@]+[\s>)]*/i," ")).replace(et,"");const s=i.match(/[^\s<>():,@]+@[^\s<>():,@]+/);return s&&(n.email=s[0].replace(/^"([^\"]*)"$/,"$1")),n}function w(e){const t=new Le;return t.domain=We(Xe(e,A,"domain")),t.port=We(Xe(e,A,"port")),t.path=We(Xe(e,A,"path")),t.registerprocedure=We(Xe(e,A,"registerProcedure"))||We(Xe(e,A,"registerprocedure")),t.protocol=We(Xe(e,A,"protocol")),t}function b(e){const t=new Re;for(let i,s,o=0;o<e.children.length;o++)if(i=e.children[o],s=Ke(i.localName),-1!==A.indexOf(i.namespaceURI))if("description"===s)t.htmldescription=h(i);else if("title"===s||"feedtitle"===s)t.title=We(Ye(i));else if("name"===s)t.name=We(Ye(i));else if("link"===s||"feedlink"===s){const e=We(Ye(i));e&&(t.link=Je(e,i,n))}return t}function C(e,t){for(let n,i,s=0;s<e.children.length;s++)n=e.children[s],-1!==A.indexOf(n.namespaceURI)&&"day"===Ke(n.localName)&&(i=We(Ye(n)).toLowerCase(),t.hasOwnProperty(i)&&(t[i]=!0))}function S(e,t){for(let n,i,s=0;s<e.children.length;s++)n=e.children[s],-1!==A.indexOf(n.namespaceURI)&&"hour"===Ke(n.localName)&&(i=We(Ye(n)).toLowerCase(),i.match(/^\d+$/)&&1*i<24&&1*i>=0&&(t[i]=!0))}function T(t){const i=new XMLSerializer;let s=i.serializeToString(t);const o=/^([^>]+)\sxmlns="http:\/\/www.w3.org\/1999\/xhtml"/;if(k&&(s=s.replace(/<(\/?)feed(source|link|image|title)\b/g,"<$1$2"),s=s.replace(o,"$1")),!Z.contains(t)){let e=i.serializeToString(Z.cloneNode(!1));k&&(e=e.replace(o,"$1")),s=`${e}${s}`}for(;t&&t.parentNode!==e;){const a=(t=t.parentNode).cloneNode(!1),r=Je("",t,n);a.setAttribute("xml:base",r),k&&t!==Z&&t!==e.documentElement&&t.hasAttribute("xmlns")&&a.removeAttribute("xmlns");let l=i.serializeToString(a);l=l.replace(/^<([\w\-:]+)\b([^>]*)\/>$/,"<$1$2></$1>"),k&&(l=l.replace(o,"$1")),l=l.split("></"),s=l[0]+">"+s+"</"+l[1]}return s}function I(t){const n=new Ze;for(let e,i,s=0;s<t.children.length;s++)e=t.children[s],i=Ke(e.localName),-1!==A.indexOf(e.namespaceURI)?"id"===i?n[i]=We(Ye(e)):"image"===i||"feedimage"===i?e.children.length&&(n.image=p(e)):"logo"===i?n.image=p(e):"icon"===i?n[i]=p(e):"generator"===i?n[i]=v(e):"title"===i||"feedtitle"===i?("channel"===t.localName?n.htmltitle=h(e):n.htmltitle=c(e),n.plaintitle=Ge(n.htmltitle)):"rights"===i?n.htmlrights=c(e):"subtitle"===i?n.htmldescription=c(e):"copyright"===i?n.htmlrights=h(e):"description"===i?n.htmldescription=h(e):"updated"===i||"lastbuilddate"===i||"pubdate"===i||"rating"===i||"language"===i||"ttl"===i?n[i]=We(Ye(e)):"category"===i?n[i][n[i].length]=m(e):"link"===i||"feedlink"===i||"docs"===i?g(e,n):"cloud"===i?n[i][n[i].length]=w(e):"author"===i||"contributor"===i||"managingeditor"===i||"webmaster"===i?n.people[i][n.people[i].length]=f(e):"textinput"===i?e.children.length&&(n[i][n[i].length]=b(e)):"skipdays"===i?C(e,n[i]):"skiphours"===i&&S(e,n[i]):"http://purl.org/rss/1.0/modules/syndication/"===e.namespaceURI?"updateperiod"!==i&&"updatefrequency"!==i||(n[i]=We(Ye(e)).toLowerCase()):e.namespaceURI===r&&("title"===i?(n.htmltitle=h(e),n.plaintitle=Ge(n.htmltitle)):"description"===i?n.htmldescription=h(e):"date"===i?n.pubdate=We(Ye(e)):"language"===i?n[i]=We(Ye(e)):"rights"===i?n.htmlrights=h(e):"subject"===i?n.category[n.category.length]=m(e):"source"===i||"relation"===i?g(e,n):"publisher"===i?n.people.managingeditor[n.people.managingeditor.length]=y(e):"creator"===i?n.people.author[n.people.author.length]=y(e):"contributor"===i&&(n.people[i][n.people[i].length]=y(e)));if(!n.language){const i=Ke(t.localName);"source"===i||"feedsource"===i?t.hasAttribute("xml:lang")&&(n.language=We(t.getAttribute("xml:lang"))):e.documentElement.hasAttribute("xml:lang")&&(n.language=We(e.documentElement.getAttribute("xml:lang")))}if(n.publishdate=n.pubdate||n.updated||n.lastbuilddate,n.updatedate=n.lastbuilddate||n.updated||n.pubdate,n.ttl.match(/^\d+$/))n.ttl=parseInt(n.ttl)||"";else if(n.updateperiod||n.updatefrequency){let e;e=n.updatefrequency.match(/^\d+$/)&&parseInt(n.updatefrequency)||1;const t={hourly:60,daily:1440,weekly:10080,monthly:306600,yearly:3679200};t.hasOwnProperty(n.updateperiod)?n.ttl=Math.round(t[n.updateperiod]/e):n.ttl=Math.round(t.daily/e)}else n.ttl="";return n}let k=!1;if("string"!=typeof t)return"HTMLStringNotString";if("string"!=typeof n)return"FeedURLNotString";if(!e||e.getElementsByTagNameNS(Ve,"parsererror").length){if(t&&t.match(/^\w*</)&&(t.match(/<[\w\-:]+[^>]*>/g)||[]).length>3&&(t.match(/<\/[\w\-:]+>/g)||[]).length>3){for(;t.match(/<(source|link|image|title)\b(([^\/>]|\/[^>])*>[^<]*((?!<\1\b([^\/>]|\/[^>])*>)<[^<]*)*?)<\/\1>/i);)t=t.replace(/<(source|link|image|title)\b(([^\/>]|\/[^>])*>[^<]*((?!<\1\b([^\/>]|\/[^>])*>)<[^<]*)*?)<\/\1>/gi,"<feed$1$2</feed$1>");t=(t=t.replace(/<(\w+:link|\w+:category|category|\w+:cloud|cloud|\w+:enclosure|enclosure)\b([^>]*)\/>/gi,"<$1$2></$1>")).replace(/<!\[CDATA\[([\w\W]*?)\]\]>/gi,((e,t)=>ze(t))),t="<!doctype html><html><head><title></title></head><body>"+t+"</body></html>",e=(new DOMParser).parseFromString(t,"text/html"),k=!0}if(!e||e.getElementsByTagNameNS(Ve,"parsererror").length)return"NoDocumentNode";e.body&&((e=e.body).documentElement=e.children[0])}if(!e.documentElement)return"NoDocumentElement";const A=[e.documentElement.namespaceURI];let Z;if(A[0]||"feed"!==e.documentElement.localName?A[0]===s&&(A[1]=o,A[2]=a):A[1]=i,Z="feed"===e.documentElement.localName?e.documentElement:d(e.documentElement,A,"channel")[0],!Z)return"NoChannelElement";-1===A.indexOf(i)&&A.unshift(i),-1===A.indexOf(o)&&A.unshift(o),-1===A.indexOf(a)&&A.unshift(a);const E=I(Z);if(E.haserrors=k,e.documentElement!==Z&&e.documentElement.children.length>1)for(let t,n,i=0;i<e.documentElement.children.length;i++)t=e.documentElement.children[i],n=Ke(t.localName),-1!==A.indexOf(t.namespaceURI)&&("image"===n||"feedimage"===n?E.image=p(t):"textinput"===n&&(E[n][E[n].length]=b(t)));let _;_="feed"===Z.localName?d(e,A,"entry"):d(e,A,"item");for(let e=0;e<_.length;e++){let t=!1;E.feeditems[e]=new Ee;for(let n,i,s=0;s<_[e].children.length;s++)if(n=_[e].children[s],i=Ke(n.localName),-1!==A.indexOf(n.namespaceURI))"link"===i||"feedlink"===i||"enclosure"===i||"comments"===i?g(n,E.feeditems[e]):"title"===i||"feedtitle"===i?("item"===n.parentNode.localName?E.feeditems[e].htmltitle=h(n):E.feeditems[e].htmltitle=c(n),E.feeditems[e].plaintitle=Ge(E.feeditems[e].htmltitle)):"summary"===i||"rights"===i?E.feeditems[e]["html"+i]=c(n):"content"===i?E.feeditems[e].htmlcontent=c(n,E.feeditems[e].links.enclosure):"description"===i?t?E.feeditems[e].htmlsummary=h(n):E.feeditems[e].htmldescription=h(n):"author"===i||"contributor"===i?E.feeditems[e].people[i][E.feeditems[e].people[i].length]=f(n):"category"===i?E.feeditems[e][i][E.feeditems[e][i].length]=m(n):"id"===i||"published"===i||"updated"===i||"pubdate"===i?E.feeditems[e][i]=We(Ye(n)):"guid"===i?(E.feeditems[e].id=We(Ye(n)),"false"!==je(Xe(n,A,"isPermaLink"),"")&&"false"!==je(Xe(n,A,"ispermalink"),"")&&g(n,E.feeditems[e])):"source"!==i&&"feedsource"!==i||("item"===n.parentNode.localName?g(n,E.feeditems[e]):E.feeditems[e].source=I(n));else if(n.namespaceURI===r)"title"===i?(E.feeditems[e].htmltitle=h(n),E.feeditems[e].plaintitle=Ge(E.feeditems[e].htmltitle)):"description"===i?E.feeditems[e].htmldescription=h(n):"date"===i?E.feeditems[e].pubdate=We(Ye(n)):"rights"===i?E.feeditems[e].htmlrights=h(n):"subject"===i?E.feeditems[e].category[E.feeditems[e].category.length]=m(n):"identifier"===i?(E.feeditems[e].id||(E.feeditems[e].id=We(Ye(n))),g(n,E.feeditems[e])):"source"===i||"relation"===i?g(n,E.feeditems[e]):"publisher"===i||"creator"===i?E.feeditems[e].people.author[E.feeditems[e].people.author.length]=y(n):"contributor"===i&&(E.feeditems[e].people[i][E.feeditems[e].people[i].length]=y(n));else if("http://purl.org/rss/1.0/modules/content/"===n.namespaceURI)"encoded"===i&&(t||E.feeditems[e].htmlsummary||(E.feeditems[e].htmlsummary=E.feeditems[e].htmldescription),t=!0,E.feeditems[e].htmldescription=Ye(n));else if("http://search.yahoo.com/mrss/"===n.namespaceURI)switch(i){case"group":{const t=n.getElementsByTagName("media:description")[0]?.innerHTML;if(t){const n=ve(t);E.feeditems[e].htmldescription+=`<div class="preformatted">${n}</div>`}const i=n.getElementsByTagName("media:thumbnail")[0];if(i){const t=new _e;t.url=i.getAttribute("url"),t.width=i.getAttribute("width"),t.height=i.getAttribute("height"),E.feeditems[e].links.enclosure.push(t)}break}}else if("http://www.youtube.com/xml/schemas/2015"===n.namespaceURI){if("videoid"===i)E.feeditems[e].htmldescription+=`<div class="video-wrapper">${fe(n.innerHTML)}</div>`}else if("http://www.itunes.com/dtds/podcast-1.0.dtd"===n.namespaceURI)switch(i){case"author":case"block":case"category":case"duration":case"email":case"explicit":case"keywords":case"name":case"new":case"owner":case"pubDate":case"subtitle":case"summary":case"episodetype":case"season":case"episode":case"title":break;case"image":{const t=new _e;t.url=n.getAttribute("href"),E.feeditems[e].links.enclosure.push(t);break}}E.feeditems[e].publishdate=E.feeditems[e].published||E.feeditems[e].pubdate||E.feeditems[e].updated,E.feeditems[e].updatedate=E.feeditems[e].updated||E.feeditems[e].pubdate||E.feeditems[e].published,E.feeditems[e].htmlbody=E.feeditems[e].htmlcontent||E.feeditems[e].htmldescription||E.feeditems[e].htmlsummary,E.feeditems[e].xmloriginal=T(_[e])}return E},Ae.prototype.parseOPML=function(e,t){function n(e,s){for(let o,a,r=0;r<e.children.length;r++)if(o=e.children[r],a=Ke(o.localName),-1!==i.indexOf(o.namespaceURI)&&"outline"===a&&"true"!==je(Xe(o,i,"isComment"),"")){const e=new Ue;if(-1!==["rss","atom"].indexOf(je(Xe(o,i,"type"),""))&&(e.feedurl=We(Xe(o,i,"xmlUrl")),e.feedurl)){e.feedurl=Je(e.feedurl,o,t),e.created=We(Xe(o,i,"created")),e.htmldescription=$e(Xe(o,i,"description")||"",o,t),e.language=We(Xe(o,i,"language")),e.pageurl=We(Xe(o,i,"htmlUrl"))||We(Xe(o,i,"url")),e.pageurl&&(e.pageurl=Je(e.pageurl,o,t));const n=je(Xe(o,i,"version"),"");e.supported=Boolean(!n||n.match(/^(rss\d*|atom\s*[\d\.]*)$/i))}if(Qe(o,i,"category")?e.category=We(Xe(o,i,"category")):e.category=s.category||"",o.children.length&&n(o,e),e.feedurl||e.items.length){s.items[s.items.length]=e;const n=We(Xe(o,i,"text")),a=We(Xe(o,i,"title"));n&&a&&n!==a?(e.htmltitle=$e(n.length<=a.length?n:a,o,t),e.htmldescription||(e.htmldescription=$e(n.length<=a.length?a:n,o,t))):e.htmltitle=$e(n||a,o,t)||ze(e.feedurl),e.plaintitle=Ge(e.htmltitle)}}}const i=[null,"","http://opml.org/spec2"];if("string"!=typeof t)return"FeedURLNotString";if(!e||e.getElementsByTagNameNS(Ve,"parsererror").length)return"NoDocumentNode";if(!e.documentElement)return"NoDocumentElement";if("opml"!==e.documentElement.localName&&"outlineDocument"!==e.documentElement.localName||-1===i.indexOf(e.documentElement.namespaceURI))return"WrongDocumentElement";const s=new Fe;for(let o,a,r=0;r<e.documentElement.children.length;r++)if(o=e.documentElement.children[r],-1!==i.indexOf(e.documentElement.namespaceURI))if(a=Ke(o.localName),"head"===a){for(let e,n,a=0;a<o.children.length;a++)if(e=o.children[a],-1!==i.indexOf(e.namespaceURI))if(n=Ke(e.localName),"title"===n)s.htmltitle=$e(Ye(e),e,t),s.plaintitle=Ge(s.htmltitle);else if("ownername"===n||"owneremail"===n)s[n]=We(Ye(e));else if("datecreated"===n)s.publishdate=We(Ye(e));else if("datemodified"===n)s.updatedate=We(Ye(e));else if("ownerid"===n){const n=We(Ye(e));n&&(s.ownerurl=Je(n,e,t))}}else"body"===a&&n(o,s);return s};var tt=n(82227),nt=n(68247),it=n(71320),st=n(95095),ot=n(51501);var at=n(87422);const rt=/^\s*data:/i,lt="x-vivaldi/feed-embeddable-media/youtube";function dt(e){if(""===e)return[];const t=(new Ae).parseFeed((new DOMParser).parseFromString(e,"application/xml"),e,"");if("string"==typeof t)return[{type:"html",content:`<html><body><p>${(0,le.Z)("Error: $1",[t])}</p></body></html>`}];const{feeditems:n}=t;if(!n.length)return[{type:"html",content:`<html><body><p>${(0,le.Z)("Error: $1",["NO_FEED_ITEM"])}</p></body></html>`}];const{htmlbody:i,htmlrights:s,links:o}=n[0],a=[{type:"html",content:`<main>\n      ${i}\n    </main>\n    ${gt(o,i)}\n    ${ct(s)}`}];return["alternate","enclosure","related","via","comments","serviceedit"].forEach((e=>{let t=1;o[e].filter((e=>e.url.match(rt))).forEach((n=>{const i=function(e,t){let n="us-ascii",i="text/plain";if(t){const e=t.match(/;\s*charset\s*=\s*("\s*)?([^\s;"]+)/i);e&&(n=e[2]),i=t.replace(/;[\w\W]*$|\s+/g,"")||i}const s={valid:!1,protocol:"",mimeType:i,charset:n,base64:!1,data:""},o=e.match(/^\s*data:([^,]*),([\w\W]*)$/i);if(o){s.valid=!0,s.protocol="data:",s.data=o[2];const e=o[1].split(";");e.forEach(((t,n)=>{if(!n&&t.match(/^\s*[a-z]*\/[\w!#$&\-^\.\+]+\s*$/))s.mimeType=t.replace(/\s+/g,"").toLowerCase();else{let i,o;const a=t.indexOf("=");-1===a?i=t:(i=t.substring(0,a),o=t.substring(a+1).replace(/^\s+|"|\s+$/g,"")),i=i.toLowerCase().replace(/^\s+|\s+$/g,""),"charset"===i&&o?s.charset=o.toLowerCase():"base64"===i&&-1===a&&n===e.length-1&&(s.base64=!0,s.data=s.data.replace(/\s+/g,""))}}))}return s}(n.url,n.mimetype),{valid:s,mimeType:o,charset:r,base64:l}=i;let{data:d}=i;if(s&&d){let i=n.title.replace(/[\\\/?%*:|"<>\s]/g,"")||`${e}${t++}`;const s=i.replace(/^([^\.]*$|[\w\W]*\.)/,"").toLowerCase(),c=(0,at.nv)(o,s);if(c!==s&&(i=`${i}.${c}`),!l){if("utf-8"===r)try{d=decodeURIComponent(d)}catch(e){d=unescape(d)}else if("us-ascii"===r||"iso-8859-1"===r)d=unescape(d);else{const e=d.length;let t=0;const n=[];for(;t<e;){const i=d.substring(t,t+1);if("%"===i&&e-t>=3){const e=d.substring(t+1,t+2),s=d.substring(t+2,t+3);isNaN(parseInt(e,16))||isNaN(parseInt(s,16))?n.push(i.charCodeAt(0)):(n.push(parseInt(`${e}${s}`,16)),t+=2)}else{const e=i.charCodeAt(0);if(e>255){(new TextEncoder).encode(i).forEach((e=>n.push(e)))}else n.push(e)}t++}try{d=new TextDecoder(r).decode(new Uint8Array(n))}catch(e){try{d=decodeURIComponent(d)}catch(e){d=unescape(d)}}}d=new Uint8Array((new TextEncoder).encode(d))}a.push({type:"attachment",mimeType:o,filename:i,content:d})}}))})),a}const ct=e=>e?`<footer>${e}</footer>`:"",ht=e=>{const t=document.createElement("div");return t.textContent=e,t.innerHTML},pt=(e,t)=>{const n=e.hreflang?` hreflang="${ht(e.hreflang)}`:"";return`<li>\n    <a href="${ht(e.url)}"${n}>\n    ${ht(e.title?e.title:t.length?t:e.url)}\n    </a>\n    </li>`},ut=(e,t)=>`<figure>\n    ${e}\n    ${t?`<figcaption>${ht(t)}</figcaption>`:""}\n    </figure>`;const gt=(e,t)=>{const n=[],i=e=>!e.url.match(rt),s=document.createElement("video"),o=/^(image|img)\/(jpe?g|gif|a?png|svg+xml|bmp|x-icon|webp)(\b|$)/i,a=/^[^\?#]*\.(jpe?g|gif|a?png|svg|bmp|ico|cur|webp)(\?|#|$)/i,r=e.enclosure.filter(i);let l=[];t.match(/<(img|image)\s/i)||(l=r.filter((e=>e.mimetype?e.mimetype.match(o):e.url.match(a))));const d=r.filter((e=>{if(e.mimetype?.match(/^video\//i))return s.canPlayType(e.mimetype);if(M.Z.get(D.kRssEmbedYoutubeAttachments)){const t=/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/gi.exec(e.url);if(t&&t[1])return e.mimeType=lt,e.url=t[1],!0}return!1})),c=r.filter((e=>!(!e.mimetype||!e.mimetype.match(/^audio\//i))&&s.canPlayType(e.mimetype))),h=r.filter((e=>!(l.includes(e)||d.includes(e)||c.includes(e))));n.push("<nav>");const p=e.alternate.filter(i),u=function(e,t){if(!t.length)return null;if(1===t.length)return t[0];let n=t.filter((e=>""!==e.hreflang));const i=t.filter((e=>""===e.hreflang));if(!n.length)return i[0];e=e.map((e=>e.replace(/_/g,"-").toLowerCase())),n=n.map((e=>({lang:e.hreflang.replace(/_/g,"-").toLowerCase(),val:e})));let s=!1;do{for(let t=0;t<e.length;t++){const i=n.find((n=>n.lang===e[t]));if(i)return i.val}s=!1,n.forEach((e=>{const t=e.lang.lastIndexOf("-");-1!==t&&(s=!0,e.lang=e.lang.substring(0,t))}))}while(s);e=e.map((e=>e.replace(/-[\w\W]*$/g,"").toLowerCase()));for(let t=0;t<e.length;t++){const i=n.find((n=>n.lang===e[t]));if(i)return i.val}return i.length?i[0]:n[0].val}(navigator.languages,p);n.push('<ul class="mainbutton">'),u&&n.push(pt(u,(0,le.Z)("Open article"))),n.push("</ul>"),p.length>1&&(n.push(`<h2>${(0,le.Z)("Main article")}</h2><ul>`),p.forEach((e=>{e!==u&&n.push(pt(e,(0,le.Z)("Open article")))})),n.push("</ul>")),h.length&&(n.push(`<h2>${(0,le.Z)("Attachments")}</h2><ul>`),h.forEach((e=>{n.push(pt(e,""))})),n.push("</ul>"));const g=e.related.filter(i);g.length&&(n.push(`<h2>${(0,le.Z)("Related content")}</h2><ul>`),g.forEach((e=>{n.push(pt(e,""))})),n.push("</ul>"));const m=e.via.filter(i);m.length&&(n.push(`<h2>${(0,le.Z)("Sources")}</h2><ul>`),m.forEach((e=>{n.push(pt(e,""))})),n.push("</ul>"));const v=e.comments.filter(i);v.length&&(n.push(`<h2>${(0,le.Z)("Comments")}</h2><ul>`),v.forEach((e=>{n.push(pt(e,""))})),n.push("</ul>"));const f=e.serviceedit.filter(i);return f.length&&(n.push(`<h2>${(0,le.Z)("Edit blog post")}</h2><ul>`),f.forEach((e=>{n.push(pt(e,""))})),n.push("</ul>")),n.push("</nav>"),(l.length||d.length||c.length)&&(d.length&&(n.push(`<section><h2>${(0,le.Z)("Linked videos")}</h2>`),d.forEach((e=>{e.mimeType===lt?n.push(function({url:e}){return ut(fe(e))}(e)):n.push((e=>ut(`<video controls src="${ht(e.url)}"></video>`,e.title))(e))})),n.push("</section>")),c.length&&(n.push(`<section><h2>${(0,le.Z)("Linked audio")}</h2>`),c.forEach((e=>{n.push((e=>ut(`<audio controls src="${ht(e.url)}"></audio>`,e.title))(e))})),n.push("</section>")),l.length&&(n.push(`<section><h2>${(0,le.Z)("Linked images")}</h2>`),l.forEach((e=>{n.push((e=>{const t=e.title?` alt="${ht(e.title)}"`:"";return ut(`<img src="${ht(e.url)}"${t}>`,e.title)})(e))})),n.push("</section>"))),n.join("")};var mt=n(21285),vt=n(48868);const ft=async function(e){return await vt.Z.deletedFeedItems.where("path").equals(e).toArray()};const yt=async function(e){return await vt.Z.searchList.where("messageId").anyOf(e).toArray()};var wt=n(40382),bt=n(13519),Ct=n(8684),St=n(44850),Tt=n(34155);async function It(e,t){if(!await tt.Z.get(ue.u4,t)){const n={name:e,accountId:ue.u4,path:t,filterValue:{include:[[{accountId:ue.u4},{path:t}]],...ot.Z.getSearchListButtons(ue.u4)}};await j.Z.addFilter(n,!1)}}function kt(e,t,n){const i=n.length,s=st.Z.adjustBatchSize.bind(void 0,10,100,500);let o,a=10,r=0;return new Promise(((l,c)=>{Tt.nextTick((function c(){const h=n.slice(r,r+a);r+=a,r>i&&(r=i);const p=Date.now();if(0===h.length)return void l(o);return async function(e,t){const n=t.map((e=>e.messageId)),i=await yt(n),s=await ft(e),o=new Set;for(const e of i)o.add(e.messageId);for(const e of s)o.add(e.messageId);const a=t.filter((e=>!o.has(e.messageId)));if(0===a.length)return;const r=await(0,mt.Z)(ue.u4,e,ue.Oi,a);j.Z.updateIndex({addedSles:r});for(const e of a){const t=r.find((t=>t.messageId===e.messageId)),n=dt(e.raw);d.Z.mailPrivate.addMessageBody(t.id,(0,bt.H)(n),(e=>{e||console.warn("Failed to add body to FTS db",t.id)})),await(0,wt.Z)(ue.u4,e.sentDate,t.id,e.raw)}return r[0]}(t,h).then((n=>{n&&!o?o=n:n&&X.Z.setStatus(e,(0,le.Z)("Loading feed $1: $2/$3",[t,r,i]));const l=Date.now();a=s(a,l-p)})).then((()=>Tt.nextTick(c)))}))}))}const At=new class{async add(e){const t=M.Z.get(D.kRssSettings),n=e.filter((e=>!t.some((t=>t.url===e.url))));if(n.length){if(n.some((e=>!e.path)))throw new Error("RssSettingsActions.add: Expected GUID path");nt.Z.set(D.kRssSettings,[...t,...n]);for(const e of n)await It(e.title||e.url,e.path)}}async removeAllFeeds(){const e=M.Z.get(D.kRssSettings);try{for(const t of e)await j.Z.removeAccountPath(ue.u4,t.path,"RSS");nt.Z.set(D.kRssSettings,[])}catch(e){console.error(e)}}async removeFeed(e){const t=M.Z.get(D.kRssSettings),n=t.findIndex((t=>t.path===e));try{j.Z.removeAccountPath(ue.u4,e,"RSS");const i=[...t];i.splice(n,1),nt.Z.set(D.kRssSettings,i)}catch(e){console.error(e)}}async edit(e,t){const n=M.Z.get(D.kRssSettings).slice(),i=n[t];if(i.title!==e.title){const t=await tt.Z.setFilterName(ue.u4,i.path,e.title);it.Z.updateFilters(t)}n[t]=e,nt.Z.set(D.kRssSettings,n)}updateAllFeeds=e=>{z.ZP.isMail(e)?Rt(e):y.Z.runtime.sendMessage({refreshRSS:!0})}};var Zt=n(77150),Et=n.n(Zt),_t=n(4111);function Nt(e){let t=new Date(e);return Mt(t)||(t=Pt(e)),t}const Mt=e=>e instanceof Date&&!isNaN(e),Pt=(e="")=>new Date(e.trim().replace(/\b[a-z]+$/i,(e=>_t.Z[e.toUpperCase()]||"+0000")));function Dt(e,t){return e.id+(t.pubDate?e.publishdate:e.updatedate)+e.links.alternate.map((e=>e.url)).join(" | ")}function xt(e,t){const n=t.url,i=new Ae,s=new XMLHttpRequest,o=new Promise(((e,t)=>{s.overrideMimeType("text/xml"),s.open("GET",n,!0),s.onload=function(){if(s.status>=400)return;let o=s.responseURL;o.match(/^(https?|ftp|file):/i)||(o=n);try{let{responseXML:n}=s;null===n&&s.responseText.match(/^\s/)&&(n=(new DOMParser).parseFromString(s.responseText.trim(),"text/xml"));const a=i.parseFeed(n,s.responseText,o);"string"==typeof a?t(a):e(a)}catch(e){t(e)}},s.onreadystatechange=()=>{s.status>=400&&t(s.status)},s.onerror=s.onabort=function(e){t(e)},s.send()})),a=M.Z.get(D.kRssSettings);return o.then((i=>{const s=a.findIndex((e=>e.url===t.url));if(-1===s)return Promise.reject("Feed deleted");const o={...a[s]},r={pubDate:!1};n.match(/^https?:\/\/(\w+\.)?youtube\.com\//i)&&(r.pubDate=!0);const l=i.plaintitle;o.title||(o.title=l);const d=i.feeditems.map((e=>{return{accountId:ue.u4,path:t.url,subject:e.plaintitle,raw:e.xmloriginal,sentDate:Nt(e.updatedate).getTime()||0,messageId:Et()(Dt(e,r)),from:[{name:l,address:l}],replyTo:(n=e.people.author.concat(e.people.contributor,i.people.author,i.people.managingeditor,i.people.webmaster),n.filter((e=>e.email)).map((e=>({name:e.name?e.name:e.email,address:e.email})))),to:[],cc:[],flags:[]};var n}));return async function(e,t,n,i){const s=i.length,o=await kt(e,n,i);if(!o)return;const a=()=>{const t=["message",o.id].join("/"),n=St.jk.internalUrl("mailpage",t,o.subject);Y.Z.openURL(e,n);const i=z.ZP.getMailWindowId();y.Z.windows.update(i,{drawAttention:!0})};if(M.Z.get(D.kRssShowNotifications)){const e=(0,le.Z)("New Feed from $2","New Feeds from $2",[s,t]);(0,Ct.c)({title:o.subject,body:e,icon:"resources/mail_notification_icon.png",onClick:a})}X.Z.setStatus(e,(0,le.Z)("Finished loading feed $2. $1 message loaded","Finished loading feed $2. $1 messages loaded",[s,t]),ue.QM),ce.Z.filter()}(e,o.title,o.path,d).then((()=>{o.lastChecked=(new Date).valueOf(),At.edit(o,s)}))})).catch((e=>{e instanceof Error?de.Z.error("Mail",["feeds","parsing"],(0,le.Z)("Encountered an error when parsing feed $1",[n]),e):de.Z.warn("Mail",["feeds","loading"],(0,le.Z)("Failed to load feed $1",[n]),e)}))}let Ot;async function Lt(e,t){const n=(new Date).valueOf(),i=t.filter((e=>{const{refreshInterval:t,lastChecked:i=0,offline:s}=e;return n>=6e4*t+i&&!s}));for(const t of i)await xt(e,t)}function Rt(e){Lt(e,M.Z.get(D.kRssSettings).map((e=>({...e,lastChecked:0}))))}function Bt(e){if(M.Z.get(D.kMailIsTurnedOff)||!z.ZP.isMail(e))return;0!==M.Z.get(D.kRssSettings).length&&(Rt(e),void 0!==Ot&&(console.warn("RSSStartup: Did not expect an existing polling interval ID"),clearInterval(Ot)),Ot=setInterval((()=>Lt(e,M.Z.get(D.kRssSettings))),6e4))}function Ft(){clearInterval(Ot),Ot=void 0}var Ut=n(92868);const Vt=new BroadcastChannel("actions");function Wt(){const e=M.Z.get(D.kMailCheckInterval);"one_minute"===e?(te.Z.setCheckInterval(!0,1),ae.setCheckInterval(!0,1)):"fifteen_minutes"===e?(te.Z.setCheckInterval(!0,15),ae.setCheckInterval(!0,15)):(te.Z.setCheckInterval(!1),ae.setCheckInterval(!1))}function Ht(e){j.Z.sortListEntries(e)}function zt(e,t){j.Z.sortListEntries(e,"threads"===t)}function Gt(e){const t=(0,pe.Z)(e);ne.Z.createDraft(t)}async function $t(e){ee.Z.startBackgroundActions();let t={onSortOrder:void 0,onSortField:void 0};const n=M.Z.get(D.kMailAccounts),i=M.Z.get(D.kRssSettings);if(0===n.length&&0===i.length)return t;X.Z.setPersistentStatus(e,"MAIL_STARTUP",(0,le.Z)("Mail client starting...")),t=function(e){const t={onSortOrder:Ht.bind(this,e),onSortField:zt.bind(this,e)};return M.Z.addListener(D.kMailSearchSortOrder,t.onSortOrder),M.Z.addListener(D.kMailSearchSortField,t.onSortField),M.Z.addListener(D.kMailCheckInterval,Wt),Vt.addEventListener("message",J,!1),window.addEventListener("online",jt,!1),window.addEventListener("offline",Yt,!1),d.Z.calendar.onMailtoOpened.addListener(Gt),t}(e);try{await Promise.all([j.Z.start(e),ee.Z.start()]),await(0,Ut.y)(e)}catch(n){return de.Z.error("Mail",n),Kt(t),X.Z.setPersistentStatus(e,"MAIL_STARTUP_FAILED",(0,le.Z)("Mail client startup failed. Error: $1",[n.message||n])),t}finally{X.Z.clearPersistentStatus(e,"MAIL_STARTUP")}const s=f.Z.getSync("FOLDER_SELECTION");return j.Z.selectFolder(s),ce.Z.filter(),ee.Z.updateFlags(),he.Z.sendAll(e,!1),te.Z.connectIMAPClients(),ae.checkForMail(),ee.Z.flushBuffer(),Wt(),ee.Z.updateThreads(),K.Z.initialize(Q.A4),X.Z.setStatus(e,(0,le.Z)("Mail client started"),ue.QM),t}async function Kt(e){ne.Z.closeMailPages(),ee.Z.stopBackgroundActions(),function(e){M.Z.removeListener(D.kMailSearchSortOrder,e.onSortOrder),M.Z.removeListener(D.kMailSearchSortField,e.onSortField),M.Z.removeListener(D.kMailCheckInterval,Wt),Vt.removeEventListener("message",J,!1),window.removeEventListener("online",jt,!1),window.removeEventListener("offline",Yt,!1),d.Z.calendar.onMailtoOpened.removeListener(Gt)}(e),te.Z.setCheckInterval(!1),ae.setCheckInterval(!1),await te.Z.disconnectIMAPClients(),j.Z.stop(),ee.Z.stop()}async function jt(e){await Promise.all([te.Z.reconnectIMAPClients(),ae.checkForMail()]),ee.Z.flushBuffer()}function Yt(e){te.Z.disconnectIMAPClients()}const Xt={start:async function(e){let t={onSortOrder:void 0,onSortField:void 0};async function n(){M.Z.get(D.kMailIsTurnedOff)||(t=await $t(e),Bt(e))}if(z.ZP.isMail(e))await n();else{const t=()=>{z.ZP.isMail(e)&&(z.ZP.removeListener(t),setTimeout((()=>n())))};z.ZP.addListener(t)}y.Z.runtime.onMessage.addListener((async t=>{if(t)if(t.addFeed&&t.feeds){const n=t.feeds;ie.Z.showAddFeed(e,n)}else t.refreshRSS&&z.ZP.isMail(e)&&Rt(e)})),M.Z.addListener(D.kMailIsTurnedOff,(async()=>{M.Z.get(D.kMailIsTurnedOff)?(Ft(),await Kt(t)):z.ZP.isMail(e)&&(t=await $t(e),Bt(e))})),M.Z.addListener([D.kMailAccounts,D.kRssSettings],(async(n,i,s)=>{const o=M.Z.get(D.kMailAccounts),a=M.Z.get(D.kRssSettings);if(1===n.length&&0===i.length&&0===o.length&&0===a.length?(ee.Z.flushBuffer(),await Kt(t)):0!==n.length||1!==i.length||0!==o.length&&0!==a.length||z.ZP.isMail(e)&&(ee.Z.stopBackgroundActions(),t=await $t(e)),s===D.kRssSettings)if(1===n.length&&0===i.length)Ft();else if(0===n.length&&1===i.length)Bt(e);else if(n.length<i.length){const t=i.filter((e=>!n.some((t=>t.url===e.url))));Lt(e,t)}}))}};var Qt,qt=n(30626),Jt=n(27770),en=n(59486),tn=n(67294);function nn(e,t,n,i){Qt||(Qt="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Qt,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function sn(){return en.ZP.hasBeenInitialized()?{nodes:en.ZP.getFoldersWithin(en.ZP.getTopNodes(),0),bookmarksBarFolderId:en.ZP.getBookmarkBarFolderId()}:{nodes:null,bookmarksBarFolderId:void 0}}class on extends tn.Component{state=sn();_onStoreChange=()=>{this.setState(sn())};componentDidMount(){en.ZP.addListener(this._onStoreChange)}componentWillUnmount(){en.ZP.removeListener(this._onStoreChange)}getFolderId=e=>{if(this.props.selectedItemID){const t=e.find((e=>e.id===this.props.selectedItemID));if(t)return t.id;console.warn("Bookmark folder not found")}return this.state.bookmarksBarFolderId};render(){if(!this.state.nodes)return null;const e=this.getFolderId(this.state.nodes),t=this.state.nodes.find((t=>t.id===e))?.title||en.Ei,n=this.state.nodes.map((e=>nn("option",{value:e.id},"dir_"+e.id," ".repeat(3*e.level),e.title)));return nn("span",{className:"bookmark-folder-picker"},void 0,nn("input",{type:"text",value:t,tabIndex:"-1",readOnly:!0}),nn("select",{className:"bookmark-folders",value:e,onChange:this.props.onChange},void 0,n))}}const an=on;var rn,ln=n(64473),dn=n(94283),cn=n(86088);function hn(e,t,n,i){rn||(rn="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:rn,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class pn extends tn.PureComponent{static contextType=dn.Z;state={title:"",url:"",description:"",nickname:"",thumbnail:"",isFolder:!1,parentId:""};_parentId="";_index=0;componentWillMount(){const e=en.ZP.getItemById(this.props.options.id);switch(this.props.options.mode){case"edit":e&&this.setState({title:e.title,url:e.url,thumbnail:e.thumbnail,description:e.description,nickname:e.nickname,isFolder:en.ZP.isFolder(e),parentId:e.parentId});break;case"addbookmark":case"addfolder":{e?en.ZP.isFolder(e)?(this._parentId=e.id,this._index=0):(this._parentId=e.parentId??en.SZ,this._index="number"==typeof e.index?e.index+1:0):(this._parentId=en.SZ,this._index=0);const t={};if(t.parentId=this._parentId,t.isFolder="addfolder"===this.props.options.mode,!t.isFolder){const e=W.Z.getActivePage(this.context.vivaldiWindowId);e&&(t.title=e.title,t.url=e.url,t.thumbnail=e.vivExtData.thumbnail)}this.setState(t)}}}onCancel=()=>{this.props.onClose()};onSave=()=>{switch(this.props.options.mode){case"edit":{const e=this.props.options.id,t=Jt.ZP.verifyForUpdate({title:this.state.title,url:this.state.url,thumbnail:this.state.thumbnail,nickname:this.state.nickname,description:this.state.description},this.state.isFolder),n=en.ZP.getItemById(e);n&&n.parentId!==this.state.parentId?i.Z.move([n.id],this.state.parentId,0).then((()=>{y.Z.bookmarks.update(e,t).then((()=>this.props.onClose()))})):y.Z.bookmarks.update(e,t).then((()=>this.props.onClose()));break}case"addbookmark":case"addfolder":{const e=Jt.ZP.verifyForCreate({parentId:this.state.parentId,index:this.state.parentId===this._parentId?this._index:0,title:this.state.title,url:this.state.url,nickname:this.state.nickname,description:this.state.description},this.state.isFolder);y.Z.bookmarks.create(e).then((()=>this.props.onClose()));break}default:this.props.onClose()}};changeValue=(e,t)=>{const n={};n[e]=t.target.value,this.setState(n)};render(){let e;switch(this.props.options.mode){case"edit":e=this.state.isFolder?(0,le.Z)("Edit Folder"):(0,le.Z)("Edit Bookmark");break;case"addbookmark":e=(0,le.Z)("New Bookmark");break;case"addfolder":e=(0,le.Z)("title","New Folder")}if(void 0===e)return null;const t=this.state.isFolder?(0,le.Z)("Folder Name"):(0,le.Z)("Bookmark Name");return hn(ln.Z,{onRequestClose:this.onCancel},void 0,hn("div",{className:"edit-bookmark"},void 0,hn("header",{className:"dialog-header"},void 0,hn("h1",{className:"dialog-title"},void 0,e)),hn("form",{onSubmit:this.onSave},void 0,false,hn("div",{className:"dialog-content"},void 0,hn("input",{className:"title",type:"text",value:this.state.title,onChange:this.changeValue.bind(this,"title"),title:t,placeholder:t,autoFocus:!0}),!1===this.state.isFolder&&hn("input",{className:"address",type:"text",value:this.state.url,onChange:this.changeValue.bind(this,"url"),title:(0,le.Z)("Address"),placeholder:(0,le.Z)("Address")}),void 0!==this.state.parentId&&hn(an,{selectedItemID:this.state.parentId,title:(0,le.Z)("Folder"),onChange:this.changeValue.bind(this,"parentId")}),!1===this.state.isFolder&&hn("input",{className:"nickname",type:"text",value:this.state.nickname,onChange:this.changeValue.bind(this,"nickname"),title:(0,le.Z)("Nickname"),placeholder:(0,le.Z)("Nickname")}),!1===this.state.isFolder&&hn("textarea",{className:"description",type:"text",value:this.state.description,onChange:this.changeValue.bind(this,"description"),title:(0,le.Z)("Description"),placeholder:(0,le.Z)("Description")})),hn("footer",{className:"dialog-footer"},void 0,hn("input",{type:"submit",className:"primary",value:(0,le.Z)("Save")}),hn("input",{type:"button",onClick:this.onCancel,value:(0,le.Z)("Cancel")})))))}}const un=pn;var gn=n(94184),mn=n.n(gn),vn=n(4027),fn=n(48521);class yn extends tn.PureComponent{static contextType=dn.Z;refButton=tn.createRef();componentDidMount(){this._reportSize()}componentDidUpdate(){this._reportSize()}_reportSize=()=>{const{HTMLElement:e}=this.context,t=this.refButton.current;t instanceof e&&this.props.onRendered(t.offsetWidth,t.offsetHeight)};_handleKeyDown=e=>{switch(e.key){case"ArrowUp":case"ArrowDown":case"Enter":this.props.onItemActivated(this.props.id,"Enter"===e.key,!0);break;case"ArrowLeft":this.props.moveFocus(this.props.id,"left",!1);break;case"ArrowRight":this.props.moveFocus(this.props.id,"right",!1);break;case"Escape":if(this.props.menuOpen)return;this.props.onLeaveBar();break;default:return}e.preventDefault(),e.stopPropagation()};_handleMouseDown=e=>{e.preventDefault()};_handleItemMouseUp=e=>{e.button===vn.Z.kCenter&&e.preventDefault()};_handleClick=e=>{this.props.onItemActivated(this.props.id,!0,!0,e),e.preventDefault(),e.stopPropagation()};_handleBlur=()=>{this.props.onItemBlur(this.props.id)};_handleFocus=()=>{this.props.highlighted||this.props.onItemHighlightMissing(this.props.id)};_handleMouseEnter=e=>{this.props.onItemEnter(this.props.id)};_handleMouseLeave=e=>{this.props.onItemLeave(this.props.id)};render(){return(0,fn.jsx)("button",{ref:this.refButton,className:mn()({bookmarkbarItem:!0,chevron:!0,highlighted:this.props.highlighted}),"data-id":this.props.id,"data-offset":this.props.offset,tabIndex:this.props.keyAccess,title:(0,le.Z)("More bookmarks"),dangerouslySetInnerHTML:{__html:cn.zwh},onKeyDown:this._handleKeyDown,onClick:this._handleClick,onMouseDown:this._handleMouseDown,onMouseUp:this._handleItemMouseUp,onBlur:this._handleBlur,onFocus:this._handleFocus,onMouseEnter:this._handleMouseEnter,onMouseLeave:this._handleMouseLeave})}}const wn=yn;var bn=n(44147),Cn=n(62077),Sn=n(72536),Tn=n(86635),In=n(68551),kn=n(13253),An=n(89661),Zn=n(34155);let En=!1;const _n={show:function(e,t,n,i,s,o,a){const r=e.vivaldiWindowId,l=function(e){a(e)},c=function(){Zn.nextTick((()=>{a("")}))};En||(En=!0,function(e,t){return new Promise((e=>{d.Z.zoom.getVivaldiUIZoom((n=>{t.forEach((e=>{e.rect.x=parseInt((e.rect.x+1)*n),e.rect.y=parseInt((e.rect.y+0)*n),e.rect.width=parseInt(e.rect.width*n),e.rect.height=parseInt(e.rect.height*n)})),e()}))}))}(0,n).then((()=>{d.Z.menubarMenu.onOpenBookmark.addListener(bn.Z.onOpen),d.Z.menubarMenu.onBookmarkAction.addListener(bn.Z.onAction),d.Z.menubarMenu.onHover.addListener(bn.Z.onHover),d.Z.bookmarkContextMenu.onOpen.addListener(l),d.Z.bookmarkContextMenu.onClose.addListener(c),d.Z.bookmarkContextMenu.show({windowId:r,id:t,siblings:n,sortField:i,sortOrder:s,edge:U.Z.getBookmarkExtrasEdge(),icons:[$.Z,Tn.Z,In.Z,kn.Z,An.Z,Cn.Z,Sn.Z]},(()=>{En=!1,bn.Z.onHover(r,""),d.Z.menubarMenu.onOpenBookmark.removeListener(bn.Z.onOpen),d.Z.menubarMenu.onBookmarkAction.removeListener(bn.Z.onAction),d.Z.menubarMenu.onHover.removeListener(bn.Z.onHover),d.Z.bookmarkContextMenu.onOpen.removeListener(l),d.Z.bookmarkContextMenu.onClose.removeListener(c)}))})))}};var Nn=n(39206),Mn=n(26036);const Pn=new Map;function Dn(e,t){const n=Pn.get(e),i=Nn.Z.getDefault(z.ZP.isIncognito(e));if(t&&n){return Nn.Z.getById(n)||i}return i}const xn={settingsState:{linkurl:"",linktitle:"",pageurl:"",pagetitle:"",srcurl:"",selection:"",printableselection:"",selectionurl:"",keywordurl:"",isdevtools:!1,iseditable:!1,isimage:!1,isframe:!1,ismailcontent:!1,iswebpanel:!1,ismailto:!1,support:{copy:!1,audio:!1,canvas:!1,editoptions:!1,emoji:!1,extensions:!1,pictureinpicture:!1,password:!1,passwordgeneration:!1,passwordshowall:!1,paste:!1,plugin:!1,qrcode:!1,sendlinktodevices:!1,sendpagetodevices:!1,video:!1},textfield:"document"},getLabelWithParameter:function(e,t,n,i){switch(t.action){case"DOCUMENT_LOOK_UP":if(t.title){const e=t.title;return delete t.title,{...i?G.Z.makeLabelPair(e):G.Z.makeLabelPair(e.replace("$1",n))}}return{...i?(0,Mn.Z)("Look Up “$1”"):(0,Mn.Z)("Look Up “$1”",[n])};case"DOCUMENT_GOTO_URL":if(t.title){const e=t.title;return delete t.title,{...i?G.Z.makeLabelPair(e):G.Z.makeLabelPair(e.replace("$1",n))}}return{...i?(0,Mn.Z)("Go to “$1”"):(0,Mn.Z)("Go to “$1”",[n])};case"DOCUMENT_SEARCH":case"DOCUMENT_SEARCH_LAST_USED":{const s="DOCUMENT_SEARCH_LAST_USED"===t.action,o=Dn(e,s),a=o?o.name:"";if(t.title){const e=t.title;return delete t.title,{...i&&o?G.Z.makeLabelPair(e):G.Z.makeLabelPair(e.replace("$1",a).replace("$2",n))}}return i?s?{...(0,Mn.Z)("Search $1 for “$2” (With Last Used Engine)")}:{...(0,Mn.Z)("Search $1 for “$2”")}:{...(0,Mn.Z)("Search $1 for “$2”",[a,n])}}default:return G.Z.makeLabelPair("")}},setSearchEngine:function(e,t){Pn.set(e,t.id)},getSearchEngine:Dn,getShortcuts:function(e,t){return U.Z.getMenuItem(e,{id:"",type:"command",action:t},!0).shortcuts||[]}};const On={actions:function(){return["DOCUMENT_CONTAINER_DEVELOPER_TOOLS","DOCUMENT_VALIDATE_URL","DOCUMENT_VIEW_SOURCE","DOCUMENT_VIEW_FRAME_SOURCE","DOCUMENT_RELOAD_FRAME","DOCUMENT_INSPECT"]},options:function(e,t,n){const i=void 0===n,s=n||xn.settingsState,o={...G.Z.commandItem};switch(t.action){case"DOCUMENT_CONTAINER_DEVELOPER_TOOLS":return o.settingsLabel=(0,le.Z)("[Developer Tools]"),o.type="container",{...o,...(0,Mn.Z)("Developer Tools")};case"DOCUMENT_VALIDATE_URL":return{...o,...(0,Mn.Z)("Validate")};case"DOCUMENT_VIEW_SOURCE":{const t=xn.getShortcuts(e,"COMMAND_TAB_VIEW_PAGE_SOURCE");return{...o,shortcuts:s.iswebpanel?[]:t,...s.iswebpanel?(0,Mn.Z)("View Panel Source"):(0,Mn.Z)("View Page Source")}}case"DOCUMENT_VIEW_FRAME_SOURCE":return{...o,...(0,Mn.Z)("View Frame Source")};case"DOCUMENT_RELOAD_FRAME":return{...o,...(0,Mn.Z)("Reload Frame")};case"DOCUMENT_INSPECT":{const t=xn.getShortcuts(e,"COMMAND_DEVELOPER_TOOLS");return{...o,shortcuts:s.iswebpanel?[]:t,...(0,Mn.Z)("Inspect")}}default:return U.Z.getMenuItem(e,t,i)}}};const Ln={actions:function(){return["DOCUMENT_CONTAINER_AV","DOCUMENT_CONTAINER_EXTENSIONS"].concat(On.actions())},options:function(e,t,n){const i=void 0===n,s={...G.Z.commandItem};switch(t.action){case"DOCUMENT_CONTAINER_AV":return s.settingsLabel=(0,le.Z)("[Media Controls]"),s.type="container",{...s,...(0,Mn.Z)("Media Controls")};case"DOCUMENT_CONTAINER_EXTENSIONS":return s.settingsLabel=(0,le.Z)("[Extensions]"),s.type="container",{...s,...(0,Mn.Z)("Extensions")};default:return On.actions().includes(t.action)?On.options(e,t,n):U.Z.getMenuItem(e,t,i)}}};const Rn={actions:function(){return["CONTEXT_OPEN_IN_NEW_TAB","CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB","CONTEXT_OPEN_IN_TAB","CONTEXT_OPEN_IN_NEW_WINDOW","CONTEXT_OPEN_IN_PRIVATE_WINDOW","CONTEXT_CONTAINER_OPEN_IN_WINDOW","CONTEXT_BOOKMARK","CONTEXT_NEW_BOOKMARK","CONTEXT_NEW_FOLDER","CONTEXT_NEW_SEPARATOR","CONTEXT_EDIT","CONTEXT_RENAME","CONTEXT_CUT","CONTEXT_COPY","CONTEXT_PASTE","CONTEXT_DELETE"]},options:function(e,t,n){const i=void 0===n,s={...G.Z.commandItem};switch(t.action){case"CONTEXT_OPEN_IN_NEW_TAB":return{...s,...(0,Mn.Z)("Open in New Tab")};case"CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB":return{...s,...(0,Mn.Z)("Open in Background Tab")};case"CONTEXT_OPEN_IN_TAB":return{...s,...(0,Mn.Z)("Open")};case"CONTEXT_OPEN_IN_NEW_WINDOW":return{...s,...(0,Mn.Z)("Open in New Window")};case"CONTEXT_OPEN_IN_PRIVATE_WINDOW":return{...s,...(0,Mn.Z)("Open in Private Window")};case"CONTEXT_CONTAINER_OPEN_IN_WINDOW":return s.settingsLabel=(0,le.Z)("[Open in Another Window]"),s.type="container",{...s,...(0,Mn.Z)("Open in Another Window")};case"CONTEXT_BOOKMARK":return{...s,...(0,Mn.Z)("Add Active Tab")};case"CONTEXT_NEW_BOOKMARK":return{...s,...(0,Mn.Z)("New Bookmark")};case"CONTEXT_NEW_FOLDER":return{...s,...(0,Mn.Z)("command","New Folder")};case"CONTEXT_NEW_SEPARATOR":return{...s,...(0,Mn.Z)("New Separator")};case"CONTEXT_EDIT":return{...s,...(0,Mn.Z)("command","Edit")};case"CONTEXT_RENAME":return{...s,...(0,Mn.Z)("Rename")};case"CONTEXT_CUT":return{...s,...(0,Mn.Z)("win_linux","Cut")};case"CONTEXT_COPY":return{...s,...(0,Mn.Z)("win_linux","Copy")};case"CONTEXT_PASTE":return{...s,...(0,Mn.Z)("win_linux","Paste")};case"CONTEXT_DELETE":return{...s,...(0,Mn.Z)("other","Delete")};default:return U.Z.getMenuItem(e,t,i)}}};const Bn={actions:function(){return["CONTEXT_BOOKMARK","CONTEXT_NEW_BOOKMARK","CONTEXT_NEW_FOLDER","CONTEXT_NEW_SEPARATOR","CONTEXT_PASTE","CONTEXT_CONTAINER_SORT"]},options:function(e,t,n){const i=void 0===n,s={...G.Z.commandItem};switch(t.action){case"CONTEXT_BOOKMARK":return{...s,...(0,Mn.Z)("Add Active Tab")};case"CONTEXT_NEW_BOOKMARK":return{...s,...(0,Mn.Z)("New Bookmark")};case"CONTEXT_NEW_FOLDER":return{...s,...(0,Mn.Z)("command","New Folder")};case"CONTEXT_NEW_SEPARATOR":return{...s,...(0,Mn.Z)("New Separator")};case"CONTEXT_PASTE":return{...s,...(0,Mn.Z)("win_linux","Paste")};case"CONTEXT_CONTAINER_SORT":return s.settingsLabel=(0,le.Z)("[Sort Options]"),s.type="container",{...s,...(0,Mn.Z)("Sort")};default:return U.Z.getMenuItem(e,t,i)}}};const Fn={actions:function(){return["CONTEXT_OPEN_IN_NEW_TAB","CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB","CONTEXT_OPEN_IN_TAB","CONTEXT_OPEN_IN_NEW_WINDOW","CONTEXT_OPEN_IN_PRIVATE_WINDOW","CONTEXT_CONTAINER_OPEN_IN_WINDOW","CONTEXT_SET_SPEEDDIAL","CONTEXT_UNSET_SPEEDDIAL","CONTEXT_SET_BOOKMARK_BAR","CONTEXT_UNSET_BOOKMARK_BAR","CONTEXT_MOVE_TO_BOOKMARK_BAR","CONTEXT_BOOKMARK","CONTEXT_BOOKMARK_ALL","CONTEXT_NEW_ITEM","CONTEXT_NEW_FOLDER","CONTEXT_NEW_SEPARATOR","CONTEXT_RENAME","CONTEXT_CUT","CONTEXT_COPY","CONTEXT_PASTE","CONTEXT_DELETE","CONTEXT_EXPAND_ALL","CONTEXT_COLLAPSE_ALL","CONTEXT_IMPORT","CONTEXT_SETTINGS","CONTEXT_CONTAINER_SEARCH"]},options:function(e,t,n){const i=void 0===n,s={...G.Z.commandItem};switch(t.action){case"CONTEXT_OPEN_IN_NEW_TAB":return{...s,...(0,Mn.Z)("Open in New Tab")};case"CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB":return{...s,...(0,Mn.Z)("Open in Background Tab")};case"CONTEXT_OPEN_IN_TAB":return{...s,...(0,Mn.Z)("Open")};case"CONTEXT_OPEN_IN_NEW_WINDOW":return{...s,...(0,Mn.Z)("Open in New Window")};case"CONTEXT_OPEN_IN_PRIVATE_WINDOW":return{...s,...(0,Mn.Z)("Open in Private Window")};case"CONTEXT_CONTAINER_OPEN_IN_WINDOW":return s.settingsLabel=(0,le.Z)("[Open in Another Window]"),s.type="container",{...s,...(0,Mn.Z)("Open in Another Window")};case"CONTEXT_SET_SPEEDDIAL":return{...s,...(0,Mn.Z)("Use as Speed Dial")};case"CONTEXT_UNSET_SPEEDDIAL":return{...s,...(0,Mn.Z)("Remove from Speed Dial")};case"CONTEXT_SET_BOOKMARK_BAR":return{...s,...(0,Mn.Z)("Set as Bookmark Bar Folder")};case"CONTEXT_UNSET_BOOKMARK_BAR":return{...s,...(0,Mn.Z)("Remove as Bookmark Bar Folder")};case"CONTEXT_MOVE_TO_BOOKMARK_BAR":return{...s,...(0,Mn.Z)("Move to Bookmark Bar Folder")};case"CONTEXT_BOOKMARK":return{...s,...(0,Mn.Z)("Bookmark Active Page")};case"CONTEXT_BOOKMARK_ALL":return{...s,...(0,Mn.Z)("Bookmark All Open Pages")};case"CONTEXT_NEW_ITEM":return{...s,...(0,Mn.Z)("New Bookmark")};case"CONTEXT_NEW_FOLDER":return{...s,...(0,Mn.Z)("command","New Folder")};case"CONTEXT_NEW_SEPARATOR":return{...s,...(0,Mn.Z)("New Separator")};case"CONTEXT_RENAME":return{...s,...(0,Mn.Z)("Rename")};case"CONTEXT_CUT":return{...s,...(0,Mn.Z)("verb","Cut")};case"CONTEXT_COPY":return{...s,...(0,Mn.Z)("verb","Copy")};case"CONTEXT_PASTE":return{...s,...(0,Mn.Z)("verb","Paste")};case"CONTEXT_DELETE":return{...s,...(0,Mn.Z)("verb","Delete")};case"CONTEXT_EMPTY_TRASH":return{...s,...(0,Mn.Z)("Empty Trash")};case"CONTEXT_EXPAND_ALL":return{...s,...(0,Mn.Z)("Expand All Folders")};case"CONTEXT_COLLAPSE_ALL":return{...s,...(0,Mn.Z)("Collapse All Folders")};case"CONTEXT_IMPORT":return s.ellipsis=!0,{...s,...(0,Mn.Z)("Import Bookmarks")};case"CONTEXT_SETTINGS":return s.type="folder",{...s,...(0,Mn.Z)("Settings")};case"CONTEXT_CONTAINER_SEARCH":return s.settingsLabel=(0,le.Z)("[Search Settings]"),s.type="container",{...s,...(0,Mn.Z)("command","Search")};default:return U.Z.getMenuItem(e,t,i)}}};const Un={actions:function(){return["CONTEXT_CONTAINER_CLOSED_TAB"]},options:function(e,t,n){const i=void 0===n,s={...G.Z.commandItem};return"CONTEXT_CONTAINER_CLOSED_TAB"===t.action?(s.settingsLabel=(0,le.Z)("[All Closed Tabs]"),s.type="container",{...s,...(0,Mn.Z)("Closed Tabs")}):U.Z.getMenuItem(e,t,i)}};const Vn={actions:function(){return["CONTEXT_COMPOSE_MAIL","CONTEXT_VIEW_ALL_MESSAGES","CONTEXT_NEW_ITEM","CONTEXT_EDIT","CONTEXT_DELETE","CONTEXT_CONTAINER_DEFAULT_ACTION"]},options:function(e,t,n){const i=void 0===n,s={...G.Z.commandItem};switch(t.action){case"CONTEXT_COMPOSE_MAIL":return{...s,...(0,Mn.Z)("Compose Mail")};case"CONTEXT_VIEW_ALL_MESSAGES":return{...s,...(0,Mn.Z)("View All Messages")};case"CONTEXT_NEW_ITEM":return{...s,...(0,Mn.Z)("New Contact")};case"CONTEXT_EDIT":return{...s,...(0,Mn.Z)("command","Edit")};case"CONTEXT_DELETE":return{...s,...(0,Mn.Z)("verb","Delete")};case"CONTEXT_CONTAINER_DEFAULT_ACTION":return s.settingsLabel=(0,le.Z)("[Default Action]"),s.type="container",{...s,...(0,Mn.Z)("Default Action")};default:return U.Z.getMenuItem(e,t,i)}}};const Wn={actions:function(){return["DOCUMENT_SUGGEST_PASSWORD","DOCUMENT_SHOW_PASSWORDS","DOCUMENT_LOOK_UP","DOCUMENT_EMOJI","DOCUMENT_UNDO","DOCUMENT_REDO","DOCUMENT_CUT","DOCUMENT_COPY","DOCUMENT_PASTE","DOCUMENT_PASTE_AS_PLAIN_TEXT","DOCUMENT_SELECT_ALL","DOCUMENT_ADD_AS_SEARCH_ENGINE","COMMAND_COPY_SELECTION_TO_NOTE","DOCUMENT_GOTO_URL","DOCUMENT_CONTAINER_NOTES","DOCUMENT_SEARCH","DOCUMENT_SEARCH_LAST_USED","DOCUMENT_CONTAINER_SEARCH_WITH","DOCUMENT_CONTAINER_EXTENSIONS","DOCUMENT_CONTAINER_SPELLCHECK","DOCUMENT_CONTAINER_SPELLCHECK_OPTIONS","DOCUMENT_CONTAINER_SPEECH"].concat(On.actions())},options:function(e,t,n){const i=void 0===n,s=n||xn.settingsState,o={...G.Z.commandItem};switch(t.action){case"DOCUMENT_SUGGEST_PASSWORD":return o.ellipsis=!0,{...o,...(0,Mn.Z)("Suggest Password")};case"DOCUMENT_SHOW_PASSWORDS":return o.ellipsis=!0,{...o,...(0,Mn.Z)("Show all Saved Passwords")};case"DOCUMENT_LOOK_UP":case"DOCUMENT_SEARCH":case"DOCUMENT_SEARCH_LAST_USED":return{...o,...xn.getLabelWithParameter(e,t,s.printableselection,i)};case"DOCUMENT_EMOJI":return{...o,...(0,Mn.Z)("Emoji && Symbols")};case"DOCUMENT_UNDO":return{...o,shortcuts:["ctrl+z"],...(0,Mn.Z)("win_linux","Undo")};case"DOCUMENT_REDO":return{...o,shortcuts:["ctrl+y"],...(0,Mn.Z)("win_linux","Redo")};case"DOCUMENT_CUT":return{...o,shortcuts:["ctrl+x"],...(0,Mn.Z)("win_linux","Cut")};case"DOCUMENT_COPY":return{...o,shortcuts:["ctrl+c"],...(0,Mn.Z)("win_linux","Copy")};case"DOCUMENT_PASTE":return{...o,shortcuts:["ctrl+v"],...(0,Mn.Z)("win_linux","Paste")};case"DOCUMENT_PASTE_AS_PLAIN_TEXT":{const t=xn.getShortcuts(e,"COMMAND_CLIPBOARD_PASTE_AS_PLAIN_TEXT");return{...o,shortcuts:t,...(0,Mn.Z)("win_linux","Paste as Plain Text")}}case"DOCUMENT_SELECT_ALL":return{...o,shortcuts:["ctrl+a"],...(0,Mn.Z)("win_linux","Select All")};case"DOCUMENT_GOTO_URL":return{...o,...xn.getLabelWithParameter(e,t,s.selectionurl,i)};case"DOCUMENT_ADD_AS_SEARCH_ENGINE":return o.ellipsis=!0,{...o,...(0,Mn.Z)("Add as Search Engine")};case"COMMAND_COPY_SELECTION_TO_NOTE":return{...U.Z.getMenuItem(e,t,i),...(0,Mn.Z)("Copy to Note")};case"DOCUMENT_CONTAINER_NOTES":return o.settingsLabel=(0,le.Z)("[All notes]"),o.type="container",{...o,...(0,Mn.Z)("Insert Note")};case"DOCUMENT_CONTAINER_SEARCH_WITH":return o.settingsLabel=(0,le.Z)("[All search engines]"),o.type="container",{...o,...(0,Mn.Z)("Search With")};case"DOCUMENT_CONTAINER_EXTENSIONS":return o.settingsLabel=(0,le.Z)("[Extensions]"),o.type="container",{...o,...(0,Mn.Z)("Extensions")};case"DOCUMENT_CONTAINER_SPELLCHECK":return o.settingsLabel=(0,le.Z)("[Spell Check]"),o.type="container",{...o,...(0,Mn.Z)("Spell Check")};case"DOCUMENT_CONTAINER_SPELLCHECK_OPTIONS":return o.settingsLabel=(0,le.Z)("[Spell Check Options]"),o.type="container",{...o,...(0,Mn.Z)("Spell Check Options")};case"DOCUMENT_CONTAINER_WRITING_DIRECTION":return o.settingsLabel=(0,le.Z)("[Writing Direction Options]"),o.type="container",{...o,...(0,Mn.Z)("Writing Direction")};case"DOCUMENT_CONTAINER_SPEECH":return o.settingsLabel=(0,le.Z)("[Speech Commands]"),o.type="container",{...o,...(0,Mn.Z)("Speech")};default:return On.actions().includes(t.action)?On.options(e,t,n):U.Z.getMenuItem(e,t,i)}}};const Hn={actions:function(){return["CONTEXT_OPEN_FILE","CONTEXT_OPEN_IN_NEW_TAB","CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB","CONTEXT_OPEN_IN_TAB","CONTEXT_OPEN_IN_NEW_WINDOW","CONTEXT_OPEN_IN_PRIVATE_WINDOW","CONTEXT_FILEMANAGER","CONTEXT_COPY_ADDRESS","CONTEXT_COPY_PATH","CONTEXT_RESTART","CONTEXT_STOP","CONTEXT_RESUME","CONTEXT_REMOVE","CONTEXT_REMOVE_ALL_FINISHED"]},options:function(e,t,n){const i=void 0===n,s=n||{numAddresses:1,numFiles:1,numImages:1,hasActive:!1,hasPaused:!1,hasCompleted:!1},o={...G.Z.commandItem};switch(t.action){case"CONTEXT_OPEN_FILE":return{...o,...i||s.numFiles<2?(0,Mn.Z)("the file","Open"):(0,Mn.Z)("Open Files")};case"CONTEXT_OPEN_IN":return o.type="folder",{...o,...i||s.numFiles<2?(0,Mn.Z)("Open Image in"):(0,Mn.Z)("Open Images in")};case"CONTEXT_OPEN_IN_NEW_TAB":return{...o,...(0,Mn.Z)("open in","New Tab")};case"CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB":return{...o,...(0,Mn.Z)("Background Tab")};case"CONTEXT_OPEN_IN_TAB":return{...o,...(0,Mn.Z)("Current Tab")};case"CONTEXT_OPEN_IN_NEW_WINDOW":return{...o,...(0,Mn.Z)("open in","New Window")};case"CONTEXT_OPEN_IN_PRIVATE_WINDOW":return{...o,...(0,Mn.Z)("open in","Private Window")};case"CONTEXT_FILEMANAGER":return{...o,...(0,Mn.Z)("Show in File Manager")};case"CONTEXT_COPY_ADDRESS":return{...o,...i||s.numAddresses<2?(0,Mn.Z)("Copy Download Address"):(0,Mn.Z)("Copy Download Addresses")};case"CONTEXT_COPY_PATH":return{...o,...i||s.numFiles<2?(0,Mn.Z)("Copy Local Path"):(0,Mn.Z)("Copy Local Paths")};case"CONTEXT_RESTART":return{...o,...(0,Mn.Z)("command","Restart")};case"CONTEXT_STOP":return{...o,...(0,Mn.Z)("other","Stop")};case"CONTEXT_RESUME":return{...o,...(0,Mn.Z)("Resume Download")};case"CONTEXT_REMOVE":return{...o,...(0,Mn.Z)("verb","Remove")};case"CONTEXT_REMOVE_ALL_FINISHED":return{...o,...(0,Mn.Z)("Remove All Finished")};default:return U.Z.getMenuItem(e,t,i)}}};const zn={actions:function(){return["CONTEXT_OPEN_IN_NEW_TAB","CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB","CONTEXT_OPEN_IN_TAB","CONTEXT_OPEN_IN_NEW_WINDOW","CONTEXT_OPEN_IN_PRIVATE_WINDOW","CONTEXT_CONTAINER_OPEN_IN_WINDOW","CONTEXT_FILTER_BY","CONTEXT_COPY","CONTEXT_SAVE","CONTEXT_DELETE","CONTEXT_EXPAND_ALL","CONTEXT_COLLAPSE_ALL"]},options:function(e,t,n){const i=n||{address:""},s=void 0===n,o={...G.Z.commandItem};switch(t.action){case"CONTEXT_OPEN_IN_NEW_TAB":return{...o,...(0,Mn.Z)("Open in New Tab")};case"CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB":return{...o,...(0,Mn.Z)("Open in Background Tab")};case"CONTEXT_OPEN_IN_TAB":return{...o,...(0,Mn.Z)("Open")};case"CONTEXT_OPEN_IN_NEW_WINDOW":return{...o,...(0,Mn.Z)("Open in New Window")};case"CONTEXT_OPEN_IN_PRIVATE_WINDOW":return{...o,...(0,Mn.Z)("Open in Private Window")};case"CONTEXT_CONTAINER_OPEN_IN_WINDOW":return o.settingsLabel=(0,le.Z)("[Open in Another Window]"),o.type="container",{...o,...(0,Mn.Z)("Open in Another Window")};case"CONTEXT_FILTER_BY":return o.settingsLabel=(0,le.Z)("Filter by Address"),{...o,...s?(0,Mn.Z)("Filter by Address"):(0,Mn.Z)("Filter by “$1”",[i.address])};case"CONTEXT_COPY":return{...o,...(0,Mn.Z)("Copy Address")};case"CONTEXT_SAVE":return{...o,...(0,Mn.Z)("Save as Bookmarks")};case"CONTEXT_DELETE":return{...o,...(0,Mn.Z)("verb","Delete")};case"CONTEXT_EXPAND_ALL":return{...o,...(0,Mn.Z)("Expand All Folders")};case"CONTEXT_COLLAPSE_ALL":return{...o,...(0,Mn.Z)("Collapse All Folders")};default:return U.Z.getMenuItem(e,t,s)}}};const Gn={actions:function(){return["DOCUMENT_OPEN_IMAGE_IN_NEW_TAB","DOCUMENT_OPEN_IMAGE_IN_NEW_BACKGROUND_TAB","DOCUMENT_OPEN_IMAGE_IN_TAB","DOCUMENT_OPEN_IMAGE_IN_NEW_WINDOW","DOCUMENT_OPEN_IMAGE_IN_PRIVATE_WINDOW","DOCUMENT_SAVE_IMAGE","DOCUMENT_COPY_IMAGE","DOCUMENT_COPY_IMAGE_ADDRESS","DOCUMENT_SHOW_IMAGE_PROPERTIES","DOCUMENT_USE_IMAGE_AS_STARTPAGE_BACKGROUND","DOCUMENT_RELOAD_IMAGE","DOCUMENT_SEARCH_FOR IMAGE","DOCUMENT_CONTAINER_OPEN_IMAGE_IN_PROFILE","DOCUMENT_CONTAINER_TEXT_SELECTION","DOCUMENT_CONTAINER_EXTENSIONS"].concat(On.actions())},options:function(e,t,n){const i=void 0===n,s={...G.Z.commandItem};switch(t.action){case"DOCUMENT_OPEN_IMAGE_IN_NEW_TAB":return{...s,...(0,Mn.Z)("Open Image in New Tab")};case"DOCUMENT_OPEN_IMAGE_IN_NEW_BACKGROUND_TAB":return{...s,...(0,Mn.Z)("Open Image in Background Tab")};case"DOCUMENT_OPEN_IMAGE_IN_TAB":return{...s,...(0,Mn.Z)("Open Image")};case"DOCUMENT_OPEN_IMAGE_IN_NEW_WINDOW":return{...s,...(0,Mn.Z)("Open Image in New Window")};case"DOCUMENT_OPEN_IMAGE_IN_PRIVATE_WINDOW":return{...s,...(0,Mn.Z)("Open Image in Private Window")};case"DOCUMENT_CONTAINER_OPEN_IMAGE_IN_PROFILE":return s.settingsLabel=(0,le.Z)("[Open Image in Another Profile]"),s.type="container",{...s,...(0,Mn.Z)("Open Image in Another Profile")};case"DOCUMENT_SAVE_IMAGE":return s.ellipsis=!0,{...s,...(0,Mn.Z)("Save Image As")};case"DOCUMENT_COPY_IMAGE":return{...s,...(0,Mn.Z)("Copy Image")};case"DOCUMENT_COPY_IMAGE_ADDRESS":return{...s,...(0,Mn.Z)("Copy Image Address")};case"DOCUMENT_SHOW_IMAGE_PROPERTIES":return s.ellipsis=!0,{...s,...(0,Mn.Z)("Image Properties")};case"DOCUMENT_USE_IMAGE_AS_STARTPAGE_BACKGROUND":return{...s,...(0,Mn.Z)("Use Image as Window Background")};case"DOCUMENT_RELOAD_IMAGE":return{...s,...(0,Mn.Z)("Reload Image")};case"DOCUMENT_QR_CODE":return{...s,...(0,Mn.Z)("command","Create QR Code for This Image")};case"DOCUMENT_SEARCH_FOR IMAGE":return{...s,...(0,Mn.Z)("Search for Image")};case"DOCUMENT_CONTAINER_TEXT_SELECTION":return s.settingsLabel=(0,le.Z)("[Selected Text]"),s.type="container",{...s,...(0,Mn.Z)("Selected Text")};case"DOCUMENT_CONTAINER_EXTENSIONS":return s.settingsLabel=(0,le.Z)("[Extensions]"),s.type="container",{...s,...(0,Mn.Z)("Extensions")};default:return On.actions().includes(t.action)?On.options(e,t,n):U.Z.getMenuItem(e,t,i)}}};const $n={actions:function(){return["DOCUMENT_LOOK_UP","DOCUMENT_COPY","COMMAND_COPY_SELECTION_TO_NOTE","COMMAND_TRANSLATE_SELECTION","DOCUMENT_PRINT","DOCUMENT_GOTO_URL","DOCUMENT_SEARCH","DOCUMENT_SEARCH_LAST_USED","DOCUMENT_CONTAINER_SEARCH_WITH","DOCUMENT_CONTAINER_EXTENSIONS","DOCUMENT_SEND_BY_MAIL","DOCUMENT_ADD_TO_CALENDAR","DOCUMENT_CONTAINER_SPEECH"].concat(On.actions())},options:function(e,t,n){const i=void 0===n,s=n||xn.settingsState,o={...G.Z.commandItem};switch(t.action){case"DOCUMENT_LOOK_UP":case"DOCUMENT_SEARCH":case"DOCUMENT_SEARCH_LAST_USED":return{...o,...xn.getLabelWithParameter(e,t,s.printableselection,i)};case"DOCUMENT_COPY":return{...o,...(0,Mn.Z)("command","Copy")};case"COMMAND_COPY_SELECTION_TO_NOTE":return{...U.Z.getMenuItem(e,t,i),...(0,Mn.Z)("Copy to Note")};case"COMMAND_TRANSLATE_SELECTION":return{...U.Z.getMenuItem(e,t,i),...(0,Mn.Z)("Translate Selection")};case"DOCUMENT_PRINT":return o.ellipsis=!0,{...o,...(0,Mn.Z)("command","Print")};case"DOCUMENT_GOTO_URL":return{...o,...xn.getLabelWithParameter(e,t,s.selectionurl,i)};case"DOCUMENT_CONTAINER_SEARCH_WITH":return o.settingsLabel=(0,le.Z)("[All search engines]"),o.type="container",{...o,...(0,Mn.Z)("Search With")};case"DOCUMENT_CONTAINER_EXTENSIONS":return o.settingsLabel=(0,le.Z)("[Extensions]"),o.type="container",{...o,...(0,Mn.Z)("Extensions")};case"DOCUMENT_SEND_BY_MAIL":return{...o,...(0,Mn.Z)("Send by Mail")};case"DOCUMENT_ADD_TO_CALENDAR":return{...o,...(0,Mn.Z)("Add as Calendar Event")};case"DOCUMENT_CONTAINER_SPEECH":return o.settingsLabel=(0,le.Z)("[Speech Commands]"),o.type="container",{...o,...(0,Mn.Z)("Speech")};default:return On.actions().includes(t.action)?On.options(e,t,n):U.Z.getMenuItem(e,t,i)}}};const Kn={actions:function(){const e=["DOCUMENT_CONTAINER_EXTENSIONS","DOCUMENT_CONTAINER_DEVELOPER_TOOLS"].concat(On.actions());return["DOCUMENT_OPEN_IN_NEW_TAB","DOCUMENT_OPEN_IN_NEW_BACKGROUND_TAB","DOCUMENT_OPEN_IN_TAB","DOCUMENT_OPEN_IN_NEW_WINDOW","DOCUMENT_OPEN_IN_PRIVATE_WINDOW","DOCUMENT_ADD_LINK_TO_BOOKMARKS","DOCUMENT_ADD_LINK_TO_WEBPANEL","DOCUMENT_ADD_LINK_TO_READING_LIST","DOCUMENT_SEND_LINK_BY_MAIL","DOCUMENT_COPY_LINK_ADDRESS","DOCUMENT_COPY_LINK_TEXT","DOCUMENT_CONTAINER_OPEN_IN_PWA","DOCUMENT_CONTAINER_OPEN_IN_PROFILE","DOCUMENT_CONTAINER_SEND_TO_DEVICES","DOCUMENT_CONTAINER_EXTENSIONS","DOCUMENT_CONTAINER_LINK_SELECTION","DOCUMENT_CONTAINER_LINKED_IMAGE","DOCUMENT_CONTAINER_OPEN_IN_WINDOW"].concat($n.actions().filter((t=>!e.includes(t)))).concat(Gn.actions().filter((t=>!e.includes(t)))).concat(Ln.actions().filter((t=>!e.includes(t)))).concat(On.actions())},options:function(e,t,n){const i=void 0===n,s=n||xn.settingsState,o={...G.Z.commandItem};switch(t.action){case"DOCUMENT_OPEN_IN_NEW_TAB":return{...o,...(0,Mn.Z)("Open Link in New Tab")};case"DOCUMENT_OPEN_IN_NEW_BACKGROUND_TAB":return{...o,...(0,Mn.Z)("Open Link in Background Tab")};case"DOCUMENT_OPEN_IN_TAB":return{...o,...(0,Mn.Z)("Open Link")};case"DOCUMENT_OPEN_IN_NEW_WINDOW":return{...o,...(0,Mn.Z)("Open Link in New Window")};case"DOCUMENT_OPEN_IN_PRIVATE_WINDOW":return{...o,...(0,Mn.Z)("Open Link in Private Window")};case"DOCUMENT_CONTAINER_OPEN_IN_PWA":return o.settingsLabel=(0,le.Z)("[Open Link in Progressive Web Apps]"),o.type="container",{...o,...(0,Mn.Z)("Open Link in Progressive Web Apps")};case"DOCUMENT_CONTAINER_OPEN_IN_PROFILE":return o.settingsLabel=(0,le.Z)("[Open Link in Another Profile]"),o.type="container",{...o,...(0,Mn.Z)("Open Link in Another Profile")};case"DOCUMENT_CONTAINER_OPEN_IN_WINDOW":return o.settingsLabel=(0,le.Z)("[Open Link in Another Window]"),o.type="container",{...o,...(0,Mn.Z)("Open Link in Another Window")};case"DOCUMENT_ADD_LINK_TO_BOOKMARKS":return{...o,...(0,Mn.Z)("Bookmark Link")};case"DOCUMENT_ADD_LINK_TO_WEBPANEL":return{...o,...(0,Mn.Z)("Add Link to Web Panel")};case"DOCUMENT_ADD_LINK_TO_READING_LIST":return{...o,...(0,Mn.Z)("Add Link to Reading List")};case"DOCUMENT_SEND_LINK_BY_MAIL":return{...o,...(0,Mn.Z)("Send Link by Mail")};case"DOCUMENT_SAVE_LINK":return o.ellipsis=!0,{...o,...(0,Mn.Z)("Save Link As")};case"DOCUMENT_COPY_LINK_ADDRESS":return{...o,...!i&&s.ismailto?(0,Mn.Z)("Copy Email Address"):(0,Mn.Z)("Copy Link Address")};case"DOCUMENT_COPY_LINK_TEXT":return{...o,...(0,Mn.Z)("Copy Link Text")};case"DOCUMENT_CONTAINER_SEND_TO_DEVICES":return o.settingsLabel=(0,le.Z)("[Send Link to Your Devices]"),o.type="container",{...o,...(0,Mn.Z)("Send Link to Your Devices")};case"DOCUMENT_CONTAINER_EXTENSIONS":return o.settingsLabel=(0,le.Z)("[Extensions]"),o.type="container",{...o,...(0,Mn.Z)("Extensions")};case"DOCUMENT_CONTAINER_LINK_SELECTION":return o.settingsLabel=(0,le.Z)("[Selection menu]"),o.type="container",{...o,...(0,Mn.Z)("Text Selection")};case"DOCUMENT_CONTAINER_LINKED_IMAGE":return o.settingsLabel=(0,le.Z)("[Image menu]"),o.type="container",{...o,...(0,Mn.Z)("Image")};default:return On.actions().includes(t.action)?On.options(e,t,n):$n.actions().includes(t.action)?$n.options(e,t,n):Gn.actions().includes(t.action)?Gn.options(e,t,n):Ln.actions().includes(t.action)?Ln.options(e,t,n):U.Z.getMenuItem(e,t,i)}}};const jn={actions:function(){return["DOCUMENT_MAIL_BACK","DOCUMENT_MAIL_FORWARD","COMMAND_SAVE_PAGE","DOCUMENT_PRINT","COMMAND_TAB_VIEW_PAGE_SOURCE","COMMAND_MAIL_SHOW_PLAINTEXT","DOCUMENT_CONTAINER_DEVELOPER_TOOLS","DOCUMENT_INSPECT"]},options:function(e,t,n){const i=void 0===n,s={...G.Z.commandItem};switch(t.action){case"COMMAND_PAGE_BACK":return{...U.Z.getMenuItem(e,t,i),...(0,Mn.Z)("navigation","Back")};case"COMMAND_PAGE_FORWARD":return{...U.Z.getMenuItem(e,t,i),...(0,Mn.Z)("navigation","Forward")};case"COMMAND_SAVE_PAGE":return s.ellipsis=!0,{...s,...U.Z.getMenuItem(e,t,i),...(0,Mn.Z)("command","Save As")};case"DOCUMENT_PRINT":{const t=xn.getShortcuts(e,"COMMAND_PRINT_PAGE");return s.ellipsis=!0,{...s,shortcuts:t,...(0,Mn.Z)("command","Print")}}case"COMMAND_TAB_VIEW_PAGE_SOURCE":return s.type="checkbox",{...s,...U.Z.getMenuItem(e,t,i),...(0,Mn.Z)("Show Raw Message")};case"DOCUMENT_INSPECT":return{...s,shortcuts:[],...(0,Mn.Z)("Inspect")};default:return On.actions().includes(t.action)?On.options(e,t,n):U.Z.getMenuItem(e,t,i)}}};const Yn={actions:function(){return["CONTEXT_BACK","CONTEXT_FORWARD","CONTEXT_COPY","CONTEXT_SENDER_IS_MAILING_LIST","COMMAND_TAB_VIEW_PAGE_SOURCE","COMMAND_MAIL_SHOW_PLAINTEXT"]},options:function(e,t,n){const i=void 0===n,s={...G.Z.commandItem};switch(t.action){case"COMMAND_PAGE_BACK":return{...U.Z.getMenuItem(e,t,i),...(0,Mn.Z)("navigation","Back")};case"COMMAND_PAGE_FORWARD":return{...U.Z.getMenuItem(e,t,i),...(0,Mn.Z)("navigation","Forward")};case"CONTEXT_COPY":return{...s,...(0,Mn.Z)("win_linux","Copy")};case"CONTEXT_SENDER_IS_MAILING_LIST":return s.type="checkbox",{...s,...(0,Mn.Z)("Treat Sender as a Mailing List")};case"COMMAND_TAB_VIEW_PAGE_SOURCE":return{...s,...U.Z.getMenuItem(e,t,i),...(0,Mn.Z)("Show Raw Message")};default:return U.Z.getMenuItem(e,t,i)}}};const Xn={actions:function(){return["CONTEXT_VIEW_ALL_MESSAGES","CONTEXT_RERUN_FILTER","CONTEXT_MARK_ALL_AS_READ","CONTEXT_MOVE_ALL_TO_TRASH","CONTEXT_EMPTY_TRASH","CONTEXT_CHECK_FOR_MAIL","CONTEXT_SEND","CONTEXT_RESCAN_UNREAD","CONTEXT_SUBSCRIBE","CONTEXT_UNSUBSCRIBE","CONTEXT_RERUN_THREADING","CONTEXT_MOVE_INTO_IMPORTANT","CONTEXT_MOVE_INTO_OTHER","CONTEXT_DELETE","CONTEXT_DELETE_ALL","CONTEXT_RENAME","CONTEXT_REGENERATE","CONTEXT_ADVANCED","CONTEXT_CREATE_LABEL","CONTEXT_ADD_NEW_ACCOUNT"]},options:function(e,t,n){const i=void 0===n,s={...G.Z.commandItem};switch(t.action){case"CONTEXT_VIEW_ALL_MESSAGES":return{...s,...(0,Mn.Z)("View All Messages")};case"CONTEXT_RERUN_FILTER":return{...s,...(0,Mn.Z)("Rerun Filter for Folder")};case"CONTEXT_MARK_ALL_AS_READ":return{...s,...(0,Mn.Z)("Mark All as Read")};case"CONTEXT_MOVE_ALL_TO_TRASH":return{...s,...(0,Mn.Z)("mail","Move All to Trash")};case"CONTEXT_EMPTY_TRASH":return{...s,...(0,Mn.Z)("mail","Empty Trash")};case"CONTEXT_CHECK_FOR_MAIL":return{...s,...(0,Mn.Z)("Check for Mail")};case"CONTEXT_CREATE_FOLDER":return{...s,...(0,Mn.Z)("Create Folder")};case"CONTEXT_DELETE_FOLDER":return{...s,...(0,Mn.Z)("Delete Folder")};case"CONTEXT_SEND":return{...s,...(0,Mn.Z)("Send")};case"CONTEXT_RESCAN_UNREAD":return{...s,...(0,Mn.Z)("Rescan Unread Flags")};case"CONTEXT_SUBSCRIBE":return{...s,...(0,Mn.Z)("Subscribe")};case"CONTEXT_UNSUBSCRIBE":return{...s,...(0,Mn.Z)("Unsubscribe")};case"CONTEXT_RERUN_THREADING":return{...s,...(0,Mn.Z)("Rerun Threading")};case"CONTEXT_MOVE_INTO_IMPORTANT":return{...s,...(0,Mn.Z)("Move into Important")};case"CONTEXT_MOVE_INTO_OTHER":return{...s,...(0,Mn.Z)("Move into Other")};case"CONTEXT_DELETE_ALL":return{...s,...(0,Mn.Z)("Delete all")};case"CONTEXT_REGENERATE":return{...s,...(0,Mn.Z)("Regenerate")};case"CONTEXT_DELETE":return{...s,...(0,Mn.Z)("verb","Delete")};case"CONTEXT_RENAME":return{...s,...(0,Mn.Z)("Rename")};case"CONTEXT_CREATE_LABEL":return{...s,...(0,Mn.Z)("Create Label")};case"CONTEXT_ADD_NEW_ACCOUNT":return{...s,...(0,Mn.Z)("Add Account")};case"CONTEXT_ADVANCED":return s.type="folder",{...s,...(0,Mn.Z)("Advanced")};case"CONTEXT_TOGGLE_MAIL_VIEWS":return s.type="folder",{...s,...(0,Mn.Z)("mail","Views")};case"CONTEXT_MAIL_FOLDER":return s.type="container",{...s,...(0,Mn.Z)("Mail Folder")};default:return U.Z.getMenuItem(e,t,i)}}};const Qn={actions:function(){return["COMMAND_MAIL_REPLY","COMMAND_MAIL_REPLY_ALL","COMMAND_MAIL_FORWARD","COMMAND_MAIL_MARK_READ","COMMAND_MAIL_MARK_UNREAD","COMMAND_MAIL_GOTO_NEXT_UNREAD","COMMAND_MAIL_GOTO_PREVIOUS_UNREAD","COMMAND_MAIL_MARK_READ_AND_GOTO_NEXT_UNREAD","CONTEXT_CONTAINER_MOVE","CONTEXT_ADD_FLAG","CONTEXT_REMOVE_FLAG","CONTEXT_CONTAINER_FLAGS","CONTEXT_CONTAINER_LABELS","CONTEXT_EDIT","CONTEXT_SEND","CONTEXT_RECEIVER","CONTEXT_CONTAINER_TRASH","COMMAND_MAIL_ENABLE_THREADED_VIEW","COMMAND_MAIL_MARK_THREAD_READ","COMMAND_MAIL_MARK_THREAD_UNREAD","COMMAND_MAIL_ENABLE_SENDER_VIEW","CONTEXT_SENDER_IS_MAILING_LIST","CONTEXT_EXPAND_ALL","CONTEXT_COLLAPSE_ALL","COMMAND_MAIL_COMPOSE_NEW_MESSAGE"]},options:function(e,t,n){const i=void 0===n,s={...G.Z.commandItem};switch(t.action){case"CONTEXT_GOTO":return s.type="folder",{...s,...(0,Mn.Z)("Go to")};case"CONTEXT_CONTAINER_MOVE":return s.settingsLabel=(0,le.Z)("[Move to Folders]"),s.type="container",{...s,...(0,Mn.Z)("Move")};case"CONTEXT_ADD_FLAG":return{...s,...(0,Mn.Z)("Add Flag")};case"CONTEXT_REMOVE_FLAG":return{...s,...(0,Mn.Z)("Remove Flag")};case"CONTEXT_CONTAINER_FLAGS":return s.settingsLabel=(0,le.Z)("[All Flags]"),s.type="container",{...s,...(0,Mn.Z)("Flags")};case"CONTEXT_CONTAINER_LABELS":return s.settingsLabel=(0,le.Z)("[All Labels]"),s.type="container",{...s,...(0,Mn.Z)("Labels")};case"CONTEXT_EDIT":return{...s,...(0,Mn.Z)("mail","Edit")};case"CONTEXT_MARK_AS_SPAM":return{...s,...(0,Mn.Z)("mail","Mark Message as Spam")};case"CONTEXT_NOT_SPAM":return{...s,...(0,Mn.Z)("mail","Not Spam")};case"CONTEXT_MOVE_TO_ARCHIVE":return{...s,...(0,Mn.Z)("mail","Move Message to Archive")};case"CONTEXT_RESTORE_FROM_ARCHIVE":return{...s,...(0,Mn.Z)("mail","Restore Message from Archive")};case"CONTEXT_SEND":return{...s,...(0,Mn.Z)("Send")};case"CONTEXT_CONTAINER_TRASH":return s.settingsLabel=(0,le.Z)("[Trash elements]"),s.type="container",{...s,...(0,Mn.Z)("Trash")};case"CONTEXT_RECEIVER":return{...s,...(0,Mn.Z)("Show Messages for Receiver")};case"CONTEXT_THREAD":return s.type="folder",{...s,...(0,Mn.Z)("Thread")};case"CONTEXT_SENDER":return s.type="folder",{...s,...(0,Mn.Z)("Sender")};case"CONTEXT_SENDER_IS_MAILING_LIST":return s.type="checkbox",{...s,...(0,Mn.Z)("Treat Sender as a Mailing List")};case"CONTEXT_EXPAND_ALL":return{...s,...(0,Mn.Z)("Expand All Threads")};case"CONTEXT_COLLAPSE_ALL":return{...s,...(0,Mn.Z)("Collapse All Threads")};default:return U.Z.getMenuItem(e,t,i)}}};const qn={actions:function(){return["CONTEXT_CONTAINER_CUSTOMIZE_TOOLBAR","CONTEXT_CONTAINER_BACKWARD_HISTORY","CONTEXT_CONTAINER_FORWARD_HISTORY"]},options:function(e,t,n){const i=void 0===n,s={...G.Z.commandItem};switch(t.action){case"CONTEXT_CONTAINER_CUSTOMIZE_TOOLBAR":return s.settingsLabel=(0,le.Z)("[Customize]"),s.type="container",{...s,...(0,Mn.Z)("Customize")};case"CONTEXT_CONTAINER_BACKWARD_HISTORY":return s.settingsLabel=(0,le.Z)("[Backward History]"),s.type="container",{...s,...(0,Mn.Z)("Backward History")};case"CONTEXT_CONTAINER_FORWARD_HISTORY":return s.settingsLabel=(0,le.Z)("[Forward History]"),s.type="container",{...s,...(0,Mn.Z)("Forward History")};default:return U.Z.getMenuItem(e,t,i)}}};const Jn={actions:function(){return["CONTEXT_CONTAINER_OPEN_IN_WINDOW","CONTEXT_OPEN_ADDRESS","CONTEXT_NEW_FROM_SELECTION","CONTEXT_NEW_ITEM","CONTEXT_NEW_FOLDER","CONTEXT_NEW_SEPARATOR","CONTEXT_EDIT","CONTEXT_RENAME","CONTEXT_CUT","CONTEXT_COPY","CONTEXT_PASTE","CONTEXT_DELETE","CONTEXT_EMPTY_TRASH","CONTEXT_EXPAND_ALL","CONTEXT_COLLAPSE_ALL","CONTEXT_SETTINGS","CONTEXT_CONTAINER_SEARCH"]},options:function(e,t,n){const i=n||{inManager:!1},s=void 0===n,o={...G.Z.commandItem};switch(t.action){case"CONTEXT_OPEN_IN_NEW_TAB":return{...o,...(0,Mn.Z)("Open in New Tab")};case"CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB":return{...o,...(0,Mn.Z)("Open in Background Tab")};case"CONTEXT_OPEN_IN_TAB":return{...o,...(0,Mn.Z)("Open")};case"CONTEXT_OPEN_IN_NEW_WINDOW":return{...o,...(0,Mn.Z)("Open in New Window")};case"CONTEXT_OPEN_IN_PRIVATE_WINDOW":return{...o,...(0,Mn.Z)("Open in Private Window")};case"CONTEXT_CONTAINER_OPEN_IN_WINDOW":return o.settingsLabel=(0,le.Z)("[Open in Another Window]"),o.type="container",{...o,...(0,Mn.Z)("Open in Another Window")};case"CONTEXT_SET_SPEEDDIAL":return{...o,...(0,Mn.Z)("Use as Speed Dial")};case"CONTEXT_UNSET_SPEEDDIAL":return{...o,...(0,Mn.Z)("Remove from Speed Dial")};case"CONTEXT_SET_BOOKMARK_BAR":return{...o,...(0,Mn.Z)("Set as Bookmark Bar Folder")};case"CONTEXT_UNSET_BOOKMARK_BAR":return{...o,...(0,Mn.Z)("Remove as Bookmark Bar Folder")};case"CONTEXT_MOVE_TO_BOOKMARK_BAR":return{...o,...(0,Mn.Z)("Move to Bookmark Bar Folder")};case"CONTEXT_BOOKMARK":return{...o,...(0,Mn.Z)("Bookmark Active Page")};case"CONTEXT_BOOKMARK_ALL":return{...o,...(0,Mn.Z)("Bookmark All Open Pages")};case"CONTEXT_OPEN_ADDRESS":return{...o,...(0,Mn.Z)("Open Note Address")};case"CONTEXT_NEW_FROM_SELECTION":return{...o,...(0,Mn.Z)("Copy Selection to New Note")};case"CONTEXT_NEW_ITEM":return{...o,...(0,Mn.Z)("New Note")};case"CONTEXT_NEW_FOLDER":return{...o,...(0,Mn.Z)("command","New Folder")};case"CONTEXT_NEW_SEPARATOR":return{...o,...(0,Mn.Z)("New Separator")};case"CONTEXT_EDIT":return s?{...o,...(0,Mn.Z)("command","Edit")}:{...o,...i.inManager?(0,Mn.Z)("Edit in New Tab"):(0,Mn.Z)("Edit in Notes Manager")};case"CONTEXT_RENAME":return{...o,...(0,Mn.Z)("Rename")};case"CONTEXT_CUT":return{...o,...(0,Mn.Z)("verb","Cut")};case"CONTEXT_COPY":return{...o,...(0,Mn.Z)("verb","Copy")};case"CONTEXT_PASTE":return{...o,...(0,Mn.Z)("verb","Paste")};case"CONTEXT_DELETE":return{...o,...(0,Mn.Z)("verb","Delete")};case"CONTEXT_EMPTY_TRASH":return{...o,...(0,Mn.Z)("Empty Trash")};case"CONTEXT_EXPAND_ALL":return{...o,...(0,Mn.Z)("Expand All Folders")};case"CONTEXT_COLLAPSE_ALL":return{...o,...(0,Mn.Z)("Collapse All Folders")};case"CONTEXT_SETTINGS":return o.type="folder",{...o,...(0,Mn.Z)("Settings")};case"CONTEXT_CONTAINER_SEARCH":return o.settingsLabel=(0,le.Z)("[Search Settings]"),o.type="container",{...o,...(0,Mn.Z)("command","Search")};default:return U.Z.getMenuItem(e,t,s)}}};const ei={actions:function(){return["DOCUMENT_BACK","DOCUMENT_FORWARD","DOCUMENT_RELOAD","COMMAND_ADD_BOOKMARK","DOCUMENT_ADD_TO_WEBPANEL","DOCUMENT_SEND_BY_MAIL","DOCUMENT_SAVE","DOCUMENT_PRINT","DOCUMENT_CAST","DOCUMENT_COPY_ADDRESS","DOCUMENT_CONTAINER_SEND_TO_DEVICES","DOCUMENT_CONTAINER_EXTENSIONS","DOCUMENT_QR_CODE","DOCUMENT_CONTAINER_PLUGIN_ROTATION"].concat(On.actions())},options:function(e,t,n){const i=void 0===n,s=n||xn.settingsState,o={...G.Z.commandItem};switch(t.action){case"DOCUMENT_BACK":{const t=s.iswebpanel?[]:xn.getShortcuts(e,"COMMAND_PAGE_BACK");return{...o,shortcuts:t,...(0,Mn.Z)("navigation","Back")}}case"DOCUMENT_FORWARD":{const t=s.iswebpanel?[]:xn.getShortcuts(e,"COMMAND_PAGE_FORWARD");return{...o,shortcuts:t,...(0,Mn.Z)("navigation","Forward")}}case"DOCUMENT_RELOAD":{const t=s.iswebpanel?[]:xn.getShortcuts(e,"COMMAND_PAGE_REFRESH");return{...o,shortcuts:t,...(0,Mn.Z)("navigation","Reload")}}case"COMMAND_ADD_BOOKMARK":return{...U.Z.getMenuItem(e,t,i),...o,...(0,Mn.Z)("command","Bookmark Page")};case"DOCUMENT_ADD_TO_WEBPANEL":return{...o,...(0,Mn.Z)("Add Page to Web Panel")};case"DOCUMENT_SEND_BY_MAIL":return{...o,...(0,Mn.Z)("Send by Mail")};case"DOCUMENT_SAVE":{const t=s.iswebpanel?[]:xn.getShortcuts(e,"COMMAND_SAVE_PAGE");return o.ellipsis=!0,{...o,shortcuts:t,...(0,Mn.Z)("Save As")}}case"DOCUMENT_PRINT":{const t=s.iswebpanel?[]:xn.getShortcuts(e,"COMMAND_PRINT_PAGE");return o.ellipsis=!0,{...o,shortcuts:t,...(0,Mn.Z)("command","Print")}}case"DOCUMENT_CAST":return o.ellipsis=!0,{...o,...(0,Mn.Z)("Cast")};case"DOCUMENT_COPY_ADDRESS":return{...o,...s.iswebpanel?(0,Mn.Z)("Copy Panel Address"):(0,Mn.Z)("Copy Page Address")};case"DOCUMENT_CONTAINER_SEND_TO_DEVICES":return o.settingsLabel=(0,le.Z)("[Send to Your Devices]"),o.type="container",{...o,...(0,Mn.Z)("Send to Your Devices")};case"DOCUMENT_QR_CODE":{const t=s.iswebpanel?[]:xn.getShortcuts(e,"COMMAND_PAGE_QR_CODE");return{...o,shortcuts:t,...(0,Mn.Z)("command","Create QR Code for This Page")}}case"DOCUMENT_CONTAINER_EXTENSIONS":return o.settingsLabel=(0,le.Z)("[Extensions]"),o.type="container",{...o,...(0,Mn.Z)("Extensions")};case"DOCUMENT_CONTAINER_PLUGIN_ROTATION":return o.settingsLabel=(0,le.Z)("[Plugin Rotation Commands]"),o.type="container",{...o,...(0,Mn.Z)("Plugin Rotation")};default:return On.actions().includes(t.action)?On.options(e,t,n):U.Z.getMenuItem(e,t,i)}}};const ti={actions:function(){return["CONTEXT_OPEN_IN_NEW_TAB","CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB","CONTEXT_OPEN_IN_TAB","CONTEXT_OPEN_IN_NEW_WINDOW","CONTEXT_OPEN_IN_PRIVATE_WINDOW","CONTEXT_COPY_ADDRESS","CONTEXT_DESKTOP_VERSION","CONTEXT_MOBILE_VERSION","CONTEXT_SEPARATE_WIDTH","CONTEXT_CONTAINER_TOOLBAR","CONTEXT_REMOVE_WEB_PANEL","CONTEXT_CONTAINER_REG_PANELS","CONTEXT_CONTAINER_WEB_PANELS","CONTEXT_CONTAINER_REMOVED_PANELS","CONTEXT_CONTAINER_PERIODIC_TIMER","CONTEXT_CONTAINER_FLOATING"]},options:function(e,t,n){const i=void 0===n,s={...G.Z.commandItem};switch(t.action){case"CONTEXT_CONTAINER_PERIODIC_TIMER":return s.settingsLabel=(0,le.Z)("[Periodic Reload]"),s.type="container",{...s,...(0,Mn.Z)("Periodic Reload")};case"CONTEXT_MENU_OPEN":return s.type="folder",{...s,...(0,Mn.Z)("Open in")};case"CONTEXT_OPEN_IN_NEW_TAB":return{...s,...(0,Mn.Z)("open in","New Tab")};case"CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB":return{...s,...(0,Mn.Z)("Background Tab")};case"CONTEXT_OPEN_IN_TAB":return{...s,...(0,Mn.Z)("Current Tab")};case"CONTEXT_OPEN_IN_NEW_WINDOW":return{...s,...(0,Mn.Z)("open in","New Window")};case"CONTEXT_OPEN_IN_PRIVATE_WINDOW":return{...s,...(0,Mn.Z)("open in","Private Window")};case"CONTEXT_COPY_ADDRESS":return{...s,...(0,Mn.Z)("Copy Panel Address")};case"CONTEXT_DESKTOP_VERSION":return{...s,...(0,Mn.Z)("Show Desktop Version")};case"CONTEXT_MOBILE_VERSION":return{...s,...(0,Mn.Z)("Show Mobile Version")};case"CONTEXT_CONTAINER_FLOATING":return s.settingsLabel=(0,le.Z)("[Separate Floating]"),s.type="container",{...s,...(0,Mn.Z)("Floating Panel")};case"CONTEXT_SEPARATE_WIDTH":return s.type="checkbox",{...s,...(0,Mn.Z)("Separate Width")};case"CONTEXT_CONTAINER_TOOLBAR":return s.settingsLabel=(0,le.Z)("[Toolbar]"),s.type="container",{...s,...(0,Mn.Z)("Toolbar")};case"CONTEXT_REMOVE_WEB_PANEL":return{...s,...(0,Mn.Z)("Remove Web Panel")};case"CONTEXT_MENU_PANEL":return s.type="folder",{...s,...(0,Mn.Z)("Panels")};case"CONTEXT_CONTAINER_REG_PANELS":return s.settingsLabel=(0,le.Z)("[All Regular Panels]"),s.type="container",{...s,...(0,Mn.Z)("Regular Panels")};case"CONTEXT_CONTAINER_WEB_PANELS":return s.settingsLabel=(0,le.Z)("[All Web Panels]"),s.type="container",{...s,...(0,Mn.Z)("Web Panels")};case"CONTEXT_CONTAINER_REMOVED_PANELS":return s.settingsLabel=(0,le.Z)("[All Removed Panels]"),s.type="container",{...s,...(0,Mn.Z)("Removed Panels")};default:return U.Z.getMenuItem(e,t,i)}}};const ni={actions:function(){return["CONTEXT_CONTAINER_REG_PANELS","CONTEXT_CONTAINER_WEB_PANELS","CONTEXT_CONTAINER_REMOVED_PANELS"]},options:function(e,t,n){const i=void 0===n,s={...G.Z.commandItem};switch(t.action){case"CONTEXT_CONTAINER_REG_PANELS":return s.settingsLabel=(0,le.Z)("[All Regular Panels]"),s.type="container",{...s,...(0,Mn.Z)("Regular Panels")};case"CONTEXT_CONTAINER_WEB_PANELS":return s.settingsLabel=(0,le.Z)("[All Web Panels]"),s.type="container",{...s,...(0,Mn.Z)("Web Panels")};case"CONTEXT_CONTAINER_REMOVED_PANELS":return s.settingsLabel=(0,le.Z)("[All Removed Panels]"),s.type="container",{...s,...(0,Mn.Z)("Removed Panels")};default:return U.Z.getMenuItem(e,t,i)}}};const ii={actions:function(){return["CONTEXT_OPEN","CONTEXT_MARK_READ","CONTEXT_MARK_UNREAD","CONTEXT_COPY","CONTEXT_DELETE"]},options:function(e,t,n){const i=void 0===n,s={...G.Z.commandItem};switch(t.action){case"CONTEXT_OPEN":return{...s,...(0,Mn.Z)("verb","Open")};case"CONTEXT_MARK_READ":return{...s,...(0,Mn.Z)("Mark as Read")};case"CONTEXT_MARK_UNREAD":return{...s,...(0,Mn.Z)("Mark as Unread")};case"CONTEXT_COPY_URL":return{...s,...(0,Mn.Z)("verb","Copy Address")};case"CONTEXT_DELETE":return{...s,...(0,Mn.Z)("verb","Remove")};default:return U.Z.getMenuItem(e,t,i)}}};const si={actions:function(){return["CONTEXT_OPEN_IN_NEW_TAB","CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB","CONTEXT_OPEN_IN_TAB","CONTEXT_OPEN_IN_NEW_WINDOW","CONTEXT_OPEN_IN_PRIVATE_WINDOW","CONTEXT_CONTAINER_OPEN_IN_WINDOW","CONTEXT_OPEN_ALL","CONTEXT_SET_THUMBNAIL","CONTEXT_CLEAR_THUMBNAIL","CONTEXT_RELOAD","CONTEXT_EDIT","CONTEXT_RENAME","CONTEXT_CUT","CONTEXT_COPY","CONTEXT_PASTE","CONTEXT_DELETE","COMMAND_TOGGLE_STARTPAGE_NAVIGATION"]},options:function(e,t,n){const i=void 0===n,s={...G.Z.commandItem};switch(t.action){case"CONTEXT_OPEN_IN_NEW_TAB":return{...s,...(0,Mn.Z)("Open in New Tab")};case"CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB":return{...s,...(0,Mn.Z)("Open in Background Tab")};case"CONTEXT_OPEN_IN_TAB":return{...s,...(0,Mn.Z)("Open")};case"CONTEXT_OPEN_IN_NEW_WINDOW":return{...s,...(0,Mn.Z)("Open in New Window")};case"CONTEXT_OPEN_IN_PRIVATE_WINDOW":return{...s,...(0,Mn.Z)("Open in Private Window")};case"CONTEXT_CONTAINER_OPEN_IN_WINDOW":return s.settingsLabel=(0,le.Z)("[Open in Another Window]"),s.type="container",{...s,...(0,Mn.Z)("Open in Another Window")};case"CONTEXT_OPEN_ALL":return{...s,...(0,Mn.Z)("Open All Bookmarks")};case"CONTEXT_SET_THUMBNAIL":return s.ellipsis=!0,{...s,...(0,Mn.Z)("Select Custom Thumbnail")};case"CONTEXT_CLEAR_THUMBNAIL":return{...s,...(0,Mn.Z)("Clear Custom Thumbnail")};case"CONTEXT_RELOAD":return{...s,...(0,Mn.Z)("Reload")};case"CONTEXT_EDIT":return{...s,...(0,Mn.Z)("command","Edit")};case"CONTEXT_RENAME":return{...s,...(0,Mn.Z)("Rename")};case"CONTEXT_CUT":return{...s,...(0,Mn.Z)("win_linux","Cut")};case"CONTEXT_COPY":return{...s,...(0,Mn.Z)("win_linux","Copy")};case"CONTEXT_PASTE":return{...s,...(0,Mn.Z)("win_linux","Paste")};case"CONTEXT_DELETE":return{...s,...(0,Mn.Z)("other","Delete")};default:return U.Z.getMenuItem(e,t,i)}}};const oi={actions:function(){return["CONTEXT_RENAME","CONTEXT_REMOVE","COMMAND_TOGGLE_STARTPAGE_NAVIGATION"]},options:function(e,t,n){const i=void 0===n,s={...G.Z.commandItem};switch(t.action){case"CONTEXT_RENAME":return{...s,...(0,Mn.Z)("Rename")};case"CONTEXT_REMOVE":return{...s,...(0,Mn.Z)("Remove from Speed Dial")};default:return U.Z.getMenuItem(e,t,i)}}};const ai={actions:function(){return["CONTEXT_ADD_BOOKMARK_TO_SPEEDDIAL","CONTEXT_ADD_FOLDER_TO_SPEEDDIAL","CONTEXT_PASTE","CONTEXT_CUSTOMIZE","COMMAND_TOGGLE_STARTPAGE_NAVIGATION"]},options:function(e,t,n){const i=void 0===n,s={...G.Z.commandItem};switch(t.action){case"CONTEXT_ADD_BOOKMARK_TO_SPEEDDIAL":return{...s,...(0,Mn.Z)("command","Add Bookmark to Speed Dial")};case"CONTEXT_ADD_FOLDER_TO_SPEEDDIAL":return{...s,...(0,Mn.Z)("command","Add Speed Dial Folder")};case"CONTEXT_PASTE":return{...s,...(0,Mn.Z)("win_linux","Paste")};case"CONTEXT_CUSTOMIZE":return s.ellipsis=!0,{...s,...(0,Mn.Z)("other","Customize")};default:return U.Z.getMenuItem(e,t,i)}}};const ri={actions:function(){return["CONTEXT_NEW","CONTEXT_TOGGLE_SUBSTRIP_LOCK","CONTEXT_BOOKMARK_ALL","CONTEXT_SAVE_SESSION","CONTEXT_REOPEN"]},options:function(e,t,n){const i=void 0===n,s={...G.Z.commandItem};switch(t.action){case"CONTEXT_LOCK_SUBSTRIP":case"CONTEXT_UNLOCK_SUBSTRIP":return{...s,visible:!1};case"CONTEXT_NEW":return{...s,...(0,Mn.Z)("command","New Tab")};case"CONTEXT_TOGGLE_SUBSTRIP_LOCK":return{...s,...(0,Mn.Z)("Lock Second Tab Row")};case"CONTEXT_BOOKMARK_ALL":return{...s,...(0,Mn.Z)("Bookmark All Tabs")};case"CONTEXT_SAVE_SESSION":return U.Z.getMenuItem(e,{...t,action:"COMMAND_SAVE_SESSION"},i);case"CONTEXT_REOPEN":return U.Z.getMenuItem(e,{...t,action:"COMMAND_TAB_REOPEN_RECENTLY_CLOSED"},i);default:return U.Z.getMenuItem(e,t,i)}}};const li={actions:function(){return["CONTEXT_CONTAINER_TAB_OVERFLOW"]},options:function(e,t,n){const i=void 0===n,s={...G.Z.commandItem};return"CONTEXT_CONTAINER_TAB_OVERFLOW"===t.action?{...s,...(0,Mn.Z)("Open Tab")}:U.Z.getMenuItem(e,t,i)}};const di={actions:function(){return["CONTEXT_CLOSE","CONTEXT_TABSTACK_REMOVE_FROM"]},options:function(e,t,n){const i=void 0===n,s={...G.Z.commandItem};switch(t.action){case"CONTEXT_CLOSE":return{...s,...(0,Mn.Z)("Close Tab")};case"CONTEXT_TABSTACK_REMOVE_FROM":return{...s,...(0,Mn.Z)("Remove from Tab Stack")};default:return U.Z.getMenuItem(e,t,i)}}};const ci={actions:function(){return["CONTEXT_NEW","CONTEXT_RELOAD","CONTEXT_CLONE","CONTEXT_PIN","CONTEXT_UNPIN","CONTEXT_MUTE","CONTEXT_MUTE_OTHER","CONTEXT_OPTIMIZE_FS_VIDEOS","CONTEXT_BOOKMARK","CONTEXT_BOOKMARK_STACK","CONTEXT_BOOKMARK_ALL","CONTEXT_SAVE_SESSION","CONTEXT_TABSTACK_BY_SELECTION","CONTEXT_TABSTACK_BY_HOST","CONTEXT_TABSTACK_RENAME","CONTEXT_TABSTACK_RELOAD","CONTEXT_TABSTACK_REMOVE_FROM","CONTEXT_TABSTACK_UNGROUP","CONTEXT_TILE_TABSTACK","CONTEXT_UNTILE_TABSTACK","CONTEXT_TILE_TABS","CONTEXT_UNTILE_SELECTION","CONTEXT_HIBERNATE_TAB","CONTEXT_HIBERNATE_SELECTED_BACKGROUND_TABS","CONTEXT_HIBERNATE_TABSTACK","CONTEXT_HIBERNATE_BACKGROUND","CONTEXT_CLOSE","CONTEXT_CLOSE_TABSTACK","CONTEXT_CLOSE_OTHER","CONTEXT_CLOSE_LEFT","CONTEXT_CLOSE_RIGHT","CONTEXT_REOPEN","CONTEXT_CUSTOMIZE","CONTEXT_CONTAINER_PWA","CONTEXT_CONTAINER_MOVE_TO_WINDOW","CONTEXT_MOVE","CONTEXT_TABSTACK_MOVE","CONTEXT_MOVE_LEFT","CONTEXT_MOVE_RIGHT","CONTEXT_CONTAINER_PERIODIC_TIMER","CONTEXT_TABSTACK_BY_HOSTS","CONTEXT_MOVE_STACK_LEFT","CONTEXT_MOVE_STACK_RIGHT"]},options:function(e,t,n){const i=n||{isMultiSelect:!1,count:-1,closableCount:-1,unSelectedCount:0,unpinned:0,pinned:0,playing:0,hostname:"",hostnameCount:-1,canHibernateCount:-1,horizontal:!0,someIncognito:!1,canCloneCount:-1},s=void 0===n,o={...G.Z.commandItem};switch(t.action){case"CONTEXT_NEW":return{...o,...(0,Mn.Z)("command","New Tab")};case"CONTEXT_RELOAD":return{...o,...i.isMultiSelect?(0,Mn.Z)("Reload $1 Tab","Reload $1 Tabs",[i.count]):(0,Mn.Z)("Reload Tab")};case"CONTEXT_CLONE":return{...o,...i.isMultiSelect?(0,Mn.Z)("Clone $1 Tab","Clone $1 Tabs",[i.canCloneCount]):(0,Mn.Z)("Clone Tab")};case"CONTEXT_PIN":return{...o,...i.isMultiSelect?(0,Mn.Z)("Pin $1 Tab","Pin $1 Tabs",[i.unpinned]):(0,Mn.Z)("Pin Tab")};case"CONTEXT_UNPIN":return{...o,...i.isMultiSelect?(0,Mn.Z)("Unpin $1 Tab","Unpin $1 Tabs",[i.pinned]):(0,Mn.Z)("Unpin Tab")};case"CONTEXT_CONTAINER_PERIODIC_TIMER":return o.settingsLabel=(0,le.Z)("[Periodic Reload]"),o.type="container",{...o,...(0,Mn.Z)("Periodic Reload")};case"CONTEXT_MUTE":return o.type="checkbox",{...o,...i.isMultiSelect?(0,Mn.Z)("Mute $1 Tab","Mute $1 Tabs",[i.playing]):(0,Mn.Z)("Mute Tab")};case"CONTEXT_MUTE_OTHER":return{...o,...(0,Mn.Z)("Mute Other Tabs")};case"CONTEXT_OPTIMIZE_FS_VIDEOS":return{...o,...(0,Mn.Z)("Optimize fullscreen videos")};case"CONTEXT_BOOKMARK":return{...o,...i.isMultiSelect?(0,Mn.Z)("Bookmark $1 Tab","Bookmark $1 Tabs",[i.count]):(0,Mn.Z)("Bookmark Tab")};case"CONTEXT_BOOKMARK_STACK":return{...o,...(0,Mn.Z)("Bookmark Tab Stack")};case"CONTEXT_BOOKMARK_ALL":return{...o,...(0,Mn.Z)("Bookmark All Tabs")};case"CONTEXT_SAVE_SESSION":return{...o,...i.count>0?(0,Mn.Z)("Save $1 Selected Tab as Session","Save $1 Selected Tabs as Session",[i.count]):(0,Mn.Z)("Save All Tabs as Session")};case"CONTEXT_TABSTACK_BY_SELECTION":return{...o,...s?(0,Mn.Z)("Stack Selected Tabs"):(0,Mn.Z)("Stack $1 Selected Tab","Stack $1 Selected Tabs",[i.unpinned])};case"CONTEXT_TABSTACK_BY_HOST":return{...o,...s?(0,Mn.Z)("Stack Tabs by Host"):(0,Mn.Z)("Stack Tabs by Host ($1 of $2)",[i.hostnameCount,i.hostname])};case"CONTEXT_TABSTACK_BY_HOSTS":return{...o,...(0,Mn.Z)("Stack Tabs by Hosts")};case"CONTEXT_TABSTACK_RELOAD":return{...o,...(0,Mn.Z)("Reload Tab Stack")};case"CONTEXT_TABSTACK_RENAME":return{...o,...(0,Mn.Z)("Rename Tab Stack")};case"CONTEXT_TABSTACK_REMOVE_FROM":return{...o,...(0,Mn.Z)("Remove from Tab Stack")};case"CONTEXT_TABSTACK_UNGROUP":return{...o,...(0,Mn.Z)("Unstack Tabs")};case"CONTEXT_TILE_TABSTACK":return{...o,...(0,Mn.Z)("Tile Tab Stack")};case"CONTEXT_UNTILE_TABSTACK":return{...o,...(0,Mn.Z)("Untile Tab Stack")};case"CONTEXT_TILE_TABS":return{...o,...s?(0,Mn.Z)("Tile Tabs"):(0,Mn.Z)("Tile $1 Tab","Tile $1 Tabs",[i.count])};case"CONTEXT_UNTILE_SELECTION":return{...o,...(0,Mn.Z)("Untile Selection")};case"CONTEXT_HIBERNATE_TAB":return{...o,...(0,Mn.Z)("Hibernate Tab")};case"CONTEXT_HIBERNATE_SELECTED_BACKGROUND_TABS":return{...o,...s?(0,Mn.Z)("Hibernate Selected Background Tabs"):(0,Mn.Z)("Hibernate $1 Background Tab","Hibernate $1 Background Tabs",[i.canHibernateCount])};case"CONTEXT_HIBERNATE_TABSTACK":return{...o,...(0,Mn.Z)("Hibernate Tab Stack")};case"CONTEXT_HIBERNATE_BACKGROUND":return{...o,...(0,Mn.Z)("Hibernate Background Tabs")};case"CONTEXT_CLOSE":return{...o,...i.isMultiSelect?(0,Mn.Z)("Close $1 Tab","Close $1 Tabs",[i.closableCount]):(0,Mn.Z)("Close Tab")};case"CONTEXT_CLOSE_TABSTACK":return{...o,...(0,Mn.Z)("Close Tab Stack")};case"CONTEXT_CLOSE_OTHER":return{...o,...i.isMultiSelect&&i.unSelectedCount>0?(0,Mn.Z)("Close Other ($1 Unselected Tab)","Close Other ($1 Unselected Tabs)",[i.unSelectedCount]):(0,Mn.Z)("Close Other Tabs")};case"CONTEXT_CLOSE_LEFT":return{...o,...i.horizontal?(0,Mn.Z)("Close Tabs to the Left"):(0,Mn.Z)("Close the Tabs Above")};case"CONTEXT_CLOSE_RIGHT":return{...o,...i.horizontal?(0,Mn.Z)("Close Tabs to the Right"):(0,Mn.Z)("Close the Tabs Below")};case"CONTEXT_REOPEN":return U.Z.getMenuItem(e,{...t,action:"COMMAND_TAB_REOPEN_RECENTLY_CLOSED"},s);case"CONTEXT_CUSTOMIZE":return o.ellipsis=!0,{...o,...(0,Mn.Z)("panel","Customize")};case"CONTEXT_CONTAINER_PWA":return o.settingsLabel=(0,le.Z)("[All Progressive Web Apps]"),o.type="container",{...o,...(0,Mn.Z)("Progressive Web Apps")};case"CONTEXT_CONTAINER_MOVE_TO_WINDOW":return o.settingsLabel=(0,le.Z)("[All Window Destinations]"),o.type="container",{...o,...(0,Mn.Z)("Window Destinations")};case"CONTEXT_MOVE":return o.type="folder",{...o,...i.isMultiSelect&&!i.someIncognito?(0,Mn.Z)("Move $1 Tab","Move $1 Tabs",[i.count]):(0,Mn.Z)("Move Tab")};case"CONTEXT_TABSTACK_MOVE":return o.type="folder",{...o,...(0,Mn.Z)("Move Tab Stack")};case"CONTEXT_MOVE_LEFT":case"CONTEXT_MOVE_STACK_LEFT":return{...o,...i.horizontal?(0,Mn.Z)("navigation","Left"):(0,Mn.Z)("Up")};case"CONTEXT_MOVE_RIGHT":case"CONTEXT_MOVE_STACK_RIGHT":return{...o,...i.horizontal?(0,Mn.Z)("navigation","Right"):(0,Mn.Z)("Down")};default:return U.Z.getMenuItem(e,t,s)}}};const hi={actions:function(){return["CONTEXT_COPY","CONTEXT_DELETE"]},options:function(e,t,n){const i=void 0===n,s={...G.Z.commandItem};switch(t.action){case"CONTEXT_COPY":return{...s,...(0,Mn.Z)("verb","Copy")};case"CONTEXT_COPY_ALL":return{...s,...(0,Mn.Z)("Copy Both")};case"CONTEXT_DELETE":return{...s,...(0,Mn.Z)("verb","Delete")};default:return U.Z.getMenuItem(e,t,i)}}};const pi={actions:function(){return["DOCUMENT_LOOK_UP","DOCUMENT_EMOJI","DOCUMENT_UNDO","DOCUMENT_REDO","DOCUMENT_CUT","DOCUMENT_COPY","DOCUMENT_PASTE","DOCUMENT_PASTE_AS_PLAIN_TEXT","DOCUMENT_SELECT_ALL","DOCUMENT_CONTAINER_NOTES","DOCUMENT_CONTAINER_SPELLCHECK","DOCUMENT_CONTAINER_SPELLCHECK_OPTIONS","DOCUMENT_CONTAINER_SPEECH"]},options:function(e,t,n){const i=void 0===n,s={...G.Z.commandItem},o=n||xn.settingsState;switch(t.action){case"DOCUMENT_LOOK_UP":return{...s,...xn.getLabelWithParameter(e,t,o.printableselection,i)};case"DOCUMENT_EMOJI":return{...s,...(0,Mn.Z)("Emoji && Symbols")};case"DOCUMENT_UNDO":return{...s,shortcuts:["ctrl+z"],...(0,Mn.Z)("win_linux","Undo")};case"DOCUMENT_REDO":return{...s,shortcuts:["ctrl+y"],...(0,Mn.Z)("win_linux","Redo")};case"DOCUMENT_CUT":return{...s,shortcuts:["ctrl+x"],...(0,Mn.Z)("win_linux","Cut")};case"DOCUMENT_COPY":return{...s,shortcuts:["ctrl+c"],...(0,Mn.Z)("win_linux","Copy")};case"DOCUMENT_PASTE":return{...s,shortcuts:["ctrl+v"],...(0,Mn.Z)("win_linux","Paste")};case"DOCUMENT_PASTE_AS_PLAIN_TEXT":{const t=xn.getShortcuts(e,"COMMAND_CLIPBOARD_PASTE_AS_PLAIN_TEXT");return{...s,shortcuts:t,...(0,Mn.Z)("win_linux","Paste as Plain Text")}}case"DOCUMENT_SELECT_ALL":return{...s,shortcuts:["ctrl+a"],...(0,Mn.Z)("win_linux","Select All")};case"DOCUMENT_CONTAINER_NOTES":return s.settingsLabel=(0,le.Z)("[All notes]"),s.type="container",{...s,...(0,Mn.Z)("Insert Note")};case"DOCUMENT_CONTAINER_SPELLCHECK":return s.settingsLabel=(0,le.Z)("[Spell Check]"),s.type="container",{...s,...(0,Mn.Z)("Spell Check")};case"DOCUMENT_CONTAINER_SPELLCHECK_OPTIONS":return s.settingsLabel=(0,le.Z)("[Spell Check Options]"),s.type="container",{...s,...(0,Mn.Z)("Spell Check Options")};case"DOCUMENT_CONTAINER_WRITING_DIRECTION":return s.settingsLabel=(0,le.Z)("[Writing Direction Options]"),s.type="container",{...s,...(0,Mn.Z)("Writing Direction")};case"DOCUMENT_CONTAINER_SPEECH":return s.settingsLabel=(0,le.Z)("[Speech Commands]"),s.type="container",{...s,...(0,Mn.Z)("Speech")};default:return U.Z.getMenuItem(e,t,i)}}};var ui=n(21788);const gi={actions:function(){return["DOCUMENT_LOOK_UP","DOCUMENT_EMOJI","DOCUMENT_UNDO","DOCUMENT_REDO","DOCUMENT_CUT","DOCUMENT_COPY","COMMAND_CLIPBOARD_COPY_FILTERED","DOCUMENT_PASTE","COMMAND_CLIPBOARD_PASTE_AS_PLAIN_TEXT_OR_PASTE_AND_GO","DOCUMENT_SELECT_ALL","DOCUMENT_CONTAINER_NOTES","DOCUMENT_CONTAINER_SPELLCHECK","DOCUMENT_CONTAINER_SPELLCHECK_OPTIONS","DOCUMENT_CUSTOMIZE","DOCUMENT_SHOW_FULL_ADDRESS","DOCUMENT_CONTAINER_SPEECH"]},options:function(e,t,n){const i=void 0===n,s={...G.Z.commandItem},o=n||xn.settingsState;switch(t.action){case"DOCUMENT_LOOK_UP":return{...s,...xn.getLabelWithParameter(e,t,o.printableselection,i)};case"DOCUMENT_EMOJI":return{...s,...(0,Mn.Z)("Emoji && Symbols")};case"DOCUMENT_UNDO":return{...s,shortcuts:["ctrl+z"],...(0,Mn.Z)("win_linux","Undo")};case"DOCUMENT_REDO":return{...s,shortcuts:["ctrl+y"],...(0,Mn.Z)("win_linux","Redo")};case"DOCUMENT_CUT":return{...s,shortcuts:["ctrl+x"],...(0,Mn.Z)("win_linux","Cut")};case"DOCUMENT_COPY":return{...s,shortcuts:["ctrl+c"],...(0,Mn.Z)("win_linux","Copy")};case"COMMAND_CLIPBOARD_COPY_FILTERED":return{visible:n&&n.selection.length>0,handler:()=>{n&&ui.Z.copyWithFilter(n.selection)},...s,...(0,Mn.Z)("Copy without parameters")};case"DOCUMENT_PASTE":return{...s,shortcuts:["ctrl+v"],...(0,Mn.Z)("win_linux","Paste")};case"DOCUMENT_SELECT_ALL":return{...s,shortcuts:["ctrl+a"],...(0,Mn.Z)("win_linux","Select All")};case"DOCUMENT_CONTAINER_NOTES":return s.settingsLabel=(0,le.Z)("[All notes]"),s.type="container",{...s,...(0,Mn.Z)("Insert Note")};case"DOCUMENT_CONTAINER_SPELLCHECK":return s.settingsLabel=(0,le.Z)("[Spell Check]"),s.type="container",{...s,...(0,Mn.Z)("Spell Check")};case"DOCUMENT_CONTAINER_SPELLCHECK_OPTIONS":return s.settingsLabel=(0,le.Z)("[Spell Check Options]"),s.type="container",{...s,...(0,Mn.Z)("Spell Check Options")};case"DOCUMENT_CONTAINER_WRITING_DIRECTION":return s.settingsLabel=(0,le.Z)("[Writing Direction Options]"),s.type="container",{...s,...(0,Mn.Z)("Writing Direction")};case"DOCUMENT_CUSTOMIZE":return s.ellipsis=!0,{...s,...(0,Mn.Z)("panel","Customize")};case"DOCUMENT_SHOW_FULL_ADDRESS":return s.type="checkbox",{...s,...(0,Mn.Z)("Show Full Address")};case"DOCUMENT_CONTAINER_SPEECH":return s.settingsLabel=(0,le.Z)("[Speech Commands]"),s.type="container",{...s,...(0,Mn.Z)("Speech")};default:return U.Z.getMenuItem(e,t,i)}}};const mi={actions:function(){return["CONTEXT_NEW","CONTEXT_NEW_STACK","CONTEXT_NEW_STACK_FOR_HOST","CONTEXT_TABSTACK_UNGROUP","CONTEXT_CLONE","CONTEXT_RELOAD","CONTEXT_HIBERNATE_TAB","CONTEXT_PIN","CONTEXT_UNPIN","CONTEXT_TILE_TABS","CONTEXT_UNTILE_TABS","CONTEXT_MUTE","CONTEXT_MUTE_OTHER","CONTEXT_UNMUTE","CONTEXT_RENAME","CONTEXT_COPY","CONTEXT_SAVE","CONTEXT_SAVE_ALL","CONTEXT_EXPORT","CONTEXT_EXPORT_ALL","CONTEXT_DELETE","CONTEXT_EMPTY_TRASH","CONTEXT_REOPEN","CONTEXT_EXPAND_ALL","CONTEXT_COLLAPSE_ALL"]},options:function(e,t,n){const i=n||{hostname:"",selectedCount:0},s=void 0===n,o={...G.Z.commandItem};switch(t.action){case"CONTEXT_NEW":return{...o,...(0,Mn.Z)("command","New Tab")};case"CONTEXT_NEW_STACK":return{...o,...(0,Mn.Z)("Stack $1 Selected Tab","Stack $1 Selected Tabs",[i.selectedCount])};case"CONTEXT_NEW_STACK_FOR_HOST":return{...o,...s?(0,Mn.Z)("Stack Tabs by Host"):(0,Mn.Z)("Stack Tabs by Host ($1)",[i.hostname])};case"CONTEXT_TABSTACK_UNGROUP":return{...o,...(0,Mn.Z)("Unstack Tabs")};case"CONTEXT_CLONE":return{...o,...(0,Mn.Z)("Clone")};case"CONTEXT_RELOAD":return{...o,...(0,Mn.Z)("Reload")};case"CONTEXT_HIBERNATE_TAB":return{...o,...(0,Mn.Z)("Hibernate")};case"CONTEXT_PIN":return{...o,...(0,Mn.Z)("Pin")};case"CONTEXT_UNPIN":return{...o,...(0,Mn.Z)("Unpin")};case"CONTEXT_TILE_TABS":return{...o,...(0,Mn.Z)("Tile")};case"CONTEXT_UNTILE_TABS":return{...o,...(0,Mn.Z)("Untile")};case"CONTEXT_MUTE":return{...o,...(0,Mn.Z)("Mute")};case"CONTEXT_MUTE_OTHER":return{...o,...(0,Mn.Z)("Mute Others")};case"CONTEXT_UNMUTE":return{...o,...(0,Mn.Z)("Unmute")};case"CONTEXT_RENAME":return{...o,...(0,Mn.Z)("Rename")};case"CONTEXT_COPY":return{...o,...(0,Mn.Z)("Copy Address")};case"CONTEXT_SAVE":return{...o,...(0,Mn.Z)("Save as Bookmarks")};case"CONTEXT_SAVE_ALL":return{...o,...(0,Mn.Z)("Save All as Bookmarks")};case"CONTEXT_EXPORT":return{...o,...(0,Mn.Z)("Save as Session")};case"CONTEXT_EXPORT_ALL":return{...o,...(0,Mn.Z)("Save All as Session")};case"CONTEXT_DELETE":return{...o,...(0,Mn.Z)("Close")};case"CONTEXT_EMPTY_TRASH":return{...o,...(0,Mn.Z)("command","Clear All")};case"CONTEXT_REOPEN":return{...o,...(0,Mn.Z)("Reopen")};case"CONTEXT_EXPAND_ALL":return{...o,...(0,Mn.Z)("Expand All Folders")};case"CONTEXT_COLLAPSE_ALL":return{...o,...(0,Mn.Z)("Collapse All Folders")};default:return U.Z.getMenuItem(e,t,s)}}},vi=[{name:(0,le.Z)("Web Page"),group:"8",indent:0,sort:!0},{name:(0,le.Z)("Mail"),group:"6",indent:0,sort:!0},{name:(0,le.Z)("section","Start page"),group:"1",indent:0,sort:!0},{name:(0,le.Z)("Panels"),group:"4",indent:0,sort:!0},{name:(0,le.Z)("Tabs"),group:"2",indent:0,sort:!0},{name:(0,le.Z)("Bookmarks"),group:"5",indent:0,sort:!0},{name:(0,le.Z)("context","Address Bar"),group:"3",indent:0,sort:!1},{name:(0,le.Z)("Other"),group:"7",indent:0,sort:!0}],fi={tab:{name:(0,le.Z)("context","Tab"),group:"2",...ci},tabstackthumbnails:{name:(0,le.Z)("Tab Stack Thumbnails"),group:"2",...di},tabbar:{name:(0,le.Z)("context","Tab Bar"),group:"2",...ri},closedtab:{name:(0,le.Z)("Tab Trash Can"),group:"2",...Un},taboverflow:{name:(0,le.Z)("Tab Overflow"),group:"2",...li},windowlist:{name:(0,le.Z)("Window List"),group:"2",...mi},bookmarkbar:{name:(0,le.Z)("Bookmark Bar"),group:"5",...Bn},bookmarkbaritem:{name:(0,le.Z)("Bookmark Bar Button"),group:"5",...Rn},bookmarklist:{name:(0,le.Z)("Bookmark List"),group:"5",...Fn},panelbar:{name:(0,le.Z)("Panel Bar"),group:"4",...ni},panelbaritem:{name:(0,le.Z)("Panel Bar Button"),group:"4",...ti},backwardbutton:{name:(0,le.Z)("Back Button"),group:"3",...qn},forwardbutton:{name:(0,le.Z)("Forward Button"),group:"3",...qn},rewindbutton:{name:(0,le.Z)("Rewind Button"),group:"3",...qn},fastforwardbutton:{name:(0,le.Z)("Fast Forward Button"),group:"3",...qn},reloadbutton:{name:(0,le.Z)("Reload Button"),group:"3",...qn},homebutton:{name:(0,le.Z)("Home Button"),group:"3",...qn},urledit:{name:(0,le.Z)("Text Field"),group:"3",...gi},speeddialitem:{name:(0,le.Z)("Speed Dial Button"),group:"1",...si},startpage:{name:(0,le.Z)("context","Start Page"),group:"1",...ai},startpagebar:{name:(0,le.Z)("Start Page Bar"),group:"1",...oi},mailheader:{name:(0,le.Z)("Message Header"),group:"6",...Yn},mailpanellist:{name:(0,le.Z)("mail","Panel"),group:"6",...Xn},mailsearchlist:{name:(0,le.Z)("Message List"),group:"6",...Qn},mailcontent:{name:(0,le.Z)("Message Content"),group:"6",...jn},contactlist:{name:(0,le.Z)("Contacts"),group:"6",...Vn},noteslist:{name:(0,le.Z)("Notes List"),group:"7",...Jn},historylist:{name:(0,le.Z)("History List"),group:"7",...zn},downloadlist:{name:(0,le.Z)("Download List"),group:"7",...Hn},translatehistory:{name:(0,le.Z)("Translate History"),group:"7",...hi},readinglist:{name:(0,le.Z)("Reading List"),group:"7",...ii},uiedit:{name:(0,le.Z)("Text Field"),group:"7",...pi},link:{name:(0,le.Z)("Link"),group:"8",...Kn},image:{name:(0,le.Z)("Image"),group:"8",...Gn},page:{name:(0,le.Z)("Page"),group:"8",...ei},selection:{name:(0,le.Z)("context","Selection"),group:"8",...$n},docedit:{name:(0,le.Z)("Text Field"),group:"8",...Wn},audiovideo:{name:(0,le.Z)("Audio and Video"),group:"8",...Ln}},yi=()=>Object.keys(fi),wi=e=>vi.some((t=>t.group===e)),bi=e=>{if(wi(e)){const t=vi.findIndex((t=>t.group===e));return vi[t].name}return fi[e].name},Ci=e=>fi[e].options,Si=e=>fi[e].actions;function Ti(e,t,n,i,s){const o=Ci(t);if(o){const t=t=>Promise.resolve(o(e,t));return Ii(i,n||t,s)}return Promise.resolve([])}function Ii(e,t,n){return Promise.all(e.map((e=>t(e).then((i=>{let s=G.Z.commandItem;switch(e.type){case"folder":s={...i,type:e.type,id:e.id,items:[],commandName:e.action};break;case"command":case"checkbox":s={...i,type:e.type,id:e.id,commandName:e.action};break;case"radio":break;case"container":n?i.container?(i.container.cpp=!0,i.container.mode=e.containermode||"folder",i.container.edge=e.containeredge||"off",s={type:e.type,id:e.id,...i}):"inline"===e.containermode?(i.items||(i.items=[]),s={...i,type:"container",id:e.id}):"folder"===e.containermode&&(delete i.type,s={...i,type:"folder",id:e.id}):(i.container={content:e.action,mode:e.containermode,edge:e.containeredge,cpp:!1},s={...i,type:e.type,id:e.id,commandName:e.action});break;case"separator":s={...G.Z.separatorItem,id:e.id}}return void 0!==e.title&&(s.label&&(s.label=e.title),s.labelEnglish&&(s.labelEnglish=e.title),s.settingsLabel&&delete s.settingsLabel,s.ellipsis=!1),void 0!==e.custom&&(s.custom=e.custom),s.showshortcut=e.showshortcut,"folder"===e.type&&e.children&&!1!==i.visible?Ii(e.children,t,n).then((e=>(Array.prototype.push.apply(s.items,e),s))):s}))))).then((e=>e.reduce(((e,t)=>!1===t.visible?[...e]:"container"===t.type&&t.items&&n?[...e,...t.items]:[...e,t]),[])))}const ki={isSection:wi,getKeys:yi,getSettingsList:()=>{const e={};Object.keys(fi).forEach((t=>{const n=fi[t];e[n.group]||(e[n.group]=[]),e[n.group].push(t)}));let t=[];return vi.forEach((n=>{if(e[n.group]){const i={key:n.group,indent:n.indent,name:n.name},s=e[n.group].map((e=>({key:e,indent:n.indent+1,name:bi(e)}))).sort(((e,t)=>!1===n.sort?0:e.name<t.name?-1:e.name>t.name?1:0));s&&s.length>0&&(t=[...t,i,...s])}})),t},getNamedMenu:(e,t,n)=>new Promise((i=>{d.Z.menuContent.get(t,((s,o,a)=>{i(a?Ti(e,t,n,a,!0):[])}))})),makeMenuWithContent:(e,t,n)=>Ti(e,t,void 0,n,!1),makeCommandList:(e,t)=>{if(void 0===fi[t])return[];const n={id:"",type:"command",action:""},i=Ci(t);return Si(t)().map((t=>(n.action=t,{action:t,...i(e,n),id:t})))},hasName:e=>yi().includes(e)||wi(e),getName:bi,getOptionFunction:Ci,getActionList:Si},Ai=ki;var Zi=n(24325),Ei=n.n(Zi),_i=n(8575),Ni=n(36436);const Mi=["/resources","chrome://favicon","data:"];function Pi(e){return Mi.some((t=>e.startsWith(t)))}function Di(e){if(Pi(e))return e;const{hostname:t,protocol:n}=_i.parse((0,Ni.q9)(e));return`${n||"https"}//${(t||"").split(".").slice(-2).join(".")}/favicon.ico`}class xi extends tn.PureComponent{state={loadFailed:!1};componentDidUpdate(e,t){t.loadFailed&&this.props.url!==e.url&&this.props.loadType!==e.loadType&&this.setState({loadFailed:!1})}handleImageLoadError=()=>{this.setState({loadFailed:!0})};getUrl=()=>{const e=this.props.fallbackUrl?(0,St.w$)(this.props.fallbackUrl):void 0,t=(0,St.w$)(this.props.url);return this.state.loadFailed?e&&Pi(e)?{type:"faviconSkipCache",url:e}:{type:"faviconSkipCache",url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABiUlEQVR42u2XK08DURBG6U/D80eQeMIjqGJAocCA6hqqUBASakCBAYUqSbvb92u3j6VZZjYcQ3q3hWlSRJucfF8yt3PPlbuxtb2zUtYC/1dAfge/ZHOlAkgsXSBJkn0B9ki6nvE87z5Twi7g5vtM4pCwC0yn0yPZn6KdBATcEnaBfBzHx4p0EvIIuCTMAnLhqXCiaCcBgSwJk8B4PD6Ti1K0k3QE5kn8WWA0Gl24mEwm5wjMk7AIXA6Hw6tZ6EzO7GZhFpCLChBFkUfSyVmEYVgwC8gF14PBoKhoJwGY/ThflB2HJoF+v38jL0mRTi5MLpezCchLbnu9HtyRdFLRsyTdLNDtdkvykgdFOgkl0oVZoNPpPMqip0Vot9tkiv7XLNBqtZ5l2YuinVTkAtLJMgTeMngl6STdLNBsNt+h0WiQdNI5NwvIonK9XnfxQToomwVkiV+r1YJZ6IwEYGYWCIKgbcEs4Pt+JIQOIpJO0s0ClUrls1qtQkwqOiM5R9JNAktk9QLrb0MXX53cKptKU4a6AAAAAElFTkSuQmCC"}:"page"===this.props.loadType?t.startsWith("javascript")?{type:"svg",url:Ei()}:{type:"page",url:t}:t.startsWith("<svg")?{type:"svg",url:t}:Pi(t)?{type:"faviconSkipCache",url:t}:{type:this.props.loadType,url:t}};render(){const{type:e,url:t}=this.getUrl();if("svg"===e)return(0,fn.jsx)("span",{ref:this.props.refFavicon,className:this.props.className,style:this.props.style,dangerouslySetInnerHTML:{__html:t},title:this.props.title});const n=(0,Ni.q9)(t).replace("vivaldi://","chrome://"),i="page"===e?"":"iconurl/",s=this.props.size||16,o="faviconSkipCache"===e?t:`chrome://favicon/size/${s}@1x/${i}${n} 1x,chrome://favicon/size/${s}@2x/${i}${n} 2x`;return(0,fn.jsx)("img",{ref:this.props.refFavicon,className:this.props.className,width:s,height:s,srcSet:o,style:this.props.style,title:this.props.title,onError:this.handleImageLoadError})}}const Oi=xi;var Li;function Ri(e,t,n,i){Li||(Li="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Li,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var Bi=Ri("circle",{cx:"10.5",cy:"10.5",r:"5"}),Fi=Ri("text",{x:"7.5",y:"14",fontSize:"10px"},void 0,"~"),Ui=Ri("text",{x:"9.5",y:"14",fontSize:"10px"},void 0,"!");class Vi extends tn.PureComponent{getImageSet=()=>this.props.trash?cn.nre:this.props.speeddial?this.props.open?cn.g0V:cn.$II:this.props.open?cn.fHR:cn._TQ;render(){return Ri("svg",{width:"16",height:"16",viewBox:"0 0 16 16",className:mn()("folder-icon",this.props.className,{sd:this.props.speeddial}),style:{marginLeft:this.props.leftMargin?this.props.leftMargin:null,marginRight:this.props.rightMargin?this.props.rightMargin:null}},void 0,this.props.icon?this.props.icon:Ri("g",{className:"fill-override",dangerouslySetInnerHTML:{__html:(this.props.imageSet||this.getImageSet()).small}}),(this.props.isConnecting||this.props.disconnected)&&Ri("g",{className:this.props.isConnecting?"folder-evaluating":"folder-error",onClick:this.props.onClickStatusIcon},void 0,Bi,this.props.isConnecting?Fi:Ui))}}const Wi=Vi,Hi={getMenu:async(e,t,n)=>new Promise((t=>{y.Z.windows.getAll({populate:!0,windowTypes:["normal"]},(n=>{n=n.filter((e=>!e.vivExtData||"settings"!==JSON.parse(e.vivExtData).windowType)).filter((t=>t.id!==e)),t(n)}))})).then((i=>Promise.all(i.map((e=>new Promise((t=>{e.id?d.Z.runtimePrivate.isGuestSession(e.id,(n=>{t({window:e,isGuest:n})})):t({window:e,isGuest:!1})}))))).then((i=>i.filter((t=>z.ZP.isGuestSession(e)?t.isGuest:z.ZP.isIncognito(e)?t.window.incognito&&!t.isGuest:!t.isGuest)).map(((e,i)=>{const s=e.window.tabs||[],o=s.find((e=>e.active)),a=o&&o.url?St.jk.getDisplayTitleByUrl(o.url,o.title||o.url):i+1,r=e.window.incognito?(0,le.Z)("Private Window with $1 Active Tab ($2)","Private Window with $1 Active Tabs ($2)",[s.length,a]):(0,le.Z)("Window with $1 Active Tab ($2)","Window with $1 Active Tabs ($2)",[s.length,a]);return{handler:()=>{d.Z.utilities.broadcastMessage({open:{winId:parseInt(e.window.id),prompt:t,urls:n}})},...G.Z.makeNumberMnemonic(r,i)}}))))))};var zi=n(47380);const Gi=(e,t,n,i)=>{if(e.dataTransfer.setData("text/uri-list",t),e.dataTransfer.setData("text/plain",t),e.dataTransfer.setData("vivaldi/x-title",n),!i){const i="text/plain",s=`${i}:${`${n.replace(/[<>:"/\\|?*\n\r]/g,"_").substring(0,100)}.url`}:data:${i};base64,${btoa("[InternetShortcut]\nURL="+t)}`;e.dataTransfer.setData("DownloadURL",s)}return e};var $i;function Ki(e,t,n,i){$i||($i="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:$i,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var ji=Ki("span",{className:"separator"});class Yi extends tn.Component{static contextType=dn.Z;refButton=tn.createRef();refTitleInput=tn.createRef();dropMode={support:!1,copy:!1};centerButtonPressed=!1;regularWidth=-1;canHandleClick=!0;constructor(e){super(e),this.state={dragging:!1,title:e.node.title}}componentDidUpdate(){const{HTMLElement:e}=this.context,t=this.refButton.current;t instanceof e&&(this.props.onRendered(this.props.node.id,t.offsetWidth),this.props.editTitle||(this.regularWidth=t.offsetWidth))}componentDidMount(){const{HTMLElement:e}=this.context,t=this.refButton.current;t instanceof e&&this.props.onRendered(this.props.node.id,t.offsetWidth)}_edit=()=>{ie.Z.showBookmarkDialog(this.context.vivaldiWindowId,{mode:"edit",id:this.props.node.id,index:-1})};_rename=()=>{this.setState({title:this.props.node.title}),this.props.onEditChanged(this.props.node.id)};_handleEditChange=e=>{this.setState({title:e.target.value})};_handleEditKeyDown=e=>{switch(e.key){case"Enter":this._saveTitle(e.currentTarget.value),this.refTitleInput.current?.blur();break;case"Escape":this._cancelEdit(),this.refTitleInput.current?.blur()}};_killEvent=e=>{e.preventDefault(),e.stopPropagation()};_cancelEdit=()=>{this.setState({title:this.props.node.title}),this.props.onEditChanged("")};_saveTitle=e=>{y.Z.bookmarks.update(this.props.node.id,{title:e})};_handleFocus=e=>{e.currentTarget.select()};_handleEditBlur=e=>{this.state.title||this._cancelEdit(),this.props.onEditChanged(""),this.props.onRendered(this.props.node.id,this.regularWidth)};_delete=()=>{i.Z.remove([this.props.node.id])};_handleItemMouseDown=e=>{e.button!==vn.Z.kLeft&&(this.centerButtonPressed=e.button===vn.Z.kCenter,e.preventDefault()),this.canHandleClick=!this.props.menuOpen};_handleItemMouseUp=e=>{e.button===vn.Z.kCenter&&(e.preventDefault(),!0===this.centerButtonPressed&&0===e.buttons&&this.props.onItemActivated(this.props.node.id,!0,!1,e))};_handleClick=e=>{this.canHandleClick&&this.props.onItemActivated(this.props.node.id,!0,!0,e),e.preventDefault(),e.stopPropagation()};_handleKeyDown=e=>{switch("Enter"===e.key&&!0===e.repeat&&e.preventDefault(),e.key){case"ArrowUp":case"ArrowDown":case"Enter":this.props.onItemActivated(this.props.node.id,"Enter"===e.key,!0,e);break;case"ArrowLeft":this.props.moveFocus(this.props.node.id,"left",!1);break;case"ArrowRight":this.props.moveFocus(this.props.node.id,"right",!1);break;case"Escape":if(this.props.menuOpen)return;this.props.onLeaveBar();break;default:return}e.preventDefault(),e.stopPropagation()};_handleDrop=e=>{if(e.preventDefault(),e.stopPropagation(),this.dropMode.support&&""!==this.props.dragover.position){const t="on"===this.props.dragover.position?this.props.node.id:this.props.node.parentId,n="on"===this.props.dragover.position?0:this.props.dragover.index+("right"===this.props.dragover.position?1:0);t&&i.Z.onDropEvent(e,t,n)}this.props.resetDragover()};_handleDragStart=e=>{const t=z.ZP.isIncognito(this.context.vivaldiWindowId);this.props.onDragStart(this.props.node.id),this.setState({dragging:!0});const n=JSON.stringify([this.props.node.id.toString()]);e.dataTransfer.setData(Jt.yR,n);const i=St.jk.getHoverUrl(en.ZP.getUrlByNode(this.props.node));Gi(e,i,this.props.node.title,t),e.dataTransfer.effectAllowed="all"};_handleDragEnd=e=>{this.setState({dragging:!1}),this.props.onDragEnd()};_handleDragLeave=e=>{};_handleDragEnter=e=>{this.dropMode=this.props.getDropModeForEvent(e)};_handleDragOver=e=>{e.preventDefault(),e.stopPropagation(),this.dropMode.support&&(e.dataTransfer.dropEffect=this.dropMode.copy?"copy":"move",this.props.onDragOver(this.props.node,e))};_handleBlur=()=>{this.props.onItemBlur(this.props.node.id)};_handleMouseEnter=e=>{if(!this.props.statusOff){const e=en.ZP.getUrlByNode(this.props.node);X.Z.setStatus(this.context.vivaldiWindowId,e||this.props.node.title)}this.props.onItemEnter(this.props.node.id)};_handleMouseLeave=e=>{this.props.statusOff||X.Z.clearStatus(this.context.vivaldiWindowId),this.centerButtonPressed=!1,this.props.onItemLeave(this.props.node.id)};_openInNewWindow=(e,t)=>{const n={inCurrent:!1,inBackground:!1,inNewWindow:!0,allowOverride:!1,incognito:t};Jt.ZP.open(this.context.vivaldiWindowId,Jt.ZP.getBookmarksByNode(e),n,!0)};_openInNewTab=(e,t)=>{const n={inCurrent:!1,inBackground:t||M.Z.get(D.kTabsOpenNewInBackground),inNewWindow:!1,allowOverride:!1,incognito:!1};Jt.ZP.open(this.context.vivaldiWindowId,Jt.ZP.getBookmarksByNode(e),n,!0)};_open=e=>{Jt.ZP.open(this.context.vivaldiWindowId,Jt.ZP.getBookmarksByNode(e),{inCurrent:!0,inBackground:!1,inNewWindow:!1,allowOverride:!1,incognito:!1},!0)};_getContextMenuItems=(e,t)=>{const n=this.context.vivaldiWindowId,i=Ai.getOptionFunction(e),s=en.ZP.isSeparator(t);return Ai.getNamedMenu(n,e,(async e=>{switch(e.action){case"CONTEXT_OPEN_IN_NEW_TAB":return{handler:()=>this._openInNewTab(t,!1),visible:!s,...i(n,e,{})};case"CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB":return{handler:()=>this._openInNewTab(t,!0),visible:!s&&!M.Z.get(D.kTabsOpenNewInBackground),...i(n,e,{})};case"CONTEXT_OPEN_IN_TAB":return{handler:()=>this._open(t),visible:!s,...i(n,e,{})};case"CONTEXT_OPEN_IN_NEW_WINDOW":return{handler:()=>this._openInNewWindow(t,!1),visible:!s,...i(n,e,{})};case"CONTEXT_OPEN_IN_PRIVATE_WINDOW":return{handler:()=>this._openInNewWindow(t,!0),visible:!s,...i(n,e,{})};case"CONTEXT_CONTAINER_OPEN_IN_WINDOW":{const o=await Hi.getMenu(n,!0,Jt.ZP.getUrlsByNodes([t]));return{visible:!s&&o.length>0,items:o,...i(n,e,{})}}case"CONTEXT_BOOKMARK":return{handler:this.props.addActiveTab,visible:!s,...i(n,e,{})};case"CONTEXT_NEW_BOOKMARK":return{handler:this.props.createNewBookmark,...i(n,e,{})};case"CONTEXT_NEW_FOLDER":return{handler:this.props.createNewFolder,...i(n,e,{})};case"CONTEXT_NEW_SEPARATOR":return{handler:this.props.createNewSeparator,visible:!this.props.isSorted,...i(n,e,{})};case"CONTEXT_EDIT":return{handler:this._edit,visible:!s,...i(n,e,{})};case"CONTEXT_RENAME":return{handler:this._rename,visible:!s,...i(n,e,{})};case"CONTEXT_CUT":return{handler:this.props.onCut,visible:!s,...i(n,e,{})};case"CONTEXT_COPY":return{handler:this.props.onCopy,visible:!s,...i(n,e,{})};case"CONTEXT_PASTE":return{handler:this.props.onPaste,visible:!s,...i(n,e,{})};case"CONTEXT_DELETE":return{handler:this._delete,...i(n,e,{})};default:return{...i(n,e,{})}}}))};_onContextMenu=e=>{this.props.editTitle?e.stopPropagation():(e.persist(),e.preventDefault(),e.stopPropagation(),this._getContextMenuItems("bookmarkbaritem",this.props.node).then((t=>{(0,zi.Z)(this.context.vivaldiWindowId,t)(e)})))};_onFocus=()=>{this.props.highlighted||this.props.onItemHighlightMissing(this.props.node.id)};render(){const e=this.props.node,t=en.ZP.getUrlByNode(e),n=en.ZP.isSeparator(e),i=en.ZP.isFolder(e);let s;i&&"icon"!==this.props.display?s=(0,le.Z)("Show folder contents"):"icon"!==this.props.display&&"iconexceptfolders"!==this.props.display||!e.title?t&&(s=t):(s=e.title,t&&(s=s+"\n"+t));let o=!1;"icon"!==this.props.display&&(o="iconexceptfolders"!==this.props.display||!t);const{favIconUrl:a,favIconLoadType:r}=St.jk.getBookmarkFavicon(e.url,e.faviconUrl);return(0,fn.jsxs)("button",{ref:this.refButton,"data-id":e.id,"data-offset":0,title:s,tabIndex:this.props.keyAccess,className:mn()({uifocusstop:this.props.uiFocus,bookmarkbarItem:!0,highlighted:this.props.highlighted||this.props.menuOpen,folder:!n&&!e.url,"data-cut":this.props.isCut,dragging:this.state.dragging,dragover:this.props.dragover.id===e.id&&"on"===this.props.dragover.position,dragoverLeft:this.props.dragover.id===e.id&&"left"===this.props.dragover.position,dragoverRight:this.props.dragover.id===e.id&&"right"===this.props.dragover.position}),draggable:!this.props.editTitle,onDragStart:this._handleDragStart,onDragEnd:this._handleDragEnd,onDragEnter:this._handleDragEnter,onDragOver:this._handleDragOver,onDrop:this._handleDrop,onBlur:this._handleBlur,onMouseEnter:this._handleMouseEnter,onMouseLeave:this._handleMouseLeave,onClick:this.props.editTitle?void 0:this._handleClick,onMouseDown:this.props.editTitle?void 0:this._handleItemMouseDown,onMouseUp:this.props.editTitle?void 0:this._handleItemMouseUp,onKeyDown:this.props.editTitle?void 0:this._handleKeyDown,onContextMenu:this._onContextMenu,onFocus:this._onFocus,onKeyUp:this._killEvent,children:[n&&ji,!n&&a&&"text"!==this.props.display&&Ki(Oi,{url:a,loadType:r}),!n&&!e.url&&"text"!==this.props.display&&Ki(Wi,{speeddial:e.speeddial}),!n&&!this.props.editTitle&&o&&e.title&&(0,fn.jsxs)(fn.Fragment,{children:["text"===this.props.display&&i&&Ki(Wi,{speeddial:e.speeddial}),Ki("span",{className:"title"},void 0,e.title)]}),this.props.editTitle&&(0,fn.jsx)("input",{ref:this.refTitleInput,type:"text",value:this.state.title,onFocus:this._handleFocus,onBlur:this._handleEditBlur,onClick:this._killEvent,onKeyDown:this._handleEditKeyDown,onChange:this._handleEditChange,autoFocus:!0})]},e.id)}}const Xi=Yi;var Qi=n(57082),qi=n(5298),Ji=n(88594);class es extends tn.PureComponent{static contextType=dn.Z;nodeRef=tn.createRef();componentDidMount=()=>{this._attachObserver()};componentWillUnmount=()=>{this._detachObserver()};componentDidUpdate(e){this.props.attached&&!e.attached&&this._detachObserver(),!this.props.attached&&e.attached&&this._attachObserver()}_attachObserver=()=>{const{Element:e,ResizeObserver:t}=this.context,n=this.nodeRef.current;if(n instanceof e)try{this._observer=new t(this.props.onResize),this._observer.observe(n)}catch(e){console.warn(e)}};_detachObserver=()=>{const{Element:e}=this.context,t=this.nodeRef.current;t instanceof e&&this._observer.unobserve(t)};render(){const e=(0,Ji.Z)(this.props,["ref","onResize","component","children","attached"]);return(0,fn.jsx)("div",{ref:this.nodeRef,...e,children:this.props.children})}}const ts=es;var ns=n(93974),is=n(24899);function ss(e){return!!e&&e.contains(document.activeElement)}function os(e){return e.querySelectorAll("a[href]:not([tabindex='-1']),\n    button:not([disabled]):not([tabindex='-1']),\n    input:not([disabled]):not([tabindex='-1']),\n    select:not([disabled]):not([tabindex='-1']),\n    textarea:not([disabled]):not([tabindex='-1']),\n    [contenteditable]:not([tabindex='-1']),\n    [tabindex]:not([disabled]):not([tabindex='-1'])")}function as(e,t){const n=[...os(t||e)],i=n.findIndex((t=>t===e.activeElement));n[(i+1)%n.length].focus()}var rs,ls=n(45454),ds=n(34155);function cs(e,t,n,i){rs||(rs="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:rs,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class hs extends tn.PureComponent{static contextType=dn.Z;acceptEnterId="";draggedId="";dropMode={support:!1,copy:!1};clipboardId="";timer=null;nodeRef=tn.createRef();constructor(e,t){super(e);const{document:n}=t;this.state={nodes:en.ZP.getBookmarksBarNodes(),map:new Map,dragover:{id:"",position:"",index:0},maxWidth:n.documentElement?n.documentElement.clientWidth:0,extenderWidth:0,sorting:{sortOrder:ns.Z.NO_SORTING,sortField:"manually"},cutIds:en.ZP.getCutIds(),editId:"",newItemAdded:!1,renderedArray:[],openMenuId:"",highlightedId:""}}componentDidMount(){const e=M.Z.get(D.kBookmarksBarSorting);this._onSortChange(e.sortOrder,e.sortField),en.ZP.addListener(this._onStoreChange),Qi.Z.addListener("COMMAND_FOCUS_BOOKMARKBAR",this._onCommandSpy)}componentWillUnmount(){this.timer&&clearTimeout(this.timer),en.ZP.removeListener(this._onStoreChange),Qi.Z.removeListener("COMMAND_FOCUS_BOOKMARKBAR",this._onCommandSpy)}_onStoreChange=()=>{const e=en.ZP.getBookmarksBarNodes();this.setState((t=>{const n=this._getRenderedItems(e,t.sorting,!0===t.newItemAdded?t.editId:"");return{nodes:e,map:new Map,renderedArray:n,cutIds:en.ZP.getCutIds()}}))};_hasFocus=()=>{const{HTMLElement:e}=this.context,t=this.nodeRef.current;return t instanceof e&&ss(t)};_onCommandSpy=()=>{this._hasFocus()||this.state.renderedArray.length>0&&this._moveFocus(this.state.renderedArray[0].id,"current",!0)};_getRenderedItems=(e,t,n)=>{const i=(0,is.Z)(e);if(i.length>0&&t&&t.sortOrder>=ns.Z.ASCENDING_SORT){const e=(e,n)=>en.ZP.treeSortComparator(e,n,{sortOrder:t.sortOrder,sortField:t.sortField});if(ns.Z.treeSort(i,e),""!==n){const e=i.findIndex((e=>e.id===n));-1!==e&&i.splice(0,0,i.splice(e,1)[0])}}return i};_handleKeyDown=e=>{e.keyCode===qi.Z.KEY_ESCAPE&&this._resetDragover()};_onButtonRendered=(e,t)=>{this.state.map.get(e)!==t&&this.setState((n=>{const i=new Map(n.map);return i.set(e,t),{map:i}}))};_onExtenderRendered=(e,t)=>{this.setState({extenderWidth:e})};_onResize=e=>{const t=e[0].target;this.setState({maxWidth:Math.floor(t.clientWidth)})};_addActiveTab=()=>{const e=W.Z.getActivePage(this.context.vivaldiWindowId);e&&i.Z.bookmarkPageInFolder(e,en.ZP.getBookmarkBarFolderId(),0)};_getItemInsertIndex=e=>{const t=this.state.renderedArray.length;return"number"!=typeof e||t<e?t:e};_createNewBookmark=()=>{ie.Z.showBookmarkDialog(this.context.vivaldiWindowId,{mode:"addbookmark",id:en.ZP.getBookmarkBarFolderId(),index:0})};_createNewFolder=()=>{ie.Z.showBookmarkDialog(this.context.vivaldiWindowId,{mode:"addfolder",id:en.ZP.getBookmarkBarFolderId(),index:0})};_createNewSeparator=e=>{i.Z.createSeparator(en.ZP.getBookmarkBarFolderId(),this._getItemInsertIndex(e))};_resetDragover=()=>{this.setState({dragover:{id:"",position:"",index:0}})};_onEditChanged=e=>{""===e?this.setState((e=>({renderedArray:this._getRenderedItems(e.nodes,e.sorting,""),newItemAdded:!1,editId:""}))):this.setState({editId:e})};_onDragEndBookmark=()=>{this.draggedId="",this._resetDragover()};_onDropBar=e=>{if(e.preventDefault(),e.stopPropagation(),this.dropMode.support){const t=en.ZP.getBookmarkBarFolderId(),n=en.ZP.getBookmarksBarNodes().length;i.Z.onDropEvent(e,t,n)}this._resetDragover()};_onDragEnter=e=>{this.dropMode=this._getDropModeForEvent(e)};_onDragOverBar=e=>{e.preventDefault(),e.stopPropagation(),this.dropMode.support&&(e.dataTransfer.dropEffect=this.dropMode.copy?"copy":"move")};_onDragOver=(e,t)=>{if(e.id!==this.draggedId&&void 0!==e.index){var n="";if(this.state.sorting.sortOrder===ns.Z.NO_SORTING){const i=t.currentTarget.getBoundingClientRect(),s=(t.clientX-i.left)/i.width;n=en.ZP.isFolder(e)?s<=.33?"left":s>.66?"right":"on":s<=.5?"left":"right"}else en.ZP.isFolder(e)&&(n="on");(this.state.dragover.id!==e.id||this.state.dragover.id===e.id&&this.state.dragover.position!==n)&&this.setState({dragover:{id:e.id,position:n,index:e.index}})}};_onDragStart=e=>{this.draggedId=e};_getDropModeForEvent=e=>{const t={support:!1,copy:!1};return t.support=e.dataTransfer.types.some((e=>"text/uri-list"===e||"text/plain"===e||e===Jt.yR)),t.support&&(e.dataTransfer.types.some((e=>e===Q.Up))?t.copy=!1:t.copy=t.support&&(Jt.ZP.isCopyModifierPressed(e)||!e.dataTransfer.types.some((e=>e===Jt.yR)))),t};_onCut=e=>{i.Z.cut(e,[this.clipboardId]),e.stopPropagation(),e.preventDefault()};_onCopy=e=>{i.Z.copy(e,[this.clipboardId]),e.stopPropagation(),e.preventDefault()};_onPaste=e=>{const t=this.clipboardId===en.ZP.getBookmarkBarFolderId();i.Z.paste(e,this.clipboardId,t),e.preventDefault(),e.stopPropagation()};_onCutContextMenu=e=>{this.clipboardId=e;const{document:t}=this.context;t.addEventListener("cut",this._onCut),t.execCommand("cut"),t.removeEventListener("cut",this._onCut)};_onCopyContextMenu=e=>{this.clipboardId=e;const{document:t}=this.context;t.addEventListener("copy",this._onCopy),t.execCommand("copy"),t.removeEventListener("copy",this._onCopy)};_onPasteContextMenu=e=>{this.clipboardId=e;const{document:t}=this.context;t.addEventListener("paste",this._onPaste),t.execCommand("paste"),t.removeEventListener("paste",this._onPaste)};_onSortOrderChange=()=>{const e=this.state.sorting.sortOrder===ns.Z.DESCENDING_SORT?ns.Z.ASCENDING_SORT:ns.Z.DESCENDING_SORT;this._onSortChange(e,this.state.sorting.sortField)};_onTitleSortChange=e=>{let t=this.state.sorting.sortOrder;"manually"!==e&&t===ns.Z.NO_SORTING?t=ns.Z.ASCENDING_SORT:"manually"===e&&(t=ns.Z.NO_SORTING),this._onSortChange(t,e)};_onSortChange=(e,t)=>{this.setState({sorting:{sortOrder:e,sortField:t}});const n={sortOrder:e,sortField:t};nt.Z.set(D.kBookmarksBarSorting,n),this.setState((e=>({renderedArray:this._getRenderedItems(e.nodes,n,!0===e.newItemAdded?e.editId:"")})))};_getContextMenuItems=e=>{const t=this.context.vivaldiWindowId,n=this.state.sorting.sortOrder!==ns.Z.NO_SORTING,i=Ai.getOptionFunction(e),s=()=>[{handler:this._onTitleSortChange.bind(this,"manually"),type:"checkbox",checked:"manually"===this.state.sorting.sortField,...(0,Mn.Z)("radio","Manually")},{handler:this._onTitleSortChange.bind(this,"title"),type:"checkbox",checked:"title"===this.state.sorting.sortField,...(0,Mn.Z)("by Title")},{handler:this._onTitleSortChange.bind(this,"url"),type:"checkbox",checked:"url"===this.state.sorting.sortField,...(0,Mn.Z)("by Address")},{handler:this._onTitleSortChange.bind(this,"nickname"),type:"checkbox",checked:"nickname"===this.state.sorting.sortField,...(0,Mn.Z)("by Nickname")},{handler:this._onTitleSortChange.bind(this,"description"),type:"checkbox",checked:"description"===this.state.sorting.sortField,...(0,Mn.Z)("by Description")},{handler:this._onTitleSortChange.bind(this,"dateadded"),type:"checkbox",checked:"dateadded"===this.state.sorting.sortField,...(0,Mn.Z)("by Date Created")},G.Z.separatorItem,{handler:this._onSortOrderChange,visible:this.state.sorting.sortOrder!==ns.Z.NO_SORTING&&this.state.sorting.sortOrder===ns.Z.ASCENDING_SORT,...(0,Mn.Z)("Descending")},{handler:this._onSortOrderChange,visible:this.state.sorting.sortOrder!==ns.Z.NO_SORTING&&this.state.sorting.sortOrder!==ns.Z.ASCENDING_SORT,...(0,Mn.Z)("Ascending")}];return Ai.getNamedMenu(t,e,(async e=>{switch(e.action){case"CONTEXT_BOOKMARK":return{handler:this._addActiveTab,...i(t,e,{})};case"CONTEXT_NEW_BOOKMARK":return{handler:this._createNewBookmark,...i(t,e,{})};case"CONTEXT_NEW_FOLDER":return{handler:this._createNewFolder,...i(t,e,{})};case"CONTEXT_NEW_SEPARATOR":return{handler:()=>{this._createNewSeparator(void 0)},visible:!n,...i(t,e,{})};case"CONTEXT_PASTE":return{handler:()=>{this._onPasteContextMenu(en.ZP.getBookmarkBarFolderId())},...i(t,e,{})};case"CONTEXT_CONTAINER_SORT":return{items:s(),...i(t,e,{})};default:return{...i(t,e,{})}}}))};_moveFocus=(e,t,n)=>{const{document:i}=this.context;if(!0===n||this._hasFocus()){const n=Array.from(i.querySelectorAll("button.bookmarkbarItem")).map((e=>e.getAttribute("data-id"))).filter(Boolean);if("current"===t){const t=parseInt(e)<0?0:n.indexOf(e);if(-1===t)return;e=n[t]}else if("right"===t||"left"===t){if(1===n.length)return;let i=n.indexOf(e);i="right"===t?i+1>=n.length?0:i+1:i<=0?n.length-1:i-1,e=n[i]}const s=i.querySelector(`button.bookmarkbarItem[data-id="${e}"]`);s&&s instanceof HTMLButtonElement&&this.setState({highlightedId:e},(()=>s.focus()))}};_handleItemActivated=(e,t,n,i)=>{const s=en.ZP.getItemById(e);if(s)if(en.ZP.isFolder(s)&&n){const e=this._getMenuSorting(),t="top"===M.Z.get(D.kBookmarksBarPosition)?"bottom":"top";_n.show(this.context,s.id,this._getFolderSiblings(),e.field,e.order,t,this._onMenuVisibilityChanged)}else if(t&&i){const e=this.context.vivaldiWindowId,t=(0,ls.Z)(e,{ctrlKey:i.ctrlKey,altKey:i.altKey,shiftKey:i.shiftKey,metaKey:i.metaKey,button:"number"==typeof i.button?i.button:-1});Jt.ZP.open(e,Jt.ZP.getBookmarksByNode(s),t,!0),ie.Z.setPaneFocus(this.context.vivaldiWindowId,!1)}};_handleItemEnter=e=>{""!==this.acceptEnterId&&this.acceptEnterId!==e||this.state.editId||(this._hasFocus()&&this._moveFocus(e,"current",!0),this.setState({highlightedId:e}))};_handleItemLeave=e=>{""===this.state.openMenuId&&this.setState({highlightedId:""})};_handleItemBlur=e=>{ds.nextTick((()=>{this._hasFocus()||this.setState({highlightedId:""})}))};_handleItemHighlightMissing=e=>{this.setState({highlightedId:e})};_handleLeaveBar=()=>{ie.Z.setPaneFocus(this.context.vivaldiWindowId,!1),a.Z.executeActions(this.context.vivaldiWindowId,"COMMAND_FOCUS_WEBVIEW")};_getMenuSorting=()=>ns.Z.toMenuSorting(this.state.sorting.sortOrder,this.state.sorting.sortField);_getFolderSiblings=()=>{const{document:e}=this.context;return Array.from(e.querySelectorAll("button.bookmarkbarItem")).filter((e=>e.classList.contains("folder")||e.classList.contains("chevron"))).map((e=>{const t=e.getBoundingClientRect();return{id:e.dataset.id,offset:Number(e.dataset.offset),folderGroup:Boolean(e.classList.contains("folder")),rect:{x:parseInt(t.left),y:parseInt(t.top),width:parseInt(t.width),height:parseInt(t.height)}}}))};_onMenuVisibilityChanged=e=>{""===e?(this.acceptEnterId=this.state.openMenuId,this.timer=setTimeout((()=>{this.acceptEnterId="",this.timer=null}),100),this._hasFocus()?this._moveFocus(this.state.openMenuId,"current",!0):this.setState({highlightedId:""})):(this.setState({highlightedId:e}),this._moveFocus(e,"current",!1)),this.setState({openMenuId:e})};_isSorted=()=>"manually"!==this.state.sorting.sortField;_onContextMenu=e=>{e.persist(),e.preventDefault(),e.stopPropagation(),this._getContextMenuItems("bookmarkbar").then((t=>{(0,zi.Z)(this.context.vivaldiWindowId,t)(e)}))};_renderBookmarkBarButton=(e,t)=>(0,fn.jsx)(Xi,{ref:e.id,node:e,editTitle:this.state.editId===e.id,isCut:-1!==this.state.cutIds.indexOf(e.id),menuOpen:this.state.openMenuId===e.id,display:this.props.display,statusOff:this.props.statusOff,dragover:this.state.dragover,highlighted:this.state.highlightedId===e.id,keyAccess:0===t?this.props.keyAccess:-1,uiFocus:0===t,moveFocus:this._moveFocus,onItemActivated:this._handleItemActivated,onItemEnter:this._handleItemEnter,onItemLeave:this._handleItemLeave,onItemBlur:this._handleItemBlur,onItemHighlightMissing:this._handleItemHighlightMissing,onLeaveBar:this._handleLeaveBar,onEditChanged:this._onEditChanged,onDragStart:this._onDragStart,onDragEnd:this._onDragEndBookmark,onDragOver:this._onDragOver,getDropModeForEvent:this._getDropModeForEvent,addActiveTab:this._addActiveTab,createNewBookmark:this._createNewBookmark,createNewFolder:this._createNewFolder,createNewSeparator:()=>this._createNewSeparator(t),isSorted:this._isSorted(),resetDragover:this._resetDragover,onRendered:this._onButtonRendered,onCut:this._onCutContextMenu.bind(this,e.id),onCopy:this._onCopyContextMenu.bind(this,e.id),onPaste:this._onPasteContextMenu.bind(this,e.id)},e.id);render(){let e=0;const t=[];let n=0,i="",s=0;for(let o=0;o<this.state.renderedArray.length;o++){const a=this.state.renderedArray[o];if(!this._isSorted()||!en.ZP.isSeparator(a)){const r=this.state.map.get(a.id),l=e+("number"==typeof r?r:28);if(l>this.state.maxWidth||l+this.state.extenderWidth>this.state.maxWidth&&o+1<this.state.renderedArray.length){n=o,""===this.state.editId&&this.state.renderedArray[0].parentId&&(i=this.state.renderedArray[0].parentId);break}t.push(this._renderBookmarkBarButton(a,s)),s++,e=l}}const o=""!==i?cs(wn,{id:i,offset:n,keyAccess:-1,menuOpen:this.state.openMenuId===i,highlighted:this.state.highlightedId===i,moveFocus:this._moveFocus,onRendered:this._onExtenderRendered,onItemActivated:this._handleItemActivated,onItemEnter:this._handleItemEnter,onItemLeave:this._handleItemLeave,onItemBlur:this._handleItemBlur,onItemHighlightMissing:this._handleItemHighlightMissing,onLeaveBar:this._handleLeaveBar}):null;return(0,fn.jsx)("div",{ref:this.nodeRef,className:`bookmark-bar ${this.props.display}`,onDragEnter:this._onDragEnter,onDragOver:this._onDragOverBar,onDragLeave:this._resetDragover,onDrop:this._onDropBar,onContextMenu:this._onContextMenu,children:cs(ts,{className:"observer",onKeyDown:this._handleKeyDown,onResize:this._onResize},void 0,t,o)})}}const ps=hs;var us=n(27508),gs=n(84675),ms=n(29717),vs=n(63377),fs=n(81009);class ys extends tn.Component{static contextType=dn.Z;nodeRef=tn.createRef();componentDidMount(){this.getRadios().forEach((e=>{e.name=this.props.name,e.addEventListener("change",this.props.onChange)})),this.setCheckedDisabledRadio(this.props)}setCheckedDisabledRadio=e=>{this.getRadios().forEach((t=>{t.value===e.value.toString()&&(t.checked=!0),t.disabled=Boolean(e.disabled)}))};componentDidUpdate(e){e.value===this.props.value&&e.disabled===this.props.disabled||this.setCheckedDisabledRadio(this.props)}componentWillUnmount(){this.getRadios().forEach((e=>{e.removeEventListener("change",this.props.onChange)}))}getRadios=()=>{const{HTMLInputElement:e}=this.context,t=this.nodeRef.current,n=[];if(t){t.querySelectorAll('input[type="radio"]').forEach((t=>{t instanceof e&&n.push(t)}))}return n};render(){return(0,fn.jsx)("div",{ref:this.nodeRef,className:this.props.className,children:this.props.children})}}const ws=ys;var bs,Cs=n(81157);function Ss(e,t,n,i){bs||(bs="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:bs,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ts=[{icon:cn.oa7,mode:"area",label:(0,le.Z)("capture","Selection")},{icon:cn.$O3,mode:"fullpage",label:(0,le.Z)("Full Page")}],Is=[{value:"png",label:(0,le.Z)("Save as PNG")},{value:"jpg",label:(0,le.Z)("Save as JPEG")},{value:"clipboard",label:(0,le.Z)("panel","Copy to Clipboard")},{value:"note",label:(0,le.Z)("Create note with...")}],ks=12;function As(e,t){t.keyCode===qi.Z.KEY_ESCAPE&&gs.Z.cancelCallback(e)}const Zs=e=>{const t=(0,tn.useContext)(dn.Z),{innerWidth:n}=t,{isOffScreenBelow:i,isOffScreenLeft:s,isOffScreenTopAndBottom:o}=function(e){const t=(0,tn.useContext)(dn.Z);let n=!1,i=!1,s=!1,o=!1;if(!e)return{isOffScreenTopAndBottom:s,isOffScreenBelow:n,isOffScreenLeft:o};const{top:a,height:r,left:l,width:d}=e,{innerHeight:c}=t;return i=a<46,o=l+d<300,n=c>a+r+34+17,s=!n&&i,{isOffScreenBelow:n,isOffScreenLeft:o,isOffScreenTopAndBottom:s}}(e);if(!e)return null;const{top:a,height:r,left:l}=e;return o?{left:l+ks,top:a+r-34-ks}:e?{top:i?e.top+e.height+ks:e.top-34-ks,...s?{left:e.left}:{right:n-(e.left+e.width)}}:null},Es=[D.kWebpagesCaptureSaveLocation,D.kWebpagesCaptureCompressionFormat,D.kKeyboardTabToAll];const _s=(0,fs.Z)((function({winId:e,captureSquare:t,mode:n,setMode:i,inProgress:s,isInternalUrl:o,prefValues:a,setFormat:r,doScreenshot:l}){const d=Zs(t),c=a[D.kWebpagesCaptureSaveLocation],h="clipboard"===c||"note"===c?c:a[D.kWebpagesCaptureCompressionFormat];return Ss("form",{className:mn()("ControlPanel",{Default:!d,InProgress:s}),style:d,onKeyDown:As.bind(this,e),onSubmit:l},void 0," ",s?(0,fn.jsxs)(fn.Fragment,{children:[Ss("span",{dangerouslySetInnerHTML:{__html:cn.GO5.medium}}),Ss("span",{},void 0,(0,le.Z)("Capture in Progress..."))]}):Ss(vs.Z,{focusName:"focus-capture-dialog",forceTrap:!0},void 0,!t&&Ss(ws,{name:"modePicker",className:"ControlPanel-ModeSelector",onChange:i,disabled:o,value:n},void 0,Ts.map((e=>{if(e.mode.includes("fullpage")&&o)return null;return Ss("label",{className:mn()("ControlPanel-ModeSelector--Option",{Active:e.mode.includes(n)})},e.mode,Ss("span",{dangerouslySetInnerHTML:{__html:e.icon}}),Ss("input",{type:"radio",value:e.mode,tabIndex:o?-1:a[D.kKeyboardTabToAll]}),Ss("span",{},void 0,e.label))}))),Ss("div",{className:"ControlPanel-Output"},void 0,Ss("p",{className:"ControlPanel-Output--Description"},void 0,(0,le.Z)("format","Output:")),Ss("select",{className:"ControlPanel-Output--Select",onChange:r,value:h},void 0,Is.map((e=>Ss("option",{value:e.value},e.value,e.label)))),Ss("input",{className:"ControlPanel-Output--CaptureButton primary",type:"submit",onMouseDown:Cs.Z,onTouchStart:Cs.Z,disabled:"fullpage"!==n&&!("area"===n&&void 0!==t),value:(0,le.Z)("image","Capture")}))))}),Es);var Ns;function Ms(e,t,n,i){Ns||(Ns="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Ns,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ps=10,Ds=[D.kWebpagesCaptureCaptureMode,D.kWebpagesCaptureCompressionFormat,D.kWebpagesCaptureSaveLocation],xs=["TopLeft","TopMid","TopRight","BottomLeft","BottomMid","BottomRight","MidLeft","MidRight"],Os=e=>{const t=W.Z.getActivePage(e);return!(!t?.id||!t?.url)&&St.jk.isInternalUrl(t?.url)};const Ls=(0,fs.Z)((function(e){const{prefValues:t}=e,n=(0,tn.useRef)(null),i=(0,tn.useRef)(null),s=(0,tn.useRef)(0),o=(0,tn.useRef)(0),a=(0,tn.useRef)(0),r=(0,tn.useRef)(0),l=(0,tn.useRef)({}),[d,c]=(0,tn.useState)(Os(e.winId)),h=d?"area":t[D.kWebpagesCaptureCaptureMode],p=(0,tn.useContext)(dn.Z),[u,g]=(0,tn.useState)(null),[m,v]=(0,tn.useState)(!1),[f,y]=(0,tn.useState)(!1);(0,tn.useEffect)((()=>{n.current?.focus()}),[]);const{winId:w}=e;(0,tn.useEffect)((()=>{const e=()=>{c(Os(w))};return W.Z.addListener(e),()=>{W.Z.removeListener(e)}}),[w]);const b=()=>{const{x3:e,x4:t,y3:n,y4:i}={x3:Math.round(Math.min(s.current,o.current)),x4:Math.round(Math.max(s.current,o.current)),y3:Math.round(Math.min(a.current,r.current)),y4:Math.round(Math.max(a.current,r.current))},l=p.innerWidth,d=p.innerHeight;g({rectStyle:{left:e,top:n,width:t-e,height:i-n},areaStyle:{background:"transparent",borderWidth:`${n}px ${l-t}px ${d-i}px ${e}px`}})},C=e=>{v(!0),b();const t=Math.round(e.clientX),n=Math.round(e.clientY),i=Math.abs(t-s.current)<=8,d=Math.abs(t-o.current)<=8,c=Math.abs(n-a.current)<=8,h=Math.abs(n-r.current)<=8;l.current={x1:i,x2:d,y1:c,y2:h},e.target instanceof HTMLElement&&e.target.setPointerCapture(e.pointerId.toString())},S=e=>{m&&(l.current.x1&&(s.current=e.clientX),l.current.x2&&(o.current=e.clientX),l.current.y1&&(a.current=e.clientY),l.current.y2&&(r.current=e.clientY),T(),b())},T=()=>{const e=s.current,t=o.current,n=a.current,i=r.current,{innerWidth:l,innerHeight:d}=p;e>l?s.current=l:t>e?(l-t<Ps&&(o.current=l),e<Ps&&(s.current=0)):t<Ps&&(o.current=0),n>d?a.current=d:i>n?(d-i<Ps&&(r.current=d),n<Ps&&(a.current=0)):i<Ps&&(r.current=0)},I=t=>{if(m){t.target instanceof HTMLElement&&t.target.releasePointerCapture(t.pointerId.toString()),v(!1);const{current:n}=i;if(!n)return;const{width:s,height:o}=n.getBoundingClientRect();(s<=3||o<=3)&&gs.Z.cancelCallback(e.winId)}},k=()=>{const{current:e}=i,{current:t}=n;if(e&&t)if("area"===h){g({areaStyle:{borderColor:"rgba(0,0,0,0)",visibility:"hidden"},rectStyle:null}),v(!0),t.addEventListener("transitionend",A,!0)}else y(!0),Z()},A=()=>{n.current?.removeEventListener("transitionend",A);const e={x:Math.min(s.current,o.current),y:Math.min(a.current,r.current),width:Math.max(o.current,s.current)-Math.min(s.current,o.current),height:Math.max(r.current,a.current)-Math.min(r.current,a.current)};gs.Z.performCapture(p.vivaldiWindowId,h,e)},Z=async()=>{const n=t[D.kWebpagesCaptureSaveLocation],i=t[D.kWebpagesCaptureCompressionFormat],s=W.Z.getActivePage(e.winId)?.id;if(!s)return;const{image:o}=await gs.Z.captureFullpage(s,i,n);y(!1),ms.Z.disableCapture(e.winId),gs.Z.handleCaptureLocation(e.winId,h,o)},E=mn()("CaptureArea","PreserveTransitions",{Area:"area"===h,FullPage:"area"!==h}),_=mn()("CaptureRect",{Hidden:!u?.rectStyle});return(0,fn.jsxs)(fn.Fragment,{children:[(0,fn.jsx)("div",{ref:n,style:u?.areaStyle,id:"capture-area",className:E,tabIndex:0,onKeyDown:t=>{const{keyCode:n}=t;n===qi.Z.KEY_ESCAPE?(gs.Z.cancelCallback(e.winId),m&&v(!1)):n!==qi.Z.KEY_ENTER&&n!==qi.Z.KEY_RETURN||k()},onPointerDown:e=>{h.includes("area")&&(v(!0),s.current=o.current=e.clientX,a.current=r.current=e.clientY,b(),e.target instanceof HTMLElement&&e.target.setPointerCapture(e.pointerId.toString()),(0,Cs.Z)(e))},onPointerMove:e=>{m&&(o.current=e.clientX,r.current=e.clientY,T(),b())},onPointerUp:I}),!m&&Ms(_s,{winId:e.winId,captureSquare:u?.rectStyle,isInternalUrl:d,inProgress:f,mode:h,setMode:e=>{const{value:t}=e.currentTarget;"area"!==t&&"fullpage"!==t||nt.Z.set(D.kWebpagesCaptureCaptureMode,t)},setFormat:e=>{const{value:t}=e.currentTarget;"png"===t||"jpg"===t?(nt.Z.set(D.kWebpagesCaptureSaveLocation,"file"),nt.Z.set(D.kWebpagesCaptureCompressionFormat,t)):nt.Z.set(D.kWebpagesCaptureSaveLocation,t)},doScreenshot:k}),(0,fn.jsx)("div",{ref:i,style:u?.rectStyle,className:_,children:xs.map((e=>Ms("div",{className:`CaptureRect-Corner ${e}`,onPointerDown:C,onPointerMove:S,onPointerUp:I},e)))})]})}),Ds);class Rs extends Z.Z{getInitialState(){return{map:new Map}}reduce(e,t){switch(t.actionType){case"CAPTURE_ENABLE":return{map:e.map.set(t.winId,{capturing:!0})};case"CAPTURE_DISABLE":{const n=e.map;return n.delete(t.winId),{map:n}}}return e}getCapturingState(e){const t=this.getState().map.get(e);return void 0!==t&&t.capturing}}const Bs=new Rs;var Fs=n(55022),Us=n(65398);class Vs extends Us.Z{_storeState=new Map;getUtilityWebView(e){return this._storeState.get(e)}dispatchAction(e){if("UTILITY_WEBVIEW_SET_VIEW"===e.actionType)this._storeState.set(e.windowId,e.webview),this.emitChange()}}const Ws=new Vs(l.Z);var Hs=n(70864);const zs=new class{clearBrowsingData(e,t,n){const s=Ws.getUtilityWebView(e);s&&s.clearData({since:n},(0,Ji.Z)(t,["downloads","formData","history","serverBoundCertificates","serviceWorkers","siteUsageData","pluginData","passwords","typedHistory","translateHistory","siteSettings","discardUserData"]),(()=>{y.Z.runtime.lastError&&console.warn("Error clearing data: ",y.Z.runtime.lastError.message),y.Z.browsingData.remove({since:n},(0,Ji.Z)(t,["typedHistory","translateHistory","sessionCookies","persistentCookies","discardUserData"]),(()=>{y.Z.runtime.lastError&&console.warn("Error clearing data: ",y.Z.runtime.lastError.message),t.history&&(A.removeLocalHistory(n),d.Z.contentBlocking.clearBlockedCounters()),t.translateHistory&&d.Z.translateHistory.reset(n),t.discardUserData&&(i.Z.emptyTrash(),Fs.Z.emptyTrash(),Hs.Z.emptyTrash()),l.Z.dispatch({actionType:"BROWSING_DATA_REMOVED",dataTypes:t,since:n})}))}))}};class Gs extends Us.Z{dispatchAction(e){if("BROWSING_DATA_REMOVED"===e.actionType)this.emitChange()}}const $s=new Gs(l.Z);var Ks,js=n(67074);function Ys(e,t,n,i){Ks||(Ks="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Ks,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Xs=1e6,Qs=[{text:(0,le.Z)("Past Hour"),value:"past_hour",format:"h",difference:-1},{text:(0,le.Z)("Past Day"),value:"past_day",format:"d",difference:-1},{text:(0,le.Z)("Past Week"),value:"past_week",format:"d",difference:-7},{text:(0,le.Z)("Past 4 Weeks"),value:"past_4_weeks",format:"d",difference:-28},{text:(0,le.Z)("All Time"),value:"everything",format:"",difference:0}],qs=[{value:"history",category:"history",text:(0,le.Z)("Browsing History")},{value:"typedHistory",category:"history",text:(0,le.Z)("Typed History")},{value:"siteUsageData",category:"history",text:(0,le.Z)("Site Usage Data")},{value:"translateHistory",category:"history",text:(0,le.Z)("Translation History")},{value:"downloads",category:"downloads",text:(0,le.Z)("Downloads")},{value:"cookies",category:"sitedata",text:(0,le.Z)("Cookies")},{value:"sessionCookies",category:"sitedata",text:(0,le.Z)("Cookies")},{value:"persistentCookies",category:"sitedata",text:(0,le.Z)("Cookies")},{value:"pluginData",category:"sitedata",text:(0,le.Z)("Plugin Data")},{value:"localStorage",category:"storage",text:(0,le.Z)("Storage (including Extension Storage)")},{value:"fileSystems",category:"storage",text:(0,le.Z)("File Systems")},{value:"webSQL",category:"storage",text:(0,le.Z)("Web SQL")},{value:"serverBoundCertificates",category:"storage",text:(0,le.Z)("Server Bound Certificates")},{value:"indexedDB",category:"storage",text:(0,le.Z)("Indexed DB")},{value:"serviceWorkers",category:"storage",text:(0,le.Z)("Service Workers")},{value:"cache",category:"caches",text:(0,le.Z)("Cache")},{value:"cacheStorage",category:"caches",text:(0,le.Z)("Cache Storage")},{value:"discardUserData",category:"caches",text:(0,le.Z)("Discard User Data")},{value:"passwords",category:"passwords",text:(0,le.Z)("Passwords (including your Sync login password)")},{value:"formData",category:"forms",text:(0,le.Z)("Form Autofill Data")},{value:"appcache",category:"appcache",text:(0,le.Z)("Applications Cache")},{value:"siteSettings",category:"sitesettings",text:(0,le.Z)("Site Settings")}];var Js=Ys("p",{className:"in-progress"});class eo extends tn.PureComponent{static contextType=dn.Z;constructor(e){super(e);const t=qs.reduce(((e,t)=>(e[t.value]=!1,e)),{}),n=M.Z.get(D.kClearPrivateDataEntries);n&&Object.entries(n).forEach((([e,i])=>{void 0===t[e]&&delete n[e]})),Object.assign(t,n);const i=new Map;qs.forEach((e=>{const t=i.get(e.category);t?t.push(e):i.set(e.category,[e])})),i.forEach((e=>{if(e.length>1){let n=0;e.forEach((e=>{t[e.value]&&n++})),0!==n&&n!==e.length&&e.forEach((e=>{t[e.value]=!0}))}}));const s={};let o=!0;Object.keys(t).forEach((e=>{s[e]=0,t[e]||(o=!1)})),this.state={all:o,inProgress:!1,deleteHistoryFrom:M.Z.get(D.kClearPrivateDataRange),dataToRemove:t,dataToRemoveCounters:s}}componentDidMount(){$s.addListener(this._onBrowsingDataStoreChange),this.updateClearDownloadsCounters(),this.updateClearBrowsingHistoryCounters()}componentWillUnmount(){$s.removeListener(this._onBrowsingDataStoreChange)}_onBrowsingDataStoreChange=()=>{this.props.onYes&&this.props.onYes()};selectChanged=e=>{this.updateClearDownloadsCounters({deleteHistoryFrom:e.target.value}),this.updateClearBrowsingHistoryCounters({deleteHistoryFrom:e.target.value}),this.setState({deleteHistoryFrom:e.target.value})};_onYes=e=>{nt.Z.set(D.kClearPrivateDataEntries,this.state.dataToRemove),nt.Z.set(D.kClearPrivateDataRange,this.state.deleteHistoryFrom),this.setState({inProgress:!0}),e={deleteHistoryFrom:this.state.deleteHistoryFrom,...e};const t=Qs.find((e=>this.state.deleteHistoryFrom===e.value)),n=t&&"everything"!==this.state.deleteHistoryFrom?b()().add(t.difference,t.format).startOf(t.format).valueOf():0;zs.clearBrowsingData(this.context.vivaldiWindowId,{...this.state.dataToRemove},n)};_onNo=()=>{this.props.onNo&&this.props.onNo()};updateClearDownloadsCounters=e=>{if("everything"===(e={deleteHistoryFrom:this.state.deleteHistoryFrom,downloads:this.state.dataToRemove.downloads,...e}).deleteHistoryFrom)y.Z.downloads.search({},(e=>{this.setState((t=>({dataToRemoveCounters:{...t.dataToRemoveCounters,downloads:e.length}})))}));else{const t=this.getSelectedStartTime(e.deleteHistoryFrom);y.Z.downloads.search({},(e=>{const n=e.filter((e=>b()(e.startTime).valueOf()>t));this.setState((e=>({dataToRemoveCounters:{...e.dataToRemoveCounters,downloads:n.length}})))}))}};getSelectedStartTime=e=>{const t=Qs.find((t=>e===t.value));let n;return n=t?b()().add(t.difference,t.format).startOf(t.format).valueOf():b()().add(-1,"h").startOf("h").valueOf(),n};updateClearBrowsingHistoryCounters=e=>{if("everything"===(e={deleteHistoryFrom:this.state.deleteHistoryFrom,history:this.state.dataToRemove.history,...e}).deleteHistoryFrom)y.Z.history.search({text:"",startTime:0,maxResults:Xs},(e=>{this.setState((t=>({dataToRemoveCounters:{...t.dataToRemoveCounters,history:e.length}})))}));else{const t=this.getSelectedStartTime(e.deleteHistoryFrom);y.Z.history.search({text:"",maxResults:Xs,startTime:t},(e=>{this.setState((t=>({dataToRemoveCounters:{...t.dataToRemoveCounters,history:e.length}})))}))}};toggleAll=()=>{this.setState((e=>{const t=!e.all,n={};return Object.keys(e.dataToRemove).forEach((e=>{n[e]=t})),{all:t,dataToRemove:n}}))};toggleOne=(e,t)=>{"history"===e&&this.updateClearBrowsingHistoryCounters({history:t.target.checked}),"downloads"===e&&this.updateClearDownloadsCounters({downloads:t.target.checked});const n=qs.reduce(((n,i)=>(i.category===e&&(n[i.value]=t.target.checked),n)),{});this.setState((e=>{const t={...e.dataToRemove,...n};return{dataToRemove:t,all:Boolean(!Object.keys(t).find((e=>!1===t[e])))}}))};render(){if(z.ZP.isGuestSession(this.context.vivaldiWindowId))return Ys("header",{className:"dialog-header"},void 0,Ys("p",{className:"error"},void 0,(0,le.Z)("Delete Browsing Data not available from guest windows.")));const e=Qs.map((e=>Ys("option",{value:e.value},e.value,e.text))),t=Boolean(!Object.keys(this.state.dataToRemove).find((e=>!0===this.state.dataToRemove[e]))),n=qs.map(((e,t,n)=>{if(!n[t-1]||e.category!==n[t-1].category)return Ys("li",{style:{paddingLeft:"18px"}},e.value,Ys("label",{},void 0,Ys("input",{type:"checkbox",checked:this.state.dataToRemove[e.value],onChange:t=>this.toggleOne(e.category,t)}),Ys("span",{},void 0,e.text),this.state.dataToRemoveCounters[e.value]>0&&this.state.dataToRemove[e.value]&&Ys("span",{className:"item-count"},void 0,this.state.dataToRemoveCounters[e.value])))}));var i=Ys("div",{className:"dialog-clear-data"},void 0,Ys("header",{className:"dialog-header"},void 0,Ys("h1",{},void 0,(0,le.Z)("title","Delete Browsing Data"))),Ys("form",{className:"dialog-clear-data",onSubmit:this._onYes},void 0,Ys("div",{className:"dialog-content"},void 0,Ys("div",{className:"setting-single"},void 0,Ys("label",{},void 0,Ys("span",{},void 0,(0,le.Z)("Delete Data for:")),Ys("select",{onChange:this.selectChanged,value:this.state.deleteHistoryFrom,autoFocus:!0},void 0,e))),Ys("div",{className:"setting-single pad-top"},void 0,Ys("ul",{},void 0,Ys("li",{style:{paddingBottom:"6px"}},void 0,Ys("label",{},void 0,Ys("input",{type:"checkbox",checked:this.state.all,onChange:this.toggleAll}),Ys("span",{},void 0,(0,le.Z)("browser","All")))),n))),Ys("footer",{className:"dialog-footer"},void 0,Ys("input",{type:"submit",disabled:this.state.inProgress||t,value:(0,le.Z)("title","Delete")}),Ys("input",{type:"button",onClick:this._onNo,disabled:this.state.inProgress,value:(0,le.Z)("Cancel")}),this.state.inProgress&&Js)));return(0,js.ZP)(i,this.props.filter)}}const to=eo;var no,io;function so(e,t,n,i){no||(no="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:no,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function oo(e){return so(ln.Z,{onRequestClose:e.onClose},void 0,so(to,{onNo:e.onClose,onYes:e.onClose}))}function ao(e,t,n,i){io||(io="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:io,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class ro extends tn.Component{static contextType=dn.Z;state={doNotShowAgain:!1};_onNo=()=>{this.props.onRequestClose()};_onYes=()=>{nt.Z.set(D.kBookmarksConfirmOpening,!this.state.doNotShowAgain),this.props.onRequestClose(),Y.Z.openUrls(this.context.vivaldiWindowId,this.props.options.urls,{...this.props.options.openOptions})};_toggleDoNotShowAgain=()=>{this.setState((e=>({doNotShowAgain:!e.doNotShowAgain})))};render(){return ao(ln.Z,{onRequestClose:this._onNo},void 0,ao("header",{className:"dialog-header"},void 0,ao("h1",{className:"dialog-title"},void 0,(0,le.Z)("Open Multiple Links"))),ao("form",{onSubmit:this._onYes},void 0,ao("div",{className:"dialog-content"},void 0,ao("p",{},void 0,(0,le.Z)("Do you want to open $1 link?","Do you want to open $1 links?",[this.props.options.urls.length])),ao("label",{className:"dialog-checkbox"},void 0,ao("input",{type:"checkbox",checked:this.state.doNotShowAgain,onChange:this._toggleDoNotShowAgain}),ao("span",{},void 0,(0,le.Z)("Do not ask again")))),ao("footer",{className:"dialog-footer"},void 0,ao("input",{type:"submit",onClick:this._onYes,value:(0,le.Z)("Open All Links"),autoFocus:!0}),ao("input",{type:"button",onClick:this._onNo,value:(0,le.Z)("Cancel")}))))}}const lo=async(e,t,n,i,s)=>{if(t.length<2)s(t,[]);else if(!z.ZP.isIncognito(e)&&n.suggestUrl)try{const{url:e,contentType:o,postParams:a}=await d.Z.searchEngines.getSuggestRequest(n.id,t);if(i.aborted)return;const r=""!==a,l={signal:i,headers:r?{"Content-Type":o}:void 0,method:r?"POST":"GET",body:r?a:void 0},c=await fetch(e,l),h=await c.json();s(t,h[1].filter((e=>"string"==typeof e)))}catch(e){"AbortError"!==e.name&&console.log(e)}},co=()=>{let e=1;const t={id:"",extensionId:"",readOnly:!1,name:"New Engine",keyword:"new",faviconUrl:"",url:"https://example.com/search?q=%s",postParams:"",suggestUrl:"",suggestPostParams:"",imageUrl:"",imagePostParams:"",prepopulateId:0};for(;Nn.Z.getByKeyword(t.keyword);)t.keyword=`new${e}`,e++;return t};var ho,po=n(57458);function uo(e,t,n,i){ho||(ho="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:ho,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class go extends tn.Component{constructor(e){super(e),this.state={name:this.props.name?this.props.name:"",url:this.props.url?this.props.url.replace("{searchTerms}","%s"):"",nickname:this.props.name?this.props.name:"",nicknameTaken:!1,default:!1},this.faviconUrl=""}componentDidMount(){this.constructFavicon(this.props.url)}getDataUri=(e,t)=>{const n=new Image;n.onload=function(){const n=document.createElement("canvas");n.width=this.naturalWidth,n.height=this.naturalHeight,n.getContext("2d").drawImage(this,0,0),t(n.toDataURL(e))},n.src=e};constructFavicon=e=>{if(e){const t=(0,Ni.q9)(e.trim()),n=document.createElement("a");n.href=t;const i=n.protocol+"//"+n.host+"/favicon.ico";this.getDataUri(i,(e=>{this.faviconUrl=e}))}};updateFavicon=e=>{if("string"==typeof e.target.value){const t=e.target.value.trim();if(t)return void this.constructFavicon(t)}this.faviconUrl=""};canCreate=()=>this.state.name.trim()&&this.state.url.trim()&&this.state.nickname.trim()&&!1===this.state.nicknameTaken;create=async()=>{if(this.canCreate()){const e=co();e.name=this.state.name.trim(),e.keyword=this.state.nickname,e.url=(0,po.encode)(this.state.url.trim()),e.faviconUrl=this.faviconUrl;const t=await d.Z.searchEngines.addTemplateUrl(e);t&&this.state.default&&d.Z.searchEngines.setDefault("defaultSearch",t),"function"==typeof this.props.onClose&&this.props.onClose()}};nameChange=e=>{"string"==typeof e.target.value&&this.setState({name:e.target.value})};defaultChange=e=>{"boolean"==typeof e.target.checked&&this.setState({default:e.target.checked})};urlChange=e=>{"string"==typeof e.target.value&&this.setState({url:e.target.value})};nicknameChange=e=>{if("string"==typeof e.target.value){const t=e.target.value.trim();this.setState({nickname:t,nicknameTaken:t.length>0&&void 0!==Nn.Z.getByKeyword(t)})}};render(){const e=this.state.nicknameTaken?Nn.Z.getByKeyword(this.state.nickname):null,t=e?e.name:"";return uo("form",{onSubmit:this.create},void 0,uo("header",{className:"dialog-header"},void 0,uo("h1",{className:"dialog-title"},void 0,(0,le.Z)("Add Search Engine"))),uo("div",{className:"dialog-content"},void 0,uo("label",{className:"fieldset"},void 0,uo("input",{className:"searchengine_url setting-single-flex",type:"text",placeholder:(0,le.Z)("URL"),value:this.state.url,onChange:this.urlChange,onBlur:this.updateFavicon})),uo("label",{className:"fieldset"},void 0,uo("input",{className:"setting-single-flex",type:"text",value:this.state.name,placeholder:(0,le.Z)("Description"),onChange:this.nameChange,autoFocus:!0}),uo("input",{className:"searchengine_keyword setting-single-noflex",type:"text",value:this.state.nickname,placeholder:(0,le.Z)("Nickname"),onChange:this.nicknameChange})),this.state.nicknameTaken&&uo("p",{className:"info",style:{textAlign:"right"}},void 0,(0,le.Z)("Nickname in use by $1 search engine",[t])),uo("label",{className:"fieldset"},void 0,uo("input",{type:"checkbox",checked:this.state.default,onChange:this.defaultChange}),uo("span",{},void 0,(0,le.Z)("Set as Default Search")))),uo("footer",{className:"dialog-footer"},void 0,uo("input",{type:"submit",disabled:!this.canCreate(),value:(0,le.Z)("Add")}),uo("input",{type:"button",onClick:this.props.onClose,value:(0,le.Z)("Cancel")})))}}const mo=go;var vo;function fo(e,t,n,i){vo||(vo="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:vo,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const yo=function(e){return fo(ln.Z,{onRequestClose:e.onClose},void 0,fo("div",{className:"dialog-addsearch"},void 0,fo(mo,{onClose:e.onClose,name:e.name,url:e.url})))},wo=1024,bo=[(0,le.Z)("bytes"),(0,le.Z)("KB"),(0,le.Z)("MB"),(0,le.Z)("GB"),(0,le.Z)("TB"),(0,le.Z)("PB")];function Co(e,t){if(isNaN(e))return e?e.toString():"";if(e<=0)return(0,le.Z)("0 bytes");void 0===t&&(t=e<wo?0:2);let n=bo.length-1;for(var i=0;i<bo.length;i++)if(e<Math.pow(wo,i+1)){n=i;break}let s=(e/Math.pow(wo,n)).toLocaleString(void 0,{maximumFractionDigits:t});if(t>0){const e="."+"0".repeat(t);s.endsWith(e)&&(s=s.substring(0,s.length-e.length))}return s+(bo[n]?" "+bo[n]:"")}const So=function(e){return class extends tn.Component{state={disabled:!0};componentDidMount(){this.timeout=setTimeout(this.enable,500)}componentWillUnmount(){clearTimeout(this.timeout)}enable=()=>this.setState({disabled:this.props.disabled||!1});render(){const{disabled:t,...n}=this.props,i=e||"input";return(0,fn.jsx)(i,{...n,disabled:this.state.disabled})}}};var To,Io=n(86461);function ko(e,t,n,i){To||(To="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:To,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ao=So("input");class Zo extends tn.Component{static contextType=dn.Z;refDefaultAction=tn.createRef();state={askNextTime:!1};componentDidMount(){this.refDefaultAction.current?.focus()}maybeShowDownloads(){!document.querySelector("#panels-container .downloads.active")&&M.Z.get(D.kDownloadsOpenPanelOnNew)&&a.Z.executeActions(this.context.vivaldiWindowId,(0,Io.P)("DownloadButton",this.context.vivaldiWindowId)?"COMMAND_SHOW_DOWNLOADS_POPOUT":"COMMAND_SHOW_DOWNLOADS_PANEL")}onOpen=()=>{this.props.customData.request.allow("open"),this.maybeShowDownloads(),this.close()};onSave=()=>{this.props.customData.request.allow(),this.maybeShowDownloads(),this.close()};onSaveAs=()=>{this.props.customData.request.allow("saveas"),this.maybeShowDownloads(),this.close()};onCancel=()=>{this.props.customData.request.deny(),this.close()};close=()=>{nt.Z.set(D.kDownloadsStartAutomatically,this.state.askNextTime),this.props.onClose()};onAskDownloadChanged=({target:e})=>{this.setState({askNextTime:e.checked})};render(){const e=this.props.customData.url.startsWith("data:");let t="",n="";this.props.customData.suggestedFilename&&e||({hostname:t,pathname:n}=_i.parse(this.props.customData.url));const i=this.props.customData.suggestedFilename?this.props.customData.suggestedFilename:(n||"").split("/").pop(),s=e?(0,le.Z)("Data URL"):t,o=-1===this.props.customData.fileSize?(0,le.Z)("Unknown"):Co(this.props.customData.fileSize);return ko(ln.Z,{ignoreEscape:!1,onRequestClose:this.onCancel},void 0,ko("div",{className:"dialog-download"},void 0,ko("header",{className:"dialog-header"},void 0,ko("h1",{className:"dialog-title",title:i},void 0,(0,le.Z)("Download “$1”?",[i]))),ko("div",{className:"dialog-content"},void 0,ko("p",{},void 0,ko("span",{className:"label",title:i},void 0,(0,le.Z)("File Name:")),i),ko("p",{},void 0,ko("span",{className:"label"},void 0,(0,le.Z)("File Size:")),o),ko("p",{},void 0,ko("span",{className:"label"},void 0,(0,le.Z)("Host:")),s),ko("label",{className:"autosave"},void 0,ko("input",{type:"checkbox",onChange:this.onAskDownloadChanged}),ko("span",{},void 0,(0,le.Z)("Always Save Files to Default Download Location")))),ko("footer",{className:"dialog-footer"},void 0,(0,fn.jsx)("input",{type:"button",className:"primary",onClick:this.onSave,ref:this.refDefaultAction,value:(0,le.Z)("Save")}),ko("input",{type:"button",onClick:this.onSaveAs,value:(0,le.Z)("Save As...")}),ko(Ao,{type:"button",onClick:this.onOpen,value:(0,le.Z)("Open")}),ko("input",{type:"button",onClick:this.onCancel,value:(0,le.Z)("Cancel")}))))}}const Eo=Zo;var _o;function No(e,t,n,i){_o||(_o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:_o,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Mo extends tn.Component{constructor(e){super(e),this.state={hover:!1,show:!0}}componentDidMount(){this.hideSelf(4e3)}componentWillUnmount(){this._timeoutID&&clearTimeout(this._timeoutID)}startHover=e=>{this.setState({hover:!0})};endHover=e=>{this.setState({hover:!1})};showSelf=()=>{this._timeoutID&&clearTimeout(this._timeoutID),this.setState({show:!0}),this.props.onVisibilityChanged&&this.props.onVisibilityChanged(!0)};hideSelf=e=>{this._timeoutID&&clearTimeout(this._timeoutID),this._timeoutID=setTimeout(this.onClose,e)};onClose=()=>{this.setState({show:!1,hover:!1}),this.props.onClose&&this.props.onClose(),this.props.onVisibilityChanged&&this.props.onVisibilityChanged(!1)};onContextMenu=e=>{this._timeoutID&&clearTimeout(this._timeoutID),this.props.onContextMenu&&this.props.onContextMenu(e)};show=()=>{this.showSelf(),this.hideSelf(4e3)};render(){var e=mn()({overlayinfobubble:!0,show:this.state.hover||this.state.show});return No("div",{onMouseEnter:this.startHover,onMouseLeave:this.endHover},void 0,No("div",{className:e,onContextMenu:this.onContextMenu,onClick:this.hideSelf.bind(this,0)},void 0,this.props.overlayText))}}const Po=Mo;class Do extends tn.Component{static contextType=dn.Z;overlayRef=null;overlayVisible=!0;constructor(e){super(e),this.state={contextOpen:!1,show:!0}}showSelf=()=>{this.setState({show:!0}),this.overlayRef&&this.overlayRef.show()};hideSelf=()=>{this.setState({show:!1,contextOpen:!1})};alwaysHide=()=>{nt.Z.set(D.kWebpagesFullScreenShowBubble,!1),this.hideSelf()};shouldShow=()=>!!M.Z.get(D.kWebpagesFullScreenShowBubble)&&(this.state.contextOpen||this.state.show);onOverlayVisibilityChanged=e=>{this.overlayVisible=e};onContextMenu=e=>{const t=[{handler:this.hideSelf.bind(this),...(0,Mn.Z)("Hide Fullscreen Reminder")},{handler:this.alwaysHide,...(0,Mn.Z)("Never Show Fullscreen Reminder")}];(0,zi.Z)(this.context.vivaldiWindowId,t,(e=>this.setState({contextOpen:e})))(e)};render(){let e=null;if(this.shouldShow()){const t=(0,le.Z)("Press Escape key to exit fullscreen.");e=(0,fn.jsx)(Po,{ref:e=>this.overlayRef=e,customData:this.props.customData,onClose:this.props.closeDialog,onContextMenu:this.onContextMenu,onVisibilityChanged:this.onOverlayVisibilityChanged,overlayText:t})}return e}}const xo=Do;var Oo,Lo=n(29194);function Ro(e,t,n,i){Oo||(Oo="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Oo,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Bo="CREATE_CALENDAR";class Fo extends tn.PureComponent{state={calendars:Lo.Z.getCalendars()};componentDidMount(){Lo.Z.addListener(this.#t)}componentWillUnmount(){Lo.Z.removeListener(this.#t)}#t=e=>{"calendarDataReady"===e&&this.setState({calendars:Lo.Z.getCalendars()})};onNameChange=e=>{const{importOption:t}=this.props,n=e.target.value===Bo?{createNew:!0}:{calendarId:e.target.value,createNew:!1};this.props.calendarChange(t.importId,{...t,...n})};setCreateNewName=e=>{const{importOption:t}=this.props;this.props.calendarChange(t.importId,{...t,newCalendarName:e.target.value})};render(){const{importOption:e}=this.props,{importId:t,createNew:n,calendarId:i,newCalendarName:s}=e;return(0,fn.jsxs)(fn.Fragment,{children:[Ro("div",{className:"import-calendar-target"},void 0,Ro("label",{},void 0,Ro("span",{},void 0,t?(0,le.Z)("$1 to:",[t]):(0,le.Z)("Import to"))),Ro("select",{onChange:this.onNameChange,name:"calendarId",value:n?Bo:i},void 0,this.state.calendars.map((e=>Ro("option",{value:e.id},e.id,e.description||e.name))),Ro("option",{value:Bo},void 0,n?s:(0,le.Z)("New Calendar...")))),n&&Ro("label",{className:"import-calendar-target-create"},void 0,Ro("span",{},void 0,(0,le.Z)("New Calendar Name")),Ro("input",{value:s,onChange:this.setCreateNewName}))]})}}const Uo=Fo;var Vo,Wo=n(22616),Ho=n(18350);function zo(e,t,n,i){Vo||(Vo="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Vo,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Go extends tn.PureComponent{static contextType=dn.Z;displayName="ImportCalendarDialog";state={importOptions:new Map,fileEntries:[],calendarId:Lo.Z.getDefaultCalendar()?.id??"",calendarName:""};componentDidMount(){this.props.setStartImport(this.startImport),this.props.setChooseFile(this.loadImport)}loadImport=async()=>{const e=new Map,t=await o.Z.pickFilesForImport();t.forEach((t=>{e.set(t.name,{createNew:0===Lo.Z.getCalendars().length,calendarId:Lo.Z.getDefaultCalendar()?.id??"",newCalendarName:t.name,importId:t.name})})),this.setState({fileEntries:t,importOptions:e}),this.props.readyToStart(!0)};startImport=async()=>{M.Z.get(D.kMailIsTurnedOff)&&(de.Z.log("Calendar",["import"],"Calendar is turned off - turning it on for importing"),nt.Z.set(D.kMailIsTurnedOff,!1),Ho.Z.showContent(this.context.vivaldiWindowId,"calendar")),o.Z.startCalendarImport(this.context.vivaldiWindowId,this.state.importOptions).catch((e=>{Wo.Z.addImportError("Calendar","File Import",e)})),this.props.readyToStart(!1)};onCalendarChange=(e,t)=>{this.setState((n=>({importOptions:new Map(n.importOptions).set(e,t)})))};renderFileImport(e){const{name:t}=e,n=this.state.importOptions.get(t);if(n)return zo(Uo,{calendarChange:this.onCalendarChange,importOption:n},e.name)}render(){return zo("div",{className:"import-data"},void 0,zo("div",{className:"dialog-content"},void 0,(0,fn.jsx)(fn.Fragment,{children:this.state.fileEntries.length>0&&zo("div",{className:"import-calendar-targets"},void 0,this.state.fileEntries.map((e=>this.renderFileImport(e))))})))}}const $o=Go;var Ko=n(69417);async function jo(e){try{const t=await fetch(e,{method:"GET"});if(200!==t.status)throw`Fetch remote calendar. Status code: ${t.status}`;return t.text()}catch(e){throw de.Z.warn("Calendar",["network"],"Error fetching calendar",e),e}}var Yo,Xo=n(23750);function Qo(e,t,n,i){Yo||(Yo="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Yo,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class qo extends tn.PureComponent{static contextType=dn.Z;state={url:"",calendarId:Lo.Z.getDefaultCalendar()?.id??"",calendarName:"",importOption:{createNew:0===Lo.Z.getCalendars().length,calendarId:Lo.Z.getDefaultCalendar()?.id??"",newCalendarName:(0,le.Z)("My Calendar"),importId:""},status:""};componentDidMount(){this.props.setStartImport(this.startImport)}log(e){this.setState({status:e})}parseAndImport=async e=>{Wo.Z.clearImportProgress("Calendar",this.state.url);const{importOption:t}=this.state;if(!t)throw this.log((0,le.Z)("Import Error")),Error("Import error");return this.setState({status:(0,le.Z)("Importing...")}),(0,Xo.tP)(this.context.vivaldiWindowId,e,t).catch((e=>{Wo.Z.addImportError("Calendar",this.state.url,(0,le.Z)("Parsing: $1",[e]))}))};onUrlChange=e=>{this.setState({url:e.target.value})};startImport=async()=>{let e="";const{url:t}=this.state;if((0,Ni.C3)(t)){this.setState({status:(0,le.Z)("Fetching iCal...")});try{e=await jo(t)}catch(e){return void Wo.Z.addImportError("Calendar",t,(0,le.Z)("URL: $1. $2",[t,e]))}return this.parseAndImport(e).catch((e=>{Wo.Z.addImportError("Calendar",t,(0,le.Z)("Importing $1",[e]))}))}Wo.Z.addImportError("Calendar",t,(0,le.Z)("Invalid URL: $1",[t]))};onCalendarChange=(e,t)=>{this.setState({importOption:t})};render(){return(0,fn.jsxs)(fn.Fragment,{children:[Qo("div",{className:"import-calendar-file"},void 0,Qo(Ko.Z,{type:"text",onChange:this.onUrlChange,label:(0,le.Z)("Remote ICS Address"),value:this.state.url})),this.state.url&&Qo(Uo,{calendarChange:this.onCalendarChange,importOption:this.state.importOption}),this.state.status&&Qo("div",{},void 0,Qo("span",{},void 0,this.state.status))]})}}const Jo=qo;var ea;function ta(e,t,n,i){ea||(ea="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:ea,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const na=()=>[{value:5,name:(0,le.Z)("Every 5 Minutes")},{value:15,name:(0,le.Z)("Every 15 Minutes")},{value:30,name:(0,le.Z)("Every 30 Minutes")},{value:60,name:(0,le.Z)("Every Hour")},{value:120,name:(0,le.Z)("Every 2 Hours")},{value:360,name:(0,le.Z)("Every 6 Hours")},{value:720,name:(0,le.Z)("Every 12 Hours")},{value:1440,name:(0,le.Z)("Daily")},{value:10080,name:(0,le.Z)("Weekly")}].map((e=>ta("option",{value:e.value},e.value,e.name)));var ia;function sa(e,t,n,i){ia||(ia="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:ia,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class oa extends tn.PureComponent{constructor(e){super(e),this.state={feeds:this.mapFeeds(this.props.options)}}mapFeeds=e=>e.map((e=>({url:e.url||"",path:d.Z.utilities.generateGUID(),title:e.title||"",refreshInterval:"number"==typeof e.refreshInterval?e.refreshInterval:1440,offline:!1,lastChecked:0})));addFeed=()=>{const{feeds:e}=this.state;Wo.Z.setImportProgress("Feeds (OPML)","Feeds",0,e.length),At.add(e),Wo.Z.setImportProgress("Feeds (OPML)","Feeds",e.length,e.length),this.props.dismissable&&this.onDismiss()};onDismiss=()=>{this.props.onClose()};onChange=e=>{const{name:t,value:n,id:i}=e.target;this.setState((e=>{let s=0;return{feeds:e.feeds.map((e=>(s++,"fid"+s===i?{...e,[t]:n}:e)))}}))};feeds=()=>{let e=0;return this.state.feeds.map((t=>{e++;const n="fid"+e;return sa("div",{className:"feed-list-item"},n,sa("input",{type:"text",placeholder:(0,le.Z)("Title"),onChange:this.onChange,title:(0,le.Z)("Title"),value:t.title,name:"title",id:n}),sa("input",{type:"text",placeholder:(0,le.Z)("Address"),onChange:this.onChange,title:(0,le.Z)("Address"),value:t.url,name:"url",id:n}),sa("select",{onChange:this.onChange,value:t.refreshInterval,name:"refreshInterval",id:n},void 0,na()))}))};render=()=>sa("div",{className:"dialog-add-feed"},void 0,sa("header",{className:"dialog-header"},void 0,sa("h1",{},void 0,(0,le.Z)("browser","Add Feed"))),sa("div",{className:"dialog-content"},void 0,this.feeds()),sa("footer",{className:"dialog-footer"},void 0,sa("input",{type:"button",value:(0,le.Z)("Add Feed","Add Feeds",[this.state.feeds.length]),className:"primary",onClick:this.addFeed}),this.props.dismissable&&sa("input",{type:"button",onClick:this.onDismiss,value:(0,le.Z)("Cancel")})))}const aa=oa;var ra,la=n(70520);function da(e,t,n,i){ra||(ra="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:ra,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function ca(e){let t=[];return e.forEach((e=>{e.feedurl&&t.push({title:e.plaintitle,url:e.feedurl,path:e.feedurl,supported:e.supported}),e.items.length&&(t=t.concat(ca(e.items)))})),t}function ha(e,t){(0,Ct.c)({title:(0,le.Z)("Import Feeds (OPML file)"),body:t}),X.Z.setStatus(e,t)}class pa extends tn.PureComponent{static contextType=dn.Z;#n=!1;state={listFeeds:!1,feeds:{}};componentDidMount(){this.#n=!0,this.props.setChooseFile(this.chooseAndParseFile)}componentWillUnmount(){this.#n=!1}chooseAndParseFile=async()=>{const e=this.context.vivaldiWindowId,t=await async function(){return new Promise(((e,t)=>{y.Z.fileSystem.chooseEntry({type:"openFile",accepts:[{mimeTypes:["text/*"],extensions:["opml","txt"],description:(0,le.Z)(".opml and .txt files")}]},(n=>{y.Z.runtime.lastError||!n?t(y.Z.runtime.lastError||"Cancelled opening file"):e(n)}))}))}();if(t){M.Z.get(D.kMailIsTurnedOff)&&(de.Z.info("Mail",["import"],"Mail is turned off - turning it on for importing an OPML file"),nt.Z.set(D.kMailIsTurnedOff,!1),Ho.Z.showContent(e,"feeds"));const i=await(n=t,new Promise((e=>{n.file((t=>{const n=new FileReader;n.onloadend=()=>e(n.result),n.readAsArrayBuffer(t),n.onerror=e=>console.error(n.error)}))}))),s=i instanceof ArrayBuffer?new Uint8Array(i):null;if(!s)throw new Error("Must be read as an ArrayBuffer");const o=(0,la.Z)(s),a=new DOMParser;try{const t=a.parseFromString(o,"application/xml"),n=(new Ae).parseOPML(t,"http://localhost/");if("string"==typeof n)ha(e,(0,le.Z)("File does not appear to be of OPML format."));else{const t=ca(n.items),i=t.filter((e=>e.supported));0===i.length?ha(e,(0,le.Z)("No items in this file are supported")):(t.length>i.length?ha(e,(0,le.Z)(t.length-i.length+" items in this file are not supported")):X.Z.clearStatus(e),this.#n&&this.setState({listFeeds:!0,feeds:i}))}}catch(t){throw ha(e,(0,le.Z)("Error parsing file - Not valid XML")),new Error(`Parsing failed: ${t}`)}}var n};render(){return(0,fn.jsx)(fn.Fragment,{children:this.state.listFeeds&&da(aa,{onClose:async()=>{},options:this.state.feeds,dismissable:!1})})}}const ua=pa;function ga(e,t,n,i){return e[t]=e[t]||{},e[t][n]=e[t][n]||{current:0,total:0},i&&(e[t][n].children=e[t][n].children||{},e[t][n].children&&(e[t][n].children[i]=e[t][n].children[i]||{current:0,total:0})),e}class ma extends Z.Z{getInitialState(){return{}}reduce(e,t){switch(t.actionType){case"IMPORT_PROGRESS":return(0,E.ZP)(e,(e=>{const{importType:n,importItemType:i,current:s,total:o,key:a}=t;e=ga(e,n,i,a),a&&e[n][i].children?(e[n][i].children[a].current=s,e[n][i].children[a].total=o):(e[n][i].current=s,e[n][i].total=o)}));case"IMPORT_PROGRESS_WARN":return(0,E.ZP)(e,(e=>{const{importType:n,importItemType:i,message:s}=t;(e=ga(e,n,i))[n][i].warnings=e[n][i].warnings||[],e[n][i].warnings.push(s)}));case"IMPORT_PROGRESS_ERROR":return(0,E.ZP)(e,(e=>{const{importType:n,importItemType:i,message:s}=t;(e=ga(e,n,i))[n][i].errors=e[n][i].errors||[],e[n][i].errors.push(s)}));case"IMPORT_PROGRESS_CLEAR":return(0,E.ZP)(e,(e=>{e[t.importType]={}}));default:return e}}getImportProgress(){return this.getState()}numImportsInStore(){return Object.keys(this.getState()).length}isImportTypeInProgress(e){const t=this.getImportProgress();for(const n in t[e]){const i=t[e][n];if(!i.children&&(-1===i.total||i.current<i.total))return!0;if(i.children)for(const e in i.children){const t=i.children[e];if(-1===t.total||t.current<t.total)return!0}}return!1}}const va=new ma;var fa=n(35369),ya=n(39045),wa=n(78347),ba=n(61472),Ca=n(83065);async function Sa(e,t){const n=ba.Z.getFolders();if(!("inbox"===t.toLowerCase()&&n[e]&&Object.keys(n[e]).some((e=>"inbox"===e.toLowerCase()))||n[e]&&n[e][t])){const n=Ia(t),i=wa.Z.getAccounts(),s=i[e]?i[e].folders:{},o="/",a=t.split(o),r={name:(0,Ca.kF)(a[a.length-1]),path:t,delimiter:o,type:n};s[n]=s[n]||[],s[n].push(r),await ya.Z.addFolders(e,s),ce.Z.addFolders(e,s)}}async function Ta(e,t){let n=it.Z.getByFolderId([e,t]);if(!n&&(n=await tt.Z.get(e,t),!n)){const i=Ia(t);if(n=ot.Z.getDefaultFilterForPath(e,t,i),await j.Z.addFilter(n,!1),i===ue.Oi){const n=ot.Z.getDefaultCustomFolderFilter(e,t),i=await vt.Z.filters.add(n);it.Z.updateFilters([i])}}}function Ia(e){let t=ue.Oi,n=e.toLowerCase();switch(n.startsWith("[gmail]/")&&(n=n.split("/")[1]),n){case"archive":t=ue.hn;break;case"drafts":t=ue.kY;break;case"inbox":t=ue.e9;break;case"junk":case"spam":t=ue.Hd;break;case"sent":case"sent mail":t=ue.Nz;break;case"trash":t=ue.uT}return t}function ka(e,...t){return"/"!==e[e.length-1]&&(e+="/"),e+t.join("/")}var Aa=n(72010),Za=n(84321);async function Ea(e,t,n,i){return await vt.Z.transaction("rw",mt.E.concat([vt.Z.filters]),(async()=>{const s=i.filter((e=>!!e.messageId)).map((e=>e.messageId)),o=await vt.Z.searchList.where("messageId").anyOf(s).toArray(),{newGroups:a,duplicates:r}=(0,Za.R)(e,i,o),l=a.map((e=>e[0])),d=await(0,mt.Z)(e,t,n,l),c=[];if(r.length>0){const i=await(0,Za.y)(e,t,n,r,!0);c.push(...i)}return{addedSles:d,sleUpdates:c}}))}var _a=n(9982),Na=n(93818),Ma=n(11430),Pa=n(24247);const Da=[["is_read",ue.T4.SEEN],["is_replied",ue.T4.ANSWERED],["is_forwarded",ue.T4.FORWARDED],["is_resent",void 0],["is_outgoing",void 0],["is_sent",void 0],["is_queued",void 0],["is_seen",void 0],["is_timequeued",void 0],["is_deleted",ue.T4.DELETED],["has_attachment",void 0],["has_image_attachment",void 0],["has_audio_attachment",void 0],["has_video_attachment",void 0],["has_zip_attachment",void 0],["is_onepart_message",void 0],["currently unused bit",void 0],["is_waiting_for_indexing",void 0],["is_newsfeed_message",void 0],["partially_fetched",void 0],["is_news_message",void 0],["allow_8bit",void 0],["is_imported",void 0],["has_priority",void 0],["has_priority_low",void 0],["has_priority_max",void 0],["is_control_message",void 0],["allow_quotestring_qp",void 0],["has_keywords",void 0],["permanently_removed",void 0],["dir_forced_ltr",void 0],["dir_forced_rtl",void 0]];var xa=n(16445),Oa=n(93986),La=n(99895),Ra=n(76257),Ba=n(24651);async function Fa(e){const t=await d.Z.mailPrivate.readFileToBuffer(e);return new Uint8Array(t)}function Ua(e,t,n,i,s){Wo.Z.setImportProgress(e,t,n,i,s)}async function Va(e){const{path:t}=e;await vt.Z.importProgress.get(t)?await vt.Z.importProgress.update(t,e):await vt.Z.importProgress.add(e)}async function Wa(e){const t=await async function(e){const t=ka(e,"accounts.ini");try{const n=await d.Z.mailPrivate.readFileToText(t);if(n)return n;de.Z.log("Mail",["import"],`accounts.ini file not found in Opera Mail path: ${e}`)}catch(t){de.Z.log("Mail",["import"],`Failed to read accounts.ini file for Opera Mail path: ${e} - Error: ${t.message||t}`)}}(e);return t?function(e){const t={section:/^\[(Account(s)?[0-9]+)\]$/,param:/^([^=]+?)\s*=\s*(.*?)$/,comment:/^[;#].*$/},n=new Map,i=e.split(/[\r\n]+/);let s=null;return i.forEach((e=>{const i=e.trim();if(!t.comment.test(i))if(t.param.test(i)){const e=i.split("=",2),t=e[0].toLowerCase().replace(/\s+/g,"_"),o=isNaN(e[1])?e[1]:Number(e[1]);if(s){const e={...n.get(s),[t]:o};n.set(s,e)}else n.set(t,o)}else t.section.test(i)?(s=i.substr(1,i.length-2).toLowerCase(),n.set(s,{})):0===e.length&&s?s=null:de.Z.log("Mail",["parsing","accounts"],"ignored line:",i)})),de.Z.log("Mail",["parsing","accounts"],"parseMap:",n),(0,Pa.Z)(n).filter((([e,t])=>t.account_name)).map((([e,t])=>(t.email||de.Z.warn("Mail",["parsing","accounts"],`Account in section ${e} has no email address. Protocol: ${t.incoming_protocol}`),{section:e,MAIL_EMAIL:t.email||"",MAIL_PORT:t.incoming_port,MAIL_SERVER:t.incoming_servername||"",MAIL_USER:t.incoming_username||"",MAIL_SMTP_SERVER:t.outgoing_servername||"",MAIL_SMTP_PORT:t.outgoing_port,MAIL_SMTP_SOCKET_TYPE:587===t.outgoing_port?"starttls":"ssl",MAIL_SMTP_USER:t.outgoing_username||"",accountType:t.incoming_protocol,offline:!0,MAIL_PASSWORD:"",MAIL_SMTP_PASSWORD:"",preFetch:!!t.download_bodies})))}(t):[]}async function Ha(e,t,n,i,s){M.Z.get(D.kMailIsTurnedOff)&&(de.Z.log("Mail",["import"],"Mail is turned off - turning it on for importing from m2"),nt.Z.set(D.kMailIsTurnedOff,!1),Ho.Z.showContent(e,"mail")),t&&"/"!==t[t.length-1]&&(t+="/");const o=await async function(e,t,n){de.Z.log("Mail",["import"],"importing accounts from",e);const i=wa.Z.getAccounts(),s=(await Wa(e)).filter((e=>n.find((t=>t.accountId===e.MAIL_EMAIL&&t.accountType===e.accountType)))),o=new Map;for(let e=0;e<s.length;e++){const n=s[e];Ua(t,"MailAccounts",e+1,s.length);try{if(![ue.s9.IMAP,ue.s9.POP].includes(n.accountType.toUpperCase())){console.warn(`Importing accounts of type "${n.accountType}" is not supported`),Wo.Z.addImportWarning(t,"MailAccounts",(0,le.Z)(`Importing accounts of type "${n.accountType}" is not supported`));continue}if(o.set(n.section,n.MAIL_EMAIL),i[n.MAIL_EMAIL])continue;if(n.accountType===ue.s9.POP&&s.find((e=>e.MAIL_EMAIL===n.MAIL_EMAIL&&e.accountType===ue.s9.IMAP)))continue;const e=(0,Ji.Z)(n,"section");await ee.Z.addAccount(e,[""]),(0,Oa.Z)(e),de.Z.log("Mail",["import"],"... imported account",n.MAIL_EMAIL)}catch(e){Wo.Z.addImportError(t,"MailAccounts",(0,le.Z)("Failed importing account $1",[n.MAIL_EMAIL])),console.error(`Failed importing account ${JSON.stringify(n)}`)}}return o}(n,i,s);await async function(e,t,n){de.Z.log("Mail",["import"],"importing contacts from",t);const i=await async function(e){const t=ka(e,"contacts.adr"),n=await d.Z.mailPrivate.readFileToText(t);n||(y.Z.runtime.lastError?console.error(y.Z.runtime.lastError):console.warn(`contacts.adr file not found in Opera profile path: ${e}`));return n}(t);if(!i)return Wo.Z.addImportWarning(n,"MailContacts",(0,le.Z)("No contacts found in $1",t)),void de.Z.log("Mail",["import"],"... no contacts found in",t);const s=function(e){const t=e.split("#FOLDER")[0].split("#CONTACT");t.shift();const n=t.map((e=>e.replace(/\t/g,""))).map((e=>e.split(/[\r\n]+/g))).map((e=>{const t={};return e.forEach((e=>{const n=e.trim(),i=n.split("=")[0].toLowerCase(),s=n.split("=")[1];i.length&&(t[i]=s)})),t}));return de.Z.log("Mail",["parsing","contacts"],"parsed:",n),n.map(((e,t)=>{const{mail:n="",postaladdress:i="",phone:s="",fax:o=""}=e,a=String.fromCharCode(2)+String.fromCharCode(2),r=n.split(a),l=i.split(a),d=r.map(((e,t)=>({emailAddress:e,id:String(t),type:""}))),c=l.map(((e,t)=>({postalAddress:e,id:String(t),type:""})));let h=0;const p=[];return s&&p.push({phoneNumber:s,id:String(h++),type:""}),o&&p.push({phoneNumber:o,id:String(h++),type:"work"}),{avatarUrl:"",birthday:0,emailAddresses:d,generatedFromSentMail:!1,id:String(t),name:e.name,note:e.description,phoneNumbers:p,postalAddresses:c,separator:!1,trusted:!0}}))}(i);let o=0;for(let t=0;t<s.length;t++){const i=s[t];Ua(n,"MailContacts",t+1,s.length),de.Z.log("Mail",["import"],`... importing contact ${++o}/${s.length}`);let a=!1;for(const t of i.emailAddresses){const n=Aa.Z.getContactsWithAddress(t.emailAddress);if(n){for(const t of i.emailAddresses)n.emailAddresses.includes(t.emailAddress)||(n.emailAddresses.push({id:t.id,emailAddress:t.emailAddress,type:t.type}),await K.Z.update(e,n.id,{name:n.name,birthday:n.birthday,note:n.note,generatedFromSentMail:n.generatedFromSentMail,avatarUrl:n.avatarUrl,separator:n.separator,trusted:n.trusted}));a=!0;break}}a||await K.Z.addContact(i)}de.Z.log("Mail",["import"],`... compared and/or imported ${s.length} contacts`)}(e,t,i),await async function(e,t,n,i){de.Z.log("Mail",["import"],"importing messages from",n);let s=0;for(const o of t){const[t,a]=o,r=ka(n,"store",t),l=await d.Z.mailPrivate.getFilePaths(r);s+=l.length,l.sort(),de.Z.log("Mail",["import"],`... found ${l.length} messages to import for account ${a}`),await Ka(r,n,l,(async(t,n,s,o)=>{await $a(e,a,t,i,n,s,o)})),de.Z.log("Mail",["import"],"... finished importing messages for account",a),await Va({path:r,currentIndex:0})}de.Z.log("Mail",["import"],"... finished importing",s,"messages"),X.Z.setStatus(e,(0,le.Z)("Finished importing $1 messages",[s]),ue.QM)}(e,o,n,i)}let za=0,Ga=0;async function $a(e,t,n,i,s,o,a){de.Z.log("Mail",["import"],`... importing ${a}/${o}`);const r=Date.now(),l={};for(let e=0;e<s.length;e++){const n=s[e],r=await Fa(n);await Ya(t,r,l,n),Ua(i,"MailMessages",a+e+1,o,t)}try{await async function(e){for(const t in e)for(const n in e[t]){const{folderType:i,messages:s}=e[t][n];for(const e of s){const t=(0,Ra.PW)((0,Ra.Zp)(e.raw));if(t){const{bodyParts:n,raw:i}=await Ma.Z.parse(e.raw,t.mimeTree);e.bodyParts=n,e.raw=i}}await(0,_a.Z)(t,n,s);const o=await Ea(t,n,i,s);j.Z.updateIndex(o);const{addedSles:a=[],sleUpdates:r=[]}=o,l=[];for(const e of a){const n=s.findIndex((t=>t.messageId===e.messageId&&t.sentDate===e.sentDate&&t.subject===e.subject));if(!(n>-1))throw new Error("Added sle not found in incoming batch");{l.push(e.id);const i=s[n];await La.Z.call(t,e.sentDate,e.id,i.raw)}}l.length>0&&await(0,Ba.o)(t,l);for(const e of r){const n=await(0,Na.Z)(e.id);if(!n)throw new Error("Updated sle not found in db");const i=s.findIndex((e=>e.messageId===n.messageId&&e.sentDate===n.sentDate&&e.subject===n.subject));if(i>-1)for(const e of n.sourceFilterIds){const o=it.Z.get(e);if(!o)throw new Error(`Filter not found for filterId ${e}`);await La.Z.call(o.accountId,n.sentDate,n.id,s[i].raw),await(0,Ba.h)(t,n.id)}else console.warn("Updated sle not found in incoming batch",n.subject,n.id)}}ce.Z.filter(),ee.Z.updateThreads()}(l)}catch(e){Wo.Z.addImportError(i,"MailMessages",(0,le.Z)("Failed importing messages. Error: $1",[e.message||e])),console.error(e)}const d=Date.now();za+=(d-r)/1e3,Ga+=s.length;const c=Ga/za;X.Z.setStatus(e,(0,le.Z)("Importing: $1/$2. Batch size: $3. Rate: $4/s",[a,o,s.length,c.toFixed(1)]))}async function Ka(e,t,n,i){const s=st.Z.adjustBatchSize.bind(void 0,25,1e3,500);let o=25;let a=(await vt.Z.importProgress.get(e))?.currentIndex||0;return new Promise(((r,l)=>{!async function d(){const c=n.slice(a,a+o);if(0===c.length)return void r();const h=Date.now();try{await i(t,c,n.length,a),a+=c.length,await Va({path:e,currentIndex:a})}catch(e){return void l(e)}const p=Date.now();o=s(o,p-h),d()}()}))}function ja(e,t,n,i){const s=Ia(t);i[e]||(i[e]={}),i[e][t]||(i[e][t]={folderType:s,messages:[]}),i[e][t].messages.push(n)}async function Ya(e,t,n,i){const s=(0,xa.Z)(t);let o,a=!1,r=!1;if(s.received){const e=s.received.match(/\bfor\s<(.+@.+\..+)>/);e&&(o=e[1])}if(e&&o&&e===o)a=!0;else if(e){s.from.map((e=>e.address)).includes(e)&&(r=!0);s.to.map((e=>e.address)).includes(e)&&(a=!0);s.cc.map((e=>e.address)).includes(e)&&(a=!0)}const l=s.operaStatus?function(e){const t={mappedFlags:[],otherFlags:[]},n=e.substring(34,42);if(null==n.match(/^[A-Fa-f0-9]{8}$/))return console.error("invalid flags hex value"),t;const i=parseInt(n,16);for(let e=0;e<Da.length;e++){const n=Da[e],s=i&Math.pow(2,e);s&&n[1]?t.mappedFlags.push(n[1]):s&&t.otherFlags.push(n[0])}return t}(s.operaStatus):{mappedFlags:[],otherFlags:[]};let d;if(s.operaLocation){const e=s.operaLocation.match(/^([^\s:]+):(\d+)$/);e&&(d=e[1],"inbox"===d.toLowerCase()&&(d=ue.Gf))}else l.otherFlags.includes("is_sent")&&(d=ue.N1);const c={to:s.to,from:s.from,cc:s.cc,inReplyTo:s.inReplyTo,replyTo:s.replyTo,subject:s.subject,sentDate:s.sentDate,messageId:s.messageId||"",listId:s.listId,references:s.references,flags:l.mappedFlags,internal:!0,raw:t};if(e)(a||!a&&!r)&&(await Sa(e,d||ue.Gf),await Ta(e,d||ue.Gf),ja(e,d||ue.Gf,c,n)),r&&(await Sa(e,d||ue.N1),await Ta(e,d||ue.N1),ja(e,d||ue.N1,c,n));else{i.match(/\/store\/drafts\//i)?ja(ue.of,ue.Wb,c,n):console.error("Found no fitting folder for message:",i,s.operaLocation)}}function Xa(e,t){if(!e.aliases)return t;if(!t.aliases){return{...t,aliases:e.aliases}}const n=[...t.aliases];for(const i of e.aliases)t.aliases.find((e=>e.MAIL_EMAIL===i.MAIL_EMAIL))||n.push(i);return{...t,aliases:n}}const Qa=[["read",ue.T4.SEEN],["replied",ue.T4.ANSWERED],["marked",void 0],["expunged",ue.T4.DELETED],["has_re",void 0],["elided",void 0],["unused",void 0],["offline",void 0],["watched",void 0],["sender_authed",void 0],["partial",void 0],["queued",void 0],["forwarded",ue.T4.FORWARDED],["priorities",void 0]];function qa(e){const t={mappedFlags:[],otherFlags:[]},n=e;if(null==n.match(/^[A-Fa-f0-9]{4}$/))return console.error("invalid flags hex value"),t;const i=parseInt(n,16);for(let e=0;e<Qa.length;e++){const n=Qa[e],s=i&Math.pow(2,e);s&&n[1]?t.mappedFlags.push(n[1]):s&&t.otherFlags.push(n[0])}return t}var Ja,er=n(79513);async function tr(e){const{path:t}=e;await vt.Z.importProgress.get(t)?await vt.Z.importProgress.update(t,e):await vt.Z.importProgress.add(e)}async function nr(e){return new Promise(((t,n)=>{d.Z.mailPrivate.readFileToText(e,(n=>y.Z.runtime.lastError?(de.Z.warn("Mail",["import","thunderbird"],`Error reading file ${e}`,y.Z.runtime.lastError),t("")):n?void t(n):(de.Z.warn("Mail",["import","thunderbird"],`File ${e} is empty`),t(""))))}))}async function ir(){const e=(await new Promise((e=>{d.Z.importData.getProfiles((t=>{e(t)}))}))).find((e=>"Thunderbird"===e.name));return e?e.profilePath+"/":""}async function sr(){const e=await ir(),t=await async function(e){const t=e+"profiles.ini";return function(e){const t={profile:/^\[(Profile[0-9]+)\]$/,name:/^Name\s*=\s*(.*?)$/,path:/^Path\s*=\s*(.*?)$/,isRelative:/^IsRelative\s*=\s*(0|1)$/,default:/^Default\s*=\s*(0|1)$/},n={},i=e.split(/[\r\n]+/);let s;for(const e of i){const i=e.trim();let o=t.profile.exec(i);o?(s=o[1],n[s]={name:"",path:"",isRelative:!1}):(o=t.name.exec(i),o&&s?n[s].name=o[1]:(o=t.path.exec(i),o&&s?n[s].path=o[1]:(o=t.isRelative.exec(i),o&&s?n[s].isRelative="1"===o[1]:(o=t.default.exec(i),o&&s&&(n[s].default="1"===o[1])))))}return n}(await nr(t))}(e),n=[];for(const i in t){const s=t[i];n.push(e+s.path+"/prefs.js")}return n}async function or(e){return new Promise((t=>{d.Z.mailPrivate.getFilePaths(e+"/",t)}))}async function ar(){return new Promise((e=>{wa.Z.addListener((function t(){wa.Z.removeListener(t),e()}))}))}async function rr(e){return function(e){const t={account:/^user_pref\("mail\.account\.(account[0-9]+)\.(.+)", "(.+)"\);$/,identidy:/^user_pref\("mail\.identity\.(id[0-9]+)\.(.+)", "?([^"]+)"?\);$/,server:/^user_pref\("mail\.server\.(server[0-9]+)\.(.+)", "(.+)"\);$/,smtp:/^user_pref\("mail\.smtpserver\.(smtp[0-9]+)\.(.+)", "(.+)"\);$/},n={},i=e.split(/[\r\n]+/),s=[];for(const e of i){const i=e.trim(),o=t.account.exec(i)||t.identidy.exec(i)||t.server.exec(i)||t.smtp.exec(i);o&&(n[o[1]]=n[o[1]]||{},n[o[1]][o[2]]=o[3],o[1].startsWith("account")&&s.push(o[1]))}const o={serverFolders:{},localFolders:""};for(const e of s){const{server:t,identities:i}=n[e];if(t&&i){let e;if("POP3"===n[t].type.toUpperCase())e=ue.s9.POP;else{if("IMAP"!==n[t].type.toUpperCase()){de.Z.warn("Mail",["import","thunderbird"],`Importing accounts of type "${n[t].type}" is not supported`),e=ue.s9.IMAP;continue}e=ue.s9.IMAP}const s=i.split(",").map((e=>e.trim())),a=s.filter((e=>"true"===n[e].valid));if(0===a.length){de.Z.info("Mail",["import","thunderbird"],"No valid accounts found in prefs.js file");continue}const r=a[0],l=n[r].smtpServer,d={MAIL_EMAIL:n[r].useremail,MAIL_NAME:n[r].fullName,MAIL_SERVER:n[t].hostname,MAIL_PORT:e===ue.s9.IMAP?993:995,MAIL_USER:n[t].userName,MAIL_SMTP_SERVER:l?n[l].hostname:"",MAIL_SMTP_PORT:465,MAIL_SMTP_SOCKET_TYPE:"ssl",MAIL_SMTP_USER:l?n[l].username:"",offline:!0,accountType:e,useOAuth:n[t].hasOwnProperty("oauth2.issuer")&&n[t]["oauth2.issuer"].endsWith(".google.com")};if(n[r].htmlSigText&&(d.signature=n[r].htmlSigText),a.length>1){const e=a.slice(1);for(const t of e){const{useremail:e,fullName:i,htmlSigText:s}=n[t],o={MAIL_EMAIL:e};i&&(o.MAIL_NAME=i),s&&(o.signature=s),d.aliases?d.aliases.push(o):d.aliases=[o]}}const c=n[t].directory;o.serverFolders[c]=d}else t&&(o.localFolders=n[t].directory)}return o}(await nr(e))}async function lr(e){const t=e||await sr(),n=[];for(const e of t){const{serverFolders:t}=await rr(e);for(const e in t)n.push(t[e])}return n}function dr(e){const t=[];for(const n of e)n.match(/\.(?:html|msf|dat)$/)||t.push(n);return t}function cr(e){let t="";const n=e.match(/[\\\/]([^\\\/]+)$/);if(n)return t=n[1],t.toLowerCase().match(/inbox-[0-9]+/)&&(t=t.slice(0,"inbox".length)),t.toLowerCase().match(/sent-[0-9]+/)&&(t=t.slice(0,"sent".length)),t.toLowerCase().match(/outbox-[0-9]+/)&&(t=t.slice(0,"outbox".length)),t.toLowerCase().match(/trash-[0-9]+/)&&(t=t.slice(0,"trash".length)),t.toLowerCase().match(/junk-[0-9]+/)&&(t=t.slice(0,"junk".length)),t.toLowerCase().match(/spam-[0-9]+/)&&(t=t.slice(0,"spam".length)),t.toLowerCase().match(/drafts-[0-9]+/)&&(t=t.slice(0,"drafts".length)),t.toLowerCase().match(/archive-[0-9]+/)&&(t=t.slice(0,"archive".length)),t;de.Z.warn("Mail",["import","thunderbird"],`No mbox file found in path ${e}`)}async function hr(e,t){M.Z.get(D.kMailIsTurnedOff)&&(de.Z.log("Mail",["import","thunderbird"],"Mail is turned off - turning it on for importing from Thunderbird"),nt.Z.set(D.kMailIsTurnedOff,!1),Ho.Z.showContent(e,"mail"));const n=await sr();await async function(e,t){const n=await lr(e),i=M.Z.get(D.kMailAccounts),s=n.filter((e=>t.find((t=>t.accountId===e.MAIL_EMAIL&&t.accountType===e.accountType))));for(const e of i){const t=s.find((t=>t.MAIL_EMAIL===e.MAIL_EMAIL));if(t)try{(0,Oa.Z)(Xa(t,e))}catch(n){Wo.Z.addImportError("Thunderbird","MailAccounts",(0,le.Z)("Failed updating account $1",[e.MAIL_EMAIL])),de.Z.error("Mail",["import","thunderbird"],`Failed adding alias from ${JSON.stringify(t)}`)}}const o=s.filter((e=>!i.find((t=>t.MAIL_EMAIL===e.MAIL_EMAIL))));for(let e=0;e<o.length;e++){let t=o[e];if(t.accountType===ue.s9.IMAP){const e=o.find((e=>e.MAIL_EMAIL===t.MAIL_EMAIL&&e.accountType===ue.s9.POP));if(e)try{t=Xa(e,t)}catch(n){Wo.Z.addImportError("Thunderbird","MailAccounts",(0,le.Z)("Failed updating account $1",[t.MAIL_EMAIL])),de.Z.error("Mail",["import","thunderbird"],`Failed adding alias from ${JSON.stringify(e)}`)}}else if(t.accountType===ue.s9.POP&&o.find((e=>e.MAIL_EMAIL===t.MAIL_EMAIL&&e.accountType===ue.s9.IMAP)))continue;try{await ee.Z.addAccount(t,[""]),(0,Oa.Z)(t),await ar(),de.Z.log("Mail",["import","thunderbird"],"... imported account",t.MAIL_EMAIL),Wo.Z.setImportProgress("Thunderbird","MailAccounts",1,1,t.MAIL_EMAIL)}catch(e){Wo.Z.addImportError("Thunderbird","MailAccounts",(0,le.Z)("Failed importing account $1",[t.MAIL_EMAIL])),de.Z.error("Mail",["import","thunderbird"],`Failed importing account ${JSON.stringify(t)}`)}}}(n,t);const i=[];for(const e of n){const{serverFolders:n,localFolders:s}=await rr(e);for(const e in n){de.Z.log("Mail",["import","thunderbird"],"messageFolder",e);const s=n[e].MAIL_EMAIL;if(!t.find((e=>e.accountId===s)))continue;const o=await or(e),a=dr(o);0===a.length&&de.Z.log("Mail",["import","thunderbird"],"No thunderbird mbox files found in",o);for(const e of a){let t=cr(e);if(t){const n=e.match(/[\\\/]([^\\\/]+)\.sbd[\\\/]/);n&&(t=n[1]+"/"+t),i.push({filePath:e,accountId:s,path:t})}}}if(s){const e=await or(s);0===e.length&&de.Z.log("Mail",["import","thunderbird"],"No thunderbird mbox files found in",e);const t=dr(e);for(const e of t){let t=cr(e);t&&("Unsent Messages"===t&&(t=ue.J8),i.push({filePath:e,accountId:ue.of,path:t}))}}}for(const t of i){const{filePath:n,accountId:i}=t;let s=t.path;"inbox"===s.toLowerCase()&&(s=ue.Gf);const o=(await vt.Z.importProgress.get(n))?.seekPosition||0;if(await d.Z.importData.openThunderbirdMailbox(n,o),0===o)try{const{message:e}=await pr();if(!e){de.Z.warn("Mail",["import","thunderbird"],`File does not contain messages ${n}`);continue}await d.Z.importData.openThunderbirdMailbox(n,o)}catch(e){de.Z.warn("Mail",["import","thunderbird"],`Error on checking file validity ${n}. Error: ${e}`);continue}i!==ue.of&&(await Sa(i,s),await Ta(i,s)),Wo.Z.setImportProgress("Thunderbird","MailMessages",0,-1,i+"/"+s),await ur(e,n,i,s,o),await tr({path:n,seekPosition:0})}}async function pr(){return new Promise(((e,t)=>{try{d.Z.importData.readMessageFromThunderbirdMailbox(((n,i)=>y.Z.runtime.lastError?(de.Z.warn("Mail",["import","thunderbird"],"Error reading message",y.Z.runtime.lastError),t(y.Z.runtime.lastError)):e({message:n,seekPosition:i})))}catch(e){return de.Z.warn("Mail",["import","thunderbird"],"Error reading message",y.Z.runtime.lastError),t(e)}}))}async function ur(e,t,n,i,s){async function o(){const{message:e,seekPosition:n}=await pr();if(s>-1&&-1===n&&await tr({path:t,seekPosition:s}),s=n,e.length>0){return(0,er.Z)(e)}}async function a(o,a,r){await async function(e,t,n){const i=[];for(const t of e){const e=(0,xa.Z)(t),n=e.mozillaStatus?qa(e.mozillaStatus):{mappedFlags:[],otherFlags:[]},s={to:e.to,from:e.from,cc:e.cc,inReplyTo:e.inReplyTo,replyTo:e.replyTo,subject:e.subject,sentDate:e.sentDate,messageId:e.messageId||"",listId:e.listId,references:e.references,flags:n.mappedFlags,internal:!0,raw:t};i.push(s)}await async function(e,t,n){for(const e of n){const t=(0,Ra.PW)((0,Ra.Zp)(e.raw));if(t){const{bodyParts:n,raw:i}=await Ma.Z.parse(e.raw,t.mimeTree);e.bodyParts=n,e.raw=i}}await(0,_a.Z)(e,t,n);const i=await Ea(e,t,Ia(t),n);j.Z.updateIndex(i);const{addedSles:s=[],sleUpdates:o=[]}=i,a=[];for(const t of s){const i=n.findIndex((e=>e.messageId===t.messageId&&(!e.sentDate&&!t.sentDate||e.sentDate===t.sentDate)&&e.subject===t.subject));if(-1===i)throw new Error(`Added sle not found in incoming batch, ${t.messageId}, ${t.sentDate}, ${t.subject}`);a.push(t.id);const s=n[i];await La.Z.call(e,t.sentDate,t.id,s.raw)}a.length>0&&await(0,Ba.o)(e,a);for(const t of o){const i=await(0,Na.Z)(t.id);if(!i)throw new Error("Updated sle not found in db");const s=n.findIndex((e=>e.messageId===i.messageId&&(!e.sentDate&&!i.sentDate||e.sentDate===i.sentDate)&&e.subject===i.subject));if(-1===s)console.warn(`Updated sle not found in incoming batch, ${i.messageId} ${i.sentDate} ${i.subject}`);else{const t=[e];for(const o of i.sourceFilterIds){const a=it.Z.get(o);if(!a)throw new Error(`Filter not found for filterId ${o}`);t.includes(a.accountId)||(await La.Z.call(a.accountId,i.sentDate,i.id,n[s].raw),await(0,Ba.h)(e,i.id),t.push(a.accountId))}}}ce.Z.filter(),ee.Z.updateThreads()}(t,n,i)}(o,n,i),X.Z.setStatus(e,`${n}/${i} - message: ${a}`,3e3),Wo.Z.setImportProgress("Thunderbird","MailMessages",a,r,n+"/"+i),s>-1&&await tr({path:t,seekPosition:s})}try{let e,r=[],l=0;const d=40;do{if(e=await o(),e)r.push(e),r.length===d&&(l+=d,await a(r,l,-1),r=[]);else{if(s>-1&&0===l){de.Z.warn("Mail",["import","thunderbird"],"File is not an mbox file",t,s);break}s>-1&&de.Z.warn("Mail",["import","thunderbird"],"Got an empty message",t,s)}}while(s>-1);r.length>0&&(l+=r.length,await a(r,l,l)),0===l&&Wo.Z.setImportProgress("Thunderbird","MailMessages",0,0,n+"/"+i)}catch(e){de.Z.error("Mail",["import","thunderbird"],e),Wo.Z.addImportError("Thunderbird","MailMessages",(0,le.Z)("Failed importing messages. Error: $1",[e.message||e]))}}function gr(e,t,n,i){Ja||(Ja="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Ja,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var mr=gr("br",{}),vr=gr("br",{});class fr extends tn.PureComponent{static contextType=dn.Z;#n=!1;refUserProfile=tn.createRef();constructor(e){super(e),this.state={useDefaultLocation:!0,importOptions:JSON.parse(JSON.stringify(e.profile)),selectedProfile:"",masterPassword:"",importItemStatus:(0,fa.aV)(),accountSelection:[],selectedFolder:"",selectedFile:""}}componentDidMount(){this.#n=!0,d.Z.importData.onImportItemStarted.addListener(this.onImportItemStarted),d.Z.importData.onImportItemEnded.addListener(this.onImportItemEnded),d.Z.importData.onImportItemFailed.addListener(this.onImportItemFailed),this.offerAccountSelection(this.props.profile.mailPath),this.props.setStartImport(this.startImport),this.props.setChooseFile(this.chooseFile)}componentWillUnmount(){this.#n=!1,d.Z.importData.onImportItemStarted.removeListener(this.onImportItemStarted),d.Z.importData.onImportItemEnded.removeListener(this.onImportItemEnded),d.Z.importData.onImportItemFailed.removeListener(this.onImportItemFailed)}componentDidUpdate(e){e.profile!==this.props.profile&&this.setState({importOptions:JSON.parse(JSON.stringify(this.props.profile))},(()=>{this.offerAccountSelection(this.props.profile.mailPath||ka(this.state.selectedFolder,"mail"))}))}async offerAccountSelection(e){if(this.props.profile.email){const t=(e,t)=>e.MAIL_EMAIL>t.MAIL_EMAIL?1:-1;if("Thunderbird"===this.props.profile.name){const e=(await lr()).sort(t).map((e=>({accountId:e.MAIL_EMAIL,accountType:e.accountType,selected:!0})));this.#n&&this.setState({accountSelection:e})}else this.props.profile.name.match(/^[OÓ]pera/i)?Wa(e).then((e=>{const n=e.sort(t).filter((e=>e.MAIL_EMAIL&&[ue.s9.IMAP,ue.s9.POP].includes(e.accountType)));0===n.length?this._changeSelection("email"):this._setSelection("email",!0);const i=n.map((e=>({accountId:e.MAIL_EMAIL,accountType:e.accountType,selected:!0})));this.#n&&this.setState({accountSelection:i})})):de.Z.warn("Mail",["import"],"Mail import not supported from profile",this.props.profile.name)}}onImportItemStarted=e=>{Wo.Z.setImportProgress(this.props.profile.name,e,0,0),this.setItemState(e,"IMPORT_STARTED")};onImportItemEnded=e=>{Wo.Z.setImportProgress(this.props.profile.name,e,0,0),this.setItemState(e,"IMPORT_COMPLETED")};onImportItemFailed=(e,t)=>{Wo.Z.addImportError(this.props.profile.name,e,t),this.setItemState(e,"IMPORT_FAILED",t)};setItemState(e,t,n){this.#n&&this.setState((i=>{let s=i.importItemStatus;const o=s.filter((t=>t.itemName===e)).first(),a={itemName:e,state:t,errorMsg:n};return s=o?s.map((t=>t.itemName===e?"IMPORT_FAILED"===t.state?t:{...a}:t)):s.push(a),{importItemStatus:s}}))}onStartImport=()=>{this.startImport()};startImport=async()=>{if(va.isImportTypeInProgress(this.props.profile.name))return void(0,Ct.c)({title:(0,le.Z)("Import for this profile is currently running")});const e=this.state.importOptions,t=e.history,n=e.favorites,i=e.passwords,s=e.search,o=e.notes,a=e.speeddial,r=e.email,l=e.hasDefaultInstall&&this.state.useDefaultLocation,c=""===this.state.selectedProfile?this.refUserProfile.current?.value??"":this.state.selectedProfile,h=[this.props.index.toString(),t.toString(),n.toString(),i.toString(),s.toString(),o.toString(),l.toString(),c.toString(),a.toString()];let p=e.profilePath,u=e.mailPath;e.hasDefaultInstall&&this.state.useDefaultLocation||(p=this.state.selectedFolder||this.state.selectedFile,u=ka(p,"mail")),p?(p.endsWith("operaprefs.ini")&&(p=p.substring(0,p.indexOf("operaprefs.ini"))),d.Z.importData.startImport(h,this.state.masterPassword,p,(()=>{if(r){const t=this.state.accountSelection.filter((e=>e.selected));if(this.setItemState("email","IMPORT_STARTED"),e.name.match(/^[OÓ]pera/i))Ha(this.context.vivaldiWindowId,p,u,this.props.profile.name,t).then((()=>{this.setItemState("email","IMPORT_COMPLETED")}));else{if("Thunderbird"!==e.name)throw new Error("Unsupported mail client");hr(this.context.vivaldiWindowId,t).then((()=>{this.setItemState("email","IMPORT_COMPLETED")}))}}}))):(0,Ct.c)({title:(0,le.Z)("Import source not specified!")})};openFile=async e=>new Promise(((t,n)=>{y.Z.fileSystem.chooseEntry({type:"openFile",accepts:[{mimeTypes:["text/*"],extensions:e,description:(0,le.Z)("files of type $1",[e])}]},(e=>{y.Z.runtime.lastError||!e?n(y.Z.runtime.lastError||"Cancelled opening file"):t(e)}))}));openFolder=async()=>new Promise(((e,t)=>{y.Z.fileSystem.chooseEntry({type:"openDirectory"},(n=>{y.Z.runtime.lastError||!n?t(y.Z.runtime.lastError||"Cancelled opening folder"):e(n)}))}));chooseFile=async()=>{const e=await this.openFile(["html"]),t=await d.Z.mailPrivate.getFullPath(e.filesystem.name,e.fullPath);this.setState({selectedFile:t},this.startImport)};chooseFolder=async()=>{const e=await this.openFolder(),t=await d.Z.mailPrivate.getFullPath(e.filesystem.name,e.fullPath);this.setState({selectedFolder:t},(()=>this.offerAccountSelection(ka(t,"mail"))))};handlePasswordChange=e=>{e.target instanceof HTMLInputElement&&this.setState({masterPassword:e.target.value.toString()})};handleUserProfileChange=e=>{e.target instanceof HTMLSelectElement&&this.setState({selectedProfile:e.target.value})};_toggleDefault(){this.setState((e=>({useDefaultLocation:!e.useDefaultLocation})),(()=>{this.state.useDefaultLocation?this.offerAccountSelection(this.props.profile.mailPath):this.offerAccountSelection(ka(this.state.selectedFolder,"mail"))}))}_changeSelection(e){this.setState((t=>{const n={...t.importOptions},i=t.accountSelection.slice();if("email"===e){const t=i.filter((e=>e.selected));n[e]||0!==t.length?n[e]&&i.forEach((e=>e.selected=!1)):n.profilePath||n.mailPath?i.forEach((e=>e.selected=!0)):this.chooseFolder()}return n[e]=!n[e],{accountSelection:i,importOptions:n}}))}_setSelection(e,t){this.setState((n=>{const i={...n.importOptions};return i[e]=t,{importOptions:i}}))}_getImportItemMarkup(e,t,n,i,s){return gr("div",{className:"setting-single"},void 0,gr("div",{className:"import-setting"},void 0,gr("input",{id:t,type:"checkbox",checked:i,onChange:this._changeSelection.bind(this,e),disabled:s}),gr("label",{htmlFor:t},void 0,n)))}_onAccountSelection=e=>{this.setState((t=>{const n={...t.importOptions},i=t.accountSelection.filter((e=>e.selected));return 1===i.length&&!0===e.selected?n.email=!1:0===i.length&&!1===e.selected&&(n.email=!0),{importOptions:n,accountSelection:t.accountSelection.map((t=>(t.accountId===e.accountId&&t.accountType===e.accountType&&(t.selected=!t.selected),t)))}}))};render(){const e=this.props.profile,t=this.state.importOptions;if(t){const n=Boolean(!(t.passwords||t.history||t.notes||t.search||t.speeddial||t.email));let i;return e&&e.UserProfiles&&e.UserProfiles.length>0&&(i=e.UserProfiles.map((e=>gr("option",{value:e.profileName},e.profileName,e.profileDisplayName)))),(0,fn.jsxs)(fn.Fragment,{children:[gr("fieldset",{},void 0,i&&gr("div",{className:"profile"},void 0,gr("label",{htmlFor:"userProfile"},void 0,(0,le.Z)("Chrome User Profile")),(0,fn.jsx)("select",{ref:this.refUserProfile,id:"userProfile",onChange:this.handleUserProfileChange,value:this.state.selectedProfile,children:i})),e&&e.favorites&&this._getImportItemMarkup("favorites","f-favorites",(0,le.Z)("Bookmarks"),!!t&&t.favorites,n),e.passwords&&this._getImportItemMarkup("passwords","f-passwords",(0,le.Z)("Passwords"),!!t&&t.passwords,!1),e.supportsMasterPassword&&gr("div",{className:"setting-single import-masterpassword"},void 0,gr("label",{htmlFor:"f-masterpassword"},void 0,(0,le.Z)("Master password, if needed:")),gr("input",{id:"f_masterpassword",type:"password",onChange:this.handlePasswordChange})),e.history&&this._getImportItemMarkup("history","f-history",(0,le.Z)("History"),!!t&&t.history,!1),e.notes&&this._getImportItemMarkup("notes","f-notes",(0,le.Z)("Notes"),!!t&&t.notes,!1),e.search&&this._getImportItemMarkup("search","f-search",(0,le.Z)("Search Engines"),!!t&&t.search,!1),e.speeddial&&this._getImportItemMarkup("speeddial","f-speeddial",(0,le.Z)("Speed Dial"),!!t&&t.speeddial,!1),e.email&&this._getImportItemMarkup("email","f-email",(0,le.Z)("Mail"),!!t&&t.email,!1),e.email&&gr("div",{className:"import-mail-account"},void 0,this.state.accountSelection.map((e=>{const{accountId:t,accountType:n,selected:i}=e;return gr("div",{className:"imported-email"},t+n,gr("input",{id:t+n,type:"checkbox",checked:i,onChange:()=>this._onAccountSelection(e)}),gr("label",{htmlFor:t+n},void 0,t," ",n))}))),e&&e.supportsStandaloneImport&&e.hasDefaultInstall&&gr("div",{className:"setting-single"},void 0,gr("input",{id:"f-location",type:"checkbox",checked:this.state.useDefaultLocation&&e.hasDefaultInstall,onChange:this._toggleDefault.bind(this),disabled:!1===e.hasDefaultInstall}),gr("label",{htmlFor:"f-location"},void 0,(0,le.Z)("Use Default Profile Location")))),e&&e.hasDefaultInstall&&this.state.useDefaultLocation&&e.profilePath.length>0&&gr("div",{className:"import-pathname"},void 0,(0,le.Z)("Detected Profile Path:"),mr,gr("input",{type:"text",value:e.profilePath,readOnly:!0})),e?.supportsStandaloneImport&&(!e?.hasDefaultInstall||!this.state.useDefaultLocation)&&(0,fn.jsxs)(fn.Fragment,{children:[gr("div",{className:"import-pathname"},void 0,(0,le.Z)("Selected Profile Path:"),vr,gr("input",{type:"text",value:this.state.selectedFolder||(0,le.Z)("No folder selected"),readOnly:!0})),gr("div",{},void 0,gr("input",{type:"button",className:"primary",onClick:this.chooseFolder,value:(0,le.Z)("Choose a Folder...")}))]})]})}return null}}const yr=fr;var wr;function br(e,t,n,i){wr||(wr="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:wr,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Cr(e){switch(e){case"error":return cn.viW;case"warning":return cn.h6;case"success":return cn.JLz;default:return cn.GH$}}class Sr extends tn.Component{_refFeedback=tn.createRef();componentDidMount(){this._refFeedback.current?.scrollIntoViewIfNeeded()}componentDidUpdate(){this._refFeedback.current?.scrollIntoViewIfNeeded()}render(){const{type:e="info",children:t}=this.props;return(0,fn.jsxs)("div",{ref:this._refFeedback,className:`FormFeedback FormFeedback--${e}`,children:[br("span",{className:"FormFeedback-Icon",dangerouslySetInnerHTML:{__html:Cr(e)}}),t]})}}const Tr=Sr,Ir={mixedToStrings:e=>e.map((function(e){return"string"==typeof e?e:Array.isArray(e)?`[${Ir.mixedToStrings(e).join(", ")}]`:e instanceof Error?`Error: ${e.message}`:void 0}))},kr=Ir;var Ar,Zr=n(90808);function Er(e,t,n,i){Ar||(Ar="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Ar,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const{mixedToStrings:_r}=kr;class Nr extends tn.PureComponent{#n=!1;constructor(e){super(e),this.state={progress:va.getImportProgress()}}componentDidMount(){this.#n=!0,va.addListener(this.onProgress)}componentWillUnmount(){this.#n=!1,va.removeListener(this.onProgress)}onProgress=(0,Zr.Z)((()=>{this.#n&&this.setState({progress:va.getImportProgress()})}),300,{leading:!0});_getImportItemStatus(e){return e.errors?Er("div",{className:"import-result"},void 0,Er(Tr,{type:"error"},void 0,_r(e.errors))):!e.children&&-1!==e.total&&e.current>=e.total?Er("div",{className:"import-result"},void 0,Er("div",{className:e.warnings?"import-warning":"import-success",title:e.warnings},void 0,Er("span",{className:"status-icon",dangerouslySetInnerHTML:{__html:n(75124)}}),(0,le.Z)("other","Done"))):!e.children&&(e.total>1||-1===e.total)?Er("div",{className:"import-result numbers"},void 0,Er("div",{className:e.warnings?"import-warning":"import-success",title:e.warnings},void 0,e.current+(e.total>1?"/"+e.total:""))):void 0}renderItem=(e,t)=>Er("div",{className:"setting-single import-status-table"},e,Er("span",{},void 0,e),this._getImportItemStatus(t));renderIndentedItem=(e,t)=>Er("div",{className:"setting-single import-mail-account imported-email import-status-table"},e,Er("span",{},void 0,e),this._getImportItemStatus(t));renderItems=e=>{const t=[];t.push(Er("header",{},e,Er("h4",{className:"dialog-title"},void 0,e)));for(const n in this.state.progress[e]){const i=this.state.progress[e][n];if(t.push(this.renderItem(n,i)),i.children)for(const e in i.children){const n=i.children[e];t.push(this.renderIndentedItem(e,n))}}return t};renderTypes=e=>{const t=[];for(const n of e)t.push(Er("div",{className:"import-data"},n,Er("div",{className:"imported-data"},void 0,this.renderItems(n))));return t};numImportsToReport=()=>Object.keys(this.state.progress).length;render(){const e=this.numImportsToReport(),t=Object.keys(this.state.progress);return 0===e?null:Er("div",{className:"import-container"},void 0,this.renderTypes(t))}}const Mr=Nr;var Pr=n(65792),Dr=n.n(Pr),xr=n(721);const Or=e=>{const{draggable:t}=e;return t?{draggable:e.draggable,onDragStart:e.onDragStart,onDragLeave:e.onDragLeave,onDragEnter:e.onDragEnter,onDragOver:e.onDragOver,onDragEnd:e.onDragEnd,onDrop:e.onDrop}:{}},Lr=e=>{const{ctrlKey:t,altKey:n,shiftKey:i,metaKey:s}=e,o={ctrlKey:t,altKey:n,shiftKey:i,metaKey:s};return(0,xr.mT)(o)};function Rr(e,t,n){const i=e.clientX-t.left,s=e.clientY-t.top;let o=.5;void 0!==n&&n>=0&&n<=.5&&(o=n);const a=i<t.width*o,r=i>t.width*(1-o),l=s<t.height*o,d=s>t.height*(1-o);return{horizontal:a?"left":r?"right":"center",vertical:l?"top":d?"bottom":"center"}}function Br(e){return(0,tn.forwardRef)(((t,n)=>{const i=(0,tn.useRef)(null),s=n||i,[{buttonClasses:o,draggable:a,dragging:r,setVerticalPosition:l,setHorizontalPosition:d,dragOver:c,verticalPosition:h,horizontalPosition:p},{onDragStart:u,onDragEnd:g,onDragEnter:m,limitToDrag:v,onDrop:f,pointerEnter:y,onDragLeave:w,onDragOver:b}]=function(e){const t=(0,tn.useRef)(new Image),[n,i]=(0,tn.useState)(!1),[s,o]=(0,tn.useState)(!1),[a,r]=(0,tn.useState)(null),[l,d]=(0,tn.useState)(null),{draggable:c,onDragStart:h,onDragEnd:p,onDragEnter:u,onPointerEnter:g,onDrop:m,mimeType:v,dragImage:f,image:y,imagePath:w,isOn:b,isPressed:C,isPopupVisible:S,title:T,name:I,edgeAmount:k}=e,A=(0,tn.useCallback)((e=>{const n=P.Z.getBaseStyles(["colorHighlightBg"]),i=n["--colorHighlightBg"]?String(n["--colorHighlightBg"]):"#0089fa",{dragImage:s,image:o,name:a,title:r}=e;s||o||(t.current.src="");const l=document.createElement("canvas"),d=new Image;d.onerror=e=>{e.target.src||console.log(`Image for ${a||r||"unnamed button"} not loaded`,e.type)},d.onload=()=>{const e=32,n=l.getContext("2d");if(l.width=e,l.height=e,n.fillStyle=i,n.fillRect(0,0,e,e),s)n.drawImage(d,4,4,24,24);else{const t=Dr()(i).luminance()<.4;t&&(n.fillStyle="white",n.globalCompositeOperation="difference",n.fillRect(0,0,e,e)),n.globalCompositeOperation="multiply",n.drawImage(d,4,4,24,24),t&&(n.globalCompositeOperation="difference",n.fillRect(0,0,e,e))}n.beginPath(),n.moveTo(16,0),n.bezierCurveTo(0,0,0,0,0,16),n.bezierCurveTo(0,e,0,e,16,e),n.bezierCurveTo(e,e,e,e,e,16),n.bezierCurveTo(e,0,e,0,16,0),n.rect(0,0,e,e),n.closePath(),n.clip(),n.clearRect(0,0,e,e),t.current.src=l.toDataURL()},s?d.src=s:o&&(d.src="data:image/svg+xml;charset=utf-8,"+o)}),[]),Z=(0,tn.useCallback)((e=>{h&&h(e),e.persist(),c?(e.dataTransfer.dropEffect="move",t.current.src&&e.dataTransfer.setDragImage(t.current,0,0),v&&I&&(e.dataTransfer.setData(v,I),e.dataTransfer.setData("text/plain","")),i(!0)):e.preventDefault()}),[c,h,v,I]),E=(0,tn.useCallback)((e=>{e.persist(),p?.(e),i(!1),o(!1),d(null),r(null)}),[p]),_=(0,tn.useCallback)((()=>{o(!0),u&&u()}),[u]),N=(0,tn.useCallback)((e=>{if(e.dataTransfer.types.includes(v)){const t=e.currentTarget.getBoundingClientRect();e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="move";const{horizontal:n,vertical:i}=Rr(e,t,k);r(i),d(n)}}),[v,k]),M=(0,tn.useCallback)((e=>{const t=e.currentTarget.getBoundingClientRect(),{horizontal:n,vertical:s}=Rr(e,t,k);if(i(!1),o(!1),d(null),r(null),e.persist(),!e.dataTransfer.types.includes(v))return e.preventDefault(),void e.stopPropagation();m?.(e,n,s)}),[m,v,k]),D=(0,tn.useCallback)((e=>{c||e.preventDefault()}),[c]),x=(0,tn.useCallback)((e=>{o(!1),d(null),r(null)}),[]),O=(0,tn.useCallback)((e=>{e.persist(),t.current.src||A({dragImage:f,image:y,name:I,title:T}),g?.(e)}),[g,A,f,y,I,T]);return[{buttonClasses:(()=>{const e="center"===a&&"center"===l;return mn()({"button-on":b,"button-textonly":!y&&!w,"button-pressed":C||S,"button-dragged":n,"button-dragover":s,"button-dragover-top":"top"===a,"button-dragover-bottom":"bottom"===a,"button-dragover-center":e,"button-dragover-left":"left"===l,"button-dragover-right":"right"===l})})(),draggable:c&&Boolean(Z&&e.mimeType),dragging:n,dragOver:s,setVerticalPosition:r,setHorizontalPosition:d,verticalPosition:a,horizontalPosition:l},{onDragStart:Z,onDragEnd:E,limitToDrag:D,onDragEnter:_,onDrop:M,pointerEnter:O,onDragLeave:x,onDragOver:N}]}(t);return(0,fn.jsx)(e,{...t,ref:s,dragging:r,draggable:a,onDragStart:u,onDragEnd:g,onDragEnter:m,dragOver:c,limitToDrag:v,onDragLeave:w,onPointerEnter:y,onDragOver:b,onDrop:f,buttonClasses:o,setVerticalPosition:l,setHorizontalPosition:d,verticalPosition:h,horizontalPosition:p})}))}var Fr,Ur=n(73935),Vr=n(52250),Wr=n(29697);function Hr(e,t,n,i){Fr||(Fr="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Fr,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function zr(e,t,n,i){if(!i)return{};const s={};return"above"===t?s.bottom=Math.round(i.height-n.top-i.top+3)+"px":s.top=Math.round(n.bottom-i.top+3)+"px","left"===e?s.right=Math.round(Math.max(i.right-n.right,3))+"px":s.left="right"===e?Math.round(Math.max(n.left,3))+"px":Math.round(n.left+n.width/2)+"px",s}class Gr extends tn.PureComponent{static contextType=dn.Z;nodeRef=tn.createRef();refResizeHandle=tn.createRef();state={height:this.props.height??400,originalHeight:this.props.height??400,originalY:0,originalMouseY:0};constructor(e,t){super(e),this.portalContainer=t.document.getElementById("browser")}componentDidMount(){this.context.addEventListener("resize",this.onWindowResize,!1),this.intersectionObserver=new IntersectionObserver(this.onIntersect,{root:this.portalContainer}),this.intersectionObserver.observe(this.props.buttonRef),this.props.isResizable&&(this.context.addEventListener("pointerup",this.stopResize,!0),this.context.addEventListener("pointercancel",this.stopResize,!0),this.refResizeHandle.current?.addEventListener("pointerdown",this.startResize,!0))}onIntersect=e=>{e[0].intersectionRatio<=0&&this.props.hidePopup()};componentDidUpdate(e){this.props.buttonRef!==e.buttonRef&&(this.intersectionObserver.disconnect(),this.intersectionObserver.observe(this.props.buttonRef))}componentWillUnmount(){this.context.removeEventListener("resize",this.onWindowResize,!1),this.context.removeEventListener("pointerup",this.stopResize,!0),this.context.removeEventListener("pointercancel",this.stopResize,!0),this.refResizeHandle.current?.removeEventListener("pointerdown",this.startResize,!0),this.intersectionObserver.disconnect()}getNode(){return this.nodeRef.current?.focusRef.current}onWindowResize=()=>{this.forceUpdate()};getEdgeMargin=e=>{let t=Number.MAX_SAFE_INTEGER;const n=this.props.buttonRef.getBoundingClientRect();return"right"===e?t=n.left:"left"===e&&(t=this.context.innerWidth-n.right),t<=3?3-t:0};handleClickOutside=e=>{this.props.hidePopup()};keyDown=e=>{e.keyCode===qi.Z.KEY_ESCAPE&&(this.props.hidePopup(),e.preventDefault(),e.stopPropagation())};resize=e=>{const{originalHeight:t,originalMouseY:n}=this.state,i="above"===this.props.verticalPosition?t-(e.pageY-n):t+(e.pageY-n);e.buttons?i>=100&&this.context.window.requestAnimationFrame((()=>{this.setState({height:i})})):this.stopResize(e)};stopResize=e=>{e.target.releasePointerCapture(e.pointerId),vn.Z.setWebviewPointerEvents(!0,this.context.document),e.target.removeEventListener("pointermove",this.resize,!0),this.props.height!==this.state.height&&this.props.onResize?.(this.state.height)};startResize=e=>{const t=this.getNode();t&&e.button===vn.Z.kLeft&&(e.preventDefault(),this.setState({originalHeight:parseFloat(getComputedStyle(t).getPropertyValue("height").replace("px","")),originalY:t.getBoundingClientRect().top,originalMouseY:e.pageY}),e.target.setPointerCapture(event.pointerId),vn.Z.setWebviewPointerEvents(!1,this.context.document),e.target.addEventListener("pointermove",this.resize,!0))};render(){const e=z.ZP.getVisibleUI(this.context.vivaldiWindowId).addressBar,t=Boolean(this.props.buttonRef.closest(".toolbar-mainbar")),n=e||!t,{popupClassName:i,hasLightArrow:s,verticalPosition:o}=this.props,a=this.props.buttonRef.getBoundingClientRect(),r=this.props.width||200,l=this.context.document.body?.getBoundingClientRect(),d=function(e,t,n,i){if(!n)return"center";const s=n.right,o=t.left-n.left,a=s-t.right,r=e/2<o+t.width/2-3,l=e/2<a+t.width/2-3,d=e+t.width<a,c=e+t.width<o;if(r&&l){if("left"===i&&d)return"right";if("right"===i&&c)return"left"}else{if(c)return"left";if(d)return"right"}return"center"}(r,a,l,this.props.anchorPosition);let c={"--popupWidth":Math.round(r)+"px","--buttonWidth":Math.round(a.width)+"px","--buttonHeight":Math.round(a.height)+"px","--edgeMargin":Math.round(this.getEdgeMargin(d))+"px"};this.props.isResizable&&(c["--popupHeight"]=Math.round(this.state.height)+"px"),n&&(c={...c,...zr(d,o,a,l)});const h=Hr(Wr.Z,{classNames:"button-popup",in:!0,mountOnEnter:!0,unmountOnExit:!0,timeout:{enter:300,exit:150}},void 0,(0,fn.jsxs)(vs.Z,{ref:this.nodeRef,focusName:"focus-popup-area",forceTrap:!0,onKeyDown:this.keyDown,style:c,className:mn()(i,"button-popup",`button-popup-${d}`,`button-popup-${o}`,"button-popup-arrow-"+(s?"light":"dark")),children:[this.props.children,this.props.isResizable&&(0,fn.jsx)("div",{ref:this.refResizeHandle,className:mn()("resize",`resize-${o}`)})]}));return this.portalContainer&&n?Ur.createPortal(h,this.portalContainer):h}}const $r=(0,Vr.Z)(Gr);class Kr extends Z.Z{getInitialState(){return""}reduce(e,t){switch(t.actionType){case"TOOLBAR_EDIT_MODE":return t.toolbar;case"TOOLBAR_STOP_EDIT_MODE":return"";default:return e}}}const jr=new Kr;var Yr,Xr=n(62830),Qr=n.n(Xr),qr=n(34155);function Jr(e,t,n,i){Yr||(Yr="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Yr,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const el=["mousedown","pointerdown","touchstart"],tl=n(39135),nl=[D.kKeyboardTabToAll,D.kMailCountersPanelUnseenEnabled,D.kToolbarButtonPopupSizes];class il extends tn.Component{static contextType=dn.Z;nodeRef=tn.createRef();uuid=Qr()();setButtonRef=e=>{this.buttonRef=e,this.buttonRef&&this.props.isPopupVisible&&this.forceUpdate()};state={isMenuVisible:!1};componentWillUnmount(){this.context.removeEventListener("pointerup",this.pointerUp,!0)}hasMenu(){return Boolean(this.props.menu)}getContextMenuHandler=e=>this.hasMenu()||Boolean(this.props.customizeMenu)?this.showCustomizeMenu(e,e.target):null;showMenu=async e=>{if(this.props.dragging)return;if(!this.props.menuOrigin)return void console.warn("ToolbarButton: showMenu called without menuOrigin");let t;const n=e||this.buttonRef;if(this.props.menu){const e=this.props.menu();t=Array.isArray(e)?e:await e}else t=[];this.props.customizeMenu&&(t=t.concat(this.props.customizeMenu)),0!==t.length?(this.context.removeEventListener("pointerup",this.pointerUp,!0),(0,zi.Z)(this.context.vivaldiWindowId,t,this.menuVisibilityChanged,this.props.menuOrigin,n||void 0)()):console.warn("ToolbarButton: showMenu called without a menu")};showCustomizeMenu=async(e,t)=>{if(this.props.disabled&&!this.props.alwaysMenu)return;let n;if(e.persist(),e.preventDefault(),e.stopPropagation(),this.props.menu){const e=this.props.menu();n=Array.isArray(e)?e:await e}else n=[];this.props.customizeMenu&&(n=n.concat(this.props.customizeMenu)),(0,zi.Z)(this.context.vivaldiWindowId,n,this.menuVisibilityChanged)(e)};getRect=()=>this.buttonRef?.getBoundingClientRect();hidePopup=async()=>{this.props.hidePopup?.()};onBlur=e=>{this.props.onBlur?.(e)};onFocus=async e=>{e.persist(),this.props.onFocus?.(e)};onDragStart=e=>{this.props.onDragStart?.(e),clearTimeout(this.menuTimer)};pointerLeave=e=>{clearTimeout(this.menuTimer),this.props.onPointerLeave&&this.props.onPointerLeave(e)};menuVisibilityChanged=e=>{e?this.setState({isMenuVisible:!0}):qr.nextTick((()=>{this.setState({isMenuVisible:!1})}))};onMenuIndicator=e=>{const{parentElement:t}=e.target;""===jr.getState()&&!Lr(e)&&t instanceof this.context.HTMLElement&&(e.preventDefault(),e.stopPropagation()),this.state.isMenuVisible||setTimeout((()=>this.showMenu(t)),90)};pointerDown=e=>{const t=Date.now(),n=""===jr.getState();if(this.pointerTimestamp&&t-this.pointerTimestamp<150)e.preventDefault();else if(e.persist(),!n||Lr(e)||e.button!==vn.Z.kLeft||"function"!=typeof this.props.onPointerDown){if(n){const n=e.currentTarget;let i=!0;!Lr(e)&&e.preventDefault(),e.button===vn.Z.kLeft&&this.hasMenu()?this.props.onClick?this.menuTimer=setTimeout((()=>this.showMenu(n)),650):this.state.isMenuVisible&&(i=!1):e.button===vn.Z.kRight&&(this.hasMenu()||this.props.customizeMenu)&&(e.stopPropagation(),i=!1),i&&(this.pointerTimestamp=t,this.context.addEventListener("pointerup",this.pointerUp,!0))}}else this.props.onPointerDown(e)};pointerUp=e=>{this.context.removeEventListener("pointerup",this.pointerUp,!0),clearTimeout(this.menuTimer);const t=this.buttonRef;if(t&&(e.target===t||e.target===t.parentElement)){const t="ctrlCmd"===this.props.modifier?e.ctrlKey:e.shiftKey;if(e.button===vn.Z.kCenter||t)e.preventDefault(),e.stopPropagation(),this.props.onMiddleClick&&this.props.onMiddleClick(e);else if(e.button===vn.Z.kLeft){const t=Date.now()-this.pointerTimestamp;this.props.onClick&&("mouse"===e.pointerType||t<650)?this.props.onClick(e):this.hasMenu()&&(e.preventDefault(),e.stopPropagation(),e.target instanceof this.context.HTMLElement&&this.showMenu(e.target))}}};onAuxClick=e=>{e.button===vn.Z.kCenter&&(e.preventDefault(),e.stopPropagation())};keyDown=e=>{if(clearTimeout(this.menuTimer),this.hasMenu()){const t=e.keyCode;(t===qi.Z.KEY_DOWN&&"bottom"===this.props.menuOrigin||t===qi.Z.KEY_UP&&"top"===this.props.menuOrigin)&&(this.showMenu(e.currentTarget),e.preventDefault(),e.stopPropagation())}else this.props.onKeyDown&&this.props.onKeyDown(e)};keyUp=e=>{const t=e.keyCode;t!==qi.Z.KEY_SPACE&&t!==qi.Z.KEY_ENTER&&t!==qi.Z.KEY_RETURN||(this.props.onClick?this.props.onClick(e):this.hasMenu()&&(e.preventDefault(),e.stopPropagation(),this.showMenu(e.currentTarget)))};onDoubleClick=e=>{e.stopPropagation()};handleResize=e=>{if(!this.props.id)return;const t=this.props.prefValues[D.kToolbarButtonPopupSizes]??{};nt.Z.set(D.kToolbarButtonPopupSizes,{...t,[this.props.id]:Math.round(e)})};render(){const{disabled:e,buttonClasses:t,faviconPath:n=null,image:i=null,imagePath:s=null,title:o=null,style:a,buttonStyle:r,tabIndex:l,badgeText:d=null,isMenuIndicatorVisible:c=!1,isMenuIndicatorDisabled:h=!1,isPopupVisible:p=!1,hidePopup:u,popupPosition:g,draggable:m,tooltip:v,children:f=null,limitToDrag:y,onDragEnd:w,onPointerEnter:b,onDragEnter:C,onDragOver:S,onDragLeave:T,onDrop:I,prefValues:k,name:A,autoFocus:Z}=this.props,E="number"==typeof l?l:k[D.kKeyboardTabToAll],_=I&&C,N=100*(this.props.progress??0),M=this.props.prefValues[D.kToolbarButtonPopupSizes]??{},P=this.props.isPopupResizable&&this.props.id?M[this.props.id]:void 0;if(!o&&!this.props.tooltip)return console.warn("Button hidden due to missing title and tooltip"),null;const x=[this.uuid,this.props.outsideClickIgnoreClass||""];return(0,fn.jsxs)("div",{ref:this.nodeRef,className:mn()("button-toolbar",this.props.className,{[this.uuid]:f,"button-menu":c}),onContextMenu:e?this.getContextMenuHandler:null,onPointerEnter:e?b:null,style:a,onPointerDown:e&&m?y:null,title:e?v?.trim()||o:null,...Or({draggable:m,onDragStart:e&&m?this.onDragStart:null,onDragEnd:m?w:null,onDragEnter:_?C:null,onDragOver:_?S:null,onDragLeave:_?T:null,onDrop:_?I:null}),children:[(0,fn.jsxs)("button",{name:A,ref:this.setButtonRef,name:this.props.name,disabled:e,draggable:!e&&m,onDragStart:!e&&m?this.onDragStart:null,tabIndex:0!==E?E:null,onKeyDown:this.keyDown,onKeyUp:this.keyUp,onPointerDown:this.pointerDown,onAuxClick:this.onAuxClick,autoFocus:Z,onPointerEnter:b,onPointerLeave:this.pointerLeave,onDoubleClick:this.onDoubleClick,onContextMenu:this.getContextMenuHandler,onBlur:this.onBlur,onFocus:this.onFocus,style:r||null,title:e?null:v?.trim()||o,type:"button",className:mn()("ToolbarButton-Button",t),children:[!s&&!n&&i&&Jr("span",{dangerouslySetInnerHTML:{__html:i}}),!s&&n&&Jr(Oi,{url:n,loadType:"faviconFromCache"}),s&&Jr("img",{src:s,alt:""}),(i||s||n)&&d&&Jr("span",{className:"button-badge"},void 0,d),o&&Jr("span",{className:"button-title"},void 0,o),c&&Jr("span",{className:mn()("button-toolbar-menu-indicator",{disabled:this.state.isMenuVisible||h}),onPointerDown:this.onMenuIndicator,dangerouslySetInnerHTML:{__html:tl}}),!i&&!s&&!n&&d&&Jr("span",{className:"button-badge"},void 0,d)]}),N>0&&N<100&&Jr("div",{className:"progress"},void 0,Jr("div",{className:"loaded",style:{width:`${N}%`}})),p&&f&&u&&g&&this.buttonRef&&Jr($r,{eventTypes:el,outsideClickIgnoreClass:x,hasLightArrow:this.props.hasLightArrow,hidePopup:this.hidePopup,verticalPosition:g,className:this.props.className,buttonRef:this.buttonRef,width:this.props.popupWidth,popupClassName:this.props.popupClassName,anchorPosition:this.props.popupAnchor,isResizable:Boolean(this.props.isPopupResizable),height:P,onResize:this.handleResize},void 0,f)]})}}const sl=(0,fs.Z)(Br(il),nl);var ol;function al(e,t,n,i){ol||(ol="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:ol,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var rl=al("div",{className:"import-data"},void 0,al(Mr,{}));class ll extends tn.PureComponent{#n=!1;constructor(e){super(e),this.state={offerings:{profiles:[]},selectedIndex:0,selectedPane:M.Z.get(D.kMailImportSelectedPane),numImportsInStore:0,startImport:()=>{},chooseFile:()=>Promise.resolve(),isReadyToStart:!1}}componentDidMount(){this.#n=!0,d.Z.importData.getProfiles((e=>{if(this.#n){const t=va.numImportsInStore();this.setState((n=>({offerings:{...n.offerings,profiles:e},numImportsInStore:t,selectedPane:0===t?"import":n.selectedPane})))}})),va.addListener(this.onProgress)}getProfileName=()=>this.state.selectedIndex<this.state.offerings.profiles.length?this.state.offerings.profiles[this.state.selectedIndex].name:"Feeds";componentWillUnmount(){this.#n=!1,va.removeListener(this.onProgress)}onImportItemStarted=e=>{Wo.Z.setImportProgress(this.getProfileName(),e,0,0)};onImportItemEnded=e=>{Wo.Z.setImportProgress(this.getProfileName(),e,1,1)};onImportItemFailed=(e,t)=>{Wo.Z.addImportError(this.getProfileName(),e,t)};onImportStarted=()=>{d.Z.importData.onImportItemStarted.addListener(this.onImportItemStarted),d.Z.importData.onImportItemEnded.addListener(this.onImportItemEnded),d.Z.importData.onImportItemFailed.addListener(this.onImportItemFailed),d.Z.importData.onImportEnded.addListener(this.onImportEnded),d.Z.importData.onImportStarted.removeListener(this.onImportStarted),this.setState({selectedPane:"status",numImportsInStore:va.numImportsInStore()})};onImportEnded=e=>{d.Z.importData.onImportItemStarted.removeListener(this.onImportItemStarted),d.Z.importData.onImportItemEnded.removeListener(this.onImportItemEnded),d.Z.importData.onImportItemFailed.removeListener(this.onImportItemFailed),d.Z.importData.onImportEnded.removeListener(this.onImportEnded),this.setState({numImportsInStore:va.numImportsInStore()})};onProgress=()=>{const e=va.numImportsInStore();e!==this.state.numImportsInStore&&this.setState({numImportsInStore:e})};handleSelectionChange(e){if(e.target instanceof HTMLSelectElement){const t=parseInt(e.target.value,10);this.setState({selectedIndex:t})}}setStartImport=e=>{this.#n&&this.setState({startImport:()=>{e().then((()=>{this.onImportStarted()}))}})};setChooseFile=e=>{this.#n&&this.setState({chooseFile:e})};readyToStart=e=>{this.setState({isReadyToStart:e})};renderImportFooter(){const{selectedIndex:e}=this.state,t=e<this.state.offerings.profiles.length?this.state.offerings.profiles[e]:void 0,n=e===this.state.offerings.profiles.length+2,i=t?.hasDefaultInstall||t?.supportsStandaloneImport||"none"===t?.willShowDialogType,s=!t||"file"===t.willShowDialogType&&"Safari"!==t.name;return i||this.state.isReadyToStart||n?al("footer",{className:"dialog-footer"},void 0,al("input",{type:"button",className:"primary",onClick:this.state.startImport,value:(0,le.Z)("Start Import")}),al("input",{type:"button",onClick:this.props.onClose,value:(0,le.Z)("Close")})):s?al("footer",{className:"dialog-footer"},void 0,al("input",{type:"button",className:"primary",onClick:this.state.chooseFile,value:(0,le.Z)("Choose a File...")}),al("input",{type:"button",onClick:this.props.onClose,value:(0,le.Z)("Cancel")})):void 0}renderStatusFooter(){return al("footer",{className:"dialog-footer"},void 0,al("input",{type:"button",className:"primary",onClick:this.props.onClose,value:(0,le.Z)("OK")}),al("input",{type:"button",onClick:()=>this._selectPane("import"),value:(0,le.Z)("New Import...")}))}_selectPane(e){nt.Z.set(D.kMailImportSelectedPane,e),this.setState({selectedPane:e})}render(){const e=this.state.offerings.profiles.map((e=>al("option",{value:e.index},e.index,e.name)));M.Z.get(D.kMailIsTurnedOff)||(e.push(al("option",{value:this.state.offerings.profiles.length},"opml-import",(0,le.Z)("Feeds (OPML file)"))),e.push(al("option",{value:this.state.offerings.profiles.length+1},"calendar-import",(0,le.Z)("Calendar Events (ICS file)"))),e.push(al("option",{value:this.state.offerings.profiles.length+2},"calendar-import-web",(0,le.Z)("Calendar Events from Remote Server (iCal)"))));const{numImportsInStore:t}=this.state,n=0===t?(0,le.Z)("Import Status"):(0,le.Z)("Import Status ($1)",[t]);return al(ln.Z,{onRequestClose:this.props.onClose,viewMode:"import-data-dialog slide"},void 0,al("div",{className:"StatusPopup-Header"},void 0,al("h2",{},void 0,(0,le.Z)("Imports"))),al("div",{className:"dialog-content"},void 0,al("div",{className:"toolbar toolbar-default import"},void 0,al("div",{className:"toolbar-group equal-width"},void 0,al(sl,{title:(0,le.Z)("Import"),isPressed:"import"===this.state.selectedPane,onClick:()=>this._selectPane("import")}),al(sl,{title:n,isPressed:"status"===this.state.selectedPane,onClick:()=>this._selectPane("status"),disabled:0===this.state.numImportsInStore}))),"import"===this.state.selectedPane&&al("div",{className:"import-data"},void 0,al("fieldset",{},void 0,al("label",{htmlFor:"browserSel",className:"from"},void 0,(0,le.Z)("import","From")),al("select",{id:"browserSel",onChange:this.handleSelectionChange.bind(this),value:this.state.selectedIndex,autoFocus:!0},void 0,e)),this.state.selectedIndex<this.state.offerings.profiles.length&&al(yr,{profile:this.state.offerings.profiles[this.state.selectedIndex],index:this.state.selectedIndex,setStartImport:this.setStartImport,setChooseFile:this.setChooseFile}),this.state.selectedIndex===this.state.offerings.profiles.length&&al(ua,{setStartImport:this.setStartImport,setChooseFile:this.setChooseFile}),this.state.selectedIndex===this.state.offerings.profiles.length+1&&al($o,{setStartImport:this.setStartImport,setChooseFile:this.setChooseFile,readyToStart:this.readyToStart}),this.state.selectedIndex===this.state.offerings.profiles.length+2&&al(Jo,{setStartImport:this.setStartImport})),"status"===this.state.selectedPane&&rl),"import"===this.state.selectedPane?this.renderImportFooter():this.renderStatusFooter())}}const dl=ll;var cl,hl=n(96122);function pl(e,t,n,i){cl||(cl="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:cl,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class ul extends tn.Component{refPromptInput=tn.createRef();refOkButton=tn.createRef();_pendingAction=!0;state={promptValue:this.props.customData.defaultPromptText};handleLoadStart=e=>{e.isTopLevel&&this.onCancel()};componentDidMount(){this.props.customData.webview.addEventListener("loadstart",this.handleLoadStart),"prompt"!==this.props.customData.messageType?(0,hl.Z)((()=>this.refOkButton.current?.focus()),80):(0,hl.Z)((()=>this.refPromptInput.current?.select()),80)}componentWillUnmount(){this.props.customData.webview.removeEventListener("loadstart",this.handleLoadStart)}onOk=e=>{this._pendingAction&&(e.preventDefault(),this._pendingAction=!1,this.props.customData.dialog.ok(this.state.promptValue)),this.props.onClose()};onCancel=()=>{this._pendingAction&&(this._pendingAction=!1,this.props.customData.dialog.cancel()),this.props.onClose()};handlePrompt=e=>{this.setState({promptValue:e.target.value})};render(){const e=(0,_i.parse)(this.props.customData.url).hostname,t=this.props.customData.messageType,n=e?(0,le.Z)("JavaScript from “$1”",[e]):(0,le.Z)("JavaScript from localhost");return pl(ln.Z,{dialogWidth:400,onRequestClose:this.onCancel,ignoreClick:!0,viewMode:"dialog-javascript slide"},void 0,pl("header",{className:"dialog-header"},void 0,pl("h1",{className:"dialog-title",title:n},void 0,n)),pl("form",{onSubmit:this.onOk},void 0,pl("div",{className:"dialog-content"},void 0,pl("p",{},void 0,this.props.customData.messageText),"prompt"===t&&(0,fn.jsx)("input",{type:"text",ref:this.refPromptInput,value:this.state.promptValue,onChange:this.handlePrompt})),pl("footer",{className:"dialog-footer"},void 0,(0,fn.jsx)("input",{ref:this.refOkButton,type:"submit",value:(0,le.Z)("OK")}),"alert"!==t&&pl("input",{type:"button",onClick:this.onCancel,value:(0,le.Z)("Cancel")}))))}}const gl=ul;var ml;function vl(e,t,n,i){ml||(ml="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:ml,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const fl=287;function yl(e){const t=e.length;switch(!0){case t>180&&t<fl:return 426;case t>122:return 354;case t>84:return 306;default:return 258}}class wl extends tn.Component{#n=!1;constructor(e){super(e),this.state={qrImage:"",data:this.props.data,dataChanged:!1}}componentDidMount(){this.#n=!0,this.onGenerate("dataurl")}componentWillUnmount(){this.#n=!1}componentDidUpdate(e){this.state.dataChanged||this.props.data===e.data||this.setState({data:this.props.data},this.onGenerate.bind(this,"dataurl"))}onUrlInputChanged=e=>{const t=e.currentTarget.value;this.setState({data:t}),t&&t.length>2&&d.Z.utilities.generateQRCode(t,(e=>{this.setState({qrImage:e,dataChanged:!0})}))};onGenerate=(e,t)=>{if(this.props.data){const n=(0,le.Z)("QR Code Generated");d.Z.utilities.generateQRCode(this.props.data,e,(t=>{"dataurl"===e?this.#n&&this.setState({qrImage:t,data:this.props.data}):"clipboard"===e&&(0,Ct.c)({title:n,body:(0,le.Z)("Image stored in the clipboard.")})})),t&&this.props.hidePopup()}};onCancel=()=>{this.props.hidePopup()};renderDialogHeader=()=>vl("div",{className:"dialog-header"},void 0,vl("h3",{},void 0,(0,le.Z)("Scan QR Code")));renderQRImage=()=>vl("div",{className:"dialog-content"},void 0,this.state.data.length>fl?vl("p",{},void 0,(0,le.Z)("Address is too long, QR code source cannot exceed $1 characters.",[fl])):vl("img",{src:this.state.qrImage,className:"qr-image"}),vl("input",{type:"text",value:this.state.data,spellCheck:"false",maxLength:fl,onChange:this.onUrlInputChanged,onFocus:e=>e.target.select(),autoFocus:!0}));renderSaveCancel=()=>vl("footer",{className:"dialog-footer"},void 0,vl("input",{type:"button",onClick:this.onGenerate.bind(this,"clipboard",!0),disabled:this.state.data.length>fl,value:(0,le.Z)("verb","Copy")}),vl("input",{type:"button",onClick:this.onGenerate.bind(this,"file",!0),disabled:this.state.data.length>fl,value:(0,le.Z)("Save to Download")}));renderPopupContents=()=>vl("div",{className:"qr-share-dialog"},void 0,this.renderDialogHeader(),this.renderQRImage(),this.renderSaveCancel());render(){return this.props.useModal?vl(ln.Z,{dialogWidth:yl(this.state.data),onRequestClose:this.onCancel},void 0,this.renderPopupContents()):this.renderPopupContents()}}const bl=wl;var Cl,Sl=n(2699),Tl=n(89555);function Il(e,t,n,i){Cl||(Cl="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Cl,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class kl extends tn.Component{state={awaiting:60};componentDidMount(){this.expireInterval=setInterval((()=>this.expirePreview()),1e3)}componentWillUnmount(){clearInterval(this.expireInterval)}expirePreview=()=>{this.setState((e=>{const t=e.awaiting-1;return t<=0&&(clearInterval(this.expireInterval),Sl.Z.clearThemePreview()),{awaiting:t}}))};acceptPreview=()=>{this.props.isUpdate?Sl.Z.updateTheme():Sl.Z.installTheme(),this.props.onClose()};discardPreview=()=>{Sl.Z.clearThemePreview(),this.props.onClose()};render(){return Il(ln.Z,{onRequestClose:Tl.default,dialogWidth:400,viewMode:"slide",ignoreClick:!0},void 0,Il("header",{className:"dialog-header"},void 0,Il("h1",{className:"dialog-title"},void 0,(0,le.Z)("Theme Preview"))),Il("div",{className:"dialog-content"},void 0,this.state.awaiting>0&&(0,fn.jsxs)(fn.Fragment,{children:[Il("p",{},void 0,this.props.isUpdate?(0,le.Z)("This is a preview of the updated “$1” theme. Would you like to install this update and apply it?",[this.props.themeName]):(0,le.Z)("This is a preview of the “$1” theme. Would you like to install and apply it?",[this.props.themeName])),Il("p",{className:"info"},void 0,(0,le.Z)("Theme preview expires in $1 second.","Theme preview expires in $1 seconds.",[this.state.awaiting]))]}),this.state.awaiting<1&&Il("p",{},void 0,(0,le.Z)("Preview of the “$1” theme has expired, please reload the theme again if you wish to install it.",[this.props.themeName]))),Il("footer",{className:"dialog-footer"},void 0,Il("input",{type:"submit",value:this.props.isUpdate?(0,le.Z)("Update"):(0,le.Z)("Install"),onClick:this.acceptPreview,disabled:this.state.awaiting<1,autoFocus:!0}),Il("input",{type:"button",value:(0,le.Z)("Cancel"),onClick:this.discardPreview})))}}const Al=kl;var Zl;function El(e,t,n,i){Zl||(Zl="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Zl,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const _l=function({customData:e,closeDialog:t}){switch(e.dialogtype){case"download":return El(Eo,{customData:e,onClose:t});case"import":return El(dl,{onClose:t});case"createSearch":return El(yo,{onClose:t,name:e.Name,url:e.Url});case"javascript":return El("div",{className:"modal-overlay"},void 0,El(gl,{customData:e,onClose:t}));case"fullscreen":return El(xo,{customData:e,closeDialog:t});case"pointerLock":{const n=(0,le.Z)("Press Escape key to exit the pointer lock.");return El(Po,{customData:e,onClose:t,overlayText:n})}case"qrcode":return El("div",{className:"modal-overlay"},void 0,El(bl,{useModal:!0,data:e.url,hidePopup:t}));case"themePreview":return El("div",{className:"modal-overlay"},void 0,El(Al,{themeName:e.themeName,isUpdate:e.isUpdate,onClose:t}));default:return console.error("DialogRenderWrapper.render: unknown dialogtype:"+e.dialogtype),null}};var Nl=n(39005),Ml=n(5198),Pl=n(54162),Dl=n(15285),xl=n(20676),Ol=n(54614),Ll=n(40893),Rl=n(54058);const Bl=e=>{let t=e;return t&&(t=t.replace(/^data\:([^\;]+)\;base64,/gim,"")),t},Fl=(e,t,n,i=9,s)=>{const o=Bl(n.faviconUrl);return{handler:()=>{xn.setSearchEngine(e,n),Ll.Z.withTextAndEngine(e,t,n.id)},emphasized:n.id===s?.id,iconPNG:o,iconPNGWhite:o,...G.Z.makeNumberMnemonic(n.name,i)}},Ul=(e,t)=>{if(0===t.length)return[];const n=xn.getSearchEngine(e,!0);return Nn.Z.get().map(((i,s)=>Fl(e,t,i,s,n)))},Vl=e=>[{commandName:"DOCUMENT_DIRECTION_DEFAULT",type:"checkbox",...(0,Mn.Z)("command","Default")},{commandName:"DOCUMENT_DIRECTION_LTR",type:"checkbox",...(0,Mn.Z)("Left to Right")},{commandName:"DOCUMENT_DIRECTION_RTL",type:"checkbox",...(0,Mn.Z)("Right to Left")}],Wl=e=>[{commandName:"DOCUMENT_LOOP",type:"checkbox",...(0,Mn.Z)("context","Loop")},{commandName:"DOCUMENT_SHOW_CONTROLS",type:"checkbox",...(0,Mn.Z)("Show Controls")},G.Z.separatorItem,{commandName:"DOCUMENT_OPEN_AV_NEW_TAB",...e.support.audio?(0,Mn.Z)("Open Audio in New Tab"):(0,Mn.Z)("Open Video in New Tab")},{commandName:"DOCUMENT_SAVE_AV",ellipsis:!0,...e.support.audio?(0,Mn.Z)("Save Audio As"):(0,Mn.Z)("Save Video As")},{commandName:"DOCUMENT_COPY_AV_ADDRESS",ellipsis:!0,...e.support.audio?(0,Mn.Z)("Copy Audio Address"):(0,Mn.Z)("Copy Video Address")},{commandName:"DOCUMENT_CAST",ellipsis:!0,...(0,Mn.Z)("Cast")},G.Z.separatorItem,{commandName:"DOCUMENT_PICTURE_IN_PICTURE",visible:e.support.video&&e.support.pictureinpicture,...(0,Mn.Z)("Picture in Picture")}],Hl=async(e,t,n,i,s)=>{switch(i.action){case"DOCUMENT_CONTAINER_DEVELOPER_TOOLS":return{visible:!n&&!t.isdevtools,items:await zl(e,t,n,s),...s(e.winId,i,t)};case"DOCUMENT_VALIDATE_URL":return{visible:!(t.iswebpanel||t.isimage||t.isdevtools||t.ismailcontent),handler:()=>{const n=f.Z.getSync("VALIDATION_URL");Y.Z.openURL(e.winId,n.replace("%s",t.pageurl),{inCurrent:!1})},...s(e.winId,i,t)};case"DOCUMENT_VIEW_SOURCE":return{visible:!(t.isimage&&t.pageurl===t.srcurl)&&!t.isdevtools&&!t.ismailcontent,commandName:"DOCUMENT_VIEW_SOURCE",...s(e.winId,i,t)};case"DOCUMENT_VIEW_FRAME_SOURCE":return{visible:t.isframe&&!t.isdevtools&&!t.ismailcontent,commandName:"DOCUMENT_VIEW_FRAME_SOURCE",...s(e.winId,i,t)};case"DOCUMENT_RELOAD_FRAME":return{visible:t.isframe&&!t.isdevtools&&!t.ismailcontent,commandName:"DOCUMENT_RELOAD_FRAME",...s(e.winId,i,t)};case"DOCUMENT_INSPECT":return{commandName:"DOCUMENT_INSPECT",visible:!t.isdevtools,...s(e.winId,i,t)};default:return Promise.resolve({...s(e.winId,i,t)})}},zl=async(e,t,n,i)=>Promise.all(["DOCUMENT_VALIDATE_URL","DOCUMENT_VIEW_SOURCE","DOCUMENT_VIEW_FRAME_SOURCE","DOCUMENT_RELOAD_FRAME","DOCUMENT_INSPECT"].map((s=>Hl(e,t,n,{id:"",type:"command",action:s},i)))),Gl=e=>[{commandName:"DOCUMENT_LANGUAGE_SETTINGS",...(0,Mn.Z)("Language Settings")}],$l=async(e,t,n,i,s)=>{switch(i.action){case"DOCUMENT_LOOK_UP":return{visible:e.isMac&&t.printableselection.length>0&&!n,...s(e.winId,i,t)};case"DOCUMENT_COPY":case"DOCUMENT_PRINT":return{...s(e.winId,i,t)};case"DOCUMENT_GOTO_URL":return{handler:()=>{Y.Z.openURL(e.winId,t.selectionurl,{inCurrent:!1,inBackground:M.Z.get(D.kTabsOpenNewInBackground)})},visible:t.selectionurl.length>0,...s(e.winId,i,t)};case"DOCUMENT_SEARCH":case"DOCUMENT_SEARCH_LAST_USED":{const n=xn.getSearchEngine(e.winId,"DOCUMENT_SEARCH_LAST_USED"===i.action);return n?{...Fl(e.winId,t.selection,n),mnemonic:!0,...s(e.winId,i,t)}:Promise.reject()}case"DOCUMENT_CONTAINER_SEARCH_WITH":return{items:Ul(e.winId,t.selection),...s(e.winId,i,t)};case"DOCUMENT_CONTAINER_EXTENSIONS":return{visible:!t.iswebpanel&&t.support.extensions&&!n,container:{content:"extensions"},...s(e.winId,i,t)};case"DOCUMENT_SEND_BY_MAIL":return{handler:()=>{ne.Z.createDraft({subject:t.pagetitle||t.pageurl,body:`${t.selection} \n\n ${t.pageurl}`})},visible:!M.Z.get(D.kMailIsTurnedOff),...s(e.winId,i,t)};case"DOCUMENT_ADD_TO_CALENDAR":return{handler:()=>{o.Z.showAddEvent(e.winId,t.selection,t.pageurl)},visible:!e.isGuest&&!M.Z.get(D.kMailIsTurnedOff),...s(e.winId,i,t)};case"DOCUMENT_CONTAINER_SPEECH":return{visible:e.isMac,container:{content:"speech"},...s(e.winId,i,t)};case"COMMAND_FULLSCREEN":return{visible:!n,...s(e.winId,i,t)};case"COMMAND_TRANSLATE_SELECTION":{const{id:n,url:o}=W.Z.unsafeGetActivePage(e.winId);return{visible:Ml.Z.canTranslateText(t.selection,o,n),...s(e.winId,i,t),handler:()=>{Rl.Z.translateSelection(n,t.selection)}}}default:return On.actions().includes(i.action)?Hl(e,t,n,i,s):Promise.resolve({...s(e.winId,i,t)})}},Kl=async(e,t,n,i,s)=>{switch(i.action){case"DOCUMENT_OPEN_IMAGE_IN_NEW_TAB":return{visible:!e.isPopup,...s(e.winId,i,t)};case"DOCUMENT_OPEN_IMAGE_IN_NEW_BACKGROUND_TAB":return{visible:!e.isPopup&&!M.Z.get(D.kTabsOpenNewInBackground),...s(e.winId,i,t)};case"DOCUMENT_OPEN_IMAGE_IN_NEW_WINDOW":return{visible:!e.isIncognito||e.isGuest,...s(e.winId,i,t)};case"DOCUMENT_OPEN_IMAGE_IN_PRIVATE_WINDOW":return{visible:!e.isGuest,...s(e.winId,i,t)};case"DOCUMENT_CONTAINER_OPEN_IMAGE_IN_PROFILE":return{container:{content:"imageinprofile"},...s(e.winId,i,t)};case"DOCUMENT_SEARCH_FOR IMAGE":{const n=Nn.Z.getImageSearch(),o=n?Bl(n.faviconUrl):"";return{visible:!!n&&""!==n.imageUrl,iconPNG:o,iconPNGWhite:o,...s(e.winId,i,t)}}case"DOCUMENT_SHOW_IMAGE_PROPERTIES":return{handler:async()=>{const n=W.Z.getActivePage(e.winId);if(n){const i=n.windowId;if(W.Z.isDisplayingImage(n.id))Y.Z.setImageInspector(n.id,i,!0);else{await Y.Z.openURL(e.winId,t.srcurl,{inCurrent:!1,transition:d.Z.historyPrivate.TransitionType.AUTO_TOPLEVEL}),await new Promise((e=>{const t=()=>{W.Z.removeListener(t),e()};W.Z.addListener(t)}));const n=W.Z.getPages(i).last();Y.Z.setImageInspector(n.id,i,!0)}}},visible:!e.isPopup,enabled:t.isimage,...s(e.winId,i,t)};case"DOCUMENT_USE_IMAGE_AS_STARTPAGE_BACKGROUND":return{handler:()=>{Sl.Z.setThemeBackgroundImageFromUrl(e.winId,t.srcurl)},...s(e.winId,i,t)};case"DOCUMENT_QR_CODE":return{visible:t.support.qrcode&&!e.isPopup,...s(e.winId,i,t)};case"DOCUMENT_CONTAINER_TEXT_SELECTION":return t.selection.length>0?{items:await Xl(e,t,!0),...s(e.winId,i,t)}:{items:[],visible:!1,...s(e.winId,i,t)};case"DOCUMENT_CONTAINER_EXTENSIONS":return{visible:!t.iswebpanel&&t.support.extensions&&!n,container:{content:"extensions"},...s(e.winId,i,t)};case"COMMAND_FULLSCREEN":return{visible:!n,...s(e.winId,i,t)};default:return On.actions().includes(i.action)?Hl(e,t,n,i,s):Promise.resolve({...s(e.winId,i,t)})}},jl=async(e,t,n,i,s)=>{switch(i.action){case"DOCUMENT_CONTAINER_AV":return{items:Wl(t),...s(e.winId,i,t)};case"DOCUMENT_CONTAINER_EXTENSIONS":return{visible:!t.iswebpanel&&t.support.extensions&&!n,container:{content:"extensions"},...s(e.winId,i,t)};default:return On.actions().includes(i.action)?Hl(e,t,!1,i,s):Promise.resolve({...s(e.winId,i,t)})}},Yl=(e,t,n)=>{const i="image",s=Ai.getOptionFunction(i);return Ai.getNamedMenu(e.winId,i,(async i=>Kl(e,t,n,i,s)))},Xl=(e,t,n)=>{const i="selection",s=Ai.getOptionFunction(i);return Ai.getNamedMenu(e.winId,i,(async i=>$l(e,t,n,i,s)))},Ql={show:(e,t,n)=>{const i=(e,t,n)=>{(0,zi.Z)(e,n,void 0,"pointer",void 0,t)()},s={winId:e,isGuest:z.ZP.isGuestSession(e),isIncognito:z.ZP.isIncognito(e),isPopup:z.ZP.isPopup(e),isMac:!1};n.iseditable?"regular"===n.textfield?((e,t)=>{const n="uiedit",i=Ai.getOptionFunction(n);return Ai.getNamedMenu(e.winId,n,(async n=>{switch(n.action){case"DOCUMENT_CONTAINER_SPELLCHECK":return{container:{content:"spellcheck"},...i(e.winId,n,t)};case"DOCUMENT_LOOK_UP":return{visible:e.isMac&&t.printableselection.length>0,...i(e.winId,n,t)};case"DOCUMENT_EMOJI":return{visible:t.support.emoji,...i(e.winId,n,t)};case"DOCUMENT_CONTAINER_NOTES":return{container:{content:"notes"},visible:!e.isGuest,...i(e.winId,n,t)};case"DOCUMENT_CONTAINER_SPELLCHECK_OPTIONS":return e.isMac?{visible:t.support.editoptions,items:Gl(),...i(e.winId,n,t)}:{visible:t.support.editoptions,container:{content:"spellcheckoptions"},...i(e.winId,n,t)};case"DOCUMENT_CONTAINER_WRITING_DIRECTION":return{visible:t.support.editoptions,items:Vl(),...i(e.winId,n,t)};case"DOCUMENT_CONTAINER_SPEECH":return{visible:e.isMac,container:{content:"speech"},...i(e.winId,n,t)};case"COMMAND_COPY_SELECTION_TO_NOTE":return{visible:!e.isGuest&&t.selection.length>0,...i(e.winId,n,t),handler:()=>{Fs.Z.createNote(e.winId,{content:t.selection,url:""})}};case"COMMAND_TRANSLATE_SELECTION":{const{id:s,url:o}=W.Z.unsafeGetActivePage(e.winId);return{visible:Ml.Z.canTranslateText(t.selection,o,s),...i(e.winId,n,t),handler:()=>{Rl.Z.translateSelection(s,t.selection)}}}default:return Promise.resolve({...i(e.winId,n,t)})}}))})(s,n).then((n=>{i(e,t,n)})):["addressfield","searchfield"].includes(n.textfield)?((e,t)=>{const n="urledit",i=Ai.getOptionFunction(n);return Ai.getNamedMenu(e.winId,n,(async n=>{switch(n.action){case"DOCUMENT_CONTAINER_SPELLCHECK":return{container:{content:"spellcheck"},...i(e.winId,n,t)};case"DOCUMENT_LOOK_UP":return{visible:e.isMac&&t.printableselection.length>0,...i(e.winId,n,t)};case"DOCUMENT_EMOJI":return{visible:t.support.emoji,...i(e.winId,n,t)};case"COMMAND_CLIPBOARD_PASTE_AS_PLAIN_TEXT_OR_PASTE_AND_GO":return{enabled:t.support.paste,...i(e.winId,n,t)};case"DOCUMENT_CONTAINER_NOTES":return{container:{content:"notes"},visible:!e.isGuest,...i(e.winId,n,t)};case"DOCUMENT_CONTAINER_SPELLCHECK_OPTIONS":return e.isMac?{visible:t.support.editoptions,items:Gl(),...i(e.winId,n,t)}:{visible:t.support.editoptions,container:{content:"spellcheckoptions"},...i(e.winId,n,t)};case"DOCUMENT_CONTAINER_WRITING_DIRECTION":return{visible:t.support.editoptions,items:Vl(),...i(e.winId,n,t)};case"DOCUMENT_CUSTOMIZE":const s="addressfield"===t.textfield?"addressbar":"search";return{visible:!e.isGuest,handler:()=>ie.Z.showSettings(e.winId,s),...i(e.winId,n,t)};case"DOCUMENT_SHOW_FULL_ADDRESS":const o=M.Z.get(D.kAddressBarShowFullUrl);return{enabled:!e.isGuest,checked:o,visible:"addressfield"===t.textfield,handler:()=>{nt.Z.set(D.kAddressBarShowFullUrl,!o)},...i(e.winId,n,t)};case"DOCUMENT_CONTAINER_SPEECH":return{visible:e.isMac,container:{content:"speech"},...i(e.winId,n,t)};case"COMMAND_COPY_SELECTION_TO_NOTE":return{visible:!e.isGuest&&t.selection.length>0,...i(e.winId,n,t),handler:()=>{Fs.Z.createNote(e.winId,{content:t.selection,url:""})}};case"COMMAND_TRANSLATE_SELECTION":{const{id:s,url:o}=W.Z.unsafeGetActivePage(e.winId);return{visible:Ml.Z.canTranslateText(t.selection,o,s),...i(e.winId,n,t),handler:()=>{Rl.Z.translateSelection(s,t.selection)}}}default:return Promise.resolve({...i(e.winId,n,t)})}}))})(s,n).then((n=>{i(e,t,n)})):((e,t)=>{const n="docedit",i=Ai.getOptionFunction(n);return Ai.getNamedMenu(e.winId,n,(async n=>{switch(n.action){case"DOCUMENT_SUGGEST_PASSWORD":return{visible:t.support.passwordgeneration,...i(e.winId,n,t)};case"DOCUMENT_SHOW_PASSWORDS":return{visible:t.support.passwordshowall,handler:()=>ie.Z.showSettings(e.winId,"privacy"),...i(e.winId,n,t)};case"DOCUMENT_CONTAINER_SPELLCHECK":return{container:{content:"spellcheck"},...i(e.winId,n,t)};case"DOCUMENT_LOOK_UP":return{visible:e.isMac&&t.printableselection.length>0,...i(e.winId,n,t)};case"DOCUMENT_EMOJI":return{visible:t.support.emoji,...i(e.winId,n,t)};case"DOCUMENT_PASTE_AS_PLAIN_TEXT":return{visible:t.support.editoptions,...i(e.winId,n,t)};case"DOCUMENT_ADD_AS_SEARCH_ENGINE":return{visible:!e.isGuest&&t.keywordurl.length>0,...i(e.winId,n,t)};case"DOCUMENT_CONTAINER_NOTES":return{container:{content:"notes"},visible:!e.isGuest,...i(e.winId,n,t)};case"DOCUMENT_CONTAINER_SPELLCHECK_OPTIONS":return e.isMac?{visible:t.support.editoptions,items:Gl(),...i(e.winId,n,t)}:{visible:t.support.editoptions,container:{content:"spellcheckoptions"},...i(e.winId,n,t)};case"DOCUMENT_CONTAINER_WRITING_DIRECTION":return{visible:t.support.editoptions,items:Vl(),...i(e.winId,n,t)};case"DOCUMENT_SEARCH":case"DOCUMENT_SEARCH_LAST_USED":{const s=xn.getSearchEngine(e.winId,"DOCUMENT_SEARCH_LAST_USED"===n.action);return s?{...Fl(e.winId,t.selection,s),mnemonic:!0,visible:t.selection.length>0,...i(e.winId,n,t)}:Promise.reject()}case"DOCUMENT_CONTAINER_SEARCH_WITH":return{items:Ul(e.winId,t.selection),visible:t.selection.length>0,...i(e.winId,n,t)};case"DOCUMENT_CONTAINER_EXTENSIONS":return{visible:!t.iswebpanel&&t.support.extensions,container:{content:"extensions"},...i(e.winId,n,t)};case"DOCUMENT_CONTAINER_SPEECH":return{visible:e.isMac,container:{content:"speech"},...i(e.winId,n,t)};case"DOCUMENT_GOTO_URL":return{handler:()=>{Y.Z.openURL(e.winId,t.selectionurl,{inCurrent:!1,inBackground:M.Z.get(D.kTabsOpenNewInBackground)})},visible:t.selectionurl.length>0,...i(e.winId,n,t)};case"COMMAND_COPY_SELECTION_TO_NOTE":return{visible:!e.isGuest&&t.selection.length>0,...i(e.winId,n,t),handler:()=>{const n=W.Z.getActivePage(e.winId);n&&Fs.Z.createNote(e.winId,{content:t.selection,url:n.url})}};case"COMMAND_TRANSLATE_SELECTION":{const{id:s,url:o}=W.Z.unsafeGetActivePage(e.winId);return{visible:Ml.Z.canTranslateText(t.selection,o,s),...i(e.winId,n,t),handler:()=>{Rl.Z.translateSelection(s,t.selection)}}}default:return On.actions().includes(n.action)?Hl(e,t,!1,n,i):Promise.resolve({...i(e.winId,n,t)})}}))})(s,n).then((n=>{i(e,t,n)})):n.linkurl.length>0?((e,t)=>{const n="link",i=Ai.getOptionFunction(n),s=Ai.getActionList("image")(),o=Ai.getActionList("selection")(),a=Ai.getActionList("audiovideo")();return Ai.getNamedMenu(e.winId,n,(async n=>{switch(n.action){case"DOCUMENT_OPEN_IN_NEW_TAB":case"DOCUMENT_OPEN_IN_TAB":return{visible:!t.ismailto&&!e.isPopup,...i(e.winId,n,t)};case"DOCUMENT_OPEN_IN_NEW_WINDOW":return{visible:!t.ismailto&&(!e.isIncognito||e.isGuest),...i(e.winId,n,t)};case"DOCUMENT_OPEN_IN_NEW_BACKGROUND_TAB":return{visible:!t.ismailto&&!e.isPopup&&!M.Z.get(D.kTabsOpenNewInBackground),...i(e.winId,n,t)};case"DOCUMENT_OPEN_IN_PRIVATE_WINDOW":return{visible:!t.ismailto&&!e.isGuest,...i(e.winId,n,t)};case"DOCUMENT_CONTAINER_OPEN_IN_PWA":return{visible:!t.ismailto,container:{content:"linkinpwa"},...i(e.winId,n,t)};case"DOCUMENT_CONTAINER_OPEN_IN_PROFILE":return{visible:!t.ismailto,container:{content:"linkinprofile"},...i(e.winId,n,t)};case"DOCUMENT_CONTAINER_OPEN_IN_WINDOW":{const s=await Hi.getMenu(e.winId,!1,[t.linkurl]);return{visible:s.length>0,items:s,...i(e.winId,n,t)}}case"DOCUMENT_ADD_LINK_TO_BOOKMARKS":return{handler:()=>{y.Z.bookmarks.create({parentId:en.ZP.getRootNode().id,title:t.linktitle,url:t.linkurl})},visible:!t.ismailto&&!t.iswebpanel&&!e.isGuest,...i(e.winId,n,t)};case"DOCUMENT_ADD_LINK_TO_WEBPANEL":return{handler:()=>{Hs.Z.addByUrl(t.linkurl)},visible:!t.ismailto&&!t.iswebpanel&&!e.isGuest,...i(e.winId,n,t)};case"DOCUMENT_ADD_LINK_TO_READING_LIST":return{handler:()=>{Ol.Z.add(e.winId,t.linkurl,t.linktitle)},visible:!e.isGuest,...i(e.winId,n,t)};case"DOCUMENT_SEND_LINK_BY_MAIL":return{handler:()=>{ne.Z.createDraft({subject:t.linktitle||t.linkurl,body:t.linkurl})},visible:!M.Z.get(D.kMailIsTurnedOff),...i(e.winId,n,t)};case"DOCUMENT_SAVE_LINK":return{visible:!t.ismailto,...i(e.winId,n,t)};case"DOCUMENT_COPY_LINK_TEXT":return{visible:!t.isimage&&t.linktitle.length>0,...i(e.winId,n,t)};case"DOCUMENT_CONTAINER_SEND_TO_DEVICES":return{visible:!t.iswebpanel&&t.support.sendlinktodevices,container:{content:"sendlinktodevices"},...i(e.winId,n,t)};case"DOCUMENT_CONTAINER_EXTENSIONS":return{visible:!t.iswebpanel&&t.support.extensions,container:{content:"extensions"},...i(e.winId,n,t)};case"DOCUMENT_CONTAINER_LINK_SELECTION":return t.selection.length>0&&!t.isimage&&!t.support.canvas?{items:await Xl(e,t,!0),...i(e.winId,n,t)}:{items:[],visible:!1,...i(e.winId,n,t)};case"DOCUMENT_CONTAINER_LINKED_IMAGE":return t.isimage||t.support.canvas?{items:await Yl(e,t,!0),...i(e.winId,n,t)}:{items:[],visible:!1,...i(e.winId,n,t)};default:return On.actions().includes(n.action)?Hl(e,t,!1,n,i):o.includes(n.action)?t.selection.length>0&&!t.isimage&&!t.support.canvas?$l(e,t,!1,n,i):{visible:!1,...i(e.winId,n,t)}:s.includes(n.action)?t.isimage||t.support.canvas?Kl(e,t,!1,n,i):{visible:!1,...i(e.winId,n,t)}:a.includes(n.action)?t.support.audio||t.support.video?jl(e,t,!1,n,i):{visible:!1,...i(e.winId,n,t)}:Promise.resolve({...i(e.winId,n,t)})}}))})(s,n).then((n=>{i(e,t,n)})):n.isimage||n.support.canvas?Yl(s,n,!1).then((n=>{i(e,t,n)})):n.support.audio||n.support.video?((e,t)=>{const n="audiovideo",i=Ai.getOptionFunction(n);return Ai.getNamedMenu(e.winId,n,(async n=>jl(e,t,!1,n,i)))})(s,n).then((n=>{i(e,t,n)})):n.selection.length>0?Xl(s,n,!1).then((n=>{i(e,t,n)})):n.ismailcontent?((e,t)=>{const n="mailcontent",i=Ai.getOptionFunction(n);return Ai.getNamedMenu(e.winId,n,(async n=>{switch(n.action){case"COMMAND_PAGE_BACK":return{visible:Pl.Z.canGoBack(),...i(e.winId,n,t)};case"COMMAND_PAGE_FORWARD":return{visible:Pl.Z.canGoForward(),...i(e.winId,n,t)};case"COMMAND_TAB_VIEW_PAGE_SOURCE":return{checked:Boolean(Nl.Z.getIsRawMode()),...i(e.winId,n,t)};default:return On.actions().includes(n.action)?Hl(e,t,!1,n,i):Promise.resolve({...i(e.winId,n,t)})}}))})(s,n).then((n=>{i(e,t,n)})):((e,t)=>{const n="page",i=Ai.getOptionFunction(n);return Ai.getNamedMenu(e.winId,n,(async n=>{switch(n.action){case"COMMAND_ADD_BOOKMARK":return{visible:!t.iswebpanel&&!e.isGuest,...i(e.winId,n,t)};case"DOCUMENT_ADD_TO_WEBPANEL":return{handler:()=>{Hs.Z.addByUrl(t.pageurl)},visible:!t.iswebpanel&&!e.isGuest,...i(e.winId,n,t)};case"DOCUMENT_SEND_BY_MAIL":return{handler:()=>{ne.Z.createDraft({subject:t.pagetitle||t.pageurl,body:t.pageurl})},visible:!M.Z.get(D.kMailIsTurnedOff),...i(e.winId,n,t)};case"DOCUMENT_COPY_ADDRESS":return{handler:()=>{ui.Z.copyUrlToClipboard(t.pageurl)},...i(e.winId,n,t)};case"DOCUMENT_SAVE":case"DOCUMENT_CAST":return{visible:!t.iswebpanel,...i(e.winId,n,t)};case"DOCUMENT_QR_CODE":return{visible:t.support.qrcode,...i(e.winId,n,t)};case"DOCUMENT_CONTAINER_SEND_TO_DEVICES":return{visible:!t.iswebpanel&&t.support.sendpagetodevices,container:{content:"sendpagetodevices"},...i(e.winId,n,t)};case"DOCUMENT_CONTAINER_EXTENSIONS":return{visible:!t.iswebpanel&&t.support.extensions,container:{content:"extensions"},...i(e.winId,n,t)};case"DOCUMENT_CONTAINER_PLUGIN_ROTATION":{const s=!t.iswebpanel&&t.support.plugin;return{visible:s,items:s?[{commandName:"DOCUMENT_ROTATE_CLOCKWISE",...(0,Mn.Z)("Rotate Clockwise")},{commandName:"DOCUMENT_ROTATE_COUNTERCLOCKWISE",...(0,Mn.Z)("Rotate Counterclockwise")}]:[],...i(e.winId,n,t)}}case"CONTAINER_PERIODIC_RELOAD":if(t.iswebpanel){const s=Dl.ZP.getSelectedWebPanelIndex(e.winId);if(-1===s)return{visible:!1,...i(e.winId,n,t)};{const o=Dl.ZP.getWebPanels(e.winId)[s];return{...i(e.winId,n,t),items:xl.Z.getMenu(o.id,"panel")}}}return{...i(e.winId,n,t)};default:return On.actions().includes(n.action)?Hl(e,t,!1,n,i):Promise.resolve({...i(e.winId,n,t)})}}))})(s,n).then((n=>{i(e,t,n)}))}},ql=Ql;var Jl;function ed(e,t,n,i){Jl||(Jl="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Jl,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const td="https://vivaldi.com/bugreport/";class nd extends tn.Component{static contextType=dn.Z;state={hasError:!1,stack:"",existingChildren:this.props.children};static getDerivedStateFromProps(e,t){return e.children!==t.existingChildren?{hasError:!1,existingChildren:e.children}:null}static getDerivedStateFromError(e){return{hasError:!0,stack:e.stack}}componentDidCatch(e,t){return null}openBugReport=()=>{Y.Z.openURL(this.context.vivaldiWindowId,td)};render(){const{children:e,level:t}=this.props;return this.state.hasError?ed("div",{className:"error-boundary"},void 0,ed("h1",{},void 0,(0,le.Z)("An error occurred")),ed("pre",{},void 0,this.state.stack),ed("p",{},void 0,(0,le.Z)("Please consider reporting the issue at $1 to help us fix it.",[td])),"nothing"===t&&ed("input",{type:"button",onClick:()=>d.Z.runtimePrivate.exit(),value:(0,le.Z)("verb","Exit")}),"tabs"===t&&ed("input",{type:"button",onClick:this.openBugReport,value:(0,le.Z)("Report issue")})):e}}const id=nd;var sd;function od(e,t,n,i){sd||(sd="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:sd,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const ad=[D.kStartupShowFfmpegInformation];class rd extends tn.Component{static contextType=dn.Z;constructor(e){super(e),this.state={doNotShowAgain:!1}}_onClose=()=>{nt.Z.set(D.kStartupShowFfmpegInformation,!this.state.doNotShowAgain),this.props.onClose()};_onInformation=()=>{Y.Z.openURL(this.context.vivaldiWindowId,"https://help.vivaldi.com/article/html5-proprietary-media-on-linux/"),this._onClose()};_onCheckChanged=()=>{this.setState((e=>({doNotShowAgain:!e.doNotShowAgain})))};render(){return od(ln.Z,{onRequestClose:Tl.default,dialogWidth:400,viewMode:"slide"},void 0,od("header",{className:"dialog-header"},void 0,od("h1",{className:"dialog-title"},void 0,(0,le.Z)("Media support"))),od("div",{className:"dialog-content"},void 0,od("p",{},void 0,(0,le.Z)("Vivaldi lacks a suitable component to play HTML5 ‘proprietary’ media (H.264/AAC)")),od("label",{className:"dialog-checkbox"},void 0,od("input",{type:"checkbox",checked:this.state.doNotShowAgain,onChange:this._onCheckChanged}),od("span",{},void 0,(0,le.Z)("Do not show again")))),od("footer",{className:"dialog-footer"},void 0,od("input",{type:"submit",value:(0,le.Z)("More Information"),onClick:this._onInformation,autoFocus:!0}),od("input",{type:"button",value:(0,le.Z)("Cancel"),onClick:this._onClose})))}}const ld=(0,fs.Z)(rd,ad);var dd;function cd(e,t,n,i){dd||(dd="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:dd,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const hd=[D.kStartupShowGitDirectoryWarning];class pd extends tn.Component{constructor(e){super(e)}_onClose=()=>{nt.Z.set(D.kStartupShowGitDirectoryWarning,""),this.props.onClose()};render(){return cd(ln.Z,{onRequestClose:Tl.default,dialogWidth:500,viewMode:"slide"},void 0,cd("header",{className:"dialog-header"},void 0,cd("h1",{className:"dialog-title"},void 0,(0,le.Z)("Warning: Your profile folder might be in a Git repository"))),cd("div",{className:"dialog-content selectable-content"},void 0,cd("p",{},void 0,(0,le.Z)("A .git configuration was detected in")," "," ",cd("b",{},void 0,this.props.prefValues[D.kStartupShowGitDirectoryWarning])),cd("p",{},void 0,(0,le.Z)("This could cause you to accidentally share part of or your whole profile with a public Git repository and allow others to see your private data, such as website logins, cookies and cache files.")),cd("p",{},void 0,(0,le.Z)("A .gitignore file has therefore been added to your profile folder to prevent accidental sharing to public Git services (e.g. GitHub). If sharing was intentional, please edit the .gitignore file to select what really should be ignored."))),cd("footer",{className:"dialog-footer"},void 0,cd("input",{type:"button",value:(0,le.Z)("Close"),onClick:this._onClose})))}}const ud=(0,fs.Z)(pd,hd);var gd;function md(e,t,n,i){gd||(gd="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:gd,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const vd=[D.kStartupShowMediaAvailableInformation];class fd extends tn.Component{static contextType=dn.Z;constructor(e){super(e),this.state={doNotShowAgain:!1}}_onClose=()=>{nt.Z.set(D.kStartupShowMediaAvailableInformation,!this.state.doNotShowAgain),this.props.onClose()};_onInformation=()=>{Y.Z.openURL(this.context.vivaldiWindowId,"https://www.microsoft.com/en-us/software-download/mediafeaturepack"),this._onClose()};_onCheckChanged=()=>{this.setState((e=>({doNotShowAgain:!e.doNotShowAgain})))};render(){return md(ln.Z,{onRequestClose:Tl.default,dialogWidth:400,viewMode:"slide"},void 0,md("header",{className:"dialog-header"},void 0,md("h1",{className:"dialog-title"},void 0,(0,le.Z)("Media support"))),md("div",{className:"dialog-content"},void 0,md("p",{},void 0,(0,le.Z)("This Windows N edition lacks the media package to play HTML5 ‘proprietary’ media (H.264/AAC).")),md("label",{className:"dialog-checkbox"},void 0,md("input",{type:"checkbox",checked:this.state.doNotShowAgain,onChange:this._onCheckChanged}),md("span",{},void 0,(0,le.Z)("Do not show again")))),md("footer",{className:"dialog-footer"},void 0,md("input",{type:"submit",value:(0,le.Z)("More Information"),onClick:this._onInformation,autoFocus:!0}),md("input",{type:"button",value:(0,le.Z)("Cancel"),onClick:this._onClose})))}}const yd=(0,fs.Z)(fd,vd);var wd=n(84451),bd=n(32773);function Cd(e){return e.hasToken?"loggedIn":"invalid_credentials"===e.lastTokenFetchError.errorType?"loginFailed":0!==e.tokenRequestTime?"loggingIn":e.accountInfo.accountId?"credentialsMissing":"loggedOut"}class Sd extends Z.Z{getInitialState(){return{accountInfo:{accountId:"",username:"",pictureUrl:""},hasSavedPassword:!1,hasToken:!1,accessToken:"",hasEncryptedToken:!1,tokenRequestTime:0,nextTokenRequestTime:0,lastTokenFetchError:{errorType:"no_error",serverMessage:"",errorCode:0},lastAccountInfoFetchError:{errorType:"no_error",serverMessage:"",errorCode:0},isReady:!1}}reduce(e,t){return"VIVALDI_ACCOUNT_STATE_UPDATED"===t.actionType?t.state:e}}const Td=new Sd;var Id,kd=n(57654);function Ad(e,t,n,i){Id||(Id="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Id,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Zd=[D.kKeyboardTabToAll];var Ed=Ad("br",{});class _d extends tn.Component{static contextType=dn.Z;constructor(e){super(e),this.state={hasGuestSession:!1,accountState:"none",editedName:this.getProfileName(e.activeProfile),suggestedName:"",activeImageIndex:e.activeProfile.imageIndex,activeImageUrl:this.getProfileImage(e.activeProfile),profileImages:[],profileStats:[],selectedProfilePath:"",hasDesktopShortcut:!1,createDesktopShortcut:!1,canCreateDesktopShortcut:!0,canRemoveActive:!1}}componentDidMount(){this.attachListeners(),this.onWindowUpdated(),this.getAllProfileImages(),d.Z.runtimePrivate.getProfileDefaults((e=>{this.setState({suggestedName:e})})),d.Z.runtimePrivate.hasDesktopShortcut(((e,t)=>{this.setState({hasDesktopShortcut:e,createDesktopShortcut:e,canCreateDesktopShortcut:t})}))}componentWillUnmount(){this.detachListeners()}attachListeners=()=>{d.Z.windowPrivate.onWindowCreated.addListener(this.onWindowUpdated),d.Z.windowPrivate.onWindowClosed.addListener(this.onWindowUpdated)};detachListeners=()=>{d.Z.windowPrivate.onWindowCreated.removeListener(this.onWindowUpdated),d.Z.windowPrivate.onWindowClosed.removeListener(this.onWindowUpdated)};onWindowUpdated=()=>{d.Z.runtimePrivate.hasGuestSession((e=>{this.state&&this.setState({hasGuestSession:e})}))};getAllProfileImages=()=>{d.Z.runtimePrivate.getUserProfileImages((e=>{this.setState({profileImages:e})}))};openNamedProfile=e=>{d.Z.runtimePrivate.openNamedProfile(e,(t=>{t||console.warn("Failed to open profile: "+e),this.props.hidePopup()}))};getProfileImage=e=>{if(e.active){const e=Td.getState().accountInfo;if(e.pictureUrl)return e.pictureUrl}return e.customAvatar?e.customAvatar:e.image};getProfileName=e=>{if(e.active){const e=Td.getState().accountInfo;if(e.accountId)return e.accountId}return e.name};toggleGuestProfile=()=>{this.state.hasGuestSession?ie.Z.closeGuestSession():ie.Z.openGuestWindow(),this.props.hidePopup()};managePeople=()=>{this.setState({accountState:"list"})};manageUser=()=>{this.props.isLoggedIn?(ie.Z.showSettings(this.context.vivaldiWindowId,"sync"),this.props.hidePopup()):this.setState({accountState:"edit"})};exitUser=()=>{ie.Z.closeActiveProfile()};getFormattedName_=()=>this.props.accountInfo.username&&this.props.isLoggedIn?Ad("div",{className:"profile-name-text"},void 0,Ad("div",{className:"active-sync-item-label"},void 0,(0,le.Z)("Logged in as"),Ed),Ad("div",{},void 0,this.props.accountInfo.username)):this.props.activeProfile.name;selectActiveProfileImage=(e,t)=>{this.setState({activeImageIndex:e,activeImageUrl:t})};selectCustomProfileImage=()=>{d.Z.utilities.selectLocalImage({windowId:this.context.vivaldiWindowId,title:(0,le.Z)("Select Custom Image"),profileImage:!0})};goBack=()=>{let e="none";"info"===this.state.accountState&&(e="list"),this.state&&this.setState({accountState:e,editedName:this.props.activeProfile.name,activeImageIndex:this.props.activeProfile.imageIndex,canRemoveActive:!1})};onSave=()=>{let e=!0;if("edit"===this.state.accountState){if(this.state.editedName.length){const t=(0,kd.Z)(this.state.editedName).trim();if(!t.length)return;const n=this.state.hasDesktopShortcut!==this.state.createDesktopShortcut||this.state.activeImageIndex!==this.props.activeProfile.imageIndex;d.Z.runtimePrivate.updateActiveProfile(t,this.state.activeImageIndex,n?this.state.createDesktopShortcut:void 0,(t=>{e=t}))}}else if("new"===this.state.accountState&&this.state.suggestedName.length){const t=(0,kd.Z)(this.state.suggestedName).trim();if(!t.length)return;d.Z.runtimePrivate.createProfile(t,this.state.activeImageIndex,this.state.createDesktopShortcut,(t=>{e=t}))}this.props.hidePopup&&e&&this.props.hidePopup()};onCancel=()=>{this.goBack()};onSignin=()=>{ie.Z.showSettings(this.context.vivaldiWindowId,"sync"),this.props.hidePopup()};onRegister=()=>{ie.Z.showSettings(this.context.vivaldiWindowId,"sync",{view:"register"}),this.props.hidePopup()};createProfile=()=>{this.setState({accountState:"new",activeImageIndex:0})};showProfileInfo=(e,t)=>{this.setState({accountState:"info",selectedProfilePath:e}),t.preventDefault(),t.stopPropagation(),d.Z.runtimePrivate.getProfileStatistics(e,(e=>{e.map((e=>{switch(e.category){case"Autofill":e.category=(0,le.Z)("Autofill");break;case"Bookmarks":e.category=(0,le.Z)("Bookmarks");break;case"Passwords":e.category=(0,le.Z)("Passwords");break;case"BrowsingHistory":e.category=(0,le.Z)("Browsing History")}})),this.setState({profileStats:e})}))};confirmRemoval=()=>{this.setState({canRemoveActive:!0})};removeProfile=()=>{d.Z.runtimePrivate.deleteProfile(this.state.selectedProfilePath,(e=>{e&&this.goBack()}))};handleNameInput=e=>{"new"===this.state.accountState?this.setState({suggestedName:e.target.value}):this.setState({editedName:e.target.value})};changeDesktopShortcut=e=>{this.setState({createDesktopShortcut:e.currentTarget.checked})};handleFocus=e=>{e.currentTarget.select()};renderNavigationBack=()=>{const e=(0,le.Z)("profiles","Back");return Ad("button",{type:"button",title:e,className:"nav-back",onClick:this.goBack,dangerouslySetInnerHTML:{__html:cn.mgF.medium+e}})};renderDialogHeader=()=>{let e;switch(this.state.accountState){case"new":e=(0,le.Z)("Create New Person");break;case"info":break;default:e=(0,le.Z)("Edit Person")}return e?Ad("div",{className:"profile-section-header"},void 0,e):null};renderNameEdit=()=>{const e="new"===this.state.accountState?this.state.suggestedName:this.state.editedName;return Ad("label",{className:"profile-section-name"},void 0,Ad("input",{type:"text",name:"name",placeholder:(0,le.Z)("profiles","Name"),onChange:this.handleNameInput,value:e,onFocus:this.handleFocus,autoFocus:!0}))};renderSaveCancel=()=>Ad("footer",{className:"dialog-footer"},void 0,Ad("input",{type:"submit",className:"primary",value:"new"===this.state.accountState?(0,le.Z)("Add Person"):(0,le.Z)("Save")}),Ad("input",{type:"button",onClick:this.onCancel,value:(0,le.Z)("Cancel")}));renderProfileInfo=()=>{const e=[],t=this.props.allProfiles.filter((e=>e.path===this.state.selectedProfilePath));if(t&&t[0]){const n=this.getProfileName(t[0]),i=this.getProfileImage(t[0]);e.push(Ad("div",{className:"profile-details"},"apv_details",Ad("div",{className:"profile-image",style:{backgroundImage:`url(${i})`}}),Ad("div",{className:"profile-name"},void 0,n)))}return this.state.profileStats.forEach(((t,n)=>{e.push(Ad("div",{className:"profile-stat-row"},t.category,Ad("div",{className:"profile-category"},void 0,t.category),Ad("div",{className:"profile-count"},void 0,t.count)))})),this.state.canRemoveActive&&e.push(Ad("p",{className:"alert"},"apv_alert",(0,le.Z)("You are about to remove the active person. All profile data will be deleted and cannot be restored. Do you still want to proceed?"))),e.push(Ad("input",{type:"button",className:"danger remove-person-button",onClick:t[0].active&&!this.state.canRemoveActive?this.confirmRemoval:this.removeProfile,value:(0,le.Z)("Remove Person")},"apv_button")),e};renderSelectableProfileImages=()=>{const e=[];e.push(Ad("button",{title:(0,le.Z)("Select custom avatar image"),type:"button",className:"avatarbox avatarbox-custom",onClick:this.selectCustomProfileImage.bind(this),dangerouslySetInnerHTML:{__html:cn.IJb}},"custom-image"));let t=this.state.profileImages.map((e=>{const t=mn()({"avatarbox-image":!0,"avatarbox-selected":this.state.activeImageIndex===e.index});return Ad("button",{title:e.name,type:"button",className:"avatarbox",onClick:this.selectActiveProfileImage.bind(this,e.index,e.image)},e.index,Ad("div",{className:t,style:{backgroundImage:`url(${e.image})`}}))}));return t=e.concat(t),Ad("div",{className:"avatarlist"},void 0,t)};renderCreateProfileShortcut=()=>this.state.canCreateDesktopShortcut?Ad("label",{},void 0,Ad("input",{className:"dialog-checkbox",checked:this.state.createDesktopShortcut,onChange:this.changeDesktopShortcut,type:"checkbox"}),Ad("span",{},void 0,(0,le.Z)("Create Desktop Shortcut"))):null;renderAllProfiles=()=>{const e=[];return this.props.allProfiles.forEach((t=>{const n=this.getProfileImage(t),i=this.getProfileName(t);e.push(Ad("button",{className:"account-item-large",title:i,onClick:this.showProfileInfo.bind(this,t.path),tabIndex:this.props.prefValues[D.kKeyboardTabToAll],autoFocus:-1!==this.props.prefValues[D.kKeyboardTabToAll]},t.path,Ad("img",{src:n}),Ad("span",{className:"profile-name"},void 0,i)))})),e};renderActiveProfileHeader=()=>{let e=this.props.accountInfo.pictureUrl;return e&&this.props.isLoggedIn||(e=this.getProfileImage(this.props.activeProfile)),(0,fn.jsxs)(fn.Fragment,{children:[Ad("div",{className:"account-item active-profile",onClick:this.manageUser},void 0,Ad("div",{className:"profile-name"},void 0,Ad("img",{src:e}),this.getFormattedName_()),(this.props.isLoggedIn||!this.props.accountInfo.username)&&Ad("span",{dangerouslySetInnerHTML:{__html:cn.Zu.medium}})),this.props.accountInfo.username&&!this.props.isLoggedIn&&Ad("input",{type:"button",onClick:this.onSignin,value:(0,le.Z)("Log in"),autoFocus:!0})]})};renderInActiveProfiles=()=>{const e=this.props.allProfiles.filter((e=>!e.active)),t=[];return e.forEach((e=>{const n=this.getProfileImage(e),i=this.getProfileName(e);t.push(Ad("button",{className:"account-item",title:i,onClick:this.openNamedProfile.bind(this,e.path)},e.path,Ad("img",{src:n}),Ad("span",{className:"profile-name"},void 0,i)))})),t};renderGuestEntry=()=>{const e=this.state.hasGuestSession?(0,le.Z)("Exit Guest Session"):(0,le.Z)("Open Guest Window");return Ad("button",{className:"account-item",onClick:this.toggleGuestProfile,title:e,dangerouslySetInnerHTML:{__html:cn.LaO.medium+e}})};renderManagePeople=()=>{const e=(0,le.Z)("Manage People");return Ad("button",{className:"account-item",onClick:this.managePeople,title:e,dangerouslySetInnerHTML:{__html:cn.LaO.medium+e}})};renderExitUser=()=>{const e=(0,le.Z)("Exit $1",[this.props.activeProfile.name]);return Ad("button",{className:"account-item",onClick:this.exitUser,title:e,dangerouslySetInnerHTML:{__html:cn.kze+e}})};renderSyncCTA=()=>Ad("div",{className:"account-create"},void 0,Ad("p",{},void 0,(0,le.Z)("Create a Vivaldi account to start syncing data across your devices.")),Ad("span",{dangerouslySetInnerHTML:{__html:n(71665)}}),Ad("input",{type:"button",value:(0,le.Z)("Create Account"),onClick:this.onRegister}));render(){return"edit"===this.state.accountState||"new"===this.state.accountState?Ad("form",{className:"account-dialog",onSubmit:this.onSave},void 0,this.renderNavigationBack(),this.renderDialogHeader(),this.renderNameEdit(),this.renderSelectableProfileImages(),this.renderCreateProfileShortcut(),this.renderSaveCancel()):"list"===this.state.accountState?Ad("div",{className:"account-dialog"},void 0,this.renderNavigationBack(),Ad("div",{className:"account-listing-large"},void 0,this.renderAllProfiles()),Ad("footer",{className:"dialog-footer"},void 0,Ad("input",{type:"submit",className:"primary",onClick:this.createProfile,value:(0,le.Z)("Add Person")}))):"info"===this.state.accountState?Ad("div",{className:"account-dialog"},void 0,this.renderNavigationBack(),this.renderDialogHeader(),Ad("div",{className:"profile-stat"},void 0,this.renderProfileInfo())):this.props.activeProfile.guest?Ad("div",{className:"account-dialog"},void 0,this.renderInActiveProfiles(),this.renderGuestEntry()):Ad("div",{className:"account-dialog"},void 0,Ad("header",{},void 0,this.renderActiveProfileHeader()),Ad("div",{className:"popup-scrollarea"},void 0,!this.props.accountInfo.username&&!this.props.isLoggedIn&&this.renderSyncCTA(),this.renderInActiveProfiles(),this.renderManagePeople(),this.renderGuestEntry(),this.props.allProfiles.length>1&&this.renderExitUser()))}}const Nd=(0,fs.Z)(_d,Zd);var Md;function Pd(e,t,n,i){Md||(Md="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Md,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Dd="/resources/contact-person.png";class xd extends tn.PureComponent{static contextType=dn.Z;state={popupVisible:!1,activeProfile:void 0,allProfiles:[],isLoggedIn:Td.getState().hasToken,accountInfo:Td.getState().accountInfo};componentDidMount(){d.Z.runtimePrivate.onProfilesUpdated.addListener(this.profilesUpdated),this.profilesUpdated(),Td.addListener(this.onVivaldiAccountChange),this.onVivaldiAccountChange()}componentWillUnmount(){d.Z.runtimePrivate.onProfilesUpdated.removeListener(this.profilesUpdated),Td.removeListener(this.onVivaldiAccountChange)}profilesUpdated=()=>{d.Z.runtimePrivate.getUserProfiles((e=>{const t=e.find((e=>!0===e.active));this.setState({allProfiles:e}),t&&this.setState({activeProfile:t})}))};onVivaldiAccountChange=()=>{const e=Td.getState();this.setState({isLoggedIn:e.hasToken&&e.isReady,accountInfo:e.accountInfo})};togglePopup=()=>{this.setState((e=>({popupVisible:!e.popupVisible})))};hidePopup=()=>{this.setState({popupVisible:!1})};render(){if(!this.props.preview&&z.ZP.isIncognito(this.context.vivaldiWindowId))return null;let e=this.state.accountInfo.username,t=this.state.accountInfo.pictureUrl;const n=this.state.activeProfile;return n?(n.guest?(n.image=t=Dd,n.name=e=(0,le.Z)("Guest User")):this.state.isLoggedIn||(e=n.name,t=n.customAvatar?n.customAvatar:n.image),t||(t=Dd),Pd(sl,{imagePath:t,dragImage:t,tooltip:e||(0,le.Z)("Account"),onClick:this.togglePopup,customizeMenu:this.props.customizeMenu,menuOrigin:this.props.menuOrigin,popupPosition:this.props.popupPosition,hidePopup:this.hidePopup,isPopupVisible:this.state.popupVisible,className:"button-circularimage button-cropimage profile-popup",popupClassName:"ToolbarButtonPopup-DefaultStyles",popupWidth:260,popupPosition:this.props.popupPosition,hidePopup:this.hidePopup,isPopupVisible:this.state.popupVisible,size:this.props.size,draggable:this.props.draggable||!1,onDragStart:this.props.onDragStart??Tl.default,onDragEnd:this.props.onDragEnd??Tl.default,onDrop:this.props.onDrop??Tl.default,onDragEnter:this.props.onDragEnter??Tl.default,onDragLeave:this.props.onDragLeave??Tl.default,onDragOver:this.props.onDragOver??Tl.default,mimeType:this.props.mimeType,name:this.props.name??""},void 0,Pd(Nd,{activeProfile:n,allProfiles:this.state.allProfiles,hidePopup:this.hidePopup,isLoggedIn:this.state.isLoggedIn,accountInfo:this.state.accountInfo}))):null}}const Od=Br(xd);var Ld,Rd=n(13302);function Bd(e,t,n,i){Ld||(Ld="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Ld,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Fd=(e,t)=>wd.Z.isSingleKeyShortcut(e)?t?"singlefeatures":"single":"",Ud=["shift+tab","tab","space","enter","left","right","up","down","pageup","pagedown","numlock","home","end","insert","del"],Vd=["alt+shift+f4","alt+f4","shift+insert","ctrl+insert","shift+f10"];class Wd extends tn.Component{static contextType=dn.Z;refComboInput=tn.createRef();state={keyValue:this.props.command.shortcuts||[],selectedCombo:"",active:!1,duplicateCombo:null,systemReservedCombo:"",singleKeyWarning:!1};findExistingShortcut=(e,t)=>this.props.commandArray.filter((e=>e.shortcuts)).find((n=>n.shortcuts?.includes(e)&&n.feature===t));isTweakedShortcut=e=>(!this.props.command.shortcuts||!this.props.command.shortcuts.includes(e))&&(this.props.command.tweakedShortcut&&this.props.command.tweakedShortcut===e);restoreDefault=()=>{const e=M.Z.getDefault(D.kActions)[0][this.props.command.name];if(e?.shortcuts)for(let t=0;t<e.shortcuts.length;t++){const n=this.findExistingShortcut(e.shortcuts[t],this.props.command.feature);if(n&&this.props.command.name!==n.name&&!this.isTweakedShortcut(e.shortcuts[t]))return void this.setState({duplicateCombo:{shortcut:(0,Rd.$)(e.shortcuts[t]),label:n.label},systemReservedCombo:"",singleKeyWarning:!1})}this.setState({keyValue:e?.shortcuts??[]},this.save)};onClearComboButton=()=>{const{selectedCombo:e}=this.state,t=this.props.command.shortcuts;if(!e||!t)return void this.setState({keyValue:[]},this.save);const n=t.indexOf(e);if(n<0)return void this.setState({selectedCombo:""},this.save);const i=[...t.slice(0,n),...t.slice(n+1)];this.setState({keyValue:i,selectedCombo:i[n]||""},this.save)};onClearComboButtonMouseDown=e=>{e.preventDefault()};handleKeyEvent=e=>{const t=wd.Z.keyComboFromEvent(e.nativeEvent);if(!t)return;"tab"!==t&&"shift+tab"!==t&&e.preventDefault();const n=this.findExistingShortcut(t,this.props.command.feature);if("PageUp"!==e.nativeEvent.key&&"PageDown"!==e.nativeEvent.key||!e.nativeEvent.ctrlKey||e.preventDefault(),e.getModifierState("AltGraph"))return;const i=this.props.prefValues[D.kKeyboardShortcutsEnableSingleKey]||this.props.prefValues[D.kKeyboardShortcutsEnableSingleKeyForMail]&&["calendar","mail"].includes(this.props.command.feature),{selectedCombo:s}=this.state;if("backspace"===t||s&&"del"===t){let e=this.props.command.shortcuts;s&&e?e.splice(e.indexOf(s),1):e&&(e=e.slice(0,e.length-1)),this.setState({keyValue:e||[],duplicateCombo:null,systemReservedCombo:"",singleKeyWarning:!1},this.save),this.refComboInput.current?.focus()}else if(wd.Z.isSingleKeyShortcut(t)&&!i)this.setState({duplicateCombo:null,systemReservedCombo:"",singleKeyWarning:!0});else if(n&&!this.isTweakedShortcut(t))this.setState({duplicateCombo:{shortcut:(0,Rd.$)(t),label:n.label},systemReservedCombo:"",singleKeyWarning:!1});else if(-1!==Vd.indexOf(t))this.setState({systemReservedCombo:(0,Rd.$)(t),duplicateCombo:null,singleKeyWarning:!1});else if(-1===Ud.indexOf(t)){const e=this.props.command.shortcuts||[];this.setState({keyValue:e.slice().concat(t),duplicateCombo:null,systemReservedCombo:"",singleKeyWarning:!1},this.save)}else this.navigateWithArrowKeys(e)};navigateWithArrowKeys=e=>{let t=null;if(!this.state.keyValue||0===this.state.keyValue.length)return;const n=wd.Z.keyComboFromEvent(e.nativeEvent),{document:i,HTMLElement:s}=this.context,o=i.activeElement;switch(n){case"left":o&&(t=o.previousElementSibling);break;case"right":o&&(t=o.nextElementSibling);break;case"up":o&&o.parentNode&&(t=o.parentNode.firstChild);break;case"down":o&&o.parentNode&&(t=o.parentNode.lastChild)}t instanceof s&&(e.preventDefault(),e.stopPropagation(),t.focus())};save=()=>{a.Z.setShortcuts(this.props.command.name,this.state.keyValue)};onTextFocus=()=>{this.setState({active:!0})};onTextBlur=e=>{e.preventDefault(),e.stopPropagation(),this.setState({active:!1,duplicateCombo:null,systemReservedCombo:"",singleKeyWarning:!1}),this.save()};onButtonFocus=()=>{this.setState({active:!0})};onButtonBlur=e=>{e.preventDefault(),e.stopPropagation(),this.setState({active:!1,duplicateCombo:null,systemReservedCombo:"",singleKeyWarning:!1}),this.save()};onComboFocus=e=>{this.setState({selectedCombo:e.currentTarget.dataset.raw,active:!0})};onComboBlur=()=>{this.setState({selectedCombo:"",active:!1})};renderCombos=()=>{if(this.props.command.shortcuts&&this.props.command.shortcuts.length>0){const e=["mail","calendar"].includes(this.props.command.feature);return this.props.command.shortcuts&&this.props.command.shortcuts.map(((t,n)=>Bd("button",{className:`multiinput-item ${Fd(t,e)}`,"data-raw":t,onFocus:this.onComboFocus,onBlur:this.onComboBlur,onKeyDown:this.handleKeyEvent},n,(0,Rd.$)(t))))}};renderKeyboardShortcutEditSetting=()=>Bd("div",{className:mn()({controls:!0,active:this.state.active})},void 0,Bd("div",{className:"multiinput"},void 0,Bd("div",{className:"multiinput-group"},void 0,this.renderCombos(),(0,fn.jsx)("input",{type:"text",ref:this.refComboInput,id:this.props.id,defaultValue:"",onKeyDown:this.handleKeyEvent,onFocus:this.onTextFocus,onBlur:this.onTextBlur}))),Bd("input",{type:"button",className:"circular restorekey",title:(0,le.Z)("Restore default shortcut"),onClick:this.restoreDefault,onFocus:this.onButtonFocus,onBlur:this.onButtonBlur}),Bd("input",{type:"button",className:"circular clearkey",title:(0,le.Z)("Clear shortcut"),onMouseDown:this.onClearComboButtonMouseDown,onClick:this.onClearComboButton,onFocus:this.onButtonFocus,onBlur:this.onButtonBlur}),this.state.duplicateCombo&&Bd("p",{className:"info"},void 0,(0,le.Z)("Shortcut $1 is already assigned to “$2” command.",[this.state.duplicateCombo.shortcut.toUpperCase(),this.state.duplicateCombo&&this.state.duplicateCombo.label])),this.state.systemReservedCombo&&Bd("p",{className:"info"},void 0,(0,le.Z)("Shortcut $1 is reserved by the system.",[this.state.systemReservedCombo.toUpperCase()])),this.state.singleKeyWarning&&Bd("p",{className:"info"},void 0,(0,le.Z)("Single Key Shortcuts are currently disabled.")));render(){return this.renderKeyboardShortcutEditSetting()}}const Hd=Wd;var zd;function Gd(e,t,n,i){zd||(zd="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:zd,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class $d extends tn.PureComponent{refComboInput=tn.createRef();state={commands:[],error:null};componentDidMount=()=>{this._initialSetup(),U.Z.addListener(this.onStoreChange)};componentWillUnmount=()=>{U.Z.removeListener(this.onStoreChange)};_initialSetup=async()=>{this.setState({commands:U.Z.getSettingsList(!1)})};onStoreChange=()=>{this._initialSetup()};getCommand=()=>this.state.commands.find((e=>e.name===this.props.name));findExistingShortcut=e=>this.state.commands.filter((e=>e.shortcuts)).find((t=>t.shortcuts?.includes(e)));isDefault=()=>{const e=this.getCommand()?.shortcuts;if(void 0===e)return!0;const t=M.Z.getDefault(D.kActions)[0][this.props.name]?.shortcuts;return!!t?.every(((t,n)=>t===e[n]))||void 0===t&&0===e.length};restoreDefault=()=>{const e=M.Z.getDefault(D.kActions)[0][this.props.name];if(e.shortcuts)for(let t=0;t<e.shortcuts.length;t++){const n=e.shortcuts[t],i=this.findExistingShortcut(n);if(i&&i.name!==this.props.name)return void this.setState({error:(0,le.Z)("Shortcut $1 is already assigned to “$2” command.",[(0,Rd.$)(n).toUpperCase(),i.label])})}const t=this.getCommand();t&&this.save(t,e.shortcuts||[])};handleKeyEvent=e=>{const t=this.getCommand();if(!t||["Escape","Tab"].includes(e.key)||e.getModifierState("AltGraph"))return void this.setState({error:null});e.preventDefault();const n=wd.Z.keyComboFromEvent(e.nativeEvent);if("Backspace"!==e.key){if(n){const e=this.findExistingShortcut(n);if(!M.Z.get(D.kKeyboardShortcutsEnableSingleKey)&&wd.Z.isSingleKeyShortcut(n))this.setState({error:(0,le.Z)("Single Key Shortcuts are currently disabled.")});else if(e)this.setState({error:(0,le.Z)("Shortcut $1 is already assigned to “$2” command.",[(0,Rd.$)(n).toUpperCase(),e.label])});else if(-1!==Vd.indexOf(n)){const e=(0,Rd.$)(n);this.setState({error:(0,le.Z)("Shortcut $1 is reserved by the system.",[e.toUpperCase()])})}else-1===Ud.indexOf(n)&&this.setState({error:null},(()=>{const e=(t.shortcuts||[]).concat(n);this.save(t,e,(()=>{this.refComboInput.current?.focus()}))}))}}else{const e=t.shortcuts?.slice(0,t.shortcuts.length-1);e&&this.setState({error:null},(()=>{this.save(t,e)}))}};deleteCombo=(e,t,n,i)=>{const s=n.filter(((e,t)=>t!==i));if("Delete"===e.key){const n=e.currentTarget.nextElementSibling;this.save(t,s,(()=>{n instanceof HTMLElement&&n.focus()}))}else if("Backspace"===e.key&&n){const n=e.currentTarget.previousElementSibling||e.currentTarget.nextElementSibling;this.save(t,s,(()=>{n instanceof HTMLElement&&n.focus()}))}else this.handleKeyEvent(e)};save=(e,t,n)=>{const{name:i}=e;this.setState({error:null},(()=>{a.Z.setShortcuts(i,t),n&&n()}))};render(){const e=this.getCommand(),t=e&&Array.isArray(e.shortcuts)&&e.shortcuts;return(0,fn.jsxs)(fn.Fragment,{children:[Gd("div",{className:"SingleShortcut-Toolbar toolbar toolbar-default"},void 0,Gd("div",{className:"multiinput"},void 0,Gd("div",{className:"multiinput-group"},void 0,e&&t&&t.map(((n,i)=>Gd("button",{style:{textTransform:"capitalize"},className:"multiinput-item",onKeyDown:n=>{this.deleteCombo(n,e,t,i)}},n,(0,Rd.$)(n)))),(0,fn.jsx)("input",{type:"text",ref:this.refComboInput,placeholder:t&&0===t.length&&this.props.placeholder||null,onKeyDown:this.handleKeyEvent}))),Gd(sl,{onClick:this.restoreDefault,image:cn.GO5.medium,disabled:void 0!==e&&this.isDefault(),tooltip:(0,le.Z)("Restore default shortcut")})),this.state.error&&Gd("p",{className:"SingleShortcut-Error",dangerouslySetInnerHTML:{__html:cn.Si$.small+this.state.error}})]})}}const Kd=$d;var jd;function Yd(e,t,n,i){jd||(jd="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:jd,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Xd=[D.kPrivacyBreakModeIntroductionShow];class Qd extends tn.PureComponent{render(){return Yd("div",{className:"popup-scrollarea"},void 0,Yd("div",{className:"BreakModePopup--Graphic",dangerouslySetInnerHTML:{__html:cn.Gvk.large}}),Yd("h1",{},void 0,(0,le.Z)("Take a Break")),Yd("p",{className:"BreakModePopup-Intro"},void 0,(0,le.Z)("Vivaldi is fading content and pausing media. Focus elsewhere for a while.")),Yd("h3",{},void 0,(0,le.Z)("Keyboard Shortcut")),Yd(Kd,{name:"COMMAND_BREAKMODE_TOGGLE",placeholder:(0,le.Z)("No shortcut assigned")}),Yd("label",{},void 0,Yd("input",{type:"checkbox",checked:!this.props.prefValues[D.kPrivacyBreakModeIntroductionShow],onChange:()=>{nt.Z.toggle(D.kPrivacyBreakModeIntroductionShow,!0,!1)}}),Yd("span",{},void 0,(0,le.Z)("Do not show again"))))}}const qd=(0,fs.Z)(Qd,Xd);var Jd;function ec(e,t,n,i){Jd||(Jd="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Jd,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const tc=[D.kPrivacyBreakModeIntroductionShow];var nc=ec(qd,{});class ic extends tn.PureComponent{state={shouldShowPopup:us.Z.getState().isActive&&this.props.prefValues[D.kPrivacyBreakModeIntroductionShow],isInBreakMode:us.Z.getState().isActive};componentDidMount=()=>{us.Z.addListener(this.onBreakModeChanged)};componentWillUnmount=()=>{us.Z.removeListener(this.onBreakModeChanged)};onBreakModeChanged=()=>{const e=us.Z.getState().isActive,t=e&&this.props.prefValues[D.kPrivacyBreakModeIntroductionShow];this.setState({isInBreakMode:e,shouldShowPopup:t})};hidePopup=()=>{this.setState({shouldShowPopup:!1})};menu=()=>[{type:"checkbox",checked:this.props.prefValues[D.kPrivacyBreakModeIntroductionShow],handler:()=>{nt.Z.toggle(D.kPrivacyBreakModeIntroductionShow,!0,!1)},...(0,Mn.Z)("Show Break Mode Introduction")}];render(){return ec(sl,{className:"panel-clickoutside-ignore",tooltip:this.state.isInBreakMode?(0,le.Z)("End Break"):(0,le.Z)("Take a Break"),onClick:s.Z.toggleBreakMode,isOn:this.state.isInBreakMode,customizeMenu:this.props.customizeMenu,menuOrigin:this.props.menuOrigin,image:this.state.isInBreakMode?cn._qK[this.props.size]:cn.Gvk[this.props.size],draggable:this.props.draggable,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,onDrop:this.props.onDrop,onDragEnter:this.props.onDragEnter,mimeType:this.props.mimeType,name:this.props.name,hidePopup:this.hidePopup,popupPosition:this.props.popupPosition,popupClassName:"BreakModePopup ToolbarButtonPopup-DefaultStyles",popupWidth:220,isPopupVisible:this.state.shouldShowPopup,menu:this.menu},void 0,nc)}}const sc=(0,fs.Z)(ic,tc);var oc=n(15800);class ac extends Z.Z{getInitialState(){return[]}getLogsByComponent(e){return this.getState().filter((t=>t.component===e))}reduce(e,t){switch(t.actionType){case"COMPONENT_LOGGER_LOG":{let n;return e.length>=1e3?(n=e.slice(1),n.push(t.entry)):n=e.concat(t.entry),n}case"COMPONENT_LOGGER_CLEAR":return e.filter((e=>e.component!==t.component))}return e}}const rc=new ac;var lc,dc=n(17751);function cc(e,t,n,i){lc||(lc="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:lc,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const{mixedToStrings:hc}=kr;function pc(e){switch(e){case"warn":return"warning";case"log":return"info";default:return e}}function uc(e){for(const t of e)if(t instanceof Error)return t}function gc(e){const{component:t,tags:n,level:i,timestamp:s,args:o}=e,a=b()(s).format("HH:mm:ss.SSS"),r=hc(o).join(" "),l=`${a} ${i} [${t} - ${n.join(", ")}] ${r}\r\n`,d=uc(o);return d?`${l}${d.stack}\r\n`:l}function mc(e){const t=tn.useContext(dn.Z);function n(){ui.Z.copyTextToClipboard(gc(e.entry))}const{args:i,level:s,tags:o,timestamp:a}=e.entry,r=uc(i);return cc(Tr,{type:pc(s)},void 0,cc("div",{className:"StatusPopup-LogEntryMessage","data-index":e.index,onContextMenu:function(e){(0,zi.Z)(t.vivaldiWindowId,[{handler:n,...(0,Mn.Z)("verb","Copy")}])(e)}},void 0,cc("span",{className:"StatusPopup-LogEntryTags"},void 0,"[",o.join(", "),"]"),hc(i).join(" "),cc("span",{className:"StatusPopup-LogEntryTimestamp"},void 0,!!r&&cc("span",{className:"StatusPopup-LogEntryStacktrace",title:r.stack,dangerouslySetInnerHTML:{__html:cn.AE4.small}}),b()(a).format("HH:mm:ss.SSS"))))}const vc=function(e){return(0,fn.jsxs)(fn.Fragment,{children:[cc("div",{className:"StatusPopup-List",tabIndex:e.logs.length?"-1":"0"},void 0,e.logs.map(((e,t)=>cc(mc,{entry:e,index:t},e.timestamp+"__"+t)))),!e.hideButtons&&cc("div",{className:"StatusPopup-Footer toolbar-default"},void 0,cc(sl,{onClick:function(){const t=document.createElement("a");t.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e.logs.map(gc).join(""))),t.download=`Vivaldi_${e.component}_log.txt`,t.click()},disabled:0===e.logs.length,title:(0,le.Z)("Save to File")}),cc(sl,{onClick:function(){const t=e.logs.map(gc).join("");ui.Z.copyTextToClipboard(t)},disabled:0===e.logs.length,title:(0,le.Z)("mail","Copy to Clipboard")}),cc(sl,{onClick:()=>dc.Z.clear(e.component),disabled:0===e.logs.length,title:(0,le.Z)("Clear")}))]})};var fc,yc=n(24522),wc=n(81723),bc=n(58821),Cc=n(27856);function Sc(e,t,n,i){fc||(fc="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:fc,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Tc=new DOMParser;function Ic(e){const{start:t,end:n}=(0,bc.aE)(e,!0);let i,s,o="";return e.allDay?(i=b().localeData().longDateFormat("LL"),s=b().localeData().longDateFormat("LL")):(i=(0,bc.KC)(new Date,new Date(t.valueOf()||n.valueOf()))?"LT":b().localeData().longDateFormat("LLL"),s="LT"),e.start&&e.end&&t.valueOf()===n.valueOf()?o=`${t.format(i)}`:e.start&&e.end?o=`${t.format(i)}-${n.format(s)}`:e.end&&(o=`${n.format(i)}`),o}function kc(e){let t="";if(void 0!==e){t=`${b()(e).format("LT")}`}return t}function Ac(e){const t=(0,le.Z)("Ctrl/Cmd-click to follow link");return e.replace(/(href="([^"]*)")/gi,`$1 title="${t}\n\n$2"`)}const Zc=(e,t,n,i)=>{let s=n.trim();if(!s)return null;const o=function(e){for(let t=0;t<e.length;t++)if("<"===e[t]){let n=0;for(let i=t+1;i<e.length;i++){const s=e[i];if("<"===s)n++;else if(">"===s){if(!n){if("/"===e[i-1]){t=i+1;break}{const n=e.slice(t+1,i),s=n.match(/\w+/i)?.[0];if(s){const n=`</${s}>`,o=e.indexOf(n,i);if(-1!==o){t=i+o+n.length+1;break}}e=`${e.slice(0,t)}&lt;${n}&gt;${e.slice(i+1)}`,t=i+6;break}}n--}if(i===e.length-1){e=`${e.slice(0,t)}&lt;${e.slice(t+1)}`;break}}}return e}(s);return s=function(e){return-1===e.indexOf("<")||Tc.parseFromString(e,"text/html").body?.innerText===e}(o)?(e=>{const t=e.match(/(\n|[^\r\n]+)/g);return t&&1!==t.length?t.map((e=>-1!==e.indexOf("\n")?"<br />":e.startsWith("-::")?`<p class="delimiter">${e}</p>`:`<p>${e}</p>`)).join(""):e})(ve(s)):(0,Cc.sanitize)(s,{FORBID_TAGS:["style"]}),(0,fn.jsx)("span",{ref:i,className:`cal-event-${t}`,onClick:t=>function(e,t){const n=t.target.closest("a");n&&t.currentTarget.contains(n)&&n.href&&(t.stopPropagation(),t.preventDefault(),Y.Z.openURL(e,n.href))}(e,t),dangerouslySetInnerHTML:{__html:Ac(s)}},t)},Ec=(e,t,n,i)=>{const s=Lo.Z.getCalendars();if(0===s.length)return Sc("div",{},void 0,(0,le.Z)("You have no calendars set up, event can not be saved"));const o=e.calendarId??Lo.Z.getDefaultCalendar()?.id,a=s.find((e=>e.id===o))??s[0],r=Lo.Z.getAccounts().find((e=>e.id===a.accountId));if(!r)return Sc("div",{},void 0,(0,le.Z)("Calendar account not found. Go to settings and add a calendar account."));if("ical"===r.account_type)return Sc("div",{},void 0,Sc("label",{},void 0,(0,le.Z)("Calendar Name")),Sc("p",{},void 0,a.description||a.name));let l=[];if("google"===r.account_type&&e.task)l=oc.Z.getLocalGoogleTasksCalendars(r);else{const e=Lo.Z.getAccounts().filter((e=>"ical"===e.account_type)).map((e=>e.id));l=(0,wc.Z)(Lo.Z.getCalendars(),e,((e,t)=>e.accountId===t));const t=oc.Z.getLocalGoogleTasksCalendars(r).map((e=>e.id));l=(0,wc.Z)(l,t,((e,t)=>e.id===t))}const d=l.find((e=>e.id===o))??l[0];if(!d){return Sc("p",{className:"info"},void 0,e.task?(0,le.Z)("No task list found. Please go to calendar settings to add one."):(0,le.Z)("No calendar found. Please go to calendar settings to add one."))}return Sc(sl,{className:"CalendarSelector",title:d.description||d.name,image:oc.Z.createCalendarIcon(d,10),menu:()=>function(e){return e.map((e=>{const n=oc.Z.createCalendarIconPNG(e);return{handler:()=>t(e.id),label:e.description||e.name,labelEnglish:e.description||e.name,iconPNG:n,iconPNGWhite:n}}))}(l),menuOrigin:"bottomLeft",tabIndex:n})};var _c,Nc=n(8336),Mc=n(39980),Pc=n(76259),Dc=n.n(Pc);function xc(e,t,n,i){_c||(_c="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:_c,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Oc(e){return e.some((e=>"error"===e.level))}function Lc(e){switch(e.account_type){case"google":return`<img src="${Mc.K}" />`;case"ical":case"caldav":return cn.eTS.small;case"vivaldi":return Dc();default:return cn.bcq.small}}function Rc(e){const[t,n]=tn.useState({}),i=Lo.Z.getAccounts();async function s(t){!function(e){n((t=>({...t,[e.id]:{pending:!0,error:!1,success:!1,message:""}})))}(t);const i=await o.Z.pollCalDAVAccounts(e.windowId,[t.id]),s=oc.Z.getPollResultText(i);!function(e,t,i){n((n=>({...n,[e.id]:{pending:!1,success:!t,error:t,message:i}})))}(t,i.error,s)}return(0,fn.jsxs)(fn.Fragment,{children:[xc("div",{className:"StatusPopup-List"},void 0,i.map((e=>{const n=Lo.Z.getCalendars().filter((t=>t.accountId===e.id)),i=Math.max(...n.map((e=>e.lastChecked)).filter(Boolean));return xc(tn.Fragment,{},e.id,xc("div",{className:"StatusPopup-Account"},void 0,xc("span",{className:"StatusPopup-AccountIcon",dangerouslySetInnerHTML:{__html:Lc(e)}}),xc("span",{className:mn()("StatusPopup-AccountName",{"StatusPopup-AccountName--Local":"local"===e.account_type})},void 0,e.name),"local"!==e.account_type&&xc("div",{className:"StatusPopup-AccountStatus"},void 0,t[e.id]?.pending&&xc("span",{className:"spinner",dangerouslySetInnerHTML:{__html:cn.H0I}}),t[e.id]?.error&&xc("span",{className:"StatusPopup-AccountStatus--Error",title:t[e.id].message,dangerouslySetInnerHTML:{__html:cn.viW}}),t[e.id]?.success&&xc("span",{className:"StatusPopup-AccountStatus--Success",title:t[e.id].message,dangerouslySetInnerHTML:{__html:cn.JLz}}),xc(sl,{onClick:()=>s(e),title:(0,le.Z)("Refresh")})),n.map((e=>{const t=oc.Z.createCalendarIcon(e,8);return xc(tn.Fragment,{},e.id,xc("span",{className:"StatusPopup-CalendarIcon",dangerouslySetInnerHTML:{__html:t}}),xc("span",{className:"StatusPopup-CalendarName"},e.id,e.description||e.name))})),"local"!==e.account_type&&xc("div",{className:"StatusPopup-AccountPoll"},void 0,(0,le.Z)("Last Checked $1",[b()(i).fromNow()]))))}))),xc("div",{className:"StatusPopup-Footer toolbar-default"},void 0,xc(sl,{onClick:()=>async function(e){for(const t of e)await s(t)}(i),title:(0,le.Z)("Refresh All")}))]})}var Bc=xc("dt",{},void 0,"Id"),Fc=xc("dt",{},void 0,"Date"),Uc=xc("dt",{},void 0,"UID"),Vc=xc("dt",{},void 0,"Sequence"),Wc=xc("dt",{},void 0,"Recurrence"),Hc=xc("dt",{},void 0,"Exceptions"),zc=xc("div",{className:"StatusPopup-Footer"});function Gc(e){const{selectedEvent:t}=e;return(0,fn.jsxs)(fn.Fragment,{children:[e.events.length>0&&xc("h3",{},void 0,(0,le.Z)("Upcoming Events")),xc("div",{className:"StatusPopup-List"},void 0,e.events.slice(0,5).map((t=>{const n=oc.Z.getEventColors(t.calendarId);return xc("button",{tabIndex:M.Z.get(D.kKeyboardTabToAll),className:mn()("StatusPopup-Event",{"StatusPopup-Event--AllDay":t.allDay}),onClick:()=>{ie.Z.showCalendar(e.windowId,t.id),e.hidePopup()},style:n},oc.Z.generateKey(t),xc("span",{className:"StatusPopup-EventIcon",dangerouslySetInnerHTML:{__html:oc.Z.getEventSquircle()}}),xc("span",{className:"StatusPopup-EventDate"},void 0,Ic(t)),xc("span",{className:"StatusPopup-EventTitle"},void 0,t.title))}))),t&&xc("dl",{className:"StatusPopup-EventDetail"},void 0,xc("dt",{},void 0,(0,le.Z)("Selected")),xc("dd",{},void 0,t.title),Bc,xc("dd",{},void 0,t.id),Fc,xc("dd",{},void 0,`${b()(t.start).format("l HH:mm")} - ${b().duration(t.start-t.end).humanize()}`),Uc,xc("dd",{},void 0,t.uid),Vc,xc("dd",{},void 0,t.sequence),t.recurrence&&(0,fn.jsxs)(fn.Fragment,{children:[Wc,xc("dd",{},void 0,t.recurrence.toString()),Hc]}),!!t.recurrenceExceptions?.length&&(0,fn.jsx)(fn.Fragment,{children:xc("dd",{},void 0,t.recurrenceExceptions.map(((e,t)=>xc("p",{},t,!!e.date&&`${b()(e.date).format("l HH:mm")}`,` Cancel: ${e.cancelled?.toString()??"false"}`,!!e.exception_event_id&&"0"!==e.exception_event_id&&` Exc. Id: ${e.exception_event_id}`))))})),zc]})}function $c(e){const{events:t}=Lo.Z.getVisibleEvents();return{upcomingEvents:Nc.C.call(t),selectedEvent:Lo.Z.getSelectedEvent(W.Z.getActivePage(e)?.id)}}class Kc extends tn.PureComponent{static contextType=dn.Z;#i;constructor(e,t){super(e);const n=rc.getLogsByComponent("Calendar");this.state={...$c(t.vivaldiWindowId),selectedPane:M.Z.get(D.kCalendarStatusSelectedPane),logs:n,hasLoggedError:Oc(n)}}componentDidMount(){Lo.Z.addListener(this._onStoreChange),rc.addListener(this._onLogsUpdated),this.#i=setInterval((()=>this._onStoreChange("calendarDataReady")),yc.lb)}componentWillUnmount(){rc.removeListener(this._onLogsUpdated),this.#i&&clearInterval(this.#i),Lo.Z.removeListener(this._onStoreChange)}_onLogsUpdated=()=>{const e=rc.getLogsByComponent("Calendar");this.setState({hasLoggedError:Oc(e)})};_onStoreChange=e=>{"calendarDataReady"===e&&this.setState($c(this.context.vivaldiWindowId))};_selectPane=e=>{nt.Z.set(D.kCalendarStatusSelectedPane,e),this.setState({selectedPane:e})};_viewLog=()=>{d.Z.devtoolsPrivate.toggleDevtools("console"),this.props.hidePopup()};_startChangeListeners=()=>{o.Z.startAPIChangeListeners(),this.props.hidePopup()};openCalendarSettings=()=>{ie.Z.showSettings(this.context.vivaldiWindowId,"calendar"),this.props.hidePopup()};getContextMenu=()=>[{handler:this.openCalendarSettings,...(0,Mn.Z)("Calendar Settings")},{handler:this._viewLog,...(0,Mn.Z)("View Log")},{handler:this._startChangeListeners,...(0,Mn.Z)("Start Calendar Change Listeners")}];render(){return(0,fn.jsxs)(fn.Fragment,{children:[xc("div",{className:"StatusPopup-Header"},void 0,xc("h2",{},void 0,(0,le.Z)("Calendar Status")),xc("div",{className:"toolbar button-popup-header-toolbar toolbar-default"},void 0,xc(sl,{onClick:()=>{ie.Z.showCalendar(this.context.vivaldiWindowId),this.props.hidePopup()},menuOrigin:"bottomLeft",title:(0,le.Z)("Show Calendar")}),xc(sl,{menuOrigin:"bottomLeft",image:cn.bqs.small,menu:this.getContextMenu,tooltip:(0,le.Z)("Settings")}))),xc("div",{className:"toolbar toolbar-default"},void 0,xc("div",{className:"toolbar-group equal-width"},void 0,xc(sl,{title:(0,le.Z)("Events"),isPressed:"events"===this.state.selectedPane,onClick:()=>this._selectPane("events")}),xc(sl,{title:(0,le.Z)("Accounts"),isPressed:"accounts"===this.state.selectedPane,onClick:()=>this._selectPane("accounts")}),xc(sl,{title:(0,le.Z)("Logs"),isPressed:"logs"===this.state.selectedPane,onClick:()=>this._selectPane("logs"),badgeText:this.state.hasLoggedError?"!":""}))),xc("div",{className:"StatusPopup-Content"},void 0,xc("div",{className:"StatusPopup-ContentPane"},void 0,"accounts"===this.state.selectedPane&&xc(Rc,{windowId:this.context.vivaldiWindowId}),"events"===this.state.selectedPane&&xc(Gc,{windowId:this.context.vivaldiWindowId,events:this.state.upcomingEvents,selectedEvent:this.state.selectedEvent,hidePopup:this.props.hidePopup}),"logs"===this.state.selectedPane&&xc(vc,{logs:this.state.logs,component:"Calendar"})))]})}}const jc=Kc,Yc=new class{open(e,t){l.Z.dispatch({actionType:"STATUS_POPUP_OPEN",component:e,pane:t})}close(e){l.Z.dispatch({actionType:"STATUS_POPUP_CLOSE",component:e})}},Xc={calendarPopupOpen:!1,mailPopupOpen:!1};class Qc extends Z.Z{getInitialState(){return Xc}isOpen(e){switch(e){case"Calendar":return this.getState().calendarPopupOpen;case"Mail":return this.getState().mailPopupOpen}}reduce(e,t){switch(t.actionType){case"STATUS_POPUP_OPEN":return t.pane&&("Mail"===t.component?nt.Z.set(D.kMailStatusSelectedPane,t.pane):"Calendar"===t.component&&nt.Z.set(D.kCalendarStatusSelectedPane,t.pane)),{mailPopupOpen:"Mail"===t.component,calendarPopupOpen:"Calendar"===t.component};case"STATUS_POPUP_CLOSE":if(this.isOpen(t.component))return Xc}return e}}const qc=new Qc;var Jc;function eh(e,t,n,i){Jc||(Jc="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Jc,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const th=[D.kCalendarStatusButtonStyle,D.kMailIsTurnedOff];class nh extends tn.PureComponent{static contextType=dn.Z;state={isPopupOpen:!1,lastPoll:0};componentDidMount=()=>{qc.addListener(this.popupStateChanged)};componentWillUnmount=()=>{qc.removeListener(this.popupStateChanged)};popupStateChanged=()=>{const e=qc.getState().calendarPopupOpen;this.setState({isPopupOpen:e})};hidePopup=()=>{this.setState({isPopupOpen:!1}),Yc.close("Calendar")};togglePopup=()=>{this.setState((e=>({isPopupOpen:!e.isPopupOpen})))};openCalendarSettings=()=>{ie.Z.showSettings(this.context.vivaldiWindowId,"calendar")};getTooltip=()=>(0,le.Z)("Calendar Status");menu=()=>{const e=this.props.prefValues[D.kCalendarStatusButtonStyle];return[{handler:this.openCalendarSettings,...(0,Mn.Z)("Calendar Settings")},{items:[{type:"checkbox",checked:"imageandtext"===e,handler:()=>nt.Z.set(D.kCalendarStatusButtonStyle,"imageandtext"),...(0,Mn.Z)("Image and Text")},{type:"checkbox",checked:"image"===e,handler:()=>nt.Z.set(D.kCalendarStatusButtonStyle,"image"),...(0,Mn.Z)("Image Only")},{type:"checkbox",checked:"text"===e,handler:()=>nt.Z.set(D.kCalendarStatusButtonStyle,"text"),...(0,Mn.Z)("title","Text Only")}],...(0,Mn.Z)("Button Style")}]};render(){if(!(!this.props.prefValues[D.kMailIsTurnedOff]&&z.ZP.isMail(this.context.vivaldiWindowId)||this.props.preview))return null;const e=this.props.prefValues[D.kCalendarStatusButtonStyle],t=!z.ZP.isMail(this.context.vivaldiWindowId);return eh(sl,{badgeText:"",className:"StatusButton",disabled:t,onClick:this.togglePopup,customizeMenu:this.props.customizeMenu,menuOrigin:this.props.menuOrigin,tooltip:this.getTooltip(),title:"image"!==e?(0,le.Z)("Calendar Status"):void 0,image:"text"!==e?cn.bcq[this.props.size]:void 0,draggable:this.props.draggable,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,onDrop:this.props.onDrop,onDragEnter:this.props.onDragEnter,mimeType:this.props.mimeType,name:this.props.name,hidePopup:this.hidePopup,popupPosition:this.props.popupPosition,popupClassName:"StatusPopup",popupWidth:400,isPopupVisible:this.state.isPopupOpen,menu:this.menu},void 0,eh(jc,{hidePopup:this.hidePopup}))}}const ih=(0,fs.Z)(nh,th),sh={getTimeFormat:()=>M.Z.get(D.kClockShowSeconds)?"LTS":"LT",getDateFormat:()=>F.ZP.getShortDateFormat(),getTimeAndDateFormat:()=>sh.getDateFormat()+"  "+sh.getTimeFormat(),setTimer:(e,t)=>{const n=new Date;if(e.date<n){const t=new Date(e.date);t.setDate(t.getDate()+1),e.date=t.valueOf()}nt.Z.set(D.kClockTimers,[...M.Z.get(D.kClockTimers),{...e,type:t,id:Qr()()}])},removeTimer:e=>{const t=M.Z.get(D.kClockTimers).filter((t=>e!==t.id));nt.Z.set(D.kClockTimers,t)},completeTimer:e=>{const t=M.Z.get(D.kClockNotificationSound),n={title:sh.getName(e),silent:!1,requireInteraction:!0};if(t){new Audio(t).play()}(0,Ct.c)(n)},getName:e=>e.name||("alarm"===e.type?(0,le.Z)("Alarm"):(0,le.Z)("Countdown")),getActiveLabel:(e,t)=>{const n=b()(e.date),i=b().duration(n.diff(new Date)),s=i.hours(),o=i.minutes();let a;if(a="alarm"===e.type?n.format("LT"):s&&o?(0,le.Z)("$1h $2m",[s,o]):s?(0,le.Z)("$1h",[s]):o?(0,le.Z)("$1m",[o]):(0,le.Z)("Now"),t){return`${a} - ${sh.getName(e)}`}return a},getAlarm:e=>M.Z.get(D.kClockTimers).find((t=>t.id===e&&"alarm"===t.type)),setAlarmWithPreset:e=>{const t=new Date;t.setSeconds(0),t.setHours(e.hour),t.setMinutes(e.minute);const n={name:e.name,date:t.valueOf()};sh.setTimer(n,"alarm")},getAlarmPreset:e=>M.Z.get(D.kClockAlarmPresets).find((t=>t.id===e)),saveAlarmPreset:(e,t,n)=>{const i=Qr()();nt.Z.set(D.kClockAlarmPresets,[...M.Z.get(D.kClockAlarmPresets),{name:e,hour:t,minute:n,id:i}])},removeAlarmPreset:e=>{const t=M.Z.get(D.kClockAlarmPresets).filter((t=>t.id!==e));nt.Z.set(D.kClockAlarmPresets,t)},getCountdown:e=>M.Z.get(D.kClockTimers).find((t=>t.id===e&&"countdown"===t.type)),setCountdownWithPreset:e=>{const t=new Date,n={name:e.name,date:t.setSeconds(t.getSeconds()+e.seconds).valueOf()};sh.setTimer(n,"countdown")},getCountdownPreset:e=>M.Z.get(D.kClockCountdownPresets).find((t=>t.id===e)),saveCountdownPreset:(e,t)=>{const n=Qr()();nt.Z.set(D.kClockCountdownPresets,[...M.Z.get(D.kClockCountdownPresets),{name:e,seconds:t,id:n}])},removeCountdownPreset:e=>{const t=M.Z.get(D.kClockCountdownPresets).filter((t=>t.id!==e));nt.Z.set(D.kClockCountdownPresets,t)}},oh=sh;var ah,rh=n(34155);function lh(e,t,n,i){ah||(ah="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:ah,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const dh=["hour","minute","meridiem"],ch=function(e){return 1===e.length?`0${e}`:e.length>2?e.slice(e.length-2):e};var hh=lh("span",{className:"dateInputSeparator"},void 0,":");class ph extends tn.PureComponent{_focused=!1;hidden=tn.createRef();fieldRefs={hour:tn.createRef(),minute:tn.createRef(),meridiem:tn.createRef()};hr12="";constructor(e){super(e);const t=this.getFormat().replace(/[hm:]/gi,"").trim();t&&(this.hr12=t);const[n="",i=""]=this.props.value.split(":");this.state={hour:n,minute:i,dateCache:b()(`2010-10-20 ${this.props.value}`)}}componentDidUpdate(e){e.value!==this.props.value&&this.setCache()}getFormat=()=>this.props.format||b()().localeData().longDateFormat("LT");setCache=()=>{const[e="",t=""]=this.props.value.split(":");this.setState({hour:e,minute:t,dateCache:b()(`2010-10-20 ${this.props.value}`)})};processChange=e=>{1!==this.state.hour.length&&1!==this.state.minute.length&&this.props.onChange(e)};select=e=>{e.target instanceof HTMLInputElement&&(e.preventDefault(),e.target.select())};focus=()=>{this.fieldRefs.hour.current?.focus()};onKeyDown=e=>{const{key:t,target:n}=e,i=n.dataset.type;if(t){const n=dh.indexOf(i);switch(t){case"ArrowRight":e.preventDefault();const t=n+1===dh.length?n:n+1;return void this.fieldRefs[dh.slice(t,t+1)[0]].current?.select();case"ArrowLeft":e.preventDefault();const i=0===n?n:n-1;return void this.fieldRefs[dh.slice(i,i+1)[0]].current?.select()}}isNaN(Number(t))&&rh.nextTick((()=>{document.activeElement instanceof HTMLInputElement&&document.activeElement.select()}))};skipToNextField(e){const t=this.hr12?3:2,n=dh.indexOf(e)+1;n===t&&M.Z.get(D.kCalendarAutoTabDatetime)?as(document):rh.nextTick((()=>{const e=dh[Math.min(n,t-1)];this.fieldRefs[e].current?.select()}))}switchMeridiem=e=>{const{target:t}=e,n="string"==typeof e.key?e.key:"",i=this.state.dateCache.set("minute",parseInt(this.state.minute)).add(12,"hour"),{type:s}=e.target.dataset;"meridiem"===s&&("ArrowUp"===n||"ArrowDown"===n||"wheel"===e.type&&t===document.activeElement||n.toLowerCase()===i.format("a")[0].toLowerCase())&&(e.preventDefault(),this.setInput(i),this.setState({dateCache:i})),!M.Z.get(D.kCalendarAutoTabDatetime)||"a"!==n.toLowerCase()&&"p"!==n.toLowerCase()?this.onKeyDown(e):as(document)};onChangeTime=e=>{const{type:t}=e.target.dataset;let n=parseInt(e.target.value);const i=!e.nativeEvent.inputType,s=i&&this.props.step?parseInt(this.props.step):1;let o=!1;if(i&&"minute"===t&&n%s!=0){const e=parseInt(this.state.minute);o=!0,n<e?n=e-n%s:n-=n%s}const a="minute"===t?59:this.hr12?12:23,r="minute"===t?60:this.hr12?12:24;n>a?i?n%=r:this.hr12&&"hour"===t?(n%=r,this.state.dateCache.hour(n+12)):n=a:n<0&&(n=i?(n+r)%r:0);let l=n.toString();i&&(l=ch(l)),o&&e.target.setAttribute("value",l),!i&&(10*n>a||e.target.value.length>=2)&&(l=ch(l),this.skipToNextField(t)),this.setState({[t]:l},(()=>{let{hour:e}=this.state;this.hr12&&parseInt(e)<12&&"pm"===this.state.dateCache.format(this.hr12).toLowerCase()&&(e=parseInt(e)+12);const t=b()(this.state.dateCache).set("hour",parseInt(e)).set("minute",parseInt(this.state.minute));t.isValid()&&this.setInput(t)}))};setInput=e=>{const t=this.hidden.current,n=(Object.getOwnPropertyDescriptor(HTMLInputElement.prototype,"value")||{}).set;t&&n&&(n.call(t,(0,F.mr)(e)),t.dispatchEvent(new Event("input",{bubbles:!0})))};onFocus=e=>{if(e.persist(),e.preventDefault(),this._focused||!(e.target instanceof HTMLElement))return;const t=e.target.closest(".dateInput");rh.nextTick((()=>{this.props.onFocus&&t instanceof HTMLElement&&ss(t)&&(this._focused=!0,this.props.onFocus(e))}))};onBlur=e=>{const{hour:t,minute:n}=this.state;(t.length<2||n.length<2)&&this.setState({hour:ch(t),minute:ch(n)}),e.preventDefault(),e.persist();const i=e.target.closest(".dateInput");rh.nextTick((()=>{this.props.onBlur&&i instanceof HTMLElement&&!ss(i)&&(this._focused=!1,this.props.onBlur(e))}))};keepFocusWithin=e=>{e.preventDefault(),ss(e.target.nextElementSibling)||this.focus()};renderFields=()=>{const e=this.getFormat().replace(/[hma:]/gi,""),t={onFocus:this.select,onMouseDown:this.select,onMouseUp:e=>e.preventDefault(),onKeyDown:this.onKeyDown,onChange:this.onChangeTime,disabled:this.props.disabled};let n=this.state.hour;return 1!==n.length&&(n=this.hr12?ch(((parseInt(this.state.hour)+11)%12+1).toString()):this.state.hour),lh("span",{className:"faux time"},void 0,(0,fn.jsx)("input",{...t,className:"dateInputHour",tabIndex:this.props.tabIndex,type:"number",ref:this.fieldRefs.hour,"data-type":"hour",placeholder:(0,le.Z)("hh"),value:n}),hh,(0,fn.jsx)("input",{...t,className:"dateInputMinute",type:"number",ref:this.fieldRefs.minute,"data-type":"minute",tabIndex:this.props.tabIndex,step:this.props.step,placeholder:(0,le.Z)("time","mm"),value:this.state.minute}),this.hr12&&lh("span",{},void 0,e),this.hr12&&(0,fn.jsx)("input",{...t,type:"text",ref:this.fieldRefs.meridiem,"data-type":"meridiem",className:"dateInputAmPm",tabIndex:this.props.tabIndex,placeholder:"--",value:this.state.dateCache.format(this.hr12).trim(),onKeyDown:this.switchMeridiem,onWheel:this.switchMeridiem,onChange:this.select}))};render(){return lh("span",{className:"dateInput time",title:this.props.title,onBlur:this.onBlur,onFocus:this.onFocus},void 0,(0,fn.jsx)("input",{type:"time",ref:this.hidden,tabIndex:"-1",className:"dateInputHidden",value:this.props.value,disabled:this.props.disabled,onMouseDown:this.keepFocusWithin,onChange:this.processChange}),this.renderFields())}}const uh=ph;var gh;function mh(e,t,n,i){gh||(gh="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:gh,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const vh=[D.kKeyboardTabToAll,D.kClockAlarmPresets,D.kClockTimers];class fh extends tn.PureComponent{state={selectedPresetId:null,name:""};isPresetSelected=e=>e.id===this.state.selectedPresetId&&e.name===this.state.name&&this.props.minute===e.minute&&this.props.hour===e.hour;setAlarm=()=>{const e=this.state.name,t=new Date;t.setHours(this.props.hour),t.setMinutes(this.props.minute),t.setSeconds(0),this.setState({selectedPresetId:null,name:""},(()=>{this.props.hidePopup({name:e,date:t.valueOf()},"alarm")}))};setName=e=>{this.setState({name:e.currentTarget.value})};selectPreset=e=>{const t=e.name,n=e.id;this.props.setHour(e.hour),this.props.setMinute(e.minute),this.setState({name:t,selectedPresetId:n})};timeChange=e=>{const t=e.currentTarget.value.split(":"),n=parseInt(t[0]),i=parseInt(t[1]);this.props.setHour(n),this.props.setMinute(i)};savePreset=()=>{oh.saveAlarmPreset(this.state.name,this.props.hour,this.props.minute)};setPreview=()=>{this.props.setMode("alarm")};render(){const e=this.props.prefValues[D.kClockAlarmPresets],t=this.state.selectedPresetId&&oh.getAlarmPreset(this.state.selectedPresetId),n=this.props.alarms,i=new Date;i.setHours(this.props.hour),i.setMinutes(this.props.minute);const s=[],o=[];return n.forEach((e=>{this.props.now.valueOf()<e.date?s.push(e):o.push(e)})),mh("div",{className:"ClockPopup-Alarms"},void 0,mh("div",{className:"ClockPopup-Presets"},void 0,e.map((e=>{const n=t&&this.isPresetSelected(e);return mh("div",{className:"ClockPopup-PresetWrapper"},e.id,mh("button",{className:mn()("ClockPopup-Preset",{"ClockPopup-Preset--selected":n}),tabIndex:this.props.prefValues[D.kKeyboardTabToAll],onClick:()=>this.selectPreset(e)},void 0,e.name),mh("button",{className:mn()("ClockPopup-Preset-Clear",{"ClockPopup-Preset-Clear--selected":n}),tabIndex:this.props.prefValues[D.kKeyboardTabToAll],onClick:()=>oh.removeAlarmPreset(e.id),dangerouslySetInnerHTML:{__html:cn.kze}}))}))),mh("form",{className:"ClockPopup-Custom",onSubmit:this.setAlarm},void 0,mh("div",{className:"ClockPopup-Custom-Line"},void 0,mh("label",{className:"ClockPopup-TimeField"},void 0,mh("h3",{},void 0,(0,le.Z)("Time")),mh(uh,{className:"ClockPopup-DateInputField",onChange:this.timeChange,step:"5",title:(0,le.Z)("Alarm time"),onFocus:this.setPreview,value:b()(i).format("HH:mm")})),mh("label",{className:"ClockPopup-TimeField"},void 0,mh("h3",{},void 0,(0,le.Z)("Alarm preset","Name")),mh("input",{className:"ClockPopup-Name",type:"text",onFocus:this.setPreview,placeholder:(0,le.Z)("Alarm preset","Name"),onChange:this.setName,value:this.state.name}))),mh("div",{className:"ClockPopup-Custom-Line ClockPopup-Custom-Line--wrap"},void 0,mh("input",{disabled:this.state.name.length<2||t&&t.name===this.state.name,className:"ClockPopup-SavePreset",type:"button",onClick:this.savePreset,value:(0,le.Z)("Save Preset")}),mh("input",{disabled:0===this.props.hour&&0===this.props.minute,className:"ClockPopup-Start",type:"submit",value:(0,le.Z)("Start")}))))}}const yh=(0,fs.Z)(fh,vh);var wh;function bh(e,t,n,i){wh||(wh="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:wh,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ch=[D.kKeyboardTabToAll,D.kClockCountdownPresets,D.kClockTimers];class Sh extends tn.PureComponent{state={selectedPresetId:null,name:""};isPresetSelected=e=>{const t=60*this.props.minute+3600*this.props.hour;return e.id===this.state.selectedPresetId&&e.name===this.state.name&&t===e.seconds};setCountdown=()=>{const e=this.state.name,t=b()().add(this.props.hour,"hours").add(this.props.minute,"minutes").valueOf();this.setState({selectedPresetId:null,name:""},(()=>{this.props.hidePopup({name:e,date:t},"countdown")}))};setMinute=e=>{const{value:t}=e.currentTarget,n=Math.min(Math.max(parseInt(t),0),59);this.props.setMinute(n)};setHour=e=>{const{value:t}=e.currentTarget,n=Math.min(Math.max(parseInt(t),0),23);this.props.setHour(n)};decrementHour=()=>{this.props.setHour(this.props.hour-1)};incrementHour=()=>{this.props.setHour(this.props.hour+1)};decrementMinute=()=>{this.props.setMinute(this.props.minute-1)};incrementMinute=()=>{this.props.setMinute(this.props.minute+1)};setName=e=>{this.setState({name:e.currentTarget.value})};setPreview=()=>{this.props.setMode("countdown")};selectPreset=e=>{const t=b().duration(e.seconds,"seconds"),n=e.name,i=t.hours(),s=t.minutes();this.props.setHour(i),this.props.setMinute(s),this.setState({name:n,selectedPresetId:e.id})};savePreset=()=>{const e=60*this.props.hour*60+60*this.props.minute;oh.saveCountdownPreset(this.state.name,e)};render(){const e=this.props.prefValues[D.kClockCountdownPresets],t=this.state.selectedPresetId&&oh.getCountdownPreset(this.state.selectedPresetId),n=this.props.countdowns,i=[],s=[];return n.forEach((e=>{this.props.now.valueOf()<e.date?i.push(e):s.push(e)})),bh("div",{className:"ClockPopup-Countdowns"},void 0,bh("div",{className:"ClockPopup-Presets"},void 0,e.map((e=>{const n=t&&this.isPresetSelected(e);return bh("div",{className:"ClockPopup-PresetWrapper"},e.id,bh("button",{className:mn()("ClockPopup-Preset",{"ClockPopup-Preset--selected":n}),tabIndex:this.props.prefValues[D.kKeyboardTabToAll],onClick:()=>this.selectPreset(e)},void 0,e.name),bh("button",{className:mn()("ClockPopup-Preset-Clear",{"ClockPopup-Preset-Clear--selected":n}),tabIndex:this.props.prefValues[D.kKeyboardTabToAll],onClick:()=>oh.removeCountdownPreset(e.id),dangerouslySetInnerHTML:{__html:cn.kze}}))}))),bh("form",{className:"ClockPopup-Custom",onSubmit:this.setCountdown},void 0,bh("div",{className:"ClockPopup-Custom-Line"},void 0,bh("label",{className:"ClockPopup-TimeField"},void 0,bh("h3",{},void 0,(0,le.Z)("Hours")),bh("input",{className:"ClockPopup-DateInputField",type:"number","data-type":"hour",step:1,min:0,max:23,onFocus:this.setPreview,placeholder:(0,le.Z)("hh"),onChange:this.setHour,value:this.props.hour}),bh("div",{className:"ClockPopup-Spinner-Wrapper"},void 0,bh("button",{tabIndex:this.props.prefValues[D.kKeyboardTabToAll],disabled:23===this.props.hour,onClick:this.incrementHour,type:"button",className:"ClockPopup-Spinner ClockPopup-Spinner--up"}),bh("button",{tabIndex:this.props.prefValues[D.kKeyboardTabToAll],disabled:0===this.props.hour,type:"button",onClick:this.decrementHour,className:"ClockPopup-Spinner ClockPopup-Spinner--down"}))),bh("label",{className:"ClockPopup-TimeField"},void 0,bh("h3",{},void 0,(0,le.Z)("Minutes")),bh("input",{className:"ClockPopup-DateInputField",type:"number","data-type":"minute",step:1,min:0,max:59,placeholder:(0,le.Z)("time","mm"),onChange:this.setMinute,onFocus:this.setPreview,value:this.props.minute}),bh("div",{className:"ClockPopup-Spinner-Wrapper"},void 0,bh("button",{tabIndex:this.props.prefValues[D.kKeyboardTabToAll],disabled:59===this.props.minute,onClick:this.incrementMinute,type:"button",className:"ClockPopup-Spinner ClockPopup-Spinner--up"}),bh("button",{tabIndex:this.props.prefValues[D.kKeyboardTabToAll],disabled:0===this.props.minute,onClick:this.decrementMinute,type:"button",className:"ClockPopup-Spinner ClockPopup-Spinner--down"}))),bh("label",{className:"ClockPopup-TimeField"},void 0,bh("h3",{},void 0,(0,le.Z)("Countdown preset","Name")),bh("input",{className:"ClockPopup-Name",type:"text",placeholder:(0,le.Z)("Countdown preset","Name"),onChange:this.setName,onFocus:this.setPreview,value:this.state.name}))),bh("div",{className:"ClockPopup-Custom-Line ClockPopup-Custom-Line--wrap"},void 0,bh("input",{disabled:this.state.name.length<2||t&&t.name===this.state.name,className:"ClockPopup-SavePreset",type:"button",onClick:this.savePreset,value:(0,le.Z)("Save Preset")}),bh("input",{disabled:0===this.props.hour&&0===this.props.minute,className:"ClockPopup-Start",type:"submit",value:(0,le.Z)("Start")}))))}}const Th=(0,fs.Z)(Sh,Ch);var Ih;function kh(e,t,n,i){Ih||(Ih="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Ih,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ah=[D.kKeyboardTabToAll,D.kClockShowSeconds,D.kClockMode];class Zh extends tn.PureComponent{constructor(e){super(e),this.state={alarmHour:13,alarmMinute:37,countdownHour:0,countdownMinute:0,previewMode:"alarm"===this.props.prefValues[D.kClockMode]?"alarm":"countdown"}}setAlarmHour=e=>{this.setState({alarmHour:e})};setAlarmMinute=e=>{this.setState({alarmMinute:e})};setCountdownHour=e=>{this.setState({countdownHour:e})};setCountdownMinute=e=>{this.setState({countdownMinute:e})};setMode=e=>{nt.Z.set(D.kClockMode,e),this.setState({previewMode:e})};setPreviewMode=e=>{this.setState({previewMode:e})};getClockStyle=()=>{const e=this.props.now.getHours(),t=this.props.prefValues[D.kClockShowSeconds]?this.props.now.getSeconds():0,n=this.props.now.getMinutes(),i=n/60,s={"--hourDeg":(e+i)%12*30-90+"deg","--minuteDeg":6*n+"deg","--secondDeg":this.props.prefValues[D.kClockShowSeconds]?6*t+360*n+60*e*360+"deg":"0deg"};if("countdown"===this.state.previewMode&&(s["--hourPercent"]=this.state.countdownHour<12?this.state.countdownHour/.12:100,s["--minutePercent"]=this.state.countdownMinute/.6),"alarm"===this.state.previewMode){const t=this.state.alarmHour>e?this.state.alarmHour-e:this.state.alarmHour-e+60,o=t>0?t-i:0,a=this.state.alarmMinute>n?this.state.alarmMinute-n:this.state.alarmMinute-n+60;s["--hourPercent"]=o<12?o/.12:100,s["--minutePercent"]=a/.6}return s};getInfoText=e=>{const t=e.filter((e=>"alarm"===e.type)),n=e.filter((e=>"countdown"===e.type));return t.length>0&&n.length>0?(0,le.Z)("$1 alarm","$1 alarms",[t.length])+", "+(0,le.Z)("$1 countdown","$1 countdowns",[n.length]):t.length>0?(0,le.Z)("$1 alarm","$1 alarms",[t.length]):n.length>0?(0,le.Z)("$1 countdown","$1 countdowns",[n.length]):b()().format(oh.getTimeAndDateFormat())};render(){const e=this.props.timers,t=e.filter((e=>this.props.now.valueOf()<e.date)),n=e.filter((e=>this.props.now.valueOf()>e.date));return(0,fn.jsxs)(fn.Fragment,{children:[kh("div",{className:"ClockPopup-Header"},void 0,kh("h2",{},void 0,(0,le.Z)("Clock")),kh("div",{className:"info"},void 0,this.getInfoText(t))),kh("div",{className:"popup-scrollarea"},void 0,kh("div",{style:this.getClockStyle(),className:mn()("ClockPopup-BigClock",{"ClockPopup-BigClock--ShowSeconds":this.props.prefValues[D.kClockShowSeconds]}),dangerouslySetInnerHTML:{__html:cn.gep}}),kh("div",{className:"ClockPopup-Active"},void 0,t.map(((e,t)=>kh("div",{className:"ClockPopup-Timer ClockPopup-Timer--Active"},e.id,kh("button",{className:"ClockPopup-Timer-Name"},void 0,oh.getActiveLabel(e,!0)),kh("button",{className:"ClockPopup-Timer-Clear",tabIndex:this.props.prefValues[D.kKeyboardTabToAll],onClick:()=>oh.removeTimer(e.id),dangerouslySetInnerHTML:{__html:cn.kze}}))))),n.length>0&&(0,fn.jsxs)(fn.Fragment,{children:[kh("h2",{},void 0,(0,le.Z)("Past Timers")),kh("div",{className:"ClockPopup-Passed"},void 0,n.map((e=>kh("div",{className:"ClockPopup-Timer ClockPopup-Timer--Passed"},e.id,kh("button",{tabIndex:this.props.prefValues[D.kKeyboardTabToAll],className:"ClockPopup-Timer-Name"},void 0,oh.getName(e)),kh("button",{className:"ClockPopup-Timer-Clear",tabIndex:this.props.prefValues[D.kKeyboardTabToAll],onClick:()=>oh.removeTimer(e.id),dangerouslySetInnerHTML:{__html:cn.kze}})))))]}),kh("div",{className:"toolbar toolbar-default"},void 0,kh("div",{className:"toolbar-group"},void 0,kh(sl,{title:(0,le.Z)("Countdown"),isPressed:"countdown"===this.props.prefValues[D.kClockMode],onClick:()=>this.setMode("countdown")}),kh(sl,{title:(0,le.Z)("Alarm"),isPressed:"alarm"===this.props.prefValues[D.kClockMode],onClick:()=>this.setMode("alarm")}))),"countdown"===this.props.prefValues[D.kClockMode]&&kh(Th,{now:this.props.now,hour:this.state.countdownHour,minute:this.state.countdownMinute,hidePopup:this.props.hidePopup,setHour:this.setCountdownHour,setMinute:this.setCountdownMinute,setMode:this.setPreviewMode,countdowns:e.filter((e=>"countdown"===e.type))}),"alarm"===this.props.prefValues[D.kClockMode]&&kh(yh,{now:this.props.now,alarms:e.filter((e=>"alarm"===e.type)),hidePopup:this.props.hidePopup,hour:this.state.alarmHour,minute:this.state.alarmMinute,setHour:this.setAlarmHour,setMode:this.setPreviewMode,setMinute:this.setAlarmMinute}))]})}}const Eh=(0,fs.Z)(Zh,Ah);var _h;function Nh(e,t,n,i){_h||(_h="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:_h,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Mh=[D.kClockButtonShowDate,D.kClockButtonShowName,D.kClockButtonStyle,D.kClockAlarmPresets,D.kClockCountdownPresets,D.kClockNotificationSound,D.kClockShowSeconds,D.kClockTimers],Ph={"":(0,le.Z)("other","None"),"../../resources/notification_ding.opus":(0,le.Z)("Ding"),"../../resources/notification_rooster.opus":(0,le.Z)("Rooster"),"../../resources/notification_tada.opus":(0,le.Z)("Tada")};class Dh extends tn.PureComponent{buttonRef=tn.createRef();constructor(e){super(e),this.now=new Date,this.state={isPopupOpen:!1,hour:this.now.getHours(),minute:this.now.getMinutes()}}componentDidMount(){this.intervalRef=setInterval(this.heartbeat,1e3)}componentWillUnmount(){clearInterval(this.intervalRef)}heartbeat=()=>{this.now=new Date;const e=this.now.getMinutes(),t=this.now.getHours();let n=!1;e!==this.state.minute&&t!==this.state.hour?(this.setState({hour:t,minute:e}),n=!0):e!==this.state.minute?(this.setState({minute:e}),n=!0):this.props.prefValues[D.kClockShowSeconds]&&(this.forceUpdate(),n=!0),this.props.prefValues[D.kClockTimers].forEach((e=>{Math.round(e.date/1e3)===Math.round(this.now.valueOf()/1e3)&&(n||this.forceUpdate(),oh.completeTimer(e))}))};getActiveTimers=()=>this.props.prefValues[D.kClockTimers].slice().sort(((e,t)=>e.date-t.date)).filter((e=>this.now.valueOf()<e.date));getFirstTimer=()=>this.getActiveTimers()[0];getActiveMode=()=>{const e=this.getFirstTimer();return e?e.type:"time"};hidePopup=(e,t)=>{this.state.isPopupOpen&&this.setState({isPopupOpen:!1},(()=>{e&&t&&setTimeout((()=>{oh.setTimer(e,t)}),120)}))};togglePopup=()=>{this.setState((e=>({isPopupOpen:!e.isPopupOpen})))};getClockStyle=()=>{const e=this.getFirstTimer(),t=this.now.getHours(),n=this.now.getMinutes(),i={"--hourDeg":30*(t+n/60)-90+"deg","--minuteDeg":6*n+360*t+"deg"};if(e&&"countdown"===e.type){const t=b()(e.date).diff(this.now,"seconds"),n=b().duration(t,"seconds"),s=n.hours();i["--countdownHourPercent"]=s%12/.12,i["--countdownMinutePercent"]=s>0?100:n.minutes()/.6}return i};getButtonText=()=>{const e="image"!==this.props.prefValues[D.kClockButtonStyle],t=this.props.prefValues[D.kClockButtonShowDate],n=this.props.prefValues[D.kClockButtonShowName],i=this.getFirstTimer();return e&&i&&"countdown"===i.type?oh.getActiveLabel(i,n):e&&t?b()(this.now).format(oh.getTimeAndDateFormat()):e?b()(this.now).format(oh.getTimeFormat()):t?b()(this.now).format(oh.getDateFormat()):void 0};getTooltip=()=>{const e=this.getActiveTimers();let t=b()(this.now).format("LL LT");if(e.length>0){const n=e.filter((e=>"countdown"===e.type)),i=e.filter((e=>"alarm"===e.type));n.length>0&&(t+="\n\n"+(0,le.Z)("Countdowns"),n.forEach((e=>{t+="\n"+oh.getActiveLabel(e,!0)}))),i.length>0&&(t+="\n\n"+(0,le.Z)("Alarms"),i.forEach((e=>{t+="\n"+oh.getActiveLabel(e,!0)})))}return t};menu=()=>{const e=this.props.prefValues[D.kClockButtonStyle];return[{visible:this.props.prefValues[D.kClockCountdownPresets].length>0,items:this.props.prefValues[D.kClockCountdownPresets].map((e=>({handler:()=>oh.setCountdownWithPreset(e),...(0,Mn.Z)(e.name)}))),...(0,Mn.Z)("New Countdown")},{visible:this.props.prefValues[D.kClockAlarmPresets].length>0,items:this.props.prefValues[D.kClockAlarmPresets].map((e=>({handler:()=>oh.setAlarmWithPreset(e),...(0,Mn.Z)(e.name)}))),...(0,Mn.Z)("New Alarm")},{items:[{type:"checkbox",checked:"imageandtext"===e,handler:()=>nt.Z.set(D.kClockButtonStyle,"imageandtext"),...(0,Mn.Z)("Image and Text")},{type:"checkbox",checked:"image"===e,handler:()=>nt.Z.set(D.kClockButtonStyle,"image"),...(0,Mn.Z)("Image Only")},{type:"checkbox",checked:"text"===e,handler:()=>nt.Z.set(D.kClockButtonStyle,"text"),...(0,Mn.Z)("title","Text Only")}],...(0,Mn.Z)("Button Style")},{items:[{type:"checkbox",checked:this.props.prefValues[D.kClockButtonShowName],handler:()=>nt.Z.set(D.kClockButtonShowName,!0),...(0,Mn.Z)("Show Name")},{type:"checkbox",checked:!this.props.prefValues[D.kClockButtonShowName],handler:()=>nt.Z.set(D.kClockButtonShowName,!1),...(0,Mn.Z)("Time Only")}],...(0,Mn.Z)("Button Label")},{items:Object.keys(Ph).map((e=>{const t=Ph[e];return{type:"checkbox",checked:this.props.prefValues[D.kClockNotificationSound]===e,handler:()=>nt.Z.set(D.kClockNotificationSound,e),...(0,Mn.Z)(t)}})),...(0,Mn.Z)("Notification Sound")},{type:"checkbox",checked:this.props.prefValues[D.kClockShowSeconds],handler:()=>nt.Z.set(D.kClockShowSeconds,!this.props.prefValues[D.kClockShowSeconds]),...(0,Mn.Z)("Show Seconds")},{type:"checkbox",checked:this.props.prefValues[D.kClockButtonShowDate],handler:()=>nt.Z.set(D.kClockButtonShowDate,!this.props.prefValues[D.kClockButtonShowDate]),...(0,Mn.Z)("Show Date")}]};render(){const e=this.props.prefValues[D.kClockTimers].slice().sort(((e,t)=>e.date-t.date)),t=this.getActiveMode(),n=this.getFirstTimer(),i=this.props.prefValues[D.kClockButtonStyle];return(0,fn.jsx)(sl,{className:`ClockButton ClockButton--${t}`,isOn:"time"!==t,onClick:this.togglePopup,customizeMenu:this.props.customizeMenu,menuOrigin:this.props.menuOrigin,ref:this.buttonRef,tooltip:this.getTooltip(),title:this.getButtonText(),image:"text"!==i||this.props.preview?cn.kY4[this.props.size]:void 0,draggable:this.props.draggable,dragImage:cn.kY4[this.props.size],onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,onDrop:this.props.onDrop,onDragEnter:this.props.onDragEnter,mimeType:this.props.mimeType,name:this.props.name,popupWidth:210,hidePopup:this.hidePopup,popupPosition:this.props.popupPosition,popupClassName:"ClockPopup",isPopupVisible:this.state.isPopupOpen,menu:this.menu,style:this.getClockStyle(),children:Nh(Eh,{now:this.now,timers:e,firstTimer:n,hidePopup:this.hidePopup})})}}const xh=(0,fs.Z)(Dh,Mh);var Oh,Lh=n(7153),Rh=n(33466),Bh=n(61667),Fh=n(93245);function Uh(e,t,n,i){Oh||(Oh="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Oh,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Vh={top:0,right:0,bottom:0,left:0},Wh={data:{fill:"var(--colorSuccessBgAlpha)",stroke:"var(--colorSuccessBg)",strokeWidth:2}},Hh={grid:{stroke:"var(--colorFgAlpha)"}};var zh,Gh,$h=Uh(Lh.Z,{preserveAspectRatio:"none"}),Kh=Uh(Rh.Z,{standalone:!1,style:Hh,offsetY:-10}),jh=Uh(Rh.Z,{dependentAxis:!0,standalone:!1,style:Hh,offsetX:-10});class Yh extends tn.PureComponent{dataPointCounter=0;timeline=[];maxSpeed=.1;render(){if(this.props.speed>this.maxSpeed&&(this.maxSpeed=1.1*this.props.speed),this.timeline=(0,E.ZP)(this.timeline,(e=>{e.push({x:this.dataPointCounter++,y:this.props.speed}),300===e.length&&e.splice(0,1)})),this.timeline.length<=1)return null;const e={x:[this.timeline[0].x,Math.max(this.timeline.at(-1).x,5)],y:[0,this.maxSpeed]};return Uh(Bh.Z,{height:50,padding:Vh,domain:e,domainPadding:[300,0],scale:"linear",containerComponent:$h},void 0,Kh,jh,Uh(Fh.Z,{data:this.timeline,interpolation:"linear",standalone:!1,style:Wh}))}}function Xh(e,t,n,i){zh||(zh="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:zh,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Qh(e,t){return t?t>16?e.large:t<16?e.small:e.medium:e.medium}function qh({icon:e,size:t,className:n}){return Xh("span",{style:t&&{"--IconSize":t},className:mn()("VivaldiSvgIcon",n),dangerouslySetInnerHTML:{__html:e}})}function Jh({size:e,className:t}){return Xh(qh,{icon:Qh(cn.nre,e),size:e,className:t})}function ep({size:e,className:t}){return Xh(qh,{icon:cn.oJy,size:e,className:t})}function tp({size:e,className:t}){return Xh(qh,{icon:cn.u0H,size:e,className:t})}function np({size:e,className:t}){return Xh(qh,{size:e,className:t,icon:'\n<svg width="8" height="12" viewBox="0 0 8 12" xmlns="http://www.w3.org/2000/svg">\n  <path d="M7.06006 1.60666L6.1134 0.666656L4.00006 2.77999L1.88673 0.666656L0.940063 1.60666L4.00006 4.66666L7.06006 1.60666ZM0.940063 10.3933L1.88673 11.3333L4.00006 9.21999L6.1134 11.3333L7.0534 10.3933L4.00006 7.33332L0.940063 10.3933Z"/>\n</svg>\n    '})}function ip({size:e,className:t}){return Xh(qh,{icon:Qh(cn._TQ,e),size:e,className:t})}function sp({size:e,className:t}){return Xh(qh,{icon:Qh(cn.fph,e),size:e,className:t})}function op({size:e,className:t}){return Xh(qh,{icon:Qh(cn.$II,e),size:e,className:t})}function ap({size:e,className:t}){return Xh(qh,{size:e,className:t,icon:'\n<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">\n  <rect x="1" y="1" width="7" height="7" rx="2"/>\n  <rect x="1" y="10" width="7" height="7" rx="2"/>\n  <rect x="10" y="10" width="7" height="7" rx="2"/>\n  <rect x="10" y="1" width="7" height="7" rx="2"/>\n</svg>\n    '})}function rp({size:e,className:t}){return Xh(qh,{icon:Qh(cn.YvR,e),size:e,className:t})}function lp({size:e,className:t}){return Xh(qh,{icon:cn.AXs,size:e,className:t})}function dp({size:e,className:t}){return Xh(qh,{icon:cn.uw2,size:e,className:t})}function cp({size:e,className:t}){return Xh(qh,{icon:Qh(cn.bqs,e),size:e,className:t})}function hp({size:e,className:t}){return Xh(qh,{icon:cn.kze,size:e,className:t})}function pp({size:e,className:t}){return Xh(qh,{icon:cn.D7r.medium,size:e,className:t})}function up({size:e,className:t}){return Xh(qh,{icon:cn.Tu3,size:e,className:t})}function gp({size:e,className:t}){return Xh(qh,{icon:cn.GH$,size:e,className:t})}function mp({size:e,className:t,type:n}){switch(n){case"trash":return Xh(Jh,{className:t,size:e});case"bookmark":return Xh(ep,{className:t,size:e});case"caret":case"chevron":return Xh(tp,{className:t,size:e});case"contract":return Xh(np,{className:t,size:e});case"folder":return Xh(ip,{className:t,size:e});case"folder-arrow":return Xh(sp,{className:t,size:e});case"speed-dial-folder":return Xh(op,{className:t,size:e});case"speed-dial":return Xh(ap,{className:t,size:e});case"search":return Xh(rp,{className:t,size:e});case"download-speed":return Xh(lp,{className:t,size:e});case"download-placeholder":return Xh(dp,{className:t,size:e});case"settings":return Xh(cp,{className:t,size:e});case"close":return Xh(hp,{className:t,size:e});case"checkmark":return Xh(pp,{className:t,size:e});case"blocker-shield":return Xh(up,{className:t,size:e});case"info":return Xh(gp,{className:t,size:e})}}function vp(e,t,n,i){Gh||(Gh="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Gh,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var fp=vp(mp,{type:"download-speed"});class yp extends tn.PureComponent{static contextType=dn.Z;pathButtonTitle=(0,le.Z)("Show in File Manager");_openUrl=()=>{this.props.url&&Y.Z.openURL(this.context.vivaldiWindowId,(0,Ni.Fn)(this.props.url))};render(){const{node:e}=this.props,t="complete"===e?.state?e.totalBytes:e?.bytesReceived||0,n=e?Co(t):"",i=e?e.currentSpeed:0,s=e?Co(i)+"/s":"",o="in_progress"===e?.state;return(0,fn.jsx)(fn.Fragment,{children:vp("div",{className:"container"},void 0,vp("div",{className:"completed"},void 0,n),vp("div",{className:"speed"},void 0,s?(0,fn.jsxs)(fn.Fragment,{children:[fp,s]}):(0,le.Z)("Download Speed")),vp("div",{className:"chart"},void 0,vp(Yh,{speed:i},this.props.finalName)),vp("div",{className:"actionbuttons"},void 0,this.props.canResumeDownload&&this.props.hasPausedTransfersSelected?vp("input",{type:"button",className:"action-button",value:(0,le.Z)("navigation","Resume"),tabIndex:this.props.tabIndex,onClick:this.props.onDownloadResume}):vp("input",{type:"button",className:"action-button",disabled:o,value:(0,le.Z)("navigation","Restart"),tabIndex:this.props.tabIndex,onClick:this._openUrl}),vp("input",{id:"show-in-folder-button",type:"button",className:"action-button",tabIndex:this.props.tabIndex,disabled:o,onClick:this.props.openFile,value:this.pathButtonTitle,title:this.pathButtonTitle})))})}}const wp=yp;var bp;function Cp(e,t,n,i){bp||(bp="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:bp,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Sp="in_progress",Tp="complete",Ip="interrupted";function kp({item:e}){const t=e.state===Sp,n=e.paused||e.state===Ip,i=e.bytesReceived,s=e.totalBytes&&e.state!==Tp?(i/e.totalBytes*100).toFixed(2):"100",o=Math.min(e.totalBytes/100,500);return Cp("div",{className:mn()("DownloadItem-ProgressBar",{"unknown-filesize":!e.totalBytes,visible:t,loading:!n}),"aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":s,"aria-valuetext":(0,le.Z)("Download in progress"),"aria-hidden":!t},void 0,Cp("div",{className:"value",style:{width:s+"%",transition:"0.00"===s?"none":`width ${o}ms linear`}}))}var Ap,Zp;function Ep(e,t,n,i){Ap||(Ap="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Ap,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function _p({node:e}){const{bytesReceived:t=0,fileSize:n=1,startTime:i="",endTime:s=""}=e||{},o=(t/n*100).toFixed(0),a=!isNaN(parseInt(o)),r=b()(i),l=b()(s),d=r.isSame(l,"day");return Ep("div",{className:"panel-timefield"},void 0,Ep("div",{className:"container"},void 0,Ep("div",{className:"started"},void 0,(0,le.Z)("Started:")),Ep("div",{className:"started-time"},void 0,r.isValid()?r.format("l, LTS"):""),Ep("div",{className:"completed"},void 0,s?(0,le.Z)("Finished:"):a&&(0,le.Z)("Completed:")),Ep("div",{className:"progress"},void 0,l.isValid()?l.format(d?"LTS":"l, LTS"):e&&a&&(0,fn.jsxs)(fn.Fragment,{children:[o+"%",Ep(kp,{item:e})]}))))}function Np(e,t,n,i){Zp||(Zp="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Zp,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Mp=(0,le.Z)("File Name");class Pp extends tn.Component{render(){const e=this.props.downloadItem,t=(e?.filename||"").split("\\").pop().split("/").pop(),n=e?.url||"",i=t.length?t:Mp,s=e&&e?.bytesReceived>0?this.props.getItemPath(e.id):"";return Np("div",{className:mn()({data:!0,"downloads-cardwrapper":!0,cardview:!0,disabled:!e})},void 0,Np("div",{className:"downloads-panel-actions"},void 0,Np("span",{className:"download-panel title",title:i},void 0,i),Np("input",{type:"text",className:"cardview url downloads",tabIndex:this.props.keyAccess,placeholder:(0,le.Z)("File URL"),disabled:!e,value:n,title:n,readOnly:!0}),Np("input",{type:"text",className:"cardview url downloads",tabIndex:this.props.keyAccess,placeholder:(0,le.Z)("Local File"),disabled:!e,value:s,title:s,readOnly:!0})),Np(_p,{node:e}),Np("div",{className:"panel-pathfield"},void 0,Np(wp,{node:e,finalName:i,url:n,tabIndex:this.props.keyAccess,openFile:this.props.onShow,canResumeDownload:this.props.canResumeDownload,hasPausedTransfersSelected:this.props.hasPausedTransfersSelected,onDownloadResume:this.props.onDownloadResume})))}}const Dp=Pp;var xp;function Op(e,t,n,i){xp||(xp="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:xp,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var Lp=Op(mp,{type:"close",size:16});const Rp=function(e){const t=tn.useContext(dn.Z);return Op("div",{className:"toolbar toolbar-default toolbar-align-top"},void 0,Op("h1",{},void 0,e.title),Op("button",{className:"close transparent",onClick:()=>Ho.Z.closePanel(t.vivaldiWindowId),title:(0,le.Z)("Close Panel")},void 0,Lp))};var Bp,Fp;function Up(e,t,n,i){Bp||(Bp="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Bp,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Vp({downloadItem:e,canResumeDownload:t,filter:n,hasActiveTransfersSelected:i,hasCompletedTransfers:s,hasCompletedTransfersSelected:o,hasPausedTransfersSelected:a,keyAccess:r,onDownloadResume:l,onFilterChange:d,onRemoveAllFinished:c,onRemoveSelected:h,onRestartSelectedDownload:p,onStopSelectedDownload:u,title:g}){return Up("header",{},void 0,Up(Rp,{title:g}),Up("div",{className:"toolbar toolbar-default toolbar-medium toolbar-wrap"},void 0,Up("input",{type:"search",placeholder:(0,le.Z)("verb","Search"),value:n,onChange:d}),Up("div",{className:"toolbar"},void 0,Up("div",{className:"toolbar-group"},void 0,Up(sl,a||t?{tooltip:(0,le.Z)("Resume Download"),onClick:l,image:cn.sxZ.small}:{tooltip:(0,le.Z)("verb","Pause"),onClick:u,disabled:!i,image:cn.Q9E.small}),Up(sl,{tooltip:(0,le.Z)("command","Restart"),disabled:!e,onClick:p,image:cn.Ibx.small}),Up(sl,{tooltip:(0,le.Z)("verb","Remove"),disabled:!(o||a||e&&"interrupted"===e.state),onClick:h,image:cn.M2k.small}),Up(sl,{tooltip:(0,le.Z)("Remove all finished"),disabled:!s,onClick:c,image:cn.DwE.small})))))}function Wp(e,t,n,i){Fp||(Fp="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Fp,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var Hp=Wp(mp,{type:"download-placeholder",size:46});function zp(){return Wp("div",{className:"download-placeholder"},void 0,Wp("div",{className:"happy-note"},void 0,Hp,Wp("h1",{},void 0,(0,le.Z)("Your download history is empty."))))}var Gp,$p=n(1567);function Kp(e,t,n,i){Gp||(Gp="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Gp,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const jp="in_progress",Yp="complete",Xp="interrupted";function Qp({item:e}){const t=(new Date).getTime()+2e3,n=new Date(e.estimatedEndTime).getTime(),i=e.state===jp,s=e.bytesReceived,{currentHumanized:o,endHumanized:a}=function(e,t){let n=Co(e);const i=Co(t||e);return n.split(" ")[1]===i.split(" ")[1]&&(n=n.split(" ")[0]),{currentHumanized:n,endHumanized:i}}(s,e.totalBytes),r=function(e,t,n){return e&&t>n?b()(t).fromNow():e&&t<=n?(0,le.Z)("about a second"):""}(i,n,t),l=(0,le.Z)("$1/s",[Co(e.currentSpeed)]),d=e.paused||e.state===Xp,c=e.error?function(e){switch(e){case"FILE_NO_SPACE":return(0,le.Z)("Disk is full");case"FILE_TOO_LARGE":return(0,le.Z)("File too large");case"FILE_FAILED":return(0,le.Z)("Download error");case"FILE_ACCESS_DENIED":return(0,le.Z)("Insufficient permissions");case"FILE_NAME_TOO_LONG":return(0,le.Z)("Path too long");case"FILE_VIRUS_INFECTED":return(0,le.Z)("Virus detected");case"FILE_TRANSIENT_ERROR":return(0,le.Z)("System busy");case"FILE_BLOCKED":return(0,le.Z)("Blocked");case"FILE_SECURITY_CHECK_FAILED":return(0,le.Z)("Virus scan failed");case"FILE_TOO_SHORT":return(0,le.Z)("File truncated");case"FILE_SAME_AS_SOURCE":return(0,le.Z)("Already downloaded");case"FILE_HASH_MISMATCH":return(0,le.Z)("Hash mismatch");case"NETWORK_FAILED":return(0,le.Z)("Network");case"NETWORK_TIMEOUT":return(0,le.Z)("Timeout");case"NETWORK_DISCONNECTED":return(0,le.Z)("Disconnected");case"NETWORK_SERVER_DOWN":return(0,le.Z)("Server unavailable");case"NETWORK_INVALID_REQUEST":return(0,le.Z)("Invalid network request");case"SERVER_FAILED":return(0,le.Z)("Server failed");case"SERVER_NO_RANGE":return(0,le.Z)("Server does not support range");case"SERVER_BAD_CONTENT":return(0,le.Z)("The server could not find the file");case"SERVER_UNAUTHORIZED":return(0,le.Z)("Unauthorized");case"SERVER_CERT_PROBLEM":return(0,le.Z)("Certificate problem");case"SERVER_FORBIDDEN":return(0,le.Z)("Forbidden");case"SERVER_UNREACHABLE":return(0,le.Z)("Unreachable");case"SERVER_CONTENT_LENGTH_MISMATCH":return(0,le.Z)("Content length mismatch");case"SERVER_CROSS_ORIGIN_REDIRECT":return(0,le.Z)("Cross origin redirect");case"USER_CANCELED":return(0,le.Z)("Cancelled");case"USER_SHUTDOWN":return(0,le.Z)("Shutdown");case"CRASH":return(0,le.Z)("Crashed")}return e}(e.error):"",h=d?(0,le.Z)("$1 of $2 - stopped",[o,a]):(0,le.Z)("$1 of $2 at $3",[o,a,l]);return Kp("div",{className:"DownloadItem-FileSize"},void 0,e.state===Yp?a:e.error?c:h,r&&` (${r})`)}var qp,Jp;function eu(e,t,n,i){qp||(qp="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:qp,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function tu({onClick:e}){return eu("button",{onClick:e,title:(0,le.Z)("verb","Pause"),className:"ActionButton circular",tabIndex:"-1",dangerouslySetInnerHTML:{__html:cn.Q9E.small}})}function nu({onClick:e}){return eu("button",{onClick:e,title:(0,le.Z)("Resume Download"),className:"ActionButton circular resume",tabIndex:"-1",dangerouslySetInnerHTML:{__html:cn.sxZ.small}})}function iu({onClick:e}){return eu("button",{onClick:e,title:(0,le.Z)("Show in File Manager"),className:"ActionButton circular reveal",tabIndex:"-1",dangerouslySetInnerHTML:{__html:cn._TQ.small}})}function su({onClick:e}){return eu("button",{onClick:e,title:(0,le.Z)("verb","Remove"),className:"ActionButton circular remove",tabIndex:"-1",dangerouslySetInnerHTML:{__html:cn.M2k.small}})}function ou(e){return new Promise(((t,n)=>{y.Z.downloads.getFileIcon(e,{size:32},(e=>{t(e)}))}))}function au(e,t,n,i){Jp||(Jp="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Jp,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const ru="\n• ",lu="in_progress",du="complete";function cu(e){const t=e.state===lu;return e.url+ru+(0,le.Z)("Added: $1",[b()(e.startTime).format("l, LTS")])+(t&&e.paused?ru+(0,le.Z)("Download stopped"):"")+(e.endTime?ru+(0,le.Z)("Complete: $1",[b()(e.endTime).format("l, LTS")]):"")}class hu extends tn.PureComponent{static contextType=dn.Z;#n=!1;constructor(e){super(e),b().relativeTimeThreshold("ss",2)}state={icon:void 0};componentDidMount(){this.#n=!0,ou(this.props.item.id).then((e=>{this.#n&&this.setState({icon:e})}))}componentWillUnmount(){this.#n=!1}componentDidUpdate(e,t){this.state.icon||e.item.state===this.props.item.state||ou(this.props.item.id).then((e=>{this.#n&&this.setState({icon:e})}))}handleMouseEnter=e=>{X.Z.setStatus(e,this.props.item.url)};handleMouseLeave=e=>{X.Z.clearStatus(e)};renderDownloadButton=()=>{const{item:e,onPause:t,onResume:n,onShow:i,onErase:s}=this.props;return e.state!==lu||e.paused?e.canResume?au(nu,{onClick:n.bind(null,e.id)}):e.state===du&&e.exists?au(iu,{onClick:i.bind(null,e.id)}):au(su,{onClick:s.bind(null,e.id)}):au(tu,{onClick:t.bind(null,e.id)})};renderKeepDiscardMixedContent=()=>{const{item:e,onErase:t,onValidateMixedDownload:n}=this.props;return au("div",{className:"DownloadItem-KeepDiscard"},void 0,au("span",{},void 0,(0,le.Z)("This file can’t be downloaded securely.")),au("span",{},void 0,au("input",{type:"button",onClick:()=>t(e.id),title:(0,le.Z)("Discard insecure download"),className:"DownloadItem-KeepDiscard-KeepDiscardButton-default",value:(0,le.Z)("Discard"),autoFocus:!0}),au("input",{type:"button",onClick:()=>n(e.id),title:(0,le.Z)("Keep insecure download"),className:"DownloadItem-KeepDiscard-KeepDiscardButton",value:(0,le.Z)("Keep")})))};render(){const{item:e}=this.props,t=(e.filename||e.finalUrl).split("\\").pop().split("/").pop(),n=this.context.vivaldiWindowId,{icon:i}=this.state;return au("div",{className:mn()("DownloadItem",{"DownloadItem--Unavailable":!1===e.exists}),onMouseEnter:()=>this.handleMouseEnter(n),onMouseLeave:()=>this.handleMouseLeave(n),title:cu(e)},void 0,i&&au("img",{src:i,className:"DownloadItem-Icon"}),au("div",{className:"DownloadItem-FileName"},void 0,t),au(kp,{item:e}),au(Qp,{item:e}),this.renderDownloadButton(),"block"===e.mixedState&&this.renderKeepDiscardMixedContent())}}const pu=hu;class uu extends tn.Component{static contextType=dn.Z;static defaultProps={offset:0};#s=tn.createRef();componentDidMount=()=>{const e=this.#s.current;e&&(e.addEventListener("pointerdown",this.handlePointerDown,!0),e.addEventListener("pointerup",this.handlePointerUp,!0),e.addEventListener("pointercancel",this.handleStop,!0))};componentWillUnmount=()=>{const e=this.#s.current;e&&(e.removeEventListener("pointerdown",this.handlePointerDown,!0),e.removeEventListener("pointerup",this.handlePointerUp,!0),e.removeEventListener("pointercancel",this.handleStop,!0))};handleDoubleClick=e=>{this.props.onDoubleClick&&(this.props.onDoubleClick(),e.stopPropagation())};handlePointerDown=e=>{e.preventDefault(),e.button===vn.Z.kLeft&&(e.currentTarget.setPointerCapture(e.pointerId),vn.Z.setWebviewPointerEvents(!1,this.context.document),e.currentTarget.addEventListener("pointermove",this.handlePointerMove,!0),this.props.onStart&&this.props.onStart())};handlePointerUp=e=>{e.button===vn.Z.kCenter?this.handleDoubleClick(e):this.handleStop(e)};handlePointerMove=e=>{if(!e.buttons)return void this.handleStop(e);const t=this.props.returnOffset?e.movementX/devicePixelRatio:e.pageX+(this.props.offset||0),n=this.props.returnOffset?e.movementY/devicePixelRatio:e.pageY+(this.props.offset||0);this.context.window.requestAnimationFrame((()=>{this.props.onSlidebarPosition(t,n,e)}))};handleStop=({currentTarget:e,pointerId:t})=>{e.releasePointerCapture(t),vn.Z.setWebviewPointerEvents(!0,this.context.document),e.removeEventListener("pointermove",this.handlePointerMove,!0),this.props.onStop&&this.props.onStop()};render(){const{position:e}=this.props,t="left"===e||"right"===e?"SlideBar--FullHeight":"SlideBar--FullWidth",n="right"===e||"bottom"===e;return(0,fn.jsx)("button",{type:"button",tabIndex:"-1",ref:this.#s,style:this.props.style,onClick:e=>e.stopPropagation(),onDoubleClick:this.handleDoubleClick,className:mn()("SlideBar",this.props.className,t,{alternate:n})})}}const gu=uu,mu=(e,t)=>{const n={...M.Z.get(D.kAppearanceTreeColumnsEntries),[t]:e};nt.Z.set(D.kAppearanceTreeColumnsEntries,n)},vu=()=>M.Z.get(D.kAppearanceTreeColumnsEntries),fu=e=>e.filter((e=>e.visible)).reduce(((e,t)=>(e.push({id:t.value,width:t.width||100,key:t.key}),e)),[]),yu=e=>e.map((e=>e.key?`minmax(${Math.min(e.width/2,100)}px, 1fr)`:`minmax(36px, ${e.width}px)`)).join(" ");var wu,bu=n(34155);function Cu(e,t,n,i){wu||(wu="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:wu,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Su="vivaldi/x-sortfield";class Tu extends tn.PureComponent{static contextType=dn.Z;nodeRef=tn.createRef();constructor(e){super(e),this.state={columns:e.columns||[],maxWidth:0,dataKey:"",dragOverField:void 0}}getWidth=e=>{const t=this.nodeRef.current?.getBoundingClientRect();t?.width&&this.setState({maxWidth:t.width,dataKey:e})};saveColumnsToSettings=()=>{this.dragged="",this.props.onSaveRow&&this.props.onSaveRow()};resizeRow=(e,t,n)=>{const{dataKey:i}=this.state;this.setState((t=>{const s=t.columns?[...t.columns]:[],o=s.flatMap((e=>e.id)).indexOf(i),a=n.target.parentElement,r=Math.round(e-a.getClientRects()[0].left),l=o+1,d=a.nextSibling,c=Math.round(a.clientWidth+d.clientWidth)-r;return r<0||c<0||(s[l].key||0===o&&!s[o].key?s[o]={...s[o],width:r}:s[l]={...s[l],width:c},this.props.onUpdateRow&&this.props.onUpdateRow(s)),{columns:s}}))};updateField=e=>{const t=e.target.value;let n;n="manually"===t?ns.Z.NO_SORTING:this.props.sortOrder===ns.Z.NO_SORTING?ns.Z.ASCENDING_SORT:this.props.sortOrder,this.props.onSortChange(n,t)};updateSort=(e,t)=>{let n;if(t.preventDefault(),e===this.props.sortField)switch(this.props.sortOrder){case ns.Z.ASCENDING_SORT:n=ns.Z.DESCENDING_SORT;break;case ns.Z.DESCENDING_SORT:n=!1!==this.props.manualSorting?ns.Z.NO_SORTING:ns.Z.ASCENDING_SORT;break;case ns.Z.NO_SORTING:n=ns.Z.ASCENDING_SORT}else n=ns.Z.ASCENDING_SORT;n&&this.props.onSortChange(n,e)};updateOrder=()=>{const e=this.props.sortOrder===ns.Z.DESCENDING_SORT?ns.Z.ASCENDING_SORT:ns.Z.DESCENDING_SORT;this.props.onSortChange(e,this.props.sortField)};onDragStart=(e,t)=>{this.dragged=e,t.dataTransfer.setData(Su,!0),t.stopPropagation()};onDragOver=(e,t)=>{const{HTMLElement:n}=this.context;if(t.dataTransfer&&!t.dataTransfer.types.includes(Su))return;if(t.preventDefault(),t.stopPropagation(),e===this.dragged||!(t.currentTarget instanceof n))return;const i=t.currentTarget.getBoundingClientRect(),s=(t.clientX-i.left)/i.width<=.5?"left":"right";this.setState({dragOverField:{id:e,position:s}})};onDrop=e=>{if(this.state.columns&&void 0!==this.state.dragOverField&&this.state.columns.length>1&&e.dataTransfer.getData(Su)){const{columns:t,dragOverField:n}=this.state,i=t.findIndex((e=>e.id===this.dragged)),s=Math.max(0,t.findIndex((e=>e.id===n.id))+("right"===n.position?1:0)),o=i-s;if(0===o||!this.state.columns)return;e.preventDefault(),e.stopPropagation(),this.setState((e=>{if(e.columns){const t=[...e.columns];return t.splice(Math.max(0,s-(o<0?1:0)),0,t.splice(i,1)[0]),this.props.onUpdateRow&&this.props.onUpdateRow(t),{columns:t,dragOverField:void 0}}})),bu.nextTick((()=>this.saveColumnsToSettings()))}};resetDragOverField=()=>{this.setState({dragOverField:void 0})};resetColumns=()=>{const e=fu(this.props.fields);e&&(this.setState({columns:e}),this.props.onUpdateRow&&this.props.onUpdateRow(e))};onContextMenu=e=>{if(!this.state.columns)return;const t=this.state.columns.flatMap((e=>e.id)),n=this.props.fields.filter((e=>!e.key)).map((e=>({handler:this.toggleColumn.bind(this,e.value),type:"checkbox",checked:t.includes(e.value),...G.Z.makeLabelPair(e.text)})),[]);this.props.columns&&(n.push(G.Z.separatorItem),n.push({handler:this.resetColumns,...(0,Mn.Z)("Reset Columns")})),(0,zi.Z)(this.context.vivaldiWindowId,n)(e)};toggleColumn=e=>{if(!this.state.columns)return;const t=this.state.columns.flatMap((e=>e.id));t.includes(e)?this.setState((n=>{const i=n.columns||[];if(i){const n=t.indexOf(e),s=[...i.slice(0,n),...i.slice(n+1)];return this.props.onUpdateRow&&this.props.onUpdateRow(s),{columns:s}}})):this.setState((t=>{const n=t.columns||[],i=this.props.fields.find((t=>t.value===e));if(i&&n.length>0){const t=this.props.fields.indexOf(i),s=[...n.slice(0,t),{id:e,width:i.width||20},...n.slice(t)];return this.props.onUpdateRow&&this.props.onUpdateRow(s),{columns:s}}})),bu.nextTick((()=>this.saveColumnsToSettings()))};_getSortLabel=e=>{const t=e.text,n=e.value,i=e.isSortField??!0,s=this.props.sortField===n,o=e.fullScreenTitle,{dragOverField:a}=this.state,r=a&&a.id===e.value,l=a&&a.position||"",d=mn()({"sortselector-button":!0,"sortselector-button-active":s&&this.props.sortOrder!==ns.Z.NO_SORTING,"direction-ascending":s&&this.props.sortOrder===ns.Z.ASCENDING_SORT,"direction-descending":s&&this.props.sortOrder===ns.Z.DESCENDING_SORT,"over-left":r&&"left"===l,"over-right":r&&"right"===l,"drag-over":r}),{columns:c}=this.state,h=c.findIndex((e=>e.id===n)),p=c[h];return Cu("div",{onContextMenu:this.onContextMenu},"key_"+n+t+o,Cu("button",{draggable:1!==this.props.fields.length,onDragStart:this.onDragStart.bind(this,n),onDragOver:this.onDragOver.bind(this,n),onDragLeave:this.resetDragOverField,onDrop:this.onDrop,className:d,onClick:this.updateSort.bind(this,n),title:o||(0,le.Z)("Toggle Sort Order"),disabled:!i,tabIndex:this.props.keyAccess},void 0,p&&p.width<80?Cu("span",{className:"column-icon",dangerouslySetInnerHTML:{__html:e.icon?e.icon:cn.NNg.small}}):Cu("span",{className:"column-label"},void 0,t),Cu("span",{className:"column-sort-order",dangerouslySetInnerHTML:{__html:cn.u0H}})),c&&h>-1&&h<c.length-1&&Cu(gu,{onSlidebarPosition:this.resizeRow,onStart:()=>this.getWidth(n),onStop:this.saveColumnsToSettings,style:this.props.style,position:"right"}))};getFullOptions(){return this.state.columns&&this.state.columns.length>0?this.state.columns.map((e=>{const t=this.props.fields.find((t=>t.value===e.id));if(t)return this._getSortLabel(t)})).filter(Boolean):this.props.fields.map((e=>this._getSortLabel(e)))}getCompactOptions(){const e=this.props.fields.filter((({isSortField:e})=>e??!0)).map((e=>Cu("option",{value:e.value},e.value,e.fullScreenTitle)));return!1!==this.props.manualSorting&&e.unshift(Cu("option",{value:"manually"},"manually",(0,le.Z)("Sort Manually"))),e}render(){const{columns:e,fullsize:t}=this.props,n=this.props.sortOrder===ns.Z.NO_SORTING,i=t&&e?yu(e):void 0,s=1===this.props.fields.length&&!this.props.compact,o=!(t||s);return(0,fn.jsx)("div",{ref:this.nodeRef,className:mn()("sortselector",{"sortselector-tableheader":!o,"tableheader-add-scrollbar-spacing":t&&!!this.props.alignHeaderWithScrollbar,"sortselector-compact":o,single:s}),style:{gridTemplateColumns:i},children:o?(0,fn.jsxs)(fn.Fragment,{children:[Cu("div",{className:"sortselector-area"},void 0,Cu("select",{className:"sortselector-dropdown",title:(0,le.Z)("Sort by..."),value:this.props.sortField,tabIndex:this.props.keyAccess,onChange:this.updateField},void 0,this.getCompactOptions())),Cu("button",{className:mn()({"sortselector-button":!0,"direction-ascending":this.props.sortOrder===ns.Z.ASCENDING_SORT,"direction-descending":this.props.sortOrder===ns.Z.DESCENDING_SORT}),onClick:this.updateOrder,title:this.props.sortOrder===ns.Z.ASCENDING_SORT?(0,le.Z)("Sort Descending"):(0,le.Z)("Sort Ascending"),tabIndex:n?-1:this.props.keyAccess,disabled:n,dangerouslySetInnerHTML:{__html:cn.u0H}})]}):this.getFullOptions()})}}const Iu=Tu;const ku=class{constructor(e=!0){this.selectedIds_=[],this.anchorIndex_=-1,this.leadIndex_=-1,this.multiSelect_=e}isSelected(e){for(const t of this.selectedIds_)if(t.id===e)return t.selected;return!1}get length(){return this.selectedIds_.length}get isSingleItemSelected(){return 1===this.selectedIds_.length}get FirstSingleItemSelected(){return this.isSingleItemSelected?this.selectedIds_[0].id:-1}get selectedIds(){return this.selectedIds_}resetSelectionModel(){this.selectedIds_=[],this.anchorIndex_=-1,this.leadIndex_=-1}getData(){return{selectedIds_:this.selectedIds_,anchorIndex_:this.anchorIndex_,leadIndex_:this.leadIndex_}}setData(e){this.anchorIndex_=e.anchorIndex_,this.leadIndex_=e.leadIndex_,this.selectedIds_=e.selectedIds_}unSelectAll(){this.selectedIds_=[]}selectAll(e){this.multiSelect&&(e.forEach((e=>{this.selectedIds_.push({id:e,selected:!0})})),e.length>0&&(-1===this.anchorIndex_&&(this.anchorIndex_=e[0]),-1===this.leadIndex_&&(this.leadIndex_=e[0])))}setSelectedIds(e){this.multiSelect?this.selectedIds_=e.map((e=>({id:e,selected:!0}))):this.setIndexSelected(this.leadIndex,!0)}setLeadIndex(e){this.leadIndex=e}setIndexSelected(e,t){var n=this.selectedIds_.map((e=>e.id)).indexOf(e),i=this.selectedIds_[n];if((!i||i.selected!==t)&&(this.multiSelect||this.resetSelectionModel(),this.leadIndex=e,this.anchorIndex=e,-1!==e))if(t)this.selectedIds_.push({id:e,selected:t});else{var s=this.selectedIds_.map((e=>e.id)).indexOf(e);-1!==s&&this.selectedIds_.splice(s,1)}}get leadIndex(){return this.leadIndex_}set leadIndex(e){this.leadIndex_=e}get anchorIndex(){return this.anchorIndex_}set anchorIndex(e){this.anchorIndex_=e}get multiSelect(){return this.multiSelect_}set multiSelect(e){this.multiSelect_=e}};var Au=n(81538),Zu=n(34155);const Eu={throttleSync:function(e,t={}){return function(){if(!t.isRunning){t.isRunning=!0;try{e.apply(this,arguments)}finally{Zu.nextTick((()=>{t.isRunning=!1}))}}}}};var _u,Nu=n(52373);function Mu(e,t,n=((e,t,n)=>(0,Nu.Z)(t[e],n[e]))){if(e===t)return!0;const i=Object.keys(e),s=Object.keys(t);if(i.length!==s.length)return!1;for(let s=0;s<i.length;s++)if(!t.hasOwnProperty(i[s])||!n(i[s],e,t))return!1;return!0}function Pu(e,t,n,i){_u||(_u="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:_u,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Du(e,t,n){switch(e){case"style":case"componentProps":return Mu(t[e],n[e])}return(0,Nu.Z)(t[e],n[e])}class xu extends tn.Component{static contextType=dn.Z;#o={};#a;shouldComponentUpdate(e){return!Mu(this.props,e,Du)}isFolder=()=>this.props.isFolder(this.props.treeItem);hasChildren=()=>this.props.hasChildren(this.props.treeItem);onClick=e=>{this.props.onItemClick(this.props.treeItem,e),e.stopPropagation()};onDoubleClick=e=>{void 0===this.props.inlineEditText&&(this.isFolder()&&this.onExpandClick(e),this.props.onItemDoubleClick(this.props.treeItem,e))};onDragStart=e=>{const{inlineEditText:t,validateForDrag:n,getAllSelectedItems:i,mimeType:s}=this.props;if(!n||void 0!==t)return;let o=i().map((e=>e.id));o=n(o),0!==o.length&&(this.props.onDragStart(),s&&e.dataTransfer.setData(s,JSON.stringify(o)),e.dataTransfer.setData("text/uri-list",this.props.getDragData?.("text/uri-list",o)),e.dataTransfer.setData("text/plain",this.props.getDragData?.("text/plain",o)),e.dataTransfer.setData("vivaldi/x-title",this.props.getDragData?.("vivaldi/x-title",o)),this.props.setCustomDragData&&this.props.setCustomDragData(e.dataTransfer,o),e.dataTransfer.effectAllowed="all",this.#a=!0,vn.Z.setWebviewPointerEvents(!1,this.context.document))};onDragEnd=e=>{this.#a=!1,vn.Z.setWebviewPointerEvents(!0,this.context.document),this.props.onDragEnd()};onDragEnter=e=>{this.props.supportDrop&&(this.#o=this.props.supportDrop(this.props.treeItem,e))};onDrop=e=>{e.preventDefault(),e.stopPropagation(),!0===this.#o.available&&this.props.onDrop(this.props.treeItem,this.#o,e)};onDragOver=e=>{const{onDragOver:t,treeItem:n,index:i}=this.props;e.stopPropagation(),!0===this.#o.available&&t&&(e.preventDefault(),e.nativeEvent.dataTransfer.dropEffect="move",t(n,i,this.#o,e))};onDragLeave=e=>{e.preventDefault(),e.stopPropagation(),this.props.onDragLeave&&!0===this.#o.available&&this.props.onDragLeave(this.props.treeItem,e)};onMouseDown=e=>{const t=!this.props.isDraggable&&void 0===this.props.inlineEditText;this.props.onMouseDown(this.props.treeItem,t,e)};onMouseUp=e=>{this.props.onMouseUp(this.props.treeItem,e),0===e.buttons&&this.#a&&this.onDragEnd(e)};onExpandClick=e=>{this.props.treeItem.children&&this.props.treeItem.children.length>0&&(this.props.toggle(this.props.treeItem.id),e.preventDefault(),e.stopPropagation())};render(){const{Component:e,componentProps:t}=this.props,n=!!this.props.isSeparator&&this.props.isSeparator(this.props.treeItem),i=this.props.selected,s=this.props.dragOverObj.id===this.props.treeItem.id,o=this.props.dragOverObj.position;return Pu("div",{style:this.props.style,"data-id":this.props.treeItem.id,className:"tree-item","data-selected":i?"":null,"data-lead":this.props.lead?"":null,"data-cut":this.props.isCut?"":null,"data-expanded":this.props.isExpanded?"":null,onDragEnter:this.props.enableDragAndDrop?this.onDragEnter:null,onDragOver:this.props.enableDragAndDrop?this.onDragOver:null,onDragLeave:this.props.enableDragAndDrop?this.onDragLeave:null,onDrop:this.props.enableDragAndDrop?this.onDrop:null,onContextMenu:this.props.onContextMenu},void 0,Pu("div",{className:mn()("tree-row",{folder:this.isFolder(),"tree-row-selected":i,"tree-row-selected--first":this.props.isFirstSelected,"tree-row-selected--last":this.props.isLastSelected,dragover:s&&"on"===o,dragoverAbove:s&&"above"===o,dragoverBelow:s&&"below"===o,"speeddial-folder":this.isFolder()&&this.props.treeItem.speeddial}),"data-separator":n?"":null,"data-selected":i?"":null,"data-nofocus":i&&!this.props.hasFocus?"":null,onClick:this.onClick,onDoubleClick:this.onDoubleClick,onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,draggable:this.props.isDraggable,onDragStart:this.props.enableDragAndDrop?this.onDragStart:null,onDragEnd:this.props.enableDragAndDrop?this.onDragEnd:null},void 0,(0,fn.jsx)(e,{...t})))}}const Ou=xu;var Lu,Ru=n(63153),Bu=n(84847),Fu=n(5264),Uu=n.n(Fu),Vu=n(34542),Wu=n(34155);function Hu(e,t,n,i){Lu||(Lu="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Lu,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const zu=24,Gu="F2",$u=16;function Ku(e){e.target.select()}class ju extends tn.PureComponent{static contextType=dn.Z;static defaultProps={enableDragAndDrop:!0,rowHeight:zu,supportsCollapseAll:!0};emptyDragOverObj={id:-1,position:""};refTreeListEntries=tn.createRef();constructor(e){super(e);const t=this.setupExpandModel(e.nodes,!0),{multiSelect:n}=e;this.selectionModel=new ku(n),this.state={dragOverObj:this.emptyDragOverObj,hasFocus:!1,expandModel:t,renderedArray:this.getRenderedItems(e.nodes,t,e.sorting),inlineEditId:-1,inlineEditText:"",width:0,height:("number"==typeof e.rowHeight?e.rowHeight:zu)*e.nodes.length,isDeleting:!1}}_dropSupport={available:!1,onto:!1,edge:!1};inlineEditTimeoutId=-1;expandTimer=void 0;_leftMouseTimeStamp=0;expandId=-1;_isMounted=!1;_hasCutCopyPasteListeners=!1;_isComposing=!1;_scrollTopNeedsUpdate=!1;_canCutCopyPaste=!1;resetSelectionModel=()=>{this.selectionModel.resetSelectionModel(),this.updateSelectionState()};updateSelectionState=e=>{this.forceUpdate(e)};SelectionMixinSelectAll=()=>{this.selectionModel.selectAll(this.getAllIds()),this.updateSelectionState()};SelectionMixinSetLead=e=>{this.selectionModel.setLeadIndex(e),this.updateSelectionState()};SelectionMixinSelectItem=(e,t,n,i,s)=>{this.selectionModel.setLeadIndex(e);const o=t;let a=this.selectionModel.isSelected(e);if(o||n)a=s||!a;else{if(s&&this.selectionModel.length>1)return;this.selectionModel.unSelectAll(),a=!0}if(n&&-1!==this.selectionModel.anchorIndex){const t=this.getSelectedIdsFromIdToAnchor(e);this.selectionModel.setSelectedIds(t)}else this.selectionModel.setIndexSelected(e,a);this.updateSelectionState()};getHeight=()=>this.state.height;getSelectedIdsFromIdToAnchor=e=>{const t=this.selectionModel.anchorIndex;return this.getIdsBetween(t,e)};_initializeSettings=e=>{if(!e.settings)return;this._expandSettings="EXPAND_"+e.settings,this._scrollTopSettings="SCROLL_TOP_"+e.settings,this._scrollTopNeedsUpdate=!0,this._searchStyleSettings="SEARCH_STYLE_"+e.settings,this._onRowsRenderedOptions="ON_ROWS_RENDERED_OPTIONS_"+e.settings;const t=this.setupExpandModel(e.nodes,!0);this.prepareDataForRender(e.nodes,t,e.sorting)};_updateSelectionStateIfNeeded=e=>{if(e.settings){this._selectionSettings="SELECTION_"+e.settings;const t=f.Z.getSync(this._selectionSettings);if(t){const n=this.getSelectedItem();this.selectionModel.setData(t),this.updateSelectionState((()=>{const{onSelect:t}=e;if(t){const e=this.getSelectedItem();let i=-1;!e||n&&e.id===n.id?n&&(i=n.id):(i=e.id,t(e)),Wu.nextTick((()=>{-1!==i&&this.scrollToId(i)}))}}))}else if(e.autoFocus&&e.nodes.length>0){const t=e.nodes[0].id;-1!==t&&Wu.nextTick((()=>this.selectById(t)))}else this.resetSelectionModel()}};UNSAFE_componentWillMount(){this._updateSelectionStateIfNeeded(this.props)}componentDidMount(){const{selectionStoreKey:e}=this.props;if(e){if(Au.Z.has(e))throw new Error(`Key ${e} has already been set in\n          SelectionStore. VivaldiTreeList expects instances using\n          selectionStoreKey props to be singleton.`);Au.Z.set(e,this.selectionModel)}this._initializeSettings(this.props),this._isMounted=!0;const t=this.getWrapper();if(t){t.addEventListener("focus",this.onGotFocus,!0);const e=t.parentElement;e&&this.updateTreeSize(e.clientWidth,e.clientHeight)}}UNSAFE_componentWillReceiveProps(e){if(this.props.multiSelect!==e.multiSelect&&(this.selectionModel.multiSelect=Boolean(e.multiSelect)),e.settings!==this.props.settings)this._initializeSettings(e),this._updateSelectionStateIfNeeded(e),this.updateScrollTop();else{const t=this.state.isDeleting?this.state.expandModel:this.setupExpandModel(e.nodes,!1);!0===this.state.isDeleting&&this.setState({isDeleting:!1}),this.prepareDataForRender(e.nodes,t,e.sorting)}}componentDidUpdate(e,t){if(this.state.renderedArray.length===t.renderedArray.length)this.rerenderVisibleTreeItems();else if(e.columns!==this.props.columns){(e.columns&&e.columns.flatMap((e=>e.id)).join())!==(this.props.columns&&this.props.columns.flatMap((e=>e.id)).join())&&this.rerenderVisibleTreeItems()}e.sorting?.sortOrder===this.props.sorting?.sortOrder&&e.sorting?.sortField===this.props.sorting?.sortField||this._scrollLeadNodeIntoView()}componentWillUnmount(){this.enableCutCopyPasteListeners(!1),this.stopInlineEditTimer(),this.resetAutoExpandTimer(),this._isMounted=!1;const e=this.getWrapper();e&&e.removeEventListener("focus",this.onGotFocus,!0);const{selectionStoreKey:t}=this.props;t&&Au.Z.get(t)===this.selectionModel&&Au.Z.delete(t)}getWrapper(){return this.refTreeListEntries.current?.Grid._scrollingContainer}focusTree=()=>{const e=this.getWrapper();e instanceof HTMLElement&&e.focus()};prepareDataForRender=(e,t,n)=>{const i=this.getRenderedItems(e,t,n);this.setState({renderedArray:i,expandModel:t}),"function"==typeof this.props.rowHeight&&this.rerenderVisibleTreeItems()};setCutIds=e=>{this.props.setCutIds&&this.props.setCutIds(e)};onCut=e=>{e.preventDefault();const{isValidForClipboard:t}=this.props;if(!this._canCutCopyPaste||!t)return;const n=this.getAllSelectedItems().filter((e=>t(e))).map((e=>e.id));this.props.onCut?this.props.onCut(e,n):(this.setCutIds(n),this.setClipboard(e,!0))};onCopy=e=>{const{isValidForClipboard:t,onCopy:n}=this.props;if(this._canCutCopyPaste&&t)if(n){n(e,this.getAllSelectedItems().filter((e=>t(e))).map((e=>e.id)))}else this.setClipboard(e,!1)};toggleSelectedExpansion=e=>{this.stopInlineEditTimer();const t=e||this.selectionModel.leadIndex;if(-1===t)return;if(this.state.inlineEditId===t)return;const n=this.findTreeItem(t);n&&this.props.isFolder(n)&&this.toggleExpandModel(n.id)};expand=e=>{const t=this.findTreeItem(e);t&&this.props.isFolder(t)&&!t.isExpanded&&this.toggleExpandModel(t.id)};collapse=e=>{const t=this.findTreeItem(e);t&&this.props.isFolder(t)&&t.isExpanded&&this.toggleExpandModel(t.id)};_setExpandModelElement=(e,t,n)=>{switch(this.props.folderMode){case"custom":e[t]=n;break;case"expand":n?delete e[t]:e[t]=!1;break;default:n?e[t]=!0:delete e[t]}};toggleExpandModel=e=>{this.setState((t=>{const n={...t.expandModel};return"custom"===this.props.folderMode||"expand"===this.props.folderMode?this._setExpandModelElement(n,e,!1===n[e]):this._setExpandModelElement(n,e,void 0===n[e]),{expandModel:n}}),(()=>{this.saveExpandModel(this.state.expandModel),this.prepareDataForRender(this.props.nodes,this.state.expandModel,this.props.sorting)}))};saveExpandModel=e=>{if(this.props.settings){const t={};t[this._expandSettings]=e,f.Z.set(t)}};saveSelectionModel=()=>{if(this.props.settings){const e={};e[this._selectionSettings]=this.selectionModel.getData(),f.Z.set(e)}};_findTreeIndex=e=>this.state.renderedArray.findIndex((t=>t.id===e));_scrollLeadNodeIntoView=()=>{const e=this._findTreeIndex(this.selectionModel.leadIndex);e>=0&&this.scrollIntoView(e)};resetExpandModel=(e,t)=>{const n={},i=e=>{this.props.isFolder(e)&&(n[e.id]=t),this.props.hasChildren(e)&&e.children.forEach(i)};return"custom"===this.props.folderMode?e.forEach(i):"expand"===this.props.folderMode?t||e.forEach(i):t&&e.forEach(i),n};collapseAll=()=>{const e=this.findTreeItem(this.selectionModel.leadIndex);let t=e;for(;t&&void 0!==t.parentId&&t.parentId!==this.props.rootId;)t=this.findTreeItem(t.parentId);const n=this.resetExpandModel(this.props.nodes,!1);this.saveExpandModel(n),this.prepareDataForRender(this.props.nodes,n,this.props.sorting),t&&t!==e?this.selectByNode(t):this._scrollLeadNodeIntoView()};setupExpandModel=(e,t)=>{let n=this.props.settings&&t?f.Z.getSync("EXPAND_"+this.props.settings)||{}:this.state?.expandModel||{};switch(this.props.folderMode){case"expand":case"collapse":{const i=this.resetExpandModel(e,"expand"===this.props.folderMode);n=t?Object.assign(i,n):Object.assign(i,this.state.expandModel||{});break}case"custom":this.props.setupExpandModel&&(n=this.props.setupExpandModel(n,e,t))}return n};getExpandModel=()=>this.state.expandModel;expandWithModel=e=>{this.saveExpandModel(e),this.prepareDataForRender(this.props.nodes,e,this.props.sorting),this._scrollLeadNodeIntoView()};expandAll=()=>{this.expandAllExcept([])};expandAllExcept=e=>{const t=this.resetExpandModel(this.props.nodes,!0);e.forEach((e=>{this._setExpandModelElement(t,e,!1)})),this.saveExpandModel(t),this.prepareDataForRender(this.props.nodes,t,this.props.sorting),this._scrollLeadNodeIntoView()};isExpanded=e=>Boolean(this.findTreeItem(e)?.isExpanded);onImport=()=>{this.props.onImport&&this.props.onImport()};setClipboard=(e,t)=>{const{isValidForClipboard:n,getDragData:i,mimeType:s}=this.props;if(!s||!n||!i)return;const o=this.getAllSelectedItems().filter((e=>n(e))).map((e=>e.id));e.clipboardData.setData("vivaldi/x-cut",t),e.clipboardData.setData(s,JSON.stringify(o)),e.clipboardData.setData("text/plain",i("text/plain",o));const a=this.selectionModel.leadIndex;-1!==a&&e.clipboardData.setData("text/html",i("text/html",[a])),e.stopPropagation(),e.preventDefault()};contextMenuSpy=e=>{this._canCutCopyPaste=!1;const t=this.getWrapper();let n=e.target;for(;n;){if(n===t){this._canCutCopyPaste=!0;break}n=n.parentNode}};keyDownSpy=e=>{this._canCutCopyPaste=!0};onPaste=e=>{if(e.preventDefault(),!this._canCutCopyPaste)return;const{mimeType:t,onPaste:n}=this.props;if(n){const t=this.getSelectedItem();return void(t&&n(e,t))}if(!t)return;const i=this.getTargetFromSelection(),s=e.clipboardData;if(!s)return;const o=-1!==s.types.findIndex((e=>e===t))?JSON.parse(s.getData(t)):[];if(0===o.length)return;if("true"===s.getData("vivaldi/x-cut")){if(!(this.props.cutIds&&this.props.cutIds.length>0)||!this.props.onMove)return;this.props.onMove(o,i.parentId,i.index,"on").then((e=>{this.setCutIds([]),this.selectionModel.setSelectedIds(e);const{onSelect:t}=this.props;if(e.length>0&&t){const n=this.findTreeItem(e[0]);n&&t(n)}this.rerenderVisibleTreeItems()}))}else{const e=(0,is.Z)(o.map((e=>this.findTreeItem(e))));this.props.onCreate&&this.props.onCreate(e,i.parentId,i.index,!1).then((e=>{const t=Array.isArray(e)?e:e?.items||[];Boolean(t)&&t.length>0&&(this.selectionModel.setSelectedIds(t.map((e=>e.id))),this.SelectionMixinSetLead(t[0].id),this.rerenderVisibleTreeItems())}))}};moveNode=(e,t)=>{this.props.onMove&&this.canMoveUpDown(e,t)&&(t?this.props.onMove([e.id],e.parentId,e.index-1,"above"):this.props.onMove([e.id],e.parentId,e.index+2,"below"))};canMoveUpDown=(e,t)=>{if(!0===t&&0===e.index)return!1;if(!1===t){let t=0;if(e.parentId===this.props.rootId)t=this.props.nodes.length,t>0&&this.props.nodes[t-1].trash&&t--;else{const n=this.findTreeItem(e.parentId);n&&n.children&&(t=n.children.length)}if(e.index+1>=t)return!1}const n=!!this.props.sorting&&this.props.sorting.sortOrder!==ns.Z.NO_SORTING,i=!this.props.supportsUpDownMove||this.props.supportsUpDownMove(e,t);return!n&&i};getKeyEventMap=()=>({esc:this.onKeyEscUp,up:this.onKeyArrowUp,down:this.onKeyArrowDown,"alt+up":this.onKeyArrowUp,"alt+down":this.onKeyArrowDown,left:this._collapseFolderOrSelectParent,right:this._expandFolder,del:this.onKeyDelete,home:this.onKeyHome,end:this.onKeyEnd,pageup:this.onKeyPageUp,pagedown:this.onKeyPageDown,"shift+del":this.onKeyShiftDelete,"shift+up":this.onKeyArrowUp,"shift+down":this.onKeyArrowDown,"shift+home":this.onKeyHome,"shift+end":this.onKeyEnd,"shift+pageup":this.onKeyPageUp,"shift+pagedown":this.onKeyPageDown,"ctrl+a":this.onKeySelectAll,"ctrl+left":this._collapseFolderOrSelectParent,"ctrl+right":this._expandFolder,"ctrl+space":this.onKeyCtrlSpace,"ctrl+up":this.onKeyCtrlUp,"ctrl+down":this.onKeyCtrlDown});enableCutCopyPasteListeners=e=>{if(this._canCutCopyPaste=e,this._hasCutCopyPasteListeners!==e){this._hasCutCopyPasteListeners=e;const{document:t}=this.context;this._hasCutCopyPasteListeners?(t.addEventListener("cut",this.onCut),t.addEventListener("copy",this.onCopy),t.addEventListener("paste",this.onPaste),t.addEventListener("contextmenu",this.contextMenuSpy),t.addEventListener("keydown",this.keyDownSpy)):(t.removeEventListener("cut",this.onCut),t.removeEventListener("copy",this.onCopy),t.removeEventListener("paste",this.onPaste),t.removeEventListener("contextmenu",this.contextMenuSpy),t.removeEventListener("keydown",this.keyDownSpy))}};onLostFocus=()=>{this.stopInlineEditTimer(),this.enableCutCopyPasteListeners(!1),this.setState({hasFocus:!1})};onGotFocus=()=>{if(-1===this.state.inlineEditId){let e=this.getSelectedItem();e&&-1===this._findTreeIndex(e.id)&&(e=void 0),this.props.autoFocus&&!e&&this.state.renderedArray.length>0&&this.selectById(this.state.renderedArray[0].id),this.enableCutCopyPasteListeners(!0),this.setState({hasFocus:!0})}};scrollIntoView=e=>{this.refTreeListEntries.current?.scrollToRow(e)};setSelectedIds=e=>{this.selectionModel.resetSelectionModel(),this.selectionModel.selectAll(e),this.saveSelectionModel(),this.updateSelectionState()};selectByIndex=e=>{this.state.renderedArray.length>e&&this.selectByNode(this.state.renderedArray[e])};selectById=(e,t,n)=>{const i=-1===e?void 0:this.props.onSelect?this.findTreeItem(e):{id:e};this.selectByNode(i,t,n)};selectByNode=(e,t,n)=>{const i=e?e.id:-1;this.props.onSelect&&(e&&this.selectionModel.FirstSingleItemSelected===e.id||this.props.onSelect(e)),n||(n=this._findTreeIndex(i)),-1!==n&&this.scrollIntoView(n),t?this.SelectionMixinSelectItem(i,t.ctrlKey,t.shiftKey,t.metaKey,"contextmenu"===t.type):this.SelectionMixinSelectItem(i),this.saveSelectionModel()};scrollToId=e=>{this.scrollIntoView(this._findTreeIndex(e))};onItemClick=(e,t)=>{t.stopPropagation(),this.props.onItemClick&&this.props.onItemClick(t,e)};onItemDoubleClick=(e,t)=>{this.stopInlineEditTimer(),this.props.onItemDoubleClick&&(this.props.canDoubleClick&&this.props.canDoubleClick(e)||!this.props.isFolder(e))&&this.props.onItemDoubleClick(t,e)};onItemMouseDown=(e,t,n)=>{if(vn.Z.isNavigationButton(n.button))return;const i=this.selectionModel.selectedIds;let s=!1;for(const t of i)if(t.id===e.id){s=!0;break}this.state.hasFocus&&s&&1===i.length&&n.button===vn.Z.kLeft&&!(0,Bu.Z)(n)&&n.target instanceof HTMLElement&&"title"===n.target.className&&n.timeStamp-this._leftMouseTimeStamp>300?this.startInlineEditTimerForId(e.id):this.stopInlineEditTimer();const o=n.ctrlKey;s&&!o||(s&&o&&1===i.length?this.unSelectAll():this.selectByNode(e,n)),"function"==typeof this.props.onItemMouseDown&&this.props.onItemMouseDown(e,n),n.button===vn.Z.kLeft&&(this._leftMouseTimeStamp=n.timeStamp),t&&this.focusTree()};onItemMouseUp=(e,t)=>{if(vn.Z.isNavigationButton(t.button))return;const n=this.selectionModel.selectedIds,i=t.ctrlKey;n.length>1&&t.button!==vn.Z.kRight&&!i&&this.selectByNode(e,t),this.props.onItemMouseUp?.(e,t)};onContextMenuOpen=(e,t)=>{t&&this.scrollIntoView(this._findTreeIndex(t.id))};rerenderVisibleTreeItems=()=>{this.refTreeListEntries.current?.recomputeRowHeights()};getParentAndIndex=(e,t)=>{let n,i;if(e)if(this.props.isFolder(e))n=e.id,!e.isExpanded&&t&&this.toggleExpandModel(e.id);else{n=e.parentId;const{id:t}=e;if(n===this.props.rootId)this.props.nodes&&(i=this.props.nodes.findIndex((e=>e.id===t))+1);else{const e=this.findTreeItem(n);e&&e.children&&(i=e.children.findIndex((e=>e.id===t))+1)}}else n=this.props.rootId;return{parentId:n,index:i}};getTargetFromSelection=()=>{const e=this.selectionModel.FirstSingleItemSelected;let t;return e&&-1!==e&&(t=this.findTreeItem(e),this.props.isValidAddTarget&&!this.props.isValidAddTarget(t)&&(t=void 0)),this.getParentAndIndex(t,!0)};onAdd=async(e,t)=>{const n={children:e?[]:void 0,isNew:!0};t&&(n.title=t.title,n.content=t.content,n.url=t.url,n.separator=t.separator);const{parentId:i,index:s}=this.getTargetFromSelection();if(!this.props.onCreate)return;const o=await this.props.onCreate([n],i,s,!0);if(!o)return;const a=Array.isArray(o)?o:o.items,r=!Array.isArray(o)&&o.props.edit;if(1!==a.length)return;const[l]=a;this.getSelected()!==l.id&&this.selectByNode(l),r&&this.startInlineEdit(l.id)};onSave=()=>{const{onSave:e}=this.props;e&&e(this.getAllSelectedItems().map((e=>e.id)))};onSaveAll=()=>{this.props.onSave&&this.props.onSave([])};onExport=()=>{const{onExport:e}=this.props;e&&e(this.getAllSelectedItems().map((e=>e.id)))};onExportAll=()=>{this.props.onExport&&this.props.onExport([])};onDelete=e=>{let t=this.getAllSelectedItems().map((e=>e.id));if(this.props.validateForDeletion&&(t=this.props.validateForDeletion(t)),t.length>0){if(!this.props.confirmDelete)return this.setState({isDeleting:!0}),this.onDeleteItems(t,e);this.props.confirmDelete(t).then((n=>{if(n)return this.setState({isDeleting:!0}),this.onDeleteItems(t,e)}))}return Promise.resolve()};onDeleteItems=(e,t)=>{if(e&&e.length>0){let n=-1;const i=this.selectionModel.selectedIds;for(const e of i){const t=this._findTreeIndex(e.id);(-1===n||t<n)&&(n=t)}n<0&&(n=0);const s=this.state.renderedArray[n];if(!this.props.delete)return Promise.resolve();let o=void 0!==s.parentId?this.findTreeItem(s.parentId):void 0;const a=e=>{this.selectByNode(e),e&&this.props.activateAfterDelete&&this.props.activateAfterDelete(e)};return this.props.delete(e,t).then((()=>{if(this.props.disableSelectAfterDelete)return;const t=this.state.renderedArray.filter((t=>!e.includes(t.id)));if(0===t.length)a(void 0);else if(o)if(this.props.hasChildren(o)&&(o={...o},o.children=o.children.filter((t=>!e.includes(t.id))),o.children=this.sortItems(o.children,this.props.sorting)),this.props.hasChildren(o)){const e=o.children;if(1===e.length)a(e[0]);else{const i=e[0],s=e[e.length-1],o=this._findTreeIndex(i.id),r=this._findTreeIndex(s.id);if(n<=o)a(i);else if(n>=r)a(s);else{let i=0;if(r-o+1>e.length){const e=n-o;for(let n=0;n<e;n++){const e=t[o+n];this.props.hasChildren(e)&&e.isExpanded&&(i-=e.children.length)}}const s=e[n-o+i];a(s)}}}else a(o);else{let e=this.state.renderedArray.filter((e=>e.parentId===this.props.rootId||!0===e.trash));const i=e.findIndex((e=>e.id===s.id));if(i>=0){e=t.filter((e=>e.parentId===this.props.rootId||!0===e.trash));const n=e.length-1,s=e[Math.min(i,n)];a(s)}else{const e=t.length-1,i=t[Math.min(n,e)];a(i)}}})).catch((()=>{}))}return Promise.resolve()};onKeyCtrlUp=Eu.throttleSync((e=>{const t=this.selectionModel.leadIndex,n=this._findTreeIndex(t);if(0===n)return;const i=-1===n?this.state.renderedArray.length-1:n-1;if(i<0)return;const s=this.state.renderedArray[i];this.SelectionMixinSetLead(s.id),this.scrollIntoView(i)}));onKeyCtrlDown=Eu.throttleSync((e=>{const t=this.selectionModel.leadIndex,n=this._findTreeIndex(t);if(n===this.state.renderedArray.length-1)return;const i=n+1,s=this.state.renderedArray[i];this.SelectionMixinSetLead(s.id),this.scrollIntoView(i)}));onKeyArrowDown=Eu.throttleSync((e=>{const t=this.selectionModel.leadIndex,n=this._findTreeIndex(t);if(n!==this.state.renderedArray.length-1){if(!0===e.altKey)this.moveNode(this.state.renderedArray[n],!1);else{const t=n+1,i=this.state.renderedArray[t];this.selectByNode(i,e,t)}e.preventDefault(),e.stopPropagation()}}));onKeyArrowUp=Eu.throttleSync((e=>{const t=this.selectionModel.leadIndex,n=this._findTreeIndex(t);if(0!==n){if(!0===e.altKey)this.moveNode(this.state.renderedArray[n],!0);else{const t=-1===n?this.state.renderedArray.length-1:n-1;if(t<0)return;const i=this.state.renderedArray[t];this.selectByNode(i,e,t)}e.preventDefault(),e.stopPropagation()}}));onKeyEscUp=e=>{this.selectionModel.setSelectedIds([])};onKeyHome=e=>{const t=this.state.renderedArray[0];this.selectByNode(t,e,0),e.preventDefault(),e.stopPropagation()};onKeyEnd=e=>{const t=this.state.renderedArray.length,n=this.state.renderedArray[t-1];this.selectByNode(n,e,t-1),e.preventDefault(),e.stopPropagation()};onKeyPageDown=Eu.throttleSync((e=>{const t=this.selectionModel.leadIndex,n=this._findTreeIndex(t),i=this.state.renderedArray.length;let s=this.state.height,o=n;for(;o<i-1;){const e="function"==typeof this.props.rowHeight?this.props.rowHeight({index:o}):this.props.rowHeight||zu;if(!(s>=e))break;s-=e,o++}if(o===n)return;const a=this.state.renderedArray[o];this.selectByNode(a,e,o),e.preventDefault(),e.stopPropagation()}));onKeyPageUp=Eu.throttleSync((e=>{const t=this.selectionModel.leadIndex,n=this._findTreeIndex(t);let i=this.state.height,s=n;for(;s>0;){const e="function"==typeof this.props.rowHeight?this.props.rowHeight({index:s}):this.props.rowHeight||zu;if(!(i>=e))break;i-=e,s--}if(s===n)return;const o=this.state.renderedArray[s];this.selectByNode(o,e,s),e.preventDefault(),e.stopPropagation()}));onKeyShiftDelete=e=>{this.onKeyDelete(e,!0)};onKeyDelete=(e,t=!1)=>{this.onDelete(t),e.preventDefault(),e.stopPropagation()};onKeySelectAll=()=>{this.SelectionMixinSelectAll(),this.saveSelectionModel()};onKeyCtrlSpace=e=>{const t=this.selectionModel.leadIndex;this.SelectionMixinSelectItem(t,e.ctrlKey,e.shiftKey,e.metaKey,"contextmenu"===e.type)};_setExpandState=(e,t)=>{if(this.state.expandModel&&this.selectionModel.isSingleItemSelected){const e=this.findTreeItem(this.selectionModel.leadIndex);e&&(e.isExpanded&&!t||!e.isExpanded&&t)&&-1!==this.selectionModel.FirstSingleItemSelected&&this.toggleExpandModel(this.selectionModel.FirstSingleItemSelected)}e.preventDefault(),e.stopPropagation()};_collapseFolderOrSelectParent=e=>{const t=this.getSelectedItem();if(t&&!0===this.isfolderAndHasItems(t)&&t.isExpanded)this._setExpandState(e,!1);else{const e=this.selectionModel.leadIndex;if(e){const t=this._findTreeIndex(e);if(t){const e=this.state.renderedArray[t].level;for(let n=t-1;n>=0;n--){const t=this.state.renderedArray[n];if(t.level<e){this.selectByNode(t);break}}}}}};expandToId=e=>{let t=this.findTreeItem(e);for(;t;)t=this.findTreeItem(t.parentId),t&&this.isFolder(t)&&!t.isExpanded&&this.toggleExpandModel(t.id)};_expandFolder=e=>{const t=this.getSelectedItem();t&&!0===this.isfolderAndHasItems(t)&&this._setExpandState(e,!0)};unSelectAll=()=>{this.selectByNode(void 0)};isItemLead=e=>e===this.selectionModel.leadIndex;isItemSelected=e=>this.selectionModel.isSelected(e);supportDropForItem=(e,t)=>this.props.getDropSupport?this.props.getDropSupport(e,t):{available:!1,onto:!1,edge:!1};onDragLeaveItem=(e,t)=>{this.cancelDragOverObject(),this.resetAutoExpandTimer()};onDragOverItem=(e,t,n,i)=>{const s=i.currentTarget;if(!this.supportDropForItem(e,i).available)return;const o=s.getBoundingClientRect(),a="function"==typeof this.props.rowHeight?this.props.rowHeight({index:t}):this.props.rowHeight||zu,r=(i.clientY-o.top)/a;let l="";!0===n.onto?l=r<=.25?n.edge?"above":"on":r>.75&&n.edge?"below":"on":n.edge&&(r<=.5?l="above":r>.5&&(l="below")),(this.state.dragOverObj.id!==e.id||this.state.dragOverObj.id===e.id&&this.state.dragOverObj.position!==l)&&this.setState({dragOverObj:{id:e.id,position:l}},this.initAutoExpandTimer(e,l))};initAutoExpandTimer=(e,t)=>{e.isExpanded||!this.props.isFolder(e)||"on"!==t?this.resetAutoExpandTimer():this.expandId!==e.id&&(this.resetAutoExpandTimer(),this.expandId=e.id,this.expandTimer=setTimeout(this.onAutoExpandTimer,1200))};resetAutoExpandTimer=()=>{this.expandTimer&&(clearTimeout(this.expandTimer),this.expandTimer=void 0,this.expandId=-1)};onAutoExpandTimer=()=>{-1!==this.expandId&&(this.state.dragOverObj.id===this.expandId&&"on"===this.state.dragOverObj.position&&this.toggleExpandModel(this.expandId),this.resetAutoExpandTimer())};onDragEmptyArea=e=>{if(this.state.renderedArray.length>0){const t=this.state.renderedArray[this.state.renderedArray.length-1];this._dropSupport=this.supportDropForItem(t,e),this._dropSupport.available&&this._dropSupport.edge&&(e.preventDefault(),e.nativeEvent.dataTransfer.dropEffect="move",this.state.dragOverObj.id!==t.id&&"below"!==this.state.dragOverObj.position&&this.setState({dragOverObj:{id:t.id,position:"below"}}))}e.stopPropagation()};onDropEmptyArea=e=>{if(this.resetAutoExpandTimer(),this.state.renderedArray.length>0&&this._dropSupport.available){const t=this.state.renderedArray[this.state.renderedArray.length-1];this.onDrop(t,this._dropSupport,e),this._dropSupport={available:!1,onto:!1,edge:!1}}e.preventDefault(),e.stopPropagation()};onDrop=(e,t,n)=>{this.resetAutoExpandTimer();const i=Jt.ZP.isCopyModifierPressed(n),s=this.state.dragOverObj.position,{mimeType:o}=this.props;switch(s){case"above":case"below":if(!1===t.edge)return void this.cancelDragOverObject();break;case"on":if(!1===t.onto)return void this.cancelDragOverObject();break;default:return void this.cancelDragOverObject()}let a;if(o&&n.dataTransfer&&-1!==n.dataTransfer.types.findIndex((e=>e===o))?a=JSON.parse(n.dataTransfer.getData(o)):this.props.onDrop&&this.props.onDrop(n,e,s).then((e=>{this.cancelDragOverObject(),e&&e.length>0&&this.selectByNode(e[0])})),!a||a.length<=0)return void this.cancelDragOverObject();const r=this.props.isFolder(e);let l=!1,d={id:e.id,index:0,parentId:void 0};this.props.getTargetSpec?d=this.props.getTargetSpec(e,s):"above"===s?(d.index=parseInt(e.index),d.parentId=e.parentId):"on"===s?d.parentId=r?e.id:e.parentId:"below"===s&&(e.isExpanded?d.parentId=e.id:(d.index=parseInt(e.index)+1,d.parentId=e.parentId));const c=a.map((t=>{if(t===e.id)return void(l=!0);const n=this.findTreeItem(t);if(i||!this.props.isFolder(n)||!n||!this.findItemInFolder(n,e.id))return n;l=!0})).filter((e=>null!==e));if(l||c.length<=0)this.cancelDragOverObject();else if(i){const e=(0,is.Z)(c);this.props.onCreate&&this.props.onCreate(e,d.parentId,d.index,!1).then(this.cancelDragOverObject())}else{const e=c.map((e=>e.id));this.props.onMove?.(e,d.parentId,d.index,s).then((()=>{this.cancelDragOverObject()}))}};cancelDragOverObject=()=>{this.setState({dragOverObj:this.emptyDragOverObj})};onDragEndItem=()=>{this.cancelDragOverObject()};onCompositionStart=()=>{this._isComposing=!0};onCompositionEnd=()=>{this._isComposing=!1};onKeyDown=async e=>{const{ctrlKey:t,altKey:n,shiftKey:i,metaKey:s}=e,o={ctrlKey:t,altKey:n,shiftKey:i,metaKey:s},a=(0,xr.VV)(o);if(this.stopInlineEditTimer(),-1!==this.state.inlineEditId)return void("Escape"===e.key&&a?(e.preventDefault(),await this.cancelInlineEdit(),this.focusTree()):"Enter"!==e.key||this._isComposing?e.key===Gu&&e.preventDefault():(e.preventDefault(),await this.saveInlineEdit(),this.focusTree()));if("Escape"===e.key&&a)this.setCutIds([]),e.preventDefault();else if("\\"===e.key&&this.props.supportsCollapseAll)this.collapseAll();else if(this.props.supportsInlineEdit&&e.key===Gu){const t=!0===this.props.supportsInlineEdit?this.getSelectedItem():void 0;if(t){return void(this.startInlineEdit(t.id)&&e.preventDefault())}}let r=!1;if(this.props.onItemsActivated&&"Enter"===e.key){if(!1===e.repeat){const t=this.getAllSelectedItems();t&&this.props.onItemsActivated&&this.props.onItemsActivated(e,t)}r=!0,e.preventDefault()}var l=wd.Z.keyComboFromEvent(e.nativeEvent),d=this.getKeyEventMap()[l];d&&d(e.nativeEvent),!r&&this.props.onKeyDown&&this.props.onKeyDown(e)};startInlineEditTimerForId=e=>{this.stopInlineEditTimer(),!0===this.props.supportsInlineEdit&&(this.inlineEditTimeoutId=setTimeout(this.startInlineEdit.bind(this,e),700))};stopInlineEditTimer=()=>{-1!==this.inlineEditTimeoutId&&(clearTimeout(this.inlineEditTimeoutId),this.inlineEditTimeoutId=-1)};startInlineEditForSelectedItem=()=>{const e=this.selectionModel.FirstSingleItemSelected;-1!==e&&this.startInlineEdit(e)};startInlineEdit=e=>{const t=this.selectionModel.selectedIds;if(1===t.length&&t[0].id===e){const t=this.state.renderedArray.filter((t=>t.id===e));if(1===t.length&&this.props.isValidToEdit?.(t[0].id))return this.setState({inlineEditId:e,inlineEditText:this.props.getTitle?this.props.getTitle(e):""}),!0}return!1};getInlineEditId=()=>-1===this.state.inlineEditId?void 0:this.state.inlineEditId;setInlineEditText=e=>{const t=e.target.value;this.setState({inlineEditText:t})};cancelInlineEdit=()=>new Promise((e=>{this.setState({inlineEditId:-1,inlineEditText:""},e)}));saveInlineEdit=()=>new Promise(((e,t)=>{if(-1===this.state.inlineEditId||!this.props.saveTitle)return t();this.props.saveTitle(this.state.inlineEditId,this.state.inlineEditText),this.setState({inlineEditId:-1,inlineEditText:""},e)}));onRowsRendered=e=>{this.props.onRowsRendered&&(this.props.onRowsRendered(e),f.Z.set({[this._onRowsRenderedOptions]:e})),this.updateScrollTop()};updateScrollTop=()=>{if(this._scrollTopNeedsUpdate){this._scrollTopNeedsUpdate=!1;const e=f.Z.getSync(this._scrollTopSettings);this.refTreeListEntries.current?.scrollToPosition(e)}};onScroll=(0,Zr.Z)((e=>{const{scrollTop:t}=e;this._scrollTopSettings&&f.Z.set({[this._scrollTopSettings]:t})}),500);getSelectedItem=()=>this.findTreeItem(this.selectionModel.leadIndex);isFolder=e=>e&&this.props.isFolder(e);isfolderAndHasItems=e=>e.children&&e.children.length>0;getSelected=()=>this.selectionModel.FirstSingleItemSelected;shouldRenderExpanded=(e,t)=>"0"===e.id||!0===t[e.id]||"expand"===this.props.folderMode&&void 0===t[e.id];getRenderedItems=(e,t,n)=>{const i=[];if(!e||0===e.length)return i;e=this.sortItems(e,n);const s=n&&n.sortOrder!==ns.Z.NO_SORTING,o=e=>{if(!(s&&this.props.isSeparator&&this.props.isSeparator(e)))if(i.push(e),this.props.hasChildren(e)){if(e.isExpanded=this.shouldRenderExpanded(e,t),e.isExpanded)for(const t of e.children)t.level=e.level+1,o(t)}else delete e.isExpanded};for(const t of e)t.level=0,o(t);return i};canSort=e=>e&&e.sortOrder&&e.sortOrder!==ns.Z.NO_SORTING;sortItems=(e,t)=>{if(!t||!this.canSort(t)||t?.onlyScroll)return e;!1!==this.props.supportsDeepCopy&&(e=(0,is.Z)(e));const n=t.comparator||ns.Z.getDefaultComparator(t.sortOrder,t.sortField);return ns.Z.treeSort(e,n),e};getSelectedFromTree=()=>{const e=[],t=function(n,i){for(let s=0;s<i.length;s++){const o=i[s];n.selectionModel.isSelected(o.id)?e.push(o):o.children&&t(n,o.children)}};return t(this,this.props.nodes),e};getAllSelectedItems=()=>{const e=this.selectionModel.selectedIds;if(0===e.length)return e;if(e.length>1&&!this.canSort(this.props.sorting))return this.getSelectedFromTree();const t=function(e,n){for(let i=0;i<e.length;i++){let s=e[i];if(s.id===n)return s;if(s.children&&(s=t(s.children,n),s))return s}},n=e.map((e=>t(this.props.nodes,e.id))).filter((e=>void 0!==e));return this.sortItems(n,this.props.sorting)};findTreeItem=e=>{let t=null;const n=i=>{if(i.id===e)return t=i;i.children&&i.children.forEach(n)};return this.props.nodes.forEach(n),t};findItemInFolder=(e,t)=>{let n=null;const i=e=>{if(e.id===t)return n=e;e.children&&e.children.forEach(i)};return e.children.forEach(i),n};getIdsBetween=(e,t)=>{const n=this._findTreeIndex(e),i=this._findTreeIndex(t);let s=[];return s=n>i?this.state.renderedArray.slice(i,n+1):this.state.renderedArray.slice(n,i+1),s.map((e=>e.id))};getAllIds=()=>this.state.renderedArray.map(((e,t)=>e.id||t));getSearchStyle=()=>{let e=f.Z.getSync(this._searchStyleSettings);return void 0===e&&(e="tree"),e};setSearchStyle=e=>{const t={};t[this._searchStyleSettings]=e,f.Z.set(t,(()=>{this.props.onSearchStyleChanged&&this.props.onSearchStyleChanged(e)}))};getNamedContextMenuItems=(e,t)=>{const n=this.context.vivaldiWindowId,i=Ai.getOptionFunction(e.name),{document:s}=this.context,o=e.getState?e.getState():{};return Ai.getNamedMenu(n,e.name,(async a=>{switch(a.action){case"CONTEXT_EXPAND_ALL":return{handler:this.expandAll,visible:e.getVisibility(a,t),...i(n,a,o)};case"CONTEXT_COLLAPSE_ALL":return{handler:this.collapseAll,...i(n,a,o),visible:e.getVisibility(a,t)};case"CONTEXT_NEW_ITEM":return{handler:()=>{this.onAdd(!1)},visible:e.getVisibility(a,t),...i(n,a,o)};case"CONTEXT_NEW_FOLDER":return{handler:()=>{this.onAdd(!0)},visible:e.getVisibility(a,t),...i(n,a,o)};case"CONTEXT_NEW_SEPARATOR":return{handler:()=>{this.onAdd(!1,{separator:!0})},visible:e.getVisibility(a,t),...i(n,a,o)};case"CONTEXT_EDIT":return{handler:()=>{this.props.onEdit?.()},visible:e.getVisibility(a,t)&&"function"==typeof this.props.onEdit,...i(n,a,o)};case"CONTEXT_RENAME":return{handler:()=>{this.startInlineEditForSelectedItem()},visible:e.getVisibility(a,t),...i(n,a,o),shortcuts:[Gu]};case"CONTEXT_CUT":return{handler:()=>{s.execCommand("cut")},visible:e.getVisibility(a,t),...i(n,a,o),shortcuts:["ctrl+x"]};case"CONTEXT_COPY":return{handler:()=>{s.execCommand("copy")},visible:e.getVisibility(a,t),...i(n,a,o),shortcuts:["ctrl+c"]};case"CONTEXT_PASTE":return{handler:()=>{s.execCommand("paste")},visible:e.getVisibility(a,t),...i(n,a,o),shortcuts:["ctrl+v"]};case"CONTEXT_SAVE":return{handler:()=>{this.onSave()},visible:e.getVisibility(a,t),...i(n,a,o)};case"CONTEXT_SAVE_ALL":return{handler:()=>{this.onSaveAll()},visible:e.getVisibility(a,t),...i(n,a,o)};case"CONTEXT_EXPORT":return{handler:()=>{this.onExport()},visible:e.getVisibility(a,t),...i(n,a,o)};case"CONTEXT_EXPORT_ALL":return{handler:()=>{this.onExportAll()},visible:e.getVisibility(a,t),...i(n,a,o)};case"CONTEXT_DELETE":return{handler:()=>{this.onDelete(!1)},visible:e.getVisibility(a,t),...i(n,a,o),shortcuts:["delete"]};case"CONTEXT_IMPORT":return{handler:()=>{this.onImport()},visible:e.getVisibility(a,t),...i(n,a,o)};case"CONTEXT_CONTAINER_SEARCH":{const s=this.getSearchStyle();return{items:[{type:"radio",radiogroup:1,checked:"flat"===s,handler:this.setSearchStyle.bind(this,"flat"),...(0,Mn.Z)("Flat Search")},{type:"radio",radiogroup:1,checked:"tree"===s,handler:this.setSearchStyle.bind(this,"tree"),...(0,Mn.Z)("Tree Search")}],visible:e.getVisibility(a,t),...i(n,a,o)}}default:return e.getCapability(a,i,t,o)}}))};getContextMenuItemsPromise=e=>this.props.getContextMenuItemsPromise?this.props.getContextMenuItemsPromise(e).then((t=>this.appendStandardMenuItems(e,t))):Promise.resolve([]);getContextMenuItems=e=>{if(!0===this.props.appendContextItems){let t=this.appendStandardMenuItems(e,[]);const n=this.props.getContextMenuItems?this.props.getContextMenuItems(e):[];return t.length>0&&n.length>0&&(t=t.concat([G.Z.separatorItem]),t=t.concat(n)),t}{const t=this.props.getContextMenuItems?this.props.getContextMenuItems(e):[];return this.appendStandardMenuItems(e,t)}};appendStandardMenuItems=(e,t)=>{const n=this.props.getContextMenuItemProps?this.props.getContextMenuItemProps(e):{},i=()=>{t.length>0&&(t=t.concat([G.Z.separatorItem]))};if((n.showNewItem||n.showNewFolder||n.showNewSeparator||n.showEdit||n.showMoveUp||n.showMoveDown||n.showRename)&&(i(),n.showNewItem&&t.push({handler:()=>{this.onAdd(!1)},testVisibility:()=>n.showNewItem,...this.props.getContextMenuNewItemString?this.props.getContextMenuNewItemString():G.Z.makeLabelPair("")}),n.showNewFolder&&t.push({handler:()=>{this.onAdd(!0)},testVisibility:()=>n.showNewFolder,...(0,Mn.Z)("command","New Folder")}),n.showNewSeparator&&t.push({handler:()=>{this.onAdd(!1,{separator:!0})},testVisibility:()=>n.showNewSeparator,...(0,Mn.Z)("New Separator")}),(n.showEdit||n.showRename)&&i(),n.showEdit&&t.push({handler:()=>{this.props.onEdit&&this.props.onEdit()},testVisibility:()=>n.showEdit,...(0,Mn.Z)("verb","Edit")}),n.showRename&&t.push({handler:()=>this.startInlineEditForSelectedItem(),testVisibility:()=>n.showRename,shortcuts:[Gu],...(0,Mn.Z)("Rename")}),(n.showMoveUp||n.showMoveDown)&&(i(),t.push({handler:()=>{const e=this.getSelectedItem();e&&this.moveNode(e,!0)},testVisibility:()=>n.showMoveUp,shortcuts:["alt+up"],...(0,Mn.Z)("Move Up")}),t.push({handler:()=>{const e=this.getSelectedItem();e&&this.moveNode(e,!1)},testVisibility:()=>n.showMoveDown,shortcuts:["alt+down"],...(0,Mn.Z)("Move Down")}))),n.showCut||n.showCopy||n.showPaste){i();const{document:e}=this.context;t=t.concat([{handler:()=>{e.execCommand("cut")},visible:!0===n.showCut,shortcuts:["ctrl+x"],...(0,Mn.Z)("verb","Cut")},{handler:()=>{e.execCommand("copy")},visible:!0===n.showCopy,shortcuts:["ctrl+c"],...this.props.getContextMenuCopyString?this.props.getContextMenuCopyString():(0,Mn.Z)("verb","Copy")},{handler:()=>{e.execCommand("paste")},shortcuts:["ctrl+v"],visible:!0===n.showPaste,...(0,Mn.Z)("verb","Paste")}])}if((n.showSave||n.showSaveAll)&&(i(),n.showSave&&(t=t.concat([{handler:()=>{this.onSave()},...this.props.getContextMenuSaveString?this.props.getContextMenuSaveString():(0,Mn.Z)("verb","Save")}])),n.showSaveAll&&(t=t.concat([{handler:()=>{this.onSaveAll()},...this.props.getContextMenuSaveAllString?this.props.getContextMenuSaveAllString():(0,Mn.Z)("verb","Save All")}]))),(n.showExport||n.showExportAll)&&(i(),n.showExport&&(t=t.concat([{handler:()=>{this.onExport()},...this.props.getContextMenuExportString?this.props.getContextMenuExportString():(0,Mn.Z)("verb","Export")}])),n.showExportAll&&(t=t.concat([{handler:()=>{this.onExportAll()},...this.props.getContextMenuExportAllString?this.props.getContextMenuExportAllString():(0,Mn.Z)("verb","Export All")}]))),n.showDelete&&(i(),t.push({handler:()=>{this.onDelete(!1)},shortcuts:["delete"],...this.props.getContextMenuDeleteString?this.props.getContextMenuDeleteString():(0,Mn.Z)("verb","Delete")})),n.showExpandCollapse&&(i(),t=t.concat([{handler:this.expandAll,...(0,Mn.Z)("Expand All Folders")},{handler:this.collapseAll,...(0,Mn.Z)("Collapse All Folders")}])),n.showImport&&(i(),t.push({handler:this.onImport,ellipsis:!0,...this.props.getContextMenuImportString?this.props.getContextMenuImportString():(0,Mn.Z)("Import")})),n.showSettings){i();const e=this.getSearchStyle();t=t.concat([{items:[{type:"checkbox",checked:"flat"===e,handler:this.setSearchStyle.bind(this,"flat"),...(0,Mn.Z)("Flat Search")},{type:"checkbox",checked:"tree"===e,handler:this.setSearchStyle.bind(this,"tree"),...(0,Mn.Z)("Tree Search")}],...(0,Mn.Z)("Settings")}])}return n.showCustomSettings&&(i(),this.props.addCustomSettingMenu&&(t=t.concat([this.props.addCustomSettingMenu()]))),n.showFullscreen&&(i(),t=t.concat([{handler:()=>Ru.Z.toggleFullscreen(this.context.vivaldiWindowId),...(0,Mn.Z)("Fullscreen")}])),t};onResize=e=>{const t=e[0].contentRect;this.updateTreeSize(t.width,t.height)};updateTreeSize=(e,t)=>{this._isMounted&&this.setState({width:e,height:t})};onContextMenu=async e=>{let t;if(e?.button>0&&e.currentTarget?.className?.includes("vivaldi-tree")||(t=this.getSelectedItem()),this.props.menu)return e.persist(),e.preventDefault(),e.stopPropagation(),void(this.props.menu&&this.getNamedContextMenuItems(this.props.menu,t).then((n=>{(0,zi.Z)(this.context.vivaldiWindowId,n,(n=>{n&&this.onContextMenuOpen(e,t)}))(e)})));let n;e.preventDefault(),e.stopPropagation(),this.props.getContextMenuItemsPromise?(e.persist(),n=await this.getContextMenuItemsPromise(t)):n=this.getContextMenuItems(t),(0,zi.Z)(this.context.vivaldiWindowId,n,(n=>{n&&this.onContextMenuOpen(e,t)}))(e)};renderTreeItem=e=>{const{key:t,index:n,style:i}=e,s=this.state.renderedArray[n];void 0===s.id&&(s.id=n);const o=this.selectionModel.isSelected(s.id),a=this.state.renderedArray[n-1]?.id,r=this.state.renderedArray[n+1]?.id,l=n>=0&&a&&this.selectionModel.isSelected(a),d=r&&this.selectionModel.isSelected(r),c=this.selectionModel.leadIndex===s.id,h=this.props.cutIds&&this.props.cutIds.indexOf(s.id)>-1;let p=!1;!0===o&&(p=this.state.hasFocus||s.id===this.state.inlineEditId);let u=this.props.enableDragAndDrop&&this.state.inlineEditId!==s.id;u&&this.props.isValidDragSource&&(u=this.props.isValidDragSource(s));const g=this.state.inlineEditId===s.id?this.state.inlineEditText:void 0,m={node:s,isSelected:o,inlineEditText:g,onChange:this.setInlineEditText,onFocus:Ku,onBlur:()=>{this.saveInlineEdit()}},{rowComponent:v,getRowComponentProps:f}=this.props,y=f?f(m):m;return Hu(Ou,{index:n,Component:v,componentProps:y,treeItem:s,style:i,isExpanded:s.isExpanded,isSeparator:this.props.isSeparator,toggle:this.toggleExpandModel,onContextMenu:this.onContextMenu,onMouseDown:this.onItemMouseDown,onMouseUp:this.onItemMouseUp,selected:o,isFirstSelected:o&&!l,isLastSelected:o&&!d,hasFocus:p,lead:c,isCut:h,validateForDrag:this.props.validateForDrag,onDragStart:this.stopInlineEditTimer,supportDrop:this.props.enableDragAndDrop?this.supportDropForItem:null,onDragLeave:this.props.enableDragAndDrop?this.onDragLeaveItem:null,onDragOver:this.props.enableDragAndDrop?this.onDragOverItem:null,onDragEnd:this.onDragEndItem,onDrop:this.onDrop,mimeType:this.props.mimeType,getDragData:this.props.getDragData,setCustomDragData:this.props.setCustomDragData,dragover:this.state.dragOverObj.id===s.id,dragOverObj:this.state.dragOverObj,inlineEditText:g,getAllSelectedItems:this.getAllSelectedItems,isFolder:this.props.isFolder,isDraggable:u,hasChildren:this.props.hasChildren,onItemClick:this.onItemClick,onItemDoubleClick:this.onItemDoubleClick,enableDragAndDrop:this.props.enableDragAndDrop},t)};getStyle=Uu()(1)((e=>({"--gridColumns":e&&yu(e)})));render(){const e=mn()(this.props.className,{"vivaldi-tree":!this.props.className,"no-selection":-1===this.selectionModel.anchorIndex});return Hu(ts,{style:this.getStyle(this.props.columns),className:e,onBlur:this.onLostFocus,onKeyDown:this.onKeyDown,onDragOver:this.props.enableDragAndDrop?this.onDragEmptyArea:void 0,onDragLeave:this.props.enableDragAndDrop?this.cancelDragOverObject:void 0,onDrop:this.props.enableDragAndDrop?this.onDropEmptyArea:void 0,onClick:this.unSelectAll,onCompositionStart:this.onCompositionStart,onCompositionUpdate:this.onCompositionStart,onCompositionEnd:this.onCompositionEnd,onContextMenu:this.onContextMenu,onResize:this.onResize},void 0,(0,fn.jsx)(Vu.aV,{ref:this.refTreeListEntries,onRowsRendered:this.onRowsRendered,onScroll:this.onScroll,width:this.state.width,height:this.state.height,rowHeight:this.props.rowHeight||zu,rowRenderer:this.renderTreeItem,rowCount:this.state.renderedArray.length,overscanRowCount:0,onScrollbarPresenceChange:this.props.onScrollbarPresenceChange,scrollToAlignment:this.props.scrollToAlignment,containerStyle:{pointerEvents:"auto"}}))}}const Yu=ju;var Xu;function Qu(e,t,n,i){Xu||(Xu="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Xu,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const qu=[{text:(0,le.Z)("title","Name"),value:"filename",fullScreenTitle:(0,le.Z)("Sort by Name")},{text:(0,le.Z)("Type"),value:"extension",fullScreenTitle:(0,le.Z)("Sort by Type")},{text:(0,le.Z)("Size"),value:"bytesReceived",fullScreenTitle:(0,le.Z)("Sort by Size")},{text:(0,le.Z)("Date"),value:"startTime",fullScreenTitle:(0,le.Z)("Sort by Date")},{text:(0,le.Z)("Address"),value:"url",fullScreenTitle:(0,le.Z)("Sort by Address")}];class Ju extends tn.PureComponent{refTreeList=tn.createRef();static contextType=dn.Z;winId=this.context.vivaldiWindowId;getExtension=e=>{const t=e?e.lastIndexOf("."):-1;return-1!==t?e.substring(t+1):""};sortForExtension=(e,t)=>{const{sortOrder:n}=this.props;if(n<=ns.Z.NO_SORTING)return 0;const i=e,s=t;let o=this.getExtension(i.filename),a=this.getExtension(s.filename);if(!o&&!a)return 0;if(!o)return n===ns.Z.ASCENDING_SORT?1:-1;if(!a)return n===ns.Z.ASCENDING_SORT?-1:1;if("number"==typeof o&&"number"==typeof a)return n===ns.Z.ASCENDING_SORT?o-a:a-o;if(o=o.toString().toLowerCase(),a=a.toString().toLowerCase(),o>a)return n===ns.Z.ASCENDING_SORT?1:-1;if(o<a)return n===ns.Z.ASCENDING_SORT?-1:1;return ns.Z.getDefaultComparator(n,"filename")(e,t)};returnFalse=()=>!1;selectByIds=e=>{e.forEach((e=>{this.refTreeList.current?.selectById(e,{ctrlKey:!0,metaKey:!0})}))};selectByNode=e=>{this.refTreeList.current?.selectByNode(e)};selectByIndex=e=>{this.refTreeList.current?.selectByIndex(e)};scrollToId=e=>{this.refTreeList.current?.scrollToId(e)};isSelected=e=>this.refTreeList.current?.isItemSelected(e);getSelectedNodes=()=>this.refTreeList.current?.selectionModel.selectedIds||[];getSelectedNode=()=>this.refTreeList.current?.getSelectedItem();onNodeMouseDown=()=>{this.refTreeList.current?.focusTree()};onNodeSelected=e=>{e?this.props.onSelected(parseInt(e.id)<0?void 0:e):this.props.onSelected(void 0)};onNodeDoubleClick=(e,t)=>{this.props.onOpen(t.id)};onNodesActivated=(e,t)=>{t.forEach((e=>{this.props.onOpen(e.id)}))};handleErase=e=>(this.props.nodes.filter((t=>e.includes(t.id))).forEach((({id:e})=>this.props.onErase(e))),Promise.resolve());rowComponent=e=>{const t=e.node;return Qu(pu,{item:t,onErase:this.props.onErase,onShow:this.props.onShow,onPause:this.props.onPause,onResume:this.props.onResume,onValidateMixedDownload:this.props.onValidateMixedDownload},t.id)};render(){const e=z.ZP.isIncognito(this.winId),t={sortOrder:this.props.sortOrder,sortField:this.props.sortField,comparator:this.sortForExtension,onlyScroll:"extension"!==this.props.sortField};return(0,fn.jsxs)(fn.Fragment,{children:[$p.Z.hasDownloads({isIncognitoWindow:e})&&Qu(Iu,{fields:qu,manualSorting:!1,onSortChange:this.props.onSortChange,keyAccess:this.props.keyAccess,sortField:this.props.sortField,sortOrder:this.props.sortOrder}),Qu("section",{className:"outerScrollbar"},void 0,(0,fn.jsx)(Yu,{ref:this.refTreeList,settings:"DOWNLOADS_TREE",rowComponent:this.rowComponent,nodes:this.props.nodes,menu:this.props.menu,isFolder:this.returnFalse,hasChildren:this.returnFalse,delete:this.handleErase,onSelect:this.onNodeSelected,enableDragAndDrop:!1,onItemMouseDown:this.onNodeMouseDown,onItemDoubleClick:this.onNodeDoubleClick,onItemsActivated:this.onNodesActivated,rowHeight:52,sorting:t}))]})}}const eg=Ju;var tg,ng=n(34155);function ig(e,t,n,i){tg||(tg="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:tg,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function sg(e,t){const n="startTime";if("extension"===e)return n;if(t===ns.Z.ASCENDING_SORT)return e;switch(e){case"bytesReceived":return"-bytesReceived";case"endTime":return"-endTime";case"filename":return"-filename";case"startTime":return"-startTime";case"url":return"-url"}return n}const og=[D.kDownloadsPanelEditorHeight];function ag(e){return"complete"===e.state&&e.mime.startsWith("image/")}var rg=ig(zp,{});class lg extends tn.PureComponent{static contextType=dn.Z;winId=this.context.vivaldiWindowId;nodeRef=tn.createRef();refTree=tn.createRef();defaultHeight=M.Z.getDefault(D.kDownloadsPanelEditorHeight);state={downloadItems:[],hasActiveDownloadItemsSelected:!1,hasPausedDownloadItemsSelected:!1,hasCompletedDownloadItemsSelected:!1,hasCompletedDownloadItems:!1,selectedDownloadItem:void 0,filter:$p.Z.getFilter(),editorHeight:M.Z.get(D.kDownloadsPanelEditorHeight),...M.Z.get(D.kDownloadsPanelSorting)};componentDidMount(){Dl.ZP.addListener(this.onPanelStoreChange),$p.Z.addListener(this.onDownloadStoreChange),g.Z.setOrderBy(sg(this.state.sortField,this.state.sortOrder)),g.Z.setSearchFilter(this.state.filter),z.ZP.addListener(this._onWindowStoreChange),this.fetchDownloadItemsAndUpdateState()}componentDidUpdate(e,t){return t.filter!==this.state.filter?this.fetchDownloadItemsAndUpdateState():"extension"===this.state.sortField||t.sortField===this.state.sortField&&t.sortOrder===this.state.sortOrder?(t.selectedDownloadItem!==this.state.selectedDownloadItem&&this.updateActiveProgressState(),void(!e.open&&this.props.open&&ng.nextTick((()=>{this.focusTree(),0===this.refTree.current?.getSelectedNodes().length&&this.refTree.current?.selectByIndex(0)})))):this.fetchDownloadItemsAndUpdateState()}componentWillUnmount(){$p.Z.removeListener(this.onDownloadStoreChange),Dl.ZP.removeListener(this.onPanelStoreChange),z.ZP.removeListener(this._onWindowStoreChange)}fetchDownloadItemsAndUpdateState=()=>new Promise((e=>{const t=z.ZP.isIncognito(this.winId),n=$p.Z.getItems({isIncognitoWindow:t});let i;this.state.selectedDownloadItem&&(i=n.find((e=>{if(this.state.selectedDownloadItem)return e.id===this.state.selectedDownloadItem.id})),this.updateActiveProgressState());const s=n;this.setState({filter:$p.Z.getFilter(),selectedDownloadItem:i,downloadItems:s,hasCompletedDownloadItems:n.length>0,...M.Z.get(D.kDownloadsPanelSorting)},e)}));scrollDownloadItemIntoView=e=>{this.refTree.current?.scrollToId(e.id)};selectDownloadItem=e=>{this.refTree.current?.selectByNode(e)};onDownloadStoreChange=e=>{switch(e.reason){case"download_completed":{const{downloadItem:t}=e;return void this.onTransferFinished(t)}case"download_started":{const{downloadItem:t}=e;return void this.fetchDownloadItemsAndUpdateState().then((()=>{this.scrollDownloadItemIntoView(t),this.selectDownloadItem(t)}))}case"download_panel_updated":return void this.fetchDownloadItemsAndUpdateState()}};onPanelStoreChange=(e,t)=>{e===this.winId&&this.props.open&&"setFocus"===t&&!ss(this.nodeRef.current)&&this.focusTree()};_onWindowStoreChange=()=>{this.props.open&&z.ZP.isActive(this.winId)&&g.Z.forceUpdate()};onTransferFinished=e=>{y.Z.windows.getLastFocused((t=>{if(t.id!==this.winId)return;if(!M.Z.get(D.kDownloadsNotifyOnComplete))return;if(!e)return;const n=e.filename.split("\\").pop().split("/").pop();const i=(0,le.Z)("Download Complete"),s=g.Z.showDownload.bind(null,e.id);y.Z.downloads.getFileIcon(e.id,{size:32},(e=>{(0,Ct.c)({body:n,icon:e,title:i,onClick:s})}))})),this.updateActiveProgressState()};getMenuState=()=>{const e=this.updateActiveProgressState();return{numAddresses:this.getNumSelectedAddresses(),numFiles:this.getNumSelectedFiles(),numImages:this.getNumSelectedImages(),hasPaused:e.hasPausedDownloadItemsSelected,hasCompleted:e.hasCompletedDownloadItemsSelected,hasActive:e.hasActiveDownloadItemsSelected}};getMenuCapability=async(e,t,n,i)=>{const s=this.winId;switch(e.action){case"CONTEXT_OPEN_FILE":return{handler:this.openSelected,visible:Boolean(n)&&i.hasCompleted&&i.numFiles>0,...t(s,e,i)};case"CONTEXT_OPEN_IN":return{visible:Boolean(n)&&i.numImages>0&&i.numFiles>0,...t(s,e,i)};case"CONTEXT_OPEN_IN_NEW_TAB":return{handler:()=>{this.openSelectedInTab(!1,M.Z.get(D.kTabsOpenNewInBackground))},visible:Boolean(n)&&i.numImages>0&&i.numFiles>0,...t(s,e,i)};case"CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB":return{handler:()=>{this.openSelectedInTab(!1,!0)},visible:Boolean(n)&&!M.Z.get(D.kTabsOpenNewInBackground)&&i.numImages>0&&i.numFiles>0,...t(s,e,i)};case"CONTEXT_OPEN_IN_TAB":return{handler:()=>{this.openSelectedInTab(!0,!1)},visible:Boolean(n)&&i.numImages>0&&i.numFiles>0,...t(s,e,i)};case"CONTEXT_OPEN_IN_NEW_WINDOW":return{handler:()=>{this.openSelectedInWindow(!1)},visible:Boolean(n)&&i.numImages>0&&i.numFiles>0,...t(s,e,i)};case"CONTEXT_OPEN_IN_PRIVATE_WINDOW":return{handler:()=>{this.openSelectedInWindow(!0)},visible:Boolean(n)&&i.numImages>0&&i.numFiles>0,...t(s,e,i)};case"CONTEXT_FILEMANAGER":return{handler:()=>{this.showSelectedInFilemanager()},visible:Boolean(n)&&i.numFiles>0,...t(s,e,i)};case"CONTEXT_COPY_ADDRESS":return{handler:()=>{this.copySelectedAddress()},visible:Boolean(n),...t(s,e,i)};case"CONTEXT_COPY_PATH":return{handler:()=>{this.copySelectedPath()},visible:Boolean(n)&&i.hasCompleted&&i.numFiles>0,...t(s,e,i)};case"CONTEXT_RESTART":return{handler:()=>{this.restartSelected()},visible:Boolean(n)&&(i.hasCompleted||this.fileErrors()),...t(s,e,i)};case"CONTEXT_STOP":return{handler:()=>{this.stopSelected()},visible:Boolean(n)&&i.hasActive,...t(s,e,i)};case"CONTEXT_RESUME":return{handler:()=>{this.resumeSelected()},visible:Boolean(n)&&i.hasPaused,...t(s,e,i)};case"CONTEXT_REMOVE":return{handler:()=>{this.removeSelected()},visible:Boolean(n),...t(s,e,i)};case"CONTEXT_REMOVE_ALL_FINISHED":return{handler:()=>{this.removeAllFinished()},visible:Boolean(n)&&i.hasCompleted,...t(s,e,i)};default:return{...t(s,e,i)}}};getSelectedDownloadItems=()=>{const e=this.refTree.current?.getSelectedNodes().map((e=>e.id))||[];return this.state.downloadItems.filter((t=>-1!==e.findIndex((e=>e===t.id))))};getNumSelectedImages=()=>this.getSelectedDownloadItems().filter(ag).length;getNumSelectedAddresses=()=>this.getSelectedDownloadItems().filter((e=>Boolean(e.url))).length;getNumSelectedFiles=()=>{let e=0;const t=this.getSelectedDownloadItems();for(let n=0;n<t.length;n++){const i=t[n];i.exists&&!i.error&&e++}return e};fileErrors=()=>{const e=this.getSelectedDownloadItems().map((e=>e.error));if(e.length)return!e.includes(void 0)};getActiveProgressStateForSelectedDownloadItems=()=>{const e=this.getSelectedDownloadItems(),t=this.state.downloadItems;let n=!1,i=!1,s=!1,o=!1;for(let t=0;t<e.length;t++){const a=e[t];if("in_progress"===a.state?a.paused?i=!0:n=!0:"complete"===a.state&&(s=o=!0),n&&i&&s)break}return o=o||!!t.find((e=>"complete"===e.state)),{hasActiveDownloadItemsSelected:n,hasPausedDownloadItemsSelected:i,hasCompletedDownloadItemsSelected:s,hasCompletedDownloadItems:o}};updateActiveProgressState=()=>{const e=this.getActiveProgressStateForSelectedDownloadItems();return this.setState(e),e};canResumeSelected=()=>{const e=this.getSelectedDownloadItems();if(1===e.length){return e[0].canResume}return!1};stopSelected=()=>{this.getSelectedDownloadItems().filter((e=>!e.paused)).forEach((({id:e})=>g.Z.pauseDownload(e)))};resumeSelected=()=>{this.getSelectedDownloadItems().filter((e=>e.canResume)).forEach((({id:e})=>g.Z.resumeDownload(e)))};restartSelected=()=>{this.getSelectedDownloadItems().forEach((({id:e})=>g.Z.restartDownload(e)))};showSelectedInFilemanager=()=>{this.getSelectedDownloadItems().forEach((({id:e})=>g.Z.showDownload(e)))};onSortChange=(e,t)=>{nt.Z.set(D.kDownloadsPanelSorting,{sortOrder:e,sortField:t});const n=sg(t,e);g.Z.setOrderBy(n),"extension"===t&&this.setState({sortField:t,sortOrder:e})};openSelected=()=>{this.getSelectedDownloadItems().forEach((e=>{"complete"===e.state&&g.Z.openDownload(e.id)}))};openSelectedInTab=(e,t)=>{const n=this.getSelectedDownloadItems().filter((e=>"complete"===e.state&&e.mime.startsWith("image/"))).map((e=>"file://"+e.filename));if(n.length>0){const i=n[n.length-1];n.forEach((n=>{const s={inCurrent:e,inBackground:t};!1===t&&(s.inBackground=n!==i),Y.Z.openURL(this.context.vivaldiWindowId,n,s),e=!1}))}};openSelectedInWindow=e=>{const t=this.getSelectedDownloadItems().filter((e=>"complete"===e.state&&e.mime.startsWith("image/"))).map((e=>"file://"+e.filename)),n={inNewWindow:!0,incognito:e};t.forEach((e=>{Y.Z.openURL(this.context.vivaldiWindowId,e,n)}))};onSelected=e=>{this.setState({selectedDownloadItem:e},(()=>{g.Z.forceUpdate(),this.updateActiveProgressState()}))};removeAllFinished=()=>{this.state.downloadItems.filter((e=>"complete"===e.state)).forEach((({id:e})=>g.Z.eraseDownload(e)))};removeSelected=()=>{this.getSelectedDownloadItems().forEach((({id:e})=>g.Z.eraseDownload(e)))};copySelectedAddress=()=>{const e=this.getSelectedDownloadItems().map((e=>e.url));0!==e.length&&navigator.clipboard.writeText(e.join("\n"))};copySelectedPath=()=>{const e=this.getSelectedDownloadItems().filter((e=>"complete"===e.state)).map((e=>e.filename));0!==e.length&&navigator.clipboard.writeText(e.join("\n"))};getItemPath=Uu()(1)((e=>this.getSelectedDownloadItems().find((t=>t.id===e))?.filename??""));handleFilterChange=e=>{const t=e.target.value;this.setState({filter:t},(()=>g.Z.setSearchFilter(t)))};onSlidebarPosition=(e,t)=>{this.setState((e=>({editorHeight:Math.max(Math.min(e.editorHeight-t,246),0)})))};onSlideBarStop=()=>{this.setState((e=>{const t=e.editorHeight<Q.Cn?0:e.editorHeight;return nt.Z.set(D.kDownloadsPanelEditorHeight,parseInt(t)),{editorHeight:t}}))};onSlidebarToggle=()=>{this.setState((e=>{let t=e.editorHeight;return t>Q.Cn?(t=0,nt.Z.set(D.kDownloadsPanelEditorHeight,t)):(t=246,nt.Z.reset(D.kDownloadsPanelEditorHeight)),{editorHeight:parseInt(t)}}))};focusTree=()=>{this.refTree.current?.refTreeList.current?.focusTree()};showSelectedDownloadItem=()=>{this.state.selectedDownloadItem&&g.Z.showDownload(this.state.selectedDownloadItem.id)};menu={name:"downloadlist",getState:this.getMenuState,getCapability:this.getMenuCapability,getVisibility:()=>!1};render(){if(!this.props.open)return null;const e=this.canResumeSelected(),t=z.ZP.isIncognito(this.winId),n=!$p.Z.hasDownloads({isIncognitoWindow:t});return(0,fn.jsxs)("div",{ref:this.nodeRef,className:mn()("panel","downloads",{isEmpty:n}),children:[ig(Vp,{title:this.props.title,filter:this.state.filter,onFilterChange:this.handleFilterChange,keyAccess:this.props.keyAccess,canResumeDownload:e,onDownloadResume:this.resumeSelected,hasPausedTransfersSelected:this.state.hasPausedDownloadItemsSelected,hasActiveTransfersSelected:this.state.hasActiveDownloadItemsSelected,hasCompletedTransfersSelected:this.state.hasCompletedDownloadItemsSelected,hasCompletedTransfers:this.state.hasCompletedDownloadItems,onStopSelectedDownload:this.stopSelected,onRestartSelectedDownload:this.restartSelected,downloadItem:this.state.selectedDownloadItem?this.state.selectedDownloadItem:void 0,onRemoveSelected:this.removeSelected,onRemoveAllFinished:this.removeAllFinished}),(0,fn.jsx)(eg,{ref:this.refTree,keyAccess:this.props.keyAccess,menu:this.menu,nodes:this.state.downloadItems,onSelected:this.onSelected,onSortChange:this.onSortChange,sortField:this.state.sortField,sortOrder:this.state.sortOrder,onErase:g.Z.eraseDownload,onResume:g.Z.resumeDownload,onPause:g.Z.pauseDownload,onShow:g.Z.showDownload,onOpen:g.Z.openDownload,onValidateMixedDownload:g.Z.validateMixedDownload}),n?rg:ig("section",{className:mn()("download-editor",{collapsed:0===this.state.editorHeight}),style:{flexBasis:this.state.editorHeight}},void 0,ig(gu,{onSlidebarPosition:this.onSlidebarPosition,onStop:this.onSlideBarStop,onDoubleClick:this.onSlidebarToggle,position:"bottom",returnOffset:!0}),this.state.editorHeight>0&&ig(Dp,{downloadItem:this.state.selectedDownloadItem,keyAccess:this.props.keyAccess,onShow:this.showSelectedDownloadItem,canResumeDownload:e,hasPausedTransfersSelected:this.state.hasPausedDownloadItemsSelected,onDownloadResume:this.resumeSelected,getItemPath:this.getItemPath}))]})}}const dg=(0,fs.Z)(lg,og);var cg;function hg(e,t,n,i){cg||(cg="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:cg,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class pg extends tn.PureComponent{state={downloadProgress:0,isPopupVisible:!1};componentDidMount(){$p.Z.addListener(this._onDownloadStoreChange),Qi.Z.addListener("COMMAND_SHOW_DOWNLOADS_POPOUT",this.onCommandSpy)}componentWillUnmount(){$p.Z.removeListener(this._onDownloadStoreChange),Qi.Z.removeListener("COMMAND_SHOW_DOWNLOADS_POPOUT",this.onCommandSpy)}_onDownloadStoreChange=()=>{this.setState({downloadProgress:$p.Z.getTotalProgress()})};onCommandSpy=(e,t)=>{this.state.isPopupVisible||this.setState({isPopupVisible:!0})};hidePopup=()=>{this.setState({isPopupVisible:!1})};togglePopup=()=>{this.setState((e=>({isPopupVisible:!e.isPopupVisible})))};render(){return hg(sl,{id:"downloads",popupClassName:"download-popout",tooltip:(0,le.Z)("Downloads"),alwaysMenu:!0,onClick:this.togglePopup,customizeMenu:this.props.customizeMenu,menuOrigin:this.props.menuOrigin,popupPosition:this.props.popupPosition,hidePopup:this.hidePopup,isPopupVisible:this.state.isPopupVisible,popupWidth:360,image:cn.izi[this.props.size],progress:this.state.downloadProgress,isPopupResizable:!0,draggable:this.props.draggable,onDragStart:this.props.onDragStart??Tl.default,onDragEnd:this.props.onDragEnd??Tl.default,onDrop:this.props.onDrop??Tl.default,onDragEnter:this.props.onDragEnter??Tl.default,onDragLeave:this.props.onDragLeave??Tl.default,onDragOver:this.props.onDragOver??Tl.default,mimeType:this.props.mimeType,name:this.props.name},void 0,hg(dg,{keyAccess:-1,title:(0,le.Z)("Downloads"),panelId:"bar",open:!0,onOpenDialog:Tl.default}))}}const ug=Br(pg);class gg extends tn.Component{static contextType=dn.Z;state={width:25,height:25,hasLoadedPopup:!1};popupContainer=tn.createRef();webviewelm=null;componentWillUnmount(){this.detachListeners(),this.webviewelm=null}getNode(){return this.popupContainer.current}attachListeners=()=>{this.webviewelm?.addEventListener("sizechanged",this.onSizeChanged),this.webviewelm?.addEventListener("close",this.onClose),this.webviewelm?.addEventListener("newwindow",this.onNewWindow),this.webviewelm?.addEventListener("loadstop",this.onLoadStop),this.webviewelm?.addEventListener("dialog",this.onShowDialog),wd.Z.bind("esc",this.onCloseWithKeyboard)};focusPopup=()=>{const e=this.popupContainer.current?.parentElement?.parentElement?.parentElement?.querySelector(".focus-popup-area");e&&e.focus()};detachListeners=()=>{this.webviewelm?.removeEventListener("sizechanged",this.onSizeChanged),this.webviewelm?.removeEventListener("close",this.onClose),this.webviewelm?.removeEventListener("newwindow",this.onNewWindow),this.webviewelm?.removeEventListener("loadstop",this.onLoadStop),this.webviewelm?.removeEventListener("dialog",this.onShowDialog),wd.Z.unbind("esc",this.onCloseWithKeyboard)};handleClickOutside=e=>{this.props.popupWantsToClose()};removeWebView=()=>{this.detachListeners(),this.webviewelm&&(this.popupContainer.current?.removeChild(this.webviewelm),this.webviewelm=null),this.setState({hasLoadedPopup:!1})};recreateWebView=()=>{this.webviewelm&&this.removeWebView(),d.Z.zoom.getVivaldiUIZoom((e=>{const t=this.popupContainer.current;if(!t)return;this.props.extensionAnchor?.current?.appendChild(t);let n=800,i=600;e>=1&&(n=Math.round(800*e),i=Math.round(600*e));const{extensionId:s,popupPage:o}=this.props;if(s&&o){const e=document.createElement("webview");e.setAttribute("windowId",String(this.context.vivaldiWindowId)),e.setAttribute("autosize","on"),e.setAttribute("minwidth",String(25)),e.setAttribute("minheight",String(25)),e.setAttribute("maxwidth",String(n)),e.setAttribute("maxheight",String(i)),e.setAttribute("partition","persist:"+s),e.setAttribute("class","ignore-react-onclickoutside"),e.setAttribute("vivaldi_view_type","extension_popup"),e.setAttribute("src",o),t?.appendChild(e),this.webviewelm=e,this.attachListeners()}}))};onSizeChanged=e=>{this.setState({width:e.newWidth,height:e.newHeight})};onLoadStop=e=>{this.props.enableOnClickOutside(),this.setState({hasLoadedPopup:!0}),setTimeout((e=>{this.webviewelm&&this.webviewelm.focus()}),50)};onNewWindow=e=>{e.window.accept(this.context.vivaldiWindowId+";1")};onShowDialog=e=>{this.props.disableOnClickOutside(),e.webview=this.webviewelm,e.preventDefault(),e.dialogtype="javascript",ie.Z.showDialog(this.context.vivaldiWindowId,e,this.onClose)};onCloseWithKeyboard=()=>{this.props.popupWantsToClose(),this.focusPopup()};onClose=()=>{this.props.popupWantsToClose()};render(){let e=0,t=0,n=0;if(this.props.popupRect){const i=this.props.popupRect;e="above"===this.props.popupPosition?i.top-this.state.height-10+6:i.bottom+10-6,t=i.left+i.width/2-this.state.width/2,t=Math.min(Math.max(t,6),this.context.innerWidth-this.state.width-6),n=i.left-t+i.width/2-10}const i=this.state.hasLoadedPopup&&this.props.popupVisible;return(0,fn.jsx)("div",{className:mn()({"extension-popup":!0,bottom:"above"===this.props.popupPosition,top:"below"===this.props.popupPosition}),style:{"--anchorPosition":n+"px",height:this.state.height,width:this.state.width,position:"fixed",left:t,top:e,visibility:i?"visible":"hidden"},ref:this.popupContainer})}}const mg=(0,Vr.Z)(gg);var vg,fg=n(10334);function yg(e,t,n,i){vg||(vg="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:vg,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const wg=[D.kAddressBarExtensionsRenderInDropdown,D.kAddressBarExtensionsShowAllToggle,D.kAddressBarExtensionsVisible,D.kAddressBarPosition,D.kAddressBarVisible],bg=["mousedown","pointerdown","touchstart"],Cg="vivaldi/x-button-extension";class Sg extends tn.PureComponent{static contextType=dn.Z;refExtensionAnchor=tn.createRef();state={extensions:[],popupId:null,popupPage:null,popupVisible:!1,popupRect:void 0,extensionPopup:!1,shouldToggleHiddenExtensionsOnly:!1,shouldRenderHiddenExtensionsOnToolbar:!1,shouldRenderAllExtensionsOnToolbar:!1};_extensionActionShortcuts=[];_removedIdToIndex={};_shortcutCallbacks=[];_toolbarButtons=[];refWrapper=tn.createRef();extensionActionPopupRef=tn.createRef();componentDidMount(){d.Z.extensionActionUtils.onAdded.addListener(this.onActionAdded),d.Z.extensionActionUtils.onRemoved.addListener(this.onActionRemoved),d.Z.extensionActionUtils.onUpdated.addListener(this.onActionChanged),d.Z.extensionActionUtils.onCommandAdded.addListener(this.onCommandAdded),d.Z.extensionActionUtils.onCommandRemoved.addListener(this.onCommandRemoved),d.Z.extensionActionUtils.onIconLoaded.addListener(this.onIconLoaded),d.Z.extensionActionUtils.getToolbarExtensions((e=>{const t=f.Z.getSync("EXTENSION_BUTTON_ORDER_BROWSER");e.sort(((e,n)=>t.indexOf(e.id)-t.indexOf(n.id))),this.setState({extensions:e}),e.filter((e=>this.isExtensionAvailable(e))).forEach((e=>{const t=this.getExtensionIndex(e.id);this.updateShortcut(e.id,e.keyboardShortcut,t)}))})),fg.g2.addListener(this.extensionSubscriber)}componentDidUpdate(e,t){!t.extensionPopup&&this.state.extensionPopup&&this.refWrapper.current?.focus()}componentWillUnmount(){d.Z.extensionActionUtils.onAdded.removeListener(this.onActionAdded),d.Z.extensionActionUtils.onRemoved.removeListener(this.onActionRemoved),d.Z.extensionActionUtils.onUpdated.removeListener(this.onActionChanged),d.Z.extensionActionUtils.onIconLoaded.removeListener(this.onIconLoaded),d.Z.extensionActionUtils.onCommandAdded.removeListener(this.onCommandAdded),d.Z.extensionActionUtils.onCommandRemoved.removeListener(this.onCommandRemoved),fg.g2.removeListener(this.extensionSubscriber)}toggleExtensionToolbar(e){e.preventDefault(),nt.Z.toggle(D.kAddressBarExtensionsVisible,!0,!1)}extensionSubscriber=e=>{const t=this._toolbarButtons.find((t=>t?.props.name===e)),n=this.props.prefValues[D.kAddressBarVisible];this.state.popupId!==e&&this.setState({popupVisible:!1,popupPage:null,popupRect:void 0,popupId:null});const i=t&&n?t.getRect():(()=>{const e=document.getElementById("webview-container");if(!e)return;const{right:t,top:n,bottom:i}=e.getBoundingClientRect();return{top:i,left:t-25,bottom:n,width:0,height:0,right:0}})();this.onExtensionActionClicked(e,i)};getExtensionIndex=e=>this.state.extensions.findIndex((t=>t.id===e));onIconLoaded=({badgeIcon:e,id:t})=>{const n=this.getExtensionIndex(t);-1!==n&&this.setState((t=>{const i=t.extensions.slice();return i[n]&&(i[n].badgeIcon=e),{extensions:i}}))};assignShortcut=(e,t,n)=>{if(!t)return;this._extensionActionShortcuts[n]=t;const i=this._toolbarButtons[n],s=i?.getRect();this._shortcutCallbacks[n]=()=>{if(s&&0!==s.left)i&&this.onExtensionActionClicked(e,s);else if(this.refExtensionAnchor?.current){const t=this.refExtensionAnchor.current.getBoundingClientRect(),n={top:0,bottom:t.top,left:t.right-34-20,right:t.right-20,width:34,height:34};this.onExtensionActionClicked(e,n)}},wd.Z.bind(t.toLowerCase(),this._shortcutCallbacks[n])};removeShortcut=(e,t)=>{e&&(wd.Z.unbind(e.toLowerCase(),this._shortcutCallbacks[t]),this._extensionActionShortcuts[t]="",delete this._shortcutCallbacks[t])};updateShortcut=(e,t,n)=>{(t||this._extensionActionShortcuts[n])&&(t&&!this._extensionActionShortcuts[n]?this.assignShortcut(e,t,n):!t&&this._extensionActionShortcuts[n]?this.removeShortcut(t,n):t!==this._extensionActionShortcuts[n]&&(this.removeShortcut(t,n),this.assignShortcut(e,t,n)))};onActionChanged=(e,t)=>{if(this.context.vivaldiWindowId===t){const t=this.getExtensionIndex(e.id);-1!==t&&this.setState((n=>{const i=n.extensions.slice();return i[t]=e,{extensions:i}}),this.updateShortcut.bind(this,e.id,e.keyboardShortcut,t))}};saveBrowserOrder(){f.Z.set({EXTENSION_BUTTON_ORDER_BROWSER:this.state.extensions.map((e=>e.id))})}onActionAdded=e=>{this.setState((t=>{const n=this._removedIdToIndex[e.id];delete this._removedIdToIndex[e.id];const i=t.extensions.slice();return"number"==typeof n&&n<t.extensions.length?i.splice(n,0,e):i.push(e),{extensions:i}}),this.saveBrowserOrder)};onActionRemoved=e=>{const t=this.getExtensionIndex(e.id);-1!==t&&this.setState((n=>{this._removedIdToIndex[e.id]=t;const i=n.extensions.slice();return i.splice(t,1),{extensions:i}}),this.saveBrowserOrder)};onCommandAdded=(e,t)=>{const n=this.getExtensionIndex(e);this.assignShortcut(e,t,n)};onCommandRemoved=(e,t)=>{const n=this.getExtensionIndex(e);this.removeShortcut(t,n)};onExtensionActionClicked=(e,t,n)=>{const i=this.getExtensionIndex(e),s=this.state.extensions[i];if(s&&!s.visible){let e;return n&&n.target instanceof HTMLElement&&(e=n.target),void this.getContextMenu(s).then((t=>{(0,zi.Z)(this.context.vivaldiWindowId,t,void 0,this.props.menuOrigin,e)()}))}d.Z.extensionActionUtils.executeExtensionAction(e,this.context.vivaldiWindowId,(n=>{n&&(this.setState((i=>({popupVisible:!i.popupVisible,popupPage:n,popupRect:t,popupId:e}))),this.state.popupVisible&&this.extensionActionPopupRef.current?.recreateWebView())}))};popupWantsToClose=()=>{this.setState({popupVisible:!1}),this.extensionActionPopupRef.current?.removeWebView()};onDrop=(e,t,n)=>{if(!this._dragOverId)return;let i=this.getExtensionIndex(this._dragOverId);if(this._dragOverId=null,-1===i)return;const s=e.dataTransfer.getData(Cg);if(!s)return;const o=this.getExtensionIndex(s);if(-1===o||o===i)return;if("right"===t&&i++,o===i)return;e.stopPropagation();const a=this.state.extensions[o],r=this.state.extensions.slice();r.splice(o,1),o<i&&i--,r.splice(i,0,a),this.setState((e=>({extensions:r})),this.saveBrowserOrder)};onDragStart=e=>{e.stopPropagation()};onDragEnter=e=>{this._dragOverId=e};executeExtensionAction=(e,t)=>{if(this.state.popupVisible)return void this.setState({popupVisible:!1});const{HTMLElement:n}=this.context;t.target instanceof n&&(this.state.popupId!==e&&this.setState({popupVisible:!1,popupPage:null,popupRect:void 0,popupId:null}),this.onExtensionActionClicked(e,t.target.getBoundingClientRect(),t))};removeExtension=e=>{d.Z.extensionActionUtils.removeExtension(e,this.context.vivaldiWindowId)};showOptionsPage=e=>{d.Z.extensionActionUtils.showExtensionOptions(e,this.context.vivaldiWindowId)};toggleVisiblity=e=>{this.state.extensionPopup&&this.hideHiddenExtensionsPopup(),d.Z.extensionActionUtils.toggleBrowserActionVisibility(e)};isExtensionAvailable=e=>!(z.ZP.isIncognito(this.context.vivaldiWindowId)&&!e.allowInIncognito);getHiddenExtensions=()=>this.state.extensions.filter((e=>e.actionIsHidden));hasHiddenExtensions=()=>this.state.extensions.some((e=>e.actionIsHidden));toggleHiddenExtensionsPopup=()=>{this.setState((e=>({extensionPopup:!e.extensionPopup})))};hideHiddenExtensionsPopup=()=>{this.setState({extensionPopup:!1})};onCustomMenuSelected=(e,t)=>{d.Z.extensionActionUtils.executeMenuAction(e,this.context.vivaldiWindowId,t,(e=>{y.Z.runtime.lastError&&y.Z.runtime.lastError.message&&console.warn("Error invoking menu item action: "+y.Z.runtime.lastError.message)}))};getContextMenu=e=>new Promise(((t,n)=>{const i=e.homepage||"https://chrome.google.com/webstore/detail/"+e.id,s=this.props.prefValues[D.kAddressBarExtensionsShowAllToggle];d.Z.extensionActionUtils.getExtensionMenu(e.id,(o=>{y.Z.runtime.lastError&&n(y.Z.runtime.lastError);const a=o.map((t=>{const n={handler:this.onCustomMenuSelected.bind(this,e.id,t.id),visible:t.visible,mnemonic:!1,checked:t.checked,...G.Z.makeLabelPair(t.name)};return t.submenu&&(n.items=t.submenu.map((t=>({handler:this.onCustomMenuSelected.bind(this,e.id,t.id),visible:t.visible,mnemonic:!1,checked:t.checked,...G.Z.makeLabelPair(t.name)})))),n})),r=[{handler:()=>Y.Z.openURL(this.context.vivaldiWindowId,i),...G.Z.makeLabelPair(e.name||"")},...a.length>0?[G.Z.separatorItem,...a,G.Z.separatorItem]:[],{handler:()=>this.showOptionsPage(e.id),visible:void 0!==e.optionspage&&""!==e.optionspage,...(0,Mn.Z)("Options")},{handler:()=>this.removeExtension(e.id),visible:"componentAction"!==e.extensionType,ellipsis:!0,...(0,Mn.Z)("Remove Extension")},{handler:()=>this.toggleVisiblity(e.id),visible:!s&&e.actionIsHidden,...(0,Mn.Z)("Show Button")},{handler:()=>this.toggleVisiblity(e.id),visible:!s&&!e.actionIsHidden,...(0,Mn.Z)("Hide Button")},G.Z.separatorItem,{handler:()=>ie.Z.showExtensions(this.context.vivaldiWindowId),...(0,Mn.Z)("Manage Extensions")}];return t(r)}))}));switchToggleButton=()=>{this.props.prefValues[D.kAddressBarExtensionsShowAllToggle]?this.setState((e=>({shouldRenderAllExtensionsOnToolbar:!e.shouldRenderAllExtensionsOnToolbar}))):this.setState((e=>({shouldRenderHiddenExtensionsOnToolbar:!e.shouldRenderHiddenExtensionsOnToolbar})))};renderExtensionToggleButton=()=>yg(sl,{tooltip:(0,le.Z)("Toggle extensions"),onClick:this.switchToggleButton,image:cn.v9y[this.props.size||"large"],customizeMenu:this.props.customizeMenu,menuOrigin:this.props.menuOrigin,hidePopup:this.hideHiddenExtensionsPopup,draggable:this.props.draggable||!1,onDragStart:this.props.onDragStart??Tl.default,onDragEnd:this.props.onDragEnd??Tl.default,onDrop:this.props.onDrop??Tl.default,onDragEnter:this.props.onDragEnter??Tl.default,onDragLeave:this.props.onDragLeave??Tl.default,onDragOver:this.props.onDragOver??Tl.default,mimeType:this.props.mimeType,name:this.props.name});renderHiddenExtensionInPopup=()=>{const{size:e="large"}=this.props,t=this.props.prefValues[D.kAddressBarExtensionsShowAllToggle],n=this.state.extensions.filter((e=>t?this.isExtensionAvailable:t?void 0:e.actionIsHidden&&this.isExtensionAvailable(e)));return yg(sl,{image:cn.v9y[e],tooltip:(0,le.Z)("Show hidden extensions"),onClick:this.toggleHiddenExtensionsPopup,customizeMenu:this.props.customizeMenu,menuOrigin:this.props.menuOrigin,popupPosition:this.props.popupPosition,hidePopup:this.hideHiddenExtensionsPopup,isPopupVisible:this.state.extensionPopup,popupWidth:Math.min(34*n.length,442),className:"extensionPopupIcons",popupClassName:"extensionIconPopupMenu ToolbarButtonPopup-DefaultStyles",hasLightArrow:!0,size:e,hidePopup:this.hideHiddenExtensionsPopup,draggable:this.props.draggable||!1,onDragStart:this.props.onDragStart??Tl.default,onDragEnd:this.props.onDragEnd??Tl.default,onDrop:this.props.onDrop??Tl.default,onDragEnter:this.props.onDragEnter??Tl.default,onDragLeave:this.props.onDragLeave??Tl.default,onDragOver:this.props.onDragOver??Tl.default,mimeType:this.props.mimeType,name:this.props.name},void 0,(0,fn.jsx)("div",{ref:this.refWrapper,className:"toolbar toolbar-mainbar toolbar-wrap",tabIndex:"-1",children:n.map(((e,t)=>{const n=this.getExtensionIndex(e.id);return(0,fn.jsx)(sl,{className:"ExtensionDropdownIcon extensionId",badgeText:e.badgeText,tooltip:e.name,tabIndex:0,draggable:!0,imagePath:e.badgeIcon,ref:e=>this._toolbarButtons[n]=e,onClick:this.executeExtensionAction.bind(this,e.id),menu:this.getContextMenu.bind(this,e),dragImage:e.badgeIcon,onDragEnter:()=>this.onDragEnter(e.id),onDragStart:this.onDragStart,mimeType:Cg,name:e.id,onDrop:this.onDrop},e.id)}))}))};render(){const e=this.props.prefValues[D.kAddressBarExtensionsRenderInDropdown],t=this.state.shouldRenderAllExtensionsOnToolbar&&!e,n=this.state.shouldRenderHiddenExtensionsOnToolbar&&!e,i=this.props.preview?[]:this.state.extensions.filter((e=>this.isExtensionAvailable(e)));if(!this.props.preview&&0===i.length)return(0,fn.jsx)("div",{ref:this.refExtensionAnchor});const s=this.props.prefValues[D.kAddressBarExtensionsShowAllToggle];return(0,fn.jsxs)(fn.Fragment,{children:[yg("div",{className:"toolbar-extensions"},void 0,!this.props.preview&&i.filter((e=>!s&&n||!s&&!e.actionIsHidden||s&&t)).map(((e,t)=>{const n=e.badgeIcon?e.badgeIcon:"data:image/svg+xml;utf8,"+cn.N_W,i={dragImage:n,onDragEnter:()=>this.onDragEnter(e.id),onDragStart:this.onDragStart,onDrop:this.onDrop,mimeType:Cg,name:e.id},o=this.getExtensionIndex(e.id);let a,r=e.badgeBackgroundColor?Dr()(e.badgeBackgroundColor):void 0;return r&&r.alpha()<.5?r=void 0:r&&r?.alpha()<1&&(r=r.alpha(1)),a=e.badgeIcon?e.badgeText:e.name?e.name.charAt(0).toUpperCase():"",(0,fn.jsx)(sl,{badgeColor:r,badgeText:a,onClick:this.executeExtensionAction.bind(this,e.id),menu:this.getContextMenu.bind(this,e),tooltip:e.badgeTooltip||e.name||(0,le.Z)("Extension"),popupClassName:"extensionIconPopupMenu ToolbarButtonPopup-DefaultStyles",size:this.props.size,draggable:!0,className:mn()(e.id,"ExtensionIcon","extensionId",{"ExtensionIcon--Hidden":!s&&e.actionIsHidden}),menuOrigin:this.props.menuOrigin,imagePath:n,popupPosition:this.props.popupPosition,ref:e=>{this._toolbarButtons[o]=e},...i},e.id)})),(this.props.preview||i.length>0&&!e&&(s||!s&&this.hasHiddenExtensions()))&&this.renderExtensionToggleButton(),i.length>0&&e&&(s||this.hasHiddenExtensions()&&!s)&&this.renderHiddenExtensionInPopup(),this.state.popupId&&yg("div",{},void 0,(0,fn.jsx)(mg,{ref:this.extensionActionPopupRef,extensionAnchor:this.refExtensionAnchor,extensionId:this.state.popupId,isAddressBarVisible:this.props.prefValues[D.kAddressBarVisible],eventTypes:bg,outsideClickIgnoreClass:"extensionId",popupVisible:this.state.popupVisible,popupPage:this.state.popupPage,popupPosition:this.props.popupPosition,popupWantsToClose:this.popupWantsToClose,popupRect:this.state.popupRect}))),(0,fn.jsx)("div",{ref:this.refExtensionAnchor})]})}}const Tg=(0,fs.Z)(Br(Sg),wg);var Ig;function kg(e,t,n,i){Ig||(Ig="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Ig,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ag=[D.kStartpageSpeedDialGameButtonShow];var Zg=kg("img",{className:"GamePreviewPopup-PreviewImage",src:"resources/game_screenshot.png"});function Eg(e){return kg("div",{className:"GamePreviewPopup"},void 0,kg("h2",{className:"GamePreviewPopup-HeaderText"},void 0,(0,le.Z)("Vivaldia Game")),kg("button",{className:"GamePreviewPopup-SettingsButton",title:(0,le.Z)("Settings"),dangerouslySetInnerHTML:{__html:cn.bqs.large},onClick:()=>{return t=e.winId,void Y.Z.openURL(t,"vivaldi://settings/startpage/",{inBackground:!1});var t}}),Zg,kg("button",{onClick:()=>{return t=e.winId,void Y.Z.openURL(t,"vivaldi://game/",{inCurrent:!1,inBackground:!1});var t},className:"GamePreviewPopup-StartButton FormButton primary",title:(0,le.Z)("Click to Play")},void 0,(0,le.Z)("Click to Play")))}class _g extends tn.PureComponent{static contextType=dn.Z;state={isPopupOpen:!1,isIconHovered:!1};hidePopup=()=>{this.setState({isPopupOpen:!1})};togglePopup=()=>{this.setState((e=>({isPopupOpen:!e.isPopupOpen})))};menu=()=>[{type:"checkbox",handler:()=>{nt.Z.toggle(D.kStartpageSpeedDialGameButtonShow,!0,!1)},checked:this.props.prefValues[D.kStartpageSpeedDialGameButtonShow],...(0,Mn.Z)("Show Game on Speed Dial")}];render(){const{isStartPage:e}=this.props,t=this.state.isPopupOpen||this.state.isIconHovered&&e?"resources/game_icon_alternate.png":"resources/game_icon.png";return kg(sl,{className:"GameButton",customizeMenu:this.props.customizeMenu||void 0,tooltip:(0,le.Z)("Vivaldia the game"),popupPosition:this.props.popupPosition||"above",name:this.props.name||"Game",image:cn.rNG[this.props.size||"large"],imagePath:e?t:void 0,mimeType:this.props.mimeType||"vivaldi/x-button-toolbar",menu:this.menu,hidePopup:this.hidePopup,onClick:this.togglePopup,isPopupVisible:this.state.isPopupOpen,menuOrigin:this.props.menuOrigin||void 0,popupPosition:this.props.popupPosition||"above",popupWidth:180,draggable:this.props.draggable||!1,onDragStart:this.props.onDragStart||Tl.default,onDragEnd:this.props.onDragEnd||void 0,onDrop:this.props.onDrop||void 0,onDragEnter:this.props.onDragEnter||void 0,onPointerEnter:()=>this.setState({isIconHovered:!0}),onPointerLeave:()=>this.setState({isIconHovered:!1}),popupClassName:"extensionIconPopupMenu ToolbarButtonPopup-DefaultStyles"},void 0,kg(Eg,{winId:this.context.vivaldiWindowId}))}}const Ng=(0,fs.Z)(_g,Ag);class Mg extends tn.PureComponent{static contextType=dn.Z;updateQuery=()=>{const e=Pl.Z.getOptions(),t=Pl.Z.getQuery();if(e.forSender){const n=this.getContactString(t,e.forSender),i=t.substring(n.length);return{query:i.startsWith(" AND ")?i.substring(" AND ".length):i,contactQuery:n}}return{query:t,contactQuery:""}};refSearchInput=tn.createRef();state=this.updateQuery();doDebounceSearch=(0,Zr.Z)((()=>{this.doSearch()}),200);getContactString(e,t){const n=e.lastIndexOf(`:,${t})`);return n>-1?e.substring(0,n+`:,${t})`.length):""}componentDidMount(){Pl.Z.addListener(this.queryListener)}componentWillUnmount(){Pl.Z.removeListener(this.queryListener)}queryListener=()=>{this.setState(this.updateQuery())};doSearch=()=>{let e="";this.state.contactQuery&&this.state.query?e=this.state.contactQuery+" AND "+this.state.query:this.state.contactQuery?e=this.state.contactQuery:this.state.query&&(e=this.state.query),j.Z.changeQuery(e),j.Z.updateQueryResults(this.context.vivaldiWindowId,e)};onKeyDown=e=>{if(M.Z.get(D.kMailSearchOnEnter))switch(e.key){case"Enter":case"Return":this.doSearch()}};onQueryChange=()=>{const e=this.refSearchInput.current?.value,t=M.Z.get(D.kMailSearchOnEnter)&&e?void 0:this.doDebounceSearch;this.setState({query:e},t)};render(){return(0,fn.jsx)("input",{ref:this.refSearchInput,className:"searchfield-input",type:"search",placeholder:(0,le.Z)("Mail Search"),value:this.state.query,onChange:this.onQueryChange,onKeyDown:this.onKeyDown})}}const Pg=Mg;var Dg,xg=n(19842);function Og(e,t,n,i){Dg||(Dg="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Dg,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Lg=[D.kPanelsAsOverlayEnabled,D.kPanelsPosition,D.kMailViewDimensions,D.kMailViewLayout,D.kToolbarsMail,D.kToolbarsMailComposer,D.kToolbarsMailMessage];var Rg=Og(Pg,{});class Bg extends tn.Component{static contextType=dn.Z;winId=this.context.vivaldiWindowId;state={searchInput:"",panelWidth:Dl.ZP.getWidth(this.winId),panelBarVisible:Dl.ZP.getIsBarVisible(this.winId),panelContentVisible:Dl.ZP.getIsContentVisible(this.winId),folder:""};componentDidMount(){Dl.ZP.addListener(this.panelStoreChanged),Pl.Z.addListener(this.selectedFolderChanged),this.selectedFolderChanged()}componentWillUnmount(){Dl.ZP.removeListener(this.panelStoreChanged),Pl.Z.removeListener(this.selectedFolderChanged)}panelStoreChanged=e=>{e!==Dl.dr&&e!==this.winId||this.setState({panelWidth:Dl.ZP.getWidth(this.winId),panelBarVisible:Dl.ZP.getIsBarVisible(this.winId),panelContentVisible:Dl.ZP.getIsContentVisible(this.winId)})};selectedFolderChanged=()=>{let e,t;const n=Pl.Z.getSelectedFolder();n&&(e=n.accountId,t=n.path,this.setState({folder:e+t}))};getFieldStyle=e=>{const{prefValues:t}=this.props,n="list"!==e?0:6;if("horizontal"===t[D.kMailViewLayout])return{flexBasis:"list"!==e?0:260,marginRight:n};const{panelWidth:i,panelBarVisible:s,panelContentVisible:o}=this.state,a=!t[D.kPanelsAsOverlayEnabled]&&"left"===t[D.kPanelsPosition],r="composer"===e?D.kToolbarsMailComposer:"message"===e?D.kToolbarsMailMessage:D.kToolbarsMail,l=t[r].indexOf("FlexibleSpacer"),d=t[r].indexOf("MailSearch")-1;if(l!==d)return{flexBasis:"list"!==e?0:260,marginRight:n};const c=34*d,h=a?c>i?c-i:0:c,p=t[D.kMailViewDimensions],u=t[D.kPanelsAsOverlayEnabled]&&s&&!o?34:0,g="vertical_wide"===t[D.kMailViewLayout];return{flexBasis:"list"!==e?"auto":Math.min((g?p.widthWide:p.width)-h+u-(a&&o?0:n),800),marginRight:n}};render(){if(this.props.preview)return(0,fn.jsx)("input",{type:"text",value:(0,le.Z)("Mail Search"),...Or({draggable:this.props.draggable,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,onDragEnter:this.props.onDragEnter,onDragOver:this.props.onDragOver,onDragLeave:this.props.onDragLeave,onDrop:this.props.onDrop}),readOnly:!0});const e=W.Z.getActivePage(this.context.vivaldiWindowId)?.url??"";let t="list";(0,xg.vE)(e)?t="composer":(0,xg.Ds)(e)&&(t="message");const n=this.props.buttonClasses;return(0,fn.jsx)("div",{className:mn()("SearchField",n),style:this.getFieldStyle(t),...Or({draggable:this.props.draggable,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,onDragEnter:this.props.onDragEnter,onDragOver:this.props.onDragOver,onDragLeave:this.props.onDragLeave,onDrop:this.props.onDrop}),children:Rg})}}const Fg=(0,fs.Z)(Br(Bg),Lg);var Ug,Vg=n(83526);function Wg(e,t,n,i){Ug||(Ug="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Ug,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Hg=[D.kMailIsTurnedOff,D.kMailSearchSortField,D.kMailPreferredRendering,D.kMailViewLayout];class zg extends tn.PureComponent{static contextType=dn.Z;state={canGoBack:!1,canGoForward:!1,isCheckingMail:!1};_isMounted=!1;componentDidMount(){this._isMounted=!0,Pl.Z.addListener(this.updateNavigationButtons),Nl.Z.addListener(this.updateNavigationButtons)}componentWillUnmount(){this._isMounted=!1,Pl.Z.removeListener(this.updateNavigationButtons),Nl.Z.removeListener(this.updateNavigationButtons)}updateNavigationButtons=()=>{this.setState({canGoBack:Pl.Z.canGoBack(),canGoForward:Pl.Z.canGoForward()})};checkForMail=async()=>{this.setState({isCheckingMail:!0}),await Promise.all([te.Z.checkForMail(),new Promise((e=>setTimeout(e,1e3)))]),this.setState({isCheckingMail:!1})};_onHistorySelection=e=>{j.Z.selectFolderFromHistory(this.context.vivaldiWindowId,e)};_getHistoryMenuPromise=e=>()=>{const t=Pl.Z.getHistoryIndex(),n=W.Z.getActivePage(this.context.vivaldiWindowId)?.url??"",i=Pl.Z.getSelectionHistory(),s="backward"===e?i.slice(0,t).reverse():i.slice(t+1),o="backward"===e?(e,t)=>e-t-1:(e,t)=>e+t+1,a=s.map(((e,i)=>({url:n,handler:()=>this._onHistorySelection(o(t,i)),...G.Z.makeNumberMnemonic(e.name,i)})));return Promise.resolve(a)};mailBackMenu=this._getHistoryMenuPromise("backward");mailForwardMenu=this._getHistoryMenuPromise("forward");selectHistoryItem=e=>{j.Z.selectFolderFromHistory(this.context.vivaldiWindowId,e)};rewindFolderSelection=()=>{j.Z.selectFolderFromHistory(this.context.vivaldiWindowId,0)};forwardToEndOfFolderSelection=()=>{j.Z.selectFolderFromHistory(this.context.vivaldiWindowId,Pl.Z.getSelectionHistory().length-1)};navigate=e=>{const t=W.Z.getActivePage(this.context.vivaldiWindowId);t&&(e?Vg.Z.forward(this.context.vivaldiWindowId,t.id):Vg.Z.back(this.context.vivaldiWindowId,t.id))};toggleLayout=()=>{const e=["horizontal","vertical","vertical_wide"],t=e.indexOf(this.props.prefValues[D.kMailViewLayout]),n=e[(t+1)%3];nt.Z.set(D.kMailViewLayout,n)};render(){const{name:e,size:t}=this.props;switch(e){case"MailBack":return Wg(sl,{menuOrigin:this.props.menuOrigin,disabled:!this.state.canGoBack,onClick:()=>this.navigate(!1),tooltip:(0,le.Z)("Go to previous page")+"\n"+(0,le.Z)("Hold for history list"),menu:this.mailBackMenu,customizeMenu:this.props.customizeMenu,image:cn.mgF[this.props.size],draggable:this.props.draggable,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,onDrop:this.props.onDrop,onDragEnter:this.props.onDragEnter,mimeType:this.props.mimeType,name:e});case"MailForward":return Wg(sl,{menuOrigin:this.props.menuOrigin,disabled:!this.state.canGoForward,onClick:()=>this.navigate(!0),tooltip:(0,le.Z)("Go to next page")+"\n"+(0,le.Z)("Hold for forward history list"),menu:this.mailForwardMenu,image:cn.Zu[this.props.size],draggable:this.props.draggable,customizeMenu:this.props.customizeMenu,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,onDrop:this.props.onDrop,onDragEnter:this.props.onDragEnter,mimeType:this.props.mimeType,name:e});case"MailReload":return Wg(sl,{className:this.state.isCheckingMail?"btn-toolbar-spinner":"",disabled:this.props.disabled||this.state.isCheckingMail,menuOrigin:this.props.menuOrigin,tooltip:(0,le.Z)("Check for mail"),onClick:this.checkForMail,image:cn.QPh[this.props.size],customizeMenu:this.props.customizeMenu,draggable:this.props.draggable,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,onDrop:this.props.onDrop,onDragEnter:this.props.onDragEnter,mimeType:this.props.mimeType,name:e});case"MailRenderingMethod":{const n=this.props.prefValues[D.kMailPreferredRendering],i="prefer_html"===n?cn.lOb[t]:cn.dYD[t],s="prefer_html"===n?(0,le.Z)("Show Messages as Text"):(0,le.Z)("Show Messages as HTML");return Wg(sl,{tooltip:s,onClick:()=>nt.Z.toggle(D.kMailPreferredRendering,"prefer_html","plaintext"),image:i,customizeMenu:this.props.customizeMenu,draggable:this.props.draggable,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,onDrop:this.props.onDrop,onDragEnter:this.props.onDragEnter,mimeType:this.props.mimeType,name:e})}case"MailViewLayout":const n=this.props.prefValues[D.kMailViewLayout];let i=cn.s2Z[t];return"vertical"===n?i=cn.Q_G[t]:"vertical_wide"===n&&(i=cn.hR9[t]),Wg(sl,{tooltip:(0,le.Z)("Toggle View"),onClick:this.toggleLayout,disabled:this.props.prefValues[D.kMailIsTurnedOff],image:i,customizeMenu:this.props.customizeMenu,draggable:this.props.draggable,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,onDrop:this.props.onDrop,onDragEnter:this.props.onDragEnter,mimeType:this.props.mimeType,name:e});case"MailViewThreading":const s="threads"===this.props.prefValues[D.kMailSearchSortField];return Wg(sl,{tooltip:s?(0,le.Z)("Hide Message Threads"):(0,le.Z)("Show Message Threads"),onClick:()=>nt.Z.set(D.kMailSearchSortField,s?"sentDate":"threads"),image:s?cn.AE4[t]:cn.eCP[t],customizeMenu:this.props.customizeMenu,draggable:this.props.draggable,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,onDrop:this.props.onDrop,onDragEnter:this.props.onDragEnter,mimeType:this.props.mimeType,name:e});default:return console.warn(`ToolbarButton “${e}” not found`),null}}}const Gg=(0,fs.Z)(zg,Hg);var $g=n(98611),Kg=n(47513),jg=n.n(Kg),Yg=n(42151);class Xg extends Z.Z{constructor(e){e.checkRegistered($g.C),super(e)}getInitialState(){return{accounts:new Map,maxSles:5}}reduce(e,t){switch(t.actionType){case"MAIL_INDEX_UPDATE":const{addedSles:n,removedSles:i,sleUpdates:s}=t.updates;return(0,E.ZP)(e,(e=>{i&&function(e,t){const n=new Set(e);t.accounts.forEach((e=>{e.sles=e.sles.filter((({id:e})=>!n.has(e)))}))}(i,e),n&&Qg(n,e),s&&function(e,t){for(const n of t.accounts){const t=n[1];for(const n of t.sles)for(const t of e)t.id===n.id&&t.updates.sources&&t.updates.sources.forEach(((e,t)=>{if(e){const i=n.sources.get(t);if(i)n.sources.set(t,{...i,...e});else{const{read:i,deleted:s,internal:o}=e;void 0!==i&&void 0!==s&&void 0!==o&&n.sources.set(t,{read:i,deleted:s,internal:o})}}else n.sources.delete(t)}))}}(s,e)}));case"MAIL_INIT_INDEX_BATCH":return(0,E.ZP)(e,(e=>{Qg(t.sleBatch,e)}));case"MAIL_STOP":return this.getInitialState();default:return e}}getSles(e){const{accounts:t}=this.getState(),n=[...t.keys()],i=new Map(n.map((e=>[e,0]))),s=[];for(;s.length<e;){let e,o;for(const s of n){const n=i.get(s);if(void 0===n)throw new Error("account index not found "+s);const a=t.get(s);if(void 0===a)throw new Error("account data not found "+s);const r=a.sles[n];r&&((!o||r.sentDate>o.sentDate)&&(o=r,e=s))}if(!e||!o)break;{const t=i.get(e);if(void 0===t)throw new Error("account index not found "+e);i.set(e,t+1),s.push(o)}}return s}getSlesByAccountId(e,t){const n=this.getState().accounts.get(e);if(!n)throw new Error("Account "+e+" not found");const{sles:i}=n;return i.slice(0,t)}}function Qg(e,t){const{accounts:n,maxSles:i}=t;for(const t of e){const e=new Set,s=it.Z.getByIds(t.sourceFilterIds);for(const t of s){const{accountId:n,path:i}=t;ba.Z.getFolderType(n,i)===ue.e9&&e.add(n)}for(const s of e){let e=n.get(s);e||(e={sles:[]},n.set(s,e));const{sles:o}=e;let a=jg()(o,t,((e,t)=>t.sentDate-e.sentDate));a<0&&(a=-a-1),a<i&&(o.splice(a,0,(0,Yg.Z)(t)),o.length>i&&o.pop())}}}const qg=new Xg(l.Z),Jg=new Set,em=new Set,tm=new Map;class nm extends Us.Z{hasError(e){return this.isDisconnected(e)&&void 0!==this.getErrorMessage(e)}hasAuthenticationError(e){if(this.hasError(e)){const t=this.getErrorMessage(e);return!!t&&t.toString().toLowerCase().indexOf("authentication")>=0}return!1}isDisconnected(e){return em.has(e)}isConnecting(e){return Jg.has(e)}isConnected(e){return!this.isConnecting(e)&&!this.isDisconnected(e)}getErrorMessage(e){return tm.get(e)}dispatchAction(e){switch(e.actionType){case"MAIL_IS_DISCONNECTED":{const{accountId:t,isDisconnected:n,errorMessage:i}=e;let s=!1;n?(s=!em.has(t),em.add(t)):(s=em.has(t),em.delete(t)),i?(tm.set(t,i),s=!0):tm.get(t)&&(tm.delete(t),s=!0),s&&this.emitChange({accountId:t,isDisconnected:n});break}case"MAIL_IS_CONNECTING":{const{accountId:t,isConnecting:n}=e;let i=!1;n?(i=!Jg.has(t),Jg.add(t)):(i=Jg.has(t),Jg.delete(t)),i&&this.emitChange({accountId:t,isConnecting:n});break}}}}const im=new nm(l.Z);var sm;function om(e,t,n,i){sm||(sm="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:sm,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}rm.defaultProps={size:32};const am="/resources/vivaldi_mail_default.png";function rm(e){let t=e.emailAddress.split("@")[1]||"";return t="gmail.com"===t?"https://ssl.gstatic.com/ui/v1/icons/mail/images/favicon5.ico":"googleusercontent.com"===t?"https://google.com/favicon.ico":Di(t),om(Oi,{size:e.size,className:e.className,url:t?(0,Ni.q9)(t):am,fallbackUrl:am,style:e.style,loadType:"faviconSkipCache"})}const lm=rm;var dm,cm=n(95752),hm=n(97823),pm=n(54773),um=n(307),gm=n(59275);function mm(e,t,n,i){dm||(dm="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:dm,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const vm=[D.kKeyboardTabToAll];function fm(e){return e.some((e=>"error"===e.level))}var ym=mm("br",{});class wm extends tn.PureComponent{static contextType=dn.Z;constructor(e,t){super(e);const n=rc.getLogsByComponent("Mail");this.state={activeListEntry:Nl.Z.getActiveListEntry(),isMailTabActive:Boolean(W.Z.getActivePage(t.vivaldiWindowId)?.isMailPage),selectedPane:M.Z.get(D.kMailStatusSelectedPane),logs:n,hasLoggedError:fm(n)}}componentDidMount(){Nl.Z.addListener(this.handleActiveMessageStoreChange),W.Z.addListener(this.checkIfMailTabActive),rc.addListener(this.handleLogStoreChange)}componentWillUnmount(){Nl.Z.removeListener(this.handleActiveMessageStoreChange),W.Z.removeListener(this.checkIfMailTabActive),rc.removeListener(this.handleLogStoreChange)}checkIfMailTabActive=()=>{const e=W.Z.getActivePage(z.ZP.getActiveWindowId())?.isMailPage;this.setState({isMailTabActive:e})};handleActiveMessageStoreChange=()=>{this.updateCurrentMessageDebounced()};handleLogStoreChange=()=>{const e=rc.getLogsByComponent("Mail");this.setState({logs:e,hasLoggedError:fm(e)})};updateCurrentMessageDebounced=(0,Zr.Z)((()=>{this.setState({activeListEntry:Nl.Z.getActiveListEntry()})}));_selectPane=e=>{nt.Z.set(D.kMailStatusSelectedPane,e),this.setState({selectedPane:e})};_openMessage=async e=>{const t=await vt.Z.messages.get(e);this.props.hidePopup(),(0,um.Z)(this.context.vivaldiWindowId,t)};_authenticate=async e=>{const t=await hm.Z.loadAccount(e);ie.Z.showMailAuthenticationDialog(this.context.vivaldiWindowId,{account:t}),this.props.hidePopup()};_viewLog=()=>{d.Z.devtoolsPrivate.toggleDevtools("console"),this.props.hidePopup()};_rebuildMailSearchDB=async()=>{const e={title:(0,le.Z)("title","Rebuild Mail Search Database"),body:(0,le.Z)("Note: This task could take several minutes."),actions:[{title:(0,le.Z)("Rebuild"),action:"confirm"}],cancelAction:{title:(0,le.Z)("Cancel"),action:"cancel",default:!0}},{action:t}=await ie.Z.showModal(this.context.vivaldiWindowId,{modal:e});"cancel"!==t&&d.Z.mailPrivate.rebuildAndVacuumDatabase()};_openAccount=async e=>{this.props.hidePopup()};openMailSettings=()=>{ie.Z.showSettings(this.context.vivaldiWindowId,"mail"),this.props.hidePopup()};getContextMenu=()=>{const e=M.Z.get(D.kMailAccounts),t=[ue.of].concat(e.map((e=>e.MAIL_EMAIL)));return[{handler:this.openMailSettings,...(0,Mn.Z)("Mail Settings")},{handler:this._viewLog,...(0,Mn.Z)("View Log")},{handler:this._rebuildMailSearchDB,...(0,Mn.Z)("command","Rebuild Mail Search Database")},{...(0,Mn.Z)("Select Folder"),items:t.map((e=>({type:"checkbox",checked:this.props.accountId===e,handler:()=>this.props.updateRecentMessages(e),...(0,Mn.Z)(e)})))}]};render(){const e=M.Z.get(D.kMailAccounts),t=this.state.activeListEntry;return(0,fn.jsxs)(fn.Fragment,{children:[mm("div",{className:"StatusPopup-Header"},void 0,mm("h2",{},void 0,(0,le.Z)("Mail Status")),mm("div",{className:"toolbar button-popup-header-toolbar toolbar-default"},void 0,mm(sl,{onClick:()=>{ie.Z.showMail(this.context.vivaldiWindowId),this.props.hidePopup()},disabled:this.state.isMailTabActive,menuOrigin:"bottomLeft",title:(0,le.Z)("Show Mail")}),mm(sl,{menuOrigin:"bottomLeft",image:cn.bqs.small,menu:this.getContextMenu,tooltip:(0,le.Z)("Recent message settings")}))),mm("div",{className:"toolbar toolbar-default"},void 0,mm("div",{className:"toolbar-group equal-width"},void 0,mm(sl,{title:(0,le.Z)("Messages"),isPressed:"messages"===this.state.selectedPane,onClick:()=>this._selectPane("messages")}),mm(sl,{title:(0,le.Z)("Accounts"),isPressed:"accounts"===this.state.selectedPane,onClick:()=>this._selectPane("accounts")}),mm(sl,{title:(0,le.Z)("Logs"),isPressed:"logs"===this.state.selectedPane,onClick:()=>this._selectPane("logs"),badgeText:this.state.hasLoggedError?"!":""}))),mm("div",{className:"StatusPopup-Content"},void 0,"accounts"===this.state.selectedPane&&mm("div",{className:"StatusPopup-ContentPane"},void 0,mm("div",{className:"StatusPopup-List"},void 0,e.map((e=>{const t=e.MAIL_EMAIL;let n;return e.offline?n="offline":im.isConnected(t)?n="connected":im.isConnecting(t)?n="connecting":im.hasAuthenticationError(t)?n="needsAuth":im.hasError(t)&&(n="hasError"),mm(tn.Fragment,{},t,mm("button",{tabIndex:this.props.prefValues[D.kKeyboardTabToAll],onClick:()=>this._openAccount(t),className:"StatusPopup-Account"},void 0,mm(lm,{emailAddress:t,size:16,className:"StatusPopup-AccountIcon"}),mm("div",{className:"StatusPopup-AccountName"},void 0,t),mm("div",{className:"StatusPopup-AccountStatus"},void 0,"offline"===n&&(0,fn.jsxs)(fn.Fragment,{children:[mm("span",{className:"StatusPopup-AccountStatus--Success",title:(0,le.Z)("mail","Offline"),dangerouslySetInnerHTML:{__html:cn.bBo.small}}),(0,le.Z)("mail","Offline")]}),"connected"===n&&(0,fn.jsxs)(fn.Fragment,{children:[mm("span",{className:"StatusPopup-AccountStatus--Success",title:(0,le.Z)("Connected"),dangerouslySetInnerHTML:{__html:cn.JLz}}),(0,le.Z)("Connected")]}),"connecting"===n&&(0,fn.jsxs)(fn.Fragment,{children:[mm("span",{className:"StatusPopup-AccountStatus--Warning",title:(0,le.Z)("Connecting..."),dangerouslySetInnerHTML:{__html:cn.rvX.small}}),(0,le.Z)("Connecting...")]}),"needsAuth"===n&&(0,fn.jsxs)(fn.Fragment,{children:[mm("span",{className:"StatusPopup-AccountStatus--Error",title:(0,le.Z)("Authentication Error"),dangerouslySetInnerHTML:{__html:cn.viW}}),(0,le.Z)("Authentication Error")]}),"hasError"===n&&(0,fn.jsxs)(fn.Fragment,{children:[mm("span",{className:"StatusPopup-AccountStatus--Error",title:im.getErrorMessage(t)||(0,le.Z)("Error"),dangerouslySetInnerHTML:{__html:cn.viW}}),(0,le.Z)("Error")]}),!n&&(0,fn.jsxs)(fn.Fragment,{children:[mm("span",{className:"StatusPopup-AccountStatus--Warn",title:(0,le.Z)("Unknown"),dangerouslySetInnerHTML:{__html:cn.GH$}}),(0,le.Z)("Status Unknown")]}),"needsAuth"===n&&mm("a",{className:"StatusPopup-AccountStatusRetry",tabIndex:this.props.prefValues[D.kKeyboardTabToAll],onClick:this._authenticate.bind(this,t),href:""},void 0,(0,le.Z)("Retry")))))}))),mm("div",{className:"StatusPopup-Footer"})),"messages"===this.state.selectedPane&&mm("div",{className:"StatusPopup-ContentPane"},void 0,(0,fn.jsxs)(fn.Fragment,{children:[this.props.recentMessages.length>0&&mm("h3",{},void 0,this.props.accountId===ue.of?(0,le.Z)("Recent in All Messages"):(0,le.Z)("Recent in $1",[(0,le.Z)(this.props.accountId)])),mm("div",{className:"StatusPopup-List"},void 0,this.props.recentMessages.map((e=>{const t=pm.Z.get(e.toIds),n=t.length>0?t[0].address:"",i=pm.Z.get(e.fromIds),s=i.length>0?i[0].address:"";return mm("button",{tabIndex:this.props.prefValues[D.kKeyboardTabToAll],className:mn()("StatusPopup-Mail",{"StatusPopup-Mail--Unread":!cm.Z.call(e.sources)}),onClick:()=>this._openMessage(e.id)},e.id,mm(lm,{emailAddress:n,size:16,className:"StatusPopup-MailIcon"}),mm("div",{className:"StatusPopup-MailTitle"},void 0,e.subject),mm("div",{className:"StatusPopup-MailReceiver"},void 0,s," ➝ ",n),mm("div",{className:"StatusPopup-MailDate"},void 0,b()(e.sentDate).fromNow()))}))),t&&(0,fn.jsx)(fn.Fragment,{children:mm("dl",{className:"StatusPopup-MailDetail"},void 0,mm("dt",{},void 0,(0,le.Z)("Current Message")),mm("dd",{},void 0,t.subject),mm("dt",{},void 0,(0,le.Z)("Internal ID")),mm("dd",{},void 0,t.id),mm("dt",{},void 0,(0,le.Z)("Thread ID")),mm("dd",{},void 0,t.threadKey),[...t.sources.entries()].map((([e,t])=>{const n=it.Z.get(e);if(n)return mm(tn.Fragment,{},e,mm("dt",{},void 0,(0,le.Z)("Filter ID: $1",[e])),mm("dd",{},void 0,mm("span",{},void 0,t.read?(0,le.Z)("Read"):(0,le.Z)("Unread")),", ",mm("span",{},void 0,t.deleted?(0,le.Z)("Deleted"):(0,le.Z)("Not deleted")),", ",mm("span",{},void 0,t.internal?(0,le.Z)("Internal"):(0,le.Z)("External")),ym,mm("span",{},void 0,`${n.accountId} ${(0,gm.e)(n.name)}`)))})))})]}),mm("div",{className:"StatusPopup-Footer toolbar-default"},void 0,mm(sl,{onClick:()=>te.Z.checkForMail(),title:(0,le.Z)("Check for New Messages")}))),"logs"===this.state.selectedPane&&mm("div",{className:"StatusPopup-ContentPane"},void 0,mm(vc,{logs:this.state.logs,component:"Mail"})))]})}}const bm=(0,fs.Z)(wm,vm);var Cm,Sm=n(65741),Tm=n(14507);function Im(e,t,n,i){Cm||(Cm="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Cm,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const km=[D.kMailCountersPanelSwitcherEnabled,D.kMailCountersPanelUnseenEnabled];function Am(e){if(e>0)return e>9999?(0,le.Z)("$1 K",[Math.floor(e/1e3)]):e.toString()}const Zm=function(e){const[t,n]=(0,tn.useState)(0),[i,s]=(0,tn.useState)(0);(0,tn.useEffect)((()=>{function t(t){if("counters"!==t.target&&"finishIndexProgress"!==t.target)return;const i=$g.C.getCounters(e.accountId,e.path);n(i?i.unseen:0),s(i?i.unread:0)}return $g.C.addListener(t),function(){$g.C.removeListener(t)}}),[e.accountId,e.path]);const o=(0,Tm.Z)(km);if(!o[D.kMailCountersPanelSwitcherEnabled])return null;const a=o[D.kMailCountersPanelUnseenEnabled],r=Am(a?t:i);return r?Im("span",{className:mn()("button-badge",{unseen:a})},void 0,r):null};var Em;function _m(e,t,n,i){Em||(Em="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Em,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Nm=[D.kMailAccounts,D.kMailCountersPanelUnseenEnabled,D.kMailCountersStatusButtonEnabled,D.kMailIsTurnedOff,D.kMailStatusButtonStyle,D.kRssSettings];function Mm(){const e=$g.C.getCounters("All Messages","Unread");return{unseen:e?.unseen||0,unread:e?.unread||0}}function Pm(){const e=Mm();return{accountId:ue.of,isPopupOpen:!1,recentMessages:[],...e,windowStyle:{}}}class Dm extends tn.PureComponent{static contextType=dn.Z;#n=!1;constructor(e,t){super(e),this.state={...Pm(),windowStyle:P.Z.getState().windowStyles.get(t.vivaldiWindowId)||{}}}componentDidMount(){P.Z.addListener(this.onThemeStoreChanged),$g.C.addListener(this.handleMailFiltersStoreChange),qg.addListener(this.handleMailLatestStoreChange),qc.addListener(this.popupStateChanged),this.#n=!0}componentWillUnmount(){this.#n=!1,P.Z.removeListener(this.onThemeStoreChanged),$g.C.removeListener(this.handleMailFiltersStoreChange),qg.removeListener(this.handleMailLatestStoreChange),qc.removeListener(this.popupStateChanged)}onThemeStoreChanged=()=>{const e=P.Z.getState().windowStyles.get(this.context.vivaldiWindowId);(0,Sm.default)(e,this.state.windowStyle)||this.setState({windowStyle:e})};static getDerivedStateFromError(){return Pm()}popupStateChanged=()=>{const e=qc.getState().mailPopupOpen;this.setState({isPopupOpen:e})};getMessageCount=()=>this.props.prefValues[D.kMailCountersPanelUnseenEnabled]?this.state.unseen:this.state.unread;handleMailFiltersStoreChange=e=>{switch(e.target){case"counters":case"finishIndexProgress":const e=Mm();return void this.setState(e)}};handleMailLatestStoreChange=()=>{this.updateRecentMessagesDebounced(this.state.accountId)};hidePopup=()=>{this.setState({isPopupOpen:!1}),Yc.close("Mail")};togglePopup=()=>{this.setState((e=>({isPopupOpen:!e.isPopupOpen})))};openMailAccountSheet=()=>{ie.Z.showMailAccountDialog(this.context.vivaldiWindowId)};openMailSettings=()=>{ie.Z.showSettings(this.context.vivaldiWindowId,"mail")};updateRecentMessages=e=>{try{if(this.#n){const t=(e===ue.of?qg.getSles(5):qg.getSlesByAccountId(e,5)).map((e=>$g.C.createListEntry(e,[])));this.setState({accountId:e,recentMessages:t})}}catch(e){console.error(e)}};updateRecentMessagesDebounced=(0,Zr.Z)((e=>this.updateRecentMessages(e)),500,{leading:!0,maxWait:1e3});getTooltip=()=>{const e=this.props.prefValues[D.kMailIsTurnedOff],t=this.props.prefValues[D.kMailAccounts].length+this.props.prefValues[D.kRssSettings].length>0;if(e||!t)return(0,le.Z)("Mail");const n=this.props.prefValues[D.kMailCountersPanelUnseenEnabled],i=this.getMessageCount();let s=(0,le.Z)("Mail Status");return i>0&&(s+=" "+(n?(0,le.Z)("($1 unseen)","($1 unseen)",[i]):(0,le.Z)("($1 unread)","($1 unread)",[i]))),this.state.recentMessages.length>0&&(s+="\n\n"),this.state.recentMessages.forEach(((e,t)=>{t>0&&(s+="\n\n"),s+=e.subject;const n=pm.Z.get(e.fromIds);n.length>0&&(s+="\n"+n[0].address)})),s};menu=()=>{const e=this.props.prefValues[D.kMailStatusButtonStyle],t=this.props.prefValues[D.kMailCountersStatusButtonEnabled];return[{handler:this.openMailSettings,...(0,Mn.Z)("Mail Settings")},{items:[{type:"checkbox",checked:"imageandtext"===e,handler:()=>nt.Z.set(D.kMailStatusButtonStyle,"imageandtext"),...(0,Mn.Z)("Image and Text")},{type:"checkbox",checked:"image"===e,handler:()=>nt.Z.set(D.kMailStatusButtonStyle,"image"),...(0,Mn.Z)("Image Only")},{type:"checkbox",checked:"text"===e,handler:()=>nt.Z.set(D.kMailStatusButtonStyle,"text"),...(0,Mn.Z)("title","Text Only")}],...(0,Mn.Z)("Button Style")},{type:"checkbox",checked:t,handler:()=>nt.Z.set(D.kMailCountersStatusButtonEnabled,!t),...(0,Mn.Z)("Show Message Counter")}]};render(){const e=this.props.prefValues[D.kMailStatusButtonStyle];if(!(!this.props.prefValues[D.kMailIsTurnedOff]&&z.ZP.isMail(this.context.vivaldiWindowId)||this.props.preview))return null;const t=this.props.prefValues[D.kMailCountersStatusButtonEnabled],n=!z.ZP.isMail(this.context.vivaldiWindowId),i=this.props.prefValues[D.kMailAccounts].length+this.props.prefValues[D.kRssSettings].length>0,s=this.props.prefValues[D.kMailCountersPanelUnseenEnabled];let o="";return t&&(o=Am(this.getMessageCount())),_m(sl,{badgeText:o??"",className:mn()("StatusButton",{unseen:s}),disabled:n,onClick:i?this.togglePopup:this.openMailAccountSheet,customizeMenu:this.props.customizeMenu,menuOrigin:this.props.menuOrigin,tooltip:this.getTooltip(),title:"image"!==e?(0,le.Z)("Mail Status"):void 0,image:"text"!==e?cn.lvj[this.props.size]:void 0,draggable:this.props.draggable,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,onDrop:this.props.onDrop,onDragEnter:this.props.onDragEnter,mimeType:this.props.mimeType,name:this.props.name,hidePopup:this.hidePopup,popupPosition:this.props.popupPosition,popupClassName:"StatusPopup",popupWidth:400,isPopupVisible:this.state.isPopupOpen,menu:this.menu},void 0,!n&&_m(bm,{updateRecentMessages:this.updateRecentMessages,recentMessages:this.state.recentMessages,accountId:this.state.accountId,hidePopup:this.hidePopup}))}}const xm=(0,fs.Z)(Dm,Nm);let Om;class Lm extends Us.Z{getDraftIdAndCancelDraftUpdates(){if(Om)return Om.cancelPendingChanges(),Om.props.id}getMessagePromise(){return Om?Om.buildMessage():Promise.resolve()}getComposer(){return Om}dispatchAction(e){switch(e.actionType){case"MAIL_SET_ACTIVE_COMPOSER":Om!==e.mailComposer&&(Om=e.mailComposer);break;case"MAIL_CLEAR_ACTIVE_COMPOSER":Om===e.mailComposer&&(Om=void 0);break;case"MAIL_ACTIVE_COMPOSER_MODAL":e.noRecipients&&this.emitChange("noRecipients")}}}const Rm=new Lm(l.Z);var Bm=n(89846),Fm=n(93043);const Um=new class{drafts={};setActiveMailComposer(e){l.Z.dispatch({actionType:"MAIL_SET_ACTIVE_COMPOSER",mailComposer:e}),Um.drafts[e.state.id]=1}clearActiveMailComposer(e){l.Z.dispatch({actionType:"MAIL_CLEAR_ACTIVE_COMPOSER",mailComposer:e})}deleteDraftMessage(){const e=Rm.getDraftIdAndCancelDraftUpdates();e&&(Fm.Z.call([e]),j.Z.updateIndex({removedSles:[e]}))}async queueMessage(e,t){const n=Rm.getComposer();if(!n)return;const{to:i,cc:s,bcc:o}=n.state;if([i,s,o].every((e=>0===e.length)))return void l.Z.dispatch({actionType:"MAIL_ACTIVE_COMPOSER_MODAL",noRecipients:!0});const{id:a}=n.props;let r;if(a){if(await n.flushPendingChanges(),r=await(0,Na.Z)(a),r){$g.C.getByIds(r.sourceFilterIds).some((e=>e.accountId===ue.of&&e.path===ue.Wb))&&(r=await async function(e,t){const n={filteringPriority:ue.Un.HIGH,addedProperties:t?{}:{searchList:{queued:!0}}},{sleUpdate:i,updatedSle:s}=await(0,Bm.Z)(e,ue.of,ue.Wb,ue.of,ue.J8,n);return j.Z.updateIndex({sleUpdates:[i]}),ce.Z.filter(),s}(a,t))}}else n.cancelPendingChanges();if(!r){const e=await Rm.getMessagePromise();if(!e)return;r=await he.Z.storeMessage(e,t)}t&&he.Z.sendSelected(e,[r]),Y.Z.close(e)}sendMessage(e){Um.queueMessage(e,!0)}async chooseAttachments(){const e=await new Promise(((e,t)=>y.Z.fileSystem.chooseEntry({type:"openFile",acceptsMultiple:!0},(n=>n?e(n):t())))),t=await Promise.all(e.map((e=>new Promise((t=>e.file((n=>{const i=new FileReader;i.onloadend=i=>t({type:"attachment",content:new Uint8Array(i.target.result),filename:e.name,mimeType:n.type}),i.readAsArrayBuffer(n)})))))));Um.addAttachments(t)}addAttachments(e){const t=Rm.getComposer();t&&t.setState({attachments:[...t.state.attachments,...e]},t.onBodyChange)}};const Vm=Um;var Wm=n(8429);const Hm={getItems:function(e,t){const n=[],i="read"===t?M.Z.get(D.kMailReadHeadersHidden):M.Z.get(D.kMailComposeHeadersHidden);return e.map((e=>{n.push({type:"checkbox",checked:!i.includes(e.ref),handler:this._setField.bind(this,e.ref,t),...e.labels})})),n},_setField:function(e,t){const n="read"===t?D.kMailReadHeadersHidden:D.kMailComposeHeadersHidden;let i=M.Z.get(n).slice();i.includes(e)?i=i.filter((t=>t!==e)):i.push(e),nt.Z.set(n,i)}};var zm=n(75401),Gm=n(84283),$m=n(89165),Km=n(6129);function jm(e){const{enabledButtons:t}=e,{isJunkSelected:n,isNonJunkSelected:i,isDeletedSelected:s,isNonDeletedSelected:o,isArchivedSelected:a,isNonArchivedSelected:r,selectionCount:l,isOutboundSelected:d,isReadSelected:c,isUnreadSelected:h,isArchivableSelected:p,isJunkableSelected:u}=function(){const e={isDeletedSelected:!1,isNonDeletedSelected:!1,isJunkSelected:!1,isNonJunkSelected:!1,isJunkableSelected:!1,isArchivedSelected:!1,isNonArchivedSelected:!1,isArchivableSelected:!1,isOutboundSelected:!1,isReadSelected:!1,isUnreadSelected:!1,selectionCount:0},t=Au.Z.get(Q.uP);if(!t)return e;const n=[ue.Nz,ue.fZ,ue.kY];for(const i of t.selectedIds){const t=$g.C.getListEntry(i.id);if(!t)continue;e.selectionCount++;const{sourceFilterIds:s,sources:o}=t;if(!e.isOutboundSelected){const t=it.Z.getByIds(s),i=ba.Z.getFolderTypes(t);e.isOutboundSelected=n.some((e=>i.has(e)))}e.isDeletedSelected&&e.isNonDeletedSelected||(Gm.Z.isMessageDeleted(o)?e.isDeletedSelected=!0:e.isNonDeletedSelected=!0),e.isJunkSelected&&e.isNonJunkSelected&&e.isJunkableSelected||((0,$m.Z)(o)?(e.isJunkSelected=!0,e.isJunkableSelected=!0):(e.isNonJunkSelected=!0,!e.isJunkableSelected&&Ym(s,ue.Hd)&&(e.isJunkableSelected=!0))),e.isArchivedSelected&&e.isNonArchivedSelected&&!e.isArchivableSelected||((0,zm.Z)(o)?(e.isArchivedSelected=!0,e.isArchivableSelected=!0):(e.isNonArchivedSelected=!0,!e.isArchivableSelected&&(M.Z.get(D.kMailAddArchiveFolder)?Xm(s):Ym(s,ue.hn))&&(e.isArchivableSelected=!0))),e.isReadSelected&&e.isUnreadSelected||(cm.Z.call(o)?e.isReadSelected=!0:e.isUnreadSelected=!0)}return e}();if(0===l)return void t.clear();const g=1===l&&!d;t.set("MailMsgTrash",!(s&&o)),t.set("MailMsgSpam",u&&!(n&&i)),t.set("MailMsgArchive",p&&!(a&&r)),t.set("MailMsgReply",g),t.set("MailMsgReplyToAll",g),t.set("MailMsgFlag",!d),t.set("MailMsgLabel",!d),t.set("MailMsgStatusRead",!(c&&h))}function Ym(e,t){const n=it.Z.getByIds(e);return[...new Set(n.map((({accountId:e})=>e)))].some((e=>wa.Z.getFoldersOfType(e,t).length>0))}function Xm(e){const t=it.Z.getByIds(e);return[...new Set(t.map((({accountId:e})=>e)))].some((e=>(0,Km.ZA)(e)))}class Qm extends Z.Z{getInitialState(){return{enabledButtons:new Map,hiddenButtons:new Map}}reduce(e,t){switch(t.actionType){case"MAIL_SELECT_FOLDER":case"MAIL_REFRESH_ACTIVE_MESSAGE":return(0,E.ZP)(e,(e=>{jm(e),function(e){const{hiddenButtons:t}=e,n=Pl.Z.getSelectedFolder();if(!n)return void t.clear();const{accountId:i,path:s}=n,o=ba.Z.getFolderType(i,s),a=[ue.kY,ue.fZ].includes(o),r=[ue.Nz,ue.uT].includes(o);t.set("MailMsgEdit",!a),t.set("MailMsgSpam",a||r),t.set("MailMsgArchive",a||r),t.set("MailMsgReply",a),t.set("MailMsgReplyToAll",a),t.set("MailMsgStatusRead",a||o===ue.Nz),t.set("MailMsgFlag",a),t.set("MailMsgLabel",a)}(e)}));default:return e}}isEnabled(e){if(""!==jr.getState())return!0;const{enabledButtons:t}=this.getState();return t.get(e)??!1}isHidden(e){if(""!==jr.getState())return!1;const{hiddenButtons:t}=this.getState();return t.get(e)??!1}}const qm=new Qm;var Jm,ev=n(95412);function tv(e,t,n,i){Jm||(Jm="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Jm,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class nv extends tn.Component{_isIMEOpen=!1;state={newLabel:""};onSave=async()=>{if(this._isIMEOpen||!this.state.newLabel||this.doesLabelExist(this.state.newLabel))return;const e=(0,ev.A4)(this.state.newLabel),t=Nl.Z.getActiveListEntry(),n=t?(0,ev.Q3)(t.flags):[];await j.Z.addLabelsFilter(e),Wm.Z.toggleLabel(this.props.windowId,e,n)(),this.props.onClose()};onCancel=()=>{this.props.onClose()};doesLabelExist=e=>{const t=$g.C.getByAccountId(ue.ut).map((e=>e.name.toLowerCase()));return t.includes(ue.ow+e.toLowerCase())||t.includes(e.toLowerCase())};newLabelChanged=e=>{if(this._isIMEOpen)return void this.setState({newLabel:e.target.value});const t=(0,ev.Tv)(e.target.value);t!==this.state.newLabel&&this.setState({newLabel:t})};render(){const{newLabel:e}=this.state,t=this.doesLabelExist(e);return tv(ln.Z,{onRequestClose:this.onCancel,viewMode:this.props.viewMode},void 0,tv("header",{className:"dialog-header"},void 0,tv("h1",{className:"dialog-title"},void 0,(0,le.Z)("Add a New Label"))),tv("form",{onSubmit:this.onSave},void 0,tv("div",{className:"dialog-content"},void 0,tv("input",{type:"text",className:"new-label",maxLength:ev.Ws,onChange:this.newLabelChanged,onCompositionStart:()=>this._isIMEOpen=!0,onCompositionEnd:e=>{this._isIMEOpen=!1,this.newLabelChanged(e)},value:(0,Ca.kF)(e),autoFocus:!0}),t&&tv(Tr,{type:"info"},void 0,(0,le.Z)("Label “$1” already exists.",[(0,Ca.kF)(e)]))),tv("footer",{className:"dialog-footer"},void 0,tv("input",{type:"submit",className:"primary",value:(0,le.Z)("Save"),disabled:""===e||t}),tv("input",{type:"button",value:(0,le.Z)("Cancel"),onClick:this.onCancel}))))}}const iv=nv;const sv=function(e,t,n){const i=[];return t?(i.push({handler:()=>Wm.Z.prepareDelete(e,!0),...(0,Mn.Z)("mail","Delete Permanently")}),n!==ue.AF.toolbar&&i.push({handler:()=>Wm.Z.undelete(e),...(0,Mn.Z)("mail","Undelete")})):n!==ue.AF.toolbar&&i.push({handler:()=>Wm.Z.prepareDelete(e,!1),...(0,Mn.Z)("mail","Move to Trash")}),i};var ov;function av(e,t,n,i){ov||(ov="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:ov,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const rv=[{ref:"from",labels:(0,Mn.Z)("sender","From")},{ref:"cc",labels:(0,Mn.Z)("Carbon Copy")},{ref:"bcc",labels:(0,Mn.Z)("Blind Carbon Copy")}],lv=[D.kMailSendOrQueue];class dv extends tn.PureComponent{static contextType=dn.Z;state={standardFlag:"",customLabels:[],unread:!1,messageSelected:!1,showLabel:!1,disableTrash:!0,disableJunk:!0,disableArchive:!0,disableMarkRead:!0};componentDidMount(){Nl.Z.addListener(this.activeMessageStoreChanged),qm.addListener(this.updateButtonStatus),this.activeMessageStoreChanged(),this.updateButtonStatus()}activeMessageStoreChanged=()=>{const e=Nl.Z.getActiveListEntry();if(e){const t=$g.C.getListEntry(e.id);if(t){const e=Pl.Z.getSelectedFolder(),n=e&&$g.C.getByFolder(e.accountId,e.path);this.setState({messageSelected:!0,unread:!cm.Z.call(t.sources,n),standardFlag:(0,ev.Zr)(t.flags),customLabels:(0,ev.Q3)(t.flags)})}else this.setState({messageSelected:!1})}else this.setState({messageSelected:!1})};updateButtonStatus=()=>{this.setState({disableTrash:!qm.isEnabled("MailMsgTrash"),disableJunk:!qm.isEnabled("MailMsgSpam"),disableArchive:!qm.isEnabled("MailMsgArchive"),disableMarkRead:!qm.isEnabled("MailMsgStatusRead")})};componentWillUnmount(){Nl.Z.removeListener(this.activeMessageStoreChanged),qm.removeListener(this.updateButtonStatus)}createCustomLabel=()=>{this.setState({showLabel:!0})};onCustomLabelDlgClose=async(e,t)=>{e&&(await j.Z.addLabelsFilter(t),Wm.Z.toggleLabel(this.context.vivaldiWindowId,t,this.state.customLabels)()),this.setState({showLabel:!1})};closeCustomFlagDlg=()=>{this.setState({showLabel:!1})};getSendQueueMenu=()=>[{type:"checkbox",checked:"send"===this.props.prefValues[D.kMailSendOrQueue],handler:this.sendAndSetSendAsDefault,...(0,Mn.Z)("Send")},{type:"checkbox",checked:"queue"===this.props.prefValues[D.kMailSendOrQueue],handler:this.queueAndSetQueueAsDefault,...(0,Mn.Z)("Queue")}];sendAndSetSendAsDefault=()=>{"send"!==this.props.prefValues[D.kMailSendOrQueue]&&nt.Z.set(D.kMailSendOrQueue,"send")};queueAndSetQueueAsDefault=()=>{"queue"!==this.props.prefValues[D.kMailSendOrQueue]&&nt.Z.set(D.kMailSendOrQueue,"queue")};deleteDraftMessage=()=>{Y.Z.close(this.context.vivaldiWindowId),Vm.deleteDraftMessage()};customLabelsMenuData=()=>{const e=Wm.Z.getCustomLabelsMenu(this.context.vivaldiWindowId,this.state.customLabels);return e.push(G.Z.separatorItem,{handler:this.createCustomLabel,ellipsis:!0,...(0,Mn.Z)("Add New Label")}),this.state.customLabels.length>0&&e.push(G.Z.separatorItem,{handler:()=>Wm.Z.clearAllLabels(this.context.vivaldiWindowId,this.state.customLabels),...(0,Mn.Z)("Clear All Labels")}),e};render(){const e=Nl.Z.isTrash(),t=Nl.Z.isJunk(),n=Nl.Z.isArchived(),i=this.props.size,s=this.context.vivaldiWindowId;if(!this.props.preview&&qm.isHidden(this.props.name))return null;const{draggable:o,onDragStart:a,onDragEnd:r,onDrop:l,onDragEnter:d,mimeType:c,name:h,customizeMenu:p,menuOrigin:u}=this.props,g={draggable:o,customizeMenu:p,onDragStart:a,onDragEnd:r,onDrop:l,onDragEnter:d,mimeType:c,name:h,menuOrigin:u};switch(this.props.name){case"MailMsgEdit":return(0,fn.jsx)(sl,{...g,tooltip:(0,le.Z)("mail","Edit"),onClick:()=>Wm.Z.openMessage(s),disabled:!this.state.messageSelected||!Pl.Z.isFolderAnEditMailFolder(),image:cn.NNg[i]});case"MailMsgReply":return(0,fn.jsx)(sl,{...g,tooltip:(0,le.Z)("Reply")+" "+U.Z.getShortcut("COMMAND_MAIL_REPLY"),onClick:()=>Wm.Z.reply(),disabled:!this.state.messageSelected,image:cn.hGk[i]});case"MailMsgReplyToAll":return(0,fn.jsx)(sl,{...g,tooltip:(0,le.Z)("Reply to All")+" "+U.Z.getShortcut("COMMAND_MAIL_REPLY_ALL"),onClick:()=>Wm.Z.replyAll(),disabled:!this.state.messageSelected,image:cn.Sap[i]});case"MailMsgForward":return(0,fn.jsx)(sl,{...g,tooltip:(0,le.Z)("mail","Forward")+" "+U.Z.getShortcut("COMMAND_MAIL_FORWARD"),onClick:()=>Wm.Z.forward(),disabled:!this.state.messageSelected,image:cn.upG[i]});case"MailMsgStatusRead":const o=Pl.Z.getGoToMenuItems(this.context.vivaldiWindowId,ue.AF.toolbar);return(0,fn.jsx)(sl,{...g,tooltip:this.state.unread?(0,le.Z)("Mark Read")+" "+U.Z.getShortcut("COMMAND_MAIL_MARK_READ"):(0,le.Z)("Mark Unread")+" "+U.Z.getShortcut("COMMAND_MAIL_MARK_UNREAD"),onClick:this.state.unread?()=>Wm.Z.markRead(s):()=>Wm.Z.markUnread(s),disabled:!this.state.messageSelected||this.state.disableMarkRead,isMenuIndicatorVisible:!0,isMenuIndicatorDisabled:!this.state.unread,menu:()=>o,image:this.state.unread?cn.aAJ[i]:cn.LDV[i]});case"MailMsgFlag":return(0,fn.jsx)(sl,{...g,tooltip:(0,le.Z)("Flag"),onClick:()=>Wm.Z.toggleStandardFlag(this.context.vivaldiWindowId,this.state.standardFlag?this.state.standardFlag:ue.T4.RED,this.state.standardFlag),disabled:!this.state.messageSelected,image:cn.nyn[i],isMenuIndicatorVisible:!0,menu:()=>Wm.Z.getStandardFlagsMenu(this.context.vivaldiWindowId,this.state.standardFlag)});case"MailMsgLabel":return(0,fn.jsx)(sl,{...g,tooltip:(0,le.Z)("Label"),disabled:!this.state.messageSelected,image:cn.rpm[i],isMenuIndicatorVisible:!0,menu:this.customLabelsMenuData,size:i,hidePopup:this.closeCustomFlagDlg,hasLightArrow:!0,popupClassName:"ToolbarButtonPopup-DefaultStyles",popupPosition:this.props.popupPosition,isPopupVisible:this.state.showLabel,children:av(iv,{onClose:()=>Promise.resolve(this.closeCustomFlagDlg()),windowId:s,viewMode:"slide"})});case"MailMsgTrash":const a=sv(s,e,ue.AF.toolbar);return(0,fn.jsx)(sl,{...g,tooltip:e?(0,le.Z)("Undelete"):(0,le.Z)("Move to Trash"),onClick:e?()=>Wm.Z.undelete(s):()=>Wm.Z.prepareDelete(s,!1),disabled:!this.state.messageSelected||this.state.disableTrash,image:cn.nre[i],isMenuIndicatorVisible:a.length>0,menu:()=>a});case"MailMsgMove":return(0,fn.jsx)(sl,{...g,tooltip:(0,le.Z)("Move to Folder"),disabled:!this.state.messageSelected,image:cn.Kt8[i],isMenuIndicatorVisible:!0,menu:()=>Wm.Z.getMoveToFolderMenu(s)});case"MailMsgSend":const r="send"===this.props.prefValues[D.kMailSendOrQueue];return(0,fn.jsx)(sl,{...g,tooltip:r?(0,le.Z)("Send"):(0,le.Z)("Queue"),onClick:r?()=>Vm.sendMessage(s):()=>Vm.queueMessage(s,!1),title:r?(0,le.Z)("Send"):(0,le.Z)("Queue"),image:cn.zLp[i],menu:this.getSendQueueMenu,isMenuIndicatorVisible:!0});case"MailMsgDiscard":return(0,fn.jsx)(sl,{...g,tooltip:(0,le.Z)("Discard Draft"),onClick:()=>this.deleteDraftMessage(),image:cn.GqE[i],isMenuIndicatorVisible:!1});case"MailMsgAttach":return(0,fn.jsx)(sl,{...g,tooltip:(0,le.Z)("Add Attachment"),onClick:()=>Vm.chooseAttachments(),image:cn.UEH[i],isMenuIndicatorVisible:!1});case"MailMsgSpam":return(0,fn.jsx)(sl,{...g,tooltip:t?(0,le.Z)("Not Spam"):(0,le.Z)("Mark Message as Spam"),onClick:t?()=>Wm.Z.markAsNotJunk(s):()=>Wm.Z.markAsJunk(s),disabled:!this.state.messageSelected||this.state.disableJunk,image:cn.Qwh[i],isMenuIndicatorVisible:!1});case"MailMsgArchive":return(0,fn.jsx)(sl,{...g,tooltip:n?(0,le.Z)("Restore from Archive"):(0,le.Z)("Move to Archive"),onClick:n?()=>Wm.Z.restoreFromArchive(s):()=>Wm.Z.moveToArchive(s),disabled:!this.state.messageSelected||this.state.disableArchive,image:cn._w1[i],isMenuIndicatorVisible:!1});case"MailMsgShowHeaders":return(0,fn.jsx)(sl,{...g,tooltip:(0,le.Z)("Show Headers"),isMenuIndicatorVisible:!1,image:cn.x6W[this.props.size],menu:()=>Hm.getItems(rv,"composer")});case"MailCompose":return(0,fn.jsx)(sl,{...g,tooltip:(0,le.Z)("Compose New Mail"),isMenuIndicatorVisible:!1,image:cn.XTV[this.props.size],onClick:ne.Z.createDraft.bind(null,void 0)});default:return console.warn(`ToolbarButton “${this.props.name}” not found`),null}}}const cv=(0,fs.Z)(dv,lv);var hv=n(16875),pv=n(31118),uv=n(69046);class gv extends tn.PureComponent{static contextType=dn.Z;constructor(e,t){super(e);const n=W.Z.unsafeGetActivePage(t.vivaldiWindowId);this.state={activePageId:n.id,isInternalPage:St.jk.isInternalPage(n),navigationInfo:pv.Z.getNavigationInfo(n.id),pageHistoryIndex:-1,...this.getFastForwardStoreState(n.id)}}_isMounted=!1;componentDidMount(){this._isMounted=!0,hv.Z.addListener(this.fastForwardStoreChanged),pv.Z.addListener(this.navigationStoreChanged),W.Z.addListener(this.pageStoreChanged)}componentWillUnmount(){this._isMounted=!1,hv.Z.removeListener(this.fastForwardStoreChanged),pv.Z.removeListener(this.navigationStoreChanged),W.Z.removeListener(this.pageStoreChanged)}fastForwardStoreChanged=()=>{this.setState((e=>this.getFastForwardStoreState(e.activePageId)))};getFastForwardStoreState=e=>({forwardUrl:hv.Z.getFastForwardUrl(e),rewindRelativeIndex:hv.Z.getRewindRelativeIndex(e)});navigationStoreChanged=()=>{this.setState((e=>({navigationInfo:pv.Z.getNavigationInfo(e.activePageId)})))};pageStoreChanged=()=>{if(!this._isMounted)return;const e=W.Z.unsafeGetActivePage(this.context.vivaldiWindowId),t=St.jk.isInternalPage(e)&&!e.url.startsWith(St.jk.internals.startpage);e.id!==this.state.activePageId?this.setState({activePageId:e.id,isInternalPage:t,navigationInfo:pv.Z.getNavigationInfo(e.id),...this.getFastForwardStoreState(e.id)}):t!==this.state.isInternalPage&&this.setState({isInternalPage:t})};reload=({shiftKey:e})=>{this.state.navigationInfo&&(this.state.navigationInfo.isLoading?Vg.Z.stop(this.context.vivaldiWindowId,this.state.activePageId):Vg.Z.reload(this.context.vivaldiWindowId,this.state.activePageId,e))};cloneSelectedTabs=()=>{W.Z.isSelecting(this.context.vivaldiWindowId)?Y.Z.clonePages(W.Z.getSelectedPages(this.context.vivaldiWindowId)):Y.Z.clonePages(fa.aV.of(W.Z.unsafeGetActivePage(this.context.vivaldiWindowId)))};back=e=>{Vg.Z.back(this.context.vivaldiWindowId,this.state.activePageId)};backInBackground=()=>{this.openURLFromHistory(-1)};forward=()=>{Vg.Z.forward(this.context.vivaldiWindowId,this.state.activePageId)};forwardInBackground=()=>{this.openURLFromHistory(1)};isSubstripVisible(e){const t=W.Z.getTabsForPages(W.Z.getGroup(e,this.context.vivaldiWindowId),!0);return"substrip"===M.Z.get(D.kTabsStackingMode)&&(M.Z.get(D.kTabsStackingSubstripLocked)||t.size>1)}openURLFromHistory=e=>{const t=this.context.vivaldiWindowId;Vg.Z.getPageHistory(t,this.state.activePageId,((n,i)=>{const s=n+e;if(s>=0||s<i.length){const e=W.Z.getPageInWindow(t,this.state.activePageId),n=e?(0,uv.av)(e):null;Y.Z.openURL(t,i[s].url,{inCurrent:!1,inBackground:!0,transition:d.Z.historyPrivate.TransitionType.RELOAD,groupId:n&&this.isSubstripVisible(n)?n:void 0})}}))};rewind=()=>{Vg.Z.go(this.context.vivaldiWindowId,this.state.activePageId,-1*this.state.rewindRelativeIndex)};rewindInBackground=()=>{const e=this.context.vivaldiWindowId;if(this.state.rewindRelativeIndex>0){const t=W.Z.getActivePage(e);if(t){const n=hv.Z.getRewindHistory(t);n.length>0&&Y.Z.openURL(e,n[0].url,{inBackground:!0,transition:d.Z.historyPrivate.TransitionType.RELOAD})}}};goHome=e=>{Y.Z.showHomepage(e,{inCurrent:!0})};goHomeInBackground=e=>{Y.Z.showHomepage(e,{inBackground:!0})};getHistory=()=>new Promise((e=>Vg.Z.getPageHistory(this.context.vivaldiWindowId,this.state.activePageId,((t,n)=>this.setState({pageHistoryIndex:t},e(n))))));_onHistorySelection=(e,t,n,i)=>{const{ctrlKey:s,shiftKey:o,altKey:a,metaKey:r}=n,l=void 0===i?0:i,d=this.context.vivaldiWindowId;if(t&&(s||o||a||r||0!==l)){const e=(0,ls.Z)(d,{button:l,ctrlKey:Boolean(s),altKey:Boolean(a),shiftKey:Boolean(o),metaKey:Boolean(r)});Y.Z.openURL(d,t,{...e})}else Vg.Z.go(d,this.state.activePageId,e-this.state.pageHistoryIndex)};getHistoryMenuPromise=e=>()=>this.getHistory().then((t=>{const n="backward"===e?t.slice(0,this.state.pageHistoryIndex).reverse():t.slice(this.state.pageHistoryIndex+1),i="backward"===e?(e,t)=>e-t-1:(e,t)=>e+t+1;return n.map(((e,t)=>({...G.Z.makeNumberMnemonic(e.name,t),url:e.url,handler:n=>{this._onHistorySelection(i(this.state.pageHistoryIndex,t),e.url,n.keyState,n.button)}})))}));getContextMenuPromise=e=>{const t=this.context.vivaldiWindowId,n=Ai.getOptionFunction(e);return Ai.getNamedMenu(t,e,(async e=>{switch(e.action){case"CONTEXT_CONTAINER_CUSTOMIZE_TOOLBAR":return{items:this.props.customizeMenu,...n(t,e,{})};case"CONTEXT_CONTAINER_FORWARD_HISTORY":return this.getHistoryMenuPromise("forward")().then((i=>({items:i,...n(t,e,{})})));case"CONTEXT_CONTAINER_BACKWARD_HISTORY":return this.getHistoryMenuPromise("backward")().then((i=>({items:i,...n(t,e,{})})));default:return{...n(t,e,{})}}}))};getbackwardbuttonContextMenu=()=>this.getContextMenuPromise("backwardbutton");getforwardbuttonContextMenu=()=>this.getContextMenuPromise("forwardbutton");getrewindbuttonContextMenu=()=>this.getContextMenuPromise("rewindbutton");getfastforwardbuttonContextMenu=()=>this.getContextMenuPromise("fastforwardbutton");getreloadbuttonContextMenu=()=>this.getContextMenuPromise("reloadbutton");gethomebuttonContextMenu=()=>this.getContextMenuPromise("homebutton");render(){const{isInternalPage:e,navigationInfo:t}=this.state,n=this.context.vivaldiWindowId,{draggable:i,onDragStart:s,onDragEnd:o,onDrop:a,onDragEnter:r,mimeType:l,name:d,menuOrigin:c}=this.props,h={draggable:i,onDragStart:s,onDragEnd:o,onDrop:a,onDragEnter:r,mimeType:l,name:d,menuOrigin:c};switch(this.props.name){case"Back":return(0,fn.jsx)(sl,{...h,disabled:!t||!t.canGoBack,onClick:this.back,onMiddleClick:this.backInBackground,modifier:"ctrlCmd",tooltip:(0,le.Z)("Go to previous page")+"\n"+(0,le.Z)("Hold for history list"),menu:this.getbackwardbuttonContextMenu,alwaysMenu:!0,image:cn.mgF[this.props.size]});case"Forward":return(0,fn.jsx)(sl,{...h,disabled:!t||!t.canGoForward,onClick:this.forward,onMiddleClick:this.forwardInBackground,modifier:"ctrlCmd",tooltip:(0,le.Z)("Go to next page")+"\n"+(0,le.Z)("Hold for forward history list"),menu:this.getforwardbuttonContextMenu,alwaysMenu:!0,image:cn.Zu[this.props.size]});case"Rewind":return(0,fn.jsx)(sl,{...h,className:"button-narrow",disabled:!(Number.isInteger(this.state.rewindRelativeIndex)&&this.state.rewindRelativeIndex>0),onClick:this.rewind,onMiddleClick:this.rewindInBackground,tooltip:(0,le.Z)("Rewind by visited domain")+"\n"+(0,le.Z)("Hold for history domain list"),menu:this.getrewindbuttonContextMenu,alwaysMenu:!0,image:cn.jtA[this.props.size]});case"FastForward":return(0,fn.jsx)(sl,{...h,className:"button-narrow",tooltip:this.state.forwardUrl?(0,le.Z)("Fast Forward - $1",[this.state.forwardUrl]):(0,le.Z)("Fast Forward"),onClick:()=>m.Z.navigateFastforward(n),disabled:!this.state.forwardUrl,menu:this.getfastforwardbuttonContextMenu,alwaysMenu:!0,image:cn.Wmx[this.props.size]});case"Reload":case"COMMAND_PAGE_REFRESH":const i=!!t&&t.isLoading;return(0,fn.jsx)(sl,{...h,disabled:e,menu:this.getreloadbuttonContextMenu,alwaysMenu:!0,tooltip:i&&!e?(0,le.Z)("verb","Stop"):(0,le.Z)("Reload current page"),onClick:this.reload,onMiddleClick:this.cloneSelectedTabs,image:i&&!e?cn.YVA[this.props.size]:cn.GO5[this.props.size]});case"Home":case"COMMAND_SHOW_HOMEPAGE":return(0,fn.jsx)(sl,{...h,tooltip:(0,le.Z)("Go to homepage"),menu:this.gethomebuttonContextMenu,alwaysMenu:!0,onClick:()=>this.goHome(n),onMiddleClick:()=>this.goHomeInBackground(n),image:cn.PaK[this.props.size]});default:return null}}}const mv=gv;var vv;function fv(e,t,n,i){vv||(vv="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:vv,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class yv extends tn.PureComponent{render(){const{entry:e}=this.props,t=_i.parse(e.url).host;return(0,fn.jsxs)(fn.Fragment,{children:[fv(Oi,{size:32,style:e.read?{filter:"saturate(0) opacity(0.7)"}:{},url:e.url,title:e.url,loadType:"page"}),fv("div",{className:"readinglist-name",title:e.title.length>80?e.title:null,style:e.read?{filter:"opacity(0.7)"}:{}},void 0,fv("p",{className:"title"},void 0,e.title||t),e.title&&fv("p",{className:"info"},void 0,t)),fv("button",{type:"button",className:"ActionButton circular",onClick:t=>this.props.onClickMark(e.url,!e.read,t),title:e.read?(0,le.Z)("Mark as unread"):(0,le.Z)("Mark as read"),tabIndex:-1,dangerouslySetInnerHTML:{__html:e.read?cn.sgm.small:cn.D7r.small}}),fv("button",{type:"button",className:"ActionButton circular",onClick:t=>this.props.onClickRemove(e.url,t),title:(0,le.Z)("verb","Remove"),tabIndex:-1,dangerouslySetInnerHTML:{__html:cn.M2k.small}})]})}}const wv=yv;var bv,Cv=n(80342);function Sv(e,t,n,i){bv||(bv="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:bv,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Tv=[D.kKeyboardTabToAll];class Iv extends tn.PureComponent{static contextType=dn.Z;constructor(e){super(e),this.state={entries:Cv.Z.getList()||[],urlValid:(0,Ol.M)(this.props.url)}}componentDidMount(){Cv.Z.addListener(this._onStoreChanged)}componentDidUpdate(e){e.url!==this.props.url&&this.setState({urlValid:(0,Ol.M)(this.props.url)})}componentWillUnmount(){Cv.Z.removeListener(this._onStoreChanged)}_onStoreChanged=()=>{this.setState({entries:Cv.Z.getList()||[]})};onClickUrl=e=>{Y.Z.openURL(this.context.vivaldiWindowId,e,{singleton:!0}),Ol.Z.setReadStatus(e,!0),this.props.hidePopup()};onClickRemove=(e,t)=>{Ol.Z.remove(e),(0,Cs.Z)(t)};onClickMark=(e,t,n)=>{Ol.Z.setReadStatus(e,t),(0,Cs.Z)(n)};onSave=e=>{const t=this.context.vivaldiWindowId,n=W.Z.getActivePage(t);n&&Ol.Z.add(t,n.url,n.title),this.props.hidePopup(),(0,Cs.Z)(e)};onKeyDown=(e,t)=>{switch(t.key){case"Escape":(0,Cs.Z)(t),this.props.hidePopup();break;case"Enter":case" ":this.onClickUrl(e);break;case"Delete":case"Backspace":this.onClickRemove(e,t)}};renderDialogHeader=()=>Sv("div",{className:"dialog-header"},void 0,(0,le.Z)("Reading List"));renderEntry=(e,t)=>Sv("div",{tabIndex:0,className:"readinglist-item-large",onClick:this.onClickUrl.bind(this,e.url),onKeyDown:this.onKeyDown.bind(this,e.url)},e.url,Sv(wv,{onClickMark:this.onClickMark,onClickRemove:this.onClickRemove,entry:e}));renderReadingList=()=>{const e=this.state.entries.filter((e=>!e.read)),t=this.state.entries.filter((e=>e.read)),n=[];return e.length?n.push(Sv("header",{},"header1",(0,le.Z)("Unread Articles"))):t.length&&n.push(Sv("p",{className:"comment"},"all-done",(0,le.Z)("All articles read."))),e.forEach((e=>{n.push(this.renderEntry(e,!1))})),t.length&&n.push(Sv("header",{},"header2",(0,le.Z)("Read Articles"))),t.forEach((e=>{n.push(this.renderEntry(e,!0))})),!e.length&&!t.length&&n.push(Sv("p",{className:"comment"},"empty",(0,le.Z)("No articles in your reading list."))),n};renderAddCurrent=()=>Sv("footer",{className:"dialog-footer"},void 0,Sv("input",{className:"primary",type:"button",onClick:this.onSave,value:(0,le.Z)("Add Current Page"),disabled:!this.state.urlValid,autoFocus:!0}));render(){return Sv("div",{className:"reading-list-dialog"},void 0,this.renderDialogHeader(),Sv("div",{className:"readinglist-listing-large"},void 0,this.renderReadingList()),this.renderAddCurrent())}}const kv=(0,fs.Z)(Iv,Tv);var Av;function Zv(e,t,n,i){Av||(Av="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Av,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ev=[D.kReadingListShowCounter];class _v extends tn.PureComponent{static contextType=dn.Z;state={popupVisible:!1,readingListItems:Cv.Z.getUnreadCount(),url:W.Z.getActivePage(this.context.vivaldiWindowId)?.url??""};componentDidMount(){Cv.Z.addListener(this._onReadingStoreChange),W.Z.addListener(this._onPageStoreChange)}componentWillUnmount(){Cv.Z.removeListener(this._onReadingStoreChange),W.Z.removeListener(this._onPageStoreChange)}_onReadingStoreChange=()=>{const e=Cv.Z.getUnreadCount();this.setState({readingListItems:e})};_onPageStoreChange=()=>{const e=W.Z.getActivePage(this.context.vivaldiWindowId)?.url??"";this.setState({url:e})};togglePopup=()=>{this.setState((e=>({popupVisible:!e.popupVisible})))};hidePopup=()=>{this.setState({popupVisible:!1})};render(){const{readingListItems:e}=this.state,t=this.props.prefValues[D.kReadingListShowCounter]&&e>0?e>1e3?"999+":e.toString():void 0;return Zv(sl,{image:cn.R_e[this.props.size],tooltip:(0,le.Z)("Show the Reading List"),onClick:this.togglePopup,customizeMenu:this.props.customizeMenu,menuOrigin:this.props.menuOrigin,popupPosition:this.props.popupPosition,hidePopup:this.hidePopup,isPopupVisible:this.state.popupVisible,popupClassName:"ToolbarButtonPopup-DefaultStyles",popupWidth:350,size:this.props.size,badgeText:t,draggable:this.props.draggable,onDragStart:this.props.onDragStart??Tl.default,onDragEnd:this.props.onDragEnd??Tl.default,onDrop:this.props.onDrop??Tl.default,onDragEnter:this.props.onDragEnter??Tl.default,mimeType:this.props.mimeType,name:this.props.name??""},void 0,Zv(kv,{hidePopup:this.hidePopup,url:this.state.url}))}}const Nv=(0,fs.Z)(Br(_v),Ev);var Mv;function Pv(e,t,n,i){Mv||(Mv="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Mv,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}async function Dv(e,t){const n=W.Z.getActivePage(e);if(!n)return;const{ctrlKey:i,altKey:s,shiftKey:o,metaKey:a}=t,r={ctrlKey:i,altKey:s,shiftKey:o,metaKey:a},l=(0,xr.S2)(r),d=St.jk.isInternalUrl(n.url);if(!l||d)return void ms.Z.enableCapture(e);const c=M.Z.get(D.kWebpagesCaptureSaveLocation),h=M.Z.get(D.kWebpagesCaptureCompressionFormat),{image:p}=await gs.Z.captureFullpage(n.id,h,c);gs.Z.handleCaptureLocation(e,"fullpage",p)}const xv=e=>Pv(sl,{tooltip:(0,le.Z)("title","Capture Page"),onClick:Dv.bind(null,e.winId),image:cn.z8c[e.size],size:e.size,customizeMenu:e.customizeMenu,draggable:e.draggable,menuOrigin:e.menuOrigin,onDragStart:e.onDragStart,onDragEnd:e.onDragEnd,onDrop:e.onDrop,onDragEnter:e.onDragEnter,mimeType:e.mimeType,popupClassName:"ToolbarButtonPopup-DefaultStyles",name:e.name});var Ov;function Lv(e,t,n,i){Ov||(Ov="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Ov,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Rv extends tn.PureComponent{static contextType=dn.Z;refToolbarButton=tn.createRef();state={pageactionFiles:[],drawerOpen:!1,currentTarget:null,scriptOverrides:[],contentScripts:r.Z.getState()};componentDidMount(){d.Z.pageActions.onOverridesChanged.addListener(this.onOverridesChanged),r.Z.addListener(this.newScriptUpdateList),this.updateScriptOverrides()}componentWillUnmount(){r.Z.removeListener(this.newScriptUpdateList),d.Z.pageActions.onOverridesChanged.removeListener(this.onOverridesChanged)}componentDidUpdate(e){this.props.pageId!==e.pageId&&this.updateScriptOverrides()}newScriptUpdateList=()=>{const e=r.Z.getScripts();this.setState({contentScripts:e})};onOverridesChanged=e=>{e===this.props.pageId&&this.updateScriptOverrides()};updateScriptOverrides=()=>{d.Z.pageActions.getScriptOverridesForTab(this.props.pageId,(e=>{this.setState({scriptOverrides:e})}))};togglePopup=()=>{this.setState((e=>({drawerOpen:!e.drawerOpen})))};hidePopup=()=>{this.state.drawerOpen&&this.setState({drawerOpen:!1})};onItemClicked=(e,t)=>{this.isScriptEnabled(e)?d.Z.pageActions.setScriptOverrideForTab(e,this.props.pageId,"no_override",(()=>{})):d.Z.pageActions.setScriptOverrideForTab(e,this.props.pageId,"enabled",(()=>{}))};hasScriptOverrides=()=>0!==this.state.scriptOverrides.length;isScriptEnabled=e=>{const t=this.state.scriptOverrides.find((t=>t.script===e));return!!t&&"enabled"===t.override};keyDownHandler=(e,t)=>{switch(t.key){case"ArrowUp":this.moveFocus(e,"up",!1);break;case"ArrowDown":this.moveFocus(e,"down",!1);break;default:return}t.preventDefault(),t.stopPropagation()};moveFocus=(e,t,n)=>{const{HTMLElement:i}=this.context,s=this.refToolbarButton.current?.nodeRef.current;if(s instanceof i&&(!0===n||ss(s))){const n=Array.from(s.querySelectorAll("input")).map((e=>e.getAttribute("data-id"))).filter(Boolean);if(console.log("ids",n),0===n.length)return;let i;switch(t){case"current":if(""===e&&(e=n[0]),i=n.indexOf(e),-1===i)return;break;case"up":case"down":if(1===n.length)return;if(i=n.indexOf(e),-1===i)return;if("up"===t){if(i--,i<0)return}else if(i++,i>=n.length)return;break;default:return}e=n[i];const o=s.querySelector(`input[data-id="${e}"]`);o&&o.focus()}};render(){return(0,fn.jsxs)(sl,{ref:this.refToolbarButton,tooltip:(0,le.Z)("Page Actions"),disabled:this.props.disabled,isPopupVisible:this.state.drawerOpen,isOn:this.hasScriptOverrides(),onClick:this.togglePopup,hidePopup:this.hidePopup,image:cn.jVs[this.props.size],size:this.props.size,customizeMenu:this.props.customizeMenu,menuOrigin:this.props.menuOrigin,popupPosition:this.props.popupPosition,hasLightArrow:"above"===this.props.popupPosition,popupWidth:225,draggable:this.props.draggable,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,onDrop:this.props.onDrop,onDragEnter:this.props.onDragEnter,mimeType:this.props.mimeType,popupClassName:"ToolbarButtonPopup-DefaultStyles",name:this.props.name,children:[Lv("h2",{},void 0,(0,le.Z)("Page Actions")),Lv("div",{className:"popup-scrollarea"},void 0,this.state.contentScripts.map(((e,t)=>{const n=t.toString();return Lv("label",{onKeyDown:this.keyDownHandler.bind(this,n)},t,Lv("input",{"data-id":n,autoFocus:0===t,type:"checkbox",onChange:this.onItemClicked.bind(this,e),checked:this.isScriptEnabled(e)}),Lv("span",{},void 0,(0,c.gD)(e)))})))]})}}const Bv=Rv;var Fv,Uv=n(22303);function Vv(e,t,n,i){Fv||(Fv="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Fv,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Wv=[D.kAppearanceRangeButtons,D.kKeyboardTabToAll];class Hv extends tn.PureComponent{static contextType=dn.Z;refEditZoom=tn.createRef();state={editing:!1};static defaultProps={disabled:!1};setZoomLevel=(e,t,n)=>{this.props.onZoomUpdated(e,n);const i=this.refEditZoom.current,s=Math.round(100*e);i&&!isNaN(e)&&(i.value=s.toString())};resetZoom=()=>{this.setZoomLevel(this.props.defaultZoomLevel),Uv.Z.dispatchZoomUI(this.props.defaultZoomLevel)};updateZoomLevel=()=>{const e=parseFloat(this.props.zoom);this.setZoomLevel(e,this.props.delay)};zoomInStep=()=>{this.setZoomLevel(parseFloat((this.props.zoom+this.props.step).toFixed(2)))};zoomOutStep=()=>{this.setZoomLevel(parseFloat((this.props.zoom-this.props.step).toFixed(2)))};zoomHalf=()=>{this.setZoomLevel(parseFloat((this.props.zoom/2).toFixed(2)))};zoomDouble=()=>{this.setZoomLevel(parseFloat((2*this.props.zoom).toFixed(2)))};handleKeyDown=e=>{e.keyCode===qi.Z.KEY_LEFT?(this.zoomOutStep(),e.preventDefault()):e.keyCode===qi.Z.KEY_RIGHT&&(this.zoomInStep(),e.preventDefault())};rangeChanged=e=>{const{value:t}=e.target;this.setZoomLevel(parseFloat(t),this.state.editing,this.props.delay)};_onEditKeyDown=e=>{const{step:t,zoom:n}=this.props;if(e.keyCode===qi.Z.KEY_ESCAPE)this._onEditZoomBlur();else if(e.keyCode===qi.Z.KEY_SUBTRACT)this.setZoomLevel(n-t,!0),e.preventDefault();else if(e.keyCode===qi.Z.KEY_ADD)this.setZoomLevel(n+t,!0),e.preventDefault();else if(e.keyCode===qi.Z.KEY_RETURN){let e=parseFloat(this.refEditZoom.current?.value)/100;0!==e&&e===parseFloat(e)||(e=1),this.setZoomLevel(e)}};toggleEditZoom=()=>{this.props.disabled||this.setState((e=>({editing:!e.editing})),(()=>this.refEditZoom.current?.select()))};_onEditZoomBlur=()=>{this._activeElement&&(this._activeElement.focus(),delete this._activeElement),this.setState({editing:!1})};onMouseEnter=()=>{!1!==this.props.scrolling&&this.context.document.addEventListener("wheel",this.onMouseWheel,!0)};onMouseLeave=()=>{!1!==this.props.scrolling&&this.context.document.removeEventListener("wheel",this.onMouseWheel,!0)};onMouseDown=e=>{Lr(e)?e.preventDefault():this._activeElement=this.context.document.activeElement};onMouseUp=()=>{this.props.delay&&this.updateZoomLevel(),this._activeElement&&(this._activeElement.focus(),delete this._activeElement)};onMouseWheel=e=>{e.deltaX<0?this.zoomOutStep():e.deltaX>0?this.zoomInStep():e.deltaY>0?this.zoomOutStep():e.deltaY<0&&this.zoomInStep()};incrementCount=()=>{this.setZoomLevel(this.props.zoom+this.props.step)};decrementCount=()=>{this.setZoomLevel(this.props.zoom-this.props.step)};onPageZoomUpdated=e=>{const t=qt.Z.getActiveWebView(this.context.vivaldiWindowId);t&&t.setZoom(e)};showCustomizeMenu=(e,t)=>{const n=this.props.customizeMenu;n&&(e.persist(),e.preventDefault(),e.stopPropagation(),(0,zi.Z)(this.context.vivaldiWindowId,n)(e))};render(){const{customizeMenu:e,zoom:t}=this.props,n=this.props.prefValues[D.kAppearanceRangeButtons],i=this.props.disabled||(this.props.defaultZoomLevel?this.props.defaultZoomLevel===t:1===t),s=this.state.editing?(0,fn.jsx)("input",{className:"zoom-percent",type:"number",ref:this.refEditZoom,defaultValue:Math.round(100*t),onKeyDown:this._onEditKeyDown,onBlur:this._onEditZoomBlur,step:"1",disabled:this.props.disabled}):Vv("span",{className:mn()({"zoom-percent":!0,disabled:this.props.disabled}),onMouseDown:this.onMouseDown,onClick:this.toggleEditZoom},void 0,`${Math.round(100*t)} %`),o=this.props.inFooter?this.props.prefValues[D.kKeyboardTabToAll]:0;return Vv("div",{onContextMenu:e?this.showCustomizeMenu:null,className:"page-zoom-controls"},void 0,Vv(sl,{onClick:this.resetZoom,tooltip:(0,le.Z)("Reset Zoom"),disabled:i,title:(0,le.Z)("Reset"),tabIndex:o}),!n&&(0,fn.jsxs)(fn.Fragment,{children:[Vv("input",{type:"range",min:this.props.minLevel,max:this.props.maxLevel,step:this.props.step,onChange:this.rangeChanged,onKeyDown:this.handleKeyDown,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onMouseDown:-1===o?this.onMouseDown:null,onMouseUp:this.onMouseUp,onTouchEnd:this.onMouseUp,value:t,disabled:this.props.disabled,tabIndex:o}),s]}),n&&(0,fn.jsxs)(fn.Fragment,{children:[Vv(sl,{onClick:this.decrementCount,tooltip:(0,le.Z)("Zoom Out"),disabled:this.props.disabled,image:cn.M2k.medium,tabIndex:o}),s,Vv(sl,{onClick:this.incrementCount,tooltip:(0,le.Z)("Zoom In"),disabled:this.props.disabled,image:cn.md4.medium,tabIndex:o})]}))}}const zv=(0,fs.Z)(Hv,Wv);var Gv,$v=n(47825),Kv=n(71828);function jv(e,t,n,i){Gv||(Gv="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Gv,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var Yv=jv("input",{type:"range",min:"0",max:"2",value:"1",readOnly:!0});class Xv extends tn.PureComponent{static contextType=dn.Z;state={disabled:!qt.Z.getActiveWebView(this.context.vivaldiWindowId),defaultPageZoom:$v.Z.getState().defaultPageZoom,zoom:$v.Z.getState().zoom,notesZoom:$v.Z.getState().notesZoom,isNoteWebView:!1};componentDidMount(){$v.Z.addListener(this._onZoomStoreChanged),y.Z.tabs.onZoomChange.addListener(this._onTabZoomChange),d.Z.tabsPrivate.onPageZoom.addListener(this._onPageZoom),qt.Z.addListener(this._onActiveWebViewStoreChanged),this._onActiveWebViewStoreChanged()}componentWillUnmount(){qt.Z.removeListener(this._onActiveWebViewStoreChanged),y.Z.tabs.onZoomChange.removeListener(this._onTabZoomChange),d.Z.tabsPrivate.onPageZoom.removeListener(this._onPageZoom),$v.Z.removeListener(this._onZoomStoreChanged)}_onActiveWebViewStoreChanged=()=>{const e=qt.Z.getActiveWebView(this.context.vivaldiWindowId);e&&e.getZoom((t=>{this._updateZoomState(this.rangeCheck(t),e.name)})),this.setState({disabled:!e})};_onZoomStoreChanged=()=>{const{defaultPageZoom:e,zoom:t,notesZoom:n}=$v.Z.getState();this.setState({defaultPageZoom:e,zoom:t,notesZoom:n})};_onTabZoomChange=e=>{const t=qt.Z.getActiveWebView(this.context.vivaldiWindowId);t&&t.getZoom((n=>{n===e.oldZoomFactor&&e.tabId===this.props.pageId&&this._updateZoomState(e.newZoomFactor,t.name)}))};_onPageZoom=(e,t)=>{if(e!==this.context.vivaldiWindowId)return;const n=qt.Z.getActiveWebView(e);n&&n.getZoom((e=>{e+=.1*t,this._updateZoomState(e,n.name)}))};_updateZoomState=(e,t)=>{"markdowneditor"===t||"richtexteditor"===t?this.setState({notesZoom:e,isNoteWebView:!0}):this.setState({zoom:e,isNoteWebView:!1})};setZoomLevel=e=>{Uv.Z.setPageZoom(this.context.vivaldiWindowId,this.rangeCheck(e))};rangeCheck=e=>Math.min(Math.max(e,Kv.XF),Kv.qt);render(){const{disabled:e,zoom:t,notesZoom:n,isNoteWebView:i,defaultPageZoom:s}=this.state,o=this.props.draggable,a=this.props.onDrop&&this.props.onDragEnter;return(0,fn.jsxs)("div",{...Or({draggable:this.props.draggable,onDragStart:o?this.props.onDragStart:null,onDragEnd:o?this.props.onDragEnd:null,onDragEnter:a?this.props.onDragEnter:null,onDragOver:a?this.props.onDragOver:null,onDragLeave:a?this.props.onDragLeave:null,onDrop:a?this.props.onDrop:null}),className:this.props.buttonClasses,onContextMenu:e=>(0,zi.Z)(this.context.vivaldiWindowId,this.props.customizeMenu||[])(e),children:[this.props.preview&&Yv,!this.props.preview&&jv(zv,{zoom:i?n:t,scrolling:!0,inFooter:!0,defaultZoomLevel:s,maxLevel:Kv.qt,minLevel:Kv.XF,step:Kv.Zh,disabled:e,customizeMenu:this.props.customizeMenu,onZoomUpdated:this.setZoomLevel},"zoomslider")]})}}const Qv=Br(Xv);var qv=n(74117);const Jv=function(e="",t="",n){if(t.startsWith("data:"))return t;const i=e.toLowerCase().split(" ");let s;try{s=new RegExp("("+i.map((e=>(0,qv.Z)(e.toLowerCase()))).filter((e=>e.trim().length>0)).join("|")+")","i")}catch(e){return t}const o=t.toLowerCase().split(s);let a=0;return tn.createElement("span",{className:n},o.reduce(((e,n,i)=>{const o=a,r=n.match(s);return a+=n.length,r?e.concat(tn.createElement("b",{key:i},t.substr(o,n.length))):e.concat(tn.createElement("span",{key:i},t.substr(o,n.length)))}),[]))};var ef,tf;function nf(e,t,n,i){ef||(ef="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:ef,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class sf extends tn.PureComponent{domElement=tn.createRef();handleMouseUp=e=>{const{type:t,id:n,index:i}=this.props;e.button===vn.Z.kCenter&&this.props.onMiddleClick(t,n,i)};handleClick=e=>{const{type:t,id:n,index:i}=this.props;this.props.onClick(t,n,i,e)};handleDelete=e=>{if(!this.props.onDelete)return;const{type:t,id:n,index:i}=this.props;this.props.onDelete(t,n,i),e.stopPropagation()};componentDidUpdate(e){!e.isHighlighted&&this.props.isHighlighted&&this.domElement.current&&this.domElement.current.scrollIntoViewIfNeeded()}renderFavicon=()=>{const{faviconUrl:e,faviconType:t}=this.props;return e?nf(Oi,{url:e,loadType:"img"===t?"faviconFromCache":"page"}):null};render(){const{displayText:e,index:t,isHighlighted:n,onMouseOver:i,pattern:s,nickname:o,url:a,urls:r,type:l}=this.props,d=mn()({"omni-clickable":!0,OmniLinkItem:!0,"OmniLinkItem--Highlighted":n,"OmniLinkItem--SingleValue":!this.props.details});return(0,fn.jsxs)("div",{"data-index":t,"data-url":o||a||"",ref:this.domElement,className:d,onClick:this.handleClick,onMouseUp:this.handleMouseUp,onMouseOver:i,children:[this.props.faviconUrl&&nf("div",{className:"OmniLinkItem-Favicon"},void 0,this.renderFavicon()),nf("span",{className:"OmniLinkItem-Url"},void 0,s?Jv(s,e,"OmniLinkItem-Url"):e),this.props.details&&nf("span",{className:"OmniLinkItem-Details"},void 0,s&&Jv(s,this.props.details||"","OmniLinkItem-Details")||this.props.details,"OMNI_RESULT_FOLDER_NICKNAME"===l&&" – "+(0,le.Z)("Open all bookmarks in folder ($1)",[r&&r.length||0])),this.props.onDelete&&nf("span",{className:"OmniLinkItem-EraseButton",title:(0,le.Z)("Delete history item"),onClick:this.handleDelete,dangerouslySetInnerHTML:{__html:cn.kze}})]})}}function of(e,t,n,i){tf||(tf="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:tf,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class af extends tn.PureComponent{static contextType=dn.Z;nodeRef=tn.createRef();state={searchEngineKeyword:"",searchEngineName:""};static getDerivedStateFromProps(e){const t=(e.typedSearchEngine||e.defaultSearchEngine||{name:""}).name;return{searchEngineKeyword:!e.typedSearchEngine&&e.defaultSearchEngine&&e.defaultSearchEngine.keyword&&e.defaultSearchEngine.keyword+" "||"",searchEngineName:t}}getNode(){return this.nodeRef.current}handleClickOutside=()=>{this.props.onMenuClosed?.()};getNumberOfItems=()=>this.props.items.reduce(((e,{items:t})=>e+t.length),0);componentDidUpdate(e,t){if(this.props.selectionIndex!==e.selectionIndex){const e=this.getCurrentValue(this.props.selectionIndex);this.props.onSelectedItemChanged&&e&&this.props.onSelectedItemChanged(e)}const n=this.getNumberOfItems();this.props.onNumberOfSelectableItemsChanged&&this.props.onNumberOfSelectableItemsChanged(n)}onLinkItemClicked=(e,t,n,i)=>{const s={ctrlKey:i.ctrlKey,altKey:i.altKey,shiftKey:i.shiftKey,metaKey:i.metaKey,button:i.button},o=this.findLinkItem(e,t,n);o&&this.props.onLinkItemClicked(o,(0,ls.Z)(this.context.vivaldiWindowId,s))};getCurrentValue(e){return this.props.items.reduce(((e,t)=>[...e,...t.items]),[])[e]}onDeleteItem=(e,t,n)=>{const i=this.findLinkItem(e,t,n);i&&!i.disableDelete&&this.props.onDeleteItem(i)};onLinkItemMiddleClicked=(e,t,n)=>{const i=ls.k.openInBackgroundTab,s=this.findLinkItem(e,t,n);s&&this.props.onLinkItemClicked(s,i)};findLinkItem=(e,t,n)=>{const i=this.props.items.find((n=>n.items.some((n=>n.type===e&&n.id===t))))?.items[n];if(i)return i;console.error("linkItem id doesn't match",t)};renderLinkItem=(e,t)=>{const n=this._linkItemCount===this.props.selectionIndex,i=function(e){return e.displayText?e.displayText:e.url?e.url:e.title?e.title:e.text?e.text:""}(e);return this._linkItemCount++,of(sf,{id:e.id,displayText:i,index:t,isHighlighted:n,details:e.nickname||e.title||void 0,onClick:this.onLinkItemClicked,onMiddleClick:this.onLinkItemMiddleClicked,onDelete:this.onDeleteItem,pattern:e.disablePatternHighlight?void 0:this.props.pattern,hideIcons:Boolean(this.props.hideIcons),nickname:e.nickname||"",url:e.url||"",urls:e.urls||void 0,type:e.type,faviconUrl:e.faviconUrl||void 0,faviconType:e.faviconType||void 0},e.type+"-"+e.id+t)};renderCollection=({items:e,title:t,type:n})=>{if(!e||0===e.length)return null;return of("section",{className:"OmniDropdown-Collection"},`${n}-${t||""}`,t&&of("label",{className:"OmniDropdown-Label"},void 0,(0,le.Z)(t)),e.map(this.renderLinkItem))};render(){const{items:e}=this.props;return this._linkItemCount=0,(0,fn.jsx)("div",{ref:this.nodeRef,className:"OmniDropdown",children:e.map(this.renderCollection)})}}const rf=(0,Vr.Z)(af);var lf;function df(e,t,n,i){lf||(lf="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:lf,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var cf=df("li",{className:"divider"});class hf extends tn.PureComponent{static contextType=dn.Z;nodeRef=tn.createRef();componentDidUpdate(e){if(this.props.isSelected&&!e.isSelected){const{HTMLElement:e}=this.context,t=this.nodeRef.current;t instanceof e&&t.scrollIntoViewIfNeeded(!1)}}_handleMouseUp=e=>{e.button!==vn.Z.kLeft?e.stopPropagation():this.props.onItemActivated(this.props.item,e)};_killEvent=e=>{e.preventDefault(),e.stopPropagation()};_handleMouseOver=()=>{this.props.setSelected(this.props.index)};_getDisplayName=()=>df("span",{},void 0,this.props.item.name);_getDisplayShortcut=()=>{if(this.props.item.shortcut){return df("span",{className:"shortcut"},void 0,this.props.item.noPrettifying?this.props.item.shortcut:(0,Rd.$)(this.props.item.shortcut))}return null};_getIcon=()=>{if(this.props.item.iconSVG)return df("span",{dangerouslySetInnerHTML:{__html:this.props.item.iconSVG}});if(this.props.item.faviconUrl)return df(Oi,{url:this.props.item.faviconUrl,loadType:"faviconFromCache"});return df("img",{src:this.props.item.icon?this.props.item.icon:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"})};_renderItem=()=>{const e=this.props.item.type||"Normal";return(0,fn.jsxs)("li",{ref:this.nodeRef,className:mn()({selectedItem:this.props.isSelected}),onMouseOver:this._handleMouseOver,onMouseDown:this._killEvent,onMouseUp:this._handleMouseUp,children:["Normal"===e&&df("a",{tabIndex:"0"},void 0,df("label",{className:"menu-icon"},void 0,this._getIcon()),df("label",{className:"menu-label"},void 0,this._getDisplayName(),this._getDisplayShortcut())),"Checkbox"===e&&df("a",{tabIndx:"0"},void 0,df("label",{},void 0,df("span",{className:"menu-icon"},void 0,df("input",{type:"checkbox",checked:this.props.item.checked,readOnly:!0})),df("span",{className:"menu-label"},void 0,this._getDisplayName()))),"Radio"===e&&df("a",{tabIndex:"0"},void 0,df("label",{},void 0,df("span",{className:"menu-icon"},void 0,df("input",{className:"menu-icon",type:"radio",name:"radiomenu",checked:this.props.item.checked,readOnly:!0})),df("span",{className:"menu-label"},void 0,this._getDisplayName())))]})};_renderDivider=()=>cf;render(){return"Separator"===this.props.item.type?this._renderDivider():this._renderItem()}}const pf=hf;var uf,gf=n(34155);function mf(e,t,n,i){uf||(uf="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:uf,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class vf extends tn.PureComponent{static contextType=dn.Z;nodeRef=tn.createRef();state={selectedItemIndex:this.props.items.findIndex((e=>e.id===this.props.selectedItem?.id))};getNode(){return this.nodeRef.current}_takeFocus=e=>{e&&e.stopPropagation&&e.stopPropagation();const{HTMLElement:t,HTMLButtonElement:n}=this.context,i=this.getNode();if(i instanceof t){const e=i.querySelector(".menu .focusTrap");e&&e instanceof n&&e.focus()}};_onKeyboardFocusIn=()=>{const{HTMLElement:e}=this.context;gf.nextTick((()=>{const t=this.getNode();t instanceof e&&t.addEventListener("keydown",this._handleKeyboardNavigation)}))};_onKeyboardFocusOut=()=>{const{HTMLElement:e}=this.context,t=this.getNode();t instanceof e&&t.removeEventListener("keydown",this._handleKeyboardNavigation)};_handleKeyboardNavigation=e=>{switch(e.preventDefault(),e.which){case qi.Z.KEY_SPACE:case qi.Z.KEY_RETURN:const t=this.state.selectedItemIndex;t>=0&&t<=this._getMaxMenuIndex()&&this._onItemActivated(this.props.items[t],e);break;case qi.Z.KEY_ESCAPE:this.props.onClose?.();break;case qi.Z.KEY_UP:this._stepSelection(!1);break;case qi.Z.KEY_DOWN:this._stepSelection(!0);break;default:e.stopPropagation()}};_stepSelection=e=>{let t=this.state.selectedItemIndex;if(0!==this.props.items.filter((e=>"Separator"!==e.type)).length){do{t+=e?1:-1,t=(t+this.props.items.length)%this.props.items.length}while("Separator"===this.props.items[t].type);this._setSelected(t)}};_getMaxMenuIndex=()=>this.props.items.length-1;_setSelected=e=>{"Separator"===this.props.items[e].type||e>this._getMaxMenuIndex()||this.setState({selectedItemIndex:e})};_onClicked=e=>{e.preventDefault(),e.stopPropagation();const t=e.nativeEvent.target;t&&t instanceof HTMLElement&&t.focus()};_onItemActivated=(e,t)=>{t.stopPropagation(),this.props.onItemActivated(e)};handleClickOutside=e=>{this.props.onClose?.()};render(){return(0,fn.jsxs)("nav",{ref:this.nodeRef,className:mn()("menu",this.props.className),onMouseOver:this._takeFocus,onMouseDown:this._onClicked,onMouseUp:this._onClicked,onBlur:()=>this.props.onClose?.(),tabIndex:"-1",children:[mf("input",{type:"text",className:"focusTrap",autoFocus:!0,onFocus:this._onKeyboardFocusIn,onBlur:this._onKeyboardFocusOut}),mf("ul",{},void 0,this.props.items.map(((e,t)=>mf(pf,{index:t,item:e,isSelected:this.state.selectedItemIndex===t,setSelected:this._setSelected,onItemActivated:this._onItemActivated},t))))]})}}const ff=(0,Vr.Z)(vf);var yf;function wf(e,t,n,i){yf||(yf="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:yf,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function bf({onClick:e,icon:t}){return wf(sl,{onClick:e,tooltip:(0,le.Z)("Change search engine"),faviconPath:t})}function Cf({onClick:e}){return wf(sl,{onClick:e,tooltip:(0,le.Z)("Change search engine"),image:cn.L$F})}class Sf extends tn.PureComponent{onItemClicked=({id:e})=>{this.props.onItemClicked(e)};render(){return wf(tn.Fragment,{},void 0,wf("div",{className:"toolbar-insideinput SearchEngineSelect-Icon"},void 0,this.props.useFavicon?wf(bf,{onClick:this.props.toggleOpen,icon:this.props.icon}):wf(Cf,{onClick:this.props.toggleOpen})),this.props.isOpen&&wf(ff,{items:this.props.items,onClose:this.props.onClose,onItemActivated:this.onItemClicked}))}}const Tf=Sf;var If=n(10589),kf=n(77398),Af=n(25776);const Zf={};let Ef=[];class _f extends Us.Z{getText(e){const t=W.Z.getActivePage(e);return t?Zf[t.id]??"":""}getTypedHistory(){return Ef}dispatchAction(e){switch(e.actionType){case"SEARCH_FIELD_ADD_TYPED_HISTORY":s=e.query,i=e=>{let t=function(e,t){let n=e;return e.length>=30&&(n=(0,Af.default)(e,30)),t&&(n=n.filter((({url:e})=>e!==t))),n}(e,s);t=[{type:"OMNI_RESULT_TYPED_HISTORY_SEARCH",id:s,url:s,when:Date.now()}].concat(t),M.Z.get(D.kHistoryDaysToKeepVisits)>0&&f.Z.set({TYPED_SEARCH_HISTORY:JSON.stringify(t)}),Ef=t,Pf.emitChange()},M.Z.get(D.kHistoryDaysToKeepVisits)>0?Nf(f.Z.getSync("TYPED_SEARCH_HISTORY"),i):Nf(JSON.stringify(Ef),i);break;case"SEARCH_FIELD_DELETE_TYPED_HISTORY":!function(e){const t=Ef.filter((({url:t})=>e!==t));M.Z.get(D.kHistoryDaysToKeepVisits)>0&&f.Z.set({TYPED_SEARCH_HISTORY:JSON.stringify(t)});Ef=t,Pf.emitChange()}(e.query);break;case"SEARCH_FIELD_DELETE_TYPED_HISTORY_FROM_DATABASE":Mf();break;case"SEARCH_FIELD_INIT_TYPED_HISTORY":Nf(e.typedHistory,(e=>{Ef=e,Pf.emitChange()}));break;case"SEARCH_FIELD_SET_TEXT":t=e.tabId,n=e.text,Zf[t]=n,Pf.emitChange();break;case"SEARCH_FIELD_WRITE_TYPED_HISTORY_TO_DATABASE":f.Z.set({TYPED_SEARCH_HISTORY:JSON.stringify(Ef)});break;case"BROWSING_DATA_REMOVED":!0===(0,kf.default)(e,"dataTypes.typedHistory")&&function({since:e,dataTypes:{typedHistory:t}}){if(null==t)throw TypeError("Typed history must be true or false");const n=Ef.filter((({when:t})=>e-t>0));M.Z.get(D.kHistoryDaysToKeepVisits)>0&&f.Z.set({TYPED_SEARCH_HISTORY:JSON.stringify(n)});Ef=n,Pf.emitChange()}(e);break;case"CHROME_TABS_REMOVED":!function(e){delete Zf[e]}(e.tabId);break;case"NAVIGATION_HISTORY_ALL_DELETED":Mf(),Ef=[],Pf.emitChange()}var t,n,i,s}}function Nf(e,t=Tl.default){let n=[];try{e&&(n=JSON.parse(e))}catch(e){console.warn("Unable to parse typed history JSON. TODO: fix!",e)}t(n)}function Mf(){f.Z.remove("TYPED_SEARCH_HISTORY")}const Pf=new _f(l.Z),Df=Pf;var xf,Of=n(90349);function Lf(e,t,n,i){xf||(xf="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:xf,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Rf({className:e}){return Lf("span",{className:e,dangerouslySetInnerHTML:{__html:cn.V34}})}var Bf=Lf(Rf,{className:"VivaldiDropdown-SelectedValue-Arrow"});function Ff({item:e}){return Lf("span",{className:"VivaldiDropdown-SelectedValue"},void 0,e&&e.icon&&Lf("img",{src:e.icon,className:"VivaldiDropdown-SelectedValue-Icon"}),e&&e.faviconUrl&&Lf(Oi,{url:e.faviconUrl,className:"VivaldiDropdown-SelectedValue-Icon",loadType:"faviconFromCache"}),e&&Lf("span",{className:"VivaldiDropdown-SelectedValue-Title"},void 0,e.name),Bf)}var Uf=Lf(Rf,{className:"VivaldiDropdown-SelectedValue-Arrow"});class Vf extends tn.Component{refButton=tn.createRef();state={isExpanded:!1};onItemActivated=({id:e})=>{this.props.onValueChange(e),this.collapse()};collapse=()=>{this.setState({isExpanded:!1}),this.focus()};toggle=e=>{(0,Cs.Z)(e),this.setState((e=>({isExpanded:!e.isExpanded})))};handleKeyDown=e=>{switch(e.which){case qi.Z.KEY_UP:case qi.Z.KEY_DOWN:this.setState({isExpanded:!0})}};focus=()=>{this.refButton.current?.focus()};render(){const e=this.props.items.find((e=>e.id===this.props.value));return Lf("div",{className:mn()("VivaldiDropdown",this.props.className)},void 0,(0,fn.jsx)("button",{type:"button",ref:this.refButton,disabled:this.props.disabled,onMouseDown:this.toggle,title:this.props.tooltip,className:mn()("VivaldiDropdown-Button",{"VivaldiDropdown-Button--isActive":this.state.isExpanded}),onKeyDown:this.handleKeyDown,children:this.props.hideButtonText?Uf:Lf(Ff,{item:e||this.props.items[0]})}),this.state.isExpanded&&Lf(ff,{className:"VivaldiDropdown-DropdownMenu",items:this.props.items,onClose:this.collapse,onItemActivated:this.onItemActivated,selectedItem:e}))}}const Wf=Vf;var Hf=n(57904),zf=n(34155);class Gf{_numberOfSelectableItems=0;_selectionIndex=-1;constructor(e){this._inputComponent=e}setNumberOfSelectableItems=e=>{this._numberOfSelectableItems=e};getNumberOfSelectableItems=()=>this._numberOfSelectableItems;setSelectionIndex=e=>{this._selectionIndex=e};getSelectionIndex=()=>this._selectionIndex;_moveHighlight=(e,t)=>{const{HTMLElement:n}=this._inputComponent.context,i=this._inputComponent.getDropdown()?.nodeRef.current;if(!(i instanceof n))return Promise.reject();let s=-1;const o=Array.from(i.getElementsByClassName("omni-clickable")),a=this.getSelectionIndex(),r=this.getNumberOfSelectableItems();if(null==a||-1===a||null==o[a])s=e?0:r-1;else{const n=o[a],l=0===a||parseInt(i.scrollTop)+10>n.offsetTop;switch(t){case"page":if(e)l?s=o.findIndex((e=>e.offsetTop+e.offsetHeight>i.offsetHeight)):(i.scrollTop=n.offsetTop,s=o.findIndex((e=>e.offsetTop>i.offsetHeight+i.scrollTop))),-1===s&&(s+=r);else if(l)i.scrollTop-=i.offsetHeight;else{let e=o.length-1;for(;e>0&&!(o[e].offsetTop-o[e].offsetHeight<i.scrollTop);e--);s=e}break;case"section":if(e){let e=this._getSectionIndex(!0,a+1,o);-1===e&&(e=this._getSectionIndex(!0,0,o)),-1!==e&&(s=e)}else{let e=this._getSectionIndex(!1,a-1,o);-1===e&&(e=this._getSectionIndex(!1,o.length-1,o)),-1!==e&&(s=e)}break;case"line":s=a+(e?1:-1),e?s>=r&&(s=-1):s<-1&&(s=r-1)}}return Number.isInteger(s)?(this._inputComponent.setAutocompleteHighlight(s,!0),new Promise((e=>{zf.nextTick(e)}))):Promise.reject()};_getSectionIndex=(e,t,n)=>{if(e)for(let e=t;e<n.length;e++){if("0"===n[e].dataset.index)return e}else for(let e=t;e>=0;e--){if("0"===n[e].dataset.index)return e}return-1};up=()=>this._moveHighlight(!1,"line");down=()=>this._moveHighlight(!0,"line");pageUp=()=>this._moveHighlight(!1,"page");pageDown=()=>this._moveHighlight(!0,"page");sectionUp=()=>this._moveHighlight(!1,"section");sectionDown=()=>this._moveHighlight(!0,"section")}var $f,Kf=n(58848),jf=n(40037),Yf=n(34155);function Xf(e,t,n,i){$f||($f="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:$f,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Qf=[D.kAddressBarSearchDisplay,D.kAddressBarSearchFieldWidth,D.kAddressBarSearchInNewTab,D.kAddressBarSearchKeepSelected,D.kAddressBarSearchShowFavicon,D.kAddressBarSearchSuggestEnabled,D.kAddressBarSearchTypedHistoryEnabled,D.kKeyboardTabToAll,D.kStartpageSpeedDialTrackerSuggestionShow];function qf({disabled:e,tabIndex:t,onMouseDown:n,onClick:i}){return Xf("div",{className:"toolbar toolbar-insideinput"},void 0,Xf("div",{className:"button-toolbar"},void 0,Xf("button",{disabled:e,tabIndex:t,title:(0,le.Z)("Show search history"),onMouseDown:n,onClick:i,dangerouslySetInnerHTML:{__html:cn.V34}})))}function Jf({onClick:e,tabIndex:t}){return Xf("div",{className:"toolbar toolbar-insideinput"},void 0,Xf("div",{className:"button-toolbar"},void 0,Xf("button",{onMouseDown:e=>e.preventDefault(),tabIndex:t,title:(0,le.Z)("verb","Search"),className:"SearchField-ExecuteSearchButton",onClick:e,dangerouslySetInnerHTML:{__html:cn.V34}})))}function ey(){return Nn.Z.get().filter((e=>5===e.prepopulateId||7===e.prepopulateId))}function ty(){const e=ey();return 0===e.length?"":e[0].id}class ny extends tn.PureComponent{static contextType=dn.Z;_isPasting=!1;_nav=new Gf(this);_isIMEOpen=!1;_justClosedIME=!1;_isOnSpeedDial="speed_dial_view"===this.props.origin;_omniDropdownRef=tn.createRef();_suppressReplace=!1;state={dropdownSelectionIndex:-1,editText:Df.getText(this.context.vivaldiWindowId),typedValue:"",filteredTypedHistoryStore:[],isOmniDropdownOpen:!1,searchSuggestionStore:[],showAll:!1,showPopup:!1,searchEngineSelectItems:[],typedHistoryStore:[],currentSearchEngine:void 0,selectedItem:void 0,numberOfSelectableItems:0,isSearchEngineSelectOpen:!1,engineSuggestionSelected:ty()};componentDidMount(){this._onSearchEngineCacheChanged(),this._onSearchFieldStoreChanged(),Nn.Z.addListener(this._onSearchEngineCacheChanged),Df.addListener(this._onSearchFieldStoreChanged),Hf.Z.addListener(this._onWebpageviewStoreChanged)}componentWillUnmount(){Nn.Z.removeListener(this._onSearchEngineCacheChanged),Df.removeListener(this._onSearchFieldStoreChanged),Hf.Z.removeListener(this._onWebpageviewStoreChanged)}_onWebpageviewStoreChanged=e=>{e.winId===this.context.vivaldiWindowId&&"WEBPAGEVIEW_ACTIONS"===e.type&&("searchPasteAndGo"===e.action?e.payload&&!this._isOnSpeedDial&&Yf.nextTick((()=>this._pasteAndGo(e.payload))):"focusSearchField"===e.action&&("button"===this.props.prefValues[D.kAddressBarSearchDisplay]&&this.toggleHiddenSearchFieldPopup(),Yf.nextTick(this.focusField)))};_pasteAndGo=({openOptions:e,clipboardText:t})=>{this._search({value:t,openOptions:e})};_onSearchSuggestionsReceived=(e,t)=>{const n=t.map((e=>({id:e,url:e,type:"OMNI_RESULT_SUGGEST"})));this.state.editText&&e&&(this.state.editText.startsWith(e)||e.startsWith(this.state.editText))&&this.setState({searchSuggestionStore:n},(()=>this._showDropdown()))};_onSearchEngineCacheChanged=()=>{this.setState(((e,t)=>{const n=Nn.Z.get().map((e=>({name:e.name,faviconUrl:e.faviconUrl,shortcut:e.keyword,noPrettifying:!0,id:e.id}))),i=t.prefValues[D.kAddressBarSearchKeepSelected],s=z.ZP.isIncognito(this.context.vivaldiWindowId);let o=e.currentSearchEngine;return this._isOnSpeedDial?o=Nn.Z.getSpeeddialsSearch(s):i?o=Nn.Z.getSearchField(s):o&&n.find((e=>e.id===o?.id))||(o=Nn.Z.getDefault(s)),{currentSearchEngine:o,searchEngineSelectItems:n}}))};_onSearchFieldStoreChanged=()=>{const{document:e}=this.context,t=Df.getTypedHistory(),n={};if(n.typedHistoryStore=t,e.activeElement===this._refSearch){const e=Df.getText(this.context.vivaldiWindowId),i=e.trim()&&t.filter((t=>t.url.toLowerCase().startsWith(e.toLowerCase())))||[];n.editText=e,n.filteredTypedHistoryStore=i}this.setState(n)};_onCompositionStart=()=>{this._isIMEOpen=!0};_onCompositionEnd=()=>{this._isIMEOpen=!1,this._justClosedIME=!0};_updateCurrentEngine=e=>{this.setState({currentSearchEngine:e},(()=>{if(this._isOnSpeedDial||this.props.prefValues[D.kAddressBarSearchKeepSelected]){const t=z.ZP.isIncognitoOrGuest(this.context.vivaldiWindowId),n=this._isOnSpeedDial?t?"defaultSpeeddialsPrivate":"defaultSpeeddials":t?"defaultSearchFieldPrivate":"defaultSearchField";d.Z.searchEngines.setDefault(n,e.id)}}))};_search=({value:e,openOptions:t})=>{const{document:n}=this.context;this._abortController&&this._abortController.abort(),this._protectedSearchSuggest.cancel&&this._protectedSearchSuggest.cancel(),this._refSearch&&n.activeElement===this._refSearch&&this._refSearch.blur(),this.setState({editText:e}),If.Z.setText(this.context.vivaldiWindowId,e);let i=!t||!1!==t.inCurrent;this.props.prefValues[D.kAddressBarSearchInNewTab]&&(this._isOnSpeedDial||(i=!1));const s=e.indexOf(" "),o=e.split(" ")[0],a=Nn.Z.getByKeyword(o);e=a?e.substring(s,e.length):e,a&&this._updateCurrentEngine(a);const r={...t,inCurrent:i,addTypedSearchHistory:!0};e.length>0&&this.state.currentSearchEngine&&this.onSearch(e,this.state.currentSearchEngine,r)};onSearch=(e,t,n={})=>{Of.Z.goSearchURL(this.context.vivaldiWindowId,e.trim(),{useSearchEngine:t,...n}),this._hideDropdown()};onKeyDowned=e=>{this._justClosedIME=!1;const t=e.shiftKey&&!e.ctrlKey&&!e.altKey&&!e.metaKey,n=!(0,Bu.Z)(e),{isOmniDropdownOpen:i}=this.state;switch(e.key){case"ArrowUp":return void(i&&(e.preventDefault(),e.stopPropagation()));case"ArrowDown":return void(t&&this.onKeyPressed(e));case"Tab":if(!i)return;return n&&(e.preventDefault(),e.stopPropagation(),Yf.nextTick(this._nav.down)),void(t&&(e.preventDefault(),e.stopPropagation(),Yf.nextTick(this._nav.up)));case"Escape":return void("button"!==this.props.prefValues[D.kAddressBarSearchDisplay]?(e.stopPropagation(),e.preventDefault(),this.setState((e=>({editText:e.typedValue})))):this.state.isOmniDropdownOpen&&(e.stopPropagation(),e.preventDefault(),this.setState({isOmniDropdownOpen:!1})));case"Enter":return void(n||this.onKeyPressed(e))}};onExecuteSearchButtonClick=e=>{const t={ctrlKey:e.ctrlKey,altKey:!1,shiftKey:e.shiftKey||e.altKey,metaKey:e.metaKey},n=(0,ls.Z)(this.context.vivaldiWindowId,t),i=this.state.selectedItem?this.state.selectedItem.url:this.state.typedValue;this._search({value:i,openOptions:n})};onKeyPressed=e=>{const{key:t,shiftKey:n,currentTarget:i}=e;switch(t){case"Enter":{this._justClosedIME=!1,this._abortController&&this._abortController.abort(),this._protectedSearchSuggest.cancel&&this._protectedSearchSuggest.cancel();const t={ctrlKey:e.ctrlKey,altKey:!1,shiftKey:e.shiftKey||e.altKey,metaKey:e.metaKey},n=(0,ls.Z)(this.context.vivaldiWindowId,t);return void this._search({value:i.value,openOptions:n})}case"ArrowDown":if(!n)return;return void(this.state.typedHistoryStore.length>0&&this.props.prefValues[D.kAddressBarSearchTypedHistoryEnabled]&&this._showDropdown({showAll:!0}));case"Tab":return void this._hideDropdown()}};onSearchEngineChanged=e=>{const t=this._refSearch?this._refSearch.value:"";this._refSearch&&""===t&&this._refSearch.focus();const n=Nn.Z.getById(e);if(t.length>0&&n){const e={addTypedSearchHistory:!0,inCurrent:this._isOnSpeedDial||!0!==this.props.prefValues[D.kAddressBarSearchInNewTab]};this.onSearch(t,n,e)}n&&this._updateCurrentEngine(n),this.setState({searchSuggestionStore:[],isSearchEngineSelectOpen:!1})};onTypedSearchHistoryDeleted=e=>{e.url&&If.Z.deleteTypedSearchHistory(e.url)};_showDropdown=(e={})=>{if(!0===this._isPasting)return;const{document:t}=this.context;let{showAll:n}=e;"boolean"!=typeof n&&(n=!1),this.setState({showAll:n}),!0!==this.state.isOmniDropdownOpen&&(this._refSearch&&t.activeElement!==this._refSearch&&this._refSearch.focus(),this.setState({isOmniDropdownOpen:!0}))};_hideDropdown=()=>{this.state.isOmniDropdownOpen&&this.setState({selectedItem:void 0,isOmniDropdownOpen:!1,showAll:!1,searchSuggestionStore:[]})};componentDidUpdate(e,t){t.dropdownSelectionIndex!==this.state.dropdownSelectionIndex&&this._nav.setSelectionIndex(this.state.dropdownSelectionIndex);const n=(this.state.showAll?this.state.typedHistoryStore.length:this.state.filteredTypedHistoryStore.length)+this.state.searchSuggestionStore.length;this._nav.setNumberOfSelectableItems(n)}getDropdown=()=>this._omniDropdownRef.current;setAutocompleteHighlight=(e,t)=>{this.setState({dropdownSelectionIndex:e}),t&&this.setState((e=>({editText:e.selectedItem&&e.selectedItem.url||e.editText})))};_esc=()=>{if(this._isIMEOpen||this._justClosedIME)this._justClosedIME=!1;else{if(!0===this.state.isOmniDropdownOpen)this._hideDropdown();else if(this.state.editText)this.setState({typedValue:""}),If.Z.setText(this.context.vivaldiWindowId,"");else{const e=W.Z.getActivePage(this.context.vivaldiWindowId);e&&Vg.Z.doAction(this.context.vivaldiWindowId,e.id,"focusWebView")}this._justClosedIME=!1}};_onDelete=()=>{this.state.selectedItem&&this.onTypedSearchHistoryDeleted(this.state.selectedItem)};_onKeyboardChanged=(e,t,n,i)=>{if(t&&0===n)switch(i){case qi.Z.KEY_DOWN:if(this._isIMEOpen)return;!0===this.state.isOmniDropdownOpen?this._nav.down():this.setState({isSearchEngineSelectOpen:!0});break;case qi.Z.KEY_UP:this._isIMEOpen||this._nav.up();break;case qi.Z.KEY_END:this.setAutocompleteHighlight(this.state.numberOfSelectableItems-1,!0);break;case qi.Z.KEY_ESCAPE:"button"!==this.props.prefValues[D.kAddressBarSearchDisplay]&&this._esc();break;case qi.Z.KEY_HOME:this.setAutocompleteHighlight(0,!0);break;case qi.Z.KEY_PAGE_DOWN:this._nav.pageDown();break;case qi.Z.KEY_PAGE_UP:this._nav.pageUp();break;case qi.Z.KEY_DELETE:this._onDelete()}};onFocus=()=>{d.Z.tabsPrivate.onKeyboardChanged.addListener(this._onKeyboardChanged)};onBlur=e=>{const{getSelection:t}=this.context,n=t();n&&n.empty(),d.Z.tabsPrivate.onKeyboardChanged.removeListener(this._onKeyboardChanged)};onMouseDown=e=>{const{document:t}=this.context;this._focusedOnMouseDown=t.activeElement};onMouseUp=({currentTarget:e})=>{const{document:t}=this.context;t.activeElement===e&&(this._focusedOnMouseDown!==this._refSearch&&e.selectionStart===e.selectionEnd&&e.select(),this._focusedOnMouseDown=void 0)};onDoubleClick=e=>{e.preventDefault(),e.stopPropagation()};onPaste=e=>{this._isPasting=!0,setTimeout((()=>this._isPasting=!1),5)};_protectedSearchSuggest=(0,Kf.default)(((e,t,n)=>{this._abortController&&this._abortController.abort(),this._abortController=new AbortController,lo(e,t,n,this._abortController.signal,this._onSearchSuggestionsReceived)}),500,{leading:!1});onChange=({currentTarget:{value:e}})=>{If.Z.setText(this.context.vivaldiWindowId,e);const t=e.length>0&&e.indexOf(" ")>=1?Nn.Z.getByQuery(e):null;t&&this.setState({currentSearchEngine:t}),this.props.prefValues[D.kAddressBarSearchSuggestEnabled]&&e.trim().length>1?this.state.currentSearchEngine&&this._protectedSearchSuggest(this.context.vivaldiWindowId,e,this.state.currentSearchEngine):this.setState({searchSuggestionStore:[]}),this.setState({dropdownSelectionIndex:-1,typedValue:e})};onDragStart=e=>{this._suppressReplace=!0};onDragOver=e=>{e.stopPropagation()};onDragEnter=e=>{if(e.stopPropagation(),this._suppressReplace)return;e.preventDefault();const t=e.target;t instanceof HTMLInputElement&&""!==t.value&&t.classList.add("pseudo-selected")};onDragLeave=e=>{if(!this._suppressReplace){const t=e.target;t instanceof HTMLInputElement&&t.classList.remove("pseudo-selected")}};onDropped=e=>{if(this._suppressReplace)this._suppressReplace=!1;else{const t=e.dataTransfer.getData("text/plain");e.dataTransfer.types.length>1&&""!==t&&(e.preventDefault(),this.setState({editText:t}),If.Z.setText(this.context.vivaldiWindowId,t));const n=e.target;n instanceof HTMLInputElement&&n.classList.remove("pseudo-selected")}};onToggleDropdownClicked=e=>{if(e.preventDefault(),"click"!==e.type||0===e.clientX||0===e.clientY)return this.state.isOmniDropdownOpen?void this._hideDropdown():(this._onSearchFieldStoreChanged(),void this._showDropdown({showAll:!0}))};onSlidebarPosition=(e,t)=>{if(this._refSearchField){const t=this._refSearchField.getBoundingClientRect();nt.Z.set(D.kAddressBarSearchFieldWidth,Math.floor(t.right-e))}};getWidth=()=>(0,jf.default)(this.props.prefValues[D.kAddressBarSearchFieldWidth],175,800);focusField=()=>{(0,Io.P)("SearchField",this.context.vivaldiWindowId)&&this._refSearch?.select()};onOmniDropdownItemClicked=(e,t)=>{this._search({value:e.url,openOptions:t})};onContextMenu=e=>{e.stopPropagation()};onOmniDropdownSelectedItemChange=e=>{this.setState({selectedItem:e})};renderDropdown=()=>{const e=[{items:this.state.showAll?this.state.typedHistoryStore:this.state.filteredTypedHistoryStore,type:"OMNI_RESULT_TYPED_HISTORY_SEARCH"},{items:this.props.prefValues[D.kAddressBarSearchSuggestEnabled]?this.state.searchSuggestionStore.map((e=>({...e,disableDelete:!0}))):[],type:"OMNI_RESULT_SUGGEST"}];return 0===e.length?null:(0,fn.jsx)(rf,{hideIcons:!0,onSelectedItemChanged:this.onOmniDropdownSelectedItemChange,defaultSearchEngine:this.state.currentSearchEngine,onDeleteItem:this.onTypedSearchHistoryDeleted,onLinkItemClicked:this.onOmniDropdownItemClicked,pattern:this.state.editText,ref:this._omniDropdownRef,selectionIndex:this.state.dropdownSelectionIndex,setAutocompleteHighlight:this.setAutocompleteHighlight,items:e,onMenuClosed:this._hideDropdown})};renderEngineSuggestionDropdown=e=>{const t=e.map((e=>({type:"Normal",id:e.id,name:e.name,icon:e.faviconUrl})));return Xf(Wf,{className:"engine-suggestion",items:t,value:this.state.engineSuggestionSelected,onValueChange:e=>this.setState({engineSuggestionSelected:e}),tooltip:(0,le.Z)("Select Default Search Engine")})};toggleSearchEngineSelectOpen=()=>{this.setState((e=>({isSearchEngineSelectOpen:!e.isSearchEngineSelectOpen})))};closeSearchEngineSelect=()=>{this.setState({isSearchEngineSelectOpen:!1})};shouldShowTrackerMessage=()=>"speed_dial_view"===this.props.origin&&this.props.prefValues[D.kStartpageSpeedDialTrackerSuggestionShow]&&this.state.currentSearchEngine&&this.state.currentSearchEngine.url.includes("google");hideSearchField=()=>{this.setState({showPopup:!1})};toggleHiddenSearchFieldPopup=()=>{this.setState((e=>({showPopup:!e.showPopup})))};renderSearchField(){const{preview:e=!1}=this.props;if(e)return(0,fn.jsx)("input",{type:"text",value:(0,le.Z)("verb","Search"),...Or({draggable:this.props.draggable,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,onDragEnter:this.props.onDragEnter,onDragOver:this.props.onDragOver,onDragLeave:this.props.onDragLeave,onDrop:this.props.onDrop}),readOnly:!0});const t=this.state.currentSearchEngine?(0,le.Z)("Search $1",[this.state.currentSearchEngine.name]):"",n=0===this.state.typedHistoryStore.length,i=Boolean(this.state.typedValue),s=!i&&this.props.prefValues[D.kAddressBarSearchTypedHistoryEnabled],o=ey(),a=this.props.popupPosition||"below";return(0,fn.jsxs)(fn.Fragment,{children:[(0,fn.jsxs)("div",{ref:e=>this._refSearchField=e,className:mn()(this.props.buttonClasses,this.props.className,"iconmenu-container","SearchField",a),...Or({draggable:this.props.draggable,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,onDragEnter:this.props.onDragEnter,onDragOver:this.props.onDragOver,onDragLeave:this.props.onDragLeave,onDrop:this.props.onDrop}),onContextMenu:this.onContextMenu,style:{"--SearchFieldWidth":this.getWidth()},children:[!this._isOnSpeedDial&&"button"!==this.props.prefValues[D.kAddressBarSearchDisplay]&&Xf(gu,{className:"SearchField-SlideBar",onSlidebarPosition:this.onSlidebarPosition,offset:2,position:"left"}),Xf(Tf,{onItemClicked:this.onSearchEngineChanged,items:this.state.searchEngineSelectItems,isOpen:this.state.isSearchEngineSelectOpen,onClose:this.closeSearchEngineSelect,toggleOpen:this.toggleSearchEngineSelectOpen,icon:this.state.currentSearchEngine?this.state.currentSearchEngine.faviconUrl:"",useFavicon:this.props.prefValues[D.kAddressBarSearchShowFavicon]}),(0,fn.jsx)("input",{ref:e=>this._refSearch=e,className:"vivaldi-searchfield searchfield-input",onBlur:this.onBlur,onChange:this.onChange,autoFocus:!this._isOnSpeedDial&&"button"===this.props.prefValues[D.kAddressBarSearchDisplay],onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onDoubleClick:this.onDoubleClick,onDragEnter:this.onDragEnter,onDragStart:this.onDragStart,onDragOver:this.onDragOver,onDragLeave:this.onDragLeave,onDrop:this.onDropped,onFocus:this.onFocus,onKeyDown:this.onKeyDowned,onKeyPress:this.onKeyPressed,onCompositionStart:this._onCompositionStart,onCompositionUpdate:this._onCompositionStart,onCompositionEnd:this._onCompositionEnd,onPaste:this.onPaste,placeholder:t,tabIndex:this._isOnSpeedDial?0:null,type:"search",value:this.state.editText}),this.state.isOmniDropdownOpen&&this.renderDropdown(),i&&Xf(Jf,{onClick:this.onExecuteSearchButtonClick,tabIndex:this.props.prefValues[D.kKeyboardTabToAll]}),s&&Xf(qf,{disabled:n,tabIndex:this.props.prefValues[D.kKeyboardTabToAll],onMouseDown:this.onToggleDropdownClicked,onClick:this.onToggleDropdownClicked})]}),this.shouldShowTrackerMessage()&&o.length>0&&Xf("div",{className:"tracker-warning"},void 0,Xf("button",{className:"close",onClick:()=>{nt.Z.set(D.kStartpageSpeedDialTrackerSuggestionShow,!1)},dangerouslySetInnerHTML:{__html:cn.kze}}),Xf("p",{},void 0,(0,le.Z)("Using Google? If you value your privacy, give one of our partners below a shot.")),Xf("div",{className:"engine-suggestion-container"},void 0,this.renderEngineSuggestionDropdown(o),Xf("input",{type:"button",value:(0,le.Z)("browser","Set as Default"),onClick:()=>{d.Z.searchEngines.setDefault("defaultSearch",this.state.engineSuggestionSelected);const e=Nn.Z.getById(this.state.engineSuggestionSelected);e&&this._updateCurrentEngine(e),nt.Z.set(D.kStartpageSpeedDialTrackerSuggestionShow,!1)}})))]})}render(){if("button"===this.props.prefValues[D.kAddressBarSearchDisplay]&&!this._isOnSpeedDial){const{size:e="large"}=this.props;return Xf(sl,{image:cn.YvR[e],tooltip:(0,le.Z)("Show Search Field"),onClick:this.toggleHiddenSearchFieldPopup,customizeMenu:this.props.customizeMenu,menuOrigin:this.props.menuOrigin,popupPosition:this.props.popupPosition,draggable:this.props.draggable,onDragStart:this.props.onDragStart??Tl.default,onDragEnd:this.props.onDragEnd??Tl.default,onDragEnter:this.props.onDragEnter,onDragOver:this.props.onDragOver,onDragLeave:this.props.onDragLeave,onDrop:this.props.onDrop??Tl.default,hidePopup:this.hideSearchField,isPopupVisible:this.state.showPopup,popupWidth:210,hasLightArrow:!0,size:e,popupClassName:"SearchField-Popup",mimeType:this.props.mimeType,name:this.props.name},void 0,this.renderSearchField())}return this.renderSearchField()}}const iy=(0,fs.Z)(Br(ny),Qf);var sy;function oy(e,t,n,i){sy||(sy="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:sy,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class ay extends tn.Component{static contextType=dn.Z;state={taskInfo:this.props.taskInfo};onContextMenu=e=>{const{taskInfo:t}=this.props;(0,zi.Z)(this.context.vivaldiWindowId,t.menuItems)};render(){const{taskInfo:e}=this.props;return oy("p",{className:"button-toolbar-small in-progress",id:e.id,title:e.title+"\n"+e.description,onContextMenu:this.onContextMenu},void 0,this.state.taskInfo.text)}}const ry=ay;class ly extends Us.Z{_tasks=(0,fa.aV)();getBackgroundTasks(){return this._tasks}dispatchAction(e){if("BACKGROUND_TASKS_SET"===e.actionType)this._tasks=(0,fa.aV)(e.tasks),this.emitChange()}}const dy=new ly(l.Z);var cy;function hy(e,t,n,i){cy||(cy="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:cy,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class py extends tn.PureComponent{state={backgroundTasks:dy.getBackgroundTasks()};componentDidMount(){dy.addListener(this.onBackgroundTaskStoreChange)}componentWillUnmount(){dy.removeListener(this.onBackgroundTaskStoreChange)}onBackgroundTaskStoreChange=()=>{this.setState({backgroundTasks:dy.getBackgroundTasks()})};render(){return(0,fn.jsx)(fn.Fragment,{children:this.state.backgroundTasks.map((e=>hy(ry,{taskInfo:e},e.id)))})}}const uy=py;class gy extends Z.Z{getInitialState(){return{entries:new Map}}getEntry(e){return this.getState().entries.get(e)??{status:"",persistentStatuses:new Map}}reduce(e,t){switch(t.actionType){case"STATUS_SET_STATUS":return(0,E.ZP)(e,(e=>{const n=e.entries.get(t.windowId);n?(n.status=t.status,e.entries.set(t.windowId,n)):e.entries.set(t.windowId,{status:t.status,persistentStatuses:new Map})}));case"STATUS_SET_PERSISTENT_STATUS":return(0,E.ZP)(e,(e=>{const n=e.entries.get(t.windowId);if(n)n.persistentStatuses.set(t.key,t.status),e.entries.set(t.windowId,n);else{const n=new Map([[t.key,t.status]]);e.entries.set(t.windowId,{status:"",persistentStatuses:n})}}));case"STATUS_CLEAR_PERSISTENT_STATUS":return(0,E.ZP)(e,(e=>{const n=e.entries.get(t.windowId);n&&(n.persistentStatuses.delete(t.key),e.entries.set(t.windowId,n))}));case"CHROME_TABS_ACTIVATED":return(0,E.ZP)(e,(e=>{const n=e.entries.get(t.activeInfo.windowId);n&&(n.status="",e.entries.set(t.activeInfo.windowId,n))}))}return e}}const my=new gy;var vy;function fy(e,t,n,i){vy||(vy="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:vy,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var yy=fy(uy,{});class wy extends tn.PureComponent{static contextType=dn.Z;state={status:my.getEntry(this.context.vivaldiWindowId).status,visible:!1};componentDidMount(){my.addListener(this.onStoreChange),this._persistentStatusIndex=0}componentWillUnmount(){clearTimeout(this._statusTimeout),clearInterval(this._persistentStatusInterval),my.removeListener(this.onStoreChange)}onStoreChange=()=>{clearTimeout(this._statusTimeout),clearInterval(this._persistentStatusInterval);const{status:e,persistentStatuses:t}=my.getEntry(this.context.vivaldiWindowId);e?this.setState({status:e,visible:!0}):1===t.size?this.setState({status:[...t.values()][0],visible:!0}):t.size>1?this._persistentStatusInterval=setInterval((()=>{this._persistentStatusIndex=this._persistentStatusIndex%t.size;const e=[...t.values()][this._persistentStatusIndex++];this.setState({status:e,visible:!0})}),2e3):this._statusTimeout=setTimeout((()=>this.setState({visible:!1})),200)};render(){const e=this.props.customizeMenu;return(0,fn.jsxs)(fn.Fragment,{children:[(0,fn.jsx)("p",{style:this.props.style,className:mn()({StatusInfo:!0,"button-toolbar":this.props.preview,"StatusInfo--Visible":this.state.visible||this.props.preview}),...Or({draggable:this.props.draggable,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,onDragEnter:this.props.onDragEnter,onDragOver:this.props.onDragOver,onDragLeave:this.props.onDragLeave,onDrop:this.props.onDrop}),onContextMenu:e?t=>(0,zi.Z)(this.context.vivaldiWindowId,e)(t):null,children:this.props.preview?fy("button",{className:"ToolbarButton-Button"},void 0,fy("span",{dangerouslySetInnerHTML:{__html:cn.MSA[this.props.size||"medium"]+(0,le.Z)("Status")}})):fy("span",{className:"StatusInfo-Content"},void 0,this.state.status)}),yy]})}}const by=Br(wy);class Cy extends Z.Z{getInitialState(){return{engineData:{engineState:"stopped",disableReasons:[],protocolErrorType:"success",protocolErrorDescription:"",protocolErrorClientAction:"unknown",usesEncryptionPassword:!1,needsDecryptionPassword:!1,isEncryptingEverything:!1,isSetupInProgress:!1,isFirstSetupComplete:!1,syncEverything:!0,dataTypes:[],isReady:!1},cycleData:{cycleStartTime:0,downloadUpdatesStatus:"not_synced",commitStatus:"not_synced",nextRetryTime:0,isReady:!1}}}reduce(e,t){switch(t.actionType){case"SYNC_ENGINE_STATE_CHANGED":return{engineData:t.engineData,cycleData:e.cycleData};case"SYNC_CYCLE_COMPLETED":return{engineData:e.engineData,cycleData:t.cycleData}}return e}}const Sy=new Cy,Ty="▽",Iy="▼",ky="△",Ay="▲",Zy="⭍",Ey={not_synced:(0,le.Z)("Not synced"),success:(0,le.Z)("process","Done"),in_progress:(0,le.Z)("In progress..."),auth_error:(0,le.Z)("Sync server refused your credentials"),server_error:(0,le.Z)("Sync server encountered an error"),network_error:(0,le.Z)("Network error"),client_error:(0,le.Z)("Client error"),conflict:(0,le.Z)("Conflict with another client’s data occurred"),throttled:(0,le.Z)("Sync server throttled the connection"),other_error:(0,le.Z)("Unexpected error")};function _y(e,t){return function(e,t){switch(e){case"not_synced":case"in_progress":return t?Ty:ky;case"success":return t?Iy:Ay;default:return Zy}}(e,t)+" "+(t?(0,le.Z)("Download: $1",[Ey[e]]):(0,le.Z)("Upload: $1",[Ey[e]]))}function Ny(e){return[Ey[e.downloadUpdatesStatus],Ey[e.commitStatus]]}var My;function Py(e,t,n,i){My||(My="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:My,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Dy extends tn.Component{static contextType=dn.Z;state={statusText:(0,le.Z)("Sync"),statusOverlay:"none",active:!1};componentDidMount(){Sy.addListener(this.onStoreChange),Td.addListener(this.onStoreChange),this.onStoreChange()}componentWillUnmount(){Sy.removeListener(this.onStoreChange),Td.removeListener(this.onStoreChange)}onStoreChange=()=>{const e=Cd(Td.getState()),t=Td.getState().accountInfo.username,n=Sy.getState().engineData,i=Sy.getState().cycleData,s=n.isFirstSetupComplete&&"stopped"!==n.engineState;let o="none";"loggedOut"!==e&&(n.isFirstSetupComplete&&("credentialsMissing"===e||"loginFailed"===e||n.needsDecryptionPassword)||"failed"===n.engineState&&!n.disableReasons.includes("not_signed_in")||"disable_sync_on_client"===n.protocolErrorClientAction?o="failed":["started","stopped"].includes(n.engineState)&&0===parseInt(i.nextRetryTime)||(o="waiting"));let a=(0,le.Z)("Sync");if("loggedOut"===e)a=(0,le.Z)("Sync not connected");else if("failed"===o)a=(0,le.Z)("Failed to start Sync for “$1”",[t]);else if("clearing_data"===n.engineState)a=(0,le.Z)("Clearing Sync server data for “$1”",[t]);else if("configuration_pending"===n.engineState)a=(0,le.Z)("Setting up Sync for “$1”",[t]);else if("started"===n.engineState){if(a=(0,le.Z)("Connected to Sync as “$1”",[t]),"not_synced"!==i.downloadUpdatesStatus){const[e,t]=function(e){return[_y(e.downloadUpdatesStatus,!0),_y(e.commitStatus,!1)]}(i);a+="\n"+(0,le.Z)("Last sync: $1",[b()(i.cycleStartTime).calendar()])+"\n"+e+"\n"+t}}else a=(0,le.Z)("Connecting to Sync as “$1”...",[t]);this.setState({active:s,statusOverlay:o,statusText:a})};openSyncSettings=()=>{ie.Z.showSettings(this.context.vivaldiWindowId,"sync")};getImageForStatus=e=>{let t=cn.UTS;return"failed"===this.state.statusOverlay?t=cn.bBo:"waiting"===this.state.statusOverlay?t=cn.rvX:this.state.active&&(t=cn.ssx),t};render(){return Py(sl,{onClick:this.openSyncSettings,image:this.getImageForStatus(status)[this.props.size],tooltip:this.state.statusText,customizeMenu:this.props.customizeMenu,menuOrigin:this.props.menuOrigin,draggable:this.props.draggable,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,onDrop:this.props.onDrop,onDragEnter:this.props.onDragEnter,mimeType:this.props.mimeType,name:this.props.name})}}const xy=Dy;var Oy;function Ly(e,t,n,i){Oy||(Oy="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Oy,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ry=[{title:(0,le.Z)("Always"),profile:"always"},{title:(0,le.Z)("Cached"),profile:"cache"},{title:(0,le.Z)("title","Never"),profile:"never"}],By=[{title:(0,le.Z)("command","Loop"),profile:"allowed"},{title:(0,le.Z)("Once"),profile:"once"},{title:(0,le.Z)("command","Never"),profile:"none"}];class Fy extends tn.PureComponent{static contextType=dn.Z;_isMounted=!1;state={imageProfile:"always",animationProfile:"allowed",drawerOpen:!1};componentDidMount(){this._isMounted=!0,W.Z.addListener(this._onPageStoreChanged),y.Z.accessibilityFeatures.animationPolicy.onChange.addListener(this._onAnimationPolicyChanged),this._onAnimationPolicyChanged()}componentWillUnmount(){this._isMounted=!1,W.Z.removeListener(this._onPageStoreChanged),y.Z.accessibilityFeatures.animationPolicy.onChange.removeListener(this._onAnimationPolicyChanged)}_onPageStoreChanged=()=>{this._isMounted&&this.setState({imageProfile:W.Z.unsafeGetActivePage(this.context.vivaldiWindowId).imageLoading})};_onAnimationPolicyChanged=()=>{y.Z.accessibilityFeatures.animationPolicy.get({},(({value:e})=>{this._isMounted&&this.setState({animationProfile:e})}))};onImageProfileSelected=e=>{switch(e){case"never":this.updatePageImageState(!1,!1,!1);break;case"cache":this.updatePageImageState(!0,!0,!0);break;case"always":this.updatePageImageState(!0,!1,!0)}};onAnimationsProfileSelected=e=>{this.setState({animationProfile:e},(()=>{y.Z.accessibilityFeatures.animationPolicy.set({value:e},(()=>{}))}))};updatePageImageState=(e,t,n)=>{const i=W.Z.getActivePage(this.context.vivaldiWindowId);i&&d.Z.tabsPrivate.update(i.id,{showImages:e,loadFromCacheOnly:t,enablePlugins:n})};hidePopup=()=>{this.state.drawerOpen&&this.setState({drawerOpen:!1})};togglePopup=()=>{this.setState((e=>({drawerOpen:!e.drawerOpen})))};render(){const e=this.state.imageProfile,t=this.state.animationProfile,n=this.props.disabled;return Ly(sl,{buttonStyle:{"--displayImagesAll":"always"===e?"block":"none","--displayImagesCached":"cache"!==e||n?"none":"block","--displayImagesNever":"never"!==e||n?"none":"block","--displayAnimationOnce":"once"===t?"block":"none","--displayAnimationNever":"none"===t?"block":"none"},tooltip:(0,le.Z)("Toggle images and animation"),onClick:this.togglePopup,disabled:this.props.disabled,image:cn.myO[this.props.size],size:this.props.size,customizeMenu:this.props.customizeMenu,menuOrigin:this.props.menuOrigin,hidePopup:this.hidePopup,popupPosition:this.props.popupPosition,isPopupVisible:this.state.drawerOpen,draggable:this.props.draggable,onDragStart:this.props.onDragStart,hasLightArrow:"above"===this.props.popupPosition,onDragEnd:this.props.onDragEnd,onDrop:this.props.onDrop,onDragEnter:this.props.onDragEnter,mimeType:this.props.mimeType,popupClassName:"ToolbarButtonPopup-DefaultStyles",name:this.props.name},void 0,Ly("form",{},void 0,Ly("h2",{},void 0,(0,le.Z)("title","Load Images")),Ly("div",{className:"ToggleImages-Selection"},void 0,Ry.map((({title:t,profile:n},i)=>Ly("label",{},"imagePolicy-"+n,Ly("input",{autoFocus:e===n,type:"radio",name:"toggle-image-group",checked:e===n,onChange:this.onImageProfileSelected.bind(this,n)}),t)))),Ly("h2",{},void 0,(0,le.Z)("Play Image Animation")),Ly("div",{className:"ToggleImages-Selection"},void 0,By.map((({title:e,profile:n})=>Ly("label",{},"animationPolicy-"+n,Ly("input",{type:"radio",name:"toggle-animations-group",checked:t===n,onChange:this.onAnimationsProfileSelected.bind(this,n)}),e))))))}}const Uy=Fy;var Vy;function Wy(e,t,n,i){Vy||(Vy="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Vy,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Hy=function(e){const t=W.Z.unsafeGetActivePage(e),n=(0,uv.jA)(t);return{groupId:t.vivExtData.group??"",tileId:n&&W.Z.getTiles(n,e).count()>1?n:"",tileMode:t.vivExtData.tiling?.layout,disabled:1===W.Z.getPages(e).count()}};class zy extends tn.PureComponent{static contextType=dn.Z;_isMounted=!1;constructor(e,t){super(e),this.state={drawerOpen:!1,...Hy(t.vivaldiWindowId)}}componentDidMount(){this._isMounted=!0,W.Z.addListener(this._onPageStoreChange)}componentDidUpdate(e){this._isMounted&&e.pageId!==this.props.pageId&&this.hidePopup()}componentWillUnmount(){this._isMounted=!1,W.Z.removeListener(this._onPageStoreChange)}_onPageStoreChange=()=>{this._isMounted&&this.setState(Hy(this.context.vivaldiWindowId))};togglePopup=()=>{this.setState((e=>({drawerOpen:!e.drawerOpen})))};hidePopup=()=>{this.state.drawerOpen&&this.setState({drawerOpen:!1})};setTiling=e=>{if(e.hasOwnProperty("button")&&e.button!==vn.Z.kLeft)return;const t=this.context.vivaldiWindowId,n=e.currentTarget.value,i=W.Z.getSelection(t);if(i.count()>1){const e=i.map((e=>W.Z.getPageById(e))).filter(Boolean).toList();Y.Z.tilePages(e,n),Y.Z.clearSelection(t)}else if(this.state.tileId){const e=W.Z.getTiles(this.state.tileId,t);Y.Z.tilePages(e,n)}else W.Z.isGroup(this.state.groupId,t)?Y.Z.tileTabStack(this.state.groupId,this.context.vivaldiWindowId,n):Y.Z.tileLastActive(n,t);this.hidePopup()};untile=()=>{Y.Z.untileTileGroup(this.state.tileId,this.context.vivaldiWindowId),this.hidePopup()};keyDownHandler=e=>{const t=e.currentTarget,n=t.parentElement?.querySelectorAll(".PageTiling-Button:not([disabled])");if(n?.length)switch(e.key){case"ArrowUp":let e=[].indexOf.call(n,t)-1;e<0&&(e=n.length-1),n[e].focus();break;case"ArrowDown":let i=[].indexOf.call(n,t)+1;i>=n.length&&(i=0),n[i].focus();break;default:return}};render(){return Wy(sl,{customizeMenu:this.props.customizeMenu,tooltip:(0,le.Z)("Page tiling")+"\n"+(0,le.Z)("Tile the current tab selection, tab stack, or last active tab"),buttonStyle:{"--displayTileColumn":!this.state.tileId||"column"!==this.state.tileMode&&"grid"!==this.state.tileMode?"none":"unset","--displayTileRow":!this.state.tileId||"row"!==this.state.tileMode&&"grid"!==this.state.tileMode?"none":"unset"},className:`tilingtoggle ${this.props.size}`,disabled:this.state.disabled,image:cn.Dx_[this.props.size],size:this.props.size,onClick:this.togglePopup,onPointerDown:this.togglePopup,isPopupVisible:this.state.drawerOpen,hidePopup:this.hidePopup,popupPosition:this.props.popupPosition,menuOrigin:this.props.menuOrigin,draggable:this.props.draggable,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,hasLightArrow:!0,onDrop:this.props.onDrop,onDragEnter:this.props.onDragEnter,mimeType:this.props.mimeType,popupClassName:`ToolbarButtonPopup-DefaultStyles ${this.props.size}`,name:this.props.name},void 0,Wy("h2",{},void 0,(0,le.Z)("Page Tiling")),Wy("button",{className:mn()("PageTiling-Button",{"button-on":"row"===this.state.tileMode}),title:(0,le.Z)("Tile vertically"),onKeyDown:this.keyDownHandler,onClick:this.setTiling,onMouseUp:this.setTiling,value:"row",dangerouslySetInnerHTML:{__html:cn.Dx_[this.props.size]+(0,le.Z)("Tile Vertically")},style:{"--displayTileColumn":"none","--displayTileRow":"unset"}}),Wy("button",{className:mn()("PageTiling-Button",{"button-on":"column"===this.state.tileMode}),title:(0,le.Z)("Tile horizontally"),onKeyDown:this.keyDownHandler,onClick:this.setTiling,onMouseUp:this.setTiling,value:"column",dangerouslySetInnerHTML:{__html:cn.Dx_[this.props.size]+(0,le.Z)("Tile Horizontally")},style:{"--displayTileColumn":"unset","--displayTileRow":"none"}}),Wy("button",{className:mn()("PageTiling-Button",{"button-on":"grid"===this.state.tileMode}),title:(0,le.Z)("Tile to grid"),onKeyDown:this.keyDownHandler,onClick:this.setTiling,onMouseUp:this.setTiling,value:"grid",dangerouslySetInnerHTML:{__html:cn.Dx_[this.props.size]+(0,le.Z)("Tile to Grid")},style:{"--displayTileColumn":"unset","--displayTileRow":"unset"}}),Wy("button",{className:"PageTiling-Button",title:(0,le.Z)("Untile pages"),disabled:!this.state.tileMode,onKeyDown:this.keyDownHandler,onClick:this.untile,onMouseUp:this.untile,value:"none",dangerouslySetInnerHTML:{__html:cn.Dx_[this.props.size]+(0,le.Z)("Untile Pages")},style:{"--displayTileColumn":"none","--displayTileRow":"none"}}))}}const Gy=zy;var $y,Ky=n(8074);function jy(e,t,n,i){$y||($y="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:$y,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Yy extends tn.PureComponent{static contextType=dn.Z;nodeRef=tn.createRef();getNode(){return this.nodeRef.current}handleClickOutside=e=>{this.props.onPopupClosed(e)};loadBlockedContent=()=>{const e=qt.Z.getActiveWebView(this.context.vivaldiWindowId);e&&e.allowBlockedInsecureContent(),Ky.Z.resetPageHasBlockedContent(this.props.pageId)};allowCookiesContent=()=>{const e=new URL(this.props.url).origin;d.Z.utilities.setContentSettings({type:"cookies",primaryPattern:e+"/*",secondaryPattern:"",value:"allow",incognito:!1}),Ky.Z.resetPageHasBlockedContent(this.props.pageId)};openManageCookies=()=>{ie.Z.showSettings(this.context.vivaldiWindowId,"privacy")};render(){return(0,fn.jsxs)("div",{ref:this.nodeRef,tabIndex:"0",className:"addressfield-popup",children:[jy("header",{className:"addressfield-popup-header blocked-content"},void 0,jy("span",{dangerouslySetInnerHTML:{__html:cn.W4h.small}}),jy("h1",{},void 0,(0,le.Z)("Blocked Content"))),jy("div",{className:"addressfield-popup-content blocked-content"},void 0,(()=>{let e=(0,fa.D5)();this.props.blockedPageContent.map((t=>{let n=e.get(t);e=n?e.set(t,++n):e.set(t,1)}));const t=[];for(const[n,i]of e)switch(n){case"ads":t.push(jy("div",{className:"blocked-section"},n,(0,le.Z)("Advertisements on this page are flagged as abusive and blocked.")));break;case"cookies":t.push(jy("div",{className:"blocked-section"},n,(0,le.Z)("$1 cookie is blocked","$1 cookies are blocked",[i]),jy("div",{className:"clickable",onClick:this.allowCookiesContent},void 0,(0,le.Z)("Allow cookies for this site"))));break;case"mixed-script":t.push(jy("div",{className:"blocked-section"},n,(0,le.Z)("$1 unsafe resource is blocked","$1 unsafe resources are blocked",[i]),jy("div",{className:"clickable",onClick:this.loadBlockedContent},void 0,(0,le.Z)("Load the unsafe resource","Load the unsafe resources",[i]))));break;default:console.warn("Unhandled blocked content $1",n)}return t})()),jy("footer",{className:"dialog-footer"},void 0,this.props.blockedPageContent.contains("cookies")&&jy("input",{type:"button",onClick:this.openManageCookies,value:(0,le.Z)("Manage Cookies")}),jy("input",{type:"button",onClick:this.props.onPopupClosed,value:(0,le.Z)("Close")}))]})}}const Xy=(0,Vr.Z)(Yy);var Qy;function qy(e,t,n,i){Qy||(Qy="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Qy,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Jy extends tn.Component{state={popupVisible:!1};onTogglePopupOpen=e=>{e.preventDefault(),this.setState((e=>({popupVisible:!e.popupVisible})))};onClosePopup=()=>{this.setState({popupVisible:!1})};render(){return qy("div",{className:"button-toolbar"},void 0,qy(sl,{image:cn.W4h.small,tooltip:(0,le.Z)("Content has been blocked."),onClick:this.onTogglePopupOpen,popupPosition:this.props.position,className:"button-addressfield permission-popup is-blocking",hidePopup:this.onClosePopup,isPopupVisible:this.state.popupVisible,popupClassName:"addressfield-popup-container",popupWidth:240},void 0,qy(Xy,{pageId:this.props.pageId,url:this.props.url,onPopupClosed:this.onClosePopup,blockedPageContent:this.props.blockedPageContent})))}}const ew=Jy;var tw;function nw(e,t,n,i){tw||(tw="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:tw,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function iw({onExpandClick:e,inManager:t,fullView:n,node:i,inlineEditText:s,onChange:o,onBlur:a,onFocus:r,showBadge:l,onMouseEnter:d,onMouseLeave:c}){const h=(i.level+1)*$u+"px",p=i.level*$u+"px",u=Boolean(i.children),g=Boolean(u&&i.children.length),{favIconUrl:m,favIconLoadType:v}=St.jk.getBookmarkFavicon(i.url,i.faviconUrl);return nw("label",{"data-parent":i.parentId,onMouseEnter:d,onMouseLeave:c},"0",u&&g&&nw("span",{className:"expand-icon",style:{marginLeft:p},onMouseUp:()=>e(i.id),onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},dangerouslySetInnerHTML:{__html:cn.nfH}}),u&&i.trash&&nw(Wi,{speeddial:i.speeddial,open:i.isExpanded,trash:!0,leftMargin:g?0:h}),u&&!i.trash&&nw(Wi,{speeddial:i.speeddial,open:i.isExpanded,trash:!1,leftMargin:g?0:h}),!u&&nw(Oi,{url:m,loadType:v,style:{marginLeft:h},className:"tree-row-image bookmark-icon"}),void 0!==s&&nw("input",{type:"text",value:s,onChange:o,onFocus:r,onBlur:a,autoFocus:!0}),void 0===s&&nw("span",{className:"title"},void 0,i.title?i.title:en.ZP.isBookmark(i)&&!t?i.url:""),l&&g&&!n&&nw("span",{className:"item-count"},void 0,i.children.filter((e=>!en.ZP.isSeparator(e))).length))}var sw,ow=n(34155);function aw(e,t,n,i){sw||(sw="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:sw,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function rw({node:e,inlineEditText:t,onFocus:n,onChange:i,onBlur:s,onExpandClick:o}){return aw(iw,{node:e,inlineEditText:t,inManager:!1,fullView:!1,showBadge:!1,onExpandClick:o,onFocus:n,onChange:i,onBlur:s},e.id)}const lw=en.ZP.getRootId();class dw extends tn.PureComponent{refTreeList=tn.createRef();componentDidMount(){this.setFolderTreeView()}componentDidUpdate(e){const t=this.refTreeList.current?.getSelected();e.selectedId===this.props.selectedId||t===this.props.selectedId||this.props.isEditing||this.setFolderTreeView()}async setFolderTreeView(){const{selectedId:e}=this.props,t=this.refTreeList.current?.getSelected();t!==e&&this.setSelectedId(e),this.props.expandAll?this.refTreeList.current?.expandAll():(this.refTreeList.current?.collapseAll(),await new Promise((e=>ow.nextTick(e))),e&&e!==lw?this.refTreeList.current?.expandToId(e):this.refTreeList.current?.expand(lw)),await new Promise((e=>ow.nextTick(e)));e&&"1"!==e&&this.refTreeList.current?.scrollToId(e)}setSelectedId=e=>{this.refTreeList.current?.setSelectedIds([e])};scrollToId=e=>{this.refTreeList.current?.scrollToId(e)};expand=e=>{this.refTreeList.current?.expand(e)};expandAll=()=>{this.refTreeList.current?.expandAll()};toggleSelectedExpansion=e=>{this.refTreeList.current?.toggleSelectedExpansion(e)};startInlineEdit=e=>{this.setSelectedId(e),this.scrollToId(e),this.focus(),this.refTreeList.current?.startInlineEdit(e)};focus=()=>{this.refTreeList.current?.focusTree()};render(){const{folders:e,onSelect:t}=this.props;return(0,fn.jsx)(Yu,{ref:this.refTreeList,className:mn()(this.props.className,"vivaldi-tree"),nodes:e,hasChildren:e=>e.children?.length,isFolder:e=>Boolean(e.children?.length&&!e.url),onSelect:e=>e&&t(e.id),rowComponent:e=>(0,fn.jsx)(rw,{...e,onExpandClick:e=>this.toggleSelectedExpansion(e)}),saveTitle:this.props.onFolderTitleChange,isValidToEdit:()=>!0,getTitle:()=>this.props.defaultEditFolderText,enableDragAndDrop:!1})}}var cw,hw=n(34155);function pw(e,t,n,i){cw||(cw="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:cw,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function uw(e){return e.children?e.children.reduce(((e,t)=>{if(t.speeddial)return e.push(t),e;if(t.children?.length){const n=uw(t);(n?.length||t.speeddial)&&e.push({...t,children:n})}return e}),[]):[]}var gw=pw(mp,{type:"search",size:18,className:"BookmarkLocationSelector-SearchInput-Icon"}),mw=pw(Wi,{});function vw({onValueChange:e,value:t,placeholder:n,onAddClick:i}){return pw("div",{className:"BookmarkLocationSelector-SearchInput"},void 0,pw("input",{placeholder:n,className:"BookmarkLocationSelector-SearchInput-Input",type:"search",value:t,onChange:({currentTarget:t})=>e(t.value)}),gw,pw("button",{type:"button",className:"BookmarkLocationSelector-SearchInput-Button",onClick:i,title:t?(0,le.Z)("Create “$1” Folder",[t]):(0,le.Z)("command","New Folder")},void 0,mw))}const fw=Object.freeze({folders:!0,bookmarks:!1});var yw,ww,bw=pw(Wi,{speeddial:!1,open:!1}),Cw=pw(Wi,{speeddial:!0,open:!1});class Sw extends tn.PureComponent{refFolderList=tn.createRef();state={nodes:en.ZP.getFilteredTree("",{...fw,root:"bookmarks"===this.props.mode}).nodes,filter:"",isEditing:!1};componentDidMount(){en.ZP.addListener(this.handleBookmarkStoreChange)}componentWillUnmount(){en.ZP.removeListener(this.handleBookmarkStoreChange)}handleBookmarkStoreChange=()=>{const e=[...en.ZP.getFilteredTree("",{...fw,root:"bookmarks"===this.props.mode}).nodes];this.setState({nodes:e})};handleNewFolderButtonClick=async()=>{this.setState({isEditing:!0});const e=this.state.filter||(0,le.Z)("command","New Folder"),t=this.state.filter?"1":this.props.parentId,n="speeddial"===this.props.mode&&t===en.q3,i=await y.Z.bookmarks.create({parentId:t,title:e,speeddial:n});this.refFolderList.current?.expand(t),await this.props.onParentIdChange(i.id),this.refFolderList.current?.startInlineEdit(i.id),this.setState({filter:""})};setParentOnSelect=async e=>{await this.props.onParentIdChange(e)};scrollToId=async e=>{await new Promise((e=>hw.nextTick(e))),this.refFolderList.current?.scrollToId(e),await new Promise((e=>hw.nextTick(e)))};handleFolderTabChange=async e=>{await this.props.onModeChange(e),this.handleBookmarkStoreChange(),this.refFolderList.current?.focus()};handleFolderTitleChange=(e,t)=>{this.setState({isEditing:!1}),this.props.onFolderTitleChange(e,t)};handleFilterChange=e=>{const t=[...en.ZP.getFilteredTree(e,{...fw,root:"bookmarks"===this.props.mode}).nodes];this.setState({filter:e,nodes:t},(()=>this.refFolderList.current?.expandAll()))};render(){const{className:e}=this.props,t=this.state.nodes,n="speeddial"===this.props.mode?uw({children:t}):t;return pw("div",{className:mn()("BookmarkLocationSelector",e)},void 0,pw("div",{className:"BookmarkLocationSelector-Header"},void 0,pw("button",{type:"button",className:mn()("BookmarkLocationSelector-ToggleButtonGroup-Button",{"BookmarkLocationSelector-ToggleButtonGroup-Button--Pressed":"bookmarks"===this.props.mode}),onClick:()=>this.handleFolderTabChange("bookmarks")},void 0,bw,(0,le.Z)("Bookmarks")),pw("button",{type:"button",className:mn()("BookmarkLocationSelector-ToggleButtonGroup-Button",{"BookmarkLocationSelector-ToggleButtonGroup-Button--Pressed":"speeddial"===this.props.mode}),onClick:()=>this.handleFolderTabChange("speeddial")},void 0,Cw,(0,le.Z)("Speed Dials"))),pw(vw,{value:this.state.filter,onValueChange:this.handleFilterChange,placeholder:"speeddial"===this.props.mode?(0,le.Z)("Find in Speed Dial Folders"):(0,le.Z)("Find in All Folders"),onAddClick:this.handleNewFolderButtonClick}),(0,fn.jsx)(dw,{ref:this.refFolderList,folders:n,onSelect:this.setParentOnSelect,selectedId:this.props.parentId,isEditing:this.state.isEditing,expandAll:!0,onFolderTitleChange:this.handleFolderTitleChange,className:"BookmarkLocationSelector-FolderList",defaultEditFolderText:this.state.filter||(0,le.Z)("command","New Folder")},this.props.mode))}}function Tw(e,t,n,i){yw||(yw="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:yw,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Iw({children:e,className:t,height:n}){return Tw("footer",{style:{"--Height":n||48},className:mn()("DialogFooter",t)},void 0,e)}function kw(e){const{children:t,className:n,height:i}=e;return Tw("div",{style:{"--Height":i||48},className:mn()("DialogContent",n)},void 0,t)}function Aw(e,t,n,i){ww||(ww="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:ww,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Zw({value:e,title:t,onChange:n,autoFocus:i}){return Aw("label",{className:"BookmarkInputField"},void 0,Aw("span",{className:"BookmarkInputField-Title"},void 0,t),Aw("input",{className:"BookmarkInputField-Input",type:"text",value:e,onChange:n,autoFocus:i}))}class Ew extends tn.PureComponent{refLocationSelector=tn.createRef();scrollToId=async e=>{await(this.refLocationSelector.current?.scrollToId(e))};render(){const{title:e,onTitleChange:t,autoFocus:n,url:i,onUrlChange:s,nickname:o,onNicknameChange:a,description:r,onDescriptionChange:l,onParentIdChange:d,parentId:c,onFolderTitleChange:h,locationSelectMode:p,onDeleteBookmarkClick:u,onClosePopupClick:g,onLocationSelectModeChange:m}=this.props,v=(f=c,en.ZP.getItemById(f)?.title);var f;return Aw("form",{className:"BookmarkPopup",onSubmit:g},void 0,Aw("header",{className:"DialogHeader BookmarkPopup-Header"},void 0,Aw("h1",{className:"DialogHeader-HeaderText"},void 0,(0,le.Z)("Added Bookmark")),v&&Aw("p",{},void 0,(0,le.Z)("to $1",[v]))),Aw(kw,{className:"BookmarkPopup-Content"},void 0,Aw("div",{className:"BookmarkPopup-TextInputWrapper"},void 0,Aw(Zw,{title:(0,le.Z)("bookmarkeditor","Name"),value:e,onChange:({currentTarget:e})=>{t(e.value)},autoFocus:"title"===n}),Aw(Zw,{title:(0,le.Z)("URL"),value:i,onChange:({currentTarget:e})=>s(e.value),autoFocus:"url"===n}),Aw(Zw,{title:(0,le.Z)("Nickname"),value:o,onChange:({currentTarget:e})=>a(e.value),autoFocus:"nickname"===n}),Aw(Zw,{title:(0,le.Z)("Description"),value:r,onChange:({currentTarget:e})=>l(e.value),autoFocus:"description"===n})),(0,fn.jsx)(Sw,{ref:this.refLocationSelector,className:"BookmarkPopup-LocationSelector",onParentIdChange:d,parentId:c,onFolderTitleChange:h,mode:p,onModeChange:m})),Aw(Iw,{className:"BookmarkPopup-Footer"},void 0,Aw("input",{type:"submit",value:(0,le.Z)("bookmarkeditor","Done")}),Aw("input",{type:"button",className:"danger",onClick:u,value:(0,le.Z)("bookmarkeditor","Remove")})))}}function _w(e,t,n){return new Promise(((i,s)=>{y.Z.tabs.sendMessage(e,t,n,(e=>{y.Z.runtime.lastError?s(y.Z.runtime.lastError.message):i(e)}))}))}let Nw;async function Mw(e){const t=new Promise((e=>{Nw=e}));try{const t=await _w(e,{action:"fetchBookmarkMetadata"});if("bookmarkData"===t.type){const{title:e,url:n,description:i,image:s}=t.data;Nw?.({title:e,url:n,description:i,thumbnail:s})}}catch(e){return console.error(e),null}return t}var Pw;function Dw(e,t,n,i){Pw||(Pw="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Pw,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function xw(e,t){return y.Z.bookmarks.update(e,t)}function Ow(e){return M.Z.get(D.kBookmarksFetchPageMetadata)&&!(0,St.cw)(e)}function Lw(e){const t=e?.vivExtData.thumbnail??"";return{url:e?.url||"",title:e?(0,St.d6)(e.url,e.title):"",description:"",thumbnail:t}}class Rw extends tn.PureComponent{static contextType=dn.Z;state={status:"standby",isBookmarkPopupOpen:!1,title:this.props.bookmarkData?.title||"",url:this.props.bookmarkData?.url||"",description:this.props.bookmarkData?.description||"",thumbnail:this.props.bookmarkData?.thumbnail||"",nickname:this.props.bookmarkData?.nickname||"",parentId:this.props.bookmarkData?.parentId||"",popupLocationSelectMode:"bookmarks"};componentDidMount(){Hf.Z.addListener(this.onWebpageviewStoreChanged)}componentWillUnmount(){Hf.Z.removeListener(this.onWebpageviewStoreChanged)}onWebpageviewStoreChanged=async e=>{if(e.winId!==this.context.vivaldiWindowId||"WEBPAGEVIEW_ACTIONS"!==e.type||"addBookmark"!==e.action)return;const t=W.Z.getPageInWindow(e.winId,e.pageId);if(!t)return;if(en.ZP.findByUrl(t.url))return void this.setIsBookmarkPopupOpen(!0);const n=Ow(t.url)&&await Mw(t.id)||Lw(t);await this.bookmarkPage(n),M.Z.get(D.kBookmarksConfirmAdding)&&this.setIsBookmarkPopupOpen(!0)};componentDidUpdate(e,t){if(t.isBookmarkPopupOpen&&!this.state.isBookmarkPopupOpen&&this.props.bookmarkData){const{title:e,url:t,description:n,nickname:i}=this.state;xw(this.props.bookmarkData.id,{title:e,url:t,description:n,nickname:i})}else this.props.bookmarkData?e.bookmarkData||this.setState({title:this.props.bookmarkData.title,url:this.props.bookmarkData.url,description:this.props.bookmarkData.description,thumbnail:this.props.bookmarkData.thumbnail,nickname:this.props.bookmarkData.nickname,parentId:this.props.bookmarkData.parentId,status:"bookmarked"}):this.setState({title:"",url:"",description:"",thumbnail:"",nickname:"",parentId:""}),"bookmarked"===this.state.status&&setTimeout((()=>{this.setState({status:"standby"})}),4e3)}setIsBookmarkPopupOpen(e){this.setState({isBookmarkPopupOpen:e}),this.props.onBookmarkPopupVisibilityChange?.(e)}bookmarkPage=async e=>{let t=M.Z.get(D.kBookmarksSaveFolder);const n=en.ZP.getItemById(t);n&&!en.ZP.isTrashed(n)||(t=en.SZ);const i=await this.props.setBookmarked({...e,parentId:t});i.parentId&&this.refBookmarkPopup.current?.scrollToId(i.parentId)};onDeleteBookmarkClick=async()=>{this.setState({status:"standby"}),this.props.bookmarkData&&(await i.Z.remove([this.props.bookmarkData.id]),this.setIsBookmarkPopupOpen(!1))};onBookmarkButtonClicked=async()=>{if(this.setState((e=>({isBookmarkPopupOpen:!e.isBookmarkPopupOpen}))),this.props.onBookmarkPopupVisibilityChange&&this.props.onBookmarkPopupVisibilityChange(this.state.isBookmarkPopupOpen),!this.props.bookmarkData){const e=W.Z.getPageById(this.props.pageId);if(!e)return;const t=Ow(e.url)&&await Mw(this.props.pageId)||Lw(e);await this.bookmarkPage(t)}};handleParentIdChange=async e=>{this.props.bookmarkData&&(await i.Z.move([this.props.bookmarkData.id],e),nt.Z.set(D.kBookmarksSaveFolder,e),this.setState({parentId:e}))};handleTitleChange=e=>{this.setState({title:e})};handleUrlChange=e=>{this.setState({url:e})};handleNicknameChange=e=>{this.setState({nickname:e})};handleDescriptionChange=e=>{this.setState({description:e})};handleFolderTitleChange=(e,t)=>{xw(e,{title:t})};hidePopup=()=>{this.setIsBookmarkPopupOpen(!1)};onLocationSelectModeChange=e=>{this.setState({popupLocationSelectMode:e})};refBookmarkPopup=tn.createRef();render(){const{title:e,url:t,nickname:n,description:i,thumbnail:s,parentId:o}=this.state,a="bookmarked"===this.state.status||this.state.isBookmarkPopupOpen,r="bookmarked"===this.state.status||this.props.isBookmarkPopup?(0,le.Z)("Added bookmark"):"";return Dw("div",{className:mn()("BookmarkButton",{"BookmarkButton--Active":a})},void 0,Dw(sl,{onClick:this.onBookmarkButtonClicked,tooltip:(0,le.Z)("tooltip","Bookmark Page"),image:cn.oJy,hidePopup:this.hidePopup,popupPosition:this.props.popupPosition,isPopupVisible:this.state.isBookmarkPopupOpen,popupWidth:356,className:"BookmarkButton-Button",isOn:Boolean(this.props.bookmarkData),title:r,popupAnchor:"right"},void 0,(0,fn.jsx)(Ew,{ref:this.refBookmarkPopup,onDeleteBookmarkClick:this.onDeleteBookmarkClick,onClosePopupClick:this.hidePopup,onParentIdChange:this.handleParentIdChange,onTitleChange:this.handleTitleChange,onUrlChange:this.handleUrlChange,onNicknameChange:this.handleNicknameChange,onDescriptionChange:this.handleDescriptionChange,onFolderTitleChange:this.handleFolderTitleChange,title:e,url:t,nickname:n,description:i,image:s,parentId:o,autoFocus:"title",locationSelectMode:this.state.popupLocationSelectMode,onLocationSelectModeChange:this.onLocationSelectModeChange})))}}var Bw;function Fw(e,t,n,i){Bw||(Bw="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Bw,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Uw extends tn.PureComponent{onKeyDown=e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),e.stopPropagation(),this.props.onClick())};render(){return Fw("span",{title:this.props.title,className:"InlineText",tabIndex:M.Z.get(D.kKeyboardTabToAll),onMouseDown:e=>e.preventDefault(),onClick:this.props.onClick,onKeyDown:this.onKeyDown},void 0,this.props.children)}}var Vw,Ww=n(19626);function Hw(e,t,n,i){Vw||(Vw="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Vw,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const zw=(0,le.Z)("(Default)"),Gw="\n• ",$w=["tracking","ad_blocking"];var Kw=Hw("span",{className:"keep-ea-words"},void 0,zw),jw=Hw("span",{className:"keep-ea-words"},void 0,zw),Yw=Hw("span",{className:"keep-ea-words"},void 0,zw);class Xw extends tn.PureComponent{static contextType=dn.Z;buttonStyle={"--trackers":"0","--blocking":"0","--ads":"0"};state={adBlockingEnabled:!1,trackerBlockingEnabled:!1,isBlockingAds:!1,isBlockingTrackers:!1,blockedTrackerList:void 0,blockedAdList:void 0,showBlockedTrackers:!1,showBlockedAds:!1,popupOpen:!1,ruleSourceReady:!1};componentDidMount(){this._isMounted=!0,this.getRules(),this.updateSources(),this.updateBlockingState(),d.Z.contentBlocking.onStateChanged.addListener(this.getRules),d.Z.contentBlocking.onUrlsBlocked.addListener(this.updateBlocked),d.Z.contentBlocking.onExceptionsChanged.addListener(this.getRules),d.Z.contentBlocking.onRulesSourceUpdated.addListener(this.updateSources),d.Z.contentBlocking.onRuleSourceEnabled.addListener(this.updateSources),d.Z.contentBlocking.onRuleSourceDisabled.addListener(this.updateSources),y.Z.webNavigation.onCommitted.addListener(this.updateBlockingState)}componentDidUpdate(e){this.props.url!==e.url&&this.updateBlockingState()}componentWillUnmount(){this._isMounted=!1,d.Z.contentBlocking.onStateChanged.removeListener(this.getRules),d.Z.contentBlocking.onUrlsBlocked.removeListener(this.updateBlocked),d.Z.contentBlocking.onExceptionsChanged.removeListener(this.getRules),d.Z.contentBlocking.onRulesSourceUpdated.removeListener(this.updateSources),d.Z.contentBlocking.onRuleSourceEnabled.removeListener(this.updateSources),d.Z.contentBlocking.onRuleSourceDisabled.removeListener(this.updateSources),y.Z.webNavigation.onCommitted.removeListener(this.updateBlockingState)}getRules=()=>$w.forEach((e=>(0,Ww.pg)(e,(t=>{this.setState(t,(()=>this.updateException(e)))}))));getHostname=e=>{let t="";try{t=new URL(e||this.props.url).hostname}catch(e){}return t};togglePopup=()=>this.setState((e=>({popupOpen:!e.popupOpen})));hidePopup=()=>this.setState({popupOpen:!1});showSettings=()=>{const e=this.context.vivaldiWindowId;this.togglePopup(),ie.Z.showSettings(e,"privacy",{scroll:"tracker_and_ad_blocking"})};getActiveExceptionList=e=>{const t="tracking"===e?"trackerBlockingEnabled":"adBlockingEnabled";return this.state[t]?"exempt_list":"process_list"};updateBlockingState=()=>{$w.map((e=>this.updateException(e))),$w.map((e=>this.updateBlocked(e,[this.props.pageId])))};updateException=e=>d.Z.contentBlocking.isExemptOfFiltering(e,this.props.url,(t=>{this._isMounted&&("tracking"===e?this.setState({isBlockingTrackers:!t}):this.setState({isBlockingAds:!t}))}));updateSources=()=>$w.forEach((e=>{d.Z.contentBlocking.getRuleSources(e,(e=>{this._isMounted&&(e.find((e=>""!==e.rules_list_checksum))?this.setState({ruleSourceReady:!0}):this.setState({ruleSourceReady:!1}))}))}));updateBlocked=(0,Kf.default)(((e,t)=>{const n="tracking"===e?"blockedTrackerList":"blockedAdList";t.includes(this.props.pageId)&&d.Z.contentBlocking.getBlockedUrlsInfo(e,[this.props.pageId],(e=>{this._isMounted&&this.setState({[n]:e[0]})}))}),500);setPageBlocking=e=>{const t=e.currentTarget.value,n=0+(this.state.trackerBlockingEnabled?1:0)+(this.state.adBlockingEnabled?1:0),i=this.getHostname();(0,Ww.fs)(i,t,this.props.pageId,n)};handleExpandClick=(e,t)=>{t.preventDefault(),"tracking"===e?this.setState((e=>({showBlockedTrackers:!e.showBlockedTrackers}))):this.setState((e=>({showBlockedAds:!e.showBlockedAds})))};renderBlocked=e=>{if(!this.props.blockerVisible)return null;const t="tracking"===e?this.state.blockedTrackerList:this.state.blockedAdList;if(!t)return null;const n=t.blocked_urls_info.slice(0).reduce(((e,t)=>{const n=this.getHostname(t.url);return e[n]=(e[n]||0)+t.blocked_count,e}),{});for(const e of t.blocked_trackers_info){const t=e.domain;n[t]=(n[t]||0)+e.blocked_count}const i=this.state.showBlockedTrackers&&"tracking"===e||this.state.showBlockedAds&&"ad_blocking"===e;return(0,fn.jsxs)(fn.Fragment,{children:[Hw("button",{className:mn()({"ContentBlocker-Blocked-Arrow":!0,"ContentBlocker-Blocked-Arrow--Expanded":i}),onClick:this.handleExpandClick.bind(null,e),tabIndex:this.props.tabIndex},void 0,Hw("h3",{},void 0,"tracking"===e?(0,le.Z)("Tracker detail","Tracker details",[t.total_blocked_count]):(0,le.Z)("Ad detail","Ad details",[t.total_blocked_count])),Hw("span",{dangerouslySetInnerHTML:{__html:cn.nfH}})),i&&Hw("ul",{},void 0,Object.keys(n).sort(((e,t)=>n[e]>n[t]?-1:1)).map((e=>Hw("li",{},e,Hw("span",{},void 0,e),Hw("span",{},void 0,n[e])))))]})};getButtonStyle=(e,t,n,i,s,o,a)=>({"--trackers":!e&&t&&1===n?"1":"0","--ads":!e&&t&&2===n?"1":"0","--blocking":i&&s||o&&a?"1":"0"});openPrivacyStatisticsDialog(){this.hidePopup(),ie.Z.showPrivacyStatsDialog(this.context.vivaldiWindowId)}render(){const{ruleSourceReady:e,trackerBlockingEnabled:t,isBlockingTrackers:n,blockedTrackerList:i,adBlockingEnabled:s,isBlockingAds:o,blockedAdList:a}=this.state,{blockerVisible:r,tabIndex:l}=this.props,d=0+(t?1:0)+(s?1:0),c=0+(n?1:0)+(o?1:0),h=i||a;return Hw(sl,{buttonStyle:this.getButtonStyle(Boolean(h),r,c,Boolean(i),n,Boolean(a),o),tooltip:(0,le.Z)("Content Blocker")+(e&&n?Gw+(0,le.Z)("Tracker Blocking Active"):"")+(o&&e?Gw+(0,le.Z)("Ad Blocking Active"):"")+(e?"":Gw+(0,le.Z)("Blocking is inactive due to missing or disabled rule lists")),onClick:this.togglePopup,image:cn.Tu3,hidePopup:this.hidePopup,popupPosition:this.props.position,popupWidth:240,popupClassName:"ContentBlocker ToolbarButtonPopup-DefaultStyles",className:"ContentBlocker-Control",isPopupVisible:this.state.popupOpen},void 0,Hw("h2",{className:"ContentBlocker-Header"},void 0,r?(0,le.Z)("Blocking Level on $1",[this.getHostname()]):(0,le.Z)("Content Blocker")),r&&Hw("div",{className:"ContentBlocker-Field"},void 0,Hw("button",{tabIndex:l,className:mn()({"ContentBlocker-Label":!0,"ContentBlocker-Label--Active":0===c}),value:"0",onClick:this.setPageBlocking},void 0,Hw("span",{className:"ContentBlocker-Label-Icon",dangerouslySetInnerHTML:{__html:cn.Tu3}}),Hw("span",{className:"ContentBlocker-Label-Text"},void 0,(0,le.Z)("No Blocking"),0===d&&Kw)),Hw("button",{tabIndex:l,className:mn()({"ContentBlocker-Label":!0,"ContentBlocker-Label--Active":1===c}),value:"1",onClick:this.setPageBlocking},void 0,Hw("span",{className:"ContentBlocker-Label-Icon",style:{"--trackers":"1"},dangerouslySetInnerHTML:{__html:cn.Tu3}}),Hw("span",{className:"ContentBlocker-Label-Text"},void 0,(0,le.Z)("Block Trackers"),1===d&&jw)),Hw("button",{tabIndex:l,className:mn()({"ContentBlocker-Label":!0,"ContentBlocker-Label--Active":2===c}),value:"2",onClick:this.setPageBlocking},void 0,Hw("span",{className:"ContentBlocker-Label-Icon",style:{"--ads":"1"},dangerouslySetInnerHTML:{__html:cn.Tu3}}),Hw("span",{className:"ContentBlocker-Label-Text"},void 0,(0,le.Z)("Block Trackers and Ads"),2===d&&Yw))),h&&(0,fn.jsxs)(fn.Fragment,{children:[Hw("div",{className:"ContentBlocker-Counter"},void 0,n&&Hw("div",{className:"ContentBlocker-Counter--Block",onClick:this.handleExpandClick.bind(null,"tracking")},void 0,Hw("div",{className:"ContentBlocker-Counter--Number"},void 0,Hw("p",{},void 0,i?.total_blocked_count??0)),Hw("p",{},void 0,(0,le.Z)("Tracker Blocked","Trackers Blocked",[i?.total_blocked_count??0]))),o&&Hw("div",{className:"ContentBlocker-Counter--Block",onClick:this.handleExpandClick.bind(null,"ad_blocking")},void 0,Hw("div",{className:"ContentBlocker-Counter--Number"},void 0,Hw("p",{},void 0,a?.total_blocked_count??0)),Hw("p",{},void 0,(0,le.Z)("Ad Blocked","Ads Blocked",[a?.total_blocked_count??0])))),Hw("div",{className:"ContentBlocker-Blocked"},void 0,i&&this.renderBlocked("tracking"),a&&this.renderBlocked("ad_blocking"))]}),r&&(n||o)&&Hw("div",{className:"ContentBlocker-Counter--Information"},void 0,(0,le.Z)("Page not looking correct? Try disabling the blocker.")," ",Hw(Uw,{onClick:()=>{Y.Z.openURL(this.context.vivaldiWindowId,"https://vivaldi.com/bugreport/"),this.hidePopup()}},void 0,(0,le.Z)("Report a problem"))),Hw("div",{className:"ContentBlocker-Field"},void 0,Hw("button",{className:"privacy-btn-icon",onClick:()=>this.openPrivacyStatisticsDialog(),title:(0,le.Z)("Show privacy Statistics"),dangerouslySetInnerHTML:{__html:cn.vh3+(0,le.Z)("Show privacy Statistics")}}),Hw("input",{type:"button",onClick:this.showSettings,value:(0,le.Z)("Manage Default Settings"),autoFocus:0===l})))}}const Qw=Xw,qw={totalElements:0,loadedElements:0,loadedBytes:0,progress:0,url:""};class Jw extends Us.Z{_progressInfo=new fa.D5;getProgressInfo(e){const t=this._progressInfo.get(e);if(t)return t}emitChange=(0,Kf.default)((()=>{super.emitChange()}),250);dispatchAction(e){switch(e.actionType){case"NAVIGATION_SET_STATE":{const{pageId:t,navigationState:n}=e;if("stop"!==n.trigger&&"abort"!==n.trigger)break;const i=this._progressInfo;this._progressInfo=this._progressInfo.set(t,qw),i!==this._progressInfo&&this.emitChange();break}case"PAGE_SET_PROGRESS":{const{pageId:t,progressState:n}=e;this._setProgressState(n,t);break}case"PAGE_CLOSE":this._removeProgressState(e.pages)}}_setProgressState(e,t){const n=this._progressInfo.get(t);e!==n&&(n&&(e.progress<n.progress&&(e={...e,progress:n.progress}),void 0===e.totalElements&&(e={...e,totalElements:n.totalElements}),void 0===e.loadedElements&&(e={...e,loadedElements:n.loadedElements})),this._progressInfo=this._progressInfo.set(t,e),this.emitChange())}_removeProgressState(e){e.forEach((e=>{this._progressInfo.has(e.id)&&(this._progressInfo=this._progressInfo.remove(e.id),this.emitChange())}))}}const eb=new Jw(l.Z);var tb;function nb(e,t,n,i){tb||(tb="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:tb,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const ib={bytes:0,bytesDisplayed:0,currentPageId:null,elLoaded:0,elLoadedDisplayed:0,elTotal:0,isProgressing:!1,isStarted:!1,progress:0,stopped:!1,pageloadTicker:""},sb=[D.kAddressBarShowProgress,D.kThemeUseAnimation];class ob extends tn.PureComponent{static contextType=dn.Z;_isMounted=!1;state=ib;componentDidMount(){this._isMounted=!0,pv.Z.addListener(this._onNavigationStoreChanged),eb.addListener(this._onProgressStateStoreChanged),Hf.Z.addListener(this._onWebpageviewStoreChanged)}componentWillUnmount(){clearTimeout(this._updateTimer),this._isMounted=!1,pv.Z.removeListener(this._onNavigationStoreChanged),eb.removeListener(this._onProgressStateStoreChanged),Hf.Z.removeListener(this._onWebpageviewStoreChanged)}componentDidUpdate(e,t){const n=this.props.pageId;if(n!==t.currentPageId){const e=eb.getProgressInfo(this.props.pageId),{progress:t=0,loadedBytes:i=0,loadedElements:s=0,totalElements:o=0}=e||{};let a={};a=0===t||1===t||void 0===t?{...ib,currentPageId:n}:{...ib,currentPageId:n,progress:t,bytes:i,elLoaded:s,elTotal:o},this._onUpdateProgressState(a)}}_onUpdateProgressState=e=>{this.setState(e)};_onNavigationStoreChanged=()=>{this._onProgressStateStoreChanged()};_onProgressStateStoreChanged=()=>{const e=this.props.pageId,t=W.Z.getPageById(e);if(t){const e=t.url;if((0,Ni.xl)(e))return}const n=eb.getProgressInfo(e),i=(pv.Z.getNavigationInfo(e)||{}).trigger,{progress:s=0,loadedBytes:o=0,loadedElements:a=0,totalElements:r=0}=n||{};"start"===i?this.setState({...ib,currentPageId:e,isProgressing:!0,isStarted:!0}):"stop"===i?this.setState((e=>({isProgressing:!1,...e.stopped&&{}||{progress:1}}))):"commit"!==i||this.state.stopped||(this.setState({bytes:o,elLoaded:a,elTotal:r,isProgressing:!0,isStarted:!0,progress:s}),this.updateCount())};_onWebpageviewStoreChanged=e=>{e.pageId===this.props.pageId&&"WEBPAGEVIEW_STOP"===e.type&&1!==this.state.progress&&this.setState({isProgressing:!1,stopped:!0})};getIncrement=(e,t)=>{const n=t-e;let i=0;return n>10?i=Math.floor(n/5):n>4?i=2:n>0&&(i=1),e+i};updateCount=()=>{if(clearTimeout(this._updateTimer),!this._isMounted)return;const e=this.state.bytes,t=this.state.bytesDisplayed,n=this.state.elLoadedDisplayed;let i=this.state.elLoaded;1===this.state.progress&&i<this.state.elTotal&&(i=this.state.elTotal);const s=this.getIncrement(t,e),o=this.getIncrement(n,i);!1===this.props.prefValues[D.kThemeUseAnimation]?this.setState({elLoadedDisplayed:i,bytesDisplayed:e}):(i>n&&this.setState({elLoadedDisplayed:o}),e>t&&this.setState({bytesDisplayed:s}),!this.state.stopped&&(i>o||e>s)&&(this._updateTimer=setTimeout(this.updateCount,80)));const a=Co(e,e>1048576?1:0);e>0&&this.setState({pageloadTicker:a})};render(){if(!this.props.open||isNaN(this.state.progress))return null;const e=this.state.progress,t=this.state.elLoadedDisplayed,n=this.state.elTotal,i=this.state.isProgressing,s=this.state.isStarted,o=!0===this.state.stopped;return nb("div",{className:mn()({pageload:!0,unstarted:!s,progressing:i,"progress-done":1===e||o,stopped:o})},void 0,this.props.prefValues[D.kAddressBarShowProgress]&&nb("progress",{className:"pageload-indicator",value:100*this.state.progress,max:100}),nb("div",{className:"pageload-ticker"},void 0,this.state.pageloadTicker),nb("div",{className:"pageload-ticker"},void 0,t+"/"+n))}}const ab=(0,fs.Z)(ob,sb);var rb;function lb(e,t,n,i){rb||(rb="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:rb,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const db=({onDialogClosed:e,onChange:t})=>(0,fn.jsxs)(fn.Fragment,{children:[lb("input",{type:"button",className:"primary",onClick:e,value:(0,le.Z)("OK"),autoFocus:!0}),lb("input",{type:"button",onClick:t,value:(0,le.Z)("Change")})]});var cb;function hb(e,t,n,i){cb||(cb="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:cb,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const pb=So("input");class ub extends tn.PureComponent{nodeRef=tn.createRef();getNode(){return this.nodeRef.current}handleClickOutside=()=>{this.props.onDialogClosed()};allow=()=>{this.props.onPermissionClicked(!1)};deny=()=>{this.props.onPermissionClicked(!0)};renderAllowDenyQuery=()=>{const e=this.props.renderNotice?this.props.renderNotice():null;return(0,fn.jsxs)(fn.Fragment,{children:[e,hb(pb,{type:"button",onClick:this.allow,value:(0,le.Z)("command","Allow")}),hb("input",{type:"button",className:"primary",onClick:this.deny,value:(0,le.Z)("Deny"),autoFocus:!0})]})};render(){return(0,fn.jsxs)("section",{ref:this.nodeRef,className:"addressfield-popup",children:[hb("header",{className:"addressfield-popup-header"},void 0,this.props.image&&hb("span",{dangerouslySetInnerHTML:{__html:this.props.image}}),hb("h1",{},void 0,this.props.message)),hb("section",{className:"dialog-footer"},void 0,!1===this.props.isDecided?this.renderAllowDenyQuery():hb(db,{onDialogClosed:this.props.onDialogClosed,onChange:this.props.onSettingsClicked}))]})}}const gb=(0,Vr.Z)(ub);var mb;function vb(e,t,n,i){mb||(mb="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:mb,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function fb(e,t){switch(e){case"camera":case"microphone_and_camera":case"videocapture":return cn.TVZ[t];case"location":case"geolocation":return cn.awi[t];case"audiocapture":case"microphone":return cn.nl[t];case"sensors":return cn.Y_k[t];case"midi-sysex":return cn.Nek[t];default:return cn.nlo[t]}}class yb extends tn.PureComponent{static contextType=dn.Z;state={isDialogOpen:"undecided"===this.props.permission.state,iconTypeSmall:fb(this.props.permissionType,"small"),iconTypeMedium:fb(this.props.permissionType,"medium")};onNotificatorClicked=()=>{this.setState((e=>({isDialogOpen:!e.isDialogOpen})))};onDialogClosed=()=>{this.setState({isDialogOpen:!1})};onPermissionClicked=e=>{const t=this.props.permission.requestEvent;if(t){!1===e?t.allow():t.deny();const n=this.props.permissionType;n&&Ky.Z.setPermission(this.props.pageId,this.props.origin,n,t,e?"blocked":"allowed")}this.onDialogClosed()};onSettingsClicked=()=>{Y.Z.openURL(this.context.vivaldiWindowId,this.getSettingsURL())};getSettingsURL=()=>{switch(this.props.permissionType){case"location":case"geolocation":return"chrome://settings/content/location";case"notifications":return"chrome://settings/content/notifications";case"camera":case"videocapture":return"chrome://settings/content/camera";case"audiocapture":case"microphone":return"chrome://settings/content/microphone";case"microphone_and_camera":return"chrome://settings/content#media-stream-mic";case"sensors":return"chrome://settings/content/sensors";case"midi-sysex":return"chrome://settings/content/midiDevices";default:console.warn("unknown permissiontype")}};getMessageText=()=>{const e="blocked"===this.props.permission.state,t="undecided"!==this.props.permission.state,n=this.props.origin,i=this.props.permissionType;if(!i)return"";if(t)if(e)switch(i){case"location":case"geolocation":return(0,le.Z)("Website “$1” has been denied location access.",[n]);case"notifications":return(0,le.Z)("Website “$1” has been denied showing notifications.",[n]);case"camera":case"videocapture":return(0,le.Z)("Website “$1” has been denied access to your camera.",[n]);case"audiocapture":case"microphone":return(0,le.Z)("Website “$1” has been denied access to your microphone.",[n]);case"microphone_and_camera":return(0,le.Z)("Website “$1” has been denied access to your microphone and camera.",[n]);case"sensors":return(0,le.Z)("Website “$1” has been denied access to motion sensors.",[n]);case"midi-sysex":return(0,le.Z)("Website “$1” has been denied access to MIDI devices.",[n])}else switch(i){case"location":case"geolocation":return(0,le.Z)("Website “$1” is accessing your location.",[n]);case"notifications":return(0,le.Z)("Website “$1” is authorized to show notifications.",[n]);case"camera":case"videocapture":return(0,le.Z)("Website “$1” is using your camera.",[n]);case"audiocapture":case"microphone":return(0,le.Z)("Website “$1” is recording with your microphone.",[n]);case"microphone_and_camera":return(0,le.Z)("Website “$1” is using your microphone and camera.",[n]);case"sensors":return(0,le.Z)("Website “$1” is using your motion sensors.",[n]);case"midi-sysex":return(0,le.Z)("Website “$1” is using your MIDI devices.",[n])}else switch(i){case"location":case"geolocation":return(0,le.Z)("Website “$1” would like to access your location.",[n]);case"notifications":return(0,le.Z)("Website “$1” would like to show notifications.",[n]);case"camera":case"videocapture":return(0,le.Z)("Website “$1” would like to use your camera.",[n]);case"audiocapture":case"microphone":return(0,le.Z)("Website “$1” would like to use your microphone.",[n]);case"microphone_and_camera":return(0,le.Z)("Website “$1” would like to use your microphone and camera.",[n]);case"sensors":return(0,le.Z)("Website “$1” would like to use motion sensors.",[n]);case"midi-sysex":return(0,le.Z)("Website “$1” would like to use MIDI devices.",[n])}return console.warn("Unknown permissiontype: "+i),i};_privacyNotice(){Y.Z.openURL(this.context.vivaldiWindowId,"https://vivaldi.com/privacy/browser/")}renderNotice=()=>"geolocation"===this.props.permissionType?vb("div",{className:"geo-notice"},void 0,vb("a",{href:"",title:(0,le.Z)("Vivaldi Browser Privacy Policy"),onClick:this._privacyNotice},void 0,(0,le.Z)("Privacy Notice"))):null;render(){const e="blocked"===this.props.permission.state,t="undecided"!==this.props.permission.state,n={"button-addressfield":!0,"permission-popup":!0,"is-allowing":!e&&t,"is-dialog-open":this.state.isDialogOpen};return vb("div",{className:"button-toolbar"},void 0,vb(sl,{tooltip:this.getMessageText(),onClick:this.onNotificatorClicked,image:this.state.iconTypeSmall,popupPosition:this.props.popupPosition,hidePopup:this.onDialogClosed,isPopupVisible:this.state.isDialogOpen,className:mn()(n),popupClassName:"addressfield-popup-container",popupWidth:400},void 0,vb(gb,{onPermissionClicked:this.onPermissionClicked,isDecided:t,onDialogClosed:this.onDialogClosed,onSettingsClicked:this.onSettingsClicked,settingsUrl:"",image:this.state.iconTypeMedium,renderNotice:this.renderNotice,message:this.getMessageText()})))}}const wb=yb;var bb,Cb;function Sb(e,t,n,i){bb||(bb="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:bb,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Tb extends tn.PureComponent{_isPermissionUsage=e=>!e.requestEvent&&"undecided"!==e.state;mergeSortMicCamPermissions(e){const t=(e=e.sortBy(((e,t)=>t))).get("microphone"),n=e.get("camera"),i=e.get("microphone_and_camera");return t&&n&&this._isPermissionUsage(t)&&this._isPermissionUsage(n)&&!i?e=(e=(e=e.delete("microphone")).delete("camera")).set("microphone_and_camera",t):i&&this._isPermissionUsage(i)&&(t&&this._isPermissionUsage(t)&&(e=e.delete("microphone")),n&&this._isPermissionUsage(n)&&(e=e.delete("camera"))),e}render(){if(!this.props.pagePermissions.size)return null;const e=[];return this.props.pagePermissions.forEach(((t,n)=>{this.mergeSortMicCamPermissions(t).forEach(((t,i)=>{e.push(Sb(wb,{pageId:this.props.pageId,permission:t,origin:n,permissionType:i,popupPosition:this.props.popupPosition},i))}))})),Sb("div",{className:"button-toolbar"},void 0,e)}}function Ib(e,t,n,i){Cb||(Cb="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Cb,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class kb extends tn.Component{nodeRef=tn.createRef();getNode(){return this.nodeRef.current}handleClickOutside=()=>{this.props.onDialogClosed()};onBlockedPopupUrlClicked=(e,t)=>{t.preventDefault(),this.props.onPopupAllowed(e)};renderItem=e=>Ib("a",{className:"popupblocker-blocked-page",onClick:this.onBlockedPopupUrlClicked.bind(this,e),title:e.targetUrl,href:e.targetUrl},e.targetUrl+e.timeStamp,e.targetUrl);renderItems=e=>Ib("div",{className:"popupblocker-blocked-pages"},void 0,e.map((e=>this.renderItem(e))));onShouldBlockClicked=e=>{this.props.onShouldBlockClicked(e)};renderAlwaysBlockQuery=()=>Ib("section",{className:"dialog-footer"},void 0,Ib("label",{},void 0,Ib("input",{type:"radio",name:"blocked",value:"false",defaultChecked:!1!==this.props.shouldBlockPopups,onChange:this.onShouldBlockClicked.bind(this,!0)}),(0,le.Z)("Block Popups")),Ib("label",{},void 0,Ib("input",{type:"radio",name:"blocked",value:"true",defaultChecked:!1===this.props.shouldBlockPopups,onChange:this.onShouldBlockClicked.bind(this,!1)}),(0,le.Z)("Always Allow")));render(){return this.props.blockedPopups.size>0?(0,fn.jsxs)("div",{ref:this.nodeRef,tabIndex:"0",className:"addressfield-popup",children:[Ib("header",{className:"addressfield-popup-header"},void 0,this.props.image&&Ib("span",{dangerouslySetInnerHTML:{__html:this.props.image}}),Ib("h1",{},void 0,(0,le.Z)("Blocked Popup Pages"))),Ib("div",{className:"addressfield-popup-content"},void 0,this.renderItems(this.props.blockedPopups)),this.renderAlwaysBlockQuery()]}):null}}const Ab=(0,Vr.Z)(kb);var Zb;function Eb(e,t,n,i){Zb||(Zb="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Zb,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class _b extends tn.Component{state={isDialogOpen:!1,shouldBlockPopups:!0};componentDidMount(){this.props.url&&y.Z.contentSettings.popups.get({primaryUrl:this.props.url},(e=>{y.Z.runtime.lastError&&y.Z.runtime.lastError.message&&console.warn("ERROR getting content settings for popups. Original message:\n"+y.Z.runtime.lastError.message)}))}onNotificatorClicked=()=>{this.setState((e=>({isDialogOpen:!e.isDialogOpen})))};onDialogClosed=()=>{this.setState({isDialogOpen:!1})};onShouldBlockClicked=e=>{const t={primary_pattern:this.props.url,secondary_pattern:this.props.url,type:"popups",setting:e?"block":"allow"};d.Z.settings.setContentSetting(t),this.setState({shouldBlockPopups:e})};render(){var e={"button-addressfield":!0,"permission-popup":!0,"is-blocking":!0===this.state.shouldBlockPopups,"is-allowing":!1===this.state.shouldBlockPopups,"is-dialog-open":this.state.isDialogOpen};return Eb("div",{className:"button-toolbar"},void 0,Eb(sl,{tooltip:(0,le.Z)("Blocked Popup Pages"),onClick:this.onNotificatorClicked,image:cn.nY6.small,popupPosition:this.props.popupPosition,hidePopup:this.onDialogClosed,isPopupVisible:this.state.isDialogOpen,className:mn()(e),popupClassName:"addressfield-popup-container",popupWidth:300},void 0,Eb(Ab,{image:cn.nY6.medium,shouldBlockPopups:this.state.shouldBlockPopups,onShouldBlockClicked:this.onShouldBlockClicked,blockedPopups:this.props.blockedPopups,onPopupAllowed:this.props.onPopupAllowed,onDialogClosed:this.onDialogClosed})))}}const Nb=_b;var Mb;function Pb(e,t,n,i){Mb||(Mb="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Mb,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Db extends tn.PureComponent{state={popupVisible:!1};togglePopup=()=>{this.setState((e=>({popupVisible:!e.popupVisible})))};hidePopup=()=>{this.setState({popupVisible:!1})};render(){return Pb(sl,{className:"create-qr-code",image:cn.ERJ,tooltip:(0,le.Z)("Share Page with QR Code"),onClick:this.togglePopup,popupPosition:this.props.popupPosition,hidePopup:this.hidePopup,isPopupVisible:this.state.popupVisible,popupClassName:"ToolbarButtonPopup-DefaultStyles",popupWidth:yl(this.props.data),size:this.props.size},void 0,Pb(bl,{hidePopup:this.hidePopup,data:this.props.data}))}}const xb=Db;var Ob;function Lb(e,t,n,i){Ob||(Ob="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Ob,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Rb extends tn.PureComponent{getMenuItems=()=>this.props.feeds.map((e=>({...G.Z.makeLabelPair(e.title+" - "+e.type),items:[{handler:t=>Y.Z.openURL(t.windowId,e.href),...(0,Mn.Z)("Preview")},{handler:()=>At.add([{url:e.href,path:d.Z.utilities.generateGUID(),title:e.title,refreshInterval:5,lastChecked:0,offline:!1}]),...(0,Mn.Z)("Subscribe")}]})));render=()=>Lb(sl,{image:cn.ZU_.small,menu:this.getMenuItems,menuOrigin:"bottomLeft",tooltip:(0,le.Z)("Page offers feeds")})}const Bb=Rb;class Fb extends Z.Z{getInitialState(){return new Map}reduce(e,t){switch(t.actionType){case"RSS_FEEDS_FOUND":{const{tabId:n,feeds:i}=t;return(0,E.Uy)(e,(e=>{e.set(n,i)}))}case"PAGE_CLOSE":{const{pages:n}=t;return(0,E.Uy)(e,(e=>{n.forEach((t=>{e.delete(t.id)}))}))}case"RSS_CLEAR_FEEDS":{const{tabId:n}=t;return(0,E.Uy)(e,(e=>{e.delete(n)}))}default:return e}}}const Ub=new Fb;var Vb;function Wb(e,t,n,i){Vb||(Vb="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Vb,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var Hb=Wb("svg",{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},void 0,Wb("g",{},void 0,Wb("path",{d:"M7 8C7 7.44772 7.44772 7 8 7C8.55228 7 9 7.44772 9 8V11C9 11.5523 8.55228 12 8 12C7.44772 12 7 11.5523 7 11V8Z"}),Wb("path",{d:"M8 6C8.55228 6 9 5.55228 9 5C9 4.44772 8.55228 4 8 4C7.44772 4 7 4.44772 7 5C7 5.55228 7.44772 6 8 6Z"}),Wb("path",{fillRule:"evenodd",d:"M15 8C15 11.866 11.866 15 8 15C4.13401 15 1 11.866 1 8C1 4.13401 4.13401 1 8 1C11.866 1 15 4.13401 15 8ZM14 8C14 11.3137 11.3137 14 8 14C4.68629 14 2 11.3137 2 8C2 4.68629 4.68629 2 8 2C11.3137 2 14 4.68629 14 8Z"}))),zb=Wb("svg",{width:"16",height:"16",xmlns:"http://www.w3.org/2000/svg"},void 0,Wb("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 2c1.694 0 3 1.31 3 2.846V6H5V4.846C5 3.311 6.306 2 8 2ZM4 6.085V4.846C4 2.722 5.79 1 8 1s4 1.722 4 3.846V6.085A1.5 1.5 0 0 1 13 7.5v5a1.5 1.5 0 0 1-1.5 1.5h-7A1.5 1.5 0 0 1 3 12.5v-5a1.5 1.5 0 0 1 1-1.415ZM4.5 7a.5.5 0 0 0-.5.5v5a.5.5 0 0 0 .5.5h7a.5.5 0 0 0 .5-.5v-5a.5.5 0 0 0-.5-.5h-7Z",fill:"var(--colorFg)"}),Wb("path",{opacity:".1",d:"M8 7h3.5a.5.5 0 0 1 .5.5v5a.5.5 0 0 1-.5.5H8V7Z",fill:"#000"})),Gb=Wb("svg",{width:"16",height:"16",xmlns:"http://www.w3.org/2000/svg"},void 0,Wb("path",{d:"M7.118 1.654a1 1 0 0 1 1.764 0l6.334 11.875A1 1 0 0 1 14.333 15H1.667a1 1 0 0 1-.883-1.47L7.118 1.653Z",fill:"var(--colorErrorBg)"}),Wb("path",{d:"M8 5a1 1 0 0 0-1 1v3a1 1 0 0 0 2 0V6a1 1 0 0 0-1-1ZM8 11a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z",fill:"var(--colorErrorFg)"})),$b=Wb("svg",{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},void 0,Wb("path",{d:"M10.4 5c-.4-.8 0-1.8 1-2 .7 0 1.5.4 1.6 1.2a1.4 1.4 0 0 1-.2 1l-4 7c-.3.5-.7.8-1.2.8-.6 0-1-.2-1.3-.7L3.8 7.8 2.2 5c-.5-.8 0-2 1-2 .7 0 1 .2 1.4.7l1 2 1 1.4a2 2 0 0 0 1.7 1.5 2.2 2.2 0 0 0 2.3-2V6c0-.3 0-.6-.2-1z"}));function Kb({pageSecurity:e,isUrlEmpty:t}){if(t)return Wb(Oi,{url:M.Z.get(D.kAddressBarInlineSearchEnabled)?cn.YvR.medium:cn.ZuY,loadType:"faviconFromCache"});switch(e){case"web":case"warning":return Hb;case"secure":return zb;case"insecure":return Gb;case"internal":return $b;default:return null}}class jb extends tn.PureComponent{static contextType=dn.Z;refSiteInfoButton=tn.createRef();doActionShowPageInfo=()=>{if(this.props.isEditingUrl)return this.props.fieldGo();qt.Z.getActiveWebView(this.context.vivaldiWindowId)&&y.Z.windows.getCurrent({},(e=>{d.Z.zoom.getVivaldiUIZoom((t=>{const n=this.refSiteInfoButton.current;if(!n)return;const i=n.getBoundingClientRect(),{left:s=0,top:o=0}=e,a=i.left*t+s-1,r=this.props.isInternal?60:360,{screen:l}=this.context,d=(l.availHeight-(i.bottom+o)*t>r?i.bottom+6:i.top-6)*t+o,c=qt.Z.getActiveWebView(this.context.vivaldiWindowId);c&&c.showPageInfo({top:Math.round(d),left:Math.round(a)})}))}))};getFavIconData(){return{favIconUrl:this.props.isUrlEmpty||!this.props.itemFavIcon.favIconUrl?M.Z.get(D.kAddressBarInlineSearchEnabled)?cn.YvR.medium:cn.ZuY:this.props.itemFavIcon.favIconUrl,favIconType:this.props.isUrlEmpty||!this.props.itemFavIcon.favIconUrl||"img"===this.props.itemFavIcon.favIconType?"faviconFromCache":"page"}}render(){const e=this.props.isEditingUrl||this.props.isInternal?"internal":"none"===(t=this.props.sslState)?"internal":"security_error"===t?"insecure":"warning"===t?"warning":"secure"===t?"secure":"web";var t;const n=this.getFavIconData();return(0,fn.jsxs)("button",{ref:this.refSiteInfoButton,className:`button-addressfield SiteInfoButton ${e}`,title:this.props.isEditingUrl?(0,le.Z)("Go to address"):W.Z.isActiveInternal(this.context.vivaldiWindowId)?null:(0,le.Z)("View Site Info"),onClick:this.doActionShowPageInfo,draggable:this.props.draggable,onDragStart:this.props.onDragStart,tabIndex:this.props.tabIndex,children:[this.props.isEditingUrl?Wb(Oi,{className:"SiteInfoButton-Favicon",url:n.favIconUrl,loadType:n.favIconType}):Wb("div",{className:"SiteInfoButton-SecurityBadge"},void 0,Wb(Kb,{pageSecurity:e,isUrlEmpty:this.props.isUrlEmpty})),"warning"===e&&Wb("span",{className:"siteinfo-text"},void 0,(0,le.Z)("Not Secure"))]})}}const Yb=jb;var Xb,Qb=n(85374);function qb(e){return e.local!==e.value?e.value+" ("+e.local+")":e.value}function Jb(e,t,n,i){Xb||(Xb="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Xb,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const eC=[D.kTranslateEnabled];class tC extends tn.Component{static contextType=dn.Z;constructor(e,t){super(e),this.state={languages:[],sourceLang:Ml.Z.getTranslationCode(this.props.pageLanguage),targetLang:Ml.Z.getTranslationCode(this.props.targetLang),serverLanguages:Qb.Z.getState().serverLanguages,settings:{isLanguagePairOnAlwaysTranslateList:!1,isLanguageInNeverTranslateList:!1,isSiteOnNeverTranslateList:!1,shouldShowNeverTranslateShortcut:!1,shouldShowAlwaysTranslateShortcut:!0},isLanguageSupported:!1},this.state.languages=this._getLanguages(),this.state.isLanguageSupported=this.state.serverLanguages.includes(this.state.sourceLang)}componentDidMount(){this.actionPerformed_=!1,this.updateLanguageTranslateSettings(),Qb.Z.addListener(this._onTranslationStateStoreChanged)}componentDidUpdate(e){e.translateStep!==this.props.translateStep&&"after_translate"===this.props.translateStep&&this.onCancel()}componentWillUnmount(){Qb.Z.removeListener(this._onTranslationStateStoreChanged)}_getLanguages=()=>Ml.Z.getTranslationLocales().map((e=>({id:Ml.Z.getTranslationCode(e.key),name:qb(e)})));_onTranslationStateStoreChanged=()=>{const e=this._getLanguages();this.setState({languages:e})};reportDialogClosing(e){this.state.isLanguageSupported&&!this.props.isTranslated&&!1===this.actionPerformed_&&(d.Z.prefs.setTranslationDeclined(this.props.tabId,e,this.state.sourceLang,this.state.targetLang,(()=>{})),this.setActionPerformed())}setActionPerformed(){this.actionPerformed_=!0}updateLanguageTranslateSettings(){this.state.sourceLang&&this.state.targetLang&&d.Z.prefs.getTranslateSettings(this.props.tabId,this.state.sourceLang,this.state.targetLang,(e=>{this.setState({settings:e})}))}shouldShowAlwaysTranslateShortcut=()=>{if(!this.state.sourceLang||this.state.settings.shouldShowNeverTranslateShortcut)return!1;const e=W.Z.getPageById(this.props.tabId);return Boolean(e&&!e.incognito)};shouldShowNeverTranslateShortcut=()=>!(!this.state.sourceLang||this.state.settings.isLanguagePairOnAlwaysTranslateList)&&this.state.settings.shouldShowNeverTranslateShortcut;isTranslationInProgress=()=>"translating"===this.props.translateStep;onCancel=()=>{this.props.hidePopup()};async ReportLanguageRequest(){try{const e="https://mimir.vivaldi.com/request-support?lang="+this.state.sourceLang;!function(e){if(!(e.status>=200&&e.status<300))throw new Error(e.statusText)}(await fetch(e,{method:"GET",headers:{Accept:"application/json","Content-type":"application/json"}}))}catch(e){console.log("Error contacting server: "+e)}}onAskForLanguageSupport=()=>{!this.state.isLanguageSupported&&this.state.sourceLang&&this.ReportLanguageRequest(),this.onCancel()};onTranslate=()=>{const e=Ml.Z.getTranslationCode(this.state.targetLang),t=this.state.sourceLang?Ml.Z.getTranslationCode(this.state.sourceLang):"auto";d.Z.tabsPrivate.translatePage(this.props.tabId,t,e,(e=>{})),this.setActionPerformed()};onRevert=()=>{d.Z.tabsPrivate.revertTranslatePage(this.props.tabId,(e=>{})),this.setActionPerformed()};onTargetLanguageSelected=e=>{const{value:t}=e.currentTarget;t!==this.state.targetLang&&this.setState({targetLang:t})};setAlwaysTranslate=e=>{d.Z.prefs.setLanguagePairToAlwaysTranslate(this.props.tabId,e,this.state.sourceLang,this.state.targetLang,(t=>{t&&(this.updateLanguageTranslateSettings(),e&&!this.props.isTranslated&&this.onTranslate())})),this.setActionPerformed()};setNeverTranslate=e=>{d.Z.prefs.setLanguageToNeverTranslate(this.props.tabId,e,this.state.sourceLang,this.state.targetLang,(e=>{e&&this.updateLanguageTranslateSettings()})),this.setActionPerformed()};setNeverTranslateSite=e=>{d.Z.prefs.setSiteToNeverTranslate(this.props.tabId,e,this.state.sourceLang,this.state.targetLang,(t=>{t&&(this.updateLanguageTranslateSettings(),e&&this.props.isTranslated&&this.onRevert())})),this.setActionPerformed()};toggleOfferToTranslate=()=>{nt.Z.set(D.kTranslateEnabled,!this.props.prefValues[D.kTranslateEnabled]),this.setActionPerformed()};_onAlwaysTranslate=e=>{const t=e.target.checked;this.setAlwaysTranslate(t),this.setActionPerformed()};_onNeverTranslate=e=>{const t=e.target.checked;this.setNeverTranslate(t),this.setActionPerformed()};openTranslatePage=()=>{Y.Z.openURL(this.context.vivaldiWindowId,"https://www.vivaldi.com/translate/")};isError=()=>this.props.error&&"no_error"!==this.props.error;handleCloseClick=e=>{this.reportDialogClosing(!0),this.onCancel()};handleMenuClick=e=>{const t=[];t.push({...(0,Mn.Z)("Always Translate $1",[Ml.Z.getHumanReadableLanguageFromCode(this.state.sourceLang)]),type:"checkbox",handler:this.setAlwaysTranslate.bind(this,!this.state.settings.isLanguagePairOnAlwaysTranslateList),visible:!0,checked:this.state.settings.isLanguagePairOnAlwaysTranslateList}),t.push({...(0,Mn.Z)("Never Translate $1",[Ml.Z.getHumanReadableLanguageFromCode(this.state.sourceLang)]),type:"checkbox",handler:this.setNeverTranslate.bind(this,!this.state.settings.isLanguageInNeverTranslateList),visible:!0,checked:this.state.settings.isLanguageInNeverTranslateList}),t.push({...(0,Mn.Z)("Never Translate This Site"),handler:this.setNeverTranslateSite.bind(this,!this.state.settings.isSiteOnNeverTranslateList),type:"checkbox",visible:!0,checked:this.state.settings.isSiteOnNeverTranslateList}),t.push({...(0,Mn.Z)("Offer to Translate Pages"),type:"checkbox",handler:this.toggleOfferToTranslate.bind(this),visible:!0,checked:this.props.prefValues[D.kTranslateEnabled]}),(0,zi.Z)(this.context.vivaldiWindowId,t)(e),e.preventDefault(),e.stopPropagation()};renderDialogHeader=()=>Jb("div",{className:"TranslatePopup-Header"},void 0,Jb("h3",{},void 0,(0,le.Z)("browser","Translate Page")),this.state.isLanguageSupported&&(0,fn.jsx)(fn.Fragment,{children:Jb("button",{className:mn()({"TranslatePopup-Header-CloseButton":!0}),title:(0,le.Z)("Close Dialog"),dangerouslySetInnerHTML:{__html:cn.vyJ},onClick:this.handleCloseClick})}));renderContent=()=>{if(this.isTranslationInProgress())return null;if(!1===this.state.isLanguageSupported)return Jb("div",{className:"dialog-content"},void 0,(0,le.Z)("Vivaldi Translate does not currently support $1 ($2).",[Ml.Z.getHumanReadableLanguageFromCode(this.state.sourceLang),this.state.sourceLang]));if(this.state.languages&&this.state.languages.length>0&&!this.props.isTranslated){const e=this.state.languages.map((e=>e.id===this.state.targetLang?Jb("option",{value:e.id,defaultValue:!0},e.id,e.name):e.id!==this.state.sourceLang?Jb("option",{value:e.id},e.id,e.name):void 0));return Jb("div",{className:"dialog-content"},void 0,Jb("label",{className:"TranslatePopup-SelectLabel"},"select",(0,le.Z)("To:")),Jb("select",{onChange:this.onTargetLanguageSelected,disabled:!1,value:this.state.targetLang},void 0,e))}return null};renderButtons=()=>{const e=[];if(this.state.isLanguageSupported){const t=this.isTranslationInProgress();this.isError()?e.push(Jb(Tr,{type:"error"},"error",(0,le.Z)("Error translating page."))):t&&e.push(Jb("label",{className:"TranslatePopup-Status"},"progress",(0,le.Z)("Translating..."))),this.props.isTranslated&&!t?(e.push(Jb("label",{className:"TranslatePopup-Status"},"status",(0,le.Z)("This page has been translated to $1 ($2).",[Ml.Z.getHumanReadableLanguageFromCode(this.state.targetLang),this.state.targetLang]))),e.push(Jb("div",{className:"TranslatePopup-Buttons"},"translate-buttons",Jb("input",{type:"button",className:"TranslatePopup-Buttons-Revert",onClick:this.onRevert,disabled:!1,autoFocus:!0,value:(0,le.Z)("Revert to $1",[Ml.Z.getHumanReadableLanguageFromCode(this.state.sourceLang)])},"translate-revert")))):t||(this.shouldShowAlwaysTranslateShortcut()&&e.push(Jb("label",{className:"TranslatePopup-Checkbox"},"alwaysTranslate",Jb("input",{type:"checkbox",checked:this.state.settings.isLanguagePairOnAlwaysTranslateList,onChange:this._onAlwaysTranslate}),Jb("span",{},void 0,(0,le.Z)("Always translate $1",[Ml.Z.getHumanReadableLanguageFromCode(this.state.sourceLang)])))),this.shouldShowNeverTranslateShortcut()&&e.push(Jb("label",{className:"TranslatePopup-Checkbox"},"neverTranslate",Jb("input",{type:"checkbox",checked:this.state.settings.isLanguageInNeverTranslateList,onChange:this._onNeverTranslate}),Jb("span",{},void 0,(0,le.Z)("Never translate $1",[Ml.Z.getHumanReadableLanguageFromCode(this.state.sourceLang)])))),e.push(Jb("div",{className:"TranslatePopup-Buttons"},"translate-buttons",Jb("input",{type:"button",className:"TranslatePopup-Buttons-Translate primary",onClick:this.onTranslate,disabled:!1,value:(0,le.Z)("verb","Translate"),autoFocus:!0},"translate-button"),Jb("button",{className:"TranslatePopup-Buttons-MenuButton",onClick:this.handleMenuClick},void 0,Jb("span",{className:"TranslatePopup-Buttons-MenuButton-Span",value:"options",dangerouslySetInnerHTML:{__html:cn.bqs.small}},"translate-menu"),Jb("label",{className:"TranslatePopup-Buttons-MenuButton-Label"},void 0,(0,le.Z)("Options"))))))}else 0;return e};renderFooter=()=>Jb("footer",{className:"dialog-footer"},void 0,Jb("div",{className:"TranslatePopup-FooterText"},void 0,(0,le.Z)("Powered by Lingvanex, hosted by Vivaldi."),Jb("a",{href:"",className:"TranslatePopup-ReadMoreLink",onClick:this.openTranslatePage,title:(0,le.Z)("Read more about Vivaldi Translate")},void 0,(0,le.Z)("Learn More"))));render(){return Jb(ln.Z,{dialogWidth:350,onRequestClose:this.onCancel},void 0,Jb("div",{className:"TranslatePopup"},void 0,this.renderDialogHeader(),this.renderContent(),this.renderButtons(),this.renderFooter()))}}const nC=(0,fs.Z)(tC,eC);var iC,sC=n(12467);function oC(e,t,n,i){iC||(iC="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:iC,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class aC extends tn.PureComponent{constructor(e){super(e);const t=this.getStateFromStore();let n=(0,sC.Z)();n=n.substring(0,2),this.state={popupVisible:!1,pageLanguage:t.pageLanguage,isTranslated:t.isTranslated,translateStep:t.translateStep,error:"no_error",targetLang:Ml.Z.getTranslationCode(n),autoTranslate:!1}}componentDidMount(){Qb.Z.addListener(this._onTranslationStateStoreChanged)}componentWillUnmount(){Qb.Z.removeListener(this._onTranslationStateStoreChanged)}static getDerivedStateFromProps(e){const{tabId:t}=e,n=Qb.Z.getPageState(t);if(n){const e=n.pageLanguage?n.pageLanguage:"",t=Boolean(n.isTranslated),i={pageLanguage:e,isTranslated:t,error:n.error,translateStep:n.translateStep,autoTranslate:n.autoTranslate};return t&&(i.targetLang=n.translatedLang,n.originalLang&&(i.pageLanguage=n.originalLang)),i}return null}getStateFromStore=()=>{const e=Qb.Z.getPageState(this.props.tabId);if(e){return{pageLanguage:e.pageLanguage?e.pageLanguage:"",isTranslated:Boolean(e.isTranslated),error:e.error,translateStep:e.translateStep,autoTranslate:e.autoTranslate}}return{pageLanguage:"",isTranslated:!1,error:"no_error",translateStep:"idle",autoTranslate:!1}};_onTranslationStateStoreChanged=()=>{const e=this.getStateFromStore();"translating"!==e.translateStep&&"before_translate"!==e.translateStep||this.state.popupVisible||e.autoTranslate?"idle"===e.translateStep&&this.hidePopup():this.showPopup(),this.setState(e)};showPopup=()=>{this.setState({popupVisible:!0})};hidePopup=()=>{this.setState({popupVisible:!1})};togglePopup=()=>{this.setState((e=>({popupVisible:!e.popupVisible})))};render(){if(!this.state.pageLanguage||this.state.targetLang===this.state.pageLanguage)return null;const e=this.state.isTranslated;return oC(sl,{isPressed:e,isOn:e,image:cn.IeE,tooltip:e?(0,le.Z)("Revert Page Translation"):(0,le.Z)("title","Translate Page"),onClick:this.togglePopup,popupPosition:this.props.popupPosition,hidePopup:this.hidePopup,isPopupVisible:this.state.popupVisible,size:this.props.size,popupClassName:"ToolbarButtonPopup-DefaultStyles",popupWidth:300},void 0,oC(nC,{hidePopup:this.hidePopup,tabId:this.props.tabId,isTranslated:this.state.isTranslated,pageLanguage:this.state.pageLanguage,error:this.state.error,targetLang:this.state.targetLang,translateStep:this.state.translateStep}))}}const rC=aC;class lC extends tn.PureComponent{state={selectionStart:-1,selectionEnd:-1};inputField=tn.createRef();static getDerivedStateFromProps(e){const{typedValue:t,autocompleteValue:n}=e,{selectionStart:i,selectionEnd:s}=function(e,t){if(!e||!t)return{selectionStart:-1,selectionEnd:-1};if(!e.toLowerCase().startsWith(t.toLowerCase()))return{selectionStart:-1,selectionEnd:-1};const n=t.length,i=e.length;return n===i?{selectionStart:-1,selectionEnd:-1}:{selectionStart:n,selectionEnd:i}}(n,t);return{selectionStart:i,selectionEnd:s}}focus=()=>{this.inputField.current&&this.inputField.current.focus()};select=()=>{this.inputField.current&&this.inputField.current.select()};blur=()=>{this.inputField.current&&this.inputField.current.blur()};componentDidUpdate(e,t){const n=this.inputField.current;if(n){if(t.selectionStart!==this.state.selectionEnd){const e=this.state.selectionStart;if(-1===e)return;n.selectionStart!==e&&(n.selectionStart=e)}if(t.selectionEnd!==this.state.selectionEnd){const e=this.state.selectionEnd;if(-1===e)return;n.selectionEnd!==e&&(n.selectionEnd=e)}this.props.typedValue!==this.props.autocompleteValue&&(n.selectionDirection="backward")}}setSelection=(e,t="none")=>{const n=this.inputField.current;n&&n.setSelectionRange(e.selectionStart,e.selectionEnd,t)};onKeyPress=e=>{this.props.onKeyPress(e),this.props.typedValue+e.key===e.currentTarget.value&&this.props.onValueChange(e.currentTarget.value)};onChange=({currentTarget:e})=>{this.props.onValueChange(e.value||"")};render(){return(0,fn.jsx)("input",{ref:this.inputField,value:this.props.autocompleteValue,autoComplete:"off",spellCheck:"false",type:"text",autoFocus:this.props.autoFocus,className:this.props.className,disabled:this.props.disabled,placeholder:this.props.placeholder,title:this.props.title,readOnly:this.props.readOnly,onChange:this.onChange,onKeyPress:this.onKeyPress,onBlur:this.props.onBlur,onFocus:this.props.onFocus,onSelect:this.props.onSelect,onCompositionStart:this.props.onCompositionStart,onCompositionUpdate:this.props.onCompositionUpdate,onCompositionEnd:this.props.onCompositionEnd,onClick:this.props.onClick,onContextMenu:this.props.onClick,onDragStart:this.props.onDragStart,onDragEnter:this.props.onDragEnter,onDragOver:this.props.onDragOver,onDragLeave:this.props.onDragLeave,onDragEnd:this.props.onDragEnd,onDrop:this.props.onDrop,onMouseDown:this.props.onMouseDown,onMouseUp:this.props.onMouseUp,onKeyDown:this.props.onKeyDown,onCut:this.props.onCut,onCopy:this.props.onCopy,onPaste:this.props.onPaste})}}var dC=n(25356);function cC(e,t){if(!e)return!0;if(e.score&&t.score&&t.score!==e.score)return t.score>e.score;return(0,Ni.Ph)(t.url).length<(0,Ni.Ph)(e.url).length}function hC(e){return/\w{1,}\.[a-z]{2}/g.test(e)}function pC(e,t){if(!hC(e))return!1;return new RegExp((0,qv.Z)(e)+"/").test(t)}function uC(e,t){let n=t.url.indexOf("://")+1;n>0&&(n+=2);const i=function(e,t){let n=t.url.indexOf("://")+1;n>0&&(n+=2);let i=t.url.toLowerCase().indexOf(e.toLowerCase());return 0!==i&&(i=t.url.substr(n).toLowerCase().indexOf(e.toLowerCase()),i>-1&&(i+=n)),i}(e,t);return 0===i||i===n||i===n+4&&"www."===t.url.substr(n,4)}function gC({preferBookmarks:e,firstBookmarkItem:t,firstBookmarkNicknameItem:n,firstHistoryItem:i,firstTypedHistoryItem:s,firstBookmarkTitleItem:o,firstInternalUrlItem:a}){const r=(e?[n,t,o,s,i,a]:[i,s,t,a]).find(Boolean);return s&&i&&r===s&&(l=s.url,d=i.url,(0,dC.Z)(l).startsWith((0,dC.Z)(d)))?i:r;var l,d}function mC(e,t,n){if(0===t.length)return;const{autocompleteOnTitle:i,preferBookmarks:s}=n,{firstBookmarkIndex:o,firstBookmarkTitleIndex:a,firstHistoryIndex:r,firstTypedHistoryIndex:l,firstBookmarkNicknameIndex:d,firstInternalUrlIndex:c}=function({items:e,value:t,autocompleteOnTitle:n}){let i=-1,s=-1,o=-1,a=-1,r=-1,l=-1;for(let n=0;n<e.length;n++){const d=e[n];if("OMNI_RESULT_FOLDER_NICKNAME"!==d.type&&(d.url&&!pC(t,d.url))){if(d.nickname&&d.nickname.toLowerCase().startsWith(t.toLowerCase()))return{firstBookmarkIndex:n,firstBookmarkTitleIndex:s,firstHistoryIndex:o,firstTypedHistoryIndex:a,firstBookmarkNicknameIndex:r,firstInternalUrlIndex:l};if(uC(t,d))switch(d.type){case"OMNI_RESULT_HISTORY_PROMOTED":case"OMNI_RESULT_HISTORY_URL":cC(e[o],d)&&(o=n);break;case"OMNI_RESULT_BOOKMARK_PROMOTED":case"OMNI_RESULT_BOOKMARK_DESCRIPTION":case"OMNI_RESULT_BOOKMARK_NICKNAME":case"OMNI_RESULT_BOOKMARK_TITLE":case"OMNI_RESULT_BOOKMARK_TITLE_EXACT":case"OMNI_RESULT_BOOKMARK_UNKNOWN":case"OMNI_RESULT_BOOKMARK_URL":case"OMNI_RESULT_BOOKMARK_URL_HOST":cC(e[i],d)&&(i=n);break;case"OMNI_RESULT_TYPED_HISTORY":case"OMNI_RESULT_TYPED_HISTORY_SEARCH":cC(e[a],d)&&(a=n);break;case"OMNI_RESULT_INTERNAL":-1===l&&(l=n)}if(d.type.startsWith("OMNI_RESULT_BOOKMARK")){if(d.title.toLowerCase().startsWith(t.toLowerCase())&&!hC(t)){(-1===s||e[s].title.length<d.title.length)&&(s=n);continue}if(d.nickname&&d.nickname.toLowerCase().startsWith(t.toLowerCase())&&-1===r){r=n;continue}}}}return{firstBookmarkIndex:i,firstBookmarkTitleIndex:s,firstHistoryIndex:o,firstTypedHistoryIndex:a,firstBookmarkNicknameIndex:r,firstInternalUrlIndex:l}}({items:t,value:e,autocompleteOnTitle:i});return gC({preferBookmarks:s,firstBookmarkItem:t[o],firstBookmarkNicknameItem:t[d],firstHistoryItem:t[r],firstTypedHistoryItem:t[l],firstBookmarkTitleItem:i?t[a]:void 0,firstInternalUrlItem:t[c]})}function vC(e){switch(e){case"OMNI_RESULT_BOOKMARK_URL_HOST":return 200;case"OMNI_RESULT_BOOKMARK_PROMOTED":return 100;default:return 0}}function fC(e,t){return(t.visitCount?t.visitCount:0)+("OMNI_RESULT_HISTORY_PROMOTED"===e?200:0)-100*(((t.url||"").match(/\//g)||[]).length-3)}function yC(e,t){if(!e)return t;if("OMNI_RESULT_BOOKMARK_TITLE_EXACT"===e.type){return t+(e.title?e.title.substr(t.length):"")}if("OMNI_RESULT_BOOKMARK_NICKNAME"===e.type)return t+e.nickname.substring(t.length);e.url||"about:blank"!==e.title||(e.url="about:blank");const{url:n}=e,i=n.includes("://")?n.indexOf("://")+3:0,s=n.startsWith(t)?0:n.substr(i).toLowerCase().indexOf(t.toLowerCase())+i;return(n.substr(0,s)+t+n.substr(s+t.length)).substr(s)}function wC(e){return{typedValue:"",autocompleteValue:"",shouldAutocompleteValue:!0,autocompleteItem:void 0,url:e.url||"",hasFocus:!1,typedValueSetByInputEvent:!1}}class bC extends tn.PureComponent{#r=!1;#l=!1;#d="";get isIMEOpen(){return this.#l}refUrlInput=tn.createRef();focus=()=>{this.refUrlInput.current?.focus()};blur=()=>{this.refUrlInput.current?.blur()};select=()=>{this.refUrlInput.current?.select()};state=wC(this.props);static getDerivedStateFromProps(e,t){if(e.url!==t.url)return{url:e.url,shouldAutocompleteValue:!1};if(!t.shouldAutocompleteValue||!e.value)return t.hasFocus&&!t.typedValueSetByInputEvent?{autocompleteValue:e.value,typedValueSetByInputEvent:!1}:{autocompleteItem:void 0,autocompleteValue:e.value,shouldAutocompleteValue:!1};const n={autocompleteOnTitle:e.autocompleteOnTitle},{autocompleteValue:i,autocompleteItem:s}=function(e,t,{autocompleteOnTitle:n}){if(0===e.length)return{autocompleteItem:void 0,autocompleteValue:t};const i=mC(t,e,{preferBookmarks:M.Z.get(D.kAddressBarAutocompletePreferBookmarks),autocompleteOnTitle:n});return i?{autocompleteItem:i,autocompleteValue:yC(i,t)}:{autocompleteItem:void 0,autocompleteValue:t}}(e.autocompleteData,e.value,n);return{typedValue:e.value,autocompleteItem:s,autocompleteValue:i,typedValueSetByInputEvent:e.value===i&&t.hasFocus&&t.typedValueSetByInputEvent}}componentDidUpdate(e,t){t.autocompleteValue!==this.state.autocompleteValue&&this.props.onAutocompleteValueChange(this.state.autocompleteValue),this.props.stateResetKey!==e.stateResetKey&&this.setState(wC(this.props))}_makeSubmit=e=>{const t={ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey},{typedValue:n}=this.state,i=this.state.autocompleteItem?this.state.autocompleteItem.url:this.state.autocompleteValue;this.props.onSubmit({autocompletedValue:i,typedValue:n},t)};onKeyDown=e=>{if(this.props.onKeyDown(e),"Escape"===e.key&&this.setState({shouldAutocompleteValue:!1,typedValue:"",autocompleteValue:this.props.url},(()=>{this.select()})),"Enter"===e.key&&(e.altKey||e.ctrlKey||e.metaKey))return this._makeSubmit(e),void this.setState({shouldAutocompleteValue:!1});e.shiftKey&&"Backspace"===e.key&&e.preventDefault(),"Backspace"===e.key&&this.#l&&(this.#r=!0)};onKeyPress=e=>{this.props.onKeyPress(e),"Enter"!==e.key&&13!==e.which||e.altKey||e.ctrlKey||this._makeSubmit(e)};onValueChange=e=>{const t=this.state.autocompleteValue;this.state.typedValue===e?this.setState({autocompleteValue:e,typedValue:e,autocompleteItem:void 0,shouldAutocompleteValue:!1,typedValueSetByInputEvent:!0}):this.setState((n=>({typedValue:e,typedValueSetByInputEvent:!0,shouldAutocompleteValue:!this.#l&&(e.length>=n.typedValue.length||t===this.#d)}))),this.props.onValueChange(e)};onSelect=e=>{const{selectionStart:t,selectionEnd:n,value:i}=e.currentTarget;t===n&&this.setState({typedValue:i}),this.props.onSelect(e),this.#d=i.substring(t,n)};onFocus=e=>{this.setState({hasFocus:!0}),this.props.onFocus(e)};onBlur=e=>{this.setState({hasFocus:!1}),this.state.autocompleteValue&&this.state.typedValue&&this.state.typedValue!==this.state.autocompleteValue&&this.props.onValueChange(this.state.autocompleteValue),this.props.onBlur(e)};onCompositionStart=()=>{this.#l=!0};onCompositionUpdate=()=>{this.#l=!0};onCompositionEnd=e=>{const t=e.currentTarget.value;this.setState((e=>{const n=!this.#r&&t.length>=e.typedValue.length;return this.#r=!1,{typedValue:t,shouldAutocompleteValue:n}})),this.#l=!1};onCut=e=>{this.setState({shouldAutocompleteValue:!1,typedValueSetByInputEvent:!0}),this.props.onCut(e)};onPaste=e=>{this.setState({shouldAutocompleteValue:!1,typedValueSetByInputEvent:!0}),this.props.onPaste(e)};render(){return(0,fn.jsx)(lC,{ref:this.refUrlInput,autocompleteValue:this.state.autocompleteValue,typedValue:this.state.typedValue,autoFocus:this.props.autoFocus,className:this.props.className,disabled:this.props.disabled,placeholder:this.props.placeholder,title:this.props.title,readOnly:this.props.readOnly,onBlur:this.onBlur,onFocus:this.onFocus,onSelect:this.onSelect,onCompositionStart:this.onCompositionStart,onCompositionUpdate:this.onCompositionUpdate,onCompositionEnd:this.onCompositionEnd,onClick:this.props.onClick,onContextMenu:this.props.onClick,onDragStart:this.props.onDragStart,onDragEnter:this.props.onDragEnter,onDragOver:this.props.onDragOver,onDragLeave:this.props.onDragLeave,onDragEnd:this.props.onDragEnd,onDrop:this.props.onDrop,onMouseDown:this.props.onMouseDown,onMouseUp:this.props.onMouseUp,onCut:this.onCut,onCopy:this.props.onCopy,onPaste:this.onPaste,onKeyDown:this.onKeyDown,onValueChange:this.onValueChange,onKeyPress:this.onKeyPress})}}const CC=function(e,t){return 0===(t=t.replace(/^https?\:\/\/(www+\.)?/,"")).indexOf(e)};function SC({nickname:e,children:t,url:n,title:i,description:s},o){const a=o.join(" ");let r=[];return o[0].startsWith("data:")||(r=o.map((e=>new RegExp((0,qv.Z)(e),"i")))),function(e,t){return!(!t||!e||!t.toLowerCase().startsWith(e.toLowerCase()))}(a,e)?t?"OMNI_RESULT_FOLDER_NICKNAME":"OMNI_RESULT_BOOKMARK_NICKNAME":t||"string"!=typeof n?void 0:CC(a,n)?"OMNI_RESULT_BOOKMARK_URL_HOST":i&&i.toLowerCase().startsWith(a.toLowerCase())?"OMNI_RESULT_BOOKMARK_TITLE_EXACT":n&&r.every((e=>n.match(e)))?n.endsWith("/")?"OMNI_RESULT_BOOKMARK_PROMOTED":"OMNI_RESULT_BOOKMARK_URL":i&&r.every((e=>i.match(e)))?"OMNI_RESULT_BOOKMARK_TITLE":s&&r.every((e=>s.match(e)))?"OMNI_RESULT_BOOKMARK_DESCRIPTION":void 0}class TC{search=e=>{if(!e)return Promise.resolve([]);const t=e.startsWith("data:")?[]:e.replace(/\s+/g," ").split(" ");return 0===t.length?Promise.resolve([]):function(e){const t=[];for(const n of en.ZP.iterateTree()){const i=SC(n,e);if(!i)continue;const{id:s,title:o,nickname:a,children:r}=n,l=vC(i);if(r){const e=r.filter((e=>en.ZP.isBookmark(e))).map((e=>e.url));t.push({id:s,title:o,type:i,nickname:a,score:l,urls:e})}else if(en.ZP.isBookmark(n)&&n.url){const e=St.jk.getDisplayUrl(n.url);t.push({id:s,title:o,type:i,nickname:a,score:l,url:e})}}return Promise.resolve(t)}(t)}}const IC=["http:","https:","file:","ftp:"];class kC{search=(e,t)=>{if(!e)return Promise.resolve([]);const[n,...i]=e.replace(/\s+/g," ").trim().split(" ");return new Promise((e=>{d.Z.historyPrivate.dbSearch({text:n,maxResults:1e3},(n=>{e(n.filter((e=>{const t=e.url&&0!==e.lastVisitTime&&e.url.length<2048&&IC.some((t=>(e.url||"").startsWith(t)));return function(e,t){if(0===e.length)return!0;const{title:n,url:i}=t;return n&&e.every((e=>n.toLowerCase().includes(e.toLowerCase())))||i&&e.every((e=>i.toLowerCase().includes(e.toLowerCase())))}(i,e)&&t})).map((e=>{const t=function(e,t){const n=t.map((e=>new RegExp((0,qv.Z)(e),"i"))),{url:i,title:s}=e;return i&&n.every((e=>i.toLowerCase().match(e)))?"/"===i.charAt(i.length-1)?"OMNI_RESULT_HISTORY_PROMOTED":"OMNI_RESULT_HISTORY_URL":s&&n.every((e=>s.toLowerCase().match(e)))?"OMNI_RESULT_HISTORY_TITLE":"OMNI_RESULT_HISTORY_UNKNOWN"}(e,i);return((e,t)=>{const{id:n,title:i,typedCount:s,url:o}=e,a={type:t,id:n,score:fC(t,e),title:i||"",typed:Boolean(s&&s>0),url:St.jk.getDisplayUrl(o||"")};return e.lastVisitTime&&(a.lastVisitTime=e.lastVisitTime),e.visitCount&&(a.visitCount=e.visitCount),a})(e,t)})).sort(((e,t)=>(t.score||0)-(e.score||0))).filter(((e,n)=>n<t.count)))}))}))}}const AC=class{constructor({provider:e}){this._searchProvider=e}search(e,t){const n=new Promise(((i,s)=>this._searchProvider.search(e,t).then(((...e)=>{n!==this._newestInstanceSearch&&s("A more recent search is in progress"),i(...e)}))));return this._newestInstanceSearch=n,this._newestInstanceSearch}};var ZC=n(82394);class EC{search=(e,t)=>e?new Promise((n=>{const i=Nn.Z.getByQuery(e),s=i?i.id:"-1";d.Z.historyPrivate.getTypedHistory(e,s,t.count,(e=>n((0,ZC.Z)(e))))})):Promise.resolve([])}var _C=n(98974);function NC(e,t,n,i){return e.substring(0,n)+t+e.substring(i)}const MC=/^(.*?:\/\/\/*)(.*)$/,PC=/(.*?)\/*([#?].*)/;var DC,xC;function OC(e,t,n,i){DC||(DC="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:DC,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class LC extends tn.Component{static contextType=dn.Z;refComponent=tn.createRef();componentDidMount(){if(!this.refComponent.current)return;this._intersectionObserver=new IntersectionObserver((([e])=>{this.onIntersectionChange(e.intersectionRatio)}),{threshold:1}),this._intersectionObserver.observe(this.refComponent.current)}componentWillUnmount=()=>{this.props.onBaseDomainObscured(!1),this._intersectionObserver?.disconnect()};onIntersectionChange=e=>{const t=e<1;this.props.onBaseDomainObscured(t)};render(){const{urlFragment:e,onGoToPath:t,tld:n,basedomain:i,subdomain:s,port:o,scheme:a}=this.props,r=(a?`${a}://`:"")+(e||"")+(o?`:${o}`:""),l=this.context.vivaldiWindowId;return OC(BC,{windowId:l,url:r,onGoToPath:t},void 0,i?(0,fn.jsxs)("span",{ref:this.refComponent,children:[s&&OC("span",{className:"UrlFragment--Lowlight UrlFragment-HostFragment-Subdomain"},void 0,s,"."),OC("span",{className:"UrlFragment--Highlight UrlFragment-HostFragment-Basedomain"},void 0,i),n&&OC("span",{className:"UrlFragment--Highlight UrlFragment-HostFragment-TLD"},void 0,".",n),o&&OC("span",{className:"UrlFragment--Lowlight UrlFragment-HostFragment-Port"},void 0,":",o)]}):(0,fn.jsxs)("span",{ref:this.refComponent,children:[OC("span",{className:"UrlFragment--Highlight"},void 0,e),o&&OC("span",{className:"UrlFragment--Lowlight"},void 0,":",o)]}))}}function RC(e,t,n,i){xC||(xC="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:xC,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function BC({windowId:e,url:t,className:n,children:i,onGoToPath:s}){return RC("span",{className:mn()("UrlFragment-Link",n),onClick:()=>s(t),onMouseOver:()=>X.Z.setStatus(e,t),onMouseOut:()=>X.Z.clearStatus(e)},void 0,i)}function FC({windowId:e,urlFragment:t,onGoToPath:n,host:i,scheme:s,port:o}){return t?t.split("/").slice(1).map((e=>`/${e}`)).map(((t,a,r)=>{const l=(s?`${s}://`:"")+(i||"")+(o?`:${o}`:"")+r.slice(0,a+1).join("");return RC(BC,{windowId:e,className:"UrlFragment--Lowlight",onGoToPath:n,url:l},l,t)})):null}function UC({urlFragment:e}){return RC("span",{className:"UrlFragment--Lowlight"},void 0,e)}function VC({urlFragment:e}){return RC("span",{className:"UrlFragment--Lowlight"},void 0,e,"://")}var WC=RC("span",{className:"UrlFragment--Highlight"},void 0,"data:");function HC({urlFragment:e}){return e?(0,fn.jsxs)(fn.Fragment,{children:[WC,RC("span",{className:"UrlFragment--Lowlight"},void 0,e.substring("data:".length,Q.RL))]}):null}function zC({windowId:e,url:t,shouldShowFullUrl:n,onGoToPath:i,isClickable:s,shouldHighlightBaseDomain:o,onBaseDomainObscured:a,urlFragments:r}){if(!t)return null;const l=(0,_C.ZP)(t);if(!l)return null;if(!["http","https","ftp","data"].includes(t.substring(0,t.indexOf(":"))))return RC("div",{className:"UrlFragment-Wrapper"},void 0,RC("span",{className:"UrlFragment--Highlight"},void 0,l.substring(0,Q.RL)));const{schema:d}=function(e){if(e.startsWith("data:"))return{schema:"data:",host:"",postfix:"",path:e.substring("data:".length)};let t;try{t=new URL(e)}catch(e){return{schema:"",host:"",path:"",postfix:""}}const n=e.match(MC),i=n&&n[1]||"",s=e.match(PC),o=s&&s[2]||"",a=t.hostname+(t.port?`:${t.port}`:"");let r;try{r=decodeURI(t.pathname)}catch(e){r=t.pathname}return"vivaldi://"===i?{schema:i,host:a,path:r.startsWith("//")?r.substring(2,r.length-1):r,postfix:o}:{schema:i,host:a,path:r,postfix:o}}(l);if("data:"===d)return RC("div",{className:mn()("UrlFragment-Wrapper",{"UrlFragment-Wrapper--ShouldHighlight":o})},void 0,RC(HC,{urlFragment:t}),";");const c=function(e){return(e.scheme?.length||0)+(e.username?.length||0)+(e.password?.length||0)+(e.host?.length||0)+(e.path?.length||0)+(e.ref?.length||0)+(e.query?.length||0)+(e.port?.length||0)+(e.tld?.length||0)>=Q.RL}(r);if(c)return RC("div",{className:"UrlFragment-Wrapper"},void 0,RC("span",{className:"UrlFragment--Highlight"},void 0,l.substring(0,Q.RL)));const{scheme:h,host:p}=r,u=function(e){return(null!==e.query?`?${e.query}`:"")+(null!==e.ref?`#${e.ref}`:"")}(r),g=r.path||!r.ref&&!r.query?r.path:"/",{subdomain:m,basedomain:v}=(0,_C.gC)(r.host,r.tld)||{subdomain:"",basedomain:""};return RC("div",{className:mn()("UrlFragment-Wrapper",{"UrlFragment-Wrapper--Clickable":s,"UrlFragment-Wrapper--ShouldHighlight":o})},void 0,n&&h&&RC(VC,{urlFragment:h}),RC("span",{className:"UrlFragment-LinkWrapper"},void 0,RC(LC,{urlFragment:r.host,scheme:h||"",tld:r.tld,port:r.port,basedomain:v,subdomain:m,onGoToPath:i,onBaseDomainObscured:e=>a&&a(e)}),(n||!n&&"/"!==g)&&RC(FC,{windowId:e,urlFragment:g,onGoToPath:i,host:p,port:r.port,scheme:h||""})),n&&u&&RC(UC,{urlFragment:u}))}var GC,$C=n(71860),KC=n(29526),jC=n(34155);function YC(e,t,n,i){GC||(GC="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:GC,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const XC=!1,QC="text/plain",qC="text/uri-list",JC=[D.kAddressBarAutocompleteSuffixExpansionValue,D.kAddressBarAutocompleteSuffixExpansionEnabled,D.kAddressBarInlineSearchEnabled,D.kAddressBarInlineSearchSuggestEnabled,D.kAddressBarInlineSearchSuggestOnNickname,D.kAddressBarOmniboxCutcopyEncoded,D.kAddressBarOmniboxEnabled,D.kAddressBarOmniboxShowBookmarks,D.kAddressBarOmniboxShowBrowserHistory,D.kAddressBarOmniboxShowSearchHistory,D.kAddressBarOmniboxShowTopSites,D.kAddressBarOmniboxShowTypedHistory,D.kAddressBarSelectOnClick,D.kAddressBarShowFullUrl,D.kAddressBarTypedHistoryEnabled,D.kAddressBarUrlOpenShortcut,D.kAddressBarOmniboxNumberOfBookmarkResults,D.kAddressBarOmniboxNumberOfHistoryResults,D.kAddressBarOmniboxNumberOfTypedHistoryResults,D.kAddressBarOmniboxNumberOfSearchSuggestions,D.kAddressBarStripJavascriptOnPaste,D.kAddressBarHighlightBaseDomain];const eS=[["vivaldi://version/",(0,le.Z)("Vivaldi Version")],["vivaldi://help/",(0,le.Z)("Help Pages")],["vivaldi://about/",(0,le.Z)("About")],["vivaldi://welcome/",(0,le.Z)("Vivaldi Welcome Tour")],["vivaldi://notes/",(0,le.Z)("Notes")],["vivaldi://bookmarks/",(0,le.Z)("Bookmarks")],["vivaldi://history/",(0,le.Z)("History")],["vivaldi://settings/",(0,le.Z)("Settings")],["vivaldi://extensions/",(0,le.Z)("Extensions")],["vivaldi://experiments/",(0,le.Z)("Experiments")],["vivaldi://game/",(0,le.Z)("Vivaldia Game")]].map((([e,t],n)=>({url:e,score:n,title:t,disableDelete:!0,id:e,type:"OMNI_RESULT_INTERNAL",faviconUrl:e,faviconType:"favicon"}))),tS=eS.map((e=>({...e,url:e.url.replace(/\//g,"")})));function nS(e){return e.startsWith("vivaldi:/")?eS.filter((t=>t.url.startsWith(e))):e.startsWith("vivaldi:")?tS.filter((t=>t.url.startsWith(e))):[]}function iS(e){return{typedUrl:"",isOmniDropdownOpen:!1,isTypedHistoryOpen:!1,bookmarkResults:[],historyResults:[],typedHistoryResults:[],nicknameResults:[],suggestResults:[],dropdownSelectionIndex:-1,selectedItem:void 0,autocompletedItem:void 0,value:"",isMetaKeyPressed:!1,autocompleteData:[],pageId:e}}class sS extends tn.PureComponent{static contextType=dn.Z;#n=!1;#c=!1;#h=!1;#p=!1;#u=!1;#g="";#m=!1;#v=0;_nav=new Gf(this);_omniDropdownElement=tn.createRef();_urlInput=tn.createRef();bookmarkSearch=new TC;historySearch=new AC({provider:new kC});typedHistorySearch=new EC;state=iS(this.props.pageId);static defaultProps={urlFragments:(0,_C.kG)()};get autocompletedValue(){return this.#g}setUrlfieldState=e=>{Of.Z.setUrlfieldState(this.props.pageId,e)};globalKeydownListener=(e,t,n,i)=>{i===qi.Z.KEY_CONTROL&&this.setState({isMetaKeyPressed:t})};_onWindowStoreChanged=()=>{this.setState({isMetaKeyPressed:!1})};componentDidMount(){this.#n=!0,$C.Z.addListener(this._onUrlbarStoreChanged),z.ZP.addListener(this._onWindowStoreChanged),d.Z.tabsPrivate.onKeyboardChanged.addListener(this.globalKeydownListener)}componentWillUnmount(){this.#n=!1,$C.Z.removeListener(this._onUrlbarStoreChanged),this._tearDownComponentEventListeners(),z.ZP.removeListener(this._onWindowStoreChanged),d.Z.tabsPrivate.onKeyboardChanged.removeListener(this.globalKeydownListener)}static getDerivedStateFromProps(e,t){return-1===t.dropdownSelectionIndex&&(0,KC.Z)(e.displayUrl)!==t.typedUrl?{typedUrl:e.pageId!==t.pageId?$C.Z.getUrlfieldStateFromId(e.pageId)?.editUrl??"":t.typedUrl,pageId:e.pageId,value:"string"==typeof e.editUrl?e.editUrl:e.displayUrl||t.typedUrl}:t.selectedItem?{pageId:e.pageId,value:t.selectedItem.text||t.selectedItem.url||""}:{pageId:e.pageId,value:e.editUrl||t.typedUrl}}_isSuggestEnabled=()=>{const{prefValues:e}=this.props,t=Boolean(this.props.typedSearchEngine);return!!e[D.kAddressBarInlineSearchSuggestEnabled]&&e[D.kAddressBarOmniboxEnabled]&&(!e[D.kAddressBarInlineSearchSuggestOnNickname]||t)};_onSearchSuggestionsReceived=(e,t)=>{this.searchDoneSuggest(t)};_onUrlbarStoreChanged=e=>{"URLFIELD_TYPED_HISTORY_UPDATE"===e&&this.state.isOmniDropdownOpen&&this.typedHistorySearch.search(this.state.typedUrl,{count:M.Z.get(D.kAddressBarOmniboxNumberOfTypedHistoryResults)}).then(this.searchDoneTypedHistory)};focus(){this._urlInput.current?.focus()}blur(){this._urlInput.current?.blur()}select(){this._urlInput.current?.select()}updateDropdown(){if(!this.#c&&this.props.showDropdown){if(!this.props.prefValues[D.kAddressBarOmniboxEnabled])return;if(!this.#p)return;this.#h=!0,this.setState({isOmniDropdownOpen:!0,isTypedHistoryOpen:!1,dropdownSelectionIndex:-1})}}getTypedURL=()=>this.state.typedUrl;_getInputWasIncrementedOrDecremented=(e,t)=>{let n,i;return t?(n=e.startsWith(t)||!(this.props.editUrl||"").startsWith(e),i=(t||"").startsWith(e)&&e.length<t.length):(n=e.startsWith(this.props.editUrl||"")||null==this.props.editUrl||null==this.props.displayUrl,i=(this.props.displayUrl||"").startsWith(e)),i&&n&&(n=!1),{inputWasIncremented:n,inputWasDecremented:i}};searchDoneBookmarks=e=>{const t=(0,Af.default)(e.filter((e=>e.type.startsWith("OMNI_RESULT_BOOKMARK")&&!e.type.includes("OMNI_RESULT_BOOKMARK_NICKNAME"))),M.Z.get(D.kAddressBarOmniboxNumberOfBookmarkResults)),n=(0,Af.default)(e.filter((e=>e.type.startsWith("OMNI_RESULT_BOOKMARK_NICKNAME")||e.type.startsWith("OMNI_RESULT_FOLDER_NICKNAME"))),M.Z.get(D.kAddressBarOmniboxNumberOfBookmarkResults));this.setState({nicknameResults:n,bookmarkResults:t})};searchDoneHistory=e=>{this.#n&&this.setState({historyResults:e})};searchDoneTypedHistory=e=>{if(!this.#n)return;const t=this.props.prefValues[D.kAddressBarTypedHistoryEnabled]?e:[];this.setState({typedHistoryResults:t})};_maybePrefixWithKeyword=e=>this.props.typedSearchEngine&&this.props.typedSearchEngine.keyword&&!e.startsWith(this.props.typedSearchEngine.keyword+" ")?this.props.typedSearchEngine.keyword+" "+e:e;searchDoneSuggest=e=>{const t=M.Z.get(D.kAddressBarOmniboxNumberOfSearchSuggestions),n=(0,Af.default)(e,t).map((e=>({id:e,type:"OMNI_RESULT_SUGGEST",disableDelete:!0,url:this._maybePrefixWithKeyword(e),faviconUrl:(this.props.typedSearchEngine||this.props.defaultSearchEngine)?.faviconUrl,faviconType:"img"})));this.setState({suggestResults:n})};_throttledSearchSuggest=(0,Kf.default)(((e,t,n)=>{this._abortController&&this._abortController.abort(),this._abortController=new AbortController,lo(e,t,n,this._abortController.signal,this._onSearchSuggestionsReceived)}),500,{leading:!1});onClick=async e=>{if(!this.props.prefValues[D.kAddressBarSelectOnClick])return;const{button:t,currentTarget:n}=e,{selectionStart:i,selectionEnd:s,value:o}=n;if(0===t&&Date.now()-this.#v<350)return;this.#v=Date.now();const a=0===i&&s===o.length;if(i===s||a){if(this.isUrlInputFocusedOnMouseDown())return void this.handleInputSelect(n);0===t&&await new Promise((e=>jC.nextTick(e))),n.select(),this._focusedOnMouseDown=null}};onMouseDown=()=>{this._focusedOnMouseDown=this.context.document.activeElement};onValueChange=e=>{this.setUrlfieldState({editUrl:e});const{dropdownSelectionIndex:t,selectedItem:n}=this.state;this.setState({typedUrl:e,selectedItem:-1!==t?n:void 0},(()=>{e?this.performSearch(e):this.hideDropdown()}))};onAutocompleteValueChange=e=>{if(this.#g=e,this.props.onChange){const t=this.state.selectedItem;t&&"OMNI_RESULT_FOLDER_NICKNAME"!==t.type?(t.url=e,this.props.onChange(t)):this.props.onChange(void 0)}jC.nextTick((()=>{this.props.editUrl&&this.setUrlfieldState({autocompleteValue:e})}))};handleInputSelect=e=>{this.#h?this.#h=!1:""!==e.value.trim()&&"none"===e.selectionDirection&&(e.selectionDirection="forward")};onSelected=e=>{const{currentTarget:t,nativeEvent:n}=e;"selectionchange"===n.type&&""===document.getSelection()?.toString()&&t.value!==this.props.displayUrl&&this.setUrlfieldState({editUrl:t.value}),"mouseup"!==n.type&&this.handleInputSelect(t)};_handleUndo=e=>{const t=e.currentTarget,{value:n}=this.state;if(this.state.value.length<t.value.length){e.preventDefault();const t=e.currentTarget.selectionStart-1;t>0?this.setUrlfieldState({editUrl:n.substring(0,t)}):(this.setUrlfieldState({editUrl:""}),this.hideDropdown())}""===n&&(e.preventDefault(),this.revertUrl())};_cleanupState=()=>{this.#u=!1};_constructSearchSuggestion=()=>{const{typedSearchEngine:e,defaultSearchEngine:t}=this.props,n=e||t;if(!n)return;if(!(this._isSuggestEnabled()&&(e&&e.suggestUrl||!e&&t&&t.suggestUrl)))return;const i=e&&function(e,t){return t&&e.startsWith(t.keyword+" ")?e.substr(t.keyword.length+1):e}(this.state.typedUrl,this.props.typedSearchEngine)||this.state.typedUrl;return i.trim()?this._throttledSearchSuggest(this.context.vivaldiWindowId,i.trim(),n):void 0};_updateAutocompleteItem=e=>{this.#n&&this.setState({autocompleteData:e})};_throttledSearch=(0,Kf.default)((async(e,t)=>{if(!this.#n||this.props.pageId!==e||this.#c)return;this._cleanupState(),this._constructSearchSuggestion();const n=this.historySearch.search(t,{count:M.Z.get(D.kAddressBarOmniboxNumberOfHistoryResults)}).catch((()=>[]));n.then(this.searchDoneHistory);const i=this.typedHistorySearch.search(t,{count:M.Z.get(D.kAddressBarOmniboxNumberOfTypedHistoryResults)});i.then(this.searchDoneTypedHistory);const s=this.bookmarkSearch.search(t);if(s.then(this.searchDoneBookmarks),this.updateDropdown(),!this.props.autocompletionEnabled)return void await Promise.all([n,i,s]);if(this.#m)return this.setState({autocompleteData:[]}),this.#m=!1,void await Promise.all([s,n,i]);const o=await s,a=M.Z.get(D.kAddressBarAutocompletePreferBookmarks),r=nS(t);a&&0!==o.length&&this._updateAutocompleteItem([...o,...r]);const[l,d]=await Promise.all([n,i]);this._updateAutocompleteItem([...o,...l,...d,...r])}),200);performSearch=e=>{if(""===e.trim())return;const{inputWasIncremented:t,inputWasDecremented:n}=this._getInputWasIncrementedOrDecremented(e,this.state.typedUrl);(n||!t&&!n)&&this.setState({autocompletedItem:void 0}),this.#c=!1,this._throttledSearch(this.props.pageId,e)};revertUrl=e=>{this.#n&&(this.setUrlfieldState({editUrl:e,autocompleteValue:void 0}),this.setState({typedUrl:"",value:""}))};_openOmniDropDown=()=>{!this.state.isTypedHistoryOpen&&this.props.prefValues[D.kAddressBarTypedHistoryEnabled]&&this.setState({isTypedHistoryOpen:!0,isOmniDropdownOpen:!1})};toggleTypedHistory=e=>{e.preventDefault(),this.setState((e=>({isTypedHistoryOpen:!e.isTypedHistoryOpen})))};_onEscPressed=()=>{this._urlInput.current?.isIMEOpen||(this.hideDropdown(),"string"==typeof this.props.editUrl?(this.revertUrl(),this.setState({autocompleteData:[]}),this.select()):(this.blur(),a.Z.executeActions(this.context.vivaldiWindowId,"COMMAND_FOCUS_WEBVIEW")))};hideDropdown=()=>{this.setState({isOmniDropdownOpen:!1,isTypedHistoryOpen:!1,dropdownSelectionIndex:-1,selectedItem:void 0})};getDropdown=()=>this._omniDropdownElement.current;onPaste=e=>{const{clipboardData:t}=e;if(t.types[0]!==QC)return;const n=t.getData(QC);n.trim()||e.preventDefault();const i=/^(\s*javascript:)+/i,s=e.currentTarget.selectionStart;if(M.Z.get(D.kAddressBarStripJavascriptOnPaste)){if(i.test(n)){e.preventDefault();const t=n.replace(/javascript:/gi,""),i=NC(this.state.typedUrl||"",t,s,e.currentTarget.selectionEnd);return void this.onValueChange(i)}if(i.test(this.state.typedUrl+n)){e.preventDefault();const t=NC("",(this.state.typedUrl+n).replace(/javascript:/gi,""),s,e.currentTarget.selectionEnd);return void this.onValueChange(t)}}this.#m=!0};onClipboardEvent=e=>{const{clipboardData:t,type:n,currentTarget:i}=e;if(!(i instanceof HTMLInputElement&&t))return;if(0!==i.selectionStart||i.selectionEnd!==i.value.length)return;let s=i.value;i.selectionEnd&&i.selectionEnd!==i.value.length&&(s=i.value.substring(0,i.selectionEnd));const o=this.props.editUrl===s;if(this.props.prefValues[D.kAddressBarOmniboxCutcopyEncoded]&&!o&&(s=encodeURI(s).replace(/%25/g,"%")),s.length>=Q.RL&&s.endsWith("...")&&void 0!==this.props.pageUrl&&this.props.pageUrl.startsWith(s.substring(0,Q.RL))&&(s=this.props.pageUrl),(0,Ni.Zj)(s)&&s.match(/[\.\/]/)&&this.state.value===this.props.displayUrl){const e=_i.parse(St.jk.getDisplayUrl(this.props.pageUrl||""));e&&e.protocol&&(s=e.protocol+(e.slashes?"//":"")+s)}if(t.setData("text",s),"cut"===n){const e=i.value.substr(i.selectionEnd);this.setUrlfieldState({editUrl:e}),i.setSelectionRange(0,0),this.setState({selectedItem:void 0,typedUrl:e})}e.preventDefault()};_saveStateOnKeyEvent=({currentTarget:e})=>{const t=e.value?e.value:"";e.selectionStart===e.selectionEnd&&e.selectionStart===t.length&&this.setState({typedUrl:t})};_shortcutListener=(e,t,n,i)=>{if(t&&i===qi.Z.KEY_ESCAPE)this._onEscPressed()};_setUpComponentEventListeners=()=>{d.Z.tabsPrivate.onKeyboardChanged.addListener(this._shortcutListener)};_tearDownComponentEventListeners=()=>{d.Z.tabsPrivate.onKeyboardChanged.removeListener(this._shortcutListener)};setFocus=e=>{this.#p=e};onFocus=e=>{this.#p=!0,this.props.onFocus&&this.props.onFocus(e),this.props.showDropdown&&this._setUpComponentEventListeners()};onBlur=e=>{const{document:t,getSelection:n}=this.context;this.#p=!1;const i=n();if(i&&i.focusNode instanceof Element&&"UrlField"===i.focusNode.className&&i.removeAllRanges(),this.props.onBlur&&this.props.onBlur(),this.props.showDropdown&&this._tearDownComponentEventListeners(),this.state.selectedItem&&this.state.selectedItem.url){const e=this.state.selectedItem.url;this.setUrlfieldState({editUrl:e})}jC.nextTick((()=>{t.activeElement?.classList.contains("uifocusstop")||ie.Z.setPaneFocus(this.context.vivaldiWindowId,!1)}))};_handleSelectedItemChanged=()=>{if(!this.props.onChange)return;const e=this.state.selectedItem&&this.state.selectedItem.url?this.state.selectedItem.url:"",t=this.state.selectedItem;t&&"OMNI_RESULT_FOLDER_NICKNAME"!==t.type?(t.url=e,this.props.onChange(t)):this.props.onChange(void 0)};onKeyDown=e=>{if((this.state.isOmniDropdownOpen||this.state.isTypedHistoryOpen)&&(!this._urlInput.current||!this._urlInput.current.isIMEOpen)){const t=e.ctrlKey,n=e.altKey,i=e.shiftKey,s=XC,o=!t&&n&&!i&&!s,a=!t&&!n&&i&&!s,r=!(t||n||i||s);switch(e.key){case"Escape":e.preventDefault(),e.stopPropagation();break;case"ArrowUp":e.preventDefault(),e.stopPropagation(),o?this._nav.sectionUp().then(this._handleSelectedItemChanged):this._nav.up().then(this._handleSelectedItemChanged);break;case"Tab":r?(e.preventDefault(),e.stopPropagation(),this._nav.down().then(this._handleSelectedItemChanged)):a&&(e.preventDefault(),e.stopPropagation(),this._nav.up().then(this._handleSelectedItemChanged));break;case"ArrowDown":e.preventDefault(),e.stopPropagation(),o?this._nav.sectionDown().then(this._handleSelectedItemChanged):this._nav.down().then(this._handleSelectedItemChanged);break;case"PageUp":this._nav.pageUp().then(this._handleSelectedItemChanged);break;case"PageDown":this._nav.pageDown().then(this._handleSelectedItemChanged);break;case"Backspace":case"Delete":i&&this.state.selectedItem&&this.onOmniDropdownItemDelete(this.state.selectedItem)}}const t="z"===e.key&&!e.shiftKey&&e.ctrlKey;if((0,Bu.Z)(e)||"ArrowRight"!==e.key&&"ArrowLeft"!==e.key&&"End"!==e.key&&"Home"!==e.key)if(t)this._handleUndo(e);else if("ArrowDown"!==e.key)if("ArrowUp"!==e.key);else{0===e.currentTarget.selectionStart&&(e.preventDefault(),this._openOmniDropDown())}else(0,Bu.Z)(e)||this.state.isOmniDropdownOpen||this._openOmniDropDown();else this._saveStateOnKeyEvent(e)};_urlFieldGo=async(e,t)=>{this.props.onSubmit&&(this.blur(),this.revertUrl(e),this.setState({autocompleteData:[]}),this.hideDropdown(),await(this.props.onSubmit?.({url:e,...t?{options:t}:null})),this.#c=!0)};onKeyPress=e=>{this.props.onKeyPress&&this.props.onKeyPress(e)};onDragStart=e=>{if(Lr(e))return;this.#u=!0;e.currentTarget.value===window.getSelection().toString()&&this.props.onUrlDrag&&this.props.onUrlDrag(e)};onDragEnd=()=>{this.#u=!1};onDragEnter=e=>{if(e.stopPropagation(),!this.#u&&this.isDropAllowed(e)){e.preventDefault();const t=e.target;t instanceof HTMLInputElement&&t.classList.add("pseudo-selected")}};onDragOver=e=>{this.isDropAllowed(e)&&e.preventDefault()};onDragLeave=e=>{if(this.#u)return;const t=e.target;t instanceof HTMLInputElement&&t.classList.remove("pseudo-selected")};onDrop=e=>{if(!this.isDropAllowed(e))return;const t=e.target;if(t instanceof HTMLInputElement&&t.classList.remove("pseudo-selected"),"function"==typeof this.props.onDrop)this.#u||(this.props.onDrop(e),e.stopPropagation(),e.preventDefault());else if(this.props.handleDrop){e.stopPropagation(),e.preventDefault();let t="";const n=e.dataTransfer?e.dataTransfer.getData(qC):"";if(n.length>0){const e=n.split("\n");e.length>0&&(t=e[0])}else t=e.dataTransfer?e.dataTransfer.getData(QC):"";this.setUrlfieldState({editUrl:t}),this.focus()}};isDropAllowed=e=>{if(!e?.dataTransfer||e.dataTransfer.types.includes("vivaldi/x-button-toolbar"))return!1;const t=[Jt.yR,qC,QC],n=e.dataTransfer;return!(1===n.types.length&&n.types.includes(QC)&&""===n.getData(QC))&&n.types.some((e=>t.includes(e)))};setDropdownSelectionIndex=e=>{this.setState({dropdownSelectionIndex:e,autocompleteData:[]})};setAutocompleteHighlight=this.setDropdownSelectionIndex;onOmniDropdownItemClicked=(e,t)=>{this.revertUrl(),this.blur(),Of.Z.setUrlfieldState(this.props.pageId,{editUrl:void 0});const n=this.context.vivaldiWindowId;Array.isArray(e.urls)?Of.Z.go(n,e.urls,{...t,inCurrent:!1}):e.url&&("OMNI_TYPE_SEARCH"===e.type?Of.Z.goSearchURL(n,e.url,{...t,incognito:t.incognito||z.ZP.isGuestSession(n)}):Of.Z.go(n,[e.url],{...t,enableSearch:!0})),this.hideDropdown()};_deleteBookmarkItem=e=>{const{id:t}=e;i.Z.remove([t]),this.setState((e=>({bookmarkResults:e.bookmarkResults.filter((e=>e.id!==t)),selectedItem:void 0,dropdownSelectionIndex:-1})))};_deleteHistoryItem=e=>{const t=(0,Ni.K2)(e.url)?e.url:e.id;Of.Z.deleteHistory(t);const{historyResults:n,dropdownSelectionIndex:i,typedHistoryResults:s}=this.state,o=n.filter((t=>t.url!==e.url)),a=s.filter((t=>t.url!==e.url)),r=i>=a.length?i-1:i,l=-1!==i?a[i]:void 0;this.setState({historyResults:o,typedHistoryResults:a,selectedItem:l,dropdownSelectionIndex:r})};onOmniDropdownItemDelete=e=>{if(function(e){return Boolean(e.type)&&e.type.startsWith("OMNI_RESULT_BOOKMARK")}(e)){const t=e;return void this._deleteBookmarkItem(t)}if("OMNI_TYPE_SEARCH"===e.type||"OMNI_RESULT_FOLDER_NICKNAME"===e.type)return;const t=e;this._deleteHistoryItem(t)};isUrlInputFocusedOnMouseDown=()=>{if(!this._urlInput.current)return!1;const e=this._urlInput.current?.refUrlInput.current?.inputField.current;return e===this._focusedOnMouseDown};componentDidUpdate(e,t){if(t.dropdownSelectionIndex!==this.state.dropdownSelectionIndex&&this._nav.setSelectionIndex(this.state.dropdownSelectionIndex),this.state.isTypedHistoryOpen&&!t.isTypedHistoryOpen&&this.focus(),this.props.pageId!==e.pageId&&this._cleanupState(),this.props.stateResetKey!==e.stateResetKey&&this.setState(iS(this.props.pageId)),this.props.displayUrl&&this.props.displayUrl!==e.displayUrl&&0===this.state.typedUrl.length){const e=this._urlInput?.current?.refUrlInput?.current,t=e?.inputField?.current;e&&t&&e.setSelection({selectionStart:0,selectionEnd:t.value.length},"forward")}}getSearchEngine=()=>{if(!this.props.prefValues[D.kAddressBarInlineSearchEnabled]&&!this.props.typedSearchEngine)return;const e=this.props.typedSearchEngine||this.props.defaultSearchEngine,t="OMNI_TYPE_SEARCH";if(!e)return;const n=this.state.typedUrl;return{title:(0,le.Z)("Search $1",[e.name]),type:t,items:[{id:e.id,type:t,displayText:this.props.typedSearchEngine?n.substring(e.keyword.length+1):n,text:n,url:n,disableDelete:!0,disablePatternHighlight:!0,faviconUrl:cn.YvR.medium,faviconType:"img"}]}};_getFormattedOmniDropdownItems=()=>{const e=this.getSearchEngine(),t=this.props.topSites?(0,Af.default)(this.props.topSites.filter((e=>e.title.includes(this.state.typedUrl)||e.url.includes(this.state.typedUrl))).map((e=>({...e,id:e.url,type:"OMNI_RESULT_TOPSITE"}))),5):[],n=this.state.typedHistoryResults.reduce(((e,t)=>(!this.props.prefValues[D.kAddressBarOmniboxShowSearchHistory]&&t.text||e.push({...t,faviconUrl:t.url,faviconType:"favicon"}),e)),[]);return[{type:"OMNI_TYPED_SUGGESTION",items:nS(this.state.typedUrl)},...e?[e]:[],{title:(0,le.Z)("Nickname"),type:"OMNI_RESULT_BOOKMARK_NICKNAME",items:this.state.nicknameResults.map((e=>({...e,disableDelete:!0,faviconUrl:e.url?e.url:"/resources/folder@2x.png",faviconType:e.url?"favicon":"img"})))},{title:(0,le.Z)("Frequently Visited Pages"),type:"OMNI_RESULT_TOPSITE",items:this.props.prefValues[D.kAddressBarOmniboxShowTopSites]?t.map((e=>({...e,faviconUrl:e.url,faviconType:"favicon"}))):[]},{title:(0,le.Z)("Typed History"),type:"OMNI_RESULT_TYPED_HISTORY",items:this.props.prefValues[D.kAddressBarOmniboxShowTypedHistory]&&this.props.prefValues[D.kAddressBarTypedHistoryEnabled]?n:[]},{title:(0,le.Z)("Suggestions"),type:"OMNI_RESULT_SUGGEST",items:this.state.suggestResults},{title:(0,le.Z)("Bookmarks"),type:"OMNI_RESULT_BOOKMARK_UNKNOWN",items:this.props.prefValues[D.kAddressBarOmniboxShowBookmarks]?this.state.bookmarkResults.map((e=>({...e,disableDelete:!0,faviconUrl:e.url,faviconType:"favicon"}))):[]},{title:(0,le.Z)("Browser History"),type:"OMNI_RESULT_HISTORY_UNKNOWN",items:this.props.prefValues[D.kAddressBarOmniboxShowBrowserHistory]?this.state.historyResults.reduce(((e,t)=>this.props.prefValues[D.kAddressBarOmniboxShowSearchHistory]||"OMNI_RESULT_HISTORY_URL"!==t.type?(e.push({...t,faviconUrl:t.url,faviconType:"favicon"}),e):e),[]):[]}]};_getFormattedTypedHistoryItems=()=>{const e=this.props.typedHistory?this.props.typedHistory.reduce(((e,t)=>(!this.props.prefValues[D.kAddressBarOmniboxShowSearchHistory]&&t.text||e.push({displayText:t.text?t.text:t.url,url:t.url,faviconUrl:t.url,faviconType:"favicon"}),e)),[]):[];return[{type:"OMNI_RESULT_TYPED_HISTORY",title:(0,le.Z)("Typed History"),items:e}]};onTypedHistoryItemDelete=e=>{Of.Z.deleteHistory(e.url)};handleSelectedItemChange=e=>{this.setState({selectedItem:e})};renderDropdown=({typedHistoryItems:e,omniDropdownItems:t})=>this.state.isTypedHistoryOpen?(0,fn.jsx)(rf,{ref:this._omniDropdownElement,onSelectedItemChanged:this.handleSelectedItemChange,onNumberOfSelectableItemsChanged:this._nav.setNumberOfSelectableItems,onLinkItemClicked:this.onOmniDropdownItemClicked,items:e,selectionIndex:this.state.dropdownSelectionIndex,onDeleteItem:this.onTypedHistoryItemDelete,onMenuClosed:this.hideDropdown,outsideClickIgnoreClass:"drop-down-menu"}):this.props.prefValues[D.kAddressBarOmniboxEnabled]&&this.state.isOmniDropdownOpen?(0,fn.jsx)(rf,{ref:this._omniDropdownElement,onSelectedItemChanged:this.handleSelectedItemChange,onNumberOfSelectableItemsChanged:this._nav.setNumberOfSelectableItems,onLinkItemClicked:this.onOmniDropdownItemClicked,items:t,selectionIndex:this.state.dropdownSelectionIndex,typedSearchEngine:this.props.typedSearchEngine,defaultSearchEngine:this.props.defaultSearchEngine,onDeleteItem:this.onOmniDropdownItemDelete,pattern:this.state.typedUrl,setAutocompleteHighlight:this.setDropdownSelectionIndex,onMenuClosed:this.hideDropdown,outsideClickIgnoreClass:"drop-down-menu"}):null;handleSubmit=async({autocompletedValue:e,typedValue:t},n)=>{if(n.ctrlKey&&this.props.prefValues[D.kAddressBarAutocompleteSuffixExpansionEnabled]&&this.props.prefValues[D.kAddressBarAutocompleteSuffixExpansionValue])return void await this._urlFieldGo((0,Ni.Ei)(t,this.props.prefValues[D.kAddressBarAutocompleteSuffixExpansionValue]));const i=e,s=this.context.vivaldiWindowId,o=n.shiftKey&&"shift"===this.props.prefValues[D.kAddressBarUrlOpenShortcut]||n.altKey&&"alt"===this.props.prefValues[D.kAddressBarUrlOpenShortcut]||XC,a=o&&n.ctrlKey,r={...(0,ls.Z)(s,{ctrlKey:n.ctrlKey,altKey:n.altKey,shiftKey:n.shiftKey,metaKey:n.metaKey}),inCurrent:!o,inBackground:a,transition:d.Z.historyPrivate.TransitionType.TYPED,fromUrlField:!0,incognito:z.ZP.isIncognitoOrGuest(s)},{selectedItem:l}=this.state;if(l)return"OMNI_RESULT_FOLDER_NICKNAME"===l.type?void Of.Z.go(s,l.urls,{...r,inCurrent:!1}):"OMNI_TYPE_SEARCH"===l.type?void Of.Z.goSearchURL(s,l.url,{inBackground:r.inBackground,inCurrent:r.inCurrent,inNewWindow:r.inNewWindow,incognito:r.incognito||z.ZP.isGuestSession(s),allowOverride:r.allowOverride,transition:r.transition}):void await this._urlFieldGo(l.url,r);if(en.ZP.hasNickname(t)){const{transition:e,fromUrlField:n,...i}=r;return Jt.ZP.open(s,en.ZP.getNicknamed(t,!0),i,!0),this.revertUrl(t),this.blur(),this.hideDropdown(),this.setState({autocompleteData:[]}),void(this.#c=!0)}await this._urlFieldGo(i,r)};onMouseUp=e=>{const{getSelection:t}=this.context,{button:n,currentTarget:i}=e};render(){const e={typedHistoryItems:this._getFormattedTypedHistoryItems(),omniDropdownItems:this._getFormattedOmniDropdownItems()},t=this.props.prefValues[D.kAddressBarShowFullUrl],n=this.props.prefValues[D.kAddressBarHighlightBaseDomain],{value:i}=this.state,s=this.props.onSubmit?(0,_C.gG)(this.props.urlFragments):void 0;return(0,fn.jsxs)(fn.Fragment,{children:[YC("div",{className:mn()("UrlField",{"UrlField--HasEditText":Boolean(this.props.editUrl),"UrlField--IsEmpty":""===this.state.value})},void 0,(0,fn.jsx)(bC,{stateResetKey:this.props.pageId,ref:this._urlInput,autoFocus:this.props.autoFocus,className:this.props.className||"",url:this.props.pageUrl||"",autocompleteOnTitle:Boolean(this.props.autocompleteOnTitle),onSubmit:this.handleSubmit,autocompleteData:this.state.autocompleteData,value:i,onValueChange:this.onValueChange,onAutocompleteValueChange:this.onAutocompleteValueChange,disabled:this.props.disabled?this.props.disabled:void 0,placeholder:this.props.placeholder?this.props.placeholder:void 0,title:this.props.title?this.props.title:void 0,readOnly:this.props.readonly,onBlur:this.onBlur,onFocus:this.onFocus,onSelect:this.onSelected,onClick:this.onClick,onContextMenu:this.onClick,onDragStart:this.onDragStart,onDragEnter:this.onDragEnter,onDragOver:this.onDragOver,onDragLeave:this.onDragLeave,onDragEnd:this.onDragEnd,onDrop:this.onDrop,onKeyPress:this.onKeyPress,onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onKeyDown:this.onKeyDown,onCut:this.onClipboardEvent,onCopy:this.onClipboardEvent,onPaste:this.onPaste}),s&&YC(zC,{windowId:this.context.vivaldiWindowId,urlFragments:s,url:this.props.displayUrl,shouldShowFullUrl:t,onGoToPath:this._urlFieldGo,isClickable:this.state.isMetaKeyPressed,onBaseDomainObscured:this.props.onBaseDomainObscured,shouldHighlightBaseDomain:n})),this.renderDropdown(e)]})}}const oS=(0,fs.Z)(sS,JC);const aS=function(e){if(!e)return"";const{hostname:t}=_i.parse(e);return t&&(e=t),0===e.indexOf("www.")&&(e=e.split("www.")[1]),e.includes("/")&&(e=e.split("/")[0]),e},rS=new class{setActiveWebView(e,t){l.Z.dispatch({actionType:"WEBVIEW_SET_ACTIVE",windowId:e,component:t})}clearIfActive(e,t){l.Z.dispatch({actionType:"WEBVIEW_CLEAR_IF_ACTIVE",windowId:e,component:t})}};var lS,dS=n(91380),cS=n(52345);function hS(e,t,n,i){lS||(lS="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:lS,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class pS extends tn.PureComponent{constructor(e){super(e)}onCloseClicked=()=>{d.Z.infobars.sendButtonAction(this.props.infoBar.tabId,this.props.infoBar.identifier,"dismiss")};onActionClicked=(e,t)=>{t.stopPropagation(),t.preventDefault(),d.Z.infobars.sendButtonAction(this.props.infoBar.tabId,this.props.infoBar.identifier,e)};render(){return hS("div",{className:"page-confirm-info-bar"},void 0,hS("label",{},void 0,this.props.infoBar.messageText),hS("div",{className:"infobar-controls"},void 0,this.props.infoBar.buttons.map((e=>hS("input",{type:"button",value:e.text,title:(0,le.Z)("Select action"),onClick:this.onActionClicked.bind(this,e.action)},e.action))),hS("span",{className:"infobar-close",value:"close",title:(0,le.Z)("Cancel infobar"),onMouseUp:this.onCloseClicked,dangerouslySetInnerHTML:{__html:cn.vyJ}})))}}const uS=pS;var gS;function mS(e,t,n,i){gS||(gS="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:gS,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class vS extends tn.PureComponent{constructor(e){super(e),this.state={infoBars:(0,fa.aV)()}}componentDidMount(){d.Z.infobars.onInfobarCreated.addListener(this._onInfobarCreated),d.Z.infobars.onInfobarRemoved.addListener(this._onInfobarRemoved)}componentWillUnmount(){d.Z.infobars.onInfobarRemoved.removeListener(this._onInfobarRemoved),d.Z.infobars.onInfobarCreated.removeListener(this._onInfobarCreated)}_onInfobarCreated=e=>{this.props.tabId===e.tabId&&this.setState((t=>({infoBars:t.infoBars.insert(0,e)})))};_onInfobarRemoved=(e,t)=>{this.props.tabId===e&&this.setState((e=>({infoBars:e.infoBars.filter((e=>{e.identifier}))})))};render(){return mS(tn.Fragment,{},void 0,this.state.infoBars.map((e=>mS(uS,{infoBar:e},e.identifier))))}}const fS=vS;var yS;function wS(e,t,n,i){yS||(yS="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:yS,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const bS={dialog:"handleOnJavascriptDialog"};class CS extends tn.PureComponent{refWebviewDiv=tn.createRef();refDevTools=tn.createRef();state={dialogParentElement:void 0,customData:void 0};componentDidMount(){this.webview=this.refWebviewDiv.current?.firstChild,this.attachWebviewHandlers()}componentWillUnmount(){this.removeWebviewHandlers()}handleOnJavascriptDialog=e=>{e.preventDefault(),e.dialogtype="javascript",this.showDialog(e)};showDialog=e=>{e.webview=this.webview,this.setState({dialogParentElement:this.refDevTools.current,customData:e})};handleOnCloseDialog=()=>{this.setState({dialogParentElement:null})};attachWebviewHandlers=()=>{Object.keys(bS).forEach((e=>{this.webview&&this.webview.addEventListener(e,this[bS[e]])}))};removeWebviewHandlers=()=>{Object.keys(bS).forEach((e=>{this.webview&&this.webview.removeEventListener(e,this[bS[e]])}))};render(){return"off"!==this.props.dockingState?wS("div",{},void 0,(0,fn.jsx)("section",{ref:this.refDevTools,className:"devtools-content",children:(0,fn.jsx)("div",{ref:this.refWebviewDiv,dangerouslySetInnerHTML:{__html:`<webview name="${String("vivaldi-devtools-"+this.props.dockingState)}"\n                partition="persist:storage"\n                inspect_tab_id="${String(this.props.tabId)}" />`}})}),this.props.active&&this.state.dialogParentElement&&this.state.customData&&wS(_l,{customData:this.state.customData,closeDialog:this.handleOnCloseDialog})):null}}const SS=CS;var TS;function IS(e,t,n,i){TS||(TS="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:TS,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class kS extends tn.PureComponent{static contextType=dn.Z;constructor(e,t){super(e),this.state={show:M.Z.get(D.kShowExtensionsBanner)}}onGoClicked=()=>{Y.Z.openURL(this.context.vivaldiWindowId,"https://vvld.in/chrome-web-store")};onCloseClicked=()=>{this.setState({show:!1}),nt.Z.set(D.kShowExtensionsBanner,!1)};render(){return!this.state.show||this.props.url.indexOf("chrome://extensions")<0?null:IS("div",{className:"vivaldi-extension-banner"},void 0,IS("label",{},void 0,(0,le.Z)("You can install any extension from the Chrome Web Store directly to Vivaldi. Just open the web store and click “Add to Chrome” on your extension of choice.")),IS("div",{className:"controls"},void 0,IS("input",{type:"button",value:(0,le.Z)("Chrome Web Store"),title:(0,le.Z)("Open Chrome Web Store"),onClick:this.onGoClicked}),IS("span",{className:"close",value:"close",title:(0,le.Z)("Close"),onMouseUp:this.onCloseClicked,dangerouslySetInnerHTML:{__html:cn.vyJ}})))}}const AS=kS;var ZS,ES=n(12666);function _S(e,t,n,i){ZS||(ZS="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:ZS,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class NS extends tn.PureComponent{static contextType=dn.Z;constructor(e){super(e),this.state={hitImage:null,justFound:!1,uiZoom:1},d.Z.zoom.getVivaldiUIZoom((e=>{this.setState({uiZoom:e})}))}componentDidUpdate(e){(this.props.selectionRect.top!==e.selectionRect.top||this.props.selectionRect.left!==e.selectionRect.left||this.props.selectionRect.width!==e.selectionRect.width||this.props.selectionRect.height!==e.selectionRect.height)&&this.props.selectionRect.width&&this.props.selectionRect.height&&this._getNewSelectionImage(this.props.selectionRect,this.props.tabId)}_getNewSelectionImage=(e,t)=>{e={left:e.left,top:e.top,width:e.width,height:e.height};if(!qt.Z.getActiveWebView(this.context.vivaldiWindowId))return!1;const n={fullPage:!1,rect:e};d.Z.thumbnails.captureTab(t,n,((e,t)=>{e?this.setState({hitImage:t,justFound:!0}):this.resetJustFound()}))};resetJustFound=()=>{this.setState({justFound:!1})};render(){const e=qt.Z.getActiveWebView(this.context.vivaldiWindowId);if(!this.state.hitImage||!e)return null;const{selectionRect:t,hitOffset:n}=this.props,{uiZoom:i}=this.state,s={position:"absolute",top:parseInt(t.top/i)+n,left:parseInt(t.left/i),width:parseInt(t.width/i),height:parseInt(t.height/i)};return _S(ES.ZP,{in:this.state.justFound,appear:!0,enter:!0,exit:!0,unmountOnExit:!0,onEntered:(e,t)=>this.resetJustFound(),timeout:{appear:200,enter:200,exit:200}},void 0,(e=>_S("img",{src:this.state.hitImage,style:s,className:`fip-active-hit ${e}`})))}}const MS=NS;var PS;function DS(e,t,n,i){PS||(PS="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:PS,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class xS extends tn.PureComponent{static contextType=dn.Z;_isIMEOpen=!1;refFipToolbar=tn.createRef();refInputText=tn.createRef();constructor(e){super(e),this.state=this._getStateFromStores(!1)}componentDidMount(){this.props.isActive&&Hf.Z.addListener(this.onWebpageviewStoreChanged)}componentWillUnmount(){Hf.Z.ensureRemovedListener(this.onWebpageviewStoreChanged)}componentDidUpdate(e){e.isActive!==this.props.isActive&&(this.props.isActive?Hf.Z.addListener(this.onWebpageviewStoreChanged):Hf.Z.removeListener(this.onWebpageviewStoreChanged))}onCompositionStart=()=>{this._isIMEOpen=!0};onCompositionEnd=()=>{this._isIMEOpen=!1,this.onFindInPageTextChanged()};onWebpageviewStoreChanged=e=>{if(e.pageId!==this.props.pageId)return;const t=qt.Z.getActiveWebView(this.context.vivaldiWindowId);if(t){switch(e.type){case"WEBPAGEVIEW_RESULTS_FROM_FIND_IN_PAGE":this.setState(this._getStateFromStores(!0));break;case"WEBPAGEVIEW_ACTIONS":"findInPage"===e.action?this.setState(this._getStateFromStores(!1),this.populateWithPageSelection):"findNextInPage"===e.action?(this.focusFindInPageInput(),this.onNextClicked()):"findPreviousInPage"===e.action&&(this.focusFindInPageInput(),this.onPreviousClicked());break;case"WEBPAGEVIEW_CLOSE_FIND_IN_PAGE":this.setState(this._getStateFromStores(!1));break;case"WEBPAGEVIEW_FOCUS_FIND_IN_PAGE":this.focusFindInPageInput()}if(this.refFipToolbar.current){const e=this.refFipToolbar.current.getBoundingClientRect().height;let n;n="richtexteditor"===t.name||"markdowneditor"===t.name?this.refFipToolbar.current?.parentElement?.parentElement?.getBoundingClientRect()?.height??e:e,this.setState({hitOffset:n})}}};populateWithPageSelection=()=>{d.Z.utilities.getSelectedText(this.props.pageId,(e=>{if(e.length>0){const t=this.refInputText.current;t&&(t.value=e.substring(0,128)),this.onFindInPageTextChanged()}this.focusFindInPageInput()}))};scrollBy=e=>{let t;t=M.Z.get(D.kWebpagesSmoothScrollingEnabled)?e?()=>window.scrollBy({top:window.innerHeight,behavior:"smooth"}):()=>window.scrollBy({top:-window.innerHeight,behavior:"smooth"}):e?()=>window.scrollBy({top:window.innerHeight,behavior:"auto"}):()=>window.scrollBy({top:-window.innerHeight,behavior:"auto"}),y.Z.scripting.executeScript({target:{tabId:this.props.pageId},function:t},(()=>{y.Z.runtime.lastError}))};onKeyDown=e=>{const{ctrlKey:t,altKey:n,shiftKey:i,metaKey:s}=e,o={ctrlKey:t,altKey:n,shiftKey:i,metaKey:s};if(!(0,xr.Mr)(o))switch(e.key){case"PageDown":return void this.scrollBy(!0);case"PageUp":return void this.scrollBy(!1)}"m"===e.key&&(0,xr.Np)(o)&&this.onMatchCaseClicked(),"Enter"===e.key&&((0,xr.Mr)(o)?this.onPreviousClicked():(0,xr.Np)(o)?this.closeAndActivate():this.onNextClicked())};focusFindInPageInput=()=>{const e=this.refInputText.current;e&&(e.focus(),e.value&&e.select())};_getFindInPageText=()=>{const e=this.refInputText.current;return e?e.value:""};onMatchCaseClicked=()=>{this.props.onFindInPage(this._getFindInPageText(),!this.state.matchCase),this.setState((e=>({matchCase:!e.matchCase})))};onPreviousClicked=()=>{this.props.onFindNextInPage(this._getFindInPageText(),!0,this.state.matchCase)};onNextClicked=()=>{this.props.onFindNextInPage(this._getFindInPageText(),!1,this.state.matchCase)};onCloseClicked=()=>{Vg.Z.closeFindInPageToolbar(this.context.vivaldiWindowId,this.props.pageId)};closeAndActivate=()=>{this.onCloseClicked();const e=qt.Z.getActiveWebView(this.context.vivaldiWindowId);e&&e.stopFinding("activate")};onFindInPageTextChanged=()=>{if(this._isIMEOpen)return;const e=this._getFindInPageText();this.state.findInPageText!==e&&(this.setState({findInPageText:e}),this.props.onFindInPage(e,this.state.matchCase))};_getStateFromStores=e=>{const t=Hf.Z.getFindResultsForPage(this.props.pageId);let n={};return n=e?{...this.state,activeMatchOrdinal:t.activeMatchOrdinal,matchCase:t.matchCase||!1,numberOfMatches:t.numberOfMatches,selectionRect:t.selectionRect}:{activeMatchOrdinal:t.activeMatchOrdinal,findInPageText:t.searchText,hitOffset:0,isFindInPageToolbarOpen:t.isFindInPageToolbarOpen,matchCase:t.matchCase,numberOfMatches:t.numberOfMatches,selectionRect:t.selectionRect},n};render(){if(M.Z.get(D.kThemeUseAnimation)){const e=qt.Z.getActiveWebView(this.context.vivaldiWindowId);e&&(0!==this.state.numberOfMatches&&this.state.isFindInPageToolbarOpen?(e.style.transition="filter 100ms",e.style.filter="brightness(95%)"):e.style.filter="brightness(100%)")}return DS("div",{className:"find-in-page-wrapper"},void 0,DS(Wr.Z,{classNames:"find-in-page",in:this.state.isFindInPageToolbarOpen,mountOnEnter:!0,unmountOnExit:!0,timeout:{enter:300,exit:150}},void 0,(0,fn.jsxs)("div",{ref:this.refFipToolbar,onKeyDown:this.onKeyDown,className:mn()("find-in-page","toolbar","toolbar-default",{"fip-nomatches":0===this.state.numberOfMatches&&this.state.findInPageText.length>0}),tabIndex:"-1",children:[DS("span",{className:"fip-input-label"},void 0,(0,le.Z)("Find in Page:")),DS("div",{className:"fip-input-container toolbar toolbar-default"},void 0,(0,fn.jsx)("input",{ref:this.refInputText,type:"search",onChange:this.onFindInPageTextChanged,onCompositionStart:this.onCompositionStart,onCompositionUpdate:this.onCompositionStart,onCompositionEnd:this.onCompositionEnd,defaultValue:this.state.findInPageText}),DS("span",{className:"fip-results",style:{display:this.state.findInPageText.length>0?"inline":"none"}},void 0,(0,le.Z)("$1 of $2",[this.state.activeMatchOrdinal,this.state.numberOfMatches]))),DS("div",{className:"toolbar-group"},void 0,DS(sl,{className:"button-narrow",onClick:this.onPreviousClicked,image:cn.Whf,tooltip:(0,le.Z)("Previous match")}),DS(sl,{className:"button-narrow",onClick:this.onNextClicked,image:cn.ze0,tooltip:(0,le.Z)("Next match")})),DS(sl,{onClick:this.onCloseClicked,image:cn.vyJ,tooltip:(0,le.Z)("Cancel search")}),DS("label",{className:"toolbar-group"},void 0,DS("input",{type:"checkbox",checked:this.state.matchCase,onChange:this.onMatchCaseClicked}),DS("span",{className:"fip-checkbox-label"},void 0,(0,le.Z)("Match Case")))]})),M.Z.get(D.kThemeUseAnimation)&&0!==this.state.numberOfMatches&&DS(MS,{tabId:this.props.pageId,selectionRect:this.state.selectionRect,hitOffset:this.state.hitOffset,hitText:this.state.findInPageText}))}}const OS=xS;var LS=n(93197);const RS=!1,BS={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID"},FS={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"},US={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"},VS={256:"ImageWidth",257:"ImageHeight",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",296:"ResolutionUnit",513:"JpegIFOffset",514:"JpegIFByteCount",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite"},WS={ColorSpace:{0:"Unknown",1:"sRGB",65535:"Adobe RGB / ProPhoto RGB"},ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}};function HS(e){return!!e.exifdata}function zS(e,t){function n(n){var i=function(e){var t=new DataView(e);RS;if(255!==t.getUint8(0)||216!==t.getUint8(1))return!1;var n=2,i=e.byteLength;for(;n<i;){if(255!==t.getUint8(n))return!1;if(225===t.getUint8(n+1))return XS(t,n+4,t.getUint16(n+2));n+=2+t.getUint16(n+2)}}(n),s=function(e){var t=new DataView(e);RS;if(255!==t.getUint8(0)||216!==t.getUint8(1))return!1;var n=2,i=e.byteLength,s=function(e,t){return 56===e.getUint8(t)&&66===e.getUint8(t+1)&&73===e.getUint8(t+2)&&77===e.getUint8(t+3)&&4===e.getUint8(t+4)&&4===e.getUint8(t+5)};for(;n<i;){if(s(t,n)){var o=t.getUint8(n+7);return o%2!=0&&(o+=1),0===o&&(o=4),$S(e,n+8+o,t.getUint16(n+6+o))}n++}}(n),o=function(e){if(!("DOMParser"in self))return;var t=new DataView(e);RS;if(255!==t.getUint8(0)||216!==t.getUint8(1))return!1;var n=2,i=e.byteLength,s=new DOMParser;for(;n<i-4;){if("http"===YS(t,n,4)){var o=n-1,a=t.getUint16(n-2)-1,r=YS(t,o,a),l=r.indexOf("xmpmeta>")+8,d=(r=r.substring(r.indexOf("<x:xmpmeta"),l)).indexOf("x:xmpmeta")+10;return r=r.slice(0,d)+'xmlns:Iptc4xmpCore="http://iptc.org/std/Iptc4xmpCore/1.0/xmlns/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:tiff="http://ns.adobe.com/tiff/1.0/" xmlns:plus="http://schemas.android.com/apk/lib/com.google.android.gms.plus" xmlns:ext="http://www.gettyimages.com/xsltExtension/1.0" xmlns:exif="http://ns.adobe.com/exif/1.0/" xmlns:stEvt="http://ns.adobe.com/xap/1.0/sType/ResourceEvent#" xmlns:stRef="http://ns.adobe.com/xap/1.0/sType/ResourceRef#" xmlns:crs="http://ns.adobe.com/camera-raw-settings/1.0/" xmlns:xapGImg="http://ns.adobe.com/xap/1.0/g/img/" xmlns:Iptc4xmpExt="http://iptc.org/std/Iptc4xmpExt/2008-02-29/" '+r.slice(d),qS(s.parseFromString(r,"text/xml"))}n++}}(n);e.exifdata=i||{},e.iptcdata=s||{},e.xmpdata=o||{},t&&t.call(e)}if(e.src)if(/^data\:/i.test(e.src))n(function(e,t){t=t||e.match(/^data\:([^\;]+)\;base64,/im)[1]||"",e=e.replace(/^data\:([^\;]+)\;base64,/gim,"");for(var n=atob(e),i=n.length,s=new ArrayBuffer(i),o=new Uint8Array(s),a=0;a<i;a++)o[a]=n.charCodeAt(a);return s}(e.src));else if(/^blob\:/i.test(e.src)){const t=new FileReader;t.onload=function(e){n(e.target.result)},function(e,t){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="blob",n.onload=function(e){200!==this.status&&0!==this.status||t(this.response)},n.send()}(e.src,(e=>{t.readAsArrayBuffer(e)}))}else{var i=new XMLHttpRequest;i.onload=function(){if(200!==this.status&&0!==this.status)throw"Could not load image";n(i.response),i=null},i.open("GET",e.src,!0),i.responseType="arraybuffer",i.send(null)}else if(self.FileReader&&(e instanceof self.Blob||e instanceof self.File)){const t=new FileReader;t.onload=function(e){n(e.target.result)},t.readAsArrayBuffer(e)}}const GS={120:"caption",110:"credit",25:"keywords",55:"dateCreated",80:"byline",85:"bylineTitle",122:"captionWriter",105:"headline",116:"copyright",15:"category"};function $S(e,t,n){for(var i,s,o,a,r=new DataView(e),l={},d=t;d<t+n;)28===r.getUint8(d)&&2===r.getUint8(d+1)&&(a=r.getUint8(d+2))in GS&&(o=r.getInt16(d+3),s=GS[a],i=YS(r,d+5,o),l.hasOwnProperty(s)?l[s]instanceof Array?l[s].push(i):l[s]=[l[s],i]:l[s]=i),d++;return l}function KS(e,t,n,i,s){var o,a=e.getUint16(n,!s),r={};for(let l=0;l<a;l++)o=n+12*l+2,r[i[e.getUint16(o,!s)]]=jS(e,o,t,n,s);return r}function jS(e,t,n,i,s){var o,a,r,l,d,c,h=e.getUint16(t+2,!s),p=e.getUint32(t+4,!s),u=e.getUint32(t+8,!s)+n;switch(h){case 1:case 7:if(1===p)return e.getUint8(t+8,!s);o=p>4?u:t+8,a=[];for(let t=0;t<p;t++)a[t]=e.getUint8(o+t);return a;case 2:return YS(e,o=p>4?u:t+8,p-1);case 3:if(1===p)return e.getUint16(t+8,!s);o=p>2?u:t+8,a=[];for(let t=0;t<p;t++)a[t]=e.getUint16(o+2*t,!s);return a;case 4:if(1===p)return e.getUint32(t+8,!s);for(a=[],l=0;l<p;l++)a[l]=e.getUint32(u+4*l,!s);return a;case 5:if(1===p)return d=e.getUint32(u,!s),c=e.getUint32(u+4,!s),(r=new Number(d/c)).numerator=d,r.denominator=c,r;a=[];for(let t=0;t<p;t++)d=e.getUint32(u+8*t,!s),c=e.getUint32(u+4+8*t,!s),a[t]=new Number(d/c),a[t].numerator=d,a[t].denominator=c;return a;case 9:if(1===p)return e.getInt32(t+8,!s);a=[];for(let t=0;t<p;t++)a[t]=e.getInt32(u+4*t,!s);return a;case 10:if(1===p)return e.getInt32(u,!s)/e.getInt32(u+4,!s);a=[];for(let t=0;t<p;t++)a[t]=e.getInt32(u+8*t,!s)/e.getInt32(u+4+8*t,!s);return a}}function YS(e,t,n){var i="";for(let s=t;s<t+n;s++)i+=String.fromCharCode(e.getUint8(s));return i}function XS(e,t){if("Exif"!==YS(e,t,4))return!1;var n,i,s,o,a,r=t+6;if(18761===e.getUint16(r))n=!1;else{if(19789!==e.getUint16(r))return!1;n=!0}if(42!==e.getUint16(r+2,!n))return!1;var l=e.getUint32(r+4,!n);if(l<8)return!1;if((i=KS(e,r,r+l,FS,n)).ExifIFDPointer)for(s in o=KS(e,r,r+i.ExifIFDPointer,BS,n)){switch(s){case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"ColorSpace":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":o[s]=WS[s][o[s]];break;case"LightSource":const e={1:5500,2:3500,3:2700,4:5e3,9:6e3,10:6e3,11:6500,12:7100,13:5400,14:4500,15:3700};i.kelvin=e[o[s]],o[s]=WS[s][o[s]];break;case"ExifVersion":case"FlashpixVersion":o[s]=String.fromCharCode(o[s][0],o[s][1],o[s][2],o[s][3]);break;case"ComponentsConfiguration":o[s]=WS.Components[o[s][0]]+WS.Components[o[s][1]]+WS.Components[o[s][2]]+WS.Components[o[s][3]]}i[s]=o[s]}if(i.GPSInfoIFDPointer)for(s in a=KS(e,r,r+i.GPSInfoIFDPointer,US,n)){if("GPSVersionID"===s)a[s]=a[s][0]+"."+a[s][1]+"."+a[s][2]+"."+a[s][3];i[s]=a[s]}return i.thumbnail=function(e,t,n,i){var s=function(e,t,n){var i=e.getUint16(t,!n);return e.getUint32(t+2+12*i,!n)}(e,t+n,i);if(!s)return{};if(s>e.byteLength)return{};var o=KS(e,t,t+s,VS,i);if(o.Compression)switch(o.Compression){case 6:if(o.JpegIFOffset&&o.JpegIFByteCount){var a=t+o.JpegIFOffset,r=o.JpegIFByteCount;o.blob=new Blob([new Uint8Array(e.buffer,a,r)],{type:"image/jpeg"})}break;case 1:console.log("Thumbnail image format is TIFF, which is not implemented.");break;default:console.log("Unknown thumbnail image format '%s'",o.Compression)}else 2===o.PhotometricInterpretation&&console.log("Thumbnail image format is RGB, which is not implemented.");return o}(e,r,l,n),i}function QS(e){var t={};if(1===e.nodeType){if(e.attributes.length>0){t["@attributes"]={};for(var n=0;n<e.attributes.length;n++){var i=e.attributes.item(n);t["@attributes"][i.nodeName]=i.nodeValue}}}else if(3===e.nodeType)return e.nodeValue;if(e.hasChildNodes())for(var s=0;s<e.childNodes.length;s++){var o=e.childNodes.item(s),a=o.nodeName;if(t[a]){if(!t[a].push){var r=t[a];t[a]=[],t[a].push(r)}t[a].push(QS(o))}else t[a]=QS(o)}return t}function qS(e){try{var t={};if(e.children.length>0)for(var n=0;n<e.children.length;n++){var i=e.children.item(n),s=i.attributes;for(var o in s){var a=s[o],r=a.nodeName,l=a.nodeValue;void 0!==r&&(t[r]=l)}var d=i.nodeName;if(void 0===t[d])t[d]=QS(i);else{if(void 0===t[d].push){var c=t[d];t[d]=[],t[d].push(c)}t[d].push(QS(i))}}else t=e.textContent;return t}catch(e){console.log(e.message)}}const JS={getData:function(e,t){return!1!==e.complete&&(HS(e)?t&&t.call(e):zS(e,t),!0)},getTag:function(e,t){if(HS(e))return e.exifdata[t]},getAllTags:function(e){if(!HS(e))return{};var t,n=e.exifdata,i={};for(t in n)n.hasOwnProperty(t)&&(i[t]=n[t]);return i},pretty:function(e){if(!HS(e))return"";var t,n=e.exifdata,i="";for(t in n)n.hasOwnProperty(t)&&("object"==typeof n[t]?n[t]instanceof Number?i+=t+" : "+n[t]+" ["+n[t].numerator+"/"+n[t].denominator+"]\r\n":i+=t+" : ["+n[t].length+" values]\r\n":i+=t+" : "+n[t]+"\r\n");return i}};var eT;function tT(e,t,n,i){eT||(eT="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:eT,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function nT(e){return`${e[0]}° ${e[1]}' ${e[2]}"`}const iT=function({windowId:e,GPSLatitude:t,GPSLatitudeRef:n,GPSLongitude:i,GPSLongitudeRef:s}){const o=`http://tools.wmflabs.org/geohack/geohack.php?language=en&params=${t.join("_")}_${n}_${i&&i.join("_")}_${s}_`,a=`${nT(t)} ${n},\n            ${nT(i)} ${s}`;return tT("div",{className:"image-metadata-generic"},void 0,tT("h3",{},void 0,(0,le.Z)("Location")),tT("div",{},void 0,tT("a",{onClick:()=>function(e,t){Y.Z.openURL(e,t)}(e,o),href:o,title:(0,le.Z)("Open in GeoHack")},void 0,a)))};var sT;function oT(e,t,n,i){sT||(sT="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:sT,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const aT=function({value:e,name:t}){return oT("div",{className:"image-metadata-generic"},void 0,oT("h3",{},void 0,t),oT("div",{},void 0,e))};var rT,lT=n(19486);function dT(e,t,n,i){rT||(rT="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:rT,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const cT=[D.kKeyboardTabToAll],hT=["0°",(0,le.Z)("Vertical Mirror"),"180°",(0,le.Z)("Horizontal Mirror"),(0,le.Z)("90° Horizontal Mirror"),"270°",(0,le.Z)("270° Vertical Mirror"),"90°"],pT=document.createElement("canvas"),uT=pT.getContext("2d"),gT=document.createElement("canvas"),mT=gT.getContext("2d");class vT extends tn.Component{static contextType=dn.Z;refButtonForTests=tn.createRef();style=lT.Z.convertColorsToVariables(LS.ZP.forTheme(lT.Z.getThemeWithFallback("Vivaldi2")));constructor(e){super(e),this.state={histogramChannels:[],histogramStyle:3,histogramImage:null,height:0,width:0,size:0,data:{},status:0},gT.width=768,gT.height=300,mT.globalCompositeOperation="lighter",mT.lineWidth=1.5,pT.width=600,pT.height=400}componentDidMount(){this.props.open&&this.loadPhoto()}componentDidUpdate(e){this.props.open&&0===this.state.status&&this.loadPhoto()}loadPhoto=()=>{this.props.url?this.setState({status:1},(()=>{const e=this.props.url,t=document.createElement("img"),n=[{fill:Dr()("#f00"),data:[]},{fill:Dr()("#0f0"),data:[]},{fill:Dr()("#00f"),data:[]},{fill:Dr()("#999"),data:[]}],i=n[0],s=n[1],o=n[2],a=n[3];let r,l=0;t.onload=()=>JS.getData(t,(()=>{r&&URL.revokeObjectURL(r);const e=t.width/t.height;let d=pT.width,c=d/e,h=0,p=0;c>pT.height?(c=pT.height,d=c*e,h=(pT.width-d)/2):p=(pT.height-c)/2,uT.clearRect(0,0,pT.width,pT.height),uT.drawImage(t,h,p,d,c);const u=uT.getImageData(0,0,pT.width,pT.height);for(let e=0;e<256;e+=1)i.data[e]=0,s.data[e]=0,o.data[e]=0,a.data[e]=0;const g=u.data.length/256;for(let e=0,t=u.data.length;e<t;e+=4)if(u.data[e+3]>0){const t=u.data[e],n=u.data[e+1],a=u.data[e+2];i.data[t]+=1/g,s.data[n]+=1/g,o.data[a]+=1/g}for(let e=0;e<256;e+=1)a.data[e]=.2126*i.data[e]+.7152*s.data[e]+.0722*o.data[e];this.setState({data:JS.getAllTags(t),histogramChannels:n,height:t.naturalHeight,width:t.naturalWidth,size:l,status:2},this.updateHistogram)})),fetch(e).then((e=>e.blob())).then((e=>{l=e.size,r=URL.createObjectURL(e),t.src=r})).catch((e=>{this.setState({status:3})}))})):this.setState({status:0})};updateHistogram(){let e=[];switch(this.state.histogramStyle){case 0:e=[this.state.histogramChannels[0]];break;case 1:e=[this.state.histogramChannels[1]];break;case 2:e=[this.state.histogramChannels[2]];break;case 4:e=[this.state.histogramChannels[3]];break;case 3:e=[this.state.histogramChannels[0],this.state.histogramChannels[1],this.state.histogramChannels[2]]}mT.clearRect(0,0,gT.width,gT.height),e.forEach((e=>{mT.beginPath(),mT.moveTo(0,gT.height);for(let t=0;t<e.data.length+1;t+=1){const n=Math.round(e.data[t]*gT.height);mT.lineTo(3*t,gT.height-n)}mT.lineTo(gT.width,gT.height),mT.strokeStyle=e.fill.css(),mT.fillStyle=e.fill.alpha(.3).css(),mT.fill(),mT.stroke(),mT.closePath()})),this.setState({histogramImage:gT.toDataURL()})}setHistogramStyle(e){this.setState({histogramStyle:e},this.updateHistogram)}_createClipboardData=()=>this.props.url+"\n\n"+this.state.width+" x "+this.state.height+"\n"+Co(this.state.size)+"\n\n"+JSON.stringify(this.state.data,null,2);copyToClipboard=e=>{if(!(this.state.size&&this.state.width&&this.state.height))return;const t=this._createClipboardData();navigator.clipboard.writeText(t)};render(){if(!this.props.open)return null;const e=this.state.data,t=Object.keys(e).length>0&&e.DateTimeOriginal,n=decodeURI(this.props.url.split("/").pop().split("#")[0].split("?")[0].toString()),i=e.ExposureTime?e.ExposureTime.valueOf():void 0;return dT("div",{className:"image-inspector",style:this.style},void 0,dT("header",{},void 0,dT("h1",{},void 0,n),dT("button",{className:"close no-stroke",title:(0,le.Z)("Close inspector"),onClick:this.props.toggleImageInspector,dangerouslySetInnerHTML:{__html:cn.kze}})),dT("div",{className:"image-inspector-container"},void 0,1===this.state.status&&dT("p",{className:"in-progress"},void 0,(0,le.Z)("Analyzing image...")),3===this.state.status&&dT("p",{},void 0,(0,le.Z)("Unable to analyze image.")),2===this.state.status&&dT("div",{className:"image-inspector-metadata"},void 0,dT("div",{className:"image-histogram"},void 0,dT("img",{className:"histogram",title:(0,le.Z)("Histogram"),src:this.state.histogramImage}),dT("div",{className:"toolbar text"},void 0,dT("button",{tabIndex:this.props.prefValues[D.kKeyboardTabToAll],className:"button-toolbar "+(4===this.state.histogramStyle?"button-selected":""),onClick:this.setHistogramStyle.bind(this,4)},void 0,(0,le.Z)("Brightness")),dT("button",{tabIndex:this.props.prefValues[D.kKeyboardTabToAll],className:"button-toolbar "+(3===this.state.histogramStyle?"button-selected":""),onClick:this.setHistogramStyle.bind(this,3)},void 0,"RGB"),dT("button",{tabIndex:this.props.prefValues[D.kKeyboardTabToAll],className:"button-toolbar "+(0===this.state.histogramStyle?"button-selected":""),onClick:this.setHistogramStyle.bind(this,0)},void 0,"R"),dT("button",{tabIndex:this.props.prefValues[D.kKeyboardTabToAll],className:"button-toolbar "+(1===this.state.histogramStyle?"button-selected":""),onClick:this.setHistogramStyle.bind(this,1)},void 0,"G"),dT("button",{tabIndex:this.props.prefValues[D.kKeyboardTabToAll],className:"button-toolbar "+(2===this.state.histogramStyle?"button-selected":""),onClick:this.setHistogramStyle.bind(this,2)},void 0,"B"))),t&&dT("div",{className:"image-metadata-device"},void 0,dT("span",{className:"image-camera",dangerouslySetInnerHTML:{__html:cn.b0l}}),dT("h3",{},void 0,"Canon"===e.Make?"":e.Make," ",e.Model)),t&&dT("div",{className:"image-metadata-core"},void 0,dT("div",{title:(0,le.Z)("Aperture")},void 0,dT("span",{dangerouslySetInnerHTML:{__html:cn.S1h}}),e.FNumber&&`f/${e.FNumber.valueOf()}`),dT("div",{title:(0,le.Z)("ISO Speed")},void 0,dT("span",{dangerouslySetInnerHTML:{__html:cn.KyY}}),e.ISOSpeedRatings&&e.ISOSpeedRatings),dT("div",{title:(0,le.Z)("Exposure time")},void 0,dT("span",{dangerouslySetInnerHTML:{__html:cn.CKA}}),i&&i<1&&(0,le.Z)("1/$1 second","1/$1 seconds",[Math.round(1/i*100)/100]),i&&i>=1&&(0,le.Z)("$1 second","$1 seconds",[i])),dT("div",{title:(0,le.Z)("Focal length")},void 0,dT("span",{dangerouslySetInnerHTML:{__html:cn.heI}}),(e.FocalLengthIn35mmFilm||e.FocalLength)&&`${e.FocalLengthIn35mmFilm?.valueOf()||e.FocalLength?.valueOf()||0} mm`)),e.WhiteBalance&&dT("div",{className:"image-white-balance"},void 0,dT("h3",{},void 0,(0,le.Z)("White Balance")),e.LightSource&&"Unknown"!==e.LightSource?e.LightSource:e.WhiteBalance,e.kelvin&&dT("div",{className:"image-kelvinscale"},void 0,dT("span",{className:"kelvin-indicator",style:{left:(e.kelvin-2e3)/70+"%"}},void 0,e.kelvin,"K"))),this.state.width&&this.state.height&&dT(aT,{value:this.state.width+" x "+this.state.height+" ("+Math.round(this.state.height*this.state.width/1e5)/10+"MP)",name:(0,le.Z)("Dimensions")}),this.state.size&&dT(aT,{value:Co(this.state.size),name:(0,le.Z)("Size")}),e.ColorSpace&&dT(aT,{value:`${e.ColorSpace}`,name:(0,le.Z)("Color Space")}),e.GPSLatitude&&e.GPSLatitudeRef&&e.GPSLongitude&&e.GPSLongitudeRef&&dT(iT,{windowId:this.context.vivaldiWindowId,GPSLatitude:e.GPSLatitude,GPSLatitudeRef:e.GPSLatitudeRef,GPSLongitude:e.GPSLongitude,GPSLongitudeRef:e.GPSLongitudeRef}),e.Copyright&&""!==e.Copyright.trim()&&dT(aT,{value:e.Copyright,name:(0,le.Z)("Copyright")}),e.DateTimeOriginal&&dT(aT,{value:e.DateTimeOriginal,name:(0,le.Z)("Captured at")}),e.Orientation&&dT(aT,{value:hT[e.Orientation-1],name:(0,le.Z)("Orientation")}),e.Software&&dT(aT,{value:e.Software,name:(0,le.Z)("Software")}),dT("div",{className:"toolbar text alldata-toolbar"},void 0,(0,fn.jsx)("button",{ref:this.refButtonForTests,className:"button-toolbar",tabIndex:this.props.prefValues[D.kKeyboardTabToAll],onClick:this.copyToClipboard,children:(0,le.Z)("Copy Data to Clipboard")})))))}}const fT=(0,fs.Z)(vT,cT);var yT,wT=n(53546);function bT(e,t,n,i){yT||(yT="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:yT,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class CT extends tn.PureComponent{static contextType=dn.Z;state={actionLog:[]};_actionLoggerChanged=e=>{const{actionType:t,...n}=e;let i=`${(new Date).toLocaleString()}: ${t.padEnd(35)}`;if(Object.keys(n).length>0){let e=!1;for(const t in n)try{let s=JSON.stringify(n[t]);if(void 0===s&&(s="undefined"),i.length+s.length>160){e=!0;continue}i+=`${t}: ${s}, `}catch(t){e=!0}e&&(i+="...")}this.setState((e=>{const t=e.actionLog.concat(i);return t.length>500&&t.splice(0,1),{actionLog:t}}))};componentDidMount(){(0,wT.H)(this._actionLoggerChanged)}componentWillUnmount(){(0,wT.H)(void 0)}getContextMenuItems=()=>[{handler:()=>this.setState({actionLog:[]}),...(0,Mn.Z)("Clear")}];onContextMenu=e=>{(0,zi.Z)(this.context.vivaldiWindowId,this.getContextMenuItems())(e)};render(){return bT("div",{className:"actionlog",id:"action_logger",tabIndex:"0",onContextMenu:this.onContextMenu},void 0,bT("textarea",{className:"actionlogs",readOnly:!0,value:this.state.actionLog.join("\n")}))}}const ST=CT;var TT=n(54155),IT=n(56284);function kT(e,t){t.define({element:"kind",fields:{type:TT.Ku.attribute("type"),value:TT.Ku.text()},namespace:"vivaldi:legend",path:"message.kind"})}function AT(e,t){t.define({element:"foo",fields:{type:TT.Ku.attribute("type"),value:TT.Ku.text()},namespace:"http://example.com/p/foo",path:"message.mystanza"}),t.define({path:"client.bareJid"}),e.bareJid=e.config.jid.split("@")[0],e.sendMyStanza=(t,n)=>e.sendMessage({to:t,from:e.config.jid,body:"Foo",mystanza:{type:"bar",value:n}}),e.on("message",(t=>{t.mystanza&&e.emit("mystanza",t)}))}var ZT=n(83216);function ET(e){const{to:t,message:n,toThread:i,threadId:s,kind:o}=e,a=t.includes("conference")?"groupchat":"chat",r=M.Z.get(D.kChatProcessHintNoStore),l={to:t,from:RT.getClient().jid,body:n,type:a,read:!0,delay:{timestamp:new Date},processingHints:{noStore:r},thread:s||"foo",parentThread:i||"bar",kind:{value:o}},d=PT(RT.getClient().jid);!t.includes("conference")&&t!==d&&VT.receivedMessage(l),RT.getClient().sendMessage(l)}function _T(e){return e.split("@")[0]}function NT(e){return{type:"title",name:(0,le.Z)(e)}}function MT(e){return{displayName:e.split("@")[0],type:"conversation",address:e}}function PT(e){return e.split("/")[0]}function DT(e){return"chat"===e.type?_T(e.from):e.from.split("/")[1]}function xT(e){if("groupchat"===e.type&&DT(e)===RT.getClient().bareJid)return;const t=()=>{const e=z.ZP.getId();Dl.ZP.getIsVisible(e,"chat")||Ho.Z.showContent(e,"chat")},n="chat"===e.type,i=n?DT(e):e.from.split("@")[0],s=n?e.body:`${DT(e)}: ${e.body}`;M.Z.get(D.kChatNotifications)&&(0,Ct.c)({title:i||"",body:s||"",icon:"resources/chat_notification_icon.png",requireInteraction:!1,silent:!M.Z.get(D.kChatNotificationsSoundOn),onClick:t})}async function OT(e,t){const n=(0,ZT.Z)(t,{paging:{max:50,before:""}}),i=M.Z.get(D.kChatConversationTimestamps).find((t=>t.name===e));let s;e.includes("conference")?s=await RT.getClient().searchHistory(e,n):(n.with=e,s=await RT.getClient().searchHistory(n));const o=await s.results.filter((e=>e.item.message.body)).map((e=>{const{delay:t}=e.item.message;let n=!1;if(t&&t.timestamp&&i){const e=new Date(t.timestamp);n=i.timestamp>e}return{...e.item.message,read:n}})),{first:a="",last:r=""}=s.paging;return{messages:o,first:a,last:r}}let LT;const RT=new class extends IT.Z{createClient=(e,t,n="https://xmpp.vivaldi.net:5443/bosh",i="wss://xmpp.vivaldi.net:5443/ws")=>{LT=TT.eI({jid:e,password:t,resource:"legend",transports:{websocket:i,bosh:n}}),LT.use(AT),LT.use(kT),LT.on("available",(e=>{"off"!==M.Z.get(D.kChatDebugOutput)&&console.log(e,"available")})),LT.on("auth:failed",(e=>{"off"!==M.Z.get(D.kChatDebugOutput)&&console.log(e,"auth:failed")})),LT.on("auth:success",(e=>{VT.loggingIn(),"off"!==M.Z.get(D.kChatDebugOutput)&&console.log(e,"auth:success")})),LT.on("chat:state",(e=>{if(DT(e)!==LT.bareJid){const t={type:e.chatState,typing:e};this.emitChange(t)}"off"!==M.Z.get(D.kChatDebugOutput)&&console.log(e,"chat:state")})),LT.on("disconnected",(e=>{VT.disconnected(),"off"!==M.Z.get(D.kChatDebugOutput)&&console.log(e,"disconnected")})),LT.on("connected",(e=>{VT.connected(),"off"!==M.Z.get(D.kChatDebugOutput)&&console.log(e,"connected")})),LT.on("raw:outgoing",(e=>{"verbose"===M.Z.get(D.kChatDebugOutput)&&console.log(e)})),LT.on("session:started",(async()=>{await LT.enableCarbons(),LT.sendPresence(),VT.init(),[{type:"conversation",displayName:"Bachelor",address:"bachelor@conference.xmpp.vivaldi.net"},{type:"conversation",displayName:"Feedback",address:"feedback@conference.xmpp.vivaldi.net"},{type:"conversation",displayName:"Random",address:"random@conference.xmpp.vivaldi.net"},{type:"conversation",displayName:"Vivaldi Configs",address:"vivaldi_configs@conference.xmpp.vivaldi.net"}].forEach((e=>{e.address&&LT.joinRoom(e.address,LT.bareJid)})),"off"!==M.Z.get(D.kChatDebugOutput)&&console.log("session started event")})),LT.on("session:end",(()=>{"off"!==M.Z.get(D.kChatDebugOutput)&&console.log("Chat: Got ended")})),LT.on("muc:join",(e=>{"off"!==M.Z.get(D.kChatDebugOutput)&&console.log(e,"joined")})),LT.on("muc:available",(e=>{"off"!==M.Z.get(D.kChatDebugOutput)&&console.log(e,"available")})),LT.on("muc:declined",(e=>{"off"!==M.Z.get(D.kChatDebugOutput)&&console.log(e,"declined")})),LT.on("muc:*",(e=>{"verbose"===M.Z.get(D.kChatDebugOutput)&&console.log(e,"everything muc")})),LT.on("muc:destroyed",(e=>{"off"!==M.Z.get(D.kChatDebugOutput)&&console.log(e,"destroyed")})),LT.on("muc:error",(e=>{"off"!==M.Z.get(D.kChatDebugOutput)&&console.log(e,"error")})),LT.on("muc:failed",(e=>{"off"!==M.Z.get(D.kChatDebugOutput)&&console.log(e,"failed")})),LT.on("muc:invite",(e=>{"off"!==M.Z.get(D.kChatDebugOutput)&&console.log(e,"invite")})),LT.on("muc:leave",(e=>{"off"!==M.Z.get(D.kChatDebugOutput)&&console.log(e,"leave")})),LT.on("muc:other",(e=>{"off"!==M.Z.get(D.kChatDebugOutput)&&console.log(e,"other")})),LT.on("muc:topic",(e=>{"off"!==M.Z.get(D.kChatDebugOutput)&&console.log(e,"muc:topic")})),LT.on("raw:incoming",(e=>{"verbose"===M.Z.get(D.kChatDebugOutput)&&console.log(e,"raw:incoming")})),LT.on("muc:unavailable",(e=>{"off"!==M.Z.get(D.kChatDebugOutput)&&console.log(e,"unavailable")})),LT.on("marker:acknowledged",(e=>{"off"!==M.Z.get(D.kChatDebugOutput)&&console.log(e,"ackMsg")})),LT.on("marker:displayed",(e=>{"off"!==M.Z.get(D.kChatDebugOutput)&&console.log(e,"disMsg")})),LT.on("marker:received",(e=>{"off"!==M.Z.get(D.kChatDebugOutput)&&console.log(e,"recMsg")})),LT.on("chat",(e=>{VT.receivedMessage(e,!0),xT(e),"off"!==M.Z.get(D.kChatDebugOutput)&&console.log(e,"chat")})),LT.on("groupchat",(e=>{VT.receivedMessage(e,!0),xT(e),"off"!==M.Z.get(D.kChatDebugOutput)&&console.log(e,"groupchat")})),LT.on("presence",(e=>{"off"!==M.Z.get(D.kChatDebugOutput)&&console.log(e,"presence")})),LT.on("subscribe",(e=>{LT.acceptSubscription(e.from),"off"!==M.Z.get(D.kChatDebugOutput)&&console.log(e,"subscribe")})),LT.on("sm",(e=>{"verbose"===M.Z.get(D.kChatDebugOutput)&&console.log(e,"sm")})),LT.on("message:error",(e=>{"off"!==M.Z.get(D.kChatDebugOutput)&&console.error(e,"message:error")})),LT.on("stream:management:ack",(e=>{"verbose"===M.Z.get(D.kChatDebugOutput)&&console.log(e,"stream:management:ack")})),LT.on("stanza:acked",(e=>{"verbose"===M.Z.get(D.kChatDebugOutput)&&console.log(e,"stanza:acked")})),LT.on("stanza:failed",(()=>{"off"!==M.Z.get(D.kChatDebugOutput)&&console.error("Message not sent")})),LT.on("stream:data",(e=>{"verbose"===M.Z.get(D.kChatDebugOutput)&&console.log(e,"stream:data")})),LT.on("unavailable",(e=>{"off"!==M.Z.get(D.kChatDebugOutput)&&console.log(e)})),LT.connect()};signOut=()=>{LT.disconnect(),VT.signOut()};getClient=()=>{if(!LT)throw new Error("Client wasn't ready");return LT}};var BT=n(42941);class FT extends Z.Z{getInitialState(){return{messages:new Map,isConnected:!1,isLoggedIn:!1,active:""}}reduce(e,t){switch(t.actionType){case"CHAT_INIT":return{...e,messages:t.messages};case"CHAT_LOG_IN":return{...e,isLoggedIn:!0};case"CHAT_SIGN_OUT":return{...e,isLoggedIn:!1};case"CHAT_HISTORY":case"CHAT_MESSAGE_RECEIVED":case"CHAT_ACTIVITY_ACTION":{const{messages:n}=e;return n.set(t.origin,t.messages),{...e,messages:n}}case"CHAT_CONNECTED":return{...e,isConnected:!0};case"CHAT_DISCONNECTED":return{...e,isConnected:!1};case"CHAT_ACTIVE_ACTION":return{...e,active:t.active}}return e}getMessagesFrom=e=>this.getState().messages.get(e);hasUnreadMessages=e=>{const t=M.Z.get(D.kChatConversationTimestamps).find((t=>t.name===e)),n=this.getState().messages.get(e);if(n){const e=RT.getClient().bareJid;return n.messages.some((n=>{if(!n.delay||!t)return;const i=DT(n),s=new Date(n.delay.timestamp).getTime();return t.timestamp<s&&i!==e}))}return!1};getLastMessageFrom=e=>{const t=this.getMessagesFrom(e);return t?(0,BT.default)(t.messages):""};getActiveConversation=()=>this.getState().active;getSortedConversationByNewest=()=>[...this.getState().messages.entries()].sort(((e,t)=>{const n=(0,BT.default)(e[1].messages),i=(0,BT.default)(t[1].messages);if(!(n&&i&&n.delay&&i.delay))return 1;return new Date(n.delay.timestamp).getTime()<new Date(i.delay.timestamp).getTime()?1:-1})).map((e=>e[0]));getUnreadCount=()=>{const e=M.Z.get(D.kChatConversationTimestamps);let t=0;const n=this.getState(),i=n.active,s=RT.getClient().bareJid;return n.messages.forEach(((n,o)=>{const a=e.find((e=>e.name===o));if(a){n.messages.some((e=>{if(!e.delay)return;const t=new Date(e.delay.timestamp).getTime(),n=DT(e);return a.timestamp<t&&o!==i&&n!==s}))&&t++}})),t}}const UT=new FT,VT=new class{init=()=>{fetch("https://xmpp.vivaldi.net:5555/lastmsgs",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:RT.getClient().bareJid})}).then((e=>e.json())).then((e=>{(e=e.concat([{type:"conversation",displayName:"Bachelor",address:"bachelor@conference.xmpp.vivaldi.net"},{type:"conversation",displayName:"Feedback",address:"feedback@conference.xmpp.vivaldi.net"},{type:"conversation",displayName:"Random",address:"random@conference.xmpp.vivaldi.net"},{type:"conversation",displayName:"Vivaldi Configs",address:"vivaldi_configs@conference.xmpp.vivaldi.net"}])).forEach((async e=>{const t=e.displayName?e.address:`${e.username}@xmpp.vivaldi.net`,n=await OT(t),{messages:i}=UT.getState();i.set(t,n),l.Z.dispatch({actionType:"CHAT_INIT",messages:i})}))}))};receivedMessage=async(e,t=!1)=>{if(!e.body)return;const n=PT(t?e.from:e.to);e.read=!1;const i=UT.getMessagesFrom(n);let s;if(i&&(s={...i,messages:[...i.messages,e]}),!s){s={...await OT(n)}}l.Z.dispatch({actionType:"CHAT_MESSAGE_RECEIVED",origin:n,messages:s})};loggingIn=()=>{l.Z.dispatch({actionType:"CHAT_LOG_IN"})};signOut=()=>{l.Z.dispatch({actionType:"CHAT_SIGN_OUT"})};connected=()=>{l.Z.dispatch({actionType:"CHAT_CONNECTED"})};disconnected=()=>{l.Z.dispatch({actionType:"CHAT_DISCONNECTED"})};getMoreHistory=async e=>{const t=UT.getMessagesFrom(e);if(!t)return;const n=t?t.first:"",i=t?t.messages:[],s={paging:{max:30,before:n}},o=await OT(e,s);if(!o.messages.length||!o.first.length)return;const a={messages:[...o.messages,...i],first:o.first,last:o.last};l.Z.dispatch({actionType:"CHAT_HISTORY",origin:e,messages:a})};updateLastActivity=(e,t)=>{if(!e.length)return;const n=M.Z.get(D.kChatConversationTimestamps),i=n.findIndex((t=>t.name===e));if(-1!==i?n.splice(i,1,{name:e,timestamp:Date.now()}):n.push({name:e,timestamp:Date.now()}),nt.Z.set(D.kChatConversationTimestamps,n),!t.length)return;const s=UT.getMessagesFrom(e);if(!s)return;for(let e=s.messages.findIndex((e=>e.id===t[t.length-1]))-1;e<s.messages.length;e++)s.messages[e].read=!0;l.Z.dispatch({actionType:"CHAT_ACTIVITY_ACTION",origin:e,messages:s})};updateActiveConversation=e=>{l.Z.dispatch({actionType:"CHAT_ACTIVE_ACTION",active:e})}};var WT;function HT(e,t,n,i){WT||(WT="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:WT,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class zT extends tn.Component{render(){const{address:e}=this.props;if(!e)return null;const t=e.substring(0,2);return HT("span",{className:"profile-picture",style:{backgroundColor:"#eee"}},void 0,t.substring(0,1).toUpperCase()+t.substring(1))}}const GT=zT;var $T;function KT(e,t,n,i){$T||($T="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:$T,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var jT=KT("i",{},void 0,"Writing...");class YT extends tn.Component{static contextType=dn.Z;state={isHovered:!1,latestMessage:null,hasUnread:!1};componentDidMount(){UT.addListener(this._chatStoreListener),this._chatStoreListener()}componentWillUnmount(){UT.removeListener(this._chatStoreListener)}didSelectContact=e=>{const{contact:t,didSelectNewRecipient:n,isPanel:i}=this.props,{ctrlKey:s,shiftKey:o,altKey:a,metaKey:r}=e;M.Z.get(D.kChatTabMode)||s||o||a||r?Y.Z.openURL(this.context.vivaldiWindowId,`vivaldi://chat/${t.address}`,{singleton:!0}):i?n(t.address):Y.Z.openURL(this.context.vivaldiWindowId,`vivaldi://chat/${t.address}`,{singleton:!0})};_chatStoreListener=()=>{const{contact:e}=this.props,t=UT.hasUnreadMessages(e.address),n=UT.getLastMessageFrom(e.address);this.setState((e=>({latestMessage:n||e.latestMessage,hasUnread:t})))};onDragStart=e=>{const{contact:t,isDragging:n}=this.props,i=z.ZP.isIncognito(this.context.vivaldiWindowId);Gi(e,`vivaldi://chat/${t.address}`,t.address,i),n(!0)};onDragEnd=e=>{this.props.isDragging(!1)};onMouseEnter=()=>{this.setState({isHovered:!0})};onMouseLeave=()=>{this.setState({isHovered:!1})};removeFromFav=e=>{const{contact:t,removeFav:n}=this.props;e.preventDefault(),e.stopPropagation(),"function"==typeof n&&n(t)};render(){const{contact:e,style:t,isTyping:n,isFav:i}=this.props,{isHovered:s,latestMessage:o,hasUnread:a}=this.state,r=o?o.body:"",l=n&&!a?jT:r;return KT("div",{className:mn()({"chat-contact-row":!0,"chat-contact-row--HasUnread":a}),draggable:!0,onClick:this.didSelectContact,onDragStart:this.onDragStart,onDragEnd:this.onDragEnd,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,style:t},void 0,KT(GT,{address:e.address}),KT("div",{className:"main-info"},void 0,KT("p",{className:"name"},void 0,e.displayName),KT("p",{className:"preview"},void 0,l)),i&&s&&KT("span",{className:"close",title:(0,le.Z)("Close"),tabIndex:"-1",onClick:this.removeFromFav,dangerouslySetInnerHTML:{__html:cn.vyJ}}))}}const XT=YT;var QT,qT=n(75637);function JT(e,t,n,i){QT||(QT="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:QT,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const eI="vivaldi://chat/";var tI=JT("h1",{className:"section-heading"},void 0,"Favorites");class nI extends tn.Component{treeEntries=tn.createRef();state={favorites:M.Z.get(D.kChatFavorites),isDragging:!1,width:0,conversations:[{type:"conversation",displayName:"Bachelor",address:"bachelor@conference.xmpp.vivaldi.net"},{type:"conversation",displayName:"Feedback",address:"feedback@conference.xmpp.vivaldi.net"},{type:"conversation",displayName:"Random",address:"random@conference.xmpp.vivaldi.net"},{type:"conversation",displayName:"Vivaldi Configs",address:"vivaldi_configs@conference.xmpp.vivaldi.net"}]};componentDidUpdate(e,t){this.props.typers&&this.treeEntries&&this.treeEntries.current&&this.treeEntries.current.forceUpdateGrid(),t.favorites!==this.state.favorites&&this._chatStoreListener()}componentDidMount(){UT.addListener(this._chatStoreListener),this._chatStoreListener()}componentWillUnmount(){UT.removeListener(this._chatStoreListener)}_chatStoreListener=()=>{const e=UT.getSortedConversationByNewest(),t=[...M.Z.get(D.kChatFavorites)].map((e=>e.address)),n=(0,qT.Z)(e,t);this.chatSetup(n)};chatSetup=e=>{const t=NT("Rooms"),n=NT("Chats"),i=e.filter((e=>!e.includes("@conference"))).map((e=>MT(e)));i.length&&i.unshift(n);const s=e.filter((e=>e.includes("@conference"))).map((e=>MT(e)));s.length&&s.unshift(t);const o=[...s,...i];this.setState({conversations:o})};onDrop=e=>{e.preventDefault(),e.stopPropagation();let t=e.dataTransfer.getData("text/plain");if(t.includes(eI)){t=t.split(eI)[1];const e={address:t,type:"conversation",displayName:_T(t)};if(this.state.favorites.some((t=>t.address===e.address)))return;!function(e){const t=[...M.Z.get(D.kChatFavorites)];nt.Z.set(D.kChatFavorites,[...t,e])}(e),this.setState((n=>({conversations:[...n.conversations].filter((e=>"title"===e.type||!e.address.includes(t))),favorites:[...n.favorites,e],isDragging:!1})))}else this.setState({isDragging:!1})};onDragOver=e=>{e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="copy"};setDragState=e=>{this.setState({isDragging:e})};setNewRecipient=e=>{this.props.didSelectNewRecipient(e)};removeFav=e=>{this.setState((t=>{const n=[...t.favorites],i=n.findIndex((t=>t.address===e.address));return n.splice(i,1),function(e){const t=[...M.Z.get(D.kChatFavorites)];t.splice(e,1),nt.Z.set(D.kChatFavorites,t)}(i),{favorites:n}}))};onResize=e=>{const{contentRect:t}=e[0];this.setState({width:t.width})};renderItem=e=>{const{index:t,style:n,key:i}=e,s=this.state.conversations[t],{typers:o}=this.props,a=s.address?s.address:"",r=o.get(a),l=(r?r.length:0)>0;switch(s.type){case"title":return JT("h1",{style:n,className:"section-heading"},i,s.name);case"conversation":return JT(XT,{contact:s,style:n,didSelectNewRecipient:this.props.didSelectNewRecipient,isDragging:this.setDragState,isTyping:l,isPanel:this.props.isPanel},i);default:return null}};render(){const{conversations:e,favorites:t,isDragging:n,width:i}=this.state,{isPanel:s}=this.props,o=n||t.length>0;return JT("div",{className:"chat-contacts outerScrollbar"},void 0,o&&tI,JT("div",{className:mn()({"favorites-view":!0,"view-hide":!o,"view-expand":o}),onDragOver:this.onDragOver,onDrop:this.onDrop},void 0,t.map(((e,t)=>JT(XT,{contact:e,didSelectNewRecipient:this.setNewRecipient,isDragging:this.setDragState,isFav:!0,isPanel:s,removeFav:this.removeFav},`${e.displayName}-${t}`)))),JT(ts,{className:"chat-resize-observer",onResize:this.onResize},void 0,(0,fn.jsx)(Vu.aV,{ref:this.treeEntries,height:44*e.length,rowHeight:44,width:i,rowRenderer:this.renderItem,rowCount:e.length})))}}const iI=nI;var sI,oI;function aI(e,t,n,i){sI||(sI="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:sI,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function rI({onDelete:e,onContextMenu:t,item:n,onOpen:i,onDragStart:s,draggable:o}){return aI("div",{className:"AttachmentItem",onDragStart:s?e=>s(e,n):null,draggable:o},void 0,aI("img",{className:"AttachmentItem-Image",src:n.content}),aI("button",{className:"AttachmentItem-DeleteButton",title:(0,le.Z)("Remove attachment"),onClick:()=>e(),tabIndex:"-1"}),aI("button",{className:mn()({"AttachmentItem-ViewOverlayButton":!0,"dragging-enabled":o}),title:(0,le.Z)("View attachment"),onContextMenu:t,onClick:i}))}function lI(e,t,n,i){oI||(oI="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:oI,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const dI=12;class cI extends tn.PureComponent{refSwitchInput=tn.createRef();refSwitchButton=tn.createRef();state={dragging:!1,position:this.props.checked?dI:0};componentDidUpdate(e){e.checked!==this.props.checked&&this.updateButtonPosition()}updateButtonPosition=()=>{this.setState({position:this.props.checked?dI:0})};onChange=e=>{const t=e.target.checked?dI:0;this.setState({position:t}),this.props.onChange&&this.props.onChange(e)};onClick=e=>{this.state.dragging?(e.preventDefault(),this.setState({dragging:!1})):this.toggleSwitch()};toggleSwitch=()=>{const e=new MouseEvent("click",{bubbles:!0,cancelable:!0});this.refSwitchInput.current?.dispatchEvent(e)};cancelEvent=e=>{e.preventDefault()};onPointerMove=e=>{if(1===e.buttons&&this.refSwitchButton.current===document.activeElement){this.state.dragging||this.setState({dragging:!0});const t=this.refSwitchInput.current?.getBoundingClientRect(),n=t?.left??0,i=Math.max(0,Math.min(e.clientX-n-6,dI));this.setState({position:i}),e.target instanceof HTMLElement&&e.target.setPointerCapture(e.pointerId.toString())}};onPointerUp=e=>{if(this.state.dragging){e.target instanceof HTMLElement&&e.target.releasePointerCapture(e.pointerId.toString());const{position:t}=this.state;t>=0&&t<=6?(this.setState({position:0}),this.props.checked&&this.toggleSwitch()):(this.setState({position:dI}),this.props.checked||this.toggleSwitch())}};render(){const{position:e}=this.state;return lI("div",{className:mn()("Switch",{"Switch--Disabled":this.props.disabled})},void 0,(0,fn.jsx)("input",{id:this.props.inputId,ref:this.refSwitchInput,className:"Switch-Input",type:"checkbox",onChange:this.onChange,checked:this.props.checked,disabled:this.props.disabled,value:this.props.value,onPointerDown:this.cancelEvent,tabIndex:this.props.tabIndex}),(0,fn.jsx)("button",{ref:this.refSwitchButton,className:mn()({"Switch-Button":!0,dragging:this.state.dragging}),style:{transform:`translateX(${e}px)`},onPointerMove:this.onPointerMove,onPointerUp:this.onPointerUp,onClick:this.onClick,tabIndex:"-1"}))}}const hI=cI;var pI,uI=n(98767);function gI(e,t,n,i){pI||(pI="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:pI,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const mI=[D.kChatProcessHintNoStore],vI=nt.Z.getEventHandler;class fI extends tn.Component{static contextType=dn.Z;fileInput=tn.createRef();textAreaRef=tn.createRef();state={message:"",files:[]};componentDidMount(){this.focusInputField()}onChangeMessage=e=>{this.setState({message:e.target.value})};focusInputField=()=>{this.textAreaRef&&this.textAreaRef.current&&this.textAreaRef.current.focus()};handleInputKey=e=>{const{message:t,files:n}=this.state;"Enter"!==e.key||e.shiftKey?(this.sendCurrentTyping(),this.sendPausedEvent()):(n.length&&this.uploadFiles(n),t.trim().length&&this._sendMessage(),e.preventDefault())};uploadFiles=e=>{e.map((async e=>{const t=await fetch(e.uploadSlot.upload.url,{method:"put",body:e.file});if(201===t.status){const{to:e}=this.props;this.setState((e=>{const n=[...e.files],i=n.findIndex((e=>e.uploadSlot.download.includes(t.url)));return n.splice(i,1),{files:n}})),ET({to:e,message:t.url,kind:"file"})}}))};sendTypingEvent=e=>{if(M.Z.get(D.kChatTypingIndication)){const t=this.props.to.includes("conference")?"groupchat":"chat";RT.getClient().sendMessage({to:this.props.to,type:t,chatState:e})}};sendCurrentTyping=(0,Kf.default)((()=>this.sendTypingEvent("composing")),750);sendPausedEvent=(0,Zr.Z)((()=>this.sendTypingEvent("paused")),1500);_sendMessage=async()=>{const{message:e}=this.state,{to:t}=this.props;ET({to:t,message:e,kind:"text"}),this.setState({message:"",files:[]}),this.sendTypingEvent("paused")};handleClick=()=>{this.fileInput.current&&this.fileInput.current.click()};_testImage=async e=>{const t=[...this.state.files],n=Promise.all((0,uI.default)(e.target.files).map((async e=>({...await this._processFiles(e)}))));this.setState({files:[...t,...await n]},(()=>{this.focusInputField()}))};_processFiles=async e=>({content:await Fs.Z.readFileAsDataURL(e),uploadSlot:await RT.getClient().getUploadSlot("upload.xmpp.vivaldi.net",{name:e.name,size:e.size,mediaType:e.type}),file:e,uploaded:!1});onPaste=async e=>{const{files:t}=e.clipboardData;if(t.length){e.preventDefault(),e.stopPropagation();const n=[...this.state.files],i=await this._processFiles(t[0]);this.setState({files:[...n,i]})}};onDrop=async e=>{e.preventDefault(),e.stopPropagation();const{files:t}=e.dataTransfer;if(t.length){const e=[...this.state.files],n=await this._processFiles(t[0]);this.setState({files:[...e,n]})}};onDragOver=e=>{e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="copy"};deleteItem=e=>{this.setState((t=>{const n=t.files;return n.splice(e,1),{files:n}}))};_openFile=(e,t)=>{let n={inCurrent:!1};e&&(n=(0,ls.Z)(this.context.vivaldiWindowId,{ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey})),Y.Z.openURL(this.context.vivaldiWindowId,t.content,{...n})};render(){const{files:e,message:t}=this.state,n=!t.length&&!e.length;return gI("div",{className:"input-view",onDragOver:this.onDragOver,onDrop:this.onDrop},void 0,gI("div",{className:"NotesAttachments"},void 0,e.length?e.map(((e,t)=>gI(rI,{onDelete:()=>this.deleteItem(t),onContextMenu:()=>{},onOpen:t=>this._openFile(t,e),item:e,draggable:!1},t))):null),(0,fn.jsx)("textarea",{ref:this.textAreaRef,className:"chat-text-input",onChange:this.onChangeMessage,onKeyDown:this.handleInputKey,onPaste:this.onPaste,placeholder:(0,le.Z)("Type message..."),value:t}),gI("div",{className:"toolbar toolbar-default composing-toolbar"},void 0,gI(sl,{className:"primary send-button",tooltip:(0,le.Z)("Send"),onClick:this._sendMessage,disabled:n,image:cn.yt5.medium}),gI("label",{className:"button-toolbar",title:(0,le.Z)("Attach new file...")},void 0,(0,fn.jsx)("input",{ref:this.fileInput,type:"file",style:{display:"none"},accept:"image/*,text/plain,.pdf",multiple:!0,onChange:e=>this._testImage(e)}),gI("button",{onClick:this.handleClick},void 0,gI("div",{style:{display:"contents"},dangerouslySetInnerHTML:{__html:cn.onv}}))),gI("label",{className:"incognito-switch"},void 0,gI(hI,{value:"system",checked:this.props.prefValues[D.kChatProcessHintNoStore],onChange:vI(D.kChatProcessHintNoStore)}),gI("span",{},void 0,(0,le.Z)("Incognito")))))}}const yI=(0,fs.Z)(fI,mI);var wI;function bI(e,t,n,i){wI||(wI="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:wI,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class CI extends tn.PureComponent{static contextType=dn.Z;state={isHovered:!1,data:null};textToHtml=e=>(0,Cc.sanitize)(ve(e.replace("\n","<br />")),{FORBID_TAGS:["style"]});handleLinkClick=e=>{const t=e.target.closest("a");if(!t)return;const n=this.context.vivaldiWindowId,i=(0,ls.Z)(n,{ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey,button:e.button});Y.Z.openURL(n,t.href,{...i})};onMouseEnter=()=>{this.setState({isHovered:!0})};onMouseLeave=()=>{this.setState({isHovered:!1})};compressImageFile(e){const t="image/png",n=document.createElement("canvas"),i=new Image;i.src=e;const s=n.getContext("2d");i.onload=()=>{const e=Math.min(200/i.width,200/i.height),o=Math.floor(i.width*e),a=Math.floor(i.height*e);n.width=o,n.height=a,s.imageSmoothingEnabled=!1,s.drawImage(i,0,0,o,a);const r=n.toDataURL(t,.66);this.setState((()=>({data:{base:r,width:o,height:a}})))},i.onerror=e=>{console.log("Image loading failed",e)}}renderImage=()=>{const{msg:e}=this.props,{data:t}=this.state;t||this.compressImageFile(e.body);const n=t?t.base:e.body;return bI("img",{height:t?t.height:200,src:n,width:t?t.width:null,className:"image-preview",draggable:!0,alt:"",onClick:()=>Y.Z.openURL(this.context.vivaldiWindowId,e.body)})};render(){const{index:e,msg:t,style:n,prevMsg:i}=this.props,{isHovered:s}=this.state,{body:o}=t,a=DT(t),r=DT(i),l=t.delay?b().utc(t.delay.timestamp).local().format("HH:mm:ss (YYYY-MM-DD)"):"",d=t.delay?b().utc(t.delay.timestamp).local().format("HH:mm"):"",c=s?l:d,h=t.processingHints&&t.processingHints.noStore,p=r!==a||0===e;return bI("div",{className:mn()({"chat-message":!0,"no-store":h}),style:n,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},void 0,p&&(0,fn.jsxs)(fn.Fragment,{children:[bI(GT,{address:DT(t)}),bI("p",{className:"from"},void 0,a)]}),bI("div",{className:"main-section"},void 0,bI("p",{className:"timestamp"},void 0,c),"file"===t.kind?.value?this.renderImage():bI("span",{onClick:this.handleLinkClick,className:"message-content",dangerouslySetInnerHTML:{__html:this.textToHtml(o)}})))}}const SI=CI;var TI,II=n(29940),kI=n(96405);function AI(e,t,n,i){TI||(TI="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:TI,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var ZI=AI("img",{src:"/resources/room-default.png",className:"empty-state-icon",alt:""}),EI=AI("h1",{},void 0,"No messages");class _I extends tn.Component{treeEntries=tn.createRef();startIndex=0;endIndex=0;_cellCache=new II.t1({defaultHeight:50,minHeight:30,fixedWidth:!0});constructor(e){super(e),this.state={height:0,width:0,bottomOffset:0,seenMessages:[],activeMessageId:""}}componentDidUpdate(e,t){if(e.messages!==this.props.messages)if(0===e.messages.length||t.bottomOffset<=150)this.focusLastMessage();else if(this.treeEntries.current){const e=this.props.messages.findIndex((e=>e.id===t.activeMessageId));this.treeEntries.current.scrollToRow(e),this._recalculateRowHeights()}t.width!==this.state.width&&this._recalculateRowHeights()}componentWillUnmount(){VT.updateLastActivity(this.props.to,this.state.seenMessages)}shouldComponentUpdate(e,t){return!(0,Sm.default)(this.state,t)||(!(0,Sm.default)(e.messages,this.props.messages)||this.props.to!==e.to)}focusLastMessage=()=>{this.treeEntries.current&&this.treeEntries.current.scrollToRow(this.props.messages.length)};clearSeenMessages=()=>{this.setState({seenMessages:[]})};rerenderVisibleTreeItems=()=>{this.treeEntries.current&&(this.treeEntries.current.forceUpdateGrid(),this.focusLastMessage())};loadMoreHistory=()=>{VT.getMoreHistory(this.props.to)};onResize=e=>{const{contentRect:t}=e[0];this.setState({width:t.width,height:t.height})};_recalculateRowHeights=()=>{this._cellCache.clearAll(),this.treeEntries&&this.treeEntries.current&&this.treeEntries.current.recomputeRowHeights()};addMessageToSeen=e=>{const{seenMessages:t}=this.state,n=e.filter((e=>!1===e.read)).map((e=>e.id)),i=(0,kI.Z)([...t,...n]);i.length>t.length&&this.setState({seenMessages:i})};_onIndexChanged=e=>{const{messages:t}=this.props;if(0===e.startIndex)return;e.startIndex<=Math.floor(t.length/4)&&this.loadMoreHistory(),this.addMessageToSeen(t.slice(e.startIndex));const n=t[e.stopIndex].id;this.setState({activeMessageId:n}),this.startIndex=e.startIndex,this.endIndex=e.stopIndex};setScrollPosition=e=>{const t=e.target;t instanceof HTMLElement&&this.setState({bottomOffset:t.scrollHeight-(t.scrollTop+t.clientHeight)})};renderEmptyState=()=>{const{to:e}=this.props;if(e)return AI("div",{className:"empty-state-no-messages"},void 0,ZI,EI,AI("p",{},void 0,"This is your first conversation with ",e))};renderMessageItem=e=>{const{messages:t}=this.props,{index:n,parent:i,style:s,key:o}=e,a=t[n],r=0===n?t[n]:t[n-1];var l=AI(SI,{style:s,index:n,msg:a,prevMsg:r});return AI(II.Z8,{cache:this._cellCache,columnIndex:0,parent:i,rowIndex:n},o,(()=>l))};render(){const{messages:e}=this.props,{height:t,width:n}=this.state,i=t<300?1e3:t;return(0,fn.jsx)(fn.Fragment,{children:AI(ts,{className:"chat-resize-observer outerScrollbar",onScroll:this.setScrollPosition,onResize:this.onResize},void 0,(0,fn.jsx)(Vu.aV,{ref:this.treeEntries,deferredMeasurementCache:this._cellCache,className:"messages-list",height:i,onRowsRendered:this._onIndexChanged,rowHeight:this._cellCache.rowHeight,overscanRowCount:25,noRowsRenderer:this.renderEmptyState,width:n,rowRenderer:this.renderMessageItem,rowCount:e.length}))})}}const NI=_I;var MI;function PI(e,t,n,i){MI||(MI="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:MI,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class DI extends tn.PureComponent{state={editorHeight:160,messages:[]};componentDidMount(){UT.addListener(this._chatStoreListener),this._chatStoreListener()}componentWillUnmount(){UT.removeListener(this._chatStoreListener)}componentDidUpdate(e){const{to:t}=this.props;e.to!==t&&this._chatStoreListener()}_chatStoreListener=()=>{const e=UT.getMessagesFrom(this.props.to);e?this.setState({messages:e.messages}):VT.getMoreHistory(this.props.to)};onSlidebarPosition=(e,t)=>{this.setState((e=>({editorHeight:Math.max(Math.min(e.editorHeight-t,260),0)})))};onSlideBarStop=()=>{this.setState((e=>({editorHeight:e.editorHeight})))};renderTypers(){const{typers:e}=this.props;return e?function(e){const t=e.map((e=>e.author));if(t.length>=5)return"Many people are typing.";if(t.length<=4&&t.length>2){const e=t.map(((e,t,n)=>4===n.length?t<=2?`${e},`:e:t<=1?`${e},`:e)),n=e.filter((e=>e.includes(",")));return e.splice(n.length,0,"and"),e.join(" ")+" are typing."}return 2===t.length?t.join(" and ")+" are typing.":1===t.length?t.join("")+" is typing.":void 0}(e):null}render(){const{editorHeight:e,messages:t}=this.state,{to:n}=this.props;return(0,fn.jsxs)(fn.Fragment,{children:[PI("section",{},void 0,PI(NI,{messages:t,to:n})),PI("section",{className:"chat-input–view",style:{flexBasis:e}},void 0,PI(gu,{onSlidebarPosition:this.onSlidebarPosition,onStop:this.onSlideBarStop,position:"bottom",returnOffset:!0}),PI(yI,{to:n}),PI("div",{className:"typing-indicator"},void 0,PI("span",{},void 0,this.renderTypers())))]})}}const xI=DI;var OI;function LI(e,t,n,i){OI||(OI="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:OI,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var RI=LI("h1",{className:"heading"},void 0,"Vivaldi Chat");class BI extends tn.Component{static contextType=dn.Z;state={jid:"",password:""};jidInputChange=e=>{this.setState({jid:e.target.value})};passwordInputChange=e=>{this.setState({password:e.target.value})};keyChange=e=>{"Enter"===e.key&&this.login()};login=()=>{const{jid:e,password:t}=this.state,n=e.trim();n.length&&t.length&&RT.createClient(n,t)};openProductPage=()=>{Y.Z.openURL(this.context.vivaldiWindowId,"https://vivaldi.com")};render(){const{jid:e,password:t}=this.state,n=e.trim().length&&t.trim().length;return(0,fn.jsx)(fn.Fragment,{children:LI("div",{className:"chat-onboarding outerScrollbar"},void 0,LI("div",{className:"info-section"},void 0,LI("span",{className:"chat-icon",dangerouslySetInnerHTML:{__html:cn.zLp.small}}),RI,LI("p",{className:"onboarding-pitch"},void 0,(0,le.Z)("Private and lightning fast messaging with friends and groups."))),LI("div",{className:"login-container"},void 0,LI("input",{className:"login-input",placeholder:"user@xmpp.vivaldi.net",onChange:this.jidInputChange,onKeyDown:this.keyChange,type:"text",value:e}),LI("input",{className:"login-input",placeholder:(0,le.Z)("Password"),onChange:this.passwordInputChange,onKeyDown:this.keyChange,type:"password",value:t}),LI("input",{className:"login-input login-button",type:"button",disabled:!n,onClick:this.login,value:(0,le.Z)("Sign In")})),LI("a",{href:"",className:"chat-read-more-link",onClick:this.openProductPage,title:(0,le.Z)("Read more about Vivaldi Chat")},void 0,(0,le.Z)("Learn More")))})}}const FI=BI;var UI;function VI(e,t,n,i){UI||(UI="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:UI,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class WI extends tn.Component{state={description:"Description and member list is coming soon."};addPanel=()=>{Hs.Z.addByUrl(`vivaldi://chat/${this.props.to}`)};render(){const{description:e}=this.state,{to:t}=this.props;return VI("div",{className:"conversation-detail"},void 0,VI("h1",{},void 0,t),VI("p",{},void 0,e),VI("input",{type:"button",onClick:this.addPanel,value:(0,le.Z)("Add Panel")}))}}const HI=WI;var zI;function GI(e,t,n,i){zI||(zI="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:zI,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class $I extends tn.PureComponent{searchField=tn.createRef();state={error:"",to:""};componentDidMount(){this.focusInputField()}focusInputField=()=>{this.searchField&&this.searchField.current&&this.searchField.current.focus()};inputDidChange=e=>{this.setState({error:"",to:e.target.value})};newConversation=()=>{const{to:e}=this.state;if(e.includes("@"))e.includes("@conference")&&RT.getClient().joinRoom(e,RT.getClient().bareJid),this.props.setNewConversation(e.trim()),this.props.onRequestClose();else{const e=(0,le.Z)("Please enter a valid XMPP address");this.setState({error:e})}};render(){const{error:e,to:t}=this.state;return GI("div",{className:"chat-new-conversation"},void 0,GI("h1",{},void 0,(0,le.Z)("New Chat")),GI("p",{},void 0,(0,le.Z)("Find people from the Vivaldi.net community. XMPP addresses from other services are also welcome.")),GI("form",{className:"input-form",onSubmit:this.newConversation},void 0,(0,fn.jsx)("input",{type:"text",placeholder:"user@vivaldi.net",ref:this.searchField,onChange:this.inputDidChange,value:t}),GI("input",{type:"button",className:"primary",disabled:!t.length,value:(0,le.Z)("Start Conversation"),onClick:this.newConversation})),e&&GI("p",{className:"validation-error"},void 0,e))}}const KI=$I;var jI;function YI(e,t,n,i){jI||(jI="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:jI,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var XI=YI(FI,{});class QI extends tn.Component{state={displayConversationDetail:!1,displayCreateConversation:!1,isConnected:!1,isLoggedIn:!1,isPopupOpen:!1,to:this.props.initialTo,typers:new Map};componentDidMount(){RT.addListener(this._chatChangeListener),b().locale(F.ZP.fixMomentLocale(y.Z.i18n.getUILanguage())),UT.addListener(this.chatStoreListener),this.chatStoreListener(),this.guardTypingFromDroppedConnections()}componentWillUnmount(){RT.removeListener(this._chatChangeListener),UT.removeListener(this.chatStoreListener),clearInterval(this.guardInterval)}chatStoreListener=()=>{const e=UT.getState();this.setState({isConnected:e.isConnected,isLoggedIn:e.isLoggedIn})};_chatChangeListener=e=>{if(e.typing&&e.typing.from)switch(e.type){case"composing":this.processComposingType(e.typing);break;case"paused":this.processPausedType(e.typing)}};processComposingType=e=>{const{typers:t}=this.state,n=PT(e.from),i=DT(e),s=t.get(n);if(s){const e=[...s],o=e.findIndex((e=>e.author===i));-1!==o?e[o].time=Date.now():e.push({author:i,time:Date.now()}),t.set(n,e)}else{const e=[{author:i,time:Date.now()}];t.set(n,e)}this.setState({typers:t})};processPausedType=e=>{const{typers:t}=this.state,n=PT(e.from),i=DT(e),s=t.get(n);if(s&&s.length>1){const e=[...s],o=e.findIndex((e=>e.author===i));e.splice(o,1),t.set(n,e)}else t.delete(n);this.setState({typers:t})};guardTypingFromDroppedConnections=()=>{this.guardInterval=setInterval((()=>{const{typers:e}=this.state;e.size&&Array.from(e.values()).forEach((t=>{t.forEach(((t,n,i)=>{t.time<=Date.now()-2e3&&(i.splice(n,1),this.setState({typers:e}))}))}))}),15e3)};connect=()=>{RT.getClient().connect()};navigateBack=()=>{this.setNewRecipient("")};setNewRecipient=e=>{VT.updateActiveConversation(e),this.setState({to:e})};toggleNewConversation=()=>{this.setState((e=>({displayCreateConversation:!e.displayCreateConversation})))};toggleConversationDetail=()=>{this.setState((e=>({displayConversationDetail:!e.displayConversationDetail})))};renderMainView=()=>{const{isLoggedIn:e,to:t,typers:n}=this.state,i=t&&t.length;return(0,fn.jsxs)(fn.Fragment,{children:[!e&&XI,e&&!i&&YI(iI,{didSelectNewRecipient:this.setNewRecipient,isPanel:!0,typers:n}),e&&i&&YI(xI,{to:t,typers:n.get(t)})]})};togglePopup=()=>{this.setState((e=>({isPopupOpen:!e.isPopupOpen})))};hidePopup=()=>{this.state.isPopupOpen&&this.setState({isPopupOpen:!1})};render(){const{displayConversationDetail:e,displayCreateConversation:t,isConnected:n,isLoggedIn:i,isPopupOpen:s,to:o}=this.state,a=o.length>0&&i?_T(o):"Chat";return(0,fn.jsxs)(fn.Fragment,{children:[YI("header",{},void 0,YI(Rp,{title:(0,le.Z)(a)}),i&&YI("div",{className:"toolbar toolbar-default"},void 0,o.length>0&&!M.Z.get(D.kChatTabMode)&&(0,fn.jsxs)(fn.Fragment,{children:[YI(sl,{className:"button-toolbar",onClick:this.navigateBack,image:cn.eFz.medium,title:"Back",tooltip:(0,le.Z)("Back to Contacts")}),YI(sl,{className:"button-toolbar",onClick:this.toggleConversationDetail,title:"Info",tooltip:(0,le.Z)("Info")})]}),!o.length&&(0,fn.jsxs)(fn.Fragment,{children:[YI(sl,{className:"button-toolbar",onClick:this.toggleNewConversation,image:cn.md4.small,title:(0,le.Z)("New"),tooltip:(0,le.Z)("Create new conversation")}),YI(sl,{className:"button-toolbar",onClick:this.togglePopup,title:(0,le.Z)("Profile"),tooltip:(0,le.Z)("View Profile info"),hidePopup:this.hidePopup,isPopupVisible:s,popupClassName:"ChatProfilePopup ToolbarButtonPopup-DefaultStyles",popupPosition:"below",popupWidth:180},void 0,(0,fn.jsxs)(fn.Fragment,{children:[YI("h1",{},void 0,RT.getClient().bareJid),YI("p",{},void 0,PT(RT.getClient().jid))]}))]}),!n&&YI("span",{className:"chat-connection-status",onClick:this.connect},void 0,(0,le.Z)("Disconnected️")))),this.renderMainView(),e&&YI(ln.Z,{onRequestClose:this.toggleConversationDetail,viewMode:"slide"},void 0,YI(HI,{to:o})),t&&YI(ln.Z,{onRequestClose:this.toggleNewConversation,viewMode:"slide"},void 0,YI(KI,{onRequestClose:this.toggleNewConversation,setNewConversation:this.setNewRecipient}))]})}}const qI=QI;var JI;function ek(e,t,n,i){JI||(JI="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:JI,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function tk({enabled:e,locked:t,fullName:n,description:i,onValueChange:s}){return ek("div",{className:"setting-single"},void 0,ek("label",{},void 0,ek("input",{type:"checkbox",checked:e,disabled:t,onChange:({currentTarget:e})=>s(e.checked)}),ek("span",{},void 0,n)),ek("p",{className:"info"},void 0,i))}var nk,ik=n(16716);function sk(e,t,n,i){nk||(nk="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:nk,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var ok=sk("br",{});function ak(){return sk("div",{className:"Experiments-Caution"},void 0,(0,le.Z)("These experimental features may change, break, disappear, not work as intended or at all."),ok,(0,le.Z)("Please proceed with caution."))}var rk,lk=sk(ak,{});class dk extends tn.PureComponent{state={experiments:ik.Z.getFlags()};_handleChange=(e,t)=>{ik.Z.enableFeature(e,t).then((()=>this.setState({experiments:ik.Z.getFlags()})))};render(){return sk("div",{className:"Experiments vivaldi-settings",tabIndex:"0"},void 0,sk("h2",{className:"Experiments-Header"},void 0,(0,le.Z)("Experimental features")),lk,sk("div",{className:"setting-subgroup"},void 0,this.state.experiments.map((e=>sk(tk,{fullName:e.friendlyName,description:e.description,locked:e.locked,enabled:e.value,onValueChange:this._handleChange.bind(null,e.name)},e.name)))))}}function ck(e,t,n,i){rk||(rk="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:rk,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const hk="https://vvld.in/guest";function pk(e,t){t.preventDefault(),Y.Z.openURL(e,hk,{inCurrent:!1,inBackground:!1})}var uk=ck("svg",{className:"guest-intro-background",viewBox:"0 0 1244 860"},void 0,ck("path",{fill:"url(#guest-intro-bg-gradient)",d:"M0 0h153.513c16.141 27.93 32.15 55.734 47.912 83.11 16.086 27.94 32.722 56.832 49.076 85.128 11.01 19.031 22.079 38.316 32.781 56.967 25.186 43.883 51.228 89.259 77.402 132.848 33.382 55.651 75.894 82.121 137.77 85.829 3.205.192 6.454.288 9.655.288 39.673 0 78.14-14.461 108.316-40.722 21.644-18.834 48.687-52.291 54.604-104.667.749-6.654 1.357-13.708 1.855-19.573-1.07-29.74-6.476-52.92-17.294-74.518C622.935 139.46 612.708 67.99 625.087 0h136.676C747.1 44.93 749.845 96.364 774.32 145.251c20.839 41.6 30.654 85.7 31.485 138.023-.568 6.192-1.472 18.273-2.83 30.356-17.572 155.524-149.172 263.318-294.866 263.318-5.816 0-11.67-.173-17.526-.521C382.84 569.97 301.9 518.174 246.822 426.358c-38.015-63.313-74.255-127.68-111.253-191.634C90.359 156.507 45.49 78.062 0 0zm1113.47 0H1244v140.1c-7.496 27.86-18.849 54.995-34.031 81.275a1299530.57 1299530.57 0 0 1-170.255 294.799A1223193.145 1223193.145 0 0 0 841.018 860.24H687.72c135.675-235.123 271.527-470.147 407.26-705.25 22.311-38.621 31.22-79.696 25.368-124.548A170.12 170.12 0 0 0 1113.471 0z"}));class gk extends tn.Component{static contextType=dn.Z;render(){return ck("div",{className:"guest-intro"},void 0,uk,ck("div",{className:"guest-intro-content"},void 0,ck("h1",{},void 0,(0,le.Z)("title","Guest Profile")),ck("span",{className:"guest-intro-icon",dangerouslySetInnerHTML:{__html:cn.LaO.medium}}),ck("p",{},void 0,(0,le.Z)("Browsing with a Guest profile means that searches, sites visited, cookies, and temporary files won’t be stored by Vivaldi. It does not encrypt or otherwise modify your connection.")),ck("p",{},void 0,ck("a",{tabIndex:0,href:hk,onClick:e=>pk(this.context.vivaldiWindowId,e)},void 0,(0,le.Z)("Learn more about Guest Profiles")))))}}const mk=gk;var vk;function fk(e,t,n,i){vk||(vk="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:vk,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class yk extends tn.Component{onRequestClose=()=>{this.props.onRequestClose?this.props.onRequestClose():this.props.onClose(!1)};onClose=()=>{this.props.onClose(!1)};onConfirmed=()=>{this.props.onClose(!0)};render(){return fk(ln.Z,{viewMode:"slide",dialogWidth:this.props.dialogWidth||400,onRequestClose:this.onRequestClose},void 0,fk("header",{className:"dialog-header"},void 0,fk("h1",{className:"dialog-title"},void 0,this.props.title)),fk("div",{className:"dialog-content",tabIndex:this.props.danger?"0":null},void 0,this.props.prompt.map((e=>fk("p",{},e,e)))),fk("footer",{className:"dialog-footer"},void 0,fk("input",{type:"submit",className:this.props.danger?"danger":null,value:this.props.positive,onClick:this.onConfirmed,autoFocus:!this.props.danger}),!this.props.hideNegative&&fk("input",{type:"button",value:this.props.negative,onClick:this.onClose})))}}const wk=yk;var bk,Ck=n(13933);function Sk(e,t,n,i){bk||(bk="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:bk,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Tk="https://";function Ik({onCreateLink:e,onCancelCreateLink:t,link:n,useAddress:i}){const s=tn.useRef(),o=i?n?(0,le.Z)("Edit Address"):(0,le.Z)("Add Address"):n?(0,le.Z)("Edit Link"):(0,le.Z)("Create Link");return Sk(ln.Z,{dialogWidth:400,onRequestClose:t},void 0,Sk("header",{className:"dialog-header"},void 0,Sk("h1",{className:"dialog-title"},void 0,o)),Sk("form",{onSubmit:()=>{e(s.current?(0,Ni.q9)(s.current.value):Tk)}},void 0,Sk("div",{className:"dialog-content"},void 0,(0,fn.jsx)("input",{ref:s,defaultValue:n||Tk,type:"text",autoFocus:!0,onFocus:e=>e.currentTarget.select()})),Sk("footer",{className:"dialog-footer"},void 0,Sk("input",{type:"submit",className:"primary",value:(0,le.Z)("Save Link")}),Sk("input",{type:"button",onClick:t,value:(0,le.Z)("Cancel")}))))}var kk;function Ak(e,t,n,i){kk||(kk="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:kk,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Zk=[[{command:"bold",text:(0,le.Z)("Bold"),icon:cn.q7H},{command:"italic",text:(0,le.Z)("Italic"),icon:cn.znb},{command:"underline",text:(0,le.Z)("Underline"),icon:cn.slH},{command:"strikeThrough",text:(0,le.Z)("Strike through"),icon:cn._QD}],[{command:"justifyLeft",text:(0,le.Z)("Left align"),icon:cn.W_c},{command:"justifyCenter",text:(0,le.Z)("Center align"),icon:cn.vxN},{command:"justifyRight",text:(0,le.Z)("Right align"),icon:cn.JUc},{command:"justifyFull",text:(0,le.Z)("Justify"),icon:cn.FsT}],[{command:"insertOrderedList",text:(0,le.Z)("Numbered list"),icon:cn.o_D},{command:"insertUnorderedList",text:(0,le.Z)("Bullet list"),icon:cn.rr$}],[{command:"outdent",text:(0,le.Z)("Remove indentation"),icon:cn.XKb},{command:"indent",text:(0,le.Z)("Indent"),icon:cn.b2r}],[{command:"createLink",text:(0,le.Z)("Create Link"),icon:cn.v2I},{command:"insertImage",text:(0,le.Z)("Insert Image"),icon:cn.kkq}],[{command:"undo",text:(0,le.Z)("win_linux","Undo"),icon:cn.LwO},{command:"redo",text:(0,le.Z)("win_linux","Redo"),icon:cn.W9w}],[{command:"removeFormat",text:(0,le.Z)("Remove formatting"),icon:cn.mHT}]];class Ek extends tn.Component{state={anchor:"",link:"",buttonState:[],createLinkModalOpen:!1,formatBlock:"p",fontName:"sans-serif",fontSize:"2",foreColor:"#111111",backColor:"#f6f6f6",minimizeToolbar:!!this.props.isSignature};updateButtonState=e=>{const t=Zk.flat().map((e=>e.command)).indexOf("createLink"),n=e&&e[0]||[];n[t]=Boolean(this.state.link||this.state.anchor),this.setState({buttonState:n})};updateDropdownAndColorState=e=>{if(Array.isArray(e)&&1===e.length&&Array.isArray(e[0])){const[t,n,i,s,o]=e[0];this.setState({formatBlock:""===t||"div"===t?"p":t,fontName:n.startsWith('"')&&n.endsWith('"')?n.substring(1,n.length-1):n,fontSize:i,foreColor:"rgb(0, 0, 0)"===s?"#111111":Dr()(s).hex(),backColor:"rgba(0, 0, 0, 0)"===o?"#f6f6f6":Dr()(o).hex()})}};updateLinkState=e=>{this.setState((t=>{if(t.anchor!==e)return{anchor:e}}))};onCreateLink=e=>{this.setState({createLinkModalOpen:!1}),this.props.onCreateLink(e)};onCancelCreateLink=()=>{this.setState({createLinkModalOpen:!1}),this.props.onCancelCreateLink()};showCreateLinkModal=()=>this.setState({createLinkModalOpen:!0});render(){let e=0;return(0,fn.jsxs)(fn.Fragment,{children:[this.state.createLinkModalOpen&&Ak(Ik,{onCreateLink:this.onCreateLink,onCancelCreateLink:this.onCancelCreateLink,link:this.state.link||this.state.anchor}),Ak("div",{className:"editor-html-toolbar"},void 0,!this.state.minimizeToolbar&&Ak("select",{onChange:e=>this.props.onChange("formatBlock",e),value:this.state.formatBlock,title:(0,le.Z)("Paragraph Format"),tabIndex:"-1"},void 0,Ak("option",{value:"h1"},void 0,(0,le.Z)("Heading 1")),Ak("option",{value:"h2"},void 0,(0,le.Z)("Heading 2")),Ak("option",{value:"h3"},void 0,(0,le.Z)("Heading 3")),Ak("option",{value:"h4"},void 0,(0,le.Z)("Heading 4")),Ak("option",{value:"p"},void 0,(0,le.Z)("Paragraph")),Ak("option",{value:"pre"},void 0,(0,le.Z)("Preformatted")),Ak("option",{value:"blockquote"},void 0,(0,le.Z)("Quote"))),Ak("select",{onChange:e=>this.props.onChange("fontName",e),value:this.state.fontName,title:(0,le.Z)("Font"),tabIndex:"-1"},void 0,Ak("option",{value:"serif"},void 0,(0,le.Z)("Serif")),Ak("option",{value:"sans-serif"},void 0,(0,le.Z)("Sans-Serif")),Ak("option",{value:"monospace"},void 0,(0,le.Z)("Fixed Width"))),!this.state.minimizeToolbar&&Ak("select",{onChange:e=>this.props.onChange("fontSize",e),value:this.state.fontSize,title:(0,le.Z)("Font Size"),tabIndex:"-1"},void 0,Ak("option",{value:"1"},void 0,(0,le.Z)("Extra Small")),Ak("option",{value:"2"},void 0,(0,le.Z)("mail","Small")),Ak("option",{value:"3"},void 0,(0,le.Z)("Normal")),Ak("option",{value:"4"},void 0,(0,le.Z)("mail","Large")),Ak("option",{value:"5"},void 0,(0,le.Z)("Larger")),Ak("option",{value:"6"},void 0,(0,le.Z)("Extra Large"))),Zk.map(((t,n)=>{n>0&&(e+=Zk[n-1].length);const i=this.props.isSignature?t.filter((e=>"insertImage"!==e.command&&(!this.state.minimizeToolbar||!["insertOrderedList","insertUnorderedList","outdent","indent","undo","redo","removeFormat"].includes(e.command)))):t;if(0!==i.length)return Ak("span",{className:"editor-button-group"},n,i.map(((t,n)=>Ak("button",{tabIndex:"-1",onClick:()=>this.props.onClick(t.command),title:t.text,className:this.state.buttonState[e+n]?"active":null,dangerouslySetInnerHTML:{__html:t.icon}},t.command))))})),Ak("input",{type:"color",tabIndex:"-1",className:"text-color",title:(0,le.Z)("Text Color"),value:this.state.foreColor,onChange:e=>this.props.onChangeColor("foreColor",e)}),!this.state.minimizeToolbar&&Ak("input",{type:"color",tabIndex:"-1",className:"text-bg-color",title:(0,le.Z)("Text Background Color"),value:this.state.backColor,onChange:e=>this.props.onChangeColor("backColor",e)}),this.props.isSignature&&Ak("span",{className:"editor-button-group"},void 0,Ak("button",{tabIndex:"-1",style:{float:"right"},onClick:()=>this.setState((e=>({minimizeToolbar:!e.minimizeToolbar}))),title:this.state.minimizeToolbar?(0,le.Z)("Show more"):(0,le.Z)("Show less"),dangerouslySetInnerHTML:{__html:this.state.minimizeToolbar?cn.yaZ.small:cn.OCp.small}})))]})}}var _k,Nk=n(97781);class Mk extends tn.Component{static contextType=dn.Z;refWebview=tn.createRef();#f=[];constructor(e,t){super(e);const n=P.Z.getState().windowStyles.get(t.vivaldiWindowId)||lT.Z.getFallbackStyle();this.state={windowStyle:n}}componentDidMount(){P.Z.addListener(this.onThemeStoreChanged),this.refWebview.current?.addEventListener("consolemessage",this.handleConsoleMessage),this.refWebview.current?.addEventListener("contentload",this.handleContentLoad),this.refWebview.current?.addEventListener("newwindow",this.handleLinkClicked),d.Z.tabsPrivate.onKeyboardChanged.addListener(this.keyEventListener)}componentWillUnmount(){this.#f.forEach((e=>URL.revokeObjectURL(e))),P.Z.removeListener(this.onThemeStoreChanged),this.refWebview.current?.removeEventListener("consolemessage",this.handleConsoleMessage),this.refWebview.current?.removeEventListener("contentload",this.handleContentLoad),this.refWebview.current?.removeEventListener("newwindow",this.handleLinkClicked),d.Z.tabsPrivate.onKeyboardChanged.removeListener(this.keyEventListener)}onThemeStoreChanged=()=>{const e=P.Z.getState().windowStyles.get(this.context.vivaldiWindowId)||lT.Z.getFallbackStyle();e!==this.state.windowStyle&&this.setState({windowStyle:e},this.setStyle)};static defaultProps={hidden:!1};focus(){return this.refWebview.current?.focus()}hasFocus(){return!!this.refWebview.current&&this.refWebview.current===document.activeElement}getContentAsBodyParts=()=>{const e=this.refWebview.current;return e?new Promise(((t,n)=>{e.executeScript({code:"document.body.innerHTML"},(e=>{e&&Array.isArray(e)&&"string"==typeof e[0]?t([{type:"html",content:e[0]}]):n("RichTextEdit.getContentAsBodyParts: Couldn't get contet from Webview")}))})):Promise.reject("RichTextEdit.getContentAsBodyParts: Webview doesn't exist")};getWebview=()=>{const e=this.refWebview.current;if(!e)throw new Error("RichTextEdit.getContentAsBodyParts: Webview doesn't exist");return e};postMessage=e=>{this.refWebview.current?.contentWindow?.postMessage?.(e,Q.oP)};setContent=e=>{this.postMessage({type:"SET_CONTENT",content:e})};setStyle=()=>{let e=lT.Z.createStyleRoot(this.state.windowStyle);e+=this.props.isNote?"\n    html, body, iframe {\n      background-color: transparent;\n      padding: 0;\n      margin: 0;\n      font-family: sans-serif;\n      overflow: initial;\n    }\n    body[contenteditable=\"plaintext-only\"] {\n      font-family: monospace;\n    }\n    body {\n      --EditorPadding: 12px;\n      --MaxWidth: 700px;\n      margin-left: var(--EditorPadding);\n      padding-left: calc(calc(50% - calc(var(--MaxWidth) / 2) - var(--EditorPadding))) !important;\n      padding-right: calc(50% - calc(var(--MaxWidth) / 2)) !important;\n      padding-top: var(--EditorPadding);\n      padding-bottom: calc(var(--EditorPadding) * 3);\n      color: var(--colorFgIntense);\n      font-size: 100%;\n      cursor: text;\n    }\n    img {\n      display: inline-block;\n      vertical-align: top;\n      max-width: 100%;\n      height: auto;\n    }\n    a:-webkit-any-link {\n      color: var(--colorHighlightBg);\n      cursor: pointer;\n    }\n  \n    html, body, iframe {\n      font-family: sans-serif;\n      font-size: 100%;\n    }\n    body {\n      overflow: overlay;\n    }\n    input[type=checkbox] {\n      appearance: none;\n      position: relative;\n      width: 16px;\n      height: 16px;\n      min-width: 16px;\n      min-height: 16px;\n      vertical-align: middle;\n      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1) inset;\n      margin: unset;\n      border-width: 1px;\n      border-style: solid;\n      border-color: rgba(0,0,0,0.2);\n      background-color: var(--colorBgIntense);\n    }\n    input[type='checkbox']:disabled {\n      opacity: 1;\n      filter: grayscale(1);\n    }\n    input[type=checkbox]:before,\n    input[type=checkbox]:after {\n      content: '';\n      position: absolute;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      background-color: var(--colorHighlightBg);\n      transform-origin: 0 0;\n    }\n    input[type=checkbox]:before {\n      transform: rotate(-45deg) translateY(45%) translateX(-30%) scaleX(0.25) scaleY(0);\n    }\n    input[type=checkbox]:checked:before {\n      transform: rotate(-45deg) translateY(45%) translateX(-30%) scaleX(0.25) scaleY(0.4);\n    }\n    input[type=checkbox]:after {\n      transform: rotate(225deg) translateY(-30%) translateX(-95%) scaleX(0.25) scaleY(0);\n    }\n    input[type=checkbox]:checked:after {\n      transform: rotate(225deg) translateY(-30%) translateX(-95%) scaleX(0.25) scaleY(1.2);\n    }\n    \n    .tooltip {\n      --TipWidth: 480px;\n      position: relative;\n    }\n    .tooltip .tooltip-text * {\n      user-select: none;\n    }\n    .tooltip-text input {\n      margin-left: 3px;\n      border: 1px solid var(--colorBorder);\n      border-radius: 2px;\n      font-size: small;\n      opacity: 0.8;\n      color: var(--colorFg);\n      background-color: var(--colorBg);\n    }\n    .tooltip-text input:active {\n      background-color: var(--colorBgDark);\n    }\n    .tooltip-text input:first-of-type {\n      margin-left: 12px;\n    }\n    .tooltip-text a {\n      white-space: nowrap;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      color: var(--colorFg);\n    }\n    .tooltip .tooltip-text {\n      cursor: default;\n      position: absolute;\n      z-index: 1;\n      display: flex;\n      top: 100%;\n      left: -6px;\n      max-width: var(--TipWidth);\n      padding: 6px 6px 6px 12px;\n      color:var(--colorFg);\n      background-color: var(--colorBg);\n      border: 1px solid var(--colorBgDark);\n      box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.1), 0 3px 10px rgba(0, 0, 0, 0.3);\n      border-radius: 3px;\n    }\n  \n  ":function(e=!1){const t="black_on_white"===M.Z.get(D.kMailComposerColors);return`html, body {\n      overflow: initial;\n    }\n    body {\n      margin: ${e?"6px":"12px 24px 24px"};\n      font-family: sans-serif;\n      font-size: 100%;\n      color: ${t?"black;":"var(--colorFgIntense)"};\n      background-color: ${t?"white;":"var(--colorBgIntense)"};\n    }\n    img {\n      display: inline-block;\n      vertical-align: top;\n      max-width: 100%;\n      height: auto;\n    }\n    [contenteditable] {\n      cursor: text;\n    }\n    blockquote {\n      padding-inline-start: 18px;\n      border-left: 3px solid inherit;\n      margin: 0;\n      opacity: 0.85;\n    }\n    pre {\n      white-space: pre-wrap;\n    }\n    \n    .tooltip {\n      --TipWidth: 480px;\n      position: relative;\n    }\n    .tooltip .tooltip-text * {\n      user-select: none;\n    }\n    .tooltip-text input {\n      margin-left: 3px;\n      border: 1px solid var(--colorBorder);\n      border-radius: 2px;\n      font-size: small;\n      opacity: 0.8;\n      color: var(--colorFg);\n      background-color: var(--colorBg);\n    }\n    .tooltip-text input:active {\n      background-color: var(--colorBgDark);\n    }\n    .tooltip-text input:first-of-type {\n      margin-left: 12px;\n    }\n    .tooltip-text a {\n      white-space: nowrap;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      color: var(--colorFg);\n    }\n    .tooltip .tooltip-text {\n      cursor: default;\n      position: absolute;\n      z-index: 1;\n      display: flex;\n      top: 100%;\n      left: -6px;\n      max-width: var(--TipWidth);\n      padding: 6px 6px 6px 12px;\n      color:var(--colorFg);\n      background-color: var(--colorBg);\n      border: 1px solid var(--colorBgDark);\n      box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.1), 0 3px 10px rgba(0, 0, 0, 0.3);\n      border-radius: 3px;\n    }\n  `}(this.props.isSignature),this.postMessage({type:"SET_STYLE",isNote:this.props.isNote,style:e}),this.contentLoadHandled=!1};debouncedUpdateState=(0,Zr.Z)((()=>{this.props.updateButtonState(),this.props.updateDropdownAndColorState()}),100);handleConsoleMessage=e=>{const[t,n=""]=e.message.split(" ",2);switch(t){case"selectionchange":this.debouncedUpdateState();break;case"input":this.debouncedUpdateState(),this.props.onChange(e);break;case"linkupdate":case"createLink":case"editLink":case"copyLink":case"unlink":this.props.handleLinkEvent(t,n);break;case"dragover":{const e={dataTransfer:{types:n?n.split(","):[]}};this.props.onDragOver?.(e);break}default:throw new Error(e.message)}};handleLinkClicked=e=>{e.targetUrl.startsWith("#")||(Y.Z.openURL(this.context.vivaldiWindowId,e.targetUrl),e.preventDefault())};handleContentLoad=()=>{this.contentLoadHandled||(this.contentLoadHandled=!0,this.setStyle(),this.props.onContentLoad&&this.props.onContentLoad())};keyEventListener=(e,t,n,i,s)=>{1===n&&t&&i===qi.Z.KEY_TAB&&document.activeElement&&document.activeElement===this.refWebview.current&&this.props.focusPreviousElement()};execCommand=(e,t,n=!0)=>{this.postMessage({type:"EXEC_COMMAND",command:e,value:t}),n&&setTimeout((()=>this.refWebview.current?.focus()),0)};onChange=(e,t)=>{this.execCommand(e,t.currentTarget.value),this.props.updateDropdownAndColorState()};onClick=e=>{switch(e){case"createLink":this.props.handleLinkEvent("createLinkClicked");break;case"insertImage":this.insertImage();break;default:this.execCommand(e,""),this.props.updateButtonState()}};insertImage=()=>{y.Z.fileSystem.chooseEntry({type:"openFile",accepts:[{mimeTypes:["image/*"]}]},(e=>{!y.Z.runtime.lastError&&e&&e.file((t=>{const n=URL.createObjectURL(t);this.#f.push(n),this.execCommand("insertHTML",`<img src="${n}" ${Nk.ZR}="${t.type}" ${Nk.Gx}="${e.name}" />`)}))}))};unlink=()=>{this.execCommand("unlink",!1)};selectSurrounding=()=>{this.postMessage({type:"SELECT_SURROUNDING"})};setZoomLevel=e=>{const t=this.refWebview.current;t&&(t.setZoomMode("per-view"),t.setZoom(e))};executeScript=e=>new Promise(((t,n)=>{this.refWebview.current?this.refWebview.current.executeScript(e,t):n()}));render(){return(0,fn.jsx)("webview",{className:"editor-webview",name:"richtexteditor",ref:this.refWebview,style:this.props.hidden||this.props.disabled?{display:"none"}:{},allowtransparency:"on",vivaldi_view_type:"vivaldi_embedded_view",src:"components/notes/richtexteditor/richtexteditor.html"})}}function Pk(e,t){const[n,i]=(0,tn.useState)(!1),s=(0,tn.useCallback)((e=>{e.dataTransfer.types.includes("Files")&&i(!0)}),[]),o=(0,tn.useCallback)((e=>{e.target===e.currentTarget&&(e.preventDefault(),i(!1))}),[]),a=(0,tn.useCallback)((t=>{i(!1);const n=[...t.dataTransfer.items].filter((e=>"file"===e.kind)).map((e=>e.getAsFile()));n.length>0&&(t.preventDefault(),e(n))}),[e]);return(0,tn.useEffect)((()=>{const e=t?.current;n?e?.style.setProperty("pointer-events","none"):e?.style.removeProperty("pointer-events")}),[t,n]),{canDropFile:n,onDragLeave:o,onDragOver:s,onDrop:a}}function Dk(e,t,n,i){_k||(_k="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:_k,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const xk=(0,tn.forwardRef)(((e,t)=>{const n=(0,tn.useRef)(null),i=(0,tn.useRef)(null);function s(){const e=n.current?.refWebview.current;e&&e.executeScript({code:"['formatBlock', 'fontName', 'fontSize', 'foreColor', 'backColor'].map(\n         command => document.queryCommandValue(command));"},(e=>{i.current&&i.current.updateDropdownAndColorState(e)}))}(0,tn.useImperativeHandle)(t,(()=>({focus:()=>{n.current&&n.current.focus()},getContentAsBodyParts:()=>{if(!n.current)throw new Error("MailComposer: Building body parts after body is gone");return n.current.getContentAsBodyParts()},getWebview:()=>{if(!n.current)throw new Error("MailComposer: Getting webview body is gone");return n.current.getWebview()},setContent:e=>{n.current?.setContent(e)}})),[]);const{canDropFile:o,onDragLeave:a,onDragOver:r,onDrop:l}=e.onSignatureAttachmentDrop?(d=n.current?.refWebview,c=e.onSignatureAttachmentDrop,Pk((0,tn.useCallback)((async e=>{for(const t of e){if(t.size>2e6){de.Z.warn("Mail",["signature"],`Image ${t.name} is too large (over 2MB) to add to signature`);continue}const e=await new Promise(((e,n)=>{const i=new FileReader;i.onloadend=({currentTarget:t})=>{const{result:i}=t;i.startsWith("data:image/")?e(i):n("Not an image")},i.readAsDataURL(t)}));await new Promise(((t,n)=>{if(d&&d.current){let i="";d.current.executeScript({code:"document.body.innerHTML"},(s=>{s&&Array.isArray(s)&&"string"==typeof s[0]?(i=String(s[0])+`<div><img alt="" src="${e}"></div>`,i&&(d.current?.executeScript({code:`document.body.innerHTML = unescape('${escape(i)}');`}),c(i)),t()):n("RichTextEdit.getContentAsBodyParts: Couldn't get contet from Webview")}))}}))}}),[c,d]),d)):function(e,t){return Pk((0,tn.useCallback)((async t=>{const n=[];for(const i of t){let t;try{t=await i.arrayBuffer()}catch(t){console.error("useAttachmentDrop: "+t.toString()),X.Z.setStatus(e,t.toString());continue}n.push({type:"attachment",content:new Uint8Array(t),filename:i.name,mimeType:i.type})}Vm.addAttachments(n)}),[e]),t)}(e.windowId,n.current?.refWebview);var d,c;const h=!!e.onSignatureAttachmentDrop;return Dk("div",{className:"editor-html"},void 0,(0,fn.jsx)(Ek,{ref:i,onClick:function(e){n.current&&n.current.onClick(e)},onCreateLink:function(e){const t=n.current;t&&(""===e?t.execCommand("unlink"):"https://"!==e&&t.execCommand("createLink",e),t.focus())},onCancelCreateLink:function(){n.current&&n.current.focus()},onChange:function(e,t){n.current&&n.current.execCommand(e,t.currentTarget.value),s()},onChangeColor:function(e,t){const i=n.current;i&&i.execCommand(e,t.currentTarget.value,!1)},isSignature:h}),o&&Dk("div",{className:"file-dropzone",onDragLeave:a,onDrop:l,onDragOver:e=>e.preventDefault()},void 0,Dk("h1",{},void 0,(0,le.Z)("Drop file(s) here"))),(0,fn.jsx)(Mk,{ref:n,isSignature:h,onChange:e.onBodyChange,onDragOver:r,onContentLoad:e.onContentLoad,focusPreviousElement:e.focusPreviousElement,updateDropdownAndColorState:s,updateButtonState:function(){const e=n.current?.refWebview.current,t='"'+Zk.flat().map((e=>e.command)).join('","')+'"';e&&e.executeScript({code:`[${t}].map(command => document.queryCommandState(command));`},(e=>{i.current&&i.current.updateButtonState(e)}))},handleLinkEvent:function(e,t){const s=i.current;if(!s)return;const{link:o,anchor:a}=s.state;switch(e){case"linkupdate":s.updateLinkState(t||"");break;case"createLink":case"editLink":s.showCreateLinkModal();break;case"copyLink":break;case"unlink":(o||a)&&n.current&&n.current.unlink();break;case"createLinkClicked":(o||a)&&n.current&&n.current.selectSurrounding(),s.showCreateLinkModal()}}}))})),Ok=xk,Lk=(e,t)=>{for(const n of e){let e=!1;for(const i of t)0!==i.indexOf(n)||(e=!0);if(!e)return!1}return!0};var Rk;function Bk(e,t,n,i){Rk||(Rk="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Rk,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Fk extends tn.Component{refMultiInputOptions={};selectionModel=new ku;constructor(e){super(e),this.state={filteredList:[],inputValue:"",dropDownVisible:!1,isEditing:!1,selectedIndex:-1}}isMetaKeyPressed=!1;onKeyArrowUp=()=>{const e=this.selectionModel.leadIndex;e>0&&(this.selectionModel.resetSelectionModel(),this.selectionModel.setIndexSelected(e-1,!0),this.forceUpdate())};onKeyArrowDown=()=>{const e=this.selectionModel.leadIndex;e<this.state.filteredList.length-1&&(this.selectionModel.resetSelectionModel(),this.selectionModel.setIndexSelected(e+1,!0),this.forceUpdate())};resetSelectionModel=()=>{this.selectionModel.resetSelectionModel(),this.forceUpdate()};tokenize=(e,t)=>{const n=/[\S]+/g;let i=[];if(e&&(i=i.concat(e.match(n)||[])),t){const e=t.match(/[^@.+]+/g)||[];i=i.concat([...e,...t.split("@"),t])}return new Set(i.map((e=>e.toLowerCase())))};filterItems=e=>{const t=Uu()(1)(((e,t)=>{const n=new Map(e);return t.forEach((({address:e,name:t})=>{n.has(e)&&n.delete(e)})),n}))(this.props.allItems,this.props.selectedItems);return Uu()(1)(((e,t)=>{const n=[];for(const[i,s]of t){(0===s.size?new Set([""]):s).forEach((t=>{if(e.length>0){const s=this.tokenize(e),o=this.tokenize(t,i);Lk(s,o)&&n.push({address:i,name:t})}else n.push({address:i,name:t})}))}return this.selectionModel.resetSelectionModel(),this.selectionModel.setIndexSelected(0,!0),n}))(e,t)};inputChanged=()=>{const e=this.refInputField?this.refInputField.value:"",t=this.filterItems(e);let n=!0;0!==e.length&&0!==t.length||(n=!1);const i=this.props.setIsValidInput;if(i){let t=!1;if(e.trim().length>0){const n=(0,ye.D$)(e);if(n.length>0){const e=n[0];(0,ye.HZ)(e.address)&&(t=!0)}}i(t)}this.setState({inputValue:e,filteredList:t,dropDownVisible:n})};onOptionClick=e=>{this.selectOption(e)};onItemClick=e=>{this.removeOption(e,!0)};removeOption=(0,Zr.Z)(((e,t)=>{const n=this.props.selectedItems,[i]=n.splice(e,1),s=t?e:Math.max(e-1,0);this.setState(((e,o)=>(o.itemSelectionCallback(n),{isEditing:t,selectedIndex:n.length>0?s:-1,inputValue:t?(0,ye.li)(i):""})),(()=>{this.state.isEditing||-1===this.state.selectedIndex?this.focusInput():this.focusItem(s)}))}));inputConfirmed=e=>{let t=!1;if(e&&e.value&&e.value.trim().length>0){let n="";const i=this.props.selectedItems,s=(0,ye.D$)(e.value);for(;s.length>0;){const e=s.shift();if(!(0,ye.HZ)(e.address)){s.unshift(e),n=(0,ye.Rz)(s);break}-1===this.state.selectedIndex?i.push(e):i.splice(this.state.selectedIndex,0,e),t=!0}t&&(this.setState((e=>({isEditing:!1,inputValue:n,dropDownVisible:!1})),(()=>this.focusItem(this.state.selectedIndex))),this.props.itemSelectionCallback(i))}return t};selectAll=()=>{this.selectionModel.resetSelectionModel(),this.setState(((e,t)=>(t.itemSelectionCallback([]),{inputValue:t.selectedItems.map((e=>(0,ye.li)(e))).join(", "),dropDownVisible:!1})),(()=>this.refInputField&&this.refInputField.select()))};selectOption=e=>{this.selectionModel.resetSelectionModel(),this.setState(((t,n)=>{const i=n.selectedItems;return-1===t.selectedIndex?i.push(e):i.splice(t.selectedIndex,0,e),n.itemSelectionCallback(i),{isEditing:!1,inputValue:"",dropDownVisible:!1}}),(()=>this.focusItem(this.state.selectedIndex)))};inputKeyUp=()=>{this.isMetaKeyPressed=!1};inputKeyDown=e=>{const t=e.keyCode;t===qi.Z.KEY_CONTROL&&(this.isMetaKeyPressed=!0);const n=!this.refInputField||0===this.refInputField.value.trim().length,i=this.state.filteredList[this.selectionModel.leadIndex],s=t===qi.Z.KEY_TAB||t===qi.Z.KEY_RETURN;if(n&&this.isMetaKeyPressed&&"a"===e.key)return this.selectAll(),e.preventDefault(),void e.stopPropagation();void 0!==i&&s?(this.selectOption(i),e.preventDefault(),e.stopPropagation()):s||","===e.key?(this.inputConfirmed(this.refInputField)&&e.preventDefault(),e.stopPropagation()):t===qi.Z.KEY_ESCAPE?this.inputConfirmed(this.refInputField)?e.preventDefault():(this.onKeyArrowLeft(),e.preventDefault(),e.stopPropagation()):this.state.dropDownVisible&&t===qi.Z.KEY_DOWN?(this.onKeyArrowDown(),e.preventDefault()):this.state.dropDownVisible&&t===qi.Z.KEY_UP?(this.onKeyArrowUp(),e.preventDefault()):!n||t!==qi.Z.KEY_LEFT&&t!==qi.Z.KEY_BACK_SPACE?n&&t===qi.Z.KEY_RIGHT&&(this.onKeyArrowRight(),e.preventDefault(),e.stopPropagation()):(this.onKeyArrowLeft(),e.preventDefault(),e.stopPropagation())};onKeyArrowLeft=()=>{let e;const t=-1===this.state.selectedIndex;e=this.state.isEditing?this.state.selectedIndex-1:t?this.props.selectedItems.length-1:Math.max(this.state.selectedIndex-1,-1),this.setState({selectedIndex:e,isEditing:!1,inputValue:"",dropDownVisible:!1},(()=>{e<0?this.focusInput():this.focusItem(e)}))};onKeyArrowRight=()=>{const e=this.state.selectedIndex+1;e===this.props.selectedItems.length?this.setState({isEditing:!1,selectedIndex:-1},(()=>this.focusInput())):this.setState((t=>({isEditing:!1,selectedIndex:e})),(()=>this.focusItem(e)))};inputLostFocus=e=>{this.inputConfirmed(this.refInputField),this.setState({dropDownVisible:!1})};itemKeyDown=(e,t)=>{const n=t.keyCode;if(this.state.dropDownVisible&&e===this.props.selectedItems.length-1&&this.focusInput(),n===qi.Z.KEY_LEFT)this.onKeyArrowLeft(),t.preventDefault(),t.stopPropagation();else if(n===qi.Z.KEY_RIGHT)this.onKeyArrowRight(),t.preventDefault(),t.stopPropagation();else if(n===qi.Z.KEY_BACK_SPACE||n===qi.Z.KEY_DELETE)this.removeOption(e);else if(n===qi.Z.KEY_RETURN){const t=!0;this.removeOption(e,t)}else n===qi.Z.KEY_ESCAPE&&this.setState({isEditing:!1,selectedIndex:-1},(()=>this.focusInput()))};onClose=(e,t)=>{this.removeOption(e),t.stopPropagation()};onFocus=e=>{this.setState({selectedIndex:e})};renderSelectedItem=(e,t)=>{let n="";return e.address?n=e.address:"string"==typeof e&&(n=e),(0,fn.jsxs)("div",{title:n,onKeyDown:this.itemKeyDown.bind(this,t),onFocus:()=>this.onFocus(t),ref:e=>this.refMultiInputOptions["item_"+t]=e,onClick:this.onItemClick.bind(this,t),className:mn()("multiinput-item",this.props.className),tabIndex:this.state.selectedIndex===t||0===this.props.tabIndex?0:-1,children:[e.name&&Bk("span",{className:"multiinput-item-primary"},void 0,e.name),e.address&&Bk("span",{className:"multiinput-item-secondary"},void 0,"<"+e.address+">"),"string"==typeof e&&Bk("span",{className:"multiinput-item-primary"},void 0,e),Bk("button",{className:"close",dangerouslySetInnerHTML:{__html:cn.kze},onClick:e=>this.onClose(t,e),tabIndex:this.props.tabIndex})]},"selected_item_"+t)};focusInput=()=>{this.refInputField&&this.refInputField.focus()};focusItem=e=>{this.refMultiInputOptions["item_"+e]?.focus()};renderMailAddressForOption=e=>Bk("div",{},void 0,e.name?Bk(tn.Fragment,{},void 0,Bk("div",{className:"multiinput-option-primary"},void 0,e.name),Bk("div",{className:"multiinput-option-secondary"},void 0,"<"+e.address+">")):Bk("div",{className:"multiinput-option-primary"},void 0,e.address));renderInputField=()=>(0,fn.jsx)("input",{type:"text",ref:e=>this.refInputField=e,value:this.state.inputValue,onChange:this.inputChanged,onBlur:this.inputLostFocus,onKeyDown:this.inputKeyDown,onKeyUp:this.inputKeyUp,autoComplete:"false",spellCheck:"false",placeholder:this.props.placeholder});renderOption=(e,t)=>{const n=this.selectionModel.isSelected(t);return(0,fn.jsx)("div",{className:"multiinput-option",ref:e=>this.refMultiInputOptions["option_"+t]=e,role:"option","data-id":t,"data-selected":n?"":null,onClick:this.onOptionClick.bind(this,e),children:this.renderMailAddressForOption(e)},"option_"+t)};renderDropDown=()=>Bk("div",{role:"listbox",className:"multiinput-select"},void 0,this.state.filteredList.map(this.renderOption));getInput=()=>Bk("div",{className:"multiinput-group"},"input_"+this.state.selectedIndex,this.renderInputField(),this.state.dropDownVisible?this.renderDropDown():"");render(){const e=this.props.selectedItems.map(this.renderSelectedItem);return this.state.isEditing?e.splice(this.state.selectedIndex,0,this.getInput()):e.push(this.getInput()),(0,fn.jsx)("div",{ref:e=>this.refMultiInputEnvelope=e,className:"multiinput",children:e})}}const Uk=Fk;var Vk=n(88951);const Wk=(0,le.Z)("Sent with Vivaldi Mail. Download Vivaldi for free at vivaldi.com");var Hk,zk=n(22288),Gk=n(34155);function $k(e,t,n,i){Hk||(Hk="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Hk,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Kk=[D.kKeyboardTabToAll,D.kMailAccounts,D.kMailComposeHeadersHidden];function jk(e,t,n){if(0===e.length)return"";const i=e[0].address,s=t.find((e=>e.MAIL_EMAIL===i));if(!s)return"";let o=(0,zk.oX)(!1);const a=s.signature;return"above"===s.signaturePosition&&n&&(o="<br>"),void 0===a?o+=Wk:(0,zk.Mg)(a,!s.isSignatureRichText)?o=a:""===a?o="":o+=a,o=o.replace(/\n/g,"<br>"),o}function Yk(e,t="below"){return`<span class='viv-signature${"below"===t?"-below":""}'>${e}</span>`}class Xk extends tn.PureComponent{static contextType=dn.Z;refTo=tn.createRef();refFrom=tn.createRef();signature="";draftCreated=!1;fromDraft=!1;refBody=tn.createRef();refSubject=tn.createRef();messageId=(0,Vk.Z)();draftIsPlaintext=!1;cidAttachments=[];focusOnBody=!1;constructor(e){super(e),this.state=this._initDraft()}_initDraft=()=>{const e=hm.Z.getAccountsAndAliases(),t={from:e.length>0?[{address:e[0].MAIL_EMAIL}]:[],to:[],cc:[],bcc:[],subject:"",attachments:[],mailAddresses:Aa.Z.getMailAddresses(),showModal:!1},n=this.props.mailto&&!this.props.id?(0,ne.J)(this.props.mailto):Ck.Z.get();if(!n)return this.sentDate=Date.now(),this.draftIsPlaintext=!1,this.signature=Yk(jk(t.from,e),this.selectedAccount?.signaturePosition),this.bodyDraft="",t;if(this.sentDate=n.sentDate,this.threadKey=n.threadKey,this.references=n.references,this.messageId=n.messageId,this.cidAttachments=n.cidAttachments||[],this.inReplyTo=n.inReplyTo,this.forwarded=n.forwarded,this.replied=n.replied,this.draftIsPlaintext=n.plaintext,this.focusOnBody=n.focusOnBody,this.selectedAccount=n.selectedAccount,t.attachments=n.attachments,t.bcc=n.bcc,t.cc=n.cc,t.from=n.from,t.subject=n.subject,t.to=n.to,this.bodyDraft=n.body,this.fromDraft=this.fromDraft||!!n.fromDraft,!this.fromDraft){const i=!!n.replied||!!n.forwarded;this.signature=Yk(jk(t.from,e,i),this.selectedAccount?.signaturePosition)}return t};_setIfActive=e=>{e.isActive?(this._bind(),Gk.nextTick((()=>Vm.setActiveMailComposer(this)))):(this._unbind(),Gk.nextTick((()=>Vm.clearActiveMailComposer(this))),this.flushPendingChanges())};_contactsChanged=()=>{const e=Aa.Z.getMailAddresses();this.setState({mailAddresses:e})};_showModal=e=>{"noRecipients"===e&&this.setState({showModal:!0})};_hideModal=()=>{this.setState({showModal:!1})};componentDidMount(){this._isMounted=!0,this._setIfActive(this.props),Rm.addListener(this._showModal),Aa.Z.addListener(this._contactsChanged),this.focusOnBody&&this.refBody.current?this.refBody.current.focus():this.refTo.current&&this.refTo.current.focusInput();const{id:e}=this.props;e&&Gk.nextTick((async()=>{if(await ne.Z.prepareDraft(e)&&this._isMounted){const e=this._initDraft();this.setState(e)}}))}onContentLoad=()=>{(this.bodyDraft||this.signature)&&setTimeout((()=>{const e=[],t=this.selectedAccount?.signaturePosition||"below";""!==this.bodyDraft&&"above"!==t||e.push({content:"<br>",isPlainText:!1}),(this.replied||this.forwarded)&&("above"===t?e.push({content:this.signature,isPlainText:!1}):e.push({content:Yk("","above"),isPlainText:!1})),""!==this.bodyDraft&&e.push({content:this.bodyDraft,isPlainText:this.draftIsPlaintext}),"below"===t&&this.draftIsPlaintext&&this.bodyDraft&&e.push({content:"<br>",isPlainText:!1}),"below"!==t&&this.bodyDraft?e.push({content:Yk("","below"),isPlainText:!1}):e.push({content:this.signature,isPlainText:!1}),e.length>0&&this.refBody.current?.setContent(e),this.signature="",this.bodyDraft="",this.draftIsPlaintext=!1}),150)};componentDidUpdate(e){e.isActive!==this.props.isActive&&this._setIfActive(this.props)}componentWillUnmount(){this._isMounted=!1,this._unbind(),Rm.removeListener(this._showModal),Aa.Z.removeListener(this._contactsChanged),Gk.nextTick((()=>Vm.clearActiveMailComposer(this))),this.flushPendingChanges()}_updateSignature=e=>{const t=hm.Z.getAccountsAndAliases(),n=!!this.replied||!!this.forwarded,i=jk(e,t,n),s=this.selectedAccount?.signaturePosition||"below",o=this.refBody.current;if(!o)return;const a="below"!==s&&n?".viv-signature":".viv-signature-below",r=".viv-signature-below"===a?".viv-signature":".viv-signature-below";o.getWebview().executeScript({code:`\n      if (document.body.querySelector(':scope > ${a}') instanceof HTMLSpanElement) {\n        document.body.querySelector(':scope > ${a}').innerHTML = unescape('${escape(i)}');\n      }\n      if (document.body.querySelector(':scope > ${r}') instanceof HTMLSpanElement) {\n        document.body.querySelector(':scope > ${r}').innerHTML = unescape('${escape("")}');\n      }\n    `})};buildMessage=()=>this.refBody.current?this.refBody.current.getContentAsBodyParts().then(this.processBodyParts).then((e=>({from:this.state.from,to:this.state.to,cc:this.state.cc,bcc:this.state.bcc,subject:this.state.subject,sentDate:this.sentDate,threadKey:this.threadKey,bodyParts:e,flags:["\\Seen"],inReplyTo:this.inReplyTo,replied:this.replied,forwarded:this.forwarded,...this.references?{references:this.references}:null,internal:!0,messageId:this.messageId,queued:!1}))):Promise.reject();_createDraftMessage=e=>(0,mt.Z)(ue.of,ue.Wb,ue.kY,[e],{filteringPriority:ue.Un.HIGH}).then((e=>{if(this.threadKey=e[0].threadKey,this._isMounted){const t=`${this.props.url}&query={"id":${e[0].id}}`;y.Z.tabs.update(this.props.id,{url:t})}j.Z.updateIndex({addedSles:e}),ce.Z.filter(),ee.Z.updateThreads()}));updateAttribute=e=>this.props.id?e(this.props.id):this.draftCreated?Promise.resolve():(this.draftCreated=!0,this.buildMessage().then(this._createDraftMessage));updateBody=(0,Kf.default)((e=>this.updateAttribute((async t=>{await function(e,t){return vt.Z.messages.update(e,{bodyParts:t})}(t,e),this.updateIndex(t,{attachment:(0,zk.tZ)(e)})}))),5e3,{leading:!1});processBodyParts=e=>{if("html"===e[0].type){const{blobFreeHTML:t,cidsInUse:n,newImages:i}=(0,Nk.o6)(e[0].content),s=this.cidAttachments.filter((e=>e.id&&n.includes("cid:"+e.id)));return e[0].content=t,Promise.all(i.map((({dataOrBlobUrl:e,cid:t,mimeType:n,filename:i})=>fetch(e).then((e=>e.arrayBuffer())).then((e=>({type:"attachment",content:new Uint8Array(e),filename:i,id:t,mimeType:n})))))).then((t=>e.concat(this.state.attachments,s,t)))}return Promise.resolve(e.concat(this.state.attachments))};onBodyChange=()=>this._isMounted&&this.refBody.current?.getContentAsBodyParts?this.refBody.current.getContentAsBodyParts().then(this.processBodyParts).then(this.updateBody):Promise.reject();flushPendingChanges=async()=>{await this.toSelected.flush(),await this.ccSelected.flush(),await this.bccSelected.flush(),await this.subjectChange.flush(),await this.updateBody.flush()};cancelPendingChanges=()=>{this.toSelected.cancel(),this.ccSelected.cancel(),this.bccSelected.cancel(),this.subjectChange.cancel(),this.updateBody.cancel()};updateIndex=(e,t)=>{if(!this.threadKey)throw new Error("MailComposer: Trying to update an unsaved draft");const n=[{id:e,updates:t}];j.Z.updateIndex({sleUpdates:n})};fromChange=e=>{this.selectedAccount=hm.Z.getAccountsAndAliases().find((t=>t.MAIL_EMAIL===e.target.value)),this.setState({from:this.selectedAccount?[{name:this.selectedAccount.MAIL_NAME,address:this.selectedAccount.MAIL_EMAIL}]:[]},(()=>(this._updateSignature(this.state.from),this.updateAttribute((async e=>{await function(e,t){return vt.Z.transaction("rw",[vt.Z.messages,vt.Z.searchList],(()=>{vt.Z.searchList.update(e,{from:t}),vt.Z.messages.update(e,{from:t})}))}(e,this.state.from),this.updateIndex(e,{from:this.state.from})}))))),this.selectedAccount&&(this.messageId=(0,Vk.Z)(this.selectedAccount.MAIL_EMAIL))};toSelected=(0,Kf.default)((()=>this.updateAttribute((async e=>{await function(e,t){return vt.Z.transaction("rw",[vt.Z.messages,vt.Z.searchList],(()=>{vt.Z.searchList.update(e,{to:t}),vt.Z.messages.update(e,{to:t})}))}(e,this.state.to),this.updateIndex(e,{to:this.state.to})}))),5e3,{leading:!1});onToSelected=e=>{this.setState({to:[...e]},(()=>this.toSelected()))};ccSelected=(0,Kf.default)((()=>this.updateAttribute((e=>function(e,t){return vt.Z.transaction("rw",[vt.Z.messages,vt.Z.searchList],(()=>{vt.Z.searchList.update(e,{cc:t}),vt.Z.messages.update(e,{cc:t})}))}(e,this.state.cc)))),5e3,{leading:!1});onCcSelected=e=>{this.setState({cc:[...e]},(()=>this.ccSelected()))};bccSelected=(0,Kf.default)((()=>this.updateAttribute((e=>function(e,t){return vt.Z.messages.update(e,{bcc:t})}(e,this.state.bcc)))),5e3,{leading:!1});onBccSelected=e=>{this.setState({bcc:[...e]},(()=>this.bccSelected()))};subjectChange=(0,Kf.default)((()=>this.updateAttribute((async e=>{await function(e,t){return vt.Z.transaction("rw",[vt.Z.messages,vt.Z.searchList],(()=>{vt.Z.searchList.update(e,{subject:t}),vt.Z.messages.update(e,{subject:t})}))}(e,this.state.subject),this.updateIndex(e,{subject:this.state.subject})}))),5e3,{leading:!1});onSubjectChange=e=>{this.setState({subject:e.target.value},(()=>this.subjectChange()))};focusSubject=()=>{this.refSubject.current&&this.refSubject.current.focus()};removeAttachment=e=>{this.setState((t=>({attachments:t.attachments.filter(((t,n)=>n!==e))})),(()=>this.updateAttribute(this.onBodyChange)))};_queueMessage=()=>{Vm.queueMessage(this.context.vivaldiWindowId,!1)};_sendMessage=()=>{Vm.sendMessage(this.context.vivaldiWindowId)};_bind=()=>{wd.Z.bind("mod+enter",this._sendMessage),wd.Z.bind("mod+shift+enter",this._queueMessage)};_unbind=()=>{wd.Z.unbind("mod+enter",this._sendMessage),wd.Z.unbind("mod+shift+enter",this._queueMessage)};_onContextMenu=(e,t)=>{const n=[{handler:this.removeAttachment.bind(this,e),...(0,Mn.Z)("mail","Remove")}];(0,zi.Z)(this.context.vivaldiWindowId,n)(t)};render(){const{from:e,to:t,cc:n,bcc:i,subject:s,attachments:o}=this.state,a=this.props.prefValues[D.kMailComposeHeadersHidden];return $k("div",{id:"mail_composer"},void 0,$k("header",{},void 0,!a.includes("from")&&$k("div",{},void 0,$k("label",{htmlFor:"from"},void 0,(0,le.Z)("sender","From")),$k("div",{className:"headerItemWrapper"},void 0,(0,fn.jsxs)("select",{ref:this.refFrom,id:"from",onChange:this.fromChange,value:e.length>0?e[0].address:"",children:[hm.Z.getAccountsAndAliases().map(((e,t)=>$k("option",{value:e.MAIL_EMAIL},t,(e.MAIL_NAME?e.MAIL_NAME:"")+" ("+e.MAIL_EMAIL+")"))),")}"]}))),$k("div",{},void 0,$k("label",{htmlFor:"to"},void 0,(0,le.Z)("To")),$k("div",{className:"headerItemWrapper"},void 0,(0,fn.jsx)(Uk,{ref:this.refTo,id:"to",tabIndex:0===this.props.prefValues[D.kKeyboardTabToAll]?0:-1,selectedItems:t,allItems:this.state.mailAddresses,itemSelectionCallback:this.onToSelected}))),(n.length>0||!a.includes("cc"))&&$k("div",{},void 0,$k("label",{htmlFor:"cc",title:(0,le.Z)("Carbon copy")},void 0,(0,le.Z)("Cc")),$k("div",{className:"headerItemWrapper"},void 0,$k(Uk,{id:"cc",tabIndex:0===this.props.prefValues[D.kKeyboardTabToAll]?0:-1,selectedItems:n,allItems:this.state.mailAddresses,itemSelectionCallback:this.onCcSelected}))),(i.length>0||!a.includes("bcc"))&&$k("div",{},void 0,$k("label",{htmlFor:"bcc",title:(0,le.Z)("Blind carbon copy")},void 0,(0,le.Z)("Bcc")),$k("div",{className:"headerItemWrapper"},void 0,$k(Uk,{id:"bcc",tabIndex:0===this.props.prefValues[D.kKeyboardTabToAll]?0:-1,selectedItems:i,allItems:this.state.mailAddresses,itemSelectionCallback:this.onBccSelected}))),$k("div",{},void 0,$k("label",{htmlFor:"subject"},void 0,(0,le.Z)("Subject")),$k("div",{className:"headerItemWrapper"},void 0,(0,fn.jsx)("input",{type:"text",ref:this.refSubject,id:"subject",value:s,onChange:this.onSubjectChange}))),o.length>0&&$k("div",{},void 0,$k("label",{},void 0,(0,le.Z)("Attachments")),$k("div",{className:"composer-attachments"},void 0,o.map(((e,t)=>$k("div",{onContextMenu:this._onContextMenu.bind(this,t),className:"attachment",title:e.filename},`attachment${t}`,$k("span",{className:"attachment-title"},void 0,e.filename),$k("button",{className:"attachment-remove",tabIndex:0===this.props.prefValues[D.kKeyboardTabToAll]?0:-1,onClick:this.removeAttachment.bind(this,t),dangerouslySetInnerHTML:{__html:cn.kze}}))))))),$k("main",{},void 0,this.state.showModal&&$k(wk,{title:(0,le.Z)("Missing Recipients"),prompt:[(0,le.Z)("At least one address must be added to the To, Cc, or Bcc fields in order to send this email.")],positive:(0,le.Z)("OK"),onClose:this._hideModal,hideNegative:!0}),(0,fn.jsx)(Ok,{ref:this.refBody,windowId:this.context.vivaldiWindowId,focusPreviousElement:this.focusSubject,onBodyChange:this.onBodyChange,onContentLoad:this.onContentLoad})))}}const Qk=(0,fs.Z)(Xk,Kk);var qk;function Jk(e,t,n,i){qk||(qk="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:qk,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const eA=function(e){return Jk("div",{className:"MailDisabled"},void 0,Jk("h1",{},void 0,(0,le.Z)("Mail, Calendar and Feeds are Turned Off")),Jk("p",{},void 0,(0,le.Z)("Vivaldi email client is turned off. Go to Settings\n        to enable it, set up accounts or change preferences.")),Jk("input",{type:"button",onClick:()=>ie.Z.showSettings(e.windowId,"general",{scroll:"features"}),tabIndex:0,value:(0,le.Z)("Go to Settings")}))};var tA;function nA(e,t,n,i){tA||(tA="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:tA,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function iA(e){const{markup:t,style:n,prepend:i}=e;return`{\n  let container = document.querySelector('.VIVcontainer');\n  if (!container) {\n    container = document.createElement('div');\n    container.className = 'VIVcontainer';\n    container.style = 'all:initial';\n    document.body.${i?"prepend":"append"}(container);\n  }\n  let style;\n  let content;\n  let shadowRoot;\n  if (!container.shadowRoot) {\n    style = document.createElement('style');\n    content = document.createElement('div');\n    shadowRoot = container.attachShadow({ mode: 'open' });\n    shadowRoot.appendChild(style);\n    shadowRoot.appendChild(content);\n  } else {\n    shadowRoot = container.shadowRoot;\n    style = shadowRoot.querySelector('style');\n    content = shadowRoot.querySelector('div');\n  }\n  style.textContent = ${JSON.stringify(n)};\n  content.innerHTML = ${JSON.stringify(t)};}`}class sA extends tn.PureComponent{static contextType=dn.Z;refWebview=tn.createRef();refContentBlockedToggle=tn.createRef();state={leakPrevented:!1};componentDidUpdate(e){if(!(0,Sm.default)(e.style,this.props.style)){const e=lT.Z.createStyleRoot(this.props.style);this.refWebview.current?.executeScript({code:`\n        document.styleSheets[0].deleteRule(0);\n        document.styleSheets[0].insertRule("${e}", 0\n        );`})}const{textOrHtml:t,blockHTTPLeaks:n,bodyParts:i,isRss:s,renderingMethod:o}=this.props,{content:a,type:r}=t,l=this.refWebview.current;let d=!1;if(e.textOrHtml!==t||"html"===r&&e.blockHTTPLeaks!==n){let e,t=!1;if("raw"===o){const t=document.createTextNode(a),n=document.createElement("p");n.appendChild(t),e=`<html>${this.getDefaultStyle(!1)}<body>${n.innerHTML}</body></html>`}else if("html"===r){const o={};(i||[]).forEach((e=>{"attachment"===e.type&&e.id&&(o["cid:"+e.id]=e)}));const r=(0,Nk.Nw)(a,{attachments:o,blockHTTPLeaks:n});t=r.leakPrevented,e=s?this.getDefaultRssStyle()+r.sanitized:this.getDefaultStyle(!0)+r.sanitized}else e=`<html>${this.getDefaultStyle(!1)}<body>${ve(a)}</body></html>`;this.setState({leakPrevented:t}),l?.executeScript&&(d=!0,l.executeScript({code:`document.open();\n           document.write(${JSON.stringify(e)});\n           document.close();`}))}this.props.inject&&(d||e.inject!==this.props.inject)&&l?.executeScript({code:iA(this.props.inject)})}updateWebviewEventListeners=e=>{const t=this.refWebview.current,n=e;this.refWebview.current=n,t&&(t.removeEventListener("newwindow",this.handleNewWindow),t.removeEventListener("targeturlchanged",this.handleTargetURLChanged),t.removeEventListener("consolemessage",this.handleConsoleMessage),t.removeEventListener("fullscreen",this.handleOnFullscreen)),n&&(d.Z.zoom.getDefaultZoom((e=>n.setZoom(e))),n.addEventListener("newwindow",this.handleNewWindow),n.addEventListener("targeturlchanged",this.handleTargetURLChanged),n.addEventListener("consolemessage",this.handleConsoleMessage),n.addEventListener("fullscreen",this.handleOnFullscreen))};handleOnFullscreen=e=>{Ru.Z.onHTML5FullScreen(e.enterFullscreen,this.context.vivaldiWindowId)};handleNewWindow=e=>{switch(e.preventDefault(),e.windowOpenDisposition){case"current_tab":case"new_foreground_tab":e.window.accept(this.context.vivaldiWindowId+";1");break;case"new_background_tab":e.window.accept(this.context.vivaldiWindowId+";0");break;case"new_window":Ru.Z.openBrowserWindow(this.context.vivaldiWindowId,e.targetUrl);break;case"off_the_record":Ru.Z.openBrowserWindow(this.context.vivaldiWindowId,e.targetUrl,{incognito:!0})}};handleTargetURLChanged=({newUrl:e})=>{const t=(0,_C.ZP)(e);X.Z.setStatus(this.context.vivaldiWindowId,t)};handleConsoleMessage=e=>{const t=this.props.inject&&this.props.inject.messageHandler;t&&"function"==typeof t&&t(e)};getDefaultStyle=e=>`<style type="text/css">\n    ${lT.Z.createStyleRoot(this.props.style)}\n    html {\n      overflow-y: auto;\n    }\n    body {\n      ${e?"":"white-space: pre-wrap;"}\n      ${e?"":"overflow-wrap: break-word;"}\n      color: ${e?"black":"var(--colorFgIntense)"};\n      background-color: ${e?"white":"var(--colorBgIntense)"};\n      font-family: ${e?"sans-serif":"monospace"};\n      margin: 24px;\n      line-height: 1.3;\n      height: auto !important;\n      min-height: calc(100% - 48px);\n    }\n    ${e?"":"a { color: var(--colorHighlightBg); }"}\n    img {\n      display: inline-block;\n      vertical-align: top;\n      max-width: 100%;\n      height: auto;\n    }\n    </style>`;getDefaultRssStyle=()=>`<style type="text/css">\n    ${lT.Z.createStyleRoot(this.props.style)}\n    html {\n      background: var(--colorBgIntense);\n      color: var(--colorFgIntense);\n      font-family: sans-serif;\n      overflow-y: auto;\n    }\n    body {\n      margin: 24px;\n      height: auto !important;\n      min-height: calc(100% - 48px);\n    }\n    body > main {\n      font-size: initial;\n      /* feeds should not be using these variables */\n      /* prevent the feed from copying a custom theme for phishing */\n      --colorBg: white;\n      --colorFg: black;\n    }\n    body > main a {\n      color: var(--colorHighlightBg);\n    }\n    body > nav ul.mainbutton a {\n      display: inline-block;\n      padding: 0.3em 12px;\n      font-size: initial;\n      color: var(--colorHighlightFg);\n      background-color: var(--colorHighlightBg);\n      border-radius: 4px;\n    }\n    body > nav ul.mainbutton::after {\n      content: "";\n      display: block;\n      border-bottom: 1px solid var(--colorBorder);\n      height: 0.7em;\n      opacity: 0.3;\n    }\n    body > nav h2,\n    body > section h2 {\n      font-weight: normal;\n      font-size: larger;\n    }\n    body > nav h2::after,\n    body > section h2::after {\n      content: ":";\n    }\n    body > nav ul,\n    body > nav li {\n      display: block;\n      margin-left: 0;\n      padding-left: 0;\n    }\n    body > nav a {\n      color: var(--colorHighlightBg);\n      text-decoration: none;\n    }\n    body > section img,\n    body > section video,\n    main img,\n    main video,\n    main image,\n    main image,\n    main object,\n    main embed {\n      max-width: 100%;\n      /* allow default image ratio to work in cases where height has been set */\n      height: auto !important;\n    }\n    main iframe {\n      border-radius: var(--radius);\n      border: none;\n      max-width: 100%;\n    }\n    body > footer {\n      opacity: 0.5;\n    }\n\n    div.video-wrapper {\n      background: #111;\n      margin-left: -24px;\n      margin-top: -24px;\n      margin-right: -24px;\n      margin-bottom: 24px;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    }\n\n    div.video-wrapper iframe {\n      --cinema-mode-height: 40vw;\n      height: var(--cinema-mode-height);\n      width: calc(var(--cinema-mode-height) / .5625);\n      min-height: 320px;\n      max-height: 100vh;\n    }\n\n    div.preformatted {\n      white-space: pre-wrap;\n    }\n\n    /* Overrides for specific feed issues */\n    main figure[style*="width"] {\n      /* WordPress hard codes a width which creates scrollbars.\n      Max-width does not fix it because of the default margin.\n      Fix it without breaking feeds that have floating figures. Assume that if\n      a figure has a style attribute with width, it is probably not well\n      styled, and width should be ignored. */\n      width: auto !important;\n    }\n    </style>`;handleLoadExternalContentClicked=()=>{const e=this.refContentBlockedToggle.current?.checked??!1;this.props.onUnblockExternalContent(e)};showOriginalHTML=()=>{Nl.Z.toggleRenderingMethod("prefer_html")};render(){const{fromAddress:e}=this.props,{leakPrevented:t}=this.state,{convertedFromHtml:n=!1}=this.props.textOrHtml;return(0,fn.jsxs)(fn.Fragment,{children:[n&&nA("div",{className:"mail-content-blocked"},void 0,nA("div",{className:"content-blocked-text"},void 0,(0,le.Z)("This message was converted from HTML.")),nA("input",{className:"content-blocked-action",type:"button",onClick:this.showOriginalHTML,value:(0,le.Z)("Show original HTML version")})),t&&nA("div",{className:"mail-content-blocked"},void 0,nA("div",{className:"content-blocked-text"},void 0,(0,le.Z)("This message was prevented from loading external content.")),nA("label",{title:(0,le.Z)("Always allow $1",[e]),className:"content-blocked-toggle-container"},void 0,(0,fn.jsx)("input",{className:"content-blocked-toggle",ref:this.refContentBlockedToggle,type:"checkbox"}),nA("span",{className:"content-blocked-toggle-text"},void 0,(0,le.Z)("Always allow $1",[e]))),nA("input",{className:"content-blocked-action",type:"button",title:(0,le.Z)("Load External Content"),onClick:this.handleLoadExternalContentClicked,value:(0,le.Z)("Load External Content")})),nA("div",{className:"mail_body"},void 0,nA("section",{tabIndex:"0"},void 0,(0,fn.jsx)("webview",{name:"vivaldi-mail",ref:this.updateWebviewEventListeners,src:"data:text/html,<html/>"})))]})}}const oA=sA;var aA=n(88630);var rA=n(70611);async function lA(e){const{mimeTree:t,raw:n}=await Ma.Z.getMimeTree(e);return new dA(t,n)}class dA{constructor(e,t){this.lock=function(){let e=Promise.resolve();return async function(){const t=e;let n;if(e=new Promise((e=>n=e)),await t,!n)throw new Error("createMutex.lock: Expected release to be defined");return n}}(),this.mimeTree=e,this.raw=t}async getByteString(){let e="";const t=await this.lock();try{e=(0,la.Z)(this.raw)}finally{t()}return e}async parse(e){let t=[];const n=await this.lock();try{const i=await Ma.Z.parse(this.raw,e);t=i.bodyParts,this.raw=i.raw}finally{n()}return t}#y;async parseAttachments(){if(this.#y)return this.#y;const e=[],t=(0,Ra.Dc)(this.mimeTree);for(const n of t){(await this.parse(n.mimeTree)).forEach((t=>{"attachment"===t.type&&e.push(t)}))}return this.#y=e,e}async parseCalendar(){let e;const t=(0,Ra.fN)(this.mimeTree);if(t){const n=await this.parse(t.mimeTree);n.length&&(e=n[0])}return e}#w;#b;async parseMainPart(e){if(this.#w&&this.#b===e)return this.#w;let t=(0,Ra.yQ)(this.mimeTree,e),n=!1;if(t||"plaintext"!==e||(t=(0,Ra.yQ)(this.mimeTree,"prefer_html"),t&&(n=!0)),!t)return[];let i=[];const s=await this.lock();try{const e=await Ma.Z.parse(this.raw,t.mimeTree);if(n){for(const t of e.bodyParts)if("html"===t.type){i=[{type:"text",content:(0,rA.yy)(t.content),convertedFromHtml:!0}];break}}else i=e.bodyParts;this.raw=e.raw}finally{s()}return this.#w=i,this.#b=e,i}async parseSearchPart(){const e=(0,Ra.PW)(this.mimeTree);if(!e)return[];let t=[];const n=await this.lock();try{const i=await Ma.Z.parse(this.raw,e.mimeTree);t=i.bodyParts,this.raw=i.raw}finally{n()}return t}async saveAs(e){const t=await this.lock(),n=new Blob([this.raw],{type:"message/rfc822"}),i=URL.createObjectURL(n);y.Z.downloads.download({url:i,filename:e,saveAs:!0},(e=>{URL.revokeObjectURL(i),t()}))}async writeBufferToDisk(e,t,n){const i=await this.lock();try{await La.Z.call(e,t,n,this.raw)}finally{i()}}}var cA=n(34930);function hA(e,t){return vt.Z.messages.update(e,{rsvpState:t})}var pA=n(82191);function uA(e="Undefined"){const t=(Lo.Z.getEvents()||[]).find((t=>t.uid===e&&!t.trash));if(!t)throw new Error(`Event with uid "${e}" not found.`);return t}const gA=new class{async replyToInvite(e,t,n,i){if("DECLINECOUNTER"===i)return void de.Z.error("Calendar",["invite"],"Can not reply to invite with method",i);let s,o=!1,a=!1;try{s=uA(t.uid)}catch(e){}if(s&&s.invites?s.invites.forEach((e=>{if(e.address===n){e.partstat=i,o=!0;const{event_id:t,...n}=e;d.Z.calendar.updateInvite(n)}})):t.invites&&t.invites.forEach((e=>{e.address===n&&(e.partstat=i,o=!0,"ACCEPTED"!==i&&"TENTATIVE"!==i||(a=!0))})),!o)return void de.Z.warn("Calendar",["invite"],"Attendee not found. Not replying to event invite");let r=s;a&&(r=await this.addEventToCalendar(e,t)),r||(r=function(e){const t=(e.invites||[]).map((e=>({...e,event_id:"",id:""}))),n=(e.notifications||[]).map((e=>({...e,id:""}))),{is_template:i,...s}=e;return{...s,id:"",start:e.start||0,end:e.end||0,notifications:n,invites:t,attachment:oc.Z.stringToAttachments(e.attachment)}}(t));const l=(r.invites||[]).find((e=>e.address===n));if(!l)throw new Error("Attendee email address not found");{r.invites=[l],await cA.Z.sendReplyMails(e,r,n,i);const t=Nl.Z.getActiveMessage();t&&(t.rsvpState=i,hA(t.id,t.rsvpState),Wm.Z.setActiveMessage(t))}}async declineCounter(e,t,n){let i;try{i=uA(t.uid)}catch(e){return void de.Z.error("Calendar",["invite"],"Error finding existing event to decline counter for",t)}await cA.Z.sendReplyMails(e,i,n,"DECLINECOUNTER");const s=Nl.Z.getActiveMessage();if(s){const e={...s,rsvpState:"DECLINECOUNTER"};hA(e.id,e.rsvpState),Wm.Z.setActiveMessage(e)}}addEventToCalendar(e,t){const{recurrence:n,...i}=t;return n&&(i.rrule=pA.Ci.optionsToString({...n.origOptions,count:0===n.origOptions.count?1:n.origOptions.count})),o.Z.createEvent(e,i)}updateEventInCalendar(e,t,n){const{is_template:i,...s}=t,a=n.invites||[],r=s.invites||[],l=a.map((e=>{const t=r.find((t=>t.address===e.address));if(t)return e.partstat=t.partstat,e.name=t.name,e})).filter(Boolean);r.forEach((e=>{a.find((t=>t.address===e.address))||l.push({...e,event_id:n.id,id:""})}));const d={...s,id:n.id,start:s.start||n.start,end:s.end||n.end,notifications:n.notifications,invites:l,attachment:oc.Z.stringToAttachments(s.attachment)};o.Z.updateEvent(e,d)}handleCancellation(e,t,n){const i={pageId:Lo.Z.getMailResourceKey()},s=uA(t.uid);if(n){const t=(0,Xo.Uq)(n),a=`${s.id}:${t}`;o.Z.trashEvent(e,i,a,"single")}else o.Z.trashEvent(e,i,s.id)}handleReply(e){const t=uA(e.uid);if(!t.invites)throw new Error("Target event missing invites data.");if(!e.invites)throw new Error("Incoming event missing invites data.");const n=e.invites[0];let i=!1;t.invites.forEach((e=>{e.address===n.address&&(d.Z.calendar.updateInvite({id:e.id,partstat:n.partstat}),i=!0)})),i&&o.Z.loadPromise()}},mA=gA;var vA=n(15805);const fA=function(){const[e,t]=tn.useState(Lo.Z.getEvents());return tn.useEffect((()=>{const e=e=>{"calendarDataReady"===e&&t(Lo.Z.getEvents())};return Lo.Z.addListener(e),()=>{Lo.Z.removeListener(e)}}),[]),e};var yA,wA=n(34155);function bA(e,t,n,i){yA||(yA="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:yA,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const CA=function(e,t){return"0"!==e&&e.length<t?e.padStart(t,"0"):e.length>t?e.slice(e.length-t):e};class SA extends tn.PureComponent{_focused=!1;hidden=tn.createRef();fieldRefs={day:this.props.dayInputRef||tn.createRef(),month:tn.createRef(),year:tn.createRef()};inputPosition=-1;constructor(e){super(e),this._template=function(e){function t(e,t){return t.findIndex((t=>t[0].toUpperCase()===e[0].toUpperCase()&&t.length<e.length))}function n(e){return["d","m","y"].includes(e?.[0].toLowerCase())}const i=e.match(/(d+|m+|y+)|([^dmy]*)/gi)?.slice(0,-1);if(!i)throw new Error("Incompatible date format found: "+e);const s=[],o=[];let a="",r=i.shift();for(;r;){for(;!n(r);)r=i.shift();-1!==t(r,i)||a.includes(r[0].toLowerCase())||(s.push(r),a+=r[0].toLowerCase(),n(i[0])?o.push(""):o.push(i.shift())),r=i.shift()}if(3!==s.length)throw new Error("Incompatible date format found: "+e);return{fields:s.map((t=>{switch(t[0].toLowerCase()){case"d":return{type:"day",format:"dd"};case"m":return{type:"month",format:"mm"};case"y":return{type:"year",format:"yyyy"};default:throw new Error(`Unexpected date format group: ${t}, ${e}`)}})),separators:o}}(this.getFormat());const[t,n,i]=this.props.value.split("-");this.state={year:t,month:n,day:i}}componentDidUpdate(e){e.value!==this.props.value&&this.setCache()}setCache=()=>{const[e,t,n]=this.props.value.split("-");this.setState({year:e,month:t,day:n})};getFormat=()=>this.props.format||b().localeData().longDateFormat("L");processChange=e=>{this.props.onChange(e)};select=e=>{this.inputPosition=-1,e.target instanceof HTMLInputElement&&(e.preventDefault(),e.target.select())};focus=()=>{this.fieldRefs[this._template.fields[0].type]?.current?.focus()};onKeyDown=e=>{const{key:t,target:n}=e,i=n.dataset.type,s=this._template.fields.findIndex((e=>e.type===i));if(t&&("ArrowLeft"===t||"ArrowRight"===t||"ArrowDown"===t))switch(t){case"ArrowRight":e.preventDefault();const t=this.fieldRefs[this._template.fields[s+1].type];return void(t&&t.current.select());case"ArrowLeft":e.preventDefault();const n=this.fieldRefs[this._template.fields[s-1].type];return void(n&&n.current.select());case"ArrowDown":return void(e.altKey&&(e.preventDefault(),this.hidden.current?.focus()))}isNaN(Number(t))&&wA.nextTick((()=>{document.activeElement instanceof HTMLInputElement&&document.activeElement.select()}))};skipToNextField(e){const t=this._template.fields.length,n=this._template.fields.findIndex((t=>t.type===e))+1;n===t&&(this.props.autoFocusNextElement??M.Z.get(D.kCalendarAutoTabDatetime))?as(document):wA.nextTick((()=>{const e=this._template.fields[Math.min(n,t-1)].type;this.fieldRefs[e].current?.select()}))}onChangeDate=e=>{const{type:t}=e.target.dataset;let n=parseInt(e.target.value);const i=[this.state.year,this.state.month,this.state.day],s=!e.nativeEvent.inputType,o=s&&this.props.step?parseInt(this.props.step):1;let a=!1;if(s&&"day"===t){const e=parseInt(this.state.day);a=!0,n=n<e?e-o:e+o}const r="year"===t?4:2,l="year"===t?9999:"month"===t?12:b()(this.props.value).daysInMonth(),d=e.target.value===r||s?1:0;parseInt(n)>l?s?n%=l:n=l:n<d&&(n=s?l:d);let c=n.toString();s&&(c=CA(c,r)),a&&e.target.setAttribute("value",c),!s&&(10*n>l||e.target.value.length>=r)&&(c=CA(c,r),this.skipToNextField(t)),this.setState({[t]:c},(()=>{const e=["year","month","day"].indexOf(t);if(c.length<r)return;i[e]=c;const n=b()(i.join("-"));if(n.isValid()){if(this.props.min&&n.isBefore(b()(this.props.min))||this.props.max&&n.isAfter(b()(this.props.max)))return;const e=this.hidden.current,t=(Object.getOwnPropertyDescriptor(HTMLInputElement.prototype,"value")||{}).set;e&&t&&(t.call(e,(0,F.SI)(n)),e.dispatchEvent(new Event("input",{bubbles:!0})))}}))};onFocus=e=>{if(e.persist(),e.preventDefault(),this._focused)return;const t=e.target.closest(".dateInput");wA.nextTick((()=>{this.props.onFocus&&t instanceof HTMLElement&&ss(t)&&(this._focused=!0,this.props.onFocus(e))}))};onBlur=e=>{const t=this._template.fields.reduce(((e,t)=>{const n=this.state[t.type];return n.length<t.format.length&&(e[t.type]=CA(n,t.format.length)),e}),{});Object.keys(t).length>0&&this.setState(t),e.preventDefault(),e.persist();const n=e.target.closest(".dateInput");wA.nextTick((()=>{this.props.onBlur&&n instanceof HTMLElement&&!ss(n)&&(this._focused=!1,this.props.onBlur(e))}))};keepFocusWithin=e=>{e.preventDefault(),ss(e.target.nextElementSibling)||this.focus()};renderFields=()=>{const e=[this._template.fields[0].type,this._template.separators[0]??"/",this._template.fields[1].type,this._template.separators[1]??"/",this._template.fields[2].type],t={onFocus:this.select,onMouseDown:this.select,onMouseUp:e=>e.preventDefault(),onKeyDown:this.onKeyDown,onChange:this.onChangeDate,disabled:this.props.disabled};return bA("span",{className:"faux date"},void 0,e.map(((e,n)=>{switch(e.toLowerCase()){case"day":return(0,tn.createElement)("input",{...t,key:"dd_"+n,className:"dateInputDay",type:"number",ref:this.fieldRefs.day,"data-type":"day",tabIndex:this.props.tabIndex,placeholder:(0,le.Z)("dd"),value:this.state.day});case"month":return(0,tn.createElement)("input",{...t,key:"mm_"+n,className:"dateInputMonth",type:"number",ref:this.fieldRefs.month,"data-type":"month",tabIndex:this.props.tabIndex,placeholder:(0,le.Z)("date","mm"),value:this.state.month});case"year":return(0,tn.createElement)("input",{...t,key:"yy_"+n,className:"dateInputYear",type:"number",ref:this.fieldRefs.year,"data-type":"year",tabIndex:this.props.tabIndex,placeholder:(0,le.Z)("yyyy"),value:this.state.year});default:return bA("span",{className:"dateInputSeparator"},"separator_"+n,e)}})))};render(){const{format:e,onChange:t,tabIndex:n,onFocus:i,onBlur:s,dayInputRef:o,...a}=this.props;return bA("span",{className:"dateInput",title:this.props.title,onBlur:this.onBlur,onFocus:this.onFocus},void 0,(0,fn.jsx)("input",{...a,type:"date",ref:this.hidden,tabIndex:"-1",className:"dateInputHidden",onMouseDown:this.keepFocusWithin,onChange:this.processChange}),this.renderFields(),bA("span",{className:"arrowDown",dangerouslySetInnerHTML:{__html:cn.yaZ.medium}}))}}const TA=SA;var IA,kA=n(15048),AA=n(80008),ZA=n.n(AA),EA=n(47543);function _A(e){return{[pA.Ci.DAILY]:"days",[pA.Ci.WEEKLY]:"weeks",[pA.Ci.MONTHLY]:"months",[pA.Ci.YEARLY]:"years"}[e]||"none"}function NA(e,t,n,i){IA||(IA="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:IA,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const MA=new Map([["none",{name:(0,le.Z)("No repeat"),frequency:void 0}],["days",{name:(0,le.Z)("Daily"),frequency:pA.Ci.DAILY}],["weeks",{name:(0,le.Z)("Weekly"),frequency:pA.Ci.WEEKLY}],["months_dom",{name:(0,le.Z)("Monthly by date"),frequency:pA.Ci.MONTHLY}],["months_dow",{name:(0,le.Z)("Monthly by week"),frequency:pA.Ci.MONTHLY}],["years",{name:(0,le.Z)("Yearly"),frequency:pA.Ci.YEARLY}]]),PA=e=>{if(!e)return(0,le.Z)("No repeat");const{count:t,dtstart:n,until:i,interval:s=1}=e.origOptions,o=ZA()(n).format("LL");let a="",r="";if(s<=2)switch(e.origOptions.freq){case pA.Ci.DAILY:a=(0,le.Z)("Repeats daily","Repeats every other day",[s]);break;case pA.Ci.WEEKLY:a=(0,le.Z)("Repeats weekly","Repeats every other week",[s]);break;case pA.Ci.MONTHLY:a=(0,le.Z)("Repeats monthly","Repeats every other month",[s]);break;case pA.Ci.YEARLY:a=(0,le.Z)("Repeats yearly","Repeats every other year",[s])}else switch(e.origOptions.freq){case pA.Ci.DAILY:a=(0,le.Z)("Repeats every $1 days","Repeats every $1 days",[s]);break;case pA.Ci.WEEKLY:a=(0,le.Z)("Repeats every $1 weeks","Repeats every $1 weeks",[s]);break;case pA.Ci.MONTHLY:a=(0,le.Z)("Repeats every $1 months","Repeats every $1 months",[s]);break;case pA.Ci.YEARLY:a=(0,le.Z)("Repeats every $1 years","Repeats every $1 years",[s])}if(t&&t>0)r=(0,le.Z)("$1 time beginning $2","$1 times beginning $2",[t,o]);else if(i){const e=ZA()(i).format("LL");r=(0,le.Z)("from $1 to $2",[o,e])}else r=(0,le.Z)("beginning $1",[o]);return(0,le.Z)("$1, $2",[a,r])};var DA=NA("hr",{});class xA extends tn.Component{static contextType=dn.Z;constructor(e){super(e);const t=ZA()().startOf("week");this.week=[...Array(7).keys()].map((()=>{const e={name:t.format("dddd"),number:(t.day()+6)%7};return t.add(1,"day"),e})),this.state={showMonthPicker:!1,bymonthday:[],monthDates:""}}static getDerivedStateFromProps(e,t){const{recurrence:n}=e.event,i={bymonthday:n?n.origOptions.bymonthday:void 0};return n&&t.bymonthday!==n.origOptions.bymonthday&&(i.monthDates=(0,EA.v1)(n).join(", "),i.bymonthday=n.origOptions.bymonthday),i}domPickerRef=tn.createRef();storedFocusElement=null;isTypingDate=!1;endDateElement=tn.createRef();changeField=e=>{const{recurrence:t}=this.props.event;if(!t)return;let{value:n}=e.currentTarget;const i=e.currentTarget.name;"number"===e.currentTarget.type&&(n=parseInt(n),(isNaN(n)||n<1)&&(n=0),"count"===i&&n&&(n+=1)),this.props.event.recurrence=(0,EA.yu)(t,{[i]:n}),this.props.updateEvent(this.props.event)};verifyValidValue=e=>{const{recurrence:t}=this.props.event;if(!t)return;const n=e.currentTarget.name;let{value:i}=e.currentTarget;"number"===e.currentTarget.type&&(i=parseInt(i),(isNaN(i)||i<1)&&(i=1,"count"===n&&(i+=1),this.props.event.recurrence=(0,EA.yu)(t,{[n]:i}),this.props.updateEvent(this.props.event)))};changeRecurrence=e=>{this.props.updateEvent(function(e,t){const n=new Date((0,bc.oJ)(t));let i;switch(e){case"days":i=(0,EA.Zm)({dtstart:n,freq:pA.Ci.DAILY,interval:1});break;case"weeks":i=(0,EA.Zm)({dtstart:n,freq:pA.Ci.WEEKLY,interval:1,byweekday:(n.getDay()+6)%7});break;case"months_dom":i=(0,EA.Zm)({dtstart:n,freq:pA.Ci.MONTHLY,interval:1,bymonthday:n.getDate()});break;case"months_dow":const e=Math.ceil(n.getDate()/7),t=(0,EA._7)(n.getDay()).nth(e);i=(0,EA.Zm)({dtstart:n,freq:pA.Ci.MONTHLY,interval:1,byweekday:t});break;case"years":i=(0,EA.Zm)({dtstart:n,freq:pA.Ci.YEARLY,interval:1})}return t.recurrence=i,t}(e.currentTarget.value,this.props.event))};changeDate=e=>{this.props.updateEvent(function(e,t){const n=t.recurrence;return n?(t.recurrence=(0,EA.yu)(n,{until:ZA()(e).endOf("day").toDate(),count:void 0}),t):t}(e.currentTarget.value,this.props.event))};changeEnds=e=>{this.props.updateEvent(function(e,t){const n=t.recurrence;if(!n)return t;let i;switch(e){case"forever":i=(0,EA.yu)(n,{until:void 0,count:void 0});break;case"endDate":const e=_A(n.origOptions.freq);i=(0,EA.yu)(n,{count:void 0,until:ZA()((0,bc.oJ)(t)).add(1,e).toDate()});break;case"count":i=(0,EA.yu)(n,{count:2,until:void 0})}return t.recurrence=i,t}(e.target.value,this.props.event))};changeDayOfMonth=e=>{const{recurrence:t}=this.props.event;if(!t)return;const n=this.state.monthDates.split(",").map((e=>parseInt(e))).filter((e=>e>=1&&e<=31));n.length&&(this.props.event.recurrence=(0,EA.yu)(t,{bymonthday:n}),this.props.updateEvent(this.props.event))};typeDayOfMonth=e=>{this.setState({monthDates:e.currentTarget.value})};toggleDayOfMonthPicker=()=>{const{document:e}=this.context;this.setState((e=>({showMonthPicker:!e.showMonthPicker})),(()=>{if(this.state.showMonthPicker){this.storedFocusElement=e.activeElement;const t=e.querySelector("button[name='1-dayOfMonth']");t&&t.focus()}}))};hideDayOfMonthPicker=()=>{this.setState({showMonthPicker:!1},(()=>{this.storedFocusElement&&(this.storedFocusElement.focus(),this.storedFocusElement=null)}))};dayOfWeekPickerClick=e=>{e.target.focus();const{recurrence:t}=this.props.event;if(!t)return;const n=parseInt(e.target.name);if(isNaN(n))throw new Error("Can not select day, invalid day value");const i=new Set((0,EA.IK)(t));i.has(n)&&i.size>1?i.delete(n):i.add(n),this.props.event.recurrence=(0,EA.yu)(t,{byweekday:Array.from(i)}),this.props.updateEvent(this.props.event)};dayOfMonthPickerClick=e=>{e.target.focus();const t=parseInt(e.target.name);this.selectDayOfMonth(t)};selectDayOfMonth=e=>{const{recurrence:t}=this.props.event;if(!t)return;const n=new Set((0,EA.v1)(t));n.has(e)&&n.size>1?n.delete(e):n.add(e),this.props.event.recurrence=(0,EA.yu)(t,{bymonthday:Array.from(n).sort(((e,t)=>e-t))}),this.props.updateEvent(this.props.event)};monthPickerBlur=e=>{const t=this.domPickerRef.current;t&&e.relatedTarget instanceof Node&&!t.contains(e.relatedTarget)&&this.setState({showMonthPicker:!1})};dayOfWeekPickerKeyDown=e=>{const{document:t}=this.context,n=t.activeElement;if(!n||!n.hasAttribute("name"))return;const i=ZA()().localeData().firstDayOfWeek(),s=(parseInt(n.name)-i+7)%7;let o=null;switch(kA.Z[e.keyCode]){case"Left":s>0&&(o=s-1);break;case"Right":s<6&&(o=s+1);break;default:return}if(null!==o){o=(o+i)%7;const e=t.querySelector(`button[name='${o}-dayOfWeek']`);e&&(e.tabIndex=0,e.focus(),n.tabIndex=-1)}};dayOfMonthPickerKeyDown=e=>{if(!this.state.showMonthPicker&&"Down"===kA.Z[e.keyCode])return void this.toggleDayOfMonthPicker();const{document:t}=this.context,n=t.activeElement;if(!n||!n.hasAttribute("name"))return;const i=parseInt(n.name);let s;switch(kA.Z[e.keyCode]){case"Up":i>7&&(s=i-7);break;case"Down":i<25&&(s=i+7);break;case"Left":i%7!=1&&(s=i-1);break;case"Right":i%7!=0&&(s=i+1);break;case"Enter":return this.selectDayOfMonth(i),void e.stopPropagation();case"Escape":return e.stopPropagation(),void this.hideDayOfMonthPicker();default:return}if(s){const e=t.querySelector(`button[name='${s}-dayOfMonth']`);e&&e.focus()}};weekOfMonthChange=e=>{const{recurrence:t}=this.props.event;if(!t)return;const n=parseInt(e.currentTarget.value);let[i,s]=e.currentTarget.name.split("-");i=parseInt(i);const o=(0,EA.QX)(t),a=o[i];"weekOfMonthWeek"===s?o[i]=o[i].nth(n):"weekOfMonthDay"===s&&(o[i]=EA.z3[n],void 0!==a.n&&(o[i]=o[i].nth(a.n))),this.props.event.recurrence=(0,EA.yu)(t,{byweekday:o}),this.props.updateEvent(this.props.event)};addWeekOfMonth=()=>{const{event:e}=this.props,{recurrence:t}=e;if(!t)return;const n=ZA()(e.start),i=Math.ceil(n.date()/7),s=(0,EA._7)(n.day()).nth(i),o=(0,EA.QX)(t);o.push(s),e.recurrence=(0,EA.yu)(t,{byweekday:o}),this.props.updateEvent(e)};deleteWeekOfMonth=e=>{const t=parseInt(e.currentTarget.name),{event:n}=this.props,{recurrence:i}=n;if(!i)return;const s=(0,EA.QX)(i).splice(t,1),o=(0,EA.yu)(i,{byweekday:s});n.recurrence=o,this.props.updateEvent(n)};renderWeekSelection(){const{recurrence:e}=this.props.event;if(!e)return null;const t=(0,EA.IK)(e);return NA("div",{className:"edit-group capped-width"},void 0,NA("div",{className:"toolbar toolbar-default calendar-week-picker"},void 0,NA("div",{className:"toolbar toolbar-group"},void 0,this.week.map(((e,n)=>{const i=t.includes(e.number),s=`${e.number}-dayOfWeek`;return NA(tn.Fragment,{},s,NA(sl,{name:s,onClick:this.dayOfWeekPickerClick,onKeyDown:this.dayOfWeekPickerKeyDown,title:e.name.substr(0,1),tooltip:e.name,tabIndex:i?this.props.tabIndex:-1,isPressed:i}),n<this.week.length-1&&DA)})))))}renderDayOfMonthSelection(){const{event:e}=this.props,{recurrence:t}=e;if(!t)return null;const n=(0,EA.v1)(t);return NA("div",{className:"edit-group capped-width"},void 0,NA("label",{},void 0,NA("span",{},void 0,(0,le.Z)("On days")),NA("input",{type:"text",id:"day_of_month",value:this.state.monthDates||ZA().tz(e.start,e.timezone).date(),onChange:this.typeDayOfMonth,onBlur:this.changeDayOfMonth}),NA(sl,{className:"button-narrow",image:cn.bcq.small,popupPosition:"below",isPopupVisible:this.state.showMonthPicker,popupWidth:240,onClick:this.toggleDayOfMonthPicker,onKeyDown:this.dayOfMonthPickerKeyDown,tabIndex:this.props.tabIndex,tooltip:(0,le.Z)("Show date picker"),hidePopup:this.hideDayOfMonthPicker,popupClassName:"ToolbarButtonPopup-DefaultStyles"},void 0,(0,fn.jsx)("div",{className:"dom-picker",ref:this.domPickerRef,onBlur:this.monthPickerBlur,children:NA("div",{className:"toolbar toolbar-default"},void 0,[...Array(31).keys()].map((e=>{const t=e+1;return NA(sl,{isPressed:n.includes(t),name:`${t}-dayOfMonth`,onKeyDown:this.dayOfMonthPickerKeyDown,onClick:this.dayOfMonthPickerClick,tabIndex:this.state.showMonthPicker?this.props.tabIndex:-1,title:t.toString(),tooltip:(0,le.Z)("Repeat monthly on day $1",[t])},t)})))}))))}renderWeekOfMonthSelection(){const{recurrence:e}=this.props.event;if(!e)return null;const t=(0,EA.QX)(e);return t.map(((e,n)=>NA("div",{className:"edit-group"},n,NA("label",{},void 0,NA("select",{name:`${n}-weekOfMonthWeek`,onChange:this.weekOfMonthChange,tabIndex:this.props.tabIndex,value:e.n},void 0,NA("option",{value:"1"},void 0,(0,le.Z)("First")),NA("option",{value:"2"},void 0,(0,le.Z)("ordering","Second")),NA("option",{value:"3"},void 0,(0,le.Z)("Third")),NA("option",{value:"4"},void 0,(0,le.Z)("Fourth")),NA("option",{value:"5"},void 0,(0,le.Z)("Fifth")),NA("option",{value:"-1"},void 0,(0,le.Z)("Last")),NA("option",{value:"-2"},void 0,(0,le.Z)("Second last"))),NA("select",{name:`${n}-weekOfMonthDay`,onChange:this.weekOfMonthChange,tabIndex:this.props.tabIndex,value:e.weekday},void 0,this.week.map((e=>NA("option",{value:e.number},e.number,e.name)))),t.length>1&&NA("input",{type:"button",className:"circular",name:`${n}`,onClick:this.deleteWeekOfMonth,onKeyDown:this.dayOfMonthPickerKeyDown,tabIndex:this.props.tabIndex,title:(0,le.Z)("Remove rule"),value:"–"}),NA("input",{type:"button",className:"circular",onClick:this.addWeekOfMonth,onKeyDown:this.dayOfMonthPickerKeyDown,tabIndex:this.props.tabIndex,title:(0,le.Z)("Add rule"),value:"+"})))))}render(){const{event:e}=this.props,t=e.recurrence||{origOptions:{}},{freq:n,interval:i,count:s,until:o}=t.origOptions,a=n===pA.Ci.MONTHLY?t.origOptions.byweekday?"months_dow":"months_dom":_A(n),r=void 0!==s?"count":o?"endDate":"forever",l=s&&"number"==typeof s?s-1:"";let d="";switch(n){case pA.Ci.DAILY:d=(0,le.Z)("day","days",[i]);break;case pA.Ci.WEEKLY:d=(0,le.Z)("week","weeks",[i]);break;case pA.Ci.MONTHLY:d=(0,le.Z)("month","months",[i]);break;case pA.Ci.YEARLY:d=(0,le.Z)("year","years",[i])}return(0,fn.jsxs)(fn.Fragment,{children:[NA("div",{className:"edit-group capped-width"},void 0,(0,fn.jsx)("select",{name:"frequency",ref:this.props.focusRef,onChange:this.changeRecurrence,tabIndex:this.props.tabIndex,value:a,children:Array.from(MA).map((([e,t])=>NA("option",{value:e},e,t.name)))})),"weeks"===a&&this.renderWeekSelection(),"months_dom"===a&&this.renderDayOfMonthSelection(),"months_dow"===a&&this.renderWeekOfMonthSelection(),"none"!==a&&NA("div",{className:"edit-group capped-width"},void 0,NA("label",{},void 0,NA("span",{},void 0,(0,le.Z)("every","every",[i])),NA("input",{type:"number",name:"interval",min:"1",disabled:!a,onChange:this.changeField,onBlur:this.verifyValidValue,tabIndex:this.props.tabIndex,value:i||""}),NA("span",{},void 0,d))),"none"!==a&&NA("div",{className:"edit-group"},void 0,(0,fn.jsxs)("select",{name:"endsRepeating",ref:this.props.focusRef,onChange:this.changeEnds,tabIndex:this.props.tabIndex,value:r,children:[NA("option",{value:"forever"},void 0,(0,le.Z)("Forever")),NA("option",{value:"endDate"},void 0,(0,le.Z)("Ending")),NA("option",{value:"count"},void 0,(0,le.Z)("Repeating"))]}),(0,fn.jsxs)(fn.Fragment,{children:["endDate"===r&&o&&(0,fn.jsx)(TA,{name:"endDate",onChange:this.changeDate,min:ZA()(e.start).format("YYYY-MM-DD"),tabIndex:this.props.tabIndex,ref:this.endDateElement,value:ZA()((0,bc.FL)(o)).format("YYYY-MM-DD")}),"count"===r&&NA("label",{},void 0,NA("input",{size:"3",type:"number",name:"count",onChange:this.changeField,onBlur:this.verifyValidValue,min:"1",tabIndex:this.props.tabIndex,value:l}),NA("span",{},void 0,(0,le.Z)("time","times",[l])))]}))]})}}const OA=xA,LA={title:"",calendarId:"",is_template:!1},RA=new TextDecoder("utf-8",{fatal:!0}),BA={ACCEPTED:{existing:(0,le.Z)("You have accepted the invite"),update:(0,le.Z)("You accepted the previous invite")},DECLINED:{existing:(0,le.Z)("You have declined the invite"),update:(0,le.Z)("You declined the previous invite")},TENTATIVE:{existing:(0,le.Z)("You have tentatively accepted the invite"),update:(0,le.Z)("You tentatively accepted the previous invite")},"NEEDS-ACTION":{existing:(0,le.Z)("You still have to reply to the invite"),update:(0,le.Z)("You did not reply to the previous invite")},DECLINECOUNTER:{existing:(0,le.Z)("You have declined the counter proposal"),update:""},DELEGATED:{existing:(0,le.Z)("You delegated invite to another person"),update:(0,le.Z)("You delegated previous invite to another person")}};function FA(e){return(0,Nk.Nw)(ve(e).replace(/\n/g,"<br />"),{attachments:{}}).sanitized}function UA(e){return lT.Z.createStyleRoot(e)+"\n  .Event {\n    color: var(--colorFg);\n    background-color: var(--colorBg);\n    font-family: 'SF', '.SFNSDisplay', HelveticaNeue, LucidaGrande, system-ui, sans-serif;\n    font-size: 13px;\n    font-weight: 400;\n    border: 1px solid var(--colorBorder);\n    border-radius: var(--radius);\n    margin-bottom: 12px;\n  }\n  .Event-Message {\n    padding: 12px;\n    display: flex;\n    flex-direction: row;\n    justify-content: space-between;\n    border-bottom: 1px solid var(--colorBorder);\n    align-items: start;\n  }\n  .Event-Rsvp {\n    margin-bottom: 12px;\n    padding: 12px;\n    display: flex;\n    flex-direction: row;\n    justify-content: space-between;\n    align-items: center;\n    background-color: var(--colorBgDark);\n    border-bottom: 1px solid var(--colorBorder);\n  }\n  .Event-Title {\n    font-size: 16px;\n    margin: 12px;\n  }\n  .Event-Title--Previous {\n    font-size: 16px;\n    margin: 0;\n    font-weight: normal;\n  }\n  .Event-Title--Changed {\n    text-decoration: line-through;\n  }\n  .Event-Props {\n    display: grid;\n    grid-template-columns: max-content 1fr;\n    gap: 6px 18px;\n    margin: 12px;\n  }\n  .Event-Props--Diff {\n    grid-template-columns: max-content 1fr 1fr;\n  }\n  .Event-Props--Diff .Event-Title {\n    margin: 0;\n  }\n  .Event-Prop--Previous p {\n    text-decoration: line-through;\n  }\n  .Event-Prop--Previous p.Event-Attendee--Exists {\n    text-decoration: none;\n  }\n  span {\n    flex: 1 1 auto;\n  }\n  input[type=button] {\n    padding: 6px 24px;\n    margin-left: 12px;\n  }\n  dd, dt, p {\n    margin: 0 0 3px 0;\n    padding: 0;\n    word-break: break-word;\n  }\n  p:last-child {\n    margin: 0;\n  }\n  dt {\n    font-weight: 600;\n  }\n  "}function VA(e,t=!1){const n=t?(0,le.Z)("Can not determine email address to reply from. Which one should be used to send your reply?"):(0,le.Z)("More than one of your email addresses are invited. Which one should be used to send your reply?");return{title:(0,le.Z)("Select Reply Mail"),body:n,actions:e.map(((e,t)=>({title:e,action:e,default:0===t}))),cancelAction:{title:(0,le.Z)("Cancel"),action:"cancel"}}}function WA(e,t,n){let i,s,o;try{const e=(0,vA.Z)(t);e.METHOD||(e.VEVENT[0]?.ORGANIZER&&e.VEVENT[0]?.ATTENDEE?e.METHOD="REQUEST":e.METHOD="PUBLISH"),s=e.METHOD;let n=e.VEVENT[0];if(1===n?.EXCEPTIONS?.length&&1===Object.keys(n).length&&(n=n.EXCEPTIONS[0]),!n)return de.Z.error("Mail",["invite"],"No event in invite"),{inviteInfo:{type:"parsing_error",message:(0,le.Z)("No event in invite")},incomingEvent:LA};o=n["RECURRENCE-ID"],i=(0,Xo.rP)(n)}catch(e){return de.Z.error("Mail",["invite"],"Error parsing iCalendar"),{inviteInfo:{type:"parsing_error",message:e.message},incomingEvent:LA}}const a=i.invites||[],r=n.find((e=>e.uid===i.uid&&!e.trash)),l={incomingEvent:i,existingEvent:r,method:s};if(r&&"ical"===Lo.Z.getAccountForCalendar(r.calendarId)?.account_type)return{...l,inviteInfo:{type:"invite_existing_ical"}};const d=e?.rsvpState||"NEEDS-ACTION",c=i.sequence??0,h=r?.sequence??0;if("PUBLISH"===s)return r?h<c?{...l,inviteInfo:{type:"publish_update"}}:{...l,inviteInfo:{type:"publish_existing"}}:{...l,inviteInfo:{type:"publish_not_existing"}};if("REQUEST"===s)return r?r.organizer!==i.organizer?{...l,inviteInfo:{type:"update_fraudulent"}}:h<c?"NEEDS-ACTION"===d?{...l,inviteInfo:{type:"update_unanswered",prevState:d}}:{...l,inviteInfo:{type:"update_answered",state:d}}:h===c?"NEEDS-ACTION"===d?{...l,inviteInfo:{type:"invite_existing_unanswered"}}:{...l,inviteInfo:{type:"invite_existing_answered",state:d}}:{...l,inviteInfo:{type:"invite_outdated"}}:"NEEDS-ACTION"===d?{...l,inviteInfo:{type:"invite_unanswered"}}:{...l,inviteInfo:{type:"invite_answered",state:d}};if("CANCEL"===s)return o&&function(e,t){const n=e?.recurrenceExceptions;if(n?.length){const e=(0,Xo.Uq)(t);return Boolean(n.find((t=>t.cancelled&&t.date===e)))}return!1}(r,o)?{...l,inviteInfo:{type:"cancel_recurring_cancelled"}}:r?{...l,inviteInfo:{type:"cancel_existing",recurrenceId:o}}:{...l,inviteInfo:{type:"cancel_not_existing"}};if("REPLY"===s){if(!i.organizer||1!==a.length||c>h)return{...l,inviteInfo:{type:"reply_invalid"}};const e=a[0];if(!r)return{...l,inviteInfo:{type:"reply_not_existing"}};const t=r.invites||[];if(!t.some((t=>t.address===e.address)))return{...l,inviteInfo:{type:"reply_fraudulent"}};if(c===h&&1===a.length){const{partstat:e,address:n}=a[0],i=t.find((e=>e.address===n));if(i&&i.partstat===e)return{...l,inviteInfo:{type:"reply_not_changed"}};if(i&&i.partstat!==e)return{...l,inviteInfo:{type:"reply_changed"}}}if(c<h)return{...l,inviteInfo:{type:"reply_outdated"}}}return"COUNTER"===s?c>h?{...l,inviteInfo:{type:"counter_invalid"}}:c<h?{...l,inviteInfo:{type:"counter_outdated"}}:r?d?{...l,inviteInfo:{type:"counter_existing_answered",state:d}}:{...l,inviteInfo:{type:"counter_existing_unanswered"}}:{...l,inviteInfo:{type:"counter_not_existing"}}:{...l,inviteInfo:{type:"invite_unsupported_method"}}}function HA(e,t,n,i,s){const{incomingEvent:o,existingEvent:a,method:r,inviteInfo:l}=WA(t,n,i),d=M.Z.get(D.kMailAccounts),c=Pl.Z.getSelectedFolder(),h=(o.invites||[]).map((e=>e.address));let p=d.filter((e=>h.includes(e.MAIL_EMAIL))).map((e=>e.MAIL_EMAIL));const{accountId:u,path:g}=c||{};p.includes(u)?p=[u]:g&&u===ue.Ry&&(p=[g.split("/")[0]]);const m=`\n    <input type="button" value="${(0,le.Z)("Accept")}" onclick="console.log('Accept')" />\n    <input type="button" value="${(0,le.Z)("Maybe")}" onclick="console.log('Maybe')" />\n    <input type="button" value="${(0,le.Z)("Decline")}" onclick="console.log('Decline')" />\n  `,v=`\n    <input type="button" value="${(0,le.Z)("Accept")}" onclick="console.log('AcceptCounter')" />\n    <input type="button" value="${(0,le.Z)("Decline")}" onclick="console.log('DeclineCounter')" />\n  `;let f,y="",w="",C="";switch(l.type){case"invite_existing_ical":y=(0,le.Z)("This message contains changes for an event that you have in a read only web calendar. Updates should be handled on the relevant server.");break;case"publish_not_existing":y=(0,le.Z)("This message contains event data published for your information."),w=`<input type="button" value="${(0,le.Z)("Add To Calendar")}" onclick="console.log('Add')" />`;break;case"publish_existing":y=(0,le.Z)("This message contains event data that you already have in your calendar.");break;case"publish_update":y=(0,le.Z)("This message contains event update published for your information."),w=`<input type="button" value="${(0,le.Z)("Update in Calendar")}" onclick="console.log('Update')" />`;break;case"invite_unanswered":y=0===p.length?(0,le.Z)("This message contains a calendar event invite. No matching email account was found for event invitees. Check the attendee list below to make sure this invite is intended for you."):(0,le.Z)("This message contains a calendar event invite."),w=`<input type="button" value="${(0,le.Z)("Add To Calendar")}" onclick="console.log('Add')" />`,C+=m;break;case"invite_answered":y=(0,le.Z)("This message contains a calendar event invite you have responded to but you don't have the event in your calendar."),w=`<input type="button" value="${(0,le.Z)("Add To Calendar")}" onclick="console.log('Add')" />`,C+=BA[l.state].existing;break;case"invite_outdated":y=(0,le.Z)("This message contains a calendar event invite. You have a more recent version of the event in your calendar.");break;case"invite_existing_unanswered":y=(0,le.Z)("This message contains an invitation to an event you have in your calendar. You have not responded to the invitation."),C+=m;break;case"invite_existing_answered":y=(0,le.Z)("This message contains an existing event you have in your calendar."),C+=BA[l.state].existing;break;case"update_unanswered":y=(0,le.Z)("This message contains an update to a calendar event.")+BA[l.prevState].update,w=`<input type="button" value="${(0,le.Z)("Update in Calendar")}" onclick="console.log('Update')" />`,C+=m;break;case"update_answered":y=(0,le.Z)("This message contains an update to a calendar event.")+BA[l.state].update,w=`<input type="button" value="${(0,le.Z)("Update in Calendar")}" onclick="console.log('Update')" />`,C+=BA[l.state].existing;break;case"update_fraudulent":y=(0,le.Z)("This message contains an update to a calendar event. It does not match the event you have in your calendar. Check the event details below and if it looks correct you have to delete the existing event in your calendar before you can accept this one.");break;case"cancel_existing":y=(0,le.Z)("This message contains an event cancellation."),w=`<input type="button" value="${(0,le.Z)("Remove from Calendar")}" onclick="console.log('Delete')" />`,f=l.recurrenceId;break;case"cancel_not_existing":y=(0,le.Z)("This message contains cancellation of an event you don’t have in your calendar.");break;case"cancel_recurring_cancelled":y=(0,le.Z)("This message contains cancellation of an event already cancelled in your calendar.");break;case"reply_not_existing":y=(0,le.Z)("This message contains an invite reply for an event you do not have in your calendar.");break;case"reply_invalid":y=(0,le.Z)("Invalid event invite reply found.");break;case"reply_fraudulent":y=(0,le.Z)("Fraudulent event invite reply found.");break;case"reply_not_changed":y=(0,le.Z)("This message contains an event invite reply which is already processed.");break;case"reply_changed":y=(0,le.Z)("This message contains an event invite reply."),w=`<input type="button" value="${(0,le.Z)("Update Event in Calendar")}" onclick="console.log('Partstat')" />`;break;case"reply_outdated":y=(0,le.Z)("This message contains an event invite reply for an older version of the event.");break;case"counter_not_existing":y=(0,le.Z)("This message contains a counter proposal for an event which was not found. It will be ignored.");break;case"counter_existing_unanswered":y=(0,le.Z)("This message contains a counter proposal for the following event."),w=v;break;case"counter_existing_answered":y=(0,le.Z)("This message contains a counter proposal for the following event."),y+=BA[l.state].existing;break;case"counter_outdated":y=(0,le.Z)("This message contains an outdated counter proposal. It will be ignored.");break;case"counter_invalid":y=(0,le.Z)("This message contains an invalid counter proposal. It will be ignored.");break;case"invite_unsupported_method":y=(0,le.Z)("Unsupported method parameter “$1”.",[r]);break;case"parsing_error":y=(0,le.Z)("Error parsing calendar data. For details see logs located in Calendar button on status bar.")}C&&(C=`<span>${(0,le.Z)("RSVP")}</span>`+C);const S="parsing_error"===l.type?"":function(e,t,n){const i=[],{url:s,location:o,organizer:a,invites:r,recurrence:l}=t,d=b()(t.start),c=b()(t.end);t.allDay?d.isSame(c,"day")?(i.push([(0,le.Z)("Date"),d.format("LL"),""]),i.push(["","",""])):(i.push([(0,le.Z)("Starts"),d.format("LL"),""]),i.push([(0,le.Z)("Ends"),c.format("LL"),""])):(i.push([(0,le.Z)("Starts"),d.format("LLLL"),""]),i.push([(0,le.Z)("Ends"),c.format("LLLL"),""])),i.push([" ",l?PA(l):"",""]),i.push([(0,le.Z)("Organizer"),a||"",""]),i.push([(0,le.Z)("Attendees"),r&&r.map((e=>`<p>${e.address}</p>`)).join("\r\n"),""]),i.push([(0,le.Z)("Location"),o,""]),i.push([(0,le.Z)("URL"),s?`<a href="${s}">${s}</a>`:"",""]),i.push([(0,le.Z)("Description"),FA(t.description||""),""]);const h=parseInt(n?.sequence)||0,p=parseInt(t.sequence)||0,u=n&&("REQUEST"===e&&h<p||"COUNTER"===e&&h===p);if(u&&n){const e=b()(n.start),d=b()(n.end);if(n.allDay!==t.allDay)n.allDay?(i[0][2]=`<p>${e.format("LL")}</p>`,e.isSame(d,"day")||(i[1][2]=`<p>${d.format("LL")}</p>`)):(i[0][2]=`<p>${e.format("LLLL")}</p>`,i[1][2]=`<p>${d.format("LLLL")}</p>`);else{const s=t.allDay?"LL":"LLLL";n.start!==t.start&&(i[0][2]=`<p>${e.format(s)}</p>`),n.end!==t.end&&(i[1][2]=`<p>${d.format(s)}</p>`)}if((0,Sm.default)(n.recurrence,l)||(i[2][2]=`<p>${PA(n.recurrence)}</p>`),n.organizer!==a&&(i[3][2]=`<p>${n.organizer||"&nbsp"}</p>`),(0,Sm.default)((n.invites||[]).map((e=>e.address)),(r||[]).map((e=>e.address)))||(i[4][2]=n.invites&&n.invites.map((e=>`<p ${t.invites?.some((t=>t.address===e.address))?'class=" Event-Attendee--Exists"':""}>${e.address}</p>`)).join("\r\n")||"&nbsp"),o&&n.location!==o&&(i[5][2]=`<p>${n.location||"&nbsp"}</p>`),s&&n.url!==s){const e=n.url;i[6][2]=e?`<p><a href="${e}">${e}</a></p>`:"&nbsp"}t.description&&n.description!==t.description&&(i[7][2]=`<p>${FA(n.description||"")}</p>`||"&nbsp")}const g=i.filter((e=>e[1]||e[2])),m=`<h1 class="Event-Title">${t.title}</h1>`;if(u&&n)return`\n      <dl class="Event-Props Event-Props--Diff">\n        <dt />\n        <dd>${m}</dd>\n        <dd><h2 class="${t.title===n.title?"Event-Title--Previous":"Event-Title--Previous Event-Title--Changed"}">${n.title}</h2></dd>\n      ${g.map((([e,t,n])=>`\n        <dt>${e}</dt>\n        <dd>${t||""}</dd>\n        <dd class="Event-Prop--Previous">${n||""}</dd>`)).join("\r\n")}\n      </dl>\n    `;return`\n    ${m}\n    <dl class="Event-Props">\n    ${g.map((([e,t])=>`\n      <dt>${e}</dt>\n      <dd>${t||""}</dd>`)).join("\r\n")}\n    </dl>\n  `}(r,o,a);return{markup:`\n    <div class="Event">\n      <div class="Event-Message"><span>${y}</span>${w}</div>\n      ${C?`<div class="Event-Rsvp">${C}</div>`:""}\n      ${S}\n    </div>\n      `,style:UA(s),prepend:!0,messageHandler:async n=>{const{message:i}=n;let s="";if("DeclineCounter"===i)s=t?.from[0].address||"";else if(["Accept","Maybe","Decline","AcceptCounter"].includes(i)||"DeclineCounter"===i&&!s){if(1===p.length)s=p[0];else if(0===p.length){if(1===d.length)s=d[0].MAIL_EMAIL;else if(c){const{accountId:e,path:t}=c;d.some((t=>t.MAIL_EMAIL===e))?s=e:t&&e===ue.Ry&&(s=t.split("/")[0])}if(!s){const{action:e}=await ie.Z.showModal(z.ZP.getId(),{modal:VA(d.map((e=>e.MAIL_EMAIL)),!0)});s=e}}else{const{action:e}=await ie.Z.showModal(z.ZP.getId(),{modal:VA(p)});s=e}if("cancel"===s)return}switch(i){case"Accept":mA.replyToInvite(e,o,s,"ACCEPTED");break;case"Maybe":mA.replyToInvite(e,o,s,"TENTATIVE");break;case"Decline":mA.replyToInvite(e,o,s,"DECLINED");break;case"Add":mA.addEventToCalendar(e,o);break;case"Update":case"AcceptCounter":a&&mA.updateEventInCalendar(e,o,a);break;case"DeclineCounter":mA.declineCounter(e,o,s);break;case"Delete":mA.handleCancellation(e,o,f);break;case"Partstat":mA.handleReply(o)}}}}const zA={type:"text",content:""};const GA=tn.forwardRef((function(e,t){const{windowId:n,style:i,fromAddress:s,isRss:o,isSenderTrusted:a,message:r,onUnblockExternalContent:l,raw:d,renderingMethod:c}=e,h=function(e,t,n){const[i,s]=tn.useState([]);return tn.useMemo((()=>{if(e)if("raw"===n)if(t)t.getByteString().then((e=>s([{type:"text",content:e}])));else if(e.bodyParts&&"string"==typeof e.bodyParts[0].content){const t=e.bodyParts[0].content,n=(0,zk.yN)(e.bodyParts);aA.Z.build(e,t,n).then((e=>s([{type:"text",content:e}])))}else s([]);else e.bodyParts?s(e.bodyParts):t&&t.parseMainPart(n).then(s);else s([])}),[e,t,n]),i}(r,d,c),p=function(e,t){const[n,i]=tn.useState();return tn.useEffect((()=>{const n=[];return e&&"raw"!==t?((async()=>{const t=(0,Ra.Dc)(e.mimeTree).filter((e=>e.mimeType&&e.mimeType.startsWith("image/")));for(const i of t){const t=await e.parse(i.mimeTree);if(1===t.length&&"attachment"===t[0].type){const{content:e,mimeType:i}=t[0],s=new Blob([e],{type:"string"==typeof i?i:""}),o=URL.createObjectURL(s);n.push(o)}}if(n.length>0){const e={markup:n.map((e=>`<img src="${e}" />`)).join(""),style:"img {\n            margin-top: 12px;\n            display: inline-block;\n            vertical-align: top;\n            max-width: 100%;\n            height: auto;\n          }",prepend:!1};i(e)}else i()})(),()=>{n.forEach((e=>URL.revokeObjectURL(e)))}):i()}),[e,t]),n}(d,c),u=function(e,t,n,i,s){const o=fA(),[a,r]=tn.useState();return tn.useMemo((()=>{n&&"raw"!==i?n.parseCalendar().then((n=>{let i;if(n){let a="";a="string"==typeof n.content?n.content:RA.decode(n.content),i=HA(e,t,a,o,s)}r(i)})):r()}),[e,n,i,o,t,s]),a}(n,r,d,c,i);let g;h.length>0&&(g=u||p);const m=[];let v;if(r&&(v=h.find((e=>"html"===e.type)),v||(v=h.find((e=>"text"===e.type)))),v||(v=zA),"html"===v.type||"text"===v.type){const e=!!r&&!r.trusted&&!a;m.push((0,fn.jsx)(oA,{style:i,blockHTTPLeaks:e,bodyParts:"html"===v.type?h:void 0,fromAddress:s,inject:g,isRss:o,onUnblockExternalContent:l,ref:t,textOrHtml:v,renderingMethod:c},"mainBody"))}return m})),$A="HintTooltip",KA={show:100,hide:300},jA="top";class YA extends tn.Component{static contextType=dn.Z;_container=tn.createRef();_hint=tn.createRef();state={visible:!1,at:jA,top:0,left:0};componentWillUnmount(){clearTimeout(this._timeout)}getScrollParent=e=>{const{overflowY:t}=this.context.getComputedStyle(e);return!["visible","hidden"].includes(t)&&e.scrollHeight>e.clientHeight?e:e.parentElement?this.getScrollParent(e.parentElement):e};getHintPosition=()=>{let e=this.props.position||jA;const{top:t,left:n,width:i,height:s}=this._container.current?.getBoundingClientRect()||{top:0,left:0,width:0,height:0},{width:o,height:a}=this._hint.current?.getBoundingClientRect()||{width:0,height:0};if(!this.props.position){const r=this._container.current?.parentElement?this.getScrollParent(this._container.current.parentElement):this.context.document.documentElement;if(!r)return;const{top:l,left:d}=r.getBoundingClientRect()||{top:0,left:0},{clientHeight:c,clientWidth:h}=r,p={left:n-d-o>0,right:n-d+i+o<h,bottom:t-l+s+a<c,top:t-l-a>0};switch(e){case"left":p.left||(e="right",p.right||(e="top",p.top||(e="bottom")));break;case"right":p.right||(e="left",p.left||(e="top",p.top||(e="bottom")));break;case"bottom":p.bottom||(e="top",p.top||(e="right",p.right||(e="left")));break;default:p.top||(e="bottom",p.bottom||(e="right",p.right||(e="left")))}}let r,l;switch(e){case"left":r=(s-a)/2,l=-o;break;case"right":r=(s-a)/2,l=i;break;case"bottom":r=s,l=(i-o)/2;break;default:r=-a,l=i-o>0?i-o:(i-o)/2}this.setState({at:e,top:r,left:l})};showHint=()=>{const{show:e}=this.props.delay||KA;clearTimeout(this._timeout),this._timeout=setTimeout((()=>this.setState({visible:!0},(()=>this.getHintPosition()))),e)};hideHint=()=>{const{hide:e}=this.props.delay||KA;clearTimeout(this._timeout),this._timeout=setTimeout((()=>this.setState({visible:!1})),e)};toggleHint=()=>{const{show:e,hide:t}=this.props.delay||KA,n=this.state.visible;clearTimeout(this._timeout),this._timeout=setTimeout((()=>this.setState({visible:n},(()=>n&&this.getHintPosition()))),n?t:e)};render(){const{label:e,className:t}=this.props,{at:n,top:i,left:s}=this.state;return(0,fn.jsxs)("div",{className:mn()(t,$A,[`HintTooltip--${n||jA}`],["HintTooltip--"+(this.state.visible?"Visible":"Hidden")]),role:"tooltip",ref:this._container,onFocus:this.showHint,onBlur:this.hideHint,onMouseEnter:this.showHint,onMouseLeave:this.hideHint,onTouchEnd:this.toggleHint,children:[(0,fn.jsx)("div",{ref:this._hint,style:{top:i,left:s},className:"HintTooltip__content",children:e}),this.props.children]})}}var XA,QA=n(73132);function qA(e,t,n,i){XA||(XA="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:XA,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class JA extends tn.Component{static contextType=dn.Z;winId=this.context.vivaldiWindowId;state={activeItemIndex:-1,openDropdownMenu:!1,contact:this.props.mailAddress?Aa.Z.getContactsWithAddress(this.props.mailAddress.address):void 0,status:""};componentDidMount(){this.props.mailAddress&&Aa.Z.addListener(this.contactChanged)}componentWillUnmount(){Aa.Z.ensureRemovedListener(this.contactChanged)}contactChanged=()=>{if(this.props.mailAddress){const e=this.props.mailAddress.address.toLowerCase(),t=this.state.contact&&Aa.Z.getNodeById(this.state.contact.id);t?.emailAddresses.some((t=>t.emailAddress.toLowerCase()===e))?this.setState({contact:t}):this.setState({contact:Aa.Z.getContactsWithAddress(e)})}};onClickDropdown=()=>{this.setState((e=>({openDropdownMenu:!e.openDropdownMenu})))};openMenu=()=>{this.setState({openDropdownMenu:!0})};closeMenu=()=>{this.setState({activeItemIndex:-1,openDropdownMenu:!1})};handleKeyDown=e=>{switch(e.key){case"Escape":case"Tab":this.closeMenu();break;case"Enter":case"Space":if(e.stopPropagation(),e.preventDefault(),this.state.activeItemIndex>-1){const e=this.getDropdownMenuItems()[this.state.activeItemIndex];e.onSuccessText?e.handler().then((()=>this.onMenuItemClicked(e.onSuccessText)),(()=>this.onMenuItemClicked(e.onErrorText))):(e.handler(),this.closeMenu())}else this.props.onClick();break;case"ArrowUp":this.setState((e=>{const t=e.activeItemIndex-1;if(t>-1)return{activeItemIndex:t}}));break;case"ArrowDown":this.setState((e=>{const t=e.activeItemIndex+1;if(t<this.getDropdownMenuItems().length)return{openDropdownMenu:!0,activeItemIndex:t}}))}};onMenuItemClicked=e=>{this.statusTimeout&&clearTimeout(this.statusTimeout);this.setState({status:e}),this.closeMenu(),this.statusTimeout=setTimeout((()=>this.setState({status:""})),1e3)};contactOrAddressString=()=>this.props.mailAddress&&this.state.contact&&!this.state.contact.generatedFromSentMail?this.state.contact.name?this.state.contact.name+" <"+this.props.mailAddress.address+">":this.props.mailAddress.address:this.props.buttonTitle;onEditContact=e=>{if(!e)return;const t=this.context.vivaldiWindowId;Ho.Z.showContent(t,"contacts",{setFocus:!0,selectId:e.id,reason:"edit"}),j.Z.selectContact(t,e.emailAddresses[0].emailAddress),Y.Z.openURL(t,St.jk.internals.mailpage,{singleton:!0})};onAddContact=e=>{const t=this.context.vivaldiWindowId;Ho.Z.showContent(t,"contacts"),K.Z.newContactFromMailAddress(t,e,!0),j.Z.selectContact(t,e.address),Y.Z.openURL(t,St.jk.internals.mailpage,{singleton:!0})};getDropdownMenuItems=()=>{if(this.props.mailAddress){const e=this.props.mailAddress;return this.state.contact?[...this.props.dropdownMenuItems,{...(0,Mn.Z)("Edit contact"),handler:this.onEditContact.bind(this,this.state.contact)}]:[...this.props.dropdownMenuItems,{...(0,Mn.Z)("Add to contacts"),handler:this.onAddContact.bind(this,e)}]}return this.props.dropdownMenuItems};onContextMenu=e=>{const t=this.getDropdownMenuItems().map((e=>({label:e.label,labelEnglish:e.labelEnglish,handler:e.handler})));(0,zi.Z)(this.winId,t)(e)};render(){return qA("div",{className:"button-with-dropdown-wrapper"},void 0,qA("div",{className:"button-with-dropdown-container",onMouseLeave:this.closeMenu,title:this.contactOrAddressString(),onContextMenu:this.onContextMenu},void 0,qA("button",{onKeyDown:this.handleKeyDown,tabIndex:this.props.prefValues[D.kKeyboardTabToAll],onClick:this.props.onClick},void 0,this.state.contact&&qA("img",{src:this.state.contact.avatarUrl||QA.g}),qA("span",{},void 0,this.contactOrAddressString())),qA("button",{tabIndex:-1,onMouseDown:this.onClickDropdown,dangerouslySetInnerHTML:{__html:cn.yaZ.medium}}),this.state.openDropdownMenu&&qA("ul",{className:"dropdown-menu"},void 0,this.getDropdownMenuItems().map(((e,t)=>qA("li",{onMouseUp:e.onSuccessText?()=>e.handler().then((()=>this.onMenuItemClicked(e.onSuccessText)),(()=>this.onMenuItemClicked(e.onErrorText))):()=>{e.handler&&e.handler(),this.closeMenu()},className:this.state.activeItemIndex===t?"active":void 0},e.label,e.label)))),this.state.status&&qA("div",{className:"status"},void 0,this.state.status)))}}const eZ=JA;var tZ;function nZ(e,t,n,i){tZ||(tZ="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:tZ,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class iZ extends tn.PureComponent{static contextType=dn.Z;nodeRef=tn.createRef();state={maxShown:5};onClickAddress=e=>{e.address&&Wm.Z.enableCorrespondentView(this.context.vivaldiWindowId,e.address)};render(){const e=this.state.maxShown,t=this.props.mailAddresses;return(0,fn.jsxs)("span",{ref:this.nodeRef,className:"detail",children:[t.slice(0,e).map(((e,t)=>{const n=(0,ye.li)(e),i=[{...(0,Mn.Z)("Copy address"),handler:()=>ui.Z.copyTextToClipboard(n),onSuccessText:(0,le.Z)("Copied to clipboard",[n]),onErrorText:(0,le.Z)("Failed to copy address")},{...(0,Mn.Z)("See messages to and from address"),handler:this.onClickAddress.bind(this,e)}];return nZ(eZ,{prefValues:this.props.prefValues,onClick:this.onClickAddress.bind(this,e),mailAddress:e,buttonTitle:n,dropdownMenuItems:i},n+String(t))})),t.length>this.state.maxShown&&nZ("a",{tabIndex:this.props.prefValues[D.kKeyboardTabToAll],onClick:()=>this.setState({maxShown:t.length})},"more",(0,le.Z)("... $1 more","... $1 more",[t.length-this.state.maxShown,t.length-this.state.maxShown]))]},"detail")}}const sZ=iZ;var oZ,aZ=n(4668),rZ=n(59042);function lZ(e,t,n,i){oZ||(oZ="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:oZ,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class dZ extends tn.Component{mailLabelRef=tn.createRef();_isMounted=!1;state={breakpoint:!1,componentMaxWidth:32,shouldDetachObserver:!1,numberOfVisibleLabelsAllowed:0,numberOfCheckedLabels:(0,ev.Q3)(this.props.flags).length};componentDidMount(){this._isMounted=!0,this.state.numberOfCheckedLabels>0&&(this.setComponentMaxWidth(this.getComponentMaxWidth()),this.observerHandler())}componentWillUnmount(){this._isMounted=!1}componentDidUpdate(e,t){const n=this.mailLabelRef.current&&this.mailLabelRef.current.clientWidth;this.props.flags!==e.flags&&(this.setComponentMaxWidth(this.getComponentMaxWidth()),this.setNumberOfCheckedLabels((0,ev.Q3)(this.props.flags).length),this.observerHandler(),n&&(n>this.state.componentMaxWidth&&this.setBreakpoint(!1),n<this.state.componentMaxWidth&&this.setBreakpoint(!0)))}observerHandler=()=>{0===this.state.numberOfCheckedLabels?this.setState({shouldDetachObserver:!0}):this.setState({shouldDetachObserver:!1})};observeTargetHandler=e=>{if(!this._isMounted)return;const t=e[0].target;this.setNumberOfVisibleLabelsAllowed(t.clientWidth),t.clientWidth>this.state.componentMaxWidth&&this.setBreakpoint(!1),t.clientWidth<this.state.componentMaxWidth&&this.setBreakpoint(!0)};setNumberOfVisibleLabelsAllowed=e=>{const t=e/(32+(3+3*(e/32)));this.setState({numberOfVisibleLabelsAllowed:t})};setNumberOfCheckedLabels=e=>{this.setState({numberOfCheckedLabels:e})};setBreakpoint=e=>{this.setState({breakpoint:e})};setComponentMaxWidth=e=>{this.setState({componentMaxWidth:e})};getComponentMaxWidth=()=>{const e=(0,ev.Q3)(this.props.flags);return(32+3*this.state.numberOfVisibleLabelsAllowed)*e.length};render(){if(0===this.state.numberOfCheckedLabels)return null;let e=[],t=[];this.state.breakpoint?(e=(0,ev.Q3)(this.props.flags).slice(this.state.numberOfVisibleLabelsAllowed).map((e=>(0,rZ.X)(e))),t=(0,ev.Q3)(this.props.flags).slice(0,this.state.numberOfVisibleLabelsAllowed).map((e=>(0,rZ.X)(e)))):t=(0,ev.Q3)(this.props.flags).map((e=>(0,rZ.X)(e)));const n=e.join("\n");return(0,fn.jsx)("div",{className:this.props.className,ref:this.mailLabelRef,children:lZ(ts,{className:"MailLabels-Observer",onResize:this.observeTargetHandler,attached:this.state.shouldDetachObserver},void 0,lZ("ul",{className:"MailLabels-Container",style:this.props.style},void 0,t.map(((e,t)=>lZ("li",{title:(0,rZ.X)(e),className:"MailLabels-Label"},e,(0,rZ.X)(e)))),e.length>0&&lZ("li",{title:n,className:"MailLabels-Label MailLabels-Tooltip"},void 0,`+${e.length}`)))})}}const cZ=dZ;var hZ;function pZ(e,t,n,i){hZ||(hZ="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:hZ,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const uZ=[D.kDownloadsNotifyOnComplete,D.kDownloadsOpenPanelOnNew,D.kDownloadsStartAutomatically,D.kKeyboardTabToAll],gZ=(0,le.Z)("Reply To"),mZ=(0,le.Z)("Does not match the “From” address. Therefore make sure you trust this address before sending.");function vZ(e){return e?b()(e).format("LLL"):""}var fZ=pZ(YA,{label:mZ,position:"right",className:"warning"},void 0,gZ);class yZ extends tn.PureComponent{static contextType=dn.Z;refWebpagecontainer=tn.createRef();refSubject=tn.createRef();refFrom=tn.createRef();refTo=tn.createRef();refDate=tn.createRef();constructor(e){let t;super(e);let n=[];Nl.Z.getActiveListEntry()===e.listEntry&&(n=Nl.Z.getAttachments(),t=Nl.Z.getRaw()),this.state={attachments:n,dialogParentElement:void 0,customData:null,maxShownAttachments:5,raw:t}}componentDidMount(){Nl.Z.addListener(this.activeMessageStoreChanged)}componentWillUnmount(){Nl.Z.removeListener(this.activeMessageStoreChanged)}activeMessageStoreChanged=()=>{if(Nl.Z.getActiveListEntry()===this.props.listEntry){const e=Nl.Z.getAttachments(),t=Nl.Z.getRaw();this.setState({attachments:e,raw:t})}};async maybeParse(e){if("attachment"===e.type)return e;if(this.state.raw){const[t]=await this.state.raw.parse(e.mimeTree);if(t&&"attachment"===t.type)return t}}async onClickAttachment(e){const t=await this.maybeParse(e);t&&(this.props.prefValues[D.kDownloadsStartAutomatically]?((0,aZ.Ve)(t),this.props.prefValues[D.kDownloadsOpenPanelOnNew]&&Dl.ZP.canAutoOpen(this.context.vivaldiWindowId,"downloads")&&Ho.Z.toggleContent(this.context.vivaldiWindowId,"downloads")):this.showDialog((0,aZ.JX)(t)))}async onClickAttachmentDropdown(e,t){const n=await this.maybeParse(e);n&&((0,aZ.Ve)(n,t),this.props.prefValues[D.kDownloadsOpenPanelOnNew]&&Dl.ZP.canAutoOpen(this.context.vivaldiWindowId,"downloads")&&Ho.Z.toggleContent(this.context.vivaldiWindowId,"downloads"))}async onClickDownloadAll(){if(!this.state.raw)return;(await this.state.raw.parseAttachments()).forEach((e=>(0,aZ.Ve)(e)))}onClickSaveAll(){const{raw:e}=this.state;e&&y.Z.fileSystem.chooseEntry({type:"openDirectory"},(t=>{const n=y.Z.runtime.lastError;n?"User cancelled"!==n.message&&console.error("Error saving attachments",n.message||n):t?y.Z.fileSystem.getWritableEntry(t,(n=>{const i={create:!0};e.parseAttachments().then((e=>{for(const t of e){const e=(0,aZ.up)(t);n.getFile((0,aZ.BZ)(t.filename),i,(t=>{t.createWriter((t=>{t.write(e)}))}))}if(this.props.prefValues[D.kDownloadsNotifyOnComplete]){const e=new Notification(this.props.fromAddress,{body:(0,le.Z)("Attachments have been saved to $1",t.name),icon:"resources/mail_notification_icon.png"});setTimeout((()=>e.close()),ue.QM)}}))})):console.error("Error saving attachments, directory entry missing")}))}onClickSubject=()=>{Wm.Z.enableThreadedView(this.context.vivaldiWindowId)};_toggleSenderAsMailingList=()=>{this.props.fromAddress&&j.Z.toggleSenderAsMailingList(this.context.vivaldiWindowId,this.props.fromAddress)};_copyHeader=()=>{const{from:e,listEntry:t,message:n}=this.props,{sentDate:i,subject:s}=t,o=n?n.to:pm.Z.get(t.toIds),{cc:a=[],bcc:r=[]}=n||{},l=[[(0,le.Z)("mail","From"),e],[(0,le.Z)("To"),o],[(0,le.Z)("Cc"),a],[(0,le.Z)("Bcc"),r]];let d=s+"\n"+vZ(i);for(const[e,t]of l)t.length>0&&(d+=`\n${e}: ${(0,ye.Rz)(t)}`);d+="\n",ui.Z.copyTextToClipboard(d)};getContextMenuItemsPromise=(e,t)=>{const n=this.context.vivaldiWindowId,i=Ai.getOptionFunction(e);return Ai.getNamedMenu(n,e,(async e=>{switch(e.action){case"COMMAND_PAGE_BACK":return{visible:Pl.Z.canGoBack(),...i(n,e,{})};case"COMMAND_PAGE_FORWARD":return{visible:Pl.Z.canGoForward(),...i(n,e,{})};case"CONTEXT_COPY":return{handler:this._copyHeader,...i(n,e,{})};case"COMMAND_TAB_VIEW_PAGE_SOURCE":return{checked:"raw"===this.props.renderingMethod,...i(n,e,{})};case"CONTEXT_SENDER_IS_MAILING_LIST":return{handler:this._toggleSenderAsMailingList,checked:$g.C.isSenderMailingList(this.props.fromAddress),...i(n,e,{})};default:return{...i(n,e,{})}}}))};handleOnCloseDialog=()=>{this.setState({dialogParentElement:void 0})};showDialog=e=>{this.setState({dialogParentElement:this.refWebpagecontainer.current,customData:e})};onHeaderContextMenu=e=>(e.persist(),e.preventDefault(),e.stopPropagation(),this.getContextMenuItemsPromise("mailheader",e).then((t=>{(0,zi.Z)(this.context.vivaldiWindowId,t)(e)})),!1);onAttachmentContextMenu=(e,t)=>{(0,zi.Z)(this.context.vivaldiWindowId,e)(t)};renderAttachmentButtons=(e,t)=>e.slice(0,t).map(((e,t)=>{const n=[{...(0,Mn.Z)("Save"),handler:()=>this.onClickAttachmentDropdown(e)},{...(0,Mn.Z)("Save As"),handler:()=>this.onClickAttachmentDropdown(e,"saveas")}];return pZ("button",{className:"attachment-button",onClick:this.onClickAttachment.bind(this,e),title:e.filename,tabIndex:this.props.prefValues[D.kKeyboardTabToAll],onContextMenu:this.onAttachmentContextMenu.bind(this,n)},e.filename+String(t),e.filename)}));renderSubjectButton=e=>pZ(eZ,{prefValues:this.props.prefValues,onClick:this.onClickSubject,buttonTitle:e,dropdownMenuItems:[{...(0,Mn.Z)("Copy subject"),handler:()=>ui.Z.copyTextToClipboard(e),onSuccessText:(0,le.Z)("Copied to clipboard"),onErrorText:(0,le.Z)("Failed to copy subject")},{...(0,Mn.Z)("See message thread"),handler:this.onClickSubject}]});shouldWarnUser=()=>{const{from:e,message:t}=this.props;return!!(t&&t.replyTo[0]&&e[0]&&(t.replyTo.length>1||e.length>1||e[0].address!==t.replyTo[0].address))};render(){const{listEntry:e,message:t}=this.props,{sentDate:i,sources:s,subject:o}=e,{cc:a=[],bcc:r=[],replyTo:l=[]}=t||{},d=t?t.to:pm.Z.get(e.toIds),c=(0,ev.Zr)(e.flags).toLowerCase(),h=this.shouldWarnUser(),p=new Map;return $g.C.getByIds([...s.keys()]).forEach((e=>{const{accountId:t,name:n}=e;p.get(t)||p.set(t,[]),p.get(t)?.push((0,gm.e)(n))})),pZ("header",{onContextMenu:this.onHeaderContextMenu,className:mn()({"mail-detail-header":!0,"is-unread":cm.Z.call(s)})},void 0,this.state.dialogParentElement&&this.state.customData&&pZ(Eo,{customData:this.state.customData,onClose:this.handleOnCloseDialog}),o&&(0,fn.jsx)("h1",{className:"subject",ref:this.refSubject,children:this.renderSubjectButton(o)}),pZ("div",{className:"mail-indicators"},void 0,Gm.Z.isMessageDeleted(s)&&pZ("span",{className:"mail-status-indicator read-status trash",style:{display:"flex"},dangerouslySetInnerHTML:{__html:cn.nre.small}}),(0,ev.XN)(this.props.listEntry)&&pZ("span",{className:"mail-status-indicator",dangerouslySetInnerHTML:{__html:cn.upG.small}}),(0,ev.B_)(this.props.listEntry)&&pZ("span",{className:"mail-status-indicator",dangerouslySetInnerHTML:{__html:cn.hGk.small}}),c&&pZ("span",{className:`flag-color flag-${c}`,title:(0,le.Z)("Flagged"),dangerouslySetInnerHTML:{__html:cn.nyn.small}})),pZ("div",{className:"mail-details"},void 0,(0,fn.jsxs)("div",{ref:this.refWebpagecontainer,className:"mail-detail-main",children:[this.props.from.length>0&&(0,fn.jsxs)(fn.Fragment,{children:[pZ("span",{className:"label"},void 0,(0,le.Z)("mail","From")),(0,fn.jsx)(sZ,{ref:this.refFrom,prefValues:this.props.prefValues,mailAddresses:this.props.from})]}),l.length>0&&!(0,Sm.default)(this.props.from,l)&&(0,fn.jsxs)(fn.Fragment,{children:[pZ("span",{className:"label"},void 0,h?fZ:gZ),pZ(sZ,{prefValues:this.props.prefValues,mailAddresses:l})]}),d.length>0&&(0,fn.jsxs)(fn.Fragment,{children:[pZ("span",{className:"label"},void 0,(0,le.Z)("To")),(0,fn.jsx)(sZ,{ref:this.refTo,prefValues:this.props.prefValues,mailAddresses:d})]}),a.length>0&&(0,fn.jsxs)(fn.Fragment,{children:[pZ("span",{className:"label",title:(0,le.Z)("Carbon copy")},void 0,(0,le.Z)("Cc")),pZ(sZ,{prefValues:this.props.prefValues,mailAddresses:a})]}),r.length>0&&(0,fn.jsxs)(fn.Fragment,{children:[pZ("span",{className:"label",title:(0,le.Z)("Blind carbon copy")},void 0,(0,le.Z)("Bcc")),pZ(sZ,{prefValues:this.props.prefValues,mailAddresses:r})]}),(e.attachment>0||this.state.attachments.length>0)&&(0,fn.jsxs)(fn.Fragment,{children:[pZ("span",{className:"label",title:(0,le.Z)("Attachment"),dangerouslySetInnerHTML:{__html:n(51843)}}),pZ("span",{className:"detail attachments"},void 0,this.renderAttachmentButtons(this.state.attachments,this.state.maxShownAttachments),this.state.attachments.length>this.state.maxShownAttachments&&pZ("a",{tabIndex:this.props.prefValues[D.kKeyboardTabToAll],onClick:()=>this.setState((e=>({maxShownAttachments:e.attachments.length})))},void 0,(0,le.Z)("... $1 more","... $1 more",[this.state.attachments.length-this.state.maxShownAttachments,this.state.attachments.length-this.state.maxShownAttachments])),this.state.attachments.length>1&&pZ("button",{className:"attachment-button",href:"#",onClick:this.onClickSaveAll.bind(this)},void 0,(0,le.Z)("attachments","Save All")),this.state.attachments.length>1&&pZ("button",{className:"attachment-button",href:"#",onClick:this.onClickDownloadAll.bind(this)},void 0,(0,le.Z)("attachments","Download All")))]}),(0,ev.OK)(e.flags)&&(0,fn.jsxs)(fn.Fragment,{children:[pZ("span",{className:"label"},void 0,(0,le.Z)("Label")),pZ("div",{className:"adjustment-mail-labels"},void 0,pZ(cZ,{flags:e.flags}))]})]}),pZ("div",{className:"mail-detail-side"},void 0,![...p.keys()].some((e=>e===ue.u4))&&[...p.entries()].map((([e,t])=>pZ("div",{className:"mail-detail-item"},e,t.join(", "),Object.keys(wa.Z.getAccounts()).length>1&&pZ("span",{className:"mail-detail-item-accountId"},void 0,"(",e,")")))),(0,fn.jsx)("div",{className:"mail-detail-item",ref:this.refDate,children:vZ(i)}))))}}const wZ=(0,fs.Z)(yZ,uZ);var bZ=n(28918),CZ=n(55346);const SZ={call:function(e){return vt.Z.pop.where("searchListId").equals(e).toArray()}};var TZ,IZ=n(83507),kZ=n(34155);function AZ(e,t,n,i){TZ||(TZ="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:TZ,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}async function ZZ(e,t,n){const{id:i,sentDate:s}=t,{accountId:o}=n;await e.writeBufferToDisk(o,s,i),"imap"===n.type?await(0,Ba.h)(o,i):await vt.Z.pop.update([o,n.uidl],{headersOnly:!1})}class EZ extends tn.Component{static contextType=dn.Z;messageBody=tn.createRef();messageHeader=tn.createRef();isRssFeedMessage=!1;constructor(e,t){super(e),this.state={style:P.Z.getState().windowStyles.get(t.vivaldiWindowId)||{},message:void 0,renderingMethod:M.Z.get(D.kMailPreferredRendering),isSenderTrusted:!1,accountOfflineNoMessage:!1,netOfflineNoMessage:!1}}_setIfActive=e=>{kZ.nextTick((()=>{const t=this.messageBody.current?.refWebview.current,n=this.context.vivaldiWindowId;e.pageIsActive?(Wm.Z.setActiveMailDetail(this),t&&rS.setActiveWebView(n,t)):(Wm.Z.clearIfActive(this),t&&rS.clearIfActive(n,t))}))};_markSeenIfHasBody=()=>{j.Z.markSeenDebounced.cancel();const{listEntry:e}=this.props,{message:t,raw:n}=this.state;if(e&&t){const{bodyParts:i}=t;e&&e.unseen&&(n||i)&&j.Z.markSeenDebounced(e)}};componentDidMount(){Qi.Z.addListener("COMMAND_TAB_VIEW_PAGE_SOURCE",this.onCommandSpy),Qi.Z.addListener("COMMAND_MAIL_SHOW_PLAINTEXT",this.onCommandSpy),Qi.Z.addListener("COMMAND_MAIL_SHOW_HTML",this.onCommandSpy),M.Z.addListener([D.kMailAccounts,D.kMailPreferredRendering],this.onPrefsChanged),P.Z.addListener(this.onThemeStoreChanged),im.addListener(this.onConnectionChanged),this.context.addEventListener("online",this._onOnline),$g.C.getIndex().length>0?this.fetchMessage(this.props):$g.C.addListener(this.checkIfReadyToReadFromDisk),this._setIfActive(this.props)}_onOnline=()=>{this.state.netOfflineNoMessage&&this.setState({netOfflineNoMessage:!1},(()=>this.fetchMessage(this.props)))};onConnectionChanged=e=>{im.isDisconnected(e.accountId)||this.state.raw||this.setState({netOfflineNoMessage:!1},(()=>{this.props.listEntry&&(de.Z.log("Mail",["detail-view","fetch-message"],"connection established - fetch message"),this.fetchMessage(this.props))}))};onPrefsChanged=(e,t,n)=>{switch(n){case D.kMailAccounts:this.state.accountOfflineNoMessage&&this.setState({accountOfflineNoMessage:!1},(()=>{this.props.listEntry&&this.fetchMessage(this.props)}));break;case D.kMailPreferredRendering:this.setState({renderingMethod:t})}};checkIfReadyToReadFromDisk=e=>{"finishIndexProgress"===e.target&&($g.C.ensureRemovedListener(this.checkIfReadyToReadFromDisk),this.fetchMessage(this.props))};_isBeingActivated(e){return!this.props.pageIsActive&&e.pageIsActive}UNSAFE_componentWillReceiveProps(e){const t=e.listEntry?e.listEntry.id:void 0;if((this.props.listEntry?this.props.listEntry.id:void 0)!==t)this.fetchMessage(e);else if(this._isBeingActivated(e)){if(void 0!==t&&Vm.drafts[t]){const t=Rm.getComposer();t&&t.flushPendingChanges().then((()=>this.fetchMessage(e)))}Vm.drafts={}}e.pageIsActive!==this.props.pageIsActive&&this._setIfActive(e)}shouldComponentUpdate(e,t){return e.hasNoListEntries!==this.props.hasNoListEntries||(!Mu(this.state,t)||!!this.props.prefValues&&!!e.prefValues&&this.props.prefValues[D.kMailViewLayout]!==e.prefValues[D.kMailViewLayout])}componentDidUpdate(){this._markSeenIfHasBody()}componentWillUnmount(){Qi.Z.removeListener("COMMAND_TAB_VIEW_PAGE_SOURCE",this.onCommandSpy),Qi.Z.removeListener("COMMAND_MAIL_SHOW_PLAINTEXT",this.onCommandSpy),Qi.Z.removeListener("COMMAND_MAIL_SHOW_HTML",this.onCommandSpy),M.Z.removeListener([D.kMailAccounts,D.kMailPreferredRendering],this.onPrefsChanged),$g.C.ensureRemovedListener(this.checkIfReadyToReadFromDisk),im.removeListener(this.onConnectionChanged),this.context.removeEventListener("online",this._onOnline),P.Z.removeListener(this.onThemeStoreChanged),this._currentId=-1,kZ.nextTick((()=>{Wm.Z.clearIfActive(this);const e=this.messageBody.current?.refWebview.current;e&&rS.clearIfActive(this.context.vivaldiWindowId,e)}))}onCommandSpy=(e,t)=>{if(this.props.pageIsActive&&e===this.context.vivaldiWindowId)switch(t){case"COMMAND_TAB_VIEW_PAGE_SOURCE":this.toggleRenderingMethod("raw");break;case"COMMAND_MAIL_SHOW_PLAINTEXT":this.toggleRenderingMethod("plaintext");break;case"COMMAND_MAIL_SHOW_HTML":this.toggleRenderingMethod("prefer_html")}};onThemeStoreChanged=()=>{const e=P.Z.getState().windowStyles.get(this.context.vivaldiWindowId)||{};this.setState({style:e})};addMessageBody=async(e,t)=>{const n=(0,bt.H)(t);if(!await d.Z.mailPrivate.addMessageBody(e,n))throw new Error(`Failed to add body to FTS db for id ${e}`)};fetchMessage=async e=>{const{listEntry:t}=e,n=M.Z.get(D.kMailPreferredRendering);if(this.setState({message:void 0,raw:void 0,renderingMethod:n,accountOfflineNoMessage:!1,netOfflineNoMessage:!1},(()=>{kZ.nextTick(Wm.Z.refreshActiveMessage)})),!t)return void de.Z.log("Mail",["detail-view","fetch-message"],"no listEntry");const{id:i,sentDate:s,sourceFilterIds:o,fromIds:a}=t;this._currentId=i;const r=await CZ.Z.call(i);if(!r)return void de.Z.log("Mail",["detail-view","fetch-message"],"no message");const l=()=>{const e=this._currentId!==r.id;return e&&de.Z.log("Mail",["detail-view","fetch-message"],"selection changed"),e};if(l())return;this.setState({message:r},Wm.Z.refreshActiveMessage);const d=M.Z.get(D.kMailAccounts),c=Pl.Z.getSelectedFolder(),h=$g.C.getByIds(o);function p(e){const t=[],n=[],i=[];for(const s of e)s.accountId!==c?.accountId||c?.path!==ue.ym&&s.path!==c?.path?s.accountId===c?.accountId?n.push(s):i.push(s):t.push(s);return{samePathFilters:t,sameAccountFilters:n,otherFilters:i}}const u=p(h);let g,m;async function v(e){for(const t of e)if(g=await IZ.Z.call(t.accountId,i,s),g)return g}if(g=await v(u.samePathFilters)||await v(u.sameAccountFilters)||await v(u.otherFilters),l())return;async function f(e){const t=d.filter((e=>e.accountType===ue.s9.IMAP&&!e.offline)),n=e.filter((e=>t.find((t=>t.MAIL_EMAIL===e.accountId))));for(const e of n){const{accountId:t,path:n}=e;try{if(g=await te.Z.fetchRawOfMessage(t,n,r.id),g)return m={accountId:t,type:"imap"},g}catch(e){de.Z.info(e)}}if(!g){const t={},n=d.filter((e=>e.accountType===ue.s9.POP));if(n.length>0){const i=await hm.Z.loadAllAccounts(),s=e.filter((e=>n.find((t=>t.MAIL_EMAIL===e.accountId))));for(const e of s){const n=i.find((t=>t.MAIL_EMAIL===e.accountId));n&&(t[e.accountId]=n)}}if(Object.keys(t).length>0){const e=(await SZ.call(i)).filter((e=>e.headersOnly));for(const n of e){const{accountId:e,uidl:i}=n,s=t[e];try{return g=await ae.getPopMessage(s,i,r),m={accountId:e,type:"pop",uidl:i},g}catch(e){de.Z.info(e)}}}}}this.isRssFeedMessage=h.some((e=>e.accountId===ue.u4));const y=h.filter((e=>{const n=t.sources.get(e.id);return n&&!n.internal}));if(!g){if(y.length>0&&!navigator.onLine)return this.setState({netOfflineNoMessage:!0}),void de.Z.warn("Mail",["detail-view","fetch-message"],"no network connection");const e=y.some((e=>d.find((t=>t.MAIL_EMAIL===e.accountId&&!t.offline))));if(y.length>0&&!e)return this.setState({accountOfflineNoMessage:!0}),void de.Z.warn("Mail",["detail-view","fetch-message"],"account is offline");if(this.isRssFeedMessage)return void de.Z.warn("Mail",["detail-view","fetch-message"],"Unexpected rss messages without a raw");if(0===y.length)return void de.Z.log("Mail",["detail-view","fetch-message"],"no external source filter");const t=p(y);if(g=await f(t.samePathFilters)||await f(t.sameAccountFilters)||await f(t.otherFilters),!g)return void de.Z.log("Mail",["detail-view","fetch-message"],"Failed to fetch message");if(l()){if(g&&m){const e=await lA(g),t=await e.parseSearchPart();await this.addMessageBody(i,t),await ZZ(e,r,m),j.Z.runStoredQueryFilters([i]),y.length>1&&(0,bZ.Z)({operation:"BUFFER_OPERATION_FETCH_RAW_FOR_ALL_SOURCES",searchListId:i}).then(ee.Z.flushBuffer)}return}}let w;if(this.isRssFeedMessage){w=dt(new TextDecoder("utf-8").decode(g))}this.setState({isSenderTrusted:this.isRssFeedMessage||pm.Z.get(a).every((e=>Aa.Z.isTrustedEmailAddress(e.address))),message:this.isRssFeedMessage?{...r,bodyParts:w}:r,raw:this.isRssFeedMessage?new dA({contentType:{value:"application/rss+xml",params:{}},contentID:void 0,disposition:void 0,transferEncoding:"7bit",bodyStart:0,byteLength:g.byteLength,byteOffset:g.byteOffset},g):await lA(g)},(async()=>{Wm.Z.refreshActiveMessage(),y.length>1&&(0,bZ.Z)({operation:"BUFFER_OPERATION_FETCH_RAW_FOR_ALL_SOURCES",searchListId:i}).then(ee.Z.flushBuffer);const e=this.state.raw;if(!e||!m)return void(e||de.Z.log("Mail",["detail-view","fetch-message"],"no rawWrapper"));const t=await e.parseMainPart(n);await this.addMessageBody(i,t),await ZZ(e,r,m),j.Z.runStoredQueryFilters([i])}))};toggleRenderingMethod=e=>{this.setState((t=>({renderingMethod:t.renderingMethod===e?M.Z.get(D.kMailPreferredRendering):e})))};onUnblockExternalContent=e=>{const t=this.state.message;var n;if(t)if(e){const e=t.from;e[0]&&(K.Z.putTrustedEmailAddress(this.context.vivaldiWindowId,e[0]),this.setState({isSenderTrusted:!0}))}else n=t.id,vt.Z.messages.update(n,{trusted:!0}),this.setState((e=>e.message?{message:{...e.message,trusted:!0}}:null))};render(){let e=[],t="";const{listEntry:n,hasNoListEntries:i}=this.props;if(n){const{fromIds:i}=n;e=pm.Z.get(i),t=e.length>0?e[0].address:""}const s=!this.state.accountOfflineNoMessage&&!this.state.netOfflineNoMessage;return AZ("div",{id:"mail_detail"},void 0,n&&(0,fn.jsx)(wZ,{ref:this.messageHeader,message:this.state.message,listEntry:n,renderingMethod:this.state.renderingMethod,from:e,fromAddress:t}),s&&(0,fn.jsx)("div",{...!this.props.listEntry&&{style:{display:"none"}},className:"message-body-part",children:(0,fn.jsx)(GA,{ref:this.messageBody,windowId:this.context.vivaldiWindowId,isRss:this.isRssFeedMessage,style:this.state.style,message:this.state.message,raw:this.state.raw,renderingMethod:this.state.renderingMethod,isSenderTrusted:this.state.isSenderTrusted,fromAddress:t,onUnblockExternalContent:this.onUnblockExternalContent})}),s&&!n&&!i&&AZ("section",{className:"no-message-selected"},void 0,AZ("div",{dangerouslySetInnerHTML:{__html:cn.Fii}}),AZ("div",{},void 0,(0,le.Z)("No message selected"))),this.state.netOfflineNoMessage&&AZ("section",{className:"no-message-selected"},void 0,AZ("div",{dangerouslySetInnerHTML:{__html:cn.Fii}}),AZ("div",{},void 0,(0,le.Z)("No network connection. Unable to fetch message"))),this.state.accountOfflineNoMessage&&AZ("section",{className:"no-message-selected"},void 0,AZ("div",{dangerouslySetInnerHTML:{__html:cn.Fii}}),AZ("div",{},void 0,(0,le.Z)("Account is offline. Unable to fetch message"))))}}const _Z=EZ;var NZ;function MZ(e,t,n,i){NZ||(NZ="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:NZ,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class PZ extends tn.PureComponent{state={listEntry:void 0};componentDidMount(){$g.C.isInitialized()?this.getListEntry():$g.C.addListener(this.onMailFilterStoreChange)}componentWillUnmount(){$g.C.ensureRemovedListener(this.onMailFilterStoreChange)}onMailFilterStoreChange=e=>{"finishIndexProgress"===e.target&&(this.getListEntry(),$g.C.ensureRemovedListener(this.onMailFilterStoreChange))};getListEntry(){const e=$g.C.getListEntry(this.props.id);this.setState({listEntry:e})}render(){return MZ("div",{id:"mail_view",className:"top"},void 0,MZ(_Z,{hasNoListEntries:!0,listEntry:this.state.listEntry,pageIsActive:this.props.isActive}))}}const DZ=PZ;var xZ;function OZ(e,t,n,i){xZ||(xZ="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:xZ,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const LZ=[D.kPanelsAsOverlayEnabled,D.kPanelsPosition,D.kMailViewDimensions,D.kMailViewLayout,D.kToolbarsMail,D.kToolbarsMailComposer,D.kToolbarsMailMessage];class RZ extends tn.Component{static contextType=dn.Z;winId=this.context.vivaldiWindowId;state={allMessages:!1,searchInput:"",showMailingLists:!0,showMailingListsButton:!1,showRead:!0,showReadButton:!1,showDeleted:!1,showDeletedButton:!1,showCustomFolder:!0,showCustomFolderButton:!1,showJunk:!1,showJunkButton:!1,showFeeds:!1,showFeedsButton:!1,showArchived:!1,showArchivedButton:!1,showSubFolders:!1,folder:""};componentDidMount(){Pl.Z.addListener(this.selectedFolderChanged),this.selectedFolderChanged()}componentWillUnmount(){Pl.Z.removeListener(this.selectedFolderChanged)}selectedFolderChanged=()=>{let e,t;const n=Pl.Z.getSelectedFolder(),i=Pl.Z.getOptions();if(!n)return;e=n.accountId,t=n.path;const s=$g.C.getByFolder(e,t||ue.ym),o=s?s.filterValue:{...ot.Z.getSearchListButtons("")};s&&this.updateViews(s),this.updateShowButtons(o);const a=i.forSender?ot.Z.getContactQuery(i.forSender,new Set(["to","from"])):s?.filterValue.query;this.setState({folder:e+t,filterQuery:a,allMessages:!!i.allMessages})};updateViews=e=>{this.setState(ot.Z.getFilterOptions(e))};toggleShow=e=>{const t=Pl.Z.getSelectedFolder(),n=t&&this.getOldFilter(t);n&&this.setState((t=>{const i=!t[e],s=(0,E.Uy)(n,(t=>{t.filterValue[e]=i}));return j.Z.putFilter(s,n),{[e]:i}}))};toggleShowFeedsInUnread=()=>{this.toggleShow("showFeeds")};toggleShowMailingLists=()=>{this.toggleShow("showMailingLists")};toggleShowRead=()=>{this.toggleShow("showRead")};toggleShowDeleted=()=>{this.toggleShow("showDeleted")};toggleShowJunk=()=>{this.toggleShow("showJunk")};toggleShowCustomFolder=async()=>{this.toggleShow("showCustomFolder")};toggleShowArchived=()=>{this.toggleShow("showArchived")};getOldFilter=e=>$g.C.getByFolder(e.accountId,e.path||ue.ym);updateShowButtons=e=>{this.setState({showMailingListsButton:this._updateShowButton(e,"showMailingListsButton"),showReadButton:this._updateShowButton(e,"showReadButton"),showDeletedButton:this._updateShowButton(e,"showDeletedButton"),showJunkButton:this._updateShowButton(e,"showJunkButton"),showFeedsButton:this._updateShowButton(e,"showFeedsButton"),showCustomFolderButton:this._updateShowButton(e,"showCustomFolderButton"),showArchivedButton:this._updateShowButton(e,"showArchivedButton")})};_updateShowButton=(e,t)=>!e.hasOwnProperty(t)||e[t];getContextMenuItems=()=>{const e=[];return this.state.showReadButton&&e.push({type:"checkbox",checked:this.state.showRead,handler:this.toggleShowRead,...(0,Mn.Z)("Read")}),this.state.showMailingListsButton&&e.push({type:"checkbox",checked:this.state.showMailingLists,handler:this.toggleShowMailingLists,...(0,Mn.Z)("Mailing Lists")}),this.state.showCustomFolderButton&&e.push({type:"checkbox",checked:this.state.showCustomFolder,handler:this.toggleShowCustomFolder,...(0,Mn.Z)("Custom Folders")}),this.state.showFeedsButton&&e.push({type:"checkbox",checked:this.state.showFeeds,handler:this.toggleShowFeedsInUnread,...(0,Mn.Z)("Feeds")}),this.state.showJunkButton&&e.push({type:"checkbox",checked:this.state.showJunk,handler:this.toggleShowJunk,...(0,Mn.Z)("Junk")}),this.state.showDeletedButton&&e.push({type:"checkbox",checked:this.state.showDeleted,handler:this.toggleShowDeleted,...(0,Mn.Z)("Deleted Items")}),this.state.showArchivedButton&&e.push({type:"checkbox",checked:this.state.showArchived,handler:this.toggleShowArchived,...(0,Mn.Z)("Archived")}),e};onContextMenu=e=>{const t=e.target instanceof HTMLElement&&e.target.closest(".calendar-grid");t&&t!==document.activeElement&&t instanceof HTMLElement&&t.focus(),(0,zi.Z)(this.context.vivaldiWindowId,this.getContextMenuItems())(e)};renderButtons(){const e=this.state.allMessages,t=[];return this.state.showReadButton&&!e&&t.push(OZ(sl,{isOn:this.state.showRead,tooltip:(0,le.Z)("Show Read"),onClick:this.toggleShowRead,image:this.state.showRead?cn.tD0:cn.LDV.small},"Read")),this.state.showCustomFolderButton&&!e&&t.push(OZ(sl,{isOn:this.state.showCustomFolder,tooltip:(0,le.Z)("Show Messages from Custom IMAP Folders"),onClick:this.toggleShowCustomFolder,image:this.state.showCustomFolder?cn.Hj9:cn.dMx.small},"CustomFolder")),this.state.showMailingListsButton&&!e&&t.push(OZ(sl,{isOn:this.state.showMailingLists,tooltip:(0,le.Z)("Show Mailing Lists"),onClick:this.toggleShowMailingLists,image:this.state.showMailingLists?cn.ibx:cn.GAD.small},"MailingLists")),this.state.showFeedsButton&&!e&&t.push(OZ(sl,{isOn:this.state.showFeeds,tooltip:(0,le.Z)("Show Feeds"),onClick:this.toggleShowFeedsInUnread,image:this.state.showFeeds?cn.hCY:cn.ZU_.small},"Feeds")),this.state.showJunkButton&&!e&&t.push(OZ(sl,{isOn:this.state.showJunk,tooltip:(0,le.Z)("Show Junk"),onClick:this.toggleShowJunk,image:this.state.showJunk?cn.K30:cn.Qwh.small},"Junk")),this.state.showDeletedButton&&!e&&t.push(OZ(sl,{isOn:this.state.showDeleted,tooltip:(0,le.Z)("Show Trash"),onClick:this.toggleShowDeleted,image:this.state.showDeleted?cn.Y41:cn.nre.small},"Deleted")),this.state.showArchivedButton&&!e&&t.push(OZ(sl,{isOn:this.state.showArchived,tooltip:(0,le.Z)("Show Archived"),onClick:this.toggleShowArchived,image:this.state.showArchived?cn.sBl:cn._w1.small},"Archived")),t}render(){const e=this.renderButtons();return 0===e.length?null:OZ("div",{className:"MailListButtons",onContextMenu:this.onContextMenu},void 0,OZ("span",{className:"MailListButtons-Label"},void 0,(0,le.Z)("mail","Show"),":"),OZ("div",{className:"toolbar toolbar-insideinput"},void 0,e))}}const BZ=(0,fs.Z)(RZ,LZ);var FZ;function UZ(e,t,n,i){FZ||(FZ="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:FZ,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class VZ extends tn.PureComponent{renderSubjectLine=()=>(0,fn.jsxs)(fn.Fragment,{children:[this.props.isParent&&UZ("div",{className:"status-indicators"},void 0,UZ("span",{className:"expand-icon",onClick:this.props.handleExpandClick,dangerouslySetInnerHTML:{__html:n(4103)}})),UZ("div",{className:"subject"},void 0,this.props.queued&&UZ("span",{className:"mail-queued",dangerouslySetInnerHTML:{__html:n(48783)}}),UZ("div",{className:"subject-title"},void 0,this.props.variables.subject)),UZ(cZ,{className:"labels",flags:this.props.flags})]});renderDataLine=()=>{const e=void 0!==this.props.level&&this.props.level>0,t=this.props.variables,i=e&&!this.props.isParent?16:0;let s=0;return"number"==typeof this.props.level&&(s=16*Math.min(this.props.level-1,5)),(0,fn.jsxs)(fn.Fragment,{children:[UZ("div",{className:"status-indicators"},void 0,this.props.renderStatusIndicator(t,"vertical")),UZ("div",{className:"from",style:{paddingLeft:this.props.level?`${s+i}px`:0,minWidth:this.props.level?`${50+s+i}px`:0}},void 0,this.props.isParent&&e&&UZ("div",{className:"status-indicators"},void 0,UZ("span",{className:"expand-icon",onClick:this.props.handleExpandClick,dangerouslySetInnerHTML:{__html:n(4103)}})),UZ("div",{className:"mail-contact-name"},void 0,t.contactString),0!==this.props.attachment&&UZ("span",{className:"mail-status-indicator mail-attachment-indicator",title:(0,le.Z)("Attachment"),dangerouslySetInnerHTML:{__html:n(51843)}})),e&&UZ(cZ,{className:"labels",flags:this.props.flags}),t.flagColor&&UZ("span",{className:`mail-status-indicator ${t.flagColor}`,dangerouslySetInnerHTML:{__html:cn.nyn.small}}),UZ("div",{className:"maildate"},void 0,UZ("div",{className:"mailDateInfo"},void 0,t.datetime))]})};getTitle=()=>{const e=Pl.Z.getSelectedFolder(),t=e&&$g.C.getByFolder(e.accountId,e.path),n=this.props.variables,i=cm.Z.call(this.props.sources,t)?"":` (${this.props.unseen?(0,le.Z)("Unseen"):(0,le.Z)("Unread")})`;return`${n.subject}${i}\n`+(0,le.Z)("From: $1",[n.contactString])+"\n"+(0,le.Z)("Sent: $1",[n.datetime])};render(){const e=0===this.props.level,t=0!==this.props.level;return UZ("div",{className:this.props.variables.classes,"data-id":this.props.id,title:this.getTitle()},void 0,e&&(0,fn.jsxs)(fn.Fragment,{children:[UZ("div",{className:"mail_entry_row data_row"},void 0,this.renderDataLine()),UZ("div",{className:"mail_entry_row subject_row"},void 0,this.renderSubjectLine())]}),t&&UZ("div",{className:"mail_entry_row data_row"},void 0,this.renderDataLine()))}}const WZ=VZ;var HZ;function zZ(e,t,n,i){HZ||(HZ="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:HZ,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const GZ=[D.kCalendarRelativeDates,D.kMailCountersPanelUnseenEnabled],$Z={sameDay:(0,le.Z)("[Today] $1",["LT"]),lastDay:(0,le.Z)("[Yesterday] $1",["LT"]),nextDay:(0,le.Z)("[Tomorrow]",["LT"]),nextWeek:(0,le.Z)("[Next] $1",["dddd"]),lastWeek:"dddd LT",sameElse:"LL LT"},KZ={...$Z,lastWeek:"dddd LT",sameElse:"ll LT"},jZ={...$Z,lastWeek:"ddd LT",sameElse:"L LT"},YZ=[145,170,205];var XZ=zZ("span",{className:"mail-status-indicator"}),QZ=zZ("span",{}),qZ=zZ("span",{});class JZ extends tn.Component{renderStatusIndicator=(e,t)=>{const i=XZ,{selectedFilter:s,sources:o}=this.props,a=(0,$m.Z)(o),r=!!s&&ba.Z.getFolderType(s.accountId,s.path)===ue.Nz,l=s?Gm.Z.isMessageDeleted(o,s,r):Gm.Z.isMessageDeleted(o),d=cm.Z.call(o,s),c=this.props.isParent&&this.props.unreadInThread&&d,h=(0,zm.Z)(o);switch(!0){case a:return zZ("span",{className:"mail-status-indicator read-status spam",dangerouslySetInnerHTML:{__html:cn.Qwh.small}});case l:return zZ("span",{className:"mail-status-indicator read-status trash",dangerouslySetInnerHTML:{__html:cn.nre.small}});case h:return zZ("span",{className:"mail-status-indicator read-status",dangerouslySetInnerHTML:{__html:cn._w1.small}});case(0,ev.B_)(this.props):return zZ("span",{className:"mail-status-indicator",dangerouslySetInnerHTML:{__html:cn.hGk.small}});case(0,ev.XN)(this.props):return zZ("span",{className:"mail-status-indicator",dangerouslySetInnerHTML:{__html:cn.upG.small}});case!d:case c:return zZ("span",{className:"mail-status-indicator read-status",dangerouslySetInnerHTML:{__html:n(c?85382:88826)}});default:return i}};renderFlags=(e,t,n)=>zZ("span",{className:`mail-status-indicator ${t.flagColor}`,dangerouslySetInnerHTML:{__html:cn.nyn[n]}});renderMailEntryHorizontal=e=>{const{columns:t}=this.props;if(!t)return null;const i=this.props.level&&!this.props.isParent?16:0;let s=0;"number"==typeof this.props.level&&(s=16*Math.min(this.props.level,5));const o=b()(this.props.sentDate).format("LT"),a=b()().isSame(this.props.sentDate,"day");var r=zZ("span",{},void 0,o),l=zZ("span",{},void 0,o);return zZ("div",{className:e.classes,"data-id":this.props.id},void 0,t.map((d=>{switch(d.id){case"unread":return zZ("label",{},d.id,this.renderStatusIndicator(e,"horizontal"));case"sender":return zZ("label",{className:"from"},d.id,zZ("span",{},void 0,e.contactString));case"subject":return zZ("label",{className:"subject",style:{width:t?"var(--subjectWidth)":null,marginLeft:this.props.level?`${s+i}px`:0}},d.id,this.props.isParent&&zZ("span",{className:"expand-icon",onClick:this.props.handleExpandClick,dangerouslySetInnerHTML:{__html:n(4103)}}),this.props.queued&&zZ("span",{className:"mail-queued",dangerouslySetInnerHTML:{__html:n(48783)}}),zZ("span",{},void 0,e.subject));case"label":return zZ("label",{className:"labels"},d.id,zZ("div",{className:"adjustment-mail-labels"},void 0,zZ(cZ,{flags:this.props.flags,style:{paddingLeft:"unset"}})));case"flag":return zZ("label",{},d.id,e.messageIsFlagged&&this.renderFlags(this.props,e,"small"));case"attachment":return zZ("label",{className:"mail-status-indicator"},d.id,this.props.attachment>0&&2048!==this.props.attachment&&zZ("span",{},void 0,(0,le.Z)("$1 item","$1 items",[this.props.attachment])),2048===this.props.attachment&&zZ("span",{},void 0,(0,le.Z)("1+ items")));case"size":return zZ("label",{},d.id,QZ);case"sentDate":return zZ("label",{className:"maildate"},d.id,a&&d.width<=YZ[0]?r:(0,fn.jsxs)(fn.Fragment,{children:[zZ("span",{},void 0,e.datetime.split(o)[0]),d.width>YZ[0]&&l]}));case"threads":return zZ("label",{},d.id,qZ);default:console.warn("Unknown column:",d.id)}})))};contactsToString(e){let t="";if(e&&e.length>0){pm.Z.get(e).forEach((e=>{t&&(t+=", "),t+=e.name?e.name:e.address}))}return t}render(){const e={mail_entry:!0,"mail-parent":this.props.isParent,"mail-child":this.props.isChild},t={classes:mn()(e,"loading"),contactString:"",contactColumnTitle:"",datetime:"",flagColor:"",messageIsFlagged:!1,subject:""},n=this.props.prefValues[D.kMailCountersPanelUnseenEnabled]&&this.props.unseen;t.subject=this.props.subject||"(no subject)",t.messageIsFlagged=(0,ev.u9)(this.props),t.classes=mn()(e,{unread:!n&&!cm.Z.call(this.props.sources,this.props.selectedFilter),unseen:n});const i=Pl.Z.getSelectedFolder(),s=i&&(i.type||i.path);[ue.Nz,ue.kY,ue.fZ].includes(s)?(t.contactString=this.contactsToString(this.props.toIds),t.contactColumnTitle=(0,le.Z)("mail","To")):(t.contactString=this.contactsToString(this.props.fromIds),t.contactColumnTitle=(0,le.Z)("mail","From")),t.messageIsFlagged&&(t.flagColor=`flag-color flag-${(0,ev.Zr)(this.props.flags).toLowerCase()}`);const o=(this.props.columns||[]).find((e=>"sentDate"===e.id)),a=o&&o.width>YZ[1]&&"vertical"!==this.props.direction?o.width>YZ[2]?$Z:KZ:jZ;return t.datetime=this.props.prefValues[D.kCalendarRelativeDates]?b()(this.props.sentDate).calendar(null,a):b()(this.props.sentDate).format(a.sameElse),"horizontal"===this.props.direction||"vertical_wide"===this.props.direction?this.renderMailEntryHorizontal(t):zZ(WZ,{variables:t,handleExpandClick:this.props.handleExpandClick,unseen:this.props.unseen,id:this.props.id,queued:this.props.queued,flags:this.props.flags,sources:this.props.sources,isParent:this.props.isParent,level:this.props.level,attachment:this.props.attachment,renderStatusIndicator:this.renderStatusIndicator})}}const eE=(0,fs.Z)(JZ,GZ);var tE=n(90864),nE=n(75995);const iE=function(e){return!!e.isParent&&!e.isExpanded&&!!e.unreadInThread},sE=function(e,t,n){for(let i=t+1;i<e.length;i++){const t=e[i];if(!cm.Z.call(t.sources,n)||iE(t))return i}return-1},oE=function(e,t,n){for(let i=t-1;i>=0;i--){const t=e[i];if(!cm.Z.call(t.sources,n)||iE(t))return i}return-1},aE=function(e,t,n,i,s="undefined"){if("undefined"===s){if(n){const n=sE(e,t,i);return n>-1?n:oE(e,t,i)}{const n=oE(e,t,i);return n>-1?n:sE(e,t,i)}}return"previous"===s?n?oE(e,t,i):sE(e,t,i):n?("next"!==s&&console.warn("Direction to look for unread mail is not correct"),sE(e,t,i)):oE(e,t,i)};var rE,lE=n(51733);function dE(e,t,n,i){rE||(rE="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:rE,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class cE extends tn.PureComponent{refTree=tn.createRef();static contextType=dn.Z;winId=this.context.vivaldiWindowId;state={list:$g.C.getListEntries(),sorting:{sortField:M.Z.get(D.kMailSearchSortField),sortOrder:M.Z.get(D.kMailSearchSortOrder),comparator:void 0,onlyScroll:!0}};componentDidMount(){$g.C.addListener(this.messageListChanged)}componentWillUnmount(){this._unbind(),$g.C.removeListener(this.messageListChanged)}messageListChanged=e=>{switch(e.target){case"gotoUnread":return void this._gotoUnreadFiltered();case"gotoNextUnread":return void this._gotoNextUnread();case"gotoPreviousUnread":return void this._gotoPreviousUnread();case"listEntries":return void this.updateListEntriesDebounced(e)}};updateListEntriesDebounced=(0,Zr.Z)((e=>{const{isLoading:t,updateSelection:n,updateScrollPosition:i}=e,s={sortField:M.Z.get(D.kMailSearchSortField),sortOrder:M.Z.get(D.kMailSearchSortOrder),onlyScroll:!0},o=t?{isLoading:!0}:{isLoading:!1,sorting:s,list:$g.C.getListEntries()};this.setState(o,(()=>{n&&this.updateMessageSelection(i)}))}),100,{maxWait:200});delete=(e,t)=>{const n=this.context.vivaldiWindowId;return Pl.Z.isTrashFolderSelected()||t?Wm.Z.prepareDelete(n,!0):Wm.Z.prepareDelete(n,!1)};isValidForClipboard=e=>!1;isValidAddTarget=e=>!1;hasChildren=e=>e.children&&e.children.length;isFolder=e=>this.hasChildren(e);getSelectedNodes=()=>{const e=this.refTree.current;if(!e)return[];const t=e.selectionModel.selectedIds,n=e.state.renderedArray;return t.map((e=>n.find((t=>t.id===e.id)))).filter(Boolean)};getNumSelected=()=>this.refTree.current?this.refTree.current.selectionModel.selectedIds.length:0;_findIndex=(e,t,n)=>{if(-1===e)return 0===t.length||"ascending"===this.state.sorting.sortOrder?-1:-t.length-1;let i=$g.C.getListEntry(e);if(i||this.selectedEntry?.id!==e||(i=this.selectedEntry),!i)return-1;if("threads"===this.state.sorting.sortField&&"descending"===this.state.sorting.sortOrder){const e=(e,t)=>e.threadKey[0]===t.threadKey[0]?t.threadKey[1]-e.threadKey[1]:t.threadKey[0]-e.threadKey[0];let n=jg()(t,i,e);if(n>=0){for(;n>0&&0===e(t[n-1],i)&&(0,lE.HT)(t[n],i)>0;)n--;for(;n<t.length-1&&0===e(t[n],i)&&(0,lE.HT)(t[n],i)<0;)n++;i!==t[n]&&(n=-n-1)}return n}return jg()(t,i,n)};setMessageSelection=(e=[],t,n)=>{const i=this.refTree.current;if(!i)return;const s=t?t.id:-1,o=n?n.id:-1;i.selectionModel.setSelectedIds(e),i.selectionModel.anchorIndex=s,i.selectionModel.leadIndex=o,i.updateSelectionState(),i.saveSelectionModel(),this.onSelect(n)};updateMessageSelection=(e=!1)=>{const t=this.refTree.current;if(!t)return this.onSelect();const n=t.state.renderedArray;if(0===n.length)return this.setMessageSelection();const i=$g.C.getListEntryComparator(),s=t.selectionModel.selectedIds.map((e=>e.id)).filter((e=>this._findIndex(e,n,i)>=0));let o=t.selectionModel.leadIndex;if(-1===o&&(o=t.selectionModel.anchorIndex),-1===o)return this.setMessageSelection();let a=this._findIndex(o,n,i);a<0&&(a=-a-1);let r=this._findIndex(t.selectionModel.anchorIndex,n,i);r<0&&(r=-r-1);const l=a>r;if(0===s.length){const e=Math.min(a,n.length-1),t=n[e];s.push(t.id)}const d=s[l?0:s.length-1],c=this._findIndex(d,n,i),h=n[c],p=s[l?s.length-1:0],u=this._findIndex(p,n,i),g=n[u];this.setMessageSelection(s,h,g),e&&t.scrollIntoView(u)};_markSelectedRead=()=>{Wm.Z.markRead(this.winId)};_markSelectedThreadRead=()=>{"threads"===!this.state.sorting.sortField?Wm.Z.markRead(this.winId):Wm.Z.markThreadRead(this.winId)};_markSelectedUnread=()=>{Wm.Z.markUnread(this.winId)};_markSelectedFlagged=()=>{Wm.Z.markFlagged(this.winId)};_toggleSenderAsMailingList=()=>{this.getSelectedNodes().forEach((e=>{const t=pm.Z.get(e.fromIds);j.Z.toggleSenderAsMailingList(this.winId,t[0].address)}))};_markSelectedUnflagged=()=>{Wm.Z.markUnflagged(this.winId)};_goToNext=()=>{const e=this.refTree.current;if(!e)return;const t=e.selectionModel.leadIndex,n=e.state.renderedArray;let i=this._findIndex(t,n,$g.C.getListEntryComparator());if(i<0&&(i=-i-1),i<n.length-1){const t=n[i+1];t.isParent&&!t.isExpanded?(e.toggleExpandModel(t.id),this._goToNext()):t&&e.selectByNode(t)}};_goToNextUnread=e=>{const t=this.refTree.current;if(!t)return;const n=t.selectionModel.leadIndex,i=t.state.renderedArray;let s=this._findIndex(n,i,$g.C.getListEntryComparator());s<0&&(s=-s-1);const o=Pl.Z.getSelectedFolder(),a=o&&$g.C.getByFolder(o.accountId,o.path);if(!a)throw new Error("Filter not found");const r=aE(i,s,"ascending"===this.state.sorting.sortOrder,a,e);if(r>-1){const n=i[r];n.isParent&&!n.isExpanded?(t.toggleExpandModel(n.id),this._goToNextUnread(e)):t.selectByNode(n)}};_markAndGotoNextUnread=Eu.throttleSync((()=>{this._markSelectedRead(),this._gotoUnreadFiltered("undefined")}));_gotoNextUnread=Eu.throttleSync((()=>{this._gotoUnreadFiltered("next")}));_gotoPreviousUnread=Eu.throttleSync((()=>{this._gotoUnreadFiltered("previous")}));_gotoUnreadFiltered=(e="undefined")=>{const t=Pl.Z.getSelectedFolder();if(!t)return;const n=$g.C.getByFolder(t.accountId,t.path);ot.Z.getFilterOptions(n).showRead&&this._goToNextUnread(e)};getLabelMenuItems=()=>{const e=Nl.Z.getActiveListEntry(),t=e?(0,ev.Q3)(e.flags):[],n=Wm.Z.getCustomLabelsMenu(this.winId,t);return n.push(G.Z.separatorItem,{handler:()=>ie.Z.showAddCustomLabel(this.winId),ellipsis:!0,...(0,Mn.Z)("Add New Label")}),t.length>0&&n.push(G.Z.separatorItem,{handler:()=>Wm.Z.clearAllLabels(this.winId,t),...(0,Mn.Z)("Clear All Labels")}),n};_scrollOrMarkAndGotoNext=e=>{const t=document.querySelector("#mail_view .mail_body webview");t instanceof HTMLElement&&"function"==typeof t.executeScript&&t.executeScript({code:this._injectCode(e.shiftKey)},(e=>{e&&!1===e[0]&&(this._markSelectedRead(),this._goToNext())}))};_injectCode=e=>e?"b__ = document.documentElement.querySelector('body');\n      if (b__.scrollTop !== 0) {\n        b__.scrollBy({\n          top: - b__.clientHeight - 30,\n          left: 0,\n          behavior: 'smooth'\n        });\n        true;\n      }":"b__ = document.documentElement.querySelector('body');\n      if (b__.scrollHeight - b__.scrollTop > b__.clientHeight) {\n        b__.scrollBy({\n          top: b__.clientHeight - 30,\n          left: 0,\n          behavior: 'smooth'\n        });\n        true;\n      } else {\n        false;\n      }";_getTrashPath=e=>ya.Z.getFolderByType(e,ue.uT).then((e=>e&&e.length?e[0].path:void 0));_sendSelected=()=>{he.Z.sendSelected(this.context.vivaldiWindowId,this.getSelectedNodes())};standardFlagMenuData=()=>{const e=Nl.Z.getActiveListEntry(),t=e?(0,ev.Zr)(e.flags):"";return Wm.Z.getStandardFlagsMenu(this.winId,t)};getMenuCapability=(e,t,n)=>{const i=this.winId,s=qm.isEnabled("MailMsgSpam"),o=qm.isEnabled("MailMsgArchive"),a=e=>{const t=Pl.Z.getSelectedFolder(),n=t&&$g.C.getByFolder(t.accountId,t.path);return Boolean(e)&&cm.Z.call(e.sources,n)},r=e=>{const t=Pl.Z.getSelectedFolder();if(t&&$g.C.getByFolder(t.accountId,t.path))return(0,zm.Z)(e.sources)},l=e=>{const t=Pl.Z.getSelectedFolder();if(t&&$g.C.getByFolder(t.accountId,t.path))return(0,$m.Z)(e.sources)},d=e=>"threads"===this.state.sorting.sortField&&1===this.getNumSelected()&&Boolean(e)&&Boolean(e.children),c=e=>1===this.getNumSelected()&&Boolean(e)&&e.fromIds.length>0?pm.Z.get(e.fromIds)[0].address:"",h=()=>$g.C.getByIds(n.sourceFilterIds).some((e=>e.accountId===ue.of&&e.path===ue.J8)),p=()=>{const e=Pl.Z.getSelectedFolder();return!!e&&ba.Z.getFolderType(e.accountId,e.path)===ue.tB},u=()=>{const e=Pl.Z.getSelectedFolder(),t=e&&$g.C.getByFolder(e.accountId,e.path);return!!t&&ba.Z.getFolderType(t.accountId,t.path)===ue.Nz};switch(e.action){case"COMMAND_MAIL_COMPOSE_NEW_MESSAGE":return Promise.resolve({handler:ne.Z.createDraft.bind(null,void 0),...t(i,e,{})});case"CONTEXT_SEND":return Promise.resolve({handler:this._sendSelected,visible:Boolean(n)&&h(),...t(i,e,{})});case"COMMAND_MAIL_REPLY":return Promise.resolve({visible:Boolean(n)&&qm.isEnabled("MailMsgReply"),...t(i,e,{})});case"COMMAND_MAIL_REPLY_ALL":return Promise.resolve({handler:Wm.Z.replyAll,visible:Boolean(n)&&qm.isEnabled("MailMsgReplyToAll"),...t(i,e,{})});case"COMMAND_MAIL_FORWARD":return Promise.resolve({visible:Boolean(n)&&!h(),...t(i,e,{})});case"COMMAND_MAIL_MARK_READ":return Promise.resolve({visible:Boolean(n)&&qm.isEnabled("MailMsgStatusRead")&&!a(n),...t(i,e,{})});case"COMMAND_MAIL_MARK_UNREAD":return Promise.resolve({visible:Boolean(n)&&qm.isEnabled("MailMsgStatusRead")&&a(n),...t(i,e,{})});case"CONTEXT_GOTO":case"COMMAND_MAIL_MARK_READ_AND_GOTO_NEXT_UNREAD":case"CONTEXT_THREAD":return Promise.resolve({visible:Boolean(n),...t(i,e,{})});case"COMMAND_MAIL_GOTO_NEXT_UNREAD":case"COMMAND_MAIL_GOTO_PREVIOUS_UNREAD":return Promise.resolve({visible:Boolean(n)&&!p(),...t(i,e,{})});case"CONTEXT_CONTAINER_MOVE":return Promise.resolve({items:Wm.Z.getMoveToFolderMenu(i),visible:Boolean(n),...t(i,e,{})});case"CONTEXT_ADD_FLAG":return Promise.resolve({handler:this._markSelectedFlagged,visible:Boolean(n)&&qm.isEnabled("MailMsgFlag")&&!(0,ev.u9)(n),...t(i,e,{})});case"CONTEXT_REMOVE_FLAG":return Promise.resolve({handler:this._markSelectedUnflagged,visible:Boolean(n)&&qm.isEnabled("MailMsgFlag")&&(0,ev.u9)(n),...t(i,e,{})});case"CONTEXT_CONTAINER_FLAGS":return Promise.resolve({items:this.standardFlagMenuData(),visible:Boolean(n)&&qm.isEnabled("MailMsgFlag"),...t(i,e,{})});case"CONTEXT_CONTAINER_LABELS":return Promise.resolve({items:this.getLabelMenuItems(),visible:Boolean(n)&&qm.isEnabled("MailMsgLabel"),...t(i,e,{})});case"CONTEXT_EDIT":return Promise.resolve({handler:()=>Wm.Z.openMessage(i),visible:Boolean(n)&&Pl.Z.isFolderAnEditMailFolder(),...t(i,e,{})});case"CONTEXT_MARK_AS_SPAM":return Promise.resolve({handler:()=>Wm.Z.markAsJunk(i),visible:Boolean(n)&&s&&!1===l(n),...t(i,e,{})});case"CONTEXT_NOT_SPAM":return Promise.resolve({handler:()=>Wm.Z.markAsNotJunk(i),visible:Boolean(n)&&s&&!0===l(n),...t(i,e,{})});case"CONTEXT_MOVE_TO_ARCHIVE":return Promise.resolve({handler:()=>Wm.Z.moveToArchive(i),visible:Boolean(n)&&o&&!1===r(n),...t(i,e,{})});case"CONTEXT_RESTORE_FROM_ARCHIVE":return Promise.resolve({handler:()=>Wm.Z.restoreFromArchive(i),visible:Boolean(n)&&o&&!0===r(n),...t(i,e,{})});case"CONTEXT_CONTAINER_TRASH":const g=(e=>{const t=Pl.Z.getSelectedFolder(),n=t&&$g.C.getByFolder(t.accountId,t.path);if(Boolean(e)&&n){const t=ba.Z.getFolderType(n.accountId,n.path)===ue.Nz;return Gm.Z.isMessageDeleted(e.sources,n,t)}})(n);return Promise.resolve({items:null!=g&&qm.isEnabled("MailMsgTrash")?sv(i,g,ue.AF.list):[],visible:Boolean(n)&&void 0!==g,...t(i,e,{})});case"CONTEXT_RECEIVER":return Promise.resolve({handler:()=>Wm.Z.enableCorrespondentView(i),visible:Boolean(n)&&u(),...t(i,e,{})});case"CONTEXT_SENDER":return Promise.resolve({visible:Boolean(n)&&!u(),...t(i,e,{})});case"COMMAND_MAIL_ENABLE_SENDER_VIEW":{const s=c(n);return Promise.resolve({visible:Boolean(n)&&1===this.getNumSelected()&&s.length>0,...t(i,e,{})})}case"CONTEXT_SENDER_IS_MAILING_LIST":{const s=c(n);return Promise.resolve({handler:this._toggleSenderAsMailingList,checked:$g.C.isSenderMailingList(s),visible:Boolean(n)&&1===this.getNumSelected()&&s.length>0,...t(i,e,{})})}case"COMMAND_MAIL_ENABLE_THREADED_VIEW":return Promise.resolve({visible:Boolean(n)&&1===this.getNumSelected(),...t(i,e,{})});case"COMMAND_MAIL_MARK_THREAD_READ":return Promise.resolve({visible:Boolean(n)&&d(n)&&!a(n),...t(i,e,{})});case"COMMAND_MAIL_MARK_THREAD_UNREAD":return Promise.resolve({visible:Boolean(n)&&d(n)&&a(n),...t(i,e,{})});default:return Promise.resolve({...t(i,e,{})})}};getMenuVisibility=(e,t)=>{switch(e.action){case"CONTEXT_EXPAND_ALL":case"CONTEXT_COLLAPSE_ALL":return"threads"===this.state.sorting.sortField;default:return!1}};handleExpandClick=()=>{this.refTree.current&&this.refTree.current.toggleSelectedExpansion()};onItemDoubleClick=e=>{Wm.Z.openMessage(this.context.vivaldiWindowId)};onItemMouseDown=(e,t)=>{1===t.button&&(t.preventDefault(),t.stopPropagation())};onItemMouseUp=(e,t)=>{1===t.button&&(t.preventDefault(),t.stopPropagation())};getRowComponentProps=e=>{const t=e.node,n=Pl.Z.getSelectedFolder();let i;if(n){const{accountId:e,path:t}=n;i=$g.C.getByFolder(e,t)}else console.warn("No folder selected");return{...t,direction:"horizontal"===this.props.position||"vertical_wide"===this.props.position?"horizontal":"vertical",handleExpandClick:this.handleExpandClick,selectedFilter:i,columns:this.props.columns}};getHeight=({index:e})=>"vertical"===this.props.position?"threads"!==!this.state.sorting.sortField&&this.refTree.current&&this.refTree.current.state.renderedArray[e].isChild?24:48:24;onSelect=e=>{this.selectedEntry=e,this.props.onSelect(e)};onEmptyTrash=()=>{console.error("not implemented")};openMessage=e=>{Wm.Z.openMessage(e.windowId)};onFocus=()=>{wd.Z.bind("enter",this.openMessage)};_unbind=()=>{wd.Z.unbind("enter",this.openMessage)};onBlur=()=>{this._unbind()};onKeyDown=e=>{const t=!!e.ctrlKey;switch(e.key){case"z":!t||e.shiftKey||e.altKey||(j.Z.undo(),e.preventDefault(),e.stopPropagation());break;case" ":e.preventDefault(),e.repeat||this._scrollOrMarkAndGotoNext(e)}};menu={name:"mailsearchlist",getCapability:this.getMenuCapability,getVisibility:this.getMenuVisibility};render(){const e=Pl.Z.getSelectedFolder(),t="threads"===M.Z.get(D.kMailSearchSortField)?nE.Z.getThreadsAsTree(this.state.list.slice(),"ascending"===M.Z.get(D.kMailSearchSortOrder)):this.state.list;let n,i=!1;e&&(n="MAIL_SEARCH_"+e.accountId+e.path,tE.Z.isSubscribable(e)&&(i=!e.subscribed));const s="vertical"===M.Z.get(D.kMailViewLayout)?this.getHeight:24;return dE("div",{className:"list-wrapper",onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:this.onKeyDown},void 0,!i&&this.state.isLoading&&dE("span",{className:"mail-loading"},void 0,(0,le.Z)("Loading selected view...")),!i&&!this.state.isLoading&&this.state.list.length>0&&(0,fn.jsx)(Yu,{ref:this.refTree,rowComponent:eE,getRowComponentProps:this.getRowComponentProps,nodes:t,onSelect:this.onSelect,onItemDoubleClick:this.onItemDoubleClick,onItemMouseDown:this.onItemMouseDown,onItemMouseUp:this.onItemMouseUp,delete:this.delete,disableSelectAfterDelete:!0,isFolder:this.isFolder,menu:this.menu,hasChildren:this.hasChildren,settings:n,rootId:0,isValidAddTarget:this.isValidAddTarget,isValidForClipboard:this.isValidForClipboard,rowHeight:s,folderMode:"expand",selectionStoreKey:Q.uP,columns:this.props.columns,autoFocus:!0,sorting:this.state.sorting}),!i&&!this.state.isLoading&&0===this.state.list.length&&dE("span",{className:"mail-loading"},void 0,(0,le.Z)("No messages in selected view")),e&&i&&dE("div",{className:"mail-folder-subscribe"},void 0,dE("h2",{},void 0,(0,le.Z)("Subscribe to Folder")),dE("p",{},void 0,(0,le.Z)("You are currently not subscribed to the folder $2 of $1.",[e.accountId,e.path])),dE("input",{type:"button",className:"primary",value:(0,le.Z)("Subscribe"),onClick:()=>j.Z.subscribeMailbox(this.context.vivaldiWindowId,e)})))}}const hE=cE;var pE;function uE(e,t,n,i){pE||(pE="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:pE,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const gE=[D.kKeyboardTabToAll];class mE extends tn.Component{static contextType=dn.Z;_isMounted=!1;refAllButton=tn.createRef();constructor(e){super(e);const t=Pl.Z.getOptions();this.state={allMessages:Boolean(!!Pl.Z.getOptions()&&Pl.Z.getOptions().allMessages),numFound:$g.C.getListEntries().length,queryFound:$g.C.getQueryNumFound(),recipientTypes:t.forSender?this.getRecipientTypes(t.query||"",t.forSender):new Set,forSender:t.forSender}}componentDidMount(){Pl.Z.addListener(this.updateSearchOptions),$g.C.addListener(this.updateResults),this._isMounted=!0}componentWillUnmount(){this._isMounted=!1,Pl.Z.removeListener(this.updateSearchOptions),$g.C.removeListener(this.updateResults)}shouldSearchAllMessages=e=>{const t={...Pl.Z.getOptions(),allMessages:e};j.Z.setSearchOptions(t),j.Z.updateQueryResults(this.context.vivaldiWindowId,Pl.Z.getQuery())};changeRecipientTypes=(e,t)=>{const{checked:n}=e.target;n?this.addRecipientTypes(t):this.removeRecipientTypes(t)};doSearch=e=>{j.Z.changeQuery(e),j.Z.updateQueryResults(this.context.vivaldiWindowId,e)};addRecipientTypes=e=>{this.setState((t=>{const n=t.forSender;if(n){const i=t.recipientTypes||new Set,s=ot.Z.getContactQuery(n,i);i.add(e);const o=ot.Z.getContactQuery(n,i),a=Pl.Z.getQuery(),r=o+a.substring(a.indexOf(s)+s.length);return this.doSearch(r),{recipientTypes:i}}}))};removeRecipientTypes=e=>{this.setState((t=>{const{recipientTypes:n,forSender:i}=t;if(n&&i){const t=ot.Z.getContactQuery(i,n);n.delete(e);const s=ot.Z.getContactQuery(i,n),o=Pl.Z.getQuery(),a=s+o.substring(o.indexOf(t)+t.length);return this.doSearch(a),{recipientTypes:n}}}))};updateSearchOptions=()=>{if(this._isMounted){const e=Pl.Z.getOptions(),t=Boolean(e&&e.allMessages);this.setState({allMessages:t,forSender:e.forSender,recipientTypes:e.forSender?this.getRecipientTypes(e.query||"",e.forSender):new Set})}};getRecipientTypes(e,t){const n=new Set;if(e.startsWith("(")){const i=e.match(/\((.*)\)/);i&&i.length>1&&(i[1].includes(ot.Z.getEqualsAddressQuery(t,"from"))&&n.add("from"),i[1].includes(ot.Z.getEqualsAddressQuery(t,"to"))&&n.add("to"),i[1].includes(ot.Z.getEqualsAddressQuery(t,"cc"))&&n.add("cc"))}return n}updateResults=()=>{this._isMounted&&this.setState({numFound:$g.C.getListEntries().length,queryFound:$g.C.getQueryNumFound()})};removeFilter=()=>{const e=$g.C.getByFolder(this.props.currentAccountId,this.props.currentPath);e&&j.Z.removeFilter(e.id)};render(){const e=this.state.allMessages,t=$g.C.getByFolder(this.props.currentAccountId,this.props.currentPath);let n=(0,le.Z)("Selected");const i=this.props.currentAccountId===ue.Kz;if(t){const{selectedAccountId:e,selectedName:s}=t;e&&s?n=e===s?(0,le.Z)(e):(0,le.Z)(e)+"/"+(0,le.Z)(s):i||(n=(0,le.Z)(this.props.currentAccountId)+"/"+(0,le.Z)(this.props.currentName))}const s=t&&!t.filterValue.showSubFolders;return uE("div",{className:"toolbar toolbar-default mail-search MailSearchOptions"},void 0,!this.state.forSender&&this.props.currentAccountId!==ue.tQ&&(0,fn.jsxs)(fn.Fragment,{children:[uE("span",{},void 0,(0,le.Z)("Search in")),uE("div",{className:"toolbar toolbar-group"},void 0,uE(sl,{isPressed:!e,onClick:this.shouldSearchAllMessages.bind(null,!1),title:n}),(0,fn.jsx)(sl,{ref:this.refAllButton,isPressed:e,onClick:this.shouldSearchAllMessages.bind(null,!0),title:(0,le.Z)("mail","All")}))]}),this.props.currentAccountId===ue.tQ&&(0,fn.jsx)(fn.Fragment,{children:uE("h2",{className:"MailSearchOptions-Title"},void 0,(0,le.Z)("Displaying a single thread"))}),this.state.forSender&&uE("h2",{className:"MailSearchOptions-Title"},void 0,(0,le.Z)("Displaying mails for $1",[this.state.forSender])),uE("span",{title:e?(0,le.Z)("Found in all folders: $1",[this.state.queryFound]):(0,le.Z)("Found in all folders: $1. Found in current folder: $2",[this.state.queryFound,this.state.numFound])},void 0,(0,le.Z)("Found: $1",[this.state.numFound])),this.state.forSender&&uE("div",{className:"MailSearchOptions-RecipientTypes"},void 0,uE("label",{className:"MailSearchOptions-RecipientType"},void 0,(0,le.Z)("from"),uE("input",{type:"checkbox",checked:this.state.recipientTypes.has("from"),onChange:e=>this.changeRecipientTypes(e,"from")})),uE("label",{className:"MailSearchOptions-RecipientType"},void 0,(0,le.Z)("to"),uE("input",{type:"checkbox",checked:this.state.recipientTypes.has("to"),onChange:e=>this.changeRecipientTypes(e,"to")})),uE("label",{className:"MailSearchOptions-RecipientType"},void 0,(0,le.Z)("cc"),uE("input",{type:"checkbox",checked:this.state.recipientTypes.has("cc"),onChange:e=>this.changeRecipientTypes(e,"cc")}))),i&&uE(sl,{onClick:this.removeFilter,title:(0,le.Z)("mail_filter","Delete"),tooltip:(0,le.Z)("mail_filter","Delete Filter")}),!i&&s&&uE(sl,{onClick:this.props.saveSearch,title:(0,le.Z)("Save"),tooltip:(0,le.Z)("Save search as Filter")}))}}const vE=(0,fs.Z)(mE,gE);var fE;function yE(e,t,n,i){fE||(fE="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:fE,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const wE=[D.kKeyboardTabToAll,D.kMailSearchSortField,D.kMailSearchSortOrder,D.kMailViewLayout];var bE=yE(BZ,{});class CE extends tn.Component{nodeRef=tn.createRef();constructor(e){super(e),this.state={columns:vu()["vertical_wide"===this.props.prefValues[D.kMailViewLayout]?"mail_vertical":"mail_horizontal"]||fu(this.getMailSortFields(e.prefValues[D.kMailViewLayout])),slideBarStyle:$g.C.hasNoListEntries()?{backgroundColor:"unset"}:{}}}componentDidUpdate(e){const t=this.props.prefValues[D.kMailViewLayout];t!==e.prefValues[D.kMailViewLayout]&&this.setState({columns:vu()["vertical_wide"===t?"mail_vertical":"mail_horizontal"]||fu(this.getMailSortFields(t))}),this.props.hasNoListEntries!==e.hasNoListEntries&&this.setSlideBarStyle()}setSlideBarStyle=()=>{$g.C.hasNoListEntries()?this.setState({slideBarStyle:{backgroundColor:"unset"}}):this.setState({slideBarStyle:{}})};getMailSortFields=e=>{const t=this.props.selectedFolder&&[ue.Nz,ue.kY,ue.fZ].includes(ba.Z.getFolderType(this.props.selectedFolder.accountId,this.props.selectedFolder.path));return[{value:"unread",text:(0,le.Z)("Unread"),icon:cn.XQw.small,fullScreenTitle:(0,le.Z)("Unread"),width:36,visible:"vertical"!==e,isSortField:!1},{value:"flag",text:(0,le.Z)("Flag"),icon:cn.nyn.small,fullScreenTitle:(0,le.Z)("Flag"),width:36,visible:"vertical"!==e,isSortField:!1},{value:"sender",text:t?(0,le.Z)("Recipient"):(0,le.Z)("Sender"),icon:cn.HXY,fullScreenTitle:t?(0,le.Z)("Sort by Message Recipient"):(0,le.Z)("Sort by Message Sender"),width:150,visible:"vertical"!==e},{value:"subject",text:(0,le.Z)("Subject"),fullScreenTitle:(0,le.Z)("Sort by Subject"),width:300,visible:"vertical"!==e,key:!0},{value:"label",text:(0,le.Z)("Labels"),icon:cn.rpm.small,fullScreenTitle:(0,le.Z)("Labels"),width:"vertical_wide"===e?36:140,visible:"vertical"!==e,isSortField:!1},{value:"attachment",text:(0,le.Z)("Attachment"),icon:cn.onv,fullScreenTitle:(0,le.Z)("Attachment"),width:36,visible:"vertical"!==e,isSortField:!1},{value:"size",text:(0,le.Z)("Size"),icon:cn.W9U,fullScreenTitle:(0,le.Z)("Size"),width:100,visible:"horizontal"===e,isSortField:!1},{value:"sentDate",text:(0,le.Z)("Date"),icon:cn.V_c,fullScreenTitle:t?(0,le.Z)("Sort by Date Sent"):(0,le.Z)("Sort by Date Received"),width:150,visible:"vertical"!==e}]};onSortChange=(e,t)=>{const n=this.props.prefValues[D.kMailSearchSortOrder],i=this.props.prefValues[D.kMailSearchSortField];("ascending"===n&&e!==ns.Z.ASCENDING_SORT||"descending"===n&&e!==ns.Z.DESCENDING_SORT)&&nt.Z.set(D.kMailSearchSortOrder,this.getMailSortOrder(e)),i!==t&&nt.Z.set(D.kMailSearchSortField,t)};saveSearch=e=>{const t=$g.C.getByFolder(this.props.selectedFolder.accountId,this.props.selectedFolder.path)||{},n=Pl.Z.getQuery(),i={...t.filterValue,query:n},s={name:n,accountId:ue.Kz,path:Math.random().toString(36).substring(2),filterValue:{...i},selectedAccountId:this.props.selectedFolder.accountId,selectedName:t.name};j.Z.addFilter(s)};onUpdateRow=e=>{this.setState({columns:e})};onSaveRow=()=>{mu(this.state.columns,"vertical_wide"===this.props.prefValues[D.kMailViewLayout]?"mail_vertical":"mail_horizontal")};getSortOrder(){return"ascending"===this.props.prefValues[D.kMailSearchSortOrder]?ns.Z.ASCENDING_SORT:ns.Z.DESCENDING_SORT}getMailSortOrder(e){switch(e){case ns.Z.ASCENDING_SORT:return"ascending";case ns.Z.DESCENDING_SORT:return"descending";default:throw new Error("Non existent mail sort order "+e)}}render(){const e=this.getMailSortFields(this.props.prefValues[D.kMailViewLayout]),t=this.getSortOrder(),n=this.props.selectedFolder,i=Pl.Z.getOptions(),s="horizontal"===this.props.position?"top":"left";return(0,fn.jsxs)("div",{ref:this.nodeRef,id:"mail_search",style:this.props.style,children:[(this.props.queryString||n?.accountId===ue.Kz||n?.accountId===ue.tQ||i.forSender)&&yE(vE,{saveSearch:this.saveSearch,currentPath:this.props.selectedFolder.path,currentName:this.props.selectedFolder.name,currentAccountId:this.props.selectedFolder.accountId}),bE,yE(Iu,{fields:e,columns:this.state.columns,onSortChange:this.onSortChange,sortField:this.props.prefValues[D.kMailSearchSortField],sortOrder:t,manualSorting:!1,keyAccess:this.props.prefValues[D.kKeyboardTabToAll],fullsize:"horizontal"===this.props.prefValues[D.kMailViewLayout]||"vertical_wide"===this.props.prefValues[D.kMailViewLayout],onUpdateRow:this.onUpdateRow,onSaveRow:this.onSaveRow,style:this.state.slideBarStyle},this.state.columns.flatMap((e=>e.id)).join()||"sortfield"),yE(hE,{position:this.props.position,onSelect:this.props.onSelect,columns:this.state.columns}),yE(gu,{onSlidebarPosition:this.props.onSlidebarPosition,position:s})]})}}const SE=(0,fs.Z)(CE,wE);var TE,IE=n(34155);function kE(e,t,n,i){TE||(TE="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:TE,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const AE=[D.kMailViewLayout,D.kMailViewDimensions];class ZE extends tn.PureComponent{static contextType=dn.Z;mailSearchRef=tn.createRef();state={listEntry:void 0,hasNoListEntries:$g.C.hasNoListEntries(),queryString:Pl.Z.getQuery()};onSlidebarPosition=(e,t)=>{const n=this.mailSearchRef.current?.nodeRef.current;if(!(n instanceof this.context.Element))return;var i=n.getBoundingClientRect(),s=t-i.top,o=e-i.left;const a={...this.props.prefValues[D.kMailViewDimensions]};"horizontal"===this.props.prefValues[D.kMailViewLayout]?(s>2e3?s=2e3:s<120&&(s=120),a.height=Math.floor(s)):(o>2e3?o=2e3:o<200&&(o=200),"vertical_wide"===this.props.prefValues[D.kMailViewLayout]?a.widthWide=Math.floor(o):a.width=Math.floor(o)),nt.Z.set(D.kMailViewDimensions,a)};componentDidMount(){Pl.Z.addListener(this._folderChanged),$g.C.addListener(this._onFiltersChanged)}componentWillUnmount(){Pl.Z.removeListener(this._folderChanged),$g.C.removeListener(this._onFiltersChanged)}_onFiltersChanged=()=>{if(this.state.hasNoListEntries!==$g.C.hasNoListEntries()&&this.setState({hasNoListEntries:$g.C.hasNoListEntries()}),Pl.Z.getSelectedFolder()){const e=Pl.Z.getQuery();this.setState({queryString:e})}};_folderChanged=()=>{const e=Pl.Z.getSelectedFolder();if(!e)return;const t=(0,le.Z)(e.name),n=(0,le.Z)(e.accountId);let i="Labels"===n?(0,rZ.X)(t):t;t!==n&&(i+=" ("+n+")"),IE.nextTick((()=>Y.Z.setTitle(this.props.id,this.context.vivaldiWindowId,i)))};handleSelection=(0,Zr.Z)((e=>{this.setState({listEntry:e})}),200,{leading:!0,trailing:!0});render(){const e="vertical_wide"===this.props.prefValues[D.kMailViewLayout],t="horizontal"===this.props.prefValues[D.kMailViewLayout]?{height:this.props.prefValues[D.kMailViewDimensions].height}:{width:this.props.prefValues[D.kMailViewDimensions][e?"widthWide":"width"]};return kE("div",{id:"mail_view",className:this.props.prefValues[D.kMailViewLayout]},void 0,(0,fn.jsx)(SE,{ref:this.mailSearchRef,selectedFolder:Pl.Z.getSelectedFolder(),queryString:this.state.queryString,onSlidebarPosition:this.onSlidebarPosition,position:this.props.prefValues[D.kMailViewLayout],style:t,hasNoListEntries:this.state.hasNoListEntries,onSelect:this.handleSelection}),kE(_Z,{listEntry:this.state.listEntry,prefValues:this.props.prefValues,hasNoListEntries:this.state.hasNoListEntries,pageIsActive:this.props.isActive}))}}const EE=(0,fs.Z)(ZE,AE);var _E;function NE(e,t,n,i){_E||(_E="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:_E,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const ME=[D.kIncognitoShowIntro],PE=nt.Z.getEventHandler,DE="https://vvld.in/privacy-and-security";var xE=NE("svg",{className:"private-window-background",viewBox:"0 0 1244 860"},void 0,NE("defs",{},void 0,NE("linearGradient",{x1:"0.15",y1:"0.3",x2:"0.3",y2:"0.5",id:"private-intro-bg-gradient"},void 0,NE("stop",{offset:"0",stopColor:"var(--colorFg)",stopOpacity:"0.03"}),NE("stop",{offset:"1",stopColor:"var(--colorFg)",stopOpacity:"0.003"})),NE("linearGradient",{x1:"1",y1:"0",x2:"0",y2:"1",id:"private-intro-accent-gradient"},void 0,NE("stop",{offset:"0",stopColor:"var(--colorAccentBg)",stopOpacity:"0"}),NE("stop",{offset:"0.5",stopColor:"var(--colorAccentBg)",stopOpacity:"1"}),NE("stop",{offset:"1",stopColor:"var(--colorAccentBg)",stopOpacity:"0"}))),NE("path",{fill:"url(#private-intro-bg-gradient)",d:"M0 0h153.513c16.141 27.93 32.15 55.734 47.912 83.11 16.086 27.94 32.722 56.832 49.076 85.128 11.01 19.031 22.079 38.316 32.781 56.967 25.186 43.883 51.228 89.259 77.402 132.848 33.382 55.651 75.894 82.121 137.77 85.829 3.205.192 6.454.288 9.655.288 39.673 0 78.14-14.461 108.316-40.722 21.644-18.834 48.687-52.291 54.604-104.667.749-6.654 1.357-13.708 1.855-19.573-1.07-29.74-6.476-52.92-17.294-74.518C622.935 139.46 612.708 67.99 625.087 0h136.676C747.1 44.93 749.845 96.364 774.32 145.251c20.839 41.6 30.654 85.7 31.485 138.023-.568 6.192-1.472 18.273-2.83 30.356-17.572 155.524-149.172 263.318-294.866 263.318-5.816 0-11.67-.173-17.526-.521C382.84 569.97 301.9 518.174 246.822 426.358c-38.015-63.313-74.255-127.68-111.253-191.634C90.359 156.507 45.49 78.062 0 0zm1113.47 0H1244v140.1c-7.496 27.86-18.849 54.995-34.031 81.275a1299530.57 1299530.57 0 0 1-170.255 294.799A1223193.145 1223193.145 0 0 0 841.018 860.24H687.72c135.675-235.123 271.527-470.147 407.26-705.25 22.311-38.621 31.22-79.696 25.368-124.548A170.12 170.12 0 0 0 1113.471 0z"}),NE("path",{stroke:"url(#private-intro-accent-gradient)",strokeWidth:"2",d:"M854 839.979L1103.98 407"}),NE("path",{stroke:"url(#private-intro-accent-gradient)",d:"M951 649.979L1200.98 217"}),NE("path",{stroke:"url(#private-intro-accent-gradient)",d:"M969 628.452L1126.86 356"}),NE("path",{stroke:"url(#private-intro-accent-gradient)",d:"M802 686.452L959.86 414"}),NE("path",{stroke:"url(#private-intro-accent-gradient)",opacity:".5",d:"M735 790.452L892.86 518"}));class OE extends tn.Component{static contextType=dn.Z;state={searchEngines:Nn.Z.get()};componentDidMount(){Nn.Z.addListener(this.#C)}componentWillUnmount(){Nn.Z.removeListener(this.#C)}#C=()=>{this.setState({searchEngines:Nn.Z.get()})};#S=e=>{e.preventDefault(),Y.Z.openURL(this.context.vivaldiWindowId,DE,{inCurrent:!1,inBackground:!1})};#T=e=>{d.Z.searchEngines.setDefault("defaultPrivate",e.currentTarget.value)};render(){const e=Nn.Z.getDefault(!0);return NE("div",{className:"private-intro"},void 0,xE,NE("div",{className:"private-intro-content"},void 0,NE("h1",{},void 0,(0,le.Z)("title","Private Window")),NE("span",{className:"private-intro-ghost",dangerouslySetInnerHTML:{__html:n(51491)}}),NE("p",{},void 0,(0,le.Z)("Browsing in a Private Window means that searches, sites visited, cookies, and temporary files won’t be stored by Vivaldi. It does not encrypt or otherwise modify your connection.")),NE("p",{},void 0,NE("a",{tabIndex:0,href:DE,onClick:this.#S},void 0,(0,le.Z)("Learn more about Privacy & Security"))),NE("h2",{},void 0,(0,le.Z)("Default Search")),NE("p",{className:"private-intro-blurb"},void 0,NE("span",{},void 0,(0,le.Z)("While in a Private Window, Vivaldi will use $1 to answer your searches.",[e?.name])),NE("span",{},void 0,"DuckDuckGo"===e?.name&&" "+(0,le.Z)("DuckDuckGo is a search engine that does not track your search history, enabling you to search privately."))),NE("h3",{},void 0,(0,le.Z)("Search with")),NE("label",{className:"private-intro-select-searchengine"},void 0,e&&NE(Oi,{className:"private-intro-favicon",url:e.faviconUrl,loadType:"faviconFromCache"}),NE("select",{value:e?.id,onChange:this.#T},void 0,this.state.searchEngines.map((e=>NE("option",{value:e.id},e.id,e.name))))),NE("label",{className:"private-intro-disable"},void 0,NE("input",{type:"checkbox",checked:!this.props.prefValues[D.kIncognitoShowIntro],onChange:PE(D.kIncognitoShowIntro,"inverse")}),NE("span",{},void 0,(0,le.Z)("Do Not Show Introduction Again")))))}}const LE=(0,fs.Z)(OE,ME);var RE;function BE(e,t,n,i){RE||(RE="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:RE,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function FE(){return BE("webview",{src:`${Q.oP}/saga/saga.html`})}const UE={SpeedDial:"startpage",Bookmarks:"bookmarks",History:"history",Calendar:"calendar",NotesManager:"notes"};var VE,WE=n(66777);function HE(e,t,n,i){VE||(VE="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:VE,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const zE=nt.Z.getEventHandler;class GE extends tn.Component{render(){const e=this.props.prefValues;return HE(WE.j,{filter:this.props.filter,heading:(0,le.Z)("Address Field Drop-Down Menu")},void 0,HE(WE.C,{text:(0,le.Z)("Show Drop-Down when Typing")},void 0,HE("input",{type:"checkbox",checked:e[D.kAddressBarOmniboxEnabled],onChange:zE(D.kAddressBarOmniboxEnabled)})),HE(WE.C,{text:(0,le.Z)("Include Bookmarks"),className:"pad-left"},void 0,HE("input",{type:"checkbox",disabled:!e[D.kAddressBarOmniboxEnabled],checked:e[D.kAddressBarOmniboxShowBookmarks],onChange:zE(D.kAddressBarOmniboxShowBookmarks)})),HE(WE.C,{text:(0,le.Z)("Include Typed History"),className:"pad-left"},void 0,HE("input",{type:"checkbox",disabled:!e[D.kAddressBarOmniboxEnabled],checked:e[D.kAddressBarOmniboxShowTypedHistory],onChange:zE(D.kAddressBarOmniboxShowTypedHistory)})),HE(WE.C,{text:(0,le.Z)("Include Frequently Visited Pages"),className:"pad-left"},void 0,HE("input",{type:"checkbox",disabled:!e[D.kAddressBarOmniboxEnabled],checked:e[D.kAddressBarOmniboxShowTopSites],onChange:zE(D.kAddressBarOmniboxShowTopSites)})),HE(WE.C,{text:(0,le.Z)("Include Browser History"),className:"pad-left"},void 0,HE("input",{type:"checkbox",disabled:!e[D.kAddressBarOmniboxEnabled],checked:e[D.kAddressBarOmniboxShowBrowserHistory],onChange:zE(D.kAddressBarOmniboxShowBrowserHistory)})),HE(WE.C,{text:(0,le.Z)("Show Search Queries History"),className:"pad-left"},void 0,HE("input",{type:"checkbox",disabled:!e[D.kAddressBarOmniboxEnabled],checked:e[D.kAddressBarOmniboxShowSearchHistory],onChange:zE(D.kAddressBarOmniboxShowSearchHistory)})))}}const $E=GE;var KE,jE=n(60203);function YE(e,t,n,i){KE||(KE="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:KE,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const XE=nt.Z.getEventHandler;var QE=YE("input",{type:"radio",value:"alt"}),qE=YE("div",{className:"setting-single"},void 0,YE("label",{},void 0,YE("input",{type:"radio",value:"shift"}),YE("span",{},void 0,"Shift + Enter")));class JE extends tn.Component{render(){return YE(jE.Z,{filter:this.props.filter},void 0,YE("div",{className:"setting-group"},void 0,YE("h3",{},void 0,(0,le.Z)("Open Address in New Tab")),YE(ws,{name:"urlfieldShortcut",className:"setting-single",value:this.props.value,onChange:XE(D.kAddressBarUrlOpenShortcut)},void 0,YE("div",{className:"setting-single"},void 0,YE("label",{},void 0,QE,YE("span",{},void 0,"Alt + Enter"))),qE)))}}const e_=JE;var t_;function n_(e,t,n,i){t_||(t_="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:t_,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const i_="https://vivaldi.com/privacy/";function s_(e){return"string"!=typeof e.type}class o_ extends tn.Component{static contextType=dn.Z;static defaultProps={displayPrivacyLink:!1};constructor(e){super(e),this.state={children:this.searchChildren(this.props)}}hiddenWhenFilter="";hiddenChildComponents={};componentDidMount(){this.hideCategoryIfEmpty()}componentDidUpdate(e){this.props.filter!==e.filter?this.hiddenWhenFilter?this.shouldSearchHiddenComponent(this.hiddenWhenFilter,this.props.filter)&&this.setState({children:this.searchChildren(this.props)}):this.setState({children:this.searchChildren(this.props)}):this.props.children!==e.children&&this.setState({children:this.searchChildren(this.props)}),this.hideCategoryIfEmpty()}unfilteredChildren=e=>tn.Children.map(e.children,(e=>e&&s_(e)?tn.cloneElement(e,{filter:""}):e));filteredChildren=e=>tn.Children.map(e.children,((t,n)=>!t||s_(t)?t:(0,js.ZP)(t,e.filter)));searchChildren=e=>{if(!e.filter)return tn.Children.map(e.children,(e=>e));return e.categoryTitle.toLowerCase().includes(e.filter.toLowerCase())?this.unfilteredChildren(e):this.filteredChildren(e)};shouldSearchHiddenComponent=(e,t)=>!t||e.length>=t.length||e!==t.slice(0,e.length);hideCategoryIfEmpty=()=>{this.root&&(1===this.root.children.length||!0===this.props.displayPrivacyLink&&2===this.root.children.length?(this.root.style.display="none",this.hiddenWhenFilter=this.props.filter):(this.root.style.removeProperty("display"),this.hiddenWhenFilter=""))};openPrivacyPage=()=>{Y.Z.openURL(this.context.vivaldiWindowId,i_)};render(){const e=this.props.categoryTitle&&n_("h2",{},void 0,this.props.categoryTitle),t=(0,js.ZP)(e,this.props.filter)||e,n=(0,Ji.Z)(this.props,["filter","categoryTitle","displayPrivacyLink"]);return(0,fn.jsxs)("div",{ref:e=>e?this.root=e:null,...n,children:[t,e&&!0===this.props.displayPrivacyLink&&n_("div",{className:"privacy-link"},void 0,n_(Uw,{title:i_,onClick:this.openPrivacyPage},void 0,(0,le.Z)("Learn more about Privacy in Vivaldi"))),this.state.children]})}}const a_=o_;var r_;function l_(e,t,n,i){r_||(r_="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:r_,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const d_=[D.kAddressBarAutocompleteSuffixExpansionEnabled,D.kAddressBarAutocompleteSuffixExpansionValue,D.kAddressBarAutocompleteEnabled,D.kAddressBarAutocompletePreferBookmarks,D.kAddressBarExtensionsShowAllToggle,D.kAddressBarExtensionsRenderInDropdown,D.kAddressBarOmniboxCutcopyEncoded,D.kAddressBarOmniboxEnabled,D.kAddressBarOmniboxShowBookmarks,D.kAddressBarOmniboxShowTopSites,D.kAddressBarOmniboxShowTypedHistory,D.kAddressBarOmniboxShowBrowserHistory,D.kAddressBarOmniboxShowSearchHistory,D.kAddressBarPosition,D.kAddressBarSelectOnClick,D.kAddressBarShowFullUrl,D.kAddressBarShowProgress,D.kAddressBarShowQrGenerator,D.kAddressBarStripJavascriptOnPaste,D.kAddressBarUrlOpenShortcut,D.kAddressBarVisible,D.kAddressBarHighlightBaseDomain],c_=nt.Z.getEventHandler;var h_=l_("input",{type:"radio",value:"top"}),p_=l_("input",{type:"radio",value:"bottom"}),u_=l_("input",{type:"radio",value:"false"}),g_=l_("input",{type:"radio",value:"true"});class m_ extends tn.Component{renderShowAddressBar(){return l_(WE.j,{filter:this.props.filter,className:"unlimited"},void 0,l_(WE.C,{text:(0,le.Z)("Show Address Bar")},void 0,l_("input",{type:"checkbox",checked:this.props.prefValues[D.kAddressBarVisible],onChange:c_(D.kAddressBarVisible)})))}renderAddressBarPosition(){return l_(WE.j,{filter:this.props.filter,heading:(0,le.Z)("Address Bar Position")},void 0,l_(ws,{name:"addressbar-position",value:this.props.prefValues[D.kAddressBarPosition],onChange:c_(D.kAddressBarPosition),className:"group"},void 0,l_(WE.C,{text:(0,le.Z)("Top")},void 0,h_),l_(WE.C,{text:(0,le.Z)("Bottom")},void 0,p_)))}renderAddressBarOptions(){return l_(WE.j,{filter:this.props.filter,heading:(0,le.Z)("Address Field Options")},void 0,l_(WE.C,{text:(0,le.Z)("Show Full Address")},void 0,l_("input",{type:"checkbox",checked:this.props.prefValues[D.kAddressBarShowFullUrl],onChange:c_(D.kAddressBarShowFullUrl)})),l_(WE.C,{text:(0,le.Z)("Select Address on Activation")},void 0,l_("input",{type:"checkbox",checked:this.props.prefValues[D.kAddressBarSelectOnClick],onChange:c_(D.kAddressBarSelectOnClick)})),l_(WE.C,{text:(0,le.Z)("Copy and Cut Encoded Address")},void 0,l_("input",{type:"checkbox",checked:this.props.prefValues[D.kAddressBarOmniboxCutcopyEncoded],onChange:c_(D.kAddressBarOmniboxCutcopyEncoded)})),l_(WE.C,{text:(0,le.Z)("Page Load Progress Bar")},void 0,l_("input",{type:"checkbox",checked:this.props.prefValues[D.kAddressBarShowProgress],onChange:c_(D.kAddressBarShowProgress)})),l_(WE.C,{text:(0,le.Z)("QR Code Generator")},void 0,l_("input",{type:"checkbox",checked:this.props.prefValues[D.kAddressBarShowQrGenerator],onChange:c_(D.kAddressBarShowQrGenerator)})))}renderAddressBarAutoComplete(){return l_(WE.j,{filter:this.props.filter,heading:(0,le.Z)("Address Auto-Complete")},void 0,l_(WE.C,{text:(0,le.Z)("radio","Enabled")},void 0,l_("input",{type:"checkbox",checked:this.props.prefValues[D.kAddressBarAutocompleteEnabled],onChange:c_(D.kAddressBarAutocompleteEnabled)})),l_(WE.C,{className:"pad-left",text:(0,le.Z)("Always Prefer Bookmarks")},void 0,l_("input",{type:"checkbox",checked:this.props.prefValues[D.kAddressBarAutocompletePreferBookmarks],disabled:!this.props.prefValues[D.kAddressBarAutocompleteEnabled],onChange:c_(D.kAddressBarAutocompletePreferBookmarks)})))}renderDomainExpansion(){return l_(WE.j,{filter:this.props.filter,heading:(0,le.Z)("Domain Expansion")},void 0,l_("p",{className:"info pad-top"},void 0,(0,le.Z)("Expand top level domains with Ctrl + Enter. This shortcut takes precedence over tab opening modifiers")),l_(WE.C,{text:(0,le.Z)("radio","Enabled")},void 0,l_("input",{type:"checkbox",checked:this.props.prefValues[D.kAddressBarAutocompleteSuffixExpansionEnabled],onChange:c_(D.kAddressBarAutocompleteSuffixExpansionEnabled)})),l_(WE.C,{className:"pad-left",text:(0,le.Z)("Suffix")},void 0,l_("input",{disabled:!this.props.prefValues[D.kAddressBarAutocompleteSuffixExpansionEnabled],type:"text",defaultValue:this.props.prefValues[D.kAddressBarAutocompleteSuffixExpansionValue],maxLength:"256",onChange:c_(D.kAddressBarAutocompleteSuffixExpansionValue)})))}renderExtensions(){return l_(WE.j,{filter:this.props.filter,heading:(0,le.Z)("Extension Visibility")},void 0,l_(ws,{name:"extension-toolbar-expansion",value:this.props.prefValues[D.kAddressBarExtensionsShowAllToggle],onChange:c_(D.kAddressBarExtensionsShowAllToggle,"convert"),className:"group"},void 0,l_(WE.C,{label:(0,le.Z)("Show and hide only hidden extensions"),text:(0,le.Z)("Toggle Only Hidden Extensions")},void 0,u_),l_(WE.C,{label:(0,le.Z)("Show and hide all extensions"),text:(0,le.Z)("Toggle All Extensions")},void 0,g_)),l_(WE.C,{label:(0,le.Z)("Enable the drop-down menu for hidden extensions"),text:(0,le.Z)("Expand Hidden Extensions to Drop-Down Menu")},void 0,l_("input",{type:"checkbox",checked:this.props.prefValues[D.kAddressBarExtensionsRenderInDropdown],onChange:c_(D.kAddressBarExtensionsRenderInDropdown)})))}renderProfileManagement(){return l_(WE.j,{filter:this.props.filter,heading:(0,le.Z)("Profile Management")},void 0,l_("input",{type:"button",onClick:ie.Z.managePeople,value:(0,le.Z)("Manage Profiles")}))}renderSecurityFeatures=()=>l_(WE.j,{filter:this.props.filter,heading:(0,le.Z)("Security Features")},void 0,l_(WE.C,{text:(0,le.Z)("Strip JavaScript From Pasted Text")},void 0,l_("input",{type:"checkbox",checked:this.props.prefValues[D.kAddressBarStripJavascriptOnPaste],onChange:c_(D.kAddressBarStripJavascriptOnPaste)})),l_(WE.C,{text:(0,le.Z)("Highlight Base Domain in Address")},void 0,l_("input",{type:"checkbox",checked:this.props.prefValues[D.kAddressBarHighlightBaseDomain],onChange:c_(D.kAddressBarHighlightBaseDomain)})));render(){return l_(a_,{categoryTitle:(0,le.Z)("title","Address Bar"),filter:this.props.filter},void 0,this.renderShowAddressBar(),this.renderAddressBarPosition(),this.renderAddressBarOptions(),l_(e_,{value:this.props.prefValues[D.kAddressBarUrlOpenShortcut],filter:this.props.filter}),this.renderAddressBarAutoComplete(),l_($E,{prefValues:this.props.prefValues,filter:this.props.filter}),this.renderDomainExpansion(),this.renderProfileManagement(),this.renderExtensions(),this.renderSecurityFeatures())}}const v_=(0,fs.Z)(m_,d_);var f_,y_=n(34155);function w_(e,t,n,i){f_||(f_="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:f_,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class b_ extends tn.PureComponent{state={zoom:$v.Z.getState().uiZoom};componentDidMount(){$v.Z.addListener(this._onZoomStoreChanged)}componentWillUnmount(){$v.Z.removeListener(this._onZoomStoreChanged)}_onZoomStoreChanged=()=>{this.setState({zoom:$v.Z.getState().uiZoom})};setZoomLevel=(e,t)=>{t?this.setState({zoom:e}):Uv.Z.setUIZoom(e),y_.nextTick((()=>{this.props.onUIZoomUpdate()}))};render(){const{zoom:e}=this.state;return w_(zv,{inFooter:!1,zoom:e,defaultZoomLevel:Kv.an,scrolling:!1,maxLevel:Kv.OK,minLevel:Kv.bI,step:Kv.Wp,delay:!0,onZoomUpdated:this.setZoomLevel},"zoomslider")}}const C_=b_;var S_;function T_(e,t,n,i){S_||(S_="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:S_,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const I_=[D.kAppearanceCssUiModsDirectory,D.kAppearanceHudEnabled,D.kAppearanceRangeButtons,D.kPopupsShowInTab,D.kSettingsInTab,D.kStatusBarDisplay,D.kStatusBarMinimized,D.kThemeUseAnimation,D.kWindowsLinuxAltControls,D.kWindowsUseNativeDecoration],k_=nt.Z.getEventHandler,A_=[{key:D.kToolbarsNavigation,name:(0,le.Z)("Reset Address Bar")},{key:D.kToolbarsStatus,name:(0,le.Z)("Reset Status Bar")}];var Z_=T_("input",{type:"radio",value:"false"}),E_=T_("input",{type:"radio",value:"true"}),__=T_("input",{type:"radio",value:"on"}),N_=T_("input",{type:"radio",value:"overlay"}),M_=T_("input",{type:"radio",value:"off"}),P_=T_("br",{}),D_=T_("br",{}),x_=T_("br",{});class O_ extends tn.Component{static contextType=dn.Z;refUIZoomSetting=tn.createRef();state={modFolder:this.props.prefValues[D.kAppearanceCssUiModsDirectory]};reportStatusBar=e=>{const{value:t}=e.target;nt.Z.set(D.kStatusBarDisplay,t),"on"!==t&&(nt.Z.set(D.kStatusBarMinimized,t),"overlay"===t&&X.Z.setStatus(this.context.vivaldiWindowId,(0,le.Z)("Status Info set to Overlay"),2e3))};handleResetToolbarClick=e=>{nt.Z.reset(e)};renderUseNativeWindow(){return T_("div",{className:"setting-group"},void 0,T_("div",{className:"setting-single"},void 0,T_("label",{},void 0,T_("input",{type:"checkbox",checked:this.props.prefValues[D.kWindowsUseNativeDecoration],onChange:k_(D.kWindowsUseNativeDecoration)}),T_("span",{},void 0,(0,le.Z)("Use Native Window"))),T_("p",{className:"info"},void 0,(0,le.Z)("This setting requires a restart to take full effect."))))}renderOpenInTabs(){return T_("div",{className:"setting-group"},void 0,T_("div",{className:"setting-single"},void 0,T_("label",{},void 0,T_("input",{type:"checkbox",checked:this.props.prefValues[D.kSettingsInTab],onChange:k_(D.kSettingsInTab)}),T_("span",{},void 0,(0,le.Z)("Open Settings in a Tab")))),T_("div",{className:"setting-single"},void 0,T_("label",{},void 0,T_("input",{type:"checkbox",checked:this.props.prefValues[D.kPopupsShowInTab],onChange:k_(D.kPopupsShowInTab)}),T_("span",{},void 0,(0,le.Z)("Open Popups in Tabs")))))}renderShowUI(){return T_("div",{className:"setting-group"},void 0,T_("div",{className:"setting-single"},void 0,T_("label",{},void 0,T_("input",{type:"checkbox",checked:this.props.prefValues[D.kThemeUseAnimation],onChange:k_(D.kThemeUseAnimation)}),T_("span",{},void 0,(0,le.Z)("Use Animation")))),T_("div",{className:"setting-single"},void 0,T_("label",{},void 0,T_("input",{type:"checkbox",checked:this.props.prefValues[D.kAppearanceRangeButtons],onChange:k_(D.kAppearanceRangeButtons)}),T_("span",{},void 0,(0,le.Z)("Use Buttons in Range Controls")))))}renderWindowsControlPosition(){return T_("div",{className:"setting-group"},void 0,T_("h3",{},void 0,(0,le.Z)("Window Controls Position")),T_(ws,{className:"linuxAltControls",name:"linuxAltControls",value:this.props.prefValues[D.kWindowsLinuxAltControls],onChange:k_(D.kWindowsLinuxAltControls,"convert")},void 0,T_("div",{className:"setting-single"},void 0,T_("label",{},void 0,Z_,T_("span",{},void 0,(0,le.Z)("Right Side")))),T_("div",{className:"setting-single"},void 0,T_("label",{},void 0,E_,T_("span",{},void 0,(0,le.Z)("Left Side"))))))}renderStatusBar(){return T_("div",{className:"setting-group"},void 0,T_("h3",{},void 0,(0,le.Z)("title","Status Bar")),T_("div",{className:"setting-single"},void 0,T_(ws,{name:"StatusBar",className:"group",value:this.props.prefValues[D.kStatusBarDisplay],onChange:this.reportStatusBar},void 0,T_("div",{className:"setting-single"},void 0,T_("label",{},void 0,__,T_("span",{},void 0,(0,le.Z)("verb","Show Status Bar")))),T_("div",{className:"setting-single"},void 0,T_("label",{},void 0,N_,T_("span",{},void 0,(0,le.Z)("Status Info Overlay")))),T_("div",{className:"setting-single"},void 0,T_("label",{},void 0,M_,T_("span",{},void 0,(0,le.Z)("verb","Hide Status Bar")))))))}renderToolbarCustomizations(){const e=A_.map((e=>T_("div",{className:"setting-single"},e.key,T_("input",{type:"button",onClick:this.handleResetToolbarClick.bind(this,e.key),value:e.name}))));return T_("div",{className:"setting-group"},void 0,T_("h3",{},void 0,(0,le.Z)("Toolbar Customization")),e)}uiZoomUpdate=()=>{const e=this.refUIZoomSetting.current,{Element:t}=this.context;e instanceof t&&e.scrollIntoViewIfNeeded()};renderUserInterfaceZoom(){return(0,fn.jsxs)("div",{className:"setting-group unlimited",ref:this.refUIZoomSetting,children:[T_("h3",{},void 0,(0,le.Z)("User Interface Zoom")),T_("div",{className:"setting-single"},void 0,T_("div",{className:"toolbar toolbar-default toolbar-medium"},void 0,T_(C_,{onUIZoomUpdate:this.uiZoomUpdate})))]})}selectCSSFolder=()=>{d.Z.utilities.selectFile({windowId:this.context.vivaldiWindowId,title:(0,le.Z)("Select Folder for CSS UI Mods"),type:"folder"}).then((e=>{e&&(this.setState({modFolder:e}),nt.Z.set(D.kAppearanceCssUiModsDirectory,e))}))};onChangeCSSModFolder=e=>{this.setState({modFolder:e.target.value}),nt.Z.set(D.kAppearanceCssUiModsDirectory,e.target.value)};renderCustomStylingOptions(){return ik.Z.isEnabled("css_mods")?T_("div",{className:"setting-subgroup"},void 0,T_("div",{className:"setting-single"},void 0,T_("div",{className:"setting-single folder-selection"},void 0,T_("input",{type:"text",value:this.state.modFolder,title:(0,le.Z)("Enter Custom UI Modifications Path"),onChange:this.onChangeCSSModFolder}),T_("input",{type:"button",value:(0,le.Z)("Select Folder..."),onClick:this.selectCSSFolder})),T_("p",{className:"info"},void 0,(0,le.Z)("Directory for custom CSS UI modification files."),P_,(0,le.Z)("They must have a .css extension to be included."),D_,(0,le.Z)("No guarantees are made that these will work in new versions of Vivaldi."),x_,(0,le.Z)("This requires a restart to apply.")))):null}renderHUD(){return T_("div",{className:"setting-group"},void 0,T_("h3",{},void 0,(0,le.Z)("Status Indicator Overlay")),T_("div",{className:"setting-single"},void 0,T_("label",{},void 0,T_("input",{type:"checkbox",checked:this.props.prefValues[D.kAppearanceHudEnabled],onChange:k_(D.kAppearanceHudEnabled)}),T_("span",{},void 0,(0,le.Z)("Show when entering or exiting Break Mode")))))}render(){return(0,fn.jsxs)(fn.Fragment,{children:[T_(a_,{categoryTitle:(0,le.Z)("Window Appearance"),filter:this.props.filter},void 0,this.renderOpenInTabs(),this.renderShowUI(),this.renderUseNativeWindow(),!1,this.renderStatusBar(),this.renderToolbarCustomizations(),this.renderUserInterfaceZoom(),this.renderHUD()),T_(a_,{categoryTitle:(0,le.Z)("Custom UI Modifications"),filter:this.props.filter,className:"setting-group unlimited"},void 0,this.renderCustomStylingOptions())]})}}const L_=(0,fs.Z)(O_,I_);var R_;function B_(e,t,n,i){R_||(R_="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:R_,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const F_=[D.kUpdateNotifier,D.kUpdateSchedule];class U_ extends tn.Component{_isMounted=!1;_updateNotifierStatusKnown=!1;static#I=void 0;state={showUpdateSettings:!1,updateNotifierEnabled:!1,autoInstallUpdate:!0};componentDidMount(){this._isMounted=!0,void 0===U_.#I&&d.Z.autoUpdate.hasAutoUpdates().then((e=>{U_.#I=e,this._isMounted&&this.forceUpdate()}))}componentWillUnmount(){this._isMounted=!1}refreshUpdateNotifierEnabled=()=>{d.Z.autoUpdate.isUpdateNotifierEnabled((e=>{this.setUpdateNotifierEnabled(e)}))};setUpdateNotifierEnabled=e=>{this._isMounted&&this.setState({updateNotifierEnabled:e})};refreshAutoInstallUpdates=()=>{d.Z.autoUpdate.getAutoInstallUpdates((e=>{this._isMounted&&this.setState({autoInstallUpdate:e})}))};toggleUpdateSettings=()=>{this._updateNotifierStatusKnown||(this._updateNotifierStatusKnown=!0,this.refreshUpdateNotifierEnabled()),this.setState((e=>({showUpdateSettings:!e.showUpdateSettings})))};toggleUpdateNotifier=e=>{e.target.checked?d.Z.autoUpdate.enableUpdateNotifier((e=>{e?this.setUpdateNotifierEnabled(!0):this.refreshUpdateNotifierEnabled()})):d.Z.autoUpdate.disableUpdateNotifier((e=>{e?this.setUpdateNotifierEnabled(!1):this.refreshUpdateNotifierEnabled()}))};toggleAutoInstallUpdate=e=>{const t=e.target.checked;d.Z.autoUpdate.setAutoInstallUpdates(t),this.refreshAutoInstallUpdates()};getUpdateLabel(){return!1===U_.#I?(0,le.Z)("Automatically download updates and notify when they are ready to install"):(0,le.Z)("Automatically Download and Install Updates")}render(){return B_(a_,{categoryTitle:(0,le.Z)("Updates"),filter:this.props.filter},void 0,B_("div",{className:"setting-group unlimited"},void 0,B_("p",{className:"info"},void 0,(0,le.Z)("Get the latest security fixes by allowing automatic updates of Vivaldi.")),!1,B_("div",{className:"setting-single"},void 0,B_("input",{type:"button",value:this.state.showUpdateSettings?(0,le.Z)("Hide Update Settings"):(0,le.Z)("Show Update Settings"),onClick:this.toggleUpdateSettings})),this.state.showUpdateSettings&&B_("div",{className:"setting-single"},void 0,B_("label",{},void 0,B_("input",{type:"checkbox",checked:this.state.updateNotifierEnabled,onChange:this.toggleUpdateNotifier}),B_("span",{},void 0,this.getUpdateLabel()))),!1))}}const V_=(0,fs.Z)(U_,F_);var W_;function H_(e,t,n,i){W_||(W_="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:W_,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const z_=[D.kBiscuitLoadBookmarks,D.kBiscuitLogLevel,D.kBiscuitVersion],G_=nt.Z.getEventHandler;var $_=H_("h2",{},void 0,"Biscuit Area 🐶"),K_=H_("h3",{},void 0,"Biscuit Mode"),j_=H_("span",{},void 0,"Show Browser Version on Status Bar"),Y_=H_("span",{},void 0,"Upgrade Bookmarks Every Startup"),X_=H_("span",{},void 0,"Log level"),Q_=H_("option",{value:"info"},void 0,"Debug"),q_=H_("option",{value:"info"},void 0,"Info"),J_=H_("option",{value:"warn"},void 0,"Warn"),eN=H_("option",{value:"error"},void 0,"Error"),tN=H_("option",{value:"none"},void 0,"None");class nN extends tn.Component{render(){return"🐶"!==this.props.filter&&"biscuit"!==this.props.filter?null:H_("span",{},void 0,$_,H_("div",{className:"setting-group"},void 0,K_,H_("div",{className:"setting-single"},void 0,H_("label",{},void 0,H_("input",{type:"checkbox",checked:this.props.prefValues[D.kBiscuitVersion],onChange:G_(D.kBiscuitVersion)}),j_)),H_("div",{className:"setting-single"},void 0,H_("label",{},void 0,H_("input",{type:"checkbox",checked:this.props.prefValues[D.kBiscuitLoadBookmarks],onChange:G_(D.kBiscuitLoadBookmarks)}),Y_)),H_("div",{className:"setting-single"},void 0,X_,H_("select",{value:this.props.prefValues[D.kBiscuitLogLevel],onChange:G_(D.kBiscuitLogLevel)},void 0,Q_,q_,J_,eN,tN))))}}const iN=(0,fs.Z)(nN,z_);var sN;function oN(e,t,n,i){sN||(sN="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:sN,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const aN=[D.kBookmarksBarDisplay,D.kBookmarksBarPosition,D.kBookmarksBarVisible],rN=nt.Z.getEventHandler;var lN=oN("input",{type:"radio",value:"top"}),dN=oN("input",{type:"radio",value:"bottom"}),cN=oN("input",{type:"radio",value:"default"}),hN=oN("input",{type:"radio",value:"text"}),pN=oN("input",{type:"radio",value:"icon"}),uN=oN("input",{type:"radio",value:"iconexceptfolders"});class gN extends tn.Component{onFolderChange=e=>{i.Z.setBookmarkBarFolder(e.target.value)};render(){return oN(a_,{categoryTitle:(0,le.Z)("Bookmark Bar"),filter:this.props.filter},void 0,oN("div",{className:"setting-group unlimited"},void 0,oN("div",{className:"setting-single"},void 0,oN("label",{},void 0,oN("input",{type:"checkbox",checked:this.props.prefValues[D.kBookmarksBarVisible],onChange:rN(D.kBookmarksBarVisible)}),oN("span",{},void 0,(0,le.Z)("Show Bookmark Bar"))))),oN("div",{className:"setting-group"},void 0,oN("h3",{},void 0,(0,le.Z)("Select Bookmark Bar Folder")),oN("div",{className:"setting-single"},void 0,oN(an,{onChange:this.onFolderChange}))),oN("div",{className:"setting-group"},void 0,oN("h3",{},void 0,(0,le.Z)("Bookmark Bar Position")),oN(ws,{name:"bookmark-position",value:this.props.prefValues[D.kBookmarksBarPosition],onChange:rN(D.kBookmarksBarPosition)},void 0,oN("div",{className:"setting-single"},void 0,oN("label",{},void 0,lN,oN("span",{},void 0,(0,le.Z)("Top")))),oN("div",{className:"setting-single"},void 0,oN("label",{},void 0,dN,oN("span",{},void 0,(0,le.Z)("Bottom")))))),oN("div",{className:"setting-group"},void 0,oN("h3",{},void 0,(0,le.Z)("Bookmark Bar Display")),oN(ws,{name:"bookmark_bar_display",value:this.props.prefValues[D.kBookmarksBarDisplay],onChange:rN(D.kBookmarksBarDisplay)},void 0,oN("div",{className:"setting-single"},void 0,oN("label",{},void 0,cN,oN("span",{},void 0,(0,le.Z)("Text and Icon")))),oN("div",{className:"setting-single"},void 0,oN("label",{},void 0,hN,oN("span",{},void 0,(0,le.Z)("radio","Text Only")))),oN("div",{className:"setting-single"},void 0,oN("label",{},void 0,pN,oN("span",{},void 0,(0,le.Z)("Icon Only")))),oN("div",{className:"setting-single"},void 0,oN("label",{},void 0,uN,oN("span",{},void 0,(0,le.Z)("Bookmark Icon Only")))))))}}const mN=(0,fs.Z)(gN,aN);var vN;function fN(e,t,n,i){vN||(vN="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:vN,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const yN=[D.kBookmarksConfirmAdding,D.kBookmarksConfirmOpening,D.kBookmarksConfirmOpeningThreshold,D.kBookmarksFetchPageMetadata,D.kBookmarksOpenInNewTab,D.kBookmarksSingleClickOpens,D.kBookmarksUnderlineMenuLetter],wN=nt.Z.getEventHandler;class bN extends tn.Component{minThreshold=1;maxThreshold=99;render(){return fN(a_,{categoryTitle:(0,le.Z)("Bookmarks"),filter:this.props.filter},void 0,fN("div",{className:"setting-group unlimited"},void 0,fN("div",{className:"setting-single"},void 0,fN("label",{},void 0,fN("input",{type:"checkbox",checked:this.props.prefValues[D.kBookmarksOpenInNewTab],onChange:wN(D.kBookmarksOpenInNewTab)}),fN("span",{},void 0,(0,le.Z)("Open Bookmarks in New Tab")))),fN("div",{className:"setting-single"},void 0,fN("label",{},void 0,fN("input",{type:"checkbox",checked:this.props.prefValues[D.kBookmarksSingleClickOpens],onChange:wN(D.kBookmarksSingleClickOpens)}),fN("span",{},void 0,(0,le.Z)("Open Bookmark Panel Items with Single Click")))),fN("div",{className:"setting-single"},void 0,fN("label",{},void 0,fN("input",{type:"checkbox",checked:this.props.prefValues[D.kBookmarksUnderlineMenuLetter],onChange:wN(D.kBookmarksUnderlineMenuLetter)}),fN("span",{},void 0,(0,le.Z)("Use “&” in Title to Underline Next Letter in Menus")))),fN("div",{className:"setting-single max-bookmarks"},void 0,fN("label",{},void 0,fN("input",{type:"checkbox",checked:this.props.prefValues[D.kBookmarksConfirmOpening],onChange:wN(D.kBookmarksConfirmOpening)}),fN("span",{},void 0,(0,le.Z)("Confirm Opening Bookmarks over Maximum of")),fN("input",{type:"number",size:"2",disabled:!this.props.prefValues[D.kBookmarksConfirmOpening],value:this.props.prefValues[D.kBookmarksConfirmOpeningThreshold],onChange:wN(D.kBookmarksConfirmOpeningThreshold),min:this.minThreshold,max:this.maxThreshold}))),fN("div",{className:"setting-single max-bookmarks"},void 0,fN(WE.C,{text:(0,le.Z)("Fetch Bookmark Data from Page Metadata")},void 0,fN("input",{type:"checkbox",checked:this.props.prefValues[D.kBookmarksFetchPageMetadata],onChange:wN(D.kBookmarksFetchPageMetadata)}))),fN("div",{className:"setting-single"},void 0,fN(WE.C,{text:(0,le.Z)("Always Open Bookmark Dialog")},void 0,fN("input",{type:"checkbox",checked:this.props.prefValues[D.kBookmarksConfirmAdding],onChange:wN(D.kBookmarksConfirmAdding)})))))}}const CN=(0,fs.Z)(bN,yN);var SN;function TN(e,t,n,i){SN||(SN="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:SN,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const IN=1440;function kN(e,t){if(0===e)return t?(0,le.Z)("Same day"):(0,le.Z)("At event time");if(e%10080==0){const t=e/10080;return(0,le.Z)("$1 week before","$1 weeks before",[t])}if(e%IN==0){const t=e/IN;return(0,le.Z)("$1 day before","$1 days before",[t])}if(e%60==0){const t=e/60;return(0,le.Z)("$1 hour before","$1 hours before",[t])}return(0,le.Z)("$1 minute before","$1 minutes before",[e])}const AN=[[NaN,(0,le.Z)("No reminder")],[0,(0,le.Z)("At event time")],[5,kN(5,!1)],[10,kN(10,!1)],[15,kN(15,!1)],[30,kN(30,!1)],[45,kN(45,!1)],[60,kN(60,!1)],[120,kN(120,!1)],[1440,kN(1440,!1)],[2880,kN(2880,!1)]],ZN=[[NaN,(0,le.Z)("No reminder")],[0,(0,le.Z)("Same day")],[1440,(0,le.Z)("$1 day before","$1 days before",[1])],[2880,(0,le.Z)("$1 day before","$1 days before",[2])],[4320,(0,le.Z)("$1 day before","$1 days before",[3])],[7200,(0,le.Z)("$1 day before","$1 days before",[5])],[10080,(0,le.Z)("$1 week before","$1 weeks before",[1])],[20160,(0,le.Z)("$1 week before","$1 weeks before",[2])],[30240,(0,le.Z)("$1 week before","$1 weeks before",[3])]],EN=6e4;function _N(e){const t=NN(e);return`${Math.floor(t/60%24).toString().padStart(2,"0")}:${(t%60).toString().padStart(2,"0")}`}function NN(e){return e<0?Math.abs(e)%IN:(IN-e%IN)%IN}const MN=function(e){const t=tn.useRef(null),n=e.value/EN;function i(t){let i=parseInt(t.target.value);e.allDay&&(i-=NN(n)),e.onChange(i*EN)}const s=e.allDay?[...ZN]:[...AN],o=e.allDay?Math.ceil(n/IN)*IN:n;return s.find((([e])=>e===o))||(s.push([o,kN(o,e.allDay??!1)]),s.sort((([e],[t])=>e-t))),(0,fn.jsxs)(fn.Fragment,{children:[e.create&&(0,fn.jsx)("select",{ref:t,className:e.className,tabIndex:e.tabIndex,onChange:i,value:"NaN",disabled:0===s.length,children:s.map((([e,t])=>TN("option",{value:e.toString()},e,t)))}),!e.create&&(0,fn.jsxs)(fn.Fragment,{children:[(0,fn.jsx)("select",{ref:t,className:e.className,tabIndex:e.tabIndex,onChange:i,value:o,disabled:0===s.length,children:s.map((([e,t])=>TN("option",{value:e.toString()},e,t)))}),e.allDay&&(0,fn.jsxs)(fn.Fragment,{children:[TN("span",{style:{flex:"0 0 auto"}},void 0,(0,le.Z)("at")),TN(uh,{onChange:function(n){const i=Date.parse(`1970-01-01T${n.target.value}Z`)/EN,s=(parseInt(t.current?.value)||0)-i;e.onChange(s*EN)},value:_N(n),step:"5",autoFocusNextElement:!1})]})]})]})};var PN;function DN(e,t,n,i){PN||(PN="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:PN,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const xN=[D.kCalendarAutoAdjustEnd,D.kCalendarAutoTabDatetime,D.kCalendarClickOutside,D.kCalendarClickTimeSlot,D.kCalendarCollapseHours,D.kCalendarDayEnds,D.kCalendarDayStarts,D.kCalendarDefaultAlldayNotification,D.kCalendarDefaultAlldayNotificationTime,D.kCalendarDefaultDuration,D.kCalendarDefaultNotification,D.kCalendarDisplayDensity,D.kCalendarHandleIcsDownloads,D.kCalendarHandleWebcalLinks,D.kCalendarDisplayEventIcons,D.kCalendarDisplayWeekNumber,D.kCalendarEditMode,D.kCalendarHiddenHidesNotifications,D.kCalendarMailAccount,D.kCalendarNotificationFullscreen,D.kCalendarNotificationType,D.kCalendarNotificationSound,D.kCalendarOnlyHourlyDivider,D.kCalendarOnlyHourlyKeynav,D.kCalendarSendInviteEmailAction,D.kCalendarTimeIncrements,D.kMailAccounts],ON=nt.Z.getEventHandler,LN=[["",(0,le.Z)("other","None")],["../../../resources/notification_ding.opus",(0,le.Z)("Ding")],["../../../resources/notification_rooster.opus",(0,le.Z)("Rooster")],["../../../resources/notification_tada.opus",(0,le.Z)("Tada")]],RN=[[0,(0,le.Z)("No Duration")],[5*yc.lb,(0,le.Z)("$1 minute","$1 minutes",[5])],[10*yc.lb,(0,le.Z)("$1 minute","$1 minutes",[10])],[15*yc.lb,(0,le.Z)("$1 minute","$1 minutes",[15])],[30*yc.lb,(0,le.Z)("$1 minute","$1 minutes",[30])],[45*yc.lb,(0,le.Z)("$1 minute","$1 minutes",[45])],[1*yc.QI,(0,le.Z)("$1 hour","$1 hours",[1])],[2*yc.QI,(0,le.Z)("$1 hour","$1 hours",[2])],[3*yc.QI,(0,le.Z)("$1 hour","$1 hours",[3])],[8*yc.QI,(0,le.Z)("$1 hour","$1 hours",[8])]],BN=b()().startOf("day"),FN=[];for(;BN.hour()<13;){const e=BN.hour();FN.push(DN("option",{value:e},e,BN.format("LT"))),BN.add(1,"hour")}BN.hour(12);const UN=[];for(;BN.hour()>0;){BN.add(1,"hour");const e=BN.hour()||24;UN.push(DN("option",{value:e},e,BN.format("LT")))}var VN=DN("input",{type:"radio",value:"full"}),WN=DN("input",{type:"radio",value:"compact"}),HN=DN("input",{type:"radio",value:"minimal"}),zN=DN("input",{type:"radio",value:"15"}),GN=DN("input",{type:"radio",value:"30"}),$N=DN("input",{type:"radio",value:"60"}),KN=DN("input",{type:"radio",value:"select"}),jN=DN("input",{type:"radio",value:"create"}),YN=DN("input",{type:"radio",value:"cancel"}),XN=DN("input",{type:"radio",value:"save_and_close"}),QN=DN("input",{type:"radio",value:"inline"}),qN=DN("input",{type:"radio",value:"popup"}),JN=DN("input",{type:"radio",value:"always"}),eM=DN("input",{type:"radio",value:"never"}),tM=DN("input",{type:"radio",value:"timed_only"}),nM=DN("input",{type:"radio",value:"system"}),iM=DN("input",{type:"radio",value:"dialog"}),sM=DN("input",{type:"radio",value:"melt"}),oM=DN("input",{type:"radio",value:"burn"}),aM=DN("input",{type:"radio",value:"ask"}),rM=DN("input",{type:"radio",value:"send"}),lM=DN("input",{type:"radio",value:"cancel"});class dM extends tn.Component{renderMailAccountSelection(){const e=this.props.prefValues[D.kMailAccounts],t=this.props.prefValues[D.kCalendarMailAccount],n=e.find((e=>e.MAIL_EMAIL===t));return DN("div",{className:"setting-group"},void 0,DN("div",{className:"setting-single"},void 0,DN("h3",{},void 0,(0,le.Z)("Calendar Mail Account")),DN("select",{value:t,onChange:ON(D.kCalendarMailAccount)},void 0,!n&&DN("option",{value:t,disabled:!0},void 0,(0,le.Z)("Select mail account")),e.map((e=>DN("option",{value:e.MAIL_EMAIL},e.MAIL_EMAIL,e.MAIL_EMAIL))))))}render(){return(0,fn.jsxs)(fn.Fragment,{children:[DN(a_,{categoryTitle:(0,le.Z)("Calendar Display"),filter:this.props.filter},void 0,DN("div",{className:"setting-group"},void 0,DN("div",{className:"setting-single"},void 0,DN("label",{},void 0,DN("input",{type:"checkbox",checked:this.props.prefValues[D.kCalendarDisplayEventIcons],onChange:ON(D.kCalendarDisplayEventIcons)}),DN("span",{},void 0,(0,le.Z)("Show Event Property Icons")))),DN("div",{className:"setting-single"},void 0,DN("label",{},void 0,DN("input",{type:"checkbox",checked:this.props.prefValues[D.kCalendarDisplayWeekNumber],onChange:ON(D.kCalendarDisplayWeekNumber)}),DN("span",{},void 0,(0,le.Z)("Show Week Number"))),DN("p",{className:"info"},void 0,(0,le.Z)("For week settings see Language under General Settings.")))),DN("div",{className:"setting-group"},void 0,DN("h3",{},void 0,(0,le.Z)("Events View")),DN(ws,{name:"calendar-density",value:this.props.prefValues[D.kCalendarDisplayDensity],onChange:ON(D.kCalendarDisplayDensity),className:"group"},void 0,DN("div",{className:"setting-single"},void 0,DN("label",{},void 0,VN,DN("span",{},void 0,(0,le.Z)("Full")))),DN("div",{className:"setting-single"},void 0,DN("label",{},void 0,WN,DN("span",{},void 0,(0,le.Z)("calendar","Compact")))),DN("div",{className:"setting-single"},void 0,DN("label",{},void 0,HN,DN("span",{},void 0,(0,le.Z)("Minimal")))))),DN("div",{className:"setting-group"},void 0,DN("h3",{},void 0,(0,le.Z)("Visible Day Hours")),DN("div",{className:"setting-single day-setting-grid"},void 0,DN("label",{},void 0,DN("span",{},void 0,(0,le.Z)("Day Starts at")),DN("select",{name:"day_starts",value:this.props.prefValues[D.kCalendarDayStarts],onChange:ON(D.kCalendarDayStarts)},void 0,FN),DN("span",{},void 0,(0,le.Z)("Day Ends at")),DN("select",{name:"day_ends",value:this.props.prefValues[D.kCalendarDayEnds],onChange:ON(D.kCalendarDayEnds)},void 0,UN))),DN("div",{className:"setting-single"},void 0,DN("label",{},void 0,DN("input",{type:"checkbox",checked:this.props.prefValues[D.kCalendarCollapseHours],onChange:ON(D.kCalendarCollapseHours)}),DN("span",{},void 0,(0,le.Z)("Collapse Excluded Hours"))))),DN("div",{className:"setting-group"},void 0,DN("h3",{},void 0,(0,le.Z)("Time Increments")),DN(ws,{name:"time-increments",value:this.props.prefValues[D.kCalendarTimeIncrements],onChange:ON(D.kCalendarTimeIncrements),className:"group"},void 0,DN("div",{className:"setting-single"},void 0,DN("label",{},void 0,zN,DN("span",{},void 0,(0,le.Z)("15 Minutes")))),DN("div",{className:"setting-single"},void 0,DN("label",{},void 0,GN,DN("span",{},void 0,(0,le.Z)("30 Minutes")))),DN("div",{className:"setting-single"},void 0,DN("label",{},void 0,$N,DN("span",{},void 0,(0,le.Z)("1 Hour"))))),DN("div",{className:"setting-single"},void 0,DN("label",{},void 0,DN("input",{type:"checkbox",checked:this.props.prefValues[D.kCalendarOnlyHourlyDivider],onChange:ON(D.kCalendarOnlyHourlyDivider)}),DN("span",{},void 0,(0,le.Z)("Show Only 1 Hour Grid Lines")))),DN("div",{className:"setting-single"},void 0,DN("label",{},void 0,DN("input",{type:"checkbox",checked:this.props.prefValues[D.kCalendarOnlyHourlyKeynav],onChange:ON(D.kCalendarOnlyHourlyKeynav)}),DN("span",{},void 0,(0,le.Z)("Use 1 Hour Increments for Keyboard Navigation"))))),DN("div",{className:"setting-group"},void 0,DN("h3",{},void 0,(0,le.Z)("Click on Time Slot Should")),DN(ws,{name:"click-timeslot",value:this.props.prefValues[D.kCalendarClickTimeSlot],onChange:ON(D.kCalendarClickTimeSlot),className:"group"},void 0,DN("div",{className:"setting-single"},void 0,DN("label",{},void 0,KN,DN("span",{},void 0,(0,le.Z)("Select Period")))),DN("div",{className:"setting-single"},void 0,DN("label",{},void 0,jN,DN("span",{},void 0,(0,le.Z)("Create New Event")))))),DN("div",{className:"setting-group"},void 0,DN("h3",{},void 0,(0,le.Z)("Click Outside Event Should")),DN(ws,{name:"click-outside",value:this.props.prefValues[D.kCalendarClickOutside],onChange:ON(D.kCalendarClickOutside),className:"group"},void 0,DN("div",{className:"setting-single"},void 0,DN("label",{},void 0,YN,DN("span",{},void 0,(0,le.Z)("Discard Changes")))),DN("div",{className:"setting-single"},void 0,DN("label",{},void 0,XN,DN("span",{},void 0,(0,le.Z)("Save Changes"))))))),DN(a_,{categoryTitle:(0,le.Z)("Calendar Editing"),filter:this.props.filter},void 0,DN("div",{className:"setting-group"},void 0,DN("h3",{},void 0,(0,le.Z)("Edit Mode")),DN(ws,{name:"edit-mode",value:this.props.prefValues[D.kCalendarEditMode],onChange:ON(D.kCalendarEditMode),className:"group"},void 0,DN("div",{className:"setting-single"},void 0,DN("label",{},void 0,QN,DN("span",{},void 0,(0,le.Z)("Inline"))),DN("div",{className:mn()("img-setting",{disabled:"popup"===this.props.prefValues[D.kCalendarEditMode]})},void 0,DN("span",{className:"image",dangerouslySetInnerHTML:{__html:n(9371)}}))),DN("div",{className:"setting-single"},void 0,DN("label",{},void 0,qN,DN("span",{},void 0,(0,le.Z)("radio","Dialog"))),DN("div",{className:mn()("img-setting",{disabled:"inline"===this.props.prefValues[D.kCalendarEditMode]})},void 0,DN("span",{className:"image",dangerouslySetInnerHTML:{__html:n(97487)}}))))),DN("div",{className:"setting-group"},void 0,DN("h3",{},void 0,(0,le.Z)("Default Event Duration")),DN("div",{className:"setting-single"},void 0,DN("label",{},void 0,DN("select",{value:this.props.prefValues[D.kCalendarDefaultDuration],onChange:ON(D.kCalendarDefaultDuration)},void 0,RN.map((([e,t])=>DN("option",{value:e},e,t)))))),DN("h3",{},void 0,(0,le.Z)("Default Event Reminder")),DN("div",{className:"setting-single"},void 0,DN("label",{},void 0,DN("select",{value:this.props.prefValues[D.kCalendarDefaultNotification],onChange:e=>{let t=parseInt(e.target.value);isNaN(t)&&(t=-1),nt.Z.set(D.kCalendarDefaultNotification,t)}},void 0,AN.map((([e,t])=>DN("option",{value:e.toString()},e,t)))))),DN("h3",{},void 0,(0,le.Z)("Default Reminder for All Day Events")),DN("div",{className:"setting-single"},void 0,DN("label",{},void 0,DN(MN,{value:this.props.prefValues[D.kCalendarDefaultAlldayNotificationTime]*yc.lb,onChange:e=>{isNaN(e)?(e=0,nt.Z.set(D.kCalendarDefaultAlldayNotification,!1)):nt.Z.set(D.kCalendarDefaultAlldayNotification,!0),0===this.props.prefValues[D.kCalendarDefaultAlldayNotificationTime]&&(e-=540*yc.lb),nt.Z.set(D.kCalendarDefaultAlldayNotificationTime,e/yc.lb)},create:!this.props.prefValues[D.kCalendarDefaultAlldayNotification],allDay:!0})))),DN("div",{className:"setting-group"},void 0,DN("h3",{},void 0,(0,le.Z)("Auto Adjust End Time")),DN("p",{className:"info"},void 0,(0,le.Z)("Automatically update end time when editing to keep same event duration.")),DN(ws,{name:"auto-adjust-end",value:this.props.prefValues[D.kCalendarAutoAdjustEnd],onChange:ON(D.kCalendarAutoAdjustEnd),className:"group"},void 0,DN("div",{className:"setting-single"},void 0,DN("label",{},void 0,JN,DN("span",{},void 0,(0,le.Z)("Always")))),DN("div",{className:"setting-single"},void 0,DN("label",{},void 0,eM,DN("span",{},void 0,(0,le.Z)("other","Never")))),DN("div",{className:"setting-single"},void 0,DN("label",{},void 0,tM,DN("span",{},void 0,(0,le.Z)("Except for All Day Events")))))),DN("div",{className:"setting-group"},void 0,DN("h3",{},void 0,(0,le.Z)("Auto Focus Next Date/Time")),DN("div",{className:"setting-single"},void 0,DN("label",{},void 0,DN("input",{type:"checkbox",checked:this.props.prefValues[D.kCalendarAutoTabDatetime],onChange:ON(D.kCalendarAutoTabDatetime)}),DN("span",{},void 0,(0,le.Z)("Automatically move focus to next field after typing complete date or time value")))))),DN(a_,{categoryTitle:(0,le.Z)("Calendar Notifications"),filter:this.props.filter},void 0,DN("div",{className:"setting-group"},void 0,DN("div",{className:"setting-single"},void 0,DN("label",{},void 0,DN("input",{type:"checkbox",value:"none"!==this.props.prefValues[D.kCalendarNotificationType]?"none":"dialog",checked:"none"!==this.props.prefValues[D.kCalendarNotificationType],onChange:ON(D.kCalendarNotificationType)}),DN("span",{},void 0,(0,le.Z)("Enable Notifications")))),DN("div",{className:"setting-single"},void 0,DN("label",{},void 0,DN("input",{type:"checkbox",checked:this.props.prefValues[D.kCalendarHiddenHidesNotifications],disabled:"none"===this.props.prefValues[D.kCalendarNotificationType],onChange:ON(D.kCalendarHiddenHidesNotifications)}),DN("span",{},void 0,(0,le.Z)("Disable for Hidden Calendars"))))),DN("div",{className:"setting-group"},void 0,DN("h3",{},void 0,(0,le.Z)("Notification Style")),DN(ws,{name:"calendarnotificationgroup",value:this.props.prefValues[D.kCalendarNotificationType]||"",onChange:ON(D.kCalendarNotificationType),disabled:"none"===this.props.prefValues[D.kCalendarNotificationType]},void 0,DN("div",{className:"setting-single"},void 0,DN("label",{},void 0,nM,DN("span",{},void 0,(0,le.Z)("System Notification")))),DN("div",{className:"setting-single"},void 0,DN("label",{},void 0,iM,DN("span",{},void 0,(0,le.Z)("calendar","Dialog")))),DN("div",{className:"setting-single"},void 0,DN("label",{},void 0,sM,DN("span",{},void 0,(0,le.Z)("Melt Browser")))),DN("div",{className:"setting-single"},void 0,DN("label",{},void 0,oM,DN("span",{},void 0,(0,le.Z)("Burn Browser"))))),DN("div",{className:"setting-single"},void 0,DN("label",{},void 0,DN("input",{type:"checkbox",checked:this.props.prefValues[D.kCalendarNotificationFullscreen],onChange:ON(D.kCalendarNotificationFullscreen),disabled:!("melt"===this.props.prefValues[D.kCalendarNotificationType]||"burn"===this.props.prefValues[D.kCalendarNotificationType])}),DN("span",{},void 0,(0,le.Z)("Full Screen Notifications"))),DN("p",{className:"info"},void 0,(0,le.Z)("Applies to Melt and Burn notification type.")))),DN("div",{className:"setting-group"},void 0,DN("h3",{},void 0,(0,le.Z)("Notification Sound")),DN(ws,{name:"calendarnotificationsoundgroup",value:this.props.prefValues[D.kCalendarNotificationSound]||"",onChange:ON(D.kCalendarNotificationSound),disabled:"none"===this.props.prefValues[D.kCalendarNotificationType]},void 0,LN.map((([e,t])=>DN("div",{className:"setting-single"},e,DN("label",{},void 0,DN("input",{type:"radio",value:e}),DN("span",{},void 0,t)))))))),DN(a_,{categoryTitle:(0,le.Z)("Calendar Integration"),filter:this.props.filter},void 0,this.renderMailAccountSelection(),DN("div",{className:"setting-group"},void 0,DN("h3",{},void 0,(0,le.Z)("Send Invite Email Messages")),DN(ws,{name:"calendarinviteemailsgroup",value:this.props.prefValues[D.kCalendarSendInviteEmailAction]||"",onChange:ON(D.kCalendarSendInviteEmailAction)},void 0,DN("div",{className:"setting-single"},void 0,DN("label",{},void 0,aM,DN("span",{},void 0,(0,le.Z)("Ask Each Time")))),DN("div",{className:"setting-single"},void 0,DN("label",{},void 0,rM,DN("span",{},void 0,(0,le.Z)("Always Send Messages")))),DN("div",{className:"setting-single"},void 0,DN("label",{},void 0,lM,DN("span",{},void 0,(0,le.Z)("Never Send Messages")))))),DN("div",{className:"setting-group"},void 0,DN("div",{className:"setting-single"},void 0,DN("label",{},void 0,DN("input",{type:"checkbox",checked:this.props.prefValues[D.kCalendarHandleIcsDownloads],onChange:ON(D.kCalendarHandleIcsDownloads)}),DN("span",{},void 0,(0,le.Z)("Open ICS files in Vivaldi")))),DN("div",{className:"setting-single"},void 0,DN("label",{},void 0,DN("input",{type:"checkbox",checked:this.props.prefValues[D.kCalendarHandleWebcalLinks],onChange:ON(D.kCalendarHandleWebcalLinks)}),DN("span",{},void 0,(0,le.Z)("Open Webcal Links in Vivaldi"))))))]})}}const cM=(0,fs.Z)(dM,xN);var hM,pM=n(85619);function uM(e,t,n,i){hM||(hM="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:hM,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const gM=[D.kWebpagesCaptureDirectory,D.kWebpagesCaptureSaveFilePattern],mM=nt.Z.getEventHandler,vM=new Date,fM="139cea89-3ed1-4ccd-bd3c-7a6a36f824d5",yM=[{tag:"$timestamp",title:(0,le.Z)("Long date"),format:"YYYY-MM-DD HH.mm.ss"},{tag:"$year",title:(0,le.Z)("Year"),format:"YYYY"},{tag:"$month",title:(0,le.Z)("Month"),format:"MM"},{tag:"$day",title:(0,le.Z)("Day"),format:"DD"},{tag:"$hour",title:(0,le.Z)("Hour"),format:"HH"},{tag:"$minute",title:(0,le.Z)("Minute"),format:"mm"},{tag:"$second",title:(0,le.Z)("time","Second"),format:"ss"},{tag:"$ms",title:(0,le.Z)("Millisecond"),format:"SSS"},{tag:"$longid",title:(0,le.Z)("Unique ID"),value:fM},{tag:"$shortid",title:(0,le.Z)("Short unique ID"),value:fM.substring(24)},{tag:"$host",title:(0,le.Z)("Active tab host name"),value:"example.com"},{tag:"$title",title:(0,le.Z)("Active tab title"),value:(0,le.Z)("Example Page Title")}];class wM extends tn.Component{static contextType=dn.Z;handleDragEnter=e=>{const{dataTransfer:t,target:n}=e;n&&t.types.includes("text/plain")&&(n.setSelectionRange(n.value.length,n.value.length),n.focus())};setDragData=e=>{const{dataTransfer:t,target:n}=e;t.setData("text/plain",n.innerText),t.dropEffect="none",t.effectAllowed="copyMove",t.setDragImage(n,0,0)};handleDoubleClick=e=>{const{HTMLInputElement:t}=this.context,{target:n}=e;let i=n.innerText;if(this._inputRef instanceof t){const e=this._inputRef.selectionStart,t=this._inputRef.value||"";i=" "+i+" ";let n=e>0?t.substr(0,e)+i+t.substr(e):t+i;n=n.replace(/ {2}/g," ").trim(),nt.Z.set(D.kWebpagesCaptureSaveFilePattern,n),this._inputRef&&this._inputRef.focus()}};resetSetting=()=>{nt.Z.reset(D.kWebpagesCaptureSaveFilePattern)};parseFileName=()=>{let e=this.props.prefValues[D.kWebpagesCaptureSaveFilePattern];return yM.forEach((t=>{const n=new RegExp((0,pM.Z)(t.tag),"gi"),i=t.format?b()(vM).format(t.format):t.value;e=e.replace(n,i)})),(e||fM)+".png"};selectCaptureFolder=()=>{d.Z.utilities.selectFile({windowId:this.context.vivaldiWindowId,title:(0,le.Z)("Select Capture Folder"),type:"folder"}).then((e=>{e&&nt.Z.set(D.kWebpagesCaptureDirectory,e)}))};renderTags=()=>yM.map(((e,t)=>uM("span",{draggable:"true",onDoubleClick:this.handleDoubleClick,onDragStart:this.setDragData,title:e.title+(e.format?" ("+e.format+")":"")},t,e.tag)));render(){return uM(a_,{categoryTitle:(0,le.Z)("Image Capture"),filter:this.props.filter},void 0,uM("div",{className:"setting-group"},void 0,uM("div",{className:"setting-single"},void 0,uM("h3",{},void 0,(0,le.Z)("Capture Storage Folder")),uM("div",{className:"setting-single folder-selection"},void 0,uM("input",{type:"text",value:this.props.prefValues[D.kWebpagesCaptureDirectory],title:(0,le.Z)("Enter capture storage folder"),spellCheck:"false",onChange:mM(D.kWebpagesCaptureDirectory)}),uM("input",{type:"button",value:(0,le.Z)("Select Folder..."),onClick:this.selectCaptureFolder})))),uM("div",{className:"setting-group"},void 0,uM("div",{className:"setting-single capture-name-template"},void 0,uM("h3",{},void 0,(0,le.Z)("Capture File Name Template")),(0,fn.jsx)("input",{type:"text",ref:e=>this._inputRef=e,onDragEnter:this.handleDragEnter,value:this.props.prefValues[D.kWebpagesCaptureSaveFilePattern],title:(0,le.Z)("Modify file name template"),spellCheck:"false",onChange:mM(D.kWebpagesCaptureSaveFilePattern)}),uM("p",{className:"info"},void 0,this.parseFileName()),uM("p",{className:"info"},void 0,this.renderTags()),uM("input",{type:"button",value:(0,le.Z)("Restore Default"),onClick:this.resetSetting}))))}}const bM=(0,fs.Z)(wM,gM);var CM;function SM(e,t,n,i){CM||(CM="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:CM,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const TM=[D.kChatDebugOutput,D.kChatNotifications,D.kChatNotificationsSoundOn,D.kChatProcessHintNoStore,D.kChatTabMode,D.kChatTypingIndication],IM=nt.Z.getEventHandler;var kM=SM("h3",{},void 0,"Account"),AM=SM("h3",{},void 0,"Debug"),ZM=SM("input",{type:"radio",value:"off"}),EM=SM("input",{type:"radio",value:"simple"}),_M=SM("input",{type:"radio",value:"verbose"});class NM extends tn.Component{state={isLoggedIn:!1};componentDidMount(){UT.addListener(this.chatStoreListener),this.chatStoreListener()}componentWillUnmount(){UT.removeListener(this.chatStoreListener)}chatStoreListener=()=>{const e=UT.getState();this.setState({isLoggedIn:e.isLoggedIn})};connect=()=>{RT.getClient().connect()};disconnect=()=>{RT.getClient().disconnect()};signOut=()=>{RT.signOut()};render(){const{isLoggedIn:e}=this.state,{filter:t,prefValues:n}=this.props;return SM(a_,{categoryTitle:(0,le.Z)("Chat"),filter:t},void 0,e&&(0,fn.jsxs)(fn.Fragment,{children:[SM("div",{className:"setting-group unlimited"},void 0,SM("div",{className:"setting-single"},void 0,kM,SM("p",{},void 0,PT(RT.getClient().jid)),SM("label",{},void 0,SM("input",{type:"button",className:"danger",onClick:this.signOut,value:(0,le.Z)("Logout")})))),SM("div",{className:"setting-group unlimited"},void 0,SM("div",{className:"setting-group"},void 0,SM("div",{className:"setting-single"},void 0,AM,SM("input",{type:"button",onClick:this.disconnect,value:(0,le.Z)("Disconnect")}),SM("input",{type:"button",onClick:this.connect,value:(0,le.Z)("Connect")}))),SM("div",{className:"setting-group"},void 0,SM("h3",{},void 0,(0,le.Z)("Debug Console Output")),SM(ws,{name:"menuStyle",value:this.props.prefValues[D.kChatDebugOutput],onChange:IM(D.kChatDebugOutput),className:"setting-single"},void 0,SM("div",{className:"setting-single"},void 0,SM("label",{},void 0,ZM,SM("span",{},void 0,(0,le.Z)("Off")))),SM("div",{className:"setting-single"},void 0,SM("label",{},void 0,EM,SM("span",{},void 0,(0,le.Z)("Simple")))),SM("div",{className:"setting-single"},void 0,SM("label",{},void 0,_M,SM("span",{},void 0,(0,le.Z)("Verbose")))))))]}),SM("div",{className:"setting-group"},void 0,SM("div",{className:"setting-single"},void 0,SM("h3",{},void 0,(0,le.Z)("Notifications")),SM("label",{},void 0,SM("input",{type:"checkbox",checked:n[D.kChatNotifications],onChange:IM(D.kChatNotifications)}),SM("span",{},void 0,(0,le.Z)("Notifications Enabled")))),SM("div",{className:"setting-single"},void 0,SM("label",{},void 0,SM("input",{type:"checkbox",checked:n[D.kChatNotificationsSoundOn],onChange:IM(D.kChatNotificationsSoundOn)}),SM("span",{},void 0,(0,le.Z)("Play Sound"))))),SM("div",{className:"setting-group"},void 0,SM("div",{className:"setting-single"},void 0,SM("h3",{},void 0,(0,le.Z)("Typing Indication")),SM("label",{},void 0,SM("input",{type:"checkbox",checked:n[D.kChatTypingIndication],onChange:IM(D.kChatTypingIndication)}),SM("span",{},void 0,(0,le.Z)("Send My Typing Status"))),SM("p",{className:"info"},void 0,(0,le.Z)("Let other people see you’re typing a message")))),SM("div",{className:"setting-group"},void 0,SM("div",{className:"setting-single"},void 0,SM("h3",{},void 0,(0,le.Z)("Store Messages")),SM("label",{},void 0,SM("input",{type:"checkbox",checked:n[D.kChatProcessHintNoStore],onChange:IM(D.kChatProcessHintNoStore)}),SM("span",{},void 0,(0,le.Z)("Avoid Storing Messages"))),SM("p",{className:"info"},void 0,(0,le.Z)("Tell the server to not store messages you send")))),SM("div",{className:"setting-group unlimited"},void 0,SM("div",{className:"setting-single"},void 0,SM("h3",{},void 0,(0,le.Z)("Presentation")),SM("p",{className:"info"},void 0,(0,le.Z)("Always open conversations in tabs")),SM("label",{},void 0,SM("input",{type:"checkbox",checked:n[D.kChatTabMode],onChange:IM(D.kChatTabMode)}),SM("span",{},void 0,(0,le.Z)("Tab Mode"))))))}}(0,fs.Z)(NM,TM);var MM=n(56551);const PM="https://downloads.vivaldi.com/",DM={[PM+"ddg/tds-v2-current.json"]:"DuckDuckGo Tracker Radar",[PM+"easylist/easyprivacy-current.txt"]:"EasyPrivacy",[PM+"easylist/easylist-current.txt"]:"EasyList",[PM+"lists/abp/abp-filters-anti-cv-current.txt"]:"ABP anti-circumvention list",[PM+"lists/vivaldi/partners-current.txt"]:(0,le.Z)("Allow ads from our partners (support Vivaldi)"),"https://www.i-dont-care-about-cookies.eu/abp/":(0,le.Z)("Remove cookie warnings ($1)",["I don’t care about cookies"]),"https://secure.fanboy.co.nz/fanboy-cookiemonster.txt":(0,le.Z)("Remove cookie warnings ($1)",["Easylist Cookie List"]),"https://easylist-downloads.adblockplus.org/Liste_AR.txt":(0,le.Z)("Arabic ($1)",["Liste AR"]),"http://stanev.org/abp/adblock_bg.txt":(0,le.Z)("Bulgarian ($1)",["Bulgarian List"]),"https://easylist-downloads.adblockplus.org/easylistchina.txt":(0,le.Z)("Chinese ($1)",["EasyList China"]),"https://raw.githubusercontent.com/cjx82630/cjxlist/master/cjx-annoyance.txt":(0,le.Z)("Chinese ($1)",["CJX’s Annoyance List"]),"https://raw.githubusercontent.com/yecarrillo/adblock-colombia/master/adblock_co.txt":(0,le.Z)("Colombian ($1)",["Colombian List by Yecarrillo"]),"https://raw.githubusercontent.com/tomasko126/easylistczechandslovak/master/filters.txt":(0,le.Z)("Czech and Slovak ($1)",["Czech and Slovak filter list"]),"https://easylist-downloads.adblockplus.org/easylistdutch.txt":(0,le.Z)("Dutch ($1)",["EasyList Dutch"]),"https://pgl.yoyo.org/adservers/serverlist.php?hostformat=adblockplus&mimetype=plaintext":(0,le.Z)("English ($1)",["Peter Lowe’s List"]),"https://adblock.ee/list.php":(0,le.Z)("Estonian ($1)",["Eesti saitidele kohandatud filter"]),"https://gurud.ee/ab.txt":(0,le.Z)("Estonian ($1)",["Filters by Gurud.ee"]),"https://cdn.rawgit.com/SlashArash/adblockfa/master/adblockfa.txt":(0,le.Z)("Farsi ($1)",["AdBlock Farsi"]),"https://raw.githubusercontent.com/finnish-easylist-addition/finnish-easylist-addition/master/Finland_adb.txt":(0,le.Z)("Finnish ($1)",["EasyList Finland"]),"https://easylist-downloads.adblockplus.org/liste_fr.txt":(0,le.Z)("French ($1)",["Liste FR"]),"https://easylist.to/easylistgermany/easylistgermany.txt":(0,le.Z)("German ($1)",["EasyList Germany"]),"https://www.void.gr/kargig/void-gr-filters.txt":(0,le.Z)("Greek ($1)",["void.gr"]),"https://raw.githubusercontent.com/easylist/EasyListHebrew/master/EasyListHebrew.txt":(0,le.Z)("Hebrew ($1)",["EasyList Hebrew"]),"https://raw.githubusercontent.com/hufilter/hufilter/master/hufilter.txt":(0,le.Z)("Hungarian ($1)",["hufilter"]),"https://adblock.gardar.net/is.abp.txt":(0,le.Z)("Icelandic ($1)",["Icelandic ABP List"]),"https://easylist-downloads.adblockplus.org/indianlist.txt":(0,le.Z)("Indian ($1)",["Indian List"]),"https://raw.githubusercontent.com/heradhis/indonesianadblockrules/master/subscriptions/abpindo.txt":(0,le.Z)("Indonesian ($1)",["ABPindo"]),"https://raw.githubusercontent.com/gioxx/xfiles/master/filtri.txt":(0,le.Z)("Italian ($1)",["X Files"]),"https://easylist-downloads.adblockplus.org/easylistitaly.txt":(0,le.Z)("Italian ($1)",["EasyList Italy"]),"https://raw.githubusercontent.com/k2jp/abp-japanese-filters/master/abpjf.txt":(0,le.Z)("Japanese ($1)",["ABP Japanese filters"]),"https://raw.githubusercontent.com/eEIi0A5L/adblock_filter/master/mochi_filter.txt":(0,le.Z)("Japanese ($1)",["もちフィルタ（広告ブロック）"]),"https://raw.githubusercontent.com/eEIi0A5L/adblock_filter/master/tamago_filter.txt":(0,le.Z)("Japanese ($1)",["たまごフィルタ（mobile filter）"]),"https://easylist-downloads.adblockplus.org/koreanlist.txt":(0,le.Z)("Korean ($1)",["Korean List"]),"https://raw.githubusercontent.com/yous/YousList/master/youslist.txt":(0,le.Z)("Korean ($1)",["YousList"]),"https://notabug.org/latvian-list/adblock-latvian/raw/master/lists/latvian-list.txt":(0,le.Z)("Latvian ($1)",["Latvian List"]),"https://raw.githubusercontent.com/EasyList-Lithuania/easylist_lithuania/master/easylistlithuania.txt":(0,le.Z)("Lithuanian ($1)",["EasyList Lithuania"]),"https://raw.githubusercontent.com/DandelionSprout/adfilt/master/NorwegianExperimentalList%20alternate%20versions/NordicFiltersABP.txt":(0,le.Z)("Nordic ($1)",["Dandelion Sprout’s Nordic Filters"]),"https://easylist-downloads.adblockplus.org/easylistpolish.txt":(0,le.Z)("Polish ($1)",["EasyList Polish"]),"https://easylist-downloads.adblockplus.org/easylistportuguese.txt":(0,le.Z)("Portuguese ($1)",["EasyList Portuguese"]),"https://www.zoso.ro/pages/rolist.txt":(0,le.Z)("Romanian ($1)",["ROLIST"]),"https://easylist-downloads.adblockplus.org/advblock.txt":(0,le.Z)("Russian ($1)",["RU AdList"]),"https://easylist-downloads.adblockplus.org/easylistspanish.txt":(0,le.Z)("Spanish ($1)",["EasyList Spanish"]),"https://secure.fanboy.co.nz/fanboy-turkish.txt":(0,le.Z)("Turkish ($1)",["Fanboy’s Turkish"]),"https://raw.githubusercontent.com/abpvn/abpvn/master/filter/abpvn.txt":(0,le.Z)("Vietnamese ($1)",["ABPVN List"])};function xM(e){return DM[e]||e}var OM;function LM(e,t,n,i){OM||(OM="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:OM,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const RM={success:(0,le.Z)("Fetched successfully"),download_failed:(0,le.Z)("Failed to download"),file_not_found:(0,le.Z)("File cannot be located"),file_read_error:(0,le.Z)("File cannot be read"),file_unsupported:(0,le.Z)("Invalid format"),failed_saving_parsed_rules:(0,le.Z)("Cannot save to the profile"),unknown:(0,le.Z)("Fetch not completed")};var BM=LM("br",{}),FM=LM("br",{});class UM extends tn.PureComponent{static contextType=dn.Z;fileInput=tn.createRef();state={blockerSources:[],sortedList:[],cachedSource:void 0,newSource:"",showEditor:0,importError:""};componentDidMount(){this.updateSources(),d.Z.contentBlocking.onRulesSourceUpdated.addListener(this.updateSources),d.Z.contentBlocking.onRuleSourceDisabled.addListener(this.updateSources),d.Z.contentBlocking.onRuleSourceEnabled.addListener(this.updateSources)}componentWillUnmount(){d.Z.contentBlocking.onRulesSourceUpdated.removeListener(this.updateSources),d.Z.contentBlocking.onRuleSourceDisabled.removeListener(this.updateSources),d.Z.contentBlocking.onRuleSourceEnabled.removeListener(this.updateSources)}updateSources=()=>{d.Z.contentBlocking.getRuleSources(this.props.ruleGroup,(e=>{this.setState({blockerSources:e,sortedList:this.remapSources(e)})})),this.state.cachedSource&&this.updateCachedSource()};updateCachedSource=()=>{this.state.cachedSource&&d.Z.contentBlocking.getRuleSource(this.props.ruleGroup,this.state.cachedSource.id,(e=>{if("unknown"!==e.last_fetch_result)return"success"!==e.last_fetch_result?(this.state.cachedSource&&this.removeSource(this.state.cachedSource.id),void this.setState({cachedSource:void 0,showEditor:1,importError:RM[e.last_fetch_result]})):void this.setState({cachedSource:e,showEditor:3,importError:""})}))};remapSources=e=>{if(e){return e.map(((e,t)=>{const n=e.unsafe_adblock_metadata,i=e.is_from_url?e.source_url:e.source_file,s=n.title&&xM(i)===i?n.title:xM(i);return{key:e.id.toString(),name:s,isDefault:e.source_url.startsWith(PM),enabled:e.loaded,id:e.id}})).sort(((e,t)=>e.name<t.name?-1:1)).sort(((e,t)=>e.isDefault&&!t.isDefault?-1:1))}return[]};updateNewSource=e=>{const{value:t}=e.currentTarget;this.setState({newSource:t})};onImportFromFile=e=>{d.Z.utilities.selectFile({windowId:this.context.vivaldiWindowId,title:(0,le.Z)("Select a Blocker List Text File"),type:"file",accepts:[{ext:"txt"}]}).then((e=>{e?this.importFromFile(e):this.closeDialog()}))};importFromFile=e=>{d.Z.contentBlocking.addKnownSourceFromFile(this.props.ruleGroup,e,(e=>this.finishImport(e)))};importFromUrl=()=>{this.state.newSource.includes(PM)?this.setState({importError:(0,le.Z)("Failed to add internal list")}):d.Z.contentBlocking.addKnownSourceFromURL(this.props.ruleGroup,this.state.newSource,(e=>this.finishImport(e)))};finishImport=e=>{y.Z.runtime.lastError?(console.warn(Object.values(y.Z.runtime.lastError)),this.setState({cachedSource:void 0,importError:(0,le.Z)("Failed to add list")})):d.Z.contentBlocking.getRuleSource(this.props.ruleGroup,e,(e=>{this.setState({cachedSource:e,showEditor:2,importError:""},(()=>{this.updateCachedSource()}))}))};onToggleStatus=e=>{this.state.sortedList[e]&&this.toggleStatus(this.state.sortedList[e].id)};toggleStatus=e=>{const t=this.state.blockerSources.find((t=>t.id===e));t&&(t.loaded?d.Z.contentBlocking.disableSource(this.props.ruleGroup,e):d.Z.contentBlocking.enableSource(this.props.ruleGroup,e))};copySource=e=>{const t=this.state.blockerSources.find((t=>e===t.id));if(t){const e=t.is_from_url?t.source_url:t.source_file;ui.Z.set(e)}};onRemoveSource=e=>{this.state.sortedList[e]&&this.removeSource(this.state.sortedList[e].id)};removeSource=e=>{d.Z.contentBlocking.deleteKnownSource(this.props.ruleGroup,e)};restoreSources=()=>{d.Z.contentBlocking.resetPresetSources(this.props.ruleGroup),this.updateSources()};onContextMenu=(e,t)=>{const n=this.state.sortedList[e];if(!n)return;const i=[{handler:this.copySource.bind(null,n.id),...(0,Mn.Z)("Copy List Origin")},{handler:this.toggleStatus.bind(null,n.id),visible:!n.enabled,...(0,Mn.Z)("Enable List")},{handler:this.toggleStatus.bind(null,n.id),visible:n.enabled,...(0,Mn.Z)("Disable List")},{...G.Z.separatorItem,visible:!n.isDefault||"ad_blocking"===this.props.ruleGroup},{handler:this.removeSource.bind(null,n.id),visible:!n.isDefault,...(0,Mn.Z)("Remove List")},{handler:this.restoreSources,visible:"ad_blocking"===this.props.ruleGroup,...(0,Mn.Z)("Restore Built-In Lists")}];(0,zi.Z)(this.context.vivaldiWindowId,i)(t)};showDialog=()=>{this.setState({showEditor:1})};onCancel=()=>{this.state.cachedSource&&this.removeSource(this.state.cachedSource.id),this.closeDialog()};closeDialog=()=>{this.setState({cachedSource:void 0,newSource:"",importError:"",showEditor:0})};renderDialog=()=>{const{cachedSource:e,showEditor:t}=this.state,n=e?e.unsafe_adblock_metadata:void 0;return LM(ln.Z,{dialogWidth:500,viewMode:"float",onRequestClose:this.state.showEditor<2?this.onCancel:Tl.default},void 0,LM("form",{className:"ContentBlocker-Exception"},void 0,LM("header",{className:"dialog-header"},void 0,LM("h1",{className:"dialog-title"},void 0,(0,le.Z)("Import New Blocker List"))),1===t&&LM("div",{className:"dialog-content"},void 0,LM("p",{className:"info"},void 0,(0,le.Z)("Enter URL to import blocker rules")),LM("div",{className:"dialog-row"},void 0,LM("input",{type:"text",value:this.state.newSource,onChange:this.updateNewSource,autoFocus:!0}),LM("label",{},void 0,LM("button",{className:"FormButton",type:"button",title:(0,le.Z)("Import from a file..."),dangerouslySetInnerHTML:{__html:cn._TQ.medium},onClick:this.onImportFromFile})))),e&&2===t&&LM("div",{className:"dialog-content"},void 0,LM("h3",{},void 0,(0,le.Z)("Loading..."))),e&&3===t&&LM("div",{className:"dialog-content"},void 0,LM("h3",{},void 0,n?n.title:e.source_url),n&&LM("p",{className:"info"},void 0,e.source_url),LM("p",{},void 0,(0,le.Z)("Valid rules: $1",[e.rules_info.valid_rules]),BM,(0,le.Z)("Invalid rules: $1",[e.rules_info.invalid_rules]),FM,(0,le.Z)("Unsupported rules: $1",[e.rules_info.unsupported_rules]))),LM("footer",{className:"dialog-footer"},void 0,this.state.importError&&LM("p",{className:"info"},void 0,this.state.importError),(1===t||2===t)&&LM("input",{type:"submit",className:"primary",onClick:this.importFromUrl,value:(0,le.Z)("Import...")}),3===t&&LM("input",{type:"submit",className:"primary",onClick:this.closeDialog,value:(0,le.Z)("blocker","Done"),autoFocus:!0}),LM("input",{type:"button",onClick:this.onCancel,value:(0,le.Z)("Cancel")}))))};renderItem=(e,t)=>{const n=this.state.blockerSources.find((e=>t.id===e.id));return n?LM("div",{className:"ContentBlocker-SourceItem"},void 0,LM("input",{type:"checkbox",onMouseDown:e=>e.stopPropagation(),checked:t.enabled,onChange:this.toggleStatus.bind(null,n.id)}),LM("span",{className:"title"},void 0,e),LM("p",{className:"info"},void 0,""!==n.rules_list_checksum?(0,le.Z)("Updated on $1",[b()(n.last_update).format("lll")]):n.loaded?(0,le.Z)("Not fetched"):(0,le.Z)("Disabled"),n.is_fetching?" "+(0,le.Z)("(Fetching...)"):"")):null};render(){const{sortedList:e}=this.state,t=Math.min(44*e.length+22,200);return LM(jE.Z,{filter:this.props.filter},void 0,0!==this.state.showEditor&&this.renderDialog(),LM("h3",{},void 0,this.props.title),LM("div",{className:"ContentBlocker-Sources master-detail sortable-list",style:{minHeight:t}},void 0,LM(MM.Z,{items:e,renderListItem:this.renderItem,filter:this.props.filter,onActivate:this.onToggleStatus,onContextMenu:this.onContextMenu,onCreateItem:this.showDialog,onRemove:this.onRemoveSource,addTipString:(0,le.Z)("Add List"),deleteTipString:(0,le.Z)("Remove List"),supportDragAndDrop:!1})))}}const VM=UM;var WM;function HM(e,t,n,i){WM||(WM="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:WM,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const zM=["tracking","ad_blocking"];class GM extends tn.PureComponent{static contextType=dn.Z;_refSelect=tn.createRef();state={exceptionRules:void 0,exceptionList:[],trackerBlockingEnabled:!1,adBlockingEnabled:!1,blockerSources:[],newException:{name:"",level:"2"},addExceptionDialog:!1,showSources:!1,incorrectFormat:!1};componentDidMount(){this.getRules(),this.updateExceptions(),d.Z.contentBlocking.onExceptionsChanged.addListener(this.updateExceptions),d.Z.contentBlocking.onStateChanged.addListener(this.getRules)}componentWillUnmount(){d.Z.contentBlocking.onExceptionsChanged.removeListener(this.updateExceptions),d.Z.contentBlocking.onStateChanged.removeListener(this.getRules)}getRules=()=>zM.forEach((e=>(0,Ww.pg)(e,(e=>{this.setState(e,(()=>this.updateExceptions()))}))));updateExceptions=()=>d.Z.contentBlocking.getAllExceptionLists((e=>{const t=Object.values(e).reduce(((e,t)=>e=e.concat(t.exempt_list).concat(t.process_list)),[]),n=this.remapExceptions((0,kI.Z)(t).sort());this.setState({exceptionRules:e,exceptionList:n})}));setDefaultBlocking=e=>{const{value:t}=e.target;switch(t){case"0":d.Z.contentBlocking.setActiveExceptionsList("tracking","process_list"),d.Z.contentBlocking.setActiveExceptionsList("ad_blocking","process_list");break;case"1":d.Z.contentBlocking.setActiveExceptionsList("tracking","exempt_list"),d.Z.contentBlocking.setActiveExceptionsList("ad_blocking","process_list");break;case"2":d.Z.contentBlocking.setActiveExceptionsList("tracking","exempt_list"),d.Z.contentBlocking.setActiveExceptionsList("ad_blocking","exempt_list")}this.getRules()};deleteException=e=>{if("number"==typeof e&&this.state.exceptionList){const t=this.state.exceptionList[e].key;["tracking","ad_blocking"].forEach((e=>["process_list","exempt_list"].forEach((n=>d.Z.contentBlocking.removeExceptionForDomain(e,n,t))))),this.updateExceptions()}};deleteAllExceptions=()=>{["tracking","ad_blocking"].forEach((e=>["process_list","exempt_list"].forEach((t=>d.Z.contentBlocking.removeAllExceptions(e,t))))),this.updateExceptions()};remapExceptions=e=>e?e.map((e=>({key:e,name:e}))):[];onContextMenu=(e,t)=>{const n=[{handler:this.deleteException.bind(null,e),...(0,Mn.Z)("Remove Site")},{handler:this.deleteAllExceptions,...(0,Mn.Z)("Remove All Sites from List")}];(0,zi.Z)(this.context.vivaldiWindowId,n)(t)};updateNewException=e=>{const t=e.currentTarget;"name"===t.name?this.setState((e=>({newException:{...e.newException,name:t.value}}))):this.setState((e=>({newException:{...e.newException,level:t.value}})))};onAddNewException=()=>this.setState({addExceptionDialog:!0});onClose=()=>this.setState((e=>({newException:{...e.newException,name:""},addExceptionDialog:!1,incorrectFormat:!1})));toggleSources=()=>this.setState((e=>({showSources:!e.showSources})));saveException=()=>{const{newException:e}=this.state,t=(0,Ni.Ph)((0,Ni.Qj)(e.name));t?((0,Ww.fs)(t,e.level),this.onClose()):this.setState({incorrectFormat:!0})};getPageBlockingLevel=e=>{const{exceptionRules:t}=this.state;if(!t)return;let n=0;return!t.tracking.process_list.includes(e)&&t.tracking.exempt_list.includes(e)||n++,!t.ad_blocking.process_list.includes(e)&&t.ad_blocking.exempt_list.includes(e)||n++,n};changePageBlocking=e=>{const{name:t,value:n}=e.target,i=z.ZP.isSettings(z.ZP.getActiveWindowId())?void 0:W.Z.getActivePage(z.ZP.getLastActiveBrowserWindowId())?.id;(0,Ww.fs)(t,n,i)};renderModal=()=>HM(ln.Z,{dialogWidth:500,onRequestClose:this.onClose,viewMode:"float"},void 0,HM("form",{className:"ContentBlocker-Exception"},void 0,HM("header",{className:"dialog-header"},void 0,HM("h1",{className:"dialog-title"},void 0,(0,le.Z)("Add a New Site to Exception List"))),HM("div",{className:"dialog-content"},void 0,HM("input",{type:"text",name:"name",placeholder:(0,le.Z)("e.g. example.com"),value:this.state.newException.name,onChange:this.updateNewException,autoFocus:!0}),this.state.incorrectFormat&&HM("p",{className:"info"},void 0,(0,le.Z)("Enter a valid domain name excluding the protocol")),HM("select",{value:this.state.newException.level,onChange:this.updateNewException,name:"level"},void 0,HM("option",{value:"0"},void 0,(0,le.Z)("No Blocking")),HM("option",{value:"1"},void 0,(0,le.Z)("Block Trackers")),HM("option",{value:"2"},void 0,(0,le.Z)("Block Trackers and Ads")))),HM("footer",{className:"dialog-footer"},void 0,HM("input",{type:"submit",className:"primary",onClick:this.saveException,value:(0,le.Z)("other","Add Site")}),HM("input",{type:"button",onClick:this.onClose,value:(0,le.Z)("Cancel")}))));onSelectItem=e=>{const{HTMLSelectElement:t}=this.context,n=this._refSelect.current?.refItems.current?.children;if(!n||0===n.length)return;const i=n[e].children[1];i instanceof t&&(this.currentSelection=i)};onActivate=(e,t)=>{t.target!==this.currentSelection&&this.currentSelection?.focus()};renderItem=(e,t)=>{if(!t)return null;const n=this.getPageBlockingLevel(t.key);return(0,fn.jsxs)(fn.Fragment,{children:[HM("span",{},void 0,e),HM("select",{value:n,name:t.name,onMouseDown:e=>e.stopPropagation(),onChange:this.changePageBlocking,tabIndex:"-1"},void 0,HM("option",{value:"0"},void 0,(0,le.Z)("No Blocking")),HM("option",{value:"1"},void 0,(0,le.Z)("Block Trackers")),HM("option",{value:"2"},void 0,(0,le.Z)("Block Trackers and Ads")))]})};render(){const e=0+(this.state.trackerBlockingEnabled?1:0)+(this.state.adBlockingEnabled?1:0);return HM(a_,{categoryTitle:(0,le.Z)("title","Tracker and Ad Blocking"),"data-anchor":"tracker_and_ad_blocking",filter:this.props.filter},void 0,this.state.addExceptionDialog&&this.renderModal(),HM("div",{className:"ContentBlocker"},void 0,HM("div",{className:"setting-group setting-group-double"},void 0,HM("h3",{},void 0,(0,le.Z)("Blocking Level")),HM("p",{className:"info"},void 0,(0,le.Z)("Select default level of protection.")),HM("label",{className:mn()({"ContentBlocker-Setting":!0,"ContentBlocker-Setting--Active":0===e})},void 0,HM("button",{value:"0",title:(0,le.Z)("No content blocking will be applied to any site by default."),onClick:this.setDefaultBlocking,className:"ContentBlocker-Control",dangerouslySetInnerHTML:{__html:cn.Tu3}}),HM("span",{className:"keep-ea-words"},void 0,(0,le.Z)("No Blocking"))),HM("label",{className:mn()({"ContentBlocker-Setting":!0,"ContentBlocker-Setting--Active":1===e})},void 0,HM("button",{value:"1",title:(0,le.Z)("Online trackers collect personal information and browsing habits across multiple sites."),onClick:this.setDefaultBlocking,className:"ContentBlocker-Control",style:{"--trackers":"1"},dangerouslySetInnerHTML:{__html:cn.Tu3}}),HM("span",{className:"keep-ea-words"},void 0,(0,le.Z)("Block Trackers"))),HM("label",{className:mn()({"ContentBlocker-Setting":!0,"ContentBlocker-Setting--Active":2===e})},void 0,HM("button",{value:"2",title:(0,le.Z)("Web advertisement supports existence of many sites but can also be used to build a personal profile for monetization."),onClick:this.setDefaultBlocking,className:"ContentBlocker-Control",style:{"--ads":"1"},dangerouslySetInnerHTML:{__html:cn.Tu3}}),HM("span",{className:"keep-ea-words"},void 0,(0,le.Z)("Block Trackers and Ads")))),HM("div",{className:"setting-group setting-group-double"},void 0,HM("h3",{},void 0,(0,le.Z)("Exceptions")),HM("p",{className:"info"},void 0,(0,le.Z)("Manage blocking level per site")),this.state.exceptionList&&HM("div",{className:"ContentBlocker-Exceptions master-detail sortable-list"},void 0,(0,fn.jsx)(MM.Z,{ref:this._refSelect,items:this.state.exceptionList,renderListItem:this.renderItem,filter:this.props.filter,onContextMenu:this.onContextMenu,onCreateItem:this.onAddNewException,onRemove:this.deleteException,addTipString:(0,le.Z)("Add Site Exception"),deleteTipString:(0,le.Z)("Remove Site Exception"),supportDragAndDrop:!1,onSelectItem:this.onSelectItem,onActivate:this.onActivate})),HM("input",{type:"button",value:this.state.showSources?(0,le.Z)("Hide Sources"):(0,le.Z)("Manage Sources"),onClick:this.toggleSources})),this.state.showSources&&(0,fn.jsxs)(fn.Fragment,{children:[HM("div",{className:"setting-group setting-group-double"},void 0,HM("div",{className:"setting-single"},void 0,HM(VM,{filter:this.props.filter,ruleGroup:"tracking",title:(0,le.Z)("Tracker Blocking Sources")}))),HM("div",{className:"setting-group setting-group-double"},void 0,HM("div",{className:"setting-single"},void 0,HM(VM,{filter:this.props.filter,ruleGroup:"ad_blocking",title:(0,le.Z)("Ad Blocking Sources")})))]})))}}const $M=GM;var KM;function jM(e,t,n,i){KM||(KM="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:KM,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class YM extends tn.Component{state={viewInfo:null,viewCookies:!1};deleteCookie=e=>{this.state.viewInfo?(this.removeChromeEntry(this.state.viewInfo),this.setState({viewCookies:Boolean(this.props.count>1),viewInfo:null})):(this.props.items.map((e=>this.removeChromeEntry(e))),this.setState({viewCookies:!1,viewInfo:null})),e.stopPropagation()};removeChromeEntry=e=>{const t={url:"http"+(e.secure?"s":"")+"://"+e.domain+e.path,name:e.name};y.Z.cookies.remove(t,(e=>{this.props.onCookieDelete(e)}))};showDetail=()=>{this.setState((e=>({viewCookies:!e.viewCookies,viewInfo:!0===e.viewCookies?null:e.viewInfo})))};showInfo=e=>{this.setState({viewInfo:e})};renderCookies=()=>this.props.items.map(((e,t)=>jM("a",{tabIndex:"0",onFocus:this.showInfo.bind(this,e)},"cookie-"+e.name.toLowerCase(),e.name)));renderInfo=()=>jM("dl",{},void 0,jM("dt",{},void 0,(0,le.Z)("Expires:")),jM("dd",{},void 0,this.state.viewInfo&&this.state.viewInfo.expirationDate&&b()(Math.round(1e3*this.state.viewInfo.expirationDate)).format("l LT")),jM("dt",{},void 0,(0,le.Z)("Path:")),jM("dd",{},void 0,this.state.viewInfo&&this.state.viewInfo.path),jM("dt",{},void 0,(0,le.Z)("Host Only:")),jM("dd",{},void 0,this.state.viewInfo&&this.state.viewInfo.hostOnly.toString()),jM("dt",{},void 0,(0,le.Z)("HTTP Only:")),jM("dd",{},void 0,this.state.viewInfo&&this.state.viewInfo.httpOnly.toString()),jM("dt",{},void 0,(0,le.Z)("Session:")),jM("dd",{},void 0,this.state.viewInfo&&this.state.viewInfo.session.toString()),jM("dt",{},void 0,(0,le.Z)("Secure:")),jM("dd",{},void 0,this.state.viewInfo&&this.state.viewInfo.secure.toString()),jM("dt",{},void 0,(0,le.Z)("Value:")),jM("dd",{},void 0,this.state.viewInfo&&this.state.viewInfo.value));render(){const{domain:e}=this.props,t=e.replace("/^./g","");return jM("li",{},void 0,jM("div",{className:"overview",onClick:this.showDetail},void 0,jM(Oi,{className:"site-icon",url:t,loadType:"page"}),e,!this.state.viewCookies&&jM("span",{className:"count"},void 0,this.props.count),jM("span",{className:"controls"},void 0,jM("input",{type:"button",className:"circular clearkey",title:this.state.viewInfo?(0,le.Z)("Delete selected cookie"):(0,le.Z)("Delete cookies"),onClick:this.deleteCookie}))),this.state.viewCookies&&jM("div",{className:"detail"},void 0,this.renderCookies(),this.state.viewInfo&&jM("div",{className:"info"},void 0,this.renderInfo())))}}const XM=YM;var QM;function qM(e,t,n,i){QM||(QM="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:QM,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class JM extends tn.PureComponent{state={cookieData:{},cookieFilter:"",confirmation:!1,showCookies:!1};componentDidMount(){this.getAllCookies()}getAllCookies=()=>{y.Z.cookies.getAll({},(e=>{this.setState({cookieData:e.reduce(((e,t)=>{var n=e[t.domain]||[];return n.push(t),e[t.domain]=n,e}),{})})}))};deleteFilteredCookies=()=>{y.Z.cookies.getAll({},(e=>{for(var t=0;t<e.length;t++)e[t].domain.toLowerCase().includes(this.state.cookieFilter.toLowerCase())&&y.Z.cookies.remove({url:this.getCookieUrl(e[t]),name:e[t].name});this.getAllCookies()}))};deleteAllCookies=()=>{var e=0;y.Z.cookies.getAll({},(n=>{e=n.length;for(var i=0;i<n.length;i++)y.Z.cookies.remove({url:this.getCookieUrl(n[i]),name:n[i].name},t)}));var t=t=>{0===--e&&this.setState({cookieData:{},confirmation:!1,showCookies:!1})}};getCookieUrl=e=>"http"+(e.secure?"s":"")+"://"+e.domain+e.path;deleteCookie=()=>{this.getAllCookies()};onSettingsFilter=e=>{this.setState({cookieFilter:e.target.value})};onAskToDelete=()=>{this.setState({confirmation:!0})};onCancel=()=>{this.setState({confirmation:!1})};renderModal=()=>qM(ln.Z,{dialogWidth:400,onRequestClose:this.onCancel},void 0,qM("div",{className:"dialog-delete-cookies"},void 0,qM("header",{className:"dialog-header"},void 0,qM("h1",{className:"dialog-title"},void 0,(0,le.Z)("Delete All Cookies?"))),qM("div",{className:"dialog-content"},void 0,qM("p",{},void 0,(0,le.Z)("All cookies will be removed."))),qM("footer",{className:"dialog-footer"},void 0,qM("input",{type:"button",className:"primary",onClick:this.deleteAllCookies,value:(0,le.Z)("other","Delete"),autoFocus:!0}),qM("input",{type:"button",onClick:this.onCancel,value:(0,le.Z)("Cancel")}))));showCookieList=()=>{this.setState((e=>({showCookies:!e.showCookies})))};render(){if(!this.state.cookieData)return qM("div",{className:"saved-passwords"},void 0,qM("p",{},void 0,(0,le.Z)("No cookies found.")));const{cookieData:e,cookieFilter:t}=this.state,n=t.toLowerCase(),i=Object.keys(e).length,s=Object.keys(e).reduce(((t,n)=>t+e[n].length),0);return qM(jE.Z,{filter:this.props.filter},void 0,qM("div",{className:"setting-group setting-cookies unlimited"},void 0,this.state.confirmation&&this.renderModal(),qM("h3",{},void 0,(0,le.Z)("Saved Cookies")),qM("p",{},void 0,(0,le.Z)("Vivaldi currently stores $1 from $2.",[(0,le.Z)("$1 cookie entry","$1 cookie entries",[s]),(0,le.Z)("$1 domain","$1 domains",[i])])),this.state.showCookies&&qM("div",{},void 0,qM("div",{className:"setting-single"},void 0,qM("input",{type:"search",placeholder:(0,le.Z)("Filter by domain"),value:t,onChange:this.onSettingsFilter})),qM("div",{className:"setting-single"},void 0,qM("ul",{},void 0,Object.keys(e).filter((e=>e.includes(n))).map((t=>qM(XM,{domain:t,count:e[t].length,items:e[t],onCookieDelete:this.deleteCookie},"domain-"+t))),0===Object.keys(e).filter((e=>e.includes(n))).length&&t&&qM("li",{style:{margin:"6px"}},void 0,(0,le.Z)("Query “$1” matches no result.",[t]))))),qM("div",{className:"setting-single"},void 0,qM("input",{type:"button",value:this.state.showCookies?(0,le.Z)("Hide Saved Cookies"):(0,le.Z)("Show Saved Cookies"),disabled:0===s,onClick:this.showCookieList}),qM("input",{type:"button",className:"danger",onClick:this.onAskToDelete,disabled:0===s,value:(0,le.Z)("Delete All Cookies")}),t&&qM("input",{type:"button",onClick:this.deleteFilteredCookies,value:(0,le.Z)("Delete Filtered Cookies")}))))}}const eP=JM;var tP;function nP(e,t,n,i){tP||(tP="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:tP,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var iP=nP("input",{type:"radio",value:"allow"}),sP=nP("input",{type:"radio",value:"session_only"}),oP=nP("input",{type:"radio",value:"block"});class aP extends tn.Component{state={cookieSetting:"",cookieMode:"off"};componentDidMount(){d.Z.utilities.getDefaultContentSettings("cookies",(e=>{this.setState({cookieSetting:e})})),d.Z.utilities.getBlockThirdPartyCookies((e=>{this.setState({cookieMode:e})}))}handleCookieModeChange=e=>{const t=e.target.value;d.Z.utilities.setBlockThirdPartyCookies(t,(e=>{})),this.setState({cookieMode:t})};handleChange=e=>{const t=e.target.value;this.setState({cookieSetting:t}),d.Z.utilities.setDefaultContentSettings("cookies",t,Tl.default)};render(){const e="block"===this.state.cookieSetting;return nP(a_,{categoryTitle:(0,le.Z)("Cookies"),filter:this.props.filter},void 0,nP("div",{className:"setting-group"},void 0,nP("h3",{},void 0,(0,le.Z)("Accept Cookies")),nP(ws,{className:"cookieSelection",name:"cookieSelGroup",value:this.state.cookieSetting,onChange:this.handleChange},void 0,nP("div",{className:"setting-single"},void 0,nP("label",{},void 0,iP,nP("span",{},void 0,(0,le.Z)("radio","All")))),nP("div",{className:"setting-single"},void 0,nP("label",{},void 0,sP,nP("span",{},void 0,(0,le.Z)("title","Session Only")))),nP("div",{className:"setting-single"},void 0,nP("label",{},void 0,oP,nP("span",{},void 0,(0,le.Z)("other","Never")))))),nP("div",{className:"setting-group"},void 0,nP("h3",{},void 0,(0,le.Z)("Third-Party Cookies")),nP("p",{className:"info"},void 0,(0,le.Z)("Disabling third party cookies might make some pages fail to work as intended.")),nP(ws,{className:"cookieSelection",name:"cookieSelGroup2",value:this.state.cookieMode,onChange:this.handleCookieModeChange},void 0,nP("div",{className:"setting-single"},void 0,nP("label",{},void 0,nP("input",{type:"radio",value:"off",disabled:e}),nP("span",{},void 0,(0,le.Z)("radio","Allow All")))),nP("div",{className:"setting-single"},void 0,nP("label",{},void 0,nP("input",{type:"radio",value:"BlockThirdPartyIncognitoOnly",disabled:e}),nP("span",{},void 0,(0,le.Z)("radio","Block In Incognito Mode Only")))),nP("div",{className:"setting-single"},void 0,nP("label",{},void 0,nP("input",{type:"radio",value:"BlockThirdParty",disabled:e}),nP("span",{},void 0,(0,le.Z)("radio","Block All")))))),nP(eP,{filter:this.props.filter}))}}const rP=aP;var lP;function dP(e,t,n,i){lP||(lP="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:lP,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const cP=[D.kDownloadDefaultDirectory,D.kDownloadsNotifyOnComplete,D.kDownloadsOpenPanelOnNew,D.kDownloadsStartAutomatically,D.kDownloadsUpdateDefaultDownloadWhenSavingAs],hP=nt.Z.getEventHandler;class pP extends tn.Component{static contextType=dn.Z;selectDownloadFolder=()=>{d.Z.utilities.selectFile({windowId:this.context.vivaldiWindowId,title:(0,le.Z)("Select Download Folder"),type:"folder"}).then((e=>{e&&nt.Z.set(D.kDownloadDefaultDirectory,e)}))};render(){return dP(a_,{categoryTitle:(0,le.Z)("Downloads"),filter:this.props.filter,className:"setting-group unlimited"},void 0,dP("div",{className:"setting-subgroup"},void 0,dP("h3",{},void 0,(0,le.Z)("Download Location")),dP("div",{className:"setting-single"},void 0,dP("div",{className:"setting-single folder-selection"},void 0,dP("input",{type:"text",value:this.props.prefValues[D.kDownloadDefaultDirectory],title:(0,le.Z)("Enter Default Download Directory Path"),onChange:hP(D.kDownloadDefaultDirectory)}),dP("input",{type:"button",value:(0,le.Z)("Select Folder..."),onClick:this.selectDownloadFolder}))),dP("div",{className:"setting-single pad-top"},void 0,dP("label",{},void 0,dP("input",{type:"checkbox",checked:this.props.prefValues[D.kDownloadsStartAutomatically],onChange:hP(D.kDownloadsStartAutomatically)}),dP("span",{},void 0,(0,le.Z)("Save Files to Default Location Without Asking")))),dP("div",{className:"setting-single"},void 0,dP("label",{},void 0,dP("input",{type:"checkbox",checked:this.props.prefValues[D.kDownloadsUpdateDefaultDownloadWhenSavingAs],onChange:hP(D.kDownloadsUpdateDefaultDownloadWhenSavingAs)}),dP("span",{},void 0,(0,le.Z)("Update Default Location When Choosing Save as Location")))),dP("div",{className:"setting-single"},void 0,dP("label",{},void 0,dP("input",{type:"checkbox",checked:this.props.prefValues[D.kDownloadsOpenPanelOnNew],onChange:hP(D.kDownloadsOpenPanelOnNew)}),dP("span",{},void 0,(0,le.Z)("Display Downloads Automatically")))),dP("div",{className:"setting-single"},void 0,dP("label",{},void 0,dP("input",{type:"checkbox",checked:this.props.prefValues[D.kDownloadsNotifyOnComplete],onChange:hP(D.kDownloadsNotifyOnComplete)}),dP("span",{},void 0,(0,le.Z)("Notify on Completed Downloads"))))))}}const uP=(0,fs.Z)(pP,cP);var gP;function mP(e,t,n,i){gP||(gP="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:gP,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const vP=nt.Z.getEventHandler,fP=[D.kMailIsTurnedOff];const yP=function(e){const t=(0,Tm.Z)(fP);return mP(a_,{categoryTitle:(0,le.Z)("Productivity Features"),filter:e.filter,"data-anchor":"features"},void 0,mP(jE.Z,{filter:e.filter},void 0,mP("div",{className:"setting-group unlimited"},void 0,mP("div",{className:"setting-single"},void 0,mP("label",{},void 0,mP("input",{type:"checkbox",checked:!t[D.kMailIsTurnedOff],onChange:vP(D.kMailIsTurnedOff,"inverse")}),mP("span",{},void 0,(0,le.Z)("Enable Mail, Calendar and Feeds")))))))};var wP;function bP(e,t,n,i){wP||(wP="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:wP,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const CP={standard:{localizedFamily:(0,le.Z)("Standard")},sansserif:{localizedFamily:(0,le.Z)("Sans-serif")},serif:{localizedFamily:(0,le.Z)("Serif")},fixed:{localizedFamily:(0,le.Z)("Monospaced")},cursive:{localizedFamily:(0,le.Z)("Cursive")},fantasy:{localizedFamily:(0,le.Z)("Fantasy")}},SP=[9,10,11,12,13,14,16,18,20,24],TP=[0,4,6,7,8,...SP],IP=[D.kWebKitDefaultFontSize,D.kWebKitMinimumFontSize],kP=nt.Z.getEventHandler;class AP extends tn.Component{state={fontList:[],fonts:{}};componentDidMount(){y.Z.fontSettings.onFontChanged.addListener(this._getFonts),y.Z.fontSettings.getFontList((e=>{this.setState({fontList:e})})),this.mapObject(CP,((e,t)=>{y.Z.fontSettings.getFont({genericFamily:e},(n=>{this.setState((i=>({fonts:{...i.fonts,[e]:{font:n.fontId,localizedFamily:t.localizedFamily}}})))}))}))}componentWillUnmount(){y.Z.fontSettings.onFontChanged.removeListener(this._getFonts)}_getFonts=e=>{this.setState((t=>({fonts:{...t.fonts,[e.genericFamily]:{font:e.fontId,localizedFamily:CP[e.genericFamily].localizedFamily}}})))};mapObject=(e,t)=>Object.keys(e).map((n=>t(n,e[n])));changeHandler=(e,t)=>{let n=D.kWebKitStandardFontFamily;switch(e){case"standard":n=D.kWebKitStandardFontFamily;break;case"fantasy":n=D.kWebKitFantasyFontFamily;break;case"fixed":n=D.kWebKitFixedFontFamily;break;case"sansserif":n=D.kWebKitSansSerifFontFamily;break;case"serif":n=D.kWebKitSerifFontFamily;break;case"cursive":n=D.kWebKitCursiveFontFamily}nt.Z.set(n,t.target.value)};renderOptions=e=>{const t="default"===e?parseInt(this.props.prefValues[D.kWebKitDefaultFontSize]):parseInt(this.props.prefValues[D.kWebKitMinimumFontSize]),n="default"===e?SP:TP;return n.includes(t)||(n.push(t),n.sort(((e,t)=>e-t))),n.map((e=>bP("option",{},e,e)))};render(){const{prefValues:e}=this.props,t=this.state.fontList.map((e=>bP("option",{value:e.fontId},e.fontId,e.displayName)));return bP(a_,{categoryTitle:(0,le.Z)("Fonts"),filter:this.props.filter,className:"setting-group unlimited"},void 0,bP("div",{className:"setting-group-double font-slider"},void 0,bP("label",{},void 0,bP("span",{},void 0,(0,le.Z)("Default Font Size")),bP("span",{className:"fake-dataset"},void 0,bP("input",{type:"number",min:"6",max:"99",value:e[D.kWebKitDefaultFontSize],onChange:kP(D.kWebKitDefaultFontSize)}),bP("select",{value:e[D.kWebKitDefaultFontSize],onChange:kP(D.kWebKitDefaultFontSize)},void 0,this.renderOptions("default")))),bP("label",{},void 0,bP("span",{},void 0,(0,le.Z)("Minimum Font Size")),bP("span",{className:"fake-dataset"},void 0,bP("input",{type:"number",min:"0",max:"99",value:e[D.kWebKitMinimumFontSize],onChange:kP(D.kWebKitMinimumFontSize)}),bP("select",{value:e[D.kWebKitMinimumFontSize],onChange:kP(D.kWebKitMinimumFontSize)},void 0,this.renderOptions("minimum"))))),bP("div",{className:"setting-group-double pad-top font-face-list"},void 0,bP("h3",{},void 0,(0,le.Z)("Default Fonts")),this.mapObject(this.state.fonts,((e,n)=>bP("label",{className:"setting-single"},e,bP("span",{},void 0,n.localizedFamily),bP("select",{onChange:this.changeHandler.bind(this,e),value:n.font},void 0,t))))))}}const ZP=(0,fs.Z)(AP,IP);var EP;function _P(e,t,n,i){EP||(EP="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:EP,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const NP=[D.kHueBridgeIp,D.kHueEnabled,D.kHueLights,D.kHueUsername];class MP extends tn.PureComponent{initialState=()=>{const{lights:e,groups:t}=N.getState();return{groups:t,lights:e,validBridge:!1,validUsername:!1,waitingForButtonPress:!1,givenUp:!1,manualIp:""}};_isMounted=!1;state=this.initialState();componentDidMount(){this._isMounted=!0,N.addListener(this.onHueStoreChanged),this.props.prefValues[D.kHueEnabled]&&this.props.prefValues[D.kHueBridgeIp]&&this.verifyBridge()}componentWillUnmount(){N.removeListener(this.onHueStoreChanged),this._isMounted=!1}onHueStoreChanged=()=>{const{lights:e,groups:t}=N.getState();this.setState({lights:e,groups:t})};verifyBridge=()=>{const e=M.Z.get(D.kHueBridgeIp);e?fetch(`http://${e}/description.xml`).then((e=>{e.ok?this.setState({validBridge:!0},this.verifyUsername):this.getBridge()})).catch((e=>{this.getBridge()})):this.getBridge()};getBridge=()=>{fetch("https://discovery.meethue.com/").then((e=>{e.ok?e.json().then((e=>{e&&e[0]&&e[0].internalipaddress?(nt.Z.set(D.kHueBridgeIp,e[0].internalipaddress),this.verifyBridge()):this.setState({givenUp:!0})})):this.setState({givenUp:!0})})).catch((e=>{this.setState({givenUp:!0})}))};setBridge=()=>{nt.Z.set(D.kHueBridgeIp,this.state.manualIp),this.verifyBridge()};verifyUsername=()=>{const e=M.Z.get(D.kHueBridgeIp),t=M.Z.get(D.kHueUsername);t?fetch(`http://${e}/api/${t}/`).then((e=>{e.ok?e.json().then((e=>{e[0]?.error?(nt.Z.set(D.kHueUsername,""),this.getUsername()):e?.config&&this.setState({validUsername:!0,waitingForButtonPress:!1},B.updateLights)})):this.setState({givenUp:!0})})).catch((e=>{this.setState({givenUp:!0})})):this.getUsername()};getUsername=()=>{const e=M.Z.get(D.kHueBridgeIp);e&&fetch(`http://${e}/api`,{method:"POST",body:JSON.stringify({devicetype:"vivaldi_browser#desktop_hue"})}).then((e=>{e.ok?e.json().then((e=>{e[0]?.success?.username?(nt.Z.set(D.kHueUsername,e[0].success.username),this.verifyUsername()):e[0]?.error&&101===e[0].error.type&&(this.setState({waitingForButtonPress:!0}),setTimeout((()=>{this._isMounted&&this.getUsername()}),1e3))})):this.setState({givenUp:!0})})).catch((e=>{this.setState({givenUp:!0})}))};toggleLight=(e,t)=>{const n=!M.Z.get(D.kHueLights).includes(t),i=M.Z.get(D.kHueLights).filter((e=>e!==t));n&&i.push(t),B.flash(e),nt.Z.set(D.kHueLights,i)};resetBridge=()=>{nt.Z.reset(D.kHueBridgeIp),nt.Z.reset(D.kHueUsername),this.setState(this.initialState())};changeManualIp=e=>{this.setState({manualIp:e.currentTarget.value})};render(){const e=this.props.prefValues[D.kHueEnabled],t=this.props.prefValues[D.kHueLights],{waitingForButtonPress:n,validBridge:i,validUsername:s,groups:o,lights:a}=this.state;return _P(a_,{categoryTitle:(0,le.Z)("Philips Hue Theme Integration"),filter:this.props.filter},void 0,_P("div",{className:"setting-group"},void 0,_P("div",{className:"setting-single"},void 0,_P("label",{},void 0,_P("input",{type:"checkbox",checked:e,onChange:nt.Z.getEventHandler(D.kHueEnabled)}),_P("span",{},void 0,(0,le.Z)("Enable Hue"))),_P("p",{className:"info"},void 0,e&&i&&!n?(0,le.Z)("Connected to Hue Bridge at $1.",[this.props.prefValues[D.kHueBridgeIp]]):(0,le.Z)("Requires a Philips Hue lighting system on the local network.")))),e&&i&&_P("div",{className:"setting-group"},void 0,_P("input",{type:"button",className:"danger",value:(0,le.Z)("Reset Bridge Connection"),onClick:this.resetBridge})),e&&(!i||n)&&_P("div",{className:"setting-group unlimited"},void 0,_P("h3",{},void 0,(0,le.Z)("Bridge Discovery")),!n&&_P("div",{className:"setting-group"},void 0,_P(Ko.Z,{type:"text",onChange:this.changeManualIp,label:(0,le.Z)("Bridge IP (Leave blank to autodiscover)"),placeholder:"127.0.0.1",value:this.state.manualIp}),_P("div",{className:"setting-single"},void 0,_P("input",{type:"button",className:"primary",value:this.state.manualIp?(0,le.Z)("Connect"):(0,le.Z)("Find Bridge"),onClick:this.state.manualIp?this.setBridge:this.getBridge}))),n&&_P("div",{className:"setting-group unlimited"},void 0,_P("p",{className:"info"},void 0,(0,le.Z)("Found Bridge at $1. Waiting for button press...",[this.props.prefValues[D.kHueBridgeIp]])),_P("div",{className:"hue-press-button",dangerouslySetInnerHTML:{__html:`${cn.I_V}${(0,le.Z)("Press the button on your Bridge")}`}}))),e&&s&&o.size>0&&a.size>0&&_P("div",{className:"setting-group unlimited"},void 0,_P("p",{className:"info"},void 0,(0,le.Z)("Only lights that support color can be selected."),"* "+(0,le.Z)("Light currently unreachable.")),[...o.keys()].map((e=>_P("div",{className:"setting-group"},e,_P("h3",{},void 0,o.get(e)?.name),o.get(e)?.lights.map((e=>{const n=a.get(e);if(!n)return null;const i=t&&t.some((e=>e===n.uniqueid)),s=n.type.toLowerCase().includes("color light");return _P("div",{className:"setting-single"},n.uniqueid,_P("label",{},void 0,_P("input",{type:"checkbox",checked:i,disabled:!s,onChange:()=>{this.toggleLight(e,n.uniqueid)}}),_P("span",{},void 0,n.name,!n.state.reachable&&"*")))})))))))}}const PP=(0,fs.Z)(MP,NP);var DP;function xP(e,t,n,i){DP||(DP="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:DP,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const OP=[D.kWebpagesAccessKeys],LP=nt.Z.getEventHandler;class RP extends tn.Component{render(){return xP(jE.Z,{filter:this.props.filter},void 0,xP("div",{className:"setting-group"},void 0,xP("h3",{},void 0,(0,le.Z)("Access Keys")),xP("div",{className:"setting-single"},void 0,xP("label",{},void 0,xP("input",{type:"checkbox",checked:this.props.prefValues[D.kWebpagesAccessKeys],onChange:LP(D.kWebpagesAccessKeys)}),xP("span",{},void 0,(0,le.Z)("Allow Access Keys"))),xP("p",{className:"info"},void 0,(0,le.Z)("Some websites may use this accessibility feature to register shortcuts for certain elements, using $1 modifier.",["Shift+Alt"])))))}}const BP=(0,fs.Z)(RP,OP),FP=function(e){switch(e){case"CATEGORY_COMMAND_APPLICATION":return(0,le.Z)("win_linux","Window");case"CATEGORY_COMMAND_APPEARANCE":return(0,le.Z)("win_linux","View");case"CATEGORY_COMMAND_TAB_ACTION":return(0,le.Z)("command","Tab");case"CATEGORY_COMMAND_WEBPAGE_NAVIGATION":return(0,le.Z)("Page");case"CATEGORY_COMMAND_MAIL":return(0,le.Z)("Mail");case"CATEGORY_COMMAND_CALENDAR":return(0,le.Z)("Calendar");case"CATEGORY_COMMAND_CHAIN":return(0,le.Z)("Chains");default:return"Unknown"}};var UP;function VP(e,t,n,i){UP||(UP="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:UP,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const WP=nt.Z.getEventHandler;class HP extends tn.Component{render(){return VP(jE.Z,{filter:this.props.filter},void 0,VP("div",{className:"setting-group"},void 0,VP("h3",{},void 0,(0,le.Z)("Keyboard Shortcuts")),VP("div",{className:"setting-single"},void 0,VP("label",{},void 0,VP("input",{type:"checkbox",checked:this.props.prefValues[D.kKeyboardShortcutsEnable],onChange:WP(D.kKeyboardShortcutsEnable)}),VP("span",{},void 0,(0,le.Z)("Enable Keyboard Shortcuts")))),VP("div",{className:"setting-single pad-left"},void 0,VP("label",{},void 0,VP("input",{type:"checkbox",checked:this.props.prefValues[D.kKeyboardShortcutsEnableSingleKey],onChange:WP(D.kKeyboardShortcutsEnableSingleKey),disabled:!this.props.prefValues[D.kKeyboardShortcutsEnable]}),VP("span",{},void 0,(0,le.Z)("Single Key Shortcuts")))),!this.props.prefValues[D.kMailIsTurnedOff]&&VP("div",{className:"setting-single pad-left"},void 0,VP("label",{},void 0,VP("input",{type:"checkbox",checked:this.props.prefValues[D.kKeyboardShortcutsEnableSingleKeyForMail],onChange:WP(D.kKeyboardShortcutsEnableSingleKeyForMail),disabled:!this.props.prefValues[D.kKeyboardShortcutsEnable]}),VP("span",{},void 0,(0,le.Z)("Mail and Calendar Single Key Shortcuts")))),VP("div",{className:"setting-single"},void 0,VP("label",{},void 0,VP("input",{type:"checkbox",checked:this.props.prefValues[D.kKeyboardShortcutsSpaceFastForwards],onChange:WP(D.kKeyboardShortcutsSpaceFastForwards)}),VP("span",{},void 0,(0,le.Z)("Space Key to Fast Forward")))),VP("div",{className:"setting-single"},void 0,VP("label",{},void 0,VP("input",{type:"checkbox",checked:this.props.prefValues[D.kKeyboardShortcutsAltOpensMenu],onChange:WP(D.kKeyboardShortcutsAltOpensMenu)}),VP("span",{},void 0,(0,le.Z)("Alt Key for Main Menu"))))))}}const zP=HP;var GP;function $P(e,t,n,i){GP||(GP="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:GP,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const KP=[D.kKeyboardTabToAll,D.kKeyboardTabToAllUsesSystemDefault,D.kWebpagesFocusTrap],jP=nt.Z.getEventHandler;var YP=$P("input",{type:"radio",value:"1"}),XP=$P("input",{type:"radio",value:"0"});class QP extends tn.Component{handleDarwinKeyAccess=e=>{const t=M.Z.get(D.kSystemMacKeyboardUiMode),n=e.target&&e.target.checked;n||-1===this.props.prefValues[D.kKeyboardTabToAll]?n&&2===t&&0!==this.props.prefValues[D.kKeyboardTabToAll]?nt.Z.set(D.kKeyboardTabToAll,0):n&&0===t&&-1!==this.props.prefValues[D.kKeyboardTabToAll]&&nt.Z.set(D.kKeyboardTabToAll,-1):nt.Z.set(D.kKeyboardTabToAll,-1),nt.Z.set(D.kKeyboardTabToAllUsesSystemDefault,n)};renderFullKeyboardAccess=()=>$P("div",{className:"setting-group"},void 0,$P("h3",{},void 0,(0,le.Z)("Full Keyboard Access")),!1,$P(ws,{name:"keyAccessSetting",className:"setting-single",value:this.props.prefValues[D.kKeyboardTabToAll],onChange:jP(D.kKeyboardTabToAll)},void 0,$P("label",{},void 0,$P("input",{type:"radio",value:"0",disabled:this.props.prefValues[D.kKeyboardTabToAllUsesSystemDefault]}),$P("span",{},void 0,(0,le.Z)("Focus All Controls"))),$P("p",{className:"info"},void 0,(0,le.Z)("Press TAB key to focus all controls")),$P("label",{},void 0,$P("input",{type:"radio",value:"-1",disabled:this.props.prefValues[D.kKeyboardTabToAllUsesSystemDefault]}),$P("span",{},void 0,(0,le.Z)("Focus Input"))),$P("p",{className:"info"},void 0,(0,le.Z)("Press TAB key to focus text boxes and lists only"))));onFocusCyclingChanged=e=>{const t="1"===e.target.value;nt.Z.set(D.kWebpagesFocusTrap,t)};renderFocusCycling=()=>$P("div",{className:"setting-group"},void 0,$P("h3",{},void 0,(0,le.Z)("Focus Cycling")),$P(ws,{name:"toolbarFocusCycling",className:"setting-single",value:this.props.prefValues[D.kWebpagesFocusTrap]?"1":"0",onChange:this.onFocusCyclingChanged},void 0,$P("label",{},void 0,YP,$P("span",{},void 0,(0,le.Z)("Cycle in Component"))),$P("p",{className:"info"},void 0,(0,le.Z)("TAB key focus is bound to individual toolbars or webpage")),$P("label",{},void 0,XP,$P("span",{},void 0,(0,le.Z)("Cycle All"))),$P("p",{className:"info"},void 0,(0,le.Z)("TAB key focus cycles through whole application"))));render(){return $P(jE.Z,{filter:this.props.filter},void 0,this.renderFocusCycling(),this.renderFullKeyboardAccess())}}const qP=(0,fs.Z)(QP,KP);var JP,eD=n(46601);function tD(e,t,n,i){JP||(JP="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:JP,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const nD=[D.kMailIsTurnedOff,D.kChainedCommandsCommandList,D.kKeyboardShortcutsAltOpensMenu,D.kKeyboardShortcutsEnable,D.kKeyboardShortcutsEnableSingleKey,D.kKeyboardShortcutsEnableSingleKeyForMail,D.kKeyboardShortcutsSpaceFastForwards];class iD extends tn.Component{state={commandArray:U.Z.getSettingsList(!1),openCategories:["CATEGORY_COMMAND_APPLICATION"],confirmation:!1,hideFullKeyAccess:0,hideConfigureSingleKeyShortcut:0,shouldHideKeyboardShortcuts:!1,keyboardShortcutFilter:""};componentDidMount(){U.Z.addListener(this._onStoreChange),r.Z.addListener(this._onStoreChange),M.Z.addListener(D.kMailIsTurnedOff,this._onStoreChange)}_onStoreChange=()=>{this.setState({commandArray:U.Z.getSettingsList(!1)})};componentWillUnmount(){U.Z.removeListener(this._onStoreChange),r.Z.removeListener(this._onStoreChange),M.Z.removeListener(D.kMailIsTurnedOff,this._onStoreChange)}componentDidUpdate(e){this.props.filter!==e.filter&&this.setState({keyboardShortcutFilter:""})}switchCategory=e=>{this.setState((0,E.Uy)((t=>{const n=t.openCategories;n.indexOf(e)>-1?n.splice(n.indexOf(e),1):n.push(e)})))};confirmRestoreKeys=()=>{this.setState({confirmation:!0})};restoreKeys=()=>{a.Z.restoreShortcuts(),this.setState({confirmation:!1})};onCancel=()=>{this.setState({confirmation:!1})};renderModal=()=>tD(ln.Z,{dialogWidth:400,onRequestClose:this.onCancel},void 0,tD("div",{className:"dialog-restore-shortcuts"},void 0,tD("header",{className:"dialog-header"},void 0,tD("h1",{className:"dialog-title"},void 0,(0,le.Z)("Restore Keyboard Shortcuts?"))),tD("div",{className:"dialog-content"},void 0,tD("p",{},void 0,(0,le.Z)("All keyboard shortcuts will be restored to default."))),tD("footer",{className:"dialog-footer"},void 0,tD("input",{type:"button",className:"danger",onClick:this.restoreKeys,value:(0,le.Z)("Restore")}),tD("input",{type:"button",onClick:this.onCancel,value:(0,le.Z)("Cancel"),autoFocus:!0}))));renderKeyboardCommandCategories=(e,t)=>{const n=e.reduce(((e,t)=>(e[t.category]=(e[t.category]||[]).concat(t),e)),{}),i=Object.keys(n).map(((e,i)=>this.renderKeyboardCommandCategory(e,n[e],t)));return i.length>0?tD("div",{className:"setting-single"},void 0,tD("div",{className:"keystrokes"},void 0,i),!this.props.filter&&"read-only"!==this.props.view&&tD("input",{type:"button",onClick:this.confirmRestoreKeys,value:(0,le.Z)("Restore Default Keys")})):null};renderKeyboardCommandCategory=(e,t,n)=>{const i=FP(e);return tD("div",{className:"category "+(n||this.state.openCategories.indexOf(e)>-1?"show":"hide")},e,tD("button",{onClick:this.switchCategory.bind(this,e)},void 0,(0,js.CH)(i,n)),tD("div",{className:"list"},void 0,t.map(((e,t)=>this.renderCommandKeys(e,t,n)))))};renderCommandKeys=(e,t,n)=>{const i=!this.props.prefValues[D.kKeyboardShortcutsEnable],s=!this.props.prefValues[D.kKeyboardShortcutsEnableSingleKey];if("read-only"===this.props.view)return tD("div",{className:"keycombo"},t,tD("label",{},void 0,(0,js.CH)(e.label,n)),e.shortcuts&&e.shortcuts.map(((e,t)=>[tD("span",{title:i?(0,le.Z)("Keyboard Shortcuts are disabled"):1===e.length&&s?(0,le.Z)("Single Key Shortcuts are disabled"):""},t,tD("input",{type:"button",disabled:!0,className:e.length>1?"item regular":"item single",value:(0,Rd.$)(e)}))])));if(!(0,eD.os)(e.name)){const t=e.name.toLowerCase();return tD("div",{className:"keycombo"},t,tD("label",{htmlFor:"combo-"+t},void 0,(0,js.CH)(e.label,this.props.filter)),tD(Hd,{prefValues:this.props.prefValues,id:"combo-"+t,commandArray:this.state.commandArray,command:e},t))}return null};renderListOfKeyboardCommands=e=>{let t=[];if(t="read-only"===this.props.view?this.state.commandArray.filter((e=>Boolean(e.shortcuts&&e.shortcuts.length>0))):this.state.commandArray,e){const n=this.tokenize(e);t=t.filter((t=>{if((t.label||t.name).toLowerCase().indexOf(e.toLowerCase())>-1)return!(0,eD.os)(t.name);return(t.shortcuts||[]).some((e=>{const t=this.tokenize(e);return Lk(n,t)}))}))}return t.length>0?tD("div",{className:"keyboard-shortcut-list"},void 0,e&&tD("header",{},void 0,tD("h3",{},void 0,(0,le.Z)("Showing all keyboard shortcut entries matching $1.",[e]))),this.renderKeyboardCommandCategories(t,e)):null};tokenize=e=>new Set(e.match(/[^,\s\+]+/g)||[]);render(){const e=this.state.keyboardShortcutFilter||this.props.filter;if("read-only"===this.props.view)return this.renderListOfKeyboardCommands(e);const{prefValues:t}=this.props;return tD(a_,{categoryTitle:(0,le.Z)("Keyboard"),className:mn()({"keyboard-shortcut-list":!0,singlekeydisabled:!t[D.kKeyboardShortcutsEnableSingleKey],singlekeydisabledfeatures:!t[D.kKeyboardShortcutsEnableSingleKeyForMail]}),filter:this.props.filter},void 0,this.state.confirmation&&this.renderModal(),tD(qP,{filter:this.props.filter}),tD(BP,{filter:this.props.filter}),tD(zP,{filter:this.props.filter,prefValues:t}),this.renderListOfKeyboardCommands(e))}}const sD=(0,fs.Z)(iD,nD);var oD,aD=n(9761),rD=n(49269);function lD(e,t,n,i){oD||(oD="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:oD,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const dD=[D.kTranslateEnabled],cD=nt.Z.getEventHandler;class hD extends tn.PureComponent{static contextType=dn.Z;_isMounted=!1;state={language:y.Z.i18n.getUILanguage(),acceptLangs:[],acceptLangsList:[]};componentDidMount(){this._isMounted=!0,y.Z.languageSettingsPrivate.getLanguageList((e=>{if(y.Z.runtime.lastError)console.error(y.Z.runtime.lastError.message);else if(this._isMounted){const t=[];for(const n of e){if(n.code===n.nativeDisplayName){const e=aD.lE.find((e=>e.key===n.code));if(!e)continue;n.nativeDisplayName=e.local}t.push(n)}this.setState({acceptLangsList:t.sort(((e,t)=>e.code.localeCompare(t.code))).map((e=>({key:e.code,value:e.nativeDisplayName})))})}})),this.updateAcceptedList()}componentWillUnmount(){this._isMounted=!1}updateAcceptedList=()=>{y.Z.i18n.getAcceptLanguages((e=>{y.Z.runtime.lastError?(console.error(y.Z.runtime.lastError.message),this._isMounted&&this.setState({acceptLangs:[]})):this._isMounted&&this.setState({acceptLangs:e})}))};onContextMenu=(e,t)=>{const n=[];e>=0&&e<this.state.acceptLangs.length&&(n.push({...(0,Mn.Z)("Move to Top"),handler:this.moveItemToTop.bind(this,e),visible:0!==e}),n.push({...(0,Mn.Z)("Move Up"),handler:this.moveItem.bind(this,e,e-1),visible:e>1}),n.push({...(0,Mn.Z)("Move Down"),handler:this.moveItem.bind(this,e,e+1),visible:e!==this.state.acceptLangs.length-1}),n.push({...(0,Mn.Z)("verb","Remove"),handler:this.removeItem.bind(this,e),visible:this.state.acceptLangs[e]!==this.state.language&&this.state.acceptLangs.length>1})),(0,zi.Z)(this.context.vivaldiWindowId,n)(t)};addItem=e=>{if(e&&e.target){const t=e.target.value;y.Z.languageSettingsPrivate.enableLanguage(t),this.updateAcceptedList()}};moveItem=(e,t)=>{const n=t<e?"UP":"DOWN",i=Math.abs(e-t);(0,rD.Z)(i,(()=>{y.Z.languageSettingsPrivate.moveLanguage(this.state.acceptLangs[e],n)})),this.updateAcceptedList()};moveItemToTop=e=>{y.Z.languageSettingsPrivate.moveLanguage(this.state.acceptLangs[e],"TOP"),this.updateAcceptedList()};removeItem=e=>{this.state.acceptLangs.length<=1||(y.Z.languageSettingsPrivate.disableLanguage(this.state.acceptLangs[e]),this.updateAcceptedList())};resetToDefault=()=>{nt.Z.reset(D.kAcceptLanguages),this.updateAcceptedList()};resetTranslationSettingsToDefault=()=>{d.Z.prefs.resetTranslationPrefs()};remapLangs=()=>this.state.acceptLangs.map((e=>({key:e,name:e,isDefault:e===this.state.language||this.state.acceptLangs.length<=1})));renderItem=(e,t)=>lD("span",{},void 0,e);render(){const e=this.state.acceptLangsList.filter((e=>!this.state.acceptLangs.includes(e.key)));return e.unshift({key:"",value:(0,le.Z)("Select Language")}),lD(jE.Z,{filter:this.props.filter},void 0,lD("div",{className:"setting-group accept-language-list"},void 0,lD("div",{className:"setting-single"},void 0,lD("h3",{},void 0,(0,le.Z)("Accept Languages")),lD("p",{className:"info"},void 0,(0,le.Z)("Preferred languages, accepted by compatible websites in given order")),this.state.acceptLangsList.length>0?(0,fn.jsxs)(fn.Fragment,{children:[lD("div",{className:"master-detail sortable-list"},void 0,lD(MM.Z,{items:this.remapLangs(),filter:this.props.filter,onCreateItem:this.addItem,moveItem:this.moveItem,onRemove:this.removeItem,onContextMenu:this.onContextMenu,renderListItem:this.renderItem,optionsList:e,addTipString:(0,le.Z)("Add Language"),deleteTipString:(0,le.Z)("Remove Language"),supportDragAndDrop:!0,mimeType:"vivaldi/x-settings-accept-langage"})),lD("input",{type:"button",value:(0,le.Z)("Reset to Default"),onClick:this.resetToDefault})]}):lD("p",{},void 0,(0,le.Z)("Language list retrieval for “$1” failed",[this.state.language]))),lD("div",{className:"setting-single offer-translate"},void 0,lD("label",{},void 0,lD("input",{type:"checkbox",checked:this.props.prefValues[D.kTranslateEnabled],onChange:cD(D.kTranslateEnabled)}),lD("span",{},void 0,lD("h3",{},void 0,(0,le.Z)("Automatically Offer to Translate Pages")))),lD("p",{className:"info"},void 0,(0,le.Z)("When unchecked, translation popup and automatic translations will be disabled. Translation can still be manually triggered on each page.")),lD("input",{type:"button",value:(0,le.Z)("Reset Translation Settings to Default"),onClick:this.resetTranslationSettingsToDefault}))))}}const pD=(0,fs.Z)(hD,dD);var uD;function gD(e,t,n,i){uD||(uD="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:uD,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const mD=[D.kCalendarDateFormat,D.kCalendarStartOfWeek,D.kCalendarWeekNumberRule],vD=nt.Z.getEventHandler;class fD extends tn.Component{locales=[...aD.lE].sort(((e,t)=>e.local.localeCompare(t.local)));_isMounted=!1;state={initialLanguage:"",language:"",confirmation:!1,localMoment:F.ZP.getLocale()};componentDidMount(){this._isMounted=!0,d.Z.utilities.getLanguage((e=>{this._isMounted&&this.setState({language:e,initialLanguage:e})})),this.updateFormatPreview()}componentDidUpdate(e,t){const n=this.props.prefValues,i=e.prefValues;n[D.kCalendarDateFormat]===i[D.kCalendarDateFormat]&&n[D.kCalendarStartOfWeek]===i[D.kCalendarStartOfWeek]&&n[D.kCalendarWeekNumberRule]===i[D.kCalendarWeekNumberRule]||this.updateFormatPreview()}componentWillUnmount(){this._isMounted=!1}langChanged=e=>{const t=e.currentTarget.selectedOptions[0].dataset.lang;this.setState({language:t})};saveLanguage=()=>{d.Z.utilities.setLanguage(this.state.language,(()=>{this.setState((e=>({initialLanguage:e.language,confirmation:!1})))}))};saveDateFormat=e=>{const t=e.target.value;nt.Z.set(D.kCalendarDateFormat,t)};updateFormatPreview=()=>{d.Z.utilities.getSystemDateFormat((e=>{this._isMounted&&this.setState({localMoment:F.ZP.getLocale(e)})}))};confirmLanguageChange=()=>{this.setState({confirmation:!0})};onCancel=()=>{this.setState((e=>({language:e.initialLanguage,confirmation:!1})))};renderModal=()=>{const e=this.locales.find((e=>e.key===this.state.language));return e?gD(ln.Z,{dialogWidth:400,onRequestClose:this.onCancel},void 0,gD("div",{className:"dialog-restore-shortcuts"},void 0,gD("header",{className:"dialog-header"},void 0,gD("h1",{className:"dialog-title"},void 0,(0,le.Z)("Save New Language?"))),gD("div",{className:"dialog-content"},void 0,gD("p",{},void 0,(0,le.Z)("Vivaldi user interface language will be set to:")),gD("p",{},void 0,gD("strong",{},void 0,e.local+(e.value!==e.local?" – "+e.value:""))),gD("p",{},void 0,(0,le.Z)("Browser restart is required for new setting to take effect."))),gD("footer",{className:"dialog-footer"},void 0,gD("input",{type:"button",className:"danger",onClick:this.saveLanguage,value:(0,le.Z)("Save Language")}),gD("input",{type:"button",onClick:this.onCancel,value:(0,le.Z)("Cancel"),autoFocus:!0})))):null};render(){const e=b()(),{longDateFormat:t,week:n,weekdays:i}=this.state.localMoment;return e.localeData()._week=this.state.localMoment.week,gD(a_,{categoryTitle:(0,le.Z)("Language"),"data-anchor":"language",filter:this.props.filter},void 0,this.state.confirmation&&this.renderModal(),gD("p",{className:"info"},void 0,(0,le.Z)("These settings require a restart to take full effect.")),gD("form",{className:"setting-group",onSubmit:this.confirmLanguageChange},void 0,gD("h3",{},void 0,(0,le.Z)("User Interface Language")),gD("div",{className:"setting-single"},void 0,gD("select",{onChange:this.langChanged,value:this.state.language.toLowerCase()},void 0,this.locales.map((e=>gD("option",{value:e.key.toLowerCase(),"data-lang":e.key},e.key,e.local+(e.value!==e.local?" – "+e.value:""))))),gD("input",{type:"submit",className:"primary",disabled:this.state.language===this.state.initialLanguage,value:(0,le.Z)("Save Language")}))),gD("div",{className:"setting-group"},void 0,gD("div",{className:"setting-single"},void 0,gD("h3",{},void 0,(0,le.Z)("Preferred Date & Time Format")),gD("p",{className:"info"},void 0,(0,le.Z)("Affects beginning day of week, time and date display format.")),gD("select",{value:this.props.prefValues[D.kCalendarDateFormat],onChange:this.saveDateFormat},void 0,gD("option",{value:"system"},void 0,(0,le.Z)("Inherit from Operating System")),gD("option",{value:"language"},void 0,(0,le.Z)("Same as Selected Language")))),gD("div",{className:"setting-single"},void 0,gD("h3",{},void 0,(0,le.Z)("Week Starts On")),gD("label",{},void 0,gD("select",{name:"week_starts",value:this.props.prefValues[D.kCalendarStartOfWeek],onChange:vD(D.kCalendarStartOfWeek)},void 0,gD("option",{value:"system"},void 0,(0,le.Z)("System Default")),gD("option",{value:"sunday"},void 0,(0,le.Z)("Sunday")),gD("option",{value:"monday"},void 0,(0,le.Z)("Monday")),gD("option",{value:"tuesday"},void 0,(0,le.Z)("Tuesday")),gD("option",{value:"wednesday"},void 0,(0,le.Z)("Wednesday")),gD("option",{value:"thursday"},void 0,(0,le.Z)("Thursday")),gD("option",{value:"friday"},void 0,(0,le.Z)("Friday")),gD("option",{value:"saturday"},void 0,(0,le.Z)("Saturday"))))),gD("div",{className:"setting-single"},void 0,gD("h3",{},void 0,(0,le.Z)("First Week Number")),gD("label",{},void 0,gD("select",{name:"week_number_rule",value:this.props.prefValues[D.kCalendarWeekNumberRule],onChange:vD(D.kCalendarWeekNumberRule)},void 0,gD("option",{value:"4"},void 0,(0,le.Z)("First 4 Day Week (ISO8601)")),gD("option",{value:"1"},void 0,(0,le.Z)("First Week in Calendar Year")),gD("option",{value:"7"},void 0,(0,le.Z)("First Whole Week"))))),gD("dl",{className:"info",style:{display:"grid",gridTemplateColumns:"auto 1fr",gridGap:"2px 8px",margin:"12px 0"}},void 0,gD("dt",{},void 0,(0,le.Z)("Time Format")),gD("dd",{},void 0,e.format(t.LT)),gD("dt",{},void 0,(0,le.Z)("Short Date")),gD("dd",{},void 0,e.format(t.L)),gD("dt",{},void 0,(0,le.Z)("Long Date")),gD("dd",{},void 0,e.format(t.LLLL)),gD("dt",{},void 0,(0,le.Z)("Start of Week")),gD("dd",{},void 0,i[n.dow]),gD("dt",{},void 0,(0,le.Z)("Week Number")),gD("dd",{},void 0,e.week()))),gD(pD,{filter:this.props.filter}))}}const yD=(0,fs.Z)(fD,mD);var wD,bD=n(55351),CD=n(79706),SD=n(88545);function TD(e,t,n,i){wD||(wD="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:wD,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const{isCalDAV:ID,getPassword:kD,savePassword:AD,deletePassword:ZD}=oc.Z,{UNKNOWN:ED,VERIFYING:_D,OK:ND,ERROR:MD}=yc.LB;class PD extends tn.Component{constructor(e){super(e),this.state={status:ED,statusText:"",password:"",passwordChanged:!1,name:e.account.name,username:e.account.username,url:e.account.url,refreshing:!1}}componentDidMount=()=>{const{url:e,username:t}=this.state;e&&t&&kD(e,t).then((e=>{e.found&&this.setState({password:e.password})}))};probeAccounts=async()=>{const{account:e}=this.props,{account_type:t}=e,{password:n}=this.state;let i={foundService:!1,statusText:""};if(this.logStatus((0,le.Z)("Verifying..."),_D),"ical"===t){i=await CD.Z.probeWebCalendar(this.getAccount(),n);const{foundService:e,eventCount:t}=i;if(e)return this.logStatus((0,le.Z)("Connected to Web Calendar. Found $1 Event(s)",[t]),ND),e}else if("google"===t)i=await(0,SD.P)(this.getAccount(),n);else{if(!this.state.password)return this.logStatus((0,le.Z)("Password Missing..."),MD),!1;i=await(0,SD.P)(this.getAccount(),n)}return i.foundService?(this.logStatus((0,le.Z)("Connected to CalDAV. Found $1 Calendar(s)",[i.calendars.length]),ND),bD.Z.resetStatus(this.props.account.name)):this.logStatus((0,le.Z)("Not connected. $1",[i.statusMessage||""]),MD),i.foundService};isAccountChanged=()=>this.state.name!==this.props.account.name||this.state.username!==this.props.account.username||this.state.url!==this.props.account.url||this.state.passwordChanged;onChangeCredentials=e=>{const t=e.target.value,n=this.state.url,i=this.state.username;this.setState({password:t,passwordChanged:!0,status:ED});const{urlValid:s}=d.Z.utilities.isUrlValid(n);s?(this.logStatus("",ED),AD(n,i,t).then((e=>{e.result||this.logStatus(e.message,MD)}))):this.logStatus((0,le.Z)("Invalid URL"),_D)};getAccount=()=>({id:this.props.account.id,name:this.state.name,username:this.state.username,url:this.state.url,account_type:this.props.account.account_type});logStatus=(e,t)=>{this.setState({status:t,statusText:e})};saveAccount=async()=>{let e=!0;const{account_type:t}=this.props.account;"local"!==t&&(e=await this.probeAccounts()),this.setState({passwordChanged:!1},(()=>{e&&this.props.saveAccount(this.getAccount())}))};changeName=e=>{const t=e.target.value;this.setState({name:t})};changeUrl=e=>{const t=e.target.value;this.setState({url:t},(()=>{const{urlValid:e}=d.Z.utilities.isUrlValid(t);e?this.logStatus("",ED):this.logStatus((0,le.Z)("Invalid URL"),_D)}))};changeUsername=e=>{const t=e.target.value;t!==this.state.username&&(ZD(this.state.url,this.state.username),this.setState({username:t},(()=>{AD(this.state.url,t,this.state.password).then((e=>{e.result||this.logStatus(e.message,MD)}))})))};render(){const{name:e,url:t,account_type:n,username:i}=this.getAccount(),{password:s}=this.state,o=this.state.status===MD?"error":this.state.status===ND?"success":"info";return TD("form",{className:"detail",onSubmit:this.saveAccount},void 0,TD("div",{className:"detail-content"},void 0,TD("div",{className:"setting-group"},void 0,TD("div",{className:"setting-single"},void 0,TD(Ko.Z,{type:"text",onChange:this.changeName,label:this.props.searchableStrings.Name,value:e}))),"local"!==n&&TD("div",{className:"setting-group"},void 0,TD("div",{className:"setting-single"},void 0,TD(Ko.Z,{type:"text",onChange:this.changeUrl,label:this.props.searchableStrings.URL,value:t}))),(ID(n)||"ical"===n)&&TD("div",{className:"setting-group"},void 0,TD("div",{className:"setting-single"},void 0,TD(Ko.Z,{type:"text",onChange:this.changeUsername,name:"username",label:this.props.searchableStrings.Username,value:i}))),["vivaldi","caldav","ical"].includes(n)&&TD("div",{className:"setting-group"},void 0,TD("div",{className:"setting-single"},void 0,TD(Ko.Z,{type:"password",onChange:this.onChangeCredentials,name:"password",label:this.props.searchableStrings.Password,value:s}))),this.state.statusText&&TD("div",{className:"setting-group-double"},void 0,TD(Tr,{type:o},void 0,this.state.statusText))),TD("div",{className:"detail-toolbar"},void 0,TD("input",{type:"submit",value:(0,le.Z)("Save"),disabled:!this.isAccountChanged()}),"local"!==n&&TD("input",{type:"button",onClick:this.probeAccounts,value:(0,le.Z)("Test")})))}}const DD=PD;var xD=n(1712);const OD=tn.createContext({editor:{pageId:NaN},displayDensity:"full",isActivePage:!1,isPanel:!1});const LD=function(e,t){const[n,i]=tn.useState((()=>Lo.Z.getCalendarState(e,t)));return tn.useEffect((()=>{const t=(t,n)=>{e>0&&void 0!==n&&n>0&&n!==e||i(Lo.Z.getCalendarState(e))};return Lo.Z.addListener(t),()=>{Lo.Z.removeListener(t)}}),[e]),n};var RD,BD=n(34155);function FD(e,t,n,i){RD||(RD="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:RD,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const UD=[D.kCalendarDisplayDensity];const VD=function(e,t){return tn.forwardRef((function(n,i){const{windowId:s,pageId:a}=n,r=LD(a,t),l=(0,Tm.Z)(UD),[d,c]=tn.useState(W.Z.getActivePage(s)?.id===a),h=tn.useMemo((()=>({pageId:a,uid:r.editor.uid})),[a,r.editor.uid]);tn.useEffect((()=>{let e=!0;const t=()=>{e&&c(W.Z.getActivePage(s)?.id===a)};return W.Z.addListener(t),()=>{e=!1,W.Z.removeListener(t),BD.nextTick((()=>o.Z.saveEventEdit(s,h)))}}),[h,s,a]);const p=l[D.kCalendarDisplayDensity],u=tn.useMemo((()=>({editor:h,displayDensity:p,isActivePage:d,isPanel:!1})),[h,p,d]);return FD(OD.Provider,{value:u},void 0,(0,fn.jsx)(e,{...n,ref:i,...r}))}))};var WD;function HD(e,t,n,i){WD||(WD="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:WD,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const{createLocalAccountAndCalendar:zD}=xD.Z,{ensureAccountType:GD,isCalDAV:$D,ensureHttpsForWebcal:KD}=oc.Z,{UNKNOWN:jD,VERIFYING:YD,OK:XD,ERROR:QD}=yc.LB;function qD(e){switch(e){case"vivaldi":return(0,le.Z)("user@vivaldi.net");case"google":return(0,le.Z)("user@gmail.com");default:return""}}function JD(e,t="vivaldi"){return{status:jD,statusText:"",name:(0,le.Z)("New Account"),url:"",account_type:t,username:"",password:"",step:"accountType",initial:e,requestPending:!1,calendars:[]}}var ex=HD("img",{src:"/resources/vivaldi_calendar_default.png",alt:"",width:"64",height:"64"});class tx extends tn.Component{static contextType=dn.Z;state=JD(!0,this.props.onboarding?"local":"vivaldi");account=null;changeType=e=>{const t=GD(e);t!==this.state.account_type?this.setState({account_type:t,url:"",username:"",password:""}):this.setState({account_type:t})};handleChange=e=>{const{target:{name:t,value:n}}=e;this.setState({[t]:n})};toggleCalendarState=(e,t,n)=>{this.setState((i=>{const s=[...i.calendars];return s[t]={...s[t],[n]:e.target.checked},{calendars:s}}))};selectAccountType=()=>{const e=xD.Z.getLocalAccount();"local"===this.state.account_type&&e?(this.account=e,this.setState({step:"done"})):this.setState({step:"accountInfo"})};goBack=()=>{"accountInfo"===this.state.step?this.setState({step:"accountType",statusText:"",status:jD}):"accountSummary"===this.state.step&&(this.account=null,this.setState({step:"accountInfo",calendars:[]}))};addAnother=()=>{this.account=null,this.setState(JD(!1))};createAccount=async()=>{const{name:e,url:t,account_type:n,username:i}=this.state;let s;if($D(n))s=await this.createCalDAVAccount();else if("ical"===n)s=await this.createWebCalendar();else if("local"===n)try{({account:s}=await zD({name:e,url:t,account_type:n,username:i},null)),this.setState({step:"done"})}catch(e){this.log((0,le.Z)("Error creating local calendar.")+String(e?.message||e),QD)}s&&(this.account=s)};log=(e,t,n)=>{const i=n?{username:n.username,name:n.name}:{};this.setState({...i,statusText:e,status:t})};createWebCalendar=async()=>{this.log((0,le.Z)("Verifying..."),YD),this.setState({requestPending:!0});const{name:e,account_type:t,username:n,password:i}=this.state;let{url:s}=this.state;s.startsWith("webcal")&&(s=KD(s),this.setState({url:s}));const o={id:"",name:e,url:s,account_type:t,username:n,interval:yc.jC},{foundService:a,statusMessage:r,eventCount:l,calendars:d}=await CD.Z.probeWebCalendar(o,i);return!a&&r?(this.log(r,QD),this.setState({requestPending:!1})):(this.log((0,le.Z)("Connected to Web Calendar, found $1 event(s).",[l]),XD),this.setState({step:"accountSummary",calendars:d,requestPending:!1})),o};createCalDAVAccount=async()=>{this.log((0,le.Z)("Verifying..."),YD),this.setState({requestPending:!0});const{name:e,url:t,account_type:n,username:i,password:s}=this.state,{account:o,calendars:a}=await bD.Z.getCalDAVAccountDetails({name:e,url:t,account_type:n,username:i,password:s},this.log);if(this.state.status!==QD){for(const e of a)e.active=!0;this.account=o,this.setState({step:"accountSummary",calendars:a,requestPending:!1})}else this.setState({requestPending:!1})};saveAccount=async()=>{const e=this.account;e&&"local"!==e.account_type&&(this.setState({requestPending:!0}),await bD.Z.saveCalendarAccount({account:e,calendars:this.state.calendars,password:this.state.password},this.log),this.setState({requestPending:!0,step:"done"}))};render(){const{name:e,url:t,account_type:n,username:i}=this.state,{password:s}=this.state,o=["vivaldi","google","caldav","ical"];(!xD.Z.getLocalAccount()||this.props.onboarding&&this.state.initial)&&o.unshift("local");const a=this.state.status===QD?"error":this.state.status===XD?"success":"info";let r;if("accountInfo"===this.state.step)switch(this.state.account_type){case"vivaldi":r=(0,le.Z)("Vivaldi.net account, OK - now enter your login details below and let us fetch your calendars.");break;case"caldav":r=(0,le.Z)("CalDAV account, OK - now enter the server URL and your login details below and let us fetch your calendars.");break;case"google":r=(0,le.Z)("Google account, OK - now enter your username below and then log in using the google dialog shown.");break;case"ical":r=(0,le.Z)("Web calendar, OK - now enter the calendar URL below and let us fetch your events.")}return(0,fn.jsxs)(fn.Fragment,{children:["accountType"===this.state.step&&HD("form",{className:"detail",onSubmit:this.selectAccountType},void 0,HD("div",{className:"detail-content"},void 0,this.props.onboarding&&(0,fn.jsxs)(fn.Fragment,{children:[ex,this.state.initial&&(0,fn.jsxs)(fn.Fragment,{children:[HD("h1",{},void 0,(0,le.Z)("Welcome to Vivaldi Calendar")),HD("p",{},void 0,(0,le.Z)("Let’s get you going by adding your first account."))]}),!this.state.initial&&(0,fn.jsxs)(fn.Fragment,{children:[HD("h1",{},void 0,(0,le.Z)("Vivaldi Calendar")),HD("p",{},void 0,(0,le.Z)("Great, let’s add another account."))]})]}),!this.props.onboarding&&HD("p",{},void 0,(0,le.Z)("Select account type to add.")),HD("div",{className:"toolbar toolbar-pills toolbar-wrap"},void 0,o.map((e=>HD(sl,{isPressed:e===this.state.account_type,title:this.props.searchableStrings[e],onClick:()=>this.changeType(e)},e))))),HD("div",{className:"detail-toolbar"},void 0,HD("input",{type:"submit",value:(0,le.Z)("Continue"),autoFocus:!0}))),"accountInfo"===this.state.step&&HD("form",{className:"detail",onSubmit:this.createAccount},void 0,HD("div",{className:"detail-content"},void 0,this.props.onboarding&&(0,fn.jsxs)(fn.Fragment,{children:[HD("h1",{},void 0,(0,le.Z)("Add Your First Calendar Account")),HD("p",{},void 0,r)]}),HD("div",{className:"setting-group unlimited"},void 0,HD("div",{className:"setting-group"},void 0,HD("div",{className:"setting-single"},void 0,HD(Ko.Z,{type:"text",name:"name",onChange:this.handleChange,label:this.props.searchableStrings.Name,value:e,autoFocus:!0}))),["caldav","ical"].includes(n)&&HD("div",{className:"setting-group"},void 0,HD("div",{className:"setting-single"},void 0,HD(Ko.Z,{type:"text",name:"url",onChange:this.handleChange,label:this.props.searchableStrings.URL,value:t})))),($D(n)||"ical"===n)&&HD("div",{className:"setting-group unlimited"},void 0,HD("div",{className:"setting-group"},void 0,HD("div",{className:"setting-single"},void 0,HD(Ko.Z,{type:"text",name:"username",onChange:this.handleChange,label:this.props.searchableStrings.Username,value:i,placeholder:qD(n)}))),["vivaldi","caldav","ical"].includes(n)&&HD("div",{className:"setting-group"},void 0,HD("div",{className:"setting-single"},void 0,HD(Ko.Z,{type:"password",name:"password",onChange:this.handleChange,label:this.props.searchableStrings.Password,value:s})))),this.state.statusText&&HD("div",{className:"setting-group-double"},void 0,HD(Tr,{type:a},void 0,this.state.statusText))),HD("div",{className:"detail-toolbar"},void 0,HD("input",{type:"submit",disabled:this.state.requestPending,value:(0,le.Z)("Add Account")}),HD("input",{type:"button",disabled:this.state.requestPending,onClick:this.goBack,value:(0,le.Z)("navigation","Back")}))),"accountSummary"===this.state.step&&HD("form",{className:"detail",onSubmit:this.saveAccount},void 0,HD("div",{className:"detail-content"},void 0,this.state.calendars.length>0&&(0,fn.jsxs)(fn.Fragment,{children:[this.props.onboarding&&(0,fn.jsx)(fn.Fragment,{children:HD("h1",{},void 0,(0,le.Z)("Calendar Visibility and Syncing"))}),HD("p",{},void 0,(0,le.Z)("We found the following calendars:")),HD("table",{},void 0,HD("thead",{},void 0,HD("tr",{},void 0,HD("td",{},void 0,(0,le.Z)("Calendar")),HD("td",{},void 0,(0,le.Z)("Sync")),HD("td",{},void 0,(0,le.Z)("show","Hide")))),HD("tbody",{},void 0,this.state.calendars.map(((e,t)=>HD("tr",{},e.name||e.description||e.ctag,HD("td",{},void 0,e.description||e.name),HD("td",{},void 0,HD("input",{type:"checkbox",onChange:e=>this.toggleCalendarState(e,t,"active"),checked:e.active})),HD("td",{},void 0,HD("input",{type:"checkbox",onChange:e=>this.toggleCalendarState(e,t,"hidden"),checked:e.hidden})))))))]}),0===this.state.calendars.length&&HD("p",{},void 0,(0,le.Z)("No calendars found. Check that your credentials are correct and your calendar service has calendars configured."))),HD("div",{className:"detail-toolbar"},void 0,HD("input",{type:"submit",disabled:this.state.requestPending,value:(0,le.Z)("Save Account")}),HD("input",{type:"button",disabled:this.state.requestPending,onClick:this.goBack,value:(0,le.Z)("navigation","Back")}))),"done"===this.state.step&&HD("form",{className:"detail",onSubmit:this.props.showTips},void 0,HD("div",{className:"detail-content"},void 0,this.props.onboarding&&(0,fn.jsx)(fn.Fragment,{children:HD("span",{className:"ShowMailTipsAndTricks-allSetIcon",dangerouslySetInnerHTML:{__html:cn.mXV}})}),HD("h1",{},void 0,(0,le.Z)("Great, You’re All Set!")),"local"===this.account?.account_type&&HD("p",{},void 0,(0,le.Z)("If you want to add more local calendars use the calendar list in settings.")),this.props.onboarding&&HD("p",{},void 0,(0,le.Z)("Where to next?"))),HD("div",{className:"detail-toolbar"},void 0,HD("input",{type:"submit",value:(0,le.Z)("Show Tips and Tricks")}),HD("input",{type:"button",onClick:this.addAnother,value:(0,le.Z)("Add Another Account")}),this.props.onboarding&&HD("input",{type:"button",value:(0,le.Z)("Open Vivaldi Calendar"),onClick:()=>{ie.Z.showCalendar(this.context.vivaldiWindowId),this.props.done?.()}}),!this.props.onboarding&&HD("input",{type:"button",value:(0,le.Z)("calendar","Done"),onClick:()=>{this.props.done?.()}})))]})}}const nx=tx;var ix,sx=n(76632);function ox(e,t,n,i){ix||(ix="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:ix,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class ax extends tn.PureComponent{render(){let e=this.props.iconPath;return"gmail.com"===e?e="https://ssl.gstatic.com/ui/v1/icons/mail/images/favicon5.ico":"googleusercontent.com"===e?e="https://google.com/favicon.ico":e&&(e=Di(e)),(0,fn.jsxs)(fn.Fragment,{children:[ox(Oi,{size:32,className:"item-icon",url:e?(0,Ni.q9)(e):this.props.iconFallbackPath,fallbackUrl:this.props.iconFallbackPath,style:this.props.style,loadType:"faviconSkipCache"}),ox("div",{className:"item-title"},void 0,this.props.title),ox("div",{className:"item-meta"},void 0,this.props.meta)]})}}const rx=ax;var lx;function dx(e,t,n,i){lx||(lx="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:lx,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const cx=["editor","density","help"];function hx(e){const[t,i]=tn.useState(M.Z.get(D.kCalendarEditMode));return(0,fn.jsxs)(fn.Fragment,{children:[e.onboarding&&dx("h3",{},void 0,(0,le.Z)("Calendar Settings")),dx("h1",{},void 0,(0,le.Z)("Adding Events")),dx("p",{},void 0,(0,le.Z)("We’re all about choice. By default, we add and edit events inline, right inside the calendar without any popups.")),dx("div",{className:"ShowCalendarTipsAndTricks-Selectbox"},void 0,dx("button",{className:mn()("selectbox",{"selectbox-selected":"inline"===t}),onClick:function(){i("inline"),nt.Z.set(D.kCalendarEditMode,"inline")},type:"button"},void 0,dx("div",{className:"selectbox-image"},void 0,dx("span",{className:"onboarding-iillustration",dangerouslySetInnerHTML:{__html:n(36502)}}),dx("div",{dangerouslySetInnerHTML:{__html:cn.D7r.medium}})),dx("div",{className:"selectbox-title"},void 0,(0,le.Z)("Inline Editor"))),dx("button",{className:mn()("selectbox",{"selectbox-selected":"popup"===t}),onClick:function(){i("popup"),nt.Z.set(D.kCalendarEditMode,"popup")},type:"button"},void 0,dx("div",{className:"selectbox-image"},void 0,dx("span",{className:"onboarding-iillustration",dangerouslySetInnerHTML:{__html:n(46647)}}),dx("div",{dangerouslySetInnerHTML:{__html:cn.D7r.medium}})),dx("div",{className:"selectbox-title"},void 0,(0,le.Z)("Dialog Editor"))))]})}function px(e){const[t,i]=tn.useState(M.Z.get(D.kCalendarDisplayDensity));return(0,fn.jsxs)(fn.Fragment,{children:[e.onboarding&&dx("h3",{},void 0,(0,le.Z)("Calendar Settings")),dx("h1",{},void 0,(0,le.Z)("Calendar Density")),dx("p",{},void 0,(0,le.Z)("We can show you all the details from an event right in the calendar, or just the title. It’s up to you.")),dx("div",{className:"ShowCalendarTipsAndTricks-Selectbox"},void 0,dx("button",{className:mn()("selectbox",{"selectbox-selected":"full"===t}),onClick:function(){i("full"),nt.Z.set(D.kCalendarDisplayDensity,"full")},type:"button"},void 0,dx("div",{className:"selectbox-image"},void 0,dx("span",{className:"onboarding-iillustration",dangerouslySetInnerHTML:{__html:n(87922)}}),dx("div",{dangerouslySetInnerHTML:{__html:cn.D7r.medium}})),dx("div",{className:"selectbox-title"},void 0,(0,le.Z)("Full Details"))),dx("button",{className:mn()("selectbox",{"selectbox-selected":"minimal"===t}),onClick:function(){i("minimal"),nt.Z.set(D.kCalendarDisplayDensity,"minimal")},type:"button"},void 0,dx("div",{className:"selectbox-image"},void 0,dx("span",{className:"onboarding-iillustration",dangerouslySetInnerHTML:{__html:n(18767)}}),dx("div",{dangerouslySetInnerHTML:{__html:cn.D7r.medium}})),dx("div",{className:"selectbox-title"},void 0,(0,le.Z)("Title Only"))))]})}function ux(e){return(0,fn.jsxs)(fn.Fragment,{children:[e.onboarding&&dx("h3",{},void 0,(0,le.Z)("Calendar Help")),dx("h1",{},void 0,(0,le.Z)("Get All the Help You Need")),dx("div",{className:"ShowCalendarTipsAndTricks-WithImage"},void 0,dx("span",{className:"onboarding-iillustration",dangerouslySetInnerHTML:{__html:cn.Kuf}}),dx("div",{className:"ShowCalendarTipsAndTricks-TextBlock"},void 0,dx("p",{},void 0,(0,le.Z)("Want more tips and tricks? Our Help pages contain all the documentation you need.")),dx("p",{},void 0,dx("a",{onClick:()=>Y.Z.openURL(e.windowId,"https://help.vivaldi.com/calendar/")},void 0,(0,le.Z)("Visit our Help pages for Calendar.")))))]})}function gx(e){const[t,n]=tn.useState(cx[0]);const i=t===cx[cx.length-1];return dx("div",{className:"ShowCalendarTipsAndTricks"},void 0,dx("form",{className:"detail",onSubmit:function(){n(cx[cx.indexOf(t)+1])}},void 0,dx("div",{className:"detail-content"},void 0,"editor"===t&&dx(hx,{windowId:e.windowId,onboarding:e.onboarding}),"density"===t&&dx(px,{windowId:e.windowId,onboarding:e.onboarding}),"help"===t&&dx(ux,{windowId:e.windowId,onboarding:e.onboarding})),dx("div",{className:"detail-toolbar"},void 0,!i&&dx("input",{type:"submit",value:(0,le.Z)("Next tip")}),dx("input",{type:i?"submit":"button",value:(0,le.Z)("Open Vivaldi Calendar"),onClick:()=>{ie.Z.showCalendar(e.windowId),e?.onClose?.()}}),e.onClose&&dx("input",{type:"button",value:(0,le.Z)("calendar","Done"),onClick:()=>{e?.onClose?.()}}))))}var mx;function vx(e,t,n,i){mx||(mx="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:mx,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const{startDeletingAccount:fx}=xD.Z,{prepareForDeleteAccount:yx}=bD.Z,wx="/resources/vivaldi_calendar_default.png",bx={"Add your First Calendar Account":(0,le.Z)("Add your First Calendar Account"),"Press the “Add” button to the left to add a new Account.":(0,le.Z)("Press the “Add” button to the left to add a new Account.")},Cx={...yc.d3,"Calendar Type":(0,le.Z)("Calendar Type"),Name:(0,le.Z)("calendar","Name"),URL:(0,le.Z)("Address"),Password:(0,le.Z)("Password"),Username:(0,le.Z)("Username"),"Refresh Interval":(0,le.Z)("Refresh Interval"),Timezone:(0,le.Z)("Timezone"),Description:(0,le.Z)("Description")};class Sx extends tn.Component{static contextType=dn.Z;state={deletingAccount:"",isCreating:!1,setupStep:"setup"};#k=!1;onCreateItem=()=>{this.#k=!0,this.setState({isCreating:!0,setupStep:"setup"})};onCancelCreateItem=()=>{"setup"===this.state.setupStep?this.setState({isCreating:!1}):this.setState({isCreating:!1,setupStep:"setup"})};showTips=()=>{this.setState({setupStep:"tips"})};done=()=>{this.setState({setupStep:"setup"})};saveAccount=e=>{o.Z.updateAccount(e)};getFallbackIcon=e=>"caldav"===e?"/resources/calendar_caldav.png":"ical"===e?"/resources/calendar_web.png":wx;renderListItem=(e,t)=>{const n=oc.Z.ensureAccountType(t.account_type);let i="";if("vivaldi"===n||"google"===n){const{hostname:e}=_i.parse(t.url);i=(e||"").split(".").slice(-2).join(".")}return vx(rx,{title:t.name,meta:yc.d3[n],iconPath:i,iconFallbackPath:this.getFallbackIcon(n)})};renderCreateListItem=()=>vx(rx,{title:(0,le.Z)("New Account"),meta:(0,le.Z)("Setup in progress..."),iconFallbackPath:wx,style:{opacity:.3}});renderContent=(e,t)=>{const n=this.props.accounts[e],i=Et()(Object.values(n).reduce(((e,t)=>e+t)));return(0,fn.jsxs)(fn.Fragment,{children:["setup"===this.state.setupStep&&vx(DD,{filter:this.props.filter,searchableStrings:t,account:n,saveAccount:this.saveAccount},i),"tips"===this.state.setupStep&&vx(gx,{windowId:this.context.vivaldiWindowId,onClose:this.done,onboarding:!1})]})};remapAccounts=()=>this.props.accounts.map((e=>({...e,key:e.id})));renderCreate=e=>vx(nx,{done:this.onCancelCreateItem,filter:this.props.filter,searchableStrings:e});renderEmpty=e=>vx("div",{className:"detail"},void 0,vx("div",{className:"detail-content"},void 0,vx("h3",{},void 0,bx["Add your First Calendar Account"]),vx("p",{},void 0,bx["Press the “Add” button to the left to add a new Account."])));deleteAccountDialog=e=>{const t=async e=>{try{await fx(e)}finally{this.setState({deletingAccount:""})}},{account:n,onClose:i}=e,s=this.state.deletingAccount===n.id;return vx("div",{},void 0,vx("header",{className:"dialog-header"},void 0,vx("h1",{className:"dialog-title"},void 0,(0,le.Z)("Are you sure you want to remove the account ‘$1’ and its events?",[n.name]))),vx("div",{className:"dialog-content"},void 0,vx("p",{},void 0,(0,le.Z)("This operation cannot be undone."))),vx("footer",{className:"dialog-footer"},void 0,vx("input",{type:"button",className:"danger",disabled:s,onClick:async()=>{this.setState({deletingAccount:n.id}),"local"===n.account_type?t(n.id):yx(this.context.vivaldiWindowId,{accountId:n.id,onRemoval:t})},value:s?(0,le.Z)("Removing Account"):(0,le.Z)("verb","Remove"),autoFocus:!0}),vx("input",{type:"button",onClick:i,value:(0,le.Z)("Cancel")})))};render(){return vx(sx.Z,{title:(0,le.Z)("Calendar Accounts"),subtitle:(0,le.Z)("Add accounts such as Google, Outlook, Vivaldi.net, etc., to access your online calendars."),style:{height:320},className:"account-settings",deleteDialog:this.deleteAccountDialog,addTipString:(0,le.Z)("Add Account"),deleteTipString:(0,le.Z)("tooltip","Delete Account"),emptyListGraphic:n(28888),emptyListString:(0,le.Z)("No accounts added"),filter:this.props.filter,items:this.remapAccounts(),masterLayout:0,renderListItem:this.renderListItem,renderCreateListItem:this.renderCreateListItem,renderContent:this.renderContent,isCreating:this.state.isCreating,onCreateItem:this.onCreateItem,onCancelCreateItem:this.onCancelCreateItem,renderCreate:this.renderCreate,renderEmpty:this.renderEmpty,contentStrings:Cx,emptyStrings:bx,createStrings:Cx,onRemove:Tl.default})}}const Tx=VD(Sx);var Ix;function kx(e,t,n,i){Ix||(Ix="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Ix,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Ax extends tn.Component{static contextType=dn.Z;refReticle=tn.createRef();nodeRef=tn.createRef();constructor(e){super(e);const t=Dr()(this.props.color),n=t.get("hsv.h");this.state={dragging:!1,originalColor:this.props.color,h:Number.isNaN(n)?0:n,s:t.get("hsv.s"),v:t.get("hsv.v")}}componentDidMount(){this.context.addEventListener("mouseup",this.stopPlotMove),this.refReticle.current?.focus()}shouldComponentUpdate(e,t){if(!(0,Sm.default)(this.state,t))return!0;if(this.props.name!==e.name)return!0;if(this.props.color!==e.color){const t=Dr().hsv(this.state.h,this.state.s,this.state.v);if(!(0,Sm.default)(t.hex(),e.color))return!0}return!1}componentWillUnmount(){this.context.removeEventListener("mouseup",this.stopPlotMove)}getNode(){return this.nodeRef.current}handleClickOutside=e=>{this.props.hide(this.props.name,e)};_abort=()=>{this.props.setColor(Dr()(this.state.originalColor),this.props.name),this.props.hide(this.props.name)};getColorFromPlot=e=>{const t=e.currentTarget.getBoundingClientRect(),n=e.clientX-t.left,i=e.clientY-t.top,s=(t.height-i)/t.height,o=n/t.width;o>1||o<0||s>1||s<0?this.setState({dragging:!1}):this.setState({s:o,v:s},(()=>{const e=Dr().hsv(this.state.h,o,s);this.props.setColor(e,this.props.name,!0)}))};startPlotMove=e=>{this.getColorFromPlot(e),this.setState({dragging:!0})};plotMove=e=>{this.state.dragging&&this.getColorFromPlot(e)};stopPlotMove=()=>{this.setState({dragging:!1})};onPlotRecticleKeyDown=e=>{if("Enter"===e.key||"Tab"===e.key&&e.shiftKey)return this.props.hide(this.props.name),void e.preventDefault();if("Escape"===e.key)return e.preventDefault(),void this._abort();if("ArrowUp"===e.key||"ArrowRight"===e.key||"ArrowDown"===e.key||"ArrowLeft"===e.key){e.preventDefault();const t=e.shiftKey?10:1;let n=this.state.s,i=this.state.v;if("ArrowUp"===e.key?i+=.01*t:"ArrowDown"===e.key?i-=.01*t:"ArrowRight"===e.key?n+=.01*t:"ArrowLeft"===e.key&&(n-=.01*t),n>1||n<0||i>1||i<0)return;this.setState({s:n,v:i},(()=>{const e=Dr().hsv(this.state.h,n,i);this.props.setColor(e,this.props.name)}))}};onHueSliderChange=e=>{this.setState({h:e.currentTarget.value},(()=>{const e=Dr().hsv(this.state.h,this.state.s,this.state.v);this.props.setColor(e,this.props.name)}))};onSystemPickerChange=e=>{const t=Dr()(e.currentTarget.value);this.setState({h:t.get("hsv.h"),s:t.get("hsv.s"),v:t.get("hsv.v")},(()=>{this.props.setColor(t,this.props.name,!0)}))};onSystemPickerKeyDown=e=>{"Escape"===e.key?(e.preventDefault(),this._abort()):"Tab"!==e.key||e.shiftKey||this.props.hide(this.props.name)};render(){if(!this.props.name||!this.props.color)return null;const e=Dr().hsv(this.state.h,this.state.s,this.state.v),t=128-128*this.state.v,n=`translateX(${128*this.state.s}px)translateY(${t}px)`;return(0,fn.jsxs)("div",{ref:this.nodeRef,className:`colorpicker ignore-onclickoutside-${this.props.name}`,children:[kx("div",{className:"colorpicker-plot",onMouseDown:this.startPlotMove,onMouseMove:this.plotMove,style:{backgroundColor:Dr().hsv(this.state.h,1,1).hex()}},void 0,(0,fn.jsx)("button",{type:"button",ref:this.refReticle,className:"colorpicker-plot-reticle",onKeyDown:this.onPlotRecticleKeyDown,style:{transform:n}})),kx("input",{type:"range",className:"rangeHue",min:0,max:359,value:this.state.h,onMouseDown:this.onHueSliderChange,onChange:this.onHueSliderChange}),kx("input",{type:"color",title:(0,le.Z)("Show system color picker"),className:"colorpicker-system",value:e.hex(),onKeyDown:this.onSystemPickerKeyDown,onChange:this.onSystemPickerChange})]})}}const Zx=(0,Vr.Z)(Ax);var Ex;function _x(e,t,n,i){Ex||(Ex="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Ex,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Nx=/^([0-9a-f]{3}){1,2}$/i;var Mx=_x("span",{className:"ColorEditor-HexTextInput-Octothorpe"},void 0,"#");class Px extends tn.Component{refColorToggle=tn.createRef();constructor(e){super(e),this.state={isPickerVisible:!1,color:e.colorValue.substring(1)},this.debouncedSetColor=(0,Zr.Z)(this.props.setColor,100,{leading:!1}),e.predefinedColors&&(this.dropdownColors=e.predefinedColors.map((e=>({type:"Normal",name:e.name,iconSVG:this.createColorIcon(e.value),noPrettifying:!0,id:e.value}))))}componentWillUnmount(){this.props.onToggleColorPicker&&this.props.onToggleColorPicker(!1)}createColorIcon=e=>`<svg width="16" height="16" viewBox="0 0 16 16">\n      <rect x="0" y="0" width="16" height="16" rx="2" ry="2" fill="${e}" />\n    </svg>`;hexInputEvents=e=>{let t=e.currentTarget.value;if("#"===t.charAt(0)&&(t=t.substring(1)),t.length>6&&(t=t.substring(0,6)),this.setState({color:t}),6===t.length){const e=Dr()(t);e&&this.props.setColor(e,this.props.colorKey)}};toggleColorPicker=()=>{this.setState((e=>(this.props.onToggleColorPicker&&this.props.onToggleColorPicker(!e.isPickerVisible),{isPickerVisible:!e.isPickerVisible})))};hideColorPicker=(e,t)=>{t&&t.target!==this.refColorToggle.current&&(t.stopPropagation(),this.setState({isPickerVisible:!1}),this.refColorToggle.current?.focus(),this.props.onToggleColorPicker&&this.props.onToggleColorPicker(!1))};onColorPicked=(e,t,n=!1)=>{this.setState({color:e.hex().substring(1)}),n?this.debouncedSetColor(e,t):this.props.setColor(e,t)};onDropdownColorSelected=e=>{const t=Dr()(e);t&&(this.setState({color:t.hex().substring(1)}),this.props.setColor(t,this.props.colorKey))};render(){const e=this.props.colorKey,t=this.props.predefinedColors&&this.props.predefinedColors.length>0;let{color:n}=this.state;return Nx.test(n)||(n=this.props.colorValue.replace("#","")),_x("div",{className:mn()("ColorEditor",{"with-dropdown":t})},void 0,this.props.label&&_x("label",{htmlFor:e,className:"color-name"},void 0,this.props.label),_x("div",{className:"ColorEditor-ColorPickerContainer"},void 0,(0,fn.jsx)("button",{type:"button",className:"color-preview",disabled:this.props.disabled,tabIndex:0,ref:this.refColorToggle,onClick:this.toggleColorPicker,style:{backgroundColor:`#${n}`}}),this.state.isPickerVisible&&_x(Zx,{name:e,color:`#${n}`,setColor:this.onColorPicked,hide:this.hideColorPicker},e),t&&_x(Wf,{className:"ColorEditor-VivaldiDropdown",disabled:this.props.disabled,items:this.dropdownColors,onValueChange:this.onDropdownColorSelected,tooltip:(0,le.Z)("Choose a Color"),value:n,hideButtonText:!0})),_x("div",{className:"ColorEditor-HexTextInput"},void 0,Mx,_x("input",{className:"ColorEditor-HexTextInput-InputField",type:"text",id:e,disabled:this.props.disabled,value:this.state.color,spellCheck:"false",onChange:this.hexInputEvents})))}}const Dx=Px;var xx;function Ox(e,t,n,i){xx||(xx="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:xx,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const{isLocalCalendar:Lx}=oc.Z,{UNKNOWN:Rx,OK:Bx,ERROR:Fx}=yc.LB;class Ux extends tn.Component{state={status:Rx,statusText:"",calendar:this.props.calendar};isCalendarChanged=()=>{const e=this.props.calendar;if(!e)return!1;return!(this.state.calendar.name===e.name&&this.state.calendar.description===e.description&&this.state.calendar.color===e.color&&this.state.calendar.hidden===e.hidden&&this.state.calendar.active===e.active&&this.state.calendar.timezone===e.timezone)};setCalendarProperty=e=>{this.setState((t=>({calendar:{...t.calendar,...e}})))};onChange=e=>{const{name:t,value:n}=e.target,i={},s="iconindex"===t?isNaN(n)?0:parseInt(n):n;i[t]=s,this.setCalendarProperty(i)};logStatus=(e,t)=>{this.setState({status:t,statusText:e})};saveCalendar=()=>{this.state.calendar.description?this.props.save(this.state.calendar):this.setState({statusText:(0,le.Z)("Calendar Name cannot be empty")})};setColor=(e,t,n=!1)=>{this.setCalendarProperty({color:e.hex()})};onChangeCheckbox=e=>{const{checked:t,name:n}=e.target;this.setState((e=>({calendar:{...e.calendar,[n]:t}})))};exportCalendar=()=>o.Z.exportEvents(this.state.calendar.id);render(){const{description:e,hidden:t,active:n,id:i}=this.state.calendar,s=oc.Z.getCalendarColor(this.state.calendar),o=this.state.status===Fx?"error":this.state.status===Bx?"success":"info";return Ox("form",{className:"detail",onSubmit:this.saveCalendar},void 0,Ox("div",{className:"detail-content"},void 0,Ox("div",{className:"setting-group"},void 0,Ox("div",{className:"setting-single"},void 0,Ox(Ko.Z,{type:"text",onChange:this.onChange,name:"description",label:this.props.searchableStrings["Calendar Name"],value:e,disabled:this.props.readOnly})),Ox("div",{className:"setting-single"},void 0,Ox("label",{},void 0,Ox("input",{type:"checkbox",name:"hidden",checked:t,onChange:this.onChangeCheckbox}),Ox("span",{},void 0,this.props.searchableStrings["Hide from Calendar View"])))),Ox("div",{className:"setting-group"},void 0,Ox("div",{className:"setting-single"},void 0,Ox(Dx,{label:this.props.searchableStrings.Color,colorKey:"color",colorValue:s,setColor:this.setColor,predefinedColors:yc.hx}))),!Lx(i)&&Ox("div",{className:"setting-group"},void 0,Ox("h3",{},void 0,(0,le.Z)("Sync Calendar")),Ox("div",{className:"setting-single"},void 0,Ox("label",{title:(0,le.Z)("Active")},void 0,Ox("input",{type:"checkbox",name:"active",checked:n,onChange:this.onChangeCheckbox}),Ox("span",{},void 0,this.props.searchableStrings.Active)))),this.state.statusText&&Ox("div",{className:"setting-group-double"},void 0,Ox(Tr,{type:o},void 0,this.state.statusText))),Ox("div",{className:"detail-toolbar"},void 0,Ox("input",{type:"submit",value:(0,le.Z)("Save"),disabled:!this.isCalendarChanged()}),Ox("input",{type:"button",onClick:this.exportCalendar,value:(0,le.Z)("Export Calendar")})))}}const Vx=Ux;var Wx;function Hx(e,t,n,i){Wx||(Wx="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Wx,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const{getCalendarCreateParams:zx}=xD.Z;class Gx extends tn.PureComponent{constructor(e){super(e),this.state={calendar:zx()}}setColor=(e,t,n=!1)=>this.setCalendarProperty(t,e.hex());onAccountChange=e=>{this.setCalendarProperty("accountId",e.target.value)};onCalendarChange=e=>{const{name:t,value:n}=e.target,i="iconindex"===t?isNaN(n)?0:parseInt(n):n;this.setCalendarProperty(t,i)};setCalendarProperty=(e,t)=>this.setState((n=>({calendar:{...n.calendar,[e]:t}})));createCalendar=()=>{this.props.createCalendar(this.state.calendar)};isCalendarValid=()=>Boolean(this.state.calendar.description);render(){const{color:e,description:t,accountId:n}=this.state.calendar,i=Lo.Z.getAccounts().filter((e=>"ical"!==e.account_type));return Hx("form",{className:"detail",onSubmit:this.createCalendar},void 0,Hx("div",{className:"detail-content"},void 0,i.length>1&&Hx("div",{className:"setting-group"},void 0,Hx("div",{className:"setting-single"},void 0,Hx("label",{className:"floating-label"},void 0,Hx("span",{},void 0,(0,le.Z)("Account")),Hx("select",{onChange:this.onAccountChange,value:n},void 0,i.map((e=>Hx("option",{value:e.id},e.id,e.name))))))),Hx("div",{className:"setting-group"},void 0,Hx("div",{className:"setting-single"},void 0,Hx(Ko.Z,{type:"text",onChange:this.onCalendarChange,name:"description",label:this.props.searchableStrings["Calendar Name"],value:t,autoFocus:!0}))),Hx("div",{className:"setting-group"},void 0,Hx("div",{className:"setting-single"},void 0,Hx(Dx,{label:this.props.searchableStrings.Color,colorKey:"color",colorValue:e||xD.Z.getCalendarCreateColor(),setColor:this.setColor,predefinedColors:yc.hx})))),Hx("div",{className:"detail-toolbar"},void 0,Hx("input",{className:"primary",type:"submit",disabled:!this.isCalendarValid(),value:(0,le.Z)("Create Calendar")})))}}const $x=Gx;var Kx;function jx(e,t,n,i){Kx||(Kx="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Kx,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const{ensureAccountType:Yx,isCalDAV:Xx}=oc.Z,Qx={"Add your First Calendar":(0,le.Z)("Add your First Calendar"),"Press the “Add” button to the left to add a new Calendar.":(0,le.Z)("Press the “Add” button to the left to add a new Calendar.")},qx={...yc.d3,"Calendar Name":(0,le.Z)("Calendar Name"),Active:(0,le.Z)("Active"),"Hide from Calendar View":(0,le.Z)("Hide from Calendar View"),"Calendar Type":(0,le.Z)("Calendar Type"),Name:(0,le.Z)("calendar","Name"),CalDav:(0,le.Z)("CalDAV"),URL:(0,le.Z)("Address"),Subscribe:(0,le.Z)("Subscribe"),Password:(0,le.Z)("Password"),Username:(0,le.Z)("Username"),"Event Template":(0,le.Z)("Event Template"),"Refresh Interval":(0,le.Z)("Refresh Interval"),Timezone:(0,le.Z)("Timezone"),Color:(0,le.Z)("calendar","Color"),Index:(0,le.Z)("Index")};var Jx=jx("div",{}),eO=jx("div",{className:"item-meta"},void 0," ");class tO extends tn.PureComponent{static contextType=dn.Z;removeAt=e=>{const t=this.props.calendars[e];o.Z.deleteCalendar(t,!0)};renderListItem=(e,t)=>{const n=this.props.accounts.find((e=>e.id===t.accountId));if(n){const i=Yx(n.account_type),s="local"===i?cn.bcq:cn.eTS;return(0,fn.jsxs)(fn.Fragment,{children:[jx("span",{className:"item-icon",style:{fill:oc.Z.getCalendarColor(t)},dangerouslySetInnerHTML:{__html:s.large}}),jx("div",{className:"item-title"},void 0,e),jx("div",{className:"item-meta"},void 0,`${n.name} (${yc.d3[i]})`)]})}return Jx};renderCreateListItem=()=>(0,fn.jsxs)(fn.Fragment,{children:[jx("div",{className:"item-title"},void 0,(0,le.Z)("New Calendar")),eO]});save=e=>{const{id:t,...n}=e;o.Z.updateCalendar(t,n)};createCalendar=e=>{0===Lo.Z.getAccounts().length?xD.Z.createLocalAccountAndCalendar(null,e):o.Z.createCalendar(e,!0)};renderContent=(e,t)=>{const{calendars:n}=this.props,i=n&&n[e],s=Et()(Object.values(i).reduce(((e,t)=>e+t))),o=this.props.accounts.find((e=>e.id===i.accountId)),a=!!o&&Xx(o.account_type);return jx(Vx,{save:this.save,searchableStrings:t,calendar:i,readOnly:a},s)};renderCreate=e=>jx($x,{searchableStrings:e,createCalendar:this.createCalendar});renderEmpty=e=>jx("div",{className:"detail"},void 0,jx("div",{className:"detail-content"},void 0,jx("h3",{},void 0,Qx["Add your First Calendar"]),jx("p",{},void 0,Qx["Press the “Add” button to the left to add a new Calendar."])));remapCalendars=()=>this.props.calendars.map((e=>({...e,name:e.description||e.name,key:e.id})));render(){return jx(a_,{categoryTitle:(0,le.Z)("Calendars"),filter:this.props.filter},void 0,jx(sx.Z,{style:{height:280},className:"allowOverflow",deleteTitle:(0,le.Z)("title","Delete Calendar"),addTipString:(0,le.Z)("Add Calendar"),deleteTipString:(0,le.Z)("tooltip","Delete Calendar"),emptyListGraphic:n(28888),emptyListString:(0,le.Z)("No Calendars added"),filter:this.props.filter,items:this.remapCalendars(),masterLayout:0,onRemove:this.removeAt,renderListItem:this.renderListItem,renderCreateListItem:this.renderCreateListItem,renderContent:this.renderContent,renderCreate:this.renderCreate,renderEmpty:this.renderEmpty,contentStrings:qx,emptyStrings:Qx,createStrings:qx}))}}const nO=VD(tO);var iO,sO=n(68438);function oO(e,t,n,i){iO||(iO="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:iO,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const aO={Port:(0,le.Z)("Port"),"Incoming Server":(0,le.Z)("Incoming Server"),Username:(0,le.Z)("Username"),Password:(0,le.Z)("Password"),"App Password":(0,le.Z)("App Password"),"Outgoing Server":(0,le.Z)("Outgoing Server"),"Use App Password":(0,le.Z)("Use App Password"),"Use OAuth":(0,le.Z)("Use OAuth")};var rO=oO("select",{name:"MAIL_SOCKET_TYPE",value:"ssl",disabled:!0},void 0,oO("option",{value:"ssl"},void 0,"SSL/TLS")),lO=oO("option",{value:"starttls"},void 0,"StartTLS");class dO extends tn.PureComponent{isImap(){return this.props.account.accountType===ue.s9.IMAP}toggleOAuth=()=>{this.props.setAccountProperty("useOAuth",!this.props.account.useOAuth)};onChangeEvent=e=>{const{name:t,value:n}=e.target;this.props.setAccountProperty(t,n)};areServersGmail=()=>{const{MAIL_SERVER:e,MAIL_SMTP_SERVER:t}=this.props.account;return[e,t].every((e=>e&&e.includes("gmail.com")))};render(){const{MAIL_SERVER:e,MAIL_PORT:t,MAIL_USER:n,MAIL_PASSWORD:i,MAIL_SMTP_SERVER:s,MAIL_SMTP_PORT:o,MAIL_SMTP_USER:a,MAIL_SMTP_PASSWORD:r,MAIL_SMTP_SOCKET_TYPE:l}=this.props.account;return oO("div",{className:"setting-group-block"},void 0,oO("div",{className:"setting-group"},"mail__imap",oO("div",{className:"setting-single setting-single-flex"},void 0,oO(Ko.Z,{type:"text",disabled:this.props.disabled,onChange:this.onChangeEvent,name:"MAIL_SERVER",label:this.props.searchableStrings["Incoming Server"],labelImportant:!0,placeholder:"mail.vivaldi.net",isVerified:this.props.incomingVerified,hasError:this.props.showErrors&&!e,value:e||"",style:{width:"calc(75% - 6px)",flex:1}}),oO(Ko.Z,{type:"number",disabled:this.props.disabled,onChange:this.onChangeEvent,name:"MAIL_PORT",label:this.props.searchableStrings.Port,placeholder:this.isImap()?"993":"995",isVerified:this.props.incomingVerified,value:t||"",style:{width:"25%"}})),oO("div",{className:"setting-single"},void 0,oO("label",{className:"floating-label",disabled:!0},void 0,(0,le.Z)("Connection Security"),rO)),oO("div",{className:"setting-single"},void 0,oO(Ko.Z,{type:"text",disabled:this.props.disabled,onChange:this.onChangeEvent,name:"MAIL_USER",label:this.props.searchableStrings.Username,placeholder:"user@vivaldi.net",isVerified:this.props.userVerified,hasError:this.props.showErrors&&!n,value:n||""})),!this.props.account.useOAuth&&oO("div",{className:"setting-single"},void 0,oO(Ko.Z,{type:"password",disabled:this.props.disabled,onChange:this.onChangeEvent,name:"MAIL_PASSWORD",label:this.props.isGmail?this.props.searchableStrings["App Password"]:this.props.searchableStrings.Password,placeholder:"",isVerified:this.props.userVerified,hasError:this.props.showErrors&&!i,value:i||""}))),oO("div",{className:"setting-group"},"mail__smtp",oO("div",{className:"setting-single setting-single-flex"},void 0,oO(Ko.Z,{type:"text",disabled:this.props.disabled,onChange:this.onChangeEvent,name:"MAIL_SMTP_SERVER",label:this.props.searchableStrings["Outgoing Server"],labelImportant:!0,placeholder:"mail.vivaldi.net",isVerified:this.props.smtpVerified,hasError:this.props.showErrors&&!s,value:s||"",style:{width:"calc(50% - 6px)",flex:1}}),oO(Ko.Z,{type:"number",disabled:this.props.disabled,onChange:this.onChangeEvent,name:"MAIL_SMTP_PORT",label:this.props.searchableStrings.Port,placeholder:"465",value:o||"",isVerified:this.props.smtpVerified,style:{width:"25%"}})),oO("div",{className:"setting-single"},void 0,oO("label",{className:"floating-label"},void 0,(0,le.Z)("Connection Security"),oO("select",{name:"MAIL_SMTP_SOCKET_TYPE",onChange:this.onChangeEvent,value:l||"ssl"},void 0,oO("option",{value:"ssl"},void 0,(0,le.Z)("SSL/TLS (Recommended)")),lO))),oO("div",{className:"setting-single"},void 0,oO(Ko.Z,{type:"text",disabled:this.props.disabled,onChange:this.onChangeEvent,name:"MAIL_SMTP_USER",label:this.props.searchableStrings.Username,placeholder:"user@vivaldi.net",isVerified:this.props.userVerified,hasError:this.props.showErrors&&!a,value:a||""})),!this.props.account.useOAuth&&oO("div",{className:"setting-single"},void 0,oO(Ko.Z,{type:"password",disabled:this.props.disabled,onChange:this.onChangeEvent,name:"MAIL_SMTP_PASSWORD",label:this.props.isGmail?this.props.searchableStrings["App Password"]:this.props.searchableStrings.Password,placeholder:"",isVerified:this.props.userVerified,hasError:this.props.showErrors&&!r,value:r||""})),(this.props.isGmail||this.areServersGmail()||(0,sO.rs)(this.props.account))&&oO("label",{className:"setting-single"},void 0,oO("input",{type:"checkbox",checked:!!this.props.account.useOAuth&&this.props.account.useOAuth,onChange:this.toggleOAuth}),oO("span",{},void 0,this.props.searchableStrings["Use OAuth"]))))}}const cO=dO;var hO;function pO(e,t,n,i){hO||(hO="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:hO,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var uO=pO("input",{type:"radio",value:ue.kA,default:!0}),gO=pO("input",{type:"radio",value:ue.Qp}),mO=pO("input",{type:"radio",value:ue.eQ});class vO extends tn.PureComponent{onChange=e=>{let{name:t,value:n,checked:i}=e.target;n===ue.qd&&i&&(n=ue.kA);const s={...this.props.account.popDeletion,[t]:n};this.props.setAccountProperty("popDeletion",s)};render(){const e=this.props.account.popDeletion||{},{when:t=ue.qd,howManyDays:n=ue.CH}=e;return pO("div",{className:"setting-group setting-group-double"},void 0,pO(ws,{name:"popdeletiongroup",value:t,onChange:this.onChange,disabled:t===ue.qd,name:"when"},void 0,pO("div",{className:"setting-single"},void 0,pO("label",{},void 0,pO("input",{type:"checkbox",checked:t!==ue.qd,value:ue.qd,onChange:this.onChange,name:"when"}),pO("span",{},void 0,(0,le.Z)("Delete mail from server")))),pO("div",{className:"setting-single pad-left"},void 0,pO("label",{className:"pop-how-many-days"},void 0,uO,pO("input",{type:"number",min:"1",disabled:t!==ue.kA,value:n,placeholder:ue.CH,onChange:this.onChange,name:"howManyDays",className:"pop-how-many-days-input"}),pO("span",{},void 0,(0,le.Z)("days after receiving from server")))),pO("div",{className:"setting-single pad-left"},void 0,pO("label",{},void 0,gO,pO("span",{},void 0,(0,le.Z)("when deleting locally")))),pO("div",{className:"setting-single pad-left"},void 0,pO("label",{},void 0,mO,pO("span",{},void 0,(0,le.Z)("when received from server"))))))}}const fO=vO;var yO;function wO(e,t,n,i){yO||(yO="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:yO,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const bO={"Limit size when loading":(0,le.Z)("Limit size when loading"),"Limit (MB)":(0,le.Z)("Limit (MB)"),"Sync Options":(0,le.Z)("Sync Options")};class CO extends tn.PureComponent{onChange=e=>{const{name:t,value:n,checked:i}=e.target,s={...this.props.popMaxSize,[t]:"limited"===t?i:n};"limited"===t&&i&&!s.limit&&(s.limit=ue.yX),this.props.setAccountProperty("popMaxSize",s)};render(){const{limited:e=!1,limit:t=ue.yX}=this.props.popMaxSize||{};return(0,fn.jsxs)(fn.Fragment,{children:[wO("h3",{},void 0,bO["Sync Options"]),wO("label",{className:"setting-single"},void 0,wO("input",{type:"checkbox",name:"limited",checked:e,onChange:this.onChange}),wO("span",{},void 0,bO["Limit size when loading"])),wO("label",{className:"setting-single setting-single-flex"},void 0,wO("input",{type:"number",name:"limit",placeholder:ue.yX,disabled:!e,onChange:this.onChange,value:t,style:{width:90}}),wO("span",{},void 0,bO["Limit (MB)"]))]})}}const SO=CO;var TO=n(16504),IO=n(42315);function kO(e){if(0===e.length)throw new Error("raceToResolve: Need an array with at least one Promise.");let t;return new Promise(((n,i)=>Promise.all(e.map((e=>e.then(n).catch((e=>t=e))))).then((()=>i(t)))))}async function AO(e){const t=await e.listWellKnownFolders();for(const n of[ue.e9,ue.Nz,ue.uT])if(Array.isArray(t[n])&&t[n].length>0){const{path:i,subscribed:s}=t[n][0];s||await e.subscribeMailbox({path:i})}}const{OK:ZO,ERROR:EO,OFFLINE:_O}=ue.In,NO=async function(e){try{const t=await IO.Z.getIMAPClient(e);return t.onError=e=>new Error((0,le.Z)("Login for incoming server failed. IMAP server responded with: $1",[e.message])),await t.login(),t}catch(e){throw new Error((0,le.Z)("Login for incoming server failed. IMAP server responded with: $1",[e.message]))}},MO=function(e){return IO.Z.getSMTPClient(e).then((e=>new Promise(((t,n)=>{e.onidle=e.quit,e.onerror=n,e.onclose=t,e.connect()})))).catch((e=>{throw new Error((0,le.Z)("Login for outgoing server failed. Server responded with: $1",[e.message]))}))},PO=(e,t=!1)=>{const[n,i,s,o]=t?[e.MAIL_SMTP_PORT,e.MAIL_SMTP_SERVER,e.MAIL_SMTP_USER,e.MAIL_SMTP_PASSWORD]:[e.MAIL_PORT,e.MAIL_SERVER,e.MAIL_USER,e.MAIL_PASSWORD];if(!n||"number"!=typeof n)throw new Error(t?(0,le.Z)("Outgoing port is missing or not a number"):(0,le.Z)("Incoming port is missing or not a number"));if(!i)throw new Error(t?(0,le.Z)("Outgoing server information is missing"):(0,le.Z)("Incoming server information is missing"));if(!e.useOAuth){if(!s)throw new Error(t?(0,le.Z)("Outgoing username is missing"):(0,le.Z)("Incoming username is missing"));if(!o)throw new Error(t?(0,le.Z)("Outgoing password is missing"):(0,le.Z)("Incoming password is missing"))}},DO=(e,t,n,i,s)=>new Promise(((s,o)=>{const a=TO.default.open(e,t,{useSecureTransport:"ssl"===n});a.onerror=e=>{o({})},a.onopen=()=>{a.close(),s("MAIL_SMTP_SERVER"===i?{MAIL_SMTP_SERVER:e,MAIL_SMTP_PORT:t,MAIL_SMTP_SOCKET_TYPE:n}:{MAIL_SERVER:e,MAIL_PORT:t})}})),xO=(e,t,n)=>{const i={...e,MAIL_SMTP_USER:n};return MO(i).then((()=>[ZO,"Outgoing connection success",i,t])).catch((t=>{throw[EO,t.message,e]}))},OO=(e,t,n)=>new Promise(((i,s)=>{const o=new XMLHttpRequest;o.onload=async function(){if(200===o.status)try{const n=o.responseXML;let a,r,l,d,c;for(const e of n.getElementsByTagName("incomingServer"))e.getAttribute("type")===t&&"ssl"===e.getElementsByTagName("socketType")[0].textContent.toLowerCase()&&(a=e.getElementsByTagName("hostname")[0].textContent,r=e.getElementsByTagName("port")[0].textContent);for(const e of n.getElementsByTagName("outgoingServer"))if("smtp"===e.getAttribute("type")&&"plain"!==e.getElementsByTagName("socketType")[0].textContent.toLowerCase()&&(l=e.getElementsByTagName("hostname")[0].textContent,d=e.getElementsByTagName("port")[0].textContent,c=e.getElementsByTagName("socketType")[0].textContent.toLowerCase()),"ssl"===c&&l&&d)break;if(!(a&&r&&l&&d&&c))return s(new Error("autodiscover: Missing Outgoing or Incoming Server/Port information"));const h={...e,MAIL_SERVER:a,MAIL_PORT:Number(r),MAIL_SMTP_SERVER:l,MAIL_SMTP_PORT:Number(d),MAIL_SMTP_SOCKET_TYPE:"ssl"===c?"ssl":"starttls"},p=await IO.Z.getCapabilities(h);i([ZO,h,p])}catch(e){s(new Error(`autodiscover: ${e}`))}else s(new Error("autodiscover: Not in autoconfing"))},o.timeout=2e3;const a=function(){s(new Error("autodiscover: Error looking up in autoconfig"))};o.onerror=a,o.ontimeout=a,o.open("GET",n),o.responseType="document",o.send()})),LO={isValidEmail:e=>{if(!e||!e.MAIL_EMAIL)return!1;const t=e.MAIL_EMAIL.split("@");if(t&&2===t.length){const e=t[1].split(".");return!!(e&&e[1]&&e[1].length>1)}return!1},verify:(e,t)=>{e.offline?t(_O,e):(async e=>(PO(e,!0),await MO(e)))(e).then((()=>(async e=>{if(PO(e,!1),e.accountType!==ue.s9.IMAP)return ae.verifyPopLogin(e);(await NO(e)).logout()})(e))).then((()=>{t(ZO,e)}),(n=>{t(EO,e,n)}))},autofill:(e,t)=>{if(!LO.isValidEmail(e))return void t(EO,e,[]);const n=e.MAIL_EMAIL,i=e.MAIL_EMAIL&&n.split("@")[1];let s="imap",o=993;e.accountType===ue.s9.POP&&(s="pop",o=995),((e,t,n)=>{const i=[`https://autoconfig.${t}/mail/config-v1.1.xml?emailaddress=${e.MAIL_EMAIL}`,`https://autoconfig.vivaldi.net/v1.1/${t}`,`https://${t}/.well-known/autoconfig/mail/config-v1.1.xml?emailaddress=${e.MAIL_EMAIL}`],s="pop"===n?"pop3":n;return kO(i.map((t=>OO(e,s,t))))})(e,i,s).catch((()=>((e,t,n,i)=>{const s=[`${n}.${t}`,`mail.${t}`,`${n}.mail.${t}`],o=[`smtp.${t}`,`mail.${t}`,`smtp.mail.${t}`];let a,r,l;return Promise.race([new Promise((e=>setTimeout(e,1e4))),Promise.allSettled([kO([...s.map((e=>DO(e,i,"ssl","MAIL_SERVER")))]).then((async t=>{a=t,r=await IO.Z.getCapabilities({...e,...a})})),new Promise((e=>Promise.allSettled([kO([...o.map((e=>DO(e,465,"ssl","MAIL_SMTP_SERVER")))]).then((t=>{l=t,e()})),kO([...o.map((e=>DO(e,587,"starttls","MAIL_SMTP_SERVER")))]).then((e=>{l||(l=e)}))]).then(e)))])]).then((()=>{const t={...e,...a,...l};return[["MAIL_SERVER","MAIL_PORT","MAIL_SMTP_SERVER","MAIL_SMTP_PORT","MAIL_SMTP_SOCKET_TYPE"].every((e=>t[e]))?ZO:EO,t,r]}))})(e,i,s,o))).then((e=>{t(...e)}))},signIn:async(e,t)=>{if(e.offline)return t(_O,"offline",e);e.MAIL_PORT||(e.MAIL_PORT=e.accountType===ue.s9.IMAP?993:995),e.MAIL_SMTP_PORT||(e.MAIL_SMTP_PORT=465);try{PO(e,!1),PO(e,!0)}catch(n){return void t(EO,n.message,e)}let n;try{n=await IO.Z.getCapabilities(e)}catch(n){const i=(0,le.Z)("Could not connect to server. Received following message: $1",[n.message]);return void t(EO,i,e)}if(e.useOAuth){try{t(...await xO(e,n,e.MAIL_EMAIL))}catch(e){t(...e)}return}const i=[e.MAIL_USER],s=[e.MAIL_SMTP_USER];if(e.MAIL_EMAIL===e.MAIL_USER&&e.MAIL_EMAIL===e.MAIL_SMTP_USER&&e.MAIL_EMAIL.includes("@")){const t=e.MAIL_EMAIL.split("@")[0];i.push(t),s.push(t)}const o=await Promise.allSettled([kO(s.map((t=>xO(e,n,t)))),kO(i.map((t=>(async(e,t)=>{const n={...e,MAIL_USER:t};try{if(e.accountType===ue.s9.IMAP){const e=await NO(n);return[ZO,"Incoming connection success",n,[],e]}return await ae.verifyPopLogin(e),[ZO,"Incoming connection success",n]}catch(t){throw[EO,t.message,e,[]]}})(e,t))))]);let a={...e},r=ZO,l="",d=!1;for(const e of o)if(e.reason)r=EO,l=e.reason[1],a={...a,...e.reason[2]};else if(e.value&&(a={...a,...e.value[2]},5===e.value.length)){const t=e.value[4];d||(await AO(t),d=!0),t.logout()}t(r,l,a)}},RO=LO;var BO;function FO(e,t,n,i){BO||(BO="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:BO,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const{UNKNOWN:UO,VERIFYING:VO,OK:WO,ERROR:HO}=ue.In,zO={Back:(0,le.Z)("account creation","Back"),IMAP:(0,le.Z)("IMAP"),"Manual Setup":(0,le.Z)("Manual Setup"),"Edit Servers":(0,le.Z)("Edit Servers"),Manual:(0,le.Z)("Manual"),POP:(0,le.Z)("POP"),"Email Address":(0,le.Z)("Email Address"),Password:(0,le.Z)("Password"),"Offline Account":(0,le.Z)("Offline Account"),"Download Messages for Offline Viewing and Searching":(0,le.Z)("Download Messages for Offline Viewing and Searching"),"Upload Sent Messages to Sent Folder":(0,le.Z)("Upload Sent Messages to Sent Folder"),"Add your First Account":(0,le.Z)("Add your First Account"),"Add Mail Account":(0,le.Z)("Add Mail Account"),"Enter your email address below and we’ll help you get going with your first account.":(0,le.Z)("Enter your email address below and we’ll help you get going with your first account."),"Enter your email address below and we’ll help you get going.":(0,le.Z)("Enter your email address below and we’ll help you get going."),"If you would like a new mail account, we offer a free account when you register with vivaldi.net.":(0,le.Z)("If you would like a new mail account, we offer a free account when you register with vivaldi.net."),"Don’t have an email address?":(0,le.Z)("Don’t have an email address?"),"We have a selection of trusted email providers for you to choose from.":(0,le.Z)("We have a selection of trusted email providers for you to choose from."),"Please provide the password for your account":(0,le.Z)("Please provide the password for your account"),"Enter your password":(0,le.Z)("Enter your password"),...aO,"IMAP Server":(0,le.Z)("IMAP Server"),"POP Server":(0,le.Z)("POP Server"),"SMTP Server":(0,le.Z)("SMTP Server"),"Account Type":(0,le.Z)("Account Type"),Port:(0,le.Z)("Port")},GO="https://vivaldi.com/email-signup/";class $O extends tn.PureComponent{static contextType=dn.Z;_isMounted=!1;constructor(e){super(e),this.state={isAdding:!0,status:UO,statusText:"",account:{accountType:ue.s9.IMAP,MAIL_SMTP_SOCKET_TYPE:"ssl"},capability:[],addressValidated:!1,incomingVerified:!1,smtpVerified:!1,userVerified:!1,isEdited:!1,showManual:!1,syncUsernames:!0,syncPasswords:!0,oAuth:{showConfirmOAuth:!1,oAuthAccountProvider:null}}}componentDidMount(){this._isMounted=!0}componentWillUnmount(){this._isMounted=!1}setAccountProperty=(e,t)=>{"MAIL_EMAIL"===e?this.setState((e=>{const n=e.syncUsernames&&e.account.MAIL_EMAIL===e.account.MAIL_USER&&e.account.MAIL_EMAIL===e.account.MAIL_SMTP_USER,i={...e.account,MAIL_EMAIL:t,MAIL_USER:n?t:e.account.MAIL_USER,MAIL_SMTP_USER:n?t:e.account.MAIL_SMTP_USER};return{addressValidated:!this.accountExists(t)&&(e.account.offline||RO.isValidEmail(i)),account:i,syncUsernames:n}})):"MAIL_PASSWORD"===e?this.setState((e=>{const n=e.syncPasswords&&e.account.MAIL_PASSWORD===e.account.MAIL_SMTP_PASSWORD;return{account:{...e.account,MAIL_PASSWORD:t,MAIL_SMTP_PASSWORD:n?t:e.account.MAIL_SMTP_PASSWORD},syncPasswords:n}})):"MAIL_PORT"===e||"MAIL_SMTP_PORT"===e?this.setState((n=>({account:{...n.account,[e]:""!==t?Number(t):NaN},..."MAIL_PORT"===e?{incomingVerified:!1}:{smtpVerified:!1}}))):"MAIL_SERVER"===e||"MAIL_SMTP_SERVER"===e?this.setState((n=>({account:{...n.account,[e]:t},incomingVerified:"MAIL_SERVER"!==e&&n.incomingVerified,smtpVerified:"MAIL_SMTP_SERVER"!==e&&n.smtpVerified}))):this.setState((n=>({account:{...n.account,[e]:t}})))};accountExists(e){return(M.Z.get(D.kMailAccounts)||[]).findIndex((t=>t.MAIL_EMAIL===e))>=0}onChangeAccountProperty=e=>{const{name:t,value:n}=e.target;this.setAccountProperty(t,n)};autofill=()=>{this.state.account.offline?this.createOffline():this.setState((e=>({isEdited:e.status===HO,status:VO,statusText:(0,le.Z)("Attempting account autodiscovery...")})),(()=>{RO.autofill(this.state.account,this.autofillCallback)}))};signIn=()=>{this.setState((e=>({isAdding:!1,isEdited:e.status===HO,status:VO,statusText:(0,le.Z)("Attempting sign in...")})),(()=>{RO.signIn(this.state.account,this.signInCallback)}))};completeDiscovery=e=>{this.setState({account:e,isAdding:!1,status:WO,statusText:(0,le.Z)("Autodiscovery completed."),incomingVerified:!0,smtpVerified:!0,userVerified:!1})};onCancel=()=>{this.setState({oAuth:{showConfirmOAuth:!1,oAuthAccountProvider:null},status:WO})};onConfirmOAuth=e=>{this.setState((t=>({account:{...t.account,useOAuth:e},oAuth:{showConfirmOAuth:!1,oAuthAccountProvider:null}}))),e?this.signIn():this.completeDiscovery(this.state.account)};autofillCallback=(e,t,n)=>{if(this._isMounted)if(e===WO)(0,sO.hi)(n)||(0,sO.rs)(t)||(0,sO.KB)(t)?this.setState({account:{...t},oAuth:{showConfirmOAuth:!0,oAuthAccountProvider:(0,sO.Lb)(t)}}):this.completeDiscovery(t);else if(e===HO){const e=t.MAIL_SERVER&&t.MAIL_PASSWORD&&t.MAIL_SMTP_SERVER&&t.MAIL_SMTP_PASSWORD;this.setState((n=>{const i={...n.account,...t};return{status:HO,statusText:e?(0,le.Z)("This should not happen"):(0,le.Z)("Autodiscovery failed. Please enter server settings"),showManual:!e,account:i,userVerified:!1}}))}};signInCallback=(e,t,n)=>{this._isMounted&&e===WO?this.setState({account:n,isAdding:!1,status:WO,statusText:(0,le.Z)("Login completed."),incomingVerified:!0,smtpVerified:!0,userVerified:!0},this.saveAccount):this._isMounted&&e===HO&&this.setState((e=>{const i={...e.account,...n};return{status:HO,statusText:t,account:i,userVerified:!1}}))};considerAddingAccount=e=>{const t=e.target.name||"",n="BACK"===t,i="MANUAL"===t&&!this.state.isAdding||n;"Enter"!==e.key||i||this.onSubmit()};createOffline=()=>{const e=Et()(this.state.account.MAIL_EMAIL).substring(0,6);d.Z.mailPrivate.createFileDirectory(e,(()=>{(0,Oa.Z)(this.state.account)}))};createAccountBooleanHandler=e=>t=>{const{checked:n}=t.target;this.setState((t=>({account:{...t.account,[e]:n}})))};saveAccount=()=>{(0,Oa.Z)(this.state.account),ee.Z.addAccount(this.state.account,this.state.capability)};setViewType=e=>{const t=e.target.name;this.setState((e=>({showManual:"MANUAL"===t})))};onSubmit=()=>{!this.state.addressValidated||this.isCreating()||(this.state.isAdding&&!this.state.showManual?this.autofill():this.signIn())};renderSubmitButton=()=>{const e=this.state.status!==HO&&!this.state.showManual,t=this.state.status===HO&&!this.state.showManual;let n;this.state.showManual?n=(0,le.Z)("Add Account"):this.state.isAdding?n=(0,le.Z)("Continue"):e?n=(0,le.Z)("Sign In"):t&&(n=(0,le.Z)("Retry Login"));const i=!this.state.addressValidated||this.isCreating();return FO("input",{onClick:this.onSubmit,className:"primary",disabled:i,type:"button",value:n})};onChangeMailAccountType=e=>{const t=e.target.value===ue.s9.POP?ue.s9.POP:ue.s9.IMAP;this.setState((e=>({account:{...e.account,accountType:t}})))};isCreating=()=>this.state.status===VO;renderStatusCheck=()=>{if(this.state.status===VO||this.state.status===HO)return FO(Tr,{type:this.state.status===HO?"error":"info"},void 0,this.state.statusText)};onSignUpClicked=()=>{Y.Z.openURL(this.context.vivaldiWindowId,GO),this.props.onClose&&this.props.onClose()};showOAuthDialog=()=>{const e=(0,le.Z)("OAuth follows a standard login process."),t=(0,le.Z)("OAuth follows a standard login process but Microsoft OAuth requires you to sign in every 24 hours."),n=(0,le.Z)("Alternatively use an app-specific password. They are single purpose passwords that you can generate to login permanently."),i=(0,le.Z)("More info on Vivaldi Help.");return FO(wk,{title:(0,le.Z)("Pick Authentication Type"),prompt:"outlook"===this.state.oAuth.oAuthAccountProvider?[t,"",n,i]:[e,"",n,i],negative:(0,le.Z)("Use App-Specific Password"),positive:(0,le.Z)("Use OAuth"),onRequestClose:this.onCancel,onClose:this.onConfirmOAuth})};render(){const e=this.isCreating(),t=this.state.account.accountType===ue.s9.POP,n=!this.state.account.useOAuth&&this.state.showManual,i=(0,sO.hi)(this.state.capability);return FO("div",{className:"detail"},void 0,FO("div",{className:"detail-content"},void 0,FO("div",{className:"setting-group-double"},void 0,this.state.isAdding&&!this.state.showManual&&(0,fn.jsxs)(fn.Fragment,{children:[FO("h2",{},void 0,this.props.emptyAccounts?zO["Add your First Account"]:zO["Add Mail Account"]),FO("p",{className:"mail-setup-description"},void 0,this.props.emptyAccounts?zO["Enter your email address below and we’ll help you get going with your first account."]:zO["Enter your email address below and we’ll help you get going."])]}),!this.state.isAdding&&!this.state.showManual&&(0,fn.jsxs)(fn.Fragment,{children:[FO("h2",{},void 0,zO["Enter your password"]),FO("p",{className:"mail-setup-description no-margin"},void 0,(0,le.Z)("Please provide the password for your account")),FO("a",{className:"mail-setup-email-link",href:"mailto:"+this.state.account.MAIL_EMAIL},void 0,this.state.account.MAIL_EMAIL)]})),FO("div",{className:"setting-group-double",onKeyPress:this.considerAddingAccount},void 0,this.state.isAdding&&FO("div",{className:"setting-single mail-address"},void 0,FO(Ko.Z,{focusInput:this.props.focusInput,type:"text",disabled:e,isVerified:this.state.addressValidated,label:"",name:"MAIL_EMAIL",onChange:this.onChangeAccountProperty,placeholder:(0,le.Z)("Enter your email address")}),FO("select",{className:"CreateMailAccount-dropdown",onChange:this.onChangeMailAccountType,value:this.state.account.accountType},void 0,FO("option",{value:ue.s9.IMAP},void 0,(0,le.Z)("IMAP")),FO("option",{value:ue.s9.POP},void 0,(0,le.Z)("POP3")))),!this.state.isAdding&&!this.state.showManual&&FO("div",{className:"setting-single mail-address"},void 0,FO(Ko.Z,{type:"password",disabled:e,label:"",autoFocus:!0,placeholder:(0,le.Z)("My long safe password"),onChange:this.onChangeAccountProperty,name:"MAIL_PASSWORD"})),t&&this.state.showManual&&FO(fO,{account:this.state.account,setAccountProperty:this.setAccountProperty})&&FO(SO,{popMaxSize:this.state.account.popMaxSize,setAccountProperty:this.setAccountProperty}),this.state.showManual&&FO(cO,{account:this.state.account,incomingVerified:this.state.incomingVerified,searchableStrings:this.props.searchableStrings,showErrors:this.state.status===HO,smtpVerified:this.state.smtpVerified,userVerified:this.state.userVerified,setAccountProperty:this.setAccountProperty,isGmail:i}),this.renderStatusCheck(),this.renderSubmitButton(),!n&&FO("input",{onClick:this.setViewType,type:"button",name:"MANUAL",value:this.state.isAdding?this.props.searchableStrings["Manual Setup"]:this.props.searchableStrings["Edit Servers"]}),n&&FO("input",{onClick:this.setViewType,type:"button",name:"BACK",value:this.props.searchableStrings.Back})),this.state.isAdding&&!this.state.showManual&&FO("div",{className:"email-partnership"},void 0,FO("h3",{},void 0,zO["Don’t have an email address?"]),FO(Uw,{title:GO,onClick:this.onSignUpClicked},void 0,zO["We have a selection of trusted email providers for you to choose from."]))),this.state.oAuth.showConfirmOAuth&&this.showOAuthDialog())}}const KO=$O;var jO;function YO(e,t,n,i){jO||(jO="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:jO,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class XO extends tn.Component{static contextType=dn.Z;cidAttachments=[];focusSender=()=>{};constructor(e){super(e),this._initDraft()}_initDraft=()=>{this.signature=this.props.signature};componentDidMount(){this._isMounted=!0,this.onContentLoad()}componentWillUnmount(){this._isMounted=!1}componentDidUpdate(e){e.emailAddress!==this.props.emailAddress&&(this.signature=this.props.signature,this.onContentLoad())}onBodyChange=()=>this._isMounted&&this.refSignature.current?.getContentAsBodyParts?this.refSignature.current.getContentAsBodyParts().then(this.updateBody):Promise.reject();updateBody=(0,Kf.default)((async e=>{const t=e[0].content;this.props.onChange(t)}),200,{leading:!1});onContentLoad=()=>{this.signature&&setTimeout((()=>{""!==this.signature&&this.refSignature.current&&this.refSignature.current.setContent([{content:this.signature,isPlainText:!1}]),this.signature=""}),150)};refSignature=tn.createRef();render(){return YO("main",{},void 0,(0,fn.jsx)(Ok,{ref:this.refSignature,windowId:this.context.vivaldiWindowId,onSignatureAttachmentDrop:this.props.onChange,focusPreviousElement:this.focusSender,onBodyChange:this.onBodyChange,onContentLoad:this.onContentLoad}))}}const QO=XO;var qO;function JO(e,t,n,i){qO||(qO="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:qO,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const eL={"Alias Address":(0,le.Z)("Alias Address"),"New Alias":(0,le.Z)("New Alias"),"Enable Rich Text and Images":(0,le.Z)("Enable Rich Text and Images"),Signature:(0,le.Z)("Signature"),"Sender Name":(0,le.Z)("Sender Name")};class tL extends tn.PureComponent{state={newAlias:""};autoSetAliasProperty=(e,t,n)=>{if(n===this.props.aliases[e][t])return;const i=(0,E.ZP)(this.props.aliases,(i=>{i[e][t]=n}));i!==this.props.aliases&&this.props.setAliases(i)};toggleSignatureRichText=(e,t)=>{const{checked:n}=e.target;this.autoSetAliasProperty(t,"isSignatureRichText",n)};autoSaveAliasProperty=(e,t)=>{const{name:n,value:i}=e.target;this.autoSetAliasProperty(t,n,i)};changeNewAlias=e=>{this.setState({newAlias:e.target.value})};addNewAlias=()=>{const e=(0,E.ZP)(this.props.aliases,(e=>{e.push({MAIL_EMAIL:this.state.newAlias})}));this.props.setAliases(e),this.setState({newAlias:""})};removeAlias=e=>{const t=(0,E.ZP)(this.props.aliases,(t=>{t.splice(e,1)}));this.props.setAliases(t)};render(){return(0,fn.jsxs)(fn.Fragment,{children:[JO("form",{className:"setting-group"},void 0,JO("h3",{},void 0,this.props.searchableStrings["New Alias"]),JO("div",{className:"setting-single"},void 0,JO(Ko.Z,{type:"text",labelImportant:!0,isVerified:(0,ye.HZ)(this.state.newAlias),label:"",name:"MAIL_EMAIL",onChange:this.changeNewAlias,placeholder:this.props.defaultEmail.split("@").join("+label@")}),JO("input",{type:"submit",onClick:this.addNewAlias,disabled:!(0,ye.HZ)(this.state.newAlias),value:(0,le.Z)("Add Alias")}))),this.props.aliases?.map(((e,t)=>JO("div",{className:"MailAliasesForm-block"},t,JO("div",{className:"setting-group"},void 0,JO("div",{className:"setting-single"},void 0,JO("h3",{},void 0,this.props.searchableStrings["Alias Address"]),JO(Ko.Z,{type:"text",onChange:e=>this.autoSaveAliasProperty(e,t),name:"MAIL_EMAIL",label:"",placeholder:"John Doe",value:e.MAIL_EMAIL?e.MAIL_EMAIL:""})),JO("div",{className:"setting-single"},void 0,JO("h3",{},void 0,this.props.searchableStrings["Sender Name"]),JO(Ko.Z,{type:"text",onChange:e=>this.autoSaveAliasProperty(e,t),name:"MAIL_NAME",label:"",placeholder:"John Doe",value:e.MAIL_NAME?e.MAIL_NAME:""})),JO("div",{className:"setting-single"},void 0,JO("input",{type:"submit",className:"danger",onClick:()=>this.removeAlias(t),value:(0,le.Z)("Remove Alias")}))),JO("div",{className:"setting-group setting-group-double"},void 0,JO("div",{className:"setting-single"},void 0,JO("h3",{},void 0,this.props.searchableStrings.Signature),JO("div",{className:"mail-signature"},void 0,e.isSignatureRichText?JO(QO,{onChange:e=>this.autoSetAliasProperty(t,"signature",e),signature:e.signature||"",emailAddress:e.MAIL_EMAIL}):JO(Ko.Z,{type:"textarea",rows:"2",onChange:e=>this.autoSaveAliasProperty(e,t),name:"signature",label:"",placeholder:void 0===e.signature?Wk:"",value:e.signature||""}),JO("div",{className:"mail-signature-footer"},void 0,JO("div",{},void 0,JO("label",{},void 0,JO("input",{type:"checkbox",checked:!!e.isSignatureRichText,onChange:e=>this.toggleSignatureRichText(e,t)}),JO("span",{},void 0,eL["Enable Rich Text and Images"]))),JO("div",{},void 0,JO("select",{value:e.signaturePosition||"below",onChange:this.autoSaveAliasProperty,name:"signaturePosition",title:(0,le.Z)("Placement of signature")},void 0,JO("option",{value:"above"},void 0,(0,le.Z)("Place Signature at Top")),JO("option",{value:"below"},void 0,(0,le.Z)("Place Signature at Bottom")))))))))))]})}}const nL=tL;var iL;function sL(e,t,n,i){iL||(iL="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:iL,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class oL extends tn.PureComponent{constructor(e){if(super(e),e.children instanceof Array){const t=e.children[0];this.state={selectedTabId:e.activeTabId||t.props.id}}}componentDidUpdate(e){e.activeTabId!==this.props.activeTabId&&this.setState({selectedTabId:this.props.activeTabId})}onTabClick=e=>{this.props.onTabClick&&this.props.onTabClick(e),this.setState({selectedTabId:e})};render(){const{children:e,icons:t}=this.props,n=this.state.selectedTabId;return e instanceof Array&&e.length>1?sL("div",{className:[this.props.className,"TabbedView"].join(" ")},void 0,sL("nav",{className:"TabbedView-List",role:"tablist"},void 0,e.map(((e,i)=>{const{id:s,label:o}=e.props;return sL("button",{"aria-selected":s===n?"true":"false",type:"button",role:"tab",className:s===n?"active":null,onMouseDown:e=>e.preventDefault(),onClick:()=>this.onTabClick(s),dangerouslySetInnerHTML:{__html:(t?t[i]:"")+o}},s)}))),e.map((e=>{if(e.props.id===n)return sL("div",{className:"TabbedView-Content",role:"tabpanel","aria-labelledby":e.props.id},e.props.id,e.props.children)}))):(console.warn("TabbedView error: expecting multiple TabGroupEntries"),null)}}const aL=oL;var rL,lL=n(34155);function dL(e,t,n,i){rL||(rL="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:rL,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const{VERIFYING:cL,OK:hL,ERROR:pL,OFFLINE:uL}=ue.In,gL={"Sender Name":(0,le.Z)("Sender Name"),"Sync Options":(0,le.Z)("Sync Options"),Signature:(0,le.Z)("Signature"),"Download Messages for Offline Viewing and Searching":(0,le.Z)("Download Messages for Offline Viewing and Searching"),"Take Account Offline":(0,le.Z)("Take Account Offline"),"Upload Sent Messages to Sent Folder":(0,le.Z)("Upload Sent Messages to Sent Folder"),"Update Account":(0,le.Z)("Update Account"),Aliases:(0,le.Z)("Aliases"),Identity:(0,le.Z)("Identity"),Servers:(0,le.Z)("Servers"),"Name and signature":(0,le.Z)("Name and signature"),"Add a sender name and signature for this account.":(0,le.Z)("Add a sender name and signature for this account."),"Enable Rich Text and Images":(0,le.Z)("Enable Rich Text and Images"),...aO,...eL},mL=["MAIL_EMAIL","MAIL_PORT","MAIL_SERVER","MAIL_USER","MAIL_PASSWORD","MAIL_SMTP_PORT","MAIL_SMTP_SERVER","MAIL_SMTP_USER","MAIL_SMTP_PASSWORD","offline"];class vL extends tn.PureComponent{_isMounted=!1;_hasVerified=!1;constructor(e){super(e),this.state={status:cL,statusText:(0,le.Z)("Verifying..."),accountSettings:this.props.accountSettings,incomingVerified:!1,smtpVerified:!1,userVerified:!1,view:"identity"}}static getDerivedStateFromProps(e,t){return e.accountSettings.MAIL_EMAIL!==t.accountSettings.MAIL_EMAIL?{accountSettings:e.accountSettings}:null}componentDidMount(){this._isMounted=!0}componentWillUnmount(){this._isMounted=!1}componentDidUpdate(e,t){this.props.accountSettings!==e.accountSettings&&this._isConnectionUpdated(e.accountSettings,this.props.accountSettings)&&lL.nextTick((()=>{this._isMounted&&(this.setState({status:cL,statusText:(0,le.Z)("Verifying..."),incomingVerified:!1,smtpVerified:!1,userVerified:!1}),RO.verify(this.props.accountSettings,this.verifyAccountCallback))}))}_isConnectionUpdated=(e,t)=>mL.some((n=>e[n]!==t[n]));saveAccount=async()=>{const e=this.props.accountSettings,t=this.state.accountSettings,n=this._isConnectionUpdated(e,t);t.accountType===ue.s9.POP?ae.checkForMail():t.accountType===ue.s9.IMAP&&(n?(await te.Z.disconnectIMAPClient(e.MAIL_EMAIL),te.Z.connectIMAPClient(t)):t.MAIL_PASSWORD!==e.MAIL_PASSWORD&&t.accountType===ue.s9.IMAP&&te.Z.reconnectIMAPClient(t.MAIL_EMAIL)),e&&(n&&(this.setState({status:cL,statusText:(0,le.Z)("Verifying..."),incomingVerified:!1,smtpVerified:!1,userVerified:!1}),RO.verify(this.state.accountSettings,this.verifyAccountCallback)),(0,Oa.Z)(t,e))};setAccountProperty=(e,t)=>{"MAIL_PORT"===e||"MAIL_SMTP_PORT"===e?this.setState((n=>({accountSettings:{...n.accountSettings,[e]:Number(t)}}))):this.setState((n=>({accountSettings:{...n.accountSettings,[e]:t}})))};autoSetAccountProperty=(e,t)=>{t!==this.props.accountSettings[e]&&this.setState((n=>({accountSettings:{...n.accountSettings,[e]:t}})),(()=>(0,Oa.Z)(this.state.accountSettings,this.props.accountSettings)))};autoSaveAccountProperty=e=>{const{name:t,value:n}=e.target;this.autoSetAccountProperty(t,n)};areNonAutosavedPropertiesSame=()=>{const e=this.props.accountSettings,t=this.state.accountSettings;return t.MAIL_EMAIL===e.MAIL_EMAIL&&t.MAIL_PASSWORD===e.MAIL_PASSWORD&&t.MAIL_PORT===e.MAIL_PORT&&t.MAIL_SERVER===e.MAIL_SERVER&&t.MAIL_SMTP_PASSWORD===e.MAIL_SMTP_PASSWORD&&t.MAIL_SMTP_PORT===e.MAIL_SMTP_PORT&&t.MAIL_SMTP_SERVER===e.MAIL_SMTP_SERVER&&t.MAIL_SMTP_USER===e.MAIL_SMTP_USER&&t.MAIL_USER===e.MAIL_USER&&t.popDeletion===e.popDeletion&&t.useOAuth===e.useOAuth&&t.MAIL_SMTP_SOCKET_TYPE===e.MAIL_SMTP_SOCKET_TYPE};verifyAccountCallback=(e,t,n)=>{if(!this._isMounted)return;const i=Et()(t.MAIL_EMAIL).substring(0,6);new Promise(((e,t)=>{d.Z.mailPrivate.getFileDirectory(i,(n=>{y.Z.runtime.lastError?new Promise((e=>{d.Z.mailPrivate.createFileDirectory(i,(i=>{y.Z.runtime.lastError?t((0,le.Z)("Error creating data directory")):e(n)}))})).then(e(n)):e(n)}))})).then((i=>{if(this._isMounted&&e===hL)this.setState({status:hL,statusText:(0,le.Z)("Verified"),incomingVerified:!0,smtpVerified:!0,userVerified:!0});else if(this._isMounted&&e===pL){const e="string"==typeof t.MAIL_SERVER&&t.MAIL_SERVER.length>3,i="string"==typeof t.MAIL_SMTP_SERVER&&t.MAIL_SMTP_SERVER.length>3;this.setState({status:pL,statusText:(0,le.Z)("Error: $1",[n.message]),incomingVerified:e&&!isNaN(t.MAIL_PORT),smtpVerified:i&&!isNaN(t.MAIL_SMTP_PORT),userVerified:!1})}else this._isMounted&&e===uL&&this.setState({status:uL,statusText:(0,le.Z)("mail","Offline")})})).catch((e=>{this.setState({status:pL,statusText:e})}))};toggleOffline=e=>{const{checked:t}=e.target,{offline:n}=this.state.accountSettings;this.setState((e=>({accountSettings:{...e.accountSettings,offline:t}})),(()=>{(0,Oa.H)(this.state.accountSettings),n&&!t?(this.setState({view:"servers"}),te.Z.connectIMAPClient(this.state.accountSettings)):!n&&t&&te.Z.disconnectIMAPClient(this.state.accountSettings.MAIL_EMAIL)}))};togglePrefetch=e=>{const{checked:t}=e.target,{preFetch:n,MAIL_EMAIL:i}=this.state.accountSettings;this.setState((e=>({accountSettings:{...e.accountSettings,preFetch:t}})),(()=>{(0,Oa.H)(this.state.accountSettings),!n&&t&&setTimeout((()=>te.Z.preFetch(i)),200)}))};toggleUploadSent=e=>{const{checked:t}=e.target;this.setState((e=>({accountSettings:{...e.accountSettings,uploadSent:t}})),(()=>{(0,Oa.H)(this.state.accountSettings)}))};toggleSignatureRichText=e=>{const{checked:t}=e.target;this.setState((e=>({accountSettings:{...e.accountSettings,isSignatureRichText:t}})),(()=>{(0,Oa.H)(this.state.accountSettings)}))};setViewType=e=>{"servers"!==e||this._hasVerified||(this._hasVerified=!0,RO.verify(this.props.accountSettings,this.verifyAccountCallback)),this.setState({view:e})};render(){const e=this.props.showTips,t=this.state.accountSettings,n=t.accountType===ue.s9.POP,i=this.state.status===pL?"error":this.state.status===hL?"success":"info";return dL("div",{className:"detail"},void 0,e&&dL("div",{className:"tips"},void 0,dL("h2",{},void 0,gL["Name and signature"]),dL("p",{className:"mail-setup-description"},void 0,gL["Add a sender name and signature for this account."])),dL(aL,{onTabClick:this.setViewType,activeTabId:this.state.view,className:e?"hide-navigation":""},void 0,dL("div",{id:"identity",label:gL.Identity},void 0,dL("div",{className:"setting-group"},void 0,dL("div",{className:"setting-single"},void 0,dL("h3",{},void 0,gL["Sender Name"]),dL(Ko.Z,{type:"text",onChange:this.autoSaveAccountProperty,name:"MAIL_NAME",label:"",placeholder:"John Doe",value:t.MAIL_NAME?t.MAIL_NAME:""}))),dL("div",{className:"setting-group"},void 0,!n&&(0,fn.jsxs)(fn.Fragment,{children:[dL("h3",{},void 0,gL["Sync Options"]),dL("div",{className:"setting-single"},void 0,dL("label",{},void 0,dL("input",{type:"checkbox",checked:!!t.preFetch&&t.preFetch,onChange:this.togglePrefetch,disabled:t.offline}),dL("span",{},void 0,gL["Download Messages for Offline Viewing and Searching"])))]}),!n&&dL("label",{className:"setting-single",title:(0,le.Z)("Some mail servers (e.g. Outlook), will create a copy of the sent message in its Sent folder. It is only for such cases that this should be unchecked")},void 0,dL("input",{type:"checkbox",checked:t.uploadSent??!0,onChange:this.toggleUploadSent,disabled:t.offline}),dL("span",{},void 0,gL["Upload Sent Messages to Sent Folder"])),n&&dL(SO,{popMaxSize:t.popMaxSize,setAccountProperty:this.autoSetAccountProperty}),dL("label",{className:"setting-single",title:(0,le.Z)("Account will no longer try connecting to a server to fetch new messages")},void 0,dL("input",{type:"checkbox",checked:!!t.offline&&t.offline,onChange:this.toggleOffline}),dL("span",{},void 0,gL["Take Account Offline"]))),dL("div",{className:"setting-group-double"},void 0,dL("h3",{},void 0,gL.Signature),dL("div",{className:"mail-signature"},void 0,t.isSignatureRichText?dL(QO,{onChange:e=>this.autoSetAccountProperty("signature",e),signature:t.signature||"",emailAddress:t.MAIL_EMAIL}):dL(Ko.Z,{type:"textarea",rows:"4",onChange:this.autoSaveAccountProperty,name:"signature",label:"",placeholder:void 0===t.signature?Wk:"",value:t.signature||""}),dL("div",{className:"mail-signature-footer"},void 0,dL("div",{},void 0,dL("label",{},void 0,dL("input",{type:"checkbox",checked:!!t.isSignatureRichText,onChange:this.toggleSignatureRichText}),dL("span",{},void 0,gL["Enable Rich Text and Images"]))),dL("div",{},void 0,dL("select",{value:t.signaturePosition||"below",onChange:this.autoSaveAccountProperty,name:"signaturePosition",title:(0,le.Z)("Placement of signature")},void 0,dL("option",{value:"above"},void 0,(0,le.Z)("Place Signature at Top")),dL("option",{value:"below"},void 0,(0,le.Z)("Place Signature at Bottom"))))))),e&&dL("div",{className:"setting-group-double"},void 0,dL("input",{type:"submit",value:(0,le.Z)("Continue"),onClick:()=>e()}))),dL("div",{id:"servers",label:gL.Servers},void 0,dL("form",{onSubmit:this.saveAccount},void 0,dL(cO,{disabled:t.useOAuth,account:t,incomingVerified:this.state.incomingVerified,showErrors:this.state.status===pL,smtpVerified:this.state.smtpVerified,userVerified:this.state.userVerified,setAccountProperty:this.setAccountProperty,searchableStrings:gL,isGmail:(0,sO.hi)(this.props.capability)}),n&&dL(fO,{account:t,setAccountProperty:this.setAccountProperty}),dL("div",{className:"setting-group-double"},void 0,this.state.statusText&&dL(Tr,{type:i},void 0,this.state.statusText),dL("input",{type:"submit",value:(0,le.Z)("Update Account"),disabled:this.areNonAutosavedPropertiesSame()})))),dL("div",{id:"aliases",label:gL.Aliases},void 0,dL(nL,{aliases:t.aliases||[],setAliases:this.autoSetAccountProperty.bind(this,"aliases"),searchableStrings:gL,defaultSignature:t.signature,defaultName:t.MAIL_NAME,defaultEmail:t.MAIL_EMAIL}))))}}const fL=vL;var yL;function wL(e,t,n,i){yL||(yL="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:yL,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class bL extends tn.PureComponent{state={deleteFiles:!1};async onSubmit(e){const{MAIL_EMAIL:t,accountType:n}=this.props.account;e.preventDefault(),(0,Oa.H)({...this.props.account,isDeleted:!0}),j.Z.removeAccount(t,this.state.deleteFiles,n),this.props.onClose()}onChangeFileDeletion(){this.setState((e=>({deleteFiles:!e.deleteFiles})))}render(){const{MAIL_EMAIL:e}=this.props.account;return wL("form",{onSubmit:this.onSubmit.bind(this)},void 0,wL("header",{className:"dialog-double-header"},void 0,wL("div",{className:"header-icon",dangerouslySetInnerHTML:{__html:cn.Si$.large}}),wL("h1",{className:"dialog-title"},void 0,(0,le.Z)("Delete Account $1",[e]))),wL("div",{className:"dialog-content"},void 0,wL("label",{},void 0,wL("input",{autoFocus:!0,type:"checkbox",checked:this.state.deleteFiles,onChange:this.onChangeFileDeletion.bind(this)}),(0,le.Z)("Also delete message files from disk")),wL("p",{className:"info"},void 0,(0,le.Z)("If checked, all message files for $1 will be deleted. Otherwise they will remain on disk.",[e]))),wL("footer",{className:"dialog-footer"},void 0,wL("input",{type:"submit",className:"danger",value:(0,le.Z)("verb","Delete"),autoFocus:!0}),wL("input",{type:"button",onClick:this.props.onClose,value:(0,le.Z)("Cancel")})))}}const CL=bL;var SL;function TL(e,t,n,i){SL||(SL="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:SL,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var IL=TL("span",{className:"ShowMailTipsAndTricks-fakeButton"},void 0,"R"),kL=TL("span",{className:"ShowMailTipsAndTricks-fakeButton"},void 0,"T"),AL=TL("span",{className:"ShowMailTipsAndTricks-fakeButton"},void 0,"F"),ZL=TL("span",{className:"ShowMailTipsAndTricks-fakeButton"},void 0,"G"),EL=TL("span",{className:"ShowMailTipsAndTricks-fakeButton"},void 0,"K"),_L=TL("span",{className:"ShowMailTipsAndTricks-fakeButton"},void 0,"E"),NL=TL("span",{className:"ShowMailTipsAndTricks-fakeButton"},void 0,"M");class ML extends tn.PureComponent{static contextType=dn.Z;SM=["start","singlekey","unseen","filterbuttons","feeds","final"];state={current:"start"};renderState(e){switch(this.state.current){case"start":return TL("div",{className:"ShowMailTipsAndTricks-allSetContainer"},void 0,TL("span",{className:"ShowMailTipsAndTricks-allSetIcon",dangerouslySetInnerHTML:{__html:cn.mXV}}),TL("h1",{className:"ShowMailTipsAndTricks-allSetTitle"},void 0,(0,le.Z)("Great, you’re all set!")),TL("p",{className:"ShowMailTipsAndTricks-description"},void 0,(0,le.Z)("Where to next?")));case"singlekey":const t="https://help.vivaldi.com/desktop/shortcuts/keyboard-shortcuts/";return(0,fn.jsxs)(fn.Fragment,{children:[TL("h1",{className:"ShowMailTipsAndTricks-title"},void 0,(0,le.Z)("Mail Tips & Tricks")),TL("h2",{className:"ShowMailTipsAndTricks-subtitle"},void 0,(0,le.Z)("Single key shortcuts")),TL("p",{className:"ShowMailTipsAndTricks-description"},void 0,(0,le.Z)("When you’re in Mail you can hit a single key to get common tasks done faster")),TL("div",{className:"ShowMailTipsAndTricks-shortcuts"},void 0,TL("label",{className:"ShowMailTipsAndTricks-shortcutContainer"},void 0,IL,(0,le.Z)("Reply")),TL("label",{className:"ShowMailTipsAndTricks-shortcutContainer"},void 0,kL,(0,le.Z)("Threaded View")),TL("label",{className:"ShowMailTipsAndTricks-shortcutContainer"},void 0,AL,(0,le.Z)("mail","Forward")),TL("label",{className:"ShowMailTipsAndTricks-shortcutContainer"},void 0,ZL,(0,le.Z)("Mark the current e-mail as read and jump to the next unread.")),TL("label",{className:"ShowMailTipsAndTricks-shortcutContainer"},void 0,EL,(0,le.Z)("Mark as Read")),TL("label",{className:"ShowMailTipsAndTricks-shortcutContainer"},void 0,_L,(0,le.Z)("Enable Sender View (only show emails to and from the sender)")),TL("label",{className:"ShowMailTipsAndTricks-shortcutContainer"},void 0,NL,(0,le.Z)("Mark Thread as Read")),TL("a",{href:t,onClick:()=>Y.Z.openURL(e,t)},void 0,(0,le.Z)("Learn more about keyboard shortcuts")))]});case"unseen":const n="https://help.vivaldi.com/mail/mail-get-started/view-and-manage-messages/#Message_read_status";return(0,fn.jsxs)(fn.Fragment,{children:[TL("h1",{className:"ShowMailTipsAndTricks-title"},void 0,(0,le.Z)("Mail Tips & Tricks")),TL("h2",{className:"ShowMailTipsAndTricks-subtitle"},void 0,(0,le.Z)("Unseen and Unread")),TL("div",{className:"ShowMailTipsAndTricks-descriptionContainer"},void 0,TL("span",{className:"ShowMailTipsAndTricks-icon--Unseen",dangerouslySetInnerHTML:{__html:cn.tG3}}),TL("div",{className:"ShowMailTipsAndTricks-descriptionSide ShowMailTipsAndTricks-descriptionSide--Unseen"},void 0,TL("p",{},void 0,(0,le.Z)("In Vivaldi Mail, we separate between emails you’ve seen and those you have read.")),TL("p",{},void 0,(0,le.Z)("Emails are not marked read until you press K or G on the keyboard (or use the toolbar buttons).")),TL("a",{href:n,onClick:()=>Y.Z.openURL(e,n)},void 0,(0,le.Z)("Learn more about Unseen emails."))))]});case"filterbuttons":const i="https://help.vivaldi.com/mail/mail-get-started/view-and-manage-messages/#Display_messages";return(0,fn.jsxs)(fn.Fragment,{children:[TL("h1",{className:"ShowMailTipsAndTricks-title"},void 0,(0,le.Z)("Mail Tips & Tricks")),TL("h2",{className:"ShowMailTipsAndTricks-subtitle"},void 0,(0,le.Z)("View Toggles")),TL("div",{className:"ShowMailTipsAndTricks-descriptionContainer"},void 0,TL("span",{className:"ShowMailTipsAndTricks-icon",dangerouslySetInnerHTML:{__html:cn.Wt0}}),TL("div",{className:"ShowMailTipsAndTricks-descriptionSide"},void 0,TL("p",{},void 0,(0,le.Z)("They are Show Read, Show Custom IMAP folders, Show Mailing Lists, Show Feeds, Show Junk, and Show Deleted.")),TL("p",{},void 0,(0,le.Z)("For global views, such as the Unread view, you can quickly filter out messages that have already been dealt with (like read messages) or sorted (like e-mail in other folders than your Inbox).")),TL("a",{href:i,onClick:()=>Y.Z.openURL(e,i)},void 0,(0,le.Z)("Learn more about View Toggles"))))]});case"feeds":const s="https://help.vivaldi.com/mail/mail-feeds/feeds/";return(0,fn.jsxs)(fn.Fragment,{children:[TL("h1",{className:"ShowMailTipsAndTricks-title"},void 0,(0,le.Z)("Mail Tips & Tricks")),TL("h2",{className:"ShowMailTipsAndTricks-subtitle"},void 0,(0,le.Z)("Feeds")),TL("div",{className:"ShowMailTipsAndTricks-descriptionContainer"},void 0,TL("span",{className:"ShowMailTipsAndTricks-feedsIcon",dangerouslySetInnerHTML:{__html:cn.ooy}}),TL("div",{className:"ShowMailTipsAndTricks-descriptionSide"},void 0,TL("p",{},void 0,(0,le.Z)("That’s right, we have a Feed reader built into our email client!")),TL("p",{},void 0,(0,le.Z)("You can add feeds directly in the Mail Panel, or use the standalone Feeds panel.")),TL("a",{href:s,onClick:()=>Y.Z.openURL(e,s)},void 0,(0,le.Z)("Learn more about the Feed reader"))))]});case"final":const o="https://help.vivaldi.com/mail/#mail-get-started";return(0,fn.jsxs)(fn.Fragment,{children:[TL("h1",{className:"ShowMailTipsAndTricks-title"},void 0,(0,le.Z)("Mail Tips & Tricks")),TL("h2",{className:"ShowMailTipsAndTricks-subtitle"},void 0,(0,le.Z)("Get all the help you need")),TL("div",{className:"ShowMailTipsAndTricks-descriptionContainer"},void 0,TL("span",{className:"ShowMailTipsAndTricks-icon",dangerouslySetInnerHTML:{__html:cn.Kuf}}),TL("div",{className:"ShowMailTipsAndTricks-descriptionSide"},void 0,TL("p",{},void 0,(0,le.Z)("Want more tips and tricks? Our Help pages contain all the documentation you need.")),TL("p",{},void 0,(0,le.Z)("Visit our Help pages for Mail.")),TL("a",{href:o,onClick:()=>Y.Z.openURL(e,o)},void 0,(0,le.Z)("Learn more about Vivaldi Mail"))))]});default:return}}getNextState=()=>{const e=this.SM.indexOf(this.state.current),t=this.SM[e+1];this.setState({current:t})};openMail=async()=>{const e=this.context.vivaldiWindowId;this.props.onClose&&this.props.onClose(),Ho.Z.showContent(e,"mail",{setFocus:!0,selectId:"",reason:""});const t=await y.Z.tabs.query({windowType:"normal"}),n=await t.find((e=>e.url?.startsWith(St.xy.mailpage)));n?y.Z.windows.update(n.windowId,{focused:!0},(()=>{y.Z.tabs.update(n.id,{active:!0})})):ie.Z.showMail(e),j.Z.selectFolder({name:(0,le.Z)("Unread"),accountId:ue.of,path:ue.tB,id:ue.w1+"_"+ue.tB})};render(){return TL("div",{className:"ShowMailTipsAndTricks"},void 0,this.renderState(this.context.vivaldiWindowId),TL("div",{className:"ShowMailTipsAndTricks-buttonContainer"},void 0,"final"!==this.state.current&&TL("input",{type:"submit",className:"ShowMailTipsAndTricks-button",value:"start"===this.state.current?(0,le.Z)("Show me tips and tricks"):(0,le.Z)("Next tip"),onClick:this.getNextState}),"start"===this.state.current&&TL("input",{type:"button",className:"ShowMailTipsAndTricks-button",value:(0,le.Z)("Add another account"),onClick:this.props.onCreateItem}),TL("input",{type:"button",className:"ShowMailTipsAndTricks-button",value:(0,le.Z)("Open Vivaldi Mail"),onClick:this.openMail})))}}const PL=ML;var DL;function xL(e,t,n,i){DL||(DL="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:DL,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const OL="/resources/vivaldi_mail_default.png";class LL extends tn.PureComponent{static contextType=dn.Z;_isMounted=!1;state={isCreating:!1,accounts:[],capabilities:{},setupStep:"setup"};loadAccountsAndCapabilities=async e=>{const t=await hm.Z.loadAllAccounts();if(t.length<this.state.accounts.length)this.setState({accounts:t});else{let n;e&&t.length>this.state.accounts.length&&(n="signature");const i=await ya.Z.getCapabilities();this._isMounted&&(n?this.setState({accounts:t,capabilities:i,setupStep:n,isCreating:!1}):this.setState({accounts:t,capabilities:i}))}};componentDidMount(){this._isMounted=!0,this.loadAccountsAndCapabilities()}componentWillUnmount(){this._isMounted=!1}componentDidUpdate(e){if(e.prefValues[D.kMailAccounts]!==this.props.prefValues[D.kMailAccounts]){const e=!0;this.loadAccountsAndCapabilities(e)}}renderListItem=(e,t)=>{if(t.name){const e=t.MAIL_EMAIL.split("@")[1],n=t.isDeleted?(0,le.Z)("Deleting..."):e;return xL(rx,{title:t.name,meta:n,iconPath:e,iconFallbackPath:OL})}return null};showDirectory=e=>{d.Z.mailPrivate.getFileDirectory(e,(e=>{e&&Y.Z.openURL(this.context.vivaldiWindowId,`file://${e}`,{inCurrent:!1,inBackground:!1})}))};onContextMenu=(e,t)=>{const n=this.state.accounts[e],i=n&&n.MAIL_EMAIL,s=Et()(i).substring(0,6),o=[{handler:this.showDirectory.bind(this,s),visible:!0,...(0,Mn.Z)("Reveal Data Folder")}];(0,zi.Z)(this.context.vivaldiWindowId,o)(t)};renderCreateListItem=()=>xL(rx,{title:(0,le.Z)("New Account"),meta:(0,le.Z)("Setup in progress..."),iconFallbackPath:OL,style:{opacity:.3}});renderContent=(e,t)=>{const n=this.state.accounts[e],i=this.state.capabilities[n.MAIL_EMAIL]||[];return"tips"===this.state.setupStep?xL(PL,{onCreateItem:this.onCreateItem,onClose:()=>this.setState({setupStep:"setup"})}):xL(fL,{accountSettings:n,capability:i,searchableStrings:t,showTips:"signature"===this.state.setupStep?()=>this.showTips():void 0})};showTips=()=>{this.setState({setupStep:"tips"})};renderCreate=e=>xL(KO,{focusInput:!0,emptyAccounts:0===this.state.accounts.length,searchableStrings:e},"create");renderEmpty=e=>xL(KO,{emptyAccounts:!0,searchableStrings:e},"empty");remapAccounts=()=>this.state.accounts.map((e=>({...e,key:e.MAIL_EMAIL,name:e.MAIL_EMAIL})));deleteDialog=e=>(0,fn.jsx)(CL,{...e});onCreateItem=()=>{this.setState({isCreating:!0,setupStep:"setup"})};onCancelCreateItem=()=>{this.setState({isCreating:!1})};render(){return xL(sx.Z,{title:(0,le.Z)("Mail Accounts"),addTipString:(0,le.Z)("Add account"),items:this.remapAccounts(),masterLayout:0,onRemove:()=>{},deleteDialog:this.deleteDialog,onContextMenu:this.onContextMenu,emptyListGraphic:n(89182),emptyListString:(0,le.Z)("No accounts added"),renderListItem:this.renderListItem,renderCreateListItem:this.renderCreateListItem,renderContent:this.renderContent,contentStrings:gL,isCreating:this.state.isCreating,onCreateItem:this.onCreateItem,onCancelCreateItem:this.onCancelCreateItem,renderCreate:this.renderCreate,className:"setting-mail-account",createStrings:zO,renderEmpty:this.renderEmpty,emptyStrings:zO,filter:this.props.filter})}}const RL=(0,fs.Z)(LL,[D.kMailAccounts]);var BL;function FL(e,t,n,i){BL||(BL="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:BL,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const UL={Title:(0,le.Z)("Title"),Address:(0,le.Z)("Address"),"Every 5 minutes":(0,le.Z)("Every 5 minutes"),"Every 15 minutes":(0,le.Z)("Every 15 minutes"),"Every 30 minutes":(0,le.Z)("Every 30 minutes"),"Every hour":(0,le.Z)("Every hour"),"Every 2 hours":(0,le.Z)("Every 2 hours"),"Every 6 hours":(0,le.Z)("Every 6 hours"),"Every 12 hours":(0,le.Z)("Every 12 hours"),Daily:(0,le.Z)("Daily"),Weekly:(0,le.Z)("Weekly"),Offline:(0,le.Z)("rss","Offline")};class VL extends tn.Component{constructor(e){super(e),this.state={account:this.props.account,accountIndex:this.props.accountIndex,urlValidated:!1}}isAccountChanged=()=>{const e=this.props.account;if(!e||!this.state.urlValidated)return!1;const{url:t,path:n,title:i,refreshInterval:s,offline:o}=this.state.account;return!(i===e.title&&t===e.url&&n===e.path&&s===e.refreshInterval&&o===e.offline)};isUrlValid=e=>""!==e.trim()&&(e.split(/\s/).filter((e=>e))||[e]).every((e=>(0,Ni.C3)(e)));setAccountProperty=e=>{const{name:t,value:n}=e.target,i=this.isUrlValid("url"===t?n:this.state.account.url);this.setState((e=>({account:{...e.account,[t]:n},urlValidated:i})))};changeOffline=e=>{const{checked:t}=e.target,n=this.isUrlValid(this.state.account.url);this.setState((e=>({account:{...e.account,offline:t},urlValidated:n})))};saveAccount=()=>{const{url:e,path:t,title:n,refreshInterval:i,lastChecked:s,offline:o}=this.state.account;this.props.save({url:e,path:t,title:n,refreshInterval:i,lastChecked:s,offline:o},this.props.accountIndex)};render(){return FL("form",{className:"detail",onSubmit:this.saveAccount},void 0,FL("div",{className:"detail-content"},void 0,FL("div",{className:"setting-group"},void 0,FL("div",{className:"setting-single"},void 0,FL(Ko.Z,{type:"text",onChange:this.setAccountProperty,name:"title",label:this.props.searchableStrings.Title,placeholder:(0,le.Z)("Feed Title"),value:this.state.account.title,autoFocus:!this.state.account.title})),FL("div",{className:"setting-single"},void 0,FL(Ko.Z,{type:"text",onChange:this.setAccountProperty,name:"url",label:this.props.searchableStrings.Address,placeholder:(0,le.Z)("Feed Address"),isVerified:this.state.urlValidated,value:this.state.account.url})),FL("div",{className:"setting-single"},void 0,FL("label",{className:"floating-label"},void 0,FL("span",{},void 0,(0,le.Z)("Refresh Interval")),FL("select",{onChange:this.setAccountProperty,value:this.state.account.refreshInterval,name:"refreshInterval"},void 0,na()))),FL("div",{className:"setting-single"},void 0,FL("label",{},void 0,FL("input",{type:"checkbox",name:"offline",checked:!!this.state.account.offline&&this.state.account.offline,onChange:this.changeOffline}),FL("span",{},void 0,this.props.searchableStrings.Offline))))),FL("div",{className:"detail-toolbar"},void 0,FL("input",{type:"submit",value:(0,le.Z)("Save"),disabled:!this.isAccountChanged()})))}}const WL=VL;var HL;function zL(e,t,n,i){HL||(HL="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:HL,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const GL="/resources/vivaldi_rss_default.png",$L=[D.kRssDetectFeeds,D.kRssEmbedYoutubeAttachments,D.kRssShowNotifications],KL=nt.Z.getEventHandler,jL={"Add your First Newsfeed Account":(0,le.Z)("Add your First Newsfeed Account"),"Press the “Add” button to the left to add a new account.":(0,le.Z)("Press the “Add” button to the left to add a new account.")};class YL extends tn.PureComponent{static contextType=dn.Z;constructor(e){super(e),this.state={accounts:M.Z.get(D.kRssSettings)}}componentDidMount=()=>{M.Z.addListener(D.kRssSettings,this._onSettingsChanged)};componentWillUnmount=()=>{M.Z.removeListener(D.kRssSettings,this._onSettingsChanged)};_onSettingsChanged=(e,t)=>{this.setState({accounts:t})};removeAt=e=>{const{path:t}=this.state.accounts[e];At.removeFeed(t)};renderListItem=(e,t)=>{const{hostname:n}=_i.parse(t.url),i=(n||"").split(".").slice(-2).join(".");return zL(rx,{title:t.title,meta:t.url,iconPath:i,iconFallbackPath:GL},t.url)};renderCreateListItem=()=>(0,fn.jsx)(fn.Fragment,{children:zL(rx,{title:(0,le.Z)("New Feed"),meta:(0,le.Z)("Setup in progress..."),iconFallbackPath:GL,style:{opacity:.3}})});save=(e,t)=>{const{accounts:n}=this.state;if(t<n.length)At.edit(e,t);else{const t=[],n=e.url.split(/\s/).filter((e=>e));n.length>1?n.forEach((n=>{const{title:i,path:s}=e;t.some((e=>e.url===n))||t.push({url:n,path:s,title:i,refreshInterval:5,lastChecked:0,offline:!1})})):t.push(e),At.add(t)}};renderContent=(e,t)=>{const{accounts:n}=this.state,i=n&&n[e];return i?zL(WL,{save:this.save,searchableStrings:t,account:i,accountIndex:e},i.url):null};renderCreate=e=>{const{accounts:t}=this.state,n={title:"",url:"",path:d.Z.utilities.generateGUID(),lastChecked:0,refreshInterval:0,offline:!1};return zL(WL,{save:this.save,searchableStrings:e,account:n,accountIndex:t.length})};renderEmpty=e=>zL("div",{className:"detail"},void 0,zL("div",{className:"detail-content"},void 0,zL("h3",{},void 0,e["Add your First Newsfeed Account"]),zL("p",{},void 0,e["Press the “Add” button to the left to add a new account."])));remapAccounts=()=>this.state.accounts.map((e=>({...e,key:e.title,name:e.title})));render(){return zL(a_,{filter:this.props.filter,categoryTitle:(0,le.Z)("Newsfeed Accounts")},void 0,zL("div",{className:"setting-group unlimited"},void 0,zL(sx.Z,{deleteTitle:(0,le.Z)("title","Delete Feed"),addTipString:(0,le.Z)("title","Add Feed"),deleteTipString:(0,le.Z)("tooltip","Delete Feed"),emptyListGraphic:n(55592),emptyListString:(0,le.Z)("No Feeds added"),filter:this.props.filter,items:this.remapAccounts(),masterLayout:0,onRemove:this.removeAt,renderListItem:this.renderListItem,renderCreateListItem:this.renderCreateListItem,renderContent:this.renderContent,renderCreate:this.renderCreate,renderEmpty:this.renderEmpty,contentStrings:UL,emptyStrings:jL,style:{height:300}}),zL("div",{className:"setting-single"},void 0,zL("input",{type:"button",onClick:()=>At.updateAllFeeds(this.context.vivaldiWindowId),value:(0,le.Z)("Update All Feeds")}))),zL("div",{className:"setting-group"},void 0,zL("div",{className:"setting-single"},void 0,zL("h3",{},void 0,(0,le.Z)("Feed Detection")),zL("label",{title:(0,le.Z)("Use Vivaldi Feeds to detect, preview and subscribe to feeds.")},void 0,zL("input",{type:"checkbox",checked:this.props.prefValues[D.kRssDetectFeeds],onChange:KL(D.kRssDetectFeeds)}),zL("span",{},void 0,(0,le.Z)("Detect Feeds in Web Pages"))))),zL("div",{className:"setting-group"},void 0,zL("div",{className:"setting-single"},void 0,zL("h3",{},void 0,(0,le.Z)("Feed Notifications")),zL("label",{},void 0,zL("input",{type:"checkbox",checked:this.props.prefValues[D.kRssShowNotifications],onChange:KL(D.kRssShowNotifications)}),zL("span",{},void 0,(0,le.Z)("Show Notifications for New Feed Items"))))),zL("div",{className:"setting-group"},void 0,zL("div",{className:"setting-single"},void 0,zL("h3",{},void 0,(0,le.Z)("Attachments")),zL("label",{},void 0,zL("input",{type:"checkbox",checked:this.props.prefValues[D.kRssEmbedYoutubeAttachments],onChange:KL(D.kRssEmbedYoutubeAttachments)}),zL("span",{},void 0,(0,le.Z)("Embed YouTube Links in Attachments"))))))}}const XL=(0,fs.Z)(YL,$L);var QL;function qL(e,t,n,i){QL||(QL="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:QL,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class JL extends tn.PureComponent{rules={from:(0,le.Z)("sender","From"),to:(0,le.Z)("To"),cc:(0,le.Z)("Cc"),subject:(0,le.Z)("Subject"),body:(0,le.Z)("Body"),anywhere:(0,le.Z)("Anywhere")};state={rule:"",conjunction:this.props.isEmpty?"":"AND",ruleName:"anywhere",mailAddresses:Aa.Z.getMailAddresses(),isValidInput:!1,condition:"include"};_mailAddressesChanged=()=>{this.setState({mailAddresses:Aa.Z.getMailAddresses()})};componentDidMount(){Aa.Z.addListener(this._mailAddressesChanged)}componentWillUnmount(){Aa.Z.removeListener(this._mailAddressesChanged)}onChangeRuleName=e=>{const t=e.target.value;switch(t){case"subject":case"body":case"to":case"from":case"cc":case"anywhere":this.setState({ruleName:t})}};onChange=e=>{this.setState({rule:e.target.value,isValidInput:e.target.value.trim().length>0})};onChangeConjunction=e=>{switch(e.target.value){case"NOT":case"AND":case"OR":this.setState({conjunction:e.target.value})}};onSubmit=e=>{if(this.state.rule&&(!["from","cc","to"].includes(this.state.ruleName)||!this.state.condition.includes("equal"))){const{ruleName:t,rule:n,condition:i,conjunction:s}=this.state;this.props.onSubmit({ruleName:t,rule:n,condition:i,conjunction:s},e),this.setState({rule:""})}};onBeforeAddMailFilter=()=>{if(this.state.rule)return this.setState({showDialog:!0}),!0};addAddressToRuleGroup=e=>{if(e.length>0){const t=e[0].address,n=this.state.condition,i=this.state.conjunction;this.props.onSubmit({ruleName:this.state.ruleName,rule:t,condition:n,conjunction:i})}};setIsValidInput=e=>{this.state.isValidInput!==e&&this.setState({isValidInput:e})};onChangeCondition=e=>{const t=e.target.value;switch(t){case"equal":case"include":case"starts_with":this.setState({condition:t})}};onClose=e=>{if(e){const e=!0;this.onSubmit(e)}else this.setState({showDialog:!1})};render(){const e=this.state.ruleName,t=this.state.condition;return qL("form",{onSubmit:this.onSubmit,className:"MailFilterSelector"},void 0,!this.props.isEmpty&&qL("select",{onChange:this.onChangeConjunction,value:this.state.conjunction,className:"MailFilterSelector-conjunctionContainer"},void 0,qL("option",{value:"AND"},void 0,(0,le.Z)("AND")),qL("option",{value:"OR"},void 0,(0,le.Z)("OR")),qL("option",{value:"NOT"},void 0,(0,le.Z)("NOT"))),qL("select",{onChange:this.onChangeRuleName,value:this.state.ruleName},void 0,this.rules&&Object.keys(this.rules).map((e=>qL("option",{value:e},e,this.rules[e])))),qL("select",{onChange:this.onChangeCondition,value:this.state.condition},void 0,["from","cc","to"].includes(e)&&(0,fn.jsx)(fn.Fragment,{children:qL("option",{value:"equal"},void 0,(0,le.Z)("equals"))}),qL("option",{value:"include"},void 0,(0,le.Z)("includes")),qL("option",{value:"starts_with"},void 0,(0,le.Z)("starts with")),["subject","body","anywhere"].includes(e)&&(0,fn.jsx)(fn.Fragment,{children:qL("option",{value:"equal"},void 0,(0,le.Z)("equals"))})),qL("div",{className:"MailFilterSelector-inputContainer"},void 0,["from","to","cc"].includes(e)&&"equal"===t?qL(Uk,{id:e,selectedItems:[],allItems:this.state.mailAddresses||new Map,itemSelectionCallback:this.addAddressToRuleGroup,setIsValidInput:this.setIsValidInput,className:"MailFilterSelector-input"}):qL("input",{type:"text",onChange:this.onChange,value:this.state.rule,className:"MailFilterSelector-input"}),qL("input",{type:"button",disabled:!this.state.isValidInput,onClick:this.onSubmit,value:(0,le.Z)("Add to Search")})),this.state.showDialog&&qL(wk,{title:(0,le.Z)("Forgot to add to search"),prompt:[(0,le.Z)("We noticed you wrote something and didn't add it to the search. Would you like to add '$1' to the search?",[this.state.rule])],positive:(0,le.Z)("Add to Search"),negative:(0,le.Z)("Cancel"),onRequestClose:()=>this.setState({showDialog:!1}),onClose:this.onClose}))}}const eR=JL;var tR,nR=n(45709);function iR(e,t,n,i){tR||(tR="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:tR,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const sR=new Map([["SET_FLAG",(0,le.Z)("Flag")],["ADD_LABEL",(0,le.Z)("Add label")],["REMOVE_LABEL",(0,le.Z)("Remove label")],["MARK_READ",(0,le.Z)("Mark as read")],["MARK_AS_SPAM",(0,le.Z)("Mark as spam")]]);var oR=iR("hr",{},"separator"),aR=iR("hr",{},"separator");class rR extends tn.PureComponent{state={showCreateLabel:!1};onChangeType=e=>{const t=e.target.value;let n;"ADD_LABEL"===t?n={type:"ADD_LABEL",label:(0,ev.A4)(this.props.trigger.label||"")}:"REMOVE_LABEL"===t?n={type:"REMOVE_LABEL",label:(0,ev.A4)(this.props.trigger.label||"")}:"MARK_READ"===t?n={type:"MARK_READ"}:"SET_FLAG"===t?n={type:"SET_FLAG",flag:this.props.trigger.flag||ue.T4.RED}:"MARK_AS_SPAM"===t&&(n={type:"MARK_AS_SPAM"}),n&&this.props.editTrigger(this.props.triggerIndex,n)};onChangeLabel=e=>{const t=e.target.value;if("addlabel"===t)return void this.setState({showCreateLabel:!0});switch(this.props.trigger.type){case"ADD_LABEL":const e={type:"ADD_LABEL",label:t};this.props.editTrigger(this.props.triggerIndex,e);break;case"REMOVE_LABEL":const n={type:"REMOVE_LABEL",label:t};this.props.editTrigger(this.props.triggerIndex,n)}};onChangeFlag=e=>{const t=e.target.value;if("SET_FLAG"===this.props.trigger.type){const e={type:"SET_FLAG",flag:t};this.props.editTrigger(this.props.triggerIndex,e)}};renderAction=()=>{switch(this.props.trigger.type){case"ADD_LABEL":case"REMOVE_LABEL":return this.renderLabel();case"SET_FLAG":return this.renderFlag();case"MARK_READ":case"MARK_AS_SPAM":return}};renderLabel=()=>{const e=it.Z.getByAccountId(ue.ut).sort(ev.jp).map((e=>iR("option",{value:e.path},e.path,(0,rZ.X)(e.name))));return e.push([oR,iR("option",{value:"addlabel"},"addlabel",(0,le.Z)("Add New Label"))]),iR("select",{className:"MailTriggerSelector-select",onChange:this.onChangeLabel,value:this.props.trigger.label||""},void 0,e)};renderFlag=()=>{const e=nR.ZP.getStandardFlagList().map((e=>iR("option",{value:e},e,nR.ZP.translateFlag(e))));return e.push([aR,iR("option",{value:ue.T4.CLEAR_FLAGS},ue.T4.CLEAR_FLAGS,nR.ZP.translateFlag(ue.T4.CLEAR_FLAGS))]),iR("select",{className:"MailTriggerSelector-select",onChange:this.onChangeFlag,value:this.props.trigger.flag||ue.T4.RED},void 0,e)};onCustomLabelDlgClose=()=>(this.setState({showCreateLabel:!1}),Promise.resolve());render(){return(0,fn.jsxs)(fn.Fragment,{children:[iR("form",{className:"MailTriggerSelector"},void 0,iR("select",{className:"MailTriggerSelector-select",onChange:this.onChangeType,value:this.props.trigger.type},void 0,[...sR.keys()].map((e=>iR("option",{value:e},e,sR.get(e))))),this.renderAction(),!this.props.lastTrigger&&iR("input",{type:"button",onClick:this.props.removeTrigger.bind(this,this.props.triggerIndex),className:"MailTriggerSelector-button circular remove"}),iR("input",{type:"button",onClick:this.props.addTrigger,className:"MailTriggerSelector-button circular add"})),this.state.showCreateLabel&&iR(iv,{onClose:this.onCustomLabelDlgClose,windowId:this.props.windowId,viewMode:"float"})]})}}const lR=rR;var dR;function cR(e,t,n,i){dR||(dR="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:dR,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const hR={"Mail Filter":(0,le.Z)("Mail Filter"),Search:(0,le.Z)("mail filters","Search"),Actions:(0,le.Z)("mail filters","Actions"),Save:(0,le.Z)("Save"),Name:(0,le.Z)("mail filters","Filter Name")};class pR extends tn.Component{refButton=tn.createRef();state={filter:this.props.filter,showDialog:!1};componentDidUpdate(e){e.filter!==this.props.filter&&this.setState({filter:this.props.filter})}updateName=e=>{const t=e.target.value;this.setState((0,E.Uy)((({filter:e})=>{e.name=t})))};updateFilter=(e,t)=>{const n=t.target.value;this.setState((0,E.Uy)((({filter:t})=>{"query"===e&&(t.name&&t.name!==t.filterValue.query||(t.name=n)),t.filterValue[e]=n})))};addQuery=(e,t)=>{this.setState((0,E.Uy)((({filter:t})=>{const n=ot.Z.getAddedQuery(e),i=t.filterValue.query,s=i?i+" "+n:n;t.name&&t.name!==i||(t.name=s),t.filterValue.query=s,t={...t}})),(()=>t&&this.saveFilter()))};validate=e=>!(!e.filterValue||0===Object.keys(e.filterValue).length)||(this.setState({showDialog:!0}),!1);onClose=e=>{if(this.setState({showDialog:!1}),e){const e=!0;this.saveFilter(e)}};saveFilter=e=>{if(this.refButton.current?.onBeforeAddMailFilter())return;const t=this.cleanFilter(this.state.filter);(e||this.validate(t))&&(void 0===t.id?j.Z.addFilter(t):t.id&&this.props.filter.id&&j.Z.putFilter(t,this.props.filter))};cleanFilter=e=>{const t={...e};if(t.filterValue){const e={...t.filterValue};""===e.query&&(delete e.query,t.filterValue=e)}if(t.triggers){const e=t.triggers.filter((e=>!Object.values(e).some((e=>!e))));0===e.length?delete t.triggers:t.triggers=e}return t};getNewTrigger=()=>({type:"ADD_LABEL",label:""});addTrigger=()=>{const e=this.getNewTrigger();this.setState((0,E.Uy)((({filter:t})=>{t.triggers?t.triggers.push(e):t.triggers=[e]})))};removeTrigger=e=>{this.setState((0,E.Uy)((({filter:t})=>{const{triggers:n}=t;n&&(n.splice(e,1),0===n.length&&delete t.triggers)})))};editTrigger=(e,t)=>{this.setState((0,E.Uy)((({filter:n})=>{const{triggers:i}=n;i&&(i[e]=t)})))};render(){return cR("div",{className:"detail"},void 0,cR("div",{className:"detail-content"},void 0,cR("div",{className:"setting-group-double"},void 0,cR("div",{className:"setting-single"},void 0,cR(Ko.Z,{type:"text",onChange:this.updateName,label:this.props.searchableStrings.Name,value:this.state.filter.name||"",labelImportant:!0})),cR("div",{className:"setting-single"},void 0,(0,fn.jsx)(eR,{ref:this.refButton,saveFilter:this.saveFilter,isEmpty:!this.state.filter.filterValue.query,onSubmit:this.addQuery},this.state.filter.filterValue.query)),this.state.filter.filterValue.query&&cR("div",{className:"setting-single"},void 0,cR(Ko.Z,{type:"textarea",rows:"3",onChange:this.updateFilter.bind(this,"query"),label:this.props.searchableStrings.Search,labelImportant:!0,title:(0,le.Z)("Tokenized search through content, recipients, and subject field"),value:this.state.filter.filterValue.query||""})),cR("div",{className:"setting-single"},void 0,cR("div",{className:"MailActionManagerEditor-mailTriggerSelectors"},void 0,this.state.filter.triggers?(0,fn.jsxs)(fn.Fragment,{children:[cR("h3",{},void 0,this.props.searchableStrings.Actions),this.state.filter.triggers.map(((e,t)=>cR(lR,{trigger:e,triggerIndex:t,removeTrigger:this.removeTrigger,addTrigger:this.addTrigger,editTrigger:this.editTrigger,lastTrigger:!1,windowId:this.props.windowId},t)))]}):cR("input",{type:"button",value:(0,le.Z)("Add Action"),onClick:this.addTrigger}))))),cR("div",{className:"detail-toolbar"},void 0,!this.state.filter.id&&cR("input",{type:"button",className:"primary",onClick:()=>this.saveFilter(),disabled:this.props.filter===this.state.filter,value:(0,le.Z)("Add Mail Filter")}),this.state.filter.id&&cR("input",{type:"button",className:"primary",onClick:()=>this.saveFilter(),disabled:this.props.filter===this.state.filter,value:(0,le.Z)("Update Mail Filter")}),cR("input",{type:"button",disabled:this.props.filter===this.state.filter,onClick:()=>{this.setState({filter:this.props.filter})},value:(0,le.Z)("Cancel")})),this.state.showDialog&&cR(wk,{title:(0,le.Z)("Missing search"),prompt:[(0,le.Z)("By not specifying any search parameters you are about to apply an action to all your messages. Would you like to proceed?")],positive:(0,le.Z)("Apply to All"),negative:(0,le.Z)("Cancel"),danger:!0,onRequestClose:()=>this.setState({showDialog:!1}),onClose:this.onClose}))}}const uR=pR;var gR;function mR(e,t,n,i){gR||(gR="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:gR,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const vR=[D.kMailAccounts,D.kMailIsTurnedOff],fR={"Filters added in the mail panel will appear here.":(0,le.Z)("Filters added in the mail panel will appear here.")};class yR extends tn.PureComponent{constructor(e){super(e),this.state={mailFilters:this.loadMailFilters()}}componentDidMount(){it.Z.addListener(this.mailFiltersChanged)}componentWillUnmount(){it.Z.removeListener(this.mailFiltersChanged)}mailFiltersChanged=()=>{const e=this.loadMailFilters();this.state.mailFilters.length===e.length&&this.state.mailFilters.every(((t,n)=>t===e[n]))||this.setState({mailFilters:e})};loadMailFilters=()=>it.Z.getAll().filter((e=>e.accountId===ue.Kz&&e.path!==ue.ym));remapMailFilters=e=>e.map(((e,t)=>({...e,key:String(t)})));renderListItem=(e,t)=>(0,fn.jsxs)(fn.Fragment,{children:[mR("span",{className:"item-icon",dangerouslySetInnerHTML:{__html:cn.EnF.small}}),mR("div",{className:"item-title"},void 0,e)]});renderContent=(e,t)=>mR(uR,{searchableStrings:t,windowId:this.props.windowId,filter:this.state.mailFilters[e]});renderCreateListItem=()=>mR("div",{className:"item-title"},void 0,(0,le.Z)("New Filter"));renderCreate=e=>{const t={name:"",accountId:ue.Kz,path:Math.random().toString(36).substring(2),filterValue:{}};return mR(uR,{searchableStrings:e,windowId:this.props.windowId,filter:t})};renderEmpty=e=>mR("div",{className:"detail"},void 0,mR("div",{className:"detail-content"},void 0,mR("p",{},void 0,e["Filters added in the mail panel will appear here."])));removeAt=e=>{const t=this.state.mailFilters[e];j.Z.removeFilter(t.id)};render(){return 0===this.props.prefValues[D.kMailAccounts].length||this.props.prefValues[D.kMailIsTurnedOff]?null:mR(sx.Z,{title:(0,le.Z)("Mail Filters and Actions"),deleteTitle:(0,le.Z)("Delete Filter"),addTipString:(0,le.Z)("Add Mail Filter"),deleteTipString:(0,le.Z)("Delete Mail Filter"),masterLayout:1,items:this.remapMailFilters(this.state.mailFilters),onRemove:this.removeAt,renderListItem:this.renderListItem,renderContent:this.renderContent,contentStrings:hR,renderCreate:this.renderCreate,renderCreateListItem:this.renderCreateListItem,renderEmpty:this.renderEmpty,emptyStrings:fR,filter:this.props.filter,style:{height:400}})}}const wR=(0,fs.Z)(yR,vR);var bR;function CR(e,t,n,i){bR||(bR="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:bR,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const SR=[D.kMailPanelItemsOrder,D.kMailPanelItemsShowAccounts,D.kMailPanelItemsShowAllMessages,D.kMailPanelItemsShowCustomFolders,D.kMailPanelItemsShowFeeds,D.kMailPanelItemsShowFilters,D.kMailPanelItemsShowFlags,D.kMailPanelItemsShowLabels,D.kMailPanelItemsShowMailingLists],TR=new Map([["ALL_MESSAGES",{key:"ALL_MESSAGES",name:(0,le.Z)("All Messages"),showPref:D.kMailPanelItemsShowAllMessages}],["CUSTOM_FOLDERS",{key:"CUSTOM_FOLDERS",name:(0,le.Z)("Custom Folders"),showPref:D.kMailPanelItemsShowCustomFolders}],["MAILING_LISTS",{key:"MAILING_LISTS",name:(0,le.Z)("Mailing Lists"),showPref:D.kMailPanelItemsShowMailingLists}],["FILTERS",{key:"FILTERS",name:(0,le.Z)("Filters"),showPref:D.kMailPanelItemsShowFilters}],["FLAGS",{key:"FLAGS",name:(0,le.Z)("Flags"),showPref:D.kMailPanelItemsShowFlags}],["LABELS",{key:"LABELS",name:(0,le.Z)("Labels"),showPref:D.kMailPanelItemsShowLabels}],["FEEDS",{key:"FEEDS",name:(0,le.Z)("Feeds"),showPref:D.kMailPanelItemsShowFeeds}],["ACCOUNTS",{key:"ACCOUNTS",name:(0,le.Z)("All Accounts"),showPref:D.kMailPanelItemsShowAccounts}]]);class IR extends tn.PureComponent{constructor(e){super(e)}moveItem=(e,t)=>{const n=this.props.prefValues[D.kMailPanelItemsOrder].slice(),[i]=n.splice(e,1);n.splice(t,0,i),nt.Z.set(D.kMailPanelItemsOrder,n)};toggleShow=e=>{nt.Z.toggle(e,!0,!1)};renderListItem=(e,t)=>{const{key:n,name:i,showPref:s}=t;return CR("div",{},void 0,CR("input",{type:"checkbox",value:n,checked:this.props.prefValues[s],onChange:this.toggleShow.bind(this,s)}),i)};render(){const e=[];for(const t of this.props.prefValues[D.kMailPanelItemsOrder]){const n=TR.get(t);n&&e.push(n)}return CR("div",{className:"setting-single"},void 0,CR("h3",{},void 0,(0,le.Z)("Mail Panel Order and Visibility")),CR("p",{className:"info"},void 0,(0,le.Z)("Hide, show and re-order folders in the Mail Panel.")),CR("div",{className:"master-detail sortable-list qc-priority"},void 0,CR(MM.Z,{filter:this.props.filter,items:e,moveItem:this.moveItem,renderListItem:this.renderListItem,supportDragAndDrop:!0,mimeType:"vivaldi/x-settings-quick-command-type"})))}}const kR=(0,fs.Z)(IR,SR);var AR;function ZR(e,t,n,i){AR||(AR="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:AR,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const ER=[D.kCalendarRelativeDates,D.kMailAccounts,D.kMailAddArchiveFolder,D.kMailCheckInterval,D.kMailComposerColors,D.kMailMailtoInVivaldi,D.kMailCountersPanelDraftsEnabled,D.kMailCountersPanelSwitcherEnabled,D.kMailCountersPanelTrashEnabled,D.kMailCountersPanelUnseenEnabled,D.kMailCountersStatusButtonEnabled,D.kMailDefaultAccount,D.kMailDeleteInOtherLocations,D.kMailImapLogsOn,D.kMailIncludeIdentifyingHeaders,D.kMailMarkDeleteInOtherLocations,D.kMailNotifications,D.kMailNotificationsOnSuccessfullySent,D.kMailNotificationsSoundOn,D.kMailPreferredRendering,D.kMailPanelActivityIndicatorsEnabled,D.kMailPanelShowErrorMessages,D.kMailShowUnsubscribed,D.kMailSingleClickTabs,D.kMailSmtpLogsOn,D.kMailSearchOnEnter,D.kMailViewLayout,D.kMailDisplayMailPanelViewingMail,D.kMailOpenPanelAutomaticallyViewingMail],_R=nt.Z.getEventHandler;var NR=ZR("input",{type:"radio",value:"horizontal"}),MR=ZR("input",{type:"radio",value:"vertical"}),PR=ZR("input",{type:"radio",value:"vertical_wide"}),DR=ZR("input",{type:"radio",value:"one_minute"}),xR=ZR("input",{type:"radio",value:"fifteen_minutes"}),OR=ZR("input",{type:"radio",value:"manual"}),LR=ZR("input",{type:"radio",value:"prefer_html"}),RR=ZR("input",{type:"radio",value:"plaintext"}),BR=ZR("input",{type:"radio",value:ue.Y6}),FR=ZR("input",{type:"radio",value:"black_on_white"}),UR=ZR("input",{type:"radio",value:"inherit_themes"});class VR extends tn.Component{renderMailAccountRadioGroup=e=>e.map(((e,t)=>ZR("div",{className:"setting-single"},"default-account-"+t,ZR("label",{},void 0,ZR("input",{type:"radio",value:e.MAIL_EMAIL}),ZR("span",{},void 0,e.MAIL_EMAIL)))));render(){const e=this.props.prefValues[D.kMailAccounts];return ZR(a_,{categoryTitle:(0,le.Z)("Mail Settings"),filter:this.props.filter},void 0,ZR("div",{className:"setting-group"},void 0,ZR("div",{className:"setting-single"},void 0,ZR("label",{},void 0,ZR("input",{type:"checkbox",checked:this.props.prefValues[D.kMailImapLogsOn],onChange:_R(D.kMailImapLogsOn)}),ZR("span",{},void 0,(0,le.Z)("Turn on IMAP Logs in Console"),ZR("p",{className:"info"},void 0,(0,le.Z)("Reconnect mail accounts to make this effective. Note that this will degrade performance of the mail client."))))),ZR("div",{className:"setting-single"},void 0,ZR("label",{},void 0,ZR("input",{type:"checkbox",checked:this.props.prefValues[D.kMailSmtpLogsOn],onChange:_R(D.kMailSmtpLogsOn)}),ZR("span",{},void 0,(0,le.Z)("Turn on SMTP Logs in Console"),ZR("p",{className:"info"},void 0,(0,le.Z)("Turn this on for debugging problems with sending mail. Will take effect immediately. No need to reconnect.")))))),ZR("div",{className:"setting-group"},void 0,ZR("h3",{},void 0,(0,le.Z)("Mail View Layout")),ZR(ws,{name:"mailviewgroup",value:this.props.prefValues[D.kMailViewLayout],onChange:_R(D.kMailViewLayout)},void 0,ZR("div",{className:"setting-single"},void 0,ZR("label",{},void 0,NR,ZR("span",{},void 0,(0,le.Z)("mail","Horizontal")))),ZR("div",{className:"setting-single"},void 0,ZR("label",{},void 0,MR,ZR("span",{},void 0,(0,le.Z)("mail","Vertical")))),ZR("div",{className:"setting-single"},void 0,ZR("label",{},void 0,PR,ZR("span",{},void 0,(0,le.Z)("Vertical Wide"))))),ZR("div",{className:"setting-single pad-top"},void 0,ZR("label",{},void 0,ZR("input",{type:"checkbox",checked:this.props.prefValues[D.kCalendarRelativeDates],onChange:_R(D.kCalendarRelativeDates)}),ZR("span",{},void 0,(0,le.Z)("Use Relative Dates"))))),ZR("div",{className:"setting-group"},void 0,ZR("h3",{},void 0,(0,le.Z)("Mail Notifications")),ZR("div",{className:"setting-single"},void 0,ZR("label",{},void 0,ZR("input",{type:"checkbox",checked:this.props.prefValues[D.kMailNotifications],onChange:_R(D.kMailNotifications)}),ZR("span",{},void 0,(0,le.Z)("mail","Enabled")))),ZR("div",{className:"setting-single pad-left"},void 0,ZR("label",{},void 0,ZR("input",{type:"checkbox",checked:this.props.prefValues[D.kMailNotificationsSoundOn],disabled:!this.props.prefValues[D.kMailNotifications],onChange:_R(D.kMailNotificationsSoundOn)}),ZR("span",{},void 0,(0,le.Z)("Play Sound")))),ZR("div",{className:"setting-single"},void 0,ZR("label",{},void 0,ZR("input",{type:"checkbox",checked:this.props.prefValues[D.kMailNotificationsOnSuccessfullySent],disabled:!this.props.prefValues[D.kMailNotifications],onChange:_R(D.kMailNotificationsOnSuccessfullySent)}),ZR("span",{},void 0,(0,le.Z)("Notify on Successfully Sent"))))),ZR("div",{className:"setting-group"},void 0,ZR("h3",{},void 0,(0,le.Z)("Unseen Messages")),ZR("p",{className:"info"},void 0,(0,le.Z)("Highlight unread messages that have not been seen since the last check.")),ZR("div",{className:"setting-single"},void 0,ZR("label",{},void 0,ZR("input",{type:"checkbox",checked:this.props.prefValues[D.kMailCountersPanelUnseenEnabled],onChange:_R(D.kMailCountersPanelUnseenEnabled)}),ZR("span",{},void 0,(0,le.Z)("Highlight and Count Unseen Messages"))))),ZR("div",{className:"setting-group"},void 0,ZR("h3",{},void 0,(0,le.Z)("Mail Search")),ZR("div",{className:"setting-single"},void 0,ZR("label",{},void 0,ZR("input",{type:"checkbox",checked:this.props.prefValues[D.kMailSearchOnEnter],onChange:_R(D.kMailSearchOnEnter)}),ZR("span",{},void 0,(0,le.Z)("Start Search Using Enter Key"))))),ZR("div",{className:"setting-group"},void 0,ZR("h3",{},void 0,(0,le.Z)("Mailto Links")),ZR("div",{className:"setting-single"},void 0,ZR("label",{},void 0,ZR("input",{type:"checkbox",checked:this.props.prefValues[D.kMailMailtoInVivaldi],onChange:_R(D.kMailMailtoInVivaldi)}),ZR("span",{},void 0,(0,le.Z)("Handle Mailto Links in Vivaldi"))))),ZR("div",{className:"setting-group"},void 0,ZR("h3",{},void 0,(0,le.Z)("Mail Counters")),ZR("div",{className:"setting-single"},void 0,ZR("label",{},void 0,ZR("input",{type:"checkbox",checked:this.props.prefValues[D.kMailCountersStatusButtonEnabled],onChange:_R(D.kMailCountersStatusButtonEnabled)}),ZR("span",{},void 0,(0,le.Z)("Show on Status Button")))),ZR("div",{className:"setting-single"},void 0,ZR("label",{},void 0,ZR("input",{type:"checkbox",checked:this.props.prefValues[D.kMailCountersPanelSwitcherEnabled],onChange:_R(D.kMailCountersPanelSwitcherEnabled)}),ZR("span",{},void 0,(0,le.Z)("Show on Panel Button")))),ZR("div",{className:"setting-single"},void 0,ZR("label",{},void 0,ZR("input",{type:"checkbox",checked:this.props.prefValues[D.kMailCountersPanelTrashEnabled],onChange:_R(D.kMailCountersPanelTrashEnabled)}),ZR("span",{},void 0,(0,le.Z)("Include Trashed Messages")))),ZR("div",{className:"setting-single"},void 0,ZR("label",{},void 0,ZR("input",{type:"checkbox",checked:this.props.prefValues[D.kMailCountersPanelDraftsEnabled],onChange:_R(D.kMailCountersPanelDraftsEnabled)}),ZR("span",{},void 0,(0,le.Z)("Include Draft Messages"))))),ZR("div",{className:"setting-group"},void 0,ZR("h3",{},void 0,(0,le.Z)("mail","Panel")),ZR("div",{className:"setting-single"},void 0,ZR("label",{},void 0,ZR("input",{type:"checkbox",checked:this.props.prefValues[D.kMailDisplayMailPanelViewingMail],onChange:_R(D.kMailDisplayMailPanelViewingMail)}),ZR("span",{},void 0,(0,le.Z)("Display Mail Panel when Viewing Mail")))),ZR("div",{className:"setting-single pad-left"},void 0,ZR("label",{},void 0,ZR("input",{type:"checkbox",checked:this.props.prefValues[D.kMailOpenPanelAutomaticallyViewingMail],disabled:!this.props.prefValues[D.kMailDisplayMailPanelViewingMail],onChange:_R(D.kMailOpenPanelAutomaticallyViewingMail)}),ZR("span",{},void 0,(0,le.Z)("Open Panel Automatically")))),ZR("div",{className:"setting-single"},void 0,ZR("label",{},void 0,ZR("input",{type:"checkbox",checked:this.props.prefValues[D.kMailSingleClickTabs],onChange:_R(D.kMailSingleClickTabs)}),ZR("span",{},void 0,(0,le.Z)("Open Mail Tabs with Single Click")))),ZR("div",{className:"setting-single"},void 0,ZR("label",{},void 0,ZR("input",{type:"checkbox",checked:this.props.prefValues[D.kMailPanelActivityIndicatorsEnabled],onChange:_R(D.kMailPanelActivityIndicatorsEnabled)}),ZR("span",{},void 0,(0,le.Z)("Show Activity Indicators"))),ZR("p",{className:"info"},void 0,(0,le.Z)("Briefly display status next to folders when updating."))),ZR("div",{className:"setting-single"},void 0,ZR("label",{},void 0,ZR("input",{type:"checkbox",checked:this.props.prefValues[D.kMailPanelShowErrorMessages],onChange:_R(D.kMailPanelShowErrorMessages)}),ZR("span",{},void 0,(0,le.Z)("Error Messages"))),ZR("p",{className:"info"},void 0,(0,le.Z)("Display errors in Mail Panel. They are also accessible via Mail Status Button."))),ZR("div",{className:"setting-single"},void 0,ZR("label",{},void 0,ZR("input",{type:"checkbox",checked:this.props.prefValues[D.kMailShowUnsubscribed],onChange:_R(D.kMailShowUnsubscribed)}),ZR("span",{},void 0,(0,le.Z)("Show Unsubscribed Mailboxes"))))),ZR("div",{className:"setting-group"},void 0,ZR(kR,{filter:this.props.filter})),ZR("div",{className:"setting-group"},void 0,ZR("h3",{},void 0,(0,le.Z)("Check For New Mail")),ZR(ws,{name:"mailcheckintervalgroup",value:this.props.prefValues[D.kMailCheckInterval],onChange:_R(D.kMailCheckInterval)},void 0,ZR("div",{className:"setting-single"},void 0,ZR("label",{},void 0,DR,ZR("span",{},void 0,(0,le.Z)("Every Minute")))),ZR("div",{className:"setting-single"},void 0,ZR("label",{},void 0,xR,ZR("span",{},void 0,(0,le.Z)("Every 15 Minutes")))),ZR("div",{className:"setting-single"},void 0,ZR("label",{},void 0,OR,ZR("span",{},void 0,(0,le.Z)("mail","Manually")))))),ZR("div",{className:"setting-group"},void 0,ZR("h3",{},void 0,(0,le.Z)("Mail rendering")),ZR(ws,{name:"mailpreferredrendering",value:this.props.prefValues[D.kMailPreferredRendering],onChange:_R(D.kMailPreferredRendering)},void 0,ZR("div",{className:"setting-single"},void 0,ZR("label",{},void 0,LR,ZR("span",{},void 0,(0,le.Z)("Prefer HTML over text")))),ZR("div",{className:"setting-single"},void 0,ZR("label",{},void 0,RR,ZR("span",{},void 0,(0,le.Z)("Text only")))))),e&&ZR("div",{className:"setting-group"},void 0,ZR("h3",{},void 0,(0,le.Z)("Default Sender in New Messages")),ZR("p",{className:"info"},void 0,(0,le.Z)("Used as fallback if no account is selected")),ZR(ws,{name:"maildefaultaccountgroup",value:this.props.prefValues[D.kMailDefaultAccount]||ue.Y6,onChange:_R(D.kMailDefaultAccount)},void 0,this.renderMailAccountRadioGroup(e),ZR("div",{className:"setting-single"},"default-account-mru",ZR("label",{},void 0,BR,ZR("span",{},void 0,(0,le.Z)("Most Recently Used")))))),ZR("div",{className:"setting-group"},void 0,ZR("h3",{},void 0,(0,le.Z)("Composer Colors")),ZR("p",{className:"info"},void 0,(0,le.Z)("Doesn’t affect the color of sent messages")),ZR(ws,{name:"mailcomposercolors",value:this.props.prefValues[D.kMailComposerColors],onChange:_R(D.kMailComposerColors)},void 0,ZR("div",{className:"setting-single"},"composer-background-white",ZR("label",{},void 0,FR,ZR("span",{},void 0,(0,le.Z)("Black on White")))),ZR("div",{className:"setting-single"},"composer-background-theme",ZR("label",{},void 0,UR,ZR("span",{},void 0,(0,le.Z)("Inherit Theme Colors")))))),ZR("div",{className:"setting-group"},void 0,ZR("h3",{},void 0,(0,le.Z)("Optional Mail Headers")),ZR("p",{className:"info"},void 0,(0,le.Z)("Mail headers to include when sending messages")),ZR("div",{className:"setting-single"},void 0,ZR("label",{},void 0,ZR("input",{type:"checkbox",checked:this.props.prefValues[D.kMailIncludeIdentifyingHeaders],onChange:_R(D.kMailIncludeIdentifyingHeaders)}),ZR("span",{},void 0,(0,le.Z)("mail","Mail client identification headers"))))),ZR("div",{className:"setting-group"},void 0,ZR("div",{className:"setting-single"},void 0,ZR("h3",{},void 0,(0,le.Z)("Delete Duplicate Messages")),ZR("select",{value:this.props.prefValues[D.kMailMarkDeleteInOtherLocations],onChange:_R(D.kMailMarkDeleteInOtherLocations)},void 0,ZR("option",{value:"ask"},void 0,(0,le.Z)("Ask")),ZR("option",{value:"folders"},void 0,(0,le.Z)("From All Folders on Current Account")),ZR("option",{value:"accounts"},void 0,(0,le.Z)("From All Accounts and Folders")))),ZR("div",{className:"setting-single pad-top"},void 0,ZR("h3",{},void 0,(0,le.Z)("Permanently Delete Duplicate Messages")),ZR("select",{value:this.props.prefValues[D.kMailDeleteInOtherLocations],onChange:_R(D.kMailDeleteInOtherLocations)},void 0,ZR("option",{value:"ask"},void 0,(0,le.Z)("Ask")),ZR("option",{value:"selected"},void 0,(0,le.Z)("From the Current Folder Only")),ZR("option",{value:"folders"},void 0,(0,le.Z)("From All Folders on Current Account")),ZR("option",{value:"accounts"},void 0,(0,le.Z)("From All Accounts and Folders"))))),ZR("div",{className:"setting-group"},void 0,ZR("h3",{},void 0,(0,le.Z)("Archive Actions")),ZR("div",{className:"setting-single"},"add-archive-folder",ZR("label",{},void 0,ZR("input",{type:"checkbox",checked:this.props.prefValues[D.kMailAddArchiveFolder],onChange:_R(D.kMailAddArchiveFolder)}),ZR("span",{},void 0,(0,le.Z)("Add archive folder if missing"))))))}}const WR=(0,fs.Z)(VR,ER);var HR,zR=n(95538);function GR(e,t,n,i){HR||(HR="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:HR,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var $R=GR("input",{type:"radio",value:!0}),KR=GR("input",{type:"radio",value:!1});class jR extends tn.PureComponent{state={ignoredMailingLists:zR.Z.getIgnored()};componentDidMount(){$g.C.addListener(this.mailingListsChanged)}componentWillUnmount(){$g.C.removeListener(this.mailingListsChanged)}mailingListsChanged=e=>{if("mailingLists"===e.target){const e=zR.Z.getIgnored();if(this.state.ignoredMailingLists.length===e.length&&this.state.ignoredMailingLists.every(((t,n)=>t===e[n])))return;this.setState({ignoredMailingLists:e})}};remap=e=>e.map(((e,t)=>({name:e.listId,key:String(t)})));renderListItem=(e,t)=>GR("span",{title:t.listId},void 0,e);onRemove=e=>{j.Z.removeIgnoredMailingList(this.state.ignoredMailingLists[e])};onChangeIgnoreAll=e=>{const{value:t}=e.target,n="true"===t,i=zR.Z.get(ue.ZW);i&&i.isIgnored!==n&&(i.isIgnored=!i.isIgnored,j.Z.updateMailingListGroup(i))};render(){return GR("div",{className:"detail"},void 0,GR("div",{className:"detail-content"},void 0,GR("div",{className:"setting-group unlimited"},void 0,GR("h3",{},void 0,(0,le.Z)("Uncategorized mailing lists")),GR("p",{className:"info"},void 0,(0,le.Z)("Manage the rest of the mailing lists that have been automatically generated using the list-id attribute"))),GR(ws,{name:"subFolderType",value:zR.Z.areUncategorizedMailingListsIgnored(),onChange:this.onChangeIgnoreAll,className:"setting-group unlimited"},void 0,GR("div",{className:"setting-single"},void 0,GR("label",{},void 0,$R,GR("span",{},void 0,(0,le.Z)("mailinglist subfolder","Ignore All")))),GR("div",{className:"setting-single"},void 0,GR("label",{},void 0,KR,GR("span",{},void 0,(0,le.Z)("Ignore Selected"))))),GR("div",{className:"setting-single master-detail sortable-list"},void 0,GR(MM.Z,{items:this.remap(this.state.ignoredMailingLists),renderListItem:this.renderListItem,filter:this.props.filter,deleteTipString:(0,le.Z)("Stop ignoring uncategorized mailing list"),supportDragAndDrop:!1,onRemove:this.onRemove}))))}}const YR=jR;var XR;function QR(e,t,n,i){XR||(XR="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:XR,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const qR={Sender:(0,le.Z)("Sender"),"List ID":(0,le.Z)("List ID")};var JR=QR("input",{type:"radio",value:"true"}),eB=QR("input",{type:"radio",value:"false"});class tB extends tn.Component{state={mailingList:this.props.mailingList,updating:!1};componentDidUpdate(e){e.mailingList!==this.props.mailingList&&this.setState({mailingList:this.props.mailingList,updating:!1})}updateListId=e=>{const t=e.target.value;this.setState((0,E.Uy)((({mailingList:e})=>{e.listId===e.name&&(e.name=t),e.listId=t})))};updateName=e=>{const t=e.target.value;this.setState((0,E.Uy)((({mailingList:e})=>{e.name=t})))};onlyPathChanged=()=>Object.keys(this.state.mailingList).every((e=>"name"===e?this.state.mailingList[e]!==this.props.mailingList[e]:this.state.mailingList[e]===this.props.mailingList[e]));saveMailingList=async()=>{this.setState({updating:!0}),this.onlyPathChanged()?await j.Z.updateMailingListGroupName(this.state.mailingList):await j.Z.updateMailingListGroup(this.state.mailingList)};hasChanged=()=>this.state.mailingList!==this.props.mailingList;isIgnoredChanged=e=>{const t=e.target.value;this.setState((0,E.Uy)((({mailingList:e})=>{e.isIgnored="true"===t})))};onChangeSubfolderType=e=>{const t=e.target.value;this.setState((0,E.Uy)((({mailingList:e})=>{e.subFolderType=t})))};onChangeParentFolder=e=>{const t=e.target.value;this.setState((0,E.Uy)((({mailingList:e})=>{e.parentFolderType=t})))};cancel=()=>{this.setState({mailingList:this.props.mailingList})};render(){const e=this.state.mailingList;return QR("form",{className:"detail",style:{overflowY:"scroll"}},void 0,QR("div",{className:"detail-content"},void 0,QR("div",{className:"setting-group unlimited"},void 0,QR("h3",{},void 0,(0,le.Z)("Mailing List Group")),QR("p",{className:"info"},void 0,(0,le.Z)("Group your autogenerated mailing lists. When a match is found, the whole list ID is used to group messages."))),QR("div",{className:"setting-group unlimited"},void 0,QR("div",{className:"setting-single"},void 0,QR("label",{},void 0,this.props.searchableStrings["List ID"],QR("select",{name:"parentFolderType",value:e.parentFolderType,onChange:this.onChangeParentFolder},void 0,QR("option",{value:"endsWith"},void 0,(0,le.Z)("Ends with")),QR("option",{value:"startsWith"},void 0,(0,le.Z)("Starts with"))),QR("input",{type:"text",onChange:this.updateListId,value:e.listId,disabled:!this.props.isCreating}))),QR(ws,{name:"mailcheckintervalgroup",value:e.isIgnored,onChange:this.isIgnoredChanged,className:"setting-single"},void 0,QR("div",{className:"setting-single"},void 0,QR("label",{},void 0,JR,QR("span",{},void 0,(0,le.Z)("Not a Mailing List")))),QR("div",{className:"setting-single"},void 0,QR("label",{},void 0,eB,QR("span",{},void 0,(0,le.Z)("A Mailing List"))))),QR("div",{className:"setting-single"},void 0,QR("label",{},void 0,QR("span",{},void 0,(0,le.Z)("Folder Name")),QR("input",{type:"text",onChange:this.updateName,disabled:e.isIgnored,value:e.name}))),QR("div",{className:"setting-single"},void 0,QR("label",{},void 0,QR("span",{},void 0,(0,le.Z)("Subfolder Grouping")),QR("select",{disabled:e.isIgnored,name:"subFolderType",value:e.subFolderType,onChange:this.onChangeSubfolderType},void 0,QR("option",{value:"none"},void 0,(0,le.Z)("mailinglist subfolder","None")),QR("option",{value:"host"},void 0,(0,le.Z)("Host")),QR("option",{value:"title"},void 0,(0,le.Z)("Title")),QR("option",{value:"senderName"},void 0,(0,le.Z)("Sender Name"))))),this.state.updating&&QR(Tr,{type:"info"},void 0,(0,le.Z)("Updating")))),QR("div",{className:"detail-toolbar"},void 0,!this.props.isCreating&&(0,fn.jsxs)(fn.Fragment,{children:[QR("input",{type:"submit",className:"primary",disabled:!this.hasChanged()||this.state.updating,onClick:this.saveMailingList,value:(0,le.Z)("Update Mailing List Group")}),QR("input",{type:"button",disabled:!this.hasChanged(),onClick:this.cancel,value:(0,le.Z)("Cancel")})]}),this.props.isCreating&&QR("input",{type:"submit",className:"primary",disabled:this.props.mailingList===this.state.mailingList||this.state.updating,onClick:this.saveMailingList,value:(0,le.Z)("Add Mailing List Group")})))}}const nB=tB;var iB;function sB(e,t,n,i){iB||(iB="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:iB,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const oB=[D.kMailAccounts,D.kMailIsTurnedOff],aB={"Mailing lists added in the mail panel will appear here.":(0,le.Z)("Mailing lists added in the mail panel will appear here.")};var rB=sB("svg",{className:"item-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16"},0,sB("path",{opacity:".35",d:"M0 3h8v1H0zM0 5h3v1H0zM0 7h3v1H0z"}),sB("path",{d:"M15 5H5a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1zm-1 4l-4 2-4-2V7l4 2 4-2z"}));class lB extends tn.PureComponent{constructor(e){super(e),this.state={mailingListGroups:this.getMailingLists()}}componentDidMount(){zR.Z.addListener(this.mailingListGroupsChanged)}componentWillUnmount(){zR.Z.removeListener(this.mailingListGroupsChanged)}mailingListGroupsChanged=()=>{const e=this.getMailingLists();this.state.mailingListGroups.length===e.length&&this.state.mailingListGroups.every(((t,n)=>t===e[n]))||this.setState({mailingListGroups:e})};getMailingLists=()=>zR.Z.getGroups();remapMailingListGroups=e=>{const t=[...e];return t.push({name:"Uncategorized mailing lists",isDefault:!0}),t.map(((e,t)=>{let n=e.name;return e.listId&&n!==e.listId&&(n+=" ("+e.listId+")"),{...e,name:n,key:String(t)}}))};getFavicon=e=>{if(e){const t=e.split("@");if(t&&2===t.length){const e=t[1].split(".");if(e&&e[1]&&e[1].length>1)return sB(Oi,{className:"item-icon",url:`${t[1]}`,loadType:"page"},0)}}return rB};renderListItem=(e,t)=>(0,fn.jsxs)(fn.Fragment,{children:["matches"!==t.parentFolderType&&this.getFavicon(t.listId),sB("div",{className:"item-title"},void 0,e)]});renderContent=(e,t)=>this.state.mailingListGroups.length===e?sB(YR,{filter:this.props.filter}):sB(nB,{searchableStrings:t,mailingList:this.state.mailingListGroups[e]});renderEmpty=e=>sB("div",{className:"detail"},void 0,sB("div",{className:"detail-content"},void 0,sB("p",{},void 0,e["Mailing lists added in the mail panel will appear here."])));renderCreateListItem=()=>sB("div",{className:"item-title"},void 0,(0,le.Z)("New Mailing List Group"));renderCreate=e=>sB(nB,{isCreating:!0,searchableStrings:e,mailingList:{name:"",isIgnored:!1,subFolderType:"host",parentFolderType:"endsWith",listId:""}});removeAt=e=>{this.setState((t=>{const n=[...t.mailingListGroups],[i]=n.splice(e,1);return j.Z.removeMailingListGroup(i),{mailingListGroups:n}}))};render(){if(0===this.props.prefValues[D.kMailAccounts].length||this.props.prefValues[D.kMailIsTurnedOff])return null;const e=this.remapMailingListGroups(this.state.mailingListGroups);return sB(sx.Z,{title:(0,le.Z)("Mailing Lists"),className:"setting-mailing-lists",deleteTitle:(0,le.Z)("Delete List"),addTipString:(0,le.Z)("Add Mailing List"),deleteTipString:(0,le.Z)("Delete Mailing List"),items:e,onRemove:this.removeAt,masterLayout:1,renderListItem:this.renderListItem,renderContent:this.renderContent,contentStrings:qR,renderCreate:this.renderCreate,renderCreateListItem:this.renderCreateListItem,renderEmpty:this.renderEmpty,emptyStrings:aB,filter:this.props.filter,style:{height:400}},e.length)}}const dB=(0,fs.Z)(lB,oB),cB="vivaldi/x-commanditem",hB="vivaldi/x-commandfolder",pB="vivaldi/x-commandmixed",uB="vivaldi/x-menuitem",gB="vivaldi/x-menudefaulttopfolder",mB="vivaldi/x-menufolder",vB="vivaldi/x-menumixed",fB="vivaldi/x-bookmarkcontainer";function yB(e){return(0,Rd.$)(e)}var wB;function bB(e,t,n,i){wB||(wB="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:wB,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var CB=bB("hr",{className:"separator-left"}),SB=bB("hr",{className:"separator-right"});class TB extends tn.Component{static contextType=dn.Z;refTreeList=tn.createRef();_searchKey="";_appendToSearch=!1;_isIMEOpen=!1;state={commandItems:[],searchFilter:""};componentDidMount(){this._isMounted=!0,this._initialSetup(),U.Z.addListener(this._onCommandStoreChanged)}_initialSetup=(0,Zr.Z)((async(e="")=>{if(!this._isMounted)return!1;const{commandItems:t,searchFilter:n}=await this._getStateWithSearchFilter(e);this.setState({commandItems:t,searchFilter:n})}),200);componentWillUnmount(){this._isMounted=!1,clearTimeout(this._timeout),U.Z.removeListener(this._onCommandStoreChanged)}componentDidUpdate(e,t){0===t.commandItems?.length&&this.state.commandItems.length>0&&this.refTreeList.current?.selectByNode(this.state.commandItems[0]),this.props.menu!==e.menu&&this._initialSetup(this.state.searchFilter)}_onCommandStoreChanged=e=>{if("menu"===e){const e=this.state.searchFilter;this._initialSetup(e)}};_getStateWithSearchFilter=async e=>{const t="chainfolder",n="appfolder",i=e=>e.sort(((e,t)=>{if("container"===e.type&&"container"===t.type){const n=e.settingsLabel||"",i=t.settingsLabel||"";return n<i?-1:n>i?1:0}return"container"===e.type&&"container"!==t.type?"separator"===t.type?1:-1:"container"!==e.type&&"container"===t.type?"separator"===e.type?-1:1:"separator"===e.type||"separator"===t.type||e.label<t.label?-1:e.label>t.label?1:0})),s=(e,t)=>({parentId:e,id:t.id||"",type:t.type,label:t.settingsLabel||t.label,action:"",shortcuts:t.shortcuts}),o=e=>i(U.Z.makeCommandList(this.context.vivaldiWindowId).filter((t=>-1!==(t.settingsLabel||t.label||"").toLowerCase().indexOf(e)))),a=async e=>{const t=await U.Z.getChainCommandsShortcuts();return i(M.Z.get(D.kChainedCommandsCommandList).map((e=>{const n=t.find((t=>t.name===e.name));return{type:"command",action:e.name,id:e.name,...G.Z.makeLabelPair(e.label),shortcuts:n?.shortcuts}})).filter((t=>-1!==(t.label||"").toLowerCase().indexOf(e))))},r=(e,t)=>i(Ai.makeCommandList(this.context.vivaldiWindowId,e).filter((e=>{const n=e.settingsLabel||e.label;return void 0===n?(console.warn("Action ignored for command list",e.action),!1):-1!==n.toLowerCase().indexOf(t)})));let l=[];if(!Ai.isSection(this.props.menu)){const i=e.toLowerCase();l=Ai.getKeys().includes(this.props.menu)?await(async(e,i)=>{const l=r(e,i).map((e=>s(t,e))),d=o(i).map((e=>s(n,e))),c=(await a(i)).map((e=>s(t,e)));return[{id:"contextfolder",parentId:"",label:(0,le.Z)("Context Commands"),action:"",type:"folder",children:l},{id:n,parentId:"",label:(0,le.Z)("Application Commands"),action:"",type:"folder",children:d},{id:t,parentId:"",label:(0,le.Z)("Command Chains"),action:"",type:"folder",children:c}]})(this.props.menu,i):await(async e=>{const i=o(e).map((e=>s(n,e))),r=(await a(e)).map((e=>s(t,e)));return[{id:n,parentId:"",label:(0,le.Z)("Application Commands"),action:"",type:"folder",children:i},{id:t,parentId:"",label:(0,le.Z)("Command Chains"),action:"",type:"folder",children:r}]})(i);const d={parentId:"",id:"separator",type:"separator",action:"",label:""};l.splice(0,0,d);const c=U.Z.makeCommandList(this.context.vivaldiWindowId,U.Z.getOpenLinkName());if(c&&1===c.length&&c[0].id){const e={parentId:"",id:c[0].id,type:c[0].type,action:"",label:c[0].label};l.splice(0,0,e)}}return{searchFilter:e,commandItems:l}};_hasChildren=e=>Boolean(e.children?.length);_isFolder=e=>Boolean(e.children);_isSeparator=e=>"separator"===e.type;_isValidDragSource=e=>!this._isFolder(e);_validateForDrag=e=>e;_getDragData=(e,t)=>"";_getNodeById=e=>{const t=n=>{if(n)for(let i=0;i<n.length;i++){const s=n[i];if(s.id===e)return s;if(s.children){const e=t(s.children);if(e)return e}}};return t(this.state.commandItems)};_getMimeData=e=>{let t="";const n=[];return e.forEach((e=>{const i=this._getNodeById(e);if(i&&void 0!==i.type){t="folder"===i.type?""===t||t===hB?hB:pB:""===t||t===cB?cB:pB;const e={id:"",type:i.type,action:i.id};"folder"===i.type&&(e.title=i.label);const s=U.Z.getCommandParameter(e.action);if(s&&(e.parameter=s),U.Z.getOpenLinkName()===e.action){const t=U.Z.getCommandLabel(e.action);t&&(e.title=t)}const o={menu:"contextfolder"===i.parentId?this.props.menu:"",node:e};n.push(o)}})),{mimeType:t,payload:JSON.stringify(n)}};_setDragData=(e,t)=>{const n=this._getMimeData(t);e.setData(n.mimeType,n.payload)};_copy=(e,t)=>{const n=e.clipboardData;if(n){const e=this._getMimeData(t);n.setData(e.mimeType,e.payload)}(0,Cs.Z)(e)};_onKeyDown=e=>{const t=(e,t,n)=>{for(let i=t;i<n.length;i++){const t=n[i];if(t.label&&t.label.toUpperCase().startsWith(e))return t}};switch(e.key){case"ArrowUp":case"ArrowDown":case"PageUp":case"PageDown":break;default:const{ctrlKey:n,altKey:i,shiftKey:s,metaKey:o}=e,a={ctrlKey:n,altKey:i,shiftKey:s,metaKey:o};if((0,xr.VV)(a)){const n=this.refTreeList.current?.getSelectedItem(),i=n?this._getNodeById(n.parentId):void 0,s=i?i.children||[]:this.state.commandItems,o=(n?s.findIndex((e=>e.id===n.id)):-1)+1,a=this._searchKey.length;if("ArrowLeft"===e.key||"ArrowRight"===e.key){if(0===a)break}else if(this._appendToSearch&&!1===e.repeat){const t=e.key.toUpperCase();1===a&&this._searchKey[0]===t||(this._searchKey+=t)}else this._searchKey=e.key.toUpperCase();let r=t(this._searchKey,o,s);r||0===o||(r=t(this._searchKey,0,s)),r&&(this.refTreeList.current?.selectByNode(r),e.preventDefault()),clearTimeout(this._timeout),this._appendToSearch=!0,this._timeout=setTimeout((()=>{this._appendToSearch=!1}),400)}}};_onSearchFilterChange=async e=>{if(this._isIMEOpen)this.setState({searchFilter:e.target.value});else{const t=await this._getStateWithSearchFilter(e.target.value);this.setState(t)}};_handleExpandClick=e=>{this.refTreeList.current?.toggleSelectedExpansion(e)};_getContextMenuItems=e=>e?[{testVisibility:()=>{const e=this.refTreeList.current?.getAllSelectedItems().filter((e=>this._isValidForClipboard(e))).map((e=>e.id));return e&&e.length>0&&this.props.canAddToTree()},handler:()=>{const e=this.refTreeList.current?.getAllSelectedItems().filter((e=>this._isValidForClipboard(e))).map((e=>e.id));if(e){const t=this._getMimeData(e);this.props.addToTree(t.mimeType,t.payload)}},...(0,Mn.Z)("Add to Content")}]:[];_getContextMenuItemProps=e=>({showCopy:this._isValidForClipboard(e)});_isValidForClipboard=e=>!this._isFolder(e);rowComponent=e=>{const t=e.node,n=t.level*$u+"px",i=(t.level+1)*$u+"px";if(this._isSeparator(t))return bB("label",{style:{marginLeft:i}},"0",CB,(0,le.Z)("Menu Separator"),SB);let s=t.label;t.ellipsis&&(s+=G.Z.ellipsisString()),"container"===t.type&&t.settingsLabel&&(s=t.settingsLabel);const o=this._isFolder(t)&&this._hasChildren(t);let a=M.Z.get(D.kKeyboardShortcutsEnable);return t.shortcuts?.length>0&&1===t.shortcuts[0].length&&a&&(a=G.Z.hasBrowserFeature(t)?M.Z.get(D.kKeyboardShortcutsEnableSingleKey):M.Z.get(D.kKeyboardShortcutsEnableSingleKeyForMail)),bB("label",{},"0",o&&bB("span",{className:"expand-icon",style:{marginLeft:n},onMouseDown:Cs.Z,onMouseUp:()=>this._handleExpandClick(t.id),dangerouslySetInnerHTML:{__html:cn.nfH}}),bB("span",{className:"title",style:o?null:{marginLeft:i}},void 0,s),t.shortcuts&&t.shortcuts.length>0&&bB("span",{className:"item-count"},void 0,yB(t.shortcuts[0])))};render(){return(0,fn.jsxs)(fn.Fragment,{children:[(0,fn.jsx)(Yu,{ref:this.refTreeList,rowComponent:this.rowComponent,nodes:this.state.commandItems,enableDragAndDrop:!0,validateForDrag:this._validateForDrag,isValidDragSource:this._isValidDragSource,getDragData:this._getDragData,setCustomDragData:this._setDragData,hasChildren:this._hasChildren,isFolder:this._isFolder,isValidForClipboard:this._isValidForClipboard,onCopy:this._copy,getContextMenuItems:this._getContextMenuItems,getContextMenuItemProps:this._getContextMenuItemProps,onKeyDown:this._onKeyDown}),bB("div",{className:"setting-single"},void 0,bB("input",{type:"search",className:"menu-search",value:this.state.searchFilter,placeholder:(0,le.Z)("Filter Commands"),onCompositionStart:()=>this._isIMEOpen=!0,onCompositionEnd:e=>{this._isIMEOpen=!1,this._onSearchFilterChange(e)},onChange:this._onSearchFilterChange}))]})}}const IB=TB;var kB,AB=n(34155);function ZB(e,t,n,i){kB||(kB="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:kB,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const EB="MenuTree",_B="MenuCutIds";class NB extends tn.Component{refTreeList=tn.createRef();static contextType=dn.Z;winId=-1;_isMounted=!1;_isMac=!1;_editHasFocus=!1;constructor(e,t){super(e),this.winId=t.vivaldiWindowId,this.state={rootId:"",role:"",menuItems:[],editId:"",editTitle:"",editUrl:"",autocompleteValue:"",url:"",cutIds:[]}}componentDidMount(){this._isMounted=!0,d.Z.menuContent.onChanged.addListener(this._onMenuChanged),d.Z.utilities.onSharedDataUpdated.addListener(this._onSharedDataChanged),$C.Z.addListener(this._onUrlbarStoreChanged),this._loadMenu()}componentWillUnmount(){this._isMounted=!1,d.Z.menuContent.onChanged.removeListener(this._onMenuChanged),d.Z.utilities.onSharedDataUpdated.removeListener(this._onSharedDataChanged),$C.Z.removeListener(this._onUrlbarStoreChanged)}componentDidUpdate(e,t){this.props.menu!==e.menu&&(this._cancelEdit(),this._loadMenu())}_onUrlbarStoreChanged=()=>{const{editUrl:e,autocompleteValue:t}=$C.Z.getUrlfieldStateFromId(EB);this.setState({autocompleteValue:t,editUrl:e})};getSelectedItem=()=>this.refTreeList.current?.getSelectedItem();_onMenuChanged=(e,t,n,i)=>{e===this.props.menu&&this._setMenu(e,t,n,this.state.role,i,!1)};_loadMenu=()=>{Ai.isSection(this.props.menu)?this._isMounted&&this.setState({rootId:"",role:"",menuItems:[]}):d.Z.menuContent.get(this.props.menu,((e,t,n)=>{this._setMenu(this.props.menu,e,"",t,n,!0)}))};_setMenu=(e,t,n,i,s,o)=>{const a=(e,t,n)=>{e.index=n,e.parentId=t,e.items&&(e.children=e.items,e.children.forEach(((t,n)=>{a(t,e.id,n)})))};((e,t,n)=>"context"===t?Ai.makeMenuWithContent(this.winId,e,n):Promise.resolve(U.Z.makeMenuWithContent(this.winId,n,{expandContainers:!1,inSettings:!0})))(e,i,s).then((e=>{e.forEach(((e,n)=>{a(e,t,n)})),this._isMounted&&this.setState({rootId:t,role:i,menuItems:e},(()=>{if(!0===o&&this.state.menuItems.length>0)this.refTreeList.current?.selectByNode(this.state.menuItems[0]);else{const e=this._getNodeById(n);e&&this.refTreeList.current?.selectByNode(e)}}))}))};_getNodeById=e=>{const t=n=>{if(n)for(let i=0;i<n.length;i++){const s=n[i];if(s.id===e)return s;if(s.children){const e=t(s.children);if(e)return e}}};return t(this.state.menuItems)};_hasChildren=e=>Boolean(e.children)&&e.children.length>0;_isFolder=e=>Boolean(e.children);_isContainer=e=>"container"===e.type;_isBookmarkContainer=e=>"CONTAINER_BOOKMARK"===e.container?.content;_isSeparator=e=>"separator"===e.type;_isLink=e=>e.commandName===U.Z.getOpenLinkName();_isDefaultTopFolder=e=>!this._isContextMenu()&&(!!this._isMac&&["MENU_APPLE_APP","MENU_FILE","MENU_EDIT","MENU_VIEW","MENU_BOOKMARKS","MENU_WINDOW","MENU_HELP"].includes(e.commandName));_isPersistent=e=>!this._isContextMenu()&&(!!this._isMac&&["MENU_APPLE_APP","MENU_BOOKMARKS","MENU_WINDOW","MENU_HELP"].includes(e.commandName));_canDeleteNode=e=>!!this._isContextMenu()||(!this._isMac||!this._isPersistent(e)&&!this._isBookmarkContainer(e));_isValidForClipboard=e=>this._isValidDragSource(e);_isValidDragSource=e=>!!this._isContextMenu()||(!this._isMac||!["MENU_APPLE_APP"].includes(e.commandName));_validateForDrag=e=>e.map(this._getNodeById).filter(Boolean).filter(this._isValidDragSource).map((e=>e.id));_validateForDeletion=e=>e.map(this._getNodeById).filter(Boolean).filter(this._canDeleteNode).map((e=>e.id));_validateForRename=e=>{const t=this._getNodeById(e);return!!t&&(!this._isSeparator(t)&&!1!==t.settingsRename)};_validateForEdit=e=>{const t=this._getNodeById(e);return!!t&&this._isLink(t)};_reset=e=>{d.Z.menuContent.reset(this.props.menu,[e],Tl.default)};_setContainerMode=(e,t)=>{d.Z.menuContent.update(this.props.menu,e,{containerMode:t},Tl.default)};_setShowShorcut=(e,t)=>{d.Z.menuContent.update(this.props.menu,e,{showshortcut:t},Tl.default)};_setContainerEdge=(e,t)=>{d.Z.menuContent.update(this.props.menu,e,{containerEdge:t},Tl.default)};_onEdit=()=>{const e=this.getSelectedItem();if(e){const t=e.url||"https://www.vivaldi.com";Of.Z.setUrlfieldState(EB,{selectionStart:0,selectionEnd:t.length,editUrl:void 0,autocompleteValue:""}),this.setState({editId:e.id,editTitle:e.label,url:t})}};_onTitleChanged=e=>{const t=e.target.value;this.setState({editTitle:t})};_onUrlChanged=e=>{this.setState({url:e?.url||""})};_onEditFocus=()=>{this._editHasFocus=!0};_onEditBlur=()=>{this._editHasFocus=!1,AB.nextTick((()=>{this._saveEdit(!this._editHasFocus,!1)}))};_cancelEdit=()=>{this.setState({editId:"",editTitle:"",editUrl:""})};_saveEdit=(e,t)=>{const n=this.state.editId;let i=(this.state.autocompleteValue||this.state.editUrl||this.state.url||"").trim();void 0===d.Z.utilities.getUrlFragments(i).scheme&&(i="http://"+i),d.Z.menuContent.update(this.props.menu,n,{title:this.state.editTitle,parameter:i},(()=>{e&&this.setState({editId:"",editTitle:"",editUrl:""},(()=>{const e=this._getNodeById(n);e&&(t&&this.refTreeList.current?.focusTree(),this.refTreeList.current?.expandToId(n),this.refTreeList.current?.selectByNode(e))}))}))};_handleEditKeyPress=e=>{"Escape"===e.key&&(e.preventDefault(),this._cancelEdit()),"Enter"===e.key&&(e.preventDefault(),this._saveEdit(!0,!0))};_getTitle=e=>{const t=this._getNodeById(e);if(t){let e=t.label;return t.ellipsis&&(e+=G.Z.ellipsisString()),e}return""};_saveTitle=(e,t)=>{d.Z.menuContent.update(this.props.menu,e,{title:t},Tl.default)};_isMenubarMenu=()=>"mac"===this.state.role||"horizontal"===this.state.role;_isContextMenu=()=>"context"===this.state.role;_getDragData=(e,t)=>"";_getMimeData=e=>{let t="",n=!1,i=!1;e.forEach((e=>{const s=this._getNodeById(e);s&&(this._isFolder(s)?(this._isDefaultTopFolder(s)&&(n=!0),t=""===t||t===mB?mB:vB):(this._isBookmarkContainer(s)&&(i=!0),t=""===t||t===uB?uB:vB))}));const s=[];return s.push({mimeType:t,payload:JSON.stringify(e)}),n&&s.push({mimeType:gB,payload:JSON.stringify(e)}),i&&s.push({mimeType:fB,payload:JSON.stringify(e)}),s};_setDragData=(e,t)=>{this._getMimeData(t).forEach((t=>{e.setData(t.mimeType,t.payload)}))};_getDropSupport=(e,t)=>{const n={available:!1,onto:!1,edge:!1};return n.available=t.dataTransfer.types.some((e=>e===uB||e===mB||e===vB||e===cB||e===hB||e===pB)),n.available&&(n.onto=this._canDropOnto(e,t),n.edge=this._canDropOnEdge(e,t)),n};_canDropOnto=(e,t)=>{if(this._isFolder(e)){if(this._isMac){if(t.dataTransfer.types.some((e=>e===fB)))return!1;if(t.dataTransfer.types.some((e=>e===mB))&&t.dataTransfer.types.some((e=>e===gB)))return!1}return!0}return!1};_canDropOnEdge=(e,t)=>0!==e.level||!this._isMenubarMenu()||(!this._isMac||0!==e.index)&&t.dataTransfer.types.some((e=>e===mB||e===vB||e===hB||e===pB));_getTargetSpec=(e,t)=>{const n={id:e.id,index:0,parentId:""};return this._isFolder(e)&&"on"===t?n.parentId=e.id:(n.parentId=e.parentId,n.index=e.index+("below"===t?1:0)),n};_canAddToTopLevel=e=>{let t=!0;return this._isMenubarMenu()&&e.forEach((e=>{"folder"!==e.type&&(t=!1)})),t};_handleMimeData=(e,t,n,i,s)=>{const o={type:""};if(this._hasCommandMimeType(i,o)){const n=JSON.parse(s(o.type)).map((e=>{if(!e.menu||e.menu===this.props.menu)return e.node})).filter(Boolean);return this._add(e,t,n,!0).then((()=>Promise.resolve([])))}if(this._hasMenuMimeType(i,o)){const i=s(o.type),a=JSON.parse(i);if(n){const n=[];return this._getContentTree(n,a),this._add(e,t,n,!1).then((()=>Promise.resolve([])))}return this._onMove(a,e,t).then((e=>{if(e&&e.length>0){const t=e[0];this.refTreeList.current?.expandToId(t),this.refTreeList.current?.setSelectedIds(e),this._setCutIds([])}return Promise.resolve([])}))}return Promise.resolve([])};_onDrop=(e,t,n)=>{const i="on"===n?t.id:t.parentId,s="on"===n?0:t.index+("below"===n?1:0),o=Jt.ZP.isCopyModifierPressed(e);return this._handleMimeData(i,s,o,e.dataTransfer.types,(t=>e.dataTransfer.getData(t)))};addToNode=(e,t,n)=>{const i=this._isFolder(e)?e.id:e.parentId,s=this._isFolder(e)?0:e.index+1,o=JSON.parse(t).map((e=>{if(!e.menu||e.menu===this.props.menu)return e.node})).filter(Boolean);return this._add(i,s,o,n)};_add=(e,t,n,i,s)=>this._addAtPosition(e,t,n,i).then((e=>{e?.length>0&&(this.refTreeList.current?.expandToId(e[0]),this.refTreeList.current?.setSelectedIds(e))}));_addAtPosition=(e,t,n,i)=>{const s=(e,t,n)=>Promise.all(e.map((e=>new Promise((i=>{d.Z.menuContent.create(this.props.menu,t,n++,[e],((t,n)=>{e.children?s(e.children,n[0],0).then((()=>{i(n[0])})):i(n[0])}))}))))),o=i&&1===n.length&&n[0].action===U.Z.getOpenLinkName();return s(n,e,t).then((e=>(o&&AB.nextTick(this._onEdit),e)))};_supportsUpDownMove=(e,t)=>!!this._isValidDragSource(e)&&!(0===e.level&&!0===t&&e.index<=1);_onMove=(e,t,n)=>new Promise((i=>{d.Z.menuContent.move(this.props.menu,e,t,n,(t=>{i(e)}))}));_onKeyPressed=e=>{"Escape"===e.key&&this._setCutIds([])};_setCutIds=e=>{d.Z.utilities.setSharedData({key:_B,value:e.length>0?e.join():""})};_onSharedDataChanged=(e,t)=>{if(e===_B){const e=t.length>0?t.split(","):[];e.length>0?window.addEventListener("keydown",this._onKeyPressed,!0):window.removeEventListener("keydown",this._onKeyPressed,!0),this.setState({cutIds:e})}};_cut=(e,t)=>{this._setCutIds(t);const n=e.clipboardData;if(n){n.setData("vivaldi/x-cut","true");this._getMimeData(t).forEach((e=>{n.setData(e.mimeType,e.payload)}))}(0,Cs.Z)(e)};_copy=(e,t)=>{const n=e.clipboardData;if(n){this._getMimeData(t).forEach((e=>{n.setData(e.mimeType,e.payload)}))}(0,Cs.Z)(e)};_getContentTree=(e,t)=>{t.forEach((t=>{const n=this._getNodeById(t);if(n){const t={id:"",action:n.commandName||"",type:n.type};if(t.action===U.Z.getOpenLinkName()&&(t.parameter=n.url,t.title=n.label),"folder"===t.type&&(t.title=n.label,t.children=[],n.children)){const e=n.children.map((e=>e.id)),i=[];this._getContentTree(i,e),t.children=i}e.push(t)}}))};_hasCommandMimeType=(e,t)=>{for(let n=0;n<e.length;n++){const i=e[n];switch(i){case cB:case hB:case pB:return t.type=i,!0}}return t.type="",!1};_hasMenuMimeType=(e,t)=>{for(let n=0;n<e.length;n++){const i=e[n];switch(i){case uB:case mB:case vB:return t.type=i,!0}}return t.type="",!1};_paste=(e,t)=>{const n=e.clipboardData;if(!n)return Promise.resolve([]);const i="true"===n.getData("vivaldi/x-cut");if(i&&0===this.state.cutIds.length)return Promise.resolve([]);const s=this._isFolder(t)?t.id:t.parentId,o=this._isFolder(t)?0:t.index+1;return this._handleMimeData(s,o,!i,n.types,(e=>n.getData(e))).then((e=>(i&&this._setCutIds([]),e)))};_onCreate=(e,t,n,i)=>i?new Promise((i=>{const s=[];let o=!1,a=!1;e.forEach(((e,t)=>{if(e.children)o=0===t,s.push({id:"",type:"folder",action:"",title:(0,le.Z)("command","New Folder")});else if(e.separator)s.push({id:"",type:"separator",action:""});else{a=0===t;const e=U.Z.getOpenLinkName();s.push({id:"",type:"command",action:e,title:U.Z.getCommandLabel(e)||"",parameter:U.Z.getCommandParameter(e)||""})}})),d.Z.menuContent.create(this.props.menu,t,void 0===n?-1:n,s,((e,t)=>{a&&AB.nextTick(this._onEdit);const n={items:t.map((e=>({id:e}))),props:{edit:o}};i(n)}))})):Promise.resolve({items:[]});_onRemove=e=>new Promise((t=>{d.Z.menuContent.remove(this.props.menu,e,(e=>{t(e)}))}));_handleExpandClick=e=>{this.refTreeList.current?.toggleSelectedExpansion(e)};_getContextMenuItemProps=e=>Ai.isSection(this.props.menu)?{}:e?{showMoveUp:this.refTreeList.current?.canMoveUpDown(e,!0),showMoveDown:this.refTreeList.current?.canMoveUpDown(e,!1),showRename:this._validateForRename(e.id),showEdit:this._validateForEdit(e.id),showDelete:this._canDeleteNode(e),showNewItem:!0,showNewSeparator:!0,showNewFolder:!0,showCut:this._canDeleteNode(e),showCopy:!0,showPaste:!0}:{showNewSeparator:!this._isMenubarMenu(),showNewFolder:!0,showPaste:!0};_getContextMenuNewItemString=()=>(0,Mn.Z)("New Link");_getNodeMenuItems=e=>[{handler:()=>this._reset(e.id),testVisibility:()=>this._isFolder(e)&&!e.custom,...(0,Mn.Z)("Restore Default Folder")},{testVisibility:()=>this._isContainer(e)&&!this._isBookmarkContainer(e),...(0,Mn.Z)("Show as Subfolder"),type:"checkbox",checked:"folder"===e.container?.mode,handler:()=>this._setContainerMode(e.id,"folder"===e.container?.mode?"inline":"folder")},{testVisibility:()=>this._isBookmarkContainer(e),...(0,Mn.Z)("Show 'Add Active Tab'"),items:[{type:"radio",checked:"above"===e.container?.edge,radiogroup:2,handler:this._setContainerEdge.bind(this,e.id,"above"),...(0,Mn.Z)("Above List")},{type:"radio",checked:"below"===e.container?.edge,radiogroup:2,handler:this._setContainerEdge.bind(this,e.id,"below"),...(0,Mn.Z)("Below List")},{type:"separator",name:""},{type:"radio",checked:"off"===e.container?.edge,handler:this._setContainerEdge.bind(this,e.id,"off"),radiogroup:2,...(0,Mn.Z)("radio","Hide")}]},{testVisibility:()=>!0,...(0,Mn.Z)("Show Shortcuts in Menu"),type:"checkbox",enabled:M.Z.get(D.kKeyboardShortcutsEnable),checked:!1!==e.showshortcut,handler:()=>this._setShowShorcut(e.id,!(!1!==e.showshortcut))}];_getContextMenuItems=e=>e?this._getNodeMenuItems(e):[];rowComponent=e=>{const{inlineEditText:t,node:n,onBlur:i,onChange:s,onFocus:o}=e,a=n.level*$u+"px",r=(n.level+1)*$u+"px";if(this._isSeparator(n))return ZB("label",{},"0",ZB("hr",{style:{marginLeft:r},className:"separator"}));let l=n.label;n.ellipsis&&(l+=G.Z.ellipsisString()),"container"===n.type&&(n.settingsLabel?l="inline"===n.container?.mode||this._isBookmarkContainer(n)?n.settingsLabel:(0,le.Z)("$1 (as Subfolder)",[n.settingsLabel]):"folder"===n.container?.mode&&(l=(0,le.Z)("$1 (as Subfolder)",[l])));const d=this._isFolder(n)&&this._hasChildren(n);let c=M.Z.get(D.kKeyboardShortcutsEnable);n.shortcuts?.length>0&&1===n.shortcuts[0].length&&c&&(c=G.Z.hasBrowserFeature(n)?M.Z.get(D.kKeyboardShortcutsEnableSingleKey):M.Z.get(D.kKeyboardShortcutsEnableSingleKeyForMail));const h=!1!==n.showshortcut;return ZB("label",{},"0",d&&ZB("span",{className:"expand-icon",style:{marginLeft:a},onMouseDown:Cs.Z,onMouseUp:()=>this._handleExpandClick(n.id),dangerouslySetInnerHTML:{__html:cn.nfH}}),void 0!==t&&ZB("input",{type:"text",value:t,onChange:s,onFocus:o,onBlur:i,autoFocus:!0}),void 0===t&&ZB("span",{className:"title",style:d?null:{marginLeft:r}},void 0,l),n.shortcuts?.length>0&&!h&&c&&ZB("span",{style:{textDecoration:"line-through"},className:"item-count"},void 0,yB(n.shortcuts[0])),n.shortcuts?.length>0&&h&&c&&ZB("span",{className:"item-count"},void 0,yB(n.shortcuts[0])))};render(){return this.state?this.state.editId?ZB("div",{onKeyDown:this._handleEditKeyPress},void 0,ZB("div",{className:"UrlField"},void 0,ZB("input",{type:"text",placeholder:(0,le.Z)("Title"),value:this.state.editTitle,onChange:this._onTitleChanged,onBlur:this._onEditBlur,onFocus:this._onEditFocus})),ZB(oS,{placeholder:(0,le.Z)("Address"),title:(0,le.Z)("Enter webpage address"),pageId:EB,autocompletionEnabled:!0,autoFocus:!1,displayUrl:this.state.url,editUrl:this.state.editUrl,handleDrop:!0,onChange:this._onUrlChanged,onBlur:this._onEditBlur,onFocus:this._onEditFocus,autoFocus:!0})):(0,fn.jsxs)(fn.Fragment,{children:[(0,fn.jsx)(Yu,{ref:this.refTreeList,rowComponent:this.rowComponent,nodes:this.state.menuItems,rootId:this.state.rootId,cutIds:this.state.cutIds,enableDragAndDrop:!Ai.isSection(this.props.menu),validateForDrag:this._validateForDrag,validateForDeletion:this._validateForDeletion,isValidDragSource:this._isValidDragSource,getDragData:this._getDragData,setCustomDragData:this._setDragData,getDropSupport:this._getDropSupport,onDrop:this._onDrop,onMove:this._onMove,onCreate:this._onCreate,onEdit:this._onEdit,delete:this._onRemove,isValidForClipboard:this._isValidForClipboard,onCut:this._cut,onCopy:this._copy,onPaste:this._paste,hasChildren:this._hasChildren,isFolder:this._isFolder,appendContextItems:!0,getContextMenuItems:this._getContextMenuItems,getContextMenuItemProps:this._getContextMenuItemProps,getContextMenuNewItemString:this._getContextMenuNewItemString,getTitle:this._getTitle,saveTitle:this._saveTitle,supportsInlineEdit:!0,supportsUpDownMove:this._supportsUpDownMove,isValidToEdit:this._validateForRename}),ZB("div",{className:"setting-single"},void 0,ZB("input",{type:"button",onClick:this.props.confirmReset,value:(0,le.Z)("Restore Default Menu")}))]}):null}}const MB=NB;var PB;function DB(e,t,n,i){PB||(PB="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:PB,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const xB=[D.kMenuDisplay];class OB extends tn.Component{refMenuTree=tn.createRef();constructor(e){super(e);const t="top"===this.props.prefValues[D.kMenuDisplay]?"menubar":"vivaldi";this.state={menu:t,confirmation:!1}}_onMenuChange=e=>{this.setState({menu:e.target.value})};_handleResetMenu=()=>{d.Z.menuContent.reset(this.state.menu,void 0,(()=>{})),this.closeConfirmation()};_canAddToTree=()=>Boolean(this.refMenuTree.current?.getSelectedItem());_addToTree=(e,t)=>{const n=this.refMenuTree.current,i=n?.getSelectedItem();n&&i&&n.addToNode(i,t,!0)};confirmReset=()=>this.setState({confirmation:!0});closeConfirmation=()=>this.setState({confirmation:!1});getMenuName=e=>{if(e||(e=this.state.menu),Ai.hasName(e))return Ai.getName(e);switch(e){case"vivaldi":return(0,le.Z)("Vivaldi Button Menu");case"menubar":return(0,le.Z)("Horizontal Menu");case"mac":return(0,le.Z)("Application Menu");default:return e}};renderModal=()=>{const e=this.getMenuName();return DB(ln.Z,{dialogWidth:400,onRequestClose:this.closeConfirmation,viewMode:"anchor slide"},void 0,DB("header",{className:"dialog-header"},void 0,DB("h1",{className:"dialog-title"},void 0,(0,le.Z)("Reset $1?",[e]))),DB("div",{className:"dialog-content"},void 0,DB("p",{},void 0,(0,le.Z)("$1 will be reset to its default state.",[e]))),DB("footer",{className:"dialog-footer"},void 0,DB("input",{type:"button",className:"primary",onClick:this._handleResetMenu,value:(0,le.Z)("Reset to Default"),autoFocus:!0}),DB("input",{type:"button",onClick:this.closeConfirmation,value:(0,le.Z)("Cancel")})))};_getOptionItems=()=>[...["vivaldi","menubar"].map((e=>({key:e,indent:1,name:this.getMenuName(e)}))),...Ai.getSettingsList()];render(){const e=this._getOptionItems().map((e=>0===e.indent?DB("optgroup",{label:e.name},e.key):DB("option",{value:e.key},e.key," ".repeat(2*e.indent),e.name)));return DB(jE.Z,{filter:this.props.filter},void 0,this.state.confirmation&&this.renderModal(),DB("div",{className:"setting-single"},void 0,DB("h3",{},void 0,(0,le.Z)("Menu Customization")),DB("select",{className:"menu-list",value:this.state.menu,onChange:this._onMenuChange},void 0,e)),DB("div",{className:"menu-lists"},void 0,DB("div",{className:"setting-single menu-commands"},void 0,DB("h3",{},void 0,(0,le.Z)("Content"))),DB("div",{className:"setting-single menu-commands"},void 0,DB("h3",{},void 0,(0,le.Z)("Commands"))),DB("div",{className:"setting-single menu-items"},void 0,(0,fn.jsx)(MB,{ref:this.refMenuTree,menu:this.state.menu,confirmReset:this.confirmReset,filter:this.props.filter})),DB("div",{className:"setting-single menu-commands"},void 0,DB(IB,{canAddToTree:this._canAddToTree,addToTree:this._addToTree,menu:this.state.menu,filter:this.props.filter}))))}}const LB=(0,fs.Z)(OB,xB);var RB;function BB(e,t,n,i){RB||(RB="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:RB,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const FB=[D.kMenuDisplay,D.kMenuIconType],UB=nt.Z.getEventHandler;var VB=BB("input",{type:"radio",value:"vivaldi"}),WB=BB("input",{type:"radio",value:"top"}),HB=BB("input",{type:"radio",value:"icon"}),zB=BB("input",{type:"radio",value:"burger"});class GB extends tn.PureComponent{render(){return BB(a_,{categoryTitle:(0,le.Z)("Menu"),filter:this.props.filter},void 0,BB("div",{className:"setting-group"},void 0,BB("h3",{},void 0,(0,le.Z)("title","Menu Position")),BB(ws,{name:"menuPosition",value:this.props.prefValues[D.kMenuDisplay],onChange:UB(D.kMenuDisplay),className:"group"},void 0,BB("div",{className:"setting-single"},void 0,BB("label",{},void 0,VB,BB("span",{},void 0,(0,le.Z)("menu","Vivaldi Button")))),BB("div",{className:"setting-single"},void 0,BB("label",{},void 0,WB,BB("span",{},void 0,(0,le.Z)("menu","Horizontal")))))),BB("div",{className:"setting-group"},void 0,BB("h3",{},void 0,(0,le.Z)("Menu Icon Style")),BB(ws,{name:"menuStyle",value:this.props.prefValues[D.kMenuIconType],onChange:UB(D.kMenuIconType),className:"group"},void 0,BB("div",{className:"setting-single"},void 0,BB("label",{},void 0,HB,BB("span",{},void 0,(0,le.Z)("Vivaldi Icon")))),BB("div",{className:"setting-single"},void 0,BB("label",{},void 0,zB,BB("span",{},void 0,(0,le.Z)("Menu Icon")))))),BB(LB,{filter:this.props.filter}))}}const $B=(0,fs.Z)(GB,FB);const KB=function(e,t,n,i){var s=40;n=n||"#006ed7",i=i||"#FFFFFF",this.window=e,this.points=[],this.points_buffer=[],this.stopped=!0,this.canvas=t,this.init_points=function(){this.points=[],this.points_buffer=[];var e={x:s,y:s};this.points.push(e);var t,n=function(e){var t,n=0,i=0,s=0,o=0,a=0,r=0;for(t=0;t<e.length;t++)"0"===e[t]?a+=1:"4"===e[t]&&(a-=1),a>n&&(n=a),a<i&&(i=a);for(t=0;t<e.length;t++)"2"===e[t]?r-=1:"6"===e[t]&&(r+=1),r>s&&(s=r),r<o&&(o=r);return i>0&&(i=0),o>0&&(o=0),120/Math.max(Math.abs(n-i),Math.abs(s-o))}(this.sequence);for(t=0;t<this.sequence.length;t++){var i={};"0"===this.sequence[t]?(i.x=this.points[t].x+n,i.y=this.points[t].y):"2"===this.sequence[t]?(i.x=this.points[t].x,i.y=this.points[t].y+n):"4"===this.sequence[t]?(i.x=this.points[t].x-n,i.y=this.points[t].y):"6"===this.sequence[t]&&(i.x=this.points[t].x,i.y=this.points[t].y-n),this.points.push(i)}var o=this.points[0].x,a=this.points[0].y,r=this.points[0].x,l=this.points[0].y;for(t=1;t<this.points.length;t++)this.points[t].x<o&&(o=this.points[t].x),this.points[t].x>r&&(r=this.points[t].x),this.points[t].y<a&&(a=this.points[t].y),this.points[t].y>l&&(l=this.points[t].y);if(o<s){for(t=0;t<this.points.length;t++)this.points[t].x+=-(o-s);r+=-(o-s)}if(a<s){for(t=0;t<this.points.length;t++)this.points[t].y+=-(a-s);l+=-(a-s)}for(t=0;t<this.points.length;t++)this.points[t].x+=(160-r)/2,this.points[t].y+=(160-l-8)/2;for(t=0;t<this.points.length;t++){var d={x:this.points[t].x,y:this.points[t].y};this.points_buffer.push(d)}},this.reset_points=function(){var e;for(e=0;e<this.points_buffer.length;e++)this.points[e].x=this.points_buffer[e].x,this.points[e].y=this.points_buffer[e].y},this.draw_point=function(e){this.ctx.beginPath(),this.ctx.arc(e.x,e.y,8,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.fillStyle=n,this.ctx.fill()},this.idx=0,this.timeout=0,this.draw_segment=function(){if(!this.stopped){if(this.idx>=this.points.length)return this.timeout>=50?(this.timeout=0,this.idx=0,this.reset_points(),void(this.requestId=this.window.requestAnimationFrame((()=>{this.draw_segment()})))):(this.ctx.fillStyle=Dr()(i).alpha(.15).css(),this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.timeout++,void(this.requestId=this.window.requestAnimationFrame((()=>{this.draw_segment()}))));this.timeout=0,this.ctx.fillStyle=Dr()(i).alpha(.1).css(),this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.draw_point(this.points[this.idx]),!this.points[this.idx+1]||this.points[this.idx].x===this.points[this.idx+1].x&&this.points[this.idx].y===this.points[this.idx+1].y?(this.idx++,this.draw_segment()):(this.points[this.idx].x<this.points[this.idx+1].x?this.points[this.idx].x+=4:this.points[this.idx].x>this.points[this.idx+1].x&&(this.points[this.idx].x-=4),this.points[this.idx].y<this.points[this.idx+1].y?this.points[this.idx].y+=4:this.points[this.idx].y>this.points[this.idx+1].y&&(this.points[this.idx].y-=4),this.requestId=this.window.requestAnimationFrame((()=>{this.draw_segment()})))}},this.clear_canvas=function(){this.ctx.fillStyle=i,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)},this.start=function(e){this.sequence=e,this.ctx=this.canvas.getContext("2d"),this.ctx.lineWidth=3,this.clear_canvas(),this.init_points(),this.stopped&&(this.stopped=!1,this.requestId=this.window.requestAnimationFrame((()=>{this.draw_segment()})))},this.stop=function(){this.stopped=!0,this.current_point_index=0,this.timeout=0,this.idx=0,this.window.cancelAnimationFrame(this.requestId)}};var jB;function YB(e,t,n,i){jB||(jB="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:jB,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class XB extends tn.Component{_hiddenRange=tn.createRef();setValue=e=>{const t=this._hiddenRange.current,n=(Object.getOwnPropertyDescriptor(HTMLInputElement.prototype,"value")||{}).set;t&&n&&(n.call(t,e.currentTarget.value),t.dispatchEvent(new Event("input",{bubbles:!0})))};render(){const{prefValues:e,className:t,label:n,minLabel:i,maxLabel:s,...o}=this.props,a=this.props.step||1,r=["RangeButtonInput",t].join(" ");return e[D.kAppearanceRangeButtons]?YB("span",{className:r},void 0,(0,fn.jsx)("input",{...o,ref:this._hiddenRange,type:"range",onChange:this.props.onChange,hidden:!0}),YB("button",{type:"button",className:"FormButton",onClick:this.setValue,title:i??(0,le.Z)("Decrease"),value:Number((this.props.value-a).toFixed(2)),disabled:this.props.disabled||this.props.value<=this.props.min,dangerouslySetInnerHTML:{__html:cn.M2k.medium}}),n??this.props.value,YB("button",{type:"button",className:"FormButton",onClick:this.setValue,title:s??(0,le.Z)("Increase"),value:Number((this.props.value+a).toFixed(2)),disabled:this.props.disabled||this.props.value>=this.props.max,dangerouslySetInnerHTML:{__html:cn.md4.medium}})):YB("label",{className:r},void 0,(0,fn.jsx)("input",{...o,type:"range"}),YB("span",{},void 0,n??this.props.value))}}const QB=(0,fs.Z)(XB,[D.kAppearanceRangeButtons]);var qB,JB=n(92571),eF=n(21191),tF=n(34155);function nF(e,t,n,i){qB||(qB="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:qB,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const iF=St.jk.settingCategories,sF=[D.kMouseGesturesAltGesturesEnabled,D.kMouseGesturesDoubleClickMenuEnabled,D.kMouseGesturesEnabled,D.kMouseGesturesStrokeTolerance,D.kMouseGesturesRockerGesturesEnabled],oF=nt.Z.getEventHandler;var aF=nF("hr",{}),rF=nF("span",{className:"meter-bg"});class lF extends tn.Component{static contextType=dn.Z;refGestureList=tn.createRef();refGestureCanvas=tn.createRef();lastX=0;lastY=0;constructor(e,t){super(e);const n=P.Z.getState().windowStyles.get(t.vivaldiWindowId)||lT.Z.getFallbackStyle(),i=U.Z.getSettingsList(!0);this.state={commandArray:i,assignedArray:U.Z.getCommandsForGestures(),selectedCommand:this._getTopCommand(i),addingGesture:0,gestureExists:!1,angleMap:this.populateAngleMap(),confirmation:!1,colorHighlightBg:n["--colorHighlightBg"],colorBg:n["--colorBg"]}}componentDidMount(){P.Z.addListener(this.onThemeStoreChanged),U.Z.addListener(this._onCommandStoreChange),r.Z.addListener(this._onCommandStoreChange),this.props.category!==iF.all&&tF.nextTick((()=>this.refGestureList.current?.focus()))}_onCommandStoreChange=()=>{const e=U.Z.getSettingsList(!0),t=U.Z.getCommandsForGestures();let n=!1;const i=this.state.selectedCommand?.name,s=Object.keys(t);for(let e=0;e<s.length&&!n;e++){n=-1!==t[s[e]].findIndex((e=>e.name===i))}n?this.setState({commandArray:e,assignedArray:t,addingGesture:0}):this.setState({commandArray:e,selectedCommand:this._getTopCommand(e),assignedArray:t,addingGesture:0}),0===s.length&&this.clearAnimation()};componentWillUnmount(){P.Z.removeListener(this.onThemeStoreChanged),void 0!==this.animation&&this.animation.stop(),U.Z.removeListener(this._onCommandStoreChange),r.Z.removeListener(this._onCommandStoreChange)}componentDidUpdate(e,t){!this.animation||this.state.colorBg===t.colorBg&&this.state.colorHighlightBg===t.colorHighlightBg||(this.clearAnimation(),this.animation=new KB(this.context.window,this.refGestureCanvas.current,this.state.colorHighlightBg,this.state.colorBg),this.state.selectedCommand?.gestures&&this.animation.start(this.state.selectedCommand.gestures[0]))}onThemeStoreChanged=()=>{const e=P.Z.getState().windowStyles.get(this.context.vivaldiWindowId)||lT.Z.getFallbackStyle(),t=e["--colorHighlightBg"],n=e["--colorBg"];t===this.state.colorHighlightBg&&n===this.state.colorBg||this.setState({colorHighlightBg:t,colorBg:n})};populateAngleMap=()=>{const e=2*Math.PI/4,t=2*Math.PI/100,n=[];for(let i=-e/2;i<=2*Math.PI-e/2;i+=t){const t=2*Math.floor((i+e/2)/e);n.push(t)}return n};_getCommandByGesture=e=>this.state.commandArray.find((t=>{if(t.gestures&&t.gestures[0]===e)return t}));_getTopCommand=e=>e.find((e=>e.gestures));onGestureListChange=e=>{const t=this.state.selectedCommand;let n=e&&"focus"===e.type&&t&&t.gestures?t.gestures[0]:e.target.value;const i=e&&"focus"===e.type&&t?t:this._getCommandByGesture(n);n&&(this.animation&&!this.animation.stopped||(this.animation=new KB(this.context.window,this.refGestureCanvas.current,this.state.colorHighlightBg,this.state.colorBg)),0===n.indexOf("e")&&(n=n.substring(1,n.length)),this.animation.stop(),this.animation.start(n),this.setState({addingGesture:0,selectedCommand:i}))};addGesture=()=>{this.setState({addingGesture:1})};onCancelGesture=()=>{this.moves=[],this.clearAnimation();const e=this.state.commandArray;this.setState({addingGesture:0,gestureExists:!1,selectedCommand:this._getTopCommand(e)})};_findNextCommandGesture=()=>{const e=this.state.selectedCommand,t=this.state.commandArray.filter((e=>e.gestures));if(t&&e){const n=t.findIndex((t=>t.name===e.name));return n<t.length-1?t[n+1]:t[n-1]}};removeGesture=()=>{const e=this._findNextCommandGesture(),t=this.state.selectedCommand;t&&(a.Z.setGestures(t.name),this.setState({selectedCommand:e}),this.animation&&e?.gestures&&this.animation.start(e.gestures[0]))};editGesture=()=>{const e=this.state.selectedCommand;e&&this.setState((t=>({addingGesture:2,selectedCommand:t.commandArray.find((t=>t.name===e.name))})))};restoreGestures=()=>{a.Z.restoreGestures(),this.setState({confirmation:!1})};confirmRestore=()=>{this.setState({confirmation:!0})};onCancel=()=>{this.setState({confirmation:!1})};consolidateCommands=()=>this.state.commandArray.filter((e=>!e.gestures&&e));save=()=>{if(!this.moves)return;let e=this.moves.join("");const t=this.state.selectedCommand;t&&((0,eF.jD)(t.name)&&(e="e"+e),a.Z.setGestures(t.name,[e]),this.moves=[],tF.nextTick((()=>this.refGestureList.current?.focus())))};addPoint=(e,t,n)=>{this.pointX.push(e),this.pointY.push(t),n&&this.pointDrag.push(n)};addMove=(e,t)=>{const n=2*Math.PI/4;let i=Math.atan2(t,e)+n/2;i<0&&(i+=2*Math.PI);const s=Math.floor(i/(2*Math.PI)*100);Array.isArray(this.moves)&&this.moves.push(this.state.angleMap[s])};redraw=()=>{const e=this.refGestureCanvas.current,t=e?.getContext("2d");if(e&&t){t.clearRect(0,0,t.canvas.width,t.canvas.height),"string"==typeof this.state.colorHighlightBg&&(t.strokeStyle=this.state.colorHighlightBg),t.lineJoin="round",t.lineWidth=16;for(let e=0;e<this.pointX.length;e++)t.beginPath(),this.pointDrag[e]&&e?t.moveTo(this.pointX[e-1],this.pointY[e-1]):t.moveTo(this.pointX[e]-1,this.pointY[e]),t.lineTo(this.pointX[e],this.pointY[e]),t.closePath(),t.stroke()}};penDown=e=>{if(2!==this.state.addingGesture||e.button&&0!==e.button)return;e.touches&&(e=e.touches[0]),this.clearAnimation(),this.clearCanvas(),this.moves=[],this.paint=!0;const t=this.refGestureCanvas.current?.getBoundingClientRect()??{left:0,top:0};this.addPoint(e.pageX-t.left,e.pageY-t.top),this.redraw()};penMove=e=>{if(2===this.state.addingGesture&&(e.touches&&(e=e.touches[0]),this.paint)){const t=this.refGestureCanvas.current?.getBoundingClientRect()??{left:0,top:0};if(this.addPoint(e.pageX-t.left,e.pageY-t.top,!0),0===this.lastX)return this.lastX=e.pageX-t.left,void(this.lastY=e.pageY-t.top);const n=e.pageX-t.left-this.lastX,i=e.pageY-t.top-this.lastY,s=10;n*n+i*i>s*s&&(this.lastX=e.pageX-t.left,this.lastY=e.pageY-t.top,this.addMove(n,i)),this.redraw()}};penUp=()=>{if(this.paint=!1,2!==this.state.addingGesture||!this.moves||this.moves.length<3)return;this.moves.length&&(this.moves=this.moves.map(((e,t,n)=>{if(e!==n[t-1]&&e===n[t+1])return e})).filter((e=>void 0!==e)));let e=this.moves.join("");e.length>5&&(e=e.substring(e.length-5)),this.animation=new KB(this.context.window,this.refGestureCanvas.current,this.state.colorHighlightBg,this.state.colorBg),this.animation.start(e);const{assignedArray:t,selectedCommand:n}=this.state;let i;i=n&&(0,eF.jD)(n.name)?t["e"+e]:t[e],this.setState({gestureExists:Boolean(i)})};penLeave=()=>{this.paint&&(this.paint=!1,this.moves=[],this.forceUpdate())};clearAnimation=()=>{if(void 0!==this.animation){this.animation.stop();const e=this.refGestureCanvas.current;if(e){e.getContext("2d")?.clearRect(0,0,e.width,e.height)}}};clearCanvas=()=>{this.paint=!1,this.pointX=[],this.pointY=[],this.pointDrag=[];const e=this.refGestureCanvas.current;if(e){e.getContext("2d").clearRect(0,0,e.width,e.height)}};renderGesture=()=>(0,fn.jsx)("canvas",{ref:this.refGestureCanvas,width:"200",height:"200",onTouchStart:this.penDown,onTouchMove:this.penMove,onTouchEnd:this.penUp,onTouchCancel:this.penLeave,onMouseDown:this.penDown,onMouseMove:this.penMove,onMouseUp:this.penUp,onMouseLeave:this.penLeave});renderSearchableCommands=()=>{const e=this.consolidateCommands(),t=this.props.category!==iF.all,{selectedCommand:n}=this.state;return nF(JB.Z,{placeholder:(0,le.Z)("Filter commands..."),isClearable:!0,autoFocus:t,selectedCommand:n,openMenuOnFocus:!0,isMulti:!1,setSelectedItem:this.setSelectedCommand,commands:e})};setSelectedCommand=e=>{this.setState({selectedCommand:e})};renderCommands=()=>this.state.commandArray.map((e=>{const{gestures:t}=e;return t?nF("option",{value:t[0]},`id-gesture-${e.label.split(" ").join("_")}`,e.label):null}));renderModal=()=>nF(ln.Z,{dialogWidth:400,onRequestClose:this.onCancel},void 0,nF("div",{className:"dialog-restore-shortcuts"},void 0,nF("header",{className:"dialog-header"},void 0,nF("h1",{className:"dialog-title"},void 0,(0,le.Z)("Restore Gestures?"))),nF("div",{className:"dialog-content"},void 0,nF("p",{},void 0,(0,le.Z)("All command gestures will be restored to default settings."))),nF("footer",{className:"dialog-footer"},void 0,nF("input",{type:"button",className:"danger",onClick:this.restoreGestures,value:(0,le.Z)("Restore")}),nF("input",{type:"button",onClick:this.onCancel,value:(0,le.Z)("Cancel"),autoFocus:!0}))));render(){const e=this.props.prefValues,t=this.state.selectedCommand,n=t&&t.gestures?t.gestures[0]:void 0,i=!this.moves||0===this.moves.length,s=this.state.gestureExists&&!i?this.state.commandArray.find((e=>e.gestures&&e.gestures.includes(this.moves.join("")))):void 0,o=" "+(0,le.Z)("This setting requires a restart to take full effect.");return nF(a_,{categoryTitle:(0,le.Z)("Mouse"),filter:this.props.filter},void 0,this.state.confirmation&&this.renderModal(),nF("div",{className:"setting-group unlimited"},void 0,nF("h3",{},void 0,(0,le.Z)("Gestures")),nF("div",{className:"setting-single"},void 0,nF("label",{},void 0,nF("input",{type:"checkbox",checked:e[D.kMouseGesturesEnabled],onChange:oF(D.kMouseGesturesEnabled)}),nF("span",{},void 0,(0,le.Z)("Allow Gestures"))),nF("p",{className:"info"},void 0,(0,le.Z)("Hold down right mouse button and perform a gesture to issue related command.")+o)),nF("div",{className:"setting-single"},void 0,nF("label",{},void 0,nF("input",{type:"checkbox",checked:e[D.kMouseGesturesAltGesturesEnabled],onChange:oF(D.kMouseGesturesAltGesturesEnabled)}),nF("span",{},void 0,(0,le.Z)("win_linux","Perform Gestures with Alt Key"))),nF("p",{className:"info"},void 0,(0,le.Z)("Use gestures with trackpad or other input device.")))),nF("div",{className:"setting-group unlimited gestures"},void 0,nF("div",{className:"setting-single pad-top"},void 0,nF("h3",{},void 0,(0,le.Z)("Gesture Mapping")),nF("div",{className:"gesture-map setting-single"},void 0,(0,fn.jsx)("select",{ref:this.refGestureList,className:"gesture-list",value:n,onChange:this.onGestureListChange,onFocus:this.onGestureListChange,onBlur:this.clearAnimation,size:"9",children:this.renderCommands()}),nF("div",{className:2===this.state.addingGesture?"active gesture":"gesture"},void 0,this.renderGesture())),nF("div",{className:"setting-single record-gesture"},void 0,0===this.state.addingGesture&&nF("div",{className:"toolbar toolbar-default"},void 0,nF("div",{className:"toolbar toolbar-group"},void 0,nF(sl,{tooltip:(0,le.Z)("New gesture"),onClick:this.addGesture,image:cn.md4.medium}),aF,nF(sl,{tooltip:(0,le.Z)("Remove gesture"),onClick:this.removeGesture,disabled:!t,image:cn.M2k.medium})),nF(sl,{tooltip:(0,le.Z)("Edit gesture"),onClick:this.editGesture,disabled:!t,image:cn.NNg.medium}),nF(sl,{title:(0,le.Z)("Restore Default Gestures"),onClick:this.confirmRestore})),1===this.state.addingGesture&&nF("form",{onSubmit:this.editGesture},void 0,nF("h3",{className:"pad-top"},void 0,(0,le.Z)("Pick a Command")),nF("div",{className:"toolbar"},void 0,this.renderSearchableCommands(),nF("input",{type:"submit",disabled:!t,value:(0,le.Z)("Next...")}),nF("input",{type:"button",onClick:this.onCancelGesture,value:(0,le.Z)("Cancel")}))),t&&2===this.state.addingGesture&&(0,fn.jsxs)(fn.Fragment,{children:[nF("h3",{className:"pad-top"},void 0,(0,le.Z)("Recording “$1” Gesture",[t.label])),nF("div",{className:"add-gesture"},void 0,nF("p",{className:"info"},void 0,(0,le.Z)("Draw a new gesture in the highlighted area using the primary input. Gesture may consist of horizontal and vertical lines, limited to maximum of five strokes.")),nF("div",{className:"save"},void 0,nF("input",{type:"submit",value:(0,le.Z)("Save Gesture"),onClick:this.save,disabled:i||this.state.gestureExists}),nF("input",{type:"button",onClick:this.onCancelGesture,value:(0,le.Z)("Cancel")}),s&&nF("p",{className:"alert"},void 0,(0,le.Z)("This gesture is already used by “$1” command.",[s.label]))))]})))),nF("div",{className:"setting-group unlimited"},void 0,nF("div",{className:"setting-single pad-top"},void 0,nF("h3",{},void 0,(0,le.Z)("Gesture Sensitivity")),nF("p",{className:"info"},void 0,(0,le.Z)("Set minimum stroke length to be recognized as a gesture move.")),nF("div",{className:"setting-single tolerance"},void 0,nF("div",{className:"gesture-preview"},void 0,rF,nF("span",{className:"meter",style:{width:e[D.kMouseGesturesStrokeTolerance]+"px"}}),nF("span",{},void 0,(0,le.Z)("$1 pixels",[e[D.kMouseGesturesStrokeTolerance]]))),nF(QB,{min:5,max:100,step:5,onChange:oF(D.kMouseGesturesStrokeTolerance),value:e[D.kMouseGesturesStrokeTolerance]}))),nF("div",{className:"setting-single pad-top"},void 0,nF("h3",{},void 0,(0,le.Z)("Rocker Gestures")),nF("label",{},void 0,nF("input",{type:"checkbox",checked:e[D.kMouseGesturesRockerGesturesEnabled],onChange:oF(D.kMouseGesturesRockerGesturesEnabled)}),nF("span",{},void 0,(0,le.Z)("Allow Rocker Gestures"))),nF("p",{className:"info"},void 0,(0,le.Z)("Press right mouse button followed by left mouse button click to go back in history. Press left mouse button followed by right click to advance forward in history.")+o)),ik.Z.isEnabled("double_click_menu")&&nF("div",{className:"setting-single pad-top"},void 0,nF("h3",{},void 0,(0,le.Z)("Double Click Context Menu")),nF("label",{},void 0,nF("input",{type:"checkbox",checked:e[D.kMouseGesturesDoubleClickMenuEnabled],onChange:oF(D.kMouseGesturesDoubleClickMenuEnabled)}),nF("span",{},void 0,(0,le.Z)("Allow Double Click to Show Context Menu"))),nF("p",{className:"info"},void 0,(0,le.Z)("Use a double click to show the context menu.")+o))))}}const dF=(0,fs.Z)(lF,sF);var cF;function hF(e,t,n,i){cF||(cF="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:cF,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class pF extends tn.Component{static contextType=dn.Z;onClick=()=>{d.Z.utilities.launchNetworkSettings(this.context.vivaldiWindowId)};render(){return hF(a_,{categoryTitle:(0,le.Z)("Network"),filter:this.props.filter},void 0,hF("div",{className:"setting-group"},void 0,hF("h3",{},void 0,(0,le.Z)("Proxies")),hF("div",{className:"setting-single"},void 0,hF("label",{},void 0,hF("input",{type:"button",value:(0,le.Z)("Proxy Settings"),onClick:this.onClick})))))}}const uF=pF;var gF;function mF(e,t,n,i){gF||(gF="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:gF,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const vF=[D.kMailContactDefaultAction,D.kMailIsTurnedOff,D.kMailSingleClickTabs,D.kNotesCreationAddScreenshot,D.kNotesCreationNotify,D.kNotesCreationShowPanel,D.kPanelsAsOverlayAutoClose,D.kPanelsLazyLoad,D.kPanelsAsOverlayEnabled,D.kPanelsPosition,D.kReadingListShowCounter,D.kReadingListPanelSingleClickOpens,D.kPanelsShowFolderBadge,D.kPanelsShowToggle,D.kPanelsTranslatePaste,D.kPanelsTranslateRedirect,D.kPanelsWindowDragToStack,D.kPanelsWindowShowPinnedGroup,D.kPanelsWindowSingleClickOpens,D.kPanelsWindowShowUnread,D.kTabsCounterDetection],fF=nt.Z.getEventHandler;var yF=mF("input",{type:"radio",value:"left"}),wF=mF("input",{type:"radio",value:"right"}),bF=mF("input",{type:"radio",value:"viewAllMessages"}),CF=mF("input",{type:"radio",value:"compose"});class SF extends tn.Component{render(){return mF(a_,{categoryTitle:(0,le.Z)("Panels"),filter:this.props.filter},void 0,mF("div",{className:"setting-group"},void 0,mF("h3",{},void 0,(0,le.Z)("Panel Position")),mF(ws,{name:"panelPosition",value:this.props.prefValues[D.kPanelsPosition],onChange:fF(D.kPanelsPosition),className:"group"},void 0,mF("div",{className:"setting-single"},void 0,mF("label",{},void 0,yF,mF("span",{},void 0,(0,le.Z)("Left Side")))),mF("div",{className:"setting-single"},void 0,mF("label",{},void 0,wF,mF("span",{},void 0,(0,le.Z)("Right Side")))))),mF("div",{className:"setting-group"},void 0,mF("h3",{},void 0,(0,le.Z)("Panel Options")),mF("div",{className:"setting-single"},void 0,mF("label",{title:(0,le.Z)("Display a panel toggle button along the side")},void 0,mF("input",{type:"checkbox",checked:this.props.prefValues[D.kPanelsShowToggle],onChange:fF(D.kPanelsShowToggle)}),mF("span",{},void 0,(0,le.Z)("Show Panel Toggle")))),mF("div",{className:"setting-single"},void 0,mF("label",{title:(0,le.Z)("Overlay panel over browser content")},void 0,mF("input",{type:"checkbox",checked:this.props.prefValues[D.kPanelsAsOverlayEnabled],onChange:fF(D.kPanelsAsOverlayEnabled)}),mF("span",{},void 0,(0,le.Z)("Floating Panel")))),mF("div",{className:"setting-single pad-left"},void 0,mF("label",{title:(0,le.Z)("Automatically collapse panel upon losing focus")},void 0,mF("input",{type:"checkbox",disabled:!this.props.prefValues[D.kPanelsAsOverlayEnabled],checked:this.props.prefValues[D.kPanelsAsOverlayAutoClose],onChange:fF(D.kPanelsAsOverlayAutoClose)}),mF("span",{},void 0,(0,le.Z)("Auto-Close Inactive Panel")))),mF("div",{className:"setting-single"},void 0,mF("label",{},void 0,mF("input",{type:"checkbox",checked:this.props.prefValues[D.kPanelsShowFolderBadge],onChange:fF(D.kPanelsShowFolderBadge)}),mF("span",{},void 0,(0,le.Z)("Show Folder Counters"))))),mF("div",{className:"setting-group"},void 0,mF("h3",{},void 0,(0,le.Z)("Web Panels")),mF("div",{className:"setting-single"},void 0,mF("label",{title:(0,le.Z)("Detect and display numeric notification from page title in Tabs and Web Panels")},void 0,mF("input",{type:"checkbox",checked:this.props.prefValues[D.kTabsCounterDetection],onChange:fF(D.kTabsCounterDetection)}),mF("span",{},void 0,(0,le.Z)("Detect Page Title Notifications")))),mF("div",{className:"setting-single"},void 0,mF("label",{title:(0,le.Z)("Wait to Load Panels Until Activated")},void 0,mF("input",{type:"checkbox",checked:this.props.prefValues[D.kPanelsLazyLoad],onChange:fF(D.kPanelsLazyLoad)}),mF("span",{},void 0,(0,le.Z)("Lazy Load"))))),mF("div",{className:"setting-group"},void 0,mF("h3",{},void 0,(0,le.Z)("title","Notes Panel")),mF("div",{className:"setting-single"},void 0,mF("label",{title:(0,le.Z)("Show panel content when adding a note from a page")},void 0,mF("input",{type:"checkbox",checked:this.props.prefValues[D.kNotesCreationShowPanel],onChange:fF(D.kNotesCreationShowPanel)}),mF("span",{},void 0,(0,le.Z)("Open Panel Automatically")))),mF("div",{className:"setting-single"},void 0,mF("label",{},void 0,mF("input",{type:"checkbox",checked:this.props.prefValues[D.kNotesCreationNotify],onChange:fF(D.kNotesCreationNotify)}),mF("span",{},void 0,(0,le.Z)("Notify on Adding New Note")))),mF("div",{className:"setting-single"},void 0,mF("label",{title:(0,le.Z)("Add a screenshot when adding a note from a page")},void 0,mF("input",{type:"checkbox",checked:this.props.prefValues[D.kNotesCreationAddScreenshot],onChange:fF(D.kNotesCreationAddScreenshot)}),mF("span",{},void 0,(0,le.Z)("Fetch Screenshot for New Notes"))))),mF("div",{className:"setting-group"},void 0,mF("h3",{},void 0,(0,le.Z)("title","Window Panel")),mF("div",{className:"setting-single"},void 0,mF("label",{},void 0,mF("input",{type:"checkbox",checked:this.props.prefValues[D.kPanelsWindowSingleClickOpens],onChange:fF(D.kPanelsWindowSingleClickOpens)}),mF("span",{},void 0,(0,le.Z)("Activate with Single Click")))),mF("div",{className:"setting-single"},void 0,mF("label",{},void 0,mF("input",{type:"checkbox",checked:this.props.prefValues[D.kPanelsWindowShowPinnedGroup],onChange:fF(D.kPanelsWindowShowPinnedGroup)}),mF("span",{},void 0,(0,le.Z)("Pinned Folder")))),mF("div",{className:"setting-single"},void 0,mF("label",{},void 0,mF("input",{type:"checkbox",checked:this.props.prefValues[D.kPanelsWindowDragToStack],onChange:fF(D.kPanelsWindowDragToStack)}),mF("span",{},void 0,(0,le.Z)("Create Tab Stack by Drag and Drop")))),mF("div",{className:"setting-single"},void 0,mF("label",{},void 0,mF("input",{type:"checkbox",checked:this.props.prefValues[D.kPanelsWindowShowUnread],onChange:fF(D.kPanelsWindowShowUnread)}),mF("span",{},void 0,(0,le.Z)("Show Unread Tabs Badge"))))),mF("div",{className:"setting-group"},void 0,mF("h3",{},void 0,(0,le.Z)("title","Translate Panel")),mF("div",{className:"setting-single"},void 0,mF("label",{},void 0,mF("input",{type:"checkbox",checked:this.props.prefValues[D.kPanelsTranslateRedirect],onChange:fF(D.kPanelsTranslateRedirect)}),mF("span",{},void 0,(0,le.Z)("Use Panel Instead of Dialog")))),mF("div",{className:"setting-single"},void 0,mF("label",{},void 0,mF("input",{type:"checkbox",checked:this.props.prefValues[D.kPanelsTranslatePaste],onChange:fF(D.kPanelsTranslatePaste)}),mF("span",{},void 0,(0,le.Z)("Translate when pasting text"))))),mF("div",{className:"setting-group"},void 0,mF("h3",{},void 0,(0,le.Z)("Reading List Panel")),mF("div",{className:"setting-single"},void 0,mF("label",{},void 0,mF("input",{type:"checkbox",checked:this.props.prefValues[D.kReadingListPanelSingleClickOpens],onChange:fF(D.kReadingListPanelSingleClickOpens)}),mF("span",{},void 0,(0,le.Z)("Activate with Single Click")))),mF("div",{className:"setting-single"},void 0,mF("label",{},void 0,mF("input",{type:"checkbox",checked:this.props.prefValues[D.kReadingListShowCounter],onChange:fF(D.kReadingListShowCounter)}),mF("span",{},void 0,(0,le.Z)("Show Unread Counters"))))),!this.props.prefValues[D.kMailIsTurnedOff]&&mF("div",{className:"setting-group"},void 0,mF("h3",{},void 0,(0,le.Z)("title","Contacts Panel")),mF("div",{className:"setting-single"},void 0,mF("label",{},void 0,mF("input",{type:"checkbox",checked:this.props.prefValues[D.kMailSingleClickTabs],onChange:fF(D.kMailSingleClickTabs)}),mF("span",{},void 0,(0,le.Z)("Activate with Single Click")))),mF("div",{className:"setting-single pad-top"},void 0,mF("h3",{},void 0,(0,le.Z)("Default Contact Action")),mF(ws,{name:"contactDefaulAction",value:this.props.prefValues[D.kMailContactDefaultAction],onChange:fF(D.kMailContactDefaultAction),className:"group"},void 0,mF("div",{className:"setting-single"},void 0,mF("label",{},void 0,bF,mF("span",{},void 0,(0,le.Z)("View All Mail Messages")))),mF("div",{className:"setting-single"},void 0,mF("label",{},void 0,CF,mF("span",{},void 0,(0,le.Z)("radio","Compose New Message"))))))))}}const TF=(0,fs.Z)(SF,vF);var IF;function kF(e,t,n,i){IF||(IF="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:IF,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const AF={sound:(0,le.Z)("Sound"),notifications:(0,le.Z)("Notifications"),location:(0,le.Z)("Geolocation"),"media-stream-camera":(0,le.Z)("Camera"),"media-stream-mic":(0,le.Z)("Microphone"),sensors:(0,le.Z)("Motion Sensors"),"bluetooth-scanning":(0,le.Z)("Bluetooth Devices"),"midi-sysex":(0,le.Z)("MIDI Devices"),popups:(0,le.Z)("Popups"),"idle-detection":(0,le.Z)("Idle Detection")},ZF=["sensors","sound","popups"];class EF extends tn.PureComponent{componentDidMount(){this.initPermissionState()}initPermissionState=()=>{Object.keys(AF).forEach((e=>{d.Z.utilities.getDefaultContentSettings(e,(t=>{this.setState({[e]:t})}))}))};changePermission=e=>{const{name:t,value:n}=e.target;d.Z.utilities.setDefaultContentSettings(t,n,(()=>this.setState({[t]:n})))};resetToDefaults=()=>{Object.keys(AF).forEach((e=>{d.Z.utilities.setDefaultContentSettings(e,"default",Tl.default)})),this.initPermissionState()};render(){return kF(jE.Z,{filter:this.props.filter},void 0,kF("div",{className:"setting-group global-permissions"},void 0,kF("h3",{},void 0,(0,le.Z)("Default Permissions")),kF("p",{className:"info"},void 0,(0,le.Z)("Certain website permissions can be controlled globally.")),kF("div",{className:"setting-single"},void 0,this.state&&Object.keys(this.state).map((e=>kF("label",{},e,kF("span",{},void 0,AF[e]),kF("select",{value:this.state[e],onChange:this.changePermission,name:e},void 0,kF("option",{value:"allow"},void 0,(0,le.Z)("other","Allow")),!ZF.includes(e)&&kF("option",{value:"ask"},void 0,(0,le.Z)("Ask")),kF("option",{value:"block"},void 0,(0,le.Z)("Block"))))))),kF("div",{className:"setting-single"},void 0,kF("input",{type:"button",value:(0,le.Z)("Reset to Defaults"),onClick:this.resetToDefaults}))))}}const _F=EF;var NF;function MF(e,t,n,i){NF||(NF="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:NF,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const PF=[D.kHistoryDaysToKeepVisits,D.kSavingBrowserHistoryDisabled];class DF extends tn.Component{onHistoryDaysChanged=e=>{const t=parseInt(e.target.value,10);nt.Z.set(D.kHistoryDaysToKeepVisits,t),0===t?nt.Z.set(D.kSavingBrowserHistoryDisabled,!0):nt.Z.set(D.kSavingBrowserHistoryDisabled,!1)};render(){const e=this.props.prefValues[D.kHistoryDaysToKeepVisits],t=[0,1,7,31,91,182,365,3650].includes(e);return MF(jE.Z,{filter:this.props.filter},void 0,MF("div",{className:"setting-group"},void 0,MF("h3",{},void 0,(0,le.Z)("other","Save Browsing History")),MF("div",{className:"setting-single"},void 0,MF("select",{onChange:this.onHistoryDaysChanged,value:e},void 0,MF("option",{value:"0"},void 0,(0,le.Z)("command","Session Only")),MF("option",{value:"1"},void 0,(0,le.Z)("One Day")),MF("option",{value:"7"},void 0,(0,le.Z)("One Week")),MF("option",{value:"31"},void 0,(0,le.Z)("One Month")),MF("option",{value:"91"},void 0,(0,le.Z)("Three Months")),MF("option",{value:"182"},void 0,(0,le.Z)("Six Months")),MF("option",{value:"365"},void 0,(0,le.Z)("One Year")),MF("option",{value:"3650"},void 0,(0,le.Z)("Forever")),!t&&MF("option",{value:e},void 0,(0,le.Z)("Other ($1 Days)",[e])))),MF("p",{className:"info"},void 0,(0,le.Z)("Browser restart is required for new setting to take effect."))))}}const xF=(0,fs.Z)(DF,PF);var OF;function LF(e,t,n,i){OF||(OF="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:OF,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const RF=[D.kPrivacyGoogleComponentExtensionsCryptoToken,D.kAddressBarInlineSearchEnabled,D.kAddressBarInlineSearchSuggestEnabled,D.kAddressBarSearchSuggestEnabled,D.kAddressBarSearchTypedHistoryEnabled,D.kAddressBarTypedHistoryEnabled,D.kAlternateErrorPagesEnabled,D.kEnableDoNotTrack,D.kPrivacyAdverseAdBlockEnabled,D.kPrivacyAutofillServerAssist,D.kPrivacyGoogleComponentExtensionsHangoutServices,D.kPrivacyGoogleComponentExtensionsWebStore,D.kSafeBrowsingEnabled,D.kIncognitoShowIntro,D.kWebRTCIPHandlingPolicy];const BF=nt.Z.getEventHandler;class FF extends tn.Component{state={showServiceWarning:!1};toggleChromePrivacyWebRTCChange=()=>{const e=this.webRTCAnnouncesIPs()?"disable_non_proxied_udp":"default";nt.Z.set(D.kWebRTCIPHandlingPolicy,e)};webRTCAnnouncesIPs=()=>["default","default_public_interface_only","default_public_and_private_interfaces"].some((e=>this.props.prefValues[D.kWebRTCIPHandlingPolicy]===e));serviceWarning=()=>{this.props.prefValues[D.kPrivacyGoogleComponentExtensionsCryptoToken]?this.setState({showServiceWarning:!0}):nt.Z.set(D.kPrivacyGoogleComponentExtensionsCryptoToken,!0)};disableService=()=>{nt.Z.set(D.kPrivacyGoogleComponentExtensionsCryptoToken,!1),this.closeDialog()};closeDialog=()=>{this.setState({showServiceWarning:!1})};renderModal=()=>LF(ln.Z,{onRequestClose:this.closeDialog,dialogWidth:400},void 0,LF("form",{className:"dialog-disable-service",onSubmit:this.disableService},void 0,LF("header",{className:"dialog-header"},void 0,LF("h1",{className:"dialog-title"},void 0,(0,le.Z)("Disable Google Services Token"))),LF("div",{className:"dialog-content"},void 0,LF("p",{},void 0,(0,le.Z)("Disabling cryptography token will prevent login and full access to Google account and service webpages including Gmail, Google Calendar, and Google Docs. Do you want to proceed?"))),LF("footer",{className:"dialog-footer"},void 0,LF("input",{type:"submit",value:(0,le.Z)("other","Disable"),autoFocus:!0}),LF("input",{type:"button",value:(0,le.Z)("Leave Enabled"),onClick:this.closeDialog}))));render(){const e=this.props.prefValues;return LF(a_,{categoryTitle:(0,le.Z)("Privacy"),displayPrivacyLink:!0,filter:this.props.filter},void 0,this.state.showServiceWarning&&this.renderModal(),LF("div",{className:"setting-group"},void 0,LF("h3",{},void 0,(0,le.Z)("Google Services")),LF("div",{className:"setting-single"},void 0,LF("label",{},void 0,LF("input",{type:"checkbox",checked:e[D.kSafeBrowsingEnabled],onChange:BF(D.kSafeBrowsingEnabled)}),LF("span",{},void 0,(0,le.Z)("Phishing and Malware Protection")))),LF("div",{className:"setting-single"},void 0,LF("label",{},void 0,LF("input",{type:"checkbox",checked:e[D.kAlternateErrorPagesEnabled],onChange:BF(D.kAlternateErrorPagesEnabled)}),LF("span",{},void 0,(0,le.Z)("DNS to Help Resolve Navigation Errors")))),LF("div",{className:"setting-single"},void 0,LF("label",{},void 0,LF("input",{type:"checkbox",checked:e[D.kPrivacyAutofillServerAssist],onChange:BF(D.kPrivacyAutofillServerAssist)}),LF("span",{},void 0,(0,le.Z)("Form Autofill Assist"))))),LF("div",{className:"setting-group"},void 0,LF("h3",{},void 0,(0,le.Z)("Google Extensions")),LF("p",{className:"info"},void 0,(0,le.Z)("Browser restart is required for new settings to take effect.")),LF("div",{className:"setting-single"},void 0,LF("label",{},void 0,LF("input",{type:"checkbox",checked:e[D.kPrivacyGoogleComponentExtensionsCryptoToken],onChange:this.serviceWarning}),LF("span",{},void 0,(0,le.Z)("Google Services Token"))),LF("p",{className:"info"},void 0,(0,le.Z)("Required for login to Google services."))),LF("div",{className:"setting-single"},void 0,LF("label",{},void 0,LF("input",{type:"checkbox",checked:e[D.kPrivacyGoogleComponentExtensionsHangoutServices],onChange:BF(D.kPrivacyGoogleComponentExtensionsHangoutServices)}),LF("span",{},void 0,(0,le.Z)("Hangouts")))),LF("div",{className:"setting-single"},void 0,LF("label",{},void 0,LF("input",{type:"checkbox",checked:e[D.kPrivacyGoogleComponentExtensionsWebStore],onChange:BF(D.kPrivacyGoogleComponentExtensionsWebStore)}),LF("span",{},void 0,(0,le.Z)("Web Store"))),LF("p",{className:"info"},void 0,(0,le.Z)("You will be unable to install extensions with this option disabled.")))),LF("div",{className:"setting-group"},void 0,LF("h3",{},void 0,(0,le.Z)("noun","Search")),LF("div",{className:"setting-single"},void 0,LF("label",{},void 0,LF("input",{type:"checkbox",checked:e[D.kAddressBarInlineSearchEnabled],onChange:BF(D.kAddressBarInlineSearchEnabled)}),LF("span",{},void 0,(0,le.Z)("Search in Address Field")))),LF("div",{className:"setting-single"},void 0,LF("label",{},void 0,LF("input",{type:"checkbox",checked:e[D.kAddressBarInlineSearchSuggestEnabled],onChange:BF(D.kAddressBarInlineSearchSuggestEnabled)}),LF("span",{},void 0,(0,le.Z)("Suggestions in Address Field")))),LF("div",{className:"setting-single"},void 0,LF("label",{},void 0,LF("input",{type:"checkbox",checked:e[D.kAddressBarSearchSuggestEnabled],onChange:BF(D.kAddressBarSearchSuggestEnabled)}),LF("span",{},void 0,(0,le.Z)("Suggestions in Search Field"))))),LF("div",{className:"setting-group"},void 0,LF("div",{className:"setting-single"},void 0,LF("h3",{},void 0,(0,le.Z)("Do Not Track")),LF("label",{title:(0,le.Z)("Send “Do Not Track” directive to supporting websites")},void 0,LF("input",{type:"checkbox",checked:e[D.kEnableDoNotTrack],onChange:BF(D.kEnableDoNotTrack)}),LF("span",{},void 0,(0,le.Z)("Ask Websites Not to Track Me")))),LF("div",{className:"setting-single"},void 0,LF("label",{title:"Reject advertisement on websites listed by Google as privacy offenders"},void 0,LF("input",{type:"checkbox",checked:e[D.kPrivacyAdverseAdBlockEnabled],onChange:BF(D.kPrivacyAdverseAdBlockEnabled)}),LF("span",{},void 0,(0,le.Z)("Block Ads on Abusive Sites")))),LF("div",{className:"setting-single"},void 0,LF("label",{title:(0,le.Z)("Web Real-Time Communication broadcast may leak IP address to services")},void 0,LF("input",{type:"checkbox",checked:this.webRTCAnnouncesIPs(),onChange:this.toggleChromePrivacyWebRTCChange}),LF("span",{},void 0,(0,le.Z)("Broadcast IP for Best WebRTC Performance"))))),LF("div",{className:"setting-group"},void 0,LF("div",{className:"setting-single"},void 0,LF("h3",{},void 0,(0,le.Z)("Show Typed History")),LF("div",{className:"setting-single"},void 0,LF("label",{},void 0,LF("input",{type:"checkbox",checked:e[D.kAddressBarTypedHistoryEnabled],onChange:BF(D.kAddressBarTypedHistoryEnabled)}),LF("span",{},void 0,(0,le.Z)("radio","In Address Field")))),LF("div",{className:"setting-single"},void 0,LF("label",{},void 0,LF("input",{type:"checkbox",checked:e[D.kAddressBarSearchTypedHistoryEnabled],onChange:BF(D.kAddressBarSearchTypedHistoryEnabled)}),LF("span",{},void 0,(0,le.Z)("radio","In Search Field")))))),LF(xF,{filter:this.props.filter}),LF(_F,{filter:this.props.filter}),LF("div",{className:"setting-group"},void 0,LF("div",{className:"setting-single"},void 0,LF("h3",{},void 0,(0,le.Z)("Private Windows")),LF("label",{},void 0,LF("input",{type:"checkbox",checked:e[D.kIncognitoShowIntro],onChange:BF(D.kIncognitoShowIntro)}),LF("span",{},void 0,(0,le.Z)("Show Introduction"))))),!1)}}const UF=(0,fs.Z)(FF,RF);var VF=n(5422);const WF=[{key:"CALCULATOR",name:(0,le.Z)("Calculator"),pref:D.kQuickCommandsShowCalculator},{key:"NORMAL_COMMAND",name:(0,le.Z)("Commands")},{key:"COMMAND_CHAIN",name:(0,le.Z)("Command Chains")},{key:"KEYWORD_SEARCH",name:(0,le.Z)("Web Search & URL Entry")},{key:"OPEN_TABS",name:(0,le.Z)("Open Tabs")},{key:"BOOKMARK_ITEM_OR_FOLDER",name:(0,le.Z)("Bookmarks"),pref:D.kQuickCommandsShowBookmarks},{key:"READING_LIST",name:(0,le.Z)("Reading List"),pref:D.kQuickCommandsShowReadingList},{key:"NOTES_SEARCH",name:(0,le.Z)("Notes"),pref:D.kQuickCommandsShowNotes},{key:"HISTORY",name:(0,le.Z)("Browsing History"),pref:D.kQuickCommandsShowHistory},{key:"EXTENSIONS",name:(0,le.Z)("Extensions"),pref:D.kQuickCommandsShowExtensions},{key:"PAGE_ACTIONS",name:(0,le.Z)("Page Actions"),pref:D.kQuickCommandsShowPageActions},{key:"CLOSED_TABS",name:(0,le.Z)("Closed Tabs")}];var HF;function zF(e,t,n,i){HF||(HF="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:HF,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const GF=[D.kQuickCommandsKeepValue,D.kQuickCommandsOpenUrlInNewTab,D.kQuickCommandsSearchEnglish,D.kQuickCommandsMatchNickname,D.kQuickCommandsLimitResults,D.kQuickCommandsSearchPriority,D.kQuickCommandsShowBookmarks,D.kQuickCommandsShowCalculator,D.kQuickCommandsShowExtensions,D.kQuickCommandsShowHistory,D.kQuickCommandsShowPageActions,D.kQuickCommandsShowNotes,D.kQuickCommandsShowReadingList,D.kQuickCommandsUseNotesManager],$F=nt.Z.getEventHandler;class KF extends tn.Component{toggleSetting=e=>{nt.Z.set(e,!this.props.prefValues[e])};renderListItem=(e,t)=>{const n=WF.find((e=>e.key===t.key))?.pref,i=n&&this.props.prefValues[n];return zF("div",{onDoubleClick:n?()=>this.toggleSetting(n):null},void 0,n?zF("input",{type:"checkbox",value:t.key,checked:i,onChange:$F(n)}):zF("span",{style:{width:16}}),t.name)};resetList=()=>{nt.Z.reset(D.kQuickCommandsSearchPriority)};moveItem=(e,t)=>{const n=this.props.prefValues[D.kQuickCommandsSearchPriority].map((e=>e)),i=n.splice(e,1)[0];n.splice(t,0,i),nt.Z.set(D.kQuickCommandsSearchPriority,n)};render(){const e=this.props.prefValues,t=M.Z.getDefault(D.kActions)[0].COMMAND_SHOW_QUICK_COMMANDS.shortcuts;return(0,fn.jsxs)(fn.Fragment,{children:[zF(a_,{categoryTitle:(0,le.Z)("Quick Commands"),filter:this.props.filter},void 0,zF("p",{className:"info"},void 0,t&&t.length>0&&(0,le.Z)("Open Quick Commands with $2 shortcut.","Open Quick Commands with $2 shortcuts.",[t.length,(0,Rd.$)(t).toUpperCase()])," ",(0,le.Z)("Press Down or Up keys with $1 modifier to skip to next search result section. Press Right key to auto-complete input from current list selection.",["Alt"])),zF("div",{className:"setting-group setting-group-double"},void 0,zF("div",{className:"setting-single"},void 0,zF("h3",{},void 0,(0,le.Z)("Search Types and Priority")),zF("p",{className:"info"},void 0,(0,le.Z)("Select data types to include in Quick Command search results. Reorder the list to change default search highlight priority.")),zF("div",{className:"master-detail sortable-list qc-priority"},void 0,zF(MM.Z,{filter:this.props.filter,items:(n=e[D.kQuickCommandsSearchPriority],n.map((e=>({key:e,name:WF.find((t=>t.key===e))?.name||""})))),moveItem:this.moveItem,renderListItem:this.renderListItem,supportDragAndDrop:!0,mimeType:"vivaldi/x-settings-quick-command-type"})),zF("input",{type:"button",onClick:this.resetList,value:(0,le.Z)("Reset Priority")}))),zF("div",{className:"setting-group setting-group-double"},void 0,zF("h3",{},void 0,(0,le.Z)("Quick Command Options")),zF("div",{className:"setting-single"},void 0,zF("label",{},void 0,zF("input",{type:"checkbox",checked:e[D.kQuickCommandsKeepValue],onChange:$F(D.kQuickCommandsKeepValue)}),zF("span",{},void 0,(0,le.Z)("Keep Last Typed Value")))),zF("div",{className:"setting-single"},void 0,zF("label",{},void 0,zF("input",{type:"checkbox",checked:e[D.kQuickCommandsLimitResults],onChange:$F(D.kQuickCommandsLimitResults)}),zF("span",{},void 0,(0,le.Z)("Limit Number of Visible Search Results")))),!navigator.language.startsWith("en")&&zF("div",{className:"setting-single"},void 0,zF("label",{},void 0,zF("input",{type:"checkbox",checked:e[D.kQuickCommandsSearchEnglish],onChange:$F(D.kQuickCommandsSearchEnglish)}),zF("span",{},void 0,(0,le.Z)("Include English Search Terms"))),zF("p",{className:"info"},void 0,(0,le.Z)("Include English equivalent of command names in search results"))),zF("div",{className:"setting-single"},void 0,zF("label",{},void 0,zF("input",{type:"checkbox",checked:e[D.kQuickCommandsOpenUrlInNewTab],onChange:$F(D.kQuickCommandsOpenUrlInNewTab)}),zF("span",{},void 0,(0,le.Z)("Open Links in New Tab")))),zF("div",{className:"setting-single"},void 0,zF("label",{},void 0,zF("input",{type:"checkbox",checked:e[D.kQuickCommandsMatchNickname],onChange:$F(D.kQuickCommandsMatchNickname)}),zF("span",{},void 0,(0,le.Z)("Open Bookmarks on Nickname Match")))),zF("div",{className:"setting-single"},void 0,zF("label",{},void 0,zF("input",{type:"checkbox",checked:e[D.kQuickCommandsUseNotesManager],onChange:$F(D.kQuickCommandsUseNotesManager)}),zF("span",{},void 0,(0,le.Z)("Open Notes in Notes Manager")))))),zF(a_,{categoryTitle:(0,le.Z)("Command Chains"),filter:this.props.filter},void 0,zF(VF.Z,{filter:this.props.filter,category:this.props.category}))]});var n}}const jF=(0,fs.Z)(KF,GF);var YF;function XF(e,t,n,i){YF||(YF="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:YF,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const QF=["keyboard","mouse","chromalink","mousemat","headset"],qF=[D.kRazerChromaDevices,D.kRazerChromaEnabled],JF=[{device:"keyboard",text:(0,le.Z)("Keyboard")},{device:"mouse",text:(0,le.Z)("Mouse")},{device:"mousemat",text:(0,le.Z)("Mouse Mat")},{device:"headset",text:(0,le.Z)("Headset")},{device:"chromalink",text:(0,le.Z)("Chroma Link")}];class eU extends tn.Component{constructor(e){super(e)}isDeviceEnabled=(e,t)=>e.findIndex((e=>e===t))>-1;onChromaEnabled=e=>{const t=e.target.checked;nt.Z.set(D.kRazerChromaEnabled,t)};onDeviceChecked=(e,t)=>{const n=t.target.checked,i=this.props.prefValues[D.kRazerChromaDevices],s=QF.filter((t=>e===t?n:this.isDeviceEnabled(i,t)));nt.Z.set(D.kRazerChromaDevices,s)};renderDeviceList(){const e=this.props.prefValues[D.kRazerChromaDevices];return JF.map((t=>XF("div",{className:"setting-single pad-left"},t.device,XF("label",{},void 0,XF("input",{type:"checkbox",disabled:!this.props.prefValues[D.kRazerChromaEnabled],checked:Boolean(this.isDeviceEnabled(e,t.device)),onChange:this.onDeviceChecked.bind(this,t.device)}),XF("span",{},void 0,t.text)))))}render(){return XF(a_,{categoryTitle:(0,le.Z)("Razer Chroma Theme Integration"),filter:this.props.filter},void 0,XF("div",{className:"setting-group"},void 0,XF("div",{className:"setting-single"},void 0,XF("label",{},void 0,XF("input",{type:"checkbox",checked:this.props.prefValues[D.kRazerChromaEnabled],onChange:this.onChromaEnabled}),XF("span",{},void 0,(0,le.Z)("Enable Razer Chroma Integration"))),XF("p",{className:"info"},void 0,(0,le.Z)("Requires Razer Chroma enabled devices connected to the local machine."))),this.renderDeviceList()))}}const tU=(0,fs.Z)(eU,qF);var nU,iU=n(92413);function sU(e,t,n,i){nU||(nU="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:nU,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const oU=nt.Z.getEventHandler,aU=[D.kKeyboardTabToAll,D.kWebpagesReaderAllowVertical,D.kWebpagesReaderControls,D.kWebpagesReaderStyle],rU=["ja","ja-KS","ko","zh-CN","zh-TW"].includes(navigator.language),lU={min:.5,max:4,step:.1},dU={min:1,max:2,step:.1},cU={min:20,max:100,step:2};var hU=sU("hr",{}),pU=sU("hr",{}),uU=sU("hr",{}),gU=sU("hr",{}),mU=sU("hr",{}),vU=sU("hr",{});class fU extends tn.Component{static contextType=dn.Z;constructor(e,t){super(e),this.state={isOpen:!1,colorFg:String($C.Z.getThemeColors()["--colorFg"])}}componentDidMount(){P.Z.addListener(this.onThemeStoreChanged)}onThemeStoreChanged=()=>{this.setState({colorFg:String($C.Z.getThemeColors()["--colorFg"])})};componentWillUnmount(){P.Z.removeListener(this.onThemeStoreChanged)}setTheme=e=>()=>{this.setStyle({themeStyle:e})};setFontFamily=e=>()=>{this.setStyle({fontFamily:e})};setLineHeight=e=>()=>{const t=this.props.prefValues[D.kWebpagesReaderStyle],{step:n}=dU,i=(t.lineHeight+("increment"===e?n:-n)).toFixed(1);this.setStyle({lineHeight:parseFloat(i)})};setFontSize=e=>()=>{const t=this.props.prefValues[D.kWebpagesReaderStyle],{step:n}=lU,i=(t.fontSize+("increment"===e?n:-n)).toFixed(1);this.setStyle({fontSize:parseFloat(i)})};setWidth=e=>()=>{const t=this.props.prefValues[D.kWebpagesReaderStyle],{step:n}=cU;this.setStyle({width:t.width+("increment"===e?n:-n)})};setDirection=e=>()=>{this.setStyle({writingMode:e})};setStyle=(0,Kf.default)((e=>{nt.Z.set(D.kWebpagesReaderStyle,{...this.props.prefValues[D.kWebpagesReaderStyle],...e}),iU.Z.setReaderModeStyle(this.context.vivaldiWindowId)}),300,{leading:!0,trailing:!0});toggleControls=()=>{this.setState((e=>({isOpen:!e.isOpen})))};canFontGrow=()=>this.props.prefValues[D.kWebpagesReaderStyle].fontSize<lU.max;canFontShrink=()=>this.props.prefValues[D.kWebpagesReaderStyle].fontSize>lU.min;canLineHeightGrow=()=>this.props.prefValues[D.kWebpagesReaderStyle].lineHeight<dU.max;canLineHeightShrink=()=>this.props.prefValues[D.kWebpagesReaderStyle].lineHeight>dU.min;canColumnGrow=()=>this.props.prefValues[D.kWebpagesReaderStyle].width<cU.max;canColumnShrink=()=>this.props.prefValues[D.kWebpagesReaderStyle].width>cU.min;render(){const e=this.props.prefValues[D.kWebpagesReaderAllowVertical],t=this.props.prefValues[D.kWebpagesReaderStyle],n="vertical-rl"===t.writingMode;if(this.props.prefs&&t){const n=(0,fn.jsxs)(fn.Fragment,{children:[sU("h2",{},void 0,(0,le.Z)("Reader")),sU("div",{className:"setting-group-unlimited"},void 0,sU("div",{className:"setting-single"},void 0,sU("label",{},void 0,sU("input",{type:"checkbox",checked:this.props.prefValues[D.kWebpagesReaderControls],onChange:oU(D.kWebpagesReaderControls)}),sU("span",{},void 0,(0,le.Z)("Display Settings on Page in Reader")))),!rU&&sU("div",{className:"setting-single"},void 0,sU("label",{},void 0,sU("input",{type:"checkbox",checked:e,onChange:oU(D.kWebpagesReaderAllowVertical)}),sU("span",{},void 0,(0,le.Z)("Allow Vertical Text Direction"))))),sU("div",{className:"setting-group pad-top"},void 0,sU("div",{className:"setting-single"},void 0,sU("h3",{},void 0,(0,le.Z)("Font Face")),sU("div",{className:"toolbar toolbar-medium toolbar-default"},void 0,sU("div",{className:"toolbar toolbar-group"},void 0,sU(sl,{title:(0,le.Z)("Sans-serif"),image:cn.g4W.medium,isPressed:"sans-serif"===t.fontFamily,onClick:this.setFontFamily("sans-serif")}),hU,sU(sl,{title:(0,le.Z)("Serif"),image:cn.USP.medium,isPressed:"serif"===t.fontFamily,onClick:this.setFontFamily("serif")})))),sU("div",{className:"setting-single"},void 0,sU("h3",{},void 0,(0,le.Z)("Font Size")),sU(QB,{label:Math.round(100*t.fontSize)+" %",value:t.fontSize,min:lU.min,max:lU.max,step:lU.step,onChange:e=>this.setStyle({fontSize:Number(e.currentTarget.value)})})),sU("div",{className:"setting-single"},void 0,sU("h3",{},void 0,(0,le.Z)("Line Height")),sU(QB,{value:t.lineHeight,min:dU.min,max:dU.max,step:dU.step,onChange:e=>this.setStyle({lineHeight:Number(e.currentTarget.value)})})),sU("div",{className:"setting-single"},void 0,sU("h3",{},void 0,(0,le.Z)("Column Width")),sU(QB,{value:t.width,min:cU.min,max:cU.max,step:cU.step,onChange:e=>this.setStyle({width:Number(e.currentTarget.value)})})),sU("div",{className:"setting-single"},void 0,sU("input",{type:"button",value:(0,le.Z)("Reset to Defaults"),onClick:()=>iU.Z.resetReaderModeStyle(this.context.vivaldiWindowId)}))),sU("div",{className:"setting-group pad-top"},void 0,sU("div",{className:"setting-single"},void 0,sU("h3",{},void 0,(0,le.Z)("Color Scheme")),sU("div",{className:"toolbar toolbar-medium toolbar-default"},void 0,sU("div",{className:"toolbar toolbar-group"},void 0,sU(sl,{title:(0,le.Z)("other","Light"),image:cn.XQw.medium,onClick:this.setTheme("light"),isPressed:"light"===t.themeStyle,buttonStyle:{"--kIconCircleFill":"#f6f6f6","--kIconCircleStroke":"var(--colorFg)"}}),pU,sU(sl,{title:(0,le.Z)("other","Dark"),image:cn.XQw.medium,onClick:this.setTheme("dark"),isPressed:"dark"===t.themeStyle,buttonStyle:{"--kIconCircleFill":"#111111","--kIconCircleStroke":"var(--colorFg)"}}),uU,sU(sl,{title:(0,le.Z)("other","Theme"),image:cn.XQw.medium,isPressed:"theme"===t.themeStyle,onClick:this.setTheme("theme"),buttonStyle:{"--kIconCircleFill":"var(--colorBgLight)","--kIconCircleStroke":"var(--colorHighlightBg)"}})))),(rU||e)&&sU("div",{className:"setting-single"},void 0,sU("h3",{},void 0,(0,le.Z)("Text Direction")),sU("div",{className:"toolbar toolbar-medium toolbar-default"},void 0,sU("div",{className:"toolbar toolbar-group"},void 0,sU(sl,{tooltip:(0,le.Z)("Horizontal Text"),title:(0,le.Z)("title","Horizontal"),onClick:this.setDirection("unset"),isPressed:"vertical-rl"!==t.writingMode,image:cn.weK,disabled:!(rU||e)}),sU(sl,{tooltip:(0,le.Z)("Vertical Text"),title:(0,le.Z)("title","Vertical"),isPressed:"vertical-rl"===t.writingMode,onClick:this.setDirection("vertical-rl"),image:cn.lIQ,disabled:!(rU||e)})))))]});return(0,js.ZP)(n,this.props.filter)}return(0,fn.jsxs)(fn.Fragment,{children:[sU(Wr.Z,{classNames:"reader-toolbar",in:this.state.isOpen,mountOnEnter:!0,unmountOnExit:!0,timeout:{enter:300,exit:150}},"toolbar",sU("div",{className:"toolbar toolbar-default toolbar-medium reader-toolbar"},void 0,sU("div",{className:"toolbar-group"},void 0,sU(sl,{tooltip:(0,le.Z)("Sans-serif"),image:cn.g4W.medium,isPressed:"sans-serif"===t.fontFamily,onClick:this.setFontFamily("sans-serif")}),sU(sl,{tooltip:(0,le.Z)("Serif"),image:cn.USP.medium,buttonStyle:{fontFamily:"serif"},isPressed:"serif"===t.fontFamily,onClick:this.setFontFamily("serif")})),sU("div",{className:"toolbar-group"},void 0,sU(sl,{className:"decrease-font-size",tooltip:(0,le.Z)("Decrease font size"),image:cn.g4W.medium,disabled:!this.canFontShrink(),onClick:this.setFontSize("decrement")}),gU,sU(sl,{className:"increase-font-size",tooltip:(0,le.Z)("Increase font size"),image:cn.g4W.medium,disabled:!this.canFontGrow(),onClick:this.setFontSize("increment")})),sU("div",{className:"toolbar-group"},void 0,sU(sl,{className:n?"button-rotateimage":"",tooltip:(0,le.Z)("Tighten line spacing"),disabled:!this.canLineHeightShrink(),onClick:this.setLineHeight("decrement"),image:cn.sss}),mU,sU(sl,{className:n?"button-rotateimage":"",tooltip:(0,le.Z)("Loosen line spacing"),disabled:!this.canLineHeightGrow(),onClick:this.setLineHeight("increment"),image:cn.zDC})),sU("div",{className:"toolbar-group"},void 0,sU(sl,{className:n?"button-rotateimage":"",tooltip:(0,le.Z)("Shrink column"),disabled:!this.canColumnShrink(),onClick:this.setWidth("decrement"),image:cn.Gpq}),vU,sU(sl,{className:n?"button-rotateimage":"",tooltip:(0,le.Z)("Grow column"),disabled:!this.canColumnGrow(),onClick:this.setWidth("increment"),image:cn.Fib})),(rU||e)&&sU("div",{className:"toolbar-group"},void 0,sU(sl,{tooltip:(0,le.Z)("Horizontal Text"),isPressed:"vertical-rl"!==t.writingMode,onClick:this.setDirection("unset"),image:cn.weK}),sU(sl,{tooltip:(0,le.Z)("Vertical Text"),isPressed:"vertical-rl"===t.writingMode,onClick:this.setDirection("vertical-rl"),image:cn.lIQ})),sU("div",{className:"toolbar-group"},void 0,sU(sl,{tooltip:(0,le.Z)("other","Light"),image:cn.XQw.medium,onClick:this.setTheme("light"),isPressed:"light"===t.themeStyle,buttonStyle:{"--kIconCircleFill":"white","--kIconCircleStroke":"var(--colorFg)"}}),sU(sl,{tooltip:(0,le.Z)("other","Dark"),image:cn.XQw.medium,onClick:this.setTheme("dark"),image:cn.XQw.medium,isPressed:"dark"===t.themeStyle,buttonStyle:{"--kIconCircleFill":"black","--kIconCircleStroke":"var(--colorFg)"}}),sU(sl,{tooltip:(0,le.Z)("other","Inherit Theme"),image:cn.XQw.medium,isPressed:"theme"===t.themeStyle,onClick:this.setTheme("theme"),buttonStyle:{"--kIconCircleFill":"var(--colorBgLight)","--kIconCircleStroke":"var(--colorHighlightBg)"}})))),sU(sl,{buttonStyle:this.state.isOpen?void 0:{fill:this.state.colorFg},className:"reader-settings-toggle",onClick:this.toggleControls,tooltip:(0,le.Z)("Reader settings"),image:cn.bqs.medium},"reader-settings-toggle")]})}}const yU=(0,fs.Z)(fU,aU);var wU;function bU(e,t,n,i){wU||(wU="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:wU,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class CU extends tn.Component{state={confirmation:!1};resetSection=()=>{this.props.prefPaths?.length>0&&this.props.prefPaths.forEach((e=>{nt.Z.reset(e)})),this.setState({confirmation:!1})};onCancel=()=>{this.setState({confirmation:!1})};askConfirmation=()=>{this.setState({confirmation:!0})};renderConfirmation=e=>bU(ln.Z,{dialogWidth:400,viewMode:"float",onRequestClose:this.onCancel},void 0,bU("div",{className:"dialog-restore-settings"},void 0,bU("header",{className:"dialog-header"},void 0,bU("h1",{className:"dialog-title"},void 0,(0,le.Z)("Reset $1 Settings to Default?",[e]))),bU("div",{className:"dialog-content"},void 0,bU("p",{},void 0,(0,le.Z)("All settings in the '$1' section will be reset to default values.",[e]))),bU("footer",{className:"dialog-footer"},void 0,bU("input",{type:"button",className:"danger",onClick:this.resetSection,value:(0,le.Z)("Reset Settings")}),bU("input",{type:"button",onClick:this.onCancel,value:(0,le.Z)("Cancel"),autoFocus:!0}))));render(){return this.props.prefPaths?.length?bU(a_,{categoryTitle:(0,le.Z)("Reset Settings"),filter:this.props.filter},void 0,this.state.confirmation&&this.renderConfirmation(this.props.name),bU("div",{className:"setting-group"},void 0,bU("div",{className:"setting-single"},void 0,bU("input",{type:"button",value:(0,le.Z)("Reset $1 Settings to Default",[this.props.name]),onClick:this.askConfirmation}),bU("p",{className:"info"},void 0,(0,le.Z)("This will reset the settings in this section to default values."))))):null}}const SU=CU;tn.Component;var TU;function IU(e,t,n,i){TU||(TU="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:TU,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var kU=IU("span",{},void 0,"•••••••");class AU extends tn.Component{render(){const{origin:e,username:t,password:n}=this.props.savedPassword,{columns:i}=this.props;if(i.length<1||!this.props.savedPassword)return null;var s=IU(Oi,{url:e,loadType:"page"}),o=IU("span",{},void 0,e),a=IU("input",{type:"text",value:t,tabIndex:-1,readOnly:!0}),r=IU("input",{type:"text",value:n,tabIndex:-1,readOnly:!0});return i.map((t=>{switch(t.id){case"origin":return IU("label",{},t.id,IU("span",{className:"site-icon",onDoubleClick:this.props.openLink.bind(null,e),title:(0,le.Z)("Double-click to visit $1",[e])},void 0,s),o);case"username":return IU("label",{},t.id,a);case"password":return IU("div",{},t.id,IU("label",{},void 0,this.props.showPassword?r:kU),IU("button",{type:"button",className:"listcontrol",title:this.props.showPassword?(0,le.Z)("Hide password"):(0,le.Z)("other","Show password"),tabIndex:-1,onClick:this.props.togglePassword.bind(null,this.props.savedPassword.index),dangerouslySetInnerHTML:{__html:cn.sgm.medium}}));default:return null}}))}}const ZU=AU;var EU=n(6826);class _U extends tn.PureComponent{static contextType=dn.Z;_passwordTree=tn.createRef();state={visiblePasswords:[]};componentDidMount(){this._passwordTree.current&&this._passwordTree.current.focusTree()}togglePassword=e=>{d.Z.savedpasswords.authenticate(this.context.vivaldiWindowId,(t=>{t&&this.onShowPassword(e)}))};onShowPassword=e=>{this.setState((t=>{const n=t.visiblePasswords.slice(0);return n.includes(e)?n.splice(n.indexOf(e),1):n.push(e),{visiblePasswords:n}}))};onPasswordDeleted=e=>{this.state.visiblePasswords.includes(e)&&this.setState((t=>{const n=t.visiblePasswords.slice(0);return n.splice(n.indexOf(e),1),{visiblePasswords:n}}))};openLink=e=>{Y.Z.openURL(this.context.vivaldiWindowId,e)};copyPassword=e=>{d.Z.savedpasswords.authenticate(this.context.vivaldiWindowId,(t=>{t&&ui.Z.set(e)}))};getContextMenuItems=e=>{const t=this.state.visiblePasswords.includes(e.index);return[{handler:this.onShowPassword.bind(null,e.index),visible:t,...(0,Mn.Z)("Hide Password")},{handler:this.togglePassword.bind(null,e.index),visible:!t,...(0,Mn.Z)("Show Password")},G.Z.separatorItem,{handler:this.copyPassword.bind(null,e.password),...(0,Mn.Z)("Copy Password")},{handler:ui.Z.set.bind(null,e.username),...(0,Mn.Z)("Copy Account Name")},{handler:this.openLink.bind(null,e.origin),visible:(0,Ni.q9)(e.origin).startsWith("http"),...(0,Mn.Z)("Visit Page")},G.Z.separatorItem,{handler:this.props.onDelete.bind(null,e),...(0,Mn.Z)("Delete Password")}]};onKeyDown=e=>{if(!this._passwordTree.current)return;const t=this._passwordTree.current.getSelectedItem();if(t)switch(e.key){case"Delete":case"Backspace":this.props.onDelete(t);break;case"Enter":this.openLink(t.origin)}};onMouseDown=()=>{this._passwordTree.current&&this._passwordTree.current.focusTree()};getRowComponentProps=e=>({columns:this.props.columns,savedPassword:e.node,showPassword:this.state.visiblePasswords.includes(e.node.index),togglePassword:this.togglePassword,openLink:this.openLink});render(){return(0,fn.jsx)(Yu,{ref:this._passwordTree,rowComponent:ZU,getRowComponentProps:this.getRowComponentProps,nodes:this.props.nodes,enableDragAndDrop:!1,onItemMouseDown:this.onMouseDown,onItemDoubleClick:Tl.default,onKeyDown:this.onKeyDown,getContextMenuItems:this.getContextMenuItems,isFolder:EU.Z,isValidForClipboard:EU.Z,hasChildren:EU.Z,sorting:this.props.sorting,columns:this.props.columns,multiSelect:!1})}}const NU=_U;var MU;function PU(e,t,n,i){MU||(MU="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:MU,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const DU=y.Z.passwordsPrivate.onPasswordsFileExportProgress,xU=[D.kCredentialsEnableService],OU=nt.Z.getEventHandler,LU="passwords",RU=[{text:(0,le.Z)("Website"),value:"origin",fullScreenTitle:(0,le.Z)("Sort by website"),width:300,visible:!0,key:!0},{text:(0,le.Z)("title","Account Name"),value:"username",fullScreenTitle:(0,le.Z)("Sort by account name"),width:160,visible:!0},{text:(0,le.Z)("Password"),value:"password",fullScreenTitle:(0,le.Z)("Sort by password"),width:160,visible:!0}];class BU extends tn.Component{passwordTree=tn.createRef();constructor(e){super(e);const t=vu().passwords;this.state={savedPasswordsData:[],confirmation:!1,toRemove:null,siteFilter:"",passwordsVisible:!1,columns:t||fu(RU),sorting:{sortOrder:1,sortField:"manually",comparator:this.sortComparator},exportStatus:"NOT_STARTED"}}componentDidMount(){this.getSavedPassords(),DU.addListener(this.exportProgress),y.Z.extension.inIncognitoContext||y.Z.passwordsPrivate.getPasswordCheckStatus((()=>{}))}componentWillUnmount(){DU.removeListener(this.exportProgress)}sortComparator=(e,t)=>e.index<t.index?1:-1;onSortChange=(e,t)=>{this.setState({sorting:{sortOrder:e,sortField:t}})};onUpdateRow=e=>this.setState({columns:e});onSaveRow=()=>mu(this.state.columns,LU);exportProgress=e=>{this.setState({exportStatus:e.status})};getSavedPassords=()=>d.Z.savedpasswords.getList((e=>{this.setState({savedPasswordsData:e})}));deleteSavedPassword=()=>{const e=this.state.toRemove;e&&(d.Z.savedpasswords.remove(e.index,(()=>{this.passwordTree.current&&this.passwordTree.current.onPasswordDeleted(e.index),this.getSavedPassords()})),this.setState({confirmation:!1,toRemove:null}))};onAskToDelete=e=>this.setState({confirmation:!0,toRemove:e});onCancel=()=>this.setState({confirmation:!1,toRemove:null});togglePasswordList=()=>this.setState((e=>({passwordsVisible:!e.passwordsVisible,siteFilter:""})));exportPasswords=()=>{y.Z.passwordsPrivate.exportPasswords((()=>{}))};filterEntries=e=>this.setState({siteFilter:e.target.value});renderDeleteConfirmationModal=()=>{const e=this.state.toRemove;if(!e)return null;const t=_i.parse(e.origin).hostname;return PU(ln.Z,{onRequestClose:this.onCancel,dialogWidth:400},void 0,PU("div",{className:"dialog-delete-password"},void 0,PU("header",{className:"dialog-header"},void 0,PU("h1",{className:"dialog-title"},void 0,(0,le.Z)("Delete password for $1?",[t||e.origin]))),PU("div",{className:"dialog-content"},void 0,PU("p",{},void 0,(0,le.Z)("Password for user “$1” on page “$2” will be removed.",[e.username,e.origin]))),PU("footer",{className:"dialog-footer"},void 0,PU("input",{type:"button",className:"primary",onClick:this.deleteSavedPassword,value:(0,le.Z)("other","Delete"),autoFocus:!0}),PU("input",{type:"button",onClick:this.onCancel,value:(0,le.Z)("Cancel")}))))};render(){const{siteFilter:e}=this.state,t=e.toLowerCase(),n=this.state.savedPasswordsData.filter((e=>e.username.toLowerCase().includes(t)||e.origin.toLowerCase().includes(t)));return PU(a_,{categoryTitle:(0,le.Z)("Passwords"),filter:this.props.filter,className:"saved-passwords setting-group unlimited"},void 0,this.state.confirmation&&this.renderDeleteConfirmationModal(),PU("div",{className:"setting-group unlimited"},void 0,PU("div",{className:"setting-single"},void 0,PU("label",{},void 0,PU("input",{type:"checkbox",onChange:OU(D.kCredentialsEnableService),checked:this.props.prefValues[D.kCredentialsEnableService]}),PU("span",{},void 0,(0,le.Z)("Save Webpage Passwords")))),this.state.passwordsVisible&&PU("div",{className:"setting-single"},void 0,PU("input",{type:"search",defaultValue:"",placeholder:(0,le.Z)("Filter Passwords"),onChange:this.filterEntries})),this.state.passwordsVisible&&PU("div",{className:"saved-passwords-tree"},void 0,PU(Iu,{fields:RU,fullsize:!0,onSortChange:this.onSortChange,onSaveRow:this.onSaveRow,onUpdateRow:this.onUpdateRow,columns:this.state.columns,sortField:this.state.sorting.sortField,sortOrder:this.state.sorting.sortOrder,keyAccess:0,manualSorting:!1}),(0,fn.jsx)(NU,{ref:this.passwordTree,sorting:this.state.sorting,columns:this.state.columns,onDelete:this.onAskToDelete,nodes:n})),0===n.length&&PU("div",{className:"saved-passwords"},void 0,e?(0,le.Z)("Query “$1” matches no result.",[e]):(0,le.Z)("No saved passwords found.")),n.length>0&&PU("div",{className:"setting-single"},void 0,PU("input",{type:"button",onClick:this.togglePasswordList,value:this.state.passwordsVisible?(0,le.Z)("Hide Passwords"):(0,le.Z)("Show Saved Passwords")}),PU("input",{type:"button",onClick:this.exportPasswords,value:(0,le.Z)("Export Passwords"),disabled:"IN_PROGRESS"===this.state.exportStatus}),"FAILED_CANCELLED"===this.state.exportStatus||"FAILED_WRITE_FAILED"===this.state.exportStatus&&PU(Tr,{type:"error"},"error",(0,le.Z)("Export failed.")),PU("p",{className:"info"},void 0,(0,le.Z)("Passwords are exported in clear text without encryption.")))))}}const FU=(0,fs.Z)(BU,xU);var UU;function VU(e,t,n,i){UU||(UU="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:UU,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const WU={title:(0,le.Z)("title","Name"),Nickname:(0,le.Z)("Nickname"),"Nickname in use by $1":(0,le.Z)("Nickname in use by $1",[""]),URL:(0,le.Z)("URL"),"POST Parameters":(0,le.Z)("POST Parameters"),"Substitute search keyword in address with %s or %S":(0,le.Z)("Substitute search keyword in address with %s or %S"),"Suggest URL":(0,le.Z)("Suggest URL"),"Suggest POST Parameters":(0,le.Z)("Suggest POST Parameters"),"Image Search URL":(0,le.Z)("Image Search URL"),"Image Search POST Parameters":(0,le.Z)("Image Search POST Parameters"),"Set as Default Search":(0,le.Z)("Set as Default Search"),"Set as Private Search":(0,le.Z)("Set as Private Search"),"Use POST":(0,le.Z)("Use POST")};function HU(e){const t=Nn.Z.getById(e);return t&&e?{id:e,extensionId:t.extensionId,extensionName:"",name:t.name?t.name.trim():"",url:t.url.trim(),usePost:Boolean(t.postParams),postParams:t.postParams?t.postParams.trim():"",suggestUrl:t.suggestUrl?t.suggestUrl.trim():"",suggestPostParams:t.suggestPostParams?t.suggestPostParams.trim():"",imageUrl:t.imageUrl?t.imageUrl.trim():"",imagePostParams:t.imagePostParams?t.imagePostParams.trim():"",faviconUrl:t.faviconUrl?t.faviconUrl.trim():"",keyword:t.keyword,default:Nn.Z.isDefault(e,!1),private:Nn.Z.isDefault(e,!0),nicknameTaken:!1,readOnly:t.readOnly}:{id:e,extensionId:"",extensionName:"",name:"",url:"",usePost:!1,postParams:"",suggestUrl:"",suggestPostParams:"",imageUrl:"",imagePostParams:"",faviconUrl:"",keyword:"",default:!1,private:!1,nicknameTaken:!1,readOnly:!0}}class zU extends tn.Component{static contextType=dn.Z;urlHasChanged=!1;constructor(e,t){super(e),this.state=HU(e.id),this.convertExtensionIdToName(this.state.extensionId)}static getDerivedStateFromProps(e,t){return e.id!==t.id?HU(e.id):null}componentDidUpdate(e,t){e.id!==this.props.id&&(this.save(t,!1),this.urlHasChanged=!1)}convertExtensionIdToName=e=>{e&&y.Z.management.getAll().then((t=>t.find((t=>t.id===e))?.name)).then((e=>e&&this.setState({extensionName:e})))};handleKeyDown=e=>{"Enter"===e.key&&this.save()};handleBlur=()=>{this.props.id===this.state.id&&this.save()};getDataUri=(e,t)=>{const n=new Image;n.onload=function(){const n=document.createElement("canvas");n.width=this.naturalWidth,n.height=this.naturalHeight,n.getContext("2d").drawImage(this,0,0),t(n.toDataURL(e))},n.src=e};constructFavicon=e=>{if(e&&!this.state.faviconUrl){const t=(0,Ni.q9)(e.trim()),n=document.createElement("a");n.href=t;const i=n.protocol+"//"+n.host+"/favicon.ico";this.getDataUri(i,(e=>{this.urlHasChanged&&this.setState({faviconUrl:e},(()=>this.save()))}))}};canSave=e=>e.id&&!e.nicknameTaken&&""!==e.keyword&&""!==e.name&&""!==e.url;save=(e=this.state,t=!0)=>{if(!this.canSave(e))return;const n=Nn.Z.getById(e.id);if(!n)return;const i=(0,Yg.Z)(n);i.id=e.id,i.name=e.name,i.keyword=e.keyword,i.url=e.url.trim(),i.postParams=e.postParams.trim(),i.suggestUrl=e.suggestUrl.trim(),i.suggestPostParams=e.suggestPostParams.trim(),i.imageUrl=e.imageUrl.trim(),i.imagePostParams=e.imagePostParams.trim(),i.suggestPostParams=e.suggestPostParams.trim(),this.urlHasChanged&&(i.faviconUrl=e.faviconUrl);const s=Nn.Z.getDefault(!1)?.id,o=Nn.Z.getDefault(!0)?.id;(0,Sm.default)(i,n)||d.Z.searchEngines.updateTemplateUrl(i),e.default!==(s===e.id)&&d.Z.searchEngines.setDefault("defaultSearch",e.id),e.private!==(o===e.id)&&(e.private?d.Z.searchEngines.setDefault("defaultPrivate",e.id):o===n.id&&s&&d.Z.searchEngines.setDefault("defaultPrivate",s))};nameChange=e=>{this.setState({name:e.target.value})};nicknameChange=e=>{const t=e.target.value.trim();let n=t.length>0&&void 0!==Nn.Z.getByKeyword(t);if(n&&this.props.id){const e=Nn.Z.getById(this.props.id);e&&e.keyword===t&&(n=!1)}this.setState({keyword:t,nicknameTaken:n})};urlChange=e=>{const t=e.target.value;(0,Ni.C3)(t)&&this.constructFavicon(t),this.setState({url:t}),this.urlHasChanged=!0};postParamsChange=e=>{this.setState({postParams:e.target.value})};suggestUrlChange=e=>{this.setState({suggestUrl:e.target.value})};suggestPostParamsChange=e=>{this.setState({suggestPostParams:e.target.value})};imageUrlChange=e=>{this.setState({imageUrl:e.target.value})};imagePostParamsChange=e=>{this.setState({imagePostParams:e.target.value})};defaultChange=e=>{this.setState({default:e.target.checked},(()=>this.save()))};privateChange=e=>{this.setState({private:e.target.checked},(()=>this.save()))};postChange=e=>{this.setState((e=>({usePost:!e.usePost})))};openExtensionsPage=()=>{const{extensionId:e}=this.state;e&&Y.Z.openURL(this.context.vivaldiWindowId,`vivaldi://extensions/?id=${e}`,{singleton:!0})};render(){const e=this.state.nicknameTaken?Nn.Z.getByKeyword(this.state.keyword):null,t=e?e.name:"";return VU("div",{className:"detail"},void 0,VU("div",{className:"detail-content"},void 0,this.state.extensionId&&VU(Tr,{type:"info"},void 0,(0,le.Z)("This search engine is added by “$1” extension.",[this.state.extensionName])," ",VU(Uw,{onClick:this.openExtensionsPage},void 0,(0,le.Z)("Show Extension"))),VU("div",{className:"setting-group"},void 0,VU("div",{className:"setting-single"},void 0,VU(Ko.Z,{type:"text",focusInput:this.props.focusNameInput,label:this.props.searchableStrings.title,value:this.state.name,onBlur:this.handleBlur,onChange:this.nameChange,onKeyDown:this.handleKeyDown,disabled:this.state.readOnly})),""===this.state.name.trim()&&VU(Tr,{type:"warning"},void 0,(0,js.CH)((0,le.Z)("Name cannot be empty"),this.props.filter)),VU("div",{className:"setting-single"},void 0,VU(Ko.Z,{type:"text",label:this.props.searchableStrings.Nickname,value:this.state.keyword,onBlur:this.handleBlur,onChange:this.nicknameChange,onKeyDown:this.handleKeyDown,disabled:this.state.readOnly})),""===this.state.keyword&&VU(Tr,{type:"warning"},void 0,(0,js.CH)((0,le.Z)("Nickname cannot be empty"),this.props.filter)),this.state.nicknameTaken&&VU(Tr,{type:"warning"},void 0,(0,js.CH)((0,le.Z)("Nickname in use by $1",[t]),this.props.filter))),VU("div",{className:"setting-group"},void 0,VU("div",{className:"setting-single"},void 0,VU(Ko.Z,{type:"text",label:this.props.searchableStrings.URL,value:this.state.url,onBlur:this.handleBlur,onChange:this.urlChange,onKeyDown:this.handleKeyDown,disabled:this.state.readOnly})),""===this.state.url.trim()&&VU(Tr,{type:"warning"},void 0,(0,js.CH)((0,le.Z)("URL cannot be empty"),this.props.filter)),this.state.usePost&&VU("div",{className:"setting-single dropfade"},void 0,VU(Ko.Z,{type:"text",label:this.props.searchableStrings["POST Parameters"],value:this.state.postParams,onBlur:this.handleBlur,onChange:this.postParamsChange,onKeyDown:this.handleKeyDown,disabled:this.state.readOnly})),VU("p",{className:"info"},void 0,this.props.searchableStrings["Substitute search keyword in address with %s or %S"])),VU("div",{className:"setting-group"},void 0,VU("div",{className:"setting-single"},void 0,VU(Ko.Z,{type:"text",label:this.props.searchableStrings["Suggest URL"],value:this.state.suggestUrl,onBlur:this.handleBlur,onChange:this.suggestUrlChange,onKeyDown:this.handleKeyDown,disabled:this.state.readOnly})),this.state.usePost&&VU("div",{className:"setting-single dropfade"},void 0,VU(Ko.Z,{type:"text",label:this.props.searchableStrings["Suggest POST Parameters"],value:this.state.suggestPostParams,onBlur:this.handleBlur,onChange:this.suggestPostParamsChange,onKeyDown:this.handleKeyDown,disabled:this.state.readOnly}))),VU("div",{className:"setting-group"},void 0,VU("div",{className:"setting-single"},void 0,VU(Ko.Z,{type:"text",label:this.props.searchableStrings["Image Search URL"],value:this.state.imageUrl,onBlur:this.handleBlur,onChange:this.imageUrlChange,onKeyDown:this.handleKeyDown,disabled:this.state.readOnly})),VU("div",{className:"setting-single"},void 0,VU(Ko.Z,{type:"text",label:this.props.searchableStrings["Image Search POST Parameters"],value:this.state.imagePostParams,onBlur:this.handleBlur,onChange:this.imagePostParamsChange,onKeyDown:this.handleKeyDown,disabled:this.state.readOnly}))),VU("div",{className:"setting-group pad-top"},void 0,VU("div",{className:"setting-single"},void 0,VU("label",{},void 0,VU("input",{type:"checkbox",checked:this.state.usePost,onChange:this.postChange}),VU("span",{},void 0,this.props.searchableStrings["Use POST"]))),VU("div",{className:"setting-single"},void 0,VU("label",{},void 0,VU("input",{type:"checkbox",checked:this.state.default,disabled:this.state.default,onChange:this.defaultChange}),VU("span",{},void 0,this.props.searchableStrings["Set as Default Search"]))),VU("div",{className:"setting-single"},void 0,VU("label",{},void 0,VU("input",{type:"checkbox",checked:this.state.private,disabled:this.state.default&&this.state.private,onChange:this.privateChange}),VU("span",{},void 0,this.props.searchableStrings["Set as Private Search"]))))))}}const GU=zU;var $U,KU=n(34155);function jU(e,t,n,i){$U||($U="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:$U,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const YU=[D.kAddressBarInlineSearchEnabled,D.kAddressBarInlineSearchSuggestEnabled,D.kAddressBarInlineSearchSuggestOnNickname,D.kAddressBarSearchAllowExtensionOverride,D.kAddressBarSearchDisplay,D.kAddressBarSearchInNewTab,D.kAddressBarSearchKeepSelected,D.kAddressBarSearchShowFavicon,D.kAddressBarSearchSuggestEnabled,D.kPageSearchInBackground,D.kStartpageSpeedDialDisplaySearch],XU=nt.Z.getEventHandler;function QU({engines:e,selectedEngine:t,onValueChange:n,tooltip:i}){const s=e.map((e=>({type:"Normal",id:e.id,name:e.name,faviconUrl:e.faviconUrl,checked:t?.id===e.id})));return(0,fn.jsx)(fn.Fragment,{children:jU(Wf,{items:s,value:t?t.id:"",onValueChange:n,tooltip:i})})}var qU=jU("input",{type:"radio",value:"field"}),JU=jU("input",{type:"radio",value:"button"}),eV=jU("div",{className:"setting-single pad-left"});class tV extends tn.Component{static contextType=dn.Z;_focusEditor=!1;_editorKey=0;state={confirmation:!1,keepCustomEngines:!1,searchEngines:Nn.Z.get()};componentDidMount(){Nn.Z.addListener(this._onSearchEngineCacheChanged)}componentWillUnmount(){Nn.Z.removeListener(this._onSearchEngineCacheChanged)}_onSearchEngineCacheChanged=()=>{this.setState({searchEngines:Nn.Z.get()})};restoreSearchEngines=()=>{d.Z.searchEngines.repairPrepopulatedTemplateUrls(!this.state.keepCustomEngines),this.setState({confirmation:!1})};setDefault=(e,t)=>{d.Z.searchEngines.setDefault(t?"defaultPrivate":"defaultSearch",e),this._editorKey++};confirmRestoreDefaults=()=>{this.setState({confirmation:!0}),KU.nextTick((()=>this._editorKey++))};onCancelConfirm=()=>{this.setState({confirmation:!1})};toggleKeepCustomEngines=()=>{this.setState((e=>({keepCustomEngines:!e.keepCustomEngines})))};renderModal=()=>{const e=this.state.keepCustomEngines?(0,le.Z)("Search engines will be reset to default settings, but your custom search engines will be kept."):(0,le.Z)("Search engines will be reset to default settings, which will also reset your custom search engines.");return jU(ln.Z,{dialogWidth:400,onRequestClose:this.onCancelConfirm},void 0,jU("div",{className:"dialog-restore-search"},void 0,jU("header",{className:"dialog-header"},void 0,jU("h1",{className:"dialog-title"},void 0,(0,le.Z)("Restore Default Search Engines?"))),jU("div",{className:"dialog-content"},void 0,jU("p",{},void 0,e)),jU("footer",{className:"dialog-footer"},void 0,jU("label",{},void 0,jU("input",{type:"checkbox",checked:this.state.keepCustomEngines,onChange:this.toggleKeepCustomEngines}),jU("span",{},void 0,(0,le.Z)("Keep Custom Searches"))),jU("span",{},void 0,jU("input",{type:"button",className:"danger",onClick:this.restoreSearchEngines,value:(0,le.Z)("Restore")}),jU("input",{type:"button",onClick:this.onCancelConfirm,value:(0,le.Z)("Cancel"),autoFocus:!0})))))};removeAt=e=>{if(e>=0&&e<this.state.searchEngines.length){const t=this.state.searchEngines[e];d.Z.searchEngines.removeTemplateUrl(t.id)}};renderListItem=(e,t)=>{const n=Nn.Z.getById(t.key);if(!n)return(0,fn.jsx)(fn.Fragment,{children:jU("div",{className:"item-title"},void 0,e||"Error")});const i=Nn.Z.isDefault(n.id,!0),s=n.id===Nn.Z.getImageSearch()?.id;return(0,fn.jsxs)(fn.Fragment,{children:[jU(Oi,{className:"item-icon",url:n.faviconUrl,loadType:"faviconFromCache"}),jU("div",{className:"item-title"},void 0,e||n.name),i&&jU("span",{className:"item-badge",title:(0,le.Z)("Private Window Search Engine")},void 0,(0,le.Z)("Private")),s&&jU("span",{className:"item-badge",title:(0,le.Z)("Default Image Search Engine")},void 0,(0,le.Z)("Image")),jU("div",{className:"item-meta"},void 0,n.keyword)]})};onCreateEngine=async()=>{const e=co();e.name=(0,le.Z)("New Engine"),await d.Z.searchEngines.addTemplateUrl(e),this._focusEditor=!0,KU.nextTick((()=>this._focusEditor=!1))};renderContent=(e,t)=>{const n=this.state.searchEngines[e];return n?jU(GU,{focusNameInput:this._focusEditor,searchableStrings:t,filter:this.props.filter,id:n.id},n.id):null};onContextMenu=(e,t)=>{const n=[];if(e>=0&&e<this.state.searchEngines.length){const t=this.state.searchEngines[e];Nn.Z.isDefault(t.id,!1)||n.push({handler:this.setDefault.bind(this,t.id,!1),...(0,Mn.Z)("searchengine","Set as Default Search")}),Nn.Z.isDefault(t.id,!0)||n.push({handler:this.setDefault.bind(this,t.id,!0),...(0,Mn.Z)("searchengine","Set as Private Search")})}(0,zi.Z)(this.context.vivaldiWindowId,n)(t)};onActivate=e=>{if(e>=0&&e<this.state.searchEngines.length){const t=this.state.searchEngines[e];this.setDefault(t.id,!1)}};moveEngine=(e,t)=>{const n=e<t?t+1:t;if(e>=0&&e<this.state.searchEngines.length&&n>=0&&n<=this.state.searchEngines.length){const t=this.state.searchEngines[e];if(n===this.state.searchEngines.length)d.Z.searchEngines.moveTemplateUrl(t.id);else{const e=this.state.searchEngines[n];d.Z.searchEngines.moveTemplateUrl(t.id,e.id)}}};render(){if(!this.state.searchEngines)return null;const e=Nn.Z.getDefault(!1),t=Nn.Z.getDefault(!0),n=Nn.Z.getImageSearch(),i=this.state.searchEngines.filter((e=>e.imageUrl));n&&!i.find((e=>e.id===n.id))&&i.push(n);const s=this.state.searchEngines.map((t=>({key:t.id,name:t.name,isDefault:t.id===e?.id,isStatic:""!==t.extensionId,isRemovable:Nn.Z.isRemovable(t.id)&&!t.extensionId})));return jU(a_,{categoryTitle:(0,le.Z)("noun","Search"),filter:this.props.filter},void 0,this.state.confirmation&&this.renderModal(),jU("div",{},void 0,jU("div",{className:"setting-group"},void 0,jU("div",{className:"setting-single"},void 0,jU("h3",{},void 0,(0,le.Z)("Default Search Engine")),jU(QU,{engines:this.state.searchEngines,selectedEngine:e,onValueChange:e=>d.Z.searchEngines.setDefault("defaultSearch",e),tooltip:(0,le.Z)("Select Default Search Engine")}))),jU("div",{className:"setting-group"},void 0,jU("div",{className:"setting-single"},void 0,jU("h3",{},void 0,(0,le.Z)("Private Window Search Engine")),jU(QU,{engines:this.state.searchEngines,selectedEngine:t,onValueChange:e=>d.Z.searchEngines.setDefault("defaultPrivate",e),tooltip:(0,le.Z)("Select Private Window Search Engine")}))),jU("div",{className:"setting-group"},void 0,jU("div",{className:"setting-single"},void 0,jU("h3",{},void 0,(0,le.Z)("Image Search Engine")),jU(QU,{engines:i,selectedEngine:n,onValueChange:e=>d.Z.searchEngines.setDefault("defaultImage",e),tooltip:(0,le.Z)("Select Default Search Engine for Images")})))),jU("div",{className:"setting-group"},void 0,jU("h3",{},void 0,(0,le.Z)("Search Field Display")),jU("div",{className:"setting-single"},void 0,jU("label",{},void 0,jU(ws,{name:"renderSearchField",value:this.props.prefValues[D.kAddressBarSearchDisplay],onChange:XU(D.kAddressBarSearchDisplay)},void 0,jU("div",{className:"setting-single"},void 0,jU("label",{},void 0,qU,jU("span",{},void 0,(0,le.Z)("Show as a Text Field")))),jU("div",{className:"setting-single"},void 0,jU("label",{},void 0,JU,jU("span",{},void 0,(0,le.Z)("Show as a Button"))))))),jU("div",{className:"setting-single"},void 0,jU("label",{},void 0,jU("input",{type:"checkbox",checked:this.props.prefValues[D.kAddressBarSearchInNewTab],onChange:XU(D.kAddressBarSearchInNewTab)}),jU("span",{},void 0,(0,le.Z)("Always Search in New Tab")))),jU("div",{className:"setting-single"},void 0,jU("label",{},void 0,jU("input",{type:"checkbox",checked:this.props.prefValues[D.kAddressBarSearchShowFavicon],onChange:XU(D.kAddressBarSearchShowFavicon)}),jU("span",{},void 0,(0,le.Z)("Show Search Engine Icon"))))),jU("div",{className:"setting-group"},void 0,jU("h3",{},void 0,(0,le.Z)("Search Options")),jU("div",{className:"setting-single"},void 0,jU("label",{},void 0,jU("input",{type:"checkbox",checked:this.props.prefValues[D.kAddressBarInlineSearchEnabled],onChange:XU(D.kAddressBarInlineSearchEnabled)}),jU("span",{},void 0,(0,le.Z)("Search in Address Field")))),jU("div",{className:"setting-single pad-left"},void 0,jU("label",{},void 0,jU("input",{type:"checkbox",checked:this.props.prefValues[D.kAddressBarSearchAllowExtensionOverride],onChange:XU(D.kAddressBarSearchAllowExtensionOverride)}),jU("span",{},void 0,(0,le.Z)("Allow Control by Extensions"))),jU("p",{className:"info"},void 0,(0,le.Z)("Requires a restart to take effect"))),jU("div",{className:"setting-single"},void 0,jU("label",{},void 0,jU("input",{type:"checkbox",checked:this.props.prefValues[D.kStartpageSpeedDialDisplaySearch],onChange:XU(D.kStartpageSpeedDialDisplaySearch)}),jU("span",{},void 0,(0,le.Z)("Show Search Field on Speed Dial")))),jU("div",{className:"setting-single"},void 0,jU("label",{},void 0,jU("input",{type:"checkbox",checked:this.props.prefValues[D.kAddressBarSearchKeepSelected],onChange:XU(D.kAddressBarSearchKeepSelected)}),jU("span",{},void 0,(0,le.Z)("Keep Last Selected Search Engine")))),jU("div",{className:"setting-single"},void 0,jU("label",{},void 0,jU("input",{type:"checkbox",checked:this.props.prefValues[D.kPageSearchInBackground],onChange:XU(D.kPageSearchInBackground)}),jU("span",{},void 0,(0,le.Z)("Page Selection Search in Background"))))),jU("div",{className:"setting-group"},void 0,jU("div",{id:"searchSuggest",className:"setting-group"},void 0,jU("h3",{},void 0,(0,le.Z)("Allow Search Suggestions")),jU("div",{className:"setting-single"},void 0,jU("label",{},void 0,jU("input",{type:"checkbox",checked:this.props.prefValues[D.kAddressBarInlineSearchSuggestEnabled],onChange:XU(D.kAddressBarInlineSearchSuggestEnabled)}),jU("span",{},void 0,(0,le.Z)("searchengine","In Address Field")))),jU("div",{className:"setting-single pad-left"},void 0,jU("label",{},void 0,jU("input",{type:"checkbox",checked:this.props.prefValues[D.kAddressBarInlineSearchSuggestOnNickname],disabled:!this.props.prefValues[D.kAddressBarInlineSearchSuggestEnabled],onChange:XU(D.kAddressBarInlineSearchSuggestOnNickname)}),jU("span",{},void 0,(0,le.Z)("Only when Using Search Engine Nickname")))),jU("div",{className:"setting-single"},void 0,jU("label",{},void 0,jU("input",{type:"checkbox",checked:this.props.prefValues[D.kAddressBarSearchSuggestEnabled],onChange:XU(D.kAddressBarSearchSuggestEnabled)}),jU("span",{},void 0,(0,le.Z)("searchengine","In Search Field")))))),jU(sx.Z,{className:"setting-search-engine",filter:this.props.filter,subtitle:(0,le.Z)("Search Engines"),deleteTitle:(0,le.Z)("title","Delete Search Engine"),addTipString:(0,le.Z)("Add Search Engine"),deleteTipString:(0,le.Z)("tooltip","Delete Search Engine"),items:s,supportDragAndDrop:!0,masterLayout:1,mimeType:"vivaldi/x-search-engine",renderListItem:this.renderListItem,renderContent:this.renderContent,contentStrings:WU,moveItem:this.moveEngine,onContextMenu:this.onContextMenu,onActivate:this.onActivate,onRemove:this.removeAt,onCreateItem:this.onCreateEngine}),jU("div",{className:"setting-group unlimited"},void 0,jU("div",{className:"setting-single"},void 0,jU("input",{type:"button",onClick:this.confirmRestoreDefaults,value:(0,le.Z)("Restore Defaults")}),eV)))}}const nV=(0,fs.Z)(tV,YU);var iV;function sV(e,t,n,i){iV||(iV="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:iV,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class oV extends tn.Component{static contextType=dn.Z;manageCertificatesClicked=e=>{const{vivaldiWindowId:t}=this.context;d.Z.utilities.showManageSSLCertificates(t,(()=>{}))};render(){return sV(a_,{categoryTitle:(0,le.Z)("Security"),filter:this.props.filter},void 0,sV("div",{className:"setting-group unlimited"},void 0,sV("div",{className:"setting-single"},void 0,sV("input",{type:"button",value:(0,le.Z)("Manage Certificates"),onClick:this.manageCertificatesClicked}),sV("p",{className:"info"},void 0,(0,le.Z)("Manage HTTPS/SSL certificates and settings.")))))}}const aV=oV;var rV;function lV(e,t,n,i){rV||(rV="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:rV,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const dV=[D.kMailIsTurnedOff];function cV(e,t){const n=t[D.kMailIsTurnedOff];return Object.keys(St.mh).filter((e=>!("calendar"===e&&n||"mail"===e&&n||"rss"===e&&n||"chat"===e))).filter((t=>{const n=St.mh[t].section,i=!n||n===t,s=!!e&&n===e.section;return i||s})).map((e=>({...St.mh[e],key:e})))}class hV extends tn.PureComponent{rowComponent=e=>{const t=e.node,n=this.props.selectedCategory.title===t.title,i=t.section&&t.section!==t.key&&t.section===this.props.selectedCategory.section;return lV("div",{onMouseDown:e=>e.preventDefault(),className:mn()({"button-category":!0,"category-selected":n,section:i})},t.id,!i&&lV("span",{dangerouslySetInnerHTML:{__html:t.icon}}),t.title)};handleItemClick=(e,{key:t})=>{this.props.onCategorySelected(t)};handleItemsActivated=(e,t)=>{this.props.onCategorySelected(t[0].key)};handleFilterChange=({currentTarget:e})=>{this.props.onFilterChange(e.value)};render(){return lV("div",{className:"settings-sidebar"},void 0,lV("header",{className:"settings-navigation-header"},void 0,(0,fn.jsx)("input",{className:"settings-search",type:"search",ref:this.props.focusRef,placeholder:(0,le.Z)("verb","Search"),value:this.props.filter,onChange:this.handleFilterChange,autoFocus:z.ZP.isSettings(this.context.vivaldiWindowId),tabIndex:"0"})),lV(Yu,{rowComponent:this.rowComponent,nodes:cV(this.props.selectedCategory,this.props.prefValues),className:"settings-navigation",settings:"SETTINGS_TREE",onItemClick:this.handleItemClick,onItemsActivated:this.handleItemsActivated,enableDragAndDrop:!1,rowHeight:28,isFolder:EU.Z,hasChildren:EU.Z}))}}const pV=(0,fs.Z)(hV,dV);var uV;function gV(e,t,n,i){uV||(uV="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:uV,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const mV=[D.kStartpageNavigation,D.kStartpageSpeedDialAddButtonVisible,D.kStartpageSpeedDialAllowDnd,D.kStartpageSpeedDialColumns,D.kStartpageSpeedDialControlsVisible,D.kStartpageSpeedDialDeleteVisible,D.kStartpageSpeedDialFaviconVisible,D.kStartpageSpeedDialGameButtonShow,D.kStartpageSpeedDialTitlesVisible,D.kStartpageSpeedDialWidth,D.kStartpageSpeedDialPrivacyStatsShow],vV=nt.Z.getEventHandler,fV=[{value:120,label:(0,le.Z)("Tiny")},{value:170,label:(0,le.Z)("other","Small")},{value:220,label:(0,le.Z)("other","Medium")},{value:270,label:(0,le.Z)("other","Large")},{value:320,label:(0,le.Z)("Huge")},{value:-1,label:(0,le.Z)("Scale to Fit Columns")}];var yV=gV("input",{type:"radio",value:"on"}),wV=gV("input",{type:"radio",value:"speed_dial_only"}),bV=gV("input",{type:"radio",value:"off"}),CV=gV("input",{type:"radio",value:"always"}),SV=gV("input",{type:"radio",value:"hover"}),TV=gV("input",{type:"radio",value:"never"}),IV=gV("option",{value:1},void 0,"1"),kV=gV("option",{value:2},void 0,"2"),AV=gV("option",{value:3},void 0,"3"),ZV=gV("option",{value:4},void 0,"4"),EV=gV("option",{value:5},void 0,"5"),_V=gV("option",{value:6},void 0,"6"),NV=gV("option",{value:7},void 0,"7"),MV=gV("option",{value:8},void 0,"8"),PV=gV("option",{value:10},void 0,"10"),DV=gV("option",{value:12},void 0,"12");class xV extends tn.PureComponent{render(){const{filter:e,prefValues:t}=this.props;return gV("div",{},void 0,gV(a_,{categoryTitle:(0,le.Z)("verb","Start Page"),filter:e},void 0,gV("div",{className:"setting-group unlimited"},void 0,gV("div",{className:"setting-group"},void 0,gV("h3",{},void 0,(0,le.Z)("Start Page Navigation")),gV("div",{className:"setting-single"},void 0,gV(ws,{name:"StartPageNavigation",value:t[D.kStartpageNavigation],onChange:vV(D.kStartpageNavigation)},void 0,gV("div",{className:"setting-single"},void 0,gV("label",{},void 0,yV,gV("span",{},void 0,(0,le.Z)("Show on Internal Pages")))),gV("div",{className:"setting-single"},void 0,gV("label",{},void 0,wV,gV("span",{},void 0,(0,le.Z)("Show on Speed Dial Page")))),gV("div",{className:"setting-single"},void 0,gV("label",{},void 0,bV,gV("span",{},void 0,(0,le.Z)("radio","Hide Titles"))))))))),gV(a_,{categoryTitle:(0,le.Z)("Speed Dial"),filter:e},void 0,gV("div",{className:"setting-group"},void 0,gV("h3",{},void 0,(0,le.Z)("Speed Dial Appearance")),gV(ws,{name:"SpeedDialTitles",value:t[D.kStartpageSpeedDialTitlesVisible],onChange:vV(D.kStartpageSpeedDialTitlesVisible)},void 0,gV("div",{className:"setting-single"},void 0,gV("label",{},void 0,CV,gV("span",{},void 0,(0,le.Z)("Show Title")))),gV("div",{className:"setting-single"},void 0,gV("label",{},void 0,SV,gV("span",{},void 0,(0,le.Z)("Show Title on Hover")))),gV("div",{className:"setting-single"},void 0,gV("label",{},void 0,TV,gV("span",{},void 0,(0,le.Z)("Hide Title"))))),gV("div",{className:"setting-single pad-top"},void 0,gV("label",{},void 0,gV("input",{type:"checkbox",checked:t[D.kStartpageSpeedDialFaviconVisible],onChange:vV(D.kStartpageSpeedDialFaviconVisible),disabled:"never"===t[D.kStartpageSpeedDialTitlesVisible]}),gV("span",{},void 0,(0,le.Z)("Show Favicon")))),gV("div",{className:"setting-single"},void 0,gV("label",{},void 0,gV("input",{type:"checkbox",checked:t[D.kStartpageSpeedDialDeleteVisible],onChange:vV(D.kStartpageSpeedDialDeleteVisible)}),gV("span",{},void 0,(0,le.Z)("Show Delete Button")))),gV("div",{className:"setting-single"},void 0,gV("label",{},void 0,gV("input",{type:"checkbox",checked:t[D.kStartpageSpeedDialControlsVisible],onChange:vV(D.kStartpageSpeedDialControlsVisible)}),gV("span",{},void 0,(0,le.Z)("Show Thumbnail Control Buttons")))),gV("div",{className:"setting-single"},void 0,gV("label",{},void 0,gV("input",{type:"checkbox",checked:t[D.kStartpageSpeedDialAddButtonVisible],onChange:vV(D.kStartpageSpeedDialAddButtonVisible)}),gV("span",{},void 0,(0,le.Z)("Show “Add” Button"))),gV("p",{className:"info"},void 0,(0,le.Z)("When disabled, new bookmarks can be added by double-clicking the Speed Dial background."))),gV("div",{className:"setting-single"},void 0,gV("label",{},void 0,gV("input",{type:"checkbox",checked:t[D.kStartpageSpeedDialPrivacyStatsShow],onChange:vV(D.kStartpageSpeedDialPrivacyStatsShow)}),gV("span",{},void 0,(0,le.Z)("Show Privacy Statistics"))))),gV("div",{className:"setting-group"},void 0,gV("div",{className:"setting-single"},void 0,gV("h3",{},void 0,(0,le.Z)("Maximum Columns")),gV("select",{className:"max-columns",value:t[D.kStartpageSpeedDialColumns],onChange:vV(D.kStartpageSpeedDialColumns),title:(0,le.Z)("Maximum number of Speed Dial columns")},void 0,IV,kV,AV,ZV,EV,_V,NV,MV,PV,DV,gV("option",{value:99},void 0,(0,le.Z)("Unlimited")))),gV("div",{className:"setting-single pad-top"},void 0,gV("h3",{},void 0,(0,le.Z)("Speed Dial Thumbnail Size")),gV("select",{className:"max-columns",value:t[D.kStartpageSpeedDialWidth],onChange:vV(D.kStartpageSpeedDialWidth)},void 0,fV.map((({value:e,label:t})=>gV("option",{value:e},e,t))))),gV("div",{className:"setting-single pad-top"},void 0,gV("label",{},void 0,gV("input",{type:"checkbox",checked:t[D.kStartpageSpeedDialAllowDnd],onChange:vV(D.kStartpageSpeedDialAllowDnd)}),gV("span",{},void 0,(0,le.Z)("Allow Drag and Drop Reordering"))))),gV("div",{className:"setting-group"},void 0,gV("div",{className:"setting-single"},void 0,gV("h3",{},void 0,(0,le.Z)("Vivaldia, the Vivaldi Game")),gV("label",{},void 0,gV("input",{type:"checkbox",checked:t[D.kStartpageSpeedDialGameButtonShow],onChange:vV(D.kStartpageSpeedDialGameButtonShow)}),gV("span",{},void 0,(0,le.Z)("Show on Speed Dial")))))))}}const OV=(0,fs.Z)(xV,mV);var LV;function RV(e,t,n,i){LV||(LV="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:LV,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const BV=nt.Z.getEventHandler,FV=[D.kWindowsShowWindowCloseConfirmationDialog];class UV extends tn.Component{render(){return RV(jE.Z,{filter:this.props.filter},void 0,RV("div",{className:"setting-group"},void 0,RV("h3",{},void 0,(0,le.Z)("Close Window Confirmation")),RV("div",{className:"setting-single"},void 0,RV("label",{},void 0,RV("input",{type:"checkbox",checked:this.props.prefValues[D.kWindowsShowWindowCloseConfirmationDialog],onChange:BV(D.kWindowsShowWindowCloseConfirmationDialog)}),RV("span",{},void 0,(0,le.Z)("Show Close Window Confirmation Dialog"))))))}}const VV=(0,fs.Z)(UV,FV);var WV;function HV(e,t,n,i){WV||(WV="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:WV,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const zV=nt.Z.getEventHandler,GV=[D.kSystemShowExitConfirmationDialog];class $V extends tn.Component{renderMacQuitConfirmation(){return HV(jE.Z,{filter:this.props.filter},void 0,HV("div",{className:"setting-group"},void 0,HV("h3",{},void 0,(0,le.Z)("Quit Confirmation")),HV("div",{className:"setting-single"},void 0,HV("label",{},void 0,HV("input",{type:"checkbox",checked:this.props.prefValues[D.kConfirmToQuitEnabled],onChange:zV(D.kConfirmToQuitEnabled)}),HV("span",{},void 0,(0,le.Z)("Show Quit Confirmation Dialog"))))))}renderExitConfirmation(){return HV(jE.Z,{filter:this.props.filter},void 0,HV("div",{className:"setting-group"},void 0,HV("h3",{},void 0,(0,le.Z)("Exit Confirmation")),HV("div",{className:"setting-single"},void 0,HV("label",{},void 0,HV("input",{type:"checkbox",checked:this.props.prefValues[D.kSystemShowExitConfirmationDialog],onChange:zV(D.kSystemShowExitConfirmationDialog)}),HV("span",{},void 0,(0,le.Z)("Show Exit Confirmation Dialog"))))))}render(){return this.renderExitConfirmation()}}const KV=(0,fs.Z)($V,GV);var jV;function YV(e,t,n,i){jV||(jV="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:jV,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const XV="about:blank",QV=[D.kHomepage,D.kHomepageCache];class qV extends tn.Component{state={customHomepage:this.props.prefValues[D.kHomepageCache]};saveHomePage=({currentTarget:e})=>{this.setState({customHomepage:e.value});const t=""!==e.value?(0,Ni.Rz)(e.value):e.value;nt.Z.set(D.kHomepage,t||XV),t!==Q.QG&&nt.Z.set(D.kHomepageCache,t)};render(){const e=(this.props.prefValues[D.kHomepage]===XV?"":this.props.prefValues[D.kHomepage])===Q.QG;return YV(jE.Z,{filter:this.props.filter},void 0,YV("div",{className:"setting-group homepage"},void 0,YV("h3",{},void 0,(0,le.Z)("noun","Homepage")),YV("div",{className:"setting-single"},void 0,YV("label",{},void 0,YV("input",{type:"radio",name:"startpage_url",onChange:this.saveHomePage,checked:e,value:Q.QG}),YV("span",{},void 0,(0,le.Z)("other","Start Page")))),YV("div",{className:"setting-single"},void 0,YV("label",{},void 0,YV("input",{type:"radio",name:"startpage_url",onChange:this.saveHomePage,checked:!e,value:this.props.prefValues[D.kHomepageCache]}),YV("span",{},void 0,(0,le.Z)("Specific Page")))),YV("div",{className:"setting-single"},void 0,YV("input",{type:"text",placeholder:(0,le.Z)("Address"),disabled:e,onChange:this.saveHomePage,value:this.state.customHomepage}))))}}const JV=(0,fs.Z)(qV,QV);var eW;function tW(e,t,n,i){eW||(eW="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:eW,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class nW extends tn.Component{handleUrlChange=e=>{var t=this.props.urlItem;t.url=e.target.value,this.props.onSave(t)};render(){return tW(jE.Z,{filter:this.props.filter},void 0,tW("div",{className:"setting-single"},void 0,tW("input",{className:"edit",type:"text",value:this.props.urlItem.url,onChange:this.handleUrlChange}),tW("input",{type:"button",tabIndex:"-1",className:"circular clearkey",onClick:this.props.onDelete,title:(0,le.Z)("Remove page")})))}}const iW=nW;var sW;function oW(e,t,n,i){sW||(sW="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:sW,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class aW extends tn.Component{refCreateUrlField=tn.createRef();constructor(e){super(e);var t=(M.Z.get(D.kURLsToRestoreOnStartup)??[]).map(((e,t)=>({url:e,id:t})));this.state={STARTUP_SESSION_URLS:t,hasUrlInInput:!1}}handleInputChange=e=>{if(e.target.value.length>2?this.setState({hasUrlInInput:!0}):this.setState({hasUrlInInput:!1}),e.keyCode===qi.Z.KEY_ESCAPE)e.target.value="",this.setState({hasUrlInInput:!1});else{if(e.keyCode!==qi.Z.KEY_RETURN&&e.keyCode!==qi.Z.KEY_ENTER)return;e.target.value.length>2&&this.addUrl()}};saveChanges=()=>{for(var e=[],t=this.state.STARTUP_SESSION_URLS,n=0;n<t.length;n++)e.push(t[n].url);nt.Z.set(D.kURLsToRestoreOnStartup,e)};addUrl=()=>{const e=this.refCreateUrlField.current;if(!e)return;let t=e.value.trim();-1===t.indexOf("://")&&(t="http://"+t),e.value="",this.setState({hasUrlInInput:!1});let n=0;this.state.STARTUP_SESSION_URLS.length>0&&(n=Math.max.apply(Math,this.state.STARTUP_SESSION_URLS.map((e=>e.id?e.id:0)))),this.state.STARTUP_SESSION_URLS.push({url:t,id:n+1}),this.saveChanges()};save=e=>{this.setState((t=>{for(var n=t.STARTUP_SESSION_URLS,i=0;i<n.length;i++)if(n[i].id===e.id){var s=e.url;-1===s.indexOf(":")&&(s="http://"+s),n[i].url=s;break}return{STARTUP_SESSION_URLS:n}}),(()=>{this.saveChanges()}))};deleteUrl=e=>{this.setState((t=>{for(var n=t.STARTUP_SESSION_URLS,i=0;i<n.length;i++)if(n[i].url===e.url){n.splice(i,1);break}return{STARTUP_SESSION_URLS:n}}),(()=>{this.saveChanges()}))};useCurrentPages=()=>{y.Z.tabs.query({windowType:"normal"},(e=>{const t=e.filter((e=>!St.jk.isInternalPage(e))).map(((e,t)=>({id:t+1,url:e.url||""})));this.setState({STARTUP_SESSION_URLS:t}),this.saveChanges()}))};render(){var e=this.state.STARTUP_SESSION_URLS.map((e=>oW(iW,{urlItem:e,onDelete:this.deleteUrl.bind(this,e),onSave:this.save,filter:this.props.filter},e.id)));return oW(jE.Z,{filter:this.props.filter},void 0,oW("div",{className:"setting-group setting-startup-specific-pages"},void 0,oW("h3",{},void 0,(0,le.Z)("Startup Pages")),e,oW("div",{className:"setting-flexgroup"},void 0,(0,fn.jsx)("input",{type:"text",className:"setting-single-flex",ref:this.refCreateUrlField,value:this.props.url,onChange:this.handleInputChange,placeholder:(0,le.Z)("Enter page URL")}),oW("input",{type:"button",className:"setting-single-noflex",onClick:this.addUrl,disabled:!this.state.hasUrlInInput,value:(0,le.Z)("Add")})),oW("input",{type:"button",onClick:this.useCurrentPages,value:(0,le.Z)("Use Current Pages")})))}}const rW=aW;var lW;function dW(e,t,n,i){lW||(lW="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:lW,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const cW=[D.kTabsAlwaysLoadPinnedAfterRestore,D.kTabsDeferLoadingAfterRestore],hW=nt.Z.getEventHandler;var pW=dW("input",{type:"radio",value:"last"}),uW=dW("input",{type:"radio",value:"homepage"}),gW=dW("input",{type:"radio",value:"speeddial"}),mW=dW("input",{type:"radio",value:"urls"});class vW extends tn.PureComponent{_isMounted=!1;state={STARTUP_OPTIONS:"last"};componentDidMount(){this._isMounted=!0,d.Z.utilities.getStartupAction((e=>{this._isMounted&&this.setState({STARTUP_OPTIONS:e})}))}componentWillUnmount(){this._isMounted=!1}saveStartup=e=>{const t=e.target.value,n=M.Z.get(D.kURLsToRestoreOnStartup);d.Z.utilities.setStartupAction(t,n,(e=>{this.setState({STARTUP_OPTIONS:e})}))};render(){const e="urls"===this.state.STARTUP_OPTIONS?(0,fn.jsx)(rW,{...this.props}):null;return dW(jE.Z,{filter:this.props.filter},void 0,dW("span",{},void 0,dW("div",{className:"setting-group"},void 0,dW("h3",{},void 0,(0,le.Z)("Startup with")),dW(ws,{name:"startupSettings",value:this.state.STARTUP_OPTIONS,onChange:this.saveStartup},void 0,dW("div",{className:"setting-single"},void 0,dW("label",{},void 0,pW,dW("span",{},void 0,(0,le.Z)("Last Session")))),dW("div",{className:"setting-single"},void 0,dW("label",{},void 0,uW,dW("span",{},void 0,(0,le.Z)("radio","Homepage")))),dW("div",{className:"setting-single"},void 0,dW("label",{},void 0,gW,dW("span",{},void 0,(0,le.Z)("radio","Start Page")))),dW("div",{className:"setting-single"},void 0,dW("label",{},void 0,mW,dW("span",{},void 0,(0,le.Z)("Specific Pages"))))),dW("div",{className:"setting-single pad-top"},void 0,dW("label",{title:(0,le.Z)("Wait to load restored session content until tab is activated.")},void 0,dW("input",{type:"checkbox",checked:this.props.prefValues[D.kTabsDeferLoadingAfterRestore],onChange:hW(D.kTabsDeferLoadingAfterRestore)}),dW("span",{},void 0,(0,le.Z)("Lazy Load Restored Tabs")))),dW("div",{className:"setting-single pad-left"},void 0,dW("label",{title:(0,le.Z)("Load pinned tabs before they are activated.")},void 0,dW("input",{type:"checkbox",disabled:!this.props.prefValues[D.kTabsDeferLoadingAfterRestore],checked:this.props.prefValues[D.kTabsAlwaysLoadPinnedAfterRestore],onChange:hW(D.kTabsAlwaysLoadPinnedAfterRestore)}),dW("span",{},void 0,(0,le.Z)("Always Load Pinned Tabs"))))),e))}}const fW=(0,fs.Z)(vW,cW);var yW;function wW(e,t,n,i){yW||(yW="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:yW,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const bW=[D.kWelcomeReadPages,D.kWelcomeSeenPages];class CW extends tn.Component{resetSeen=()=>{nt.Z.set(D.kWelcomeReadPages,[]),nt.Z.set(D.kWelcomeSeenPages,[])};render(){const e=this.props.prefValues[D.kWelcomeReadPages].length>0,t=this.props.prefValues[D.kWelcomeSeenPages].length>0;return wW(jE.Z,{filter:this.props.filter},void 0,wW("div",{className:"setting-group"},void 0,wW("h3",{},void 0,(0,le.Z)("Welcome Page")),wW("div",{className:"setting-single"},void 0,wW("label",{},void 0,wW("input",{type:"button",disabled:e+t===0,value:(0,le.Z)("Reset Welcome Page"),onClick:this.resetSeen})))))}}(0,fs.Z)(CW,bW);var SW;function TW(e,t,n,i){SW||(SW="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:SW,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const IW=[D.kStartupCheckIsDefault],kW=nt.Z.getEventHandler;class AW extends tn.Component{_isMounted=!1;state={isVivaldiDefault:!0};componentDidMount(){this.getDefaultBrowserValue(),this._isMounted=!0}componentWillUnmount(){this._isMounted=!1}getDefaultBrowserValue=()=>{d.Z.utilities.isVivaldiDefaultBrowser((e=>{this._isMounted&&this.setState({isVivaldiDefault:!0===e})}))};setVivaldiDefault=()=>{d.Z.utilities.setVivaldiAsDefaultBrowser((e=>{this._isMounted&&this.setState({isVivaldiDefault:!0===e})})),this.props.onClose&&this.props.onClose()};renderCheckbox=()=>TW("label",{title:(0,le.Z)("Check if Vivaldi is your default browser upon every startup")},void 0,TW("input",{type:"checkbox",checked:this.props.prefValues[D.kStartupCheckIsDefault],onChange:kW(D.kStartupCheckIsDefault)}),TW("span",{},void 0,(0,le.Z)("Check on Startup")));render(){return this.props.onClose?TW("form",{onSubmit:this.setVivaldiDefault,className:"SuggestDefault"},void 0,TW("span",{},void 0,(0,le.Z)("Enjoying Vivaldi? Make it your default browser.")),TW("input",{type:"submit",value:(0,le.Z)("browser","Set as Default Browser")}),this.renderCheckbox(),TW("button",{type:"button",className:"SuggestDefault-Close",dangerouslySetInnerHTML:{__html:cn.vyJ},onClick:this.props.onClose})):TW(jE.Z,{filter:this.props.filter},void 0,TW("div",{className:"setting-group"},void 0,!this.props.onClose&&TW("h3",{},void 0,(0,le.Z)("Default Browser")),TW("div",{className:"setting-single"},void 0,this.state.isVivaldiDefault?TW("p",{},void 0,(0,le.Z)("Vivaldi is set as your default browser.")):TW("div",{},void 0,TW("p",{},void 0,(0,le.Z)("Vivaldi isn’t your default browser.")),TW("input",{type:"button",onClick:this.setVivaldiDefault,value:(0,le.Z)("browser","Set as Default")}))),TW("div",{className:"setting-single pad-top"},void 0,this.renderCheckbox())))}}const ZW=(0,fs.Z)(AW,IW);var EW;function _W(e,t,n,i){EW||(EW="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:EW,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class NW extends tn.Component{render(){return(0,fn.jsxs)(fn.Fragment,{children:[_W(a_,{categoryTitle:(0,le.Z)("Startup"),filter:this.props.filter},void 0,(0,fn.jsx)(ZW,{...this.props}),(0,fn.jsx)(JV,{...this.props}),(0,fn.jsx)(fW,{...this.props}),!1),_W(a_,{categoryTitle:(0,le.Z)("title","Close and Exit"),filter:this.props.filter},"2",(0,fn.jsx)(KV,{...this.props}),(0,fn.jsx)(VV,{...this.props}))]})}}const MW=NW;var PW;function DW(e,t,n,i){PW||(PW="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:PW,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class xW extends tn.PureComponent{state={remaining:b().duration({})};componentDidMount=()=>{this.nextTick()};componentWillUnmount=()=>{clearTimeout(this.timer)};nextTick=()=>{this.timer=setTimeout(this.nextTick,1e3),this.props.end.isAfter(b()())?(this.setState({remaining:b().duration(this.props.end.diff(b()()))}),this.props.onElapsed(!1)):(this.setState({remaining:b().duration(this.props.end.diff(b()()))}),this.props.onElapsed(!0))};render(){const e=this.state.remaining;return DW("span",{},void 0,(0,le.Z)(this.props.label,[e.minutes().toString().padStart(2,"0")+":"+e.seconds().toString().padStart(2,"0")]))}}const OW=xW;function LW(e){l.Z.dispatch({actionType:"VIVALDI_ACCOUNT_STATE_UPDATED",state:e})}const RW=new class{login(e,t,n){d.Z.vivaldiAccount.login(e,t,n),d.Z.sync.start()}logout(){d.Z.sync.stop(),d.Z.vivaldiAccount.logout()}loadPromise(){const e=z.ZP.getId();return e!==z.Ex&&z.ZP.isIncognitoOrGuest(e)?Promise.resolve():new Promise((e=>d.Z.vivaldiAccount.getState((t=>{LW(t),d.Z.vivaldiAccount.onAccountStateChanged.addListener(LW),e()}))))}},BW=RW;var FW;function UW(e,t,n,i){FW||(FW="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:FW,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function VW(e){Y.Z.openURL(e,"https://login.vivaldi.net/profile/samlsso")}function WW(){BW.logout()}function HW({windowId:e,deviceName:t,pictureUrl:n,username:i,isLoggedIn:s}){return UW("div",{className:"sync-status"},void 0,UW("div",{className:"avatar-username"},void 0,UW("img",{src:n||"/resources/default-avatar.png",className:"profile-picture",title:(0,le.Z)("View account profile page"),onClick:()=>VW(e),alt:""}),UW("div",{className:"user-info"},void 0,UW("strong",{className:"username",onClick:()=>VW(e)},void 0,i),UW("span",{className:"info"},void 0,t&&" "+(0,le.Z)("on $1",[t])))),s&&UW("input",{type:"button",value:(0,le.Z)("Log Out"),onClick:WW}))}var zW,GW,$W=n(34155);function KW(e,t,n,i){zW||(zW="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:zW,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class jW extends tn.PureComponent{_refInput=tn.createRef();state={type:"password"};toggleVisibility=()=>{const e={start:this._refInput.current?.selectionStart||0,end:this._refInput.current?.selectionEnd||0};this.setState((e=>({type:"text"===e.type?"password":"text"}))),$W.nextTick((()=>{this._refInput.current&&(this._refInput.current.selectionStart=e.start,this._refInput.current.selectionEnd=e.end)}))};render(){const{hideButton:e,...t}=this.props;return KW("span",{className:"PasswordInputWrapper"},void 0,(0,fn.jsx)("input",{...t,ref:this._refInput,type:this.state.type,className:"PasswordInput"}),!e&&KW("button",{type:"button",title:"password"===this.state.type?(0,le.Z)("title","Show password"):(0,le.Z)("Hide password"),onClick:this.toggleVisibility,className:"PasswordToggle",tabIndex:"-1",dangerouslySetInnerHTML:{__html:cn.sgm.medium}}))}}function YW(e,t,n,i){GW||(GW="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:GW,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const XW="•••••••",QW=nt.Z.getEventHandler,qW="17006";class JW extends tn.PureComponent{static contextType=dn.Z;constructor(e){super(e),this.state={username:e.accountState.accountInfo.username,password:e.accountState.hasSavedPassword?XW:"",sessionName:"",savePassword:!1,countdownElapsed:!1}}onCountDownElapsed=e=>{this.setState({countdownElapsed:e})};onUsernameChange=e=>{this.setState({username:e.target.value})};onPasswordChange=e=>{this.setState({password:e.target.value})};onSavePasswordChange=e=>{this.setState({savePassword:e.target.checked})};onRecoverAccount=()=>{Y.Z.openURL(this.context.vivaldiWindowId,"https://login.vivaldi.net/profile/id/recoverAccount",{inCurrent:!1})};onPasswordReset=()=>{Y.Z.openURL(this.context.vivaldiWindowId,"https://login.vivaldi.net/profile/id/userInfoView",{inCurrent:!1})};onLogin=()=>{this.state.username&&this.state.password&&BW.login(this.state.username,this.state.password===XW?"":this.state.password,this.state.savePassword)};onLogout=()=>{BW.logout()};onRegister=()=>{this.props.onChangeDisplay()};renderForm=e=>{const t=""!==this.props.accountState.accountInfo.accountId,n=this.props.accountState.hasSavedPassword&&this.props.accountState.accountInfo.username===this.state.username,i=n&&this.state.password===XW;return YW("form",{onSubmit:this.onLogin,noValidate:!0},void 0,YW("h1",{},void 0,(0,le.Z)("Log in to Your Account")),YW("p",{},void 0,(0,le.Z)("To begin with data synchronization, a confirmed Vivaldi account is required. New to Vivaldi?")," ",YW(Uw,{onClick:this.onRegister},void 0,(0,le.Z)("Create an Account."))),YW("div",{className:"AccountSheet-Form"},void 0,YW("label",{},void 0,(0,le.Z)("Username"),YW("input",{type:"text",value:this.state.username,disabled:t,onChange:this.onUsernameChange,autoFocus:this.props.autoFocus})),!i&&YW(Uw,{onClick:this.onRecoverAccount},void 0,(0,le.Z)("Forgot Username?")),YW("label",{},void 0,(0,le.Z)("Password"),YW(jW,{value:this.state.password,onChange:this.onPasswordChange,hideButton:i})),!n&&YW(Uw,{onClick:this.onPasswordReset},void 0,(0,le.Z)("Forgot Password?")),YW("label",{className:"AccountSheet-Password"},void 0,YW("input",{type:"checkbox",disabled:i,checked:this.state.savePassword||i,onChange:this.onSavePasswordChange}),(0,le.Z)("Save Password")),YW("label",{},void 0,(0,le.Z)("Device Name"),YW("input",{type:"text",defaultValue:this.props.customSessionName,placeholder:this.props.defaultSessionName,onChange:QW(D.kSyncSessionName)}))),e&&YW(Tr,{type:"error"},void 0,e),YW("div",{className:"AccountSheet-Footer"},void 0,t&&YW("input",{type:"button",value:(0,le.Z)("Cancel"),onClick:this.onLogout}),YW("input",{type:"submit",value:(0,le.Z)("Login")})))};render(){if(z.ZP.isIncognitoOrGuest(this.context.vivaldiWindowId))return null;const{accountState:e,defaultSessionName:t}=this.props,n=e.accountInfo.username,i=e.lastTokenFetchError.serverMessage,s=e.lastTokenFetchError.errorCode,o=b()(e.nextTokenRequestTime),a=M.Z.get(D.kSyncSessionName)||t;let r=null;switch(Cd(e)){case"loggedIn":return(0,fn.jsxs)(fn.Fragment,{children:[YW("h1",{},void 0,(0,le.Z)("Connected")),YW("p",{},void 0,(0,le.Z)("Vivaldi account is active and connected.")),YW(HW,{windowId:this.context.vivaldiWindowId,deviceName:a,pictureUrl:e.accountInfo.pictureUrl,username:n,isLoggedIn:!0})]});case"loginFailed":if(i){if(e.lastTokenFetchError.serverMessage.startsWith(qW))break;r=function(e){const t=parseInt(e.substring(0,5));switch(t){case 17001:return(0,le.Z)("$1 Account doesn’t exist.",[t]);case 17002:return(0,le.Z)("$1 Invalid credentials are provided.",[t]);case 17003:return(0,le.Z)("$1 Account is locked after multiple incorrect login attempts, please wait 5 minutes.",[t]);case 17004:return(0,le.Z)("$1 Account is disabled.",[t]);case 17005:return(0,le.Z)("$1 Account has been temporarily locked as a result of multiple unsuccessful login attempts. Please wait 5 minutes before trying again.",[t]);case 17006:return(0,le.Z)("$1 Account hasn’t been activated yet. Please check your email to finish the registration process.",[t]);default:return e}}(i)}else r=-1===s?(0,le.Z)("You must use a vivaldi.net user account to log in."):(0,le.Z)("Vivaldi.net rejected your credentials: Error code $1",[s]);break;case"loggingIn":return o.isAfter(b()())&&("network_error"===e.lastTokenFetchError.errorType&&(r=(0,le.Z)("Unable to connect to vivaldi.net: $1 ($2)",[i,s])),"server_error"===e.lastTokenFetchError.errorType&&(r=i?(0,le.Z)("Vivaldi.net is experiencing issues: $1 ($2)",[i,s]):(0,le.Z)("Vivaldi.net is experiencing issues: Error code $1",[s]))),(0,fn.jsxs)(fn.Fragment,{children:[YW("div",{className:"AccountSheet-Form"},void 0,YW("p",{className:r?null:"in-progress"},void 0,(0,le.Z)("Logging in to Vivaldi.net as $1.",[n]),!r&&" "+(0,le.Z)("Please wait."))),r&&YW(Tr,{type:"error"},void 0,r," ",YW(OW,{label:"Retrying in $1",end:o,onElapsed:this.onCountDownElapsed})),YW("div",{className:"AccountSheet-Footer"},void 0,YW("input",{type:"button",value:(0,le.Z)("Cancel"),onClick:this.onLogout}))]});case"credentialsMissing":r=e.hasEncryptedToken?(0,le.Z)("Failed to decrypt your credentials. Please log in again."):(0,le.Z)("Failed to retreive your credentials. Please log in again.")}return this.renderForm(r)}}const eH=JW;var tH,nH=n(34155);function iH(e,t,n,i){tH||(tH="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:tH,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const sH="[a-zA-Z0-9]{3,30}",oH=".+@[^\\.]+?\\.\\w[\\w\\.]+?",aH=y.Z.i18n.getUILanguage().replace("-","_"),rH=nt.Z.getEventHandler;let lH=new AbortController;const dH=()=>lH.abort();function cH(e,t){dH();const n=new Promise(((n,i)=>{lH=new AbortController,fetch(e,{method:"POST",body:JSON.stringify(t),signal:lH.signal,headers:{"Content-Type":"application/json"}}).then((e=>{e.ok||i(e.text()),n(e.json())}))})),i=new Promise(((e,t)=>{const n=setTimeout((()=>{clearTimeout(n),t({status:0,statusText:"Error: Connection timed out [9010]"})}),6e4)}));return Promise.race([n,i])}class hH extends tn.PureComponent{static contextType=dn.Z;_refEmailField=tn.createRef();_refConfirmEmailField=tn.createRef();_refUsernameField=tn.createRef();_refAgeField=tn.createRef();_refPasswordField=tn.createRef();_refConfirmPasswordField=tn.createRef();_refVerifyAccountField=tn.createRef();constructor(e){super(e),this.state={username:e.accountState.accountInfo.username||"",email:"",error:"",age:-1,password:"",savePassword:!0,step:e.unverified?3:1,fetching:!1,agreedToTerms:!1,agreedToNewsletter:!1,activationCode:"",activationCount:0},e.unverified&&d.Z.vivaldiAccount.getPendingRegistration((e=>{e&&this.setState({username:e.username,email:e.recovery_email,password:e.password},(()=>this.goToStep(3)))}))}componentWillUnmount(){dH()}getError=e=>{switch(e){case 1001:case 1005:return{error:(0,le.Z)("Please choose a username between 3 and 30 letters (a-z) and numbers (0-9) only."),step:1,field:"username"};case 1002:return{error:(0,le.Z)("Please enter a valid email address."),step:1,field:"email"};case 1003:return{error:(0,le.Z)("We require our members to be at least 16 years old to join."),step:1,field:"age"};case 1004:return{error:(0,le.Z)("This email is already linked with another account."),step:1,field:"email"};case 1006:return{error:(0,le.Z)("Please choose a password at least 12 characters long."),step:2,field:"password"};case 1007:return{error:(0,le.Z)("Username “$1” already exists, please enter another one.",[this.state.username]),step:1,field:"username"};case 1008:return{error:(0,le.Z)("Email is in wrong format."),step:1,field:"email"};case 1010:return{error:(0,le.Z)("Please enter a realistic lifespan number."),step:1,field:"age"};case 2001:return{error:(0,le.Z)("Username contains a reserved word."),step:1,field:"username"};case 2002:return{error:(0,le.Z)("Email domain has been blacklisted."),step:1,field:"email"};case 2003:return{error:(0,le.Z)("IP address has been blacklisted."),step:1,field:"username"};case 3001:return{error:(0,le.Z)("Claims are missing."),step:1,field:"username"};case 4001:return{error:(0,le.Z)("Code does not match."),step:3,field:"activationCode"};case 4002:return{error:(0,le.Z)("The code has expired. Please request a new activation code."),step:3,field:"activationCode"};case 4004:return{error:(0,le.Z)("The code has been invalidated. Please request a new activation code."),step:3,field:"activationCode"};case 5001:return{error:(0,le.Z)("Failed to send account activation email."),step:3,field:"activationCode"};case 4003:case 5002:return{error:(0,le.Z)("Account has been locked."),step:3,field:"activationCode"};case 9e3:return{error:(0,le.Z)("Please fill in the required fields."),step:1,field:"username"};case 9001:return{error:(0,le.Z)("Email addresses need to match."),step:1,field:"email"};case 9002:return{error:(0,le.Z)("Passwords need to match."),step:2,field:"password"};case 9003:return{error:(0,le.Z)("You need to agree to Terms and Conditions."),step:2,field:"password"};case 9004:return{error:(0,le.Z)("Activation code should consist of $1 number.","Activation code should consist of $1 numbers.",[6]),step:3,field:"activationCode"};case 9010:return{error:(0,le.Z)("Connection error"),step:1,field:"username"};case 9020:return{error:(0,le.Z)("Please fill in the username"),step:1,field:"username"};case 9021:return{error:(0,le.Z)("Please provide your age"),step:2,field:"age"};case 9022:return{error:(0,le.Z)("Please provide your email"),step:1,field:"email"};case 9023:return{error:(0,le.Z)("Please fill in the email confirmation"),step:1,field:"confirmEmail"};case 9024:return{error:(0,le.Z)("Please provide your password"),step:3,field:"password"};case 9025:return{error:(0,le.Z)("Please fill in the password confirmation"),step:2,field:"confirmPassword"};default:return{error:(0,le.Z)("Unknown error"),step:1,field:"username"}}};onRegister=e=>{const t=e.currentTarget;t.password.checkValidity()&&t.confirmPassword.checkValidity()&&t.agreed.checkValidity()&&(this.setState({fetching:!0}),cH("https://login.vivaldi.net/profile/sync-registration",{username:this.state.username,emailaddress:this.state.email,password:this.state.password,age:this.state.age,lang:aH,disableNonce:!0,newsletter:this.state.agreedToNewsletter}).then((e=>{this.parseResponse(e)})).catch((e=>{console.warn("Registration request failed:",e.statusText),this.setState({fetching:!1,error:this.getError(9010).error})})))};onCheckUserCredentials=e=>{const t=e.currentTarget;t.username.checkValidity()&&t.age.checkValidity()&&t.email.checkValidity()&&t.confirmEmail.checkValidity()&&(this.setState({fetching:!0}),this.validateServerData("username").then((()=>this.validateServerData("email"))).then((()=>{this.goToStep(2),this.setState({fetching:!1})})).catch((e=>{console.warn("Account credentials validation failed",e.statusText),this.setState({fetching:!1})})))};parseResponse=e=>{if(e.error){const t=e.error,n=function(e){const t=e.match(/\[(\d+)\]/);return t?parseInt(t[1]):0}(t),{error:i,step:s,field:o}=this.getError(n);this.setState((o=>{let{activationCount:a}=o;return 0===n?{error:t,step:o.step,activationCount:a,fetching:!1}:(a=4001===n?e.attempts_remaining:0,{error:i,step:s,activationCount:a})})),nH.nextTick((()=>this.reportValidity(o,i)))}else e.success?.includes("Registration")?(this.goToStep(3),d.Z.vivaldiAccount.setPendingRegistration({username:this.state.username,recovery_email:this.state.email,password:this.state.savePassword?this.state.password:""})):e.success?.includes("Code has been sent")?this.setState({activationCount:-1}):e.success?.includes("verified")&&(this.resetActivation(),this.state.username&&this.state.password?BW.login(this.state.username,this.state.password,this.state.savePassword):(this.goToStep(1),this.props.onChangeDisplay()))};validateServerData=e=>cH("https://login.vivaldi.net/profile/validateField",{field:e,value:this.state[e]}).then((e=>{this.parseResponse(e)})).catch((t=>(console.warn("Field validation failed",t.statusText,e),this.setState({fetching:!1,error:this.getError(9010).error}),Promise.reject())));debouncedValidate=(0,Zr.Z)((e=>this.validateServerData(e).catch((()=>{}))),500);reportValidity=(e,t)=>{let n=null;switch(e){case"age":n=this._refAgeField.current;break;case"username":n=this._refUsernameField.current;break;case"email":n=this._refEmailField.current;break;case"confirmEmail":n=this._refConfirmEmailField.current;break;case"password":n=this._refPasswordField.current?._refInput.current;break;case"confirmPassword":n=this._refConfirmPasswordField.current;break;case"activationCode":n=this._refVerifyAccountField.current}n&&(n.setCustomValidity(t),n.focus())};onUsernameChange=e=>{this.resetValidity(e);const t=e.target.value.trim();t.match(sH)&&this.debouncedValidate("username"),this.setState({username:t})};onAgeChange=e=>{this.resetValidity(e),this.setState({age:parseInt(e.target.value)})};onEmailChange=e=>{this.resetValidity(e),this._refConfirmEmailField.current?.setCustomValidity("");const t=e.target.value;this.setState({email:t}),t.match(oH)&&this.debouncedValidate("email")};onPasswordChange=e=>{this.resetValidity(e),this._refConfirmPasswordField?.current?.setCustomValidity(""),this.setState({password:e.target.value})};onSavePasswordChange=({target:e})=>{this.setState({savePassword:e.checked})};agreeToTerms=e=>{this.resetValidity(e),this.setState({agreedToTerms:e.target.checked})};agreeToNewsletter=({target:e})=>{this.setState({agreedToNewsletter:e.checked})};onActivationCodeChange=e=>{const{value:t}=e.target;this.resetValidity(e),this.setState({activationCode:t.trim().substring(0,6)})};verifyAccount=()=>{let{activationCode:e,username:t}=this.state;if(e=e.trim(),6!==e.length||null!==e.match(/[^\d]/)){const{error:e,field:t}=this.getError(9004);return this.reportValidity(t,e),void this.setState({fetching:!1,error:this.getError(9004).error,activationCount:0})}cH("https://login.vivaldi.net/profile/activation-code",{username:t,activation_code:e,lang:aH}).then((e=>{this.parseResponse(e)})).catch((e=>{console.warn("Code verification failed",e.statusText),this.setState({fetching:!1,error:this.getError(9010).error})}))};sendVerificationCode=()=>{this.setState({error:"",activationCode:""}),cH("https://login.vivaldi.net/profile/resend-activation-code",{username:this.state.username,lang:aH}).then((e=>{this.parseResponse(e)})).catch((e=>{console.warn("Verification code request failed",e.statusText),this.setState({fetching:!1,error:this.getError(9010).error})}))};goToStep=e=>this.setState({step:e,error:"",activationCount:0});openNewsletterPage=()=>{Y.Z.openURL(this.context.vivaldiWindowId,"https://vivaldi.com/newsletter/",{inCurrent:!1})};openPrivacyPage=()=>{Y.Z.openURL(this.context.vivaldiWindowId,"https://vivaldi.com/privacy/",{inCurrent:!1})};setValidity=e=>{const{name:t,validity:n}=e.target;let i="";switch(!0){case n.rangeUnderflow&&"age"===t:i=this.getError(1003).error;break;case n.rangeOverflow&&"age"===t:i=this.getError(1010).error;break;case n.stepMismatch:case n.rangeUnderflow:case n.rangeOverflow:case n.typeMismatch:case n.patternMismatch:case n.badInput:case n.tooLong:case n.tooShort:"username"===t&&(i=this.getError(1001).error),"password"===t&&(i=this.getError(1006).error),"email"===t&&(i=this.getError(1002).error),"confirmEmail"===t&&(i=this.getError(9001).error),"confirmPassword"===t&&(i=this.getError(9002).error);break;case n.valueMissing:i=this.getError(9e3).error,"agreed"===t&&(i=this.getError(9003).error),"username"===t&&(i=this.getError(9020).error),"age"===t&&(i=this.getError(9021).error),"email"===t&&(i=this.getError(9022).error),"confirmEmail"===t&&(i=this.getError(9023).error),"password"===t&&(i=this.getError(9024).error),"confirmPassword"===t&&(i=this.getError(9025).error);break;case n.customError:i=e.target.validationMessage;case n.valid:}e.target.setCustomValidity(i),e.target.focus(),e.preventDefault(),this.setState({error:i})};resetValidity=e=>{e.target.setCustomValidity(""),this.setState({error:""})};resetActivation=()=>{d.Z.vivaldiAccount.setPendingRegistration()};renderUserDetails=()=>iH("form",{onSubmit:this.onCheckUserCredentials,noValidate:!0},void 0,iH("h1",{},void 0,(0,le.Z)("Create an Account")),iH("p",{},void 0,(0,le.Z)("To start syncing data across devices, a confirmed Vivaldi account is required. Already have an account?")," ",iH(Uw,{onClick:this.props.onChangeDisplay},void 0,(0,le.Z)("Log in."))),iH("div",{className:"AccountSheet-Form AccountSheet-FormGrid"},void 0,iH("label",{},void 0,iH(YA,{label:(0,le.Z)("Username is used for email, blog link and forum display name. It can only contain letters and numbers, and cannot be changed.")},void 0,(0,le.Z)("Username")),(0,fn.jsx)("input",{ref:this._refUsernameField,type:"text",name:"username",value:this.state.username,onChange:this.onUsernameChange,onInvalid:this.setValidity,required:!0,pattern:sH,autoFocus:this.props.autoFocus})),iH("label",{},void 0,iH(YA,{label:(0,le.Z)("We need this information to prove to authorities that you are older than 16 to comply with the European General Data Protection Regulation (GDPR).")},void 0,(0,le.Z)("Age")),(0,fn.jsx)("input",{ref:this._refAgeField,type:"number",name:"age",value:this.state.age>=0?this.state.age:"",onChange:this.onAgeChange,onInvalid:this.setValidity,required:!0,min:"16",max:"150"})),iH("label",{},void 0,iH(YA,{label:(0,le.Z)("We’ll use this email address to send you account-related messages (activation, password reset) and technical updates.")},void 0,(0,le.Z)("Recovery Email")),(0,fn.jsx)("input",{ref:this._refEmailField,type:"email",name:"email",placeholder:"name@provider.com",value:this.state.email,onChange:this.onEmailChange,onInvalid:this.setValidity,pattern:oH,required:!0})),iH("label",{},void 0,(0,le.Z)("Confirm Recovery Email"),(0,fn.jsx)("input",{ref:this._refConfirmEmailField,type:"email",name:"confirmEmail",defaultValue:"",onChange:this.resetValidity,onInvalid:this.setValidity,pattern:(0,qv.Z)(this.state.email),required:!0}))),this.state.error&&iH(Tr,{type:"error"},void 0,this.state.error),iH("div",{className:"AccountSheet-Footer"},void 0,!this.state.fetching&&iH("input",{type:"submit",value:(0,le.Z)("Next")}),this.state.fetching&&iH("span",{className:"FormButton primary in-progress"},void 0,(0,le.Z)("Checking..."))));renderPasswordDetails=()=>iH("form",{onSubmit:this.onRegister,noValidate:!0},void 0,iH("h1",{},void 0,(0,le.Z)("Create an Account")),iH(HW,{windowId:this.context.vivaldiWindowId,pictureUrl:"",username:this.state.username,deviceName:this.state.email}),iH("div",{className:"AccountSheet-Form AccountSheet-FormGrid"},void 0,iH("label",{},void 0,iH(YA,{label:(0,le.Z)("Use 12 or more characters. We recommend using several words separated by spaces.")},void 0,(0,le.Z)("Password")),(0,fn.jsx)(jW,{ref:this._refPasswordField,name:"password",value:this.state.password,onChange:this.onPasswordChange,onInvalid:this.setValidity,minLength:"12",required:!0,autoFocus:this.props.autoFocus})),iH("label",{},void 0,(0,le.Z)("Confirm Password"),(0,fn.jsx)("input",{type:"password",ref:this._refConfirmPasswordField,name:"confirmPassword",defaultValue:"",onChange:this.resetValidity,onInvalid:this.setValidity,pattern:(0,qv.Z)(this.state.password),required:!0})),iH("label",{className:"columnRow"},void 0,iH("input",{type:"checkbox",checked:this.state.savePassword,onChange:this.onSavePasswordChange}),(0,le.Z)("Save Password")),iH("label",{className:"fullRow"},void 0,(0,le.Z)("Device Name"),iH("input",{type:"text",className:"device",defaultValue:this.props.customSessionName,placeholder:this.props.defaultSessionName,onChange:rH(D.kSyncSessionName)})),iH("span",{className:"fullRow columnRow link"},void 0,iH("label",{},void 0,iH("input",{type:"checkbox",checked:this.state.agreedToNewsletter,onChange:this.agreeToNewsletter}),(0,le.Z)("I want to receive the Vivaldi newsletter.")),iH(Uw,{title:(0,le.Z)("Learn more about Vivaldi Newsletter"),onClick:this.openNewsletterPage},void 0,iH("span",{dangerouslySetInnerHTML:{__html:cn.vvh.small}}))),iH("span",{className:"fullRow columnRow link"},void 0,iH("label",{},void 0,iH("input",{type:"checkbox",name:"agreed",required:!0,checked:this.state.agreedToTerms,onInvalid:this.setValidity,onChange:this.agreeToTerms}),(0,le.Z)("I have read and agree to the Terms of Use and Privacy Policy.")),iH(Uw,{title:(0,le.Z)("Visit Vivaldi Privacy page"),onClick:this.openPrivacyPage},void 0,iH("span",{dangerouslySetInnerHTML:{__html:cn.vvh.small}})))),this.state.error&&iH(Tr,{type:"error"},void 0,this.state.error),iH("div",{className:"AccountSheet-Footer AccountSheet-Footer--Justified"},void 0,iH("input",{type:"button",value:(0,le.Z)("navigation","Back"),onClick:()=>{dH(),this.goToStep(1)}}),!this.state.fetching&&iH("input",{type:"submit",value:(0,le.Z)("Register")}),this.state.fetching&&iH("span",{className:"FormButton primary in-progress"},void 0,(0,le.Z)("Registering..."))));renderAccountVerification=()=>iH("form",{onSubmit:this.verifyAccount,noValidate:!0},void 0,iH("h1",{},void 0,(0,le.Z)("Activate Your Account")),iH(HW,{windowId:this.context.vivaldiWindowId,pictureUrl:"",username:this.state.username,deviceName:this.state.email}),iH("div",{className:"AccountSheet-Form"},void 0,iH("p",{},void 0,this.state.email?(0,le.Z)("Activation code has been sent to “$1”.",[this.state.email]):(0,le.Z)("Activation code has been sent to your email.")," ",(0,le.Z)("Please enter the 6 digit code.")),(0,fn.jsx)("input",{ref:this._refVerifyAccountField,type:"text",onChange:this.onActivationCodeChange,value:this.state.activationCode,name:"activationCode",className:"AccountSheet-Verification",size:6,placeholder:"000000",autoFocus:!0}),iH("p",{},void 0,(0,le.Z)("Don’t see the email? Please check your spam folder.")," ",-1!==this.state.activationCount&&iH(Uw,{onClick:this.sendVerificationCode},void 0,(0,le.Z)("Or get another activation code.")))),this.state.error&&iH(Tr,{type:"error"},void 0,this.state.error," ",this.state.error===this.getError(4001).error&&this.state.activationCount>0&&this.state.activationCount<3&&(0,le.Z)("$1 attempt remaining.","$1 attempts remaining.",[this.state.activationCount]),this.state.error===this.getError(4001).error&&0===this.state.activationCount&&(0,le.Z)("Please request a new activation code.")),!this.state.error&&-1===this.state.activationCount&&iH(Tr,{type:"info"},void 0,(0,le.Z)("New activation code was sent.")),iH("div",{className:"AccountSheet-Footer AccountSheet-Footer--Justified"},void 0,iH("input",{type:"button",value:(0,le.Z)("Cancel"),onClick:()=>{this.resetActivation(),this.props.onChangeDisplay()}}),iH("input",{type:"submit",value:(0,le.Z)("Activate Account")})));render(){const{step:e}=this.state;return(0,fn.jsxs)(fn.Fragment,{children:[1===e&&this.renderUserDetails(),2===e&&this.renderPasswordDetails(),3===e&&this.renderAccountVerification()]})}}const pH=hH;var uH;function gH(e,t,n,i){uH||(uH="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:uH,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const mH=[D.kSyncSessionName];class vH extends tn.PureComponent{#n=!1;constructor(e){super(e);const t=Td.getState();this.state={display:"register"===this.props.view?"register":"login",accountState:t,defaultSessionName:"",unverified:!1}}componentDidMount(){this.#n=!0,Td.addListener(this.onVivaldiAccountChange),this.onVivaldiAccountChange(),this.setDefaultSession()}setDefaultSession=async()=>{if(!this.#n)return;const e=await(async()=>d.Z.sync.getDefaultSessionName())();this.setState({defaultSessionName:e})};componentWillUnmount(){this.#n=!1,Td.removeListener(this.onVivaldiAccountChange)}onVivaldiAccountChange=()=>{const e=Td.getState();this.setState({accountState:e}),e.lastTokenFetchError.serverMessage.includes(qW)&&"loginFailed"===Cd(e)?this.setState({display:"register",unverified:!0}):d.Z.vivaldiAccount.getPendingRegistration((e=>{e&&this.setState({display:"register",unverified:!0})}))};onChangeDisplay=()=>{this.setState((e=>({display:"login"===e.display?"register":"login",unverified:!1})))};render(){const{display:e}=this.state;return gH("div",{className:"AccountSheet"},void 0,gH("span",{className:"AccountSheet-Logo",dangerouslySetInnerHTML:{__html:n(38151)}}),"register"===e&&gH(pH,{autoFocus:this.props.autoFocus,onClose:this.props.onClose,onChangeDisplay:this.onChangeDisplay,defaultSessionName:this.state.defaultSessionName,customSessionName:this.props.prefValues[D.kSyncSessionName],accountState:this.state.accountState,unverified:this.state.unverified}),"login"===e&&gH(eH,{autoFocus:this.props.autoFocus,onClose:this.props.onClose,onChangeDisplay:this.onChangeDisplay,defaultSessionName:this.state.defaultSessionName,accountState:this.state.accountState,customSessionName:this.props.prefValues[D.kSyncSessionName]}))}}const fH=(0,fs.Z)(vH,mH);function yH(e){l.Z.dispatch({actionType:"SYNC_ENGINE_STATE_CHANGED",engineData:e})}function wH(e){l.Z.dispatch({actionType:"SYNC_CYCLE_COMPLETED",cycleData:e})}const bH=new class{start(){d.Z.sync.start()}stop(){d.Z.sync.stop()}clearData(){d.Z.sync.clearData()}setEncryptionPassword(e,t){d.Z.sync.setEncryptionPassword(e,(e=>t(e)))}async loadPromise(){const e=z.ZP.getId();if(e!==z.Ex&&z.ZP.isIncognitoOrGuest(e))return;const t=new Promise((e=>d.Z.sync.getEngineState((t=>{yH(t),d.Z.sync.onEngineStateChanged.addListener((e=>yH(e))),e()})))),n=new Promise((e=>d.Z.sync.getLastCycleState((t=>{wH(t),d.Z.sync.onCycleCompleted.addListener((e=>wH(e))),e()}))));await Promise.all([t,n])}};var CH;function SH(e,t,n,i){CH||(CH="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:CH,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const TH={bookmarks:{label:(0,le.Z)("Bookmarks"),description:(0,le.Z)("Sync bookmarks and Speed Dials"),icon:cn.CLf.small},preferences:{label:(0,le.Z)("Settings"),description:(0,le.Z)("Sync Vivaldi settings (not all settings are yet syncable)"),icon:cn.bqs.small},passwords:{label:(0,le.Z)("Passwords"),description:(0,le.Z)("Sync stored webpage passwords"),icon:cn._ZF},autofill:{label:(0,le.Z)("Autofill"),description:(0,le.Z)("Sync form autofill information"),icon:cn.lku},typed_urls:{label:(0,le.Z)("History"),description:(0,le.Z)("Sync typed URLs and open tabs"),icon:cn.hcy.small},extensions:{label:(0,le.Z)("Extensions"),description:(0,le.Z)("Sync browser extensions and settings"),icon:cn.v9y.small},notes:{label:(0,le.Z)("Notes"),description:(0,le.Z)("Sync Vivaldi Notes (attachments are not syncable)"),icon:cn.fbI},reading_list:{label:(0,le.Z)("Reading List"),description:(0,le.Z)("Sync the Reading List"),icon:cn.R_e.small}};class IH extends tn.Component{static contextType=dn.Z;syncAllId="syncAll__"+Qr()();syncPartsId="syncParts__"+Qr()();constructor(e){super(e),this.state={countdownElapsed:!1,showConfirmClearDataDialog:!1,showChangeFeedback:!1,dataTypes:e.syncState.engineData.dataTypes}}componentWillUnmount(){clearTimeout(this.changeTimeout)}onCountDownElapsed=e=>{this.setState({countdownElapsed:e})};onSyncEverythingChange=()=>{this.setChangeFeedback(),d.Z.sync.setTypes(!0,this.props.syncState.engineData.dataTypes),d.Z.sync.setupComplete(),this.setState((e=>({dataTypes:e.dataTypes.map((e=>(e.enabled=!0,e)))})))};onDataTypeChange=e=>{const t=e.target.name,n=e.target.checked;this.setState((e=>{const i=e.dataTypes,s=i.find((e=>e.dataType===t));return s&&(s.enabled=n),{dataTypes:i}})),d.Z.sync.setTypes(this.props.syncState.engineData.syncEverything,this.props.syncState.engineData.dataTypes)};setChangeFeedback=()=>{clearTimeout(this.changeTimeout),this.setState({showChangeFeedback:!0},(()=>this.changeTimeout=setTimeout(this.resetChangeFeedback,1e3)))};resetChangeFeedback=()=>{this.setState({showChangeFeedback:!1})};onApplyChanges=()=>{this.setChangeFeedback(),d.Z.sync.setTypes(!1,this.state.dataTypes),d.Z.sync.setupComplete()};onClearData=()=>{this.setState({showConfirmClearDataDialog:!0})};onConfirmClearDataDialog=e=>{this.setState({showConfirmClearDataDialog:!1}),e&&bH.clearData()};onSaveBackupKey=()=>{d.Z.utilities.selectFile({windowId:this.context.vivaldiWindowId,title:(0,le.Z)("Save Backup Encryption Key"),type:"save_file",accepts:[{ext:"txt"}]}).then((e=>{e&&d.Z.sync.backupEncryptionToken(e,(e=>{e||console.warn("File not saved (vivaldi.sync)")}))}))};renderResetButton=()=>"configuration_pending"===this.props.syncState.engineData.engineState?null:SH("input",{type:"button",onClick:this.onClearData,value:(0,le.Z)("Reset Remote Data")});render(){const{cycleData:e,engineData:t}=this.props.syncState,n="not_synced"!==this.props.syncState.cycleData.downloadUpdatesStatus?b()(this.props.syncState.cycleData.cycleStartTime).calendar():"...",i=this.state.dataTypes.map((e=>SH("li",{},e.dataType,SH("label",{className:"grid"},void 0,SH("span",{className:"icon",dangerouslySetInnerHTML:{__html:TH[e.dataType].icon}}),SH("h3",{},void 0,TH[e.dataType].label),SH("span",{className:"description"},void 0,TH[e.dataType].description),SH("input",{type:"checkbox",name:e.dataType,checked:e.enabled,onChange:this.onDataTypeChange}))))),[s,o]=this.state.showChangeFeedback?[Ny(e)[0],(0,le.Z)("Updating")]:Ny(e),a=this.state.showChangeFeedback?"in_progress":e.commitStatus;let r=null;if(0!==parseInt(e.nextRetryTime)){const t=b()(e.nextRetryTime);r=t.isBefore(b()())?SH("p",{className:"in-progress"},void 0,(0,le.Z)("Retrying")):SH(OW,{label:"Retrying in $1",end:t,onElapsed:this.onCountDownElapsed})}const l=t.syncEverything?this.syncAllId:this.syncPartsId,d="configuration_pending"===t.engineState;return SH(jE.Z,{filter:this.props.filter},void 0,SH("div",{className:"setting-group-double"},void 0,!d&&SH("div",{className:"sync-status detail"},void 0,SH("span",{className:"time"},void 0,(0,le.Z)("Last sync:")," ",SH("strong",{},void 0,n)),SH("span",{className:`data-in ${e.downloadUpdatesStatus}`},void 0,SH("span",{className:"icon",dangerouslySetInnerHTML:{__html:cn.OXd}}),(0,le.Z)("Download: $1",[s])),SH("span",{className:`data-out ${a}`},void 0,SH("span",{className:"icon",dangerouslySetInnerHTML:{__html:cn.uUH}}),(0,le.Z)("Upload: $1",[o]))),r&&SH(Tr,{type:"info"},void 0,r),t.isEncryptingEverything&&(0,fn.jsxs)(fn.Fragment,{children:[SH("div",{className:"status"},void 0,SH("span",{className:"icon",dangerouslySetInnerHTML:{__html:cn._ZF}}),(0,le.Z)("Data secured by encryption password.")),SH("div",{className:"status"},void 0,SH("label",{},void 0,SH("span",{className:"icon",dangerouslySetInnerHTML:{__html:cn.SpM}}),SH(YA,{label:(0,le.Z)("Store the backup recovery key in a secure place. If you forget your encryption password, you may use this key to retrieve your sync data. We won’t be able to recover your data since your password and backup key are never sent to us.")},void 0,SH(Uw,{onClick:this.onSaveBackupKey},void 0,(0,le.Z)("Save Backup Encryption Key")))))]}),!t.isEncryptingEverything&&SH(Tr,{type:"error"},void 0,(0,le.Z)("Sync encryption failed. We recommend that you clear remote Sync data and restart Sync with your current browser data.")),this.state.showConfirmClearDataDialog&&SH(wk,{title:(0,le.Z)("Delete Remote Sync Data"),prompt:[(0,le.Z)("This will remove all sync data stored on the Vivaldi server, reset your encryption password, and log you out.")],positive:(0,le.Z)("Delete Sync Data"),negative:(0,le.Z)("Cancel"),onClose:this.onConfirmClearDataDialog,danger:!0})),d&&SH("div",{className:"sync-status-confirmed"},void 0,SH("h3",{},void 0,(0,le.Z)("All set! Time to decide what data to sync between devices."))),SH("div",{className:"setting-group-double pad-top"},void 0,SH(aL,{activeTabId:l,icons:[cn.uWq,cn.o7J]},void 0,SH("div",{label:(0,le.Z)("Sync All Data"),id:this.syncAllId},void 0,SH("div",{className:"TabbedView--Padded"},void 0,SH("p",{},void 0,!d&&t.syncEverything&&(0,le.Z)("All data is synchronized, and synchronization of new data types is automatically enabled."),!d&&!t.syncEverything&&(0,le.Z)("Selected data subset is synchronized.")," ",(!t.isFirstSetupComplete||!t.syncEverything)&&(0,le.Z)("Sychronize all data, and automatically enable synchronization of new data types."))),SH("div",{className:"TabbedView-Footer"},void 0,this.renderResetButton(),SH("input",{type:"submit",value:t.isFirstSetupComplete?(0,le.Z)("Sync All Data"):(0,le.Z)("Start Syncing"),onClick:this.onSyncEverythingChange,disabled:t.syncEverything&&!d,autoFocus:t.isFirstSetupComplete&&this.props.autoFocus}))),SH("div",{label:(0,le.Z)("Sync Selected Data"),id:this.syncPartsId},void 0,SH("form",{onSubmit:this.onApplyChanges},void 0,SH("ul",{},void 0,i),SH("div",{className:"TabbedView-Footer"},void 0,this.renderResetButton(),SH("input",{type:"submit",disabled:!d&&(!t.isSetupInProgress&&t.isFirstSetupComplete||(0,Sm.default)(this.state.dataTypes,this.props.syncState.engineData.dataTypes)),value:t.isFirstSetupComplete?(0,le.Z)("Apply Changes"):(0,le.Z)("Start Syncing"),autoFocus:!t.isFirstSetupComplete&&this.props.autoFocus})))))))}}const kH=IH;var AH;function ZH(e,t,n,i){AH||(AH="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:AH,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class EH extends tn.Component{static contextType=dn.Z;ID1="fm1__"+Qr()();ID2="fm2__"+Qr()();state={encryptionPassword:"",wrongPasswordEntered:!1,wrongBackupKey:"key"===this.props.unlockAttempt,showConfirmClearDataDialog:!1};onEncryptionPasswordChange=e=>{this.setState({wrongPasswordEntered:!1,wrongBackupKey:!1,encryptionPassword:e.target.value})};onDecrypt=()=>{this.setState({wrongPasswordEntered:!1}),bH.setEncryptionPassword(this.state.encryptionPassword,(e=>{this.props.onUnlockAttempt("passphrase"),e||this.setState({wrongPasswordEntered:!0,wrongBackupKey:!1})}))};onPasswordLost=()=>{this.setState({showConfirmClearDataDialog:!0,wrongPasswordEntered:!1,wrongBackupKey:!1})};resetErrorState=()=>{this.setState({wrongPasswordEntered:!1,wrongBackupKey:!1})};onConfirmClearDataDialog=e=>{this.setState({showConfirmClearDataDialog:!1}),e&&bH.clearData()};onUploadEncyptionKey=()=>{d.Z.utilities.selectFile({windowId:this.context.vivaldiWindowId,title:(0,le.Z)("Select Backup Encryption Key file"),type:"file",accepts:[{ext:"txt"}]}).then((e=>{e&&d.Z.sync.restoreEncryptionToken(e).then((e=>{this.props.onUnlockAttempt("key"),e||this.setState({wrongPasswordEntered:!1,wrongBackupKey:!0})}))}))};renderForgotPassword=()=>ZH(Uw,{onClick:this.onPasswordLost},void 0,(0,le.Z)("Forgot Password?"));render(){return ZH(a_,{categoryTitle:(0,le.Z)("Encryption Password"),filter:this.props.filter},void 0,ZH(jE.Z,{filter:this.props.filter},void 0,ZH("div",{className:"setting-group-double"},void 0,this.state.showConfirmClearDataDialog&&ZH(wk,{title:(0,le.Z)("Delete Remote Sync Data"),prompt:[(0,le.Z)("Without your current encryption password we’re unable to decrypt your data. Resetting this password requires deleting all existing Sync data on Vivaldi servers.")],positive:(0,le.Z)("Delete Sync Data"),negative:(0,le.Z)("Cancel"),onClose:this.onConfirmClearDataDialog,danger:!0}),ZH(aL,{activeTabId:"key"===this.props.unlockAttempt?this.ID2:void 0,icons:[cn.WHX,cn.c02],onTabClick:this.resetErrorState},void 0,ZH("div",{label:(0,le.Z)("Encryption Password"),id:this.ID1},void 0,ZH("form",{onSubmit:this.onDecrypt},void 0,ZH("div",{className:"TabbedView--Padded"},void 0,ZH("p",{},void 0,(0,le.Z)("The data received from the Sync server is encrypted. Please provide your encryption password to decrypt it.")),ZH("label",{className:"setting-single encryption"},void 0,ZH("span",{},void 0,(0,le.Z)("Encryption Password")),ZH(jW,{value:this.state.encryptionPassword,onChange:this.onEncryptionPasswordChange,autoFocus:this.props.autoFocus})),this.state.wrongPasswordEntered&&ZH(Tr,{type:"error"},void 0,(0,le.Z)("Wrong password entered."))),ZH("div",{className:"TabbedView-Footer"},void 0,this.renderForgotPassword(),ZH("input",{type:"submit",value:(0,le.Z)("Decrypt")})))),ZH("div",{label:(0,le.Z)("Load Encryption Key"),id:this.ID2},void 0,ZH("div",{className:"TabbedView--Padded"},void 0,ZH("p",{},void 0,(0,le.Z)("To recover data without a password, you may use your Backup Encryption Key, provided you have saved it earlier.")),this.state.wrongBackupKey&&ZH(Tr,{type:"error"},void 0,(0,le.Z)("Unable to decrypt with given backup encryption key."))),ZH("div",{className:"TabbedView-Footer"},void 0,this.renderForgotPassword(),ZH("input",{type:"button",onClick:this.onUploadEncyptionKey,value:(0,le.Z)("Load")})))))))}}const _H=EH;var NH;function MH(e,t,n,i){NH||(NH="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:NH,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class PH extends tn.Component{static contextType=dn.Z;_input=tn.createRef();state={encryptionPassword:"",shortPassword:!1};onSetPassword=()=>{!this.state.encryptionPassword||this.state.encryptionPassword.length<12?(this.setState({shortPassword:!0}),this._input.current?._refInput.current?.focus()):this.doSetPassword(this.state.encryptionPassword)};doSetPassword=e=>{bH.setEncryptionPassword(e,(e=>{e&&this.setState({shortPassword:!1})}))};onEncryptionPasswordChange=e=>{this.setState({encryptionPassword:e.target.value}),e.target.value.length>=12&&this.setState({shortPassword:!1})};render(){return MH(jE.Z,{filter:this.props.filter},void 0,MH("h2",{},void 0,(0,le.Z)("Set a New Encryption Password")),MH("form",{onSubmit:this.onSetPassword},void 0,MH("div",{className:"setting-group-double"},void 0,MH("div",{className:"setting-single"},void 0,MH("p",{},void 0,(0,le.Z)("To encrypt and protect your sync data (passwords, bookmarks, notes, and more), please create an encryption password. This password will never be sent to us."))),MH("div",{className:"setting-single"},void 0,MH("label",{className:"encryption-password"},void 0,MH("span",{className:"icon",dangerouslySetInnerHTML:{__html:cn._ZF}}),(0,le.Z)("Encryption Password"),(0,fn.jsx)(jW,{ref:this._input,value:this.state.encryptionPassword,onChange:this.onEncryptionPasswordChange})),this.state.shortPassword&&MH(Tr,{type:"error"},void 0,(0,le.Z)("Minimum password length of $1 character is required.","Minimum password length of $1 characters is required.",[12]))),MH("div",{className:"setting-single align-right pad-top"},void 0,MH("input",{type:"submit",value:(0,le.Z)("Save and Continue"),autoFocus:this.props.autoFocus})))))}}const DH=PH;var xH,OH=n(34155);function LH(e,t,n,i){xH||(xH="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:xH,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const RH=[D.kSyncSessionName];class BH extends tn.Component{static contextType=dn.Z;constructor(e){super(e),this.state={syncState:Sy.getState(),accountState:Td.getState(),defaultSessionName:"",unlockAttempt:""}}componentDidMount(){Sy.addListener(this.onSyncStoreChange),Td.addListener(this.onVivaldiAccountChange),this.onSyncStoreChange(),this.onVivaldiAccountChange(),d.Z.sync.getDefaultSessionName((e=>this.setState({defaultSessionName:e})))}componentWillUnmount(){Sy.removeListener(this.onSyncStoreChange),Td.removeListener(this.onVivaldiAccountChange)}onSyncStoreChange=()=>{this.setState({syncState:Sy.getState()})};onVivaldiAccountChange=()=>{this.setState({accountState:Td.getState()})};onUnlockAttempt=e=>{this.setState({unlockAttempt:e})};restartSync=()=>{bH.stop(),OH.nextTick((()=>bH.start()))};startSync=()=>{bH.start()};stopSync=()=>{bH.stop()};getContent=()=>{const e=this.state.syncState.engineData;if(e.disableReasons.includes("enterprise_policy"))return LH("p",{},void 0,(0,le.Z)("Sync has been disabled by your administrator"));const t=e.engineState;if(!this.state.accountState.hasToken)return null;switch(t){case"stopped":return LH("div",{className:"setting-group-double"},void 0,"disable_sync_on_client"===e.protocolErrorClientAction&&LH("p",{},void 0,(0,le.Z)("Sync was stopped following a request from the server: $1",["not_my_birthday"===e.protocolErrorType?(0,le.Z)("Sync server data was reset"):e.protocolErrorDescription])),LH("input",{type:"button",onClick:this.startSync,value:(0,le.Z)("Start Sync")}));case"failed":if(e.disableReasons.includes("not_signed_in"))return LH("div",{className:"setting-group-double"},void 0,LH("p",{className:"in-progress"},void 0,(0,le.Z)("Waiting for account details")),LH("input",{type:"button",onClick:this.stopSync,value:(0,le.Z)("Cancel")}));if(e.disableReasons.includes("flag"))return LH("p",{},void 0,(0,le.Z)("Sync was disabled from the command line"));let t=(0,le.Z)("Unexpected error. You may need to restart Vivaldi.");if(e.disableReasons.includes("unrecoverable_error")){if("upgrade_client"===e.protocolErrorClientAction)return LH("p",{},void 0,(0,le.Z)("You must upgrade Vivaldi in order to use Sync"));t=(0,le.Z)("Sync must be restarted: $1",[e.protocolErrorDescription])}return LH("div",{className:"setting-group-double"},void 0,LH("p",{},void 0,t),LH("input",{type:"button",onClick:this.restartSync,value:(0,le.Z)("sync","Restart")}));case"starting":return LH("p",{className:"in-progress"},void 0,(0,le.Z)("Initializing Sync..."));case"starting_server_error":return LH("p",{className:"in-progress"},void 0,(0,le.Z)("The sync server is experiencing issues. Retrying initialization soon."));case"clearing_data":return LH("p",{className:"in-progress"},void 0,(0,le.Z)("Clearing Sync data. Please wait."));case"configuration_pending":case"started":return e.needsDecryptionPassword?LH(_H,{filter:this.props.filter,autoFocus:this.props.category!==St.jk.settingCategories.all,unlockAttempt:this.state.unlockAttempt,onUnlockAttempt:this.onUnlockAttempt}):e.usesEncryptionPassword?LH(kH,{filter:this.props.filter,syncState:this.state.syncState,autoFocus:this.props.category!==St.jk.settingCategories.all}):LH(DH,{filter:this.props.filter,autoFocus:this.props.category!==St.jk.settingCategories.all})}return null};render(){if(z.ZP.isIncognitoOrGuest(this.context.vivaldiWindowId))return LH("p",{},void 0,(0,le.Z)("Sync settings are unavailable in Private Windows."));if(!this.state.syncState.engineData.isReady||!this.state.syncState.cycleData.isReady||!this.state.accountState.isReady)return null;const e=this.getContent(),{username:t,pictureUrl:n}=this.state.accountState.accountInfo,i=this.props.prefValues[D.kSyncSessionName]||this.state.defaultSessionName,s=Cd(this.state.accountState);return LH(a_,{categoryTitle:(0,le.Z)("Sync"),filter:this.props.filter,className:"sync-setup"},void 0,LH(jE.Z,{filter:this.props.filter},void 0,LH("div",{className:"setting-group-double"},void 0,"loggedIn"!==s?LH(fH,{onClose:Tl.default,view:(o=this.props.url,"register"===(0,Ni.DP)(o).view?"register":"login"),autoFocus:this.props.category!==St.jk.settingCategories.all},this.props.url):LH(HW,{windowId:this.context.vivaldiWindowId,pictureUrl:n,username:t,deviceName:i,isLoggedIn:!0}))),e&&LH(jE.Z,{filter:this.props.filter},void 0,e));var o}}const FH=(0,fs.Z)(BH,RH);var UH;function VH(e,t,n,i){UH||(UH="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:UH,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const WH=nt.Z.getEventHandler,HH=[D.kTabsActivationOnClose,D.kTabsActivationPreferRelated,D.kTabsAlignNext,D.kTabsDoubleClickClose,D.kTabsFocusWebview,D.kTabsBarPosition,D.kTabsNeverCloseLast,D.kTabsConfirmClosingTabs,D.kTabsConfirmClosingThreshold];var zH=VH("input",{type:"radio",value:"activation_order"}),GH=VH("input",{type:"radio",value:"left"}),$H=VH("input",{type:"radio",value:"right"});class KH extends tn.Component{confirmClosingTabsMinThreshold=1;confirmClosingTabsMaxThreshold=99;isHorizontal=()=>{const e=this.props.prefValues[D.kTabsBarPosition];return"top"===e||"bottom"===e};render(){const{prefValues:e}=this.props;return VH(jE.Z,{filter:this.props.filter},void 0,VH("span",{},void 0,VH("div",{className:"setting-group"},void 0,VH("div",{className:"setting-single"},void 0,VH("h3",{},void 0,(0,le.Z)("Close Tab Activation")),VH("div",{className:"setting-single"},void 0,VH("label",{title:(0,le.Z)("Activate tabs related by origin first")},void 0,VH("input",{type:"checkbox",checked:e[D.kTabsActivationPreferRelated],onChange:WH(D.kTabsActivationPreferRelated)}),VH("span",{},void 0,(0,le.Z)("Always Activate Related Tab")))),VH("div",{className:"setting-single pad-top"},void 0,VH(ws,{name:"tabActivate",value:e[D.kTabsActivationOnClose],onChange:WH(D.kTabsActivationOnClose)},void 0,VH("div",{className:"setting-single"},void 0,VH("label",{},void 0,zH,VH("span",{},void 0,(0,le.Z)("Activate in Recently Used Order")))),VH("div",{className:"setting-single"},void 0,VH("label",{},void 0,GH,VH("span",{},void 0,this.isHorizontal()?(0,le.Z)("Activate Left in Tab Order"):(0,le.Z)("Activate Above in Tab Order")))),VH("div",{className:"setting-single"},void 0,VH("label",{},void 0,$H,VH("span",{},void 0,this.isHorizontal()?(0,le.Z)("Activate Right in Tab Order"):(0,le.Z)("Activate Below in Tab Order")))))))),VH("div",{className:"setting-group"},void 0,VH("h3",{},void 0,(0,le.Z)("Tab Handling")),VH("div",{className:"setting-single"},void 0,VH("label",{title:(0,le.Z)("Align the close buttons to easily close multiple tabs")},void 0,VH("input",{type:"checkbox",checked:e[D.kTabsAlignNext],onChange:WH(D.kTabsAlignNext)}),VH("span",{},void 0,(0,le.Z)("Align Next Close Button")))),VH("div",{className:"setting-single"},void 0,VH("label",{},void 0,VH("input",{type:"checkbox",checked:e[D.kTabsDoubleClickClose],onChange:WH(D.kTabsDoubleClickClose)}),VH("span",{},void 0,(0,le.Z)("Close Tab on Double Click")))),VH("div",{className:"setting-single"},void 0,VH("label",{title:(0,le.Z)("Prevents window closing along with last tab.")},void 0,VH("input",{type:"checkbox",checked:e[D.kTabsNeverCloseLast],onChange:WH(D.kTabsNeverCloseLast)}),VH("span",{},void 0,(0,le.Z)("Keep Window Open When Last Tab is Closed")))),VH("div",{className:"setting-single max-bookmarks"},void 0,VH("label",{},void 0,VH("input",{type:"checkbox",checked:this.props.prefValues[D.kTabsConfirmClosingTabs],onChange:WH(D.kTabsConfirmClosingTabs)}),VH("span",{},void 0,(0,le.Z)("Confirm Closing Tabs over Maximum of")),VH("input",{type:"number",size:"2",disabled:!this.props.prefValues[D.kTabsConfirmClosingTabs],value:this.props.prefValues[D.kTabsConfirmClosingThreshold],onChange:WH(D.kTabsConfirmClosingThreshold),min:this.confirmClosingTabsMinThreshold,max:this.confirmClosingTabsMaxThreshold}))),VH("div",{className:"setting-single"},void 0,VH("label",{title:(0,le.Z)("Focus page content instead of addressfield")},void 0,VH("input",{type:"checkbox",checked:e[D.kTabsFocusWebview],onChange:WH(D.kTabsFocusWebview)}),VH("span",{},void 0,(0,le.Z)("Focus Page Content on New Tab")))))))}}const jH=(0,fs.Z)(KH,HH);var YH;function XH(e,t,n,i){YH||(YH="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:YH,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const QH=nt.Z.getEventHandler,qH=[D.kMouseWheelTabSwitch,D.kTabsCycleByRecentOrder,D.kTabsMinimize,D.kTabsVisualSwitchEnable,D.kTabsVisualSwitchListLayout];var JH=XH("input",{type:"radio",value:"true"}),ez=XH("input",{type:"radio",value:"false"});class tz extends tn.Component{render(){const e=this.props.prefValues;return XH(jE.Z,{filter:this.props.filter},void 0,XH("div",{className:"setting-group"},void 0,XH("h3",{htmlFor:"tabSelection"},void 0,(0,le.Z)("Tab Cycling")),XH(ws,{name:"tabCyclingOrder",value:this.props.prefValues[D.kTabsCycleByRecentOrder],onChange:QH(D.kTabsCycleByRecentOrder,"convert")},void 0,XH("div",{className:"setting-single"},void 0,XH("label",{},void 0,JH,XH("span",{},void 0,(0,le.Z)("Cycle in Recently Used Order")))),XH("div",{className:"setting-single"},void 0,XH("label",{},void 0,ez,XH("span",{},void 0,(0,le.Z)("Cycle in Tab Order"))))),XH("div",{className:"setting-single pad-top"},void 0,XH("label",{},void 0,XH("input",{type:"checkbox",checked:this.props.prefValues[D.kTabsVisualSwitchEnable],onChange:QH(D.kTabsVisualSwitchEnable)}),XH("span",{},void 0,(0,le.Z)("Show Tab Cycler")))),XH("div",{className:"setting-single pad-left"},void 0,XH("label",{},void 0,XH("input",{type:"checkbox",checked:this.props.prefValues[D.kTabsVisualSwitchListLayout],disabled:!this.props.prefValues[D.kTabsVisualSwitchEnable],onChange:QH(D.kTabsVisualSwitchListLayout)}),XH("span",{},void 0,(0,le.Z)("Display Tab Cycler as List")))),XH("div",{className:"setting-single"},void 0,XH("label",{title:(0,le.Z)("Scroll over Tab Bar to switch tabs by order, or scroll anywhere else while holding Alt key to switch tabs per Tab Cycling setting.")},void 0,XH("input",{type:"checkbox",checked:e[D.kMouseWheelTabSwitch],onChange:QH(D.kMouseWheelTabSwitch)}),XH("span",{},void 0,(0,le.Z)("Switch Tabs by Scrolling")))),XH("div",{className:"setting-single"},void 0,XH("label",{},void 0,XH("input",{type:"checkbox",checked:this.props.prefValues[D.kTabsMinimize],onChange:QH(D.kTabsMinimize)}),XH("span",{},void 0,(0,le.Z)("Minimize Active Tab"))),XH("p",{className:"info"},void 0,(0,le.Z)("Click current tab to switch to last active tab.")))))}}const nz=(0,fs.Z)(tz,qH);var iz;function sz(e,t,n,i){iz||(iz="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:iz,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const oz=nt.Z.getEventHandler,az=[D.kTabsAutoMuting];var rz=sz("input",{type:"radio",value:"off"}),lz=sz("input",{type:"radio",value:"onlyActive"}),dz=sz("input",{type:"radio",value:"prioritizeActive"});class cz extends tn.Component{render(){return sz(jE.Z,{filter:this.props.filter},void 0,sz("div",{className:"setting-group"},void 0,sz("h3",{},void 0,(0,le.Z)("Mute Tab Audio")),sz(ws,{name:"mutableTabs",value:this.props.prefValues[D.kTabsAutoMuting],onChange:oz(D.kTabsAutoMuting)},void 0,sz("div",{className:"setting-single"},void 0,sz("label",{},void 0,rz,sz("span",{},void 0,(0,le.Z)("Play All Audio")))),sz("div",{className:"setting-single"},void 0,sz("label",{},void 0,lz,sz("span",{},void 0,(0,le.Z)("Play Only in Active Tab")))),sz("div",{className:"setting-single"},void 0,sz("label",{},void 0,dz,sz("span",{},void 0,(0,le.Z)("Prioritize Active Tab")))))))}}const hz=(0,fs.Z)(cz,az);var pz;function uz(e,t,n,i){pz||(pz="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:pz,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const gz=nt.Z.getEventHandler,mz=[D.kTabsActivationOnClone,D.kTabsNewPlacement,D.kTabsOpenNewInBackground];var vz=uz("input",{type:"radio",value:"rightofcurrent"}),fz=uz("input",{type:"radio",value:"directrightofcurrent"}),yz=uz("input",{type:"radio",value:"alwayslast"}),wz=uz("input",{type:"radio",value:"openintabstackwithrelated"}),bz=uz("input",{type:"radio",value:"rightofcurrent"}),Cz=uz("input",{type:"radio",value:"alwayslast"});class Sz extends tn.Component{render(){return uz(jE.Z,{filter:this.props.filter},void 0,uz("span",{},void 0,uz("div",{className:"setting-group"},void 0,uz("div",{className:"setting-single"},void 0,uz("h3",{},void 0,(0,le.Z)("New Tab Position")),uz(ws,{name:"tabOpen",value:this.props.prefValues[D.kTabsNewPlacement],onChange:gz(D.kTabsNewPlacement)},void 0,uz("div",{className:"setting-single"},void 0,uz("label",{},void 0,vz,uz("span",{},void 0,(0,le.Z)("After Related Tabs")))),uz("div",{className:"setting-single"},void 0,uz("label",{},void 0,fz,uz("span",{},void 0,(0,le.Z)("After Active Tab")))),uz("div",{className:"setting-single"},void 0,uz("label",{},void 0,yz,uz("span",{},void 0,(0,le.Z)("As Last Tab")))),uz("div",{className:"setting-single"},void 0,uz("label",{},void 0,wz,uz("span",{},void 0,(0,le.Z)("As Tab Stack with Related Tab"))))),uz("div",{className:"setting-single pad-top"},void 0,uz("label",{},void 0,uz("input",{type:"checkbox",checked:this.props.prefValues[D.kTabsOpenNewInBackground],onChange:gz(D.kTabsOpenNewInBackground)}),uz("span",{},void 0,(0,le.Z)("New Tab from Link Opens in Background")))))),uz("div",{className:"setting-group"},void 0,uz("div",{className:"setting-single"},void 0,uz("h3",{},void 0,(0,le.Z)("Cloned Tab Position")),uz(ws,{name:"tabClone",value:this.props.prefValues[D.kTabsActivationOnClone],onChange:gz(D.kTabsActivationOnClone)},void 0,uz("div",{className:"setting-single"},void 0,uz("label",{},void 0,bz,uz("span",{},void 0,(0,le.Z)("Next to Original Tab")))),uz("div",{className:"setting-single"},void 0,uz("label",{},void 0,Cz,uz("span",{},void 0,(0,le.Z)("As Last Tab")))))))))}}const Tz=(0,fs.Z)(Sz,mz);var Iz;function kz(e,t,n,i){Iz||(Iz="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Iz,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Az=nt.Z.getEventHandler,Zz=[D.kMouseWheelTabSwitch,D.kTabsActiveMinSize,D.kTabsAtEdge,D.kTabsCloseButtonLeft,D.kTabsCloseButtonPermanent,D.kTabsCounterDetection,D.kTabsDimHibernated,D.kTabsHorizontalScrolling,D.kTabsPageLoadInfo,D.kTabsBarPosition,D.kTabsShowCloseButton,D.kTabsShowSyncedTabsButton,D.kTabsShowTrashCan,D.kTabsStackingMode,D.kTabsThumbnails,D.kTabsTooltip,D.kTabsUnread];var Ez=kz("input",{type:"radio",value:"progress_bar"}),_z=kz("input",{type:"radio",value:"progress_icon"}),Nz=kz("input",{type:"radio",value:"spinner"}),Mz=kz("input",{type:"radio",value:"none"});class Pz extends tn.Component{render(){const{prefValues:e}=this.props,{hasToken:t,isReady:i}=Td.getState();return kz(jE.Z,{filter:this.props.filter},void 0,kz("div",{className:"setting-group"},void 0,kz("h3",{},void 0,(0,le.Z)("tbd","Tab Bar")),kz("div",{className:"setting-single"},void 0,kz("label",{},void 0,kz("input",{type:"checkbox",checked:e[D.kTabsHorizontalScrolling],onChange:Az(D.kTabsHorizontalScrolling)}),kz("span",{},void 0,(0,le.Z)("Enable Horizontal Scrolling"))),kz("p",{className:"info"},void 0,(0,le.Z)("Hold Shift key when “Switch Tabs by Scrolling” setting is enabled."))),kz("div",{className:"setting-single"},void 0,kz("label",{},void 0,kz("input",{type:"checkbox",checked:e[D.kTabsAtEdge],onChange:Az(D.kTabsAtEdge)}),kz("span",{},void 0,(0,le.Z)("Remove Tab Spacing in Maximized Windows")))),kz("div",{className:"setting-single"},void 0,kz("label",{},void 0,kz("input",{type:"checkbox",checked:e[D.kTabsShowTrashCan],onChange:Az(D.kTabsShowTrashCan)}),kz("span",{},void 0,(0,le.Z)("Display Trash Can")))),kz("div",{className:"setting-single"},void 0,kz("label",{},void 0,kz("input",{type:"checkbox",checked:e[D.kTabsShowSyncedTabsButton],onChange:Az(D.kTabsShowSyncedTabsButton),disabled:!t&&!i}),kz("span",{},void 0,(0,le.Z)("Display Synced Tabs Button"))),!t&&!i&&kz("p",{className:"info"},void 0,(0,le.Z)("This setting requires active Sync")))),kz("div",{className:"setting-group"},void 0,kz("div",{className:"setting-single"},void 0,kz("h3",{},void 0,(0,le.Z)("Tab Options")),kz("div",{className:"setting-single"},void 0,kz("label",{},void 0,kz("input",{type:"checkbox",checked:e[D.kTabsTooltip],onChange:Az(D.kTabsTooltip)}),kz("span",{},void 0,(0,le.Z)("Show Popup Thumbnails")))),kz("div",{className:"setting-single"},void 0,kz("label",{},void 0,kz("input",{type:"checkbox",checked:e[D.kTabsThumbnails],onChange:Az(D.kTabsThumbnails)}),kz("span",{},void 0,(0,le.Z)("Show Tab Thumbnails")))),kz("div",{className:"setting-single"},void 0,kz("label",{},void 0,kz("input",{type:"checkbox",checked:e[D.kTabsShowCloseButton],onChange:Az(D.kTabsShowCloseButton)}),kz("span",{},void 0,(0,le.Z)("Display Close Button")))),kz("div",{className:"setting-single pad-left"},void 0,kz("label",{title:(0,le.Z)("Display Close button on left side of a tab")},void 0,kz("input",{type:"checkbox",disabled:!e[D.kTabsShowCloseButton],checked:e[D.kTabsCloseButtonLeft],onChange:Az(D.kTabsCloseButtonLeft)}),kz("span",{},void 0,(0,le.Z)("On Left Side")))),kz("div",{className:"setting-single pad-left"},void 0,kz("label",{title:(0,le.Z)("Permanently display Close button")},void 0,kz("input",{type:"checkbox",disabled:!e[D.kTabsShowCloseButton],checked:e[D.kTabsCloseButtonPermanent],onChange:Az(D.kTabsCloseButtonPermanent)}),kz("span",{},void 0,(0,le.Z)("Permanently")))),kz("div",{className:"setting-single"},void 0,kz("label",{title:(0,le.Z)("Detect and display numeric notification from page title in Tabs and Web Panels")},void 0,kz("input",{type:"checkbox",checked:e[D.kTabsCounterDetection],onChange:Az(D.kTabsCounterDetection)}),kz("span",{},void 0,(0,le.Z)("Detect Page Title Notifications")))),kz("div",{className:"setting-single"},void 0,kz("label",{title:(0,le.Z)("Display a triangle symbol for unread Tabs")},void 0,kz("input",{type:"checkbox",checked:e[D.kTabsUnread],onChange:Az(D.kTabsUnread)}),kz("span",{},void 0,(0,le.Z)("Use Unread Indicators"))),kz("div",{className:e[D.kTabsUnread]?"img-setting":"img-setting disabled"},void 0,kz("span",{className:"image",dangerouslySetInnerHTML:{__html:n(33271)}}))),kz("div",{className:"setting-single"},void 0,kz("label",{},void 0,kz("input",{type:"checkbox",checked:e[D.kTabsDimHibernated],onChange:Az(D.kTabsDimHibernated)}),kz("span",{},void 0,(0,le.Z)("Dim Icon when Hibernated")))))),kz("div",{className:"setting-group tab-min-width"},void 0,kz("h3",{},void 0,(0,le.Z)("Active Tab Minimum Width")),kz("div",{className:"setting-single"},void 0,kz(QB,{value:e[D.kTabsActiveMinSize],min:30,max:180,step:30,onChange:Az(D.kTabsActiveMinSize),label:(0,le.Z)("$1 pixel","$1 pixels",[parseInt(e[D.kTabsActiveMinSize])]),title:(0,le.Z)("Minimum width of horizontally scaled active tab")}))),kz("div",{className:"setting-group"},void 0,kz("h3",{},void 0,(0,le.Z)("Page Load Progress")),kz(ws,{name:"tabPageLoadInfo",value:this.props.prefValues[D.kTabsPageLoadInfo],onChange:Az(D.kTabsPageLoadInfo)},void 0,kz("div",{className:"setting-single"},void 0,kz("label",{title:(0,le.Z)("Display tab progress bar while page is loading")},void 0,Ez,kz("span",{},void 0,(0,le.Z)("Progress Bar")))),kz("div",{className:"setting-single"},void 0,kz("label",{title:(0,le.Z)("Display circular progress in place of favicon while page is loading")},void 0,_z,kz("span",{},void 0,(0,le.Z)("Favicon Progress")))),kz("div",{className:"setting-single"},void 0,kz("label",{title:(0,le.Z)("Display spinner in place of favicon while page is loading")},void 0,Nz,kz("span",{},void 0,(0,le.Z)("Favicon Spinner")))),kz("div",{className:"setting-single"},void 0,kz("label",{title:(0,le.Z)("Don’t display page loading progress")},void 0,Mz,kz("span",{},void 0,(0,le.Z)("radio","None")))))))}}const Dz=(0,fs.Z)(Pz,Zz);var xz;function Oz(e,t,n,i){xz||(xz="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:xz,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Lz=nt.Z.getEventHandler,Rz=[D.kExtensionURLOverrides,D.kTabsNewPageLink];class Bz extends tn.Component{state={customUrl:M.Z.get(D.kTabsNewPageCustomUrl)};_handleCustomUrlChange=({currentTarget:e})=>{const t=e.value;this.setState({customUrl:t}),this._saveCustomUrl(t)};_saveCustomUrl=e=>{const t=(0,Ni.q9)(e);nt.Z.set(D.kTabsNewPageCustomUrl,t),this.props.prefValues[D.kTabsNewPageLink]!==Q.Fp.CUSTOM&&nt.Z.set(D.kTabsNewPageLink,Q.Fp.CUSTOM)};focusCustomUrlInput=()=>{this._customPageRef&&this._customPageRef.focus()};render(){const e=this.props.prefValues,t=e[D.kExtensionURLOverrides].newtab?.some((e=>e.active)),n=e[D.kTabsNewPageLink]===Q.Fp.EXTENSION;return Oz(jE.Z,{filter:this.props.filter},void 0,Oz("div",{className:"setting-group new-tab-page"},void 0,Oz("h3",{},void 0,(0,le.Z)("title","New Tab Page")),Oz(ws,{name:"tabPageSettings",value:e[D.kTabsNewPageLink],onChange:Lz(D.kTabsNewPageLink)},void 0,Oz("div",{className:"setting-single"},void 0,Oz("label",{},void 0,Oz("input",{type:"radio",value:Q.Fp.STARTPAGE,checked:e[D.kTabsNewPageLink]===Q.Fp.STARTPAGE||e[D.kTabsNewPageLink]===Q.Fp.EXTENSION,onChange:Lz(D.kTabsNewPageLink)}),Oz("span",{},void 0,(0,le.Z)("noun","Start Page")))),Oz("div",{className:"setting-single pad-left"},void 0,Oz("label",{title:(0,le.Z)("Allow installed third-party extensions to control the Start Page")},void 0,Oz("input",{type:"checkbox",disabled:!t,checked:n,onChange:Lz(D.kTabsNewPageLink),value:n?Q.Fp.STARTPAGE:Q.Fp.EXTENSION}),Oz("span",{},void 0,(0,le.Z)("Controlled by Extension")))),Oz("div",{className:"setting-single"},void 0,Oz("label",{},void 0,Oz("input",{type:"radio",value:Q.Fp.HOMEPAGE}),Oz("span",{},void 0,(0,le.Z)("other","Homepage")))),Oz("div",{className:"setting-single"},void 0,Oz("label",{},void 0,Oz("input",{type:"radio",value:Q.Fp.BLANKPAGE}),Oz("span",{},void 0,(0,le.Z)("other","Blank Page")))),Oz("div",{className:"setting-single"},void 0,Oz("label",{},void 0,Oz("input",{type:"radio",className:"pad-top",onMouseUp:this.focusCustomUrlInput,value:Q.Fp.CUSTOM}),Oz("span",{},void 0,(0,fn.jsx)("input",{type:"text",ref:e=>this._customPageRef=e,placeholder:(0,le.Z)("Specific Page"),onChange:this._handleCustomUrlChange,value:this.state.customUrl,tabIndex:e[D.kTabsNewPageLink]===Q.Fp.CUSTOM?0:-1})))))))}}const Fz=(0,fs.Z)(Bz,Rz);var Uz;function Vz(e,t,n,i){Uz||(Uz="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Uz,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Wz=[D.kTabsClosePinned,D.kTabsShowSeparator],Hz=nt.Z.getEventHandler;var zz=Vz("input",{type:"radio",value:"off"}),Gz=Vz("input",{type:"radio",value:"bury"}),$z=Vz("input",{type:"radio",value:"on"});class Kz extends tn.Component{render(){return Vz(jE.Z,{filter:this.props.filter},void 0,Vz("div",{className:"setting-group"},void 0,Vz("h3",{},void 0,(0,le.Z)("Pinned Tabs")),Vz(ws,{name:"closablePinnedTabs",value:this.props.prefValues[D.kTabsClosePinned],onChange:Hz(D.kTabsClosePinned)},void 0,Vz("div",{className:"setting-single"},void 0,Vz("label",{},void 0,zz,Vz("span",{},void 0,(0,le.Z)("Don’t Close Pinned Tabs")))),Vz("div",{className:"setting-single"},void 0,Vz("label",{},void 0,Gz,Vz("span",{},void 0,(0,le.Z)("Minimize Instead of Close")))),Vz("div",{className:"setting-single"},void 0,Vz("label",{},void 0,$z,Vz("span",{},void 0,(0,le.Z)("Close as Other Tabs"))))),Vz("div",{className:"setting-single pad-top"},void 0,Vz("label",{},void 0,Vz("input",{type:"checkbox",checked:this.props.prefValues[D.kTabsShowSeparator],onChange:Hz(D.kTabsShowSeparator)}),Vz("span",{},void 0,(0,le.Z)("Show Separator Below Pinned Tabs"))))))}}const jz=(0,fs.Z)(Kz,Wz);var Yz;function Xz(e,t,n,i){Yz||(Yz="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Yz,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Qz={top:(0,le.Z)("Top"),right:(0,le.Z)("Right"),bottom:(0,le.Z)("Bottom"),left:(0,le.Z)("Left")};var qz=Xz("g",{},void 0,Xz("path",{className:"thumb-preview-colorBg",d:"M0 0h96v76H0z"}),Xz("path",{className:"thumb-preview-colorBgDark",d:"M0 0h96v12H0z"}),Xz("path",{className:"thumb-preview-non-active-tab",d:"M33 2h30v8H33zM64 2h30v8H64z"}),Xz("path",{className:"thumb-preview-colorAccentBg",d:"M2 2h30v8H2z"})),Jz=Xz("g",{},void 0,Xz("path",{className:"thumb-preview-colorBg",d:"M0 0h96v76H0z"}),Xz("path",{className:"thumb-preview-colorBgDark",d:"M62 0h34v76H62z"}),Xz("path",{className:"thumb-preview-non-active-tab",d:"M64 11h30v8H64zM64 20h30v8H64z"}),Xz("path",{className:"thumb-preview-colorAccentBg",d:"M64 2h30v8H64z"})),eG=Xz("g",{},void 0,Xz("path",{className:"thumb-preview-colorBg",d:"M0 0h96v76H0z"}),Xz("path",{className:"thumb-preview-colorBgDark",d:"M0 64h96v12H0z"}),Xz("path",{className:"thumb-preview-non-active-tab",d:"M33 66h30v8H33zM64 66h30v8H64z"}),Xz("path",{className:"thumb-preview-colorAccentBg",d:"M2 66h30v8H2z"})),tG=Xz("g",{},void 0,Xz("path",{className:"thumb-preview-colorBg",d:"M0 0h96v76H0z"}),Xz("path",{className:"thumb-preview-colorBgDark",d:"M0 0h34v76H0z"}),Xz("path",{className:"thumb-preview-non-active-tab",d:"M2 11h30v8H2zM2 20h30v8H2z"}),Xz("path",{className:"thumb-preview-colorAccentBg",d:"M2 2h30v8H2z"})),nG=Xz("svg",{xmlns:"http://www.w3.org/2000/svg",className:"selectbox-checkmark",viewBox:"0 0 16 16"},void 0,Xz("path",{d:"M5.3 13.3L1.5 9.5 3 8l2.3 2.5L13 2.7 14.6 4l-8 8z"}));class iG extends tn.Component{render(){if(!this.props.position)return null;const e=this.props.position,t=Qz[this.props.position],n=mn()({selectbox:!0,"selectbox-selected":this.props.selected}),i=(0,Ji.Z)(this.props,["position","vivaldiSettings"]);return(0,fn.jsxs)("button",{className:n,title:t,...i,children:[Xz("div",{className:"selectbox-image"},void 0,Xz("svg",{viewBox:"0 0 96 76",xmlns:"http://www.w3.org/2000/svg",className:"tab-preview"},void 0,"top"===e&&qz,"right"===e&&Jz,"bottom"===e&&eG,"left"===e&&tG),nG),Xz("div",{className:"selectbox-title"},void 0,t)]})}}const sG=iG;var oG;function aG(e,t,n,i){oG||(oG="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:oG,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const rG="left",lG="right",dG="bottom",cG=[D.kKeyboardTabToAll,D.kTabsBarPosition,D.kTabsVisible],hG=nt.Z.getEventHandler;class pG extends tn.Component{setTabPosition=e=>{nt.Z.set(D.kTabsBarPosition,e)};render(){const e=this.props.prefValues,t=e[D.kTabsBarPosition];return aG(jE.Z,{filter:this.props.filter},void 0,aG("div",{style:{display:"inline"}},void 0,aG("div",{className:"setting-group unlimited"},void 0,aG("div",{className:"setting-single"},void 0,aG("label",{},void 0,aG("input",{type:"checkbox",checked:e[D.kTabsVisible],onChange:hG(D.kTabsVisible)}),aG("span",{},void 0,(0,le.Z)("radio","Show Tab Bar"))))),aG("div",{className:"setting-group unlimited"},void 0,aG("div",{className:"setting-single"},void 0,aG("h3",{},void 0,(0,le.Z)("Tab Bar Position")),aG(sG,{position:"top",selected:"top"===t,onClick:this.setTabPosition.bind(this,"top")}),aG(sG,{position:"left",selected:t===rG,onClick:this.setTabPosition.bind(this,rG)}),aG(sG,{position:"right",selected:t===lG,onClick:this.setTabPosition.bind(this,lG)}),aG(sG,{position:"bottom",selected:t===dG,onClick:this.setTabPosition.bind(this,dG)})))))}}const uG=(0,fs.Z)(pG,cG);var gG;function mG(e,t,n,i){gG||(gG="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:gG,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const vG=nt.Z.getEventHandler,fG=[D.kTabsSelectionEnabled,D.kTabsSelectionIncludeActive];class yG extends tn.Component{render(){return mG(jE.Z,{filter:this.props.filter},void 0,mG("div",{className:"setting-group"},void 0,mG("div",{className:"setting-single"},void 0,mG("h3",{},void 0,(0,le.Z)("Tab Selection")),mG("div",{className:"setting-single"},void 0,mG("label",{title:(0,le.Z)("Select multiple tabs with Ctrl and Shift")},void 0,mG("input",{type:"checkbox",checked:this.props.prefValues[D.kTabsSelectionEnabled],onChange:vG(D.kTabsSelectionEnabled)}),mG("span",{},void 0,(0,le.Z)("Enable Tab Selection")))),mG("div",{className:"setting-single"},void 0,mG("label",{title:(0,le.Z)("The active tab will always be part of the initial tab selection")},void 0,mG("input",{type:"checkbox",checked:this.props.prefValues[D.kTabsSelectionIncludeActive],onChange:vG(D.kTabsSelectionIncludeActive)}),mG("span",{},void 0,(0,le.Z)("Include Active Tab in Initial Selection")))))))}}const wG=(0,fs.Z)(yG,fG);var bG;function CG(e,t,n,i){bG||(bG="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:bG,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const SG=nt.Z.getEventHandler,TG=[D.kTabsStackingAllowDnd,D.kTabsStackingAutoExpand,D.kTabsStackingMode,D.kTabsStackingOpenInCurrent,D.kTabsBarWidth,D.kTabsBarPosition,D.kTabsStackingPreferDotted,D.kTabsStackingDndDelay];class IG extends tn.Component{render(){const{prefValues:e}=this.props;return CG(jE.Z,{filter:this.props.filter},void 0,CG("div",{className:"setting-group"},void 0,CG("h3",{},void 0,(0,le.Z)("Tab Stacking")),CG("div",{className:"setting-single"},void 0,CG("label",{},void 0,CG("input",{name:"tab-stack-style",type:"radio",value:"dotted",checked:"dotted"===e[D.kTabsStackingMode],onChange:SG(D.kTabsStackingMode)}),CG("span",{},void 0,(0,le.Z)("radio","Compact"))),CG("div",{className:"dotted"===e[D.kTabsStackingMode]?"img-setting":"img-setting disabled"},void 0,CG("span",{className:"image",dangerouslySetInnerHTML:{__html:n(18998)}}))),CG("div",{className:"setting-single pad-top"},void 0,CG("label",{},void 0,CG("input",{name:"tab-stack-style",type:"radio",value:"substrip",checked:"substrip"===e[D.kTabsStackingMode],onChange:()=>{nt.Z.set(D.kTabsBarWidth,260),nt.Z.set(D.kTabsStackingMode,"substrip")}}),CG("span",{},void 0,(0,le.Z)("Two-Level"))),CG("div",{className:"substrip"===e[D.kTabsStackingMode]?"img-setting":"img-setting disabled"},void 0,CG("span",{className:e[D.kTabsStackingPreferDotted]?"image alternate":"image",dangerouslySetInnerHTML:{__html:n(86681)}}))),CG("div",{className:"setting-single pad-left"},void 0,CG("label",{},void 0,CG("input",{type:"checkbox",disabled:"substrip"!==e[D.kTabsStackingMode],checked:e[D.kTabsStackingPreferDotted],onChange:SG(D.kTabsStackingPreferDotted)}),CG("span",{},void 0,(0,le.Z)("Use Compact Display Style")))),CG("div",{className:"setting-single pad-top"},void 0,CG("label",{},void 0,CG("input",{name:"tab-stack-style",type:"radio",value:"accordion",checked:"accordion"===e[D.kTabsStackingMode],onChange:SG(D.kTabsStackingMode)}),CG("span",{},void 0,(0,le.Z)("Accordion"))),CG("div",{className:"accordion"===e[D.kTabsStackingMode]?"img-setting":"img-setting disabled"},void 0,CG("span",{className:"image",dangerouslySetInnerHTML:{__html:n(86484)}}))),CG("div",{className:"setting-single pad-left"},void 0,CG("label",{},void 0,CG("input",{type:"checkbox",disabled:"accordion"!==e[D.kTabsStackingMode],checked:e[D.kTabsStackingAutoExpand],onChange:SG(D.kTabsStackingAutoExpand)}),CG("span",{},void 0,(0,le.Z)("Auto Expand")))),CG("div",{className:"setting-single pad-top"},void 0,CG("label",{},void 0,CG("input",{name:"tab-stack-style",type:"radio",value:"off",checked:"off"===e[D.kTabsStackingMode],onChange:SG(D.kTabsStackingMode)}),CG("span",{},void 0,(0,le.Z)("Disable"))))),CG("div",{className:"setting-group"},void 0,CG("h3",{},void 0,(0,le.Z)("Tab Stack Options")),CG("div",{className:"setting-single"},void 0,CG("label",{},void 0,CG("input",{type:"checkbox",disabled:"off"===e[D.kTabsStackingMode],checked:e[D.kTabsStackingOpenInCurrent],onChange:SG(D.kTabsStackingOpenInCurrent)}),CG("span",{},void 0,(0,le.Z)("Open Tabs in Current Tab Stack")))),CG("div",{className:"setting-single"},void 0,CG("label",{},void 0,CG("input",{type:"checkbox",disabled:"off"===e[D.kTabsStackingMode],checked:e[D.kTabsStackingAllowDnd],onChange:SG(D.kTabsStackingAllowDnd)}),CG("span",{},void 0,(0,le.Z)("Allow Stacking by Drag and Drop")))),CG("div",{className:"setting-single stacking-delay pad-left"},void 0,CG("label",{htmlFor:"stacking-delay",title:(0,le.Z)("Adjust tab stack drop detection delay when moving a tab over another one.")},void 0,(0,le.Z)("Stacking Drop Delay")),CG("input",{type:"range",id:"stacking-delay",value:e[D.kTabsStackingDndDelay],min:50,max:850,step:200,disabled:!e[D.kTabsStackingAllowDnd]||"off"===e[D.kTabsStackingMode],onChange:SG(D.kTabsStackingDndDelay)}),CG("p",{className:"info stack-speed"},void 0,CG("span",{},void 0,(0,le.Z)("Short")),CG("span",{},void 0,(0,le.Z)("Long"))))))}}const kG=(0,fs.Z)(IG,TG);var AG;function ZG(e,t,n,i){AG||(AG="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:AG,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class EG extends tn.Component{render(){return ZG("span",{},void 0,ZG(a_,{categoryTitle:(0,le.Z)("Tabs"),filter:this.props.filter},void 0,(0,fn.jsx)(uG,{...this.props}),(0,fn.jsx)(Fz,{...this.props}),(0,fn.jsx)(Tz,{...this.props}),(0,fn.jsx)(jH,{...this.props})),ZG(a_,{categoryTitle:(0,le.Z)("Tab Display"),filter:this.props.filter},void 0,(0,fn.jsx)(Dz,{...this.props})),ZG(a_,{categoryTitle:(0,le.Z)("Tab Features"),filter:this.props.filter},void 0,(0,fn.jsx)(nz,{...this.props}),(0,fn.jsx)(wG,{...this.props}),(0,fn.jsx)(kG,{...this.props}),(0,fn.jsx)(jz,{...this.props}),(0,fn.jsx)(hz,{...this.props})))}}const _G=EG;var NG;function MG(e,t,n,i){NG||(NG="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:NG,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var PG=MG("span",{className:"ThemeEditorColorPicker-HexSymbol"},void 0,"#");class DG extends tn.PureComponent{state={hexString:void 0};delayedSetColor=(0,Kf.default)((e=>{this.props.setColor(e)}),$G,{trailing:!0,leading:!0});updateHexString=e=>{const t="#"+e.currentTarget.value;7===t.length&&Dr().valid(t)?(this.props.setColor(t),this.setState({hexString:void 0})):this.setState({hexString:t})};render(){return MG("div",{className:"ThemeEditorColorPicker"},void 0,this.props.label&&MG("div",{className:"ThemeEditorColorPicker-Label"},void 0,this.props.label),MG("input",{type:"color",className:"ThemeEditorColorPicker-ColorInput",disabled:this.props.disabled,value:this.props.color,onChange:e=>this.props.setColor(e.currentTarget.value)}),PG,MG("input",{className:"ThemeEditorColorPicker-HexInput",type:"text",disabled:this.props.disabled,value:(this.state.hexString||this.props.color).substring(1),onChange:this.updateHexString}))}}const xG=DG;var OG;function LG(e,t,n,i){OG||(OG="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:OG,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const RG=[D.kThemeScheduleEnabled,D.kThemeScheduleOS,D.kThemeScheduleTimeline,D.kThemesSystem,D.kThemesUser,D.kThemesCurrent,D.kThemesCurrentPrivate],BG=["backgroundBlur","backgroundImage","colorAccentBg","colorAccentBgDark","colorAccentFg","colorBg","colorBgAlphaBlur","colorBgIntenser","colorBgLightIntense","colorBorder","colorFg","colorHighlightBg","colorTabBar","colorWindowBg","radius","radiusRounded"];var FG=LG("div",{className:"ThemePreview-TabBar"},void 0,LG("div",{className:"ThemePreview-TabBar-Tab ThemePreview-TabBar-Tab--Active"}),LG("div",{className:"ThemePreview-TabBar-Tab"})),UG=LG("div",{className:"ThemePreview-AddressBar"},void 0,LG("div",{className:"ThemePreview-AddressBar-Icon ThemePreview-AddressBar-Icon--Active"}),LG("div",{className:"ThemePreview-AddressBar-Icon ThemePreview-AddressBar-Icon--Active"}),LG("div",{className:"ThemePreview-AddressBar-Icon"}),LG("div",{className:"ThemePreview-AddressBar-Input"})),VG=LG("div",{className:"ThemePreview-Panel"},void 0,LG("div",{className:"ThemePreview-Panel-Item ThemePreview-Panel-Item--Active"}),LG("div",{className:"ThemePreview-Panel-Item"}),LG("div",{className:"ThemePreview-Panel-Item"}));class WG extends tn.PureComponent{constructor(e){super(e);const{backgroundImage:t,backgroundPosition:n,id:i}=this.props.theme;this.state={style:P.Z.getBaseStyles(void 0,i)},lT.Z.getImageVars(t,n).then((e=>{e=(0,Yg.Z)(e),Object.assign(e,P.Z.getBaseStyles(BG,i)),this.setState({style:e})}))}componentDidUpdate(e,t){if(!(0,Sm.default)(e.theme,this.props.theme)){const{backgroundImage:e,backgroundPosition:t,id:n}=this.props.theme;lT.Z.getImageVars(e,t).then((e=>{e=(0,Yg.Z)(e),Object.assign(e,P.Z.getBaseStyles(BG,n)),this.setState({style:e})}))}}render(){const e=this.props.theme.id,t=this.props.prefValues[D.kThemeScheduleEnabled],n=this.props.prefValues[D.kThemeScheduleOS],i=this.props.prefValues[D.kThemeScheduleTimeline],s=lT.Z.createClassnames(this.props.theme,this.state.style);return LG("div",{className:mn()(this.props.className,"ThemePreview",{"ThemePreview--Selected":this.props.isCurrent&&this.props.themeChangeCallback})},void 0,LG("button",{disabled:!this.props.themeChangeCallback,onClick:this.props.themeChangeCallback?()=>{const e=this.props.theme.id;Sl.Z.setTheme(e),this.props.themeChangeCallback&&this.props.themeChangeCallback(e)}:null,className:mn()("ThemePreview-Image",s),style:this.state.style},void 0,FG,UG,VG),(this.props.themeChangeCallback||this.props.welcomePage)&&LG("div",{className:"ThemePreview-Label"},void 0,this.props.theme.name),this.props.themeChangeCallback&&!this.props.welcomePage&&LG("div",{className:"ThemePreview-Label-Meta"},void 0,this.props.theme.id===this.props.prefValues[D.kThemesCurrentPrivate]&&LG("span",{},void 0,(0,le.Z)("Private")),"system"===t&&e===n.light&&LG("span",{},void 0,(0,le.Z)("theme","Light")),"system"===t&&e===n.dark&&LG("span",{},void 0,(0,le.Z)("theme","Dark")),"timeline"===t&&i.some((t=>t.themeId===e))&&LG("span",{},void 0,(0,le.Z)("Schedule"))),!this.props.isSystem&&this.props.onConfirmDeletion&&LG("button",{className:"ThemePreview-Delete",onClick:()=>{void 0!==this.props.onConfirmDeletion&&this.props.onConfirmDeletion(e)},dangerouslySetInnerHTML:{__html:cn.uN0}}))}}const HG=(0,fs.Z)(WG,RG);var zG;function GG(e,t,n,i){zG||(zG="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:zG,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const $G=50,KG="chrome://vivaldi-data/desktop-image/0",jG=[D.kSystemAccentColor,D.kSystemHasDesktopWallpaperProtocol,D.kThemesSystem,D.kThemesUser],YG={colorBg:(0,le.Z)("Background"),colorFg:(0,le.Z)("Foreground"),colorHighlightBg:(0,le.Z)("Highlight"),colorAccentBg:(0,le.Z)("Accent"),colorWindowBg:(0,le.Z)("background color","Window")},XG={"#EDEEF2":(0,le.Z)("background","Light"),"#1D1E21":(0,le.Z)("background","Dark"),"#BBDFEF":(0,le.Z)("background","Blue"),"#fce370":(0,le.Z)("background","Yellow"),"#a4edd9":(0,le.Z)("background","Green"),"#ffb6c9":(0,le.Z)("background","Pink"),"#A9C8B3":(0,le.Z)("background","Soft Green"),"#BEB0CB":(0,le.Z)("background","Purple"),"#EFE5DD":(0,le.Z)("background","Sand"),"#FA7C68":(0,le.Z)("background","Orange")},QG={"/resources/4-0-wallpaper-light.jpg":(0,le.Z)("Blurred Circle Light"),"/resources/4-0-wallpaper-dark.jpg":(0,le.Z)("Blurred Circle Dark"),"/resources/bg_alt_7.jpg":(0,le.Z)("Human"),"/resources/bg_alt_1.jpg":(0,le.Z)("Pink Cloud"),"/resources/bg_alt_6.webp":(0,le.Z)("Blueprint"),"/resources/bg_alt_4.webp":(0,le.Z)("Beach"),"/resources/bg_geometric_1.jpg":(0,le.Z)("Purple Rain")},qG=(0,Kf.default)(((e,t)=>{nt.Z.set(e,t)}),$G,{trailing:!0,leading:!0});var JG=GG("img",{width:"24",height:"24",src:"../../../resources/emoji_party.png"});class e$ extends tn.PureComponent{static contextType=dn.Z;_isIMEOpen=!1;colorId=d.Z.utilities.generateGUID();backgroundId=d.Z.utilities.generateGUID();settingsId=d.Z.utilities.generateGUID();state={backgroundType:"image",baseBgShowPicker:!1,baseFgShowPicker:!1,highlightBgShowPicker:!1,accentBgShowPicker:!1,view:"colors"};render(){const{theme:e,isCurrent:t,isSystem:i,prefValues:s}=this.props,o=i?D.kThemesSystem:D.kThemesUser,a=s[D.kThemesSystem].concat(s[D.kThemesUser]),r=(0,Yg.Z)(s[o]),l=r.findIndex((t=>t.id===e.id)),c=a.reduce(((e,t)=>{const n=t.backgroundImage,i=[...Object.keys(e),...Object.keys(QG)];return n&&!i.includes(n)&&n!==KG&&(e[n]=(0,le.Z)("From $1",[t.name])),e}),{}),h={...QG,...c};return GG(jE.Z,{filter:this.props.filter},void 0,GG("div",{className:"ThemeEditor"},void 0,GG("div",{className:"ThemeEditor-Header"},void 0,GG("div",{className:"ThemeEditor-HeaderBasics"},void 0,GG("div",{className:"toolbar toolbar-default"},void 0,GG("select",{value:e.id,onChange:e=>{this.props.themeChangeCallback&&this.props.themeChangeCallback(e.currentTarget.value)}},void 0,a.map((e=>GG("option",{value:e.id},e.id,e.name)))),GG("input",{type:"button",className:"primary",disabled:t,onClick:()=>Sl.Z.setTheme(e.id),value:(0,le.Z)("Enable")}),i&&GG("input",{type:"button",className:"danger",disabled:lT.Z.isSystemThemeModified(lT.Z.getThemeWithFallback(e.id)),onClick:()=>Sl.Z.revertSystemTheme(e.id),value:(0,le.Z)("Reset")})),GG("div",{className:"ThemeEditor-Name"},void 0,GG("h3",{},void 0,(0,le.Z)("theme","Name")),GG("input",{className:"theme-name",type:"text",disabled:i,onCompositionStart:()=>this._isIMEOpen=!0,onCompositionEnd:e=>{this._isIMEOpen=!1,r[l].name=e.target.value,nt.Z.set(o,r)},onChange:e=>{r[l].name=e.target.value,!this._isIMEOpen&&nt.Z.set(o,r)},defaultValue:e.name},e.id)),!i&&GG("div",{className:"toolbar toolbar-default"},void 0,JG,GG("a",{className:"external-link",href:"https://themes.vivaldi.net",onClick:()=>Y.Z.openURL(this.context.vivaldiWindowId,"https://themes.vivaldi.net/upload")},void 0,(0,le.Z)("Share your theme"),GG("span",{dangerouslySetInnerHTML:{__html:n(70942)}})))),GG("div",{},void 0,GG(HG,{isCurrent:t,isSystem:i,theme:e},e.id))),GG(aL,{icons:[cn.v5q.small,cn.yhu.small,cn.d$r.small]},void 0,GG("div",{id:this.colorId,label:(0,le.Z)("Colors")},void 0,GG("div",{className:"ThemeEditorColors"},void 0,GG("div",{className:"ThemeEditorColors-Base"},void 0,["colorBg","colorFg"].map((t=>GG(xG,{label:YG[t],color:e[t],setColor:e=>{r[l][t]=Dr()(e).hex(),nt.Z.set(o,r)}},e.id+t)))),GG("div",{className:"ThemeEditorColors-Accent"},void 0,["colorHighlightBg","colorAccentBg"].map((t=>GG(xG,{label:YG[t],disabled:["colorHighlightBg"].includes(t)&&e.preferSystemAccent,color:e[t],setColor:e=>{r[l][t]=Dr()(e).hex(),nt.Z.set(o,r)}},e.id+t))),GG("div",{className:"setting-single"},void 0,GG("label",{},void 0,GG("input",{type:"checkbox",checked:e.preferSystemAccent,onChange:e=>{r[l].preferSystemAccent=e.target.checked,nt.Z.set(o,r)}}),GG("span",{},void 0,(0,le.Z)("Prefer System Color")))))),GG("div",{className:"TabbedView--Padded"},void 0,GG("div",{className:"setting-group"},void 0,GG("div",{className:"setting-single"},void 0,GG("h3",{},void 0,(0,le.Z)("Color Overrides")),GG("label",{},void 0,GG("input",{type:"checkbox",checked:e.accentFromPage,onChange:e=>{r[l].accentFromPage=e.target.checked,nt.Z.set(o,r)}}),GG("span",{},void 0,(0,le.Z)("Accent from Page")))),GG("div",{className:"setting-single"},void 0,GG("label",{},void 0,GG("input",{type:"checkbox",checked:e.accentOnWindow,onChange:e=>{r[l].accentOnWindow=e.target.checked,nt.Z.set(o,r)}}),GG("span",{},void 0,(0,le.Z)("Accent on Window")))),GG("div",{className:"setting-single pad-top"},void 0,GG("h3",{},void 0,(0,le.Z)("Background Window Behavior")),GG("label",{},void 0,GG("input",{type:"checkbox",checked:e.dimBlurred,onChange:e=>{r[l].dimBlurred=e.target.checked,nt.Z.set(o,r)}}),GG("span",{},void 0,(0,le.Z)("Fade Foreground Colors"))))),GG("div",{className:"setting-group"},void 0,GG("div",{className:"setting-single"},void 0,GG("h3",{},void 0,(0,le.Z)("Contrast")),GG(QB,{min:-10,max:20,step:1,onChange:e=>{r[l].contrast=Number(e.target.value),qG(o,r)},value:e.contrast})),GG("div",{className:"setting-single pad-top"},void 0,GG("h3",{},void 0,(0,le.Z)("Limit Accent Color Saturation")),GG(QB,{min:.2,max:1,step:.05,value:e.accentSaturationLimit,onChange:e=>{r[l].accentSaturationLimit=Number(e.target.value),qG(o,r)},label:`${Math.floor(100*e.accentSaturationLimit)}%`}))))),GG("div",{id:this.backgroundId,label:(0,le.Z)("Background")},void 0,GG("div",{className:"ThemeEditor-BackgroundMeta"},void 0,GG("div",{className:"ThemeEditor-BackgroundMetaBasic"},void 0,GG("span",{},void 0,(0,le.Z)("Type:")),GG("select",{value:this.state.backgroundType,onChange:e=>{const t=e.target.value;this.setState({backgroundType:t})}},void 0,GG("option",{value:"image"},void 0,(0,le.Z)("theme background","Image")),GG("option",{value:"color"},void 0,(0,le.Z)("theme background","Color"))),"color"===this.state.backgroundType&&(0,fn.jsxs)(fn.Fragment,{children:[GG("span",{},void 0,(0,le.Z)("Custom Color")),GG(xG,{color:e.colorWindowBg,setColor:e=>{r[l].colorWindowBg=Dr()(e).hex(),nt.Z.set(o,r)}})]}),"image"===this.state.backgroundType&&(0,fn.jsxs)(fn.Fragment,{children:[GG("select",{value:e.backgroundPosition,onChange:e=>{r[l].backgroundPosition=e.target.value,nt.Z.set(o,r)}},void 0,GG("option",{value:"stretch"},void 0,(0,le.Z)("Stretch to Fit")),GG("option",{value:"repeat"},void 0,(0,le.Z)("verb","Repeat")),GG("option",{value:"center"},void 0,(0,le.Z)("Center"))),this.props.prefValues[D.kSystemHasDesktopWallpaperProtocol]&&GG("input",{className:"ThemeEditor-BackgroundCustomButton",type:"button",disabled:e.backgroundImage===KG,value:(0,le.Z)("Use Desktop Image"),onClick:()=>{r[l].backgroundImage=KG,nt.Z.set(o,r)}}),GG("input",{className:"ThemeEditor-BackgroundCustomButton",type:"button",value:(0,le.Z)("Select Image..."),onClick:()=>{d.Z.utilities.selectLocalImage({windowId:this.context.vivaldiWindowId,title:(0,le.Z)("Select Background Image"),themeId:r[l].id})}})]})),"color"===this.state.backgroundType&&e.backgroundImage&&e.colorWindowBg&&GG("div",{className:"ThemeEditor-BackgroundMetaInfoBar"},void 0,GG("span",{},void 0,(0,le.Z)("This theme has a background image set that may obscure the color.")),GG("input",{type:"button",value:(0,le.Z)("Clear Image"),onClick:()=>{r[l].backgroundImage="",nt.Z.set(o,r)}}))),GG("div",{className:"ThemeEditor-Background"},void 0,GG("div",{className:"ThemeEditor-BackgroundList"},void 0,"color"===this.state.backgroundType&&(0,fn.jsxs)(fn.Fragment,{children:[GG("button",{className:mn()("selectbox",{"selectbox-selected":!e.colorWindowBg}),onClick:()=>{r[l].colorWindowBg="",nt.Z.set(o,r)}},void 0,GG("div",{className:"selectbox-image",style:{backgroundColor:e.colorBg},dangerouslySetInnerHTML:{__html:cn.D7r.medium}}),GG("div",{className:"selectbox-title"},void 0,(0,le.Z)("No color"))),Object.keys(XG).map((t=>GG("button",{className:mn()("selectbox",{"selectbox-selected":t===e.colorWindowBg}),onClick:e=>{r[l].colorWindowBg=t,nt.Z.set(o,r)}},t,GG("div",{className:"selectbox-image",style:{backgroundColor:t},dangerouslySetInnerHTML:{__html:cn.D7r.medium}}),GG("div",{className:"selectbox-title"},void 0,XG[t]))))]}),"image"===this.state.backgroundType&&(0,fn.jsxs)(fn.Fragment,{children:[GG("button",{className:mn()("selectbox",{"selectbox-selected":!e.backgroundImage}),onClick:e=>{r[l].backgroundImage="",nt.Z.set(o,r)}},void 0,GG("div",{className:"selectbox-image",style:{backgroundColor:e.colorWindowBg},dangerouslySetInnerHTML:{__html:cn.D7r.medium}}),GG("div",{className:"selectbox-title"},void 0,(0,le.Z)("No image"))),Object.keys(h).map((t=>GG("button",{className:mn()("selectbox",{"selectbox-selected":t===e.backgroundImage}),onClick:e=>{r[l].backgroundImage=t,nt.Z.set(o,r)}},t,GG("div",{className:"selectbox-image",style:{backgroundImage:`url(${t})`},dangerouslySetInnerHTML:{__html:cn.D7r.medium}}),GG("div",{className:"selectbox-title"},void 0,h[t]))))]})))),GG("div",{id:this.settingsId,label:(0,le.Z)("Settings")},void 0,GG("div",{className:"TabbedView--Padded"},void 0,GG("div",{className:"setting-group"},void 0,GG("div",{className:"setting-single"},void 0,GG("h3",{},void 0,(0,le.Z)("Blur")),GG(QB,{min:0,max:10,step:1,value:e.blur,onChange:e=>{r[l].blur=Number(e.target.value),qG(o,r)}})),GG("div",{className:"setting-single pad-top"},void 0,GG("h3",{},void 0,(0,le.Z)("Transparency")),GG(QB,{min:0,max:.25,step:.01,value:1-e.alpha,onChange:e=>{r[l].alpha=parseFloat((1-Number(e.currentTarget.value)).toFixed(2)),qG(o,r)},label:`${Math.round(100*(1-e.alpha))}%`})),GG("div",{className:"setting-single pad-top"},void 0,GG("label",{},void 0,GG("input",{type:"checkbox",checked:e.transparencyTabBar,onChange:e=>{r[l].transparencyTabBar=e.target.checked,nt.Z.set(o,r)}}),GG("span",{},void 0,(0,le.Z)("Transparent Tab Bar")))),GG("div",{className:"setting-single"},void 0,GG("label",{},void 0,GG("input",{type:"checkbox",checked:e.transparencyTabs,onChange:e=>{r[l].transparencyTabs=e.target.checked,nt.Z.set(o,r)}}),GG("span",{},void 0,(0,le.Z)("Transparent Background Tabs"))))),GG("div",{className:"setting-group"},void 0,GG("div",{className:"setting-single"},void 0,GG("h3",{},void 0,(0,le.Z)("Scrollbar Style")),GG("label",{},void 0,GG("input",{type:"checkbox",checked:e.simpleScrollbar,onChange:e=>{r[l].simpleScrollbar=e.target.checked,nt.Z.set(o,r)}}),GG("span",{},void 0,(0,le.Z)("Use Simple Scrollbars")))),GG("div",{className:mn()("setting-single",{"pad-top":!0})},void 0,GG("h3",{},void 0,(0,le.Z)("Corner Rounding")),GG(QB,{min:-1,max:14,value:e.radius,onChange:e=>{r[l].radius=Number(e.target.value),qG(o,r)},label:-1===e.radius?(0,le.Z)("Disabled"):e.radius.toString()}))))))))}}const t$=(0,fs.Z)(e$,jG);var n$;function i$(e,t,n,i){n$||(n$="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:n$,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const s$=[D.kThemeScheduleEnabled,D.kThemeScheduleOS,D.kThemeScheduleTimeline,D.kThemesSystem,D.kThemesUser],o$=nt.Z.getEventHandler,a$=["colorFg","colorBg","colorBgDark","colorBgIntense","colorBorderIntense","colorAccentBg"];var r$=i$("hr",{});class l$ extends tn.PureComponent{static contextType=dn.Z;refScheduleTimeline=tn.createRef();constructor(e){super(e),this.state={dragging:!1,now:new Date,selectedScheduleId:e.prefValues[D.kThemeScheduleTimeline][0].id}}componentDidMount(){this.context.addEventListener("pointerup",this.stopPointerReschedule),this.timer=setInterval(this.updateNow,6e4)}componentWillUnmount(){clearInterval(this.timer),this.context.removeEventListener("pointerup",this.stopPointerReschedule)}updateNow=()=>{this.setState({now:new Date})};startPointerReschedule=(e,t)=>{t.persist(),t.preventDefault(),this.setState({dragging:!0,selectedScheduleId:e},(()=>{this.handlePointerReschedule(t)}))};pointerReschedule=e=>{e.preventDefault(),this.state.dragging&&this.handlePointerReschedule(e)};stopPointerReschedule=()=>{if(this.state.dragging){this.setState({dragging:!1});const e=lT.Z.getTimerByDate(new Date,"current");e&&Sl.Z.setTheme(e.themeId)}};handlePointerReschedule=e=>{const t=this.refScheduleTimeline.current?.getBoundingClientRect()??{left:0,width:0},n=e.clientX-t.left,i=5*Math.floor(1439/t.width*n/5);if(i<0||i>1439)return;const s=(0,Yg.Z)(this.props.prefValues[D.kThemeScheduleTimeline]),o=s.findIndex((e=>e.id===this.state.selectedScheduleId));s[o].hours=Math.floor(i/60),s[o].minutes=i-60*s[o].hours,nt.Z.set(D.kThemeScheduleTimeline,s)};addSchedule=()=>{const e=(0,Yg.Z)(this.props.prefValues[D.kThemeScheduleTimeline]),t=d.Z.utilities.generateGUID();e.push({id:t,minutes:0,hours:12,themeId:lT.Z.getDefaultTheme().id,undeletable:!1}),nt.Z.set(D.kThemeScheduleTimeline,e),this.setState({selectedScheduleId:t})};removeSelectedScheduleOnDelete=e=>{["KeyCode.KEY_BACK_SPACE","KeyCode.KEY_DELETE"].includes(e.keyCode)&&this.removeSelectedSchedule()};handleKeyboardReschedule=(e,t)=>{if([qi.Z.KEY_LEFT,qi.Z.KEY_RIGHT].includes(t.keyCode)){const n=(0,Yg.Z)(this.props.prefValues[D.kThemeScheduleTimeline]),i=n.findIndex((t=>t.id===e));let s=60*n[i].hours+n[i].minutes;t.shiftKey?t.keyCode===qi.Z.KEY_LEFT&&s>29?s-=30:t.keyCode===qi.Z.KEY_RIGHT&&s<1409&&(s+=30):t.keyCode===qi.Z.KEY_LEFT&&s>4?s-=5:t.keyCode===qi.Z.KEY_RIGHT&&s<1434&&(s+=5),n[i].hours=Math.floor(s/60),n[i].minutes=s-60*n[i].hours,this.setState({selectedScheduleId:e}),nt.Z.set(D.kThemeScheduleTimeline,n)}else[qi.Z.KEY_BACK_SPACE,qi.Z.KEY_DELETE].includes(t.keyCode)&&this.removeSelectedSchedule()};removeSelectedSchedule=()=>{const e=(0,Yg.Z)(this.props.prefValues[D.kThemeScheduleTimeline]),t=e.findIndex((e=>e.id===this.state.selectedScheduleId));e[t].undeletable||(e.splice(t,1),nt.Z.set(D.kThemeScheduleTimeline,e),this.setState({selectedScheduleId:void 0}))};updateOSTheme=e=>{const t=this.props.prefValues[D.kThemeScheduleOS];nt.Z.set(D.kThemeScheduleOS,{...t,[e.target.name]:e.target.value})};indicatorFocus=(e,t)=>{t.stopPropagation(),this.setState({selectedScheduleId:e})};indicatorBlur=()=>{this.setState({selectedScheduleId:void 0})};render(){const e=(0,Yg.Z)(this.props.prefValues[D.kThemeScheduleTimeline]),t=this.state.now,n=(t.getMinutes()+60*t.getHours())/14.4+"%",{prefValues:i}=this.props,s=i[D.kThemesSystem].concat(i[D.kThemesUser]).sort(((e,t)=>e.name.localeCompare(t.name))),o="timeline"!==i[D.kThemeScheduleEnabled],a="system"!==i[D.kThemeScheduleEnabled],r=!1===e.find((e=>e.id===this.state.selectedScheduleId))?.undeletable;return e.sort(((e,t)=>60*e.hours+e.minutes-(60*t.hours+t.minutes))),e.unshift(e[e.length-1]),i$(a_,{categoryTitle:(0,le.Z)("Theme Schedule"),className:"setting-group unlimited",filter:this.props.filter,onPointerMove:this.pointerReschedule},void 0,i$("div",{className:"setting-group-double"},void 0,i$("div",{className:"setting-single"},void 0,i$("label",{},void 0,i$("input",{type:"radio",value:"off",checked:"off"===i[D.kThemeScheduleEnabled],onChange:o$(D.kThemeScheduleEnabled)}),i$("span",{},void 0,(0,le.Z)("No Schedule")))),i$("div",{className:"setting-single pad-top"},void 0,i$("label",{},void 0,i$("input",{type:"radio",value:"system",checked:"system"===i[D.kThemeScheduleEnabled],onChange:o$(D.kThemeScheduleEnabled)}),i$("span",{},void 0,(0,le.Z)("Operating System")))),i$("div",{className:"setting-single"},void 0,i$("label",{},void 0,i$("span",{},void 0,(0,le.Z)("theme","Light")),i$("select",{name:"light",value:i[D.kThemeScheduleOS].light,disabled:a,onChange:this.updateOSTheme},void 0,s.map((e=>i$("option",{value:e.id},e.id,e.name))))),i$("label",{},void 0,i$("span",{},void 0,(0,le.Z)("theme","Dark")),i$("select",{name:"dark",value:i[D.kThemeScheduleOS].dark,disabled:a,onChange:this.updateOSTheme},void 0,s.map((e=>i$("option",{value:e.id},e.id,e.name)))))),i$("div",{className:"setting-single"},void 0,i$("label",{},void 0,i$("input",{type:"radio",value:"timeline",checked:"timeline"===i[D.kThemeScheduleEnabled],onChange:o$(D.kThemeScheduleEnabled)}),i$("span",{},void 0,(0,le.Z)("Manual Schedule"))))),(0,fn.jsxs)("div",{className:"theme-schedule-timeline"+(o?" schedule-disabled":""),ref:this.refScheduleTimeline,children:[!o&&i$("span",{className:"theme-schedule-now-indicator",style:{left:n}},void 0,(0,le.Z)("Now")),e.map(((t,n)=>{const i=0===n?0:(60*t.hours+t.minutes)/14.4,a=e[n+1],r=a?60*a.hours+a.minutes:1440,l=String(t.hours).padStart(2,"0"),d=String(t.minutes).padStart(2,"0"),{name:c}=lT.Z.getThemeWithFallback(t.themeId),h=P.Z.getBaseStyles(a$,t.themeId),p=this.state.selectedScheduleId===t.id;return i$("div",{className:mn()("theme-schedule-timeslice",{"timeslice-selected":!o&&p}),style:{width:r/14.4-i+"%",left:`${i}%`}},n,0!==n&&(0,fn.jsxs)(fn.Fragment,{children:[!o&&i$("div",{title:c,className:"timeslice-bubble",onFocus:this.indicatorFocus.bind(this,t.id),onBlur:this.indicatorBlur,disabled:o,onPointerDown:e=>this.startPointerReschedule(t.id,e),onKeyDown:this.handleKeyboardReschedule.bind(this,t.id)},void 0,i$("div",{},void 0,`${l}:${d}`)),i$("div",{className:"theme-schedule-timeslice-indicator"},void 0,i$("input",{type:"button",className:"theme-schedule-timeslice-draghandle",title:c,onFocus:this.indicatorFocus.bind(this,t.id),onBlur:this.indicatorBlur,disabled:o,onPointerDown:e=>this.startPointerReschedule(t.id,e),onKeyDown:this.handleKeyboardReschedule.bind(this,t.id)}))]}),i$("select",{disabled:o,value:t.themeId,style:h,title:c,onFocus:this.indicatorFocus.bind(this,t.id),onKeyDown:this.removeSelectedScheduleOnDelete,onChange:e=>function(e,t){const n=(0,Yg.Z)(M.Z.get(D.kThemeScheduleTimeline)),i=n.findIndex((t=>t.id===e));n[i].themeId=t,console.log(n),nt.Z.set(D.kThemeScheduleTimeline,n)}(t.id,e.target.value)},void 0,s.map((e=>i$("option",{value:e.id},e.id,e.name)))))}))]}),i$("div",{className:"toolbar toolbar-default toolbar-group"},void 0,i$("div",{className:"toolbar-group"},void 0,i$(sl,{disabled:o,onClick:this.addSchedule,image:cn.md4.medium,title:(0,le.Z)("Add")}),r$,i$(sl,{disabled:o||!r||void 0===this.state.selectedScheduleId,onClick:this.removeSelectedSchedule,image:cn.M2k.medium,title:(0,le.Z)("other","Remove")}))))}}const d$=(0,fs.Z)(l$,s$);var c$;function h$(e,t,n,i){c$||(c$="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:c$,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const p$=[D.kSystemAccentColor,D.kThemeScheduleEnabled,D.kThemeScheduleOS,D.kThemeScheduleTimeline,D.kThemesSystem,D.kThemesUser,D.kThemesCurrent,D.kThemesPreview,D.kThemesCurrentPrivate];var u$=h$("div",{className:"ThemePreview-Label-Meta"});class g$ extends tn.PureComponent{static contextType=dn.Z;libraryId=d.Z.utilities.generateGUID();editorId=d.Z.utilities.generateGUID();constructor(e,t){super(e);const n=t.vivaldiWindowId;this.state={editorThemeId:Sl.Z.getCurrentIdWithoutPreview(n),tabbedViewId:this.libraryId,confirmDeletionId:void 0}}onAddTheme=(e,t)=>{const n=t.currentTarget.closest(".settings-content");n&&n.scrollTop>150&&n.scrollTo({top:150,behavior:"smooth"});const i=Sl.Z.createTheme(e);this.setState({editorThemeId:i,tabbedViewId:this.editorId})};onConfirmDeletion=e=>{this.setState({confirmDeletionId:e})};closeDialog=()=>{this.setState({confirmDeletionId:void 0})};deleteTheme=()=>{this.state.confirmDeletionId&&Sl.Z.deleteTheme(this.state.confirmDeletionId),this.closeDialog()};renderDialog=()=>{const e=lT.Z.getThemeWithFallback(this.state.confirmDeletionId).name;return h$(ln.Z,{onRequestClose:this.closeDialog,viewMode:"float"},void 0,h$("header",{className:"dialog-header"},void 0,h$("h1",{className:"dialog-title"},void 0,(0,le.Z)("Deleting “$1”",[e])),h$("p",{},void 0,(0,le.Z)("Do you want to permanently delete the “$1” theme?",[e]))),h$("div",{className:"dialog-footer"},void 0,h$("input",{type:"button",className:"danger",onClick:this.deleteTheme,value:(0,le.Z)("Delete Theme")}),h$("input",{type:"button",onClick:this.closeDialog,value:(0,le.Z)("Cancel")})))};renderFooter(e){return h$("div",{className:"TabbedView-Footer"},void 0,h$("input",{type:"button",value:(0,le.Z)("Open Theme..."),onClick:async()=>{Sl.Z.clearThemePreview();const e=await d.Z.themePrivate.import({windowId:this.context.vivaldiWindowId,dialogTitle:(0,le.Z)("Select Theme to Import")}),{error:t}=e;if(t)throw new Error(`${t.kind} - ${t.details}`)}}),h$("input",{type:"button",value:(0,le.Z)("Export Theme..."),onClick:async()=>{const t=lT.Z.getThemeWithFallback(e);await Sl.Z.exportTheme(t,this.context.vivaldiWindowId)}}),h$("a",{className:"external-link",href:"https://themes.vivaldi.net",onClick:()=>Y.Z.openURL(this.context.vivaldiWindowId,"https://themes.vivaldi.net"),style:{margin:"auto 0 auto auto"}},void 0,(0,le.Z)("Get more themes"),h$("span",{dangerouslySetInnerHTML:{__html:n(70942)}})))}render(){const e=lT.Z.getSystemThemes(),t=e.concat(this.props.prefValues[D.kThemesUser]),n=Sl.Z.getCurrentIdWithoutPreview(this.context.vivaldiWindowId);return(0,fn.jsxs)(fn.Fragment,{children:[h$(a_,{filter:this.props.filter,categoryTitle:(0,le.Z)("Themes")},void 0,h$(jE.Z,{filter:this.props.filter},void 0,h$("p",{className:"info"},void 0,(0,le.Z)("Select any of the pre-installed themes, make your own in the Theme Editor, or head over to themes.vivaldi.net to download themes shared by the Vivaldi community.")),h$(aL,{icons:[cn.v5q.small,cn.B$9.small],activeTabId:this.state.tabbedViewId,onTabClick:e=>{this.setState({tabbedViewId:e})}},void 0,h$("div",{id:this.libraryId,label:(0,le.Z)("Library")},void 0,h$("div",{className:"TabbedView--Padded ThemePreviews"},void 0,this.state.confirmDeletionId&&this.renderDialog(),t.map((t=>h$("div",{onDoubleClick:()=>{this.setState({tabbedViewId:this.editorId})}},t.id,h$(HG,{isCurrent:t.id===n,isSystem:e.some((e=>e.id===t.id)),theme:t,themeChangeCallback:e=>{this.setState({editorThemeId:e})},onConfirmDeletion:this.onConfirmDeletion})))),h$("div",{className:"ThemePreview ThemePreview--New"},void 0,h$("button",{onClick:e=>this.onAddTheme(n,e),className:"ThemePreview-Image",dangerouslySetInnerHTML:{__html:cn.Clf}}),h$("div",{className:"ThemePreview-Label"},void 0,(0,le.Z)("New Theme...")),u$)),this.renderFooter(n)),h$("div",{id:this.editorId,label:(0,le.Z)("Editor")},void 0,h$("div",{className:"TabbedView--Padded"},void 0,h$(t$,{theme:lT.Z.getThemeWithFallback(this.state.editorThemeId),isCurrent:this.state.editorThemeId===n,isSystem:e.some((e=>e.id===this.state.editorThemeId)),filter:this.props.filter,themeChangeCallback:e=>{this.setState({editorThemeId:e})}})),this.renderFooter(this.state.editorThemeId||n))))),h$(a_,{categoryTitle:(0,le.Z)("Private Window Theme"),filter:this.props.filter},void 0,h$("div",{className:"setting-single setting-single--LeadingText"},void 0,h$("label",{},void 0,h$("span",{},void 0,(0,le.Z)("Select theme for Private Windows")),h$("select",{value:this.props.prefValues[D.kThemesCurrentPrivate],onChange:e=>nt.Z.set(D.kThemesCurrentPrivate,e.currentTarget.value)},void 0,t.map((e=>h$("option",{value:e.id},e.id,e.name))))))),h$(d$,{filter:this.props.filter})]})}}const m$=(0,fs.Z)(g$,p$);var v$;function f$(e,t,n,i){v$||(v$="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:v$,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const y$=[D.kPluginsAlwaysOpenPdfExternally,D.kPluginsWidevineEnabled],w$=nt.Z.getEventHandler;class b$ extends tn.Component{constructor(e){super(e)}render(){return f$(a_,{categoryTitle:(0,le.Z)("Plugins"),filter:this.props.filter},void 0,f$("div",{className:"setting-group unlimited"},void 0,f$("div",{className:"setting-single"},void 0,f$("label",{},void 0,f$("input",{type:"checkbox",checked:!this.props.prefValues[D.kPluginsAlwaysOpenPdfExternally],onChange:w$(D.kPluginsAlwaysOpenPdfExternally,"inverse")}),f$("span",{},void 0,(0,le.Z)("Enable Internal PDF Viewer")))),f$("div",{className:"setting-single"},void 0,f$("label",{},void 0,f$("input",{type:"checkbox",checked:this.props.prefValues[D.kPluginsWidevineEnabled],onChange:w$(D.kPluginsWidevineEnabled)}),f$("span",{},void 0,(0,le.Z)("Enable Widevine Plugin"))))))}}const C$=(0,fs.Z)(b$,y$);var S$;function T$(e,t,n,i){S$||(S$="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:S$,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class I$ extends tn.PureComponent{state={zoom:1};#n=!1;componentDidMount(){this.#n=!0,d.Z.zoom.onDefaultZoomChanged.addListener(this._onDefaultZoomChanged),d.Z.zoom.getDefaultZoom(this._onDefaultZoomChanged)}componentWillUnmount(){this.#n=!1,d.Z.zoom.onDefaultZoomChanged.removeListener(this._onDefaultZoomChanged)}rangeCheck=e=>Math.min(Math.max(e,Kv.VH),Kv.oJ);_onDefaultZoomChanged=e=>{this.#n&&this.setState({zoom:this.rangeCheck(e)})};setZoomLevel=e=>{const t=this.rangeCheck(e);d.Z.zoom.setDefaultZoom(t)};render(){const{zoom:e}=this.state;return T$(zv,{zoom:e,defaultZoomLevel:Kv.XZ,scrolling:!0,inFooter:!1,maxLevel:Kv.oJ,minLevel:Kv.VH,step:Kv.s5,disabled:!1,onZoomUpdated:this.setZoomLevel},"zoomslider")}}const k$=I$;var A$;function Z$(e,t,n,i){A$||(A$="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:A$,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const E$=[D.kMouseWheelPageZoom,D.kWebpagesTabZoomEnabled],_$=nt.Z.getEventHandler;var N$=Z$("div",{className:"toolbar toolbar-default"},void 0,Z$(k$,{}));class M$ extends tn.Component{handleZoomUpdated=e=>{d.Z.zoom.setDefaultZoom(e)};render(){return Z$(jE.Z,{filter:this.props.filter},void 0,Z$("div",{className:"setting-group"},void 0,Z$("div",{className:"setting-single"},void 0,Z$("h3",{},void 0,(0,le.Z)("Default Webpage Zoom")),N$),Z$("div",{className:"setting-single pad-top"},void 0,Z$("label",{},void 0,Z$("input",{type:"checkbox",checked:this.props.prefValues[D.kMouseWheelPageZoom],onChange:_$(D.kMouseWheelPageZoom)}),Z$("span",{},void 0,(0,le.Z)("Use $1+Scroll to Zoom Page",["Ctrl"])))),Z$("div",{className:"setting-single"},void 0,Z$("label",{},void 0,Z$("input",{type:"checkbox",checked:this.props.prefValues[D.kWebpagesTabZoomEnabled],onChange:_$(D.kWebpagesTabZoomEnabled)}),Z$("span",{},void 0,(0,le.Z)("Use Tab Zoom"))),Z$("p",{className:"info"},void 0,(0,le.Z)("Retain zoom level when navigating between websites")))))}}const P$=(0,fs.Z)(M$,E$);var D$;function x$(e,t,n,i){D$||(D$="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:D$,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const O$=[D.kWebpagesFullScreenShowBubble];O$.push(D.kWebpagesFullScreenHideMouse);const L$=nt.Z.getEventHandler;class R$ extends tn.Component{render(){const e=x$("div",{className:"setting-single"},void 0,x$("label",{},void 0,x$("input",{type:"checkbox",checked:this.props.prefValues[D.kWebpagesFullScreenShowBubble],onChange:L$(D.kWebpagesFullScreenShowBubble)}),x$("span",{},void 0,(0,le.Z)("Show Fullscreen Reminder")))),t=x$("div",{className:"setting-single"},void 0,x$("label",{},void 0,x$("input",{type:"checkbox",checked:this.props.prefValues[D.kWebpagesFullScreenHideMouse],onChange:L$(D.kWebpagesFullScreenHideMouse)}),x$("span",{},void 0,(0,le.Z)("Hide the Mouse Cursor for Page-initiated Fullscreen"))));return x$(jE.Z,{filter:this.props.filter},void 0,x$("span",{},void 0,x$("div",{className:"setting-group"},void 0,x$("h3",{},void 0,(0,le.Z)("Fullscreen Mode")),e,t)))}}const B$=(0,fs.Z)(R$,O$);var F$;function U$(e,t,n,i){F$||(F$="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:F$,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const V$=[D.kHardwareAccelerationModeEnabled],W$=nt.Z.getEventHandler;class H$ extends tn.Component{render(){return U$(jE.Z,{filter:this.props.filter},void 0,U$("div",{className:"setting-group unlimited"},void 0,U$("div",{className:"setting-single"},void 0,U$("label",{},void 0,U$("input",{type:"checkbox",checked:this.props.prefValues[D.kHardwareAccelerationModeEnabled],onChange:W$(D.kHardwareAccelerationModeEnabled)}),U$("span",{},void 0,(0,le.Z)("Use Hardware Acceleration When Available"))),U$("p",{className:"info"},void 0,(0,le.Z)("This setting requires a restart to take full effect.")))))}}const z$=(0,fs.Z)(H$,V$);var G$;function $$(e,t,n,i){G$||(G$="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:G$,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var K$=$$("input",{type:"radio",value:"allowed"}),j$=$$("input",{type:"radio",value:"once"}),Y$=$$("input",{type:"radio",value:"none"});class X$ extends tn.Component{state={animationPolicy:"allowed"};componentDidMount(){y.Z.accessibilityFeatures.animationPolicy.onChange.addListener(this._onAnimationPolicyChanged),this._onAnimationPolicyChanged()}componentWillUnmount(){y.Z.accessibilityFeatures.animationPolicy.onChange.removeListener(this._onAnimationPolicyChanged)}_onAnimationPolicyChanged=()=>{y.Z.accessibilityFeatures.animationPolicy.get({},(({value:e})=>{this.setState({animationPolicy:e})}))};onSelected=e=>{const t=e.target.value;this.setState({animationPolicy:t},(()=>{y.Z.accessibilityFeatures.animationPolicy.set({value:t},(()=>{}))}))};render(){return $$(jE.Z,{filter:this.props.filter},void 0,$$("div",{className:"setting-group"},void 0,$$("div",{className:"setting-single"},void 0,$$("h3",{},void 0,(0,le.Z)("Play Image Animation")),$$(ws,{name:"animationPolicy",value:this.state.animationPolicy,onChange:this.onSelected},void 0,$$("div",{className:"setting-single"},void 0,$$("label",{},void 0,K$,$$("span",{},void 0,(0,le.Z)("command","Loop")))),$$("div",{className:"setting-single"},void 0,$$("label",{},void 0,j$,$$("span",{},void 0,(0,le.Z)("Once")))),$$("div",{className:"setting-single"},void 0,$$("label",{},void 0,Y$,$$("span",{},void 0,(0,le.Z)("radio","Never"))))))))}}const Q$=X$;var q$;function J$(e,t,n,i){q$||(q$="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:q$,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var eK=J$("input",{type:"radio",value:"always"}),tK=J$("input",{type:"radio",value:"never"}),nK=J$("input",{type:"radio",value:"cache"});class iK extends tn.Component{state={imageLoading:"always"};componentDidMount(){this._initState(),M.Z.addListener(D.kPageImageLoading,this._onSettingsChanged)}componentWillUnmount(){M.Z.removeListener(D.kPageImageLoading,this._onSettingsChanged)}_initState=()=>{const e=M.Z.get(D.kPageImageLoading);e&&this.setState({imageLoading:e})};_onSettingsChanged=(e,t)=>{this.setState({imageLoading:t})};onSelected=e=>{const t=e.currentTarget.value;this.setState({imageLoading:t},(()=>{nt.Z.set(D.kPageImageLoading,t)}))};render(){return J$(jE.Z,{filter:this.props.filter},void 0,J$("div",{className:"setting-group"},void 0,J$("div",{className:"setting-single"},void 0,J$("h3",{},void 0,(0,le.Z)("page settings","Load Images")),J$("p",{className:"info"},void 0,(0,le.Z)("Image loading setting for new tabs. Tabs opened from links will not use this setting, but will inherit the setting from the parent tab.")),J$(ws,{name:"imageLoadingPolicy",value:this.state.imageLoading,onChange:this.onSelected},void 0,J$("div",{className:"setting-single"},void 0,J$("label",{},void 0,eK,J$("span",{},void 0,(0,le.Z)("radio","Always")))),J$("div",{className:"setting-single"},void 0,J$("label",{},void 0,tK,J$("span",{},void 0,(0,le.Z)("radio","Never")))),J$("div",{className:"setting-single"},void 0,J$("label",{},void 0,nK,J$("span",{},void 0,(0,le.Z)("radio","Cached"))))))))}}const sK=iK;var oK;function aK(e,t,n,i){oK||(oK="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:oK,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const rK=[D.kWebpagesPictureInPictureButtonEnabled],lK=nt.Z.getEventHandler;class dK extends tn.Component{render(){return aK(jE.Z,{filter:this.props.filter},void 0,aK("div",{className:"setting-group unlimited"},void 0,aK("div",{className:"setting-single"},void 0,aK("label",{},void 0,aK("input",{type:"checkbox",checked:this.props.prefValues[D.kWebpagesPictureInPictureButtonEnabled],onChange:lK(D.kWebpagesPictureInPictureButtonEnabled)}),aK("span",{},void 0,(0,le.Z)("Picture-in-Picture Button on Videos"))),aK("p",{className:"info"},void 0,(0,le.Z)("This setting requires a restart to take effect.")))))}}const cK=(0,fs.Z)(dK,rK);var hK;function pK(e,t,n,i){hK||(hK="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:hK,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const uK=[D.kWebpagesAllowSelectionInLinks],gK=nt.Z.getEventHandler;class mK extends tn.Component{render(){return pK(jE.Z,{filter:this.props.filter},void 0,pK("div",{className:"setting-group unlimited"},void 0,pK("div",{className:"setting-single"},void 0,pK("label",{},void 0,pK("input",{type:"checkbox",checked:this.props.prefValues[D.kWebpagesAllowSelectionInLinks],onChange:gK(D.kWebpagesAllowSelectionInLinks)}),pK("span",{},void 0,(0,le.Z)("Allow Text Selection in Links"))))))}}const vK=(0,fs.Z)(mK,uK);var fK;function yK(e,t,n,i){fK||(fK="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:fK,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const wK=[D.kWebpagesSmoothScrollingEnabled],bK=nt.Z.getEventHandler;class CK extends tn.Component{render(){return yK(jE.Z,{filter:this.props.filter},void 0,yK("div",{className:"setting-group unlimited"},void 0,yK("div",{className:"setting-single"},void 0,yK("label",{},void 0,yK("input",{type:"checkbox",checked:this.props.prefValues[D.kWebpagesSmoothScrollingEnabled],onChange:bK(D.kWebpagesSmoothScrollingEnabled)}),yK("span",{},void 0,(0,le.Z)("Smooth Scrolling"))),yK("p",{className:"info"},void 0,(0,le.Z)("This setting requires a restart to take full effect.")))))}}const SK=(0,fs.Z)(CK,wK);var TK;function IK(e,t,n,i){TK||(TK="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:TK,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const kK=[D.kWebpagesSpatialNavigationEnabled],AK=nt.Z.getEventHandler;class ZK extends tn.Component{render(){return IK(jE.Z,{filter:this.props.filter},void 0,IK("div",{className:"setting-group"},void 0,IK("div",{className:"setting-single"},void 0,IK("h3",{},void 0,(0,le.Z)("Spatial Navigation")),IK("p",{className:"info"},void 0,(0,le.Z)("Navigate between links and elements by holding shift and pressing the arrow keys.")),IK("label",{},void 0,IK("input",{type:"checkbox",checked:this.props.prefValues[D.kWebpagesSpatialNavigationEnabled],onChange:AK(D.kWebpagesSpatialNavigationEnabled)}),IK("span",{},void 0,(0,le.Z)("spatial navigation","Enabled"))))))}}const EK=(0,fs.Z)(ZK,kK);var _K;function NK(e,t,n,i){_K||(_K="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:_K,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const MK=nt.Z.getEventHandler,PK=[D.kWebpagesTabFocusesLinks];var DK=NK("input",{type:"radio",value:"false"}),xK=NK("input",{type:"radio",value:"true"});class OK extends tn.Component{render(){return NK(jE.Z,{filter:this.props.filter},void 0,NK("div",{className:"setting-group"},void 0,NK("div",{className:"setting-single"},void 0,NK("h3",{},void 0,(0,le.Z)("Webpage Focus")),NK("p",{className:"info"},void 0,(0,le.Z)("This setting takes effect in new tabs or windows only.")),NK(ws,{name:"tabToFocusSetting",className:"setting-single",value:this.props.prefValues[D.kWebpagesTabFocusesLinks],onChange:MK(D.kWebpagesTabFocusesLinks,"convert")},void 0,NK("div",{className:"setting-single"},void 0,NK("label",{},void 0,DK,NK("span",{},void 0,(0,le.Z)("Focus Forms Only")))),NK("div",{className:"setting-single"},void 0,NK("label",{className:"setting-single"},void 0,xK,NK("span",{},void 0,(0,le.Z)("Focus All Controls and Links"))))))))}}const LK=(0,fs.Z)(OK,PK);var RK;function BK(e,t,n,i){RK||(RK="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:RK,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const FK=[D.kWebpagesTranslateSelectionButtonEnabled],UK=nt.Z.getEventHandler;class VK extends tn.Component{render(){return BK(jE.Z,{filter:this.props.filter},void 0,BK("div",{className:"setting-group unlimited"},void 0,BK("div",{className:"setting-single"},void 0,BK("label",{},void 0,BK("input",{type:"checkbox",checked:this.props.prefValues[D.kWebpagesTranslateSelectionButtonEnabled],onChange:UK(D.kWebpagesTranslateSelectionButtonEnabled)}),BK("span",{},void 0,(0,le.Z)("Show Selected Text Translate Button"))))))}}const WK=(0,fs.Z)(VK,FK);var HK;function zK(e,t,n,i){HK||(HK="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:HK,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class GK extends tn.Component{render(){return zK(a_,{categoryTitle:(0,le.Z)("Webpages"),filter:this.props.filter},void 0,(0,fn.jsx)(SK,{...this.props}),(0,fn.jsx)(z$,{...this.props}),(0,fn.jsx)(cK,{...this.props}),(0,fn.jsx)(vK,{...this.props}),(0,fn.jsx)(WK,{...this.props}),(0,fn.jsx)(LK,{...this.props}),(0,fn.jsx)(EK,{...this.props}),(0,fn.jsx)(B$,{...this.props}),(0,fn.jsx)(Q$,{...this.props}),(0,fn.jsx)(sK,{...this.props}),(0,fn.jsx)(P$,{...this.props}))}}const $K=GK;var KK;function jK(e,t,n,i){KK||(KK="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:KK,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const YK=St.jk.settingCategories,XK="http://example.com/?path=",QK=[D.kMailIsTurnedOff,D.kThemesPreview,D.kThemesUser];function qK(e){const t=(0,Ni.DP)(e),n=t.query,i=n?"all":t.path,s=i&&i.split("/");let o;if(!n&&s&&s.length>0&&YK[s[0]]&&(o=YK[s[0]],s.length>1)){const e=s.join("_");o=YK[e]}return o||(n?YK.all:YK.general)}function JK(e){return(0,Ni.DP)(e)?.search||""}var ej=jK("svg",{className:"guest-intro-background",viewBox:"0 0 1244 860"},void 0,jK("path",{fill:"url(#guest-intro-bg-gradient)",d:"M0 0h153.513c16.141 27.93 32.15 55.734 47.912 83.11 16.086 27.94 32.722 56.832 49.076 85.128 11.01 19.031 22.079 38.316 32.781 56.967 25.186 43.883 51.228 89.259 77.402 132.848 33.382 55.651 75.894 82.121 137.77 85.829 3.205.192 6.454.288 9.655.288 39.673 0 78.14-14.461 108.316-40.722 21.644-18.834 48.687-52.291 54.604-104.667.749-6.654 1.357-13.708 1.855-19.573-1.07-29.74-6.476-52.92-17.294-74.518C622.935 139.46 612.708 67.99 625.087 0h136.676C747.1 44.93 749.845 96.364 774.32 145.251c20.839 41.6 30.654 85.7 31.485 138.023-.568 6.192-1.472 18.273-2.83 30.356-17.572 155.524-149.172 263.318-294.866 263.318-5.816 0-11.67-.173-17.526-.521C382.84 569.97 301.9 518.174 246.822 426.358c-38.015-63.313-74.255-127.68-111.253-191.634C90.359 156.507 45.49 78.062 0 0zm1113.47 0H1244v140.1c-7.496 27.86-18.849 54.995-34.031 81.275a1299530.57 1299530.57 0 0 1-170.255 294.799A1223193.145 1223193.145 0 0 0 841.018 860.24H687.72c135.675-235.123 271.527-470.147 407.26-705.25 22.311-38.621 31.22-79.696 25.368-124.548A170.12 170.12 0 0 0 1113.471 0z"}));function tj(e){return jK("div",{className:"guest-intro"},void 0,ej,jK("div",{className:"guest-intro-content"},void 0,jK("h1",{},void 0,(0,le.Z)("Settings Unavailable")),jK("p",{},void 0,(0,le.Z)("Settings are not available in guest windows.")),jK("p",{},void 0,jK("a",{tabIndex:0,href:hk,onClick:t=>pk(e.windowId,t)},void 0,(0,le.Z)("Learn more about Guest Profiles")))))}class nj extends tn.Component{static contextType=dn.Z;refFocusTrap=tn.createRef();refSidebar=tn.createRef();refContent=tn.createRef();state={category:qK(this.props.url),filter:JK(this.props.url),showThemePreview:void 0};static getDerivedStateFromProps(e,t){return e.url.startsWith(XK)?null:{category:qK(e.url)}}componentDidMount(){const{document:e,vivaldiWindowId:t}=this.context;z.ZP.isSettings(t)&&(e.title=this.getWindowTitle()),this.scrollToAnchor(this.props.url),this.focusFilterInput()}componentDidUpdate(e,t){const{document:n,vivaldiWindowId:i}=this.context;if(z.ZP.isSettings(i)&&t.category!==this.state.category&&(n.title=this.getWindowTitle()),t.category!==this.state.category&&this.scrollTop(),e.prefValues[D.kThemesPreview]?.length<this.props.prefValues[D.kThemesPreview]?.length){const{name:t,id:n}=this.props.prefValues[D.kThemesPreview][0];z.ZP.isSettings(this.context.vivaldiWindowId)&&z.ZP.isActive(this.context.vivaldiWindowId)?this.setState({showThemePreview:{themeName:t,isUpdate:this.props.prefValues[D.kThemesUser].findIndex((e=>e.id===n))>-1}}):e.prefValues[D.kThemesPreview].length<this.props.prefValues[D.kThemesPreview].length&&this.closeThemePreview()}}componentWillUnmount(){0}closeThemePreview=()=>this.setState({showThemePreview:void 0});focusFilterInput=()=>this.refSidebar.current?.focus();scrollToAnchor=e=>{const{HTMLElement:t}=this.context,n=function(e){const t=(0,Ni.DP)(e);return t.scroll?t.scroll:""}(e);if(!n)return;const i=this.refFocusTrap.current?.focusRef.current;if(!(i instanceof t))return;const s=i.querySelector(`[data-anchor='${n}']`);s&&s.scrollIntoView()};onMacMenuAction=(e,t,n)=>{this.context.vivaldiWindowId===e&&U.Z.isActionWhitelistedForSettings(t)&&a.Z.executeActions(e,t)};getWindowTitle=()=>this.state.category?(0,le.Z)("Vivaldi Settings: $1",[this.state.category.title]):(0,le.Z)("Vivaldi Settings");show=e=>{const t=this.state.category&&this.state.category===YK.all,n=this.state.category&&this.state.category===e;return t||n};onSettingsFilterChange=e=>{this.setState({filter:e}),this.state.category!==YK.all&&this._setCategory("all")};setCategory=e=>{this.setState({filter:""}),this._setCategory(e)};scrollTop=()=>{this.refContent.current&&(this.refContent.current.scrollTop=0)};_setCategory=e=>{const t=this.context.vivaldiWindowId;z.ZP.isSettings(t)?this.setState({category:YK[e]}):Y.Z.openURL(t,St.jk.internalUrl("settings",e),{inCurrent:!0})};render(){if(z.ZP.isGuestSession(this.context.vivaldiWindowId))return jK(tj,{windowId:this.context.vivaldiWindowId});const{filter:e}=this.state,t=e.length>=2?e:"",n=!this.props.prefValues[D.kMailIsTurnedOff];return(0,fn.jsxs)(vs.Z,{ref:this.refFocusTrap,focusName:"focus_settings",className:"vivaldi-settings",children:[jK("header",{className:"settings-header"},void 0,jK("h1",{},void 0,this.getWindowTitle())),jK(pV,{focusRef:this.refSidebar,filter:this.state.filter,onFilterChange:this.onSettingsFilterChange,selectedCategory:this.state.category,onCategorySelected:this.setCategory}),this.state.category&&(0,fn.jsxs)("div",{className:"settings-content",ref:this.refContent,children:[this.show(YK.general)&&(0,fn.jsxs)(fn.Fragment,{children:[jK("section",{className:"setting-section"},void 0,jK(MW,{filter:t})),jK("section",{className:"setting-section"},void 0,jK(V_,{filter:t})),jK("section",{className:"setting-section"},void 0,jK(yD,{filter:t})),jK("section",{className:"setting-section"},void 0,jK(yP,{filter:t})),jK(SU,{name:YK.general.title,filter:t,prefPaths:[D.kAcceptLanguages,D.kCalendarDateFormat,D.kCalendarStartOfWeek,D.kCalendarWeekNumberRule,D.kConfirmToQuitEnabled,D.kHomepage,D.kHomepageCache,D.kStartupCheckIsDefault,D.kSystemShowExitConfirmationDialog,D.kTabsAlwaysLoadPinnedAfterRestore,D.kTabsDeferLoadingAfterRestore,D.kTranslateEnabled,D.kURLsToRestoreOnStartup,D.kWelcomeReadPages,D.kWelcomeSeenPages,D.kWindowsShowWindowCloseConfirmationDialog]})]}),this.show(YK.appearance)&&(0,fn.jsxs)(fn.Fragment,{children:[jK("section",{className:"setting-section"},void 0,jK(L_,{filter:t})),jK("section",{className:"setting-section"},void 0,jK($B,{filter:t})),jK(SU,{name:YK.appearance.title,filter:t,prefPaths:[D.kAppearanceCssUiModsDirectory,D.kAppearanceHudEnabled,D.kAppearanceRangeButtons,D.kMenuDisplay,D.kMenuIconType,D.kPopupsShowInTab,D.kSettingsInTab,D.kStatusBarDisplay,D.kStatusBarMinimized,D.kThemeUseAnimation,D.kToolbarsNavigation,D.kToolbarsStatus,D.kWindowsLinuxAltControls,D.kWindowsUseNativeDecoration]})]}),this.show(YK.themes)&&(0,fn.jsxs)(fn.Fragment,{children:[jK("section",{className:"setting-section"},void 0,jK(m$,{filter:t})),jK("section",{className:"setting-section"},void 0,jK(tU,{filter:t}),jK(PP,{filter:t})),jK(SU,{name:YK.themes.title,filter:t,prefPaths:[D.kHueBridgeIp,D.kHueEnabled,D.kHueLights,D.kHueUsername,D.kRazerChromaDevices,D.kRazerChromaEnabled,D.kSystemAccentColor,D.kThemeScheduleEnabled,D.kThemeScheduleOS,D.kThemeScheduleTimeline,D.kThemesCurrent,D.kThemesCurrentPrivate,D.kThemesPreview,D.kThemesSystem,D.kThemesUser]})]}),this.show(YK.startpage)&&(0,fn.jsxs)(fn.Fragment,{children:[jK("section",{className:"setting-section"},void 0,jK(OV,{filter:t})),jK(SU,{name:YK.startpage.title,filter:t,prefPaths:[D.kStartpageNavigation,D.kStartpageSpeedDialAddButtonVisible,D.kStartpageSpeedDialAllowDnd,D.kStartpageSpeedDialColumns,D.kStartpageSpeedDialControlsVisible,D.kStartpageSpeedDialDeleteVisible,D.kStartpageSpeedDialFaviconVisible,D.kStartpageSpeedDialGameButtonShow,D.kStartpageSpeedDialPrivacyStatsShow,D.kStartpageSpeedDialTitlesVisible,D.kStartpageSpeedDialWidth]})]}),this.show(YK.tabs)&&(0,fn.jsxs)(fn.Fragment,{children:[jK("section",{className:"setting-section"},void 0,jK(_G,{filter:t})),jK(SU,{name:YK.tabs.title,filter:t,prefPaths:[D.kMouseWheelTabSwitch,D.kTabsActivationOnClone,D.kTabsActivationOnClose,D.kTabsActivationPreferRelated,D.kTabsActiveMinSize,D.kTabsAlignNext,D.kTabsAtEdge,D.kTabsAutoMuting,D.kTabsBarPosition,D.kTabsBarWidth,D.kTabsCloseButtonLeft,D.kTabsCloseButtonPermanent,D.kTabsClosePinned,D.kTabsCounterDetection,D.kTabsCycleByRecentOrder,D.kTabsDimHibernated,D.kTabsDoubleClickClose,D.kTabsFocusWebview,D.kTabsHorizontalScrolling,D.kTabsMinimize,D.kTabsNeverCloseLast,D.kTabsNewPageCustomUrl,D.kTabsNewPageLink,D.kTabsNewPlacement,D.kTabsOpenNewInBackground,D.kTabsPageLoadInfo,D.kTabsSelectionEnabled,D.kTabsSelectionIncludeActive,D.kTabsShowCloseButton,D.kTabsShowSeparator,D.kTabsShowSyncedTabsButton,D.kTabsShowTrashCan,D.kTabsStackingAllowDnd,D.kTabsStackingAutoExpand,D.kTabsStackingDndDelay,D.kTabsStackingMode,D.kTabsStackingMode,D.kTabsStackingOpenInCurrent,D.kTabsStackingPreferDotted,D.kTabsThumbnails,D.kTabsTooltip,D.kTabsUnread,D.kTabsVisible,D.kTabsVisualSwitchEnable,D.kTabsVisualSwitchListLayout]})]}),this.show(YK.panel)&&(0,fn.jsxs)(fn.Fragment,{children:[jK("section",{className:"setting-section"},void 0,jK(TF,{filter:t})),jK(SU,{name:YK.panel.title,filter:t,prefPaths:[D.kMailContactDefaultAction,D.kMailSingleClickTabs,D.kNotesCreationAddScreenshot,D.kNotesCreationNotify,D.kNotesCreationShowPanel,D.kPanelsAsOverlayAutoClose,D.kPanelsAsOverlayEnabled,D.kPanelsLazyLoad,D.kPanelsPosition,D.kPanelsShowFolderBadge,D.kPanelsShowToggle,D.kPanelsTranslatePaste,D.kPanelsTranslateRedirect,D.kPanelsWindowDragToStack,D.kPanelsWindowShowPinnedGroup,D.kPanelsWindowShowUnread,D.kPanelsWindowSingleClickOpens,D.kReadingListPanelSingleClickOpens,D.kReadingListShowCounter]})]}),this.show(YK.addressbar)&&(0,fn.jsxs)(fn.Fragment,{children:[jK("section",{className:"setting-section"},void 0,jK(v_,{filter:t})),jK(SU,{name:YK.addressbar.title,filter:t,prefPaths:[D.kAddressBarAutocompleteEnabled,D.kAddressBarAutocompletePreferBookmarks,D.kAddressBarAutocompleteSuffixExpansionEnabled,D.kAddressBarAutocompleteSuffixExpansionValue,D.kAddressBarExtensionsRenderInDropdown,D.kAddressBarExtensionsShowAllToggle,D.kAddressBarHighlightBaseDomain,D.kAddressBarOmniboxCutcopyEncoded,D.kAddressBarOmniboxEnabled,D.kAddressBarOmniboxShowBookmarks,D.kAddressBarOmniboxShowBrowserHistory,D.kAddressBarOmniboxShowSearchHistory,D.kAddressBarOmniboxShowTopSites,D.kAddressBarOmniboxShowTypedHistory,D.kAddressBarPosition,D.kAddressBarSelectOnClick,D.kAddressBarShowFullUrl,D.kAddressBarShowProfile,D.kAddressBarShowProgress,D.kAddressBarShowQrGenerator,D.kAddressBarShowReadingList,D.kAddressBarStripJavascriptOnPaste,D.kAddressBarUrlOpenShortcut,D.kAddressBarVisible]})]}),this.show(YK.bookmarks)&&(0,fn.jsxs)(fn.Fragment,{children:[jK("section",{className:"setting-section"},void 0,jK(CN,{filter:t}),jK(mN,{filter:t})),jK(SU,{name:YK.bookmarks.title,filter:t,prefPaths:[D.kBookmarksBarDisplay,D.kBookmarksBarPosition,D.kBookmarksBarVisible,D.kBookmarksConfirmAdding,D.kBookmarksConfirmOpening,D.kBookmarksConfirmOpeningThreshold,D.kBookmarksFetchPageMetadata,D.kBookmarksOpenInNewTab,D.kBookmarksSingleClickOpens,D.kBookmarksUnderlineMenuLetter]})]}),this.show(YK.qc)&&(0,fn.jsxs)(fn.Fragment,{children:[jK("section",{className:"setting-section"},void 0,jK(jF,{filter:t,category:this.state.category})),jK(SU,{name:YK.qc.title,filter:t,prefPaths:[D.kQuickCommandsKeepValue,D.kQuickCommandsLimitResults,D.kQuickCommandsMatchNickname,D.kQuickCommandsOpenUrlInNewTab,D.kQuickCommandsSearchEnglish,D.kQuickCommandsSearchPriority,D.kQuickCommandsShowBookmarks,D.kQuickCommandsShowCalculator,D.kQuickCommandsShowExtensions,D.kQuickCommandsShowHistory,D.kQuickCommandsShowNotes,D.kQuickCommandsShowPageActions,D.kQuickCommandsShowReadingList,D.kQuickCommandsUseNotesManager]})]}),this.show(YK.keyboard)&&(0,fn.jsxs)(fn.Fragment,{children:[jK("section",{className:"setting-section"},void 0,jK(sD,{filter:t,view:"editable"})),jK(SU,{name:YK.keyboard.title,filter:t,prefPaths:[D.kChainedCommandsCommandList,D.kKeyboardShortcutsAltOpensMenu,D.kKeyboardShortcutsEnable,D.kKeyboardShortcutsEnableSingleKey,D.kKeyboardShortcutsEnableSingleKeyForMail,D.kKeyboardShortcutsSpaceFastForwards,D.kKeyboardTabToAll,D.kKeyboardTabToAllUsesSystemDefault,D.kSystemMacKeyboardUiMode,D.kWebpagesAccessKeys,D.kWebpagesFocusTrap]})]}),this.show(YK.mouse)&&(0,fn.jsxs)(fn.Fragment,{children:[jK("section",{className:"setting-section"},void 0,jK(dF,{filter:t,category:this.state.category})),jK(SU,{name:YK.mouse.title,filter:t,prefPaths:[D.kMouseGesturesAltGesturesEnabled,D.kMouseGesturesDoubleClickMenuEnabled,D.kMouseGesturesEnabled,D.kMouseGesturesRockerGesturesEnabled,D.kMouseGesturesStrokeTolerance]})]}),this.show(YK.search)&&(0,fn.jsxs)(fn.Fragment,{children:[jK("section",{className:"setting-section"},void 0,jK(nV,{filter:t})),jK(SU,{name:YK.search.title,filter:t,prefPaths:[D.kAddressBarInlineSearchEnabled,D.kAddressBarInlineSearchSuggestEnabled,D.kAddressBarInlineSearchSuggestOnNickname,D.kAddressBarSearchAllowExtensionOverride,D.kAddressBarSearchDisplay,D.kAddressBarSearchInNewTab,D.kAddressBarSearchKeepSelected,D.kAddressBarSearchShowFavicon,D.kAddressBarSearchSuggestEnabled,D.kPageSearchInBackground,D.kStartpageSpeedDialDisplaySearch]})]}),this.show(YK.privacy)&&(0,fn.jsxs)(fn.Fragment,{children:[jK("section",{className:"setting-section"},void 0,jK(UF,{filter:t})),jK("section",{className:"setting-section"},void 0,jK($M,{filter:t})),jK("section",{className:"setting-section"},void 0,jK(aV,{filter:t})),jK("section",{className:"setting-section"},void 0,jK(FU,{filter:t})),jK("section",{className:"setting-section"},void 0,jK(rP,{filter:t})),jK(SU,{name:YK.privacy.title,filter:t,prefPaths:[D.kAddressBarInlineSearchEnabled,D.kAddressBarInlineSearchSuggestEnabled,D.kAddressBarSearchSuggestEnabled,D.kAddressBarSearchTypedHistoryEnabled,D.kAddressBarTypedHistoryEnabled,D.kAllowJavascriptAppleEvents,D.kAlternateErrorPagesEnabled,D.kCredentialsEnableService,D.kEnableDoNotTrack,D.kHistoryDaysToKeepVisits,D.kIncognitoShowIntro,D.kPrivacyAdverseAdBlockEnabled,D.kPrivacyAutofillServerAssist,D.kPrivacyGoogleComponentExtensionsCryptoToken,D.kPrivacyGoogleComponentExtensionsHangoutServices,D.kPrivacyGoogleComponentExtensionsWebStore,D.kSafeBrowsingEnabled,D.kSavingBrowserHistoryDisabled,D.kWebRTCIPHandlingPolicy]})]}),this.show(YK.downloads)&&(0,fn.jsxs)(fn.Fragment,{children:[jK("section",{className:"setting-section"},void 0,jK(uP,{filter:t})),jK(SU,{name:YK.downloads.title,filter:t,prefPaths:[D.kDownloadDefaultDirectory,D.kDownloadsNotifyOnComplete,D.kDownloadsOpenPanelOnNew,D.kDownloadsStartAutomatically,D.kDownloadsUpdateDefaultDownloadWhenSavingAs,D.kDownloadsUsePopout]})]}),this.show(YK.sync)&&jK("section",{className:"setting-section"},void 0,jK(FH,{url:this.props.url,category:this.state.category,filter:t})),this.show(YK.webpages)&&(0,fn.jsxs)(fn.Fragment,{children:[jK("section",{className:"setting-section"},void 0,jK($K,{filter:t})),jK("section",{className:"setting-section"},void 0,jK(C$,{filter:t})),jK("section",{className:"setting-section"},void 0,jK(yU,{prefs:!0,filter:t})),jK("section",{className:"setting-section"},void 0,jK(bM,{filter:t})),jK("section",{className:"setting-section"},void 0,jK(ZP,{filter:t})),jK(SU,{name:YK.webpages.title,filter:t,prefPaths:[D.kHardwareAccelerationModeEnabled,D.kMouseWheelPageZoom,D.kPageImageLoading,D.kPluginsAlwaysOpenPdfExternally,D.kPluginsWidevineEnabled,D.kWebKitCursiveFontFamily,D.kWebKitDefaultFontSize,D.kWebKitFantasyFontFamily,D.kWebKitFixedFontFamily,D.kWebKitMinimumFontSize,D.kWebKitSansSerifFontFamily,D.kWebKitSerifFontFamily,D.kWebKitStandardFontFamily,D.kWebpagesAllowSelectionInLinks,D.kWebpagesCaptureDirectory,D.kWebpagesCaptureSaveFilePattern,D.kWebpagesFullScreenHideMouse,D.kWebpagesFullScreenShowBubble,D.kWebpagesPictureInPictureButtonEnabled,D.kWebpagesSmoothScrollingEnabled,D.kWebpagesSpatialNavigationEnabled,D.kWebpagesTabFocusesLinks,D.kWebpagesTabZoomEnabled,D.kWebpagesTranslateSelectionButtonEnabled]})]}),this.show(YK.network)&&jK("section",{className:"setting-section"},void 0,jK(uF,{filter:t})),n&&this.show(YK.rss)&&jK("section",{className:"setting-section"},void 0,jK(XL,{filter:t})),n&&this.show(YK.mail)&&jK("section",{className:"setting-section"},void 0,jK(RL,{filter:t})),n&&this.show(YK.calendar)&&jK("section",{className:"setting-section"},void 0,jK(Tx,{filter:t,windowId:z.Ex,pageId:-1}),jK(nO,{filter:t,windowId:z.Ex,pageId:-1}),jK(cM,{filter:t})),!1,n&&this.show(YK.mail)&&(0,fn.jsxs)(fn.Fragment,{children:[jK("section",{className:"setting-section"},void 0,jK(WR,{filter:t})),jK("section",{className:"setting-section"},void 0,jK(dB,{filter:t})),jK("section",{className:"setting-section"},void 0,jK(wR,{windowId:this.context.vivaldiWindowId,filter:t}))]}),this.show(YK.biscuit)&&jK("section",{className:"setting-section"},void 0,jK(iN,{filter:t})),!1]}),this.state.showThemePreview&&jK(Al,{onClose:this.closeThemePreview,themeName:this.state.showThemePreview.themeName,isUpdate:this.state.showThemePreview.isUpdate})]})}}const ij=(0,fs.Z)(nj,QK);class sj{#A;#Z=0;#E=(0,fa.aV)();#_=new Event("undoredo");undoDisabled=!0;redoDisabled=!0;constructor(e=500){if(e<1)throw new Error("Stack size must be greater than 0");this.#A=e}record(e){this.#E=this.#E.slice(this.#Z,this.#A-1+this.#Z).unshift(e),this.#Z=0,this._onChange()}clear(){this.#E=(0,fa.aV)(),this.#Z=0,this._onChange()}undo(){this.undoDisabled||(this.#E.get(this.#Z)?.undo(),this.#Z+=1,this._onChange(),document.dispatchEvent(this.#_))}redo(){this.redoDisabled||(this.#Z-=1,this.#E.get(this.#Z)?.redo(),this._onChange(),document.dispatchEvent(this.#_))}_onChange(){this.undoDisabled=this.#Z===this.#E.size,this.redoDisabled=0===this.#Z}}class oj{#N;#M;constructor(e,t,n){this.#N=e,this.#M=t,this._updateFunction=n}undo(){this._updateFunction(this.#N)}redo(){this._updateFunction(this.#M)}}var aj,rj=n(64626);class lj{cut=i.Z.cut;copy=i.Z.copy;constructor(){this.undoStack=new sj}undo(){this.undoStack.undo()}redo(){this.undoStack.redo()}clearUndoStack(){this.undoStack.clear()}async paste(e,t,n){const s=en.ZP.getCutIds(),o=s.length>0?en.ZP.getItemById(s[0]).parentId:"",a=await i.Z.paste(e,t,n),{isCut:r,ids:l}=a;return this.undoStack.record(new oj({sourceId:o,isCut:r,ids:l},{sourceId:o,targetId:t,isCut:r,ids:l},(e=>{e.targetId?i.Z.move(e.ids,e.targetId,0):r?i.Z.move(e.ids,e.sourceId,0):i.Z.remove(e.ids)}))),a}async create(e){const t=await y.Z.bookmarks.create(e);if(t)return this.undoStack.record(new oj({createdId:t.id,remove:!0},{createdId:t.id,parentId:t.parentId},(e=>{e.remove?i.Z.remove([e.createdId]):i.Z.move([e.createdId],e.parentId||"",t.index||0)}))),t}async createWithPromise(e,t,n){const s=await i.Z.createWithPromise(e,t,n),o=s.map((e=>e.id));return this.undoStack.record(new oj({createdIds:o,parentId:t,index:n,remove:!0},{createdIds:o,parentId:t,index:n},(e=>{e.remove?i.Z.remove(e.createdIds):i.Z.move(e.createdIds,e.parentId,e.index||0)}))),s}update(e,t){const n=en.ZP.getItemById(e);return y.Z.bookmarks.update(e,t).then((i=>(this.undoStack.record(new oj({nodeId:e,item:(0,rj.Z)(n,Object.keys(t))},{nodeId:e,item:t},(e=>{y.Z.bookmarks.update(e.nodeId,e.item)}))),i)))}async mergeWithPromise(e,t,n){const i=(await this.createWithPromise([{parentId:e.parentId,children:[],title:n}],e.parentId||"",0))[0].id;return await this.move([e.id,t.id],i,0),i}async move(e,t,n){const s=e.length>0?en.ZP.getItemById(e[0]).parentId:"",o=await i.Z.move(e,t,n);return this.undoStack.record(new oj({ids:e,parentId:s,index:0},{ids:e,parentId:t,index:n},(e=>{i.Z.move(e.ids,e.parentId,e.index)}))),o}async reorder(e,t){const n={nodeId:t,order:en.ZP.getItemById(t).children.map((e=>e.id))},s=await i.Z.reorder(e,t);return this.undoStack.record(new oj(n,{nodeId:t,order:e},(e=>{i.Z.reorder(e.order,e.nodeId)}))),s}async remove(e=[]){if(0===e.length)return;const t={removed:e,parentId:en.ZP.getItemById(e[0]).parentId};await i.Z.remove(e),this.undoStack.record(new oj(t,{ids:e},(e=>{e.removed?i.Z.move(e.removed,e.parentId||"",0):i.Z.remove(e.ids)})))}async duplicate(e,t,n){const s=await i.Z.duplicate(e,t,n);return this.undoStack.record(new oj({ids:s,remove:!0},{ids:s,parentId:t,index:n},(e=>{e.remove?i.Z.remove(e.ids):i.Z.move(e.ids,e.parentId,e.index)}))),s}async createBookmarks(e,t,n){const s=await i.Z.createBookmarks(e,t,n);return this.undoStack.record(new oj({ids:s,remove:!0},{ids:s,parentId:t,index:n},(e=>{e.remove?i.Z.remove(e.ids):i.Z.move(e.ids,e.parentId,e.index)}))),s}onDropEvent(e,t,n,i){if(e.dataTransfer.types.includes(Jt.yR)){const s=JSON.parse(e.nativeEvent.dataTransfer.getData(Jt.yR));Jt.ZP.isCopyModifierPressed(e)||i&&i.disableMove?this.duplicate(s,t,n):this.move(s,t,n)}else Jt.ZP.getUrlsFromEventPromise(e,!0).then((e=>this.createBookmarks(e,t,n)))}}function dj(e,t,n,i){aj||(aj="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:aj,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class cj extends tn.PureComponent{_imageElementKey=0;_reloadRetryCount=0;componentDidUpdate(e){e.src!==this.props.src&&this.finishErrorRecovery()}componentWillUnmount(){this.finishErrorRecovery()}finishErrorRecovery(){this._reloadRetryCount=0,void 0!==this._reloadRetryTimer&&(clearTimeout(this._reloadRetryTimer),this._reloadRetryTimer=void 0)}onImageError=()=>{if(void 0!==this._reloadRetryTimer)return;if(this._reloadRetryCount>=4)return void(4===this._reloadRetryCount&&(this._reloadRetryCount=5,this.props.onImageLoadError&&this.props.onImageLoadError(this.props.src)));this._reloadRetryCount++;const e=1e3*Math.pow(2,this._reloadRetryCount);this._reloadRetryTimer=setTimeout(this.onTryReload,e)};onTryReload=()=>{this._reloadRetryTimer=void 0,this._imageElementKey++,this.forceUpdate()};render(){const e=this.props.className||"thumbnail-image";return this.props.src?dj("div",{className:e,style:{height:this.props.thumbnailHeight,width:this.props.thumbnailWidth},onPointerEnter:this.props.onPointerEnter,onPointerLeave:this.props.onPointerLeave,onPointerDown:this.props.onPointerDown,onPointerUp:this.props.onPointerUp},void 0,dj("img",{width:"100%",height:"auto",src:this.props.src,onError:this.onImageError},this._imageElementKey)):dj("div",{className:e,style:{height:this.props.thumbnailHeight,width:this.props.thumbnailWidth},onPointerEnter:this.props.onPointerEnter,onPointerLeave:this.props.onPointerLeave,onPointerDown:this.props.onPointerDown,onPointerUp:this.props.onPointerUp,dangerouslySetInnerHTML:this.props.isFolder?{__html:cn.feS}:{__html:cn.lrx}})}}const hj=cj,pj=new class{setBackgroundTasks(e){l.Z.dispatch({actionType:"BACKGROUND_TASKS_SET",tasks:e})}};const uj=function(e,t,n,i,s,o){this.id=e,this.title=n,this.description=s,this.menuItems=o,this.progress=0,this.text=t},gj="thumbnailCapture";const mj=new class{pendingEntries=[];activeEntries=[];tasks=[];add=(e,t,n)=>{this.pendingEntries.push({id:e,url:t,callback:n})};run=()=>{for(;;){if(this.activeEntries.length>=1)return;if(0===this.pendingEntries.length)return void(0===this.activeEntries.length&&(this.removeFromArrayById(gj,this.tasks),pj.setBackgroundTasks(this.tasks)));const e=this.pendingEntries.shift();this.activeEntries.push(e);let t=this.getFromArrayById(gj,this.tasks);t||(t=new uj(gj,"","Thumbnail Capture","",[{name:(0,le.Z)("Cancel"),handler:function(){this.pendingEntries=[]}.bind(this)}]),this.tasks.push(t)),t.title=(0,le.Z)("Updating thumbnail for $1",[e.url]),t.description=(0,le.Z)("$1 bookmark waiting for update.","$1 bookmarks waiting for update.",[this.pendingEntries.length]),t.text=this.pendingEntries.length+this.activeEntries.length,pj.setBackgroundTasks(this.tasks),e.callback.call(null,e.id,e.url)}};onLoaded=e=>{this.removeFromArrayById(e,this.activeEntries),this.run()};contains=e=>this.isInArrayById(e,this.pendingEntries)||this.isInArrayById(e,this.activeEntries);getFromArrayById=(e,t)=>t.find((t=>t.id===e));isInArrayById=(e,t)=>t.length&&void 0!==this.getFromArrayById(e,t);removeFromArrayById=(e,t)=>{const n=t.findIndex((t=>t.id===e));-1!==n&&t.splice(n,1)}};let vj=0;const fj=new Map,yj={getPageThumbnail(e,t,n){vj>4||(vj++,e.getThumbnail(wj(t),(e=>{vj--,y.Z.runtime.lastError?n(void 0):n(e||void 0)})))},updateForBookmark(e,t){this.updateForBookmarks([{id:e,url:t}])},updateForBookmarks(e){for(const t of e){const e=t.url;e&&!mj.contains(t.id)&&(mj.add(t.id,St.jk.getUrl(e),bj),Cj(t.id))}mj.run()},linkAndQueryUpdatingBookmark:(e,t)=>t?(fj.set(e,t),mj.contains(t)):(fj.delete(e),!1),unlinkBookmarkComponent(e){fj.delete(e)}},wj=e=>e.compact?{width:330,height:270}:{width:440,height:360},bj=(e,t)=>{const n={bookmarkId:e,url:t};d.Z.thumbnails.captureBookmark(n).then((t=>{mj.onLoaded(e),Cj(e)}))};function Cj(e){for(const[t,n]of fj)n===e&&t.forceUpdate()}const Sj=yj;var Tj,Ij=n(34155);function kj(e,t,n,i){Tj||(Tj="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Tj,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Aj="BookmarkEditor",Zj=[D.kBookmarksBarVisible];var Ej=kj("input",{type:"submit",hidden:!0});class _j extends tn.Component{static contextType=dn.Z;refTitle=tn.createRef();refUrlField=tn.createRef();_isCreating=!1;_isMounted=!1;_transitionState="idle";_disableSaveOnBlur=!1;state={id:"",title:"",url:"",nickname:"",description:"",thumbnail:"",speeddial:!1,isFolder:!1,isTrash:!1,isSeparator:!1,dateAdded:null,editUrl:null,dataChanged:!1,autocompleteValue:""};componentDidMount(){this._isMounted=!0,$C.Z.addListener(this._onUrlbarStoreChanged),en.ZP.addListener(this.onBookmarkStoreChange)}componentDidUpdate(e,t){t.id!==this.state.id&&this.resetUrlField()}componentWillUnmount(){$C.Z.removeListener(this._onUrlbarStoreChanged),en.ZP.removeListener(this.onBookmarkStoreChange),this._save(),Ij.nextTick((()=>Of.Z.clearUrlfieldState(Aj))),Sj.unlinkBookmarkComponent(this),this._isMounted=!1}resetUrlField=()=>{Of.Z.setUrlfieldState(Aj,{editUrl:void 0,autocompleteValue:void 0})};setIsCreating=e=>{this._isCreating=e};getIsCreating=()=>this._isCreating;_onUrlbarStoreChanged=()=>{const{isActive:e,isOmniDropdownOpen:t,selectionEnd:n,selectionStart:i,...s}=$C.Z.getUrlfieldStateFromId(Aj);this.setState(s)};onSubmit=()=>{this._save(),this.props.onFocusTree()};_save=async()=>{if(this.state.isTrash||""===this.state.id||!1===this.state.dataChanged)return Promise.resolve();const e=this.state.autocompleteValue||this.state.editUrl||this.state.url,t=Jt.ZP.verifyForUpdate({title:this.state.title,url:e,nickname:this.state.nickname,description:this.state.description,speeddial:this.state.speeddial},this.state.isFolder),n=this.state.id,i=await y.Z.bookmarks.update(n,t);if(this._isMounted){const e={};n===this.state.id&&(e.url=en.ZP.filterUrl(t.url||""),e.description=i.description),this.setState(e)}};_saveOnBlur=()=>{!1===this._disableSaveOnBlur&&this._save().then(this.setIsCreating(!1))};_updateStateWithItem=(e={id:"",title:"",nickname:"",description:"",thumbnail:"",partner:"",speeddial:!1,bookmarkbar:!1,trash:!1})=>{const t=en.ZP.isSeparator(e);return new Promise((n=>{this.setState({id:e.id,title:t?"":e.title,url:t?"":en.ZP.getUrlByNode(e),nickname:t?"":e.nickname,description:t?"":e.description,speeddial:!t&&e.speeddial,thumbnail:t?"":e.thumbnail,isFolder:!t&&!e.url,isTrash:!t&&en.ZP.isTrashed(e),isSeparator:t,dateAdded:e.dateAdded?new Date(e.dateAdded):null,dataChanged:!1},(()=>{n()}))}))};handleKeyPress=e=>{if(e.stopPropagation(),"Escape"===e.key){e.preventDefault(),Of.Z.clearUrlfieldState(Aj);const t=this.state.id;this.getIsCreating()?(this.setIsCreating(!1),this._updateStateWithItem(void 0).then(this.props.onCancel(t,!0))):this.setState({dataChanged:!1},(()=>{const e=en.ZP.getItemById(t);e?this._updateStateWithItem(e).then(this.props.onCancel(t,!1)):this.props.onCancel(t,!1)}))}};focusUrlField=()=>{this.refUrlField.current&&this.refUrlField.current.focus()};focusTitleField=()=>{this.refTitle.current&&this.refTitle.current.focus()};handleFocus=e=>{this.props.updateLayout&&this.props.updateLayout();const{HTMLInputElement:t}=this.context;e.target instanceof t&&e.target.select()};handleUpdateThumbnail=e=>{if(e.stopPropagation(),this.state.isFolder)return void y.Z.bookmarks.update(this.state.id,{thumbnail:""});const t=Jt.ZP.verifyForUpdate({url:this.state.url},!1);t.url&&Sj.updateForBookmark(this.state.id,t.url)};onBookmarkStoreChange=()=>{if(this.state.id){const e=en.ZP.getItemById(this.state.id);e&&e?.id===this.state.id&&this._updateStateWithItem(e)}};handleSetCustomThumbnail=e=>{e&&"function"==typeof e.stopPropagation&&e.stopPropagation(),d.Z.utilities.selectLocalImage({windowId:this.context.vivaldiWindowId,title:(0,le.Z)("Select Custom Image"),thumbnailBookmarkId:this.state.id})};checkChangeSpeeddial=()=>{this.setState((e=>({speeddial:!e.speeddial,dataChanged:!0})),(()=>{this._save()}))};isBookmarkBarChecked=()=>en.ZP.getBookmarkBarFolderId()===this.state.id&&this.props.prefValues[D.kBookmarksBarVisible];checkChangeBookmarkBar=()=>{this.setState((e=>({dataChanged:!0})),(()=>{i.Z.setBookmarkBarFolderAndToggleVisibility(this.state.id)}))};onInputChange=(e,t)=>{this.setState({[e]:t.target.value,dataChanged:!0})};onUrlChange=e=>{"idle"===this._transitionState&&this.setState({url:e?.url||"",dataChanged:!0})};setItem=e=>{this._transitionState="update",this.state.dataChanged?this._save().then((()=>{if(this._isMounted){this.setIsCreating(!1);const e=this.props.getSelectedItem();this._setItem(e||void 0).then((()=>{this._transitionState="idle"}))}})):this._setItem(e).then((()=>{this._transitionState="idle"}))};_setItem=e=>(Of.Z.clearUrlfieldState(Aj),this._updateStateWithItem(e).then((()=>{this.getIsCreating()&&(this._disableSaveOnBlur=!0,this.state.isFolder?this.focusTitleField():this.state.isTrash||this.focusUrlField(),this._disableSaveOnBlur=!1)})));render(){const e=Sj.linkAndQueryUpdatingBookmark(this,this.state.id),{isFolder:t,isTrash:n}=this.state,i=b()(this.state.dateAdded).format("LLL"),s=!this.state.id||this.state.isSeparator||n;return kj("div",{className:"manager-editor",onKeyDown:this.handleKeyPress},void 0,kj("form",{className:"addbookmark-cardwrapper cardview",onSubmit:this.onSubmit},void 0,kj("div",{className:"upper-half"},void 0,kj("div",{className:"title-and-address"},void 0,kj("div",{className:"fieldset"},void 0,(0,fn.jsx)("input",{className:"cardview title",ref:this.refTitle,placeholder:(0,le.Z)("Title"),onChange:this.onInputChange.bind(this,"title"),value:this.state.title,disabled:s,type:"text",onFocus:this.handleFocus,onBlur:this._saveOnBlur})),kj("div",{className:t?"fieldset collapse":"fieldset"},void 0,(0,fn.jsx)(oS,{ref:this.refUrlField,stateResetKey:this.state.id,pageId:Aj,autocompletionEnabled:!0,autoFocus:!1,className:"cardview address",disabled:s||t,displayUrl:this.state.url,editUrl:this.state.editUrl,handleDrop:!0,onBlur:this._saveOnBlur,onFocus:this.handleFocus,onKeyPress:this.handleKeyPress,onChange:this.onUrlChange,placeholder:(0,le.Z)("Address"),title:(0,le.Z)("Enter webpage address")})),kj("div",{className:"fieldset"},void 0,kj("input",{className:"cardview nickname",placeholder:(0,le.Z)("Nickname"),value:this.state.nickname,onChange:this.onInputChange.bind(this,"nickname"),type:"text",disabled:s,onFocus:this.handleFocus,onBlur:this._saveOnBlur}))),kj("div",{className:"preview"},void 0,kj(hj,{isFolder:t,src:this.state.thumbnail},this.state.id),!s&&kj("div",{className:"thumb-controls"},void 0,kj("button",{type:"button",tabIndex:"-1",onClick:this.handleSetCustomThumbnail,className:mn()({circular:!0,"set-custom-thumbnail":!0}),title:(0,le.Z)("Select custom thumbnail"),dangerouslySetInnerHTML:{__html:cn.a8r}}),kj("button",{type:"button",tabIndex:"-1",className:mn()({circular:!0,"update-thumbnail":!0,updating:e}),title:(0,le.Z)("Update thumbnail"),onClick:this.handleUpdateThumbnail,dangerouslySetInnerHTML:{__html:cn.GO5.large}})))),kj("div",{className:"lower-half"},void 0,kj("div",{className:"fieldset resizable"},void 0,kj("textarea",{className:"description",placeholder:(0,le.Z)("Description"),value:this.state.description,onChange:this.onInputChange.bind(this,"description"),type:"text",disabled:s,onFocus:this.handleFocus,onBlur:this._saveOnBlur})),kj("div",{className:"speeddial-bookmarksbar"},void 0,kj("div",{className:t?"fieldset center cardview":"fieldset center collapse"},void 0,kj("label",{},void 0,kj("input",{className:"cardview",disabled:s||!t||n,checked:this.state.speeddial,onChange:this.checkChangeSpeeddial,onFocus:this.handleFocus,type:"checkbox"}),kj("span",{},void 0,(0,le.Z)("Speed Dial")))),kj("div",{className:t?"fieldset center cardview":"fieldset center collapse"},void 0,kj("label",{},void 0,kj("input",{className:"cardview",disabled:s||!t||n,checked:this.isBookmarkBarChecked(),onChange:this.checkChangeBookmarkBar,onFocus:this.handleFocus,type:"checkbox"}),kj("span",{},void 0,(0,le.Z)("Bookmark Bar"))))),this.state.dateAdded&&kj("div",{className:"fieldset"},void 0,kj("div",{className:"meta-icon date fieldset",dangerouslySetInnerHTML:{__html:cn.V_c}}),kj("span",{className:"dateCreated bookmark",title:(0,le.Z)("Date created")},void 0,i))),Ej))}}const Nj=(0,fs.Z)(_j,Zj);var Mj,Pj=n(34155);function Dj(e,t,n,i){Mj||(Mj="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Mj,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function xj(e){return!!e&&en.ZP.isTrashed(e)}function Oj(e){return!e.trash}function Lj(e){return!xj(e)}function Rj(e,t){X.Z.setStatus(e,St.jk.getHoverUrl(en.ZP.getUrlByNode(t)))}function Bj(e){X.Z.clearStatus(e)}function Fj(e,t){t.button===vn.Z.kCenter&&(t.preventDefault(),t.stopPropagation())}function Uj(e){return e&&Boolean(e.trash)}function Vj(e,t){y.Z.bookmarks.update(e,{title:t})}function Wj(e){return Boolean(e.speeddial)}function Hj(e){return!Uj(e)}function zj(e){return!!e.children&&e.children.length>0}function Gj(e){return!(!e||!e.children&&e.url)}function $j(e){const{columns:t,node:n}=e,{onExpandClick:i,inManager:s,fullView:o,windowId:a}=e,r=en.ZP.isSeparator(n),l=(n.level+1)*$u+"px";if(r){const e=0===(t?t.findIndex((e=>"title"===e.id)):0)?l:0;return Dj("label",{"data-parent":n.parentId},"0",Dj("hr",{style:{marginLeft:e},className:"separator"}))}return o?t.map((t=>{switch(t.id){case"title":return Dj(iw,{node:n,inlineEditText:e.inlineEditText,onExpandClick:i,inManager:s,fullView:o,onChange:e.onChange,onBlur:e.onBlur,onFocus:e.onFocus,showBadge:e.showBadge,onMouseEnter:()=>Rj(a,n),onMouseLeave:()=>Bj(a)},n.id);case"url":return Dj("label",{},t.id,zj(n)&&o?Dj("span",{className:"secondary"},void 0,(0,le.Z)("$1 item","$1 items",[n.children.length])):Dj("span",{},void 0,St.jk.getHoverUrl(en.ZP.getUrlByNode(n))));case"nickname":return Dj("label",{},t.id,Dj("span",{},void 0,n.nickname));case"description":return Dj("label",{},t.id,Dj("span",{},void 0,n.description));case"dateAdded":return Dj("label",{className:"right-aligned"},t.id,Dj("span",{},void 0,b()(n.dateAdded).format("ll")))}})):Dj(iw,{node:n,inlineEditText:e.inlineEditText,onExpandClick:i,inManager:s,fullView:o,onChange:e.onChange,onBlur:e.onBlur,onFocus:e.onFocus,showBadge:e.showBadge,onMouseEnter:()=>Rj(a,n),onMouseLeave:()=>Bj(a)},n.id)}class Kj extends tn.PureComponent{refTreeList=tn.createRef();static contextType=dn.Z;winId=this.context.vivaldiWindowId;state={nodes:[],cutIds:[],showBadge:M.Z.get(D.kPanelsShowFolderBadge)};_isMounted=!1;_hasSeenSelection=!1;expandModel={};componentDidMount(){this._isMounted=!0,en.ZP.addListener(this._onStoreChange),M.Z.addListener(D.kPanelsShowFolderBadge,this._onBadgeChanged),this.onFilterChange(this.props.filter,this._monitorInitialSelection)}componentDidUpdate(e){if(this.props.filter!==e.filter){const t=this.props.filter.length,n=e.filter.length;0===n&&t>0&&this.refTreeList.current&&(this.expandModel=this.refTreeList.current.getExpandModel()),this.onFilterChange(this.props.filter,(e=>{t>0?Pj.nextTick((()=>{this.refTreeList.current?.expandAllExcept(e)})):n>0&&0===t&&Pj.nextTick((()=>{this.refTreeList.current?.expandWithModel(this.expandModel)}))}))}}componentWillUnmount(){M.Z.removeListener(D.kPanelsShowFolderBadge,this._onBadgeChanged),en.ZP.removeListener(this._onStoreChange),this._isMounted=!1}_onStoreChange=()=>{this.onFilterChange(this.props.filter,this._monitorInitialSelection)};onFilterChange=(e,t)=>{if(e&&e.length>0){const n={bookmarks:!0,folders:!0};if("tree"===this.refTreeList.current?.getSearchStyle()){const i=en.ZP.getFilteredTree(e,n);this.setState({nodes:i.nodes,cutIds:en.ZP.getCutIds()},t?.(i.collapsed))}else{const i=en.ZP.getFilteredFlat(e,n);this.setState({nodes:i,cutIds:en.ZP.getCutIds()},t?.([]))}}else this.setState({nodes:en.ZP.getTopNodes(),cutIds:en.ZP.getCutIds()},t?.([]))};_monitorInitialSelection=()=>{this._hasSeenSelection||Pj.nextTick((()=>{if(this._isMounted){const e=this.refTreeList.current?.getSelectedItem();e&&(this._hasSeenSelection=!0,this.props.onSelect(e))}}))};_onBadgeChanged=(e,t)=>{this.setState({showBadge:Boolean(t)})};deleteSelectedItems=()=>this.refTreeList.current?.onDelete();expandAll=()=>{this.refTreeList.current?.expandAll()};collapseAll=()=>{this.refTreeList.current?.collapseAll()};setSearchStyle=e=>{this.refTreeList.current?.setSearchStyle(e)};onSearchStyleChanged=e=>{this.props.filter&&this.onFilterChange(this.props.filter,(t=>{"tree"===e&&Pj.nextTick((()=>{this.refTreeList.current?.expandAllExcept(t)}))}))};scrollToId=e=>{this.refTreeList.current?.scrollToId(e)};getTargetSpec=(e,t)=>{const n={...Jt.ZP.getEmptyNode(),id:e.id,index:0,parentId:void 0};if(Uj(e)&&"on"!==t){const e=en.ZP.getLastTopNode();e?(n.parentId=e.parentId,n.index=(e.index||0)+1):n.parentId=en.ZP.getRootNode().id}else if(Gj(e)&&"on"===t)n.parentId=e.id;else{Boolean(this.refTreeList.current?.isExpanded(e.id))&&"below"===t?n.parentId=e.id:(n.parentId=e.parentId,n.index=(e.index||0)+("below"===t?1:0))}return n};onDrop=(e,t,n)=>{const i=this.getTargetSpec(t,n),s=i.parentId,o=i.index;return void 0===s||void 0===o?Promise.resolve([]):Jt.ZP.getUrlsFromEventPromise(e,!0).then((e=>{const t=e.map((e=>({...Jt.ZP.getEmptyNode(),url:e.url,title:e.title})));return this.onCreate(t,s,o,!1)}))};onAdd=e=>{const t=e?{title:(0,le.Z)("title","New Folder")}:{};this.refTreeList.current?.onAdd(e,t)};bookmarkActivePage=async e=>{const t=W.Z.getActivePage(this.context.vivaldiWindowId);if(t){const n=this.refTreeList.current?.getParentAndIndex(e,!0);if(void 0!==n?.parentId){const e=await i.Z.bookmarkPages(t,t.windowId,!1,n.parentId,n.index);"string"==typeof e&&this.refTreeList.current?.selectById(e)}}};bookmarkAllOpenPages=async e=>{const t=this.refTreeList.current?.getParentAndIndex(e,!0);if(void 0!==t?.parentId){const e=await i.Z.bookmarkAllOpenPages(this.winId,t.parentId,t.index);"string"==typeof e&&this.refTreeList.current?.selectById(e)}};onRootPasteContextMenu=e=>{document.addEventListener("paste",this.onRootPaste),document.execCommand("paste"),document.removeEventListener("paste",this.onRootPaste)};onRootPaste=e=>{i.Z.paste(e,en.ZP.getRootNode().id,!0)};getSelectedBookmarks=()=>(this.refTreeList.current?.getAllSelectedItems()||[]).map((e=>Jt.ZP.getBookmarksByNode(e))).flat();getSelectedItem=()=>this.refTreeList.current?.getSelectedItem();_onNodesActivated=(e,t)=>{const n=this.context.vivaldiWindowId,i=(0,ls.Z)(n,{button:e.button,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey}),s=t.map((e=>Jt.ZP.getBookmarksByNode(e))).flat();Jt.ZP.open(n,s,i,!0)};_openInNewTab=e=>{const t={inCurrent:!1,inBackground:e||M.Z.get(D.kTabsOpenNewInBackground),inNewWindow:!1,allowOverride:!1,incognito:!1};Jt.ZP.open(this.context.vivaldiWindowId,this.getSelectedBookmarks(),t,!0)};_openInNewWindow=(e,t)=>{const n={inCurrent:!1,inBackground:!1,inNewWindow:!0,allowOverride:!1,incognito:e};Jt.ZP.open(this.context.vivaldiWindowId,t,n,!0)};_openBookmark=()=>{Jt.ZP.open(this.context.vivaldiWindowId,this.getSelectedBookmarks(),{inCurrent:!0,inBackground:!1,inNewWindow:!1,allowOverride:!1,incognito:!1},!0)};_supportSingleClick=()=>M.Z.get(D.kBookmarksSingleClickOpens)&&!this.props.inManager;getMenuCapability=async(e,t,n)=>{const s=this.winId,o=Boolean(n)&&!Uj(n)&&!en.ZP.isSeparator(n);switch(e.action){case"CONTEXT_OPEN_IN_NEW_TAB":return{handler:()=>this._openInNewTab(!1),visible:o,...t(s,e,{})};case"CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB":return{handler:()=>this._openInNewTab(!0),visible:o&&!M.Z.get(D.kTabsOpenNewInBackground),...t(s,e,{})};case"CONTEXT_OPEN_IN_TAB":return{handler:this._openBookmark,visible:o,...t(s,e,{})};case"CONTEXT_OPEN_IN_NEW_WINDOW":return{handler:()=>this._openInNewWindow(!1,this.getSelectedBookmarks()),visible:o,...t(s,e,{})};case"CONTEXT_OPEN_IN_PRIVATE_WINDOW":return{handler:()=>this._openInNewWindow(!0,this.getSelectedBookmarks()),visible:o,...t(s,e,{})};case"CONTEXT_CONTAINER_OPEN_IN_WINDOW":{const n=Jt.ZP.getUrlsByNodes(this.refTreeList.current?.getAllSelectedItems()||[]),i=await Hi.getMenu(s,!0,n);return{visible:o&&i.length>0,items:i,...t(s,e,{})}}case"CONTEXT_SET_SPEEDDIAL":return{handler:()=>{i.Z.toggleSpeeddialFolder(n.id)},visible:Boolean(n)&&!xj(n)&&!Wj(n)&&Gj(n)&&en.ZP.validateForEdit(n.id),...t(s,e,{})};case"CONTEXT_UNSET_SPEEDDIAL":return{handler:()=>{i.Z.toggleSpeeddialFolder(n.id)},visible:Boolean(n)&&!xj(n)&&Wj(n)&&Gj(n)&&en.ZP.validateForEdit(n.id),...t(s,e,{})};case"CONTEXT_SET_BOOKMARK_BAR":{const o=Boolean(n)&&M.Z.get(D.kBookmarksBarVisible)&&en.ZP.getBookmarkBarFolderId()===n.id;return{handler:n?()=>i.Z.setBookmarkBarFolderAndToggleVisibility(n.id):()=>i.Z.setBookmarkBarFolderAndShow(en.ZP.getRootId()),visible:!n||Gj(n)&&!o&&!Uj(n),...t(s,e,{})}}case"CONTEXT_UNSET_BOOKMARK_BAR":return{handler:()=>i.Z.setBookmarkBarFolderAndToggleVisibility(n.id),visible:Boolean(n)&&M.Z.get(D.kBookmarksBarVisible)&&en.ZP.getBookmarkBarFolderId()===n.id,...t(s,e,{})};case"CONTEXT_MOVE_TO_BOOKMARK_BAR":return{handler:()=>async function(e){const t=en.ZP.getBookmarkBarFolderId(),n=en.ZP.getItemById(t);if(!n||en.ZP.isDescendantOf(n,e))return;const i=en.ZP.getItemById(e);i&&i.parentId!==t&&await y.Z.bookmarks.move(e,{parentId:t})}(n.id),visible:Boolean(n)&&!Uj(n),...t(s,e,{})};case"CONTEXT_BOOKMARK":return{handler:n?()=>this.bookmarkActivePage(n):()=>this.bookmarkActivePage(en.ZP.getRootNode()),visible:!Uj(n),...t(s,e,{})};case"CONTEXT_BOOKMARK_ALL":return Promise.resolve({handler:n?()=>this.bookmarkAllOpenPages(n):()=>this.bookmarkAllOpenPages(en.ZP.getRootNode()),visible:!Uj(n),...t(s,e,{})});case"CONTEXT_EMPTY_TRASH":return{handler:()=>{i.Z.emptyTrash()},visible:Boolean(n)&&Uj(n),...t(s,e,{})};default:return{...t(s,e,{})}}};getMenuVisibility=(e,t)=>{if(t)if(Uj(t))switch(e.action){case"CONTEXT_IMPORT":case"CONTEXT_CONTAINER_SEARCH":return!0;default:return!1}else{const n=Uj(t)||en.ZP.isSeparator(t);switch(e.action){case"CONTEXT_NEW_ITEM":case"CONTEXT_NEW_FOLDER":case"CONTEXT_CUT":case"CONTEXT_COPY":case"CONTEXT_PASTE":return!n;case"CONTEXT_NEW_SEPARATOR":return!t.trash&&this.props.sorting.sortOrder===ns.Z.NO_SORTING;case"CONTEXT_RENAME":return en.ZP.validateForEdit(t.id);case"CONTEXT_DELETE":return!Uj(t);case"CONTEXT_EXPAND_ALL":case"CONTEXT_COLLAPSE_ALL":case"CONTEXT_IMPORT":case"CONTEXT_CONTAINER_SEARCH":return!0;default:return!1}}else switch(e.action){case"CONTEXT_NEW_ITEM":case"CONTEXT_NEW_FOLDER":case"CONTEXT_PASTE":case"CONTEXT_EXPAND_ALL":case"CONTEXT_COLLAPSE_ALL":case"CONTEXT_IMPORT":case"CONTEXT_CONTAINER_SEARCH":return!0;case"CONTEXT_NEW_SEPARATOR":return this.props.sorting.sortOrder===ns.Z.NO_SORTING;default:return!1}};onContextMenu=e=>{this.refTreeList.current?.onContextMenu(e)};getDropSupport=(e,t)=>{const n=t.dataTransfer.types.some((e=>"text/uri-list"===e||"text/plain"===e||e===Jt.yR));return{available:n,onto:n&&Gj(e),edge:!0}};handleExpandClick=e=>{this.refTreeList.current?.toggleSelectedExpansion(e)};onItemClick=(e,t)=>{e.button!==vn.Z.kCenter&&this._supportSingleClick()&&!Gj(t)&&void 0===this.refTreeList.current?.getInlineEditId()&&this.openWithEventModifiers(e)};onItemDoubleClick=(e,t)=>{e.button===vn.Z.kCenter||this._supportSingleClick()||Gj(t)||this.openWithEventModifiers(e)};onItemMouseUp=(e,t)=>{t.button===vn.Z.kCenter&&(this._openInNewTab(!0),t.preventDefault(),t.stopPropagation())};openWithEventModifiers=e=>{const t=this.context.vivaldiWindowId,n=(0,ls.Z)(t,{button:e.button,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey});Jt.ZP.open(t,this.getSelectedBookmarks(),n,!0)};getRowComponentProps=e=>({...e,childCount:e.node.children?e.node.children.length:0,columns:this.props.columns||[],showBadge:this.state.showBadge,windowId:this.context.vivaldiWindowId});unSelectAll=()=>{this.refTreeList.current?.unSelectAll()};onSelect=async e=>{if(e){const t=en.ZP.getItemById(e.id);t&&this.props.onSelect(t)}else this.props.onSelect()};onCreate=async(e,t,n,s)=>{const o=await i.Z.createWithPromise(e,t,n),a=1===o.length&&en.ZP.isSeparator(Jt.ZP.convertToPrivateType(o[0]));return this.props.onCreate(!a&&s),o};menu={name:"bookmarklist",getCapability:this.getMenuCapability,getVisibility:this.getMenuVisibility};render(){return(0,fn.jsx)(Yu,{ref:this.refTreeList,rowComponent:e=>(0,fn.jsx)($j,{...e,onExpandClick:e=>this.handleExpandClick(e),inManager:this.props.inManager,fullView:this.props.fullView}),getRowComponentProps:this.getRowComponentProps,nodes:this.state.nodes,cutIds:this.state.cutIds,onSelect:this.onSelect,onItemClick:this.onItemClick,onItemDoubleClick:this.onItemDoubleClick,onItemMouseDown:Fj,onItemMouseUp:this.onItemMouseUp,onItemsActivated:this._onNodesActivated,onCreate:this.onCreate,onSearchStyleChanged:this.onSearchStyleChanged,delete:i.Z.remove,onMove:i.Z.move,onEdit:this.props.onEdit,onCut:i.Z.cut,onCopy:i.Z.copy,onImport:()=>ie.Z.showImportDataDialog(this.context.vivaldiWindowId),isFolder:Gj,isSeparator:en.ZP.isSeparator,supportsInlineEdit:!0,menu:this.menu,mimeType:Jt.yR,getDropSupport:this.getDropSupport,getDragData:en.ZP.getDragData.bind(en.ZP),hasChildren:zj,settings:this.props.inManager?"BOOKMARKS_MANAGER":"BOOKMARKS_PANEL",multiSelect:!this._supportSingleClick(),setCutIds:i.Z.setCutIds,getTitle:en.ZP.getTitle,saveTitle:Vj,getTargetSpec:this.getTargetSpec,sorting:this.props.sorting,onDrop:this.onDrop,rootId:en.ZP.getRootId(),isValidAddTarget:Lj,isValidDragSource:Hj,isValidForClipboard:Oj,isValidToEdit:en.ZP.validateForEdit,validateForDrag:en.ZP.validateForDrag,validateForDeletion:en.ZP.validateForDeletion,columns:this.props.columns})}}const jj=Kj;var Yj;function Xj(e,t,n,i){Yj||(Yj="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Yj,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Qj=[{text:(0,le.Z)("Title"),value:"title",fullScreenTitle:(0,le.Z)("Sort by title"),width:300,visible:!0,key:!0},{text:(0,le.Z)("Address"),value:"url",icon:cn.iD7,fullScreenTitle:(0,le.Z)("Sort by address"),width:300,visible:!0},{text:(0,le.Z)("Nickname"),value:"nickname",icon:cn.vvh.small,fullScreenTitle:(0,le.Z)("Sort by nickname"),width:100,visible:!0},{text:(0,le.Z)("Description"),value:"description",icon:cn.sWI,fullScreenTitle:(0,le.Z)("Sort by description"),width:200,visible:!0},{text:(0,le.Z)("Date Created"),value:"dateAdded",icon:cn.V_c,fullScreenTitle:(0,le.Z)("Sort by creation date"),width:150,visible:!1}];class qj extends tn.PureComponent{static contextType=dn.Z;refEditor=tn.createRef();refTree=tn.createRef();state={filter:"",sorting:{sortOrder:ns.Z.NO_SORTING,sortField:"manually",comparator:this.sortComparator},columns:vu().bookmarks||fu(Qj)};componentDidMount(){const e=M.Z.get(D.kBookmarksManagerSorting);this.onSortChange(e.sortOrder,e.sortField)}onSortChange=(e,t)=>{const n={sortOrder:e,sortField:t,comparator:this.sortComparator};this.setState({sorting:n});const i={sortOrder:e,sortField:t};nt.Z.set(D.kBookmarksManagerSorting,i)};sortComparator=(e,t)=>en.ZP.treeSortComparator(e,t,this.state.sorting);importData=()=>{ie.Z.showImportDataDialog(this.context.vivaldiWindowId)};focusTree=()=>{this.refTree.current?.refTreeList.current?.focusTree()};onSelect=e=>{this.refEditor.current?.setItem(e)};onCreate=e=>{e&&this.refEditor.current?.setIsCreating(!0)};onEditorCanceled=(e,t)=>{const n=this.refTree.current;n&&t&&e?n.deleteSelectedItems()?.then((()=>{y.Z.bookmarks.remove(e),this.focusTree()})):this.focusTree()};onUpdateRow=e=>{this.setState({columns:e})};onSaveRow=()=>{mu(this.state.columns,"bookmarks")};getSelectedItem=()=>this.refTree.current?.getSelectedItem();deleteItem=()=>{this.refTree.current?.deleteSelectedItems()};_updateThumbnails=()=>{const e=[],t=this.refTree.current?.getSelectedBookmarks();if(t)for(const n of en.ZP.iterateTrees(t,!0))n.url&&e.push({id:n.id,url:n.url});Sj.updateForBookmarks(e)};onSearchChange=e=>{this.setState({filter:e.target.value})};createBookmark=()=>{this.refTree.current?.onAdd(!1)};createFolder=()=>{this.refTree.current?.onAdd(!0)};onContextMenu=e=>{e.nativeEvent.buttons>0&&this.refTree.current?.unSelectAll(),this.refTree.current?.onContextMenu(e)};render(){return Xj("div",{className:"bookmark manager"},void 0,Xj("div",{className:"toolbar toolbar-default toolbar-medium"},void 0,Xj("input",{value:this.state.filter,onChange:this.onSearchChange,type:"search",tabIndex:"0",placeholder:(0,le.Z)("verb","Search")}),Xj("div",{className:"toolbar-group"},void 0,Xj(sl,{onClick:this.createBookmark,image:cn.md4.medium,tooltip:(0,le.Z)("New Bookmark")}),Xj(sl,{onClick:this.deleteItem,image:cn.M2k.medium,tooltip:(0,le.Z)("other","Delete")})),Xj(sl,{onClick:this.createFolder,image:cn._TQ.medium,title:(0,le.Z)("command","New Folder")}),Xj("div",{className:"toolbar-group",style:{marginLeft:"auto"}},void 0,Xj(sl,{onClick:this.importData,image:cn.feZ.medium,title:(0,le.Z)("Import...")}),Xj(sl,{onClick:this._updateThumbnails,image:cn.GO5.medium,title:(0,le.Z)("Update Thumbnails")}))),Xj("div",{className:"manager-content"},void 0,Xj("div",{className:"manager-treeview"},void 0,Xj(Iu,{fields:Qj,onSortChange:this.onSortChange,fullsize:!0,sortField:this.state.sorting.sortField,sortOrder:this.state.sorting.sortOrder,columns:this.state.columns,onUpdateRow:this.onUpdateRow,onSaveRow:this.onSaveRow,keyAccess:M.Z.get(D.kKeyboardTabToAll)}),Xj("div",{className:"vivaldi-tree-container",onContextMenu:this.onContextMenu},void 0,(0,fn.jsx)(jj,{filter:this.state.filter,ref:this.refTree,fullView:!0,inManager:!0,onEdit:this.onSelect,onSelect:this.onSelect,onCreate:this.onCreate,sorting:this.state.sorting,columns:this.state.columns}))),(0,fn.jsx)(Nj,{ref:this.refEditor,getSelectedItem:this.getSelectedItem,onCancel:this.onEditorCanceled,onFocusTree:this.focusTree})))}}const Jj=qj;var eY;function tY(e,t,n,i){eY||(eY="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:eY,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const nY=function(e){const{event:t,updateEvent:n}=e,i=tn.createRef(),s=tn.createRef(),o=tn.useRef("");tn.useEffect((()=>{"date"===o.current?s.current?.focus():"add"===o.current&&i.current?.focus(),o.current=""}),[i,s,o]);const a=tn.useCallback((()=>{t.end=(0,bc.zX)(Date.now()),n(t),o.current="date"}),[t,n]),r=tn.useCallback((()=>{t.end=0,n(t),o.current="add"}),[t,n]),l=(0,bc.Yu)(t);return(0,fn.jsxs)(fn.Fragment,{children:[t.task&&!t.end&&(0,fn.jsx)("input",{type:"button",onClick:a,value:(0,le.Z)("Add Due Time"),tabIndex:e.tabIndex,ref:i}),t.task&&!!t.end&&(0,fn.jsxs)(fn.Fragment,{children:[tY(TA,{className:"cal-event-date-picker",onChange:e.onDateChange,tabIndex:e.tabIndex,title:(0,le.Z)("Task Due Date"),value:ZA().tz(t.end,l).format("YYYY-MM-DD"),dayInputRef:s}),!t.allDay&&tY(uh,{className:"cal-event-time-picker",disabled:t.allDay,onChange:e.onTimeChange,tabIndex:e.tabIndex,step:"5",title:(0,le.Z)("Task Due Time"),value:t.allDay?"00:00":ZA().tz(t.end,l).format("HH:mm")}),tY("input",{className:"circular",onClick:r,tabIndex:e.tabIndex,type:"button",title:(0,le.Z)("Clear Due Time"),value:"x"})]})]})};var iY;function sY(e,t,n,i){iY||(iY="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:iY,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const oY=function(e){const{event:t,updateEvent:n}=e,i=tn.createRef(),s=tn.createRef(),o=tn.useRef("");tn.useEffect((()=>{"date"===o.current?s.current?.focus():"add"===o.current&&i.current?.focus(),o.current=""}),[i,s,o]);const a=tn.useCallback((()=>{t.start=(0,bc.zX)(Date.now()),n(t),o.current="date"}),[t,n]),r=tn.useCallback((()=>{t.start=0,n(t),o.current="add"}),[t,n]),l=(0,bc.Yu)(t);return(0,fn.jsxs)(fn.Fragment,{children:[t.task&&!t.start&&(0,fn.jsx)("input",{type:"button",onClick:a,value:(0,le.Z)("Add Start Time"),tabIndex:e.tabIndex,ref:i}),t.task&&!!t.start&&(0,fn.jsxs)(fn.Fragment,{children:[sY(TA,{className:"cal-event-date-picker",onChange:e.onDateChange,tabIndex:e.tabIndex,title:(0,le.Z)("Task Start Date"),value:ZA().tz(t.start,l).format("YYYY-MM-DD"),dayInputRef:s}),!t.allDay&&sY(uh,{className:"cal-event-time-picker",disabled:t.allDay,onChange:e.onTimeChange,tabIndex:e.tabIndex,step:"5",title:(0,le.Z)("Task Start Time"),value:t.allDay?"00:00":ZA().tz(t.start,l).format("HH:mm")}),sY("input",{className:"circular",onClick:r,tabIndex:e.tabIndex,type:"button",title:(0,le.Z)("Clear Start Time"),value:"x"})]})]})};class aY extends tn.Component{static contextType=dn.Z;constructor(e){super(e)}shouldComponentUpdate=()=>{const{document:e}=this.context;return!(this.element&&this.element===e.activeElement)};setRef=e=>{this.element=e,e&&this.props.setElementRef&&this.props.setElementRef(e)};updateContent=e=>{if(this.element){const e=this.element.innerText;this.props.updateContent(e||"")}};render(){const e=(this.props.className||"")+" editable",t=(0,Ji.Z)(this.props,["className","content","updateContent","formatter","setElementRef"]);return(0,fn.jsx)("p",{...t,className:e,contentEditable:"plaintext-only",onBlur:this.updateContent,onInput:this.updateContent,ref:this.setRef,suppressContentEditableWarning:!0,"data-placeholder":this.props.placeholder?this.props.placeholder:"",children:this.props.formatter(this.props.content)})}}const rY=aY;var lY;function dY(e,t,n,i){lY||(lY="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:lY,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class cY extends tn.Component{updateText=e=>{const{event:t,field:n}=this.props;(e&&e!==t[n]||!e&&t[n])&&this.props.updateEvent({...t,[n]:e})};render(){const{event:e}=this.props;return dY(rY,{setElementRef:e=>{this.props.focusRef&&e&&(this.props.focusRef.current=e)},tabIndex:this.props.tabIndex,title:this.props.label,placeholder:this.props.label,className:`cal-event-${this.props.field}`,content:e[this.props.field],formatter:e=>e,updateContent:this.updateText})}}const hY=cY;var pY;function uY(e,t,n,i){pY||(pY="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:pY,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function gY(e){"Enter"===kA.Z[e.keyCode]&&e.stopPropagation()}const mY=function(e){const t=tn.useContext(dn.Z),{document:n}=t,[i,s]=tn.useState(!1);if(tn.useEffect((()=>{if(i){const e=n.querySelectorAll(".cal-event-alarm-time");e.length&&e[e.length-1].focus(),s(!1)}}),[i,n]),e.event.task&&!e.event.end)return(0,fn.jsxs)(fn.Fragment,{children:[e.label&&uY("h2",{},void 0,e.label),uY("p",{className:"info"},void 0,(0,le.Z)("Can not set reminder for task without due time."))]});if(e.event.task&&!e.event.end)return(0,fn.jsxs)(fn.Fragment,{children:[e.label&&uY("h2",{},void 0,e.label),uY("p",{className:"info"},void 0,(0,le.Z)("Can not set reminder for task without due time."))]});const o=t=>{const n=function(e,t){let n=t;e.allDay&&t%yc.hd==0&&(n-=NN(M.Z.get(D.kCalendarDefaultAlldayNotificationTime)||900)*yc.lb);return{id:"",event_id:e.id,name:e.title,when:n}}(l,t??0);l.notifications=[...l.notifications||[],n],s(!0),e.updateEvent(l)},a=()=>{o(function(e){if(e)return(M.Z.get(D.kCalendarDefaultAlldayNotificationTime)||900)*yc.lb;{const e=M.Z.get(D.kCalendarDefaultNotification);return-1===e?0:e*yc.lb}}(l.allDay??!1))},r=i=>{const{notifications:s}=e.event;if(!s)return;const o=n.activeElement instanceof t.HTMLElement&&n.activeElement.closest(".calendar-event");if(o){const e=os(o);e.forEach(((t,i)=>{t===n.activeElement&&e[i-1]?.focus()}))}const a=s.indexOf(i);-1!==a&&(s.splice(a,1),e.updateEvent(e.event))},{event:l}=e;return(0,fn.jsxs)(fn.Fragment,{children:[e.label&&uY("h2",{},void 0,e.label),!!l.notifications?.length&&l.notifications.map(((t,n)=>uY("div",{className:"edit-group"},t.id||n,uY("label",{},void 0,uY(MN,{allDay:l.allDay??!1,create:!1,value:t.when,onChange:n=>((t,n)=>{const{notifications:i}=e.event;if(!i)return;const s=i.findIndex((e=>e===t));if(-1!==s){if(-1===n||isNaN(n))return void r(t);i[s].when=n,e.updateEvent(e.event)}})(t,n),tabIndex:e.tabIndex,className:"cal-event-alarm-time"}),uY("input",{className:"circular",onClick:r.bind(null,t),onKeyDown:gY,tabIndex:e.tabIndex,type:"button",title:(0,le.Z)("Remove alarm"),value:"–"}),uY("input",{className:"circular",onClick:a,onKeyDown:gY,tabIndex:e.tabIndex,type:"button",title:(0,le.Z)("Add another alarm"),value:"+"}))))),!l.notifications?.length&&uY("div",{className:"edit-group"},void 0,uY("label",{},void 0,uY(MN,{allDay:l.allDay??!1,create:!0,value:0,onChange:o,tabIndex:e.tabIndex,className:"cal-event-alarm-time"})))]})};var vY;function fY(e,t,n,i){vY||(vY="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:vY,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const yY=[fY("option",{value:yc.ad},"current",(0,le.Z)("Current ($1)",[(0,bc.EP)()])),fY("option",{value:yc.$T},"floating",(0,le.Z)("Always in Local Time")),fY("option",{value:"UTC"},"UTC","UTC")].concat(ZA().tz.names().filter((e=>-1!==e.indexOf("/"))).map((e=>fY("option",{value:e},e,e))));function wY(e,t,n){const i=(0,bc.Yu)(e),s=ZA().tz(e[t],i).format("YYYY-MM-DD");return CY(t,e,ZA().tz(`${s} ${n}`,i).valueOf())}function bY(e,t,n){const i=(0,bc.Yu)(e),s=ZA().tz(e[t],i).format("HH:mm"),o=ZA().tz(`${n} ${s}`,i);return e.allDay&&"end"===t&&o.add(1,"day"),CY(t,e,o.valueOf())}function CY(e,t,n){if(!isNaN(n)){const i=M.Z.get(D.kCalendarAutoAdjustEnd);if("start"===e&&("always"===i||"timed_only"===i&&!t.allDay)){const e=t.end-t.start;t.start=n,t.end=n+e}else t[e]=n}return t}class SY extends tn.Component{createTimeHandler=e=>t=>{const{value:n}=t.currentTarget;this.props.updateEvent(wY(this.props.event,e,n))};createDateHandler=e=>t=>{const{value:n}=t.currentTarget;this.props.updateEvent(bY(this.props.event,e,n))};setTimezone=e=>{const{value:t}=e.currentTarget;t!==this.props.event.timezone&&this.props.updateEvent((0,bc.bn)(this.props.event,t))};setAllDay=e=>{const{checked:t}=e.currentTarget;this.props.event.allDay=t,this.props.updateEvent(this.props.event)};render(){const{event:e}=this.props,{start:t,end:n}=(0,bc.aE)(e);return fY("div",{},void 0,!e.task&&(0,fn.jsxs)(fn.Fragment,{children:[fY("div",{className:"edit-group large-gap"},void 0,fY(TA,{className:"cal-event-date-picker",onChange:this.createDateHandler("start"),tabIndex:this.props.tabIndex,title:(0,le.Z)("Event Start Date"),value:t.format("YYYY-MM-DD")}),!e.allDay&&(0,fn.jsx)(uh,{className:"cal-event-time-picker",onChange:this.createTimeHandler("start"),ref:this.props.focusRef,tabIndex:this.props.tabIndex,step:"5",title:(0,le.Z)("Event Start Time"),value:t.format("HH:mm")})),fY("div",{className:"edit-group large-gap"},void 0,fY(TA,{className:"cal-event-date-picker",onChange:this.createDateHandler("end"),tabIndex:this.props.tabIndex,title:(0,le.Z)("Event End Date"),value:n.format("YYYY-MM-DD")}),!e.allDay&&fY(uh,{className:"cal-event-time-picker",onChange:this.createTimeHandler("end"),tabIndex:this.props.tabIndex,step:"5",title:(0,le.Z)("Event End Time"),value:n.format("HH:mm")}))]}),e.task&&fY("div",{className:"edit-group large-gap"},void 0,(0,fn.jsxs)(fn.Fragment,{children:[fY(oY,{event:e,updateEvent:this.props.updateEvent,onDateChange:this.createDateHandler("start"),onTimeChange:this.createTimeHandler("start"),tabIndex:this.props.tabIndex}),fY(nY,{event:e,onDateChange:this.createDateHandler("end"),onTimeChange:this.createTimeHandler("end"),updateEvent:this.props.updateEvent,tabIndex:this.props.tabIndex})]})),fY("div",{className:"edit-group large-gap"},void 0,fY("label",{},void 0,fY("input",{type:"checkbox",checked:e.allDay,onChange:this.setAllDay,tabIndex:this.props.tabIndex}),fY("span",{},void 0,(0,le.Z)("All Day"))),fY("label",{},void 0,fY("select",{disabled:e.allDay,onChange:this.setTimezone,value:e.allDay?yc.$T:e.timezone,tabIndex:this.props.tabIndex},void 0,yY))),fY(mY,{event:e,tabIndex:this.props.tabIndex,updateEvent:this.props.updateEvent,label:(0,le.Z)("Reminders")}))}}const TY=SY;var IY;function kY(e,t,n,i){IY||(IY="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:IY,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var AY=kY("span",{},void 0,"-"),ZY=kY("span",{},void 0,"-");class EY extends tn.Component{createTimeHandler=e=>t=>{const{value:n}=t.currentTarget;this.props.updateEvent(wY(this.props.event,e,n))};createDateHandler=e=>t=>{const{value:n}=t.currentTarget;this.props.updateEvent(bY(this.props.event,e,n))};changeField=(e,t)=>{this.props.event[e]=t.currentTarget.checked,this.props.event.task&&(this.props.event.invites=[]),this.props.updateEvent(this.props.event)};onCalendarChange=e=>{this.props.event.calendarId=e.target.value,this.props.updateEvent(this.props.event)};onCalendarSelected=e=>{o.Z.setDefaultCalendarId(e),this.props.event.calendarId=e,this.props.updateEvent(this.props.event)};render(){const{event:e}=this.props,{start:t,end:n}=(0,bc.aE)(e);return(0,fn.jsxs)(fn.Fragment,{children:[kY("div",{className:"edit-group large-gap"},void 0,(0,fn.jsx)(hY,{...this.props,label:(0,le.Z)("Title"),field:"title"})),kY("div",{className:"edit-group large-gap"},void 0,!e.task&&e.allDay&&(0,fn.jsxs)(fn.Fragment,{children:[kY(TA,{className:"cal-event-date-picker",onChange:this.createDateHandler("start"),tabIndex:this.props.tabIndex,title:(0,le.Z)("Event Start Date"),value:t.format("YYYY-MM-DD")}),AY,kY(TA,{className:"cal-event-date-picker",onChange:this.createDateHandler("end"),tabIndex:this.props.tabIndex,title:(0,le.Z)("Event End Date"),value:n.format("YYYY-MM-DD")})]}),!e.task&&!e.allDay&&(0,fn.jsxs)(fn.Fragment,{children:[kY(uh,{className:"cal-event-time-picker",onChange:this.createTimeHandler("start"),tabIndex:this.props.tabIndex,step:"5",title:(0,le.Z)("Event Start Time"),value:t.format("HH:mm")}),ZY,kY(uh,{className:"cal-event-time-picker",onChange:this.createTimeHandler("end"),tabIndex:this.props.tabIndex,step:"5",title:(0,le.Z)("Event End Time"),value:n.format("HH:mm")})]}),e.task&&(0,fn.jsxs)(fn.Fragment,{children:[kY(oY,{event:e,updateEvent:this.props.updateEvent,onDateChange:this.createDateHandler("start"),onTimeChange:this.createTimeHandler("start"),tabIndex:this.props.tabIndex}),kY(nY,{event:e,updateEvent:this.props.updateEvent,onDateChange:this.createDateHandler("end"),onTimeChange:this.createTimeHandler("end"),tabIndex:this.props.tabIndex})]})),kY("div",{className:"edit-group inline large-gap"},void 0,kY("label",{},void 0,kY("input",{type:"checkbox",checked:e.task,onChange:this.changeField.bind(null,"task"),tabIndex:this.props.tabIndex}),kY("span",{},void 0,(0,le.Z)("Is a Task"))),kY("label",{},void 0,kY("input",{disabled:!e.task,type:"checkbox",checked:e.complete,onChange:this.changeField.bind(null,"complete"),tabIndex:e.task?this.props.tabIndex:-1}),kY("span",{},void 0,(0,le.Z)("Complete")))),e&&kY("div",{className:"edit-group large-gap capped-width"},void 0,Ec(e,this.onCalendarSelected,this.props.tabIndex))]})}}const _Y=EY;var NY;function MY(e,t,n,i){NY||(NY="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:NY,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const PY={ACCEPTED:{icon:cn.wHY,text:(0,le.Z)("Has accepted the invite")},DECLINED:{icon:cn.dHk,text:(0,le.Z)("Has declined the invite")},TENTATIVE:{icon:cn.owS,text:(0,le.Z)("Has tentatively accepted the invite")},"NEEDS-ACTION":{icon:cn.DvK,text:(0,le.Z)("Has not replied to the invite")},DELEGATED:{icon:cn.upG.large,text:(0,le.Z)("Has delegated invite to another person")}};class DY extends tn.Component{contacts=new Map;showNoMailWarning=!1;constructor(e){super(e),this.contacts=this.getRemainingContacts(Aa.Z.getMailAddresses())}stopEnterEvent=e=>{e.keyCode===qi.Z.KEY_RETURN&&e.stopPropagation()};contactSelected=e=>{if(!e.length)return;const t=e.pop(),{event:n}=this.props,i={id:"",event_id:n.id,name:t.name,address:t.address,sent:!1};n.invites?n.invites=[i,...n.invites]:n.invites=[i],this.props.updateEvent(n),this.contacts=this.getRemainingContacts(this.contacts),this.forceUpdate()};getRemainingContacts(e){const{event:t}=this.props;if(!t.invites||0===t.invites.length)return e;const n=new Set(t.invites.map((e=>e.address)));return new Map([...e.entries()].filter((([e,t])=>!n.has(e))))}removeInvite=(e,t)=>{const{event:n}=this.props;if(!n.invites||0===n.invites.length)return;const{invites:i}=n,s=i.findIndex((t=>t.address===e));if(-1===s)return;i.splice(s,1);const o=t.target.closest(".calendar-event");if(o instanceof HTMLElement){const e=os(o);e.forEach(((n,i)=>{n===t.target&&e[i-1]&&e[i-1].focus()}))}this.props.updateEvent(n),this.contacts=this.getRemainingContacts(Aa.Z.getMailAddresses()),this.forceUpdate()};render(){const{event:e}=this.props,t=(e.invites||[]).filter((t=>t.address!==e.organizer));return e.task?MY("div",{className:"cal-event-participants"},void 0,MY("p",{className:"info"},void 0,(0,le.Z)("Participants not supported for Tasks"))):MY("div",{className:"cal-event-participants"},void 0,(0,fn.jsx)(Uk,{ref:this.props.focusRef,id:"foo_this_property_is_not_used",allItems:this.contacts,itemSelectionCallback:this.contactSelected,selectedItems:[],placeholder:this.props.label,tabIndex:this.props.tabIndex}),!!e.invites?.length&&MY("div",{className:"cal-event-participantslist"},void 0,e.organizer&&MY("div",{className:"cal-event-participant",title:(0,le.Z)("Event Organizer")},e.organizer,MY("span",{className:"cal-event-participant-status",dangerouslySetInnerHTML:{__html:cn.LaO.small}}),MY("span",{className:"cal-event-participant-address"},void 0,e.organizer),MY("input",{onClick:this.removeInvite.bind(this,e.organizer||""),onKeyDown:this.stopEnterEvent,tabIndex:this.props.tabIndex,type:"button",value:(0,le.Z)("verb","Remove")})),t.map(((e,t)=>{const n=e.partstat||"NEEDS-ACTION",i=PY[n]?PY[n]:PY["NEEDS-ACTION"];return MY("div",{className:"cal-event-participant",title:i.text},e.address,MY("span",{className:"cal-event-participant-status",dangerouslySetInnerHTML:{__html:i.icon}}),MY("span",{className:"cal-event-participant-address"},void 0,e.address),MY("input",{onClick:this.removeInvite.bind(this,e.address),onKeyDown:this.stopEnterEvent,tabIndex:this.props.tabIndex,type:"button",value:(0,le.Z)("verb","Remove")}))}))),!M.Z.get(D.kCalendarMailAccount)&&MY("p",{className:"info"},void 0,(0,le.Z)("In order to send invitations you will need to select a mail account in calendar settings.")))}}const xY=DY,OY=e=>{const{editor:t}=tn.useContext(OD),n=tn.useContext(dn.Z).vivaldiWindowId,i=tn.useCallback((()=>{o.Z.saveEventEdit(n,t)}),[t,n]),s=tn.useCallback((()=>{o.Z.cancelEventChange(t)}),[t]),a=tn.useCallback((e=>{o.Z.updateEventEdit(t,e)}),[t]),r=tn.useCallback((()=>{o.Z.trashEvent(n,t,e.id)}),[t,e,n]),l=tn.useCallback((i=>{o.Z.selectEvent(t,{event:e}),i?ui.Z.cut(n):ui.Z.copy(n)}),[e,t,n]),d=tn.useCallback((()=>[{handler:()=>l(!0),...(0,Mn.Z)("verb","Cut")},{handler:()=>l(!1),...(0,Mn.Z)("verb","Copy")},{handler:()=>r(),...(0,Mn.Z)("Delete Event")}]),[r,l]);return{saveEvent:i,discardChanges:s,updateEvent:a,trashEvent:r,getContextMenu:d}};var LY;function RY(e,t,n,i){LY||(LY="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:LY,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const BY=e=>{const{event:t}=e,{updateEvent:n,getContextMenu:i}=OY(t),s=tn.useRef(),a=tn.useContext(dn.Z),{document:r,getSelection:l}=a;tn.useEffect((()=>{const e=s.current,t=l();if(e&&t){e.focus();const n=r.createRange();n.selectNodeContents(e),n.collapse(!1),t.removeAllRanges(),t.addRange(n)}}),[r,l]);const d={updateEvent:n,event:t,tabIndex:0},c=t=>i=>{const{value:s}=i.currentTarget;n(wY(e.event,t,s))},h=t=>i=>{const{value:s}=i.currentTarget;n(bY(e.event,t,s))},p=(t,i)=>{e.event[t]=i.currentTarget.checked,e.event.task&&(e.event.invites=[]),n(e.event)},{start:u,end:g}=(0,bc.aE)(t);return RY("div",{className:"CalendarEventFull",onContextMenu:e=>{(0,zi.Z)(a.vivaldiWindowId,i())(e)},style:{backgroundImage:cn.wo7},onClick:Cs.U},void 0,RY("div",{className:"CalendarEventFull-Row"},void 0,RY("span",{className:"CalendarEventFull-Icon",dangerouslySetInnerHTML:{__html:cn.NNg.small}}),(0,fn.jsx)(hY,{...d,field:"title",label:(0,le.Z)("Title"),focusRef:s})),RY("div",{className:"CalendarEventFull-Row CalendarEventFull-Row--NoIcon"},void 0,(0,fn.jsx)(hY,{...d,field:"description",label:(0,le.Z)("Description")})),!t.task&&(0,fn.jsxs)(fn.Fragment,{children:[RY("div",{className:"CalendarEventFull-Row"},void 0,RY("span",{className:"CalendarEventFull-Icon",dangerouslySetInnerHTML:{__html:cn.hcy.small}}),RY("div",{},void 0,RY(TA,{onChange:h("start"),title:(0,le.Z)("Event Start Date"),value:u.format("YYYY-MM-DD")}),!t.allDay&&RY(uh,{onChange:c("start"),step:"5",title:(0,le.Z)("Event Start Time"),value:u.format("HH:mm")}),"–",!t.allDay&&RY(uh,{onChange:c("end"),step:"5",title:(0,le.Z)("Event End Time"),value:g.format("HH:mm")}),RY(TA,{onChange:h("end"),title:(0,le.Z)("Event End Date"),value:g.format("YYYY-MM-DD")}))),RY("div",{className:"CalendarEventFull-Row CalendarEventFull-Row--NoIcon"},void 0,RY("div",{className:"edit-group"},void 0,RY("label",{},void 0,RY("input",{type:"checkbox",checked:t.allDay,onChange:t=>{const{checked:i}=t.currentTarget;e.event.allDay=i,n(e.event)}}),RY("span",{},void 0,(0,le.Z)("All Day")))))]}),t.task&&RY("div",{className:"CalendarEventFull-Row"},void 0,RY("span",{className:"CalendarEventFull-Icon",dangerouslySetInnerHTML:{__html:cn.hcy.small}}),RY(nY,{event:t,updateEvent:n,onDateChange:h("end"),onTimeChange:c("end")})),(!t.task||!!t.end)&&RY("div",{className:"CalendarEventFull-Row CalendarEventFull-Row--NoIcon"},void 0,RY("div",{className:"edit-group"},void 0,RY("label",{},void 0,RY("select",{disabled:t.allDay,onChange:t=>{const{value:i}=t.currentTarget;i!==e.event.timezone&&n((0,bc.bn)(e.event,i))},value:t.allDay?yc.$T:t.timezone},void 0,yY)))),RY("div",{className:"CalendarEventFull-Row"},void 0,RY("span",{className:"CalendarEventFull-Icon",dangerouslySetInnerHTML:{__html:cn.wo7.small}}),RY("div",{className:"edit-group"},void 0,RY("label",{},void 0,RY("input",{type:"checkbox",checked:t.task,onChange:p.bind(null,"task")}),RY("span",{},void 0,(0,le.Z)("Is a Task"))),RY("label",{},void 0,RY("input",{disabled:!t.task,type:"checkbox",checked:t.complete,onChange:p.bind(null,"complete")}),RY("span",{},void 0,(0,le.Z)("Complete"))))),RY("div",{className:"CalendarEventFull-Row"},void 0,RY("span",{className:"CalendarEventFull-Icon",dangerouslySetInnerHTML:{__html:cn.sel.small}}),(0,fn.jsx)(hY,{...d,field:"location",label:(0,le.Z)("Location")})),RY("div",{className:"CalendarEventFull-Row"},void 0,RY("span",{className:"CalendarEventFull-Icon CalendarEventFull-Icon--WithInput",dangerouslySetInnerHTML:{__html:cn.ghF.small}}),RY("div",{className:"CalendarEventFull-Recurrence"},void 0,(0,fn.jsx)(OA,{...d,field:"recurrence",label:"recurrence"}))),RY("div",{className:"CalendarEventFull-Row"},void 0,RY("span",{className:"CalendarEventFull-Icon",dangerouslySetInnerHTML:{__html:cn.iD7}}),(0,fn.jsx)(hY,{...d,field:"url",label:(0,le.Z)("URL")})),t.attachment&&t.attachment.length>0&&RY("div",{className:"CalendarEventFull-Row"},void 0,RY("span",{className:"CalendarEventFull-Icon",dangerouslySetInnerHTML:{__html:cn.onv}}),t.attachment.map((e=>RY("div",{className:"CalendarEventFull-Attachment"},e.url,RY("a",{onClick:()=>Y.Z.openURL(a.vivaldiWindowId,e.url),title:e.url},void 0,e.filename||e.url))))),RY("div",{className:"CalendarEventFull-Row"},void 0,RY("span",{className:"CalendarEventFull-Icon CalendarEventFull-Icon--WithInput",dangerouslySetInnerHTML:{__html:cn.l0O.small}}),RY("div",{className:"CalendarEventFull-Notifications"},void 0,RY(mY,{event:t,updateEvent:n}))),RY("div",{className:"CalendarEventFull-Row"},void 0,RY("span",{className:"CalendarEventFull-Icon CalendarEventFull-Icon--WithInput",dangerouslySetInnerHTML:{__html:cn.LaO.small}}),RY("div",{className:"CalendarEventFull-Notifications"},void 0,(0,fn.jsx)(xY,{...d,field:"attendees",label:(0,le.Z)("Type to add Participants")}))),t.calendarId!==yc.xu&&RY("div",{className:"CalendarEventFull-Row"},void 0,RY("span",{className:"CalendarEventFull-Icon CalendarEventFull-Icon--WithInput",dangerouslySetInnerHTML:{__html:cn.bcq.small}}),Ec(t,(e=>{o.Z.setDefaultCalendarId(e),t.calendarId=e,n(t)}),0)))};var FY;function UY(e,t,n,i){FY||(FY="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:FY,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var VY=UY("div",{className:"CalendarEventBubble-Arrow"});const WY=function(e){const t=tn.useContext(dn.Z),n=tn.useRef(tn.createRef().current),i=tn.useRef(),s=tn.useCallback(((e,n)=>{i.current||(i.current=requestAnimationFrame((()=>{(async function(e,t,n){const i=e.current,s=t.current;if(!i||!s)return;const o=i.parentElement?.getBoundingClientRect()||{left:0,top:0,bottom:0},a=i.getBoundingClientRect(),r=s.getBoundingClientRect(),l=r.left-o.left,d=n.innerWidth-r.right;d>=a.width?(i.style.left=r.right-o.left+"px",i.style.right="auto",i.classList.remove("CalendarEventBubble--RightArrow"),i.classList.add("CalendarEventBubble--LeftArrow")):l>=a.width?(i.style.right=n.innerWidth-r.left+"px",i.style.left="auto",i.classList.remove("CalendarEventBubble--LeftArrow"),i.classList.add("CalendarEventBubble--RightArrow")):l>d?(i.style.left="0px",i.style.right="auto",i.classList.remove("CalendarEventBubble--LeftArrow"),i.classList.add("CalendarEventBubble--RightArrow")):(i.style.right="0px",i.style.left="auto",i.classList.remove("CalendarEventBubble--RightArrow"),i.classList.add("CalendarEventBubble--LeftArrow"));const c=i.querySelector(".CalendarEventBubble-Arrow"),h=r.top-o.top,p=n.innerHeight-r.bottom,u=(a.height-r.height)/2;if(h>u&&p>u){if(i.style.top=r.top-o.top-u+"px",i.style.bottom="auto",c){const e=u+r.height/2;c.style.top=`${e}px`}}else if(p<u){if(i.style.bottom="0px",i.style.top="auto",c){const e=Math.min(a.height-20,a.height-p-r.height/2+20);c.style.top=`${e}px`}}else if(i.style.top="0px",i.style.bottom="auto",c){const e=Math.max(20,r.top-o.top+r.height/2);c.style.top=`${e}px`}})(e,n,t).then((()=>{i.current=null}))})))}),[i,t]);tn.useEffect((()=>{function i(){s(n,e.eventRef)}const o=new ResizeObserver(i),a=e.eventRef.current?.closest(".calendar-viewport");return a&&a.addEventListener("scroll",i),t.addEventListener("resize",i),e.eventRef.current&&o.observe(e.eventRef.current),s(n,e.eventRef),()=>{a&&a.removeEventListener("scroll",i),e.eventRef.current&&o.unobserve(e.eventRef.current),t.removeEventListener("resize",i)}}),[e.eventRef,s,t]);const{saveEvent:o}=e,a=tn.useCallback((function(e){e.preventDefault(),e.stopPropagation(),o()}),[o]);return(0,fn.jsxs)("div",{className:"CalendarEventBubble",ref:n,"data-top":"225px",children:[VY,UY("div",{className:"CalendarEventBubble-Inner"},void 0,UY("form",{onSubmit:a},void 0,UY(BY,{event:e.event}),UY("div",{className:"CalendarEventBubble-Buttons"},void 0,UY("input",{type:"submit",value:(0,le.Z)("calendar","Done"),onClick:a}),UY("input",{type:"button",value:(0,le.Z)("calendar","Cancel"),onClick:e.discardChanges}))))]})};var HY;function zY(e,t,n,i){HY||(HY="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:HY,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class GY extends tn.Component{static contextType=dn.Z;render(){const{event:e}=this.props;return(0,fn.jsxs)(fn.Fragment,{children:[zY("div",{className:"edit-group large-gap"},void 0,(0,fn.jsx)(hY,{...this.props,label:(0,le.Z)("Description"),field:"description"})),zY("div",{className:"edit-group"},void 0,(0,fn.jsx)(hY,{...this.props,label:(0,le.Z)("URL"),field:"url"})),e.attachment&&e.attachment.length>0&&zY("div",{className:"cal-event-attchments"},void 0,e.attachment.map((e=>zY("div",{className:"cal-event-attachment"},e.url,zY("span",{dangerouslySetInnerHTML:{__html:cn.UEH.small}}),zY("a",{onClick:()=>Y.Z.openURL(this.context.vivaldiWindowId,e.url),title:e.url},void 0,e.filename||e.url)))))]})}}const $Y=GY;var KY;function jY(e,t,n,i){KY||(KY="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:KY,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class YY extends tn.PureComponent{render(){return jY("div",{className:"cal-edit-tabs"},void 0,this.props.tabs.map((e=>{const{id:t,label:n,icon:i}=e;return jY("button",{className:mn()("cal-edit-tab",{selected:this.props.currentTabId===t}),dangerouslySetInnerHTML:{__html:i},onClick:this.props.onSelectTab.bind(null,t),tabIndex:"-1",title:n},`tab-${t}`)})))}}const XY=YY,QY="basics";const qY=function(e,t,n,i){const s=tn.useContext(dn.Z),[o,a]=tn.useState({tabId:QY,toFocus:""}),r=tn.useRef({});r.current={currentTabState:o,tabs:e,editing:n};const l=tn.useRef(!1),d=tn.useRef(null),c=(e,t)=>{if(e.tabIndex<0){const t=e.tabIndex;e.tabIndex=0,e.focus(),e.tabIndex=t}else e.focus();const n=s.getSelection();if(n)if(e instanceof HTMLInputElement&&"number"===e.type)e.select();else{if(n.focusNode&&n.focusNode.childNodes[n.focusOffset]===e)return;{const i=s.document.createRange();if(!(i&&e instanceof HTMLElement))return;i.selectNodeContents(e);const o=e.hasChildNodes()?e.childNodes[0]:null;if(t&&o)try{i.setStart(o,t.start),i.setEnd(o,t.end)}catch(e){i.collapse(!1),de.Z.error("Calendar","Setting caret position failed!",e)}else i.collapse(!1);n.removeAllRanges(),n.addRange(i)}}},h=tn.useCallback(((t,n="")=>{const i=r.current.currentTabState.tabId;if(!e.get(t)||t===i)return;const o=e.get(i),l=o&&o.containerRef.current,d=s.getSelection();if(l?.contains(s.document.activeElement)){const e=[];if(d)for(let t=0;t<d.rangeCount;t++)e.push(d.getRangeAt(t));const t={element:s.document.activeElement,ranges:e};o&&(o.storedFocus=t)}s.document.activeElement?.blur(),a({tabId:t,toFocus:n})}),[e,s]);return tn.useEffect((()=>{const e=(e,t="first")=>{const{tabs:n,currentTabState:i}=r.current,s=n.get(i.tabId);let o;"next"===e?(o=s&&s.index+1||0,o=o<n.size?o:0):(o=s&&s.index-1||0,o=o<0?n.size-1:o);const a=[...n.values()].find((e=>e.index===o));h(a&&a.id||QY,t)},n=e.bind(null,"next","first"),s=e.bind(null,"previous","last"),o=t=>{const{changeTab:n,direction:i,toFocus:s}=(e=>{const t=kA.Z[e.keyCode];return"PageUp"===t||"Tab"===t&&e.altKey&&e.shiftKey?{changeTab:!0,direction:"previous",toFocus:"first"}:"PageDown"===t||"Tab"===t&&e.altKey?{changeTab:!0,direction:"next",toFocus:"first"}:{changeTab:!1,direction:"next",toFocus:"first"}})(t);n&&(t.preventDefault(),e(i,s))},a=e=>{const{tabs:t,currentTabState:n}=r.current;let i;t.forEach((t=>{const n=t.containerRef.current;e.target instanceof HTMLElement&&n?.contains(e.target)&&(i=t.id)})),i&&i!==n.tabId&&h(i)},l=i?.[0].current,d=i?.[1].current;l&&l.addEventListener("focusin",s),d&&d.addEventListener("focusin",n);const c=t.current;return c&&(c.addEventListener("keydown",o),c.addEventListener("focusin",a)),()=>{c&&(c.removeEventListener("keydown",o),c.removeEventListener("focusin",a)),l&&l.removeEventListener("focusin",s),d&&d.removeEventListener("focusin",n)}}),[n,t,h,i]),tn.useEffect((()=>{const a=n&&!1===l.current;if(l.current=n,!n)return;const r=t.current,h=s.getSelection(),p=e.get(o.tabId);if(r&&p)if(a){e.forEach((e=>e.storedFocus=null)),r.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"});const t=p.focusRef?.current;t&&c(t,d.current)}else if(i&&["first","last"].includes(o.toFocus)){let e=[];if(r instanceof HTMLElement&&(e=Array.from(os(r))),i?.length&&(e=e.slice(1,-1)),e=e.filter((e=>!e.parentElement?.className.includes("cal-event-body-buttons"))),e.length)"first"===o.toFocus?c(e[0]):c(e[e.length-1]);else{const e=p.focusRef&&p.focusRef.current;e&&c(e)}}else if(p.storedFocus){const e=p.storedFocus;e.element?.focus(),h&&(h.removeAllRanges(),e.ranges.forEach((e=>h.addRange(e))))}else if(!r.contains(s.document.activeElement)){const e=p.focusRef&&p.focusRef.current;e&&c(e)}}),[n,o]),[o.tabId,e=>h(e,"first")]};var JY;function eX(e,t,n,i){JY||(JY="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:JY,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const tX=[D.kCalendarEditMode,D.kCalendarDisplayEventIcons],nX=[["basics",(0,le.Z)("Basic Event Info"),cn.NNg.small],["time",(0,le.Z)("Date and Time"),cn.hcy.small],["recurrence",(0,le.Z)("Recurrence"),cn.ghF.small],["location",(0,le.Z)("Location"),cn.sel.small],["description",(0,le.Z)("Description"),cn.iD7],["participants",(0,le.Z)("Type to add Participants"),cn.LaO.small]],iX=e=>{const t=Ic(e),n=PA(e.recurrence);let i=`${e.title||""}`;return t&&(i+=` (${t})`),e.location&&(i+=`\n${e.location}`),e.description&&(i+=`\n${e.description}`),n&&(i+=`\n${n}`),i};function sX(e){["Space","Enter"].includes(kA.Z[e.keyCode])&&e.stopPropagation()}function oX(e){const t=tn.useContext(OD),n=tn.useContext(dn.Z),i=(e,t)=>e.length>=t?`${e.substring(0,t)}...`:e||"",s=tn.useRef(new Map(nX.map(((e,t)=>{const[n,i,s]=e;return[n,{id:n,label:i,icon:s,index:t,focusRef:tn.createRef(),containerRef:tn.createRef(),storedFocus:null}]})))),{event:a,isSelected:r,isEditing:l,editor:d,isMultiDay:c,isFiltering:h,multiDayContinues:p,multiDayContinuing:u}=e,g=tn.useRef(null),m=tn.useRef(null),v=tn.useRef(null),f=(0,Tm.Z)(tX),[y,w]=qY(s.current,g,l,[m,v]),{saveEvent:b,discardChanges:C,updateEvent:S,trashEvent:T,getContextMenu:I}=OY(a),k=s.current.get("title"),A=k&&k.focusRef||tn.createRef(),Z=s.current.get("time"),E=Z&&Z.focusRef||tn.createRef(),_=""===a.id,N=f[D.kCalendarEditMode],M=tn.useCallback((e=>{"Enter"!==kA.Z[e.keyCode]||e.shiftKey||(e.preventDefault(),e.stopPropagation(),o.Z.saveEventEdit(n.vivaldiWindowId,d))}),[n.vivaldiWindowId,d]);const P=tn.useCallback((()=>{_?C():T()}),[C,T,_]);let x;if(l&&"popup"===N){const e=document.querySelector("#main > .inner");e&&(t.isActivePage||t.isPanel)&&(x=Ur.createPortal(eX(WY,{event:a,eventRef:g,saveEvent:()=>b(),discardChanges:C}),e))}const O=Object.assign({},e.style??{},oc.Z.getEventColors(a.calendarId));return(0,fn.jsxs)(fn.Fragment,{children:[(0,fn.jsxs)("div",{className:mn()("calendar-event",e.className,{selected:r||l,editing:l&&"inline"===N,"all-day":c,solid:"solid"===e.displayStyle,"filtered-out":a.filteredOut,"task-completed":a.task&&a.complete,compact:"compact"===t.displayDensity,"event-passed":!h&&!l&&a.end&&a.end<Date.now(),"multiday-continuing":e.multiDayContinuing&&!l,"multiday-continues":e.multiDayContinues&&!l}),style:O,ref:g,onContextMenu:function(e){o.Z.selectEvent(d,{event:a}),(0,zi.Z)(n.vivaldiWindowId,I())(e)},title:iX(a),"data-event-id":a.id,onClick:e=>{l||o.Z.editEvent(d,a),e.stopPropagation()},onKeyDown:M,children:[l&&"inline"===N&&eX(XY,{tabs:Array.from(s.current.values()),currentTabId:y,onSelectTab:w}),eX("div",{className:"cal-event-body"},void 0,l&&"inline"===N&&(0,fn.jsxs)(fn.Fragment,{children:[(0,fn.jsx)("span",{className:"sentry",tabIndex:"0",ref:m}),Array.from(s.current.values(),(e=>{const{id:t,label:n,focusRef:i}=e,s=y===t,o=s?0:-1,r={event:a,updateEvent:S,field:t,label:n,focusRef:i,tabIndex:o};let l;switch(t){case"basics":l=(0,fn.jsx)(_Y,{...r});break;case"recurrence":l=(0,fn.jsx)(OA,{...r});break;case"description":l=(0,fn.jsx)($Y,{...r});break;case"time":l=(0,fn.jsx)(TY,{...r});break;case"participants":l=(0,fn.jsx)(xY,{...r});break;default:l=eX("div",{className:"edit-group"},void 0,(0,fn.jsx)(hY,{...r}))}return(0,fn.jsxs)("div",{ref:e.containerRef,className:mn()("cal-event-body-edit",{selected:s}),children:[l,eX("div",{className:"cal-event-body-buttons"},void 0,eX("input",{onClick:b,onKeyDown:sX,tabIndex:o,type:"submit",value:(0,le.Z)("calendar","Done")}),eX("input",{onClick:P,onKeyDown:sX,tabIndex:o,type:"button",value:_?(0,le.Z)("Cancel"):(0,le.Z)("verb","Delete")}))]},e.id)})),(0,fn.jsx)("span",{className:"sentry",tabIndex:"0",ref:v})]}),(!l||"popup"===N)&&(0,fn.jsxs)(fn.Fragment,{children:[eX("div",{className:"cal-event-header"},void 0,!c&&"transparent"===e.displayStyle&&!a.task&&eX("span",{className:"cal-event-dot",dangerouslySetInnerHTML:{__html:oc.Z.getEventSquircle()}}),a.task&&eX("input",{type:"checkbox",checked:a.complete,onChange:function(t){const{checked:i}=t.target;e.event.complete=i,o.Z.updateEvent(n.vivaldiWindowId,e.event,void 0,!0)},onMouseDown:Cs.Z,onClick:Cs.Z,tabIndex:r?"0":"-1"}),!c&&!!a.start&&!!a.end&&!u&&(0,fn.jsx)("span",{className:"cal-event-time",ref:E,children:kc(a.start)}),!c&&!!a.end&&!p&&u&&(0,fn.jsx)("span",{className:"cal-event-time",ref:E,children:kc(a.end)}),Zc(n.vivaldiWindowId,"title",((e,n,s)=>{switch(t.displayDensity){case"full":default:return e;case"compact":return i(e,n);case"minimal":return s?i(e,s):""}})(a.title,80,80),A),f[D.kCalendarDisplayEventIcons]&&eX("div",{className:"cal-event-icons"},void 0,a.url&&eX("span",{dangerouslySetInnerHTML:{__html:cn.iD7}}),a.location&&eX("span",{dangerouslySetInnerHTML:{__html:cn.sel.small}}),!(!a.notifications||!a.notifications.length)&&eX("span",{dangerouslySetInnerHTML:{__html:cn.l0O.small}}),oc.Z.isRecurringEvent(a)&&eX("span",{dangerouslySetInnerHTML:{__html:cn.ghF.small}}),a.attachment&&a.attachment.length>0&&eX("span",{dangerouslySetInnerHTML:{__html:cn.UEH.small}}))),"minimal"!==t.displayDensity&&eX("div",{className:"cal-event-body-content"},void 0,Zc(n.vivaldiWindowId,"description",a.description||""),Zc(n.vivaldiWindowId,"location",a.location||""),Zc(n.vivaldiWindowId,"url",a.url||""))]})),e.resizeHandler&&!u&&eX("div",{className:"calendar-event-resizer pre "+e.resizeHandler}),e.resizeHandler&&!p&&eX("div",{className:"calendar-event-resizer post "+e.resizeHandler})]}),x]})}const aX=(e,t)=>!e.isEditing&&!t.isEditing&&(e.event===t.event&&e.isSelected===t.isSelected&&e.isMultiDay===t.isMultiDay&&e.isFiltering===t.isFiltering),rX=tn.memo(oX,aX);var lX;function dX(e,t,n,i){lX||(lX="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:lX,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function cX(e,t,n){o.Z.selectDate(e,t,n.clone().subtract(1,"month"))}function hX(e,t,n){o.Z.selectDate(e,t,n.clone().add(1,"month"))}const pX=function(e){const t=tn.useContext(dn.Z),n=e.date.clone(),i=new Date,s=i.getFullYear(),a=i.getMonth(),r=i.getDate(),l=e.date.year(),d=e.date.month(),c=e.date.week(),h=e.date.date();n.startOf("month").subtract(1,"week").startOf("week");const p=[];for(;p.length<7;){const e=n.format("dd");p.push(dX("div",{className:"MonthDayPicker-DayOfWeek"},e,e)),n.add(1,"day")}const u=e.date.clone().endOf("month");for(;n.isSameOrBefore(u)||0!==n.weekday();){const t=n.date()===r&&n.month()===a&&n.year()===s,i=n.date()===h&&n.month()===d&&n.year()===l,u=n.week()===c&&n.year()===l;p.push(dX("div",{className:mn()("MonthDayPicker-Day",{"MonthDayPicker-Day--Current":t,"MonthDayPicker-Day--Selected":i,"MonthDayPicker-Day--SelectedWeek":u&&!i&&!t,"MonthDayPicker-Day--OtherMonth":n.month()!==a}),onClick:o.Z.selectDate.bind(null,e.pageId,n.clone())},n.format("M-D"),n.date())),n.add(1,"day")}return dX("div",{className:"MonthDayPicker"},void 0,dX("header",{className:"MonthDayPicker-Header"},void 0,dX("div",{className:"toolbar-group"},void 0,dX(sl,{className:"button-narrow button-transparent",onClick:cX.bind(null,t.vivaldiWindowId,e.pageId,e.date),tooltip:(0,le.Z)("Previous"),image:cn.mgF.small}),dX(sl,{className:"button-narrow button-transparent",onClick:hX.bind(null,t.vivaldiWindowId,e.pageId,e.date),tooltip:(0,le.Z)("Next"),image:cn.Zu.small})),dX("h2",{className:"MonthDayPicker-Month"},void 0,e.date.format("MMMM YYYY"))),p)},uX="vivaldi/x-calendar-event",gX="vivaldi/x-calendar-create-event",{minimalCreateEvent:mX}=oc.Z,vX={dragging:!1,cancelled:!1,currentX:null,currentY:null,initialTime:0,initialEndTime:0,initialStartRow:0,initialEndRow:0,initialLeftCol:0,initialRightCol:0,resizeEvent:null,draggingFrom:"start",isAllDay:!1};function fX(e,t,n,i,s,a){const[r,l]=tn.useState(""),[d,c]=tn.useState(null),h=tn.useRef(null),p=tn.useRef(null),u=tn.useContext(dn.Z),{document:g,getComputedStyle:m}=u,v=tn.useRef(),f=tn.useRef({...vX});tn.useEffect((()=>{const e=g.createElement("div");e.classList.add("calendar-drag-image"),v.current=e,g.body?.append(e)}),[g]);const y=tn.useCallback((()=>{t&&l({gridTemplateColumns:m(t).gridTemplateColumns,gridTemplateRows:m(t).gridTemplateRows})}),[t,m]),w=tn.useCallback((()=>{l(null)}),[]),b=tn.useCallback((()=>{h.current=null,c(h.current),f.current={...vX},a(!1),w()}),[w,a]);function C(){const{resizeEvent:a}=f.current;if(f.current.dragging){if(a){const e=i(t,f.current,h.current);if(!e)return void b();if(e&&!(0,Sm.default)(e,p.current)){const{eventDraft:t}=Lo.Z.getEditState(),n=a.dataset.eventId;if(t&&t?.id===n)t.start=e.startTime,t.end=e.endTime,o.Z.updateEventEdit(s,t);else{const t=Lo.Z.getEvent(n);t&&o.Z.editEvent(s,{...t,start:e.startTime,end:e.endTime})}p.current=e}}else{const e=n(t,f.current,h.current);if(!e)return void b();(0,Sm.default)(h.current,e)||c(e),h.current=e}requestAnimationFrame(C)}else if(f.current.cancelled)a&&o.Z.cancelEventEdit(s),b();else{const t=h.current;t?o.Z.editEvent(s,null,mX({start:t.startTime,end:t.endTime,allDay:t.isAllDay})).then(b):a&&o.Z.saveEventEdit(e,s).then(b)}}return{gridFrozen:r,handlers:{onDragStart:e=>{if(!e.dataTransfer.items.length){const t=g.elementFromPoint(e.clientX,e.clientY),n=t?.closest(".calendar-event");if(t instanceof u.HTMLElement&&t.classList.contains("calendar-event-resizer"))f.current.resizeEvent=t.parentElement instanceof u.HTMLElement&&t.parentElement||null,t.classList.contains("pre")?f.current.draggingFrom="start":f.current.draggingFrom="end";else if(n instanceof u.HTMLElement){const t=n.dataset.eventId;return e.dataTransfer&&t&&(e.dataTransfer.setData(uX,JSON.stringify({id:t})),e.stopPropagation()),e.dataTransfer.setDragImage(n,20,20),void a(!0)}v.current&&e.dataTransfer.setDragImage(v.current,0,0),e.dataTransfer.setData(gX,!0),f.current.dragging=!0,a(!0),f.current.currentX=e.clientX,f.current.currentY=e.clientY,f.current.resizeEvent||y(),e.stopPropagation(),requestAnimationFrame(C)}},onDragOver:e=>{e.dataTransfer.types.some((e=>e===gX))&&(f.current.currentX=e.clientX,f.current.currentY=e.clientY,e.stopPropagation(),e.preventDefault())},onDragEnd:e=>{a(!1),e.dataTransfer.types.some((e=>e===uX))&&e.stopPropagation(),"none"===e.dataTransfer.dropEffect&&(f.current.dragging=!1,f.current.cancelled=!0,e.stopPropagation(),e.preventDefault())},onDrop:e=>{a(!1),e.dataTransfer.types.some((e=>e===gX))&&(f.current.currentX=e.clientX,f.current.currentY=e.clientY,f.current.dragging=!1,e.stopPropagation())}},overlay:d}}var yX=n(23542),wX=n(90870);function bX(e){return e.task?e.start?{start:e.start,end:e.end}:{start:e.end,end:e.end?e.end+1:0}:{start:e.start,end:e.end}}function CX(e,t=!1){const n=t?Math.ceil:Math.floor,i=new Date(e);return 4*i.getHours()+n(i.getMinutes()/15)}function SX(e,t){e.items.forEach((n=>{const i=AX(e.items,n,t).sort(((e,t)=>e.stacking-t.stacking));let s=0;for(;i[s]&&s===i[s].stacking;)s++;n.stacking=s,n.adjacent=i}))}function TX(e){e.items.forEach((e=>{const t=new Set(e.adjacent.map((e=>e.stacking))).size;e.stackSize=t+1}))}const IX=(e,t)=>0===t?e:IX(t,e%t),kX=(e,t)=>e*t/IX(e,t);function AX(e,t,n){return e.filter((e=>e!==t&&("day"===n?e.startRow<t.endRow&&e.endRow>t.startRow:e.startCol<t.endCol&&e.endCol>t.startCol)))}const ZX=Uu()(2)(((e,t,n)=>{let i=function(e,t){e.sort(((e,t)=>{const{start:n,end:i}=bX(e),{start:s,end:o}=bX(t);if(n!==s)return n-s;const a=i-n,r=o-s;return a!==r?r-a:(parseInt(e.id)||1/0)-(parseInt(t.id)||1/0)}));const n=e.map((e=>{const{start:t,end:n}=bX(e),i=CX(t);let s=CX(n,!0);return 0===s&&t!==n&&(s=96),{event:e,adjacent:[],stacking:1/0,stackSize:-1,startRow:i,endRow:s>i?s:i+1,startCol:0,endCol:0}}));return{columns:-1,maxStackSize:0,items:n}}(e);return SX(i,"day"),TX(i),i=function(e){const t=[...new Set(e.items.map((e=>e.stackSize)))],n=t.reduce(((e,t)=>t>e?t:e),-1),i=Math.min(Math.max(100,n),t.reduce(((e,t)=>kX(e,t)),1)),s=i/n;return{columns:i,maxStackSize:n,items:e.items.map((e=>(e.startCol=Math.ceil(e.stacking*s),e.endCol=Math.floor((e.stacking+1)*s),e)))}}(i),function(e){e.items.sort(((e,t)=>{const n=t.stacking-e.stacking;return 0!==n?n:e.startRow-t.startRow}));const t=[];e.items.forEach((n=>{const i=AX(t,n,"day"),s=Math.min(...i.map((e=>e.startCol)),e.columns),o=s/n.endCol;n.endCol=s,n.startCol=Math.ceil(n.startCol*o),t.push(n)}))}(i),i}));const EX=Uu()(10)(((e,t,n)=>{let i=function(e,t,n){const i=t.clone().startOf("day"),s=e=>{let{start:t,end:s}=bX(e);return s===b()(s).startOf("day").valueOf()&&(s-=1),[(0,jf.default)(b()(t).diff(i,"day"),0,n-1),(0,jf.default)(b()(s).diff(i,"day")+1,1,n)]};let[o,a]=(0,wX.Z)(e,(e=>{const[t,n]=s(e);return n-t>1}));const r=o.sort(((e,t)=>{const{start:n,end:i}=bX(e),{start:s,end:o}=bX(t),a=(i||Q.Lc)-n,r=(o||Q.Lc)-s;return a!==r?r-a:n!==s?n-s:(parseInt(e.id)||1/0)-(parseInt(t.id)||1/0)})).map((e=>{const[t,n]=s(e);return{event:e,adjacent:[],stacking:1/0,stackSize:-1,startCol:t,endCol:n,startRow:0,endRow:0}}));a=a.sort(((e,t)=>{if(!e.id||!t.id)return e.id?-1:1;const n=oc.Z.isMultiDayEvent(e);if(n!==oc.Z.isMultiDayEvent(t))return n?-1:1;const{start:i,end:s}=bX(e),{start:o,end:a}=bX(t);if(i!==o)return i-o;const r=(s||Q.Lc)-i,l=(a||Q.Lc)-o;return r!==l?l-r:(parseInt(e.id)||1/0)-(parseInt(t.id)||1/0)}));const l=[],d=i.clone();for(;d.diff(i,"day")<n;){const e=oc.Z.filterEventsByPeriod(a,d,"day"),t=(0,jf.default)(d.diff(i,"day"),0,n-1);l.push({events:e,adjacent:[],stacking:1/0,stackSize:-1,startCol:t,endCol:t+1,startRow:0,endRow:0,date:d.valueOf()}),d.add(1,"day")}return{rows:-1,maxStackSize:0,items:r,multiEventItems:l,startTime:i.valueOf(),endTime:d.valueOf()}}(e,t,n);return SX(i,"week"),TX(i),i=(e=>{const t=[...new Set(e.items.map((e=>e.stackSize)))].reduce(((e,t)=>t>e?t:e),0);return{...e,rows:t,maxStackSize:t,items:e.items.map((e=>(e.startRow=e.stacking,e.endRow=e.stacking+1,e)))}})(i),i=(e=>{const t=e.multiEventItems.length?e.rows+1:e.rows,n=e.multiEventItems.map((n=>{const i=AX(e.items,n,"week"),s=Math.max(0,...i.map((e=>e.endRow)));return{...n,startRow:s,endRow:t}}));return{...e,rows:t,multiEventItems:n}})(i),i}));var _X;function NX(e,t,n,i){_X||(_X="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:_X,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const MX=(0,yX.extendMoment)(b()),PX=[D.kCalendarClickTimeSlot,D.kCalendarDisplayWeekNumber],{minimalCreateEvent:DX,getDisplayRange:xX}=oc.Z,OX=Uu()(2)((function(e,t,n){const i=xX(t,n),s=[],o=i.start.clone(),a="week"===n?2:7;for(;o<i.end;){const t=o.valueOf(),n=oc.Z.filterEventsByPeriod(e,o,"day",a).map((e=>e.start<t?{...e,id:`${e.id}-${o.dayOfYear()}`}:e)),r=o.isSame(i.end,"day")?1:a;s.push(EX(n,o,r)),o.add(a,"day")}return{grids:s,displayRange:i}}));function LX(e,t){const{resizeEvent:n}=t;if(!e||!n)return;const i=e.querySelectorAll(".calendar-drop-target"),s=!t.initialTime,o=t.currentX||1e5,a=t.currentY||1e5,r=Array.from(i).find((e=>{const t=e.getBoundingClientRect();return t.bottom>a&&t.right>o}));if(!r)return;if(s){const e=Lo.Z.getEvent(n.dataset.eventId);if(!e)return;t.initialTime=e.start,t.initialEndTime=e.allDay?e.end-yc.hd:e.end,t.isAllDay=e.allDay??!1}const l=parseInt(r.dataset.date),d=l+(0,bc.oR)(t.initialTime),c=l+(0,bc.oR)(t.initialEndTime);let h,p;return"end"===t.draggingFrom&&c<=t.initialTime||"start"===t.draggingFrom&&d<t.initialEndTime?(h=d,p=t.initialEndTime):(h=t.initialTime,p=c),{startTime:h,endTime:p,isAllDay:t.isAllDay}}function RX(e,t){if(!e)return;const n=Array.from(e.querySelectorAll(".calendar-drop-target")),i=!t.initialTime,s=t.currentX||1e5,o=t.currentY||1e5,a=n.find((e=>{const t=e.getBoundingClientRect();return t.bottom>o&&t.right>s}));if(a&&i){const{resizeEvent:e}=t;if(e)return;t.initialTime=parseInt(a.dataset.date),t.initialEndTime=t.initialTime,t.initialLeftCol=parseInt(a.style.gridColumnStart),t.initialRightCol=t.initialLeftCol+1,t.initialStartRow=parseInt(a.style.gridRowStart),t.initialEndRow=t.initialStartRow+parseInt(a.style.gridRowEnd.match(/\d/)?.[0]),t.isAllDay=!0}if(a){const e=t.initialLeftCol,n=t.initialStartRow,i=parseInt(a.style.gridColumnStart),s=parseInt(a.style.gridRowStart);let o,r,l,d,c,h,p=!0,u="initialStartToCurrent";return(parseInt(a.dataset.date)<t.initialTime||t.resizeEvent&&"start"===t.draggingFrom)&&(u="initialEndToCurrent",p=!1),"initialStartToCurrent"===u?(o=e,r=parseInt(a.style.gridColumnStart)+1,l=n,d=parseInt(a.style.gridRowStart)+parseInt(a.style.gridRowEnd.match(/\d/)?.[0])):(o=i,r=t.initialRightCol,l=s,d=t.initialEndRow),p?(c=t.initialTime,h=parseInt(a.dataset.date)+(0,bc.oR)(t.initialEndTime)):(c=parseInt(a.dataset.date)+(0,bc.oR)(t.initialTime),h=t.initialEndTime),{startCol:o,endCol:r,startRow:l,endRow:d,startTime:c,endTime:h,isAllDay:t.isAllDay}}}function BX(e,t){const n=e.selectedDate.clone().startOf("day").valueOf()+(new Date).getHours()*yc.QI;o.Z.editEvent(t,null,DX({start:n}))}function FX(e){return e.reduce(((e,t)=>e=(e=e.concat(t.items.map((e=>e.event)))).concat(t.multiEventItems.reduce(((e,t)=>e.concat(t.events)),[]))),[])}function UX(e){const t=(0,Tm.Z)(PX);if(!e.overlay)return null;const{startRow:n,endRow:i,startCol:s,endCol:o,startTime:a,endTime:r}=e.overlay,l="week"===e.displayMode?1:2,d=t[D.kCalendarDisplayWeekNumber]&&"week"!==e.displayMode?2:1,c="week"===e.displayMode?2:7;return e.grids.reduce((([t,l],h)=>{const p=h.rows+2,u=l===n,g=l+p===i,m=mn()("calendar-drag-overlay",{left:u,right:g});if(u){const i={gridRowStart:n,gridRowEnd:l+p,gridColumnStart:s,gridColumnEnd:g?o:d+c},h=e.overlay?.isAllDay??1?"L":"LLL";t.push(NX("div",{className:m,style:i},l,NX("div",{className:"start-time"},void 0,u&&(0,fn.jsx)(fn.Fragment,{children:MX(a).format(h)})),NX("div",{className:"end-time"},void 0,g&&(0,fn.jsx)(fn.Fragment,{children:MX(r).format(h)}))))}else if(l>n&&l<i){const n={gridRowStart:l,gridRowEnd:l+p,gridColumnStart:d,gridColumnEnd:g?o:d+c},i=e.overlay?.isAllDay??1?"L":"LLL";t.push(NX("div",{className:m,style:n},l,NX("div",{className:"start-time"},void 0,u&&NX("span",{},void 0,MX(a).format(i))),NX("div",{className:"end-time"},void 0,g&&NX("span",{},void 0,MX(r).format(i)))))}return[t,l+p]}),[[],l])}function VX(e){const t=e.showWeekNumber?2:1,n=MX().startOf("week");return[...Array(7).keys()].map((e=>{const i=NX(tn.Fragment,{},e,NX("header",{style:{gridColumnStart:e+t},className:"calendar-header-date"},void 0,n.format("dddd")));return n.add(1,"days"),i}))}function WX(e){const[t,n]=tn.useState(""),i=(0,Tm.Z)(PX),s=e.displayRange.start.valueOf(),a=i[D.kCalendarDisplayWeekNumber]&&"week"!==e.displayMode,r=tn.useMemo((()=>{const r=Lo.Z.getFilter(e.editor.pageId),l=e=>{e.dataTransfer.types.some((e=>e===uX))&&(e.preventDefault(),e.stopPropagation())},d=e=>{e.dataTransfer.types.some((e=>e===uX))&&(e.preventDefault(),e.stopPropagation())},c=MX(s),h=a?2:1,p=r.anchorDate.month(),u=new Date,g="week"===e.displayMode?2:7;let m="week"===e.displayMode?2:3;return e.grids.flatMap(((s,v)=>{const f=[];return a&&f.push(NX(tn.Fragment,{},v,NX("div",{className:"week-number",style:{gridRowStart:m-1,gridRowEnd:`span ${s.rows+2}`}},void 0,NX("span",{className:"week-number-value"},void 0,c.week())))),[...Array(g).keys()].forEach((a=>{if("week"===e.displayMode&&3===v&&1===a)return;const g=`${v}-${a}`,y=c.valueOf(),w=c.month()===p,b=Number(c.format("E"))>5,C="week"!==e.displayMode&&(0===v&&0===a||1===c.date()),S=c.date()===u.getDate()&&c.month()===u.getMonth()&&c.year()===u.getFullYear(),T=c.isSame(r.selectedDate,"day"),I=t=>((t,n)=>{"click"===t.type&&t.stopPropagation();const s=n+(new Date).getHours()*yc.QI;"select"===i[D.kCalendarClickTimeSlot]||"contextmenu"===t.type?o.Z.selectDate(e.windowId,e.editor.pageId,MX(s),{isAllDay:!0}):(r.allDaySelected||o.Z.selectDate(e.windowId,e.editor.pageId,MX(s),{isAllDay:!0}),o.Z.editEvent(e.editor,null,DX({start:s})))})(t,y);f.push(NX("div",{className:mn()("calendar-drop-target",{current:S,"dragged-over":g===t,"out-of-view":"month"===e.displayMode&&!w,weekend:b}),"data-date":y,style:{gridRowStart:m-1,gridRowEnd:`span ${s.rows+2}`,gridColumnStart:a+h},onDragEnter:e=>((e,t)=>{e.dataTransfer.types.some((e=>e===uX))&&(e.preventDefault(),e.stopPropagation(),n(t))})(e,g),onDragOver:d,onDragLeave:l,onDrop:t=>((t,i)=>{const s=t.dataTransfer;if(s.types.some((e=>e===uX))){t.preventDefault(),t.stopPropagation();const a=JSON.parse(s.getData(uX)).id.split("-")[0];e.events.find((e=>e.id===a))&&(o.Z.moveEvent(e.windowId,e.editor,a,{start:i,byDateOnly:!0}),n(""))}})(t,y),onClick:I,onContextMenu:I},g,(0,fn.jsxs)("div",{className:"day",ref:e=>{T&&e&&requestAnimationFrame((()=>{e.scrollIntoView({block:"nearest",inline:"nearest"})}))},onClick:t=>{t.stopPropagation(),o.Z.selectDate(e.windowId,e.editor.pageId,MX(y),{isAllDay:!0})},children:[S&&NX("span",{className:"current-day"},void 0,c.format("D")),!S&&c.format("D"),"week"===e.displayMode&&" "+c.format("ddd"),C&&" "+c.format("MMM")]}))),c.add(1,"day")})),m+=s.rows+2,f}))}),[t,s,e.windowId,e.displayMode,e.grids,i,e.editor,e.events,a]),l=[...r],d="week"===e.displayMode?2:7,c=e.filter.selectedDate.valueOf()-s,h=Math.floor(c/(d*yc.hd)),p=e.grids.slice(0,h+1).reduce(((e,t)=>e+t.rows+2),0)+("week"===e.displayMode?0:1),u=Math.floor(c/yc.hd)%d+(a?2:1),g=!e.selectedEvent&&!e.editingEvent;if(l.push((0,fn.jsx)("div",{className:mn()("calendar-add-event-button","selected","bottom",{active:g}),style:{gridRowStart:p,gridRowEnd:"span 1",gridColumnStart:u},ref:e=>{g&&e&&requestAnimationFrame((()=>{e.scrollIntoViewIfNeeded({block:"nearest",inline:"nearest"})}))},onClick:g?()=>BX(e.filter,e.editor):Tl.default,children:g&&"+"},"add-event-button")),"week"===e.displayMode){const t=7+e.grids[0].rows+e.grids[1].rows+e.grids[2].rows;l.push(NX("div",{className:"calendar-day-picker",style:{gridRowStart:t,gridRowEnd:`span ${e.grids[3].rows+2}`,gridColumnStart:2}},"pickerCell",NX(pX,{date:e.filter.selectedDate,pageId:e.editor.pageId})))}return l}function HX(e){const t=(0,Tm.Z)(PX),{displayMode:n,editingEvent:i,grids:s,filter:o,selectedEvent:a,isActiveEditor:r}=e,l=Boolean(o.filterText),d=tn.useMemo((()=>({displayStyle:"transparent",isFiltering:l})),[l]);let c=[],h="week"===n?2:3;const p=t[D.kCalendarDisplayWeekNumber]&&"week"!==n?1:0;return s.forEach((t=>{c=c.concat(t.items.map((n=>{const s=n.event.end,o=r&&i?.id===n.event.id&&!e.isDragging,l=n.event.id.split("-")[0]===a?.split("-")[0],c=o&&i?i:n.event,u={gridRowStart:n.startRow+h,gridColumnStart:n.startCol+p+1,gridColumnEnd:n.endCol+p+1};return(0,fn.jsx)(rX,{multiDayContinuing:(n.event.start||1/0)<t.startTime,multiDayContinues:s>t.endTime,event:c,style:u,...d,isMultiDay:oc.Z.isMultiDayEvent(n.event),isSelected:l,isEditing:o,editor:e.editor,resizeHandler:"horizontal"},`${oc.Z.generateKey(n.event)}-${u.gridRowStart}`)}))),c=c.concat(t.multiEventItems.map((n=>{const s=i&&n.events.some((e=>e.id===i.id)),l=new Date(n.date),c=l.getDate()===o.selectedDate.date()&&l.getMonth()===o.selectedDate.month()&&l.getFullYear===o.selectedDate.year(),u=c&&!a&&!i,g=l.toDateString();return NX("div",{className:mn()("event-container",{selected:s}),style:{gridRowStart:n.startRow+h,gridRowEnd:t.rows+h,gridColumnStart:n.startCol+p+1,gridColumnEnd:n.endCol+p+1}},`${g}-${h}`,n.events.map((n=>{const s=r&&i?.id===n.id&&!e.isDragging,o=n.id.split("-")[0]===a?.split("-")[0],l=s&&i?i:n;return(0,fn.jsx)(rX,{event:l,...d,multiDayContinuing:(n.start||1/0)<t.startTime,multiDayContinues:n.end>t.endTime,isMultiDay:oc.Z.isMultiDayEvent(n),isSelected:o,isEditing:s,editor:e.editor,resizeHandler:"horizontal"},oc.Z.generateKey(n))})),c&&NX("div",{className:mn()("calendar-add-event-button top",{active:u,selected:c}),id:g,onClick:u?()=>BX(e.filter,e.editor):Tl.default}))}))),h+=t.rows+2})),c}const zX=function(e){const t=(0,Tm.Z)(PX),n=tn.useContext(OD),i=tn.useContext(dn.Z),s=tn.useRef(null),[a,r]=tn.useState([]),[l,d]=tn.useState(MX.range()),[c,h]=tn.useState(!1),p=tn.useMemo((()=>({pageId:n.editor.pageId,uid:e.editorUid})),[n.editor.pageId,e.editorUid]),{gridFrozen:u,handlers:g,overlay:m}=fX(i.vivaldiWindowId,s.current,RX,LX,p,h),v=!c&&e.editingEvent?{onDragStart:Cs.Z}:g,f=tn.useRef({initialFocusTaken:!1,wasEditing:!!e.editingEvent&&n.editor.uid===p.uid,selectedEventCache:new Map,lastSelectedEvent:null,navigationPending:!1,updateCreateOverlay:()=>{}}),{events:y,filter:w,displayMode:b}=e;tn.useMemo((()=>{let t=y;c&&e.editingEvent&&(t=y.map((t=>t.id===e.editingEvent?.id?e.editingEvent:t)).filter(Boolean));const n=OX(t,w.anchorDate,b);r(n.grids),d(n.displayRange)}),[b,y,w.anchorDate,c,e.editingEvent]),tn.useEffect((()=>{f.current.wasEditing=!!e.editingEvent&&n.editor.uid===p.uid}));const C=(t,n,s)=>{f.current.navigationPending=!1;const a=e.filter.selectedDate,r=t||f.current.lastSelectedEvent,l=r?document.getElementById(r.id):document.getElementById(a.toDate().toDateString()),d=a.clone();if("Left"===s?d.subtract(1,"day"):d.add(1,"day"),!l)return f.current.selectedEventCache.clear(),void o.Z.selectDate(i.vivaldiWindowId,p.pageId,d,{isAllDay:!0});const c=n.map((e=>{const t=document.getElementById(e.id);return{event:e,element:t,bounds:t?t.getBoundingClientRect():{top:0,bottom:0}}})).filter((e=>Boolean(e.element))),h=l.getBoundingClientRect(),u=c.filter((e=>e.bounds.bottom>h.top&&e.bounds.top<h.bottom)).sort(((e,t)=>{const n=(h.top+h.bottom)/2,i=(e.bounds.top+e.bounds.bottom)/2,s=(t.bounds.top+t.bounds.bottom)/2;return Math.abs(i-n)-Math.abs(s-n)}));if(u.length){const e=u[0];S(e.event,d)}else o.Z.selectDate(i.vivaldiWindowId,p.pageId,d,{isAllDay:!0})},S=(e,t)=>{if(e){const t=MX(e.start).format("YYYY-MM-DD");f.current.selectedEventCache.set(t,e),f.current.lastSelectedEvent=e}else f.current.selectedEventCache=new Map,f.current.lastSelectedEvent=null;o.Z.selectEvent(p,{event:e,date:t,allDay:!0})};let T={};if(u)T=u;else{const t="week"===e.displayMode?"":"max-content ";T.gridTemplateRows=a.reduce(((e,t)=>`${e} 1.9em ${"max-content ".repeat(Math.max(t.rows-1,0))} ${t.rows?"minmax(min-content, 1fr) ":""} minmax(20px, 1fr) `),t)}const I=t[D.kCalendarDisplayWeekNumber]&&"week"!==b;return(0,fn.jsxs)("div",{className:mn()("calendar-grid calendar-grid-days",`calendar-grid-${e.displayMode}`,{"is-dragging":c,"show-weeknumber":I}),onKeyDown:t=>{const n=FX(a),s=t.altKey;if(!e.editingEvent){const a="week"===e.displayMode?2:7,r=n.find((t=>t.id===e.selectedEvent)),d=e.filter.selectedDate,c=d.weekday();switch(kA.Z[t.keyCode]){case"Left":{if(f.current.navigationPending||c%a==0)break;const e=d.clone().subtract(1,"day"),t=e.format("YYYY-MM-DD"),s=f.current.selectedEventCache.get(t);if(s){S(s,e);break}if(r||f.current.lastSelectedEvent){const t=oc.Z.filterEventsByPeriod(n,e,"day");requestAnimationFrame(C.bind(this,r,t,"Left")),f.current.navigationPending=!0}else o.Z.selectDate(i.vivaldiWindowId,p.pageId,e,{isAllDay:!0});break}case"Right":{if(f.current.navigationPending||c%a==a-1||6===c)break;const e=d.clone().add(1,"day"),t=e.format("YYYY-MM-DD"),s=f.current.selectedEventCache.get(t);if(s){S(s,e);break}if(r||f.current.lastSelectedEvent){const t=oc.Z.filterEventsByPeriod(n,e,"day");requestAnimationFrame(C.bind(this,r,t,"Right")),f.current.navigationPending=!0}else o.Z.selectDate(i.vivaldiWindowId,p.pageId,e,{isAllDay:!0});break}case"Up":{f.current.selectedEventCache=new Map,f.current.lastSelectedEvent=null;const t=oc.Z.filterEventsByPeriod(n,d,"day"),r=t.findIndex((t=>t.id===e.selectedEvent));if(-1===r&&t.length&&!s)S(t[t.length-1],d);else if(0===r||!t.length||s){let t=a;"week"===e.displayMode&&c<2&&(t=0===c?1:3),o.Z.selectDate(i.vivaldiWindowId,p.pageId,d.clone().subtract(t,"day"),{isAllDay:!0})}else S(t[r-1],d);break}case"Down":{f.current.selectedEventCache=new Map,f.current.lastSelectedEvent=null;let t=oc.Z.filterEventsByPeriod(n,d,"day");const r=t.findIndex((t=>t.id===e.selectedEvent));let h=a;if("week"===e.displayMode&&c>=5&&(h=5===c?3:1),s){const e=d.clone().add(h,"day");o.Z.selectDate(i.vivaldiWindowId,p.pageId,e,{isAllDay:!0})}else if(-1===r){const e=d.clone().add(h,"day");if(e.isAfter(l.end,"day")){const n=Nc.t.call(Lo.Z.getEvents(),e,"day");t=FX([EX(n,e,1)])}else t=oc.Z.filterEventsByPeriod(n,e,"day");t.length?S(t[0],e):o.Z.selectDate(i.vivaldiWindowId,p.pageId,e,{isAllDay:!0})}else r===t.length-1?S(null):S(t[r+1],d);break}case"Enter":if((0,Cs.Z)(t),e.selectedEvent){const t=n.find((t=>t.id===e.selectedEvent));o.Z.editEvent(p,t)}else{const e=d.clone().hours((new Date).getHours()).valueOf();o.Z.editEvent(p,null,DX({start:e}))}break;case"Escape":(0,Cs.Z)(t),e.selectedEvent&&S(null)}}},draggable:!0,...v,style:T,tabIndex:"0",ref:t=>{t&&(!e.editingEvent&&f.current.wasEditing||!f.current.initialFocusTaken)&&(t.focus(),f.current.initialFocusTaken=!0),s.current=t},children:["week"!==e.displayMode&&NX(VX,{showWeekNumber:I}),NX(WX,{windowId:i.vivaldiWindowId,displayRange:l,displayMode:b,editingEvent:e.editingEvent,editor:p,events:y,filter:w,grids:a,selectedEvent:e.selectedEvent}),NX(HX,{grids:a,displayMode:b,editor:p,editingEvent:e.editingEvent,selectedEvent:e.selectedEvent,filter:w,isActiveEditor:n.editor.uid===p.uid,isDragging:c,setIsDragging:h}),NX(UX,{overlay:m,displayMode:b,grids:a})]})};function GX(e){return"time"in e}function $X(e,t,n,i){let s,o,a;const r=n||t;let l;const d=i[8];switch(e){case"Left":l=r.isAllDay?r:t,s=e=>e.navigation.right<r.navigation.right&&e.navigation.top<l.navigation.bottom&&e.navigation.bottom>l.navigation.top,o=(e,t)=>t.navigation.right-e.navigation.right,a=(e,t)=>e.navigation.top-t.navigation.top;break;case"Right":l=r.isAllDay?r:t,s=e=>e.navigation.right>r.navigation.right&&e.navigation.left>=r.navigation.left&&e.navigation.top<l.navigation.bottom&&e.navigation.bottom>l.navigation.top,o=(e,t)=>e.navigation.left-t.navigation.left,a=(e,t)=>e.navigation.top-t.navigation.top;break;case"Up":{const e=d.display.bottom-d.display.top-1;l=r.isAllDay?t:r,s=e=>e.navigation.bottom<=r.navigation.top&&e.navigation.left<l.navigation.right&&e.navigation.right>l.navigation.left,o=(t,n)=>{const i=GX(t)||t.isAllDay?t.navigation.bottom:t.navigation.bottom+e;return(GX(n)||n.isAllDay?n.navigation.bottom:n.navigation.bottom+e)-i},a=(e,t)=>e.navigation.left-t.navigation.left;break}case"Down":{const e=d.display.bottom-d.display.top-1;l=r.isAllDay?t:r,s=e=>e.navigation.top>=r.navigation.bottom&&e.navigation.left<l.navigation.right&&e.navigation.right>l.navigation.left,o=(t,n)=>(!GX(t)||t.isAllDay?t.navigation.top-e:t.navigation.top)-(!GX(n)||n.isAllDay?n.navigation.top-e:n.navigation.top),a=(e,t)=>e.navigation.left-t.navigation.left;break}default:return}const c=i.filter(s).sort(((e,t)=>{const n=o(e,t);return 0!==n?n:GX(e)!==GX(t)?GX(e)?1:-1:a(e,t)}));return c.length?c[0]:null}var KX,jX=n(72877),YX=n(26199),XX=n(34155);function QX(e,t,n,i){KX||(KX="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:KX,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const qX=[D.kCalendarCollapseHours,D.kCalendarClickTimeSlot,D.kCalendarDayEnds,D.kCalendarDayStarts,D.kCalendarOnlyHourlyKeynav,D.kCalendarTimeIncrements],{minimalCreateEvent:JX}=oc.Z,eQ={day:{row:1,column:2},week:{row:2,column:2},year:{row:1,column:2}},tQ=96,nQ={adjacent:[],stacking:0,stackSize:0,startRow:0,endRow:1,startCol:0,endCol:1};function iQ(e,t,n){const i=b()();if(e.isSame(i,t)){const e=CX(i.valueOf())+eQ[t].row,s=Math.round(i.minutes()%15/15*100);let o=0,a=n[0]+1;if("week"===t){const e=i.weekday();o=(0,jX.Z)(n.slice(0,e))+e,a=n[e]+1}return{row:e,percentage:s,column:o,columnSpan:a}}}function sQ(e,t,n,i){const s=i?(0,jX.Z)(i.slice(0,n.startCol)):n.startCol,o=i?(0,jX.Z)(i.slice(0,n.endCol)):n.endCol;return{left:t+s,top:e+n.startRow,right:t+o,bottom:e+n.endRow}}const oQ=Uu()(2)((function(e,t,n,i,s,o){const[a,r]=(0,wX.Z)(e,oc.Z.isMultiDayEvent);a.sort(((e,t)=>e.start!==t.start?e.start-t.start:e.end!==t.end?e.end-t.end:(parseInt(e.id)||1/0)-(parseInt(t.id)||1/0)));const[l,d,c]=function(e,t,n,i){const s=[];if("day"===i)s.push(ZX(e,n));else if("week"===i){const t=n.clone().startOf("week");[...Array(7).keys()].forEach((n=>{const i=oc.Z.filterEventsByPeriod(e,t,"day");s.push(ZX(i,t)),t.add(1,"days")}))}let o;if("day"===i){const e=n.clone().startOf("day").valueOf();o={maxStackSize:1,rows:t.length,items:[],multiEventItems:t.length?[{...nQ,date:n.valueOf(),events:t}]:[],startTime:e,endTime:e+yc.hd}}else o=EX(t,n.clone().startOf("week"),7);const a=s.map((e=>e.columns));return[s,o,a]}(r,a,t,n),{timeCells:h,eventCells:p}=function(e,t,n,i,s,o,a,r){function l(e){return 60*e.hour()+e.minute()}const d=b()(e).startOf(t),c=s.map((e=>e+1)),h=i?i.rows+1:1;let p,u,g=[],m=eQ[t].row,v=[];if(m=eQ[t].row,p=eQ[t].column,i){const e={start:i.startTime,end:i.startTime+yc.S};v=v.concat(i.items.map((t=>{const n=sQ(m,p,t,c);return{display:n,navigation:n,isAllDay:!0,event:t.event,time:e}}))),v=v.concat(i.multiEventItems.map((t=>{const n=sQ(m,p,t,c);return{display:n,navigation:n,isAllDay:!0,events:t.events,time:e}})))}m+=h,p=eQ[t].column,v=v.concat(n.flatMap((e=>{const t=e.items.map((e=>({display:{...sQ(m,p,e)},navigation:{...sQ(m,p,e)},isAllDay:!1,event:e.event})));return p+=e.columns+1,t}))),m=eQ[t].row,p=eQ[t].column,u=d.clone(),g=g.concat(c.map((e=>{const t=u.valueOf();u.add(1,"day");const n=u.valueOf(),i=p,s=m,o=p+e,a=m+h,r=v.filter((e=>e.navigation.left<o&&e.navigation.right>i&&e.navigation.top<a&&e.navigation.bottom>s)).reduce(((e,t)=>Math.max(e,t.navigation.bottom)),s);return p+=e,{display:{left:i,top:s,right:o,bottom:a},navigation:{left:i,top:r,right:o,bottom:a},isAllDay:!0,time:{start:t,end:n}}}))),m+=h,p=eQ[t].column,u=d.clone();const f=Math.max(60*o-r,0),y=60*a;return u.add(f,"minute"),g=g.concat(c.flatMap(((e,t)=>{const n=[];for(;u.diff(d,"day")===t;){const t=p,i=l(u)===f?m:m+l(u)/15,s=p+e,o=u.valueOf();u.add(r,"minute");const a=l(u),d=a>y||0===a?m+tQ:m+l(u)/15,c=u.valueOf(),h=v.filter((e=>e.navigation.left<s&&e.navigation.right>t&&e.navigation.top<d&&e.navigation.bottom>i)),g=h.reduce(((e,t)=>Math.max(e,t.navigation.right)),t),w={display:{left:t,top:i,right:s,bottom:d},navigation:{left:g,top:i,right:s,bottom:d},isAllDay:!1,time:{start:o,end:c}};l(u)>y&&(u.add(1,"day").startOf("day"),w.time.end=u.valueOf(),u.add(f,"minute")),n.push(w)}return p+=e,n}))),{timeCells:g,eventCells:v}}(t,n,l,d,c,i,s,o);return{grids:l,gridColumns:c,allDayGrid:d,timeCells:h,eventCells:p}}));function aQ(e,t,n){const i=e?.querySelectorAll(".quarter"),s=e?.querySelectorAll(".calendar-background-day");if(i&&s){let e=!1;const o=[...i].find(((t,i)=>{const s=t.getBoundingClientRect(),o=s.bottom>n;return o&&0===i&&n<s.top&&(e=!0),o})),a=[...s].find((e=>e.getBoundingClientRect().right>t));if(o&&a)return{currentRow:o,currentCol:a,isAllDayRow:e}}return{}}function rQ(e,t,n){const{resizeEvent:i}=t;if(!e||!i)return;const s=t.currentX??1e5,o=t.currentY??1e5,{currentRow:a,currentCol:r,isAllDayRow:l}=aQ(e,s,o);if(a&&r){const e=!t.initialTime,s=e?l:n?.isAllDay||!1;if(e){const e=Lo.Z.getEvent(i.dataset.eventId);if(!e)return;t.initialTime=e.start,t.initialEndTime=e.allDay?e.end-yc.hd:e.end}const o=s?parseInt(r.dataset.date):parseInt(r.dataset.date)+parseInt(a.dataset.starttime),d=s?parseInt(r.dataset.date)+yc.hd:parseInt(r.dataset.date)+parseInt(a.dataset.endtime);let c,h;return"end"===t.draggingFrom&&d<=t.initialTime||"start"===t.draggingFrom&&o<t.initialEndTime?(c=o,h=t.initialEndTime):(c=t.initialTime,h=d),{startTime:c,endTime:h,isAllDay:s}}}function lQ(e,t,n){if(!e)return;const i=t.currentX??1e5,s=t.currentY??1e5;let{currentRow:o,currentCol:a,isAllDayRow:r}=aQ(e,i,s);if(o&&a){const e=!t.initialTime,i=e?r:n?.isAllDay||!1;if(e){if(t.resizeEvent)return;t.initialTime=parseInt(a.dataset.date)+parseInt(o.dataset.starttime),t.initialEndTime=parseInt(a.dataset.date)+parseInt(o.dataset.endtime),t.initialStartRow=parseInt(o.style.gridRowStart),t.initialEndRow=parseInt(o.style.gridRowEnd),t.initialLeftCol=parseInt(a.style.gridColumnStart),t.initialRightCol=parseInt(a.style.gridColumnEnd)}i&&(o=a);const s=t.initialLeftCol,l=t.initialStartRow,d=parseInt(a.style.gridColumnStart),c=parseInt(o.style.gridRowStart);let h,p,u,g,m,v,f=!0;return s<d?i?("start"===t.draggingFrom?(h=parseInt(a.style.gridColumnStart),p=t.initialRightCol):(h=s,p=parseInt(a.style.gridColumnEnd)),u=parseInt(o.style.gridRowStart),g=l):(h=s,p=parseInt(a.style.gridColumnEnd),u=l,g=parseInt(o.style.gridRowEnd)):s>d?(h=parseInt(a.style.gridColumnStart),p=t.initialRightCol,u=parseInt(o.style.gridRowStart),g=t.initialEndRow,f=!1):(h=s,p=t.initialRightCol,"end"===t.draggingFrom&&l<=c||"start"===t.draggingFrom&&t.initialEndRow<=c?(u=l,g=parseInt(o.style.gridRowEnd)):(u=c,g=t.initialEndRow,f=!1)),f?(m=t.initialTime,v=i?parseInt(a.dataset.date):parseInt(a.dataset.date)+parseInt(o.dataset.endtime)):(m=i?parseInt(a.dataset.date):parseInt(a.dataset.date)+parseInt(o.dataset.starttime),v=t.initialEndTime),{startCol:h,endCol:p,startRow:u,endRow:g,startTime:m,endTime:v,isAllDay:i}}}function dQ(e){if(!e.overlay)return null;const{startRow:t,endRow:n,startCol:i,endCol:s,startTime:o,endTime:a,isAllDay:r}=e.overlay,l={gridRowStart:t,gridRowEnd:n,gridColumnStart:i,gridColumnEnd:s};if(r)return QX("div",{className:"calendar-drag-overlay start end",style:l},void 0,QX("div",{className:"start-time"},void 0,b()(o).format("L")),QX("div",{className:"end-time"},void 0,b()(a).format("L")));{const[t]=e.columnSizes.reduce((([t,r],d)=>{const c=d+1,h=r===i,p=s>r&&s<=r+c,u=mn()("calendar-drag-overlay",{start:h,end:p});return h?(l.gridRowEnd=p?n:e.rowOffset+tQ,l.gridColumnEnd=r+d,t.push(QX("div",{className:u,style:{...l}},r,QX("div",{className:"start-time"},void 0,h&&(0,fn.jsx)(fn.Fragment,{children:b()(o).format("LT")})),QX("div",{className:"end-time"},void 0,p&&(0,fn.jsx)(fn.Fragment,{children:b()(a).format("LT")}))))):r>i&&r<s&&(l.gridRowStart=e.rowOffset,l.gridColumnStart=r,l.gridColumnEnd=r+d,l.gridRowEnd=p?n:e.rowOffset+tQ,t.push(QX("div",{className:u,style:{...l}},r,QX("div",{className:"start-time"},void 0,h&&QX("span",{},void 0,b()(o).format("LT"))),QX("div",{className:"end-time"},void 0,p&&QX("span",{},void 0,b()(a).format("LT")))))),[t,r+c]}),[[],e.colOffset]);return t}}var cQ=QX("div",{className:"hour-value"},void 0,"0:00"),hQ=QX("div",{className:"hour-value"},void 0,"0:00");function pQ(e){const t=(0,Tm.Z)([D.kCalendarCollapseHours,D.kCalendarDayEnds,D.kCalendarDayStarts,D.kCalendarTimeIncrements,D.kCalendarOnlyHourlyDivider]),{anchorDate:n,displayMode:i,allDayGrid:s,pageId:a}=e,r=tn.useContext(dn.Z);return tn.useMemo((function(){function e(e,t){e.stopPropagation();const n=Lo.Z.getFilter(a),i=b()(n.selectedDate).hours(t);o.Z.selectDate(r.vivaldiWindowId,a,i,{isAllDay:!1})}const l=t[D.kCalendarCollapseHours],d=l?t[D.kCalendarDayStarts]:0,c=l&&t[D.kCalendarDayEnds]||24,h=n.clone().startOf("day").hour(d),p=parseInt(t[D.kCalendarTimeIncrements]);let u=eQ[i].row;s&&(u+=s.rows+1);const g=(0,YX.Z)(d,c);let m=[];return m=15===p?[{rowOffset:0,span:1,startOffset:0,endOffset:9e5},{rowOffset:1,span:1,startOffset:9e5,endOffset:18e5},{rowOffset:2,span:1,startOffset:18e5,endOffset:27e5},{rowOffset:3,span:1,startOffset:27e5,endOffset:36e5}]:30===p?[{rowOffset:0,span:2,startOffset:0,endOffset:18e5},{rowOffset:2,span:2,startOffset:18e5,endOffset:36e5}]:[{rowOffset:0,span:4,startOffset:0,endOffset:36e5}],(0,fn.jsxs)(fn.Fragment,{children:[QX("div",{className:"hour-track",style:{gridRowEnd:tQ+u}}),d>0&&(0,fn.jsxs)(fn.Fragment,{children:[QX("div",{className:"hour",onClick:t=>e(t,d-1),style:{gridRowStart:u,gridRowEnd:"span "+4*d}},void 0,cQ),QX("div",{className:"quarter collapsed morning","data-starttime":d*yc.QI-p*yc.lb,"data-endtime":d*yc.QI,style:{gridRowStart:u,gridRowEnd:u+4*d}}),QX("div",{className:"hour-line",style:{gridRowStart:u}})]}),g.map(((n,i)=>{const s=u+4*n,o=QX(tn.Fragment,{},`fr${i}`,QX("div",{className:"hour",onClick:t=>e(t,n),style:{gridRowStart:s}},void 0,QX("div",{className:"hour-value"},void 0,h.format("H:mm"))),m.map(((e,i)=>QX(tn.Fragment,{},e.rowOffset,QX("div",{className:"quarter",style:{gridRowStart:s+e.rowOffset,gridRowEnd:s+e.rowOffset+e.span},"data-starttime":n*yc.QI+e.startOffset,"data-endtime":n*yc.QI+e.endOffset}),0!==i&&!t[D.kCalendarOnlyHourlyDivider]&&QX("div",{className:"quarter-line",style:{gridRowStart:s+e.rowOffset}})))),QX("div",{className:"hour-line",style:{gridRowStart:s}}));return h.add(1,"hour"),o})),c<24&&(0,fn.jsxs)(fn.Fragment,{children:[QX("div",{className:"hour-line",style:{gridRowStart:u+4*c}}),QX("div",{className:"hour",onClick:t=>e(t,h.hour()),style:{gridRowStart:u+4*c},style:{gridRowStart:u+4*c,gridRowEnd:u+96}},void 0,QX("div",{className:"hour-value"},void 0,h.format("H:mm"))),QX("div",{className:"quarter collapsed evening","data-starttime":c*yc.QI,"data-endtime":c*yc.QI+p*yc.lb,style:{gridRowStart:u+4*c,gridRowEnd:u+tQ}})]}),QX("div",{className:"hour hour-last",style:{gridRowStart:u+tQ-1}},void 0,hQ)]})}),[r.vivaldiWindowId,t,s,n,i,a])}function uQ(e){const{anchorDate:t,displayMode:n,gridColumns:i,pageId:s}=e,a=tn.useContext(dn.Z);return tn.useMemo((function(){const e=[];if("week"===n){const n=t.clone().startOf("week");let r=2;i.forEach(((t,i)=>{const l=n.format(F.ZP.getWeekdayFormat(F.ZP.getShortDateFormat())),d=n.valueOf();e.push(QX(tn.Fragment,{},i,QX("header",{style:{gridRowStart:1,gridColumnStart:r,gridColumnEnd:r+t+1},className:"calendar-header-date",onClick:e=>{e.stopPropagation();const t=Lo.Z.getFilter(s),n=b()(d).hours(t.selectedDate.hours());o.Z.selectDate(a.vivaldiWindowId,s,n,{isAllDay:t.allDaySelected})}},void 0,l),QX("div",{style:{gridRowStart:2,gridRowEnd:"grid-bottom",gridColumnStart:r,gridColumnEnd:r+t+1},className:mn()("calendar-background-day",{weekend:n.day()%6==0}),"data-date":n.valueOf()}))),r+=t+1,n.add(1,"days")}))}else e.push(QX("div",{style:{gridRowStart:1,gridRowEnd:"grid-bottom",gridColumnStart:2,gridColumnEnd:i[0]+3},className:mn()("calendar-background-day",{weekend:t.day()%6==0}),"data-date":t.clone().startOf("day").valueOf()},"day"));return e}),[a.vivaldiWindowId,t,n,i,s])}function gQ(e){return e.marker?[QX("div",{className:"current-time",style:{gridRowStart:e.marker.row,gridColumnStart:e.marker.column+2,gridColumnEnd:`span ${e.marker.columnSpan}`}},"marker",QX("span",{className:"marker",style:{top:`${e.marker.percentage}%`}}))]:null}function mQ(e){const{cells:t,selectedEvent:n,editingEvent:i,allDaySelected:s,selectedDate:a}=e;return tn.useMemo((function(){return t.map(((t,r)=>{const{display:l,isAllDay:d,navigation:c,time:h}=t;if(!h)return null;const p=a.valueOf(),u=s===d&&h.start<=p&&h.end>p;if(!u)return null;const g=u&&!n&&!i;return(0,fn.jsx)("div",{className:mn()("calendar-add-event-button selected",{active:g,"with-event":c.left!==l.left}),onClick:t=>{t.stopPropagation(),o.Z.editEvent(e.editor,null,JX({start:h.start,allDay:d}))},style:{gridRowStart:c.top,gridRowEnd:c.bottom,gridColumnStart:c.left,gridColumnEnd:c.right},ref:e=>e&&requestAnimationFrame((()=>{e.scrollIntoView({block:"nearest",inline:"nearest"})})),children:g&&"+"},`sel${r}`)}))}),[s,t,i,a,n,e.editor])}function vQ(e){const t=Boolean(e.filter.filterText),n=tn.useMemo((()=>({displayStyle:"solid",isFiltering:t})),[t]),{cells:i,isActiveEditor:s,editingEvent:o,editor:a,selectedEvent:r,displayMode:l}=e;return tn.useMemo((()=>i.map(((t,i)=>{if(t.event){const i=t.event;if(!i)return null;const l=s&&o?.id===i.id&&!e.isDragging,d=i.id.split("-")[0]===r?.split("-")[0],c=l&&o?o:i,h=oc.Z.generateKey(i,t.isAllDay?`${t.display.left}${t.display.right}`:`${t.display.left}${t.display.top}`),p=t.time&&i.start<t.time.start,u=t.time&&i.end>t.time.end;return(0,fn.jsx)(rX,{...n,style:{gridRowStart:t.display.top,gridRowEnd:t.display.bottom,gridColumnStart:t.display.left,gridColumnEnd:t.display.right},event:c,isMultiDay:oc.Z.isMultiDayEvent(i),isSelected:d,isEditing:l,editor:a,resizeHandler:t.isAllDay?"horizontal":"vertical",multiDayContinuing:p,multiDayContinues:u},h)}if(t.events){const i=t.events;if(!i.length)return null;const d=oc.Z.generateKey(i[0]);return QX("div",{className:mn()("event-container",{"calendar-day-allday":t.isAllDay&&"day"===l}),style:{gridRowStart:t.display.top,gridRowEnd:t.display.bottom,gridColumnStart:t.display.left,gridColumnEnd:t.display.right}},`${d}-${t.display.top}`,i.map((i=>{const l=s&&o?.id===i.id&&!e.isDragging,d=i.id.split("-")[0]===r?.split("-")[0];return(0,fn.jsx)(rX,{...n,event:i,isMultiDay:oc.Z.isMultiDayEvent(i),isSelected:d,isEditing:l,editor:a,resizeHandler:t.isAllDay?"horizontal":"vertical"},`${oc.Z.generateKey(i)}`)})))}}))),[i,l,n,o,a,s,r,e.isDragging])}const fQ=function(e){const t=tn.useContext(OD),n=tn.useContext(dn.Z),i=tn.useRef(null),[s,a]=tn.useState(null),[r,l]=tn.useState([]),[d,c]=tn.useState([]),[h,p]=tn.useState([]),[u,g]=tn.useState(!1),[m,v]=tn.useState(null),[f,y]=tn.useState(null),w=(0,Tm.Z)(qX),C=tn.useRef({updateTimer:null,initialFocusTaken:!1,wasEditing:!!e.editingEvent&&t.editor.uid===e.editorUid,updateCreateOverlay:()=>{},isResizing:!1,hover:{x:0,y:0,updateRequested:!1}});tn.useEffect((()=>{C.current.updateTimer||(C.current.updateTimer=setInterval((()=>{v(iQ(e.anchorDate,e.displayMode,r))}),6e4));const{editor:n}=t;return C.current.wasEditing=!!e.editingEvent&&n.uid===e.editorUid,()=>{C.current.updateTimer&&clearInterval(C.current.updateTimer)}}));const{anchorDate:S,displayMode:T,events:I}=e,k=w[D.kCalendarCollapseHours],A=k?w[D.kCalendarDayStarts]:0,Z=k&&w[D.kCalendarDayEnds]||24,E=w[D.kCalendarOnlyHourlyKeynav]?60:w[D.kCalendarTimeIncrements];tn.useMemo((()=>{let t=I;u&&e.editingEvent&&(t=I.map((t=>t.id===e.editingEvent?.id?e.editingEvent:t)).filter(Boolean));const n=oQ(t,S,T,A,Z,E);l(n.gridColumns),a(n.allDayGrid),c(n.timeCells),p(n.eventCells)}),[S,T,A,Z,I,E,u,e.editingEvent]),tn.useMemo((()=>{const e=iQ(S,T,r);e&&s&&(e.row=e.row+s.rows+1),v(e)}),[S,T,s,r]);const _=tn.useMemo((()=>({pageId:t.editor.pageId,uid:e.editorUid})),[t.editor.pageId,e.editorUid]),{gridFrozen:N,handlers:M,overlay:P}=fX(n.vivaldiWindowId,i.current,lQ,rQ,_,g),x=()=>{if(C.current.hover.x&&C.current.hover.y){const{currentRow:e,currentCol:t,isAllDayRow:n}=aQ(i.current,C.current.hover.x,C.current.hover.y);y(e&&t?{gridColumnStart:parseInt(t.style.gridColumnStart),gridRowStart:n?2:parseInt(e.style.gridRowStart),gridColumnEnd:parseInt(t.style.gridColumnEnd),gridRowEnd:n?parseInt(e.style.gridRowStart):parseInt(e.style.gridRowEnd)||parseInt(e.style.gridRowStart)+1}:null)}C.current.hover.updateRequested=!1},O=!u&&e.editingEvent?{onDragStart:Cs.Z}:{...M,onDragOver:e=>{e.dataTransfer.types.some((e=>e===uX))?(C.current.hover.x=e.clientX,C.current.hover.y=e.clientY,C.current.hover.updateRequested||(requestAnimationFrame(x),C.current.hover.updateRequested=!0),e.preventDefault(),e.stopPropagation()):M.onDragOver(e)},onDrop:e=>{const t=e.dataTransfer;if(t.types.some((e=>e===uX))){e.preventDefault(),e.stopPropagation();const{currentRow:s,currentCol:a,isAllDayRow:r}=aQ(i.current,e.clientX,e.clientY);if(s&&a){const e=parseInt(a.dataset.date)+parseInt(s.dataset.starttime),i=JSON.parse(t.getData(uX)).id;o.Z.moveEvent(n.vivaldiWindowId,_,i,{start:e,allDay:r})}}else M.onDrop(e)}},{allDaySelected:L,selectedDate:R}=e.filter,B=tn.useCallback((t=>{if(!(t.shiftKey||t.ctrlKey||t.metaKey||e.editingEvent)){const i=kA.Z[t.keyCode],s=t.altKey;switch(i){case"Up":case"Down":case"Left":case"Right":t.preventDefault();const a=s?[]:h,[r,l,c]=function(e,t,n,i,s,o=!1){const a=i.valueOf(),r=t.find((e=>e.isAllDay===o&&e.time.start<=a&&e.time.end>a));if(!r)return[null,null,!1];const l=n.find((e=>e.event&&e.event.id===s||e.events&&e.events.some((e=>e.id===s)))),d=l||r;if(d.events&&("Up"===e||"Down"===e)){const t=d.events.findIndex((e=>e.id===s));if("Up"===e&&t>0||"Down"===e&&t<d.events.length-1){const n="Up"===e?-1:1,i=d.events[t+n];return[r.time&&r.time.start,i,r.isAllDay]}}let c;switch(e){case"Up":case"Down":case"Left":case"Right":c=$X(e,r,l,[...t,...n])}if(c){let n;if(c.time)return[c.time.start,null,c.isAllDay];if(c.event)n=c.event;else if(c.events){const t="Up"===e?c.events.length-1:0;n=c.events[t]}if(n){if(function(e,t){return e.time.start<(t.end||1/0)&&e.time.end>t.start}(r,n))return[r.time&&r.time.start,n,c.isAllDay];let i;if(i=d.isAllDay?function(e,t,n){let i;i="Left"===n?t=>t.navigation.right===e.navigation.right:t=>t.navigation.left===e.navigation.left;const s=t.filter(i).sort(((e,t)=>e.navigation.top-t.navigation.top));return s.length?s[0]:null}(c,[...t],e):$X(e,r,null,[...t]),i&&i.time)return[i.time.start,n,c.isAllDay]}}return[null,null,!1]}(i,d,a,R,e.selectedEvent,L);if(!r)return void function(e,t,n,i,s){let a;switch(t){case"Left":a=n.clone().subtract(1,"day");break;case"Right":a=n.clone().add(1,"day")}a&&o.Z.selectDate(e,s.pageId,a,{isAllDay:i})}(n.vivaldiWindowId,i,R,L,_);(l||e.selectedEvent)&&o.Z.selectEvent(_,{event:l,date:b()(r),allDay:c}),l||o.Z.selectDate(n.vivaldiWindowId,_.pageId,b()(r),{isAllDay:c});break;case"Enter":if(t.preventDefault(),e.selectedEvent){const t=I.find((t=>t.id===e.selectedEvent));o.Z.editEvent(_,t)}else{const e=R.valueOf();o.Z.editEvent(_,null,JX({start:e,allDay:L}))}break;case"Escape":t.preventDefault(),e.selectedEvent&&o.Z.selectEvent(_,{})}y(null)}}),[n.vivaldiWindowId,_,h,d,e.selectedEvent,I,e.editingEvent,L,R]);let F={};if(N)F=N;else{const t="auto ",n=r.reduce(((e,n)=>`${e} ${t.repeat(n)} 16px`),"var(--calendar-hour-column-width) ");F.gridTemplateColumns=n+" [grid-right]";let i="";eQ[e.displayMode].row-1&&(i="max-content ");const o=w[D.kCalendarCollapseHours],a=o?w[D.kCalendarDayStarts]:0,l=o&&w[D.kCalendarDayEnds]||24;let d=a>0?`repeat(${4*a}, min-content) `:"";d+=`repeat(${4*(24-a-(24-l))}, auto) `,d+=l<24?`repeat(${4*(24-l)}, min-content) `:"",s?.rows&&(i+=`repeat(${s.rows}, min-content) `),i+=`1.5em ${d} [grid-bottom]`,F.gridTemplateRows=i}return(0,fn.jsxs)("div",{className:mn()("calendar-grid calendar-grid-hours",`calendar-grid-${e.displayMode}`,{"is-dragging":u}),onKeyDown:B,style:F,tabIndex:"0",draggable:!0,...O,onMouseDown:e=>{e.target instanceof HTMLElement&&e.target.className.includes("calendar-event-resizer")&&(C.current.isResizing=!0)},onMouseUp:e=>{XX.nextTick((()=>C.current.isResizing=!1))},onMouseMove:e=>{C.current.hover.x=e.clientX,C.current.hover.y=e.clientY,C.current.hover.updateRequested||(requestAnimationFrame(x),C.current.hover.updateRequested=!0)},onClick:t=>{if(t.target!==t.currentTarget||C.current.isResizing)return;const{currentRow:s,currentCol:a,isAllDayRow:r}=aQ(i.current,t.clientX,t.clientY);if(s&&a){t.stopPropagation();const i=parseInt(a.dataset.date)+parseInt(s.dataset.starttime),l=w[D.kCalendarClickTimeSlot];"select"!==l&&"contextmenu"!==t.type&&e.filter.allDaySelected===r||o.Z.selectDate(n.vivaldiWindowId,_.pageId,b()(i),{isAllDay:r}),"create"===l&&"contextmenu"!==t.type&&o.Z.editEvent(_,null,JX({start:i,allDay:r})),y(null)}},ref:t=>{t&&(!e.editingEvent&&C.current.wasEditing||!C.current.initialFocusTaken)&&(t.focus(),C.current.initialFocusTaken=!0),i.current=t},children:[QX(uQ,{anchorDate:S,displayMode:T,gridColumns:r,pageId:_.pageId}),QX(pQ,{allDayGrid:s,anchorDate:S,displayMode:T,pageId:_.pageId}),f&&QX("div",{className:"calendar-grid-hover",style:f}),QX(mQ,{cells:d,editingEvent:e.editingEvent,editor:_,allDaySelected:e.filter.allDaySelected,selectedDate:e.filter.selectedDate,selectedEvent:e.selectedEvent}),QX(gQ,{marker:m}),QX(vQ,{cells:h,editingEvent:e.editingEvent,editor:_,filter:e.filter,isDragging:u,isActiveEditor:t.editor.uid===e.editorUid,selectedEvent:e.selectedEvent,setIsDragging:g,displayMode:e.filter.displayMode}),QX(dQ,{overlay:P,rowOffset:eQ[e.displayMode].row+(s&&s.rows+1||0),colOffset:eQ[e.displayMode].column,columnSizes:r})]})};var yQ;function wQ(e,t,n,i){yQ||(yQ="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:yQ,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const bQ=[D.kCalendarDisplayWeekNumber];function CQ(e){const t=Lo.Z.getCalendars().find((t=>t.id===e.event.calendarId)),n=Math.max(0,Math.floor((e.event.start-e.startTime)/yc.lq)),i=Math.max(Math.min(96,Math.floor((e.event.end-e.startTime)/yc.lq)),n+1);return wQ("line",{stroke:"var(--colorCalendarBg)",style:oc.Z.getCalendarColorStyles(t),x1:110,x2:110,y1:n,y2:i})}function SQ(e){const t=Lo.Z.getCalendars().find((t=>t.id===e.event.calendarId)),n=Math.floor(48-10*(e.count-1)-10)+20*e.index;return wQ("line",{stroke:"var(--colorCalendarBg)",x1:10,x2:10,y1:n,y2:n+14,style:oc.Z.getCalendarColorStyles(t)},e.event.id)}function TQ(e){const[t,n]=(0,wX.Z)(oc.Z.filterEventsByPeriod(e.events,e.day,"day"),oc.Z.isMultiDayEvent),i=e.day.clone();return wQ(tn.Fragment,{},e.day.valueOf(),wQ("div",{className:mn()("CalendarMonth-Day",{"CalendarMonth-Day--OtherMonth":!e.isSameMonth,"CalendarMonth-Day--Selected":e.isSelected,"CalendarMonth-Day--Current":e.day.isSame(Date.now(),"day"),"CalendarMonth-Day--Weekend":e.day.day()%6==0}),onClick:()=>e.onSelect(i)},void 0,wQ("span",{},void 0,e.day.format("D")),!(!n.length&&!t.length)&&wQ("svg",{viewBox:"0 0 120 96"},void 0,n.map((t=>wQ(CQ,{event:t,startTime:e.day.valueOf()},t.id))),t.map(((e,n)=>wQ(SQ,{event:e,index:n,count:t.length},e.id))))))}AQ.defaultProps={highlightMode:"day",fixedHeight:!1};var IQ=wQ("span",{}),kQ=wQ("span",{});function AQ(e){const t=tn.useContext(OD),n=(0,Tm.Z)(bQ)[D.kCalendarDisplayWeekNumber],{events:i,month:s}=e,o=s.clone().startOf("month").startOf("week");let a;if(e.fixedHeight)a=[...Array(42).keys()].map((e=>o.clone().add(e,"day")));else{const e=oc.Z.getDisplayRange(s,"month");a=Array.from(e.by("day"))}const r=a.slice(0,7);return wQ("div",{className:mn()("CalendarMonth",{"CalendarMonth--ShowWeeknumber":n})},void 0,n&&IQ,r.map((e=>wQ("span",{className:"CalendarMonth-DayOfWeek"},`hdr-${e.valueOf()}`,e.format("dd")[0]))),a.map(((o,a)=>{const r=o.isSame(s,"month");return n&&a%7==0?wQ(tn.Fragment,{},a,wQ("span",{className:"CalendarMonth-Week"},void 0,o.week()),e.showOutOfMonthDays||r?wQ(TQ,{day:o,events:i,pageId:t.editor.pageId,isSelected:e.selectedDate.isSame(o,e.highlightMode),isSameMonth:r,onSelect:e.onSelect}):kQ):e.showOutOfMonthDays||r?wQ(TQ,{day:o,events:i,pageId:t.editor.pageId,isSelected:e.selectedDate.isSame(o,e.highlightMode),isSameMonth:r,onSelect:e.onSelect},o.valueOf()):wQ("span",{},o.valueOf())})))}const ZQ=AQ;var EQ;function _Q(e,t,n,i){EQ||(EQ="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:EQ,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const NQ=function(e){const t=tn.useContext(OD),n=tn.useContext(dn.Z),i=tn.useRef(),s=()=>{const e=i.current;if(!e)return 0;const t=!!e.childElementCount&&e.children[0];return t?Math.max(1,Math.floor(e.clientWidth/t.clientWidth)):0},{anchorDate:a,displayMode:r}=e.filter,l=oc.Z.getDisplayRange(a,r),d=Array.from(l.by("month"));return(0,fn.jsx)("div",{className:`calendar-grid-${e.filter.displayMode} calendar-grid`,onKeyDown:i=>{const a=e.filter.selectedDate;let r,l;switch(kA.Z[i.keyCode]){case"Left":if(0===a.weekday()||1===a.date()){const e=(0,bc.Xq)(a);r=(0,bc.FY)(e,6,a.clone().subtract(1,"month"),!0)}else r=a.clone().subtract(1,"day");break;case"Right":if(r=a.clone().endOf("month"),6===a.weekday()||a.isSame(r,"day")){const e=(0,bc.Xq)(a);r=(0,bc.FY)(e,0,a.clone().add(1,"month"),!0)}else r=a.clone().add(1,"day");break;case"Up":l=s(),a.date()<8?(r=a.clone().subtract(l,"month"),r=(0,bc.Ro)(a.weekday(),r)):r=a.clone().subtract(1,"week");break;case"Down":l=s(),r=a.clone().endOf("month"),r.date()-a.date()<7?(r=a.clone().add(l,"month"),r=(0,bc.PX)(a.weekday(),r)):r=a.clone().add(1,"week")}r&&(r.hour(a.hour()).minute(a.minute()),o.Z.selectDate(n.vivaldiWindowId,t.editor.pageId,r))},ref:i,tabIndex:"0",children:d.map((i=>{const s=oc.Z.filterEventsByPeriod(e.events,i,"month");return _Q("div",{},i.valueOf(),_Q("p",{className:"month-name"},void 0,i.format("MMMM")),_Q(ZQ,{events:s,month:i,selectedDate:e.filter.selectedDate,onSelect:e=>o.Z.selectDate(n.vivaldiWindowId,t.editor.pageId,e)}))}))})};var MQ;function PQ(e,t,n,i){MQ||(MQ="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:MQ,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const{minimalCreateEvent:DQ}=oc.Z,xQ=[D.kCalendarClickTimeSlot],OQ="YYYY-MM-DD",LQ="!todos";function RQ(e,t,n,i=0){const s=i>0?{...n,id:`${n.id}-${i}`}:n,o=e.get(t);Array.isArray(o)?(o.push(s),e.set(t,o)):e.set(t,[s])}const BQ=Uu()(2)((function(e,t,n){const i=new Map;return e.forEach((e=>{if(e.task)if(e.end){const t=b()(e.end).format(OQ);RQ(i,t,e)}else RQ(i,LQ,e);else if(e.start){const s=b()(Math.max(e.start,t)).startOf("day");let o=0;const a=Math.min(e.end,n);for(;s.valueOf()<a||s.valueOf()===e.start;){const t=s.format(OQ);RQ(i,t,e,o),s.add(1,"day"),o++}}})),i.forEach((e=>e.sort(((e,t)=>e.id&&t.id?e.allDay!==t.allDay?e.allDay?-1:1:e.task&&t.task?(e.end||1/0)-(t.end||1/0):e.start-t.start:e.id?-1:1)))),i}));class FQ extends tn.Component{static contextType=OD;state={eventGroups:new Map,selectedDate:b()()};initialFocusTaken=!1;wasEditing=!!this.props.editingEvent&&this.context.editor.uid===this.props.editorUid;static getDerivedStateFromProps=(e,t)=>{const n=oc.Z.getDisplayRange(e.filter.anchorDate,e.displayMode),i=BQ(e.events,n.start.valueOf(),n.end.valueOf());let s;const o=e.filter.selectedDate.format(OQ),a=[...i.keys()].sort();for(const e of a)if(!s&&o<=e){s=b()(e);break}if(!s&&a.length){const e=a.pop();e!==LQ&&(s=b()(e))}return{eventGroups:i,selectedDate:s||e.filter.selectedDate}};componentDidMount(){const{editor:e}=this.context;this.wasEditing=!!this.props.editingEvent&&e.uid===this.props.editorUid}componentDidUpdate=()=>{const{editor:e}=this.context;this.wasEditing=!!this.props.editingEvent&&e.uid===this.props.editorUid};getEditor=()=>({pageId:this.context.editor.pageId,uid:this.props.editorUid});_createDraft=e=>{const t="CalendarManagerSidebarView"===this.getEditor().uid.description;return t?{end:e,task:t}:{start:e}};onClickBackground=(e,t)=>{if(this.props.editingEvent){const{editor:e}=Lo.Z.getEditState();o.Z.endEventEdit(this.props.windowId,e)}else if(t){const n=this.getEditor(),i=b()(t,OQ),s=this._createDraft(i.valueOf());"select"===this.props.prefValues[D.kCalendarClickTimeSlot]||"contextmenu"===e.type?o.Z.selectDate(this.props.windowId,n.pageId,i,{isAllDay:!0}):(!this.props.filter.allDaySelected&&i&&o.Z.selectDate(this.props.windowId,n.pageId,i,{isAllDay:!0}),o.Z.editEvent(n,null,DQ(s)))}};onClickCreate=(e,t)=>{"click"===e.type&&e.stopPropagation();const n=this.getEditor(),i=t?t+(new Date).getHours()*yc.QI:0,s=this._createDraft(i);!this.props.filter.allDaySelected&&i&&o.Z.selectDate(this.props.windowId,n.pageId,b()(i),{isAllDay:!0}),o.Z.editEvent(n,null,DQ(s))};onClickEvent=(e,t)=>{const{editingEvent:n}=this.props;(!n||n&&n.id!==t.id)&&o.Z.editEvent(this.getEditor(),t),e.stopPropagation()};onKeyDown=e=>{const t=e.altKey;if(!this.props.editingEvent){const n=oc.Z.getDisplayRange(this.props.filter.anchorDate,this.props.displayMode),i=this.state.selectedDate,s=Array.from(this.state.eventGroups.keys()).sort();let a,r;switch(kA.Z[e.keyCode]){case"Up":if((0,Cs.Z)(e),a=this.state.eventGroups.get(i.format(OQ))||[],r=a.findIndex((e=>e.id===this.props.selectedEvent)),t||0===r||0===a.length){const e=s.findIndex((e=>i.isSame(e,"day")));e<=0?o.Z.viewPreviousPeriod(this.getEditor().pageId,n.start.clone().subtract(1,"day")):o.Z.selectDate(this.props.windowId,this.getEditor().pageId,b()(s[e-1]))}else if(this.props.selectedEvent){const e=a[r-1];o.Z.selectEvent(this.getEditor(),{event:e})}else{const e=a[a.length-1];o.Z.selectEvent(this.getEditor(),{event:e})}break;case"Down":if((0,Cs.Z)(e),a=this.state.eventGroups.get(i.format(OQ))||[],r=a.findIndex((e=>e.id===this.props.selectedEvent)),t||-1===r||!this.props.selectedEvent){const e=s.findIndex((e=>i.isSame(e,"day")));a=this.state.eventGroups.get(s[e+1])||[],e>=s.length-1?o.Z.viewNextPeriod(this.getEditor().pageId,n.end.clone().add(1,"day")):a.length&&!t?o.Z.selectEvent(this.getEditor(),{event:a[0],date:i.clone().add(1,"day")}):o.Z.selectDate(this.props.windowId,this.getEditor().pageId,b()(s[e+1]))}else r===a.length-1?o.Z.selectEvent(this.getEditor(),{}):o.Z.selectEvent(this.getEditor(),{event:a[r+1]});break;case"Enter":if((0,Cs.Z)(e),this.props.selectedEvent){a=this.state.eventGroups.get(i.format(OQ))||[];const e=a.find((e=>e.id===this.props.selectedEvent));o.Z.editEvent(this.getEditor(),e)}else{const e=this.getEditor(),t="CalendarManagerSidebarView"===e.uid.description,n=i.clone(),s=t?0:n.hours((new Date).getHours()).valueOf();o.Z.editEvent(e,null,DQ({start:s,task:t}))}break;case"Escape":(0,Cs.Z)(e),this.props.selectedEvent&&o.Z.selectEvent(this.getEditor(),{})}}};renderEvents=()=>{const e=[],t=this.state.selectedDate.format(OQ),n=Boolean(this.props.filter.filterText),i=[...this.state.eventGroups.keys()].sort();for(const s of i){const i=this.state.eventGroups.get(s)||[],o=t===s,a=s!==LQ?e=>this.onClickBackground(e,s):Tl.default,r=s!==LQ?b()(s,OQ):void 0;e.push((0,fn.jsxs)("div",{className:"cal-tasks-row",ref:e=>{o&&e&&e.scrollIntoView({block:"nearest",inline:"nearest",behavior:"smooth"})},onClick:a,children:[s!==LQ&&PQ("div",{className:"cal-tasks-row-date"},void 0,PQ("span",{className:"cal-tasks-row-dow"},void 0,r?.format("dddd")),PQ("span",{className:"cal-tasks-row-doy"},void 0,r?.format("ll"))),PQ("div",{className:mn()("cal-tasks-row-events",{selected:o})},void 0,i.map((e=>{const{editor:t}=this.context,i=this.props.selectedEvent?.split("-")[0]===e.id.split("-")[0]&&t.uid===this.props.editorUid,s=!!this.props.editingEvent&&this.props.editingEvent.id===e.id&&t.uid===this.props.editorUid,o=s&&this.props.editingEvent?this.props.editingEvent:e;return PQ("div",{className:"event-container",onClick:e=>this.onClickEvent(e,o)},oc.Z.generateKey(o),PQ(rX,{event:o,displayStyle:this.props.eventDisplayStyle,isSelected:i,isEditing:s,isMultiDay:o.allDay,editor:this.getEditor(),isFiltering:n,multiDayContinuing:!!e.start&&e.start<(r?.valueOf()??-1/0),multiDayContinues:(e.end||e.due||0)>(r?.valueOf()??1/0)+yc.hd}))})),(0,fn.jsx)("div",{className:mn()("calendar-add-event-button",{active:o&&!this.props.selectedEvent,selected:o}),onClick:e=>this.onClickCreate(e,Date.parse(s)),ref:e=>{o&&!this.props.selectedEvent&&e&&e.scrollIntoViewIfNeeded({block:"nearest",inline:"nearest",behavior:"smooth"})},children:"+"}))]},s))}return e};renderAddEvent(){const e=0===Lo.Z.getEvents().length,t="CalendarManagerSidebarView"===this.getEditor().uid.description,n=t?0:this.props.filter.anchorDate.valueOf();return PQ("div",{className:"cal-tasks-row"},void 0,PQ("div",{className:"cal-tasks-row-events selected"},void 0,e&&PQ("h2",{},void 0,t?(0,le.Z)("Your calendar is empty. Add your first task below!"):(0,le.Z)("Your calendar is empty. Add your first event below!")),PQ("div",{className:"calendar-add-event-button selected active",onClick:e=>this.onClickCreate(e,n)},void 0,"+")))}render(){return(0,fn.jsxs)("div",{className:`calendar-grid-${this.props.displayMode}`,onKeyDown:this.onKeyDown,onClick:this.onClickBackground,tabIndex:"0",ref:e=>{e&&(!this.props.editingEvent&&this.wasEditing||!this.initialFocusTaken)&&(e.focus(),this.initialFocusTaken=!0)},children:[0===this.props.events.length&&this.renderAddEvent(),this.renderEvents()]})}}const UQ=(0,fs.Z)(FQ,xQ);var VQ,WQ=n(34155);function HQ(e,t,n,i){VQ||(VQ="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:VQ,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const{minimalCreateEvent:zQ}=oc.Z;const GQ=function(e){const t=tn.useContext(OD),n=tn.useContext(dn.Z),i=tn.useRef(null);tn.useEffect((()=>{M.Z.get(D.kCalendarOnboardingShown)||(nt.Z.set(D.kCalendarOnboardingShown,!0),WQ.nextTick((()=>{ie.Z.showCalendarAccountDialog(n.vivaldiWindowId)})))}),[n]),tn.useEffect((()=>{const n={pageId:t.editor.pageId,uid:e.editorUid};return Lo.w.set(n.pageId,n),()=>{Lo.w.delete(n.pageId)}}),[t.editor,e.editorUid]);const s=()=>{const e=Lo.Z.getCalendarState().trashedEvents.sort(((e,t)=>(e.trash_time||0)-(t.trash_time||0))).slice(-1);e.length&&o.Z.restoreEvent(n.vivaldiWindowId,t.editor,e[0])},a=tn.useCallback(((e,t)=>{const s=Lo.Z.getEditState(),o=n.document.getSelection(),a=n.document.activeElement,r=s.selectedEvent||s.eventDraft?.id;if(r&&(!o||o.isCollapsed)&&i.current&&i.current.contains(a)){const{clipboardData:n}=e;if(!n)throw new Error("No clipboardData on copy event");e.preventDefault();const i=Lo.Z.getEvent(r);if(!i)return void de.Z.warn("Calendar",`Event to copy (id: ${r}) not found`);n.setData("text/plain",i.title),n.setData(uX,r),n.setData("vivaldi/x-cut",t)}}),[n.document]),r=tn.useCallback((e=>{a(e,"true")}),[a]),l=tn.useCallback((e=>{a(e,"false")}),[a]),{allDaySelected:d,selectedDate:c}=e.filter,h=tn.useCallback((async e=>{if(i.current&&i.current.contains(n.document.activeElement)){const{clipboardData:i}=e;if(!i)throw new Error("No clipboardData on paste event");const s=Lo.Z.getEditState().eventDraft;if(s&&"DELETE"!==oc.Z.shouldSaveEvent(s))return;const a=i.getData(uX);if(a){e.preventDefault();const r=c.valueOf(),l=d;let h;h="true"===i.getData("vivaldi/x-cut")?await o.Z.moveEvent(n.vivaldiWindowId,t.editor,a,{start:r,byDateOnly:l}):await o.Z.copyEvent(n.vivaldiWindowId,t.editor,a,{start:r,byDateOnly:l}),s?o.Z.editEvent(t.editor,h):o.Z.selectEvent(t.editor,{event:h})}else{const e=i.getData("text/plain");e&&o.Z.editEvent(t.editor,null,zQ({title:e,start:c.valueOf()}))}}}),[n.vivaldiWindowId,n.document,t.editor,c,d]);tn.useEffect((()=>{wd.Z.bind("ctrl+z",s);const e=i.current;return e&&(n.document.addEventListener("cut",r),n.document.addEventListener("copy",l),n.document.addEventListener("paste",h)),()=>{wd.Z.unbind("ctrl+z",s),e&&(n.document.removeEventListener("cut",r),n.document.removeEventListener("cut",l),n.document.removeEventListener("paste",h))}}));const p=tn.useCallback((n=>{Lo.w.get(t.editor.pageId)?.uid!==e.editorUid&&Lo.w.set(t.editor.pageId,{pageId:t.editor.pageId,uid:e.editorUid})}),[t.editor,e.editorUid]),u=e.displayMode||e.filter.displayMode,g=Lo.Z.getDefaultCalendar(),m=t.editor.pageId===Lo.Z.getPanelResourceKey();return(0,fn.jsxs)("div",{ref:i,className:"calendar-viewport",onContextMenu:e=>{const t=e.target instanceof HTMLElement&&e.target.closest(".calendar-grid");t&&t!==document.activeElement&&t instanceof HTMLElement&&t.focus(),(0,zi.Z)(n.vivaldiWindowId,(()=>{const e=[{handler:()=>ui.Z.paste(n.vivaldiWindowId),...(0,Mn.Z)("verb","Paste")}];return Lo.Z.getCalendarState().trashedEvents.length&&e.push({handler:s,...(0,Mn.Z)("Restore Event from Trash")}),e})())(e)},onFocus:p,onKeyDown:i=>{const{editingEvent:s,selectedEvent:a}=e,r=i.ctrlKey,l=n.vivaldiWindowId;if(s)switch(kA.Z[i.keyCode]){case"Escape":o.Z.cancelEventEdit(t.editor);break;case"Del":case"Backspace":!r||((d=i.target)instanceof n.HTMLElement&&d.isContentEditable||d instanceof n.HTMLInputElement&&"text"===d.type||d instanceof n.HTMLTextAreaElement)||o.Z.trashEvent(l,t.editor,s.id)}else switch(kA.Z[i.keyCode]){case"Del":case"Backspace":a&&o.Z.trashEvent(l,t.editor,a),i.preventDefault(),i.stopPropagation()}var d},style:oc.Z.getCalendarColorStyles(g),children:[("day"===u||"week"===u&&!m)&&HQ(fQ,{anchorDate:e.anchorDate||e.filter.anchorDate,filter:e.filter,events:e.events,displayMode:u,selectedEvent:e.selectedEvent,editingEvent:e.editingEvent,editorUid:e.editorUid}),("week"===u&&m||"multiweek"===u||"month"===u)&&HQ(zX,{filter:e.filter,events:e.events,displayMode:u,selectedEvent:e.selectedEvent,editingEvent:e.editingEvent,editorUid:e.editorUid}),"year"===u&&HQ(NQ,{filter:e.filter,events:e.events}),"agenda"===u&&HQ(UQ,{windowId:n.vivaldiWindowId,filter:e.filter,events:e.events,displayMode:u,eventDisplayStyle:e.eventDisplayStyle||"transparent",selectedEvent:e.selectedEvent,editingEvent:e.editingEvent,editorUid:e.editorUid})]})};var $Q,KQ=n(78330);function jQ(e,t,n,i){$Q||($Q="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:$Q,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class YQ extends tn.Component{cache={};state={eventsToRender:[]};static contextType=OD;constructor(e){super(e),this.cache=new II.t1({defaultHeight:50})}static getDerivedStateFromProps=(e,t)=>{const n=Lo.Z.getEvents()||[];return{eventsToRender:oc.Z.searchEvents(n,e.filterText).reduce(((e,t)=>{const n=b()(t.start).format("ll"),i=e.findIndex((e=>e.title===n));return-1===i?e.push({title:n,events:[t]}):e[i].events.unshift(t),e}),[])}};componentDidUpdate(e,t){this.props.filterText!==e.filterText&&this.cache.clearAll()}selectEvent=e=>{const{start:t}=e,n=b()(t),i={anchorDate:n,selectedDate:n};this.props.onUpdateUI(i)};setSelectedIndex=e=>{const{selectedEvent:t}=this.props,{eventsToRender:n}=this.state,i=n.flatMap((e=>e.events));if(t){let n=i.findIndex((e=>e.id===t));"Up"===e?n=Math.max(0,n-1):"Down"===e&&(n=Math.min(i.length-1,n+1)),o.Z.selectEvent(this.getEditor(),{event:i[n]})}else o.Z.selectEvent(this.getEditor(),{event:i[0]})};getEditor=()=>({pageId:this.context.editor.pageId,uid:this.props.editorUid});onKeyDown=e=>{switch(kA.Z[e.keyCode]){case"Up":case"Down":this.setSelectedIndex(kA.Z[e.keyCode])}};renderDay=({index:e,parent:t,key:n,style:i})=>{const{eventsToRender:s}=this.state;if(0===s.length)return;const o=s[e],a=o.events.map(((e,t)=>this.renderEvent(e))),{title:r}=o;return jQ(II.Z8,{cache:this.cache,parent:t,columnIndex:0,rowIndex:e},n,jQ("div",{className:"cal-tasks-row",style:i},void 0,jQ("div",{className:"cal-tasks-row-date"},void 0,r),jQ("div",{className:mn()("cal-tasks-row-events")},void 0,a)))};eventClick=e=>{this.props.onSelectEvent(e.id)};renderEvent=e=>{const t=oc.Z.isMultiDayEvent(e),{selectedEvent:n}=this.props,i=n===e.id,s=!!this.props.editingEvent&&this.props.editingEvent.id===e.id,o=oc.Z.isRecurringEvent(e),a=Boolean(this.props.filterText);let r;if(o){const{recurrence:t}=e;if(t){const n=PA(e.recurrence),i=(0,EA.qh)(t,new Date,b()().add(1,"y").toDate(),3).map((e=>b()(e).format("LL")));r=`${(0,le.Z)("Next occurrences:")}\n          ${i.join(", ")}. ${n}.`}}return jQ("div",{onClick:this.eventClick.bind(null,e),className:"event-container"},e.id,jQ(rX,{event:e,displayStyle:"transparent",isSelected:i,isEditing:s,editor:this.getEditor(),isMultiDay:t,isFiltering:a}),r&&jQ("div",{},void 0,r))};render(){const{eventsToRender:e}=this.state,t=e.reduce(((e,t)=>e+t.events.length),0),n=Lo.Z.getDefaultCalendar();return jQ("div",{className:"manager-content"},void 0,jQ("div",{className:"calendar-viewport",style:oc.Z.getCalendarColorStyles(n)},void 0,jQ("div",{className:"search-results"},void 0,(0,le.Z)("$1 result for “$2”","$1 results for “$2”",[t,this.props.filterText]),jQ("button",{onClick:this.props.onClose},void 0,jQ("span",{dangerouslySetInnerHTML:{__html:cn.vyJ}}))),jQ("div",{className:"calendar-grid-agenda search-results-list",onKeyDown:this.onKeyDown},void 0,jQ(KQ.q,{},void 0,(({height:t,width:n})=>jQ(Vu.aV,{width:n,height:t,defferredMeasurementCache:this.cache,rowHeight:this.cache.rowHeight,rowRenderer:this.renderDay,rowCount:e.length}))))))}}const XQ=YQ;var QQ;function qQ(e,t,n,i){QQ||(QQ="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:QQ,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class JQ extends tn.PureComponent{static contextType=OD;undeleteEvent=e=>{o.Z.restoreEvent(this.props.windowId,this.context.editor,e)};undo=()=>{const{trashedEvents:e}=this.props;e.length>0&&this.undeleteEvent(e[0])};trimTitle=e=>(e.length>70&&(e=e.substring(0,70)+"..."),e);getContextMenuItems=()=>this.props.trashedEvents.sort(((e,t)=>(t.trash_time||0)-(e.trash_time||0))).map((e=>({mnemonic:!1,url:e.id,handler:this.undeleteEvent.bind(this,e),...G.Z.makeLabelPair(e.title||"")}))).filter(Boolean).concat([G.Z.separatorItem,{handler:this.clearAll,...(0,Mn.Z)("other","Clear All")}]);clearAll=()=>{const{trashedEvents:e}=this.props;e.forEach((e=>{const{id:t,syncPending:n}=e;n?(e.deletePending=!0,o.Z.updateEvent(this.props.windowId,e)):o.Z.deleteEvent(t)}))};onDrop=e=>{const t=e.dataTransfer.getData(uX);if(t){e.preventDefault(),e.stopPropagation();const n=JSON.parse(t),{id:i}=n;o.Z.trashEvent(this.props.windowId,this.context.editor,i)}};render=()=>qQ(sl,{className:"toggle-trash",onDrop:this.onDrop,onDragEnter:Tl.default,disabled:0===this.props.trashedEvents.length,image:cn.nre.medium,onMiddleClick:this.undo,menu:this.getContextMenuItems,menuOrigin:"bottomLeft",mimeType:uX,edgeAmount:0,tooltip:(0,le.Z)("Trashed Events")})}const eq=JQ;var tq;function nq(e,t,n,i){tq||(tq="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:tq,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const iq=e=>{o.Z.toggleCalendarVisibility(e)},sq=e=>{const{key:t}=e;" "!==t&&"Enter"!==t||e.target.dispatchEvent(new Event("click",{bubbles:!0}))};var oq=nq("div",{className:"CalendarPicker-Separator"}),aq=nq("div",{className:"CalendarPicker-Separator"}),rq=nq("div",{className:"CalendarPicker-Separator"});const lq=function(e){const t=tn.useRef(),n=tn.useRef(),i=tn.useRef(),s=tn.useRef(!1),a=tn.useRef(),r=tn.useContext(dn.Z),{document:l}=r,[d,c]=tn.useState(!1);tn.useEffect((()=>(t.current&&t.current.focus(),()=>{a.current&&clearTimeout(a.current)})),[]);const h=e=>{o.Z.setDefaultCalendarId(e),t.current&&t.current.focus()},p=e=>{e.currentTarget.focus();const t=e.currentTarget.classList.contains("CalendarPicker-Item--Submenu")||e.currentTarget.closest(".CalendarPicker-Item--Submenu");t?d?a.current&&(a.current=clearTimeout(a.current)):c(!0):!t&&d&&(a.current=setTimeout((()=>{c(!1),a.current=null}),500))},u=e=>{t.current&&t.current.focus()},g=Lo.Z.getDefaultCalendar()?.id,m=s.current;s.current=!1;const{accounts:v,calendars:f}=e,y=[],w=[];let b=!1;return v.forEach((e=>{const t=f.filter((t=>t.accountId===e.id));y.push({account:e,calendars:t}),e.url&&t.length&&(b=!0),"ical"!==e.account_type&&w.push(...t)})),y.sort(((e,t)=>"local"===e.account.account_type?-1:"local"===t.account.account_type?1:0)),(0,fn.jsxs)("div",{className:"CalendarPicker",onKeyDown:e=>{const o=l.activeElement,{key:a}=e;if(o&&o.classList.contains("CalendarPicker-Item")){if(o){const e=((e,t)=>{const n=e.parentElement&&e.parentElement.children;return n&&n.length?[...n].filter((e=>e.classList.contains(t))):[]})(o,"CalendarPicker-Item"),n=e.indexOf(o);if(0===e.length||-1===n)return;if("ArrowDown"===a)e[(n+1)%e.length].focus();else if("ArrowUp"===a)e[(n-1+e.length)%e.length].focus();else if("ArrowLeft"===a){if(d&&t.current){const e=t.current.querySelector(".CalendarPicker-Item--Submenu");e&&e.focus(),c(!1)}}else if("ArrowRight"===a&&o.classList.contains("CalendarPicker-Item--Submenu"))if(d){const e=o.querySelectorAll(".CalendarPicker-Item");e.length&&e[0].focus()}else c(!0),s.current=!0}}else"ArrowUp"===a?i.current&&i.current.focus():"ArrowDown"===a&&(n.current?n.current.focus():i.current&&i.current.focus())},ref:t,tabIndex:0,children:[e.calendars.length>0&&(0,fn.jsxs)(fn.Fragment,{children:[y.map((e=>nq(tn.Fragment,{},e.account.id,y.length>1&&nq("h3",{className:"CalendarPicker-Account"},void 0,"local"===e.account.account_type?(0,le.Z)("Local Calendars"):e.account.name||e.account.url),!!e.calendars.length&&e.calendars.map(((e,t)=>{const i=oc.Z.createCalendarIcon(e,16,!e.hidden);return(0,fn.jsxs)("button",{onMouseEnter:p,onMouseLeave:u,className:"CalendarPicker-Item",onClick:iq.bind(null,e.id),ref:0===t?n:null,children:[nq("span",{className:"CalendarPicker-Icon",dangerouslySetInnerHTML:{__html:i}}),nq("span",{className:mn()("CalendarPicker-Title",{"CalendarPicker-Title--Default":e.id===g})},void 0,e.description||e.name)]},e.id)})),!e.calendars.length&&nq("div",{},void 0,nq("span",{className:"CalendarPicker-Title"},void 0,(0,le.Z)("No Calendars")))))),w.length>0&&(0,fn.jsxs)(fn.Fragment,{children:[oq,nq("div",{className:"CalendarPicker-Item CalendarPicker-Item--Submenu",onClick:()=>c(!d),onMouseEnter:p,onMouseLeave:u,onKeyUp:sq,tabIndex:0},void 0,nq("span",{className:"CalendarPicker-Title"},void 0,(0,le.Z)("Default Calendar")),nq("span",{className:"CalendarPicker-SubmenuIcon",dangerouslySetInnerHTML:{__html:cn.nfH}}),d&&nq("div",{className:"CalendarPicker-Submenu"},void 0,w.map(((e,t)=>{const n=g===e.id,i=oc.Z.createCalendarIcon(e,16,n);return nq("button",{className:"CalendarPicker-Item",onClick:h.bind(null,e.id),onMouseEnter:p,onMouseLeave:u,autoFocus:0===t&&m},e.id,nq("span",{className:"CalendarPicker-Icon",dangerouslySetInnerHTML:{__html:i}}),nq("span",{className:"CalendarPicker-Title"},void 0,e.description||e.name))}))))]}),aq]}),nq("button",{className:"CalendarPicker-Item",onClick:()=>{ie.Z.showCreateCalendarDialog(r.vivaldiWindowId),e.requestClose&&e.requestClose()},onMouseEnter:p,onMouseLeave:u},void 0,nq("span",{className:"CalendarPicker-Icon",dangerouslySetInnerHTML:{__html:cn.md4.medium}}),nq("span",{className:"CalendarPicker-Title"},void 0,(0,le.Z)("New Calendar"))),b&&(0,fn.jsxs)(fn.Fragment,{children:[nq("button",{className:"CalendarPicker-Item",onClick:async()=>{e.requestClose&&e.requestClose(),o.Z.pollAllCalDAVAccountsWithStatus(r.vivaldiWindowId)},onMouseEnter:p,onMouseLeave:u},void 0,nq("span",{className:"CalendarPicker-Icon",dangerouslySetInnerHTML:{__html:cn.GO5.medium}}),nq("span",{className:"CalendarPicker-Title"},void 0,(0,le.Z)("Refresh"))),rq]}),(0,fn.jsxs)("button",{className:"CalendarPicker-Item",onClick:()=>{ie.Z.showSettings(r.vivaldiWindowId,"calendar"),e.requestClose&&e.requestClose()},onMouseEnter:p,onMouseLeave:u,ref:i,children:[nq("span",{className:"CalendarPicker-Icon",dangerouslySetInnerHTML:{__html:cn.bqs.medium}}),nq("span",{className:"CalendarPicker-Title"},void 0,(0,le.Z)("Calendar Settings"))]})]})};var dq;function cq(e,t,n,i){dq||(dq="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:dq,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const hq=function(e){const[t,n]=tn.useState(!1);return(0,fn.jsx)(fn.Fragment,{children:cq("div",{className:"toolbar-dropdown-container"},void 0,cq(sl,{image:cn.bcq.medium,isPressed:t,onClick:()=>n(!t),popupPosition:"below",hidePopup:()=>{},title:(0,le.Z)("Calendars")}),t&&cq(ln.Z,{dialogWidth:"auto",viewMode:"calendar-picker",onRequestClose:e=>{e&&e.target.addEventListener("click",Cs.Z,{once:!0}),n(!1)}},void 0,cq(lq,{accounts:e.accounts,calendars:e.calendars,requestClose:()=>n(!1)})))})};var pq,uq=n(46884);function gq(e,t,n,i){pq||(pq="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:pq,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const{searchEvents:mq}=oc.Z,vq={events:[],count:0,totalCount:0};var fq=gq("br",{});const yq=function(e){const t=tn.useContext(dn.Z),{document:n}=t,[i,s]=tn.useState(!1),[o,a]=tn.useState(vq),[r,l]=tn.useState(-1),d=tn.useRef(),c=tn.useRef();tn.useEffect((()=>{i&&d.current?.focus()}),[i]),tn.useEffect((()=>{function e(){c.current?.focus(),s(!0)}return Qi.Z.addListener("COMMAND_CALENDAR_SEARCH",e),()=>{Qi.Z.removeListener("COMMAND_CALENDAR_SEARCH",e)}}),[]);const h=t=>{g(),e.onSelectEvent(t)},p=()=>{g(),e.onShowSearchResults()},u=t=>{const n=Lo.Z.getEvents()||[];let i=mq(n,t||e.filterText);const s=i.length;return s>10&&(i=i.slice(0,10)),{events:i,count:i.length,totalCount:s}},g=()=>{s(!1),l(-1)},m=t=>{switch(kA.Z[t.keyCode]){case"Enter":a(u()),s(!0);break;case"Escape":e.onSearchChange(""),s(!1)}},v=tn.useRef(null),f=tn.useCallback((()=>g),[]),y=tn.useCallback((()=>v.current),[]);return(0,uq.Z)(y,f),(0,fn.jsxs)("div",{ref:v,className:"toolbar-group FilterAndSearch",children:[(0,fn.jsx)("input",{type:"search",className:"FilterAndSearch-Input no-page-focus",tabIndex:"0",ref:c,placeholder:(0,le.Z)("Filter and Search"),title:(0,le.Z)("Type to filter. Press enter or click button to search."),value:e.filterText,onChange:t=>{const{value:n}=t.target;e.onSearchChange(n),""===n&&g(),i&&a(u(n))},onKeyDown:m}),gq("input",{className:"FilterAndSearch-Button",type:"button",disabled:0===e.filterText.length,onClick:p,value:(0,le.Z)("verb","Search")}),i&&o.count>0&&(0,fn.jsxs)("div",{className:"SearchDropdown",ref:d,tabIndex:"0",onFocus:e=>{e.target===d.current&&r<0&&l(0)},onKeyDown:e=>{switch(kA.Z[e.keyCode]){case"Space":case"Enter":r>=0&&r<o.count&&(h(o.events[r].id),e.stopPropagation());break;case"Escape":g(),c.current&&c.current.focus();break;case"Up":l((e=>Math.max(0,e-1)));break;case"Down":l((e=>Math.min(o.count-1,e+1)));break;case"Tab":n.activeElement===d.current&&(!e.shiftKey&&r<o.count-1?(l((e=>e+1)),e.preventDefault()):e.shiftKey&&r>0&&(l((e=>e-1)),e.preventDefault()))}},children:[gq("ul",{},void 0,o.events.map(((t,n)=>{const i=Lo.Z.getCalendars(),{title:s,id:o}=t,{start:a,end:d}=(0,bc.aE)(t),c=i.find((e=>e.id===t.calendarId)),p=c?oc.Z.createCalendarIcon(c,9):"";return gq("li",{className:mn()("SearchDropdown-Item",{"SearchDropdown-Item--Selected":r===n}),onKeyDown:m,onMouseUp:()=>h(o),onMouseOver:()=>l(n)},n,gq("div",{className:"SearchDropdown-ItemEvent"},void 0,gq("p",{className:"SearchDropdown-ItemEventTitle"},void 0,(0,js.CH)(s,e.filterText))),gq("div",{className:"SearchDropdown-ItemMetaData"},void 0,gq("div",{className:"SearchDropdown-ItemIcon"},void 0,gq("span",{dangerouslySetInnerHTML:{__html:p}})),gq("p",{className:"SearchDropdown-ItemEventCalendar"},void 0,!!c&&(c.description||c.name)),!!t.end&&gq("div",{className:"SearchDropdown-ItemDate"},void 0,function(e,t){if(e.valueOf()&&t.isAfter(e,"day"))return(0,le.Z)("$1 - $2 $3",[e.format(F.ZP.getShortDateFormat()),t.format(F.ZP.getShortDateFormat()),e.format("YYYY")]);const n=e.valueOf()?e:t;return(0,le.Z)("$1. $2",[n.format("ddd"),n.format("ll")])}(a,d),fq,!t.allDay&&function(e,t){return e.valueOf()?`${e.format("LT")}-${t.format("LT")}`:t.format("LT")}(a,d))))}))),o.count!==o.totalCount&&gq("div",{className:"SearchDropdown-MoreItems"},void 0,(0,le.Z)("More results, showing first $1 items out of $2 total.",[o.count,o.totalCount])),gq("input",{className:"SearchDropdown-Button",type:"button",onClick:p,value:(0,le.Z)("Go to Search Results")})]})]})};var wq;function bq(e,t,n,i){wq||(wq="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:wq,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Cq(e){return"day"===e||"week"===e?"month":"year"}function Sq(e){const t=tn.useRef(),n=tn.useRef(),i=tn.useRef(e.initialPeriod),s=(0,Tm.Z)([D.kKeyboardTabToAll]),o=tn.useContext(dn.Z),[a,r]=tn.useState(e.mode),[l,d]=tn.useState((()=>e.initialPeriod.clone()));function c(){const e="year"===a?12:1,t=Cq(a);d(l.clone().subtract(e,t))}function h(){const e="year"===a?12:1,t=Cq(a);d(l.clone().add(e,t))}function p(t){return e.setPeriod(o.vivaldiWindowId,t),e.requestClose(),Promise.resolve()}function u(t){a===e.mode?p(t):(d(t),r(e.mode))}function g(e){const t=e.currentTarget;if(t instanceof HTMLElement){const e=t.dataset.period;u("month"===a?l.clone().month(parseInt(e)):l.clone().year(parseInt(e)))}}function m(t){if(t.keyCode){const e=kA.Z[t.keyCode];if(t.repeat||"Space"!==e&&"Enter"!==e)return}t.stopPropagation(),t.preventDefault(),r(a===e.mode?Cq(a):e.mode)}tn.useEffect((()=>(t.current=document.activeElement,n.current?.focus(),d(e.initialPeriod.clone()),r(e.mode),()=>{t.current?.focus()})),[e.initialPeriod,e.mode]);const v=l.year()-l.year()%12;let f="",y="",w="",C="";switch(a){case"year":y=(0,le.Z)("Previous Years"),w=(0,le.Z)("Next Years"),f=`${v} - ${v+11}`;break;case"month":y=(0,le.Z)("Previous Year"),w=(0,le.Z)("Next Year"),C="month"===e.mode?(0,le.Z)("Show Years"):(0,le.Z)("Show Month"),f=l.format("YYYY");break;case"week":case"day":y=(0,le.Z)("Previous Month"),w=(0,le.Z)("Next Month"),C=e.mode===a?(0,le.Z)("Show Year"):(0,le.Z)("Show Month"),f=l.format("MMMM YYYY")}let S="";if(l!==i.current){let e=!1;if("year"===a){Math.floor(i.current.year()/12)!==Math.floor(l.year()/12)&&(e=!0)}else{const t=Cq(a);i.current.isSame(l,t)||(e=!0)}e&&(S=i.current.valueOf()<l.valueOf()?"DatePickerPopup-Contents--Increase":"DatePickerPopup-Contents--Decrease"),i.current=l}const T=l.get(Cq(a));return(0,fn.jsxs)("div",{className:"DatePickerPopup",ref:n,onMouseDown:Cs.Z,onClick:Cs.Z,onKeyDown:function(t){let n;switch(kA.Z[t.keyCode]){case"Left":n=l.clone().subtract(1,a);break;case"Right":n=l.clone().add(1,a);break;case"Up":n="month"===a||"year"===a?l.clone().subtract(3,a):l.clone().subtract(1,"week");break;case"Down":n="month"===a||"year"===a?l.clone().add(3,a):l.clone().add(1,"week");break;case"PageUp":c(),(0,Cs.Z)(t);break;case"PageDown":h(),(0,Cs.Z)(t);break;case"Enter":if((0,Cs.Z)(t),t.target!==t.currentTarget)return;u(l.clone());break;case"Escape":(0,Cs.Z)(t),e.requestClose()}n&&(d(n),(0,Cs.Z)(t))},tabIndex:"0",children:[bq("div",{className:"toolbar toolbar-default"},void 0,bq("h1",{className:"year"!==a?"button":"",onMouseDown:m,onKeyDown:m,tooltip:C,tabIndex:"year"!==a?s[D.kKeyboardTabToAll]:"-1"},void 0,f),bq("div",{className:"toolbar-group",style:{marginLeft:"auto"}},void 0,bq(sl,{className:"button-narrow",onClick:c,tooltip:y,image:cn.mgF.medium}),bq(sl,{onClick:function(){d(b()().startOf("hour")),r(e.mode)},title:(0,le.Z)("Today")}),bq(sl,{className:"button-narrow",onClick:h,tooltip:w,image:cn.Zu.medium}))),bq("div",{className:`DatePickerPopup-Contents ${S}`,onAnimationEnd:function(e){const t=e.target;S&&t instanceof HTMLElement&&t.classList.remove(S)}},T,("day"===a||"week"===a)&&bq(ZQ,{events:[],month:l,onSelect:p,selectedDate:l,showOutOfMonthDays:!0,highlightMode:"week"===a?"week":"day",fixedHeight:!0}),"month"===a&&bq("div",{className:"DatePickerPopup-YearMonths"},void 0,b().months().map(((t,n)=>{const i=n===e.initialPeriod.month()&&e.initialPeriod.year()===l.year(),s=n===l.month();return bq("div",{className:mn()("DatePickerPopup-YearMonth",{"DatePickerPopup-YearMonth--Selected":s,"DatePickerPopup-YearMonth--Highlighted":i}),"data-period":n,onClick:g},t,t)}))),"year"===a&&bq("div",{className:"DatePickerPopup-YearMonths"},void 0,(0,YX.Z)(v,v+12).map((t=>{const n=t===e.initialPeriod.year(),i=t===l.year();return bq("div",{className:mn()("DatePickerPopup-YearMonth",{"DatePickerPopup-YearMonth--Selected":i,"DatePickerPopup-YearMonth--Highlighted":n}),"data-period":t,onClick:g},t,t)}))))]})}Sq.defaultProps={mode:"day"};const Tq=Sq;var Iq;function kq(e,t,n,i){Iq||(Iq="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Iq,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Aq=function(e){const[t,n]=tn.useState(!1),i=(0,Tm.Z)([D.kKeyboardTabToAll]),s=tn.useContext(dn.Z);function o(){n(!1)}function a(e){if(e.keyCode){const t=kA.Z[e.keyCode];if(e.repeat||"Space"!==t&&"Enter"!==t||e.target!==e.currentTarget)return}n(!t)}let r,l;switch(tn.useEffect((()=>{function t(){const{area:t}=V.Z.getContext(s.vivaldiWindowId);(!e.inPanel&&"panel"!==t||e.inPanel&&"panel"===t)&&n(!0)}return Qi.Z.addListener("COMMAND_CALENDAR_GOTO_DATE",t),()=>{Qi.Z.removeListener("COMMAND_CALENDAR_GOTO_DATE",t)}}),[e.inPanel,s]),e.displayMode){case"year":l="year",r=e.startDate.year();break;case"month":l="month",r=(0,le.Z)("$1 $2",[e.initialPeriod.format("MMMM"),e.initialPeriod.format("YYYY")]);break;case"multiweek":case"week":l="week",r=(0,le.Z)("$1 – $2",[e.startDate.format("ll"),e.endDate?.format("ll")]);break;case"day":l="day",r=b()(e.startDate).format(F.ZP.getWeekdayFormat("LL"));break;case"agenda":l="day",r=(0,le.Z)("$1 – $2",[e.startDate.format("ll"),e.endDate?.format("ll")])}return kq("div",{className:"PeriodPicker no-page-focus",onKeyDown:a,onMouseDown:a,tabIndex:i[D.kKeyboardTabToAll]},void 0,kq("h1",{title:(0,le.Z)("Click to Select Period")},void 0,r),kq(sl,{tooltip:(0,le.Z)("Click to Select Period"),popupPosition:"below",image:cn.yaZ.small,onClick:a,hidePopup:o,isPopupVisible:t,popupWidth:300,outsideClickIgnoreClass:"PeriodPicker",tabIndex:-1},void 0,kq(Tq,{initialPeriod:e.initialPeriod,setPeriod:e.setPeriod,mode:l,requestClose:o})))};var Zq,Eq,_q=n(81365),Nq=n(44854);function Mq(e,t,n,i){Zq||(Zq="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Zq,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function Pq(e){return t=>Mq(_q.W,{backend:Nq.HTML5Backend},void 0,(0,fn.jsx)(e,{...t}))}function Dq(e,t,n,i){Eq||(Eq="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Eq,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const xq=(0,yX.extendMoment)(b()),{minimalCreateEvent:Oq}=oc.Z,Lq=[D.kCalendarDisplayDensity,D.kCalendarDisplayWeekNumber,D.kMailIsTurnedOff];function Rq(){nt.Z.set(D.kCalendarDisplayDensity,"minimal")}function Bq(){nt.Z.set(D.kCalendarDisplayDensity,"compact")}function Fq(){nt.Z.set(D.kCalendarDisplayDensity,"full")}class Uq extends tn.Component{didManagerGetFocus=!1;mainEditorUid=Symbol("CalendarManagerMainView");sidebarEditorUid=Symbol("CalendarManagerSidebarView");state={showDaySidebar:M.Z.get(D.kCalendarShowDaySidebar),showTasksSidebar:M.Z.get(D.kCalendarShowTasksSidebar)};componentDidMount(){!1===this.didManagerGetFocus&&this.props.calendarContext.isActivePage&&(this.didManagerGetFocus=!0,o.Z.pollAllCalDAVAccounts(this.props.context.vivaldiWindowId,!0))}componentDidUpdate(){!1===this.didManagerGetFocus&&this.props.calendarContext.isActivePage&&(o.Z.pollAllCalDAVAccounts(this.props.context.vivaldiWindowId,!0),this.didManagerGetFocus=!0),!1===this.props.calendarContext.isActivePage&&(this.didManagerGetFocus=!1)}handleDisplayModeChange=e=>{this.onUpdateUI({displayMode:e,anchorDate:this.props.calendarFilter.selectedDate})};viewPrevious=()=>o.Z.viewPreviousPeriod(this.props.pageId);viewNext=()=>o.Z.viewNextPeriod(this.props.pageId);toggleSidebar=()=>{this.setState((e=>{if("agenda"===this.props.calendarFilter.displayMode){const t=!e.showTasksSidebar;return nt.Z.set(D.kCalendarShowTasksSidebar,t),{showTasksSidebar:t}}{const t=!e.showDaySidebar;return nt.Z.set(D.kCalendarShowDaySidebar,t),{showDaySidebar:t}}}))};toggleCompleted=()=>{this.onUpdateUI({showCompletedTasks:!this.props.calendarFilter.showCompletedTasks})};setToday=()=>{o.Z.selectToday(this.props.context.vivaldiWindowId,this.props.pageId)};setDate=(e,t)=>{this.onUpdateUI({anchorDate:t,selectedDate:t})};onUpdateUI=e=>{const t={...this.props.calendarFilter,...e};o.Z.updateCalendarUI(this.props.pageId,t)};onSearchChange=e=>{this.onUpdateUI({filterText:e,...!e&&{showSearchResults:!1}})};showSearchResults=()=>{this.onUpdateUI({showSearchResults:!0})};closeSearcResults=()=>{this.onUpdateUI({showSearchResults:!1,filterText:""})};newEvent=()=>{const e=this.props.calendarFilter.selectedDate.valueOf();o.Z.addEventCommand(this.props.context.vivaldiWindowId,Oq({start:e}))};eventSearchSelected=e=>{const t=Lo.Z.getEvent(e);t&&o.Z.selectEvent(this.props.calendarContext.editor,{event:t,allDay:t.allDay})};onClickBackground=e=>{if(e.stopPropagation(),this.props.eventDraft){const e=this.props.calendarContext.editor.uid;e!==this.mainEditorUid&&e!==this.sidebarEditorUid||o.Z.endEventEdit(this.props.context.vivaldiWindowId,this.props.calendarContext.editor)}};render(){if(this.props.prefValues[D.kMailIsTurnedOff])return Dq(eA,{windowId:this.props.context.vivaldiWindowId});const{displayMode:e,anchorDate:t,selectedDate:n,filterText:i,showSearchResults:s}=this.props.calendarFilter,o=oc.Z.getDisplayRange(t,e),a=this.props.eventDraft,{events:r,tasks:l,trashedEvents:d,selectedEvent:c}=this.props,h=["agenda","year"].includes(e)?0===r.length:r.every((e=>!0===e.filteredOut));let p;const u=this.props.prefValues[D.kCalendarDisplayWeekNumber],g=n.format(F.ZP.getWeekdayFormat("LL"));if("day"===e)p=u&&(0,le.Z)("Week $1",[n.week()]);else if("week"===e)p=u&&(0,le.Z)("Week $1",[n.week()]);else if("multiweek"===e){const{start:e,end:t}=o;p=u&&(0,le.Z)("Weeks $1 - $2",[e.week(),t.week()])}else if("month"===e){const e=xq(t);p=u&&(0,le.Z)("Weeks $1 - $2",[e.startOf("month").week(),e.endOf("month").week()])}else if("agenda"===e){const{start:e,end:t}=o;p=u&&(0,le.Z)("Weeks $1 - $2",[e.week(),t.week()])}const m=this.props.prefValues[D.kCalendarDisplayDensity],v=["week","multiweek","month","year"].includes(e)&&(!0===this.state.showDaySidebar||"year"===e)||"agenda"===e&&this.state.showTasksSidebar;return Dq(vs.Z,{focusName:"focus_calendar"},void 0,Dq("div",{className:"manager calendar",onClick:this.onClickBackground},void 0,Dq("div",{className:"toolbar toolbar-default"},void 0,Dq(sl,{onClick:this.newEvent,title:(0,le.Z)("New Event"),image:cn.md4.medium}),Dq(hq,{accounts:this.props.accounts,calendars:this.props.calendars}),Dq("div",{className:"toolbar-group",style:{marginLeft:"auto"}},void 0,Dq("span",{className:"density-label"},void 0,(0,le.Z)("calendar","View")),Dq(sl,{tooltip:(0,le.Z)("Minimal view"),isPressed:"minimal"===m,onClick:Rq,image:cn.NBh.medium}),Dq(sl,{tooltip:(0,le.Z)("Compact view"),isPressed:"compact"===m,onClick:Bq,image:cn.EEk.medium}),Dq(sl,{tooltip:(0,le.Z)("Full view"),isPressed:"full"===m,onClick:Fq,image:cn.Bd5.medium})),Dq(yq,{filterText:i,onSearchChange:this.onSearchChange,onSelectEvent:this.eventSearchSelected,onShowSearchResults:this.showSearchResults})),Dq("div",{className:"toolbar toolbar-default"},void 0,Dq("div",{className:"toolbar-group"},void 0,Dq(sl,{onClick:this.setToday,disabled:(0,bc.KC)(n.toDate(),new Date),title:(0,le.Z)("Today")})),Dq("div",{className:"toolbar-group",style:{marginRight:"auto"}},void 0,Dq(sl,{className:"button-narrow",onClick:this.viewPrevious,tooltip:(0,le.Z)("Previous"),image:cn.mgF.medium}),Dq(sl,{className:"button-narrow",onClick:this.viewNext,tooltip:(0,le.Z)("Next"),image:cn.Zu.medium})),Dq(Aq,{initialPeriod:t,setPeriod:this.setDate,startDate:o.start,endDate:o.end,displayMode:e,inPanel:!1}),p&&Dq("p",{className:"weeks"},void 0,p),Dq("div",{className:"toolbar-group",style:{marginLeft:"auto"}},void 0,Dq(sl,{onClick:this.handleDisplayModeChange.bind(this,"day"),title:(0,le.Z)("Day"),tooltip:(0,le.Z)("Day (d)"),isPressed:"day"===e}),Dq(sl,{onClick:this.handleDisplayModeChange.bind(this,"week"),title:(0,le.Z)("Week"),tooltip:(0,le.Z)("Week (w)"),isPressed:"week"===e}),Dq(sl,{onClick:this.handleDisplayModeChange.bind(this,"multiweek"),title:(0,le.Z)("Multiweek"),tooltip:(0,le.Z)("Multiweek (n)"),isPressed:"multiweek"===e}),Dq(sl,{onClick:this.handleDisplayModeChange.bind(this,"month"),title:(0,le.Z)("Month"),tooltip:(0,le.Z)("Month (m)"),isPressed:"month"===e}),Dq(sl,{onClick:this.handleDisplayModeChange.bind(this,"year"),title:(0,le.Z)("Year"),tooltip:(0,le.Z)("Year (y)"),isPressed:"year"===e}),Dq(sl,{onClick:this.handleDisplayModeChange.bind(this,"agenda"),title:(0,le.Z)("Agenda"),tooltip:(0,le.Z)("Agenda (a)"),isPressed:"agenda"===e})),Dq("div",{className:"toolbar-group"},void 0,Dq(eq,{windowId:this.props.context.vivaldiWindowId,trashedEvents:d}),Dq(sl,{onClick:this.toggleSidebar,disabled:"day"===e||"year"===e,tooltip:(0,le.Z)("Show Sidebar"),isPressed:"agenda"===e?this.state.showTasksSidebar:this.state.showDaySidebar||"year"===e,image:cn.xMN}))),!s&&h&&i&&Dq("div",{className:"no-search-results"},void 0,(0,le.Z)("Showing filtered results. Press “Search” for full results.")),Dq("div",{className:`manager-view ${e}`},void 0,s&&Dq(XQ,{selectedEvent:c,onSelectEvent:this.eventSearchSelected,filterText:i,onUpdateUI:this.onUpdateUI,onClose:this.closeSearcResults,editingEvent:a,editorUid:this.mainEditorUid}),!s&&Dq("div",{className:"manager-content"},void 0,Dq(GQ,{filter:this.props.calendarFilter,events:r,selectedEvent:c,editingEvent:a,editorUid:this.mainEditorUid})),v&&Dq("div",{className:"manager-detail"},void 0,"agenda"!==e&&Dq("div",{className:"header"},void 0,Dq("h1",{},void 0,g)),"agenda"===e&&Dq("div",{className:"header"},void 0,Dq("h1",{},void 0,(0,le.Z)("Tasks"))),Dq(GQ,{filter:this.props.calendarFilter,events:"agenda"!==e?oc.Z.filterEventsByPeriod(r,this.props.calendarFilter.selectedDate,"day"):l,anchorDate:this.props.calendarFilter.selectedDate,displayMode:"agenda"===e?"agenda":"day",eventDisplayStyle:"agenda"===e?"solid":null,selectedEvent:c,editingEvent:a,editorUid:"year"===e?this.mainEditorUid:this.sidebarEditorUid}),"agenda"===e&&Dq("div",{className:"footer cal-tasks"},void 0,Dq("label",{},void 0,Dq("input",{type:"checkbox",value:this.props.calendarFilter.showCompletedTasks,onChange:this.toggleCompleted}),Dq("span",{},void 0,(0,le.Z)("Show Completed Tasks"))))))))}}const Vq=VD(Pq((0,fs.Z)((e=>Dq(dn.Z.Consumer,{},void 0,(t=>Dq(OD.Consumer,{},void 0,(n=>(0,fn.jsx)(Uq,{context:t,calendarContext:n,...e})))))),Lq)));var Wq,Hq=n(62510),zq=n(9740),Gq=n(97891),$q=n(76148),Kq=n(22098);function jq(e,t,n,i){Wq||(Wq="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Wq,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var Yq=jq(Hq.Z,{mouseFollowTooltips:!0,voronoiDimension:"x"});class Xq extends tn.PureComponent{state={externalMutations:void 0};getDiff=()=>{const{data:e}=this.props;if(e.length>2){const t=[e[0].id,e[e.length-1].id];return b()(t[0]).diff(b()(t[1]),"days")}return e.length};formatTick=(e,t)=>{let n;switch(!0){case t<6:n="H:00",0===b()(e).hour()&&(n="ddd D");break;case t<20:n="H:00",0===b()(e).hour()&&(n="ddd D"),1===b()(e).date()&&(n="MMM",0===b()(e).month()&&(n="MMM YYYY"));break;case t<80:n="ddd D",1===b()(e).date()&&(n="MMM D",0===b()(e).month()&&(n="MMM YYYY"));break;default:n="MMM",0===b()(e).month()&&(n="YYYY")}return b()(e).format(n)};formatTotalLabel=({datum:e},t)=>{if(!e)return null;const n=this.formatTick(new Date(Math.round(e.unixDate)),t);return e.visits<1?n:(0,le.Z)("$1\nViews: $2\nPages: $3",[n,Math.round(e.visits),Math.round(e.pages)])};formatPieLabel=(e,t)=>{const n=e.slice.data;if(Number.isInteger(n.count)){const e=(0,Kq.Z)(n.count/t*100,0);if(e>0)return`${n.print}\n${e} %`}};removeMutation=()=>{this.setState({externalMutations:void 0})};toggleLabel=(e,t)=>{this.setState({externalMutations:[{target:"labels",eventKey:"all",mutation:()=>({active:!1}),callback:()=>this.removeMutation()},{target:"data",eventKey:"all",mutation:()=>({style:void 0}),callback:()=>this.removeMutation()},{target:"labels",eventKey:String(e),mutation:()=>({active:t}),callback:()=>this.removeMutation()},{target:"data",eventKey:String(e),mutation:()=>t?{style:{opacity:.5,fill:this.props.groupedHistoryData.linkTypeColors[e],stroke:"var(--colorBg)",strokeWidth:2}}:{style:void 0},callback:()=>this.removeMutation()}]})};render(){const{title:e,data:t,max:n,scaleY:i,groupedHistoryData:s,chartData:o}=this.props;if(0===Object.keys(s).length)return null;const a=0===t.length,{linkTypeColors:r,linkTypeTotal:l,linkTypes:d,combinedTopPages:c,pageCount:h,pageViewsCount:p,siteCount:u}=s,g=this.getDiff(),m=g<2,v={y:m?[0,n/2]:[0,n]},f={x:"time",y:i},y={duration:400,onLoad:{duration:0}},w=[r[0],r[3]],C="linear";return jq("div",{className:"manager-editor more-info"},void 0,jq("div",{className:"header"},void 0,jq("h1",{},void 0,e)),jq("div",{className:"moreinfo-stats"},void 0,jq("h2",{},void 0,(0,le.Z)("Browsing Activity")),jq("div",{className:"moreinfo-activity"},void 0,!1===a&&jq(Bh.Z,{containerComponent:Yq,width:245,height:200,padding:{top:6,right:12,bottom:40,left:30},domain:v,scale:f},void 0,jq(Rh.Z,{tickCount:m?13:void 0,tickFormat:e=>this.formatTick(e,g),standalone:!1,style:{axis:{stroke:"var(--colorFg)"},axisLabel:{fontSize:12,padding:20},grid:{stroke:"var(--colorFgAlpha)"},tickLabels:{angle:-45,textAnchor:"end",fontSize:11,padding:5,fontWeight:600,fontFamily:"inherit"}}}),jq(Rh.Z,{dependentAxis:!0,standalone:!1,style:{axis:{stroke:"var(--colorFg)"},axisLabel:{fontSize:12,padding:20},grid:{stroke:"var(--colorFgAlpha)"},ticks:{stroke:"var(--colorFg)"},tickLabels:{fontSize:11,padding:5,fontFamily:"inherit"}}}),jq(zq.Z,{animate:y,standalone:!0,responsive:!1,colorScale:w,style:{labels:{fontSize:13,padding:0,fontFamily:"inherit"}},labels:e=>this.formatTotalLabel(e,g),labelComponent:jq(Gq.Z,{constrainToVisibleArea:!0,pointerLength:0,flyoutStyle:{stroke:"var(--colorBorder)",fill:"var(--colorBg)"}})},void 0,jq(Fh.Z,{data:o,interpolation:C,standalone:!1,x:e=>b()(e.unixDate).toDate(),y:"pages"}),jq(Fh.Z,{data:o,interpolation:C,standalone:!1,x:e=>b()(e.unixDate).toDate(),y:e=>e.visits-e.pages})))),jq("ul",{className:"moreinfo-activity-labels"},void 0,jq("li",{className:"visits"},void 0,jq("span",{style:{backgroundColor:w[1]}}),(0,le.Z)("Page Views: $1",[p])),jq("li",{className:"pages"},void 0,jq("span",{style:{backgroundColor:w[0]}}),(0,le.Z)("Pages: $1",[h]))),jq("h2",{},void 0,(0,le.Z)("Link Transition Type")),jq("div",{className:"moreinfo-link-types"},void 0,!1===a&&jq($q.Z,{externalEventMutations:this.state.externalMutations,data:d,x:"type",y:"count",width:160,height:160,innerRadius:40,padding:10,colorScale:r,animate:y,style:{labels:{fontSize:13,padding:0,fontFamily:"inherit"}},labels:e=>this.formatPieLabel(e,l),labelComponent:jq(Gq.Z,{center:{x:80,y:80},pointerWidth:0,pointerLength:0,cornerRadius:0,flyoutStyle:{stroke:"none",fill:"transparent"}}),events:[{target:"data",eventHandlers:{onMouseEnter:()=>[{target:"labels",mutation:()=>({active:!0})},{target:"data",mutation:e=>({style:{...e.style,fill:r[e.index],opacity:.5,stroke:"var(--colorBg)",strokeWidth:2}})}],onMouseOut:()=>[{target:"labels",mutation:()=>({active:!1})},{target:"data",mutation:()=>({style:void 0})}]}}]}),!1===a&&jq("ul",{className:"moreinfo-link-labels"},void 0,d.map(((e,t)=>jq("li",{onMouseEnter:()=>this.toggleLabel(t,!0),onMouseOut:()=>this.toggleLabel(t,!1),title:e.print.length>7?e.print:null,className:0===e.count?"disabled":null},e.type,jq("span",{style:{backgroundColor:e.color}}),e.print))))),jq("h2",{},void 0,(0,le.Z)("Top Domains of $1 Total",[u])),c.length>0&&jq("ul",{className:"moreinfo-top-domains"},void 0,c.map(((e,t)=>{if(t<5)return jq("li",{onClick:this.props.onOpenDomain.bind(this,e.url),onContextMenu:this.props.onDomainContextMenu.bind(this,e.url)},"top_domain_"+t,jq(Oi,{url:e.url,loadType:"page"}),jq("span",{className:"title link"},void 0,e.url?e.url:"localhost"),jq("span",{className:"item-count"},void 0,e.visitCount))})))))}}const Qq=Xq,qq=[(0,Mn.Z)("keyword","title"),(0,Mn.Z)("keyword","url")].map((e=>{const t=(0,fg.lp)({label:e.label});return{...e,labelMatch:t,wordMatch:new RegExp(t,"i")}})),Jq=qq.map((e=>e.labelMatch)).join("|"),eJ=new RegExp(`(${Jq}):\\s*((['"])([^'"]*)\\3|\\S*([^:\\w]|\\w+\\b(?!:))*)`,"gi"),tJ=function(e){const t=e.match(eJ);if(!t)return{title:"",url:"",query:e.length?e.trim():""};const n=t[0],i=e.indexOf(n),s={query:e.substring(0,i).trim(),url:"",title:""};return t.forEach((e=>{const[t,n]=e.split(":"),i=qq.find((e=>null!==t.match(e.wordMatch)));if(i){const{labelEnglish:e}=i;s[e]=n.trim()}})),s};var nJ;function iJ(e,t,n,i){nJ||(nJ="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:nJ,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class sJ extends tn.Component{refSearch=tn.createRef();refDatePicker=tn.createRef();search=e=>{this.props.search({...this.props.historyFilter,...e})};focusField=()=>{this.refSearch.current?.focus()};onSearchChange=e=>{this.updateFilter(e.target.value)};updateFilter=e=>{const t=tJ(e.trim()),n={text:e,parsedFilter:t};this.search(n)};onStartTimeChange=e=>{const t=b()(e.target.value).startOf("day");t.isValid()&&this.search({startTime:t})};onEndTimeChange=e=>{const t=b()(e.target.value).endOf("day");this.search({endTime:t})};onSelectOption=()=>{const e=function(e){const t=parseInt(e);if(!isNaN(t))return t;switch(e){case"today":case"yesterday":case"last_month":case"all":case"date_range":return e;default:return"today"}}(this.refDatePicker.current?.value),t=v.Z.getTimeByRange({rangePicker:e},this.props.minDate.startOf("day"));this.search(t)};convertDate=e=>(0,F.SI)(b()(e));render(){const e=this.props.historyFilter,t=this.convertDate(new Date);return(0,fn.jsxs)(fn.Fragment,{children:[(0,fn.jsx)("input",{ref:this.refSearch,type:"search",tabIndex:"0",style:{flexShrink:2},value:e.text,onChange:this.onSearchChange,onFocus:this.props.onFocus,onBlur:this.props.onBlur,placeholder:(0,le.Z)("verb","Search")}),this.props.showPicker&&(0,fn.jsxs)("select",{ref:this.refDatePicker,style:{flexShrink:2},value:this.props.historyFilter.rangePicker,onChange:this.onSelectOption,children:[iJ("option",{value:"today"},void 0,(0,le.Z)("Today")),iJ("option",{value:"yesterday"},void 0,(0,le.Z)("Yesterday")),iJ("option",{value:"7"},void 0,(0,le.Z)("Last 7 Days")),iJ("option",{value:"30"},void 0,(0,le.Z)("Last 30 Days")),iJ("option",{value:"date_range"},void 0,(0,le.Z)("Date Range...")),iJ("option",{value:"all"},void 0,(0,le.Z)("All History"))]}),this.props.showPicker&&"date_range"===this.props.historyFilter.rangePicker&&iJ("div",{className:"date-range"},void 0,iJ(TA,{title:(0,le.Z)("Start Date"),max:t,value:this.convertDate(e.startTime),onChange:this.onStartTimeChange}),iJ(TA,{title:(0,le.Z)("End Date"),max:t,value:this.convertDate(e.endTime),onChange:this.onEndTimeChange}))]})}}const oJ=sJ,aJ=function(e){return class extends tn.Component{constructor(e){super(e),this.id=e.pageId||v.Z.getPanelResourceKey(),this.state=this._getSearchStateById(this.id),v.Z.addListener(this._onStoreChange)}componentWillUnmount(){v.Z.removeListener(this._onStoreChange)}_onStoreChange=(e,t)=>{if(t===this.id||void 0===t)if("filterChange"===e){const e=v.Z.getFilter(this.id);this.setState({historyFilter:e})}else"searchResultsReady"===e&&this.setState(this._getSearchStateById(this.id))};_getSearchStateById=e=>{const t=v.Z.getHistorySearchResults(e);return{historyItems:t.items,historyFilter:t.filter,historyStatistics:v.Z.getStatistics(e),oldestHistoryDate:t.oldestHistoryDate}};render(){return(0,fn.jsx)(e,{...this.props,...this.state})}}};var rJ;function lJ(e,t,n,i){rJ||(rJ="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:rJ,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class dJ extends tn.Component{handleClick=(e,t)=>{e.preventDefault(),e.altKey?this.props.historyItem.isExpanded?this.props.collapseAll():this.props.expandAll():this.props.toggle(t)};render(){const e=this.props.historyItem,t=e.children.reduce(((e,t)=>e+t.visitCount),0),n=F.ZP.getWeekdayFormat("LL"),i=b()(e.visitTime).format(n);return lJ("label",{"data-parent":e.id,onClick:this.props.fullView?t=>this.handleClick(t,e.id):null},void 0,!this.props.fullView&&lJ("span",{className:"expand-icon",onMouseDown:Cs.Z,onMouseUp:t=>this.handleClick(t,e.id),dangerouslySetInnerHTML:{__html:cn.nfH}}),lJ("span",{className:"url"},void 0,i),!0===this.props.showBadge&&lJ("span",{className:"item-count"},void 0,t))}}const cJ=dJ;var hJ;function pJ(e,t,n,i){hJ||(hJ="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:hJ,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var uJ=pJ("svg",{width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},void 0,pJ("path",{d:"M4.5,13.5v-12h7v12L8,10.7L4.5,13.5z"}));class gJ extends tn.Component{static contextType=dn.Z;onDragStart=e=>{const t=this.props.historyItem;var n=document.createElement("img");n.srcset="chrome://favicon/size/16@1x/"+t.url+" 1x,chrome://favicon/size/16@2x/"+t.url+" 2x",e.dataTransfer.setDragImage(n,n.width-n.width/3,n.height-n.height/3),n.remove(),Gi(e,t.url,t.title,this.props.isPrivateWindow)};handleMouseEnter=e=>{X.Z.setStatus(this.context.vivaldiWindowId,e)};handleMouseLeave=()=>{X.Z.clearStatus(this.context.vivaldiWindowId)};render(){const e=this.props.historyItem,t=b()(e.visitTime),n=e.url.split("\\").pop().split("/").pop()||e.url,i=F.ZP.getWeekdayFormat("LL");return this.props.fullView?this.props.columns?(0,fn.jsx)(fn.Fragment,{children:this.props.columns.map((s=>{switch(s.id){case"visitTime":return pJ("label",{className:"date",title:t.format(i),draggable:"true",onDragStart:this.onDragStart},s.id,pJ("span",{},void 0,t.format("LTS")));case"title":return pJ("label",{className:"title",title:e.title?e.title:n,draggable:"true",onDragStart:this.onDragStart},s.id,pJ(Oi,{url:e.url,loadType:"page"}),pJ("span",{},void 0,e.title?e.title:n));case"address":return pJ("label",{className:"url",title:e.url,draggable:"true",onDragStart:this.onDragStart},s.id,e.isBookmarked&&uJ,pJ("span",{},void 0,e.url));case"visitCount":return pJ("label",{className:"visits",draggable:"true",onDragStart:this.onDragStart},s.id,e.visitCount>1&&pJ("span",{className:"item-count"},void 0,e.visitCount));default:console.warn("Unknown sorting field:",s.id)}}))}):null:pJ("label",{title:t.format("LTS")+"\n"+t.format(i)+"\n• "+(e.title?(0,le.Z)("Title: $1",[e.title])+"\n• ":"")+(0,le.Z)("Address: $1",[e.url]),onMouseEnter:this.handleMouseEnter.bind(this,e.url),onMouseLeave:this.handleMouseLeave,draggable:"true",onDragStart:this.onDragStart},void 0,pJ(Oi,{url:e.url,loadType:"page"}),pJ("span",{className:"title"},void 0,pJ("span",{className:"time"},void 0,t.format("LT")),e.title?e.title:e.url),e.visitCount>1&&pJ("span",{className:"item-count"},void 0,e.visitCount))}}const mJ=gJ;var vJ;function fJ(e,t,n,i){vJ||(vJ="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:vJ,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function yJ(e,t,n){Jt.ZP.openUrls(e,(0,kI.Z)(t),n,!0)}class wJ extends tn.PureComponent{static contextType=dn.Z;refTreeList=tn.createRef();_isPrivateWindow=z.ZP.isIncognito(this.context.vivaldiWindowId);mapObject=(e,t)=>Object.keys(e).map((n=>t(n,e[n])));state={showBadge:M.Z.get(D.kPanelsShowFolderBadge)};componentDidMount(){M.Z.addListener(D.kPanelsShowFolderBadge,this._onBadgeChanged)}componentWillUnmount(){M.Z.removeListener(D.kPanelsShowFolderBadge,this._onBadgeChanged)}_onBadgeChanged=(e,t)=>{this.setState({showBadge:Boolean(t)})};setupExpandModel=(e,t,n)=>(t.forEach((t=>{this.isFolder(t)&&!e.hasOwnProperty(t.id)&&(e[t.id]=!0)})),e);hasChildren=e=>!!e.children&&e.children.length>0;isFolder=e=>!!e&&!!e.children;unSelectAll=()=>{this.refTreeList.current?.unSelectAll()};getSelectedItems=()=>{const e=this.refTreeList.current?.getAllSelectedItems().map((e=>e.id));return this.getItemsByIds(e,!0)};getSelectedItem=()=>this.refTreeList.current?.getSelectedItem();getItemById=e=>{const t=function(n){for(let i=0;i<n.length;i++){let s=n[i];if(s.id===e)return s;if(s.children&&(s=t(s.children),s))return s}};return t(this.props.nodes)};getItemsByIds=(e,t)=>{const n=[];return e.forEach((e=>{const i=this.getItemById(e);i&&(i.children&&t?Array.prototype.push.apply(n,i.children):n.push(i))})),n};openSelected=()=>{const e=this.getSelectedItems().map((({url:e})=>e));yJ(this.context.vivaldiWindowId,e,{inCurrent:!0,inNewWindow:!1,inBackground:!1,allowOverride:!1,incognito:!1})};openSelectedInNewTab=e=>{const t=this.getSelectedItems().map((({url:e})=>e)),n={inCurrent:!1,inNewWindow:!1,inBackground:e||M.Z.get(D.kTabsOpenNewInBackground),allowOverride:!1,incognito:!1};yJ(this.context.vivaldiWindowId,t,n)};openSelectedInNewWindow=e=>{const t=this.getSelectedItems().map((({url:e})=>e)),n={inCurrent:!1,inNewWindow:!0,inBackground:!1,allowOverride:!1,incognito:e};yJ(this.context.vivaldiWindowId,t,n)};copy=(e,t)=>{const n=this.getItemsByIds(t,!0).map((e=>e.url));e.clipboardData.setData("text/plain",n.join("\n")),e.clipboardData.setData("text/uri-list",n),e.preventDefault()};delete=e=>{const t=[];return this.getItemsByIds(e,this.props.historyFilter&&this.props.historyFilter.text.length>0).forEach((e=>{this.isFolder(e)?t.push({isFolder:!0,at:b()(e.id)}):t.push({isFolder:!1,url:e.url,at:e.visitTime})})),A.deleteHistoryPromise(t)};_saveBookmarks=e=>{const t=this.getItemsByIds(e,!0).map((e=>({url:e.url,title:e.title})));i.Z.createBookmarks(t,en.ZP.getRootNode().id)};handleExpandClick=e=>{this.refTreeList.current?.toggleSelectedExpansion(e)};expandAll=()=>{this.refTreeList.current?.expandAll()};collapseAll=()=>{this.refTreeList.current?.collapseAll()};getMenuCapability=async(e,t,n)=>{const i=this.context.vivaldiWindowId,s={address:n?n.address:""};switch(e.action){case"CONTEXT_OPEN_IN_NEW_TAB":return{handler:()=>this.openSelectedInNewTab(!1),visible:Boolean(n),...t(i,e,s)};case"CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB":return{handler:()=>this.openSelectedInNewTab(!0),visible:!M.Z.get(D.kTabsOpenNewInBackground)&&Boolean(n),...t(i,e,s)};case"CONTEXT_OPEN_IN_TAB":return{handler:this.openSelected,visible:Boolean(n),...t(i,e,s)};case"CONTEXT_OPEN_IN_NEW_WINDOW":return{handler:()=>this.openSelectedInNewWindow(!1),visible:Boolean(n),...t(i,e,s)};case"CONTEXT_OPEN_IN_PRIVATE_WINDOW":return{handler:()=>this.openSelectedInNewWindow(!0),visible:Boolean(n),...t(i,e,s)};case"CONTEXT_CONTAINER_OPEN_IN_WINDOW":{const s=this.getSelectedItems().map((({url:e})=>e)),o=await Hi.getMenu(i,!0,s);return{visible:Boolean(n)&&o.length>0,items:o,...t(i,e,{})}}case"CONTEXT_FILTER_BY":return{handler:()=>this.props.onSearchDomain(n.address),visible:Boolean(n)&&!this.isFolder(n),...t(i,e,s)};default:return{...t(i,e,s)}}};getMenuVisibility=(e,t)=>{if(t)switch(e.action){case"CONTEXT_COPY":case"CONTEXT_SAVE":case"CONTEXT_DELETE":case"CONTEXT_EXPAND_ALL":case"CONTEXT_COLLAPSE_ALL":return!0;default:return!1}else switch(e.action){case"CONTEXT_EXPAND_ALL":case"CONTEXT_COLLAPSE_ALL":return!0;default:return!1}};onContextMenu=e=>{this.refTreeList.current?.onContextMenu(e)};onItemMouseDown=(e,t)=>{t.button===vn.Z.kCenter&&(t.preventDefault(),t.stopPropagation())};onItemMouseUp=(e,t)=>{t.button===vn.Z.kCenter&&(this.openSelectedInNewTab(!0),t.preventDefault(),t.stopPropagation())};onItemDoubleClick=e=>{e.button!==vn.Z.kCenter&&this.onItemsActivated(e,this.getSelectedItems())};onItemsActivated=(e,t)=>{const n=this.context.vivaldiWindowId,i=(0,ls.Z)(n,e);yJ(n,this.getItemsByIds(t.map((e=>e.id)),!0).map((({url:e})=>e)),{...i})};isValidForClipboard=()=>!0;validateForDeletion=e=>e;getRowComponentProps=e=>({...e,columns:this.props.columns,showBadge:this.state.showBadge});rowComponent=e=>{const{columns:t,node:n}=e,i=[];return this.isFolder(n)?i.push(fJ(cJ,{historyItem:n,toggle:this.handleExpandClick,expandAll:this.expandAll,collapseAll:this.collapseAll,showBadge:e.showBadge,fullView:this.props.fullView},"history_tree_folder_"+n.id+"_"+n.visitTime)):i.push(fJ(mJ,{columns:t,historyItem:n,isPrivateWindow:this._isPrivateWindow,fullView:this.props.fullView},"history_tree_item_"+n.id+"_"+n.visitTime)),i};menu={name:"historylist",getCapability:this.getMenuCapability,getVisibility:this.getMenuVisibility};render(){if(!this.props.nodes)return null;const e={sortOrder:this.props.sortOrder,sortField:this.props.sortField,sortComparator:void 0,onlyScroll:!0},{historyFilter:t,nodes:n}=this.props,{text:i,displayMode:s}=t,o=!n.some((e=>e.children?.length>0)),a=n.some((e=>e.children));return(0,fn.jsx)(fn.Fragment,{children:o&&"week"!==s?fJ("div",{className:"vivaldi-tree-empty"},void 0,(0,le.Z)("The search term “$1” did not return any results.",[i])):(0,fn.jsx)(Yu,{settings:this.props.inManager?"HISTORY_MANAGER":"HISTORY_PANEL",ref:this.refTreeList,rowComponent:this.rowComponent,getRowComponentProps:this.getRowComponentProps,nodes:a?n.filter((e=>e.children.length)):n,columns:this.props.columns,folderMode:"custom",setupExpandModel:this.setupExpandModel,hasChildren:this.hasChildren,isFolder:this.isFolder,onItemDoubleClick:this.onItemDoubleClick,onItemMouseDown:this.onItemMouseDown,onItemMouseUp:this.onItemMouseUp,onItemsActivated:this.onItemsActivated,onCopy:this.copy,onSave:this._saveBookmarks,menu:this.menu,delete:this.delete,disableSelectAfterDelete:!1,enableDragAndDrop:!1,isValidForClipboard:this.isValidForClipboard,validateForDeletion:this.validateForDeletion,sorting:e})})}}const bJ=wJ;var CJ=n(15466);const SJ=function(e,t,n){if(!e||0===e.length)return{combinedTopPages:[],linkTypes:[],linkTypeColors:[],linkTypeTotal:0,pageCount:0,pageViewsCount:0,siteCount:0};const i={},s={},o=P.Z.getState().windowThemes.get(n)?.colorHighlightBg||lT.Z.getDefaultTheme().colorHighlightBg,a=Dr()(o).get("hsl.h"),r=Dr()(o).get("hsl.s"),l=Dr().scale([o,Dr()(o).set("hsl.h",a+50).desaturate(r),Dr()(o).set("hsl.h",a+130).desaturate(r),Dr()(o).set("hsl.h",a+180).desaturate(r),Dr()(o).set("hsl.h",a+230).desaturate(r),Dr()(o).set("hsl.h",a-50).desaturate(r)]).mode("lab").colors(6);let d=[{type:"auto_toplevel",count:0,color:l[0],print:(0,le.Z)("linktype","Direct")},{type:"typed",count:0,color:l[1],print:(0,le.Z)("linktype","Typed")},{type:"link",count:0,color:l[2],print:(0,le.Z)("linktype","Link")},{type:"reload",count:0,color:l[3],print:(0,le.Z)("linktype","Reload")},{type:"form_submit",count:0,color:l[4],print:(0,le.Z)("linktype","Form")},{type:"other",count:0,color:l[5],print:(0,le.Z)("linktype","Other")}],c=[];e.forEach((e=>{c=c.concat(t[e.id]?t[e.id].mostVisited:[]),d=e.children.map((e=>e.transition_type)).reduce(((e,t)=>{const n=e.find((e=>e.type===t));if(n)n.count=n.count+1;else{const t=e.find((e=>"other"===e.type));t&&(t.count=t.count+1)}return e}),d)}));const h=d.map((e=>e.color)),p=d.reduce(((e,t)=>e+t.count),0);e.forEach((e=>{e.children.forEach((e=>{i[e.address]=i[e.address]?e.visitCount+i[e.address]||0:e.visitCount,s[e.url]=s[e.url]?e.visitCount+s[e.url]||0:e.visitCount}))}));const u=Object.keys(s).length,g=Object.keys(i).length,m=Object.values(s).reduce(((e,t)=>e+parseInt(t)),0);return{linkTypeColors:h,linkTypeTotal:p,combinedTopPages:Object.keys(i).map((e=>({url:e,visitCount:i[e]}))).sort(((e,t)=>t.visitCount-e.visitCount)),linkTypes:d,pageCount:u,pageViewsCount:m,siteCount:g}};var TJ;function IJ(e,t,n,i){TJ||(TJ="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:TJ,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const kJ=[D.kStartpageNavigation],AJ=[{text:(0,le.Z)("Date"),fullScreenTitle:(0,le.Z)("Sort by visit time"),value:"visitTime",icon:cn.V_c,width:100,visible:!0},{text:(0,le.Z)("Title"),fullScreenTitle:(0,le.Z)("Sort by page title"),value:"title",width:300,visible:!0,key:!0},{text:(0,le.Z)("Address"),fullScreenTitle:(0,le.Z)("Sort by page address"),value:"address",icon:cn.iD7,width:300,visible:!0},{text:(0,le.Z)("Views"),fullScreenTitle:(0,le.Z)("Sort by number of page views"),value:"visitCount",icon:cn.boz,width:100,visible:!0}],ZJ=(0,yX.extendMoment)(b());class EJ extends tn.PureComponent{static contextType=dn.Z;state={columns:vu().history||fu(AJ)};_locale={weekdays:F.ZP.getWeekdays("long"),weekdaysShort:F.ZP.getWeekdays("short"),monthsShort:F.ZP.getMonths("short"),weekStartsOn:ZJ.localeData().firstDayOfWeek()};_selecting=!1;_selectionHighlight=!1;_anchorDate=ZJ();_shortDayFormat=F.ZP.getWeekdayFormat(F.ZP.getShortDateFormat());_searchHasFocus=!1;componentDidMount(){A.loadAll()}_saveStateByFilter=(e,t)=>{const n={displayMode:t.displayMode,startTime:t.startTime.valueOf(),endTime:t.endTime.valueOf(),dayPickerVisible:t.dayPickerVisible,moreInfoVisible:t.moreInfoVisible,monthEntriesVisible:t.monthEntriesVisible};Y.Z.setHistoryManagerState(e,n),A.saveStateFromSearchQuery(e,t)};_setRange=(e,t,n=null,i=!1)=>{const{historyFilter:s}=this.props,o=ZJ.range(ZJ(e).startOf("day"),ZJ(t).endOf("day")),a={...s,startTime:o.start,endTime:o.end,displayMode:n||s.displayMode,range:o};this._selectionHighlight=i,this.onSearch(a)};_setDayPickRange=(e,t)=>{const{historyFilter:n}=this.props,i=ZJ.range(n.startTime,n.endTime),s=ZJ.range(ZJ(e).startOf("day"),ZJ(t).endOf("day"));if(ZJ(e).within(i)&&ZJ(t).within(i)){const e={...n,range:s};this.onSearch(e),this._selectionHighlight=!0}else if(s.overlaps(i)){const e=s.add(i);this._setRange(e.start,e.end,null,!1)}else this._setRange(ZJ(t).startOf(n.displayMode),ZJ(t).endOf(n.displayMode),null,!1)};toggleDayPicker=()=>{const e="dayPickerVisible",{historyFilter:t}=this.props,n={...t,[e]:!this.props.historyFilter[e]};this.onSearch(n)};toggleMoreInfo=()=>{const e="moreInfoVisible",{historyFilter:t}=this.props,n={...t,[e]:!this.props.historyFilter[e]};this.onSearch(n)};_setView=e=>{const t=e.target.value,{historyFilter:n}=this.props,i={...n,[t]:!n[t]};this.onSearch(i)};onSortChange=(e,t)=>{const{historyFilter:n}=this.props,i={...n,sortOrder:e,sortField:t};this.onSearch(i)};onUpdateRow=e=>{this.setState({columns:e})};onSaveRow=()=>{mu(this.state.columns,"history")};onSelectAll=()=>{const e=ZJ(),t=this.props.oldestHistoryDate,{historyFilter:n}=this.props,i={...n,startTime:t,endTime:e.endOf("day")};this.onSearch(i),this._setRange(t,e.endOf("day"),"range",!1)};onIncludeUrlChange=()=>{const e=!this.props.historyFilter.searchURL,{historyFilter:t}=this.props,n={...t,searchURL:e};this.onSearch(n)};onClearBrowsingData=()=>{ie.Z.showClearBrowsingHistoryDialog(this.context.vivaldiWindowId)};onCalendarSelect=(e,t)=>{if(!0===this._selecting)return void(this._selecting=!1);const n=t?t.nativeEvent?t.nativeEvent.shiftKey:t.shiftKey:0,i=ZJ(e);if(n){const e=this.expandRange(i);this._setRange(e.start,e.end)}else ZJ(e).within(this.props.historyFilter.range)||(this._selectionHighlight=!0,this._anchorDate=i,this._setRange(i,i,null,!0))};expandRange=e=>{const t=this.props.historyFilter.range,n=ZJ.range(e,e);return t.contains(n)?t:e.unix()>t.start.unix()?ZJ.range(t.start,n.end.endOf("day")):ZJ.range(n.start.startOf("day"),t.end)};handleMouseDown=(e,t)=>{const n=t.nativeEvent?t.nativeEvent.button:t.button,i=(t.nativeEvent?t.nativeEvent.ctrlKey:t.ctrlKey,t.nativeEvent?t.nativeEvent.shiftKey:t.shiftKey);if(n&&0!==n)return;const s=ZJ(e);let o;i?(o=this.expandRange(s),this._setDayPickRange(o.start,o.end)):this._setDayPickRange(s,s),this._selecting=!0,this._anchorDate=ZJ(e)};handleMouseUp=(e,t)=>{this._selecting&&this.props.historyFilter.range&&(this._selecting=!1)};handleMouseEnter=(e,t)=>{if(!this._selecting||!this.props.historyFilter.range)return;const n=this.expandRange(ZJ(e));this._setDayPickRange(n.start,n.end)};onSearch=e=>{const t=this.props.pageId;if(t){const n={...this.props.historyFilter,...e};this._saveStateByFilter(t,n),A.searchHistory(t,n)}};onSearchDomain=e=>{e=aS(e);const{historyFilter:t}=this.props,n={...t,text:e,parsedFilter:tJ(e),searchURL:!0};this.onSearch(n)};onOpenDomain=e=>{Y.Z.openURL(this.context.vivaldiWindowId,(0,Ni.q9)(e))};handleDisplayModeChange=(e="day")=>{if("range"===e)this._anchorDate=ZJ(),this._setRange(this.props.oldestHistoryDate,ZJ(),e,!1);else{const t=this._anchorDate||ZJ();this._setRange(ZJ(t).startOf(e),ZJ(t).endOf(e),e,!1)}};restoreSelection=()=>{this._selectionHighlight=!1;const{displayMode:e}=this.props.historyFilter;this.handleDisplayModeChange(e)};viewCurrent=()=>{const{displayMode:e}=this.props.historyFilter;this._setRange(ZJ().startOf(e),ZJ().endOf(e))};viewPrevious=e=>{const{startTime:t,displayMode:n}=this.props.historyFilter,i="range"===n?"day":n,s=ZJ(t).subtract(1,i).startOf(i),o=ZJ(s).endOf(i);this._setRange(s,o)};viewNext=()=>{const{startTime:e,displayMode:t}=this.props.historyFilter,n="range"===t?"day":t,i=ZJ(e).add(1,n).startOf(n),s=ZJ(i).endOf(n);this._setRange(i,s)};getNumWeeksForMonth=(e,t)=>{let n=new Date(e,t-1,1).getDay()-this._locale.weekStartsOn;n<0&&(n+=7);const i=new Date(e,t,0).getDate();return Math.ceil((i+n)/7)};getDomainMenuItems=e=>[{handler:()=>this.onSearchDomain(e),...(0,Mn.Z)("Filter by “$1”",[e])},{handler:()=>this.onOpenDomain(e),...(0,Mn.Z)("Go to “$1”",[e])}];onDomainContextMenu=(e,t)=>{(0,zi.Z)(this.context.vivaldiWindowId,this.getDomainMenuItems(e))(t)};getActivityLevel=(e,t,n)=>e>=t-t/10?"max":e>=n&&e<t-t/10?"high":e>=n/2&&e<n?"mid":e>0&&e<n/2?"low":"min";renderMonthDay=(e,t,n,i,s)=>{s=ZJ(s);const{historyStatistics:o,historyFilter:a}=this.props,r=o[(0,F.SI)(s)];if(!r)return IJ("div",{className:s.within(a.range)?"selected":null},void 0,IJ("span",{className:"Cal__Day__day"},void 0,s.date()));const l=o[(0,F.SI)(s)].visits||0,d=this.getActivityLevel(l,e,t),c=Math.max(Math.floor((n-72)/15),1);let h=[];a.text.length>0?h=r.mostVisited.map((e=>e.url)):(h=r.mostVisited.map((e=>aS(e.url))),h=(0,kI.Z)(h));const p=h.map(((e,t)=>{if(t<c)return IJ("li",{title:e,onContextMenu:this.onDomainContextMenu.bind(this,e)},s.unix()+"_"+t,e)}));return IJ("div",{className:s.within(a.range)?"selected":null},void 0,IJ("span",{className:"Cal__Day__day"},void 0,s.date()),IJ("h4",{className:mn()({heat:!0,[`${d}`]:!0})},void 0,IJ("span",{className:"visits"},void 0,IJ("strong",{},void 0,r.visits),(0,le.Z)("view","views",[r.visits])),IJ("span",{className:"pages"},void 0,IJ("strong",{},void 0,r.pages),(0,le.Z)("page","pages",[r.pages]))),IJ("ul",{className:"top-links"},void 0,p))};renderCalWeek=()=>{const{historyItems:e,historyFilter:t}=this.props,{range:n}=this.props.historyFilter;let i=Array.from(n.by("days"));if(ZJ(i[0]).day()!==this._locale.weekStartsOn||i.length<7){const e=ZJ(i[0]).startOf("week"),t=ZJ(i[0]).endOf("week");i=Array.from(ZJ.range(e,t).by("days"))}else i.length>7&&(i=i.slice(0,6));return IJ("div",{className:"week-container"},void 0,i.map((i=>{const s=ZJ(i).within(n),o=e.find((e=>e.id===(0,F.SI)(i))),a=ZJ(i).within(ZJ.range(this.props.oldestHistoryDate,ZJ()));return IJ("div",{className:"week-day"},"week_"+(0,F.SI)(i),IJ("header",{onClick:a?this._setDayPickRange.bind(this,i,i):null,className:mn()({selected:s,disabled:!a})},void 0,i.format(this._shortDayFormat)),IJ("div",{className:"tree"},void 0,o&&IJ(bJ,{fullView:!1,inManager:!0,nodes:o.children,historyFilter:t,onSearchDomain:this.onSearchDomain,sortField:t.sortField,sortOrder:t.sortOrder},"week_"+i.id)))})))};renderCalDay=(e,t,n)=>{n=ZJ(n);const{historyStatistics:i,historyFilter:s}=this.props,o=ZJ(this.props.oldestHistoryDate).within(s.range)&&ZJ().within(s.range);let a,r="min";return i[(0,F.SI)(n)]?(a=i[(0,F.SI)(n)].visits||0,r=this.getActivityLevel(a,e,t)):a=0,IJ("span",{title:(0,le.Z)("$1 visit","$1 visits",[a]),className:mn()({heat:!0,selected:!o&&n.within(s.range),[`${r}`]:!0})},n.unix()+"_"+n)};padStats=e=>{const{historyStatistics:t,historyFilter:n,historyItems:i}=this.props;let s=e.start.clone(),o=e.end.clone();i.length===e.duration("days")&&(s=s.startOf(n.displayMode),o=o.endOf(n.displayMode));const a=ZJ.range(s,o),r=new Map;for(const[e,n]of Object.entries(t)){const t=ZJ(e,"YYYY-MM-DD");t.within(a)&&r.set(e,{hour:0,pages:n&&"number"==typeof n.pages?n.pages:0,visits:n&&"number"==typeof n.visits?n.visits:0,unixDate:t.valueOf()})}for(;s.diff(o)<=0;){const e=(0,F.SI)(s);r.has(e)||r.set(e,{hour:0,pages:0,visits:0,unixDate:s.valueOf()}),s.add(1,"d")}return[...r.values()].sort(((e,t)=>e.unixDate>t.unixDate?1:t.unixDate>e.unixDate?-1:0))};render(){const{historyFilter:e,historyStatistics:t}=this.props,n=e.range,i=this.props.historyItems.filter((e=>e.id>=(0,F.SI)(n.start)&&e.id<=(0,F.SI)(n.end)));let s=[];if(!i||"number"!=typeof this.props.maxHeight)return null;const o=e.text.length>1||e.moreInfoVisible?SJ(i,t,this.context.vivaldiWindowId):{combinedTopPages:[],linkTypeColors:[],linkTypeTotal:0,linkTypes:[],pageCount:0,pageViewsCount:0,siteCount:0};e.moreInfoVisible&&(s=Object.keys(t).length>0&&1===i.length&&i[0].id&&t[i[0].id]?t[i[0].id].timeArr:this.padStats(n));const a=ZJ(e.startTime),r=this.getNumWeeksForMonth(a.year(),a.month()+1),l=(0,F.SI)(n.start)===(0,F.SI)(ZJ(this.props.oldestHistoryDate))&&(0,F.SI)(n.end)===(0,F.SI)(ZJ());let d,c,h,p=[],u="";switch(i.length>1&&(p=[ZJ(i[0].visitTime).format("l"),ZJ(i[i.length-1].visitTime).format("l")],u="visitTime"===e.sortField&&2===e.sortOrder?p[0]+" – "+p[1]:p[1]+" – "+p[0]),d="month"===e.displayMode?(0,le.Z)("$1 $2",[ZJ(a).format("MMMM"),ZJ(a).format("YYYY")]):"week"===e.displayMode?(0,le.Z)("Week $1, $2",[ZJ(a).week(),ZJ(a).year()]):i.length>1?u:ZJ(e.startTime).format("LL"),c=i.length>1?u:1===i.length?ZJ(i[0].visitTime).format("LL"):ZJ(e.startTime).format("LL"),e.displayMode){case"month":h=(0,le.Z)("This Month");break;case"week":h=(0,le.Z)("This Week");break;default:h=(0,le.Z)("Today")}const g=ZJ(Object.keys(t).sort()[0]).startOf("month"),m=ZJ(),v=ZJ(this.props.oldestHistoryDate).isBefore(m.subtract(2,"m"))?ZJ(this.props.oldestHistoryDate):m.subtract(2,"m"),f=Object.keys(t).map((e=>t[e].visits)),y=Math.max(Math.max.apply(Math,f),10);f.sort(((e,t)=>e-t));const w=(f[Math.floor((f.length-1)/2)]+f[Math.ceil((f.length-1)/2)])/2,b="on"===this.props.prefValues[D.kStartpageNavigation]?51:0,C=e.text.length>1?40:0,S=this.props.maxHeight-(b+C+40+21),T=S/r;return IJ("div",{className:"history manager"},void 0,IJ("div",{className:"toolbar toolbar-default"},void 0,IJ(sl,{onClick:this.toggleDayPicker,tooltip:(0,le.Z)("Day picker calendar"),isPressed:e.dayPickerVisible,image:cn.eVT}),IJ(oJ,{search:this.onSearch,onFocus:()=>{this._searchHasFocus=!0},onBlur:()=>{this._searchHasFocus=!1},historyFilter:e,minDate:this.props.oldestHistoryDate}),IJ("h1",{onClick:this.restoreSelection,style:{marginLeft:"auto",marginRight:"auto",flexShrink:5}},void 0,d),IJ(sl,{onClick:this.viewCurrent,title:h}),IJ("div",{className:"toolbar-group"},void 0,IJ(sl,{onClick:this.viewPrevious.bind(this,g),tooltip:(0,le.Z)("Previous"),className:"button-narrow",disabled:ZJ(this.props.oldestHistoryDate).within(n),image:cn.mgF.medium}),IJ(sl,{onClick:this.viewNext,className:"button-narrow",tooltip:(0,le.Z)("Next"),disabled:m.within(n),image:cn.Zu.medium})),IJ("div",{className:"toolbar-group"},void 0,IJ(sl,{title:(0,le.Z)("List"),isPressed:"range"===e.displayMode,onClick:()=>this.handleDisplayModeChange("range")}),IJ(sl,{title:(0,le.Z)("Day"),isPressed:"day"===e.displayMode,onClick:()=>this.handleDisplayModeChange("day")}),IJ(sl,{title:(0,le.Z)("Week"),isPressed:"week"===e.displayMode,onClick:()=>this.handleDisplayModeChange("week")}),IJ(sl,{title:(0,le.Z)("Month"),isPressed:"month"===e.displayMode,onClick:()=>this.handleDisplayModeChange("month")})),IJ(sl,{onClick:this.onClearBrowsingData,tooltip:(0,le.Z)("title","Clear browsing data"),image:cn.DwE.medium}),IJ(sl,{onClick:this.toggleMoreInfo,tooltip:e.moreInfoVisible?(0,le.Z)("Hide info"):(0,le.Z)("More info"),image:cn.GH$,isPressed:e.moreInfoVisible})),e.text.length>1&&IJ("div",{className:"toolbar toolbar-default toolbar-medium search-options"},void 0,IJ(sl,{onClick:this.onSelectAll,title:(0,le.Z)("Search All History"),disabled:l}),IJ("label",{},void 0,IJ("input",{type:"checkbox",checked:e.searchURL,onChange:this.onIncludeUrlChange}),(0,le.Z)("Include Address in Search Results")),IJ("div",{className:"filtered-entries"},void 0,(0,le.Z)("$1 Entry","$1 Entries",[o.pageViewsCount]))),IJ("div",{className:mn()({"history-view":!0,selecting:this._selectionHighlight})},void 0,e.dayPickerVisible&&IJ("div",{className:"manager-editor"},void 0,IJ("div",{className:"timeline",onMouseLeave:this.handleMouseUp},void 0,IJ(CJ.ZP,{Component:(0,CJ.ig)((0,CJ.Ee)(CJ.f)),width:270,height:S,rowHeight:50,selected:n.start.toDate(),onSelect:this.onCalendarSelect,onDayMouseDown:this.handleMouseDown,onDayMouseUp:this.handleMouseUp,onDayMouseEnter:this.handleMouseEnter,min:g.toDate(),max:m.toDate(),minDate:v.toDate(),maxDate:m.toDate(),displayOptions:{showHeader:!1,showOverlay:!0,showTodayHelper:!1,overscanMonthCount:6},locale:this._locale,autoFocus:!1,tabIndex:0,renderMonthDay:this.renderCalDay.bind(this,y,w)}))),IJ("div",{className:"manager-content history-calendar-container"},void 0,"range"===e.displayMode&&IJ("div",{className:"view range"},void 0,IJ(Iu,{fields:AJ,columns:this.state.columns,fullsize:!0,manualSorting:!1,keyAccess:this.props.keyAccess,onUpdateRow:this.onUpdateRow,onSaveRow:this.onSaveRow,onSortChange:this.onSortChange,sortField:e.sortField,sortOrder:e.sortOrder}),i.length>0?IJ("div",{className:"history-tree"},void 0,IJ(bJ,{fullView:!0,inManager:!0,columns:this.state.columns,nodes:i,onSearchDomain:this.onSearchDomain,historyFilter:e,sortField:e.sortField,sortOrder:e.sortOrder})):IJ("div",{className:"vivaldi-tree-empty"},void 0,(0,le.Z)("No browsing history data for selected period."))),"day"===e.displayMode&&IJ("div",{className:"view day"},void 0,IJ(Iu,{fields:AJ,columns:this.state.columns,fullsize:!0,manualSorting:!1,keyAccess:this.props.keyAccess,onUpdateRow:this.onUpdateRow,onSaveRow:this.onSaveRow,onSortChange:this.onSortChange,sortField:e.sortField,sortOrder:e.sortOrder}),i.length>0?IJ("div",{className:"history-tree"},void 0,IJ(bJ,{fullView:!0,inManager:!0,columns:this.state.columns,nodes:i,historyFilter:e,onSearchDomain:this.onSearchDomain,sortField:e.sortField,sortOrder:e.sortOrder})):IJ("div",{className:"vivaldi-tree-empty"},void 0,(0,le.Z)("No browsing history data for selected period."))),"week"===e.displayMode&&IJ("div",{className:"view week"},void 0,this.renderCalWeek()),"month"===e.displayMode&&IJ("div",{className:"view month"},void 0,IJ("div",{className:"month-calendar"},void 0,IJ(CJ.ZP,{Component:(0,CJ.ig)((0,CJ.Ee)(CJ.f)),width:"100%",height:S,rowHeight:T>100?T:100,selected:n.start.toDate(),onSelect:this.onCalendarSelect,onDayMouseDown:this.handleMouseDown,onDayMouseUp:this.handleMouseUp,onDayMouseEnter:this.handleMouseEnter,longWeekdays:!0,min:ZJ(a.startOf("month")).toDate(),max:ZJ(a.endOf("month")).toDate(),minDate:ZJ(a.startOf("month")).toDate(),maxDate:ZJ(a.endOf("month")).toDate(),displayOptions:{showHeader:!1,showOverlay:!1,showTodayHelper:!1,overscanMonthCount:0},locale:this._locale,autoFocus:!this._searchHasFocus,tabIndex:0,renderMonthDay:this.renderMonthDay.bind(this,y,w,T,Math.floor(this.props.maxWidth/7))})),e.monthEntriesVisible&&IJ("div",{className:"month-links"},void 0,IJ("ul",{className:"Cal__Weekdays__root"},void 0,IJ("li",{className:"Cal__Weekdays__day"},void 0,(0,le.Z)("Entries"))),IJ(bJ,{fullView:!1,inManager:!0,nodes:i,historyFilter:e,onSearchDomain:this.onSearchDomain,sortField:e.sortField,sortOrder:e.sortOrder})),IJ("button",{className:"toggle-month-entries",title:e.monthEntriesVisible?(0,le.Z)("Hide entries"):(0,le.Z)("Show entries"),onClick:this._setView,value:"monthEntriesVisible",tabIndex:this.props.keyAccess},void 0,e.monthEntriesVisible?">":"<"))),e.moreInfoVisible&&IJ(Qq,{title:c,data:i,groupedHistoryData:o,onOpenDomain:this.onOpenDomain,chartData:s,max:y,scaleY:"sqrt",onDomainContextMenu:this.onDomainContextMenu})))}}const _J=(0,fs.Z)(aJ(EJ),kJ);var NJ=n(62882),MJ=n(50564),PJ=n(60007),DJ=n.n(PJ),xJ=n(89927),OJ=n(63549),LJ=n(57570),RJ=n.n(LJ),BJ=n(96936),FJ=n.n(BJ),UJ=n(5460),VJ=n.n(UJ),WJ=n(61519),HJ=n.n(WJ),zJ=n(56827),GJ=n.n(zJ),$J=n(6691),KJ=n.n($J),jJ=n(74006),YJ=n.n(jJ),XJ=n(4499),QJ=n.n(XJ),qJ=n(91833),JJ=n.n(qJ),e0=n(45253),t0=n.n(e0),n0=n(27055),i0=n.n(n0),s0=n(85215),o0=n.n(s0),a0=n(29560),r0=n.n(a0),l0=n(37721),d0=n.n(l0),c0=n(96344),h0=n.n(c0),p0=n(82026),u0=n.n(p0),g0=n(23874),m0=n.n(g0),v0=n(93839),f0=n.n(v0),y0=n(61083),w0=n.n(y0),b0=n(66842),C0=n.n(b0),S0=n(42387),T0=n.n(S0),I0=n(61896),k0=n.n(I0),A0=n(78529),Z0=n.n(A0),E0=n(30308),_0=n.n(E0),N0=n(58473),M0=n.n(N0),P0=n(36632),D0=n.n(P0),x0=n(19514),O0=n.n(x0),L0=n(97181),R0=n.n(L0),B0=n(26306),F0=n.n(B0),U0=n(91533),V0=n.n(U0),W0=n(17151),H0=n.n(W0),z0=n(42157),G0=n.n(z0);const $0={FORBID_TAGS:["style"],ALLOW_UNKNOWN_PROTOCOLS:!0};class K0{constructor(){RJ().registerLanguage("apache",FJ()),RJ().registerLanguage("applescript",VJ()),RJ().registerLanguage("bash",HJ()),RJ().registerLanguage("basic",GJ()),RJ().registerLanguage("coffeescript",KJ()),RJ().registerLanguage("cpp",YJ()),RJ().registerLanguage("css",QJ()),RJ().registerLanguage("diff",JJ()),RJ().registerLanguage("django",t0()),RJ().registerLanguage("dockerfile",i0()),RJ().registerLanguage("dos",o0()),RJ().registerLanguage("ini",r0()),RJ().registerLanguage("java",d0()),RJ().registerLanguage("javascript",h0()),RJ().registerLanguage("json",u0()),RJ().registerLanguage("less",m0()),RJ().registerLanguage("markdown",f0()),RJ().registerLanguage("mathematica",w0()),RJ().registerLanguage("matlab",C0()),RJ().registerLanguage("nginx",T0()),RJ().registerLanguage("objectivec",k0()),RJ().registerLanguage("perl",Z0()),RJ().registerLanguage("python",_0()),RJ().registerLanguage("ruby",M0()),RJ().registerLanguage("scss",D0()),RJ().registerLanguage("shell",O0()),RJ().registerLanguage("sql",R0()),RJ().registerLanguage("swift",F0()),RJ().registerLanguage("typescript",V0()),RJ().registerLanguage("vim",H0()),RJ().registerLanguage("xml",G0()),this.remarkable=new xJ._("commonmark",{html:!0,breaks:!0,typographer:!1,quotes:(0,le.Z)("“”‘’"),highlight:(e,t)=>{if(t&&RJ().getLanguage(t))try{return RJ().highlight(t,e).value}catch(e){}return""}}),this.remarkable.use(DJ()),this.remarkable.use(OJ.N);const e=this.remarkable.inline.validateLink,t=/^\s*data:([a-z]+\/[a-z]+(;[a-z-]+=[a-z-]+)?)?(;base64)?,[a-z0-9!$&',()*+,;=\-._~:@/?%\s]*\s*$/i,n=/^\s*blob:chrome-extension:\/\/[a-z0-9!$&',()*+,;=\-._~:@/?%\s]*\s*$/i,i=/^\s*file:\/\/[a-z0-9!$&',()*+,;=\-._~:@/?%\s]*\s*$/i;this.remarkable.inline.validateLink=s=>e(s)||s.match(t)||s.match(n)||s.match(i),this.remarkable.inline.ruler.enable(["del","mark","sub","sup"]),this.remarkable.block.ruler.enable(["table"])}getRawMarkup(e){return(0,Cc.sanitize)(this.remarkable.render(e),$0)}}var j0;function Y0(e,t,n,i){j0||(j0="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:j0,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class X0 extends tn.Component{static contextType=dn.Z;refWebview=tn.createRef();constructor(e,t){super(e),this.state={startOffsetOnNewline:0,createLinkModalOpen:!1,caretState:{bold:!1,italic:!1,strikeThrough:!1,formatBlock:"p",insertOrderedList:!1,insertUnorderedList:!1},windowStyle:P.Z.getState().windowStyles.get(t.vivaldiWindowId)||lT.Z.getFallbackStyle()},this.markdownFormatter=new K0}componentDidMount(){P.Z.addListener(this.onThemeStoreChanged),this.refWebview.current?.addEventListener("consolemessage",this.handleConsoleMessage),this.refWebview.current?.addEventListener("contentload",this.handleContentLoad),this.refWebview.current?.addEventListener("newwindow",this.handleGoToURL)}componentWillUnmount(){P.Z.removeListener(this.onThemeStoreChanged),this.refWebview.current?.removeEventListener("consolemessage",this.handleConsoleMessage),this.refWebview.current?.removeEventListener("contentload",this.handleContentLoad),this.refWebview.current?.removeEventListener("newwindow",this.handleGoToURL)}onThemeStoreChanged=()=>{const e=P.Z.getState().windowStyles.get(this.context.vivaldiWindowId)||lT.Z.getFallbackStyle();e!==this.state.windowStyle&&this.setState({windowStyle:e},this.setStyle)};handleContentLoad=()=>{this.contentLoadHandled||(this.contentLoadHandled=!0,this.setStyle(),this.props.onContentLoad&&this.props.onContentLoad())};handleGoToURL=e=>{e.preventDefault(),e.targetUrl.startsWith("#")||Y.Z.openURL(this.context.vivaldiWindowId,e.targetUrl)};onCaretStateEvent(e){if(!e)return;let t;try{t=JSON.parse(e)}catch(e){return}this._updateCaretState(t)}_updateCaretState(e){this.setState((t=>({caretState:{...t.caretState,...e}})),(()=>this.props.updateButtonState?.()))}focus(){this.refWebview.current?.focus()}hasFocus(){const{document:e}=this.context;return Boolean(this.refWebview.current)&&this.refWebview.current===e.activeElement}getContentAsBodyParts=()=>{const e=this.refWebview.current;return e?new Promise(((t,n)=>{e.executeScript({code:"document.body.innerText"},(e=>{e&&Array.isArray(e)&&"string"==typeof e[0]?t([{type:"text",content:e[0],charset:"UTF-8"}]):n("PlainTextEdit.getContentAsBodyParts: Couldn't get content from Webview")}))})):Promise.reject("RichTextEdit.getContentAsBodyParts: Webview doesn't exist")};onClick=e=>{if("createLink"===e)this.props.handleLinkEvent(e);else this.execCommand(e,""),this.props.updateButtonState?.()};onChange=(e,t)=>{this.execCommand(e,t.currentTarget.value),this.props.updateDropdownState?.()};execCommand(e,t){this.refWebview.current?.contentWindow?.postMessage({type:"BUTTON_CLICK",command:e,value:t},Q.oP)}setContent=e=>{this.refWebview.current?.executeScript({code:`document.body.innerText = unescape('${escape(e)}');`},this.setStyle)};setStyle=()=>{this.refWebview.current?.executeScript({code:"document.head.innerHTML = `<style>"+lT.Z.createStyleRoot(this.state.windowStyle)+"\n    html, body, iframe {\n      background-color: transparent;\n      padding: 0;\n      margin: 0;\n      font-family: sans-serif;\n      overflow: initial;\n    }\n    body[contenteditable=\"plaintext-only\"] {\n      font-family: monospace;\n    }\n    body {\n      --EditorPadding: 12px;\n      --MaxWidth: 700px;\n      margin-left: var(--EditorPadding);\n      padding-left: calc(calc(50% - calc(var(--MaxWidth) / 2) - var(--EditorPadding))) !important;\n      padding-right: calc(50% - calc(var(--MaxWidth) / 2)) !important;\n      padding-top: var(--EditorPadding);\n      padding-bottom: calc(var(--EditorPadding) * 3);\n      color: var(--colorFgIntense);\n      font-size: 100%;\n      cursor: text;\n    }\n    img {\n      display: inline-block;\n      vertical-align: top;\n      max-width: 100%;\n      height: auto;\n    }\n    a:-webkit-any-link {\n      color: var(--colorHighlightBg);\n      cursor: pointer;\n    }\n  \n    html, body, iframe {\n      font-family: sans-serif;\n      font-size: 100%;\n    }\n    body {\n      overflow: overlay;\n    }\n    input[type=checkbox] {\n      appearance: none;\n      position: relative;\n      width: 16px;\n      height: 16px;\n      min-width: 16px;\n      min-height: 16px;\n      vertical-align: middle;\n      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1) inset;\n      margin: unset;\n      border-width: 1px;\n      border-style: solid;\n      border-color: rgba(0,0,0,0.2);\n      background-color: var(--colorBgIntense);\n    }\n    input[type='checkbox']:disabled {\n      opacity: 1;\n      filter: grayscale(1);\n    }\n    input[type=checkbox]:before,\n    input[type=checkbox]:after {\n      content: '';\n      position: absolute;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      background-color: var(--colorHighlightBg);\n      transform-origin: 0 0;\n    }\n    input[type=checkbox]:before {\n      transform: rotate(-45deg) translateY(45%) translateX(-30%) scaleX(0.25) scaleY(0);\n    }\n    input[type=checkbox]:checked:before {\n      transform: rotate(-45deg) translateY(45%) translateX(-30%) scaleX(0.25) scaleY(0.4);\n    }\n    input[type=checkbox]:after {\n      transform: rotate(225deg) translateY(-30%) translateX(-95%) scaleX(0.25) scaleY(0);\n    }\n    input[type=checkbox]:checked:after {\n      transform: rotate(225deg) translateY(-30%) translateX(-95%) scaleX(0.25) scaleY(1.2);\n    }\n    \n    .tooltip {\n      --TipWidth: 480px;\n      position: relative;\n    }\n    .tooltip .tooltip-text * {\n      user-select: none;\n    }\n    .tooltip-text input {\n      margin-left: 3px;\n      border: 1px solid var(--colorBorder);\n      border-radius: 2px;\n      font-size: small;\n      opacity: 0.8;\n      color: var(--colorFg);\n      background-color: var(--colorBg);\n    }\n    .tooltip-text input:active {\n      background-color: var(--colorBgDark);\n    }\n    .tooltip-text input:first-of-type {\n      margin-left: 12px;\n    }\n    .tooltip-text a {\n      white-space: nowrap;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      color: var(--colorFg);\n    }\n    .tooltip .tooltip-text {\n      cursor: default;\n      position: absolute;\n      z-index: 1;\n      display: flex;\n      top: 100%;\n      left: -6px;\n      max-width: var(--TipWidth);\n      padding: 6px 6px 6px 12px;\n      color:var(--colorFg);\n      background-color: var(--colorBg);\n      border: 1px solid var(--colorBgDark);\n      box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.1), 0 3px 10px rgba(0, 0, 0, 0.3);\n      border-radius: 3px;\n    }\n  \n  ".replace(/\n|\r/g,"")+"</style>`;"})};debouncedUpdateState=(0,Zr.Z)((()=>{this.props.updateButtonState?.(),this.props.updateDropdownState?.()}),100);handleConsoleMessage=e=>{const[t,n]=e.message.split(" ",2);switch(t){case"caretState":this.onCaretStateEvent(n);break;case"selectionchange":this.debouncedUpdateState();break;case"input":this.debouncedUpdateState(),this.props.onChange(e);break;case"createLink":this.props.handleLinkEvent(t,n);break;default:throw new Error(e.message)}};setZoomLevel=e=>{const t=this.refWebview.current;t&&(t.setZoomMode("per-view"),t.setZoom(e))};render(){const{disabled:e,hidden:t}=this.props;return Y0("div",{className:"editor-html"},void 0,(0,fn.jsx)("webview",{className:"editor-webview",partition:"persist:markdowneditor",name:"markdowneditor",ref:this.refWebview,style:t||e?{display:"none"}:{},allowtransparency:"on",src:"components/notes/markdowneditor/markdowneditor.html"}))}}var Q0,q0,J0=n(24925);function e1(e,t,n,i){Q0||(Q0="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Q0,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function t1({disabled:e,keyAccess:t,noteId:n,text:i,onOpenDialog:s}){const o=tn.useRef(null);return e1("label",{className:mn()("button-toolbar",{disabled:e}),title:(0,le.Z)("Attach new file..."),tabIndex:t},void 0,(0,fn.jsx)("input",{ref:o,type:"file",style:{display:"none"},accept:"image/*",disabled:e,onChange:e=>Fs.Z.addImageFile(n,e.target.files[0])}),e1("button",{disabled:e,tabIndex:t,onClick:function(){s?.(),o.current?.click()}},void 0,e1("div",{style:{display:"contents"},dangerouslySetInnerHTML:{__html:cn.onv}}),e1("span",{},void 0,i)))}function n1(e,t,n,i){q0||(q0="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:q0,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function i1(e,t,n,i){const s={inCurrent:n,inBackground:i};Y.Z.openURL(e,t.content,s)}function s1(e,t,n){const i={inNewWindow:!0,incognito:n};Y.Z.openURL(e,t.content,i)}class o1 extends tn.Component{static contextType=dn.Z;onContextMenu=(e,t)=>{const n=this.context.vivaldiWindowId,i=[{items:[{handler:()=>i1(n,e,!0,!1),...(0,Mn.Z)("Current Tab")},{handler:()=>i1(n,e,!1,M.Z.get(D.kTabsOpenNewInBackground)),...(0,Mn.Z)("open in","New Tab")},{handler:()=>i1(n,e,!1,!0),visible:!M.Z.get(D.kTabsOpenNewInBackground),...(0,Mn.Z)("Background Tab")},G.Z.separatorItem,{handler:()=>s1(n,e,!1),...(0,Mn.Z)("open in","New Window")},{handler:()=>s1(n,e,!0),...(0,Mn.Z)("open in","Private Window")}],...(0,Mn.Z)("Open in")},G.Z.separatorItem,{handler:(e=>{e.checksum&&this.props.onInsertMarkdown?.(e.checksum)}).bind(null,e),...(0,Mn.Z)("Insert Markdown"),visible:!!this.props.onInsertMarkdown},{handler:this.props.onRemoveAttachment.bind(null,e),...(0,Mn.Z)("verb","Remove")}];(0,zi.Z)(n,i)(t)};onDragStart=(e,t)=>{if(!t.checksum||!this.props.noteId)return;const n=`${this.props.noteId}/${t.checksum}`;"html"===this.props.dragFormat?e.dataTransfer.setData("text/html",`<img src="chrome://vivaldi-data/notes-attachment/${n}" />`):e.dataTransfer.setData("text/plain",`attachment:${n}`)};render(){const{attachments:e}=this.props;return n1("div",{className:"NotesAttachments"},void 0,e.map(((e,t)=>n1(rI,{item:e,onContextMenu:this.onContextMenu.bind(null,e),onOpen:t=>function(e,t,n){const i=(0,ls.Z)(e,{ctrlKey:n.ctrlKey,altKey:n.altKey,shiftKey:n.shiftKey,metaKey:n.metaKey});Y.Z.openURL(e,t.content,{...i})}(this.context.vivaldiWindowId,e,t),onDelete:this.props.onRemoveAttachment.bind(null,e),onDragStart:this.onDragStart,draggable:!!this.props.onInsertMarkdown},e.checksum))))}}const a1=o1;var r1,l1;function d1(e,t,n,i){r1||(r1="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:r1,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function c1({noteId:e,attachments:t,onRemoveAttachment:n,onInsertMarkdown:i,dragFormat:s}){return d1("div",{className:"NotesAttachmentPopup"},void 0,d1(a1,{noteId:e,attachments:t,onRemoveAttachment:n,onInsertMarkdown:i,dragFormat:s}),d1(t1,{noteId:e,disabled:!1,keyAccess:-1,text:(0,le.Z)("Add attachment")}))}function h1(e,t,n,i){l1||(l1="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:l1,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const p1=[[{command:"bold",text:(0,le.Z)("Bold"),icon:cn.q7H},{command:"italic",text:(0,le.Z)("Italic"),icon:cn.znb},{command:"strikeThrough",text:(0,le.Z)("Strike through"),icon:cn._QD}],[{command:"insertOrderedList",text:(0,le.Z)("Numbered list"),icon:cn.o_D},{command:"insertUnorderedList",text:(0,le.Z)("Bullet list"),icon:cn.rr$},{command:"outdent",text:(0,le.Z)("Remove indentation"),icon:cn.XKb},{command:"indent",text:(0,le.Z)("Indent"),icon:cn.b2r}],[{command:"createLink",text:(0,le.Z)("Create Link"),icon:cn.v2I}],[{command:"undo",text:(0,le.Z)("win_linux","Undo"),icon:cn.LwO},{command:"redo",text:(0,le.Z)("win_linux","Redo"),icon:cn.W9w}]];class u1 extends tn.Component{static contextType=dn.Z;state={anchor:"",buttonState:[],createLinkModalOpen:!1,formatBlock:"p",link:"",isAttachmentPopupOpen:!1};updateButtonState=(e,t)=>{this.setState((n=>({buttonState:e||n.buttonState,formatBlock:t||n.formatBlock})))};updateLinkState=e=>{this.setState((t=>{if(t.anchor!==e)return{anchor:e}}))};onCreateLink=e=>{this.setState({createLinkModalOpen:!1}),this.props.onCreateLink(e)};onCancelCreateLink=()=>{this.setState({createLinkModalOpen:!1}),this.props.onCancelCreateLink()};showCreateLinkModal=()=>this.setState({createLinkModalOpen:!0});cacheFocus=()=>{const{document:e}=this.context;e.activeElement?this._focusCache=e.activeElement:this._focusCache=void 0};restoreFocus=()=>{this._focusCache&&this._focusCache.focus()};render(){const{noteId:e}=this.props;let t=0;return h1("div",{className:"NotesManager-Toolbar"},void 0,this.state.createLinkModalOpen&&h1(Ik,{onCreateLink:this.onCreateLink,onCancelCreateLink:this.onCancelCreateLink,link:this.state.link||this.state.anchor}),h1("div",{className:"toolbar toolbar-default NotesManager-Buttons"},void 0,h1(sl,{tooltip:this.props.inFullView?(0,le.Z)("Enter Full View"):(0,le.Z)("Exit Full View"),onClick:this.props.toggleFullEditor,image:this.props.inFullView?cn.ADs.medium:cn.BB1.medium}),h1("select",{onChange:e=>{this.props.onParagraphFormatChange("formatBlock",e),this.restoreFocus()},onMouseDown:this.cacheFocus,value:this.state.formatBlock,title:(0,le.Z)("Paragraph Format"),tabIndex:"-1",disabled:this.props.disabled},void 0,h1("option",{value:"h1"},void 0,(0,le.Z)("Heading 1")),h1("option",{value:"h2"},void 0,(0,le.Z)("Heading 2")),h1("option",{value:"h3"},void 0,(0,le.Z)("Heading 3")),h1("option",{value:"h4"},void 0,(0,le.Z)("Heading 4")),h1("option",{value:"p"},void 0,(0,le.Z)("Paragraph")),h1("option",{value:"pre"},void 0,(0,le.Z)("Preformatted"))),p1.map(((e,n)=>{const i=e.map(((e,n)=>h1(sl,{tooltip:e.text,image:e.icon,onClick:()=>this.props.onStylingButtonClicked(e.command),tabIndex:-1,disabled:this.props.disabled,isPressed:!0===this.state.buttonState[t+n]},e.command)));return t+=i.length,h1("div",{className:"toolbar-group"},n,i)})),h1(sl,{style:{marginLeft:"auto"},title:(0,le.Z)("$1 Attachment","$1 Attachments",[this.props.attachments.length]),onClick:()=>this.setState((e=>({isAttachmentPopupOpen:!e.isAttachmentPopupOpen}))),isPopupVisible:this.state.isAttachmentPopupOpen,hidePopup:()=>this.setState({isAttachmentPopupOpen:!1}),popupClassName:"ToolbarButtonPopup-DefaultStyles",popupWidth:222,popupPosition:"below",image:cn.onv,disabled:this.props.disabled},void 0,e&&h1(c1,{attachments:this.props.attachments,noteId:e,onRemoveAttachment:t=>{Fs.Z.removeAttachment(e,t)},onInsertMarkdown:this.props.handleAttachmentMarkdown,dragFormat:this.props.visualMode?"html":"url"})),h1("div",{className:"toolbar-group"},void 0,h1(sl,{title:(0,le.Z)("Text"),onClick:()=>this.props.setVisualMode(!1),isPressed:!this.props.visualMode,disabled:this.props.disabled}),h1(sl,{title:(0,le.Z)("Visual"),onClick:()=>this.props.setVisualMode(!0),isPressed:this.props.visualMode,disabled:this.props.disabled}))),h1(OS,{isActive:this.props.isActive,pageId:this.props.pageId,onFindInPage:(e,t)=>Vg.Z.findInPage(this.context.vivaldiWindowId,this.props.pageId,e,t),onFindNextInPage:(e,t,n)=>Vg.Z.findNextInPage(this.context.vivaldiWindowId,this.props.pageId,e,t,n)}))}}function g1(e,t){if(e.title)return e.title;if(!e.content)return t||"";return e.content.split("\n")[0].trim().replace(/ {2,}/g," ").replace(/^#+ /g,"").substr(0,128).trim()}function m1({content:e}){return e?e.replace(/\n+/g,"").length:0}function v1({content:e}){return e?e.trim().split(/\s+/g).length:0}var f1,y1=n(5846),w1=n(34155);function b1(e,t,n,i){f1||(f1="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:f1,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class C1 extends tn.Component{static contextType=dn.Z;refMarkdownEditor=tn.createRef();refVisualEditor=tn.createRef();refToolbar=tn.createRef();markdownFormatter=new K0;turndownService=(0,J0.Z)({headingStyle:"atx",codeBlockStyle:"fenced"});state={visualMode:!M.Z.get(D.kNotesManagerShowMarkdown)};componentDidMount(){this.turndownService.use(MJ.r0),this.turndownService.addRule("strikethrough",{filter:["del","s","strike"],replacement:e=>"~~"+e+"~~"}),this.turndownService.addRule("listItem",{filter:"li",replacement:function(e,t,n){e=e.replace(/^\n+/,"").replace(/\n+$/,"\n").replace(/\n/gm,"\n    ");let i=n.bulletListMarker+" ",s=t.parentNode;if("OL"===s.nodeName){const e=s.getAttribute("start"),n=Array.prototype.indexOf.call(s.children,t);i=(e?Number(e)+n:n+1)+". "}let o=-1;for(;s&&("OL"===s.nodeName||"UL"===s.nodeName);)o+=1,s=s.parentNode;return"    ".repeat(o)+i+e+(t.nextSibling&&!/\n$/.test(e)?"\n":"")}}),this.refVisualEditor.current&&this.refVisualEditor.current.focus()}componentDidUpdate(e){e.noteId!==this.props.noteId&&(this.onRichContentLoad(),this.onMarkdownContentLoad())}focus=()=>{this.state.visualMode?this.refVisualEditor.current?.focus():this.refMarkdownEditor.current&&this.refMarkdownEditor.current.focus()};hasFocus=()=>this.state.visualMode&&this.refVisualEditor.current?this.refVisualEditor.current.hasFocus():!!this.refMarkdownEditor.current&&this.refMarkdownEditor.current.hasFocus();handleAttachmentMarkdown=async e=>{this.refVisualEditor.current&&this.props.note&&this.refVisualEditor.current.execCommand("insertImage",`chrome://vivaldi-data/notes-attachment/${this.props.note.id}/${e}`)};onHtmlChange=()=>{if(!this.refVisualEditor.current)throw new Error("VisualEditor: Building body parts after body is gone");return this.refVisualEditor.current.getContentAsBodyParts().then((e=>{if("html"===e[0].type){const t=this.turndownService.turndown(e[0].content);this.props.updateNoteContent(t,(()=>{this.refMarkdownEditor&&this.refMarkdownEditor.current&&this.refMarkdownEditor.current.setContent(t)}))}}))};onMarkDownChange=async()=>{if(!this.refMarkdownEditor.current)throw new Error("MarkdownEditor: Building body parts after body is gone");const e=await this.refMarkdownEditor.current.getContentAsBodyParts();if("text"!==e[0].type)return;const t=e[0].content;this.props.updateNoteContent(t,(()=>{}))};setZoomLevel=()=>{const e=$v.Z.getState().notesZoom;this.refVisualEditor.current?.setZoomLevel(e),this.refMarkdownEditor.current?.setZoomLevel(e)};onRichContentLoad=()=>{const{note:e}=this.props,t=this.markdownFormatter.getRawMarkup(e?.content||"");w1.nextTick((()=>{this.refVisualEditor.current?.setContent([{content:t,isPlainText:!1}]),this.setZoomLevel()}))};onMarkdownContentLoad=()=>{const{note:e}=this.props;w1.nextTick((()=>{this.refMarkdownEditor.current?.setContent(e?.content||""),this.setZoomLevel()}))};onStylingButtonClicked=e=>{this.state.visualMode?this.refVisualEditor.current?.onClick(e):this.refMarkdownEditor.current?.onClick(e)};onParagraphFormatChange=(e,t)=>{this.state.visualMode?this.refVisualEditor.current?.onChange(e,t):this.refMarkdownEditor.current?.onChange(e,t)};onCreateLink=e=>{const t=this.state.visualMode?this.refVisualEditor.current:this.refMarkdownEditor.current;t&&(""===e?t.execCommand("unlink"):"https://"!==e&&t.execCommand("createLink",e),t.focus())};onCancelCreateLink=()=>{this.focus()};handleLinkEvent=(e,t)=>{const n=this.refToolbar.current;if(!n)return;const{link:i,anchor:s}=n.state;switch(e){case"linkupdate":n.updateLinkState(t||"");break;case"createLink":case"editLink":n.showCreateLinkModal();break;case"copyLink":break;case"unlink":(i||s)&&this.refVisualEditor.current?.unlink();break;case"createLinkClicked":(i||s)&&this.refVisualEditor.current?.selectSurrounding(),n.showCreateLinkModal()}};setActiveWebView=()=>{this.clearActiveWebViews();const e=this.refVisualEditor.current?.refWebview.current,t=this.refMarkdownEditor.current?.refWebview.current,n=this.context.vivaldiWindowId;this.state.visualMode&&e?rS.setActiveWebView(n,e):this.refMarkdownEditor&&t&&rS.setActiveWebView(n,t)};clearActiveWebViews=()=>{const e=this.refVisualEditor.current?.refWebview.current,t=this.refMarkdownEditor.current?.refWebview.current,n=this.context.vivaldiWindowId;e&&rS.clearIfActive(n,e),t&&rS.clearIfActive(n,t)};setVisualMode=e=>this.setState({visualMode:e},(()=>{this.setActiveWebView(),this.onRichContentLoad(),nt.Z.set(D.kNotesManagerShowMarkdown,!this.state.visualMode)}));updateDropdownAndColorState=()=>{this.refVisualEditor.current?.executeScript({code:"['formatBlock'].map(command => document.queryCommandValue(command));"}).then((e=>{if(Array.isArray(e)&&1===e.length&&Array.isArray(e[0])){const[t]=e[0],n=""===t||"div"===t?"p":t;this.refToolbar.current?.updateButtonState(void 0,n)}}))};updateButtonState=()=>{const e=this.refToolbar.current;if(e)if(this.state.visualMode){const t=`[${'"'+p1.flat().map((e=>e.command)).join('","')+'"'}].map(command => document.queryCommandState(command));`;this.refVisualEditor.current?.executeScript({code:t}).then((t=>{const n=p1.flat().map((e=>e.command)).indexOf("createLink"),i=t&&t[0]||[];i[n]=!!e.state.anchor,e.updateButtonState(i)}))}else{const t=this.refMarkdownEditor.current;if(!t)return;const n=p1.flat().map((e=>e.command)).map((e=>t.state.caretState[e])).filter(y1.Z),{formatBlock:i}=t.state.caretState;e.updateButtonState(n,i)}};render(){const{note:e}=this.props,t=e?.attachments?e.attachments:[];return(0,fn.jsxs)(fn.Fragment,{children:[(0,fn.jsx)(u1,{ref:this.refToolbar,isActive:this.props.isActive,noteId:e?e.id:void 0,pageId:this.props.pageId,attachments:t,disabled:!e||this.props.isFolder,inFullView:this.props.inFullView,visualMode:this.state.visualMode,handleAttachmentMarkdown:this.handleAttachmentMarkdown,onCreateLink:this.onCreateLink,onCancelCreateLink:this.onCancelCreateLink,onParagraphFormatChange:this.onParagraphFormatChange,onStylingButtonClicked:this.onStylingButtonClicked,setVisualMode:this.setVisualMode,toggleFullEditor:this.props.toggleFullEditor}),b1("div",{className:"NotesManager-Editor"},void 0,b1("div",{className:"editor-html"},void 0,(0,fn.jsx)(Mk,{ref:this.refVisualEditor,onChange:this.onHtmlChange,onContentLoad:this.onRichContentLoad,focusPreviousElement:()=>{},isNote:!0,hidden:!this.state.visualMode,disabled:!e||this.props.isFolder,updateDropdownAndColorState:this.updateDropdownAndColorState,updateButtonState:this.updateButtonState,handleLinkEvent:this.handleLinkEvent})),(0,fn.jsx)(X0,{ref:this.refMarkdownEditor,onChange:this.onMarkDownChange,onContentLoad:this.onMarkdownContentLoad,hidden:this.state.visualMode,disabled:this.state.visualMode||!e||this.props.isFolder,updateDropdownState:this.updateDropdownAndColorState,updateButtonState:this.updateButtonState,handleLinkEvent:this.handleLinkEvent})),e&&b1("footer",{className:"NotesManager-Footer"},void 0,b1("div",{className:"NotesManager-WordCount"},void 0,(0,le.Z)("$1 word","$1 words",[v1(e)])+", "+(0,le.Z)("$1 character","$1 characters",[m1(e)])))]})}}var S1,T1=n(34155);function I1(e,t,n,i){S1||(S1="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:S1,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function k1(e,t){Y.Z.openURL(e,St.jk.internalUrl("notes",t.id),{singleton:!0})}class A1 extends tn.PureComponent{refTreeList=tn.createRef();static contextType=dn.Z;winId=this.context.vivaldiWindowId;state={nodes:[],populated:!1,cutIds:[],showBadge:M.Z.get(D.kPanelsShowFolderBadge)};expandModel={};componentDidMount(){M.Z.addListener(D.kPanelsShowFolderBadge,this._onBadgeChanged),NJ.ZP.addListener(this._onStoreChange),this.onFilterChange(this.props.filter)}componentWillUnmount(){M.Z.removeListener(D.kPanelsShowFolderBadge,this._onBadgeChanged),NJ.ZP.removeListener(this._onStoreChange)}componentDidUpdate(e){if(this.props.filter!==e.filter){const t=this.props.filter.length,n=e.filter.length;0===n&&t>0&&this.refTreeList.current&&(this.expandModel=this.refTreeList.current.getExpandModel()),this.onFilterChange(this.props.filter,(e=>{t>0?T1.nextTick((()=>{this.refTreeList.current?.expandAllExcept(e)})):n>0&&0===t&&T1.nextTick((()=>{this.refTreeList.current?.expandWithModel(this.expandModel)}))}))}}isEmpty=()=>this.state.populated&&0===this.state.nodes.length;isInManager=()=>Boolean(this.props.columns);deleteSelectedItems=()=>this.refTreeList.current?.onDelete()||Promise.reject();delete=(e=[])=>Promise.all(e.map((e=>"string"!=typeof e?Promise.resolve():new Promise((t=>{d.Z.notes.get(e,(n=>{n&&n.length>0&&!this.isTrashCan(n[0])?d.Z.notes.remove(e,t):t()}))})))));isFolder=e=>NJ.ZP.isFolder(e);isTrashCan=e=>Boolean(e.trash);isEditable=()=>!1;getUrlsByNodes=e=>e.map((e=>NJ.ZP.getNodeById(e.id))).filter((e=>!!e&&!!e.url)).map((e=>(0,Ni.Fn)(e.url)));onItemMouseDown=(e,t)=>{t.button===vn.Z.kCenter&&(0,Cs.Z)(t)};onItemMouseUp=(e,t)=>{if(t.button===vn.Z.kCenter){const n=this.getUrlsByNodes([e]),i=this.context.vivaldiWindowId;n.length>0?Y.Z.openUrls(i,n,{...(0,ls.Z)(i,{button:t.button,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,metaKey:t.metaKey})}):k1(this.context.vivaldiWindowId,e),(0,Cs.Z)(t)}};onItemDoubleClick=(e,t)=>{const n=this.getUrlsByNodes([t]),i=this.context.vivaldiWindowId;n.length>0?Y.Z.openUrls(i,n,{...(0,ls.Z)(i,{button:e.button,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey})}):k1(i,t)};onNodesActivated=(e,t)=>{const n=this.getUrlsByNodes(t),i=this.context.vivaldiWindowId;Y.Z.openUrls(i,n,{...(0,ls.Z)(i,{ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey})})};onFilterChange=(e,t=Tl.default)=>{let n=[],i=[];if(NJ.ZP.hasNotes())if(e.length>0){let t=e.toLowerCase();const s={};if(t.startsWith("url:")?(t=t.substring(4),s.url=t.length>0,s.content=!1):t.startsWith("content:")&&(t=t.substring(8),s.url=!1,s.content=t.length>0),"."===t&&(s.url=!1),"tree"===this.refTreeList.current?.getSearchStyle()){const e=NJ.ZP.getFilteredTree(t,s);n=e.nodes,i=e.collapsed}else n=NJ.ZP.getFilteredFlat(t,s)}else n=NJ.ZP.getRootNode().children;this.setState((e=>({nodes:n,populated:!0,cutIds:NJ.ZP.getCutIds()})),(()=>t(i)))};_onStoreChange=()=>{this.onFilterChange(this.props.filter)};_onBadgeChanged=(e,t)=>{this.setState({showBadge:Boolean(t)})};hasChildren=e=>!!e.children&&e.children.length>0;handleExpandClick=e=>{this.refTreeList.current?.toggleSelectedExpansion(e)};unSelectAll=()=>{this.refTreeList.current?.unSelectAll()};getSelectedItem=()=>this.refTreeList.current?.getSelectedItem();expandAll=()=>{this.refTreeList.current?.expandAll()};collapseAll=()=>{this.refTreeList.current?.collapseAll()};setSearchStyle=e=>{this.refTreeList.current?.setSearchStyle(e)};onSearchStyleChanged=e=>{this.props.filter&&this.onFilterChange(this.props.filter,(t=>{"tree"===e&&T1.nextTick((()=>{this.refTreeList.current?.expandAllExcept(t)}))}))};isValidForClipboard=e=>!this.isTrashCan(e);isValidDragSource=e=>!this.isTrashCan(e);isValidAddTarget=e=>!this.isTrashed(e);isTrashed=e=>!!e&&(!!this.isTrashCan(e)||!!e.parentId&&this.isTrashed(this.refTreeList.current?.findTreeItem(e.parentId)));onAddFolder=()=>{const e={title:(0,le.Z)("title","New Folder")};this.refTreeList.current?.onAdd(!0,e)};onAddNote=e=>this.refTreeList.current?.onAdd(!1,e);selectById=e=>{this.refTreeList.current?.selectById(e)};onDrop=(e,t,n)=>{const i=e.dataTransfer.getData("text/plain");if(i.length>0){const e=this.getTargetSpec(t,n),s={content:i};return this.onCreate([s],e.parentId,e.index,!0)}return Promise.resolve()};getTargetSpec=(e,t)=>{const n={id:e.id,index:0,parentId:void 0};if(this.isTrashCan(e)&&"on"!==t){const e=NJ.ZP.getLastTopNode();e?(n.parentId=e.parentId,n.index=(e.index||0)+1):n.parentId=NJ.ZP.getRootNode().id}else this.isFolder(e)&&"on"===t||e.isExpanded&&"below"===t?n.parentId=e.id:(n.parentId=e.parentId,n.index=(e.index||0)+("below"===t?1:0));return n};onCreate=async(e,t,n,i)=>{const s=t||"";await Fs.Z.createNotesFromTreeNodes(e,s,n,i),await this.props.onCreated()};onMove=(e,t="",n)=>(e=NJ.ZP.validateForDrag(e),Promise.all(e.map((e=>new Promise((i=>{const s={parentId:t,index:"number"==typeof n?n:0},o=NJ.ZP.getNodeById(e);if(d.Z.notes.move(e,s,(()=>{i(e)})),!n)return;const a=o?.index;o&&a&&(o.parentId!==t||a>n)&&n++}))))));getText=()=>new Promise((e=>{const t=W.Z.getActivePage(this.context.vivaldiWindowId);t?d.Z.utilities.getSelectedText(t.id,e):e("")}));getMenuCapability=async(e,t,n)=>{const i=this.context.vivaldiWindowId,s={inManager:this.isInManager()};switch(e.action){case"CONTEXT_OPEN_ADDRESS":{const o=n?.url;return{handler:()=>!!o&&Y.Z.openUrls(i,[o],{inNewWindow:!1,inCurrent:!1,inBackground:M.Z.get(D.kTabsOpenNewInBackground)}),visible:!!o,...t(i,e,s)}}case"CONTEXT_CONTAINER_OPEN_IN_WINDOW":{const s=n?.url,o=await Hi.getMenu(i,!0,[s||""]);return{visible:!!s&&o.length>0,items:o,...t(i,e,{})}}case"CONTEXT_NEW_FROM_SELECTION":return this.getText().then((n=>{const o=W.Z.getActivePage(i),a=o?.url??"";return{visible:!!n&&!!o,handler:()=>{this.refTreeList.current?.onAdd(!1,{content:n,url:a})},...t(i,e,s)}}));case"CONTEXT_EDIT":return{handler:()=>k1(this.context.vivaldiWindowId,n),visible:Boolean(n)&&!this.isTrashCan(n),...t(i,e,s)};case"CONTEXT_EMPTY_TRASH":return{handler:()=>{Fs.Z.emptyTrash()},visible:Boolean(n)&&this.isTrashCan(n),...t(i,e,s)};default:return{...t(i,e,s)}}};getMenuVisibility=(e,t)=>{if(t)if(this.isTrashCan(t))switch(e.action){case"CONTEXT_EXPAND_ALL":case"CONTEXT_COLLAPSE_ALL":case"CONTEXT_CONTAINER_SEARCH":return!0;default:return!1}else{const n=this.isTrashCan(t)||NJ.ZP.isSeparator(t);switch(e.action){case"CONTEXT_NEW_ITEM":case"CONTEXT_NEW_FOLDER":case"CONTEXT_CUT":case"CONTEXT_COPY":case"CONTEXT_PASTE":case"CONTEXT_DELETE":return!this.isTrashCan(t);case"CONTEXT_NEW_SEPARATOR":return!this.isTrashCan(t)&&this.props.sorting.sortOrder===ns.Z.NO_SORTING;case"CONTEXT_RENAME":return!n;case"CONTEXT_EXPAND_ALL":case"CONTEXT_COLLAPSE_ALL":case"CONTEXT_CONTAINER_SEARCH":return!0;default:return!1}}else switch(e.action){case"CONTEXT_NEW_ITEM":case"CONTEXT_NEW_FOLDER":case"CONTEXT_PASTE":case"CONTEXT_EXPAND_ALL":case"CONTEXT_COLLAPSE_ALL":case"CONTEXT_CONTAINER_SEARCH":return!0;case"CONTEXT_NEW_SEPARATOR":return this.props.sorting.sortOrder===ns.Z.NO_SORTING;default:return!1}};onContextMenu=e=>{this.refTreeList.current?.onContextMenu(e)};getDropSupport=(e,t)=>{const n={available:!1,onto:!1,edge:!0};return n.available=t.dataTransfer.types.some((e=>"text/uri-list"===e||"text/plain"===e||e===NJ.d0)),n.available&&(n.onto=this.isFolder(e)),n};saveTitle=(e,t)=>{d.Z.notes.update(e,{title:t})};renderTitleRow=e=>{const t=e.node,n=(t.level+1)*$u+"px",i=t.level*$u+"px",s=this.isFolder(t);return I1("label",{},t.id,s&&this.hasChildren(t)&&I1("span",{className:"expand-icon",style:{marginLeft:i},onMouseDown:Cs.Z,onMouseUp:()=>this.handleExpandClick(t.id),dangerouslySetInnerHTML:{__html:cn.nfH}}),s&&I1(Wi,{trash:this.isTrashCan(t),open:t.isExpanded,leftMargin:this.hasChildren(t)?0:n}),!s&&!t.url&&I1("span",{style:{marginLeft:n},className:"tree-icon",dangerouslySetInnerHTML:{__html:cn.zKr}}),!s&&!!t.url&&I1("span",{style:{marginLeft:n},className:"tree-icon",dangerouslySetInnerHTML:{__html:cn.NwZ}}),void 0!==e.inlineEditText&&I1("input",{type:"text",value:e.inlineEditText,onChange:e.onChange,onFocus:e.onFocus,onBlur:e.onBlur,autoFocus:!0}),void 0===e.inlineEditText&&I1("span",{className:"title",title:g1(t)},void 0,g1(t)),e.showBadge&&!this.props.fullView&&this.hasChildren(t)&&I1("span",{className:"item-count"},void 0,t.children?.length))};getRowComponentProps=e=>({...e,childCount:e.node.children?e.node.children.length:0,columns:this.props.columns,showBadge:this.state.showBadge});rowComponent=e=>{const t=e.node,n=NJ.ZP.isSeparator(t),i=this.isFolder(t),s=(t.level+1)*$u+"px",{columns:o}=e,a=[];return n?a.push(I1("label",{"data-parent":t.parentId},`${t.id}__separator__${a.length}`,I1("hr",{style:{marginLeft:s},className:"separator"}))):this.props.fullView?(o||[]).map((n=>{switch(n.id){case"title":a.push(this.renderTitleRow(e));break;case"url":a.push(I1("label",{},n.id,I1("span",{},void 0,t.url)));break;case"content":a.push(I1("label",{},n.id,!i&&I1("span",{},void 0,t.content),i&&t.children&&t.children.length>0&&I1("span",{className:"secondary"},void 0,(0,le.Z)("$1 item","$1 items",[t.children.length]))));break;case"attachments":a.push(I1("label",{className:"right-aligned"},n.id,I1("span",{},void 0,t.attachments&&t.attachments.length>0?t.attachments.length:"")));break;case"dateAdded":a.push(I1("label",{className:"right-aligned"},n.id,!i&&I1("span",{},void 0,b()(t.dateAdded).format("ll"))))}})):a.push(this.renderTitleRow(e)),a};menu={name:"noteslist",getCapability:this.getMenuCapability,getVisibility:this.getMenuVisibility};render(){if(!this.state.populated&&!this.props.filter)return null;const e=NJ.ZP.getRootNode().id;return(0,fn.jsx)(Yu,{ref:this.refTreeList,rowComponent:this.rowComponent,getRowComponentProps:this.getRowComponentProps,nodes:this.state.nodes,cutIds:this.state.cutIds,settings:this.props.settings,rootId:e,onSelect:this.props.onItemSelected,onItemDoubleClick:this.onItemDoubleClick,onItemMouseDown:this.onItemMouseDown,onItemMouseUp:this.onItemMouseUp,onItemsActivated:this.onNodesActivated,onCreate:this.onCreate,onSearchStyleChanged:this.onSearchStyleChanged,delete:this.delete,onMove:this.onMove,onDrop:this.onDrop,onCut:Fs.Z.cut,onCopy:Fs.Z.copy,supportsInlineEdit:!0,mimeType:NJ.d0,getDropSupport:this.getDropSupport,getDragData:NJ.ZP.getDragData.bind(NJ.ZP),isFolder:this.isFolder,isSeparator:NJ.ZP.isSeparator,hasChildren:this.hasChildren,menu:this.menu,setCutIds:Fs.Z.setCutIds,getTitle:NJ.ZP.getTitle,saveTitle:this.saveTitle,getTargetSpec:this.getTargetSpec,isValidAddTarget:this.isValidAddTarget,isValidDragSource:this.isValidDragSource,isValidForClipboard:this.isValidForClipboard,isValidToEdit:NJ.ZP.validateForEdit,validateForDrag:NJ.ZP.validateForDrag,validateForDeletion:NJ.ZP.validateForDeletion,sorting:this.props.sorting,columns:this.props.columns})}}const Z1=A1;var E1,_1;function N1(e,t,n,i){E1||(E1="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:E1,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function M1({onAddNote:e}){return N1("div",{className:"notes-welcome"},void 0,N1("div",{className:"happy-note",onClick:e},void 0,N1("span",{dangerouslySetInnerHTML:{__html:cn.SXC}}),N1("h1",{},void 0,(0,le.Z)("Write Your First Note")),N1("p",{},void 0,(0,le.Z)("Add a new note to begin, or select text on any webpage and create a note from contextual menu."))))}function P1(e,t,n,i){_1||(_1="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:_1,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class D1 extends tn.PureComponent{refSearch=tn.createRef();focusSearch(){this.refSearch.current&&this.refSearch.current.focus()}render(){const{editorLayout:e,filter:t,onFilterValueChange:n,onAddNote:i,onDeleteSelectedItems:s,onAddFolder:o,onSetLayout:a,isDeleteDisabled:r}=this.props;return P1("div",{className:"toolbar toolbar-default toolbar-small toolbar-wrap"},void 0,(0,fn.jsx)("input",{ref:this.refSearch,type:"search",className:"notesearch",placeholder:(0,le.Z)("verb","Search"),value:t,title:(0,le.Z)("Limit the search to address or content by $1 or $2",["URL:","CONTENT:"]),onChange:({currentTarget:e})=>n(e.value)}),P1("div",{className:"toolbar",style:e?{flexGrow:1}:{}},void 0,P1("div",{className:"toolbar-group"},void 0,P1(sl,{onClick:i,tooltip:(0,le.Z)("New Note"),image:cn.md4.small}),P1(sl,{onClick:s,tooltip:(0,le.Z)("other","Delete"),image:cn.M2k.small,disabled:r})),P1("div",{className:"toolbar-group"},void 0,P1(sl,{onClick:o,image:cn._TQ.small,tooltip:(0,le.Z)("command","New Folder")})),e&&P1(sl,{style:{marginLeft:"auto"},onClick:a,image:"vertical"===e?cn.Q_G.small:cn.s2Z.small,tooltip:(0,le.Z)("command","Toggle Layout")})))}}var x1,O1=n(34155);function L1(e,t,n,i){x1||(x1="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:x1,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const R1=[{text:(0,le.Z)("Title"),value:"title",fullScreenTitle:(0,le.Z)("Sort by title"),width:300,visible:!0,key:!0},{text:(0,le.Z)("Content"),value:"content",icon:cn.sWI,fullScreenTitle:(0,le.Z)("Sort by content"),width:300,visible:!1},{text:(0,le.Z)("Address"),value:"url",icon:cn.iD7,fullScreenTitle:(0,le.Z)("Sort by address"),width:300,visible:!0},{text:(0,le.Z)("Date Created"),value:"dateAdded",icon:cn.V_c,fullScreenTitle:(0,le.Z)("Sort by creation date"),width:120,visible:!0},{text:(0,le.Z)("Attachments"),value:"attachments",icon:cn.onv,fullScreenTitle:(0,le.Z)("Sort by attachments"),width:60,visible:!0}],B1=(0,Zr.Z)(F1,NJ.mS,{trailing:!0,leading:!1});function F1({id:e,changes:t}){return new Promise(((n,i)=>{d.Z.notes.update(e,t,(()=>y.Z.runtime.lastError?i(y.Z.runtime.lastError):n()))}))}class U1 extends tn.PureComponent{static contextType=dn.Z;refBody=tn.createRef();_tree=tn.createRef();constructor(e,t){super(e),this.winId=t.vivaldiWindowId;const n=M.Z.get(D.kNotesManagerSorting),i=M.Z.get(D.kNotesManagerLayout),s="horizontal"===i?"notes":"notes_vertical";this.state={filter:"",note:void 0,markdownScrollPosition:0,editorScrollPosition:0,isAttachmentPopupOpen:!1,editorCursorPosition:0,editorLayout:i,editLinkModal:!1,treeViewSize:"vertical"===i?M.Z.get(D.kNotesManagerTreeWidth):M.Z.get(D.kNotesManagerTreeHeight),sorting:{sortOrder:n.sortOrder,sortField:n.sortField,comparator:this.sortComparator},columns:vu()[s]||fu(R1)}}componentDidMount(){W.Z.addListener(this._onPageStoreChange),NJ.ZP.addListener(this._onStoreChange),this.props.id&&"-1"!==this.props.id&&O1.nextTick((()=>{this._tree.current?.selectById(this.props.id)}))}componentDidUpdate(e,t){O1.nextTick((()=>{this.state.note&&this.state.note.id!==t.note?.id&&this._onPageStoreChange()}))}componentWillUnmount(){W.Z.removeListener(this._onPageStoreChange),NJ.ZP.removeListener(this._onStoreChange)}_onPageStoreChange=()=>{const e=W.Z.getActivePage(this.context.vivaldiWindowId);if(e&&e.id===this.props.pageId)O1.nextTick((()=>{if(this.state.note){this.state.note.id!==this.props.id&&this._tree?.current?.selectById(this.props.id);const e=g1(this.state.note);Y.Z.setTitle(this.props.pageId,this.winId,e)}this.refBody.current?.setActiveWebView()}));else{const e=this.refBody.current;e&&O1.nextTick(e.clearActiveWebViews)}};_onStoreChange=(e,t)=>{switch(e){case"added":{const e=W.Z.getActivePage(this.context.vivaldiWindowId);if(!e||e.id!==this.props.pageId||this.panelHasFocus())return;const n=NJ.ZP.getNodeById(t);return this.setState({note:n}),void(n&&!NJ.ZP.isSeparator(n)&&O1.nextTick((()=>{this._tree?.current?.selectById(n.id)})))}case"init":{const e=NJ.ZP.getNodeById(this.props.id);return this.setState({note:e}),void this._tree.current?.selectById(this.props.id)}case"changed":{if(!this.state.note||this.state.note.id!==t)return;const e=NJ.ZP.getNodeById(t),n=this.refBody.current;if(n?.state.visualMode&&n?.hasFocus())return;return this.setState({note:e}),n?.state.visualMode||n?.hasFocus()||n?.onMarkdownContentLoad(),void n?.onRichContentLoad()}}};panelHasFocus=()=>{const{document:e}=this.context,t=e.getElementById("panels-container");return"notes"===Dl.ZP.getSelectedPanel(this.winId)&&Boolean(t?.contains(e.activeElement))};sortComparator=(e,t)=>{if(e.trash)return 1;if(t.trash)return-1;if(NJ.ZP.isFolder(e)&&!NJ.ZP.isFolder(t))return-1;if(NJ.ZP.isFolder(t)&&!NJ.ZP.isFolder(e))return 1;const{sortOrder:n,sortField:i}=this.state.sorting;if("title"===i)return this.sortByTitle(e,t,n);return ns.Z.getDefaultComparator(n,i)(e,t)};sortByTitle=(e,t,n)=>{if(n<=ns.Z.NO_SORTING)return 0;const i=e.title||g1(e),s=t.title||g1(t);return i||s?i?s?n===ns.Z.ASCENDING_SORT?i.toLowerCase().localeCompare(s.toLowerCase()):s.toLowerCase().localeCompare(i.toLowerCase()):n===ns.Z.ASCENDING_SORT?-1:1:n===ns.Z.ASCENDING_SORT?1:-1:0};onSortChange=(e,t)=>{this.setState((n=>({sorting:{...n.sorting,sortOrder:e,sortField:t}}))),nt.Z.set(D.kNotesManagerSorting,{sortOrder:e,sortField:t})};onUpdateRow=e=>{this.setState({columns:e})};onSaveRow=()=>{mu(this.state.columns,"horizontal"===this.state.editorLayout?"notes":"notes_vertical")};onItemCreated=()=>{const e=this.state.note&&NJ.ZP.isFolder(this.state.note);this.refBody.current&&!e&&this.refBody.current.focus(),e&&O1.nextTick((()=>{const e=this._tree.current?.refTreeList.current;e?.startInlineEditForSelectedItem()}))};onItemSelected=e=>{this.setState({note:e,markdownScrollPosition:0,editorScrollPosition:0,isAttachmentPopupOpen:!1,editorCursorPosition:0},(()=>{e&&Y.Z.openURL(this.context.vivaldiWindowId,St.jk.internalUrl("notes",e.id),{inCurrent:!0})}))};handleFilterChange=e=>{this.setState({filter:e})};onAddNote=()=>{M.Z.get(D.kNotesManagerShowMarkdown)&&this.refBody.current&&this.refBody.current.setVisualMode(!1),this.setState({filter:""}),this._tree.current?.onAddNote()};onAddFolder=()=>{this.setState({filter:""}),this._tree.current?.onAddFolder()};onDeleteSelectedItems=()=>{this._tree.current?.deleteSelectedItems()};toggleFullEditor=()=>{const{innerWidth:e,innerHeight:t}=this.context;this.setState((n=>{const i="vertical"===n.editorLayout?D.kNotesManagerTreeWidth:D.kNotesManagerTreeHeight,s="vertical"===n.editorLayout?e:t,o=0===n.treeViewSize?Math.round(s/3):0;return nt.Z.set(i,o),{treeViewSize:o}}))};onSlidebarPosition=(e,t)=>{this.setState((n=>({treeViewSize:"vertical"===n.editorLayout?Math.max(n.treeViewSize+e,0):Math.max(n.treeViewSize+t,0)})))};onSlidebarStop=()=>{this.setState((e=>{const t="horizontal"===e.editorLayout?D.kNotesManagerTreeHeight:D.kNotesManagerTreeWidth,n=e.treeViewSize>60?e.treeViewSize:0;return nt.Z.set(t,n),{treeViewSize:n}}))};updateNoteContent=(e,t)=>{this.setState((t=>t.note?{note:{...t.note,content:e}}:null),t),this.state.note&&B1({id:this.state.note.id,changes:{content:e}})};onSaveLink=e=>{const{note:t}=this.state;t&&F1({id:t.id,changes:{url:e}}),this.setState({editLinkModal:!1})};onCancelEditLink=()=>this.setState({editLinkModal:!1});onEditLink=()=>this.setState({editLinkModal:!0});toggleManagerLayout=()=>this.setState((e=>{const t="horizontal"===e.editorLayout?"vertical":"horizontal",n="horizontal"===t?M.Z.get(D.kNotesManagerTreeHeight):M.Z.get(D.kNotesManagerTreeWidth),i="horizontal"===t?"notes":"notes_vertical";return nt.Z.set(D.kNotesManagerLayout,t),{editorLayout:t,treeViewSize:n,columns:vu()[i]||fu(R1)}}));render(){const{note:e,editorLayout:t}=this.state,n=!!e&&NJ.ZP.isFolder(e),i=e&&!n,s=!NJ.ZP.hasNotes(),o=!i&&!s;return L1("div",{className:mn()({"NotesManager manager":!0,"NotesManager--Vertical":"vertical"===t})},void 0,this.state.editLinkModal&&L1(Ik,{onCreateLink:this.onSaveLink,onCancelCreateLink:this.onCancelEditLink,link:e?e.url:"",useAddress:!0}),L1("div",{className:mn()({"NotesManager-Tree":!0,"NotesManager-Tree--Collapsed":0===this.state.treeViewSize}),style:{flexBasis:this.state.treeViewSize}},void 0,L1(D1,{filter:this.state.filter,onFilterValueChange:this.handleFilterChange,onAddNote:this.onAddNote,onAddFolder:this.onAddFolder,onDeleteSelectedItems:this.onDeleteSelectedItems,onSetLayout:this.toggleManagerLayout,editorLayout:t,isDeleteDisabled:!this.state.note}),L1("div",{className:"NotesManager-Tree-Container"},void 0,L1(Iu,{fields:R1,onSortChange:this.onSortChange,fullsize:!0,sortField:this.state.sorting.sortField,sortOrder:this.state.sorting.sortOrder,columns:this.state.columns,onUpdateRow:this.onUpdateRow,onSaveRow:this.onSaveRow,keyAccess:M.Z.get(D.kKeyboardTabToAll),manualSorting:!0},this.state.editorLayout),(0,fn.jsx)(Z1,{ref:this._tree,settings:`NOTES_MANAGER_TREE_${this.props.pageId}`,filter:this.state.filter,sorting:this.state.sorting,onItemSelected:this.onItemSelected,onCreated:this.onItemCreated,editLink:this.onEditLink,columns:this.state.columns,noteId:this.state.note?this.state.note.id:"-1",pageId:this.props.pageId,fullView:!0}))),s&&L1(M1,{onAddNote:this.onAddNote}),L1("div",{className:o?"NotesManager-EmptyPlaceholder":"NotesManager-Note",onClick:o?this.onAddNote:null},void 0,L1(gu,{onSlidebarPosition:this.onSlidebarPosition,onStop:this.onSlidebarStop,onDoubleClick:this.toggleFullEditor,returnOffset:!0,position:"vertical"===t?"right":"bottom"}),i&&(0,fn.jsx)(C1,{ref:this.refBody,inFullView:this.state.treeViewSize>0,noteId:this.state.note?.id||"-1",note:this.state.note,pageId:this.props.pageId,isFolder:n,toggleFullEditor:this.toggleFullEditor,updateNoteContent:this.updateNoteContent,isActive:this.props.isActive}),o&&(0,le.Z)("Add a new note")))}}var V1;function W1(e,t,n,i){V1||(V1="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:V1,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class H1 extends tn.Component{static contextType=dn.Z;nodeRef=tn.createRef();constructor(e){super(e),this.state={suggestions:[]}}componentDidMount(){this.updateSuggestions()}updateSuggestions(){if(!z.ZP.isIncognitoOrGuest(this.context.vivaldiWindowId)){const e=en.ZP.getSpeeddialFolders()[0].children,t=[];e.forEach((e=>{e.url?t.push(e.url):e.children.forEach((e=>{t.push(e.url)}))})),y.Z.topSites.get((e=>{const n=e.filter((e=>!t.includes(e.url)));this.setState({suggestions:n})}))}}keyDownHandler=(e,t)=>{switch(t.key){case"ArrowLeft":this.moveFocus(e,"left",!1);break;case"ArrowRight":this.moveFocus(e,"right",!1);break;case"ArrowUp":this.moveFocus(e,"up",!1);break;case"ArrowDown":this.moveFocus(e,"down",!1);break;default:return}t.preventDefault(),t.stopPropagation()};mouseBlockHandler=e=>{e.preventDefault()};moveFocus=(e,t,n)=>{const i=this.nodeRef.current;if(i instanceof HTMLElement&&(!0===n||ss(i))){const n=Array.from(i.querySelectorAll("button.dial")),s=n.map((e=>e.getAttribute("data-id"))).filter(Boolean);if(0===s.length||s.length!==n.length)return!1;let o,a=0,r=-1;switch(n.forEach((e=>{const t=e.getBoundingClientRect();r<t.left&&(a++,r=t.left)})),t){case"current":if(""===e||"first"===e?e=s[0]:"last"===e&&(e=s[0===this.props.keyAccess?s.length-1:0]),o=s.indexOf(e),-1===o)return!1;break;case"left":case"right":if(1===s.length)return!1;if(o=s.indexOf(e),-1===o)return!1;if("right"===t){if((o+1)%a==0)return!1;if(o+=1,o>=s.length)return!1}else{if(o%a==0)return!1;if(o-=1,o>=s.length)return!1}break;case"up":case"down":if(1===s.length)return!1;if(o=s.indexOf(e),-1===o)return!1;if("up"===t){if(o-=a,o<0)return!1}else if(o+=a,o>=s.length)return!1;break;default:return!1}e=s[o];const l=i.querySelector(`button.dial[data-id="${e}"]`);if(l)return l.focus(),!0}return!1};addSpeedDial(e,t){if(this.props.node){const n={parentId:this.props.node.id,title:e,url:(0,Ni.q9)(t)};this.props.onSpeedDialDrawerDone(n)}else this.props.onSpeedDialDrawerDone()}closeDrawer=()=>{this.props.onSpeedDialDrawerDone()};render(){const e=2*Math.floor((this.props.width-36)/90),t=z.ZP.isIncognito(this.context.vivaldiWindowId),{suggestions:n}=this.state;return(0,fn.jsxs)("section",{ref:this.nodeRef,className:"drawer-suggestions",children:[W1("header",{},void 0,W1("h2",{},void 0,(0,le.Z)("Suggestions")),W1("button",{className:"close",tabIndex:"-1",dangerouslySetInnerHTML:{__html:cn.kze},onClick:this.closeDrawer})),t&&W1("p",{},void 0,(0,le.Z)("Suggestions are not available in private window.")),!t&&W1("div",{className:"dials dial-suggestions",style:n.length>0?{display:"grid",gridTemplateColumns:"repeat(auto-fit, 90px)",gridTemplateRows:"repeat(2, 64px)"}:null},void 0,n.length>0?n.slice(0,e).map(((e,t)=>{const n=t.toString();return W1("button",{className:"dial",tabIndex:0===t?"0":this.props.keyAccess,"data-id":n,title:e.title+"\n"+e.url,onMouseDown:this.mouseBlockHandler,onMouseUp:this.mouseBlockHandler,onKeyDown:this.keyDownHandler.bind(this,n),onClick:this.addSpeedDial.bind(this,e.title,e.url),"data-dialurl":e.url},t,W1("div",{className:"dial-image suggest-thumbnail-image"},void 0,W1(Oi,{url:e.url,size:32,loadType:"page"})),W1("div",{className:"dial-title"},void 0,e.title))})):W1("p",{},void 0,(0,le.Z)("No history to choose from yet.")))]})}}const z1=H1;var G1;function $1(e,t,n,i){G1||(G1="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:G1,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const K1="speed_Dial_Drawer";function j1(e){const t=e.trim();return!!(0,Ni.K2)((0,Ni.q9)(t))||!(0,Ni.Zj)(t)}class Y1 extends tn.Component{refUrlField=tn.createRef();constructor(e){super(e),this.state={addSpeedDialTitle:"",editUrl:"",autocompleteValue:"",isSpeedDialURLValid:!1}}componentDidMount(){$C.Z.addListener(this._onUrlbarStoreChanged)}componentWillUnmount(){$C.Z.removeListener(this._onUrlbarStoreChanged)}_onUrlbarStoreChanged=()=>{const{isActive:e,isOmniDropdownOpen:t,selectionEnd:n,selectionStart:i,...s}=$C.Z.getUrlfieldStateFromId(K1);this.setState(s)};addSpeedDialFolder=()=>{if(this.props.node){const e={parentId:this.props.node.id,title:(0,le.Z)("title","New Folder")};this.props.onSpeedDialDrawerDone(e)}};drawerSubmitHandler=e=>{e.stopPropagation(),e.preventDefault();let t=(this.state.autocompleteValue||this.state.editUrl||"").trim();if(0===t.length)return;t=(0,Ni.q9)(t);const n=t;this.addSpeedDial(n,t)};addSpeedDial(e,t){if(this.props.node&&this.props.node.id){const n={parentId:this.props.node.id,title:e,url:(0,Ni.q9)(t),thumbnail:void 0};Of.Z.clearUrlfieldState(K1),this.props.onSpeedDialDrawerDone(n)}}onUrlFieldChanged=()=>{const e=this.state.autocompleteValue||this.state.editUrl||"";this.setState({isSpeedDialURLValid:j1(e)})};focusUrlField=()=>{this.refUrlField.current?.focus()};render(){return $1(vs.Z,{focusName:"focus-startpage-drawer",forceTrap:!0,style:{display:"contents"}},void 0,$1("aside",{className:"startpage-drawer"},"drawer",$1("section",{className:"drawer-adddial",style:{width:400}},void 0,$1("header",{},void 0,$1("h2",{},void 0,(0,le.Z)("Add Bookmark to Speed Dial"))),$1("form",{className:"drawer-addform",onSubmit:this.drawerSubmitHandler},void 0,(0,fn.jsx)(oS,{ref:this.refUrlField,pageId:K1,autoFocus:!0,autocompletionEnabled:!0,className:"address",displayUrl:"",editUrl:this.state.editUrl||"",onChange:this.onUrlFieldChanged,handleDrop:!0,title:(0,le.Z)("Enter page address"),placeholder:"https://vivaldi.com"}),$1("input",{className:"add-dial-submit primary",type:"submit",disabled:!this.state.isSpeedDialURLValid,value:(0,le.Z)("Add")})),$1("div",{className:"toolbar toolbar-default"},void 0,$1(sl,{tabIndex:0,onClick:this.addSpeedDialFolder,image:cn._TQ.medium,title:(0,le.Z)("command","New Folder")}))),$1(z1,{width:this.props.maxWidth-400,onSpeedDialDrawerDone:this.props.onSpeedDialDrawerDone,onHandoverFocus:this.focusUrlField,keyAccess:this.props.keyAccess,node:this.props.node})))}}const X1=Y1;var Q1,q1=n(34844),J1=n(34155);function e2(e,t,n,i){Q1||(Q1="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Q1,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class t2 extends tn.PureComponent{static contextType=dn.Z;bookmarkActions=this.props.bookmarkActions||i.Z;nodeRef=tn.createRef();refInput=tn.createRef();state={isEditing:!1,title:this.props.bookmark.title,fallbackTitle:this.props.bookmark.title};componentDidUpdate(e,t){if(!1===e.needsInitialEdit&&!0===this.props.needsInitialEdit&&!1===this.state.isEditing&&this.enableEditing(),!1===t.isEditing&&!0===this.state.isEditing){const e=this.refInput.current,t=e?.value;e&&t&&(e.setSelectionRange(0,t.length),e.focus())}}_documentClickHandler=e=>{const t=this.nodeRef.current,n=e.target;t&&n instanceof HTMLElement&&!t.contains(n)?this.refInput.current?.blur():document.removeEventListener("click",this._documentClickHandler)};enableEditing(){!1===this.state.isEditing&&(document.addEventListener("click",this._documentClickHandler),this.setState({isEditing:!0}))}handleClick=e=>{(0,Cs.Z)(e),"click"!==this.props.howToEdit?this.props.onSelect&&this.props.onSelect(e):J1.nextTick((()=>this.enableEditing()))};handleDoubleClick=e=>{"doubleClick"===this.props.howToEdit&&this.enableEditing()};finishEdit(e){if(!1===this.state.isEditing)return;document.removeEventListener("click",this._documentClickHandler),this.props.needsInitialEdit&&this.props.setSpeedDialAwaitingEdit("");const t=this.props.bookmark.id;switch(e){case"save":this.setState({isEditing:!1},(()=>{y.Z.bookmarks.update(t,{title:this.state.title}).then((()=>{this.props.onFinished&&this.props.onFinished(!1)}))}));break;case"undo":this.setState((e=>({title:e.fallbackTitle,isEditing:!1})),(()=>{y.Z.bookmarks.update(t,{title:this.state.title}).then((()=>{this.props.onFinished&&this.props.onFinished(!1)}))}));break;case"delete":this.setState({isEditing:!1},(()=>{this.props.onFinished&&this.props.onFinished(!0),this.bookmarkActions.remove([t])}))}}handleBlur=e=>{this.finishEdit("save")};handleChange=e=>{const t=e.target.value;this.setState({title:t})};handleKeyDown=e=>{switch(e.stopPropagation(),e.key){case"Enter":this.finishEdit("save");break;case"Escape":this.props.needsInitialEdit&&this.state.title===en.ZP.getDefaultFolderName()?this.finishEdit("delete"):this.finishEdit("undo")}};removeSpeedDial=()=>{y.Z.bookmarks.update(this.props.bookmark.id,{speeddial:!1})};onContextMenu=e=>{this.state.isEditing?e.stopPropagation():(e.persist(),e.preventDefault(),e.stopPropagation(),this.props.getContextMenuItemsPromise(this.props.bookmark).then((t=>{(0,zi.Z)(this.context.vivaldiWindowId,t)(e)})))};render(){const e=mn()({"editable-title-container":!0,edit:this.state.isEditing});return(0,fn.jsx)("span",{ref:this.nodeRef,className:e,onBlur:e=>e.stopPropagation(),onFocus:e=>e.stopPropagation(),onContextMenu:this.onContextMenu,children:this.state.isEditing?(0,fn.jsx)("input",{type:"text",ref:this.refInput,className:"sd-title-editor",value:this.state.title,onBlur:this.handleBlur,style:this.props.style,onKeyDown:this.handleKeyDown,onPointerUp:Cs.Z,onChange:this.handleChange,autoFocus:!0}):e2("button",{className:this.props.className,"data-id":this.props.bookmark.id,tabIndex:this.props.keyAccess,onClick:this.handleClick,onDoubleClick:this.handleDoubleClick,onPointerUp:Cs.Z,title:this.props.bookmark.title,onKeyDown:this.props.onKeyDown?this.props.onKeyDown.bind(this,this.props.bookmark.id):void 0},void 0,this.props.bookmark.title)})}}const n2=t2;var i2,s2=n(34155);function o2(e,t,n,i){i2||(i2="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:i2,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const a2=new Set;var r2=o2(hj,{src:"",isFolder:!0}),l2=o2(Wi,{rightMargin:0,className:"favicon"});class d2 extends tn.PureComponent{static contextType=dn.Z;nodeRef=tn.createRef();refTitle=tn.createRef();_hasClipboardListener=!1;_customThumbnail=!1;constructor(e){super(e),this.focusedElement=null,this.state={canDrop:!1,isHovered:!1}}componentWillUnmount(){this.enableClipboardListener(!1),Sj.unlinkBookmarkComponent(this)}isFolder(){return!this.props.node.url}isBookmark(){return!this.isFolder()}handleRemoveDial=()=>{const e=ss(this.nodeRef.current)?this.props.getNextFocusable(this.props.node.id):"";this.props.bookmarkActions.remove([this.props.node.id]).then((()=>{e&&this.props.moveFocus(e,"current",!1)}))};enableClipboardListener=e=>{if(this._hasClipboardListener!==e){this._hasClipboardListener=e;const{document:t}=this.context;this._hasClipboardListener?(t.addEventListener("cut",this.onCut),t.addEventListener("copy",this.onCopy),t.addEventListener("paste",this.onPaste)):(t.removeEventListener("cut",this.onCut),t.removeEventListener("copy",this.onCopy),t.removeEventListener("paste",this.onPaste))}};handleCutDial=()=>{const{document:e}=this.context,t=this._hasClipboardListener;t||e.addEventListener("cut",this.onCut),e.execCommand("cut"),t||e.removeEventListener("cut",this.onCut)};handleCopyDial=()=>{const{document:e}=this.context,t=this._hasClipboardListener;t||e.addEventListener("copy",this.onCopy),e.execCommand("copy"),t||e.removeEventListener("copy",this.onCopy)};handlePasteDial=()=>{const{document:e}=this.context,t=this._hasClipboardListener;t||e.addEventListener("paste",this.onPaste),e.execCommand("paste"),t||e.removeEventListener("paste",this.onPaste)};handleRename=()=>{this.refTitle.current?.enableEditing()};onRenameFinished=e=>{e?s2.nextTick((()=>{this.props.moveFocus("add","current",!1)})):this.props.moveFocus(this.props.node.id,"current",!1)};handleEdit=()=>{ie.Z.showBookmarkDialog(this.context.vivaldiWindowId,{mode:"edit",id:this.props.node.id,index:-1})};handleUpdateThumbnail=()=>{this.props.node.url&&Sj.updateForBookmark(this.props.node.id,this.props.node.url)};handleSetCustomThumbnail=()=>{d.Z.utilities.selectLocalImage({windowId:this.context.vivaldiWindowId,title:(0,le.Z)("Select Custom Image"),thumbnailBookmarkId:this.props.node.id})};handleClearCustomThumbnail=()=>{this.props.bookmarkActions.update(this.props.node.id,{thumbnail:""})};onThumbnailImageLoadError=e=>{e&&!(0,Ni.Li)(e)&&d.Z.bookmarksPrivate.isCustomThumbnail(this.props.node.id,(t=>{e===this.props.node.thumbnail&&(t||a2.has(e)||(a2.add(e),this.props.node.url&&Sj.updateForBookmark(this.props.node.id,this.props.node.url)))}))};openSpeedDialNodeHandler=e=>{const t=e.ctrlKey,n=this.context.vivaldiWindowId;let i=!1,s=!1;if(e.shiftKey&&!e.altKey&&t)return void Ru.Z.openBrowserWindow(n,this.props.node.url,{incognito:!1,transition:d.Z.historyPrivate.TransitionType.AUTO_BOOKMARK});const o="number"==typeof e.button?e.button:vn.Z.kNone;if(!e.shiftKey||e.altKey||t)if(e.shiftKey||e.altKey||!t){if(o===vn.Z.kCenter)i=!0,s=!0,e.preventDefault();else if(vn.Z.isContextMenuButton(o)||vn.Z.isNavigationButton(o))return}else i=!0,s=!0;else i=!0;this.openSpeedDialNode(this.props.node,{openInBackground:s,openInNewTab:i}),X.Z.clearStatus(n)};openSpeedDialNode=(e,t)=>{this.props.openSpeedDialNode(e,t)};handlePointerEnter=()=>{const{node:e}=this.props,{children:t}=e,n=t?(0,le.Z)("$1 Folder",[e.title||""]):e?St.jk.getHoverUrl(en.ZP.getUrlByNode(e)):"";X.Z.setStatus(this.context.vivaldiWindowId,n)};handlePointerLeave=()=>{X.Z.clearStatus(this.context.vivaldiWindowId)};dialPointerDownHandler=e=>{this.props.onPointerDown(this.props.node,e)};pointerDownHandler=e=>{e.button,vn.Z.kCenter,e.button!==vn.Z.kLeft&&e.preventDefault(),d.Z.bookmarksPrivate.isCustomThumbnail(this.props.node.id,(e=>{this._customThumbnail=e}))};pointerUpHandler=e=>{this.openSpeedDialNodeHandler(e),this.focusedElement&&setTimeout((()=>{this.focusedElement&&this.focusedElement.focus(),this.focusedElement=null}),1)};keyDownHandler=e=>{switch(e.key){case" ":case"Enter":this.openSpeedDialNodeHandler(e);break;case"F2":this.handleRename();break;case"ArrowLeft":if(!this.props.moveFocus(this.props.node.id,"left",!1))return;break;case"ArrowRight":if(!this.props.moveFocus(this.props.node.id,"right",!1))return;break;case"ArrowUp":if(!this.props.moveFocus(this.props.node.id,"up",!1))return;break;case"ArrowDown":if(!this.props.moveFocus(this.props.node.id,"down",!1))return;break;default:return}e.preventDefault(),e.stopPropagation()};cancelEvent=e=>{e.preventDefault(),e.stopPropagation()};getContextMenuItems=(e,t)=>{const n=this.context.vivaldiWindowId,i=Ai.getOptionFunction(e),s="always"===this.props.titleVisibility;return Ai.getNamedMenu(n,e,(async e=>{switch(e.action){case"CONTEXT_OPEN_IN_NEW_TAB":return{handler:this.openSpeedDialNode.bind(this,t,{openInNewTab:!0,openInBackground:this.props.openTabsInBackground}),visible:this.isBookmark(),...i(n,e,{})};case"CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB":return{handler:this.openSpeedDialNode.bind(this,t,{openInNewTab:!0,openInBackground:!0}),visible:this.isBookmark()&&!this.props.openTabsInBackground,...i(n,e,{})};case"CONTEXT_OPEN_IN_TAB":return{handler:()=>this.openSpeedDialNode(t),visible:this.isBookmark(),...i(n,e,{})};case"CONTEXT_OPEN_IN_NEW_WINDOW":return{handler:this.openSpeedDialNode.bind(this,t,{openInNewWindow:!0}),visible:this.isBookmark(),...i(n,e,{})};case"CONTEXT_OPEN_IN_PRIVATE_WINDOW":return{handler:this.openSpeedDialNode.bind(this,t,{openInNewWindow:!0,incognito:!0}),visible:this.isBookmark(),...i(n,e,{})};case"CONTEXT_CONTAINER_OPEN_IN_WINDOW":{const s=await Hi.getMenu(n,!0,[t.url||""]);return{visible:this.isBookmark()&&s.length>0,items:s,...i(n,e,{})}}case"CONTEXT_OPEN_ALL":return{handler:this.openSpeedDialNode.bind(this,t,{openInBackground:!0}),visible:this.isFolder(),...i(n,e,{})};case"CONTEXT_SET_THUMBNAIL":return{handler:this.handleSetCustomThumbnail,visible:(this.isBookmark()||this.isFolder())&&!this.props.incognito,...i(n,e,{})};case"CONTEXT_CLEAR_THUMBNAIL":return{handler:this.handleClearCustomThumbnail,visible:this._customThumbnail,...i(n,e,{})};case"CONTEXT_RELOAD":return{handler:this.handleUpdateThumbnail,visible:(this.isBookmark()||this.isFolder())&&!this.props.incognito,...i(n,e,{})};case"CONTEXT_EDIT":return{handler:this.handleEdit,...i(n,e,{})};case"CONTEXT_RENAME":return{handler:this.handleRename,visible:s,...i(n,e,{})};case"CONTEXT_CUT":return{handler:this.handleCutDial,...i(n,e,{})};case"CONTEXT_COPY":return{handler:this.handleCopyDial,...i(n,e,{})};case"CONTEXT_PASTE":return{handler:this.handlePasteDial,...i(n,e,{})};case"CONTEXT_DELETE":return{handler:this.handleRemoveDial,...i(n,e,{})};default:return{...i(n,e,{})}}}))};onContextMenu=(e,t)=>{t.persist(),t.preventDefault(),t.stopPropagation(),this.getContextMenuItems("speeddialitem",e).then((e=>{(0,zi.Z)(this.context.vivaldiWindowId,e)(t)}))};onDragOver=e=>{e.dataTransfer.types.some((e=>"text/uri-list"===e||"text/plain"===e||e===Jt.yR))&&(e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect=Jt.ZP.isCopyModifierPressed(e)?"copy":"move",this.setState({canDrop:!0}))};onDragLeave=e=>{this.state.canDrop&&this.setState({canDrop:!1})};onDrop=e=>{e.preventDefault(),e.stopPropagation(),this.props.bookmarkActions.onDropEvent(e,this.props.node.id,0),this.setState({canDrop:!1})};onCut=e=>{this.props.bookmarkActions.cut(e,[this.props.node.id]),e.stopPropagation(),e.preventDefault()};onCopy=e=>{this.props.bookmarkActions.copy(e,[this.props.node.id]),e.stopPropagation(),e.preventDefault()};onPaste=e=>{this.props.bookmarkActions.paste(e,this.props.node.id),e.stopPropagation(),e.preventDefault()};renderThumbnails(){const e=this.props.node;return e.children?e.thumbnail?o2(hj,{src:e.thumbnail,onImageLoadError:this.onThumbnailImageLoadError,className:"thumbnail-folder-image"},"thumb__folder__"+e.id):e.children.map(((t,n)=>{if(n<4)return o2(hj,{src:t.thumbnail?t.thumbnail:"",className:"Mini-Thumbnail",onImageLoadError:this.onThumbnailImageLoadError,isFolder:!!t.children},"thumb__"+e.id+"__"+n)})):null}getContextMenuItemsPromise=e=>this.getContextMenuItems("speeddialitem",e);getTitleStyle=Uu()(1)((e=>e?{}:{textAlign:"center"}));render(){const e=this.props.node,{children:t}=e,n=Sj.linkAndQueryUpdatingBookmark(this,e.id),i=e.url?e.url:"",s=e.faviconUrl?e.faviconUrl:St.jk.getFavicon(i),{showFavicon:o,titleVisibility:a,deleteVisible:r,controlsVisible:l}=this.props,d="never"!==a,c=d?45:10;return(0,fn.jsxs)("div",{ref:this.nodeRef,tabIndex:this.props.keyAccess,onPointerDown:this.dialPointerDownHandler,className:mn()("draggable","dial",{dragging:this.props.dragging,dragover:this.props.highlight,folder:Boolean(t),isCut:this.props.isCut}),style:{...this.props.style,height:this.props.backgroundHeight,width:this.props.thumbnailWidth},"data-id":e.id,onContextMenu:this.onContextMenu.bind(this,e),onBlur:()=>this.enableClipboardListener(!1),onFocus:()=>this.enableClipboardListener(!0),onKeyDown:this.keyDownHandler,onPointerEnter:()=>this.setState({isHovered:!0}),onPointerLeave:()=>this.setState({isHovered:!1}),onDoubleClick:this.cancelEvent,onPointerUpCapture:this.props.onPointerUp,children:[t?o2("div",{className:mn()({"thumbnail-image":!0,"dial-folder-icon":!0,"drop-hover":this.state.canDrop}),title:e.url,style:{height:this.props.thumbnailHeight,width:"100%"},onPointerEnter:this.handlePointerEnter,onPointerLeave:this.handlePointerLeave,onPointerDown:this.pointerDownHandler,onPointerUp:this.pointerUpHandler,onPointerCancel:this.pointerUpHandler,onDragOver:this.onDragOver.bind(this),onDragLeave:this.onDragLeave.bind(this),onDrop:this.onDrop.bind(this)},e.id,0===t.length&&!e.thumbnail&&r2,t.length>0&&!e.thumbnail&&o2("div",{className:"preview"},void 0,this.renderThumbnails()),e.thumbnail&&o2(hj,{className:"thumbnail-folder-image",src:e.thumbnail,onImageLoadError:this.onThumbnailImageLoadError})):o2(hj,{onPointerEnter:this.handlePointerEnter,onPointerLeave:this.handlePointerLeave,onPointerDown:this.pointerDownHandler,onPointerUp:this.pointerUpHandler,src:e.thumbnail,onImageLoadError:this.onThumbnailImageLoadError,thumbnailHeight:this.props.thumbnailHeight,thumbnailWidth:"100%"},e.id),e.url&&l&&o2("div",{className:"thumb-controls",style:{bottom:c}},void 0,!this.props.incognito&&o2("button",{tabIndex:"-1",onClick:this.handleUpdateThumbnail,className:mn()({circular:!0,"update-thumbnail":!0,updating:n}),disabled:n,title:(0,le.Z)("Update thumbnail"),dangerouslySetInnerHTML:{__html:cn.GO5.large}}),o2("button",{tabIndex:"-1",onClick:this.handleSetCustomThumbnail,className:mn()({circular:!0,"set-custom-thumbnail":!0}),title:(0,le.Z)("Select custom thumbnail"),dangerouslySetInnerHTML:{__html:cn.a8r}})),r&&o2("button",{tabIndex:"-1",onClick:this.handleRemoveDial,title:(0,le.Z)("other","Delete"),className:"close circular",dangerouslySetInnerHTML:{__html:cn.uN0}}),d&&o2("div",{className:mn()({"thumbnail-title":!0,hidden:"hover"===a}),onPointerUp:this.pointerUpHandler},void 0,o&&!t&&o2(Oi,{className:"favicon",url:s||i,loadType:s?"faviconFromCache":"page"}),o&&t&&l2,(0,fn.jsx)(n2,{ref:this.refTitle,bookmark:e,bookmarkActions:this.props.bookmarkActions,className:"button-title",getContextMenuItemsPromise:this.getContextMenuItemsPromise,howToEdit:"click",keyAccess:-1,needsInitialEdit:this.props.awaitingInitialEditId===e.id,onSelect:this.pointerUpHandler,setSpeedDialAwaitingEdit:this.props.setSpeedDialAwaitingEdit,style:this.getTitleStyle(o),onFinished:this.onRenameFinished,titleMargin:this.props.titleMargin}))]})}}const c2=d2;var h2;function p2(e,t,n,i){h2||(h2="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:h2,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const u2="add",g2=[D.kStartpageSpeedDialFaviconVisible,D.kStartpageSpeedDialTitlesVisible];var m2=p2(Oi,{className:"favicon SpeedDialAddButton-Favicon",url:cn.a8r,loadType:"faviconFromCache"});class v2 extends tn.Component{static contextType=dn.Z;_hasClipboardListener=!1;refOpenAddSpeedDial=tn.createRef();componentWillUnmount(){this._enableClipboardListener(!1)}_enableClipboardListener=e=>{if(this._hasClipboardListener!==e){this._hasClipboardListener=e,this.props.onSetClipboardListener(this._hasClipboardListener);const{document:t}=this.context;this._hasClipboardListener?t.addEventListener("paste",this.onPaste):t.removeEventListener("paste",this.onPaste)}};onPaste=e=>{this.props.onPaste(e)};keyDownHandler=e=>{if(" "===e.key||"Enter"===e.key)this.props.addItem();else switch(e.key){case"ArrowLeft":this.props.moveFocus(u2,"left",!1);break;case"ArrowRight":this.props.moveFocus(u2,"right",!1);break;case"ArrowUp":this.props.moveFocus(u2,"up",!1);break;case"ArrowDown":this.props.moveFocus(u2,"down",!1);break;default:return}e.preventDefault(),e.stopPropagation()};_handleItemMouseDown=e=>{e.button!==vn.Z.kLeft&&e.preventDefault()};render(){const{prefValues:e}=this.props,t=e[D.kStartpageSpeedDialFaviconVisible],n=t?{}:{textAlign:"center"};return p2("div",{className:mn()("dial","add",{active:this.props.drawerIsOpen,"SpeedDial-Dial--Favicon":t,"SpeedDial-Dial--Title":"never"!==e[D.kStartpageSpeedDialTitlesVisible]}),"data-id":u2,style:this.props.style,onBlur:()=>this._enableClipboardListener(!1),onFocus:()=>this._enableClipboardListener(!0),onMouseDown:this._handleItemMouseDown,tabIndex:this.props.keyAccess,onKeyDown:this.keyDownHandler},void 0,(0,fn.jsx)("button",{ref:this.refOpenAddSpeedDial,className:"thumbnail-image",title:this.props.title,style:{height:this.props.thumbnailHeight},tabIndex:this.props.keyAccess,onClick:this.props.addItem,dangerouslySetInnerHTML:{__html:cn.irc}}),p2("div",{className:"thumbnail-title"},void 0,t&&m2,"never"!==e[D.kStartpageSpeedDialTitlesVisible]&&p2("span",{className:"button-title",style:n},void 0,(0,le.Z)("Add New Speed Dial"))))}}const f2=(0,fs.Z)(v2,g2);var y2;function w2(e,t,n,i){y2||(y2="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:y2,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const b2={"":(0,le.Z)("No Image"),...QG};var C2=w2(mp,{type:"close",size:16}),S2=w2(mp,{type:"checkmark"}),T2=w2("hr",{}),I2=w2("hr",{}),k2=w2("option",{value:1},void 0,"1"),A2=w2("option",{value:2},void 0,"2"),Z2=w2("option",{value:3},void 0,"3"),E2=w2("option",{value:4},void 0,"4"),_2=w2("option",{value:5},void 0,"5"),N2=w2("option",{value:6},void 0,"6"),M2=w2("option",{value:7},void 0,"7"),P2=w2("option",{value:8},void 0,"8"),D2=w2("option",{value:10},void 0,"10"),x2=w2("option",{value:12},void 0,"12"),O2=w2(mp,{size:16,type:"settings"});function L2(e){const{prefValues:t}=e,{vivaldiWindowId:n}=(0,tn.useContext)(dn.Z),i=nt.Z.getEventHandler,[s,o]=(0,tn.useState)(!1),[a,r]=(0,tn.useState)(b2),[l,c]=(0,tn.useState)(Sl.Z.getCurrentIdWithoutPreview(n)),[h,p]=(0,tn.useState)(lT.Z.getThemeWithFallback(l));(0,tn.useEffect)((()=>{function e(){const e=Sl.Z.getCurrentIdWithoutPreview(n);c(e),p(lT.Z.getThemeWithFallback(e))}return P.Z.addListener(e),()=>P.Z.removeListener(e)}),[n]),(0,tn.useEffect)((()=>{const e=t[D.kThemesSystem].concat(t[D.kThemesUser]).reduce(((e,t)=>{const n=t.backgroundImage,i=[...Object.keys(e),...Object.keys(b2)];return n&&!i.includes(n)&&n!==KG&&(e[n]=(0,le.Z)("From $1",[t.name])),e}),{});r({...b2,...e})}),[t]),(0,tn.useEffect)((()=>{const e=()=>o(!1);return s&&wd.Z.bind("esc",e),()=>{wd.Z.unbind("esc",e)}}),[s]);const u=e=>{const n=function(e){return lT.Z.getSystemThemes().some((t=>t.id===e))?D.kThemesSystem:D.kThemesUser}(l),i=(0,E.Uy)(t[n],(t=>{const n=t.findIndex((e=>e.id===l));t[n].backgroundImage=e}));nt.Z.set(n,i)},g=()=>{d.Z.utilities.selectLocalImage({title:(0,le.Z)("Select Background Image"),themeId:l,windowId:n})},m=()=>Y.Z.openURL(n,"https://themes.vivaldi.net");return s?w2("div",{className:mn()("SpeedDialView-Settings",{"navigation-title":"off"!==M.Z.get(D.kStartpageNavigation)}),onDoubleClick:Cs.Z},void 0,w2("div",{className:"SpeedDialView-Settings-Head"},void 0,w2("h1",{},void 0,(0,le.Z)("Quick Settings")),w2("button",{className:"close",onClick:()=>o(!1),title:(0,le.Z)("Close Quick Settings")},void 0,C2)),w2("div",{className:"SpeedDialView-Settings-BackgroundImages"},void 0,w2("h2",{},void 0,(0,le.Z)("Background Images")),w2("div",{className:"images"},void 0,Object.keys(a).map((e=>w2("button",{title:a[e],className:mn()("selectbox",{"selectbox-selected":e===h.backgroundImage}),onClick:()=>u(e)},e,w2("div",{className:"selectbox-image",style:{backgroundColor:""===e?h.colorWindowBg:void 0,backgroundImage:`url(${e})`}},void 0,S2))))),w2("div",{className:"actions"},void 0,w2("a",{href:"https://themes.vivaldi.net",onClick:m},void 0,(0,le.Z)("Get More Background Images")),w2("input",{type:"button",value:(0,le.Z)("Select Image..."),title:(0,le.Z)("Select Background Image"),onClick:g}))),T2,w2("div",{className:"SpeedDialView-Settings-StartPage"},void 0,w2("h2",{},void 0,(0,le.Z)("title","Start Page")),w2("div",{className:"row"},void 0,w2("label",{htmlFor:"navigationToggle",title:(0,le.Z)("Start Page Navigation")},void 0,(0,le.Z)("Start Page Navigation")),w2("select",{id:"navigationToggle",value:t[D.kStartpageNavigation],onChange:i(D.kStartpageNavigation)},void 0,w2("option",{value:"on"},void 0,(0,le.Z)("Show on Internal Pages")),w2("option",{value:"speed_dial_only"},void 0,(0,le.Z)("Show on Speed Dial Page")),w2("option",{value:"off"},void 0,(0,le.Z)("radio","Hide Titles")))),w2("div",{className:"row"},void 0,w2("label",{htmlFor:"searchFieldToggle"},void 0,(0,le.Z)("Search Field")),w2(hI,{inputId:"searchFieldToggle",checked:t[D.kStartpageSpeedDialDisplaySearch],onChange:i(D.kStartpageSpeedDialDisplaySearch)})),w2("div",{className:"row"},void 0,w2("label",{htmlFor:"privacyStatsToggle"},void 0,(0,le.Z)("Privacy Statistics")),w2(hI,{inputId:"privacyStatsToggle",checked:t[D.kStartpageSpeedDialPrivacyStatsShow],onChange:i(D.kStartpageSpeedDialPrivacyStatsShow)})),w2("div",{className:"row"},void 0,w2("label",{htmlFor:"gameToggle"},void 0,(0,le.Z)("Vivaldia Game")),w2(hI,{inputId:"gameToggle",checked:t[D.kStartpageSpeedDialGameButtonShow],onChange:i(D.kStartpageSpeedDialGameButtonShow)}))),I2,w2("div",{className:"SpeedDialView-Settings-Appearance"},void 0,w2("h2",{},void 0,(0,le.Z)("Speed Dial Appearance")),w2("div",{className:"row"},void 0,w2("label",{className:"dropdown",htmlFor:"thumbnailSelect",title:(0,le.Z)("Thumbnail Size")},void 0,(0,le.Z)("Thumbnail Size")),w2("select",{id:"thumbnailSelect",value:t[D.kStartpageSpeedDialWidth],onChange:i(D.kStartpageSpeedDialWidth)},void 0,fV.map((({value:e,label:t})=>w2("option",{value:e},e,t))))),w2("div",{className:"row"},void 0,w2("label",{className:"dropdown",htmlFor:"maxColumnSelect",title:(0,le.Z)("Maximum Columns")},void 0,(0,le.Z)("Maximum Columns")),w2("select",{id:"maxColumnSelect",value:t[D.kStartpageSpeedDialColumns],onChange:i(D.kStartpageSpeedDialColumns),title:(0,le.Z)("Maximum number of Speed Dial columns")},void 0,k2,A2,Z2,E2,_2,N2,M2,P2,D2,x2,w2("option",{value:99},void 0,(0,le.Z)("Unlimited")))),w2("div",{className:"row"},void 0,w2("label",{className:"dropdown",htmlFor:"titleSelect",title:(0,le.Z)("Speed Dial Title")},void 0,(0,le.Z)("Speed Dial Title")),w2("select",{id:"titleSelect",value:t[D.kStartpageSpeedDialTitlesVisible],onChange:i(D.kStartpageSpeedDialTitlesVisible)},void 0,w2("option",{value:"always"},void 0,(0,le.Z)("verb","Show")),w2("option",{value:"hover"},void 0,(0,le.Z)("Show on Hover")),w2("option",{value:"never"},void 0,(0,le.Z)("verb","Hide")))),w2("div",{className:"row"},void 0,w2("label",{htmlFor:"addButtonToggle"},void 0,(0,le.Z)("Show Add Button")),w2(hI,{inputId:"addButtonToggle",checked:t[D.kStartpageSpeedDialAddButtonVisible],onChange:i(D.kStartpageSpeedDialAddButtonVisible)})),w2("div",{className:"row"},void 0,w2("label",{htmlFor:"deleteButtonToggle"},void 0,(0,le.Z)("Show Delete Button")),w2(hI,{inputId:"deleteButtonToggle",checked:t[D.kStartpageSpeedDialDeleteVisible],onChange:i(D.kStartpageSpeedDialDeleteVisible)}))),w2("div",{className:"toolbar toolbar-default SpeedDial-Show-Settings"},void 0,w2(sl,{title:(0,le.Z)("Open Start Page Settings"),onClick:()=>{ie.Z.showSettings(n,"startpage"),o(!1)},image:cn.bqs.small,className:"button-show-setting"}))):w2("button",{className:"SpeedDialView-Settings-Button",onClick:()=>o(!0),title:(0,le.Z)("Show Quick Settings")},void 0,O2)}var R2,B2=n(76662);function F2(e,t,n,i){R2||(R2="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:R2,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var U2=F2(mp,{className:"Blocker-Shield-Blocking",type:"blocker-shield",size:16}),V2=F2(mp,{className:"Info-Icon",type:"info",size:16});class W2 extends tn.PureComponent{state={totalAdBlocked:0,totalTrackerBlocked:0};componentDidMount(){d.Z.contentBlocking.getBlockedCounters(this.getTotalBlockedData)}getTotalBlockedData=(e,t)=>{if(!t||!t.blocked_for_origin)return;const n=t.blocked_for_origin.ad_blocking.reduce(((e,t)=>e+t.blocked_count),0),i=t.blocked_for_origin.tracking.reduce(((e,t)=>e+t.blocked_count),0);this.setState({totalAdBlocked:n,totalTrackerBlocked:i})};formatPrivacyDataNumber(e){return e.split(/(\d+)/).map(((e,t)=>/\d/.test(e)?F2("strong",{},t,(0,F.uf)(e)):e))}render(){const{totalAdBlocked:e,totalTrackerBlocked:t}=this.state;return F2("div",{className:"SpeedDial-Blocked-Counter",onClick:()=>ie.Z.showPrivacyStatsDialog(z.ZP.getId())},void 0,F2("div",{className:"SpeedDial-Blocked-Counter-Container"},void 0,U2,F2("p",{className:"Blocked-Info"},void 0,this.formatPrivacyDataNumber((0,le.Z)("$1 tracker and","$1 trackers and",[t]))," ",this.formatPrivacyDataNumber((0,le.Z)("$1 ad blocked","$1 ads blocked",[e]))),V2))}}var H2,z2=n(34155);function G2(e,t,n,i){H2||(H2="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:H2,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const $2=[D.kAddressBarSearchSuggestEnabled,D.kThemeUseAnimation,D.kStartpageSpeedDialAddButtonVisible,D.kStartpageSpeedDialAllowDnd,D.kStartpageSpeedDialColumns,D.kStartpageSpeedDialControlsVisible,D.kStartpageSpeedDialDeleteVisible,D.kStartpageSpeedDialFaviconVisible,D.kStartpageSpeedDialTitlesVisible,D.kStartpageSpeedDialWidth,D.kTabsOpenNewInBackground,D.kStartpageNavigation,D.kStartpageSpeedDialDisplaySearch,D.kStartpageSpeedDialGameButtonShow,D.kStartpageSpeedDialPrivacyStatsShow,D.kThemesSystem,D.kThemesUser],K2={stiffness:400,damping:32,precision:.1};function j2(e,t){const n=Array(e);for(let i=0;i<e;i++)n[i]=t(i);return n}var Y2=G2(W2,{});class X2 extends tn.PureComponent{static contextType=dn.Z;animate=!1;dragStartX=0;dragStartY=0;dragDialStartPos=[0,0];refSpeedDial=tn.createRef();refParentFolderButton=tn.createRef();state={dialNodes:[],pressed:"none",lastPress:null,dragDialXY:[0,0],dragOrder:null,transitionType:"down",dialId:null,highlightParentButton:!1};static getDerivedStateFromProps(e,t){const n=t.dialId,i=e.speedDialNode,s=i&&i.id,o=(i&&i.children||[]).filter((e=>!en.ZP.isSeparator(e)));if(n===s){let{lastPress:e,dragOrder:n}=t;if(null===e||n||o.every((t=>t.id!==e))&&(e=null),null===e)n=null;else if(n){const e=t.dialNodes;e.length===o.length&&e.every(((e,t)=>e.id===o[t].id))||(n=null)}return{...t,dialNodes:o,lastPress:e,dragOrder:n}}let a="down";if(i&&n&&n!==i.parentId)if(o.find((e=>e.id===n)))a="up";else{const t=e.speedDialSet;if(t){const e=t.findIndex((e=>e.id===n)),i=t.findIndex((e=>e.id===s));-1!==i&&-1!==e&&(i<e?a="right":i>e&&(a="left"))}}return{...t,dialNodes:o,lastPress:null,dragOrder:null,transitionType:a,dialId:s}}getLastPressPosition(){const{dialNodes:e,lastPress:t,dragOrder:n}=this.state;return n?n.findIndex((e=>e===t)):e.findIndex((e=>e.id===t))}componentDidMount(){Hf.Z.addListener(this._onWebpageViewStoreChanged),this.animate=!0}componentDidUpdate(e,t){const{HTMLElement:n}=this.context;z2.nextTick((()=>{const e=this.refParentFolderButton.current;if(e instanceof n){const t=e.getBoundingClientRect();t instanceof DOMRect&&(this.parentButtonRect=t)}}))}componentWillUnmount(){this.timeout&&clearTimeout(this.timeout),Hf.Z.removeListener(this._onWebpageViewStoreChanged),this.finishPointerClick(!1)}maybeSpring(e,t){return this.animate&&this.props.prefValues[D.kThemeUseAnimation]?(0,B2.ST)(e,t):e}_onWebpageViewStoreChanged=e=>{e.winId===this.context.vivaldiWindowId&&"WEBPAGEVIEW_RELOAD"===e.type&&this._handlePageReload()};onSearch=(e,t,n={})=>{if(t&&t.url){const i={...n,useSearchEngine:t};Of.Z.goSearchURL(this.context.vivaldiWindowId,e,i)}};handleSpeedDialPointerDown=(e,t)=>{"none"!==this.state.pressed&&this.finishPointerClick(!1,t),0!==t.button&&1!==t.button||!this.props.prefValues[D.kStartpageSpeedDialAllowDnd]||document.activeElement&&"sd-title-editor"===document.activeElement.className||(this.setState({pressed:"pressed",lastPress:e.id}),this.dragStartX=t.pageX,this.dragStartY=t.pageY)};onPointerMove=e=>{const{pressed:t}=this.state;if("none"===t||!this.props.prefValues[D.kStartpageSpeedDialAllowDnd])return;if(0===e.buttons)return void this.finishPointerClick(!1,e);if(!(1&e.buttons))return;const{lastPress:n}=this.state;if(null===n||"dragcancel"===t)return;this.setState({highlightParentButton:this.isPointerOverParentButton(e)});const i=e.pageX-this.dragStartX,s=e.pageY-this.dragStartY;if("pressed"===t&&Math.abs(i)<=5&&Math.abs(s)<=5)return;const o=this.getSpeedDialGeometry(),a=this.getLastPressPosition();"pressed"===t&&(this.setDialDragListeners(!0),this.dragDialStartPos=this.computeLayout(o,a),this.setState({pressed:"dragging"}));let[r,l]=this.dragDialStartPos;r+=i,l+=s,this.setState({dragDialXY:[r,l]});const{cols:d,rows:c,dialWidth:h,dialHeight:p,thumbnailWidth:u,backgroundHeight:g}=this.getSpeedDialGeometry(),m=this.state.dialNodes.length,v=r+Math.ceil(u/3.5),f=l+Math.ceil(g/3.5),y=i<0?Math.round:Math.floor,w=s<0?Math.round:Math.floor,b=(0,jf.default)(y(v/h),0,d-1),C=(0,jf.default)(w(f/p),0,c-1),S=Math.min(C*d+b,m-1);a!==S&&this.moveDial(S,a)};moveDial=(e,t)=>this.setState((n=>{const i=(n.dragOrder||n.dialNodes.map((e=>e.id))).slice(0),s=i.splice(t,1)[0];return i.splice(e,0,s),{dragOrder:i}}));setDialDragListeners(e){if(!this.props.prefValues[D.kStartpageSpeedDialAllowDnd])return;const t=this.context;e?(t.addEventListener("pointermove",this.onPointerMove,!0),t.addEventListener("pointerup",this.onPointerPressEnd,!1),t.addEventListener("pointercancel",this.onPointerPressEnd,!0),t.addEventListener("pointerdown",this.onPointerPressEnd,!0),wd.Z.bind("esc",this.onDragEscapeKey)):(t.removeEventListener("pointermove",this.onPointerMove,!0),t.removeEventListener("pointerup",this.onPointerPressEnd,!1),t.removeEventListener("pointercancel",this.onPointerPressEnd,!0),t.removeEventListener("pointerdown",this.onPointerPressEnd,!0),wd.Z.unbind("esc",this.onDragEscapeKey));const n=document.getElementById("browser");n&&(n.style.pointerEvents=e?"none":"auto")}onPointerPressEnd=e=>{const{pressed:t}=this.state;"dragging"!==t&&"dragcancel"!==t||(e.stopPropagation(),e.preventDefault()),this.finishPointerClick(!0,e)};onDragEscapeKey=()=>{this.setState({pressed:"dragcancel",dragOrder:null})};isPointerOverParentButton=e=>!(!e||!this.parentButtonRect)&&(e.pageX>this.parentButtonRect.x&&e.pageX<this.parentButtonRect.x+this.parentButtonRect.width&&e.pageY>this.parentButtonRect.y&&e.pageY<this.parentButtonRect.y+this.parentButtonRect.height);async finishPointerClick(e,t){const{pressed:n}=this.state;if("none"!==n){if("dragging"===n||"dragcancel"===n){this.setDialDragListeners(!1);let i=!1;const{dragOrder:s}=this.state,o=this.getDraggedNode();if("dragging"===n&&e&&this.isPointerOverParentButton(t)){const e=this.props.speedDialNode&&this.props.speedDialNode.parentId;o&&e&&(await this.props.bookmarkActions.move([o.id],e,0),i=!0)}else if("dragging"===n&&e&&s){const e=this.getLastPressPosition();if(!o)return;if(("number"==typeof o.index?o.index:e)!==e){const e=o.parentId||"";await this.props.bookmarkActions.reorder(s,e),i=!0}}i?this.onBookmarksMoved():this.setState({dragOrder:null})}this.setState({pressed:"dragcancel",highlightParentButton:!1})}}getDraggedNode=()=>{const{dialNodes:e,dragOrder:t}=this.state,n=this.getLastPressPosition();return t?e.find((e=>e.id===t[n])):this.state.dialNodes[n]};onSDPointerUp=async e=>{const{pressed:t}=this.state,n=e.currentTarget.getAttribute("data-id");if(!n||"dragging"!==t)return;const i=e.currentTarget.classList.contains("folder"),s=this.getDraggedNode();if(s&&s.id!==n){if(e.stopPropagation(),e.preventDefault(),i)await this.props.bookmarkActions.move([s.id],n,0);else if(function(e){return!!e&&!e.url}(s))await this.props.bookmarkActions.move([n],s.id,0);else{const e=en.ZP.getItemById(n),t=await this.props.bookmarkActions.mergeWithPromise(s,e,(0,le.Z)("title","New Folder"));this.props.setSpeedDialAwaitingEdit(t)}this.onBookmarksMoved(),this.setState({pressed:"dragcancel"})}else this.finishPointerClick(!0,e)};onBookmarksMoved=()=>{y.Z.runtime.lastError&&(this.setState({dragOrder:null}),console.warn("Error moving bookmark: ",y.Z.runtime.lastError))};onDragOverHandler=e=>{e.preventDefault(),e.stopPropagation()};openParentNode=()=>{this.props.speedDialNode&&this.props.speedDialNode.parentId&&y.Z.bookmarks.getSubTree(this.props.speedDialNode.parentId,(e=>{if(y.Z.runtime.lastError)return;const t=e[0];t&&this.props.openSpeedDialNode(t)}))};isTopLevel=()=>!this.props.speedDialNode||!this.props.speedDialSetNode||this.props.speedDialNode.id===this.props.speedDialSetNode.id;_handlePageReload=()=>{!this.props.incognito&&this.props.speedDialNode&&y.Z.bookmarks.getChildren(this.props.speedDialNode.id,(e=>{if(!e)return;const t=[];e.forEach(((e,n,i)=>{d.Z.bookmarksPrivate.isCustomThumbnail(e.id,(s=>{!1===s&&e.url&&t.push({id:e.id,url:e.url}),n===i.length-1&&Sj.updateForBookmarks(t)}))}))}))};onDragUrlOver=e=>{e.dataTransfer.types.some((e=>"text/uri-list"===e||"text/plain"===e||e===Jt.yR))&&(e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="copy")};onDropUrlOn=e=>{const t=this.props.speedDialNode;if(t){const n=t.children?t.children.length:0,i={disableMove:!0};this.props.bookmarkActions.onDropEvent(e,t.id,n,i)}};onKeyDown=e=>{const t=e.key.toLowerCase();if(e.ctrlKey)switch(t){case"z":e.shiftKey?this.props.bookmarkActions.redo():this.props.bookmarkActions.undo();break;case"y":this.props.bookmarkActions.redo()}};onPaste=e=>{this.props.speedDialNode&&this.props.bookmarkActions.paste(e,this.props.speedDialNode.id,!0),e.stopPropagation(),e.preventDefault()};getSpeedDialGeometry(){const{prefValues:e}=this.props;let t=e[D.kStartpageSpeedDialWidth];const n="always"===e[D.kStartpageSpeedDialTitlesVisible];if(-1===t){const e=Math.round(this.props.maxWidth/(1.4*this.props.prefValues[D.kStartpageSpeedDialColumns]));t=Math.max(Math.min(e,320),120)}const i=Math.round(t/1.22),s=Math.round(t/12);let o=this.state.dialNodes.length;e[D.kStartpageSpeedDialAddButtonVisible]&&o++;const a=6*s,r=e[D.kStartpageSpeedDialColumns];let l=i;n&&(l=i+33);const d=t+2*s,c=l+2*s;let h=Math.max(1,Math.min(Math.floor((this.props.maxWidth-a)/d),r));this.props.maxWidth<d*h+a&&(h=1);return{backgroundHeight:l,count:o,cols:h,rows:Math.ceil(o/h),dialWidth:d,dialHeight:c,thumbnailWidth:t,thumbnailHeight:i,dialSpace:s}}computeLayout(e,t){const n=Math.floor(t/Number(e.cols)),i=t%Number(e.cols);return[Number(e.dialWidth)*i,Number(e.dialHeight)*n]}getNextFocusable=e=>{const t=this.refSpeedDial.current;if(t instanceof HTMLElement){const n=Array.from(t.querySelectorAll("div.dial")).map((e=>e.getAttribute("data-id"))).filter(Boolean);let i=n.indexOf(e);return-1===i?"":(i=i>0?i-1:i+1,i>=n.length?"":n[i])}return""};moveFocus=(e,t,n)=>{const i=this.refSpeedDial.current;if(i instanceof HTMLElement){const n=Array.from(i.querySelectorAll("div.dial")).map((e=>e.getAttribute("data-id"))).filter(Boolean);if(0===n.length)return!1;let s;const o=this.getSpeedDialGeometry();switch(t){case"current":if(""===e&&(e=n[0]),s=n.indexOf(e),-1===s)return!1;break;case"left":case"right":if(1===n.length)return!1;if(s=n.indexOf(e),-1===s)return!1;if("right"===t){if((s+1)%o.cols==0)return!1;if(s+=1,s>=n.length)return!1}else{if(s%o.cols==0)return!1;if(s-=1,s>=n.length)return!1}break;case"up":case"down":if(1===n.length)return!1;if(s=n.indexOf(e),-1===s)return!1;if("up"===t){if(s-=o.cols,s<0){const e=i.getElementsByClassName("button-startpage up-level")[0];return!!e&&(e.focus(),!0)}}else if(s+=o.cols,s>=n.length)return!1;break;default:return!1}e=n[s];const a=i.querySelector(`div.dial[data-id="${e}"]`);if(a)return a.focus(),!0}return!1};renderNavigation=()=>this.isTopLevel()?null:G2("nav",{className:"startpage-folder-navigation"},void 0,(0,fn.jsxs)("button",{ref:this.refParentFolderButton,onClick:this.openParentNode,title:(0,le.Z)("Show Parent Folder"),"data-name":"up-button",className:mn()("button-startpage","up-level",{highlight:this.state.highlightParentButton}),children:[G2("span",{dangerouslySetInnerHTML:{__html:cn.zwh}}),this.props.speedDialNode?this.props.speedDialNode.title:""]}));render(){const{open:e,maxWidth:t,speedDialSet:n,prefValues:i}=this.props;if(!1===e||!t)return null;const s=i[D.kStartpageSpeedDialAllowDnd],o=i[D.kStartpageSpeedDialFaviconVisible],a=i[D.kStartpageSpeedDialTitlesVisible],r=i[D.kTabsOpenNewInBackground],l=i[D.kStartpageSpeedDialControlsVisible],d=i[D.kStartpageSpeedDialDeleteVisible],c=i[D.kStartpageSpeedDialPrivacyStatsShow],{pressed:h,dialId:p}=this.state,u=mn()({dials:!0,speeddial:!0,"sd-titles-onhover":"hover"===a}),g=n.length>0,m=this.getSpeedDialGeometry(),{backgroundHeight:v,count:f,cols:y,rows:w,dialWidth:b,dialHeight:C,thumbnailWidth:S,thumbnailHeight:T,dialSpace:I}=m,k=y*b-2*I,A=Math.round(S/20);return(0,fn.jsxs)(fn.Fragment,{children:[G2("div",{className:"SpeedDialView-Head",style:{maxWidth:k}},void 0,this.props.prefValues[D.kStartpageSpeedDialDisplaySearch]&&G2("div",{className:"on-speeddial"},void 0,G2(iy,{className:"SpeedDialView-SearchField",useFavicon:!0,origin:"speed_dial_view",onSearch:this.onSearch,suggestEnabled:i[D.kAddressBarSearchSuggestEnabled],size:"large",name:"SearchField"},"speed_dial_search")),c&&Y2),G2(q1.Z,{className:mn()({"dials-wrapper":!0,dragging:"dragging"===h,"dragging-disabled":!s}),transitionName:this.state.transitionType,transitionEnterTimeout:300,transitionLeaveTimeout:300,overflowHidden:!1},void 0,(0,fn.jsxs)("div",{onDragOver:this.onDragUrlOver,onDrop:this.onDropUrlOn,onKeyDown:this.onKeyDown,ref:this.refSpeedDial,className:u,children:[this.renderNavigation(),G2("div",{className:"dial-columns",onPointerMove:"pressed"===h&&s?this.onPointerMove:null,onPointerUp:this.onPointerPressEnd,onPointerCancel:this.onPointerPressEnd,style:{width:k,height:w*C,marginLeft:I,marginRight:I}},void 0,j2(f,(e=>{const{dialNodes:t}=this.state;let n=null;if(e<t.length){const{dragOrder:i}=this.state;n=i?t.find((t=>t.id===i[e])):t[e]}const i=!!n&&n.id===this.state.lastPress,s=i&&"dragging"===h;let c;if(s){const[e,t]=this.state.dragDialXY;c={translateX:e,translateY:t,opacity:this.maybeSpring(.95,K2)}}else if(n){const[t,n]=this.computeLayout(m,e);c={translateX:this.maybeSpring(t,K2),translateY:this.maybeSpring(n,K2),opacity:this.maybeSpring(1,K2)}}else{const[t,n]=this.computeLayout(m,e);c={translateX:this.maybeSpring(t,K2),translateY:this.maybeSpring(n,K2),opacity:1}}return G2(B2.y_,{style:c,children:Tl.default},n?"node_"+n.id:"add_button",(({translateX:t,translateY:c,opacity:p})=>{const u="dragging"===h;return n?G2(c2,{incognito:this.props.incognito,onPointerDown:this.handleSpeedDialPointerDown,dragging:s,style:{transform:`translate3d(${t}px, ${c}px, 0)`,zIndex:i?999:e,opacity:p,pointerEvents:s?"none":"auto"},isCut:this.props.cutIds.includes(n.id),backgroundHeight:v,thumbnailHeight:T,thumbnailWidth:S,highlight:u,onPointerUp:this.onSDPointerUp,titleMargin:A,node:n,bookmarkActions:this.props.bookmarkActions,keyAccess:0===e?0:-1,moveFocus:this.moveFocus,getNextFocusable:this.getNextFocusable,openSpeedDialNode:this.props.openSpeedDialNode,awaitingInitialEditId:this.props.awaitingInitialEditId,setSpeedDialAwaitingEdit:this.props.setSpeedDialAwaitingEdit,showFavicon:o,titleVisibility:a,openTabsInBackground:r,controlsVisible:l,deleteVisible:d}):G2(f2,{style:{transform:`translate3d(${t}px, ${c}px, 0)`,zIndex:0,height:v,width:S},id:this.props.speedDialNode?.id,thumbnailHeight:T,drawerIsOpen:this.props.drawerIsOpen,title:g?(0,le.Z)("title","Add bookmark to Speed Dial"):(0,le.Z)("First add a new Speed Dial folder"),keyAccess:0===e?0:-1,moveFocus:this.moveFocus,onPaste:this.onPaste,onSetClipboardListener:this.props.onSetClipboardListener,addItem:this.props.toggleStartpageDrawer})}))})))]},"node__"+(p||"unset"))),G2(L2,{prefValues:this.props.prefValues})]})}}const Q2=(0,fs.Z)(X2,$2);var q2;function J2(e,t,n,i){q2||(q2="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:q2,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const e3=[D.kMailIsTurnedOff,D.kStartpageSpeedDialAddButtonVisible];class t3 extends tn.Component{static contextType=dn.Z;nodeRef=tn.createRef();refSpeedDialTitles=new Map;openMenuItem=(e,t,n)=>{this.props.openMenuItem(e,t,n)};openSection=(e,t,n)=>{this.props.section!==e&&Y.Z.openURL(this.context.vivaldiWindowId,St.jk.internals[e],{inCurrent:!0}),e===UE.SpeedDial&&this.props.openMenuItem(UE.SpeedDial,t,n)};createSpeedDialSet=()=>{this.props.section!==UE.SpeedDial&&Y.Z.openURL(this.context.vivaldiWindowId,St.jk.internals[UE.SpeedDial],{inCurrent:!0}),this.props.createSpeedDialSet()};getContextMenuItems=e=>{const t="startpagebar",n=this.context.vivaldiWindowId,i=Ai.getOptionFunction(t);return Ai.getNamedMenu(n,t,(async t=>{switch(t.action){case"CONTEXT_RENAME":return{visible:e.length>0,handler:()=>this.handleRename(e),...i(n,t,{})};case"CONTEXT_REMOVE":return{visible:e.length>0,handler:()=>this.handleRemove(e),...i(n,t,{})};default:return{...i(n,t,{})}}}))};onContextMenu=e=>{e.persist(),e.preventDefault(),e.stopPropagation(),this.getContextMenuItems("").then((t=>{(0,zi.Z)(this.context.vivaldiWindowId,t)(e)}))};handleRename=e=>{this.refSpeedDialTitles.get(e)?.enableEditing()};handleRemove=e=>{this.refSpeedDialTitles.get(e)?.removeSpeedDial()};handleMouseDown=e=>{e.preventDefault()};handleKeyDown=(e,t)=>{switch(t.key){case"ArrowLeft":this.moveFocus(e,"left",!1);break;case"ArrowRight":this.moveFocus(e,"right",!1);break;default:return}t.preventDefault(),t.stopPropagation()};moveFocus=(e,t,n)=>{const{HTMLElement:i}=this.context,s=this.nodeRef.current;if(s instanceof i&&(!0===n||ss(s))){const n=Array.from(s.querySelectorAll("button.button-startpage")).map((e=>e.getAttribute("data-id"))).filter(Boolean);if("current"===t){if(""===e){const t=document.getElementsByClassName("div.button-startpage active")[0];t instanceof i&&(e=t.getAttribute("data-id"))}const t=n.indexOf(e);if(-1===t)return;e=n[t]}else if("right"===t||"left"===t){if(1===n.length)return;let i=n.indexOf(e);if(-1===i)return;i="right"===t?i+1>=n.length?0:i+1:i<=0?n.length-1:i-1,e=n[i]}const o=s.querySelector(`button.button-startpage[data-id="${e}"]`);o&&o.focus()}};setSpeedDialTitleRef=(e,t)=>{t?this.refSpeedDialTitles.set(e,t):this.refSpeedDialTitles.delete(e)};render(){let e=-1===this.props.keyAccess;const t=t=>{let n=-1;return!e&&t&&(e=!0,n=0),n};return(0,fn.jsxs)("nav",{ref:this.nodeRef,className:"startpage-navigation",onContextMenu:this.onContextMenu,children:[J2("div",{className:"startpage-navigation-group"},void 0,this.props.speedDialSet.map((function(e,n){const i=this.props.section===UE.SpeedDial&&this.props.speedDialSetNode&&this.props.speedDialSetNode.id===e.id,s="title"+n;return(0,fn.jsx)(n2,{className:mn()({active:i,"button-startpage":!0,"no-page-focus":!0}),ref:e=>this.setSpeedDialTitleRef(s,e),bookmark:e,howToEdit:"doubleClick",getContextMenuItemsPromise:this.getContextMenuItems.bind(this,s),keyAccess:t(i),onSelect:this.openSection.bind(this,UE.SpeedDial,e),onKeyDown:this.handleKeyDown,needsInitialEdit:this.props.initialEditSpeedDialSet===e.id,setSpeedDialAwaitingEdit:this.props.setSpeedDialAwaitingEdit},e.id)}),this),this.props.prefValues[D.kStartpageSpeedDialAddButtonVisible]&&J2("button",{onClick:this.createSpeedDialSet,"data-id":"add",className:"button-startpage add-set no-page-focus",title:(0,le.Z)("Add new Speed Dial folder"),tabIndex:t(!0),onKeyDown:this.handleKeyDown.bind(this,"add"),dangerouslySetInnerHTML:{__html:cn.md4.medium}})),J2("div",{className:"startpage-navigation-group"},void 0,J2("button",{onClick:this.openSection.bind(this,UE.Bookmarks,null),onMouseDown:this.handleMouseDown,onKeyDown:this.handleKeyDown.bind(this,UE.Bookmarks),title:(0,le.Z)("Bookmarks"),"data-id":UE.Bookmarks,tabIndex:t(!0),className:mn()({"button-startpage":!0,"no-page-focus":!0,active:this.props.section===UE.Bookmarks}),dangerouslySetInnerHTML:{__html:cn.CLf.medium+(0,le.Z)("Bookmarks")}}),J2("button",{onClick:this.openSection.bind(this,UE.History,null),onMouseDown:this.handleMouseDown,onKeyDown:this.handleKeyDown.bind(this,UE.History),title:(0,le.Z)("History"),"data-id":UE.History,tabIndex:t(!0),className:mn()({"button-startpage":!0,"no-page-focus":!0,active:this.props.section===UE.History}),dangerouslySetInnerHTML:{__html:cn.hcy.medium+(0,le.Z)("History")}}),J2("button",{onClick:this.openSection.bind(this,UE.NotesManager,null),onMouseDown:this.handleMouseDown,onKeyDown:this.handleKeyDown.bind(this,UE.NotesManager),title:(0,le.Z)("Notes"),"data-id":UE.NotesManager,tabIndex:t(!0),className:mn()({"button-startpage":!0,"no-page-focus":!0,active:this.props.section===UE.NotesManager}),dangerouslySetInnerHTML:{__html:cn.cyI.large+(0,le.Z)("Notes")}}),this.props.prefValues[D.kMailIsTurnedOff]?null:J2("button",{onClick:this.openSection.bind(this,UE.Calendar,null),onMouseDown:this.handleMouseDown,onKeyDown:this.handleKeyDown.bind(this,UE.Calendar),title:(0,le.Z)("Calendar"),"data-id":UE.Calendar,tabIndex:t(!0),className:mn()({"button-startpage":!0,"no-page-focus":!0,active:this.props.section===UE.Calendar}),dangerouslySetInnerHTML:{__html:cn.bcq.medium+(0,le.Z)("Calendar")}}))]})}}const n3=(0,fs.Z)(t3,e3);var i3,s3=n(55667);function o3(e,t,n,i){i3||(i3="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:i3,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const a3=[D.kBookmarksConfirmOpening,D.kBookmarksConfirmOpeningThreshold,D.kKeyboardTabToAll,D.kStartpageNavigation,D.kStartpageSpeedDialAddButtonVisible,D.kStartpageSpeedDialGameButtonShow,D.kTabsBarPosition,D.kTabsBarWidth];var r3=o3(Jj,{}),l3=o3("div",{className:"StartPage-GameButton"},void 0,o3(Ng,{isStartPage:!0}));class d3 extends tn.PureComponent{static contextType=dn.Z;refSDdWrapper=tn.createRef();_speeddialview=tn.createRef();bookmarkActions=new lj;_hasClipboardListener=!1;constructor(e,t){super(e);const n=en.ZP.getSpeeddialFolders(),i=n[0],s=Dl.ZP.getWidth(t.vivaldiWindowId),o=this.props.prefValues[D.kTabsBarWidth],a=this.props.prefValues[D.kTabsBarPosition],r="left"===a||"right"===a?o:0;this.state={section:e.view,bookmarksAvailable:en.ZP.hasBeenInitialized(),speeddialFolders:n,menuSpeeddial:i,currentSpeeddial:i,drawerIsOpen:!1,awaitingInitialEditId:"",initialEditSpeedDialSet:"",viewWidth:t.innerWidth-s-r,viewHeight:t.innerHeight,wallpaperId:Qr()(),cutIds:en.ZP.getCutIds()}}componentDidMount(){en.ZP.addListener(this._onStoreChange),dy.addListener(this._onTaskStoreChange)}componentWillUnmount(){en.ZP.removeListener(this._onStoreChange),dy.removeListener(this._onTaskStoreChange),wd.Z.unbind("esc",this.closeStartpageDrawer)}componentDidUpdate(e,t){t.drawerIsOpen!==this.state.drawerIsOpen&&(this.state.drawerIsOpen?wd.Z.bind("esc",this.closeStartpageDrawer):wd.Z.unbind("esc",this.closeStartpageDrawer)),e.view!==this.props.view&&this.setState({section:this.props.view})}_onStoreChange=()=>{const e=en.ZP.getSpeeddialFolders();let t=e[0],n=t;for(const i of e)this.getUpdatedNode(i,this.state.currentSpeeddial)&&(n=this.getUpdatedNode(i,this.state.currentSpeeddial)),this.getUpdatedNode(i,this.state.menuSpeeddial)&&(t=this.getUpdatedNode(i,this.state.menuSpeeddial));this.setState({bookmarksAvailable:!0,speeddialFolders:e,menuSpeeddial:t,currentSpeeddial:n,cutIds:en.ZP.getCutIds()})};_onTaskStoreChange=()=>{this.forceUpdate()};jumpToTop=()=>{const{HTMLElement:e}=this.context,t=this.refSDdWrapper.current;t instanceof e&&(t.scrollTop=0)};onResize=e=>{const t=e[0].contentRect;(this.state.viewHeight!==t.height||this.state.viewWidth!==t.width)&&this.setState({viewWidth:t.width,viewHeight:t.height})};getUpdatedNode=(e,t)=>{if(e&&e.id&&t&&t.id){if(e.id===t.id)return e;if(e.children){for(var n=0;n<e.children.length;n++){var i=this.getUpdatedNode(e.children[n],t);if(i&&i.id===t.id)return i}return null}return null}return null};showStartpageDrawer=(e,t)=>{this.setState({drawerIsOpen:e},(()=>{!1===e&&""===this.state.awaitingInitialEditId&&this._speeddialview.current?.moveFocus(t||"add","current",!1)}))};closeStartpageDrawer=()=>{this.showStartpageDrawer(!1,"")};toggleStartpageDrawer=()=>{0===this.state.speeddialFolders.length?this.createSpeedDialSet():this.showStartpageDrawer(!this.state.drawerIsOpen)};handleDoubleClick=()=>{this.state.section!==UE.SpeedDial||this.props.prefValues[D.kStartpageSpeedDialAddButtonVisible]||this.toggleStartpageDrawer()};onSetClipboardListener=e=>{this._hasClipboardListener=e};handlePaste=()=>{const e=this._hasClipboardListener;e||document.addEventListener("paste",this.onPaste),document.execCommand("paste"),e||document.removeEventListener("paste",this.onPaste)};onPaste=e=>{this.state.currentSpeeddial&&(this.bookmarkActions.paste(e,this.state.currentSpeeddial.id,!0),e.stopPropagation(),e.preventDefault())};createSpeedDialSet=async()=>{const e=await this.bookmarkActions.create({parentId:en.ZP.getRootId(),title:en.ZP.getDefaultFolderName()});e&&this.bookmarkActions.update(e.id,{speeddial:!0}).then((e=>{this.setState({initialEditSpeedDialSet:e.id})}))};openMenuItem=(e,t,n)=>{this.props.updatePageThumbnailWithActiveWebview(1e3);const i=t&&t.id&&t;this.jumpToTop(),this.setState({section:e,menuSpeeddial:i,currentSpeeddial:i})};isFolder=e=>!e.url;openFolder=(e,t)=>{!0===(t=t||{}).openInBackground?Jt.ZP.open(this.context.vivaldiWindowId,Jt.ZP.getBookmarksByNode(e),{inCurrent:!1,inBackground:!0,inNewWindow:!1,incognito:!1,allowOverride:!1},!0):(this.jumpToTop(),this.setState({currentSpeeddial:e},(()=>{this._speeddialview.current?.moveFocus("","current",!1),this.bookmarkActions.clearUndoStack()})))};openSpeedDialNode=(e,t)=>{t=t||{},this.isFolder(e)?this.openFolder(e,t):t.openInNewWindow?Ru.Z.openBrowserWindow(this.context.vivaldiWindowId,e.url,{incognito:t.incognito,transition:d.Z.historyPrivate.TransitionType.AUTO_BOOKMARK}):e.url&&Y.Z.openURL(this.context.vivaldiWindowId,e.url,{inCurrent:!t.openInNewTab,inBackground:t.openInBackground,bookmarkId:e.id,addOpenerTabId:!0,inSpecificPageId:t.openInNewTab?void 0:this.props.pageId,transition:d.Z.historyPrivate.TransitionType.AUTO_BOOKMARK})};setSpeedDialAwaitingEdit=e=>{this.setState({awaitingInitialEditId:e})};onSpeedDialDrawerDone=async e=>{if(!e)return void this.closeStartpageDrawer();const t=await this.bookmarkActions.create(e);if(!t)return void this.closeStartpageDrawer();const n=t.url;n?z.ZP.isIncognito(this.context.vivaldiWindowId)||Sj.updateForBookmark(t.id,n):this.setSpeedDialAwaitingEdit(t.id),this.showStartpageDrawer(!1,t.id)};customize=()=>{ie.Z.showSettings(this.context.vivaldiWindowId,"startpage")};renderSection=e=>{if(this.state.section===UE.Bookmarks)return r3;if(this.state.section===UE.History)return o3(_J,{pageId:this.props.pageId,keyAccess:this.props.prefValues[D.kKeyboardTabToAll],maxWidth:this.state.viewWidth,maxHeight:this.state.viewHeight});if(this.state.section===UE.SpeedDial)return this.state.bookmarksAvailable?(0,fn.jsx)(Q2,{ref:this._speeddialview,bookmarkActions:this.bookmarkActions,open:!0,cutIds:this.state.cutIds,speedDialNode:this.state.currentSpeeddial,speedDialSetNode:this.state.menuSpeeddial,speedDialSet:this.state.speeddialFolders,keyAccess:this.props.prefValues[D.kKeyboardTabToAll],drawerIsOpen:this.state.drawerIsOpen,maxWidth:this.state.viewWidth,maxHeight:this.state.viewHeight,openSpeedDialNode:this.openSpeedDialNode,toggleStartpageDrawer:this.toggleStartpageDrawer,onSetClipboardListener:this.onSetClipboardListener,incognito:e,setSpeedDialAwaitingEdit:this.setSpeedDialAwaitingEdit,awaitingInitialEditId:this.state.awaitingInitialEditId}):null;if(this.state.section===UE.Calendar)return o3(Vq,{windowId:this.context.vivaldiWindowId,pageId:this.props.pageId,url:this.props.url});if(this.state.section===UE.NotesManager){const e=new URL(this.props.url).searchParams.get("path")||"-1";return o3(U1,{id:e,pageId:this.props.pageId,isActive:this.props.isActive},`notes-manager-${this.props.pageId}`)}return console.warn("Unknown Startpage Section: ",this.state.section),null};getContextMenuItems=e=>{const t=this.context.vivaldiWindowId,n=!1===this.state.drawerIsOpen&&Boolean(this.state.currentSpeeddial)&&!1===z.ZP.isGuestSession(this.context.vivaldiWindowId),i=!1===this.state.drawerIsOpen&&!this.state.currentSpeeddial&&!1===z.ZP.isGuestSession(this.context.vivaldiWindowId),s=Ai.getOptionFunction(e);return Ai.getNamedMenu(t,e,(async e=>{switch(e.action){case"CONTEXT_ADD_BOOKMARK_TO_SPEEDDIAL":return{handler:this.toggleStartpageDrawer,visible:n,...s(t,e,{})};case"CONTEXT_ADD_FOLDER_TO_SPEEDDIAL":return{handler:this.createSpeedDialSet,visible:i,...s(t,e,{})};case"CONTEXT_PASTE":return{handler:this.handlePaste,...s(t,e,{})};case"CONTEXT_CUSTOMIZE":return{handler:this.customize,visible:!z.ZP.isGuestSession(this.context.vivaldiWindowId),...s(t,e,{})};default:return Promise.resolve({...s(t,e,{})})}}))};onContextMenu=e=>{e.persist(),e.preventDefault(),e.stopPropagation(),this.getContextMenuItems("startpage").then((t=>{(0,zi.Z)(this.context.vivaldiWindowId,t)(e)}))};render(){if(!this.props.open)return null;const e=z.ZP.isIncognito(this.context.vivaldiWindowId);return o3(ts,{className:"startpage",onResize:this.onResize},void 0,("on"===this.props.prefValues[D.kStartpageNavigation]||"speed_dial_only"===this.props.prefValues[D.kStartpageNavigation]&&this.state.section===UE.SpeedDial)&&o3(n3,{openMenuItem:this.openMenuItem,section:this.state.section,speedDialSet:this.state.speeddialFolders,speedDialSetNode:this.state.menuSpeeddial,createSpeedDialSet:this.createSpeedDialSet,initialEditSpeedDialSet:this.state.initialEditSpeedDialSet,setSpeedDialAwaitingEdit:this.setSpeedDialAwaitingEdit,keyAccess:this.props.prefValues[D.kKeyboardTabToAll]}),o3("div",{className:"startpage-content",onContextMenu:this.state.section===UE.SpeedDial?this.onContextMenu:null,onDoubleClick:this.handleDoubleClick},void 0,(0,fn.jsx)("div",{className:"sdwrapper",ref:this.refSDdWrapper,children:this.renderSection(e)}),this.state.section===UE.SpeedDial&&this.props.prefValues[D.kStartpageSpeedDialGameButtonShow]&&l3),o3(s3.Z,{className:"startpage-drawer-wrapper"},void 0,this.state.section===UE.SpeedDial&&this.state.drawerIsOpen&&o3(Wr.Z,{classNames:"startpage-drawer-transition",timeout:{enter:500,exit:200}},void 0,o3(X1,{node:this.state.currentSpeeddial,keyAccess:this.props.prefValues[D.kKeyboardTabToAll],maxWidth:this.state.viewWidth,onSpeedDialDrawerDone:this.onSpeedDialDrawerDone}))))}}const c3=(0,fs.Z)(d3,a3);var h3;function p3(e,t,n,i){h3||(h3="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:h3,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const u3=[cn.mgF,cn.jtA,cn.PaK,cn.CLf,cn.bcq,cn.yt5,cn.izi,cn.hcy,cn.lvj,cn.cyI,cn.LaO,cn.bqs,cn.NxY,cn.zAT,cn.P3X,cn.ZU6,cn.JJT,cn.wp6,cn.hYC,cn.Xgf,cn.ySD,cn.cMC],g3={small:"toolbar toolbar-statusbar",medium:"toolbar toolbar-default",large:"toolbar toolbar-mainbar"};class m3 extends tn.PureComponent{render(){return(0,fn.jsxs)(fn.Fragment,{children:[p3("h1",{},void 0,(0,le.Z)("Toolbar Test Page")),p3("div",{},void 0,Object.keys(g3).map((e=>p3("div",{className:g3[e]},e,u3.map(((t,n)=>p3(sl,{tooltip:"Test for icon",image:t[e]},n)))))))]})}}var v3;function f3(e,t,n,i){v3||(v3="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:v3,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var y3=f3((0,fs.Z)(m3,[]),{});class w3 extends tn.PureComponent{static contextType=dn.Z;state={windowStyle:P.Z.getState().windowStyles.get(this.context.vivaldiWindowId)||{}};componentDidMount(){P.Z.addListener(this.onThemeStoreChanged)}componentWillUnmount(){P.Z.removeListener(this.onThemeStoreChanged)}onThemeStoreChanged=()=>{const e=P.Z.getState().windowStyles.get(this.context.vivaldiWindowId);this.setState({windowStyle:e})};render(){const e=Object.entries(this.state.windowStyle),t=e.filter((([e,t])=>e.includes("colorSuccess")||e.includes("colorWarning")||e.includes("colorError"))),n=e.filter((([e,t])=>e.includes("radius"))),i=e.filter((([e,t])=>e.includes("colorBg"))),s=e.filter((([e,t])=>e.includes("colorFg"))),o=e.filter((([e,t])=>e.includes("colorAccent"))),a=e.filter((([e,t])=>e.includes("colorHighlight"))),r=e.filter((([e,t])=>e.includes("colorBorder")));return f3("div",{className:"theme-test",tabIndex:"0"},void 0,y3,f3("h1",{},void 0,(0,le.Z)("Theme Color Test Page")),f3("p",{},void 0,(0,le.Z)("$1 color and $2 radius variables created",[Object.entries(this.state.windowStyle).length,n.length])),f3("div",{},void 0,f3("h2",{},void 0,`${(0,le.Z)("Info Colors")} (${t.length})`),f3("div",{className:"list"},void 0,t.map((([e,t])=>f3("div",{style:{backgroundColor:t}},e,f3("input",{type:"text",value:e,readOnly:!0}),f3("input",{type:"text",value:t,readOnly:!0})))))),f3("div",{},void 0,f3("h2",{},void 0,`${(0,le.Z)("Foreground Colors")} (${s.length})`),f3("div",{className:"list"},void 0,s.map((([e,t])=>f3("div",{style:{backgroundColor:t}},e,f3("input",{type:"text",value:e,readOnly:!0}),f3("input",{type:"text",value:t,readOnly:!0})))))),f3("div",{},void 0,f3("h2",{},void 0,`${(0,le.Z)("Background Colors")} (${i.length})`),f3("div",{className:"list"},void 0,i.map((([e,t])=>f3("div",{style:{backgroundColor:t}},e,f3("input",{type:"text",value:e,readOnly:!0}),f3("input",{type:"text",value:t,readOnly:!0})))))),f3("div",{},void 0,f3("h2",{},void 0,`${(0,le.Z)("Border Colors")} (${r.length})`),f3("div",{className:"list"},void 0,r.map((([e,t])=>f3("div",{style:{backgroundColor:t}},e,f3("input",{type:"text",value:e,readOnly:!0}),f3("input",{type:"text",value:t,readOnly:!0})))))),f3("div",{},void 0,f3("h2",{},void 0,`${(0,le.Z)("Accent Colors")} (${o.length})`),f3("div",{className:"list"},void 0,o.map((([e,t])=>f3("div",{style:{backgroundColor:t}},e,f3("input",{type:"text",value:e,readOnly:!0}),f3("input",{type:"text",value:t,readOnly:!0})))))),f3("div",{},void 0,f3("h2",{},void 0,`${(0,le.Z)("Highlight Colors")} (${a.length})`),f3("div",{className:"list"},void 0,a.map((([e,t])=>f3("div",{style:{backgroundColor:t}},e,f3("input",{type:"text",value:e,readOnly:!0}),f3("input",{type:"text",value:t,readOnly:!0})))))),f3("div",{},void 0,f3("h2",{},void 0,`${(0,le.Z)("Border radius")} (${n.length})`),f3("div",{className:"list"},void 0,n.map((([e,t])=>f3("div",{style:{radius:t}},e,f3("input",{type:"text",value:e,readOnly:!0}),f3("input",{type:"text",value:t,readOnly:!0})))))))}}const b3=w3;var C3;function S3(e,t,n,i){C3||(C3="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:C3,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var T3=S3("div",{className:"card-outline"});class I3 extends tn.Component{render(){const e=this.props.style||{};return this.props.backgroundImage&&(e.backgroundImage=`url(${this.props.backgroundImage})`),S3("button",{className:mn()({"welcome-card":!0,"card-has-background":this.props.backgroundImage,"card-has-image-zoom":this.props.hasImageZoom,"card-is-done":this.props.done,"card-is-selected":this.props.selected}),disabled:this.props.done,onClick:this.props.onClick,title:this.props.tooltip?this.props.title+"\n"+this.props.tooltip:this.props.title,style:e},void 0,T3,this.props.image&&S3("div",{className:"card-image"},void 0,S3("img",{src:this.props.image,height:"78",width:"78"})),this.props.svg&&S3("div",{className:"card-image",dangerouslySetInnerHTML:{__html:this.props.svg}}),this.props.renderContent&&this.props.renderContent(),S3("div",{className:"card-text"},void 0,this.props.title))}}const k3=I3;var A3;function Z3(e,t,n,i){A3||(A3="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:A3,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const E3=[{names:["chrome"],imageName:"welcomepage-chrome.svg"},{names:["chromium"],imageName:"welcomepage-chromium.svg"},{names:["firefox"],imageName:"welcomepage-firefox.svg"},{names:["opera 12"],imageName:"welcomepage-opera-12.svg"},{names:["opera"],imageName:"welcomepage-opera.svg"},{names:["safari"],imageName:"welcomepage-safari.svg"},{names:["edge legacy"],imageName:"welcomepage-edge.svg"},{names:["explorer"],imageName:"welcomepage-explorer.svg"},{names:["vivaldi"],imageName:"welcomepage-vivaldi.svg"},{names:["brave"],imageName:"welcomepage-brave.svg"},{names:["edge"],imageName:"welcomepage-edge-chromium.svg"},{names:["yandex","яндекс"],imageName:"welcomepage-yandex.svg"}],_3=["safari","edge","explorer"],N3=["Thunderbird"];class M3 extends tn.Component{static contextType=dn.Z;constructor(e){super(e),this.state={error:null,profileStatus:[],profiles:[],toImport:[]}}componentDidMount(){d.Z.importData.getProfiles((e=>{this.setState({profileStatus:e.map((()=>"IDLE")),profiles:e})})),d.Z.importData.onImportEnded.addListener(this.onImportEnded)}componentWillUnmount(){d.Z.importData.onImportEnded.removeListener(this.onImportEnded)}toggleImport=e=>{const{toImport:t}=this.state;t.includes(e)?t.splice(t.indexOf(e),1):t.push(e),this.setState({toImport:t})};importSelected=()=>{this.startImport(this.state.toImport[0]),this.toggleImport(this.state.toImport[0])};onImportEnded=e=>{const t=this.state.profileStatus.concat([]);for(let n=0;n<this.state.profileStatus.length;n++)"STARTED"===t[n]&&(t[n]=0===e?"COMPLETED":"FAILED");0===e?this.setState({error:null,profileStatus:t}):this.setState({error:(0,le.Z)("An error occurred during import"),profileStatus:t}),this.state.toImport.length>0&&this.importSelected()};startImport(e){const t=this.state.profiles[e];let n="";t.UserProfiles&&t.UserProfiles[0]&&t.UserProfiles[0].profileName&&(n=t.UserProfiles[0].profileName),this.setState((t=>{const n=t.profileStatus.concat([]);return n[e]="STARTED",{profileStatus:n}}),(()=>{d.Z.importData.startImport([e.toString(),t.history.toString(),t.favorites.toString(),t.passwords.toString(),t.search.toString(),t.notes.toString(),true.toString(),n.toString(),t.speeddial.toString()],"","",Tl.default)}))}render(){return Z3("div",{className:"welcome-content-outer"},void 0,Z3("div",{className:"welcome-content-inner welcome-center-horizontal"},void 0,Z3("h1",{},void 0,this.props.title),Z3("p",{className:"no-bottom-margin"},void 0,(0,le.Z)("To import data from another browser, select it below and press Import.")),Z3("p",{},void 0,(0,le.Z)("For more choices see Import in the File menu or Quick Commands.")),Z3("div",{className:"cards-container"},void 0,this.state.profiles.map(((e,t)=>{const{name:n,imageName:i}=function(e){const t=e.toLowerCase();for(let e=0;e<E3.length;e++)for(let n=0;n<E3[e].names.length;n++)if(t.includes(E3[e].names[n]))return{name:E3[e].names[n],imageName:E3[e].imageName};return{name:e,imageName:""}}(e.name),s=this.state.profileStatus[t];return!e.hasDefaultInstall&&!_3.includes(n)||N3.includes(n)?null:Z3(k3,{done:"COMPLETED"===s,onClick:()=>this.toggleImport(t),selected:this.state.toImport.includes(t),title:"COMPLETED"===s?(0,le.Z)("Imported"):e.name,image:`resources/${i}`},t)}))),Z3("div",{className:"pad-top"},void 0,this.state.toImport.length?Z3("input",{type:"submit",className:"welcome-button",onClick:this.importSelected,value:(0,le.Z)("Import Selected")}):Z3("button",{tabIndex:0,className:"welcome-button primary",onClick:this.props.continue},void 0,(0,le.Z)("Continue"))),this.state.error&&Z3("p",{},void 0,this.state.error)))}}const P3=M3;var D3;function x3(e,t,n,i){D3||(D3="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:D3,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const O3=[D.kThemeScheduleEnabled,D.kThemeScheduleOS,D.kThemeScheduleTimeline,D.kThemesCurrent,D.kThemesSystem];class L3 extends tn.Component{toggleOSSchedule=()=>{const e="system"===this.props.prefValues[D.kThemeScheduleEnabled]?"off":"system";nt.Z.set(D.kThemeScheduleEnabled,e)};render(){const{prefValues:e}=this.props,t=Sl.Z.getCurrentIdWithoutPreview();return x3("div",{className:"welcome-content-outer"},void 0,x3("div",{className:"welcome-content-inner welcome-center-horizontal"},void 0,x3("h1",{},void 0,this.props.title),x3("p",{},void 0,(0,le.Z)("Vivaldi will by default change colors with the operating system. For more themes, to create your own and more fine-grained control head over to Settings.")),x3("label",{className:"welcome-pref-checkbox"},void 0,x3(hI,{value:"system",checked:"system"===e[D.kThemeScheduleEnabled],onChange:this.toggleOSSchedule}),x3("span",{},void 0,(0,le.Z)("Use Operating System Theme"))),x3("div",{className:"cards-container"},void 0,e[D.kThemesSystem].slice(0,8).map((e=>{const n=e.id===t,i=mn()("ThemePreview","ThemePreview-Welcome","welcome-card",{"card-is-selected":n});return x3("div",{onClick:()=>Sl.Z.setTheme(e.id)},e.id,x3(HG,{className:i,theme:e,welcomePage:!0,isCurrent:!1,isSystem:!0}))}))),x3("button",{tabIndex:0,className:"welcome-button primary",onClick:this.props.continue},void 0,this.props.continueText)))}}const R3=(0,fs.Z)(L3,O3);var B3;function F3(e,t,n,i){B3||(B3="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:B3,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const U3=[D.kTabsBarPosition],V3={top:{title:(0,le.Z)("Top"),image:n(48753)},left:{title:(0,le.Z)("Left"),image:n(31614)},bottom:{title:(0,le.Z)("Bottom"),image:n(34511)},right:{title:(0,le.Z)("Right"),image:n(76201)}};class W3 extends tn.Component{setPosition=e=>{nt.Z.set(D.kTabsBarPosition,e)};render(){return F3("div",{className:"welcome-content-outer"},void 0,F3("div",{className:"welcome-content-inner welcome-center-horizontal"},void 0,F3("h1",{},void 0,this.props.title),F3("p",{},void 0,(0,le.Z)("Where would you like your Tab Bar? Experiment with the options below to find a layout that fits.")),F3("div",{className:"cards-container"},void 0,Object.keys(V3).map((e=>F3(k3,{onClick:this.setPosition.bind(this,e),title:V3[e].title,selected:e===this.props.prefValues[D.kTabsBarPosition],svg:V3[e].image},e)))),F3("button",{tabIndex:0,className:"welcome-button primary",onClick:this.props.continue},void 0,this.props.continueText)))}}const H3=(0,fs.Z)(W3,U3);var z3;function G3(e,t,n,i){z3||(z3="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:z3,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class $3 extends tn.Component{static contextType=dn.Z;render(){const e=this.context.vivaldiWindowId;return G3("div",{className:"welcome-content-outer"},void 0,G3("div",{className:"welcome-content-inner welcome-center-horizontal"},void 0,G3("h1",{},void 0,this.props.title),G3("p",{},void 0,(0,le.Z)("Want to get the most out of your new browser? Here are three popular features you can try right away. To see other helpful features, head over to vivaldi.com")),G3("div",{className:"cards-container welcome-intouch"},void 0,G3(k3,{onClick:()=>{Y.Z.openURL(e,"http://vvld.in/welcomepage-notes")},svg:n(17349),title:(0,le.Z)("Notes")}),G3(k3,{onClick:()=>{Y.Z.openURL(e,"http://vvld.in/welcomepage-webpanels")},svg:n(33427),title:(0,le.Z)("Web Panels")}),G3(k3,{onClick:()=>{Y.Z.openURL(e,"http://vvld.in/welcomepage-tabtiling")},svg:n(4798),title:(0,le.Z)("Tab Tiling")})),G3("button",{tabIndex:0,className:"welcome-button primary",onClick:this.props.continue},void 0,this.props.continueText)))}}const K3=$3;var j3;function Y3(e,t,n,i){j3||(j3="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:j3,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var X3=Y3("br",{});class Q3 extends tn.Component{state={trackerBlockingEnabled:!1,adBlockingEnabled:!1};componentDidMount(){this.updateRules(),d.Z.contentBlocking.onStateChanged.addListener(this.updateRules)}componentWillUnmount(){d.Z.contentBlocking.onStateChanged.removeListener(this.updateRules)}updateRules=()=>{["ad_blocking","tracking"].forEach((e=>{d.Z.contentBlocking.getActiveExceptionsList(e,(t=>{const n="tracking"===e?"trackerBlockingEnabled":"adBlockingEnabled";this.setState({[n]:"exempt_list"===t})}))}))};setNoBlocking=()=>{d.Z.contentBlocking.setActiveExceptionsList("tracking","process_list"),d.Z.contentBlocking.setActiveExceptionsList("ad_blocking","process_list"),this.updateRules()};setTrackerBlocking=()=>{d.Z.contentBlocking.setActiveExceptionsList("tracking","exempt_list"),d.Z.contentBlocking.setActiveExceptionsList("ad_blocking","process_list"),this.updateRules()};setTrackerAndAdBlocking=()=>{d.Z.contentBlocking.setActiveExceptionsList("tracking","exempt_list"),d.Z.contentBlocking.setActiveExceptionsList("ad_blocking","exempt_list"),this.updateRules()};getBlockLevel=()=>{let e=0;return this.state.trackerBlockingEnabled&&(e=1),this.state.trackerBlockingEnabled&&this.state.adBlockingEnabled&&(e=2),e};render(){const e=this.getBlockLevel();return Y3("div",{className:"welcome-content-outer"},void 0,Y3("div",{className:"welcome-content-inner welcome-center-horizontal"},void 0,Y3("h1",{},void 0,this.props.title),Y3("p",{},void 0,(0,le.Z)("Vivaldi has a built-in Tracker and Ad blocker to protect your privacy."),X3,(0,le.Z)("Select default level of protection.")),Y3("div",{className:"cards-container"},void 0,Y3(k3,{onClick:this.setNoBlocking,title:(0,le.Z)("No Blocking"),hasImageZoom:!0,tooltip:(0,le.Z)("No content blocking will be applied to any site by default."),selected:0===e,svg:cn.IuZ,style:{"--shieldOpacity":0,"--shieldInnerOpacity":0}}),Y3(k3,{onClick:this.setTrackerBlocking,title:(0,le.Z)("Block Trackers"),hasImageZoom:!0,tooltip:(0,le.Z)("Online trackers collect personal information and browsing habits across multiple sites."),selected:1===e,svg:cn.IuZ,style:{"--shieldOpacity":0,"--shieldInnerOpacity":.65}}),Y3(k3,{onClick:this.setTrackerAndAdBlocking,title:(0,le.Z)("Block Trackers and Ads"),hasImageZoom:!0,tooltip:(0,le.Z)("Web advertisement supports existence of many sites but can also be used to build a personal profile for monetization."),selected:2===e,svg:cn.IuZ,style:{"--shieldOpacity":.65,"--shieldInnerOpacity":0}})),Y3("button",{tabIndex:0,className:"welcome-button primary",onClick:this.props.continue},void 0,this.props.continueText)))}}const q3=Q3;var J3;function e5(e,t,n,i){J3||(J3="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:J3,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const t5={tracking:(0,le.Z)("Does not track you"),adblock:(0,le.Z)("Ad and Tracker Blocker"),translations:(0,le.Z)("Translations"),panels:(0,le.Z)("Panels"),statusbar:(0,le.Z)("Status bar"),fastforward:(0,le.Z)("Fast Forward / Rewind"),mail:(0,le.Z)("Mail"),calendar:(0,le.Z)("Calendar"),feeds:(0,le.Z)("Feeds")};var n5=e5("div",{className:"card-outline"});const i5=({featureList:e,image:t,onClick:n,selected:i,title:s,style:o})=>e5("button",{onClick:n,className:mn()("welcome-feature-card",{"feature-card-is-selected":i}),style:o},void 0,n5,e5("img",{className:"card-image",src:t,width:"280",height:"210"}),e5("h2",{},void 0,s),e5("ul",{},void 0,Object.keys(t5).map((t=>e5("li",{className:mn()("welcome-feature-card-feature",{"welcome-feature-card-feature-enabled":e.includes(t)})},t,t5[t])))));var s5;function o5(e,t,n,i){s5||(s5="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:s5,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const a5=["Rewind","FastForward","SearchField"],r5=["DownloadButton"],l5={essentials:(0,le.Z)("Want to get away from your current browser, but not ready to learn a lot of new stuff? Essentials is for you. We hide a lot of the Vivaldi functionality. It’s there if you need it, but not visible. You still get Ad and Tracker Blocking as well as translations... and a browser that does not track you."),classic:(0,le.Z)("Looking for some new things to play with? Get Classic. The Status Bar and Panel give you easy access to a bunch of new functionality like Capture, Notes, Tab Tiling and Web Panels."),fullyLoaded:(0,le.Z)("Fully Loaded includes everything from Essentials & Classic, as well as a built-in Mail client, Calendar and Feeds.")},d5={essentials:["tracking","adblock","translations"],classic:["tracking","adblock","translations","panels","statusbar","fastforward"],fullyLoaded:["tracking","adblock","translations","panels","statusbar","fastforward","mail","calendar","feeds"]},c5={essentials:"/resources/illustration-essentials-light@2x.png",classic:"/resources/illustration-creative-light@2x.png",fullyLoaded:"/resources/illustration-fully-loaded-light@2x.png"},h5={essentials:"/resources/illustration-essentials-dark@2x.png",classic:"/resources/illustration-creative-dark@2x.png",fullyLoaded:"/resources/illustration-fully-loaded-dark@2x.png"},p5=[D.kMailIsTurnedOff,D.kPanelsState,D.kStatusBarDisplay,D.kToolbarsNavigation];function u5(e,t,n){const i=LS.ZP.fgBgHighlight(e,t,n),s={};return Object.keys(i).forEach((e=>{s[`--${e}`]=i[e]})),s}class g5 extends tn.Component{static contextType=dn.Z;constructor(e,t){super(e),this.winId=t.vivaldiWindowId;let n=Dl.ZP.getSelectedPanel(t.vivaldiWindowId);n||(n=Dl.ZP.getIsBarVisible(t.vivaldiWindowId)?"switcher":"hidden"),this.prevMailIsTurnedOff=e.prefValues[D.kMailIsTurnedOff],this.prevToolbarsNavigation=e.prefValues[D.kToolbarsNavigation],this.prevPanelVisibility=n,this.prevStatusBarDisplay=e.prefValues[D.kStatusBarDisplay],this.state={baseColors:P.Z.getBaseStyles(["colorFg","colorBg"])}}componentDidMount(){P.Z.addListener(this.onThemeStoreChanged)}componentWillUnmount(){P.Z.removeListener(this.onThemeStoreChanged)}onThemeStoreChanged=()=>{const e=P.Z.getBaseStyles(["colorFg","colorBg"]);e!==this.state.baseColors&&this.setState({baseColors:e})};revertUI=()=>{nt.Z.set(D.kToolbarsNavigation,this.prevToolbarsNavigation),nt.Z.set(D.kMailIsTurnedOff,this.prevMailIsTurnedOff),nt.Z.set(D.kStatusBarDisplay,this.prevStatusBarDisplay),"hidden"===this.prevPanelVisibility&&Dl.ZP.getIsBarVisible(this.winId)?Ho.Z.togglePanel(this.winId):"switcher"===this.prevPanelVisibility?(Ho.Z.showContent(this.winId,Dl.ZP.getDefaultPanel()),Ho.Z.setContentVisible(this.winId,!1)):setTimeout((()=>{"hidden"!==this.prevPanelVisibility&&"switcher"!==this.prevPanelVisibility&&Ho.Z.showContent(this.winId,this.prevPanelVisibility)}),32)};getIsUIUnchanged=()=>{const e=this.props.prefValues;let t=Dl.ZP.getSelectedPanel(this.winId);return t||(t=Dl.ZP.getIsBarVisible(this.winId)?"switcher":"hidden"),e[D.kMailIsTurnedOff]===this.prevMailIsTurnedOff&&(0,Sm.default)(e[D.kToolbarsNavigation],this.prevToolbarsNavigation)&&e[D.kStatusBarDisplay]===this.prevStatusBarDisplay&&t===this.prevPanelVisibility};getUIMode=()=>{const e=this.props.prefValues[D.kMailIsTurnedOff],t=this.props.prefValues[D.kPanelsState].barVisible;return!t&&e?"essentials":t&&e?"classic":t&&!e?"fullyLoaded":void 0};setEssentials=()=>{const e=M.Z.getDefault(D.kToolbarsNavigation).filter((e=>!a5.includes(e)));nt.Z.set(D.kToolbarsNavigation,e),nt.Z.set(D.kStatusBarDisplay,"off"),nt.Z.set(D.kPanelsTranslateRedirect,!1),nt.Z.set(D.kMailIsTurnedOff,!0),Dl.ZP.getIsBarVisible(this.winId)&&Ho.Z.togglePanel(this.winId)};setClassic=()=>{const e=M.Z.getDefault(D.kToolbarsNavigation).filter((e=>!r5.includes(e)));nt.Z.set(D.kToolbarsNavigation,e),nt.Z.set(D.kMailIsTurnedOff,!0),nt.Z.set(D.kStatusBarDisplay,"on"),nt.Z.set(D.kPanelsTranslateRedirect,!0),Ho.Z.showContent(this.winId,Dl.ZP.getDefaultPanel()),Ho.Z.setContentVisible(this.winId,!1)};setFullyLoaded=()=>{const e=M.Z.getDefault(D.kToolbarsNavigation).filter((e=>!r5.includes(e)));nt.Z.set(D.kToolbarsNavigation,e),nt.Z.set(D.kMailIsTurnedOff,!1),nt.Z.set(D.kStatusBarDisplay,"on"),nt.Z.set(D.kPanelsTranslateRedirect,!0),setTimeout((()=>Ho.Z.showContent(this.winId,"mail")),32)};render(){const e=this.getUIMode(),t=Dr()(String(this.state.baseColors["--colorFg"])),n=Dr()(String(this.state.baseColors["--colorBg"])),i=t.luminance()>LS.$J?h5:c5,s=u5(t,n,Dr()("#4c70f0")),o=u5(t,n,Dr()("#43c774")),a=u5(t,n,Dr()("#EF3939"));return o5("div",{className:"welcome-content-outer"},void 0,o5("div",{className:mn()({"welcome-content-inner":!0,"welcome-center-horizontal":!0,"welcome-center-vertical":!0})},void 0,o5("h1",{},void 0,this.props.title),o5("p",{style:{maxWidth:"75ch",minHeight:"5em",opacity:.75}},void 0,e?l5[e]:(0,le.Z)("From a focused, minimalist experience to a full-on browsing powerhouse – take your pick below to get started.")),o5("div",{className:"feature-cards-container"},void 0,o5(i5,{onClick:this.setEssentials,title:(0,le.Z)("Essentials"),featureList:d5.essentials,selected:"essentials"===e,image:i.essentials,style:s}),o5(i5,{onClick:this.setClassic,title:(0,le.Z)("Classic"),featureList:d5.classic,selected:"classic"===e,image:i.classic,style:o}),o5(i5,{onClick:this.setFullyLoaded,title:(0,le.Z)("Fully Loaded"),featureList:d5.fullyLoaded,selected:"fullyLoaded"===e,image:i.fullyLoaded,style:a})),o5("button",{tabIndex:0,disabled:this.getIsUIUnchanged(),className:"welcome-button",onClick:this.revertUI},void 0,(0,le.Z)("Revert")),o5("button",{tabIndex:0,className:"welcome-button primary",onClick:this.props.continue},void 0,this.props.continueText)))}}const m5=(0,fs.Z)(g5,p5),v5={welcome_four:(0,le.Z)("How much Vivaldi do you want?"),import_data:(0,le.Z)("title","Import from Applications or Files"),tracker_and_ad:(0,le.Z)("browser","Tracker and Ad Blocking"),personalize:(0,le.Z)("Pick a Theme"),tabs:(0,le.Z)("Position Your Tabs"),touch:(0,le.Z)("Three Things to Try Right Away")},f5={getUnseenPageKeys:()=>Object.keys(v5).filter((e=>!M.Z.get(D.kWelcomeSeenPages).includes(e))),hasUnseenPages:()=>f5.getUnseenPageKeys().length>0,getUnreadPageKeys:()=>Object.keys(v5).filter((e=>!M.Z.get(D.kWelcomeReadPages).includes(e))),hasUnreadPages:()=>f5.getUnreadPageKeys().length>0,markAllAsSeen:()=>{const e=M.Z.get(D.kWelcomeSeenPages),t=f5.getUnseenPageKeys();nt.Z.set(D.kWelcomeSeenPages,e.concat(t))}},y5=f5;var w5;function b5(e,t,n,i){w5||(w5="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:w5,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const C5=[D.kWelcomeReadPages];var S5=b5("svg",{className:"guest-intro-background",viewBox:"0 0 1244 860"},void 0,b5("path",{fill:"url(#guest-intro-bg-gradient)",d:"M0 0h153.513c16.141 27.93 32.15 55.734 47.912 83.11 16.086 27.94 32.722 56.832 49.076 85.128 11.01 19.031 22.079 38.316 32.781 56.967 25.186 43.883 51.228 89.259 77.402 132.848 33.382 55.651 75.894 82.121 137.77 85.829 3.205.192 6.454.288 9.655.288 39.673 0 78.14-14.461 108.316-40.722 21.644-18.834 48.687-52.291 54.604-104.667.749-6.654 1.357-13.708 1.855-19.573-1.07-29.74-6.476-52.92-17.294-74.518C622.935 139.46 612.708 67.99 625.087 0h136.676C747.1 44.93 749.845 96.364 774.32 145.251c20.839 41.6 30.654 85.7 31.485 138.023-.568 6.192-1.472 18.273-2.83 30.356-17.572 155.524-149.172 263.318-294.866 263.318-5.816 0-11.67-.173-17.526-.521C382.84 569.97 301.9 518.174 246.822 426.358c-38.015-63.313-74.255-127.68-111.253-191.634C90.359 156.507 45.49 78.062 0 0zm1113.47 0H1244v140.1c-7.496 27.86-18.849 54.995-34.031 81.275a1299530.57 1299530.57 0 0 1-170.255 294.799A1223193.145 1223193.145 0 0 0 841.018 860.24H687.72c135.675-235.123 271.527-470.147 407.26-705.25 22.311-38.621 31.22-79.696 25.368-124.548A170.12 170.12 0 0 0 1113.471 0z"}));function T5(e){return b5("div",{className:"guest-intro"},void 0,S5,b5("div",{className:"guest-intro-content"},void 0,b5("h1",{},void 0,(0,le.Z)("Welcome Page Unavailable")),b5("p",{},void 0,(0,le.Z)("Welcome page is not available in guest windows.")),b5("p",{},void 0,b5("a",{tabIndex:0,href:hk,onClick:t=>pk(e.windowId,t)},void 0,(0,le.Z)("Learn more about Guest Profiles")))))}class I5 extends tn.Component{static contextType=dn.Z;nodeRef=tn.createRef();constructor(e){super(e);const t=this.getNextUnread(),n=Object.keys(v5);this.state={currentPageKey:t||n[n.length-1]},y5.markAllAsSeen()}setPage=e=>()=>{this.scrollToTop(),this.setState({currentPageKey:e})};getNextUnread=e=>{const t=Object.keys(v5),n=this.props.prefValues[D.kWelcomeReadPages],i=e?t.indexOf(e):-1;for(let e=-1;e<t.length;e++){const s=e+1;if(t[s]&&!n.includes(t[s])&&s>i)return t[s]}return y5.getUnreadPageKeys()[0]};getNextPageKey=()=>{const e=Object.keys(v5);return e.find(((t,n)=>this.state.currentPageKey===e[n-1]))};setCurrentPageRead=()=>{const e=this.props.prefValues[D.kWelcomeReadPages],t=this.state.currentPageKey;e.includes(t)||nt.Z.set(D.kWelcomeReadPages,e.concat([t]))};setAllPagesRead=()=>{const e=this.context.vivaldiWindowId,t=y5.getUnreadPageKeys(),n=this.props.prefValues[D.kWelcomeReadPages];nt.Z.set(D.kWelcomeReadPages,n.concat(t)),Y.Z.openURL(e,W.Z.getDefaultStartpage(e),{inCurrent:!0})};continue=()=>{if(this.setCurrentPageRead(),y5.getUnreadPageKeys().length>0)this.scrollToTop(),this.setState((e=>({currentPageKey:this.getNextUnread(e.currentPageKey)})));else{const e=this.context.vivaldiWindowId;Y.Z.openURL(e,W.Z.getDefaultStartpage(e),{inCurrent:!0})}};nextPage=()=>{this.scrollToTop(),this.setState({currentPageKey:this.getNextPageKey()})};getContinueText=()=>{const e=y5.getUnreadPageKeys(),t=e.length,n=!e.includes(this.state.currentPageKey);return t===Object.keys(v5).length-1&&this.state.currentPageKey===Object.keys(v5)[0]?(0,le.Z)("Let’s Go"):t>1||1===t&&n?(0,le.Z)("Continue"):(0,le.Z)("Finish")};scrollToTop=()=>{const{Element:e}=this.context,t=this.nodeRef.current?.firstChild;t instanceof e&&t.scrollTo({behavior:"smooth",top:0})};render(){if(z.ZP.isGuestSession(this.context.vivaldiWindowId))return b5(T5,{windowId:this.context.vivaldiWindowId});const e=this.getContinueText(),t="personalize"===this.state.currentPageKey,{prefValues:n}=this.props,i={enter:1e3,exit:1e3};return(0,fn.jsxs)("div",{ref:this.nodeRef,className:mn()("welcome-wrapper",{"welcome-soft-background":!t}),children:[b5(s3.Z,{className:"welcome-content"},void 0,"welcome_four"===this.state.currentPageKey&&b5(Wr.Z,{classNames:"welcome-page",timeout:i},void 0,b5(m5,{continue:this.continue,continueText:e,setAllPagesRead:this.setAllPagesRead,title:v5[this.state.currentPageKey]})),"tracker_and_ad"===this.state.currentPageKey&&b5(Wr.Z,{classNames:"welcome-page",timeout:i},void 0,b5(q3,{continue:this.continue,continueText:e,title:v5[this.state.currentPageKey]})),"import_data"===this.state.currentPageKey&&b5(Wr.Z,{classNames:"welcome-page",timeout:i},void 0,b5(P3,{continue:this.continue,continueText:e,title:v5[this.state.currentPageKey]})),"personalize"===this.state.currentPageKey&&b5(Wr.Z,{classNames:"welcome-page",timeout:i},void 0,b5(R3,{continue:this.continue,continueText:e,title:v5[this.state.currentPageKey]})),"tabs"===this.state.currentPageKey&&b5(Wr.Z,{classNames:"welcome-page",timeout:i},void 0,b5(H3,{continue:this.continue,continueText:e,title:v5[this.state.currentPageKey]})),"touch"===this.state.currentPageKey&&b5(Wr.Z,{classNames:"welcome-page",timeout:i},void 0,b5(K3,{continue:this.continue,continueText:e,title:v5[this.state.currentPageKey]}))),b5("div",{className:"welcome-navigation"},void 0,Object.keys(v5).map((e=>b5("button",{onClick:this.setPage(e),title:v5[e],tabIndex:-1,className:mn()("nav-page",{"nav-page-current":e===this.state.currentPageKey,"nav-page-completed":e!==this.state.currentPageKey&&n[D.kWelcomeReadPages].includes(e)})},e))))]})}}var k5;function A5(e,t,n,i){k5||(k5="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:k5,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var Z5=A5((0,fs.Z)(I5,C5),{},"welcome"),E5=A5(b3,{},"welcome"),_5=A5(dk,{},"experiments"),N5=A5(mk,{},"guest-intro"),M5=A5(LE,{},"private-intro"),P5=A5(ST,{},"actionlog"),D5=A5(FE,{}),x5=A5("div",{},"mailmessage"),O5=A5("div",{},"chat");class L5 extends tn.PureComponent{static contextType=dn.Z;refComponent=tn.createRef();focus=()=>{const e=this.refComponent.current;if(!(e instanceof this.context.HTMLDivElement))return;if(e.contains(this.context.document.activeElement))return;const t=e.querySelector('[tabindex="0"]:not(.no-page-focus)');t?.focus()};getComponent=()=>{const{url:e}=this.props;if(St.jk.matchInternal("welcome",e))return Z5;if(St.jk.matchInternal("themecolors",e))return E5;if(St.jk.matchInternal("settings",e))return A5(ij,{url:e},"settings");if(St.jk.matchInternal("experiments",e))return _5;if(St.jk.matchInternal("guest-intro",e))return N5;if(St.jk.matchInternal("private-intro",e))return M5;if(St.jk.matchInternal("actionlog",e))return P5;if(St.jk.matchInternal("saga",e))return D5;if(St.jk.matchInternal("mailpage",e)){if(M.Z.get(D.kMailIsTurnedOff))return A5(eA,{windowId:this.context.vivaldiWindowId});if(St.jk.matchUrl(St.jk.internalUrl("mailpage","composer"),e)){const t=(0,Ni.DP)(e);let n;if(t.query)try{const e=JSON.parse(t.query);"object"==typeof e&&(n=e.id)}catch(e){console.warn(e)}return A5(Qk,{id:n,mailto:t.mailto,url:e,isActive:this.props.isActive},"mail")}if(St.jk.matchUrl(St.jk.internalUrl("mailpage","message"),e)){let t=-1;const n=(0,Ni.DP)(e);if(n.path){const e=n.path.split("/");2===e.length&&(t=parseInt(e[1]))}return t>-1?A5(DZ,{id:t,isActive:this.props.isActive},"mailmessage"):x5}return z.ZP.isMail(this.context.vivaldiWindowId)?A5(EE,{id:this.props.pageId,isActive:this.props.isActive},"mailview"):A5("div",{className:"mail-onboarding-wrapper"},"mailview",A5("div",{className:"mail-onboarding"},void 0,A5("h1",{},void 0,(0,le.Z)("Mail is in Another Window")),A5("p",{},void 0,(0,le.Z)("The Vivaldi email client runs in a single window at a time."))))}if(St.jk.matchInternal("chat",e)){const t=new URL(e).searchParams.get("path");t&&t.includes("@");return O5}return null};render(){const{isVisible:e,url:t}=this.props;let n=UE.SpeedDial;const i=St.jk.isStartPage(t);return i&&(St.jk.matchInternal("bookmarks",t)?n=UE.Bookmarks:St.jk.matchInternal("history",t)?n=UE.History:St.jk.matchInternal("calendar",t)?n=UE.Calendar:St.jk.matchInternal("notes",t)&&(n=UE.NotesManager)),(0,fn.jsx)("div",{className:"internal-page",ref:this.refComponent,children:(0,fn.jsxs)(fn.Fragment,{children:[A5(c3,{open:i&&e||n!==UE.SpeedDial,pageId:this.props.pageId,url:t,view:n,updatePageThumbnailWithActiveWebview:this.props.updatePageThumbnailWithActiveWebview,isActive:this.props.isActive},"startpage"),this.getComponent()]})})}}const R5=L5;class B5 extends Z.Z{getInitialState(){return new fa.D5}reduce(e,t){switch(t.actionType){case"PAGE_SET_MEDIASTATE":const{tabId:n,mediastate:i}=t;return function(e,t,n){const i=e.get(n);if(i){const s=i.intersect(t).union(t);return e.set(n,s)}return t.length>0?e.set(n,(0,fa.l4)(t)):e}(e,i,n);case"PAGE_CLOSE":return function(e,t){let n=e;return t.forEach((e=>{n.has(e.id)&&(n=n.remove(e.id))})),n}(e,t.pages);default:return e}}hasMediaState(e,t){const n=this.getState().get(e);return!!n&&n.has(t)}}const F5=new B5;const U5=new class{resetRssFeeds(e){l.Z.dispatch({actionType:"RSS_CLEAR_FEEDS",tabId:e})}initBrowserWindow(){y.Z.runtime.onMessage.addListener(((e,t,n)=>{if(!e||!e.feeds)return;const i=e.feeds,s=e.tabId;l.Z.dispatch({actionType:"RSS_FEEDS_FOUND",tabId:s,feeds:i})}))}initPortalDocument(){y.Z.runtime.onMessage.addListener(((t,n,i)=>{if(t)if(n.tab&&"number"==typeof n.tab.id&&"remove_this_preview"===t.command)y.Z.tabs.sendMessage(n.tab.id,{command:"remove_preview"});else if(n.tab&&"get_tab_url"===t.command)i(n.tab.url);else if(n.tab&&"get_content_type"===t.command){const t=void 0===n.tab.id?-1:n.tab.id;i(e.get(t)??"")}}));const e=new Map;y.Z.webRequest.onResponseStarted.addListener((t=>{if(-1===t.tabId)return void console.warn("RssDetectActions:","Should this be a chrome.runtime.lastError check instead?");const n=(t.responseHeaders||[]).reverse().find((e=>"content-type"===e.name.toLowerCase()));e.set(t.tabId,n?.value)}),{types:["main_frame"],urls:["http://*/*","https://*/*"]},["responseHeaders"]),y.Z.tabs.onRemoved.addListener((t=>e.delete(t)))}},V5=U5,W5=new class{setUtilityWebView(e,t){l.Z.dispatch({actionType:"UTILITY_WEBVIEW_SET_VIEW",windowId:e,webview:t})}};class H5 extends tn.PureComponent{refWebView=tn.createRef();componentDidMount(){const e=this.refWebView.current;e&&(e.addEventListener("close",this.handleClose),e.addEventListener("contentload",this.handleContentload),e.addEventListener("contentscreated",this.handleContentscreated),e.addEventListener("createsearch",this.handleCreatesearch),e.addEventListener("contentallowed",this.handleContentallowed),e.addEventListener("contentblocked",this.handleContentblocked),e.addEventListener("dialog",this.handleDialog),e.addEventListener("findupdate",this.handleFindupdate),e.addEventListener("fullscreen",this.handleFullscreen),e.addEventListener("loadabort",this.handleLoadabort),e.addEventListener("loadcommit",this.handleLoadcommit),e.addEventListener("loadprogress",this.handleLoadprogress),e.addEventListener("loadredirect",this.handleLoadredirect),e.addEventListener("loadstart",this.handleLoadstart),e.addEventListener("loadstop",this.handleLoadstop),e.addEventListener("newwindow",this.handleNewwindow),e.addEventListener("pasteandgo",this.handlePasteandgo),e.addEventListener("permissionrequest",this.handlePermissionrequest),e.addEventListener("sslstatechanged",this.handleSslstatechanged),e.addEventListener("targeturlchanged",this.handleTargetUrlChanged),e.addEventListener("windowblocked",this.handleWindowblocked),this.props.discarded&&this.props.isVisible&&y.Z.tabs.reload(this.props.id))}componentWillUnmount(){const e=this.refWebView.current;e&&(e.removeEventListener("close",this.handleClose),e.removeEventListener("contentload",this.handleContentload),e.removeEventListener("contentscreated",this.handleContentscreated),e.removeEventListener("createsearch",this.handleCreatesearch),e.removeEventListener("contentallowed",this.handleContentallowed),e.removeEventListener("contentblocked",this.handleContentblocked),e.removeEventListener("dialog",this.handleDialog),e.removeEventListener("findupdate",this.handleFindupdate),e.removeEventListener("fullscreen",this.handleFullscreen),e.removeEventListener("loadabort",this.handleLoadabort),e.removeEventListener("loadcommit",this.handleLoadcommit),e.removeEventListener("loadprogress",this.handleLoadprogress),e.removeEventListener("loadredirect",this.handleLoadredirect),e.removeEventListener("loadstart",this.handleLoadstart),e.removeEventListener("loadstop",this.handleLoadstop),e.removeEventListener("newwindow",this.handleNewwindow),e.removeEventListener("pasteandgo",this.handlePasteandgo),e.removeEventListener("permissionrequest",this.handlePermissionrequest),e.removeEventListener("sslstatechanged",this.handleSslstatechanged),e.removeEventListener("targeturlchanged",this.handleTargetUrlChanged),e.removeEventListener("windowblocked",this.handleWindowblocked))}componentDidUpdate(){this.props.discarded&&this.props.isVisible&&y.Z.tabs.reload(this.props.id)}handleClose=e=>{this.props.onClose?.(e)};handleContentload=e=>{this.props.onContentLoad?.(e)};handleContentscreated=e=>{this.props.onContentsCreated?.(e)};handleCreatesearch=e=>{this.props.onCreateSearch?.(e)};handleContentallowed=e=>{this.props.onContentAllowed?.(e)};handleContentblocked=e=>{this.props.onContentBlocked?.(e)};handleDialog=e=>{this.props.onDialog?.(e)};handleFindupdate=e=>{this.props.onFindUpdate?.(e)};handleFullscreen=e=>{this.props.onFullscreen?.(e)};handleLoadabort=e=>{this.props.onLoadAbort?.(e)};handleLoadcommit=e=>{this.props.onLoadCommit?.(e)};handleLoadprogress=e=>{this.props.onLoadProgress?.(e)};handleLoadredirect=e=>{this.props.onLoadRedirect?.(e)};handleLoadstart=e=>{this.props.onLoadStart?.(e)};handleLoadstop=e=>{this.props.onLoadStop?.(e)};handleNewwindow=e=>{this.props.onNewWindow?.(e)};handlePasteandgo=e=>{this.props.onPasteAndGo?.(e)};handlePermissionrequest=e=>{this.props.onPermissionRequest?.(e)};handleSslstatechanged=e=>{this.props.onSslStateChanged?.(e)};handleTargetUrlChanged=e=>{this.props.onTargetUrlChanged?.(e)};handleWindowblocked=e=>{this.props.onWindowBlocked?.(e)};canGoBack=()=>!!this.refWebView.current&&this.refWebView.current.canGoBack();canGoForward=()=>!!this.refWebView.current&&this.refWebView.current.canGoForward();executeScript=e=>new Promise(((t,n)=>{this.refWebView.current?.executeScript(e,(e=>{y.Z.runtime.lastError?n(y.Z.runtime.lastError.message):t(e)}))}));reload=()=>{this.refWebView.current?.reload()};stop=()=>{this.refWebView.current?.stop()};sendRequest=(e,t,n,i,s,o)=>{this.refWebView.current?.sendRequest(e,t,n,i,s,o)};render(){return(0,fn.jsx)("webview",{ref:this.refWebView,id:this.props.id,tab_id:this.props.id})}}function z5({winId:e,pageId:t,url:n,activeElement:i}){if(W.Z.getPageInWindow(e,t)?.isMailPage)return"";if(Bs.getCapturingState(e))return"capture";if("quick-command-search"===i?.className)return"quickCommands";let s=!1;try{s=!0===Hf.Z.getFindResultsForPage(t).isFindInPageToolbarOpen}catch(e){console.warn(e)}return!0===s?"findInPage":""}var G5,$5=n(60339),K5=n(34155);function j5(e,t,n,i){G5||(G5="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:G5,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Y5=[D.kMailIsTurnedOff,D.kRssDetectFeeds,D.kWebpagesReaderControls,D.kWebpagesReaderStyle],X5=(0,Zr.Z)((e=>e()));var Q5=j5(yU,{prefs:!1,filter:""});class q5 extends tn.PureComponent{static contextType=dn.Z;captureScheduled=!1;viewUnchangedFlags={};_localStatus=!1;_devtoolsCloseTimerId=0;_eventGuard=null;refInternalPage=tn.createRef();refWebview=tn.createRef();nodeRef=tn.createRef();constructor(e){super(e);const t=e.pinned&&M.Z.get(D.kTabsAlwaysLoadPinnedAfterRestore);this.state={draggedLength:null,customData:null,dockingState:"off",viewWidth:"auto",viewHeight:"auto",viewTop:0,viewLeft:0,hideInspectedContents:!1,disableWebviewEvents:!1,tabIsFullscreen:!1,mediaState:F5.getState().get(this.props.id)||(0,fa.l4)(),mountWebView:e.isVisible||!e.discarded||t}}componentDidMount(){this.attachEventHandlers(),this.updateFocus(this.props.id,this.props.url),this.props.isActive&&K5.nextTick((()=>{const e=this.getWebviewElement();e&&W5.setUtilityWebView(this.context.vivaldiWindowId,e)})),F5.addListener(this._onMediaStateStoreChanged)}componentDidUpdate(e,t){const{target:n}=this.props;if(n&&n!==e.target){const{transition:e,fromUrlField:t,postParams:i,headers:s}=n;this.props.url&&K5.nextTick((()=>{this.refWebview.current?.sendRequest(this.props.url,e,Boolean(t),void 0!==i&&""!==i,i||"",s||"")}))}if(K5.nextTick((()=>{pv.Z.getNavigationInfo(this.props.id)||this.updateNavigationState(this.props.url,!1,"content")})),this.props.url!==e.url){let t="",n="";try{t=new URL(e.url).origin}catch(e){}try{n=new URL(this.props.url).origin}catch(e){}t!==n&&K5.nextTick((()=>{Ky.Z.resetPermissions(e.id),Ky.Z.resetPageHasBlockedContent(e.id),Ky.Z.resetBlockedPopups(e.id)}))}!e.discarded&&this.props.discarded?this.setState({mountWebView:!1}):!e.isVisible&&this.props.isVisible&&this.setState({mountWebView:!0}),(n&&n!==e.target||e.url!==this.props.url||e.isActive!==this.props.isActive||e.discarded!==this.props.discarded)&&this.updateFocus(this.props.id,this.props.url);const i=this.getWebviewElement();if(i){const t=e.discarded&&!this.props.discarded,n=(!e.isActive||t)&&this.props.isActive;if(n){K5.nextTick((()=>W5.setUtilityWebView(this.context.vivaldiWindowId,i)));!this.props.vivExtData.thumbnail&&K5.nextTick((()=>{this.updatePageThumbnailWithActiveWebview(0)}))}const s=e.isActive&&!this.props.isActive,o=(0,St.cw)(e.url),a=(0,St.cw)(this.props.url),r=!o&&a;a||!n&&!o?(s||r)&&K5.nextTick((()=>{if(this.clearWebview(),this.state.tabIsFullscreen){this.getWebviewElement()?.setIsFullscreen(!1)}})):K5.nextTick((()=>{const e=this.getWebviewElement();e&&rS.setActiveWebView(this.context.vivaldiWindowId,e)}))}this.props.vivExtData.readerMode&&!e.vivExtData.readerMode?this.injectReaderView():!this.props.vivExtData.readerMode&&e.vivExtData.readerMode&&this.refWebview.current?.reload(),this.props.prefValues[D.kWebpagesReaderStyle]!==e.prefValues[D.kWebpagesReaderStyle]&&this.updateReaderStyle(),this.updateViewUnchangedFlag(e,this.props);const s=!e.prefValues[D.kMailIsTurnedOff]&&e.prefValues[D.kRssDetectFeeds],o=this.props.prefValues[D.kMailIsTurnedOff]||!this.props.prefValues[D.kRssDetectFeeds];s&&o&&V5.resetRssFeeds(this.props.id),this.props.qrCodeUrl&&e.qrCodeUrl!==this.props.qrCodeUrl&&this.setState({customData:{url:this.props.qrCodeUrl,dialogtype:"qrcode"}})}componentWillUnmount(){this.state.tabIsFullscreen&&K5.nextTick((()=>{Ru.Z.restoreStateAfterHTMLFullscreen(this.context.vivaldiWindowId)})),this.removeEventHandlers(),d.Z.devtoolsPrivate.closeDevtools(this.props.id,(e=>{})),K5.nextTick(this.clearWebview),F5.removeListener(this._onMediaStateStoreChanged),P.Z.ensureRemovedListener(this.updateReaderStyle)}_onMediaStateStoreChanged=()=>{this.setState({mediaState:F5.getState().get(this.props.id)||(0,fa.l4)()})};updateReaderStyle=()=>{if(!this.props.vivExtData.readerMode)return;const e={...this.props.prefValues[D.kWebpagesReaderStyle],...$C.Z.getThemeColors()};_w(this.props.id,{readerStyle:e})};getWebviewElement=()=>this.refWebview.current?.refWebView.current;clearWebview=()=>{const e=this.getWebviewElement();e&&rS.clearIfActive(this.context.vivaldiWindowId,e)};toggleImageInspector=()=>{Y.Z.setImageInspector(this.props.id,this.context.vivaldiWindowId,!this.props.showImageInspector)};updateViewUnchangedFlag=(e,t)=>{e.isActive===t.isActive&&e.vivExtData.tiling===t.vivExtData.tiling||(this.viewUnchangedFlags={})};isDevtoolsDockedAndActive=()=>"bottom"===this.state.dockingState||"left"===this.state.dockingState||"right"===this.state.dockingState;updatePageThumbnailWithActiveWebview=e=>{const t=z.ZP.isIncognitoOrGuest(this.context.vivaldiWindowId),n=this.getWebviewElement();if(n){const i=Qr()();this.viewUnchangedFlags[i]=!0===this.props.isActive,setTimeout((()=>{if((0,St.cw)(this.props.url))this.viewUnchangedFlags[i]&&n&&Sj.getPageThumbnail(n,{compact:!0},(e=>{this.props.isActive&&this.viewUnchangedFlags[i]&&e&&Y.Z.setThumbnail(this.props.id,e)}));else{const e={encodeFormat:"jpg",encodeQuality:80,fullPage:!1,width:330,height:270};d.Z.thumbnails.captureTab(this.props.id,e,((e,t)=>{!y.Z.runtime.lastError&&e&&Y.Z.setThumbnail(this.props.id,t)}))}}),e);const s=cS.Z.getQueue(this.props.id);if(!t&&s&&s.get("url")===this.props.url){const e=s.get("id");y.Z.bookmarks.get(e,(t=>{if(y.Z.runtime.lastError)console.warn("chrome.bookmarks.get failed:",e,y.Z.runtime.lastError);else{const e=t&&1===t.length?t[0]:null;e&&!e.thumbnail&&n&&Sj.getPageThumbnail(n,{compact:!1},(t=>{t&&(this.props.isActive&&e&&this.viewUnchangedFlags&&this.viewUnchangedFlags[i]?y.Z.bookmarks.update(e.id,{thumbnail:t}):console.warn("Cannot update thumbnail as page was not active"))}))}})),dS.Z.remove(this.props.id)}}};attachEventHandlers=()=>{Hf.Z.addListener(this._onWebpageviewStoreChanged),d.Z.devtoolsPrivate.onDockingSizesChanged.addListener(this.onDockingSizesChanged),d.Z.devtoolsPrivate.onDockingStateChanged.addListener(this.onDockingStateChanged),d.Z.devtoolsPrivate.onClosed.addListener(this.onDevtoolsClosed),d.Z.devtoolsPrivate.onDevtoolsUndocked.addListener(this.onDevtoolsUndocked),d.Z.tabsPrivate.onTabIsAttached.addListener(this.onWebViewElementIsAttached),d.Z.tabsPrivate.onTabIsDetached.addListener(this.onWebViewElementIsDetached)};removeEventHandlers=()=>{Hf.Z.removeListener(this._onWebpageviewStoreChanged),d.Z.devtoolsPrivate.onDockingSizesChanged.removeListener(this.onDockingSizesChanged),d.Z.devtoolsPrivate.onDockingStateChanged.removeListener(this.onDockingStateChanged),d.Z.devtoolsPrivate.onClosed.removeListener(this.onDevtoolsClosed),d.Z.devtoolsPrivate.onDevtoolsUndocked.removeListener(this.onDevtoolsUndocked),d.Z.tabsPrivate.onTabIsAttached.removeListener(this.onWebViewElementIsAttached),d.Z.tabsPrivate.onTabIsDetached.removeListener(this.onWebViewElementIsDetached)};updateNavigationState=(e,t,n,i)=>{const s={canGoBack:Boolean(this.refWebview.current?.canGoBack()),canGoForward:Boolean(this.refWebview.current?.canGoForward()),webviewUrl:e,isLoading:t,reason:i,trigger:n};"start"!==n&&Y.Z.setOrigin(this.props.id,this.context.vivaldiWindowId,""),Ky.Z.setNavigationState(this.props.id,this.context.vivaldiWindowId,s)};handleClose=async()=>{if(!await Y.Z.closePopupOrSettingsWindow(this.context.vivaldiWindowId)){await new Promise((e=>setTimeout(e,100)));const e=W.Z.getPageById(this.props.id);e&&await Y.Z.closePage(e)}};handleLoadCommit=e=>{if(!e.isTopLevel||void 0===e.url)return;const{url:t}=e;V5.resetRssFeeds(this.props.id),(0,St.cw)(t)?m.Z.setFastForwardUrl(this.props.id,""):this.injectScripts(this.props.id);const n=this.getWebviewElement();n&&m.Z.setRewindInfo(n,this.props.id),this.updateNavigationState(t,!0,"commit")};handleLoadStart=e=>{if(!e.isTopLevel)return;const{urlForThumbnail:t}=this.props.vivExtData;t!==e.url&&Y.Z.setThumbnail(this.props.id,null),Ky.Z.resetPermissions(this.props.id),this.updateNavigationState(e.url,!0,"start"),Ky.Z.resetPageHasBlockedContent(this.props.id),Ky.Z.resetBlockedPopups(this.props.id),Rl.Z.resetTranslationParameters(this.props.id),this.captureScheduled=!1};handleLoadStop=e=>{this.updateNavigationState(e.target.src,!1,"stop"),this.props.vivExtData.thumbnail||this.updatePageThumbnailWithActiveWebview(0),!1===this.captureScheduled&&(this.captureScheduled=!0,this.updatePageThumbnailWithActiveWebview(5e3))};handleLoadRedirected=e=>{if(e.isTopLevel){const t=e.newUrl,n=e.oldUrl;Y.Z.setThumbnail(this.props.id,null),this.captureScheduled=!1,dS.Z.update(this.props.id,n,t)}};handleContentAllowed=e=>{if("midi-sysex"===e.allowedType||"location"===e.allowedType||"notifications"===e.allowedType){const t=this.props.url?new URL(this.props.url).origin:"";Ky.Z.setPermission(this.props.id,t,e.allowedType,null,"allowed")}};handleContentBlocked=e=>{if("popups"!==e.blockedType&&"sound"!==e.blockedType)if("midi-sysex"===e.blockedType||"location"===e.blockedType){const t=this.props.url?new URL(this.props.url).origin:"";Ky.Z.setPermission(this.props.id,t,e.blockedType,null,"blocked")}else Ky.Z.setPageHasBlockedContent(this.props.id,e.blockedType)};handleLoadAbort=e=>{e.preventDefault(),e.isTopLevel&&this.updateNavigationState(e.url,!1,"abort",e.reason)};handleOnLoadProgress=e=>{if((0,St.pM)(e.url))return;const t={url:e.url,progress:e.progress,loadedBytes:e.loadedBytes,loadedElements:e.loadedElements,totalElements:e.totalElements};(class{static setProgressState(e,t){l.Z.dispatch({actionType:"PAGE_SET_PROGRESS",pageId:e,progressState:t})}}).setProgressState(this.props.id,t)};handleOnFullscreen=e=>{!1===F5.hasMediaState(this.props.id,"capturing")&&Ru.Z.onHTML5FullScreen(e.enterFullscreen,e.windowId),this.setState({tabIsFullscreen:e.enterFullscreen})};handleBlockedPopup=e=>{Ky.Z.addBlockedPopupEvent(this.props.id,e)};injectScripts=(0,Kf.default)((e=>{const t=W.Z.getPageById(e),n=!this.props.prefValues[D.kMailIsTurnedOff]&&this.props.prefValues[D.kRssDetectFeeds];this.refWebview.current?.executeScript({allFrames:!0,code:`window.__vivaldiPageId = ${e};\n             window.__vivaldiDetectFeeds = ${n.toString()};\n             window.__vivaldiUseBossSelect = ${M.Z.get(D.kWebpagesAllowSelectionInLinks)};\n             window.__vivaldiUseTranslateSelection =\n                      ${Boolean(!this.props.vivExtData.readerMode&&t&&!(0,St.pM)(t.url)).toString()};\n             window.__vivaldiContentScriptsInitialized;`,runAt:"document_start"}).then((t=>{if(t&&t.some((e=>!e)))return this.refWebview.current?.executeScript({file:"inject-root-bundle.js"}).catch((e=>{console.warn("Injecting inject-root-bundle failed:",e)})),this.refWebview.current?.executeScript({allFrames:!0,file:"inject-all-bundle.js"}).then((()=>{m.Z.initTab(e)}))})).catch((e=>{console.warn("Checking for inject-all-bundle failed:",e)})),this.props.vivExtData.readerMode&&this.injectReaderView()}),400);injectReaderView=()=>{P.Z.ensureAddedListener(this.updateReaderStyle);const e={code:"/* global chrome */\n\n/* This is the user file part of reader mode, it's injected after the\n   browserjs part of reader mode and does the real injecetion\n   (browserjs only does detection at an earlier stage so that we don't\n   need to wait for the page to load to update the indicator status of\n   the readability of the page */\nconst FEATURE_HIDE_PAGE = true;\n/* Hide page on load for better transition while navigating */\n\nconst AVERAGE_READ_WORDS = 225; // Add LI to scoring elements; Lower default character threshold (500)\n\nconst TAGS = \"section,h2,h3,h4,h5,h6,p,li,td,pre\";\nconst DEFAULT_TAGS_TO_SCORE = TAGS.toUpperCase().split(\",\");\nconst DEFAULT_CHAR_THRESHOLD = 300;\n\nfunction canSetStyle() {\n  return document && document.documentElement && document.documentElement.style;\n} // TODO: not working after delaying injection in the browserjs part of reader view\n\n\nif (FEATURE_HIDE_PAGE && canSetStyle()) {\n  document.documentElement.style.display = 'none';\n}\n\nconst DEBUG_READABILITY = false;\nconst readabilityCss = `\nhtml {\n  margin: 0;\n  padding: 0;\n}\nbody {\n  color: #111111;\n  background-color: #f6f6f6;\n  font-family: sans-serif;\n  font-size: 1.3em;\n  font-style: normal;\n  font-weight: 400;\n  line-height: 1.5;\n  margin: 0 auto;\n  padding: 40px 10px 80px;\n  text-orientation: upright;\n  transition:\n    color 200ms cubic-bezier(0.4, 0, 1, 1),\n    background-color 200ms cubic-bezier(0.4, 0, 1, 1);\n}\nbody.vertical {\n  margin: 40px auto 0;\n  padding: 40px 60px 0;\n  max-height: calc(100vh - 120px);\n}\n.entry-content * {\n  max-width: 100%;\n  white-space: normal;\n  line-height: inherit;\n  vertical-align: baseline;\n  background: transparent;\n}\n.entry-content p {\n  margin: 1.5em 0;\n}\nbody.vertical .entry-content p {\n  margin: 0 1.5em;\n}\nh1 {\n  font-size: 1.8em;\n  line-height: 1.35;\n}\nh1, h2, h3, h4, h5, h6, b {\n  font-weight: 700;\n}\nhr {\n  border-style: solid;\n  border-width: 0 0 0.5px 0.5px;\n}\n.byline {\n  font-style: italic;\n}\n.entry-content img {\n  max-width: 100%;\n  height: auto;\n}\nbody.vertical .entry-content img {\n  max-height: 100%;\n  width: auto;\n}\n.entry-content code {\n  font-weight: 500;\n}\n.entry-content pre {\n  font-weight: 300;\n  background-color: rgba(128, 128, 128, 0.05);\n  border: 1px solid rgba(128, 128, 128, 0.1);\n  white-space: pre-wrap;\n  padding: 0.5em;\n  margin: 1.5em 0;\n}\n.entry-content code, .entry-content pre {\n  text-align: left;\n  max-width: 100%;\n  writing-mode: horizontal-tb;\n  overflow: auto;\n  white-space: pre-wrap;\n}\nbody.vertical .entry-content pre {\n  margin: 0 1.5em;\n  max-width: 80%;\n  max-height: 100%;\n}\niframe, textarea, input {\n  display: none;\n}\n`;\n\nfunction __vivaldiGetHTML(article) {\n  const content = window.DOMPurify.sanitize(article.content);\n  const words = article.textContent.split(' ').filter(elem => {\n    return elem.length && !elem.match(/\\r?\\n|\\r/g);\n  });\n  const readingTime = Math.round(words.length / AVERAGE_READ_WORDS);\n  const _ = window.Translate;\n\n  const readText = _(\"Read time: $1 minute\", \"Read time: $1 minutes\", [readingTime]);\n\n  const byline = article.byline ? `${article.byline} — ` : '';\n  return `<!DOCTYPE html>\n<html dir=\"${article.dir}\"><head>\n<title>${article.title}</title>\n<style>${readabilityCss}</style>\n</head><body>\n<h1>${article.title}</h1>` + `<p class=\"byline\">${byline} ${readText}</p>` + `<hr />\n<article class=\"entry-content\">${content}</article>\n</body></html>`;\n}\n\nfunction ready() {\n  if (typeof document !== 'undefined' && ['complete', 'loaded', 'interactive'].indexOf(document.readyState) > -1) {\n    return true;\n  }\n\n  return false;\n}\n\nlet _numTriesLeft = 5;\n\nfunction onLoad() {\n  if (!window['Readability'] && _numTriesLeft-- > -1) {\n    setTimeout(onLoad, 500);\n  }\n\n  try {\n    if (!window['Readability']) {\n      return;\n    } // TODO: should probably reuse this object when enabling, instead\n    // of running it again via the user script\n\n\n    const {\n      Readability\n    } = window;\n    const readability = new Readability(document.cloneNode(true), {\n      classesToPreserve: DEFAULT_TAGS_TO_SCORE,\n      charThreshold: DEFAULT_CHAR_THRESHOLD,\n      debug: DEBUG_READABILITY\n    });\n    const isProbablyReaderable = window.isProbablyReaderable(document);\n    let article;\n\n    if (isProbablyReaderable) {\n      article = readability.parse();\n    } else {\n      console.log('[readability] Probably not readable');\n    }\n\n    if (DEBUG_READABILITY) {\n      console.log('isReadable?', isProbablyReaderable, 'article:', article);\n    }\n\n    if (article) {\n      // VB-22288 Cancel unload events\n      document.beforeunload = () => {};\n\n      document.unload = () => {};\n\n      const reader = document.implementation.createHTMLDocument(document.title);\n      reader.documentElement.innerHTML = __vivaldiGetHTML(article);\n      document.replaceChild(reader.documentElement, document.documentElement);\n\n      if (chrome && chrome.runtime && chrome.runtime.sendMessage) {\n        chrome.runtime.sendMessage({\n          type: 'SET_RM_STYLE'\n        });\n      }\n    } else {\n      console.log('[readability] Nothing to show');\n    }\n  } finally {\n    // The page is rendered with display: none, so need to ensure this\n    // is always called\n    if (FEATURE_HIDE_PAGE && canSetStyle()) {\n      document.documentElement.style.display = 'block';\n    }\n  }\n}\n\nif (ready()) {\n  onLoad();\n} else {\n  window.addEventListener('DOMContentLoaded', onLoad, false);\n}",runAt:"document_start"};this.refWebview.current?.executeScript(e).catch(Tl.default)};onNewPopup=e=>{e.targetUrl||(e.targetUrl="about:blank");const t=z.ZP.isIncognito(this.context.vivaldiWindowId);ie.Z.openNewPopAsTabOrWindow(this.context.vivaldiWindowId,e,t)};handleOnNewWindow=e=>{const t=z.ZP.isPopup(this.context.vivaldiWindowId);let n=t?0:this.context.vivaldiWindowId;const i=z.ZP.isIncognito(this.context.vivaldiWindowId);if(t&&i)for(const[e]of z.ZP.getState())if(z.ZP.isIncognitoOrGuest(e)&&z.ZP.isTabbedBrowser(e)){n=e;break}switch(e.windowOpenDisposition){case"current_tab":case"new_foreground_tab":e.preventDefault(),e.window.accept(n+";1");break;case"new_background_tab":e.preventDefault(),e.window.accept(n+";0");break;case"off_the_record":case"new_window":e.preventDefault();const t="off_the_record"===e.windowOpenDisposition?{incognito:!0,transition:d.Z.historyPrivate.TransitionType.LINK}:{};Ru.Z.openBrowserWindow(this.context.vivaldiWindowId,e.targetUrl,t);break;case"new_popup":e.preventDefault(),this.onNewPopup(e)}};showDialog=e=>{e.webview=this.getWebviewElement(),this.setState({customData:e})};handleOnCloseDialog=()=>{this.setState({customData:null}),this.props.onDialogClosed()};handleOnJavascriptDialog=e=>{e.preventDefault(),e.dialogtype="javascript",this.showDialog(e)};handleOnPermissionRequest=e=>{e.preventDefault();const t=e.url?new URL(e.url).origin:"";switch(e.permission){case"geolocation":case"microphone":case"microphone_and_camera":case"camera":case"notifications":Ky.Z.setPermission(this.props.id,t,e.permission,e.request,"undecided");break;case"pointerLock":e.request.allow(),e.dialogtype=e.permission,this.showDialog(e);break;case"download":if(M.Z.get(D.kDownloadsStartAutomatically)){if(e.request.allow(),M.Z.get(D.kDownloadsOpenPanelOnNew)){const e=this.context.vivaldiWindowId;(0,Io.P)("DownloadButton",e)?a.Z.executeActions(e,"COMMAND_SHOW_DOWNLOADS_POPOUT"):Dl.ZP.canAutoOpen(e,"downloads")&&Ho.Z.toggleContent(e,"downloads")}}else e.dialogtype=e.permission,this.showDialog(e);break;case"media":e.request.allow();break;default:e.dialogtype=e.permission,this.showDialog(e)}};handleOnSSLStateChanged=e=>{if(e.SSLState){const t={state:e.SSLState,issuer:e.issuerstring};Ky.Z.setSSLState(this.props.id,t)}};handleOnTargetURLChanged=e=>{const t=(0,_C.ZP)(e.newUrl);X.Z.setStatus(this.context.vivaldiWindowId,t),this._localStatus=!0};handleOnCreateSearch=e=>{e.dialogtype="createSearch",this.showDialog(e)};handleOnPasteAndGo=e=>{e.preventDefault();const t={ctrlKey:e.modifiers.includes("ctrl"),shiftKey:e.modifiers.includes("shift"),altKey:e.modifiers.includes("alt"),metaKey:!1},n=this.context.vivaldiWindowId,i=e.clipBoardText,s=(0,ls.Z)(n,t);"search"===e.pasteTarget&&Vg.Z.doAction(n,this.props.id,"searchPasteAndGo",{clipboardText:i,openOptions:s}),"url"===e.pasteTarget&&Vg.Z.doAction(n,this.props.id,"urlPasteAndGo",{clipboardText:i,openOptions:s})};handleOnContentsCreated=()=>{(0,St.cw)(this.props.url)||this.injectScripts(this.props.id)};_onWebpageviewStoreChanged=e=>{if(e.pageId!==this.props.id)return;const t=this.getWebviewElement();switch(e.type){case"WEBPAGEVIEW_CLOSE_FIND_IN_PAGE":return t?.stopFinding("keep"),void this.focusWebView(this.props.url);case"WEBPAGEVIEW_GO":return void t?.go(e.index);case"WEBPAGEVIEW_BACK":return void t?.back();case"WEBPAGEVIEW_FORWARD":return void t?.forward();case"WEBPAGEVIEW_GET_HISTORY":return void t?.getPageHistory(e.callback);case"WEBPAGEVIEW_STOP":{const e=pv.Z.getNavigationInfo(this.props.id);return void((!e||e&&e.isLoading)&&this.refWebview.current?.stop())}case"WEBPAGEVIEW_RELOAD":return void(this.props.id===e.pageId&&y.Z.tabs.reload(e.pageId,{bypassCache:e.bypassCache}));case"WEBPAGEVIEW_ACTIONS":switch(e.action){case"focusWebView":return void this.focusWebView(this.props.url);case"pageScrollUp":return void this.pageScrollUp();case"pageScrollDown":return void this.pageScrollDown();case"pageScrollTop":return void this.pageScrollTop();case"pageScrollBottom":return void this.pageScrollBottom();case"print":{const e=this.context.vivaldiWindowId,n=qt.Z.getActiveWebView(e);return void(n===t?d.Z.utilities.print(e):n&&n.print())}}}};focusWebView=e=>{(0,St.cw)(e)?this.refInternalPage.current?.focus():this.getWebviewElement()?.focus()};pageScrollUp=()=>{const e=W.Z.getActivePage(this.context.vivaldiWindowId);e&&d.Z.tabsPrivate.scrollPage(e.id,"pageup",0,(()=>{y.Z.runtime.lastError&&console.warn("vivaldi.tabsPrivate.scrollPage failed: "+(y.Z.runtime.lastError.message||""))}))};pageScrollDown=()=>{const e=W.Z.getActivePage(this.context.vivaldiWindowId);e&&d.Z.tabsPrivate.scrollPage(e.id,"pagedown",0,(()=>{y.Z.runtime.lastError&&console.warn("vivaldi.tabsPrivate.scrollPage failed: "+(y.Z.runtime.lastError.message||""))}))};pageScrollTop=()=>{const e=W.Z.getActivePage(this.context.vivaldiWindowId);e&&d.Z.tabsPrivate.scrollPage(e.id,"top",0,(()=>{y.Z.runtime.lastError&&console.warn("vivaldi.tabsPrivate.scrollPage failed: "+(y.Z.runtime.lastError.message||""))}))};pageScrollBottom=()=>{const e=W.Z.getActivePage(this.context.vivaldiWindowId);e&&d.Z.tabsPrivate.scrollPage(e.id,"bottom",0,(()=>{y.Z.runtime.lastError&&console.warn("vivaldi.tabsPrivate.scrollPage failed: "+(y.Z.runtime.lastError.message||""))}))};onKeyDown=e=>{"Escape"===e.key&&Vg.Z.closeFindInPageToolbar(this.context.vivaldiWindowId,this.props.id)&&e.preventDefault()};onMouseDown=()=>{Y.Z.activateTab(this.props.id,this.context.vivaldiWindowId)};onMouseLeave=()=>{this._localStatus&&(this._localStatus=!1,X.Z.clearStatus(this.context.vivaldiWindowId))};updateDockingSizes_=e=>{d.Z.devtoolsPrivate.getDockingStateSizes(e,(e=>{const t=e.hideInspectedContents,n=e.inspectedHeight,i=e.inspectedLeft,s=e.inspectedTop,o=e.inspectedWidth;d.Z.zoom.getVivaldiUIZoom((e=>this.setState({hideInspectedContents:t,viewWidth:o/e,viewHeight:n/e,viewTop:s/e,viewLeft:i/e,disableWebviewEvents:!0},(()=>{this._eventGuard&&clearTimeout(this._eventGuard),this._eventGuard=setTimeout((()=>{this.setState({disableWebviewEvents:!1})}),300)}))))}))};onDockingSizesChanged=e=>{e===this.props.id&&this.updateDockingSizes_(e)};onDockingStateChanged=(e,t)=>{e===this.props.id&&this.state.dockingState!==t&&(this.setState({dockingState:t}),Y.Z.setPageInspected(e,this.context.vivaldiWindowId,"off"!==t))};onDevtoolsClosed=e=>{e===this.props.id&&(this.setState({dockingState:"off",viewWidth:"auto",viewHeight:"auto",viewTop:0,viewLeft:0}),Y.Z.setPageInspected(e,this.context.vivaldiWindowId,!1))};onNewDevtoolsWindowCreated=(e,t)=>{t.contentWindow.vivaldiInspectTabId=e,t.contentWindow.vivaldiWindowId=this.context.vivaldiWindowId,this._devtoolsCloseTimerId&&(clearTimeout(this._devtoolsCloseTimerId),this._devtoolsCloseTimerId=0),t.onClosed.addListener(this.onDevtoolsWindowClosed.bind(this,e))};onDevtoolsWindowClosed=e=>{"undocked"===this.state.dockingState&&(this._devtoolsCloseTimerId=setTimeout((()=>{d.Z.devtoolsPrivate.closeDevtools(e,(e=>{}))}),1e3),Y.Z.setPageInspected(e,this.context.vivaldiWindowId,!1))};onDevtoolsUndocked=(e,t,n)=>{if(e===this.props.id){const i={left:n.left,top:n.top,width:n.right-n.left,height:n.bottom-n.top},s={id:"DevToolsApp_"+e.toString(),resizable:!0,state:n.maximized?"maximized":"normal",hidden:!0!==t,alwaysOnTop:n.alwaysOnTop,outerBounds:i};y.Z.app.window.create("devtools.html",s,this.onNewDevtoolsWindowCreated.bind(this,e)),this.setState({dockingState:"undocked"})}};onWebViewElementIsAttached=(e,t)=>{const{id:n,isActive:i,url:s}=this.props,o=this.getWebviewElement();e===n&&o&&i&&!(0,St.cw)(s)&&rS.setActiveWebView(t,o)};onWebViewElementIsDetached=(e,t)=>{e===this.props.id&&this.clearWebview()};updateFocus=(e,t)=>{if(!this.props.discarded)if(this.props.isActive){const e=this.nodeRef.current;e instanceof Node&&e.contains(this.activeElement)?X5((()=>{this.activeElement&&(this.activeElement.focus(),delete this.activeElement)})):$C.Z.getUrlfieldStateFromId(this.props.id).isActive||z5({winId:this.context.vivaldiWindowId,pageId:this.props.id,url:t,activeElement:this.activeElement})||X5((()=>this.focusWebView(t)))}else this.activeElement=this.context.document.activeElement};_onFindInPage=(e,t)=>{Vg.Z.findInPage(this.context.vivaldiWindowId,this.props.id,e,t)};_onFindNextInPage=(e,t,n)=>{Vg.Z.findNextInPage(this.context.vivaldiWindowId,this.props.id,e,t,n)};render(){const e=this.props.supportsReaderMode,t=this.props.vivExtData.readerMode&&e&&!(0,St.cw)(this.props.url),n=W.Z.isDisplayingImage(this.props.id),i="off"!==this.state.dockingState&&!(0,St.cw)(this.props.url),s="auto"===this.state.viewWidth||0===this.state.viewWidth?"100%":this.state.viewWidth+this.state.viewLeft,o=0!==this.state.viewWidth,a=0!==this.state.viewHeight,r=this.state.mediaState.has("recording")||this.state.mediaState.has("capturing"),l={visibility:r||this.props.isVisible?"inherit":"hidden",zIndex:this.props.isVisible?"initial":"-1",opacity:this.props.isVisible?1:0};if(this.state.tabIsFullscreen&&r){const e=1920,t=1080,n=this.props.contentWidth/e;l.transform=`scale(${n})`,l.left=(this.props.contentWidth-e)/2,l.top=(this.props.contentHeight-t)/2,l.width=e,l.height=t,l.position="absolute"}const d=Number(this.props.id),c=mn()("webpageview",{active:this.props.isActive,internal:(0,St.cw)(this.props.url),tiled:(0,$5.Qz)(this.props.id),visible:this.props.isVisible,pagefocusstop:this.props.isVisible});return j5(id,{level:"tabs"},void 0,(0,fn.jsxs)("div",{ref:this.nodeRef,className:c,style:l,"data-id":this.props.id,tabIndex:"-1",onKeyDown:this.onKeyDown,onMouseLeave:this.onMouseLeave,onMouseDown:this.onMouseDown,children:[t&&this.props.prefValues[D.kWebpagesReaderControls]&&!(i&&"undocked"!==this.state.dockingState)&&Q5,!n&&!(0,St.Gp)(this.props.url)&&j5(OS,{isActive:this.props.isActive,pageId:this.props.id,onFindInPage:this._onFindInPage,onFindNextInPage:this._onFindNextInPage}),j5(fS,{tabId:d}),j5(AS,{url:this.props.url}),j5("div",{className:"row-wrapper"},void 0,j5("div",{className:"devtools-container"},void 0,i&&j5(SS,{active:this.props.isActive,tabId:d,dockingState:this.state.dockingState}),j5("div",{className:"webpage",style:i?{top:this.state.viewTop,left:this.state.viewLeft,width:o?this.state.viewWidth:"none",height:a?this.state.viewHeight:"none",pointerEvents:this.state.disableWebviewEvents?"none":null}:null},void 0,this.state.mountWebView&&(0,fn.jsx)(H5,{ref:this.refWebview,id:d,pinned:this.props.pinned,discarded:this.props.discarded,isVisible:this.props.isVisible,onClose:this.handleClose,onContentsCreated:this.handleOnContentsCreated,onCreateSearch:this.handleOnCreateSearch,onContentAllowed:this.handleContentAllowed,onContentBlocked:this.handleContentBlocked,onDialog:this.handleOnJavascriptDialog,onFullscreen:this.handleOnFullscreen,onLoadAbort:this.handleLoadAbort,onLoadCommit:this.handleLoadCommit,onLoadProgress:this.handleOnLoadProgress,onLoadRedirect:this.handleLoadRedirected,onLoadStart:this.handleLoadStart,onLoadStop:this.handleLoadStop,onNewWindow:this.handleOnNewWindow,onPasteAndGo:this.handleOnPasteAndGo,onPermissionRequest:this.handleOnPermissionRequest,onSslStateChanged:this.handleOnSSLStateChanged,onTargetUrlChanged:this.handleOnTargetURLChanged,onWindowBlocked:this.handleBlockedPopup})),(0,fn.jsx)(R5,{ref:this.refInternalPage,pageId:this.props.id,url:this.props.url,isVisible:this.props.isVisible,isActive:this.props.isActive,updatePageThumbnailWithActiveWebview:this.updatePageThumbnailWithActiveWebview}),n&&!this.props.showImageInspector&&j5("button",{className:"inspector",title:(0,le.Z)("Image Properties"),style:{left:s},onClick:this.toggleImageInspector,dangerouslySetInnerHTML:{__html:cn.GH$}})),n&&j5(fT,{url:this.props.url,open:this.props.showImageInspector,toggleImageInspector:this.toggleImageInspector}),this.props.isActive&&this.state.customData&&j5(_l,{customData:this.state.customData,closeDialog:this.handleOnCloseDialog}))]}))}}const J5=(0,fs.Z)(q5,Y5);var e4=n(34155);function t4(e,t){return function(n){n.currentTarget instanceof HTMLElement&&n.relatedTarget instanceof HTMLElement&&n.currentTarget.contains(n.relatedTarget)||(n.stopPropagation(),n4(e,t?.vivaldiWindowId||z.ZP.getId()))}}function n4(e,t){let n;n="content"===e?function(e){const t=W.Z.getActivePage(e);return t?.isMailPage?"mail":t?.url&&St.jk.getDisplayUrl(t.url).startsWith("vivaldi://calendar")?"calendar":"browser"}(t):"panel"===e?function(e){switch(Dl.ZP.getSelectedPanel(e)){case"mail":case"feeds":case"contacts":return"mail";case"calendar":return"calendar";default:return"browser"}}(t):"browser";const i={actionType:"SWITCH_CONTEXT",context:{area:e,feature:n},windowId:t};l.Z.isDispatching()?e4.nextTick((()=>l.Z.dispatch(i))):l.Z.dispatch(i)}var i4,s4=n(34155);function o4(e,t,n,i){i4||(i4="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:i4,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const a4=[D.kAddressBarAutocompleteEnabled,D.kAddressBarExtensionsVisible,D.kAddressBarExtensionsRenderInDropdown,D.kAddressBarExtensionsShowAllToggle,D.kAddressBarInlineSearchEnabled,D.kAddressBarPosition,D.kAddressBarSearchSuggestEnabled,D.kAddressBarShowQrGenerator,D.kAddressBarTypedHistoryEnabled,D.kPopupsShowInTab,D.kKeyboardTabToAll,D.kAddressBarSearchShowFavicon,D.kTabsFocusWebview];function r4(e){return{typedHistory:$C.Z.getTypedHistory(),...$C.Z.getUrlfieldStateFromId(e)}}function l4(e){return{blockedPageContent:pv.Z.getblockedPageContents(e),blockedPopups:pv.Z.getBlockedPopupsById(e),permissionInfo:pv.Z.getPermissionsById(e),sslInfo:pv.Z.getSSLInfo(e)}}function d4(e){if(!e)return;const t=Nn.Z.getByQuery(e);if(!t||!t.keyword)return;return e.substring(t.keyword.length)?t:void 0}function c4(e){return function(e){const t=(0,_C.ME)(e,["scheme","host","tld","port","path","query","ref"]);return(0,_C.Aq)(t).substring(0,Q.RL)}(e)}class h4 extends tn.PureComponent{static contextType=dn.Z;#n;refPageloadProgress=tn.createRef();refPopupBlockerNotificator=tn.createRef();passwordElm=tn.createRef();siteInfoElm=tn.createRef();refUrlField=tn.createRef();trackContextOnFocus=t4("tabBar",this.context);_waitingForNavigationStart=!1;constructor(e,t){super(e);const n=r4(e.id),i=l4(e.id),s=W.Z.getPageById(e.id),o=en.ZP.findByUrl(e.url);this.state={isBaseDomainObscured:!1,topSites:[],urlFragments:(0,_C.dO)(e.url),createBookmarkCallout:!1,hasFeed:!0,bookmarkData:o?{...o}:void 0,showPasswordIcon:!1,defaultSearchEngine:Nn.Z.getDefault(z.ZP.isIncognito(t.vivaldiWindowId)),feeds:Ub.getState(),isReaderModeActive:Boolean(s?.vivExtData.readerMode),supportsReaderMode:!!s&&s.supportsReaderMode,editUrl:n.editUrl,typedHistory:n.typedHistory,blockedPageContent:i.blockedPageContent,blockedPopups:i.blockedPopups,permissionInfo:i.permissionInfo,sslInfo:i.sslInfo,itemFavIcon:{favIconUrl:"",favIconType:"favicon"}}}static getDerivedStateFromProps(e){const{id:t}=e,n=r4(t),i=l4(t),s=W.Z.getPageById(t),o=en.ZP.findByUrl(e.url);return{isReaderModeActive:Boolean(s?.vivExtData.readerMode),supportsReaderMode:!!s&&s.supportsReaderMode,editUrl:n.editUrl,typedHistory:n.typedHistory,blockedPageContent:i.blockedPageContent,blockedPopups:i.blockedPopups,permissionInfo:i.permissionInfo,sslInfo:i.sslInfo,bookmarkData:o?{...o}:void 0}}componentDidUpdate(e,t){const n=e.url!==this.props.url,i=e.id!==this.props.id;if(i&&this.hideDropdown(),!this.props.prefValues[D.kTabsFocusWebview]&&i&&$C.Z.getUrlfieldStateFromId(this.props.id).isActive&&X5((()=>this.refUrlField.current?.select())),n){this._setBookmarkedState(this.props.url);const e=(0,_C.dO)(this.props.url);this.setState((0,E.ZP)((({urlFragments:t})=>{t.scheme=e.scheme,t.username=e.username,t.password=e.password,t.host=e.host,t.ref=e.ref,t.query=e.query,t.port=e.port,t.tld=e.tld,t.path=e.path})))}}componentDidMount(){this.#n=!0,z.ZP.isGuestSession(this.context.vivaldiWindowId)||y.Z.topSites.get((e=>{this.setState({topSites:e})})),en.ZP.addListener(this._onBookmarkStoreChanged),Hf.Z.addListener(this._onWebpageviewStoreChanged),$C.Z.addListener(this._onUrlbarStoreChanged),pv.Z.addListener(this._onNavigationStoreChanged),Nn.Z.addListener(this._onSearchEngineCacheChanged),W.Z.addListener(this._onPageStoreChanged),d.Z.windowPrivate.onPositionChanged.addListener(this._onWindowPositionChanged),d.Z.utilities.onPasswordIconStatusChanged.addListener(this.togglePasswordIcon),Ub.addListener(this._onRssDetectStoreChanged),$C.Z.getUrlfieldStateFromId(this.props.id).isActive&&X5((()=>this.refUrlField.current?.select()))}componentWillUnmount(){this.#n=!1,en.ZP.removeListener(this._onBookmarkStoreChanged),Hf.Z.removeListener(this._onWebpageviewStoreChanged),$C.Z.removeListener(this._onUrlbarStoreChanged),pv.Z.removeListener(this._onNavigationStoreChanged),Nn.Z.removeListener(this._onSearchEngineCacheChanged),W.Z.removeListener(this._onPageStoreChanged),d.Z.windowPrivate.onPositionChanged.removeListener(this._onWindowPositionChanged),d.Z.utilities.onPasswordIconStatusChanged.removeListener(this.togglePasswordIcon),Ub.removeListener(this._onRssDetectStoreChanged)}getReaderContextMenu=()=>{const e=this.context.vivaldiWindowId;return[{handler:()=>ie.Z.showSettings(e,"webpages"),visible:!z.ZP.isGuestSession(e),...(0,Mn.Z)("Configure Reader View")}]};_setBookmarkedState=(0,Zr.Z)((e=>{if(!this.#n)return;const t=en.ZP.findByUrl(e);this.setState({bookmarkData:t?{...t}:void 0})}),100);_onUrlbarStoreChanged=()=>{const e=r4(this.props.id);this.setState({editUrl:e.editUrl,typedHistory:e.typedHistory,...e.editUrl&&e.editUrl.length<=1&&{itemFavIcon:{favIconUrl:"",favIconType:"favicon"}}})};_onNavigationStoreChanged=()=>{const e=this.props.id;if(this._waitingForNavigationStart){const t=pv.Z.getNavigationInfo(e);["start","stop"].includes(t.trigger)&&!$C.Z.getUrlfieldStateFromId(e)?.isActive&&(this._waitingForNavigationStart=!1,s4.nextTick((()=>{Of.Z.setUrlfieldState(e,{editUrl:void 0})})))}const t=()=>{const t=l4(e);this.setState({blockedPageContent:t.blockedPageContent,blockedPopups:t.blockedPopups,permissionInfo:t.permissionInfo,sslInfo:t.sslInfo})};pv.Z.getPermissionsById(e)!==this.state.permissionInfo?setTimeout(t,200):t()};_onSearchEngineCacheChanged=()=>{this.setState({defaultSearchEngine:Nn.Z.getDefault(z.ZP.isIncognito(this.context.vivaldiWindowId))})};_onRssDetectStoreChanged=()=>{this.setState({feeds:Ub.getState()})};_onPageStoreChanged=()=>{const e=W.Z.getPageById(this.props.id);this.setState({isReaderModeActive:Boolean(e?.vivExtData.readerMode),supportsReaderMode:!!e&&e.supportsReaderMode})};selectAddressField=()=>{this.#n&&this.refUrlField.current?.select()};focusAddressField=()=>{this.#n&&this.refUrlField.current?.focus()};blurAddressField=()=>{this.#n&&(this.refUrlField.current?.blur(),this.hideDropdown())};_onBookmarkStoreChanged=()=>{this._setBookmarkedState(this.props.url)};_onWebpageviewStoreChanged=e=>{e.winId===this.context.vivaldiWindowId&&("WEBPAGEVIEW_ACTIONS"===e.type?"focusAddressField"===e.action?(this.onCloseCreateBookmarkCallout(),this.focusAddressField(),s4.nextTick((()=>{this.selectAddressField()}))):"urlPasteAndGo"===e.action&&e.payload&&this.urlPasteAndGo(e.payload):"WEBPAGEVIEW_URLFIELD_BLUR"===e.type&&s4.nextTick((()=>this.hideDropdown())))};urlPasteAndGo=async e=>{const{HTMLInputElement:t}=this.context,{clipboardText:n}=e;if(!n)return;const i=$C.Z.getUrlfieldStateFromId(this.props.id).isActive,s=this.refUrlField.current?._urlInput.current?.refUrlInput.current?.inputField.current;if(s instanceof t){const t=i?s.value.substring(0,s.selectionStart)+n+s.value.substring(s.selectionEnd):n;this.blurAddressField(),await Of.Z.go(this.context.vivaldiWindowId,[t],{transition:d.Z.historyPrivate.TransitionType.TYPED,fromUrlField:!0,addTypedSearchHistory:!1,enableSearch:!0,...e.openOptions})}};onUrlFieldFocus=()=>{$C.Z.setUrlFieldActive(this.props.id,!0)};onUrlFieldBlur=()=>{$C.Z.setUrlFieldActive(this.props.id,!1)};onPasswordFocus=e=>{d.Z.utilities.isDialogOpen("password",(e=>{d.Z.utilities.focusDialog("password",(e=>{}))}))};compareProtocol=e=>{if((0,Ni.C3)(e)&&(0,Ni.Zj)(e)&&this.props.url&&aS(e)===aS(this.props.url)){const t=_i.parse(this.props.url).protocol,n=_i.format({host:e,protocol:t});if((0,Ni.K2)(n))return n}return e};handleUrlFieldSubmit=async({url:e,options:t})=>{const n=d4(this.state.editUrl);this._waitingForNavigationStart=!0;const i=Boolean(n||this.props.prefValues[D.kAddressBarInlineSearchEnabled]);n||(e=this.compareProtocol(e)),await Of.Z.go(this.context.vivaldiWindowId,[e],{...t,enableSearch:i,addTypedSearchHistory:!1})};easterEggNavigation=async()=>{const e=this.refUrlField.current?.autocompletedValue;e&&(this.hideDropdown(),await Of.Z.go(this.context.vivaldiWindowId,[St.jk.getUrl(e)],{enableSearch:!0,transition:d.Z.historyPrivate.TransitionType.TYPED,addTypedSearchHistory:!1}))};onSiteInfoButtonFieldGo=()=>{this.easterEggNavigation()};showPasswordDialog=()=>{d.Z.utilities.showPasswordDialog(this.context.vivaldiWindowId)};initOriginUrl=()=>{this.props.id&&Y.Z.setOrigin(this.props.id,this.context.vivaldiWindowId,c4(this.state.urlFragments))};onUrlFieldDrop=e=>{const t=this.context.vivaldiWindowId,n=e.dataTransfer;if(!n)return;const i=n.getData("text/uri-list");if(i.length>0){const e=i.split("\n");e.length>0&&(this.initOriginUrl(),Of.Z.go(t,e))}else{const e=n.getData("text/plain");e.length>0&&((0,Ni.K2)(e)?(this.initOriginUrl(),Of.Z.go(t,[e])):(Of.Z.setUrlfieldState(this.props.id,{editUrl:e}),this.focusAddressField()))}};togglePasswordIcon=(e,t)=>{e===this.context.vivaldiWindowId&&this.setState((e=>({showPasswordIcon:t})))};setUrlDragEvent=e=>{e.stopPropagation();const t=this.context.document.createElement("img"),{window:n,vivaldiWindowId:i}=this.context,s=z.ZP.isIncognito(i);t.src=this.props.favIconUrl||"/resources/default_favicon_64.png",t.width=32,t.height=32,e.dataTransfer.setDragImage(t,t.width*n.devicePixelRatio,t.height*n.devicePixelRatio),t.remove();const o=W.Z.getActivePage(i);Gi(e,this.props.url,o?.title??"",s),e.dataTransfer.effectAllowed="all"};onReaderModeClicked=()=>{this.state.isReaderModeActive?Y.Z.setReaderState(this.props.id,!1):Y.Z.setReaderState(this.props.id,!0)};onCreateBookmarkCallout=()=>{this.props.active&&this.props.url&&this.setState({createBookmarkCallout:!0})};onCloseCreateBookmarkCallout=()=>{this.setState({createBookmarkCallout:!1})};onPopupAllowed=e=>{Ky.Z.removeBlockedPopup(this.props.id,e.targetUrl),this.refPopupBlockerNotificator.current?.onDialogClosed(),this.openNewPopAsTabOrWindow(e)};onCurrItemChanged=e=>{e&&e.faviconType&&e.faviconUrl&&("OMNI_RESULT_FOLDER_NICKNAME"!==e.type&&Of.Z.setUrlfieldState(this.props.id,{editUrl:e.url}),this.setState({itemFavIcon:{favIconUrl:e?.faviconUrl,favIconType:e?.faviconType}}))};openNewPopAsTabOrWindow=e=>{const t=z.ZP.isIncognito(this.context.vivaldiWindowId);ie.Z.openNewPopAsTabOrWindow(this.context.vivaldiWindowId,e,t)};_isEditingUrl=()=>{const{editUrl:e}=this.state;return void 0!==e&&(""===e||c4(this.state.urlFragments)!==e)};_isUrlEmpty=()=>{const{editUrl:e,urlFragments:t}=this.state;return this._isEditingUrl()&&""===e||!e&&!t.scheme};hideDropdown=()=>{this.refUrlField.current?.hideDropdown()};toggleTypedHistory=e=>{e.preventDefault(),this.refUrlField.current?.toggleTypedHistory(e)};_storeDialogAnchorRect=(e,t)=>{const n="top"===this.props.prefValues[D.kAddressBarPosition]?"down":"up";d.Z.zoom.getVivaldiUIZoom((i=>{d.Z.utilities.setDialogPosition(t,this.context.vivaldiWindowId,{left:Math.round(e.left*i),top:Math.round(e.top*i),width:Math.round(e.width*i),height:Math.round(e.height*i)},n)}))};_updateDialogPositions=()=>{const e=this.passwordElm.current;if(e){const t=e.getRect();t&&this._passwordPopupPos!==t&&(this._passwordPopupPos=t,this._storeDialogAnchorRect({left:t.left,top:t.top,width:t.width,height:t.height},"password"))}const{Element:t}=this.context,n=this.siteInfoElm.current?.refSiteInfoButton.current;if(n instanceof t){const e=n.getBoundingClientRect();this._permissionPopupPos!==e&&(this._permissionPopupPos=e,this._storeDialogAnchorRect({left:e.left,top:e.top,width:e.width,height:e.height},"permission"))}y.Z.windows.get(this.context.vivaldiWindowId,{},(e=>{if(!y.Z.runtime.lastError){let{left:t=0,top:n=0,width:i,height:s}=e;i=i||0,s=s||0,this._storeDialogAnchorRect({left:Math.round(t+i/2),top:Math.round(n+s/2),width:0,height:0},"chromecast")}}))};_onWindowPositionChanged=e=>{e===this.context.vivaldiWindowId&&this._sendBatchedUpdatedBounds()};_sendBatchedUpdatedBounds=()=>{this._resizeDelayRunning||(this._resizeDelayRunning=!0,setTimeout((()=>{this._updateDialogPositions(),this._resizeDelayRunning=!1}),500))};onUrlbarResized=e=>{this._sendBatchedUpdatedBounds()};onSetBookmarked=e=>y.Z.bookmarks.create(e).then((t=>(ie.Z.showBookmarkAddedPopup(z.ZP.getId(),{pageId:this.props.id,url:e.url??"",isActive:!0}),t)));onBaseDomainObscured=e=>{this.setState({isBaseDomainObscured:e})};render(){const{preview:e=!1}=this.props;if(e)return(0,fn.jsx)("input",{type:"text",value:(0,le.Z)("url","Address"),...Or({draggable:this.props.draggable,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,onDragEnter:this.props.onDragEnter,onDragOver:this.props.onDragOver,onDragLeave:this.props.onDragLeave,onDrop:this.props.onDrop}),readOnly:!0});const{prefValues:t,url:n}=this.props,i=d4(this.state.editUrl),s=St.jk.isInternalUrl(n)||n.startsWith("chrome://"),o=(0,Ni.C3)(escape(n))&&!(s||(0,Ni.Sc)(n)||(0,Ni.tn)(n)),a=this.state.typedHistory.length>0?(0,le.Z)("Show typed history"):(0,le.Z)("Enter an address to activate typed history"),r=(0,le.Z)("Save your password"),l=t[D.kAddressBarTypedHistoryEnabled]&&!0!==this.props.readonly,d=this.props.menuOrigin||"bottomLeft",c=this.props.popupPosition||"below",h=this.state.feeds.get(this.props.id)||[],p=h.length,u=c4(this.state.urlFragments),g=function(e){return Boolean(e)&&!St.jk.isInternalUrl(e)&&!St.jk.isNewTabPage(e)}(n),{isBaseDomainObscured:m}=this.state,v=(0,Jt.TR)(n),f=en.ZP.isReady()&&void 0!==this.props.id&&v,y=i?{favIconUrl:i.faviconUrl,favIconType:"img"}:this.state.itemFavIcon;return(0,fn.jsxs)("div",{className:mn()("UrlBar-AddressField",this.props.buttonClasses,c),onFocus:this.trackContextOnFocus,...Or({draggable:this.props.draggable,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,onDragEnter:this.props.onDragEnter,onDragOver:this.props.onDragOver,onDragLeave:this.props.onDragLeave,onDrop:this.props.onDrop}),children:[o4("div",{className:"toolbar-insideinput"},void 0,o4(Qw,{blockerVisible:o,position:c,tabIndex:t[D.kKeyboardTabToAll],pageId:this.props.id,url:n})),(0,fn.jsx)(Yb,{ref:this.siteInfoElm,draggable:!s,isEditingUrl:this._isEditingUrl(),isInternal:s,isUrlEmpty:this._isUrlEmpty(),onDragStart:this.setUrlDragEvent,fieldGo:this.onSiteInfoButtonFieldGo,sslIssuer:this.state.sslInfo?.issuer,sslState:this.state.sslInfo?.state,tabIndex:t[D.kKeyboardTabToAll],itemFavIcon:y}),o4("div",{className:"UrlBar-UrlFieldWrapper"},void 0,o4(ts,{className:"observer",onResize:this.onUrlbarResized},void 0,(0,fn.jsx)(oS,{stateResetKey:s||this.props.id,ref:this.refUrlField,onBaseDomainObscured:this.onBaseDomainObscured,urlFragments:this.state.urlFragments,onSubmit:this.handleUrlFieldSubmit,className:"UrlBar-UrlField url vivaldi-addressfield uifocusstop",editUrl:this.state.editUrl,displayUrl:u,pageId:this.props.id,pageUrl:n,onUrlDrag:this.setUrlDragEvent,autoFocus:!1,autocompletionEnabled:t[D.kAddressBarAutocompleteEnabled],onBlur:this.onUrlFieldBlur,onFocus:this.onUrlFieldFocus,onDrop:this.onUrlFieldDrop,onChange:this.onCurrItemChanged,placeholder:t[D.kAddressBarInlineSearchEnabled]?(0,le.Z)("Search or enter an address"):(0,le.Z)("Enter an address"),showDropdown:!0,typedHistory:this.state.typedHistory,topSites:this.state.topSites,autocompleteOnTitle:!0,defaultSearchEngine:this.state.defaultSearchEngine,typedSearchEngine:i,readonly:this.props.readonly}))),o4("div",{className:"toolbar toolbar-small toolbar-insideinput"},void 0,m&&o4("div",{title:(0,le.Z)("Caution!\nThe entire domain name cannot be shown. Make sure you trust this website before submitting data."),className:"UrlBar-UrlObfuscationWarning",dangerouslySetInnerHTML:{__html:cn.Si$.small}}),(0,fn.jsx)(ab,{pageId:this.props.id,ref:this.refPageloadProgress,open:!s}),o4(Tb,{pageId:this.props.id,pagePermissions:this.state.permissionInfo,popupPosition:c}),this.state.blockedPopups.size>0&&(0,fn.jsx)(Nb,{ref:this.refPopupBlockerNotificator,url:n,blockedPopups:this.state.blockedPopups,onPopupAllowed:this.onPopupAllowed,popupPosition:c}),this.state.blockedPageContent.size>0&&o4(ew,{pageId:this.props.id,url:n,position:c,blockedPageContent:this.state.blockedPageContent}),p>0&&o4(Bb,{feeds:h}),this.state.showPasswordIcon&&(0,fn.jsx)(sl,{ref:this.passwordElm,className:"password-icon",tooltip:r,onClick:this.showPasswordDialog,image:cn.hXX,tabIndex:0,onFocus:this.onPasswordFocus}),!s&&this.state.supportsReaderMode&&o4(sl,{menu:this.getReaderContextMenu,menuOrigin:d,isPressed:this.state.isReaderModeActive,image:cn.sWI,onClick:this.onReaderModeClicked,tooltip:(0,le.Z)("Reader View")}),g&&t[D.kAddressBarShowQrGenerator]&&o4(xb,{popupPosition:c,size:this.props.size,data:n}),g&&o4(rC,{popupPosition:c,size:this.props.size,tabId:this.props.id,url:n}),f&&o4(Rw,{setBookmarked:this.onSetBookmarked,pageId:this.props.id,bookmarkData:this.state.bookmarkData,popupPosition:c},n),l&&o4("div",{className:"button-toolbar drop-down-menu"},void 0,o4("button",{title:a,tabIndex:t[D.kKeyboardTabToAll],disabled:0===this.state.typedHistory.length,onMouseDown:this.toggleTypedHistory,dangerouslySetInnerHTML:{__html:cn.V34}})))]})}}const p4=(0,fs.Z)(Br(h4),a4);var u4;function g4(e,t,n,i){u4||(u4="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:u4,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const m4=[D.kBiscuitVersion,D.kPanelsPosition,D.kMailIsTurnedOff],v4=(0,le.Z)("$1 click to toggle panel floating",[(0,le.Z)("key","Control")]),f4=function(e){const t=W.Z.unsafeGetActivePage(e);return{activePageUrl:t.url,activePageId:t.id,active:t.active,favIconUrl:t.favIconUrl,isMailPage:t.isMailPage&&!M.Z.get(D.kMailIsTurnedOff)}};let y4="";class w4 extends tn.PureComponent{static contextType=dn.Z;_isMounted=!1;constructor(e,t){super(e),this.winId=t.vivaldiWindowId,this.state={panelBarVisible:Dl.ZP.getIsBarVisible(this.winId),statusBarDisplay:z.ZP.getVisibleUI(this.winId).statusBar,...f4(this.winId)}}componentDidMount(){this._isMounted=!0,W.Z.addListener(this._onPageStoreChange),Dl.ZP.addListener(this._onPanelStoreChanged),z.ZP.addListener(this._onWindowStoreChanged)}componentWillUnmount(){this._isMounted=!1,Dl.ZP.removeListener(this._onPanelStoreChanged),W.Z.removeListener(this._onPageStoreChange),z.ZP.removeListener(this._onWindowStoreChanged)}_onPageStoreChange=()=>{this._isMounted&&this.setState(f4(this.winId))};_onPanelStoreChanged=e=>{this._isMounted&&e===this.winId&&this.setState({panelBarVisible:Dl.ZP.getIsBarVisible(this.winId)})};_onWindowStoreChanged=()=>{const e=z.ZP.getVisibleUI(this.winId).statusBar;this._isMounted&&this.state.statusBarDisplay!==e&&this.setState({statusBarDisplay:e})};render(){const{preview:e,name:t,size:n,label:i,popupPosition:s,customizeMenu:o,draggable:a,onDragStart:r,onDragEnd:l,onDrop:c,onDragEnter:h,mimeType:p,menuOrigin:u}=this.props,g={size:n,name:t,customizeMenu:o,menuOrigin:u,draggable:a,popupPosition:s,onDragStart:r,onDragEnd:l,onDrop:c,onDragEnter:h,mimeType:p};switch(this.props.name){case"AddressField":return(0,fn.jsx)(p4,{...g,readonly:!1,url:this.state.activePageUrl,id:this.state.activePageId,active:this.state.active,favIconUrl:this.state.favIconUrl,label:i,preview:this.props.inEditor});case"SearchField":return(0,fn.jsx)(iy,{...g,className:"UrlBar-SearchField",label:i,preview:this.props.inEditor});case"PanelToggle":return(0,fn.jsx)(sl,{...g,className:"panel-clickoutside-ignore",tooltip:this.state.panelBarVisible?(0,le.Z)("Hide Panel")+"\n"+v4:(0,le.Z)("verb","Show Panel")+"\n"+v4,onClick:()=>Ho.Z.togglePanel(this.winId),onMiddleClick:Ho.Z.toggleFloating,style:{transform:"right"===this.props.prefValues[D.kPanelsPosition]?"scaleX(-1)":"unset"},image:cn.sxI[this.props.size],label:i});case"SyncStatus":return!z.ZP.isIncognitoOrGuest(this.winId)&&(0,fn.jsx)(xy,{...g});case"StatusInfo":return"overlay"!==this.state.statusBarDisplay||this.props.preview?(0,fn.jsx)(by,{...g,preview:e}):null;case"VersionInfo":return this.props.prefValues[D.kBiscuitVersion]?g4("div",{className:"biscuit-setting-version"},void 0,g4("span",{className:"application-icon-biscuit",dangerouslySetInnerHTML:{__html:cn.Qa2}}),g4("span",{className:"biscuit-string"},void 0," ",function(){if(!y4){const{vivaldiVersion:e,chromiumVersion:t}=d.Z.utilities.getVersion();y4=`Vivaldi ${e} / Chrome ${t}`}return y4}()," ")):null;case"CaptureImages":return(0,fn.jsx)(xv,{...g,winId:this.context.vivaldiWindowId});case"TilingToggle":return(0,fn.jsx)(Gy,{...g,pageId:this.state.activePageId,disabled:!1});case"ImagesToggle":return(0,fn.jsx)(Uy,{...g,disabled:!1});case"PageActions":return(0,fn.jsx)(Bv,{...g,pageId:this.state.activePageId,disabled:!1});case"Zoom":return(0,fn.jsx)(Qv,{...g,pageId:this.state.activePageId,preview:this.props.inEditor});default:return null}}}const b4=(0,fs.Z)(w4,m4),C4={onDidAbortWithError:(0,le.Z)("Update Error"),onDidFindValidUpdate:(0,le.Z)("Update Available"),onUpdaterDidNotFindUpdate:(0,le.Z)("Already up to date"),onWillDownloadUpdate:(0,le.Z)("Downloading Update"),onDidDownloadUpdate:(0,le.Z)("Update Downloaded"),onWillInstallUpdateOnQuit:(0,le.Z)("Update Ready"),onUpdaterDidRelaunchApplication:(0,le.Z)("Vivaldi was Updated")},S4={onDidAbortWithError:(0,le.Z)("Unable to check for update."),onDidFindValidUpdate:(0,le.Z)("Vivaldi update is available."),onUpdaterDidNotFindUpdate:(0,le.Z)("Vivaldi is up to date."),onWillDownloadUpdate:(0,le.Z)("Downloading Vivaldi update."),onDidDownloadUpdate:(0,le.Z)("Update downloaded."),onWillInstallUpdateOnQuit:(0,le.Z)("Restart Vivaldi to complete the update."),onUpdaterDidRelaunchApplication:(0,le.Z)("Vivaldi was updated.")};class T4 extends Z.Z{getInitialState(){return{message:void 0,status:void 0,version:void 0,releaseNotesUrl:void 0}}reduce(e,t){return"VIVALDI_AUTOUPDATE_SET_STATUS"===t.actionType?(0,E.ZP)(e,(e=>{e.message=t.message,e.status=t.status,e.version=t.version,e.version=t.releaseNotesUrl})):e}}const I4=new T4;var k4;function A4(e,t,n,i){k4||(k4="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:k4,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var Z4=A4("br",{}),E4=A4("br",{});class _4 extends tn.Component{static contextType=dn.Z;render(){const{message:e,status:t,version:n,releaseNotesUrl:i}=this.props.updateState;return t?(0,fn.jsxs)(fn.Fragment,{children:[A4("h2",{},void 0,C4[t]),A4("div",{className:"popup-scrollarea"},void 0,"onWillInstallUpdateOnQuit"===t&&n?(0,fn.jsxs)(fn.Fragment,{children:[A4("p",{className:"popup-infotext"},void 0,(0,le.Z)("Restart Vivaldi to complete the update to version $1.",[n])),Z4]}):A4("p",{className:"popup-infotext"},void 0,S4[t]),e&&(0,fn.jsxs)(fn.Fragment,{children:[E4,A4("p",{className:"popup-infotext"},void 0,e)]})),A4("footer",{className:"dialog-footer"},void 0,i&&A4("input",{type:"submit",className:"primary",onClick:()=>{i&&Y.Z.openURL(this.context.vivaldiWindowId,i),this.props.hidePopup()},value:(0,le.Z)("Show Release Notes")}),"onWillInstallUpdateOnQuit"===t&&A4("input",{type:"submit",className:"danger",onClick:()=>d.Z.autoUpdate.installUpdateAndRestart(),value:(0,le.Z)("browser","Restart")}))]}):null}}const N4=_4;var M4;function P4(e,t,n,i){M4||(M4="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:M4,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class D4 extends tn.PureComponent{constructor(){super(),this.state={popupVisible:!1,updateState:I4.getState()}}componentDidMount(){I4.addListener(this.#P)}componentWillUnmount(){I4.removeListener(this.#P)}#P=()=>{this.setState({updateState:I4.getState()})};togglePopup=()=>{this.setState((e=>({popupVisible:!e.popupVisible})))};hidePopup=()=>{this.setState({popupVisible:!1})};render(){let{status:e}=this.state.updateState;if(!e&&this.props.preview)e="onUpdaterDidNotFindUpdate";else if(!e)return null;return P4(sl,{image:cn.nuh[this.props.size],title:C4[e],onClick:this.togglePopup,customizeMenu:this.props.customizeMenu,menuOrigin:this.props.menuOrigin,popupClassName:"UpdatePopup ToolbarButtonPopup-DefaultStyles",popupPosition:this.props.popupPosition,hidePopup:this.hidePopup,isPopupVisible:this.state.popupVisible,size:this.props.size,draggable:this.props.draggable,onDragStart:this.props.onDragStart??Tl.default,onDragEnd:this.props.onDragEnd??Tl.default,onDrop:this.props.onDrop??Tl.default,onDragEnter:this.props.onDragEnter??Tl.default,onDragLeave:this.props.onDragLeave??Tl.default,onDragOver:this.props.onDragOver??Tl.default,mimeType:this.props.mimeType,name:this.props.name},void 0,P4(N4,{hidePopup:this.hidePopup,updateState:this.state.updateState}))}}const x4=Br(D4);var O4;function L4(e,t,n,i){O4||(O4="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:O4,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const R4=[D.kMailViewLayout,D.kPanelsAsOverlayEnabled,D.kPanelsPosition];class B4 extends tn.PureComponent{static contextType=dn.Z;state={enforcedWidth:0};componentDidMount(){this.setSpacerWidth()}componentWillUnmount(){Dl.ZP.ensureRemovedListener(this.setSpacerWidth)}shouldEnforceWidth=()=>this.props.index<=6&&"FlexibleSpacer"===this.props.name&&"left"===this.props.prefValues[D.kPanelsPosition]&&W.Z.getActivePage(this.context.vivaldiWindowId)?.isMailPage;setSpacerWidth=()=>{if(!this.shouldEnforceWidth())return;Dl.ZP.ensureAddedListener(this.setSpacerWidth);const e=this.getLeftSpacerStyle();this.setState({enforcedWidth:e})};getLeftSpacerStyle(){if(this.props.prefValues[D.kPanelsAsOverlayEnabled])return 6;const e=Dl.ZP.getWidth(this.context.vivaldiWindowId),t=function(e){switch(e){case"large":return 34;case"medium":return 28;case"small":return 16}}(this.props.size),n=this.props.index*t;return Math.max(e-n,6)}executeChain=e=>{const{ctrlKey:t,altKey:n,shiftKey:i,metaKey:s}=e,{chain:o}=M.Z.get(D.kChainedCommandsCommandList).find((e=>e.name===this.props.name));(0,fg.hT)({windowId:this.context.vivaldiWindowId,keyState:{ctrlKey:t,altKey:n,shiftKey:i,metaKey:s,key:""}},o)};render(){if(this.props.commandButton){const e=M.Z.get(D.kChainedCommandsCommandList).find((e=>e.name===this.props.name));return e?L4(sl,{name:e.name,customizeMenu:this.props.customizeMenu,image:cn.Znx[this.props.size],draggable:this.props.draggable,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,onDrop:this.props.onDrop,onDragEnter:this.props.onDragEnter,className:"toolbar-command",tooltip:e.label,onClick:this.executeChain,mimeType:this.props.mimeType}):null}const e="FlexibleSpacer"===this.props.name,t=e?cn.K3w[this.props.size]:cn.Vzw[this.props.size],n=this.state.enforcedWidth?{minWidth:this.state.enforcedWidth,maxWidth:this.state.enforcedWidth}:{};return L4(sl,{style:n,customizeMenu:this.props.customizeMenu,name:this.props.name,image:t,mimeType:this.props.mimeType,draggable:this.props.draggable,onDragStart:this.props.onDragStart,onDragEnd:this.props.onDragEnd,onDrop:this.props.onDrop,onDragEnter:this.props.onDragEnter,className:e?"toolbar-spacer-flexible":"toolbar-spacer",tooltip:" "})}}const F4=(0,fs.Z)(B4,R4);class U4 extends tn.Component{render(){const{index:e,name:t,preview:n,label:i="",customizeMenu:s=[],popupPosition:o="below",menuOrigin:a="bottomLeft",mimeType:r,size:l,onDragStart:d,onDragEnd:c,onDrop:h,onDragEnter:p,draggable:u}=this.props,g={name:t,label:i,customizeMenu:s,size:l,popupPosition:o,menuOrigin:a,draggable:u,onDragStart:d,onDragEnd:c,onDrop:h,onDragEnter:p,mimeType:r,preview:n};if(t.startsWith("COMMAND_"))return(0,fn.jsx)(F4,{...g,commandButton:!0,index:e});switch(t){case"Back":case"Forward":case"Rewind":case"FastForward":case"Reload":case"Home":return(0,fn.jsx)(mv,{...g});case"BreakMode":return(0,fn.jsx)(sc,{...g});case"Clock":return(0,fn.jsx)(xh,{...g});case"AccountButton":return(0,fn.jsx)(Od,{...g});case"ReadingList":return(0,fn.jsx)(Nv,{...g});case"Extensions":return(0,fn.jsx)(Tg,{...g});case"UpdateButton":return(0,fn.jsx)(x4,{...g});case"MailStatus":return(0,fn.jsx)(xm,{...g});case"CalendarStatus":return(0,fn.jsx)(ih,{...g});case"DownloadButton":return(0,fn.jsx)(ug,{...g});case"AddressField":case"SearchField":case"PanelToggle":case"SyncStatus":case"StatusInfo":case"VersionInfo":case"CaptureImages":case"TilingToggle":case"ImagesToggle":case"PageActions":case"Zoom":return(0,fn.jsx)(b4,{...g,inEditor:this.props.inEditor});case"MailBack":case"MailForward":case"MailReload":case"MailRenderingMethod":case"MailViewLayout":case"MailViewThreading":return(0,fn.jsx)(Gg,{...g,disabled:!1});case"MailSearch":return(0,fn.jsx)(Fg,{...g});case"MailMsgEdit":case"MailMsgReply":case"MailMsgReplyToAll":case"MailMsgForward":case"MailMsgStatusRead":case"MailMsgFlag":case"MailMsgLabel":case"MailMsgSend":case"MailMsgShowHeaders":case"MailMsgSpam":case"MailMsgDiscard":case"MailMsgAttach":case"MailMsgTrash":case"MailMsgMove":case"MailMsgArchive":case"MailCompose":return(0,fn.jsx)(cv,{...g});case"Game":return(0,fn.jsx)(Ng,{...g,isStartPage:!1});case"Spacer":case"FlexibleSpacer":return(0,fn.jsx)(F4,{...g,index:e});default:return console.warn(`ToolbarButton “${t}” not found`),null}}}var V4;function W4(e,t,n,i){V4||(V4="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:V4,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const H4="vivaldi/x-button-toolbar",z4="vivaldi/x-toolbar-name",G4="vivaldi/x-button-index",$4=["Spacer","FlexibleSpacer"];let K4=!1;class j4 extends tn.PureComponent{static contextType=dn.Z;_dropOnSelf=!1;_dragIndex=null;state={modifier:!1,editMode:""!==jr.getState(),buttons:this.props.name?this.props.showDefaultSet?M.Z.getDefault(this.props.name):M.Z.get(this.props.name):[],dragging:!1};componentDidMount(){this.props.name&&!this.props.showDefaultSet&&(M.Z.addListener(this.props.name,this.onPrefsChanged),jr.addListener(this.editModeListener),d.Z.tabsPrivate.onKeyboardChanged.addListener(this.modifierKeyListener))}componentWillUnmount(){this.props.name&&!this.props.showDefaultSet&&(M.Z.removeListener(this.props.name,this.onPrefsChanged),jr.removeListener(this.editModeListener),d.Z.tabsPrivate.onKeyboardChanged.removeListener(this.modifierKeyListener))}modifierKeyListener=(e,t,n)=>{this.setState({modifier:2===n})};editModeListener=()=>{this.setState({editMode:""!==jr.getState()})};onPrefsChanged=(e,t)=>{this.setState({buttons:t})};editToolbar=e=>bd.Z.edit(e);reset=()=>{this.props.name&&nt.Z.reset(this.props.name)};removeButton=e=>{if(!this.props.name)return;const t=M.Z.get(this.props.name);this.props.name&&nt.Z.set(this.props.name,t.filter(((t,n)=>e!==n)))};onDragEnter=e=>this._dragIndex=e;onDrop=(e,t,n)=>{this.setState({dragging:!1});const i=e.dataTransfer.getData(H4);if(!i)return;e.stopPropagation(),K4=!0;let s=this.state.buttons.slice();const o="right"===t?1:0,a=e.currentTarget.classList.contains("toolbar-droptarget")?s.length:(this._dragIndex||0)+o,r=parseInt(e.dataTransfer.getData(G4));this._dropOnSelf=this.props.name===e.dataTransfer.getData(z4),this._dropOnSelf?(s[r]=null,s.splice(a,0,i),this.props.name&&nt.Z.set(this.props.name,s.filter((e=>e)))):(s.splice(a,0,i),$4.includes(i)||(s=s.filter(((e,t)=>e!==i||t===a))),this.props.name&&nt.Z.set(this.props.name,s))};getButtonMenu=e=>[G.Z.separatorItem,{items:[{handler:this.removeButton.bind(this,e),...(0,Mn.Z)("Remove from Toolbar")},G.Z.separatorItem,{handler:()=>this.editToolbar(this.props.name||D.kToolbarsNavigation),...(0,Mn.Z)("Customize Toolbar")},{handler:this.reset,...(0,Mn.Z)("Reset Toolbar to Default")}],...(0,Mn.Z)("command","Edit")}];getToolbarMenu=e=>{e.target.classList?.contains("toolbar")&&(0,zi.Z)(this.context.vivaldiWindowId,[{handler:()=>this.editToolbar(this.props.name||D.kToolbarsNavigation),...(0,Mn.Z)("Customize Toolbar")},{handler:this.reset,...(0,Mn.Z)("Reset Toolbar to Default")}])(e)};onDragOver=e=>e.preventDefault();render(){return W4("div",{className:mn()("toolbar","toolbar-droptarget",this.props.className,"toolbar-"+this.props.size,{dragging:this.state.dragging}),onContextMenu:this.getToolbarMenu,onDragOver:this.onDragOver,onDrop:this.onDrop},void 0,this.state.buttons.map(((e,t)=>W4(U4,{index:t,name:e,preview:this.props.showDefaultSet||this.state.editMode,menuOrigin:this.props.menuOrigin,customizeMenu:this.getButtonMenu(t),popupPosition:this.props.popupPosition,size:this.props.size,draggable:this.state.editMode||this.state.modifier,inEditor:this.props.showDefaultSet,onDragStart:e=>{K4=!1,this._dropOnSelf=!1,e.dataTransfer.setData(G4,t),e.dataTransfer.setData(z4,this.props.name),this.setState({dragging:!0})},onDragEnd:e=>{!this._dropOnSelf&&K4&&this.removeButton(t),this._dropOnSelf=!1,this._dragIndex=null,this.setState({dragging:!1,modifier:!1})},onDrop:this.onDrop,onDragEnter:()=>{this.onDragEnter(t)},mimeType:H4},t))),this.props.name===D.kToolbarsNavigation&&z.ZP.isIncognito(this.context.vivaldiWindowId)&&W4("div",{className:"UrlBar-PrivateWindowIndicator",title:(0,le.Z)("Private Browsing Window"),dangerouslySetInnerHTML:{__html:n(2018)+(0,le.Z)("Private")}}))}}var Y4;function X4(e,t,n,i){Y4||(Y4="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Y4,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Q4=[D.kToolbarsMail,D.kToolbarsMailComposer,D.kToolbarsMailMessage];class q4 extends tn.PureComponent{render(){const{menuOrigin:e,popupPosition:t,url:n}=this.props;return(0,fn.jsxs)(fn.Fragment,{children:[!n&&X4(j4,{className:"toolbar-mainbar toolbar-mailbar",menuOrigin:e,popupPosition:t,size:"large"}),!(0,xg.vE)(n)&&!(0,xg.Ds)(n)&&X4(j4,{name:D.kToolbarsMail,className:"toolbar-mainbar toolbar-mailbar",menuOrigin:e,popupPosition:t,size:"large"}),(0,xg.Ds)(n)&&X4(j4,{name:D.kToolbarsMailMessage,className:"toolbar-mainbar toolbar-mailbar message",menuOrigin:e,popupPosition:t,size:"large"}),(0,xg.vE)(n)&&X4(j4,{name:D.kToolbarsMailComposer,className:"toolbar-mainbar toolbar-mailbar composer",menuOrigin:e,popupPosition:t,size:"large"})]})}}const J4=(0,fs.Z)(q4,Q4);var e6;function t6(e,t,n,i){e6||(e6="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:e6,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const n6=[D.kAddressBarPosition];function i6(e){return{url:e.url,isMailPage:e.isMailPage&&!M.Z.get(D.kMailIsTurnedOff)}}class s6 extends tn.PureComponent{static contextType=dn.Z;state={...i6(W.Z.unsafeGetActivePage(this.context.vivaldiWindowId))};componentDidMount(){W.Z.addListener(this.pageStoreChanged)}componentWillUnmount(){W.Z.removeListener(this.pageStoreChanged)}pageStoreChanged=()=>{const e=W.Z.getActivePage(this.context.vivaldiWindowId);e&&this.setState(i6(e))};render(){const e="top"===this.props.prefValues[D.kAddressBarPosition],t=e?"bottomLeft":"topLeft",n=e?"below":"above";return t6(vs.Z,{focusName:"focus_mainbar",className:"mainbar"},void 0,this.state.isMailPage?t6(J4,{url:this.state.url,menuOrigin:t,popupPosition:n}):t6(j4,{name:D.kToolbarsNavigation,className:"toolbar-mainbar",menuOrigin:t,popupPosition:n,size:"large"}))}}const o6=(0,fs.Z)(s6,n6);var a6;function r6(e,t,n,i){a6||(a6="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:a6,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class l6 extends tn.PureComponent{constructor(e){super(e),this.state={folderName:""}}addMailFolder=()=>{te.Z.createMailbox(this.props.options.accountId,this.state.folderName),this.props.onClose()};onDismiss=()=>{this.props.onClose()};onChange=e=>{const{value:t}=e.target;this.setState({folderName:t})};render=()=>r6("div",{className:"dialog-add-folder-name"},void 0,r6("header",{className:"dialog-header"},void 0,r6("h1",{},void 0,(0,le.Z)("Create Folder for $1",[this.props.options.accountId]))),r6("div",{className:"dialog-content"},void 0,r6("input",{type:"text",placeholder:(0,le.Z)("mail","New Folder"),onChange:this.onChange,title:(0,le.Z)("Folder Name"),value:this.state.folderName,name:"folderName"})),r6("footer",{className:"dialog-footer"},void 0,r6("input",{type:"button",value:(0,le.Z)("Create Folder"),className:"primary",onClick:this.addMailFolder,disabled:!this.state.folderName}),this.props.dismissable&&r6("input",{type:"button",onClick:this.onDismiss,value:(0,le.Z)("Cancel")})))}const d6=l6;var c6,h6;function p6(e,t,n,i){c6||(c6="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:c6,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function u6(e){const[t,n]=tn.useState(!1);return p6("div",{className:"CalendarAccountSheet"},void 0,p6("button",{className:"CalendarAccountSheet-Exit",onClick:e.onClose},void 0,p6("span",{dangerouslySetInnerHTML:{__html:cn.vyJ}})),!t&&p6("div",{className:"setting-section"},void 0,p6(nx,{searchableStrings:Cx,filter:"",showTips:()=>n(!0),done:e.onClose,onboarding:!0})),t&&p6(gx,{onClose:e.onClose,windowId:e.windowId,onboarding:!0}))}function g6(e,t,n,i){h6||(h6="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:h6,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const{mixedToStrings:m6}=kr;function v6(e){e&&e.target.addEventListener("click",Cs.Z,{once:!0})}const f6=function(e){const[t,n]=(0,tn.useState)(""),{document:i,vivaldiWindowId:s}=tn.useContext(dn.Z),{editor:a}=e,{eventDraft:r}=LD(a.pageId),l=tn.useRef(!1);if(tn.useEffect((()=>()=>{l.current||o.Z.endEventEdit(s,a)}),[s,a]),!r)return null;function d(){requestAnimationFrame((()=>{const e=i.getElementsByClassName("calendar-grid")[0];e instanceof HTMLElement&&e.focus()}))}async function c(t){l.current=!0,v6(t);try{await o.Z.saveEventEdit(s,a)&&e.onClose().then(d)}catch(e){de.Z.warn("Calendar",["Event not created"],e),n(e)}}function h(t){l.current=!0,v6(t),o.Z.cancelEventEdit(a),e.onClose().then(d)}return g6(OD.Provider,{value:{displayDensity:"full",editor:a,isActivePage:!1,isPanel:!1}},void 0,g6("div",{className:"dialog-add-event",onKeyDown:function(e){const t=kA.Z[e.keyCode];"Enter"!==t||e.shiftKey?"Escape"===t&&h():(e.preventDefault(),e.stopPropagation(),c())}},void 0,g6("div",{className:"dialog-content"},void 0,g6(BY,{event:r}),t&&g6(Tr,{type:"info"},void 0,m6([t]))),g6("footer",{className:"dialog-footer"},void 0,g6("input",{type:"button",className:"primary",value:r.id?(0,le.Z)("calendar","Done"):r.task?(0,le.Z)("Add Task"):(0,le.Z)("Add Event"),onClick:c}),g6("input",{type:"button",value:(0,le.Z)("Cancel"),onClick:h}),!!r.id&&g6("input",{type:"button",value:(0,le.Z)("verb","Delete"),onClick:function(t){l.current=!0,v6(t),o.Z.trashEvent(s,a,r.id),e.onClose().then(d)}}))))};var y6,w6=n(34155);function b6(e,t,n,i){y6||(y6="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:y6,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const{ensureHttpsForWebcal:C6}=oc.Z,{createLocalAccountAndCalendar:S6}=xD.Z,T6="OpenIcsFileDialog";const I6=function(e){const{windowId:t,filePath:n}=e,[i,s]=(0,tn.useState)("init"),[a,r]=(0,tn.useState)([]),[l,c]=(0,tn.useState)({createNew:0===Lo.Z.getCalendars().length,calendarId:Lo.Z.getDefaultCalendar()?.id??"",newCalendarName:(0,le.Z)("New Calendar"),importId:""});(0,tn.useEffect)((()=>{!async function(e){let i="";i=e?await jo(C6(n)):await d.Z.mailPrivate.readFileToText(n);const a=await(0,vA.Z)(i).VEVENT,l=a.length;if(r(a),0===l)s("noEventFound");else if(1===l){const e=(0,Xo.rP)(a[0]);o.Z.addEventCommand(t,e)}else l>1&&s("eventsFound")}(function(e){return e.startsWith("webcal")||e.startsWith("http")}(n)),s("readingFile")}),[t,n]);const h=function(e){const[t,n]=(0,tn.useState)(e.getState());return(0,tn.useEffect)((()=>{function t(){n(e.getState())}return e.addListener(t),()=>e.removeListener(t)}),[e]),t}(va);async function p(){if(!a.length)return void s("noEventFound");s("importStarted");const{newCalendarName:e}=l;let{calendarId:t}=l;if(l.createNew){const{calendar:n}=await S6(null,{name:"",description:e,accountId:""});if(!n)return s("importError"),void de.Z.error("Calendar",["import"],"Error creating calendar: ",e);t=n.id}else{if(!Lo.Z.getCalendars().find((e=>e.id===l.calendarId)))return void s("importError")}w6.nextTick((async()=>{await(0,Xo.CJ)(t,a,T6),s("importFinished")}))}function u(){Wo.Z.clearImportProgress("Calendar",T6),e.onClose()}let g=0,m=0,v=0;return h.Calendar?.OpenIcsFileDialog&&(g=h.Calendar.OpenIcsFileDialog.current,m=h.Calendar.OpenIcsFileDialog.total,v=Math.round(g/m*100)),b6("div",{className:"dialog-import-events",onKeyDown:function(e){const t=kA.Z[e.keyCode];"Enter"!==t||e.shiftKey?"Escape"===t&&u():(e.preventDefault(),e.stopPropagation(),p())}},void 0,b6("header",{className:"dialog-header"},void 0,b6("h1",{className:"dialog-title"},void 0,(0,le.Z)("Calendar Import"))),b6("div",{className:"dialog-content"},void 0,b6("div",{},void 0,function(e){switch(e){case"init":return(0,le.Z)("Import Events");case"readingFile":return(0,le.Z)("Reading file...");case"parsingIcsEvents":return(0,le.Z)("Parsing event(s)...");case"eventsFound":return(0,le.Z)("Events found: $1",[a.length]);case"importStarted":return(0,le.Z)("Importing...");case"importFinished":return(0,le.Z)("Import Finished");case"noEventFound":return(0,le.Z)("No event(s) found");case"importError":return(0,le.Z)("Import Error");default:return""}}(i)),"eventsFound"===i&&b6(Uo,{calendarChange:function(e,t){c(t)},importOption:l}),g>0&&b6("span",{},void 0,(0,le.Z)("Imported $1 of $2 ($3%)",[g,m,v]))),b6("footer",{className:"dialog-footer"},void 0,"eventsFound"===i&&(0,fn.jsx)(fn.Fragment,{children:b6("input",{type:"button",className:"primary",onClick:p,value:(0,le.Z)("Import")})}),b6("input",{type:"button",value:(0,le.Z)("Close"),onClick:u})))};var k6;function A6(e,t,n,i){k6||(k6="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:k6,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Z6=function(e){const{document:t}=tn.useContext(dn.Z),{modal:n,resolve:i=(e=>{})}=e;return A6(ln.Z,{viewMode:"calendar-dialog slide",onRequestClose:()=>i({action:n.cancelAction.action})},void 0,A6("header",{className:"dialog-header"},void 0,A6("h1",{className:"dialog-title"},void 0,n.title)),A6("div",{className:"dialog-content"},void 0,n.body,n.inputs&&A6("div",{className:"dialog-inputs"},void 0,n.inputs.map(((e,t)=>A6(tn.Fragment,{},t,A6("label",{htmlFor:e.name},void 0,e.label),A6("textarea",{name:e.name}))))),n.checks&&A6("div",{className:"dialog-inputs"},void 0,n.checks.map(((e,t)=>A6("label",{},t,A6("input",{type:"checkbox",name:e.name}),A6("span",{},void 0,e.label)))))),A6("footer",{className:"dialog-footer"},void 0,n.actions.concat([n.cancelAction]).map((s=>A6("input",{autoFocus:s.default,onClick:()=>{!function(e){const s=n.checks?.reduce(((e,{name:n})=>{const i=t.querySelector(`input[name="${n}"]`);return i instanceof HTMLInputElement&&(e[n]=Boolean(i.checked)),e}),{}),o=n.inputs?.reduce(((e,{name:n})=>{const i=t.querySelector(`textarea[name="${n}"]`);return i instanceof HTMLTextAreaElement&&(e[n]=i.value),e}),{});i({action:e,checks:s,inputs:o})}(s.action),e.onClose()},type:"button",value:s.title},s.title)))))};var E6=n(5646),_6=n(96682);var N6;function M6(e,t,n,i){N6||(N6="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:N6,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const P6=function(e){const t=tn.useRef(),n=tn.useRef({}),[i,s]=tn.useState(!1),[o,a]=tn.useState(!1),r=tn.useContext(dn.Z),l=r.innerWidth,c=r.innerHeight,h=r.vivaldiWindowId,{children:p,effect:u,showDialog:g}=e,m=tn.useCallback((e=>{switch(e){case"showDialog":g();break;case"done":0===tn.Children.count(p)&&g(),a(!0)}}),[p,g]);return tn.useEffect((()=>{if(!i){const e={windowId:h,posX:0,posY:0,width:l,height:c,saveToDisk:!1};d.Z.thumbnails.captureUI(e,((e,i)=>{e?("melt"===u?n.current=function(e,t,n,i,s){const o=200,a=.04,r=1e3,l=Math.round(n/o),d=n/l,c=Math.round(i*a),h=4*c;let p="initial";const u=[];let g,m=0;const v=document.createElement("canvas");v.width=n,v.height=i;const f=v.getContext("2d"),y=new Image(n,i);return y.onload=()=>f.drawImage(y,0,0,n,i),y.src=t,{effect:function t(o){if(!e.current)return;if(0===u.length){for(let e=0;e<d;e++)u[e]=0===e?-Math.floor(Math.random()*h):u[e-1]+(Math.floor(Math.random()*c)-c/2),u[e]>0?u[e]=0:u[e]<-h&&(u[e]=-h);m=o}if(m===o)return void(g=requestAnimationFrame(t));const a=e.current.getContext("2d");let f=!0,y=0,w=i;const b=i*(o-m)/r;m=o,a.clearRect(0,0,n,i);for(let e=0;e<d;e++)u[e]+=b,u[e]<0?(f=!1,y=0):u[e]<i?(f=!1,y=u[e]):y=i,w=Math.min(y,w),a.drawImage(v,e*l,0,l,i,e*l,y,l,i);"showDialog"!==p&&w>i/2&&!f&&(p="showDialog",s(p)),f?s("done"):g=requestAnimationFrame(t)},cleanUp:function(){g&&cancelAnimationFrame(g)}}}(t,i,l,c,m):"burn"===u&&(n.current=function(e,t,n,i,s){const o=320,a=82,r=2,l=4.25,d=1600,c=1600;let h;const p=document.createElement("canvas");p.width=o,p.height=a;const u=p.getContext("2d"),g=u.getImageData(0,0,o,a),m=g.data,v=[];for(let e=0;e<256;e++)v[e]=Dr().hsl(Math.round(e/3),1,Math.min(1,e/192)).rgb();const f=[...Array(a).keys()].map((e=>Array(o)));for(let e=0;e<a;++e)for(let t=0;t<o;++t)f[e][t]=0;let y,w=r,b=l,C=0,S="initial";return{effect:function t(l){const T=e.current;if(!T)return;if(y=y||l,C===l)return void(h=requestAnimationFrame(t));const I=l-C;C=l;for(let e=0;e<o;e++)f[a-1][e]=Math.random()>.5?255:0;let k=0;for(let e=0;e<a-1;++e)for(let t=0;t<o;++t){let n=f[(e+1)%a][(t-1+o)%o]+f[(e+1)%a][t]+f[(e+1)%a][(t+1)%o]+f[(e+2)%a][t];n/=b,f[e][t]=Math.floor(n)}for(let e=0;e<a;++e)for(let t=0;t<o;++t){let n=e*o*4+4*t;k=f[e][t];const[i,s,a]=v[k],r=Math.min(255,2*(i+s+a));m[n]=i,m[++n]=s,m[++n]=a,m[++n]=r}u.putImageData(g,0,0);const A=T.getContext("2d");A.clearRect(0,0,n,i),A.drawImage(p,0,0,o,a-w,0,0,n,i);const Z=l-y;if(Z>d){"showDialog"!==S&&(S="showDialog",s(S));const e=Z-d;b+=I/c*3,w=Math.round(r+10*e/c)}Z>d+c?s("done"):h=requestAnimationFrame(t)},cleanUp:function(){h&&cancelAnimationFrame(h)}}}(t,0,l,c,m)),s(!0),requestAnimationFrame(n.current.effect)):(de.Z.warn("Calendar","Failed to capture UI for wipe effect"),s(!0),a(!0),g())}))}return()=>{n.current.cleanUp}}),[c,l,m,u,g,i,h]),(0,fn.jsxs)(fn.Fragment,{children:[i&&tn.Children.count(e.children)&&M6("div",{className:"wipe-container",onClick:e.showDialog},void 0,e.children),i&&!o&&(0,fn.jsx)("canvas",{width:l,height:c,ref:t})]})};var D6;function x6(e,t,n,i){D6||(D6="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:D6,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function O6(e){const[t,n]=tn.useState("5"),i=Lo.Z.getEvent(e.notification.event_id||""),s=tn.useRef(!1);if(tn.useEffect((()=>(s.current=!0,()=>{s.current=!1}))),!i)return null;const o=i.allDay?"L":"LT";return(0,fn.jsxs)(fn.Fragment,{children:[x6("div",{className:"CalendarNotification-Content"},void 0,x6("span",{className:"CalendarNotification-Time"},void 0,b()((0,bc.oJ)(i)).format(o)),x6("span",{className:"CalendarNotification-Text"},void 0,i.title)),x6("footer",{className:"dialog-footer CalendarNotifications-Footer"},void 0,x6("input",{className:"CalendarNotification-Button primary",type:"button",autoFocus:!0,value:(0,le.Z)("Dismiss"),onClick:()=>e.onClose(e.notification.id)}),x6("span",{},void 0,(0,le.Z)("or")),x6("input",{className:"CalendarNotification-Button",type:"button",value:(0,le.Z)("Snooze"),onClick:()=>{const n=parseInt(t);E6.Z.snooze(e.notification,i,n||5),e.onClose(e.notification.id)}}),x6("input",{className:"CalendarNotification-Input",type:"number",value:t,onChange:e=>{n(e.target.value)},onBlur:e=>{s.current&&!e.target.value&&n("5")}}),(0,le.Z)("minutes"))]})}var L6=x6("div",{className:"CalendarNotification-HoverBackground"});function R6(e){const t=t=>{E6.Z.snooze(e.notification,e.event,t),e.onClose(e.notification.id)},n=e.event.allDay?"L":"LT";return x6("div",{className:"CalendarNotification-Content"},void 0,x6("span",{className:"CalendarNotification-Time"},void 0,b()((0,bc.oJ)(e.event)).format(n)),x6("span",{className:"CalendarNotification-Text"},void 0,e.event.title),x6("div",{className:"CalendarNotification-Actions"},void 0,x6(sl,{title:(0,le.Z)("Snooze"),tabIndex:0,isMenuIndicatorVisible:!0,menu:()=>[{handler:()=>t(1),...(0,Mn.Z)("1 minute")},{handler:()=>t(5),...(0,Mn.Z)("5 minutes")},{handler:()=>t(15),...(0,Mn.Z)("15 minutes")},{handler:()=>t(30),...(0,Mn.Z)("30 minutes")},{handler:()=>t(60),...(0,Mn.Z)("1 hour")}],menuOrigin:"bottomRight"}),x6(sl,{onClick:()=>{e.onClose(e.notification.id)},title:(0,le.Z)("Dismiss"),tabIndex:0}),L6))}function B6(e){const t=tn.useMemo((()=>e.notifications.map((e=>{const t=Lo.Z.getEvent(e.event_id||"");return t?{notification:e,event:t}:null})).filter(Boolean).sort(((e,t)=>(0,bc.oJ)(e.event)-(0,bc.oJ)(t.event)))),[e.notifications]);tn.useEffect((()=>()=>{e.windowToRestore&&Ru.Z.restore(e.windowToRestore)}),[e.windowToRestore]);const[n,i]=tn.useState(1===t.length);return tn.useEffect((()=>{n&&t.length>1&&i(!1)}),[n,t.length]),x6(vs.Z,{focusName:"focus_notfications",forceTrap:!0},void 0,x6("div",{className:mn()("CalendarNotifications",{"CalendarNotifications--FadeUp":"up"===e.fade,"CalendarNotifications--FadeDown":"down"===e.fade})},void 0,x6("header",{className:"dialog-header CalendarNotifications-Header"},void 0,x6("span",{dangerouslySetInnerHTML:{__html:cn.l0O.medium}}),x6("span",{className:"CalendarNotifications-Title"},void 0,t.length>1?(0,le.Z)("Reminders"):(0,le.Z)("Reminder"))),!n&&(0,fn.jsxs)(fn.Fragment,{children:[x6("div",{className:"CalendarNotifications-List"},void 0,t.map((({notification:t,event:n})=>x6(R6,{notification:t,event:n,onClose:e.onClose},t.id)))),x6("footer",{className:"dialog-footer CalendarNotifications-Footer"},void 0,x6("input",{autoFocus:!0,className:"CalendarNotifications-Button primary",type:"button",value:(0,le.Z)("Dismiss All"),onClick:function(){e.notifications.forEach((t=>e.onClose(t.id)))}}))]}),n&&t[0]&&x6(O6,{notification:t[0].notification,event:t[0].event,onClose:e.onClose})))}const F6=function(e){const t=M.Z.get(D.kCalendarNotificationType),[n,i]=tn.useState(!("melt"===t||"burn"===t)),[s,o]=tn.useState(_6.Z.getState().activeNotifications),a=e.onClose,r=0!==s.length;tn.useEffect((()=>{function e(){const e=_6.Z.getState().activeNotifications;0===e.length?r&&a():o(e)}return _6.Z.addListener(e),()=>_6.Z.removeListener(e)}),[a,r]);const d=tn.useCallback((()=>{i(!0)}),[]);tn.useEffect((()=>{let e;return"melt"!==t&&"burn"!==t||(e=setTimeout(d,8e3)),()=>{e&&clearTimeout(e)}}),[t,d]);const c={notifications:s,onClose:function(e){l.Z.dispatch({actionType:"MAIN_HIDE_CALENDAR_ALARM",notificationId:e})},fade:"melt"===t?"down":"up",windowToRestore:e.windowToRestore};return(0,fn.jsxs)(fn.Fragment,{children:[("melt"===t||"burn"===t)&&x6(P6,{effect:t,showDialog:d},void 0,n&&(0,fn.jsx)(B6,{...c})),"dialog"===t&&(0,fn.jsx)(B6,{...c})]})};var U6;function V6(e,t,n,i){U6||(U6="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:U6,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const W6=function(e){return V6(wk,{title:(0,le.Z)("Delete Label"),prompt:[(0,le.Z)("The '$1' label will be removed from all messages",[e.label])],negative:(0,le.Z)("Cancel"),positive:(0,le.Z)("Delete Label"),onRequestClose:()=>{e.handleClose(e.dialog)},onClose:t=>{e.callback(t),e.handleClose(e.dialog)}},e.dialog)};var H6;function z6(e,t,n,i){H6||(H6="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:H6,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const G6=function(e){const t=Lo.Z.getAccounts().filter((e=>"ical"!==e.account_type)),[n,i]=(0,tn.useState)(""),[s,a]=(0,tn.useState)(xD.Z.getCalendarCreateColor()),[r,l]=(0,tn.useState)(""),[d,c]=(0,tn.useState)(!1),[h,p]=(0,tn.useState)(function(e){const t=Lo.Z.getDefaultAccountId();let n=e.find((e=>e.id===t));return!n&&e.length&&(n=e[0]),n?n.id:""}(t));function u(e){l(e)}return z6("div",{className:"dialog-add-calendar"},void 0,z6("div",{className:"dialog-header"},void 0,z6("h1",{className:"dialog-title"},void 0,(0,le.Z)("Add a New Calendar"))),0===t.length?(0,fn.jsxs)(fn.Fragment,{children:[z6("div",{className:"dialog-content"},void 0,(0,le.Z)("You have no suitable calendar account set up. Add one in Settings.")),z6("footer",{className:"dialog-footer"},void 0,z6("input",{type:"button",className:"primary",value:(0,le.Z)("Open Calendar Settings"),onClick:function(t){ie.Z.showSettings(e.windowId,"calendar"),e.onClose()}}),z6("input",{type:"button",value:(0,le.Z)("Cancel"),onClick:e.onClose}))]}):z6("form",{onSubmit:async function(){if(""===h)return void u((0,le.Z)("No suitable calendar account found."));c(!0);const t={name:n,accountId:h,description:n,color:s,supportedCalendarComponent:{vevent:!0,vtodo:!1,vjournal:!1}},{result:i}=await o.Z.createCalendar(t,!0);i.status?e.onClose():u(i.message)}},void 0,z6("div",{className:"dialog-content"},void 0,t.length>1&&z6("label",{className:"floating-label"},void 0,z6("span",{},void 0,(0,le.Z)("Account")),z6("select",{onChange:function(e){p(e.target.value)},value:h},void 0,t.map((e=>z6("option",{value:e.id},e.id,e.name))))),z6(Ko.Z,{type:"text",onChange:function(e){i(e.target.value)},label:(0,le.Z)("Calendar Name"),value:n,autoFocus:!0}),z6(Dx,{label:(0,le.Z)("Calendar color","Color"),colorKey:"color",colorValue:s,setColor:function(e,t,n=!1){a(e.hex())},predefinedColors:yc.hx}),r&&z6(Tr,{type:"warning"},void 0,r)),z6("footer",{className:"dialog-footer"},void 0,z6("input",{type:"submit",value:(0,le.Z)("Add Calendar"),disabled:!n.length||d}),z6("input",{type:"button",value:(0,le.Z)("Cancel"),onClick:e.onClose}))))};var $6;function K6(e,t,n,i){$6||($6="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:$6,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class j6 extends tn.PureComponent{constructor(e){super(e)}deleteMailFolder=()=>{const{accountId:e,path:t}=this.props.options;try{te.Z.deleteMailbox(e,t)}catch(n){de.Z.error("Mail",`Failed to remove folder ${(0,Ca.kF)(t)} from ${e}`)}this.props.onClose()};onDismiss=()=>{this.props.onClose()};render=()=>K6("div",{className:"dialog-delete-folder-name"},void 0,K6("header",{className:"dialog-header"},void 0,K6("h1",{},void 0,(0,le.Z)("Delete Folder $1 from $2",[(0,Ca.kF)(this.props.options.path),this.props.options.accountId])),K6("h2",{},void 0,(0,le.Z)("Note that all messages in that folder will also be deleted."))),K6("footer",{className:"dialog-footer"},void 0,K6("input",{type:"button",value:(0,le.Z)("Delete Folder"),className:"primary",onClick:this.deleteMailFolder}),this.props.dismissable&&K6("input",{type:"button",onClick:this.onDismiss,value:(0,le.Z)("Cancel")})))}const Y6=j6;var X6;function Q6(e,t,n,i){X6||(X6="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:X6,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class q6 extends tn.PureComponent{_isMounted=!1;constructor(e){super(e),this.state={accounts:[],currentAccount:void 0,capabilities:{},setupStep:"setup"}}componentDidMount(){this._isMounted=!0,this.loadAccountsAndCapabilities()}componentDidUpdate(e){if(e.prefValues[D.kMailAccounts]!==this.props.prefValues[D.kMailAccounts]){const e=!0;this.loadAccountsAndCapabilities(e)}}loadAccountsAndCapabilities=async e=>{const t=await hm.Z.loadAllAccounts();let n=this.state.currentAccount;if(t.length<this.state.accounts.length)n=void 0,this.setState({accounts:t,currentAccount:n});else{let i;e&&t.length>this.state.accounts.length&&(n=t.find((e=>!this.state.accounts.some((t=>t.MAIL_EMAIL===e.MAIL_EMAIL)))),i="signature");const s=await ya.Z.getCapabilities();this._isMounted&&(i?this.setState({accounts:t,capabilities:s,setupStep:i,currentAccount:n}):this.setState({accounts:t,capabilities:s,currentAccount:n}))}};showTips=()=>{this.setState({setupStep:"tips"})};onCreateItem=()=>{this.setState({setupStep:"setup"})};render(){if("tips"===this.state.setupStep)return Q6("div",{className:"MailAccountSheet vivaldi-settings"},void 0,Q6("button",{className:"MailAccountSheet-exit",onClick:this.props.onClose},void 0,Q6("span",{dangerouslySetInnerHTML:{__html:cn.vyJ}})),Q6(PL,{onClose:this.props.onClose,onCreateItem:this.onCreateItem}));const e=this.state.capabilities[this.state.currentAccount?.MAIL_EMAIL||""]||[];return Q6("div",{className:"MailAccountSheet vivaldi-settings"},void 0,Q6("button",{className:"MailAccountSheet-exit",onClick:this.props.onClose},void 0,Q6("span",{dangerouslySetInnerHTML:{__html:cn.vyJ}})),Q6("div",{className:"setting-section"},void 0,"setup"===this.state.setupStep&&Q6(KO,{onClose:this.props.onClose,focusInput:!0,emptyAccounts:0===this.state.accounts.length,searchableStrings:zO},"create"),"signature"===this.state.setupStep&&this.state.currentAccount&&Q6(fL,{accountSettings:this.state.currentAccount,capability:e,searchableStrings:gL,showTips:"signature"===this.state.setupStep?()=>this.showTips():void 0})))}}const J6=(0,fs.Z)(q6,[D.kMailAccounts]);var e7,t7;function n7(e,t,n,i){e7||(e7="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:e7,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function i7(e){const[t,n]=tn.useState(e.options.account.MAIL_USER||""),[i,s]=tn.useState(e.options.account.MAIL_PASSWORD||""),[o,a]=tn.useState(!1);return n7("form",{onSubmit:function(n){n.preventDefault();const s={...e.options.account,MAIL_USER:t,MAIL_PASSWORD:i};(0,Oa.Z)(s,e.options.account),te.Z.connectIMAPClient(s),e.onClose()}},void 0,n7("header",{className:"dialog-double-header"},void 0,n7("div",{className:"header-icon",dangerouslySetInnerHTML:{__html:cn.Si$.large}}),n7("h1",{className:"dialog-title"},void 0,(0,le.Z)("Authentication Error")),n7("p",{className:"info full-width"},void 0,(0,le.Z)("Enter credentials for $1",[e.options.account.MAIL_EMAIL]))),n7("div",{className:"dialog-content"},void 0,n7("h4",{},void 0,(0,le.Z)("IMAP Username")),n7("div",{className:"toolbar toolbar-default"},void 0,n7("input",{type:"text",placeholder:"user@vivaldi.net",value:t,onChange:function(e){n(e.target.value)}})),n7("h4",{},void 0,(0,le.Z)("IMAP Password")),n7("div",{className:"toolbar toolbar-default"},void 0,n7("input",{autoFocus:!0,type:o?"text":"password",placeholder:(0,le.Z)("My long safe password"),value:i,onChange:function(e){s(e.target.value)}}),n7(sl,{tooltip:(0,le.Z)("tooltip","Show password"),image:cn.sgm.medium,isPressed:o,onClick:function(){a(!o)}}))),n7("footer",{className:"dialog-footer"},void 0,n7("input",{type:"submit",value:(0,le.Z)("mail","Save"),autoFocus:!0}),n7("input",{type:"button",onClick:e.onClose,value:(0,le.Z)("Cancel")})))}function s7(e,t,n,i){t7||(t7="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:t7,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function o7(e,t){return s7("h1",{},void 0,t?(0,le.Z)("Permanently Delete $1 Message","Permanently Delete $1 Messages",[e]):(0,le.Z)("Delete $1 Message","Delete $1 Messages",[e]))}var a7=s7("input",{type:"radio",value:"selected",autoFocus:!0}),r7=s7("input",{type:"radio",value:"folders"}),l7=s7("input",{type:"radio",value:"accounts"});const d7=function(e){const{options:t,onClose:n}=e,{entries:i,deletePermanently:s}=t,[o,a]=tn.useState((()=>{const e=new Map;return i.forEach((t=>{t.sources.forEach(((t,n)=>{if(!t.deleted){const t=$g.C.get(n);e.set(t.accountId,!0)}}))})),e}));return s7("form",{onSubmit:function(t){t.preventDefault(),Wm.Z.delete(e.windowId,i,s,{accountIds:o}),n()}},void 0,s7("header",{className:"dialog-header"},void 0,o7(i.length,s),s7("p",{},void 0,(0,le.Z)("From which folders would you like to delete the message?","From which folders would you like to delete the messages?",[i.length]))),s7("div",{className:"dialog-content label-list"},void 0,[...o.entries()].map(((e,t)=>{const[n,i]=e;return s7("label",{},n,s7("input",{type:"checkbox",autoFocus:0===t,checked:i,onChange:()=>{o.set(n,!i),a(new Map([...o.entries()]))}}),s7("span",{},void 0,n))}))),s7("footer",{className:"dialog-footer"},void 0,s7("input",{type:"submit",value:(0,le.Z)("mail","Delete")}),s7("input",{type:"button",onClick:n,value:(0,le.Z)("Cancel")})))},c7=function(e){const{options:t,onClose:n}=e,{entries:i,deletePermanently:s}=t,o=new Set;i.forEach((e=>{e.sources.forEach(((e,t)=>{e.deleted||o.add(t)}))}));const a=$g.C.getByIds([...o]);return s7("form",{onSubmit:function(t){t.preventDefault(),Wm.Z.delete(e.windowId,i,s,{setting:"accounts"}),n()}},void 0,s7("header",{className:"dialog-header"},void 0,o7(i.length,s),s7("p",{},void 0,(0,le.Z)("Are you sure you want to delete the message from the following folders?","Are you sure you want to delete the messages from the following folders?",[i.length]))),s7("div",{className:"dialog-content label-list"},void 0,s7("ul",{},void 0,a.map((e=>{const{id:t,accountId:n,path:i}=e;return s7("li",{},t,s7("span",{},void 0,n),s7("span",{className:"folder-path"},void 0,i))})))),s7("footer",{className:"dialog-footer"},void 0,s7("input",{type:"submit",className:"danger",value:(0,le.Z)("mail","Delete"),autoFocus:!0}),s7("input",{type:"button",onClick:n,value:(0,le.Z)("Cancel")})))},h7=function(e){const{options:t,onClose:n}=e,{entries:i,deletePermanently:s}=t,[o,a]=tn.useState((()=>{const e=new Map;return i.forEach((t=>{t.sources.forEach(((t,n)=>{t.deleted||e.set(n,!0)}))})),e})),r=$g.C.getByIds([...o.keys()]);return s7("form",{onSubmit:function(t){t.preventDefault(),Wm.Z.delete(e.windowId,i,s,{sourceFilterIds:o}),n()}},void 0,s7("header",{className:"dialog-header"},void 0,o7(i.length,s),s7("p",{},void 0,(0,le.Z)("From which folders would you like to delete the message?","From which folders would you like to delete the messages?",[i.length]))),s7("div",{className:"dialog-content label-list"},void 0,r.map(((e,t)=>{const{id:n,accountId:i,path:s}=e,r=o.get(n);return s7("label",{},n,s7("input",{type:"checkbox",autoFocus:0===t,checked:r,onChange:()=>{o.set(n,!r),a(new Map([...o.entries()]))}}),s7("span",{},void 0,i," ",s))}))),s7("footer",{className:"dialog-footer"},void 0,s7("input",{type:"submit",value:(0,le.Z)("mail","Delete")}),s7("input",{type:"button",onClick:n,value:(0,le.Z)("Cancel")})))},p7=function(e){const{options:t,onClose:n}=e,{entries:i,deletePermanently:s}=t;let o="folders",a=!1;return s7("form",{onSubmit:function(t){if(t.preventDefault(),Wm.Z.delete(e.windowId,i,s,{setting:o}),a){const e=s?D.kMailDeleteInOtherLocations:D.kMailMarkDeleteInOtherLocations;nt.Z.set(e,o)}n()}},void 0,s7("header",{className:"dialog-header"},void 0,o7(i.length,s)),s7(ws,{className:"dialog-content label-list",name:"mail_delete_dialog_setting",value:o,onChange:e=>o=e.target.value},void 0,s&&s7("label",{},void 0,a7,s7("span",{},void 0,(0,le.Z)("From the Current Folder Only"))),s7("label",{},void 0,r7,s7("span",{},void 0,(0,le.Z)("From All Folders on Current Account"))),s7("label",{},void 0,l7,s7("span",{},void 0,(0,le.Z)("From All Accounts and Folders")))),s7("footer",{className:"dialog-footer label-list"},void 0,s7("label",{},void 0,s7("input",{type:"checkbox",value:a,onChange:e=>a=e.target.value}),s7("span",{},void 0,(0,le.Z)("Don’t Ask Again"))),s7("input",{type:"submit",value:(0,le.Z)("mail","Delete")}),s7("input",{type:"button",onClick:n,value:(0,le.Z)("Cancel")})))};var u7,g7;function m7(e,t,n,i){u7||(u7="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:u7,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function v7(e){const t=tn.useContext(dn.Z),[n,i]=(0,tn.useState)(!1),{folder:s}=e.options,{accountId:o,path:a}=s;return m7("form",{onSubmit:function(i){i.preventDefault(),j.Z.unsubscribeMailbox(t.vivaldiWindowId,s,n),e.onClose()}},void 0,m7("header",{className:"dialog-double-header"},void 0,m7("div",{className:"header-icon",dangerouslySetInnerHTML:{__html:cn.Si$.large}}),m7("h1",{className:"dialog-title"},void 0,(0,le.Z)("Unsubscribe from IMAP folder $1",[a]))),m7("div",{className:"dialog-content"},void 0,m7("div",{className:"toolbar toolbar-default"},void 0,m7("input",{autoFocus:!0,type:"checkbox",checked:n,onChange:function(){i(!n)}}),m7("span",{},void 0,(0,le.Z)("Remove messages from this device"))),m7("p",{className:"info"},void 0,(0,le.Z)("If checked, all message files for $1 on $2 will be deleted. Otherwise they will remain on disk.",[a,o]))),m7("footer",{className:"dialog-footer"},void 0,m7("input",{type:"submit",className:"danger",value:(0,le.Z)("mail","Unsubscribe"),autoFocus:!0}),m7("input",{type:"button",onClick:e.onClose,value:(0,le.Z)("Cancel")})))}function f7(e,t,n,i){g7||(g7="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:g7,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const y7="shift+alt+";class w7 extends tn.PureComponent{static contextType=dn.Z;state={accessKeys:[],shown:!1,page:null};componentDidMount(){const e=W.Z.getActivePage(this.context.vivaldiWindowId);e&&d.Z.accessKeys.getAccessKeysForPage(e.id,(t=>{this.setState({accessKeys:t,shown:!0,page:e},(()=>this.bindKeystrokes()))}))}componentWillUnmount(){this.unbindKeystrokes()}bindKeystrokes=()=>{const{accessKeys:e}=this.state;e.forEach((e=>{wd.Z.bind(e.access_key,this.pressKey),wd.Z.bind(y7+e.access_key,this.pressKey)}))};unbindKeystrokes=()=>{const{accessKeys:e}=this.state;e.forEach((e=>{wd.Z.unbind(e.access_key,this.pressKey),wd.Z.unbind(y7+e.access_key,this.pressKey)}))};onClose=()=>{this.state.shown&&(this.setState({shown:!1}),this.props.onClose())};getLink=e=>{const t=this.state.page?_i.parse(this.state.page.url):null;if(t){if(e.startsWith("#")&&t.href)return t.href.split("#")[0]+e;if(e.startsWith("/")&&t.protocol&&t.host)return t.protocol+"//"+t.host+e}return e};pressKey=e=>{this.triggerKey(e.keyState.key)};triggerKey=e=>{const t=W.Z.getActivePage(this.context.vivaldiWindowId);t&&d.Z.accessKeys.action(t.id,e),this.onClose()};render(){if(!this.state.shown)return null;const{accessKeys:e,page:t}=this.state;return f7("div",{className:"dialog-access-keys"},void 0,f7("header",{className:"dialog-header"},void 0,f7("h1",{className:"dialog-title"},void 0,(0,le.Z)("Access Key Shortcuts"),t&&f7("span",{className:"info"},void 0,(0,le.Z)("for $1",[t.title||t.url])))),f7("div",{className:"dialog-content"},void 0,0===e.length&&(0,le.Z)("This page doesn’t seem to contain access key shortcuts."),e.length>0&&e.map(((e,t)=>f7("label",{className:"keycombo",title:e.href},t,f7("input",{type:"button",className:"item",onClick:this.triggerKey.bind(null,e.access_key),value:e.access_key}),f7("span",{},void 0,e.title.replace(/\[.*?\]/g,"")||e.textContent.trim()||e.href))))),f7("footer",{className:"dialog-footer"},void 0,f7("p",{className:"info"},void 0,M.Z.get(D.kWebpagesAccessKeys)?(0,le.Z)("Access key shortcuts are allowed in keyboard settings."):(0,le.Z)("Access key shortcuts are disabled in keyboard settings.")," ",(0,le.Z)("Run shortcuts on page with $1 modifier keys.",["Shift+Alt"])),f7("input",{type:"button",onClick:this.onClose,value:(0,le.Z)("Close"),className:"primary",autoFocus:!0})))}}const b7=w7;var C7;function S7(e,t,n,i){C7||(C7="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:C7,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class T7 extends tn.PureComponent{onClick=e=>{this.props.onItemClick(this.props.item,e)};over=e=>{this.props.onMouseOver(e,this.props.item)};render(){const{name:e}=this.props.item;return S7("div",{"data-selected":this.props.selected?"":null,onMouseOver:this.over,onClick:this.onClick,className:"quick-command",style:this.props.style},void 0,S7("span",{className:"quick-command-favicon",dangerouslySetInnerHTML:{__html:cn.VLT}}),S7("span",{className:"quick-command-title"},void 0,e),S7("span",{className:"view quick-command-shortcut"},void 0,(0,le.Z)("Press Enter to Copy")))}}const I7=T7;var k7;function A7(e,t,n,i){k7||(k7="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:k7,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Z7 extends tn.PureComponent{onClick=e=>{this.props.onItemClick(this.props.item,e)};over=e=>{this.props.onMouseOver(e,this.props.item)};render(){const{item:e,style:t,searchTerm:n}=this.props,i=e.faviconUrl||e.pageUrlForFavicon||e.url||void 0,s=e.faviconUrl?"faviconFromCache":"page";return A7("div",{"data-selected":this.props.selected?"":null,onMouseOver:this.over,onClick:this.onClick,className:"quick-command",style:t},void 0,i&&A7(Oi,{className:"quick-command-favicon",url:i,loadType:s,style:e.read?{filter:"saturate(0) opacity(0.5)"}:{}}),n.length?Jv(n,e.name,"quick-command-title"):A7("span",{className:"quick-command-title"},void 0,e.name),e.url&&(n.length?Jv(n,e.url,"quick-command-url"):A7("span",{className:"view quick-command-url"},void 0,e.url)),e.nickname&&(n.length?Jv(n,e.nickname,"view quick-command-nickname"):A7("span",{className:"view quick-command-nickname"},void 0,e.nickname)),e.meta&&A7("span",{className:"view quick-command-meta"},void 0,(0,Rd.$)(e.meta)))}}const E7=Z7;var _7;function N7(e,t,n,i){_7||(_7="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:_7,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class M7 extends tn.PureComponent{onClick=e=>{this.props.onItemClick(this.props.item,e)};over=e=>{this.props.onMouseOver(e,this.props.item)};render(){const{name:e,url:t,faviconUrl:n,visitCount:i,visitTime:s}=this.props.item,{searchTerm:o}=this.props,a=b()(s).format("l, LT"),r=e||t;return N7("div",{"data-selected":this.props.selected?"":null,onMouseOver:this.over,onClick:this.onClick,className:"quick-command",style:this.props.style},void 0,N7(Oi,{url:n||t,loadType:n?"faviconFromCache":"page",className:"quick-command-favicon"}),Jv(o,r,"quick-command-title"),N7("span",{className:"quick-command-timestamp"},void 0,a),N7("span",{className:"item-count"},void 0,i))}}const P7=M7;var D7;function x7(e,t,n,i){D7||(D7="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:D7,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const O7="/resources/folder@2x.png";class L7 extends tn.PureComponent{onClick=e=>{this.props.onItemClick(this.props.item,e)};over=e=>{this.props.onMouseOver(e,this.props.item)};render(){const{item:e,searchTerm:t}=this.props,n=function(e,t){return t?O7:e?cn.NwZ:cn.cyI.small}(!!e.url,!!e.isFolder);return x7("div",{"data-selected":this.props.selected?"":null,onMouseOver:this.over,onClick:this.onClick,className:"quick-command",style:this.props.style},void 0,x7(Oi,{url:n,loadType:"faviconFromCache",className:"quick-command-favicon"}),e.name&&Jv(t,e.name,"quick-command-title"),!e.nickname&&e.url&&Jv(t,e.url,"quick-command-url"),e.nickname&&Jv(t,e.nickname,"quick-command-url"),e.hasAttachment&&x7("span",{className:"quick-command-attachment",dangerouslySetInnerHTML:{__html:cn.onv}}))}}const R7=L7;var B7;function F7(e,t,n,i){B7||(B7="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:B7,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class U7 extends tn.PureComponent{render(){const{item:e,style:t,selected:n}=this.props,{name:i,subtitle:s,count:o}=e;return F7("div",{"data-selected":n?"":null,style:t,className:"quick-command-sectionheader"},void 0,i,s&&F7("span",{className:"QuickCommand-Title--Subtitle"},void 0,s),o>0&&F7("span",{className:"item-count"},void 0,o))}}const V7=U7;var W7,H7=n(34155);function z7(e,t,n,i){W7||(W7="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:W7,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class G7 extends tn.PureComponent{state={selectedIndex:1};_keyedNavigation=!1;_startIndex=0;_stopIndex=0;setKeyedNavigation=e=>{this._keyedNavigation=e};getSelectedIndex=()=>this.state.selectedIndex;selectByIndex=e=>{this.props.setNavigatingList(!0),this.props.hintChange(e),this.setState({selectedIndex:e}),this.rerenderVisibleTreeItems()};onKeyDown=e=>{const t={ctrl:!!e.ctrlKey,alt:!!e.altKey,shift:!!e.shiftKey,command:!1},n=this.props.renderedArray;let i=this.getSelectedIndex(),s=i;if(!t.ctrl&&t.alt&&!t.shift&&!t.command)switch(e.key){case"ArrowUp":i>0&&"title"===n[i-1].type&&i--,s=0;for(let e=i-1;e>=0;e--)if("title"===n[e].type){s=e+1;break}e.preventDefault();break;case"ArrowDown":for(let e=i;e<n.length;e++)if("title"===n[e].type){s=e+1;break}e.preventDefault()}else if(!(t.ctrl||t.alt||t.shift||t.command)){const t=this._stopIndex-this._startIndex;switch(e.key){case"ArrowUp":s=Math.max(0,i-1),e.preventDefault();break;case"ArrowDown":s=Math.min(i+1,n.length-1),e.preventDefault();break;case"PageUp":s=Math.max(0,this._startIndex-t);break;case"PageDown":s=Math.min(this._stopIndex+t,n.length-1)}}s!==i&&("title"===n[s].type&&(s=s>i?++s:Math.max(0,--s)),this.selectByIndex(s))};_onMouseOver=(e,t)=>{this._keyedNavigation||void 0===t.index||(this.selectByIndex(t.index),H7.nextTick((()=>this.props.syncOffset())))};_onMouseMove=()=>{this.setKeyedNavigation(!1)};rerenderVisibleTreeItems=()=>{this.refList&&this.refList.forceUpdateGrid()};_onIndexChanged=e=>{this._startIndex=e.startIndex,this._stopIndex=e.stopIndex};renderTreeItem=({index:e,style:t})=>{const{filtering:n,searchTerm:i}=this.props,s=this.props.renderedArray[e];s.index=e;const o=this.state.selectedIndex===e,a=!n||"noteAdd"===s.type&&"search"===s.type&&"keywordSearch"===s.type&&"commandChain"===s.type?i:i.split(":")[1].trim();switch(s.type){case"title":return z7(V7,{selected:o,item:s,style:t},s.type+"__"+s.index);case"history":return z7(P7,{selected:o,item:s,style:t,searchTerm:a,onItemClick:this.props.onExecuteCommand,onMouseOver:this._onMouseOver},s.type+"__"+s.index);case"calculator":return z7(I7,{selected:o,item:s,style:t,onItemClick:this.props.onExecuteCommand,onMouseOver:this._onMouseOver},s.type+"__"+s.index);case"note":case"noteAdd":return z7(R7,{selected:o,item:s,style:t,searchTerm:a,onItemClick:this.props.onExecuteCommand,onMouseOver:this._onMouseOver},s.type+"__"+s.index);default:return z7(E7,{selected:o,item:s,style:t,searchTerm:a,onItemClick:this.props.onExecuteCommand,onMouseOver:this._onMouseOver},s.type+"__"+s.index)}};render(){const e=28*this.props.renderedArray.length,t=e>280?280:e;return z7("div",{className:"quick-commands",tabIndex:"1",onKeyDown:this.onKeyDown,onMouseMove:this._onMouseMove},void 0,(0,fn.jsx)(Vu.aV,{ref:e=>this.refList=e,onRowsRendered:this._onIndexChanged,scrollToIndex:this.state.selectedIndex,height:t,rowHeight:28,width:520,rowRenderer:this.renderTreeItem,rowCount:this.props.renderedArray.length}))}}const $7=G7;var K7,j7=n(76501),Y7=n(46217),X7=n(34155);function Q7(e,t,n,i){K7||(K7="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:K7,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const q7=(0,le.Z)("Filter Quick Commands"),J7=[D.kAddressBarStripJavascriptOnPaste,D.kQuickCommandsKeepValue,D.kQuickCommandsOpenUrlInNewTab,D.kQuickCommandsSearchEnglish,D.kQuickCommandsSearchPriority,D.kQuickCommandsMatchNickname,D.kChainedCommandsCommandList,D.kQuickCommandsShowBookmarks,D.kQuickCommandsShowCalculator,D.kQuickCommandsShowExtensions,D.kQuickCommandsShowHistory,D.kQuickCommandsShowNotes,D.kQuickCommandsShowPageActions,D.kQuickCommandsLimitResults,D.kQuickCommandsShowReadingList,D.kQuickCommandsUseNotesManager],e9="text/plain";let t9=!1;const n9=(0,Mn.Z)("keyword","bookmark"),i9=(0,Mn.Z)("keyword","note"),s9=(0,Mn.Z)("keyword","tab"),o9=(0,Mn.Z)("keyword","nick"),a9=(0,Mn.Z)("keyword","history"),r9=(0,Mn.Z)("keyword","command"),l9=(0,Mn.Z)("keyword","action"),d9=(0,Mn.Z)("keyword","extension"),c9=[{...(0,fg.jn)({labelPair:n9,initialPart:"^",endingPart:"$"}),...n9,type:"bookmark"},{...(0,fg.jn)({labelPair:i9,initialPart:"^",endingPart:"$"}),...i9,type:"note"},{...(0,fg.jn)({labelPair:s9,initialPart:"^",endingPart:"$"}),...s9,type:"tab"},{...(0,fg.jn)({labelPair:o9,initialPart:"^",endingPart:"$"}),...o9,type:"bookmarkNick"},{...(0,fg.jn)({labelPair:a9,initialPart:"^",endingPart:"$"}),...a9,type:"history"},{...(0,fg.jn)({labelPair:r9,initialPart:"^",endingPart:"$"}),...r9,type:"command"},{...(0,fg.jn)({labelPair:l9,initialPart:"^",endingPart:"$"}),...l9,type:"contentScript"},{...(0,fg.jn)({labelPair:d9,initialPart:"^",endingPart:"$"}),...d9,type:"extension"}];class h9 extends tn.PureComponent{static contextType=dn.Z;state={quickCommandSearchValue:this.props.quickCommandValue||"",typeAheadHint:q7,filtering:null,renderedArray:[]};_isIMEOpen=!1;_justClosedIME=!1;expireTimeout=null;contentScripts=[];openTabsInAllWindows=[];hasSearchedForFullHistory=!1;parser=new Y7._b;_imeProcessSpace=!1;defaultEngine=Nn.Z.getDefault(z.ZP.isIncognito(this.context.vivaldiWindowId));chainShortcuts=[];refQuickCommandInput=tn.createRef();refQuickCommandHint=tn.createRef();allExtensions=[];vivaldiExt=[];commandChains=[];historySearch=new AC({provider:new kC});componentDidMount(){t9||(t9=!0,A.loadAll()),this._initialSetup(),d.Z.pageActions.getScripts((e=>{this.contentScripts=e}))}_initialSetup=async()=>{const e=(0,fg.IZ)(this.context.vivaldiWindowId,""),t=await y.Z.tabs.query({windowType:"normal"}),n=await(0,fg.JQ)("",t);this.chainShortcuts=await U.Z.getChainCommandsShortcuts(),this.allExtensions=await(0,fg.GO)(),this.vivaldiExt=await(0,fg.pN)(),this.openTabsInAllWindows=t,this.commandChains=this.props.prefValues[D.kChainedCommandsCommandList];const i=(0,fg.$J)(this.context.vivaldiWindowId,{searchText:"",chains:this.commandChains,shortcuts:this.chainShortcuts});let s=[];if(this.props.prefValues[D.kQuickCommandsSearchPriority].forEach((t=>{switch(t){case"OPEN_TABS":s=[...s,...n];break;case"NORMAL_COMMAND":s=[...s,...e];break;case"COMMAND_CHAIN":s=[...s,...i]}})),this.setState({renderedArray:s},(()=>this.hintChange(1))),this.props.prefValues[D.kQuickCommandsKeepValue]){const e=this.state.quickCommandSearchValue;e.length&&(this.refQuickCommandInput.current?.setSelectionRange(0,e.length),this.searchChange(e))}};componentWillUnmount(){const e=this.state.quickCommandSearchValue;this.props.prefValues[D.kQuickCommandsKeepValue]&&e.length?this.props.storeQuickCommandValue(e):this.props.storeQuickCommandValue("")}componentDidUpdate(){this._imeProcessSpace&&this._isIMEOpen&&(this._imeProcessSpace=!1),this.commandChains!==this.props.prefValues[D.kChainedCommandsCommandList]&&(this.commandChains=this.props.prefValues[D.kChainedCommandsCommandList])}onKeyDown=e=>{switch(this.qclist.setKeyedNavigation(!0),e.key){case"Process":this._isIMEOpen&&(this._imeProcessSpace=!0);break;case"Escape":this.onEscape(),e.preventDefault(),e.stopPropagation();break;case"ArrowUp":case"ArrowDown":case"PageUp":case"PageDown":this.qclist.onKeyDown(e),e.preventDefault();break;case"Enter":{if(this._isIMEOpen||this.expireTimeout)break;const t=this.qclist.getSelectedIndex(),{renderedArray:n}=this.state,i=n[t];this.executeCommand(i,e),e.preventDefault(),e.stopPropagation();break}case"Tab":case"ArrowRight":if((0,Bu.Z)(e)||this._isIMEOpen)break;this.autoCompleteHint(),"Tab"===e.key&&e.preventDefault()}this._justClosedIME=!1,X7.nextTick((()=>this.syncOffset()))};onCompositionStart=()=>{this._isIMEOpen=!0};onCompositionEnd=()=>{this._isIMEOpen=!1,this._justClosedIME=!0,this.searchChange(this.state.quickCommandSearchValue)};onEscape=()=>{this._isIMEOpen||(this.state.quickCommandSearchValue.length>0&&!this._justClosedIME&&!this._isIMEOpen?(this.props.storeQuickCommandValue(""),this.setState({quickCommandSearchValue:"",typeAheadHint:q7},(()=>this.searchChange("")))):this._justClosedIME||this.props.onClose()),this._justClosedIME=!1};syncOffset=()=>{const{HTMLInputElement:e}=this.context,t=this.refQuickCommandInput.current?.scrollLeft??-1;t>-1&&this.refQuickCommandHint.current instanceof e&&(this.refQuickCommandHint.current.scrollLeft=t)};autoCompleteHint=()=>{const{typeAheadHint:e,renderedArray:t}=this.state,n=t[this.qclist.getSelectedIndex()];if(!e.length||"calculator"===n.type)return;const i="commandKeyword"===n.type&&n.searchString?n.searchString+" ":e;this.setState({quickCommandSearchValue:i},(()=>this.searchChange(i)))};executeCommand=(e,t)=>{const{ctrlKey:n,altKey:i,metaKey:s,shiftKey:o}=t,r={ctrlKey:n,altKey:i,metaKey:s,shiftKey:o},l=(0,fg.vD)(this.context.vivaldiWindowId,r),c=this.context.vivaldiWindowId;switch(e.type){case"openTab":if(e.windowId&&e.pageId){const{windowId:t,pageId:n}=e;y.Z.windows.update(t,{focused:!0},(()=>{y.Z.tabs.update(n,{active:!0})}))}break;case"closedTab":e.command&&j7.Z.undeleteTab(e.command);break;case"calculator":{const{name:t}=e;navigator.clipboard.writeText(t);break}case"commandChain":e.action&&e.action();break;case"bookmarkFolder":case"bookmarkNick":e.folderId?(0,fg.hV)(this.context.vivaldiWindowId,e.folderId):e.url&&Y.Z.openURL(c,e.url,{...l});break;case"bookmark":if(e.url){const{url:t}=e;Y.Z.openURL(c,t,{...l})}break;case"extension":if(e.id&&void 0!==e.enabled){const{id:t,enabled:n,optionsUrl:i=""}=e,s={id:t,enabled:n,optionsPage:(0,xr.mT)(r),optionsUrl:i};(0,fg.de)(c,s)}break;case"url":{const{name:t}=e;Y.Z.openURL(c,t,{transition:d.Z.historyPrivate.TransitionType.TYPED,...l});break}case"keywordSearch":case"search":e.searchQuery&&"string"==typeof e.searchQuery&&Of.Z.goSearchURL(c,e.searchQuery,{...l});break;case"command":case"commandKeyword":if(e.commandName){const{commandName:t,value:n,name:i}=e,s=this.context.vivaldiWindowId;return void this.props.onClose().then((()=>{a.Z.executeActions(s,t,n),X.Z.setStatus(s,(0,le.Z)("Command: $1",[i]),3e3),this.props.storeQuickCommandValue("")}))}break;case"history":if(e.url){const{url:t}=e;Y.Z.openURL(c,t,{...l})}break;case"contentScript":{const t=W.Z.getActivePage(c);if(t&&e.script){const n=t.id,{script:i}=e;d.Z.pageActions.getScriptOverridesForTab(n,(e=>{const t=e.find((e=>e.script===i)),s=t&&"enabled"===t.override?"no_override":"enabled";d.Z.pageActions.setScriptOverrideForTab(i,n,s,(()=>{}))}))}break}case"note":if(e.id){const{id:t}=e;this.handleNotesOpening(t,{...l})}break;case"noteAdd":if(e.value&&"string"==typeof e.value){const{value:t}=e;Fs.Z.createNote(c,{content:t})}}this.setState({quickCommandSearchValue:""}),this.props.storeQuickCommandValue(""),X7.nextTick(this.props.onClose)};onSearchChange=e=>{const t=e.target;this.searchChange(t.value)};handleNotesOpening=(e,t)=>{const n=this.props.prefValues,i=this.context.vivaldiWindowId;n[D.kQuickCommandsUseNotesManager]||!Dl.ZP.isAvailable("notes")?Y.Z.openURL(i,St.jk.internalUrl("notes",e),{...t}):Ho.Z.showContent(i,"notes",{setFocus:!0,selectId:e,reason:""})};handleHistoryFullSearchTimeout=(0,Zr.Z)((e=>{if(this.hasSearchedForFullHistory||!this.state.quickCommandSearchValue.length)return!1;if(this.isNavigatingList)return this.hasSearchedForFullHistory=!1,this.handleHistoryFullSearchTimeout(e),!1;this.hasSearchedForFullHistory=!0;const t=(0,fg.s1)({searchText:e,today:!1}),n=this.state.renderedArray[this.qclist?.getSelectedIndex()],{renderedArray:i,filtering:s}=this.processRenderedArray({qcInputText:e,renderedArray:t});this.setState({renderedArray:i,filtering:s},(()=>this.performFullSearchSelection(n)))}),750);performFullSearchSelection=e=>{const t=e;if("history"!==t.type||void 0===t.url)return;const n=this.state.renderedArray.findIndex((n=>{const i=n.url;return!(!i||!e)&&i.toLowerCase()===t.url.toLowerCase()}));-1!==n&&(this.selectByIndex(n),this.qclist.rerenderVisibleTreeItems())};setNavigatingList=e=>{this.isNavigatingList=e,this.debounceNavigationOfList()};debounceNavigationOfList=(0,Zr.Z)((()=>{this.isNavigatingList=!1}),500);processRenderedArray=e=>{const{qcInputText:t,renderedArray:n}=e,i=t.trim(),s=this.props.prefValues,o=this.props.prefValues[D.kQuickCommandsSearchPriority];let a,r,l,d=[];-1===i.indexOf(":")||(0,Ni.K2)(i)||([r,l]=i.split(":"),a=c9.find((e=>(0,fg.Fm)(r,e))));const c=(0,fg.xh)(i);c.forEach((e=>d.push(e)));const h=i.length;s[D.kQuickCommandsShowCalculator]&&(0,fg.CD)(i).forEach((e=>d.push(e))),h&&!c.length&&(0,fg.JC)(i,this.defaultEngine).forEach((e=>d.push(e))),s[D.kQuickCommandsShowNotes]&&(0,fg.Dj)(i).forEach((e=>d.push(e)));const p=l?.trim()||i,u=l?.trim()?.length||h,g=void 0!==a,m=Boolean(!g&&u);return o.forEach((e=>{switch(e){case"OPEN_TABS":{if(!("tab"===a?.type)&&g)break;const e=(0,fg.JQ)(p,this.openTabsInAllWindows);d=[...d,...e];break}case"NORMAL_COMMAND":{if(!("command"===a?.type)&&g)break;const e=(0,fg.IZ)(this.context.vivaldiWindowId,p);d=[...d,...e];break}case"EXTENSIONS":{const e=s[D.kQuickCommandsShowExtensions]&&u,t="extension"===a?.type;if(!e||!t&&g)break;const n=(0,fg.nX)(p,this.allExtensions,this.vivaldiExt);d=[...d,...n];break}case"COMMAND_CHAIN":h&&(0,fg.$J)(this.context.vivaldiWindowId,{searchText:i,chains:this.commandChains,shortcuts:this.chainShortcuts}).forEach((e=>d.push(e)));break;case"BOOKMARK_ITEM_OR_FOLDER":{const e=s[D.kQuickCommandsShowBookmarks]&&u,t="bookmark"===a?.type,n="bookmarkNick"===a?.type;if(!e)break;(n||m)&&(0,fg.hm)(p).forEach((e=>d.push(e)));let i=[],o=[];(t||m)&&(i=(0,fg.Xz)(p),o=(0,fg.oE)(p)),d=[...d,...i,...o];break}case"READING_LIST":if(h&&s[D.kQuickCommandsShowReadingList]){const e=(0,fg.Lm)(i);d=[...d,...e]}break;case"NOTES_SEARCH":{const e=s[D.kQuickCommandsShowNotes]&&u,t="note"===a?.type;if(!e||!t&&g)break;const n=(0,fg.Kk)(p);d=[...d,...n];break}case"HISTORY":{const e=s[D.kQuickCommandsShowHistory]&&u>1,t="history"===a?.type;if(!e||!t&&g)break;if(!n.length){const e=this.throttleHistory(p);d=[...d,...e]}else d=[...d,...n];break}case"CLOSED_TABS":{if(!("tab"===a?.type)&&g)break;const e=(0,fg.S4)(p);d=[...d,...e];break}case"KEYWORD_SEARCH":(0,fg.Gr)(i).forEach((e=>d.push(e)));break;case"PAGE_ACTIONS":{const e=s[D.kQuickCommandsShowPageActions]&&u,t="contentScript"===a?.type,n=W.Z.isActiveExternal(this.context.vivaldiWindowId);if(!e||!t&&g||!n)break;const i=(0,fg.sh)(p,this.contentScripts);d=[...d,...i];break}}})),{renderedArray:d,filtering:a}};searchChange=e=>{this.hasSearchedForFullHistory=!1;const{renderedArray:t,filtering:n}=this.processRenderedArray({qcInputText:e,renderedArray:[]});this.setState({renderedArray:t,filtering:n,quickCommandSearchValue:e},(()=>this.performSelection()))};throttleHistory=e=>(M.Z.get(D.kQuickCommandsLimitResults)||this.handleHistoryFullSearchTimeout(e),(0,fg.s1)({searchText:e,today:!0}));debouncePerformSelection=(0,Zr.Z)((()=>{this.isNavigatingList||this.performSelection()}),25);onPaste=e=>{const{clipboardData:t}=e;if(t.types[0]!==e9)return;const n=t.getData(e9);n.trim()||e.preventDefault();const{prefValues:i}=this.props,{quickCommandSearchValue:s}=this.state,o=/^(\s*javascript:)+/i,a=e.currentTarget.selectionStart;if(i[D.kAddressBarStripJavascriptOnPaste]){if(o.test(n)){e.preventDefault();const t=NC(s||"",n.replace(/javascript:/gi,""),a,e.currentTarget.selectionEnd);return void this.searchChange(t)}if(o.test(s+n)){e.preventDefault();const t=NC("",(s+n).replace(/javascript:/gi,""),a,e.currentTarget.selectionEnd);this.searchChange(t)}}};getSelectPriority=()=>{const{renderedArray:e,filtering:t,quickCommandSearchValue:n}=this.state,{prefValues:i}=this.props;let s=0;const o=i[D.kQuickCommandsSearchEnglish];if(t){const{type:n}=t,i=e.findIndex((e=>void 0!==e.selectPriority&&e.type.toLowerCase().includes(n.toLowerCase())));if(i>-1){const t=e[i];return(0,fg.Jg)(t,i)}}const a=n.toLowerCase(),r=e.findIndex((e=>{const t=e.name.toLowerCase();if(o&&e.labelEnglish){const n=e.labelEnglish.toLowerCase();return a===t||a===n}return a===t}));if(r>-1){const t=e[r];return(0,fg.Jg)(t,r)}let l=i[D.kQuickCommandsSearchPriority].length;return e.forEach(((e,t)=>{void 0!==e.selectPriority&&e.selectPriority<l&&(s=t,l=e.selectPriority)})),{priority:l,selectIndex:s}};openBookmark=e=>{const t=this.props.prefValues;if(t[D.kQuickCommandsMatchNickname]){if(e.folderId)(0,fg.hV)(this.context.vivaldiWindowId,e.folderId);else if(e.url){const n={inCurrent:!1===t[D.kQuickCommandsOpenUrlInNewTab],inBackground:!1,inNewWindow:!1,allowOverride:!1,incognito:!1};Jt.ZP.openUrls(this.context.vivaldiWindowId,[e.url],n,!1)}this.expireTimeout=setTimeout((()=>{this.setState({quickCommandSearchValue:""},(()=>{this.props.onClose()}))}),200)}};performSelection=()=>{const{quickCommandSearchValue:e}=this.state,{renderedArray:t}=this.state;let{priority:n,selectIndex:i}=this.getSelectPriority();const s=t[i],o=this.props.prefValues[D.kQuickCommandsSearchPriority];if("bookmarkNick"===s.type)this.openBookmark(s);else if(n===o.length){const n=t.findIndex((t=>"history"===t.type&&t.name.toLowerCase().includes(e.toLowerCase())));i=-1!==n?n:0}this.selectByIndex(i),this.hintChange(i),this.qclist?.rerenderVisibleTreeItems()};hintChange=e=>{let t;const{renderedArray:n,filtering:i,quickCommandSearchValue:s}=this.state,o=n[e];let a=s;switch(i&&(a=a.split(":")[1]),o.type){case"url":case"noteAdd":case"search":case"keywordSearch":t="";break;case"commandKeyword":case"command":if(o.value)t="";else{const{name:e}=o,n=(0,fg.ue)(e,a);t=s+e.substring(n+a.length)}break;case"calculator":if(o.searchString&&o.name){const{searchString:e,name:n}=o;t=e!==n?`${a} = ${n}`:""}break;default:{let e="";const{name:n="",url:i="",nickname:r=""}=o,l=(0,fg.ue)(n,a),d=i?(0,fg.ue)(i,a):-1,c=(0,fg.ue)(r,a);-1!==l?e=n.substring(l+a.length):i&&-1!==d?e=i.substring(d+a.length):-1!==c&&(e=r.substring(c+a.length)),t=s+e}}a.length||"title"!==o.type||(t=q7),this.setState({typeAheadHint:t}),this.qclist.rerenderVisibleTreeItems()};selectByIndex(e){this.qclist&&this.qclist.selectByIndex(e)}render(){const{renderedArray:e,filtering:t,quickCommandSearchValue:n}=this.state;return Q7("div",{className:"quick-command-container"},void 0,Q7("div",{className:"qc-entry"},void 0,(0,fn.jsx)("input",{tabIndex:"-1",readOnly:!0,ref:this.refQuickCommandHint,className:"quick-command-search-hint",value:this.state.typeAheadHint}),(0,fn.jsx)("input",{type:"search",autoFocus:!0,ref:this.refQuickCommandInput,className:"quick-command-search",onKeyDown:this.onKeyDown,onScroll:()=>X7.nextTick(this.syncOffset),onCompositionStart:this.onCompositionStart,onCompositionEnd:this.onCompositionEnd,value:this.state.quickCommandSearchValue,onChange:this.onSearchChange,onPaste:this.onPaste})),(0,fn.jsx)($7,{ref:e=>this.qclist=e,renderedArray:e,onExecuteCommand:this.executeCommand,syncOffset:this.syncOffset,filtering:Boolean(t),setNavigatingList:this.setNavigatingList,searchTerm:n.trim(),hintChange:this.hintChange}))}}const p9=(0,fs.Z)(h9,J7);var u9;function g9(e,t,n,i){u9||(u9="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:u9,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const m9=[D.kKeyboardShortcutsEnable,D.kKeyboardShortcutsEnableSingleKey];class v9 extends tn.Component{refComboFilter=tn.createRef();state={filter:""};componentDidMount(){this.refComboFilter.current?.focus()}onSettingsFilter=e=>{const t=e.target.value.toLowerCase().replace(/⌘/g,"meta").replace(/⌥/g,"alt").replace(/⇧/g,"shift").replace(/⌃/g,"ctrl");this.setState({filter:t})};onKeyDown=e=>{"Escape"===e.nativeEvent.code&&0===this.refComboFilter.current?.value.length&&(this.props.onClose(),e.stopPropagation(),e.preventDefault())};render(){let e="keystrokes";return this.props.prefValues[D.kKeyboardShortcutsEnable]?this.props.prefValues[D.kKeyboardShortcutsEnableSingleKey]||(e+=" singlekeydisabled"):e+=" shortcutsdisabled",g9("div",{className:"keyboardShortcutsWrapper",tabIndex:"0",onKeyDown:this.onKeyDown},void 0,g9("header",{},void 0,g9("h1",{},void 0,(0,le.Z)("Keyboard Cheat Sheet")),(0,fn.jsx)("input",{className:"search",ref:this.refComboFilter,type:"search",placeholder:(0,le.Z)("Filter Commands"),onChange:this.onSettingsFilter}),g9("button",{className:"close",onClick:this.props.onClose,dangerouslySetInnerHTML:{__html:cn.kze}})),g9("div",{className:e},void 0,g9(sD,{filter:this.state.filter,view:"read-only"})))}}const f9=(0,fs.Z)(v9,m9),y9=32;class w9 extends tn.PureComponent{refCanvas=tn.createRef();componentDidMount(){this._isMounted=!0,this.renderIcon(this.props.mediaState)}componentDidUpdate(e){const{mediaState:t,color:n,animated:i,active:s}=this.props;!this._isMounted||e.mediaState===t&&e.color===n&&e.animated===i&&e.active===s||this.renderIcon(this.props.mediaState)}componentWillUnmount(){this._isMounted=!1}shouldAnimate=()=>this._isMounted&&this.props.animated&&this.props.mediaState.has("playing")&&!this.props.mediaState.has("muting")&&!this.props.mediaState.has("pip");getInheritedColor=()=>{if(!this._isMounted)return;let e="#111111";this.props.color?e=this.props.color:this.refCanvas.current&&(e=getComputedStyle(this.refCanvas.current).getPropertyValue("color")),this._color!==e&&(this._color=e)};renderIcon=e=>{if(!this.refCanvas.current)return;const t=this.refCanvas.current.getContext("2d");this.getInheritedColor();let n=0;function i(e,t){return e+n*(t-e)}const s=()=>{t.beginPath(),t.moveTo(4,12),t.lineTo(10,12),t.lineTo(18,4),t.lineTo(18,28),t.lineTo(10,20),t.lineTo(4,20),t.closePath(),t.lineWidth=0,t.fillStyle=this._color,t.fill()},o=()=>{t.beginPath(),t.moveTo(2,27),t.lineTo(5,30),t.lineTo(28,7),t.lineTo(25,4),t.moveTo(4,12),t.lineTo(10,12),t.lineTo(18,4),t.lineTo(18,8),t.lineTo(6,20),t.lineTo(4,20),t.moveTo(14,24),t.lineTo(18,20),t.lineTo(18,28),t.closePath(),t.lineWidth=0,t.fillStyle=this._color,t.fill()},a=()=>{t.beginPath(),t.moveTo(6,25),t.lineTo(4,23),t.lineTo(4,8),t.lineTo(6,6),t.lineTo(26,6),t.lineTo(28,8),t.lineTo(28,23),t.lineTo(26,25),t.moveTo(26,23),t.lineTo(26,14),t.lineTo(14,14),t.lineTo(14,23),t.closePath(),t.lineWidth=0,t.fillStyle=this._color,t.fill()},r=e=>{if(!t||!this.shouldAnimate())return;this._lastTime||(this._lastTime=e);const s=e-this._lastTime;if(s<62.5)return void requestAnimationFrame(r);t.clearRect(18,0,y9,y9),n=n>1?0:Math.ceil(100*(n+.05))/100,t.beginPath(),t.moveTo(4,12),t.lineTo(10,12),t.lineTo(18,4),t.lineTo(18,28),t.lineTo(10,20),t.lineTo(4,20),t.moveTo(i(14,22),i(12,4)),t.quadraticCurveTo(i(18,32),16,i(14,22),i(20,28)),t.lineTo(i(16,24),i(22,30)),t.quadraticCurveTo(i(20,34),16,i(16,24),i(10,2)),t.closePath(),t.lineWidth=0;const o=n<.7?1:parseFloat((1-n)/.3);t.fillStyle=Dr()(this._color).alpha(o).css(),t.fill(),this.shouldAnimate()?(this.getInheritedColor(),requestAnimationFrame(r)):l(this.props.mediaState),this._lastTime=e-s%62.5},l=e=>{t.globalCompositeOperation&&(t.clearRect(0,0,y9,y9),e.has("pip")?a():e.has("muting")?o():e.has("playing")&&this.shouldAnimate()?r(window.performance.now()):s())};l(e)};render(){let e="";return this.props.mediaState.has("pip")?e=(0,le.Z)("Exit Picture in Picture"):this.props.mediaState.has("muting")?e=(0,le.Z)("Unmute tab audio"):this.props.mediaState.has("playing")&&(e=(0,le.Z)("Mute tab audio")),(0,fn.jsx)("canvas",{ref:this.refCanvas,className:"audioicon",width:y9,height:y9,title:e})}}const b9=w9;var C9;function S9(e,t,n,i){C9||(C9="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:C9,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const T9=[D.kThemeUseAnimation];class I9 extends tn.Component{static contextType=dn.Z;state={mediaState:F5.getState().get(this.props.page.id)||(0,fa.l4)()};componentDidMount(){F5.addListener(this._onMediaStateStoreChanged)}componentDidUpdate(e,t){e.page.id!==this.props.page.id&&this._onMediaStateStoreChanged()}componentWillUnmount(){F5.removeListener(this._onMediaStateStoreChanged)}_onMediaStateStoreChanged=()=>{this.setState({mediaState:F5.getState().get(this.props.page.id)||(0,fa.l4)()})};onClickAudio=(e,t,n)=>{if(e.preventDefault(),e.stopPropagation(),n.has("pip"))Y.Z.exitPictureInPicture(this.props.page.id);else{const e=n.has("muting")?"unmute":"mute";Y.Z.setMuting(this.context.vivaldiWindowId,"selection",e,fa.aV.of(t))}};cancelEvent=e=>{e.stopPropagation(),e.preventDefault()};_renderMediaIcon=(e,t)=>!(0===e.size||t.discarded)&&S9("span",{className:"tab-audio",onMouseDown:n=>this.onClickAudio(n,t,e)},void 0,e.has("capturing")?S9("span",{className:"audioicon",width:"16",height:"16",dangerouslySetInnerHTML:{__html:cn.MjM}}):S9(b9,{animated:M.Z.get(D.kThemeUseAnimation),mediaState:e}));render(){const{page:e,selected:t,selectPage:n,listType:i}=this.props,{active:s}=e,{mediaState:o}=this.state,a=St.jk.getFavicon(e.url);return(0,fn.jsxs)(fn.Fragment,{children:["minimal"===i&&S9("li",{onContextMenu:this.cancelEvent,onMouseDown:()=>n&&n(e),className:mn()({"visual-list":!0,selected:t,"active-page":s})},void 0,S9(Oi,{className:"visual-tab-list-favicon",url:a||e.url,loadType:a?"faviconFromCache":"page"}),this._renderMediaIcon(o,e),St.jk.getDisplayTitle(e)),"visual"===i&&S9("div",{className:"visual-tab-switcher-title"},void 0,this._renderMediaIcon(o,e),St.jk.getDisplayTitle(e))]})}}const k9=(0,fs.Z)(I9,T9);var A9;function Z9(e,t,n,i){A9||(A9="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:A9,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const E9=212;class _9 extends tn.PureComponent{static contextType=dn.Z;constructor(e,t){super(e),this.state={selected:W.Z.unsafeGetActivePage(t.vivaldiWindowId),offset:1},this.pages=this.getPagesInOrder(t.vivaldiWindowId),this.workingPageSet=this.pages.map((e=>({uid:Math.ceil(Math.random()*Math.pow(10,12)),page:e})))}getMaxAllowedWidth=()=>this.context.innerWidth-E9;getNumberOfPreviews=()=>{const{pages:e}=this;if(e.size*E9<this.getMaxAllowedWidth())return e.size;let t=1;for(;(t+1)*E9+24<this.getMaxAllowedWidth()&&t<e.size;)t++;return t};getPagesInOrder=e=>{const t=W.Z.getPages(e);if(M.Z.get(D.kTabsCycleByRecentOrder)){const n=W.Z.getPageHistory(e);return(0,fa.aV)(n.map((e=>t.find((t=>t.id===e)))).filter(Boolean).reverse())}return t};getSelectedPageWithOffset=e=>{const{pages:t}=this,{selected:n}=this.state;let i=t.indexOf(n)+e;return i=(i%t.size+t.size)%t.size,t.get(i)};cancelEvent=e=>{e.stopPropagation(),e.preventDefault()};navigateWithOffset=e=>{const t=this.getSelectedPageWithOffset(e);t&&this.setState({selected:t,offset:e},(()=>{const e=document.querySelector(".visual-list.selected");e&&e.scrollIntoViewIfNeeded()}))};selectBack=()=>{this.navigateWithOffset(-1)};selectForward=()=>{this.navigateWithOffset(1)};selectByUid=e=>{const t=this.workingPageSet.find((t=>t.uid===e));t&&this.selectPage(t.page)};selectPage=e=>{this.setState({selected:e})};renderMinimalList=()=>{const{pages:e}=this,{selected:t}=this.state;return Z9("div",{className:"tabswitcher list"},void 0,Z9("img",{className:mn()({"visual-list-preview":!0,"active-page":t.active}),src:t.vivExtData.thumbnail,onContextMenu:this.cancelEvent,onMouseDown:()=>this.selectPage(t),title:St.jk.getDisplayUrl(t.url)||St.jk.getDisplayTitle(t),alt:""}),Z9("ul",{className:"listed-tabs"},void 0,e.map((e=>{const n=e.id===t.id;return Z9(k9,{selectPage:this.selectPage,listType:"minimal",page:e,selected:n},"visual-tab-list-"+e.id)}))))};renderVisualList=()=>{const{pages:e,workingPageSet:t}=this,{selected:n,offset:i}=this.state,s=this.getNumberOfPreviews(),o=s*E9+24,a=e.indexOf(this.state.selected);let r=t;if(t.size>s){const e=Math.min(Math.max(a-Math.floor(s/2)+(-1!==i||s%2?0:1),0),t.size-s);r=t.reduce(((t,n,i)=>(i>=e&&i<e+s&&t.push(n),t)),[])}return Z9("div",{className:"tabswitcher",tabIndex:"1",style:{width:o},onContextMenu:this.cancelEvent},void 0,Z9("div",{className:"visual-tabs"},void 0,r.map((e=>{const{page:t,uid:i}=e,{active:s,id:o,url:a}=t,r=St.jk.getFavicon(t.url);return Z9("div",{onMouseDown:this.selectByUid.bind(this,i),style:{backgroundImage:`url('${t.vivExtData.thumbnail??""}')`},title:St.jk.getDisplayTitle(t),className:mn()({"visual-tab":!0,selected:o===n.id,"active-page":s})},i,Z9("div",{className:"visual-tab-favicon-container"},void 0,Z9(Oi,{className:"visual-tab-favicon",url:r||a,loadType:r?"faviconFromCache":"page"})))}))),Z9(k9,{page:n,listType:"visual"}))};render(){return M.Z.get(D.kTabsVisualSwitchListLayout)?this.renderMinimalList():this.renderVisualList()}}const N9=_9;var M9;function P9(e,t,n,i){M9||(M9="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:M9,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}let D9=!1;class x9 extends tn.Component{static contextType=dn.Z;refVisualTabSwitcher=tn.createRef();preventClosingByDelay=()=>{D9=!0;setTimeout((()=>{D9=!1}),500)};handleClose=e=>{const{dialog:t,onClose:n}=this.props;return D9||e!==t?Promise.resolve():n()};render(){const{dialog:e,options:t}=this.props;let n="float";switch(e){case"MAIN_SHOW_TAB_CYCLER":n="modal-tabswitcher";break;case"MAIN_SHOW_QUICKCOMMANDS":n="qc-modal float top";break;case"MAIN_SHOW_KEYBOARDS_SHORTCUTS":n="show-keyboard-shortcuts-modal-top float top";break;case"MAIN_SHOW_PAGE_ACCESS_KEYS":n="page-access-keys";break;case"MAIN_SHOW_MAIL_ACCOUNT_DIALOG":case"MAIN_SHOW_CALENDAR_ACCOUNT_DIALOG":n="onboarding";break;case"MAIN_SHOW_CALENDAR_EDIT_EVENT":case"MAIN_SHOW_CREATE_CALENDAR_DIALOG":case"MAIN_SHOW_CALENDAR_IMPORT_EVENTS_DIALOG":n="calendar-new float";break;case"MAIN_SHOW_ACCOUNT_SHEET":n="slide";break;case"MAIN_SHOW_CALENDAR_ALARM":n=t.fullscreen?"calendar-fullscreen-alarm":"calendar-alarm"}return P9(id,{level:"tabs"},void 0,P9(ln.Z,{onRequestClose:this.handleClose.bind(this,e),viewMode:n},void 0,"MAIN_SHOW_QUICKCOMMANDS"===e&&P9(p9,{onClose:this.handleClose.bind(this,e),quickCommandValue:this.props.quickCommandValue,storeQuickCommandValue:this.props.storeQuickCommandSearch},"MAIN_SHOW_QUICKCOMMANDS"),"MAIN_SHOW_KEYBOARDS_SHORTCUTS"===e&&P9(f9,{onClose:this.handleClose.bind(this,e)},"MAIN_SHOW_KEYBOARDS_SHORTCUTS"),"MAIN_SHOW_PAGE_ACCESS_KEYS"===e&&P9(b7,{onClose:this.handleClose.bind(this,e)},"MAIN_SHOW_PAGE_ACCESS_KEYS"),"MAIN_SHOW_TAB_CYCLER"===e&&(0,fn.jsx)(N9,{ref:this.refVisualTabSwitcher},"MAIN_SHOW_TAB_CYCLER"),"MAIN_SHOW_CALENDAR_ALARM"===e&&P9(F6,{onClose:this.handleClose.bind(this,e),windowToRestore:t.windowToRestore},"MAIN_SHOW_CALENDAR_ALARM"),"MAIN_SHOW_CALENDAR_EDIT_EVENT"===e&&P9(f6,{editor:t.editor,onClose:this.handleClose.bind(this,e)}),"MAIN_SHOW_CALENDAR_IMPORT_EVENTS_DIALOG"===e&&P9(I6,{windowId:this.context.vivaldiWindowId,filePath:t.uri,onClose:this.handleClose.bind(this,e)}),"MAIN_SHOW_CREATE_CALENDAR_DIALOG"===e&&P9(G6,{windowId:this.context.vivaldiWindowId,onClose:this.handleClose.bind(this,e)}),"MAIN_SHOW_MAIL_AUTHENTICATION_DIALOG"===e&&P9(i7,{onClose:this.handleClose.bind(this,e),options:t}),"MAIN_SHOW_MAIL_DELETE_DIALOG_ACCOUNTS"===e&&P9(d7,{windowId:this.context.vivaldiWindowId,onClose:this.handleClose.bind(this,e),options:t}),"MAIN_SHOW_MAIL_DELETE_DIALOG_CONFIRM_ALL"===e&&P9(c7,{windowId:this.context.vivaldiWindowId,onClose:this.handleClose.bind(this,e),options:t}),"MAIN_SHOW_MAIL_DELETE_DIALOG_FOLDERS"===e&&P9(h7,{windowId:this.context.vivaldiWindowId,onClose:this.handleClose.bind(this,e),options:t}),"MAIN_SHOW_MAIL_DELETE_DIALOG_SETTING"===e&&P9(p7,{windowId:this.context.vivaldiWindowId,onClose:this.handleClose.bind(this,e),options:t}),"MAIN_SHOW_MAIL_UNSUBSCRIBE_DIALOG"===e&&P9(v7,{onClose:this.handleClose.bind(this,e),options:t}),"MAIN_SHOW_MODAL_DIALOG"===e&&P9(Z6,{onClose:this.handleClose.bind(this,e),modal:t.modal,resolve:t.resolve}),"MAIN_SHOW_ADD_FEED"===e&&P9(aa,{onClose:this.handleClose.bind(this,e),options:t,dismissable:!0},e),"MAIN_SHOW_ADD_MAIL_FOLDER"===e&&P9(d6,{onClose:this.handleClose.bind(this,e),options:t,dismissable:!0},e),"MAIN_SHOW_CREATE_LABEL"===e&&P9(iv,{windowId:this.context.vivaldiWindowId,onClose:this.handleClose.bind(this,e),viewMode:"float"},e),"MAIN_SHOW_DELETE_MAIL_FOLDER"===e&&P9(Y6,{onClose:this.handleClose.bind(this,e),options:t,dismissable:!0},e),"MAIN_SHOW_DELETE_LABEL_CONFIRMATION"===e&&W6({dialog:e,handleClose:this.handleClose,label:t.label,callback:t.callback}),"MAIN_SHOW_ACCOUNT_SHEET"===e&&P9(fH,{onClose:this.handleClose.bind(this,e),view:t,autoFocus:!0},e),"MAIN_SHOW_MAIL_ACCOUNT_DIALOG"===e&&P9(J6,{onClose:this.handleClose.bind(this,e)},e),"MAIN_SHOW_CALENDAR_ACCOUNT_DIALOG"===e&&P9(u6,{windowId:this.context.vivaldiWindowId,onClose:this.handleClose.bind(this,e)},e)))}}const O9=x9;class L9 extends Us.Z{dispatchAction(e){switch(e.actionType){case"MAIN_SHOW_CLEAR_BROWSING_HISTORY_DIALOG":case"MAIN_SHOW_MAIL_ACCOUNT_DIALOG":case"MAIN_SHOW_CALENDAR_ACCOUNT_DIALOG":case"MAIN_SHOW_CREATE_CALENDAR_DIALOG":case"MAIN_SHOW_IMPORT_DATA_DIALOG":case"MAIN_SHOW_KEYBOARDS_SHORTCUTS":case"MAIN_SHOW_PAGE_ACCESS_KEYS":case"MAIN_SHOW_OPEN_SESSION_DIALOG":case"MAIN_SHOW_QUICKCOMMANDS":case"MAIN_SHOW_PRIVACY_STATS":case"MAIN_SHOW_CREATE_LABEL":this.emitChange({winId:e.winId,type:e.actionType});break;case"MAIN_SELECTING_TOOLBAR":this.emitChange({winId:e.winId,type:"MAIN_SELECTING_TOOLBAR",options:e.options});break;case"MAIN_SHOW_CONFIRM_OPEN_LINKS_DIALOG":this.emitChange({winId:e.winId,type:"MAIN_SHOW_CONFIRM_OPEN_LINKS_DIALOG",options:e.options});break;case"MAIN_SHOW_CONFIRM_CLOSE_OTHER_TABS_DIALOG":this.emitChange({winId:e.winId,type:"MAIN_SHOW_CONFIRM_CLOSE_OTHER_TABS_DIALOG",options:e.options});break;case"MAIN_SHOW_BOOKMARK_DIALOG":this.emitChange({winId:e.winId,type:"MAIN_SHOW_BOOKMARK_DIALOG",options:e.options});break;case"MAIN_SHOW_SAVE_SESSION_DIALOG":this.emitChange({winId:e.winId,type:"MAIN_SHOW_SAVE_SESSION_DIALOG",options:e.options});break;case"MAIN_SHOW_ADD_FEED":this.emitChange({winId:e.winId,type:"MAIN_SHOW_ADD_FEED",options:e.options});break;case"MAIN_SHOW_ADD_MAIL_FOLDER":this.emitChange({winId:e.winId,type:"MAIN_SHOW_ADD_MAIL_FOLDER",options:e.options});break;case"MAIN_SHOW_DELETE_MAIL_FOLDER":this.emitChange({winId:e.winId,type:"MAIN_SHOW_DELETE_MAIL_FOLDER",options:e.options});break;case"MAIN_SHOW_MAIL_AUTHENTICATION_DIALOG":this.emitChange({winId:e.winId,type:"MAIN_SHOW_MAIL_AUTHENTICATION_DIALOG",options:e.options});break;case"MAIN_SHOW_MAIL_UNSUBSCRIBE_DIALOG":this.emitChange({winId:e.winId,type:"MAIN_SHOW_MAIL_UNSUBSCRIBE_DIALOG",options:e.options});break;case"MAIN_SHOW_MAIL_DELETE_DIALOG_ACCOUNTS":this.emitChange({winId:e.winId,type:"MAIN_SHOW_MAIL_DELETE_DIALOG_ACCOUNTS",options:e.options});break;case"MAIN_SHOW_MAIL_DELETE_DIALOG_CONFIRM_ALL":this.emitChange({winId:e.winId,type:"MAIN_SHOW_MAIL_DELETE_DIALOG_CONFIRM_ALL",options:e.options});break;case"MAIN_SHOW_DELETE_LABEL_CONFIRMATION":this.emitChange({winId:e.winId,type:"MAIN_SHOW_DELETE_LABEL_CONFIRMATION",options:e.options});break;case"MAIN_SHOW_MAIL_DELETE_DIALOG_FOLDERS":this.emitChange({winId:e.winId,type:"MAIN_SHOW_MAIL_DELETE_DIALOG_FOLDERS",options:e.options});break;case"MAIN_SHOW_MAIL_DELETE_DIALOG_SETTING":this.emitChange({winId:e.winId,type:"MAIN_SHOW_MAIL_DELETE_DIALOG_SETTING",options:e.options});break;case"MAIN_SHOW_ACCOUNT_SHEET":this.emitChange({winId:e.winId,type:"MAIN_SHOW_ACCOUNT_SHEET",options:e.options});break;case"MAIN_SHOW_CALENDAR_ALARM":this.emitChange({winId:e.winId,type:"MAIN_SHOW_CALENDAR_ALARM",options:e.options});break;case"MAIN_SHOW_CALENDAR_EDIT_EVENT":this.emitChange({winId:e.winId,type:"MAIN_SHOW_CALENDAR_EDIT_EVENT",options:e.options});break;case"MAIN_SHOW_CALENDAR_IMPORT_EVENTS_DIALOG":this.emitChange({winId:e.winId,type:"MAIN_SHOW_CALENDAR_IMPORT_EVENTS_DIALOG",options:e.options});break;case"MAIN_SHOW_MODAL_DIALOG":this.emitChange({winId:e.winId,type:"MAIN_SHOW_MODAL_DIALOG",options:e.options});break;case"MAIN_SHOW_DIALOG":this.emitChange({winId:e.winId,type:e.actionType,options:e.options,onAfterClose:e.onAfterClose});break;case"MAIN_SHOW_BOOKMARK_ADDED_POPUP":this.emitChange({winId:e.winId,type:"MAIN_SHOW_BOOKMARK_ADDED_POPUP",options:e.options})}}}const R9=new L9(l.Z);var B9;function F9(e,t,n,i){B9||(B9="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:B9,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const U9=[D.kCalendarRelativeDates],V9={lastWeek:F.ZP.getWeekdayFormat("LL")+" LT",sameElse:F.ZP.getWeekdayFormat("LL")+" LT"};class W9 extends tn.PureComponent{refTreeList=tn.createRef();state={sessionSorting:[]};componentDidMount(){this.refTreeList.current&&this.refTreeList.current.focusTree()}isFolder=e=>!1;hasChildren=e=>!1;isValidForClipboard=e=>!1;getContextMenuItems=e=>[];getSelectedSessions=()=>{const e=this.refTreeList.current?.selectionModel.selectedIds.map((e=>e.id))||[],t=[];return e.forEach((e=>{const n=this.refTreeList.current?.findTreeItem(e);n&&t.push(n)})),t};onKeyDown=e=>{"Enter"===kA.Z[e.keyCode]&&this.props.onOpenSessions(),("Escape"===kA.Z[e.keyCode]||"."===kA.Z[e.keyCode]&&e.metaKey)&&this.props.onClose(),"Up"!==kA.Z[e.keyCode]&&"Down"!==kA.Z[e.keyCode]||this.props.onUpdateSelection(!0)};getRowComponentProps=e=>({...e,columns:this.props.columns});rowComponent=e=>{const t=e.node,n=this.props.prefValues[D.kCalendarRelativeDates]?b()(t.createDateJS).calendar(null,V9):b()(t.createDateJS).format(V9.sameElse),i=(0,le.Z)("$1 tab","$1 tabs",[t.tabs]),s=(0,le.Z)("$1 window","$1 windows",[t.windows]),o=(0,le.Z)("$1 in $2",[i,s]);if(!this.props.columns)return null;var a=F9("label",{},"1",F9("span",{},void 0,n)),r=F9("label",{},"2",F9("span",{},void 0,o));return this.props.columns.map((e=>{switch(e.id){case"name":return F9("label",{},"0",F9("span",{},void 0,t.name));case"createDateJS":return a;case"tabs":return r;default:console.warn("Unknown sorting field:",e.id)}}))};render(){return(0,fn.jsx)(Yu,{ref:this.refTreeList,rowComponent:this.rowComponent,getRowComponentProps:this.getRowComponentProps,nodes:this.props.nodes,onItemMouseDown:this.props.onUpdateSelection,onItemDoubleClick:this.props.onOpenSessions,onKeyDown:this.onKeyDown,isFolder:this.isFolder,hasChildren:this.hasChildren,isValidForClipboard:this.isValidForClipboard,sorting:this.props.sessionSorting,columns:this.props.columns,multiSelect:!0})}}const H9=(0,fs.Z)(W9,U9);var z9;function G9(e,t,n,i){z9||(z9="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:z9,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const $9=[D.kSessionsOpenInNewWindow,D.kKeyboardTabToAll],K9=nt.Z.getEventHandler,j9=[{text:(0,le.Z)("title","Name"),value:"name",fullScreenTitle:(0,le.Z)("Sort by Name"),width:350,visible:!0,key:!0},{text:(0,le.Z)("Creation Date"),value:"createDateJS",fullScreenTitle:(0,le.Z)("Sort by Creation Date"),width:260,visible:!0},{text:(0,le.Z)("Info"),value:"tabs",fullScreenTitle:(0,le.Z)("Sort by Info"),width:150,visible:!0}];class Y9 extends tn.Component{static contextType=dn.Z;refSessionTree=tn.createRef();state={sessions:[],columns:vu().sessions||fu(j9),disabled:!0,sessionSorting:{sortOrder:ns.Z.DESCENDING_SORT,sortField:"createDateJS",comparator:this.sortComparator}};componentDidMount(){this.refreshSessionList(),this.updateSelectedSessions()}sortComparator=(e,t)=>{const{sortOrder:n,sortField:i}=this.state.sessionSorting;return ns.Z.getDefaultComparator(n,i)(e,t)};refreshSessionList=()=>{d.Z.sessionsPrivate.getAll((e=>{if(Array.isArray(e)){const t=e.map(((e,t)=>({...e,id:t})));this.setState({sessions:t})}}))};updateSelectedSessions=e=>{const t=this.refSessionTree.current?.getSelectedSessions();if(t){var n=!1;t.length>=1&&(n=!0),this.setState({disabled:void 0!==e?!e:!n})}};onDelete=()=>{const e=this.refSessionTree.current?.getSelectedSessions()??[];for(var t=0;t<e.length;t++)d.Z.sessionsPrivate.delete(e[t].name,(e=>{e&&console.warn("Error deleting session '"+this.state.sessions[t].name+"', error: "+e)}));this.refreshSessionList()};onOpenSessions=()=>{const e={openInNewWindow:this.props.prefValues[D.kSessionsOpenInNewWindow]},t=this.refSessionTree.current?.getSelectedSessions()??[];for(var n=0;n<t.length;n++)d.Z.sessionsPrivate.open(this.context.vivaldiWindowId,t[n].name,e).then((e=>{e&&console.warn("Error opening session '"+t[n].value+"', error: "+e)}));this.props.onClose()};onSortChange=(e,t)=>{this.setState((n=>({sessionSorting:{sortOrder:e,sortField:t,comparator:n.sessionSorting.comparator}})))};onUpdateRow=e=>{this.setState({columns:e})};onSaveRow=()=>{mu(this.state.columns,"sessions")};render(){return G9(ln.Z,{onRequestClose:this.props.onClose,dialogWidth:800},void 0,G9("div",{className:"open-session"},void 0,G9("form",{className:"dialog-session",onSubmit:this.onOpenSessions},void 0,G9("header",{className:"dialog-header"},void 0,G9("h1",{className:"dialog-title"},void 0,(0,le.Z)("Open Session"))),G9("div",{className:"dialog-content"},void 0,this.state.sessions.length>0?G9("div",{className:"session-list"},void 0,G9(Iu,{fields:j9,fullsize:!0,onSortChange:this.onSortChange,onSaveRow:this.onSaveRow,onUpdateRow:this.onUpdateRow,columns:this.state.columns,sortField:this.state.sessionSorting.sortField,sortOrder:this.state.sessionSorting.sortOrder,keyAccess:this.props.prefValues[D.kKeyboardTabToAll],manualSorting:!1}),(0,fn.jsx)(H9,{ref:this.refSessionTree,sessionSorting:this.state.sessionSorting,onOpenSessions:this.onOpenSessions,onUpdateSelection:this.updateSelectedSessions,onClose:this.props.onClose,columns:this.state.columns,nodes:this.state.sessions})):G9("div",{},void 0,(0,le.Z)("No saved session."))),G9("footer",{className:"dialog-footer"},void 0,G9("label",{className:"dialog-checkbox"},void 0,G9("input",{type:"checkbox",checked:this.props.prefValues[D.kSessionsOpenInNewWindow],onChange:K9(D.kSessionsOpenInNewWindow),disabled:0===this.state.sessions.length}),G9("span",{},void 0,(0,le.Z)("Open Session in a New Window"))),G9("input",{type:"submit",disabled:this.state.disabled,value:(0,le.Z)("session","Open")}),G9("input",{type:"button",onClick:this.onDelete,className:"danger",disabled:this.state.disabled,value:(0,le.Z)("session","Delete")}),G9("input",{type:"button",onClick:this.props.onClose,value:(0,le.Z)("session","Cancel")})))))}}const X9=(0,fs.Z)(Y9,$9),Q9=JSON.parse('{"t":[{"title":"Vivaldi Browser Help Center","url":"https://help.vivaldi.com","faviconURL":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAKQ2lDQ1BJQ0MgcHJvZmlsZQAAeNqdU3dYk/cWPt/3ZQ9WQtjwsZdsgQAiI6wIyBBZohCSAGGEEBJAxYWIClYUFRGcSFXEgtUKSJ2I4qAouGdBiohai1VcOO4f3Ke1fXrv7e371/u855zn/M55zw+AERImkeaiagA5UoU8Otgfj09IxMm9gAIVSOAEIBDmy8JnBcUAAPADeXh+dLA//AGvbwACAHDVLiQSx+H/g7pQJlcAIJEA4CIS5wsBkFIAyC5UyBQAyBgAsFOzZAoAlAAAbHl8QiIAqg0A7PRJPgUA2KmT3BcA2KIcqQgAjQEAmShHJAJAuwBgVYFSLALAwgCgrEAiLgTArgGAWbYyRwKAvQUAdo5YkA9AYACAmUIszAAgOAIAQx4TzQMgTAOgMNK/4KlfcIW4SAEAwMuVzZdL0jMUuJXQGnfy8ODiIeLCbLFCYRcpEGYJ5CKcl5sjE0jnA0zODAAAGvnRwf44P5Dn5uTh5mbnbO/0xaL+a/BvIj4h8d/+vIwCBAAQTs/v2l/l5dYDcMcBsHW/a6lbANpWAGjf+V0z2wmgWgrQevmLeTj8QB6eoVDIPB0cCgsL7SViob0w44s+/zPhb+CLfvb8QB7+23rwAHGaQJmtwKOD/XFhbnauUo7nywRCMW735yP+x4V//Y4p0eI0sVwsFYrxWIm4UCJNx3m5UpFEIcmV4hLpfzLxH5b9CZN3DQCshk/ATrYHtctswH7uAQKLDljSdgBAfvMtjBoLkQAQZzQyefcAAJO/+Y9AKwEAzZek4wAAvOgYXKiUF0zGCAAARKCBKrBBBwzBFKzADpzBHbzAFwJhBkRADCTAPBBCBuSAHAqhGJZBGVTAOtgEtbADGqARmuEQtMExOA3n4BJcgetwFwZgGJ7CGLyGCQRByAgTYSE6iBFijtgizggXmY4EImFINJKApCDpiBRRIsXIcqQCqUJqkV1II/ItchQ5jVxA+pDbyCAyivyKvEcxlIGyUQPUAnVAuagfGorGoHPRdDQPXYCWomvRGrQePYC2oqfRS+h1dAB9io5jgNExDmaM2WFcjIdFYIlYGibHFmPlWDVWjzVjHVg3dhUbwJ5h7wgkAouAE+wIXoQQwmyCkJBHWExYQ6gl7CO0EroIVwmDhDHCJyKTqE+0JXoS+cR4YjqxkFhGrCbuIR4hniVeJw4TX5NIJA7JkuROCiElkDJJC0lrSNtILaRTpD7SEGmcTCbrkG3J3uQIsoCsIJeRt5APkE+S+8nD5LcUOsWI4kwJoiRSpJQSSjVlP+UEpZ8yQpmgqlHNqZ7UCKqIOp9aSW2gdlAvU4epEzR1miXNmxZDy6Qto9XQmmlnafdoL+l0ugndgx5Fl9CX0mvoB+nn6YP0dwwNhg2Dx0hiKBlrGXsZpxi3GS+ZTKYF05eZyFQw1zIbmWeYD5hvVVgq9ip8FZHKEpU6lVaVfpXnqlRVc1U/1XmqC1SrVQ+rXlZ9pkZVs1DjqQnUFqvVqR1Vu6k2rs5Sd1KPUM9RX6O+X/2C+mMNsoaFRqCGSKNUY7fGGY0hFsYyZfFYQtZyVgPrLGuYTWJbsvnsTHYF+xt2L3tMU0NzqmasZpFmneZxzQEOxrHg8DnZnErOIc4NznstAy0/LbHWaq1mrX6tN9p62r7aYu1y7Rbt69rvdXCdQJ0snfU6bTr3dQm6NrpRuoW623XP6j7TY+t56Qn1yvUO6d3RR/Vt9KP1F+rv1u/RHzcwNAg2kBlsMThj8MyQY+hrmGm40fCE4agRy2i6kcRoo9FJoye4Ju6HZ+M1eBc+ZqxvHGKsNN5l3Gs8YWJpMtukxKTF5L4pzZRrmma60bTTdMzMyCzcrNisyeyOOdWca55hvtm82/yNhaVFnMVKizaLx5balnzLBZZNlvesmFY+VnlW9VbXrEnWXOss623WV2xQG1ebDJs6m8u2qK2brcR2m23fFOIUjynSKfVTbtox7PzsCuya7AbtOfZh9iX2bfbPHcwcEh3WO3Q7fHJ0dcx2bHC866ThNMOpxKnD6VdnG2ehc53zNRemS5DLEpd2lxdTbaeKp26fesuV5RruutK10/Wjm7ub3K3ZbdTdzD3Ffav7TS6bG8ldwz3vQfTw91jicczjnaebp8LzkOcvXnZeWV77vR5Ps5wmntYwbcjbxFvgvct7YDo+PWX6zukDPsY+Ap96n4e+pr4i3z2+I37Wfpl+B/ye+zv6y/2P+L/hefIW8U4FYAHBAeUBvYEagbMDawMfBJkEpQc1BY0FuwYvDD4VQgwJDVkfcpNvwBfyG/ljM9xnLJrRFcoInRVaG/owzCZMHtYRjobPCN8Qfm+m+UzpzLYIiOBHbIi4H2kZmRf5fRQpKjKqLupRtFN0cXT3LNas5Fn7Z72O8Y+pjLk722q2cnZnrGpsUmxj7Ju4gLiquIF4h/hF8ZcSdBMkCe2J5MTYxD2J43MC52yaM5zkmlSWdGOu5dyiuRfm6c7Lnnc8WTVZkHw4hZgSl7I/5YMgQlAvGE/lp25NHRPyhJuFT0W+oo2iUbG3uEo8kuadVpX2ON07fUP6aIZPRnXGMwlPUit5kRmSuSPzTVZE1t6sz9lx2S05lJyUnKNSDWmWtCvXMLcot09mKyuTDeR55m3KG5OHyvfkI/lz89sVbIVM0aO0Uq5QDhZML6greFsYW3i4SL1IWtQz32b+6vkjC4IWfL2QsFC4sLPYuHhZ8eAiv0W7FiOLUxd3LjFdUrpkeGnw0n3LaMuylv1Q4lhSVfJqedzyjlKD0qWlQyuCVzSVqZTJy26u9Fq5YxVhlWRV72qX1VtWfyoXlV+scKyorviwRrjm4ldOX9V89Xlt2treSrfK7etI66Trbqz3Wb+vSr1qQdXQhvANrRvxjeUbX21K3nShemr1js20zcrNAzVhNe1bzLas2/KhNqP2ep1/XctW/a2rt77ZJtrWv913e/MOgx0VO97vlOy8tSt4V2u9RX31btLugt2PGmIbur/mft24R3dPxZ6Pe6V7B/ZF7+tqdG9s3K+/v7IJbVI2jR5IOnDlm4Bv2pvtmne1cFoqDsJB5cEn36Z8e+NQ6KHOw9zDzd+Zf7f1COtIeSvSOr91rC2jbaA9ob3v6IyjnR1eHUe+t/9+7zHjY3XHNY9XnqCdKD3x+eSCk+OnZKeenU4/PdSZ3Hn3TPyZa11RXb1nQ8+ePxd07ky3X/fJ897nj13wvHD0Ivdi2yW3S609rj1HfnD94UivW2/rZffL7Vc8rnT0Tes70e/Tf/pqwNVz1/jXLl2feb3vxuwbt24m3Ry4Jbr1+Hb27Rd3Cu5M3F16j3iv/L7a/eoH+g/qf7T+sWXAbeD4YMBgz8NZD+8OCYee/pT/04fh0kfMR9UjRiONj50fHxsNGr3yZM6T4aeypxPPyn5W/3nrc6vn3/3i+0vPWPzY8Av5i8+/rnmp83Lvq6mvOscjxx+8znk98ab8rc7bfe+477rfx70fmSj8QP5Q89H6Y8en0E/3Pud8/vwv94Tz+4A5JREAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAADKGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDAgNzkuMTYwNDUxLCAyMDE3LzA1LzA2LTAxOjA4OjIxICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOCAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozNjMzMzk4REEzQ0UxMUU4OEQxNUUwM0EyM0ZDRkY5NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozNjMzMzk4RUEzQ0UxMUU4OEQxNUUwM0EyM0ZDRkY5NyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjM2MzMzOThCQTNDRTExRTg4RDE1RTAzQTIzRkNGRjk3IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjM2MzMzOThDQTNDRTExRTg4RDE1RTAzQTIzRkNGRjk3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+CzB6ggAABmJJREFUeNrEV1loVGcU/u4yk0xWs5hJE2PERNCKcX9QhBZR1Iii9UERRNFaRdu+iBL3uiDigj5UQaQPFeuCiMQNKxTy4Ip7K6iYxKhxS2LWyTYz995+/507mTszd9rSFjxwQubOnf98/znn+/7zS4Zh4FOaKv60TpwY+zyJXk6fRB9Cz6f3o6fQ3XSFLjmsp9ED9B56O72B/oJ+l/4r/ZX95X43boQAxNh39Ap6wf+40W8scEfp31sgIxmw2U/0pQmXkbhplszo7obR1cV99oSeu92QUlIgeTzMjWK+42AiayvpX9DH0btiAXydMLgsE3MA+ps3MDQNckEB1KFDIeXmmqCMtjbo9fWmG3xPKSxksVgtTXNabRi9kj7VDsBF/9Fxx9yR/vKluZhr6lS4Z86EOm4clIEDQ8As09+/R/DRI/ivXIH/8mUYBKuUlITW0PXYladY/XUtDKDcary4dGuPH5sBPevWwT1lSsLqyPn5cAufNg3BpUvRtXcv/BcuQB08OFE2RMavhbcw2TH4kydIWrAAmdzRXwWPo9aIEcg4dgwpmzZBq6sDOjujsmXZBBO49aEktuba06dIWrgQaYcPc0X1X7V+ypo18OzYgWBtrVMGiuwAvJFeDdVcHT0aaYcO/Wf+paxahaRFi6A9fx5iSMR0O4DMvsd+Pwx66oEDfY/a791D9fr18LEf/s6C7e2o37kTTSdP9j1L3b0bsmBGS0scgHBuPeHaa69eIWnuXKhlZeYj38OHeDR9OnqamtDw8zGMvXsHSQXOGiUoWMMGbDh71iS9RjDeFSsgp6bCtXw5erdsgZKZGaUTso2GIbrQ3QQQNt/vfyDI4LmTJiHY0oyX235IuHudwtTNLGUMHw7V5YLv+vVIZefMQdDrhdzbG91uNpUyFU4ZNAjq+PF9L+SUz0DG2LHwv36NtM+Ho/GXk2i/dcsRgJKejqzycgSpASp3nbdkSeRwGTAAwZFl0JqbHQGYB4vh80EmADkrq+8FF9WumPUPvHsHxaXCRU6/3ro1YRbSJ0xAT2srcubPR/rkyVGB9JJS+BhDlaQ4ACFjCmUhrzGWO28esikwPdXVSC4tQXtVFZpOnHAE0HX7tnlcFmzeHPedKzsbvmAQOntAcgQQ1n0HKyafTS4TpIcyXM8A3dQKu3WSLW/370fR9u1wia6PFSiuHWDwTvaZYmUhOhpPNSOaKhEqjRwJ7+LF6Hn2zJRccTjVUCU/HDyIljNn8H7PHlRTLVOp//kbNzo3KVnhYuBuAghYTAjT0PwksXF00tCgdIr/Y62wogIt586ZrEgqKoL28SPecbeSlTWdtS86fjxhFgMvXkBNTjZLIEBk2TKghwFolE1xqjmZizsvoLwGamogsRyi65O5Y8/gEpNGWbNnI4OnpZNpzGzvgwdQ2QcuqxT2EgTCMmyQp/6LFxN2uXf1aqSOGYMAqSZzIbGA4e81+8O7bVvC3/kuXUKQGVDS0szfyDFNGBptiEphantPn4b+9q3zSgRZQBrqjY2QmEaJB5WfOp9NzntGjUoIoO3oUZPSssX5WBa0R7ot1dSDjoqKhItlzJiBzFmz0H3/PgIsmYvy6t2wIeH7Lfv2IUCGiBLaZFiyA2iMFIu1LS1F4Px5tNoOpLiG5KJpVEyFTVV45AiU/v2ddeHqVbTs2gW3mI6iJyPVzoK62IFE/MDHDu+mcHy2dm18QxYXo4SSrHd0QGYzOgavrETDypVQc3LMA8mwZgKRA+rAB3sGrkcTVodOyc3gONVJELU84fxiLnQaxRyC66RxMxvyw7Jl5vdKXl5f8DDlGPiOuVdxM+LFRMwDrfGiKMMgmHqOZgqPYFPfWftk0WxS/L0kwGYUKfedOoVeUtnFDUgO86DQgVRFmZNz82ZlGIB4Tq3FpqjzXaSagbrozRQfcPIV6XQPG4Yk9onKrhYiJARIUMxPoJqgJ98RuzZrHnNH0EJrPkuT5aEZvBnZAQirsi4OsLeqTACt7AVxkiuclnTeA8xBU9BQHCykpsxLiUw2mJcTi9JO9zYKVkeaopSxBHUZDlezL637wWp7FszZTqiXuJTwvBAdLwl3HIuiAxu2NdySVOWR5WUiuJ7gaibsW7qYRr+yRuchmmHkuWVZETfTHnGS/bN51CDANmavlgEfcAa4SAC/9el+OMOf+nr+pwADAAZ5culxNH/mAAAAAElFTkSuQmCC"},{"title":"WikiPedia","url":"https://www.wikipedia.org","faviconURL":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAQAAADZc7J/AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QAAKqNIzIAAAAJcEhZcwAACxIAAAsSAdLdfvwAAAAHdElNRQfhBAwKMAfiL115AAACxklEQVRIx6WVX2jVZRjHP7/T8c9pg2nhv2yDXWg4gqGsQGci68J/FRhq4IUohISpiQpeRoi48DJML0yCukpEiV0oIuaIqTSmUtREFCdhjTTFnTPP9Jz308X57efZ2aJ19vyu3ud9ns/zfX/P+ycKANN4mxZ2MH77gm7O8wgIhEzoClbxdYVMgDA3XKwq3WC4GOamaGHZ/5A+0pbRkmJx1ekAi6PghACkyUU11aebS0OWIhleAOAZQ2QYJEMagCcEppBnKmngCTKJPLVEQI4UNaQjTnGYQWYSUeAeb/Iph7jCS6R4Ro4NtPEZfzCNPJNZSyu7GaSOAaayk/chZPP2+KGIuNc7Fu33c1Piy54ya8FeV4jLvWzWor+6VFxjjwVDlpBVzbtWrPWaw7ZVnGlvPNrpfG8lc3t81b9US4BgUM9YJx4qudVuZ4j7VP3TBR5TS5EDtnkwjisD5HxXbPBxDNBPxDpvqvtsNZcATjrPO/EoAQT1WxGPJoE91op77LPe7xNvcIXbLA5v5nLAY5vFRQ4kGraI9ba5wacJ4Lr1/jRcvxwQ1HYx8rskuMuM+KJXE49ud/Xw+kcDbtsovmUh0bBRnG5vAvjdVzz3PN2QTZVtSxpZBXTxQzyGVuAhXwIRAF8zv/LwPlcQ1J+dJG52KO7MEueIc/xF1Uc2eby8/kgFAK/zDtDBb0TAV8gxaujnGwBOIB9UnqdyBUHtdIq4S+23yQ51vTjLG+pCj4ysP/InlgBDrhIb/NuDvmdBvWBaPOBZm73/X4CgnhbxIxf5o6Vzsk58zTfcX5k+NuCBzSJ+bDFu52kz4mzvjg+gh8V6byXdH3SluLd8A/1bF0rdX0MDm2jE2JNhI9NZH89WdmHUba8FO+wrq6b3PWF+dH2DhPaxEJViHUu+wdCe5tIYd+04PLFdStFNZ9W3eifdE35co4k+7/8AeaKDkPxRJzsAAAAASUVORK5CYII="}]}');var q9;function J9(e,t,n,i){q9||(q9="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:q9,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const e8="AddWebPanel",t8=Q9.t;class n8 extends tn.PureComponent{static contextType=dn.Z;dropMode={support:!1,copy:!1};nodeRef=tn.createRef();state={drawerOpen:!1,suggestions:[],url:"",autocompleteValue:"",editUrl:void 0};componentDidMount(){$C.Z.addListener(this._onUrlbarStoreChanged)}getNode(){return this.nodeRef.current}updateSuggestedSites(){z.ZP.isIncognitoOrGuest(this.context.vivaldiWindowId)||y.Z.topSites.get((e=>{const t=this.props.webPanels.map((e=>e.contentUrl))||[];let n=e.filter((e=>-1===t.indexOf(e.url)));const i=t8.filter((e=>-1===t.indexOf(e.url)));if(n.length+i.length<6)n=[];else{const e=12;i.length>e&&(i.splice(e),n=[]);let t=e-i.length;for(;t>0;){if(n.length>=t){n.splice(t);break}t-=6}}this.setState({suggestions:n.concat(i)})}))}componentWillUnmount(){$C.Z.removeListener(this._onUrlbarStoreChanged)}_onUrlbarStoreChanged=()=>{const{editUrl:e,autocompleteValue:t}=$C.Z.getUrlfieldStateFromId(e8);this.setState({autocompleteValue:t,editUrl:e})};onDragEnter=e=>{this.dropMode=this.supportDropForEvent(e)};onDragOver=e=>{e.preventDefault(),e.stopPropagation(),this.dropMode.support?e.dataTransfer.dropEffect=this.dropMode.copy?"copy":"move":e.dataTransfer.dropEffect="none"};onDrop=e=>{e.preventDefault(),e.stopPropagation(),this.dropMode.support&&Jt.ZP.getUrlsFromEventPromise(e,!0).then((e=>{e.forEach((e=>{this.props.addNew(e.url)}))}))};supportDropForEvent=e=>{const t={};return e.dataTransfer.types.some((e=>e===this.props.rejectMimeType))||(t.support=e.dataTransfer.types.some((e=>"text/uri-list"===e||"text/plain"===e)),t.copy=t.support&&!e.dataTransfer.types.some((e=>e===Q.Up))),t};handleClickOutside=()=>{this.state.drawerOpen&&this.closeDrawer()};handleKeyDown=(e,t,n)=>{if("start"===e){switch(n.key){case"ArrowUp":this.props.moveFocus(this.props.id,"left",!1);break;case"ArrowDown":this.props.moveFocus(this.props.id,"right",!1);break;case"Escape":this.props.leaveBar();break;default:return}n.preventDefault(),n.stopPropagation()}else if("suggestion"===e){switch(n.key){case"ArrowLeft":this.moveFocus(t,"left",!1);break;case"ArrowRight":this.moveFocus(t,"right",!1);break;case"ArrowUp":this.moveFocus(t,"up",!1);break;case"ArrowDown":this.moveFocus(t,"down",!1);break;default:return}n.preventDefault(),n.stopPropagation()}};moveFocus=(e,t,n)=>{const{HTMLElement:i}=this.context,s=this.nodeRef.current;if(s instanceof i&&(!0===n||ss(s))){const n=Array.from(s.querySelectorAll("button.webpanel-suggestion")),i=n.map((e=>e.getAttribute("data-id"))).filter(Boolean);if(0===i.length||i.length!==n.length)return!1;let o,a=0,r=-1;switch(n.forEach((e=>{const t=e.getBoundingClientRect();r<t.left&&(a++,r=t.left)})),t){case"current":if(""===e||"first"===e?e=i[0]:"last"===e&&(e=i[0===this.props.keyAccess?i.length-1:0]),o=i.indexOf(e),-1===o)return!1;break;case"right":case"left":if(1===i.length)return!1;if(o=i.indexOf(e),-1===o)return!1;if("right"===t){if((o+1)%a==0)return!1;if(o+=1,o>=i.length)return!1}else{if(o%a==0)return!1;if(o-=1,o>=i.length)return!1}break;case"up":case"down":if(1===i.length)return!1;if(o=i.indexOf(e),-1===o)return!1;if("up"===t){if(o-=a,o<0)return!1;e=i[o]}else if(o+=a,o>=i.length)return!1;break;default:return!1}e=i[o];const l=s.querySelector(`button.webpanel-suggestion[data-id="${e}"]`);if(l)return l.focus(),!0}return!1};onToggleCallout=()=>{if(this.state.drawerOpen)this.closeDrawer();else{this.updateSuggestedSites();const e=document.getElementById("panels");e&&e.classList.add("leak");const t=W.Z.getActivePage(this.context.vivaldiWindowId)?.url??"",n={drawerOpen:!0,url:St.jk.getDisplayUrl(t)};Of.Z.setUrlfieldState(e8,{selectionStart:0,selectionEnd:t.length,editUrl:void 0,autocompleteValue:""}),this.setState(n),wd.Z.bind("esc",this.closeDrawer)}};onAddWebpanel=()=>{let e=(this.state.autocompleteValue||this.state.editUrl||this.state.url||"").trim();0!==e.length&&(e=(0,Ni.q9)(e),this.props.addNew(e),this.closeDrawer())};onClickSuggested=e=>{0!==e.length&&(e=(0,Ni.q9)(e),this.props.addNew(e),this.closeDrawer())};onUrlChange=e=>{this.setState({url:e?.url||""})};closeDrawer=()=>{const e=document.getElementById("panels");e&&e.classList.remove("leak"),wd.Z.unbind("esc",this.closeDrawer),this.setState({drawerOpen:!1,url:"",editUrl:void 0,autocompleteValue:""})};preventContextMenu=e=>{e.stopPropagation()};render(){const e=mn()({addwebpanelcallout:!0,hidden:!this.state.drawerOpen}),t=mn()({uifocusstop:this.props.uiFocus,addwebpanel:!0,panelbtn:!0});return(0,fn.jsxs)("div",{ref:this.nodeRef,className:"addwebpanel-wrapper",children:[J9("button",{title:(0,le.Z)("Add Web Panel"),"data-id":this.props.id,className:t,tabIndex:this.props.keyAccess,onKeyDown:this.handleKeyDown.bind(this,"start","-1"),onClick:this.onToggleCallout,onDragEnter:this.onDragEnter,onDragOver:this.onDragOver,onDrop:this.onDrop},void 0,J9("span",{dangerouslySetInnerHTML:{__html:cn.ebB.small}})),this.state.drawerOpen&&J9(vs.Z,{focusName:"focus-webpanel-suggestions",forceTrap:!0,style:{display:"contents"}},void 0,J9("div",{className:e,onContextMenu:this.preventContextMenu},void 0,J9("form",{},void 0,J9("header",{},void 0,J9("h1",{},void 0,(0,le.Z)("Add Web Panel"))),J9("div",{className:"webpanel-input"},void 0,J9(oS,{className:"address",title:(0,le.Z)("Enter webpage address"),placeholder:"vivaldi.net",displayUrl:this.state.url,editUrl:this.state.editUrl,autocompletionEnabled:!0,onChange:this.onUrlChange,pageId:e8,autoFocus:!0}),J9("button",{className:"add",tabIndex:"0",onClick:this.onAddWebpanel,dangerouslySetInnerHTML:{__html:cn.md4.medium},tooltip:(0,le.Z)("Add Web Panel")})),this.state.suggestions&&this.state.suggestions.length>0&&J9("div",{className:"webpanel-suggestions"},void 0,J9("div",{className:"suggestions-list"},"list",this.state.suggestions.map(((e,t)=>{const n=e.faviconURL?e.faviconURL:"chrome://favicon/size/16@2x/"+e.url,i=t.toString();return J9("button",{className:"webpanel-suggestion",tabIndex:0===t?"0":this.props.keyAccess,"data-id":i,title:e.title+"\n"+e.url,onKeyDown:this.handleKeyDown.bind(this,"suggestion",i),onClick:()=>this.onClickSuggested(e.url)},t,J9("img",{src:n,alt:""}))})))))))]})}}const i8=(0,Vr.Z)(n8);var s8,o8=n(34155);function a8(e,t,n,i){s8||(s8="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:s8,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const r8=[D.kBookmarksPanelEditorHeight],l8=[{text:(0,le.Z)("Title"),value:"title",fullScreenTitle:(0,le.Z)("Sort by Title")},{text:(0,le.Z)("Address"),value:"url",fullScreenTitle:(0,le.Z)("Sort by Address")},{text:(0,le.Z)("Nickname"),value:"nickname",fullScreenTitle:(0,le.Z)("Sort by Nickname")},{text:(0,le.Z)("Description"),value:"description",fullScreenTitle:(0,le.Z)("Sort by Description")},{text:(0,le.Z)("Created"),value:"dateAdded",fullScreenTitle:(0,le.Z)("Sort by Date Created")}];class d8 extends tn.PureComponent{static contextType=dn.Z;winId=this.context.vivaldiWindowId;refEditor=tn.createRef();nodeRef=tn.createRef();state={filter:"",editorHeight:this.props.prefValues[D.kBookmarksPanelEditorHeight],failedUpgrade:!1,sorting:{sortOrder:ns.Z.NO_SORTING,sortField:"manually",comparator:this.sortComparator}};componentDidMount(){const e=M.Z.get(D.kBookmarksPanelSorting);this.onSortChange(e.sortOrder,e.sortField),Dl.ZP.addListener(this.onPanelStoreChange),en.ZP.addListener(this.onBookmarkStoreChange)}componentWillUnmount(){Dl.ZP.removeListener(this.onPanelStoreChange),en.ZP.removeListener(this.onBookmarkStoreChange)}componentDidUpdate(e,t){!e.open&&this.props.open&&o8.nextTick((()=>this.focusTree()))}hasFocus=()=>{const{HTMLElement:e}=this.context,t=this.nodeRef.current;return t instanceof e&&ss(t)};onPanelStoreChange=(e,t)=>{this.winId===e&&this.props.open&&"setFocus"===t&&!this.hasFocus()&&this.focusTree()};onBookmarkStoreChange=()=>{this.setState({failedUpgrade:en.ZP.isFailedUpgrade()})};onSelect=e=>{this.refEditor.current?.setItem(e)};addBookmark=()=>{this.onAdd(!1)};addFolder=()=>{this.onAdd(!0)};onAdd=e=>{this.setState({filter:""}),this.state.editorHeight>0&&this.refEditor.current?this.refEditor.current._save().then(o8.nextTick((()=>this._tree.onAdd(e)))):(this.setEditorVisible(),this._tree.onAdd(e))};onCreate=e=>{e&&(this.setEditorVisible(),this.refEditor.current&&this.refEditor.current.setIsCreating(!0))};onEditorCanceled=(e,t)=>{t&&e?this._tree.deleteSelectedItems().then((()=>{y.Z.bookmarks.remove(e),this.focusTree()})):this.focusTree()};setEditorVisible=()=>{const e=this.state.editorHeight<230?this.props.prefValues[D.kBookmarksPanelEditorHeight]:this.state.editorHeight;this.updateEditorVisiblityWithHeight(e,!0)};focusTree=()=>{this._tree.refTreeList.current?.focusTree()};deleteSelectedItems=()=>{this._tree.deleteSelectedItems()};onSortChange=(e,t)=>{const n={sortOrder:e,sortField:t,comparator:this.sortComparator};this.setState({sorting:n});const i={sortOrder:e,sortField:t};nt.Z.set(D.kBookmarksPanelSorting,i)};sortComparator=(e,t)=>en.ZP.treeSortComparator(e,t,this.state.sorting);collapseAll=()=>{this._tree.collapseAllFolders()};expandAll=()=>{this._tree.expandAllFolders()};getSelectedItem=()=>this._tree.getSelectedItem();onContextMenu=e=>{const t=e.nativeEvent.buttons>0?null:this.getSelectedItem();e.nativeEvent.buttons>0&&this._tree.unSelectAll(),this._tree.onContextMenu(e,t)};onSearchChange=e=>{this.setState({filter:e.target.value})};onSlidebarPosition=(e,t)=>{this.setState((e=>({editorHeight:Math.max(Math.min(e.editorHeight-t,600),0)})))};onSlideBarStop=()=>{this.updateEditorVisiblityWithHeight(this.state.editorHeight,!0)};onSlidebarToggle=()=>{const e=this.state.editorHeight>Q.Cn?0:230;this.updateEditorVisiblityWithHeight(e,!0)};updateEditorVisiblityWithHeight=(e,t)=>{e<Q.Cn?e=0:e>600&&(e=600),t&&nt.Z.set(D.kBookmarksPanelEditorHeight,e),this.setState({editorHeight:e})};render(){if(!this.props.open)return null;const e=this.props.title+(this.state.failedUpgrade?" (needs upgrade)":"");return(0,fn.jsxs)("div",{ref:this.nodeRef,className:"panel panel-bookmarks",children:[a8("header",{},void 0,a8(Rp,{title:e}),a8("div",{className:"toolbar toolbar-default toolbar-wrap"},void 0,a8("input",{type:"search",placeholder:(0,le.Z)("verb","Search"),value:this.state.filter,onChange:this.onSearchChange}),a8("div",{className:"toolbar"},void 0,a8("div",{className:"toolbar-group"},void 0,a8(sl,{onClick:this.addBookmark,tooltip:(0,le.Z)("New Bookmark"),image:cn.md4.small}),a8(sl,{onClick:this.deleteSelectedItems,tooltip:(0,le.Z)("other","Delete"),image:cn.M2k.small})),a8(sl,{onClick:this.addFolder,tooltip:(0,le.Z)("command","New Folder"),image:cn._TQ.small})))),a8(Iu,{fields:l8,onSortChange:this.onSortChange,keyAccess:this.props.keyAccess,sortField:this.state.sorting.sortField,sortOrder:this.state.sorting.sortOrder}),a8("section",{className:"outerScrollbar",onContextMenu:this.onContextMenu},void 0,(0,fn.jsx)(jj,{ref:e=>this._tree=e,filter:this.state.filter,fullView:!1,inManager:!1,onSelect:this.onSelect,onCreate:this.onCreate,sorting:this.state.sorting})),a8("section",{className:"panel-bookmarks-edit limited",style:{flexBasis:this.state.editorHeight}},void 0,a8(gu,{onStop:this.onSlideBarStop,onSlidebarPosition:this.onSlidebarPosition,onDoubleClick:this.onSlidebarToggle,returnOffset:!0,position:"bottom"}),this.state.editorHeight>0&&(0,fn.jsx)(Nj,{ref:this.refEditor,updateLayout:this.setEditorVisible,getSelectedItem:this.getSelectedItem,onCancel:this.onEditorCanceled,onFocusTree:this.focusTree}))]})}}const c8=(0,fs.Z)(d8,r8);var h8;function p8(e,t,n,i){h8||(h8="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:h8,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const u8=[D.kCalendarDisplayDensity],g8=Lo.Z.getPanelResourceKey(),m8=Symbol("CalendarPanel");let v8=!1;const f8=()=>o.Z.viewPreviousPeriod(g8),y8=()=>o.Z.viewNextPeriod(g8);function w8(e,t){o.Z.selectDate(e,g8,t)}const b8=(e,t)=>{o.Z.updateCalendarUI(g8,{...t,displayMode:e,anchorDate:t.selectedDate})};function C8(e,t){const n=tn.useContext(dn.Z),{calendarFilter:i,editor:s,events:a,eventDraft:r,selectedEvent:l}=LD(g8),d=(0,Tm.Z)(u8),c=tn.useMemo((()=>({editor:{pageId:g8,uid:s.uid},displayDensity:d[D.kCalendarDisplayDensity],isActivePage:!1,isPanel:!0})),[s.uid,d]);if(!e.open)return v8=!1,null;!1===v8&&e.open&&(o.Z.pollAllCalDAVAccounts(n.vivaldiWindowId,!0),v8=!0);const{displayMode:h}=i,{anchorDate:p,selectedDate:u}=i,g=oc.Z.getDisplayRange(p,h);return(0,fn.jsxs)("div",{ref:t,className:"panel",id:"calendar_panel",onClick:function(e){e.stopPropagation(),r&&s.uid===m8&&o.Z.endEventEdit(n.vivaldiWindowId,s)},children:[p8("header",{},void 0,p8(Rp,{title:(0,le.Z)("Calendar")}),p8("div",{className:"toolbar toolbar-default"},void 0,p8(Aq,{initialPeriod:p,setPeriod:w8,startDate:g.start,endDate:g.end,displayMode:h,inPanel:!0}),p8(sl,{className:"left-gap",onClick:()=>ie.Z.showCalendar(n.vivaldiWindowId),tooltip:(0,le.Z)("Open Calendar in Tab"),image:cn.bcq.small})),p8("div",{className:"toolbar toolbar-default toolbar-wrap"},void 0,p8(sl,{onClick:()=>o.Z.selectDate(n.vivaldiWindowId,g8,b()()),disabled:(0,bc.KC)(u.toDate(),new Date),title:(0,le.Z)("Today")}),p8("div",{className:"toolbar-group",style:{marginRight:"auto"}},void 0,p8(sl,{className:"button-narrow",onClick:f8,tooltip:(0,le.Z)("Previous"),image:cn.mgF.medium}),p8(sl,{className:"button-narrow",onClick:y8,tooltip:(0,le.Z)("Next"),image:cn.Zu.medium})),p8("div",{className:"toolbar-group"},void 0,p8(sl,{onClick:()=>b8("day",i),title:(0,le.Z)("Day"),isPressed:"day"===h}),p8(sl,{onClick:()=>b8("week",i),title:(0,le.Z)("Week"),isPressed:"week"===h}),p8(sl,{onClick:()=>b8("agenda",i),title:(0,le.Z)("Agenda"),isPressed:"agenda"===h})))),p8(OD.Provider,{value:c},void 0,p8(GQ,{filter:i,events:a,editingEvent:r,editorUid:m8,selectedEvent:l}))]})}const S8=tn.memo(tn.forwardRef(C8));var T8;function I8(e,t,n,i){T8||(T8="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:T8,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class k8 extends tn.Component{state={to:""};componentDidMount(){UT.addListener(this._chatStoreListener)}componentWillUnmount(){UT.removeListener(this._chatStoreListener)}_chatStoreListener=()=>{const e=UT.getActiveConversation();this.setState({to:e})};render(){return this.props.open?I8("div",{className:"panel",id:"chat"},void 0,I8(qI,{isPanel:!0,initialTo:this.state.to})):null}}const A8=k8;var Z8;function E8(e,t,n,i){Z8||(Z8="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Z8,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const _8=[{text:(0,le.Z)("other","Name"),value:"name",fullScreenTitle:(0,le.Z)("Sort by Name")}];class N8 extends tn.PureComponent{refTreeList=tn.createRef();static contextType=dn.Z;winId=this.context.vivaldiWindowId;state={sorting:M.Z.get(D.kContactPanelSorting)};onSortChange=(e,t)=>{const n={sortOrder:e,sortField:t};this.setState({sorting:n}),nt.Z.set(D.kContactPanelSorting,{sortOrder:e,sortField:t})};sortComparator=(e,t)=>{if(e.trash)return 1;if(t.trash)return-1;if(this.isFolder(e)&&!this.isFolder(t))return-1;if(this.isFolder(t)&&!this.isFolder(e))return 1;const{sortOrder:n,sortField:i}=this.state.sorting;return ns.Z.getDefaultComparator(n,i)(e,t)};getSelectedIds=()=>(this.refTreeList.current?.getAllSelectedItems()||[]).map((e=>e.id));getSelectedItems=()=>{const e=[];for(const t of this.getSelectedIds()){const n=Aa.Z.getNodeById(t);n&&e.push(n)}return e};getSelectedItem=()=>this.refTreeList.current?.getSelectedItem();getNodeName=e=>e.name?e.name:e.emailAddresses&&e.emailAddresses.length>0?e.emailAddresses[0].emailAddress:"";isFolder=e=>!1;hasChildren=e=>!!e.children&&e.children.length>0;unSelectAll=()=>{this.refTreeList.current?.unSelectAll()};deleteSelected=()=>{this.refTreeList.current?.onDelete()};deleteByIds=e=>{this.refTreeList.current?.onDelete(e)};validateForEdit=e=>!0;isValidAddTarget=()=>!0;getTitle=e=>{if("string"==typeof e){const t=Aa.Z.getNodeById(e);return t?this.getNodeName(t):""}return""};saveTitle=(e,t)=>{const n=Aa.Z.getNodeById(e);n&&(n.name=t,K.Z.updateContact(this.context.vivaldiWindowId,n))};onAdd=e=>{this.refTreeList.current?.onAdd(e)};getMenuCapability=async(e,t,n)=>{const i=this.winId;switch(e.action){case"CONTEXT_COMPOSE_MAIL":return{handler:this.compose,visible:Boolean(n),...t(i,e,{})};case"CONTEXT_VIEW_ALL_MESSAGES":return{handler:this.viewAll,visible:Boolean(n),...t(i,e,{})};case"CONTEXT_CONTAINER_DEFAULT_ACTION":{const n=this.props.prefValues[D.kMailContactDefaultAction];return{items:[{type:"radio",radiogroup:1,checked:"compose"===n,handler:()=>this.setDefaultAction("compose"),...(0,Mn.Z)("Compose")},{type:"radio",radiogroup:1,checked:"viewAllMessages"===n,handler:()=>this.setDefaultAction("viewAllMessages"),...(0,Mn.Z)("View All Messages")}],...t(i,e,{})}}default:return{...t(i,e,{})}}};getMenuVisibility=(e,t)=>{if(!t)return"CONTEXT_NEW_ITEM"===e.action;switch(e.action){case"CONTEXT_NEW_ITEM":case"CONTEXT_EDIT":case"CONTEXT_DELETE":return!0;default:return!1}};onContextMenu=e=>{this.refTreeList.current?.onContextMenu(e)};setDefaultAction=e=>{nt.Z.set(D.kMailContactDefaultAction,e)};onDoubleClick=e=>{0!==e.button||this.props.prefValues[D.kMailSingleClickTabs]||this.openTabForSelectedNode()};onNodeMouseDown=(e,t)=>{this.props.focusTree(),0===t.button&&this.props.prefValues[D.kMailSingleClickTabs]&&this.openTabForSelectedNode()};openTabForSelectedNode=()=>{const e=this.props.prefValues[D.kMailContactDefaultAction];"compose"===e?this.compose():"viewAllMessages"===e&&this.viewAll()};compose=()=>{const e=this.getSelectedItems();if(e&&e.length>0){const t=e.flatMap((e=>e.emailAddresses)).map((({emailAddress:e})=>({address:e})));ne.Z.createDraft({to:t})}};viewAll=()=>{const e=this.getSelectedItems();if(e&&e.length>0){const t=this.context.vivaldiWindowId;K.Z.selectContact(t,e[0]),j.Z.selectContact(t,e[0].emailAddresses[0].emailAddress),Y.Z.openURL(t,St.jk.internals.mailpage,{singleton:!0})}};rowComponent=e=>{const t=e.node,n=t?this.getNodeName(t):"";return E8("label",{tabIndex:"-1"},`contact__list__${t.id}`,E8("span",{className:"tree-row-image"},void 0,E8("img",{src:t.avatarUrl?t.avatarUrl:QA.g,alt:""})),E8("span",{className:"title",title:n},void 0,n))};selectById=e=>{this.refTreeList.current?.selectById(e)};menu={name:"contactlist",getCapability:this.getMenuCapability,getVisibility:this.getMenuVisibility};render(){const e={sortOrder:this.state.sorting.sortOrder,sortField:this.state.sorting.sortField,comparator:this.sortComparator};return(0,fn.jsxs)(fn.Fragment,{children:[E8(Iu,{fields:_8,manualSorting:!1,onSortChange:this.onSortChange,keyAccess:this.props.keyAccess,compact:!0,sortField:this.state.sorting.sortField,sortOrder:this.state.sorting.sortOrder}),E8("section",{className:"outerScrollbar"},void 0,(0,fn.jsx)(Yu,{ref:this.refTreeList,settings:"CONTACT_TREE",rowComponent:this.rowComponent,nodes:this.props.nodes,onSelect:this.props.onItemSelected,onItemMouseDown:this.onNodeMouseDown,menu:this.menu,onCreate:this.props.onCreate,onEdit:this.props.onEdit,onItemsActivated:this.openTabForSelectedNode,onItemDoubleClick:this.onDoubleClick,delete:K.Z.deleteContactsByIds,enableDragAndDrop:!1,isFolder:this.isFolder,hasChildren:this.hasChildren,supportsInlineEdit:!1,isValidToEdit:EU.Z,getTitle:this.getTitle,saveTitle:this.saveTitle,isValidAddTarget:this.isValidAddTarget,sorting:e}))]})}}const M8=N8;var P8;function D8(e,t,n,i){P8||(P8="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:P8,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const x8=256,O8=["../resources/contact-person.png","../resources/contact-company.png"];class L8 extends tn.PureComponent{nodeRef=tn.createRef();refPhotoPicker=tn.createRef();state={drawerOpen:!1,isDropTarget:!1,initialPhoto:"",id:""};componentDidUpdate(e,t){const n=this.props.id;n&&n!==e.id&&this.setState({initialPhoto:this.props.photo,id:n}),!0===t.drawerOpen&&!1===this.state.drawerOpen?this.props.disableOnClickOutside():!1===t.drawerOpen&&!0===this.state.drawerOpen&&this.props.enableOnClickOutside()}getNode(){return this.nodeRef.current}onToggleOverlay=()=>{this.setState((e=>({drawerOpen:!e.drawerOpen})))};handleClickOutside=()=>{this.setState({drawerOpen:!1})};photoChange=()=>{this.refPhotoPicker.current?.click()};setContactPhoto=e=>{if(e.target.files&&e.target.files.length>0){var t=e.target.files[0],n=new FileReader;n.onloadend=()=>{this.setState({drawerOpen:!1,isDropTarget:!1}),"string"==typeof n.result&&this.props.attributeChange(n.result)},n.readAsDataURL(t)}};photoDragOver=e=>{e.preventDefault()};photoDragEnter=()=>{this.setState({isDropTarget:!0})};photoDragLeave=()=>{this.setState({isDropTarget:!1})};photoDrop=e=>{const t=e.dataTransfer.files[0];if(this.setState({isDropTarget:!1}),t&&t.type.match("image.*")){const e=new FileReader;e.onloadend=()=>{"string"==typeof e.result&&this.setPhoto(e.result)},e.readAsDataURL(t)}};getGravatar=()=>{const e=Et()(this.props.emailAddress);fetch(`https://secure.gravatar.com/avatar/${e}?s=512&d=404`).then((e=>{e.ok&&e.blob().then((e=>{const t=new FileReader;t.addEventListener("loadend",(()=>{"string"==typeof t.result&&this.setPhoto(t.result),this.setState({drawerOpen:!1,isDropTarget:!1})})),t.readAsDataURL(e)}))}))};setPhoto=e=>{if(!e)return this.props.attributeChange(""),void this.setState({drawerOpen:!1,isDropTarget:!1});const t=document.createElement("canvas"),n=t.getContext("2d"),i=document.createElement("img");let s=0,o=0;t.width=x8,t.height=x8,i.onload=()=>{i.height>i.width?(i.height*=x8/i.width,i.width=x8,o=.5*-(i.height-x8)):(i.width*=x8/i.height,i.height=x8,s=.5*-(i.width-x8)),n.drawImage(i,s,o,i.width,i.height),this.props.attributeChange(t.toDataURL("image/jpeg",.9)),this.setState({drawerOpen:!1})},i.src=e};render(){const e=this.props.photo,t=mn()({"contact-photo-is-droptarget":this.state.isDropTarget,"contact-photo":!0});return(0,fn.jsxs)("span",{ref:this.nodeRef,className:"contact-photo-picker",children:[D8("button",{className:t,onDrop:this.photoDrop,onDragEnter:this.photoDragEnter,onDragLeave:this.photoDragLeave,onDragOver:this.photoDragOver,style:e?{backgroundImage:`url(${e})`}:{backgroundImage:`url(${QA.g})`},disabled:-1===this.props.id,onClick:this.onToggleOverlay}),(0,fn.jsx)("input",{type:"file",tabIndex:"-1",accept:"image/*",ref:this.refPhotoPicker,disabled:-1===this.props.id,onChange:this.setContactPhoto,style:{position:"absolute",visibility:"hidden",height:0,width:0}}),this.state.drawerOpen&&D8("div",{className:"contact-photo-picker-overlay"},void 0,D8("div",{className:"photo-picker-suggestions"},void 0,D8("button",{className:"photo-picker-suggestion",onClick:this.props.disabled?void 0:this.setPhoto.bind(this,this.state.initialPhoto),style:{backgroundImage:this.state.initialPhoto?`url(${this.state.initialPhoto})`:`url(${QA.g})`}}),O8.map(((e,t)=>D8("button",{className:"photo-picker-suggestion",onClick:this.setPhoto.bind(this,O8[t]),style:{backgroundImage:`url(${e})`}},`photo-picker-suggestion-${t}`)))),D8("input",{type:"button",onClick:this.getGravatar,value:(0,le.Z)("Get Gravatar")}),D8("input",{type:"button",className:"primary",onClick:this.photoChange,value:(0,le.Z)("Browse...")}))]})}}const R8=(0,Vr.Z)(L8);var B8,F8;function U8(e,t,n,i){B8||(B8="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:B8,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class V8 extends tn.PureComponent{isIMEOpen=!1;nodeRef=tn.createRef();state={values:this.props.values};resetValues(){this.setState({values:this.props.values})}_handleChange=(e,t)=>{if(this.isIMEOpen)return!1;const n=t.target.value,i=t.target.name;this.setState((t=>{const s=[...t.values];return s[e]={...t.values[e],[i]:n},{values:s}}))};_handleAdd=e=>{0===e.button&&this._handleChange(this.props.values.length,e)};_handleRemove=(e,t)=>{0===t.button&&(e?this.props.onRemove(e):this.resetValues())};_handleSubmit=()=>{this.props.onChange(this.state.values)};_handleFormSubmit=e=>{e.preventDefault(),this._handleSubmit()};_handleInputKeyDown=e=>{switch(e.key){case"Escape":return void this.resetValues();case"Enter":return void this._handleSubmit()}};onCompositionUpdate=()=>{this.isIMEOpen=!0};onCompositionEnd=(e,t)=>{this.isIMEOpen=!1,this._handleChange(e,t)};renderSimpleForm(e,t){return U8("form",{},void 0,this.renderTypes(e,0),this.props.label&&U8("input",{className:"contact-field",type:e,defaultValue:this.props.values[0],placeholder:t,title:t,name:"value",onChange:e=>this._handleChange(0,e),onKeyDown:this._handleInputKeyDown,onBlur:this._handleFormSubmit,onCompositionStart:this.onCompositionUpdate,onCompositionUpdate:this.onCompositionUpdate,onCompositionEnd:e=>this.onCompositionEnd(0,e)}))}renderTypes=(e,t)=>U8("select",{className:"contact-type-picker",name:"type",onChange:this._handleChange.bind(this,t),onBlur:this._handleFormSubmit,value:e},void 0,U8("option",{value:""},void 0,(0,le.Z)("contact type","default")),U8("option",{value:"home"},void 0,(0,le.Z)("home")),U8("option",{value:"work"},void 0,(0,le.Z)("work")));render(){const{values:e}=this.state,{inputType:t="text",label:n}=this.props;return 0===e.length?this.renderSimpleForm(t,n):(0,fn.jsx)(fn.Fragment,{children:(0,fn.jsx)("form",{ref:this.nodeRef,onSubmit:this._handleFormSubmit,children:e.map(((i,s)=>U8(tn.Fragment,{},i.id+"_"+s,this.renderTypes(i.type||"",s),U8("span",{className:"contact-field"},void 0,this.props.label&&U8("input",{type:t,name:"value",defaultValue:i.value||"",placeholder:n,title:n,onChange:this._handleChange.bind(this,s),onBlur:this._handleFormSubmit,onKeyDown:this._handleInputKeyDown,onCompositionStart:this.onCompositionUpdate,onCompositionUpdate:this.onCompositionUpdate,onCompositionEnd:this.onCompositionEnd,autoFocus:s===e.length-1}),U8("button",{type:"button",className:"remove",title:(0,le.Z)("verb","Remove"),onMouseUp:this._handleRemove.bind(this,i.id),onClick:this._handleRemove.bind(this,i.id)},void 0,"–")),s===e.length-1&&U8("input",{type:"button",value:this.props.actionLabel,className:"add",onMouseUp:this._handleAdd,onClick:this._handleAdd}))))})})}}function W8(e,t,n,i){F8||(F8="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:F8,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var H8=W8("span",{className:"spacer"}),z8=W8("span",{className:"spacer"}),G8=W8("span",{className:"spacer"}),$8=W8("span",{className:"spacer"}),K8=W8("span",{className:"spacer"}),j8=W8("span",{className:"spacer"}),Y8=W8("span",{className:"spacer"}),X8=W8("span",{className:"spacer"}),Q8=W8("span",{className:"spacer"});class q8 extends tn.Component{static contextType=dn.Z;refName=tn.createRef();refPhotoPicker=tn.createRef();state={contact:this.props.contact,editMode:!1};static getDerivedStateFromProps(e,t){return{contact:e.contact}}focus=()=>{this.refName.current?.focus()};changeProperty=(e,t)=>{const{contact:n}=this.state;let i=t.target.value;"birthday"===e&&(i=b()(i).valueOf()),n[e]!==i&&(n[e]=i,this.setState({contact:n}))};updateCheckboxProperty=(e,t)=>{const{contact:n}=this.state;-1!==n.id&&K.Z.update(this.context.vivaldiWindowId,n.id,{[e]:t.target.checked})};updateAvatar=e=>{const{contact:t}=this.state;K.Z.update(this.context.vivaldiWindowId,t.id,{avatarUrl:e}),this.setState((t=>({contact:{...t.contact,avatarUrl:e}})))};update=e=>{const{contact:t}=this.state,n=this.context.vivaldiWindowId;switch(e){case"name":return K.Z.update(n,t.id,{name:t.name,generatedFromSentMail:!1});case"birthday":return K.Z.update(n,t.id,{birthday:t.birthday,generatedFromSentMail:!1});case"note":return K.Z.update(n,t.id,{note:t.note,generatedFromSentMail:!1})}};_handleEmailsChanged=e=>{const t=this.context.vivaldiWindowId,{contact:n}=this.state;e.forEach((e=>{const i=e.id,s=n.emailAddresses.find((e=>e.id===i));s?(0,Sm.default)(s,e)||K.Z.updateEmailAddress(t,i,{contactId:n.id,emailAddress:e.value,type:e.type}):K.Z.addEmailAddress(t,{contactId:n.id,emailAddress:e.value,type:e.type})}))};_handleEmailsRemoved=e=>{K.Z.removeEmailAddress(this.context.vivaldiWindowId,{contactId:this.props.contact.id,emailAddressId:e})};_handlePropertyValueChanged=({propertyName:e,propertyCollectionName:t,values:n})=>{if(0===n.length)return;const{contact:i}=this.state,s=i.id,o=this.context.vivaldiWindowId;n.forEach((n=>{const a=n.id,r=i[t].find((e=>e.id===a));(r||n.value)&&(r?K.Z.updatePropertyItem(o,{contactId:s,propertyName:e,propertyId:a,type:n.type,propertyValue:n.value}):K.Z.addPropertyItem(o,{contactId:s,propertyName:e,type:n.type||"",propertyValue:n.value}))}))};_handlePhoneNumbersChanged=e=>{this._handlePropertyValueChanged({values:e,propertyName:"phoneNumber",propertyCollectionName:"phoneNumbers"})};_handlePhoneNumbersRemoved=e=>{K.Z.removePropertyItem(this.context.vivaldiWindowId,{propertyName:"phoneNumber",contactId:this.state.contact.id,propertyId:e})};_handlePostalAddressesChanged=e=>{this._handlePropertyValueChanged({values:e,propertyName:"postalAddress",propertyCollectionName:"postalAddresses"})};_handlePostalAddressesRemoved=e=>{K.Z.removePropertyItem(this.context.vivaldiWindowId,{propertyName:"postalAddress",contactId:this.state.contact.id,propertyId:e})};onKeyDown=(e,t)=>{"Enter"!==t.key||this.update(e)};call=(e="",t)=>{const n=e.replace(/[^\d]/g,"");n&&(t.stopPropagation(),Y.Z.openURL(this.context.vivaldiWindowId,`tel:+${n}`))};compose=(e="",t)=>{e&&(t.stopPropagation(),ne.Z.createDraft({to:(0,ye.D$)(e)}))};showMap=(e="",t)=>{e&&(t.stopPropagation(),Y.Z.openURL(this.context.vivaldiWindowId,`map:+${e}`))};enableEditMode=()=>{this.setState({editMode:!0},(()=>this.focus()))};toggleEditMode=()=>{this.setState((e=>({editMode:!e.editMode})))};addSpaces=e=>e.split("").reverse().join("").replace(/(.{3})/g,"$1 ").split("").reverse().join("").replace("+ ","+");renderDisplayMode=()=>{const{contact:e}=this.state;return W8("div",{className:"contact-view cardview",onClick:this.props.onEdit},void 0,W8("div",{className:"contact-header"},void 0,(0,fn.jsx)(R8,{ref:this.refPhotoPicker,id:e.id,disabled:!0,attributeChange:this.updateAvatar,photo:e.avatarUrl||"",emailAddress:e.emailAddresses.length>0?e.emailAddresses[0].emailAddress:""}),W8("div",{className:mn()({"contact-name":!0,selectable:e.name,disabled:!e.name})},void 0,e.name||(0,le.Z)("noun","Name"))),H8,e.emailAddresses.map((e=>{if(e.emailAddress)return W8(tn.Fragment,{},e.id,W8("div",{className:"contact-field-type"},void 0,W8("span",{className:"info"},void 0,e.type),W8("span",{dangerouslySetInnerHTML:{__html:cn.HXY},className:"contact-action-button",onClick:this.compose.bind(null,e.emailAddress),title:(0,le.Z)("Compose new mail"),tooltip:(0,le.Z)("Compose new mail")+" "+U.Z.getShortcut("COMMAND_MAIL_COMPOSE_NEW_MESSAGE")})),W8("p",{className:"contact-email selectable"},void 0,e.emailAddress))})),z8,e.phoneNumbers.map((e=>{if(e.phoneNumber)return W8(tn.Fragment,{},e.id,W8("div",{className:"contact-field-type"},void 0,W8("span",{className:"info"},void 0,e.type),W8("span",{dangerouslySetInnerHTML:{__html:cn.Mqy},className:"contact-action-button",onClick:this.call.bind(null,e.phoneNumber),title:(0,le.Z)("Call")})),W8("p",{className:"contact-phone selectable"},void 0,this.addSpaces(e.phoneNumber)))})),G8,e.postalAddresses.map((e=>{if(e.postalAddress)return W8(tn.Fragment,{},e.id,W8("div",{className:"contact-field-type"},void 0,W8("span",{className:"info"},void 0,e.type),W8("span",{dangerouslySetInnerHTML:{__html:cn.rnU},className:"contact-action-button",onClick:this.showMap.bind(null,e.postalAddress),title:(0,le.Z)("Open map")})),W8("p",{className:"contact-phone selectable"},void 0,e.postalAddress))})),0!==e.birthday&&(0,fn.jsxs)(fn.Fragment,{children:[$8,W8("span",{dangerouslySetInnerHTML:{__html:cn.bcq.small},className:"contact-field-type contact-action-button"}),W8("p",{className:"contact-birthday selectable"},void 0,b()(e.birthday).format("LL"))]}),e.note&&(0,fn.jsxs)(fn.Fragment,{children:[K8,W8("span",{dangerouslySetInnerHTML:{__html:cn.NNg.small},className:"contact-field-type contact-action-button",onClick:this.toggleEditMode,title:(0,le.Z)("Edit note")}),W8("p",{className:"contact-note selectable"},void 0,e.note)]}))};render(){const{contact:e}=this.state,t=e.emailAddresses[0]&&e.emailAddresses[0].emailAddress;return this.state.editMode?W8("div",{className:"contact-view cardview"},void 0,W8("div",{className:"contact-header"},void 0,W8(R8,{id:e.id,attributeChange:this.updateAvatar,photo:e.avatarUrl||"",emailAddress:t}),W8("span",{className:"contact-name"},void 0,(0,fn.jsx)("input",{ref:this.refName,type:"text",value:e.name||"",placeholder:(0,le.Z)("other","Name"),onChange:this.changeProperty.bind(this,"name"),onKeyDown:this.onKeyDown.bind(this,"name"),onBlur:this.update.bind(this,"name")}))),W8(V8,{values:e.emailAddresses.map((({emailAddress:e,id:t,type:n})=>({value:e,id:t,type:n}))),label:(0,le.Z)("Email"),actionLabel:(0,le.Z)("Add another Email"),inputType:"email",onChange:this._handleEmailsChanged,onRemove:this._handleEmailsRemoved},`emailAddresses-${Math.max(e.emailAddresses.length,1)}`),W8("label",{className:"contact-trusted"},void 0,W8("input",{type:"checkbox",checked:e.trusted||!1,onChange:this.updateCheckboxProperty.bind(this,"trusted")}),W8("span",{},void 0,(0,le.Z)("Always allow external content in emails"))),j8,W8(V8,{values:e.phoneNumbers.map((({phoneNumber:e,id:t,type:n})=>({value:e,id:t,type:n}))),label:(0,le.Z)("Phone Number"),actionLabel:(0,le.Z)("Add another Phone Number"),inputType:"tel",onChange:this._handlePhoneNumbersChanged,onRemove:this._handlePhoneNumbersRemoved},`phoneNumbers-${e.phoneNumbers.length}`),Y8,W8(V8,{values:e.postalAddresses.map((({postalAddress:e,id:t,type:n})=>({value:e,id:t,type:n}))),label:(0,le.Z)("Postal Address"),actionLabel:(0,le.Z)("Add another Postal Address"),inputType:"text",onChange:this._handlePostalAddressesChanged,onRemove:this._handlePostalAddressesRemoved},`postalAddresses-${e.postalAddresses.length}`),X8,W8("span",{className:"contact-field"},void 0,W8(TA,{className:"contact-bday",value:e.birthday?b()(e.birthday).format("YYYY-MM-DD"):"",title:(0,le.Z)("title","Birthday"),onChange:this.changeProperty.bind(this,"birthday"),onKeyDown:this.onKeyDown.bind(this,"birthday"),onBlur:this.update.bind(this,"birthday"),placeholder:(0,le.Z)("title","Birthday")}),W8("button",{type:"button",className:"remove",title:(0,le.Z)("Remove Birthday"),onMouseUp:this.changeProperty.bind({target:{value:0}},"birthday")},void 0,"–")),Q8,W8("textarea",{className:"contact-edit-note",type:"text",value:e.note||"",title:e.note||"",onChange:this.changeProperty.bind(this,"note"),onKeyDown:this.onKeyDown.bind(this,"note"),onBlur:this.update.bind(this,"note"),placeholder:(0,le.Z)("Note")})):this.renderDisplayMode()}}const J8=q8;var eee;function tee(e,t,n,i){eee||(eee="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:eee,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var nee=tee("input",{type:"checkbox",disabled:!0}),iee=tee("span",{className:"spacer"}),see=tee("span",{className:"spacer"}),oee=tee("span",{className:"spacer"}),aee=tee("span",{className:"spacer"});function ree(){return tee("div",{className:"contact-view cardview"},void 0,tee("div",{className:"contact-header"},void 0,tee("span",{className:"contact-photo-picker"},void 0,tee("div",{className:"contact-photo",style:{backgroundImage:"url('/resources/contact-person.png')"}})),tee("input",{className:"contact-name",type:"text",placeholder:(0,le.Z)("other","Name"),disabled:!0})),tee("input",{className:"contact-email",type:"email",placeholder:(0,le.Z)("Email"),disabled:!0}),tee("label",{className:"contact-trusted"},void 0,nee,tee("span",{},void 0,(0,le.Z)("Always allow external content in emails"))),iee,tee("input",{className:"contact-email",type:"tel",placeholder:(0,le.Z)("Phone number"),disabled:!0}),see,tee("input",{className:"contact-email",type:"text",placeholder:(0,le.Z)("Postal address"),disabled:!0}),oee,tee("input",{className:"contact-email",type:"text",placeholder:(0,le.Z)("title","Birthday"),disabled:!0}),aee,tee("input",{className:"contact-postal",type:"text",placeholder:(0,le.Z)("Notes"),disabled:!0}))}var lee,dee=n(34155);function cee(e,t,n,i){lee||(lee="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:lee,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const hee=[D.kContactPanelEditorHeight,D.kMailContactDefaultAction,D.kMailSingleClickTabs];var pee=cee(ree,{});class uee extends tn.PureComponent{static contextType=dn.Z;winId=this.context.vivaldiWindowId;nodeRef=tn.createRef();_tree=tn.createRef();_editor=tn.createRef();state={items:Aa.Z.getAsTree(""),filter:"",editorHeight:this.props.prefValues[D.kContactPanelEditorHeight],contact:{id:Aa.s}};componentDidMount(){Dl.ZP.addListener(this.onPanelStoreChange),Aa.Z.addListener(this.onContactStoreChange)}componentWillUnmount(){Dl.ZP.removeListener(this.onPanelStoreChange),Aa.Z.removeListener(this.onContactStoreChange)}componentDidUpdate(e,t){!e.open&&this.props.open&&dee.nextTick((()=>this._applyTransitionState()))}_applyTransitionState=()=>{const e=Dl.ZP.getTransitionState(this.winId,"contacts");Ho.Z.clearTransitionState(this.winId,"contacts"),this._tree.current&&e?(e.selectId&&this._tree.current.selectById(e.selectId),"edit"===e.reason?this.onEdit():e.setFocus&&this.focusTree()):this.focusTree()};onPanelStoreChange=(e,t)=>{if(e===this.winId&&this.props.open)switch(t){case"setFocus":ss(this.nodeRef.current)||this.focusTree();break;case"display":dee.nextTick((()=>this._applyTransitionState()))}};onContactStoreChange=e=>{switch(e.reason){case"selectedContact":{const t=e.focusContactView&&e.windowId===this.context.vivaldiWindowId;return this.onContactSelectedChange(e.contact,t)}case"newContact":{const t=e.focusContactView&&e.windowId===this.context.vivaldiWindowId;return this.onContactSelectedChange(e.contact,t,{items:Aa.Z.getAsTree(this.state.filter)})}case"startup":{const e=f.Z.getSync("SELECTION_CONTACT_TREE")?.selectedIds_[0]?.id,t=e&&Aa.Z.getNodeById(e)||{id:Aa.s};this.setState((e=>({contact:t,items:Aa.Z.getAsTree(e.filter)})));break}case"addContacts":case"deleteContact":case"updatedContact":return this.setState((e=>({contact:Aa.Z.getSelected(this.context.vivaldiWindowId)||{id:Aa.s},items:Aa.Z.getAsTree(e.filter)})))}};onContactSelectedChange=(e,t,n)=>{this.setState({...n,contact:e},(()=>{t&&e.id!==Aa.s&&(this._editor.current&&this._editor.current.enableEditMode(),this._tree.current&&this._tree.current.selectById(e.id))}))};newItem=e=>{this._tree.current&&this._tree.current.onAdd(e)};onCreate=(e,t,n,i)=>(this.onEdit(),K.Z.newEmptyContact(this.context.vivaldiWindowId));onEdit=()=>{this.state.editorHeight<Q.Cn&&this.onSlidebarToggle();(this.state.contact||Aa.Z.getSelected(this.context.vivaldiWindowId)||{id:Aa.s})&&this._editor.current&&this._editor.current.enableEditMode()};deleteSelected=()=>{this._tree.current&&this._tree.current.deleteSelected()};handleFilterChange=e=>{const t=e.target.value;this.setState({filter:t,items:Aa.Z.getAsTree(t)})};onCompose=()=>{this._tree.current&&this._tree.current.compose()};focusTree=()=>{this._tree.current&&this._tree.current.refTreeList.current?.focusTree()};onItemSelected=e=>{if(e){if(e.id===this.state.contact.id)return;K.Z.selectContact(this.context.vivaldiWindowId,e,!1)}else this.setState({contact:{id:Aa.s}})};onContextMenu=e=>{this._tree.current&&(e.nativeEvent.buttons>0&&this._tree.current.unSelectAll(),this._tree.current.onContextMenu(e))};onSlidebarPosition=(e,t)=>{this.setState((e=>({editorHeight:Math.max(Math.min(e.editorHeight-t,800),0)})))};onSlideBarStop=()=>{this.setState((e=>{let t=e.editorHeight;return t<=Q.Cn&&(t=0),nt.Z.set(D.kContactPanelEditorHeight,t),{editorHeight:t}}))};onSlidebarToggle=()=>{this.setState((e=>{let t=e.editorHeight;return t>Q.Cn?(t=0,nt.Z.set(D.kContactPanelEditorHeight,t)):(t=320,nt.Z.reset(D.kContactPanelEditorHeight)),{editorHeight:t}}))};render(){if(!this.props.open)return null;const e=this.state.contact&&this.state.contact.id!==Aa.s?this.state.contact:void 0;return(0,fn.jsxs)("div",{ref:this.nodeRef,className:"panel",id:"contacts",children:[cee("header",{},void 0,cee(Rp,{title:this.props.title}),cee("div",{className:"toolbar toolbar-default toolbar-wrap"},void 0,cee("input",{type:"search",placeholder:(0,le.Z)("verb","Search"),value:this.state.filter,onChange:this.handleFilterChange}),cee("div",{className:"toolbar"},void 0,cee("div",{className:"toolbar-group"},void 0,cee(sl,{onClick:this.newItem.bind(this,!1),tooltip:(0,le.Z)("New Contact"),image:cn.md4.small}),cee(sl,{onClick:this.deleteSelected,disabled:this.state.contact.id===Aa.s,image:cn.M2k.small,tooltip:(0,le.Z)("other","Delete")})),cee(sl,{onClick:this.onCompose,tooltip:(0,le.Z)("Compose mail to contact"),disabled:this.state.contact.id===Aa.s,image:cn.XTV.small})))),(0,fn.jsx)(M8,{ref:this._tree,nodes:this.state.items,keyAccess:this.props.keyAccess,onCreate:this.onCreate,onEdit:this.onEdit,focusTree:this.focusTree,prefValues:this.props.prefValues,onItemSelected:this.onItemSelected}),cee("section",{className:"panel-contacts-edit outerScrollbar",style:{flexBasis:this.state.editorHeight}},void 0,cee(gu,{onSlidebarPosition:this.onSlidebarPosition,onStop:this.onSlideBarStop,onDoubleClick:this.onSlidebarToggle,returnOffset:!0,position:"bottom"}),this.state.editorHeight>0&&e?(0,fn.jsx)(J8,{ref:this._editor,contact:e,onEdit:this.onEdit},e.id):pee)]})}}const gee=(0,fs.Z)(uee,hee);var mee;function vee(e,t,n,i){mee||(mee="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:mee,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const fee=[{text:(0,le.Z)("Date"),value:"visitTime",fullScreenTitle:(0,le.Z)("Sort by Date")},{text:(0,le.Z)("Title"),value:"title",fullScreenTitle:(0,le.Z)("Sort by Title")},{text:(0,le.Z)("Address"),value:"address",fullScreenTitle:(0,le.Z)("Sort by Address")},{text:(0,le.Z)("Views"),value:"visitCount",fullScreenTitle:(0,le.Z)("Sort by Page Views")}];class yee extends tn.PureComponent{static contextType=dn.Z;hasLoadedData=!1;refSearch=tn.createRef();componentDidUpdate(e){!e.open&&this.props.open&&this.refSearch.current?.focusField(),this.props.open&&!this.hasLoadedData&&(this.hasLoadedData=!0,A.loadAll())}onSearch=e=>{const t=v.Z.getPanelResourceKey();A.saveStateFromSearchQuery(t,e),A.searchHistory(t,e)};onSearchDomain=e=>{e=aS(e);const{historyFilter:t}=this.props,n={...t,text:e,parsedFilter:tJ(e),searchURL:!0};this.onSearch(n)};onSortChange=(e,t)=>{const{historyFilter:n}=this.props,i={...n,sortOrder:e,sortField:t};this.onSearch(i)};render(){if(!this.props.open)return null;const e=this.props.historyItems,t=this.props.historyFilter;return vee("div",{className:"panel",id:"history-panel"},void 0,vee("header",{},void 0,vee(Rp,{title:this.props.title}),vee("div",{className:"toolbar toolbar-default toolbar-wrap"},void 0,(0,fn.jsx)(oJ,{ref:this.refSearch,showPicker:!0,search:this.onSearch,historyFilter:t,minDate:this.props.oldestHistoryDate}))),e.length>0&&vee(Iu,{fields:fee,onSortChange:this.onSortChange,keyAccess:this.props.keyAccess,sortField:t.sortField,sortOrder:t.sortOrder,fullsize:!1,manualSorting:!1}),e.length>0?vee("section",{className:"outerScrollbar"},void 0,vee(bJ,{fullView:!1,inManager:!1,nodes:e,historyFilter:t,onSearchDomain:this.onSearchDomain,sortField:t.sortField,sortOrder:t.sortOrder})):vee("section",{},void 0,vee("p",{},void 0,(0,le.Z)("No browsing history data for selected period."))))}}const wee=aJ(yee);function bee(e){const{unseen:t,unread:n,total:i}=e;return t>0?t===n&&n===i?(0,le.Z)("$1 new message","$1 new messages",[t]):t===n?(0,le.Z)("$1 new message of $2 messages","$1 new messages of $2 messages",[t,i]):(0,le.Z)("$1 new in $2 unread of $3 messages","$1 new in $2 unread of $3 messages",[t,n,i]):n>0?n===i?(0,le.Z)("$1 unread message","$1 unread messages",[n]):(0,le.Z)("$1 unread of $2 messages","$1 unread of $2 messages",[n,i]):(0,le.Z)("$1 message","$1 messages",[i])}var Cee;function See(e,t,n,i){Cee||(Cee="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Cee,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Tee=[D.kMailCountersPanelUnseenEnabled];class Iee extends tn.Component{_isMounted=!1;state={unseen:0,unread:0,total:0};componentDidMount(){this._isMounted=!0,this._updateCounters(),$g.C.addListener(this.onCountersChanged)}componentWillUnmount(){$g.C.removeListener(this.onCountersChanged)}_updateCounters=(e=this.props)=>{const{accountId:t,path:n}=e;if(this._isMounted){const e=$g.C.getCounters(t,n);this.setStateIfNeeded({unread:e&&e.unread||0,unseen:e&&e.unseen||0,total:e&&e.total||0})}};setStateIfNeeded=e=>{Object.getOwnPropertyNames(e).some((t=>e[t]!==this.state[t]))&&this.setState(e)};onCountersChanged=e=>{"counters"===e.target&&this._updateCounters()};render(){const e=this.state.unseen>0&&this.props.prefValues[D.kMailCountersPanelUnseenEnabled],{unseen:t,unread:i,total:s}=this.state,o=this.props.label+" "+bee({unseen:t,unread:i,total:s});return See("div",{className:"mail-panel-category-container"},void 0,See("label",{className:"mail-panel-category"+(this.props.hasChildren?"":" empty"),title:o},void 0,See("span",{onClick:this.props.onClick,className:"title"},void 0,this.props.label),!this.props.isExpanded&&See("div",{className:"counter-container"},void 0,e&&See("span",{className:"item-count counter-unseen"},void 0,this.state.unseen),this.state.unread>0&&See("span",{className:"item-count counter-unread"},void 0,this.state.unread)),this.props.hasChildren&&See("span",{className:"expand-icon display-hint",onMouseDown:Cs.Z,onMouseUp:()=>this.props.handleExpand(this.props.id),dangerouslySetInnerHTML:{__html:n(4103)}})))}}const kee=(0,fs.Z)(Iee,Tee),Aee={},Zee={};class Eee extends Us.Z{getAccountIndicator(e){let t,n=Object.keys(ue.NB).length;if(Aee[e]){const i=Object.keys(Aee[e]);for(const s of i)Aee[e][s].priority<n&&(n=Aee[e][s].priority,t=Aee[e][s])}if(Zee[e])for(const i in Zee[e])Zee[e][i].priority<n&&(n=Zee[e][i].priority,t=Zee[e][i]);return t}getPathIndicator(e,t){if(Zee[e]&&Zee[e][t])return Zee[e][t]}reset(){for(const e in Aee)delete Aee[e];for(const e in Zee)delete Zee[e]}dispatchAction(e){switch(e.actionType){case"MAIL_INDICATOR_ADD_ACCOUNT":{const{accountId:t,indicatorType:n,priority:i,current:s,total:o}=e;!function(e,t,n,i,s){Aee[e]||(Aee[e]={});Aee[e][t]={indicatorType:t,priority:n,current:i,total:s},_ee.emitChange()}(t,n,i,s,o);break}case"MAIL_INDICATOR_ADD_PATH":{const{accountId:t,path:n,indicatorType:i,priority:s,current:o,total:a}=e;!function(e,t,n,i,s,o){Zee[e]||(Zee[e]={});Zee[e][t]={indicatorType:n,priority:i,current:s,total:o},_ee.emitChange()}(t,n,i,s,o,a);break}case"MAIL_INDICATOR_REMOVE_ACCOUNT":{const{accountId:t,indicatorType:n}=e;!function(e,t){Aee[e]&&Aee[e][t]&&(delete Aee[e][t],_ee.emitChange())}(t,n);break}case"MAIL_INDICATOR_REMOVE_PATH":{const{accountId:t,path:n,indicatorType:i}=e;!function(e,t,n){Zee[e]&&Zee[e][t]&&(delete Zee[e][t],_ee.emitChange())}(t,n);break}case"MAIL_INDICATOR_REMOVE_ALL":t=e.accountId,delete Aee[t],delete Zee[t],_ee.emitChange()}var t}}const _ee=new Eee(l.Z),Nee=_ee;var Mee,Pee=n(34198);function Dee(e,t,n,i){Mee||(Mee="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Mee,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const xee=[D.kMailAccounts,D.kMailCountersPanelDraftsEnabled,D.kMailCountersPanelTrashEnabled,D.kMailCountersPanelUnseenEnabled,D.kMailPanelActivityIndicatorsEnabled];function Oee(e){const t=e.prefValues[D.kMailAccounts].find((t=>t.MAIL_EMAIL===e.accountId));return!!t&&t.offline}class Lee extends tn.Component{static contextType=dn.Z;_isMounted=!1;state=function(e){const t={unread:0,unseen:0,total:0},{isImap:n,path:i,accountId:s}=e;return n&&i===ue.ym&&(t.disconnected=im.isDisconnected(s)&&!Oee(e),t.isConnecting=im.isConnecting(s),im.hasError(s)&&(t.error=im.getErrorMessage(s))),t}(this.props);componentDidMount(){this._isMounted=!0,this._updateCounters(),$g.C.addListener(this.onCountersChanged),im.addListener(this.onConnectionChanged),Nee.addListener(this.onIndicatorsChanged)}componentWillUnmount(){this._isMounted=!1,$g.C.removeListener(this.onCountersChanged),im.removeListener(this.onConnectionChanged),Nee.removeListener(this.onIndicatorsChanged)}onCountersChanged=e=>{"counters"===e.target&&this._updateCounters()};onConnectionChanged=()=>{this.props.isImap&&this.setStateIfNeeded({disconnected:im.isDisconnected(this.props.name)&&!Oee(this.props),isConnecting:im.isConnecting(this.props.name),error:im.getErrorMessage(this.props.accountId)})};onIndicatorsChanged=()=>{const e=this.props.path===ue.ym?Nee.getAccountIndicator(this.props.accountId):Nee.getPathIndicator(this.props.accountId,this.props.path),t={indicator:""},n=this.props.isExpanded&&this.props.path===ue.ym;if(e&&!n){const{indicatorType:n,current:i,total:s}=e,o=this.getIndicatorText(n);t.indicator=s>0?`${o} ${i}/${s}`:o}this.setState(t)};_updateCounters=(e=this.props)=>{const{accountId:t,path:n}=e;if(this._isMounted){const e=$g.C.getCounters(t,n);this.setStateIfNeeded({unread:e&&e.unread||0,unseen:e&&e.unseen||0,total:e&&e.total||0})}};setStateIfNeeded=e=>{Object.getOwnPropertyNames(e).some((t=>e[t]!==this.state[t]))&&this.setState(e)};getIndicatorText=e=>{switch(e){case"INDICATOR_TYPE_FLAGS":return(0,le.Z)("Updating Flags");case"INDICATOR_TYPE_THREADING":return(0,le.Z)("Threading");case"INDICATOR_TYPE_FLUSHING":return(0,le.Z)("Flushing");case"INDICATOR_TYPE_CONNECTING":return(0,le.Z)("Connecting");case"INDICATOR_TYPE_FETCHING":return(0,le.Z)("Fetching");case"INDICATOR_TYPE_PRE_FETCHING":return(0,le.Z)("Prefetching");default:return""}};isDrafts=()=>this.props.path===ue.Wb||this.props.type===ue.kY;isOutbox=()=>this.props.path===ue.J8||this.props.type===ue.fZ;isTrash=()=>this.props.path===ue.cm||this.props.type===ue.uT;isUnread=()=>this.props.path===ue.tB;isSent=()=>this.props.path===ue.N1||this.props.type===ue.Nz;isJunk=()=>this.props.path===ue.rp||this.props.type===ue.Hd;isArchive=()=>this.props.path===ue.$T||this.props.type===ue.hn;isFeeds=()=>this.props.accountId===ue.u4;isLabels=()=>this.props.accountId===ue.ut;isFilters=()=>this.props.accountId===ue.Kz;isFlags=()=>this.props.accountId===ue.MN;isReceived=()=>this.props.path===ue.ik||this.props.type===ue.e9;isMailingList=()=>this.props.accountId===ue.wC&&Pee.Z.isMailingListPath(this.props.path);getImageSet=()=>this.props.isAccount?cn.GtN:this.isSent()?cn.zLp:this.isJunk()?cn.Qwh:this.isArchive()?cn._w1:this.isFeeds()?cn.ZU_:this.isUnread()?cn.aAJ:this.isReceived()?cn.LDV:this.isDrafts()?cn.XTV:this.isFilters()?cn.EnF:this.isLabels()?cn.rpm:this.isFlags()?cn.nyn:this.isMailingList()?cn.GAD:void 0;_onError=e=>{const t=im.getErrorMessage(this.props.name);t&&t.toLowerCase().indexOf("authentication")>=0?ie.Z.showMailAuthenticationDialog(this.context.vivaldiWindowId,{account:e}):ie.Z.showSettings(this.context.vivaldiWindowId,"mail")};_handleStatusIconClick=async()=>{if(this.state.disconnected&&!im.isConnecting(this.props.name)){const e=im.getErrorMessage(this.props.name)||"",t=await hm.Z.loadAccount(this.props.name);(0,Ct.c)({title:(0,le.Z)("Error connecting to $1",[this.props.name]),body:e,onClick:this._onError.bind(this,t)})}};render(){const e=this.props.prefValues[D.kMailPanelActivityIndicatorsEnabled]&&this.state.indicator,t=this.state.unread>0&&!(this.isDrafts()||this.isOutbox()||this.isTrash()),n=t&&this.state.unseen>0&&this.props.prefValues[D.kMailCountersPanelUnseenEnabled],i=this.state.total>0&&this.isOutbox(),s=this.state.total>0&&this.props.prefValues[D.kMailCountersPanelTrashEnabled]&&this.isTrash(),o=this.state.total>0&&this.props.prefValues[D.kMailCountersPanelDraftsEnabled]&&this.isDrafts();let a;if(this.state.error)a=this.state.error;else if(this.props.accountId===ue.Kz)a="";else{const{unseen:e,unread:t,total:n}=this.state;a=(this.isLabels()?(0,rZ.X)(this.props.name):(0,gm.e)(this.props.name))+"\n"+bee({unseen:e,unread:t,total:n})}let r=0,l=0;return r=this.props.level*$u,l=this.props.hasChildren?0:this.props.level>1?r+$u:r,Dee("label",{className:mn()("mail_panel_node",{disabled:this.props.subscribable}),title:a,onClick:this.props.onClick},void 0,this.props.hasChildren&&0!==this.props.level&&Dee("span",{className:"expand-icon",style:{marginLeft:r},onMouseDown:Cs.Z,onMouseUp:()=>this.props.handleExpandClick(this.props.id),dangerouslySetInnerHTML:{__html:cn.nfH}}),Dee(Wi,{imageSet:this.getImageSet(),open:this.props.isExpanded,trash:this.isTrash(),disconnected:this.state.disconnected,isConnecting:this.state.isConnecting,leftMargin:l,onClickStatusIcon:this._handleStatusIconClick}),void 0!==this.props.inlineEditText&&Dee("input",{type:"text",value:this.props.inlineEditText,onChange:this.props.onChange,onFocus:this.props.onFocus,onBlur:this.props.onBlur,autoFocus:!0}),void 0===this.props.inlineEditText&&Dee(tn.Fragment,{},void 0,Dee("span",{className:"title"},void 0,this.isLabels()?(0,rZ.X)(this.props.name):(0,gm.e)(this.props.name)),e&&Dee("span",{className:"item-count counter-indicator"},void 0,this.state.indicator),n&&Dee("span",{className:"item-count counter-unseen"},void 0,this.state.unseen),t&&Dee("span",{className:"item-count counter-unread"},void 0,this.state.unread),(i||s||o)&&Dee("span",{className:"item-count counter-total"},void 0,this.state.total)))}}const Ree=(0,fs.Z)(Lee,xee);var Bee;function Fee(e,t,n,i){Bee||(Bee="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Bee,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Uee extends tn.Component{onHide=()=>{"Mail"===this.props.component&&nt.Z.set(D.kMailPanelShowErrorMessages,!1)};onClear=()=>{if(this.props.logEntries.length>0){const e=this.props.logEntries[this.props.logEntries.length-1];this.props.setEarliestErrorTimestamp(e.timestamp)}};render(){return Fee("header",{},void 0,Fee("div",{onClick:this.onClear},void 0,Fee(vc,{logs:this.props.logEntries,component:this.props.component,hideButtons:!0})),Fee("div",{className:"toolbar toolbar-default"},void 0,Fee("input",{type:"button",value:(0,le.Z)("mail","Hide"),title:(0,le.Z)("Hide error log. It can be seen in Mail Status, or enabled again in settings."),onClick:this.onHide}),Fee("input",{type:"button",value:(0,le.Z)("Show More"),title:(0,le.Z)("Show full log."),onClick:()=>Yc.open("Mail","logs")})))}}const Vee=Uee;var Wee=n(74652),Hee=n(30628),zee=n(95064);const Gee={name:(0,le.Z)("All Messages"),accountId:ue.of,id:ue.w1,children:[]},$ee={name:(0,le.Z)("Custom Folders"),accountId:ue.Ry,path:ue.ym,id:ue.Ry,children:[]},Kee={name:(0,le.Z)("Mailing Lists"),accountId:ue.wC,path:ue.ym,id:ue.jT,children:[]},jee={name:(0,le.Z)("Filters"),accountId:ue.Kz,id:ue.rQ,children:[]},Yee={name:(0,le.Z)("Flags"),accountId:ue.MN,id:ue.q0,children:[]},Xee={name:(0,le.Z)("Labels"),accountId:ue.ut,id:ue.pz,children:[]},Qee={name:(0,le.Z)("Feeds"),accountId:ue.u4,id:ue.sM,children:[]};var qee,Jee=n(34155);function ete(e,t,n,i){qee||(qee="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:qee,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const tte=[ue.W4,ue.cs],nte=[ue.T4.RED,ue.T4.ORANGE,ue.T4.YELLOW,ue.T4.GREEN,ue.T4.BLUE,ue.T4.PURPLE,ue.T4.GRAY];let ite=0;var ste=ete("hr",{}),ote=ete(Oi,{url:cn.HHg,loadType:"faviconFromCache"}),ate=ete("svg",{width:"46",height:"46",viewBox:"0 0 64 64",fill:"none"},void 0,ete("path",{d:"M32 64C46.0229 64 53.819 64 58.9095 58.9084C64 53.8169 64 46.0215 64 32C64 17.9785 64 10.1831 58.9095 5.09155C53.819 0 46.0229 0 32 0C17.9771 0 10.1811 0 5.09053 5.09155C0 10.1831 0 17.9785 0 32C0 46.0215 0 53.8169 5.09053 58.9084C10.1811 64 17.9771 64 32 64Z",fill:"#EF3939"}),ete("mask",{id:"mask0","mask-type":"alpha",maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"64",height:"64"},void 0,ete("path",{d:"M32 64C46.0229 64 53.819 64 58.9095 58.9084C64 53.8169 64 46.0215 64 32C64 17.9785 64 10.1831 58.9095 5.09155C53.819 0 46.0229 0 32 0C17.9771 0 10.1811 0 5.09053 5.09155C0 10.1831 0 17.9785 0 32C0 46.0215 0 53.8169 5.09053 58.9084C10.1811 64 17.9771 64 32 64Z",fill:"#EF3939"})),ete("g",{mask:"url(#mask0)"},void 0,ete("path",{opacity:"0.07",d:"M64.2106 35.5986L54.6357 18.9106L8.91235 20.8603V43.3958L20.2457 64.0705C23.6597 64.2711 27.4055 64.3175 32.1053 64.3175C45.9221 64.3175 54.8791 64.6144 59.8948 59.5898C64.6168 54.8605 64.194 47.9484 64.2106 35.5986Z",fill:"#000"})),ete("path",{d:"M31.712 33.7227L55.0447 20.2478C54.8304 18.6236 53.4456 17.3584 51.7751 17.3584H12.2095C10.3961 17.3584 8.91235 18.8501 8.91235 20.6732V20.6898L31.712 33.7227Z",fill:"#fff"}),ete("path",{d:"M31.723 36.905L8.91235 23.8666V43.3247C8.91235 45.1479 10.3961 46.6396 12.2095 46.6396H51.7751C53.5885 46.6396 55.0722 45.1479 55.0722 43.3247V23.4191L31.723 36.905Z",fill:"#fff"})),rte=ete("hr",{});class lte extends tn.PureComponent{refTreeList=tn.createRef();static contextType=dn.Z;winId=this.context.vivaldiWindowId;initialState=()=>{const e=!wa.Z.hasLoadedFolders()&&(M.Z.get(D.kMailAccounts).length>0||M.Z.get(D.kRssSettings).length>0);return{waiting:e,mailFolders:wa.Z.getAccounts(),mailingLists:$g.C.getByAccountId(ue.wC),filters:$g.C.getByAccountId(ue.Kz),flags:$g.C.getByAccountId(ue.MN),labels:$g.C.getByAccountId(ue.ut),feeds:$g.C.getByAccountId(ue.u4),allMsgs:$g.C.getByAccountId(ue.of),customFolderMsgs:$g.C.getByAccountId(ue.Ry),online:navigator.onLine,showHiddenMailingLists:!1,indexProgress:e?0:-1,showErrors:M.Z.get(D.kMailPanelShowErrorMessages),order:M.Z.get(D.kMailPanelItemsOrder),showAccounts:M.Z.get(D.kMailPanelItemsShowAccounts),showAllMessages:M.Z.get(D.kMailPanelItemsShowAllMessages),showCustomFolders:M.Z.get(D.kMailPanelItemsShowCustomFolders),showFeeds:M.Z.get(D.kMailPanelItemsShowFeeds),showFilters:M.Z.get(D.kMailPanelItemsShowFilters),showFlags:M.Z.get(D.kMailPanelItemsShowFlags),showLabels:M.Z.get(D.kMailPanelItemsShowLabels),showMailingLists:M.Z.get(D.kMailPanelItemsShowMailingLists),showUnsubscribed:M.Z.get(D.kMailShowUnsubscribed),isCheckingMail:!1}};state=this.initialState();componentDidMount(){wa.Z.addListener(this.gotFolders),$g.C.addListener(this._onFiltersChanged),im.addListener(this.onImapStoreChange),Dl.ZP.addListener(this.onPanelStoreChange),Pl.Z.addListener(this.onFolderSelection),M.Z.addListener([D.kMailIsTurnedOff],this._onTurningMailOnOrOff),this.context.addEventListener("online",this._onOnline),this.context.addEventListener("offline",this._onOffline),"mail"===this.props.panelId&&(M.Z.addListener([D.kMailShowUnsubscribed],te.Z.reconnectIMAPClients),M.Z.addListener([D.kMailPanelItemsOrder,D.kMailPanelItemsShowAccounts,D.kMailPanelItemsShowAllMessages,D.kMailPanelItemsShowCustomFolders,D.kMailPanelItemsShowFeeds,D.kMailPanelItemsShowFilters,D.kMailPanelItemsShowFlags,D.kMailPanelItemsShowLabels,D.kMailPanelItemsShowMailingLists,D.kMailShowUnsubscribed],this.onMailPanelSettingsChanged)),M.Z.addListener([D.kMailPanelShowErrorMessages],this.onShowErrorsChanged),rc.addListener(this.logsUpdated),this.logsUpdated()}componentDidUpdate(e,t){!e.open&&this.props.open&&Jee.nextTick((()=>{this.refTreeList.current?.focusTree()}))}componentWillUnmount(){this.context.removeEventListener("online",this._onOnline),this.context.removeEventListener("offline",this._onOffline),wa.Z.removeListener(this.gotFolders),$g.C.removeListener(this._onFiltersChanged),im.removeListener(this.onImapStoreChange),Dl.ZP.removeListener(this.onPanelStoreChange),Pl.Z.removeListener(this.onFolderSelection),M.Z.removeListener([D.kMailIsTurnedOff],this._onTurningMailOnOrOff),M.Z.removeListener([D.kMailPanelShowErrorMessages],this.onShowErrorsChanged),"mail"===this.props.panelId&&(M.Z.removeListener([D.kMailShowUnsubscribed],te.Z.reconnectIMAPClients),M.Z.removeListener([D.kMailPanelItemsOrder,D.kMailPanelItemsShowAccounts,D.kMailPanelItemsShowAllMessages,D.kMailPanelItemsShowCustomFolders,D.kMailPanelItemsShowFeeds,D.kMailPanelItemsShowFilters,D.kMailPanelItemsShowFlags,D.kMailPanelItemsShowLabels,D.kMailPanelItemsShowMailingLists,D.kMailShowUnsubscribed],this.onMailPanelSettingsChanged)),rc.removeListener(this.logsUpdated)}getFailingAccountError=()=>{const e=Object.keys(this.state.mailFolders).filter((e=>im.isDisconnected(e)));if(0===e.length)return;const t=rc.getLogsByComponent("Mail").filter((t=>"error"===t.level&&t.tags.some((t=>e.includes(t)))));if(0===t.length)return;const n=t[t.length-1];return n.timestamp>ite?n:void 0};logsUpdated=()=>{this.setState({accountError:this.getFailingAccountError()})};onItemsActivated=(e,t)=>{this.openTabForMailbox(t[0])};activateAfterDelete=e=>{this.openTabForMailbox(e)};onImapStoreChange=()=>{navigator.onLine?this._onOnline():this._onOffline()};onFolderSelection=()=>{Jee.nextTick((()=>{const e=Pl.Z.getSelectedFolder();e&&this.refTreeList.current?.selectByNode(e)}))};_onTurningMailOnOrOff=()=>{this.setState(this.initialState())};_onOnline=()=>{this.setState({online:!0,accountError:this.getFailingAccountError()})};_onOffline=()=>{this.setState({online:!1})};_onFiltersChanged=e=>{if("mailingLists"===e.target)this.setState({mailingLists:$g.C.getByAccountId(ue.wC)});else if("filters"===e.target){let t;const{filterIds:n}=e;if(n){const e=$g.C.getByIds(n),i=[ue.Kz,ue.MN,ue.ut,ue.u4,ue.of,ue.Ry,ue.wC];t=n.length>e.length||e.some((e=>i.includes(e.accountId)))}else t=!0;t&&this.setState({filters:$g.C.getByAccountId(ue.Kz),flags:$g.C.getByAccountId(ue.MN),labels:$g.C.getByAccountId(ue.ut),feeds:$g.C.getByAccountId(ue.u4),allMsgs:$g.C.getByAccountId(ue.of),customFolderMsgs:$g.C.getByAccountId(ue.Ry),mailingLists:$g.C.getByAccountId(ue.wC)})}else if("updateIndexProgress"===e.target){const t=Math.floor(e.indexCount/e.total*100)||0;this.setState({indexProgress:t})}else"finishIndexProgress"===e.target&&this.setState({indexProgress:-1})};onPanelStoreChange=(e,t)=>{const n=this.refTreeList.current?.getWrapper();e===this.winId&&this.props.open&&"setFocus"===t&&n instanceof this.context.HTMLElement&&!ss(n)&&this.refTreeList.current?.focusTree()};gotFolders=()=>{this.setState({waiting:!1,mailFolders:wa.Z.getAccounts()})};getAllAccountMailboxes=e=>{const t=[];let n;switch(e.path){case ue.N1:n=ue.Nz;break;case ue.rp:n=ue.Hd;break;case ue.cm:n=ue.uT;break;case ue.$T:n=ue.hn}if(n){const e=wa.Z.getAccounts();for(const i in e){e[i].folders[n]?.forEach((({type:e,path:s,subscribed:o})=>{e===n&&t.push({accountId:i,path:s,subscribed:o})}))}}return t};openTabForMailbox=e=>{this.hasContentForMessageView(e)&&Jee.nextTick((()=>{(e.accountId===ue.of?this.getAllAccountMailboxes(e):[e]).forEach((({accountId:e,path:t,subscribed:n})=>{(0,Km.mq)(e)&&n?te.Z.checkNewDeletedModified(e,t):(0,Km.Vd)(e)&&ae.checkForMail(e)})),Y.Z.openURL(this.context.vivaldiWindowId,St.jk.internals.mailpage,{singleton:!0}),j.Z.selectFolder(e)}))};handleMailboxClick=(0,Zr.Z)((e=>{if(e.accountId===ue.Ry&&e.path!==ue.ym){const t=e.path.indexOf("/"),n=e.path.substring(0,t),i=e.path.substring(t+1);this.openTabForMailbox({...e,accountId:n,path:i})}else this.openTabForMailbox(e)}),200,{leading:!0,trailing:!1});handleExpandClick=e=>{this.refTreeList.current?.toggleSelectedExpansion(e)};rowComponent=e=>{const t=e.node;return 0===t.level?ete(kee,{id:t.id,name:t.name,label:t.name,handleExpand:this.handleExpandClick,hasChildren:this.hasChildren(t),onClick:this.handleMailboxClick.bind(this,t),isExpanded:t.isExpanded,accountId:t.accountId,path:t.path},t.id):ete(Ree,{name:t.name,accountId:t.accountId,id:t.id,type:t.type,path:t.path,isAccount:tE.Z.isAccountRootFolder(t),isImap:(0,Km.ZA)(t.accountId),level:t.level,onClick:this.handleMailboxClick.bind(this,t),isExpanded:t.isExpanded,onChange:e.onChange,onFocus:e.onFocus,onBlur:e.onBlur,inlineEditText:e.inlineEditText,handleExpandClick:this.handleExpandClick,hasChildren:this.hasChildren(t),subscribable:tE.Z.isSubscribable(t)&&!t.subscribed},t.id)};isFolder=e=>!0;getMailFolders=()=>{const e=[];for(const t of M.Z.get(D.kMailPanelItemsOrder)){const n=TR.get(t);n&&e.push({handler:this.toggleShow.bind(this,n.showPref),type:"checkbox",checked:M.Z.get(n.showPref),label:n.name,labelEnglish:n.name})}return e};toggleShow=e=>{nt.Z.toggle(e,!0,!1)};hasChildren=e=>Boolean(e.children&&e.children.length>0);hasContentForMessageView=e=>!0;openMailSettings=()=>{ie.Z.showMailAccountDialog(this.context.vivaldiWindowId)};sendAllOutgoing=()=>{he.Z.sendAll(this.context.vivaldiWindowId)};sendForAccount=e=>{he.Z.sendForAccount(this.context.vivaldiWindowId,e)};rescanUnreadFlags=(e,t)=>{te.Z.rescanUnreadFlags(e,t)};showAddFolderDialog=e=>{ie.Z.showAddMailFolder(this.context.vivaldiWindowId,{accountId:e})};showDeleteFolderDialog=(e,t)=>{ie.Z.showDeleteMailFolder(this.context.vivaldiWindowId,{accountId:e,path:t})};getMenuCapability=async(e,t,n)=>{const i=this.winId;switch(e.action){case"CONTEXT_VIEW_ALL_MESSAGES":return{handler:()=>this.openTabForMailbox(n),visible:Boolean(n),...t(i,e,{})};case"CONTEXT_RERUN_FILTER":return{handler:()=>j.Z.rerunFilter(n.accountId,n.path||ue.ym),visible:Boolean(n),...t(i,e,{})};case"CONTEXT_MARK_ALL_AS_READ":{const s=n?ba.Z.getFolderType(n.accountId,n.path):"";return{handler:()=>j.Z.markAllRead(n.accountId,n.path),visible:Boolean(n)&&s!==ue.Nz&&s!==ue.kY&&s!==ue.hn&&s!==ue.fZ,...t(i,e,{})}}case"CONTEXT_MOVE_ALL_TO_TRASH":{const s=n?ba.Z.getFolderType(n.accountId,n.path):"";return{handler:()=>j.Z.moveAllToTrash(i,n.accountId,n.path,!0),visible:Boolean(n)&&(s===ue.Hd||s===ue.kY||s===ue.fZ),...t(i,e,{})}}case"CONTEXT_EMPTY_TRASH":{const s=n?ba.Z.getFolderType(n.accountId,n.path):"";return{handler:()=>j.Z.deleteEntriesFromFolder(i,n.accountId,n.path),visible:Boolean(n)&&s===ue.uT,...t(i,e,{})}}case"CONTEXT_CHECK_FOR_MAIL":return{handler:()=>this.checkAccountForMail(n.accountId),visible:Boolean(n)&&tE.Z.isAccountRootFolder(n)&&!(0,Km.S9)(n.accountId),...t(i,e,{})};case"CONTEXT_CREATE_FOLDER":return{handler:()=>this.showAddFolderDialog(n.accountId),visible:Boolean(n)&&(0,Km.ZA)(n.accountId)&&tE.Z.isAccountRootFolder(n)&&!(0,Km.S9)(n.accountId),...t(i,e,{})};case"CONTEXT_DELETE_FOLDER":return{handler:()=>this.showDeleteFolderDialog(n.accountId,n.path),visible:Boolean(n)&&(0,Km.ZA)(n.accountId)&&tE.Z.isAccountSubFolder(n)&&"inbox"!==n.path.toLowerCase()&&!(0,Km.S9)(n.accountId),...t(i,e,{})};case"CONTEXT_TOGGLE_MAIL_VIEWS":return{visible:Boolean(n)&&"mail"===this.props.panelId,...t(i,e,{})};case"CONTEXT_MAIL_FOLDER":return{items:this.getMailFolders(),...t(i,e,{})};case"CONTEXT_SEND":return{handler:()=>this.sendForAccount(n.accountId),visible:Boolean(n)&&tE.Z.isAccountRootFolder(n),...t(i,e,{})};case"CONTEXT_RESCAN_UNREAD":return{handler:()=>this.rescanUnreadFlags(n.accountId,n.path),visible:Boolean(n)&&tE.Z.isAccountSubFolder(n)&&(0,Km.ZA)(n.accountId)&&!(0,Km.S9)(n.accountId),...t(i,e,{})};case"CONTEXT_SUBSCRIBE":return{handler:()=>j.Z.subscribeMailbox(i,n),visible:Boolean(n)&&tE.Z.isSubscribable(n)&&!n.subscribed,...t(i,e,{})};case"CONTEXT_UNSUBSCRIBE":return{handler:()=>ie.Z.showMailUnsubscribeDialog(i,{folder:n}),visible:Boolean(n)&&tE.Z.isSubscribable(n)&&n.subscribed,...t(i,e,{})};case"CONTEXT_RERUN_THREADING":return{handler:()=>ee.Z.rerunThreading(n.accountId,n.path),visible:Boolean(n)&&tE.Z.isAccountSubFolder(n),...t(i,e,{})};case"CONTEXT_MOVE_INTO_IMPORTANT":{const s=Boolean(n)&&n.accountId===ue.wC&&n.path!==ue.ym?$g.C.getByFolder(n.accountId,n.path):null,o=s&&s.path!==ue.cs&&s.path!==ue.W4&&s.path.startsWith(ue.cs);return{handler:()=>j.Z.toggleMoveToOther(n),visible:Boolean(o),...t(i,e,{})}}case"CONTEXT_MOVE_INTO_OTHER":{const s=Boolean(n)&&n.accountId===ue.wC&&n.path!==ue.ym?$g.C.getByFolder(n.accountId,n.path):null,o=s&&s.path!==ue.cs&&s.path!==ue.W4&&s.path.startsWith(ue.W4);return{handler:()=>j.Z.toggleMoveToOther(n),visible:Boolean(o),...t(i,e,{})}}case"CONTEXT_DELETE_ALL":return{handler:At.removeAllFeeds,visible:Boolean(n)&&n.id===ue.sM&&n.children&&this.hasChildren(n),...t(i,e,{})};case"CONTEXT_CREATE_LABEL":return{handler:()=>ie.Z.showAddCustomLabel(i),visible:Boolean(n)&&n.accountId===ue.ut,...t(i,e,{})};case"CONTEXT_ADD_NEW_ACCOUNT":return{handler:()=>ie.Z.showMailAccountDialog(i),visible:Boolean(n)&&n.accountId===ue.Sp,...t(i,e,{})};case"CONTEXT_REGENERATE":return{handler:j.Z.regenerateAllMailingLists,visible:Boolean(n)&&n.accountId===ue.wC&&n.path===ue.ym,...t(i,e,{})};case"CONTEXT_ADVANCED":return{visible:Boolean(n),...t(i,e,{})};default:return{...t(i,e,{})}}};getMenuVisibility=(e,t)=>{if(!t)return!1;switch(e.action){case"CONTEXT_RENAME":return this.isValidToEdit(t.id);case"CONTEXT_DELETE":return 1===this.validateForDeletion([t.id]).length;default:return!1}};confirmDelete=e=>{if(1!==e.length)return Promise.resolve(!1);const t=this.refTreeList.current?.findTreeItem(e[0]);return t?t.accountId===ue.ut?new Promise((e=>{ie.Z.showDeleteCustomLabelConfirmation(this.context.vivaldiWindowId,t.name,e)})):Promise.resolve(!0):Promise.resolve(!1)};validateForDeletion=e=>{if(e.length>1)return[];const t=[];return e.forEach((e=>{const n=this.refTreeList.current?.findTreeItem(e);if(n){let i=!1;switch(n.accountId){case ue.Kz:case ue.ut:i=void 0!==n.path&&Boolean($g.C.getByFolder(n.accountId,n.path));break;case ue.wC:i=n.path!==ue.ym&&(!n.children||0===n.children.length);break;case ue.u4:i=n.id!==ue.sM}i&&t.push(e)}})),t};deleteNodes=e=>Promise.all(this.validateForDeletion(e).map((e=>{const t=this.refTreeList.current?.findTreeItem(e);if(t)switch(t.accountId){case ue.ut:(0,rZ.z)(t.accountId,t.path);break;case ue.Kz:case ue.wC:{const e=$g.C.getByFolder(t.accountId,t.path);if(e)return t.accountId===ue.wC?j.Z.removeMailingListFilter(this.context.vivaldiWindowId,e):j.Z.removeFilter(e.id);console.warn("No filter",t.accountId,t.path);break}case ue.u4:return At.removeFeed(t.path);default:console.warn("Unknown account",t.accountId)}else console.warn("No match",e);return Promise.resolve()}))).then((()=>Promise.resolve()));onContextMenu=e=>{e.nativeEvent.buttons>0&&this.refTreeList.current?.unSelectAll(),this.refTreeList.current?.onContextMenu(e)};_getNodes=(e,t)=>{const n=[],i={};for(let s=0;s<e.length;s++){const o=e[s],a=o.accountId===ue.MN?nR.ZP.translateFlag(o.path):o.accountId===ue.ut?(0,rZ.X)(o.path):o.name;gte(o.accountId,o.path,"",n,i,t,a)}return n};_getAllMsgsNodes=()=>0===this.state.allMsgs.length?[]:this.state.allMsgs.map((e=>({name:(0,gm.W)(e.path),path:e.path,accountId:ue.of,id:ue.w1+"_"+e.path,children:[]})));_getCustomFoldersNodes=e=>{const t=[],n=wa.Z.getAccounts(),i=new Set,s=new Set;for(const o in n){const a=tE.Z.getFoldersFlat({folders:n[o].folders},e);for(const e of a)if(e.type===ue.Oi){i.has(e.name)?s.add(e.name):i.add(e.name);const n=o+"/"+e.path;t.push({...e,id:ue.Ry+"_"+n,accountId:ue.Ry,path:n})}}return t.forEach((e=>{if(s.has(e.name)){const t=e.path.substring(0,e.path.indexOf("/"));e.name=e.name+" ("+t+")"}})),t};getRowHeight=({index:e},t)=>t.find((t=>t.id===this.refTreeList.current?.getAllIds()[e]))?30:24;menu={name:"mailpanellist",getCapability:this.getMenuCapability,getVisibility:this.getMenuVisibility};getMailTree=()=>{const e=[];for(const t of this.state.order)switch(t){case"ALL_MESSAGES":this.state.showAllMessages&&(Gee.children=this._getAllMsgsNodes().sort(pte),e.push(Gee));break;case"CUSTOM_FOLDERS":if(this.state.showCustomFolders){const t=!this.state.showUnsubscribed;$ee.children=this._getCustomFoldersNodes(t),e.push($ee)}break;case"MAILING_LISTS":if(this.state.showMailingLists){const t=this._getNodes(this.state.mailingLists,ue.jT),n=t.find((e=>e.path===ue.cs));n&&(n.name=(0,le.Z)("Mailing Lists","Other"));const i=t.find((e=>e.path===ue.W4));i&&(i.name=(0,le.Z)("Mailing Lists","Important")),Kee.children=t.sort(cte),e.push(Kee)}break;case"FILTERS":this.state.showFilters&&(jee.children=this._getNodes(this.state.filters,ue.rQ),e.push(jee));break;case"FLAGS":this.state.showFlags&&(Yee.children=this._getNodes(this.state.flags,ue.q0).sort(hte),e.push(Yee));break;case"LABELS":this.state.showLabels&&(Xee.children=this._getNodes(this.state.labels,ue.pz).sort(ev.jp),e.push(Xee));break;case"FEEDS":this.state.showFeeds&&(Qee.children=this._getNodes(this.state.feeds,ue.sM),e.push(Qee));break;case"ACCOUNTS":if(this.state.showAccounts){const t=[],n=tE.Z.getFolders(this.state.mailFolders,this.state.showUnsubscribed);for(const e of n)e.accountId!==ue.u4&&t.push(e);t.sort(dte),e.push({name:(0,le.Z)("All Accounts"),path:ue.ym,accountId:ue.Sp,id:ue.w1+"_"+ue.Sp,children:t})}break;default:throw Error("Invalid mail panel item key: "+t)}return e};getFeedsTree=()=>(Qee.children=this._getNodes(this.state.feeds,ue.sM),[Qee]);renderMailTree=()=>{const e="feeds"===this.props.panelId,t=e?this.getFeedsTree():this.getMailTree(),n=e?"FEEDS_PANEL":"MAIL_PANEL";return(0,fn.jsx)(Yu,{ref:this.refTreeList,rowComponent:this.rowComponent,nodes:t,menu:this.menu,onItemsActivated:this.onItemsActivated,isFolder:this.isFolder,canDoubleClick:this.hasContentForMessageView,hasChildren:this.hasChildren,settings:n,enableDragAndDrop:!1,multiSelect:!1,supportsInlineEdit:!0,supportsCollapseAll:!1,isValidToEdit:this.isValidToEdit,validateForDeletion:this.validateForDeletion,confirmDelete:this.confirmDelete,activateAfterDelete:this.activateAfterDelete,delete:this.deleteNodes,saveTitle:this.saveTitle,getTitle:this.getTitle,rowHeight:e=>this.getRowHeight(e,t),folderMode:"expand"})};findAccountIndex=(e,t)=>e.findIndex((e=>e.path===t.substring(`${ue.sM}_`.length)));getTitle=e=>{let t="",n="";if(e.startsWith(ue.jT))t=ue.wC,n=ue.jT;else if(e.startsWith(ue.rQ))t=ue.Kz,n=ue.rQ;else{const t=M.Z.get(D.kRssSettings);if(e){return t[this.findAccountIndex(t,e)].title||""}}const i=e.replace(n+"_",""),s=$g.C.getByFolder(t,i);return s?s.name:""};isValidToEdit=e=>!(!e.startsWith(ue.sM)||e===ue.sM)||(e.startsWith(ue.jT)&&e.split("/").length>1||e.startsWith(ue.rQ));saveTitle=(e,t)=>{if(e){const n=M.Z.get(D.kRssSettings),i=n.find((t=>t.path===e.substring(`${ue.sM}_`.length)));if(i&&i.title!==t){const s={...i,title:t},o=this.findAccountIndex(n,e);return void At.edit(s,o)}}let n,i="";if(e.startsWith(ue.jT))i=ue.wC,n=ue.jT;else{if(!e.startsWith(ue.rQ))return;i=ue.Kz,n=ue.rQ}const s=e.replace(n+"_",""),o=$g.C.getByFolder(i,s);o&&t&&(o.name=t,tt.Z.put(o).then((e=>{it.Z.updateFilters(e)})))};_getPendingMenu=()=>{const e=[];return Hee.Z.m3GetAll().then((t=>{const n={};t.forEach((e=>{if(e.from){const t=e.from[0].address;n[t]||(n[t]=[]),n[t].push(e)}}));for(const t in n){const i=n[t].length;i>0&&e.push({handler:this.sendForAccount.bind(null,t),...(0,Mn.Z)("Send from $1 ($2)",[t,i])})}return e}))};_getFetchMenuItems=()=>{const e=[],t=Object.keys(this.state.mailFolders);for(const n of t)e.push({handler:this.checkAccountForMail.bind(null,n),...(0,Mn.Z)("Check $1",[n])});return e};checkAccountForMail=e=>{(0,Km.mq)(e)?te.Z.checkForMail(e):(0,Km.Vd)(e)&&ae.checkForMail(e)};checkForMail=async()=>{this.setState({isCheckingMail:!0}),await Promise.all([te.Z.checkForMail(),ae.checkForMail(),new Promise((e=>setTimeout(e,1e3)))]),this.setState({isCheckingMail:!1})};checkForFeeds=()=>{At.updateAllFeeds(this.context.vivaldiWindowId)};showAddFeedDialog=()=>{ie.Z.showAddFeed(this.context.vivaldiWindowId,[{url:"",path:d.Z.utilities.generateGUID(),title:"",refreshInterval:0}])};onShowErrorsChanged=()=>{this.setState({showErrors:M.Z.get(D.kMailPanelShowErrorMessages)})};onMailPanelSettingsChanged=()=>{this.setState({order:M.Z.get(D.kMailPanelItemsOrder),showAccounts:M.Z.get(D.kMailPanelItemsShowAccounts),showAllMessages:M.Z.get(D.kMailPanelItemsShowAllMessages),showCustomFolders:M.Z.get(D.kMailPanelItemsShowCustomFolders),showFeeds:M.Z.get(D.kMailPanelItemsShowFeeds),showFilters:M.Z.get(D.kMailPanelItemsShowFilters),showFlags:M.Z.get(D.kMailPanelItemsShowFlags),showLabels:M.Z.get(D.kMailPanelItemsShowLabels),showMailingLists:M.Z.get(D.kMailPanelItemsShowMailingLists),showUnsubscribed:M.Z.get(D.kMailShowUnsubscribed)})};setEarliestErrorTimestamp=e=>{ite=e,this.setState((e=>({accountError:this.getFailingAccountError()})))};render(){if(!this.props.open)return null;const e="feeds"===this.props.panelId,t=this.state.feeds.length;if(e)return ete("div",{className:"panel",id:"mail_panel"},void 0,ete("header",{},void 0,ete(Rp,{title:this.state.online?this.props.title:(0,le.Z)("$1 – Offline",[this.props.title])}),ete("div",{className:"toolbar toolbar-default"},void 0,ete("div",{className:"toolbar toolbar-group"},void 0,ete(sl,{tooltip:(0,le.Z)("Check all feeds"),onClick:this.checkForFeeds,image:cn.GO5.small}),ste,ete(sl,{tooltip:(0,le.Z)("Add a feed"),onClick:this.showAddFeedDialog,image:cn.md4.small})))),0===t?ete("div",{className:"mail-onboarding"},void 0,ote,ete("h1",{},void 0,(0,le.Z)("Add your first feed")),ete("p",{},void 0,(0,le.Z)("Use the “+” toolbar icon to add a new feed."))):ete("section",{onContextMenu:this.onContextMenu},void 0,this.renderMailTree()));{const e=Object.keys(this.state.mailFolders).length;return 0!==e||this.state.showFeeds&&0!==t||-1!==this.state.indexProgress||this.state.waiting?ete("div",{className:"panel",id:"mail_panel"},void 0,ete("header",{},void 0,ete(Rp,{title:this.state.online?this.props.title:(0,le.Z)("$1 – Offline",[this.props.title])}),ete("div",{className:"toolbar toolbar-default"},void 0,ete("div",{className:"toolbar toolbar-group"},void 0,ete(sl,{className:this.state.isCheckingMail?"btn-toolbar-spinner":"",disabled:this.state.isCheckingMail,tooltip:(0,le.Z)("Check all accounts"),onClick:this.checkForMail,isMenuIndicatorVisible:e>1,image:cn.GO5.small,menu:this._getFetchMenuItems,menuOrigin:"bottomLeft"}),rte,ete(sl,{tooltip:(0,le.Z)("Send from all accounts"),onClick:this.sendAllOutgoing,disabled:this.state.waiting,isMenuIndicatorVisible:e>1,image:cn.zLp.small,menu:this._getPendingMenu,menuOrigin:"bottomLeft"})),ete(sl,{title:(0,le.Z)("Compose"),tooltip:(0,le.Z)("Compose new mail")+" "+U.Z.getShortcut("COMMAND_MAIL_COMPOSE_NEW_MESSAGE"),onClick:ne.Z.createDraft.bind(null,void 0),image:cn.XTV.small,className:"button-mail-compose"}))),this.state.showErrors&&!!this.state.accountError&&ete(Vee,{logEntries:[this.state.accountError],component:"Mail",setEarliestErrorTimestamp:this.setEarliestErrorTimestamp}),ete("section",{className:"outerScrollbar",onContextMenu:this.onContextMenu},void 0,this.state.indexProgress>-1?ete("span",{className:"mail-loading"},void 0,ete("progress",{max:"100",value:this.state.indexProgress})):this.renderMailTree())):ete("div",{className:"panel",id:"mail_panel"},void 0,ete("div",{className:"mail-onboarding-wrapper"},void 0,ete("div",{className:"mail-onboarding"},void 0,ate,ete("h1",{},void 0,(0,le.Z)("Add your first mail account")),ete("p",{},void 0,(0,le.Z)("You can add any IMAP or POP account to Vivaldi Mail")),ete("input",{type:"button",onClick:this.openMailSettings,value:(0,le.Z)("Add Mail Account")}))))}}}const dte=function(e,t){const n=e.name.toLowerCase(),i=t.name.toLowerCase();return n<i?-1:n>i?1:e.name<t.name?-1:e.name>t.name?1:0},cte=function(e,t){return tte.indexOf(e.path)-tte.indexOf(t.path)},hte=function(e,t){return nte.indexOf(e.path)-nte.indexOf(t.path)},pte=function(e,t){return zee.k.indexOf(e.path)-zee.k.indexOf(t.path)},ute=function(e,t,n,i,s,o,a){i.sort(dte).forEach((i=>{(0,Wee.Z)(i.path,n)?gte(e,t,n+"/",i.children,s,o,a):i.children.length>0&&ute(e,t,n,i.children,s,o,a)}))},gte=function(e,t,n,i,s,o,a){const r=t.indexOf("/");if(e===ue.u4||-1===r)s[n+=t]||(i.push({name:a||t,path:n,accountId:e,id:o+"_"+n,children:[]}),s[n]=!0);else{const l=t.substr(r+1),d=t.substr(0,r);if(s[n+=d])ute(e,l,n,i,s,o,a);else{const t={accountId:e,path:n,children:[],id:o+"_"+n,name:d};gte(e,l,n+"/",t.children,s,o,a),i.push(t),s[n]=!0}}},mte=lte;var vte;function fte(e,t,n,i){vte||(vte="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:vte,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class yte extends tn.PureComponent{static contextType=dn.Z;markdownFormatter=new K0;refRender=tn.createRef();state={markup:this.props.body};componentDidMount(){const e=this.props.attachments.map((({content:e})=>fetch(e).then((e=>e.blob())).then((t=>{const n=URL.createObjectURL(t);return{content:e,objectURL:n}}))));Promise.all(e).then((e=>{this.objectURLs=e.map((e=>e.objectURL));const t=e.map((({content:e,objectURL:t})=>`[${Et()(e)}]: ${t}`)).join("\n"),n=`${this.props.body}\n\n${t}\n`;this.setState({markup:n})})),this.refRender.current&&(this.refRender.current.scrollTop=this.props.initialScrollPosition||0)}componentWillUnmount(){this.objectURLs&&this.objectURLs.forEach(URL.revokeObjectURL)}onScroll=({currentTarget:e})=>{this.props.onScrollValueChange&&this.props.onScrollValueChange(e.scrollTop)};selectAll=e=>{const{document:t,getSelection:n}=this.context;e.focus();const i=n();i&&i.removeAllRanges();const s=t.createRange();s.selectNodeContents(e),i&&i.addRange(s)};onKeyDown=e=>{const{getSelection:t}=this.context;switch(e.key){case"a":return void(e.ctrlKey&&(e.preventDefault(),this.selectAll(e.currentTarget)));case"Escape":{const e=t();return void(e&&e.removeAllRanges())}}};render(){const{className:e}=this.props,t=this.markdownFormatter.getRawMarkup(this.state.markup);return(0,fn.jsx)("div",{ref:this.refRender,onMouseUp:e=>function(e,t){if(0!==t.button)return;const n=t.target;if(n instanceof HTMLAnchorElement&&n.href){const i=n.getAttribute("href");if(!i||i&&i.startsWith("#"))return;const{metaKey:s,shiftKey:o,ctrlKey:a,altKey:r,button:l}=t,{allowOverride:d,...c}=(0,ls.Z)(e,{metaKey:s,shiftKey:o,ctrlKey:a,altKey:r,button:l});if(!d)return;Y.Z.openURL(e,n.href,{...c,inCurrent:!1,inBackground:d?M.Z.get(D.kTabsOpenNewInBackground):c.inBackground})}}(this.context.vivaldiWindowId,e),onKeyDown:this.onKeyDown,className:mn()("MarkdownRender",e),tabIndex:"0",onScroll:this.onScroll,children:fte("div",{dangerouslySetInnerHTML:{__html:t}})})}}const wte=yte;class bte extends tn.PureComponent{_isIMEOpen=!1;state={content:this.props.content};refContent=tn.createRef();focus=()=>{this.refContent.current?.focus()};reset=(0,Zr.Z)((()=>{this.setState({content:this.props.content})}),NJ.mS,{leading:!1,trailing:!0});_save=(0,Zr.Z)((()=>{this.waitForCompositionEnd.then((()=>{this.props.onSave(this.state.content)}))}),NJ.mS,{leading:!1,trailing:!0});handleContentChange=({currentTarget:e})=>{this.props.onChange(e.value),this.setState({content:e.value},this._save)};waitForCompositionEnd=Promise.resolve();resolveComposition=()=>{};_handleCompositionStart=()=>{this._isIMEOpen=!0,this.waitForCompositionEnd=(()=>new Promise((e=>{this.resolveComposition=e})))()};_handleCompositionEnd=()=>{this._isIMEOpen=!1,this.resolveComposition()};handleKeyDown=e=>{(e.metaKey||e.ctrlKey)&&"s"===e.key&&(e.preventDefault(),this.props.onSave(this.state.content)),"Escape"===e.key&&this._isIMEOpen&&(e.preventDefault(),e.stopPropagation())};handleFocus=e=>{e.persist(),e.currentTarget.selectionStart=this.props.content.length,e.currentTarget.selectionEnd=this.props.content.length};render(){const{disabled:e,className:t}=this.props,{content:n}=this.state;return(0,fn.jsx)("textarea",{ref:this.refContent,className:t,placeholder:(0,le.Z)("Note"),title:(0,le.Z)("Write a note"),value:n,disabled:e,onFocus:this.handleFocus,onChange:this.handleContentChange,onCompositionStart:this._handleCompositionStart,onCompositionEnd:this._handleCompositionEnd,onKeyDown:this.handleKeyDown,onBlur:this.props.onBlur})}}var Cte,Ste=n(14720),Tte=n(99250);function Ite(e,t,n,i){Cte||(Cte="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Cte,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const kte="NotesEditor";function Ate({windowId:e,disabled:t,onToggleMarkDown:n,onTakeScreenshot:i,onTakeCaptureArea:s,onOpenDialog:o,keyAccess:a,viewMarkdown:r,noteId:l}){const d=t?-1:a;return Ite("div",{className:"toolbar toolbar-default"},void 0,Ite("div",{className:"toolbar-group"},void 0,Ite("div",{className:"button-toolbar"},void 0,Ite("button",{disabled:t,onClick:i,title:(0,le.Z)("Add screenshot"),tabIndex:d,dangerouslySetInnerHTML:{__html:cn.F_h}})),Ite("div",{className:"button-toolbar"},void 0,Ite("button",{disabled:t,onClick:s,title:(0,le.Z)("Add capture of selected area..."),tabIndex:d,dangerouslySetInnerHTML:{__html:cn.Syi}})),Ite(t1,{onOpenDialog:o,disabled:t,keyAccess:d,noteId:l}),Ite("div",{className:"button-toolbar"},void 0,Ite("button",{className:"button-toolbar"+(r?" button-pressed":""),disabled:t,onClick:n,title:r?(0,le.Z)("Switch to Editor"):(0,le.Z)("Switch Markdown View"),tabIndex:d,dangerouslySetInnerHTML:{__html:cn.Pje}}))),Ite("div",{className:"button-toolbar",style:{marginLeft:"auto",marginRight:0}},void 0,Ite("button",{disabled:t,onClick:()=>function(e,t){Y.Z.openURL(e,St.jk.internalUrl("notes",t),{singleton:!0})}(e,l),title:(0,le.Z)("Open in Tab"),tabIndex:d,dangerouslySetInnerHTML:{__html:cn.vvh.medium}})))}function Zte(e){return new Promise((t=>{M.Z.get(D.kPanelsAsOverlayEnabled)&&Ho.Z.toggleContent(e,"notes"),setTimeout((()=>t()),200)}))}async function Ete(e,t){return function(e,t){return new Promise(((n,i)=>{d.Z.notes.update(e,t,(e=>{y.Z.runtime.lastError&&i(y.Z.runtime.lastError),n(e)}))}))}(e,t)}function _te(e,{title:t,content:n,url:i}){return Ete(e,(0,Ste.Z)({url:"string"==typeof i?(0,Ni.q9)(i.trim()):void 0,title:t,content:n},Tte.Z))}class Nte extends tn.Component{static contextType=dn.Z;refFolderName=tn.createRef();refContainer=tn.createRef();refTextEditor=tn.createRef();state={url:this.props.note?this.props.note.url:void 0,title:this.props.note?this.props.note.title:void 0,content:this.props.note?this.props.note.content:void 0};isEmpty=()=>{const{note:e}=this.props;return![this.state.title,this.state.url,e&&e.content,e&&e.attachments&&e.attachments.length].some(Boolean)};componentDidMount(){$C.Z.addListener(this._onUrlbarStoreChanged)}componentDidUpdate(e,t){this.props.note&&this.props.note.content!==t.content&&this.updateState()}componentWillUnmount(){if($C.Z.removeListener(this._onUrlbarStoreChanged),!this.props.note)return;const{content:e}=this.state;_te(this.props.note.id,{content:e})}updateState=(0,Zr.Z)((()=>{if(ss(this.refTextEditor.current?.refContent.current??null))return;const e={url:this.props.note?this.props.note.url:void 0,title:this.props.note?this.props.note.title:void 0,content:this.props.note?this.props.note.content:void 0};this.setState(e,(()=>this.refTextEditor.current&&this.refTextEditor.current.reset()))}),NJ.mS,{trailing:!0,leading:!1});focusPrimaryInput=()=>{if(!this.props.note)return;NJ.ZP.isFolder(this.props.note)?this.refFolderName.current&&this.refFolderName.current.focus():this.refTextEditor.current&&this.refTextEditor.current.focus()};_captureScreenshot=()=>{if(!this.props.note)return;const e=this.props.note.id,t=this.context.vivaldiWindowId;Zte(t).then((()=>Fs.Z.addScreenshot(t,e)))};_takeAreaCapture=async()=>{const e=this.props.note;e&&(Zte(this.context.vivaldiWindowId),await Fs.Z.addAreaCapture(this.context.vivaldiWindowId,e.id))};_openUrl=e=>{if(2===e.button)return;if(!this.props.note||!this.props.note.url)return;const t=(0,Ni.Fn)(this.props.note.url);if(!t)return;const n=this.context.vivaldiWindowId,{metaKey:i,shiftKey:s,ctrlKey:o,altKey:a,button:r}=e,{allowOverride:l,...d}=(0,ls.Z)(n,{metaKey:i,shiftKey:s,ctrlKey:o,altKey:a,button:r});Y.Z.openURL(n,t,d)};_toggleMarkdown=()=>{this._save(),this.props.toggleMarkdown()};_save=async()=>{const{note:e}=this.props;if(!e||e.trash)return Promise.resolve();Of.Z.setUrlfieldState(kte,{editUrl:void 0});const{url:t,content:n}=this.state;return await _te(e.id,{url:t,content:n})};_onUrlbarStoreChanged=()=>{const e=$C.Z.getUrlfieldStateFromId(kte);this.setState({url:e.editUrl})};handleTitleChange=({currentTarget:e})=>{const{note:t}=this.props;if(!t)return;const n=e.value;this.setState({title:n},(()=>{_te(t.id,{title:n})}))};onBlur=()=>{this._save()};deleteAttachment=e=>{this.props.note&&Fs.Z.removeAttachment(this.props.note.id,e)};handleSaveContent=e=>{const{note:t}=this.props;t&&_te(t.id,{content:e})};render(){const{note:e}=this.props,t=e&&!NJ.ZP.isFolder(e),n=e&&NJ.ZP.isFolder(e),i=!e,s=e?b()(e.dateAdded).format("LLL"):"",o=Boolean(!e||NJ.ZP.isSeparator(e)||n);return(0,fn.jsxs)("div",{className:mn()("NotesEditor","cardview",{"NotesEditor--HasAttachments":e&&e.attachments&&e.attachments.length>0}),ref:this.refContainer,onKeyDown:this.props.onKeyDown,children:[Ite(Ate,{windowId:this.context.vivaldiWindowId,disabled:o,onToggleMarkDown:this._toggleMarkdown,onTakeScreenshot:this._captureScreenshot,onTakeCaptureArea:this._takeAreaCapture,keyAccess:this.props.keyAccess,viewMarkdown:this.props.viewMarkdown,noteId:e?e.id:"-1",onOpenDialog:this.props.onOpenDialog}),t&&!this.props.viewMarkdown&&e&&Ite("span",{className:"NotesEditor-Editor-Background"},void 0,(0,fn.jsx)(bte,{ref:this.refTextEditor,onBlur:this.onBlur,className:"NotesEditor-Editor",disabled:o,content:e.content||"",onChange:e=>this.setState({content:e}),onSave:this.handleSaveContent},e.id)),t&&this.props.viewMarkdown&&e&&Ite(wte,{body:e.content||"",attachments:[]},e.content?e.content.length:"-1"),n&&e&&Ite("div",{className:"folder"},void 0,(0,fn.jsx)("input",{ref:this.refFolderName,type:"text",placeholder:(0,le.Z)("Folder"),title:(0,le.Z)("Edit folder name"),value:this.state.title,disabled:e.trash,onFocus:e=>e.target.select(),onChange:this.handleTitleChange})),i&&Ite("div",{className:"NotesEditor-EmptyPlaceholder ",onClick:this.props.onAdd},void 0,(0,le.Z)("Add a new note")),e&&Ite(a1,{className:"NotesEditor-Attachments",attachments:e.attachments||[],onRemoveAttachment:this.deleteAttachment}),Ite("div",{className:mn()("NotesEditor-Metadata",{disabled:o})},void 0,Ite("button",{className:"NotesEditor-MetaIcon NotesEditor-MetaIcon--Url",title:(0,le.Z)("Go to address"),disabled:o,tabIndex:o?-1:this.props.keyAccess,onClick:this._openUrl,onAuxClick:this._openUrl,dangerouslySetInnerHTML:{__html:cn.iD7}}),Ite(oS,{onBlur:this.onBlur,autoFocus:!1,title:(0,le.Z)("Enter webpage address"),className:"cardview address",disabled:o,displayUrl:e&&e.url?e.url:"",editUrl:this.state.url,autocompletionEnabled:!0,pageId:kte,placeholder:e?(0,le.Z)("Address"):null}),Ite("div",{className:"NotesEditor-Created dateCreated",title:(0,le.Z)("Date created")},void 0,Ite("div",{className:"NotesEditor-MetaIcon fieldset",dangerouslySetInnerHTML:{__html:cn.V_c}}),Ite("span",{},void 0,s)))]})}}const Mte=Nte;var Pte,Dte=n(34155);function xte(e,t,n,i){Pte||(Pte="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Pte,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ote=[D.kKeyboardTabToAll,D.kNotesPanelEditorHeight,D.kNotesPanelShowMarkdown],Lte=[{text:(0,le.Z)("Title"),value:"title",fullScreenTitle:(0,le.Z)("Sort by Title")},{text:(0,le.Z)("Address"),value:"url",fullScreenTitle:(0,le.Z)("Sort by Address")},{text:(0,le.Z)("Content"),value:"content",fullScreenTitle:(0,le.Z)("Sort by Content")},{text:(0,le.Z)("Created"),value:"dateAdded",fullScreenTitle:(0,le.Z)("Sort by Date Created")}];class Rte extends tn.PureComponent{static contextType=dn.Z;_editor=tn.createRef();_tree=tn.createRef();cancelableId="";selectableId="";canDrop=!1;editorMaxHeight=900;refPanel=tn.createRef();refToolbar=tn.createRef();constructor(e){super(e);const t=M.Z.get(D.kNotesPanelSorting);this.state={hasNotes:NJ.ZP.hasNotes(),selectedNote:void 0,filter:"",editorHeight:this.props.prefValues[D.kNotesPanelEditorHeight],sorting:{sortOrder:t.sortOrder,sortField:t.sortField,comparator:this.sortComparator}}}componentDidMount(){NJ.ZP.addListener(this._onStoreChange),Dl.ZP.addListener(this._onPanelStoreChange),this.context.addEventListener("resize",this._onWindowResize,!1),this._onWindowResize()}componentWillUnmount(){NJ.ZP.removeListener(this._onStoreChange),Dl.ZP.removeListener(this._onPanelStoreChange),this.context.removeEventListener("resize",this._onWindowResize)}componentDidUpdate(e,t){!e.open&&this.props.open&&Dte.nextTick((()=>this._applyTransitionState()))}_onWindowResize=()=>{const e=this.refPanel.current?.getBoundingClientRect().height;this.editorMaxHeight=e?e-250:900};_onStoreChange=(e,t)=>{if("added"===e){if(!this.panelShouldHaveFocus())return;let e="";const n=NJ.ZP.getNodeById(t);n&&!NJ.ZP.isSeparator(n)&&(this.cancelableId=e=t),Dte.nextTick((()=>{this.props.open&&z.ZP.isActive(this.context.vivaldiWindowId)&&this._tree.current&&(this.cancelableId=e,this._tree.current.selectById(t))}))}const n=this.state.selectedNote?.id===t;if("changed"===e&&n){const e=NJ.ZP.getNodeById(t);return void this.setState({selectedNote:e})}const i=NJ.ZP.hasNotes();!i&&this.state.hasNotes&&(this.setState({selectedNote:void 0}),this.focusSearch()),this.setState({hasNotes:i})};panelShouldHaveFocus=()=>{const{document:e}=this.context,t=W.Z.getActivePage(this.context.vivaldiWindowId)?.url||"";return Boolean(e.getElementById("panels-container")?.contains(e.activeElement))||!St.jk.matchInternal("notes",t)};onDragEnterPanelButton=e=>{const t={};return t.support=e.dataTransfer.types.some((e=>"text/plain"===e)),t.copy=t.support,t.onButton=t.support,t};onDropPanelButton=e=>{const t=e.dataTransfer.getData("text/plain"),n=this.context.vivaldiWindowId;(async function(e,t){const n=W.Z.getActivePage(e);if(n){const{id:e,url:i}=n;if(await d.Z.utilities.getSelectedText(e)===t)return i}})(n,t).then((e=>{e?Fs.Z.createNote(n,{content:t,url:e}):Fs.Z.createNote(n,{content:t})}))};_applyTransitionState=()=>{const e=this.context.vivaldiWindowId,t=Dl.ZP.getTransitionState(e,"notes");Ho.Z.clearTransitionState(e,"notes"),this._tree.current&&t?(t.selectId&&this._tree.current.selectById(t.selectId),t.setFocus&&this.focusTree()):this._tree.current&&!0===this.state.hasNotes?this.focusTree():this.focusSearch()};_onPanelStoreChange=(e,t)=>{if(e===this.context.vivaldiWindowId&&this.props.open)switch(t){case"setFocus":ss(this.refPanel.current)||this.focusTree();break;case"display":Dte.nextTick((()=>this._applyTransitionState()))}};onItemCreated=()=>{const e=this.getSelectedItem();this.selectableId=e?e.id:""};onItemSelected=e=>{e?(this.cancelableId!==e.id&&(this.cancelableId=""),this.setState({selectedNote:e},(()=>{const e=document.activeElement;this.cancelableId&&this._editor.current&&"NotesManager-Editor"!==e?.className&&this._editor.current.focusPrimaryInput()}))):this.setState({selectedNote:void 0})};unSelectAll=()=>{this._tree.current?.unSelectAll(),this.setState({selectedNote:void 0})};onSortChange=(e,t)=>{this.setState((n=>({sorting:{...n.sorting,sortOrder:e,sortField:t}}))),nt.Z.set(D.kNotesPanelSorting,{sortOrder:e,sortField:t})};sortComparator=(e,t)=>{if(e.trash)return 1;if(t.trash)return-1;if(NJ.ZP.isFolder(e)&&!NJ.ZP.isFolder(t))return-1;if(NJ.ZP.isFolder(t)&&!NJ.ZP.isFolder(e))return 1;const{sortOrder:n,sortField:i}=this.state.sorting;if("title"===i)return this.sortByTitle(e,t,n);return ns.Z.getDefaultComparator(n,i)(e,t)};sortByTitle=(e,t,n)=>{if(n<=ns.Z.NO_SORTING)return 0;const i=e.title||g1(e),s=t.title||g1(t);return i||s?i?s?n===ns.Z.ASCENDING_SORT?i.toLowerCase().localeCompare(s.toLowerCase()):s.toLowerCase().localeCompare(i.toLowerCase()):n===ns.Z.ASCENDING_SORT?-1:1:n===ns.Z.ASCENDING_SORT?1:-1:0};getSelectedItem=()=>this._tree.current?.getSelectedItem();onAddNote=()=>{this.props.prefValues[D.kNotesPanelShowMarkdown]&&this.toggleMarkdown(),0===this.state.editorHeight&&this.resizeToDefault(),this.setState({filter:""}),this._tree.current?this._tree.current.onAddNote():Fs.Z.createNote(this.context.vivaldiWindowId,{})};onAddFolder=()=>{this.setState({filter:""}),this._tree.current?.onAddFolder()};deleteSelectedItems=()=>{this._tree.current?.deleteSelectedItems()};handleFilterChange=e=>{this.setState({filter:e})};onSlidebarPosition=(e,t)=>{this.setState((e=>({editorHeight:Math.max(Math.min(e.editorHeight-t,this.editorMaxHeight),0)})))};onSlidebarStop=()=>{this.setState((e=>{let t=e.editorHeight;return t<=Q.Cn&&(t=0),nt.Z.set(D.kNotesPanelEditorHeight,parseInt(t)),{editorHeight:t}}))};toggleMarkdown=()=>{nt.Z.toggle(D.kNotesPanelShowMarkdown,!0,!1)};resizeToDefault=()=>{this.setState((e=>{let t=e.editorHeight;return t>Q.Cn?(t=0,nt.Z.set(D.kNotesPanelEditorHeight,parseInt(t))):(t=300,nt.Z.reset(D.kNotesPanelEditorHeight)),{editorHeight:t}}))};focusSearch=()=>{this.refToolbar.current?.focusSearch()};focusTree=()=>{this._tree.current?.refTreeList.current?.focusTree()};onContextMenu=e=>{e.nativeEvent.buttons>0&&this.unSelectAll(),this._tree.current?.onContextMenu(e)};onDragEnter=e=>{this.canDrop=-1!==e.dataTransfer.types.findIndex((e=>"text/plain"===e)),e.preventDefault(),e.stopPropagation()};onDragOver=e=>{!0===this.canDrop&&(e.nativeEvent.dataTransfer.dropEffect="copy"),e.preventDefault(),e.stopPropagation()};onDrop=e=>{if(!0===this.canDrop){const t=e.dataTransfer.getData("text/plain");t.length>0&&this._tree.current?.onAddNote({content:t})}e.preventDefault(),e.stopPropagation()};_onKeyDown=e=>{if("Escape"===e.key)return this.focusTree(),e.stopPropagation(),void e.preventDefault()};render(){if(!this.props.open)return null;const e=this.state.editorHeight>0,t=Boolean(!this.state.selectedNote||this.state.selectedNote&&this.state.selectedNote.trash);return(0,fn.jsxs)("div",{ref:this.refPanel,className:"panel",id:"notes-panel",children:[xte("header",{},void 0,xte(Rp,{title:this.props.title}),(0,fn.jsx)(D1,{ref:this.refToolbar,filter:this.state.filter,onFilterValueChange:this.handleFilterChange,onAddNote:this.onAddNote,onDeleteSelectedItems:this.deleteSelectedItems,onAddFolder:this.onAddFolder,isDeleteDisabled:t})),!0===this.state.hasNotes&&xte(Iu,{fields:Lte,onSortChange:this.onSortChange,keyAccess:this.props.prefValues[D.kKeyboardTabToAll],sortField:this.state.sorting.sortField,sortOrder:this.state.sorting.sortOrder}),xte("section",{className:"outerScrollbar",onClick:this.unSelectAll,onContextMenu:!0===this.state.hasNotes?this.onContextMenu:null},void 0,!1===this.state.hasNotes&&xte("div",{className:"no-notes",onDragEnter:this.onDragEnter,onDragOver:this.onDragOver,onDrop:this.onDrop},void 0,xte(M1,{onAddNote:this.onAddNote})),(0,fn.jsx)(Z1,{ref:this._tree,settings:"NOTES_TREE",filter:this.state.filter,sorting:this.state.sorting,onCreated:this.onItemCreated,onItemSelected:this.onItemSelected})),xte("div",{className:"notes-editor",onDragEnter:!0===this.state.hasNotes?null:this.onDragEnter,onDragOver:!0===this.state.hasNotes?null:this.onDragOver,onDrop:!0===this.state.hasNotes?null:this.onDrop,style:{height:this.state.editorHeight}},void 0,xte(gu,{onSlidebarPosition:this.onSlidebarPosition,onStop:this.onSlidebarStop,onDoubleClick:this.resizeToDefault,returnOffset:!0,position:"bottom"}),e&&(0,fn.jsx)(Mte,{ref:this._editor,note:this.state.selectedNote,onAdd:this.onAddNote,onOpenDialog:this.props.onOpenDialog,toggleMarkdown:this.toggleMarkdown,viewMarkdown:this.props.prefValues[D.kNotesPanelShowMarkdown],keyAccess:this.props.prefValues[D.kKeyboardTabToAll],onKeyDown:this._onKeyDown},this.state.selectedNote?this.state.selectedNote.id:-1))]})}}const Bte=(0,fs.Z)(Rte,Ote);var Fte;function Ute(e,t,n,i){Fte||(Fte="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Fte,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Vte=[{text:(0,le.Z)("title","Title"),value:"title",fullScreenTitle:(0,le.Z)("Sort by Title")},{text:(0,le.Z)("Read state"),value:"read",fullScreenTitle:(0,le.Z)("Sort by Read State")},{text:(0,le.Z)("Date"),value:"lastUpdate",fullScreenTitle:(0,le.Z)("Sort by Date Updated")},{text:(0,le.Z)("Address"),value:"url",fullScreenTitle:(0,le.Z)("Sort by Address")}];class Wte extends tn.PureComponent{refTreeList=tn.createRef();static contextType=dn.Z;state={sorting:this.props.prefValues[D.kReadingListPanelSorting]};onSortChange=(e,t)=>{const n={sortOrder:e,sortField:t};this.setState({sorting:n}),nt.Z.set(D.kReadingListPanelSorting,{sortOrder:e,sortField:t})};sortComparator=(e,t)=>{const{sortOrder:n,sortField:i}=this.state.sorting;return ns.Z.getDefaultComparator(n,i)(e,t)};getSelectedIds=()=>(this.refTreeList.current?.getAllSelectedItems()||[]).map((e=>e.id));deleteSelected=()=>{this.refTreeList.current?.onDelete()};onClickUrl=e=>{Y.Z.openURL(this.context.vivaldiWindowId,e,{singleton:!0}),Ol.Z.setReadStatus(e,!0)};onClick=(e,t)=>{this.onClickUrl(t.url)};onItemsActivated=(e,t)=>{t.forEach((e=>{e.url&&this.onClickUrl(e.url)}))};onOpenSelected=()=>{const e=this.getSelectedIds();e&&e.forEach((e=>{e&&this.onClickUrl(e)}))};onClickMark=(e,t,n)=>{n&&(0,Cs.Z)(n),Ol.Z.setReadStatus(e,t)};copy=e=>{ui.Z.copyTextToClipboard(e)};onRemoveSelected=async e=>{e.forEach((e=>Ol.Z.remove(e)))};rowComponent=e=>{const t=e.node;return Ute("div",{className:"readinglist-item-large"},t.url,Ute(wv,{onClickMark:this.onClickMark,onClickRemove:()=>{},entry:t}))};getMenuCapability=async(e,t,n)=>{const i=this.context.vivaldiWindowId;switch(e.action){case"CONTEXT_OPEN":return{handler:()=>this.onOpenSelected(),visible:Boolean(n),...t(i,e,{})};case"CONTEXT_MARK_READ":return{handler:()=>this.onClickMark(n.url,!0),visible:Boolean(n)&&!n.read,...t(i,e,{})};case"CONTEXT_MARK_UNREAD":return{handler:()=>this.onClickMark(n.url,!1),visible:Boolean(n)&&n.read,...t(i,e,{})};case"CONTEXT_COPY_URL":return{handler:()=>this.copy(n.url),visible:Boolean(n),...t(i,e,{})};default:return{...t(i,e,{})}}};getMenuVisibility=(e,t)=>{if(!t)return!1;switch(e.action){case"CONTEXT_OPEN":case"CONTEXT_COPY_URL":case"CONTEXT_MARK_READ":case"CONTEXT_MARK_UNREAD":case"CONTEXT_DELETE":return!0;default:return!1}};menu={name:"readinglist",getCapability:this.getMenuCapability,getVisibility:this.getMenuVisibility};render(){const e=this.props.prefValues[D.kReadingListPanelSingleClickOpens],t={sortOrder:this.state.sorting.sortOrder,sortField:this.state.sorting.sortField,comparator:this.sortComparator};return(0,fn.jsxs)(fn.Fragment,{children:[Ute(Iu,{fields:Vte,manualSorting:!1,onSortChange:this.onSortChange,keyAccess:this.props.keyAccess,compact:!0,sortField:this.state.sorting.sortField,sortOrder:this.state.sorting.sortOrder}),Ute("section",{className:"outerScrollbar"},void 0,(0,fn.jsx)(Yu,{ref:this.refTreeList,settings:"READING_LIST_TREE",rowComponent:this.rowComponent,nodes:this.props.nodes,onSelect:this.props.onItemSelected,menu:this.menu,hasChildren:EU.Z,isFolder:EU.Z,onCopy:this.copy,onItemsActivated:this.onItemsActivated,onItemClick:e?this.onClick:void 0,onItemDoubleClick:e?void 0:this.onClick,delete:this.onRemoveSelected,enableDragAndDrop:!1,supportsInlineEdit:!1,sorting:t,rowHeight:68}))]})}}const Hte=Wte;var zte;function Gte(e,t,n,i){zte||(zte="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:zte,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const $te=[D.kReadingListPanelSingleClickOpens,D.kReadingListPanelSorting];function Kte(e){return e.map((e=>({...e,id:e.url})))}class jte extends tn.PureComponent{static contextType=dn.Z;winId=this.context.vivaldiWindowId;_tree=tn.createRef();state={items:[],selected:"",isUrlSupported:!1,filter:""};componentDidMount(){Cv.Z.addListener(this._onStoreChanged),W.Z.addListener(this._onPageStoreChanged),this._onStoreChanged(),this._onPageStoreChanged()}componentWillUnmount(){Cv.Z.removeListener(this._onStoreChanged),W.Z.removeListener(this._onPageStoreChanged)}_onStoreChanged=()=>{const e=Cv.Z.getList();this.setState({items:Kte(e)})};_onPageStoreChanged=()=>{const{url:e}=W.Z.unsafeGetActivePage(this.winId);this.setState({isUrlSupported:(0,Ol.M)(e)})};addCurrentPage=()=>Ol.Z.add(this.context.vivaldiWindowId);deleteSelected=()=>this._tree.current?.deleteSelected();onToggleReadStatus=()=>{this.setState((e=>{const t=e.items.find((t=>t.id===e.selected));t&&Ol.Z.setReadStatus(t.url,!t.read)}))};handleFilterChange=e=>{const t=e.target.value,n=Kte(t?Cv.Z.getFilter(t):Cv.Z.getList());this.setState({filter:t,items:n})};focusTree=()=>{this._tree.current&&this._tree.current.refTreeList.current?.focusTree()};onItemSelected=e=>{if(e){if(e.id===this.state.selected)return;this.setState({selected:e.id})}else this.setState({selected:""})};render(){if(!this.props.open)return null;const e=this.state.items.find((e=>e.url===this.state.selected));return Gte("div",{className:"panel",id:"readinglist"},void 0,Gte("header",{},void 0,Gte(Rp,{title:this.props.title}),Gte("div",{className:"toolbar toolbar-default toolbar-wrap"},void 0,Gte("input",{type:"search",placeholder:(0,le.Z)("verb","Search"),value:this.state.filter,onChange:this.handleFilterChange}),Gte("div",{className:"toolbar"},void 0,Gte("div",{className:"toolbar-group"},void 0,Gte(sl,{onClick:this.addCurrentPage,tooltip:(0,le.Z)("Add current page"),disabled:!this.state.isUrlSupported,image:cn.md4.small}),Gte(sl,{onClick:this.deleteSelected,disabled:""===this.state.selected,image:cn.M2k.small,tooltip:(0,le.Z)("other","Delete")})),Gte(sl,{onClick:this.onToggleReadStatus,tooltip:e?.read?(0,le.Z)("Set as Unread"):(0,le.Z)("Set as Read"),disabled:""===this.state.selected,image:e?.read?cn.sgm.small:cn.D7r.small})))),(0,fn.jsx)(Hte,{ref:this._tree,nodes:this.state.items,keyAccess:this.props.keyAccess,focusTree:this.focusTree,prefValues:this.props.prefValues,onItemSelected:this.onItemSelected}))}}const Yte=(0,fs.Z)(jte,$te);var Xte;function Qte(e,t,n,i){Xte||(Xte="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Xte,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class qte extends tn.Component{render(){const e=this.props.progress;return Qte("progress",{className:mn()({"page-progress-indicator":!0,"progress-done":1===e}),value:100*e,max:100})}}const Jte=qte;var ene;function tne(e,t,n,i){ene||(ene="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:ene,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class nne extends tn.PureComponent{refTreeList=tn.createRef();static contextType=dn.Z;winId=this.context.vivaldiWindowId;_returnFalse=()=>!1;_returnTrue=()=>!0;_languageFromCode=e=>{const t=this.props.languages.findIndex((t=>t.id===e));return-1===t?e:this.props.languages[t].historyName};_onNodesActivated=(e,t)=>{this.props.onActivated(t[0].id)};_onNodeDoubleClick=(e,t)=>{this.props.onActivated(t.id)};_onCopyAll=()=>{const e=e=>{const t=(this.refTreeList.current?.getAllSelectedItems()||[]).map((e=>e.id));this.props.onItemsCopy(e,t,!0)};document.addEventListener("copy",e),document.execCommand("copy"),document.removeEventListener("copy",e)};_onCopy=(e,t)=>{this.props.onItemsCopy(e,t,!1)};_getMenuCapability=async(e,t,n)=>{const i=this.winId;return"CONTEXT_COPY_ALL"===e.action?{handler:this._onCopyAll,visible:Boolean(n),...t(i,e,{})}:{...t(i,e,{})}};_getMenuVisibility=(e,t)=>{if(!t)return!1;switch(e.action){case"CONTEXT_COPY":case"CONTEXT_DELETE":return!0;default:return!1}};clipByWord=e=>{if(e.length<=560)return e;const t=e.substring(0,560),n=t.lastIndexOf(" ");return t.substring(0,n)+"..."};getRowHeight=({index:e})=>this.props.nodes[e].translatedItem?.text?.length>140?98:68;rowComponent=e=>{const t=e.node,n=`${this._languageFromCode(t.srcItem.code)} → ${this._languageFromCode(t.translatedItem.code)}`;return tne("div",{className:["TranslatePanel-Row",t.translatedItem.text?.length<=140?"TranslatePanel-Row-Narrow":""].join(" "),title:(0,le.Z)("Go to full translation")},void 0,tne("label",{className:"TranslatePanel-Row-Heading"},t.id,tne("span",{},void 0,n)),tne("label",{className:"TranslatePanel-Row-Source"},void 0,tne("span",{},void 0,this.clipByWord(t.srcItem.text))),tne("label",{className:"TranslatePanel-Row-Result"},void 0,tne("span",{},void 0,this.clipByWord(t.translatedItem.text))))};menu={name:"translatehistory",getCapability:this._getMenuCapability,getVisibility:this._getMenuVisibility};render(){return tne("section",{className:"outerScrollbar"},void 0,(0,fn.jsx)(Yu,{ref:this.refTreeList,settings:"TRANSLATE_HISTORY_TREE",rowComponent:this.rowComponent,nodes:this.props.nodes,menu:this.menu,isFolder:this._returnFalse,hasChildren:this._returnFalse,delete:this.props.onItemsDelete,onSelect:Tl.default,onCopy:this.props.onItemsCopy,enableDragAndDrop:!1,isValidForClipboard:this._returnTrue,onItemDoubleClick:this._onNodeDoubleClick,onItemsActivated:this._onNodesActivated,rowHeight:this.getRowHeight}))}}const ine=nne;var sne;function one(e,t,n,i){sne||(sne="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:sne,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class ane extends tn.PureComponent{render(){return this.props.showPlaceholder?one("textarea",{className:"TranslatePanel-TranslatedText",type:"text",placeholder:(0,le.Z)("Please wait"),readOnly:!0}):one("textarea",{className:"TranslatePanel-TranslatedText",type:"text",value:this.props.text,readOnly:!0})}}const rne=ane;var lne,dne=n(34155);function cne(e,t,n,i){lne||(lne="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:lne,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function hne(){return Ml.Z.getTranslationLocales().map((e=>({id:Ml.Z.getTranslationCode(e.key),name:qb(e),historyName:e.value})))}class pne extends tn.PureComponent{static contextType=dn.Z;_errorId=null;_hasLoadedHistory=!1;_idleId=null;_pending=void 0;constructor(e){super(e),this.state={autoTranslate:M.Z.get(D.kPanelsTranslateAutomatic),busy:!1,error:"none",history:[],languages:hne(),pageId:0,showPlaceholder:!1,srcLanguage:"auto",srcText:"",translatedText:"",targetLanguage:Ml.Z.getTranslationCode((0,sC.Z)().substring(0,2)),viewMode:"main"}}componentDidMount(){this._isMounted=!0,W.Z.addListener(this._onPageStoreChanged),M.Z.addListener(D.kPanelsTranslateAutomatic,this._onPrefChanged),d.Z.tabsPrivate.onWebviewClickCheck.addListener(this._onWebviewClicked),Qb.Z.addListener(this._onTranslationStateStoreChanged),d.Z.utilities.onBroadcastMessage.addListener(this._onBroadcastMessage),this._loadHistory(),this.props.open&&0===this.state.pageId&&this._onPageStoreChanged()}componentWillUnmount(){this._isMounted=!1,this._idleId&&clearTimeout(this._idleId),W.Z.removeListener(this._onPageStoreChanged),M.Z.removeListener(D.kPanelsTranslateAutomatic,this._onPrefChanged),Qb.Z.removeListener(this._onTranslationStateStoreChanged),d.Z.utilities.onBroadcastMessage.removeListener(this._onBroadcastMessage),d.Z.tabsPrivate.onWebviewClickCheck.removeListener(this._onWebviewClicked),this._hasLoadedHistory&&(d.Z.translateHistory.onAdded.removeListener(this._onAdded),d.Z.translateHistory.onMoved.removeListener(this._onMoved),d.Z.translateHistory.onRemoved.removeListener(this._onRemoved)),this._setError("none")}componentDidUpdate(e,t){!e.open&&this.props.open?(this.setState({languages:hne()}),this._loadHistory(),0===this.state.pageId&&this._onPageStoreChanged()):e.open&&!this.props.open&&this._setError("none")}_loadHistory=()=>{this.props.open&&!this._hasLoadedHistory&&d.Z.translateHistory.get().then((e=>{this._isMounted&&(this._hasLoadedHistory=!0,d.Z.translateHistory.onAdded.addListener(this._onAdded),d.Z.translateHistory.onMoved.addListener(this._onMoved),d.Z.translateHistory.onRemoved.addListener(this._onRemoved),this.setState({history:e}))}))};_getItemById=e=>this.state.history.find((t=>t.id===e));_detectLanguage=async(e,t,n)=>{const i=await Ml.Z.detectTextLanguage(e,n);return i&&t!==i?i:t};_getLanguageByPageId=e=>Qb.Z.getPageState(e).pageLanguage||"";_onPageStoreChanged=()=>{const e=W.Z.unsafeGetActivePage(this.context.vivaldiWindowId).id;this.state.pageId!==e&&this.setState({pageId:e})};_onPrefChanged=(e,t)=>{this.setState({autoTranslate:Boolean(t)})};_onTranslationStateStoreChanged=()=>{this.props.open&&this.setState({languages:hne()})};_onBroadcastMessage=e=>{if(e.translate){const{winId:t,lang:n,text:i}=e.translate;t===this.context.vivaldiWindowId&&this.setState({srcText:i},(()=>{this._onTranslate(n)}))}};_onAdded=(e,t)=>{this.setState((n=>{const i=[...n.history];return e.forEach(((e,n)=>{i.splice(t+n,0,e)})),{history:i}}))};_onMoved=(e,t)=>{const n=this.state.history.findIndex((t=>t.id===e));-1!==n&&n!==t&&this.setState((e=>{const i=[...e.history],s=i.splice(n,1);return i.splice(t>n?t-1:t,0,s[0]),{history:i}}))};_onRemoved=e=>{0===e.length?this.setState({history:[]}):this.setState((t=>{const n=[...t.history];return e.forEach((e=>{const t=n.findIndex((t=>t.id===e));-1!==t&&n.splice(t,1)})),{history:n}}))};_onSourceLanguageSelected=e=>{const{value:t}=e.currentTarget;this.setState({srcLanguage:t})};_onTargetLanguageSelected=e=>{const{value:t}=e.currentTarget;this.setState({targetLanguage:t})};_onSrcEditChanged=e=>{this.setState({srcText:e.target.value,translatedText:"",showPlaceholder:!1})};_onKeyDown=e=>{const{ctrlKey:t,altKey:n,shiftKey:i,metaKey:s}=e,o={ctrlKey:t,altKey:n,shiftKey:i,metaKey:s};"Enter"===e.key&&(0,xr.VV)(o)&&(e.stopPropagation(),e.preventDefault(),this._onTranslate())};_onKeyDownMonitor=e=>{this._setError("none")};_onPaste=e=>{M.Z.get(D.kPanelsTranslatePaste)&&dne.nextTick((()=>{this._onTranslate()}))};_onWebviewClicked=(e,t,n,i,s)=>{if(this.props.open&&this.state.autoTranslate&&e===this.context.vivaldiWindowId&&!1===t&&0===n){"WEBVIEW"===document.elementFromPoint(Math.round(i),Math.round(s))?.tagName&&this._getSelectionAndTranslate()}};_getSelectionAndTranslate=()=>{d.Z.utilities.getSelectedText(this.state.pageId,(e=>{if(!e)return;const t=Qb.Z.getPageState(this.state.pageId).pageLanguage||"";e===this.state.srcText&&(e=""),this.setState({srcText:e},(()=>{this._onTranslate(t)}))}))};_toggleAutoTranslate=()=>{this.setState((e=>({autoTranslate:!e.autoTranslate})),(()=>{nt.Z.set(D.kPanelsTranslateAutomatic,this.state.autoTranslate),this.state.autoTranslate&&(this.state.srcText||this._getSelectionAndTranslate())}))};_onTranslateFromButton=()=>{this._onTranslate()};_onTranslate=e=>{const t=this.state.srcText.trim();if(!Ml.Z.canTranslateText(t))return void this.setState({translatedText:"",showPlaceholder:!1});if(this.state.busy)return void(this._pending={lang:e,text:t});this._setError("none"),this.setState({translatedText:"",showPlaceholder:!0,busy:!0});const n="auto"===this.state.srcLanguage&&void 0!==e?e:this.state.srcLanguage;this._detectLanguage(this.state.pageId,n,t).then((e=>{"auto"===e&&(e="");const n=e?Ml.Z.getTranslationCode(e.toString()):"",i=Ml.Z.getTranslationCode(this.state.targetLanguage);d.Z.utilities.translateText(n,i,[t],(e=>{if(this._isMounted){if("no_error"!==e.error){this.setState({showPlaceholder:!1});let t="system";"unknown_language"===e.error?t="unknownLangServer":n&&(t="noDetect"),this._setError(t)}else{const t={id:"",srcItem:{code:e.detectedSourceLanguage,text:e.sourceText[0]},translatedItem:{code:i,text:e.translatedText[0]}};this._addToHistory(t)}this._idleId&&clearTimeout(this._idleId),this._idleId=setTimeout(this._idleEnds,1e3)}}))}))};_idleEnds=()=>{if(this._idleId&&clearTimeout(this._idleId),this._pending){const e=this._pending.lang,t=this._pending.text;this._pending=void 0,this.setState({busy:!1,srcText:t},(()=>{this._onTranslate(e)}))}else this.setState({busy:!1})};_errorEnds=()=>{this._errorId&&clearTimeout(this._errorId),this._setError("none")};_addToHistory=e=>{z.ZP.isIncognitoOrGuest(this.context.vivaldiWindowId)?(this.setState({translatedText:e.translatedItem.text,showPlaceholder:!1}),this._setError("none")):d.Z.translateHistory.add(e,0).then((t=>{const n=y.Z.runtime.lastError;n&&console.error(n.message),this.setState({translatedText:e.translatedItem.text,showPlaceholder:!1}),this._setError("none")}))};_onItemActivated=e=>{const t=this._getItemById(e);t&&this.setState({viewMode:"main"},(()=>{this.setState({srcLanguage:t.srcItem.code,targetLanguage:t.translatedItem.code,srcText:t.srcItem.text,translatedText:t.translatedItem.text,showPlaceholder:!1})}))};_onItemsDelete=e=>d.Z.translateHistory.remove(e).then((()=>Promise.resolve()));_onClearHistory=()=>{d.Z.translateHistory.reset(0)};_onClearText=()=>{this._pending=void 0,this.setState({srcText:"",translatedText:""})};_onSwapLanguage=()=>{"auto"!==this.state.srcLanguage&&this.setState((e=>{const t=e.translatedText.length>0;return{srcLanguage:e.targetLanguage,targetLanguage:e.srcLanguage,srcText:t?e.translatedText:e.srcText,translatedText:t?e.srcText:e.translatedText}}))};_onItemsCopy=(e,t,n)=>{const i=t.map((e=>this._getItemById(e))).filter(Boolean),s=[];i.forEach((e=>{n&&s.push(e.srcItem.text),s.push(e.translatedItem.text)})),e.clipboardData&&(e.clipboardData.setData("text/plain",s.join("\r\n")),e.stopPropagation(),e.preventDefault())};_setError=e=>{"none"===e?"none"!==this.state.error&&(document.removeEventListener("keydown",this._onKeyDownMonitor),this._errorId&&clearTimeout(this._errorId)):"none"===this.state.error&&(document.addEventListener("keydown",this._onKeyDownMonitor),this._errorId&&clearTimeout(this._errorId),this._errorId=setTimeout(this._errorEnds,3e3)),this._isMounted&&this.setState({error:e})};_errorMessage=e=>{switch(e){case"unknownLangServer":return(0,le.Z)("Translation failed. Server could not determine the language.");case"noDetect":return(0,le.Z)("Translation failed. Try selecting another language.");case"system":return(0,le.Z)("Translation failed.");default:return""}};_onCopyText=()=>{const e=e=>{e.clipboardData&&(e.clipboardData.setData("text/plain",this.state.translatedText),e.stopPropagation(),e.preventDefault())};document.addEventListener("copy",e),document.execCommand("copy"),document.removeEventListener("copy",e)};_renderToolbar=()=>{if("main"===this.state.viewMode){const e=[{id:"auto",name:(0,le.Z)("Automatic Detection")}].concat(this.state.languages).map((e=>cne("option",{value:e.id},e.id,e.name))),t=this.state.languages.map((e=>cne("option",{value:e.id},e.id,e.name)));return cne("div",{className:"TranslatePanel-FromTo toolbar toolbar-default"},void 0,cne("select",{autoFocus:!0,value:this.state.srcLanguage,onChange:this._onSourceLanguageSelected},void 0,e),cne("input",{type:"button",style:{paddingLeft:6,paddingRight:6},value:"⇆",disabled:"auto"===this.state.srcLanguage,onClick:this._onSwapLanguage}),cne("select",{value:this.state.targetLanguage,onChange:this._onTargetLanguageSelected},void 0,t))}return cne("div",{className:"toolbar toolbar-default toolbar-wrap"},void 0,cne("input",{type:"button",onClick:()=>this.setState({viewMode:"main"}),value:(0,le.Z)("navigation","Back")}),cne("input",{type:"button",className:"danger",onClick:this._onClearHistory,value:(0,le.Z)("Clear Translate History")}))};_renderMain=()=>{const e=!this.state.busy&&Ml.Z.canTranslateText(this.state.srcText);return cne("div",{className:"TranslatePanel"},void 0,cne("div",{className:"TranslatePanel-Content"},void 0,cne("textarea",{className:"TranslatePanel-SrcText",type:"text",value:this.state.srcText,placeholder:(0,le.Z)("Enter text to translate"),onChange:this._onSrcEditChanged,onKeyDown:this._onKeyDown,onPaste:this._onPaste,autoFocus:!this.state.srcText}),"none"!==this.state.error&&cne("div",{onPointerDown:()=>this._setError("none")},void 0,cne(Tr,{type:"system"===this.state.error?"error":"warning"},void 0,this._errorMessage(this.state.error))),cne(rne,{text:this.state.translatedText,showPlaceholder:this.state.showPlaceholder})),cne("div",{className:"TranslatePanel-BottomToolbar"},void 0,cne("input",{type:"submit",disabled:!e,autoFocus:e,value:(0,le.Z)("verb","Translate")}),cne("input",{type:"button",title:(0,le.Z)("Copy translation"),value:(0,le.Z)("verb","Copy"),onClick:this._onCopyText,disabled:!this.state.translatedText}),cne("input",{type:"button",className:"clear",onClick:this._onClearText,value:(0,le.Z)("Clear")})),cne("div",{className:"TranslatePanel-CheckboxArea"},void 0,cne("label",{},void 0,cne("input",{type:"checkbox",checked:this.state.autoTranslate,onChange:this._toggleAutoTranslate}),cne("span",{},void 0,(0,le.Z)("Auto-translate selected text")))),cne("div",{className:"TranslatePanel-ShowTranslateHistory"},void 0,cne("input",{type:"button",onClick:()=>this.setState({viewMode:"history"}),value:(0,le.Z)("Show Translate History")}),cne("span",{className:"credits"},void 0,(0,le.Z)("Powered by Lingvanex, hosted by Vivaldi."))))};_renderHistory=()=>cne("div",{className:"TranslatePanel TranslatePanel-History"},void 0,cne(ine,{nodes:this.state.history,languages:this.state.languages,onActivated:this._onItemActivated,onItemsCopy:this._onItemsCopy,onItemsDelete:this._onItemsDelete}));render(){return this.props.open?cne("div",{className:"panel",id:"translate-panel"},void 0,cne("header",{},void 0,cne(Rp,{title:this.props.title})),cne("form",{className:"main"===this.state.viewMode?"Translate-Main-Form":"Translate-History-Form",onSubmit:this._onTranslateFromButton},void 0,this._renderToolbar(),"main"===this.state.viewMode&&this._renderMain()),"history"===this.state.viewMode&&this._renderHistory()):null}}const une=(0,fs.Z)(pne,[]),gne="vivaldiStartDragging",mne="vivaldiEndDragging",vne="webPanelTitleChanged";var fne;function yne(e,t,n,i){fne||(fne="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:fne,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const wne={contentload:"handleContentLoad",dialog:"handleDialog",loadabort:"handleAbort",loadstop:"handleLoadStop",newwindow:"handleNewWindow",permissionrequest:"handleOnPermissionRequest",targeturlchanged:"handleTargetURLChanged"};var bne=yne(mp,{type:"close",size:16});class Cne extends tn.PureComponent{static contextType=dn.Z;nodeRef=tn.createRef();refWebpanelwebview=tn.createRef();winId=this.context.vivaldiWindowId;state={title:(0,le.Z)("Loading..."),tooltip:void 0,canGoBack:!1,canGoForward:!1,canReload:!1};_lookupFavicon=!0;componentDidMount(){const e=this.refWebpanelwebview.current;e&&(this.props.webPanel.mobileMode&&e.setUserAgentOverride(this.getMobileUAString()),this.attachWebViewEventHandlers(e),e.src=this.props.webPanel.url),Dl.ZP.addListener(this.onPanelStoreChange),H.Z.addListener(this._alarmsChanged)}componentWillUnmount(){const e=this.refWebpanelwebview.current;e&&this.removeWebViewEventHandlers(e),Dl.ZP.removeListener(this.onPanelStoreChange),H.Z.removeListener(this._alarmsChanged)}attachWebViewEventHandlers=e=>{Object.keys(wne).forEach((t=>{e.addEventListener(t,this[wne[t]])}))};removeWebViewEventHandlers=e=>{Object.keys(wne).forEach((t=>{e.removeEventListener(t,this[wne[t]])}))};_alarmsChanged=e=>{const t=e?.find((e=>e&&"RELOAD"===e.type&&this.props.webPanel.id.endsWith(e.id)));t&&this.reload()};componentDidUpdate(e){const t=this.refWebpanelwebview.current;this.props.webPanel.mobileMode!==t?.isUserAgentOverridden()&&(this.props.webPanel.mobileMode?t?.setUserAgentOverride(this.getMobileUAString()):t?.setUserAgentOverride(navigator.userAgent),this.home()),this.props.focusContent&&document.activeElement&&(document.activeElement.blur(),this.refWebpanelwebview.current?.focus())}onPanelStoreChange=(e,t)=>{e===this.winId&&this.props.isVisible&&"setFocus"===t&&document.activeElement&&!ss(this.nodeRef.current)&&(document.activeElement.blur(),this.refWebpanelwebview.current?.focus())};getMobileUAString=()=>{let e=navigator.userAgent;const t=e.indexOf("("),n=e.indexOf(")",t);return t>=0&&n>t&&(e=e.substr(0,t+1)+"Linux; Android 8.0.0; SM-G965F Build/R16NW"+e.substr(n)),e=e.replace("Safari","Mobile Safari"),e};handleNewWindow=async e=>{switch(e.windowOpenDisposition){case"current_tab":case"new_foreground_tab":e.preventDefault(),e.window.accept(this.winId+";1");break;case"new_background_tab":e.preventDefault(),e.window.accept(this.winId+";0");break;case"new_window":case"off_the_record":e.preventDefault(),Ru.Z.openBrowserWindow(this.winId,e.targetUrl,{incognito:"off_the_record"===e.windowOpenDisposition});break;case"new_popup":e.preventDefault()}};handleDialog=e=>{"confirm"===e.messageType||"prompt"===e.messageType?e.dialog.cancel():"alert"===e.messageType&&e.dialog.ok("")};handleTargetURLChanged=({newUrl:e})=>{const t=(0,_C.ZP)(e);X.Z.setStatus(this.context.vivaldiWindowId,t)};getFaviconHost=()=>{const e=_i.parse(this.refWebpanelwebview.current?.src??"");return e.protocol&&e.host?e.protocol+"//"+e.host+"/":""};handleLoadStop=e=>{const t=this.refWebpanelwebview.current;this.setState({canGoBack:t?.canGoBack(),canGoForward:t?.canGoForward(),canReload:!0});const n=this.refWebpanelwebview.current?.src??"";this.props.setWebPanelValue(this.props.webPanel.id,"activeUrl",n),this._lookupFavicon&&(setTimeout(this.onSetFaviconUrl.bind(this),1e3),this._lookupFavicon=!1),t?.setZoomMode("per-view"),t?.setZoom(1)};handleContentLoad=e=>{this.refWebpanelwebview.current?.executeScript({code:"document.title"},(e=>{if(Array.isArray(e)&&e.length>0&&"string"==typeof e[0]){const[t]=e;this.setState({title:t,tooltip:void 0}),this.props.setWebPanelValue(this.props.webPanel.id,"title",t)}})),this.refWebpanelwebview.current?.executeScript({code:"(function() {\n  var title = document.getElementsByTagName('title')[0];\n  if (title) {\n    title.addEventListener('DOMSubtreeModified', function (e) {\n      chrome.runtime.sendMessage({\n        action: 'webPanelTitleChanged',\n        panelUrl: document.URL,\n        title: document.title\n      });\n    }, false);\n  }\n})()"},(()=>{y.Z.runtime.lastError&&console.warn("listenForTitleChange:",y.Z.runtime.lastError)})),this.refWebpanelwebview.current?.executeScript({file:"inject-all-bundle.js"})};handleAbort=e=>{const t=(0,le.Z)("Aborted"),n=(0,le.Z)("Loading aborted with reason $1",[e.reason]);this.setState({title:t,tooltip:n})};onSetFaviconUrl=()=>{const e=this.refWebpanelwebview.current?.src??"";this.props.setWebPanelValue(this.props.webPanel.id,"faviconUrl",e)};reload=()=>{this.setState({title:(0,le.Z)("Loading..."),tooltip:void 0,canReload:!1}),this.refWebpanelwebview.current?.reload()};home=()=>{this.setState({title:(0,le.Z)("Loading..."),tooltip:void 0,canReload:!1});const e=this.refWebpanelwebview.current;e&&(e.src=this.props.webPanel.url)};back=()=>{this.refWebpanelwebview.current?.back()};forward=()=>{this.refWebpanelwebview.current?.forward()};setTitle=e=>{this.setState({title:e})};onContextMenu=e=>{e.persist(),e.preventDefault(),e.stopPropagation(),this.props.menuPromise(this.props.webPanel.id).then((t=>{(0,zi.Z)(this.winId,t)(e)}))};handleOnPermissionRequest=e=>{if(e.preventDefault(),"download"===e.permission)M.Z.get(D.kDownloadsStartAutomatically)?(e.request.allow(),M.Z.get(D.kDownloadsOpenPanelOnNew)&&((0,Io.P)("DownloadButton",this.context.vivaldiWindowId)?a.Z.executeActions(this.winId,"COMMAND_SHOW_DOWNLOADS_POPOUT"):Dl.ZP.canAutoOpen(this.winId,"downloads")&&Ho.Z.toggleContent(this.winId,"downloads"))):this.showDialog(e)};showDialog=e=>{const t=this.refWebpanelwebview.current;e.webview=t,e.dialogtype=e.permission,ie.Z.showDialog(this.context.vivaldiWindowId,e,null)};render(){const e=mn()({panel:!0,webpanel:!0,visible:this.props.isVisible});return(0,fn.jsxs)("div",{ref:this.nodeRef,className:e,children:[this.props.isVisible&&this.props.panelUI.showToolbar&&yne("header",{className:"webpanel-header",onContextMenu:this.onContextMenu},void 0,yne("div",{className:"toolbar toolbar-default full-width"},void 0,yne("h1",{className:"webpanel-title",title:this.state.tooltip||this.state.title},void 0,this.state.title),yne("div",{className:"toolbar toolbar-group"},void 0,this.props.panelUI.allControls?yne("div",{className:"button-toolbar"},void 0,yne("button",{className:"button-toolbar back",title:(0,le.Z)("navigation","Back"),onClick:this.back,disabled:!this.state.canGoBack,dangerouslySetInnerHTML:{__html:cn.mgF.medium}})):null,this.props.panelUI.allControls?yne("div",{className:"button-toolbar"},void 0,yne("button",{className:"button-toolbar forward",title:(0,le.Z)("navigation","Forward"),onClick:this.forward,disabled:!this.state.canGoForward,dangerouslySetInnerHTML:{__html:cn.Zu.medium}})):null,this.props.panelUI.allControls?yne("div",{className:"button-toolbar"},void 0,yne("button",{className:"button-toolbar reload",title:(0,le.Z)("Reload"),onClick:this.reload,disabled:!this.state.canReload,dangerouslySetInnerHTML:{__html:cn.GO5.medium}})):null,yne("div",{className:"button-toolbar"},void 0,yne("button",{className:"button-toolbar home",title:(0,le.Z)("Home"),onClick:this.home,disabled:!this.state.canReload,dangerouslySetInnerHTML:{__html:cn.PaK.medium}}))),yne("button",{className:"close transparent",onClick:()=>Ho.Z.togglePanel(this.context.vivaldiWindowId),tooltip:(0,le.Z)("Close Panel")},void 0,bne))),yne("section",{className:"webpanel-content"},void 0,(0,fn.jsx)("webview",{ref:this.refWebpanelwebview,name:"vivaldi-webpanel"}))]})}}const Sne=Cne;var Tne,Ine=n(63365);function kne(e,t,n,i){Tne||(Tne="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Tne,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var Ane=kne("g",{},void 0,kne("path",{d:"M1 1.5h3.5v-1h7v1h-8H15"}),kne("path",{d:"M3.5 3.5v11h9v-11zm3 8v-4zm3 0v-4z"})),Zne=kne("g",{},void 0,kne("path",{d:"M1.5,1.5 L1.5,9.5"}),kne("path",{d:"M9.5,1.5 L9.5,9.5"}),kne("path",{d:"M1.5,9.5 L9.5,9.5"}),kne("path",{d:"M1.5,1.5 L9.5,1.5"}),kne("path",{d:"M3.5,9.5 L3.5,11.5"}),kne("path",{d:"M11.5,3.5 L11.5,11.5"}),kne("path",{d:"M3.5,11.5 L11.5,11.5"}),kne("path",{d:"M9.5,3.5 L11.5,3.5"}),kne("path",{d:"M5.5,11.5 L5.5,13.5"}),kne("path",{d:"M13.5,5.5 L13.5,13.5"}),kne("path",{d:"M5.5,13.5 L13.5,13.5"}),kne("path",{d:"M11.5,5.5 L13.5,5.5"})),Ene=kne("g",{transform:"translate(3, 2)"},void 0,kne("polygon",{points:"2.5 5.5 6.5 9.5 7.5 9.5 7.5 5.5 11.5 2.5 9.5 0.5 6.5 4.5 2.5 4.5"}),kne("polygon",{points:"0 12 3 8 4 9"})),_ne=kne("polygon",{points:"16.5 3.5 16.5 0.5 1.5 0.5 1.5 3.5"}),Nne=kne("path",{d:"M1.5,3.5 L1.5,12.5"}),Mne=kne("path",{d:"M16.5,3.5 L16.5,12.5"}),Pne=kne("path",{d:"M1.5,12.5 L16.5,12.5"}),Dne=kne("path",{d:"M4.5,0.5 L4.5,3.5"}),xne=kne("path",{d:"M7.5,0.5 L7.5,3.5"}),One=kne("polygon",{points:"4.5 6.5 4.5 8.5 7.5 6.5",strokeWidth:"2"});class Lne extends tn.Component{render(){return kne("svg",{width:"16",height:"16",viewBox:"0 0 16 16",className:mn()({"folder-icon":!this.props.trash,"folder-trash":this.props.trash}),style:this.props.leftMargin?{marginLeft:this.props.leftMargin}:null},void 0,this.props.trash&&Ane,this.props.stack&&Zne,this.props.pinnedFolder&&Ene,!this.props.pinnedFolder&&!this.props.stack&&!this.props.trash&&kne("g",{transform:"translate(-1, 1)"},void 0,_ne,Nne,Mne,Pne,Dne,xne,this.props.activeWindow&&One))}}const Rne=Lne;var Bne=n(20349);const Fne=function(e,t){y.Z.tabs.query({},(n=>{const i=(0,fa.l4)(n.map((e=>JSON.parse(e.vivExtData||"{}").group)).filter(Boolean)),s=M.Z.get(D.kTabsStackingNameMap)||{},o=(0,Bne.default)(s,((e,t)=>i.includes(t)));t?o[e]=t:delete o[e],nt.Z.set(D.kTabsStackingNameMap,o)}))};var Une,Vne=n(42578),Wne=n(34155);function Hne(e,t,n,i){Une||(Une="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Une,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const zne=[D.kPanelsShowFolderBadge,D.kPanelsWindowDragToStack,D.kPanelsWindowSingleClickOpens,D.kPanelsWindowShowPinnedGroup,D.kTabsAutoMuting,D.kTabsDimHibernated,D.kTabsShowCloseButton,D.kTabsStackingMode,D.kTabsStackingNameMap,D.kTabsUnread,D.kThemeUseAnimation],Gne="root",$ne="trash",Kne="vivaldi/x-window-item";var jne=Hne("g",{transform:"translate(2, 2)"},void 0,Hne("polygon",{points:"2.5 5.5 6.5 9.5 7.5 9.5 7.5 5.5 11.5 2.5 9.5 0.5 6.5 4.5 2.5 4.5"}),Hne("polygon",{points:"0 12 3 8 4 9"}));class Yne extends tn.PureComponent{refTreeList=tn.createRef();static contextType=dn.Z;state={nodes:[]};expandModel={};blockPageStoreChange=!1;lastActivePinnedId="";centerDownId="";componentDidMount(){W.Z.addListener(this._onPageStoreChanged),Ine.Z.addListener(this._onTrashStoreChanged),this._onFilterChange(this.props.filter,Tl.default)}componentWillUnmount(){W.Z.removeListener(this._onPageStoreChanged),Ine.Z.removeListener(this._onTrashStoreChanged)}componentDidUpdate(e){if(this.props.filter!==e.filter){const t=this.props.filter.length,n=e.filter.length;0===n&&t>0&&this.refTreeList.current&&(this.expandModel=this.refTreeList.current.getExpandModel()),this._onFilterChange(this.props.filter,(e=>{t>0?Wne.nextTick((()=>{this.refTreeList.current?.expandAllExcept(e)})):n>0&&0===t&&Wne.nextTick((()=>{this.refTreeList.current?.expandWithModel(this.expandModel)}))}))}else(this.props.prefValues[D.kThemeUseAnimation]!==e.prefValues[D.kThemeUseAnimation]||this.props.prefValues[D.kTabsStackingMode]!==e.prefValues[D.kTabsStackingMode]||this.props.prefValues[D.kTabsUnread]!==e.prefValues[D.kTabsUnread]||this.props.prefValues[D.kTabsStackingNameMap]!==e.prefValues[D.kTabsStackingNameMap]||this.props.prefValues[D.kPanelsWindowShowPinnedGroup]!==e.prefValues[D.kPanelsWindowShowPinnedGroup]||this.props.sorting!==e.sorting&&"manually"===this.props.sorting.sortField)&&Wne.nextTick((()=>{const e="off"===this.props.prefValues[D.kTabsStackingMode];this.setState({nodes:this._getNodes(e)})}))}focusTree=()=>{this.refTreeList.current?.focusTree()};_onPageStoreChanged=()=>{!1===this.blockPageStoreChange&&this._onFilterChange(this.props.filter,Tl.default);const e=W.Z.getActivePage(this.context.vivaldiWindowId);e&&e.pinned&&(this.lastActivePinnedId=e.id.toString())};_onTrashStoreChanged=()=>{this._onFilterChange(this.props.filter,Tl.default)};_getFavicon=e=>St.jk.getFaviconWithFallback(e.url||"",e.favIconUrl||"");_getNodes=(e=!1)=>{e||(e="off"===this.props.prefValues[D.kTabsStackingMode]);const t=function(e){return e&&e.startsWith("www.")?e.substring(4):e},n=e=>{const n=_i.parse(e.url).hostname||"";return{page:e,hostname:n,url:e.url,domain:t(n),faviconUrl:this._getFavicon(e),useDefaultIcon:W.Z.useDefaultIcon(e),active:W.Z.isActivePage(e.windowId,e.id)}},i=(e,t,i,s,o)=>{let a=s;const r=e.flatMap(((e,i)=>{if("tab"===e.type){return[{id:e.id.toString(),type:"tab",parentId:t,title:St.jk.getDisplayTitle(e.page),index:i,pageIndex:a++,wid:o,pageItem:n(e.page)}]}return"group"===e.type?[{id:e.id,type:"stack",parentId:t,title:this.props.prefValues[D.kTabsStackingNameMap][e.id]||e.page.title,index:i,pageIndex:a,wid:o,children:e.pages.map(((t,i)=>({id:t.id.toString(),type:"tab",parentId:e.id,title:St.jk.getDisplayTitle(t),index:i,pageIndex:a++,wid:o,pageItem:n(t)}))).toArray()}]:[]}));return[r.toArray(),a]},s=[this.context.vivaldiWindowId].map(((t,n)=>{let s=0;const o=W.Z.getTabs(t,e),a=this.props.prefValues[D.kPanelsWindowShowPinnedGroup],r=a?o.filter((e=>e.page.pinned)):(0,fa.aV)(),l=a?o.filter((e=>!e.page.pinned)):o,d=`window-${t}`,c=[];if(!r.isEmpty()){const e=`pinned-${t}`,[n,o]=i(r,e,0,s,t);s+=o,c.push({id:e,type:"pinned",parentId:d,title:(0,le.Z)("title","Pinned Tabs"),index:0,pageIndex:s,wid:t,children:n})}const[h]=i(l,d,c.length,s,t),p=W.Z.getActivePage(t);return{id:d,type:"window",parentId:Gne,title:(0,le.Z)("title","Window")+" - "+(p?St.jk.getDisplayTitle(p):""),index:n,pageIndex:0,wid:t,children:[...c,...h]}})),o=(e,n,i)=>{const s=_i.parse(n.url||"").hostname||"";return{id:n.sessionId,parentId:e,type:"trash",index:i,title:St.jk.getDisplayTitle(n),wid:this.context.vivaldiWindowId,pageIndex:0,trashItem:{tab:{handle:n,url:n.url,hostname:s,domain:t(s),faviconUrl:this._getFavicon(n),useDefaultIcon:!1}}}},a={id:$ne,type:"trash",parentId:Gne,title:(0,le.Z)("title","Closed Tabs"),index:s.length,pageIndex:0,wid:this.context.vivaldiWindowId,children:Ine.Z.getTrash().map(((e,t)=>{if(e.tab)return o($ne,e.tab,t);if(e.window&&e.window.tabs&&e.window.sessionId){const n=e.window,i=e.window.tabs,s=e.window.sessionId;return{id:s,parentId:$ne,type:"trash",index:t,title:(0,le.Z)("Window with $1 Tab","Window with $1 Tabs",[i.length]),wid:this.context.vivaldiWindowId,pageIndex:0,trashItem:{window:{handle:n}},children:i.map(((e,t)=>o(s,e,t)))}}})).filter(Boolean)};return this._getRootNode([...s,a]).children||[]};_getRootNode=e=>({id:Gne,parentId:"",type:"root",title:"",index:0,pageIndex:0,wid:this.context.vivaldiWindowId,children:e});_getChildren=e=>e?.children??[];_getPageIndex=e=>e.pageIndex;_getFilteredTree=(e,t)=>{const n=function(e,t,n){let i=!1;return e.pageItem&&!1!==n.url&&(i=e.pageItem.url.includes(t)),i||!1===n.title||(i=e.title.toLowerCase().includes(t)),i},i=function(e,t,s,o,a){let r=!1;for(let l=0;l<e.length;l++){const d=e[l];let c=!1;if(d.children){const e={...d,children:[]};i(d.children,e.children,s,o,a)&&(t.push(e),r=!0,c=!0)}if(!c&&n(d,o,a)){const e={...d};t.push(e),d.children&&s.push(d),r=!0}}return r},s=[],o=[];return i(this._getNodes(),s,o,e.toLowerCase(),t),{nodes:s,collapsed:o}};_onFilterChange=(e,t)=>{if(e&&e.length>0){const n={url:!0,title:!0},i=this._getFilteredTree(e,n);this.setState({nodes:i.nodes},t(i.collapsed))}else this.setState({nodes:this._getNodes()},t([]))};getSelectedItem=()=>this.refTreeList.current?.getSelectedItem();getSelectedItems=()=>this.refTreeList.current?.getAllSelectedItems()||[];unSelectAll=()=>{this.refTreeList.current?.unSelectAll()};_isTrashFolder=e=>"trash"===e.type&&!e.trashItem;_isPinnedFolder=e=>"pinned"===e.type;_getSelectedBackgroundPages=()=>{const e=this.getSelectedItems(),t=e.map((e=>"window"===e.type?e:void 0)).filter(Boolean);return t.length>0?t.flatMap((e=>e.children||e)).flatMap((e=>e.children||e)).map((e=>e.pageItem)).filter(Boolean).filter((e=>e.page!==W.Z.getActivePage(e.wid))).map((e=>e.page)):e.flatMap((e=>e.children||e)).map((e=>e.pageItem)).filter(Boolean).filter((e=>e.page!==W.Z.getActivePage(e.wid))).map((e=>e.page))};_getDiscardablePages=()=>this._getSelectedBackgroundPages().filter((e=>!e.discarded&&!e.isInspected));_getStackableSelectedNodes=()=>{let e=this.getSelectedItems();if(1===e.length&&"stack"===e[0].type)return[];return e=e.filter((e=>"tab"===e.type||"stack"===e.type)).map((e=>e.children||e)).reduce(((e,t)=>e.concat(t)),[]).filter((e=>e.pageItem&&!e.pageItem.page.pinned)),(e=>{const t=[];return e.forEach((e=>{e.pageItem&&-1===t.findIndex((t=>e.wid))&&t.push(e.wid)})),t})(e).length>1?[]:e};_getStackableNodesForHost=(e,t)=>this.state.nodes.filter((t=>"window"===t.type&&t.wid===e)).flatMap((e=>e.children||e)).filter((e=>e.pageItem&&!e.pageItem.page.pinned&&e.pageItem.hostname===t.hostname));_getTileableSelectedNodes=()=>{const e=this.getSelectedItems();if(1===e.length&&"stack"===e[0].type){const t=new Map,n=this._getChildren(e[0]);for(let e=0;e<n.length;e++){const i=n[e].pageItem,s=i?(0,uv.jA)(i.page):void 0;if(void 0===s){t.clear();break}t.set(s,"")}if(1===t.size)return[]}return this._filterNodesToTabs().filter((e=>void 0!==e.pageItem))};_filterNodesToTabs=()=>this.getSelectedItems().filter((e=>"tab"===e.type||"stack"===e.type||"pinned"===e.type)).flatMap((e=>e.children||e));_getSelectedTilingItems=()=>this._filterNodesToTabs().map((e=>{const t=e.pageItem?(0,uv.jA)(e.pageItem.page):void 0;return t?{node:e,tid:t}:void 0})).filter(Boolean).filter(((e,t,n)=>n.indexOf(e)===t));_getNodesWithMediaState=(e,t)=>{let n=[];return"selection"===t?n=this.getSelectedItems():"all"===t?n=this.state.nodes:"active"===t&&(n=this.state.nodes.filter((e=>Boolean(e.pageItem&&e.pageItem.page.active)))),n.filter((e=>"window"===e.type||"tab"===e.type||"stack"===e.type||"pinned"===e.type)).map((e=>e.children||e)).reduce(((e,t)=>e.concat(t)),[]).map((e=>e.children||e)).reduce(((e,t)=>e.concat(t)),[]).filter((t=>{const n=t.pageItem?.page;return n&&F5.hasMediaState(n.id,e)&&!n.discarded}))};_getMuteableNodesFrom=e=>this._getNodesWithMediaState("playing",e);_muteOthers=e=>{if(e.pageItem)Y.Z.muteAllExcept(e.wid,[e.pageItem.page]);else{const t=this._getChildren(e).map((e=>e.pageItem?.page)).filter(Boolean);Y.Z.muteAllExcept(e.wid,t)}};_getPlayableNodesFrom=(e,t)=>{const n=this._getNodesWithMediaState("muting",e),i=t.pageItem?.page;switch(this.props.prefValues[D.kTabsAutoMuting]){case"onlyActive":return n.filter((e=>{const t=e.pageItem?.page;return Boolean(t&&t===i&&t.active)}));case"prioritizeActive":{const e=W.Z.getActivePage(t.wid);if(e&&F5.hasMediaState(e.id,"playing"))return[];if(n.length>1)return n.filter((e=>{const t=e.pageItem?.page;return Boolean(t&&t===i)}))}}return n};_isUnread=e=>!(!this.props.prefValues[D.kTabsUnread]||!e.pageItem?.page)&&W.Z.isUnread(e.pageItem.page);_isInStackFolder=e=>"stack"===e.type||Boolean(e.pageItem&&(0,uv.av)(e.pageItem.page));_isInTrashFolder=e=>"trash"===e.type||Boolean(e.trashItem);_isInPinnedFolder=e=>"pinned"===e.type||Boolean(e.pageItem?.page.pinned);_isWithinFolder=(e,t)=>{if(this._isFolder(e)){const n=Boolean(this.refTreeList.current?.isExpanded(e.id));return"on"===t||n&&"below"===t}return void 0!==e.parentId};_getStackFolderByNode=e=>{let t=e;return t.pageItem&&(t=this._getNodeById(t.parentId)),"stack"===t?.type?t:void 0};_getPageByNode=e=>{if("stack"===e.type){const t=this._getChildren(e);return t.length>0?t[0].pageItem?.page:void 0}return e.pageItem?.page};_getPageIdByNode=e=>this._getPageByNode(e)?.id;_getNodeById=e=>{const t=n=>{for(let i=0;i<n.length;i++){let s=n[i];if(s.id===e)return s;if(s.children&&(s=t(s.children),s))return s}};return e===Gne?this._getRootNode(this.state.nodes):t(this.state.nodes)};_getNodeByParentAndIndex=(e,t)=>{const n=this._getNodeById(e);return n&&n.children&&n.children.length>0?(t<0?t=0:t>=n.children.length&&(t=n.children.length-1),n.children[t]):n};_indexExceedsChildCount=(e,t)=>{const n=this._getNodeById(e);return Boolean(n&&t>=this._getChildren(n).length)};_hasChildren=e=>Boolean(e.children&&e.children.length>0);_isFolder=e=>Boolean(e.children);expandAll=()=>{this.refTreeList.current?.expandAll()};_onNodeClick=(e,t)=>{vn.Z.isNoModifierPressed(e)&&e.button===vn.Z.kLeft&&this.props.prefValues[D.kPanelsWindowSingleClickOpens]&&this._onNodesActivated(e,[t])};_onNodeMouseDown=(e,t)=>{vn.Z.isNoModifierPressed(t)&&t.button===vn.Z.kCenter&&(this.centerDownId=e.id)};_onNodeMouseUp=(e,t)=>{vn.Z.isNoModifierPressed(t)&&t.button===vn.Z.kCenter&&this.centerDownId===e.id&&e.pageItem&&!e.pageItem.page.pinned&&this._closeWithId(e.id),this.centerDownId=""};_onNodeDoubleClick=(e,t)=>{e.button!==vn.Z.kLeft||this.props.prefValues[D.kPanelsWindowSingleClickOpens]||this._onNodesActivated(e,[t])};_onNodesActivated=(e,t)=>{const n=t[0];if(n.trashItem)n.trashItem.tab?j7.Z.undeleteTab(n.trashItem.tab.handle):n.trashItem.window&&j7.Z.undeleteWindow(n.trashItem.window.handle);else if(n.pageItem)Y.Z.activateTab(n.pageItem.page.id,n.wid);else if(this._isPinnedFolder(n)){let e=this._getNodeById(this.lastActivePinnedId);!e&&n.children&&n.children.length>0&&(e=n.children[0]),e?.pageItem&&Y.Z.activateTab(e.pageItem.page.id,e.wid)}};_closeByIds=e=>{let t=e.map((e=>this._getNodeById(e))).filter(Boolean);const n=t.filter((e=>"stack"===e.type)),i=n.map((e=>e.children)).filter(Boolean).reduce(((e,t)=>e.concat(t)),[]);return t=t.filter((e=>"stack"!==e.type)).filter((e=>-1===i.findIndex((t=>t.id===e.id)))),n.forEach((e=>{const t=this._getPageIdByNode(e);"number"==typeof t&&Y.Z.closeTabStack(t)})),Y.Z.closePage((0,fa.aV)(t.map((e=>e.pageItem?.page)).filter(Boolean))),Promise.resolve([])};_getPagesByIds=e=>{const t=[];return e.map((e=>this._getNodeById(e))).filter(Boolean).forEach((e=>{e.pageItem?t.push(e.pageItem.page):e.children&&("window"===e.type?Array.prototype.push.apply(t,this._getChildren(e).map((e=>e.children||e)).reduce(((e,t)=>e.concat(t)),[]).map((e=>e.pageItem?.page)).filter(Boolean)):Array.prototype.push.apply(t,this._getChildren(e).map((e=>e.pageItem?e.pageItem.page:void 0)).filter(Boolean)))})),t};_saveBookmarkByIds=e=>{0===e.length?i.Z.bookmarkAllOpenPages(this.context.vivaldiWindowId,en.ZP.getRootNode().id):i.Z.bookmarkPages((0,fa.aV)(this._getPagesByIds(e)),this.context.vivaldiWindowId,!1,en.ZP.getRootNode().id)};_saveSessionByIds=e=>{const t=this.context.vivaldiWindowId;if(0===e.length)ie.Z.showSaveSessionDialog(t,{mode:"all"});else{const n=this._getPagesByIds(e).map((e=>e.id));n.length>0&&ie.Z.showSaveSessionDialog(t,{mode:"selected",ids:n})}};_handleExpandClick=(e,t)=>{(0,Cs.Z)(e),this.refTreeList.current?.toggleSelectedExpansion(t)};_validateForDrag=e=>e.map((e=>this._getNodeById(e))).filter(Boolean).filter((e=>"window"!==e.type&&!this._isPinnedFolder(e)&&!this._isTrashFolder(e))).map((e=>e.id));_getDragData=(e,t)=>{const n=t.map((e=>this._getNodeById(e))).filter(Boolean);if("text/plain"===e){return n.map((e=>e.pageItem?e.pageItem.url:e.trashItem?.tab?e.trashItem.tab.url:e.title)).join("\r\n")}if("text/uri-list"===e){return n.map((e=>e.pageItem?e.pageItem.url:e.trashItem?.tab?.url||"")).filter(Boolean).join("\r\n")}return""};_setCustomDragData=(e,t)=>{const n=t.map((e=>this._getNodeById(e))).filter(Boolean),i=n.map((e=>Boolean(e.trashItem))),s=n.map((e=>Boolean(e.pageItem?.page.pinned)));i.filter((e=>!0===e)).length>0&&e.setData("vivaldi/x-tab-closed",JSON.stringify(i)),s.filter((e=>!0===e)).length>0&&e.setData("vivaldi/x-tab-pinned",JSON.stringify(s))};_getDropSupport=(e,t)=>{const n={available:!1,onto:!1,edge:!0};if(-1!==t.dataTransfer.types.findIndex((e=>"vivaldi/x-tab-closed"===e)))return n.available=!this._isInTrashFolder(e),n.onto=n.available&&this._canDropOnto(e,t),n;if(-1!==t.dataTransfer.types.findIndex((e=>"vivaldi/x-tab-pinned"===e))){if(!this.props.prefValues[D.kPanelsWindowShowPinnedGroup])return n.available=Boolean(e.pageItem?.page.pinned),n.onto=n.available&&this._canDropOnto(e,t),n;if(this._isInTrashFolder(e))return n}return(t.dataTransfer.types.includes("text/plain")||t.dataTransfer.types.includes("text/uri-list"))&&(t.dataTransfer.types.includes(Kne)?n.available=!0:n.available=!this._isInTrashFolder(e),n.onto=n.available&&this._canDropOnto(e,t)),n};_canDropOnto=(e,t)=>!!this._isFolder(e)||!(t.dataTransfer.types.includes(Kne)&&(!this.props.prefValues[D.kPanelsWindowDragToStack]||this._isInPinnedFolder(e)||this._isInStackFolder(e)))&&!this._isInTrashFolder(e);_getDropIndexByNode=(e,t)=>{let n=0;if(e.pageItem){const i=e.pageItem.page.id;n=W.Z.getTabs(e.wid,!0).findIndex((e=>e.page.id===i)),"below"===t&&(n+=1)}else if(e.children){const i=this._getChildren(e);if(i.length>0){if("above"===t||"below"===t){const e=i[0];if(e.pageItem){const t=e.pageItem.page.id;n=W.Z.getTabs(e.wid,!0).findIndex((e=>e.page.id===t))}}"below"===t&&(n+=1)}}return n};_onDrop=(e,t,n)=>{const i=e.dataTransfer.getData("text/uri-list").split("\n").map((e=>e));if(i.length>0)if("on"===n&&t.pageItem)Y.Z.openURL(t.wid,i[0],{inCurrent:!0,inSpecificPageId:t.pageItem.page.id});else{const e=this._getTargetSpec(t,n),s=this._getDropIndexByNode(t,n),o=t.wid,a=this._getStackFolderByNode(t);Y.Z.newTab(o,i[0],s).then((i=>{const s=W.Z.getPages(o).find((e=>e.id===i));if(this._isWithinFolder(t,n))if(this._isInPinnedFolder(t))s&&Y.Z.setPinned(fa.aV.of(s),!0),s&&Y.Z.moveToIndex(s,e.pageIndex);else if(this._isInStackFolder(t)){const n=this._getPageByNode(t);if(n&&a){const t=this._getChildren(a).map((e=>e.pageItem?.page)).filter(Boolean);t.splice(e.index,0,s),Y.Z.createTabStack((0,fa.aV)(t.filter(Boolean)),this._getPageIndex(a),n.vivExtData.group)}}this.refTreeList.current?.selectById(i.toString())})).catch((e=>{console.warn(e)}))}return Promise.resolve([])};_onMove=(e,t,n,i)=>{const s=this._getNodeById(t);if(!s)return Promise.resolve([]);"stack"===s.type&&"on"===i&&(i="below",n=this._getChildren(s).length);let o=this._getNodeByParentAndIndex(t,n);if(!o)return Promise.resolve([]);if(this._isTrashFolder(o)&&"above"===i){const e=this.state.nodes.filter((e=>"window"===e.type)),t=0===e.length?void 0:e[e.length-1];if(!t||!t.children)return Promise.resolve([]);(n=t.children.length)>0&&(o=t.children[n-1])}const a=e.map((e=>this._getNodeById(e))).filter(Boolean).map((e=>e.children||e)).reduce(((e,t)=>e.concat(t)),[]).map((e=>this._getPageByNode(e))).filter(Boolean),r=e.filter((e=>W.Z.isGroup(e,this.context.vivaldiWindowId))),l=this._indexExceedsChildCount(t,n);let d=this._getPageByNode(o);d||(d=this._isInPinnedFolder(s)?W.Z.getTabs(s.wid,!1).find((e=>e.page.pinned))?.page??null:W.Z.getTabs(s.wid,!1).find((e=>!e.page.pinned))?.page??null);const c=this._getNodeById(e[0]);if(!c)return Promise.resolve([]);if(this._isInTrashFolder(o))return this._closeByIds(e),Promise.resolve([]);if(c.trashItem){return e.map((e=>this._getNodeById(e))).filter(Boolean).forEach((e=>{e.trashItem?.tab?j7.Z.undeleteTab(e.trashItem.tab.handle):e.trashItem?.window&&j7.Z.undeleteWindow(e.trashItem.window.handle)})),Promise.resolve([])}const h=d?d.vivExtData.group:"";if("stack"===s.type&&W.Z.isGroup(h,o.wid))Y.Z.treeMove({pages:a,groups:r,targetPage:d,after:l,area:"stack",group:h,windowId:c.wid});else if(this.props.prefValues[D.kPanelsWindowShowPinnedGroup]&&this._isInPinnedFolder(s))Y.Z.treeMove({pages:a,groups:r,targetPage:d,after:l,area:"pinned",windowId:c.wid});else if("on"===i&&this.props.prefValues[D.kPanelsWindowDragToStack]){if(d){const e=d.id,t=a.filter((t=>t.id!==e));let n=d.index,i=0;for(let e=0;e<t.length;e++){n>t[e].index&&i++}n-=i,t.splice(0,0,d);const s=W.Z.getNewGroupId();Y.Z.createTabStack((0,fa.aV)(t),n,s),this.refTreeList.current?.selectById(s)}}else Y.Z.treeMove({pages:a,groups:r,targetPage:d,after:l,area:"regular",windowId:c.wid});return Promise.resolve([])};_onCopy=(e,t)=>{const n=e.clipboardData;if(n){const e=t.map((e=>this._getNodeById(e))).filter(Boolean).map((e=>e.pageItem?.url||e.trashItem?.tab?.url)).filter(Boolean).map((e=>St.jk.getHoverUrl(e))).join("\n");n.setData("text/plain",e),n.setData("text/uri-list",e)}e.preventDefault()};_isValidForClipboard=e=>Boolean(e.pageItem||e.trashItem?.tab);_isValidToDelete=e=>e.map((e=>this._getNodeById(e))).filter(Boolean).filter((e=>"window"!==e.type)).filter((e=>!this._isInPinnedFolder(e))).filter((e=>!this._isInTrashFolder(e))).map((e=>e.id));_getTargetSpec=(e,t)=>{const n={id:e.id,index:0,parentId:void 0,pageIndex:0},i=Boolean(this.refTreeList.current?.isExpanded(e.id));if(this._isFolder(e)&&("on"===t||i&&"below"===t))n.parentId=e.id,n.pageIndex=this._getPageIndex(e);else if(e.parentId){if(n.parentId=e.parentId,n.index=e.index+("below"===t?1:0),n.pageIndex=this._getPageIndex(e),"below"===t){const t=this._getChildren(e);!i&&t.length>0?n.pageIndex=this._getPageIndex(t[t.length-1]):n.pageIndex+=1}}else n.parentId=e.id,n.index=0;return n};_reload=()=>{const e=this.getSelectedItems().filter((e=>"window"===e.type)).map((e=>this._getChildren(e))).filter(Boolean).reduce(((e,t)=>e.concat(t)),[]).map((e=>e.children||e)).reduce(((e,t)=>e.concat(t)),[]),t=this.getSelectedItems().filter((e=>"stack"===e.type||"pinned"===e.type)).map((e=>this._getChildren(e))).filter(Boolean).reduce(((e,t)=>e.concat(t)),[]).filter((t=>-1===e.findIndex((e=>e===t.id)))),n=this.getSelectedItems().filter((e=>"tab"===e.type&&Boolean(e.pageItem))).filter((t=>-1===e.findIndex((e=>e===t.id)))).filter((e=>-1===t.findIndex((t=>t===e.id))));[e,t,n].forEach((e=>{const t=e.map((e=>e.pageItem?.page.id)).filter(Boolean);Y.Z.reloadPage((0,fa.aV)(t))}))};_tile=()=>{const e=this._getTileableSelectedNodes();e.length>1&&Y.Z.tilePages((0,fa.aV)(e.map((e=>e.pageItem?.page)).filter(Boolean)),"row")};_removeTile=()=>{this._getSelectedTilingItems().forEach((e=>{Y.Z.untileTileGroup(e.tid,e.node.wid)}))};_setMediaState=(e,t)=>{if("playing"===e){const e=this._getPlayableNodesFrom("selection",t).map((e=>e.pageItem?.page)).filter(Boolean);Y.Z.setMuting(t.wid,"selection","unmute",(0,fa.aV)(e))}else if("muting"===e){const e=this._getMuteableNodesFrom("selection").map((e=>e.pageItem?.page)).filter(Boolean);Y.Z.setMuting(t.wid,"selection","mute",(0,fa.aV)(e))}};newTab=e=>{Y.Z.newTab(e,"").then((e=>{this.refTreeList.current?.expandToId(e.toString()),this.refTreeList.current?.selectById(e.toString())})).catch((e=>{console.warn(e)}))};_newTabAfter=e=>{const t=this._getNodeById(e);if(!t)return;const n=this._getTargetSpec(t,"below"),i=this._getDropIndexByNode(t,"below");this.blockPageStoreChange=!0,Y.Z.newTab(t.wid,"",i).then((e=>{if(this._isWithinFolder(t,"below")){const i=W.Z.getPages(t.wid).find((t=>t.id===e));if(this._isInPinnedFolder(t)){const e=this._getPageIndex(t);i&&void 0!==e&&(Y.Z.setPinned(fa.aV.of(i),!0),Y.Z.moveToIndex(i,e))}else if(this._isInStackFolder(t)){const e=this._getPageByNode(t),s=this._getStackFolderByNode(t);if(e&&s){const t=this._getChildren(s).map((e=>e.pageItem?.page)).filter(Boolean);t.splice(n.index,0,i),Y.Z.createTabStack((0,fa.aV)(t.filter(Boolean)),this._getPageIndex(s),e.vivExtData.group)}}}this.blockPageStoreChange=!1,this._onPageStoreChanged(),this.refTreeList.current?.expandToId(e.toString()),this.refTreeList.current?.selectById(e.toString())})).catch((e=>{console.warn(e)}))};_cloneTab=()=>{const e=this.getSelectedItems().map((e=>e.pageItem?.page)).filter(Boolean);Y.Z.clonePages((0,fa.aV)(e))};_pinTab=()=>{const e=this.getSelectedItems().filter((e=>!this._isInStackFolder(e))).map((e=>e.pageItem?.page)).filter(Boolean).filter((e=>!e.pinned));Y.Z.setPinned((0,fa.aV)(e),!0)};_unpinTab=()=>{const e=this.getSelectedItems().map((e=>e.pageItem?.page)).filter(Boolean).filter((e=>e.pinned));Y.Z.setPinned((0,fa.aV)(e),!1)};_closeWithId=(e,t)=>{t&&(0,Cs.Z)(t);const n=this._getNodeById(e);if(n)if("tab"===n.type)this.refTreeList.current?.onDeleteItems([n.id]);else if("stack"===n.type){const e=this._getPageIdByNode(n);"number"==typeof e&&Y.Z.closeTabStack(e)}};_close=()=>{const e=this.getSelectedItems().filter((e=>"stack"===e.type)),t=e.map((e=>this._getChildren(e))).filter(Boolean).reduce(((e,t)=>e.concat(t)),[]),n=this.getSelectedItems().filter((e=>Boolean(e.pageItem))).filter((e=>-1===t.findIndex((t=>t===e.id))));this.blockPageStoreChange=!0;let i=e.map((e=>this._getPageByNode(e))).filter(Boolean);i.forEach((e=>{Y.Z.closeTabStack(e.id)})),i=n.map((e=>e.pageItem?.page)).filter(Boolean).filter((e=>!e.pinned)),Y.Z.closePage((0,fa.aV)(i)),this.blockPageStoreChange=!1,this._onPageStoreChanged()};_reopen=()=>{const e=this.getSelectedItems().filter((e=>Boolean(e.trashItem))),t=e.filter((e=>Boolean(e.trashItem?.window))),n=t.map((e=>window.trashitem?.window.children)).filter(Boolean).reduce(((e,t)=>e.concat(t)),[]),i=e.filter((e=>-1===n.findIndex((t=>t===e.id))));t.forEach((e=>{e.trashItem?.window&&j7.Z.undeleteWindow(e.trashItem.window.handle)})),i.forEach((e=>{e.trashItem?.tab&&j7.Z.undeleteTab(e.trashItem.tab.handle)}))};_createTabStack=()=>{this._createTabStackWithNodes(this._getStackableSelectedNodes())};_createTabStackForHost=(e,t)=>{const n=this._createTabStackWithNodes(t);n&&Fne(n,e)};_createTabStackWithNodes=e=>{if(e.length<2)return;let t=-1;for(let n=0;n<e.length;n++){let i=e[n];if(this._isInStackFolder(i)&&(i=this._getNodeById(i.parentId)),!i)return;{const e=this._getPageIndex(i);(-1===t||t>e)&&(t=e)}}const n=e.map((e=>e.pageItem?.page)).filter(Boolean);if(n.length<2)return;const i=W.Z.getNewGroupId();return Y.Z.createTabStack((0,fa.aV)(n),-1===t?0:t,i),this.refTreeList.current?.selectById(i),i};_disolveTabStack=()=>{const e=this.getSelectedItems(),t=e.filter((e=>"stack"===e.type)),n=t.map((e=>this._getPageByNode(e))).filter(Boolean);n.forEach((e=>{const t=(0,uv.av)(e);t&&Y.Z.expandTabStack(e.windowId,t)})),n.length>0&&e.length===t.length&&this.refTreeList.current?.selectById(n[0].id.toString())};_hibernate=()=>{this._getDiscardablePages().forEach((e=>{Y.Z.discardPage(e)}))};_reopenLastClosedTab=()=>{j7.Z.undeletePreviousTab()};_validateForEdit=e=>{const t=this._getNodeById(e);return!!t&&W.Z.isGroup(e,t.wid)};_getTitle=e=>this._getNodeById(e)?.title||"";_getMenuCapability=async(e,t,n)=>{const i=n?n.wid:this.context.vivaldiWindowId,s=n?.pageItem?.page,o="tab"===n?.type,a=o||"stack"===n?.type,r=a||"window"===n?.type,l=n&&this._isInTrashFolder(n),d={hostname:s?(0,Vne.q)(s):"",selectedCount:this._getStackableSelectedNodes().length};switch(e.action){case"CONTEXT_NEW":return{handler:()=>{n?this._newTabAfter(n.id):this.newTab(i)},visible:!n||!l,...t(i,e,d)};case"CONTEXT_NEW_STACK":return{handler:()=>{this._createTabStack()},visible:a&&d.selectedCount>1,...t(i,e,d)};case"CONTEXT_NEW_STACK_FOR_HOST":const c=n?this._getNodeById(n.id)?.pageItem:void 0,h=c?.hostname||"",p=n&&c?this._getStackableNodesForHost(n.wid,c):[];return{handler:()=>this._createTabStackForHost(h,p),visible:o&&h.length>0&&1===this.getSelectedItems().length&&p.length>1,...t(i,e,d)};case"CONTEXT_TABSTACK_UNGROUP":return{handler:()=>{this._disolveTabStack()},visible:"stack"===n?.type,...t(i,e,d)};case"CONTEXT_CLONE":return{handler:()=>{this._cloneTab()},visible:o&&!l,...t(i,e,d)};case"CONTEXT_RELOAD":return{handler:()=>{this._reload()},visible:r&&!l,...t(i,e,d)};case"CONTEXT_HIBERNATE_TAB":return{handler:()=>{this._hibernate()},visible:r&&!l&&this._getDiscardablePages().length>0,...t(i,e,d)};case"CONTEXT_PIN":return{handler:()=>{this._pinTab()},visible:Boolean(s&&!s.pinned&&!l&&!s.vivExtData.group),...t(i,e,d)};case"CONTEXT_UNPIN":return{handler:()=>{this._unpinTab()},visible:Boolean(s?.pinned)&&!l,...t(i,e,d)};case"CONTEXT_TILE_TABS":return{handler:()=>{this._tile()},visible:a&&this._getTileableSelectedNodes().length>1,...t(i,e,d)};case"CONTEXT_UNTILE_TABS":return{handler:()=>{this._removeTile()},visible:a&&this._getSelectedTilingItems().length>0,...t(i,e,d)};case"CONTEXT_MUTE":return{handler:()=>{n&&this._setMediaState("muting",n)},visible:r&&!l&&this._getMuteableNodesFrom("selection").length>0,...t(i,e,d)};case"CONTEXT_MUTE_OTHER":{const s="window"===n?.type&&Boolean(n.wid!==this.context.vivaldiWindowId);return{handler:()=>{n&&this._muteOthers(n)},visible:(a||s)&&n&&this._getMuteableNodesFrom("all").filter((e=>e.id!==n.id)).length>0,...t(i,e,d)}}case"CONTEXT_UNMUTE":return{handler:()=>{n&&this._setMediaState("playing",n)},visible:r&&n&&this._getPlayableNodesFrom("selection",n).length>0,...t(i,e,d)};case"CONTEXT_EMPTY_TRASH":return{handler:()=>{j7.Z.emptyTrash()},visible:Boolean(n&&this._isTrashFolder(n)&&Ine.Z.getTrash().length>0),...t(i,e,d)};case"CONTEXT_REOPEN":return{handler:()=>{n?this._reopen():this._reopenLastClosedTab()},visible:Boolean((!n||n.trashItem)&&Ine.Z.getTrash().length>0),...t(i,e,d)};default:return{...t(i,e,{})}}};_getMenuVisibility=(e,t)=>{if(t)if(this._isTrashFolder(t))switch(e.action){case"CONTEXT_EXPAND_ALL":case"CONTEXT_COLLAPSE_ALL":return!0;default:return!1}else{const n=this._isValidToDelete([t.id]).length>0,i=!this._isInTrashFolder(t)&&!z.ZP.isGuestSession(this.context.vivaldiWindowId);switch(e.action){case"CONTEXT_RENAME":return this._validateForEdit(t.id)&&1===this.getSelectedItems().length;case"CONTEXT_COPY":return Boolean(t.pageItem?.url||t.trashItem?.tab?.url);case"CONTEXT_SAVE":case"CONTEXT_SAVE_ALL":case"CONTEXT_EXPORT_ALL":return i;case"CONTEXT_EXPORT":return i&&this.getSelectedItems().length>0;case"CONTEXT_DELETE":return n;case"CONTEXT_EXPAND_ALL":case"CONTEXT_COLLAPSE_ALL":return!0;default:return!1}}else switch(e.action){case"CONTEXT_EXPAND_ALL":case"CONTEXT_COLLAPSE_ALL":return!0;default:return!1}};onContextMenu=e=>{this.refTreeList.current?.onContextMenu(e)};_handleMouseEnter=e=>{e&&X.Z.setStatus(this.context.vivaldiWindowId,St.jk.getHoverUrl(e))};_handleMouseLeave=()=>{X.Z.clearStatus(this.context.vivaldiWindowId)};getRowComponentProps=e=>({...e,showBadge:this.props.prefValues[D.kPanelsShowFolderBadge]});rowComponent=e=>{const t=e.node,n=(t.level+1)*$u,i=t.level*$u,s=this._isInPinnedFolder(t)&&!this.props.prefValues[D.kPanelsWindowShowPinnedGroup],o=this._isUnread(t),a=Boolean(t.pageItem?.discarded)&&this.props.prefValues[D.kTabsDimHibernated],r=this.props.prefValues[D.kTabsShowCloseButton]&&!this._isInPinnedFolder(t)&&!this._isInTrashFolder(t)&&"window"!==t.type,l=t.pageItem?.page&&F5.getState().get(t.pageItem.page.id)||(0,fa.l4)(),d=0===l.size||a;let c=0;this._hasChildren(t)&&(c="window"===t.type?W.Z.getPages(t.wid).size:this._getChildren(t).length);const h=t.pageItem?.faviconUrl||t.trashItem?.tab?.faviconUrl||"";return[Hne("label",{onMouseEnter:()=>this._handleMouseEnter(t.pageItem?.url||t.trashItem?.tab?.url),onMouseLeave:this._handleMouseLeave,title:t.url},"window__panel__"+t.id,this._hasChildren(t)&&Hne("span",{className:"expand-icon",style:{marginLeft:i},onClick:Cs.Z,onMouseDown:Cs.Z,onMouseUp:e=>this._handleExpandClick(e,t.id),dangerouslySetInnerHTML:{__html:cn.nfH}}),!d&&!this._isFolder(t)&&Hne("span",{className:"tab-audio",style:this._isFolder(t)?null:{marginLeft:i},onClick:()=>this._setMediaState(l.has("muting")?"playing":"muting",t)},void 0,l.has("capturing")?Hne("span",{className:"audioicon",dangerouslySetInnerHTML:{__html:cn.MjM}}):Hne(b9,{animated:this.props.prefValues[D.kThemeUseAnimation],mediaState:l})),this._isFolder(t)&&Hne(Rne,{trash:this._isTrashFolder(t),stack:"stack"===t.type,pinnedFolder:this._isPinnedFolder(t),leftMargin:this._hasChildren(t)?0:n}),!this._isFolder(t)&&!s&&(0,fn.jsx)(fn.Fragment,{children:h.startsWith("<svg")?Hne("span",{className:"svg-icon",style:d?{marginLeft:n}:void 0,dangerouslySetInnerHTML:{__html:h}}):Hne(Oi,{url:h,loadType:z.ZP.isIncognito(this.context.vivaldiWindowId)?"faviconSkipCache":"faviconFromCache",className:mn()({discarded:a}),style:d?{marginLeft:n}:void 0})}),s&&Hne("svg",{width:"16",height:"16",viewBox:"0 0 16 16",className:"pinned-icon",style:d?{marginLeft:n}:null},void 0,jne),void 0!==e.inlineEditText&&Hne("input",{type:"text",value:e.inlineEditText,onChange:e.onChange,onFocus:e.onFocus,onBlur:e.onBlur,autoFocus:!0}),void 0===e.inlineEditText&&Hne("span",{className:mn()({title:!0,active:t.pageItem?.active,unread:o})},void 0,t.title),e.showBadge&&this._hasChildren(t)&&Hne("span",{className:"item-count"},void 0,c),r&&Hne("span",{className:"close",title:(0,le.Z)("Close"),tabIndex:"-1",onClick:()=>this._closeWithId(t.id),dangerouslySetInnerHTML:{__html:cn.vyJ}}))]};menu={name:"windowlist",getCapability:this._getMenuCapability,getVisibility:this._getMenuVisibility};render(){const e=this.state.nodes[0];return e&&this._getChildren(e).find((e=>"tab"===e.type||"stack"===e.type||"pinned"===e.type&&this._getChildren(e).length>0))?(0,fn.jsx)(Yu,{ref:this.refTreeList,settings:"WINDOWS_PANEL",rowComponent:this.rowComponent,getRowComponentProps:this.getRowComponentProps,nodes:this.state.nodes,folderMode:"expand",hasChildren:this._hasChildren,isFolder:this._isFolder,supportsInlineEdit:!0,isValidToEdit:this._validateForEdit,getTitle:this._getTitle,saveTitle:Fne,onItemClick:this._onNodeClick,onItemDoubleClick:this._onNodeDoubleClick,onItemMouseDown:this._onNodeMouseDown,onItemMouseUp:this._onNodeMouseUp,onItemsActivated:this._onNodesActivated,delete:this._closeByIds,onExport:this._saveSessionByIds,onSave:this._saveBookmarkByIds,onDrop:this._onDrop,onMove:this._onMove,onCopy:this._onCopy,isValidForClipboard:this._isValidForClipboard,validateForDeletion:this._isValidToDelete,menu:this.menu,mimeType:Kne,validateForDrag:this._validateForDrag,getDropSupport:this._getDropSupport,getTargetSpec:this._getTargetSpec,getDragData:this._getDragData,setCustomDragData:this._setCustomDragData,supportsDeepCopy:!1,sorting:this.props.sorting}):this.props.filter?Hne("p",{},void 0,(0,le.Z)("Nothing found")):null}}const Xne=(0,fs.Z)(Yne,zne);var Qne,qne=n(34155);function Jne(e,t,n,i){Qne||(Qne="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Qne,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const eie=[{text:"",value:"title",fullScreenTitle:(0,le.Z)("Sort by Title")},{text:"",value:"pageItem.hostname",fullScreenTitle:(0,le.Z)("Sort by Host")},{text:"",value:"pageItem.domain",fullScreenTitle:(0,le.Z)("Sort by Domain")},{text:"",value:"sound",fullScreenTitle:(0,le.Z)("Sort by Audio Status")}],tie=[D.kKeyboardTabToAll,D.kPanelsWindowSorting];class nie extends tn.PureComponent{refTree=tn.createRef();static contextType=dn.Z;nodeRef=tn.createRef();constructor(e){super(e);const t=this.props.prefValues[D.kPanelsWindowSorting];this.state={filter:"",sorting:{sortOrder:t.sortOrder,sortField:t.sortField,comparator:this.sortComparator}}}componentDidMount(){Dl.ZP.addListener(this.onPanelStoreChange)}componentWillUnmount(){Dl.ZP.removeListener(this.onPanelStoreChange)}componentDidUpdate(e,t){!e.open&&this.props.open&&qne.nextTick((()=>this.focusTree()))}onPanelStoreChange=(e,t)=>{e===this.context.vivaldiWindowId&&this.props.open&&"setFocus"===t&&!ss(this.nodeRef.current)&&this.focusTree()};onSortChange=(e,t)=>{this.setState((n=>({sorting:{sortOrder:e,sortField:t,comparator:n.sorting.comparator}}))),nt.Z.set(D.kPanelsWindowSorting,{sortOrder:e,sortField:t})};sortComparator=(e,t)=>{if("trash"===e.type)return 1;if("trash"===t.type)return-1;if("pinned"===e.type)return-1;if("pinned"===t.type)return 1;if("stack"===e.type&&"stack"!==t.type)return-1;if("stack"===t.type&&"stack"!==e.type)return 1;const{sortOrder:n,sortField:i}=this.state.sorting;if("sound"===i)return this.sortForSound(e,t,n);return ns.Z.getDefaultComparator(n,i)(e,t)};sortForSound=(e,t,n)=>{if(n<=ns.Z.NO_SORTING)return 0;let i="";if(e.pageItem){const{page:t}=e.pageItem;t.discarded||(F5.hasMediaState(t.id,"playing")||F5.hasMediaState(t.id,"muting"))&&(i="playing")}let s="";if(t.pageItem){const{page:e}=t.pageItem;e.discarded||(F5.hasMediaState(e.id,"playing")||F5.hasMediaState(e.id,"muting"))&&(s="playing")}if("playing"===i)return-1;if("playing"===s)return 1;return ns.Z.getDefaultComparator(n,"title")(e,t)};focusTree=()=>{this.refTree.current?.focusTree()};handleFilterChange=e=>{const t=e.target.value;this.setState({filter:t})};onContextMenu=e=>{this.refTree.current?.onContextMenu(e)};onAddTab=e=>{this.refTree.current?.newTab(this.context.vivaldiWindowId)};onAddWindow=e=>{const t=this.context.vivaldiWindowId;z.ZP.isGuestSession(t)?Ru.Z.openIncognitoWindow(t):Ru.Z.openBrowserWindow(t)};render(){if(!this.props.open)return null;const e=z.ZP.isGuestSession(this.context.vivaldiWindowId);return(0,fn.jsxs)("div",{ref:this.nodeRef,className:"panel",id:"window-panel",children:[Jne("header",{},void 0,Jne(Rp,{title:this.props.title}),Jne("div",{className:"toolbar toolbar-default toolbar-wrap"},void 0,Jne("input",{type:"search",className:"tabsearch",placeholder:(0,le.Z)("verb","Search"),value:this.state.filter,onChange:this.handleFilterChange}),Jne("div",{className:"toolbar-group"},void 0,Jne(sl,{tooltip:(0,le.Z)("command","New Tab"),tabIndex:this.props.prefValues[D.kKeyboardTabToAll],onClick:this.onAddTab,image:cn.md4.small}),Jne(sl,{tooltip:e?(0,le.Z)("action","New Private Window"):(0,le.Z)("action","New Window"),tabIndex:this.props.prefValues[D.kKeyboardTabToAll],onClick:this.onAddWindow,image:cn.NxY.small})))),Jne(Iu,{fields:eie,onSortChange:this.onSortChange,keyAccess:this.props.keyAccess,sortField:this.state.sorting.sortField,sortOrder:this.state.sorting.sortOrder}),Jne("section",{className:"outerScrollbar",onContextMenu:this.onContextMenu},void 0,(0,fn.jsx)(Xne,{ref:this.refTree,sorting:this.state.sorting,filter:this.state.filter}))]})}}const iie=(0,fs.Z)(nie,tie),sie=["mail.google.com"];function oie(e,t,n=999){if(!e||!t)return"";const i=sie.some((e=>t.includes(e)))?e.match(/[\(\[\{](\d+)[\}\]\)]/):e.match(/^\((\d+)\D*?\)/);if(!i?.[1])return"";const s=parseInt(i[1]);return s<=0?"":s>n?"+":i[1]}var aie,rie=n(74699);function lie(e,t,n,i){aie||(aie="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:aie,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const die="vivaldi/x-panel-item-reg",cie="vivaldi/x-panel-item-web";function hie(e){return{selectedPanel:Dl.ZP.getSelectedPanel(e),panelWidth:Dl.ZP.getWidth(e),barVisible:Dl.ZP.getIsBarVisible(e),contentVisible:Dl.ZP.getIsContentVisible(e),focusContent:Dl.ZP.getFocusContent(e),isMailWindow:z.ZP.isMail(e),regPanels:Dl.ZP.getRegPanels(),webPanels:Dl.ZP.getWebPanels(e),regPanelOrder:Dl.ZP.getRegPanelOrder(e),webPanelOrder:Dl.ZP.getWebPanelOrder(e)}}function pie(e,t){const n=e.faviconUrl?e.faviconUrl:e.url;return{id:e.id,title:e.title,faviconUrl:n,faviconUrlValid:!1!==e.faviconUrlValid,hasBeenActive:t}}function uie(e){const t=hie(e),n=gie(t),i=[];return t.webPanels.forEach((e=>{const s=e.id===t.selectedPanel&&!n;i.push(pie(e,s))})),t.webPanelData=i,t}function gie(e){const t=(e.panelToggleVisible?Dl.fG:0)+(e.barVisible?Dl.Pv:0);return e.panelWidth<=t}const mie=[D.kKeyboardTabToAll,D.kPanelsAsOverlayAutoClose,D.kPanelsAsOverlayEnabled,D.kPanelsLazyLoad,D.kPanelsWindowShowUnread,D.kTabsCounterDetection,D.kTabsBarPosition,D.kThemeUseAnimation,D.kReadingListPanelSingleClickOpens,D.kReadingListShowCounter,D.kPanelsWebRemovedItems,D.kPanelsWebToolbar,D.kMailDisplayMailPanelViewingMail,D.kMailOpenPanelAutomaticallyViewingMail];var vie=lie(Zm,{accountId:ue.of,path:ue.tB}),fie=lie(Zm,{accountId:ue.u4,path:ue.ym});class yie extends tn.PureComponent{static contextType=dn.Z;winId=this.context.vivaldiWindowId;refPanels=new Map;refWebPanels=new Map;refPanelsContainer=tn.createRef();refFocusContainer=tn.createRef();nodeRef=tn.createRef();state={remainingTimers:new Map,isResizing:!1,chatItems:0,readingListItems:Cv.Z.getUnreadCount(),downloadItems:0,downloadProgress:0,dropId:"",dropPosition:"",panelToggleVisible:z.ZP.getVisibleUI(this.winId).panelToggle,unreadPages:0,webPanelData:[],...uie(this.winId)};alarmIntervalId=null;alarms=[];blockNextBlur=!1;delayTimeout=null;dndTimerId=null;dropMode={support:!1,copy:!1};panelResource={bookmarks:{title:(0,le.Z)("Bookmarks"),panel:c8,available:!z.ZP.isGuestSession(this.winId),url:"vivaldi://bookmarks",icon:cn.CLf,iconFilled:cn.hYC,...(0,Mn.Z)("Bookmarks")},mail:{title:(0,le.Z)("Mail"),panel:mte,available:()=>!z.ZP.isGuestSession(this.winId)&&!M.Z.get(D.kMailIsTurnedOff),url:"",icon:cn.lvj,iconFilled:cn.JJT,...(0,Mn.Z)("Mail")},feeds:{title:(0,le.Z)("Feeds"),panel:mte,available:()=>!z.ZP.isGuestSession(this.winId)&&!M.Z.get(D.kMailIsTurnedOff),url:"",icon:cn.ZU_,iconFilled:cn.fkD,...(0,Mn.Z)("Feeds")},contacts:{title:(0,le.Z)("Contacts"),panel:gee,available:()=>!z.ZP.isGuestSession(this.winId)&&!M.Z.get(D.kMailIsTurnedOff),url:"",icon:cn.LaO,iconFilled:cn.wp6,...(0,Mn.Z)("Contacts")},downloads:{title:(0,le.Z)("Downloads"),panel:dg,available:!0,url:"",icon:cn.izi,iconFilled:cn.zAT,...(0,Mn.Z)("Downloads")},notes:{title:(0,le.Z)("Notes"),panel:Bte,available:!z.ZP.isGuestSession(this.winId),url:"vivaldi://notes",icon:cn.cyI,iconFilled:cn.P3X,...(0,Mn.Z)("Notes")},history:{title:(0,le.Z)("History"),panel:wee,available:!z.ZP.isGuestSession(this.winId),url:"vivaldi://history",icon:cn.hcy,iconFilled:cn.ZU6,...(0,Mn.Z)("History")},tabs:{title:(0,le.Z)("title","Window"),panel:iie,available:!0,url:"",icon:cn.NxY,iconFilled:cn.cMC,...(0,Mn.Z)("title","Window")},calendar:{title:(0,le.Z)("Calendar"),panel:S8,available:()=>!z.ZP.isGuestSession(this.winId)&&!M.Z.get(D.kMailIsTurnedOff),url:"vivaldi://calendar",icon:cn.bcq,iconFilled:cn.Xgf,...(0,Mn.Z)("Calendar")},chat:{title:(0,le.Z)("Chat"),panel:A8,available:!z.ZP.isGuestSession(this.winId),url:"",icon:cn.yt5,iconFilled:cn.ySD,...(0,Mn.Z)("Chat")},translate:{title:(0,le.Z)("title","Translate"),panel:une,available:!z.ZP.isGuestSession(this.winId),url:"",icon:cn.U_X,iconFilled:cn.U_X,...(0,Mn.Z)("title","Translate")},readinglist:{title:(0,le.Z)("Reading List"),panel:Yte,available:!z.ZP.isGuestSession(this.winId),url:"",icon:cn.R_e,iconFilled:cn.Wcb,...(0,Mn.Z)("title","Reading List")}};trackContextOnFocus=t4("panel",this.context);componentDidMount(){$p.Z.addListener(this._onDownloadStoreChange),Dl.ZP.addListener(this._onStoreChange),W.Z.addListener(this._onPageStoreChange),Cv.Z.addListener(this._onReadingStoreChange),UT.addListener(this._onChatReceived),z.ZP.addListener(this._onWindowStoreChanged),y.Z.runtime.onMessage.addListener(this._onMessageReceived),Qi.Z.addListener("COMMAND_FOCUS_PANELBAR",this.onCommandSpy),H.Z.addListener(this._alarmsChanged)}componentWillUnmount(){$p.Z.removeListener(this._onDownloadStoreChange),Dl.ZP.removeListener(this._onStoreChange),W.Z.removeListener(this._onPageStoreChange),Cv.Z.removeListener(this._onReadingStoreChange),UT.removeListener(this._onChatReceived),z.ZP.removeListener(this._onWindowStoreChanged),H.Z.removeListener(this._alarmsChanged),y.Z.runtime.onMessage.removeListener(this._onMessageReceived),Qi.Z.removeListener("COMMAND_FOCUS_PANELBAR",this.onCommandSpy),this.clearDndTimer()}getNode(){return this.refFocusContainer.current}_onStoreChange=e=>{if(e===Dl.dr||e===this.winId){const e=hie(this.winId),t=e.webPanels.length===this.state.webPanelData.length&&this.state.selectedPanel===e.selectedPanel&&gie(this.state)===gie(e)?void 0:e.selectedPanel;this.setupWebPanelData(e.webPanels,t),this.setState(e)}};_onPageStoreChange=()=>{this.setState({unreadPages:W.Z.getUnreadCount(this.winId)})};_onMessageReceived=(e,t,n)=>{if(e&&t.id===y.Z.runtime.id&&e.action===vne){const t=this.getWebPanelDataByUrl(e.panelUrl);t&&(this.setWebPanelValue(t.id,"title",e.title),this.refWebPanels.get(t.id)?.current?.setTitle(e.title))}};_onDownloadStoreChange=()=>{this.setState({downloadItems:$p.Z.getTotalNumberOfDownloads(),downloadProgress:$p.Z.getTotalProgress()})};_onReadingStoreChange=()=>{this.setState({readingListItems:Cv.Z.getUnreadCount()})};_onChatReceived=()=>{const e=UT.getUnreadCount();this.setState({chatItems:e})};_onWindowStoreChanged=()=>{const e=z.ZP.getVisibleUI(this.winId).panelToggle,t=z.ZP.isMail(this.winId);this.state.panelToggleVisible===e&&this.state.isMailWindow===t||this.setState({panelToggleVisible:e,isMailWindow:t,panelWidth:Dl.ZP.getWidth(this.winId)})};_alarmsChanged=e=>{const t=new Map(e?.filter((e=>"panel"===e?.from)).map((e=>{if(e?.id&&e?.remainingTime)return[e.id,e.remainingTime]})).filter(Boolean));t&&this.setState({remainingTimers:t})};onCommandSpy=()=>{ss(this.refPanelsContainer.current?.focusRef.current??null)||this.moveFocus("-1","current",!0)};setSelected=e=>{Ho.Z.toggleContent(this.winId,e)};isWebPanelSelected=()=>this.isWebPanel(this.state.selectedPanel);isWebPanel=e=>e&&Dl.ZP.getIsWebPanel(e);handleDoubleClick=()=>{this.props.prefValues[D.kPanelsAsOverlayEnabled]&&this.props.prefValues[D.kPanelsAsOverlayAutoClose]||this.handlePanelSwitch()};getPanelUrl=e=>{let t="";return this.isWebPanel(e)?t=Hs.Z.getUrlById(e):"format"!==e&&this.panelResource[e]&&(t=this.panelResource[e].url),t};openInTab=(e,t,n)=>{const i=this.getPanelUrl(e);i&&Y.Z.openURL(this.context.vivaldiWindowId,i,{inCurrent:t,inBackground:n})};openInWindow=(e,t)=>{const n=this.getPanelUrl(e);n&&Y.Z.openURL(this.context.vivaldiWindowId,n,{inNewWindow:!0,incognito:t})};copyUrl=e=>{const t=this.getPanelUrl(e);t&&ui.Z.copyUrlToClipboard(t)};setMobileMode=(e,t)=>{this.isWebPanel(e)&&Hs.Z.setMobileMode(e,t)};getIsMobileMode=e=>{if(this.isWebPanel(e)){const t=this.state.webPanels;for(let n=0;n<t.length;n++)if(t[n].id===e)return Boolean(t[n].mobileMode)}return!1};handleClickOutside=()=>{if(!this.state.contentVisible)return;this.autoClosePanel(0);const e=this.refFocusContainer.current,{document:t,Element:n}=this.context;e instanceof n&&e.contains(t.activeElement)&&Ho.Z.removeFocus(this.winId)};onSlidebarPosition=(0,Kf.default)(((e,t)=>{const{Element:n}=this.context,i=this.refPanelsContainer.current?.focusRef.current;if(!(i instanceof n))return;const s=i.getBoundingClientRect();let o;switch(this.props.position){case"left":o=Math.round(e-s.left);break;case"right":o=Math.round(s.right-e);break;default:throw new Error("Unknown tabbar position")}this.setState({panelWidth:this.limitPanelWidth(o)})}),64);limitPanelWidth=e=>{const t=Dl.Ej,n=.618*this.context.innerWidth;return Math.min(Math.max(e,t),n)||t};handlePanelSwitch=()=>{Ho.Z.togglePanel(this.winId)};autoClosePanel=(e=600)=>{const t=Dl.ZP.getSeparateFloating(this.state.selectedPanel);(t||void 0===t&&this.props.prefValues[D.kPanelsAsOverlayEnabled])&&this.props.prefValues[D.kPanelsAsOverlayAutoClose]&&(this.cancelTimeout(),this.delayTimeout=setTimeout((()=>{"mail"===this.state.selectedPanel&&!1===Dl.ZP.getSeparateFloating("mail")&&this.props.prefValues[D.kMailDisplayMailPanelViewingMail]&&(this.props.prefValues[D.kMailOpenPanelAutomaticallyViewingMail]||this.state.contentVisible)||this.state.contentVisible&&Ho.Z.closePanel(this.winId)}),e))};cancelTimeout=()=>{this.delayTimeout&&clearTimeout(this.delayTimeout),this.delayTimeout=null};onDialogOpen=()=>{this.props.prefValues[D.kPanelsAsOverlayEnabled]&&this.props.prefValues[D.kPanelsAsOverlayAutoClose]&&this.state.contentVisible&&(this.blockNextBlur=!0)};handleBlur=e=>{this.blockNextBlur||e.target instanceof Element&&e.target.classList.contains("home")?(this.blockNextBlur=!1,this.cancelTimeout()):this.autoClosePanel()};showPanelSettings=()=>{ie.Z.showSettings(this.winId)};getWebPanelDataById=e=>this.state.webPanelData.find((t=>t.id===e));getWebPanelDataByUrl=e=>this.state.webPanelData.find((t=>t.activeUrl===e));setupWebPanelData=(e,t)=>{if(this.state.webPanelData.length!==e.length||void 0!==t){const n=[];e.forEach((e=>{const i=this.getWebPanelDataById(e.id);if(i)!0!==i.hasBeenActive&&e.id===t&&(i.hasBeenActive=!0),n.push(i);else{const i=e.id===t;n.push(pie(e,i))}})),this.setState({webPanelData:n})}};isPanelOpen=e=>this.state.contentVisible&&this.state.selectedPanel===e;isPanelAvailable=e=>{let t=this.state.regPanels;for(let n=0;n<t.length;n++)if(t[n].id===e)return!1!==t[n].available;t=this.state.webPanels;for(let n=0;n<t.length;n++)if(t[n].id===e)return!1!==t[n].available;return!1};shouldDisplayMailButton=e=>"mail"===e&&(W.Z.getActivePage(this.winId)?.isMailPage&&this.props.prefValues[D.kMailDisplayMailPanelViewingMail]);setWebPanelValue=(e,t,n)=>{this.setupWebPanelData(this.state.webPanels,void 0);let i=-1;for(let s=0;s<this.state.webPanelData.length;s++){const o=this.state.webPanelData[s];if(o.id===e){"title"===t&&o.title!==n?i=s:"faviconUrl"!==t||o.faviconUrl===n&&!0===o.faviconUrlValid?"activeUrl"===t&&o.activeUrl!==n&&(i=s):i=s;break}}if(-1!==i){const s=[];for(let e=0;e<this.state.webPanelData.length;e++){const o=this.state.webPanelData[e];e===i&&("title"===t?o.title=n:"faviconUrl"===t?(o.faviconUrl=n,o.faviconUrlValid=!0):"activeUrl"===t&&(o.activeUrl=n)),s.push(o)}this.setState({webPanelData:s}),"title"===t?Hs.Z.setTitle(e,n):"faviconUrl"===t?Hs.Z.setFaviconUrl(e,n):"activeUrl"===t&&Hs.Z.setActiveUrl(e,n)}};_getPanelInstanceById=e=>this.refPanels.get(e)?.current;clearDndTimer=()=>{this.dndTimerId&&clearTimeout(this.dndTimerId),this.dndTimerId=null};onDragEnterBar=e=>{if(e.preventDefault(),e.stopPropagation(),z.ZP.isGuestSession(this.winId))this.dropMode={support:!1,copy:!1};else{const t={};t.support=e.dataTransfer.types.some((e=>"text/uri-list"===e||"text/plain"===e||e===die||e===cie)),t.copy=t.support&&!e.dataTransfer.types.some((e=>e===cie))&&!e.dataTransfer.types.some((e=>e===die))&&!e.dataTransfer.types.some((e=>e===Q.Up)),this.dropMode=t}};onDragOverBar=e=>{e.preventDefault(),e.stopPropagation(),this.dropMode.support?(this.clearDndTimer(),this.dropMode.copy||e.dataTransfer.types.some((e=>e===cie))?this.state.webPanelOrder.length>0&&this.setState((e=>({dropId:e.webPanelOrder[e.webPanelOrder.length-1],dropPosition:"below"}))):e.dataTransfer.types.some((e=>e===die))&&this.state.regPanelOrder.length>0&&0===this.state.webPanelOrder.length&&this.setState((e=>({dropId:e.regPanelOrder[e.regPanelOrder.length-1],dropPosition:"below"}))),e.dataTransfer.dropEffect=this.dropMode.copy?"copy":"move"):e.dataTransfer.dropEffect="none"};onDropBar=e=>{if(e.preventDefault(),e.stopPropagation(),this.dropMode.support){const t=e.dataTransfer.getData(cie);t?""!==this.state.dropId&&Ho.Z.move(this.winId,t,this.state.dropId,this.state.dropPosition):Jt.ZP.getUrlsFromEventPromise(e,!0).then((e=>{e.forEach((e=>{Hs.Z.addByUrl(e.url)}))}))}this.setState({dropId:"",dropPosition:""})};onDragStartButton=(e,t)=>{if(t.dataTransfer.effectAllowed="all",this.isWebPanel(e)){t.dataTransfer.setData(cie,[e]);const n=Hs.Z.getUrlById(e);n&&(t.dataTransfer.setData("text/uri-list",[n]),t.dataTransfer.setData("text/plain",[n]))}else t.dataTransfer.setData(die,[e])};onDragEnterButton=(e,t)=>{t.preventDefault(),t.stopPropagation();let n={};if(this.isWebPanel(e))n.support=t.dataTransfer.types.some((e=>"text/uri-list"===e||"text/plain"===e||e===cie)),n.copy=n.support&&!t.dataTransfer.types.some((e=>e===cie||e===Q.Up));else{const i=this._getPanelInstanceById(e);i&&"function"==typeof i.onDragEnterPanelButton&&(n=i.onDragEnterPanelButton(t)),n.support||(n.support=t.dataTransfer.types.some((e=>e===die)))}this.dropMode=n};onDragLeave=e=>{e.preventDefault(),e.stopPropagation(),this.clearDndTimer(),this.dndTimerId=setTimeout((()=>{this.dndTimerId=null,this.setState({dropId:"",dropPosition:""})}),Q._p)};onDragOverButton=(e,t)=>{if(t.preventDefault(),t.stopPropagation(),!1===this.dropMode.support)t.dataTransfer.dropEffect="none",this.setState({dropId:"",dropPosition:""});else{if(this.dropMode.onButton)return void(t.dataTransfer.dropEffect=this.dropMode.copy?"copy":"move");this.clearDndTimer(),t.dataTransfer.dropEffect=this.dropMode.copy?"copy":"move";const n=t.currentTarget;if(!(n instanceof Element))return;const i=n.getBoundingClientRect(),s=Dl.Pv,o=(t.clientY-i.top)/s;let a="";!1?a=o<=.25?"above":o>.75?"below":"on":o<=.5?a="above":o>.5&&(a="below"),this.state.dropId===e&&this.state.dropPosition===a||this.setState({dropId:e,dropPosition:a})}};onDropButton=(e,t)=>{if(t.preventDefault(),t.stopPropagation(),this.dropMode.support)if(this.dropMode.onButton){const n=this._getPanelInstanceById(e);n&&"function"==typeof n.onDropPanelButton&&n.onDropPanelButton(t)}else{const n=this.isWebPanel(e)?t.dataTransfer.getData(cie):t.dataTransfer.getData(die);if(n)""!==this.state.dropId&&Ho.Z.move(this.winId,n,this.state.dropId,this.state.dropPosition);else{const n=this.state.dropPosition;Jt.ZP.getUrlsFromEventPromise(t,!0).then((t=>{if("on"===n)t.length>0&&Hs.Z.setUrl(e,t[0].url);else{let i=this.state.webPanelOrder.findIndex((t=>t===e));-1!==i&&"below"===n&&i++,Hs.Z.addByUrls(t.map((e=>e.url)),i)}}))}}this.setState({dropId:"",dropPosition:""})};onDragButtonEnd=e=>{this.setState({dropId:"",dropPosition:""})};getRemovedWebPanelsMenuItems=()=>{const e=this.props.prefValues[D.kPanelsWebRemovedItems].map(((e,t)=>({mnemonic:!1,handler:()=>Hs.Z.recoverWebPanel(t),...G.Z.makeLabelPair(e.title||e.url||(0,le.Z)("Unknown Web Panel"))})));return e.length&&(e.push(G.Z.separatorItem),e.push({handler:Hs.Z.emptyTrash,...(0,Mn.Z)("panel","Clear All")})),e};getPanelSelectorMenu=e=>{const t=[];if("reg"===e&&this.state.regPanelOrder.forEach((e=>{if(Dl.ZP.canRender(this.winId,e)){const n=this.panelResource[e];if(n){("function"==typeof n.available?n.available():n.available)&&t.push({handler:()=>this.handlePanelSelector(e),type:"checkbox",checked:this.isPanelAvailable(e),label:n.label,labelEnglish:n.labelEnglish})}}})),"web"===e){const e=this.state.webPanels;e&&e.length>0&&this.state.webPanelOrder.forEach(((n,i)=>{const s=e.filter((e=>e.id===n))[0];t.push({...G.Z.makeNumberMnemonic(s.title||s.url||(0,le.Z)("Unknown Web Panel"),i),handler:this.handlePanelSelector.bind(this,s.id),type:"checkbox",checked:this.isPanelAvailable(s.id)})}))}return t};getWebPanelContentMenu=()=>{const e=this.props.prefValues[D.kPanelsWebToolbar];return[{handler:Hs.Z.setUIContent.bind(Hs.Z,{showToolbar:!0}),visible:!(!0===e.showToolbar),...(0,Mn.Z)("command","Show")},{handler:Hs.Z.setUIContent.bind(Hs.Z,{showToolbar:!1}),visible:Boolean(!0===e.showToolbar),...(0,Mn.Z)("other","Hide")},{handler:Hs.Z.setUIContent.bind(Hs.Z,{allControls:!e.allControls,showToolbar:e.showToolbar||!e.allControls}),type:"checkbox",checked:e.allControls,visible:Boolean(!0===e.showToolbar),...(0,Mn.Z)("Display All Controls")}]};handlePanelSelector=e=>{this.isPanelAvailable(e)?(this.isPanelOpen(e)&&(Dl.ZP.getAvailablePanelCount()>1?Dl.ZP.getLastAvailablePanel(this.winId)===e?Ho.Z.showNextPanel(this.winId,"previous"):Ho.Z.showNextPanel(this.winId,"next"):Ho.Z.setContentVisible(this.winId,!1)),Ho.Z.setAvailable(e,!1)):(Ho.Z.setAvailable(e,!0),Ho.Z.toggleContent(this.winId,e))};handlePanelButtonDown=e=>{Lr(e)||e.preventDefault()};handlePanelButtonUp=(e,t)=>{t.button!==vn.Z.kCenter||0!==t.buttons||Lr(t)||this.handlePanelButtonClick(e,t)};handlePanelButtonClick=(e,t)=>{const{altKey:n,ctrlKey:i,shiftKey:s,metaKey:o}=t,a={altKey:n,ctrlKey:i,shiftKey:s,metaKey:o};if(t.button===vn.Z.kCenter||t.button===vn.Z.kLeft&&(0,xr.S2)(a))if(this.isWebPanel(e))Hs.Z.openInTab(this.winId,e,!1,!0);else switch(e){case"bookmarks":ie.Z.showBookmarks(this.winId);break;case"history":ie.Z.showHistory(this.winId);break;case"notes":ie.Z.showNotes(this.winId);break;case"calendar":ie.Z.showCalendar(this.winId);break;case"mail":this.setSelected(e),ie.Z.showMail(this.winId)}else Lr(t)||this.setSelected(e);ie.Z.setPaneFocus(this.winId,!1)};handleSliderDown=()=>{this.setState({isResizing:!0})};handleSliderUp=()=>{this.setState({isResizing:!1}),Ho.Z.setWidth(this.winId,this.state.selectedPanel,this.state.panelWidth)};handlePanelButtonKeyDown=(e,t)=>{switch(t.key){case"ArrowUp":this.moveFocus(e,"left",!1);break;case"ArrowDown":this.moveFocus(e,"right",!1);break;case"Escape":this.leaveBar();break;default:return}t.preventDefault(),t.stopPropagation()};moveFocus=(e,t,n)=>{const i=this.refPanelsContainer.current?.focusRef.current??null;if(!0===n||ss(i)){const{document:n}=this.context,i=Array.from(n.querySelectorAll("button.panelbtn")).map((e=>e.getAttribute("data-id"))).filter(Boolean);if("current"===t){const t=parseInt(e)<0?0:i.indexOf(e);if(-1===t)return;e=i[t]}else if("left"===t||"right"===t){if(1===i.length)return;let n=i.indexOf(e);n="right"===t?n+1>=i.length?0:n+1:n<=0?i.length-1:n-1,e=i[n]}const s=n.querySelector(`button.panelbtn[data-id="${e}"]`);s&&s instanceof HTMLButtonElement&&s.focus()}};leaveBar=()=>{ie.Z.setPaneFocus(this.winId,!1),a.Z.executeActions(this.winId,"COMMAND_FOCUS_WEBVIEW")};getPanelButtonTitleById=(e,t)=>"downloads"===e&&this.state.downloadItems>0?(0,le.Z)("Downloads")+" "+(0,le.Z)("($1 active transfer)","($1 active transfers)",[this.state.downloadItems]):t;getPanelButtonClassById=(e,t,n)=>{const{downloadItems:i,dropId:s,dropPosition:o,contentVisible:a,selectedPanel:r}=this.state,l=e===s;return mn()({panelbtn:!0,uifocusstop:n,webviewbtn:t,[e.toString()]:!t,loading:!t&&"downloads"===e&&i>0,active:r===e&&a,dragoverAbove:l&&"above"===o,dragoverBelow:l&&"below"===o,dragoverInside:l&&"on"===o})};getPanelButtonTabIndexById=e=>this.state.selectedPanel===e?this.props.prefValues[D.kKeyboardTabToAll]:-1;getButtonContextMenuItemsPromise=e=>{const t="panelbaritem",n=this.winId,i=Ai.getOptionFunction(t),s=this.isWebPanel(e);return Ai.getNamedMenu(n,t,(async t=>{switch(t.action){case"CONTAINER_PERIODIC_RELOAD":case"CONTEXT_CONTAINER_PERIODIC_TIMER":return{...i(n,t,{}),items:xl.Z.getMenu(e,"panel"),visible:s};case"CONTEXT_MENU_OPEN":return{visible:this.getPanelUrl(e).length>0,...i(n,t,{})};case"CONTEXT_OPEN_IN_TAB":case"CONTEXT_OPEN_IN_NEW_TAB":return{handler:()=>this.openInTab(e,"CONTEXT_OPEN_IN_TAB"===t.action,!1),visible:this.getPanelUrl(e).length>0,...i(n,t,{})};case"CONTEXT_OPEN_IN_NEW_BACKGROUND_TAB":return{handler:()=>this.openInTab(e,!1,!0),visible:this.getPanelUrl(e).length>0&&!M.Z.get(D.kTabsOpenNewInBackground),...i(n,t,{})};case"CONTEXT_OPEN_IN_NEW_WINDOW":case"CONTEXT_OPEN_IN_PRIVATE_WINDOW":{const s=z.ZP.isGuestSession(this.winId),o="CONTEXT_OPEN_IN_NEW_WINDOW"===t.action;return{handler:this.openInWindow.bind(this,e,!o),visible:this.getPanelUrl(e).length>0&&!(o&&s),...i(n,t,{})}}case"CONTEXT_COPY_ADDRESS":return{handler:this.copyUrl.bind(this,e),visible:this.getPanelUrl(e).length>0,...i(n,t,{})};case"CONTEXT_DESKTOP_VERSION":return{handler:this.setMobileMode.bind(this,e,!1),visible:s&&this.getIsMobileMode(e),...i(n,t,{})};case"CONTEXT_MOBILE_VERSION":return{handler:this.setMobileMode.bind(this,e,!0),visible:s&&!this.getIsMobileMode(e),...i(n,t,{})};case"CONTEXT_SEPARATE_WIDTH":return{handler:Ho.Z.setPanelResizable.bind(Ho.Z,e,!Dl.ZP.getResizableByPanel(e)),checked:!0===Dl.ZP.getResizableByPanel(e),...i(n,t,{})};case"CONTEXT_CONTAINER_FLOATING":{const s=this.props.prefValues[D.kPanelsAsOverlayEnabled];return{items:[{handler:()=>{const t=Dl.ZP.getSeparateFloating(e),n=this.props.prefValues[D.kPanelsAsOverlayEnabled];void 0===t&&n?Ho.Z.setSeparateFloating(e,!1):Ho.Z.setSeparateFloating(e,!t)},checked:Boolean(Dl.ZP.getSeparateFloating(e)),type:"checkbox",...(0,Mn.Z)("This Panel")},{handler:()=>nt.Z.toggle(D.kPanelsAsOverlayEnabled,!0,!1),checked:Boolean(s),type:"checkbox",...(0,Mn.Z)("All Panels")},G.Z.separatorItem,{handler:()=>Ho.Z.setSeparateFloating(e,void 0),...(0,Mn.Z)("Reset Panel Floating")}],...i(n,t,{})}}case"CONTEXT_CONTAINER_TOOLBAR":return{items:this.getWebPanelContentMenu(),visible:s,...i(n,t,{})};case"CONTEXT_REMOVE_WEB_PANEL":return{handler:Hs.Z.removeById.bind(this,e),visible:s,...i(n,t,{})};case"CONTEXT_CONTAINER_REG_PANELS":return{items:this.getPanelSelectorMenu("reg"),...i(n,t,{})};case"CONTEXT_CONTAINER_WEB_PANELS":return{items:this.getPanelSelectorMenu("web"),...i(n,t,{})};case"CONTEXT_CONTAINER_REMOVED_PANELS":{const e=this.getRemovedWebPanelsMenuItems();return{items:e,visible:e.length>0,...i(n,t,{})}}default:return{...i(n,t,{})}}}))};onButtonContextMenu=(e,t)=>{t.persist(),t.preventDefault(),t.stopPropagation(),this.getButtonContextMenuItemsPromise(e).then((e=>{(0,zi.Z)(this.winId,e)(t)}))};onBarContextMenu=(e,t)=>{const n=this.winId,i=Ai.getOptionFunction(e);t.persist(),t.preventDefault(),t.stopPropagation(),Ai.getNamedMenu(n,e,(async e=>{switch(e.action){case"CONTEXT_CONTAINER_REG_PANELS":return{items:this.getPanelSelectorMenu("reg"),...i(n,e,{})};case"CONTEXT_CONTAINER_WEB_PANELS":return{items:this.getPanelSelectorMenu("web"),...i(n,e,{})};case"CONTEXT_CONTAINER_REMOVED_PANELS":{const t=this.getRemovedWebPanelsMenuItems();return{items:t,visible:t.length>0,...i(n,e,{})}}default:return{...i(n,e,{})}}})).then((e=>{(0,zi.Z)(n,e)(t)}))};renderPanelButtonById=e=>{if((this.isPanelAvailable(e)||this.shouldDisplayMailButton(e))&&Dl.ZP.canRender(this.winId,e)&&"format"!==e&&this.panelResource[e]){const t=this.panelResource[e],n=this.state.selectedPanel===e&&this.state.barVisible,i=this.state.selectedPanel===e&&this.state.contentVisible?t.iconFilled.small:t.icon.small;return lie("button",{"data-id":e,title:this.getPanelButtonTitleById(e,t.title),className:this.getPanelButtonClassById(e,!1,n),tabIndex:this.getPanelButtonTabIndexById(e),onContextMenu:this.onButtonContextMenu.bind(this,e),onMouseDown:this.handlePanelButtonDown,onMouseUp:this.handlePanelButtonUp.bind(this,e),onKeyDown:this.handlePanelButtonKeyDown.bind(this,e),onClick:this.handlePanelButtonClick.bind(this,e),onDrop:this.onDropButton.bind(this,e),onDragEnter:this.onDragEnterButton.bind(this,e),onDragLeave:this.onDragLeave,onDragOver:this.onDragOverButton.bind(this,e),onDragStart:this.onDragStartButton.bind(this,e),onDragEnd:this.onDragButtonEnd,draggable:"true"},"button_"+e,lie("span",{dangerouslySetInnerHTML:{__html:i}}),this.renderPanelButtonOverlayById(e))}return null};renderPanelButtonOverlayById=e=>{if("mail"===e)return vie;if("feeds"===e)return fie;if("downloads"===e)return lie("div",{className:"progress"},void 0,lie("div",{className:"loaded",style:{width:100*this.state.downloadProgress+"%"}}));if("tabs"===e){if(this.props.prefValues[D.kPanelsWindowShowUnread]&&this.state.unreadPages>0)return lie("span",{className:"button-badge"},void 0,this.state.unreadPages)}else if("readinglist"===e){if(this.props.prefValues[D.kReadingListShowCounter]&&this.state.readingListItems>0)return lie("span",{className:"button-badge"},void 0,this.state.readingListItems>1e3?"999+":this.state.readingListItems)}else if("chat"===e&&this.state.chatItems>0)return lie("span",{className:"button-badge"},void 0,this.state.chatItems);return null};renderAllPanelButtons=()=>[...this.state.regPanelOrder.map(this.renderPanelButtonById),...this.state.webPanelOrder.map(this.renderWebPanelButtonById)];setPanelRef=(e,t)=>{if(t){const n=tn.createRef();n.current=t,this.refPanels.set(e,n)}else this.refPanels.delete(e)};renderAllPanels=()=>{const e=[];this.state.regPanelOrder.forEach((t=>{if(this.isPanelAvailable(t)&&Dl.ZP.canRender(this.winId,t)||"mail"===t&&!this.props.prefValues[D.kMailIsTurnedOff]&&this.props.prefValues[D.kMailDisplayMailPanelViewingMail]){const n=this.panelResource[t];n?.panel&&e.push(lie(id,{level:"tabs"},"panel-"+t,(0,fn.jsx)(n.panel,{ref:e=>this.setPanelRef(t,e),keyAccess:this.props.prefValues[D.kKeyboardTabToAll],title:n.title,panelId:t,open:this.isPanelOpen(t),onOpenDialog:this.onDialogOpen})))}}));const t=this.state.webPanels;if(this.state.webPanelData.length===t.length){const n=[];this.state.webPanelOrder.forEach((e=>{const i=this.getWebPanelDataById(e),{prefValues:s}=this.props;if(!s[D.kPanelsLazyLoad]||i?.hasBeenActive){const i=t.find((t=>t.id===e&&t.available));i&&n.push(this.renderWebPanelById(i.id))}})),e.push(lie("div",{className:this.isWebPanelSelected()?"webpanel-stack":"webpanel-stack hidden"},"webpanelwrapper",n))}return e};setWebPanelRef=(e,t)=>{if(t){const n=tn.createRef();n.current=t,this.refWebPanels.set(e,n)}else this.refWebPanels.delete(e)};renderWebPanelById=e=>{const t=this.state.webPanels.filter((t=>t.id===e))[0],n=this.state.contentVisible&&this.state.selectedPanel===e;return(0,fn.jsx)(Sne,{ref:t=>this.setWebPanelRef(e,t),isVisible:n,focusContent:this.state.focusContent&&n,panelUI:this.props.prefValues[D.kPanelsWebToolbar],setWebPanelValue:this.setWebPanelValue,menuPromise:this.getButtonContextMenuItemsPromise,webPanel:t},e)};renderWebPanelButtonById=e=>{if(!this.isPanelAvailable(e))return null;const t=this.state.webPanels.find((t=>t.id===e)),n=this.getWebPanelDataById(e),i=n?.title?`${n.title}\n${t.url}`:t.url,s=n?.faviconUrlValid?n.faviconUrl:"",o=s.startsWith("data:")?"faviconFromCache":"page",a=oie(i,t.activeUrl,9),r=this.state.selectedPanel===e&&this.state.barVisible,l=this.state.remainingTimers.get(e);return lie("button",{"data-id":e,title:i,className:this.getPanelButtonClassById(e,!0,r),tabIndex:this.getPanelButtonTabIndexById(e),onContextMenu:t=>this.onButtonContextMenu(e,t),onMouseUp:t=>this.handlePanelButtonUp(e,t),onMouseDown:this.handlePanelButtonDown,onClick:t=>this.handlePanelButtonClick(e,t),onKeyDown:t=>this.handlePanelButtonKeyDown(e,t),onDrop:t=>this.onDropButton(e,t),onDragEnter:t=>this.onDragEnterButton(e,t),onDragLeave:this.onDragLeave,onDragOver:t=>this.onDragOverButton(e,t),onDragStart:t=>this.onDragStartButton(e,t),onDragEnd:this.onDragButtonEnd,draggable:"true"},e,lie("span",{},void 0,lie(Oi,{url:s,loadType:o})),this.props.prefValues[D.kTabsCounterDetection]&&a&&lie("span",{className:"button-badge"},void 0,a),l&&lie(Jte,{progress:l}))};render(){const{barVisible:e,contentVisible:t,panelWidth:n,isResizing:i}=this.state,s=this.props.prefValues,{position:o}=this.props,a=z.ZP.isGuestSession(this.winId),r=(this.state.panelToggleVisible?Dl.fG:0)+(e?Dl.Pv:0),l=gie(this.state),d=s[D.kPanelsAsOverlayEnabled],c=Dl.ZP.getSeparateFloating(this.state.selectedPanel);let h;h=void 0===c?d:c;const p=mn()({[o]:!0,button:this.state.panelToggleVisible,switcher:n<=Dl.fG,icons:e&&l,overlay:h,minimized:h&&e,resizing:i}),u="right"===o&&e||"left"===o&&!e?"0 0 0 8 4 4":"4 0 4 8 0 4",g=t?128:64,m=n-r,v=h&&s[D.kPanelsAsOverlayAutoClose]&&t,f="left"===o?2:3,y="left"===o?n-f:-(n-r+f),w=mn()({preferences:!0,panelbtn:!0}),b=this.renderAllPanelButtons().filter((e=>null!==e));return lie(rie.oh,{animation:{width:h?n-m:n},duration:s[D.kThemeUseAnimation]&&!i?g:0,begin:e=>e[0].style.removeProperty("display")},void 0,(0,fn.jsxs)(vs.Z,{focusName:"focus_panel",id:"panels-container",ref:this.refPanelsContainer,className:p,children:[(0,fn.jsxs)("div",{id:"panels",ref:this.refFocusContainer,onBlur:v?this.handleBlur:null,onFocus:e=>{this.trackContextOnFocus(e),v&&this.cancelTimeout()},children:[this.state.panelToggleVisible&&lie("div",{id:"panel_switch",title:e?(0,le.Z)("Hide Panel"):(0,le.Z)("verb","Show Panel"),onClick:this.handlePanelSwitch},void 0,lie("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",width:"4px",height:"8px",viewBox:"0 0 4 8"},void 0,lie("polygon",{points:u}))),lie("div",{id:"switch",className:"slim-scrollbar",onContextMenu:this.onBarContextMenu.bind(this,"panelbar"),onDragEnter:this.onDragEnterBar,onDragLeave:this.onDragLeave,onDragOver:this.onDragOverBar,onDrop:this.onDropBar},void 0,b,!a&&lie(i8,{id:"addwebpanel",webPanels:this.state.webPanels,uiFocus:0===b.length,addNew:Hs.Z.addByUrl,moveFocus:this.moveFocus,leaveBar:this.leaveBar,rejectMimeType:cie,keyAccess:this.getPanelButtonTabIndexById()}),!a&&lie("button",{className:w,title:(0,le.Z)("Settings"),"data-id":"preferences",tabIndex:s[D.kKeyboardTabToAll],onMouseDown:this.handlePanelButtonDown,onKeyDown:this.handlePanelButtonKeyDown.bind(this,"preferences"),onClick:this.showPanelSettings},void 0,lie("span",{dangerouslySetInnerHTML:{__html:cn.bqs.small}}))),this.state.selectedPanel&&lie("div",{className:"panel-group",style:h?{width:l?0:n-r,[o]:r}:null},void 0,lie("div",{className:"panel-collapse-guard",style:{minWidth:i?"unset":m,maxWidth:i?"unset":m}},void 0,this.renderAllPanels()))]}),!l&&lie(gu,{style:h?{left:y}:void 0,onSlidebarPosition:this.onSlidebarPosition,onStart:this.handleSliderDown,onStop:this.handleSliderUp,onDoubleClick:this.handleDoubleClick,offset:1,position:o})]}))}}const wie=(0,fs.Z)((0,Vr.Z)(yie),mie);class bie extends Z.Z{getInitialState(){return[]}reduce(e,t){switch(t.actionType){case"POPUPWINDOW_OPENED":return[...e,t.popupWindow];case"POPUPWINDOW_CLOSED":return(0,E.Uy)(e,(e=>{const{componentId:n}=t,i=e.findIndex((e=>e.identifier===n));-1!==i&&e.splice(i,1)}));default:return e}}}const Cie=new bie;var Sie;function Tie(e,t,n,i){Sie||(Sie="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Sie,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Iie=[D.kRazerChromaHasShownPromotion];class kie extends tn.Component{static contextType=dn.Z;constructor(e){super(e)}onClose=()=>{nt.Z.set(D.kRazerChromaHasShownPromotion,!0),this.props.onClose()};openSettings=()=>{ie.Z.showSettings(this.context.vivaldiWindowId,"themes"),this.onClose()};render(){return Tie(ln.Z,{onRequestClose:Tl.default,dialogWidth:400,viewMode:"slide"},void 0,Tie("header",{className:"dialog-header"},void 0,Tie("h1",{className:"dialog-title"},void 0,(0,le.Z)("Razer Chroma device detected."))),Tie("div",{className:"dialog-content"},void 0,Tie("p",{},void 0,(0,le.Z)("Vivaldi supports connected Razer Chroma devices. You can enable them with Vivaldi from the Themes section in settings."))),Tie("footer",{className:"dialog-footer"},void 0,Tie("input",{type:"submit",value:(0,le.Z)("Go to Theme Settings"),onClick:this.openSettings,autoFocus:!0}),Tie("input",{type:"button",value:(0,le.Z)("Close"),onClick:this.onClose})))}}const Aie=(0,fs.Z)(kie,Iie);var Zie;function Eie(e,t,n,i){Zie||(Zie="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Zie,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class _ie extends tn.Component{static contextType=dn.Z;state={shown:!0,name:"",invalidInput:!1,errorSaving:!1,saveOnlyCurrentWindow:!1};_getSaveSelected=()=>!!("selected"===this.props.options.mode&&this.props.options.ids&&this.props.options.ids.length>0);_close=()=>{this.state.shown&&this.setState((e=>({shown:!1})),(()=>this.props.onClose()))};onSaveSession=()=>{const e={saveOnlyWindowId:0};this._getSaveSelected()?(e.saveOnlyWindowId=this.context.vivaldiWindowId,e.ids=this.props.options.ids):!0===this.state.saveOnlyCurrentWindow&&(e.saveOnlyWindowId=this.context.vivaldiWindowId),d.Z.sessionsPrivate.saveOpenTabs(this.state.name,e,(e=>{0===e?this.props.onClose():this.setState({errorSaving:!0})}))};isValidName=e=>/^[^\\/:\*\?"<>\|]+$/.test(e)&&!/^\./.test(e)&&!/^(nul|prn|con|lpt[0-9]|com[0-9])(\.|$)/i.test(e);nameChange=e=>{""===e.target.value||this.isValidName(e.target.value)?this.setState({name:e.target.value,invalidInput:!1}):this.setState({invalidInput:!0})};_toggleSaveOnlyCurrentWindow=()=>{this.setState((e=>({saveOnlyCurrentWindow:!e.saveOnlyCurrentWindow})))};render(){var e="";!0===this.state.invalidInput?e=(0,le.Z)("Invalid character in the session name."):this.state.errorSaving&&(e=(0,le.Z)("Error saving the session."));const t=this._getSaveSelected()?(0,le.Z)("session","Save Selected Tabs as Session"):(0,le.Z)("session","Save Open Tabs as Session");return Eie(ln.Z,{onRequestClose:this._close},void 0,Eie("div",{className:"save-session"},void 0,Eie("header",{className:"dialog-header"},void 0,Eie("h1",{className:"dialog-title"},void 0,t)),Eie("form",{},void 0,Eie("div",{className:"dialog-content session-dialog"},void 0,Eie("input",{type:"text",placeholder:(0,le.Z)("Session Name"),onChange:this.nameChange,spellCheck:"false",autoFocus:!0}),!this._getSaveSelected()&&Eie("label",{className:"dialog-checkbox"},void 0,Eie("input",{type:"checkbox",checked:this.state.saveOnlyCurrentWindow,onChange:this._toggleSaveOnlyCurrentWindow}),Eie("span",{},void 0,(0,le.Z)("Save Only Tabs In Current Window"))),""!==e&&Eie("div",{className:"error-validation"},void 0,e)),Eie("footer",{className:"dialog-footer"},void 0,Eie("input",{type:"submit",className:"primary",onClick:this.onSaveSession,value:(0,le.Z)("Save"),disabled:!0===this.state.invalidInput||""===this.state.name}),Eie("input",{type:"button",onClick:this._close,value:(0,le.Z)("Cancel")})))))}}const Nie=_ie;var Mie;function Pie(e,t,n,i){Mie||(Mie="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Mie,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Die extends tn.Component{handleClick=()=>{this.props.onClose()};render(){return Pie(ln.Z,{onRequestClose:Tl.default,viewMode:"default-browser"},void 0,Pie(ZW,{onClose:this.handleClick}))}}const xie=Die;var Oie;function Lie(e,t,n,i){Oie||(Oie="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Oie,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Rie extends tn.Component{static contextType=dn.Z;state={visible:!1};componentDidMount(){Sy.addListener(this.onStoreChange),Td.addListener(this.onStoreChange),d.Z.utilities.onSharedDataUpdated.addListener(this.onSharedDataChanged),this.onStoreChange()}componentWillUnmount(){Sy.removeListener(this.onStoreChange),Td.removeListener(this.onStoreChange)}onSharedDataChanged=(e,t)=>{"syncErrorReport"===e&&"reported"===t&&this.setState({visible:!1})};onStoreChange=()=>{const e=Cd(Td.getState()),t=Sy.getState().engineData;(t.isFirstSetupComplete||"disable_sync_on_client"===t.protocolErrorClientAction)&&("credentialsMissing"===e||"loginFailed"===e||"started"===t.engineState&&t.needsDecryptionPassword||"failed"===t.engineState||"disable_sync_on_client"===t.protocolErrorClientAction?d.Z.utilities.getSharedData({key:"syncErrorReport",value:"canReport"},(e=>{"canReport"===e&&this.setState({visible:!0})})):"loggedIn"!==e||"started"!==t.engineState||t.needsDecryptionPassword||d.Z.utilities.setSharedData({key:"syncErrorReport",value:"canReport"}))};onClose=()=>{d.Z.utilities.setSharedData({key:"syncErrorReport",value:"reported"})};openSettings=()=>{ie.Z.showSettings(this.context.vivaldiWindowId,"sync"),this.onClose()};render(){return this.state.visible?Lie(ln.Z,{onRequestClose:this.onClose,dialogWidth:400,viewMode:"slide"},void 0,Lie("header",{className:"dialog-header"},void 0,Lie("h1",{className:"dialog-title"},void 0,(0,le.Z)("Sync Disabled"))),Lie("div",{className:"dialog-content"},void 0,Lie("p",{},void 0,(0,le.Z)("An issue caused Vivaldi Sync to stop working. You can find more details in the Sync Settings."))),Lie("footer",{className:"dialog-footer"},void 0,Lie("input",{type:"submit",value:(0,le.Z)("Go to Sync Settings"),onClick:this.openSettings,autoFocus:!0}),Lie("input",{type:"button",value:(0,le.Z)("Close"),onClick:this.onClose}))):null}}const Bie=Rie,Fie=new class{openSyncedTab(e){y.Z.sessions.restore(e.sessionId,(t=>{y.Z.runtime.lastError&&console.warn("Error restoring tab: ",e,y.Z.runtime.lastError)}))}openSyncedWindow(e){y.Z.sessions.restore(e.sessionId,(t=>{y.Z.runtime.lastError&&console.warn("Error restoring page: ",e,y.Z.runtime.lastError.message)}))}load(){void 0===window.vivaldiWindowId||z.ZP.isIncognitoOrGuest(window.vivaldiWindowId)||y.Z.sessions.getDevices((e=>{l.Z.dispatch({actionType:"CHROME_SET_DEVICES",devices:e})}))}};d.Z.sync.onCycleCompleted.addListener(Fie.load);const Uie=Fie;class Vie extends Us.Z{_synced_tabs=[];getSyncedTabs(){return this._synced_tabs}dispatchAction(e){if("CHROME_SET_DEVICES"===e.actionType)this._synced_tabs=e.devices,this.emitChange()}}const Wie=new Vie(l.Z);var Hie;function zie(e,t,n,i){Hie||(Hie="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Hie,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Gie extends tn.PureComponent{state={visible:!1,syncedTabs:Wie.getSyncedTabs()};componentDidMount(){Wie.addListener(this.onSyncedTabsStoreChange),this.onSyncedTabsStoreChange(),Sy.addListener(this.onSyncStoreChange),this.onSyncStoreChange()}componentWillUnmount(){Wie.removeListener(this.onSyncedTabsStoreChange),Sy.removeListener(this.onSyncStoreChange)}onSyncedTabsStoreChange=()=>{this.setState({syncedTabs:Wie.getSyncedTabs()})};onSyncStoreChange=()=>{this.setState({visible:"started"===Sy.getState().engineData.engineState})};openSyncedTab=e=>{Uie.openSyncedTab(e)};openSyncedWindow=e=>{Uie.openSyncedWindow(e)};trimTitle=e=>(e.length>70&&(e=e.substring(0,70)+"..."),e);getContextMenuItems=()=>{const e=this.state.syncedTabs.reduce(((e,t)=>e.concat(t.sessions.map((e=>{const n=e.window;if(!n)return;const i=n.tabs||[];return{items:i.map((e=>({mnemonic:!1,url:e.url,handler:this.openSyncedTab.bind(this,e),...G.Z.makeLabelPair(this.trimTitle(e.title||""))}))).concat([G.Z.separatorItem,{handler:this.openSyncedWindow.bind(this,n),...(0,Mn.Z)("Open All")}]),...(0,Mn.Z)("Window with $1 Tab on $2","Window with $1 Tabs on $2",[i.length,t.deviceName])}})))),[]).filter(Boolean);return Promise.resolve(e)};render(){return this.state.syncedTabs&&this.state.visible?zie(sl,{className:"synced-tabs-button",menu:this.getContextMenuItems,menuOrigin:"bottomLeft",disabled:0===this.state.syncedTabs.length,tooltip:(0,le.Z)("Synced Tabs"),image:cn.ssx.large}):null}}const $ie=Gie;class Kie extends Us.Z{dispatchAction(e){switch(e.actionType){case"TAB_SWITCH_BACK_SETTING":this.emitChange({action:"switchTabBackBySetting",winId:e.winId,event:e.event});break;case"TAB_SWITCH_FORWARD_SETTING":this.emitChange({action:"switchTabForwardBySetting",winId:e.winId,event:e.event});break;case"TAB_VIEW_PAGE_SOURCE":this.emitChange({action:"viewPageSource",winId:e.winId});break;case"TAB_STACK_CREATE":this.emitChange({action:"stackCreate",winId:e.winId});break;case"TAB_STACK_DISSOLVE":this.emitChange({action:"stackDissolve",winId:e.winId});break;case"TAB_STACK_REMOVE":this.emitChange({action:"stackRemove",winId:e.winId});break;case"TAB_STACK_UNTILE":this.emitChange({action:"stackUntile",winId:e.winId});break;case"TAB_STACK_TILE_GRID":this.emitChange({action:"stackTileGrid",winId:e.winId});break;case"TAB_STACK_TILE_HORIZONTAL":this.emitChange({action:"stackTileHorizontal",winId:e.winId});break;case"TAB_STACK_TILE_VERTICAL":this.emitChange({action:"stackTileVertical",winId:e.winId});break;case"TAB_TOGGLE_THUMBNAIL":this.emitChange({action:"tabThumbnail",winId:e.winId});break;case"UNLOAD_DIALOG_CLOSED":this.emitChange({action:"unloadDialogClosed",winId:e.windowId})}}}const jie=new Kie(l.Z);var Yie;function Xie(e,t,n,i){Yie||(Yie="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Yie,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Qie=function({isActive:e,orientation:t="right",onClick:n,style:i,title:s}){const o=["left","up"].includes(t)?"expanded":"closed";return Xie("div",{className:mn()("tab-position","accordion-toggle-arrow",o,{active:e}),style:i,onClick:n,title:s},void 0,Xie(mp,{type:"folder-arrow",className:t}))};var qie;function Jie(e,t,n,i){qie||(qie="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:qie,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class ese extends tn.PureComponent{_isHorizontal=()=>"top"===this.props.tabPosition||"bottom"===this.props.tabPosition;_handleKeyDown=e=>{switch(e.key){case"ArrowLeft":case"ArrowRight":case"ArrowDown":case"ArrowUp":if(this._isHorizontal()?"ArrowLeft"===e.key||"ArrowRight"===e.key:"ArrowUp"===e.key||"ArrowDown"===e.key){const t="ArrowLeft"===e.key||"ArrowUp"===e.key?"left":"right";this.props.onMoveFocus(this.props.id,t,!1)}break;case"Escape":this.props.onLeaveBar();break;default:return}e.preventDefault(),e.stopPropagation()};handleClick=e=>{this.props.onCreateTab()};render(){return Jie(sl,{style:this.props.style,className:"newtab",onKeyDown:this._handleKeyDown,onClick:this.handleClick,tooltip:(0,le.Z)("Open a New Tab"),image:cn.Wjz.large})}}const tse=ese;var nse;function ise(e,t,n,i){nse||(nse="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:nse,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class sse extends tn.PureComponent{nodeRef=tn.createRef();render(){const{faviconUrl:e,isPrivate:t,progress:n,progressType:i}=this.props,s=Math.round(100*n),o=n<1,a=e.startsWith("<svg");return o&&"spinner"===i?(0,fn.jsx)("span",{ref:this.nodeRef,className:"favicon spinner",dangerouslySetInnerHTML:{__html:cn.H0I}}):o&&"progress_icon"===i?(0,fn.jsx)("span",{ref:this.nodeRef,className:"favicon progress",style:{"--progressInPercent":s+"%"}}):(0,fn.jsx)("span",{ref:this.nodeRef,className:"favicon jstest-favicon-image "+(a?"svg":""),children:ise(Oi,{refFavicon:this.props.refFavicon,url:e,loadType:t?"faviconSkipCache":"faviconFromCache"})})}}const ose=sse;var ase;function rse(e,t,n,i){ase||(ase="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:ase,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function lse({onClick:e,onMouseDown:t}){const n=(0,le.Z)("Close Tab")+"\n"+(0,le.Z)("$1 click to close other tabs except this one",[(0,le.Z)("key","Alt")]);return rse("button",{className:"close",dangerouslySetInnerHTML:{__html:cn.kze},onClick:e,onAuxClick:e,onMouseDown:t,title:n})}const dse=function(e,t,n,i){const s=()=>{e.removeEventListener("mousemove",l),e.removeEventListener("mouseup",c)},o=(e,n,s,a)=>{d.Z.tabsPrivate.onDragEnd.removeListener(o),y.Z.runtime.sendMessage({dispatchAction:mne}),!e&&n&&Y.Z.detachPage((0,fa.aV)(t),s,a),i&&i.onDragEnd()},a=n.pageX,r=n.pageY,l=n=>{if(Math.abs(n.pageX-a)>5||Math.abs(n.pageY-r)>5){s();const a=(i?i.element:n.target).getBoundingClientRect(),r=i?i.offsetLeft:0,l=i?i.offsetTop:0,c=i?i.offsetHeight:0,h=i?i.offsetWidth:0;y.Z.runtime.sendMessage({dispatchAction:gne}),d.Z.tabsPrivate.onDragEnd.addListener(o);const[p]=t;d.Z.tabsPrivate.startDrag({windowId:e.vivaldiWindowId,mimeType:Q.Up,customData:JSON.stringify({ids:t.map((e=>e.id)),active:(t.find((e=>e.active))||p).id}),url:p.url,title:p.title,posX:a.left+r,posY:a.top+l,width:a.width+h,height:a.height+c,cursorX:10,cursorY:10}),i&&i.onDragStart(t)}},c=()=>{s()};e.addEventListener("mousemove",l),e.addEventListener("mouseup",c)},cse=function(){let e,t,n,i,s;return function(o,a,r,l){const d=(new Date).getTime();o!==e||a!==t?(e=o,t=a,n=d):o===e&&a===t&&o!==i&&a!==s&&n&&d-n>r&&(l(),i=o,s=a,e=t=n=void 0)}},hse=(e,t,n=!0)=>Boolean(t&&e.ctrlKey),pse=(e,t,n=!0)=>Boolean(t&&e.shiftKey);var use,gse=n(34155);function mse(e,t,n,i){use||(use="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:use,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const vse=cse();function fse(e,t){if(t)return 1;switch((pv.Z.getNavigationInfo(e)||{}).trigger){case"start":return 0;case"stop":return 1;case"commit":case"content":{const t=eb.getProgressInfo(e);return t?Math.min(Math.max(t.progress,0),1):1}}return 1}var yse=mse("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"3px",className:"svg-tab-selection"},void 0,mse("line",{className:"inner",x1:"0",y1:"0",x2:"100%",y2:"0"}),mse("line",{className:"outer",x1:"0",y1:"0",x2:"100%",y2:"0"})),wse=mse("rect",{className:"stack-frame",width:"100%",height:"100%"}),bse=mse("rect",{className:"inner",width:"100%",height:"100%"}),Cse=mse("rect",{className:"outer",width:"100%",height:"100%"});class Sse extends tn.PureComponent{static contextType=dn.Z;#n=!1;refTab=tn.createRef();refFavicon=tn.createRef();constructor(e){super(e),this.indicators={},this.isIMEOpen=!1;const t=St.jk.getDisplayTitleByUrl(e.url,e.title),n=oie(t,e.url,9),i=e.isStack&&!e.isSubstrip?(0,le.Z)("Tab stack with $1 tab","Tab stack with $1 tabs",[e.stackSize]):t;this.state={dragOver:"none",awaitingEdit:null,fadeDiscardedTabs:e.prefValues[D.kTabsDimHibernated],loadingProgress:fse(e.pageId,e.isInternalPage),mediaState:F5.getState().get(e.pageId)||(0,fa.l4)(),timeLeft:void 0,displayTitle:t,titleNumber:n,tabTitle:i}}componentDidMount(){F5.addListener(this._onMediaStateStoreChanged),eb.addListener(this._onProgressStateStoreChanged),this.#n=!0,this.props.active&&gse.nextTick((()=>this._scrollIntoView()))}componentWillUnmount(){this.#n=!1,eb.removeListener(this._onProgressStateStoreChanged),F5.removeListener(this._onMediaStateStoreChanged),H.Z.ensureRemovedListener(this._alarmsChanged)}componentDidUpdate(e){!e.active&&this.props.active&&this._scrollIntoView(),!0===e.active&&!1===this.props.active&&null!==this.state.awaitingEdit&&this.setState({awaitingEdit:null}),!1===e.discarded&&!0===this.props.discarded&&(this.discardedFadeInTimeId&&(clearTimeout(this.discardedFadeInTimeId),delete this.discardedFadeInTimeId),this.props.prefValues[D.kTabsDimHibernated]||(this.discardedFadeInTimeId=setTimeout(this.clearFadedDiscardedTabs,2e3)),this.setState({fadeDiscardedTabs:!0}));const t=e.stackSize!==this.props.stackSize;if(e.url!==this.props.url||e.title!==this.props.title){const e=St.jk.getDisplayTitleByUrl(this.props.url,this.props.title),n=oie(e,this.props.url,9);let i;i=t&&this.props.isStack&&!this.props.isSubstrip?(0,le.Z)("Tab stack with $1 tab","Tab stack with $1 tabs",[this.props.stackSize]):e,this.setState({displayTitle:e,titleNumber:n,tabTitle:i})}this.props.doMonitorAlarms&&H.Z.ensureAddedListener(this._alarmsChanged)}_scrollIntoView=()=>{const e=this.refTab.current;if(e){const t=this.isHorizontal();this.context.window.requestAnimationFrame((function(){t?e.scrollIntoView():e.scrollIntoViewIfNeeded(!0)}))}};_alarmsChanged=e=>{if(!e)return;const t=e.find((e=>e?.id===this.props.extId));if(t)switch(t.type){case"RELOAD":if(this.props.extId===t.id){const e=W.Z.getPageByReloadId(t.id);e&&Y.Z.reloadPage(e.id)}break;case"TIME_CHANGED":this.setState({timeLeft:t.remainingTime})}else this.state.timeLeft&&this.setState({timeLeft:null})};_onProgressStateStoreChanged=()=>{this.setState({loadingProgress:fse(this.props.pageId,this.props.isInternalPage)})};_onMediaStateStoreChanged=()=>{this.setState({mediaState:F5.getState().get(this.props.pageId)||(0,fa.l4)()})};clearFadedDiscardedTabs=()=>{this.#n&&this.setState({fadeDiscardedTabs:!1})};discardPages=e=>{e.forEach(Y.Z.discardPage)};cloneTab=e=>{Y.Z.clonePages(fa.aV.of(e))};cloneTabs=e=>{Y.Z.clonePages(e)};async reloadTabStack(e){const t=W.Z.getActivePage(e),n=t?(0,uv.av)(t):null,i=W.Z.getGroup(n,e);t&&i.size>1&&await Promise.all(i.map((async e=>{this.reloadTab(e.id)})))}reloadTab=e=>{Y.Z.clearSelection(this.context.vivaldiWindowId),Y.Z.reloadPage(e)};renameTabStack=()=>{const e=this.props.groupId;e&&this.setState({awaitingEdit:e})};toggleMediaRemoting=()=>{const e=this.props.prefValues[D.kMediaRouterMediaRemotingEnabled];nt.Z.set(D.kMediaRouterMediaRemotingEnabled,!e)};setPinned=(e,t)=>{Y.Z.clearSelection(this.context.vivaldiWindowId),Y.Z.setPinned(e,t)};bookmarkAllOpenPages=()=>{Y.Z.clearSelection(this.context.vivaldiWindowId),i.Z.bookmarkAllOpenPages(this.context.vivaldiWindowId,en.ZP.getRootNode().id)};bookmarkTab=(e,t)=>{Y.Z.clearSelection(this.context.vivaldiWindowId),i.Z.bookmarkPages(e,this.context.vivaldiWindowId,t,en.ZP.getRootNode().id)};handleClose=e=>{const t=W.Z.getPageById(this.props.pageId);t&&e.button===vn.Z.kLeft&&(e.altKey?this.closeAllButTab(t):e.shiftKey||e.ctrlKey||e.metaKey||this.props.closePage(t),e.preventDefault())};closeToLeft=(e,t)=>{Y.Z.closeToLeft(this.context.vivaldiWindowId,e,t)};closeToRight=(e,t)=>{Y.Z.closeToRight(this.context.vivaldiWindowId,e,t)};closeTabStack=()=>{Y.Z.closeTabStack(this.props.pageId)};handleMedia=e=>{if(this.state.mediaState.has("pip"))Y.Z.exitPictureInPicture(this.props.pageId);else{const t=W.Z.getPageById(this.props.pageId);t&&this.togglePagesMuted(e,fa.aV.of(t))}};togglePagesMuted=(e,t)=>{Y.Z.toggleMuting(e,t)};closeAllButTab=(e,t)=>{const n=!t;Y.Z.closeOther(e,n)};blockEvent=e=>{e.stopPropagation(),e.preventDefault()};containEvent=e=>{e.stopPropagation()};customize=()=>{ie.Z.showSettings(this.context.vivaldiWindowId,"tabs")};disolveTabStack=()=>{const e=this.context.vivaldiWindowId;Y.Z.clearSelection(e),Y.Z.expandTabStack(e,this.props.groupId)};isTabstackingEnabled=()=>"off"!==this.props.prefValues[D.kTabsStackingMode];isTabStack=e=>{const t=(0,uv.av)(e);return!!t&&W.Z.isGroup(t,this.context.vivaldiWindowId)};isPinned=e=>e.pinned;tileTabStack=()=>{const e=this.props.groupId;Y.Z.tileTabStack(e,this.context.vivaldiWindowId),Y.Z.clearSelection(this.context.vivaldiWindowId)};isPageTiledWithType=e=>{const t=W.Z.getPageById(this.props.pageId);return Boolean(t&&(0,$5.gO)(t)&&this.props.tilingType===e)};tileSelection=e=>{const t=e.count()<4?"row":"grid";Y.Z.tilePages(e.toList(),t),Y.Z.clearSelection(this.context.vivaldiWindowId)};untilePages=()=>{const e=this.props.tilingId;Y.Z.untileTileGroup(e,this.context.vivaldiWindowId),Y.Z.clearSelection(this.context.vivaldiWindowId)};mouseEnterHandler=()=>{this.props.clearForceHover()};indicatorOnDragStart=e=>{this.props.setPageIdsHiddenForDrag((0,fa.l4)(e.map((e=>e.id))))};indicatorOnDragEnd=()=>{this.props.setPageIdsHiddenForDrag((0,fa.l4)())};onTabIndicatorPress=(e,t,n)=>{n.preventDefault(),n.stopPropagation(),this.props.prefValues[D.kTabsStackingAllowDnd]&&this.onTabIndicatorDragOut(e,t,n)};onTabIndicatorClick=(e,t)=>{t.preventDefault(),t.stopPropagation();const{prefValues:n}=this.props;if(t.button===vn.Z.kLeft){const i=z.ZP.isActive(this.context.vivaldiWindowId);hse(t,n[D.kTabsSelectionEnabled],i)?Y.Z.setSelection(e,!1,!1):pse(t,n[D.kTabsSelectionEnabled],i)?Y.Z.setSelection(e,!0,!1):(0,Bu.Z)(t)||this.props.onActivate(e)}else t.button,vn.Z.kCenter};onTabIndicatorDragOut=(e,t,n)=>{const i=this.props.getDraggedPages(e);dse(this.context,i,n,{offsetLeft:2,offsetTop:3,offsetHeight:-6,offsetWidth:-2,onDragStart:this.indicatorOnDragStart,onDragEnd:this.indicatorOnDragEnd,element:this.indicators[t]})};renderTabGroupIndicator=()=>mse("div",{className:"tab-group-indicator"},void 0,W.Z.getGroup(this.props.groupId,this.context.vivaldiWindowId).map((e=>{const t=mn()({"tab-indicator":!0,active:this.props.highlightId===e.id,marked:this.props.isSelecting&&this.props.checkSelected(e.id),unread:this.props.prefValues[D.kTabsUnread]&&this.props.isUnread&&e.id!==this.props.highlightId}),n={visibility:this.props.isHiddenForDrag?"hidden":"visible"},i=`stack-${e.id}`;return(0,fn.jsx)("div",{ref:e=>{e&&(this.indicators[i]=e)},className:t,style:n,title:St.jk.getDisplayTitle(e),onContextMenu:this.onContextMenu.bind(this,!0),onClick:this.onTabIndicatorClick.bind(this,e),onMouseDown:this.onTabIndicatorPress.bind(this,e,i),children:this.props.isSelecting&&this.props.checkSelected(e.id)&&yse},i)})));keyDown=e=>{const{prefValues:t}=this.props,{ctrlKey:n,altKey:i,shiftKey:s,metaKey:o}=e,a={ctrlKey:n,altKey:i,shiftKey:s,metaKey:o},r=t[D.kTabsSelectionEnabled];if(!this.state.awaitingEdit){switch(e.key){case"Enter":case" ":const n=W.Z.getPageById(this.props.pageId);n&&this.props.onActivate(n);break;case"ArrowLeft":case"ArrowRight":case"ArrowDown":case"ArrowUp":const i=this.isHorizontal();if((0,xr.Mr)(a)&&r){const t=W.Z.getPageById(this.props.pageId);t&&(("ArrowLeft"===e.key&&i||"ArrowUp"===e.key&&!i)&&Y.Z.expandSelectionPrevious(t),("ArrowRight"===e.key&&i||"ArrowDown"===e.key&&!i)&&Y.Z.expandSelectionNext(t))}if((0,xr.S2)(a)){const n="dotted"===t[D.kTabsStackingMode];if(i){if("ArrowLeft"===e.key||"ArrowRight"===e.key){const t=W.Z.getPageById(this.props.pageId);t&&(Y.Z.stepPage(t,"ArrowRight"===e.key,n,this.context.vivaldiWindowId),r&&gse.nextTick((()=>{Y.Z.setSelection(t,!1,!1,!0)})))}}else if("ArrowUp"===e.key||"ArrowDown"===e.key){const t=W.Z.getPageById(this.props.pageId);t&&(Y.Z.stepPage(t,"ArrowDown"===e.key,n,this.context.vivaldiWindowId),r&&gse.nextTick((()=>{Y.Z.setSelection(t,!1,!1,!0)})))}}if((0,xr.VV)(a)){if(i?"ArrowLeft"===e.key||"ArrowRight"===e.key:"ArrowUp"===e.key||"ArrowDown"===e.key){const t="ArrowLeft"===e.key||"ArrowUp"===e.key?"left":"right";Y.Z.clearSelection(this.context.vivaldiWindowId),gse.nextTick((()=>this.props.onMoveFocus(this.props.id,t,!1)))}else if(!this.props.isSubstrip&&this.props.isStack){const e=this.refTab.current;e instanceof Element&&this.props.onStackMenu(this.props.pageId,e)}}break;case"Escape":Y.Z.clearSelection(this.context.vivaldiWindowId),this.props.onLeaveBar();break;default:return}e.preventDefault(),e.stopPropagation()}};createGroup=(e,t)=>{const n=e.sort(((e,t)=>e.index-t.index)),i=t.index-n.findIndex((e=>e===t));Y.Z.createTabStack(n,i,(0,uv.av)(t))};createGroupByHost=(e,t)=>{const n=W.Z.getNewGroupId();Fne(n,t),Y.Z.createTabStack(e,void 0,n)};getGroupsForHosts=()=>{const e=W.Z.getPages(this.context.vivaldiWindowId).filter((e=>!this.isTabStack(e))).filter((e=>!e.pinned));let t=(0,fa.aV)();return e.forEach((n=>{let i=!1;if(t.forEach((e=>{if(i=e.contains(n),i)return!1})),!i){const i=(0,Vne.q)(n),s=e.filter((e=>(0,Vne.q)(e)===i));s.size>1&&(t=t.push(s))}})),t};createGroupByHosts=()=>{this.getGroupsForHosts().forEach((e=>{this.createGroupByHost(e,(0,Vne.q)(e.first()))}))};isHorizontal=()=>{const{tabPosition:e}=this.props;return"top"===e||"bottom"===e};onContextMenu=(e,t)=>(t.persist(),t.preventDefault(),t.stopPropagation(),this.getContextMenuItemsPromise("tab",e,t).then((e=>{(0,zi.Z)(this.context.vivaldiWindowId,e)(t)})),!1);getContextMenuItemsPromise=(e,t,n)=>{const i=this.context.vivaldiWindowId,s=W.Z.getPageById(this.props.pageId);if(!s)return Promise.reject("Tab.jsx: Expected page not found");const o=this.context.vivaldiWindowId,{isStack:a,groupId:r}=this.props,l=this.props.isSelecting&&this.props.isSelected&&this.props.getSelectionCount()>1,c=W.Z.getSelectedPages(o),h=c.filter((e=>W.Z.canClosePage(e))),p=W.Z.getPages(o).filter((e=>!c.find((t=>t.id===e.id)))),u=z.ZP.isGuestSession(o),[g,m]=(0,Vne.d)(s,W.Z.getTabs(o,!this.isTabstackingEnabled())),v=!s.active&&!s.discarded&&!s.isInspected&&s.url!==W.Z.getDefaultStartpage(this.context.vivaldiWindowId),f=a&&W.Z.getGroup(r,this.context.vivaldiWindowId).some((e=>!e.active&&!e.discarded&&!e.isInspected&&e.url!==W.Z.getDefaultStartpage(this.context.vivaldiWindowId))),w=W.Z.getDiscardablePages(o),b=W.Z.getPages(o).count(),C=W.Z.isGroup(r,this.context.vivaldiWindowId),S=t||!C?b>=2:b-W.Z.getGroup(r,this.context.vivaldiWindowId).count()>=1;let T;T=l?c:!t&&a?W.Z.getGroup(r,this.context.vivaldiWindowId):fa.aV.of(s);const I={isMultiSelect:l,count:c.count(),closableCount:h.count(),unSelectedCount:p.count(),unpinned:c.filter((e=>!this.isPinned(e))).count(),pinned:c.filter(this.isPinned).count(),playing:c.filter((e=>F5.hasMediaState(e.id,"playing")||F5.hasMediaState(e.id,"muting"))).count(),canHibernateCount:c.filter((e=>!e.active&&!e.isInspected)).count(),hostname:g,hostnameCount:m.count(),horizontal:this.isHorizontal(),someIncognito:c.some((e=>s.incognito)),canCloneCount:c.filter((e=>!(0,St.m7)(e))).count()},k=Ai.getOptionFunction(e),A=this.props.extId,Z=()=>new Promise((e=>{y.Z.windows.getAll({populate:!0,windowTypes:["normal"]},(t=>{t=t.filter((e=>e.id!==this.context.vivaldiWindowId)).filter((e=>!e.vivExtData||"settings"!==JSON.parse(e.vivExtData).windowType)),Promise.all(t.map((e=>new Promise((t=>{e.id?d.Z.runtimePrivate.isGuestSession(e.id,(n=>{t({w:e,isGuest:n})})):t({w:e,isGuest:!1})}))))).then((t=>{const{vivaldiWindowId:i}=this.context,d=t.filter((e=>z.ZP.isGuestSession(i)?e.isGuest:z.ZP.isIncognito(i)?e.w.incognito&&!e.isGuest:!e.isGuest&&!e.w.incognito)).map((e=>e.w));let h=[];d.length>0&&(h=h.concat(G.Z.separatorItem,d.map(((e,t)=>{const n=e.tabs||[],d=n.find((e=>e.active)),h=d&&d.url?St.jk.getDisplayTitleByUrl(d.url,d.title||d.url):t+1;return{handler:()=>{const t=l?c:a?W.Z.getGroup(r,o):fa.aV.of(s);t.count()===W.Z.getPages(i).count()&&document.querySelectorAll("webview").forEach((e=>e.parentElement?.removeChild(e))),e.id&&Y.Z.moveToWindow(t,e.id)},...(0,Mn.Z)("Window with $1 Active Tab ($2)","Window with $1 Active Tabs ($2)",[n.length,h])}})))),z.ZP.isIncognitoOrGuest(i)||(h.push(G.Z.separatorItem),h.push({handler:()=>{T.count()===W.Z.getPages(i).count()&&document.querySelectorAll("webview").forEach((e=>e.parentElement?.removeChild(e))),Y.Z.detachPage(T,n.screenX,n.screenY)},...(0,Mn.Z)("To New Window")})),e(h)}))}))}));return Ai.getNamedMenu(i,e,(async e=>{switch(e.action){case"CONTEXT_NEW":return{handler:()=>this.props.onCreateTab(!l&&C&&r?r:void 0),...k(i,e,I)};case"CONTEXT_RELOAD":return{handler:l?this.reloadTab.bind(this,c.map((e=>e.id))):this.reloadTab.bind(this,s.id),...k(i,e,I)};case"CONTEXT_CLONE":return{visible:l?!c.every(St.m7):!(0,St.m7)(s),handler:l?()=>Y.Z.clonePages(c):()=>Y.Z.clonePages(fa.aV.of(s)),...k(i,e,I)};case"CONTEXT_PIN":return{handler:l?()=>{this.setPinned(c,!0)}:()=>{this.setPinned(fa.aV.of(s),!0)},visible:!(this.props.isSubstrip||this.props.isInsideAccordion)&&(l?!c.some(this.isTabStack)&&c.some((e=>!this.isPinned(e))):!s.pinned),...k(i,e,I)};case"CONTEXT_UNPIN":return{handler:l?()=>{this.setPinned(c,!1)}:()=>{this.setPinned(fa.aV.of(s),!1)},visible:l?!c.some(this.isTabStack)&&c.some(this.isPinned):s.pinned,...k(i,e,I)};case"CONTEXT_MUTE":return{handler:l?()=>this.togglePagesMuted(i,c):()=>this.togglePagesMuted(i,fa.aV.of(s)),visible:!l||c.some((e=>F5.hasMediaState(e.id,"playing")||F5.hasMediaState(e.id,"muting"))),checked:l?c.every((e=>F5.hasMediaState(e.id,"muting"))):s.vivExtData.vivaldi_tab_muted,...k(i,e,I)};case"CONTEXT_CONTAINER_PERIODIC_TIMER":const n=l?"select":a?"stack":"tab",d=l||"tab"===n?A:r;return{items:xl.Z.getMenu(d,n,s.windowId),visible:!this.props.isInternalPage,...k(i,e,I)};case"CONTEXT_MUTE_OTHER":return{handler:()=>Y.Z.muteAllExcept(i,[s]),visible:!l&&W.Z.getPages(i).some((e=>e.id!==s.id&&F5.hasMediaState(e.id,"playing"))),...k(i,e,I)};case"CONTEXT_OPTIMIZE_FS_VIDEOS":return{handler:this.toggleMediaRemoting,type:"checkbox",checked:this.props.prefValues[D.kMediaRouterMediaRemotingEnabled],visible:this.state.mediaState.has("capturing"),...k(i,e,I)};case"CONTEXT_BOOKMARK":return{handler:l?this.bookmarkTab.bind(this,c,!1):this.bookmarkTab.bind(this,s,!1),visible:!u,...k(i,e,I)};case"CONTEXT_BOOKMARK_STACK":return{handler:this.bookmarkTab.bind(this,W.Z.getGroup(r,this.context.vivaldiWindowId),!0),visible:a&&!u,...k(i,e,I)};case"CONTEXT_BOOKMARK_ALL":return{handler:this.bookmarkAllOpenPages,visible:!u,...k(i,e,I)};case"CONTEXT_SAVE_SESSION":return{handler:c.count()>0?()=>ie.Z.showSaveSessionDialog(i,{mode:"selected",ids:c.map((e=>e.id)).toArray()}):()=>ie.Z.showSaveSessionDialog(i,{mode:"all"}),visible:!u,...k(i,e,I)};case"CONTEXT_TABSTACK_BY_SELECTION":{const t=c.filter((e=>!this.isPinned(e)));return{handler:()=>this.createGroup(t,s),visible:l&&this.isTabstackingEnabled()&&this.props.isSelecting&&t.count()>1,...k(i,e,I)}}case"CONTEXT_TABSTACK_BY_HOST":return{handler:()=>{this.createGroupByHost(m,g)},visible:this.isTabstackingEnabled()&&!a&&m.count()>1,...k(i,e,I)};case"CONTEXT_TABSTACK_BY_HOSTS":return{handler:()=>this.createGroupByHosts(),visible:this.isTabstackingEnabled()&&!this.getGroupsForHosts().isEmpty(),...k(i,e,I)};case"CONTEXT_TABSTACK_RELOAD":return{handler:()=>this.reloadTabStack(i),visible:a,...k(i,e,I)};case"CONTEXT_TABSTACK_RENAME":return{handler:this.renameTabStack,visible:a&&!this.props.isSubstrip&&!this.props.isInsideAccordion,...k(i,e,I)};case"CONTEXT_TABSTACK_REMOVE_FROM":return{handler:()=>this.props.removeFromTabStack(this.props.pageId),visible:t,...k(i,e,I)};case"CONTEXT_TABSTACK_UNGROUP":return{handler:this.disolveTabStack,visible:a,...k(i,e,I)};case"CONTEXT_TILE_TABSTACK":return{handler:this.tileTabStack,visible:a&&!this.isPageTiledWithType("group")&&!this.isPageTiledWithType("selection"),...k(i,e,I)};case"CONTEXT_UNTILE_TABSTACK":return{handler:this.untilePages,visible:a&&(this.isPageTiledWithType("group")||this.isPageTiledWithType("selection")),...k(i,e,I)};case"CONTEXT_TILE_TABS":return{handler:this.tileSelection.bind(this,c),visible:l&&!this.isPageTiledWithType("selection")&&this.props.isSelecting&&c.count()>1,...k(i,e,I)};case"CONTEXT_UNTILE_SELECTION":return{handler:this.untilePages,visible:this.isPageTiledWithType("selection")&&!a,...k(i,e,I)};case"CONTEXT_HIBERNATE_TAB":return{handler:this.discardPages.bind(this,fa.aV.of(s)),visible:!l&&v&&(this.props.isSubstrip||!a),...k(i,e,I)};case"CONTEXT_HIBERNATE_SELECTED_BACKGROUND_TABS":return{handler:this.discardPages.bind(this,c.filter((e=>!e.active))),visible:Boolean(c.filter((e=>w.find((t=>t.id===e.id)))).count()),...k(i,e,I)};case"CONTEXT_HIBERNATE_TABSTACK":return{handler:this.discardPages.bind(this,W.Z.getGroup(r,this.context.vivaldiWindowId).filter((e=>!e.active))),visible:f,...k(i,e,I)};case"CONTEXT_HIBERNATE_BACKGROUND":const y=w.filter((e=>!(0,$5.ZN)(e)));return{handler:this.discardPages.bind(this,y),visible:y.count()>0,...k(i,e,I)};case"CONTEXT_CLOSE":return{handler:l?()=>this.props.closePage(h):()=>this.props.closePage(s),visible:W.Z.canClosePage(s),...k(i,e,I)};case"CONTEXT_CLOSE_TABSTACK":return{handler:this.closeTabStack,visible:a,...k(i,e,I)};case"CONTEXT_CLOSE_OTHER":return{handler:l&&p.count()>0?this.closeAllButTab.bind(this,c,t):this.closeAllButTab.bind(this,s,t),visible:l&&p.count()>0||!l&&S,...k(i,e,I)};case"CONTEXT_CLOSE_LEFT":return{handler:()=>this.closeToLeft(s,t),visible:!l&&S&&W.Z.getPages(this.context.vivaldiWindowId).takeUntil((e=>e.id===s.id)).count()>0,...k(i,e,I)};case"CONTEXT_CLOSE_RIGHT":return{handler:()=>this.closeToRight(s,t),visible:!l&&S&&W.Z.getPages(this.context.vivaldiWindowId).skipUntil((e=>e.id===s.id)).skip(1).count()>0,...k(i,e,I)};case"CONTEXT_REOPEN":return{visible:Boolean(Ine.Z.getTrash().length),...k(i,e,I)};case"CONTEXT_CONTAINER_PWA":return{visible:s.active&&!this.props.isInternalPage,container:{content:"pwa"},...k(i,e,I)};case"CONTEXT_CUSTOMIZE":return{handler:this.customize,visible:!u,...k(i,e,I)};case"CONTEXT_MOVE":return{visible:l&&!c.some((e=>s.incognito))||!l&&(t||!a),...k(i,e,I)};case"CONTEXT_TABSTACK_MOVE":return{visible:!l&&!t&&a,...k(i,e,I)};case"CONTEXT_MOVE_LEFT":return{handler:()=>Y.Z.stepPage(s,!1,!1,o),visible:!l,...k(i,e,I)};case"CONTEXT_MOVE_RIGHT":return{handler:()=>Y.Z.stepPage(s,!0,!1,o),visible:!l,...k(i,e,I)};case"CONTEXT_MOVE_STACK_LEFT":return{handler:()=>Y.Z.stepPage(s,!1,!0,o),visible:!l,...k(i,e,I)};case"CONTEXT_MOVE_STACK_RIGHT":return{handler:()=>Y.Z.stepPage(s,!0,!0,o),visible:!l,...k(i,e,I)};case"CONTEXT_CONTAINER_MOVE_TO_WINDOW":return{items:await Z(),...k(i,e,I)};default:return{...k(i,e,I)}}}))};isKnownDropMimeType=e=>e.dataTransfer.types.some((e=>e===Q.Up||"text/uri-list"===e||"text/plain"===e));onDragEnterHandler=e=>{const{groupId:t,prefValues:n,isInsideAccordion:i,handleExpandAccordion:s}=this.props;t&&"accordion"===n[D.kTabsStackingMode]&&!i&&s&&(clearTimeout(this.accordionExpandTimeout),this.accordionExpandTimeout=setTimeout((()=>s(t)),1e3)),this.isKnownDropMimeType(e)&&(e.preventDefault(),e.stopPropagation())};onDragLeaveHandler=e=>{e.persist();this.props.groupId&&"accordion"===this.props.prefValues[D.kTabsStackingMode]&&!this.props.isInsideAccordion&&clearTimeout(this.accordionExpandTimeout),this.props.onDragLeave(e)};onDragOverHandler=e=>{if(this.isKnownDropMimeType(e)&&(e.preventDefault(),e.stopPropagation()),e.dataTransfer.types.includes("vivaldi/x-button-toolbar"))return;const t=this.props.handleTabPosition;if(t&&this.props.isExpectingDrop&&e.dataTransfer.types.some((e=>e===Q.Up))){const{pageX:n,pageY:i}=e,s=this.getDropSide(n,i);t(this.props.pageId,s)}else{e.dataTransfer.types.some((e=>"text/uri-list"===e||"text/plain"===e))&&(e.dataTransfer.dropEffect="copy");const t=W.Z.getPageById(this.props.pageId);t&&vse(e.screenX,e.screenY,250,(()=>this.props.onActivate(t)))}};getDropSide=(e,t)=>{if(!(this.refTab.current instanceof Element))return"before";const{pinned:n,prefValues:i,direction:s,isSubstrip:o,isInsideAccordion:a}=this.props,r=!n&&i[D.kTabsStackingAllowDnd]&&"off"!==i[D.kTabsStackingMode]&&!o&&!a,l=this.refTab.current.getBoundingClientRect(),[d,c]=[e-l.left,t-l.top];return"row"===s?r?d<.15*l.width?"before":d>.85*l.width?"after":"over":d<l.width/2?"before":"after":"column"===s?r?c<.15*l.height?"before":c>.85*l.height?"after":"over":c<l.height/2?"before":"after":"before"};onDropHandler=e=>{this.isKnownDropMimeType(e)&&(e.preventDefault(),e.stopPropagation());const t=e.dataTransfer.getData(Q.Up),n=e.dataTransfer.getData("text/uri-list"),i=e.dataTransfer.getData("text/plain");t?this.props.droppedTabHandler(t):n?n.split("\n").forEach(((e,t)=>Y.Z.openURL(this.context.vivaldiWindowId,e,{incognito:this.props.incognito,inCurrent:0===t,inSpecificPageId:0===t?this.props.pageId:void 0,inBackground:0!==t}))):i&&(0,Ni.K2)(i)&&Y.Z.openURL(this.context.vivaldiWindowId,i,{inCurrent:!0,inSpecificPageId:this.props.pageId,incognito:this.props.incognito})};onFocusHandler=e=>{if(this.state.awaitingEdit)return;const t=W.Z.getPageById(this.props.pageId);t&&Y.Z.setSelection(t,!1,!1,!0)};renderCustomTabStackTitle=e=>{const t=this.props.groupId,n=W.Z.getTitleByGroupId(t,e),i=()=>{this.isIMEOpen=!0},s=()=>{this.isIMEOpen=!1},o=e=>{"Enter"!==e.key||this.isIMEOpen?"Escape"===e.key&&(e.preventDefault(),e.stopPropagation(),this.setState({awaitingEdit:null})):(e.preventDefault(),e.stopPropagation(),e.target instanceof HTMLInputElement&&l(e.target.value))},a=e=>{e&&document.activeElement!==e&&e.select()},r=e=>{l(e.target.value)},l=e=>{Fne(t,e),this.setState({awaitingEdit:null})},{awaitingEdit:d}=this.state;return t&&t===d?(0,fn.jsx)("input",{className:"tab-title-edit",defaultValue:n,ref:a,onBlur:r,onKeyDown:o,onMouseDown:this.containEvent,onCompositionStart:i,onCompositionUpdate:i,onCompositionEnd:s}):n};renderStackFrame=(e,t)=>{const{prefValues:n,isHiddenForDrag:i,accordionFrameSize:s,isDragging:o}=this.props,a=this.isHorizontal(),r="accordion"===n[D.kTabsStackingMode],l=t||this.props.isInsideAccordion&&this.props.isFirstInGroup;let d,c,h=null;if(l){if(s>0)a?d=`${s}px`:c=`${s}px`;else{const e=!r||o||i?0:16;a?d=`calc(var(--Width) + ${e}px)`:c=`calc(var(--Height) + ${e}px)`}h={width:d,height:c}}return mse("svg",{xmlns:"http://www.w3.org/2000/svg",width:t&&!a?"100%":null,height:t&&a?"100%":null,style:h,className:mn()({"svg-tab-selection":e,"svg-tab-stack":l})},void 0,l&&wse,e&&bse,e&&Cse)};render(){const{discarded:e,prefValues:t,faviconUrl:n,isInternalPage:i,isStack:s,pinned:o,isUnread:a,shouldShowCloseButton:r}=this.props,{loadingProgress:l,mediaState:d,timeLeft:c,displayTitle:h,titleNumber:p,tabTitle:u}=this.state,g=this.props.active,m=Boolean(this.props.smallTab),v=0===d.size||e,f=Boolean(this.props.isSelecting&&(!this.props.isHidden&&this.props.isSelected||this.props.highlighted)),y=t[D.kTabsStackingMode],w=s&&!this.props.isSubstrip&&"off"!==y&&("dotted"===y||t[D.kTabsStackingPreferDotted]),b=mn()({tab:!0,"tab-acceptsdrop":this.props.acceptsDrop,marked:f,pinned:o,active:g,uifocusstop:g,highlighted:this.props.highlighted&&!t[D.kTabsSelectionEnabled],"tab-small":m&&!o,"tab-mini":this.props.miniTab&&!o,"tab-accordion":this.props.isStack&&"accordion"===y,"tab-in-accordion":this.props.isInsideAccordion,"tab-first-in-group":this.props.isFirstInGroup,"tab-last-in-group":this.props.isLastInGroup,"force-hover":this.props.forceHover,"tab-group":w,"audio-on":d.has("playing")||d.has("pip"),"audio-muted":d.has("muting"),"tab-captured":d.has("capturing"),"button-off":!r,unread:t[D.kTabsUnread]&&a&&!g&&!s&&!i,isdiscarded:this.state.fadeDiscardedTabs&&e,insubstrip:this.props.isSubstrip}),C="progress_bar"===t[D.kTabsPageLoadInfo]&&!i&&(g&&!this.props.addressBarVisible||g&&!t[D.kAddressBarShowProgress]||!g),S=c||C,T=c||l,I=g?t[D.kKeyboardTabToAll]:"-1";return(0,fn.jsxs)(fn.Fragment,{children:[(0,fn.jsxs)("div",{id:this.props.id,className:b,ref:this.refTab,"data-id":this.props.id,title:t[D.kTabsTooltip]?null:u,onContextMenu:e=>this.onContextMenu(this.props.isSubstrip||this.props.isInsideAccordion,e),onMouseEnter:this.mouseEnterHandler,onMouseDown:e=>e.preventDefault(),onDragEnter:this.onDragEnterHandler,onDragOver:this.onDragOverHandler,onDragLeave:this.onDragLeaveHandler,onDrop:this.onDropHandler,onKeyDown:this.keyDown,onFocus:t[D.kTabsSelectionEnabled]?this.onFocusHandler:null,tabIndex:I,children:[mse("div",{className:"tab-header",style:this.props.isExpectingDrop?{pointerEvents:"none"}:null},void 0,S&&mse(Jte,{progress:T}),mse(ose,{isPrivate:z.ZP.isIncognitoOrGuest(this.context.vivaldiWindowId),refFavicon:this.refFavicon,faviconUrl:n,progress:this.state.loadingProgress,progressType:"progress_icon"===t[D.kTabsPageLoadInfo]||"spinner"===t[D.kTabsPageLoadInfo]?t[D.kTabsPageLoadInfo]:void 0}),mse("span",{className:"title",onDoubleClick:t[D.kTabsMinimize]||t[D.kTabsDoubleClickClose]?null:this.renameTabStack},void 0,!s||this.props.isSubstrip||this.props.isInsideAccordion?h:this.renderCustomTabStackTitle(h)),this.props.shouldShowStackCounter&&mse("div",{className:"stack-counter"},void 0,this.props.stackSize),r&&mse(lse,{onClick:this.handleClose,onMouseDown:this.blockEvent}),!v&&mse("span",{className:"tab-audio",onClick:()=>this.handleMedia(this.context.vivaldiWindowId),onAuxClick:this.handleClose,onMouseDown:this.blockEvent},void 0,d.has("capturing")?mse("span",{className:"audioicon",width:"16",height:"16",dangerouslySetInnerHTML:{__html:cn.MjM}}):mse(b9,{color:m||o?"#111":void 0,animated:t[D.kThemeUseAnimation],mediaState:d})),t[D.kTabsCounterDetection]&&p&&mse("span",{className:"button-badge"},void 0,p)),t[D.kTabsThumbnails]&&mse(hj,{src:this.props.thumbnail}),(f||(s||this.props.isInsideAccordion&&this.props.isFirstInGroup)&&!this.props.isSubstrip&&!w)&&this.renderStackFrame(f,s)]}),w&&this.renderTabGroupIndicator()]})}}const Tse=Sse;var Ise=n(65810);class kse extends Z.Z{getInitialState(){return null}allHidden(){return null===this.getState()}getShowTooltip(e){return this.getState()===e}reduce(e,t){switch(t.actionType){case"URLFIELD_SET_STATE":return null;case"WEBPAGEVIEW_ACTIONS":if(["focusSearchField","focusAddressField"].indexOf(t.subAction)>-1)return null;break;case"TOOLTIP_SET":if(!us.Z.getState().isActive)return t.id}return e}}const Ase=new kse;var Zse,Ese=n(34155);function _se(e,t,n,i){Zse||(Zse="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Zse,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Nse="vivaldi-tooltip";function Mse(){let e=document.getElementById(Nse);if(!e){const t=document.getElementById("browser");e=document.createElement("div"),e.id=Nse,t&&t.appendChild(e)}return e}Ase.addListener((()=>{Ase.allHidden()&&Ur.unmountComponentAtNode(Mse())}));class Pse extends tn.Component{static contextType=dn.Z;nodeRef=tn.createRef();state={show:Ase.getShowTooltip(this.props.id)};#D=!1;componentWillUnmount(){Ase.removeListener(this._onStoreChange),Ese.nextTick(Ise.Z.hideTooltip)}componentDidMount(){Ase.addListener(this._onStoreChange),this.props.disabled||this.renderToolTip()}componentDidUpdate(e,t){this.props.disabled||t.show===this.state.show&&e.stackSize===this.props.stackSize||this.renderToolTip()}_onStoreChange=()=>{this.setState({show:Ase.getShowTooltip(this.props.id)})};onDragEnter=()=>{Ise.Z.hideTooltip(0),this.#D=!0};onDragLeave=()=>{this.#D=!1};onMouseEnter=()=>{if(!this.props.disabled&&!this.#D){const e=Ase.allHidden()?this.props.appearDelay:0;Ise.Z.showTooltip(this.props.id,e)}};onMouseLeave=()=>{this.props.disabled||Ise.Z.hideTooltip(this.props.disappearDelay)};onClick=()=>{Ise.Z.hideTooltip(0)};tooltipIsOpen=()=>{const e=Mse().firstChild;return Boolean(e instanceof Element&&e.classList.contains("tooltip"))};getPosition=(e,t)=>{const{Element:n}=this.context,i=this.nodeRef.current;let s,o;if(!(i&&i.firstChild instanceof n))return{left:s,top:o};const a=i.firstChild.getBoundingClientRect(),r=this.props.noPadding?0:4;if("above"===this.props.placement){s=a.left+a.width/2-e/2,o=a.top-t-r}else if("after"===this.props.placement)s=a.left+a.width+r,o=a.top;else if("before"===this.props.placement)s=a.left-e-r,o=a.top;else{s=a.left+a.width/2-e/2,o=a.top+a.height+r}return s<0&&(s=0),o<0&&(o=0),s+e>this.context.innerWidth&&(s-=s+e-this.context.innerWidth),o+t>this.context.innerHeight&&(o-=o+t-this.context.innerHeight),{left:s,top:o}};renderToolTip=()=>{if(!this.state.show)return;const{width:e,height:t,content:n}=this.props.content(this.props.id),{left:i,top:s=0}=this.getPosition(e,t),o=s+t>=this.context.innerHeight,a=o?"flex-end":"flex-start",r=this.props.noPadding?0:4,l=0===s?r:0,d=o?r:0,c=this.props.pointerEvents,h=["after","before"].includes(this.props.placement)?`top ${this.props.transitionSpeed}ms`:`left ${this.props.transitionSpeed}ms`,p="before"===this.props.placement||"after"===this.props.placement;Ur.render(_se("div",{className:"tooltip",style:{top:s,left:i,pointerEvents:c,height:p?"auto":t,width:e,paddingTop:l,paddingBottom:d,alignItems:a,transition:h},onClick:this.onClick,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},void 0,n),Mse())};render(){return(0,fn.jsx)("span",{ref:this.nodeRef,onDragEnter:this.onDragEnter,onDragLeave:this.onDragLeave,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:this.props.children})}}const Dse=Pse;var xse=n(10695),Ose=n.n(xse),Lse=n(7065),Rse=n(34155);function Bse({accordionIsOpen:e,draggedActive:t,droppedTabs:n,isSubstrip:i,isTabStackingEnabled:s,maybeResetDragging:o,tabStackingMode:a,allTabs:r,substripTabs:l,yieldAfter:d,yieldBefore:c,yieldOver:h,windowId:p}){const u=JSON.parse(n),g=u.ids.map((e=>parseInt(e))).sort(((e,t)=>e-t)),m=(0,fa.aV)(r).filter((e=>g.some((t=>e.id===t)))).map(Lse.OK),v=h?W.Z.getPages(p).find((e=>e.id===h&&!e.pinned)):void 0;if(v){let e=(0,uv.av)(v);const n=s&&W.Z.isGroup(e,p),i=v.windowId===m.first().windowId;let a,r,l;if(n)a=W.Z.getGroup(e,p).first().index,r=W.Z.getGroup(e,p).concat(m);else{a=v.index,r=i&&m.first().index<a?(0,fa.aV)(m).push(v):fa.aV.of(v).concat(m),e=W.Z.getNewGroupId();const n=t&&(0,uv.av)(t);n&&W.Z.isGroup(n,p)&&(l=W.Z.getTitleByGroupId(n,""))}if(i){const e=m.reduce(((e,t)=>t.index<a?e+1:e),0);a-=e}Y.Z.createTabStack(r,a,e).then((()=>{e&&l&&Fne(e,l)})),o()}else{const t=()=>Rse.nextTick(o),n=u.active,v=function(e,t,n,i,s,o,a,r){if(a){const e=W.Z.getPages(r).find((e=>e.id===a));return e?e.index:-1}const l=W.Z.getPages(r).find((e=>e.id===s||e.id===o));if(!l)return-1;const d=(0,uv.av)(l);let c;if(n&&W.Z.isGroup(d,r))if("accordion"===i&&e(d))c=l.id;else{const e=W.Z.getGroup(d,r);c=s?e.first().id:e.last().id}else c=l.id;return W.Z.getPages(r).filter((e=>e.id!==t)).findIndex((e=>e.id===c))+(o?1:0)}(e,g[0],s,a,c,d,h,p);if(i)if(1===l.size)Y.Z.createTabStack(l.map((e=>e.page)).concat(m),v,W.Z.getNewGroupId());else{const e=(0,uv.av)(l.first()?.page);e&&Y.Z.moveDroppedTabs(m,n,v,e,p).then(t)}else if("accordion"===a){const i=r.map(Lse.OK).map((e=>(0,uv.av)(e)??"")),s=(0,fa.aV)(i).countBy((e=>e)),o=m.reduce(((e,t)=>e.add((0,uv.av)(t)??"")),new fa.l4),a=u.sourceWindow===p,l=i[v]??"",d=i[v+(v<u.activeIndex?-1:1)]??"";let c;c=a?l&&e(l)&&d===l?l:1===o.size&&s.get(o.first())===m.size?void 0:"":void 0,Y.Z.moveDroppedTabs(m,n,v,c,p).then(t)}else{const e="main"!==u.dragSource?"":void 0;Y.Z.moveDroppedTabs(m,n,v,e,p).then(t)}}y.Z.windows.update(p,{focused:!0})}var Fse,Use=n(74678),Vse=n(37441);function Wse(e,t,n,i){Fse||(Fse="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Fse,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Hse=cse(),zse=180,Gse=150,$se=30,Kse=31,jse={stiffness:400,damping:32,precision:.1};var Yse=Wse("hr",{}),Xse=Wse("span",{className:"dragspace"});class Qse extends tn.PureComponent{static contextType=dn.Z;currentHoveredId=0;#n;refTabStrip=tn.createRef();refTabs=new Map;#x=!1;#O;state={isDragging:!1,start:[0,0],draggedActive:null,draggedPages:(0,fa.aV)(),pageIdsHiddenForDrag:(0,fa.l4)(),isYielding:!1,yieldBefore:null,yieldAfter:null,yieldOver:null,freeze:null,addressBarVisible:z.ZP.getVisibleUI(this.context.vivaldiWindowId).addressBar,animate:!1,highlightedId:"",isDraggingPinnedTab:!1,activeAlarms:new fa.l4,canScrollLeft:!1,canScrollRight:!1,scrollableAreaWidth:void 0,mouse:[0,0],delta:[0,0],enterSide:"none",hoveredPageId:-1,hoverPercent:0,isMouseOverScrollArrow:!1};componentDidMount(){this.setOverflowClass(),this.allowDelayedAnimation(),z.ZP.addListener(this.onWindowStoreChanged),Qi.Z.addListener("COMMAND_FOCUS_TABBAR",this.onCommandSpy),Qi.Z.addListener("COMMAND_RENAME_TAB_STACK",this.onCommandSpy),Qi.Z.addListener("COMMAND_TAB_MOVE_FIRST",this.onCommandSpy),Qi.Z.addListener("COMMAND_TAB_MOVE_END",this.onCommandSpy),this.context.addEventListener("dragenter",this.windowDragEnterHandler),this.context.addEventListener("dragleave",this.windowDragLeaveHandler),this.context.addEventListener("dragover",this.windowDragOverHandler),this.context.addEventListener("drop",this.windowDropHandler),H.Z.addListener(this._alarmsChanged),this.#n=!0}componentWillUnmount(){this.#n=!1,this.animateTimeoutId&&clearTimeout(this.animateTimeoutId),this.#O&&URL.revokeObjectURL(this.#O),z.ZP.removeListener(this.onWindowStoreChanged),Qi.Z.removeListener("COMMAND_FOCUS_TABBAR",this.onCommandSpy),Qi.Z.removeListener("COMMAND_RENAME_TAB_STACK",this.onCommandSpy),Qi.Z.removeListener("COMMAND_TAB_MOVE_FIRST",this.onCommandSpy),Qi.Z.removeListener("COMMAND_TAB_MOVE_END",this.onCommandSpy),this.context.removeEventListener("dragenter",this.windowDragEnterHandler),this.context.removeEventListener("dragleave",this.windowDragLeaveHandler),this.context.removeEventListener("dragover",this.windowDragOverHandler),this.context.removeEventListener("drop",this.windowDropHandler),H.Z.removeListener(this._alarmsChanged)}componentDidUpdate(e){this.props.tabs===e.tabs&&this.props.maxWidth===e.maxWidth&&this.props.maxHeight===e.maxHeight||(this.setOverflowClass(),this.updateScrollStatus()),this.props.pages!==e.pages&&(this.maybeResetDragging(),this.props.pages.size>e.pages.size&&this.state.freeze&&this.setState({freeze:null}))}_alarmsChanged=e=>{e&&this.setState((t=>{const n=e.map((e=>e?.id||""));return{activeAlarms:t.activeAlarms.union(n)}}))};isTabStackingEnabled=()=>!this.props.isSubstrip&&"off"!==this.props.prefValues[D.kTabsStackingMode];setOverflowClass=()=>{const{Element:e}=this.context,t=this.refTabStrip.current;if(t&&("left"===this.props.tabPosition||"right"===this.props.tabPosition))if(t instanceof e&&t.clientHeight<t.scrollHeight){if(this.props.setOverflowClass(!0,this.props.isSubstrip),this.props.switchByScroll){const e=t.getElementsByClassName("tab active")[0];e&&"function"==typeof e.scrollIntoViewIfNeeded&&e.scrollIntoViewIfNeeded()}}else this.props.setOverflowClass(!1,this.props.isSubstrip)};maybeSpring=(e,t)=>this.state.animate&&this.props.prefValues[D.kThemeUseAnimation]&&!this.props.isResizing&&this.fitsInView()?(0,B2.ST)(e,t):e;fitsInView=Uu()(1)((()=>"row"===this.props.direction?this.props.tabs.size*$se<this.props.maxWidth:this.props.tabs.size*$se<this.props.maxHeight));allowDelayedAnimation(){this.animateTimeoutId&&clearTimeout(this.animateTimeoutId),this.animateTimeoutId=setTimeout((()=>{this.setState({animate:!0})}),1e3)}onCommandSpy=(e,t)=>{switch(t){case"COMMAND_FOCUS_TABBAR":ss(this.refTabStrip.current)||this.moveFocus("","current",!0);break;case"COMMAND_RENAME_TAB_STACK":{const t=W.Z.getActivePage(e);if(t&&(0,uv.av)(t)){this.refTabs.get(t.id)?.current?.renameTabStack()}break}case"COMMAND_TAB_MOVE_FIRST":Y.Z.stepTabsToStart(e);break;case"COMMAND_TAB_MOVE_END":Y.Z.stepTabsToEnd(e)}};accordionIsOpen=e=>Boolean(e&&this.props.openAccordions?.some((t=>t.groupId===e)));onWindowStoreChanged=()=>{this.setState({addressBarVisible:z.ZP.getVisibleUI(this.context.vivaldiWindowId).addressBar})};getNewTabButtonId(){return"newtab-"+(this.props.isSubstrip?"sub":"main")}moveFocus=(e,t,n)=>{const{HTMLElement:i}=this.context;if(!0===n||ss(this.refTabStrip.current)){let n=[];const s=this.refTabStrip.current;if(s instanceof i&&(n=Array.from(s.querySelectorAll("div.tab")).map((e=>e.getAttribute("data-id"))).filter(Boolean)),0===n.length)return;if("current"===t){if(""===e&&s instanceof i){const t=s.getElementsByClassName("tab active")[0];t instanceof i&&(e=t.getAttribute("data-id"))}const t=n.indexOf(e);if(-1===t)return;e=n[t]}else if("right"===t||"left"===t){if(1===n.length)return;let i=n.indexOf(e);if(-1===i)return;i="right"===t?i+1>=n.length?0:i+1:i<=0?n.length-1:i-1,e=n[i]}if(s instanceof i){const t=e===this.getNewTabButtonId()?s.querySelector("div.toolbar-tabbar button"):s.querySelector(`div.tab[data-id="${e}"]`);t&&(t.focus(),this.setState({highlightedId:e}))}}};openStackMenu=(e,t)=>{if(this.isTabStackingEnabled()){const n=W.Z.getPageById(e);if(n){const e=(0,uv.av)(n);if(W.Z.isGroup(e,this.context.vivaldiWindowId)){const n=W.Z.getGroup(e,this.context.vivaldiWindowId).toArray().map(((e,t)=>({url:e.url,handler:()=>Y.Z.activateTab(e.id,this.context.vivaldiWindowId),...G.Z.makeNumberMnemonic(e.title,t)}))),i="top"===this.props.tabPosition||"bottom"===this.props.tabPosition?"bottomLeft":"left"===this.props.tabPosition?"topRight":"topLeft";(0,zi.Z)(this.context.vivaldiWindowId,n,void 0,i,t)()}}}};handleLeaveBar=()=>{this.setState({highlightedId:""});const e=this.context.vivaldiWindowId;ie.Z.setPaneFocus(e,!1),a.Z.executeActions(e,"COMMAND_FOCUS_WEBVIEW")};closeAndFreeze=e=>{const t=e instanceof fa.aV?e:fa.aV.of(e),n="on"===this.props.prefValues[D.kTabsClosePinned]?t:t.filter((e=>!e.pinned));if(0!==n.size){if(1===n.size){const e=n.first();!e.pinned&&this.props.prefValues[D.kTabsAlignNext]&&this.freezeTabSize(e)}this.setState({animate:!1},(()=>{this.props.closePage(n).then((()=>{this.allowDelayedAnimation()}))}))}};freezeTabSize=e=>{const{Element:t}=this.context,n=()=>{this.setState({freeze:null}),this.context.removeEventListener("mousemove",i)},i=e=>{const i=this.refTabStrip.current;if(i instanceof t){const t=i.getBoundingClientRect();(t.left>e.clientX||t.left+t.width<e.clientX||t.top>e.clientY||t.top+t.height<e.clientY)&&n()}},s=e=>{const t=this.createFlexBoxLayout(this.props.tabs,this.props.direction,this.props.maxWidth,this.props.maxHeight,{pageIdsHiddenForDrag:this.state.pageIdsHiddenForDrag,freeze:this.state.freeze,yieldBefore:this.state.yieldBefore,yieldAfter:this.state.yieldAfter,tabStackingEnabled:this.isTabStackingEnabled(),isThumb:this.props.prefValues[D.kTabsThumbnails]}).children.map((e=>"tab"===e.type?e:void 0)).filter(Boolean),n=t.findIndex((t=>t.page.id===e)),s=t[n];if(s){let e;e=s.page.active?t[n+1]:s;const o=e.page.id;o&&this.setState({freeze:{width:e.layout?.width||this.props.maxWidth,height:s.layout?.height||this.props.maxHeight,nextId:o}}),this.context.addEventListener("mousemove",i)}},o=this.props.tabs.getIn([-1,"page","id"]);e.id!==o?s(e.id):n()};handleTouchMove=e=>{e.preventDefault(),this.maybeStartDragging(e.touches[0])};handleMouseMove=e=>{e.preventDefault(),e.button===vn.Z.kLeft?this.maybeStartDragging(e):this.endInternalDragging()};handleMouseUp=e=>{this.endInternalDragging()};handleAccordionToggle=(e,t)=>{e&&(t?this.setState({animate:!1},(()=>{this.props.handleCompressAccordion?.(e),this.allowDelayedAnimation()})):this.props.handleExpandAccordion?.(e))};handleClick=(e,t)=>{const{prefValues:n,isSubstrip:i}=this.props,s=z.ZP.isActive(this.context.vivaldiWindowId);if(hse(t,n[D.kTabsSelectionEnabled],s))Y.Z.setSelection(e,!1,!1);else if(pse(t,n[D.kTabsSelectionEnabled],s))if("accordion"===this.props.prefValues[D.kTabsStackingMode]){Y.Z.setSelection(e,!0,!1);const t=W.Z.getSelectedPages(this.context.vivaldiWindowId),n=t.get(0),i=n?(0,uv.av)(n):null;i&&t.some((e=>i!==(0,uv.av)(e)))&&Y.Z.setSelection(e,!0,!0)}else Y.Z.setSelection(e,!0,!i)};handleMouseUpGuard=e=>{e.button===vn.Z.kCenter&&(e.preventDefault(),e.stopPropagation())};handleAuxClick=(e,t)=>{t.button===vn.Z.kCenter&&(this.closeAndFreeze(e),t.preventDefault(),t.stopPropagation())};handleMouseDown=(e,t,n,i)=>{const s=i.detail%2==0;if(i.button===vn.Z.kLeft&&!s){i.preventDefault();z.ZP.isActive(this.context.vivaldiWindowId);(0,Bu.Z)(i)||(this.props.onActivateTab(e),this.initDragging(i,e,t,n))}};handleDoubleClick=(e,t)=>{t.preventDefault(),t.stopPropagation();const{prefValues:n}=this.props,i=z.ZP.isActive(this.context.vivaldiWindowId);hse(t,n[D.kTabsSelectionEnabled],i)?Y.Z.toggleRelatedSelection(e):n[D.kTabsDoubleClickClose]?Y.Z.closePage(e):"accordion"===n[D.kTabsStackingMode]&&this.props.toggleAutoExpandAccordion?.((0,uv.av)(e))};handleTouchStart=(e,t,n,i)=>{this.initDragging(i.touches[0],e,t,n)};onDragEnterHandler=e=>{if(e.dataTransfer.types.some((e=>e===Q.Up))&&this.props.isExpectingDrop)return e.preventDefault(),void e.stopPropagation();e.dataTransfer.types.some((e=>"text/uri-list"===e||"text/plain"===e))&&(e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="copy")};onDragLeaveHandler=()=>{clearTimeout(this.removeYieldTimeoutId),this.removeYieldTimeoutId=setTimeout((()=>{this.#n&&(this.setState({yieldAfter:null,yieldBefore:null,yieldOver:null,hoveredPageId:void 0}),clearTimeout(this.removeYieldAnimationTimeoutId),this.removeYieldAnimationTimeoutId=setTimeout((()=>{this.state.yieldBefore||this.state.yieldAfter||!this.#n||this.setState({isYielding:!1})}),2e3))}),200)};onDragOverHandler=e=>{if(clearTimeout(this.removeYieldTimeoutId),e.dataTransfer.types.some((e=>e===Q.Up))&&this.props.isExpectingDrop){e.preventDefault(),e.stopPropagation();const t=300;this.removeYieldTimeoutId=setTimeout((()=>{this.#n&&this.setState({yieldAfter:null,yieldBefore:null})}),t)}else e.dataTransfer.types.some((e=>"text/uri-list"===e||"text/plain"===e))&&(e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="copy")};onDropHandler=e=>{e.preventDefault(),e.stopPropagation();const t=e.dataTransfer.getData(Q.Up),n=e.dataTransfer.getData("text/uri-list"),i=e.dataTransfer.getData("text/plain"),s=this.context.vivaldiWindowId;this.props.isExpectingDrop&&t?this.droppedTabHandler(t):n?n.split("\n").forEach(((e,t)=>Y.Z.openURL(s,e,{inCurrent:!1,inBackground:t>0}))):i&&Of.Z.go(s,[i],{inCurrent:!1,enableSearch:this.props.prefValues[D.kAddressBarInlineSearchEnabled]})};droppedTabHandler=e=>{y.Z.tabs.query({},(t=>{this.setState({animate:!1},(()=>{Bse({accordionIsOpen:this.accordionIsOpen,draggedActive:this.state.draggedActive,droppedTabs:e,isSubstrip:this.props.isSubstrip,isTabStackingEnabled:this.isTabStackingEnabled(),maybeResetDragging:this.maybeResetDragging,tabStackingMode:this.props.prefValues[D.kTabsStackingMode],allTabs:t,substripTabs:this.props.tabs,yieldAfter:this.state.yieldAfter,yieldBefore:this.state.yieldBefore,yieldOver:this.state.yieldOver,windowId:this.context.vivaldiWindowId}),this.allowDelayedAnimation()}))}))};showSubStack=(0,Zr.Z)((e=>this.props.showSubStack?.(e)),100);doPositionUpdate=()=>{this.pendingPositionInfo&&this.setState(this.pendingPositionInfo),this.pendingPositionInfo=void 0,this.requestedFrame=void 0};scheduleTabPositionUpdate(e){this.pendingPositionInfo=e,this.requestedFrame||(this.requestedFrame=requestAnimationFrame(this.doPositionUpdate))}handleTabPosition=(e,t)=>{clearTimeout(this.removeYieldTimeoutId),"before"===t?this.scheduleTabPositionUpdate({isYielding:!0,yieldBefore:e,yieldAfter:null,yieldOver:null}):"after"===t?this.scheduleTabPositionUpdate({isYielding:!0,yieldBefore:null,yieldAfter:e,yieldOver:null}):"over"===t?(this.scheduleTabPositionUpdate({yieldOver:e}),this.props.isSubstrip||this.showSubStack(e)):"none"===t&&(this.scheduleTabPositionUpdate({yieldBefore:null,yieldAfter:null,yieldOver:null}),clearTimeout(this.expireYieldTimeoutId),this.expireYieldTimeoutId=setTimeout((()=>{if(this.#n){const{yieldBefore:e,yieldAfter:t,yieldOver:n}=this.state;e||t||n||this.scheduleTabPositionUpdate({isYielding:!1})}}),1e3))};setPageIdsHiddenForDrag=e=>{this.setState({pageIdsHiddenForDrag:e})};windowDragEnterHandler=e=>{e.dataTransfer&&e.dataTransfer.types.some((e=>e===Q.Up))&&(e.preventDefault(),e.stopPropagation(),this.windowDragOverHandler(e))};windowDragLeaveHandler=e=>{if(e.dataTransfer&&e.dataTransfer.types.some((e=>e===Q.Up))){e.preventDefault(),e.stopPropagation();0===e.pageX&&0===e.pageY&&this.handleTabPosition(-1,"none")}};windowDragOverHandler=e=>{if(e.dataTransfer&&e.dataTransfer.types.some((e=>e===Q.Up))){e.preventDefault(),e.stopPropagation(),this.delayedActivateWindow(e);const{yieldBefore:t,yieldAfter:n,yieldOver:i}=this.state;if(!i&&!t&&!n){const e=this.state.pageIdsHiddenForDrag.first();if(!e||!this.props.pages.some((t=>t.id===e))){const e=this.props.pages.getIn([-1,"id"]);e&&this.handleTabPosition(e,"after")}}}};windowDropHandler=e=>{const{dataTransfer:t}=e;if(t&&t.types.some((e=>e===Q.Up))){e.preventDefault(),e.stopPropagation();const n=t.getData(Q.Up),i=JSON.parse(n),s=i.ids.map((e=>parseInt(e))).sort(((e,t)=>e-t));y.Z.tabs.query({},(t=>{if(t.find((e=>s.includes(e.id)&&e.windowId!==this.context.vivaldiWindowId))){const e=(0,fa.aV)(t).filter((e=>s.some((t=>e.id===t)))).map(Lse.OK);(()=>{Y.Z.moveDroppedTabs(e,i.active,-1,void 0,this.context.vivaldiWindowId)})()}else{const t=s.map((e=>parseInt(e))).map((e=>W.Z.getPages(this.context.vivaldiWindowId).find((t=>t.id===e)))).filter(Boolean);if(t.length===W.Z.getPages(this.context.vivaldiWindowId).count())return void this.maybeResetDragging();t.length?Y.Z.detachPage((0,fa.aV)(t),e.screenX,e.screenY):(this.maybeResetDragging(),console.warn("Dropped Page(s) does not exist:",s))}}))}};delayedActivateWindow({screenX:e,screenY:t}){Hse(e,t,250,(()=>y.Z.windows.update(this.context.vivaldiWindowId,{focused:!0})))}maybeResetDragging=()=>{if(!this.#n)return;const{pageIdsHiddenForDrag:e,isYielding:t,yieldOver:n}=this.state;(!e.isEmpty()||t||n)&&this.setState({isYielding:!1,yieldBefore:null,yieldAfter:null,yieldOver:null,pageIdsHiddenForDrag:(0,fa.l4)(),isDragging:!1,hoveredPageId:void 0})};handleEscKey=()=>{this.abortAndRevertDragging()};abortAndRevertDragging=()=>{this.state.draggedPages.forEach((e=>Y.Z.moveToIndex(e,e.index))),this.cleanupDragging(),this.maybeResetDragging()};initDragging=({pageX:e,pageY:t},n,i,s)=>{let o;this.context.addEventListener("touchmove",this.handleTouchMove,!0),this.context.addEventListener("mousemove",this.handleMouseMove,!0),this.context.addEventListener("touchend",this.handleMouseUp,!0),this.context.addEventListener("mouseup",this.handleMouseUp,!0),vn.Z.setWebviewPointerEvents(!1,this.context.document),wd.Z.bind("esc",this.handleEscKey);const{isSelecting:a,pageSelection:r,isSubstrip:l}=this.props,d=(0,uv.av)(n),c=this.isTabStackingEnabled()&&W.Z.isGroup(d,this.context.vivaldiWindowId),h=a&&r.has(n.id),p=this.props.prefValues[D.kTabsStackingMode];o=h?r.reduce(((e,t)=>{const n=W.Z.getPages(this.context.vivaldiWindowId).find((e=>e.id===t));return n?e.push(n):e}),(0,fa.aV)()):c&&("dotted"===p||"substrip"===p&&!l||"accordion"===p&&!this.accordionIsOpen(d))?W.Z.getGroup(d,this.context.vivaldiWindowId):fa.aV.of(n),this.setState({draggedActive:n,draggedPages:o,start:[e,t],isDragging:!1,delta:[e-i,t-s],mouse:[i,s],yieldBefore:null,yieldAfter:null})};maybeStartDragging=e=>{let{isDragging:t}=this.state;const{tabs:n,direction:i,maxWidth:s,maxHeight:o,prefValues:a}=this.props,{pageX:r,pageY:l}=e,[d,c]=this.state.start;if(!t){if(!(Math.abs(d-r)>5||Math.abs(c-l)>5))return;t=!0}const h=this.createFlexBoxLayout(n,i,s,o,{freeze:this.state.freeze,pageIdsHiddenForDrag:this.state.pageIdsHiddenForDrag,yieldBefore:this.state.yieldBefore,yieldAfter:this.state.yieldAfter,tabStackingEnabled:this.isTabStackingEnabled(),isThumb:a[D.kTabsThumbnails]}),p=this.props.tabs.find((e=>this.state.draggedActive?.id===e.page.id));if(!p)return;const u="group"===p.type?this.accordionIsOpen(p.id)?String(p.page.id):p.id:String(p.page.id),g={top:0,right:0,bottom:0,left:0,width:0,height:0},m=h.children?.find((e=>"tab"===e.type&&e.tabId===u))?.layout??g,[v,f]=this.state.delta;let[y,w]=[r-v,l-f];const b=h.children?.filter((e=>"tab"===e.type)),C=(0,Use.Z)(b).layout??g,S=(0,BT.default)(b).layout??g;"column"===i&&(y+50<C.left||y-50>S.left)||"row"===i&&(w+50<C.top||w-50>S.top||this.isHorizontalScrollingEnabled()&&this.state.isMouseOverScrollArrow)?this.startDragging(p,0,0):(y="row"===i?y:m.left,w="column"===i?w:m.top,y=(0,jf.default)(y,C.left-5,S.left+5),w=(0,jf.default)(w,C.top-5,S.top+5),this.setState({mouse:[y,w],isDragging:t,isDraggingPinnedTab:p.page.pinned}),this.props.setIsInternalDragging?.(!0),this.detectInternalOverlap(p,m,h,i,y,w))};detectInternalOverlap=async(e,t,n,i,s,o)=>{if(this.dragOverTimeoutId&&(clearTimeout(this.dragOverTimeoutId),delete this.dragOverTimeoutId),this.#x)return;const a="accordion"===this.props.prefValues[D.kTabsStackingMode],r=a&&this.accordionIsOpen((0,uv.av)(e.page))?String(e.page.id):String(e.id),l=this.state.draggedPages.map((e=>String(e.id)));let d;for(let e=0;e<n.children?.length;e+=1){const a=n.children[e];if("tab"===a.type&&(a.tabId!==r&&a.layout&&!l.find((e=>e===a.tabId)))){let e;if("row"===i){const{width:n,left:i}=a.layout,o=s+n/2;e=o>i-(t.width-n)&&o<i+n}else{const{height:n,top:i}=a.layout,s=o+t.height/2;e=s>i&&s<i+n}if(e){d=a;break}}}if(d){const t=this.context.vivaldiWindowId,n=d.page;if(n){const i=this._getPagesFromDraggedSet(),s=(0,uv.av)(n);let o=n.index;if(!this.props.isSubstrip&&s&&!this.accordionIsOpen(s)&&W.Z.isGroup(s,t)){const e=W.Z.getGroup(s,t);o=o<i.first().index?e.first().index:e.last().index}const r=this.state.draggedPages.size>1;this.#x=!0,!r&&a&&("string"==typeof s&&this.accordionIsOpen(s)?await(0,Vse.V)(e.page.id,{group:s}):await(0,Vse.V)(e.page.id,{group:void 0})),await Y.Z.moveToIndex(this.accordionIsOpen(s)?e.page:i,o),this.#x=!1}}else{if(this.isTabStackingEnabled()&&this.props.prefValues[D.kTabsStackingAllowDnd]){const e={...t,left:s,top:o},l=n.children??[];let d,p=0;for(let t=0;t<l.length;t+=1){const n=l[t],{type:i,layout:s}=n,o=a&&n.page&&this.accordionIsOpen((0,uv.av)(n.page));if(s&&"tab"===i&&n.tabId!==r&&!o){const t=(c=s,h=e,Math.max(0,Math.min(c.left+c.width,h.left+h.width)-Math.max(c.left,h.left))*Math.max(0,Math.min(c.top+c.height,h.top+h.height)-Math.max(c.top,h.top)));if(p=t/(s.width*s.height)*100,p<60&&p>10){d=n;break}}}if(!d)return this.currentHoveredId=0,void this.setState({enterSide:"none",hoveredPageId:-1});const{layout:u,page:g}=d??{};if(!u||!g)return;const{left:m,width:v,top:f,height:y}=u;let w;w="row"===i?s<m+v/2?"before":"after":o<f+y/2?"before":"after";const b=this.state.enterSide,C=g.id;if(this.currentHoveredId!==C&&this.setState({enterSide:w}),this.currentHoveredId=C??-1,b===w){const e=this.props.prefValues[D.kTabsStackingDndDelay];-1===this.state.hoveredPageId&&(clearTimeout(this.dragOverTimeoutId),this.dragOverTimeoutId=setTimeout((()=>{this.state.isDragging&&this.setState({hoveredPageId:C,hoverPercent:p})}),e))}else this.setState({hoveredPageId:-1,hoverPercent:0})}var c,h}};_getPagesFromDraggedSet=()=>{const e=W.Z.getPages(this.context.vivaldiWindowId);return this.state.draggedPages.flatMap((t=>[e.find((e=>e.id===t.id))]))};getDragImageData=(e,t)=>{this.#O&&URL.revokeObjectURL(this.#O);const n=document.createElement("canvas"),i=n.getContext("2d"),s=16,o=180*window.devicePixelRatio,a=27*window.devicePixelRatio;let r;return n.width=o,n.height=a,i.fillStyle=this.props.theme.colorBg,function(e,t,n,i){e.beginPath(),e.moveTo(i,0),e.lineTo(t-i,0),e.quadraticCurveTo(t,0,t,i),e.lineTo(t,n-i),e.quadraticCurveTo(t,n,t-i,n),e.lineTo(i,n),e.quadraticCurveTo(0,n,0,n-i),e.lineTo(0,i),e.quadraticCurveTo(0,0,i,0),e.closePath(),e.clip()}(i,o,a,this.props.theme.radius),i.fill(),i.fillStyle=this.props.theme.colorFg,i.font="12px system-ui",i.fillText(t,25,a-6-3),r=e instanceof HTMLImageElement?new Promise(((t,n)=>{const r=new Image;r.crossOrigin="Anonymous",r.srcset=e.srcset,r.onload=()=>{i.drawImage(r,6,a-s-6,s,s),t(i.getImageData(0,0,o,a))},r.onerror=e=>{console.warn(e),t()}})):e instanceof HTMLSpanElement?new Promise((t=>{this.#O=URL.createObjectURL(new Blob([e.innerHTML],{type:"image/svg+xml"}));const n=new Image;n.onload=()=>{i.drawImage(n,6,a-s-6,s,s),t(i.getImageData(0,0,o,a))},n.src=this.#O})):Promise.resolve(),{width:o,height:a,imageDataPromise:r}};messageDragging=e=>{z.ZP.isIncognito(this.context.vivaldiWindowId)||z.ZP.isGuestSession(this.context.vivaldiWindowId)?this.props.setIsExpectingDrop(e):y.Z.runtime.sendMessage({dispatchAction:e?gne:mne})};createDropData=(e,t)=>JSON.stringify({ids:t.map((e=>e.id)).toJS(),active:e.id,activeIndex:e.index,dragSource:this.props.isSubstrip?"stack":"main",sourceWindow:this.context.vivaldiWindowId});startDragging=async(e,t,n)=>{const{Element:i}=this.context,{draggedPages:s}=this.state;this.cleanupDragging();const o=s.find((e=>e.active))||s.first();if(!(this.refTabStrip.current instanceof i))return;const a=this.refTabs.get(e.page.id)?.current;if(!a)return;const r=a.refTab.current,l=r instanceof i?r.getBoundingClientRect():{left:0,top:0},c=(0,uv.av)(o),h=this.isTabStackingEnabled()&&W.Z.isGroup(c,this.context.vivaldiWindowId)?4:0,p=a.refFavicon.current,u=St.jk.getDisplayTitleByUrl(o.url,o.title),g=l.left,m=l.top-h,{width:v,height:f,imageDataPromise:y}=this.getDragImageData(p,u),w=await y;this.setState({isDragging:!0},(()=>{this.messageDragging(!0),this.setupDragEndHandler(s),d.Z.tabsPrivate.startDrag({windowId:this.context.vivaldiWindowId,mimeType:Q.Up,customData:this.createDropData(o,s),imageData:w?.data.buffer,url:o.url,title:u,posX:g,posY:m,width:v,height:f,cursorX:t,cursorY:n}),this.setState({pageIdsHiddenForDrag:s.toSet().map((e=>e.id)),isDraggingPinnedTab:e.page.pinned})}))};endInternalDragging=()=>{const{vivaldiWindowId:e}=this.context,t=-1!==this.state.hoveredPageId&&W.Z.getPages(e).find((e=>e.id===this.state.hoveredPageId));if(t){let n,i=this._getPagesFromDraggedSet();const s=(0,uv.av)(t);if(n=W.Z.isGroup(s,e)?W.Z.getGroup(s,e).sort(((e,t)=>e.index-t.index)):fa.aV.of(t),n.size>0&&i.size>0){const e=n.first().index,s=i.count((t=>t.index<e)),o=e-s;i=i.first().index<n.first().index?i.concat(n):n.concat(i),Y.Z.createTabStack(i,o,(0,uv.av)(t))}}this.cleanupDragging()};cleanupDragging=()=>{this.context.removeEventListener("touchmove",this.handleTouchMove,!0),this.context.removeEventListener("mousemove",this.handleMouseMove,!0),this.context.removeEventListener("touchend",this.handleMouseUp,!0),this.context.removeEventListener("mouseup",this.handleMouseUp,!0),vn.Z.setWebviewPointerEvents(!0,this.context.document),wd.Z.unbind("esc",this.handleEscKey),!this.state.isDragging&&this.state.draggedActive?.active&&(this.state.draggedActive.pinned&&"bury"===this.props.prefValues[D.kTabsClosePinned]||this.props.prefValues[D.kTabsMinimize])&&Y.Z.minimizePage(this.context.vivaldiWindowId),this.props.setIsInternalDragging?.(!1),this.#n&&this.setState({isDragging:!1,isDraggingPinnedTab:!1,start:[0,0],delta:[0,0],hoveredPageId:-1,hoverPercent:0,isMouseOverScrollArrow:!1})};setupDragEndHandler(e){const t=(n,i,s,o)=>{if(d.Z.tabsPrivate.onDragEnd.removeListener(t),this.messageDragging(!1),n)this.abortAndRevertDragging();else if(i){const t=this.context.vivaldiWindowId;if(e.size===W.Z.getPages(t).size)return void this.maybeResetDragging();e.size&&Y.Z.detachPage(e,s,o)}else{const t=this.context.document.elementFromPoint(s,o);t&&"WEBVIEW"===t.tagName&&e.size&&Y.Z.detachPage(e,s,o)}setTimeout((()=>this.maybeResetDragging()),100)};d.Z.tabsPrivate.onDragEnd.addListener(t)}clearForceHover=()=>{this.setState((e=>e.freeze?{freeze:{...e.freeze,nextId:-1}}:null))};getScrollTabWidth=e=>e/Math.round(e/zse);getTabStyle(e,t,n,i,s,o){const{prefValues:a,isSubstrip:r}=this.props;if(t){const e={flex:i?0:1,zIndex:0,maxWidth:i?Kse:zse,maxHeight:Gse,minHeight:r?Gse:$se};return i?e.minWidth=Kse:a[D.kTabsHorizontalScrolling]?this.state.scrollableAreaWidth?e.minWidth=this.getScrollTabWidth(this.state.scrollableAreaWidth)-(s&&"accordion"===a[D.kTabsStackingMode]?16:0):e.minWidth=zse:n&&(e.minWidth=parseInt(a[D.kTabsActiveMinSize])||Kse),e}{const e={flex:i?0:1,zIndex:0,maxWidth:360,maxHeight:o&&!i?Gse:$se,minHeight:$se};return s&&"off"!==a[D.kTabsStackingMode]&&("dotted"===a[D.kTabsStackingMode]||a[D.kTabsStackingPreferDotted])&&(e.minHeight=37),e}}createFlexBoxLayout=Uu()(1)(((e,t,n,i,s)=>{const o=parseInt(this.props.prefValues[D.kTabsActiveMinSize]),a="row"===t;let r=!this.props.isSubstrip&&e.first()?.page.pinned&&!a&&this.props.prefValues[D.kTabsShowSeparator];const l=this.props.prefValues[D.kTabsStackingMode],d="accordion"===l&&this.props.openAccordions&&this.props.openAccordions.length>0?e.flatMap((e=>{if("group"===e.type&&this.accordionIsOpen((0,uv.av)(e.page))){const t=e.pages.size,n=t-1;return e.pages.map(((e,i)=>({type:"accordionTab",page:e,id:e.id,isFirst:0===i,isLast:i===n,accordionSize:t})))}return[e]})):e,c={style:{flexDirection:t,width:n,height:i},children:d.reduce(((e,t)=>{const d=t.page.pinned,c=t.page.active,h=s.tabStackingEnabled&&!this.props.isSubstrip&&"group"===t.type,p=this.getTabStyle(t,a,c,(!this.props.isSubstrip||"substrip"!==this.props.prefValues[D.kTabsStackingMode])&&d,h,s.isThumb);s.freeze&&!d&&(p.width=p.maxWidth=p.minWidth=s.freeze.width,p.height=p.maxHeight=p.minHeight=s.freeze.height),c&&!d&&s.freeze&&s.freeze.width<o&&(p.width=p.maxWidth=p.minWidth=o);const{isDragging:u,draggedPages:g,draggedActive:m}=this.state;u&&m&&m.id!==t.page.id&&g.find((e=>e.id===t.page.id))&&(p.width=p.maxWidth=p.minWidth=0,p.height=p.maxHeight=p.minHeight=0);const v=!h&&s.pageIdsHiddenForDrag.has(t.page.id),f=h&&"group"===t.type&&t.pages.every((e=>s.pageIdsHiddenForDrag.has(e.id)));(v||f)&&(a?p.width=p.maxWidth=p.minWidth=0:p.height=p.maxHeight=p.minHeight=0),r&&!d&&(e.push({type:"separator",style:{...p,maxHeight:20,minHeight:20,height:20}}),r=!1);s.yieldBefore===t.page.id&&e.push({type:"blank",style:{...this.getTabStyle(t,a,c,d,h,s.isThumb)}});const y="accordionTab"===t.type?t.accordionSize:0,w="accordionTab"===t.type&&t.isFirst,b="accordionTab"===t.type&&t.isLast,C="group"===t.type?t.pages:(0,fa.aV)();e.push({type:"tab",tabId:t.id.toString(),page:t.page,stackPages:C,style:p,isFirst:w,isLast:b,isStack:h,accordionSize:y}),"accordion"!==l||u||!h&&!t.isLast||v||f||e.push({type:"accordionToggle",page:t.page,style:{width:a?16:n,height:a?i:16,alignSelf:a?"flex-end":"center"}});return s.yieldAfter===t.page.id&&e.push({type:"blank",style:{...this.getTabStyle(t,a,c,d,h,s.isThumb)}}),e}),[])};return this.isHorizontalScrollingEnabled()&&(!this.isHorizontalScrollingEnabled()||this.state.canScrollLeft||this.state.canScrollRight)||(c.children=c.children.concat({type:"button",style:{width:30,height:30,alignSelf:a?"flex-end":"center"}})),Ose()(c),c}));getTabConfig=(e,t,n,i,s,o,a,r)=>{if(!e||!t)return;return{key:e,data:{type:"tab",page:t,isFirst:n,isLast:i,isStack:s,stackPages:o,zIndex:n||t.active?2:1,accordionSize:r},style:{x:this.maybeSpring(a.left,jse),y:this.maybeSpring(a.top,jse),width:a.width,height:a.height}}};removeFromTabStack=e=>{if(this.props.isSelecting){const e=this.props.pageSelection.flatMap((e=>{const t=W.Z.getPageById(e);return t?[t]:[]})).toList();e.isEmpty()||Y.Z.removeFromTabStack(e)}else{const t=W.Z.getPageById(e);t&&Y.Z.removeFromTabStack(t)}};getDraggedPages=e=>{const{isSelecting:t,pageSelection:n}=this.props;return t&&n.has(e.id)?this.props.pageSelection.reduce(((e,t)=>{const n=W.Z.getPages(this.context.vivaldiWindowId).find((e=>e.id===t));return n?e.push(n):e}),(0,fa.aV)()).sortBy((e=>e.index)).toArray():[e]};checkSelected=e=>this.props.pageSelection.contains(e);getSelectionCount=()=>this.props.pageSelection.size;getStyles=()=>{const e=this.props.prefValues[D.kTabsThumbnails],t=this.createFlexBoxLayout(this.props.tabs,this.props.direction,this.props.maxWidth,this.props.maxHeight,{pageIdsHiddenForDrag:this.state.pageIdsHiddenForDrag,freeze:this.state.freeze,yieldBefore:this.state.yieldBefore,yieldAfter:this.state.yieldAfter,tabStackingEnabled:this.isTabStackingEnabled(),isThumb:e});if(!t.children)return[];return t.children.map(((e,t)=>{const{direction:n,tabs:i,isExpectingDrop:s}=this.props,{layout:o}=e,a="row"===n;if(!o)return;let r,l;if(s||i.isEmpty()?(r=o.left,l=o.top):(r=this.maybeSpring(o.left,jse),l=this.maybeSpring(o.top,jse)),isNaN(o.left)||isNaN(o.width)){0;const e=this.state.freeze?this.state.freeze.width:zse;o.left=a?t*e:0,o.width=e,o.top=a?0:t*$se,o.height=$se}switch(e.type){case"tab":{const{tabId:t,page:n,isFirst:i,isLast:s,isStack:a,stackPages:r,accordionSize:l}=e;return this.getTabConfig(t,n,i,s,a,r,o,l)}case"blank":return{key:`space-${t}`,data:{type:"space"},style:{x:o.left,y:o.top,width:this.state.isDraggingPinnedTab&&a?Kse:o.width,height:o.height}};case"button":return{key:"button",data:{type:"button"},style:{x:r,y:l,width:o.width,height:o.height}};case"separator":return{key:"separator",data:{type:"separator"},style:{x:o.left,y:o.top,width:o.width,height:o.height}};case"accordionToggle":{const{page:n}=e;return{key:`accordionToggle-${t}`,data:{type:"accordionToggle",page:n},style:{x:o.left,y:a?0:o.top,width:o.width,height:o.height}}}default:console.warn("Unknown Element",e.type)}})).filter(Boolean)};getFavicon=Uu()(50)(((e,t)=>St.jk.getFaviconWithFallback(e,t)));getElementStyle=(e,t,n,i,s,o,a,r)=>{const l=r>0&&a?"fixed":void 0;return{"--PositionX":`${Math.floor(e)-r}px`,"--PositionY":`${Math.floor(t)}px`,"--Opacity":n,"--Height":`${Math.floor(i)}px`,"--Width":`${Math.floor(s)}px`,"--ZIndex":a?2:o,position:l}};setTabRef=(e,t)=>{if(t){const n=tn.createRef();n.current=t,this.refTabs.set(e,n)}else this.refTabs.delete(e)};getNewTabButtonStyle=Uu()(1)(((e,t,n,i,s,o)=>({"--PositionX":`${e}px`,"--PositionY":`${t}px`,"--Opacity":n,"--Height":`${i}px`,"--Width":`${s}px`,"--ZIndex":o,left:`${e}px`,top:`${t}px`})));isHorizontalScrollingEnabled=()=>this.props.prefValues[D.kTabsHorizontalScrolling]&&("top"===this.props.tabPosition||"bottom"===this.props.tabPosition);horizontalScroll=e=>{const t=(this.state.scrollableAreaWidth??this.props.maxWidth)*("left"===e?-1:1),n=this.refTabStrip.current;n instanceof HTMLElement&&n.scrollBy(t,0)};scrollRight=e=>{e.stopPropagation(),this.horizontalScroll("right")};scrollLeft=e=>{e.stopPropagation(),this.horizontalScroll("left")};updateScrollStatus=e=>{if(!this.isHorizontalScrollingEnabled())return;const{HTMLDivElement:t}=this.context,n=e??this.refTabStrip.current;if(n instanceof t){const{clientWidth:e,scrollWidth:t,scrollLeft:i}=n,s=n.getBoundingClientRect();this.setState({canScrollLeft:i>0,canScrollRight:(i+e)/t<1,scrollableAreaWidth:s.width})}};handleScroll=e=>{this.updateScrollStatus(e.currentTarget)};getOverflowMenu=()=>{const e=this.props.tabs.map((({page:e},t)=>{return{...G.Z.makeNumberMnemonic((n=St.jk.getDisplayTitle(e),n.length>70?n.substring(0,70)+"...":n),t),url:e.url,handler:()=>this.props.onActivateTab(e)};var n})),t=Ai.getOptionFunction("taboverflow"),n=this.context.vivaldiWindowId;return Ai.getNamedMenu(n,"taboverflow",(async i=>"CONTEXT_CONTAINER_TAB_OVERFLOW"===i.action?{items:e.toArray(),...t(n,i,{})}:{...t(n,i,{})}))};handleWheel=e=>{if(e.deltaX||e.shiftKey||this.props.prefValues[D.kMouseWheelTabSwitch]||!this.isHorizontalScrollingEnabled())return;const{Element:t}=this.context,n=(this.state.scrollableAreaWidth?this.getScrollTabWidth(this.state.scrollableAreaWidth):zse)*(e.deltaY<0?-2:2),i=this.refTabStrip.current;i instanceof t&&i.scrollBy({top:0,left:n,behavior:"smooth"})};setIsMouseOverScrollArrow=e=>{this.state.isDragging&&this.setState({isMouseOverScrollArrow:e})};render(){const e=this.props.prefValues[D.kTabsStackingMode],t=this.getStyles(),n=this.isHorizontalScrollingEnabled(),i=this.isTabStackingEnabled(),s={top:"below",bottom:"above",left:"after",right:"before"}[this.props.tabPosition];const o=this.props.prefValues[D.kThemeUseAnimation]?150:0,a=Boolean(!this.props.prefValues[D.kTabsTooltip]||!this.state.pageIdsHiddenForDrag.isEmpty()),r=(0,le.Z)("Hold to show open tabs"),l="row"===this.props.direction,{isDraggingPinnedTab:d}=this.state,c=n?this.props.pinnedWidth:0;return(0,fn.jsxs)(fn.Fragment,{children:[n&&Wse("div",{className:"toolbar toolbar-tabbar",onMouseEnter:()=>this.setIsMouseOverScrollArrow(!0),onMouseOut:()=>this.setIsMouseOverScrollArrow(!1)},void 0,Wse(sl,{className:mn()("horizontal-scroll-arrow",{disabled:!this.state.canScrollLeft}),style:{paddingRight:c},image:cn.mgF.medium,onClick:this.scrollLeft,menu:this.getOverflowMenu,menuOrigin:"top"===this.props.tabPosition?"bottomLeft":"topLeft",mimeType:Q.Up,edgeAmount:0,tooltip:(0,le.Z)("Scroll left")+"\n"+r})),Wse(B2.bg,{styles:t,children:t=>(0,fn.jsx)("div",{ref:this.refTabStrip,className:mn()("tab-strip",{"horizontal-scrolling":n,"horizontal-scrolling-smooth":n&&this.state.animate}),onDragEnter:this.onDragEnterHandler,onDragLeave:this.onDragLeaveHandler,onDragOver:this.onDragOverHandler,onDrop:this.onDropHandler,onDoubleClick:this.state.freeze?e=>e.stopPropagation():null,onContextMenu:e=>this.props.onContextMenu(e,this.props.isSubstrip),onWheel:this.handleWheel,onScroll:this.handleScroll,children:t.map(((n,r)=>{const h=n.data;if(h){if("tab"===h.type){const{page:p,stackPages:u=(0,fa.aV)(),isStack:g=!1,isFirst:m=!1,isLast:v=!1,accordionSize:f=0}=h,y=p.vivExtData.ext_id,w=p.url,b=this.props.prefValues[D.kTabsShowCloseButton]&&W.Z.canClosePage(p),C=(0,uv.av)(p)||"",S=this.state.pageIdsHiddenForDrag.has(p.id),T="accordion"===e&&f>1&&this.accordionIsOpen(C),I=!g&&S,k=g&&u.every((e=>this.state.pageIdsHiddenForDrag.has(e.id))),A=I||k,Z=Boolean(this.state.freeze?.nextId===p.id||this.props.prefValues[D.kTabsCloseButtonPermanent]&&n.style.width>66),E=p.pinned&&!d||d&&!p.pinned?void 0:this.handleTabPosition,_=this.props.isSubstrip||T,N=p.active&&this.props.isSubstripVisible&&!this.props.isSubstrip?p.id+1e3:p.id;let M=0;if(T&&m){let e=0;for(let n=r;n<t.length;n++){const i=t[n],s=i.data;if(e===f)break;0===n&&"space"===s?.type||("tab"===s?.type&&(e+=1),M+=l?i.style.width:i.style.height)}M>0&&!this.state.isDragging&&(M+=16)}const P=g&&i&&"substrip"===e&&!this.props.prefValues[D.kTabsStackingPreferDotted]&&!this.props.isSubstrip,x=this.state.isDragging&&this.state.draggedActive?.id===p.id,[O,L]=this.state.mouse,R=x&&l&&!d?Math.max(O,this.props.pinnedWidth):n.style.x,B=!x||l||d?n.style.y:Math.max(L,this.props.pinnedWidth),F=this.getElementStyle(R,B,n.style.opacity,n.style.height,this.props.isSubstrip&&!l?Math.max($se,this.props.maxWidth):n.style.width,h.zIndex,!this.props.isSubstrip&&p.pinned,this.props.isSubstrip?0:c),U=g&&!this.state.isDragging&&!this.props.isSubstrip&&!T&&!this.props.prefValues[D.kTabsStackingPreferDotted]&&("substrip"===e||"accordion"===e);return Wse(Dse,{id:N,noPadding:this.props.isSubstripVisible&&!this.props.isSubstrip,disabled:a||x,pointerEvents:i&&g?"auto":"none",placement:s,appearDelay:200,transitionSpeed:o,disappearDelay:i?200:1,content:()=>this.props.getTooltipContent(N,_),stackSize:u.size},n.key,Wse("div",{className:mn()("tab-position",{"is-substack":P}),style:F,onMouseDown:this.handleMouseDown.bind(null,p,n.style.x,n.style.y),onMouseUp:this.handleMouseUpGuard,onAuxClick:this.handleAuxClick.bind(null,p),onClick:this.handleClick.bind(null,p),onDoubleClick:this.handleDoubleClick.bind(null,p),onTouchStart:this.handleTouchStart.bind(null,p,n.style.x,n.style.y)},void 0,(0,fn.jsx)(Tse,{ref:e=>this.setTabRef(p.id,e),id:`tab-${n.key}`,pageId:p.id,url:w,active:p.active,acceptsDrop:p.id===this.state.yieldOver||p.id===this.state.hoveredPageId,discarded:p.discarded,incognito:p.incognito,pinned:!this.props.isSubstrip&&p.pinned,isUnread:W.Z.isUnread(p),groupId:C,tilingType:p.vivExtData.tiling?.type??"",tilingId:(0,uv.jA)(p)||"",extId:y,faviconUrl:this.getFavicon(w,p.favIconUrl),title:p.title,thumbnail:p.vivExtData.thumbnail??"",stackSize:u.size,isInsideAccordion:T,isFirstInGroup:m,isLastInGroup:v,isExpectingDrop:this.props.isExpectingDrop,isSelecting:this.props.isSelecting,getSelectionCount:this.getSelectionCount,isStack:g,isSubstrip:this.props.isSubstrip,isInternalPage:(0,Ni.to)(p.url),removeFromTabStack:this.removeFromTabStack,getDraggedPages:this.getDraggedPages,isSelected:this.checkSelected(p.id),checkSelected:this.checkSelected,isHiddenForDrag:S,isHidden:A,smallTab:n.style.width<=66,miniTab:n.style.width<=Kse,highlightId:i?p.id:void 0,direction:this.props.direction,prefValues:this.props.prefValues,tabPosition:this.props.tabPosition,addressBarVisible:this.state.addressBarVisible,highlighted:this.state.highlightedId===`tab-${n.key}`,forceHover:Z,clearForceHover:this.clearForceHover,onMoveFocus:this.moveFocus,onStackMenu:this.openStackMenu,onLeaveBar:this.handleLeaveBar,setPageIdsHiddenForDrag:this.setPageIdsHiddenForDrag,closePage:this.closeAndFreeze,onActivate:this.props.onActivateTab,onDragLeave:this.onDragLeaveHandler,droppedTabHandler:this.droppedTabHandler,accordionFrameSize:M,handleTabPosition:E,shouldShowCloseButton:b,onCreateTab:this.props.onCreateTab,handleExpandAccordion:this.props.handleExpandAccordion,handleCompressAccordion:this.props.handleCompressAccordion,doMonitorAlarms:this.state.activeAlarms.has(y),shouldShowStackCounter:U,isDragging:this.state.isDragging})))}if("space"===h.type){const e=this.getElementStyle(n.style.x,n.style.y,n.style.opacity,n.style.height,n.style.width,0,!1,c);return Wse("div",{className:mn()({"tab-position":this.props.isSubstrip||!this.state.yieldOver,"tab-yield-space":this.props.isSubstrip||!this.state.yieldOver}),style:e,onDragEnter:this.onDragEnterHandler,onDragLeave:this.onDragLeaveHandler,onDragOver:this.onDragOverHandler,onDrop:this.onDropHandler},n.key)}if("separator"===h.type){return Wse("div",{className:"separator",style:this.getElementStyle(n.style.x,n.style.y,n.style.opacity,n.style.height,n.style.width,0,!1,0)},n.key,Yse)}if("accordionToggle"===h.type){const{page:e}=h,t=(0,uv.av)(e),i=this.accordionIsOpen(t),s=i?l?"left":"up":l?"right":"down",o=this.getElementStyle(n.style.x,n.style.y,n.style.opacity,n.style.height,n.style.width,0,e.pinned,c);return Wse(Qie,{orientation:s,isActive:e.active,style:o,onClick:()=>this.handleAccordionToggle(t,i),title:i?(0,le.Z)("Reduce Tab Stack"):(0,le.Z)("Expand Tab Stack")},n.key)}return"button"!==h.type||this.props.isSubstrip&&!this.props.isSubstripVisible?void 0:Wse("div",{className:"toolbar toolbar-tabbar toolbar-large tab-position"},n.key,Wse(tse,{id:this.getNewTabButtonId(),style:this.getNewTabButtonStyle(n.style.x-c,this.props.isSubstrip&&"row"===this.props.direction?this.props.maxHeight-$se:n.style.y,n.style.opacity,n.style.height,n.style.width,0),tabPosition:this.props.tabPosition,onCreateTab:this.props.onCreateTab,onMoveFocus:this.moveFocus,onLeaveBar:this.handleLeaveBar}))}}))})}),n&&(0,fn.jsxs)(fn.Fragment,{children:[Wse("div",{onMouseEnter:()=>this.setIsMouseOverScrollArrow(!0),onMouseOut:()=>this.setIsMouseOverScrollArrow(!1),className:"toolbar toolbar-tabbar"},void 0,Wse(sl,{className:mn()("horizontal-scroll-arrow",{disabled:!this.state.canScrollRight}),image:cn.Zu.medium,onClick:this.scrollRight,menu:this.getOverflowMenu,menuOrigin:"top"===this.props.tabPosition?"bottomRight":"topRight",mimeType:Q.Up,edgeAmount:0,tooltip:(0,le.Z)("Scroll right")+"\n"+r})),(this.state.canScrollLeft||this.state.canScrollRight)&&Wse("div",{className:"toolbar toolbar-tabbar"},void 0,Wse(tse,{id:this.getNewTabButtonId(),tabPosition:this.props.tabPosition,onCreateTab:this.props.onCreateTab,onMoveFocus:this.moveFocus,onLeaveBar:this.handleLeaveBar}),Xse)]})]})}}const qse=Qse;class Jse extends tn.PureComponent{static contextType=dn.Z;trashButton=tn.createRef();state={trash:Ine.Z.getTrash()};componentDidMount(){Ine.Z.addListener(this.onTrashStoreChange),Qi.Z.addListener("COMMAND_SHOW_CLOSED_TABS",this._onCommandSpy)}componentWillUnmount(){Ine.Z.removeListener(this.onTrashStoreChange),Qi.Z.removeListener("COMMAND_SHOW_CLOSED_TABS",this._onCommandSpy)}onTrashStoreChange=()=>{this.setState({trash:Ine.Z.getTrash()})};emptyTrash=()=>{j7.Z.emptyTrash()};undeleteTab=e=>{j7.Z.undeleteTab(e)};undeleteWindow=e=>{j7.Z.undeleteWindow(e)};undo=()=>{if(this.state.trash.length>0){const e=this.state.trash[0];e.tab?this.undeleteTab(e.tab):e.window&&this.undeleteWindow(e.window)}};_onCommandSpy=()=>{this.trashButton.current&&this.trashButton.current.showMenu()};_getContextMenuPromise=()=>{const e=this.context.vivaldiWindowId,t=Ai.getOptionFunction("closedtab");return Ai.getNamedMenu(e,"closedtab",(async n=>"CONTEXT_CONTAINER_CLOSED_TAB"===n.action?{items:U.Z.getClosedTabContainer(),...t(e,n,{})}:{...t(e,n,{})}))};onDrop=e=>{const t=e.dataTransfer.getData(Q.Up);if(t){e.preventDefault(),e.stopPropagation();const n=JSON.parse(t).ids.map((e=>parseInt(e))).map((e=>W.Z.getPages(this.context.vivaldiWindowId).find((t=>t.id===e)))).filter(Boolean);Y.Z.closePage((0,fa.aV)(n))}};render(){return(0,fn.jsx)(sl,{ref:this.trashButton,className:"toggle-trash",onDrop:this.onDrop,onDragEnter:Tl.default,image:cn.nre.large,onMiddleClick:this.undo,menu:this._getContextMenuPromise,menuOrigin:"bottomLeft",mimeType:Q.Up,edgeAmount:0,tooltip:(0,le.Z)("Show Closed Tabs")+"\n"+(0,le.Z)("$1 click to reopen last closed tab",[(0,le.Z)("key","Control")])})}}const eoe=Jse;var toe,noe=n(9719),ioe=n(5531),soe=n(34155);function ooe(e,t,n,i){toe||(toe="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:toe,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const aoe=320,roe=[D.kAddressBarInlineSearchEnabled,D.kAddressBarShowProgress,D.kKeyboardTabToAll,D.kMediaRouterMediaRemotingEnabled,D.kMouseWheelTabSwitch,D.kPanelsPosition,D.kTabsActiveMinSize,D.kTabsAlignNext,D.kTabsBarWidth,D.kTabsCloseButtonPermanent,D.kTabsClosePinned,D.kTabsCounterDetection,D.kTabsCycleByRecentOrder,D.kTabsDimHibernated,D.kTabsDoubleClickClose,D.kTabsBarHeight,D.kTabsMinimize,D.kTabsPageLoadInfo,D.kTabsNeverCloseLast,D.kTabsSelectionEnabled,D.kTabsBarSliderXpos,D.kTabsBarSliderYpos,D.kTabsHorizontalScrolling,D.kTabsShowCloseButton,D.kTabsShowSeparator,D.kTabsStackingAllowDnd,D.kTabsStackingAllowRename,D.kTabsStackingMode,D.kTabsStackingNameMap,D.kTabsShowTrashCan,D.kTabsShowSyncedTabsButton,D.kTabsStackingOpenAccordions,D.kTabsStackingSubstripLocked,D.kTabsThumbnails,D.kTabsTooltip,D.kTabsUnread,D.kTabsVisualSwitchEnable,D.kThemeUseAnimation,D.kTabsStackingPreferDotted,D.kTabsStackingAutoExpand,D.kTabsStackingDndDelay],loe=function(e,t,n){const i=(0,uv.av)(e)||"",s=i&&("substrip"===n||"accordion"===n)?W.Z.getTabsForPages(W.Z.getGroup(i,t),!0):(0,fa.aV)(),o="off"===n,a=W.Z.getTabs(t,o);return{tabs:a,pages:W.Z.getPages(t),activePageId:e.id,url:e.url,incognito:e.incognito,tilingId:(0,uv.jA)(e)??"",groupId:i,pinned:e.pinned,isSelecting:W.Z.isSelecting(t),pageSelection:W.Z.getSelection(t),stackTabs:s,pinnedWidth:doe(a)}};function doe(e){const t=e.findIndex((e=>!e.page.pinned)),n=M.Z.get(D.kTabsStackingOpenAccordions),i="accordion"===M.Z.get(D.kTabsStackingMode);let s=0;for(let o=0;o<t;o++){const t=e.get(o);if(!t)return s;s=s+("group"===t.type&&i&&n.includes(t.id)?t.pages.size:1)*Kse+("group"===t.type&&i?16:0)}return s}var coe=ooe($ie,{}),hoe=ooe(eoe,{});class poe extends tn.PureComponent{static contextType=dn.Z;#n;#L=!1;visibleOnMount=this.props.visible;refMainBar=tn.createRef();refTabBarContainer=tn.createRef();#R=!1;constructor(e,t){super(e);const n=W.Z.unsafeGetActivePage(t.vivaldiWindowId),i=this.props.prefValues[D.kTabsStackingOpenAccordions].map((e=>({groupId:e,auto:!1})));this.state={tabStripWidth:0,tabStripHeight:0,isResizing:!1,tabBarOverflow:!1,tabStripOverflow:!1,tabBarHeight:this.props.prefValues[D.kTabsBarHeight],tabBarWidth:this.props.prefValues[D.kTabsBarWidth],...loe(n,t.vivaldiWindowId,e.prefValues[D.kTabsStackingMode]),tabBarSliderYpos:this.props.prefValues[D.kTabsBarSliderYpos],tabBarSliderXpos:this.props.prefValues[D.kTabsBarSliderXpos],tabBarContainerWidth:0,isExpectingDrop:!1,openAccordions:i,isInternalDragging:!1}}componentDidUpdate(e,t){"top"!==this.props.tabPosition&&"bottom"!==this.props.tabPosition||!0!==this.props.prefValues[D.kTabsThumbnails]||!1!==e.prefValues[D.kTabsThumbnails]||this.setTabBarHeight(Gse),t.openAccordions!==this.state.openAccordions&&nt.Z.set(D.kTabsStackingOpenAccordions,this.state.openAccordions.map((e=>e.groupId))),e.prefValues[D.kTabsStackingMode]===this.props.prefValues[D.kTabsStackingMode]&&t.openAccordions===this.state.openAccordions||this._onPageStoreChange()}componentDidMount(){y.Z.runtime.onMessage.addListener(this.onMessageReceived),W.Z.addListener(this._onPageStoreChange),jie.addListener(this.onTabStoreChange),Qi.Z.addListener("COMMAND_SAVE_SELECTED_SESSION",this._onCommandSpy),Qi.Z.addListener("COMMAND_BOOKMARK_SELECTED_TABS",this._onCommandSpy),Qi.Z.addListener("COMMAND_NEW_TAB",this._onCommandSpy),d.Z.tabsPrivate.onKeyboardChanged.addListener(this.handleKeyboardChange),this.updateDocumentTitleById(this.state.activePageId),this.#n=!0,this.context.addEventListener("resize",this.onWindowResize,!1),this.cleanUpOpenAccordions()}handleKeyboardChange=(e,t,n)=>{this.#L=0!==n};componentWillUnmount(){y.Z.runtime.onMessage.removeListener(this.onMessageReceived),W.Z.removeListener(this._onPageStoreChange),jie.removeListener(this.onTabStoreChange),Qi.Z.removeListener("COMMAND_SAVE_SELECTED_SESSION",this._onCommandSpy),Qi.Z.removeListener("COMMAND_BOOKMARK_SELECTED_TABS",this._onCommandSpy),Qi.Z.removeListener("COMMAND_NEW_TAB",this._onCommandSpy),d.Z.tabsPrivate.onKeyboardChanged.removeListener(this.handleKeyboardChange),this.#n=!1,this.context.removeEventListener("resize",this.onWindowResize,!1),clearTimeout(this._resizingTimeout)}updateDocumentTitleById=e=>{const t=W.Z.getPageById(e);t&&this.updateDocumentTitle(t)};cleanUpOpenAccordions(){const e=this.state.pages.reduce(((e,t)=>(e.push((0,uv.av)(t)),e)),[]);this.setState((t=>({openAccordions:(0,ioe.Z)(t.openAccordions,"groupId").filter((t=>e.includes(t.groupId)))})))}updateDocumentTitle=e=>{const t=St.jk.getDisplayTitle(e);t!==this.context.document.title&&(this.context.document.title=t)};onWindowResize=()=>{clearTimeout(this._resizingTimeout),this.setState({isResizing:!0}),this._resizingTimeout=setTimeout((()=>{this.setState({isResizing:!1})}),1e3)};setIsExpectingDrop=e=>{this.setState({isExpectingDrop:e})};closePage=async e=>{this.#R=!0,await Y.Z.closePage(e),this.#R=!1,await this._onPageStoreChange(),this.handleClosePageAccordion(e)};handleClosePageAccordion=e=>{if(this.#R||this.props.prefValues[D.kTabsStackingAutoExpand]||"accordion"!==this.props.prefValues[D.kTabsStackingMode])return;const t=e instanceof fa.aV?e:fa.aV.of(e);0!==t.size&&t.some((e=>{if(e.active){const t=(0,uv.av)(e);return t&&1===this.state.pages.count((e=>(0,uv.av)(e)===t))&&this.handleCompressAccordion(t),!0}}))};onMessageReceived=(e,t)=>{if(y.Z.runtime.id===t.id&&"object"==typeof e&&null!=e)switch(e.dispatchAction){case gne:return void this.setIsExpectingDrop(!0);case mne:return this.setIsExpectingDrop(!1),void this._onPageStoreChange()}};setTabBarWidth=(e,t=!0)=>{this.setState({tabBarWidth:e},(()=>t&&nt.Z.set(D.kTabsBarWidth,Math.round(e))))};setTabBarHeight=(e,t=!0)=>{this.setState({tabBarHeight:e},(()=>t&&nt.Z.set(D.kTabsBarHeight,Math.round(e))))};setInnerTabBarWidth=(e,t=!0)=>{this.setState({tabBarSliderXpos:e},(()=>t&&nt.Z.set(D.kTabsBarSliderXpos,Math.round(e))))};setInnerTabBarHeight=(e,t=!0)=>{this.setState({tabBarSliderYpos:e},(()=>t&&nt.Z.set(D.kTabsBarSliderYpos,Math.round(e))))};_onPageStoreChange=()=>{if(this.#R||this.state.isExpectingDrop)return;const e=W.Z.unsafeGetActivePage(this.context.vivaldiWindowId);this.updateDocumentTitle(e),this.setState((t=>({...loe(e,this.context.vivaldiWindowId,this.props.prefValues[D.kTabsStackingMode]),openAccordions:this.updateAccordionStatus(t,e)})))};updateAccordionStatus=(e,t)=>{const n=t.id!==this.state.activePageId,i=(0,uv.av)(t);return!n&&i===this.state.groupId||!this.props.prefValues[D.kTabsStackingAutoExpand]||"accordion"!==this.props.prefValues[D.kTabsStackingMode]?e.openAccordions:(0,E.Uy)(e.openAccordions,(e=>{const t=e.findIndex((e=>e.auto));-1!==t&&e.splice(t,1),i&&!e.some((e=>e.groupId===i))&&e.push({groupId:i,auto:!0})}))};isSelecting=()=>this.props.prefValues[D.kTabsSelectionEnabled]&&this.state.isSelecting&&!this.state.pageSelection.isEmpty();getSelectedPages=()=>this.isSelecting()?this.state.pageSelection.reduce(((e,t)=>{const n=W.Z.getPages(this.context.vivaldiWindowId).find((e=>e.id===t));return n?e.push(n):e}),(0,fa.aV)()).sortBy((e=>e.index)):(0,fa.aV)();_onCommandSpy=(e,t)=>{switch(t){case"COMMAND_BOOKMARK_SELECTED_TABS":i.Z.bookmarkPages(this.getSelectedPages(),e,!1,en.ZP.getRootNode().id);break;case"COMMAND_SAVE_SELECTED_SESSION":const t=this.getSelectedPages().map((e=>e.id)).toArray();t.length>0&&ie.Z.showSaveSessionDialog(e,{mode:"selected",ids:t});break;case"COMMAND_NEW_TAB":this.createTab("keyboard")}};onTabStoreChange=e=>{if(e.winId!==this.context.vivaldiWindowId)return;const t=this.context.vivaldiWindowId,n="off"===this.props.prefValues[D.kTabsStackingMode];switch(e.action){case"switchTabBackBySetting":this.switchBackBySetting(e.event);break;case"switchTabForwardBySetting":this.switchForwardBySetting(e.event);break;case"viewPageSource":this.state.url.startsWith("view-source:")||soe.nextTick((()=>Y.Z.openURL(e.winId,`view-source:${this.state.url}`,{incognito:this.state.incognito})));break;case"stackUntile":soe.nextTick((()=>{this.isSelecting()?this.getSelectedPages().map((e=>e.vivExtData.tiling?.id)).filter(Boolean).toSet().forEach((e=>Y.Z.untileTileGroup(e,t))):soe.nextTick((()=>Y.Z.untileTileGroup(this.state.tilingId,t)))}));break;case"stackCreate":if(n)break;soe.nextTick((()=>{if(this.isSelecting())Y.Z.createTabStack(this.getSelectedPages());else{const e=W.Z.getPages(t).filter((e=>!(0,uv.av)(e)&&!1===e.pinned));if(e.count()>1){const[i,s]=(0,Vne.d)(W.Z.unsafeGetActivePage(t),W.Z.getTabs(t,n));if(s.count()>1){const e=W.Z.getNewGroupId();Fne(e,i),Y.Z.createTabStack(s,void 0,e)}else Y.Z.createTabStack(e)}}}));break;case"stackDissolve":if(n)break;soe.nextTick((()=>Y.Z.expandTabStack(e.winId,this.state.groupId))),this.handleCompressAccordion(this.state.groupId);break;case"stackRemove":if(n)break;soe.nextTick((()=>this.removeFromTabStack(this.state.pageSelection)));break;case"stackTileGrid":case"stackTileHorizontal":case"stackTileVertical":const i="stackTileGrid"===e.action?"grid":"stackTileHorizontal"===e.action?"column":"row";soe.nextTick((()=>{this.isSelecting()?Y.Z.tilePages(this.getSelectedPages(),i):this.state.groupId?Y.Z.tileTabStack(this.state.groupId,t,i):Y.Z.tileLastActive(i,t)}));break;case"tabThumbnail":this.switchTabViewAndEnablePreview();break;case"unloadDialogClosed":this.#R=!1,this._onPageStoreChange()}};onActivateTab=e=>{if(Ise.Z.hideTooltip(),e.active)Y.Z.clearSelection(this.context.vivaldiWindowId);else{const t="dotted"===this.props.prefValues[D.kTabsStackingMode];Y.Z.activateTab(e.id,this.context.vivaldiWindowId,t)}};createTab=async(e,t)=>{const n=this.context.vivaldiWindowId;if(t)return void Y.Z.openURL(n,"",{groupId:t});const i=this.props.prefValues[D.kTabsStackingMode],s=W.Z.getPageById(this.state.activePageId),o=s&&(0,uv.av)(s);if("dotted"!==i&&"accordion"!==i)if("substrip"!==i)Y.Z.openURL(n,"");else{const t=this.props.prefValues[D.kTabsStackingSubstripLocked]||this.state.stackTabs.size>1;if("mainStrip"===e||!t)return void Y.Z.openURL(n,"");if(o)Y.Z.openURL(n,"",{groupId:o});else{const e=W.Z.unsafeGetActivePage(n),t=await Y.Z.createTabStack((0,fa.aV)([e]),e.index);Y.Z.openURL(n,"",{groupId:t})}}else o&&"keyboard"===e&&W.Z.isGroup(o,n)?Y.Z.openURL(n,"",{groupId:o}):Y.Z.openURL(n,"")};onCreateTab=e=>this.createTab("mainStrip",e);onCreateGroupTab=e=>this.createTab("subStrip",e);removeFromTabStack=e=>{if(this.isSelecting()){const t=e.flatMap((e=>{const t=W.Z.getPageById(e);return t?[t]:[]})).toList();t.isEmpty()||Y.Z.removeFromTabStack(t)}else{const e=W.Z.getActivePage(this.context.vivaldiWindowId);e&&Y.Z.removeFromTabStack(e)}};muteTab=(e,t,n)=>{n&&n.stopPropagation(),Y.Z.toggleMuting(e,fa.aV.of(t))};closeSingleTab=(e,t)=>{t?.stopPropagation&&t.stopPropagation(),Y.Z.closePage(e)};switchBackBySetting=e=>{this.props.prefValues[D.kTabsVisualSwitchEnable]?this.props.switchTabVisualTabSwitcher(e,!1,this.#L):this.props.prefValues[D.kTabsCycleByRecentOrder]?soe.nextTick((()=>Y.Z.cycleByHistory(this.context.vivaldiWindowId,e,{goBack:!0}))):soe.nextTick((()=>Y.Z.cycleByOrder(this.context.vivaldiWindowId,e,{goBack:!0})))};switchForwardBySetting=e=>{this.props.prefValues[D.kTabsVisualSwitchEnable]?this.props.switchTabVisualTabSwitcher(e,!0,this.#L):this.props.prefValues[D.kTabsCycleByRecentOrder]?soe.nextTick((()=>Y.Z.cycleByHistory(this.context.vivaldiWindowId,e,{goBack:!1}))):soe.nextTick((()=>Y.Z.cycleByOrder(this.context.vivaldiWindowId,e,{goBack:!1})))};switchTabViewAndEnablePreview=()=>{const e=this.props.prefValues[D.kTabsThumbnails],t=this.props.tabPosition,{tabBarWidth:n}=this.state,i="left"===t||"right"===t;e?i?nt.Z.set(D.kTabsThumbnails,!1):this.switchTabView():(nt.Z.set(D.kTabsThumbnails,!0),i&&n===$se&&this.switchTabView())};switchTabView=()=>{const e=this.props.tabPosition,{tabBarWidth:t,tabBarHeight:n}=this.state;if("top"===e||"bottom"===e){const e=n<75?Gse:$se;this.setTabBarHeight(e)}else{const e=t!==zse?zse:$se;this.setTabBarWidth(e)}};onSlidebarPosition=(0,Kf.default)(((e,t)=>{const n=this.refTabBarContainer.current;if(!(n instanceof Element))return;const i=n.getBoundingClientRect();switch(this.props.tabPosition){case"top":this.setTabBarHeight(Math.round(t-i.top),!1);break;case"bottom":this.setTabBarHeight(Math.round(i.bottom-t),!1);break;case"left":this.setTabBarWidth(Math.min(e-i.left,330),!1);break;case"right":this.setTabBarWidth(Math.min(i.right-e,330),!1);break;default:throw new Error("Unknown tabbar position")}}),64);handleSliderDown=()=>{this.setState({isResizing:!0})};handleSliderUp=()=>{this.setState({isResizing:!1}),"top"===this.props.tabPosition||"bottom"===this.props.tabPosition?(nt.Z.set(D.kTabsBarHeight,Math.round(this.state.tabBarHeight)),this.snapToEdge()):nt.Z.set(D.kTabsBarWidth,Math.round(this.state.tabBarWidth))};onInnerSlidebarPosition=(0,Kf.default)(((e,t)=>{const{HTMLElement:n}=this.context,i=this.refMainBar.current?.firstElementChild;if(!(i instanceof n))return;const s=i.getBoundingClientRect(),{tabBarWidth:o,tabBarHeight:a}=this.state;switch(this.props.tabPosition){case"top":t-s.top>a-$se&&this.setTabBarHeight(t-s.top+$se,!1),this.setInnerTabBarHeight((0,jf.default)(t-s.top,$se,120),!1);break;case"bottom":s.bottom-t>a-$se&&this.setTabBarHeight(s.bottom-t+$se,!1),this.setInnerTabBarHeight((0,jf.default)(s.bottom-t,$se,120),!1);break;case"left":e-s.left-$se>o&&o<330&&this.setTabBarWidth(e-s.left+$se,!1),this.setInnerTabBarWidth((0,jf.default)(e-s.left,$se,330),!1);break;case"right":s.right-e+$se>o&&o<330&&this.setTabBarWidth(s.right-e+$se,!1),this.setInnerTabBarWidth((0,jf.default)(s.right-e,$se,330),!1);break;default:throw new Error("Unknown tabbar position")}}),64);handleInnerSliderDown=()=>{this.setState({isResizing:!0})};handleInnerSliderUp=()=>{this.setState({isResizing:!1}),"top"===this.props.tabPosition||"bottom"===this.props.tabPosition?(nt.Z.set(D.kTabsBarSliderYpos,Math.round(this.state.tabBarSliderYpos)),this.snapToEdge()):this.setInnerTabBarWidth(this.state.tabBarSliderXpos)};switchInnerTabView=()=>{const e=this.props.tabPosition,{tabBarWidth:t,tabBarHeight:n,tabBarSliderXpos:i}=this.state;if("top"===e||"bottom"===e){const e=n<75?Gse:$se;this.setInnerTabBarHeight(e)}else{const e=i!==t/2?t/2:$se;this.setInnerTabBarWidth(e)}};snapToEdge=()=>{const e=this.refTabBarContainer.current;if(!(e instanceof HTMLElement))return;let t=parseInt(e.style.height);t>$se&&t<50?t=$se:t<Gse&&t>130&&(t=Gse),this.setTabBarHeight(t)};getGroupHighlightId=(e,t)=>W.Z.getGroupHighlightId(e,t);getTabStackThumbnailsContextMenu=(e,t)=>{const n=this.context.vivaldiWindowId,i=Ai.getOptionFunction(e);return Ai.getNamedMenu(n,e,(e=>{switch(e.action){case"CONTEXT_CLOSE":return Promise.resolve({handler:()=>this.closeSingleTab(t),...i(n,e,{})});case"CONTEXT_TABSTACK_REMOVE_FROM":return Promise.resolve({handler:()=>this.removeFromTabStack(this.state.pageSelection),...i(n,e,{})});default:return Promise.resolve({...i(n,e,{})})}}))};getTabBarContextMenu=(e,t)=>{const{prefValues:n}=this.props,s=z.ZP.isGuestSession(this.context.vivaldiWindowId),o=Ai.getOptionFunction(e),a=this.context.vivaldiWindowId;return Ai.getNamedMenu(a,e,(async e=>{switch(e.action){case"CONTEXT_NEW":return{handler:()=>this.createTab(t?"subStrip":"mainStrip"),...o(a,e,{})};case"CONTEXT_TOGGLE_SUBSTRIP_LOCK":{const t=n[D.kTabsStackingSubstripLocked];return{handler:()=>nt.Z.set(D.kTabsStackingSubstripLocked,!t),visible:"substrip"===n[D.kTabsStackingMode],checked:t,...o(a,e,{})}}case"CONTEXT_BOOKMARK_ALL":return{handler:()=>i.Z.bookmarkAllOpenPages(this.context.vivaldiWindowId,en.ZP.getRootNode().id),visible:!s,...o(a,e,{})};case"CONTEXT_SAVE_SESSION":return{visible:!s,...o(a,e,{})};case"CONTEXT_REOPEN":return{visible:Boolean(Ine.Z.getTrash().length),...o(a,e,{})};default:return{...o(a,e,{})}}}))};onAuxClick=(e,t)=>{e.button===vn.Z.kCenter&&this.createTab(t?"subStrip":"mainStrip"),e.preventDefault()};onDoubleClick=(e,t)=>{e.button===vn.Z.kLeft&&"top"!==this.props.tabPosition&&this.createTab(t?"subStrip":"mainStrip")};getTooltipPlacement=()=>({top:"below",bottom:"above",left:"after",right:"before"}[this.props.tabPosition]);getTooltipMediaState=e=>F5.getState().get(e)||(0,fa.l4)();getTooltipContent=(e,t)=>{const n=W.Z.getPageById(e);if(!n)return{width:0,height:0,content:null};const{prefValues:i}=this.props;let s,o;const a=(0,$5.xz)(n)&&!t;if("off"!==i[D.kTabsStackingMode]&&a){const e=(0,uv.av)(n);s=W.Z.getGroup(e,this.context.vivaldiWindowId),o=e?this.getGroupHighlightId(e,this.context.vivaldiWindowId):null}else s=fa.aV.of(n),o=null;const r=!a&&(0,$5.ZN)(n),l=a?ooe("div",{className:"tab-group"},void 0,s.map((e=>ooe("div",{className:mn()({"tooltip-item":!0,active:e.active,"last-active":o&&o===e.id}),onMouseDown:t=>dse(this.context,[e],t),onContextMenu:t=>this.onTabStackTooltipContextMenu(e,t),onClick:()=>this.onActivateTab(e),onAuxClick:t=>{t.button===vn.Z.kCenter&&(t.preventDefault(),t.stopPropagation(),this.closeSingleTab(e))}},e.id,ooe(hj,{src:e.vivExtData.thumbnail??""}),ooe("div",{className:"thumbnail-caption"},void 0,this.renderThumbnailText(e),ooe("span",{className:"thumbnail-buttons"},void 0,ooe(Oi,{className:"favicon",url:e.url,loadType:"page"}),ooe("button",{className:"close",dangerouslySetInnerHTML:{__html:cn.kze},tabIndex:i[D.kKeyboardTabToAll],onClick:t=>this.closeSingleTab(e,t)}),this.renderAudioIcon(e))))))):ooe("div",{className:"tab-solo"},void 0,ooe("div",{className:mn()({"tooltip-item":!0,active:n.active})},"tabbar_tooltip",!r&&ooe(hj,{src:n.vivExtData.thumbnail??""}),ooe("div",{className:"thumbnail-caption"},void 0,this.renderThumbnailText(n),ooe("span",{className:"thumbnail-buttons"},void 0,this.renderAudioIcon(n))))),d=r?$se:282,c=this.context.innerWidth-("left"===this.props.tabPosition||"right"===this.props.tabPosition?this.getWidth():0),h=this.context.innerHeight-("top"===this.props.tabPosition||"bottom"===this.props.tabPosition?this.getHeight():0);if(!a)return{width:222,height:d,content:l};let p=aoe,u=92*s.count();if(u>h){const e=Math.floor(h/92),t=Math.ceil(s.count()/e);p=aoe*t,u=92*Math.ceil(s.count()/t)}return{width:Math.min(p,Math.floor(c/aoe)*aoe),height:Math.min(u,92*Math.floor(h/92)),content:l}};renderThumbnailText=e=>{const t=St.jk.getDisplayTitle(e);return ooe("span",{className:"thumbnail-text"},void 0,ooe("strong",{className:"title"},void 0,t.length>245?t.substring(0,240)+"...":t),!St.jk.isInternalUrl(e.url)&&(0,Ni.C3)(e.url)&&ooe("span",{className:"url"},void 0,new URL(e.url).hostname))};renderAudioIcon=e=>{const t=this.getTooltipMediaState(e.id);if(t.has("playing")||t.has("muting"))return ooe("button",{className:"tooltip-audio-button",tabIndex:this.props.prefValues[D.kKeyboardTabToAll],onClick:()=>this.muteTab(this.context.vivaldiWindowId,e)},void 0,ooe(b9,{color:this.props.theme.colorFg,animated:this.props.prefValues[D.kThemeUseAnimation],mediaState:t}))};getTabDirection=()=>{const e=this.props.tabPosition;return"left"===e||"right"===e?"column":"row"};setOverflowClass=(e,t)=>{t?this.setState({tabStripOverflow:e}):this.setState({tabBarOverflow:e})};onResize=([e])=>{if(!this.#n)return;const t=e.target;this.setState((e=>({tabStripWidth:t.clientWidth,tabStripHeight:t.clientHeight,tabBarContainerWidth:t.parentElement?.clientWidth})))};isSubstripVisible(){const{prefValues:e,visible:t}=this.props;return t&&!this.state.isInternalDragging&&"substrip"===e[D.kTabsStackingMode]&&(e[D.kTabsStackingSubstripLocked]||this.state.stackTabs.size>1)}setIsInternalDragging=e=>{this.setState({isInternalDragging:e})};getWidth=()=>{if(!this.props.visible)return this.props.onSetLeftTabBarWidth?.(0),0;const e=this.props.theme.simpleScrollbar?noe.eF:noe.nn,{tabBarWidth:t}=this.state,n=$se*(this.isSubstripVisible()?2:1)+(this.state.tabBarOverflow?e:0)+(this.state.tabStripOverflow?e:0),i=(0,jf.default)(t,n,360)||n;return this.props.onSetLeftTabBarWidth?.(i),i};getHeight=()=>{if(!this.props.visible)return 0;const{tabBarHeight:e}=this.state,t=this.isSubstripVisible()?61:$se;if(!this.props.prefValues[D.kTabsThumbnails])return t;return(0,jf.default)(e,t,150)||$se};clearDisplay=e=>{const t=e[0];t instanceof HTMLElement&&"none"===t.style.display&&t.style.removeProperty("display")};showSubStack=e=>{const t=W.Z.getPageById(e);if(!t)return;const n=(0,uv.av)(t);if(n){const e=W.Z.getTabsForPages(W.Z.getGroup(n,this.context.vivaldiWindowId),!0);this.setState({stackTabs:e})}else{if(1===this.state.stackTabs.size&&this.state.stackTabs.first().id===t.id)return;const e=fa.aV.of({type:"tab",page:t,id:t.id});this.setState({stackTabs:e})}};onContextMenu=(e,t)=>{e.persist(),e.preventDefault(),e.stopPropagation(),this.getTabBarContextMenu("tabbar",t).then((t=>{(0,zi.Z)(this.context.vivaldiWindowId,t)(e)}))};onTabStackTooltipContextMenu=(e,t)=>{t.persist(),t.preventDefault(),t.stopPropagation(),this.getTabStackThumbnailsContextMenu("tabstackthumbnails",e).then((e=>{(0,zi.Z)(this.context.vivaldiWindowId,e)(t)}))};handleExpandAccordion=e=>{this.setState((t=>({openAccordions:t.openAccordions.concat({groupId:e,auto:!1})})))};handleCompressAccordion=e=>{this.setState((t=>({openAccordions:t.openAccordions.filter((t=>t.groupId!==e&&!1===t.auto))})))};toggleAutoExpandAccordion=e=>{e&&this.setState((t=>{const n=t.openAccordions.find((t=>t.groupId===e)),i=!!n&&!n.auto;return{openAccordions:t.openAccordions.filter((t=>t.groupId!==e)).concat({groupId:e,auto:i})}}))};toggleSubstripLock=()=>{nt.Z.toggle(D.kTabsStackingSubstripLocked,!0,!1)};getTabStripWidth=()=>{const e=this.props.prefValues,t=e[D.kTabsShowSyncedTabsButton],n=e[D.kTabsShowTrashCan],i=this.getTabDirection();let s=this.state.tabStripWidth;return"row"===i&&(t||n?s-=32:t||n||(s-=8)),s};render(){const e=this.props.prefValues,t=this.getTabDirection(),n=this.getTabStripWidth(),i="column"===t?this.state.tabStripHeight-32:this.state.tabStripHeight,s="column"===t?Math.max(this.state.tabBarWidth-n,32):this.state.tabBarContainerWidth-32,o="column"===t||"row"===t&&e[D.kTabsThumbnails],a=this.props.prefValues[D.kTabsStackingSubstripLocked],r=this.isSubstripVisible(),l=a&&this.state.stackTabs.isEmpty()?fa.aV.of({type:"tab",page:W.Z.unsafeGetActivePage(this.context.vivaldiWindowId),id:this.state.activePageId}):this.state.stackTabs,d=Math.round(r&&"column"===t?Math.max(this.getWidth()-this.state.tabBarSliderXpos-(this.state.tabBarOverflow?noe.nn:0),$se):Math.max(this.getHeight()-this.state.tabBarSliderYpos-(this.state.tabBarOverflow?noe.nn:0),$se)),c=e[D.kTabsShowTrashCan],h=e[D.kTabsShowSyncedTabsButton],p="row"===t?{height:this.getHeight()}:{width:this.getWidth(),height:"100%"};return(0,fn.jsxs)("div",{id:"tabs-tabbar-container",ref:this.refTabBarContainer,style:p,className:mn()({[this.props.visible?this.props.tabPosition:"none"]:!0,accordion:"accordion"===e[D.kTabsStackingMode],dotted:"dotted"===e[D.kTabsStackingMode]||e[D.kTabsStackingPreferDotted]}),children:[(0,fn.jsxs)("div",{id:"tabs-container",ref:this.refMainBar,onAuxClick:e=>this.onAuxClick(e,!1),onDoubleClick:e=>this.onDoubleClick(e,!1),className:mn()({overflow:this.state.tabBarOverflow,[this.props.visible?this.props.tabPosition:"none"]:!0}),children:[ooe(ts,{className:"resize",onResize:this.onResize},void 0,ooe(qse,{isSubstrip:!1,isSubstripVisible:r,maxWidth:n,maxHeight:i,direction:t,onActivateTab:this.onActivateTab,getTooltipContent:this.getTooltipContent,getGroupHighlightId:this.getGroupHighlightId,setOverflowClass:this.setOverflowClass,prefValues:e,tabPosition:this.props.tabPosition,isSelecting:this.isSelecting(),isResizing:this.state.isResizing,pageSelection:this.state.pageSelection,pages:this.state.pages,tabs:this.state.tabs,switchByScroll:e[D.kMouseWheelTabSwitch],onCreateTab:this.onCreateTab,showSubStack:this.showSubStack,isExpectingDrop:this.state.isExpectingDrop,onContextMenu:this.onContextMenu,setIsExpectingDrop:this.setIsExpectingDrop,activeGroupId:this.state.groupId,openAccordions:this.state.openAccordions,handleExpandAccordion:this.handleExpandAccordion,handleCompressAccordion:this.handleCompressAccordion,toggleAutoExpandAccordion:this.toggleAutoExpandAccordion,closePage:this.closePage,theme:this.props.theme,pinnedWidth:this.state.pinnedWidth,setIsInternalDragging:this.setIsInternalDragging})),ooe("div",{className:mn()("toolbar toolbar-tabbar sync-and-trash-container",{narrow:n<60})},void 0,!z.ZP.isIncognitoOrGuest(this.context.vivaldiWindowId)&&h&&coe,c&&hoe),o&&r&&ooe(gu,{onSlidebarPosition:this.onInnerSlidebarPosition,onStart:this.handleInnerSliderDown,onStop:this.handleInnerSliderUp,onDoubleClick:this.switchInnerTabView,style:"top"===this.props.tabPosition?{top:i+4}:"bottom"===this.props.tabPosition?{bottom:i-4}:{},position:this.props.tabPosition})]}),r&&ooe("div",{id:"tabs-subcontainer",onAuxClick:e=>this.onAuxClick(e,!0),onDoubleClick:e=>this.onDoubleClick(e,!0),className:mn()({overflow:this.state.tabStripOverflow,[this.props.visible?this.props.tabPosition:"none"]:!0,visible:r}),style:{flexBasis:d}},void 0,ooe(qse,{isSubstrip:!0,isSubstripVisible:r,maxWidth:s,maxHeight:d,direction:t,onActivateTab:this.onActivateTab,getTooltipContent:this.getTooltipContent,getGroupHighlightId:this.getGroupHighlightId,setOverflowClass:this.setOverflowClass,prefValues:e,tabPosition:this.props.tabPosition,isSelecting:this.isSelecting(),isResizing:this.state.isResizing,pageSelection:this.state.pageSelection,pages:this.state.pages,tabs:l,switchByScroll:e[D.kMouseWheelTabSwitch],onCreateTab:this.onCreateGroupTab,isExpectingDrop:this.state.isExpectingDrop,onContextMenu:this.onContextMenu,setIsExpectingDrop:this.setIsExpectingDrop,activeGroupId:this.state.groupId,closePage:this.closePage,theme:this.props.theme,pinnedWidth:0}),ooe("div",{className:mn()("toolbar toolbar-tabbar toolbar-large subcontainer-lock",{[this.props.tabPosition]:!0})},void 0,ooe(sl,{onClick:this.toggleSubstripLock,menuOrigin:"bottomLeft",className:a?"tabs-locked":"tabs-unlocked",tooltip:a?(0,le.Z)("Unlock second tab level"):(0,le.Z)("Lock second tab level"),image:a?cn.zlZ.small:cn.KuK.small}))),o&&ooe(gu,{onSlidebarPosition:this.onSlidebarPosition,onStart:this.handleSliderDown,onStop:this.handleSliderUp,onDoubleClick:this.switchTabView,offset:1,position:this.props.tabPosition})]})}}const uoe=(0,fs.Z)(poe,roe);class goe extends tn.PureComponent{static contextType=dn.Z;lastKeyWasAltDown=!1;componentDidMount(){d.Z.tabsPrivate.onMouseChanged.addListener(this._onMouseChanged),d.Z.tabsPrivate.onKeyboardChanged.addListener(this._keyEventListener),d.Z.windowPrivate.onPositionChanged.addListener(this._onWindowPositionChanged),Qi.Z.addListener("COMMAND_FOCUS_MAINMENU",this._onCommandSpy),z.ZP.addListener(this._onWindowStoreChanged)}componentWillUnmount(){d.Z.tabsPrivate.onMouseChanged.removeListener(this._onMouseChanged),d.Z.tabsPrivate.onKeyboardChanged.removeListener(this._keyEventListener),d.Z.windowPrivate.onPositionChanged.removeListener(this._onWindowPositionChanged),Qi.Z.removeListener("COMMAND_FOCUS_MAINMENU",this._onCommandSpy),z.ZP.removeListener(this._onWindowStoreChanged)}_onCommandSpy=()=>{z.ZP.isActive(this.context.vivaldiWindowId)&&this.props.changeFocus()};_onWindowStoreChanged=()=>{!z.ZP.isActive(this.context.vivaldiWindowId)&&this.props.showAccessKeys&&this.props.showAccessKeys(!1)};_onMouseChanged=e=>{!1===e&&(this.lastKeyWasAltDown=!1)};_onWindowPositionChanged=()=>{this.lastKeyWasAltDown=!1};_keyEventListener=(e,t,n,i,s)=>{if(this.context.vivaldiWindowId===e&&z.ZP.isActive(e)){const e=i===qi.Z.KEY_ALT&&(t?4===n:0===n);e&&this.props.showAccessKeys&&this.props.showAccessKeys(t),!t&&i===qi.Z.KEY_ALT&&this.lastKeyWasAltDown&&!s&&M.Z.get(D.kKeyboardShortcutsAltOpensMenu)&&this.props.changeFocus(),this.lastKeyWasAltDown=e&&t}};render(){return null}}const moe=goe;var voe=n(34155);let foe=0;const yoe=new Map;let woe=!1;const boe=function(e,t,n,i){return t.filter((t=>"function"==typeof t.testVisibility?t.testVisibility(e):!1!==t.visible)).map((t=>{const s=G.Z.getDisplayName(t),o=foe++;t.handler&&(s||t.url)&&yoe.set(o,t.handler);const a={};if(t.container?.details)a.container=t.container.details;else if(G.Z.isSeparator(t))a.separator={};else{const r=void 0!==t.id&&""!==n&&t.id===n;let l;switch((t.iconPNG||t.iconPNGWhite)&&(l=[t.iconPNG||"",t.iconPNGWhite||""]),t.type){case"checkbox":case"radio":a.item={id:o,name:s,type:t.type,radiogroup:t.radiogroup?t.radiogroup:-1,checked:t.checked,shortcut:G.Z.getShortcut(t,i),url:t.url,icons:l};break;default:a.item={id:o,name:s,type:t.items?"folder":"command",selected:r,persistent:t.persistent,shortcut:G.Z.getShortcut(t,i),url:t.url,icons:l},t.items&&(a.children=boe(e,t.items,n,i))}}return a}))},Coe={show:function(e,t,n,i,s){foe=0,yoe.clear();const o=e.vivaldiWindowId,a=G.Z.getShortcutSettings(),r=function(e){s&&s(e)},l=function(){s&&s(-1)},c=function(e){const t=yoe.get(e.id);if(t){const n={windowId:o,keyState:{shiftKey:e.state.shift,ctrlKey:e.state.ctrl,altKey:e.state.alt,metaKey:e.state.command,key:""}};e.state.left?n.button=0:e.state.right?n.button=2:e.state.center&&(n.button=1),t(n)}},h=function(e){console.warn(e)};!function(){if(!woe){woe=!0;const e=n.map((e=>(G.Z.installMnemonics(e.menu.items,e.menu.preferred),{id:e.id,rect:e.rect,children:boe(o,e.menu.items,e.menu.expandId,a)})));(function(e,t){return d.Z.zoom.getVivaldiUIZoom().then((e=>{t.forEach((t=>{t.rect.x=parseInt((t.rect.x+1)*e),t.rect.y=parseInt((t.rect.y+0)*e),t.rect.width=parseInt(t.rect.width*e),t.rect.height=parseInt(t.rect.height*e)}))}))})(window,e).then((()=>{d.Z.menubarMenu.onAction.addListener(c),d.Z.menubarMenu.onOpenBookmark.addListener(bn.Z.onOpen),d.Z.menubarMenu.onBookmarkAction.addListener(bn.Z.onAction),d.Z.menubarMenu.onHover.addListener(bn.Z.onHover),d.Z.menubarMenu.onOpen.addListener(r),d.Z.menubarMenu.onClose.addListener(l),d.Z.menubarMenu.onError.addListener(h),d.Z.menubarMenu.show({windowId:o,id:t,siblings:e,icons:[$.Z,Tn.Z,In.Z,kn.Z,An.Z,Cn.Z,Sn.Z]},(()=>{bn.Z.onHover(o,""),d.Z.menubarMenu.onAction.removeListener(c),d.Z.menubarMenu.onOpenBookmark.removeListener(bn.Z.onOpen),d.Z.menubarMenu.onBookmarkAction.removeListener(bn.Z.onAction),d.Z.menubarMenu.onHover.removeListener(bn.Z.onHover),d.Z.menubarMenu.onOpen.removeListener(r),d.Z.menubarMenu.onClose.removeListener(l),d.Z.menubarMenu.onError.removeListener(h),voe.nextTick((()=>{woe=!1}))}))}))}}()}};var Soe;function Toe(e,t,n,i){Soe||(Soe="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Soe,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Ioe=[D.kKeyboardShortcutsAltOpensMenu,D.kMenuIconType],koe="vivaldi";class Aoe extends tn.PureComponent{static contextType=dn.Z;refButton=tn.createRef();shortcuts=[];hasMenu=!1;componentDidMount(){M.Z.addListener(D.kKeyboardShortcutsAltOpensMenu,this._onPrefsChange),U.Z.addListener(this._onCommandStoreChange),this.hasMenu=U.Z.isNamedMenuAvailable(koe),this.hasMenu?this._setupShortcuts(!0):this._requestMenu()}componentWillUnmount(){M.Z.removeListener(D.kKeyboardShortcutsAltOpensMenu,this._onPrefsChange),U.Z.removeListener(this._onCommandStoreChange),this.shortcuts.forEach((e=>{e.shortcut&&wd.Z.unbind(e.shortcut,this._showSubMenu)}))}_onPrefsChange=()=>{this._setupShortcuts(!1)};_onCommandStoreChange=e=>{switch(e){case"init":this._requestMenu();break;case"menu":this.hasMenu=!0,this._setupShortcuts(!1);break;case"shortcut":this._setupShortcuts(!1)}};_changeFocus=()=>{this._showMenu(-1)};_requestMenu(){this.hasMenu||a.Z.requestNamedMenu(koe)}_getMenuItems=e=>U.Z.getNamedMenu(this.context.vivaldiWindowId,koe,e);_setupShortcuts=e=>{this.shortcuts.forEach((e=>{e.shortcut&&wd.Z.unbind(e.shortcut,this._showSubMenu)})),this.shortcuts=[],this.props.prefValues[D.kKeyboardShortcutsAltOpensMenu]?(this.shortcuts=G.Z.getShortcutsForSubMenus(this._getMenuItems(!1)),this.shortcuts.forEach((e=>{e.shortcut&&wd.Z.bind(e.shortcut,this._showSubMenu)}))):e&&this._getMenuItems(!1)};_showMenu=e=>{const t=this.refButton.current?.getBoundingClientRect();if(!t)return;const n=this._getMenuItems(!0),i=e<0?"":n[e].id||"",s={id:0,rect:{x:parseInt(t.left),y:parseInt(t.top),width:parseInt(t.width),height:parseInt(t.height)},menu:{items:n,expandId:i,preferred:this.shortcuts}};Coe.show(this.context,s.id,[s],"bottom")};_showSubMenu=e=>{this.shortcuts.forEach((t=>{t.shortcut&&t.key===e.keyState.key&&this._showMenu(t.index)}))};_handleDoubleClick=e=>{e.preventDefault(),e.stopPropagation()};_handleKeyDown=e=>{switch(e.key){case"ArrowDown":case"Enter":this._showMenu(-1);break;case"Escape":a.Z.executeActions(this.context.vivaldiWindowId,"COMMAND_FOCUS_WEBVIEW");break;default:return}e.preventDefault(),e.stopPropagation()};render(){return Toe(tn.Fragment,{},void 0,Toe(moe,{changeFocus:this._changeFocus}),(0,fn.jsxs)("button",{ref:this.refButton,className:"vivaldi",style:{boxShadow:"none",display:this.props.isHidden?"none":void 0},onMouseDown:()=>this._showMenu(-1),onKeyDown:this._handleKeyDown,onDoubleClick:this._handleDoubleClick,tabIndex:this.props.keyAccess,title:(0,le.Z)("Menu"),children:["icon"===this.props.prefValues[D.kMenuIconType]&&Toe("span",{className:"vivaldi-v",dangerouslySetInnerHTML:{__html:n(3783)}}),"burger"===this.props.prefValues[D.kMenuIconType]&&Toe("span",{className:"burger-icon",dangerouslySetInnerHTML:{__html:n(37609)}})]}))}}const Zoe=(0,fs.Z)(Aoe,Ioe);var Eoe;function _oe(e,t,n,i){Eoe||(Eoe="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Eoe,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Noe=[D.kMenuDisplay];class Moe extends tn.PureComponent{static contextType=dn.Z;constructor(e,t){super(e),this.state={altHover:!1,activeTitle:"",activeUrl:""}}componentDidMount(){z.ZP.isSettings(this.context.vivaldiWindowId)||W.Z.addListener(this._onPageStoreChange)}componentWillUnmount(){z.ZP.isSettings(this.context.vivaldiWindowId)||W.Z.removeListener(this._onPageStoreChange)}_onPageStoreChange=()=>{const e=W.Z.getActivePage(this.context.vivaldiWindowId);if(e&&e.windowId===this.context.vivaldiWindowId){const t={activeTitle:e.title,activeUrl:e.url};this.state.activeTitle===t.activeTitle&&this.state.activeUrl===t.activeUrl||this.setState(t)}};close=e=>{e.stopPropagation(),Ru.Z.close(this.context.vivaldiWindowId)};minimize=e=>{Ru.Z.minimize(this.context.vivaldiWindowId)};maximize=e=>{e.persist(),z.ZP.isMaximized(this.context.vivaldiWindowId)||z.ZP.isFullscreen(this.context.vivaldiWindowId)?Ru.Z.restore(this.context.vivaldiWindowId):Ru.Z.maximize(this.context.vivaldiWindowId)};skipFocusOnSystemButtonMouseDown=e=>{e.preventDefault()};keyDownListener=e=>{e.altKey&&this.setState({altHover:!0})};keyUpListener=e=>{"Alt"===e.key&&this.setState({altHover:!1})};handleMouseEnter=e=>{e.altKey&&this.setState({altHover:!0}),document.addEventListener("keydown",this.keyDownListener),document.addEventListener("keyup",this.keyUpListener)};handleMouseLeave=e=>{this.setState({altHover:!1}),document.removeEventListener("keydown",this.keyDownListener),document.removeEventListener("keyup",this.keyUpListener)};render(){const e=St.jk.getDisplayTitleByUrl(this.state.activeUrl,this.state.activeTitle)||"Vivaldi",t="top"!==this.props.tabPosition?"tabless":null,i=z.ZP.isFullscreen(this.context.vivaldiWindowId);let s,o,a;switch(navigator.appVersion.indexOf("Windows NT 10")>0?"win10":"win32"){case"linux":case"win32":s=n(9927),a=n(98221),o=n(7969);break;case"win10":s=n(51759),a=n(96375),o=n(9592);break;case"darwin":s=n(62469),a=n(91313),o=n(3141)}const r=6===this.props.prefValues[D.kSystemMacAquaColorVariant],l=!this.props.isPopupWindow&&"vivaldi"===this.props.prefValues[D.kMenuDisplay];return this.props.isHidden?l?_oe(Zoe,{keyAccess:this.props.keyAccess,isHidden:!0}):null:_oe("div",{id:"titlebar",className:t},void 0,l&&_oe(Zoe,{keyAccess:this.props.keyAccess,isHidden:!1}),_oe("div",{className:mn()({"window-buttongroup":!0,"alt-hover":this.state.altHover&&!i,graphite:r}),onMouseEnter:null,onMouseLeave:null},void 0,_oe("button",{tabIndex:"-1",className:"window-minimize",onMouseDown:this.skipFocusOnSystemButtonMouseDown,onClick:this.minimize,dangerouslySetInnerHTML:{__html:a}}),_oe("button",{tabIndex:"-1",className:"window-maximize",onMouseDown:this.skipFocusOnSystemButtonMouseDown,onClick:this.maximize,dangerouslySetInnerHTML:{__html:o}}),_oe("button",{tabIndex:"-1",className:"window-close",onMouseDown:this.skipFocusOnSystemButtonMouseDown,onClick:this.close,dangerouslySetInnerHTML:{__html:s}})),"top"!==this.props.tabPosition&&("vivaldi"===this.props.prefValues[D.kMenuDisplay]||this.props.isPopupWindow||!1)&&_oe("div",{id:"pagetitle"},void 0,_oe("span",{},void 0,e)))}}const Poe=(0,fs.Z)(Moe,Noe);var Doe,xoe=n(34155);function Ooe(e,t,n,i){Doe||(Doe="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Doe,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Loe=[];class Roe extends tn.PureComponent{static contextType=dn.Z;state={open:!0,currentToolbar:this.props.toolbar,userCommands:M.Z.get(D.kChainedCommandsCommandList)};componentDidMount(){xoe.nextTick((()=>Wm.Z.refreshActiveMessage()))}componentWillUnmount(){xoe.nextTick((()=>Wm.Z.refreshActiveMessage()))}changeCurrent=e=>{const{value:t}=e.currentTarget;this.setState({currentToolbar:t})};onClose=()=>bd.Z.stopEditing();onDragStart=(e,t)=>{e.dataTransfer.setData(G4,t),e.dataTransfer.setData(z4,"toolbar-editor")};onReset=()=>{const e=Io.w.find((e=>e.pref===this.state.currentToolbar));e&&nt.Z.reset(e.pref)};onEditChains=()=>{ie.Z.showSettings(this.context.vivaldiWindowId,"qc"),this.onClose()};render(){const e=M.Z.get(D.kMailIsTurnedOff)||!z.ZP.isMail(this.context.vivaldiWindowId),t=Io.w.filter((t=>e?!t.category.includes("mail"):t)).map((e=>({category:e.category,label:e.label,pref:e.pref}))),n="chains"!==this.state.currentToolbar?Io.w.find((e=>e.pref===this.state.currentToolbar)):void 0;return Ooe("div",{className:"toolbar-editor"},void 0,Ooe("header",{className:"dialog-header"},void 0,Ooe("h1",{},void 0,(0,le.Z)("Toolbar Editor"),Ooe(YA,{position:"bottom",label:Ooe("div",{},void 0,Ooe("p",{},void 0,(0,le.Z)("Choose a set of toolbar buttons, or your Command Chains. Drag buttons to toolbars, rearrange, or remove them from toolbar by dropping them on the background area.")),Ooe("p",{},void 0,(0,le.Z)("You can always rearrange toolbar buttons by dragging them while pressing the $1 key.",["Ctrl"])),!1)},void 0," ")),Ooe("select",{defaultValue:this.state.currentToolbar,onChange:this.changeCurrent},void 0,t.map((e=>{const{pref:t,label:n}=e;return Ooe("option",{value:t},t,n)})),Ooe("option",{value:"chains"},void 0,(0,le.Z)("Command Chains")))),Ooe("section",{className:"dialog-content"},void 0,n&&n.buttons.filter((e=>"VersionInfo"!==e.id)).map(((e,t)=>Ooe("div",{className:"draggable-button"},t,Ooe(U4,{index:t,name:e.id,label:e.label,menuOrigin:"pointer",popupPosition:"below",size:"large",onDragStart:e=>this.onDragStart(e,t),onDragEnd:Tl.default,onDrop:Tl.default,onDragEnter:Tl.default,customizeMenu:Loe,mimeType:H4,preview:!0,inEditor:!0,draggable:!0},t),e.label))),"chains"===this.state.currentToolbar&&this.state.userCommands.map(((e,t)=>Ooe("div",{className:"draggable-button"},t,Ooe(U4,{index:t,name:e.name,label:e.label,size:"large",onDragStart:e=>this.onDragStart(e,t),onDragEnd:Tl.default,onDrop:Tl.default,onDragEnter:Tl.default,customizeMenu:Loe,menuOrigin:"pointer",popupPosition:"below",mimeType:H4,preview:!0,inEditor:!0,draggable:!0},e.key),e.label)))),"chains"===this.state.currentToolbar&&Ooe("section",{className:"dialog-controls"},void 0,Ooe("input",{type:"button",value:(0,le.Z)("Manage Command Chains"),onClick:this.onEditChains})),"chains"!==this.state.currentToolbar&&Ooe("section",{className:"dialog-preview"},void 0,n?.pref&&Ooe("span",{className:"default-toolbar"},void 0,Ooe(j4,{showDefaultSet:!0,name:n.pref,className:"toolbar-mainbar toolbar-noflex",menuOrigin:"pointer",popupPosition:"below",size:"large"},n.pref)),Ooe("input",{type:"button",value:(0,le.Z)("Reset $1 to Default",[n?.label]),onClick:this.onReset})),Ooe("div",{className:"dialog-footer"},void 0,Ooe("input",{type:"button",value:(0,le.Z)("process","Done"),onClick:this.onClose})))}}var Boe;function Foe(e,t,n,i){Boe||(Boe="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Boe,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Uoe extends tn.PureComponent{componentDidMount(){this._handleShortcutChange(this.props.shortcut.shortcut,!0)}componentWillUnmount(){this._handleShortcutChange(this.props.shortcut.shortcut,!1)}componentDidUpdate(e){this.props.shortcut!==e.shortcut&&(this._handleShortcutChange(e.shortcut.shortcut,!1),this._handleShortcutChange(this.props.shortcut.shortcut,!0))}_handleShortcutChange=(e,t)=>{e&&(t?wd.Z.bind(e,this._handleMenuShortcut):wd.Z.unbind(e,this._handleMenuShortcut))};_getDisplayName=()=>{const e=G.Z.getMenuBarString(this.props.item,this.props.shortcut);if(this.props.underlineAccessKeys&&-1!==e.offset){const t=e.offset;return Foe("span",{},void 0,t>0?e.name.substring(0,t):"",Foe("span",{className:"underlined"},void 0,e.name.substring(t,t+1)),e.name.substring(t+1))}return Foe("span",{},void 0,e.name)};_handleMenuShortcut=()=>{this.props.onItemActivated(this.props.id)};_handleKeyDown=e=>{const{ctrlKey:t,altKey:n,shiftKey:i,metaKey:s}=e,o={ctrlKey:t,altKey:n,shiftKey:i,metaKey:s};switch(e.key){case"ArrowUp":case"ArrowDown":case"Enter":this.props.onItemActivated(this.props.id);break;case"ArrowLeft":this.props.moveFocus(this.props.id,"left",!1);break;case"ArrowRight":this.props.moveFocus(this.props.id,"right",!1);break;case"Escape":if(-1!==this.props.openMenuId)return;this.props.onLeaveBar();break;default:if((0,xr.VV)(o)&&this.props.onAccessKey(e.key))break;return}e.preventDefault(),e.stopPropagation()};_handleMouseDown=e=>{e.button===vn.Z.kLeft&&vn.Z.isNoModifierPressed(e)&&this.props.onItemActivated(this.props.id),e.preventDefault(),e.stopPropagation()};_handleMouseEnter=e=>{this.props.onItemEnter(this.props.id)};_handleMouseLeave=e=>{this.props.onItemLeave(this.props.id)};_handleBlur=()=>{this.props.onItemBlur(this.props.id)};_handleFocus=()=>{this.props.highlighted||this.props.onItemHighlightMissing(this.props.id)};render(){return Foe("button",{"data-id":this.props.id,"data-offset":0,tabIndex:this.props.keyAccess,className:mn()({menubarItem:!0,uifocusstop:0===this.props.id,highlighted:this.props.highlighted,menubar:!0}),onBlur:this._handleBlur,onFocus:this._handleFocus,onKeyDown:this._handleKeyDown,onMouseEnter:this._handleMouseEnter,onMouseLeave:this._handleMouseLeave,onMouseDown:this._handleMouseDown},void 0,this._getDisplayName())}}const Voe=Uoe;var Woe,Hoe=n(34155);function zoe(e,t,n,i){Woe||(Woe="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Woe,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Goe="menubar";class $oe extends tn.PureComponent{static contextType=dn.Z;nodeRef=tn.createRef();acceptEnterId=-1;timer=null;hasMenu=!1;#n=!1;constructor(e,t){super(e),this.hasMenu=U.Z.isNamedMenuAvailable(Goe);const n=this._getMenuItems(t.vivaldiWindowId,!1);this.state={items:n,shortcuts:G.Z.getShortcutsForSubMenus(n),openMenuId:-1,highlightedId:-1,underlineAccessKeys:!1}}componentDidMount(){M.Z.addListener(D.kKeyboardShortcutsAltOpensMenu,this._onPrefsChange),U.Z.addListener(this._onCommandStoreChange),this._requestMenu(),this.#n=!0}componentWillUnmount(){this.timer&&clearTimeout(this.timer),M.Z.removeListener(D.kKeyboardShortcutsAltOpensMenu,this._onPrefsChange),U.Z.removeListener(this._onCommandStoreChange),this.#n=!1}_requestMenu(){this.hasMenu||a.Z.requestNamedMenu(Goe)}_getMenuItems=(e,t)=>U.Z.getNamedMenu(e,Goe,t).filter((e=>"function"!=typeof e.testVisibility||e.testVisibility(this.context.vivaldiWindowId)));_onPrefsChange=()=>{this._setupShortcuts(this.state.items)};_onCommandStoreChange=e=>{switch(e){case"init":this._requestMenu();break;case"menu":this.hasMenu=!0;const e=this._getMenuItems(this.context.vivaldiWindowId,!1);this.setState({items:e,shortcuts:G.Z.getShortcutsForSubMenus(e)});break;case"shortcut":this._setupShortcuts(this.state.items)}};_handleItemActivated=e=>{Coe.show(this.context,e,this._getSiblings(),"bottom",this._onMenuVisibilityChanged)};_handleItemEnter=e=>{-1!==this.acceptEnterId&&this.acceptEnterId!==e||(ss(this.nodeRef.current)&&this._moveFocus(e,"current",!0),this.setState({highlightedId:e}))};_handleItemLeave=e=>{-1===this.state.openMenuId&&this.setState({highlightedId:-1})};_handleItemBlur=e=>{Hoe.nextTick((()=>{ss(this.nodeRef.current)||this.setState({highlightedId:-1})}))};_handleLeaveBar=()=>{this.setState({highlightedId:-1}),a.Z.executeActions(this.context.vivaldiWindowId,"COMMAND_FOCUS_WEBVIEW")};_handleDoubleClick=e=>{e.preventDefault(),e.stopPropagation()};_changeFocus=()=>{ss(this.nodeRef.current)?this._handleLeaveBar():this._moveFocus(this.state.highlightedId,"current",!0)};_moveFocus=(e,t,n)=>{if(!0===n||ss(this.nodeRef.current)){const n=this.state.items.map(((e,t)=>this.state.shortcuts[t]?t:-1)).filter((e=>-1!==e));if(0===n.length)return;if("current"===t){const t=e<0?0:n.indexOf(e);if(-1===t)return;e=n[t]}else if("right"===t||"left"===t){if(1===n.length)return;let i=n.indexOf(e);i="right"===t?i+1>=n.length?0:i+1:i<=0?n.length-1:i-1,e=n[i]}const i=document.querySelector(`button.menubarItem.menubar[data-id="${e}"]`);i&&i instanceof HTMLButtonElement&&this.setState({highlightedId:e},(()=>i.focus()))}};_handleItemHighlightMissing=e=>{this.setState({highlightedId:e})};_onMenuVisibilityChanged=e=>{this.#n&&(-1===e?(this.acceptEnterId=this.state.openMenuId,this.timer=setTimeout((()=>{this.acceptEnterId=-1,this.timer=null}),100),ss(this.nodeRef.current)?this._moveFocus(this.state.openMenuId,"current",!0):this.setState({highlightedId:-1})):(this.setState({highlightedId:e}),this._moveFocus(e,"current",!1)),this.setState({openMenuId:e}),this._showAccessKeys(!1))};_showAccessKeys=e=>{this.setState({underlineAccessKeys:e})};_setupShortcuts=e=>{this.setState({shortcuts:G.Z.getShortcutsForSubMenus(e)})};_activateByAccessKey=e=>{for(let t=0;t<this.state.items.length;t++)if(this.state.shortcuts[t]&&this.state.shortcuts[t].key===e)return this._handleItemActivated(t),!0;return!1};_getSiblings=()=>{const e=this._getMenuItems(this.context.vivaldiWindowId,!0);return Array.from(document.querySelectorAll("button.menubarItem.menubar")).map(((t,n)=>{const i=t.getBoundingClientRect();return{id:parseInt(t.dataset.id),rect:{x:parseInt(i.left),y:parseInt(i.top),width:parseInt(i.width),height:parseInt(i.height)},menu:{items:e[n].items||[],expandId:"",preferred:[]}}}))};renderAll=()=>this.state.items.map(((e,t)=>{if(!this.state.shortcuts[t])return null;const n=0===t?this.props.keyAccess:-1,i=t.toString();return zoe(Voe,{id:t,keyAccess:n,item:e,shortcut:this.state.shortcuts[t],underlineAccessKeys:this.state.underlineAccessKeys,openMenuId:this.state.openMenuId,highlighted:this.state.highlightedId===t,moveFocus:this._moveFocus,onItemActivated:this._handleItemActivated,onItemEnter:this._handleItemEnter,onItemLeave:this._handleItemLeave,onItemBlur:this._handleItemBlur,onItemHighlightMissing:this._handleItemHighlightMissing,onAccessKey:this._activateByAccessKey,onLeaveBar:this._handleLeaveBar},i)}));render(){return zoe(tn.Fragment,{},void 0,zoe(moe,{changeFocus:this._changeFocus,showAccessKeys:this._showAccessKeys}),(0,fn.jsx)("div",{ref:this.nodeRef,className:mn()({menubar:!0,horizontal:this.props.horizontal}),onDoubleClick:this._handleDoubleClick,tabIndex:"-1",children:this.renderAll()}))}}const Koe=$oe;var joe;function Yoe(e,t,n,i){joe||(joe="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:joe,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Xoe=[D.kKeyboardTabToAll,D.kMenuIconType];class Qoe extends tn.PureComponent{static contextType=dn.Z;state={activePage:W.Z.unsafeGetActivePage(this.context.vivaldiWindowId)};componentDidMount(){W.Z.addListener(this._onPageStoreChange)}componentWillUnmount(){W.Z.removeListener(this._onPageStoreChange)}_onPageStoreChange=()=>{this.setState({activePage:W.Z.unsafeGetActivePage(this.context.vivaldiWindowId)})};close=e=>{e.stopPropagation(),Ru.Z.close(this.context.vivaldiWindowId)};render(){return Yoe("div",{className:"topmenu"},void 0,"icon"===this.props.prefValues[D.kMenuIconType]&&Yoe("button",{className:"vivaldi-horizontal-icon",onDoubleClick:this.close,title:(0,le.Z)("Double Click to Close"),tabIndex:"-1"},void 0,Yoe("span",{className:"application-icon",dangerouslySetInnerHTML:{__html:cn.Qa2}}),Yoe("span",{className:"vivaldi-v",dangerouslySetInnerHTML:{__html:n(3783)}})),"burger"===this.props.prefValues[D.kMenuIconType]&&Yoe("button",{className:"vivaldi-horizontal-icon",onDoubleClick:this.close,title:(0,le.Z)("Double Click to Close"),tabIndex:"-1"},void 0,Yoe("span",{className:"burger-icon",dangerouslySetInnerHTML:{__html:n(37609)}})),Yoe(Koe,{horizontal:!0,keyAccess:this.props.prefValues[D.kKeyboardTabToAll]}),Yoe("div",{className:"horizontal-menu-pagetitle"},void 0,St.jk.getDisplayTitle(this.state.activePage)))}}const qoe=(0,fs.Z)(Qoe,Xoe);var Joe=n(34540);const eae=(0,Zr.Z)(Joe.Z,500);class tae extends Z.Z{constructor(e){e.checkRegistered(W.Z),super(e)}getInitialState(){return{}}reduce(e,t){const n=e;switch(t.actionType){case"TILE_INITIALIZED":e=t.tilesState;break;case"TILE_SET_LAYOUT":{const{id:n,mosaicLayout:i}=t;e={...e,[n]:i};break}case"PAGE_TILE_PAGES":{const{pages:n,id:i}=t;e=iae(e,n),i||(e=oae(e,n));break}case"CHROME_TABS_CREATE":const n=W.Z.getPageById(t.page.id);n&&(e=sae(e,fa.aV.of(n)));break;case"PAGE_TABSTACK_REMOVE_FROM":case"PAGE_CLOSE":{const{pages:n}=t;e=iae(e,n);break}case"PAGE_TABSTACK_CREATE":{const{pages:n}=t;e=sae(e,n);break}}return e!==n&&eae(window.vivaldiWindowId,{tiles:e}),e}}function nae(e,t){if("object"!=typeof e)return e;if(e.first===t)return"object"==typeof e.second?{...e.second}:e.second;if(e.second===t)return"object"==typeof e.first?{...e.first}:e.first;const n=nae(e.first,t),i=nae(e.second,t);return e.first!==n||e.second!==i?{...e,first:n,second:i}:e}function iae(e,t){return t.reduce(((t,n,i)=>{const s=n.vivExtData.tiling?.id;if(!s||!e[s])return t;const o=t[s],a=nae(o,W.Z.getTiles(s,n.windowId).findIndex((e=>e.id===n.id)));if(o===a)return t;if("object"==typeof a)return function(e){(function e(t,n){"object"==typeof t.first?e(t.first,n):t.first=n.count++,"object"==typeof t.second?e(t.second,n):t.second=n.count++})(e,{count:0})}(a),{...t,[s]:a};const r={...t};return delete r[s],r}),e)}function sae(e,t){return oae(e,t)}function oae(e,t){return t.map((e=>(0,uv.jA)(e))).forEach((t=>{t&&e[t]&&delete(e={...e})[t]})),e}function aae(e,t){if(e<2)return;const n=t||(e<4?"row":"grid");switch(n){case"grid":const t=3===e?2:Math.floor(Math.sqrt(e));return rae((0,rD.Z)(e),t);case"vertically":return lae((0,rD.Z)(e),"row");case"horizontally":return lae((0,rD.Z)(e),"column");default:return lae((0,rD.Z)(e),n)}}function rae(e,t){if(e.length<=t)return lae(e,"column");const n=e.slice(0,t),i=e.slice(t),s=n.length/e.length*100;return{direction:"row",first:lae(n,"column"),second:rae(i,t),...50===s?null:{splitPercentage:s}}}function lae(e,t){if(1===e.length)return e[0];const n=Math.floor(e.length/2),i=e.slice(0,n),s=e.slice(n),o=i.length/e.length*100;return{direction:t,first:lae(i,t),second:lae(s,t),...50===o?null:{splitPercentage:o}}}const dae=new tae(l.Z);var cae;function hae(e,t,n,i){cae||(cae="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:cae,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const pae=Pq(n(6162).MosaicWithoutDragDropContext),uae=function(e){return{activePageId:W.Z.getActivePage(e)?.id??0,pages:W.Z.getPages(e)}};class gae extends tn.PureComponent{static contextType=dn.Z;constructor(e,t){super(e);const n=(0,kf.default)(M.Z.get(D.kPanelsState),["width"],0);this.state={...uae(t.vivaldiWindowId),contentWidth:t.innerWidth-n,contentHeight:t.innerHeight,tiles:dae.getState(),qrCodeTabId:null,qrCodeUrl:void 0}}componentDidMount(){W.Z.addListener(this._onPageStoreChange),dae.addListener(this._onTilingStoreChange),d.Z.utilities.onShowQRCode.addListener(this.onShowQRCode)}componentWillUnmount(){W.Z.removeListener(this._onPageStoreChange),d.Z.utilities.onShowQRCode.removeListener(this.onShowQRCode),dae.removeListener(this._onTilingStoreChange)}_onPageStoreChange=()=>{const e=uae(this.context.vivaldiWindowId);this.setState(e)};_onTilingStoreChange=()=>{this.setState({tiles:dae.getState()})};onResize=e=>{const t=e[0].target;let n,i;if(t&&t.clientWidth&&t.clientHeight)n=t.clientWidth,i=t.clientHeight;else{const e=(0,kf.default)(M.Z.get(D.kPanelsState),["width"],0);n=this.context.innerWidth-e,i=this.context.innerHeight}this.setState({contentWidth:n,contentHeight:i})};onShowQRCode=(e,t)=>{this.setState({qrCodeTabId:e,qrCodeUrl:t})};handleFocus=e=>{e&&e.nativeEvent&&e.nativeEvent.relatedTarget&&"WEBVIEW"===e.nativeEvent.relatedTarget.tagName&&!0===this.props.cycleFocus&&Vg.Z.doAction(this.context.vivaldiWindowId,this.state.activePageId,"focusWebView")};onMosaicLayoutChange=e=>{const t=W.Z.getPageById(this.state.activePageId);if(t){const n=(0,uv.jA)(t);n&&class{static setTileLayout(e,t){l.Z.dispatch({actionType:"TILE_SET_LAYOUT",mosaicLayout:e,id:t})}}.setTileLayout(e,n)}};renderTileSet=e=>{const t=e.map(uv.jA).toSet(),n=W.Z.getPageById(this.state.activePageId);return t.map((e=>{if(!e)return;const t=W.Z.getTiles(e,this.context.vivaldiWindowId).sortBy((e=>e.index)).map((e=>this.renderPage(e)));let i;if(this.state.tiles[e])i=this.state.tiles[e];else if(n){const e=n.vivExtData.tiling?.layout;i=aae(t.size,e)}const s=!!n&&e===n.vivExtData.tiling?.id;return hae(pae,{className:s?"visible":"hidden",renderTile:e=>t.get(e),value:i,onChange:this.onMosaicLayoutChange},e)}))};onDialogClosed=()=>this.onShowQRCode(0,"");renderPage=e=>{const t=(0,$5.ZN)(e),n=e.id===this.state.qrCodeTabId?this.state.qrCodeUrl:void 0;return hae(J5,{id:e.id,url:e.url,target:e.target,vivExtData:e.vivExtData,showImageInspector:e.showImageInspector,discarded:e.discarded,contentWidth:this.state.contentWidth,contentHeight:this.state.contentHeight,isVisible:t,isActive:e.active,supportsReaderMode:e.supportsReaderMode,qrCodeUrl:n,onDialogClosed:this.onDialogClosed,pinned:e.pinned},`page-component-${e.id}`)};render(){const e=tn.Fragment,t=this.props.cycleFocus?"0":"-1",n=this.state.pages.filter((e=>{const t=(0,uv.jA)(e);return!t||W.Z.getTiles(t,this.context.vivaldiWindowId).size<=1})).sortBy((e=>e.id)).map((e=>this.renderPage(e))),i=this.state.pages.filter((e=>{const t=(0,uv.jA)(e);return t&&W.Z.getTiles(t,this.context.vivaldiWindowId).size>1}));return hae(e,{},"webpage__collection",hae("span",{tabIndex:t,onFocus:this.handleFocus}),hae(ts,{id:"webpage-stack",onResize:this.onResize},void 0,i.size>0&&this.renderTileSet(i),n.size>0&&n),hae("span",{tabIndex:t,onFocus:this.handleFocus}))}}const mae=Pq(gae);function vae(e,t){const{body:n}=e;if(!n)return;const i=getComputedStyle(t.srcElement).getPropertyValue("user-select");if(!t.srcElement.matches("a[href], area[href], input:not([disabled]), select:not([disabled]), option:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]")&&"text"!==i&&"all"!==i){let i=t.target;for(;i!==n&&null!==i;){if(i.draggable){const t=e.activeElement,s=function(i){this.removeEventListener("mouseup",s),this.removeEventListener("dragend",s),e.activeElement===n&&t.focus()};return i.addEventListener("mouseup",s),void i.addEventListener("dragend",s)}i=i.parentElement}t.preventDefault()}}function fae(e){const{body:t}=e;if(!t)return Tl.default;const n=vae.bind(null,e);return t.addEventListener("mousedown",n),function(){t.removeEventListener("mousedown",n)}}var yae=n(39180);let wae="";d.Z.utilities.onScroll.addListener((e=>{1===e?wae="mouse":2===e?wae="trackpad":3===e&&(wae="inertial")}));let bae="";function Cae(e){const t={onDetection:Tae.bind(e),onGesture:Iae.bind(e),onClick:kae.bind(e),onZoom:Eae.bind(e),onWheel:_ae.bind(e)};return d.Z.tabsPrivate.onMouseGestureDetection.addListener(t.onDetection),d.Z.tabsPrivate.onMouseGesture.addListener(t.onGesture),d.Z.tabsPrivate.onWebviewClickCheck.addListener(t.onClick),d.Z.tabsPrivate.onPageZoom.addListener(t.onZoom),e.document.addEventListener("wheel",t.onWheel,{passive:!1}),t}function Sae(e,t){d.Z.tabsPrivate.onMouseGestureDetection.removeListener(t.onDetection),d.Z.tabsPrivate.onMouseGesture.removeListener(t.onGesture),d.Z.tabsPrivate.onWebviewClickCheck.removeListener(t.onClick),d.Z.tabsPrivate.onPageZoom.removeListener(t.onZoom),e.document.removeEventListener("wheel",t.onWheel,{passive:!1})}function Tae(e){this.vivaldiWindowId===e&&function(e){bae="";const t=my.getEntry(e).status;if(t){const{urlValid:e,isBrowserUrl:n}=d.Z.utilities.isUrlValid(t);e&&n&&(bae=t)}}(e)}function Iae(e,t,n,i){if(this.vivaldiWindowId!==e)return;const s=U.Z.getCommandsForGestures();let o;if(bae&&(o=s["e"+i]),!o){if(o=s[i],!o)return;const a=Nae(this,t,n);if(a){const[t]=a;t.active||Y.Z.activateTab(t.id,e)}}const a=o[0];a.function({...(0,zi.m)(e),param:bae}),bae="",X.Z.setStatus(e,(0,le.Z)("Gesture: $1",[a.label]),3e3)}function kae(e,t,n,i,s){if(this.vivaldiWindowId!==e)return;const o=this.document.elementFromPoint(Math.round(i),Math.round(s));if(o&&"WEBVIEW"===o.tagName){t&&o.focus();const e=new MouseEvent(t?"mousedown":"mouseup",{button:n,clientX:i,clientY:s,bubbles:!0});o.dispatchEvent(e)}}let Aae=null;function Zae(){Aae=setTimeout((()=>{Aae=null}),100)}function Eae(e,t,n,i){if(this.vivaldiWindowId!==e||null!==Aae||"inertial"===wae)return;let s;const o=$5.kG(e);if(o.count()>=2){const t=Nae(this,n,i,o);if(!t)return;const[a,r]=t;if(a.active||Y.Z.activateTab(a.id,e),St.jk.isInternalPage(a))return;if("WEBVIEW"!==r.tagName)return void console.error("An external page has "+r.tagName+" tag when WEBVIEW was expected");s=r}else{const t=qt.Z.getActiveWebView(e);if(!t)return;s=t}Zae();const a=.1*t;s.getZoom((t=>{let n=Math.round(10*t)/10+a;n=Math.min(Math.max(n,.2),5),s.setZoom(n),"overlay"!==M.Z.get(D.kStatusBarDisplay)&&M.Z.get(D.kToolbarsStatus).includes("Zoom")||X.Z.setStatus(e,(0,le.Z)("Page Zoom $1%",[Math.round(100*n)]),2e3)}))}function _ae(e){const t=this.vivaldiWindowId,n=e.target;if(n.classList.contains("UrlBar-UrlField")&&n.scrollWidth>=n.clientWidth&&n!==this.document.activeElement)return void e.preventDefault();if(!M.Z.get(D.kMouseWheelTabSwitch)||function(e){return!1===e.altKey&&!1===e.ctrlKey&&!0===e.shiftKey&&!1===e.metaKey}(e))return;let i=!1;if(n.closest("div#tabs-tabbar-container")&&(i=!0),2===e.buttons||function(e){return!0===e.altKey&&!1===e.ctrlKey&&!1===e.shiftKey&&!1===e.metaKey}(e)||i){if(e.preventDefault(),"inertial"===wae)return;const n=e.wheelDelta;let i;if(n>0)i=1;else{if(!(n<0))return;i=-1}const s=false,o=s?"COMMAND_TAB_SWITCH_BACK_SETTING":"COMMAND_TAB_SWITCH_FORWARD_SETTING",a=s?"COMMAND_TAB_SWITCH_BACK_ORDER":"COMMAND_TAB_SWITCH_FORWARD_ORDER",r=s?"COMMAND_TAB_SWITCH_FORWARD_SETTING":"COMMAND_TAB_SWITCH_BACK_SETTING",l=s?"COMMAND_TAB_SWITCH_FORWARD_ORDER":"COMMAND_TAB_SWITCH_BACK_ORDER";let d;if("trackpad"===wae){if(null!==Aae)return;Zae(),d=i<0?2===e.buttons||e.altKey?o:a:2===e.buttons||e.altKey?r:l}else d=i<0?2===e.buttons||e.altKey?o:a:2===e.buttons||e.altKey?r:l;for(const n of eD.CN)if(n.name===d){n.action({windowId:t,keyState:{shiftKey:e.shiftKey,ctrlKey:e.ctrlKey,altKey:e.altKey,metaKey:e.metaKey,key:""},param:e});break}}}function Nae(e,t,n,i){i=i||$5.kG(e.vivaldiWindowId);for(const s of i){const i=e.document.getElementById(String(s.id));if(!i)continue;const o=i.getBoundingClientRect();if(o.left<=t&&t<o.right&&o.top<=n&&n<o.bottom)return[s,i]}return null}var Mae,Pae=n(8400),Dae=n(80419);function xae(e,t,n,i){Mae||(Mae="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Mae,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Oae extends tn.PureComponent{#B;state={isBookmarkButtonOpen:!1};componentDidMount(){this.setExpireTimeout(5e3)}componentWillUnmount(){clearTimeout(this.#B)}setExpireTimeout(e){this.#B=setTimeout((()=>{this.props.onClose()}),e)}onSetBookmarked=e=>y.Z.bookmarks.create(e).then((t=>(ie.Z.showBookmarkAddedPopup(z.ZP.getId(),{pageId:this.props.options.pageId,url:e.url??"",isActive:!0}),t)));handleBookmarkButtonVisibility(e){this.setState({isBookmarkButtonOpen:e}),clearTimeout(this.#B),e||this.setExpireTimeout(500)}render(){const e=en.ZP.findByUrl(this.props.options.url),t="top"===M.Z.get(D.kAddressBarPosition)?"below":"above";return xae(Rw,{pageId:this.props.options.pageId,bookmarkData:e,setBookmarked:this.onSetBookmarked,popupPosition:t,isBookmarkPopup:!0,onBookmarkPopupVisibilityChange:e=>this.handleBookmarkButtonVisibility(e)})}}const Lae=Oae;var Rae,Bae;function Fae(e,t,n,i){Rae||(Rae="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Rae,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Uae extends tn.Component{static contextType=dn.Z;state={doNotShowAgain:!1};_onNo=()=>{this.props.onRequestClose()};_onYes=()=>{nt.Z.set(D.kTabsConfirmClosingTabs,!this.state.doNotShowAgain),this.props.onRequestClose(),Y.Z.closePage(this.props.options.pages,!0)};_toggleDoNotShowAgain=()=>{this.setState((e=>({doNotShowAgain:!e.doNotShowAgain})))};render(){return Fae(ln.Z,{onRequestClose:this._onNo},void 0,Fae("header",{className:"dialog-header"},void 0,Fae("h1",{className:"dialog-title"},void 0,(0,le.Z)("Close Tabs"))),Fae("form",{onSubmit:this._onYes},void 0,Fae("div",{className:"dialog-content"},void 0,Fae("p",{},void 0,(0,le.Z)("Do you want to close $1 tab?","Do you want to close $1 tabs?",[this.props.options.pages.size])),Fae("label",{className:"dialog-checkbox"},void 0,Fae("input",{type:"checkbox",checked:this.state.doNotShowAgain,onChange:this._toggleDoNotShowAgain}),Fae("span",{},void 0,(0,le.Z)("Do not ask again")))),Fae("footer",{className:"dialog-footer"},void 0,Fae("input",{type:"submit",onClick:this._onYes,value:(0,le.Z)("Close Tabs"),autoFocus:!0}),Fae("input",{type:"button",onClick:this._onNo,value:(0,le.Z)("Cancel")}))))}}function Vae(e,t,n,i){Bae||(Bae="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Bae,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Wae extends tn.Component{render(){const{domain:e,trackersCount:t}=this.props.blockedData,{columns:n}=this.props;if(n.length<1||!this.props.blockedData)return null;var i=Vae("span",{},void 0,e),s=Vae("span",{},void 0,t);return n.map((e=>{switch(e.id){case"domain":return Vae("label",{},e.id,i);case"trackersCount":return Vae("label",{className:"count"},e.id,s);default:return null}}))}}const Hae=Wae;var zae;function Gae(e,t,n,i){zae||(zae="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:zae,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const $ae="privacy_stats_domain",Kae=[{text:(0,le.Z)("Address"),value:"domain",fullScreenTitle:(0,le.Z)("Sort by Address"),width:300,visible:!0,key:!0},{text:(0,le.Z)("Trackers"),value:"trackersCount",fullScreenTitle:(0,le.Z)("Sort by Trackers"),width:90,visible:!0}];class jae extends tn.PureComponent{constructor(e){super(e);const t=vu().privacy_stats_domain;this.state={sorting:{sortOrder:1,sortField:"manually"},columns:t||fu(Kae)}}onSortChange=(e,t)=>{this.setState({sorting:{sortOrder:e,sortField:t}})};onUpdateRow=e=>this.setState({columns:e});onSaveRow=()=>mu(this.state.columns,$ae);getRowComponentProps=e=>({columns:this.state.columns,blockedData:e.node});render(){const{columns:e,sorting:t}=this.state,{blockedData:n}=this.props,i=n.blocked_domains.tracking.reduce(((e,t)=>(e.push({domain:t.domain,trackersCount:t.blocked_count}),e)),[]).sort(((e,t)=>e.trackersCount>t.trackersCount?-1:1));return(0,fn.jsxs)(fn.Fragment,{children:[Gae(Iu,{fields:Kae,fullsize:!0,columns:e,keyAccess:0,manualSorting:!1,sortField:t.sortField,sortOrder:t.sortOrder,onSortChange:this.onSortChange,onSaveRow:this.onSaveRow,onUpdateRow:this.onUpdateRow}),Array.isArray(i)&&i.length&&Gae(Yu,{rowComponent:Hae,getRowComponentProps:this.getRowComponentProps,nodes:i,enableDragAndDrop:!1,isFolder:EU.Z,isValidForClipboard:EU.Z,hasChildren:EU.Z,sorting:t,columns:e,multiSelect:!1,onItemDoubleClick:Tl.default})]})}}const Yae=jae;var Xae;function Qae(e,t,n,i){Xae||(Xae="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Xae,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class qae extends tn.Component{render(){const{domain:e,adsCount:t,trackersCount:n}=this.props.blockedData,{columns:i}=this.props;if(i.length<1||!this.props.blockedData)return null;var s=Qae("span",{},void 0,e),o=Qae("span",{},void 0,n),a=Qae("span",{},void 0,t);return i.map((e=>{switch(e.id){case"domain":return Qae("label",{},e.id,s);case"trackersCount":return Qae("label",{className:"count"},e.id,o);case"adsCount":return Qae("label",{className:"count"},e.id,a);default:return null}}))}}const Jae=qae;var ere;function tre(e,t,n,i){ere||(ere="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:ere,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const nre="privacy_stats_origin",ire=[{text:(0,le.Z)("Address"),value:"domain",fullScreenTitle:(0,le.Z)("Sort by Address"),width:300,visible:!0,key:!0},{text:(0,le.Z)("Trackers"),value:"trackersCount",fullScreenTitle:(0,le.Z)("Sort by Trackers"),width:90,visible:!0},{text:(0,le.Z)("Ads"),value:"adsCount",fullScreenTitle:(0,le.Z)("Sort by Ads"),width:90,visible:!0}];class sre extends tn.PureComponent{constructor(e){super(e);const t=vu().privacy_stats_origin;this.state={sorting:{sortOrder:1,sortField:"manually"},columns:t||fu(ire)}}getFormattedData=()=>{const{blockedData:e}=this.props,t=e.blocked_for_origin.ad_blocking.reduce(((e,t)=>(e.push({domain:t.domain,adsCount:t.blocked_count,trackersCount:0}),e)),[]);return e.blocked_for_origin.tracking.reduce(((e,n)=>{if(t.find((e=>e.domain===n.domain))){const t=e.findIndex((e=>e.domain===n.domain));e[t].trackersCount=n.blocked_count}else e.push({domain:n.domain,adsCount:0,trackersCount:n.blocked_count});return e}),t).sort(((e,t)=>e.adsCount+e.trackersCount>t.adsCount+t.trackersCount?-1:1))};onSortChange=(e,t)=>{this.setState({sorting:{sortOrder:e,sortField:t}})};onUpdateRow=e=>this.setState({columns:e});onSaveRow=()=>mu(this.state.columns,nre);getRowComponentProps=e=>({columns:this.state.columns,blockedData:e.node});render(){const{columns:e,sorting:t}=this.state,n=this.getFormattedData();return(0,fn.jsxs)(fn.Fragment,{children:[tre(Iu,{fields:ire,fullsize:!0,columns:e,keyAccess:0,manualSorting:!1,sortField:t.sortField,sortOrder:t.sortOrder,onSortChange:this.onSortChange,onSaveRow:this.onSaveRow,onUpdateRow:this.onUpdateRow}),Array.isArray(n)&&n.length&&tre(Yu,{rowComponent:Jae,getRowComponentProps:this.getRowComponentProps,nodes:n,enableDragAndDrop:!1,isFolder:EU.Z,isValidForClipboard:EU.Z,hasChildren:EU.Z,sorting:t,columns:e,multiSelect:!1,onItemDoubleClick:Tl.default})]})}}const ore=sre;var are;function rre(e,t,n,i){are||(are="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:are,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const lre=["tracking","ad_blocking"];var dre=rre(mp,{type:"blocker-shield",size:40,className:"Blocker-Shield-Trackers Modal-Shield"}),cre=rre(mp,{type:"blocker-shield",size:40,className:"Blocker-Shield-Ads Modal-Shield"});class hre extends tn.PureComponent{static contextType=dn.Z;websiteId=d.Z.utilities.generateGUID();trackerId=d.Z.utilities.generateGUID();constructor(e){super(e),this.state={totalAdBlocked:0,totalTrackerBlocked:0,blockedData:{blocked_domains:{tracking:[],ad_blocking:[]},blocked_for_origin:{tracking:[],ad_blocking:[]}},originDomainData:{domain:"",adsCount:0,trackersCount:0},currentTabId:this.websiteId,startBlockingDate:0,trackerBlockingEnabled:!1,adBlockingEnabled:!1}}componentDidMount(){d.Z.contentBlocking.getBlockedCounters(this.handleBlockedCounter),this.getRules()}handleCloseModal=()=>{this.props.onClose()};handleBlockedCounter=(e,t)=>{if(!t||!t.blocked_for_origin)return;const n=t.blocked_for_origin.ad_blocking.reduce(((e,t)=>e+t.blocked_count),0),i=t.blocked_for_origin.tracking.reduce(((e,t)=>e+t.blocked_count),0);this.setState({totalAdBlocked:n,totalTrackerBlocked:i,blockedData:t,startBlockingDate:e})};clearBlockedData=()=>{d.Z.contentBlocking.clearBlockedCounters(),this.setState({totalAdBlocked:0,totalTrackerBlocked:0,blockedData:{blocked_domains:{tracking:[],ad_blocking:[]},blocked_for_origin:{tracking:[],ad_blocking:[]}},startBlockingDate:0})};setDefaultBlocking=e=>{const{value:t}=e.target;switch(t){case"0":d.Z.contentBlocking.setActiveExceptionsList("tracking","process_list"),d.Z.contentBlocking.setActiveExceptionsList("ad_blocking","process_list");break;case"1":d.Z.contentBlocking.setActiveExceptionsList("tracking","exempt_list"),d.Z.contentBlocking.setActiveExceptionsList("ad_blocking","process_list");break;case"2":d.Z.contentBlocking.setActiveExceptionsList("tracking","exempt_list"),d.Z.contentBlocking.setActiveExceptionsList("ad_blocking","exempt_list")}this.getRules()};getRules=()=>lre.forEach((e=>(0,Ww.pg)(e,(e=>{this.setState(e)}))));render(){const{startBlockingDate:e,totalTrackerBlocked:t,totalAdBlocked:n,currentTabId:i,blockedData:s,trackerBlockingEnabled:o,adBlockingEnabled:a}=this.state,r=0+(o?1:0)+(a?1:0);return rre(ln.Z,{viewMode:"slide",onRequestClose:this.handleCloseModal},void 0,rre("div",{className:"dialog-content Privacy-Stats-Modal"},void 0,rre("header",{className:"Modal-Header"},void 0,rre("p",{className:"Header-Title"},void 0,(0,le.Z)("Privacy Statistics")),rre("p",{title:b()(e).format("LLL")},void 0,e?(0,le.Z)("Trackers and ads blocked since $1.",[b()(e).fromNow()]):(0,le.Z)("Nothing has been blocked yet. Please select an appropriate blocking level below."))),rre("div",{className:"Blocked-Stats-Container"},void 0,rre("div",{className:"Blocked-Stats"},void 0,dre,rre("div",{},void 0,rre("p",{className:"Number-Blocked"},void 0,(0,F.uf)(t)),rre("p",{},void 0,(0,le.Z)("Tracker prevented from profiling you","Trackers prevented from profiling you",[t])))),rre("div",{className:"Blocked-Stats"},void 0,cre,rre("div",{},void 0,rre("p",{className:"Number-Blocked"},void 0,(0,F.uf)(n)),rre("p",{},void 0,(0,le.Z)("Ad blocked","Ads blocked",[n]))))),(t>0||n>0)&&rre(aL,{className:"Privacy-Stats-Board",activeTabId:i,onTabClick:e=>this.setState({currentTabId:e})},void 0,rre("div",{label:(0,le.Z)("Websites"),id:this.websiteId},void 0,rre(ore,{blockedData:s})),rre("div",{label:(0,le.Z)("Trackers"),id:this.trackerId},void 0,rre(Yae,{blockedData:s}))),rre("div",{className:"Blocking-Level"},void 0,rre("h3",{},void 0,(0,le.Z)("Blocking Level:")),rre("select",{className:"Blocking-Level-Select",value:r,onChange:this.setDefaultBlocking,title:(0,le.Z)("Select default level of protection.")},void 0,rre("option",{value:0},void 0,(0,le.Z)("No Blocking")),rre("option",{value:1},void 0,(0,le.Z)("Block Trackers")),rre("option",{value:2},void 0,(0,le.Z)("Block Trackers and Ads"))))),rre("footer",{className:"dialog-footer"},void 0,rre("button",{className:"privacy-btn-icon",title:(0,le.Z)("Privacy Settings"),dangerouslySetInnerHTML:{__html:cn.sgm.medium+(0,le.Z)("Privacy Settings")},onClick:()=>{ie.Z.showSettings(this.context.vivaldiWindowId,"privacy"),this.handleCloseModal()}}),rre("input",{type:"button",className:"danger",value:(0,le.Z)("Reset Statistics"),onClick:this.clearBlockedData}),rre("input",{type:"button",value:(0,le.Z)("Close"),onClick:()=>this.handleCloseModal()})))}}const pre=hre;var ure,gre=n(62645),mre=n(34155);function vre(e,t,n,i){ure||(ure="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:ure,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const fre=[D.kAddressBarPosition,D.kAppearanceHudEnabled,D.kBookmarksBarDisplay,D.kBookmarksBarPosition,D.kKeyboardTabToAll,D.kKeyboardTabToAllUsesSystemDefault,D.kMenuDisplay,D.kPanelsPosition,D.kPanelsAsOverlayEnabled,D.kRazerChromaHasShownPromotion,D.kStartupShowGitDirectoryWarning,D.kStartupShowMediaAvailableInformation,D.kStartupShowFfmpegInformation,D.kStatusBarDisplay,D.kTabsAtEdge,D.kTabsBarPosition,D.kTabsBarWidth,D.kTabsCloseButtonLeft,D.kTabsStackingMode,D.kThemesPreview,D.kThemeUseAnimation,D.kThemesUser,D.kWindowsLinuxAltControls],yre=yae.Z.call(),wre=!1;const bre=(0,Zr.Z)(((e,t)=>{t?Y.Z.cycleByHistory(e,void 0,{goBack:!1}):Y.Z.cycleByOrder(e,void 0,{goBack:!1})}),0),Cre=(0,Zr.Z)(((e,t)=>{t?Y.Z.cycleByHistory(e,void 0,{goBack:!0}):Y.Z.cycleByOrder(e,void 0,{goBack:!0})}),0);var Sre=vre(qoe,{}),Tre=vre(o6,{size:"large"}),Ire=vre(Bie,{}),kre=vre(j4,{name:D.kToolbarsStatus,menuOrigin:"bottomLeft",className:"toolbar-statusbar",popupPosition:"above",size:"medium"});class Are extends tn.PureComponent{static contextType=dn.Z;refWebpageView=tn.createRef();refMainDialog=tn.createRef();#F;#U;constructor(e,t){super(e);const n=z.ZP.getWindowState(t.vivaldiWindowId),i=P.Z.getState().windowClassNames.get(t.vivaldiWindowId)||{},s=P.Z.getState().windowThemes.get(t.vivaldiWindowId)||lT.Z.getDefaultTheme(),o=P.Z.getState().windowStyles.get(t.vivaldiWindowId)||lT.Z.getFallbackStyle();if(!n)throw new Error("MainWindow constructor: Expected windowState");const a="left"===e.prefValues[D.kTabsBarPosition]&&n.visibleUI.tabs?Math.round(e.prefValues[D.kTabsBarWidth]):0;this.state={bookmarkDialogParent:!1,bookmarkDialogOptions:null,capturing:Bs.getCapturingState(t.vivaldiWindowId),clearBrowsingHistoryOptions:null,confirmOpenLinksOptions:null,confirmCloseOtherTabs:null,onAfterCloseDialog:null,dialogCustomData:null,importData:!1,isBreakModeActive:us.Z.getState().isActive,isDraggingButton:!1,panelWidth:Dl.ZP.getWidth(t.vivaldiWindowId)+6,mainDialogOptions:null,mainDialogType:null,openSession:!1,paneSelection:!1,preventAppRegionDrag:!1,quickCommandValue:"",saveSession:!1,saveSessionOptions:null,windowClassNames:i,windowStyle:o,windowState:n,windowTheme:s,showPrivacyStats:!1,showBookmarkAddedPopup:!1,bookmarkAddedPopupOptions:null,startupDialogQueue:new Map,leftTabBarWidth:a,editToolbar:""},this._updateKeyUIMode(),this.trackContextOnFocus=t4("content",this.context)}async componentDidMount(){this.#F=Cae(this.context),this.#U=gre.Z.attachSpatnavListeners(this.context.vivaldiWindowId),R9.addListener(this._onMainStoreChanged),Dl.ZP.addListener(this._onPanelStoreChanged),Bs.addListener(this.#V),us.Z.addListener(this.onBreakModeStoreChanged),P.Z.addListener(this.onThemeStoreChanged),jr.addListener(this._onToolbarStoreChanged),z.ZP.addListener(this._onWindowStoreChanged),d.Z.contextMenu.onDocumentMenu.addListener(this._onDocumentMenu),d.Z.utilities.onBroadcastMessage.addListener(this._onBroadcastMessage),y.Z.runtime.onMessage.addListener(this.onMessageReceived),this.detachFocusableEvents=fae(this.context.document),d.Z.tabsPrivate.onKeyboardShortcut.addListener(this._handleKeyboardShortcut),d.Z.windowPrivate.onActiveTabStatusText.addListener(this._onActiveTabStatusText),Cie.addListener(this._onPopupWindowStoreChanged),y.Z.contextMenus.removeAll(),await this.createStartupDialogQueue()}componentDidUpdate(e,t){if(e.prefValues[D.kThemesPreview].length<this.props.prefValues[D.kThemesPreview].length){const e=lT.Z.getPreview();z.ZP.isActive(this.context.vivaldiWindowId)&&this.showDialog({dialogtype:"themePreview",themeName:e?.name||"",isUpdate:this.props.prefValues[D.kThemesUser].findIndex((t=>t.id===e?.id))>-1},null)}else e.prefValues[D.kThemesPreview].length>this.props.prefValues[D.kThemesPreview].length&&this.handleOnCloseDialog();!t.windowState.active&&this.state.windowState.active&&this.maybeFocusLastActiveElement()}componentWillUnmount(){Sae(this.context,this.#F),gre.Z.detachSpatnavListeners(this.#U),this.detachFocusableEvents(),R9.removeListener(this._onMainStoreChanged),Dl.ZP.removeListener(this._onPanelStoreChanged),Bs.removeListener(this.#V),us.Z.removeListener(this.onBreakModeStoreChanged),jr.removeListener(this._onToolbarStoreChanged),z.ZP.removeListener(this._onWindowStoreChanged),P.Z.removeListener(this.onThemeStoreChanged),d.Z.contextMenu.onDocumentMenu.removeListener(this._onDocumentMenu),d.Z.utilities.onBroadcastMessage.removeListener(this._onBroadcastMessage),y.Z.runtime.onMessage.removeListener(this.onMessageReceived),Cie.removeListener(this._onPopupWindowStoreChanged),d.Z.tabsPrivate.onKeyboardShortcut.removeListener(this._handleKeyboardShortcut)}_handleKeyboardShortcut=(e,t,n)=>{e===this.context.vivaldiWindowId&&wd.Z.handleShortcut(e,t,n,window.document.activeElement)};#V=()=>{const e=Bs.getCapturingState(this.context.vivaldiWindowId);e?this.clearAppRegion():this.restoreAppRegion(),this.setState({capturing:e})};onBreakModeStoreChanged=()=>{const e=us.Z.getState().isActive;this.setState({isBreakModeActive:e})};onThemeStoreChanged=()=>{const e=P.Z.getState().windowStyles.get(this.context.vivaldiWindowId)||lT.Z.getFallbackStyle(),t=P.Z.getState().windowThemes.get(this.context.vivaldiWindowId)||lT.Z.getDefaultTheme(),n=P.Z.getState().windowClassNames.get(this.context.vivaldiWindowId)||{};e===this.state.windowStyle&&t===this.state.windowTheme&&n===this.state.windowClassNames||this.setState({windowClassNames:n,windowStyle:e,windowTheme:t})};_onToolbarStoreChanged=()=>{this.setState({editToolbar:jr.getState()})};onDragStart=e=>{e.dataTransfer.getData("vivaldi/x-button-toolbar")&&this.setState({isDraggingButton:!0})};onDragEnd=e=>{this.state.isDraggingButton&&this.setState({isDraggingButton:!1})};createStartupDialogQueue=async()=>{let e=!1;const t=this.context.vivaldiWindowId,n=new Map,i=async t=>{const i=await d.Z.utilities.getSharedData({key:t,value:!1}),s=this.refWebpageView.current;s&&!i&&(n.set(t,{active:!e,anchor:s}),e=!0,await d.Z.utilities.setSharedData({key:t,value:!0}))};await d.Z.utilities.getSharedData({key:Q.oj,value:!1},(i=>{if(!i){M.Z.get(D.kStartupCheckIsDefault)&&!z.ZP.isGuestSession(t)&&z.ZP.isActive(t)&&d.Z.utilities.isVivaldiDefaultBrowser((t=>{!1===t&&y.Z.history.search({startTime:Date.now()-2592e5,endTime:Date.now(),text:""},(t=>{const i=this.refWebpageView.current;t.length>=10&&i&&(n.set(Q.oj,{active:!e,anchor:i}),e=!0,this.setState({startupDialogQueue:n}),d.Z.utilities.setSharedData({key:Q.oj,value:!0}))}))}))}})),z.ZP.isIncognitoOrGuest(t)||await d.Z.utilities.isRazerChromaAvailable()&&!this.props.prefValues[D.kRazerChromaHasShownPromotion]&&await i(Q.Bo),"linux"===yae.Z.call()&&this.props.prefValues[D.kStartupShowFfmpegInformation]&&!0===await d.Z.utilities.getFFMPEGState()&&await i(Q.d7),"win"===yae.Z.call()&&this.props.prefValues[D.kStartupShowMediaAvailableInformation]&&!1===await d.Z.utilities.getMediaAvailableState&&await i(Q.yl),""!==this.props.prefValues[D.kStartupShowGitDirectoryWarning]&&await i(Q.Yd),this.setState({startupDialogQueue:n})};storeQuickCommandSearch=e=>{this.setState({quickCommandValue:e})};closeStartupDialog=e=>{const t=this.state.startupDialogQueue;t.get(e)&&t.delete(e);for(const[e]of t){const n=t.get(e);if(n){n.active=!0;break}}this.setState(((e,n)=>({startupDialogQueue:t}))),this.forceUpdate()};shouldShowStartupDialog=e=>{const t=this.state.startupDialogQueue.get(e);return t&&t.active};_onActiveTabStatusText=(e,t)=>{e===this.context.vivaldiWindowId&&X.Z.setStatus(e,t)};_updateKeyUIMode=()=>{const e=this.props.prefValues;if(e[D.kKeyboardTabToAllUsesSystemDefault]){const t=this.props.prefValues[D.kSystemMacKeyboardUiMode];2===t&&0!==e[D.kKeyboardTabToAll]?nt.Z.set(D.kKeyboardTabToAll,0):0===t&&-1!==e[D.kKeyboardTabToAll]&&nt.Z.set(D.kKeyboardTabToAll,-1)}};_onPopupWindowStoreChanged=()=>{const e=Cie.getState();d.Z.utilities.broadcastMessage({popupStoreChanged:{windowId:this.context.vivaldiWindowId,popupWindows:e}})};_onMainStoreChanged=e=>{if(e.winId===this.context.vivaldiWindowId)switch(e.type){case"MAIN_SHOW_CONFIRM_OPEN_LINKS_DIALOG":this.showConfirmOpenLinksDialog(e.options);break;case"MAIN_SHOW_CONFIRM_CLOSE_OTHER_TABS_DIALOG":this.setConfirmCloseOtherTabsDialog(e.options);break;case"MAIN_SHOW_CLEAR_BROWSING_HISTORY_DIALOG":this.showClearBrowsingHistoryDialog();break;case"MAIN_SHOW_BOOKMARK_DIALOG":this.showBookmarkDialog(e.options);break;case"MAIN_SHOW_SAVE_SESSION_DIALOG":this.showSaveSession(e.options);break;case"MAIN_SHOW_OPEN_SESSION_DIALOG":this.showOpenSession();break;case"MAIN_SHOW_IMPORT_DATA_DIALOG":this.showDialog({dialogtype:"import"},null);break;case"MAIN_SHOW_PAGE_ACCESS_KEYS":{const t=W.Z.getActivePage(this.context.vivaldiWindowId);t&&!(0,Ni.xl)(t.url)&&this.toggleMainDialog(e.type);break}case"MAIN_SHOW_KEYBOARDS_SHORTCUTS":case"MAIN_SHOW_QUICKCOMMANDS":case"MAIN_SHOW_MAIL_ACCOUNT_DIALOG":case"MAIN_SHOW_CALENDAR_ACCOUNT_DIALOG":case"MAIN_SHOW_CREATE_CALENDAR_DIALOG":case"MAIN_SHOW_CREATE_LABEL":this.toggleMainDialog(e.type);break;case"MAIN_SHOW_CALENDAR_EDIT_EVENT":case"MAIN_SHOW_CALENDAR_IMPORT_EVENTS_DIALOG":case"MAIN_SHOW_MAIL_AUTHENTICATION_DIALOG":case"MAIN_SHOW_MAIL_DELETE_DIALOG_ACCOUNTS":case"MAIN_SHOW_MAIL_DELETE_DIALOG_CONFIRM_ALL":case"MAIN_SHOW_MAIL_DELETE_DIALOG_FOLDERS":case"MAIN_SHOW_MAIL_DELETE_DIALOG_SETTING":case"MAIN_SHOW_MAIL_UNSUBSCRIBE_DIALOG":case"MAIN_SHOW_ACCOUNT_SHEET":this.toggleMainDialog(e.type,e.options);break;case"MAIN_SHOW_ADD_FEED":case"MAIN_SHOW_ADD_MAIL_FOLDER":case"MAIN_SHOW_DELETE_MAIL_FOLDER":case"MAIN_SHOW_DELETE_LABEL_CONFIRMATION":z.ZP.isActive(this.context.vivaldiWindowId)&&this.toggleMainDialog(e.type,e.options);break;case"MAIN_SHOW_MODAL_DIALOG":case"MAIN_SHOW_CALENDAR_ALARM":this.state.mainDialogType!==e.type?this.toggleMainDialog(e.type,e.options):this.state.mainDialogOptions?.windowToRestore||"number"!=typeof e.options.windowToRestore||this.setState({mainDialogOptions:e.options});break;case"MAIN_SELECTING_TOOLBAR":this.setPaneSelection(e.options.enable);break;case"MAIN_SHOW_DIALOG":this.showDialog(e.options,e.onAfterClose);break;case"MAIN_SHOW_BOOKMARK_ADDED_POPUP":this.showBookmarkAddedPopup(e.options);break;case"MAIN_SHOW_PRIVACY_STATS":this.showPrivacyStats()}};_onPanelStoreChanged=e=>{e!==Dl.dr&&e!==this.context.vivaldiWindowId||this.setState({panelWidth:Dl.ZP.getWidth(this.context.vivaldiWindowId)+6})};onCloseMainDialog=()=>new Promise((e=>{this.setState({mainDialogType:null,mainDialogOptions:null},e)}));setPaneSelection=e=>{this.setState({paneSelection:e})};toggleMainDialog=(e,t)=>{this.state.mainDialogType===e?this.onCloseMainDialog():this.setState({mainDialogType:e,mainDialogOptions:t||null})};handleTabSwitcherActivation=e=>{const t=this.refMainDialog.current?.refVisualTabSwitcher.current;if(!e&&t){const e=t.state.selected;Y.Z.activateTab(e.id,this.context.vivaldiWindowId)}this.onCloseMainDialog()};switchTabVisualTabSwitcher=(e,t,n)=>{if(!n&&"wheel"!==e?.type)return void((e,t)=>{const n=M.Z.get(D.kTabsCycleByRecentOrder);t?bre(e,n):Cre(e,n)})(this.context.vivaldiWindowId,t);const{mainDialogType:i}=this.state;if(W.Z.getPages(this.context.vivaldiWindowId).size>1){"MAIN_SHOW_TAB_CYCLER"!==i&&(this.toggleMainDialog("MAIN_SHOW_TAB_CYCLER"),(0,Dae.g)(e,this.handleTabSwitcherActivation,this.context.document));const n=this.refMainDialog.current?.refVisualTabSwitcher.current;t?n?.selectForward():n?.selectBack()}};maybeFocusLastActiveElement=()=>{if(!this._lastActiveElement)return;if(!["BODY","WEBVIEW"].includes(this._lastActiveElement.tagName))return this._lastActiveElement?.focus(),void(this._lastActiveElement=null);const e=W.Z.getActivePage(this.context.vivaldiWindowId);if(!e)return;if("content"===z5({winId:this.context.vivaldiWindowId,pageId:e.id,url:e.url,activeElement:this.context.document.activeElement})){qt.Z.getActiveWebView(this.context.vivaldiWindowId)?.focus()}};_onWindowStoreChanged=()=>{const e=this.context.vivaldiWindowId,t=z.ZP.getWindowState(e);t&&this.state.windowState!==t&&(this.state.windowState.active!==t.active&&(t.active?this._onWindowFocus():this._onWindowBlur()),this.setState({windowState:t}))};_onWindowFocus=()=>{wre};_onWindowBlur=()=>{const{document:e}=this.context;this._lastActiveElement=e.activeElement};onMessageReceived=(e,t)=>{if(e&&e.dispatchAction&&t.id===y.Z.runtime.id)switch(e.dispatchAction){case gne:this.clearAppRegion();break;case mne:this.restoreAppRegion()}};_acceptPopup=(e,t)=>{const n=Cie.getState().find((t=>t.identifier===e));n&&n.acceptOrBlockCallback(t)};_onMacMenuAction=(e,t,n)=>{if(e===this.context.vivaldiWindowId&&!z.ZP.isMinimized(e)){const i=U.Z.getHandlerByAction(e,t,n);i?i():a.Z.executeActions(e,t)}};_onDocumentMenu=(e,t,n)=>{e===this.context.vivaldiWindowId&&ql.show(e,t,n)};_onBroadcastMessage=e=>{if(e.open){if(e.open.winId===this.context.vivaldiWindowId){const{winId:t,urls:n,prompt:i}=e.open;if(z.ZP.getWindowState(t)){const e={inCurrent:!1,inBackground:M.Z.get(D.kTabsOpenNewInBackground),inNewWindow:!1,allowOverride:!1,incognito:!1};Jt.ZP.openUrls(t,n,e,i)}}}else if(e.minimizeAll)for(const[e]of z.ZP.getState())Ru.Z.minimize(e);else if(e.handlePopupWindow){const{popupId:t,windowId:n}=e.handlePopupWindow;this._acceptPopup(t,n)}else if(e.windowActiveStateChanged){const{windowId:t,activated:n}=e.windowActiveStateChanged;l.Z.dispatch({actionType:"WINDOW_ACTIVATED",activated:n,windowId:t})}else if(e.windowAdded){const{windowId:t,windowState:n}=e.windowAdded;l.Z.dispatch({actionType:"WINDOW_SET_STATE",windowState:n,windowId:t})}else if(e.windowRemoved){const{windowId:t}=e.windowRemoved;l.Z.dispatch({actionType:"WINDOW_CLOSED",windowId:t})}};clearAppRegion=()=>{this.setState({preventAppRegionDrag:!0})};restoreAppRegion=()=>{this.setState({preventAppRegionDrag:!1})};handleDoubleClick=()=>{"top"===this.props.prefValues[D.kTabsBarPosition]&&this.state.windowState.nativeDecorations?Y.Z.openURL(this.context.vivaldiWindowId,""):z.ZP.isMaximized(this.context.vivaldiWindowId)||(z.ZP.isFullscreen(this.context.vivaldiWindowId),0)?Ru.Z.restore(this.context.vivaldiWindowId):Ru.Z.maximize(this.context.vivaldiWindowId)};closeConfirmOpenLinksDialog=()=>{this.setState({confirmOpenLinksOptions:null})};showConfirmOpenLinksDialog=e=>{this.setState({confirmOpenLinksOptions:e})};setConfirmCloseOtherTabsDialog=e=>{this.setState({confirmCloseOtherTabs:e})};showClearBrowsingHistoryDialog=()=>{z.ZP.isIncognitoOrGuest(this.context.vivaldiWindowId)||this.setState({clearBrowsingHistoryOptions:!0})};closeClearBrowsingHistoryDialog=()=>{this.setState({clearBrowsingHistoryOptions:null})};closeImportContacts=()=>{this.setState({importData:Boolean(this.refWebpageView.current)})};showBookmarkDialog=e=>{this.setState({bookmarkDialogParent:Boolean(this.refWebpageView.current),bookmarkDialogOptions:e})};showBookmarkAddedPopup=e=>{this.setState({showBookmarkAddedPopup:!0,bookmarkAddedPopupOptions:e})};closeBookmarkDialog=()=>{this.setState({bookmarkDialogParent:!1})};closeSaveSession=()=>{this.setState({saveSession:!1})};showSaveSession=e=>{this.setState({saveSession:Boolean(this.refWebpageView.current),saveSessionOptions:e})};closeOpenSession=()=>{this.setState({openSession:!1})};showOpenSession=()=>{this.setState({openSession:Boolean(this.refWebpageView.current)})};showDialog=(e,t)=>{this.setState({dialogCustomData:e,onAfterCloseDialog:t})};showPrivacyStats=()=>{this.setState({showPrivacyStats:!0})};handleOnCloseDialog=()=>{this.setState({dialogCustomData:null}),mre.nextTick((()=>{this.state.onAfterCloseDialog?.()}))};hasHorizontalMenu=()=>Boolean("top"===this.props.prefValues[D.kMenuDisplay]&&!0);getBrowserClasses=(e,t)=>{const{prefValues:n}=this.props,{visibleUI:i,type:s,active:o,state:a,nativeDecorations:r,fullscreenMenubarShown:l}=t,{addressBar:d,bookmarksBar:c,tabs:h}=i,{windowClassNames:p,isBreakModeActive:u,isDraggingButton:g,preventAppRegionDrag:m,paneSelection:v,editToolbar:f}=this.state,y=n[D.kTabsBarPosition],w=(0,z.WV)(t),b="settings"===s,C="normal"===s,S="popup"===s,T="substrip"===n[D.kTabsStackingMode],I="accordion"===n[D.kTabsStackingMode],k="bottom"===y||"top"===y,A="maximized"===a||"fullscreen"===a,Z=n[D.kAddressBarPosition],E=n[D.kBookmarksBarPosition],_=h&&C?y:"off",N=n[D.kTabsAtEdge]&&k&&A;return mn()(yre,w,{...p,win10:navigator.appVersion.indexOf("Windows NT 10")>0,"minimal-ui":z.ZP.isMinimalUI(e),hasfocus:o,isblurred:!o,native:r,"mac-fullscreen-hover":l&&o,popup:S,"is-settingspage":b,"horizontal-menu":this.hasHorizontalMenu(),"tabs-at-edge":N,alt:n[D.kWindowsLinuxAltControls]&&false,"alt-tabs":n[D.kTabsCloseButtonLeft],"substrip-tabs-on":T,"accordion-tabs-on":I,"full-key-access":0===n[D.kKeyboardTabToAll],"break-mode":u,[`stacks-${n[D.kTabsStackingMode]}`]:!0,[`address-${Z}`]:d,[`address-${Z}-off`]:!d,[`bookmark-bar-${E}`]:c,[`bookmark-bar-${E}-off`]:!c,[`tabs-${_}`]:!0,"is-dragging-button":g,"no-app-dragging":m,"active-pane-selection":v,"animation-off":!n[D.kThemeUseAnimation],"toolbar-edit-mode":""!==f})};setLeftTabbarWidth=e=>{this.setState({leftTabBarWidth:e})};onInnerOver=e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"};onInnerClick=()=>bd.Z.stopEditing();onInnerDrop=e=>{e.preventDefault();const t=e.dataTransfer.getData(G4),n=e.dataTransfer.getData(z4);if("toolbar-editor"!==n){const e=[...M.Z.get(n)];e.splice(parseInt(t),1),nt.Z.set(n,e)}};render(){const e=this.props.prefValues,{capturing:t}=this.state,i=""!==this.state.editToolbar,o=e[D.kTabsBarPosition],{html5FullScreen:a,state:r,visibleUI:l}=this.state.windowState,d="left"===o||"right"===o?{[`padding${(0,Pae.Z)(o)}`]:e[D.kTabsBarWidth]}:void 0,c="fullscreen"===r&&!(l.tabs&&"top"===o);return vre("div",{id:"browser",lang:y.Z.i18n.getUILanguage(),className:this.getBrowserClasses(this.context.vivaldiWindowId,this.state.windowState),style:this.state.windowStyle,onDragStart:i?this.onDragStart:null,onDragEnd:i?this.onDragEnd:null,onDrop:i?this.onDragEnd:null},void 0,vre(id,{level:"nothing"},void 0,vre("div",{id:"header",onDoubleClick:this.handleDoubleClick},void 0,vre(Poe,{isHidden:c,isPopupWindow:!1,tabPosition:l.tabs?o:"none",keyAccess:e[D.kKeyboardTabToAll]}),this.hasHorizontalMenu()&&Sre,("top"===o||!l.tabs)&&vre(uoe,{switchTabVisualTabSwitcher:this.switchTabVisualTabSwitcher,mainDialogType:this.state.mainDialogType,tabPosition:o,theme:this.state.windowTheme,visible:l.tabs},"tabbar")),vre("div",{id:"main",className:e[D.kPanelsPosition]},void 0,Tre,l.bookmarksBar&&vre(ps,{display:e[D.kBookmarksBarDisplay],statusOff:"off"===l.statusBar,keyAccess:e[D.kKeyboardTabToAll]}),this.shouldShowStartupDialog(Q.oj)&&vre(xie,{onClose:this.closeStartupDialog.bind(this,Q.oj)}),vre("div",{className:"inner",onClick:i?this.onInnerClick:null,onDragEnter:i?e=>e.preventDefault():null,onDragOver:i?this.onInnerOver:null,onDrop:i?this.onInnerDrop:null},void 0,this.state.dialogCustomData&&vre(_l,{customData:this.state.dialogCustomData,closeDialog:this.handleOnCloseDialog}),this.state.confirmOpenLinksOptions&&vre(ro,{options:this.state.confirmOpenLinksOptions,onRequestClose:this.closeConfirmOpenLinksDialog}),this.state.confirmCloseOtherTabs&&vre(Uae,{options:this.state.confirmCloseOtherTabs,onRequestClose:()=>this.setConfirmCloseOtherTabsDialog(null)}),this.state.clearBrowsingHistoryOptions&&vre(oo,{onClose:this.closeClearBrowsingHistoryDialog}),this.state.bookmarkDialogParent&&this.state.bookmarkDialogOptions&&vre(un,{onClose:this.closeBookmarkDialog,options:this.state.bookmarkDialogOptions}),this.state.saveSession&&this.state.saveSessionOptions&&vre(Nie,{onClose:this.closeSaveSession,options:this.state.saveSessionOptions}),!z.ZP.isIncognitoOrGuest(this.context.vivaldiWindowId)&&Ire,this.shouldShowStartupDialog(Q.Bo)&&vre(Aie,{onClose:this.closeStartupDialog.bind(this,Q.Bo)}),this.shouldShowStartupDialog(Q.d7)&&vre(ld,{onClose:this.closeStartupDialog.bind(this,Q.d7)}),this.shouldShowStartupDialog(Q.yl)&&vre(yd,{onClose:this.closeStartupDialog.bind(this,Q.yl)}),this.shouldShowStartupDialog(Q.Yd)&&vre(ud,{onClose:this.closeStartupDialog.bind(this,Q.Yd)}),this.state.openSession&&vre(X9,{onClose:this.closeOpenSession}),this.state.showPrivacyStats&&vre(pre,{onClose:()=>this.setState({showPrivacyStats:!1})}),vre(wie,{position:e[D.kPanelsPosition],outsideClickIgnoreClass:"panel-clickoutside-ignore"},"panel"),vre("div",{style:{width:!a&&l.tabs&&"left"===o?this.state.leftTabBarWidth:0,height:"auto"}},"webview-anchor","left"===o&&l.tabs&&vre(uoe,{switchTabVisualTabSwitcher:this.switchTabVisualTabSwitcher,mainDialogType:this.state.mainDialogType,tabPosition:o,theme:this.state.windowTheme,visible:l.tabs,onSetLeftTabBarWidth:this.setLeftTabbarWidth},"tabbar")),(0,fn.jsx)("div",{ref:this.refWebpageView,id:"webview-container",onFocus:this.trackContextOnFocus,children:vre(mae,{cycleFocus:M.Z.get(D.kWebpagesFocusTrap)})}),"overlay"===l.statusBar&&!a&&vre(by,{style:{[e[D.kPanelsPosition]]:this.state.panelWidth,...d}}),"right"===o&&l.tabs&&vre(uoe,{switchTabVisualTabSwitcher:this.switchTabVisualTabSwitcher,mainDialogType:this.state.mainDialogType,tabPosition:o,theme:this.state.windowTheme,visible:l.tabs},"tabbar"))),vre("footer",{},void 0,"bottom"===o&&l.tabs&&vre(uoe,{switchTabVisualTabSwitcher:this.switchTabVisualTabSwitcher,mainDialogType:this.state.mainDialogType,tabPosition:o,theme:this.state.windowTheme,visible:!0},"tabbar"),"on"===l.statusBar&&kre),this.state.mainDialogType&&(0,fn.jsx)(O9,{ref:this.refMainDialog,onClose:this.onCloseMainDialog,dialog:this.state.mainDialogType,options:this.state.mainDialogOptions,quickCommandValue:this.state.quickCommandValue,storeQuickCommandSearch:this.storeQuickCommandSearch}),i&&vre(Roe,{toolbar:this.state.editToolbar}),e[D.kAppearanceHudEnabled]&&vre(Wr.Z,{classNames:"HUD",in:this.state.isBreakModeActive,mountOnEnter:!0,unmountOnExit:!0,timeout:{enter:500,exit:100}},void 0,vre("button",{className:"HUD",onClick:s.Z.toggleBreakMode,dangerouslySetInnerHTML:{__html:cn._qK.large}})),!this.state.windowState.visibleUI.addressBar&&vre(Wr.Z,{in:this.state.showBookmarkAddedPopup,classNames:"Bookmark-Added-Popup",mountOnEnter:!0,unmountOnExit:!0,onExited:()=>this.setState({bookmarkAddedPopupOptions:null}),timeout:{enter:300,exit:150}},void 0,vre("div",{className:"Bookmark-Added-Popup"},void 0,this.state.bookmarkAddedPopupOptions&&vre(Lae,{options:this.state.bookmarkAddedPopupOptions,onClose:()=>this.setState({showBookmarkAddedPopup:!1})}))),vre("svg",{version:"1.1",width:"0",height:"0",dangerouslySetInnerHTML:{__html:n(46639)}}),t&&vre(Ls,{winId:this.context.vivaldiWindowId})))}}const Zre=(0,fs.Z)(Are,fre);var Ere=n(14481);let _re=!1;const Nre=Dr()("black");let Mre,Pre=Nre,Dre=Nre;const xre={_onPrefsCacheChanged:function(e,t,n){n===D.kRazerChromaEnabled&&!0===t&&xre.init()},isInitialized:function(){return _re},setInitCallback:function(e){Mre=e},onChromaReady:function(){_re||(_re=!0,Dre!==Nre&&(xre.setColor(Dre),Dre=Nre),Mre&&Mre(),d.Z.utilities.onRazerChromaReady.removeListener(this.onChromaReady),P.Z.addListener(this.onColorUpdated))},init:function(){_re=!1,M.Z.addListener([D.kRazerChromaEnabled],this._onPrefsCacheChanged),d.Z.utilities.onRazerChromaReady.addListener(this.onChromaReady),d.Z.utilities.isRazerChromaReady((e=>{e&&this.onChromaReady()}))},onColorUpdated:function(){const e=P.Z.getState().browserColor;xre.setColor(e)},setColor:function(e){if(_re){if(Pre.css()!==e.css()){const[,,t]=e.hsl();t<.1&&(e=e.brighten(1));const n=[],i=Dr().bezier([Pre.toString(),e.toString()]);for(let e=1;e<11;e++){const[t,s,o]=i(e/10).rgb();n.push({red:t,green:s,blue:o})}d.Z.utilities.setRazerChromaColor(n,(e=>{e||console.warn("Error setting Razer Chroma color")})),Pre=e}}else Dre=e}},Ore=xre;class Lre{static init(){d.Z.autoUpdate.onDidAbortWithError.addListener(((e,t)=>{e&&console.warn(e,t),l.Z.dispatch({actionType:"VIVALDI_AUTOUPDATE_SET_STATUS",status:"onDidAbortWithError",message:t})})),d.Z.autoUpdate.onDidFindValidUpdate.addListener(((e,t)=>{l.Z.dispatch({actionType:"VIVALDI_AUTOUPDATE_SET_STATUS",status:"onDidFindValidUpdate",version:t,releaseNotesUrl:e})})),d.Z.autoUpdate.onWillDownloadUpdate.addListener((e=>{l.Z.dispatch({actionType:"VIVALDI_AUTOUPDATE_SET_STATUS",status:"onWillDownloadUpdate",version:e})})),d.Z.autoUpdate.onDidDownloadUpdate.addListener((e=>{l.Z.dispatch({actionType:"VIVALDI_AUTOUPDATE_SET_STATUS",status:"onDidDownloadUpdate",version:e})})),d.Z.autoUpdate.onWillInstallUpdateOnQuit.addListener((e=>{l.Z.dispatch({actionType:"VIVALDI_AUTOUPDATE_SET_STATUS",status:"onWillInstallUpdateOnQuit",version:e})})),d.Z.autoUpdate.onUpdaterDidRelaunchApplication.addListener((()=>{l.Z.dispatch({actionType:"VIVALDI_AUTOUPDATE_SET_STATUS",status:"onUpdaterDidRelaunchApplication"})}))}}var Rre;function Bre(e,t,n,i){Rre||(Rre="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Rre,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class Fre extends tn.Component{render(){const e=this.props.page;return Bre("div",{className:"inner"},void 0,Bre(J5,{id:e.id,url:e.url,target:e.target,vivExtData:e.vivExtData,showImageInspector:e.showImageInspector,discarded:e.discarded,isVisible:!0,contentWidth:0,contentHeight:0,isActive:this.props.active,supportsReaderMode:e.supportsReaderMode,qrCodeUrl:void 0,onDialogClosed:Tl.default,pinned:!1},`page-component-${e.id}`))}}const Ure=Fre;var Vre;function Wre(e,t,n,i){Vre||(Vre="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:Vre,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const Hre=[D.kAddressBarPosition];function zre(e){const t=W.Z.unsafeGetActivePage(e);return{page:t,url:t.url,id:t.id,active:z.ZP.isActive(e),favIconUrl:t.favIconUrl}}class Gre extends tn.PureComponent{static contextType=dn.Z;state=zre(this.context.vivaldiWindowId);componentDidMount(){pv.Z.addListener(this.onNavigationStoreChanged),W.Z.addListener(this.onPageStoreChanged),z.ZP.addListener(this.onWindowStoreChanged),this.updateTitle()}componentWillUnmount(){pv.Z.removeListener(this.onNavigationStoreChanged),W.Z.removeListener(this.onPageStoreChanged),z.ZP.removeListener(this.onWindowStoreChanged)}onWindowStoreChanged=()=>{this.setState({active:z.ZP.isActive(this.context.vivaldiWindowId)})};onPageStoreChanged=()=>{this.setState(zre(this.context.vivaldiWindowId),(()=>{this.updateTitle()}))};onNavigationStoreChanged=()=>{this.setState((e=>{const t=pv.Z.getNavigationInfo(e.id);if(t)return{url:t.webviewUrl}}))};updateTitle=()=>{const e=(0,St.d6)(this.state.page.url,this.state.page.title);this.context.document.title!==e&&(this.context.document.title=e)};render(){const e="top"===this.props.prefValues[D.kAddressBarPosition],t=e?"bottomLeft":"topLeft",n=e?"below":"above";return Wre("div",{id:"main"},void 0,Wre("div",{className:"mainbar"},void 0,Wre("div",{className:"toolbar toolbar-mainbar toolbar-large"},void 0,Wre(p4,{readonly:!0,url:this.state.url,id:this.state.id,active:this.state.active,favIconUrl:this.state.favIconUrl,popupPosition:n,menuOrigin:t}),Wre(Tg,{name:"Extensions",customizeMenu:[],size:"large",popupPosition:n,menuOrigin:t}))),0!==this.state.id&&Wre(Ure,{page:this.state.page,active:this.state.active}))}}var $re;function Kre(e,t,n,i){$re||($re="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:$re,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var jre=Kre((0,fs.Z)(Gre,Hre),{});class Yre extends tn.PureComponent{static contextType=dn.Z;render(){return jre}}const Xre=Yre;function Qre(e){0}var qre;function Jre(e,t,n,i){qre||(qre="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:qre,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class ele extends tn.PureComponent{static contextType=dn.Z;#F;#U;state={appElm:void 0,contentWindow:void 0,windowState:void 0,popupTabId:-1,windowStyle:lT.Z.getFallbackStyle(),windowClassNames:{}};windowClosed=e=>{const{contentWindow:t}=this.state;t&&e===t.vivaldiWindowId&&(this.props.closeWindowCallback&&this.props.closeWindowCallback(t),"popup"===this.props.windowType&&l.Z.dispatch({actionType:"POPUPWINDOW_CLOSED",componentId:this.props.componentIdentifier}),l.Z.dispatch({actionType:"WINDOW_CLOSED",windowId:e}),d.Z.utilities.broadcastMessage({windowRemoved:{windowId:e}}))};onAppWindowCreated=async e=>{const{windowId:t,contentWindow:n}=e;if(-1===t||!n)return void console.error("WindowPortal onAppWindowCreated failed for windowId:",t);const i=await y.Z.windows.get(t),s=await d.Z.runtimePrivate.isGuestSession(t);n.vivaldiWindowId=t,this.#F=Cae(n),this.#U=gre.Z.attachSpatnavListeners(t),"popup"===this.props.windowType&&d.Z.utilities.broadcastMessage({handlePopupWindow:{windowId:t,popupId:this.props.componentIdentifier}});const o={active:!0,state:"normal",restoreStateFullscreen:"normal",restoreStateHtml5Fullscreen:"normal",fullscreenMenubarShown:!1,html5FullScreen:!1,minimalUI:!1,nativeDecorations:M.Z.get(D.kWindowsUseNativeDecoration),type:this.props.windowType,visibleUI:z.ZP.getUIFromPrefs(),incognito:i.incognito&&!s,guest:s};n.onload=()=>{this.onContentWindowLoaded(t,n,o)},l.Z.dispatch({actionType:"THEME_WINDOW_CREATED",windowId:t}),l.Z.dispatch({actionType:"WINDOW_SET_STATE",windowState:o,windowId:t}),d.Z.utilities.broadcastMessage({windowAdded:{windowId:t,windowState:o}})};onContentWindowLoaded=(e,t,n)=>{const i=t.document,s=P.Z.getState().windowStyles.get(e)||lT.Z.getFallbackStyle(),o=P.Z.getState().windowClassNames.get(e)||{};if(!i.body)return void console.error(`Application document creation failed: ${e}`);const a=i.body.appendChild(i.createElement("div"));a.id="app",this.detachFocusableEvents=fae(i),this.setState({appElm:a,contentWindow:t,windowStyle:s,windowState:n,windowClassNames:o}),Qre()};onWindowWebContentsDidStartLoading=e=>{this.state.contentWindow&&this.context.vivaldiWindowId===e&&Ru.Z.close(this.state.contentWindow.vivaldiWindowId)};componentDidMount(){const e={bounds:this.props.windowBounds,focused:!0,incognito:this.props.incognito};try{d.Z.contextMenu.onDocumentMenu.addListener(this._onDocumentMenu),d.Z.windowPrivate.onWindowClosed.addListener(this.windowClosed),d.Z.windowPrivate.onWebContentsDidStartNavigation.addListener(this.onWindowWebContentsDidStartLoading),d.Z.tabsPrivate.onKeyboardShortcut.addListener(this._handleKeyboardShortcut),z.ZP.addListener(this._onWindowStoreChanged),P.Z.addListener(this._onThemeStoreChanged),Ru.Z.openWindow(z.Ex,"window.html",this.props.windowType,e).then(this.onAppWindowCreated)}catch(e){console.error(e)}}componentWillUnmount(){this.detachFocusableEvents(),z.ZP.removeListener(this._onWindowStoreChanged),d.Z.contextMenu.onDocumentMenu.removeListener(this._onDocumentMenu),P.Z.removeListener(this._onThemeStoreChanged),d.Z.windowPrivate.onWindowClosed.removeListener(this.windowClosed),d.Z.windowPrivate.onWebContentsDidStartNavigation.removeListener(this.onWindowWebContentsDidStartLoading),d.Z.tabsPrivate.onKeyboardShortcut.removeListener(this._handleKeyboardShortcut),this.state.contentWindow&&this.state.contentWindow.close(),Sae(this.context,this.#F),gre.Z.detachSpatnavListeners(this.#U)}_handleKeyboardShortcut=(e,t,n)=>{e===this.state.contentWindow?.vivaldiWindowId&&wd.Z.handleShortcut(e,t,n,this.state.contentWindow?.document?.activeElement)};_onDocumentMenu=(e,t,n)=>{e===this.state.contentWindow?.vivaldiWindowId&&ql.show(e,t,n)};_onThemeStoreChanged=()=>{if(!this.state.contentWindow)return;const e=this.state.contentWindow.vivaldiWindowId,t=P.Z.getState().windowStyles.get(e)||lT.Z.getFallbackStyle(),n=P.Z.getState().windowClassNames.get(e)||{};t===this.state.windowStyle&&n===this.state.windowClassNames||this.setState({windowStyle:t,windowClassNames:n})};_onWindowStoreChanged=()=>{if(!this.state.contentWindow)return;const e=this.state.contentWindow.vivaldiWindowId,t=z.ZP.getWindowState(e);this.state.windowState!==t&&this.setState({windowState:t})};render(){const{appElm:e,contentWindow:t,windowState:n,windowClassNames:i}=this.state;if(!(e&&t&&n&&i))return null;const s=Jre(dn.Z.Provider,{value:t},void 0,Jre("div",{id:"browser",style:this.state.windowStyle,className:this.props.getBrowserClasses(t.vivaldiWindowId,n,i)},void 0,Jre("div",{id:"header"},void 0,Jre(Poe,{isHidden:!1,tabPosition:"none",isPopupWindow:!0,keyAccess:this.props.keyAccess})),Jre("div",{id:"main"},void 0,Jre(id,{level:"title_bar"},void 0,this.props.children))));return Ur.createPortal(s,e)}}const tle=ele;var nle,ile=n(75256);function sle(e,t,n,i){nle||(nle="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:nle,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const ole=[D.kAddressBarPosition,D.kAppearanceHudEnabled,D.kBookmarksBarDisplay,D.kBookmarksBarPosition,D.kKeyboardTabToAll,D.kKeyboardTabToAllUsesSystemDefault,D.kMenuDisplay,D.kPanelsPosition,D.kPanelsAsOverlayEnabled,D.kRazerChromaHasShownPromotion,D.kStartupShowMediaAvailableInformation,D.kStartupShowFfmpegInformation,D.kStatusBarDisplay,D.kTabsAtEdge,D.kTabsBarPosition,D.kTabsCloseButtonLeft,D.kTabsStackingMode,D.kThemeUseAnimation,D.kWindowsLinuxAltControls],ale=yae.Z.call();var rle=sle(Xre,{});class lle extends tn.PureComponent{static contextType=dn.Z;constructor(e,t){super(e),this.state={popupWindows:[],notOwnedPopupWindows:[],settingsCategory:"general",showSettings:!1}}componentDidMount(){d.Z.utilities.onBroadcastMessage.addListener(this._onBroadcastMessage),this.addSessionWindows(),Cie.addListener(this._onPopupWindowStoreChanged)}componentWillUnmount(){d.Z.utilities.onBroadcastMessage.removeListener(this._onBroadcastMessage),Cie.removeListener(this._onPopupWindowStoreChanged)}addSessionWindows=()=>{y.Z.windows.getAll({populate:!0},(e=>{e.forEach(((e,t)=>{if(e.id){const t=e.id,n=(0,ile.Z)(e.vivExtData),i={active:e.focused,state:"locked-fullscreen"===e.state?"normal":e.state,restoreStateFullscreen:"maximized"===e.state?"maximized":"normal",restoreStateHtml5Fullscreen:"normal",fullscreenMenubarShown:!1,guest:!1,html5FullScreen:!1,incognito:e.incognito,minimalUI:n.minimalUI,nativeDecorations:M.Z.get(D.kWindowsUseNativeDecoration),type:"normal",visibleUI:z.ZP.getUIFromPrefs()};n.visibleUI&&z.ZP.isMinimalUI(t)&&(i.visibleUI=n.visibleUI),l.Z.dispatch({actionType:"WINDOW_SET_STATE",windowState:i,windowId:t})}}))}))};_onPopupWindowStoreChanged=()=>{const e=Cie.getState();this.setState((t=>({popupWindows:e.concat(t.notOwnedPopupWindows)})))};_onOtherPopupWindowStoreChanged=(e,t)=>{this.setState((n=>{let i=n.notOwnedPopupWindows;return i=i.filter((t=>t.ownerWindowId!==e)),{notOwnedPopupWindows:i.concat(t)}})),this._onPopupWindowStoreChanged()};_acceptPopup=(e,t)=>{const n=Cie.getState().find((t=>t.identifier===e));n&&n.acceptOrBlockCallback(t)};_onBroadcastMessage=e=>{if(e.open){if(e.open.winId===this.context.vivaldiWindowId){const{winId:t,urls:n,prompt:i}=e.open;if(z.ZP.getWindowState(t)){const e={inCurrent:!1,inBackground:M.Z.get(D.kTabsOpenNewInBackground),inNewWindow:!1,allowOverride:!1,incognito:!1};Jt.ZP.openUrls(t,n,e,i)}}}else if(e.minimizeAll)for(const[e]of z.ZP.getState())Ru.Z.minimize(e);else if(e.handlePopupWindow){const{popupId:t,windowId:n}=e.handlePopupWindow;this._acceptPopup(t,n)}else if(e.popupStoreChanged){const{windowId:t,popupWindows:n}=e.popupStoreChanged;this._onOtherPopupWindowStoreChanged(t,n)}else if(e.showSettingsWindow&&!y.Z.extension.inIncognitoContext)this.setState({showSettings:!0,settingsCategory:e.showSettingsWindow.settingsCategory},(()=>{for(const[e]of z.ZP.getState())if(z.ZP.isSettings(e)){y.Z.windows.update(e,{focused:!0});break}}));else if(e.windowActiveStateChanged){const{windowId:t,activated:n}=e.windowActiveStateChanged;l.Z.dispatch({actionType:"WINDOW_ACTIVATED",activated:n,windowId:t})}else if(e.windowAdded){const{windowId:t,windowState:n}=e.windowAdded;l.Z.dispatch({actionType:"WINDOW_SET_STATE",windowState:n,windowId:t})}else if(e.windowRemoved){const{windowId:t}=e.windowRemoved;l.Z.dispatch({actionType:"WINDOW_CLOSED",windowId:t})}};closeSettingsWindow=e=>{this.setState({showSettings:!1}),0===e.outerWidth&&0===e.outerHeight&&0===e.screenLeft&&0===e.screenTop||(nt.Z.set(D.kSettingsSizeWidth,e.outerWidth),nt.Z.set(D.kSettingsSizeHeight,e.outerHeight),nt.Z.set(D.kSettingsSizeLeft,e.screenLeft),nt.Z.set(D.kSettingsSizeTop,e.screenTop))};getBrowserClasses=(e,t,n)=>{const i=this.props.prefValues[D.kTabsBarPosition],s=(0,z.WV)(t),o="settings"===t.type,a="normal"===t.type,r="popup"===t.type,l="substrip"===this.props.prefValues[D.kTabsStackingMode],d="accordion"===this.props.prefValues[D.kTabsStackingMode];return mn()(ale,s,{...n,win10:navigator.appVersion.indexOf("Windows NT 10")>0,"minimal-ui":z.ZP.isMinimalUI(e),hasfocus:t.active,isblurred:!t.active,native:t.nativeDecorations,"mac-fullscreen-hover":t.fullscreenMenubarShown&&t.active,popup:r,"is-settingspage":o,"horizontal-menu":!1,"tabs-at-edge":this.props.prefValues[D.kTabsAtEdge]&&("bottom"===i||"top"===i)&&("maximized"===t.state||"fullscreen"===t.state),"animation-off":!this.props.prefValues[D.kThemeUseAnimation],alt:this.props.prefValues[D.kWindowsLinuxAltControls]&&!1,"alt-tabs":this.props.prefValues[D.kTabsCloseButtonLeft],"substrip-tabs-on":l,"accordion-tabs-on":d,"full-key-access":0===this.props.prefValues[D.kKeyboardTabToAll],"break-mode":!1,["stacks-"+this.props.prefValues[D.kTabsStackingMode]]:!0,["address-"+this.props.prefValues[D.kAddressBarPosition]+(t.visibleUI.addressBar?"":"-off")]:!0,["bookmark-bar-"+(t.visibleUI.bookmarksBar?this.props.prefValues[D.kBookmarksBarPosition]:"off")]:!0,["tabs-"+(t.visibleUI.tabs&&a?i:"off")]:!0,"is-dragging-button":!1,"no-app-dragging":!1,"active-pane-selection":!1})};getSettingsWindowBounds=()=>{const{screen:e}=this.context,t=M.Z.get(D.kSettingsSizeWidth),n=M.Z.get(D.kSettingsSizeHeight),i=M.Z.get(D.kSettingsSizeLeft),s=M.Z.get(D.kSettingsSizeTop),o=n<=e.height?n:e.height;let a=i>=0?i:e.availLeft+t/2,r=s>=0?s:e.availTop+(e.height-n)/2;r<0&&(r=0);a+t>e.availLeft+e.width&&(a=e.availLeft+(e.width-t),a<0&&(a=0));return{left:Math.round(a),top:Math.round(r),width:Math.round(t),height:Math.round(o)}};renderPopups=()=>this.state.popupWindows.filter((e=>!y.Z.extension.inIncognitoContext&&!e.incognito||y.Z.extension.inIncognitoContext&&e.incognito)).map((e=>sle(tle,{getBrowserClasses:this.getBrowserClasses,windowBounds:e.windowBounds,keyAccess:this.props.prefValues[D.kKeyboardTabToAll],windowType:"popup",componentIdentifier:e.identifier,incognito:e.incognito},e.identifier,rle)));render(){const{settingsCategory:e}=this.state;return(0,fn.jsx)(fn.Fragment,{children:sle("div",{lang:y.Z.i18n.getUILanguage()},void 0,this.state.showSettings&&sle(tle,{closeWindowCallback:this.closeSettingsWindow,getBrowserClasses:this.getBrowserClasses,windowBounds:this.getSettingsWindowBounds(),keyAccess:this.props.prefValues[D.kKeyboardTabToAll],windowType:"settings",componentIdentifier:"settingswindow",incognito:!1},void 0,sle("div",{className:"webpageview"},void 0,sle(ij,{url:XK+e}))),this.renderPopups())})}}const dle=(0,fs.Z)(lle,ole);var cle=n(11795),hle=n.n(cle);const ple=function(){if("function"==typeof d.Z.bookmarksPrivate.updateSpeedDialsForWindowsJumplist){var e=en.ZP.getSpeeddialFolders();if(e&&0!==e.length&&e[0].children){var t=e[0].children.filter((e=>e.url)).map((e=>({title:e.title,url:e.url})));d.Z.bookmarksPrivate.updateSpeedDialsForWindowsJumplist(t)}}};const ule={start:function(){"function"==typeof d.Z.bookmarksPrivate.updateSpeedDialsForWindowsJumplist&&(ple(),en.ZP.addListener(ple))},stop:function(){"function"==typeof d.Z.bookmarksPrivate.updateSpeedDialsForWindowsJumplist&&en.ZP.removeListener(ple)}};var gle;n(34155);function mle(e,t,n,i){gle||(gle="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:gle,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function vle(e,t){return e.displayName=t,hle().log(e)()}function fle(e,t){const n=Date.now(),i=e(),s=Date.now();return console.log(`Non-promise from ${t||"[anonymous]"} with time ${s-n} ms`),i}const yle=document.getElementById("portals"),wle=document.getElementById("app"),ble=!1;console.time("JS init startup"),(0,E.MD)();var Cle=mle(Zre,{}),Sle=mle(dle,{});async function Tle(){const e=await d.Z.utilities.getSystemDateFormat();if(e.longDateFormat&&b().defineLocale(F.ZP.fixMomentLocale(y.Z.i18n.getUILanguage())+"-viv",F.ZP.getLocale(e)),wle)return new Promise((e=>Ur.render(Cle,wle,e)));if(yle)return new Promise((e=>Ur.render(Sle,yle,e)));throw"No root element."}const Ile=()=>{ble};m.Z.initFastForward();try{if(wle)Qre(),async function(e){await vle(M.Z.loadPromise,"PrefsCache"),fle(de.a,"Initialize logger"),await vle(Ru.Z.loadPromise,"WindowActions"),await vle(f.Z.loadPromise,"vivaldiSettings"),await vle(ik.Z.loadPromise,"VivaldiFeatureFlags"),await Promise.all([vle((()=>u.loadPromise().then((()=>vle(a.Z.loadPromise,"CommandActions")))),"ContentScriptActions"),vle(Sl.Z.loadPromise,"ThemeActions"),vle(s.Z.loadPromise,"BreakModeActions"),vle(Ho.Z.loadPromise,"PanelActions"),vle(Nn.Z.load,"SearchEngineCache"),vle(Y.Z.attachPageEventsPromise,"PageActions eventlisteners"),vle(Y.Z.loadPromise,"PageActions")]),await Tle(),Ile(),await Promise.all([vle(BW.loadPromise,"VivaldiAccountActions"),vle(bH.loadPromise,"SyncActions"),vle(i.Z.loadPromise,"BookmarkActions"),vle(Fs.Z.loadPromise,"NoteActions"),vle(j7.Z.loadPromise,"TrashActions"),vle(B.loadPromise,"HueActions"),vle(A.loadPromise,"HistoryActions"),o.Z.init(),vle((()=>Xt.start(e.vivaldiWindowId)),"Mail")&&void 0]),await Promise.all([fle(If.Z.load,"SearchFieldActions"),fle(Of.Z.migrateTypedHistory,"UrlbarActions"),fle(Rl.Z.init,"TranslationStateActions"),fle(Ol.Z.init,"ReadingListActions"),vle(Ere.Z.load,"PeriodicReloadActions")]),fle(V5.initBrowserWindow,"RssDetectActions"),fle(g.Z.load,"DownloadActions"),fle(ule.start,"updateJumplist"),fle(Lre.init,"UpdateActions"),E6.Z.init(e.vivaldiWindowId),Ore.init(),console.timeEnd("JS init startup")}(window);else{if(!yle)throw"No root element.";!async function(){if(await vle(M.Z.loadPromise,"PrefsCache"),(0,de.a)(),await vle(f.Z.loadPromise,"vivaldiSettings"),await vle(ik.Z.loadPromise,"VivaldiFeatureFlags"),await Promise.all([vle((()=>u.loadPromise().then((()=>vle(a.Z.loadPromise,"CommandActions")))),"ContentScriptActions"),vle(i.Z.loadPromise,"BookmarkActions"),vle(bH.loadPromise,"SyncActions"),vle(Nn.Z.load,"SearchEngineCache")]),!y.Z.extension.inIncognitoContext){await vle(BW.loadPromise,"VivaldiAccountActions");const e=new SharedWorker("bundle-mailreader-worker.js");e.onerror=console.error,navigator.serviceWorker?.ready.then((t=>{t.active?.postMessage({setupMailreaderOnBackground:!0},[e.port]),it.Z.initFilters(),zR.Z.initMailingLists()})),o.Z.init(),V5.initPortalDocument()}await Promise.all([vle(Sl.Z.loadPromise,"ThemeActions"),vle(Y.Z.attachPageEventsPromise,"PageActions eventlisteners")]),await Tle(),console.timeEnd("JS init startup")}()}}catch(e){console.log("Startup Process Failure: "+e),Ile()}},27770:(e,t,n)=>{"use strict";n.d(t,{yR:()=>f,TR:()=>y,ZP:()=>b});var i=n(59486),s=n(46382),o=n(53576),a=n(29087),r=n(63153),l=n(92292),d=n(98974),c=n(45454),h=n(7064),p=n(30460),u=n(36436),g=n(44850),m=n(89175),v=n(1407);const f="vivaldi/x-bookmarks";function y(e){return!(0,g.$0)(e)}const w={openUrls:function(e,t,n,i){const s=t.map((e=>({...this.getEmptyNode(),url:e})));this.open(e,s,n,i)},open:function(e,t,n,o){if(o&&a.Z.get(m.kBookmarksConfirmOpening)&&t.length>=a.Z.get(m.kBookmarksConfirmOpeningThreshold))s.Z.showConfirmOpenLinksDialog(e,{urls:t.map((({url:e})=>e)).filter(Boolean),openOptions:{inCurrent:n.inCurrent,inNewWindow:n.inNewWindow,inBackground:n.inBackground,incognito:n.incognito,allowOverride:!1}});else{let s=!1===n.inCurrent;const o=!0===n.inNewWindow;let l=!0===n.inBackground;const d=!0===n.incognito;if(!1===s&&!1===o&&!1===l&&!0===n.allowOverride&&(!0===a.Z.get(m.kBookmarksOpenInNewTab)&&(s=!0,!0===a.Z.get(m.kTabsOpenNewInBackground)&&(l=!0)),1===t.length&&(t[0].url||"").startsWith("javascript:")&&(s=!1)),!0===o){0;const n=t.map((e=>e.url)).filter(Boolean).filter((e=>i.ZP.filterUrl(e).length>0));r.Z.openBrowserWindow(e,n,{incognito:d,transition:h.Z.historyPrivate.TransitionType.AUTO_BOOKMARK})}else{const n=t.filter((e=>e.url&&i.ZP.filterUrl(e.url).length>0)),o=n.length>0?n[n.length-1]:void 0;n.forEach(((t,n)=>{!0===s?!0===l?this.openInNewTab(e,t,!0):this.openInNewTab(e,t,t!==o):(this.openInCurrentTab(e,t),s=!0)}))}}},openInNewTab:function(e,t,n){o.Z.openURL(e,t.url,{bookmarkId:t.id,inCurrent:!1,inBackground:n,transition:h.Z.historyPrivate.TransitionType.AUTO_BOOKMARK})},openInCurrentTab:function(e,t){o.Z.openURL(e,t.url,{bookmarkId:t.id,inCurrent:!0,transition:h.Z.historyPrivate.TransitionType.AUTO_BOOKMARK})},getBookmarksByNode:function(e){let t=[];return e.children?t=t.concat(e.children.filter((e=>i.ZP.isBookmark(e)))):i.ZP.isBookmark(e)&&t.push(e),t},getUrlsByNodes:function(e){return e.map((e=>w.getBookmarksByNode(e))).flat().map((e=>e.url)).filter(Boolean).filter((e=>i.ZP.filterUrl(e).length>0))},getOpenOptionsFromDisposition:function(e,t,n,i){const s={inCurrent:!1,inBackground:!1,inNewWindow:!1,allowOverride:!1,incognito:!1};switch(t){case"setting":return(0,c.Z)(e,i);case"current":return{...s,inCurrent:!0};case"new-tab":return{...s,inBackground:n||a.Z.get(m.kTabsOpenNewInBackground)};case"new-window":return{...s,inNewWindow:!0};case"new-private-window":return{...s,inNewWindow:!0,incognito:!0};default:return s}},isCopyModifierPressed:function(e){return e.ctrlKey},makeEventFlagsFromApiResponse:function(e){const t={};return e.left?t.button=0:e.right?t.button=2:e.center&&(t.button=1),e.ctrl&&(t.ctrlKey=!0),e.alt&&(t.altKey=!0),e.shift&&(t.shiftKey=!0),e.command&&(t.metaKey=!0),t},verifyForUpdate(e,t){const n={...e};if(n.url&&(n.url=n.url.trim()),n.title&&(n.title=n.title.trim()),n.nickname&&(n.nickname=n.nickname.trim()),n.description&&(n.description=n.description.trim()),t)n.url="";else{let e=n.url||p.p;const{schemeParsed:t}=h.Z.utilities.isUrlValid(e);""===t&&(e=(0,u.q9)(e)),n.url=e}return n},verifyForCreate(e,t){const n={...e};if(n.url&&(n.url=n.url.trim()),n.title&&(n.title=n.title.trim()),n.nickname&&(n.nickname=n.nickname.trim()),n.description&&(n.description=n.description.trim()),t)n.url="";else{let e=n.url||p.p;const{schemeParsed:t}=h.Z.utilities.isUrlValid(e);""===t&&(e=(0,u.q9)(e)),n.url=e}return n},convertToPrivateType(e){const t={id:e.id,title:e.title,nickname:e.nickname,description:e.description,thumbnail:e.thumbnail,partner:e.partner,speeddial:e.speeddial,bookmarkbar:e.bookmarkbar,trash:e.trash};return e.parentId&&(t.parentId=e.parentId),e.index&&(t.index=e.index),e.url&&(t.url=e.url),e.dateAdded&&(t.dateAdded=e.dateAdded),e.dateGroupModified&&(t.dateGroupModified=e.dateGroupModified),e.children&&(t.children=[]),t},getEmptyNode:()=>({id:"",title:"",nickname:"",description:"",thumbnail:"",partner:"",speeddial:!1,bookmarkbar:!1,trash:!1}),extractTitleFromEvent:function(e){const{dataTransfer:t}=e.nativeEvent;if(t){var n=t.getData("vivaldi/x-title");if(""===n){const e=t.getData("text/html");if(""!==e){var i=document.createElement("div");i.innerHTML=e;const t=i.getElementsByTagName("a");if(t&&t[0]){const e=t[0].textContent;""!==e&&(n=e)}}}return n}},getUrlsFromEventPromise:(e,t)=>new Promise(((n,i)=>{const s=e.dataTransfer.getData(v.Up),o=e.dataTransfer.getData("text/uri-list");if(s){const e=JSON.parse(s).ids.map((e=>parseInt(e))).sort(((e,t)=>e-t));l.Z.tabs.query({},(t=>n(t.filter((t=>e.some((e=>t.id===e)))).filter((({url:e})=>!(0,g.pM)(e))).map((({title:e,url:t},n)=>({title:e||(0,d.ZP)(t),url:t}))))))}else{if(o.length>0){const t=w.extractTitleFromEvent(e);return n(o.split("\n").map(((e,n)=>({url:e,title:0===n&&""!==t?t:(0,d.ZP)(e)}))))}if(!0!==t)return i();{let t=e.dataTransfer.getData("text/plain");if(t.length>0){if((0,u.K2)(t))return n([{url:t,title:(0,d.ZP)(t)}]);if(t=t.trim(),t.length>0&&!/\s/.test(t)){const e=t.indexOf(".");if(e>0&&e<t.length-1&&(t=(0,u.q9)(t),(0,u.K2)(t)))return n([{url:t,title:(0,d.ZP)(t)}])}return i()}}}})),isBookmarkable:y},b=w},30460:(e,t,n)=>{"use strict";n.d(t,{p:()=>i});const i="http://bookmark.placeholder.url/"},34929:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var i=n(15800),s=n(68247),o=n(29087),a=n(45660),r=n(7064),l=n(92395),d=n(89175);const c={},h={getAuthentication:async(e,t)=>{const{url:n,username:i,account_type:s}=e;if(!i||!n)throw new Error("Username or URL missing");if("google"===s){const t=await h._getOAuthAccessToken(i,"google");return{...e,oauth2Token:t,username:i,password:""}}if("string"==typeof t)return{...e,password:t,oauth2Token:""};{const t=await h._getVivaldiPassword(i,n||"");return{...e,username:"vivaldi"===s?t.username.toLowerCase():t.username,password:t.password,oauth2Token:""}}},_getVivaldiPassword:async(e,t)=>{const{password:n}=await i.Z.getPassword(t,e);return{username:e,password:n,oauth2Token:""}},clearAccessAndRefreshTokens:async e=>{const t={...o.Z.get(d.kCalendarRefreshTokens)};delete t[e],s.Z.set(d.kCalendarRefreshTokens,t),delete c[e]},_getOAuthAccessToken:async(e,t)=>{const n=o.Z.get(d.kCalendarRefreshTokens)||{},i=c[e];if(i&&i.expiryTime>Date.now())return i.access_token;if(n[e]){const i=await r.Z.utilities.osDecrypt(n[e]),{access_token:s,expires_in:o,invalid_grant:a}=await(0,l.jb)(i,t);if(a)return h.resetRefreshTokenAndFetchNew(e);{const t=Date.now()+1e3*parseInt(o);return c[e]={access_token:s,expiryTime:t},s}}return h.fetchAccessTokenAndRefreshToken(e)},resetRefreshTokenAndFetchNew:async e=>{const t={...o.Z.get(d.kCalendarRefreshTokens)};return delete t[e],s.Z.set(d.kCalendarRefreshTokens,t),h.fetchAccessTokenAndRefreshToken(e)},fetchAccessTokenAndRefreshToken:async e=>{const t={...o.Z.get(d.kCalendarRefreshTokens)},n=await(0,l.Xf)(e),{access_token:i,refresh_token:h,expires_in:p}=n,u=Date.now()+1e3*parseInt(p);if(c[e]={access_token:i,expiryTime:u},h)try{t[e]=await r.Z.utilities.osCrypt(h),s.Z.set(d.kCalendarRefreshTokens,t)}catch(e){a.Z.error("Calendar",["oauth"],"Error crypting refresh_token",e)}return i}},p=h},24522:(e,t,n)=>{"use strict";n.d(t,{O5:()=>o,A:()=>a,FI:()=>r,GL:()=>l,L9:()=>d,ad:()=>c,$T:()=>h,LB:()=>p,d3:()=>u,lb:()=>g,lq:()=>m,QI:()=>v,hd:()=>f,S:()=>y,jC:()=>w,hx:()=>b,fL:()=>C,fP:()=>S,II:()=>T,A2:()=>I,Mf:()=>k,Qg:()=>A,xu:()=>Z});var i=n(56371),s=n(86088);const o="YYYYMMDD",a="YYYYMMDDTHHmmss",r="YYYYMMDDTHHmmss[Z]",l="YYYYMMDDZ",d="YYYYMMDDTHHmmssZ",c="X-VIVALDI-CURRENT",h="X-VIVALDI-FLOATING",p={UNKNOWN:0,VERIFYING:1,OK:2,ERROR:3},u={local:(0,i.Z)("data storage","Local"),google:(0,i.Z)("Google Calendar"),vivaldi:(0,i.Z)("Vivaldi.net"),caldav:(0,i.Z)("CalDAV"),ical:(0,i.Z)("Web Calendar")},g=6e4,m=9e5,v=36e5,f=24*v,y=7*f,w=600,b=[{value:"#e73359",name:(0,i.Z)("calendar","Red")},{value:"#ee8835",name:(0,i.Z)("calendar","Orange")},{value:"#696969",name:(0,i.Z)("calendar","Gray")},{value:"#14a434",name:(0,i.Z)("calendar","Green")},{value:"#4facf2",name:(0,i.Z)("calendar","Blue")},{value:"#b260d3",name:(0,i.Z)("calendar","Purple")},{value:"#8b7251",name:(0,i.Z)("calendar","Brown")}],C=(s.z8c.small,s.nyn.small,s.NxY.small,s.YvR.small,()=>"https://tasks.googleapis.com"),S=()=>"https://www.googleapis.com/calendar",T=e=>`https://${e}/.well-known/caldav`,I=e=>`https://apidata.googleusercontent.com/caldav/v2/${e.trim()}`,k=e=>`https://calendar.vivaldi.net/calendars/${e.trim().toLowerCase()}`,A="X-VIVALDI-EVENT-REMINDER",Z="-10"},87265:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(8575),s=n(45660);const o={constructUrl:e=>e.filter(Boolean).map((e=>("/"===e.charAt(0)&&(e=e.substring(1)),e.endsWith("/")&&(e=e.substring(0,e.length-1)),e))).join("/"),concatUrl(e,t){const n=i.parse(e);if(!n)return"";const{protocol:s,host:o}=n;return(s||"")+"//"+(o||"")+t},stripDoubleQuotes:e=>e?e.split('"').join(""):e,parseHttpStatusCode(e){try{return parseInt(e.split(" ")[1],10)}catch(e){s.Z.error("Calendar",["network"],"Error parsing http status",e)}return-1},httpStatusSuccess(e){const t=o.parseHttpStatusCode(e);return t>=200&&t<300},basicHttpAuthenticationHeader:(e,t)=>`Basic ${btoa(unescape(encodeURIComponent(`${e}:${t}`)))}`,getCalDAVUrl(e,t){const n=i.parse(e);let s="";const{protocol:a,host:r}=n;return a&&r&&t&&(s=`${a}//${o.constructUrl([r,t])}`),s}},a=o},1712:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var i=n(61757),s=n(55351),o=n(29194),a=n(15800),r=n(56371),l=n(24522);const{deletePassword:d}=a.Z,c={getCalendarCreateParams:()=>({name:"",description:(0,r.Z)("New Calendar"),accountId:o.Z.getDefaultAccountId(),color:c.getCalendarCreateColor(),timezone:"",active:!1}),getAccountCreateParams:()=>({name:(0,r.Z)("Local Calendars"),url:"",account_type:"local",username:""}),createLocalAccountAndCalendar:async(e,t)=>{t={...c.getCalendarCreateParams(),...t};const n=c.getLocalAccount();if(n){return await i.Z.createCalendar({...t,accountId:n.id})}{e={...c.getAccountCreateParams(),...e};const n=await i.Z.createAccount(e);return{...await i.Z.createCalendar({...t,accountId:n.id,description:e.name}),account:n}}},getLocalAccount:()=>o.Z.getAccounts().find((e=>"local"===e.account_type)),getCalendarCreateColor:()=>{const e=l.hx.map((e=>e.value.toLocaleLowerCase().replace("#",""))),t=[];o.Z.getCalendars().forEach((n=>{const i=n.color?.toLowerCase().replace("#","")||"";e.includes(i)&&t.push(i)}));let n=e.filter((e=>!t.includes(e)));return n.length||(n=e),`#${n[Math.floor(Math.random()*n.length)]}`},startDeletingAccount:async e=>{const t=o.Z.getAccounts().find((t=>t.id=e));if(!t)return;const{username:n,url:a}=t;i.Z.stopListeners();try{await i.Z.deleteAccount(e),d(n,a)}finally{i.Z.startListeners(),s.Z.doneDeleteAccount(e)}}},h=c},15800:(e,t,n)=>{"use strict";n.d(t,{Z:()=>P});var i=n(29194),s=n(65792),o=n.n(s),a=n(45502),r=n(46382),l=n(80008),d=n.n(l),c=n(63353),h=n(29087),p=n(2699),u=n(19486),g=n(56371),m=n(92292),v=n(45660),f=n(5264),y=n.n(f),w=n(7064),b=n(23542),C=n(24522),S=n(82191),T=n(74400),I=n(58821),k=n(65741),A=n(89175);const Z=(0,b.extendMoment)(d()),E=y()(100)((function(e){let t=o()(e);t.get("lab.l")<12.5?t=t.set("lab.l",12.5):t.get("lab.l")>77.5&&(t=t.set("lab.l",77.5));const n=t.set("lab.l",t.get("lab.l")<70?"+70":"-70");return{"--colorCalendarBg":t.css(),"--colorCalendarBgAlpha":t.alpha(.3).css(),"--colorCalendarFg":n.css()}}));function _(e){return`${e<=0?"+":"-"}${Math.abs(Math.floor(e/60)).toString().padStart(2,"0")}${(e%60).toString().padStart(2,"0")}`}function N(e,t,n){const i=Z.tz.zone(e);if(!i)return"";const s=`BEGIN:VTIMEZONE\r\nTZID:${e}`;let o="";const{untils:a=[],offsets:r=[],abbrs:l=[]}=i;if(1===a.length)o+=`BEGIN:STANDARD\nDTSTART:19700101T000000\nTZOFFSETFROM:${_(r[0])}\nTZOFFSETTO:${_(r[0])}\nTZNAME:${l[0]}\nEND:STANDARD\r\n`;else{let i=a.findIndex((e=>e>t));i=Math.max(i,1);do{const t=i%2==0?"STANDARD":"DAYLIGHT";o+=`BEGIN:${t}\nDTSTART:${Z.tz(a[i-1],e).format("YYYYMMDDTHHmmss")}\nTZOFFSETFROM:${_(r[i-1])}\nTZOFFSETTO:${_(r[i])}\nTZNAME:${l[i]}\nEND:${t}\r\n`,i++}while(i<a.length-1&&a[i]<n)}return`${s}\r\n${o}END:VTIMEZONE\r\n`}const M={validColor:function(e){return(e??"").match(/^#?([0-9a-f]{6})([0-9a-f]{2})?$/i)?.[1]??!1},getCalendarColor:e=>{const t=M.validColor(e?.color);return t?`#${t}`:u.Z.getThemeWithFallback(p.Z.getCurrentId()).colorHighlightBg},getCalendarColorStyles:e=>E(M.getCalendarColor(e)),getEventColors:e=>{const t=i.Z.getCalendars().find((t=>t.id===e));return M.getCalendarColorStyles(t)},getEventSquircle:()=>'<svg\n      viewBox="0 0 8 8"\n      xmlns="http://www.w3.org/2000/svg"\n    >\n      <rect width="8" height="8" rx="3" />\n    </svg>',createCalendarIcon:(e,t,n=!1)=>{const i=M.getCalendarColor(e);let s="";if(n){s=`<path d="M 8 17 l 7 7 l 11 -11 l -3 -3 l -8 8 l -4 -4  z" fill="#${o()(i).luminance()>.9?"000":"FFF"}" />`}return`<svg viewBox="0 0 32 32">\n      <circle cx="16" cy="16" r="${t}" fill="${i}" />\n      ${s}\n    </svg>`},createCalendarIconPNG:e=>{const t=M.getCalendarColor(e),n=document.createElement("canvas");n.width=32,n.height=32;const i=n.getContext("2d");return i.beginPath(),i.arc(16,16,Math.floor(32/3),0,2*Math.PI,!1),i.fillStyle=t,i.fill(),n.toDataURL("image/png").replace("data:image/png;base64,","")},createEventNotificationString:(e,t,n,i)=>{const s=n?`:${n}`:"",o=t.split(":")[0];return`${`${C.Qg}${i?"_SNOOZE":""}`}=${e}:${o}${s}`},parseEventNotificationString:e=>{let t={notificationId:""};if(!e.startsWith(C.Qg))return t;const n=e.split("=")[1];if(n){const[i,s,o]=n.split(":");t={notificationId:i,eventId:s,recurringStart:o?parseInt(o):void 0,snooze:-1!==e.indexOf("_SNOOZE")}}return t},shouldSaveEvent:(e,t)=>{const n=!e.id,i=["id","uid","calendarId","start","end","allDay"],s=Object.entries(e).every((([t,n])=>!n||i.includes(t)||"notifications"===t&&function(e){return 1===e.notifications?.length&&(!e.allDay&&h.Z.get(A.kCalendarDefaultNotification)*C.lb===e.notifications?.[0].when||!!e.allDay&&h.Z.get(A.kCalendarDefaultAlldayNotification)&&h.Z.get(A.kCalendarDefaultAlldayNotificationTime)===e.notifications?.[0].when)}(e)||Array.isArray(n)&&0===n.length));if(n)return s?"DELETE":"SAVE";{const{notifications:n,...i}=e,{notifications:o,...a}=t||{},r=(0,k.default)(i,a),l=(0,k.default)(n,o);return r&&l?"IGNORE":r?"SAVE_INVITED":s?"DELETE":"SAVE"}},isOwnEvent(e){if("ical"===i.Z.getAccountForCalendar(e.calendarId)?.account_type)return!1;if(!e.organizer)return!0;return h.Z.get(A.kMailAccounts).some((t=>t.MAIL_EMAIL===e.organizer))},shouldIncrementSequence:(e,t=[])=>{const n=e=>[e.address,e.partstat],i=t.find((t=>t.id===e.id));if(!i)return!1;const s=(i.invites||[]).map(n),o=(e.invites||[]).map(n);return i.start!==e.start||i.end!==e.end||i.allDay!==e.allDay||!(0,k.default)(i.rrule,e.rrule)||!(0,k.default)(s,o)||!(0,k.default)(i.recurrenceExceptions||[],e.recurrenceExceptions||[])},getDisplayRange:(e,t)=>{let n,i;switch(t){case"agenda":n=Z(e).startOf("day"),i=Z(e).add(1,"month").endOf("day");break;case"month":n=Z(e).startOf("month").weekday(0),i=Z(e).endOf("month").weekday(6);break;case"multiweek":n=Z(e).subtract(1,"week").startOf("week"),i=Z(e).add(1,"week").endOf("week");break;default:n=e.clone().startOf(t),i=e.clone().endOf(t)}return Z.range(n,i)},getEventRange:e=>{const t=e.task?e.start||e.end:e.start,n=e.end||e.start;if(t&&n)return Z.range(t,n)},isMultiDayEvent:e=>{if(e.allDay)return!0;if(e.task&&e.end&&!e.start)return!1;const t=Z(e.start),n=Z(e.end);return!t.isSame(e.end,"day")&&!(n.diff(t,"day",!0)<1&&n.isSame(n.clone().startOf("day")))},isRecurringEvent:e=>Boolean(e.recurrence&&e.recurrence instanceof S.Ci),isGeneratedRecurringEvent:e=>-1!==("string"==typeof e?e:e.id).indexOf(":"),getGeneratedSourceEvent:e=>{const[t]=e.id.split("-")[0].split(":"),n=i.Z.getEvents().find((e=>e.id===t));if(!n)throw new Error(`Source event not found for recurring event id: ${e.id}`);return n},getBaseEventIfException:e=>{const[t]=e.id.split("-")[0].split(":"),n=i.Z.getEvent(t);if(n?.recurrenceExceptions?.length&&!e.recurrenceExceptions?.length)return n},generateKey:(e,t)=>{const{calendarId:n,id:i,uid:s,sequence:o}=e;return`${n}-${i}-${s??""}-${o??""}-${t??""}`},eventSearchPredicate:(e,t)=>["title","description","location","url","invites","organizer"].some((n=>(Array.isArray(e[n])?function(t){return"invites"===t&&e.invites?e.invites.map((e=>e.address)).join(""):""}(n):e[n]||"").toLowerCase().indexOf(t.toLowerCase())>=0&&!e.trash)),searchEvents:(e,t)=>e.filter((e=>M.eventSearchPredicate(e,t))).sort(((e,t)=>t.start-e.start)),filterEventsByPeriod:(e,t,n,i=1)=>{const s=t.clone();let o,a;"allday"===n?(o=s.startOf("day").valueOf(),a=s.add(i-1,"day").endOf("day").valueOf()):(o=s.startOf(n).valueOf(),a=s.add(i-1,n).endOf(n).valueOf());const r=t.dayOfYear(),l=e.filter((e=>e.id.indexOf("-")>0)).map((e=>e.id.split("-"))).filter((([e,t])=>parseInt(t)<=r)).reduce(((e,[t,n])=>(e[t]=Math.max(e[t]||0,parseInt(n)),e)),{}),d=e.filter((e=>{if(e.task){let t=e.end;return t||(t=e.start),e.start&&t?e.start<=a&&t>o||e.start===t&&e.start>=o&&e.start<a:!!t&&(t>=o&&t<=a)}return e.start<a&&(e.end||e.start)>o||e.start<a&&e.start>=o})).filter((e=>{const[t,n]=e.id.split("-");return n?l[t]===parseInt(n):!(t in l)}));return"hour"===n?d.filter((e=>!M.isMultiDayEvent(e))):"allday"===n?d.filter((e=>M.isMultiDayEvent(e))):d},foldIcal:function(e){return e.split(/\r?\n/).map((e=>{if(e.length<=75)return e;let t="",n=0;for(;n<e.length;)n+75>=e.length?t+=e.substr(n):t+=e.substr(n,73)+"\r\n ",n+=73;return t})).join("\r\n")},eventsToICalendar:function(e,t={}){const{method:n,includeRecurrenceId:i=!0}=t,s=Z.tz().format(C.FI),o=["BEGIN:VCALENDAR","PRODID:-Vivaldi Calendar V1.0//EN","VERSION:2.0","CALSCALE:GREGORIAN","DTSTAMP:"+s];n&&o.push(`METHOD:${n}`),o.push("");let a=o.join("\r\n");const r=(0,I.EP)()||"utc",l=e.reduce(((e,t)=>{if(!t.allDay&&(t.recurrence||t.timezone)){const n=t.timezone||r,i=t.start||1/0;let s=t.end||-1/0;t.recurrence&&(s=t.recurrence.options.until?t.recurrence.options.until.valueOf():t.recurrence.options.count?t.recurrence.all().pop().valueOf():1/0),e[n]?e[n]={firstOccurrence:Math.min(i,e[n].firstOccurrence),lastOccurrence:Math.max(s,e[n].lastOccurrence)}:e[n]={firstOccurrence:i,lastOccurrence:s}}return e}),{});for(const e in l)e!==C.$T&&"utc"!==e.toLowerCase()&&(a+=N(e,l[e].firstOccurrence,l[e].lastOccurrence));return e.map((e=>{let t=[];e.organizer&&(t=[`ORGANIZER:mailto:${e.organizer}`]),e.invites&&e.invites.length&&(t=t.concat(e.invites.map((e=>`ATTENDEE;RSVP=TRUE${e.partstat?`;PARTSTAT=${e.partstat}`:""}:mailto:${e.address}`))));const{uid:n,recurrenceId:o}=e,a=Boolean(o&&i);let r="",l="",d="",c="",h="";e.allDay?(c=";VALUE=DATE",r=`${Z(e.start).format(C.O5)}`,l=e.end&&Z(e.end).format(C.O5),e.task&&(h=Z().format(C.O5)),d=a&&Z(o).format(C.O5)):e.timezone===C.$T?(r=e.start&&Z(e.start).format(C.A),l=e.end&&Z(e.end).format(C.A),e.task&&(h=Z().format(C.A)),d=a&&Z(o).format(C.A)):e.timezone&&"utc"!==e.timezone.toLowerCase()?(c=`;TZID=${e.timezone}`,r=e.start&&Z.tz(e.start,e.timezone).format(C.A),l=e.end&&Z.tz(e.end,e.timezone).format(C.A),e.task&&(h=Z.tz(Z(),e.timezone).format(C.A)),d=a&&Z.tz(o,e.timezone).format(C.A)):(r=e.start&&Z.tz(e.start,"utc").format(C.FI),l=e.end&&Z.tz(e.end,"utc").format(C.FI),e.task&&(h=Z.tz(Z(),"utc").format(C.FI)),d=a&&Z.tz(o,e.timezone).format(C.A));const p=e.notifications&&e.notifications.map((e=>`BEGIN:VALARM\nACTION:DISPLAY\nDESCRIPTION:${e.name}\nTRIGGER:-${Z.duration(e.when).toString()}\nEND:VALARM`)).join("\n"),u=[],{recurrence:g,recurrenceExceptions:m}=e;if(g){const{dtstart:e,...t}=g.origOptions;u.push(S.Ci.optionsToString(t))}m&&m.forEach((t=>{const{date:n,cancelled:i}=t;if(i){let t="",i="";e.allDay?(t=";VALUE=DATE",i=`${Z.tz(n,"utc").format(C.O5)}`):e.timezone===C.$T?i=Z(n).format(C.A):e.timezone?(t=`;TZID=${e.timezone}`,i=Z.tz(n,e.timezone).format(C.A)):i=Z.tz(n,"utc").format(C.FI),u.push(`EXDATE${t}:${i}`)}}));const v=e.task?"DUE":"DTEND";return[e.task?"BEGIN:VTODO":"BEGIN:VEVENT","DTSTAMP;VALUE=DATE-TIME:"+s,e.description?`DESCRIPTION:${(0,T.ES)(e.description)}`:"",e.location?`LOCATION:${(0,T.ES)(e.location)}`:"",l?`${v}${c}:${l}`:"",r?`DTSTART${c}:${r}`:"",p||"",d?`RECURRENCE-ID${c}:${d}`:"",Number.isInteger(e.sequence)?`SEQUENCE:${e.sequence||0}`:"",`SUMMARY:${(0,T.ES)(e.title)}`,n?`UID:${n}`:"",...t,...u,M.attachmentsToString(e.attachment),e.complete?"STATUS:COMPLETED":"",e.complete?`COMPLETED${c}:${h}`:"",e.task?"END:VTODO\r\n":"END:VEVENT\r\n"].filter(Boolean).join("\r\n")})).forEach((e=>{a+=e})),M.foldIcal(a+"END:VCALENDAR")},attachmentsToString:e=>(e||[]).map((e=>{const{filename:t,fmttype:n,url:i}=e;if(i){return`ATTACH${t?`;FILENAME=${(0,T.ES)(t)}`:""}${n?`;FMTTYPE=${n}`:""}:${i}`}})).filter(Boolean).join("\r\n"),stringToAttachments:(e="")=>e.split("\r\n").filter((e=>Boolean(e)&&-1!==e.indexOf("ATTACH")&&-1===e.indexOf("ENCODING")&&-1===e.indexOf("BINARY"))).map((e=>{const[t,n]=(0,T.Vl)(e,":",2),i=t.match(/FILENAME=([^;:]+)/),s=t.match(/FMTTYPE=([^;:]+)/);return{url:n,filename:i?i[1]:void 0,fmttype:s?s[1]:void 0}})),generateGUID:()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})),isRemoteCalendar:e=>{const t=i.Z.getCalendars().find((t=>t.id===e));if(!t?.active)return!1;const{accountId:n}=t;return!!i.Z.getAccounts().find((e=>e.id===n))?.url},isGoogleCalendar:e=>{const t=i.Z.getCalendars().find((t=>t.id===e));if(!t)return!1;const{accountId:n}=t,s=i.Z.getAccounts().find((e=>e.id===n));return!(!t||!s||"google"!==s.account_type)},isLocalCalendar:e=>{const t=i.Z.getAccounts(),n=i.Z.getCalendars().find((t=>t.id===e));if(!n)return!1;const{accountId:s}=n,o=t.find((e=>e.id===s));return!!o&&"local"===o.account_type},isCalDAV:e=>"vivaldi"===e||"caldav"===e||"google"===e,ensureAccountType:e=>Object.keys(C.d3).find((t=>t===e))||"local",savePassword:async(e,t,n)=>{const{urlValid:i}=w.Z.utilities.isUrlValid(e||"");return i?(w.Z.savedpasswords.add(!0,{username:t||"",password:n||"",signon_realm:"calendar",origin:e||""}),{result:!0,message:""}):{result:!1,message:(0,g.Z)("Invalid URL")}},getPassword:(e,t)=>new Promise((n=>w.Z.savedpasswords.get({signon_realm:"calendar",origin:e||"",username:t||""},((e,t)=>n({found:e,password:t}))))),deletePassword:(e,t)=>w.Z.savedpasswords.delete(!0,{signon_realm:"calendar",origin:e||"",username:t||""}),doesCalendarsExistsAndShowWarning:e=>0!==i.Z.getCalendars().length||(r.Z.showModal(e,{modal:{title:(0,g.Z)("No Calendar Defined"),body:(0,g.Z)("At least one calendar is required to add an event."),actions:[{title:(0,g.Z)("Open Calendar Settings"),action:"settings",default:!0}],cancelAction:{title:(0,g.Z)("Cancel"),action:"cancel"}}}).then((({action:t})=>{"settings"===t&&r.Z.showSettings(e,"calendar")})),!1),getAllChromeAlarms:()=>new Promise((e=>{m.Z.alarms.getAll((t=>{e(t)}))})),getAllNotifications:()=>new Promise((e=>{w.Z.calendar.getAllNotifications((t=>{e(t)}))})),getLocalGoogleTasksCalendars:e=>"google"!==e.account_type?[]:i.Z.getCalendars().filter((t=>t.accountId===e.id&&t.supportedCalendarComponent?.vtodo)),getPollResultText(e){const{calendars:t,error:n,message:i,didPoll:s}=e;if(n)return i||(0,g.Z)("Unknown error.");if(!s)return(0,g.Z)("Poll already in progress.");const o=t.reduce(((e,t)=>e+t.numberOfChangedCalendars),0);return 0===o?(0,g.Z)("Refresh complete. No change."):(0,g.Z)("Refresh complete. $1 calendar was updated.","Refresh complete. $1 calendars were updated.",[o])},getPageId:e=>"panel"===a.Z.getContext(e).area?i.Z.getPanelResourceKey():c.Z.getActivePage(e)?.id,minimalCreateEvent:e=>({calendarId:"",is_template:!1,title:"",...e}),validateEventTypes(e,t=!0){const{sequence:n}=e;return(n||0)>2147483647&&(v.Z.warn("Calendar",["Validating Event"],"Value in field: Sequence is to high. Sequence set to 0"),e.sequence=0),e},ensureHttpsForWebcal:e=>e.startsWith("webcal")?e.replace("webcal","https"):e},P=M},58821:(e,t,n)=>{"use strict";n.d(t,{Xq:()=>l,FY:()=>d,Ro:()=>c,PX:()=>h,EP:()=>p,VV:()=>u,FL:()=>g,sG:()=>m,Yu:()=>v,bn:()=>f,aE:()=>y,oJ:()=>w,zX:()=>b,KC:()=>C,oR:()=>S});var i=n(29087),s=n(80008),o=n.n(s),a=n(24522),r=n(89175);function l(e,t){const n=t?t.clone():e.clone(),i=n.startOf("month");return Math.floor((e.diff(n,"day")+1+i.weekday()-1)/7)}function d(e,t,n,i=!0){const s=n.clone();let o=7*e+1-s.startOf("month").weekday()+t;if(i){const e=s.endOf("month").date();o=Math.max(1,Math.min(o,e))}return s.date(o)}function c(e,t,n=!1){const i=t.clone(),s=i.endOf("month").weekday(),o=n?s-e:(s-e+7)%7;return i.subtract(o,"day")}function h(e,t,n=!1){const i=t.clone(),s=i.startOf("month").weekday(),o=n?e-s:(e-s+7)%7;return i.add(o,"day")}function p(){return Intl.DateTimeFormat().resolvedOptions().timeZone??""}function u(e,t){t&&t!==a.$T||(t=p());const n=o().tz(e,t);return new Date(Date.UTC(n.year(),n.month(),n.date(),n.hour(),n.minute(),n.second()))}function g(e,t){return t&&t!==a.$T||(t=p()),o().tz([e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds()],t).toDate()}function m(e,t=!0){const{start:n=0,end:s=0}=e;if(s&&s<n&&(e.end=n+(e.allDay?a.hd:i.Z.get(r.kCalendarDefaultDuration))),e.task||e.end||(e.end=e.allDay?n+a.hd:n),e.allDay){if(e.timezone=a.$T,e.start){const n=new Date(e.start||0),i=new Date(n.getFullYear(),n.getMonth(),n.getDate());e.start=(t?u(i):i).valueOf()}if(e.task){const n=new Date(e.end||0),i=new Date(n.getFullYear(),n.getMonth(),n.getDate());e.end=(t?u(i):i).valueOf()}else if(!e.task&&e.end){const n=new Date(e.end||0),i=new Date(n.getFullYear(),n.getMonth(),n.getDate());e.end=(t?u(i):i).valueOf(),e.start===e.end&&(e.end=e.end+a.hd)}}return e}function v(e){return e.timezone&&e.timezone!==a.$T?e.timezone:p()||""}function f(e,t){const n=p(),i=e.timezone||n;if(t===a.$T)e.timezone=t,t="UTC";else if(t===a.ad)e.timezone=n,t=n||"UTC";else{if(!o().tz.zone(t))return e;e.timezone=t}if(e.start){const n=o().tz(e.start,i);e.start=o().tz(n.format(a.A),t).valueOf()}if(e.end){const n=o().tz(e.end,i);e.end=o().tz(n.format(a.A),t).valueOf()}return e}function y(e,t=!1){const n=t?p():v(e),i=o().tz(e.start,n),s=o().tz(e.end,n);return e.allDay&&e.start&&e.end&&s.subtract(1,"day"),{start:i,end:s}}function w(e){return e.task?e.start?e.start:e.end?e.end:NaN:e.start}function b(e){return Math.ceil(e/a.QI)*a.QI}function C(e,t){return Math.abs(e-t)<a.hd&&e.getDate()===t.getDate()}function S(e){return(e-new Date(e).getTimezoneOffset()*a.lb)%a.hd}},34930:(e,t,n)=>{"use strict";n.d(t,{Z:()=>v});var i=n(29194),s=n(15800),o=n(46382),a=n(68247),r=n(29087),l=n(15489),d=n(56371),c=n(88951),h=n(36809),p=n(85834),u=n(89175);const g=(e,t)=>({title:e.task?(0,d.Z)("Task has External Attendees"):(0,d.Z)("Event has External Attendees"),body:(0,d.Z)("To notify attendees about this, email messages should be sent. If you prefer to not send messages you can choose so."),actions:[{title:(0,d.Z)("Send Messages"),action:"send",default:!0}],cancelAction:{title:(0,d.Z)("Don’t Send Messages"),action:"cancel",default:!1},inputs:[{name:"note",label:(0,d.Z)("Add a Custom Note to the Messages")}],checks:[{name:"remember",label:(0,d.Z)("Remember My Choice")}]});async function m(e,t,n,i){const s={type:"html",content:i.body},o={type:"attachment",filename:"invite.ics",content:(0,p.h$)(i.iCal),mimeType:"application/ics"},a=Date.now();h.Z.sendExternalMessage(e,{bcc:[],bodyParts:[s,o],cc:[],flags:[],forwarded:void 0,from:t,inReplyTo:"",internal:!1,messageId:(0,c.Z)(t[0].address),replied:void 0,sentDate:a,subject:i.subject,threadKey:void 0,to:n})}const v={getOrganizerForEvent:function(e){const t=i.Z.getCalendars().find((t=>t.id===e.calendarId));if(t){const e=i.Z.getAccountForCalendar(t.id);return"google"===e?.account_type?e.username:r.Z.get(u.kCalendarMailAccount)}},sendAttendeeMails:async function(e,t,n,i=!1){if(s.Z.isGoogleCalendar(t.calendarId))return;const c=r.Z.get(u.kCalendarSendInviteEmailAction),h="ask"===c?await o.Z.showModal(l.ZP.getId(),{modal:g(t)}):{action:c};if("cancel"===h.action)return;"ask"===c&&h.checks?.remember&&a.Z.set(u.kCalendarSendInviteEmailAction,h.action);let p="",v="",f="REQUEST";if(!t.organizer)throw new Error(`Event organizer not found for event uid ${String(t.uid)}`);const y=[{address:t.organizer}],w=`<strong>${t.organizer}</strong>`,b=`<strong>${t.title}</strong>`,C=n.map((([n,o])=>{switch(n){case"create":p=(0,d.Z)("Event invitation: $1",[t.title]),v=(0,d.Z)("$1 has invited you to event “$2”",[w,b]),f="REQUEST";break;case"update":p=(0,d.Z)("Event updated: $1",[t.title]),v=(0,d.Z)("$1 has updated event “$2”",[w,b]),f="REQUEST";break;case"cancel":p=(0,d.Z)("Event cancelled: $1",[t.title]),v=(0,d.Z)("$1 has cancelled event “$2”",[w,b]),f="CANCEL"}const{note:a}=h.inputs||{};a&&(v+="<br/><br/><strong>"+(0,d.Z)("Event organiser added the following note:")+"</strong><br/>"+a);const r={method:f,includeRecurrenceId:i},l=s.Z.eventsToICalendar([t],r),c=o.filter((e=>e.address!==t.organizer)).map((e=>({address:e.address,...e.name?{name:e.name}:null})));if(0===c.length)return;return m(e,y,c,{subject:p,body:v,iCal:l})}));return Promise.all(C)},sendReplyMails:async function(e,t,n,i){let o="",a="";const r=t.organizer;if(!r)throw new Error(`Event organizer not found for event uid ${String(t.uid)}`);const l=[{address:"DECLINECOUNTER"===i?r:n}],c=`<strong>${n}</strong>`,h=`<strong>${t.title}</strong>`;switch(i){case"ACCEPTED":o=(0,d.Z)("Accepted: $1",[t.title]),a=(0,d.Z)("$1 has accepted your invitation to “$2”",[c,h]);break;case"TENTATIVE":o=(0,d.Z)("Tentatively accepted: $1",[t.title]),a=(0,d.Z)("$1 has tentatively accepted your invitation to “$2”",[c,h]);break;case"DECLINED":o=(0,d.Z)("Declined: $1",[t.title]),a=(0,d.Z)("$1 has declined your invitation to “$2”",[c,h]);break;case"DECLINECOUNTER":o=(0,d.Z)("Event change proposal declined: $1",[t.title]),a=(0,d.Z)("$1 has declined your proposed changes to “$2”",[c,h])}const p={method:"DECLINECOUNTER"===i?"DECLINECOUNTER":"REPLY"};return m(e,l,[{address:"DECLINECOUNTER"===i?n:r}],{subject:o,body:a,iCal:s.Z.eventsToICalendar([t],p)})}}},8336:(e,t,n)=>{"use strict";n.d(t,{C:()=>g,t:()=>m});var i=n(29194),s=n(15800),o=n(80008),a=n.n(o),r=n(5264),l=n.n(r),d=n(23542),c=n(47543),h=n(90870);const p=(0,d.extendMoment)(a());function u(e,t){let n=[];const[o,a]=(0,h.Z)(e,s.Z.isRecurringEvent);let r=[];o.forEach((e=>{if(function(e){return Boolean(e.task&&!e.end)}(e))return;const{start:s,end:o}=t,a=(0,c.YE)(e.recurrence?.toString()||"",s.valueOf(),o.valueOf(),e.timezone),[l,d]=((e,t)=>{const n=[],s=[];return t.forEach((t=>{const o={...e},a=(e.recurrenceExceptions||[]).filter((e=>t.valueOf()===e.date)),r=a.length>0;if(a.forEach((e=>{const{cancelled:o,parent_event_id:a,exception_event_id:r}=e;if(!o&&a&&r){s.push(r);const e=i.Z.getEvent(a),o=i.Z.getEvent(r);if(e&&o){const i={...o};i.id=`${e.id}:${i.start}`,i.recurrence=e.recurrence,i.recurrenceId=t.valueOf(),n.push(i)}}})),!r){const{start:i,end:s}=function(e,t){const n={start:0,end:0};if(t.task)if(t.start&&t.end){const i=t.end-t.start;n.start=e.valueOf(),n.end=e.valueOf()+i}else n.end=e.valueOf();else{const i=(t.end||t.start)-t.start;n.start=e.valueOf(),n.end=e.valueOf()+i}return n}(t,e);o.start=i,o.end=s,o.id=`${e.id}:${t.valueOf()}`,o.uid=e.uid,n.push(o)}})),[n,s]})(e,a);r=r.concat(l),n=n.concat(d)}));return a.filter((e=>{if(n.includes(e.id))return!1;if(e.task){if(!e.start&&!e.end)return!1;if(e.start){const{start:n}=e,i=e.end;return(i&&i!==n?i:n+1)>t.start.valueOf()&&n<=t.end.valueOf()}return t.contains(e.end)}{const{start:n,end:i}=e;return(i&&i!==n?i:n+1)>t.start.valueOf()&&n<=t.end.valueOf()}})).concat(r)}const g={call:e=>{const t=u(e,p.range(p(),p().add(1,"week")));return t.sort(((e,t)=>e.start!==t.start?e.start-t.start:e.allDay!==t.allDay?e.allDay?-1:1:e.end!==t.end?e.end-t.end:parseInt(e.id||0)-parseInt(t.id||0))),t}},m={call:l()(2)(((e,t,n)=>u(e,s.Z.getDisplayRange(t,n))))}},55351:(e,t,n)=>{"use strict";n.d(t,{Z:()=>Ue});var i=n(61757),s=n(34929),o=n(87265),a=n(29194),r=n(15800),l=n(79706),d=n(5646),c=n(60331),h=n(15489),p=n(56371),u=n(64877),g=n(8575);const{constructUrl:m}=o.Z;const{constructUrl:v}=o.Z;function f(e,t,n,i,s){const{url:o,uid:a,etag:l,href:d}=t,{username:c,password:h,oauth2Token:p}=e,u=g.parse(o);let m="";const{protocol:f,host:y}=u;let w="";if(f&&y&&d)m=`${f}//${y}${d}`;else{if(!f||!y||!a)return{};const e=f+"//"+y;w="/"+v([n,a])+".ics",m=v([e,w])}const b={};return s||l?b["If-Match"]='"'+l+'"':b["If-None-Match"]="*",{username:c,password:h,oauth2Token:p,headers:b,url:m,href:w,method:"PUT",contentType:"text/calendar; charset=utf-8",body:r.Z.eventsToICalendar(i)}}const{constructUrl:y}=o.Z;function w(e,t,n,i,s){const{uid:o,href:a}=i,{username:r,password:l,oauth2Token:d}=e,c=g.parse(t);let h="";const{protocol:p,host:u}=c;if(p&&u&&a)h=`${p}//${u}${a}`;else{if(!p||!u||!o)return{};h=y([p+"//"+u,n,o+".ics"])}return{username:r,password:l,oauth2Token:d,url:h,method:"GET",contentType:"text/calendar; charset=utf-8"}}var b=n(45660);function C(e,t){return{...e,method:"REPORT",body:`<?xml version="1.0" encoding="UTF-8"?>\n    <c:calendar-multiget xmlns:d="DAV:" xmlns:c="urn:ietf:params:xml:ns:caldav">\n    <d:prop>\n        <d:getetag />\n        <c:calendar-data />\n    </d:prop>\n      ${t.map((e=>`<d:href>${e}</d:href>`)).join("")}\n    </c:calendar-multiget>`}}var S=n(23796),T=n(84384);const{stripDoubleQuotes:I}=o.Z;var k=n(15805),A=n(23750);const{stripDoubleQuotes:Z}=o.Z;function E(e){let t=[];const n=(0,T.Z)(e);return!n.parsererror&&"d_multistatus"===n.root&&n.d_multistatus.d_response&&(t=n.d_multistatus.d_response.map((e=>{if(-1===e?.d_status?.content?.indexOf("200"))return null;const t=e.d_href?decodeURIComponent(e.d_href.content):"",n=e.d_propstat&&e.d_propstat.d_prop&&e.d_propstat.d_prop.d_getetag?Z(e.d_propstat.d_prop.d_getetag.content):"",i=e.d_propstat&&e.d_propstat.d_prop&&e.d_propstat.d_prop.c_calendarData?String(e.d_propstat.d_prop.c_calendarData.content):"",s=(0,k.Z)(i);return s.VEVENT.length?(0,A.rP)(s.VEVENT[0],{href:t,etag:n}):s.VTODO?.length?{...(0,A.rP)(s.VTODO[0],{href:t,etag:n}),task:!0}:s.VJOURNAL?.length?void 0:{href:t,etag:n}})).filter(Boolean)),t}var _=n(8687),N=n(7064),M=n(24522),P=n(1712);const{basicHttpAuthenticationHeader:D}=o.Z;function x(e,t){return t||(t=P.Z.getCalendarCreateColor()),`<?xml version="1.0" encoding="utf-8"?>\n    <C:mkcalendar xmlns:C="urn:ietf:params:xml:ns:caldav"><set xmlns="DAV:">\n      <prop><displayname>${e}</displayname>\n        <C:supported-calendar-component-set>\n          <C:comp name="VEVENT" />\n        </C:supported-calendar-component-set>\n        <calendar-color xmlns="http://apple.com/ns/ical/">${t}</calendar-color>\n      </prop></set>\n    </C:mkcalendar>`}var O=n(92395);const{constructUrl:L,stripDoubleQuotes:R}=o.Z;function B(e){let t="";return e.split("/").forEach((e=>{e.includes("@")&&(t=e)})),t}async function F(e,t){const n=await s.Z.getAuthentication(e),{oauth2Token:i}=n,o=[(0,M.fP)(),"/v3/calendars",`?key=${await(0,O.wU)()}`],a=L(o),r=await fetch(a,{method:"POST",headers:{Authorization:`Bearer ${i}`,Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({summary:t})}),l={status:!1,message:"",description:"",name:""};if(r.ok){const e=function(e){const{id:t,summary:n,etag:i,timeZone:s}=e;return{name:t,description:n,ctag:R(i),timezone:s}}(await r.json());l.status=!0,l.description=e.description,l.name=`/caldav/v2/${e.name}/events/`,l.ctag=e.ctag}return l}var U=n(80008),V=n.n(U),W=n(81723),H=n(90870),z=n(58821);const{getLocalGoogleTasksCalendars:G}=r.Z,{constructUrl:$,stripDoubleQuotes:K}=o.Z,j="YYYY-MM-DDTHH:mm:ssZ";function Y(e){const{items:t=[],etag:n}=e;return{...e,etag:K(n),items:t.map((e=>({...e,etag:K(e.etag)})))}}function X(e,t){const{title:n,notes:s,etag:o,due:a,id:r,completed:l}=e,d=a?V().tz(V()(a),"UTC").valueOf():void 0,c=l?V().tz(V()(l),"UTC").valueOf():void 0,h={id:t.id,calendarId:t.calendarId,title:n,task:!0,description:s,end:d,etag:K(o),status,uid:r,complete:Boolean(l),completed:c,timezone:M.$T,allDay:!0},[p]=i.Z.transformVivaldiEvents([h]);return p}function Q(e,t){const{title:n,notes:i,due:s,etag:o,id:a,completed:r}=e,l=r?V()(r).valueOf():void 0;return{calendarId:t,title:n,is_template:!1,task:!0,description:i,end:s?V()(s).valueOf():void 0,etag:K(o),status,uid:a,complete:Boolean(r),completed:l,timezone:M.$T,allDay:!0}}async function q(e,t){const n=await s.Z.getAuthentication(t),{parsed:o,status:r}=await J(n),l={numberOfCalendarsPolled:0,numberOfChangedCalendars:0};if(o.error){const e=new Date;return a.Z.getCalendars().filter((e=>e.accountId===t.id)).forEach((async t=>await i.Z.updateCalendar(t.id,{lastChecked:e.valueOf()},!1))),b.Z.log("Calendar",["google","tasks"],"Error fetching TaskList: ",r,o),l}const d=Y(o),c=G(t);l.numberOfCalendarsPolled=d.items.length;const h=(0,W.Z)(d.items,c,((e,t)=>{const{id:n}=e;return n===t.name})),p=await async function(e,t,n){return await Promise.all(e.map((async e=>{const s={accountId:t,name:e.id,description:e.title,active:n,supportedCalendarComponent:{vevent:!1,vtodo:!0,vjournal:!1}},o=await i.Z.createCalendar(s);return o.calendar?o.calendar:Promise.reject()})))}(h,t.id,c.length>0),[u,g]=(0,H.Z)(c,(e=>d.items.some((t=>t.id===e.name))));await Promise.all(g.map((async e=>{await i.Z.deleteCalendar(e)})));const m=p.concat(u),v=(0,W.Z)(m,d.items,((e,t)=>{const{name:n}=e;return n===t.id&&e.ctag===t.etag}));await Promise.all(v.map((async t=>{const s=function(e){const{items:t=[],etag:n}=e;return{...e,etag:K(n),items:t.map((e=>({...e,etag:K(e.etag)})))}}(await async function(e,t){const{oauth2Token:n}=e,i=["showCompleted=true","showHidden=true"],s=`${(0,M.fL)()}/tasks/v1/lists/${t}/tasks?${i.join("&")}&key=${await(0,O.wU)()}`,o=await fetch(s,{method:"GET",headers:{Accept:"application/json",Authorization:"Bearer "+n}}),{status:a,ok:r,statusText:l}=o;if(!r)throw b.Z.log("Calendar",["google, tasks"],"Error getting tasks",a,l),Error(`Error getting tasks", ${a} ${l}`);return await o.json()}(n,t.name)),o=a.Z.getEventsPerCalendar(t.id).filter((e=>!e.trash)),r=s.items.filter((e=>!o.some((t=>t.uid===e.id)))),c=o.filter((e=>-1===s.items.findIndex((t=>t.id===e.uid)))),h=o.map((e=>{const t=s.items.find((t=>t.id===e.uid&&K(t.etag)!==e.etag));return t?{...X(t,e)}:null})).filter(Boolean),p=r.map((e=>Q(e,t.id)));await Promise.all(p.map((async t=>await i.Z.createEvent(e,t,!1)))),await Promise.all(c.map((async e=>await i.Z.deleteEvent(e.id)))),await Promise.all(h.map((async t=>await i.Z.updateEvent(e,t,void 0,!1))));const u=d.items.find((e=>t.name===e.id));let g={ctag:s.etag};u?.title!==t.description&&(g={...g,description:u?.title}),(p.length||c.length||h.length)&&l.numberOfChangedCalendars++,await i.Z.updateCalendar(t.id,g,!1)})));const f=new Date;return m.forEach((async e=>await i.Z.updateCalendar(e.id,{lastChecked:f.valueOf()},!1))),l}async function J(e){const{oauth2Token:t}=e,n=`${(0,M.fL)()}/tasks/v1/users/@me/lists?maxResults=200&key=${await(0,O.wU)()}`,i=await fetch(n,{method:"GET",headers:{Accept:"application/json",Authorization:"Bearer "+t}}),{status:s,ok:o,statusText:a}=i;if(!o)throw b.Z.log("Calendar",["google, tasks"],"Error fetching task lists ",s,a),Error(`Error fetching task lists, ${s} ${a}`);return{status:s,parsed:await i.json()}}const{httpStatusSuccess:ee,parseHttpStatusCode:te,stripDoubleQuotes:ne}=o.Z;const{basicHttpAuthenticationHeader:ie}=o.Z;async function se(e,t,n,i){const s={staleSyncToken:!0,createdUpdated:[],deletedHrefs:[],error:!0,serverThrottlesEvents:!1,syncToken:""},o=await async function(e,t){const{method:n,body:i,username:s,password:o,oauth2Token:a}=e,r=await fetch(t,{method:n,credentials:"omit",headers:{Depth:"0","Content-Type":"text/xml;charset=UTF-8",Authorization:a?"Bearer "+a:ie(s,o)},body:i});return{response:await r.text(),status:r.status,ok:r.ok}}((a=e,r=t,r=r||"",{...a,method:"REPORT",body:`<?xml version="1.0" encoding="UTF-8"?>\n    <D:sync-collection xmlns:D="DAV:"\n      xmlns:CS="http://calendarserver.org/ns/"\n      xmlns:C="urn:ietf:params:xml:ns:caldav">\n    <D:sync-token>${encodeURI(r)}</D:sync-token>\n    <D:sync-level>1</D:sync-level>\n    <D:prop>\n      <D:getetag />\n    </D:prop>\n    </D:sync-collection>`}),n);var a,r;const{status:l,ok:d}=o;return d||403!==l?function(e,t){const n=(0,T.Z)(e),i={createdUpdated:[],deletedHrefs:[],syncToken:"",serverThrottlesEvents:!1,error:!0,staleSyncToken:!1};if(n.parsererror)return i;const{d_syncToken:s,d_response:o}=n.d_multistatus;if(s&&(i.syncToken=s.content,i.error=!1),!o)return i;const a=[];o.forEach((e=>{let n=e.d_status?.content;if(!n)try{n=e.d_propstat.d_status.content}catch(e){b.Z.error("Calendar",["parser"],"parseSyncCollection: ",e)}const s=ee(n);t===e.d_href.content?e?.d_status?.content&&507===te(e.d_status.content)&&(i.serverThrottlesEvents=!0):a.push({etag:e.d_propstat?.d_prop?.d_getetag?ne(e.d_propstat.d_prop.d_getetag.content):"",href:decodeURIComponent(e.d_href.content),isDeletedOnServer:s})}));const[r,l]=(0,H.Z)(a,(e=>e.isDeletedOnServer));return{...i,createdUpdated:r.map((({href:e,etag:t})=>({href:e,etag:t}))),deletedHrefs:l.map((({href:e})=>e)),error:!1}}(o.response,i):s}const{basicHttpAuthenticationHeader:oe,concatUrl:ae,stripDoubleQuotes:re}=o.Z;async function le(e,t){const{username:n,password:i,url:s}=e;return(await Promise.all(t.map((async e=>{const t=ae(s,e),o=await fetch(t,{method:"GET",headers:{"Content-Type":"text/calendar",Authorization:oe(n,i)}});if(o.ok){const t=re(o.headers.get("ETag")||"");return{icsString:await o.text(),etag:t,href:e}}})))).filter(Boolean).map((e=>{const{etag:t,icsString:n,href:i}=e,{VEVENT:s,VTODO:o}=(0,k.Z)(n);return(0,A.rP)(s.length?s[0]:o[0],{etag:t,href:i})}))}var de=n(88545),ce=n(9141);const{stripDoubleQuotes:he,getCalDAVUrl:pe}=o.Z,{basicHttpAuthenticationHeader:ue}=o.Z,{getLocalGoogleTasksCalendars:ge,savePassword:me}=r.Z,{VERIFYING:ve,OK:fe,ERROR:ye}=M.LB,{isCalDAV:we}=r.Z;let be,Ce=!1;const Se=new Map;let Te=!1,Ie=!1;const ke={},Ae=new Set,Ze=new Set,Ee=new Set;function _e(e){const t=g.parse(e),{host:n,protocol:i}=t;if(i&&n)return i+"//"+n}async function Ne(e){const t=a.Z.getEvents().filter((e=>e.syncPending));for(const n of t)if(n.trash){const{eventNotFound:e,ok:t}=await Fe.deleteEvent(n.id);(e||t)&&i.Z.deleteEvent(n.id)}else await Fe.updateEvent(e,n)}function Me(){const e=h.ZP.getId();navigator.onLine&&Ne(e)}function Pe(e){const t=h.ZP.getId();if("calendarDataReady"===e){a.Z.getAccounts().filter((e=>!!e.url)).forEach((e=>{a.Z.getCalendars().filter((t=>t.accountId===e.id)).forEach((t=>{t.active?Ze.has(t.id)||(Ze.add(t.id),Ee.add(e.id)):Ze.has(t.id)&&Ze.delete(t.id)})),Ae.has(e.id)||(Ae.add(e.id),Ee.add(e.id))})),Ee.size>0&&(be&&clearTimeout(be),be=setTimeout((()=>{Be(t,Array.from(Ee)),Ee.clear()}),1e3)),Ce||(Ce=!0,Ne(t))}}async function De(e,t,n,s){const{response:o}=await(0,_.Z)((r=n,{...r,method:"REPORT",headers:{Depth:1},body:'<?xml version="1.0" encoding="UTF-8"?>\n    <C:calendar-query xmlns:D="DAV:" xmlns:C="urn:ietf:params:xml:ns:caldav">\n    <D:prop>\n      <D:getetag />\n    </D:prop>\n    <C:filter>\n      <C:comp-filter name="VCALENDAR" />\n    </C:filter>\n   </C:calendar-query>'}),s);var r;return await async function(e,t,n,s){const o=E(n),r=a.Z.getEventsPerCalendar(s).filter((e=>!e.trash));let l=r.filter((e=>!o.some((t=>t.href===e.href))));const h=o.filter((e=>!r.some((t=>t.etag===e.etag)))).map((e=>e.href||""));if(0===h.length)return void l.forEach((e=>i.Z.deleteEvent(e.id)));const u=_e(t.url);if(!u)return Promise.reject();const g=a.Z.getCalendars().find((e=>e.id===s));if(!g)return;const m=u+g.name,v=await(0,_.Z)(C(t,h),m);let f=[];f=v.response?E(v.response):await le(t,h),f=f.map((e=>({...e,calendarId:s}))),l=l.filter((e=>f.some((t=>e.uid!==t.uid))));const y=[];let w=0,S=0;const T=f.filter((e=>!r.some((t=>t.uid===e.uid))));T.forEach((e=>{50===w&&(y[++S]=[],w=0),y[S]||(y[S]=[]),y[S].push(e),w++})),i.Z.stopAPIChangeListeners(),await(0,ce.F)(r,f),await Promise.all(l.map((e=>i.Z.deleteEvent(e.id))));let I=0;return new Promise(((t,n)=>{y.reduce(((t,n)=>t.then((()=>i.Z.createEvents(n).then((t=>{I+=t.created_count;const n=Math.round(I/T.length*100);c.Z.setStatus(e,(0,p.Z)("Imported $1 of $2 ($3%)",[I,T.length,n])),i.Z.loadPromise()}))))),Promise.resolve()).then((()=>{d.Z.updateAllAlarms(),t()})).catch((e=>{b.Z.error("Calendar",["caldav"],"Error creating events",e),n(e)}))}))}(e,n,o,t)}async function xe(e,t,n,i=!1){const o={calendarId:t.id,ctag:t.ctag,lastCalendarPoll:Date.now(),changed:!1},a=_e(n.url);if(!a)return Promise.reject();const r=a+t.name,l=await s.Z.getAuthentication(n),d=t.id,c=t.ctag,h=await(0,_.Z)(function(e){const{account_type:t}=e,n={Depth:"google"===t?0:1};return{...e,headers:n,method:"PROPFIND",body:'<?xml version="1.0" encoding="UTF-8"?>\n    <D:propfind xmlns:D="DAV:"\n      xmlns:CS="http://calendarserver.org/ns/"\n      xmlns:C="urn:ietf:params:xml:ns:caldav">\n    <D:prop>\n    <D:displayname />\n    <CS:getctag />\n    <D:sync-token />\n    </D:prop>\n    </D:propfind>'}}(l),r),{ctag:p,syncToken:u}=function(e){const t=(0,T.Z)(e),n={displayName:"",ctag:"",syncToken:""};if(!t.parserror){const e=t.d_multistatus.d_response[0].d_propstat.d_prop,i=e.cs_getctag;i&&(n.ctag=I(i.content));const s=e.d_displayname;s&&(n.displayName=s.content);const o=e.d_syncToken;o&&(n.syncToken=decodeURIComponent(o.content))}return n}(h.response);return o.ctag=i&&u?u:p,""===p||c!==p?(o.changed=!0,await De(e,d,l,r),o):o}async function Oe(e,t){const n={calendars:[],error:!1,message:""};t=t??await s.Z.getAuthentication(e);const i=await(0,_.Z)((0,u.ZP)(t),e.url),{status:o,response:a,ok:r}=i;if(!(r&&o>=200&&o<300))return n.message=Fe.getStatusMessageAndLog(e,i),n.error=!0,n;if(n.calendars=(0,S.Z)(a),0===n.calendars.length&&b.Z.warn("Calendar",["caldav"],(0,p.Z)("No calendars found for account '$1'.",[e.name])),"google"===e.account_type){let e;try{e=await async function(e){const{parsed:t,status:n}=await J(e);if(t.error)return b.Z.error("Calendar",["google","tasks"],"Error fetching TaskList: ",n,t),[];const i=Y(t);return i.items.map((e=>({ctag:i.etag,name:e.id,description:e.title,color:"",supportedCalendarComponent:{vevent:!1,vtodo:!0,vjournal:!1},supportsSyncCollection:!1,syncToken:""})))}(t)}catch(e){return n.error=!0,n.message=e.message,n}n.calendars.push(...e)}return n}async function Le(e,t){return Promise.all(e.map((async e=>{const{ctag:n,supportsSyncCollection:s,syncToken:o,...a}=e,r={...a,accountId:t.id,active:e.active??!0,hidden:e.hidden??!1},{calendar:l}=await i.Z.createCalendar(r);return l||Promise.reject()})))}async function Re(e,t,n){const o=a.Z.getCalendars().filter((e=>{if("google"===t.account_type){if(!e.supportedCalendarComponent)return;const{vevent:n}=e.supportedCalendarComponent;return e.accountId===t.id&&n}return e.accountId===t.id})),l=n.filter((e=>!o.some((t=>e.name===t.name)))),h=await Le(l,t);i.Z.loadPromise(),N.Z.utilities.broadcastMessage({calendar:{message:"loadData"}});const[u,g]=(0,H.Z)(o,(e=>n.some((t=>t.name===e.name))));await Promise.all(g.map((async e=>await i.Z.deleteCalendar(e))));const m=h.concat(u);n.forEach((async e=>{const t=m.find((t=>t.name===e.name));if(!t)return;const n={},s=r.Z.validColor(e.color);s!==t.color&&(s?n.color=s:b.Z.warn("Calendar",["sync"],"Unsupported calendar color",e.color)),e.description!==t.description&&(n.description=e.description),Object.keys(n).length&&await i.Z.updateCalendar(t.id,n,!1)}));const v=m.filter((e=>e.active&&e.accountId===t.id)),f=await Promise.all(v.map((async o=>{const r=n.find((e=>e.name===o.name));return r?r.supportsSyncCollection?r.syncToken!==o.ctag?await async function(e,t,n){const o={calendarId:t.id,ctag:t.ctag,lastCalendarPoll:Date.now(),changed:!1},r=_e(n.url);if(!r)throw new Error("Missing URL prefix");const l=t.id,h=r+t.name,u=await s.Z.getAuthentication(n),g=a.Z.getEventsPerCalendar(l).filter((e=>!e.trash)),m=new Map,v=new Set;g.forEach((e=>{e.href&&m.set(e.href,e.etag),v.add(e.uid)}));let f=[];const y=[],w=[];let S;do{const i=t.ctag,s=await se(u,i,h,t.name);S=s.serverThrottlesEvents,f=f.concat(s.deletedHrefs);const{staleSyncToken:a,createdUpdated:r,syncToken:l,error:d}=s;if(t.ctag=l,a)return await xe(e,t,n,!0);if(d&&b.Z.warn("Calendar",["caldav"],"CalDAV. Error parsing sync-collection",t.name),i===l)return o;o.changed=!0;const c=new Set,p=r.filter((({etag:e,href:t})=>{const n=!m.has(t);n&&c.add(t);const i=m.has(t)&&m.get(t)!==e;return m.set(t,e),n||i})).map((({href:e})=>e||"")),g=E((await(0,_.Z)(C(u,p),h)).response).map((e=>({...e,calendarId:t.id}))),[v,T]=(0,H.Z)(g,(e=>c.has(e.href??"")));y.push(...v),w.push(...T)}while(S);const T=[];let I=0,k=0;y.forEach((e=>{50===I&&(T[++k]=[],I=0),T[k]||(T[k]=[]),T[k].push(e),I++})),i.Z.stopAPIChangeListeners(),await(0,ce.F)(g,w);const A=g.filter((e=>f.some((t=>t===e.href))));await Promise.all(A.map((e=>i.Z.deleteEvent(e.id))));let Z=0;return await Promise.all(T.map((async t=>{const n=await i.Z.createEvents(t);Z+=n.created_count;const s=Math.round(Z/y.length*100);return c.Z.setStatus(e,(0,p.Z)("Imported $1 of $2 ($3%)",[Z,y.length,s])),i.Z.loadPromise(),n}))),T.flat().some((e=>e.notifications))&&d.Z.updateAllAlarms(),o.ctag=t.ctag,o}(e,o,t):void 0:await xe(e,o,t):Promise.resolve()})));await Promise.all(f.filter(Boolean).map((async e=>{const{calendarId:t,ctag:n}=e;await i.Z.updateCalendar(t,{ctag:n},!1)})));const y=f.filter(Boolean).reduce(((e,t)=>(t.changed&&e++,e)),0);return{numberOfCalendarsPolled:v.length,numberOfChangedCalendars:y}}async function Be(e,t){const n={didPoll:!1,calendars:[],error:!1,message:""};if(!Se.size&&(Te||!h.ZP.isMail()))return n;Te=!0;let o=a.Z.getAccounts().filter((e=>e.url.length));if(o=o.filter((e=>!Se.has(e.id))),t?.length&&(o=t.map((e=>o.find((t=>t.id===e)))).filter(Boolean)),Se.size&&!Ie){Ie=!0;try{await Promise.all(Array.from(Se.values()).map((async e=>await e.onRemoval(e.accountId))))}catch(e){b.Z.error("Calendar","Error removing account",e)}finally{Ie=!1}}return await o.reduce((async(o,r)=>o.then((async()=>{const{url:o,account_type:d,name:c}=r;if(!(!!t&&t.includes(r.id))){const e=a.Z.getCalendars().filter((e=>e.accountId===r.id)).map((e=>e.lastChecked)).filter(Boolean).reduce(((e,t)=>t>e?t:e),0),t=Date.now();if(!((e?e+1e3*M.jC:t)<=t))return[]}try{if(n.didPoll=!0,we(d)){const t=await s.Z.getAuthentication(r),l=await(0,_.Z)((0,u.ZP)(t),o),{status:h,response:g,ok:m}=l;let v=[];if(h>=200&&h<300?(v=(0,S.Z)(g),0===v.length&&b.Z.warn("Calendar",["caldav"],(0,p.Z)("No calendars found for account '$1'.",[c]))):(n.message=Fe.getStatusMessageAndLog(r,l),n.error=!0),m){if("google"===d){let t;try{t=await q(e,r)}catch(e){return n.error=!0,n.message=e.message,n}n.calendars.push(t)}const t=await Re(e,r,v);n.calendars.push(t)}else{const e=a.Z.getCalendars().filter((e=>e.accountId===r.id)).map((e=>e.id));await Promise.all(e.filter(Boolean).map((async e=>await i.Z.updateCalendar(e,{lastChecked:Date.now()},!1))))}}else if("ical"===d){const e=await l.Z.fetchAndCreate(r);n.calendars.push(e)}}catch(e){n.message=Fe.getStatusMessageAndLog(r,e),n.error=!0}finally{const e=a.Z.getCalendars().filter((e=>e.accountId===r.id)).map((e=>e.id));await Promise.all(e.filter(Boolean).map((async e=>await i.Z.updateCalendar(e,{lastChecked:Date.now()},!1)))),i.Z.startAPIChangeListeners()}}))),Promise.resolve()).finally((()=>{Te=!1;a.Z.getAccounts().some((e=>e.url))&&(be=setTimeout((()=>Be(e)),2e4))})),n}const Fe={calendarServiceStart(){a.Z.addListener(Pe),navigator.connection.addEventListener("change",Me)},calendarServiceStop(){a.Z.removeListener(Pe),navigator.connection.removeEventListener("change",Me),clearTimeout(be)},resetStatus(e){ke[e]&&(ke[e].authenticationErrorCount=0)},resetEventRemoteData:e=>(e.href=void 0,e.url=void 0,e.etag=void 0,e),pollCalDAV:(e,t)=>(be&&clearTimeout(be),Te?{didPoll:!1,calendars:[],message:"",error:!1}:Be(e,t)),prepareForDeleteAccount(e,t){Se.set(t.accountId,t),Be(e,[t.accountId])},doneDeleteAccount(e){Se.delete(e)},async deleteEvent(e){const t=a.Z.getEvents().find((t=>t.id===e)),n={ok:!1,eventNotFound:!1};if(!t||!navigator.onLine)return n;const i=a.Z.getCalendars().find((e=>e.id===t.calendarId));if(!i)return n;const o=a.Z.getAccounts(),{accountId:r}=i,l=o.find((e=>e.id===r));if(l?.url&&i.active){const e=await s.Z.getAuthentication(l);if("google"===l.account_type&&t.task){if(!t.uid)return n;!async function(e,t){const{oauth2Token:n}=e,i=`${(0,M.fL)()}/tasks/v1/lists/@default/tasks/${t}?key=${await(0,O.wU)()}`,s=await fetch(i,{method:"DELETE",headers:{Authorization:"Bearer "+n}}),{status:o,ok:a,statusText:r}=s;if(!a)throw b.Z.log("Calendar",["google, tasks"],"Error deleting task",o,r),Error(`Error deleting task", ${o} ${r}`)}(e,t.uid)}else if(t.href){const{href:n}=t,s=await(0,_.Z)(function(e,t,n){if(n.indexOf("/")>=0){const e=n.split("/");n=e[e.length-1]}const{url:i,username:s,password:o,oauth2Token:a}=e,r=g.parse(i),{protocol:l,host:d}=r;return l&&d?{username:s,password:o,oauth2Token:a,url:m([l+"//"+d,t,n]),method:"DELETE"}:{}}(e,i.name,n));return{ok:s.ok,eventNotFound:404===s.status}}}return n},async updateEvent(e,t,n){if(!navigator.onLine)return await N.Z.calendar.updateEvent(t.id,{syncPending:!0}),!1;const i={...t},o=a.Z.getCalendars().find((e=>e.id===i.calendarId)),r=a.Z.getAccounts();if(!o)return!1;const{accountId:l}=o,d=r.find((e=>e.id===l));if(!d)return!1;const h=await s.Z.getAuthentication(d);if("google"===d.account_type&&i.task)return await async function(e,t){const{oauth2Token:n}=e,{etag:i="",title:s,uid:o="",end:a}=t,r=`${(0,M.fL)()}/tasks/v1/lists/@default/tasks/${i}?key=${await(0,O.wU)()}`,l=V().tz(V()(a),"UTC").format(j),d={kind:"tasks#taskList",id:`${o}`,etag:`${i}`,title:`${s}`,due:l?`${l}`:void 0},c=await fetch(r,{method:"PUT",headers:{Accept:"application/json",Authorization:"Bearer "+n},body:JSON.stringify(d)}),{status:h,ok:p,statusText:u}=c;if(!p)throw b.Z.error("Calendar",["google, tasks"],"Error updating task",h,u),Error(`Error updating task", ${h} ${u}`);return await c.json()}(h,i),!0;if(i.href){const{etag:s,href:r,uid:l}=i,u={url:d.url,etag:s,href:r,uid:l},g=[i];(i.recurrenceExceptions||[]).forEach((e=>{const t=e.exception_event_id;if(t){const s=t===n?.id?n:a.Z.getEvent(t);s&&(s.recurrenceId=e.date,s.sequence=i.sequence,g.push(s))}}));const m=await(0,_.Z)(f(h,u,o.name,g,!0));let v="";const{ok:y}=m;if(!y){if(!i.href)return!1;const n=await le(h,[i.href]),{eventExceptions:s,invites:o,is_template:a,notifications:r,recurrence:l,...d}=n[0],u={...d,etag:v,syncPending:!1};await N.Z.calendar.updateEvent(t.id,u);const g=(0,p.Z)("Calendar. Error synching updates to server. Changes not saved");return b.Z.error("Calendar",["caldav"],g,t),c.Z.setStatus(e,g,5e3),!1}if(m.etag)v=he(m.etag);else{const e=await(0,_.Z)(w(h,d.url,o.name,i));v=he(e.etag||"")}return await N.Z.calendar.updateEvent(i.id,{etag:v,syncPending:!y}),y}return i.sequence=0,await Fe.createEvent(e,i),!0},async createEvent(e,t){if(!navigator.onLine)return;const n={...t,uid:t.uid||r.Z.generateGUID()},o=a.Z.getAccounts();let l=a.Z.getCalendars().find((e=>e.id===n.calendarId));if(!l)return;const{etag:d,href:c,uid:h}=n,{accountId:p}=l,u=o.find((e=>e.id===p));if(!u)return;const g={url:u.url,etag:d,href:c,uid:h},m=await s.Z.getAuthentication(u),v=l.id;if("google"===u.account_type&&n.task){const e=ge(u);if(!e.find((e=>e.id===v))){if(!(e.length>0))return void b.Z.log("Calendar",["google","tasks"],"Warning. No Google Task list found. Task not created.");l=e[0]}const t=await async function(e,t,n){const{oauth2Token:i}=e,{etag:s="",title:o,uid:a="",end:r}=n,l=[(0,M.fL)(),"/tasks/v1/lists/",t,`tasks?key=${await(0,O.wU)()}`],d=$(l),c=r?V()((0,z.VV)(new Date(r))).format(j):void 0,h={kind:"tasks#taskList",id:`${a}`,etag:`${s}`,title:`${o}`,due:c?`${c}`:void 0},p=await fetch(d,{method:"POST",headers:{Accept:"application/json",Authorization:"Bearer "+i},body:JSON.stringify(h)}),{status:u,ok:g,statusText:m}=p;if(!g)throw b.Z.error("Calendar",["google, tasks"],"Error creating task",u,m),Error(`Error creating task", ${u} ${m}`);return await p.json()}(m,l.name,n);n.etag=he(t.etag),n.uid=t.id}else{const e=await(0,_.Z)(f(m,g,l.name,[n],!1));let t="";if(n.href=decodeURIComponent(e.href||""),e.etag)t=he(e.etag);else{const e=await(0,_.Z)(w(m,u.url,l.name,n));t=he(e.etag||"")}n.etag=t}n.syncPending=!1,i.Z.updateEvent(e,n,void 0,!1)},updateCalendar:(e,t)=>new Promise(((n,i)=>{const l=a.Z.getAccounts(),d=a.Z.getCalendars().find((t=>t.id===e));if(!d)return void n();const{accountId:c}=d,h=l.find((e=>e.id===c));if(!h?.url)return void n();const p={};t.description!==d.description&&(p.description=t.description);const u=r.Z.validColor(t.color);t.color!==d.color&&u&&(p.color=u),0!==Object.keys(p).length?s.Z.getAuthentication(h).then((e=>{(0,_.Z)(function(e,t,n,i){const s=g.parse(t),{protocol:a,host:r}=s;let l="";if(a&&r){const e=a+"//"+r;l=o.Z.constructUrl([e,n])}const d=[];return i.description&&d.push(`<D:displayname>${i.description}</D:displayname>`),i.color&&d.push(`<calendar-color xmlns="http://apple.com/ns/ical/">${i.color}</calendar-color>`),{...e,url:l,method:"PROPPATCH",body:`<?xml version="1.0" encoding="UTF-8"?>\n<D:propertyupdate xmlns:D="DAV:"\nxmlns:CS="http://calendarserver.org/ns/"\nxmlns:C="urn:ietf:params:xml:ns:caldav">\n<D:set>\n<D:prop>\n${d.join("\n")}\n</D:prop>\n</D:set>\n</D:propertyupdate>`}}(e,h.url,d.name,p)).then((e=>{e.ok&&n()})).catch((e=>{i(e)}))})):n()})),async createCalendar(e,t){if("google"===e.account_type){const{name:n,description:i}=t,s=n||i||"";return await F(e,s)}return await async function(e,t){const n={message:"",status:!1,name:"",description:""},{url:i,username:o}=e,{name:a,color:r,description:l}=t,d=a||l||"",c=`${i.endsWith("/")?i:i+"/"}${d}`;let h;try{h=(await s.Z.getAuthentication(e)).password}catch(e){return n.message=e,n}const u=await fetch(c,{method:"MKCALENDAR",credentials:"omit",headers:{Accept:"text/xml",Authorization:D(o,h)},body:x(d,r)});if(u.ok){const e=await fetch(c,{method:"PROPFIND",credentials:"omit",headers:{Accept:"text/xml",Brief:"t",Depth:"1",Authorization:D(o,h)},body:'<?xml version="1.0" encoding="utf-8"?><D:propfind xmlns:D="DAV:">\n                  <D:prop><D:getetag /><D:getcontenttype /></D:prop></D:propfind>'});if(e.ok){const t=await e.text(),i=(0,T.Z)(t);if(i.d_error||i.parsererror||!i.d_multistatus)return n;i.d_multistatus.d_response.forEach((e=>{const{d_href:t}=e;n.name=t.content,n.status=!0,n.message=(0,p.Z)("Success")}))}}else 405===u.status?n.message=(0,p.Z)("Error creating Calendar. It might already exist."):n.message=(0,p.Z)("Error creating Calendar on Server");return n}(e,t)},async deleteCalendar(e,t){const{account_type:n,url:i,username:o}=e;if("google"===n){const n=a.Z.getCalendars().find((e=>e.name===t));if(!n?.supportedCalendarComponent)return{message:(0,p.Z)("Calendar not found"),status:!1};const{supportedCalendarComponent:i}=n,{vtodo:o}=i;if(o){return async function(e,t){const{oauth2Token:n}=e,i=`${(0,M.fL)()}/tasks/v1/users/@me/lists/${t}?key=${await(0,O.wU)()}`,s=await fetch(i,{method:"DELETE",headers:{Authorization:"Bearer "+n}}),{status:o,ok:a,statusText:r}=s;if(!a)throw b.Z.log("Calendar",["google, tasks"],"Error deleting Tasklist",o,r),Error(`Error deleting tasklist", ${o} ${r}`);return{status:!0,message:r}}(await s.Z.getAuthentication(e),t)}return await async function(e,t){const n=await s.Z.getAuthentication(e),{oauth2Token:i}=n,o=[(0,M.fP)(),"/v3/calendars",(a=B(t),a.endsWith("/")?a.slice(0,-1):a),`?key=${await(0,O.wU)()}`];var a;const r=L(o);return{status:(await fetch(r,{method:"DELETE",headers:{Authorization:`Bearer ${i}`,Accept:"application/json"}})).ok,message:""}}(e,t)}const r=pe(i,t),{password:l}=await s.Z.getAuthentication(e);return{status:(await fetch(r,{method:"DELETE",headers:{Depth:"infinity",Authorization:ue(o,l)}})).ok,message:""}},async getCalDAVAccountDetails(e,t){const{name:n,url:i,account_type:o,username:a,password:r}=e,l={id:"",name:n,url:i,account_type:o,username:a,interval:M.jC},d={account:l,password:r,calendars:[]};"vivaldi"===o&&(l.username=l.username.toLowerCase(),-1===a.indexOf("@")&&(l.username=`${a}@vivaldi.net`)),t((0,p.Z)("Verifying..."),ve,l);let c={statusMessage:"",foundService:!1};if("caldav"===o)c=await(0,de.k)(l,r),c.foundService?(l.url=c.url,t((0,p.Z)("Connected to CalDAV, found $1 calendar.","Connected to CalDAV, found $1 calendars.",[c.calendars.length]),fe,l)):t(c.statusMessage,ye);else if("google"===o){if(l.url=(0,M.A2)(l.username),c=await(0,de.P)(l,r),!c.foundService)return t((0,p.Z)("Could not connect. Make sure to enter a valid email address."),ye),d}else"vivaldi"===o&&(l.url=(0,M.Mf)(l.username),c=await(0,de.k)(l,r));if(!c?.foundService)return t(c.statusMessage,ye),d;const h=await s.Z.getAuthentication(l,r),u=await Oe(l,h);return u.error?(t((0,p.Z)("Error getting calendars.")+u.message,ye),d):(d.calendars=u.calendars,d)},async saveCalendarAccount(e,t){let{account:n,password:s}=e;if(!(await me(n.url,n.username,s)).result)return t((0,p.Z)("Error saving password"),ye),!1;try{const{id:e,...s}=n;n=await i.Z.createAccount(s),t((0,p.Z)("Account saved"),fe)}catch(e){return t((0,p.Z)("Error saving account:")+String(e?.message||e),ye),!1}try{await Le(e.calendars,n)}catch(e){return t((0,p.Z)("Error saving calendars:")+String(e?.message||e),ye),!1}return!0},getStatusMessageAndLog(e,t){const{status:n}=t,{name:i}=e;let s="";return ke[i]||(ke[i]={authenticationErrorCount:0}),401===n||403===n?(s=(0,p.Z)("Authentication for account '$1' failed. Check your calendar account settings.",[i]),b.Z.error("Calendar",["caldav","polling"],s)):n>=500?(s=(0,p.Z)("Server error for account '$1'.",[i]),b.Z.error("Calendar",["caldav","polling"],s,t)):-1===n?(s=(0,p.Z)("Network error for account '$1'.",[i]),b.Z.error("Calendar",["caldav","polling"],s,t)):(s=(0,p.Z)("Failed to fetch data for account '$1'.",[i]),b.Z.warn("Calendar",["caldav","polling"],s,n,t)),s}},Ue=Fe},84384:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var i=n(45660);const s=":";function o(e){return(e=e.replace(/[^0-9a-z]+([a-z]|$)/gi,((e,t)=>t.toUpperCase())))||(e=s),e}function a(e,t,n,i){let r="",l="";for(let d=0;d<e.childNodes.length;d++){const c=e.childNodes[d];if(c instanceof Element){let l=o(c.localName);const d=e.nodeType===Node.DOCUMENT_NODE||n.simplify.some((e=>c.parentNode instanceof Element&&(e.parentns===(c.parentNode.namespaceURI||"")&&e.parent===c.parentNode.localName&&e.elementns===(c.namespaceURI||"")&&e.element===c.localName))),h=c.namespaceURI||s,p=c.namespaceURI||"";l=n.prefixes&&n.prefixes.hasOwnProperty(h)?n.prefixes[h]+"_"+l:p+":"+l,r=l;const u={attributes:{}};for(let e=0;e<c.attributes.length;e++){const t=c.attributes[e];let i=o(t.localName);const a=t.namespaceURI||s,r=t.namespaceURI||"";i=n.prefixes&&n.prefixes.hasOwnProperty(a)?n.prefixes[a]+"_"+i:r+":"+i,u.attributes[i]=t.nodeValue}a(c,u,n,i),d?t[l]?(i.simplifyerror=!0,t.simplifyerror||(t.simplifyerror={}),t.simplifyerror[l]instanceof Array||(t.simplifyerror[l]=[]),t.simplifyerror[l].push(u)):t[l]=u:(t[l]instanceof Array||(t[l]=[]),t[l].push(u))}else c.nodeType!==Node.TEXT_NODE&&c.nodeType!==Node.CDATA_SECTION_NODE||(l+=c.nodeValue)}return e.nodeType===Node.ELEMENT_NODE&&(t.content=l.replace(/^\s+$/,"")),r}function r(e,t){const n=(new DOMParser).parseFromString(e,"text/xml");if(!n||n.getElementsByTagNameNS("http://www.w3.org/1999/xhtml","parsererror").length)return{parsererror:!0,root:"",simplifyerror:!1};const i={prefixes:(t||{}).prefixes||{[s]:""},simplify:(t||{}).simplify||[]},o={parsererror:!1,root:"",simplifyerror:!1};return o.root=a(n,o,i,o),o.root||(o.parsererror=!0),o}const l="DAV:",d="urn:ietf:params:xml:ns:caldav",c="http://calendarserver.org/ns/",h={prefixes:{":":"",[l]:"d",[d]:"c",[c]:"cs"},simplify:[{parentns:d,parent:"calendar-home-set",elementns:l,element:"href"},{parentns:d,parent:"calendar-multiget",elementns:l,element:"prop"},{parentns:d,parent:"calendar-query",elementns:d,element:"filter"},{parentns:d,parent:"calendar-query",elementns:l,element:"prop"},{parentns:d,parent:"comp-filter",elementns:d,element:"comp-filter"},{parentns:l,parent:"current-user-principal",elementns:l,element:"href"},{parentns:d,parent:"filter",elementns:d,element:"comp-filter"},{parentns:l,parent:"multistatus",elementns:l,element:"sync-token"},{parentns:l,parent:"prop",elementns:d,element:"calendar-data"},{parentns:l,parent:"prop",elementns:d,element:"calendar-home-set"},{parentns:l,parent:"prop",elementns:l,element:"current-user-principal"},{parentns:l,parent:"prop",elementns:l,element:"displayname"},{parentns:l,parent:"prop",elementns:c,element:"getctag"},{parentns:l,parent:"prop",elementns:l,element:"getetag"},{parentns:l,parent:"prop",elementns:l,element:"resourcetype"},{parentns:l,parent:"prop",elementns:d,element:"supported-calendar-component-set"},{parentns:l,parent:"prop",elementns:l,element:"sync-token"},{parentns:l,parent:"propfind",elementns:l,element:"prop"},{parentns:l,parent:"propstat",elementns:l,element:"prop"},{parentns:l,parent:"propstat",elementns:l,element:"status"},{parentns:l,parent:"resourcetype",elementns:l,element:"calendar"},{parentns:l,parent:"resourcetype",elementns:l,element:"collection"},{parentns:l,parent:"response",elementns:l,element:"href"},{parentns:l,parent:"response",elementns:l,element:"status"},{parentns:d,parent:"sync-collection",elementns:l,element:"prop"},{parentns:l,parent:"sync-collection",elementns:c,element:"sync-level"},{parentns:l,parent:"sync-collection",elementns:c,element:"sync-token"}]};function p(e){const t=r(e,h);return Array.isArray(t?.d_multistatus?.d_response)&&(t.d_multistatus.d_response=t.d_multistatus.d_response.map((e=>{if(!Array.isArray(e.d_propstat))return e;const t=e.d_propstat.filter((e=>{var t;return-1!==(t=e.d_status,Array.isArray(t)?t[0]:t).content.indexOf("200")})),n=t.reduce(((e,t)=>e.d_prop?(e.d_prop=Object.assign(e.d_prop,t.d_prop),e):Object.assign(e,t)),{});return e.d_propstat=n,e}))),t.d_error&&(i.Z.error("Calendar",["caldav"],"caldavtojson error",t),t.parsererror=!0),t}},64877:(e,t,n)=>{"use strict";function i(e){return{...e,headers:{Depth:1},method:"PROPFIND",body:'<?xml version="1.0" encoding="UTF-8"?>\n    <D:propfind xmlns:D="DAV:"\n      xmlns:CS="http://calendarserver.org/ns/">\n      <D:prop>\n        <D:getetag />\n        <D:displayname />\n        <CS:getctag />\n        <D:resourcetype />\n        <supported-calendar-component-set xmlns="urn:ietf:params:xml:ns:caldav" />\n        <supported-address-data xmlns="urn:ietf:params:xml:ns:carddav" />\n        <xmpp-uri xmlns="http://calendarserver.org/ns/" />\n        <calendar-color xmlns="http://apple.com/ns/ical/" />\n        <D:supported-report-set />\n        <D:sync-token />\n      </D:prop>\n    </D:propfind>'}}function s(){return'<?xml version="1.0" encoding="utf-8"?>\n    <D:propfind xmlns:D="DAV:">\n      <D:prop>\n        <D:current-user-principal />\n        <D:resourcetype xmlns:D="DAV:" />\n      </D:prop>\n    </D:propfind>'}function o(){return'<?xml version="1.0" encoding="utf-8"?>\n    <D:propfind xmlns:D="DAV:">\n      <D:prop>\n        <D:displayname />\n        <schedule-inbox-URL xmlns="urn:ietf:params:xml:ns:caldav" />\n        <schedule-outbox-URL xmlns="urn:ietf:params:xml:ns:caldav" />\n        <calendar-user-address-set xmlns="urn:ietf:params:xml:ns:caldav" />\n        <default-calendar-URL xmlns="http://icewarp.com/ns/" />\n        <default-tasks-URL xmlns="http://icewarp.com/ns/" />\n        <default-contacts-URL xmlns="http://icewarp.com/ns/" />\n        <default-notes-URL xmlns="http://icewarp.com/ns/" />\n        <calendar-home-set xmlns="urn:ietf:params:xml:ns:caldav" />\n        <addressbook-home-set xmlns="urn:ietf:params:xml:ns:carddav" />\n        <D:resourcetype xmlns:D="DAV:" />\n        <supported-calendar-component-set xmlns="urn:ietf:params:xml:ns:caldav" />\n      </D:prop>\n    </D:propfind>'}n.d(t,{ZP:()=>i,P_:()=>s,sp:()=>o})},23796:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(1712),s=n(84384),o=n(45660);function a(e){const t=(0,s.Z)(e),n=[];return t.d_error?(o.Z.error("Calendar",["caldav"],"Parser error",t.d_error),[]):t.parsererror||!t.d_multistatus?[]:(t.d_multistatus.d_response.forEach((e=>{const{d_href:t,d_propstat:s}=e,{content:o}=t,{d_prop:a}=s,{d_displayname:r,cs_getctag:l,d_syncToken:d,d_supportedReportSet:c,c_calendarColor:h}=a,p=r?r.content:"";let u="";u=h||a["http://apple.com/ns/ical/:calendarColor"];const g=u?u[0].content:"#",m={vevent:!1,vjournal:!1,vtodo:!1};if(a.c_supportedCalendarComponentSet){const{c_comp:e}=a.c_supportedCalendarComponentSet;m.vevent=e.some((e=>"VEVENT"===e.attributes._name)),m.vtodo=e.some((e=>"VTODO"===e.attributes._name))}let v=!1;c&&c[0].d_supportedReport&&c[0].d_supportedReport.forEach((e=>{e.d_report.forEach((e=>{e.d_syncCollection&&(v=!0)}))}));const f=l?l.content:"",y=d?d.content:"",{vevent:w,vtodo:b}=m;if(w||b){const e={syncToken:decodeURIComponent(y),supportsSyncCollection:v,ctag:decodeURIComponent(f),description:p,name:decodeURIComponent(o),color:"#"===g?i.Z.getCalendarCreateColor():g,supportedCalendarComponent:m};n.push(e)}})),n)}},8687:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(34929),s=n(87265);const{basicHttpAuthenticationHeader:o}=s.Z;async function a(e,t){const{username:n,password:s,body:a,method:r,contentType:l,oauth2Token:d,headers:c,href:h}=e;t||(t=e.url);const p={};p.Authorization=d?`Bearer  ${d}`:o(n,s);try{const e=await fetch(t,{method:r,credentials:"omit",headers:{...c,...p,"Content-Type":l||"application/xml; charset=utf-8"},body:a}),{status:s,ok:o}=e,u=e.headers.get("etag")||"",g={href:h,response:await e.text(),etag:u,status:s,ok:o};return o?g:(401===s&&d&&i.Z.resetRefreshTokenAndFetchNew(n),{etag:"",response:"",status:s,ok:o})}catch(e){return{etag:"",response:"",status:-1,ok:!1}}}},88545:(e,t,n)=>{"use strict";n.d(t,{P:()=>w,k:()=>f});var i=n(34929),s=n(87265),o=n(55351),a=n(8575),r=n(56371),l=n(84384),d=n(64877),c=n(45660);var h=n(23796);var p=n(8687),u=n(7064),g=n(24522);const{basicHttpAuthenticationHeader:m,concatUrl:v}=s.Z;async function f(e,t){const n={foundService:!1,url:"",calendars:[],eventCount:0,statusMessage:""},{username:i,url:s}=e,o=s,u=await y(e,t);if(!u.continueDiscovery)return n.statusMessage=u.message,n;const{userPrincipal:f,isCalendarUrl:w}=u;if(f&&!e.url.endsWith(f))e.url=v(e.url,f);else{const o=await async function(e,t,n){const i=e&&a.parse(e).host||"",s=(0,g.II)(i);return new Promise(((i,o)=>{const l=new XMLHttpRequest;l.open("GET",s,!0,t,n),l.setRequestHeader("Authorization",m(t,n)),l.onload=()=>{if(404===l.status)return void i({continueDiscovery:!1,redirectedUrl:"",message:(0,r.Z)("Service not found.")});if(401===l.status||403===l.status)return void i({continueDiscovery:!1,redirectedUrl:"",message:(0,r.Z)("Authentication error. Check your credentials and try again.")});const t=a.parse(l.responseURL),n=a.parse(e);t.href===n.href||i({continueDiscovery:!1,redirectedUrl:t.href,message:""})},l.onerror=()=>{i({continueDiscovery:!0,redirectedUrl:"",message:(0,r.Z)("Network error looking up calendars.")})},l.send(null)}))}(s,i,t);if(!o.continueDiscovery)return n.statusMessage=o.message||(0,r.Z)("CalDAV service not found: $1",[e.url]),n;if(o.redirectedUrl){e.url=o.redirectedUrl;const{userPrincipal:n}=await y(e,t);n&&!e.url.endsWith(n)&&(e.url=v(e.url,n))}}const b=await async function(e,t){const{username:n,url:i}=e,s=await fetch(i,{method:"PROPFIND",credentials:"omit",headers:{"Content-Type":"text/xml;charset=UTF-8",Authorization:m(n,t),Brief:"t",Depth:"0"},body:(0,d.sp)()});if(s.ok){const e=await s.text(),t=function(e){const t=(0,l.Z)(e),n={calendarHomeSet:"",errorMsg:""};if(t.d_error)return n.errorMsg="Error parsing calendar HomeSet",n;if(!t.parserror){if(!t.d_multistatus)return n.errorMsg="Error parsing calendar HomeSet",n;t.d_multistatus.d_response.forEach((e=>{const{d_propstat:t}=e,{d_prop:i}=t,{c_calendarHomeSet:s}=i;if(!s)return;const o=s.d_href.content;n.calendarHomeSet=o}))}return n}(e);if(t.calendarHomeSet)return t.calendarHomeSet;c.Z.warn("Calendar","Error fetching homeset",s.status,e)}return""}(e,t);if(!b){const i=await async function(e,t){const{username:n,url:i}=e,s=await fetch(i,{method:"PROPFIND",credentials:"omit",headers:{"Content-Type":"text/xml;charset=UTF-8",Authorization:m(n,t),Brief:"t",Depth:"1"},body:(0,d.sp)()});if(s.ok){const e=await s.text();return(0,h.Z)(e)}c.Z.warn("Calendar","Error fetching url's",s.status,await s.text());return[]}(e,t);if(i.length)return n.calendars=i,n.foundService=!0,n.url=e.url,n}if(w)n.foundService=!0,e.url=o;else{if(!b)return n.url=o,n.foundService=!1,n.statusMessage=(0,r.Z)("No calendars found. Please try different URL."),n;e.url=v(e.url,b),n.foundService=!0}const C={...e,oauth2Token:"",password:t},S=await(0,p.Z)((0,d.ZP)(C),e.url),T=(0,h.Z)(S.response);return T.length&&(n.calendars=T,n.foundService=!0,n.url=e.url),n}async function y(e,t){const{username:n,url:i}=e,s={authenticated:!1,userPrincipal:"",continueDiscovery:!1,message:"",isCalendarUrl:!1};try{const e=await fetch(i,{method:"PROPFIND",credentials:"omit",headers:{Brief:"t",Depth:"0","Content-Type":"text/xml;charset=UTF-8",Authorization:m(n,t)},body:(0,d.P_)()}),{status:o,ok:a}=e;if(a)o>=200&&o<=299&&(s.authenticated=!0);else{if(401===o)return s.message=(0,r.Z)("Authentication error"),s;if(404===o)return s.message=(0,r.Z)("CalDAV service not found"),s.continueDiscovery=!0,s;if(405===o)return s.continueDiscovery=!0,s}const c=await e.text(),h=(0,l.Z)(c);if(h.d_error||!h.d_multistatus)return s.message=(0,r.Z)("Parser error"),s.continueDiscovery=!0,s;const p=function(e){let t="";const n=(0,l.Z)(e);return!n.parsererror&&"d_multistatus"===n.root&&n.d_multistatus.d_response&&n.d_multistatus.d_response.forEach((e=>{if(e?.d_propstat?.d_prop?.d_currentUserPrincipal){const{d_href:n}=e.d_propstat.d_prop.d_currentUserPrincipal;t=n.content}else e?.d_href?.content&&(t=e.d_href.content)})),t}(c);p&&(s.userPrincipal=p,s.continueDiscovery=!0)}catch{s.message=(0,r.Z)("CalDAV service not found: $1",[e.url])}return s}async function w(e,t){const{account_type:n,username:s,url:a}=e,{urlValid:l}=u.Z.utilities.isUrlValid(a),c={url:a,calendars:[],eventCount:0,foundService:!1,statusMessage:""};if(!l)return{statusMessage:(0,r.Z)("Invalid URL"),...c};let g;try{g="google"===n?await i.Z.getAuthentication(e):{oauth2Token:"",id:"",name:"",url:a,username:"vivaldi"===n?s.toLowerCase():s,password:t}}catch(e){return Promise.resolve(c)}try{const t=await(0,p.Z)((0,d.ZP)(g),a);if(!t.ok){const n=o.Z.getStatusMessageAndLog(e,t);return{...c,statusMessage:n}}const n=(0,h.Z)(t.response);return{...c,foundService:!0,calendars:n}}catch(e){return e.status&&i.Z.resetRefreshTokenAndFetchNew(g.username),{...c,statusMessage:e.statusText}}}},9141:(e,t,n)=>{"use strict";n.d(t,{F:()=>c});var i=n(61757),s=n(29194),o=n(15489),a=n(45660),r=n(7064),l=n(23750),d=n(90870);async function c(e,t){const n=o.ZP.getId(),c=new Set(e.flatMap((e=>(e.recurrenceExceptions??[]).map((e=>e.exception_event_id))))),p=e.map((e=>{const n=t.find((t=>t.uid===e.uid&&function(e,t){if(!h(e,t))return!0;const[n,i]=(0,d.Z)(t.eventExceptions||[],(e=>!e.exception_event)),[o,a]=(0,d.Z)(e.recurrenceExceptions||[],(e=>e.cancelled));if(i.length!==a.length||n.length!==o.length)return!0;const r=n.some((e=>!o.some((t=>t.date===e.exception.exceptionDate))));if(r)return!0;const l=new Set(a.map((e=>e.exception_event_id))),c=s.Z.getEvents().filter((e=>l.has(e.id))),p=i.some((e=>!c.some((t=>h(t,e.exception_event)))));if(p)return!0;return!1}(e,t)));return n&&!c.has(e.id)?(0,l.KU)(n,e):null})).filter(Boolean),u=p.filter((e=>e.eventExceptions?.length));!function(e,t,n){const o=n.flatMap((e=>e.recurrenceExceptions||[]));t.forEach((t=>{t.eventExceptions&&t.eventExceptions.forEach((async n=>{const a=o.find((e=>{if(e&&e.parent_event_id===t.id&&e.date===n.exception.exceptionDate)return!0})),l=a?.exception_event_id&&s.Z.getEvent(a.exception_event_id);if(l&&n.exception_event){const{eventExceptions:e,invites:i,notifications:s,is_template:o,...a}=n.exception_event;a.calendarId=t.calendarId,await r.Z.calendar.updateEvent(l.id,a)}if(!a){const{exceptionDate:s,cancelled:o}=n.exception;if(!s)return;if(!n.exception_event||o)return void i.Z.createException(t.id,"0",!0,s);const{start:a,end:l,title:d,description:c}=n.exception_event,{uid:h,id:p,rrule:u,eventExceptions:g,recurrence:m,alarmId:v,filteredOut:f,recurrenceExceptions:y,trash:w,trash_time:b,attachment:C,invites:S,notifications:T,recurrenceId:I,...k}=t;if(!a||!l)return;k.start=a,k.end=l,k.title=d,k.description=c;const A=await i.Z.createEvent(e,{...k,is_template:!1},!1);i.Z.createException(p,A.id,!1,s),r.Z.calendar.updateEvent(t.id,{sequence:t.sequence,etag:t.etag})}}))}))}(n,u,e);try{await Promise.all(p.map((async e=>await i.Z.updateEvent(n,e))))}catch(e){a.Z.error("Calendar",["caldav"],"Error updating event",e)}return p.length}function h(e,t){return!!t&&((t.etag??"")===(e.etag??"")&&(t.sequence??0)===(e.sequence??0)&&t.title===e.title&&(t.description??"")===(e.description??"")&&(t.start??0)===e.start&&(t.end??t.start??0)===e.end&&!!t.complete==!!e.complete&&!!t.allDay==!!e.allDay&&(t.recurrence?.toString()??"")===(e.recurrence?.toString()??"")&&(t.organizer??"")===(e.organizer??"")&&(t.location??"")===(e.location??"")&&(t.url??"")===(e.url??""))}},79706:(e,t,n)=>{"use strict";n.d(t,{Z:()=>C});var i=n(61757),s=n(34929),o=n(87265),a=n(1712),r=n(29194),l=n(56371),d=n(15805),c=n(7064),h=n(24522),p=n(23750);function u(e,t){return e.filter((e=>e.UID&&!t.has(e.UID)))}function g(e,t){const n=new Set;return t.forEach((e=>{e.recurrenceExceptions&&e.recurrenceExceptions.forEach((e=>{n.add(e.exception_event_id)}))})),t.filter((t=>!e.some((e=>{const i=t.uid===e.UID,s=n.has(t.id);return i||!t.uid&&s}))))}function m(e,t){return e.filter((e=>e.UID&&t.has(e.UID)))}var v=n(9141);const{basicHttpAuthenticationHeader:f}=o.Z;let y=null;async function w(e,t,n){const i={};t&&n&&(i.Authorization=f(t,n));const s={...i,Accept:"text/calendar"};return await fetch(e,{headers:s})}const b={probeWebCalendar:async(e,t)=>{const{url:n,username:i}=e;let s=0;const o={url:n,calendars:[],eventCount:0,foundService:!1,statusMessage:""},{urlValid:r}=c.Z.utilities.isUrlValid(n);if(!r)return{...o,statusMessage:(0,l.Z)("Invalid URL $1",[n])};try{const r=await w(n,i,t),{status:c,statusText:h}=r;if(c>=200&&c<300){const t=await r.text();let i;try{i=(0,d.Z)(t)}catch(e){return{...o,statusMessage:(0,l.Z)("No Web Calendar found: $1",[n])}}y={url:n,timestamp:Date.now(),calendarData:i};const c={name:e.name,description:(i["X-WR-CALNAME"]||"").trim(),color:a.Z.getCalendarCreateColor(),ctag:"",supportedCalendarComponent:{vevent:!0,vtodo:!1,vjournal:!1},supportsSyncCollection:!1,syncToken:"",active:!0};return s=i.VEVENT.length,{...o,foundService:!0,calendars:[c],eventCount:s,statusMessage:(0,l.Z)("Success")}}return 401===c||403===c?{...o,statusMessage:(0,l.Z)("Not authorized, check your username and password. $1",[h])}:404===c?{...o,statusMessage:(0,l.Z)("Calendar not found, check your URL. $1",[h])}:{...o,statusMessage:(0,l.Z)("Not connected. $1",[h])}}catch(e){return{...o,statusMessage:(0,l.Z)("Error $1",e.message)}}},fetchAndCreate:async e=>{const{url:t}=e;if(!t)throw"Url missing";const n={numberOfCalendarsPolled:1,numberOfChangedCalendars:0};let o;if(y&&y.url===t&&y.timestamp+5*h.lb>Date.now())o=y.calendarData;else{let n="",i="";try{const t=await s.Z.getAuthentication(e);n=t.username,i=t.password}catch(e){}const a=await w(t,n,i);if(200!==a.status)throw`Fetch remote calendar. Status code: ${a.status}`;const r=await a.text();o=(0,d.Z)(r)}y=null;const a=(o["X-WR-CALNAME"]||e.name).trim(),l=await b.getCalendar(e,a),{id:c}=l,v=o.VEVENT,f=r.Z.getEventsPerCalendar(c),{create:C,deleteEvents:S,update:T}=function(e,t){const n=new Set(t.map((e=>e.uid)).filter(Boolean));return{create:u(e,n),deleteEvents:g(e,t),update:m(e,n)}}(v,f);(C.length||S.length)&&(n.numberOfChangedCalendars=1),S.reduce((async(e,t)=>e.then((()=>i.Z.deleteEvent(t.id)))),Promise.resolve()),await(0,p.nj)(C,l.id,"");return await b.updateEvents(T,l.id)&&(n.numberOfChangedCalendars=1),n},getCalendar:(e,t)=>new Promise(((n,s)=>{const o=r.Z.getCalendars().filter((t=>t.accountId===e.id)),l=o.find((t=>t.accountId===e.id));if(l)n(l);else{const s={name:t,description:t,accountId:e.id,active:!0,color:a.Z.getCalendarCreateColor()};i.Z.createCalendar(s,!1,!0).then((e=>{e.calendar&&n(e.calendar)}))}})),updateEvents:async(e,t)=>{const n=e.map((e=>(0,p.rP)(e,{},t))),i=r.Z.getEventsPerCalendar(t);return(0,v.F)(i,n)}},C=b},74400:(e,t,n)=>{"use strict";n.d(t,{RO:()=>i,ES:()=>s,Vl:()=>o});const i=e=>e.replace(/\\\\|\\;|\\,|\\[Nn]/g,(e=>{switch(e){case"\\\\":return"\\";case"\\;":return";";case"\\,":return",";case"\\n":case"\\N":return"\n";default:return e}})),s=e=>e.replace(/\\|;|,|\r\n|\n/g,(e=>{switch(e){case"\\":return"\\\\";case";":return"\\;";case",":return"\\,";case"\r\n":case"RN":case"\n":case"N":return"\\n";default:return e}}));function o(e,t,n){let i=!1;if(n&&n<2)return[e];n=n||1/0;const s=[0];for(let o=0;o<e.length;o++){const a=e[o];if('"'===a)0!==o&&"\\"===e[o-1]||(i=!i);else if(a===t&&!i&&(s.push(o+1),s.length>=n))break}return 1===s.length?[e]:s.map(((t,n)=>{const i=s[n+1];return e.slice(t,i?i-1:i)}))}},15805:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var i=n(45660),s=n(24522),o=n(74400);function a(e){try{if(e.startsWith('"')&&e.endsWith('"'))return e.slice(1,-1)}catch(t){i.Z.error("Calendar",["parser"],"Parsing error in stripQuotes",e,t)}return e}const r=e=>{const t={};for(;e.length>1;){const n=e.shift(),[i,d]=(0,o.Vl)(n,":",2);if(void 0===d)throw new Error(`Error parsing iCal line: "${n}". Value not found.`);const[c,h]=i.split(/;(.*)/,2),p=h?(0,o.Vl)(h,";").reduce(((e,t)=>{const[n,i]=t.split("=");return e[n]=a(i),e}),{}):{};switch(c){case"BEGIN":const i=d;let o=r(e);switch(t[i]&&(o=[].concat(t[i],o)),i){case"VEVENT":case"VTODO":case"VJOURNAL":case"VALARM":case"VTIMEZONE":case"STANDARD":case"DAYLIGHT":t[i]=Array.isArray(o)?o:[o];break;default:t[i]=o}break;case"END":return t;case"RECURRENCE-ID":case"DTSTART":case"DTEND":case"DTSTAMP":case"DUE":d.match(/^\d{8}$/)&&(p.VALUE="DATE"),d.endsWith("Z")?p.TZID="UTC":p.TZID||(p.TZID=s.$T),t[c]={value:d,params:p};break;case"ATTENDEE":t[c]=(t[c]||[]).concat([{value:l(d),params:p}]);break;case"EXDATE":d.indexOf(",")>=0?t[c]=d.split(",").map((e=>({value:e,params:p}))):t[c]=(t[c]||[]).concat([{value:d,params:p}]);break;case"ORGANIZER":t[c]={value:l(d),params:p};break;case"URL":t[c]={value:d,params:p};break;case"ATTACH":t[c]=t[c]?[t[c],n].join("\r\n"):n;break;case"UID":case"CLASS":case"CREATED":case"DESCRIPTION":case"GEO":case"LAST-MODIFIED":case"LOCATION":case"PRIORITY":case"SEQUENCE":case"STATUS":case"SUMMARY":case"TRANSP":case"X-WR-CALNAME":t[c]=d;break;default:t[c]?t[c]=[].concat(t[c]||[],d):t[c]=d}}return t},l=e=>e.toLowerCase().startsWith("mailto:")?e.substr(7):e,d=e=>{const t=(e=>{const t=e.split(/\r\n|\n|\r/).filter((e=>""!==e.trim())),n=[];let i="";for(;t.length>0;){const e=t.shift();" "===e[0]||"\t"===e[0]?i+=e.substr(1):(i&&n.push(i),i=e.trim())}return i&&n.push(i),n})(e),n=r(t);if(!n.VCALENDAR)return{VEVENT:[],VTODO:[],VJOURNAL:[]};if(n.VCALENDAR.VEVENT){const e=n.VCALENDAR.VEVENT.reduce(((e,t)=>{const n=e.findIndex((e=>e.UID===t.UID));return-1===n?e.push({UID:t.UID,VEVENT:[t]}):e[n].VEVENT.push(t),e}),[]).reduce(((e,t)=>{const n=t.VEVENT.reduce(((e,t)=>(t["RECURRENCE-ID"]?e.EXCEPTIONS?e.EXCEPTIONS.push(t):e.EXCEPTIONS=[t]:e={...e,...t},e)),{});return e.push(n),e}),[]);n.VCALENDAR.VEVENT=e}else n.VCALENDAR.VEVENT=[];return{...n.VCALENDAR}}},23750:(e,t,n)=>{"use strict";n.d(t,{rP:()=>L,nj:()=>B,CJ:()=>F,WJ:()=>W,KU:()=>R,tP:()=>U,J9:()=>V,Uq:()=>O});var i=n(61757),s=n(34929),o=n(1712),a=n(29194),r=n(15800),l=n(22616),d=n(5646),c=n(45660),h=n(28773),p=n(80008),u=n.n(p),g=n(8687),m=n(15805),v=n(87265),f=n(8575);const{constructUrl:y}=v.Z;var w=n(24522),b=n(74400),C=n(39190),S=n(58821);const T=(0,n(23542).extendMoment)(u());function I(e){const t=["BEGIN:VCALENDAR","PRODID:-Vivaldi Calendar V1.0//EN","VERSION:2.0","CALSCALE:GREGORIAN","DTSTAMP:"+T.tz().format(w.FI)],n=e.VEVENT.map((e=>function(e){const t=e=>e?e.map((e=>{const t=["BEGIN:VALARM"];for(const n in e)t.push(`${n}:${e[n]}`);return t.push("END:VALARM"),t})).flat():[""];let n=["BEGIN:VEVENT"];for(const i in e)switch(i){case"VALARM":const s=t(e[i]);n=[...n,...s];break;case"ATTENDEE":n.push(Z(i,e[i]));break;case"ORGANIZER":n.push(A(i,e[i]));break;case"DTSTART":case"DTSTAMP":case"DTEND":n.push(k(i,e[i]));break;default:n.push(`${i}:${e[i]}`)}return n.push("END:VEVENT\r\n"),n.join("\r\n")}(e)));t.push("");let i=t.join("\r\n");return n.forEach((e=>{i+=e})),r.Z.foldIcal(i+"END:VCALENDAR\r\n")}function k(e,t){if(!t)return"";const{params:n}=t;return"DATE"===n.VALUE?`${e};VALUE=DATE:${t.value}`:`${e}:${t.value}`}function A(e,t){if(!t)return"";const n=[],{value:i,params:s}=t;for(const e in s)n.push(`${e}=${s[e]}`);return`${e};${n.join("=")}:mailto:${i}`}function Z(e,t){const n=[],i=[];return t?(t.forEach((t=>{const{value:s,params:o}=t;for(const e in o)n.push(`${e}=${o[e]}`);const a=`${n.join(";")}`,r=`mailto:${s}`;i.push(`${e};${a}:${r}`)})),i.join("\r\n")):""}var E=n(47543);const{setImportProgress:_}=l.Z,{createLocalAccountAndCalendar:N}=o.Z;let M;function P(e,t){return t&&t!==w.$T?u().tz(e,t):u()(e)}function D(e){if(u().tz.names().includes(e)||e===w.$T)return e;const t=(0,S.EP)(),n=(0,C.findIana)(e);return t&&n&&n.includes(t)?t:n&&n.length?n[0]:""}function x(e){return"DATE"===e.params.VALUE?w.GL:w.L9}function O(e,t){const n=t??e?.params.TZID,i=x(e),{value:s}=e;if(n===w.$T){const e=u().tz(s,i,"UTC").toDate();return(0,S.FL)(e).valueOf()}return n?u().tz(s,i,n).valueOf():u()(s,i).valueOf()}const L=(e,t={},n)=>{let i=[],s=[];const o={title:""},r=["SUMMARY","LOCATION","DESCRIPTION"];Object.keys(e).forEach((t=>{r.indexOf(t)>=0&&"string"==typeof e[t]&&("SUMMARY"===t?o.title=(0,b.RO)(e[t]):o[t.toLowerCase()]=(0,b.RO)(e[t]))})),e.EXCEPTIONS&&(i=e.EXCEPTIONS.map((e=>{const i=L(e,t,n),s=e["RECURRENCE-ID"];if(s&&s.value){const e=O(s),{recurrence:t,...n}=i;return{exception:{cancelled:!1,exceptionDate:e},exception_event:n}}})).filter(Boolean)),e.ATTENDEE&&(s=e.ATTENDEE.map((e=>({name:e.params.CN||"",address:e.value,partstat:e.params.PARTSTAT||"NEEDS-ACTION"}))));let l,d=!1,c=0;const p=e.DTSTART&&D(e.DTSTART.params.TZID);e.DTSTART&&e.DTSTART.value&&("DATE"===e.DTSTART.params.VALUE&&(d=!0),c=O(e.DTSTART,p));const g=e.DTEND&&D(e.DTEND.params.TZID);if(e.DTEND&&e.DTEND.value&&(l=O(e.DTEND,g)),e.DURATION){l=c+u().duration(e.DURATION).asMilliseconds()}let m=[];e.VALARM&&(m=e.VALARM.map((t=>{const{TRIGGER:n=""}=t;return{when:-u().duration(n).asMilliseconds(),name:e.SUMMARY||""}})));let v=e.LOCATION;"string"!=typeof v&&(v="");let f={};const y=e.DUE&&D(e.DUE.params.TZID);e.DUE&&("DATE"===e.DUE.params.VALUE&&(d=!0),f={end:O(e.DUE,y)}),e.EXDATE&&e.EXDATE.forEach((e=>{const t=x(e),n=D(e.params.TZID),s=n?u().tz(e.value,t,n):u()(e.value,t);i.push({exception:{cancelled:!0,exceptionDate:s.valueOf()}})}));const C=e.URL&&e.URL.value;if(c&&l){const e=P(c,p),t=P(l,g),n=e.startOf("day").valueOf()===c,i=t.startOf("day").valueOf()===l,s=1===t.diff(e,"d");n&&i&&s&&(d=!0)}let S=!1;e.STATUS&&(S="COMPLETED"===e.STATUS);const T=e.RRULE?.match(/UNTIL=(\d{8}T\d{6}Z)/);if(T&&"DATE"===e.DTSTART?.params.VALUE){const t=`UNTIL=${u()(T[1]).add(12,"hour").format(w.O5)}`;e.RRULE=e.RRULE?.replace(/UNTIL=\d{8}T\d{6}Z/,t)}return{...o,recurrence:e.RRULE?(0,E.Qj)(e.RRULE,c,p):void 0,url:C,start:c,end:l,...(0,h.Z)(f),timezone:p||y,allDay:d,is_recurring:!!e.RRULE,calendarId:n||(a.Z.getDefaultCalendar()?.id??""),href:t.href,etag:t.etag,uid:e.UID?e.UID:"",organizer:e.ORGANIZER&&e.ORGANIZER.value,notifications:m,sequence:parseInt(e.SEQUENCE)||0,...(0,h.Z)(i.length>0?{eventExceptions:i}:null),...(0,h.Z)(s.length>0?{invites:s}:null),attachment:e.ATTACH,is_template:!1,complete:S}};function R(e,t){const{is_template:n,...i}=e,s=function(e,t){if(e.invites)return e.invites.map((e=>{const n=t.invites&&t.invites.find((t=>t.address===e.address));return{...e,id:n?.id||"",event_id:n?.event_id||""}}))}(e,t),o=function(e,t){if(!e.notifications)return t.notifications;const n=t.notifications;if(!n)return e.notifications.map((e=>({...e,id:"",event_id:t.id})));const i=e.notifications.filter((e=>!n.some((t=>t.when===e.when)))).map((e=>({...e,id:"",event_id:t.id})));return[...n,...i]}(e,t);return{...i,attachment:r.Z.stringToAttachments(e.attachment),...(0,h.Z)(s?{invites:s}:null),...(0,h.Z)(o?{notifications:o}:null),id:t.id,start:e.start||0,end:e.end||0}}const B=(e,t,n)=>{if(0===e.length)return Promise.resolve();const s=[[]];let o=0,a=0;e.forEach((e=>{100===o&&(s[++a]=[],o=0),s[a].push(L(e,{},t)),o++})),i.Z.stopAPIChangeListeners();let r=0;return new Promise(((t,o)=>{s.reduce(((t,s)=>t.then((()=>i.Z.createEvents(s).then((t=>{r+=t.created_count,_("Calendar",n,r,e.length),i.Z.loadPromise()}))))),Promise.resolve()).then((e=>{t()})).catch((e=>{c.Z.error("Calendar",["import"],e),o(e)})).finally((e=>{i.Z.startAPIChangeListeners(),d.Z.updateAllAlarms()}))}))};function F(e,t,n){return _("Calendar",n,0,t.length),B(t,e,n).catch((e=>{c.Z.error("Calendar",["import"],e)}))}async function U(e,t,n){const{calendarId:o,createNew:l,newCalendarName:h}=n,p=(0,m.Z)(t).VEVENT;if(_("Calendar",n.newCalendarName,0,p.length),l){const{calendar:e}=await N(null,{name:"",description:h,accountId:""});if(!e)return _("Calendar",n.newCalendarName,0,p.length),void c.Z.error("Calendar",["import"],"Error creating calendar.");await F(e.id,p,h)}else{const n=a.Z.getAccountForCalendar(o),l=a.Z.getCalendars().find((e=>e.id===o));if(!n||!l)return;const{account_type:d}=n;if("caldav"===d||"vivaldi"===d||"google"===d){const o=(0,m.Z)(t),a=o.VEVENT,{VEVENT:d,...c}=o,h=[];a.forEach((e=>{const t=I({...c,VEVENT:[e]});h.push(t)})),h.forEach((async e=>{const t=await s.Z.getAuthentication(n);await(0,g.Z)(function(e,t,n){const i=e.url,s=r.Z.generateGUID(),{username:o,password:a,oauth2Token:l}=e,d=f.parse(i);let c="";const{protocol:h,host:p}=d;let u="";if(!h||!p||!s)return{};const g=h+"//"+p;return u="/"+y([t,s])+".ics",c=y([g,u]),{username:o,password:a,oauth2Token:l,headers:{"If-None-Match":"*"},url:c,href:u,method:"PUT",contentType:"text/calendar; charset=utf-8",body:n}}(t,l.name,e))})),i.Z.pollCalDAVAccounts(e,[n.id])}else await F(o,p,h)}d.Z.updateAllAlarms()}const V=(e,t)=>new Promise(((n,i)=>{Promise.all(M.map((async n=>{const{name:i}=n,s=t.get(i);if(!s)return;const o=await n.getFile(),a=await o.text();return U(e,a,s)}))).then((()=>{n()})).catch((e=>{c.Z.warn("Calendar",["import"],e),i(e)}))})),W=async()=>{try{M=await window.showOpenFilePicker({multiple:!0,types:[{description:"iCalendar",accept:{"text/*":[".ics",".txt"]}}]})}catch(e){console.error(e)}return M}},47543:(e,t,n)=>{"use strict";n.d(t,{z3:()=>c,_7:()=>h,Qj:()=>p,Zm:()=>u,yu:()=>g,EE:()=>m,YE:()=>v,qh:()=>f,_v:()=>y,v1:()=>w,IK:()=>C,QX:()=>T});var i=n(45660),s=n(5264),o=n.n(s),a=n(30381),r=n.n(a),l=n(82191),d=n(58821);const c=[l.Ci.MO,l.Ci.TU,l.Ci.WE,l.Ci.TH,l.Ci.FR,l.Ci.SA,l.Ci.SU];function h(e){const t=c[(e+6)%7];if(!t)throw new Error("Invalid weekday number");return t}function p(e,t,n){try{const i=t?(0,d.VV)(new Date(t),n):void 0;return(0,l.SA)(e,{dtstart:i})}catch(t){i.Z.warn("Calendar",["parser"],"Error parsing rrule string",e,t)}}function u(e){let{dtstart:t,until:n}=e;return t=t&&(0,d.VV)(t),n=n&&(0,d.VV)(n),new l.Ci({...e,dtstart:t,until:n})}function g(e,t){let{dtstart:n,until:i}=t;return n=n?(0,d.VV)(n):e.origOptions.dtstart,t.hasOwnProperty("until")?i&&(i=(0,d.VV)(i)):i=e.origOptions.until&&(0,d.FL)(e.origOptions.until),new l.Ci({...e.origOptions,...t,dtstart:n,until:i})}function m(e,t){function n(e){return e.weeks()-e.clone().startOf("month").weeks()}function i(e,t,n){const i="number"==typeof n?n:n.weekday,s=c[((i+e)%7+7)%7];if(!s)throw new Error("Weekday not found. Should not happen.");return s&&n.hasOwnProperty("n")&&"number"==typeof n.n?s.nth(n.n+t):s}if(!e?.dtstart)return{freq:1};const s=(0,d.FL)(e.dtstart),o=r()(s),a=r()(s).add(t,"millisecond"),l=a.diff(o,"day");if(!l)return e;const h=n(a)-n(o),{byweekday:p,bymonthday:u}=e;return p?Array.isArray(p)?e.byweekday=p.map((e=>i(l,h,e))):e.byweekday=i(l,h,p):u&&(Array.isArray(u)?e.bymonthday=u.map((e=>o.clone().date(e).add(l,"day").date())):"number"==typeof u&&(e.bymonthday=o.clone().date(u).add(l,"day").date())),e}const v=o()(250)((function(e,t,n,i){const s=p(e);return s?s.between((0,d.VV)(new Date(t),i),(0,d.VV)(new Date(n),i),!0).map((e=>(0,d.FL)(e,i))):[]}));function f(e,t,n,i,s){return e.between((0,d.VV)(t,s),(0,d.VV)(n,s),!0,((e,t)=>t<i)).map((e=>(0,d.FL)(e,s)))}function y(e,t,n,i){const s=e.before((0,d.VV)(t,n),i);return s instanceof Date?(0,d.FL)(s):null}function w(e){const{bymonthday:t}=e.origOptions;return t?Array.isArray(t)?t:[t]:[]}function b(e){return"number"==typeof e?e:e.weekday}function C(e){const{byweekday:t}=e.origOptions;return t?Array.isArray(t)?t.map(b):[b(t)]:[]}function S(e){return"number"==typeof e?new l.OG(e):e}function T(e){const{byweekday:t}=e.origOptions;return t?Array.isArray(t)?t.map(S):[S(t)]:[]}},69417:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var i,s=n(67294),o=n(94184),a=n.n(o),r=n(86088),l=n(48521);function d(e,t,n,s){i||(i="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=s;else if(a>1){for(var r=new Array(a),l=0;l<a;l++)r[l]=arguments[l+3];t.children=r}if(t&&o)for(var d in o)void 0===t[d]&&(t[d]=o[d]);else t||(t=o||{});return{$$typeof:i,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class c extends s.PureComponent{inputRef=s.createRef();componentDidMount(){if(this.props.focusInput&&this.inputRef.current){const e=this.inputRef.current;e.focus(),e.setSelectionRange(0,e.value.length)}}componentDidUpdate(e){if(!e.focusInput&&this.props.focusInput&&this.inputRef.current){const e=this.inputRef.current;e.focus(),e.setSelectionRange(0,e.value.length)}}render(){const{placeholder:e="",label:t,labelImportant:n,style:i,isVerified:s,hasError:o,focusInput:c,...h}=this.props,p=a()({"floating-label":!0,verified:s&&!this.props.disabled});let u;return t&&(u=d(n?"strong":"span",{},void 0,t)),d("label",{className:p,style:i},void 0,u,"textarea"!==h.type?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("input",{...h,ref:this.inputRef,className:"floating-input",type:this.props.type,placeholder:e}),o&&!this.props.disabled&&d("span",{className:"error",dangerouslySetInnerHTML:{__html:r.viW}})]}):(0,l.jsx)("textarea",{...h,ref:this.inputRef,className:"floating-input",placeholder:e}))}}const h=c},63377:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var i,s=n(67294),o=n(29087),a=n(94283),r=n(89175),l=n(48521),d=n(34155);function c(e,t,n,s){i||(i="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=s;else if(a>1){for(var r=new Array(a),l=0;l<a;l++)r[l]=arguments[l+3];t.children=r}if(t&&o)for(var d in o)void 0===t[d]&&(t[d]=o[d]);else t||(t=o||{});return{$$typeof:i,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class h extends s.PureComponent{static contextType=a.Z;focusRef=s.createRef();constructor(e,t){super(e),this._lastFocused=t.document.activeElement}componentDidMount(){this._getFocusable(),(0===o.Z.get(r.kKeyboardTabToAll)||this.props.forceTrap)&&this.focus()}componentWillUnmount(){const{document:e}=this.context;this.focusRef?.current?.contains(e.activeElement)&&d.nextTick((()=>{"BODY"===e.activeElement?.tagName&&this._lastFocused?.focus()})),delete this._focusable}_getFocusable=()=>{const{HTMLElement:e}=this.context,t=this.focusRef.current;let n;t instanceof e&&(n=t.querySelectorAll(`a[href]:not([tabindex='-1']),\n        button:not([disabled],[disabled=true],[tabindex='-1']),\n        input:not([disabled],[disabled=true],[tabindex='-1'],[hidden]),\n        select:not([disabled],[disabled=true],[tabindex='-1']),\n        textarea:not([disabled],[disabled=true],[tabindex='-1']),\n        p[contenteditable]:not([tabindex='-1']),\n        [tabindex]:not([tabindex='-1'],.${this.props.focusName})`)),this._focusable=n};focus=()=>{this.focusRef?.current?.contains(this.context.document.activeElement)||(this.props.forceTrap?this.focusRef?.current?.focus():this._focusable?.length&&this._focusable[0].focus())};isFocusOrigin=e=>Boolean(e.relatedTarget instanceof this.context.HTMLElement&&this.focusRef?.current?.contains(e.relatedTarget)&&this.focusRef?.current!==e.relatedTarget);handleTopFocus=e=>{if(this._getFocusable(),this._focusable&&this._focusable.length>0){const t=this._focusable[0],n=this._focusable[this._focusable.length-1];if(!t||!n)return;this.isFocusOrigin(e)?n.focus():t.focus()}};handleBottomFocus=e=>{if(this._focusable&&this._focusable.length>0){const t=this._focusable[0],n=this._focusable[this._focusable.length-1];if(!t||!n)return;this.isFocusOrigin(e)?t.focus():n.focus()}};render(){const{children:e,focusName:t,forceTrap:n,...i}=this.props,s=n?0:null;return n||!0===o.Z.get(r.kWebpagesFocusTrap)?(0,l.jsxs)("div",{...i,ref:this.focusRef,tabIndex:s,children:[c("span",{tabIndex:"0",className:t,onFocus:this.handleTopFocus}),e,c("span",{tabIndex:"0",className:t,onFocus:this.handleBottomFocus})]}):(0,l.jsx)("div",{...i,ref:this.focusRef,tabIndex:s,children:e})}}const p=h},52250:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(67294),s=n(46884),o=n(48521);function a(e){return(0,i.forwardRef)((function(t,n){if("function"==typeof n)throw Error("Callback refs not supported");const[a,r]=(0,i.useState)(!1),l=(0,i.useCallback)((()=>r(!1)),[]),d=(0,i.useCallback)((()=>r(!0)),[]),c=(0,i.useRef)(null),h=n||c,p=(0,i.useCallback)((()=>{const e=h.current?.getNode();return e instanceof Element?e:null}),[h]),u=(0,i.useCallback)((()=>h.current?h.current.handleClickOutside:null),[h]),{disableOnClickOutside:g,eventTypes:m,outsideClickIgnoreClass:v,...f}=t;return(0,s.Z)(p,u,v,g||a,m),(0,o.jsx)(e,{...f,ref:h,enableOnClickOutside:l,disableOnClickOutside:d})}))}},81009:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(67294),s=n(14507),o=n(48521);const a=function(e,t){return i.forwardRef(((n,i)=>{const a=(0,s.Z)(t);return(0,o.jsx)(e,{...n,ref:i,prefValues:a})}))}},5298:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=Object.freeze({KEY_CANCEL:3,KEY_HELP:6,KEY_BACK_SPACE:8,KEY_TAB:9,KEY_CLEAR:12,KEY_RETURN:13,KEY_ENTER:14,KEY_SHIFT:16,KEY_CONTROL:17,KEY_ALT:18,KEY_PAUSE:19,KEY_CAPS_LOCK:20,KEY_ESCAPE:27,KEY_SPACE:32,KEY_PAGE_UP:33,KEY_PAGE_DOWN:34,KEY_END:35,KEY_HOME:36,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_PRINTSCREEN:44,KEY_INSERT:45,KEY_DELETE:46,KEY_0:48,KEY_1:49,KEY_2:50,KEY_3:51,KEY_4:52,KEY_5:53,KEY_6:54,KEY_7:55,KEY_8:56,KEY_9:57,KEY_SEMICOLON:59,KEY_EQUALS:61,KEY_A:65,KEY_B:66,KEY_C:67,KEY_D:68,KEY_E:69,KEY_F:70,KEY_G:71,KEY_H:72,KEY_I:73,KEY_J:74,KEY_K:75,KEY_L:76,KEY_M:77,KEY_N:78,KEY_O:79,KEY_P:80,KEY_Q:81,KEY_R:82,KEY_S:83,KEY_T:84,KEY_U:85,KEY_V:86,KEY_W:87,KEY_X:88,KEY_Y:89,KEY_Z:90,KEY_META:91,KEY_CONTEXT_MENU:93,KEY_NUMPAD0:96,KEY_NUMPAD1:97,KEY_NUMPAD2:98,KEY_NUMPAD3:99,KEY_NUMPAD4:100,KEY_NUMPAD5:101,KEY_NUMPAD6:102,KEY_NUMPAD7:103,KEY_NUMPAD8:104,KEY_NUMPAD9:105,KEY_MULTIPLY:106,KEY_ADD:107,KEY_SEPARATOR:108,KEY_SUBTRACT:109,KEY_DECIMAL:110,KEY_DIVIDE:111,KEY_F1:112,KEY_F2:113,KEY_F3:114,KEY_F4:115,KEY_F5:116,KEY_F6:117,KEY_F7:118,KEY_F8:119,KEY_F9:120,KEY_F10:121,KEY_F11:122,KEY_F12:123,KEY_F13:124,KEY_F14:125,KEY_F15:126,KEY_F16:127,KEY_F17:128,KEY_F18:129,KEY_F19:130,KEY_F20:131,KEY_F21:132,KEY_F22:133,KEY_F23:134,KEY_F24:135,KEY_NUM_LOCK:144,KEY_SCROLL_LOCK:145,KEY_COMMA:188,KEY_PERIOD:190,KEY_SLASH:191,KEY_BACK_QUOTE:192,KEY_OPEN_BRACKET:219,KEY_BACK_SLASH:220,KEY_CLOSE_BRACKET:221,KEY_QUOTE:222})},76632:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var i,s=n(67294),o=n(64473),a=n(56551),r=n(56371),l=n(94184),d=n.n(l),c=n(67074);function h(e,t,n,s){i||(i="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=s;else if(a>1){for(var r=new Array(a),l=0;l<a;l++)r[l]=arguments[l+3];t.children=r}if(t&&o)for(var d in o)void 0===t[d]&&(t[d]=o[d]);else t||(t=o||{});return{$$typeof:i,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class p extends s.Component{constructor(e){super(e),this.state={selectedIndex:this.props.initialSelectedIndex||(this.props.items.length>0?0:-1),isCreating:!1,showDeleteConfirmation:!1}}componentDidUpdate(e){this.props.items.length!==e.items.length&&this.cancelRemoval()}onSelectItem=e=>{this.setState({selectedIndex:e})};onCreateItem=e=>{this.setState({isCreating:!0}),"function"==typeof this.props.onCreateItem&&this.props.onCreateItem(e)};onCancelCreate=e=>{this.setState({isCreating:!1}),"function"==typeof this.props.onCancelCreateItem&&this.props.onCancelCreateItem()};considerRemovingItem=()=>{this.setState({showDeleteConfirmation:!0})};cancelRemoval=()=>{this.setState({showDeleteConfirmation:!1})};renderContentElement=(e,t,n,i)=>{if(!e||t)return i(n);const s=e&&n&&function(e,t){let n=!1;const i={...t};for(const s of Object.keys(t)){const o=t[s];o.toLowerCase().includes(e)&&(i[s]=(0,c.CH)(o,e),n=!0)}return n?i:null}(e,n);return e&&!s?null:i(s||n)};render(){const{items:e,masterLayout:t}=this.props,n=this.state.selectedIndex,i=null!=n&&e[n];let s;const l=(this.props.title||this.props.subtitle||"").toLowerCase().includes(this.props.filter)?"":this.props.filter,p=!l||e.some((e=>"string"==typeof e.name&&e.name.toLowerCase().includes(l)));if((this.state.isCreating||this.props.isCreating)&&this.props.renderCreate?s=this.renderContentElement(l,p,this.props.createStrings?this.props.createStrings:this.props.contentStrings,this.props.renderCreate.bind(this)):i?s=this.renderContentElement(l,p,this.props.contentStrings,this.props.renderContent.bind(this,n)):this.props.renderEmpty&&(s=this.renderContentElement(l,p,this.props.emptyStrings?this.props.emptyStrings:this.props.contentStrings,this.props.renderEmpty.bind(this))),!s&&!p)return null;const{className:u=""}=this.props;return h("div",{className:u+" master-detail-wrapper"},void 0,this.props.title&&h("h2",{},void 0,(0,c.CH)(this.props.title,this.props.filter)),this.props.subtitle&&h("h3",{},void 0,(0,c.CH)(this.props.subtitle,this.props.filter)),h("div",{className:u+" master-detail",style:this.props.style},void 0,this.state.showDeleteConfirmation&&i&&this.props.deleteDialog&&h(o.Z,{onRequestClose:this.cancelRemoval,viewMode:"slide"},void 0,this.props.deleteDialog({account:i,onClose:this.cancelRemoval})),this.state.showDeleteConfirmation&&i&&this.props.deleteTitle&&h(o.Z,{onRequestClose:this.cancelRemoval,viewMode:"slide"},void 0,h("header",{className:"dialog-header"},void 0,h("h1",{className:"dialog-title"},void 0,this.props.deleteTitle)),h("div",{className:"dialog-content"},void 0,h("p",{className:"error"},void 0,(0,r.Z)("Are you sure you would like to delete “$1”?",[this.props.isChain?i.label:i.name]))),h("footer",{className:"dialog-footer"},void 0,h("input",{type:"button",className:"danger",value:(0,r.Z)("verb","Delete"),onClick:"function"==typeof this.props.onRemove?this.props.onRemove.bind(this,n):null}),h("input",{type:"button",value:(0,r.Z)("Cancel"),autoFocus:!0,onClick:this.cancelRemoval}))),h("div",{className:d()({master:!0,"master-layout-double":0===t,"master-layout-single":1===t})},void 0,h(a.Z,{items:e,emptyListGraphic:this.props.emptyListGraphic,emptyListString:this.props.emptyListString,renderListItem:this.props.renderListItem,onSelectItem:this.onSelectItem,onCreateItem:this.onCreateItem,isCreating:this.props.isCreating,moveItem:this.props.moveItem,onRemove:this.props.onRemove,filter:this.props.filter,selectedIndex:this.state.selectedIndex,onContextMenu:this.props.onContextMenu,onActivate:this.props.onActivate,onCancelCreate:this.onCancelCreate,addTipString:this.props.addTipString,considerRemovingItem:this.considerRemovingItem,deleteTipString:this.props.deleteTipString,supportDragAndDrop:this.props.supportDragAndDrop,mimeType:this.props.mimeType?this.props.mimeType.toString():void 0,isChain:this.props.isChain,renderCreateListItem:this.props.renderCreateListItem})),s))}}const u=p},56551:(e,t,n)=>{"use strict";n.d(t,{Z:()=>y});var i,s=n(67294),o=n(84451),a=n(94283),r=n(56371),l=n(94184),d=n.n(l),c=n(1407),h=n(67074),p=n(13302),u=n(86088),g=n(48521),m=n(34155);function v(e,t,n,s){i||(i="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=s;else if(a>1){for(var r=new Array(a),l=0;l<a;l++)r[l]=arguments[l+3];t.children=r}if(t&&o)for(var d in o)void 0===t[d]&&(t[d]=o[d]);else t||(t=o||{});return{$$typeof:i,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class f extends s.Component{static contextType=a.Z;dropSupport=!1;moveUpCombo=(0,p.$)("alt+up");moveDownCombo=(0,p.$)("alt+down");refItems=s.createRef();constructor(e){super(e),this.state={selectedIndex:this.props.selectedIndex||(this.props.items.length>0?0:-1),isCreating:!1,dropIndex:-1,dropPosition:""}}componentWillUnmount(){this.clearDndTimer()}componentDidUpdate(e){if(e.items.length!==this.props.items.length){let t=-1;if(this.props.items.length>0)if(0===e.items.length)t=0;else if(this.props.items.length>e.items.length){const n=this.props.items.filter((({key:t})=>!e.items.some((({key:e})=>e===t))));t=this.props.items.indexOf(n[0])}else-1!==this.state.selectedIndex&&(t=Math.min(this.state.selectedIndex,this.props.items.length-1),t===this.props.items.length-1&&this.focusItem(t));this.setSelected(t,!1)}e.isCreating!==this.props.isCreating&&this.props.isCreating&&this.setIsCreating()}setSelected=(e,t)=>{void 0!==t&&(this.setState({isCreating:this.props.onCancelCreate&&t}),t&&this.props.onCreateItem?this.props.onCreateItem():!t&&this.props.onCancelCreate&&this.props.onCancelCreate()),this.setState({selectedIndex:e}),"function"==typeof this.props.onSelectItem&&this.props.onSelectItem(e)};loadItemAt=e=>{this.setSelected(e),m.nextTick((()=>{const e=this.refItems.current;if(e){const t=e.querySelector(".item-selected");t&&t.focus()}}))};setIsCreating=()=>{this.setSelected(this.props.items.length,!0),m.nextTick((()=>{const e=this.refItems.current;e&&(e.scrollTop=e.scrollHeight)}))};removeItem=e=>{e>=this.props.items.length?("function"==typeof this.props.onCancelCreate&&this.props.onCancelCreate(),this.setSelected(this.props.items.length-1,!1)):"function"==typeof this.props.considerRemovingItem?this.props.considerRemovingItem():"function"==typeof this.props.onRemove&&this.props.onRemove(this.state.selectedIndex)};moveDown=()=>{this.props.moveItem&&this.props.items&&this.props.items.length>1&&this.state.selectedIndex+1<this.props.items.length&&(this.props.moveItem(this.state.selectedIndex,this.state.selectedIndex+1),this.loadItemAt(this.state.selectedIndex+1))};moveUp=()=>{this.props.moveItem&&this.props.items&&this.props.items.length>1&&this.state.selectedIndex>0&&(this.props.moveItem(this.state.selectedIndex,this.state.selectedIndex-1),this.loadItemAt(this.state.selectedIndex-1))};focusItem=(e,t)=>{if(this.state.isCreating||this.props.isCreating)return;this.state.selectedIndex!==e&&this.loadItemAt(e);const n=this.refItems.current;n&&n.focus(),t&&t.stopPropagation()};onDoubleClick=(e,t)=>{this.props.onActivate&&this.props.onActivate(e,t),t.stopPropagation()};clearDndTimer=()=>{this.dndTimerId&&(clearTimeout(this.dndTimerId),delete this.dndTimerId)};onDragStartButton=(e,t)=>{this.props.supportDragAndDrop&&this.props.mimeType&&(t.dataTransfer.effectAllowed="move",t.dataTransfer.setData(this.props.mimeType,e))};onDragEnter=e=>{this.props.supportDragAndDrop&&this.props.mimeType&&(e.preventDefault(),e.stopPropagation(),this.dropSupport=e.dataTransfer.types.some((e=>e===this.props.mimeType)),e.dataTransfer.dropEffect=this.dropSupport?"move":"none")};onDragLeave=e=>{this.props.supportDragAndDrop&&(e.preventDefault(),e.stopPropagation(),this.clearDndTimer(),this.dndTimerId=setTimeout((()=>{delete this.dndTimerId,this.setState({dropIndex:-1,dropPosition:""})}),c._p))};getDropPosition=e=>{let t=0;const n=e.currentTarget.getBoundingClientRect(),i=n.height;return t=(e.clientY-n.top)/i,t<=.5?"above":"below"};onDragOverButton=(e,t)=>{if(t.preventDefault(),t.stopPropagation(),this.dropSupport){t.dataTransfer.dropEffect="move",this.clearDndTimer();const n=this.getDropPosition(t);this.state.dropIndex===e&&this.state.dropPosition===n||this.setState({dropIndex:e,dropPosition:n})}};onDragOver=e=>{if(e.preventDefault(),e.stopPropagation(),this.dropSupport){e.dataTransfer.dropEffect="move",this.clearDndTimer();const t=this.props.items.length>0?this.props.items.length-1:0,n="below";this.state.dropIndex===t&&this.state.dropPosition===n||this.setState({dropIndex:t,dropPosition:n})}};onDropButton=(e,t)=>{if(t.preventDefault(),t.stopPropagation(),this.dropSupport&&this.props.mimeType){const n=t.dataTransfer.getData(this.props.mimeType);if(void 0!==n){let i=e+("below"===this.getDropPosition(t)?1:0);n<i&&(i-=1),this.props.moveItem&&(this.props.moveItem(n,i),this.loadItemAt(i))}}this.setState({dropIndex:-1,dropPosition:""})};onDrop=e=>{if(e.preventDefault(),e.stopPropagation(),this.dropSupport&&this.props.mimeType){const t=e.dataTransfer.getData(this.props.mimeType);if(void 0!==t){let e=this.props.items.length;t<e&&(e-=1),this.props.moveItem&&(this.props.moveItem(t,e),this.loadItemAt(e))}}this.setState({dropIndex:-1,dropPosition:""})};onDragEnd=()=>{this.setState({dropIndex:-1,dropPosition:""})};onKeyDown=e=>{const t=o.Z.keyComboFromEvent(e.nativeEvent);if("tab"!==t&&this.props.items&&this.props.items.length>0){let n=!0;const i=this.props.items.length;switch(t){case"up":this.loadItemAt(this.state.selectedIndex<=0?i-1:this.state.selectedIndex-1);break;case"down":this.loadItemAt(this.state.selectedIndex+1>=i?0:this.state.selectedIndex+1);break;case"del":case"backspace":this.removeItem(this.state.selectedIndex);break;case"home":this.loadItemAt(0);break;case"end":this.loadItemAt(i-1);break;case"alt+up":this.moveUp();break;case"alt+down":this.moveDown();break;case"enter":case"space":this.props.onActivate&&(this.props.onActivate(this.state.selectedIndex,e),n=!1);break;default:n=!1}n&&e.preventDefault()}};getButtonClassByIndex=e=>d()({item:!0,"item-is-static":this.props.items[e].isStatic,"item-default":this.props.items[e].isDefault,"item-selected":e===this.state.selectedIndex&&!(this.state.isCreating||this.props.isCreating),dragoverAbove:e===this.state.dropIndex&&"above"===this.state.dropPosition,dragoverBelow:e===this.state.dropIndex&&"below"===this.state.dropPosition});render(){const{isChain:e,items:t,filter:n,emptyListGraphic:i,emptyListString:s}=this.props,{selectedIndex:o}=this.state,a=this.state.isCreating||this.props.isCreating,l=null!=o&&t[o],d=!!l&&t[o].isDefault,c=0===t.length&&!a,p=t[o]?.isStatic;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("div",{ref:this.refItems,className:"master-items",onDragEnter:this.onDragEnter,onDragLeave:this.onDragLeave,onDragOver:this.onDragOver,onDrop:this.onDrop,onKeyDown:this.onKeyDown,tabIndex:c?-1:0,children:[c&&i&&s&&v("div",{className:"master-items-empty",dangerouslySetInnerHTML:{__html:`${i}<div>${s}</div>`}}),t.map(((t,i)=>v("button",{type:"button",title:e?t.label:t.name,className:this.getButtonClassByIndex(i),tabIndex:-1,draggable:this.props.supportDragAndDrop,onContextMenu:this.props.onContextMenu?this.props.onContextMenu.bind(this,i):null,onDragStart:this.onDragStartButton.bind(this,i),onDragEnter:this.onDragEnter,onDragLeave:this.onDragLeave,onDragOver:this.onDragOverButton.bind(this,i),onDrop:this.onDropButton.bind(this,i),onDragEnd:this.onDragEnd,onMouseDown:this.focusItem.bind(this,i),onDoubleClick:this.onDoubleClick.bind(this,i)},i,this.props.renderListItem((0,h.CH)(t.name,n),t)))),"function"==typeof this.props.renderCreateListItem&&a&&this.props.renderCreateListItem()&&v("button",{className:"item item-selected"},void 0,this.props.renderCreateListItem())]}),(this.props.optionsList||this.props.onRemove||this.props.moveItem)&&v("div",{className:"master-toolbar"},void 0,this.props.optionsList&&v("select",{className:"button-toolbar sortable-list-options",onChange:this.props.onCreateItem,title:this.props.addTipString,defaultValue:null},void 0,this.props.optionsList&&this.props.optionsList.map((e=>v("option",{value:e.key},e.key,e.value,""!==e.key&&` [${e.key}]`)))),this.props.onRemove&&(0,g.jsxs)(g.Fragment,{children:[v("button",{className:"button-toolbar",style:this.props.optionsList?{pointerEvents:"none"}:null,tabIndex:this.props.optionsList?-1:null,title:this.props.addTipString,onClick:this.setIsCreating,disabled:this.props.onCancelCreate&&a,dangerouslySetInnerHTML:{__html:u.md4.medium}}),v("button",{className:"button-toolbar",title:this.props.deleteTipString,onClick:this.removeItem.bind(this,o),disabled:!a&&t.length<1||d||p||l&&!1===t[o].isRemovable,dangerouslySetInnerHTML:{__html:u.M2k.medium}})]}),this.props.moveItem&&(0,g.jsxs)(g.Fragment,{children:[v("button",{className:"button-toolbar button-move-up",title:(0,r.Z)("Move Up ($1)",[this.moveUpCombo]),onClick:this.moveUp,disabled:p,dangerouslySetInnerHTML:{__html:u.OCp.medium}}),v("button",{className:"button-toolbar button-move-down",title:(0,r.Z)("Move Down ($1)",[this.moveDownCombo]),onClick:this.moveDown,disabled:p,dangerouslySetInnerHTML:{__html:u.yaZ.medium}})]}))]})}}const y=f},20676:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var i=n(76747),s=n(63353),o=n(14481),a=n(32921),r=n(26036),l=n(35369),d=n(36436);const c=[1,2,5,10,30],h=(e,t,n)=>{const h=s.Z.getPageByReloadId(e);if("tab"===t&&h&&(0,d.xl)(h.url))return[];const p=a.Z.existingAlarms(),u=a.Z.getAlarmFromReloadId(e),g=c.map((i=>({type:"checkbox",checked:u?.periodInMinutes===i,handler:()=>{const r="panel"===t?"panel":"tab";let c;if("stack"===t&&n)c=s.Z.getGroup(e,n).filter((e=>!(0,d.xl)(e.url)));else if("select"===t&&n)c=s.Z.getSelectedPages(n).filter((e=>!(0,d.xl)(e.url)));else{if("tab"!==t){const t={alarm:u,id:e,interval:i,from:r};return void o.Z.createOrDestroyAlarm(t)}c=l.aV.of(h)}c.forEach((e=>{const t=e?.vivExtData.ext_id;if(t){const e={alarm:a.Z.getAlarmFromReloadId(t),id:t,interval:i,from:r};o.Z.createOrDestroyAlarm(e)}}))},commandName:"PERIODIC_RELOAD",parameter:i.toString(),...(0,r.Z)("$1 Minute","$1 Minutes",[i])})));return[...g,...[i.Z.separatorItem,{visible:Boolean(u?.id.includes(e)),handler:()=>{o.Z.destroyPeriodicAlarm(e)},commandName:"PERIODIC_RELOAD_DISABLE",parameter:"",...(0,r.Z)("timer","Disable")},{visible:p,handler:o.Z.destroyAllPeriodicAlarms,commandName:"PERIODIC_RELOAD_DISABLE",parameter:"all",...(0,r.Z)("timers","Disable All")}]]},p={getForActivePage:e=>{const t=s.Z.getActivePage(e),n=t?t.vivExtData.ext_id:void 0;return n?h(n,"tab"):[]},getMenu:h,getHandlerByAction:(e,t,n)=>{let i;switch(t){case"PERIODIC_RELOAD":const t=s.Z.getActivePage(e),r=t?t.vivExtData.ext_id:"";if(r){const e=a.Z.getAlarmFromReloadId(r),t=parseInt(n);i=()=>o.Z.createOrDestroyAlarm({alarm:e,id:r,interval:t,from:"tab"})}break;case"PERIODIC_RELOAD_DISABLE":if("all"===n)i=o.Z.destroyAllPeriodicAlarms;else{const t=s.Z.getActivePage(e),n=t?t.vivExtData.ext_id:"";n&&(i=()=>o.Z.destroyPeriodicAlarm(n))}}return i}}},73132:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o,g:()=>s});var i=n(78614);const s="/resources/contact-person.png";function o(e){const t={toString:function(){return(0,i.gU)(this)},isEmpty:function(){return!(this.name||0!==this.emailAddresses.length||this.birthday||this.note||0!==this.postalAddresses.length||0!==this.phonenumbers.length||this.avatarUrl)},clearGenerated:function(){this.isGeneratedFromSentMail&&(this.isGeneratedFromSentMail=!1)}};return Object.assign(Object.create(t),e)}},64473:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var i,s=n(63377),o=n(84451),a=n(67294),r=n(94283),l=n(52250),d=n(48521);function c(e,t,n,s){i||(i="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=s;else if(a>1){for(var r=new Array(a),l=0;l<a;l++)r[l]=arguments[l+3];t.children=r}if(t&&o)for(var d in o)void 0===t[d]&&(t[d]=o[d]);else t||(t=o||{});return{$$typeof:i,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}var h=c("div",{className:"modal-faded-background"});class p extends a.Component{static contextType=r.Z;focusTrapRef=a.createRef();modalRef=a.createRef();componentDidMount(){this.props.ignoreEscape||o.Z.bind("meta+.",this.closeModalHandler)}componentWillUnmount(){this.props.ignoreEscape||o.Z.unbind("meta+.",this.closeModalHandler)}getNode(){return this.modalRef.current}closeModalHandler=()=>{this.props.onRequestClose()};handleClickOutside=e=>{this.props.ignoreClick&&!e.target.closest(".window-close")||this.props.onRequestClose(e)};keyDownModal=e=>{"Escape"!==e.key||this.props.ignoreEscape||(e.preventDefault(),this.props.onRequestClose(e.nativeEvent))};renderBackground=()=>h;render(){const e="float"===this.props.viewMode;return(0,d.jsxs)(d.Fragment,{children:[e&&this.renderBackground(),(0,d.jsx)(s.Z,{focusName:"focus_modal",forceTrap:!0,id:"modal-bg",ref:this.focusTrapRef,className:this.props.viewMode?this.props.viewMode:"slide",style:this.props.dialogWidth&&{width:this.props.dialogWidth,minWidth:"unset"},children:(0,d.jsx)("div",{onKeyDown:this.keyDownModal,ref:this.modalRef,children:this.props.children})})]})}}const u=(0,l.Z)(p)},46884:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(94283),s=n(67294);const o=["mousedown","touchstart"];function a(e,t,n="ignore-react-onclickoutside",a=!1,r=o){const{document:l,Element:d}=(0,s.useContext)(i.Z);(0,s.useEffect)((()=>{if(!a)return r.forEach((e=>l.addEventListener(e,i))),()=>{r.forEach((e=>l.removeEventListener(e,i)))};function i(i){const s=e(),o=t();if(!s||!o)return;let a=i.target;for(;a instanceof d;){const e=a;if(Array.isArray(n)){if(n.some((t=>e.classList.contains(t))))return}else if(e.classList.contains(n))return;a=a.parentNode}i.target instanceof d&&!s.contains(i.target)&&o(i)}}),[d,a,l,t,e,n,r])}},4668:(e,t,n)=>{"use strict";n.d(t,{BZ:()=>o,Ve:()=>a,JX:()=>r,up:()=>c});var i=n(83784),s=n(92292);function o(e){return e.replace(/["~*\/:<>?\\|\p{Cc}\p{Cf}]+/gu," ").replace(/^[ .]+|[ .]+$/g,"")}function a(e,t){d(l(e),o(e.filename),t)}function r(e){const t=l(e),n=o(e.filename);return{suggestedFilename:n,url:t,request:{deny:()=>URL.revokeObjectURL(t),allow:e=>d(t,n,e)}}}function l(e){const t=c(e);return URL.createObjectURL(t)}function d(e,t,n){s.Z.downloads.download({url:e,filename:t,saveAs:"saveas"===n},(t=>{URL.revokeObjectURL(e),"open"===n&&i.Z.addOpenAfterDownload(t)}))}function c(e){const t=e.content,n=e.mimeType;return new Blob([t],{type:n})}},88630:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var i=n(62366),s=n(29087),o=n(7064),a=n(85834),r=n(70611),l=n(89175),d=n(78614);function c(e){let t="text/calendar; charset=utf-8",n="";"string"==typeof e.content&&(n=(0,a.tV)(e.content),"string"!=typeof n&&(n=""));const s=n.match(/METHOD:\s*(\w+)/);s&&(t+=`; method=${s[1]}`);const o=new i.Z(t);return o.setContent(n),o}const h={build:async function(e,t,n){let a;const h=await(0,r.iT)(t),p=n.filter((e=>(e.mimeType.startsWith("multipart/")&&(e.mimeType="application/octet-stream"),"application/ics"===e.mimeType)));if("string"==typeof h){const e=new i.Z("text/plain; charset=utf-8");e.setContent(h),p.length?(a=new i.Z("multipart/alternative"),a.appendChild(e),a.appendChild(c(p[0]))):a=e}else{const e=(0,r.yy)(t);a=new i.Z("multipart/alternative");const s=new i.Z("text/plain; charset=utf-8");s.setContent(e),a.appendChild(s);const o=n.filter((e=>e.id)),l=new i.Z("text/html; charset=utf-8");if(l.setContent(t),o.length>0){const e=new i.Z("multipart/related");e.appendChild(l),o.forEach((t=>e.createChild(t.mimeType,{filename:t.filename,isEncoded:"string"==typeof t.content}).setContent(t.content).setHeader("Content-Disposition","inline").setHeader("Content-Id",t.id))),a.appendChild(e)}else a.appendChild(l);p.length&&a.appendChild(c(p[0]))}const u=n.filter((e=>!e.id));let g;return u.length>0?(g=new i.Z("multipart/mixed"),g.appendChild(a),u.forEach((e=>{const t=g.createChild(e.mimeType,{filename:e.filename,isEncoded:"string"==typeof e.content});t.setHeader("Content-Disposition","attachment"),t.setContent(e.content)}))):g=a,g.addHeader("message-id","<"+e.messageId+">"),g.addHeader("from",(0,d.Rz)(e.from)),g.addHeader("to",(0,d.Rz)(e.to)),g.addHeader("cc",(0,d.Rz)(e.cc)),g.addHeader("subject",e.subject),g.addHeader("date",new Date(e.sentDate).toUTCString().replace(/GMT/,"+0000")),e.inReplyTo&&e.inReplyTo.length>0&&g.addHeader("in-reply-to","<"+e.inReplyTo+">"),e.references&&e.references.length>0&&g.addHeader("references","<"+e.references.join("> <")+">"),s.Z.get(l.kMailIncludeIdentifyingHeaders)&&(g.addHeader("X-Mailer","Vivaldi Mail"),g.addHeader("User-Agent",`Vivaldi Mail/${o.Z.utilities.getVersion().mailVersion}`)),g.build()}}},13933:(e,t,n)=>{"use strict";let i;n.d(t,{Z:()=>s});const s={get:function(){return i},set:function(e){i=e}}},36943:(e,t,n)=>{"use strict";n.d(t,{Z:()=>Z});var i=n(21754),s=n(68884),o=n(9185),a=n(98611),r=n(29087),l=n(56371),d=n(78347),c=n(48868),h=n(61472),p=n(95752),u=n(45660),g=n(68906),m=n(20570),v=n(35458),f=n(5204),y=n(5863),w=n(6129),b=n(89175),C=n(8684);class S{updatedSources=new Map;imapDelete=[];imapCopy=[];addSourceUpdate(e,t,n){const i=this.updatedSources.get(t);i?i.set(e,n):this.updatedSources.set(t,new Map([[e,n]]))}addSource(e,t,n){this.addSourceUpdate(e,t,{read:n,deleted:!1,internal:!0})}removeSource(e,t){this.addSourceUpdate(e,t,void 0)}deleteSource(e,t){this.addSourceUpdate(e,t,{deleted:!0})}undeleteSource(e,t){this.addSourceUpdate(e,t,{deleted:!1})}addImapDelete(e,t,n){this.imapDelete.push({accountId:e,path:t,searchListId:n})}addImapCopy(e,t,n){const i=t.find((t=>{const n=e.sources.get(t);return n&&!n.internal}));if(i){const t=a.C.get(i);if(!t)throw new Error("Filter not found "+i);const{accountId:s,path:o}=t;this.imapCopy.push({accountId:s,path:o,destinationPath:n,searchListId:e.id})}}}function T(e){const t=new Map;return[...e.keys()].forEach((e=>{const n=a.C.get(e);if(!n)throw new Error("Filter not found "+e);const{accountId:i}=n,s=t.get(i);s?s.push(e):t.set(i,[e])})),t}async function I(e,t){const{updatedSources:n,imapCopy:s,imapDelete:a}=e,r=new Set;if(n.size>0&&(r.add(c.Z.searchList),r.add(c.Z.filteringQueue),r.add(c.Z.filters)),(a.length>0||s.length>0)&&(r.add(c.Z.imap),r.add(c.Z.buffer)),r.size>0){let e=[];await c.Z.transaction("rw",[...r],(async()=>{n.size>0&&(e=await v.Z.call(n),n.forEach(((e,n)=>{g.Z.call({type:"RE_RUN_SLES",priority:y.Un.HIGH,searchListIds:[n],filterIds:[...e.keys()],folderIds:[[y.of,t]]})}))),s.length>0&&await m.Z.addCopy(s),a.length>0&&await m.Z.addDelete(a)})),f.Z.filter(),i.Z.flushBuffer(),e.length>0&&o.Z.updateIndex({sleUpdates:e})}}async function k(e,t,n){const i=new S;for(const o of e){const{id:e,sources:c}=o,h=T(c);for(const g of h){const h=g[0],m=g[1];if(!(0,w.ZA)(h)){u.Z.warn("Mail",`Can not move message to ${n} on ${h} as it is not an IMAP account`);continue}let v=d.Z.getFoldersOfType(h,t);if((!v||0===v.length&&t===y.hn)&&r.Z.get(b.kMailAddArchiveFolder)){if(!navigator.onLine){(0,C.c)({title:(0,l.Z)("Can not create Archive folder without a network connection")}),u.Z.log("Mail",`Can not create Archive folder without a network connection - ${h}`);continue}(0,C.c)({title:(0,l.Z)(`Creating Archive folder for ${h}`)});const e=d.Z.getFoldersOfType(h,y.e9);if(0===e.length)throw new Error(`No inbox folder found on imap account ${h}`);const t=e[0];await s.Z.createMailbox(h,y.$T),v=[{path:y.$T,name:y.$T,type:y.hn,subscribed:!0,delimiter:t.delimiter}]}if(v&&v.length>0){if(v.length>1){const e=v.filter((e=>e.subscribed));e.length>0&&(v=e),v.length>1&&v.sort(((e,t)=>e.path.split(e.delimiter).length-t.path.split(t.delimiter).length))}const t=v[0],{path:n}=t,s=a.C.getByFolder(h,n);if(!s)throw new Error("Filter not found "+h+" "+n);const{id:r}=s,l=o.sources.get(r);if(l)l.internal&&i.addImapCopy(o,m,n);else{const t=p.Z.call(c);i.addSource(r,e,t),i.addImapCopy(o,m,n)}m.forEach((t=>{if(r===t)return;const n=o.sources.get(t);if(!n)throw new Error("Source not found "+t+" on listEntry "+o.id);if(!n.internal){const n=a.C.get(t);if(!n)throw new Error("Filter not found "+t);i.addImapDelete(h,n.path,e),i.deleteSource(t,e)}}))}}}await I(i,n)}async function A(e,t,n){const i=new S;e.forEach((e=>{const{id:n,sources:s}=e;T(s).forEach(((o,r)=>{const l=a.C.getByIds(o),c=l.some((({accountId:e,path:t})=>h.Z.getFolderType(e,t)===y.uT));if(c)l.forEach((({id:e,accountId:s,path:o})=>{h.Z.getFolderType(s,o)===t&&(i.removeSource(e,n),i.addImapDelete(s,o,n))}));else{let c=!1;if(l.forEach((({id:a,accountId:r,path:l})=>{if(h.Z.getFolderType(r,l)===t)i.removeSource(a,n),i.addImapDelete(r,l,n);else{c=!0;const t=s.get(a);if(!t)throw new Error("Source not found");t.deleted&&(i.undeleteSource(a,n),i.addImapCopy(e,o,l))}})),!c){const t=d.Z.getFoldersOfType(r,y.e9);if(0===t.length)throw new Error("No inbox found on account "+r);const l=t[0].path,c=a.C.getByFolder(r,l);if(!c)throw new Error("Inbox filter not found "+r+" "+l);const h=p.Z.call(s);i.addSource(c.id,n,h),i.addImapCopy(e,o,l)}}}))})),await I(i,n)}const Z={markAsJunk:async function(e){await k(e,y.Hd,y.rp)},markAsNotJunk:async function(e){await A(e,y.Hd,y.rp)},moveToArchive:async function(e){await k(e,y.hn,y.$T)},restoreFromArchive:async function(e){await A(e,y.hn,y.$T)}}},75995:(e,t,n)=>{"use strict";n.d(t,{o:()=>s,Z:()=>o});var i=n(95752);function s(e){delete e.isParent,delete e.parentId,delete e.isChild,delete e.children,delete e.unreadInThread}const o={getThreadsAsTree:function(e,t=!0){if(0===e.length)return[];let n;t||e.reverse();let o=[];const a=[e[0]];s(e[0]),e[0].level=0;for(let t=1;t<e.length;t++){const r=e[t-1],l=e[t];s(l),l.level=l.threadKey.length-2,l.threadKey[0]===r.threadKey[0]&&l.threadKey[1]===r.threadKey[1]?((!n||l.threadKey.length>r.threadKey.length)&&(n?o.push(n):o.push(r),n=r,r.isParent=!0),o.length>0&&l.threadKey.length<r.threadKey.length&&(n=o.pop()),l.parentId=n.id,l.isChild=!0,n.children=n.children||[],n.children.push(l),i.Z.call(l.sources)||n.unreadInThread||(n.unreadInThread=!0,o.forEach((e=>e.unreadInThread=!0)))):(a.push(l),n=void 0,o=[])}return t?a:a.reverse()}}},91834:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={updateCounterFolders:function(e,t,n,i){i.forEach((({viewIntersections:i,counter:s})=>{let o=!1,a=!1,r=!1;for(const n of t){if(!o){i.total.get(n)?.every((t=>e.has(t)))&&(o=!0)}if(!a){i.unseen.get(n)?.every((t=>e.has(t)))&&(a=!0)}if(!r){i.unread.get(n)?.every((t=>e.has(t)))&&(r=!0)}}o&&(s.total+=n),a&&(s.unseen+=n),r&&(s.unread+=n)}))}}},45709:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>m});var i=n(21754),s=n(56371),o=n(71320),a=n(61472),r=n(45660),l=n(48868);const d={call:async function(e){0!==e.searchListIds.length?await l.Z.flaggingQueue.add(e):console.warn("Not queueing flag update request with no searchListIds")}};var c=n(18787),h=n(5863),p=n(95412);function u(e,t,n,i){return g(e,{[t]:n},void 0,i)}function g(e,t,n=new Map,s){const o=e.map((e=>e.id)),a=new Map,l=[];if(e.forEach((e=>{const i={},s=(0,p.hY)(e.flags,t);e.flags=i.flags=s;const o=n.get(e.id);if(o&&o.size>0){const t=new Map,n=new Map;o.forEach(((s,o)=>{t.set(o,s),!0===s.read&&(e.unseen=i.unseen=!1);const a=e.sources.get(o);if(a){const e={};for(const t of Object.keys(s))s[t]!==a[t]&&(e[t]=a[t]);Object.keys(e).length>0&&n.set(o,e)}})),i.sources=t,a.set(e.id,n)}const{id:r}=e;l.push({id:r,updates:i})})),r.Z.log("Mail","add to flagging queue",o,n,t),d.call({searchListIds:o,sourcesPerSle:n,flagUpdates:t}),i.Z.updateFlags(),s){const n={};for(const e of Object.keys(t))n[e]=!t[e];c.Z.push({operation:"setFlags",updates:n,sourcesPerSle:a,updateItems:e})}return l}const m={setRead:function(e,t){const n=[],i=new Map;return e.forEach((e=>{const{id:s,sources:r}=e,l=new Map;r.forEach(((e,n)=>{const i=o.Z.get(n);if(!i)throw new Error(`filter for sourceFilterId ${n} not found!`);const s=a.Z.getFolderType(i.accountId,i.path)===h.Nz&&!t;e.read===t||s||l.set(n,{read:t})})),l.size>0&&(n.push(e),i.set(s,l))})),g(e,{},i,!0)},setFlagged:function(e,t){return u(e,h.T4.FLAGGED,t,!0)},setForwarded:function(e,t){return u(e,h.T4.FORWARDED,t,!1)},setReplied:function(e,t){return u(e,h.T4.ANSWERED,t,!1)},setCustomFlags:function(e,t,n=new Map,i=!0){return g(e,t,n,i)},translateFlag:function(e){switch(e){case h.T4.RED:return(0,s.Z)("flag","Red");case h.T4.ORANGE:return(0,s.Z)("flag","Orange");case h.T4.YELLOW:return(0,s.Z)("flag","Yellow");case h.T4.GREEN:return(0,s.Z)("flag","Green");case h.T4.BLUE:return(0,s.Z)("flag","Blue");case h.T4.PURPLE:return(0,s.Z)("flag","Purple");case h.T4.GRAY:return(0,s.Z)("flag","Gray");case h.T4.CLEAR_FLAGS:return(0,s.Z)("flag","Clear flag");default:return e}},getStandardFlagList:function(){return[h.T4.RED,h.T4.ORANGE,h.T4.YELLOW,h.T4.GREEN,h.T4.BLUE,h.T4.PURPLE,h.T4.GRAY,h.T4.CLEAR_FLAGS]}}},6129:(e,t,n)=>{"use strict";n.d(t,{ZA:()=>r,mq:()=>l,S9:()=>d,Vd:()=>c});var i=n(29087),s=n(5863),o=n(89175);function a(e){const t=i.Z.get(o.kMailAccounts).find((t=>t.MAIL_EMAIL===e));return t&&t.accountType}function r(e){return a(e)===s.s9.IMAP}function l(e){const t=i.Z.get(o.kMailAccounts).find((t=>t.MAIL_EMAIL===e));return t&&t.accountType===s.s9.IMAP&&!t.offline}function d(e){const t=i.Z.get(o.kMailAccounts).find((t=>t.MAIL_EMAIL===e));return t&&t.offline}function c(e){return a(e)===s.s9.POP}},59042:(e,t,n)=>{"use strict";n.d(t,{z:()=>g,X:()=>m});var i=n(21754),s=n(82227),o=n(9185),a=n(98611),r=n(56371),l=n(10048),d=n(48868),c=n(71320),h=n(5204),p=n(5863),u=n(83065);async function g(e,t){const n=a.C.getByFolder(e,t);if(!n)throw new Error(`Filter not found for ${e} and ${t}`);if(!n.filterValue.include)throw new Error(`Filter for flag does not have any include rules: ${n.path}`);const r=n.filterValue.include.find((e=>e.some((e=>e.hasOwnProperty("flag")))));if(!r)throw new Error(`Filter for flag does not have flag include rule: ${n.path}`);const p=r.find((e=>e.hasOwnProperty("flag")))?.flag;if(void 0===p)throw new Error(`flag not found in include rule for label ${n.path}`);const u=a.C.getIndex(),g=[];for(const e of u)e.flags.includes(p)&&g.push(e.id);const m=[];await d.Z.transaction("rw",[d.Z.buffer,d.Z.filters,d.Z.filteringQueue,d.Z.viewIds,d.Z.imap,d.Z.searchList],(async()=>{await s.Z.remove([n.id]),await d.Z.searchList.where("id").anyOf(g).modify((e=>{const t=e.flags.indexOf(p);t>-1&&(e.flags.splice(t,1),m.push({id:e.id,updates:{flags:e.flags}}))})),await l.Z.call(g,{[p]:!1})})),await c.Z.updateFilters([n.id]),o.Z.updateIndex({sleUpdates:m}),h.Z.filter(),i.Z.flushBuffer()}function m(e){if(e.startsWith(p.ow))return(0,u.kF)(e.replace(p.ow,""));if(e.startsWith("$label")||e.startsWith("$Label"))switch(e){case"$label1":case"$Labelimportant":case"$Label1":return(0,r.Z)("Important");case"$label2":case"$Labelwork":return(0,r.Z)("Work");case"$label3":case"$Labelpersonal":return(0,r.Z)("Personal");case"$label4":case"$Labeltodo":case"$Label4":return(0,r.Z)("To Do");case"$label5":case"$Labellater":return(0,r.Z)("Later");case"$Label2":return(0,r.Z)("Meeting");case"$Label3":return(0,r.Z)("Valuable");case"$Label5":return(0,r.Z)("Send Reply");case"$Label6":return(0,r.Z)("Call Back");case"$Label7":return(0,r.Z)("Funny");default:return(0,u.kF)(e)}return(0,u.kF)(e)}},54773:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=new class{mailAddresses=[];addressMap=new Map;nameMap=new Map;clear=()=>{this.mailAddresses=[],this.addressMap=new Map,this.nameMap=new Map};add=e=>{const{address:t,name:n=""}=e,i=this.addressMap.get(t)||[],s=this.nameMap.get(n)||[];let o=i.find((e=>s.includes(e)));return void 0!==o||(o=this.mailAddresses.length,this.mailAddresses.push(e),0===i.length?this.addressMap.set(t,[o]):i.push(o),0===s.length?this.nameMap.set(n,[o]):s.push(o)),o};get=e=>e.map((e=>{if(void 0===this.mailAddresses[e])throw new Error(`MailAddressCache.get: Requested index ${e} not found in cache.`);return this.mailAddresses[e]}))}},19842:(e,t,n)=>{"use strict";n.d(t,{vE:()=>o,Ds:()=>a,Rr:()=>r});var i=n(63353),s=n(44850);function o(e){return!!s.jk.matchUrl(s.jk.internalUrl("mailpage","composer"),e)}function a(e){return!!s.jk.matchUrl(s.jk.internalUrl("mailpage","message"),e)}function r(e){const t=i.Z.getTabs(e).find((e=>e.page.active));return!(!t||!t.page)&&a(t.page.url)}},88951:(e,t,n)=>{"use strict";function i(e){const t=e?e.substring(e.indexOf("@")+1):"vivaldi.com",n=new Uint32Array(2);return window.crypto.getRandomValues(n),Date.now()+"."+n.join(".")+"@"+t}n.d(t,{Z:()=>i})},307:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(53576),s=n(44850);function o(e,t){var n="message/"+t.id,o=t.subject,a=s.jk.internalUrl("mailpage",n,o);i.Z.openURL(e,a)}},36809:(e,t,n)=>{"use strict";n.d(t,{Z:()=>W});var i=n(21754),s=n(4660),o=n(9185),a=n(88630),r=n(98611),l=n(60331),d=n(56371),c=n(42315),h=n(45660),p=n(5863);let u=!1;const g=function(e,t,n,i){if(this.alreadySending)return void h.Z.log("Mail",["smtp","onidle"],`[${e.MAIL_EMAIL}]Already Sending!`);h.Z.log("Mail",["smtp","onidle"],`[${e.MAIL_EMAIL}]`),this.alreadySending=!0;const s=[...t,...n,...i].map((e=>e.address));this.useEnvelope({from:e.MAIL_EMAIL,to:s})},m=function(e,t,n){h.Z.log("Mail",["smtp","onready"],"failedRecipients:",n.length),n.length>0?t({message:(0,d.Z)("Rejected recipients: $1",[n.join()])}):(this.send(e),this.end())},v=function(e,t,n,i,s){h.Z.log("Mail",["smtp","ondone"],`subject:"${t}" success:${s}`),u=!1,s?l.Z.setStatus(e,(0,d.Z)("Sent message: $1",[t]),p.QM):l.Z.setStatus(e,(0,d.Z)("Failed to send message: $1",[t])),this.quit(),s?n():i((0,d.Z)("Failed to send message: $1",[t]))},f=function(e,t,n,i){i||u?(h.Z.log("Mail",["smtp","onclose"],"Closed because of an error!"),l.Z.setStatus(e,(0,d.Z)("Failed to send message: $1",[u])),u=!1,n({message:(0,d.Z)("SMTP client closed on error")})):(h.Z.log("Mail",["smtp","onclose"],""),t())},y=function(e,t,n,i){h.Z.log("Mail",["smtp","onclose"],`[${t.MAIL_EMAIL}]${i.message}`),u=!1;const s=t.MAIL_SMTP_SERVER||"",o=t.MAIL_SMTP_USER||"";l.Z.setStatus(e,(0,d.Z)("$1 - Server: $2 - User: $3",[i.message,s,o])),this.quit(),n(i)},w={send:function(e,t,n,i,s,o,a){return h.Z.log("Mail",["smtp","send"],`[${t.MAIL_EMAIL}]subject:"${n}"`),-1===t.MAIL_SMTP_PORT?(console.warn("not gonna send as the smtp port is missing"),l.Z.setStatus(e,(0,d.Z)("SMTP client not configured for sending mail")),Promise.reject()):(l.Z.setStatus(e,(0,d.Z)("Sending")),new Promise(((r,l)=>{c.Z.getSMTPClient(t).then((d=>{u=`subject: ${n||""}, from: ${t.MAIL_EMAIL}`,d.onidle=g.bind(d,t,i,s,o),d.onready=m.bind(d,a,l),d.ondone=v.bind(d,e,n,r,l),d.onerror=y.bind(d,e,t,l),d.onclose=f.bind(d,e,r,l),d.connect()})).catch((e=>l(e)))})))}};var b=n(68247),C=n(29087),S=n(78347),T=n(45709),I=n(97823),k=n(21285),A=n(28918),Z=n(68906),E=n(33956),_=n(55346),N=n(93818),M=n(89846),P=n(5204),D=n(30628),x=n(40382),O=n(22288),L=n(89175),R=n(8684);let B=!1;async function F(e,t){t||(e.queued=!0);const n=await(0,k.Z)(p.of,p.J8,p.fZ,[e],{filteringPriority:p.Un.HIGH}),[s]=n;return o.Z.updateIndex({addedSles:n}),P.Z.filter(),i.Z.updateThreads(),s}function U(e,t,n){if(0===t.length)return void l.Z.setStatus(e,(0,d.Z)("No messages to send"),2e3);if(B)return;B=!0;let c=0;const h=r.C.getByFolder(p.of,p.J8);if(h)return l.Z.setStatus(e,(0,d.Z)("Preparing to send $1 messages",[t.length]),2e3),t.reduce(((t,r)=>t.then((()=>{const t=r.sources.get(h.id);if(t&&!t.deleted&&(n||!r.queued))return _.Z.call(r.id).then((t=>{if(t)return async function(e,t){if(!t.from||0===t.from.length)throw new Error((0,d.Z)("Can not send. No sender specified!"));const n=await I.Z.loadAllAccountsAndAliases(),r=t.from.map((e=>e.address)),l=n.find((e=>e.MAIL_EMAIL===r[0]));if(!l)throw new Error((0,d.Z)("Can not send. No account set up for sender $1",[r[0]]));const c=I.Z.getAccountIdForEmail(l.MAIL_EMAIL)||l.MAIL_EMAIL,h=S.Z.getFoldersOfType(c,p.Nz);let u,g,m=!1;h.length?(u=c,g=h[0].path,m=!0):(u=p.of,g=p.N1);const v=t.bodyParts&&t.bodyParts[0].content;if("string"!=typeof v)throw new Error("Could not switch to raw because first bodyPart is not string, it is: "+typeof v);const f=1e3*Math.floor(Date.now()/1e3),y=(0,O.yN)(t.bodyParts),C=await a.Z.build({...t,sentDate:f},v,y),{subject:k,to:_,cc:D,bcc:R}=t;await w.send(e,l,k,_,D,R||[],C);const B={searchList:{sentDate:f},messages:{sentDate:f},threading:{sentDate:f}},F={searchList:["queued"]};m&&(await(0,x.Z)(u,f,t.id,C),F.messages=["bodyParts"]);const U={addedProperties:B,removedProperties:F,filteringPriority:p.Un.HIGH},{sleUpdate:V}=await(0,M.Z)(t.id,p.of,p.J8,u,g,U);u!==p.of&&Z.Z.call({type:"FILTERS_SLES",priority:p.Un.HIGH,searchListIds:[t.id],folderIds:[[p.of,p.N1]]}),await(0,E.Z)([t.id]),o.Z.updateIndex({sleUpdates:[V]}),P.Z.filter(),b.Z.set(L.kMailLastSentFrom,l.MAIL_EMAIL),m&&l.accountType===p.s9.IMAP&&(l.uploadSent??1)?await(0,A.Z)({accountId:c,path:g,operation:"BUFFER_OPERATION_UPLOAD_MESSAGE",message:C,searchListId:t.id}).then((()=>i.Z.flushBuffer())):l.accountType===p.s9.IMAP&&(l.uploadSent??1)&&console.warn("No sent folder found for account",c);const W=t.forwarded||t.replied;if(void 0!==W){const e=await(0,N.Z)(W);if(!e)return void console.warn(`Referenced message with id ${W} not found`);const n=t.forwarded?T.ZP.setForwarded([e],!0):T.ZP.setReplied([e],!0);o.Z.updateIndex({sleUpdates:n})}s.Z.addIfNotAddressExists(t.to)}(e,t).then((()=>++c)).catch((e=>{console.error(e),(0,R.c)({title:e.message||e})}))}))}))),Promise.resolve()).then((()=>{B=!1,c>0&&C.Z.get(L.kMailNotifications)&&C.Z.get(L.kMailNotificationsOnSuccessfullySent)&&(0,R.c)({title:(0,d.Z)("$1 message successfully sent","$1 messages successfully sent",[c]),icon:"resources/mail_notification_icon.png"})})).catch((e=>{B=!1,console.error(e)}));console.error("Outbox filter missing!")}const V={sendAll:function(e,t=!0){D.Z.m3GetAll().then((n=>U(e,n,t)))},sendExternalMessage:async function(e,t,n=!0){const i=await F(t,n);n&&V.sendSelected(e,[i])},sendForAccount:function(e,t){D.Z.m3GetAll().then((n=>U(e,n.filter((e=>e.from&&e.from[0]&&e.from[0].address===t)),!0)))},sendSelected:function(e,t){U(e,t,!0)},storeMessage:F},W=V},70611:(e,t,n)=>{"use strict";n.d(t,{yy:()=>o,iT:()=>i});n(20244);async function i(e){let t;if(function(e){const t=(new DOMParser).parseFromString(e,"text/html");return t.body&&Array.from(t.body.getElementsByTagName("*")).every((e=>e instanceof HTMLDivElement||e instanceof HTMLSpanElement||e instanceof HTMLBRElement))}(e)){const i=document.createElement("iframe");i.setAttribute("style","position:fixed; z-index:-1"),document.body&&document.body.appendChild(i);const s=i.contentDocument.body;s?(s.innerHTML=e,t=await(n=s,[...n.getElementsByTagName("div")].forEach(((e,t)=>{const n=e.parentNode;if(!n)return;const i=e.previousSibling&&e.previousSibling.nodeType===Node.TEXT_NODE,s=e.firstChild&&"BR"===e.firstChild.nodeName;if(i&&!s){const t=document.createElement("br");n.insertBefore(t,e)}const o=!e.nextSibling||"BR"===e.nextSibling.nodeName,a=e.lastChild&&"BR"===e.lastChild.nodeName;if(!o&&!a){const t=document.createElement("br");e.appendChild(t)}for(;e.firstChild;)n.insertBefore(e.firstChild,e);n.removeChild(e)})),n.innerText||"")):console.warn("Could not get plain text because iframe could not be made"),i.remove()}var n;return t?s(t):void 0}function s(e){return e.replace(/\u00A0/g," ")}function o(e){const t=document.createElement("iframe");t.setAttribute("style","position:fixed; z-index:-1"),document.body&&document.body.appendChild(t);const n=t.contentDocument.body;let i="";return n?(n.innerHTML=e,i=n.innerText||""):console.warn("Could not get innerText because iframe could not be made"),t.remove(),s(i)}},92868:(e,t,n)=>{"use strict";n.d(t,{U:()=>C,y:()=>b});var i=n(48868),s=n(60331),o=n(56371),a=n(7064),r=n(1407);async function l(e,t){const{currentPosition:n,searchListIds:l}=t;if(!l)return void console.error(`Task ${t.taskName} should have searchListIds array`);if(0===l.length||n>=l.length)return;const d=l.length;let c=n;const h=1e4;await async function n(){const p=l.slice(c,c+h);await function(e){return new Promise((t=>{try{a.Z.mailPrivate.deleteMessages(e,(e=>{e||console.warn("Failed to remove messages from FTS db"),t()}))}catch(t){console.error(`Failed to remove messages: ${e.join()}`,t)}}))}(p),await i.Z.systemTasks.update(t.id,{currentPosition:c+p.length}),p.length>=h?(c+=h,s.Z.setStatus(e,(0,o.Z)("Remove deleted entries from search database: $1/$2",[c,d])),await n()):(s.Z.setStatus(r.A4,(0,o.Z)("Rebuilding search database...")),await a.Z.mailPrivate.rebuildAndVacuumDatabase(),s.Z.setStatus(e,(0,o.Z)("Remove deleted entries from search database: $1/$2",[d,d]),3e3))}(),i.Z.systemTasks.delete(t.id)}var d=n(98611),c=n(29087),h=n(89378),p=n(55346),u=n(93818),g=n(11430),m=n(83507),v=n(61839),f=n(76257),y=n(13519),w=n(89175);async function b(e){const t=await i.Z.systemTasks.toArray();for(const n of t)await C(e,n)}async function C(e,t){"restore_full_text_search_db"===t.taskName?await async function(e,t){const n=await i.Z.searchList.toCollection().primaryKeys();let a=n.indexOf(t.currentPosition);a<0&&(a=0);const r=n.length;if(r<1)return;s.Z.setStatus(e,(0,o.Z)("Building text-search database: $1/$2",[a,r]));let l=[];for(let b=a;b<n.length;b++){if(c.Z.get(w.kMailIsTurnedOff)){s.Z.setStatus(e,(0,o.Z)("Mail client turned off - Stopped building text-search database"),3e3);break}a++;const C=n[b],S=await(0,u.Z)(C);if(!S){console.error(`Message ${C} not found in searchList table`);continue}const T=await p.Z.call(C);if(!T){console.error(`Message ${C} not found in messages table`);continue}const{subject:I,to:k,cc:A,from:Z,replyTo:E}=T;let _="";for(const e of S.sourceFilterIds){const t=d.C.get(e);if(!t){console.error(`Filter not found for sourceFilterId ${e} and searcList entry ${C}`);continue}const{accountId:n}=t,i=await m.Z.call(n,C,S.sentDate);if(i){const e=(0,f.PW)((0,f.Zp)(i));if(!e){console.warn("Message exists on disk but is empty",n,C);continue}const t=await g.Z.parse(i,e.mimeTree),s=(0,y.H)(t.bodyParts);_&&_.trim()!==s.trim()?(console.warn(`Entry ${C} has more than one copy on disk and they don't agree`,_,s),s.length>_.length&&(_=s)):_=s}}l.push({searchListId:C,subject:I,body:_,to:(0,h.Z)(k),cc:(0,h.Z)(A),from:(0,h.Z)(Z),replyTo:(0,h.Z)(E)}),(l.length>=20||a>=r)&&(await(0,v.Z)(l),await i.Z.systemTasks.update(t.id,{currentPosition:C}),s.Z.setStatus(e,(0,o.Z)("Building text-search database: $1/$2",[a,r])),l=[],a>=r&&i.Z.systemTasks.delete(t.id))}}(e,t):"delete_full_text_search_entries"===t.taskName?await l(e,t):console.error("task not supported",t)}},59275:(e,t,n)=>{"use strict";n.d(t,{e:()=>s,W:()=>o});var i=n(56371);function s(e){switch("inbox"===e.toLowerCase()?"inbox":e){case"All":return(0,i.Z)("mailbox","All");case"Archive":return(0,i.Z)("Archive");case"Drafts":return(0,i.Z)("Drafts");case"flagged":return(0,i.Z)("Flagged");case"inbox":return(0,i.Z)("Inbox");case"Junk":return(0,i.Z)("Junk");case"Sent":case"Sent Mail":return(0,i.Z)("Sent");case"Trash":return(0,i.Z)("Trash");default:return e}}function o(e){switch(e){case"Unread":return(0,i.Z)("Unread");case"Received":return(0,i.Z)("Received");case"Sent":return(0,i.Z)("Sent");case"Drafts":return(0,i.Z)("Drafts");case"Outbox":return(0,i.Z)("Outbox");case"Spam":return(0,i.Z)("Spam");case"Trash":return(0,i.Z)("Trash");case"Archive":return(0,i.Z)("Archive");default:return console.warn("Unknown All Messages folder"),e}}},18787:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=new class{buffer=[];maxSize=200;clear(){this.buffer=[],this.maxSize=200}push(e){this.buffer.length===this.maxSize&&this.buffer.shift(),this.buffer.push(e)}pop(){return this.buffer.pop()}removeEntries(e){this.buffer.forEach((t=>{t.updateItems=t.updateItems.filter((t=>!e.has(t.id)))}))}}},40382:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(26067),s=n(92292),o=n(7064);function a(e,t,n,a){return r=a,l=(0,i.Z)(e,t,n),new Promise(((e,t)=>{const{pathArray:n,fileName:i}=l;o.Z.mailPrivate.writeTextToMessageFile(n,i,r,(()=>{s.Z.runtime.lastError&&t({lastError:s.Z.runtime.lastError,pathArray:n,fileName:i}),e()}))})).catch((e=>{console.warn("writeToDisk %o",e)}));var r,l}},94283:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(67294).createContext)(window)},10334:(e,t,n)=>{"use strict";n.d(t,{g2:()=>fe,hT:()=>V,GO:()=>J,Xz:()=>ie,hm:()=>Y,oE:()=>oe,CD:()=>Q,$J:()=>W,S4:()=>ge,IZ:()=>de,sh:()=>ue,Dj:()=>le,JC:()=>re,nX:()=>te,pN:()=>ee,jn:()=>j,s1:()=>ne,xh:()=>ae,Kk:()=>ce,JQ:()=>q,Lm:()=>X,ue:()=>H,Jg:()=>K,Gr:()=>he,vD:()=>F,de:()=>se,Xf:()=>ve,lp:()=>$,Fm:()=>G,hV:()=>pe,AE:()=>U});var i=n(27770),s=n(59486),o=n(56284),a=n(88083),r=n(31186),l=n(62882),d=n(53576),c=n(63353),h=n(29087),p=n(80342),u=n(39206),g=n(63365),m=n(56371),v=n(92292),f=n(45454),y=n(26036),w=n(40037);const b=(0,y.Z)("keyword","default"),C=(e,t,n)=>t.every((t=>{const i=e.label.toLowerCase(),s=e.labelEnglish.toLowerCase();return n?i.includes(t)||s.includes(t):i.includes(t)}));function S(e,t,n){const i=e.trim().toLowerCase().split(" ").filter(Boolean),s=t.filter((e=>function(e,t,n){return((e,t,n)=>{const{keyword:i}=e;if(!i)return;const{validity:s}=i;let o=!1,a=!1,r=t.find((e=>{let t=!1;return o=n&&e===b.labelEnglish||e===b.label,s&&(t=s.test(e)),isNaN(e)||(a=!0),o||a||t}));const l=t.filter((e=>!e.includes(String(r))));if(l.length&&C(e,l,n)){const{min:t,max:n,type:s,defaultValue:l}=i;return o?Object.assign(e,{foundKeyword:!0},{paramValue:l}):("number"==typeof r||a?r=(0,w.default)(r,t,n):"mixed"===s&&(r=r?{keyword:i,param:r}:void 0),Object.assign(e,{paramValue:r},{foundKeyword:Boolean(r)}))}})(e,t,n)||C(e,t,n)}(e,i,n)));return s}var T=n(7064),I=n(5422),k=n(46217),A=n(36436),Z=n(29489),E=n(46601),_=n(47380),N=n(60339),M=n(721),P=n(86088),D=n(89175),x=n(13302),O=n(44850);const L={"⁰":"0","¹":"1","²":"2","³":"3","⁴":"4","⁵":"5","⁶":"6","⁷":"7","⁸":"8","⁹":"9"},R=20,B=new k._b,F=(e,t)=>{const n=(0,M.mT)(t),i=(0,M.Mr)(t),s=(0,f.Z)(e,t),o=h.Z.get(D.kQuickCommandsOpenUrlInNewTab);return n?(s.inCurrent=!1,s.inBackground=!0):i&&o?s.inCurrent=!0:o&&(s.inCurrent=!1,s.inBackground=!1),s},U=e=>{if("number"==typeof e||!isNaN(e))return Number(e);const{param:t}=e,{min:n,max:i}=e.keyword,s=String.fromCharCode(39),o=String.fromCharCode(34),a=t.indexOf(s),r=t.indexOf(o),l=a>0&&t.substring(0,a)||0,d=r>0&&t.substring(a+1,r)||0,c=60*parseInt(l)+parseInt(d);return(0,w.default)(c,n,i)};async function V(e,t){const n=(await a.Z.getVivDefinedCommands()).map((e=>{const t=(0,E.xU)(e.name);return{...e,...t&&{keyword:t}}})).concat(I.Y);for(const i of t){const{key:t,param:s}=i,o=n.find((e=>e.guid.includes(t)));if(!o){console.error(`chainedCommandExecution: Command ${t} not found`);break}const{action:a,keyword:r}=o,l=r?.defaultValue;let d=void 0!==s?s:l;if(void 0!==d&&r)switch(typeof d!==r.type&&"mixed"!==r.type&&"3a8efd62-4c8a-4545-8a6c-9cb65518f507"!==o.guid&&(d=r.defaultValue),typeof d){case"string":d=d.length?d:r.defaultValue;break;case"number":d=(0,w.default)(d,r.min,r.max)}delete e.param,d&&(e.param=d),await a(e)}}const W=(e,t)=>{const{searchText:n,chains:i,shortcuts:s}=t,o=n.toLowerCase().split(" "),a=h.Z.get(D.kQuickCommandsLimitResults),r=h.Z.get(D.kQuickCommandsSearchPriority),l=(0,_.m)(e);let d=i.filter((e=>o.every((t=>e.label.toLowerCase().includes(t)&&e.chain.length)))).map((e=>{const{chain:t,key:n,label:i,name:o}=e,a=s.find((e=>e.name===o));return{name:i,id:n,meta:a&&a.shortcuts?.length?a.shortcuts[0]:"",type:"commandChain",selectPriority:r.indexOf("COMMAND_CHAIN"),action:()=>V(l,t)}}));return a&&(d=d.slice(0,R)),z({title:"Command Chains",array:d})};function H(e,t){const n=e.toLowerCase(),i=t.toLowerCase();return n.indexOf(i)}function z(e){const{title:t,array:n,translateParam:i,subtitle:s}=e;return n.length?(n.unshift({name:(0,m.Z)(t),type:"title",subtitle:s&&i?(0,m.Z)(s,i):null,count:n.length}),n):[]}function G(e,t){return h.Z.get(D.kQuickCommandsSearchEnglish)?!0===(t.regex.test(e)||t.regexSearchEnglish.test(e)):t.regex.test(e)}function $(e){const{label:t,initialPart:n="",endingPart:i=""}=e;return`${n}${`${t.substring(0,2)}?`}${`${t.split("").slice(2).join("?")}?`}${i}`}function K(e,t){const n=h.Z.get(D.kQuickCommandsSearchPriority).length,{selectPriority:i=n}=e;return{priority:i,selectIndex:t}}function j(e){const{initialPart:t,endingPart:n}=e,{label:i,labelEnglish:s}=e.labelPair,o=$({label:i,initialPart:t,endingPart:n}),a=$({label:s,initialPart:t,endingPart:n});return{regex:new RegExp(o,"i"),regexSearchEnglish:new RegExp(a,"i")}}function Y(e){const t=s.ZP.getNicknamed(e,!1).map((e=>{const{url:t=""}=e;return{folderId:e.children?e.id:void 0,type:"bookmarkNick",name:e.title,url:e.children?void 0:t,selectPriority:-1,nickname:e.nickname,faviconUrl:e.children?P._TQ.small:O.jk.getFavicon(t)}}));return z({title:(0,m.Z)("Nickname Match"),array:t})}function X(e){const t=e?p.Z.getFilter(e):[],n=h.Z.get(D.kQuickCommandsSearchPriority),i=t.map((e=>({type:"readingList",name:e.title,selectPriority:n.indexOf("READING_LIST"),url:e.url,faviconUrl:O.jk.getFavicon(e.url),read:e.read})));return z({title:(0,m.Z)("Reading List"),array:i})}function Q(e){const t=e.replace(/,/g,".").replace(/x/gi,"*").replace(/([^\s])([⁰¹²³⁴⁵⁶⁷⁸⁹]+)/gu,"$1 ^ $2 ").replace(/[⁰¹²³⁴⁵⁶⁷⁸⁹]/gu,(e=>L[e]));if(!t)return[];let n;try{n=B.evaluate(t)}catch(e){}if(void 0===n||"function"==typeof n)return[];let i=n;const s=`${String.fromCharCode(8722)}0`,o=`${String.fromCharCode(45)}0`,a=h.Z.get(D.kQuickCommandsSearchPriority);i!==s&&i!==o||(i="0");return[{name:i.toString(),searchString:e,selectPriority:a.indexOf("CALCULATOR"),type:"calculator"}]}function q(e,t){const n=e.toLowerCase().split(" "),i=h.Z.get(D.kQuickCommandsSearchPriority),s=t.filter((e=>me(e.title||"",e.url||"",n))).map((e=>{const{id:t,url:n=""}=e;if(void 0===t)throw new Error("QuickCommandSearch.getOpenTabs: Expected number id");return{name:O.jk.getDisplayTitle(e),url:(0,A.xl)(n)?"":n,type:"openTab",selectPriority:i.indexOf("OPEN_TABS"),pageId:t,windowId:e.windowId,pageUrlForFavicon:n,faviconUrl:O.jk.getFavicon(n)}}));return z({title:(0,m.Z)("Tabs"),array:s})}async function J(){return new Promise((e=>{v.Z.management.getAll((t=>e(t)))}))}async function ee(){return new Promise((e=>{T.Z.extensionActionUtils.getToolbarExtensions((t=>{const n=t.map((e=>({badgeIcon:e.badgeIcon,id:e.id})));e(n)}))}))}function te(e,t,n){const i=h.Z.get(D.kQuickCommandsSearchPriority),s=h.Z.get(D.kQuickCommandsLimitResults),o=e.toLowerCase().split(" ");let a=t.filter((e=>{const t=e.name.toLowerCase(),n=e.shortName.toLowerCase();return!e.isApp&&o.every((e=>t.includes(e)||n.includes(e)))})).map((e=>{const t=n.find((t=>t.id===e.id)),s=t?t.badgeIcon:P.N_W;return{name:e.name,faviconUrl:s,id:e.id,type:"extension",enabled:e.enabled,optionsUrl:e.optionsUrl,selectPriority:i.indexOf("EXTENSIONS")}}));s&&(a=a.slice(0,R));const r=(0,x.$)("ctrl");return z({title:(0,m.Z)("Extensions"),array:a,translateParam:[r],subtitle:"Open Options Page with $1"})}function ne(e){const t=h.Z.get(D.kQuickCommandsSearchPriority),n=h.Z.get(D.kQuickCommandsLimitResults),{searchText:i,today:s}=e;let o=r.Z.getFilteredHistory(i,s).map((e=>{const{url:n,title:i,lastVisitTime:s,visitCount:o,visitTime:a}=e;return{type:"history",faviconUrl:O.jk.getFavicon(n),selectPriority:t.indexOf("HISTORY"),url:n,name:i,visitTime:s||a,visitCount:o}}));return n&&(o=o.slice(0,R)),z({title:"History",array:o})}function ie(e){const t=h.Z.get(D.kQuickCommandsSearchPriority),n=h.Z.get(D.kQuickCommandsLimitResults),i=e.toLowerCase();let o=s.ZP.getFilteredFlat(i,{bookmarks:!1,folders:!0,inTrash:!1}).filter((e=>e.nickname.toLowerCase()!==i)).map((e=>({folderId:e.id,type:"bookmarkFolder",name:e.title,selectPriority:t.indexOf("BOOKMARK_ITEM_OR_FOLDER"),nickname:e.nickname,faviconUrl:P._TQ.small})));return n&&(o=o.slice(0,R)),z({title:(0,m.Z)("Open All Bookmarks in Folder"),array:o})}async function se(e,t){const{id:n,enabled:i,optionsPage:s,optionsUrl:o}=t;i||await v.Z.management.setEnabled(n,!0),s&&o.length?d.Z.openURL(e,o,{inCurrent:!s}):fe.emitChange(n)}function oe(e){const t=h.Z.get(D.kQuickCommandsSearchPriority),n=h.Z.get(D.kQuickCommandsLimitResults),i=e.toLowerCase();let o=s.ZP.getFilteredFlat(i,{bookmarks:!0,folders:!1,inTrash:!1}).filter((e=>e.nickname.toLowerCase()!==i)).filter((e=>{const t={...e};return delete t.isExpanded,s.ZP.isBookmark(t)})).map((e=>{const{url:n="",nickname:i,title:s}=e;return{type:"bookmark",name:s,url:n,selectPriority:t.indexOf("BOOKMARK_ITEM_OR_FOLDER"),nickname:i,faviconUrl:O.jk.getFavicon(n)}}));return n&&(o=o.slice(0,R)),z({title:"Bookmarks",array:o})}function ae(e){const t=e.split(" ")[0],n=u.Z.getByKeyword(t);if(!n)return[];const i=e.substring(t.length).trim();return[{name:(0,m.Z)("Keyword Search “$1” on $2",[i,n.name]),nickname:n.keyword,type:"keywordSearch",faviconUrl:n.faviconUrl,selectPriority:-1,searchQuery:e}]}function re(e,t){const n=h.Z.get(D.kQuickCommandsSearchPriority);return[{name:(0,m.Z)("Search “$1” on $2",[e,t?.name]),type:"search",faviconUrl:t?t.faviconUrl:"",selectPriority:n.indexOf("KEYWORD_SEARCH"),searchQuery:e}]}function le(e){return e.length<4?[]:[{name:(0,m.Z)("Create Note “$1”",[e]),type:"noteAdd",value:e}]}function de(e,t){const n=a.Z.getQuickCommands(e).map((e=>{const t=E._H[e.name];return{...e,foundKeyword:!1,...t&&{keyword:t}}})),i=h.Z.get(D.kQuickCommandsSearchEnglish);return z({title:"Commands",array:S(t,n,i).map((e=>{const t=a.Z.getCommandConfiguration(e.name),{label:n,foundKeyword:s,keyword:o,paramValue:r,labelEnglish:l}=e;let d=n;const c=r&&s?r:void 0;o&&(d=s?(0,m.Z)("Run $1",[n]):n+" #");const p=h.Z.get(D.kQuickCommandsSearchPriority);return{name:d,type:o?"commandKeyword":"command",meta:t?.shortcuts?t.shortcuts[0]:"",commandName:e.name,searchString:n,selectPriority:s?-1:p.indexOf("NORMAL_COMMAND"),value:c,...i&&{labelEnglish:l}}}))})}function ce(e){const t=h.Z.get(D.kQuickCommandsSearchPriority),n=h.Z.get(D.kQuickCommandsLimitResults);let i=l.ZP.getFilteredFlat(e,{inTrash:!1}).map((e=>{const{id:n,title:i,children:s,content:o,url:a}=e,r=e.attachments&&e.attachments.length>0;return{type:"note",id:n,url:a||"",name:i||o||"",isFolder:void 0!==s?.length,selectPriority:t.indexOf("NOTES_SEARCH"),nickname:i&&o?o:"",hasAttachment:r}}));return n&&(i=i.slice(0,R)),z({title:"Notes",array:i})}function he(e){if(!(0,A.C3)(e)&&!(0,A.xl)(e))return[];const t=(0,A.q9)(e),n=h.Z.get(D.kQuickCommandsSearchPriority),i={name:t,type:"url",selectPriority:(0,A.Zj)(e)?n.indexOf("KEYWORD_SEARCH")-1:-1,pageUrlForFavicon:t,faviconUrl:O.jk.getFavicon(t)};return z({title:t.toLowerCase().startsWith("javascript:")?"Execute":"Go to Address",array:[i]})}async function pe(e,t){const n=s.ZP.getItemById(t);if(n&&s.ZP.isFolder(n)){const t=i.ZP.getBookmarksByNode(n),s={inCurrent:!h.Z.get(D.kQuickCommandsOpenUrlInNewTab),inBackground:!1,inNewWindow:!1,allowOverride:!1,incognito:!1};i.ZP.open(e,t,s,!0)}}function ue(e,t){const n=e.toLowerCase().split(" "),i=h.Z.get(D.kQuickCommandsSearchPriority);return z({title:"Page Actions",array:t.filter((e=>n.every((t=>(0,Z.gD)(e).toLowerCase().includes(t))))).map((e=>({type:"contentScript",selectPriority:i.indexOf("PAGE_ACTIONS"),script:e,name:(0,Z.gD)(e)})))})}function ge(e){const t=h.Z.get(D.kQuickCommandsSearchPriority),n=h.Z.get(D.kQuickCommandsLimitResults),i=e.toLowerCase().split(" ");let s=g.Z.getTrash().flatMap((e=>e.window?.tabs?e.window.tabs.flatMap((t=>({lastModified:e.lastModified,...t}))):{lastModified:e.lastModified,...e.tab})).filter((e=>me(e.title||"",e.url||"",i))).map((e=>{const n=e.url||"";return{name:e.title||"",url:(0,A.xl)(n)?"":n,type:"closedTab",selectPriority:t.indexOf("CLOSED_TABS"),pageUrlForFavicon:n,faviconUrl:O.jk.getFavicon(n),command:e}}));return n&&(s=s.slice(0,R)),z({title:(0,m.Z)("Closed Tabs"),array:s})}function me(e,t,n){const i=(0,A.xl)(t)?e:`${e} ${t}`;return n.every((e=>i.toLowerCase().includes(e)))}function ve(e){c.Z.getDiscardablePages(e).filter((e=>!(0,N.ZN)(e))).forEach(d.Z.discardPage)}const fe=new class extends o.Z{}},66777:(e,t,n)=>{"use strict";n.d(t,{C:()=>l,j:()=>d});n(67294);var i,s=n(60203),o=n(94184),a=n.n(o);function r(e,t,n,s){i||(i="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=s;else if(a>1){for(var r=new Array(a),l=0;l<a;l++)r[l]=arguments[l+3];t.children=r}if(t&&o)for(var d in o)void 0===t[d]&&(t[d]=o[d]);else t||(t=o||{});return{$$typeof:i,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}function l({children:e,text:t,className:n,label:i,leadingText:s,highlight:o}){const l=o?t.split(o.regExp).reduce(((e,t,n)=>n?e.concat([r("mark",{},n,o.matches[n-1])]).concat([t]):e.concat([t])),[]):t;return r("div",{className:a()("setting-single",n,{"setting-single--LeadingText":s})},void 0,r("label",{title:i},void 0,e,r("span",{},void 0,l)))}function d({children:e,heading:t,className:n,filter:i}){return r(s.Z,{filter:i},void 0,r("div",{className:a()("setting-group",n)},void 0,t&&r("h3",{},void 0,t),e))}},60203:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i,s=n(67294),o=n(67074);function a(e,t,n,s){i||(i="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=s;else if(a>1){for(var r=new Array(a),l=0;l<a;l++)r[l]=arguments[l+3];t.children=r}if(t&&o)for(var d in o)void 0===t[d]&&(t[d]=o[d]);else t||(t=o||{});return{$$typeof:i,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}class r extends s.PureComponent{render(){const{children:e,filter:t}=this.props;return t?Array.isArray(e)?e.map(((e,n)=>a(s.Fragment,{},n,(0,o.ZP)(e,t)))):(0,o.ZP)(e,t):e}}const l=r},67074:(e,t,n)=>{"use strict";n.d(t,{CH:()=>h,ZP:()=>p});var i,s=n(67294),o=n(74117),a=n(66777);function r(e,t,n,s){i||(i="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=s;else if(a>1){for(var r=new Array(a),l=0;l<a;l++)r[l]=arguments[l+3];t.children=r}if(t&&o)for(var d in o)void 0===t[d]&&(t[d]=o[d]);else t||(t=o||{});return{$$typeof:i,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const l=function(e,t){if(!e)return[!1,e];if("string"==typeof e){const n=d(e,t);return[n,n?h(e,t):e]}if(e.type===a.C){const n=d(e.props.text,t);return[n,n?h(e,t):e]}if(!("input"!==e.type&&"textarea"!==e.type||"string"!=typeof e.props.value&&"string"!=typeof e.props.defaultValue||"radio"===e.props.type||"checkbox"===e.props.type||"password"===e.props.type)){const n=d("string"==typeof e.props.value?e.props.value:e.props.defaultValue,t);return[n,n?c(e,t):e]}if("select"===e.type){let n=!1;return s.Children.forEach(e.props.children,(e=>{e?.props.children&&"string"==typeof e?.props.children&&e?.props.children.toLowerCase().includes(t)&&(n=!0)})),[n,n?c(e,t):e]}if(e.props?.children){let n=!1;const i=s.cloneElement(e,e.props,s.Children.map(e.props.children,(e=>{const[i,s]=l(e,t);return n=n||i,[n,s]})));return[n,i]}return[!1,e]};function d(e,t){return e.toLowerCase().includes(t.toLowerCase())}const c=(e,t)=>r("div",{className:"settings-text-bubble-highlight-wrapper"},void 0,e,r("mark",{className:"settings-text-bubble-highlight"},void 0,t));const h=(e,t)=>{if(!t||!e)return e;if(e.type===a.C)return function(e,t){const n=new RegExp((0,o.Z)(t),"gi"),i=e.props.text.match(n)||[];return s.cloneElement(e,{highlight:{matches:i,regExp:n}})}(e,t);if("string"!=typeof e)return e;const n=new RegExp((0,o.Z)(t),"gi"),i=e.match(n)||[];return r("span",{},void 0,e.split(n).reduce(((e,t,n)=>{let s=e;return n&&(s=s.concat([r("mark",{},n,i[n-1])])),s=s.concat([t]),s}),[]))};function p(e,t){if(!t)return e;const[n,i]=l(e,t);return n?i:null}},5422:(e,t,n)=>{"use strict";n.d(t,{Y:()=>j,Z:()=>q});var i,s=n(88083),o=n(69417),a=n(29087),r=n(39206),l=n(56371),d=n(89175);function c(e,t,n,s){i||(i="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),1===a)t.children=s;else if(a>1){for(var r=new Array(a),l=0;l<a;l++)r[l]=arguments[l+3];t.children=r}if(t&&o)for(var d in o)void 0===t[d]&&(t[d]=o[d]);else t||(t=o||{});return{$$typeof:i,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const h=e=>{const t=t=>e.changeParameter(t.target.value,e.index);return c("div",{className:"ChainedCommand-Item--Parameter",title:(e=>{const{keyword:t}=e;if(!t)return null;const{max:n,min:i,defaultValue:s,type:o,unit:a}=t;return("number"===o||"mixed"===o?(0,l.Z)("Min: $1",[i])+"\n"+(0,l.Z)("Max: $1",[n])+"\n":"")+(0,l.Z)("Default: $1",[s])+"\n"+(0,l.Z)("Parameter Unit: $1",[a])})(e.originalCommand)},void 0,(()=>{const{command:n}=e;switch(n.name){case"COMMAND_SEARCH_SELECTION_WITH_CUSTOM_ENGINE":{const e=r.Z.get();return c("label",{className:"floating-label"},void 0,c("span",{},void 0,S.parameter),c("select",{onChange:t,value:n.param},void 0,e.map((e=>{const{name:t,id:n}=e;return c("option",{value:n},t,t)}))))}case"COMMAND_TOGGLE_INTERFACE_COLOR_BY_NAME":{const e=a.Z.get(d.kThemesSystem).concat(a.Z.get(d.kThemesUser));return c("label",{className:"floating-label"},void 0,c("span",{},void 0,S.parameter),c("select",{onChange:t,value:n.param},void 0,e.map((e=>{const{name:t}=e;return c("option",{},t,t)}))))}default:return c(o.Z,{label:S.parameter,type:(i=e.command.defaultValue,"string"==typeof i?"text":"number"),placeholder:String(e.command.defaultValue),value:e.command.param,onChange:e=>t(e),draggable:"true",onDragStart:e=>e.preventDefault()})}var i})())};var p=n(92571),u=n(81157),g=n(10334),m=n(47380),v=n(67294);const f=()=>{const[e,t]=(0,v.useState)(!1);return(0,v.useEffect)((()=>(t(!0),()=>{t(!1)})),[e]),e};var y;function w(e,t,n,i){y||(y="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:y,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const b=["COMMAND_OPEN_LINK_DEFAULT","COMMAND_OPEN_LINK_CURRENT","COMMAND_OPEN_LINK_BACKGROUND"],C="ChainedCommand-Item--Over",S={name:(0,l.Z)("title","Chain Name"),emptyTitle:(0,l.Z)("Add your First Command Chain"),emptyDescription:(0,l.Z)("Press the “Add” button to the left to add a new Chain."),parameter:(0,l.Z)("chainedcommand","Command Parameter")},T=({windowId:e,chain:t,commands:n,removeFrom:i,chainOptions:s,changeParameter:a,addToChain:r,nameChange:d,name:c,shouldFocusSelector:v,moveItem:y,searchableStrings:b})=>{const S=f(),T=e=>{(0,u.Z)(e);const{classList:t}=e.currentTarget;t?.contains("ChainedCommand-Item")&&t.add(C)},I=e=>{(0,u.Z)(e);const{classList:t}=e.currentTarget;t?.contains(C)&&t.remove(C)};return w("div",{className:"detail"},void 0,w("div",{className:"detail-content"},void 0,w("div",{className:"setting-group"},void 0,w("div",{className:"setting-single"},void 0,w(o.Z,{label:b.name,type:"text",value:c||"",onChange:e=>d(e.target.value)}))),w("div",{className:"ChainedCommand setting-group-unlimited",onDragOver:e=>{(0,u.Z)(e),e.dataTransfer.dropEffect="move"}},void 0,t.map(((e,o)=>{const d=s.findIndex((t=>t.key===e.key)),c=s[d],g=n[d],m={val:c?.key,position:o+1,shouldDelete:!1},f={position:o,shouldDelete:!0},b=S&&v&&o>0,C=`ChainedCommand-Item--${o}`;return w("div",{className:"ChainedCommand-Item",draggable:t.length>1,onClick:e=>e.preventDefault(),onDrop:e=>((e,t)=>{(0,u.Z)(e);const n=e.dataTransfer.getData("vivaldi/x-oldIndex"),i=parseInt(n);isNaN(i)||y(i,t),I(e)})(e,o),onDragStart:e=>((e,t)=>{e.dataTransfer.setData("vivaldi/x-oldIndex",t)})(e,o),onDragEnter:T,onDragLeave:I},C,w("div",{className:"ChainedCommand-Item--Title floating-label"},void 0,w("span",{className:"ChainedCommand-Item--Name"},void 0,`Command ${o+1}`),w(p.Z,{className:"ChainedCommand--Selector",placeholder:(0,l.Z)("Filter Commands"),isClearable:!0,selectedCommand:g,autoFocus:b,openMenuOnFocus:!1,isMulti:!1,commands:s,setSelectedItem:e=>r({val:e.key,...f})})),g&&void 0!==e.param&&w(h,{originalCommand:g,command:e,index:o,changeParameter:a}),w("div",{className:"ChainedCommand-Item--Controls"},void 0,w("input",{type:"button",className:"circular remove",title:(0,l.Z)("Remove Command"),disabled:1===t.length,onClick:()=>i(o)}),w("input",{type:"button",className:"circular add",title:(0,l.Z)("Add Command"),onClick:()=>r(m)})))}))),w("input",{type:"button",value:(0,l.Z)("Test Chain"),onClick:()=>{(0,g.hT)((0,m.m)(e),t)}})))};var I,k=n(81009),A=n(76632),Z=n(53576),E=n(68247),_=n(40893),N=n(60203),M=n(2699),P=n(94283),D=n(15489),x=n(62830),O=n.n(x),L=n(26036),R=n(21191),B=n(86088),F=n(46601),U=n(18172),V=n(44850);function W(e,t,n,i){I||(I="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var s=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),1===o)t.children=i;else if(o>1){for(var a=new Array(o),r=0;r<o;r++)a[r]=arguments[r+3];t.children=a}if(t&&s)for(var l in s)void 0===t[l]&&(t[l]=s[l]);else t||(t=s||{});return{$$typeof:I,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}const H=[d.kChainedCommandsCommandList,d.kChainedCommandsDeletedCommandList],z=V.jk.settingCategories,G=(0,l.Z)("duplicate","Clone"),$="https://vivaldi.com",K=(0,l.Z)("Valid URL"),j=[{name:"COMMAND_CHAINED_SLEEP",action:e=>"number"==typeof e.param?new Promise((t=>setTimeout(t,e.param))):(console.error("Parameter to action is not a number",e.param),Promise.resolve()),category:"CATEGORY_COMMAND_APPLICATION",showInQC:!1,isEnabled:()=>!0,keyword:{type:"number",defaultValue:1e3,unit:(0,l.Z)("Milliseconds"),min:1,max:3e4},guid:"2eb81004-6703-46db-9933-6afcfde924e4",...(0,L.Z)("command","Delay")},{name:b[0],action:async e=>{const t="string"==typeof e.param?e.param:"";return await Z.Z.openURL(e.windowId,t,{inCurrent:!1,inBackground:!1})},category:"CATEGORY_COMMAND_APPLICATION",showInQC:!1,isEnabled:()=>!0,keyword:{type:"string",defaultValue:$,unit:K},guid:"f57b8092-9426-4bc8-8e39-fcf3e315b065",...(0,L.Z)("command","Open Link in New Tab")},{name:b[1],action:async e=>{const t="string"==typeof e.param?e.param:"";return await Z.Z.openURL(e.windowId,t,{inCurrent:!0})},category:"CATEGORY_COMMAND_APPLICATION",showInQC:!1,isEnabled:()=>!0,keyword:{type:"string",defaultValue:$,unit:K},guid:"0b01337b-4c13-4197-90c8-179c5c91cfff",...(0,L.Z)("command","Open Link in Current Tab")},{name:b[2],action:async e=>{const t="string"==typeof e.param?e.param:"";return await Z.Z.openURL(e.windowId,t,{inBackground:!0})},category:"CATEGORY_COMMAND_APPLICATION",showInQC:!1,isEnabled:()=>!0,keyword:{type:"string",defaultValue:$,unit:K},guid:"00e0e4ad-de61-4e36-8d7e-6aead10cf1c5",...(0,L.Z)("command","Open Link in Background Tab")},{name:"COMMAND_TOGGLE_INTERFACE_COLOR_BY_NAME",action:async e=>{const t="string"==typeof e.param?e.param:"";M.Z.setThemeByNameWithFallback(t)},showInQC:!1,category:"CATEGORY_COMMAND_APPEARANCE",guid:"e12a5194-0153-439b-98f6-9dcd99ca0d7e",isEnabled:()=>!0,keyword:{type:"string",unit:(0,l.Z)("Theme Name"),defaultValue:"Vivaldi"},...(0,L.Z)("Switch to Theme...")},{name:"COMMAND_SEARCH_SELECTION_WITH_CUSTOM_ENGINE",action:async e=>{const t=String(e.param),n=r.Z.getById(t)??r.Z.getDefault(D.ZP.isIncognitoOrGuest(e.windowId));n&&_.Z.withPageSelection(e.windowId,n)},showInQC:!1,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"3a8efd62-4c8a-4545-8a6c-9cb65518f507",isEnabled:()=>!0,keyword:{type:"string",unit:(0,l.Z)("Search Engine"),defaultValue:""},...(0,L.Z)("Search Selection with Engine...")}],Y=["b6ddaabf-d87f-4c2c-affa-ce81bb30bfca","176ff9a8-a516-4015-9b0a-14434746ce9b","1453aae1-130d-465f-98eb-cbda5061445d","172583c9-c8d5-45f7-9e4d-65cff9333679","d03d4bc8-26c4-49f6-b3ce-23980637ae76","855ad23f-900b-42bf-af4d-4ce6b419ce09","9f6124ef-e8ed-4143-b9ca-5a4beb646e3d"],X=e=>{const{keyword:t}=e;let n,i;if("COMMAND_SEARCH_SELECTION_WITH_CUSTOM_ENGINE"===e.name){const e=r.Z.getDefault(!1);n=e?.id,i=e?.id}return{...t&&{param:n||t.defaultValue,defaultValue:i||t.defaultValue}}},Q=e=>({name:e.name,label:e.label,key:e.guid,...X(e)}),q=(0,k.Z)((({filter:e,category:t})=>{const n=f(),i=(0,v.useContext)(P.Z),[o,r]=(0,v.useState)([]),[c,h]=(0,v.useState)(a.Z.get(d.kChainedCommandsCommandList)),p=(0,v.useRef)(0),u=t!==z.all,g=o.map((e=>Q(e)));(0,v.useEffect)((()=>{y().then((e=>{const t=e.filter((e=>!(0,R.jD)(e.name)&&!(0,R.Ed)(e.name)&&!Y.includes(e.guid))).map((e=>{const t=F._H[e.name];return{...e,...t&&{keyword:t}}})).concat(j);r(t)}))}),[]);const y=async()=>await s.Z.getVivDefinedCommands();(0,v.useEffect)((()=>{E.Z.set(d.kChainedCommandsCommandList,c)}),[c]);const w=e=>{const{val:t,position:i,shouldDelete:s}=e,a=o.find((e=>e.guid===t));if(!a||!n)return;const r=Q(a),l=(0,U.Uy)(c,(e=>{const t=e[p.current];t.chain.splice(i,Number(s),r),e[p.current]=t}));h(l)},b=(e,t)=>{const n=(0,U.Uy)(c,(n=>{const i=n[p.current],{chain:s}=i,o=s.splice(e,1)[0];s.splice(t,0,o),i.chain=s,n[p.current]=i}));h(n)},C=(e,t)=>{const n=!isNaN(e)&&e.length?Number(e):e,i=(0,U.Uy)(c,(e=>{const{chain:i}=e[p.current],s=i[t];s.param=n,i[t]=s,e[p.current].chain=i}));h(i)},I=e=>{const t=(0,U.Uy)(c,(t=>{const{chain:n}=t[p.current];n.splice(e,1)}));h(t)},k=e=>{const t=(0,U.Uy)(c,(t=>{const n=t[p.current];n.label=e,t[p.current]=n}));h(t)},Z=()=>{const e=(0,U.Uy)(c,(e=>{const t=e[p.current],n=O()(),i={...t,chain:t.chain.slice(),key:n,name:`COMMAND_${n}`,label:`${t.label} ${G}`};e.splice(p.current+1,0,i)}));h(e)},_=c.map((e=>({key:e.key,name:e.name,isDefault:!1,label:e.label})));return W(N.Z,{filter:e},void 0,W("p",{className:"info"},void 0,(0,l.Z)("A Command Chain is a group of commands executed in a sequence. You can trigger a Chain from Quick Commands, or assign it a custom Keyboard Shortcut or Mouse Gesture.")),W(A.Z,{className:"Setting--ChainedCommand",masterLayout:1,contentStrings:S,items:_,filter:e,deleteTitle:(0,l.Z)("title","Delete Command Chain"),deleteTipString:(0,l.Z)("tooltip","Delete Command Chain"),addTipString:(0,l.Z)("Add Command Chain"),onRemove:e=>{const t=(0,U.Uy)(c,(t=>{const n=t.splice(e,1)[0],{key:i}=n,s=a.Z.get(d.kChainedCommandsDeletedCommandList);E.Z.set(d.kChainedCommandsDeletedCommandList,[i,...s])}));h(t)},onContextMenu:(e,t)=>{const n=[{handler:Z,...(0,L.Z)("Clone Command Chain")}];(0,m.Z)(i.vivaldiWindowId,n)(t)},renderEmpty:e=>W("div",{className:"detail"},void 0,W("div",{className:"detail-content"},void 0,W("h3",{},void 0,e.emptyTitle),W("p",{},void 0,e.emptyDescription))),moveItem:(e,t)=>{const n=(0,U.Uy)(c,(n=>{const i=n.splice(e,1)[0];n.splice(t,0,i)}));h(n)},emptyListString:(0,l.Z)("Add a Chain to Start"),emptyListGraphic:B.Yaj,deleteLabel:c[p.current]?.label,onCreateItem:()=>{const e=(0,l.Z)("create","New Chain"),t=O()(),n={label:e,name:`COMMAND_${t}`,chain:[Q(j[0])],key:t,category:"CATEGORY_COMMAND_CHAIN"};h((e=>[...e,n]))},renderCreate:e=>{const t=c.length-1,{chain:n,label:s}=c[t];return p.current=t,W(T,{chainOptions:g,changeParameter:C,removeFrom:I,commands:o,shouldFocusSelector:u,cloneChain:Z,addToChain:w,searchableStrings:e,moveItem:b,nameChange:k,windowId:i.vivaldiWindowId,name:s,chain:n})},mimeType:"vivaldi/x-settings-chained-command-type",supportDragAndDrop:!0,renderListItem:(e,t)=>W("div",{className:"item-title"},void 0,t.label),renderContent:(e,t)=>{const{chain:n,label:s}=c[e];return p.current=e,W(T,{chainOptions:g,changeParameter:C,removeFrom:I,commands:o,shouldFocusSelector:u,cloneChain:Z,addToChain:w,searchableStrings:t,moveItem:b,nameChange:k,windowId:i.vivaldiWindowId,name:s,chain:n})},isChain:!0}))}),H)},93197:(e,t,n)=>{"use strict";n.d(t,{$J:()=>r,Cj:()=>l,E5:()=>d,ZP:()=>C});var i=n(65792),s=n.n(i),o=n(5264),a=n.n(o);const r=.4,l=s()("#fff"),d=s()("#000"),c=s()("#06a700"),h=s()("#efaf00"),p=s()("#c64539");function u(e,t,n){return s().deltaE(e,t)>=n}function g(e,t,n,i=!1){return u(e,t,n)?e:e.luminance()>t.luminance()?function(e,t,n,i=!1){do{if((e=e.brighten(.1)).num()===l.num()){if(!i)return l;do{if((e=e.darken(.1)).num()===d.num())return d}while(!u(e,t,n))}}while(!u(e,t,n));return e}(e,t,n,i):function(e,t,n,i=!1){let o=s()(e.hex());do{if(o=o.darken(.1),o.num()===d.num()){if(!i)return d;let o=s()(e.hex());do{if(o=o.brighten(.1),o.num()===l.num())return l}while(!u(o,t,n));return o}}while(!u(o,t,n));return o}(e,t,n,i)}function m(e,t,n){const i=e.luminance()>r?e.brighten(.75):e.darken(.75),o=s().mix(e,t,.1),a=s().mix(e,t,.2),l=s().mix(e,t,.4);return{colorFg:e,colorFgAlpha:e.alpha(.1),colorFgIntense:g(i,t,n),colorFgFaded:g(o,t,n),colorFgFadedMore:g(a,t,n),colorFgFadedMost:g(l,t,n)}}function v(e,t,n,i,o){const a=e.luminance()>r,d=e.darken(.15),c=e.darken(.3),h=e.brighten(.1),p=e.brighten(.5),u=e.brighten(.2),m=a?e.brighten(.3):e.darken(.3),v=a?e.brighten(.5):e.darken(.5),f=a?e.darken(.1):e.brighten(.1),y=a?e.darken(.4):e.brighten(.4),w=a?e.darken(.3):e.brighten(.3),b=a?s().mix(l,e,.4).alpha(.95):v.darken(.1).alpha(.92);return{colorBg:e,colorBgAlpha:e.alpha(.9),colorBgAlphaHeavy:e.alpha(.65),colorBgAlphaHeavier:e.alpha(.25),colorBgAlphaBlur:e.alpha(i),colorBgDark:g(d,t,n),colorBgDarker:g(c,t,n),colorBgLight:g(h,t,n),colorBgLighter:g(p,t,n),colorBgLightIntense:g(u,t,n),colorBgIntense:g(m,t,n),colorBgIntenser:g(v,t,n),colorBgIntserAlpha:b,colorBgInverse:g(f,t,n),colorBgInverser:g(y,t,n),colorBgFaded:g(w,t,n),backgroundBlur:o?`blur(${o}px)`:""}}function f(e,t,n){const i=e.darken(.5),o=e.luminance()>r?d:l;let a=s().mix(t.set("hsl.l",e.get("hsl.l")),t,.8);return a=g(a,t,n/4),{colorHighlightBg:e,colorHighlightBgUnfocused:a,colorHighlightBgAlpha:e.alpha(.1),colorHighlightBgDark:g(i,t,n),colorHighlightFg:o,colorHighlightFgAlpha:o.alpha(.5),colorHighlightFgAlphaHeavy:o.alpha(.25)}}function y(e,t,n){const i=e.luminance()>r,o=i?d:l,a=s().mix(o,e,.4),c=e.darken(.4),h=e.darken(1),p=i?e.brighten(.3).desaturate(1):e.darken(.3).desaturate(1),u=e.brighten(.5),m=e.brighten(1.2),v=g(e,e,n,!0),f=v.darken(.25);return{colorAccentBg:e,colorAccentBgAlpha:m.alpha(.4),colorAccentBgAlphaHeavy:m.alpha(.25),colorAccentBgDark:c,colorAccentBgDarker:h,colorAccentBgFaded:p,colorAccentBgFadedMore:u,colorAccentBgFadedMost:m,colorAccentBorder:v,colorAccentBorderDark:f,colorAccentFg:o,colorAccentFgFaded:a,colorAccentFgAlpha:o.alpha(.25)}}function w(e,t){const n=.003*t,i=e.luminance()<n?e.brighten(1):e.darken(.5),o=g(i,e,t),a=o.luminance()>e.luminance(),l=e.luminance()<=r?s().mix(o,e,.35):s().mix(o,e,.7),d=a?o.brighten(.4):o.darken(.4),c=g(i,e,t/2);return{colorBorder:o,colorBorderDisabled:g(l,e,t/2),colorBorderSubtle:s().mix(c,e,.25),colorBorderIntense:g(d,e,1.25*t)}}function b(e,t){const n=g(c,e,t),i=n.alpha(.1),s=n.luminance()>r?d:l,o=g(h,e,t),a=o.alpha(.1),u=o.luminance()>r?d:l,m=g(p,e,t),v=m.alpha(.1),f=m.luminance()>r?d:l;return{colorSuccessBg:n,colorSuccessBgAlpha:i,colorSuccessFg:s,colorWarningBg:o,colorWarningBgAlpha:a,colorWarningFg:u,colorErrorBg:m,colorErrorBgAlpha:v,colorErrorFg:f}}const C={forTheme:a()(5)((e=>{const t=6*e.contrast,n=2*e.contrast,i=1.5*e.contrast,o=1.5*e.contrast,a=3*e.contrast,c=6*e.contrast,h=g(s()(e.colorFg),s()(e.colorBg),t),p=g(s()(e.colorBg),s()(e.colorFg),n),u=g(s()(e.colorHighlightBg),s()(e.colorBg),i),C=g(s()(e.colorAccentBg),s()(e.colorBg),o,!0),S=e.colorWindowBg?s()(e.colorWindowBg):p,T=S.luminance()>r?d:l;return{...m(h,p,t),...v(p,h,n,e.alpha,e.blur),...f(u,p,i),...y(C,0,o),...w(p,a),...b(p,c),colorWindowBg:S,colorWindowFg:T}})),accentOnly:function(e,t,n,i){const s=2*i,o=1.5*i;return t=g(t,n,6*i),n=g(n,t,s),y(e=g(e,n,o),0,o)},fgBgHighlight:function(e,t,n){return e=g(e,t,6),t=g(t,e,2),n=g(n,t,1.5),{...m(e,t,6),...v(t,e,2,.75,10),...f(n,t,1.5)}}}},9719:(e,t,n)=>{"use strict";n.d(t,{nn:()=>i,eF:()=>s,ZP:()=>o});const i=16,s=12,o=(e,t)=>({radiusRound:e>-1?"100px":0,radiusRounded:e>-1?"2px":0,radiusRoundedLess:e>0?e-1+"px":0,radius:`${e}px`,radiusHalf:e/2+"px",scrollbarWidth:`${t?s:i}px`})},86461:(e,t,n)=>{"use strict";n.d(t,{w:()=>g,P:()=>m});var i=n(63353),s=n(29087),o=n(56371),a=n(89175);const r=[{id:"Spacer",label:(0,o.Z)("Space")},{id:"FlexibleSpacer",label:(0,o.Z)("Flexible Space")}],l={category:"navigation",label:(0,o.Z)("Navigation Toolbar"),pref:a.kToolbarsNavigation,buttons:[{id:"Back",label:(0,o.Z)("navigation","Back")},{id:"Forward",label:(0,o.Z)("navigation","Forward")},{id:"Rewind",label:(0,o.Z)("Rewind")},{id:"FastForward",label:(0,o.Z)("Fast Forward")},{id:"Reload",label:(0,o.Z)("Reload")},{id:"Home",label:(0,o.Z)("Home")},{id:"AddressField",label:(0,o.Z)("Address Field")},{id:"SearchField",label:(0,o.Z)("Search Field")},{id:"DownloadButton",label:(0,o.Z)("Downloads")},{id:"ReadingList",label:(0,o.Z)("Reading List")},{id:"AccountButton",label:(0,o.Z)("Account")},{id:"UpdateButton",label:(0,o.Z)("Update Status")},{id:"Extensions",label:(0,o.Z)("Extensions")},...r]},d={category:"status",label:(0,o.Z)("Status Toolbar"),pref:a.kToolbarsStatus,buttons:[{id:"PanelToggle",label:(0,o.Z)("Panel Toggle")},{id:"BreakMode",label:(0,o.Z)("Break Mode")},{id:"MailStatus",label:(0,o.Z)("Mail Status")},{id:"CalendarStatus",label:(0,o.Z)("Calendar Status")},{id:"SyncStatus",label:(0,o.Z)("Sync Status")},{id:"StatusInfo",label:(0,o.Z)("Status Info")},{id:"VersionInfo",label:(0,o.Z)("Version Info")},{id:"CaptureImages",label:(0,o.Z)("Capture Images")},{id:"TilingToggle",label:(0,o.Z)("Page Tiling")},{id:"ImagesToggle",label:(0,o.Z)("Toggle Images")},{id:"PageActions",label:(0,o.Z)("Page Actions")},{id:"Zoom",label:(0,o.Z)("Page Zoom")},{id:"Clock",label:(0,o.Z)("Clock")},...r]},c=[{id:"MailBack",label:(0,o.Z)("navigation","Back")},{id:"MailForward",label:(0,o.Z)("navigation","Forward")},{id:"MailReload",label:(0,o.Z)("Reload")}],h=[{id:"MailMsgReply",label:(0,o.Z)("Reply")},{id:"MailMsgReplyToAll",label:(0,o.Z)("Reply to All")},{id:"MailMsgForward",label:(0,o.Z)("mail","Forward")}],p={id:"MailMsgStatusRead",label:(0,o.Z)("Mark Unread")},u=[p,{id:"MailMsgFlag",label:(0,o.Z)("Flag")},{id:"MailMsgLabel",label:(0,o.Z)("Label")},{id:"MailMsgSpam",label:(0,o.Z)("Mark Spam")},{id:"MailMsgArchive",label:(0,o.Z)("Archive")},{id:"MailMsgTrash",label:(0,o.Z)("Trash")},{id:"MailRenderingMethod",label:(0,o.Z)("Rendering Method")},{id:"MailViewThreading",label:(0,o.Z)("Threads")},{id:"MailViewLayout",label:(0,o.Z)("Toggle Layout")}],g=[{...l},{...d},{...{category:"mail",label:(0,o.Z)("Mail Toolbar"),pref:a.kToolbarsMail,buttons:[...c,{id:"MailSearch",label:(0,o.Z)("Mail Search")},{id:"MailCompose",label:(0,o.Z)("Compose")},{id:"MailMsgEdit",label:(0,o.Z)("Edit Mail")},...h,...u,...r]}},{...{category:"mail_composer",label:(0,o.Z)("Mail Composer Toolbar"),pref:a.kToolbarsMailComposer,buttons:[...c,{id:"MailMsgSend",label:(0,o.Z)("Send")},{id:"MailMsgAttach",label:(0,o.Z)("Add Attachment")},{id:"MailMsgShowHeaders",label:(0,o.Z)("Show Headers")},{id:"MailMsgDiscard",label:(0,o.Z)("Discard")},p,...r]}},{...{category:"mail_message",label:(0,o.Z)("Mail Message Toolbar"),pref:a.kToolbarsMailMessage,buttons:[...c,...h,...u,...r]}}];function m(e,t){const n=s.Z.get(a.kToolbarsNavigation),o=s.Z.get(a.kToolbarsStatus),r=s.Z.get(a.kToolbarsMail).concat(s.Z.get(a.kToolbarsMailComposer)).concat(s.Z.get(a.kToolbarsMailMessage));if(!n.concat(o).concat(r).includes(e))return!1;const{isMailPage:l}=i.Z.getActivePage(t)||{isMailPage:!1},d=s.Z.get(a.kAddressBarVisible),c="on"===s.Z.get(a.kStatusBarDisplay);return n.includes(e)&&d&&!l||o.includes(e)&&c||r.includes(e)&&d&&l}},92571:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var i=n(3822),s=n(56371),o=n(94184),a=n.n(o),r=n(46884),l=n(67294),d=n(48521);const c={clearIndicator:()=>({}),container:()=>({}),control:()=>({}),dropdownIndicator:()=>({}),group:()=>({}),groupHeading:()=>({}),indicatorsContainer:()=>({}),indicatorSeparator:()=>({}),input:()=>({}),loadingIndicator:()=>({}),menu:()=>({}),menuList:()=>({}),menuPortal:()=>({}),multiValue:()=>({}),multiValueLabel:()=>({}),multiValueRemove:()=>({}),noOptionsMessage:()=>({}),option:()=>({}),placeholder:()=>({}),singleValue:()=>({}),valueContainer:()=>({})};const h=function(e){const{autoFocus:t,placeholder:n,commands:o,isClearable:h,openMenuOnFocus:p,isMulti:u,customStyles:g,selectedCommand:m}=e,v={...c,...g},f=()=>{y.current?.select?.blur()},y=(0,l.useRef)(null),w=(0,l.useRef)(null),b=(0,l.useCallback)((()=>w.current),[]),C=(0,l.useCallback)((()=>f),[]);(0,r.Z)(b,C);const S=a()("VivaldiSelector",e.className);return(0,d.jsx)("div",{ref:w,children:(0,d.jsx)(i.ZP,{ref:y,className:S,classNamePrefix:"Inner",autoFocus:t||!1,value:m,isClearable:h||!1,openMenuOnFocus:p||!1,isMulti:u||!1,onChange:t=>{return n=t,void e.setSelectedItem(n);var n},styles:v,onInputChange:(e,t)=>{"menu-close"===t.action&&f()},placeholder:n,options:o,loadingMessage:()=>(0,s.Z)("Loading..."),noOptionsMessage:()=>(0,s.Z)("No options")})})}},70864:(e,t,n)=>{"use strict";n.d(t,{Z:()=>g});var i=n(21788),s=n(53576),o=n(14481),a=n(68247),r=n(29087),l=n(62830),d=n.n(l),c=n(24899),h=n(89175);const p="webpanel",u={upgrade:function(e){const t=r.Z.get(h.kPanelsWebVersion);""===t&&u._upgrade(""),e&&e!==t&&u._upgrade(e)},_upgrade:function(e){const t=function(e){return void 0!==e.activeUrl&&void 0!==e.available&&void 0!==e.faviconUrl&&void 0!==e.faviconUrlValid&&void 0!==e.id&&void 0!==e.mobileMode&&"bundle"===e.origin&&void 0!==e.resizable&&void 0!==e.title&&void 0!==e.url&&void 0!==e.width};if(""===e){const e=r.Z.get(h.kPanelsWebList).map((e=>({activeUrl:e.activeUrl||e.contentUrl||"",available:e.available,faviconUrl:e.faviconUrl,faviconUrlValid:e.faviconUrlValid,id:e.id,mobileMode:e.mobileMode,origin:"user",resizable:Boolean(e.resizable),title:e.title,url:e.contentUrl,width:e.width})));(0,c.Z)(r.Z.getDefault(h.kPanelsWebItems)).forEach((n=>{t(n)?e.push(n):console.warn("Bundled web panel has wrong format",n)})),a.Z.set(h.kPanelsWebItems,e);const n=r.Z.get(h.kPanelsWebRemovedList).map((e=>({activeUrl:e.activeUrl||e.contentUrl||"",available:e.available,faviconUrl:e.faviconUrl,faviconUrlValid:e.faviconUrlValid,id:e.id,mobileMode:e.mobileMode,origin:"user",resizable:Boolean(e.resizable),title:e.title,url:e.contentUrl,width:e.width})));a.Z.set(h.kPanelsWebRemovedItems,n)}else{const n=(0,c.Z)(r.Z.get(h.kPanelsWebModified)),i=(0,c.Z)(r.Z.get(h.kPanelsWebItems));let s=!1;r.Z.getDefault(h.kPanelsWebItems).forEach((e=>{if(t(e)){const t=i.findIndex((t=>t.id===e.id));-1!==t||n.includes(e.id)?-1===t||n.includes(e.id)||i[t].mobileMode===e.mobileMode&&i[t].url===e.url||(i[t].mobileMode=e.mobileMode,i[t].url=e.url,s=!0):(i.push({activeUrl:e.activeUrl||e.url,available:e.available,faviconUrl:e.faviconUrl,faviconUrlValid:e.faviconUrlValid,id:e.id,mobileMode:e.mobileMode,origin:e.origin,resizable:e.resizable,title:e.title,url:e.url,width:e.width}),s=!0)}else console.warn("Bundled web panel has wrong format",e)}));const o=r.Z.getDefault(h.kPanelsWebItems);for(let e=i.length-1;e>=0;e--){const t=i[e];if("bundle"===t.origin&&!n.includes(t.id)){-1===o.findIndex((e=>e.id===t.id))&&(i.splice(e,1),s=!0)}}for(let e=n.length-1;e>=0;e--){const t=n[e];let a=i.findIndex((e=>e.id===t));-1===a&&(a=o.findIndex((e=>e.id===t)),-1===a&&(n.splice(e,1),s=!0))}a.Z.set(h.kPanelsWebVersion,e),s&&(a.Z.set(h.kPanelsWebModified,n),a.Z.set(h.kPanelsWebItems,i))}},addByUrl:function(e){u.addByUrls([e],-1)},addByUrls:function(e,t){const n=e.map((e=>({activeUrl:e,available:!0,faviconUrl:"",faviconUrlValid:!1,id:d()(),mobileMode:!0,origin:"user",resizable:!1,title:"",url:e,width:-1})));u.addPanels(n,t)},addPanels:function(e,t){const n=r.Z.get(h.kPanelsWebItems).slice();e.forEach((e=>{-1===t||t>=n.length?n.push(e):n.splice(t,0,e),-1!==t&&t++})),a.Z.set(h.kPanelsWebItems,n)},removeById:function(e){const t=r.Z.get(h.kPanelsWebItems);if(t.length>0){o.Z.destroyPeriodicAlarm(e);const n=t.filter((t=>t.id===e))[0],i=t.filter((t=>t.id!==e));if(a.Z.set(h.kPanelsWebItems,i),n){const t=r.Z.get(h.kPanelsWebRemovedItems).slice();if(t.push(n),a.Z.set(h.kPanelsWebRemovedItems,t),"bundle"===n.origin){const t=r.Z.get(h.kPanelsWebModified).slice();t.includes(e)||(t.push(e),a.Z.set(h.kPanelsWebModified,t))}}}},setMobileMode:function(e,t){const n=r.Z.get(h.kPanelsWebItems);if(n.length>0){const i=[];for(let s=0;s<n.length;s++){const o=n[s];i.push(o.id===e?{...o,mobileMode:t}:o)}a.Z.set(h.kPanelsWebItems,i)}},setAvailable:function(e,t){const n=r.Z.get(h.kPanelsWebItems);if(n.length>0){const i=[];for(let s=0;s<n.length;s++){const o=n[s];i.push(o.id===e?{...o,available:t}:o)}a.Z.set(h.kPanelsWebItems,i)}},setTitle:function(e,t){const n=r.Z.get(h.kPanelsWebItems);if(n.length>0){const i=[];for(let s=0;s<n.length;s++){const o=n[s];i.push(o.id===e?{...o,title:t}:o)}a.Z.set(h.kPanelsWebItems,i)}},setActiveUrl:function(e,t){const n=r.Z.get(h.kPanelsWebItems);if(n.length>0){const i=[];for(let s=0;s<n.length;s++){const o=n[s];i.push(o.id===e?{...o,activeUrl:t}:o)}a.Z.set(h.kPanelsWebItems,i)}},setUrl:function(e,t){const n=r.Z.get(h.kPanelsWebItems);if(n.length>0){const i=[];for(let s=0;s<n.length;s++){const o=n[s];i.push(o.id===e?{...o,url:t,activeUrl:t}:o)}a.Z.set(h.kPanelsWebItems,i)}},setFaviconUrl:function(e,t){const n=r.Z.get(h.kPanelsWebItems);if(n.length>0){const i=[];for(let s=0;s<n.length;s++){const o=n[s];i.push(o.id===e?{...o,faviconUrl:t,faviconUrlValid:!0}:o)}a.Z.set(h.kPanelsWebItems,i)}},recoverWebPanel:function(e){const t=r.Z.get(h.kPanelsWebRemovedItems);if(t.length>0&&e<t.length){const n=t[e];if("bundle"===n.origin){const e=r.Z.get(h.kPanelsWebModified).slice(),t=e.findIndex((e=>e===n.id));-1!==t&&(e.splice(t,1),a.Z.set(h.kPanelsWebModified,e))}u.addPanels([n],-1);const i=t.slice();i.splice(e,1),a.Z.set(h.kPanelsWebRemovedItems,i)}},emptyTrash:function(){a.Z.set(h.kPanelsWebRemovedList,[]),a.Z.set(h.kPanelsWebRemovedItems,[])},copyWebPanelAdress:function(e){const t=this.getUrlById(e);t.length>0&&i.Z.copyUrlToClipboard(t)},getUrlById:function(e){const t=r.Z.get(h.kPanelsWebItems).filter((t=>e===t.id)).map((e=>e.activeUrl));return t.length>0?t[0]:""},openInTab:function(e,t,n,i){const o=this.getUrlById(t);o.length>0&&s.Z.openURL(e,o,{inCurrent:n,inBackground:i})},openInNewWindow:function(e,t,n){const i=this.getUrlById(t);i.length>0&&s.Z.openURL(e,i,{inNewWindow:!0,incognito:n})},getIndexByShortcut:function(e){const t=p.length,n=e.substr(0,t),i=e.substr(t).trim();return n===p&&i>="1"&&i<="9"?parseInt(i):-1},setUIContent:function(e){const t=r.Z.get(h.kPanelsWebToolbar);t.showToolbar=e.showToolbar,t.allControls=e.allControls,a.Z.set(h.kPanelsWebToolbar,t)},getFaviconPrefix:function(){return"chrome://favicon/"}},g=u},71828:(e,t,n)=>{"use strict";n.d(t,{an:()=>i,bI:()=>s,OK:()=>o,pL:()=>a,Wp:()=>r,rM:()=>l,XF:()=>d,qt:()=>c,Zh:()=>h,XZ:()=>p,VH:()=>u,oJ:()=>g,s5:()=>m,m6:()=>v});const i=1,s=.5,o=4,a=.25,r=.05,l=1,d=.2,c=5,h=.1,p=1,u=.5,g=2,m=.05,v=1},46601:(e,t,n)=>{"use strict";n.d(t,{FD:()=>se,CN:()=>de,xU:()=>oe,os:()=>re,_H:()=>le});var i=n(8429),s=n(39005),o=n(15590),a=n(61757),r=n(15800),l=n(84675),d=n(21788),c=n(57082),h=n(87210),p=n(5198),u=n(9185),g=n(2431),m=n(46382),v=n(55022),f=n(53576),y=n(63353),w=n(18350),b=n(15285),C=n(14481),S=n(68247),T=n(29087),I=n(92413),k=n(54614),A=n(40893),Z=n(62645),E=n(84990);const _=new class{switchTabBackBySetting(e,t){E.Z.dispatch({actionType:"TAB_SWITCH_BACK_SETTING",winId:e,event:t})}switchTabForwardBySetting(e,t){E.Z.dispatch({actionType:"TAB_SWITCH_FORWARD_SETTING",winId:e,event:t})}stackUntile(e){E.Z.dispatch({actionType:"TAB_STACK_UNTILE",winId:e})}stackCreate(e){E.Z.dispatch({actionType:"TAB_STACK_CREATE",winId:e})}stackDissolve(e){E.Z.dispatch({actionType:"TAB_STACK_DISSOLVE",winId:e})}stackRemove(e){E.Z.dispatch({actionType:"TAB_STACK_REMOVE",winId:e})}stackTileGrid(e){E.Z.dispatch({actionType:"TAB_STACK_TILE_GRID",winId:e})}stackTileHorizontal(e){E.Z.dispatch({actionType:"TAB_STACK_TILE_HORIZONTAL",winId:e})}stackTileVertical(e){E.Z.dispatch({actionType:"TAB_STACK_TILE_VERTICAL",winId:e})}viewPageSource(e){E.Z.dispatch({actionType:"TAB_VIEW_PAGE_SOURCE",winId:e})}toggleTabThumbnail(e){E.Z.dispatch({actionType:"TAB_TOGGLE_THUMBNAIL",winId:e})}};var N=n(2699),M=n(32773),P=n(54058),D=n(76501),x=n(83526),O=n(63153),L=n(15489),R=n(22303),B=n(56371),F=n(92292),U=n(26036),V=n(7064),W=n(71828),H=n(35369),z=n(19626),G=n(62882);const $=()=>{const e=G.ZP.getFilteredFlat("",{inTrash:!1});K((t=>{t?e.forEach((e=>{const{content:n="",url:i="",dateAdded:s=0}=e,o=new Date(s).toString(),a=new Blob([`${n}\n${o}\n${i||""}`]),r=`${n.substring(0,4)}_ ${e.id}.txt`;F.Z.fileSystem.getWritableEntry(t,(e=>{e.getFile(r,{create:!0},(e=>{e.createWriter((e=>{let t=!1;e.onwriteend=function(e){if(!t)return t=!0,void this.truncate(a.size)},e.onerror=function(e){console.warn("Error Exporting Notes: "+e.toString())},e.write(a)}))}))}))})):console.warn("Error exporting notes, directory missing")}))},K=e=>{F.Z.fileSystem.chooseEntry({type:"openDirectory"},(t=>{const n=F.Z.runtime.lastError;n?console.error(n.message):e(t)}))},j=()=>{K((e=>{if(!e)return void console.warn("Error importing notes, directory missing");const t=e.createReader(),n=()=>{t.readEntries((function(e){e.length>0&&(e.forEach((e=>{e.file((function(e){const t=new FileReader;t.onloadend=function(){const e=this.result;e&&V.Z.notes.create({content:e})},t.readAsText(e)}),(e=>{console.warn("Error reading file "+e)}))})),n())}))};n()}))};var Y=n(69046),X=n(10334),Q=n(86461),q=n(89175),J=n(21191),ee=n(92521),te=n(44850);const ne=!1,ie=e=>"object"==typeof e&&"wheel"===e.type,se={COMMAND_OPEN_LINK:"https://www.vivaldi.com"},oe=e=>le[e],ae=["COMMAND_CLIPBOARD_UNDO","COMMAND_CLIPBOARD_REDO","COMMAND_CLIPBOARD_CUT","COMMAND_CLIPBOARD_COPY","COMMAND_CLIPBOARD_PASTE","COMMAND_CLIPBOARD_SELECT_ALL","COMMAND_HIDE_OTHERS","COMMAND_HIDE_VIVALDI","COMMAND_SHOW_ALL"],re=e=>ae.includes(e),le={COMMAND_TAB_PERIODIC_RELOAD:{type:"mixed",defaultValue:60,unit:(0,B.Z)("time","Seconds"),min:60,max:31556926,validity:/(^(\d+'(\d+")?|\d+")$)/g},COMMAND_MAIN_ZOOM:{type:"number",unit:(0,B.Z)("Percentage"),defaultValue:100*W.m6,min:100*W.XF,max:100*W.qt},COMMAND_MAIN_UI_ZOOM:{type:"number",unit:(0,B.Z)("Percentage"),defaultValue:100*W.m6,min:100*W.bI,max:100*W.OK}},de=[{name:"COMMAND_NEW_WINDOW",action:e=>{L.ZP.isGuestSession(e.windowId)?m.Z.openGuestWindow():O.Z.openBrowserWindow(e.windowId)},isEnabled:ee.Z,withNoWindow:!0,showInQC:!0,category:"CATEGORY_COMMAND_APPLICATION",guid:"b6ddaabf-d87f-4c2c-affa-ce81bb30bfca",...(0,U.Z)("command","New Window")},{name:"COMMAND_NEW_PRIVATE_WINDOW",action:e=>O.Z.openIncognitoWindow(e.windowId),isEnabled:e=>!L.ZP.isGuestSession(e),withNoWindow:!0,showInQC:!0,category:"CATEGORY_COMMAND_APPLICATION",guid:"176ff9a8-a516-4015-9b0a-14434746ce9b",...(0,U.Z)("New Private Window")},{name:"COMMAND_NEW_GUEST_WINDOW",action:()=>m.Z.openGuestWindow(),isEnabled:e=>!L.ZP.isIncognito(e),category:"CATEGORY_COMMAND_APPLICATION",showInQC:!0,guid:"1453aae1-130d-465f-98eb-cbda5061445d",...(0,U.Z)("New Guest Window")},{name:"COMMAND_MANAGE_PEOPLE",action:()=>m.Z.managePeople(),category:"CATEGORY_COMMAND_APPLICATION",isEnabled:ee.Z,showInQC:!0,guid:"49023738-dc53-4fce-8fd8-68bcdc89be34",...(0,U.Z)("Manage Profiles")},{name:"COMMAND_CLOSE_WINDOW",action:e=>O.Z.close(e.windowId),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"172583c9-c8d5-45f7-9e4d-65cff9333679",...(0,U.Z)("command","Close Window")},{name:"COMMAND_SHOW_QUICK_COMMANDS",action:e=>m.Z.showQuickCommand(e.windowId),showInQC:!1,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"f8d653f3-1371-4cf2-ab83-b8c62ad98add",...(0,U.Z)("Quick Commands")},{name:"COMMAND_CUSTOMIZE_TOOLBAR",action:e=>M.Z.edit(q.kToolbarsNavigation),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"fd9a4bd8-25a8-4006-8e63-251f166aa862",...(0,U.Z)("Customize Toolbar")},{name:"COMMAND_FULLSCREEN",action:e=>O.Z.toggleFullscreen(e.windowId),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"7420368f-565e-409f-8eec-5b5c578429af",...(0,U.Z)("Fullscreen Mode")},{name:"COMMAND_TASK_MANAGER",action:e=>V.Z.utilities.openTaskManager(e.windowId),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"3aed82ac-e497-4f75-9f13-c5a7df0ac448",...(0,U.Z)("Task Manager")},{name:"COMMAND_SHOW_SETTINGS",action:e=>m.Z.showSettings(e.windowId),isEnabled:e=>!L.ZP.isGuestSession(e),showInQC:!0,category:"CATEGORY_COMMAND_APPLICATION",guid:"1e05a540-7261-427f-a902-8a75f5e81cdd",...(0,U.Z)("Settings")},{name:"COMMAND_SHOW_ACCOUNT_SHEET",action:e=>m.Z.showAccountSheet(e.windowId),isEnabled:e=>(L.ZP.isGuestSession(e),!1),showInQC:!0,category:"CATEGORY_COMMAND_APPLICATION",guid:"ae3f522d-999f-4733-905b-1b0d45ee7e85",...(0,U.Z)("Account Sheet")},{name:"COMMAND_SHOW_EXTENSIONS",action:e=>m.Z.showExtensions(e.windowId),withNoWindow:!0,showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"ef8d7f53-627c-4286-a03e-7affc92b5ff3",...(0,U.Z)("Extensions")},{name:"COMMAND_SHOW_HISTORY",action:e=>m.Z.showHistory(e.windowId),withNoWindow:!0,isEnabled:ee.Z,showInQC:!0,category:"CATEGORY_COMMAND_APPLICATION",guid:"dd8723f0-b05a-4d22-b55b-b1c1a6e282e2",...(0,U.Z)("History")},{name:"COMMAND_SHOW_NOTES",action:e=>m.Z.showNotes(e.windowId),withNoWindow:!0,showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"97006589-839d-4c3e-aa37-311a864618b5",...(0,U.Z)("Notes")},{name:"COMMAND_SHOW_BOOKMARKS",action:e=>m.Z.showBookmarks(e.windowId),withNoWindow:!0,isEnabled:e=>!L.ZP.isGuestSession(e),showInQC:!0,category:"CATEGORY_COMMAND_APPLICATION",guid:"9cde01a4-9df7-4a2e-84a1-27997c6df705",...(0,U.Z)("Bookmarks")},{name:"COMMAND_SHOW_WELCOME",action:e=>m.Z.showWelcome(e.windowId),isEnabled:e=>!L.ZP.isGuestSession(e),withNoWindow:!0,showInQC:!0,category:"CATEGORY_COMMAND_APPLICATION",guid:"3e27424f-656a-48bf-85e4-01364ec27b57",...(0,U.Z)("Vivaldi Welcome Tour")},{name:"COMMAND_SHOW_CLEAR_PRIVATE_DATA",action:e=>m.Z.showClearBrowsingHistoryDialog(e.windowId),isEnabled:e=>!L.ZP.isIncognitoOrGuest(e),showInQC:!0,category:"CATEGORY_COMMAND_APPLICATION",guid:"10a45d9e-c539-4c67-92fd-c2332fb41127",...(0,U.Z)("command","Delete Browsing Data")},{name:"COMMAND_SHOW_BOOKMARK_BAR",action:e=>O.Z.toggleBookmarksBar(e.windowId),behavior:"checkbox",showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"42b84fc2-a9c1-425d-a08f-f349dbb6e8a6",...(0,U.Z)("Bookmarks Bar")},{name:"COMMAND_TOGGLE_APPLE_EVENTS",action:()=>S.Z.toggle(q.kAllowJavascriptAppleEvents,!0,!1),inMenu:ne,showInQC:ne,isEnabled:()=>ne,platforms:["mac"],category:"CATEGORY_COMMAND_APPLICATION",guid:"c8908d2a-9b77-4eb3-bdcf-327f5d78fe60",...(0,U.Z)("Apple Events")},{name:"COMMAND_TOGGLE_MENU_POSITION",action:()=>S.Z.toggle(q.kMenuDisplay,"vivaldi","top"),inMenu:!0,showInQC:!0,isEnabled:()=>!0,platforms:["linux","windows"],behavior:"checkbox",category:"CATEGORY_COMMAND_APPEARANCE",guid:"6c186895-cfb1-4ce5-8d9b-21484a438ef6",...(0,U.Z)("command","Menu Position")},{name:"COMMAND_TOGGLE_FOOTER",action:e=>O.Z.toggleStatusBar(e.windowId),behavior:"checkbox",showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"ea570117-f29e-4fd2-b4de-649a4660a4f2",...(0,U.Z)("other","Status Bar")},{name:"COMMAND_TOGGLE_STARTPAGE_NAVIGATION",action:()=>S.Z.toggle(q.kStartpageNavigation,"off","on"),behavior:"checkbox",showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"a1563471-d01b-4e7f-8a40-552120443cd5",...(0,U.Z)("other","Start Page Navigation")},{name:"COMMAND_TOGGLE_PRIVACY_STATS",action:()=>S.Z.toggle(q.kStartpageSpeedDialPrivacyStatsShow,!1,!0),behavior:"checkbox",showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"dad8a820-629c-4146-b105-9ad0b3755b25",...(0,U.Z)("other","Show Privacy Statistics")},{name:"COMMAND_TOGGLE_INTERFACE_COLOR",action:()=>N.Z.setNextTheme(),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"0a9303d7-c8b0-4b0d-b6e0-02a5ba457360",...(0,U.Z)("Next Theme")},{name:"COMMAND_EXIT",action:()=>{V.Z.runtimePrivate.exit()},inMenu:!0,showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"842121fd-5e5a-48f3-95ad-947d37aebedb",...(0,U.Z)("verb","Exit")},{name:"COMMAND_QUIT_MAC_MAYBE_WARN",action:()=>{},inMenu:ne,showInQC:!1,isEnabled:()=>ne,platforms:["mac"],category:"CATEGORY_COMMAND_APPLICATION",withNoWindow:!0,guid:"ff0ac033-0fcf-4c77-b664-7f7c3e4a2044",...(0,U.Z)("Quit $1",["Vivaldi"])},{name:"COMMAND_SHOW_HELP",action:e=>f.Z.openURL(e.windowId,"https://help.vivaldi.com/?pk_campaign=v-menu"),withNoWindow:!0,showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"643fde7b-ac28-4241-b0d0-bc221ee88785",...(0,U.Z)("browser","Vivaldi Help")},{name:"COMMAND_SHOW_KEYBOARDSHORTCUTS",action:e=>m.Z.showKeyboardShortcuts(e.windowId),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"12ab9d03-8327-4e5d-a905-609af0ab5528",...(0,U.Z)("Keyboard Cheat Sheet")},{name:"COMMAND_REPORT_BUG",action:e=>f.Z.openURL(e.windowId,"https://forum.vivaldi.net/?pk_campaign=v-menu"),withNoWindow:!0,showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"f9f6da04-7ebc-4fb4-8633-f122ca145217",...(0,U.Z)("Report a Bug on the Forum")},{name:"COMMAND_SHOW_PAGE_ACCESS_KEYS",action:e=>m.Z.showPageAccessKeys(e.windowId),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"7838709a-7042-4913-b541-25ff2268f774",...(0,U.Z)("Show Webpage Access Key Shortcuts")},{name:"COMMAND_BREAKMODE_TOGGLE",action:e=>o.Z.toggleBreakMode(e.windowId),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"a3596917-8095-42e9-8efb-31ad8ad0cbaa",...(0,U.Z)("command","Break Mode")},{name:"COMMAND_START_CHROMECAST",action:e=>m.Z.startCasting(e.windowId),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"8b650af8-6342-48f5-a45b-2d56933fb389",...(0,U.Z)("Cast")},{name:"COMMAND_MAIN_TOGGLE_TAB_BAR",action:e=>O.Z.toggleTabs(e.windowId),behavior:"checkbox",showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"c4bfbdc9-1e24-4b60-bbfe-a706be090f7b",...(0,U.Z)("command","Tab Bar")},{name:"COMMAND_MAIN_TOGGLE_PANEL_TOGGLE",action:e=>O.Z.togglePanelToggle(e.windowId),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"1ad09f05-6a12-41e9-9bf3-ddf58f24bea4",...(0,U.Z)("Panel Toggle")},{name:"COMMAND_MAIN_TOGGLE_ADDRESS_BAR",action:e=>O.Z.toggleAddressBar(e.windowId),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"14fc610b-d5dc-49fc-973d-4d666394948b",...(0,U.Z)("other","Address Bar")},{name:"COMMAND_MAIN_TOGGLE_UI",action:e=>O.Z.toggleMinimalUI(e.windowId),behavior:"checkbox",showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"3b773be0-6af6-47f4-807c-19ad590693a2",...(0,U.Z)("Toggle UI")},{name:"COMMAND_CAPTURE_AREA_TO_DISK",action:e=>l.Z.captureArea(e.windowId,"file"),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"6ae02ffe-8039-4689-9e73-a7cd5ae792b3",...(0,U.Z)("Capture Area to File")},{name:"COMMAND_CAPTURE_AREA_TO_CLIPBOARD",action:e=>l.Z.captureArea(e.windowId,"clipboard"),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"2c2057eb-ec79-4d9e-a8de-5bbb0c2a6249",...(0,U.Z)("Capture Area to Clipboard")},{name:"COMMAND_FOCUS_NEXT",action:e=>m.Z.stepFocus(e.windowId,!0),repeat:!0,showInQC:!1,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"8202e8f1-c0d1-4a85-bbab-f66a52656a30",...(0,U.Z)("Focus Next Pane")},{name:"COMMAND_FOCUS_PREVIOUS",action:e=>m.Z.stepFocus(e.windowId,!1),repeat:!0,showInQC:!1,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"0dc4e130-6728-46e0-a632-3a2e7d817f2a",...(0,U.Z)("Focus Previous Pane")},{name:"COMMAND_NEW_TAB",action:e=>{const t="COMMAND_NEW_TAB";if(!c.Z.hasListener(t))return f.Z.openURL(e.windowId,"");c.Z.onCommand(e.windowId,t)},withNoWindow:!0,showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"b3515e1b-9cf2-4ba0-ba34-fac6ce308b08",...(0,U.Z)("command","New Tab")},{name:"COMMAND_NEW_TAB_OUTSIDE_GROUP",action:e=>f.Z.openURL(e.windowId,""),withNoWindow:!0,showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"4b4d97fa-f94d-4bc1-80b6-2849a56dbe42",...(0,U.Z)("command","New Top Level Tab")},{name:"COMMAND_NEW_BACKGROUND_TAB",action:e=>f.Z.openURL(e.windowId,"",{inBackground:!0}),withNoWindow:!0,showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"5c2631d5-69cd-4bd5-b6e2-93b8a6ca0281",...(0,U.Z)("New Background Tab")},{name:"COMMAND_CLONE_TAB",action:e=>y.Z.isSelecting(e.windowId)?f.Z.clonePages(y.Z.getSelectedPages(e.windowId)):f.Z.clonePages(H.aV.of(y.Z.getActivePage(e.windowId)).filter(Boolean)),showInQC:!0,category:"CATEGORY_COMMAND_TAB_ACTION",isEnabled:ee.Z,guid:"74393bfb-4c31-4b25-afc4-471cb9d621ca",...(0,U.Z)("Clone Selected Tabs")},{name:"COMMAND_MOVE_TAB_TO_NEW_WINDOW",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&f.Z.detachPage(t)},showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"d03d4bc8-26c4-49f6-b3ce-23980637ae76",...(0,U.Z)("Move Tab to New Window")},{name:"COMMAND_PIN_TAB",action:e=>f.Z.toggleSelectedPagesPinned(e.windowId),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"8b413c0e-9024-4fbe-8813-68c76096c87b",...(0,U.Z)("Pin / Unpin Tab")},{name:"COMMAND_CLOSE_TAB",action:e=>f.Z.close(e.windowId),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"f0a3a628-6977-4812-ab11-96a1d1fbc08d",...(0,U.Z)("Close Tab")},{name:"COMMAND_POSITION_TAB_TOP",action:()=>S.Z.set(q.kTabsBarPosition,"top"),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"7be0e09e-a13a-4438-ad6b-2d43734e2a7d",...(0,U.Z)("Tabs on Top")},{name:"COMMAND_POSITION_TAB_BOTTOM",action:()=>S.Z.set(q.kTabsBarPosition,"bottom"),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"1585fbcb-db49-4b0c-afd0-e3abc19456fd",...(0,U.Z)("Tabs on Bottom")},{name:"COMMAND_POSITION_TAB_LEFT",action:()=>S.Z.set(q.kTabsBarPosition,"left"),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"35cac9b1-4c5e-433a-abbb-b69f123b26b9",...(0,U.Z)("Tabs on Left")},{name:"COMMAND_POSITION_TAB_RIGHT",action:()=>S.Z.set(q.kTabsBarPosition,"right"),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"f3016405-4ac9-45a2-91d4-ddc8127cd9de",...(0,U.Z)("Tabs on Right")},{name:"COMMAND_CLOSE_TAB_TO_LEFT",action:e=>{const t=y.Z.getActivePage(e.windowId);if(t){const n=y.Z.isGroup((0,Y.av)(t),e.windowId);f.Z.closeToLeft(e.windowId,t,n)}},showInQC:!0,isEnabled:e=>L.ZP.isTabbedBrowser(e),category:"CATEGORY_COMMAND_TAB_ACTION",guid:"cd97956b-c939-4271-9037-1676c70e4fa4",...(0,U.Z)("Close Tabs to the Left")},{name:"COMMAND_CLOSE_TAB_TO_RIGHT",action:e=>{const t=y.Z.getActivePage(e.windowId);if(t){const n=y.Z.isGroup((0,Y.av)(t),e.windowId);f.Z.closeToRight(e.windowId,t,n)}},showInQC:!0,isEnabled:e=>L.ZP.isTabbedBrowser(e),category:"CATEGORY_COMMAND_TAB_ACTION",guid:"cfb3068d-5e79-4dac-a741-50879d4e81db",...(0,U.Z)("Close Tabs to the Right")},{name:"COMMAND_CLOSE_ALL_BUT_ACTIVE_TAB",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&f.Z.closeOther(t,!1)},showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"275ca3f7-ecfb-4445-bf87-686cd473536e",...(0,U.Z)("Close Other Tabs")},{name:"COMMAND_TAB_THUMBNAIL",action:e=>_.toggleTabThumbnail(e.windowId),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"c46c994e-81a8-4b4b-ae15-4e64a643af7b",...(0,U.Z)("Tab Thumbnail")},{name:"COMMAND_SHOW_ABOUT",action:e=>f.Z.openURL(e.windowId,te.jk.internals.about),category:"CATEGORY_COMMAND_APPLICATION",withNoWindow:!0,isEnabled:ee.Z,showInQC:!0,guid:"b5396606-e86b-4cca-bd74-029f3c538423",...(0,U.Z)("About")},{name:"COMMAND_CHECK_FOR_UPDATES",action:()=>V.Z.autoUpdate.checkForUpdates(!0),showInQC:e=>!L.ZP.isGuestSession(e),isEnabled:e=>!L.ZP.isGuestSession(e),platforms:["windows","mac"],withNoWindow:!0,category:"CATEGORY_COMMAND_APPLICATION",guid:"b4ef4439-df4a-4634-95f7-509c95e42b69",...(0,U.Z)("Check for Updates")},{name:"COMMAND_SHOW_COMMUNITY",action:e=>f.Z.openURL(e.windowId,"https://vivaldi.net/?pk_campaign=v-menu"),withNoWindow:!0,showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"cb626c77-47cd-46e3-9cf7-d976f50aadbd",...(0,U.Z)("Community Blogs")},{name:"COMMAND_TAB_SWITCH_BACK_SETTING",action:e=>_.switchTabBackBySetting(e.windowId,ie(e.param)?e.param:e.keyState),inMenu:!1,isEnabled:ee.Z,repeat:!0,showInQC:!1,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"ee5eec5e-9ebf-4faf-b2ec-4fdba8b328d0",...(0,U.Z)("Tab Cycler Back")},{name:"COMMAND_TAB_SWITCH_FORWARD_SETTING",action:e=>_.switchTabForwardBySetting(e.windowId,ie(e.param)?e.param:e.keyState),inMenu:!1,repeat:!0,isEnabled:ee.Z,showInQC:!1,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"7c2836f2-93e5-445f-9674-46a29759ff34",...(0,U.Z)("Tab Cycler Forward")},{name:"COMMAND_TAB_SWITCH_BACK_ORDER",action:e=>{const t=ie(e.param)?e.param:e.keyState;f.Z.cycleByOrder(e.windowId,t,{goBack:!0})},repeat:!0,showInQC:!0,category:"CATEGORY_COMMAND_TAB_ACTION",isEnabled:ee.Z,guid:"9693c49b-29e0-442e-925d-d34d95f977a4",...(0,U.Z)("Previous Tab (by Order)")},{name:"COMMAND_TAB_SWITCH_FORWARD_ORDER",action:e=>{const t=ie(e.param)?e.param:e.keyState;f.Z.cycleByOrder(e.windowId,t,{goBack:!1})},repeat:!0,showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"037d899d-b191-49c7-a932-87d8881d7037",...(0,U.Z)("Next Tab (by Order)")},{name:"COMMAND_TAB_SWITCH_FORWARD_HISTORY",action:e=>{const t=ie(e.param)?e.param:e.keyState;f.Z.cycleByHistory(e.windowId,t,{goBack:!1})},repeat:!0,isEnabled:ee.Z,showInQC:!0,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"a645ffdf-6235-425a-896e-3dfd8d4eebb1",...(0,U.Z)("Previous Tab (Recent)")},{name:"COMMAND_TAB_SWITCH_BACK_HISTORY",action:e=>{const t=ie(e.param)?e.param:e.keyState;f.Z.cycleByHistory(e.windowId,t,{goBack:!0})},repeat:!0,showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"0c39ac37-1deb-4dc8-bea4-54672978af06",...(0,U.Z)("Next Tab (Recent)")},{name:"COMMAND_TAB_MOVE_FIRST",action:e=>c.Z.onCommand(e.windowId,"COMMAND_TAB_MOVE_FIRST"),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"d15338f7-43e6-4e36-b813-aaab299554df",...(0,U.Z)("Move Tabs to Beginning")},{name:"COMMAND_TAB_MOVE_END",action:e=>c.Z.onCommand(e.windowId,"COMMAND_TAB_MOVE_END"),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"478e7f24-51b6-499e-be8d-eda14148f4a7",...(0,U.Z)("Move Tabs to End")},{name:"COMMAND_TAB_MOVE_BACKWARD",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&f.Z.stepPage(t,!1,"dotted"===T.Z.get(q.kTabsStackingMode),e.windowId)},showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"bb5e2bde-67dd-40ff-9d87-43032f048b7a",...(0,U.Z)("Move Active Tab Backward")},{name:"COMMAND_TAB_MOVE_FORWARD",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&f.Z.stepPage(t,!0,"dotted"===T.Z.get(q.kTabsStackingMode),e.windowId)},showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"8338b153-b32d-4a29-962e-cb3bbc5861d0",...(0,U.Z)("Move Active Tab Forward")},{name:"COMMAND_TAB_DISABLE_ALL_RELOADS",action:()=>C.Z.destroyAllPeriodicAlarms(),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"7d40d732-b025-4722-bc23-b66ada752339",...(0,U.Z)("Disable Periodic Timers")},{name:"COMMAND_TAB_PERIODIC_RELOAD",action:async e=>{if(e.param){const t=(0,X.AE)(e.param),n=y.Z.getActivePage(e.windowId);if(n){const e=n.vivExtData.ext_id;if(e){const n=t/60;await C.Z.createPeriodicReloadAlarm({id:e,interval:n,from:"tab"})}}}},showInQC:!0,inMenu:!1,category:"CATEGORY_COMMAND_TAB_ACTION",isEnabled:ee.Z,guid:"bf7a3a4a-565a-46c7-835c-fa2a6d4b7fdf",...(0,U.Z)("tab","Periodic Reload")},{name:"COMMAND_PAGE_SELECTION_CURRENT",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&f.Z.setSelection(t)},showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"2cd718aa-76d4-4bd4-9c55-6117822d402e",...(0,U.Z)("other","Select Current Tab")},{name:"COMMAND_PAGE_SELECTION_EXPAND_PREVIOUS",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&f.Z.expandSelectionPrevious(t)},showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"e245bce5-20a7-481f-910e-23bf1de86748",...(0,U.Z)("other","Select Previous Tab")},{name:"COMMAND_PAGE_SELECTION_EXPAND_NEXT",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&f.Z.expandSelectionNext(t)},showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"23e27390-f1bf-4ec3-92b5-7634daeabc5b",...(0,U.Z)("other","Select Next Tab")},{name:"COMMAND_PAGE_SELECTION_TOGGLE_RELATED",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&f.Z.toggleRelatedSelection(t)},showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"7ef25cfa-632f-4872-832c-ca6c9dfb5769",...(0,U.Z)("other","Select Related Tabs")},{name:"COMMAND_PAGE_SELECTION_CLEAR",action:e=>f.Z.clearSelection(e.windowId),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"cf44c36e-ab42-4700-a80e-93f5f504c72b",...(0,U.Z)("other","Deselect Tabs")},{name:"COMMAND_RENAME_TAB_STACK",action:e=>c.Z.onCommand(e.windowId,"COMMAND_RENAME_TAB_STACK"),showInQC:!0,isEnabled:e=>{const t=y.Z.getActivePage(e);return!!t&&y.Z.isGroup((0,Y.av)(t),e)},category:"CATEGORY_COMMAND_TAB_ACTION",guid:"a453b19c-8c8e-48e4-8e5b-f9d494086b0d",...(0,U.Z)("Rename Tab Stack")},{name:"COMMAND_TAB_SWITCH_1",action:e=>f.Z.activateTabByIndex(e.windowId,0),showInQC:!1,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"a4d46cc3-e258-4c20-ab39-3174ec9acbb9",...(0,U.Z)("Switch to Tab 1")},{name:"COMMAND_TAB_SWITCH_2",action:e=>f.Z.activateTabByIndex(e.windowId,1),showInQC:!1,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"3a792281-c3a3-4501-b64c-b5173206195d",...(0,U.Z)("Switch to Tab 2")},{name:"COMMAND_TAB_SWITCH_3",action:e=>f.Z.activateTabByIndex(e.windowId,2),showInQC:!1,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"5e570a93-4779-4266-aebe-f2abe0e081ae",...(0,U.Z)("Switch to Tab 3")},{name:"COMMAND_TAB_SWITCH_4",action:e=>f.Z.activateTabByIndex(e.windowId,3),showInQC:!1,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"34281a36-77c7-4f3c-99e1-73529174cfb6",...(0,U.Z)("Switch to Tab 4")},{name:"COMMAND_TAB_SWITCH_5",action:e=>f.Z.activateTabByIndex(e.windowId,4),showInQC:!1,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"71cd67b0-77bb-4cf3-a7ee-8e26462eb42e",...(0,U.Z)("Switch to Tab 5")},{name:"COMMAND_TAB_SWITCH_6",action:e=>f.Z.activateTabByIndex(e.windowId,5),showInQC:!1,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"d8b8a23c-f47b-4341-8adc-844cc52562b1",...(0,U.Z)("Switch to Tab 6")},{name:"COMMAND_TAB_SWITCH_7",action:e=>f.Z.activateTabByIndex(e.windowId,6),showInQC:!1,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"c537cc07-a3ff-4151-997c-40e25056e65d",...(0,U.Z)("Switch to Tab 7")},{name:"COMMAND_TAB_SWITCH_8",action:e=>f.Z.activateTabByIndex(e.windowId,7),showInQC:!1,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"710bb550-7dea-4436-9d0c-fea152299507",...(0,U.Z)("Switch to Tab 8")},{name:"COMMAND_TAB_SWITCH_9",action:e=>f.Z.activateTabByIndex(e.windowId,8),showInQC:!1,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"91f469f5-f527-433c-a1fa-2e3f399c7820",...(0,U.Z)("Switch to Tab 9")},{name:"COMMAND_TAB_SWITCH_LAST",action:e=>f.Z.openLastPage(e.windowId),showInQC:!1,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"750d7779-97ec-493d-afa8-a62c179d6d82",...(0,U.Z)("Switch to the Last Tab")},{name:"COMMAND_HIBERNATE_OTHER_TABS",action:e=>(0,X.Xf)(e.windowId),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"62655c2c-509d-40f9-aec9-d4428af56884",...(0,U.Z)("Hibernate Background Tabs")},{name:"COMMAND_SHOW_CLOSED_TABS",action:e=>c.Z.onCommand(e.windowId,"COMMAND_SHOW_CLOSED_TABS"),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"ba89f260-0036-4f93-95aa-11b65790621d",...(0,U.Z)("Show Closed Tabs")},{name:"COMMAND_TAB_REOPEN_RECENTLY_CLOSED",action:()=>D.Z.undeletePreviousTab(),tweakedShortcut:"ctrl+z",withNoWindow:!0,showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"7e925f03-11a3-47b4-b092-e1c355661796",...(0,U.Z)("Reopen Closed Tab")},{name:"COMMAND_TAB_STACK_TILE_VERTICAL",action:e=>_.stackTileVertical(e.windowId),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"854f8a44-50bd-41bc-8277-acd51e719d1b",...(0,U.Z)("Tile Vertically")},{name:"COMMAND_TAB_STACK_TILE_HORIZONTAL",action:e=>_.stackTileHorizontal(e.windowId),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"2991fb16-2df8-42b5-898a-25a0d028ac41",...(0,U.Z)("Tile Horizontally")},{name:"COMMAND_TAB_STACK_TILE_GRID",action:e=>_.stackTileGrid(e.windowId),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"83c2d2d0-a53b-4521-82b5-4c2e61ed024b",...(0,U.Z)("Tile to Grid")},{name:"COMMAND_TAB_STACK_UNTILE",action:e=>_.stackUntile(e.windowId),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"a0294e45-6204-406e-b456-2664e4d23b24",...(0,U.Z)("Untile Tabs")},{name:"COMMAND_TAB_STACK_CREATE",action:e=>_.stackCreate(e.windowId),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"cdd99010-5477-4508-aa28-d671de35dcb2",...(0,U.Z)("Stack Tabs")},{name:"COMMAND_TAB_STACK_DISSOLVE",action:e=>_.stackDissolve(e.windowId),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"61ab7d82-7602-4f72-9f00-07a426ff47c1",...(0,U.Z)("Unstack Tabs")},{name:"COMMAND_TAB_STACK_REMOVE",action:e=>_.stackRemove(e.windowId),showInQC:!0,category:"CATEGORY_COMMAND_TAB_ACTION",isEnabled:ee.Z,guid:"56cf9bd1-63b1-4ebf-92b0-c909e5d479c6",...(0,U.Z)("Remove from Tab Stack")},{name:"COMMAND_TAB_STACK_CLOSE",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&f.Z.closeTabStack(t.id)},showInQC:!0,category:"CATEGORY_COMMAND_TAB_ACTION",isEnabled:e=>{const t=y.Z.getActivePage(e);return!!t&&y.Z.isGroup((0,Y.av)(t),e)},guid:"44fabfe1-fd65-4e7e-a540-5e4d6c742ab8",...(0,U.Z)("Close Tab Stack")},{name:"COMMAND_TAB_STACK_RELOAD",action:async e=>{const t=y.Z.getActivePage(e.windowId),n=t?(0,Y.av)(t):null,i=y.Z.getGroup(n,e.windowId);t&&i.size>1&&await Promise.all(i.map((async t=>{x.Z.reload(e.windowId,t.id,!1)})))},showInQC:!0,category:"CATEGORY_COMMAND_TAB_ACTION",isEnabled:e=>{const t=y.Z.getActivePage(e);return!!t&&y.Z.isGroup((0,Y.av)(t),e)},guid:"7eef8423-ea56-4df8-bad4-e3eccd57c8b6",...(0,U.Z)("Reload Tab Stack")},{name:"COMMAND_TOGGLE_MOUSE_GESTURES",action:()=>S.Z.toggle(q.kMouseGesturesEnabled,!0,!1),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"01f9d07d-5ec6-41a4-927c-129cef008d65",...(0,U.Z)("Toggle Mouse Gestures")},{name:"COMMAND_TOGGLE_IMAGES",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&f.Z.toggleImageLoading(t)},showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"6777b0a7-25d2-4e5e-a4e1-b5fcc0fcdef8",...(0,U.Z)("other","Load Images")},{name:"COMMAND_SET_LOAD_IMAGES_ALWAYS",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&f.Z.setImageLoading(t,"always")},behavior:"radio",showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"8d1f63a0-6e3c-42dd-a1b8-9a740f65bafe",...(0,U.Z)("other","Images On")},{name:"COMMAND_SET_LOAD_IMAGES_NEVER",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&f.Z.setImageLoading(t,"never")},behavior:"radio",showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"e346b0a7-74c6-4e69-952e-420d33e54a8e",...(0,U.Z)("other","Images Off")},{name:"COMMAND_SET_LOAD_IMAGES_CACHE",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&f.Z.setImageLoading(t,"cache")},behavior:"radio",showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"f016e79c-a799-465f-9d01-2869a751774c",...(0,U.Z)("other","Load Images From Cache")},{name:"COMMAND_SET_ANIMATIONS_LOOP",action:()=>F.Z.accessibilityFeatures.animationPolicy.set({value:"allowed"},(()=>{})),behavior:"radio",category:"CATEGORY_COMMAND_TAB_ACTION",isEnabled:ee.Z,showInQC:!0,guid:"080beb50-b815-4416-8a69-246907b2805a",...(0,U.Z)("other","Loop Animations")},{name:"COMMAND_SET_ANIMATIONS_NEVER",action:()=>F.Z.accessibilityFeatures.animationPolicy.set({value:"none"},(()=>{})),behavior:"radio",showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"1d4df136-9d8e-4541-b0b9-1a66a5b23444",...(0,U.Z)("other","No Animations")},{name:"COMMAND_SET_ANIMATIONS_ONCE",action:()=>F.Z.accessibilityFeatures.animationPolicy.set({value:"once"},(()=>{})),behavior:"radio",showInQC:!0,category:"CATEGORY_COMMAND_TAB_ACTION",isEnabled:ee.Z,guid:"8159b932-9a12-4cef-bf84-f046ab3a2030",...(0,U.Z)("other","Play Animations Once")},{name:"COMMAND_PAGE_TOGGLE_MUTE",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&f.Z.toggleMuting(e.windowId,H.aV.of(t))},showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"a6f425df-46e7-48f9-8be2-3b03329fa8d0",...(0,U.Z)("Mute / Unmute Tab")},{name:"COMMAND_PAGE_MUTE_OTHER",action:e=>f.Z.setMuting(e.windowId,"other","mute"),showInQC:!0,category:"CATEGORY_COMMAND_TAB_ACTION",isEnabled:ee.Z,guid:"4cb148ba-cb83-4e4a-be3e-43b60a3f3982",...(0,U.Z)("Mute Other Tabs")},{name:"COMMAND_PAGE_MUTE_ALL",action:e=>f.Z.setMuting(e.windowId,"all","mute"),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"431a57f8-a637-41e5-a4de-1b1c3be081db",...(0,U.Z)("Mute All Tabs")},{name:"COMMAND_PAGE_UNMUTE_OTHER",action:e=>f.Z.setMuting(e.windowId,"other","unmute"),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"4dc07cbf-4c8b-42ed-8117-c123834a76c5",...(0,U.Z)("Unmute Other Tabs")},{name:"COMMAND_PAGE_UNMUTE_ALL",action:e=>f.Z.setMuting(e.windowId,"all","unmute"),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"9badb24d-1a7b-46fd-8e95-d50f93812911",...(0,U.Z)("Unmute All Tabs")},{name:"COMMAND_CAPTURE_PAGE_TO_DISK",action:e=>l.Z.captureActivePage(e.windowId,"file"),isEnabled:ee.Z,showInQC:!0,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"2fe0abe5-421c-4d9d-83ef-16e9f9deb9bb",...(0,U.Z)("Capture Page to File")},{name:"COMMAND_CAPTURE_PAGE_TO_CLIPBOARD",action:e=>l.Z.captureActivePage(e.windowId,"clipboard"),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"2a8349df-be2b-44e8-8db9-4f349a470790",...(0,U.Z)("Capture Page to Clipboard")},{name:"COMMAND_TAB_TRANSLATE_PAGE",action:e=>{const t=y.Z.getActivePage(e.windowId);if(t&&p.Z.canTranslatePage(t.id))return P.Z.translatePage(t.id)},isEnabled:e=>{const t=y.Z.getActivePage(e);return!!t&&p.Z.canTranslatePage(t.id)},showInQC:!0,category:"CATEGORY_COMMAND_TAB_ACTION",guid:"8d7a4844-f2d5-4cfe-abcd-e2fd99005a41",...(0,U.Z)("tab","Translate Page")},{name:"COMMAND_IMPORT_DATA",action:e=>m.Z.showImportDataDialog(e.windowId),isEnabled:e=>!L.ZP.isGuestSession(e),showInQC:!0,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"6c851825-1e73-4ec5-ad5e-2ec9c826524c",...(0,U.Z)("command","Import from Applications or Files")},{name:"COMMAND_EXPORT_DATA",action:()=>F.Z.bookmarks.export(),isEnabled:e=>!L.ZP.isGuestSession(e),showInQC:!0,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"fba8ba2b-f317-463a-b685-6d3fb7040845",...(0,U.Z)("Export Bookmarks")},{name:"COMMAND_EXPORT_NOTES",action:()=>$(),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"fe0e224c-a903-4952-ae3d-d69d8777c24a",...(0,U.Z)("Export Notes")},{name:"COMMAND_IMPORT_NOTES",action:()=>j(),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"db20661f-37e9-4376-94c8-9aebc7a27628",...(0,U.Z)("Import Notes")},{name:"COMMAND_NEW_TAB_LINK",action:e=>{"string"==typeof e.param&&f.Z.openURL(e.windowId,e.param,{addOpenerTabId:!0})},inMenu:!1,isEnabled:ee.Z,showInQC:!1,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"62966533-b4f6-4f86-a02c-9753948c6277",...(0,U.Z)("Open Link in New Tab (Over a Link)")},{name:"COMMAND_NEW_BACKGROUND_TAB_LINK",action:e=>{"string"==typeof e.param&&f.Z.openURL(e.windowId,e.param,{inBackground:!0,addOpenerTabId:!0})},inMenu:!1,isEnabled:ee.Z,showInQC:!1,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"db3df40a-0d5f-4f87-a57a-cf9640e401c3",...(0,U.Z)("Open Link in Background Tab (Over a Link)")},{name:"COMMAND_READERVIEW_TOGGLE",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&I.Z.toggleReaderMode(t)},showInQC:!0,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",isEnabled:ee.Z,guid:"8dd47fc9-4c1f-4487-a475-f55bfa61aaf2",...(0,U.Z)("Toggle Reader View")},{name:"COMMAND_BOOKMARK_SELECTED_TABS",action:e=>c.Z.onCommand(e.windowId,"COMMAND_BOOKMARK_SELECTED_TABS"),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"12bef254-49e1-4205-b14e-acd4d3b4238b",...(0,U.Z)("Bookmark Selected Tabs")},{name:"COMMAND_SAVE_SESSION",action:e=>m.Z.showSaveSessionDialog(e.windowId,{mode:"all"}),isEnabled:e=>!L.ZP.isGuestSession(e),showInQC:!0,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"ec8eb1b8-53ef-48f8-bbdc-d0c44af2d5cd",...(0,U.Z)("command","Save All Tabs as Session")},{name:"COMMAND_SAVE_SELECTED_SESSION",action:e=>c.Z.onCommand(e.windowId,"COMMAND_SAVE_SELECTED_SESSION"),isEnabled:e=>!L.ZP.isGuestSession(e),showInQC:!0,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"0fe4c500-31cf-4d73-8dc1-281eb4259fe7",...(0,U.Z)("command","Save Selected Tabs as Session")},{name:"COMMAND_OPEN_SESSION",action:e=>m.Z.showOpenSessionDialog(e.windowId),isEnabled:e=>!L.ZP.isGuestSession(e),showInQC:!0,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"4a65bd2a-ec3c-42ca-ac7a-67040fe8cebc",...(0,U.Z)("Open Saved Session")},{name:"COMMAND_ADD_BOOKMARK",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&x.Z.doAction(e.windowId,t.id,"addBookmark")},isEnabled:e=>!L.ZP.isGuestSession(e),showInQC:!0,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"844219eb-ed35-4b17-a9f4-7789466c233c",...(0,U.Z)("Create Bookmark")},{name:"COMMAND_ADD_TO_READING_LIST",action:e=>k.Z.addSeveral(e.windowId,y.Z.getSelectedPages(e.windowId)),isEnabled:e=>!L.ZP.isGuestSession(e),showInQC:!0,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"a73687bc-ddc6-4011-9255-d2ff6a742279",...(0,U.Z)("Add Page to Reading List")},{name:"COMMAND_BLOCK_TRACKING",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&(0,z.Fe)(t.id,t.url,"tracking")},isEnabled:e=>!L.ZP.isGuestSession(e),showInQC:!0,category:"CATEGORY_COMMAND_APPLICATION",guid:"9afb77f2-d3d3-4596-8a04-58ab48a345fa",...(0,U.Z)("Block / Unblock Tracking")},{name:"COMMAND_BLOCK_TRACKING_AND_ADS",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&(0,z.Fe)(t.id,t.url,"ad_blocking")},isEnabled:e=>!L.ZP.isGuestSession(e),showInQC:!0,category:"CATEGORY_COMMAND_APPLICATION",guid:"da2af162-2140-4aae-8366-3add4793ac17",...(0,U.Z)("Block / Unblock Ads and Tracking")},{name:"COMMAND_FOCUS_ADDRESSFIELD",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&x.Z.doAction(e.windowId,t.id,"focusAddressField")},showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"96a396d8-d485-4f61-926b-bdab1eddaf94",...(0,U.Z)("Focus Address Field")},{name:"COMMAND_SHOW_DOWNLOADS_POPOUT",action:e=>c.Z.onCommand(e.windowId,"COMMAND_SHOW_DOWNLOADS_POPOUT"),showInQC:!0,category:"CATEGORY_COMMAND_APPLICATION",guid:"a1244975-7c9b-465d-90cf-da919d4598bf",isEnabled:e=>(0,Q.P)("DownloadButton",e),...(0,U.Z)("Open Downloads Popup")},{name:"COMMAND_PAGE_REFRESH",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&x.Z.reload(e.windowId,t.id,!1)},showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"bc31a027-870d-40ba-b3f1-20adcff8fff2",...(0,U.Z)("Reload Page")},{name:"COMMAND_PAGE_RELOAD_NOCACHE",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&x.Z.reload(e.windowId,t.id,!0)},showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"d92c060c-a9f7-490c-a4a0-8c5cccfa09dd",...(0,U.Z)("Force Page Reload")},{name:"COMMAND_PAGE_SCROLL_UP",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&x.Z.doAction(e.windowId,t.id,"pageScrollUp")},repeat:!0,showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"078f10b2-1901-4f9e-97b3-1018f7633099",...(0,U.Z)("Page Up")},{name:"COMMAND_PAGE_SCROLL_DOWN",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&x.Z.doAction(e.windowId,t.id,"pageScrollDown")},repeat:!0,showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"eae41430-4ed9-48e5-9e91-90aeefdb4b4e",...(0,U.Z)("Page Down")},{name:"COMMAND_PAGE_SCROLL_TOP",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&x.Z.doAction(e.windowId,t.id,"pageScrollTop")},showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"f74cd1f0-c90c-4a2e-8b7b-f06d88cad75a",...(0,U.Z)("Scroll Page to Top")},{name:"COMMAND_PAGE_SCROLL_BOTTOM",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&x.Z.doAction(e.windowId,t.id,"pageScrollBottom")},showInQC:!0,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",isEnabled:ee.Z,guid:"29bbb63b-b356-4dfe-aa45-9cf39d94d279",...(0,U.Z)("Scroll Page to Bottom")},{name:"COMMAND_FOCUS_WEBVIEW",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&x.Z.doAction(e.windowId,t.id,"focusWebView")},showInQC:!0,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",isEnabled:ee.Z,guid:"f71373d5-f966-4603-b7c5-a4a1722b3989",...(0,U.Z)("Focus Page")},{name:"COMMAND_PAGE_DISABLE_KEYBOARD_SHORTCUTS",action:()=>S.Z.toggle(q.kKeyboardShortcutsEnable,!0,!1),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"88d6a31d-9d50-4c8f-a9a2-207ac2b600c3",...(0,U.Z)("Disable Keyboard Shortcuts")},{name:"COMMAND_FOCUS_SEARCHFIELD",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&x.Z.doAction(e.windowId,t.id,"focusSearchField")},showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"eead069f-a0b5-4f2c-add7-051003353311",...(0,U.Z)("Focus Search Field")},{name:"COMMAND_FIND_IN_PAGE",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&x.Z.doAction(e.windowId,t.id,"findInPage")},showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"3686e24b-c64b-4402-9b79-d58dc92c29a8",...(0,U.Z)("Find in Page")},{name:"COMMAND_FIND_NEXT_IN_PAGE",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&x.Z.doAction(e.windowId,t.id,"findNextInPage")},repeat:!0,showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"055c6e9c-2b9c-4170-aeb0-43f3caf35c3e",...(0,U.Z)("Find Next in Page")},{name:"COMMAND_FIND_PREVIOUS_IN_PAGE",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&x.Z.doAction(e.windowId,t.id,"findPreviousInPage")},repeat:!0,showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"ef2ad516-3e00-4e9f-9dc3-b1bccd1cc317",...(0,U.Z)("Find Previous in Page")},{name:"COMMAND_PAGE_BACK",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&x.Z.back(e.windowId,t.id)},showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"f8f93b48-b1ed-43c3-bd65-e7240fd76d3f",...(0,U.Z)("History Back")},{name:"COMMAND_PAGE_FORWARD",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&x.Z.forward(e.windowId,t.id)},showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"b00e2d3c-a9ba-49b8-bce7-1faf1894a5f3",...(0,U.Z)("History Forward")},{name:"COMMAND_PAGE_REWIND",action:e=>h.Z.navigateRewind(e.windowId),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"67c60e96-fab2-433b-a012-107daa3856ef",...(0,U.Z)("History Rewind")},{name:"COMMAND_PAGE_FAST_FORWARD",action:e=>h.Z.navigateFastforward(e.windowId),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"964655e4-0274-4e26-82a7-b15161958009",...(0,U.Z)("Fast Forward")},{name:"COMMAND_GO_TO_PARENT_DIRECTORY",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&f.Z.gotoParentDirectory(e.windowId,t)},showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"c74300b6-635c-4471-b930-8707f29aa94c",...(0,U.Z)("Go to Parent Directory")},{name:"COMMAND_PRINT_PAGE",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&x.Z.doAction(e.windowId,t.id,"print")},showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"9fbbe402-d11b-479d-ab97-e7e6deb10d36",...(0,U.Z)("Print")},{name:"COMMAND_STOP_PAGE",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&x.Z.stop(e.windowId,t.id)},showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"77dfb30f-d825-4089-a042-c3f664c656b5",...(0,U.Z)("Stop Loading")},{name:"COMMAND_OPEN_PAGE",action:e=>{V.Z.utilities.openPage(e.windowId)},withNoWindow:!0,showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"e513ed70-7241-4722-83cb-4e8d10da8f02",...(0,U.Z)("a file","Open File")},{name:"COMMAND_SAVE_PAGE",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&(0,J.Jq)(e.windowId,t.id)},showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"a60f2f63-dd5a-46a6-b425-40e423e88fc0",...(0,U.Z)("Save Page As")},{name:"COMMAND_SEARCH_WITH_SELECTION",action:e=>A.Z.withPageSelection(e.windowId),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"1599c08b-51f2-413b-a572-dcacb43560b2",...(0,U.Z)("Search with Selection")},{name:"COMMAND_MAIN_ZOOM",action:e=>{"number"==typeof e.param&&R.Z.setPageZoomPercentage(e.windowId,e.param)},category:"CATEGORY_COMMAND_APPEARANCE",isEnabled:ee.Z,showInQC:!0,guid:"9a6682a0-9a28-4e44-b9f9-fc554f02c363",...(0,U.Z)("Page Zoom")},{name:"COMMAND_MAIN_ZOOM_IN",action:e=>R.Z.pageZoomIn(e.windowId),isEnabled:ee.Z,showInQC:!0,category:"CATEGORY_COMMAND_APPEARANCE",guid:"9f04836a-e0cb-4220-93dd-57d0a606ee11",...(0,U.Z)("Page Zoom In")},{name:"COMMAND_MAIN_ZOOM_OUT",action:e=>R.Z.pageZoomOut(e.windowId),isEnabled:ee.Z,showInQC:!0,category:"CATEGORY_COMMAND_APPEARANCE",guid:"f68b5e96-3c0c-49cb-a8f9-d23b43182bc0",...(0,U.Z)("Page Zoom Out")},{name:"COMMAND_MAIN_ZOOM_HALF",action:e=>R.Z.pageZoomHalf(e.windowId),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"d5959c06-f090-4f5e-8470-7871986393ab",...(0,U.Z)("Page Zoom Out Half")},{name:"COMMAND_MAIN_ZOOM_DOUBLE",action:e=>R.Z.pageZoomDouble(e.windowId),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"dd72265d-01e1-483e-a50f-5b018ca20151",...(0,U.Z)("Page Zoom In Double")},{name:"COMMAND_MAIN_ZOOM_RESET",action:e=>R.Z.pageZoomReset(e.windowId),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"483984bb-e647-4ed5-aae8-f82ef947b450",...(0,U.Z)("Page Zoom Reset")},{name:"COMMAND_MAIN_UI_ZOOM",action:e=>{"number"==typeof e.param&&R.Z.setUIZoomPercentage(e.param)},category:"CATEGORY_COMMAND_APPEARANCE",showInQC:!0,isEnabled:ee.Z,guid:"6884b1a9-0cfc-4456-8d1b-9cb73c99703f",...(0,U.Z)("UI Zoom")},{name:"COMMAND_MAIN_UI_ZOOM_IN",action:()=>R.Z.uiZoomIn(),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"b56f4b61-eff8-4d57-af15-a19fba06c587",...(0,U.Z)("UI Zoom In")},{name:"COMMAND_MAIN_UI_ZOOM_OUT",action:()=>R.Z.uiZoomOut(),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"d62013de-e829-4454-ab03-71a864341009",...(0,U.Z)("UI Zoom Out")},{name:"COMMAND_MAIN_UI_ZOOM_RESET",action:()=>R.Z.setUIZoomPercentage(100),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"a62aaffc-305b-4892-90c3-5839c0650260",...(0,U.Z)("UI Zoom Reset")},{name:"COMMAND_TAB_VIEW_PAGE_SOURCE",action:e=>{y.Z.getActivePage(e.windowId)?.isMailPage?c.Z.onCommand(e.windowId,"COMMAND_TAB_VIEW_PAGE_SOURCE"):_.viewPageSource(e.windowId)},showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"7c42ad51-fab5-46c5-acff-663947a13c96",...(0,U.Z)("View Page Source")},{name:"COMMAND_DEVELOPER_TOOLS",action:()=>V.Z.devtoolsPrivate.toggleDevtools("default"),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"cdc3b594-d57f-417d-89ee-69be8facd3aa",...(0,U.Z)("Developer Tools")},{name:"COMMAND_DEVTOOLS_INSPECTOR",action:()=>V.Z.devtoolsPrivate.toggleDevtools("inspect"),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"e6a1c7d5-21ad-4195-bc9e-95ebcb6ee2eb",...(0,U.Z)("Toggle Developer Tools")},{name:"COMMAND_DEVTOOLS_CONSOLE",action:()=>V.Z.devtoolsPrivate.toggleDevtools("console"),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"1e335c06-1036-4b76-be45-20fea16ab840",...(0,U.Z)("Developer Tools Console")},{name:"COMMAND_SHOW_HOMEPAGE",action:e=>f.Z.showHomepage(e.windowId,{inCurrent:!0}),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"51eac690-a178-4a3e-99dd-32c73f923559",...(0,U.Z)("title","Homepage")},{name:"COMMAND_TOGGLE_PANEL",action:e=>w.Z.togglePanel(e.windowId),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"5cbd037c-973a-4c3d-aa43-5454bc0ec0e4",...(0,U.Z)("command","Panel")},{name:"COMMAND_FOCUS_PANEL",action:e=>w.Z.setFocus(e.windowId),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"efaed294-3e8e-42fa-9a47-d121e6a11e5f",...(0,U.Z)("Focus Panel")},{name:"COMMAND_FOCUS_PANELBAR",action:e=>c.Z.onCommand(e.windowId,"COMMAND_FOCUS_PANELBAR"),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"454b1c03-0570-4977-99e8-337a1aafdb70",...(0,U.Z)("Focus Panel Controls")},{name:"COMMAND_FOCUS_MAINMENU",action:e=>c.Z.onCommand(e.windowId,"COMMAND_FOCUS_MAINMENU"),inMenu:!0,showInQC:!0,isEnabled:()=>!0,platforms:["linux","windows"],category:"CATEGORY_COMMAND_APPEARANCE",guid:"bb1fc5ee-68bd-4e4f-ae16-43269ada0f69",...(0,U.Z)("Focus Main Menu")},{name:"COMMAND_FOCUS_BOOKMARKBAR",action:e=>c.Z.onCommand(e.windowId,"COMMAND_FOCUS_BOOKMARKBAR"),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"d2c3cb39-c495-4aca-bac5-23f2db06ccca",...(0,U.Z)("Focus Bookmarks Bar")},{name:"COMMAND_FOCUS_TABBAR",action:e=>c.Z.onCommand(e.windowId,"COMMAND_FOCUS_TABBAR"),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"ab5fd96a-effc-448f-afdf-2bef8cba6527",...(0,U.Z)("Focus Tab Bar")},{name:"COMMAND_TOGGLE_FLOATING_PANEL",action:()=>w.Z.toggleFloating(),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPEARANCE",guid:"b70131d8-1022-411e-89aa-096a8528ab45",...(0,U.Z)("Toggle Floating Panel")},{name:"COMMAND_SHOW_NEXT_PANEL",action:e=>w.Z.showNextPanel(e.windowId,"next"),showInQC:!0,isEnabled:e=>{const t=b.ZP.getNextPanel(e,"next");return b.ZP.getPanelAvailable(t)},category:"CATEGORY_COMMAND_APPEARANCE",guid:"302fdcd3-d914-418f-895d-c4ede9b6c02e",...(0,U.Z)("Open Next Panel")},{name:"COMMAND_SHOW_PREVIOUS_PANEL",action:e=>w.Z.showNextPanel(e.windowId,"previous"),showInQC:!0,isEnabled:e=>{const t=b.ZP.getNextPanel(e,"previous");return b.ZP.getPanelAvailable(t)},category:"CATEGORY_COMMAND_APPEARANCE",guid:"4569302b-1f24-440c-965c-da7f9bfca097",...(0,U.Z)("Open Previous Panel")},{name:"COMMAND_TOGGLE_CURRENT_PANEL",action:e=>w.Z.toggleCurrentPanel(e.windowId),showInQC:!0,isEnabled:e=>{const t=b.ZP.getRegPanels(),n=b.ZP.getWebPanels(e),i=T.Z.get(q.kMailIsTurnedOff);return[...t,...n].some((e=>{const t="mail"===e.id||"calendar"===e.id||"feeds"===e.id||"contacts"===e.id;return(!i||!t)&&e.available}))},category:"CATEGORY_COMMAND_APPEARANCE",guid:"4128d533-256b-41f1-ba47-3c435ca3f2b4",...(0,U.Z)("Toggle Current Panel")},{name:"COMMAND_SHOW_BOOKMARK_PANEL",action:e=>w.Z.toggleContent(e.windowId,"bookmarks"),isEnabled:e=>b.ZP.isAvailable("bookmarks")&&!L.ZP.isGuestSession(e),showInQC:!0,category:"CATEGORY_COMMAND_APPEARANCE",guid:"48ee057a-93c3-4be5-903b-6d2e701ecb96",...(0,U.Z)("title","Bookmarks Panel")},{name:"COMMAND_SHOW_READING_LIST_PANEL",action:e=>w.Z.toggleContent(e.windowId,"readinglist"),showInQC:!0,isEnabled:()=>b.ZP.isAvailable("readinglist"),category:"CATEGORY_COMMAND_APPEARANCE",guid:"9e7b130e-f0af-40db-896d-1a29668bf694",...(0,U.Z)("title","Reading List Panel")},{name:"COMMAND_SHOW_DOWNLOADS_PANEL",action:e=>w.Z.toggleContent(e.windowId,"downloads"),showInQC:!0,isEnabled:()=>b.ZP.isAvailable("downloads"),category:"CATEGORY_COMMAND_APPEARANCE",guid:"4fcaed1c-c5db-42a8-b47d-7e6674ecd252",...(0,U.Z)("title","Downloads Panel")},{name:"COMMAND_SHOW_HISTORY_PANEL",action:e=>w.Z.toggleContent(e.windowId,"history"),isEnabled:e=>b.ZP.isAvailable("history")&&!L.ZP.isGuestSession(e),showInQC:!0,category:"CATEGORY_COMMAND_APPEARANCE",guid:"d26038ee-d140-42c5-98b0-27f14b9a8645",...(0,U.Z)("title","History Panel")},{name:"COMMAND_SHOW_NOTES_PANEL",action:e=>w.Z.toggleContent(e.windowId,"notes"),isEnabled:e=>b.ZP.isAvailable("notes")&&!L.ZP.isGuestSession(e),showInQC:!0,category:"CATEGORY_COMMAND_APPEARANCE",guid:"96dc03a2-7c99-49ff-9055-f03ac6eb90fe",...(0,U.Z)("title","Notes Panel")},{name:"COMMAND_SHOW_WINDOW_PANEL",action:e=>w.Z.toggleContent(e.windowId,"tabs"),showInQC:!0,isEnabled:()=>b.ZP.isAvailable("tabs"),category:"CATEGORY_COMMAND_APPEARANCE",guid:"7dc09b96-d5f1-4999-b2da-d8dd1f1e1651",...(0,U.Z)("title","Window Panel")},{name:"COMMAND_SHOW_TRANSLATE_PANEL",action:e=>w.Z.toggleContent(e.windowId,"translate"),showInQC:!0,isEnabled:()=>b.ZP.isAvailable("translate"),category:"CATEGORY_COMMAND_APPEARANCE",guid:"ccba139c-9b00-42aa-88cf-6a04a8a15fa5",...(0,U.Z)("title","Translate Panel")},{name:"COMMAND_SHOW_MAIL_PANEL",action:e=>w.Z.toggleContent(e.windowId,"mail"),showInQC:e=>L.ZP.isMail(e),isEnabled:e=>b.ZP.isAvailable("mail")&&L.ZP.isMail(e)&&!T.Z.get(q.kMailIsTurnedOff),category:"CATEGORY_COMMAND_APPEARANCE",guid:"66a51de3-2c98-468a-ac92-0728cd798ca5",...(0,U.Z)("title","Mail Panel")},{name:"COMMAND_SHOW_CALENDAR_PANEL",action:e=>w.Z.toggleContent(e.windowId,"calendar"),isEnabled:e=>b.ZP.isAvailable("calendar")&&!L.ZP.isGuestSession(e)&&!T.Z.get(q.kMailIsTurnedOff),showInQC:!0,category:"CATEGORY_COMMAND_APPEARANCE",guid:"a01cf36b-2f32-4919-924b-80e4e14a41b2",...(0,U.Z)("title","Calendar Panel")},{name:"COMMAND_SHOW_FEEDS_PANEL",action:e=>w.Z.toggleContent(e.windowId,"feeds"),showInQC:e=>L.ZP.isMail(e),isEnabled:e=>b.ZP.isAvailable("feeds")&&L.ZP.isMail(e)&&!T.Z.get(q.kMailIsTurnedOff),category:"CATEGORY_COMMAND_APPEARANCE",guid:"9e682c56-34e8-48b8-88d4-b1f716e0bc9c",...(0,U.Z)("title","Feeds Panel")},{name:"COMMAND_SHOW_CONTACTS_PANEL",action:e=>w.Z.toggleContent(e.windowId,"contacts"),showInQC:e=>L.ZP.isMail(e),isEnabled:e=>b.ZP.isAvailable("contacts")&&L.ZP.isMail(e)&&!T.Z.get(q.kMailIsTurnedOff),category:"CATEGORY_COMMAND_APPEARANCE",guid:"9492e500-30da-44fc-a28b-88c22a06c304",...(0,U.Z)("title","Contacts Panel")},{name:"COMMAND_SHOW_WEB_PANEL_1",action:e=>w.Z.toggleContent(e.windowId,"webpanel 1"),showInQC:!0,isEnabled:e=>b.ZP.isWebPanelEnabled(e,1),category:"CATEGORY_COMMAND_APPEARANCE",guid:"9a724d62-6b4f-4bec-affe-31a05966ccf9",...(0,U.Z)("Web Panel 1")},{name:"COMMAND_SHOW_WEB_PANEL_2",action:e=>w.Z.toggleContent(e.windowId,"webpanel 2"),showInQC:!0,isEnabled:e=>b.ZP.isWebPanelEnabled(e,2),category:"CATEGORY_COMMAND_APPEARANCE",guid:"a0ed3813-af8f-42af-8466-bbaf197bb5a6",...(0,U.Z)("Web Panel 2")},{name:"COMMAND_SHOW_WEB_PANEL_3",action:e=>w.Z.toggleContent(e.windowId,"webpanel 3"),showInQC:!0,isEnabled:e=>b.ZP.isWebPanelEnabled(e,3),category:"CATEGORY_COMMAND_APPEARANCE",guid:"a28d673c-5242-4330-aff1-b5df09dfad7c",...(0,U.Z)("Web Panel 3")},{name:"COMMAND_SHOW_WEB_PANEL_4",action:e=>w.Z.toggleContent(e.windowId,"webpanel 4"),showInQC:!0,isEnabled:e=>b.ZP.isWebPanelEnabled(e,4),category:"CATEGORY_COMMAND_APPEARANCE",guid:"a13f216c-d341-4057-a573-0b954dcde28f",...(0,U.Z)("Web Panel 4")},{name:"COMMAND_SHOW_WEB_PANEL_5",action:e=>w.Z.toggleContent(e.windowId,"webpanel 5"),showInQC:!0,isEnabled:e=>b.ZP.isWebPanelEnabled(e,5),category:"CATEGORY_COMMAND_APPEARANCE",guid:"e859c95a-52fc-4c30-87cc-768fd35cd5b9",...(0,U.Z)("Web Panel 5")},{name:"COMMAND_SHOW_WEB_PANEL_6",action:e=>w.Z.toggleContent(e.windowId,"webpanel 6"),showInQC:!0,isEnabled:e=>b.ZP.isWebPanelEnabled(e,6),category:"CATEGORY_COMMAND_APPEARANCE",guid:"61c088f8-a1b3-4a73-a359-08796372e33a",...(0,U.Z)("Web Panel 6")},{name:"COMMAND_SHOW_WEB_PANEL_7",action:e=>w.Z.toggleContent(e.windowId,"webpanel 7"),showInQC:!0,isEnabled:e=>b.ZP.isWebPanelEnabled(e,7),category:"CATEGORY_COMMAND_APPEARANCE",guid:"6fff7b4d-a154-4945-aacf-e57bc67afde8",...(0,U.Z)("Web Panel 7")},{name:"COMMAND_SHOW_WEB_PANEL_8",action:e=>w.Z.toggleContent(e.windowId,"webpanel 8"),showInQC:!0,isEnabled:e=>b.ZP.isWebPanelEnabled(e,8),category:"CATEGORY_COMMAND_APPEARANCE",guid:"26e5191f-7c81-4d3b-a499-e8945a9a6ec3",...(0,U.Z)("Web Panel 8")},{name:"COMMAND_SHOW_WEB_PANEL_9",action:e=>w.Z.toggleContent(e.windowId,"webpanel 9"),showInQC:!0,isEnabled:e=>b.ZP.isWebPanelEnabled(e,9),category:"CATEGORY_COMMAND_APPEARANCE",guid:"b0732781-fdf6-4ba8-8fcf-6d94f24edc37",...(0,U.Z)("Web Panel 9")},{name:"COMMAND_COPY_SELECTION_TO_NOTE",action:async e=>{const t=y.Z.getActivePage(e.windowId);if(t){const n=await V.Z.utilities.getSelectedText(t.id);await v.Z.createNote(e.windowId,{content:n,url:t.url})}},isEnabled:e=>!L.ZP.isGuestSession(e),showInQC:!0,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"fa2d0620-4233-4d59-ab5d-e868fb52ad03",...(0,U.Z)("Copy Selected Text to Note")},{name:"COMMAND_TRANSLATE_SELECTION",action:async e=>{const t=y.Z.getActivePage(e.windowId);if(t){const e=t.id,n=await V.Z.utilities.getSelectedText(e);n&&p.Z.canTranslateText(n,t.url,e)&&P.Z.translateSelection(e,n)}},isEnabled:ee.Z,showInQC:!0,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"25326646-7412-4be5-b478-6e74f1190a56",...(0,U.Z)("Translate Selected Text")},{name:"COMMAND_PAGE_QR_CODE",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&V.Z.utilities.createQRCode(t.id)},showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"fef3ca9a-341e-4814-9709-d9a070263882",...(0,U.Z)("Create QR Code for Active Page")},{name:"COMMAND_SPATNAV_LEFT",action:e=>Z.Z.left(e.windowId),repeat:!0,inMenu:!1,showInQC:!1,isEnabled:ee.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"466272ae-7b00-4113-bdb3-159ae29e848c",...(0,U.Z)("Spatial Navigation Left")},{name:"COMMAND_SPATNAV_UP",action:e=>Z.Z.up(e.windowId),repeat:!0,inMenu:!1,showInQC:!1,isEnabled:ee.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"527416b5-8d0f-4d05-b251-9a1c70cbbb11",...(0,U.Z)("Spatial Navigation Up")},{name:"COMMAND_SPATNAV_RIGHT",action:e=>Z.Z.right(e.windowId),repeat:!0,inMenu:!1,showInQC:!1,isEnabled:ee.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"0a095dee-caba-457d-b119-6a9cc12c9496",...(0,U.Z)("Spatial Navigation Right")},{name:"COMMAND_SPATNAV_DOWN",action:e=>Z.Z.down(e.windowId),repeat:!0,inMenu:!1,showInQC:!1,isEnabled:ee.Z,category:"CATEGORY_COMMAND_WEBPAGE_NAVIGATION",guid:"b554b968-c3b1-4522-a927-07d3d5bf74a3",...(0,U.Z)("Spatial Navigation Down")},{name:"COMMAND_CLIPBOARD_UNDO",action:e=>d.Z.undo(e.windowId),showInQC:!1,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"fb89c51c-3fe7-4bab-b9f6-27174e89b76d",...(0,U.Z)("win_linux","Undo")},{name:"COMMAND_CLIPBOARD_REDO",action:e=>d.Z.redo(e.windowId),showInQC:!1,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"cfd7113d-8501-4fee-b8e3-c776297620d5",...(0,U.Z)("win_linux","Redo")},{name:"COMMAND_CLIPBOARD_CUT",action:e=>d.Z.cut(e.windowId),showInQC:!1,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"ef5d4a31-9ca0-424e-a3af-ec9770084dca",...(0,U.Z)("win_linux","Cut")},{name:"COMMAND_CLIPBOARD_COPY",action:e=>d.Z.copy(e.windowId),showInQC:!1,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"6dae1e1a-695b-41c5-9ca9-deb1fabe9cc9",...(0,U.Z)("win_linux","Copy")},{name:"COMMAND_CLIPBOARD_PASTE",action:e=>d.Z.paste(e.windowId),showInQC:!1,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"aa12b05a-94cf-4660-8272-37da19294192",...(0,U.Z)("win_linux","Paste")},{name:"COMMAND_CLIPBOARD_SELECT_ALL",action:e=>d.Z.selectAll(e.windowId),showInQC:!1,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"ce41214f-6878-42ef-b120-3deb06cfcf2e",...(0,U.Z)("win_linux","Select All")},{name:"COMMAND_CLIPBOARD_PASTE_AS_PLAIN_TEXT",action:e=>{y.Z.getActivePage(e.windowId)&&d.Z.pasteAsPlainText(e.windowId)},showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"bac47f7e-084f-4255-b27e-24f767aa300b",...(0,U.Z)("Paste as Plain Text")},{name:"COMMAND_CLIPBOARD_PASTE_AS_PLAIN_TEXT_OR_PASTE_AND_GO",action:e=>{const t=y.Z.getActivePage(e.windowId);t&&d.Z.pasteAsPlainTextOrPasteAndGo(e.windowId,t.id)},category:"CATEGORY_COMMAND_APPLICATION",showInQC:!0,isEnabled:ee.Z,guid:"1ca0b67d-f911-4141-949b-09c728430f2f",...(0,U.Z)("Paste and Go")},{name:"COMMAND_CLIPBOARD_PASTE_AS_NOTE",action:e=>d.Z.createNoteFromSelection(e.windowId),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"eb19c8a1-019b-4eea-a159-4e7efaa7737a",...(0,U.Z)("Paste to New Note")},{name:"COMMAND_WINDOW_MINIMIZE",action:e=>O.Z.minimize(e.windowId),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"855ad23f-900b-42bf-af4d-4ce6b419ce09",...(0,U.Z)("Minimize")},{name:"COMMAND_WINDOW_MINIMIZE_ALL",action:()=>O.Z.minimizeAll(),showInQC:!0,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"9f6124ef-e8ed-4143-b9ca-5a4beb646e3d",...(0,U.Z)("Minimize All")},{name:"COMMAND_HIDE_OTHERS",action:()=>{},showInQC:!1,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"f1a77d87-7c3c-45be-9402-91d111381491",...(0,U.Z)("Hide Others")},{name:"COMMAND_HIDE_VIVALDI",action:()=>{},showInQC:!1,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"75e245b8-1cce-44e3-87f5-2cade5e26f6a",...(0,U.Z)("Hide $1",["Vivaldi"])},{name:"COMMAND_SHOW_ALL",action:()=>{},showInQC:!1,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"776628a4-a989-4373-922b-b16477bbb811",...(0,U.Z)("mac","Show All")},{name:"COMMAND_OPEN_LINK",action:()=>{},withNoWindow:!0,inMenu:!1,showInQC:!1,isEnabled:ee.Z,category:"CATEGORY_COMMAND_APPLICATION",guid:"e1ecbf58-47e1-4eb1-92f5-3ff610aadd53",...(0,U.Z)("Open Link")},{name:"COMMAND_SHOW_CALENDAR",action:e=>m.Z.showCalendar(e.windowId),withNoWindow:!0,isEnabled:e=>!L.ZP.isGuestSession(e)&&!T.Z.get(q.kMailIsTurnedOff),showInQC:!0,category:"CATEGORY_COMMAND_APPLICATION",guid:"67287254-750b-4dbd-b290-cdc1b4906c2c",...(0,U.Z)("Calendar")},{name:"COMMAND_ADD_CALENDAR_EVENT",action:e=>a.Z.showAddEvent(e.windowId,"",""),isEnabled:e=>!L.ZP.isGuestSession(e)&&!T.Z.get(q.kMailIsTurnedOff),showInQC:!0,category:"CATEGORY_COMMAND_APPLICATION",guid:"594afe15-9134-49e6-9aa8-1f50b0925ef8",...(0,U.Z)("Add Calendar Event (Dialog)")},{name:"COMMAND_ADD_NEW_CALENDAR_ACCOUNT",action:e=>m.Z.showCalendarAccountDialog(e.windowId),isEnabled:e=>!L.ZP.isGuestSession(e)&&!T.Z.get(q.kMailIsTurnedOff),showInQC:!0,category:"CATEGORY_COMMAND_APPLICATION",guid:"a379c8cf-024b-49b5-94ac-9a8ac279e048",...(0,U.Z)("Add New Calendar Account")},{name:"COMMAND_CALENDAR_VIEWMODE_DAY",action:e=>a.Z.setViewMode(e.windowId,"day"),isEnabled:e=>!L.ZP.isGuestSession(e)&&!T.Z.get(q.kMailIsTurnedOff),feature:"calendar",showInQC:!0,category:"CATEGORY_COMMAND_CALENDAR",guid:"34b14e6c-de7d-4b66-819f-7ab80b1bb255",...(0,U.Z)("Day View")},{name:"COMMAND_CALENDAR_VIEWMODE_WEEK",action:e=>a.Z.setViewMode(e.windowId,"week"),isEnabled:e=>!L.ZP.isGuestSession(e)&&!T.Z.get(q.kMailIsTurnedOff),feature:"calendar",showInQC:!0,category:"CATEGORY_COMMAND_CALENDAR",guid:"4c6371b0-0217-4c6d-b4f7-7a5f100375c3",...(0,U.Z)("Week View")},{name:"COMMAND_CALENDAR_VIEWMODE_MULTIWEEK",action:e=>a.Z.setViewMode(e.windowId,"multiweek"),isEnabled:e=>!L.ZP.isGuestSession(e)&&!T.Z.get(q.kMailIsTurnedOff),feature:"calendar",showInQC:!0,category:"CATEGORY_COMMAND_CALENDAR",guid:"0f2eaffe-fbad-452e-858e-1edcfd8a746e",...(0,U.Z)("Multi Week View")},{name:"COMMAND_CALENDAR_VIEWMODE_MONTH",action:e=>a.Z.setViewMode(e.windowId,"month"),isEnabled:e=>!L.ZP.isGuestSession(e)&&!T.Z.get(q.kMailIsTurnedOff),feature:"calendar",showInQC:!0,category:"CATEGORY_COMMAND_CALENDAR",guid:"2a5db361-313a-43b6-a0e9-f51d304aec7c",...(0,U.Z)("Month View")},{name:"COMMAND_CALENDAR_VIEWMODE_YEAR",action:e=>a.Z.setViewMode(e.windowId,"year"),isEnabled:e=>!L.ZP.isGuestSession(e)&&!T.Z.get(q.kMailIsTurnedOff),feature:"calendar",showInQC:!0,category:"CATEGORY_COMMAND_CALENDAR",guid:"1f261447-d1b1-473f-bb07-6139fd878ea2",...(0,U.Z)("Year View")},{name:"COMMAND_CALENDAR_VIEWMODE_AGENDA",action:e=>a.Z.setViewMode(e.windowId,"agenda"),isEnabled:e=>!L.ZP.isGuestSession(e)&&!T.Z.get(q.kMailIsTurnedOff),feature:"calendar",showInQC:!0,category:"CATEGORY_COMMAND_CALENDAR",guid:"925c843d-4813-4ea5-8837-211412707dbf",...(0,U.Z)("Agenda View")},{name:"COMMAND_CALENDAR_VIEW_NEXT_PERIOD",action:e=>{const t=r.Z.getPageId(e.windowId);"number"==typeof t&&a.Z.viewNextPeriod(t)},isEnabled:e=>!L.ZP.isGuestSession(e)&&!T.Z.get(q.kMailIsTurnedOff),feature:"calendar",showInQC:!0,category:"CATEGORY_COMMAND_CALENDAR",guid:"0f8df2a2-343b-43db-a16c-16418dc9f241",...(0,U.Z)("View Next Period")},{name:"COMMAND_CALENDAR_VIEW_PREVIOUS_PERIOD",action:e=>{const t=r.Z.getPageId(e.windowId);"number"==typeof t&&a.Z.viewPreviousPeriod(t)},isEnabled:e=>!L.ZP.isGuestSession(e)&&!T.Z.get(q.kMailIsTurnedOff),feature:"calendar",showInQC:!0,category:"CATEGORY_COMMAND_CALENDAR",guid:"4601bd8c-4229-442c-8dec-df8171c4da1d",...(0,U.Z)("View Previous Period")},{name:"COMMAND_CALENDAR_VIEW_TODAY",action:e=>{const t=r.Z.getPageId(e.windowId);"number"==typeof t&&a.Z.selectToday(e.windowId,t)},isEnabled:e=>!L.ZP.isGuestSession(e)&&!T.Z.get(q.kMailIsTurnedOff),feature:"calendar",showInQC:!0,category:"CATEGORY_COMMAND_CALENDAR",guid:"44e98ded-fa2d-4ee4-a7f6-e705ac809503",...(0,U.Z)("View Today")},{name:"COMMAND_CALENDAR_VIEW_ZOOM_IN",action:e=>a.Z.zoomViewMode(e.windowId,-1),isEnabled:e=>!L.ZP.isGuestSession(e)&&!T.Z.get(q.kMailIsTurnedOff),feature:"calendar",showInQC:!0,category:"CATEGORY_COMMAND_CALENDAR",guid:"940d0a90-6337-4d42-b317-13630fa38697",...(0,U.Z)("Zoom View In")},{name:"COMMAND_CALENDAR_VIEW_ZOOM_OUT",action:e=>a.Z.zoomViewMode(e.windowId,1),isEnabled:e=>!L.ZP.isGuestSession(e)&&!T.Z.get(q.kMailIsTurnedOff),feature:"calendar",showInQC:!0,category:"CATEGORY_COMMAND_CALENDAR",guid:"8c03403a-77fd-4920-aad9-c47ecee1a115",...(0,U.Z)("Zoom View Out")},{name:"COMMAND_CALENDAR_CREATE_EVENT",action:e=>a.Z.editEventCommand(e.windowId),isEnabled:e=>!L.ZP.isGuestSession(e)&&!T.Z.get(q.kMailIsTurnedOff),showInQC:!0,feature:"calendar",category:"CATEGORY_COMMAND_CALENDAR",guid:"1559362f-6274-4590-a260-a660b71dfcd5",...(0,U.Z)("Create Event")},{name:"COMMAND_CALENDAR_GOTO_DATE",action:e=>c.Z.onCommand(e.windowId,"COMMAND_CALENDAR_GOTO_DATE"),isEnabled:e=>!L.ZP.isGuestSession(e)&&!T.Z.get(q.kMailIsTurnedOff),showInQC:!0,feature:"calendar",category:"CATEGORY_COMMAND_CALENDAR",guid:"6c6537e4-75a3-43f0-93e1-9f3765d0c686",...(0,U.Z)("Go to Date")},{name:"COMMAND_CALENDAR_SEARCH",action:e=>c.Z.onCommand(e.windowId,"COMMAND_CALENDAR_SEARCH"),isEnabled:e=>!L.ZP.isGuestSession(e)&&!T.Z.get(q.kMailIsTurnedOff),showInQC:!0,feature:"calendar",category:"CATEGORY_COMMAND_CALENDAR",guid:"55a8cf5d-e711-4ce4-a02f-55cf31ffcda8",...(0,U.Z)("Search in Calendar")},{name:"COMMAND_CALENDAR_REFRESH",action:e=>a.Z.pollAllCalDAVAccountsWithStatus(e.windowId),isEnabled:e=>!L.ZP.isGuestSession(e)&&!T.Z.get(q.kMailIsTurnedOff),showInQC:!0,feature:"calendar",category:"CATEGORY_COMMAND_CALENDAR",guid:"1d59f64f-9e47-491c-93eb-fe66fc099279",...(0,U.Z)("Refresh Calendar")},{name:"COMMAND_MAIL_COMPOSE_NEW_MESSAGE",action:()=>g.Z.createDraft(),showInQC:!0,isEnabled:()=>!T.Z.get(q.kMailIsTurnedOff),feature:"mail",guid:"1c54b411-5b73-4eba-b5bf-6787d1f377fe",category:"CATEGORY_COMMAND_MAIL",...(0,U.Z)("command","Compose New Message")},{name:"COMMAND_SHOW_MAIL",action:e=>m.Z.showMail(e.windowId),withNoWindow:!0,showInQC:!0,isEnabled:()=>!T.Z.get(q.kMailIsTurnedOff),guid:"670dbed7-f692-4fa4-a926-fe46183b82bb",category:"CATEGORY_COMMAND_APPLICATION",...(0,U.Z)("Mail")},{name:"COMMAND_MAIL_REPLY",action:()=>i.Z.reply(),isEnabled:()=>!T.Z.get(q.kMailIsTurnedOff),feature:"mail",showInQC:!0,category:"CATEGORY_COMMAND_MAIL",guid:"fa9e273b-11fd-4be9-b77e-461a1e9fcc4e",...(0,U.Z)("Reply to Message")},{name:"COMMAND_MAIL_REPLY_ALL",action:()=>i.Z.replyAll(),showInQC:!0,isEnabled:()=>!T.Z.get(q.kMailIsTurnedOff),feature:"mail",category:"CATEGORY_COMMAND_MAIL",guid:"cc59e4b7-c907-48b7-9057-f4dc2ae9c552",...(0,U.Z)("Reply All")},{name:"COMMAND_MAIL_FORWARD",action:()=>i.Z.forward(),isEnabled:()=>!T.Z.get(q.kMailIsTurnedOff),feature:"mail",showInQC:!0,category:"CATEGORY_COMMAND_MAIL",guid:"f45c60df-9ca1-444e-8108-656b0a15c68e",...(0,U.Z)("mail","Forward Message")},{name:"COMMAND_MAIL_DELETE_PERMANENTLY",action:e=>i.Z.prepareDelete(e.windowId,!0),isEnabled:()=>!T.Z.get(q.kMailIsTurnedOff),feature:"mail",showInQC:!1,category:"CATEGORY_COMMAND_MAIL",guid:"7b0de3f1-2173-4bde-96bf-f9fa1063abe7",...(0,U.Z)("Delete Permanently")},{name:"COMMAND_MAIL_DELETE_ALL_PERMANENTLY",action:e=>u.Z.deleteEntriesFromFolderCmd(e.windowId),isEnabled:()=>!T.Z.get(q.kMailIsTurnedOff),feature:"mail",showInQC:!1,category:"CATEGORY_COMMAND_MAIL",guid:"f00fc3db-c1c9-460e-acad-16495b522b8e",...(0,U.Z)("Delete All Permanently")},{name:"COMMAND_MAIL_MARK_READ",action:e=>i.Z.markRead(e.windowId),isEnabled:()=>!T.Z.get(q.kMailIsTurnedOff),feature:"mail",showInQC:!0,category:"CATEGORY_COMMAND_MAIL",guid:"02a17cf8-4e45-4d32-b06c-38edf99544da",...(0,U.Z)("mail","Mark Message as Read")},{name:"COMMAND_MAIL_GOTO_NEXT_UNREAD",action:e=>i.Z.goToNextUnread(e.windowId),isEnabled:()=>!T.Z.get(q.kMailIsTurnedOff),feature:"mail",showInQC:!1,category:"CATEGORY_COMMAND_MAIL",guid:"75f673af-21e8-43f2-8aa8-b96b8dbd0245",...(0,U.Z)("mail","Next Unread")},{name:"COMMAND_MAIL_GOTO_PREVIOUS_UNREAD",action:e=>i.Z.goToPreviousUnread(e.windowId),isEnabled:()=>!T.Z.get(q.kMailIsTurnedOff),feature:"mail",showInQC:!1,category:"CATEGORY_COMMAND_MAIL",guid:"24aab8e7-7bd0-470d-88f8-5ecdb1f19224",...(0,U.Z)("mail","Previous Unread")},{name:"COMMAND_MAIL_MARK_ALL_READ",action:()=>u.Z.markAllReadCmd(),isEnabled:()=>!T.Z.get(q.kMailIsTurnedOff),feature:"mail",showInQC:!1,category:"CATEGORY_COMMAND_MAIL",guid:"c929109f-99fa-45a5-80ca-9a3fdd17bd63",...(0,U.Z)("mail","Mark All as Read")},{name:"COMMAND_MAIL_MARK_THREAD_READ",action:e=>i.Z.markThreadRead(e.windowId),isEnabled:()=>!T.Z.get(q.kMailIsTurnedOff),feature:"mail",showInQC:!0,category:"CATEGORY_COMMAND_MAIL",guid:"3110cb8a-11eb-4643-b834-f88ee1bf0155",...(0,U.Z)("mail","Mark Message Thread as Read")},{name:"COMMAND_MAIL_MARK_THREAD_UNREAD",action:e=>i.Z.markThreadUnread(e.windowId),isEnabled:()=>!T.Z.get(q.kMailIsTurnedOff),feature:"mail",showInQC:!0,category:"CATEGORY_COMMAND_MAIL",guid:"655c64c3-8e8f-44ff-a7bf-a05f2c9a6115",...(0,U.Z)("mail","Mark Message Thread as Unread")},{name:"COMMAND_MAIL_MARK_UNREAD",action:e=>i.Z.markUnread(e.windowId),isEnabled:()=>!T.Z.get(q.kMailIsTurnedOff),feature:"mail",showInQC:!0,category:"CATEGORY_COMMAND_MAIL",guid:"6b193cc2-62ca-41a8-9a17-d311541aef54",...(0,U.Z)("mail","Mark Message as Unread")},{name:"COMMAND_MAIL_ENABLE_SENDER_VIEW",action:e=>i.Z.enableCorrespondentView(e.windowId),isEnabled:()=>!T.Z.get(q.kMailIsTurnedOff),feature:"mail",showInQC:!0,category:"CATEGORY_COMMAND_MAIL",guid:"61ab202a-46ad-45ce-92b9-85c3295ef801",...(0,U.Z)("mail","Show Messages for Sender")},{name:"COMMAND_MAIL_ENABLE_THREADED_VIEW",action:e=>i.Z.enableThreadedView(e.windowId),isEnabled:()=>!T.Z.get(q.kMailIsTurnedOff),feature:"mail",showInQC:!0,category:"CATEGORY_COMMAND_MAIL",guid:"5c21bfa1-f0b2-4804-a395-71243d99dad8",...(0,U.Z)("mail","Show Message Thread")},{name:"COMMAND_MAIL_MARK_READ_AND_GOTO_NEXT_UNREAD",action:e=>i.Z.markAsReadAndGoToNextUnread(e.windowId),isEnabled:()=>!T.Z.get(q.kMailIsTurnedOff),feature:"mail",showInQC:!0,category:"CATEGORY_COMMAND_MAIL",guid:"92f285b0-90dc-4051-940e-eefee7b4692f",...(0,U.Z)("mail","Mark Message as Read and Go to Next Unread")},{name:"COMMAND_MAIL_ADD_NEW_MAIL_ACCOUNT",action:e=>m.Z.showMailAccountDialog(e.windowId),isEnabled:()=>!T.Z.get(q.kMailIsTurnedOff),showInQC:!0,category:"CATEGORY_COMMAND_MAIL",guid:"2b65911f-8bfc-4e9b-bf43-b78bfc7c4587",...(0,U.Z)("mail","Add New Mail Account")},{name:"COMMAND_MAIL_SHOW_PLAINTEXT",action:e=>c.Z.onCommand(e.windowId,"COMMAND_MAIL_SHOW_PLAINTEXT"),isEnabled:()=>!T.Z.get(q.kMailIsTurnedOff)&&"plaintext"!==s.Z.getRenderingMethod(),showInQC:!0,category:"CATEGORY_COMMAND_MAIL",guid:"ca91db92-59ae-40b6-9c69-10f7d4da2041",...(0,U.Z)("Show Message as Text")},{name:"COMMAND_MAIL_SHOW_HTML",action:e=>c.Z.onCommand(e.windowId,"COMMAND_MAIL_SHOW_HTML"),isEnabled:()=>!T.Z.get(q.kMailIsTurnedOff)&&"prefer_html"!==s.Z.getRenderingMethod(),showInQC:!0,category:"CATEGORY_COMMAND_MAIL",guid:"6c080636-1fd2-41d2-826a-9652ae4de5d8",...(0,U.Z)("Show Message as HTML")}]},9761:(e,t,n)=>{"use strict";n.d(t,{lE:()=>o,sK:()=>a,u4:()=>r,YI:()=>l});var i=n(70253),s=n(56371);const o=i.M.pb.map((([e,t,n])=>({key:e,value:(0,s.Z)(t),local:n}))),a=[{key:"am",value:(0,s.Z)("Amharic"),local:"amarəñña"},{key:"ar",value:(0,s.Z)("Arabic"),local:"اَلْعَرَبِيَّةُ"},{key:"bn",value:(0,s.Z)("Bengali"),local:"baɛṅlā"},{key:"bs",value:(0,s.Z)("Bosnian"),local:"bosanski"},{key:"ca",value:(0,s.Z)("Catalan"),local:"català"},{key:"ceb",value:(0,s.Z)("Cebuano"),local:"Sinugboanon"},{key:"co",value:(0,s.Z)("Corsican"),local:"corsu"},{key:"cy",value:(0,s.Z)("Welsh"),local:"Cymraeg"},{key:"eo",value:(0,s.Z)("Esperanto"),local:"Esperanto"},{key:"eu",value:(0,s.Z)("Basque"),local:"euskara"},{key:"ga",value:(0,s.Z)("Irish Gaelic"),local:"Gaeilge"},{key:"gl",value:(0,s.Z)("Galician"),local:"Galego"},{key:"gu",value:(0,s.Z)("Gujarati"),local:"gujarātī"},{key:"ha",value:(0,s.Z)("Hausa"),local:"ḥawsa"},{key:"haw",value:(0,s.Z)("Hawaiian"),local:"ʻōlelo Hawaiʻi"},{key:"he",value:(0,s.Z)("Hebrew"),local:"עברית / עִבְרִית"},{key:"hi",value:(0,s.Z)("Hindi"),local:"हिन्दी"},{key:"hmn",value:(0,s.Z)("Hmong, Mong"),local:"Hmong"},{key:"ht",value:(0,s.Z)("Haitian Creole"),local:"Kreyòl ayisyen"},{key:"ig",value:(0,s.Z)("Igbo"),local:"igbo"},{key:"jv",value:(0,s.Z)("Javanese"),local:"basa Jawa"},{key:"ka",value:(0,s.Z)("Georgian"),local:"ქართული"},{key:"kk",value:(0,s.Z)("Kazakh"),local:"Қазақ тілі"},{key:"km",value:(0,s.Z)("Khmer"),local:"ភាសាខ្មែរ"},{key:"kn",value:(0,s.Z)("Kannada"),local:"ಕನ್ನಡ (kannaḍa)"},{key:"ky",value:(0,s.Z)("Kyrgyz"),local:"قىرعىز تىلى"},{key:"la",value:(0,s.Z)("Latin"),local:"Lingua Latina"},{key:"lb",value:(0,s.Z)("Luxembourgish"),local:"Lëtzebuergesch"},{key:"lo",value:(0,s.Z)("Lao"),local:"ພາສາລາວ"},{key:"lv",value:(0,s.Z)("Latvian"),local:"latviešu valoda"},{key:"mg",value:(0,s.Z)("Malagasy"),local:"Fiteny Malagasy"},{key:"mi",value:(0,s.Z)("Maori"),local:"te Reo Māori"},{key:"mk",value:(0,s.Z)("Macedonian"),local:"македонски"},{key:"ml",value:(0,s.Z)("Malayalam"),local:"മലയാളം"},{key:"mn",value:(0,s.Z)("Mongolian"),local:"монгол"},{key:"mr",value:(0,s.Z)("Marathi"),local:"मराठी"},{key:"ms",value:(0,s.Z)("Malay"),local:"Bahasa melayu"},{key:"mt",value:(0,s.Z)("Maltese"),local:"Malti"},{key:"my",value:(0,s.Z)("Burmese"),local:"ဗမာစကား"},{key:"ne",value:(0,s.Z)("Nepali"),local:"नेपाली"},{key:"ny",value:(0,s.Z)("Chichewa"),local:"Chicheŵa"},{key:"or",value:(0,s.Z)("Oriya"),local:"ଓଡ଼ିଆ"},{key:"pa",value:(0,s.Z)("Punjabi"),local:"ਪੰਜਾਬੀ / ﺏﺎﺠﻨﭘ"},{key:"ps",value:(0,s.Z)("Pashto"),local:"پښتو"},{key:"rw",value:(0,s.Z)("Kinyarwanda"),local:"Ikinyarwanda"},{key:"sd",value:(0,s.Z)("Sindhi"),local:"سنڌي"},{key:"si",value:(0,s.Z)("Sinhala"),local:"සිංහල"},{key:"sm",value:(0,s.Z)("Samoan"),local:"Gagana Samoa"},{key:"sn",value:(0,s.Z)("Shona"),local:"chiShona"},{key:"so",value:(0,s.Z)("Somali"),local:"af Soomaali"},{key:"st",value:(0,s.Z)("Southern Sotho"),local:"seSotho"},{key:"su",value:(0,s.Z)("Sundanese"),local:"Basa Sunda"},{key:"sw",value:(0,s.Z)("Swahili"),local:"Kiswahili"},{key:"ta",value:(0,s.Z)("Tamil"),local:"தமிழ்"},{key:"te",value:(0,s.Z)("Telugu"),local:"తెలుగు"},{key:"tg",value:(0,s.Z)("Tajik"),local:"тоҷики / toçikī / تاجيكي"},{key:"th",value:(0,s.Z)("Thai"),local:"ภาษาไทย"},{key:"tk",value:(0,s.Z)("Turkmen"),local:"түркmенче"},{key:"tl",value:(0,s.Z)("Tagalog"),local:"Tagalog"},{key:"tt",value:(0,s.Z)("Tatar"),local:"татарча / tatar tele / تاتارچا"},{key:"ug",value:(0,s.Z)("Uyghur"),local:"Уйғур /ئۇيغۇر"},{key:"ur",value:(0,s.Z)("Urdu"),local:"اُردُو"},{key:"uz",value:(0,s.Z)("Uzbek"),local:"o’zbek tili ўзбек тили"},{key:"xh",value:(0,s.Z)("Xhosa"),local:"isiXhosa"},{key:"yi",value:(0,s.Z)("Yiddish"),local:"ײִדיש"},{key:"yo",value:(0,s.Z)("Yoruba"),local:"Yorùbá"},{key:"zu",value:(0,s.Z)("Zulu"),local:"isiZulu"}],r=["de-CH","en-GB","ja-KS","nn","pt-BR"],l={"en-US":"en",nb:"no","pt-PT":"pt",sr:"sr-Cyrl","zh-CN":"zh-Hans","zh-TW":"zh-Hant",iw:"he"}},84990:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=new(n(53546).Z)},53546:(e,t,n)=>{"use strict";let i;function s(e){i=e}n.d(t,{H:()=>s,Z:()=>o});const o=class{_stores=new Set;register(e){const t=this._stores.size;if(this._stores.add(e),t===this._stores.size)throw new Error(`register() in ${this.constructor.name} was called with store ${e.constructor?.name} that was already registered.`)}checkRegistered(e){if(!this._stores.has(e))throw new Error(`${e.constructor?.name} has not been registered`)}isDispatching(){return Boolean(this._dispatching)}dispatch(e){if(this._dispatching){let t=`VivaldiAppDispatcher.dispatch(...): Cannot dispatch action ${e.actionType} the middle of a ${this._dispatching.actionType} dispatch.`;throw new Error(t)}this._dispatching=e;try{for(const t of this._stores)t.dispatchAction(e)}finally{this._dispatching=void 0,i&&i(e)}}}},30628:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(48868),s=n(5863);const o=new class{m3GetAll(){return i.Z.transaction("rw",[i.Z.searchList,i.Z.filters],(()=>i.Z.filters.where("[accountId+path]").equals([s.of,s.J8]).first().then((e=>{if(!e)throw new Error("Outbox filter not found");return i.Z.searchList.where("sourceFilterIds").equals(e.id).toArray()}))))}}},28918:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(48868);const s=function(e){return i.Z.buffer.add(e)}},55030:e=>{e.exports={OptionalBlueprint:{getClasses:()=>"",getIconClass:()=>"",Icon:()=>null}}},44850:(e,t,n)=>{"use strict";n.d(t,{mh:()=>u,w$:()=>v,xy:()=>b,YC:()=>I,CS:()=>k,$0:()=>Z,Z7:()=>_,pM:()=>P,QB:()=>D,cw:()=>x,m7:()=>O,Gp:()=>R,Gr:()=>B,d6:()=>U,D1:()=>V,Rf:()=>W,jk:()=>H});var i=n(63353),s=n(29087),o=n(15489),a=n(56371),r=n(1407),l=n(36436),d=n(89175),c=n(86088);function h(e,t){let n=e;if(t.displayUrl){const i=(0,l.DP)(e);n=t.displayUrl+(t.copyParams&&i.path?"/"+i.path+"/":"/")}else n="";return n}function p(e,t){const n=(t.url||"").includes("?")?"&":"?",[i,s]=e.slice(t.displayUrl.length).split("?"),o=new URLSearchParams(s);i&&"/"!==i&&o.append("path",(0,l.Iw)(i));const a=t.copyParams&&e.length>t.displayUrl.length?o.toString():"";return(t.url||"")+(a?n+a:"")}const u={general:{title:(0,a.Z)("General"),icon:c.ZuY},appearance:{title:(0,a.Z)("Appearance"),icon:c.Eo7},themes:{title:(0,a.Z)("Themes"),icon:c.jL_},startpage:{title:(0,a.Z)("title","Start Page"),icon:c.VPD},tabs:{title:(0,a.Z)("Tabs"),icon:c.zoD.medium},panel:{title:(0,a.Z)("title","Panel"),icon:c.sxI.medium},addressbar:{title:(0,a.Z)("title","Address Bar"),icon:c.xMN},bookmarks:{title:(0,a.Z)("Bookmarks"),icon:c.CLf.medium},qc:{title:(0,a.Z)("Quick Commands"),icon:c.Znx.medium},keyboard:{title:(0,a.Z)("Keyboard"),icon:c.eIC},mouse:{title:(0,a.Z)("Mouse"),icon:c.uvK},search:{title:(0,a.Z)("noun","Search"),icon:c.YvR.medium},privacy:{title:(0,a.Z)("Privacy and Security"),icon:c.sgm.medium},downloads:{title:(0,a.Z)("Downloads"),icon:c.izi.medium},sync:{title:(0,a.Z)("Sync"),icon:c.ssx.medium},webpages:{title:(0,a.Z)("Webpages"),icon:c.c8X},network:{title:(0,a.Z)("Network"),icon:c.G0E},mail:{section:"mail",title:(0,a.Z)("Mail"),icon:c.lvj.medium},rss:{title:(0,a.Z)("Feeds"),icon:c.ZU_.medium},calendar:{title:(0,a.Z)("Calendar"),icon:c.bcq.medium},chat:{title:(0,a.Z)("Chat"),icon:c.yt5.medium},all:{title:(0,a.Z)("Display All"),icon:c.bqs.medium}};const g={"vivaldi://settings/":"settings","vivaldi://startpage/":"startpage","vivaldi://bookmarks/":"bookmarks","vivaldi://history/":"history","vivaldi://calendar/":"calendar","vivaldi://chat/":"chat","vivaldi://mailpage/":"mailpage","vivaldi://saga/":"saga","chrome://saga/":"saga","vivaldi://guest-intro/":"guest-intro","vivaldi://private-intro/":"private-intro","vivaldi://welcome/":"welcome","vivaldi://themecolors/":"themecolors","vivaldi://experiments/":"experiments","vivaldi://actionlog/":"actionlog","vivaldi://notes/":"notes"},m={"vivaldi://settings/":c.bqs.medium,"vivaldi:settings":c.bqs.medium,"vivaldi://startpage/":c.VPD,"vivaldi:startpage":c.VPD,"vivaldi://bookmarks/":c.CLf.medium,"vivaldi:bookmarks":c.CLf.medium,"vivaldi://history/":c.hcy.medium,"vivaldi:history":c.hcy.medium,"vivaldi://calendar/":c.bcq.medium,"vivaldi:calendar":c.bcq.medium,"vivaldi://chat/":c.yt5.medium,"vivaldi:chat":c.yt5.medium,"vivaldi://mailpage/":c.lvj.medium,"vivaldi:mailpage":c.lvj.medium,"vivaldi://themecolors/":c.jL_,"vivaldi:themecolors":c.jL_,"vivaldi://notes/":c.cyI.medium,"vivaldi:notes":c.cyI.medium,"vivaldi://game/":"chrome://game/","vivaldi:game":"chrome://game/","vivaldi://saga/":"chrome://saga/","vivaldi:saga":"chrome://saga/"};function v(e){return e.startsWith("vivaldi:")?m[e]||c.ZuY:e}const f=["settings","startpage","bookmarks","history","calendar","chat","notes","mailpage","private-intro","experiments","vivaldi://flags/","chrome://flags/"],y=["chrome://settings/","chrome://apps/"],w={settings:`${r.oP}/components/settings/settings.html`,startpage:`${r.u7}/startpage`,bookmarks:`${r.u7}/startpage?section=bookmarks`,history:`${r.u7}/startpage?section=history`,notes:`${r.u7}/startpage?section=notes`,calendar:`${r.u7}/startpage?section=calendar`,mailpage:`${r.oP}/components/mail/mail.html`,chat:`${r.oP}/components/mail/chat.html`,saga:`${r.oP}/saga/saga.html`,"guest-intro":`${r.oP}/components/guest-intro/guest-intro.html`,"private-intro":`${r.oP}/components/private-intro/private-intro.html`,welcome:`${r.oP}/components/welcome/welcome.html`,themecolors:`${r.oP}/components/themecolors/themecolors.html`,experiments:`${r.oP}/components/experiments/experiments.html`,actionlog:`${r.oP}/components/actionlog/actionlog.html`},b={...w,about:"chrome://version","vivaldi-urls":"chrome://chrome-urls",blankpage:"about:blank",extensions:"chrome://extensions",game:"chrome://game",saga:"chrome://saga"},C=[b.settings,b.bookmarks,b.history,b.notes,b.calendar,b.mailpage,b.chat,b.themecolors,b.experiments,b.actionlog,b.game],S=[{displayUrl:"vivaldi://history",url:b.history,copyParams:!0},{displayUrl:"vivaldi://calendar",url:b.calendar,copyParams:!0},{displayUrl:"vivaldi://notes",url:b.notes,copyParams:!0},{displayUrl:"vivaldi://bookmarks",url:b.bookmarks,copyParams:!0},{displayUrl:"vivaldi://settings",url:b.settings,copyParams:!0},{displayUrl:"",url:b.startpage,copyParams:!1},{displayUrl:"vivaldi://startpage",url:b.startpage,copyParams:!1,mapDisplayUrlToUrl:(e,t)=>i.Z.getStartpage(o.ZP.getId())},{displayUrl:"",url:"chrome://newtab",copyParams:!1},{displayUrl:"",url:b.blankpage,copyParams:!1},{displayUrl:"vivaldi://mail",url:b.mailpage,copyParams:!0},{displayUrl:"vivaldi://saga",url:b.saga,copyParams:!0},{displayUrl:"vivaldi://chat",url:b.chat,copyParams:!0},{displayUrl:"vivaldi://about",url:b.about,copyParams:!0},{displayUrl:"vivaldi://help",url:"https://vivaldi.com/help",copyParams:!0},{displayUrl:"vivaldi://vivaldi-urls",url:b["vivaldi-urls"],copyParams:!0},{displayUrl:"vivaldi://extensions",url:"chrome://extensions",copyParams:!0},{displayUrl:"vivaldi://guest-intro",url:b["guest-intro"],copyParams:!0},{displayUrl:"",url:b["private-intro"],copyParams:!0},{displayUrl:"vivaldi://welcome",url:b.welcome,copyParams:!0},{displayUrl:"vivaldi://themecolors",url:b.themecolors,copyParams:!0},{displayUrl:"vivaldi://experiments",url:b.experiments,copyParams:!0},{displayUrl:"vivaldi://actionlog",url:b.actionlog,copyParams:!0},{displayUrl:"vivaldi://game",url:b.game,copyParams:!1},{displayUrl:"about:blank",url:"about:blank",copyParams:!1,mapUrlToDisplayUrl:e=>e},{displayUrl:"about:about",url:b.about,copyParams:!1},{displayUrl:"chrome://history",url:b.history,copyParams:!0},{displayUrl:"chrome://bookmarks",url:b.bookmarks,copyParams:!0},{displayUrl:"chrome://newtab",mapDisplayUrlToUrl:e=>Z(e)?i.Z.getStartpage(o.ZP.getId()):e,copyParams:!1},{displayUrl:"vivaldi://",url:"chrome://",copyParams:!0,mapDisplayUrlToUrl:(e,t)=>"vivaldi://"===e?b.about:function(e,t){const n=t.copyParams&&e.length>t.displayUrl.length?(0,l.Iw)(e.slice(t.displayUrl.length)):"";return(t.url||"")+n}(e,t),mapUrlToDisplayUrl:(e,t)=>function(e,t){const n=t.copyParams&&e.length>(t.url||"").length?(0,l.Iw)(e.slice((t.url||"").length)):"";return t.displayUrl+n}(e,t)},{displayUrl:"vivaldi:",copyParams:!1,mapDisplayUrlToUrl:e=>{const t=e.indexOf("/"),n=-1===t?e.length:t,i=b[e.substring(8,n)];return i?p(e,{displayUrl:e.substring(0,n),url:i,copyParams:!0}):e}}];function T(e){let t=e;if(-1===t.indexOf("://")){const e=t.indexOf(":");e>-1&&(t=t.slice(0,e)+"://"+t.slice(e+1))}return"/"!==t[t.length-1]&&(t+="/"),t}function I(e){const t=T(e);if(!(t in g))return f.includes(t);const n=g[t];return f.includes(n)}function k(e){const t=T(e);for(let e=0;e<y.length;e++){const n=y[e];if((0,l.uu)(n,t)||t.startsWith(n))return!0}return!1}function A(e){return _(e)?c.bqs.medium:e===b.history?c.hcy.medium:e===b.bookmarks?c.CLf.medium:e===b.calendar?c.bcq.medium:e.startsWith(b.notes)?c.cyI.medium:Z(e)?c.VPD:L(e)?c.lvj.medium:function(e){return"string"==typeof e&&0===e.indexOf(b.chat)}(e)?"/resources/vivaldi_chat_default.png":e.startsWith(b.game)?"chrome://favicon/chrome://game/":e.startsWith(b.extensions)?"chrome://favicon/chrome://extensions/":e===b["private-intro"]?c.d7l:void 0}function Z(e){const t=s.Z.get(d.kExtensionURLOverrides)?.newtab?.find((e=>e.active)),n=s.Z.get(d.kTabsNewPageLink)===r.Fp.EXTENSION;return t&&n?e===t.entry:e.startsWith("chrome://newtab")||e.startsWith(b.startpage)||e.startsWith("vivaldi://startpage")}function E(e,t){return t.length>0&&0===t.indexOf(e)}function _(e){return E(b.settings,e)}const N=Object.keys(b).map((e=>b[e])),M=[...Object.keys(w).map((e=>w[e])),...Object.keys(g)];function P(e){return N.some((t=>e.startsWith(t)))}function D(e){return e.startsWith(b.game)||e.startsWith(b.extensions)}function x(e){return M.some((t=>e.startsWith(t)))}function O(e){return C.some((t=>e.url.startsWith(t)))}function L(e){return"string"==typeof e&&0===e.indexOf(b.mailpage)}function R(e){return 0===e.indexOf(b.notes)}function B(e){const t=e=e.trim();e=e?e.toLowerCase():e;const n=S.find((t=>t.displayUrl&&E(t.displayUrl,e)));if(!n)return t;return n.mapDisplayUrlToUrl?n.mapDisplayUrlToUrl(e,n):p(e,n)}function F(e){if((t=e).startsWith(r.P1)||t.startsWith(r.aI)||t.startsWith(r.Cd)||"about:blank"===t||s.Z.get(d.kExtensionURLOverrides)?.newtab?.some((e=>e.active&&e.entry===t)))return"";var t;for(let t=0;t<S.length;t++){const n=S[t];if(n.url&&E(n.url,e)){e=n.mapUrlToDisplayUrl?n.mapUrlToDisplayUrl(e,n):h(e,n);break}}return e}function U(e,t){if(e){if(e.startsWith(b.bookmarks))t=(0,a.Z)("Bookmarks");else if(e.startsWith(b.history))t=(0,a.Z)("History");else if(e.startsWith(b.calendar))t=(0,a.Z)("Calendar");else if(e.startsWith(b.chat)){const n=(0,l.DP)(e).path;t=n?(0,a.Z)(`Chat: ${n}`):(0,a.Z)("Chat")}else if(e.startsWith(b.notes))t.startsWith(b.notes)&&(t=(0,a.Z)("Notes"));else if(Z(e)||Z(t))t=(0,a.Z)("browser","Start Page");else if(e===b.experiments)t=(0,a.Z)("Experimental Features");else if(e===b.actionlog)t=(0,a.Z)("Action Log");else if(e===b["guest-intro"])t=(0,a.Z)("Guest Profile Introduction");else if(e===b["private-intro"])t=(0,a.Z)("Private Window Introduction");else if(e===b.welcome)t=(0,a.Z)("Welcome");else if(e===b.blankpage)t=(0,a.Z)("title","Blank Page");else if(e.startsWith(b.settings)){const n=(0,l.DP)(e).path,i=n?n.split("/")[0]:"general";t=(0,a.Z)("$1 Settings",u[i]?[u[i].title]:[i])}t===e&&(t=(0,l.Dy)(F(e)))}return t}function V(e){const{title:t="",url:n=""}=e;return U(n,t)}function W(e){return e.startsWith(r.P1)||e.startsWith(r.aI)||e.startsWith(r.Cd)||"about:blank"===e||function(e){return s.Z.get(d.kTabsNewPageLink)===r.Fp.CUSTOM&&s.Z.get(d.kTabsNewPageCustomUrl)===e}(e)||function(e){return s.Z.get(d.kTabsNewPageLink)===r.Fp.HOMEPAGE&&s.Z.get(d.kHomepageCache)===e}(e)||Boolean(s.Z.get(d.kExtensionURLOverrides)?.newtab?.some((t=>t.active&&t.entry===e)))}const H={internals:b,settingCategories:u,isNewTabPage:W,isBannedFromGuestMode:I,isBannedFromPrivateProfileWindows:k,getExtensionUrlFromInternalProtocolUrl:function(e){return e in g?w[g[e]]:e},getFavicon:function(e){if(x(e)||D(e)){const t=A(e);if(t)return t}},getFaviconWithFallback:function(e,t){if(x(e)||D(e)){const n=A(e);if(n)return n;if(""===t)return"/resources/favicon@2x.png"}else if(""===t)return"/resources/default_favicon_64.png";return t},getBookmarkFavicon:function(e,t){if(t)return{favIconUrl:t,favIconLoadType:"faviconFromCache"};const n=e?A(e):"";return e&&x(e)&&n?{favIconUrl:n,favIconLoadType:"faviconFromCache"}:{favIconUrl:e??"",favIconLoadType:"page"}},getDisplayUrl:F,getHoverUrl:function(e){let t=F(e);return""===t&&Z(e)&&(t="vivaldi://startpage/"),t},getDisplayTitleByUrl:U,getDisplayTitle:V,hasCustomFavicon:D,removeTrailingSlashWhenNoPath:l.Dy,getUrl:B,isMailPage:L,isNotesManager:R,isStartPage:Z,isInternalUrl:P,isVivaldiComponent:x,isExtensionProtocol:function(e){return e.startsWith(r.Fv)},isOurExtension:function(e){return e.substring(0,r.oP.length)===r.oP},isInternalPage:function(e){return P(e.url||"")},isSettingsUrl:_,matchInternal:function(e,t){return E(b[e],t)},matchUrl:E,equalUrl:function(e,t,n){return n?e&&t&&(0,l.OI)(e)===(0,l.OI)(t):e&&t&&(0,l.Iw)(e)===(0,l.Iw)(t)},internalUrl:function(e,t,n,i){const s=b[e],o=s.includes("?")?"&":"?";return s+o+"path="+encodeURIComponent((0,l.Iw)(t))+(n?"&title="+encodeURIComponent(n):"")+(i?"&query="+encodeURIComponent(i):"")}}},14507:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(67294),s=n(29087);const o=function(e){const[t,n]=i.useState((()=>s.Z.getList(e)));return i.useEffect((()=>{function t(e,t,i){n((e=>({...e,[i]:t})))}return s.Z.addListener(e,t),()=>{s.Z.removeListener(e,t)}}),[e]),t}},86088:(e,t,n)=>{"use strict";n.d(t,{IuZ:()=>s.a,lrx:()=>a.a,gep:()=>l.a,I_V:()=>c.a,Clf:()=>p.a,$O3:()=>g.a,oa7:()=>v.a,S1h:()=>y.a,onv:()=>b.a,wHY:()=>S.a,dHk:()=>I.a,owS:()=>A.a,DvK:()=>E.a,iD7:()=>N.a,W9U:()=>P.a,V_c:()=>x.a,boz:()=>L.a,Tu3:()=>B.a,oJy:()=>U.a,b0l:()=>W.a,u0H:()=>z.a,zwh:()=>$.a,IJb:()=>j.a,Fib:()=>X.a,Gpq:()=>q.a,uw2:()=>ee.a,AXs:()=>ne.a,vyJ:()=>se.a,ze0:()=>ae.a,Whf:()=>le.a,heI:()=>ce.a,nfH:()=>pe.a,KyY:()=>ge.a,sss:()=>ve.a,zDC:()=>ye.a,Qa2:()=>be.a,L$F:()=>Se.a,F_h:()=>Ie.a,SXC:()=>Ae.a,NwZ:()=>Ee.a,zKr:()=>Ne.a,VLT:()=>Pe.a,N_W:()=>xe.a,Syi:()=>Le.a,hXX:()=>Be.a,sWI:()=>Ue.a,weK:()=>We.a,lIQ:()=>ze.a,CKA:()=>$e.a,irc:()=>je.a,a8r:()=>Xe.a,uN0:()=>qe.a,feS:()=>et.a,eVT:()=>nt.a,GH$:()=>st.a,h6:()=>at.a,viW:()=>lt.a,JLz:()=>ct.a,Pje:()=>pt.a,MjM:()=>gt.a,kze:()=>vt.a,IeE:()=>yt.a,H0I:()=>bt.a,V34:()=>St.a,Fii:()=>It.a,ERJ:()=>At.a,Yaj:()=>Et.a,vh3:()=>Nt.a,mXV:()=>Pt.a,Kuf:()=>xt.a,Wt0:()=>Lt.a,tG3:()=>Bt.a,ooy:()=>Ut.a,ibx:()=>Wt.a,tD0:()=>zt.a,K30:()=>$t.a,sBl:()=>jt.a,Y41:()=>Xt.a,Hj9:()=>qt.a,hCY:()=>en.a,HHg:()=>nn.a,q7H:()=>on.a,v2I:()=>rn.a,b2r:()=>dn.a,kkq:()=>hn.a,o_D:()=>un.a,rr$:()=>mn.a,znb:()=>fn.a,vxN:()=>wn.a,FsT:()=>Cn.a,W_c:()=>Tn.a,JUc:()=>kn.a,XKb:()=>Zn.a,W9w:()=>_n.a,mHT:()=>Mn.a,_QD:()=>Dn.a,slH:()=>On.a,LwO:()=>Rn.a,d7l:()=>Fn.a,HXY:()=>Vn.a,Mqy:()=>Hn.a,rnU:()=>Gn.a,uWq:()=>Kn.a,WHX:()=>Yn.a,o7J:()=>Qn.a,c02:()=>Jn.a,xMN:()=>ti.a,Eo7:()=>ii.a,eIC:()=>oi.a,uvK:()=>ri.a,G0E:()=>di.a,VPD:()=>hi.a,jL_:()=>ui.a,ZuY:()=>mi.a,c8X:()=>fi.a,_ZF:()=>wi.a,SpM:()=>Ci.a,lku:()=>Ti.a,fbI:()=>ki.a,uUH:()=>Zi.a,OXd:()=>_i.a,Znx:()=>Ni,Si$:()=>Mi,MSA:()=>Pi,Vzw:()=>Di,K3w:()=>xi,mgF:()=>Oi,Zu:()=>Li,Wmx:()=>Ri,jtA:()=>Bi,PaK:()=>Fi,GO5:()=>Ui,YVA:()=>Vi,CLf:()=>Wi,hYC:()=>Hi,feZ:()=>zi,bcq:()=>Gi,Xgf:()=>$i,eTS:()=>Ki,wo7:()=>ji,sel:()=>Yi,ghF:()=>Xi,l0O:()=>Qi,kY4:()=>qi,NBh:()=>Ji,EEk:()=>es,Bd5:()=>ts,yt5:()=>ns,ySD:()=>is,U_X:()=>ss,hcy:()=>os,ZU6:()=>as,lvj:()=>rs,JJT:()=>ls,XTV:()=>ds,LaO:()=>cs,wp6:()=>hs,x6W:()=>ps,GAD:()=>us,EnF:()=>gs,zLp:()=>ms,QPh:()=>vs,Qwh:()=>fs,upG:()=>ys,hGk:()=>ws,Sap:()=>bs,GqE:()=>Cs,AE4:()=>Ss,eCP:()=>Ts,LDV:()=>Is,aAJ:()=>ks,dMx:()=>As,UEH:()=>Zs,Kt8:()=>Es,_w1:()=>_s,cyI:()=>Ns,P3X:()=>Ms,ZU_:()=>Ps,fkD:()=>Ds,ssx:()=>xs,UTS:()=>Os,bBo:()=>Ls,rvX:()=>Rs,v9y:()=>Bs,izi:()=>Fs,zAT:()=>Us,Ibx:()=>Vs,sxZ:()=>Ws,Q9E:()=>Hs,Wjz:()=>zs,rNG:()=>Gs,v5q:()=>$s,yhu:()=>Ks,d$r:()=>js,B$9:()=>Ys,sgm:()=>Xs,D7r:()=>Qs,md4:()=>qs,ebB:()=>Js,M2k:()=>eo,NNg:()=>to,DwE:()=>no,_TQ:()=>io,fph:()=>so,fHR:()=>oo,$II:()=>ao,g0V:()=>ro,zoD:()=>lo,YvR:()=>co,OCp:()=>ho,yaZ:()=>po,eFz:()=>uo,vvh:()=>go,ADs:()=>mo,BB1:()=>vo,lOb:()=>fo,dYD:()=>yo,s2Z:()=>wo,Q_G:()=>bo,hR9:()=>Co,GtN:()=>So,Gvk:()=>To,_qK:()=>Io,bqs:()=>ko,nyn:()=>Ao,rpm:()=>Zo,NxY:()=>Eo,cMC:()=>_o,myO:()=>No,z8c:()=>Mo,Dx_:()=>Po,sxI:()=>Do,jVs:()=>xo,XQw:()=>Oo,USP:()=>Lo,g4W:()=>Ro,nre:()=>Bo,zlZ:()=>Fo,KuK:()=>Uo,TVZ:()=>Vo,W4h:()=>Wo,awi:()=>Ho,nl:()=>zo,Nek:()=>Go,nlo:()=>$o,nY6:()=>Ko,Y_k:()=>jo,nuh:()=>Yo,R_e:()=>Xo,Wcb:()=>Qo});var i=n(72067),s=n.n(i),o=n(19458),a=n.n(o),r=n(72864),l=n.n(r),d=n(89237),c=n.n(d),h=n(36561),p=n.n(h),u=n(32721),g=n.n(u),m=n(379),v=n.n(m),f=n(24461),y=n.n(f),w=n(51843),b=n.n(w),C=n(55070),S=n.n(C),T=n(81766),I=n.n(T),k=n(99634),A=n.n(k),Z=n(95460),E=n.n(Z),_=n(72103),N=n.n(_),M=n(96569),P=n.n(M),D=n(79537),x=n.n(D),O=n(72796),L=n.n(O),R=n(19096),B=n.n(R),F=n(4044),U=n.n(F),V=(n(62525),n(69710)),W=n.n(V),H=n(4799),z=n.n(H),G=n(78297),$=n.n(G),K=n(6055),j=n.n(K),Y=n(12340),X=n.n(Y),Q=n(85749),q=n.n(Q),J=(n(31789),n(44231)),ee=n.n(J),te=n(93513),ne=n.n(te),ie=n(57396),se=n.n(ie),oe=n(86839),ae=n.n(oe),re=n(10307),le=n.n(re),de=n(61065),ce=n.n(de),he=n(4103),pe=n.n(he),ue=n(9428),ge=n.n(ue),me=n(36186),ve=n.n(me),fe=n(79026),ye=n.n(fe),we=n(3783),be=n.n(we),Ce=n(41868),Se=n.n(Ce),Te=n(42450),Ie=n.n(Te),ke=n(23914),Ae=n.n(ke),Ze=n(90014),Ee=n.n(Ze),_e=n(53001),Ne=n.n(_e),Me=n(49336),Pe=n.n(Me),De=n(1652),xe=n.n(De),Oe=n(33851),Le=n.n(Oe),Re=n(54558),Be=n.n(Re),Fe=n(50983),Ue=n.n(Fe),Ve=n(44425),We=n.n(Ve),He=n(38037),ze=n.n(He),Ge=n(94220),$e=n.n(Ge),Ke=n(35732),je=n.n(Ke),Ye=n(63267),Xe=n.n(Ye),Qe=n(42822),qe=n.n(Qe),Je=n(23641),et=n.n(Je),tt=(n(92800),n(23942)),nt=n.n(tt),it=n(28676),st=n.n(it),ot=n(76667),at=n.n(ot),rt=n(25531),lt=n.n(rt),dt=n(75124),ct=n.n(dt),ht=n(32783),pt=n.n(ht),ut=(n(39135),n(89016)),gt=n.n(ut),mt=n(43380),vt=n.n(mt),ft=n(29295),yt=n.n(ft),wt=(n(83159),n(82474)),bt=n.n(wt),Ct=n(67905),St=n.n(Ct),Tt=n(24073),It=n.n(Tt),kt=n(34166),At=n.n(kt),Zt=n(83035),Et=n.n(Zt),_t=n(27063),Nt=n.n(_t),Mt=n(68914),Pt=n.n(Mt),Dt=n(83),xt=n.n(Dt),Ot=n(95174),Lt=n.n(Ot),Rt=n(52725),Bt=n.n(Rt),Ft=n(24885),Ut=n.n(Ft),Vt=n(71387),Wt=n.n(Vt),Ht=n(24566),zt=n.n(Ht),Gt=n(4856),$t=n.n(Gt),Kt=n(49244),jt=n.n(Kt),Yt=n(17737),Xt=n.n(Yt),Qt=n(29622),qt=n.n(Qt),Jt=n(90205),en=n.n(Jt),tn=n(6836),nn=n.n(tn),sn=n(25650),on=n.n(sn),an=n(41028),rn=n.n(an),ln=n(22713),dn=n.n(ln),cn=n(57842),hn=n.n(cn),pn=n(71360),un=n.n(pn),gn=n(92636),mn=n.n(gn),vn=n(70773),fn=n.n(vn),yn=n(37362),wn=n.n(yn),bn=n(76992),Cn=n.n(bn),Sn=n(41885),Tn=n.n(Sn),In=n(7246),kn=n.n(In),An=n(10681),Zn=n.n(An),En=n(54472),_n=n.n(En),Nn=n(269),Mn=n.n(Nn),Pn=n(86721),Dn=n.n(Pn),xn=n(65438),On=n.n(xn),Ln=n(94537),Rn=n.n(Ln),Bn=n(2018),Fn=n.n(Bn),Un=n(19194),Vn=n.n(Un),Wn=n(19914),Hn=n.n(Wn),zn=n(74836),Gn=n.n(zn),$n=n(61373),Kn=n.n($n),jn=n(1149),Yn=n.n(jn),Xn=n(19016),Qn=n.n(Xn),qn=n(26055),Jn=n.n(qn),ei=n(98913),ti=n.n(ei),ni=n(2291),ii=n.n(ni),si=n(37032),oi=n.n(si),ai=n(2473),ri=n.n(ai),li=n(63818),di=n.n(li),ci=n(95331),hi=n.n(ci),pi=n(35024),ui=n.n(pi),gi=n(43893),mi=n.n(gi),vi=n(20277),fi=n.n(vi),yi=n(87710),wi=n.n(yi),bi=n(67651),Ci=n.n(bi),Si=n(16761),Ti=n.n(Si),Ii=n(21922),ki=n.n(Ii),Ai=n(76611),Zi=n.n(Ai),Ei=n(81606),_i=n.n(Ei);const Ni={small:n(24319),medium:n(24319),large:n(19222)},Mi={small:n(70913),medium:n(20643),large:n(32727)},Pi={small:n(39567),medium:n(28676),large:n(39293)},Di={small:n(36027),medium:n(36027),large:n(72753)},xi={small:n(9784),medium:n(9784),large:n(35735)},Oi={small:n(46685),medium:n(29629),large:n(52145)},Li={small:n(6198),medium:n(89654),large:n(15709)},Ri={small:n(27308),medium:n(4819),large:n(88952)},Bi={small:n(23588),medium:n(79257),large:n(2753)},Fi={small:n(79639),medium:n(10737),large:n(980)},Ui={small:n(81315),medium:n(95574),large:n(15159)},Vi={small:n(52893),medium:n(52893),large:n(67066)},Wi={small:n(31734),medium:n(48446),large:n(62786)},Hi={small:n(16508),medium:n(16508),large:n(16508)},zi={small:n(20477),medium:n(20477),large:n(97624)},Gi={small:n(92529),medium:n(33395),large:n(40191)},$i={small:n(2365),medium:n(2365),large:n(2365)},Ki={small:n(28586),medium:n(28586),large:n(28586)},ji={small:n(52504),medium:n(52504),large:n(52504)},Yi={small:n(34167),medium:n(34167),large:n(34167)},Xi={small:n(46708),medium:n(46708),large:n(46708)},Qi={small:n(34923),medium:n(34923),large:n(34923)},qi={small:n(68777),medium:n(14021),large:n(79448)},Ji={small:n(38368),medium:n(38368),large:n(38368)},es={small:n(82152),medium:n(82152),large:n(82152)},ts={small:n(82453),medium:n(82453),large:n(82453)},ns={small:n(51555),medium:n(5096),large:n(70807)},is={small:n(30135),medium:n(30135),large:n(30135)},ss={small:n(29295),medium:n(29295),large:n(29295)},os={small:n(3335),medium:n(66089),large:n(5231)},as={small:n(91273),medium:n(91273),large:n(91273)},rs={small:n(90658),medium:n(54255),large:n(83318)},ls={small:n(52462),medium:n(52462),large:n(52462)},ds={small:n(67955),medium:n(31408),large:n(47043)},cs={small:n(83075),medium:n(54098),large:n(54098)},hs={small:n(38546),medium:n(38546),large:n(38546)},ps={small:n(30808),medium:n(96387),large:n(27818)},us={small:n(71311),medium:n(25259),large:n(25259)},gs={small:n(89316),medium:n(94543),large:n(76047)},ms={small:n(39139),medium:n(64827),large:n(21881)},vs={small:n(64207),medium:n(11331),large:n(17109)},fs={small:n(15901),medium:n(66706),large:n(92513)},ys={small:n(56475),medium:n(59168),large:n(80217)},ws={small:n(10945),medium:n(51299),large:n(28360)},bs={small:n(70531),medium:n(67461),large:n(43652)},Cs={small:n(39530),medium:n(82032),large:n(31391)},Ss={small:n(31560),medium:n(98626),large:n(28491)},Ts={small:n(97888),medium:n(49602),large:n(59046)},Is={small:n(15331),medium:n(73391),large:n(75971)},ks={small:n(44895),medium:n(58480),large:n(35719)},As=(n(8431),n(8431),n(8431),n(52529),n(52529),n(52529),{small:n(53165),medium:n(53165),large:n(53165)}),Zs={small:n(27476),medium:n(34830),large:n(17802)},Es={small:n(14737),medium:n(71318),large:n(38306)},_s={small:n(7773),medium:n(5211),large:n(21838)},Ns={small:n(60381),medium:n(41380),large:n(41380)},Ms={small:n(91329),medium:n(91329),large:n(91329)},Ps={small:n(28481),medium:n(81346),large:n(81346)},Ds={small:n(21287),medium:n(21287),large:n(21287)},xs={small:n(45016),medium:n(45016),large:n(38668)},Os={small:n(29832),medium:n(29832),large:n(3117)},Ls={small:n(71775),medium:n(71775),large:n(21776)},Rs={small:n(30249),medium:n(30249),large:n(12371)},Bs={small:n(17792),medium:n(34861),large:n(99978)},Fs={small:n(55430),medium:n(61063),large:n(87046)},Us={small:n(15902),medium:n(15902),large:n(15902)},Vs={small:n(44474),medium:n(52381),large:n(47062)},Ws={small:n(59098),medium:n(19423),large:n(71303)},Hs={small:n(70636),medium:n(70636),large:n(28786)},zs={small:n(89702),medium:n(89702),large:n(47746)},Gs={small:n(82418),medium:n(48082),large:n(47802)},$s={small:n(94411),medium:n(94411),large:n(94411)},Ks={small:n(95846),medium:n(95846),large:n(95846)},js={small:n(71475),medium:n(71475),large:n(71475)},Ys={small:n(95369),medium:n(95369),large:n(95369)},Xs={small:n(96970),medium:n(37028),large:n(37028)},Qs={small:n(17183),medium:n(96676),large:n(96676)},qs=(n(78754),n(78754),n(78754),{small:n(28796),medium:n(43099),large:n(3009)}),Js={small:n(42041),medium:n(42041),large:n(42041)},eo={small:n(78670),medium:n(58579),large:n(91086)},to={small:n(83947),medium:n(84435),large:n(29504)},no={small:n(59607),medium:n(78553),large:n(78553)},io={small:n(64750),medium:n(94012),large:n(94012)},so={small:n(4103),medium:n(4103),large:n(4103)},oo={small:n(27139),medium:n(27139),large:n(27139)},ao={small:n(31102),medium:n(31102),large:n(31102)},ro={small:n(16441),medium:n(16441),large:n(16441)},lo={small:n(67567),medium:n(67567),large:n(67567)},co=(n(43085),n(43085),n(43085),{small:n(5983),medium:n(4868),large:n(10375)}),ho={small:n(89170),medium:n(89170),large:n(89170)},po={small:n(60018),medium:n(60018),large:n(77737)},uo={small:n(10307),medium:n(10307),large:n(99785)},go=(n(86839),n(86839),n(91004),{small:n(80162),medium:n(80162),large:n(80162)}),mo={small:n(23634),medium:n(23634),large:n(23634)},vo={small:n(88111),medium:n(88111),large:n(88111)},fo={small:n(4266),medium:n(4266),large:n(68401)},yo={small:n(68189),medium:n(68189),large:n(33329)},wo={small:n(44278),medium:n(44278),large:n(9390)},bo={small:n(98434),medium:n(98434),large:n(22493)},Co={small:n(16619),medium:n(16619),large:n(16619)},So={small:n(29047),medium:n(50227),large:n(42225)},To=(n(59260),n(32132),n(24344),{small:n(58615),medium:n(97093),large:n(42855)}),Io={small:n(57358),medium:n(82214),large:n(5869)},ko={small:n(89052),medium:n(62675),large:n(3699)},Ao={small:n(27436),medium:n(30651),large:n(36218)},Zo={small:n(46038),medium:n(51008),large:n(43448)},Eo={small:n(32545),medium:n(2144),large:n(13929)},_o={small:n(31866),medium:n(31866),large:n(31866)},No={small:n(78823),medium:n(78823),large:n(30689)},Mo={small:n(56035),medium:n(56035),large:n(12853)},Po={small:n(1313),medium:n(1313),large:n(11826)},Do={small:n(64916),medium:n(64916),large:n(75987)},xo={small:n(53514),medium:n(53514),large:n(90905)},Oo={small:n(78990),medium:n(87268),large:n(87268)},Lo={small:n(45243),medium:n(45243),large:n(45243)},Ro={small:n(61453),medium:n(61453),large:n(61453)},Bo={small:n(3895),medium:n(14302),large:n(67757)},Fo={small:n(24638),medium:n(24638),large:n(24638)},Uo={small:n(3638),medium:n(3638),large:n(3638)},Vo={small:n(49823),medium:n(43927),large:n(43927)},Wo={small:n(4072),medium:n(9326),large:n(9326)},Ho={small:n(36055),medium:n(9027),large:n(9027)},zo={small:n(35237),medium:n(72272),large:n(72272)},Go={small:n(59301),medium:n(90077),large:n(90077)},$o={small:n(62067),medium:n(22485),large:n(22485)},Ko={small:n(23217),medium:n(49989),large:n(49989)},jo={small:n(80490),medium:n(33520),large:n(33520)},Yo={small:n(1293),medium:n(27470),large:n(48013)},Xo={small:n(81789),medium:n(66510),large:n(106)},Qo={small:n(8797),medium:n(92484),large:n(70204)}},39005:(e,t,n)=>{"use strict";n.d(t,{Z:()=>m});var i=n(65398),s=n(98611),o=n(29087),a=n(84990),r=n(75401),l=n(84283),d=n(89165),c=n(89175),h=n(22288),p=n(76257);let u;class g extends i.Z{constructor(e){e.checkRegistered(s.C),super(e)}getActiveMessage(){return u&&u.state.message}getActiveListEntry(){return u&&u.props.listEntry}getAttachments(){return u&&u.state.message?u.state.message.bodyParts?(0,h.yN)(u.state.message.bodyParts).filter((e=>!e.inUse)):u.state.raw?(0,p.Dc)(u.state.raw.mimeTree):[]:[]}getRaw(){return u&&u.state.raw}getRenderingMethod(){return u?.state.renderingMethod??o.Z.get(c.kMailPreferredRendering)}getIsRawMode(){return Boolean("raw"===u?.state.renderingMethod)}isTrash(){return!(!u||!u.props.listEntry)&&l.Z.isMessageDeleted(u.props.listEntry.sources)}isJunk(){return!(!u||!u.props.listEntry)&&(0,d.Z)(u.props.listEntry.sources)}isArchived(){return!(!u||!u.props.listEntry)&&(0,r.Z)(u.props.listEntry.sources)}toggleRenderingMethod(e){u&&u.toggleRenderingMethod(e)}dispatchAction(e){switch(e.actionType){case"MAIL_SET_ACTIVE_COMPONENT":u!==e.mailDetail&&(u=e.mailDetail,this.emitChange());break;case"MAIL_SET_ACTIVE_MESSAGE":u&&(u.setState({message:e.message}),this.emitChange());break;case"MAIL_CLEAR_IF_ACTIVE":u===e.mailDetail&&(u=void 0,this.emitChange());break;case"MAIL_INDEX_UPDATE":{const{updates:t}=e;if(!u||!u.props.listEntry||!t.sleUpdates)return;const{id:n}=u.props.listEntry;t.sleUpdates.some((e=>e.id===n))&&this.emitChange();break}case"MAIL_REFRESH_ACTIVE_MESSAGE":this.emitChange()}}}const m=new g(a.Z)},30626:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(65398),s=n(84990);const o=new Map;class a extends i.Z{getActiveWebView(e){return o.get(e)}dispatchAction(e){switch(e.actionType){case"WEBVIEW_CLEAR_IF_ACTIVE":this.getActiveWebView(e.windowId)===e.component&&(o.delete(e.windowId),this.emitChange());break;case"WEBVIEW_SET_ACTIVE":o.set(e.windowId,e.component),this.emitChange()}}}const r=new a(s.Z)},59486:(e,t,n)=>{"use strict";n.d(t,{q3:()=>c,Ei:()=>p,SZ:()=>u,ZP:()=>L});var i=n(65398),s=n(93974),o=n(84990),a=n(56371),r=n(30460),l=n(44850);const d="0",c="1",h="2",p=(0,a.Z)("Bookmarks"),u=c;let g={id:c,url:"",title:"",nickname:"",description:"",thumbnail:"",partner:"",speeddial:!1,bookmarkbar:!1,trash:!1,children:[]};const m=(new Map).set(g.id,g),v=new Map;let f=!1,y=g,w=[],b={},C=[],S=[],T=!1,I=!1,k=!1;function A(e,t){const{url:n,title:i,description:s,nickname:o}=e;return t.toLowerCase().split(" ").every((e=>n!==r.p&&n?.toLowerCase().includes(e)||i.toLowerCase().includes(e)||s.toLowerCase().includes(e)||o.toLowerCase().includes(e)))}class Z extends i.Z{hasBeenInitialized(){return f}getRootNode(){return g}getRootId(){return g.id}getTopNodes(){return g.children||[]}getLastTopNode(){const e=E.getTopNodes();if(e.length>1)return e[e.length-2]}getBookmarkBarFolderId(){return y.id}getBookmarksBarNodes(){return w}getSpeeddialFolders(){return C}isFailedUpgrade(){return k}getItemById(e){return m.get(e)}getUrlByNode(e){return e.url&&E.filterUrl(e.url)||""}filterUrl(e){return e===r.p?"":e}getDragData(e,t){const n=t.map((e=>E.getItemById(e))).filter(Boolean);if("text/plain"===e){const e=[];return n.forEach((t=>{const n=E.isFolder(t)?t.title:l.jk.getHoverUrl(E.getUrlByNode(t));e.push(n)})),e.join("\r\n")}if("text/html"===e){const e=n&&1===n.length?n[0]:void 0;if(e){const t=l.jk.getHoverUrl(E.getUrlByNode(e));if(t&&e.title)return"<a href="+t+">"+e.title+"</a>"}return""}if("vivaldi/x-title"===e)return n[0]&&n[0].title||"";if("text/uri-list"===e){const e=[];return n.forEach((t=>{E.isFolder(t)||e.push(l.jk.getHoverUrl(E.getUrlByNode(t)))})),e.join("\r\n")}return""}getCutIds(){return S}getFilteredTree(e,t){e=e.toLowerCase();const n=[];function i(s){const o=[];for(const a of s)if(t.inTrash||!a.trash){if(a.children?.length){const e=i(a.children);if(e.length&&t.folders){o.push({...a,children:e});continue}}if(A(a,e)){const e={...a};a.children&&t.folders&&n.push(a.id),e.children&&t.folders&&o.push({...e,children:i(e.children)}),!e.children&&t.bookmarks&&o.push(e)}}return o}return{nodes:t.root?i([E.getRootNode()]):i(E.getTopNodes()),collapsed:n}}getFilteredFlat(e,t){e=e.toLowerCase();const n=[],i=E.iterateTrees(E.getTopNodes(),t.inTrash);for(const s of i)(s.children&&t.folders||!s.children&&t.bookmarks)&&A(s,e)&&(s.children?n.push({...s,children:[],isExpanded:!1}):n.push({...s}));return n}treeSortComparator(e,t,n){if(e.trash)return 1;if(t.trash)return-1;if(E.isFolder(e)&&!E.isFolder(t))return-1;if(E.isFolder(t)&&!E.isFolder(e))return 1;const{sortOrder:i}=n;let{sortField:o}=n;e[o]||t[o]||(o="title",e[o]||t[o]||(o="dateAdded"));return s.Z.getDefaultComparator(i,o)(e,t)}getFoldersWithin(e,t){return e.filter((e=>!e.trash&&e.children&&!e.url)).reduce(((e,{id:n,title:i,children:s})=>(e.push({id:n,title:i,level:t}),s?e.concat(E.getFoldersWithin(s,t+1)):e)),[])}hasNickname(e){if(""===e.trim())return!1;e=e.toLowerCase();for(const t of E.iterateTree())if(e===t.nickname.toLowerCase())return!0;return!1}getNicknamed(e,t){if("string"!=typeof e||e.length<1)return[];e=e.toLowerCase();const n=[];for(const i of E.iterateTree())e===i.nickname.toLowerCase()&&(i.children?t?i.children.forEach((e=>E.isBookmark(e)&&n.push(e))):n.push(i):E.isBookmark(i)&&n.push(i));return n}getDefaultFolderName(){return(0,a.Z)("title","New Folder")}isTrashed(e){return E.isDescendantOf(e,b.id)}isDescendantOf(e,t){for(;;){if(e.id===t)return!0;if(!e.parentId)break;const n=e.parentId?m.get(e.parentId):void 0;if(!n)break;e=n}return!1}isFolder(e){return e.children&&e.children.length>0||void 0===e.url}isPartner(e){return Boolean(e.partner)}isSeparator(e){return"---"===e.title&&"separator"===e.description}isBookmark(e){return!E.isFolder(e)&&!E.isSeparator(e)&&Boolean(e.url?.length)&&e.url!==r.p}validateAsBookmarkBarFolder(e){const t=E.getItemById(e);if(t&&t.children&&!E.isTrashed(t))return t}validateForClipboard(e){return e.filter((e=>e!==b.id))}validateForDrag(e){return e.filter((e=>e!==b.id))}validateForDeletion(e){return e.filter((e=>e!==b.id))}validateForEdit(e){if(-1!==[d,c,h,b.id].indexOf(e))return!1;const t=E.getItemById(e);return!(!t||E.isSeparator(t))}getTitle(e){const t=E.getItemById(e);return t?t.title:""}*iterateTree(){yield*E.iterateTrees(g.children||[])}*iterateTrees(e,t){for(const n of e)n.trash&&!t||(yield n,n.children&&(yield*E.iterateTrees(n.children,t)))}findByUrl(e){for(const t of E.iterateTree())if(t.url===e)return t}isReady(){return f}emitChange(){T?I=!0:super.emitChange()}__reset({bookmarks:e}){g=e}dispatchAction(e){switch(e.actionType){case"BOOKMARKS_INIT":!function(e,t,n){f=!0;const i=e[0];g=i.children[0],g.id!==c&&console.error("Unexpcted root bookmark id");if(g.parentId=void 0,b=i.children.find((e=>Boolean(e.trash))),b.parentId=g.id,b.index=g.children.length,g.children.push(b),v.clear(),Array.isArray(n.folders))for(const e of n.folders)v.set(e.guid,e.title);m.clear(),_(g),M(),k=t}(e.bookmarks,e.failedUpgrade,e.partnerDB),this.emitChange();break;case"BOOKMARKS_SET_BATCH_MODE":e.edit?T=!0:(T=!1,I&&(this.emitChange(),I=!1));break;case"BOOKMARKS_ADD_ITEM":P(e.changes);break;case"BOOKMARKS_CHANGE_ITEM":!function(e,t){let n=m.get(e);if(!n)return;let i=!1;for(const e of Object.keys(t))if(t[e]!==n[e]){i=!0;break}if(!i)return;const s=n.bookmarkbar||t.bookmarkbar!==n.bookmarkbar,o=n.speeddial||t.speeddial!==n.speeddial;n={...n,...t},m.set(n.id,n);let a=null;n.parentId?(a=m.get(n.parentId),a&&a.children&&(void 0!==n.index?a.children[n.index]=n:(a.children[0]=n,console.error("Bookmark node not properly changed. index is missing")))):g.children=n.children||[];a&&O(a,s,o);E.emitChange()}(e.id,e.changes);break;case"BOOKMARKS_MOVE_ITEM":!function(e,t){const n=E.getItemById(e);if(!n)return;D(e,!1),n.parentId=t.parentId,n.index=t.index,P(n)}(e.id,e.changes);break;case"BOOKMARKS_REMOVE_ITEM":D(e.id,!0);break;case"BOOKMARKS_SET_CUT_IDS":S=e.ids,this.emitChange()}}}const E=new Z(o.Z);function _(e){if(e.partner){const t=v.get(e.partner);if(t)switch(t){case"Bookmarks":e.title=p;break;case"Speed Dial":e.title=(0,a.Z)("Speed Dial");break;case"Vivaldi":e.title=(0,a.Z)("Vivaldi")}}if(m.set(e.id,e),e.children)for(const t of e.children)_(t)}function N(e){if(m.delete(e.id),e.children)for(const t of e.children)N(t)}function M(){const e={speeddial:[],bookmarkbar:void 0},t=function(n){n.url||n.trash||(n.speeddial&&e.speeddial.push(n),n.bookmarkbar&&(e.bookmarkbar=n),n.children&&n.children.forEach(t))};g.children&&g.children.forEach(t),C=e.speeddial,y=e.bookmarkbar||g,w=(y.children||[]).filter((e=>!e.trash))}function P(e){const t=e.parentId?m.get(e.parentId):void 0;if(t){const n=t;void 0===e.url&&(e.children||(e.children=[])),_(e),n.children?.splice(e.index||0,0,e),x(n);O(n,!1,Boolean(e.speeddial))}E.emitChange()}function D(e,t){const n=m.get(e);if(!n)return;N(n);const i=n.parentId?m.get(n.parentId):void 0;if(i){const t=i;void 0!==n.index?t.children?.splice(n.index,1):console.error("Bookmark node not removed. index is missing"),x(t);O(t,E.getBookmarkBarFolderId()===e,Boolean(n.speeddial))}t&&E.emitChange()}function x(e){e.children&&e.children.forEach(((e,t)=>{e.index=t}))}function O(e,t,n){for(;e;){e.children=e.children?.slice(),E.getBookmarkBarFolderId()===e.id&&(t=!0),e.speeddial&&(n=!0);const i=e.parentId?m.get(e.parentId):void 0;if(!i)break;e=i}(t||n)&&M()}const L=E},52345:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(35369),s=n(65398),o=n(84990);class a extends s.Z{_queue={};getQueue(e){return this._queue[e]||i.D5()}_addBookmarkQueueItem(e,t,n){this._queue[e]=i.D5({id:t,url:n}),this.emitChange()}_updateBookmarkQueueItem(e,t,n){this._queue[e]&&(this._queue[e]=i.D5({id:t,url:n}),this.emitChange())}_removeBookmarkQueueItem(e){this._queue[e]&&(this._queue[e]=void 0,this.emitChange())}dispatchAction(e){switch(e.actionType){case"BOOKMARK_THUMBNAIL_QUEUE_ADD_ITEM":this._addBookmarkQueueItem(e.pageId,e.id,e.url);break;case"BOOKMARK_THUMBNAIL_QUEUE_UPDATE_ITEM":this._updateBookmarkQueueItem(e.pageId,e.id,e.url);break;case"BOOKMARK_THUMBNAIL_QUEUE_REMOVE_ITEM":this._removeBookmarkQueueItem(e.pageId);break;case"CHROME_TABS_REMOVED":this._removeBookmarkQueueItem(e.tabId)}}}const r=new a(o.Z)},27508:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(24602);class s extends i.Z{getInitialState(){return{isActive:!1}}reduce(e,t){return"BREAKMODE"===t.actionType?{isActive:!e.isActive}:e}}const o=new s},29194:(e,t,n)=>{"use strict";n.d(t,{w:()=>_,Z:()=>P});var i=n(61757),s=n(15800),o=n(65398),a=n(29087),r=n(84990),l=n(5264),d=n.n(l),c=n(30381),h=n.n(c);function p(e){return{displayMode:"month",filterText:"",anchorDate:(new(h())).startOf("hour"),selectedDate:(new(h())).startOf("hour"),allDaySelected:!1,showSearchResults:!1,showCompletedTasks:!1,...e}}var u=n(58821),g=n(8336),m=n(89175),v=n(90870);let f,y=[],w=[],b=[],C={editor:{pageId:NaN,uid:Symbol("CalendarStore")},eventDraft:null,selectedEvent:"",initialEventDraft:null},S=(0,u.EP)(),T=[],I=new Map;const k=d()(1)((e=>e.filter((e=>!e.hidden)))),A=d()(1)(((e,t)=>{const n=new Set(e.map((e=>e.id)));return t.filter((e=>n.has(e.calendarId))).filter((e=>!e.deletePending))})),Z=d()(2)((e=>(0,v.Z)(e,(e=>!e.trash)))),E=d()(2)(((e,t)=>{const n=e.filter((e=>e.task));return t?n:n.filter((e=>!e.complete))})),_=new Map;class N extends o.Z{getPanelResourceKey(){return-999}getMailResourceKey(){return-998}getDialogResourceKey(){return-997}getDefaultCalendar(){const e=a.Z.get(m.kCalendarDefaultCalendarId),t=this.getCalendars(),n=t.find((t=>t.id===e));return!n&&t.length>0?t[0]:n}getDefaultAccountId(){const e=this.getDefaultCalendar(),t=this.getAccounts(),n=t.find((t=>t.id===e?.accountId));return!n&&t.length>0?t[0].id:n?.id??""}getEditState(){return C}getPendingEvent(){return f}getEventsPerCalendar(e){return T.filter((t=>t.calendarId===e))}getEvent(e){const[t,n]=e.split("-")[0].split(":"),i=T.find((e=>e.id===t));return n&&i?g.t.call([i],h()(parseInt(n)),"day")[0]:i}getSelectedEvent(e){if(e&&e===C.editor.pageId)return C.selectedEvent?this.getEvent(C.selectedEvent):C.eventDraft}getEvents(){return T}getVisibleEvents(){const e=k(this.getCalendars()),t=A(e,T),[n,i]=Z(t);return{events:n,trashedEvents:i}}getAccounts(){return y}getAccountForCalendar(e){const t=M.getAccounts(),n=M.getCalendars().find((t=>t.id===e));if(!n)return;const{accountId:i}=n;return t.find((e=>e.id===i))}getCalendars(){return w}getCalendarState(e,t){const n=(0,u.EP)();n!==S&&(i.Z.loadPromise(),S=n);const o=this.getFilter(e,t),a=this.getEditState();o.anchorDate.localeData()!==h().localeData()&&(o.anchorDate.locale(h().locale()),o.selectedDate.locale(h().locale()));let{events:r,trashedEvents:l}=this.getVisibleEvents();r=((e,t)=>{const{initialEventDraft:n}=e;return n&&!n.id?t.concat([n]):t})(a,r);let d=E(r,o.showCompletedTasks),c=g.t.call(r,o.anchorDate,o.displayMode);if(""!==o.filterText){const e=o.filterText.toLowerCase();d=d.map((t=>({...t,filteredOut:!s.Z.eventSearchPredicate(t,e)}))),c=["agenda","year"].includes(o.displayMode)?c.filter((t=>s.Z.eventSearchPredicate(t,e))):c.map((t=>({...t,filteredOut:!s.Z.eventSearchPredicate(t,e)})))}const p=a.eventDraft;if(p&&p.id){const e=T.find((e=>e.id===p.id));e&&p.etag!==e.etag&&(p.etag=e.etag,p.href=e.href)}return{eventDraft:p?{...p}:void 0,initialEventDraft:a.initialEventDraft,selectedEvent:a.selectedEvent,editor:a.editor,events:c,trashedEvents:l,tasks:d,calendarFilter:o,accounts:y,calendars:this.getCalendars(),alarms:b,defaultCalendarId:this.getDefaultCalendar()?.id??""}}getFilter(e,t){if(!e)return p();let n=I.get(e);if(!n){const i=e===M.getPanelResourceKey()?m.kCalendarPanelDisplayMode:m.kCalendarDisplayMode;n=p();const s={displayMode:a.Z.get(i),...t};n={...n,...s},I=I.set(e,n)}return n}clear(){y=[],w=[],T=[],b=[],C={editor:{pageId:NaN,uid:Symbol("CalendarStore")},eventDraft:null,selectedEvent:"",initialEventDraft:null},f=void 0,I=new Map,_.clear()}dispatchAction(e){switch(e.actionType){case"CALENDAR_INIT":!function(e){const{accounts:t,calendars:n,events:i}=e;y=t,w=n,T=i,M.emitChange("calendarDataReady")}(e);break;case"CALENDAR_EVENT_EDIT":!function(e,t){const n=C.eventDraft;if(n&&t&&n.id!==t.id)return;const i=!n,o=!t,a=i||o,r={editor:e,eventDraft:t,selectedEvent:o&&n?n.id:"",initialEventDraft:a?t?{...t}:void 0:C.initialEventDraft};C=r,f=null;const l=M.getFilter(e.pageId);if(i&&t){let n;const i=s.Z.getEventRange(t);if(i&&!i.contains(l.selectedDate)&&(n=i.start),n){const t={...l,selectedDate:n};I=I.set(e.pageId,t)}}M.emitChange("calendarDataReady",e.pageId)}(e.editor,e.eventDraft);break;case"CALENDAR_EVENT_SELECT":!function(e,{event:t,eventId:n,date:i,publish:o=!0,allDay:a}){const r=C.editor.uid===e.uid,l=void 0!==(n=t?.id??n)&&n===C.eventDraft?.id;if(r&&l)return;const d={selectedEvent:n??"",editor:e,eventDraft:r?void 0:C.eventDraft,initialEventDraft:r?void 0:C.initialEventDraft};C=d;const c=M.getFilter(e.pageId);!t&&n&&(t=M.getEvent(n));if(t){const n={};let o;if(i)o=i;else{const e=s.Z.getEventRange(t);e&&!e.contains(c.selectedDate,{exclusive:!0})&&(o=e.start)}if(o){const e=s.Z.getDisplayRange(c.anchorDate,c.displayMode);let t=c.anchorDate;e.contains(o)||(t=o.clone()),n.selectedDate=o,n.anchorDate=t,void 0!==a&&(n.allDaySelected=a)}if(t.start||t.end||"agenda"===c.displayMode||(n.displayMode="agenda"),Object.keys(n).length){const t={...c,...n};I=I.set(e.pageId,t)}}o&&M.emitChange("calendarDataReady",e.pageId)}(e.editor,e.options);break;case"CALENDAR_ACCOUNTS_INIT":i=e.accounts,y=i,M.emitChange("calendarDataReady");break;case"CALENDAR_CALENDARS_INIT":n=e.calendars,w=n,M.emitChange("calendarDataReady");break;case"CALENDAR_UPDATE_UI":!function(e,t){const n=M.getFilter(e),i={...n,...t};if(I=I.set(e,i),n.selectedDate!==i.selectedDate&&C&&C.editor.pageId===e){const e={...C,selectedEvent:""};C=e}M.emitChange("calendarDataReady",e)}(e.pageId,e.calendarUI);break;case"CALENDAR_SET_DEFAULT":M.emitChange("defaultCalendarChange");break;case"CALENDAR_ALARMS_INIT":t=e.alarms,b=t,M.emitChange("calendarDataReady");break;default:return}var t,n,i}}const M=new N(r.Z),P=M},65398:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(56284);class s extends i.Z{constructor(e){super(),e.register(this)}dispatchAction(e){throw new TypeError(`dispatchAction() is not overwritten in ${this.constructor.name}`)}}const o=s},88083:(e,t,n)=>{"use strict";n.d(t,{Z:()=>ve});var i=n(27770),s=n(48603),o=n(59486),a=n(65398),r=n(45502),l=n(84451),d=n(76747),c=n(53576),h=n(63353),p=n(18350),u=n(15285),g=n(20676),m=n(29087),v=n(76501),f=n(63365),y=n(93974),w=n(84990),b=n(15489),C=n(56371);var S=n(92292);var T=n(24899);var I=n(26036);var k=n(7064);var A=n(10334),Z=n(46601),E=n(29489),_=n(21191),N=n(89175),M=n(44850),P=n(27033);let D=!1;const x={name:"",items:[],installed:!1,radioCounter:1,radioGroup:{},hasBookmarkContainer:!1,bookmarkExtrasEdge:"below"},O=!1,L="CONTAINER_WEBPANEL",R="CONTAINER_TAB",B="CONTAINER_PINNED_TAB",F="CONTAINER_CLOSED_TAB",U="CONTAINER_BOOKMARK",V="CONTAINER_PERIODIC_RELOAD",W="CONTAINER_MAC_SERVICES",H=["COMMAND_OPEN_LINK","COMMAND_OPEN_LINK_BACKGROUND","COMMAND_OPEN_LINK_CURRENT","COMMAND_OPEN_LINK_DEFAULT","COMMAND_HIDE_OTHERS","COMMAND_HIDE_VIVALDI","COMMAND_SHOW_ALL"],z=[{name:L,hideInSettings:!1},{name:R,hideInSettings:!1},{name:B,hideInSettings:!1},{name:F,hideInSettings:!1},{name:V,hideInSettings:!1},{name:U,hideInSettings:O},{name:W,hideInSettings:!0}];let G=[];const $={},K=new Map(Z.CN.map((e=>[e.name,e.feature]))),j=["COMMAND_CLOSE_TAB","COMMAND_CLOSE_WINDOW","COMMAND_EXIT","COMMAND_QUIT_MAC_MAYBE_WARN","COMMAND_NEW_WINDOW","COMMAND_NEW_PRIVATE_WINDOW","COMMAND_SHOW_HELP"],Y=Z.CN;let X;function Q(e){const t=X||(X={MENU_FILE:{...(0,I.Z)("win_linux","File")},MENU_EDIT:{...(0,I.Z)("win_linux","Edit")},MENU_VIEW:{...(0,I.Z)("win_linux","View")},MENU_BOOKMARKS:{testVisibility:e=>!b.ZP.isGuestSession(e),...(0,I.Z)("win_linux","Bookmarks")},MENU_TOOLS:{...(0,I.Z)("win_linux","Tools")},MENU_WINDOW:{...(0,I.Z)("win_linux","Window")},MENU_HELP:{...(0,I.Z)("win_linux","Help")},MENU_IMAGES_AND_ANIMATION:{...(0,I.Z)("win_linux","Images and Animations")},MENU_CAPTURE:{iconPNG:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADCSURBVHgB1ZHBEcIgEEXB5JBjSsASvDFwoRMtQSvQDqwhlXiCqyXEDsydYfDvIRlEUK/5h7Cz87O8zzK2evFSU2s94hBpL8b4cM5t2S8ZY4RSaiwMfUopRd5v6YMfDpzzK8reez+hPuZGEJyaprlhkCAaeC7W2mFBLk3/RklEKV7MTURFJoqDc88+I8UlQklAPIcQdl3XMcS6ozWUfBtWVz8XyDzVTFWC+dFwe1961DfVVlRTuuo2vY1W9M+A2qpXqhfDA07BmbR5ZAAAAABJRU5ErkJggg==",iconPNGWhite:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAAXNSR0IArs4c6QAAAGRJREFUeNq9j8EVwCAIQx2FzeqmvcTnGBmBEegBq/hKjy3ckk+Mpfw5IMy3MbFPWTK0S7BahcKgOIJCWONQwI0PmVAHLGbNu+UsAOwy71JAu2xl7fkEY9kb0LeSI8s/lWzI+nQuBXxjN95EoeQAAAAASUVORK5CYII=",...(0,I.Z)("win_linux","Capture")},COMMAND_NEW_PRIVATE_WINDOW:{testVisibility:e=>!b.ZP.isGuestSession(e)},COMMAND_NEW_GUEST_WINDOW:{testVisibility:e=>!b.ZP.isIncognito(e)},COMMAND_OPEN_PAGE:{ellipsis:!0},COMMAND_FOCUS_ADDRESSFIELD:{ellipsis:!0,...(0,I.Z)("Open Location")},COMMAND_SAVE_PAGE:{ellipsis:!0},COMMAND_PRINT_PAGE:{ellipsis:!0},COMMAND_START_CHROMECAST:{ellipsis:!0},COMMAND_IMPORT_DATA:{testVisibility:e=>!b.ZP.isGuestSession(e),ellipsis:!0},COMMAND_EXPORT_DATA:{testVisibility:e=>!b.ZP.isGuestSession(e),ellipsis:!0},COMMAND_OPEN_SESSION:{testVisibility:e=>!b.ZP.isGuestSession(e),ellipsis:!0},COMMAND_SAVE_SESSION:{testVisibility:e=>!b.ZP.isGuestSession(e),ellipsis:!0},COMMAND_FIND_IN_PAGE:{ellipsis:!0},COMMAND_TOGGLE_MENU_POSITION:{prefs:{pref:N.kMenuDisplay,isChecked:()=>{const e=m.Z.get(N.kMenuDisplay);return!0===e||"top"===e||"on"===e}},...(0,I.Z)("Horizontal Main Menu")},COMMAND_MAIN_TOGGLE_TAB_BAR:{prefs:{windowState:"tabs",isChecked:e=>b.ZP.getVisibleUI(e).tabs},...(0,I.Z)("command","Show Tab Bar")},COMMAND_SHOW_BOOKMARK_BAR:{prefs:{windowState:"bookmarksBar",isChecked:e=>b.ZP.getVisibleUI(e).bookmarksBar},...(0,I.Z)("command","Show Bookmarks Bar"),testVisibility:e=>!b.ZP.isGuestSession(e)},COMMAND_TOGGLE_FOOTER:{prefs:{windowState:"statusBar",isChecked:e=>"on"===b.ZP.getVisibleUI(e).statusBar},...(0,I.Z)("command","Show Status Bar")},COMMAND_TOGGLE_STARTPAGE_NAVIGATION:{prefs:{pref:N.kStartpageNavigation,isChecked:()=>{const e=m.Z.get(N.kStartpageNavigation);return"on"===e||"speed_dial_only"===e}},...(0,I.Z)("command","Show Start Page Navigation")},COMMAND_TOGGLE_PRIVACY_STATS:{prefs:{pref:N.kStartpageSpeedDialPrivacyStatsShow,isChecked:()=>{const e=m.Z.get(N.kStartpageSpeedDialPrivacyStatsShow);return!0===e||"speed_dial_only"===e}},...(0,I.Z)("command","Show Privacy Statistics")},COMMAND_TOGGLE_PANEL:{prefs:{panelState:"SHOW_PANEL",isChecked:e=>u.ZP.getIsBarVisible(e)},...(0,I.Z)("command","Show Panel")},COMMAND_SHOW_BOOKMARK_PANEL:{iconPNG:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACJSURBVHgB7ZKxCoAgEIavaG3wBcJGt2ZdnHurXiR6itY2X6Pew8HOUAgREaWtH0Tvzv87Dg6gUk2YEEKceNHYZ2PMpZQaISUEmCDV+xOpQQuV+gFfA6SUlDE2FAGsWWt9EEL2FKRLmXHzNhs7yJwN8GZc28XGnPMHArkjvM1W7r1CjrDbVFIr1g1wAzRdx1+LFgAAAABJRU5ErkJggg==",iconPNGWhite:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAAXNSR0IArs4c6QAAAE9JREFUeNpjYCAWHLl/5D8CHr2PqeA/hP7PC4Iw3jBVsF/hmjYeBfsVjtw/+hCkBKsCsHT90XqQEqwKQNIgFkgJVgUQaYgSLAqOGuDm4QUAABBqP/s39jMAAAAASUVORK5CYII=",testVisibility:e=>!b.ZP.isGuestSession(e)},COMMAND_SHOW_MAIL_PANEL:{iconPNG:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACFSURBVHgB7ZHRDYAgDETBMAhuoL8wBZOyBb+6gWyCVyOmQSAMwCWkTem7tKkQUzIn1toLQY9AKaUYQlgpV6yu8bEjejyHhpNDxphNSunR4xCPXF940ws5MiGgBpfGqhyPGgBkE/fs2YB/E9Qm6cFNA27Sg6srVEy64gYRp0xiQHRGMfXpBmxdTd/71HkZAAAAAElFTkSuQmCC",iconPNGWhite:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAATklEQVR42s3PsQ3AMAgEwB+J/ev/ORiFFAhjKxTuEqiAkwDgJ0FnvFPeIGRyWdUyuoyxAaBJjrO7gSI1HkASrlUDAGR9yQiO3+L+zY/jAaekW1uCzRxFAAAAAElFTkSuQmCC",testVisibility:e=>u.ZP.canRender(e,"mail")},COMMAND_SHOW_CONTACTS_PANEL:{iconPNG:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAF0SURBVHgBtVM7boNAEOVnic72BSwiX8DpIn8UcgIfIeEEzg1QTuA6nW8Q5wZE4lcmXTrb0KTcBgnxzRuLtQhQIEUeabXLm3lvZ98IQfhniH2KFovFnSiK93TO89z3PO+D56Q+AmVZakVRqLQgpCNGPKfUCymRZdkzCJsK2g0Ggxfse+AbEiAwjmMSYK0O0jTdgjwE6QbrFtAYmGlZVozWv7q6E+u3o/jgOM64iZFgFEUa9jUu+IEHry0PqC0kWV0dN9M3S5JkKMvyOYddrXvQy0QKPOFMgg/k0yMXuQj4vn+Ew8JyudQ5Np/PZ+hKcF33pCiKxnESQcdrOv+ZAgQMEN5WqxXtjM6SJBlV6wzEeu2oJYDQiQjjPlVVpamQyAz43rZti2xp1Atyrd0nmj9ueaDnINh0On3H27eTyYSFYdg5RpmTsZmczJNcBPhO07RTEATfTQGpek+LzAOjJHMN5M2uDi4ewKQDfpquGvoXaB2Fa8QvffXhZBpebQgAAAAASUVORK5CYII=",iconPNGWhite:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAvklEQVR42pWQMQ7CMAxFMzLmBvgIjGx0ZOzIVjbGjh3bG/QIcBNL2EkkFo7gI+QIILeiTSMqgS1FSfzy429j/g/eU0ONP6wC7uRaTbTJJVrqOHLkHi1uqFEgQCp7HUrAN+6N8ccMQMtx3qF97FzrL8n7AE4mLXHbAK6lOukhB1QhQ1ioGBzsFPXl6CNUE0AFx3s5rnoaAV/PQOckAAILdd9Gc9by4AJYuFotfxD9Jh2SLGam/TwzgF/LnE3/EG8smIVnSsnf6AAAAABJRU5ErkJggg==",testVisibility:e=>u.ZP.canRender(e,"contacts")},COMMAND_SHOW_DOWNLOADS_PANEL:{iconPNG:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAADPSURBVHgBxZLBDYIwFIZblTtMAIYpBA51BKfwzAS6gUePzuAGvUC4OoFNF5B7k9a/Rkw1QCQQ/ZKmf1/7+t5rHyEjoV0baZpeMUVWG2NEWZZLMgRcYNr0JzMykv9fsGgEY8xXSt26Drrv4HlewDmv3zKwBkrpGlJorfOiKF4/9NQ5Ro091jhb5m4UKaWI4/iMbzuGYRhgza09y7I9bFs4r6qqurg+rX2AciKUc4LTIxIy85H2xo38FUmS7FD7gfyEvm7rOztdHwA+IAtOpuIO/nhVS2EDB78AAAAASUVORK5CYII=",iconPNGWhite:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAb0lEQVR42mNgIAUcuX/k/5H/R+/jVvAfQdJbwX4BkONAEKIAAvcLICk57HDk/rECuEkFR94fs0c3ReHI/cMNYMUNR+8fV8Digv0KR/YfXX90/ZH9KIajgqP1R/oZyADYfY4kSljBfpjfUeB+oqwHAI1/WdoNOXPUAAAAAElFTkSuQmCC"},COMMAND_SHOW_NOTES_PANEL:{iconPNG:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACgSURBVHgB7VLBDYQgENw1FnAlWAeEGrSEK+GugrsOtAU70CKgDkuwAnBMNFHCRhM/PpwPsDPsLuwQXQRvD0qpNzPX2L5S4hDCAP5vrW3XWLbLxvyTLi98gaXZxvJIU6BK5ZzrUwmMMaX3viMJWutAB4g1GV1EfqbKCnwen0qQEj4dyIjHOMLOpSSGkarZzmIHIL+wa4MnJN0GF47gP3QrTBi9PG385uw1AAAAAElFTkSuQmCC",iconPNGWhite:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAASklEQVR42mNgIA4cTTjy/sh/BDx6/0g8ioIj95GlwfA9qoL/R/2R+Yf8j/xHU4BuKTkKkF0wRE14jxZQAUfvo8cFamC/R4sLCgAAKuF43sJZFFMAAAAASUVORK5CYII=",testVisibility:e=>!b.ZP.isGuestSession(e)},COMMAND_SHOW_HISTORY_PANEL:{iconPNG:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAD8SURBVHgB3VJLDoIwEG1BYMsR8Aa647fgKHAC4gn0BsQTKCfwCOCChB3eQI9QtxDAmYQmTW2NOxMnadKZad983iPk10blQJIk3jAMJ7hu4LhCis3zXE/TtGvb9sGDhuJzhw8ty1o3TUP5QZ9SejVNs/N93yMqC8PwEgRBLsXukr+PoqhSdgAVEsdxSinmib5t28dlvHcAnLmua0Y+2JJ3dQBK0878JUBpGEalA5EBGDAhUkeAgRS3DyAF+kue6QBufd/nchUEgeVleAeaU6SZ51biQ+A6Qx0AlU9g4ywvNI7jA3zOQUxbHlMqEbookFIiKRE7HMcxE5X4B/YCuLpojZ4/JTwAAAAASUVORK5CYII=",iconPNGWhite:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAf0lEQVR42rWQ3RWAIAiFHcER2jA3sFHawBF46GJjNAIj2Kn879RT4QMIH4hXqc+MBhAE4TzCbh36srAlHW8aBtIg7PwYoy16C6oASOpGyFOkBsJb1KXT20/AzNuFtEDe4UTcfQdiW31aKwVzYI0O3hQdlqnT4UDYFSVBXflP2wFyclxBF22/4AAAAABJRU5ErkJggg==",testVisibility:e=>!b.ZP.isGuestSession(e)},COMMAND_SHOW_WINDOW_PANEL:{iconPNG:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABYSURBVHgB7ZLdCcAgDIQvpYO0c2T+ZI26SWofCgriDwqC+L3kOMiFkACzoV8w8+PLVdNkZk5V78j0AVbSKe9AJ5SblENEKDJaAoausAOAM9Cu9hLfJ2IdXuDHHKAeH9NrAAAAAElFTkSuQmCC",iconPNGWhite:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAALElEQVR42mNgoAo4cv/If0x49D5CwX90EpVFjALskAGLWmSXDTUFhEKStgAAWEdiK3NU7WoAAAAASUVORK5CYII=",testVisibility:e=>u.ZP.canRender(e,"tabs")},COMMAND_SHOW_CALENDAR_PANEL:{iconPNG:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACISURBVHgB1ZLBDYAgDEVr4wCOwBgEhnEGN3AEV3AST8whI7ABloQmmCgQ5aAvIfxC+wsEgNYopXat9Z7TKR0L2hxpWmgMhR6WxmyMWUOAvOq9nyuKAyI2OkMn8FBJmovwErxy5w53OmvwmGZv8O8rOCmlKBXHHMtxz4J+4oSIG7mLgocLufAZDrWyPsrbeWhUAAAAAElFTkSuQmCC",iconPNGWhite:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACOSURBVHgB1ZLBDYAgDEULMeHqCFyZyhncwBFYwUkcgRscZQQnAEsiCQcEohz0JSQt+f2FpgC90Vrv4ZTiFBIDY8zknJOEkLHSw6JmEUKsIaHx1nu/NBQHOGolZJ7uoZFUS+ElNOceO9zFRYPHdJvBj7+Ay3EopXit+NLYmA+JwcwY29CdlwxCI1z5GT7DCTJle8x3rbO8AAAAAElFTkSuQmCC",testVisibility:e=>u.ZP.canRender(e,"calendar")},CONTAINER_WEBPANEL:{...(0,I.Z)("Web Panels"),settingsLabel:(0,C.Z)("[All Web Panels]")},COMMAND_SET_LOAD_IMAGES_ALWAYS:{prefs:{imageLoadingPref:"always",isChecked:e=>"always"===h.Z.getActivePage(e)?.imageLoading}},COMMAND_SET_LOAD_IMAGES_NEVER:{prefs:{imageLoadingPref:"never",isChecked:e=>"never"===h.Z.getActivePage(e)?.imageLoading}},COMMAND_SET_LOAD_IMAGES_CACHE:{prefs:{imageLoadingPref:"cache",isChecked:e=>"cache"===h.Z.getActivePage(e)?.imageLoading},...(0,I.Z)("Load Images from Cache")},COMMAND_SET_ANIMATIONS_LOOP:{prefs:{animationPref:"allowed"}},COMMAND_SET_ANIMATIONS_NEVER:{prefs:{animationPref:"none"}},COMMAND_SET_ANIMATIONS_ONCE:{prefs:{animationPref:"once"}},COMMAND_MAIN_ZOOM_IN:{persistent:!0},COMMAND_MAIN_ZOOM_OUT:{persistent:!0},CONTAINER_BOOKMARK:{settingsLabel:(0,C.Z)("[All Bookmarks]"),settingsRename:!1,testVisibility:e=>!b.ZP.isGuestSession(e)},COMMAND_SHOW_SETTINGS:{iconPNG:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABFUlEQVR4AWJwL/ChCOOUsLKy2m9tbf0fhIHs9SQbACidvK0yCGIgHGISTEj0d4D3tgPoADrgOoAOoIMt6UrQ2XhLAH3vSTzhzwRr5WZGuxpYHh4e7hwfHy80gfyXgIDn09PTpM47FxcXr7pm7q+vr9dBgU3v73SfTk5OipgAp4U5PeoqGvxCIDa3690TSW0Vt3v1xBgqHL4gigluqAyNIOKDVeT+PlLlTmlcf9IAfigfHKXv+1URWSZRFNeDPUFEUQYEua7rraZpNqkY26vj9icRBYEiBbvLkYKLSHs/EqC6izJkgML9Y5vEBMqsXsHfgr0NodX4uD1qUIAEftbWNwIZBJhtBxs0Bj9lCyqn/IU06zMNHe/UfCL6J8KbGwAAAABJRU5ErkJggg==",iconPNGWhite:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAVFBMVEX////ExMTFxcXExMS/v7/FxcXExMTDw8PExMTFxcXHx8e/v7/ExMTExMTFxcXFxcXDw8PGxsbKysrFxcXCwsLDw8PFxcXExMTGxsbGxsbExMTExMQtledLAAAAG3RSTlMA79+fEJ/PgN9/ICCPvzBgkG8wr1BAT18/cHDxOv8OAAAAdUlEQVR4AQXBhQHDIAAAsOBQnRv//7kEAABgn/MOAOptiQBaOS5BnuWRvrDOa98y6wgjZqQEQCp49sYZ4psWP/DY6QTqBzwrgcj+grUPzh7ejLhgKwDsBWtsoS3kS7yGBX7bK82cw3akAaDejgoA0px3AADAH03KBE7hRjloAAAAAElFTkSuQmCC",ellipsis:!0,testVisibility:e=>!b.ZP.isGuestSession(e)},COMMAND_SHOW_QUICK_COMMANDS:{ellipsis:!0},COMMAND_SHOW_BOOKMARKS:{testVisibility:e=>!b.ZP.isGuestSession(e)},COMMAND_SHOW_HISTORY:{testVisibility:e=>!b.ZP.isGuestSession(e)},COMMAND_SHOW_NOTES:{testVisibility:e=>!b.ZP.isGuestSession(e)},COMMAND_SHOW_CALENDAR:{testVisibility:e=>!b.ZP.isGuestSession(e)&&!m.Z.get(N.kMailIsTurnedOff)},COMMAND_SHOW_MAIL:{testVisibility:e=>!b.ZP.isGuestSession(e)&&!m.Z.get(N.kMailIsTurnedOff)},COMMAND_SHOW_EXTENSIONS:{testVisibility:e=>!b.ZP.isGuestSession(e)},COMMAND_CAPTURE_PAGE_TO_DISK:{...(0,I.Z)("Page to File")},COMMAND_CAPTURE_PAGE_TO_CLIPBOARD:{...(0,I.Z)("Page to Clipboard")},COMMAND_TAB_TRANSLATE_PAGE:{...(0,I.Z)("command","Translate Page")},COMMAND_CAPTURE_AREA_TO_DISK:{...(0,I.Z)("Area to File")},COMMAND_CAPTURE_AREA_TO_CLIPBOARD:{...(0,I.Z)("Area to Clipboard")},COMMAND_SHOW_CLEAR_PRIVATE_DATA:{ellipsis:!0,testVisibility:e=>!b.ZP.isIncognitoOrGuest(e)},COMMAND_DEVELOPER_TOOLS:{testVisibility:e=>!h.Z.isActiveInternal(e)},COMMAND_FULLSCREEN:{...(0,I.Z)("Fullscreen")},COMMAND_MAIN_TOGGLE_UI:{prefs:{windowState:"minimalUI",isChecked:e=>!b.ZP.isMinimalUI(e)},...(0,I.Z)("Show UI")},CONTAINER_PINNED_TAB:{...(0,I.Z)("title","Pinned Tabs"),settingsLabel:(0,C.Z)("[All Pinned Tabs]")},CONTAINER_CLOSED_TAB:{...(0,I.Z)("title","Closed Tabs"),settingsLabel:(0,C.Z)("[All Closed Tabs]")},CONTAINER_TAB:{...(0,I.Z)("title","Tabs"),settingsLabel:(0,C.Z)("[All Tabs]")},CONTAINER_PERIODIC_RELOAD:{...(0,I.Z)("title","Periodic Reload"),settingsLabel:(0,C.Z)("[Periodic Reload]")},COMMAND_SHOW_WELCOME:{testVisibility:e=>!b.ZP.isGuestSession(e)},COMMAND_CHECK_FOR_UPDATES:{ellipsis:!0,testVisibility:()=>!0},COMMAND_SHOW_ABOUT:{iconPNG:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAEySURBVHgBzVLLTcQwEHU+yjkN5EMHHPM75MgROqADditIOHKDClg6gAowUn43tgQraYAjRErCG5FFjjd7hifZ4xm9eTNjm7G/hkFbkiS54zivruv6Xde9nCLHcUycned5Wtu2nGI6bdM0ZTPnOgzDzVoyiqQwqcL/EQD4b0DXszRNbVXANM09zMfs7hcCmqbdSly77/sbVYBzTsmCzsMwXC0EiqLgaOv5EITgJggCnx3DBm/XNI1YCBAsy9pKLdqGYTzKo9BFw/jjOMrdMk12oijKUD0/+KgmaF7EfNhz+HlVVQsBXXbQxYPUBY3iY13OyQLVn5gCQ3aEEJ945y8cL1Qi3Utd129HcbYCfJh3qiqPgtbP1rj6WhDVtoqfsxMw1oL4pgKj0AsEWPdlWd6xf4tvaZVsnjSI7BsAAAAASUVORK5CYII=",iconPNGWhite:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAjUlEQVR42q1QSRGAMAysBCQgBSdYwAE4qAQkICEPtvBEAhIqYZm2FAIDvEhe2dlrYswPM3Yg+isGAccuHww7NUpSJUyxQXgpMkEKeBDLje9aFbGAc3mcbkgeJ4TV6VZSRktCUkyorfTRo91jVjcEex2nazHTbvqY2pwE1I8PC9ZJ//bR6lMfPSwIa36eDUlAgXmKiZFsAAAAAElFTkSuQmCC"}},X);const n=t[e.action],s=n?.label??"",o=n?.labelEnglish??"",a=function(e){const t=e.parameter;if(void 0===t)return;if("COMMAND_OPEN_LINK"===e.action)return{handler:e=>{const n=i.ZP.getOpenOptionsFromDisposition(e.windowId,"setting",!1,e.keyState);c.Z.openURL(e.windowId,t,{...n})},url:t};return}(e);return a?{...n,...a,label:s,labelEnglish:o}:{...n,label:s,labelEnglish:o}}function q(e,t){e.forEach((e=>{const n=e.name,i=e.function,s=e.isEnabled,o=e.feature,a=e.onAutoRepeat||!1,r="browser"!==e.feature;l.Z.bind(t,i,a,r,s,o),G.push({name:n,key:t,func:i,feature:o})}))}function J(e,t,n){for(let i=n.length-1;i>=0;i--)if(n[i].items)J(e,t,n[i].items);else if(n[i].commandName===e){t.shortcuts?n[i].shortcuts=t.shortcuts:delete n[i].shortcuts;break}}function ee(e){const t=P.Z.getState(),n=m.Z.get(N.kActions)[0];[...t.map((e=>{const t=(0,E.IN)(e),i=n[t.name];if(i)return{key:t.name,value:{...i,feature:"browser"}}})).filter(Boolean),...e].forEach((e=>te(e))),function(){G.forEach((e=>{l.Z.unbind(e.key,e.func)})),G=[];const e=me.getCommandsForShortcuts();Object.keys(e).forEach((t=>{q(e[t],t)}))}(),D=!0}function te(e){$[e.key]=e.value,x.installed&&J(e.key,e.value,x.items)}function ne(e){if($[e]){const{shortcuts:t}=$[e];delete $[e],t?.length&&l.Z.unbind(t)}k.Z.menuContent.removeAction([e])}function ie(e){return t=>{const n=m.Z.get(N.kChainedCommandsCommandList);for(let i=n.length-1;i>=0;i--)if(n[i].key===e)return void(0,A.hT)(t,n[i].chain);console.warn("No chain match for: ",e)}}function se(e,t){const n={},i=P.Z.getScripts().map((e=>(0,E.IN)(e))),s=Y.concat(m.Z.get(N.kChainedCommandsCommandList)).concat(i);for(const i in $){const o=$[i];if(!o)continue;const a=o[e];a&&s.filter((e=>e.name===i&&(!0===t||!(0,Z.os)(e.name)))).forEach((e=>{a.forEach((t=>{n[t]=(n[t]||[]).concat({function:e.chain?ie(e.key):e.action,label:e.label,name:e.name,onAutoRepeat:e.repeat,isEnabled:e.isEnabled,feature:e.feature||"browser"})}))}))}return n}function oe(e,t){let n=d.Z.commandItem;const i=Q(e),s=e.type;if("folder"===s)n={id:e.id,commandName:e.action,items:[],type:s,...i,withNoWindow:!0},e.children&&e.children.forEach((e=>{const i=oe(e,t);i&&n.items&&n.items.push(i)}));else if("command"===s)n={id:e.id,commandName:e.action,type:s,...i};else if("checkbox"===s)n={id:e.id,commandName:e.action,type:s,...i};else if("radio"===s){if(!e.radiogroup)return;{let t=x.radioGroup[e.radiogroup];void 0===t&&(x.radioGroup[e.radiogroup]=x.radioCounter++,t=x.radioGroup[e.radiogroup]),n={id:e.id,commandName:e.action,type:s,radiogroup:t,...i}}}else if("container"===s){if(-1!==z.findIndex((t=>t.name===e.action))){const o={content:e.action,mode:e.containermode,edge:e.containeredge,cpp:e.action===U||e.action===W};n={id:e.id,type:s,...i,container:o,withNoWindow:!0},t&&e.action===U&&(x.hasBookmarkContainer=!0,e.containeredge&&(x.bookmarkExtrasEdge=e.containeredge))}}else"separator"===e.type&&(n={...d.Z.separatorItem,id:e.id});void 0!==e.title&&(n.label=n.labelEnglish=e.title,n.settingsLabel&&delete n.settingsLabel,n.ellipsis=!1),void 0!==e.custom&&(n.custom=e.custom),n.showshortcut=e.showshortcut,n.feature=K.get(e.action)||"browser";const o=$[e.action];return n.shortcuts=o?.shortcuts,n}function ae(e,t){x.installed&&re(x.items),x.name=e,x.radioCounter=1,x.radioGroup={},x.items=[],x.hasBookmarkContainer=!1,x.bookmarkExtrasEdge="below",t?t.forEach((e=>{const t=oe(e,!0);t&&x.items.push(t)})):console.error("No entries in menu:",e),le(void 0,x.items,!0),x.installed=!0}function re(e){for(const t of e){if(t.items){re(t.items);continue}const e=t.prefs;if(!e)continue;const{callback:n}=e;n&&(e.pref?m.Z.removeListener(e.pref,n):e.imageLoadingPref?h.Z.removeListener(n):e.animationPref?S.Z.accessibilityFeatures.animationPolicy.onChange.removeListener(n):e.panelState?u.ZP.removeListener(n):e.windowState&&b.ZP.removeListener(n))}}function le(e,t,n){const i=(e,t)=>{e.statestrings&&(e.label=e.statestrings[t?1:0].label,e.labelEnglish=e.statestrings[t?1:0].labelEnglish),e.checked=t},s=(e,t)=>{const n=()=>{if("function"==typeof t.isChecked){const n=void 0!==t.windowId&&t.isChecked(t.windowId);e.checked!==n&&(i(e,n),me.emitChange("menuState"))}};return t.callback=n,n};for(const o of t){if(o.items){le(e,o.items,n);continue}const t=o.prefs;if(!t)continue;t.windowId=e;const a=t.pref;if(a){if("function"==typeof t.isChecked){const e=void 0!==t.windowId&&t.isChecked(t.windowId);i(o,e),n&&m.Z.addListener(a,s(o,t))}}else if(t.imageLoadingPref){if("function"==typeof t.isChecked){const e=void 0!==t.windowId&&t.isChecked(t.windowId);i(o,e),n&&h.Z.addListener(s(o,t))}}else if(t.animationPref){if(n){const e=function(){S.Z.accessibilityFeatures.animationPolicy.get({},(({value:e})=>{const n=e===t.animationPref;this.checked!==n&&(i(this,n),me.emitChange("menuState"))}))}.bind(o);t.callback=e,e(),S.Z.accessibilityFeatures.animationPolicy.onChange.addListener(e)}}else if(t.panelState)switch(t.panelState){case"SHOW_PANEL":case"SHOW_CONTENT":if("function"==typeof t.isChecked){const e=void 0!==t.windowId&&t.isChecked(t.windowId);i(o,e),n&&u.ZP.addListener(s(o,t))}}else if(t.windowState&&"function"==typeof t.isChecked){const e=void 0!==t.windowId&&t.isChecked(t.windowId);i(o,e),n&&b.ZP.addListener(s(o,t))}}}function de(e,t,n){const i=m.Z.get(N.kChainedCommandsCommandList),s=t=>{for(let a=0;a<t.length;a++){const l=t[a];let d=!1;if(l.commandName){for(let e=i.length-1;e>=0;e--){const t=i[e];if(t.name===l.commandName){l.handler||(l.handler=ie(t.key)),l.label||(l.label=t.label||""),l.labelEnglish||(l.labelEnglish=t.labelEnglish||t.label||""),d=!0;break}}if(!d)for(let t=0;t<Y.length;t++){const i=Y[t];if(i.name===l.commandName){n.inSettings||i.isEnabled(e)||(l.visible=!1),l.handler||(l.handler=i.action),l.withNoWindow=i.withNoWindow,l.label||(l.label=i.label||""),l.labelEnglish||(l.labelEnglish=i.labelEnglish||""),d=!0;break}}}if(d||"command"!==l.type||(console.warn("No match for menu item",l.commandName),void 0===l.label&&(l.label=l.commandName||""),void 0===l.labelEnglish&&(l.labelEnglish=l.commandName||""),l.visible=!1,l.handler=()=>{}),le(e,[l],!1),l.commandName){const t=$[l.commandName]?.shortcuts;if(t){const n=r.Z.getContext(e)?.feature||"browser",i=l.feature||"browser";l.shortcuts=t.filter((e=>i===n||("browser"===i?!G.some((t=>t.key===e&&t.feature===n)):void 0)))}}if(l.items)s(l.items);else if(l.container&&n.expandContainers)if(!0===l.container.cpp)if(l.container.content===U){const e=l.container.edge||x.bookmarkExtrasEdge,t=m.Z.get(N.kBookmarksManagerSorting),n=y.Z.toMenuSorting(t.sortOrder,t.sortField),i={id:o.ZP.getRootId(),type:k.Z.menubarMenu.ContainerType.BOOKMARKS,offset:0,edge:e,groupFolders:t.sortOrder!==y.Z.NO_SORTING,sortField:n.field,sortOrder:n.order};l.container&&(l.container.details=i)}else l.container.content;else{let n,i,s=[];l.container.content===L?s=ce(e):l.container.content===B?(s=pe(e),n="iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAD5SURBVHgBtVHBDYJAEOTQvz59WoJvIPFKwA6kEqES7UCtAPwQflqCDwrgSUIAZ8iRXIAE0DjJZfcuO3O7s4bxIxZziqWU6w2QpmnWvpkzyNuiKJ6maYaWZe1mC4B8ruv6gvSAc2U3kwUcx/EZ4zgO0IHLPM/zRkAMFMuqqvbtXQixxs8uiB7iiW9lWXpJkryZL7sCJIMkURzxjkjDAsRmBHah1/cEgDsKj4wofvEBpvHnW5dM9DxQpMYo3W3ViTEqQA9U2hMZFeCuOSs8CHURejJJgLtGoEiGs2rHoaHYwmNIQGit+2pNkb6mSWDrtm3Xyu3vMGbW3/ABNRKFPPHD6XUAAAAASUVORK5CYII=",i="iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAMFBMVEX///+/v7/Hx8e/v7/ExMTFxcXFxcXExMTFxcXDw8PDw8PExMTFxcXExMTExMTGxsbQpf+eAAAAEHRSTlMAECAg398wv3+AQI9g7/8/FKJcHQAAAFFJREFUeAFjQAWMClCGSRiUUZEqAKY5C6aC5FZ0bF1eBOK3d/R4gCVSEzg2gBlsYRwNYMay1Awwg9k3LRzMYH/6IWMBiDEPqBUs8wJmYQKaAwANFhLITP6v6wAAAABJRU5ErkJggg=="):l.container.content===F?s=he():l.container.content===R?s=ue(e):l.container.content===V&&(s=g.Z.getForActivePage(e)),"folder"===l.container.mode?(delete l.container,l.type="folder",l.items=s,l.iconPNG=n,l.iconPNGWhite=i):(t.splice(a,1,...s),a+=s.length-1)}}},a=(0,T.Z)(t);return s(a),a}function ce(e){return u.ZP.getWebPanelOrder(e).map(((t,n)=>{const i=u.ZP.getWebPanels(e).filter((e=>e.id===t))[0],s=$["COMMAND_SHOW_WEB_PANEL_"+(n+1)],o=s?.shortcuts?s.shortcuts:[];return{...d.Z.makeNumberMnemonic(i.title||i.url||(0,C.Z)("Unknown Web Panel"),n),commandName:"JS_LOCAL_TOGGLE_WEBPANEL",parameter:t,handler:()=>p.Z.toggleContent(e,t),url:i.activeUrl,shortcuts:o}}))}function he(){const e=e=>{return(t=M.jk.getDisplayTitle(e)).length>70&&(t=t.substring(0,70)+"..."),t;var t},t=f.Z.getTrash().map(((t,n)=>{if(t.tab){const i=t.tab;return{...d.Z.makeNumberMnemonic(e(i),n),url:i.url,handler:()=>v.Z.undeleteTab(i)}}const i=t.window;if(i?.tabs){const{tabs:t}=i;return{...(0,I.Z)("Window with $1 Tab","Window with $1 Tabs",[t.length]),items:t.map(((t,n)=>({...d.Z.makeNumberMnemonic(e(t),n),url:t.url,handler:()=>v.Z.undeleteTab(t)}))).concat([d.Z.separatorItem,{handler:()=>v.Z.undeleteWindow(i),...(0,I.Z)("Restore All")}])}}})).filter(Boolean),n=t.length;return t.push(d.Z.separatorItem),t.push({handler:v.Z.emptyTrash,visible:n>0,...(0,I.Z)("verb","Clear All")}),t}function pe(e){return h.Z.getTabs(e,!1).toArray().filter((e=>"tab"===e.type&&e.page.pinned)).map(((e,t)=>{const n=e.page;return{...d.Z.makeNumberMnemonic(M.jk.getDisplayTitle(n),t),handler:()=>c.Z.activateTab(n.id,n.windowId),commandName:"JS_LOCAL_ACTIVATE_TAB",url:n.url,parameter:n.id.toString(),emphasized:n.active}}))}function ue(e){return h.Z.getTabs(e,"off"===m.Z.get(N.kTabsStackingMode)).toArray().filter((e=>"tab"===e.type&&!e.page.pinned||"group"===e.type)).map(((e,t)=>{if("tab"===e.type){const n=e.page;return{...d.Z.makeNumberMnemonic(M.jk.getDisplayTitle(n),t),handler:()=>c.Z.activateTab(n.id,n.windowId),commandName:"JS_LOCAL_ACTIVATE_TAB",url:n.url,parameter:n.id.toString(),emphasized:n.active}}if("group"===e.type)return{...d.Z.makeNumberMnemonic(h.Z.getTitleByGroupId(e.id,e.page.title),t),iconPNG:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABtSURBVHgBvZJLCsAgDERj8SD2Gnp+vYbeJDXQRQlNiB98C7NweAwkAIs4elJKtY8ghRCxlVJu0dIFCAra/wVGSBJjrNOCnLPrhGmB1GRYwJsMCzjLAv/Opq2K7gAsWO/hm/Msc7bJX4O9TY7wAFQ4MpFfIoDNAAAAAElFTkSuQmCC",iconPNGWhite:"iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAPElEQVR42mNgIAyO3D/yHxkevY+u4D9+PhYFaKZgMwFFDLsCJFNwmQAXp4ICLOFApEMJhCYRAUZqnJAJALGlehnFYWcIAAAAAElFTkSuQmCC",items:e.pages.toArray().map(((e,t)=>({...d.Z.makeNumberMnemonic(M.jk.getDisplayTitle(e),t),handler:()=>c.Z.activateTab(e.id,e.windowId),commandName:"JS_LOCAL_ACTIVATE_TAB",url:e.url,parameter:e.id.toString(),emphasized:e.active})))}})).filter(Boolean)}class ge extends a.Z{getIsInitialized(){return D}getClosedTabContainer(){return he()}getCommandsForShortcuts(){return se("shortcuts",!1)}getCommandsForGestures(){return se("gestures",!0)}getCommands(){return Y}getShortcut(e){const t=$[e];if(t?.shortcuts){const n=d.Z.formatShortcut(e,t.shortcuts);return n?"("+n+")":""}return""}getQuickCommands(e){return this.getCommands().filter((t=>{const n=$[t.name];n?.shortcuts&&(t.shortcuts=n.shortcuts);const i=t.isEnabled(e),s=r.Z.getContext(e),o=t.feature||"browser",a="browser"===o||o===s.feature;let l;return l="function"==typeof t.showInQC?t.showInQC(e):t.showInQC,i&&a&&l}))}getCommandConfiguration(e){return $[e]}getAllCommands(e){const t=m.Z.get(N.kChainedCommandsCommandList).map((e=>{const{shortcuts:t,gestures:n,feature:i}=$[e.name]||{};return{...e,shortcuts:t,gestures:n,feature:i}}));return Y.reduce(((t,n)=>{if(e!==b.Ex&&!n.isEnabled(e))return t;if(n.platforms&&!n.platforms.some((e=>"windows"===e)))return t;const{shortcuts:i,gestures:s,feature:o}=$[n.name]||{};return t.push({...n,shortcuts:i,gestures:s,feature:o}),t}),[]).concat(t)}getVivDefinedCommands(){return this.getUserEditableCommands().filter((e=>"CATEGORY_COMMAND_CHAIN"!==e.category))}getChainCommandsShortcuts(){return this.getUserEditableCommands().filter((e=>"CATEGORY_COMMAND_CHAIN"===e.category)).map((e=>{const t=this.getCommandConfiguration(e.name);return{name:e.name,...t&&{shortcuts:t.shortcuts}}}))}getSettingsList(e){const t=me.getUserEditableCommands(),n=P.Z.getState().map((e=>{const t=(0,E.IN)(e),n=me.getCommandConfiguration(t.name);return{...t,...n&&{shortcuts:n.shortcuts,gestures:n.gestures},feature:"browser"}}));return e?t.filter((e=>!(0,Z.xU)(e.name)&&!(0,_.Ed)(e.name))).concat(n):t.filter((e=>!(0,Z.xU)(e.name)&&!(0,_.jD)(e.name)&&!(0,_.Ed)(e.name))).concat(n)}isShortcutWhitelisted(e,t){if(b.ZP.isSettings(e)){for(const e in $)if(void 0!==$[e]){const n=$[e];if(n.shortcuts&&n.shortcuts.includes(t))return j.includes(e)}return!1}return!0}isActionWhitelistedForSettings(e){return j.includes(e)}isNamedMenuAvailable(e){return x.name===e}getNamedMenu(e,t,n){return this.isNamedMenuAvailable(t)?de(e,x.items,{expandContainers:n,inSettings:!1}):[]}getBookmarkExtrasEdge(){return x.bookmarkExtrasEdge}makeMenuWithContent(e,t,n){const i=[];return t.forEach((e=>{const t=oe(e,!1);t&&i.push(t)})),de(e,i,n)}getMenuItem(e,t,n){let i=t;"container"!==i.type||n||(i={...t,containermode:"folder"});const s=this.makeMenuWithContent(e,[i],{expandContainers:!n,inSettings:n});return 1!==s.length||"separator"!==s[0].type&&void 0===s[0].label?{label:t.action,labelEnglish:t.action}:(le(e,s,!1),s[0])}getHandlerByAction(e,t,n){let o;switch(t){case"JS_LOCAL_ACTIVATE_TAB":{const e=parseInt(n),t=h.Z.getPageById(e);t&&(o=()=>c.Z.activateTab(t.id,t.windowId));break}case"JS_LOCAL_ADD_ACTIVE_TAB_TO_BOOKMARKS":{const t=n,i=h.Z.getActivePage(e);i&&t&&(o=()=>s.Z.bookmarkPageInFolder(i,t));break}case"JS_LOCAL_TOGGLE_WEBPANEL":const a=n;a&&(o=()=>p.Z.toggleContent(e,a));break;case"COMMAND_OPEN_LINK":n&&(o=()=>{const t=i.ZP.getOpenOptionsFromDisposition(e,"setting",!1,{});c.Z.openURL(e,n,{...t})});break;default:void 0!==n&&(o=g.Z.getHandlerByAction(e,t,n))}return o}getUserEditableCommands(){return this.getAllCommands(b.Ex).filter((e=>!H.includes(e.name)))}makeCommandList(e,t){const n=Y.filter((e=>t?t===e.name:!1!==e.inMenu));return void 0===t&&n.push.apply(n,z.filter((e=>!(e=>!!(e.hideInSettings||e.name===U&&x.hasBookmarkContainer))(e))).map((e=>({name:e.name,behavior:"container"})))),this.makeMenuWithContent(e,n.map((e=>{switch(e.behavior){case"checkbox":return{id:e.name,action:e.name,type:"checkbox"};case"radio":return{id:e.name,action:e.name,type:"radio"};case"container":return{id:e.name,action:e.name,containermode:"folder",type:"container"};default:return{id:e.name,action:e.name,type:"command"}}})),{expandContainers:!1,inSettings:!0})}getCommandParameter(e){if(1===Y.filter((t=>t.name===e)).length)return Z.FD[e]}getCommandLabel(e){const t=Y.filter((t=>t.name===e));if(1===t.length)return t[0].label}getOpenLinkName(){return"COMMAND_OPEN_LINK"}dispatchAction(e){switch(e.actionType){case"COMMAND_INITIALIZE":ee(e.items),this.emitChange("init");break;case"COMMAND_RESET":t=e.items,Object.keys($).forEach((e=>{delete $[e]})),ee(t),this.emitChange("init");break;case"COMMAND_SET_NAMED_MENU":ae(e.name,e.content),this.emitChange("menu");break;case"COMMAND_UPDATE_COMMAND":te(e.item),function(e){const t=me.getCommandsForShortcuts();G.map(((e,t)=>({...e,index:t}))).filter((t=>t.name===e.key)).forEach((e=>{l.Z.unbind(e.key,e.func),G.splice(e.index,1)})),e.value.shortcuts?.forEach((e=>{q(t[e],e)}))}(e.item),this.emitChange("shortcut");break;case"COMMAND_REMOVE_COMMAND":ne(e.key),this.emitChange("shortcut");break;case"CONTENT_SCRIPTS_UPDATED":e.updated.forEach((e=>ne(e))),this.emitChange("shortcut")}var t}}const me=new ge(w.Z),ve=me},72010:(e,t,n)=>{"use strict";n.d(t,{s:()=>o,Z:()=>r});var i=n(65398),s=n(84990);const o=-1;class a extends i.Z{_contacts=new Map;_selectedContact=new Map;getAsArray(){return[...this._contacts.values()]}getAsTree(e){const t=e?e.toLowerCase():e;return t?this.getAsArray().filter((e=>this._hasFilter(e,t))):this.getAsArray()}getSelected(e){return this._selectedContact.get(e)}getNodeById(e){return this._contacts.get(e)}getContactsWithAddress(e){const t=this.getAsArray().filter((t=>{if(t.emailAddresses&&t.emailAddresses.length>0)return t.emailAddresses.some((t=>t.emailAddress.toLowerCase()===e.toLowerCase()))}));if(t.length>0)return t[0]}isTrustedEmailAddress(e){for(const t of this.getAsArray())for(const n of t.emailAddresses)if(n.emailAddress.toLowerCase()===e.toLowerCase()&&t.trusted)return!0;return!1}getMailAddresses(){const e=new Map;for(const t of this._contacts.values())t.emailAddresses.forEach((n=>{const i=n.emailAddress.toLowerCase(),s=e.get(i);s?s.add(t.name):e.set(i,new Set([t.name]))}));return e}dispatchAction(e){switch(e.actionType){case"CONTACT_ADD_CONTACT":this._addContact(e.contact);break;case"CONTACT_ADD_CONTACTS":this._addContacts(e.contacts);break;case"CONTACT_DELETE_CONTACTS":this._delete(e.ids);break;case"CONTACT_INITIALIZE":this._initialize(e.windowId,e.contacts,e.newContact);break;case"CONTACT_SELECT_CONTACT":this._select(e.windowId,e.contact,e.focusContactView);break;case"CONTACT_UPDATE_CONTACT":this._update(e.windowId,e.contact)}}_update(e,t){this._contacts.set(t.id,t),this._selectedContact.has(e)&&this._selectedContact.get(e)?.id!==t.id||this._selectedContact.set(e,t),this.emitChange({reason:"updatedContact"})}_initialize(e,t,n){t.forEach((e=>{this._contacts.set(e.id,e)})),n?(this._selectedContact.set(e,n),this.emitChange({reason:"newContact",windowId:e,contact:n,focusContactView:!0})):this.emitChange({reason:"startup"})}_addContact(e){this._contacts.set(e.id,e),this.emitChange({reason:"addContacts"})}_addContacts(e){e.forEach((e=>{this._contacts.set(e.id,e)})),this.emitChange({reason:"addContacts"})}_delete(e){const t=[];e.forEach((e=>{this._contacts.delete(e),this._selectedContact.forEach(((n,i)=>{n.id===e&&t.push(i)}))})),t.forEach((e=>{this._selectedContact.delete(e)})),this.emitChange({reason:"deleteContact"})}_select(e,t,n){this._selectedContact.set(e,t),this.emitChange({reason:"selectedContact",windowId:e,contact:t,focusContactView:n})}_hasFilter(e,t){if(!t||0===t.length)return!0;if(e.name&&e.name.toLowerCase().indexOf(t)>-1)return!0;if(e.emailAddresses){let n=!1;if(e.emailAddresses.forEach((e=>{e.emailAddress.toLowerCase().indexOf(t)>-1&&(n=!0)})),n)return!0}return!1}}const r=new a(s.Z)},27033:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(24602),s=n(84990);class o extends i.Z{getInitialState(){return[]}getScripts(){return this.getState()}reduce(e,t){switch(t.actionType){case"CONTENT_SCRIPTS_UPDATED":case"CONTENT_SCRIPTS_INITIALIZE":return t.scripts}return e}}const a=new o(s.Z)},45502:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(24602),s=n(18172);const o={area:"content",feature:"browser"};class a extends i.Z{getInitialState(){return new Map}isBrowserFeature(e){return"browser"===(e||"browser")}getContext(e){const t=this.getState().get(e);return t?.length?t[t.length-1]:o}reduce(e,t){return"SWITCH_CONTEXT"===t.actionType?(0,s.ZP)(e,(e=>{const n=e.get(t.windowId)||[];let i;n.length>=100?(i=n.slice(1),i.push(t.context)):i=n.concat(t.context),e.set(t.windowId,i)})):e}}const r=new a},1567:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(65398),s=n(84990);class o extends i.Z{_downloadItems=[];_totalNumberOfDownloads=0;_totalProgress=0;_filter="";dispatchAction(e){switch(e.actionType){case"DOWNLOAD_PANEL_UPDATED":return this._downloadItems=e.downloadItems,void this.emitChange({reason:"download_panel_updated"});case"DOWNLOAD_COMPLETED":return void this.emitChange({reason:"download_completed",downloadItem:e.downloadItem});case"DOWNLOAD_STARTED":return void this.emitChange({reason:"download_started",downloadItem:e.downloadItem});case"DOWNLOAD_SET_TOTAL_PROGRESS":return this._totalProgress=e.totalProgress,this._totalNumberOfDownloads=e.totalNumberOfDownloads,void this.emitChange({reason:"download_total_progress_changed"});case"DOWNLOAD_SET_FILTER":return this._filter=e.filter,this._downloadItems=e.downloadItems,void this.emitChange({reason:"download_panel_updated"});case"DOWNLOAD_SET_ORDER_BY":return this._orderBy=e.orderBy,this._downloadItems=e.downloadItems,void this.emitChange({reason:"download_panel_updated"})}}getTotalNumberOfDownloads(){return this._totalNumberOfDownloads}hasDownloads(e){return this.getItems(e).length>0}getTotalProgress(){return this._totalProgress}getFilter(){return this._filter}getOrderBy(){return this._orderBy}getItems(e){return this._downloadItems.filter((t=>!(!e.isIncognitoWindow&&t.incognito))).filter((e=>!("interrupted"===e.state&&""===e.filename)))}}const a=new o(s.Z)},16875:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var i=n(24602),s=n(8575),o=n(18172);const a={rewindHistory:[],rewindIndexes:[],forwardUrl:""};function r(e,t){return s.parse(e).hostname===s.parse(t).hostname}function l(e,t,n,i){e.rewindHistory||(e.rewindHistory=[],e.rewindIndexes=[]);const s=e.prev&&e.prev.url&&r(e.prev.url,t.url);return n!==i.length-1&&(e.prev&&!s&&n<i.length-1?(i.length-1-n>1&&(e.rewindHistory.length>0&&r(e.rewindHistory[e.rewindHistory.length-1].url,e.prev.url)&&e.rewindHistory[e.rewindHistory.length-1].url!==e.prev.url||r(i[i.length-1].url,e.prev.url)&&i[i.length-1].url!==e.prev.url)&&(e.rewindHistory.push(e.prev),e.rewindIndexes.push(i.length-n-2)),e.rewindHistory.push(t),e.rewindIndexes.push(i.length-n-1)):0===n&&i.length>0&&(e.rewindHistory.push(t),e.rewindIndexes.push(i.length-n-1))),e.prev=t,e}function d(e,t){let n=e.get(t);return n||(n={...a},e.set(t,n)),n}class c extends i.Z{getInitialState(){return new Map}getStateById(e){return this.getState().get(e)||a}getFastForwardUrl(e){return this.getStateById(e).forwardUrl}getRewindRelativeIndex(e){const t=this.getState().get(e);if(t){const{rewindIndexes:e}=t;if(e.length>0)return e[0]}return 0}getRewindHistory(e){return this.getStateById(e.id).rewindHistory}getRewindIndexes(e){return this.getStateById(e.id).rewindIndexes}reduce(e,t){switch(t.actionType){case"FAST_FORWARD_SET_FORWARD_URL":return(0,o.Uy)(e,(e=>{const{forwardUrl:n,pageId:i}=t;d(e,i).forwardUrl=n}));case"CHROME_TABS_UPDATED":return(0,o.Uy)(e,(n=>{const{tabId:i,changeInfo:s}=t;if("loading"!==s.status)return e;d(n,i).forwardUrl=""}));case"FAST_FORWARD_SET_REWIND_INFO":return(0,o.Uy)(e,(e=>{const{currentIndex:n,history:i,pageId:s}=t,{rewindHistory:o,rewindIndexes:a}=(r=n,i.slice(0,r+1).reduceRight(l,{}));var r;const c=d(e,s);c.rewindHistory=o,c.rewindIndexes=a}));case"FAST_FORWARD_COPY_STATE":return(0,o.Uy)(e,(e=>{const{fastForwardState:n,pageId:i}=t;e.set(i,n)}));default:return e}}}const h=new c},31186:(e,t,n)=>{"use strict";n.d(t,{Z:()=>O});var i=n(65398),s=n(30381),o=n.n(s),a=n(63353),r=n(93974),l=n(84990),d=n(15672);function c(e){return{text:"",startTime:o()().startOf("day"),endTime:o()().endOf("day"),rangePicker:"today",displayMode:"day",parsedFilter:{title:"",url:"",query:""},dayPickerVisible:!1,moreInfoVisible:!0,monthEntriesVisible:!0,searchURL:!0,searchTitle:!0,range:null,sortOrder:r.Z.DESCENDING_SORT,sortField:"visitTime",...e}}var h=n(35369),p=n(88594),u=n(81277),g=n(15467),m=n(5531),v=n(23542),f=n(19789);function y(e){const{items:t,filterText:n,titleFilter:i,urlFilter:s,shouldSearchUrl:o}=e,a=(s||i||n).toLowerCase().split(" ");return t.map((e=>{const t=e.children.filter((e=>{const t=e.title.toLowerCase(),n=e.url.toLowerCase();return s?a.every((e=>n.includes(e))):i||!o?a.every((e=>t.includes(e))):a.every((e=>n.includes(e)||t.includes(e)))}));return{...e,children:t}}))}var w=n(34155);const b=(0,v.extendMoment)(o()),C="PANEL";let S=null,T=new h.D5,I=new h.D5({today:[],other:[]});const k={};let A=r.Z.DESCENDING_SORT,Z="";class E extends i.Z{getPanelResourceKey(){return C}isPanel(e){return e===C}getHistorySearchResults(e){let t=[];const n=this.getFilter(e);if(n.sortOrder!==A||n.sortField!==Z){const{sortOrder:e,sortField:t}=n;I=I.set("today",this.sortHistory(e,t,I.get("today"))),I=I.set("other",this.sortHistory(e,t,I.get("other"))),A=n.sortOrder,Z=n.sortField}if(t=n.sortOrder===r.Z.DESCENDING_SORT?I.get("today").concat(I.get("other")):I.get("other").concat(I.get("today")),t=t.filter((e=>e.visitTime>=n.startTime.valueOf()&&e.visitTime<=n.endTime.valueOf())),n.parsedFilter.query||n.parsedFilter.title||n.parsedFilter.url){t=y({items:t,filterText:n.parsedFilter.query.toLowerCase(),titleFilter:n.parsedFilter.title.toLowerCase(),urlFilter:n.parsedFilter.url.toLowerCase(),shouldSearchUrl:n.searchURL})}return{items:t,filter:n,oldestHistoryDate:S||b()}}getFilteredHistory(e,t){const n=I.get("today",[]),i=I.get("other",[]),s=y({items:t?n.concat(i.slice(0,10)):n.concat(i),filterText:e,shouldSearchUrl:!0}),o=new Map;for(let e=s.length;e--;){const t=s[e].children;for(let e=t.length;e--;){const n=t[e],i=o.get(n.url);o.set(n.url,{...n,visitCount:i?i.visitCount+n.visitCount:n.visitCount,visitTime:i?Math.max(i.visitTime,n.visitTime):n.visitTime})}}return[...o.values()]}sortHistory(e,t,n){const i=r.Z.getDefaultComparator(e,t);return r.Z.treeSort(n,i),n}getStatistics(e){const t={...I.get("todaysStats",{}),...I.get("olderStats",{})},n=T.get(e,c());return this.getFilteredStatistics(t,n.parsedFilter.query.toLowerCase())}getFilteredStatistics(e,t){const n={};return Object.keys(e).forEach((i=>{const s=e[i].mostVisited.filter((e=>-1!==e.url.indexOf(t)));s.length&&(n[i]={mostVisited:s,timeArr:e[i].timeArr,pages:s.length,visits:s.reduce(((e,t)=>e+t.visitCount),0)})})),n}getFilter(e){let t=T.get(e);if("number"!=typeof e){if(t||(t=c({range:b.range(b().startOf("day"),b().endOf("day"))})),e!==C)return console.error("Unkonwn subscriber id",e),t;{const e=this.getTimeByRange({rangePicker:t.rangePicker});t={...t,endTime:e.endTime?e.endTime:t.endTime,startTime:e.startTime?e.startTime:t.startTime}}}else if(!t){t=c({range:b.range(b().startOf("day"),b().endOf("day"))});let n={...a.Z.getHistoryManagerState(e)};0===Object.getOwnPropertyNames(n).length?(n={...d.Z.getSync("HISTORY_MANAGER_STATE")},n.endTime=b(),"range"===n.displayMode?(n.startTime?n.startTime=b(n.startTime):S?n.startTime=S:b().startOf("month"),n.range=b.range(n.startTime,n.endTime)):(n.startTime=b().startOf(n.displayMode),n.range=b.range(b(n.startTime).startOf(n.displayMode),b(n.endTime).endOf(n.displayMode)))):(n.startTime=n.startTime?b(n.startTime):b(),n.endTime=n.endTime?b(n.endTime):b(),n.range=b.range(b(n.startTime).startOf("day"),b(n.endTime).endOf("day"))),t={...t,...n}}return T=T.set(e,t),t}getTimeByRange(e,t){return isNaN(parseInt(e.rangePicker))?"today"===e.rangePicker?(e.startTime=b().startOf("day"),e.endTime=b().endOf("day")):"yesterday"===e.rangePicker?(e.startTime=b().subtract(1,"day").startOf("day"),e.endTime=b().subtract(1,"day").endOf("day")):"last_month"===e.rangePicker?(e.startTime=b().subtract(1,"month").startOf("month"),e.endTime=b().subtract(1,"month").endOf("month")):"all"===e.rangePicker?(t&&(e.startTime=t.startOf("day")),e.endTime=b().endOf("day")):"date_range"===e.rangePicker||console.warn("Unknown date range",e.rangePicker):(e.startTime=b().subtract(parseInt(e.rangePicker),"day").startOf("day"),e.endTime=b().endOf("day")),e}dispatchAction(e){switch(e.actionType){case"CHROME_TABS_REMOVED":t=e.tabId,T=T.delete(t);break;case"HISTORY_INIT":_("start");break;case"HISTORY_INIT_FILTER":!function(e,t){if(!e.startTime||!e.endTime)return void console.error("Initializing history filter failed. Missing timestamps");const n=x.getTimeByRange({rangePicker:e.rangePicker,startTime:b(e.startTime),endTime:b(e.endTime)}),i=T.get(t,c());T=T.set(t,{...i,...n}),x.emitChange("filterChange",t)}(e.setting,e.id);break;case"HISTORY_LOAD_TODAY":!function(e){const t=I.get("today",[]);if(t.length>0){if(b(t[0].visitTime).endOf("day")<b().startOf("day")){const e=t.concat(I.get("other"));I=I.set("other",e);const n=I.get("todaysStats"),i=I.get("olderStats"),s=Object.assign(n,i);I=I.set("olderStats",s)}}const n=M(e),i=P(n);if(A===r.Z.ASCENDING_SORT){const e=r.Z.getDefaultComparator(A,"visitTime");r.Z.treeSort(i,e)}I=I.set("today",i);const s=D(i),o=N(n,s);I=I.set("todaysStats",o),x.emitChange("searchResultsReady")}(e.items);break;case"HISTORY_LOAD_YESTERDAY_AND_OLDER":!function(e){const t=M(e),n=P(t),i=D(n);I=I.set("other",I.get("other",[]).concat(n)),S=b(I.get("other",[]).reduce(((e,t)=>e<t.id?e:t.id),b().valueOf()));const s=N(t,i);I=I.set("olderStats",{...I.get("olderStats"),...s}),x.emitChange("searchResultsReady")}(e.items);break;case"HISTORY_REMOVE_AFTER":!function(e){if(0===e)I=new h.D5,I=I.set("today",[]),I=I.set("other",[]),I=I.set("todaysStats",{}),I=I.set("olderStats",{}),x.emitChange("searchResultsReady");else{const t=b();let n="today",i="todaysStats";e<t.startOf("d").valueOf()&&(n="other",i="olderStats",I=I.set("today",[])),I=I.set("todaysStats",{});let s=!1;const o=[],a=I.get(n,[]);a.forEach((t=>{const n=t.children.slice().filter((t=>t.visitTime<=e));s=s||n.length!==t.children.length,n.length>0&&(n.length!==t.children.length?o.push({...t,children:n}):o.push(t))})),I=I.set(n,s?o:a);const r=I.get(i,{}),l=new b(e);Object.keys(r).forEach((e=>{b(e).startOf("day")>=l.startOf("day")&&delete r[e]})),I=I.set(i,r),x.emitChange("searchResultsReady")}}(e.since);break;case"HISTORY_REMOVE_VISITS":e.visits.forEach((e=>{e.isFolder?function(e){const t=b(e.at).startOf("day"),n=b(e.at).endOf("day"),i=(0,f.SI)(t);let s="other",o="olderStats";b().isBetween(t,n)&&(s="today",o="todaysStats"),I.get(s,[]).forEach(((e,t)=>{if(e.id===i){const e=I.get(s),n=I.get(o);I=I.set(o,(0,p.Z)(n,i)),e?.splice(t,1),I=I.set(s,e)}}))}(e):void 0===e.url?console.error("Can not remove history element. Url missing"):function(e){const t=b(e.at).startOf("day"),n=b(e.at).endOf("day"),i=(0,f.SI)(t);let s="other",o="olderStats";b().isBetween(t,n)&&(s="today",o="todaysStats");const a=[];I.get(s)?.forEach((t=>{if(t.id===i){const n=I.get(o,{});n[i].mostVisited.forEach(((t,s)=>{t.url===e.url&&n[i].mostVisited.splice(s,1)}));const s=t.children.filter((t=>t.url!==e.url));s.length>0&&(s.length!==t.children.length?a.push({...t,children:s}):a.push(t))}else a.push(t)})),I=I.set(s,a)}(e)})),x.emitChange("searchResultsReady");break;case"HISTORY_SEARCH":!function(e,t){const n=T.get(t);T=T.set(t,e);n?.text!==e.text&&x.emitChange("filterChange",t);w.nextTick((()=>{x.emitChange("searchResultsReady",t)}))}(e.filter,e.id)}var t}}function _(e){if("start"===e)k.id||(k.id=setInterval(_,6e5,"tick"),k.date=b());else if("stop"===e)k.id&&(clearInterval(k.id),k.id=void 0);else if("tick"===e){const e=b();k.date.date()!==e.date()&&(k.date=e,x.emitChange("searchResultsReady"))}}function N(e,t){const n={};return(0,u.Z)(e,((e,i)=>{const s={},o=(0,g.Z)(e,"hour");(0,u.Z)(o,((e,t)=>{const n=(0,m.Z)(e,"url");s[t]={pages:n.length,visits:e.reduce(((e,t)=>e+t.visitCount),0)}}));const a=[];for(let e=0;e<=24;e++)a.push({hour:e,pages:s[e]?s[e].pages:0,visits:s[e]?s[e].visits:0,unixDate:b(i+"T"+(e<10?"0":"")+e).valueOf()});n[e[0].dateKey]={mostVisited:t[e[0].dateKey],timeArr:a}})),n}function M(e){return(0,g.Z)(e,"dateKey")}function P(e){const t=[];return(0,u.Z)(e,((e,n)=>{const i=(0,g.Z)(e,"url"),s=[];(0,u.Z)(i,((e,t)=>{const n=e[0],i=e.reduce(((e,t)=>e.visitTime>t.visitTime?e:t)).visitTime,o=e.reduce(((e,t)=>e+t.visitCount),0);s.push({address:n.address,isBookmarked:n.isBookmarked,protocol:n.protocol,title:n.title,hour:n.hour,transition_type:n.transition_type,url:t,id:n.id+"_"+i,visitCount:o,visitTime:i,dateKey:n.dateKey})})),t.push({children:s,id:e[0].dateKey,pages:Object.keys(i).length,visitCount:s.reduce(((e,t)=>e+t.visitCount),0),visitTime:b(e[0].dateKey).valueOf()})})),t}function D(e){const t={};return e.forEach((e=>{const n=e.children.slice().sort(((e,t)=>e.visitCount-t.visitCount));t[e.id]=n.map((e=>({url:e.url,visitCount:e.visitCount})))})),t}const x=new E(l.Z),O=x},98611:(e,t,n)=>{"use strict";n.d(t,{C:()=>H});var i=n(91834),s=n(61472),o=n(84283),a=n(65398),r=n(9185),l=n(54162),d=n(29087),c=n(84990),h=n(47513),p=n.n(h),u=n(71320),g=n(51501),m=n(95752),v=n(45660),f=n(54773),y=n(18787),w=n(5863),b=n(75995),C=n(51733),S=n(89175),T=n(34155);let I,k,A,Z=[],E=!1,_=[],N=[],M={},P=!1,D=!1,x=[],O=[];function L(e,t){e.forEach((e=>{const{accountId:n,path:i,counter:s}=e;if(M[n]||(M[n]={}),t&&M[n][i]){const e=M[n][i];e.total+=s.total,e.unseen+=s.unseen,e.unread+=s.unread}else M[n][i]=s}))}function R(e){const{addedSles:t,removedSles:n}=e,{sleUpdates:s}=e,a=W.getListEntryComparator(),r=new Set;let l=!1;const d=new Set,c=[],h=[];function u(e){const t=W.createListEntry(e,[]),n=p()(_,t,C.PN);n<0&&_.splice(-n-1,0,t);const i=p()(N,t,a);i<0&&N.splice(-i-1,0,t),function(e){x.length>0&&(x=x.filter((t=>t.id!==e.id||(b(t),v.Z.log("Mail",`Doing postponed index update for ${e.id}`),!1)))),O.length>0&&(O=O.filter((({id:t,newThreadKey:n})=>t!==e.id||(F(new Map([[t,n]])),v.Z.log("Mail",`Doing postponed thread key update for ${e.id}`),!1))))}(e)}function b(e){const t=W.getListEntry(e.id);if(!t)return x.push(e),void v.Z.log("Mail","Entry not found in index. Index update postponed until entry arrives.");const n=new Set([...t.viewIds]),i=new Set([...t.totalViewIds]),{updates:s}=e;void 0!==s.sentDate&&(t.sentDate=s.sentDate),Object.keys(s).includes("queued")&&(void 0===s.queued?delete t.queued:t.queued=s.queued),void 0!==s.attachment&&(t.attachment=s.attachment),void 0!==s.flags&&(t.flags=s.flags),void 0!==s.from&&(t.fromIds=s.from.map(f.Z.add)),void 0!==s.sourceFilterIds&&(t.sourceFilterIds=s.sourceFilterIds),void 0!==s.subject&&(t.subject=s.subject),void 0!==s.to&&(t.toIds=s.to.map(f.Z.add));const r=s.removedViewIds||[],u=s.addedViewIds||[];if(void 0!==s.unseen)if(t.unseen=s.unseen,s.unseen)s.unseen&&v.Z.warn("Mail",["filter","store"],"updateIndex is trying to mark a message unseen",s);else{const e=[...n].filter((e=>e%w.XN===w.ZC));r.push(...e)}if(void 0!==s.sources){let e=!1,i=!1;if(s.sources.forEach(((n,s)=>{if(n){const o=t.sources.get(s);if(o){if(void 0!==n.read&&o.read!==n.read){const t=s*w.XN+w.aD;n.read?r.push(t):u.push(t),e=!0}if(void 0!==n.deleted&&o.deleted!==n.deleted){const e=s*w.XN+w.IK;n.deleted?r.push(e):u.push(e),i=!0}t.sources.set(s,{...o,...n})}else{const{read:e,deleted:i,internal:o}=n;if(void 0===e||void 0===i||void 0===o)throw new Error("Cannot add invalid source "+JSON.stringify(n));t.sources.set(s,{read:e,deleted:i,internal:o})}}else t.sources.delete(s)})),e||i){const s=new Set;n.forEach((e=>{const t=Math.floor(e/w.XN);s.add(t)}));const a=[...s].filter((e=>!t.sources.has(e)));if(a.length>0){if(e){const e=a.map((e=>e*w.XN+w.aD));m.Z.call(t.sources)?r.push(...e):u.push(...e)}if(i){const e=a.map((e=>e*w.XN+w.IK));o.Z.isMessageDeleted(t.sources)?r.push(...e):u.push(...e)}}}}n.forEach((e=>d.add(e)));const y=new Set([...n]);if(r.length>0)for(const e of r)t.viewIds.delete(e),y.delete(e),d.add(e),g.Z.isViewIdOfType(e,w.xE)&&t.totalViewIds.delete(e);if(u.length>0)for(const e of u)t.viewIds.add(e),y.add(e),d.add(e),g.Z.isViewIdOfType(e,w.xE)&&t.totalViewIds.add(e);h.push(n),c.push(y);const b=W.isVisible({...t,viewIds:n,totalViewIds:i}),C=W.isVisible(t);if(b||C){if(!b&&C){const e=p()(Z,t,a);Z.splice(-e-1,0,t)}else if(b){let n=p()(Z,t,a),i=!1;if(n<0&&(n=Z.findIndex((e=>e===t)),i=!0),n>=0)if(C){if(i){Z.splice(n,1);const e=p()(Z,t,a);Z.splice(-e-1,0,t)}}else Z.splice(n,1);else console.warn("Message not found in _listEntries",{sleUpdate:e})}l=!0;let n=p()(N,t,a);if(n<0)if(n=N.findIndex((e=>e===t)),n>=0){N.splice(n,1);const e=p()(N,t,a);N.splice(-e-1,0,t)}else console.warn("Message not found in _sortedIndex",{sleUpdate:e})}}if(n&&n.forEach((e=>{!function(e){const t=p()(_,{id:e},C.PN);if(t>=0){const[n]=_.splice(t,1),i=p()(N,n,a);i>=0&&N.splice(i,1),n.viewIds.forEach((e=>d.add(e))),h.push(n.viewIds);const s=p()(Z,n,a);s>=0&&(Z.splice(s,1),l=!0),r.add(e)}}(e)})),r.size>0&&y.Z.removeEntries(r),t&&t.forEach((e=>{u(e)})),s&&s.forEach((e=>{b(e)})),l&&(Z=Z.slice(),W.emitChange({target:"listEntries",updateSelection:!0})),d.size>0){const e=W.getCounterFolders([...d]);e.length>0&&(h.forEach((t=>{const n=[...t].filter((e=>e%w.XN===w.xE));i.Z.updateCounterFolders(t,n,-1,e)})),c.forEach((t=>{const n=[...t].filter((e=>e%w.XN===w.xE));i.Z.updateCounterFolders(t,n,1,e)})),L(e,!0),W.emitChange({target:"counters"}))}}function B(){const e=Date.now();Z=N.filter((e=>W.isVisible(e))),v.Z.log("Mail",["filter","store"],`initListEntries took ${Date.now()-e}ms.`),P=!1}function F(e){const t=d.Z.get(S.kMailSearchSortField),n=W.getListEntryComparator();let i,s=!1;e.forEach(((e,o)=>{const a=p()(_,{id:o},C.PN);if(a<0)return O.push({id:o,newThreadKey:e}),void v.Z.log("Mail","Entry not found in index. Thread key update postponed until entry arrives.");const r=_[a],d=r.threadKey;if("threads"===t){const t=p()(N,r,n),i=p()(Z,r,n);r.threadKey=e,t>=0&&N.splice(t,1);const o=p()(N,r,n);N.splice(-o-1,0,r);if(W.isVisible(r)){i>=0&&Z.splice(i,1);const e=p()(Z,r,n);Z.splice(-e-1,0,r),s=!0}}else r.threadKey=e;const c=l.Z.getSelectedThreadPrefix();if(c){const e=d.splice(0,2);c.every(((t,n)=>e[n]===t))&&(i=_[a])}})),i&&T.nextTick((()=>i&&r.Z.selectThread(i))),s&&W.emitChange({target:"listEntries"})}function U(){I=void 0,E=!1,B(),W.emitChange({target:"listEntries"})}class V extends a.Z{getByAccountId(e){return u.Z.getByAccountId(e)}getByFolder(e,t=w.ym){if(e)return u.Z.getByFolderId([e,t])}get(e){return u.Z.get(e)}getByIds(e){return u.Z.getByIds(e)}getByFolderId(e){return u.Z.getByFolderId(e)}getSourceFilters(e){const t=p()(_,{id:e},C.PN);if(t>=0){const{sourceFilterIds:e}=_[t];return u.Z.getByIds(e)}return[]}isLoading(){return P}isInitialized(){return D}filterExists(e,t){return!!u.Z.getByFolderId([e,t])}getKnownFlags(){const e=this.getByAccountId(w.ut).map((e=>e.path)),t=Object.keys(w.T4).map((e=>w.T4[e]));return e.concat(t)}isSenderMailingList(e){const t=w.cs+"/"+e,n=w.W4+"/"+e;return void 0!==u.Z.getAll().find((e=>e.accountId===w.wC&&(e.path===t||e.path===n)))}isCounterFolder(e){return e?.accountId!==w.tQ}getCounters(e,t=w.ym){return M[e]&&M[e][t]}isCounterViewId(e,t){const n=e%w.XN,{showRead:i,showMailingLists:s,showFeeds:o,showJunk:a,showCustomFolder:r,showArchived:l}=g.Z.getFilterOptions(t);switch(n){case w.xE:return!!i&&!!s&&!!o;case w.ZC:return!0;case w.aD:return!i;case w.EO:return!s;case w.Fz:return!o;case w.Jq:return!a;case w.js:return!r;case w.pF:return!l;default:return!1}}getCounterFolders(e){const t=new Set;for(const n of e){const e=Math.floor(n/w.XN);if(t.has(e))continue;const i=W.get(e);i&&(W.isCounterFolder(i)&&W.isCounterViewId(n,i)&&t.add(e))}if(0===t.size)return[];const n=new Map;for(const e of t){const t=W.get(e);if(!t)continue;const{id:i,accountId:s,path:o}=t,a=u.Z.getByFolderId([s,w.ym]),r=a?[a]:[];let l=o.substring(0,o.lastIndexOf("/"));for(;l.length>0;){const e=u.Z.getByFolderId([s,l]);e&&r.push(e),l=l.substring(0,l.lastIndexOf("/"))}for(const e of r){const{id:t,filterValue:i}=e;if(i.showSubFolders&&!n.has(t)){const i=W.createCounterFolder(e);n.set(t,i)}}if(!n.has(i)){const e=W.createCounterFolder(t);n.set(i,e)}}return[...n.values()]}createCounterFolder(e){const{accountId:t,path:n}=e;return{accountId:t,path:n,viewIntersections:W.getViewIntersections(e),counter:{total:0,unseen:0,unread:0}}}getViewIntersections(e){const{showDeleted:t,showMailingLists:n,showFeeds:i,showJunk:s,showCustomFolder:o,showSubFolders:a,showArchived:r}=g.Z.getFilterOptions(e),l=[e];if(a){const t=g.Z.getSubFilters(e);l.push(...t)}const d={total:new Map,unseen:new Map,unread:new Map};for(const e of l){const{id:a}=e,l=a*w.XN+w.xE,c=a*w.XN+w.ZC,h=a*w.XN+w.aD,p=n?0:a*w.XN+w.EO,u=t?0:a*w.XN+w.IK,g=i?0:a*w.XN+w.Fz,m=s?0:a*w.XN+w.Jq,v=o?0:a*w.XN+w.js,f=r?0:a*w.XN+w.pF;if(p||u||g||m||v||f){const e=[];p&&e.push(p),u&&e.push(u),g&&e.push(g),m&&e.push(m),v&&e.push(v),f&&e.push(f),d.total.set(l,e),d.unseen.set(l,[c,...e]),d.unread.set(l,[h,...e])}else d.total.set(l,[l]),d.unseen.set(l,[c]),d.unread.set(l,[h])}return d}getIndex(){return _}getListEntry(e){const t=p()(_,{id:e},C.PN);if(t>=0)return _[t]}matchesViewIntersection(e,t,n){for(const i of n||e){if(t.get(i)?.every((t=>e.has(t))))return!0}return!1}getListEntryComparator(){const e=d.Z.get(S.kMailSearchSortField);let t;switch(e){case"sentDate":t=C.rQ;break;case"subject":t=C.Ji;break;case"sender":const e=l.Z.getSelectedFolder(),n=!!e&&[w.Nz,w.kY,w.fZ].includes(s.Z.getFolderType(e.accountId,e.path));t=(0,C.S5)(n,f.Z.get);break;case"threads":t=C.HT}if(!t)throw new Error("Comparator not found for sort field "+e);return"ascending"===d.Z.get(S.kMailSearchSortOrder)?t:(0,C.g4)(t)}isVisible(e){if(E||void 0!==A);else{if(!k)return!1;if(!W.matchesViewIntersection(e.viewIds,k,e.totalViewIds))return!1}return(!A||!A.some(((t,n)=>t!==e.threadKey[n])))&&!(I&&p()(I,e,C.dc)<0)}hasNoListEntries(){return 0===Z.length}createListEntry(e,t){const{id:n,messageId:i,attachment:s,flags:o,replied:a,sentDate:r,subject:l,threadKey:d,unseen:c,queued:h,sourceFilterIds:p,sources:u}=e,g=e.to.map((e=>f.Z.add(e))),m=e.from.map((e=>f.Z.add(e))),v=new Set,y=new Set;for(const e of t)v.add(e),e%w.XN===w.xE&&y.add(e);return{id:n,messageId:i,attachment:s,flags:o,replied:a,sentDate:r,subject:l,threadKey:d,unseen:c,queued:h,viewIds:v,totalViewIds:y,sourceFilterIds:p,sources:u,toIds:g,fromIds:m}}getListEntries(){return Z}getQueryNumFound(){return I?.length}getListEntriesByFolder(e,t){const n=this.getByFolder(e,t);if(!n)throw new Error("Filter not found "+[e,t].join());const i=g.Z.getViewIntersections(n);return _.filter((e=>this.matchesViewIntersection(e.viewIds,i,e.totalViewIds)))}getListEntryIdsByViewIds(e){return _.filter((t=>e.some((e=>t.viewIds.has(e))))).map((e=>e.id))}dispatchAction(e){switch(e.actionType){case"MAIL_INIT_INDEX_FINISHED":!function(){_.sort(C.PN);const e=W.getListEntryComparator();N.sort(e),B(),D=!0,W.emitChange({target:"finishIndexProgress"}),W.emitChange({target:"listEntries",updateSelection:!0})}();break;case"MAIL_INIT_INDEX_BATCH":!function(e,t,n){const s=new Set;for(const e of t)for(const t of e.viewIds)s.add(t);const o=W.getCounterFolders([...s]);for(let n=0;n<e.length;n++){const s=e[n],{searchListId:a,viewIds:r}=t[n];if(s.id>a)throw new Error(`Database inconsistency: extra viewIds entry ${a}.`);if(s.id<a)throw new Error(`Database inconsistency: viewIds entry for SLE ${s.id} not found.`);const l=W.createListEntry(s,r);if(_.push(l),N.push(l),o.length>0){const{viewIds:e,totalViewIds:t}=l;i.Z.updateCounterFolders(e,t,1,o)}}L(o,!0),W.emitChange({target:"updateIndexProgress",indexCount:_.length,total:n})}(e.sleBatch,e.viewIdsBatch,e.total);break;case"MAIL_UPDATE_QUERY_RESULTS":{const{queryResults:t,queryAllMessages:n,folder:i,threadPrefix:s}=e;!function(e,t,n,i){if(A=i,I=e,E=t,n){const e=W.getByFolder(n.accountId,n.path);e&&(k=g.Z.getViewIntersections(e))}B(),W.emitChange({target:"listEntries"})}(t,n,i,s);break}case"MAIL_CLEAR_QUERY":U();break;case"MAIL_INDEX_UPDATE":R(e.updates);break;case"MAIL_SORT_LIST_ENTRIES":!function(e){e&&_.forEach(b.o);const t=W.getListEntryComparator();N.sort(t),B(),W.emitChange({target:"listEntries",updateSelection:!0})}(e.wasThreads);break;case"MAIL_FILTERS_INIT":W.emitChange({target:"filters"});break;case"MAILING_LIST_GROUPS_INIT":case"MAILING_LIST_GROUP_CHANGED":W.emitChange({target:"mailingLists"});break;case"MAIL_FILTERS_CHANGED":{const{filterIds:t}=e;!function(e){const t=l.Z.getSelectedFolder();if(t){const{accountId:n,path:i}=t;if(n!==w.tQ){const t=W.getByFolder(n,i);t&&e.includes(t.id)&&(k=g.Z.getViewIntersections(t),B(),W.emitChange({target:"listEntries",updateSelection:!0}))}}W.emitChange({target:"filters",filterIds:e,updateSelection:!0,updateScrollPosition:!0})}(t);break}case"MAIL_UPDATE_COUNTERS":{const{countedFolders:t,deltaValues:n}=e;L(t,n),W.emitChange({target:"counters"});break}case"MAIL_INIT_MESSAGES":e.folderIntersections?(t=e.folderIntersections,I=void 0,E=!1,A=void 0,k=t,B(),W.emitChange({target:"listEntries",updateSelection:!0})):function(){Z=[],I=void 0,E=!1,k=void 0,A=void 0;const e=d.Z.get(S.kMailAccounts);P=!!e&&e.length>0,W.emitChange({target:"listEntries",isLoading:P})}();break;case"MAIL_UPDATE_THREAD_KEYS":{const{updates:t}=e;F(t);break}case"MAIL_SELECT_THREAD":const{threadPrefix:n}=e;U(),function(e){A=e,B(),W.emitChange({target:"listEntries",updateSelection:!0,updateScrollPosition:!0})}(n);break;case"MAIL_GOTO_UNREAD":W.emitChange({target:"gotoUnread"});break;case"MAIL_GOTO_NEXT_UNREAD":W.emitChange({target:"gotoNextUnread"});break;case"MAIL_GOTO_PREVIOUS_UNREAD":W.emitChange({target:"gotoPreviousUnread"});break;case"MAIL_STOP":Z=[],I=void 0,E=!1,_=[],N=[],M={},P=!1,k=void 0,A=void 0,D=!1,W.emitChange({target:"counters"}),W.emitChange({target:"listEntries"})}var t}}const W=new V(c.Z),H=W},54162:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var i=n(8429),s=n(65398),o=n(84990),a=n(15672),r=n(61472),l=n(26036),d=n(5863),c=n(65741);class h extends s.Z{_selectionHistory=[];_historyIndex=-1;_optionsHistory=[];clear(){this._selectedFolder=void 0,this._selectionHistory=[],this._historyIndex=-1,this._optionsHistory=[],this.emitChange()}getSelectedFolder(){return this._selectedFolder}getSelectionHistory(){return this._selectionHistory}getHistoryIndex(){return this._historyIndex}getOptions(){return this._optionsHistory[this._historyIndex]||{}}changeQuery(e){const t=this._optionsHistory[this._historyIndex];this._optionsHistory[this._historyIndex]={...t,query:e}}getQuery(){return this._optionsHistory[this._historyIndex]?.query||""}clearQuery(){this._optionsHistory[this._historyIndex]&&delete this._optionsHistory[this._historyIndex].query}setOptions(e){this._optionsHistory[this._historyIndex]={...e},this.emitChange()}getSelectedThreadPrefix(){return this.getOptions().threadPrefix}getOptionsFromHistory(e){return this._optionsHistory[e]}getFolderFromHistory(e){return this._selectionHistory[e]}isSenderViewOn(){return!!this.getOptions().forSender}isFolderAnEditMailFolder(){const e=this.getSelectedFolder(),t=e&&r.Z.getFolderType(e.accountId,e.path);return[d.kY,d.fZ,d.Nz].includes(t)}isTrashFolderSelected(){if(!this._selectedFolder)return!1;const{accountId:e,path:t,type:n=""}=this._selectedFolder;return n===d.uT||e===d.of&&t===d.cm}isSentFolderSelected(){if(!this._selectedFolder)return!1;const{accountId:e,path:t,type:n=""}=this._selectedFolder;return n===d.Nz||e===d.of&&t===d.N1}canGoBack(){return this.getSelectionHistory().length>1&&this.getHistoryIndex()>0}canGoForward(){const e=this.getSelectionHistory();return e.length>1&&this.getHistoryIndex()<e.length-1}getGoToMenuItems=(e,t)=>[{handler:()=>i.Z.goToNextUnread(e),..."list"===t?(0,l.Z)("command","Next Unread"):(0,l.Z)("Go to Next Unread")},{handler:()=>i.Z.goToPreviousUnread(e),..."list"===t?(0,l.Z)("command","Previous Unread"):(0,l.Z)("Go to Previous Unread")},{handler:()=>i.Z.markAsReadAndGoToNextUnread(e),...(0,l.Z)("Mark Read and Go to Next Unread")}];dispatchAction(e){switch(e.actionType){case"MAIL_SELECT_FOLDER":this._addToHistory(e.folder,e.options),this.emitChange();break;case"MAIL_FOLDER_SELECT_HISTORY_INDEX":const{historyIndex:t}=e;void 0!==t&&(this._selectFromHistory(t),this.emitChange());break;case"MAIL_SEARCH_SET_OPTIONS":this.setOptions(e.options);break;case"MAIL_STOP":this.clear();break;case"MAIL_QUERY_CHANGE":this.changeQuery(e.query),this.emitChange();break;case"MAIL_CLEAR_QUERY":this.clearQuery()}}_storeSelectedFolder(){a.Z.set({FOLDER_SELECTION:this._selectedFolder},(e=>{e&&console.error("Failed to store selected folder",this._selectedFolder,e)}))}_selectFromHistory(e){e>=0&&e<this._selectionHistory.length&&(this._historyIndex=e,this._selectedFolder=this._selectionHistory[this._historyIndex],this._storeSelectedFolder())}_addToHistory(e,t){if(this._historyIndex>-1){const e=this._historyIndex+1;this._selectionHistory=this._selectionHistory.slice(0,e),this._optionsHistory=this._optionsHistory.slice(0,e)}var n,i;((n=this._selectionHistory[this._selectionHistory.length-1])===(i=e)||n&&i&&n.accountId===i.accountId&&n.path===i.path)&&(0,c.default)(this._optionsHistory[this._optionsHistory.length-1],t)||(this._historyIndex=this._selectionHistory.length,this._selectionHistory.push(e),this._optionsHistory.push(t)),this._selectedFolder=e,this._storeSelectedFolder()}}const p=new h(o.Z)},31118:(e,t,n)=>{"use strict";n.d(t,{Z:()=>m});var i=n(65398),s=n(84990),o=n(35369),a=n(18172),r=n(58848);let l=(0,o.D5)();const d={};let c=new Map;const h={},p={};class u extends i.Z{getNavigationInfo(e){return d[e]}getSSLInfo(e){return c.get(e)}getBlockedPopupsById(e){return h[e]||(0,o.l4)()}getPermissionsById(e){return l.get(e,(0,o.D5)())}getblockedPageContents(e){return p[e]||(0,o.aV)()}emitThrottledChange=(0,r.default)((()=>{this.emitChange()}),250);dispatchAction(e){switch(e.actionType){case"NAVIGATION_SET_STATE":t=e.pageId,n=e.navigationState,d[t]=n,g.emitChange();break;case"PAGE_SET_SSL_STATE":!function(e,t){const n=c;c=(0,a.Uy)(c,(n=>{const i=n.get(e);i?(i.state=t.state,i.issuer=t.issuer):"none"!==t.state&&n.set(e,{state:t.state,issuer:t.issuer})})),n!==c&&g.emitThrottledChange()}(e.pageId,e.info);break;case"NAVIGATION_ADD_POPUP":!function(e,t){let n=h[e]||(0,o.l4)();n=n.add(t),h[e]=n,g.emitThrottledChange()}(e.pageId,e.popupEvent);break;case"NAVIGATION_REMOVE_POPUP":!function(e,t){const n=h[e];n&&(h[e]=n.filter((e=>e.targetUrl!==t)),g.emitThrottledChange())}(e.pageId,e.targetUrl);break;case"NAVIGATION_RESET_BLOCKED_POPUPS":!function(e){h[e]&&(h[e]=(0,o.l4)(),g.emitThrottledChange())}(e.pageId);break;case"NAVIGATION_SET_PERMISSION":!function(e,t,n,i,s){switch(n){case"audiocapture":n="microphone";break;case"videocapture":n="camera"}let a=l.get(e,(0,o.D5)()),r=a.get(t,(0,o.D5)());const d={requestEvent:i,state:s};r=r.set(n,d),a=a.set(t,r),l=l.set(e,a),g.emitChange()}(e.pageId,e.origin,e.permission,e.requestEvent,e.state);break;case"NAVIGATION_RESET_PERMISSIONS":!function(e){l=l.delete(e),g.emitThrottledChange()}(e.pageId);break;case"NAVIGATION_SET_BLOCKED_CONTENT":!function(e,t){let n=p[e]||(0,o.aV)();n=n.push(t),p[e]=n,g.emitThrottledChange()}(e.pageId,e.contentType);break;case"NAVIGATION_RESET_BLOCKED_CONTENT":!function(e){p[e]=(0,o.aV)(),g.emitThrottledChange()}(e.pageId)}var t,n}}const g=new u(s.Z),m=g},62882:(e,t,n)=>{"use strict";n.d(t,{d0:()=>a,mS:()=>r,ZP:()=>C});var i=n(65398),s=n(84990),o=n(89555);const a="vivaldi/x-notes",r=500,l={children:[],content:"",dateAdded:0,id:"1",index:0,parentId:"0",separator:!1,title:"Notes",trash:!1};let d=l,c={id:-1},h=[];class p extends i.Z{_resolveReady=o.default;ready=(()=>new Promise((e=>{this._resolveReady=e})))();getRootNode(){return d}getLastTopNode(){const e=this.getRootNode(),t=e&&e.children?e.children:[];if(t.length>1)return t[t.length-2]}hasNotes(){const e=this.getRootNode();if(e&&e.children){if(e.children.length>1)return!0;const t=e.children[0];if(t&&t.trash)return Boolean(t.children&&t.children.length>0)}return!1}isFolder(e){return Boolean(e.children)}isSeparator(e){return Boolean(e.separator)}isNodeEmpty(e){const t=b.getNodeById(e);return t&&!t.title&&!t.content&&(!t.children||0===t.children.length)}hasChildren(e){return e.children&&e.children.length>0}getNodeById(e){const t=function(n){if(n)for(let i=0;i<n.length;i++){const s=n[i];if(s.id===e)return s;if(s.children){const e=t(s.children);if(e)return e}}};return t(d.children)}getDragData(e,t){const n=t.map((e=>b.getNodeById(e))).filter(Boolean);switch(e){case"text/plain":case"vivaldi/x-title":{const e=[];return n.forEach((t=>{e.push(b.isFolder(t)?t.title:t.content)})),e.join("\r\n")}case"text/html":{const e=n&&1===n.length?n[0]:void 0;return e&&e.url&&e.title?"<a href="+e.url+">"+e.title+"</a>":""}case"text/uri-list":return n.filter((e=>!!e.url)).join("\r\n");default:return""}}getFilteredTree(e,t){const n=function(e,t,i,s,o){if(!e)return;let a=!1;return e.forEach((e=>{let r=!1;if(e.children){const l={...e,children:[]};n(e.children,l.children,i,s,o)&&(t.push(l),a=!0,r=!0)}if(!r&&b._matchNode(e,s,o)){const n={...e};t.push(n),e.children&&i.push(e.id),a=!0}})),a},i=this.getRootNode().children,s=[],o=[];return n(i,s,o,e,t),{nodes:s,collapsed:o}}getFilteredFlat(e,t){const n=(e,t,i,s)=>{e&&e.forEach((e=>{!s.inTrash&&e.trash||(b._matchNode(e,i,s)&&(e.children?t.push({...e,children:[],isExpanded:!1}):t.push({...e})),e.children&&n(e.children,t,i,s))}))},i=this.getRootNode().children,s=[];return n(i,s,e.toLowerCase(),t),s}_matchNode(e,t,n){let i=!1;const s=t.toLowerCase().split(" "),o=e.title?e.title.toLowerCase():"",a=e.content?e.content.toLowerCase():"",r=e.url?e.url.toLowerCase():"";return o.length&&(i=s.every((e=>o.includes(e)))),!i&&a&&!1!==n.content&&(i=s.every((e=>a.includes(e)))),!i&&r&&!1!==n.url&&(i=s.every((e=>r.includes(e)))),i}validateForDrag(e){return e.filter((e=>e!==c.id))}validateForDeletion(e){return e.filter((e=>e!==c.id))}validateForEdit(e){return e!==c.id}getTitle(e){const t=b.getNodeById(e);return t&&(t.title||t.content)||""}getCutIds(){return h}init=e=>{d=e[0]?e[0]:l,c=u(d)||{id:-1},b.emitChange("init",""),this._resolveReady()};dispatchAction(e){switch(e.actionType){case"NOTES_INIT":this.init(e.notes);break;case"NOTES_ADD_ITEM":g(e.item,"added");break;case"NOTES_CHANGE_ITEM":!function(e,t){const n=d.children;if(d!==l&&n){!0===y(d,e,t)&&(d.children=[...n],b.emitChange("changed",e))}}(e.id,e.changes);break;case"NOTES_MOVE_ITEM":!function(e,t,n){if(d!==l&&d.children){const i=b.getNodeById(e);if(void 0!==i){m(e,!0);const s=i.index||0;i.parentId===t&&n>s&&n--,i.parentId=t,i.index=n,g(i,"moved")}}}(e.id,e.targetFolder,e.targetIndex);break;case"NOTES_REMOVE_ITEM":m(e.id,!1);break;case"NOTES_SET_CUT_IDS":h=e.ids,this.emitChange("cutids","")}}}function u(e){if(e.children)for(let t=0;t<e.children.length;t++){const n=e.children[t];if(n.trash)return n;if(n.children){const e=u(n);if(void 0!==e)return e}}}function g(e,t){const n=d.children;if(d!==l&&n){!0===f(d,0,e)&&(d.children=[...n],b.emitChange(t,e.id))}}function m(e,t){const n=d.children;if(d!==l&&n){!0===w(d,e)&&(d.children=[...n],!0!==t&&b.emitChange("removed",e))}}function v(e){if(e.children)for(let t=0;t<e.children.length;t++){e.children[t].index=t}}function f(e,t,n){if(e.id===n.parentId){const i=n||{level:t};return e.children&&e.children.splice(n.index||0,0,i),v(e),!0}if(e.children)for(let i=0;i<e.children.length;i++){const s=e.children[i],o=s.children;if(o){if(!0===f(s,t+1,n))return s.children=[...o],!0}}return!1}function y(e,t,n){if(!e.children)return!1;for(let i=0;i<e.children.length;i++){const s=e.children[i];if(s.id===t&&(void 0!==n.content&&s.content!==n.content||void 0!==n.url&&s.url!==n.url||void 0!==n.title&&s.title!==n.title||n.attachments?.length!==s.attachments?.length)){const t={...e.children[i],...n};return e.children.splice(i,1,t),!0}if(s.children){const e=s.children;if(!0===y(s,t,n))return s.children=[...e],!0}}return!1}function w(e,t){if(!e.children)return!1;for(let n=0;n<e.children.length;n++){const i=e.children[n];if(i.id===t)return e.children.splice(n,1),v(e),!0;if(i.children){const e=i.children;if(!0===w(i,t))return i.children=[...e],0===i.children.length&&(i.isExpanded=!1),!0}}return!1}const b=new p(s.Z),C=b},96682:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(24602);function s(e){return t=>t.id!==e}function o(e,t){return e.when-t.when}class a extends i.Z{getInitialState(){return{notifications:[],activeNotifications:[]}}reduce(e,t){switch(t.actionType){case"NOTIFICATIONS_INIT":return{...e,notifications:t.notifications};case"MAIN_SHOW_CALENDAR_ALARM":return{...e,activeNotifications:e.activeNotifications.filter(s(t.options.notification.id)).concat(t.options.notification).sort(o)};case"MAIN_HIDE_CALENDAR_ALARM":return{...e,activeNotifications:e.activeNotifications.filter(s(t.notificationId))}}return e}}const r=new a},63353:(e,t,n)=>{"use strict";n.d(t,{Z:()=>Ve});var i=n(65398),s=n(7065),o=n(29087),a=n(37330),r=n(19486),l=n(71860),d=n(84990),c=n(15489),h=n(92292),p=n(62830),u=n.n(p),g=n(84847),m=n(5264),v=n.n(m),f=n(4027),y=n(7064),w=n(1407),b=n(35369),C=n(69046),S=n(90808),T=n(42578),I=n(44850),k=n(36436),A=n(721),Z=n(14789),E=n(53576),_=n(87210),N=n(16875),M=n(8074),P=n(31118),D=n(90349);function x(e){const t=e.id;if(!t)return console.warn("Need a tab ID to sync"),Promise.resolve();const n={tabId:t};return new Promise((e=>{h.Z.runtime.sendMessage({getNavigationState:n},(n=>{if(h.Z.runtime.lastError)return console.error(`syncDetachedTabInformation: ${h.Z.runtime.lastError.message??""}`),e();const i=n,{blockedPopups:s,fastForwardState:o,navigationState:a,sslInfo:r,urlbarState:l}=i;_.Z.copyFastForwardState(t,o),M.Z.setNavigationState(t,window.vivaldiWindowId,a),r&&M.Z.setSSLState(t,r),D.Z.copyUrlfieldState(t,l),s.forEach((e=>M.Z.addBlockedPopupEvent(t,e))),e()}))}))}var O=n(80419),L=n(15285);const R=[],{kExtensionURLOverrides:B,kHomepage:F,kTabsActivationOnClose:U,kTabsActivationPreferRelated:V,kTabsClosePinned:W,kTabsNeverCloseLast:H,kTabsNewPageCustomUrl:z,kTabsNewPageLink:G,kTabsNewPlacement:$,kTabsSelectionIncludeActive:K,kTabsStackingMode:j,kTabsStackingNameMap:Y,kTabsStackingOpenInCurrent:X}=(0,o.l)(R);let Q=new b.D5,q=!1,J=(0,b.D5)(),ee=(0,b.D5)(),te=(0,b.D5)();class ne extends i.Z{constructor(e){e.checkRegistered(l.Z),e.checkRegistered(L.ZP),super(e),o.Z.addListener(R,this.emitChange.bind(this))}findPageToActivateAfterClosingPage(e,t){return Ee(e,t)}findRepositionedIndex(e,t,n){return function(e,t,n){const i=o.Z.get($);if(t.pinned)return t.index;const s=t.vivExtData.ext_id;if(function(e){const t=e.vivExtData.ext_id;return Boolean(J.get(t))}(t))return ge(String(s),!1),t.index;const a="number"==typeof t.openerTabId?ae.getPageById(t.openerTabId):null,r=a?(0,C.av)(a):(0,C.av)(t),l=(()=>{if(!n)return t.index;const e=(0,C.av)(n);if(r&&r!==e&&ae.isGroup(e,n.windowId)){return ae.getGroup(e,n.windowId).last().index+1}return n.pinned?0:n.index+1})();switch(i){case"directrightofcurrent":default:return l;case"openintabstackwithrelated":case"rightofcurrent":{if("number"!=typeof t.openerTabId){if(r&&ae.isGroup(r,e.windowId)){return ae.getGroup(r,e.windowId).last().index+1}return t.index}if(ae.getPageById(t.openerTabId)?.pinned)return 0;const n=e=>e.id!==t.openerTabId&&e.openerTabId!==t.openerTabId,i=e.list.skipWhile(n).takeUntil(n).last();return i?i.index+1:t.index}case"alwayslast":{if(r&&o.Z.get(X)&&ae.isGroup(r,e.windowId)){return ae.getGroup(r,e.windowId).last().index+1}const t=e.list.last();return t?t.index+1:l}}}(se(t),e,n)}getPages(e){return se(e).list}findPageInAllWindows(e){let t;const n=n=>{!t&&e(n)&&(t=n)};return Q.forEach((e=>{e.list.forEach(n)})),t}filterPagesInAllWindows(e){const t=[],n=n=>{e(n)&&t.push(n)};return Q.forEach((e=>{e.list.forEach(n)})),(0,b.aV)(t)}getTabs(e,t){const n=se(e);return re(n.list,n.history,t)}getTabsForPages(e,t){const n=e.size;if(0===n)return(0,b.aV)();const i=e.first().windowId;for(let t=1;t<n;++t)if(e.get(t)?.windowId!==i)throw new Error("Getting tabs for pages from different windows is not supported");const s=se(i);return re(e,s.history,t)}getPageById(e){return this.findPageInAllWindows((t=>t.id===e))}getPageInWindow(e,t){return se(e).list.find((e=>e.id===t))}getPageByReloadId(e){return this.findPageInAllWindows((t=>t.vivExtData.ext_id===e))}getPageHistory(e){return se(e).history}unsafeGetActivePage(e){return le(se(e).list)??(0,C.SJ)()}getActivePage(e){return le(se(e).list)}getLastVisited(e){const t=se(e);return t.history[t.history.length-2]}isActivePage(e,t){return this.getActivePage(e)?.id===t}isUnread(e){return e.unread&&!e.discarded}getGroup(e,t){const n=se(t);return e?de(n.list,e):(0,b.aV)()}isDisplayingImage(e){const t=this.getPageById(e);return!!t&&["image/avif","image/jpeg","image/pjpeg","image/jpg","image/webp","image/png","image/gif","image/bmp","image/vnd.microsoft.icon","image/x-icon","image/x-xbitmap","image/x-png"].includes(t.mimeType)}isGroup(e,t){if(!e)return!1;if("off"===o.Z.get(j))return!1;const n=se(t);return!!e&&ce(n.list,e)>1}getGroupHighlightId(e,t){const n=se(t);return he(n.list,n.history,e)}getTiles(e,t){const n=se(t);return pe(n.list,e)}isSelecting(e){return se(e).isSelecting}getSelection(e){return se(e).selection}getSelectedPages(e){const t=se(e),n=t.selection.reduce(((e,n)=>{const i=t.list.find((e=>e.id===n));return i?[...e,i]:e}),[]);return(0,b.aV)(n).sortBy((e=>e.index))}getReloadingPages(){return this.filterPagesInAllWindows((e=>Number(e.vivExtData.interval)>0))}getDiscardablePages(e){const t=se(e);return this._getDiscardablePages(e,t.list)}getNewGroupId(){return u()()}getTitleByGroupId(e,t){return(o.Z.get(Y)||{})[e]||t}getUnreadCount(e){let t=0;return se(e).list.forEach((e=>{this.isUnread(e)&&t++})),t}getHistoryManagerState(e){return this.getPageById(e)?.vivExtData.historyManagerState}canClosePage(e){if(e.pinned&&"on"!==o.Z.get(W))return!1;return!(o.Z.get(H)&&(0,I.Rf)(e.url)&&this.isLastPage(e.windowId))}isLastPage(e){const{list:t}=se(e);return t.size<2}getStepInfo(e,t,n,i){const s=this.getTabs(i,!0),o=(0,C.av)(e);if(o&&!n){const n=s.flatMap(((e,t)=>(0,C.av)(e.page)===o?[t]:[])),i=n.get(0)??0,a=n.get(-1)??0;let r;return r=t?e.index+1>a?a:e.index+1:e.index-1<i?i:e.index-1,{pages:b.aV.of(e),index:r}}{const a=o&&n?this.getGroup(o,i):b.aV.of(e);if(t){const t=o&&n?a.last().index:e.index;if(t===s.last().page.index)return;const r=s.get(t+1),l=r?(0,C.av)(r.page):null;let d;if(l){d=this.getGroup(l,i).last().index}else d=t+1;return{pages:a,index:d}}{const t=o&&n?a.first().index:e.index;if(t===(s.find((e=>!e?.page.pinned))?.page.index||0))return;const r=s.get(t-1)?.page,l=r?(0,C.av)(r):null;let d;if(l){d=this.getGroup(l,i).first().index}else d=t-1;return{pages:a,index:d}}}}isActiveInternal(e){const t=this.getActivePage(e)?.url??"";return I.jk.isInternalUrl(t)}isActiveExternal(e){const t=this.getActivePage(e)?.url??"";return!I.jk.isInternalUrl(t)}getStartpage(e){const t=`${I.jk.internals.startpage}?section=Speed-dials`,n=a.Z.getState().windowStyles.get(e)||r.Z.getFallbackStyle(),i=r.Z.getWindowBackgroundColor(n);return i?t+"&background-color="+i.toString():t}getDefaultStartpage(e){if(c.ZP.isGuestSession(e))return I.jk.internals["guest-intro"];let t=o.Z.get(G);if(t===w.Fp.EXTENSION){const e=o.Z.get(B).newtab?.some((e=>e.active));e||(t=w.Fp.STARTPAGE)}switch(t){case w.Fp.EXTENSION:return w.P1;case w.Fp.BLANKPAGE:return I.jk.internals.blankpage;case w.Fp.HOMEPAGE:const t=o.Z.get(F);return t===w.QG?this.getStartpage(e):t;case w.Fp.CUSTOM:const n=o.Z.get(z);return(0,k.C3)(n)||(0,k.xl)(n)?I.jk.getUrl(n):I.jk.internals.blankpage;case w.Fp.STARTPAGE:default:return this.getStartpage(e)}}canUseForMenu(e,t){const n=se(e).list;return n.size===t.size&&!t.some(((e,t)=>{const i=n.get(t);return e!==i&&(e.title!==i?.title||e.url!==i?.url)}))}isUrlInAnyWindowPromise(e){return new Promise((t=>{h.Z.windows.getAll({populate:!0},(n=>{const i=n&&n.some((t=>t.tabs&&t.tabs.some((t=>t.url&&t.url===e||t.pendingUrl&&t.pendingUrl===e))));t(i)}))}))}useDefaultIcon(e){if(!e.url)return!0;const t=e.url;return!e.favIconUrl&&!(0,I.pM)(t)&&!(0,I.QB)(t)}dispatchAction(e){switch(e.actionType){case"PAGE_CLEAR":Q=(0,b.D5)(),J=(0,b.D5)();break;case"CHROME_TABS_INIT":oe(ie,e.windowId,e.tabs,e.historystack);break;case"CHROME_TABS_CREATE":oe(ye,e.page.windowId,e.page,e.tabActivationHistory,e.deactivatePageId);break;case"NAVIGATION_SET_STATE":oe(fe,e.windowId,e.pageId,e.navigationState);break;case"CHROME_TABS_REMOVED":oe(we,e.removeInfo.windowId,e.tabId);break;case"CHROME_TABS_UPDATED":oe(be,e.windowId,e.tabId,e.changeInfo);break;case"CHROME_TABS_MOVED":oe(Ce,e.windowId,e.tabId,e.index);break;case"CHROME_TABS_ACTIVATED":{const{activeInfo:t}=e;oe(Se,t.windowId,t.tabId);break}case"CHROME_TABS_DETACHED":oe(Te,e.detachInfo.oldWindowId,e.tabId);break;case"CHROME_TABS_ATTACHED":{const{tabId:t,attachInfo:n}=e;!async function(e,t){const n=ee.get(e);if(t.discarded)await Ie(e,!0,t.newPosition);else if(void 0!==n)n!==window.vivaldiWindowId&&await Ie(e,!1,t.newPosition);else{const n=te.get(e)?.groupId||"";te=te.set(e,{windowId:t.newWindowId,index:t.newPosition,groupId:n})}}(t,n);break}case"PAGE_OPEN_URL":oe(_e,e.windowId,e.pageId,e.url,e.postParams,e.headers,e.transition,e.fromUrlField);break;case"PAGE_OPEN":oe(Ae,e.windowId,e.pageId,e.selectGroup);break;case"PAGE_MINIMIZE":oe(Ze,e.windowId);break;case"PAGE_SET_IS_INSPECTED":oe(me,e.windowId,e.pageId,"isInspected",e.inspected);break;case"PAGE_SET_IS_RESTORED":ge(e.extId,e.restored);break;case"PAGE_TABSTACK_CREATE":oe(Pe,e.pages.first().windowId);break;case"PAGE_SET_ORIGIN":oe(me,e.windowId,e.pageId,"originUrl",e.url);break;case"PAGE_SET_TITLE":oe(me,e.windowId,e.pageId,"title",e.title);break;case"PAGE_SET_IMAGE_INSPECTOR":oe(me,e.windowId,e.pageId,"showImageInspector",e.showImageInspector);break;case"READERMODE":oe(me,e.windowId,e.pageId,"supportsReaderMode",e.supportsReaderMode);break;case"VIVALDI_TABS_ATTACHED":t=e.tabId,e.fromWindowId,ee=ee.delete(t);break;case"VIVALDI_TABS_DETACHED":!async function(e,t){if(t===window.vivaldiWindowId){if(void 0===te.get(e))return}const n=te.get(e);void 0!==n&&n.windowId===window.vivaldiWindowId?await Ie(e,!1,n.index,n.groupId):ee=ee.set(e,t)}(e.tabId,e.toWindowId);break;case"VIVALDI_TABS_UPDATED":oe(ke,e.windowId,e.pageId,e.tabInfo);break;case"PAGE_SELECTION_SET":oe(Oe,e.page.windowId,e.page,e.multiSelect,e.addGroup,e.excludeActive);break;case"PAGE_SELECTION_TOGGLE_RELATED":oe(De,e.page.windowId,e.page);break;case"PAGE_SELECTION_EXPAND_PREVIOUS":oe(xe,e.page.windowId,e.page,"previous");break;case"PAGE_SELECTION_EXPAND_NEXT":oe(xe,e.page.windowId,e.page,"next");break;case"PAGE_SELECTION_CLEAR":oe(Pe,e.windowId);break;case"PAGE_CYCLE_BY_HISTORY":oe(Re,e.windowId,e.maybeEvent,e.goBack);break;case"PAGE_CYCLE_BY_ORDER":oe(Fe,e.windowId,e.maybeEvent,e.goBack)}var t}_getDiscardablePages(e,t){return t.filter((t=>!t.discarded&&!t.active&&!t.isInspected&&t.url!==this.getDefaultStartpage(e)))}}function ie(e,t,n=[]){if(!t||0===t.length)return;const i=(0,b.aV)(t.map((e=>(e.favIconUrl||(e.favIconUrl=function(e){if(!e.favIconUrl||e.favIconUrl.startsWith("file://"))return"chrome://favicon/size/16@2x/"+(e.url||"");e.favIconUrl&&I.jk.isExtensionProtocol(e.favIconUrl)&&I.jk.isOurExtension(e.favIconUrl);return e.favIconUrl}(e)),s.ZP.tabToPage(e)))));t.forEach(x),ue(e.windowId),e.list=i,e.history=function(e,t){const n=[];t.forEach((t=>{const i=e.find((e=>e.vivExtData.ext_id===t));i&&n.push(i.id)})),e.forEach((e=>{n.includes(e.id)||n.unshift(e.id)}));const i=e.find((e=>e.active));i&&(0,Z.AL)(n,i.id);return n}(i,n),Pe(e)}function se(e){return Q.get(e)??function(e){return Object.freeze({windowId:e,list:(0,b.aV)(),history:[],minimizeHistory:null,lastHistory:null,isSelecting:!1,selection:(0,b.l4)(),selectionAnchor:null,selectionLead:null,cycleByHistoryArray:null,cycledByHistoryPageId:null,cycleByOrderArray:null,cycledByOrderPageId:null})}(e)}function oe(e,t,n,i,s,o,a,r){if(q)throw new Error("Nested producePages calls are not allowed");if("number"!=typeof t)return void 0;const l=se(t),d={...l};q=!0;try{e(d,n,i,s,o,a,r)}finally{q=!1}(function(e,t){let n=!1;for(const i of Object.keys(t)){const s=t[i];s!==e[i]&&(Array.isArray(s)&&Object.freeze(s),n=!0)}return!!n&&(Object.freeze(t),!0)})(l,d)&&(Q=Q.set(t,d),ae.emitChange())}const ae=new ne(d.Z),re=v()(1)(((e,t,n)=>n?e.map((e=>({type:"tab",id:e.id,page:e}))):e.groupBy((e=>(0,C.av)(e)||e.id)).map(((n,i,s)=>n.count()>=2?{type:"group",id:String(i),pages:n,page:e.find((n=>n.id===he(e,t,`${i}`)))}:{type:"tab",page:n.first(),id:n.first().id})).toList())),le=v()(1)((e=>e.find((e=>e.active))));const de=v()(10)((function(e,t){return t?e.filter((e=>(0,C.av)(e)===t)):(0,b.aV)()})),ce=v()(10)(((e,t)=>e.count((e=>(0,C.av)(e)===t)))),he=v()(10)(((e,t,n)=>{const i=de(e,n);for(let e=t.length-1;e>=0;e--)if(i.some((n=>n.id===t[e])))return t[e];return i.first()?.id}));const pe=v()(10)((function(e,t){return t?e.filter((e=>(0,C.jA)(e)===t)):(0,b.aV)()}));const ue=(0,S.Z)((e=>h.Z.tabs.query({windowId:e},(e=>e.forEach((e=>{const t=ae.getPageById(e.id?e.id:-1);if(t){let n;try{n=JSON.parse(e.vivExtData||"{}")}catch(e){n={}}const i=(0,b.D5)(n);(0,b.is)(i,t.vivExtData)||h.Z.tabs.update(t.id,{vivExtData:JSON.stringify(n)},(()=>{h.Z.runtime.lastError}))}}))))),160);function ge(e,t){J=J.set(e,t)}function me(e,t,n,i){const s=e.list.findIndex((e=>e.id===t));-1!==s&&(e.list=e.list.setIn([s,n],i))}function ve(e,t){me(e,t,"unread",!1);const n=le(e.list);n&&n.id!==t&&me(e,n.id,"active",!1),me(e,t,"active",!0)}function fe(e,t,n){if("stop"!==n.trigger&&"abort"!==n.trigger)return;const i=e.list.findIndex((e=>e.id===t));if(-1===i)return;let s=e.list.get(i);if(!s||!s.target)return;const{target:o}=s;s=s.set("url",o.committedUrl),s=s.set("target",void 0),e.list=e.list.set(i,s)}function ye(e,t,n,i){e.list=e.list.splice(t.index,0,t).map(((e,t)=>(e.id===i&&(e=e.set("active",!1)),e.set("index",t)))),e.history=n,Pe(e)}function we(e,t){e.list=e.list.filter((e=>e.id!==t)).map(((e,t)=>e.set("index",t)));const n=e.history.indexOf(t);if(-1!==n){const t=[...e.history];t.splice(n,1),e.history=t}Pe(e)}function be(e,t,n){e.list=s.ZP.updatePage(e.list,t,n)}function Ce(e,t,n){const i=e.list.find((e=>e.id===t));i&&(Pe(e),function(e,t,n){const i=e.list.findIndex((e=>e.id===t.id));n===i&&t.index===n||(e.list=e.list.delete(i).splice(n,0,t).map(((e,t)=>e.set("index",t))))}(e,i,n))}function Se(e,t){const n=e.list;ve(e,t);const i=e.history[e.history.length-1];if(n!==e.list||i!==t){const n=[...e.history];(0,Z.AL)(n,t),e.history=n,(0,E.y)(e.windowId,e.history),Pe(e)}}function Te(e,t){const n=e.list.find((e=>e.id===t));if(n&&(function(e,t){const n={tabId:e,blockedPopups:P.Z.getBlockedPopupsById(e),fastForwardState:N.Z.getStateById(e),navigationState:P.Z.getNavigationInfo(e),sslInfo:P.Z.getSSLInfo(e),urlbarState:l.Z.getUrlfieldStateFromId(e)};new Promise((e=>{h.Z.runtime.sendMessage({setNavigationState:n},(()=>{e()}))}))}(t,n.url),we(e,t),Pe(e),n.active)){const t=Ee(n,e.windowId);t&&Ae(e,t.id)}}async function Ie(e,t=!1,n=0,i){ee=ee.delete(e),te=te.delete(e);let o=0;te.forEach((e=>{e.index<=n&&o++})),n-=o;const a=await h.Z.tabs.get(e);let r=s.ZP.tabToPage(a);i&&(r=r.setIn(["vivExtData","group"],i),ue(r.windowId)),oe((e=>{e.list=e.list.splice(n,0,r).map(((e,t)=>e.set("index",t))),x(a),Pe(e)}),r.windowId)}function ke(e,t,n){if(n.hasOwnProperty("mimeType")&&me(e,t,"mimeType",n.mimeType),n.hasOwnProperty("showImages")){let i;i=!0===n.loadFromCacheOnly?"cache":!0===n.showImages?"always":"never",me(e,t,"imageLoading",i)}}function Ae(e,t,n=!0){const i=e.list;if(ve(e,t),e.list===i)return;Pe(e,n),h.Z.tabs.update(t,{active:!0},(()=>{h.Z.runtime.lastError}));const s=[...e.history];(0,Z.AL)(s,t),e.history=s,(0,E.y)(e.windowId,e.history)}function Ze(e){let{minimizeHistory:t}=e;t&&(0,b.is)(e.lastHistory,e.history)||(t=e.history),t=(0,Z.JA)(t,!0),e.minimizeHistory=t,Ae(e,t[t.length-1]),e.lastHistory=e.history}function Ee(e,t){const n=o.Z.get(V),i=o.Z.get(U);let s;if(n){const n="left"!==i;if(s=function(e,t,n){let i;if(e.openerTabId){const s=()=>t.takeUntil((t=>t.id===e.id)).filter((t=>t.openerTabId===e.openerTabId)).reverse(),o=()=>t.slice(e.index+1).filter((t=>t.openerTabId===e.openerTabId));i=n?o().first()||s().first():s().first()||o().first(),i||(i=t.find((t=>t.id===e.openerTabId)))}return i||(i=t.skipUntil((t=>t.id===e.id)).skip(1).find((t=>t.openerTabId===e.id))),i}(e,se(t).list,n),s)return s}switch(i){case"left":const n=e.index-1;s=n<0?se(t).list.find((t=>t.id!==e.id)):se(t).list.get(n);break;case"right":s=se(t).list.get(e.index+1),s||(s=se(t).list.reverse().find((t=>t.id!==e.id)));break;case"activation_order":s=void 0;break;default:0,s=void 0}if(!s){const n=se(t),i=n.history.filter((t=>n.list.some((e=>e.id===t))&&t!==e.id)).pop();s=n.list.find((e=>e.id===i))}return s===e&&(s=null),s}function _e(e,t,n,i,s="",o=y.Z.historyPrivate.TransitionType.LINK,a=!1){const r=e.list.findIndex((e=>e.id===t));if(-1===r)return;let l=e.list.get(r);if(!l)return;const d={committedUrl:l.url,postParams:i,headers:s,transition:o,fromUrlField:a};l=l.merge({target:d,url:n,mimeType:"text/html"}),e.list=e.list.set(r,l)}function Ne(e,t,n){if(n&&ae.isGroup((0,C.av)(t),e.windowId)){const n=ae.getGroup((0,C.av)(t),e.windowId).map((e=>e.id));e.selection=e.selection.union(n)}else e.selection=e.selection.add(t.id)}function Me(e,t){const n=e.toList().filter((e=>e!==t.id)).map((e=>{const t=ae.getPageById(e);return t?t.index:-1}));if(!n.isEmpty()){const e=n.insert(0,t.index).toArray();h.Z.tabs.highlight({tabs:e,windowId:window.vivaldiWindowId})}}function Pe(e,t=!0){e.isSelecting=!1;const n=le(e.list);e.selectionAnchor=n??null,e.selectionLead=n??null,0!==e.selection.size&&(e.selection=(0,b.l4)());o.Z.get(K)&&n&&Ne(e,n,t)}function De(e,t){e.isSelecting||Pe(e),e.selectionLead=t;if(ae.isGroup((0,C.av)(t),e.windowId))Ne(e,t,!0);else{const n=ae.getTabs(e.windowId),[,i]=(0,T.d)(t,n);e.selection=i.reduce(((e,t)=>e.add(t.id)),e.selection),e.isSelecting=!0}}function xe(e,t,n,i=!0){const s=e.windowId;if(e.isSelecting){const t=e.selection.map((t=>{const n=e.list.find((e=>e.id===t));return n&&"number"==typeof n.index?n.index:-1})).filter((e=>e>-1)).sort(),s="next"===n,o=s?t.last():t.first(),a=s?o+1:o-1,r=e.selectionLead,l=ae.getActivePage(e.windowId);if(r&&l){const n=e.selection.size>1&&!(l.index<=r.index&&r.index<=a&&s||l.index>=r.index&&r.index>=a&&!s);if(!n&&(a<0||a>e.list.size))return;if(n){const n=e.list.get(s?t.first():t.last());n&&Oe(e,n,!1,i)}else{const t=e.list.get(a);t&&Oe(e,t,!1,i)}}}else{const a=ae.isGroup((0,C.av)(t),s);if(a&&o.Z.get(K))Oe(e,t,!1,i);else if(a){const o=ae.getGroup((0,C.av)(t),s).map((e=>e.id)),a="next"===n?o.last()+1:o.first()-1,r=e.list.find((e=>e.id===a));r&&Oe(e,r,!1,i)}else{const s="next"===n?t.index+1:t.index-1;if(s>=0&&s<e.list.size){const t=e.list.get(s);t&&Oe(e,t,!1,i)}}}}function Oe(e,t,n,i,s=!1){e.isSelecting||(s?(e.selectionAnchor=ae.unsafeGetActivePage(e.windowId),e.selectionLead=e.selectionAnchor,e.selection=(0,b.l4)()):Pe(e,i)),n?function(e,t,n){const i=e.selectionAnchor,s=e.selectionLead;if(!i||!s)return;const a=s.index,r=i.index,l=e.windowId,d=e.list.filter((e=>e.index>=Math.min(r,a)&&e.index<=Math.max(r,a))).flatMap((e=>{const t=(0,C.av)(e);return ae.isGroup(t,l)?ae.getGroup(t,l):[e]})).map((e=>e.id)),c=t.index,h=!o.Z.get(K),p=e.list.filter((e=>e.index>=Math.min(r,c)&&e.index<=Math.max(r,c)&&!(h&&e.active))).flatMap((e=>{const t=(0,C.av)(e);return n&&ae.isGroup(t,l)?ae.getGroup(t,l):[e]})).map((e=>e.id)),u=e.selection.subtract(d).union(p);e.selection=u,e.selectionLead=t,Me(e.selection,ae.unsafeGetActivePage(l)),e.isSelecting=!0}(e,t,i):function(e,t,n){e.selectionLead=t,e.isSelecting||(e.selectionAnchor=t);!e.isSelecting&&t.active||!e.selection.contains(t.id)?Ne(e,t,n):function(e,t,n){if(n&&ae.isGroup((0,C.av)(t),e.windowId)){const n=ae.getGroup((0,C.av)(t),e.windowId).map((e=>e.id));e.selection=e.selection.subtract(n)}else e.selection=e.selection.remove(t.id)}(e,t,n);Me(e.selection,ae.unsafeGetActivePage(e.windowId)),e.isSelecting=!0}(e,t,i)}function Le(e,t){if(e===t)return t;const n=new Set(e),i=new Set;for(let e=0;e<t.length;++e)n.has(t[e])&&i.add(t[e]);if(i.size===n.size&&i.size===t.length)return t;for(const t of e)i.add(t);return Array.from(i)}function Re(e,t,n){const{windowId:i}=e,s=h.Z.extension.getViews({windowId:i})[0],o=t instanceof s.WheelEvent&&t.buttons===f.Z.kRight;if((0,g.Z)(t)||o){let a=e.cycleByHistoryArray;a?a=Le(e.history,a):(a=e.history,e.cycledByHistoryPageId=a[a.length-1]),a=(0,Z.JA)(a,!1===n),e.cycleByHistoryArray=a,Ae(e,a[a.length-1]);const r=()=>{oe(Be,i)};o&&t instanceof s.WheelEvent?(0,O.g)(t,r,s.document):(0,A.Kz)(t,r)}else e.history=(0,Z.JA)(e.history,!1===n),(0,E.y)(i,e.history),Ae(e,e.history[e.history.length-1])}function Be(e){const t=e.cycleByHistoryArray,n=e.cycledByHistoryPageId,i=t&&t[t.length-1];if(n&&i){const t=e.history.filter((e=>e!==n&&e!==i));t.push(n),n!==i&&t.push(i),e.history=t,(0,E.y)(e.windowId,e.history)}e.cycleByHistoryArray=null,e.cycledByHistoryPageId=null}function Fe(e,t,n){const{windowId:i}=e,s=e.list,o=s.findIndex((e=>e.active));e.cycleByOrderArray?e.cycleByOrderArray=Le(e.history,e.cycleByOrderArray):(e.cycleByOrderArray=e.history,e.cycledByOrderPageId=s.get(o)?.id??-1);const a=((o+(n?-1:1))%s.size+s.size)%s.size,r=s.get(a)?.id??-1;r&&Ae(e,r),(0,A.Kz)(t,(()=>{q||oe(Ue,i,a)}))}function Ue(e,t){let n=e.cycleByOrderArray;const i=e.cycledByOrderPageId,s=e.list.get(t)?.id;if(n&&i&&s){n=Le(e.history,n);const t=n.filter((e=>e!==i&&e!==s));t.push(i),t.push(s),e.history=t,(0,E.y)(e.windowId,e.history)}e.cycleByOrderArray=null,e.cycledByOrderPageId=null}const Ve=ae},15285:(e,t,n)=>{"use strict";n.d(t,{Ej:()=>p,Pv:()=>u,fG:()=>g,dr:()=>m,ZP:()=>R});var i=n(65398),s=n(63353),o=n(68247),a=n(29087),r=n(84990),l=n(15489),d=n(34540),c=n(90808),h=n(89175);const p=260,u=35,g=10,m=-1,v=["downloads","tabs"],f=["chat"],y=new Map;let w=[],b=[];const C=new Map,S=(0,c.Z)(d.Z,500);let T,I;function k(e,t){if(l.ZP.isGuestSession(e))return t.filter((e=>"format"!==e.id)).filter((e=>v.includes(e.id)));return t.filter((e=>"format"!==e.id)).filter((e=>!f.includes(e.id)))}function A(e){y.forEach((t=>{t.winId===e&&(o.Z.set(h.kPanelsState,{barVisible:t.barVisible,panelVisible:t.contentVisible,selectedPanel:t.selectedPanel,width:t.expandedWidth}),S(t.winId,{SHOW_PANEL:t.barVisible,SELECTED_PANEL:t.selectedPanel,PANEL_WIDTH:t.expandedWidth,SHOW_PANEL_CONTENT:t.contentVisible}))}))}function Z(e,t){const{setFocus:n,selectId:i,panel:s}=t,o=y.get(e);if(!o)return;if(o.contentVisible&&o.selectedPanel===s){if(o.transitionMap.get(s)?.selectId===i)return}if(!L.canRender(e,s))return;const a=o.transitionMap;a.set(s,{setFocus:n,selectId:i,reason:t.reason}),y.set(e,{...o,barVisible:!0,contentVisible:!0,expandedWidth:0===o.expandedWidth?290:o.expandedWidth,focusContent:n,selectedPanel:s,transitionMap:a}),A(e),L.emitChange(e,"display")}function E(e,t){if(!L.canRender(e,t))return;const n=y.get(e);if(!n)return;const i=!n.contentVisible;t===n.selectedPanel?(i||n.lastFocused&&n.lastFocused.focus(),y.set(n.winId,{...n,barVisible:!0,contentVisible:i,focusContent:i,lastFocused:i?document.activeElement:null})):y.set(n.winId,{...n,barVisible:!0,contentVisible:!0,selectedPanel:t,lastFocused:i?document.activeElement:null,focusContent:i}),y.get(n.winId)?.contentVisible||(I=y.get(n.winId)?.barVisible??!1),A(e)}function _(e,t){const n=y.get(e);n&&(n.contentVisible?(n.lastFocused&&n.lastFocused.focus(),y.set(n.winId,{...n,barVisible:!1,contentVisible:!1,lastFocused:null,expandedWidth:0===n.expandedWidth?290:n.expandedWidth})):n.barVisible?y.set(n.winId,{...n,barVisible:!1,selectedPanel:void 0}):(y.set(n.winId,{...n,barVisible:!0}),n.selectedPanel&&E(n.winId,n.selectedPanel)),t&&A(e),y.get(n.winId)?.contentVisible||(I=y.get(n.winId)?.barVisible??!1),L.emitChange(e,""))}function N(e,t,n){const i=l.ZP.getWindowState(e);if(!i)return;const s=y.get(e);if(!s)return;const o=(0,l.TF)(i),a=(0,l.TF)({...i,...t});if(o&&!a)L.getIsBarVisible(e)!==s.visibilityBeforeMinimalUI&&_(e,n);else if(!o&&a){const t=L.getIsBarVisible(e);y.set(s.winId,{...s,visibilityBeforeMinimalUI:t}),t&&_(e,n)}}function M(e,t){const n=y.get(e);n&&(t?y.set(n.winId,{...n,barVisible:!0,contentVisible:!0,selectedPanel:n.selectedPanel||L.getDefaultPanel()}):(y.set(n.winId,{...n,contentVisible:!1}),I=n.barVisible),A(e))}function P(e){const t=y.get(e);t&&(t.contentVisible?L.emitChange(e,"setFocus"):(y.set(t.winId,{...t,focusContent:!0}),M(e,!0),L.emitChange(e,"")))}function D(e,t,n){const i=t?.isMailPage,s=n?.isMailPage,o=L.getSelectedPanel(e);!i&&s&&"feeds"!==o&&"contacts"!==o?function(e){const t=y.get(e);T={selectedPanel:t?.selectedPanel??"mail",barVisible:t?.barVisible??!1,contentVisible:t?.contentVisible??!1},Z(e,{setFocus:!1,panel:"mail",selectId:"",reason:""}),L.emitChange(e,"")}(e):function(e,t,n){return n&&!t&&"mail"===L.getSelectedPanel(e)&&L.getIsVisible(e,"mail")&&L.getIsBarVisible(e)}(e,s,i)&&function(e){const t=L.getPreviousPanel();t&&(t.selectedPanel&&Z(e,{setFocus:!1,panel:t.selectedPanel,selectId:"",reason:""}),M(e,t.contentVisible),t.barVisible||_(e,!0),L.emitChange(e,""))}(e)}function x(e){const t=L.getIsContentVisible(e)||!L.getIsContentVisible(e)&&a.Z.get(h.kMailOpenPanelAutomaticallyViewingMail),n=a.Z.get(h.kPanelsAsOverlayEnabled)&&(!a.Z.get(h.kPanelsAsOverlayAutoClose)||!1===L.getSeparateFloating("mail"));return a.Z.get(h.kMailDisplayMailPanelViewingMail)&&(n&&t||!a.Z.get(h.kPanelsAsOverlayEnabled)&&t)}class O extends i.Z{clear(){y.clear()}getRegPanelOrder(e){const t=y.get(e);return t?t.regPanelOrder:[]}getWebPanelOrder(e){const t=y.get(e);return t&&!l.ZP.isGuestSession(e)?t.webPanelOrder:[]}getNextPanel(e,t){const n=y.get(e);if(n){if(n.selectedPanel){const i=b.map((e=>e.id)).filter((t=>L.getPanelAvailable(t)&&L.canRender(e,t)));if(w.filter((e=>e.available)).forEach((e=>i.push(e.id))),i.length<2)return;let s=i.indexOf(n.selectedPanel);if(-1===s)return;return s+="next"===t?1:-1,s=(s+i.length)%i.length,i[s]}return L.getFirstAvailablePanel(e)}}canRender(e,t){if(!t)return!1;if(l.ZP.isGuestSession(e))return v.includes(t);if(this.getIsWebPanel(t))return!0;return!!y.get(e)&&(["mail","contacts","feeds"].includes(t)?l.ZP.isMail(e)&&!a.Z.get(h.kMailIsTurnedOff):"calendar"===t?!a.Z.get(h.kMailIsTurnedOff):!f.includes(t))}isAvailable(e){const t=b.find((t=>t.id===e));return void 0!==t&&t.available}canAutoOpen(e,t){return!(t===this.getSelectedPanel(e)&&this.getWidth(e)>50)}getSeparateFloating(e){const t=[...w,...b].find((t=>t.id===e));return void 0!==t?.floating?t.floating:void 0}getResizableByPanel(e){for(let t=0;t<b.length;t++)if(b[t].id===e)return b[t].resizable;for(let t=0;t<w.length;t++)if(w[t].id===e)return w[t].resizable;return!1}getWidthByPanel(e){for(let t=0;t<b.length;t++)if(b[t].id===e)return b[t].width;for(let t=0;t<w.length;t++)if(w[t].id===e)return w[t].width;return-1}isWebPanelEnabled(e,t){const n=L.getWebPanels(e),i=n[t-1],s=L.getPanelAvailable(i?.id);return n.length>=t&&s}getPanelAvailable(e){for(let t=0;t<b.length;t++)if(b[t].id===e)return!1!==b[t].available;for(let t=0;t<w.length;t++)if(w[t].id===e)return!1!==w[t].available;return!1}getAvailablePanelCount(){let e=0;for(let t=0;t<b.length;t++)!1!==b[t].available&&e++;for(let t=0;t<w.length;t++)!1!==w[t].available&&e++;return e}getFirstAvailablePanel(e){if(y.get(e)){for(let t=0;t<b.length;t++)if(!1!==b[t].available){if(!0===b[t].forMailOnly&&!l.ZP.isMail(e))continue;return b[t].id}for(let e=0;e<w.length;e++)if(!1!==w[e].available)return w[e].id}}getLastAvailablePanel(e){if(y.get(e)){for(let e=w.length-1;e>=0;e--)if(!1!==w[e].available)return w[e].id;for(let t=b.length-1;t>=0;t--)if(!1!==b[t].available){if(!0===b[t].forMailOnly&&!l.ZP.isMail(e))continue;return b[t].id}}}getRegPanels(){return b}getWebPanels(e){return l.ZP.isGuestSession(e)?[]:w}getIsWebPanel(e){return C.has(e)}getIsBarVisible(e){return Boolean(y.get(e)?.barVisible)}getIsContentVisible(e){return Boolean(y.get(e)?.contentVisible)}getSelectedPanel(e){return y.get(e)?.selectedPanel}getIsVisible(e,t){return Boolean(y.get(e)?.contentVisible)&&y.get(e)?.selectedPanel===t}getSelectedWebPanelIndex(e){const t=y.get(e)?.selectedPanel;return t&&this.getIsWebPanel(t)?w.findIndex((e=>e.id===t)):-1}getFocusContent(e){return Boolean(y.get(e)?.focusContent)}getTransitionState(e,t){return y.get(e)?.transitionMap.get(t)}getWidth(e){const t=y.get(e);if(!t)return u+g;const n=l.ZP.getVisibleUI(e).panelToggle;if(!n||t.barVisible||t.contentVisible){if(n&&t.barVisible&&!t.contentVisible)return u+g;if(t.barVisible&&!t.contentVisible)return u;if(t.barVisible&&t.contentVisible){let e=t.expandedWidth;if(!0===this.getResizableByPanel(t.selectedPanel)){const n=this.getWidthByPanel(t.selectedPanel);n>0&&(e=n)}return e<=0?p:e}return 0}return g}getDefaultPanel(){return"bookmarks"}getPreviousPanel(){return T}dispatchAction(e){switch(e.actionType){case"PANEL_INIT_COMMON":n=e.state,b=n.regPanels.map((e=>({...e}))),w=n.webPanels.map((e=>({...e}))),w.forEach((e=>{C.set(e.id,!0)}));break;case"PANEL_INIT_WINDOW":!function(e){const t={winId:e.winId,selectedPanel:e.selectedPanel,barVisible:e.showBar,contentVisible:e.showContent,expandedWidth:e.width>=290?e.width:0,transitionMap:new Map,focusContent:e.showContent,lastFocused:null,visibilityBeforeMinimalUI:!1,regPanelOrder:k(e.winId,b).map((e=>e.id)),webPanelOrder:w.map((e=>e.id))};if(y.set(e.winId,t),I=e.showBar,t.selectedPanel&&!L.canRender(t.winId,t.selectedPanel)){const e=L.getFirstAvailablePanel(t.winId);e?y.set(t.winId,{...t,selectedPanel:e}):y.set(t.winId,{...t,selectedPanel:void 0,contentVisible:!1})}}(e.state),this.emitChange(e.state.winId,"");break;case"PANEL_SET_AVAILABLE":!function(e,t){if(L.getIsWebPanel(e)){const n=w.find((t=>t.id===e));n&&n.available!==t&&(n.available=t,o.Z.set(h.kPanelsWebItems,w),L.emitChange(m,""))}else{const n=b.find((t=>t.id===e));n&&n.available!==t&&(n.available=t,o.Z.set(h.kPanelsList,b),L.emitChange(m,""))}}(e.panel,e.available);break;case"PANEL_SET_CONTENT_VISIBLE":M(e.winId,e.visible),this.emitChange(e.winId,"");break;case"PANEL_SET_FOCUS":P(e.winId);break;case"PANEL_TOGGLE_CURRENT":!function(e){const t=y.get(e);if(!t)return;const n=t.selectedPanel||L.getFirstAvailablePanel(e);n&&(E(e,n),L.emitChange(e,""))}(e.winId);break;case"PANEL_TOGGLE_FLOATING":o.Z.toggle(h.kPanelsAsOverlayEnabled,!0,!1);break;case"PANEL_SET_RESIZABLE":!function(e,t){if(L.getIsWebPanel(e)){const n=w.find((t=>t.id===e));n&&n.resizable!==t&&(n.resizable=t,n.resizable||(n.width=-1),o.Z.set(h.kPanelsWebItems,w),L.emitChange(m,""))}else{const n=b.find((t=>t.id===e));n&&n.resizable!==t&&(n.resizable=t,n.resizable||(n.width=-1),o.Z.set(h.kPanelsList,b),L.emitChange(m,""))}}(e.panel,e.resizable);break;case"PANEL_SET_PANELS":e.key===h.kPanelsList?(t=e.value,b=t.map((e=>({...e}))),y.forEach((e=>{const t=k(e.winId,b).map((e=>e.id));if(y.set(e.winId,{...e,regPanelOrder:t}),e.selectedPanel){const t=e.selectedPanel;L.getPanelAvailable(t)&&L.canRender(e.winId,t)||(y.set(e.winId,{...e,selectedPanel:void 0}),M(e.winId,!1))}}))):e.key===h.kPanelsWebItems&&function(e){const t=function(e){return e.selectedPanel&&L.getIsWebPanel(e.selectedPanel)?w.findIndex((t=>t.id===e.selectedPanel)):-1},n=new Map;y.forEach((e=>{n.set(e.winId,t(e))}));const i=w;w=e.map((e=>({...e}))),w.forEach((e=>{C.set(e.id,!0)}));const s=w.map((e=>e.id));y.forEach((e=>{y.set(e.winId,{...e,webPanelOrder:s});let o=n.get(e.winId);if(void 0===o&&(o=-1),w.length>i.length){if(l.ZP.isActive(e.winId)){let t=w.length-1;for(let e=0;e<i.length;e++)if(i[e].id!==w[e].id){t=e;break}E(e.winId,w[t].id)}}else if(w.length<i.length&&-1!==o){let n;if(L.getAvailablePanelCount()>0){const i=t(e);n=-1===i?o>=w.length?0===w.length?L.getLastAvailablePanel(e.winId):w[w.length-1].id:w[o].id:w[i].id}n?n!==e.selectedPanel&&(e.contentVisible?E(e.winId,n):y.set(e.winId,{...e,selectedPanel:n})):(y.set(e.winId,{...e,selectedPanel:void 0}),M(e.winId,!1))}}))}(e.value),this.emitChange(m,"");break;case"PANEL_SET_WIDTH":!function(e,t,n){const i=y.get(e);if(i){if(L.getIsWebPanel(t)){const e=w.find((e=>e.id===t));e&&e.width!==n&&(e.width=n,o.Z.set(h.kPanelsWebItems,w))}else{const e=b.find((e=>e.id===t));e&&e.width!==n&&(e.width=n,o.Z.set(h.kPanelsList,b))}!0!==L.getResizableByPanel(t)&&y.set(i.winId,{...i,expandedWidth:n}),A(e)}}(e.winId,e.panel,e.width),this.emitChange(e.winId,"");break;case"PANEL_REMOVE_FOCUS":!function(e){const t=y.get(e);t&&(y.set(t.winId,{...t,focusContent:!1}),L.emitChange(e,""))}(e.winId);break;case"PANEL_SHOW_NEXT":!function(e,t){const n=L.getNextPanel(e,t),i=y.get(e);i&&(i.contentVisible?n&&(E(e,n),L.emitChange(e,"")):P(e))}(e.winId,e.direction);break;case"PANEL_SHOW_CONTENT":Z(e.winId,e);break;case"PANEL_TOGGLE_CONTENT":E(e.winId,e.panel),this.emitChange(e.winId,"");break;case"PANEL_MOVE":!function(e,t,n,i){const s=y.get(e);if(s)if(L.getIsWebPanel(t)){if(L.getIsWebPanel(n)){const e=s.webPanelOrder.findIndex((e=>e===t));let a=s.webPanelOrder.findIndex((e=>e===n));"below"===i&&a++,a>e&&a--;const r=[...s.webPanelOrder];r.splice(a,0,r.splice(e,1)[0]),y.set(s.winId,{...s,webPanelOrder:r});const l=[];r.forEach((e=>{const t=w.filter((t=>t.id===e))[0];l.push(t)})),w=l,o.Z.set(h.kPanelsWebItems,l)}}else if(!L.getIsWebPanel(n)){const e=s.regPanelOrder.findIndex((e=>e===t));let a=s.regPanelOrder.findIndex((e=>e===n));"below"===i&&a++,a>e&&a--;const r=[...s.regPanelOrder];r.splice(a,0,r.splice(e,1)[0]),y.set(s.winId,{...s,regPanelOrder:r});const l=[];l.push(b[0]),r.forEach((e=>{const t=b.filter((t=>t.id===e))[0];l.push(t)})),b=l,o.Z.set(h.kPanelsList,l)}}(e.winId,e.from,e.to,e.position),this.emitChange(e.winId,"");break;case"PANEL_CLEAR_TRANSITION_STATE":!function(e,t){const n=y.get(e);n&&n.transitionMap.has(t)&&(n.transitionMap.delete(t),y.set(e,{...n}),L.emitChange(e,""))}(e.winId,e.panel);break;case"PANEL_TOGGLE_PANEL":_(e.winId,!0);break;case"WINDOW_STATE_CHANGED":{const{state:t,windowId:n}=e,i=l.ZP.getWindowState(n)?.state;if("fullscreen"===i||"fullscreen"===t){N(n,{state:t},a.Z.get(h.kStartupRememberFullScreen))}break}case"WINDOW_MINIMAL_UI":{const{minimalUI:t,windowId:n}=e;N(n,{minimalUI:t},!0);break}case"CHROME_TABS_ACTIVATED":{const t=e.activeInfo.windowId,n=s.Z.getActivePage(t),i=s.Z.getPageById(e.activeInfo.tabId);if(!i||!n)break;n.id!==i.id&&x(t)&&D(t,n,i);break}case"CHROME_TABS_CREATE":case"PAGE_OPEN":{const t=e.windowId;let n,i;"PAGE_OPEN"===e.actionType?(n=s.Z.getActivePage(t),i=s.Z.getPageById(e.pageId)):"CHROME_TABS_CREATE"===e.actionType&&(n=s.Z.getPageById(e.deactivatePageId??0),i=e.page),t&&x(t)&&n&&i&&D(t,n,i);break}case"PANEL_CLOSE":I?(E(e.winId,e.panel),this.emitChange(e.winId,"")):_(e.winId,!0)}var t,n}}const L=new O(r.Z),R=L},32921:(e,t,n)=>{"use strict";n.d(t,{m:()=>v,Z:()=>y});var i=n(65398),s=n(14481),o=n(84990),a=n(18172);let r,l=new Map;class d extends i.Z{getAlarmFromReloadId(e){return l.get(e)}existingAlarms(){return Boolean(l.size)}getPanelAlarms(e){return e.map((e=>this.getAlarmFromReloadId(e))).filter(Boolean)}dispatchAction(e){switch(e.actionType){case"PERIODIC_RELOAD_ALL":c(e.alarms);break;case"PERIODIC_RELOAD_CREATE":h(e.alarm);break;case"PAGE_CLOSE":e.pages.forEach((e=>{const t=e.vivExtData.ext_id;t&&p(t)}));break;case"PERIODIC_RELOAD_DESTROY":p(e.alarmId);break;case"PERIODIC_RELOAD_UPDATE":l=(0,a.Uy)(l,(t=>{t.set(e.alarm.alarmId,e.alarm.alarm)}));break;case"PERIODIC_RELOAD_DESTROY_ALL":u()}}}const c=e=>{l=(0,a.Uy)(l,(t=>{e.forEach(((e,n)=>{t.set(n,e)}))})),!r&&l.size&&(g(),m())},h=e=>{l=(0,a.Uy)(l,(t=>{t.set(e.alarmId,e.alarm)})),r||(g(),m())},p=e=>{l=(0,a.Uy)(l,(t=>{t.delete(e)}))},u=()=>{l=(0,a.Uy)(l,(e=>{e.clear()}))},g=()=>{const e=Date.now(),t=[];l.forEach(((n,i)=>{const{scheduledTime:o,periodInMinutes:a,id:r,from:l}=n,d=(o-e)/6e4/a;if(d<=0){const e={id:r,scheduledTime:v({periodInMinutes:a,scheduledTime:o}),periodInMinutes:a,from:l};t.push({type:"RELOAD",id:i}),s.Z.updateRunningAlarm(i,e)}else t.push({type:"TIME_CHANGED",remainingTime:d,id:i,from:l})})),f.emitChange(t)},m=()=>r=setInterval((()=>{if(0===l.size)return clearInterval(r),r=void 0,void f.emitChange([]);g()}),1e3),v=e=>{const{scheduledTime:t,periodInMinutes:n}=e;return t+60*n*1e3},f=new d(o.Z),y=f},80342:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(24602);class s extends i.Z{getInitialState(){return[]}getList(){return this.getState()}getUnreadCount(){return this.getState().filter((e=>!e.read)).length}getFilter(e){return this.getState().filter((t=>{const n=e.split(" "),{title:i,url:s}=t;return s.toLowerCase().includes(e.toLowerCase())||n.every((e=>i.toLowerCase().includes(e.toLowerCase())))}))}reduce(e,t){return"READING_LIST_UPDATE"===t.actionType?t.entries:e}}const o=new s},24602:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(65398),s=n(84990);class o extends i.Z{constructor(e){super(e??s.Z),this._state=this.getInitialState()}getState(){return this._state}getInitialState(){throw new TypeError(`getInitialState() is not overwritten in ${this.constructor.name}`)}reduce(e,t){throw new TypeError(`reduce() is not overwritten in ${this.constructor.name}`)}dispatchAction(e){const t=this._state,n=this.reduce(t,e);if(void 0===n)throw new Error(`reduce() in ${this.constructor.name} returned undefined, did you forget to return the state in the default case?`);n!==t&&(this._state=n,this.emitChange())}}const a=o},81538:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=new Map},37330:(e,t,n)=>{"use strict";n.d(t,{Z:()=>A});var i=n(65792),s=n.n(i),o=n(93197),a=n(63353),r=n(29087),l=n(24602),d=n(2699),c=n(19486),h=n(15489),p=n(18172),u=n(25356),g=n(89175),m=n(8575),v=n(44850);const f=new Map,y=[],w=new Set,b=["colorFg","colorBg","colorHighlightBg","colorAccentBg"];function C(e){return e.preferSystemAccent&&s().valid(r.Z.get(g.kSystemAccentColor))&&(e.colorHighlightBg=r.Z.get(g.kSystemAccentColor)),c.Z.createStyle(e)}function S(e,t,n){const i=s().contrast(e,t)>n?50:0,o=e.get("lch.l")>5&&e.get("lch.l")<95?50:0;let a=e.get("lch.c")>10?50:0;return(e.get("lch.l")<20||e.get("lch.l")>75)&&(a=e.get("lch.c")>50?a:0),i+o+a}function T(e,t,n,i){const a=s()(n.colorFg),r=s()(n.colorBg),l=I(t,n,i),d={...o.ZP.accentOnly(l,a,r,n.contrast)};Object.keys(d).forEach((t=>{e[`--${t}`]=d[t].toString()}))}function I(e,t,n){let i;if(t.accentFromPage&&e){i=function(e,t){const n=t?.favIconUrl||"",i=t?.url||"";if(!t||w.has(i)||v.jk.isInternalPage(t)||n.startsWith("chrome://favicon/"))return s()(e.colorAccentBg);const o=e.accentSaturationLimit,a=new Map,r=y.find((e=>e.favIconUrl===n))||y.find((e=>i.includes(e.hostname))),l=f.get(t.id);l&&a.set(l,3),r?.colors.forEach(((e,t)=>{switch(t){case 0:a.set(e,2.25);break;case 1:a.set(e,1.5);break;case 2:a.set(e,1.25);break;default:a.set(e,1)}}));const d=[...a.keys()];a.size>2&&d[0].get("lch.c")<1&&d.forEach((e=>{e.get("lch.c")>1&&a.set(e,2)}));const c=s()(e.colorBg),h=[...a].sort(((t,n)=>S(n[0],c,e.contrast)*n[1]-S(t[0],c,e.contrast)*t[1]));return h.length>0&&o<1&&h[0][0].get("hsl.s")>o&&(h[0][0]=h[0][0].set("hsl.s",o)),h[0]&&h[0][0]||s()(e.colorAccentBg)}(t,n||a.Z.getActivePage(e))}else i=s()(t.colorAccentBg);if(t.accentSaturationLimit<1){const e=i.get("hsl.s");i=i.set("hsl.s",e*t.accentSaturationLimit)}return i}class k extends l.Z{getInitialState(){return{browserColor:s()("black"),windowClassNames:new Map,windowStyles:new Map,windowThemes:new Map}}getBaseStyles=(e,t,n)=>{let i=[];if(t){const e=c.Z.getTheme(t);e&&(i=c.Z.createStyle(e))}else i=this.getState().windowStyles.get(n||window.vivaldiWindowId);if(!i)return{};const s=e&&e.length>0?e:b,o={};for(const[e,t]of Object.entries(i))s.includes(e.replace("--",""))&&t&&(o[e]=t);return o};reduce(e,t){if("THEME_INIT"===t.actionType)return(0,p.ZP)(e,(e=>{const{windowId:n}=t,i=d.Z.getCurrentId(n),s=c.Z.getThemeWithFallback(i),o=C(s);Object.assign(o,t.style),T(o,n,s),e.windowStyles.set(n,o),e.windowClassNames.set(n,c.Z.createClassnames(s,o)),e.windowThemes.set(n,s),h.ZP.isActive(n)&&(e.browserColor=I(n,s))}));if("THEME_WINDOW_CREATED"===t.actionType){const n=d.Z.getCurrentId(t.windowId),i=c.Z.getThemeWithFallback(n);return(0,p.ZP)(e,(e=>{const n=C(i);e.windowClassNames.set(t.windowId,c.Z.createClassnames(i,n)),e.windowStyles.set(t.windowId,n),e.windowThemes.set(t.windowId,i)}))}if("WINDOW_CLOSED"===t.actionType)return(0,p.ZP)(e,(e=>{e.windowClassNames.delete(t.windowId),e.windowStyles.delete(t.windowId),e.windowThemes.delete(t.windowId)}));if("THEME_SET"===t.actionType)return(0,p.ZP)(e,(e=>{e.windowStyles.forEach(((n,i)=>{if(!h.ZP.isIncognito(i)){const s=d.Z.getCurrentId(i),o=c.Z.getThemeWithFallback(s),a=C(o);Object.assign(n,a),Object.keys(n).forEach((e=>{a.hasOwnProperty(e)||delete n[e]})),Object.assign(n,t.style),T(n,i,o),e.windowClassNames.set(i,c.Z.createClassnames(o,n)),e.windowThemes.set(i,o),h.ZP.isActive(i)&&(e.browserColor=I(i,o))}}))}));if("THEME_SET_PRIVATE"===t.actionType)return(0,p.ZP)(e,(e=>{e.windowStyles.forEach(((n,i)=>{if(h.ZP.isIncognito(i)){const s=d.Z.getCurrentId(i),o=c.Z.getThemeWithFallback(s),a=C(o);Object.assign(n,a),Object.keys(n).forEach((e=>{a.hasOwnProperty(e)||delete n[e]})),Object.assign(n,t.style),T(n,i,o),e.windowClassNames.set(i,c.Z.createClassnames(o,n)),e.windowThemes.set(i,o),h.ZP.isActive(i)&&(e.browserColor=I(i,o))}}))}));if("PAGE_OPEN"===t.actionType||"PAGE_OPEN_URL"===t.actionType||"CHROME_TABS_ACTIVATED"===t.actionType){const n="CHROME_TABS_ACTIVATED"===t.actionType?t.activeInfo.windowId:t.windowId,i="CHROME_TABS_ACTIVATED"===t.actionType?t.activeInfo.tabId:t.pageId,s=a.Z.getPageById(i);return(0,p.ZP)(e,(t=>{const i=e.windowThemes.get(n),o=t.windowStyles.get(n);o&&i&&s&&(T(o,n,i,s),t.browserColor=I(n,i,s))}))}if("THEME_SET_META"===t.actionType)return f.get(t.tabId)?.hex()!==t.color.hex()&&f.set(t.tabId,t.color),(0,p.ZP)(e,(t=>{t.windowStyles.forEach(((t,n)=>{const i=e.windowThemes.get(n);i&&T(t,n,i)}))}));if("THEME_SET_FAILED_FAVICON_URL"===t.actionType)return w.has(t.url)||w.add(t.url),(0,p.ZP)(e,(t=>{t.windowStyles.forEach(((t,n)=>{const i=e.windowThemes.get(n);i&&T(t,n,i)}))}));if("THEME_SET_PAGE_PALETTE"===t.actionType){const{windowId:n,favIconUrl:i,hostname:s,colors:o}=t;return y.push({favIconUrl:i,hostname:s,colors:o}),(0,p.ZP)(e,(t=>{const i=t.windowStyles.get(n),s=e.windowThemes.get(n);i&&s&&(T(i,n,s),t.browserColor=I(n,s))}))}if("CHROME_TABS_CREATE"===t.actionType||"CHROME_TABS_UPDATED"===t.actionType){const n="CHROME_TABS_CREATE"===t.actionType?t.page:a.Z.getPageById(t.tabId),i=n?.windowId,s=n?.favIconUrl,o=n?.url,r=Boolean(s&&!s.startsWith("chrome://favicon/")&&y.find((e=>e.favIconUrl===s)));if(!Boolean(!n||!o||w.has(o)||v.jk.isInternalPage(n)||r)&&n&&o){const t=(0,m.parse)((0,u.Z)(o)).hostname;if(t&&i&&s){if(y.find((e=>e.hostname===t)))return d.Z.loadFavicon(n,t),(0,p.ZP)(e,(t=>{const n=t.windowStyles.get(i),s=e.windowThemes.get(i);n&&s&&(T(n,i,s),t.browserColor=I(i,s))}));d.Z.loadFavicon(n,t)}}}return e}}const A=new k},85374:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(24602),s=n(35369);class o extends i.Z{getInitialState(){return{pageState:new s.D5,serverLanguages:["en","ko","no","tr","zh-Hant","nl","sv","ur","fa","hu","is","ar","fi","id","ja","pt","uk","pl","ru","zh-Hans","cs","es","hi","de","fr","it"].sort()}}reduce(e,t){switch(t.actionType){case"VIVALDI_TABS_LANGUAGE_DETERMINED":{const{tabId:n,pageLanguage:i}=t;return a(e,n,{pageLanguage:i})}case"VIVALDI_TABS_PAGE_TRANSLATED":{const{tabId:n}=t;let{isTranslated:i,originalLang:s,translatedLang:o,error:r}=t.message;return i&&"no_error"!==r&&(i=!1),a(e,n,{isTranslated:i,originalLang:s,translatedLang:o,error:r})}case"PAGE_CLOSE":return function(e,t){return t.forEach((t=>{e=(0,s.fe)(e,["pageState",t.id])})),e}(e,t.pages);case"VIVALDI_SET_SERVER_LANGUAGES":return{...e,serverLanguages:t.languages};case"PAGE_RESET_TRANSLATION_PARAMETERS":return(0,s.fe)(e,["pageState",t.tabId]);case"VIVALDI_TABS_PAGE_TRANSLATED_REVERT":{const{tabId:n}=t;return a(e,n,{isTranslated:!1})}case"VIVALDI_TABS_TRANSLATION_PROGRESS":{const{tabId:n,translateStep:i,error:s,autoTranslate:o}=t;return a(e,n,{translateStep:i,error:s,autoTranslate:o})}default:return e}}isTranslated(e){const t=this.getState().pageState.get(e);return!!t&&Boolean(t.isTranslated)}getPageState(e){return this.getState().pageState.get(e)||{pageLanguage:"",translateStep:"idle"}}}function a(e,t,n){let i=e.pageState.get(t);return i=i?(0,s.TS)(i,n):{translateStep:"idle",...n},(0,s.tP)(e,["pageState",t],i)}const r=new o},63365:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var i=n(65398),s=n(84990),o=n(5264),a=n.n(o);class r extends i.Z{_trash=[];getTrash(){return l(this._trash)}dispatchAction(e){if("CHROME_SET_SESSION"===e.actionType)this._trash=e.session,this.emitChange()}}const l=a()(1)((e=>e.filter((e=>!!e.tab||(e.window?"settings"!==(e.window.vivExtData?JSON.parse(e.window.vivExtData):{}).windowType:void 0))))),d=new r(s.Z)},71860:(e,t,n)=>{"use strict";n.d(t,{Z:()=>w});var i=n(65398),s=n(63353),o=n(68247),a=n(29087),r=n(37330),l=n(84990),d=n(92292),c=n(82394),h=n(7064),p=n(44850),u=n(89175);const g={};let m=[],v=!1;const f={autocompleteValue:void 0,editUrl:void 0,isActive:!1,isOmniDropdownOpen:!1,selectionEnd:-1,selectionStart:-1};class y extends i.Z{getUrlfieldStateFromId(e){return{...f,...g[e.toString()]}}getTypedHistory(){return m}getThemeColors(){return this._getThemeColorStyle()}setUrlFieldActive(e,t){this._setUrlfieldState(e,{isActive:t})}_updateTypedHistory(){h.Z.historyPrivate.getTypedHistory("","-1",50,(e=>{m=(0,c.Z)(e),this.emitChange("URLFIELD_TYPED_HISTORY_UPDATE")}))}_deleteHistory(e){d.Z.history.deleteUrl({url:e},(()=>this.emitChange()))}_setUrlfieldState(e,t){const n=(e||"").toString(),i=g[n];return(!i||!Object.keys(t).every((e=>t[e]===i[e])))&&(g[n]={...i,...t},!0)}_clearUrlfieldState(e){const t=e+"";g[t]?g[t]={autocompleteValue:void 0,editUrl:void 0,isActive:this.getUrlfieldStateFromId(e)?.isActive,isOmniDropdownOpen:!1,selectionEnd:0,selectionStart:0}:g[t]={autocompleteValue:void 0,editUrl:void 0,isActive:!1,isOmniDropdownOpen:!1,selectionEnd:0,selectionStart:0}}_getThemeColorStyle(){let e;switch(a.Z.get(u.kWebpagesReaderStyle).themeStyle){case"light":e="Vivaldi1";break;case"dark":e="Vivaldi2";break;default:e=void 0}return r.Z.getBaseStyles(void 0,e)}_setReadermodeStyle(e){const t=a.Z.get(u.kWebpagesReaderStyle),n=s.Z.getActivePage(e);n?.vivExtData.readerMode&&d.Z.tabs.sendMessage(n.id,{readerStyle:{...t,...this._getThemeColorStyle()}})}_removePages(e){for(const{id:t}of e.values())delete g[t+""]}dispatchAction(e){switch(e.actionType){case"URLFIELD_SET_STATE":this._setUrlfieldState(e.pageId,e.state)&&this.emitChange();break;case"NAVIGATION_SET_STATE":if(!e.navigationState?.isLoading)if(v=!1,"abort"===e.navigationState.trigger){const t=e.pageId+"";g[t]&&!g[t].editUrl&&this._clearUrlfieldState(e.pageId),this.emitChange()}else if("stop"===e.navigationState.trigger&&!this.getUrlfieldStateFromId(e.pageId)?.isActive){this._setUrlfieldState(e.pageId,{editUrl:void 0})&&this.emitChange()}break;case"CHROME_TABS_CREATE":{const{page:t}=e;v=!0,this._setUrlfieldState(t.id,{isActive:(0,p.Rf)(t.url)});break}case"WEBPAGEVIEW_RELOAD":this._clearUrlfieldState(e.pageId),this.emitChange();break;case"PAGE_OPEN":this.emitChange();break;case"PAGE_CLOSE":this._removePages(e.pages),this.emitChange();break;case"URLFIELD_HISTORY_DELETE":this._deleteHistory(e.url);break;case"READERMODE_RESET":o.Z.reset(u.kWebpagesReaderStyle),this._setReadermodeStyle(e.windowId),this.emitChange();break;case"READERMODE_SET_STYLE":this._setReadermodeStyle(e.windowId);break;case"URLFIELD_CLEAR_STATE":v||(this._clearUrlfieldState(e.pageId),this.emitChange());break;case"URLFIELD_TYPED_HISTORY_UPDATE":this._updateTypedHistory();break;case"URLFIELD_COPY_STATE":this._setUrlfieldState(e.pageId,e.state)&&this.emitChange();break;case"CHROME_TABS_INIT":e.tabs.forEach((({id:e,url:t=""})=>{void 0!==e&&(g[e.toString()]={autocompleteValue:void 0,editUrl:void 0,isActive:!a.Z.get(u.kTabsFocusWebview)&&((0,p.Rf)(t)||""===t),isOmniDropdownOpen:!1,selectionEnd:-1,selectionStart:-1})})),this.emitChange()}}__reset(){for(const e in g)delete g[e]}}const w=new y(l.Z)},57904:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i=n(65398),s=n(84990);const o={},a={};class r extends i.Z{isFindInPageOpen(e){return!0===o[e]}getFindResultsForPage(e){let t=a[e];return void 0===t&&(t={activeMatchOrdinal:0,numberOfMatches:0,searchText:"",canceled:!1,matchCase:!1,isFindInPageToolbarOpen:!1,selectionRect:{left:0,top:0,width:0,height:0}}),t.isFindInPageToolbarOpen=!0===o[e],t}dispatchAction(e){switch(e.actionType){case"WEBPAGEVIEW_ACTIONS":switch(e.subAction){case"findInPage":o[e.pageId]=!0,this.emitChange({type:"WEBPAGEVIEW_ACTIONS",action:"findInPage",winId:e.windowId,pageId:e.pageId});break;case"findNextInPage":case"findPreviousInPage":!0!==o[e.pageId]&&(o[e.pageId]=!0,this.emitChange({type:"WEBPAGEVIEW_ACTIONS",action:"findInPage",winId:e.windowId,pageId:e.pageId})),this.emitChange({type:"WEBPAGEVIEW_ACTIONS",action:e.subAction,winId:e.windowId,pageId:e.pageId});break;case"addBookmark":case"focusAddressField":case"pageScrollBottom":case"pageScrollDown":case"pageScrollTop":case"pageScrollUp":case"print":this.emitChange({type:"WEBPAGEVIEW_ACTIONS",action:e.subAction,winId:e.windowId,pageId:e.pageId});break;case"focusSearchField":this.emitChange({type:"WEBPAGEVIEW_URLFIELD_BLUR",winId:e.windowId}),this.emitChange({type:"WEBPAGEVIEW_ACTIONS",action:"focusSearchField",winId:e.windowId,pageId:e.pageId});break;case"focusWebView":this.emitChange({type:"WEBPAGEVIEW_URLFIELD_BLUR",winId:e.windowId}),this.emitChange({type:"WEBPAGEVIEW_ACTIONS",action:"focusWebView",winId:e.windowId,pageId:e.pageId});break;case"searchPasteAndGo":case"urlPasteAndGo":e.payload&&this.emitChange({type:"WEBPAGEVIEW_ACTIONS",action:e.subAction,winId:e.windowId,pageId:e.pageId,payload:e.payload})}break;case"WEBPAGEVIEW_BACK":case"WEBPAGEVIEW_FORWARD":case"WEBPAGEVIEW_STOP":this.emitChange({type:e.actionType,winId:e.windowId,pageId:e.pageId});break;case"WEBPAGEVIEW_CLOSE_FIND_IN_PAGE":o[e.pageId]&&(o[e.pageId]=!1,this.emitChange({type:"WEBPAGEVIEW_CLOSE_FIND_IN_PAGE",winId:e.windowId,pageId:e.pageId}));break;case"WEBPAGEVIEW_GET_HISTORY":this.emitChange({type:"WEBPAGEVIEW_GET_HISTORY",winId:e.windowId,pageId:e.pageId,callback:e.callback});break;case"WEBPAGEVIEW_GO":this.emitChange({type:"WEBPAGEVIEW_GO",winId:e.windowId,pageId:e.pageId,index:e.index});break;case"WEBPAGEVIEW_RELOAD":this.emitChange({type:e.actionType,winId:e.windowId,pageId:e.pageId,bypassCache:e.bypassCache});break;case"WEBPAGEVIEW_RESULTS_FROM_FIND_IN_PAGE":o[e.pageId]&&(a[e.pageId]={...e.results,matchCase:e.matchCase,searchText:e.searchText,isFindInPageToolbarOpen:!1},this.emitChange({type:"WEBPAGEVIEW_RESULTS_FROM_FIND_IN_PAGE",winId:e.windowId,pageId:e.pageId}));break;case"NAVIGATION_SET_STATE":if(e.navigationState&&"start"!==e.navigationState.trigger||!1===o[e.pageId])return;!0===o[e.pageId]&&(o[e.pageId]=!1,this.emitChange({type:"WEBPAGEVIEW_CLOSE_FIND_IN_PAGE",winId:e.windowId,pageId:e.pageId}));break;case"MAIN_SHOW_QUICKCOMMANDS":case"PANEL_SET_FOCUS":this.emitChange({type:"WEBPAGEVIEW_URLFIELD_BLUR",winId:e.winId})}}}const l=new r(s.Z)},15489:(e,t,n)=>{"use strict";n.d(t,{Ex:()=>c,TF:()=>p,WV:()=>f,ZP:()=>y});var i=n(15285),s=n(29087),o=n(24602),a=n(84990),r=n(34540),l=n(89175),d=n(18172);const c=-1,h=[];function p(e){if(!e)return!1;const{state:t,minimalUI:n}=e;return n||"fullscreen"===t}function u(e,t,n){return(0,d.Uy)(e,(e=>{const i=e.get(t);i&&n(i)}))}class g extends o.Z{constructor(e){e.checkRegistered(i.ZP),super(e)}getInitialState(){return new Map}_updateUIState(e,t){const n=p(this.getState().get(e)),i=p(t);n&&!i?t.visibleUI=this.getUIFromPrefs():!n&&i&&(t.visibleUI={bookmarksBar:!1,addressBar:!1,panelToggle:!1,tabs:!1,statusBar:s.Z.get(l.kStatusBarMinimized)})}reduce(e,t){switch(t.actionType){case"WINDOW_SET_STATE":return(0,d.Uy)(e,(e=>{const{windowId:n,windowState:i}=t;e.set(n,i)}));case"WINDOW_CLOSED":return(0,d.Uy)(e,(e=>{const{windowId:n}=t;e.delete(n)}));case"WINDOW_UPDATE_FROM_PREFS":{const{windowId:n}=t;return p(e.get(t.windowId))?e:u(e,n,(e=>{e.visibleUI=this.getUIFromPrefs()}))}case"WINDOW_ACTIVATED":return u(e,t.windowId,(e=>{e.active=t.activated}));case"WINDOW_STATE_CHANGED":return u(e,t.windowId,(e=>{const{windowId:n,state:i}=t;"fullscreen"===e.state&&"fullscreen"!==i&&(e.html5FullScreen=!1),e.state&&"fullscreen"!==e.state&&"fullscreen"===i&&(e.restoreStateFullscreen=e.state),e.state=i,this._updateUIState(n,e)}));case"WINDOW_FULL_SCREEN_MENU_BAR":return u(e,t.windowId,(e=>{e.fullscreenMenubarShown=t.shown}));case"WINDOW_HTML5_FULL_SCREEN":return u(e,t.windowId,(e=>{const{windowId:n,html5FullScreen:i}=t;i?(e.restoreStateHtml5Fullscreen=e.state?e.state:"normal",e.state="fullscreen"):e.state=e.restoreStateHtml5Fullscreen,e.html5FullScreen=i,this._updateUIState(n,e)}));case"WINDOW_MINIMAL_UI":return u(e,t.windowId,(e=>{e.minimalUI=t.minimalUI,this._updateUIState(t.windowId,e)}));case"WINDOW_TOGGLE_BOOKMARKS_BAR":return p(e.get(t.windowId))?u(e,t.windowId,(e=>{e.visibleUI.bookmarksBar=!e.visibleUI.bookmarksBar})):(console.warn("Attempting to toggle toolbars for a window without minimal UI"),e);case"WINDOW_TOGGLE_ADDRESS_BAR":return p(e.get(t.windowId))?u(e,t.windowId,(e=>{e.visibleUI.addressBar=!e.visibleUI.addressBar})):(console.warn("Attempting to toggle toolbars for a window without minimal UI"),e);case"WINDOW_TOGGLE_TABS":return p(e.get(t.windowId))?u(e,t.windowId,(e=>{e.visibleUI.tabs=!e.visibleUI.tabs})):(console.warn("Attempting to toggle toolbars for a window without minimal UI"),e);case"WINDOW_TOGGLE_PANEL_TOGGLE":return p(e.get(t.windowId))?u(e,t.windowId,(e=>{e.visibleUI.panelToggle=!e.visibleUI.panelToggle})):(console.warn("Attempting to toggle toolbars for a window without minimal UI"),e);case"WINDOW_TOGGLE_STATUS_BAR":return p(e.get(t.windowId))?u(e,t.windowId,(e=>{e.visibleUI.statusBar="on"===e.visibleUI.statusBar?s.Z.get(l.kStatusBarMinimized):"on"})):(console.warn("Attempting to toggle toolbars for a window without minimal UI"),e)}return e}getWindowState(e){return this.getState().get(e)}getId(){let e=c;for(const[t,n]of this.getState()){if(n.active)return t;e=t}return e}getActiveWindowId(){for(const[e,t]of this.getState())if(t.active)return e;return c}getIds(e){const t=[];for(const[n,i]of this.getState())i.type===e&&t.push(n);return t}getActiveBrowserOrPopupWindowId(){const e=window.vivaldiWindowId;for(const[e,t]of this.getState())if(t.active&&"settings"!==t.type)return e;return e}getLastActiveBrowserWindowId(){return 0===h.length?c:h[0]}isFullscreen(e){return"fullscreen"===this.getState().get(e)?.state}isHTML5Fullscreen(e){return this.getState().get(e)?.html5FullScreen||!1}isIncognito(e){return this.getState().get(e)?.incognito||!1}isMaximized(e){return"maximized"===this.getState().get(e)?.state}isMinimized(e){return"minimized"===this.getState().get(e)?.state}isActive(e){return this.getState().get(e)?.active||!1}isPopup(e){return"popup"===this.getState().get(e)?.type}isSettings(e){return"settings"===this.getState().get(e)?.type}isTabbedBrowser(e){return!this.isPopup(e)&&!this.isSettings(e)}isMinimalUI(e){return p(this.getState().get(e))}getMailWindowId(){let e=c;for(const[t]of this.getState())(e===c||t<e)&&this.isTabbedBrowser(t)&&!this.isIncognitoOrGuest(t)&&(e=t);return e}isMail(e=window.vivaldiWindowId){return this.getMailWindowId()===e}isGuestSession(e){const t=this.getState().get(e);return!t||t.guest}getVisibleUI(e){const t=this.getState().get(e);return t?t.visibleUI:this.getUIFromPrefs()}isIncognitoOrGuest(e){return this.isIncognito(e)||this.isGuestSession(e)}getRestoreStateFullscreen(e){const t=this.getState().get(e);if(!t)throw new Error("WindowStore.getRestoreStateFullscreen: Expected a valid windowId");return t.restoreStateFullscreen}getRestoreStateHtml5Fullscreen(e){const t=this.getState().get(e);if(!t)throw new Error("WindowStore.getRestoreStateHtml5Fullscreen: Expected a valid windowId");return t.restoreStateHtml5Fullscreen}getUIFromPrefs(){return{bookmarksBar:s.Z.get(l.kBookmarksBarVisible),addressBar:s.Z.get(l.kAddressBarVisible),panelToggle:s.Z.get(l.kPanelsShowToggle),tabs:s.Z.get(l.kTabsVisible),statusBar:s.Z.get(l.kStatusBarDisplay)}}}const m=new g(a.Z),v={_oldState:m.getState(),updateLastActiveBrowserWindowStack(e){this.removeFromLastActiveBrowserWindowStack(e),m.isTabbedBrowser(e)&&h.unshift(e)},removeFromLastActiveBrowserWindowStack(e){const t=h.indexOf(e);-1!==t&&h.splice(t,1)},recordState(){const e=this._oldState,t=m.getState();this._oldState=t;for(const[n]of e)t.has(n)||this.removeFromLastActiveBrowserWindowStack(n);for(const[n,i]of t){const t=e.get(n);(i.active&&!t?.active||0===h.length)&&this.updateLastActiveBrowserWindowStack(n),i.html5FullScreen||t&&i!==t&&(p(t)===p(i)&&("fullscreen"===t.state&&"fullscreen"===i.state||"fullscreen"!==t.state&&"fullscreen"!==i.state)&&t.visibleUI===i.visibleUI||(0,r.Z)(n,{minimalUI:i.minimalUI,fullScreen:"fullscreen"===i.state,visibleUI:i.visibleUI}))}}};function f(e){return e.html5FullScreen?"fullscreen inner":"fullscreen"===e.state?"fullscreen":"maximized"===e.state?"maximized":"normal"}m.addListener(v.recordState.bind(v));const y=m},47825:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(24602),s=n(71828);class o extends i.Z{getInitialState(){return{zoom:s.rM,defaultPageZoom:s.rM,uiZoom:s.an,notesZoom:s.rM}}reduce(e,t){switch(t.actionType){case"ZOOM_PAGE":return{...e,zoom:t.zoomData};case"ZOOM_NOTES":return{...e,notesZoom:t.zoomData};case"ZOOM_SET_UI":return{...e,uiZoom:t.zoomData};case"ZOOM_PAGE_DEFAULT":return{...e,defaultPageZoom:t.zoomData}}return e}}const a=new o},44147:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var i=n(27770),s=n(48603),o=n(59486),a=n(46382),r=n(63353),l=n(60331),d=n(44850);const c={onAction:function(e,t){const n=function(e,t){s.Z.copy(t,[e])},i=function(e,t){s.Z.cut(t,[e])},l=function(e,t){s.Z.paste(t,e,!0)},d=o.ZP.getItemById(t.id);if(d){const c=void 0!==d.index?d.index+1:-1;switch(t.command){case"addactivetab":{const t=r.Z.getActivePage(e);t&&(o.ZP.isFolder(d)?s.Z.bookmarkPageInFolder(t,d.id):s.Z.bookmarkPageInFolder(t,d.parentId||"",c));break}case"edit":a.Z.showBookmarkDialog(e,{mode:t.command,id:t.id,index:-1});break;case"addfolder":case"addbookmark":a.Z.showBookmarkDialog(e,{mode:t.command,id:t.id,index:c});break;case"addseparator":o.ZP.isFolder(d)?s.Z.createSeparator(t.id,d.children?d.children.length:0):d.parentId&&s.Z.createSeparator(d.parentId,c);break;case"cut":const h=i.bind(null,t.id);document.addEventListener("cut",h),document.execCommand("cut"),document.removeEventListener("cut",h);break;case"copy":const p=n.bind(null,t.id);document.addEventListener("copy",p),document.execCommand("copy"),document.removeEventListener("copy",p);break;case"paste":const u=l.bind(null,t.id);document.addEventListener("paste",u),document.execCommand("paste"),document.removeEventListener("paste",u)}}},onHover:function(e,t){l.Z.setStatus(e,d.jk.getHoverUrl(o.ZP.filterUrl(t)))},onOpen:function(e,t){const n=o.ZP.getItemById(t.id);if(n){const s=i.ZP.getOpenOptionsFromDisposition(e,t.disposition,t.background,i.ZP.makeEventFlagsFromApiResponse(t.state));i.ZP.open(e,i.ZP.getBookmarksByNode(n),s,!0)}}}},57082:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(34155);const s=Array();const o={onCommand:function(e,t){i.nextTick((()=>{s.forEach((n=>{n.name===t&&n.callback(e,t)}))}))},hasListener:function(e){return s.filter((t=>t.name===e)).length>0},addListener:function(e,t){-1===s.findIndex((n=>n.name===e&&n.callback===t))&&s.push({name:e,callback:t})},removeListener:function(e,t){const n=s.findIndex((n=>n.name===e&&n.callback===t));-1!==n&&s.splice(n,1)}}},84451:(e,t,n)=>{"use strict";n.d(t,{Z:()=>S});var i=n(45502),s=n(63353),o=n(29087),a=n(15489),r=n(15048),l=n(7064),d=n(89175);var c=["f1","f2","f3","f4","f5","f6","f7","f8","f9","f10","f11","f12","f13","f14","f15","f16","f17","f18","f19"],h={delete:"del",option:"alt",command:"meta",return:"enter",escape:"esc",comma:",",period:".",del:"del",mod:"ctrl"},p=["left","right","shift+left","shift+right","shift+up","shift+down","enter","shift+enter"];p=p.concat(["ctrl+a","ctrl+z","ctrl+y","ctrl+u","ctrl+left","ctrl+right","ctrl+backspace","ctrl+delete","ctrl+home","ctrl+end","ctrl+shift+left","ctrl+shift+right","shift+home","shift+end"]);const u={};function g(e){var t=e.split("+");t=t.map((e=>h[e]||e));var n="";function i(e){t.indexOf(e)>-1&&(n+=e+"+",t.splice(t.indexOf(e),1))}return i("ctrl"),i("alt"),i("shift"),i("meta"),t.sort(),t.forEach(((e,i)=>{n+=e,i+1<t.length&&(n+="+")})),n.toLowerCase()}function m(e){return{ctrlKey:-1!==e.indexOf("ctrl"),altKey:-1!==e.indexOf("alt"),metaKey:-1!==e.indexOf("meta"),shiftKey:-1!==e.indexOf("shift"),key:e.split("+").pop()}}function v(e,t,n){n({windowId:e,keyState:t})}function f(e){return 1===e.length||e.startsWith("numpad")}function y(e){var t=m(e),n=e.split("+").pop();if(-1!==p.indexOf(e))return!1;if("esc"===n||"down"===n||"up"===n||"home"===n||"end"===n||"pagedown"===n||"pageup"===n)return!0;if(c.indexOf(n)>-1)return!0;if(t.ctrlKey||t.altKey||t.shiftKey||t.metaKey){if("backspace"===n||"del"===n)return!0;if(t.ctrlKey||t.metaKey||t.altKey)return!0}return!1}const w=["INPUT","FRAME","IFRAME","SELECT","TEXTAREA"],b=["submit","button","reset","radio","checkbox"],C=["chrome://game/","docs.google.com"];const S={bind:function(e,t,n,i,s,o){return[].concat(e).filter(Boolean).map((e=>e.trim())).forEach((e=>function(e,t,n,i,s,o){const a=g(e),r=u[a]||[];r.push({callback:i,onAutoRepeat:Boolean(t),isFeatureShortcut:Boolean(n),isEnabled:s||(e=>!0),feature:o||"browser"}),u[a]=r}(e,n,i,t,s,o))),this},unbind:function(e,t){return[].concat(e).forEach((e=>function(e,t){if(e){const n=g(e);u[n]&&(t?u[n]=u[n].filter((e=>e.callback!==t)):delete u[n])}}(e,t))),this},keyComboFromEvent:function(e){if(!(["Alt","Shift","Control","Meta","CapsLock","NumLock","AltGraph"].indexOf(e.key)>-1)&&"keydown"===e.type){const t=function(e){if(e.code.startsWith("Numpad")){var t=r.Z[e.keyCode].substr(6);if(t>="0"&&t<="9")return e.code}return r.Z[e.keyCode]}(e);if("None"===t)return"";{let n=function(e){var t="";return e.metaKey&&(t+="meta+"),e.altKey&&(t+="alt+"),e.ctrlKey&&(t+="ctrl+"),e.shiftKey&&(t+="shift+"),t}(e);return n+=t,g(n.toLowerCase())}}return""},shortcutAllowedInText:y,isSingleKeyShortcut:f,handleShortcut:function(e,t,r,c){let h=t.toLowerCase().replace(" ","");h.endsWith("arrow")&&(h=h.substring(0,h.length-5)),h=g(h);const p=function(e,t){const n=u[e];if(n?.length)return n.reduce(((e,n)=>e||"browser"!==n.feature?n.feature===t?n:e:n),null)}(h,i.Z.getContext(e).feature);if(p){if(!p.isEnabled(e))return;if(!0===r&&!1===p.onAutoRepeat)return;!async function(e,t,r,c,h){if(f(r)){if(c){if(!o.Z.get(d.kKeyboardShortcutsEnableSingleKeyForMail))return;if("browser"===i.Z.getContext(e).feature)return}else if(!o.Z.get(d.kKeyboardShortcutsEnableSingleKey))return;const t=s.Z.getActivePage(e);if(t)for(const e of C)if(t.url.includes(e))return}if(a.ZP.isSettings(e)&&!n(88083).Z.isShortcutWhitelisted(e,r))return;if(!o.Z.get(d.kKeyboardShortcutsEnable)){const t=(await n(88083).Z.getAllCommands(e)).find((e=>"COMMAND_PAGE_DISABLE_KEYBOARD_SHORTCUTS"===e.name));if(!t)return;const i=n(88083).Z.getCommandConfiguration(t.name);if(!Array.isArray(i.shortcuts)||!i.shortcuts.some((e=>e===r)))return}const p=h?h.tagName:"",u=h instanceof HTMLInputElement?h.type:"",g=!!h&&h.isContentEditable;w.includes(p)&&!b.includes(u)||g?y(r)&&v(e,m(r),t):"WEBVIEW"===p?l.Z.windowPrivate.getFocusedElementInfo(e).then((({tagName:n,editable:i,role:s})=>{if(!i||y(r)){const i="SELECT"===n,o="SPAN"===n&&"spinbutton"===s;(!i&&!o||i&&y(r))&&v(e,m(r),t)}})):v(e,m(r),t)}(e,p.callback,h,p.isFeatureShortcut,c)}}}},5198:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var i=n(9761),s=n(29087),o=n(85374),a=n(56371),r=n(7064),l=n(36436),d=n(89175);let c=[],h=[];const p={canTranslateText(e,t="",n=-1){return!(n>=0&&!s.Z.get(d.kPanelsTranslateRedirect)&&!this.canTranslatePage(n,!0))&&Boolean(e.length>4&&e.length<2e3&&!(0,l.xl)(t))},canTranslatePage(e,t=!1){const n=o.Z.getPageState(e);return t?Boolean(n.pageLanguage):Boolean(n.pageLanguage)&&!n.isTranslated},getTranslationCode:e=>i.YI[e]||e,getTranslationLocales(){if(!c.length){const e=o.Z.getState().serverLanguages;h=i.lE.filter((e=>!i.u4.includes(e.key))).concat(i.sK).sort(((e,t)=>(e.value||e.local||e.key).localeCompare(t.value||t.local||t.key))),c=h.filter((t=>{const n=p.getTranslationCode(t.key);return e.includes(n)}))}return c},invalidateTranslationLocales(){c=[]},getHumanReadableLanguageFromCode(e){h.length||p.getTranslationLocales();const t=h.find((t=>{const n=p.getTranslationCode(t.key);return t.key===e||n===e}));return t?t.value:(0,a.Z)("Unknown ($1)",[e])},async detectTextLanguage(e,t){let n=await r.Z.tabsPrivate.determineTextLanguage(e,t);return"und"===n&&(n=""),n}},u=p},19789:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>T,uf:()=>w,mr:()=>y,SI:()=>f});n(42786),n(31083),n(9808),n(68338),n(5822),n(24780),n(59740),n(60894),n(50837),n(22243),n(55655),n(5603),n(76959),n(11897),n(94470),n(5044),n(2101),n(30316),n(22138),n(11423),n(29218),n(90135),n(90626),n(39183),n(41270),n(33730),n(57010),n(64924),n(93901),n(83877),n(64495),n(89520),n(57971),n(96459),n(21793),n(64249),n(14985),n(51104),n(79915),n(98760),n(72397),n(67691),n(65666),n(83839),n(74152);var i=n(29087),s=n(56371),o=n(92292),a=n(30381),r=n.n(a);const l=new RegExp(/'.*?'/g),d=new RegExp(/\]?[^\]]*\[|\](.+)?$/g),c=e=>`[${e.replace(/'/g,"")}]`,h=e=>e.replace(/y/g,"Y").replace(/d/g,"D").replace(/E/g,"d").replace("DDDD","dddd"),p=e=>e?e=e.includes("'")?e.replace(l,c).replace(d,(e=>h(e))):h(e):"";var u=n(89175);const g={sunday:0,monday:1,tuesday:2,wednesday:3,thursday:4,friday:5,saturday:6},m=o.Z.i18n.getUILanguage().toLowerCase(),v=Intl.NumberFormat(m);function f(e){return String(e.year()).padStart(4,"0")+"-"+String(e.month()+1).padStart(2,"0")+"-"+String(e.date()).padStart(2,"0")}function y(e){return String(e.hour()).padStart(2,"0")+":"+String(e.minute()).padStart(2,"0")}function w(e){return v.format(parseFloat(e))}function b(e){if("hy"===(e=e.toLowerCase()))return"hy-am";if("sr"===e)return"sr-cyrl";const t=r()().locale(e);return t.locale()===e||"-"===e[2]&&(e=e.substring(0,2),t.locale(e),t.locale()===e)?e:"en"}function C(e){const t=r()().locale(b(m));if(t.localeData)return"short"===e?t.localeData().weekdaysShort():t.localeData().weekdays();const n=new Date,i=new Date(n.setDate(n.getDate()-n.getDay())),s=[];let o=0;for(;o<7;)s.push(i.toLocaleString(m,{weekday:e})),i.setDate(i.getDate()+1),o++;return s}function S(e="long"){const t=r()().locale(b(m));if(t.localeData)return"short"===e?t.localeData().monthsShort():t.localeData().months();const n=[];let i=0;for(;i<12;){const t=new Date(2e3,i,1);n.push(t.toLocaleString(m,{month:e})),i++}return n}const T={formatNumber:w,getWeekdays:C,getMonths:S,getLocale:function(e){const t=b(m),n=r()().locale(t),s=i.Z.get(u.kCalendarStartOfWeek),o=parseInt(i.Z.get(u.kCalendarWeekNumberRule));if(e&&"language"!==i.Z.get(u.kCalendarDateFormat)){(a=e).timeFormat=a.timeFormat.replace(/tt/,"A").replace(/t/,"A"),a.shortDateFormat=p(a.shortDateFormat),a.longDateFormat=`${p(a.longDateFormat)} ${a.timeFormat}`;const n=(e=a).timeFormat,i=n.replace(":ss",""),r=e.longDateFormat,l=r.replace(/.?dddd.?/,"").trim(),d=l.replace(/\s?(h+.m+.s+)\s?a?/gi,"").trim(),c=e.shortDateFormat.includes("DD")&&e.shortDateFormat.includes("MM")?e.shortDateFormat:e.shortDateFormat.replace(/M+/,"MM").replace(/D+/,"DD"),h="system"===s?e.firstDayOfWeek:g[s],u=7+h-o;return{name:t+"-viv",parentLocale:t,months:S("long"),monthsShort:S("short"),weekdays:C("long"),weekdaysShort:C("short"),week:{dow:h,doy:u},longDateFormat:{LT:i,LTS:n,L:c,LL:d,LLL:l,LLLL:r}}}{if(!n.localeData)return r().localeData();const e={name:t+"-viv",parentLocale:t,months:S("long"),monthsShort:S("short"),weekdays:C("long"),weekdaysShort:C("short"),week:n.localeData()._week,longDateFormat:n.localeData()._longDateFormat};return"system"!==s&&(e.week.dow=g[s]),e.week.doy=7+e.week.dow-o,e}var a},getWeekdayFormat:function(e="LL"){return(0,s.Z)("$1, $2",["dddd",e])},getShortDateFormat:function(){return r().localeData().longDateFormat("ll").replace("MMMM","MMM").replace(/([^MD]*)?Y+([^MD]*)?$/g,"").replace(/^Y+([^MD]*)?/,"").trim().replace(/(^,)|(,$)/g,"")},fixMomentLocale:b,formatYMD:f,formatTime:y}},76747:(e,t,n)=>{"use strict";n.d(t,{Z:()=>I});var i=n(88083),s=n(45502),o=n(84451),a=n(29087),r=n(56371),l=n(92292),d=n(13302),c=n(89175);let h;function p(){return(0,r.Z)("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefhiklmnorstuvwxz")}function u(){return void 0===h&&(h=["ja","zh-CN","zh-TW","ja","ko"].indexOf(l.Z.i18n.getUILanguage())>-1),h}function g(e){const t=e.indexOf("&");if(-1===t||" "===e[t+1])return-1===t?-1:-2;if("&"!==e[t+1])return t;let n=1;for(let i=t+1;i<e.length&&"&"===e[i];i++)n++;return n%2==0?-1:t}function m(e,t,n,i,s){let o=0;for(;-1!==o;){const s=t.charAt(o),a=s.toUpperCase();if(-1!==i.indexOf(s)&&-1===e.indexOf(a)&&(0!==o&&!0!==n||s===a))return o;o=t.indexOf(" ",o+1),-1!==o&&o++}for(let n=0;n<t.length;n++){const s=t.charAt(n);if(-1!==i.indexOf(s)&&-1===e.indexOf(s.toUpperCase()))return n}return s?-1:m("",t,n,i,!0)}function v(e){return!!s.Z.isBrowserFeature(e.feature)||!e.commandName}function f(){return{enabled:a.Z.get(c.kKeyboardShortcutsEnable),singleKey:a.Z.get(c.kKeyboardShortcutsEnableSingleKey),mailSingleKey:a.Z.get(c.kKeyboardShortcutsEnableSingleKeyForMail)}}function y(e,t){if(t.enabled&&e.shortcuts&&!1!==e.showshortcut)for(let n=0;n<e.shortcuts.length;n++){const i=e.shortcuts[n];if(o.Z.isSingleKeyShortcut(i))if(v(e)){if(!1===t.singleKey)continue}else if(!1===t.mailSingleKey)continue;if(0!==i.length)return(0,d.G)(i)}return""}function w(e){return"separator"===e.type}function b(e){return"folder"===e.type}function C(e){return{label:e,labelEnglish:e}}function S(){return(0,r.Z)("...")}const T={commandItem:{type:"command",label:"",labelEnglish:""},ellipsisString:S,hasBrowserFeature:v,formatShortcut:function(e,t){return y({commandName:e,shortcuts:t,...C("")},f())},getDisplayName:function(e){if(w(e))return"";let t=e.labelWithMnemonic||e.label||"";return e.emphasized&&(t=`• ${t}`),e.ellipsis?t+S():t},getMenuBarString:function(e,t){if(!e.label)return{name:"",offset:-1};let n=u()?e.labelEnglish:e.label,i=void 0===t.offset?-1:t.offset;return u()&&(-1!==i?(n=e.label+" ("+n.charAt(i).toUpperCase()+")",i=n.length-2):n=e.label),{name:n,offset:i}},getShortcut:y,getShortcutSettings:f,getShortcutsForSubMenus:function(e){const t=Object.keys(i.Z.getCommandsForShortcuts()).filter((e=>e.includes("alt+")&&5===e.length)),n=p(),s=a.Z.get(c.kKeyboardShortcutsAltOpensMenu),o=[],r=[];e.forEach((e=>{if(e.mnemonic&&e.label&&!w(e)){const t=e.label.indexOf("&");if(-1!==t&&t+1<e.label.length){const n=e.label.toUpperCase().charCodeAt(t+1);-1===o.indexOf(n)&&o.push(n)}}}));for(let i=0;i<e.length;i++){const a=e[i];if(!a.label||!b(a)||!1===s||!1===a.mnemonic){r.push({index:i});continue}const l=u()?a.labelEnglish:a.label;if(void 0===l){r.push({index:i});continue}if(o.length>0){const e=l.indexOf("&");if(-1!==e&&e+1<l.length){const n=l.toUpperCase().charCodeAt(e+1),s=String.fromCharCode(n).toLowerCase(),o="alt+"+s;t.includes(o)?r.push({index:i,key:s,offset:e}):(r.push({index:i,shortcut:o,key:s,offset:e}),t.push(o));continue}}let d=!1;for(let e=0;e+1<l.length&&!d;e++){const s=l.toUpperCase().charCodeAt(e);if(-1!==o.indexOf(s))continue;const a=String.fromCharCode(s).toLowerCase();if(-1===n.indexOf(a))continue;const c="alt+"+a;t.includes(c)||(r.push({index:i,shortcut:c,key:a,offset:e}),t.push(c),d=!0)}d||r.push({index:i})}return r},installMnemonics:function e(t,n){const i=p(),s=0===l.Z.i18n.getUILanguage().indexOf("en"),o=u();let a="";for(let e=0;e<t.length;e++){const i=t[e];if(i.label)if(w(i)||!1===i.mnemonic){if(!1===i.mnemonic){const e=g(i.label);(e>=0||-2===e)&&(i.labelWithMnemonic=i.label.replace(/\&/g,"&&"))}}else if(n.length>e){const t=o?i.labelEnglish:i.label;let s=n[e].offset;void 0!==s&&s+1<=i.label.length?("&"===i.label[s]?i.labelWithMnemonic=i.label:i.labelWithMnemonic=o?i.label+" (&"+t.charAt(s).toUpperCase()+")":i.label.slice(0,s)+"&"+i.label.slice(s),a+=i.label.charAt(s+1).toUpperCase()):(s=i.label.indexOf("&"),i.labelWithMnemonic=-1!==s?i.label:void 0)}else{const e=g(i.label);e>=0&&e+1<i.label.length?(i.labelWithMnemonic=i.label,a+=i.label.charAt(e+1).toUpperCase()):i.labelWithMnemonic=-2===e?i.label.replace(/\&/g,"&&"):void 0}}for(let n=0;n<t.length;n++){const r=t[n];if(!r.label)continue;const l=o?r.labelEnglish:r.label;if(void 0!==l&&!w(r)&&!1!==r.mnemonic&&void 0===r.labelWithMnemonic){const e=m(a,l,s,i,!1);e>=0&&(a+=l.charAt(e).toUpperCase(),r.labelWithMnemonic=o?r.label+" (&"+l.charAt(e).toUpperCase()+")":r.label.slice(0,e)+"&"+r.label.slice(e))}r.items&&e(r.items,[])}},isSeparator:w,makeLabelPair:C,makeNumberMnemonic:function(e,t){const n=t<9&&!0;if(n){return{...C("&"+(t+1)+" "+e.replace(/\&/g,"&&")),mnemonic:n}}return{...C(e),mnemonic:n}},separatorItem:{type:"separator",label:"",labelEnglish:""}},I=T},40893:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var i=n(63353),s=n(29087),o=n(39206),a=n(90349),r=n(15489),l=n(7064),d=n(89175);const c={withPageSelection:async function(e,t){const n=i.Z.unsafeGetActivePage(e).id,s=await l.Z.utilities.getSelectedText(n),a=t?t.id:o.Z.getDefault(r.ZP.isIncognito(e))?.id;a&&await c.withTextAndEngine(e,s,a)},withTextAndEngine:async function(e,t,n){const i=o.Z.getById(n);if(t&&i){const n=s.Z.get(d.kPageSearchInBackground);await a.Z.goSearchURL(e,t,{inCurrent:r.ZP.isPopup(e),inBackground:n,useSearchEngine:i,addOpenerTabId:!0})}}},h=c},19486:(e,t,n)=>{"use strict";n.d(t,{Z:()=>f});var i=n(65792),s=n.n(i),o=n(93197),a=n(9719),r=n(29087),l=n(5264),d=n.n(l),c=n(42151),h=n(65741),p=n(89175);const u=["center","top","right","bottom","left"];function g(e,t,n,i,s){let o;for(let a=0;a<e[t].length;a++){const r=e[t][a];if(n===r[0]&&i===r[1]&&s===r[2]){o=a;break}}void 0===o?e[t].push([n,i,s,1]):e[t][o][3]++}function m(e){return 60*e.hours+e.minutes}const v={getDefaultTheme:()=>(0,c.Z)(r.Z.getDefault(p.kThemesSystem)[0]),getFallbackStyle:()=>v.createStyle(v.getDefaultTheme()),getTheme:e=>{const t=r.Z.get(p.kThemesPreview),n=v.getSystemThemes(),i=r.Z.get(p.kThemesUser),s=t.concat(n.concat(i));return(0,c.Z)(s.find((t=>t?.id===e)))},getThemeWithFallback:e=>e&&v.getTheme(e)||v.getDefaultTheme(),getPreview:()=>r.Z.get(p.kThemesPreview)&&r.Z.get(p.kThemesPreview)[0],getSystemThemes:()=>{const e=(0,c.Z)(r.Z.get(p.kThemesSystem)),t=r.Z.get(p.kThemesSystem);return e.forEach(((n,i)=>{const s=t.find((e=>e.id===n.id));s&&(e[i]=(0,c.Z)(s))})),e},getWindowControlColors:(e,t,n)=>{let i="";i=t.transparencyTabBar?"--colorImageTopFg":t.accentOnWindow&&n||!t.accentOnWindow&&!n?"--colorAccentFg":"--colorFg";const o=String(e[i]);if(s().valid(o)){return s()(o)}console.warn(`Unable to find style for ${o}`)},getWindowBackgroundColor:e=>{const t=String(e["--colorBg"]);if(s().valid(t)){return s()(t)}console.warn(`getWindowBackgroundColor: Unable to find style for ${t}`)},getImageVars:d()(12)((async(e,t)=>{const n={backgroundImage:"unset"};if(e)try{const i=await async function(e){const t=document.createElement("img"),n=new Promise(((e,n)=>{t.addEventListener("load",e,{once:!0}),t.addEventListener("error",n,{once:!0})}));return t.src=e,await n,t}(e),a=i.naturalHeight/window.devicePixelRatio,r=i.naturalWidth/window.devicePixelRatio,l=function(e){const t=document.createElement("canvas"),n=t.getContext("2d"),i=16,o=[15,31,47,63,79,95,111,127,143,159,175,191,207,223,239,255],a={center:[],top:[],right:[],bottom:[],left:[]};t.width=i,t.height=i,n.imageSmoothingEnabled=!1,n.drawImage(e,0,0,i,i);const r=n.getImageData(0,0,i,i).data;for(let e=0;e<r.length/4;e++){const t=4*e,n=r[t],s=r[t+1],l=r[t+2],d=o.includes(e),c=e>240,h=!d&&e%i==0;g(a,!c&&e<i?"top":c?"bottom":d?"right":h?"left":"center",n,s,l)}return u.reduce(((e,t)=>{a[t].sort(((e,t)=>t[3]-e[3]));const n=a[t][0];return e[t]=s()(n[0],n[1],n[2]),e}),{})}(i);switch(Object.assign(n,function(e){return Object.entries(e).reduce(((e,[t,n])=>{const i=t[0].toUpperCase()+t.slice(1),a=n.luminance()>o.$J,r=s().mix(n,a?o.Cj:o.E5),l=a?o.E5:o.Cj;return e[`--colorImage${i}Fg`]=l.css(),e[`--colorImage${i}FgAlpha`]=l.alpha(.6).css(),e[`--colorImage${i}FgAlphaHeaviest`]=l.alpha(.05).css(),e[`--colorImage${i}Bg`]=r.css(),e[`--colorImage${i}BgAlpha`]=r.alpha(.6).css(),e[`--colorImage${i}BgAlphaHeavy`]=r.alpha(.3).css(),e}),{})}(l)),n.backgroundImage=`url("${e}")`,t){case"stretch":n.backgroundSize="cover";break;case"center":n.backgroundSize=`${r}px ${a}px`,n.backgroundRepeat="no-repeat";break;case"repeat":n.backgroundSize=`${r}px ${a}px`}}catch(t){console.error("Error loading background image",e)}return n})),createStyleRoot:e=>":root {"+Object.entries(e).filter((([e,t])=>e.startsWith("--"))).map((([e,t])=>`${e}:${String(t)}`)).join(";")+";}",getPalette:(e,t)=>{const n=document.createElement("canvas"),i=t||16,s=n.getContext("2d"),o=[],a=[];n.width=i,n.height=i,s.imageSmoothingEnabled=!1,s.drawImage(e,0,0,i,i);const r=s.getImageData(0,0,i,i).data;for(let e=0;e<r.length/4;e++){const t=4*e,n=r[t],i=r[t+1],s=r[t+2];let a;if(!(0===r[t+3]||n>240&&s>240&&i>240)){for(let e=0;e<o.length;e++)if(n===o[e][0]&&i===o[e][1]&&s===o[e][2]){a=e;break}void 0===a?o.push([n,i,s,1]):o[a][3]++}}o.sort(((e,t)=>t[3]-e[3]));for(let e=0;e<Math.min(10,o.length);e++)a.push([o[e][0],o[e][1],o[e][2]]);return a},getTimerByDate:(e,t)=>{const n=60*e.getHours()+e.getMinutes(),i=(0,c.Z)(r.Z.get(p.kThemeScheduleTimeline)),s="next"===t?i.reduce(((e,t)=>[...e,t,{...t,hours:t.hours+24}]),[]).sort(((e,t)=>m(e)-m(t))).find((({hours:e,minutes:t})=>60*e+t>n)):i.reduce(((e,t)=>[...e,t,{...t,hours:t.hours-24}]),[]).sort(((e,t)=>m(t)-m(e))).find((({hours:e,minutes:t})=>60*e+t<=n));if(!s)throw new Error("ThemeUtilities: Error getting theme schedule.");return s},convertColorsToVariables:e=>{const t={};return Object.keys(e).forEach((n=>{t[`--${n}`]=e[n]})),t},createStyle:e=>{const t={...o.ZP.forTheme(e),...(0,a.ZP)(e.radius,e.simpleScrollbar)},n={};return e.transparencyTabBar?n["--colorTabBar"]="transparent":e.accentOnWindow?n["--colorTabBar"]="var(--colorAccentBg)":e.accentOnWindow||(n["--colorTabBar"]="var(--colorBg)"),Object.keys(t).forEach((e=>{n[`--${e}`]=t[e].toString()})),n},isThemeDark:e=>{const t=e["--colorBg"];return void 0!==t?s()(t).luminance()<=o.$J:(console.warn("Unable to determine if theme is dark",{style:e}),!1)},isThemeHighlightDark:e=>{const t=e["--colorHighlightBg"];return void 0!==t?s()(t).luminance()<=o.$J:(console.warn("Unable to determine if theme highlight is dark",{style:e}),!0)},isThemeAccentDark:e=>{const t=e["--colorAccentBg"];return void 0!==t?s()(t).luminance()<=o.$J:(console.warn("Unable to determine if theme accent is dark",{style:e}),!0)},isSystemThemeModified:e=>{const t=r.Z.getDefault(p.kThemesSystem).find((t=>t.id===e.id));return t||console.warn(e.id,"is not a valid system theme"),(0,h.default)(e,t)},createClassnames:(e,t)=>{const n=v.isThemeDark(t),i=v.isThemeHighlightDark(t),s=v.isThemeAccentDark(t);return{"theme-light":!n,"theme-dark":n,"hi-light":!i,"hi-dark":i,"acc-light":!s,"acc-dark":s,"color-behind-tabs-on":e.accentOnWindow,"color-behind-tabs-off":!e.accentOnWindow,"ui-transparent-tabs":e.transparencyTabs,"transparent-tabbar":e.transparencyTabBar,"bgimage-dark":"white"===t["--colorImageFg"],"bgimage-light":"black"===t["--colorImageFg"],"dim-blurred":e.dimBlurred,"simple-scrollbar":e.simpleScrollbar}}},f=v},93974:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(7064),s=n(77398);const o=(e=2,t)=>(n,i)=>{if(e<=1)return 0;if(t&&(n=(0,s.default)(n,t),i=(0,s.default)(i,t)),!n&&!i)return 0;if(!n&&0!==n)return 2===e?1:-1;if(!i&&0!==i)return 2===e?-1:1;if("number"==typeof n&&"number"==typeof i)return 2===e?n-i:i-n;const o=n.toString().localeCompare(i.toString());return o>0?2===e?1:-1:o<0?2===e?-1:1:0},a={treeSort:function(e,t=o(),n="children"){const i=e=>{for(const t of e){const e=t[n];Array.isArray(e)&&i(e)}e.sort(t)};i(e)},getDefaultComparator:o,toMenuSorting:function(e,t){let n,s;if(e===a.ASCENDING_SORT?n=i.Z.menubarMenu.SortOrder.ASCENDING:e===a.DESCENDING_SORT&&(n=i.Z.menubarMenu.SortOrder.DESCENDING),void 0!==n)switch(t){case"title":s=i.Z.menubarMenu.SortField.TITLE;break;case"url":s=i.Z.menubarMenu.SortField.URL;break;case"nickname":s=i.Z.menubarMenu.SortField.NICKNAME;break;case"description":s=i.Z.menubarMenu.SortField.DESCRIPTION;break;case"dateadded":s=i.Z.menubarMenu.SortField.DATEADDED}return{order:n,field:s}},NO_SORTING:1,ASCENDING_SORT:2,DESCENDING_SORT:3},r=a},19626:(e,t,n)=>{"use strict";n.d(t,{Fe:()=>l,pg:()=>d,fs:()=>r});var i=n(53576),s=n(7064),o=n(36436);const a=["ad_blocking","tracking"],r=(e,t,n,s)=>{const o={tracking:{process:!1,exempt:!1},ad_blocking:{process:!1,exempt:!1}};if(parseInt(t)!==s)switch(t){case"0":o.tracking.exempt=!0,o.ad_blocking.exempt=!0;break;case"1":o.tracking.process=!0,o.ad_blocking.exempt=!0;break;case"2":o.tracking.process=!0,o.ad_blocking.process=!0}Object.keys(o).forEach((t=>{o[t].process?c(e,t,"process_list"):h(e,t,"process_list"),o[t].exempt?c(e,t,"exempt_list"):h(e,t,"exempt_list")})),"number"==typeof n&&i.Z.reloadPage(n)},l=(e,t,n)=>{if((0,o.xl)(t))return;const{hostname:i}=new URL(t);s.Z.contentBlocking.getAllExceptionLists((t=>{let s=0;a.forEach((e=>{t[e].process_list.find((e=>{i.includes(e)&&s++}))}));let o="0";switch(n){case"ad_blocking":o=0===s||1===s?"2":"0";break;case"tracking":o=2===s||0===s?"1":"0";break;default:return}r(i,o,e)}))},d=(e,t)=>{s.Z.contentBlocking.getActiveExceptionsList(e,(n=>{t({["tracking"===e?"trackerBlockingEnabled":"adBlockingEnabled"]:"exempt_list"===n})}))},c=(e,t,n)=>{s.Z.contentBlocking.addExceptionForDomain(t,n,e)},h=(e,t,n)=>{s.Z.contentBlocking.removeExceptionForDomain(t,n,e)}},84675:(e,t,n)=>{"use strict";n.d(t,{Z:()=>v});var i=n(29717),s=n(55022),o=n(63353),a=n(68247),r=n(29087),l=n(56371),d=n(7064),c=n(90808),h=n(89175),p=n(89555),u=n(8684);let g;const m={captureActivePage:async(e,t)=>{const n=o.Z.getActivePage(e);if(n){const e=r.Z.get(h.kWebpagesCaptureCompressionFormat),{success:i}=await m.captureFullpage(n.id,e,t);i&&"clipboard"===t&&(0,u.c)({title:(0,l.Z)("Page Captured"),body:(0,l.Z)("Image stored in the clipboard.")})}},captureArea:async(e,t)=>{i.Z.enableCapture(e);try{return a.Z.set(h.kWebpagesCaptureSaveLocation,t),await m.beginCaptureArea()}catch(e){return""}},captureFullpage:(e,t,n)=>{const i={encodeFormat:t,encodeQuality:85,fullPage:!0,height:3e4,saveToDisk:"file"===n,showFileInPath:"file"===n,copyToClipboard:"clipboard"===n,saveFilePattern:r.Z.get(h.kWebpagesCaptureSaveFilePattern)};return new Promise((t=>{d.Z.thumbnails.captureTab(e,i,((e,n)=>{t({success:e,image:n})}))}))},beginCaptureArea:()=>new Promise(((e,t)=>{g?t("Capture in Progress"):g=(n,i)=>{n&&t("Capture Cancelled"),e(i)}})),performCapture:(0,c.Z)(((e,t,n)=>{m.beginCaptureArea().then((n=>{m.handleCaptureLocation(e,t,n)})).catch(p.default),i.Z.disableCapture(e),m.doCapture(e,n)}),25),doCapture:(e,t)=>{const{x:n,y:i,width:s,height:o}=t,a=r.Z.get(h.kWebpagesCaptureSaveLocation),l=r.Z.get(h.kWebpagesCaptureCompressionFormat),c=r.Z.get(h.kWebpagesCaptureSaveFilePattern),p="note"===a,u="clipboard"===a;d.Z.thumbnails.captureUI({windowId:e,posX:n,posY:i,width:s,height:o,encodeFormat:l,encodeQuality:85,saveToDisk:!0!==p,showFileInPath:!0!==p,copyToClipboard:u,saveFilePattern:c},((e,t)=>{g&&(g(!e,t),g=void 0)}))},handleCaptureLocation:async(e,t,n)=>{const i=r.Z.get(h.kWebpagesCaptureSaveLocation);if("clipboard"===i){const e="area"===t?"Area":"Page";(0,u.c)({title:(0,l.Z)("$1 Captured",[e]),body:(0,l.Z)("Image Stored in the Clipboard")})}else"note"===i&&n&&await s.Z.createNoteFromCapture(e,n)},cancelCallback:e=>{i.Z.disableCapture(e),g&&(g(!0,""),g=void 0)}},v=m},21191:(e,t,n)=>{"use strict";n.d(t,{Jq:()=>r,jD:()=>d,Ed:()=>c});var i=n(39005),s=n(30626),o=n(7064),a=n(4668);function r(e,t){const n=i.Z.getRaw();if(n){const e=i.Z.getActiveListEntry(),t=e?(0,a.BZ)(e.subject):"message";n.saveAs(t+".eml")}else s.Z.getActiveWebView(e)&&o.Z.utilities.savePage(t)}const l=["COMMAND_NEW_BACKGROUND_TAB_LINK","COMMAND_NEW_TAB_LINK"];function d(e){return l.includes(e)}function c(e){return false}},47380:(e,t,n)=>{"use strict";n.d(t,{m:()=>m,Z:()=>b});var i=n(44147),s=n(76747),o=n(65810),a=n(62077),r=n(72536),l=n(92292),d=n(9414),c=n(86635),h=n(68551),p=n(13253),u=n(89661),g=n(7064);const m=e=>({windowId:e,keyState:{ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,key:""}});let v={x:0,y:0,width:0,height:0},f="topLeft",y="none",w=null;const b=function(e,t,n,m="pointer",b,C=-1){const S=s.Z.getShortcutSettings();let T=0;const I=new Map,k=function(t){const n=I.get(t.id);if(n){const i={windowId:e,keyState:{shiftKey:t.state.shift,ctrlKey:t.state.ctrl,altKey:t.state.alt,metaKey:t.state.command,key:""}};t.state.left?i.button=0:t.state.right?i.button=2:t.state.center&&(i.button=1),n(i)}},A=function(t){y="none",i.Z.onHover(e,""),g.Z.menubarMenu.onOpen.removeListener(Z),g.Z.menubarMenu.onClose.removeListener(E),g.Z.menubarMenu.onHover.removeListener(i.Z.onHover),g.Z.menubarMenu.onAction.removeListener(k);const n=w;n&&(w=null,t||n())},Z=function(){y="shown","function"==typeof n&&n(!0)},E=function(){"function"==typeof n&&n(!1),A(!1)},_=function(t){return t.filter((t=>"function"==typeof t.testVisibility?t.testVisibility(e):!1!==t.visible)).map((e=>{const t={};if(s.Z.isSeparator(e))t.separator={};else if("container"===e.type){if(e.container)switch(e.container.content){case"extensions":case"imageinprofile":case"linkinprofile":case"notes":case"pwa":case"linkinpwa":case"sendpagetodevices":case"sendlinktodevices":case"speech":case"spellcheck":case"spellcheckoptions":const n=T++;t.container={id:n,content:e.container.content,mode:e.container.mode||"folder",name:s.Z.getDisplayName(e)};break;default:console.warn("Unknown container content",e.container.content)}}else{const n=T++,i=s.Z.getDisplayName(e);let o,a;switch(e.handler&&(i||e.url)&&I.set(n,e.handler),e.commandName&&0===e.commandName.indexOf("DOCUMENT_")&&(o=e.commandName),(e.iconPNG||e.iconPNGWhite)&&(a=[e.iconPNG||"",e.iconPNGWhite||""]),e.type){case"checkbox":case"radio":t.item={id:n,action:o,name:i,type:e.type,radiogroup:e.radiogroup?e.radiogroup:-1,checked:!(!e.checked||e.statestrings)&&e.checked,shortcut:s.Z.getShortcut(e,S),showshortcut:e.showshortcut,url:e.url,enabled:e.enabled,icons:a};break;default:t.item={id:n,action:o,name:i,type:e.items?"folder":"command",shortcut:s.Z.getShortcut(e,S),showshortcut:e.showshortcut,url:e.url,enabled:e.enabled,icons:a},e.items&&(t.children=_(e.items))}}return t}))},N=function(n){if("none"!==y)return void("shown"===y?w=N.bind(null,n):console.error("Attempt to show another context menu while one is initializing"));const o="function"==typeof t?t():t;0!==o.length&&(y="initializing",s.Z.installMnemonics(o,[]),g.Z.menubarMenu.onOpen.addListener(Z),g.Z.menubarMenu.onClose.addListener(E),g.Z.menubarMenu.onHover.addListener(i.Z.onHover),g.Z.menubarMenu.onAction.addListener(k),g.Z.contextMenu.show({windowId:e,documentId:C,rect:v,origin:f,icons:[d.Z,c.Z,h.Z,p.Z,u.Z,a.Z,r.Z],children:_(o)},(()=>{const e=l.Z.runtime.lastError;e&&(console.error(e.message),A(!0))})))};return function(e){e&&e?.nativeEvent?.path?.find((e=>"vivaldi-tooltip"===e.id))||o.Z.hideTooltip(),e&&(e.persist(),e.preventDefault(),e.stopPropagation());if(v={x:0,y:0,width:0,height:0},f=m,"pointer"===m)v.x=e?e.clientX:0,v.y=e?e.clientY:0;else{let t=b?b.getBoundingClientRect():null;!t&&e&&(t=e.nativeEvent.srcElement.getBoundingClientRect()),t&&(v.x=t.left+1,v.y=t.top,v.width=t.width,v.height=t.height)}N(e)}}},86662:(e,t,n)=>{"use strict";n.d(t,{A:()=>a,P:()=>r});var i=n(39180),s=n(26470),o=n.n(s);function a(e){return"win"===i.Z.call()?function(e){return 1===e.indexOf(":")&&e.match(/^[a-z]/gi)||0===e.indexOf("/")||0===e.indexOf("\\")}(e):function(e){return 0===e.indexOf("/")}(e)}function r(e){return"win"===i.Z.call()?function(e){let t=o().resolve(e).replace(/\\/g,"/");return"/"!==t[0]&&(t="/"+t),encodeURI(t)}(e):function(e){return encodeURI(o().resolve(e))}(e)}},26036:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(56371);const s="Ð";function o(e,t,n){const o=Array.from(arguments);o[0]=s+o[0];let a=(0,i.Z)(...o);return a.startsWith(s)&&(a=a.substr(1)),{label:(0,i.Z)(...arguments),labelEnglish:a}}},97781:(e,t,n)=>{"use strict";n.d(t,{ZR:()=>l,Gx:()=>d,Nw:()=>y,o6:()=>T});var i=n(27856),s=n.n(i),o="https://240.0.0.0/?url=",a=/(url\("?)(?!data:)/gim;const r="lang",l="type",d="name";function c(e,t){for(var n=t.length-1;n>=0;n--){if(t[t[n]]){var i=t[t[n]].replace(a,"$1"+o);t[t[n]]=i}t[t[n]]&&e.push(t[n]+":"+t[t[n]]+";")}}function h(e,t){for(var n=t.length-1;n>=0;n--){var i=t[n];if(1===i.type&&i.selectorText)e.push(i.selectorText+"{"),i.style&&c(e,i.style),e.push("}");else if(i.type===i.MEDIA_RULE)e.push("@media "+i.media.mediaText+"{"),h(e,i.cssRules),e.push("}");else if(i.type===i.FONT_FACE_RULE)e.push("@font-face {"),i.style&&c(e,i.style),e.push("}");else if(i.type===i.KEYFRAMES_RULE){e.push("@keyframes "+i.name+"{");for(var s=i.cssRules.length-1;s>=0;s--){var o=i.cssRules[s];8===o.type&&o.keyText&&(e.push(o.keyText+"{"),o.style&&c(e,o.style),e.push("}"))}e.push("}")}}}const p=function(e,t){if("style"===t.tagName){var n=[];e.sheet&&h(n,e.sheet.cssRules),e.textContent=n.join("\n")}};var u=["action","background","poster","src"];let g=!1;const m=function(e){if(u.forEach((t=>{e.hasAttribute(t)&&!/^(data|blob):/i.test(e.getAttribute(t))&&(g=!0,e.removeAttribute(t))})),e.hasAttribute("style")){for(var t=e.style,n=[],i=t.length-1;i>=0;i--){if(e.style[t[i]]&&a.test(e.style[t[i]])){var s=e.style[t[i]].replace(a,"$1"+o);e.style[t[i]]=s}n.push(t[i]+":"+e.style[t[i]]+";")}n.length?e.setAttribute("style",n.join("")):e.removeAttribute("style")}},v=function(e){"target"in e&&e.setAttribute("target","_blank"),e.hasAttribute("target")||!e.hasAttribute("xlink:href")&&!e.hasAttribute("href")||e.setAttribute("xlink:show","new")},f=function(e,t){const n=e[t.src];if(n){const e=new Blob([n.content],{type:n.mimeType});t.setAttribute(r,t.src),t.setAttribute("src",URL.createObjectURL(e)),n.inUse=!0}};function y(e,t){const n=t&&t.attachments||{};let i=!0;t&&t.hasOwnProperty("blockHTTPLeaks")&&(i=t.blockHTTPLeaks),s().addHook("afterSanitizeAttributes",v),s().addHook("afterSanitizeAttributes",f.bind(void 0,n)),i&&(s().addHook("afterSanitizeAttributes",m),s().addHook("uponSanitizeElement",p)),g=!1;const o=s().sanitize(e,{ADD_TAGS:["iframe"],ADD_ATTR:["allowfullscreen"],ALLOW_UNKNOWN_PROTOCOLS:!0,FORBID_TAGS:i?["svg"]:[],WHOLE_DOCUMENT:!0});return s().removeHooks("afterSanitizeAttributes"),s().removeHooks("uponSanitizeElement"),{sanitized:o,leakPrevented:g}}function w(){return Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString()}let b=[],C=[];function S(e){if("string"==typeof e.src)if(e.src.startsWith("blob:")){const t=e.getAttribute(r);if(t)b.push(t),e.removeAttribute(r),e.setAttribute("src",t);else{const t=w();C.push({dataOrBlobUrl:e.src,cid:t,mimeType:e.getAttribute(l),filename:e.getAttribute(d)}),e.setAttribute("src","cid:"+t),e.removeAttribute(l),e.removeAttribute(d)}}else if(e.src.startsWith("data:image/")){const t=w(),n=e.src.match(/^data:([^,;]+)/)[1];C.push({dataOrBlobUrl:e.src,cid:t,mimeType:n,filename:""}),e.setAttribute("src","cid:"+t)}}function T(e){s().addHook("afterSanitizeAttributes",S);const t={blobFreeHTML:s().sanitize(e,{ALLOW_UNKNOWN_PROTOCOLS:!0,WHOLE_DOCUMENT:!0}),cidsInUse:b,newImages:C};return s().removeHooks("afterSanitizeAttributes"),b=[],C=[],t}},721:(e,t,n)=>{"use strict";n.d(t,{VV:()=>o,S2:()=>a,Mr:()=>r,Np:()=>l,mT:()=>d,Kz:()=>c});var i=n(84847),s=n(7064);function o(e){return!(e.altKey||e.shiftKey||e.ctrlKey||e.metaKey)}function a(e){return e.altKey&&!e.shiftKey&&!e.ctrlKey&&!e.metaKey}function r(e){return!e.altKey&&e.shiftKey&&!e.ctrlKey&&!e.metaKey}function l(e){return!e.altKey&&!e.shiftKey&&e.ctrlKey&&!e.metaKey}function d(e){const{altKey:t,shiftKey:n,ctrlKey:i,metaKey:s}=e;return!t&&!n&&i&&!s}const c=function(){let e=!1;return function(t,n){(0,i.Z)(t)?!0!==e&&(e=!0,s.Z.tabsPrivate.onKeyboardChanged.addListener((function i(o,a,r,l){!a&&function(e,t){const n={ctrlKey:[17],altKey:[18],metaKey:[91,93]};return Object.keys(n).filter((t=>e)).filter((e=>-1!==n[e].indexOf(t))).some(Boolean)}(t,l)&&(e=!1,n(),s.Z.tabsPrivate.onKeyboardChanged.removeListener(i))}))):n()}}()},15048:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={3:"Break",8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"Capslock",27:"Escape",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",41:"Select",42:"Print",43:"Execute",44:"PrintScreen",45:"Insert",46:"Del",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",58:":",59:"None",60:"<",61:"=",63:"ß",64:"@",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",91:"Meta",92:"None",93:"Meta",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9",106:"*",107:"+",108:",",109:"-",110:".",111:"/",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",124:"F13",125:"F14",126:"F15",127:"F16",128:"F17",129:"F18",130:"F19",131:"F20",132:"F21",133:"F22",134:"F23",135:"F24",144:"NumLock",145:"Scrolllock",160:"^",161:"!",163:"#",164:"$",165:"None",166:"BrowserBack",167:"BrowserForward",169:")",170:"*",171:"+",173:"None",174:"None",175:"None",176:"Next",177:"Previous",178:"Stop",179:"None",180:"None",181:"None",182:"None",183:"None",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"None",193:"None",194:".",219:"[",220:"\\",221:"]",222:"'",223:"`",224:"Meta",225:"AltGraph",226:"None",230:"None",233:"None",234:"None",255:"None"}},13302:(e,t,n)=>{"use strict";function i(e){return Array.isArray(e)&&(e=e.join(", ")),e&&(e=(e=e.replace(/left/g,"←").replace(/right/g,"→").replace(/up/g,"↑").replace(/down/g,"↓")).replace(/(^|\+)(\w)/g,(e=>e.toUpperCase()))),e}function s(e){return Array.isArray(e)&&(e=e.join(", ")),e&&(e=e.replace(/(^|\+)(\w)/g,(e=>e.toUpperCase()))),e}n.d(t,{$:()=>i,G:()=>s})},45660:(e,t,n)=>{"use strict";n.d(t,{a:()=>c,Z:()=>p});n(20244);var i=n(17751),s=n(29087),o=n(88212),a=n(89175),r=n(89555),l=n(34155);function d(e,t){let n;switch(e){case"log":case"info":n=["debug","info"].includes(t)?console.log:null;break;case"warn":n=["debug","info","warn"].includes(t)?console.warn:null;break;case"error":n=["debug","info","warn","error"].includes(t)?console.error:null}return(t,...s)=>{const[a,r]=(0,o.NJ)(s);n&&n(...(0,o.Zr)(t,a),...r),l.nextTick((()=>i.Z.log({timestamp:Date.now(),level:e,component:t,tags:a,args:r})))}}function c(){h(),s.Z.addListener(a.kBiscuitLogLevel,h)}function h(){const e=s.Z.get(a.kBiscuitLogLevel)||"info";o.kg.debug="debug"===e?console.log:r.default,o.kg.log=d("info",e),o.kg.info=o.kg.log,o.kg.warn=d("warn",e),o.kg.error=d("error",e)}const p=o.kg},60007:e=>{let t=!0;const n=(e,t)=>{const n=e[t].level-1;for(let i=t-1;i>=0;i--)if(e[i].level===n)return i;return-1};e.exports=(e,i)=>{i&&(t=!0===i.enabled),e.block.ruler.after("list","todo",((e,t,n)=>{const i=((e,t)=>{const n=e.bMarks[t]+e.blkIndent,i=e.eMarks[t];return e.src.substr(n,i-n)})(e,t);return"list"===e.parentType&&("[ ]"===i.substring(0,3)||"[x]"===i.substring(0,3).toLowerCase())&&(e.tokens.push({type:"todo",content:i,block:!0,lines:[t],level:e.level}),e.line=t+1,!0)}),{}),e.renderer.rules.todo=(e,i,s)=>((e,i,s)=>{const o=e[i],a=e[i-1],r=e[n(e,i-1)];let l=o.content;if(a&&"list_item_open"===a.type&&r&&"bullet_list_open"===r.type){const e=1===l.toLowerCase().indexOf("x");return l=l.slice(3).trim(),'<input type="checkbox"'+(e?" checked":"")+(t?"":" disabled")+" />"+l}return l})(e,i);const s=e.renderer.rules.list_item_open;e.renderer.rules.list_item_open=(e,t,i,o)=>{const a=e[t+1],r=e[n(e,t)];return r&&"bullet_list_open"===r.type&&a&&"todo"===a.type?'<li class="todo">':s(e,t,i,o)}}},4027:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={kNone:-1,kLeft:0,kCenter:1,kRight:2,kBack:3,kForward:4,isContextMenuButton:e=>2===e,isNavigationButton:e=>3===e||4===e,isNoModifierPressed:e=>!(e.altKey||e.shiftKey||e.ctrlKey||e.metaKey),setWebviewPointerEvents:(e,t)=>{const n=e?"":"none";for(const e of t.getElementsByTagName("WEBVIEW"))e.style.pointerEvents=n}}},81157:(e,t,n)=>{"use strict";function i(e){e.preventDefault(),e.stopPropagation()}function s(e){e.stopPropagation()}n.d(t,{Z:()=>i,U:()=>s})},8684:(e,t,n)=>{"use strict";n.d(t,{c:()=>i});function i(e){const t=new Notification(e.title,{body:e.body,icon:e.icon?e.icon:"/resources/icon_notifications.png",silent:Boolean(e.silent),requireInteraction:Boolean(e.requireInteraction)});t.onclick=()=>{e.onClick&&e.onClick(),t.close()},e.requireInteraction||setTimeout((()=>t.close()),e.timeout||5e3)}},51370:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(85834),s=n(78614);function o(e){try{return(0,i.Mf)(decodeURIComponent(e))}catch(e){return""}}function a(e){const[,t]=e.split(":",2),[n,i=""]=t.split("?",2),a={to:(0,s.D$)(o(n))};return i.split("&").forEach((e=>{["cc","bcc"].filter((t=>e.startsWith(t+"="))).forEach((t=>{const n=o(e.substr(t.length+1));a[t]=(0,s.D$)(n)})),["body","subject"].filter((t=>e.startsWith(t+"="))).forEach((t=>a[t]=o(e.substr(t.length+1))))})),a}},82394:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(39206);function s(e){return e.map((({keywordId:e,terms:t,url:n,title:s})=>{let o;if("-1"!==e){const n=i.Z.getById(e);o=n?`${n.keyword} ${t}`:`? ${t}`}return{...o?{text:o}:null,url:n,title:s,type:"OMNI_RESULT_TYPED_HISTORY",id:n}}))}},80419:(e,t,n)=>{"use strict";n.d(t,{g:()=>o});var i=n(7064);let s=!1;function o(e,t,n){function o(e){s=!1,n.removeEventListener("mouseup",l),n.removeEventListener("mousedown",l),i.Z.tabsPrivate.onKeyboardChanged.removeListener(a),i.Z.tabsPrivate.onTabSwitchEnd.removeListener(r),t(e)}function a(e,t,n,i){!0===t?27===i&&o(!0):!1===t&&(17!==i&&18!==i&&13!==i||o(!1))}function r(){o(!1)}function l(e){if(e.target){const t=e.target.classList;if("mousedown"===e.type&&0===e.button&&t&&["visual-tab","visual-list","visual-list-preview"].includes(t)||"audioicon"===e.target.className)return}(2===e.button||e.button<=1&&e.buttons<=2)&&(e.preventDefault(),e.stopPropagation(),o(!1))}!0!==s&&(s=!0,n.addEventListener("mouseup",l),n.addEventListener("mousedown",l),i.Z.tabsPrivate.onKeyboardChanged.addListener(a),i.Z.tabsPrivate.onTabSwitchEnd.addListener(r))}},36436:(e,t,n)=>{"use strict";n.d(t,{kO:()=>c,OI:()=>g,DP:()=>m,uu:()=>v,q9:()=>f,K2:()=>y,Ph:()=>b,Rz:()=>C,Zj:()=>S,Sc:()=>T,tn:()=>I,xl:()=>k,to:()=>A,Li:()=>Z,Fn:()=>E,C3:()=>_,Iw:()=>N,Qj:()=>M,HZ:()=>P,Ei:()=>D,Dy:()=>x});var i=n(5264),s=n.n(i),o=n(17673),a=n(8575),r=n(1407),l=n(86662);const d=["vivaldi:","chrome:","chrome-extension:"],c=["about:","data:","javascript:","view-source:","webcal:"],h=[...d,...c,"file://","ftp://","http://","https://"],p=[...d,"ftp://","http://","https://"],u="http";function g(e){return N(e).split("?")[0].split("#")[0]}function m(e){const t=e?e.split("?"):[];try{return t.length>1?o.parse(t[1]):{}}catch(e){return console.warn(e),{}}}function v(e,t,n){const i=N(e.toLocaleLowerCase()),s=N(t.toLocaleLowerCase());return n?i&&s&&g(i)===g(s):i&&s&&i===s}function f(e){if(!e.trim())return"";if((0,l.A)(e))return a.format({host:(0,l.P)(e),protocol:"file"});const t=a.parse(e);if(!t.protocol){const t=a.format({host:e,protocol:u});return a.parse(t).format()}if(!t.slashes&&!h.includes(t.protocol)){const t=a.format({host:e,protocol:u});return a.parse(t).format()}return t.format()}function y(e){const t=a.parse(e),n=parseInt(t.port);return!!(t.protocol&&t.host&&t.slashes&&(null===t.port||n>=0&&n<=65535))}const w=new RegExp(`^(//|${h.join("|")})`,"g");function b(e){return e.replace(w,"")}const C=f;function S(e){return e=e.toLowerCase(),!h.some((t=>e.startsWith(t)))}function T(e){return e=e.toLowerCase(),c.some((t=>e.startsWith(t)))}function I(e){return e=e.toLowerCase(),["file:","localhost:"].some((t=>e.startsWith(t)))}function k(e){const t=a.parse(e).protocol;return!!t&&d.some((e=>-1!==e.indexOf(t)))}const A=s()(100)(k);function Z(e){return e.startsWith("/resources/")}function E(e){if(e.includes(r.oP)){const t=r.oP+"/browser.html#";e=e.includes(t)?e.substr(t.length-1,e.length):"http://"+e.substr(r.oP.length+1,e.length)}else e.match(/^[a-zA-Z]+:\/\//)||(e="http://"+e);return e}function _(e){if(0===e.length)return!1;const t=e.endsWith("."),n=/^localhost/.test(e),i=!e.includes(" ")&&e.indexOf(".")>0,s=!S(e)&&""!==b(e),o=f(e),a=p.find((e=>o.startsWith(e)))||"a^";if(RegExp(`(${a}).+:`).test(o)){const e=o.lastIndexOf(":")+1,t=parseInt(o.substring(e,o.length));return t>=0&&t<=65535}return!t&&(n||i||s)}function N(e){return e.replace(/^\/+|\/+$/gm,"")}function M(e){return"/"===e[e.length-1]?e.substring(0,e.length-1):e}function P(e){return O.test(e)}function D(e,t){return e.includes(".")?e:`${e}.${t}`}function x(e){return e.replace(/\s/g,"").replace(/^([a-z]+?:\/?\/?[^\/]*)\/*?(\/[\?#].*)?$/,"$1$2")}const O=/^(([^/<>()\[\]\.,;:\s@\"]+(\.[^/<>()\[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^/<>()[\]\.,;:\s@\"]{2,})$/i},7065:(e,t,n)=>{"use strict";n.d(t,{OK:()=>d,ZP:()=>h});var i=n(62830),s=n.n(i),o=n(35369),a=n(69046),r=n(65741),l=n(44850);function d(e){const t=e.id;if(void 0===t)throw new Error("Chrome.tabToPage: tab ID missing");const n={ext_id:s()()},i=(0,a.SJ)({id:t,vivExtData:n});return c(o.aV.of(i),t,e).first()}function c(e,t,n){const i=e.findIndex((e=>e.id===t));if(-1===i)return e;for(const[t,a]of Object.entries(n))switch(t){case"vivExtData":if("string"!=typeof a)continue;try{const t=e.getIn([i,"vivExtData"])??{ext_id:s()()},n=JSON.parse(a);"string"==typeof n.tiling&&delete n.tiling,(0,r.default)(t,n)||(e=e.setIn([i,"vivExtData"],n))}catch(e){}break;case"active":e=e.setIn([i,"active"],a),a&&(e=e.setIn([i,"unread"],!1));break;case"pendingUrl":case"url":if("string"!=typeof a)continue;if("url"===t&&n.pendingUrl)continue;e=(e=(e=e.setIn([i,"isMailPage"],l.jk.isMailPage(a))).setIn([i,"url"],(o=a).startsWith("vivaldi://")?l.jk.getUrl(o):o)).setIn([i,"target"],void 0);break;case"favIconUrl":if("string"!=typeof a)continue;e=e.setIn([i,"favIconUrl"],a);break;case"index":case"windowId":case"openerTabId":case"pinned":case"audible":case"title":case"incognito":case"sessionId":case"discarded":e=e.setIn([i,t],a)}var o;return e}const h={tabToPage:d,updatePage:c}},69046:(e,t,n)=>{"use strict";n.d(t,{av:()=>s,jA:()=>o,SJ:()=>r});var i=n(35369);function s(e){return e.vivExtData.group}function o(e){return e.vivExtData.tiling?.id}class a extends((0,i.WV)({id:0,index:-1,windowId:void 0,openerTabId:null,active:!1,pinned:!1,audible:"",discarded:!1,url:"",title:"",favIconUrl:"",incognito:"",sessionId:"",vivExtData:{ext_id:""},target:void 0,favIcon:"",imageLoading:"always",showImageInspector:!1,mimeType:"text/html",originUrl:"",unread:!0,isInspected:!1,isMailPage:!1,supportsReaderMode:!1})){}function r(e){return new a(e)}},39206:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var i=n(68247),s=n(29087),o=n(15672),a=n(7064),r=n(89175),l=n(8575);const d=new Set;let c={templateUrls:[],defaultSearch:"",defaultPrivate:"",defaultSearchField:"",defaultSearchFieldPrivate:"",defaultSpeeddials:"",defaultSpeeddialsPrivate:"",defaultImage:""};const h={load:async()=>{a.Z.searchEngines.onTemplateUrlsChanged.addListener(h._onTemplateUrlsChanged),await h._onTemplateUrlsChanged();const e=await a.Z.utilities.takeMutex("searchEnginesMigration");try{await h._migrateOldSearches()}finally{a.Z.utilities.releaseMutex(e)}},_onTemplateUrlsChanged:async()=>{try{c=await a.Z.searchEngines.getTemplateUrls()}catch(e){console.log("Failed loading template URLs:"+e)}d.forEach((e=>e()))},get:()=>c.templateUrls,getByKeyword:e=>c.templateUrls.find((t=>t.keyword===e)),getByQuery:e=>c.templateUrls.find((t=>e.toLowerCase().startsWith(t.keyword+" "))),isDefault:(e,t)=>t?c.defaultPrivate===e:c.defaultSearch===e,isRemovable:e=>c.defaultSearch!==e&&c.defaultPrivate!==e&&c.defaultImage!==e,getDefault:e=>h.getById(e?c.defaultPrivate:c.defaultSearch),getSearchField:e=>h.getById(e?c.defaultSearchFieldPrivate:c.defaultSearchField),getSpeeddialsSearch:e=>h.getById(e?c.defaultSpeeddialsPrivate:c.defaultSpeeddials),getImageSearch:()=>h.getById(c.defaultImage),getById:e=>c.templateUrls.find((t=>t.id===e)),getByPrepopulateId:e=>c.templateUrls.find((t=>t.prepopulateId===e)),addListener:e=>{d.add(e)},removeListener:e=>{d.delete(e)},_migrateOldSearches:async()=>{const e={Google:1,"Yahoo!":2,Bing:3,Ecosia:4,"Startpage.com":5,Wikipedia:6,DuckDuckGo:7,Яндекс:8,Neeva:9,"Wolfram|Alpha":10,OZON:11,Amazon:12,eBay:13,"Поиск Mail.ru":14,Qwant:15};async function t(e){const[t,n]=e.post?function(e){const t=(0,l.parse)(e,!1);return[t.href.replace(t.search||"","")||"",t.query?t.query.replace("&",","):""]}(e.url):[e.url,""];if(""===t)return"";const i={id:"",extensionId:"",readOnly:!1,name:e.name,keyword:e.keyword?e.keyword:await a.Z.searchEngines.getKeywordForUrl(t),faviconUrl:e.faviconUrl,url:t,postParams:n,suggestUrl:e.suggestUrl??"",suggestPostParams:"",imageUrl:"",imagePostParams:"",prepopulateId:0},s=h.getByKeyword(e.keyword);if(s){if(i.url===s.url&&i.postParams===s.postParams&&i.suggestUrl===s.suggestUrl)return s.id;let t=1;const n=e.keyword;let o="";do{o=`${n}${t}`,t++}while(h.getByKeyword(o));0!==s.prepopulateId?(s.keyword=o,a.Z.searchEngines.updateTemplateUrl(s)):i.keyword=o}return await a.Z.searchEngines.addTemplateUrl(i)}let n=[...s.Z.get(r.kChainedCommandsCommandList)];function d(e,t,i){var s,o;s=t,o=i,n=n.map((e=>{const t=e.chain.map((e=>{const{key:t,param:n}=e;return"3a8efd62-4c8a-4545-8a6c-9cb65518f507"===t&&n===s?{...e,param:o}:{...e}}));return{...e,chain:[...t]}}));const r=e.default===t,l=e.defaultPrivate===t;r&&a.Z.searchEngines.setDefault("defaultSearch",i),l&&(a.Z.searchEngines.setDefault("defaultPrivate",i),a.Z.searchEngines.setDefault("defaultSpeeddialsPrivate",i)),(!e.current&&r||e.current===t)&&a.Z.searchEngines.setDefault("defaultSearchField",i),(!e.currentSD&&r||e.currentSD===t)&&a.Z.searchEngines.setDefault("defaultSpeeddials",i),(!e.currentPrivate&&l||e.currentPrivate===t)&&a.Z.searchEngines.setDefault("defaultSearchFieldPrivate",i)}const c=o.Z.getSync("SEARCH_ENGINE_COLLECTION"),p=o.Z.getDefaultSearchEngines();if(void 0===c)return;for await(const n of p.engines){const i=c.engines.find((e=>e.id===n.id));if(!i)continue;const s=e[i.name],o=h.getByPrepopulateId(s);if(!0===i.removed)o&&a.Z.searchEngines.removeTemplateUrl(o.id);else{if(i.custom&&o){if(i.url!==(n.url||"")||i.suggestUrl!==(n.suggestUrl||"")||i.name!==(n.name||"")||i.post!==Boolean(n.post)){const e=await t(i);""!==e&&d(c,i.id,e);continue}o.keyword=i.keyword,a.Z.searchEngines.updateTemplateUrl(o)}c.defaultChanged&&o&&d(c,i.id,o.id)}}const u=c.engines.map((e=>(-1!==p.engines.findIndex((t=>t.id===e.id))||!1!==Boolean(e.custom)||c.default!==e.id&&c.defaultPrivate!==e.id||(e.custom=!0),e))).filter((e=>-1===p.engines.findIndex((t=>t.id===e.id))&&!1!==Boolean(e.custom)&&!0!==Boolean(e.removed)));for await(const e of u){const n=await t(e);""!==n&&d(c,e.id,n)}await new Promise((e=>{o.Z.remove("SEARCH_ENGINE_COLLECTION",(()=>{i.Z.set(r.kChainedCommandsCommandList,n),e()}))}))}},p=h},20244:(e,t,n)=>{"use strict";n(89907)},34540:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(92292);async function s(e,t){const n=await new Promise((t=>i.Z.windows.get(e,t))),s=n.vivExtData&&JSON.parse(n.vivExtData)||{},o=JSON.stringify({...s,...t});await new Promise((t=>{i.Z.windows.update(e,{vivExtData:o},t)}))}},99498:(e,t,n)=>{"use strict";function i(e){return e.replace(/%25/g,"%2525").replace(/%(?![0-9a-fA-F]{2})/g,"%25").replace(/%09/g,"%2509").replace(/%26/g,"%2526").replace(/%2(f|F)/g,"%252$1").replace(/%0D%0A/g,"%250D%250A")}n.d(t,{Z:()=>i})},39180:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={call:function(){return"win"}}},98974:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>m,ME:()=>y,gG:()=>f,Aq:()=>v,dO:()=>b,kG:()=>g,gC:()=>C});var i=n(29087),s=n(99498);const o=function(e){try{return decodeURI((0,s.Z)(e))}catch(t){return e}};var a=n(29526),r=n(7064),l=n(36436),d=n(8575),c=n(88778),h=n(42941),p=n(89175),u=n(44850);function g(){return{scheme:null,username:null,password:null,host:null,path:null,ref:null,query:null,port:null,tld:null}}function m(e){if(!e)return"";const t=(0,d.parse)(e);"view-source:"!==t.protocol&&("mailto:"!==t.protocol&&(t.auth=""),e=(0,d.format)(t));const n=i.Z.get(p.kAddressBarShowFullUrl)?u.jk.getDisplayUrl(e):(0,l.Dy)(u.jk.getDisplayUrl(e));return o(n)}function v(e){const t=e.scheme&&!l.kO.includes(`${e.scheme}:`)&&"vivaldi"!==e.scheme,n=e.path&&"/"!==e.path||e.query||e.ref?e.path:"",i=null!==e.query?`?${e.query}`:"",s=null!==e.ref?`#${e.ref}`:"";return(e.scheme?`${e.scheme}:${t?"//":""}`:"")+(e.username?e.username:"")+(e.password?`:${e.password}`:"")+(e.username||e.password?"@":"")+(e.host?e.host:"")+(e.port?`:${e.port}`:"")+(n||"")+(i||"")+(s||"")}function f(e){const t=i.Z.get(p.kAddressBarShowFullUrl),n=y(e,["tld","host","port","path",...t?["scheme"]:[],...t?["ref"]:[],...t?["query"]:[]]),s=n.path&&"/"!==n.path||n.query?n.path:"";return{...n,path:s}}function y(e,t){const n=t.includes("username"),i=t.includes("password"),s=t.includes("tld"),o=t.includes("host"),a=t.includes("port"),r=t.includes("path"),l=t.includes("scheme"),d=t.includes("ref"),c=t.includes("query");return{scheme:l?e.scheme:"",username:n?e.username:"",password:i?e.password:"",host:o?e.host:"",path:r?e.path:"",ref:d?e.ref:"",query:c?e.query:"",port:a?e.port:"",tld:s?e.tld:""}}function w(e){return void 0===e?null:e}function b(e){const t=u.jk.getDisplayUrl(e);if(!t)return{scheme:null,username:null,password:null,host:null,path:null,ref:null,query:null,port:null,tld:null};const n=r.Z.utilities.getUrlFragments(t);return{scheme:w(n.scheme),username:w(n.username),password:w(n.password),host:w(n.host),path:void 0===n.path?null:(0,a.Z)(n.path),ref:void 0===n.ref?null:(0,a.Z)(n.ref),query:w(n.query),port:w(n.port),tld:w(n.tld)}}function C(e,t){if(!t||!e)return null;const n=e.substring(0,e.length-t.length).split(".").filter(Boolean),i=(0,c.Z)(n).join(".");return{basedomain:(0,h.default)(n),subdomain:i,tld:t}}},42578:(e,t,n)=>{"use strict";n.d(t,{q:()=>a,d:()=>r});var i=n(25356),s=n(8575),o=n(44850);function a(e){if(o.jk.isInternalUrl(e.url)){if(Object.keys(o.jk.internals).find((t=>e.url.startsWith(o.jk.internals[t]))))return o.jk.getDisplayTitle(e)}return s.parse((0,i.Z)(e.url)).hostname||""}function r(e,t){const n=a(e),i=t.filter((e=>"tab"===e.type&&!e.page.pinned&&a(e.page)===n)).map((e=>e.page));return[n,i]}},45454:(e,t,n)=>{"use strict";n.d(t,{k:()=>s,Z:()=>o});var i=n(15489);const s={openInBackgroundTab:{inCurrent:!1,inBackground:!0,inNewWindow:!1,allowOverride:!1,incognito:!1}};function o(e,t){const n={ctrl:!!t.ctrlKey,alt:!!t.altKey,shift:!!t.shiftKey,command:!1},s=n.ctrl,o=!n.shift&&!s&&!n.alt,a={inCurrent:!0,inBackground:!1,inNewWindow:!1,allowOverride:!1,incognito:!1};return n.shift&&s&&n.alt?(a.inNewWindow=!0,a.incognito=!0):n.shift&&s&&!n.alt?(a.inNewWindow=!0,a.incognito=i.ZP.isIncognito(e)):!n.shift||s||n.alt?n.shift||!s||n.alt?o&&1===t.button?(a.inCurrent=!1,a.inBackground=!0):o&&2===t.button?a.inCurrent=!1:o&&(a.allowOverride=!0):(a.inCurrent=!1,a.inBackground=!0):a.inCurrent=!1,a}},84847:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=e=>Boolean(e&&["ctrlKey","altKey","metaKey","shiftKey"].some((t=>!0===e[t])))},60339:(e,t,n)=>{"use strict";n.d(t,{Qz:()=>a,gO:()=>r,ZN:()=>l,kG:()=>d,xz:()=>h});var i=n(63353),s=n(35369),o=n(69046);function a(e){const t=i.Z.getPageById(e);return!!t&&r(t)}function r(e){const t=e.vivExtData.tiling?.id;if(!t)return!1;if(i.Z.getPages(e.windowId).filter((e=>e.vivExtData.tiling?.id===t)).count()<2)return!1;const n=i.Z.getActivePage(e.windowId);if(!n)return!1;const s=n.vivExtData.tiling?.id;return!(!t||!s)&&t===s}function l(e){if(e.active)return!0;const t=c(e);return!!t&&t.some((e=>e.active))}function d(e){if(!i.Z.getPages(e))return(0,s.aV)();const t=i.Z.getActivePage(e);return t?c(t)||s.aV.of(t):(0,s.aV)()}function c(e){const t=(0,o.jA)(e);return r(e)&&t?i.Z.getTiles(t,e.windowId):null}function h(e){return!!e&&i.Z.isGroup(e.vivExtData.group,e.windowId)}},29489:(e,t,n)=>{"use strict";n.d(t,{gD:()=>r,IN:()=>l});var i=n(63353),s=n(26036),o=n(7064);const a=[(0,s.Z)("Transitions Forced"),(0,s.Z)("Filter Obscure"),(0,s.Z)("Filter Grayscale"),(0,s.Z)("Filter Black and White"),(0,s.Z)("Fonts Monospace"),(0,s.Z)("Transform 3D"),(0,s.Z)("Highlight Hover"),(0,s.Z)("CSS Debugger"),(0,s.Z)("Filter Sepia"),(0,s.Z)("Filter Intensify"),(0,s.Z)("Skewed Images"),(0,s.Z)("Highlight Focus"),(0,s.Z)("Transitions Removed"),(0,s.Z)("Filter Invert"),(0,s.Z)("Inline Access Keys"),(0,s.Z)("Page Minimap")];function r(e){const t=e.lastIndexOf("\\"),n=-1===t?e:e.substr(t+1),i=n.lastIndexOf("."),s=n.substr(0,i).replace(/_/g," "),o=a.findIndex((e=>e.labelEnglish===s));return-1===o?s:a[o].label}function l(e){const t=r(e),n=`COMMAND_${t}`.toUpperCase().replace(/\s+/,"_");return{name:n,action:t=>async function(e,t){const n=i.Z.getActivePage(e);if(n){const e="enabled"===(await o.Z.pageActions.getScriptOverridesForTab(n.id)).find((e=>e.script===t))?.override?"no_override":"enabled";await o.Z.pageActions.setScriptOverrideForTab(t,n.id,e)}}(t.windowId,e),guid:n,showInQC:!1,isEnabled:()=>!0,category:"CATEGORY_COMMAND_TAB_ACTION",...(0,s.Z)(t)}}},29526:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(99498);const s=function(e){if(!e)return"";try{return decodeURIComponent((0,i.Z)(e))}catch(t){return e}}},25356:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(40015),s=n.n(i);const o=function(e,t){try{return s()(e,t)}catch(t){return e}}},14789:(e,t,n)=>{"use strict";function i(e,t){const n=e.indexOf(t);if(n<0)return void e.push(t);const i=e[n];e.copyWithin(n,n+1),e[e.length-1]=i}function s(e,t){const n=e.indexOf(t);if(n<0)return void e.unshift(t);const i=e[n];e.copyWithin(1,0,n),e[0]=i}function o(e,t=!1){if(e.length<=1)return e;const n=[...e];if(!0===t){const e=n[n.length-1];n.copyWithin(1,0,n.length-1),n[0]=e}else{const e=n[0];n.copyWithin(0,1),n[n.length-1]=e}return n}n.d(t,{AL:()=>i,EQ:()=>s,JA:()=>o})},42225:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 21">\n  <path fill-rule="evenodd" d="M14.6 3c-1.4-.6-3.3-1-5.6-1s-4.2.4-5.6 1l-1.2.8L2 4l7-2-7 2 .2.2 1.2.8c1.4.6 3.3 1 5.6 1s4.2-.4 5.6-1l1.2-.8.2-.2-.2-.2-1.2-.8zM9 0C4 0 0 1.8 0 4v13c0 2.2 4 4 9 4s9-1.8 9-4V4c0-2.2-4-4-9-4zM2 13.3v-2.8c1.6 1 4.2 1.5 7 1.5s5.3-.6 7-1.5v2.8l-1 .6c-1.5.7-3.6 1.1-6 1.1s-4.5-.4-6-1l-1-.7zM15 10l1-.6V6.5C14.3 7.5 11.8 8 9 8s-5.4-.6-7-1.5v2.8l1 .6c1.5.7 3.6 1.1 6 1.1s4.5-.4 6-1zM2 14.5c1.6 1 4.2 1.5 7 1.5s5.3-.6 7-1.5V17l-.2.2-1.2.8c-1.4.6-3.3 1-5.6 1s-4.2-.4-5.6-1l-1.2-.8A.8.8 0 012 17v-2.5zM16 4zm0 13zM2 17zM2 4zm2 4.5a.5.5 0 11-1 0 .5.5 0 011 0zm0 4a.5.5 0 11-1 0 .5.5 0 011 0zm0 4a.5.5 0 11-1 0 .5.5 0 011 0z"/>\n</svg>\n'},50227:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path fill-rule="evenodd" d="M8 2c1.72 0 3.2.3 4.15.73.23.1.41.2.55.28-.14.08-.31.18-.54.27C11.2 3.7 9.73 4 8 4s-3.2-.3-4.16-.72c-.23-.1-.4-.19-.54-.27.14-.09.32-.18.55-.28C4.8 2.3 6.28 2 8 2zm7 1.02V3c0-1.66-3.13-3-7-3S1 1.34 1 3v9.95C1 14.64 4.13 16 8 16s7-1.36 7-3.05V3.02zm-2 6.91v-1.9c-1.27.57-3.04.92-5 .92s-3.73-.35-5-.92v1.9l.37.18c1.14.5 2.78.83 4.63.83a12.02 12.02 0 005-1zm-10 .85c1.27.57 3.04.92 5 .92s3.73-.35 5-.92v1.98a2.9 2.9 0 01-.85.51C11.2 13.7 9.72 14 8 14c-1.72 0-3.2-.3-4.15-.73a2.9 2.9 0 01-.85-.5v-1.99zm9.63-3.42a6 6 0 00.37-.18V5.1c-1.27.56-3.04.9-5 .9a12.9 12.9 0 01-5-.9v2.08l.37.18c1.14.5 2.78.83 4.63.83s3.49-.33 4.63-.83z"/>\n</svg>\n'},29047:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path fill-rule="evenodd" d="M8 1c1.55 0 2.9.28 3.84.7.46.2.78.42.96.62.1.1.15.19.18.25a.79.79 0 01-.15.2c-.19.17-.5.38-.97.57-.94.4-2.3.66-3.86.66s-2.92-.26-3.86-.66a3.1 3.1 0 01-.97-.58.78.78 0 01-.15-.2.8.8 0 01.18-.24c.18-.2.5-.42.96-.63C5.1 1.3 6.45 1 8 1zm6 1.58V2.5C14 1.12 11.31 0 8 0S2 1.12 2 2.5v8.83C2 12.81 4.69 14 8 14s6-1.2 6-2.67V2.67v-.09zm-1 3.38V3.88C11.93 4.56 10.09 5 8 5s-3.93-.44-5-1.12v2.08c.23.22.57.45 1.03.65.98.44 2.38.72 3.97.72 1.59 0 2.99-.28 3.97-.72.46-.2.8-.43 1.03-.65zM3 6.8C4.07 7.53 5.91 8 8 8s3.93-.47 5-1.2v2.01c-.23.22-.57.45-1.03.65-.98.44-2.38.72-3.97.72-1.59 0-2.99-.28-3.97-.72-.46-.2-.8-.43-1.03-.65v-2zm0 4.52V9.66c1.07.72 2.91 1.2 5 1.2s3.93-.48 5-1.2v1.67c0 .05-.02.16-.2.35-.18.2-.5.42-.96.63-.93.4-2.29.69-3.84.69-1.55 0-2.9-.28-3.84-.7-.46-.2-.78-.42-.96-.62-.18-.19-.2-.3-.2-.35z"/>\n</svg>\n'},3009:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path d="M12 14H9C8.44772 14 8 13.5523 8 13V13C8 12.4477 8.44772 12 9 12H12V9C12 8.44772 12.4477 8 13 8V8C13.5523 8 14 8.44772 14 9V12H17C17.5523 12 18 12.4477 18 13V13C18 13.5523 17.5523 14 17 14H14V17C14 17.5523 13.5523 18 13 18V18C12.4477 18 12 17.5523 12 17V14Z"/>\n</svg>\n'},43099:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M7 7V5C7 4.44772 7.44772 4 8 4C8.55228 4 9 4.44772 9 5V7H11C11.5523 7 12 7.44772 12 8C12 8.55228 11.5523 9 11 9H9V11C9 11.5523 8.55228 12 8 12C7.44772 12 7 11.5523 7 11V9H5C4.44772 9 4 8.55228 4 8C4 7.44772 4.44772 7 5 7H7Z"/>\n</svg>\n'},42041:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M3 2h9a1 1 0 011 1v9a1 1 0 01-1 1H3a1 1 0 01-1-1V3a1 1 0 011-1zM1 3a2 2 0 012-2h9a2 2 0 012 2v9a2 2 0 01-2 2H3a2 2 0 01-2-2V3zm6 1h1v3h3v1H8v3H7V8H4V7h3V4z"/>\n</svg>\n'},28796:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M8.5 4C8.22386 4 8 4.22386 8 4.5V8H4.5C4.22386 8 4 8.22386 4 8.5C4 8.77614 4.22386 9 4.5 9H8V12.5C8 12.7761 8.22386 13 8.5 13C8.77614 13 9 12.7761 9 12.5V9H12.5C12.7761 9 13 8.77614 13 8.5C13 8.22386 12.7761 8 12.5 8H9V4.5C9 4.22386 8.77614 4 8.5 4Z"/>\n</svg>\n'},35732:e=>{e.exports='<svg class="add-speeddial-large-plus" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg">\n  <path d="M34 30V0h-4v30H0v4h30v30h4V34h30v-4"/>\n</svg>\n'},98913:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M3 6.5C3 6.22386 3.22386 6 3.5 6H6.5C6.77614 6 7 6.22386 7 6.5V9.5C7 9.77614 6.77614 10 6.5 10H3.5C3.22386 10 3 9.77614 3 9.5V6.5Z"/>\n  <path fill-rule="evenodd" d="M3 3C1.34315 3 0 4.34315 0 6V10C0 11.6569 1.34315 13 3 13H13C14.6569 13 16 11.6569 16 10V6C16 4.34315 14.6569 3 13 3H3ZM2 6C2 5.44772 2.44772 5 3 5H13C13.5523 5 14 5.44772 14 6V10C14 10.5523 13.5523 11 13 11H3C2.44772 11 2 10.5523 2 10V6Z"/>\n</svg>\n'},2291:e=>{e.exports='<svg viewBox="0 0 16 16"  xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M7 3C7 2.44772 6.55228 2 6 2H2C0.895431 2 0 2.89543 0 4V13C0 14.1046 0.895431 15 2 15H14C15.1046 15 16 14.1046 16 13V6C16 5.44772 15.5523 5 15 5H8C7.44772 5 7 4.55228 7 4V3ZM2 8C2 7.44772 2.44772 7 3 7H13C13.5523 7 14 7.44772 14 8V12C14 12.5523 13.5523 13 13 13H3C2.44772 13 2 12.5523 2 12V8Z"/>\n  <rect opacity="0.35" x="8" y="2" width="8" height="2" rx="1"/>\n</svg>\n'},77737:e=>{e.exports='<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\r\n    <path fill-rule="evenodd" d="M12.5 16L8.86568 12.3657C8.36171 11.8617 8.71865 11 9.43137 11L15.5686 11C16.2814 11 16.6383 11.8617 16.1343 12.3657L12.5 16Z"/>\r\n</svg>\r\n'},60018:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M8.5 11L4.86568 7.36568C4.36171 6.86171 4.71865 6 5.43137 6L11.5686 6C12.2814 6 12.6383 6.86171 12.1343 7.36569L8.5 11Z"/>\n</svg>\n'},99785:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 13l3.634-3.634c.504-.504 1.366-.147 1.366.566v6.137c0 .713-.862 1.07-1.366.566l-3.634-3.634z"/></svg>'},10307:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M5 8L8.63432 4.36568C9.13829 3.86171 10 4.21865 10 4.93137L10 11.0686C10 11.7814 9.13829 12.1383 8.63431 11.6343L5 8Z"/>\n</svg>\n'},91004:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M16 13l-3.634 3.634c-.504.504-1.366.147-1.366-.566v-6.137c0-.713.862-1.07 1.366-.566l3.634 3.634z"/></svg>'},86839:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M11 8L7.36568 11.6343C6.86171 12.1383 6 11.7814 6 11.0686L6 4.93137C6 4.21865 6.86171 3.86171 7.36569 4.36569L11 8Z"/>\n</svg>\n'},89170:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M8.5 6L12.1343 9.63432C12.6383 10.1383 12.2814 11 11.5686 11L5.43137 11C4.71865 11 4.36171 10.1383 4.86569 9.63431L8.5 6Z"/>\n</svg>\n'},51843:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M1 8c0-2.182 1.75-4 3.85-4h7.35C13.74 4 15 5.31 15 6.91s-1.26 3.15-2.8 3.15H6.25C5.27 10.06 4.5 9.018 4.5 8s.77-2 1.75-2h5.753v1.063H6.25c-.42 0-.7.5-.7.937 0 .436.28.97.7.97h5.95c.98 0 1.75-1.043 1.75-2.06 0-1.02-.77-1.82-1.75-1.82H4.85c-1.54 0-2.8 1.31-2.8 2.91s1.26 2.91 2.8 2.91l6.155.148V12H4.85C2.75 12 1 10.182 1 8z"/>\n</svg>\n'},55070:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16Z" fill="var(--colorSuccessBg)"/>\n  <path d="M7.544 8.703 10.819 4.8l1.839 1.542-4.82 5.752L4 8.866l1.542-1.839 2.002 1.676Z" fill="var(--colorSuccessFg)"/>\n</svg>\n'},81766:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16Z" fill="var(--colorErrorBg)"/>\n  <path d="M4 5.6 5.6 4 8 6.4 10.4 4 12 5.6 9.6 8l2.4 2.4-1.6 1.6L8 9.6 5.6 12 4 10.4 6.4 8 4 5.6Z" fill="var(--colorErrorFg)"/>\n</svg>\n'},99634:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16Z" fill="var(--colorBg)"/>\n  <path d="M7.544 8.703 10.819 4.8l1.839 1.542-4.82 5.752L4 8.866l1.542-1.839 2.002 1.676Z" fill="var(--colorFg)"/>\n</svg>\n'},95460:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16Z" fill="var(--colorWarningBg)"/>\n  <path d="M6.987 10.019h1.594c.004-.321.048-.598.132-.831.087-.234.25-.457.487-.67.275-.258.527-.508.756-.75.23-.24.415-.501.556-.78.142-.284.213-.607.213-.97 0-.52-.11-.962-.331-1.324a2.079 2.079 0 0 0-.957-.831c-.416-.192-.916-.288-1.5-.288-.529 0-1.006.092-1.43.275-.426.18-.765.456-1.02.831-.25.371-.38.842-.393 1.413h1.812c.004-.259.054-.467.15-.625a.929.929 0 0 1 .381-.35c.155-.08.321-.119.5-.119.217 0 .396.042.538.125a.762.762 0 0 1 .325.369c.075.158.112.358.112.6 0 .208-.041.398-.125.569a2.13 2.13 0 0 1-.343.487 7.419 7.419 0 0 1-.513.5 3.45 3.45 0 0 0-.562.656c-.138.221-.236.469-.294.744a5.31 5.31 0 0 0-.088.969ZM7.075 11.287a.877.877 0 0 0-.275.663c0 .258.092.477.275.656.183.18.43.269.737.269.305 0 .548-.09.732-.269a.873.873 0 0 0 .281-.656.867.867 0 0 0-.281-.662c-.184-.18-.427-.27-.732-.27-.308 0-.554.09-.737.27Z" fill="var(--colorWarningFg)"/>\n</svg>\n'},72103:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M9.02555 3.6815L9.02548 3.68157L7.35355 5.3535C7.15829 5.54876 6.84171 5.54876 6.64645 5.3535C6.45118 5.15824 6.45118 4.84165 6.64645 4.64639L8.31845 2.97439L8.31852 2.97432C8.94279 2.3503 9.78933 1.99976 10.672 1.99976C11.5547 1.99976 12.4012 2.3503 13.0255 2.97432L12.672 3.32795L13.0256 2.97446C13.6496 3.59873 14.0002 4.44527 14.0002 5.32795C14.0002 6.21062 13.6496 7.05716 13.0256 7.68143L13.0256 7.6815L11.3536 9.3535C11.1583 9.54876 10.8417 9.54876 10.6464 9.3535C10.4512 9.15824 10.4512 8.84165 10.6464 8.64639L12.3184 6.97446L12.3184 6.97439C12.755 6.53765 13.0002 5.94544 13.0002 5.32795C13.0002 4.71049 12.755 4.1183 12.3185 3.68157C11.8818 3.245 11.2895 2.99976 10.672 2.99976C10.0545 2.99976 9.46229 3.24498 9.02555 3.6815ZM10.8536 5.14645C11.0488 5.34171 11.0488 5.65829 10.8536 5.85355L5.85355 10.8536C5.65829 11.0488 5.34171 11.0488 5.14645 10.8536C4.95118 10.6583 4.95118 10.3417 5.14645 10.1464L10.1464 5.14645C10.3417 4.95118 10.6583 4.95118 10.8536 5.14645ZM5.3535 7.35355C5.54876 7.15829 5.54876 6.84171 5.3535 6.64645C5.15824 6.45118 4.84165 6.45118 4.64639 6.64645L2.97439 8.31845L2.97432 8.31852C2.3503 8.94279 1.99976 9.78933 1.99976 10.672C1.99976 11.5547 2.3503 12.4012 2.97432 13.0255L3.32795 12.672L2.97446 13.0256C3.59873 13.6496 4.44527 14.0002 5.32795 14.0002C6.21062 14.0002 7.05716 13.6496 7.68143 13.0256L7.6815 13.0256L9.3535 11.3536C9.54876 11.1583 9.54876 10.8417 9.3535 10.6464C9.15824 10.4512 8.84165 10.4512 8.64639 10.6464L6.97446 12.3184L6.97439 12.3184C6.53765 12.755 5.94544 13.0002 5.32795 13.0002C4.71049 13.0002 4.1183 12.755 3.68157 12.3185C3.245 11.8818 2.99976 11.2895 2.99976 10.672C2.99976 10.0545 3.24498 9.46229 3.6815 9.02555L3.68157 9.02548L5.3535 7.35355Z"/>\n</svg>\n'},96569:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M2 11v1.857S2 14 3.077 14h9.846S14 14 14 12.857V11h-1v1.857c0 .064-.007.1-.012.12A.289.289 0 0112.9 13H3.077c-.017 0-.03 0-.04-.002A.485.485 0 013 12.841V11H2z"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M7 8H4.762L8 10.698 11.238 8H9V3H7v5zm7-1l-6 5-6-5h4V3a1 1 0 011-1h2a1 1 0 011 1v4h4z"/>\n</svg>\n'},79537:e=>{e.exports='<svg width="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M7.5 4C7.22386 4 7 4.22386 7 4.5V7.5C7 7.70662 7.12533 7.88397 7.30412 7.96017C7.3329 8.02199 7.37279 8.07992 7.42381 8.13093L8.7304 9.43752C8.96449 9.67161 9.34402 9.67161 9.5781 9.43752C9.81219 9.20344 9.81219 8.82391 9.5781 8.58982L8.27151 7.28323C8.19356 7.20527 8.09947 7.15328 8 7.12725V4.5C8 4.22386 7.77614 4 7.5 4Z"/>\n  <path fill-rule="evenodd" d="M13 7.5C13 10.5376 10.5376 13 7.5 13C4.46243 13 2 10.5376 2 7.5C2 4.4624 4.46243 2 7.5 2C10.5376 2 13 4.4624 13 7.5ZM12 7.5C12 9.98535 9.98528 12 7.5 12C5.01472 12 3 9.98535 3 7.5C3 5.01465 5.01472 3 7.5 3C9.98528 3 12 5.01465 12 7.5Z"/>\n</svg>\n'},72796:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M8 11c2.652 0 4.854-1.276 5.872-3C12.854 6.276 10.652 5 8 5 5.344 5 3.14 6.28 2.123 8.007 3.132 9.777 5.325 11 8 11zm0 1c-3.181 0-5.918-1.572-7-4 1.082-2.346 3.819-4 7-4s5.918 1.654 7 4c-1.082 2.346-3.819 4-7 4zm1-4a1 1 0 11-2 0 1 1 0 012 0zm1 0a2 2 0 11-4 0 2 2 0 014 0z"/>\n</svg>\n'},19096:e=>{e.exports='<svg height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg">\n  <path class="trackers" opacity="var(--trackers)" fill-opacity="0.7" d="M8 4l-3 .5v4.5c.539 1.328 1.539 2.277 3 3 1.459-.724 2.459-1.672 2.998-3l.002-4.5z"/>\n  <path class="ads" opacity="var(--ads)" fill-opacity="0.6" d="M2.5 2.5l5.5-1 5.5 1v7l-2.5 3.5-3 1.5-3-1.5-2.5-3.5z"/>\n  <path class="blocking" opacity="var(--blocking)" d="M5.227 7.621l2.773-4.621.031 4h2.527c.138 0 .25.112.25.25l-.036.129-2.773 4.621v-4h-2.558c-.138 0-.25-.112-.25-.25l.036-.129z"/>\n  <g>\n    <path class="outline" d="M8 1l6 1.077-.004 7.538c-1.079 2.324-3.077 4.118-5.996 5.385-2.799-1.213-4.753-2.912-5.86-5.097l-.14-.288v-7.538zm0 1l-5 .923v6.462c.899 1.992 2.566 3.53 5 4.615 2.432-1.085 4.098-2.624 4.997-4.615l.003-6.462z"/>\n    <path d="m8 14c2.432-1.085 4.098-2.624 4.997-4.615l.003-6.462-5-.923z" fill-opacity="0.2"/>\n  </g>\n</svg>\n'},24325:e=>{e.exports='<svg class="bookmarklet" width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M3 13V2C3 1.44772 3.44772 1 4 1H8.79289C8.9255 1 9.05268 1.05268 9.14645 1.14645L12.8536 4.85355C12.9473 4.94732 13 5.0745 13 5.20711V13C13 13.5523 12.5523 14 12 14H4C3.44772 14 3 13.5523 3 13ZM7.53033 4.96967C7.23744 4.67678 6.76256 4.67678 6.46967 4.96967C6.17678 5.26256 6.17678 5.73744 6.46967 6.03033L8.43934 8L6.46967 9.96967C6.17678 10.2626 6.17678 10.7374 6.46967 11.0303C6.76256 11.3232 7.23744 11.3232 7.53033 11.0303L10.0303 8.53033L10.5607 8L10.0303 7.46967L7.53033 4.96967Z"/>\n</svg>\n'},4044:e=>{e.exports='<svg width="16px" height="16px" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <defs>\n    <clipPath id="addBookmarkPath">\n      <path fill-rule="evenodd" d="M11.1425 14.123L8 10.9091L4.8575 14.123C4.54419 14.4435 4 14.2216 4 13.7734V2C4 1.44775 4.44771 1 5 1H11C11.5523 1 12 1.44775 12 2V13.7734C12 14.2216 11.4558 14.4435 11.1425 14.123Z"/>\n    </clipPath>\n  </defs>\n  <g clip-path="url(#addBookmarkPath)">\n    <path class="bookmark-animated-fill" fill-rule="evenodd" d="M11.1425 14.123L8 10.9091L4.8575 14.123C4.54419 14.4435 4 14.2216 4 13.7734V2C4 1.44775 4.44771 1 5 1H11C11.5523 1 12 1.44775 12 2V13.7734C12 14.2216 11.4558 14.4435 11.1425 14.123Z"/>\n    <path class="bookmark-outline" fill-rule="evenodd" d="M11.1425 14.123L8 10.9091L4.8575 14.123C4.54418 14.4434 4 14.2216 4 13.7734V2C4 1.44772 4.44772 1 5 1H11C11.5523 1 12 1.44772 12 2V13.7734C12 14.2216 11.4558 14.4434 11.1425 14.123ZM8 9.47872L5 12.5469V2L11 2V12.5469L8 9.47872Z"/>\n    <path class="add-bookmark-shadow" d="M8 2H11V12.55L8 9.47656V2Z"/>\n  </g>\n</svg>\n'},97624:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path d="M13 6C11.8954 6 11 6.89543 11 8V14H8L13 19L18 14H15V8C15 6.89543 14.1046 6 13 6Z"/>\n</svg>\n'},20477:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M7 9V4C7 3.44772 7.44772 3 8 3V3C8.55228 3 9 3.44772 9 4V9H12L8 13L4 9H7Z"/>\n</svg>\n'},62786:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M16.2929 20.2929L13 17L9.70711 20.2929C9.07714 20.9229 8 20.4767 8 19.5858V6C8 5.44772 8.44772 5 9 5H17C17.5523 5 18 5.44772 18 6V19.5858C18 20.4767 16.9229 20.9229 16.2929 20.2929ZM14.4142 15.5858C14.0391 15.2107 13.5304 15 13 15C12.4696 15 11.9609 15.2107 11.5858 15.5858L10 17.1716V7H16V17.1716L14.4142 15.5858Z"/>\n</svg>\n'},48446:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M5 2C4.44772 2 4 2.44772 4 3V13.5858C4 14.4767 5.07714 14.9229 5.70711 14.2929L8 12L10.2929 14.2929C10.9229 14.9229 12 14.4767 12 13.5858V3C12 2.44772 11.5523 2 11 2H5ZM6 4H10V11.5L8.70711 10.2071C8.31658 9.81658 7.68342 9.81658 7.29289 10.2071L6 11.5V4Z"/>\n</svg>\n'},31734:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M7.486 11.143a1 1 0 011.029 0L12 13.232V1.024A.261.261 0 0011.996 1H4.024A.287.287 0 004 1.003V13.234l3.486-2.091zM4 14.4L3 15V1c0-1 1-1 1-1h8c1 0 1 1 1 1v14l-1-.6L8 12l-4 2.4zm8.054-13.396h.002zM4.004.946V.945z"/>\n</svg>\n'},16508:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path class="small-icon-fill" d="M9 0H4S3 0 3 1v14l5-3 5 3V1s0-1-1-1H9z"/>\n  <path class="small-icon-outline" fill-rule="evenodd" d="M7.486 11.143a1 1 0 011.029 0L12 13.232V1.024A.261.261 0 0011.996 1H4.024A.287.287 0 004 1.003V13.234l3.486-2.091zM4 14.4L3 15V1c0-1 1-1 1-1h8c1 0 1 1 1 1v14l-1-.6L8 12l-4 2.4zm8.054-13.396h.002zM4.004.946V.945z"/>\n</svg>\n'},42855:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26">\n  <path d="M10 11a1 1 0 112 0v4a1 1 0 11-2 0zm4 0a1 1 0 112 0v4a1 1 0 11-2 0z"/>\n  <path fill-rule="evenodd" d="M7 6a3 3 0 00-3 3v8a3 3 0 003 3h12a3 3 0 003-3V9a3 3 0 00-3-3zM6 9a1 1 0 011-1h12a1 1 0 011 1v8a1 1 0 01-1 1H7a1 1 0 01-1-1z" />\n</svg>\n'},97093:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path fill-rule="evenodd" d="M3 2a3 3 0 00-3 3v6a3 3 0 003 3h10a3 3 0 003-3V5a3 3 0 00-3-3zM2 5a1 1 0 011-1h10a1 1 0 011 1v6a1 1 0 01-1 1H3a1 1 0 01-1-1z"/>\n  <path d="M5 6a1 1 0 012 0v4a1 1 0 11-2 0zm4 0a1 1 0 012 0v4a1 1 0 11-2 0z"/>\n</svg>\n'},58615:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path fill-rule="evenodd" d="M3 3h10a1 1 0 011 1v8a1 1 0 01-1 1H3a1 1 0 01-1-1V4a1 1 0 011-1zM1 4c0-1.1.9-2 2-2h10a2 2 0 012 2v8a2 2 0 01-2 2H3a2 2 0 01-2-2zm5.4 1c-.2 0-.4 0-.4.5v5c0 .5.2.5.4.5a3.6 3.6 0 01.2 0c.2 0 .4 0 .4-.5v-5C7 5 6.8 5 6.6 5a4.2 4.2 0 01-.2 0zm3 0c-.2 0-.4 0-.4.5v5c0 .5.2.5.4.5a3.6 3.6 0 01.2 0c.2 0 .4 0 .4-.5v-5c0-.5-.2-.5-.4-.5a4.2 4.2 0 01-.2 0z"/>\n</svg>\n'},5869:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26">\n  <path d="M16 13l-3.7 3a.8.8 0 01-1.3-.7v-4.6a.8.8 0 011.3-.7z" fill-rule="evenodd"/>\n  <path d="M7 6a3 3 0 00-3 3v8a3 3 0 003 3h12a3 3 0 003-3V9a3 3 0 00-3-3zM6 9a1 1 0 011-1h12a1 1 0 011 1v8a1 1 0 01-1 1H7a1 1 0 01-1-1z"/>\n</svg>\n'},82214:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path d="M11 8l-3.7 3a.8.8 0 01-1.3-.7V5.7A.8.8 0 017.3 5z" fill-rule="evenodd"/>\n  <path d="M3 2a3 3 0 00-3 3v6a3 3 0 003 3h10a3 3 0 003-3V5a3 3 0 00-3-3zM2 5a1 1 0 011-1h10a1 1 0 011 1v6a1 1 0 01-1 1H3a1 1 0 01-1-1z"/>\n</svg>\n'},57358:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path fill-rule="evenodd" d="M3 3h10a1 1 0 011 1v8a1 1 0 01-1 1H3a1 1 0 01-1-1V4a1 1 0 011-1zM1 4c0-1.1.9-2 2-2h10a2 2 0 012 2v8a2 2 0 01-2 2H3a2 2 0 01-2-2zm6.3 1L11 8l-3.7 3a.8.8 0 01-1.3-.7V5.7A.8.8 0 017.3 5zM7 6l2.4 2L7 10z"/>\n</svg>\n'},82152:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M0 3a1 1 0 011-1h14a1 1 0 011 1v1a1 1 0 01-1 1H1a1 1 0 01-1-1v-1zm0 5a1 1 0 011-1h14a1 1 0 110 2H1a1 1 0 01-1-1zm0 4a1 1 0 011-1h14a1 1 0 011 1v1a1 1 0 01-1 1H1a1 1 0 01-1-1v-1z"/></svg>'},82453:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M0 2a1 1 0 011-1h14a1 1 0 110 2H1a1 1 0 01-1-1zm0 8a1 1 0 011-1h14a1 1 0 011 1v5a1 1 0 01-1 1H1a1 1 0 01-1-1v-5zm1-5a1 1 0 000 2h14a1 1 0 100-2H1z"/></svg>'},38368:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M0 5a1 1 0 011-1h14a1 1 0 110 2H1a1 1 0 01-1-1zm0 3a1 1 0 011-1h14a1 1 0 110 2H1a1 1 0 01-1-1zm1 2a1 1 0 100 2h14a1 1 0 100-2H1z"/></svg>'},49336:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n    <path stroke-width="0" fill-rule="evenodd" d="M5 3h6c.6 0 1 .4 1 1v2c0 .6-.4 1-1 1H5a1 1 0 0 1-1-1V4c0-.6.4-1 1-1zm6 1H5v2h6V4z"/>\n    <path stroke-width="0" d="M5 10a1 1 0 1 1 0-2 1 1 0 0 1 0 2zM7 9a1 1 0 1 0 2 0 1 1 0 0 0-2 0zM11 10a1 1 0 1 1 0-2 1 1 0 0 1 0 2zM4 12a1 1 0 1 0 2 0 1 1 0 0 0-2 0zM8 11h3a1 1 0 1 1 0 2H8a1 1 0 1 1 0-2z"/>\n    <path stroke-width="0" fill-rule="evenodd" d="M4 1a2 2 0 0 0-2 2v10c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2H4zm8 1H4a1 1 0 0 0-1 1v10c0 .6.4 1 1 1h8c.6 0 1-.4 1-1V3c0-.6-.4-1-1-1z"/>\n</svg>\n'},87922:e=>{e.exports='<svg class="onboarding-illustration" fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 220 164">\n  <g clip-path="url(#clip-0-calendar-density)">\n    <rect class="bg-fill" width="220" height="164" rx="3"/>\n    <g clip-path="url(#clip-1-calendar-density)" class="highlight-fill">\n      <path opacity=".32" fill-rule="evenodd" clip-rule="evenodd" d="M52 0v164h1V0h-1zm113 0v164h1V0h-1z" fill-opacity=".25"/>\n      <path opacity=".3" fill-rule="evenodd" clip-rule="evenodd" d="M-50 19a3 3 0 00-3 3v62a3 3 0 003 3h93a3 3 0 003-3V22a3 3 0 00-3-3h-93zm223 3a3 3 0 013-3h93a3 3 0 013 3v6a3 3 0 01-3 3h-93a3 3 0 01-3-3v-6zM60 78a3 3 0 013-3h93a3 3 0 013 3v62a3 3 0 01-3 3H63a3 3 0 01-3-3V78zm113-28a3 3 0 013-3h93a3 3 0 013 3v34a3 3 0 01-3 3h-93a3 3 0 01-3-3V50zm3 53a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3h-93zm-229 3a3 3 0 013-3h93a3 3 0 013 3v6a3 3 0 01-3 3h-93a3 3 0 01-3-3v-6zm229 25a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3h-93z"/>\n      <rect x="60" y="19" width="99" height="40" rx="3"/>\n    </g>\n  </g>\n  <defs>\n    <clipPath id="clip-0-calendar-density">\n      <rect class="bg-fill" width="220" height="164" rx="3"/>\n    </clipPath>\n    <clipPath id="clip-1-calendar-density">\n      <path class="bg-fill" d="M0 0h220v164H0z" rx="3"/>\n    </clipPath>\n  </defs>\n</svg>\n'},18767:e=>{e.exports='<svg class="onboarding-illustration" fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 220 164">\n  <rect width="220" height="164" rx="3" class="bg-fill"/>\n  <g clip-path="url(#clip-0-calendar-density)" class="highlight-fill">\n    <path opacity=".32" fill-rule="evenodd" clip-rule="evenodd" d="M52 0v164h1V0h-1zm113 0v164h1V0h-1z" fill-opacity=".25"/>\n    <path opacity=".3" fill-rule="evenodd" clip-rule="evenodd" d="M-50 19a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3h-93zm110 3a3 3 0 013-3h93a3 3 0 013 3v6a3 3 0 01-3 3H63a3 3 0 01-3-3v-6zm0 84a3 3 0 013-3h93a3 3 0 013 3v6a3 3 0 01-3 3H63a3 3 0 01-3-3v-6zm3 25a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3H63zM173 22a3 3 0 013-3h93a3 3 0 013 3v6a3 3 0 01-3 3h-93a3 3 0 01-3-3v-6zm0 28a3 3 0 013-3h93a3 3 0 013 3v6a3 3 0 01-3 3h-93a3 3 0 01-3-3v-6zm-223-3a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3h-93zm-3 31a3 3 0 013-3h93a3 3 0 013 3v6a3 3 0 01-3 3h-93a3 3 0 01-3-3v-6zm229 25a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3h-93zm-229 3a3 3 0 013-3h93a3 3 0 013 3v6a3 3 0 01-3 3h-93a3 3 0 01-3-3v-6zm229 25a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3h-93z"/>\n    <rect x="60" y="75" width="99" height="12" rx="3"/>\n  </g>\n  <defs>\n    <clipPath id="clip-0-calendar-density">\n      <path class="bg-fill" d="M0 0h220v164H0z" rx="3"/>\n    </clipPath>\n  </defs>\n</svg>\n'},36502:e=>{e.exports='<svg class="onboarding-illustration" fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 220 164">\n  <g clip-path="url(#clip-calendar-inline-editor)">\n    <rect class="bg-fill" width="220" height="164" rx="3"/>\n    <rect class="highlight-stroke" x="62" y="40" width="97" height="83" rx="3" stroke-width="2"/>\n    <path class="highlight-stroke" opacity=".32" stroke-opacity=".25" d="M53.5 0v164"/>\n    <path class="highlight-stroke" opacity=".32" stroke-opacity=".25" d="M166.5 0v164"/>\n    <path class="highlight-fill" opacity=".1" fill-rule="evenodd" clip-rule="evenodd" d="M-49 19a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3h-93zm113 0a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3H64zm0 112a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3H64zM174 22a3 3 0 013-3h93a3 3 0 013 3v6a3 3 0 01-3 3h-93a3 3 0 01-3-3v-6zm0 28a3 3 0 013-3h93a3 3 0 013 3v6a3 3 0 01-3 3h-93a3 3 0 01-3-3v-6zm-223-3a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3h-93zm223 31a3 3 0 013-3h93a3 3 0 013 3v6a3 3 0 01-3 3h-93a3 3 0 01-3-3v-6zm-223-3a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3h-93zm223 31a3 3 0 013-3h93a3 3 0 013 3v6a3 3 0 01-3 3h-93a3 3 0 01-3-3v-6zm-223-3a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3h-93zm223 31a3 3 0 013-3h93a3 3 0 013 3v6a3 3 0 01-3 3h-93a3 3 0 01-3-3v-6zm-223-3a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3h-93z"/>\n    <path class="highlight-stroke" stroke-opacity=".25" d="M69 54.5h83"/>\n    <path class="highlight-stroke" stroke-opacity=".25" d="M69 67.5h83"/>\n    <path class="highlight-stroke" stroke-opacity=".25" d="M69 80.5h83"/>\n    <path class="highlight-stroke" stroke-opacity=".25" d="M69 93.5h83"/>\n    <rect class="highlight-fill" x="69" y="102" width="41" height="14" rx="2"/>\n    <rect class="highlight-stroke" opacity=".5" x="117" y="103" width="34" height="12" rx="1" stroke-width="2"/>\n  </g>\n  <defs>\n    <clipPath id="clip-calendar-inline-editor">\n      <path class="bg-fill" d="M0 0h220v164H0z"/>\n    </clipPath>\n  </defs>\n</svg>\n'},46647:e=>{e.exports='<svg class="onboarding-illustration" fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 220 164">\n  <rect class="bg-fill" width="220" height="164" rx="3"/>\n  <g clip-path="url(#clip-calendar-popup-editor)">\n    <path class="highlight-stroke" opacity=".32" stroke-opacity=".25" d="M52.5 0v164"/>\n    <path class="highlight-stroke" opacity=".32" stroke-opacity=".25" d="M165.5 0v164"/>\n    <path class="highlight-fill" opacity=".1" fill-rule="evenodd" clip-rule="evenodd" d="M-50 19a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3h-93zm113 0a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3H63zm0 112a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3H63zM173 22a3 3 0 013-3h93a3 3 0 013 3v6a3 3 0 01-3 3h-93a3 3 0 01-3-3v-6zm0 28a3 3 0 013-3h93a3 3 0 013 3v6a3 3 0 01-3 3h-93a3 3 0 01-3-3v-6zm-223-3a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3h-93zm223 31a3 3 0 013-3h93a3 3 0 013 3v6a3 3 0 01-3 3h-93a3 3 0 01-3-3v-6zm-223-3a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3h-93zm223 31a3 3 0 013-3h93a3 3 0 013 3v6a3 3 0 01-3 3h-93a3 3 0 01-3-3v-6zm-223-3a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3h-93zm223 31a3 3 0 013-3h93a3 3 0 013 3v6a3 3 0 01-3 3h-93a3 3 0 01-3-3v-6zm-223-3a3 3 0 00-3 3v6a3 3 0 003 3h93a3 3 0 003-3v-6a3 3 0 00-3-3h-93z"/>\n  </g>\n  <path class="bg-fill" fill-rule="evenodd" clip-rule="evenodd" d="M32 25a3 3 0 00-3 3v102a3 3 0 003 3h74l4.5 4.5 4.5-4.5h74a3 3 0 003-3V28a3 3 0 00-3-3H32z"/>\n  <path class="highlight-fill" d="M106 133l.7-.7-.29-.3H106v1zm4.5 4.5l-.7.7.7.71.7-.7-.7-.71zm4.5-4.5v-1h-.41l-.3.3.71.7zM30 28c0-1.1.9-2 2-2v-2a4 4 0 00-4 4h2zm0 102V28h-2v102h2zm2 2a2 2 0 01-2-2h-2a4 4 0 004 4v-2zm74 0H32v2h74v-2zm5.2 4.8l-4.5-4.5-1.4 1.4 4.5 4.5 1.4-1.4zm3.1-4.5l-4.5 4.5 1.4 1.4 4.5-4.5-1.4-1.4zm74.7-.3h-74v2h74v-2zm2-2a2 2 0 01-2 2v2a4 4 0 004-4h-2zm0-102v102h2V28h-2zm-2-2a2 2 0 012 2h2a4 4 0 00-4-4v2zM32 26h157v-2H32v2z"/>\n  <rect class="highlight-fill" x="41" y="108" width="46" height="14" rx="2"/>\n  <rect class="highlight-stroke" opacity=".5" x="94" y="109" width="44" height="12" rx="1" stroke-width="2"/>\n  <path class="highlight-fill" fill-rule="evenodd" clip-rule="evenodd" d="M41 46h134v-1H41v1zm0 14h134v-1H41v1zm134 14H41v-1h134v1zM41 88h134v-1H41v1z" fill-opacity=".25"/>\n  <defs>\n    <clipPath id="clip-calendar-popup-editor">\n      <path class="bg-fill" d="M0 0h220v164H0z"/>\n    </clipPath>\n  </defs>\n</svg>\n'},9371:e=>{e.exports='<svg width="140" height="96" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <rect x=".5" y=".5" width="139" height="95" rx="1.5" class="border" opacity=".5"/>\n  <g opacity=".3">\n    <path d="M35 0v96h1V0h-1ZM104 0v96h1V0h-1ZM109 9a3 3 0 0 1 3-3h28v12h-28a3 3 0 0 1-3-3V9ZM0 6v12h28a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3H0ZM40 9a3 3 0 0 1 3-3h54a3 3 0 0 1 3 3v6a3 3 0 0 1-3 3H43a3 3 0 0 1-3-3V9ZM112 24a3 3 0 0 0-3 3v6a3 3 0 0 0 3 3h28V24h-28ZM0 24h28a3 3 0 0 1 3 3v6a3 3 0 0 1-3 3H0V24ZM112 42a3 3 0 0 0-3 3v6a3 3 0 0 0 3 3h28V42h-28ZM0 42h28a3 3 0 0 1 3 3v6a3 3 0 0 1-3 3H0V42ZM112 60a3 3 0 0 0-3 3v6a3 3 0 0 0 3 3h28V60h-28ZM0 60h28a3 3 0 0 1 3 3v6a3 3 0 0 1-3 3H0V60ZM112 78a3 3 0 0 0-3 3v6a3 3 0 0 0 3 3h28V78h-28ZM0 78h28a3 3 0 0 1 3 3v6a3 3 0 0 1-3 3H0V78ZM42 78a3 3 0 0 0-3 3v6a3 3 0 0 0 3 3h54a3 3 0 0 0 3-3v-6a3 3 0 0 0-3-3H42Z"/>\n  </g>\n  <rect class="background-intenser" x="40" y="24" width="60" height="48" rx="3"/>\n  <path class="highlight" fill-rule="evenodd" clip-rule="evenodd" d="M43 24a3 3 0 0 0-3 3v42a3 3 0 0 0 3 3h54a3 3 0 0 0 3-3V27a3 3 0 0 0-3-3H43Zm54 1H43a2 2 0 0 0-2 2v42a2 2 0 0 0 2 2h54a2 2 0 0 0 2-2V27a2 2 0 0 0-2-2Z"/>\n  <g class="highlight" opacity=".2">\n    <path d="M49 35h42v-1H49v1ZM49 43h42v-1H49v1ZM91 51H49v-1h42v1Z"/>\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M72 59a1 1 0 0 1 1-1h17a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1H73a1 1 0 0 1-1-1v-6Zm1 0h17v6H73v-6Z"/>\n  </g>\n  <rect class="highlight" x="49" y="58" width="21" height="8" rx="1"/>\n</svg>\n'},97487:e=>{e.exports='<svg width="140" height="96" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <rect x=".5" y=".5" width="139" height="95" rx="1.5" class="border" opacity=".5"/>\n  <g opacity=".3">\n    <path d="M35 0v96h1V0h-1ZM104 0v96h1V0h-1ZM109 9a3 3 0 0 1 3-3h28v12h-28a3 3 0 0 1-3-3V9ZM0 6v12h28a3 3 0 0 0 3-3V9a3 3 0 0 0-3-3H0ZM40 9a3 3 0 0 1 3-3h54a3 3 0 0 1 3 3v6a3 3 0 0 1-3 3H43a3 3 0 0 1-3-3V9ZM112 24a3 3 0 0 0-3 3v6a3 3 0 0 0 3 3h28V24h-28ZM0 24h28a3 3 0 0 1 3 3v6a3 3 0 0 1-3 3H0V24ZM112 42a3 3 0 0 0-3 3v6a3 3 0 0 0 3 3h28V42h-28ZM0 42h28a3 3 0 0 1 3 3v6a3 3 0 0 1-3 3H0V42ZM112 60a3 3 0 0 0-3 3v6a3 3 0 0 0 3 3h28V60h-28ZM0 60h28a3 3 0 0 1 3 3v6a3 3 0 0 1-3 3H0V60ZM112 78a3 3 0 0 0-3 3v6a3 3 0 0 0 3 3h28V78h-28ZM0 78h28a3 3 0 0 1 3 3v6a3 3 0 0 1-3 3H0V78ZM42 78a3 3 0 0 0-3 3v6a3 3 0 0 0 3 3h54a3 3 0 0 0 3-3v-6a3 3 0 0 0-3-3H42Z"/>\n  </g>\n  <path class="background-intenser" d="M27 13a3 3 0 0 0-3 3v62a3 3 0 0 0 3 3h40l2.75 2.75L72.5 81H113a3 3 0 0 0 3-3V16a3 3 0 0 0-3-3H27Z"/>\n  <path class="highlight" fill-rule="evenodd" clip-rule="evenodd" d="M23.5 16a3.5 3.5 0 0 1 3.5-3.5h86a3.5 3.5 0 0 1 3.5 3.5v62a3.5 3.5 0 0 1-3.5 3.5H72.707l-2.957 2.957-2.957-2.957H27a3.5 3.5 0 0 1-3.5-3.5V16Zm3.5-2.5a2.5 2.5 0 0 0-2.5 2.5v62a2.5 2.5 0 0 0 2.5 2.5h40.207l2.543 2.543 2.543-2.543H113a2.5 2.5 0 0 0 2.5-2.5V16a2.5 2.5 0 0 0-2.5-2.5H27Z"/>\n  <g class="highlight" opacity=".2">\n    <path d="M105 25H35v-1h70v1ZM105 34H35v-1h70v1ZM35 43h70v-1H35v1ZM105 52H35v-1h70v1Z"/>\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M58 65a1 1 0 0 1 1-1h18a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1H59a1 1 0 0 1-1-1v-6Zm1 0h18v6H59v-6Z"/>\n  </g>\n  <rect class="highlight" x="35" y="64" width="21" height="8" rx="1"/>\n</svg>\n'},28888:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72">\n  <path fill-rule="evenodd" d="M66.27 66.27C60.55 72 51.77 72 36 72c-15.78 0-24.55 0-30.27-5.73C0 60.54 0 51.77 0 36S0 11.46 5.73 5.73C11.45 0 20.23 0 36 0c15.78 0 24.55 0 30.27 5.73C72 11.46 72 20.23 72 36s0 24.54-5.73 30.27zM51.16 20.21c2.79 0 5.05 2.26 5.05 5.05v25.27c0 2.79-2.26 5.05-5.05 5.05H20.84a5.05 5.05 0 01-5.05-5.05V25.26c0-2.79 2.26-5.05 5.05-5.05h2.53v-2.53a2.53 2.53 0 015.05 0v2.53h5.05v-2.53a2.53 2.53 0 015.06 0v2.53h5.05v-2.53a2.53 2.53 0 015.05 0v2.53h2.53zm-2.53 30.32c1.4 0 2.53-1.13 2.53-2.53V30.32c0-1.4-1.13-2.53-2.53-2.53H23.37a2.53 2.53 0 00-2.53 2.53V48c0 1.4 1.13 2.53 2.53 2.53h25.26zM30.95 32.84h-5.06v5.05h5.06v-5.05zm7.58 5.05v-5.05h-5.06v5.05h5.06zm-7.58 2.53h-5.06v5.05h5.06v-5.05zm7.58 5.05v-5.05h-5.06v5.05h5.06zm7.58-12.63h-5.06v5.05h5.06v-5.05zm0 7.58h-5.06v5.05h5.06v-5.05z" opacity=".3"/>\n  <path fill-rule="evenodd" d="M24.9 31.84h7.05v7.05h-7.06v-7.05zm14.63 0v7.05h-7.06v-7.05h7.06zm-14.64 7.58h7.06v7.05h-7.06v-7.05zm14.64 0v7.05h-7.06v-7.05h7.06zm.52-7.58h7.06v7.05h-7.06v-7.05zm0 7.58h7.06v7.05h-7.06v-7.05zM54.76 70.3c4.76-.7 8.15-2.07 10.8-4.73 2.66-2.65 4.04-6.04 4.73-10.8.7-4.8.71-10.84.71-18.76 0-7.92 0-13.97-.7-18.76-.7-4.76-2.08-8.15-4.73-10.8C62.9 3.78 59.52 2.4 54.76 1.7 49.96 1 43.92 1 36 1c-7.92 0-13.97 0-18.76.7-4.76.7-8.15 2.08-10.8 4.74-2.66 2.65-4.04 6.04-4.73 10.8C1 22.04 1 28.08 1 36c0 7.92 0 13.97.7 18.76.7 4.76 2.08 8.15 4.73 10.8 2.66 2.66 6.05 4.04 10.81 4.73 4.8.7 10.84.71 18.76.71 7.92 0 13.97 0 18.76-.7zm-3.6-51.08a6.05 6.05 0 016.05 6.05v25.27a6.05 6.05 0 01-6.05 6.05H20.84a6.05 6.05 0 01-6.05-6.05V25.26a6.05 6.05 0 016.05-6.05h1.53v-1.53a3.53 3.53 0 017.05 0v1.53h3.05v-1.53a3.53 3.53 0 017.06 0v1.53h3.05v-1.53a3.53 3.53 0 017.05 0v1.53h1.53zm-2.53 30.32c.84 0 1.53-.69 1.53-1.53V30.32c0-.85-.69-1.53-1.53-1.53H23.37c-.84 0-1.53.68-1.53 1.53V48c0 .84.69 1.53 1.53 1.53h25.26zM36 72c15.78 0 24.55 0 30.27-5.73C72 60.54 72 51.77 72 36s0-24.54-5.73-30.27C60.55 0 51.77 0 36 0 20.22 0 11.45 0 5.73 5.73 0 11.46 0 20.23 0 36s0 24.54 5.73 30.27C11.45 72 20.23 72 36 72zm20.21-46.74a5.05 5.05 0 00-5.05-5.05h-2.53v-2.53a2.53 2.53 0 00-5.05 0v2.53h-5.05v-2.53a2.53 2.53 0 00-5.06 0v2.53h-5.05v-2.53a2.53 2.53 0 00-5.05 0v2.53h-2.53a5.05 5.05 0 00-5.05 5.05v25.27c0 2.79 2.26 5.05 5.05 5.05h30.32c2.79 0 5.05-2.26 5.05-5.05V25.26zM51.16 48c0 1.4-1.13 2.53-2.53 2.53H23.37A2.53 2.53 0 0120.84 48V30.32c0-1.4 1.13-2.53 2.53-2.53h25.26c1.4 0 2.53 1.13 2.53 2.53V48zM30.95 32.84v5.05h-5.06v-5.05h5.06zm7.58 5.05h-5.06v-5.05h5.06v5.05zm-7.58 2.53v5.05h-5.06v-5.05h5.06zm7.58 5.05h-5.06v-5.05h5.06v5.05zm7.58-12.63v5.05h-5.06v-5.05h5.06zm0 7.58v5.05h-5.06v-5.05h5.06z"/>\n</svg>\n'},40191:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path d="M21 9C21 7.89543 20.1046 7 19 7H18V6C18 5.44772 17.5523 5 17 5C16.4477 5 16 5.44772 16 6V7H14V6C14 5.44772 13.5523 5 13 5C12.4477 5 12 5.44772 12 6V7H10V6C10 5.44772 9.55228 5 9 5C8.44772 5 8 5.44772 8 6V7H7C5.89543 7 5 7.89543 5 9V19C5 20.1046 5.89543 21 7 21H19C20.1046 21 21 20.1046 21 19V9ZM19 18C19 18.5523 18.5523 19 18 19H8C7.44772 19 7 18.5523 7 18V11C7 10.4477 7.44772 10 8 10H18C18.5523 10 19 10.4477 19 11V18Z" />\n  <path d="M9 12H11V14H9V12ZM12 12H14V14H12V12ZM9 15H11V17H9V15ZM12 15H14V17H12V15ZM15 12H17V14H15V12ZM15 15H17V17H15V15Z" />\n</svg>\n'},33395:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M4 8V6H6V8H4Z"/>\n  <path d="M7 6V8H9V6H7Z"/>\n  <path d="M12 8V6H10V8H12Z"/>\n  <path d="M6 11V9H4V11H6Z"/>\n  <path d="M7 9V11H9V9H7Z"/>\n  <path d="M12 11V9H10V11H12Z"/>\n  <path fill-rule="evenodd" d="M4 1C3.44772 1 3 1.44772 3 2C1.89543 2 1 2.89543 1 4V12C1 13.1046 1.89543 14 3 14H13C14.1046 14 15 13.1046 15 12V4C15 2.89543 14.1046 2 13 2C13 1.44772 12.5523 1 12 1C11.4477 1 11 1.44772 11 2L9 2C9 1.44772 8.55228 1 8 1C7.44772 1 7 1.44772 7 2L5 2C5 1.44772 4.55228 1 4 1ZM13 5V12H3L3 5H13Z"/>\n</svg>\n'},28586:e=>{e.exports='<svg viewBox="0 0 26 26"  xmlns="http://www.w3.org/2000/svg">\n    <path fill-rule="evenodd" d="M19 6a2 2 0 012 2v4.299a5.243 5.243 0 00-2-.293V10a1 1 0 00-1-1H8a1 1 0 00-1 1v7a1 1 0 001 1h1.256a4.493 4.493 0 00-.229 2H7a2 2 0 01-2-2V8a2 2 0 012-2h1V5a1 1 0 012 0v1h2V5a1 1 0 112 0v1h2V5a1 1 0 112 0v1h1zm-8 9.758a4.514 4.514 0 00-.329.242H9v-2h2v1.758zm6-3.253c-.294.14-.572.306-.833.495H15v-2h2v1.505zM11 13v-2H9v2h2zm3 0v-2h-2v2h2z" />\n    <path d="M22.372 17.338A2.406 2.406 0 0124 19.6c0 1.326-1.086 2.4-2.446 2.4h-8.108C12.094 22 11 20.922 11 19.6c0-1.051.682-1.944 1.643-2.269a2.021 2.021 0 012.013-1.731c.542 0 1.034.208 1.398.549A3.25 3.25 0 0119.125 14c1.796 0 3.25 1.432 3.25 3.2l-.003.138z"/>\n</svg>'},92529:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M6 5H4v2h2V5zm0 3H4v2h2V8zm1-3h2v2H7V5zm2 3H7v2h2V8zm1-3h2v2h-2V5zm2 3h-2v2h2V8z"/>\n  <path fill-rule="evenodd" d="M4 1a1 1 0 012 0h1a1 1 0 012 0h1a1 1 0 112 0h.5A2.5 2.5 0 0115 3.5v8a2.5 2.5 0 01-2.5 2.5h-9A2.5 2.5 0 011 11.5v-8A2.5 2.5 0 013.5 1H4zM2 4v7.5A1.5 1.5 0 003.5 13h9a1.5 1.5 0 001.5-1.5V4a1 1 0 00-1-1H3a1 1 0 00-1 1z"/>\n</svg>\n'},2365:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path class="small-icon-fill" fill-rule="evenodd" d="M14 3H2v10h12V3zM4 5h2v2H4V5zm0 3h2v2H4V8zm5-3H7v2h2V5zM7 8h2v2H7V8zm5-3h-2v2h2V5zm-2 3h2v2h-2V8z"/>\n  <path class="small-icon-outline" fill-rule="evenodd" d="M4 1a1 1 0 012 0h1a1 1 0 012 0h1a1 1 0 112 0h.5A2.5 2.5 0 0115 3.5v8a2.5 2.5 0 01-2.5 2.5h-9A2.5 2.5 0 011 11.5v-8A2.5 2.5 0 013.5 1H4zM2 4v7.5A1.5 1.5 0 003.5 13h9a1.5 1.5 0 001.5-1.5V4a1 1 0 00-1-1H3a1 1 0 00-1 1z"/>\n</svg>\n'},52504:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M13.907 2.79a.5.5 0 00-.814-.58L8.436 8.73 5.854 6.145a.5.5 0 10-.708.708l3 3a.5.5 0 00.76-.063l5-7zM3.147 4.147A.5.5 0 013.5 4h5a.5.5 0 000-1h-5A1.5 1.5 0 002 4.5v8A1.5 1.5 0 003.5 14h8a1.5 1.5 0 001.5-1.5v-2a.5.5 0 00-1 0v2a.5.5 0 01-.5.5h-8a.5.5 0 01-.5-.5v-8a.5.5 0 01.146-.354z"/>\n</svg>\n'},12853:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path d="M13 16C14.1046 16 15 15.1046 15 14C15 12.8954 14.1046 12 13 12C11.8954 12 11 12.8954 11 14C11 15.1046 11.8954 16 13 16Z"/>\n  <path fill-rule="evenodd" d="M10.5 6C9.11929 6 8 7.11929 8 8.5C8 8.77614 7.77614 9 7.5 9H7C5.34315 9 4 10.3431 4 12V17C4 18.6569 5.34315 20 7 20H19C20.6569 20 22 18.6569 22 17V12C22 10.3431 20.6569 9 19 9H18.5C18.2239 9 18 8.77614 18 8.5C18 7.11929 16.8807 6 15.5 6H10.5ZM10 8.5C10 8.22386 10.2239 8 10.5 8H15.5C15.7761 8 16 8.22386 16 8.5C16 9.88071 17.1193 11 18.5 11H19C19.5523 11 20 11.4477 20 12V17C20 17.5523 19.5523 18 19 18H7C6.44772 18 6 17.5523 6 17V12C6 11.4477 6.44772 11 7 11H7.5C8.88071 11 10 9.88071 10 8.5Z"/>\n</svg>\n'},56035:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M8 11C9.10457 11 10 10.1046 10 9C10 7.89543 9.10457 7 8 7C6.89543 7 6 7.89543 6 9C6 10.1046 6.89543 11 8 11Z"/>\n  <path fill-rule="evenodd" d="M6 2C4.89543 2 4 2.89543 4 4H3C1.34315 4 0 5.34315 0 7V11C0 12.6569 1.34315 14 3 14H13C14.6569 14 16 12.6569 16 11V7C16 5.34315 14.6569 4 13 4H12C12 2.89543 11.1046 2 10 2H6ZM6 4H10C10 5.10457 10.8954 6 12 6H13C13.5523 6 14 6.44772 14 7V11C14 11.5523 13.5523 12 13 12H3C2.44772 12 2 11.5523 2 11V7C2 6.44772 2.44772 6 3 6H4C5.10457 6 6 5.10457 6 4Z"/>\n</svg>\n'},70807:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M22 8.086c0-.696-.547-1.086-1.319-1.086h-17.681l3.897 4 11.103-2-9.154 5v8l12.667-13c.221-.223.487-.591.487-.914z"/></svg>'},5096:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M16 3.869c0-.557-.461-.869-1.111-.869h-14.889l3.282 3.2 9.35-1.6-7.709 4v6.4l10.667-10.4c.186-.178.41-.473.41-.731z"/></svg>'},51555:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M0 2h14.546c.359 0 .715.09.992.31.292.231.461.579.461.991 0 .25-.098.471-.189.625-.095.162-.213.304-.319.411l-10.492 10.664v-8l-5-5zm2.5.95l2.5 2.55 7-1.5-6 3.5.003 5 8.863-8.848.176-.225.054-.125c0-.117-.038-.183-.101-.232-.077-.061-.223-.119-.45-.119h-12.046z"/>\n</svg>\n'},30135:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path class="small-icon-fill" d="M1.5 2.5H15l.5 1-9.5 10V7L1.5 2.5z"/>\n  <path class="small-icon-outline" fill-rule="evenodd" d="M0 2h14.546c.359 0 .715.09.992.31.292.231.461.579.461.991 0 .25-.098.471-.189.625-.095.162-.213.304-.319.411l-10.492 10.664v-8l-5-5zm2.5.95l2.5 2.55 7-1.5-6 3.5.003 5 8.863-8.848.176-.225.054-.125c0-.117-.038-.183-.101-.232-.077-.061-.223-.119-.45-.119h-12.046z"/>\n</svg>\n'},78297:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M4.5 3L3 4.5 6.5 8 3 11.5 4.414 13 9.5 8l-5-5zm5 0L8 4.5 11.5 8 8 11.5 9.414 13 14.5 8l-5-5z"/>\n</svg>\n'},4799:e=>{e.exports='<svg width="11" height="6" viewBox="0 0 11 6" xmlns="http://www.w3.org/2000/svg">\n  <path d="M5.5.133l.11-.11 4.456 4.456-1.498 1.497L5.5 2.91 2.432 5.976.934 4.48 5.39.022l.11.11z" />\n</svg>\n'},87268:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <circle\n    fill="var(--kIconCircleFill)"\n    stroke="var(--kIconCircleStroke)"\n    stroke-width="1.1"\n    stroke-opacity="0.8"\n    cx="8" cy="8" r="4.5" />\n</svg>\n'},78990:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <circle cx="8" cy="8" r="3" />\n</svg>\n'},78553:e=>{e.exports='<svg wisth="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <g clip-path="url(#clear-downloads-clip)" fill-rule="evenodd" clip-rule="evenodd">\n    <path d="M9.385.077a1 1 0 01.538 1.308L7.775 6.54l.238.089c.536.201.78.813.682 1.377-.345 2.006.867 3.83 2.152 5.277.589.662.156 1.716-.73 1.716H2a.968.968 0 01-.979-1c.193-4.414 1.683-6.152 3.523-8.036a.999.999 0 011.065-.236l.292.11L8.077.615A1 1 0 019.385.077zM6.3 13h1.79c-.858-1.282-1.576-2.902-1.438-4.745l-1.13-.423c-.673.716-1.182 1.343-1.578 2.114-.376.734-.689 1.68-.842 3.054h1.98l-.464-1.854a.6.6 0 111.164-.292l.5 2A.602.602 0 016.3 13z"/>\n    <path opacity=".35" d="M14.985 7H11V6h3.985v1zm0 2H11V8h3.985v1zM12 11h3v-1h-3v1z"/>\n  </g>\n  <defs>\n    <clipPath id="clear-downloads-clip">\n      <path fill="white" d="M0 0h16v16H0z"/>\n    </clipPath>\n  </defs>\n</svg>\n'},59607:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M9.455 1.207a.5.5 0 00-.91-.414L6.2 5.95l-.592-.222a.999.999 0 00-1.065.236C2.704 7.848 1.214 9.586 1.021 14a.968.968 0 00.98 1h8.116c.886 0 1.319-1.053.73-1.716-1.285-1.448-2.497-3.27-2.152-5.277.097-.564-.146-1.176-.682-1.377l-.874-.328 2.316-5.095zM6.382 14H5.4a.601.601 0 00-.02-.155l-.8-3a.6.6 0 10-1.16.31L4.18 14H2.022c.095-2.072.489-3.45 1.032-4.51.553-1.078 1.292-1.892 2.204-2.825l2.403.9v.001a.133.133 0 01.024.038c.025.054.04.14.025.234-.43 2.503 1.09 4.647 2.39 6.11.009.01.012.017.014.02a.033.033 0 01.003.01.05.05 0 01-.003.022H7.6a.601.601 0 00-.018-.146l-.5-2a.6.6 0 10-1.164.292L6.382 14z"/>\n  <path opacity=".35" fill-rule="evenodd" clip-rule="evenodd" d="M14.985 7H11V6h3.985v1zm0 2H11V8h3.985v1zM12 11h3v-1h-3v1z"/>\n</svg>\n'},72864:e=>{e.exports='<svg class="ClockGraphic" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">\n  <circle class="ClockGraphic-Hour-Indicator" r="17" cx="50" cy="50"/>\n  <circle class="ClockGraphic-Minute-Indicator" r="29" cx="50" cy="50"/>\n  <path d="M50 1C50.5523 1 51 1.44772 51 2L51 12C51 12.5523 50.5523 13 50 13C49.4477 13 49 12.5523 49 12L49 2C49 1.44771 49.4477 1 50 1ZM31.5 17.9571C31.0217 18.2332 30.4101 18.0693 30.134 17.591L25.134 8.93078C24.8578 8.45249 25.0217 7.8409 25.5 7.56475C25.9783 7.28861 26.5899 7.45249 26.866 7.93078L31.866 16.591C32.1422 17.0693 31.9783 17.6809 31.5 17.9571ZM12 51C12.5523 51 13 50.5523 13 50C13 49.4477 12.5523 49 12 49L2 49C1.44772 49 1 49.4477 1 50C1 50.5523 1.44772 51 2 51L12 51ZM17.591 69.866C18.0693 69.5899 18.2332 68.9783 17.9571 68.5C17.6809 68.0217 17.0693 67.8578 16.591 68.134L7.93078 73.134C7.45249 73.4101 7.28861 74.0217 7.56475 74.5C7.8409 74.9783 8.45249 75.1422 8.93078 74.866L17.591 69.866ZM51 88C51 87.4477 50.5523 87 50 87C49.4477 87 49 87.4477 49 88L49 98C49 98.5523 49.4477 99 50 99C50.5523 99 51 98.5523 51 98L51 88ZM31.5 82.0429C31.9783 82.3191 32.1422 82.9307 31.866 83.409L26.866 92.0692C26.5899 92.5475 25.9783 92.7114 25.5 92.4352C25.0217 92.1591 24.8578 91.5475 25.134 91.0692L30.134 82.409C30.4101 81.9307 31.0217 81.7668 31.5 82.0429ZM16.591 31.866C17.0693 32.1422 17.6809 31.9783 17.9571 31.5C18.2332 31.0217 18.0693 30.4101 17.591 30.134L8.93078 25.134C8.45249 24.8578 7.8409 25.0217 7.56476 25.5C7.28862 25.9783 7.45249 26.5899 7.93078 26.866L16.591 31.866ZM92.0692 26.866C92.5475 26.5899 92.7114 25.9783 92.4353 25.5C92.1591 25.0217 91.5475 24.8578 91.0692 25.134L82.409 30.134C81.9307 30.4101 81.7668 31.0217 82.0429 31.5C82.3191 31.9783 82.9307 32.1422 83.409 31.866L92.0692 26.866ZM74.5 7.56476C74.9783 7.8409 75.1422 8.45249 74.866 8.93078L69.866 17.591C69.5899 18.0693 68.9783 18.2332 68.5 17.9571C68.0217 17.6809 67.8578 17.0693 68.134 16.591L73.134 7.93078C73.4101 7.45249 74.0217 7.28861 74.5 7.56476ZM98 51C98.5523 51 99 50.5523 99 50C99 49.4477 98.5523 49 98 49L88 49C87.4477 49 87 49.4477 87 50C87 50.5523 87.4477 51 88 51L98 51ZM74.5 92.4352C74.0217 92.7114 73.4101 92.5475 73.134 92.0692L68.134 83.409C67.8578 82.9307 68.0217 82.3191 68.5 82.0429C68.9783 81.7668 69.5899 81.9307 69.866 82.409L74.866 91.0692C75.1422 91.5475 74.9783 92.1591 74.5 92.4352ZM91.0692 74.866C91.5475 75.1422 92.1591 74.9783 92.4352 74.5C92.7114 74.0217 92.5475 73.4101 92.0692 73.134L83.409 68.134C82.9307 67.8578 82.3191 68.0217 82.0429 68.5C81.7668 68.9783 81.9307 69.5899 82.409 69.866L91.0692 74.866Z" />\n  <path class="ClockGraphic-Hour-Hand" d="M71.1642 50.4857C71.6384 50.4918 72 50.4964 72 50C72 49.4925 71.622 49.4955 71.1322 49.4993C71.089 49.4997 71.0448 49.5 71 49.5L52.0706 48.5986C51.621 47.9356 50.8614 47.5 50 47.5C48.6193 47.5 47.5 48.6193 47.5 50C47.5 51.3807 48.6193 52.5 50 52.5C50.8621 52.5 51.6222 52.0637 52.0717 51.3998L71 50.4844C71.0559 50.4844 71.1108 50.4851 71.1642 50.4857Z"/>\n  <path class="ClockGraphic-Minute-Hand" d="M50.4858 16.8358C50.4918 16.3616 50.4964 16 50 16C49.4925 16 49.4955 16.378 49.4993 16.8678C49.4997 16.911 49.5 16.9552 49.5 17L48.562 47.9547C47.9196 48.4072 47.5 49.1546 47.5 50C47.5 51.3807 48.6193 52.5 50 52.5C51.3807 52.5 52.5 51.3807 52.5 50C52.5 49.1542 52.0799 48.4064 51.437 47.954L50.4844 17C50.4844 16.9441 50.4851 16.8892 50.4858 16.8358Z" />\n  <path class="ClockGraphic-Second-Hand" d="M50.5 6H49.5V47.55C48.3589 47.7816 47.5 48.7905 47.5 50C47.5 51.3807 48.6193 52.5 50 52.5C51.3807 52.5 52.5 51.3807 52.5 50C52.5 48.7905 51.6411 47.7816 50.5 47.55V6Z" />\n  <circle class="ClockGraphic-CenterCutout" cx="50" cy="50" r="1.5" />\n</svg>'},79448:e=>{e.exports='<svg class="ClockIcon ClockIcon--large" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n<rect class="ClockIcon-TimeMinute" x="12" y="7" width="2" height="7" rx="1"/>\n<rect class="ClockIcon-TimeHour" x="12" y="12" width="5" height="2" rx="1"/>\n<path fill-rule="evenodd" d="M13 20.3C17.0317 20.3 20.3 17.0317 20.3 13C20.3 8.96832 17.0317 5.7 13 5.7C8.96832 5.7 5.7 8.96832 5.7 13C5.7 17.0317 8.96832 20.3 13 20.3ZM13 22C17.9706 22 22 17.9706 22 13C22 8.02944 17.9706 4 13 4C8.02944 4 4 8.02944 4 13C4 17.9706 8.02944 22 13 22Z"/>\n<path class="ClockIcon-AlarmBell" d="M4.05328 3.05322C2.67257 4.43393 2.67257 6.67251 4.05328 8.05322L9.05328 3.05322C7.67257 1.67251 5.434 1.67251 4.05328 3.05322Z"/>\n<path class="ClockIcon-AlarmBell" d="M22 3.05322C23.3807 4.43393 23.3807 6.67251 22 8.05322L17 3.05322C18.3807 1.67251 20.6193 1.67251 22 3.05322Z"/>\n<circle class="ClockIcon-CountdownHour" cx="13" cy="13" r="4"/>\n<circle class="ClockIcon-CountdownMinute" cx="13" cy="13" r="4"/>\n</svg>\n'},14021:e=>{e.exports='<svg class="ClockIcon ClockIcon--medium" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n<rect class="ClockIcon-TimeMinute" x="7" y="4" width="2" height="5" rx="1" />\n<rect class="ClockIcon-TimeHour" x="7" y="7" width="4" height="2" rx="1" />\n<path fill-rule="evenodd" d="M8 13.4C10.9823 13.4 13.4 10.9823 13.4 8C13.4 5.01766 10.9823 2.6 8 2.6C5.01766 2.6 2.6 5.01766 2.6 8C2.6 10.9823 5.01766 13.4 8 13.4ZM8 15C11.866 15 15 11.866 15 8C15 4.13401 11.866 1 8 1C4.13401 1 1 4.13401 1 8C1 11.866 4.13401 15 8 15Z" />\n<path class="ClockIcon-AlarmBell" d="M1.00001 0.99996C-0.114362 2.11433 -0.114362 3.92107 1.00001 5.03544L5.03549 0.99996C3.92112 -0.114407 2.11437 -0.114407 1.00001 0.99996Z"/>\n<path class="ClockIcon-AlarmBell" d="M15.0355 0.99996C16.1499 2.11433 16.1499 3.92107 15.0355 5.03544L11 0.99996C12.1144 -0.114407 13.9211 -0.114407 15.0355 0.99996Z"/>\n<circle class="ClockIcon-CountdownHour" cx="8" cy="8" r="3"/>\n<circle class="ClockIcon-CountdownMinute" cx="8" cy="8" r="3"/>\n</svg>\n'},68777:e=>{e.exports='<svg class="ClockIcon ClockIcon--small" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n<rect class="ClockIcon-TimeMinute" x="7.5" y="3" width="1" height="5.5" rx="0.5"/>\n<rect class="ClockIcon-TimeHour" x="7.5" y="7.5" width="3.5" height="1" rx="0.5"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M8 14C11.3137 14 14 11.3137 14 8C14 4.68629 11.3137 2 8 2C4.68629 2 2 4.68629 2 8C2 11.3137 4.68629 14 8 14ZM8 15C11.866 15 15 11.866 15 8C15 4.13401 11.866 1 8 1C4.13401 1 1 4.13401 1 8C1 11.866 4.13401 15 8 15Z"/>\n<path class="ClockIcon-AlarmBell" d="M1.00001 0.99996C-0.114362 2.11433 -0.114362 3.92107 1.00001 5.03544L5.03549 0.99996C3.92112 -0.114407 2.11437 -0.114407 1.00001 0.99996Z"/>\n<path class="ClockIcon-AlarmBell" d="M15.0355 0.99996C16.1499 2.11433 16.1499 3.92107 15.0355 5.03544L11 0.99996C12.1144 -0.114407 13.9211 -0.114407 15.0355 0.99996Z"/>\n<circle class="ClockIcon-CountdownHour" cx="8" cy="8" r="3"/>\n<circle class="ClockIcon-CountdownMinute" cx="8" cy="8" r="3"/>\n</svg>'},57396:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M4.29289 4.29289C4.68342 3.90237 5.31658 3.90237 5.70711 4.29289L8 6.58579L10.2929 4.29289C10.6834 3.90237 11.3166 3.90237 11.7071 4.29289C12.0976 4.68342 12.0976 5.31658 11.7071 5.70711L9.41421 8L11.7071 10.2929C12.0976 10.6834 12.0976 11.3166 11.7071 11.7071C11.3166 12.0976 10.6834 12.0976 10.2929 11.7071L8 9.41421L5.70711 11.7071C5.31658 12.0976 4.68342 12.0976 4.29289 11.7071C3.90237 11.3166 3.90237 10.6834 4.29289 10.2929L6.58579 8L4.29289 5.70711C3.90237 5.31658 3.90237 4.68342 4.29289 4.29289Z"/>\n</svg>\n'},24344:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26">\n  <path d="M13 4.2c.4-1.2-1.5-2-2.5-2.2.2 0 .7.5.7 1.6C11.3 5 9 5.7 9 7.4c.1 1.4 2.1 2.3 3.1 2.6l-1.4-1.4c-1-1 1.6-2.9 2.2-4.4zM16 7.4c.2-.8-.7-1.3-1.2-1.4 0 0 .3.3.3 1 0 .8-1.2 1.3-1.1 2.4 0 .9 1 1.4 1.6 1.6l-.8-.8c-.5-.7.9-1.9 1.2-2.8z"/>\n  <path fill-rule="evenodd" d="M6.2 12c0 1.5.4 5.2 3.2 7H6.2c0 .7.6 2 2.4 2h8.8c.8-.1 2.3-.6 2.2-2h-3.4l1.2-1c2.8-.3 4-1.2 4-3a2 2 0 00-1.8-2v-.8-.2H6.3zm13.3 1.8a8.2 8.2 0 01-1.2 3.1c.5.2 2-.5 2.2-1.4.3-1-.4-1.5-1-1.7z"/>\n</svg>\n'},32132:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path d="M7.4 1.7C7.8.7 6.4.2 5.6 0c.2 0 .5.4.5 1.2.1 1.1-1.7 1.7-1.6 3 0 1.1 1.6 1.8 2.3 2l-1-1c-.9-.9 1.1-2.3 1.6-3.5zM9.6 4.2c.2-.6-.5-1-.8-1 0 0 .2.1.2.7s-.9 1-.8 1.9c0 .6.8 1 1.2 1.2l-.6-.7c-.4-.5.6-1.4.8-2.1z"/>\n  <path fill-rule="evenodd" d="M2.7 7c0 1.1.3 3.6 2.3 5H2.7c0 .5.4 2 1.7 2h7.3c.6 0 1.6-1 1.6-2H11l.7-.5c1.6 0 2.8-.7 2.8-2 0-1-.8-1.4-1.2-1.4v-.8V7H2.7zm10.5 1.7A4.4 4.4 0 0112 11c.4 0 1.8-.4 2-1.1 0-.7-.4-1.1-.8-1.2z"/>\n</svg>\n'},59260:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path d="M7.4 1.7C7.8.7 6.4.2 5.6 0c.2 0 .5.4.5 1.2.1 1.1-1.7 1.7-1.6 3 0 1.1 1.6 1.8 2.3 2l-1-1c-.9-.9 1.1-2.3 1.6-3.5zM9.6 4.2c.2-.6-.5-1-.8-1 0 0 .2.1.2.7s-.9 1-.8 1.9c0 .6.8 1 1.2 1.2l-.6-.7c-.4-.5.6-1.4.8-2.1z"/>\n  <path fill-rule="evenodd" d="M12.7 8.1a13 13 0 00.1-1L3.2 7a8.4 8.4 0 000 1c0 1.2.3 2.8 1 4a3.3 3.3 0 001 1H3c0 .5.3 1 1.5 1h6.6c.6 0 1.6-.6 1.6-1h-2.1l.8-.8h.4c.3.2.7 0 .9 0l.6-.3c.4-.3.9-.7 1-1.4a2 2 0 00-.3-1.6 2 2 0 00-1.1-.7h-.3zm-2.5 4l-1.3.9h-2l-1.1-.8c-.6-.4-1-1.3-1.3-2.5L4.2 8h7.6l-.4 2c-.3 1.1-.8 1.9-1.2 2.2zm3.3-1.8c-.2.7-1 1-1.4 1a3.6 3.6 0 00.6-1.5v-.6c.5 0 .9.4.8 1.1z"/>\n</svg>\n'},12340:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M13 5l3 2.5-3 2.5v-5zM0 4h11v1h-11zM0 6h11v1h-11zM0 8h11v1h-11zM0 10h7v1h-7z"/></svg>'},85749:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M15 10l-3-2.5 3-2.5v5zM3 4h7v1h-7zM3 6h7v1h-7zM3 8h7v1h-7zM3 10h4v1h-4z"/></svg>'},74836:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.5 3c-1.933 0-3.5 1.567-3.5 3.5 0 .763.244 1.468.659 2.044l.015.021 2.393 4.173c.192.335.675.335.868 0l2.393-4.173.015-.021c.414-.574.658-1.28.658-2.044 0-1.933-1.567-3.5-3.5-3.5zm-4.5 3.5c0-2.485 2.015-4.5 4.5-4.5s4.5 2.015 4.5 4.5c0 .971-.308 1.871-.832 2.607l-2.367 4.129c-.576 1.005-2.026 1.005-2.603 0l-2.367-4.129c-.523-.736-.832-1.636-.832-2.607zm2.4 0c0-1.16.94-2.1 2.1-2.1 1.16 0 2.1.94 2.1 2.1 0 1.16-.94 2.1-2.1 2.1-1.16 0-2.1-.94-2.1-2.1zm2.1-1.1c-.608 0-1.1.492-1.1 1.1 0 .608.492 1.1 1.1 1.1.608 0 1.1-.492 1.1-1.1 0-.608-.492-1.1-1.1-1.1z"/>\n</svg>\n'},19194:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M11.293 5h-6.586l3.293 3.293 3.293-3.293zm-8 0h-.293v6h10v-6h-.293l-4.354 4.354-.354.354-.354-.354-4.354-4.354zm-1.293 0c0-.552.448-1 1-1h10c.552 0 1 .448 1 1v6c0 .552-.448 1-1 1h-10c-.552 0-1-.448-1-1v-6z"/>\n</svg>\n'},19914:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M6.962 2.392c.481.347.867.895 1.078 1.55.211.655.22 1.333.043 1.906-.176.571-.555 1.083-1.145 1.295l-.31.078c.117.414.284.828.504 1.231.203.372.437.707.691 1.002l.204-.225c.465-.43 1.085-.53 1.664-.4.576.129 1.137.484 1.572 1.009.435.525.688 1.151.73 1.751.043.598-.123 1.213-.582 1.638-.467.431-1.377.845-2.536.761-1.898-.137-3.372-1.757-4.509-3.838-.571-1.045-1.013-2.2-1.226-3.306-.211-1.097-.207-2.198.179-3.096.169-.393.549-.758.888-1.024.351-.275.756-.517 1.069-.63.595-.214 1.205-.052 1.686.296zm-.585.811c-.286-.206-.553-.241-.763-.166-.178.064-.49.24-.792.476-.313.245-.521.481-.585.631-.275.641-.308 1.515-.116 2.512.19.988.592 2.046 1.122 3.016 1.114 2.039 2.359 3.223 3.704 3.32.895.065 1.53-.263 1.785-.498.18-.167.291-.452.264-.833-.027-.378-.191-.808-.503-1.184-.312-.377-.687-.597-1.02-.671-.33-.074-.592-.003-.767.159-.116.107-.201.26-.242.457l-.175.846-.646-.573c-.532-.472-1.008-1.066-1.388-1.761-.386-.706-.635-1.448-.753-2.177l-.13-.808.778.252c.164.053.314.051.45.003.215-.077.417-.287.528-.649.111-.359.115-.826-.039-1.305s-.425-.84-.712-1.046z" />\n</svg>\n'},54098:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path opacity="0.5" d="M15.3601 14.0944C15.7634 13.2763 16 12.3882 16 11.5V10.7C16 8.97393 15.2386 7.41339 14.0397 6.36118C14.5271 5.47393 15.0397 5 16.5 5C18 5 19 6.3 19 7.5V8.5C19 9.49998 18.5 9.99995 18.0001 10.4999L20 12.5C20.5 13 21 13.5 21 14C21 14.5 20.5 15 20 15.0343H16.3L15.3601 14.0944Z"/>\n  <path d="M15 17L12.5 14.5C13.4 13.8 14 12.7 14 11.5V10.7C14 8.79999 12.6 7.09999 10.7 6.99999C8.7 6.89999 7 8.49999 7 10.5V11.5C7 12.7 7.6 13.8 8.5 14.5L6 17C5.5 17.5 5 18 5 19C5 19.6 5.4 20 6 20H15C15.6 20 16 19.6 16 19C16 18.5 15.5 17.5 15 17Z"/>\n</svg>\n'},83075:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M6.32251 9.83154L7.19854 9.13994C7.79551 8.66865 8.18182 7.93438 8.18182 7.15653V6.41832C8.18182 5.10311 7.23661 4.06267 6.1298 4.00275C4.89183 3.94068 3.81818 4.95267 3.81818 6.23377V7.15653C3.81818 7.93438 4.20449 8.66865 4.80146 9.13994L5.67749 9.83154L4.89418 10.6266L2.62145 12.9335C2.38143 13.1772 2.24309 13.3243 2.14494 13.4903C2.07175 13.6141 2.0124 13.7656 2.00172 14H9.98007C9.97658 13.9875 9.97247 13.9736 9.96766 13.9582C9.93608 13.8575 9.88589 13.7325 9.81884 13.5964C9.67866 13.3118 9.50782 13.0648 9.37855 12.9335L7.10582 10.6266L6.32251 9.83154ZM6.18182 3.0041C7.90909 3.09638 9.18182 4.66507 9.18182 6.41832V7.15653C9.18182 7.98554 8.87609 8.76283 8.37907 9.37224C8.21222 9.57682 8.02382 9.76248 7.81818 9.92482L8.52329 10.6405L10.0909 12.2317C10.5455 12.6931 11 13.6159 11 14.0772C11 14.6309 10.6364 15 10.0909 15H1.90909C1.36364 15 1 14.6309 1 14.0772C1 13.1545 1.45455 12.6931 1.90909 12.2317L3.47671 10.6405L4.18182 9.92482C3.97618 9.76248 3.78778 9.57682 3.62093 9.37224C3.12391 8.76283 2.81818 7.98554 2.81818 7.15653V6.23377C2.81818 4.38824 4.36364 2.91183 6.18182 3.0041Z"/>\n  <path opacity="0.5" d="M10.1383 9.15699C10.4859 8.42321 10.6899 7.6266 10.6899 6.82998V6.11244C10.6899 4.5643 10.0335 3.16461 9 2.22087C9.42021 1.42507 9.86201 1 11.1209 1C12.4139 1 13.2759 2.166 13.2759 3.2423V4.13922C13.2759 5.03612 12.845 5.48456 12.414 5.93301L14.138 7.72688C14.569 8.17534 15 8.6238 15 9.07226C15 9.52072 14.569 9.96918 14.138 10H10.9485L10.1383 9.15699Z"/>\n</svg>\n'},38546:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path class="small-icon-fill" d="M4 4h4l.5 3-1 3 2.5 3 .5 1.5h-9l1-2 2-2.5-1-3L4 4z"/>\n  <path class="small-icon-outline" fill-rule="evenodd" d="M6.323 9.832l.876-.692c.597-.471.983-1.206.983-1.983v-.739c0-1.315-.945-2.355-2.052-2.415-1.238-.062-2.312.95-2.312 2.23v.924c0 .777.386 1.512.983 1.983l.876.692-.783.795-2.273 2.306c-.24.244-.378.391-.476.557a1.038 1.038 0 00-.143.51H9.98a2.621 2.621 0 00-.161-.404 2.758 2.758 0 00-.44-.662l-2.273-2.307-.783-.795zm-.141-6.828c1.727.092 3 1.661 3 3.414v.739c0 .829-.306 1.606-.803 2.215-.167.205-.355.39-.56.553l.704.715 1.568 1.592c.455.461.909 1.384.909 1.845 0 .554-.364.923-.91.923H1.91c-.546 0-.91-.37-.91-.923 0-.922.455-1.384.91-1.845l1.567-1.591.705-.716a3.616 3.616 0 01-.561-.553 3.516 3.516 0 01-.803-2.215v-.923c0-1.846 1.546-3.322 3.364-3.23z"/>\n  <path class="small-icon-outline" opacity=".5" d="M10.138 9.157c.348-.734.552-1.53.552-2.327v-.718A5.267 5.267 0 009 2.221C9.42 1.425 9.862 1 11.12 1c1.294 0 2.156 1.166 2.156 2.242v.897c0 .897-.431 1.346-.862 1.794l1.724 1.794c.431.448.862.897.862 1.345 0 .449-.431.897-.862.928h-3.19l-.81-.843z"/>\n</svg>\n'},31789:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" clip-rule="evenodd" d="M2.5 2C2.22386 2 2 2.22386 2 2.5V12.5C2 12.7761 2.22386 13 2.5 13H5.5C5.77614 13 6 12.7761 6 12.5C6 12.2239 5.77614 12 5.5 12H3V3H10V4.5C10 4.77614 10.2239 5 10.5 5C10.7761 5 11 4.77614 11 4.5V2.5C11 2.22386 10.7761 2 10.5 2H2.5ZM7.5 6C7.22386 6 7 6.22386 7 6.5V13.5C7 13.7761 7.22386 14 7.5 14H13.5C13.7761 14 14 13.7761 14 13.5V6.5C14 6.22386 13.7761 6 13.5 6H7.5ZM8 13V7H13V13H8Z"/>\n</svg>'},6055:e=>{e.exports='<svg width="48" height="48" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M24 14a1 1 0 00-1 1v8h-8a1 1 0 100 2h8v8a1 1 0 102 0v-8h8a1 1 0 100-2h-8v-8a1 1 0 00-1-1z"/>\n</svg>\n'},46639:e=>{e.exports='\x3c!--  Mask definitions for SVG icons --\x3e\n<defs>\n  \x3c!-- shared paths --\x3e\n  <path id="folder-shape"\n    d="M0 3 1 2 7 2 8 3 8 4 15 4 16 5 16 13 15 14 1 14 0 13 Z"\n    stroke="#fff"\n    stroke-width="2"\n    stroke-opacity="1" />\n\n  <path id="sync-cloud"\n    d="M13.996 7.172C15.164 7.585 16 8.697 16 10c0 1.657-1.337 3-3.01 3H3.01C1.346 13 0 11.653 0 10c0-1.314.84-2.43 2.022-2.836C2.187 5.942 3.232 5 4.5 5c.667 0 1.272.26 1.72.686C6.765 4.123 8.25 3 10 3c2.21 0 4 1.79 4 4 0 .058 0 .115-.004.172z"/>\n\n  <g id="sd-group">\n    <path fill="#000" d="M8 8h8v8h-8z"/>\n    <path fill="#fff" d="M13 9h3v3h-3z"/>\n    <path fill="#fff" d="M13 13h3v3h-3z"/>\n    <path fill="#fff" d="M9 9h3v3h-3z"/>\n    <path fill="#fff" d="M9 13h3v3h-3z"/>\n  </g>\n\n  <path id="sd-bookmark"\n    d="M44 29v34l11-5.667 11 5.667v-34h-22zm11 24.5l-8 4.41v-25.91h16v26l-8-4.5z"/>\n\n  <filter id="sd-bookmark-filter" x="-50%" y="-50%" width="200%" height="200%" filterUnits="objectBoundingBox">\n    <feOffset dx="1" dy="1" in="SourceAlpha" result="shadowOffset"/>\n    <feGaussianBlur stdDeviation=".5" in="shadowOffset" result="shadowBlur"/>\n    <feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.08 0" in="shadowBlur"/>\n  </filter>\n\n  \x3c!-- gradients --\x3e\n  <linearGradient id="border-gradient" x1="0" y1="0" x2="0" y2="1">\n    <stop stop-color="#fff" stop-opacity="0.3" offset="0"/>\n    <stop stop-color="#fff" stop-opacity="0.6" offset="1"/>\n  </linearGradient>\n\n  <linearGradient id="icon-gradient" x1="0" y1="0" x2="0" y2="1">\n    <stop stop-color="#fff" stop-opacity="0" offset="0.3"/>\n    <stop stop-color="#fff" stop-opacity="0.2" offset="1"/>\n  </linearGradient>\n\n  <linearGradient id="sd-bookmark-gradient" x1="0" y1="1" x2="1" y2="1">\n    <stop stop-color="#000" stop-opacity="0" offset="0.5"/>\n    <stop stop-color="#000" stop-opacity="1" offset="0.5"/>\n  </linearGradient>\n\n  <linearGradient id="sd-folder-gradient" x1="20%" y1="111%" x2="90%" y2="80%">\n    <stop stop-color="var(--colorBgLight)" offset="0%"/>\n    <stop stop-color="var(--colorBgLight)" offset="82%"/>\n    <stop stop-color="var(--colorBg)" offset="83%"/>\n    <stop stop-color="var(--colorBg)" offset="100%"/>\n  </linearGradient>\n\n  <linearGradient id="bookmark-graphic-gradient" x1="0%" y1="0%" x2="100%" y2="100%">\n    <stop stop-color="rgba(0,0,0, 0.1)" offset="0%"/>\n    <stop stop-color="transparent" offset="70%"/>\n  </linearGradient>\n\n  <linearGradient x1="0.15" y1="0.3" x2="0.3" y2="0.5" id="guest-intro-bg-gradient">\n    <stop offset="0" stop-color="var(--colorFg)" stop-opacity="0.03" />\n    <stop offset="1" stop-color="var(--colorFg)" stop-opacity="0.003" />\n  </linearGradient>\n\n  <linearGradient x1="1" y1="0" x2="0" y2="1" id="guest-intro-accent-gradient">\n    <stop offset="0" stop-color="var(--colorAccentBg)" stop-opacity="0" />\n    <stop offset="0.5" stop-color="var(--colorAccentBg)" stop-opacity="1" />\n    <stop offset="1" stop-color="var(--colorAccentBg)" stop-opacity="0" />\n  </linearGradient>\n\n  <linearGradient id="private-ghost-gradient" x1="35" y1="0" x2="35" y2="80" gradientUnits="userSpaceOnUse">\n    <stop stop-color="var(--colorFg)" stop-opacity=".8"/>\n    <stop stop-color="var(--colorFg)" offset="1" stop-opacity=".2"/>\n  </linearGradient>\n\n\n  \x3c!-- masks --\x3e\n  <mask id="trash-folder-mask">\n    <path d="M11 1v-1h-6v1h-4v1h14v-1h-4z" fill="#fff" />\n    <path d="M3 3h10v12h-10v-12z" fill="#000"\n      stroke="#fff" stroke-width="2" stroke-opacity="1" />\n    <path d="M6 6h1v6h-1z" fill="#fff" />\n    <path d="M9 6h1v6h-1z" fill="#fff" />\n  </mask>\n\n  <mask id="icon-mask">\n    <path d="M4 14v-12h7v12l-3.5-2.8-3.5 2.8z"\n      stroke="url(#border-gradient)"\n      stroke-width="2"\n      stroke-opacity="1"/>\n  </mask>\n\n  <mask id="mail-mask-unseen">\n    <circle cx="8" cy="8" r="4" fill="#fff" />\n    <circle cx="8" cy="8" r="2" fill="#000" />\n  </mask>\n\n  <mask id="sync-cloud-mask" x="0" y="0" width="16" height="10" fill="#fff">\n    <use xlink:href="#sync-cloud" />\n    <use mask="url(#sync-cloud-mask)"\n      xlink:href="#sync-cloud" />\n  </mask>\n\n  \x3c!-- patterns --\x3e\n  <pattern id="diagonalLinePattern" x="4" y="4" width="8" height="8" patternUnits="userSpaceOnUse" patternTransform="rotate(45)">\n    <rect x="0" y="0" width="4" height="8" style="stroke: none; fill: var(--colorHighlightBg)" />\n  </pattern>\n\n</defs>\n'},93513:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path d="M3.88 2.5h-.69v2.75h1.37V3.91A8.21 8.21 0 0 1 9.2 5.83l-.95.95 1 1 .95-.95a8.21 8.21 0 0 1 1.92 4.63h-1.37v1.38h2.75v-.69A9.64 9.64 0 0 0 3.88 2.5z"/>\n  <path d="M8.28 8.69l-1-1-1.83 1.89a2 2 0 0 0-.88-.21 2.06 2.06 0 1 0 2.06 2.06 2 2 0 0 0-.21-.88z"/>\n</svg>\n'},87046:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path d="M11 6C11 5.44772 11.4477 5 12 5H14C14.5523 5 15 5.44772 15 6V10H19L13 16L7 10H11V6Z"/>\n  <path d="M6 20C6 19.4477 6.44772 19 7 19H19C19.5523 19 20 19.4477 20 20C20 20.5523 19.5523 21 19 21H7C6.44772 21 6 20.5523 6 20Z"/>\n</svg>\n'},44231:e=>{e.exports='<svg class="download-empty-state" width="46" height="46" viewBox="0 0 46 46" xmlns="http://www.w3.org/2000/svg">\n  <path class="border-color" d="M8 34C8 33.4477 7.55228 33 7 33V33C6.44772 33 6 33.4477 6 34V39C6 40.6569 7.34315 42 9 42H37C38.6569 42 40 40.6569 40 39V34C40 33.4477 39.5523 33 39 33V33C38.4477 33 38 33.4477 38 34V39C38 39.5523 37.5523 40 37 40H9C8.44772 40 8 39.5523 8 39V34Z"/>\n  <path class="main-fill-color" fill-rule="evenodd" clip-rule="evenodd" d="M29 6H17V21H13L23 30L33 21H29V6Z"/>\n  <path class="secondary-color" d="M29 6H23V30L33 21H29V6Z"/>\n  <rect class="download-progressbar" x="9" y="35" width="22" height="4" rx="1"/>\n</svg>\n'},55430:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path class="progress-bar-container" fill-rule="evenodd" clip-rule="evenodd" d="M1 14.857V12h1v2.841a.505.505 0 00.037.157l.04.002h11.822a.323.323 0 00.089-.024.447.447 0 00.012-.119v-2.856L15 12v2.857C15 16 13.923 16 13.923 16H2.077C1 16 1 14.857 1 14.857zm12.984.131a.017.017 0 01-.002.003l.002-.003z"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M10 0H6v6H2l6 5 6-5h-4V0zM7 7V1h2v6h2.238L8 9.698 4.762 7H7z"/>\n</svg>\n'},15902:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path class="small-icon-fill progress-bar-container" fill-rule="evenodd" clip-rule="evenodd" d="M1 12v2.857S1 16 2.077 16h11.846S15 16 15 14.857V12h-1v2.857c0 .064-.007.1-.012.12A.289.289 0 0113.9 15H2.076c-.017 0-.03 0-.04-.002A.485.485 0 012 14.841V12H1zm1.01 2.993l.003.001a.023.023 0 01-.003 0zm11.972-.002l.002-.003-.002.003z"/>\n  <path class="small-icon-fill" d="M6 6V0h4v6h4l-6 5-6-5h4z"/>\n  <path class="small-icon-outline" fill-rule="evenodd" d="M7 7H4.762L8 9.698 11.238 7H9V1H7v6zm2-7h1v6h4l-1.2 1L8 11 3.2 7 2 6h4V0h3z"/>\n</svg>\n'},29504:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path d="M16 6.12132L16.7071 5.41422C17.4882 4.63317 18.7545 4.63317 19.5355 5.41422C20.3166 6.19527 20.3166 7.4616 19.5355 8.24264L18.8284 8.94975L16 6.12132Z"/>\n  <path d="M7.00424 15.1758L15.4895 6.69052L18.3179 9.51894L9.83267 18.0042H7.00424V15.1758Z"/>\n  <path d="M7 19C6.44772 19 6 19.4477 6 20C6 20.5523 6.44772 21 7 21H19C19.5523 21 20 20.5523 20 20C20 19.4477 19.5523 19 19 19H7Z"/>\n</svg>\n'},84435:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\r\n  <rect x="2" y="14" width="12" height="1" rx="0.5"/>\r\n  <path d="M3 10.5L9.5 4L12 6.5L5.5 13L3 13L3 10.5Z"/>\r\n  <path d="M10.7929 2.70711L10 3.5L12.5 6L13.2929 5.20711C13.6834 4.81658 13.6834 4.18342 13.2929 3.79289L12.2071 2.70711C11.8166 2.31658 11.1834 2.31658 10.7929 2.70711Z"/>\r\n</svg>\r\n'},83947:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M11.1464 3.06066C11.3417 2.8654 11.6583 2.8654 11.8535 3.06066L12.9393 4.14645C13.1346 4.34171 13.1346 4.65829 12.9393 4.85356L12 5.7929L10.2071 4L11.1464 3.06066ZM12.5607 2.35356C11.9749 1.76777 11.0251 1.76777 10.4393 2.35355L9.14644 3.64645L8.79289 4L9.14644 4.35356L11.6464 6.85356L12 7.20711L12.3535 6.85356L13.6464 5.56066C14.2322 4.97488 14.2322 4.02513 13.6464 3.43934L12.5607 2.35356ZM2.42215 10.3707L2.25491 10.538L2.27811 10.7733L2.50241 13.049L2.54265 13.4573L2.95095 13.4976L5.22666 13.7219L5.46202 13.7451L5.62925 13.5778L10.9629 8.24418L11.3165 7.89063L10.9629 7.53707L8.46292 5.03707L8.10937 4.68352L7.75582 5.03707L2.42215 10.3707ZM3.45734 12.5427L3.29649 10.9106L8.10937 6.09773L9.90226 7.89063L5.08938 12.7035L3.45734 12.5427Z"/>\n</svg>\n'},17802:e=>{e.exports='<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path d="M11.25 21.4a6.25 6.25 0 01-4.42-10.67l4.42-4.42a4.5 4.5 0 016.36 6.37l-4.07 4.07a2.76 2.76 0 01-3.89 0 2.76 2.76 0 010-3.89l3-3a1 1 0 111.41 1.41l-2.99 3a.75.75 0 000 1.06c.29.29.77.29 1.06 0l4.06-4.06c.47-.47.73-1.1.73-1.77 0-.67-.26-1.3-.73-1.77a2.57 2.57 0 00-3.54 0l-4.41 4.42a4.25 4.25 0 106.01 6.01l4.06-4.07a1 1 0 111.41 1.41l-4.06 4.07a6.2 6.2 0 01-4.41 1.83z"/>\n</svg>'},34830:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M14.5 1.28a1.04 1.04 0 00-1.42 0l-.7.67 2.12 2.01.7-.67c.4-.37.4-.97 0-1.34l-.7-.67zM13.79 4.63l-2.12-2.01L5 8.99V11h2.12l6.67-6.37z"/>\n  <path fill-rule="evenodd" d="M4 2a3 3 0 00-3 3v7a3 3 0 003 3h4a3 3 0 003-3v-2h-1l-1 1v1a1 1 0 01-1 1H4a1 1 0 01-1-1V5a1 1 0 011-1h3l1-1V2H4z"/>\n</svg>'},27476:e=>{e.exports='<svg width="22" height="22" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg">\n  <path d="M6.777 16.002c-1.32-1.32-1.362-3.48-.09-4.753l5.198-5.2c.932-.932 2.488-.902 3.456.067.97.968 1.146 2.67.214 3.602l-5.1 5.1c-.594.593-1.69.428-2.307-.188s-.745-1.677-.152-2.27l4.98-4.98.644.642-4.98 4.98c-.256.255-.122.728.142.992.265.264.756.417 1.01.163l5.1-5.1c.594-.595.43-1.69-.186-2.308-.617-.616-1.567-.634-2.16-.04l-5.2 5.198c-.932.932-.902 2.487.067 3.456.968.97 2.524.998 3.456.066l3.815-3.636.57.57-3.726 3.726c-1.272 1.272-3.432 1.23-4.753-.09z"/>\n</svg>\n'},21838:e=>{e.exports='<svg width="26" height="26" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M19 11v7H7v-7h12zM5 10h16v8a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-8zm6 2h4a1 1 0 1 1 0 2h-4a1 1 0 1 1 0-2z"/>\n  <path fill-rule="evenodd" d="M20 8v3H6V8h14zM4 8a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v3H4V8z"/>\n</svg>\n'},5211:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M13 7v6H3V7h10zM1 6h14v7a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V6zm5.5 2h3a1 1 0 1 1 0 2h-3a1 1 0 0 1 0-2z"/>\n  <path fill-rule="evenodd" d="M14 4v3H2V4h12zM0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v3H0V4z"/>\n</svg>\n'},7773:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M13 7v5a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V7h10zM2 6h12v6a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6zm4.5 2h3a1 1 0 1 1 0 2h-3a1 1 0 0 1 0-2z"/>\n  <path fill-rule="evenodd" d="M13 4a1 1 0 0 1 1 1v1H2V5a1 1 0 0 1 1-1h10zM1 5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v2H1V5z"/>\n</svg>\n'},47043:e=>{e.exports='<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M9 16h2.53l7-7.03-2.54-2.4L9 13.46V16zm11.8-9.33a.64.64 0 000-.94L19.27 4.2a.64.64 0 00-.94 0l-1.2 1.2 2.54 2.53 1.13-1.26z"/>\n  <path fill-rule="evenodd" d="M8 6a3 3 0 00-3 3v8a3 3 0 003 3h6a3 3 0 003-3v-4l-2 2v2a1 1 0 01-1 1H8a1 1 0 01-1-1V9a1 1 0 011-1h4l1-1 1-1H8z"/>\n</svg>'},31408:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M14.05 1.28a.96.96 0 00-1.35 0l-.68.67 2.03 2.01.67-.67a.95.95 0 000-1.34l-.67-.67zM13.37 4.63l-2.02-2.01L5 8.99V11h2.02l6.35-6.37z"/>\n  <path fill-rule="evenodd" d="M4 2a3 3 0 00-3 3v7a3 3 0 003 3h5a3 3 0 003-3V8l-1 1-1 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V5a1 1 0 011-1h4l1-1 .87-.87A3 3 0 009 2H4z"/>\n</svg>'},67955:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M13.414.5c-.398 0-.779.158-1.061.439l-1.061 1.061 2.707 2.707 1-1c.32-.32.5-.754.5-1.207 0-.453-.18-.887-.5-1.207l-.354-.354c-.281-.281-.663-.439-1.061-.439h-.172zm-.353 1.146c.094-.094.221-.146.353-.146h.172c.133 0 .26.053.353.146l.354.354c.133.133.207.312.207.5s-.075.367-.207.5l-.293.293-1.293-1.293.354-.354zM10.5 2.793l-5.5 5.5v2.707h2.707l5.5-5.5-2.707-2.707zm-4.5 7.207v-1.293l4.5-4.5 1.293 1.293-4.5 4.5h-1.293z"/><path d="M4 3h4l-1 1h-3c-.5 0-1 .5-1 1v7c0 .5.5 1 1 1h5c.552 0 1-.448 1-1v-1l1-1v2c0 1.105-.895 2-2 2h-5c-1.105 0-2-.895-2-2v-7c0-1 .895-2 2-2z"/></svg>'},31391:e=>{e.exports='<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M5 6c0-1.1.9-2 2-2h10a2 2 0 012 2v7.02a6.62 6.62 0 00-2 .15V6H7v12h5.17a6.52 6.52 0 00-.15 2H7a2 2 0 01-2-2V6zm4 3h6v1H9V9zm0 2h6v1H9v-1zm3 2H9v1h3v-1z"/>\n  <path fill-rule="evenodd" d="M23 19.5a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zm-2.5-1h-4a1 1 0 100 2h4a1 1 0 100-2z"/>\n</svg>'},82032:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M11.5 7.091v-3.646c0-.544-.448-.985-1-.985h-6c-.5 0-1 .493-1 .985v8.093c0 .493.5.985 1 .985h2.5c.002.512.074 1.008.207 1.478h-3.207c-1.105 0-2-.882-2-1.97v-9.078c0-1.088.895-1.97 2-1.97h7c1.105 0 2 .882 2 1.97v4.048l-.054.018-.446-.018c-.341 0-.676.031-1 .091zM5 4h5v1h-5v-1zM10 6h-5v1h5v-1zM5 8h3v1h-3v-1z"/><path fill-rule="evenodd" clip-rule="evenodd" d="M16 12.5c0 1.933-1.567 3.5-3.5 3.5s-3.5-1.567-3.5-3.5 1.567-3.5 3.5-3.5 3.5 1.567 3.5 3.5zm-6 0c0-.276.224-.5.5-.5h4c.276 0 .5.224.5.5s-.224.5-.5.5h-4c-.276 0-.5-.224-.5-.5z"/></svg>'},39530:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M7.256 13h-2.256c-1.105 0-2-1-2-2v-7c0-1.105.895-2 2-2h5c1.105 0 2 .895 2 2v3.027c-.164-.018-.331-.027-.5-.027-.169 0-.336.009-.5.027v-3.027c0-.552-.448-1-1-1h-5c-.5 0-1 .5-1 1v7c0 .5.5 1 1 1h2.028c.038.347.116.682.229 1zm-2.256-9h5v1h-5v-1zm0 2h5v1h-5v-1zm2 2h-2v1h2v-1zm8 3.5c0 1.933-1.567 3.5-3.5 3.5s-3.5-1.567-3.5-3.5 1.567-3.5 3.5-3.5 3.5 1.567 3.5 3.5zm-6 0c0-.276.224-.5.5-.5h4c.276 0 .5.224.5.5s-.224.5-.5.5h-4c-.276 0-.5-.224-.5-.5z"/></svg>'},36218:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M8 7h5.697l.02.002c.242.014.461.113.627.269l.094.096.699 1.138c.174.297.495.496.863.496h3v6c0 .513-.386.935-.883.993l-4.117.007-.117-.007c-.286-.033-.535-.187-.695-.41l-.658-1.05c-.165-.327-.503-.551-.894-.551l-1.636.017c-.513 0-.936.386-.993.883l-.007.117v4c0 .552-.448 1-1 1-.513 0-.936-.386-.993-.883l-.007-.117v-11c0-.513.386-.936.883-.993l.117-.007z"/></svg>'},30651:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M4 3h4.697l.02.002c.242.014.461.113.627.269l.094.096.699 1.138c.174.297.495.496.863.496h2v5c0 .513-.386.935-.883.993l-3.117.007-.117-.007c-.286-.033-.535-.187-.695-.41l-.658-1.05c-.165-.327-.503-.551-.894-.551l-.636.017c-.513 0-.936.386-.993.883l-.007.117v3c0 .552-.448 1-1 1-.513 0-.936-.386-.993-.883l-.007-.117v-9c0-.513.386-.936.883-.993l.117-.007z"/></svg>'},27436:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8.581 3h-3.581l-.117.007c-.497.058-.883.48-.883.993v8.5c0 .276.224.5.5.5s.5-.223.5-.5l.006-3.617c.058-.497.392-.883.993-.883.602 0 .865.207 1.03.534l.658 1.05c.16.222.409.376.695.41h2.733c.497-.058.883-.48.883-.993v-4h-1.117c-.368 0-.69-.199-.863-.496l-.699-1.138-.094-.096c-.166-.156-.385-.255-.627-.269l-.02-.002z"/></svg>'},38306:e=>{e.exports='<svg width="26" height="26" xmlns="http://www.w3.org/2000/svg">\n\t<path fill-rule="evenodd" d="M11.293 6.293l1.414 1.414a1 1 0 00.707.293H18a2 2 0 012 2v6a2 2 0 01-2 2H8a2 2 0 01-2-2V8a2 2 0 012-2h2.586a1 1 0 01.707.293zM18 13l-3-3v2h-3.5a.5.5 0 00-.5.5v1a.5.5 0 00.5.5H15v2l3-3z"/>\n</svg>\n'},71318:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n\t<path fill-rule="evenodd" d="M8 4.958L6.8 3H3.2C2.54 3 2 3.563 2 4.25v7.5c0 .688.54 1.25 1.2 1.25h9.6c.66 0 1.2-.563 1.2-1.25V5.9c0-.688-.54-.942-1.2-.942H8zM12 9L9 6v2H5.5a.5.5 0 00-.5.5v1a.5.5 0 00.5.5H9v2l3-3z"/>\n</svg>\n'},14737:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n\t<path fill-rule="evenodd" d="M2.357 3.36A1.238 1.238 0 002 4.213v7.575a1.183 1.183 0 00.339.87 1.159 1.159 0 00.861.342h9.6c.317-.005.619-.134.843-.36.224-.227.352-.532.357-.852V6c0-.5-.5-1-1-1H8L6.8 3H3.2a1.214 1.214 0 00-.843.36zM3 11.823L3 11.805V4.223a.238.238 0 01.068-.159A.214.214 0 013.212 4h3.034L7.5 6h5.3c.11 0 .2.088.2.198v5.578a.238.238 0 01-.068.159.215.215 0 01-.144.064H3.165a.15.15 0 01-.115-.046.173.173 0 01-.05-.131z"/>\n\t<path fill-rule="evenodd" d="M3 11.822V4.223a.238.238 0 01.068-.159A.214.214 0 013.212 4h3.034L7.5 6h5.3c.11 0 .2.088.2.198v5.578a.238.238 0 01-.068.159.215.215 0 01-.144.064H3.165a.15.15 0 01-.115-.046.173.173 0 01-.05-.131z" fill-opacity=".1"/>\n\t<path d="M9.354 6.646a.5.5 0 10-.708.708L9.793 8.5H6a.5.5 0 000 1h3.793l-1.147 1.146a.5.5 0 00.708.708L11.707 9 9.354 6.646z"/>\n</svg>\n'},80217:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M12.007 8.007l-.007-.112c0-.494.394-.895.881-.895.267 0 .507.121.668.312l.061.053 4.729 4.944c.37.387.37.996 0 1.382l-4.729 4.944-.061.053c-.162.191-.401.311-.668.311-.487 0-.881-.401-.881-.895l.007-.112-.007.007v-10l.007.007z"/><rect x="7" y="11" width="8" height="4" rx="1"/></svg>'},59168:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8.006 3.839l-.006-.093c0-.412.338-.746.755-.746.229 0 .434.101.573.26l.052.044 3.93 3.995c.383.389.383 1.013 0 1.403l-3.93 3.995-.052.044c-.138.159-.344.26-.573.26-.417 0-.755-.334-.755-.746l.006-.093-.006.006v-8.333l.006.006z"/><rect x="3" y="6" width="8" height="4" rx="1"/></svg>'},56475:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8 6.5h.5v-2.754c0-.13.108-.246.255-.246.08 0 .149.034.196.088l.038.043.043.031 3.922 3.987c.191.195.191.507 0 .701l-3.922 3.987-.043.031-.038.043c-.047.054-.116.088-.196.088-.147 0-.255-.116-.255-.246v-2.754h-4.5c-.276 0-.5-.224-.5-.5v-2c0-.276.224-.5.5-.5h4z" stroke="#3B3B3B"/></svg>'},27818:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M7 6C6.44772 6 6 6.44772 6 7V11C6 11.5523 6.44772 12 7 12H11C11.5523 12 12 11.5523 12 11V7C12 6.44772 11.5523 6 11 6H7ZM8 8V10H10V8H8Z"/>\n  <path fill-rule="evenodd" d="M7 14C6.44772 14 6 14.4477 6 15V19C6 19.5523 6.44772 20 7 20H11C11.5523 20 12 19.5523 12 19V15C12 14.4477 11.5523 14 11 14H7ZM8 16V18H10V16H8Z"/>\n  <path fill-rule="evenodd" d="M14 15C14 14.4477 14.4477 14 15 14H19C19.5523 14 20 14.4477 20 15V19C20 19.5523 19.5523 20 19 20H15C14.4477 20 14 19.5523 14 19V15ZM16 18V16H18V18H16Z"/>\n  <path d="M16.0009 11.9999H16.0559C16.1963 11.9923 16.3336 11.9551 16.4587 11.8909C16.5838 11.8266 16.6939 11.7366 16.7819 11.6269L20.7819 6.62692C20.9479 6.41978 21.0249 6.15518 20.9958 5.89132C20.9667 5.62745 20.834 5.38594 20.6269 5.21992C20.5243 5.13771 20.4066 5.07651 20.2804 5.03981C20.1542 5.00311 20.022 4.99163 19.8913 5.00602C19.6274 5.03509 19.3859 5.16778 19.2199 5.37492L15.9179 9.49992L14.7079 8.28992C14.6149 8.19707 14.5045 8.12346 14.383 8.07329C14.2615 8.02312 14.1313 7.99737 13.9998 7.99751C13.7344 7.99779 13.4799 8.10351 13.2924 8.29142C13.1049 8.47932 12.9997 8.73402 13 8.99948C13.0003 9.26494 13.106 9.51941 13.2939 9.70692L15.2939 11.7069C15.4814 11.8945 15.7357 11.9999 16.0009 11.9999Z"/>\n</svg>\n'},96387:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M2 1C1.44772 1 1 1.44772 1 2V6C1 6.55228 1.44772 7 2 7H6C6.55228 7 7 6.55228 7 6V2C7 1.44772 6.55228 1 6 1H2ZM3 3V5H5V3H3Z"/>\n  <path fill-rule="evenodd" d="M2 9C1.44772 9 1 9.44772 1 10V14C1 14.5523 1.44772 15 2 15H6C6.55228 15 7 14.5523 7 14V10C7 9.44772 6.55228 9 6 9H2ZM3 11V13H5V11H3Z"/>\n  <path fill-rule="evenodd" d="M9 10C9 9.44772 9.44772 9 10 9H14C14.5523 9 15 9.44772 15 10V14C15 14.5523 14.5523 15 14 15H10C9.44772 15 9 14.5523 9 14V10ZM11 13V11H13V13H11Z"/>\n  <path d="M11.0009 6.99992H11.0559C11.1963 6.9923 11.3336 6.95513 11.4587 6.89086C11.5838 6.82659 11.6939 6.73665 11.7819 6.62692L15.7819 1.62692C15.9479 1.41978 16.0249 1.15518 15.9958 0.891317C15.9667 0.627453 15.834 0.385944 15.6269 0.219918C15.5243 0.137711 15.4066 0.0765093 15.2804 0.0398084C15.1542 0.0031075 15.022 -0.00837419 14.8913 0.00601889C14.6274 0.035087 14.3859 0.167784 14.2199 0.374918L10.9179 4.49992L9.70791 3.28992C9.61487 3.19707 9.50445 3.12346 9.38296 3.07329C9.26147 3.02312 9.13129 2.99737 8.99985 2.99751C8.73439 2.99779 8.47992 3.10351 8.29241 3.29142C8.1049 3.47932 7.99972 3.73402 8 3.99948C8.00028 4.26494 8.106 4.51941 8.29391 4.70692L10.2939 6.70692C10.4814 6.89447 10.7357 6.99986 11.0009 6.99992Z"/>\n</svg>\n'},30808:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M10.4243 7.42417L14.4243 3.42417C14.6586 3.18985 14.6586 2.80995 14.4243 2.57564C14.1899 2.34132 13.8101 2.34132 13.5757 2.57564L10 6.15137L8.42426 4.57564C8.18995 4.34132 7.81005 4.34132 7.57574 4.57564C7.34142 4.80995 7.34142 5.18985 7.57574 5.42417L9.57574 7.42417L10 7.84843L10.4243 7.42417ZM3 5.9999V3.9999H5V5.9999H3ZM2 3.4999C2 3.22376 2.22386 2.9999 2.5 2.9999H5.5C5.77614 2.9999 6 3.22376 6 3.4999V6.4999C6 6.77604 5.77614 6.9999 5.5 6.9999H2.5C2.22386 6.9999 2 6.77604 2 6.4999V3.4999ZM3 11.9999V9.9999H5V11.9999H3ZM2 9.4999C2 9.22376 2.22386 8.9999 2.5 8.9999H5.5C5.77614 8.9999 6 9.22376 6 9.4999V12.4999C6 12.776 5.77614 12.9999 5.5 12.9999H2.5C2.22386 12.9999 2 12.776 2 12.4999V9.4999ZM9 9.9999V11.9999H11V9.9999H9ZM8.5 8.9999C8.22386 8.9999 8 9.22376 8 9.4999V12.4999C8 12.776 8.22386 12.9999 8.5 12.9999H11.5C11.7761 12.9999 12 12.776 12 12.4999V9.4999C12 9.22376 11.7761 8.9999 11.5 8.9999H8.5Z"/>\n</svg>\n'},75971:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M14.414 5c-.781-.781-2.047-.781-2.828 0l-6 6c-.375.375-.586.884-.586 1.414v6.586c0 1.105.895 2 2 2h12c1.105 0 2-.895 2-2v-6.586c0-.53-.211-1.039-.586-1.414l-6-6zm-6.354 6.354l4.939-4.939 4.939 4.939-4.939 4.939-4.939-4.939zm-.707.707l-.354.354v6.586h12v-6.586l-.354-.354-5.646 5.646-5.646-5.646z"/></svg>'},73391:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.293 7.293l6-6c.391-.391 1.024-.391 1.414 0l6 6c.188.188.293.442.293.707v6c0 .552-.448 1-1 1h-12c-.552 0-1-.448-1-1v-6c0-.265.105-.52.293-.707zm1.707 5.707v-4.586l.811-.811 4.189 4.189 4.189-4.189.811.811v4.586h-10zm8.482-6.104l-3.482-3.482-3.482 3.482 3.482 3.482 3.482-3.482z"/></svg>'},15331:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="m7.29386.706223c.39053-.390524 1.02175-.390524 1.41228 0l4.70996 4.709977c.3751.37507.5839.88188.5839 1.41231v5.17159c0 .2652-.1054.5196-.2929.7071s-.4419.2929-.7071.2929h-10c-.26522 0-.51957-.1054-.70711-.2929-.18753-.1875-.29289-.4419-.29289-.7071v-5.17159c0-.53043.20882-1.03724.58389-1.41231zm-2.7332 4.147417 3.43934-3.43934 3.4393 3.43934-3.08575 3.08579c-.19526.19526-.51184.19526-.7071 0zm-.70711.70711-.56255.56255c-.18653.18653-.291.43857-.291.70521v5.17159h10v-5.17159c0-.26664-.1045-.51868-.291-.7052l-.5626-.56256-3.08574 3.08578c-.58579.58579-1.53553.58579-2.12132 0z" fill-rule="evenodd"/>\n</svg>'},17109:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M19.929 12h.071v-4.793c0-.445-.539-.669-.854-.354l-1.197 1.197c-1.267-1.267-3.017-2.05-4.95-2.05-3.526 0-6.444 2.608-6.929 6h2.029c.463-2.282 2.481-4 4.9-4 1.381 0 2.631.56 3.535 1.464l-1.682 1.682c-.315.315-.092.854.354.854h4.7219999999999995zm-9.136 2h-4.793v4.793c0 .445.539.669.854.354l1.197-1.197c1.267 1.267 3.017 2.05 4.95 2.05 3.526 0 6.444-2.608 6.929-6h-2.029c-.463 2.282-2.481 4-4.9 4-1.381 0-2.631-.56-3.536-1.465l1.682-1.682c.315-.315.092-.854-.354-.854z"/></svg>'},11331:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M10.065 7.082l4.292.227-.227-4.292c-.021-.399-.514-.624-.781-.357l-1.118 1.118c-1.092-1.088-2.601-1.762-4.269-1.762-3.038 0-5.551 2.235-5.969 5.143h2.032c.395-1.792 2.001-3.143 3.938-3.143 1.118 0 2.126.45 2.854 1.176l-1.109 1.109c-.267.267-.042.76.357.781zM5.922 8.949l-4.292-.227.227 4.292c.021.399.514.624.781.357l1.088-1.088c1.089 1.071 2.586 1.732 4.238 1.732 3.038 0 5.551-2.235 5.969-5.143h-2.032c-.395 1.791-2.001 3.143-3.938 3.143-1.103 0-2.098-.438-2.824-1.146l1.14-1.14c.267-.267.042-.76-.357-.781z"/></svg>'},64207:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M9.915 6.939h3.389l-.001-3.389c0-.315-.381-.473-.604-.25l-1.164 1.164c-.905-.905-2.155-1.464-3.536-1.464-2.419 0-4.437 1.718-4.9 4h1.026c.444-1.725 2.01-3 3.874-3 1.105 0 2.105.448 2.828 1.172l-1.164 1.164c-.223.223-.065.603.25.604zm-3.829 2.122h-3.389v3.389c0 .315.381.473.603.25l1.164-1.164c.905.905 2.155 1.464 3.536 1.464 2.419 0 4.437-1.718 4.9-4h-1.026c-.444 1.725-2.01 3-3.874 3-1.105 0-2.105-.448-2.828-1.171l1.164-1.164c.223-.223.065-.603-.25-.603z"/></svg>'},43652:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M11 7.895c0 .192-.058.37-.158.516l-.045.07-3.631 3.775c-.395.411-.395 1.078 0 1.489l3.538 3.678-.001.007c.182.164.297.406.297.676 0 .494-.385.895-.861.895-.261 0-.495-.121-.653-.311l-.06-.053-3.862-4.176c-.754-.815-.754-2.103 0-2.918l3.862-4.176.06-.053c.158-.191.392-.312.653-.312.475 0 .861.401.861.895zm3.119 11.105c.486 0 .881-.401.881-.895v-3.105h.857c2.028 0 3.782 1.174 4.619 2.879.312-.169.524-1 .524-1.379 0-3.314-2.686-5.5-6-5.5v-3.105c0-.494-.395-.895-.881-.895-.267 0-.507.121-.668.312l-.061.053-4.729 4.944c-.37.387-.37.996 0 1.382l4.729 4.944.061.053c.161.191.401.311.668.311z"/></svg>'},67461:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M6.203 3.914c0 .192-.058.37-.158.516l-.045.07-2.833 2.756c-.395.411-.395 1.078 0 1.489l2.833 2.756-.001.007c.182.164.297.406.297.676 0 .494-.385.895-.861.895-.261 0-.495-.121-.653-.312l-.06-.053-3.157-3.254c-.754-.815-.754-2.103 0-2.918l3.064-3.157.06-.053c.158-.191.392-.312.653-.312.475 0 .861.401.861.895zM15 11.5c0-3.314-2.686-5.5-6-5.5h-1v4h1.857c2.028 0 3.782 1.174 4.619 2.879.312-.169.524-1 .524-1.379zM9.994 3.839l.006-.093c0-.412-.338-.746-.755-.746-.229 0-.434.101-.573.26l-.052.044-3.93 3.995c-.383.389-.383 1.013 0 1.403l3.93 3.995.052.044c.138.159.344.26.573.26.417 0 .755-.334.755-.746l-.006-.094.006.006v-8.333l-.006.006z"/></svg>'},70531:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8.5 6.001l.001.499h.499c3.097 0 5.5 2.018 5.5 5 0 .08-.017.213-.051.363-1.023-1.43-2.698-2.363-4.592-2.363h-1.357v2.754c0 .13-.108.246-.255.246-.08 0-.149-.034-.196-.088l-.038-.043-.043-.031-3.922-3.987c-.191-.195-.191-.507 0-.701l3.922-3.987.043-.031.038-.043c.047-.054.116-.088.196-.088.084 0 .135.028.168.063s.081.114.081.276v.001l.006 2.161z" stroke="#3B3B3B"/><path d="M1.287 7.299l3.93-3.995.052-.044c.138-.159.344-.26.573-.26.417 0 .749.304.749.839v.569l-1 1v-1.059l-3.592 3.651 3.597 3.657v-.657l-.001-.404 1.001 1.001v.657c0 .412-.338.746-.755.746-.229 0-.434-.101-.573-.26l-.052-.044-3.93-3.995c-.383-.389-.383-1.013 0-1.403z"/></svg>'},28360:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M13.993 8.007l.007-.112c0-.494-.395-.895-.881-.895-.267 0-.507.121-.668.312l-.061.053-4.729 4.944c-.37.387-.37.996 0 1.382l4.729 4.944.061.053c.161.191.401.311.668.311.486 0 .881-.401.881-.895l-.007-.112.007.007v-10l-.007.007z"/><path d="M20 16.5c0-3.314-2.686-5.5-6-5.5h-1v4h1.857c2.028 0 3.782 1.174 4.619 2.879.312-.169.524-1 .524-1.379z"/></svg>'},51299:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M7.994 3.839l.006-.093c0-.412-.338-.746-.755-.746-.229 0-.434.101-.573.26l-.052.044-3.93 3.995c-.383.389-.383 1.013 0 1.403l3.93 3.995.052.044c.138.159.344.26.573.26.417 0 .755-.334.755-.746l-.006-.094.006.006v-8.333l-.006.006zM14 11.5c0-3.314-2.686-5.5-6-5.5h-1v4h1.857c2.028 0 3.782 1.174 4.619 2.879.312-.169.524-1 .524-1.379z"/></svg>'},10945:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M7.5 6.001l.001.499h.499c3.097 0 5.5 2.018 5.5 5 0 .08-.017.213-.051.363-1.023-1.43-2.698-2.363-4.592-2.363h-1.357v2.754c0 .13-.108.246-.255.246-.08 0-.149-.034-.196-.088l-.038-.043-.043-.031-3.922-3.987c-.191-.195-.191-.507 0-.701l3.922-3.987.043-.031.038-.043c.047-.054.116-.088.196-.088.084 0 .135.028.168.063s.081.114.081.276v.001l.006 2.161z" stroke="#3B3B3B"/></svg>'},21881:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M22 8.086c0-.696-.547-1.086-1.319-1.086h-17.681l3.897 4 11.103-2-9.154 5v8l12.667-13c.221-.223.487-.591.487-.914z"/></svg>'},64827:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M16 3.869c0-.557-.461-.869-1.111-.869h-14.889l3.282 3.2 9.35-1.6-7.709 4v6.4l10.667-10.4c.186-.178.41-.473.41-.731z"/></svg>'},39139:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M0 2h14.546c.359 0 .715.09.992.31.292.231.461.579.461.991 0 .25-.098.471-.189.625-.095.162-.213.304-.319.411l-10.492 10.664v-8l-5-5zm2.5.95l2.5 2.55 7-1.5-6 3.5.003 5 8.863-8.848.176-.225.054-.125c0-.117-.038-.183-.101-.232-.077-.061-.223-.119-.45-.119h-12.046z"/></svg>'},92513:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26">\n  <path fill-rule="evenodd" d="M19 9V7H7v2h12zm2 0a1 1 0 01-1 1h-.1l-.9 9a2 2 0 01-2 2H9a2 2 0 01-2-2l-.9-9H6a1 1 0 01-1-1V7c0-1.1.9-2 2-2h12a2 2 0 012 2v2zM8.11 10L9 18a1 1 0 001 1h6a1 1 0 001-1l.89-8H8.1zm7.8 2.38l-.71-.7-2.12 2.11-2.12-2.12-.71.7 2.12 2.13-2.12 2.12.7.7 2.13-2.11 2.12 2.12.7-.7-2.12-2.13 2.13-2.12z"/>\n</svg>\n'},66706:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path fill-rule="evenodd" d="M13 3v2H3V3h10zM2.12 6H2a1 1 0 01-1-1V3c0-1.1.78-2 1.75-2h10.5c.97 0 1.75.9 1.75 2v2a1 1 0 01-1 1h-.12l-.74 7.3c0 .94-.76 1.7-1.71 1.7H4.57a1.7 1.7 0 01-1.71-1.7L2.12 6zm1.72 0l.73 6.46c0 .47.39.85.86.85h5.14c.47 0 .86-.38.86-.85L12.16 6H3.84zm6.65 1.86l-.6-.6-1.82 1.8-1.82-1.8-.6.6 1.81 1.8-1.82 1.79.6.6 1.83-1.8 1.82 1.8.6-.6-1.82-1.8 1.82-1.8z"/>\n</svg>\n'},15901:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M3 3h10v1H3V3ZM2 3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v2h-1.09l-.73 7.6c-.08.8-.66 1.4-1.36 1.4H5.18c-.7 0-1.28-.6-1.36-1.4L3.09 5H2V3Zm2 2 .72 7.49c.03.26.22.46.46.46h5.64c.24 0 .43-.2.46-.46L12 5H4Zm6.5 1.86-.61-.6-1.82 1.8-1.82-1.8-.6.6 1.81 1.8-1.82 1.79.6.6 1.83-1.8 1.82 1.8.6-.6-1.82-1.8 1.82-1.8.01.01Z"/>\n</svg>\n'},59046:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M8 16c1.105 0 2 .895 2 2s-.895 2-2 2-2-.895-2-2 .895-2 2-2zm11.5 1c.276 0 .5.224.5.5v1c0 .276-.224.5-.5.5h-7c-.276 0-.5-.224-.5-.5v-1c0-.276.224-.5.5-.5h7zm-11.5 0c-.552 0-1 .448-1 1s.448 1 1 1 1-.448 1-1-.448-1-1-1zm0-6c1.105 0 2 .895 2 2s-.895 2-2 2-2-.895-2-2 .895-2 2-2zm11.5 1c.276 0 .5.224.5.5v1c0 .276-.224.5-.5.5h-7c-.276 0-.5-.224-.5-.5v-1c0-.276.224-.5.5-.5h7zm-11.5 0c-.552 0-1 .448-1 1s.448 1 1 1 1-.448 1-1-.448-1-1-1zm0-6c1.105 0 2 .895 2 2s-.895 2-2 2-2-.895-2-2 .895-2 2-2zm11.5 1c.276 0 .5.224.5.5v1c0 .276-.224.5-.5.5h-7c-.276 0-.5-.224-.5-.5v-1c0-.276.224-.5.5-.5h7zm-11.5 0c-.552 0-1 .448-1 1s.448 1 1 1 1-.448 1-1-.448-1-1-1z"/></svg>'},49602:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M8 16c1.105 0 2 .895 2 2s-.895 2-2 2-2-.895-2-2 .895-2 2-2zm10.5 1c.276 0 .5.224.5.5v1c0 .276-.224.5-.5.5h-6c-.276 0-.5-.224-.5-.5v-1c0-.276.224-.5.5-.5h6zm-10.5 0c-.552 0-1 .448-1 1s.448 1 1 1 1-.448 1-1-.448-1-1-1zm0-6c1.105 0 2 .895 2 2s-.895 2-2 2-2-.895-2-2 .895-2 2-2zm10.5 1c.276 0 .5.224.5.5v1c0 .276-.224.5-.5.5h-6c-.276 0-.5-.224-.5-.5v-1c0-.276.224-.5.5-.5h6zm-10.5 0c-.552 0-1 .448-1 1s.448 1 1 1 1-.448 1-1-.448-1-1-1zm0-6c1.105 0 2 .895 2 2s-.895 2-2 2-2-.895-2-2 .895-2 2-2zm10.5 1c.276 0 .5.224.5.5v1c0 .276-.224.5-.5.5h-6c-.276 0-.5-.224-.5-.5v-1c0-.276.224-.5.5-.5h6zm-10.5 0c-.552 0-1 .448-1 1s.448 1 1 1 1-.448 1-1-.448-1-1-1z"/></svg>'},97888:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M3 4c0-.552.448-1 1-1h1c.552 0 1 .448 1 1v1c0 .552-.448 1-1 1h-1c-.552 0-1-.448-1-1v-1zm1 0h1v1h-1v-1zM3 8c0-.552.448-1 1-1h1c.552 0 1 .448 1 1v1c0 .552-.448 1-1 1h-1c-.552 0-1-.448-1-1v-1zm1 0h1v1h-1v-1zM6 12c0-.552-.448-1-1-1h-1c-.552 0-1 .448-1 1v1c0 .552.448 1 1 1h1c.552 0 1-.448 1-1v-1zm-1 0h-1v1h1v-1z"/><path d="M13 4.5c0-.276-.224-.5-.5-.5h-5c-.276 0-.5.224-.5.5s.224.5.5.5h5c.276 0 .5-.224.5-.5zM7 8.5c0-.276.224-.5.5-.5h5c.276 0 .5.224.5.5s-.224.5-.5.5h-5c-.276 0-.5-.224-.5-.5zM13 12.5c0-.276-.224-.5-.5-.5h-5c-.276 0-.5.224-.5.5s.224.5.5.5h5c.276 0 .5-.224.5-.5z"/></svg>'},28491:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M8 6c1.105 0 2 .895 2 2 0 .932-.637 1.714-1.499 1.937l-.001 2.563h1.563c.222-.863 1.005-1.5 1.937-1.5 1.105 0 2 .895 2 2s-.895 2-2 2c-.932 0-1.714-.637-1.937-1.499l-1.564-.001v3.006l.008.111c.058.497.48.883.993.883l.563-.001c.222-.862 1.005-1.499 1.937-1.499 1.105 0 2 .895 2 2s-.895 2-2 2c-.932 0-1.715-.637-1.937-1.5h-.563c-1.105 0-2-.895-2-2v-6.563c-.863-.222-1.5-1.005-1.5-1.937 0-1.105.895-2 2-2zm4 11c-.552 0-1 .448-1 1s.448 1 1 1 1-.448 1-1-.448-1-1-1zm8.5 0c.276 0 .5.224.5.5v1c0 .276-.224.5-.5.5h-4c-.276 0-.5-.224-.5-.5v-1c0-.276.224-.5.5-.5h4zm-8.5-5c-.552 0-1 .448-1 1s.448 1 1 1 1-.448 1-1-.448-1-1-1zm8.5 0c.276 0 .5.224.5.5v1c0 .276-.224.5-.5.5h-4c-.276 0-.5-.224-.5-.5v-1c0-.276.224-.5.5-.5h4zm-12.5-5c-.552 0-1 .448-1 1s.448 1 1 1 1-.448 1-1-.448-1-1-1zm12.5 0c.276 0 .5.224.5.5v1c0 .276-.224.5-.5.5h-8c-.276 0-.5-.224-.5-.5v-1c0-.276.224-.5.5-.5h8z"/></svg>'},98626:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M8 6c1.105 0 2 .895 2 2 0 .932-.637 1.714-1.499 1.937l-.001 2.563h1.563c.222-.863 1.005-1.5 1.937-1.5 1.105 0 2 .895 2 2s-.895 2-2 2c-.932 0-1.714-.637-1.937-1.499l-1.564-.001v3.006l.008.111c.058.497.48.883.993.883l.563-.001c.222-.862 1.005-1.499 1.937-1.499 1.105 0 2 .895 2 2s-.895 2-2 2c-.932 0-1.715-.637-1.937-1.5h-.563c-1.105 0-2-.895-2-2v-6.563c-.863-.222-1.5-1.005-1.5-1.937 0-1.105.895-2 2-2zm4 11c-.552 0-1 .448-1 1s.448 1 1 1 1-.448 1-1-.448-1-1-1zm7.5 0c.276 0 .5.224.5.5v1c0 .276-.224.5-.5.5h-3c-.276 0-.5-.224-.5-.5v-1c0-.276.224-.5.5-.5h3zm-7.5-5c-.552 0-1 .448-1 1s.448 1 1 1 1-.448 1-1-.448-1-1-1zm7.5 0c.276 0 .5.224.5.5v1c0 .276-.224.5-.5.5h-3c-.276 0-.5-.224-.5-.5v-1c0-.276.224-.5.5-.5h3zm-11.5-5c-.552 0-1 .448-1 1s.448 1 1 1 1-.448 1-1-.448-1-1-1zm11.5 0c.276 0 .5.224.5.5v1c0 .276-.224.5-.5.5h-7c-.276 0-.5-.224-.5-.5v-1c0-.276.224-.5.5-.5h7z"/></svg>'},31560:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M6 4c0-.552-.448-1-1-1h-1c-.552 0-1 .448-1 1v1c0 .552.448 1 1 1v6c0 .552.448 1 1 1h2c0 .552.448 1 1 1h1c.552 0 1-.448 1-1v-1c0-.552-.448-1-1-1h-1c-.552 0-1 .448-1 1h-2v-3h2c0 .552.448 1 1 1h1c.552 0 1-.448 1-1v-1c0-.552-.448-1-1-1h-1c-.552 0-1 .448-1 1h-2v-2c.552 0 1-.448 1-1v-1zm-1 0h-1v1h1v-1zm4 4h-1v1h1v-1zm-1 4h1v1h-1v-1z"/><path d="M7 4.5c0-.276.224-.5.5-.5h6c.276 0 .5.224.5.5s-.224.5-.5.5h-6c-.276 0-.5-.224-.5-.5zM14 8.5c0-.276-.224-.5-.5-.5h-2c-.276 0-.5.224-.5.5s.224.5.5.5h2c.276 0 .5-.224.5-.5zM11 12.5c0-.276.224-.5.5-.5h2c.276 0 .5.224.5.5s-.224.5-.5.5h-2c-.276 0-.5-.224-.5-.5z"/></svg>'},35719:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M21.5 10c1.381 0 2.5-1.119 2.5-2.5s-1.119-2.5-2.5-2.5-2.5 1.119-2.5 2.5 1.119 2.5 2.5 2.5zm-14.5-2h10.027c.081.734.339 1.416.73 2h-.051l-4.354 4.354-.354.354-.354-.354-4.353-4.354h-1.293v7h12v-5.758c.584.391 1.266.649 2 .73v5.027c0 1.105-.895 2-2 2h-12c-1.105 0-2-.895-2-2v-7c0-1.105.895-2 2-2zm2.707 2l3.293 3.293 3.293-3.293h-6.586z"/></svg>'},58480:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M14 5c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM15 12v-5.126c-.32.082-.655.126-1 .126s-.68-.044-1-.126v4.126h-10v-6h.793l4.207 4.207 3.277-3.277c-.245-.228-.462-.487-.644-.77l-2.633 2.633-2.793-2.793h5.328c-.34-.588-.535-1.271-.535-2h-8c-.552 0-1 .448-1 1v8c0 .552.448 1 1 1h12c.552 0 1-.448 1-1z"/></svg>'},44895:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M14 5c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z"/><path fill-rule="evenodd" clip-rule="evenodd" d="M14 11v-5c-.351 0-.687-.06-1-.171v5.171h-10v-6h.293l4.707 4.707 4.262-4.262c-.498-.355-.883-.858-1.091-1.445h-8.171c-.552 0-1 .448-1 1v6c0 .552.448 1 1 1h10c.552 0 1-.448 1-1zm-6-2.707l3.293-3.293h-6.586l3.293 3.293z"/></svg>'},99978:e=>{e.exports='<svg width="26" height="26" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M12.09 5c-1.031 0-1.825.912-1.825 1.937v1.318h-2.7C6.743 8.255 6 8.997 6 9.821v2.205h1.195c1 0 1.772.86 1.772 1.883 0 1.02-.769 1.846-1.772 1.846H6v2.68C6 19.257 6.742 20 7.566 20h2.679v-1.195c0-1.003.826-1.772 1.846-1.772 1.024 0 1.883.772 1.883 1.772V20h2.246c.824 0 1.566-.742 1.566-1.566v-2.7h1.277c1.025 0 1.937-.793 1.937-1.825 0-1.03-.91-1.862-1.937-1.862h-1.277V9.82c0-.824-.742-1.566-1.566-1.566h-2.267V6.937c0-1.027-.85-1.937-1.862-1.937z"/>\n</svg>\n'},34861:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M7.279 1c-.895 0-1.583.79-1.583 1.679V3.82H3.357C2.643 3.821 2 4.464 2 5.18v1.91h1.036c.866 0 1.535.745 1.535 1.632 0 .884-.666 1.6-1.535 1.6H2v2.322C2 13.357 2.643 14 3.357 14H5.68v-1.036c0-.87.716-1.535 1.6-1.535.887 0 1.632.669 1.632 1.535V14h1.946c.715 0 1.357-.643 1.357-1.357v-2.34h1.107c.889 0 1.679-.687 1.679-1.582 0-.893-.79-1.614-1.679-1.614h-1.107V5.18c0-.715-.642-1.358-1.357-1.358H8.893V2.68c0-.891-.738-1.68-1.614-1.68z"/>\n</svg>\n'},17792:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M5.357 3c0-1.03.8-2 1.91-2 1.079 0 1.94.952 1.94 2v.25h1.75c.906 0 1.7.794 1.7 1.7V6.7h.25c1.044 0 2 .843 2 1.94 0 1.11-.97 1.91-2 1.91h-.25v1.75c0 .906-.794 1.7-1.7 1.7h-2.6v-1.4c0-.542-.473-1-1.09-1-.605 0-1.06.446-1.06 1V14h-2.6c-.906 0-1.7-.794-1.7-1.7V9.7h1.4c.553 0 1-.455 1-1.06 0-.618-.459-1.09-1-1.09h-1.4v-2.6c0-.906.794-1.7 1.7-1.7h1.75V3zm1.91-1c-.48 0-.91.44-.91 1v1.25h-2.75c-.354 0-.7.346-.7.7v1.6h.4c1.168 0 2 .998 2 2.09 0 1.105-.844 2.06-2 2.06h-.4v1.6c0 .354.346.7.7.7h1.6v-.4c0-1.156.955-2 2.06-2 1.092 0 2.09.832 2.09 2v.4h1.6c.354 0 .7-.346.7-.7V9.55h1.25c.56 0 1-.43 1-.91 0-.493-.455-.94-1-.94h-1.25V4.95c0-.354-.346-.7-.7-.7h-2.75V3c0-.542-.46-1-.94-1z"/></svg>\n'},70942:e=>{e.exports='<svg width="12" height="12" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M10.146 5.146 8.854 3.854l-3 3a.5.5 0 1 1-.708-.708l3-3-1.292-1.292A.5.5 0 0 1 7.207 1H11v3.793a.5.5 0 0 1-.854.353ZM1.5 2A1.5 1.5 0 0 0 0 3.5v7A1.5 1.5 0 0 0 1.5 12h7a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0v2a.5.5 0 0 1-.5.5h-7a.5.5 0 0 1-.5-.5v-7a.5.5 0 0 1 .5-.5h3a.5.5 0 0 0 0-1h-3Z"/>\n</svg>\n'},6836:e=>{e.exports='<svg width="46" height="46" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M23 45c9.64 0 15 0 18.5-3.5S45 32.64 45 23s0-15-3.5-18.5S32.64 1 23 1 8 1 4.5 4.5 1 13.36 1 23s0 15 3.5 18.5S13.36 45 23 45Z" fill="var(--colorAccentBg)"/>\n  <path d="M41.5 41.5C38 45 32.64 45 23 45c-1.819 0-3.485 0-5.016-.023L11 34.5a3.716 3.716 0 0 1 1.714-3.759l1.891-1.168-4.004-6.84 4.004-3.396-4.004-5.603c0-1.019.962-1.764 1.948-1.508l11.955 3.095a11.5 11.5 0 0 1 5.146 2.9L32.5 21l10.552 18.447a9.28 9.28 0 0 1-1.552 2.052Z" fill="url(#a)"/>\n  <path d="M36.879 33.431c.134 1.414-1.03 2.569-2.45 2.569-1.42 0-2.556-1.156-2.722-2.567-1.175-10.005-9.135-17.965-19.14-19.14C11.157 14.127 10 12.992 10 11.57c0-1.42 1.155-2.584 2.569-2.45C25.41 10.34 35.66 20.59 36.879 33.431ZM13.857 36a3.857 3.857 0 1 0 0-7.714 3.857 3.857 0 0 0 0 7.714Z" fill="#fff"/>\n  <path d="M25.429 36c1.42 0 2.59-1.158 2.389-2.564-1.128-7.878-7.376-14.126-15.254-15.254-1.406-.201-2.564.97-2.564 2.39 0 1.42 1.163 2.544 2.555 2.826a12.896 12.896 0 0 1 10.047 10.047C22.884 34.837 24.008 36 25.43 36Z" fill="#fff"/>\n  <defs>\n    <linearGradient id="a" x1="18.809" y1="9.472" x2="41.713" y2="48.206" gradientUnits="userSpaceOnUse">\n      <stop stop-opacity=".2"/>\n      <stop offset=".791" stop-opacity=".05"/>\n    </linearGradient>\n  </defs>\n</svg>\n'},4103:e=>{e.exports='<svg width="10" height="10" xmlns="http://www.w3.org/2000/svg">\n  <path stroke-width="0" d="M7 5L3.366 8.634A.8.8 0 012 8.07V1.93a.8.8 0 011.366-.565L7 5z"/>\n</svg>\n'},94012:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n<path d="M6.8801 6.95769L5.6801 5H4V11H12V6.95769H6.8801ZM12.8425 6.96C12.8423 6.96029 12.8363 6.96 12.8254 6.95824C12.8373 6.95882 12.8428 6.9597 12.8425 6.96ZM6.8 3L8 4.95769H12.8C13.46 4.95769 14 5.2125 14 5.9V11.75C14 12.4375 13.46 13 12.8 13H3.2C2.54 13 2 12.4375 2 11.75V4.25C2 3.5625 2.54 3 3.2 3H6.8Z"/>\n</svg>\n'},27139:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M2.00071 4.21203C2.00586 3.89221 2.13395 3.58693 2.35788 3.36075C2.58182 3.13457 2.88406 3.0052 3.20071 3H6.80071L8.00072 5H13.0007C13.5007 5 14.0007 5.5 14.0007 6L14.0007 11.7872C13.9956 12.1071 13.8675 12.4123 13.6435 12.6385C13.4196 12.8647 13.1174 12.9941 12.8007 12.9993H3.20071C3.04162 13.0049 2.88308 12.9774 2.73497 12.9185C2.58685 12.8596 2.45232 12.7705 2.33976 12.6568C2.22719 12.5431 2.139 12.4073 2.08067 12.2577C2.02234 12.1081 1.99513 11.9479 2.00071 11.7872V8H2V7H2.00071V4.21203ZM3.00071 8V11.8046L3.00011 11.822C2.99924 11.847 3.0035 11.8717 3.01236 11.8944C3.02122 11.9171 3.03435 11.9371 3.05038 11.9533C3.06639 11.9694 3.08492 11.9815 3.10455 11.9893C3.12415 11.9971 3.14478 12.0006 3.16526 11.9999L3.18298 11.9993H12.7891C12.8414 11.9972 12.893 11.9753 12.9329 11.935C12.9733 11.8942 12.9985 11.8376 13.0007 11.7761L13.0007 8H3.00071ZM13.0007 7H3.00071V4.22318C3.00294 4.16171 3.02812 4.10511 3.06851 4.06432C3.10845 4.02398 3.16001 4.00208 3.21233 4H6.24661L7.50072 6H12.8007C12.9112 6 13.0007 6.08796 13.0007 6.19842V7Z"/>\n  <path fill-rule="evenodd" d="M2.99938 11.822L2.99998 11.8046L2.99938 8H12.8C12.9104 8 13 8.08938 13 8.19983C13 8.87896 13 11.0937 13 11.7761C12.9978 11.8376 12.9726 11.8942 12.9322 11.935C12.8922 11.9753 12.8407 11.9972 12.7884 11.9993H3.18225L3.16453 11.9999C3.14404 12.0006 3.12342 11.9971 3.10382 11.9893C3.08419 11.9815 3.06565 11.9694 3.04965 11.9533C3.03362 11.9371 3.02049 11.9171 3.01163 11.8944C3.00276 11.8717 2.99851 11.847 2.99938 11.822Z" fill-opacity="0.1"/>\n</svg>\n'},64750:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M2.35717 3.36075C2.13323 3.58693 2.00515 3.89221 2 4.21203V11.7872C1.99441 11.9479 2.02163 12.1081 2.07996 12.2577C2.13828 12.4073 2.22648 12.5431 2.33904 12.6568C2.4516 12.7705 2.58613 12.8596 2.73425 12.9185C2.88237 12.9774 3.04091 13.0049 3.2 12.9993H12.8C13.1167 12.9941 13.4189 12.8647 13.6428 12.6385C13.8668 12.4123 13.9948 12.1071 14 11.7872L14 6C14 5.5 13.5 5 13 5H8L6.8 3H3.2C2.88334 3.0052 2.5811 3.13457 2.35717 3.36075ZM2.99939 11.822L3 11.8046V4.22318C3.00223 4.16171 3.02741 4.10511 3.06779 4.06432C3.10773 4.02398 3.15929 4.00208 3.21161 4H6.24589L7.5 6H12.8C12.9105 6 13 6.08796 13 6.19842C13 7.13107 13 11.0636 13 11.7761C12.9978 11.8376 12.9726 11.8942 12.9322 11.935C12.8923 11.9753 12.8407 11.9972 12.7884 11.9993H3.18227L3.16455 11.9999C3.14406 12.0006 3.12343 11.9971 3.10383 11.9893C3.08421 11.9815 3.06567 11.9694 3.04966 11.9533C3.03364 11.9371 3.02051 11.9171 3.01165 11.8944C3.00278 11.8717 2.99853 11.847 2.99939 11.822Z"/>\n  <path fill-rule="evenodd" d="M2.99939 11.822L3 11.8046V4.22318C3.00223 4.16171 3.02741 4.10511 3.06779 4.06432C3.10773 4.02398 3.15929 4.00208 3.21161 4H6.24589L7.5 6H12.8C12.9105 6 13 6.08796 13 6.19842C13 7.13107 13 11.0636 13 11.7761C12.9978 11.8376 12.9726 11.8942 12.9322 11.935C12.8923 11.9753 12.8407 11.9972 12.7884 11.9993H3.18227L3.16455 11.9999C3.14406 12.0006 3.12343 11.9971 3.10383 11.9893C3.08421 11.9815 3.06567 11.9694 3.04967 11.9533C3.03364 11.9371 3.02051 11.9171 3.01165 11.8944C3.00278 11.8717 2.99853 11.847 2.99939 11.822Z" fill-opacity="0.1"/>\n</svg>\n'},16441:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M10 10H12V12H10V10ZM15 10H13V12H15V10ZM15 13H13V15H15V13ZM12 13H10V15H12V13Z"/>\n  <path fill-rule="evenodd" d="M2.35788 3.36075C2.13395 3.58693 2.00586 3.89221 2.00071 4.21203V7H2V8H2.00071V11.7872C1.99513 11.9479 2.02234 12.1081 2.08067 12.2577C2.139 12.4073 2.22719 12.5431 2.33976 12.6568C2.45232 12.7705 2.58685 12.8596 2.73497 12.9185C2.88308 12.9774 3.04162 13.0049 3.20071 12.9993H9V11.9993H3.18298L3.16526 11.9999C3.14478 12.0006 3.12415 11.9971 3.10455 11.9893C3.08492 11.9815 3.06639 11.9694 3.05038 11.9533C3.03435 11.9371 3.02122 11.9171 3.01236 11.8944C3.0035 11.8717 2.99924 11.847 3.00011 11.822L3.00071 11.8046V8H13.0007V9H14.0007L14.0007 6C14.0007 5.5 13.5007 5 13.0007 5H8.00072L6.80071 3H3.20071C2.88406 3.0052 2.58182 3.13457 2.35788 3.36075ZM3.00071 7H13.0007V6.19842C13.0007 6.08796 12.9112 6 12.8007 6H7.50072L6.24661 4H3.21233C3.16001 4.00208 3.10845 4.02398 3.06851 4.06432C3.02812 4.10511 3.00294 4.16171 3.00071 4.22318V7Z"/>\n  <path fill-rule="evenodd" d="M2.99998 11.8046L2.99938 11.822C2.99851 11.847 3.00276 11.8717 3.01163 11.8944C3.02049 11.9171 3.03362 11.9371 3.04965 11.9533C3.06565 11.9694 3.08419 11.9815 3.10382 11.9893C3.12342 11.9971 3.14404 12.0006 3.16453 11.9999L3.18225 11.9993H9V9H13V8.19983C13 8.08938 12.9104 8 12.8 8H2.99938L2.99998 11.8046Z" fill-opacity="0.1"/>\n</svg>\n'},31102:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M10 10H12V12H10V10ZM15 10H13V12H15V10ZM15 13H13V15H15V13ZM12 13H10V15H12V13Z"/>\n  <path fill-rule="evenodd" d="M2 4.21203C2.00515 3.89221 2.13323 3.58693 2.35717 3.36075C2.5811 3.13457 2.88334 3.0052 3.2 3H6.8L8 5H13C13.5 5 14 5.5 14 6L14 9H13L13 6.19842C13 6.08796 12.9105 6 12.8 6H7.5L6.24589 4H3.21161C3.15929 4.00208 3.10773 4.02398 3.06779 4.06432C3.02741 4.10511 3.00223 4.16171 3 4.22318V11.8046L2.99939 11.822C2.99853 11.847 3.00278 11.8717 3.01165 11.8944C3.02051 11.9171 3.03364 11.9371 3.04966 11.9533C3.06567 11.9694 3.08421 11.9815 3.10383 11.9893C3.12343 11.9971 3.14406 12.0006 3.16455 11.9999L3.18227 11.9993H9V12.9993H3.2C3.04091 13.0049 2.88237 12.9774 2.73425 12.9185C2.58613 12.8596 2.4516 12.7705 2.33904 12.6568C2.22648 12.5431 2.13828 12.4073 2.07996 12.2577C2.02163 12.1081 1.99441 11.9479 2 11.7872V4.21203Z" />\n  <path fill-rule="evenodd" d="M3 11.8046L2.99939 11.822C2.99853 11.847 3.00278 11.8717 3.01165 11.8944C3.02051 11.9171 3.03364 11.9371 3.04967 11.9533C3.06567 11.9694 3.08421 11.9815 3.10383 11.9893C3.12343 11.9971 3.14406 12.0006 3.16455 11.9999L3.18227 11.9993H9V9H13L13 6.19842C13 6.08796 12.9105 6 12.8 6H7.5L6.24589 4H3.21161C3.15929 4.00208 3.10773 4.02398 3.06779 4.06432C3.02741 4.10511 3.00223 4.16171 3 4.22318V11.8046Z" fill-opacity="0.1"/>\n</svg>\n'},47802:e=>{e.exports='<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <rect x="6" y="17" width="15" height="4" rx="1"/>\n  <rect x="15" y="10" width="2" height="8"/>\n  <circle cx="16" cy="9" r="4"/>\n  <rect x="7" y="16" width="5" height="4" rx="0.5"/>\n</svg>\n'},48082:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <rect x="2" y="10" width="12" height="4" rx="1" />\n  <rect x="9" y="6" width="2" height="5" />\n  <circle cx="10" cy="4" r="3" />\n  <rect x="3" y="9" width="3" height="2" rx="0.5" />\n</svg>\n'},82418:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M13.1429 11H2.85714V12H13.1429V11ZM2.85714 10C2.38376 10 2 10.4477 2 11V12C2 12.5523 2.38376 13 2.85714 13H13.1429C13.6162 13 14 12.5523 14 12V11C14 10.4477 13.6162 10 13.1429 10H2.85714Z"/>\n  <path fill-rule="evenodd" d="M10.5 2.80208C9.56227 2.80208 8.80208 3.56227 8.80208 4.5C8.80208 5.43773 9.56227 6.19792 10.5 6.19792C11.4377 6.19792 12.1979 5.43773 12.1979 4.5C12.1979 3.56227 11.4377 2.80208 10.5 2.80208ZM7.95312 4.5C7.95312 3.0934 9.0934 1.95312 10.5 1.95312C11.9066 1.95312 13.0469 3.0934 13.0469 4.5C13.0469 5.9066 11.9066 7.04688 10.5 7.04688C9.0934 7.04688 7.95312 5.9066 7.95312 4.5Z"/>\n  <rect x="4" y="9" width="3" height="2" rx="0.5"/>\n  <rect x="10" y="7" width="1" height="4"/>\n</svg>\n'},72067:e=>{e.exports='<svg width="84" height="84" viewBox="0 0 84 84" xmlns="http://www.w3.org/2000/svg">\n\n  <path d="M42.2833 9.02699L42 8.97252L41.7168 9.02699L16.5168 13.8731L15.3 14.1071V15.3462V49.2692V49.5802L15.4237 49.8656C20.1281 60.7219 28.8324 69.0402 41.3684 74.8605L42.0004 75.154L42.6324 74.8602C55.1577 69.0377 63.8559 60.7194 68.5592 49.8656L68.6827 49.5806L68.6828 49.27L68.7001 15.3469L68.7007 14.1073L67.4833 13.8731L42.2833 9.02699Z" opacity="var(--shieldOpacity)" />\n  <path fill-opacity="0.1" d="M42 73.5C55.65 67.2 63 58.8 67.2 49.35V15.3398L42 10.5V73.5Z"/>\n  <path d="M42.0001 16.8L23.1001 19.95V48.3C26.4958 56.6664 32.7958 62.6451 42.0001 67.2C51.1918 62.6388 57.4918 56.6664 60.8875 48.3L60.9001 19.95L42.0001 16.8Z" fill-opacity="var(--shieldInnerOpacity)"/>\n  <path fill-rule="evenodd" fill-opacity="0.8" d="M42 7.44503L70.2013 12.8683L70.1825 49.892L69.9355 50.462C65.0597 61.7138 56.0577 70.2735 43.2647 76.2204L42.0008 76.8079L40.7367 76.221C27.933 70.2764 18.9244 61.7167 14.0474 50.462L13.8 49.8913V12.8681L42 7.44503ZM16.8 49.2692V15.3462L42 10.5L67.2001 15.3462L67.1828 49.2692C62.652 59.725 54.2577 67.8019 42 73.5C29.7318 67.804 21.3318 59.7271 16.8 49.2692Z" />\n\n</svg>\n'},19458:e=>{e.exports='<svg viewBox="0 0 110 90" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" preserveAspectRatio="xMidYMid slice">\n  <g>\n    <path fill="transparent" d="M0 0h110v90h-110z" class="folderoutline"/>\n    <polygon fill="url(#bookmark-graphic-gradient)" class="bookmark-shadow" points="66 30 65 62 55 57 44 64 60 90 98 90" />\n    <g>\n      <use class="bookmark-shape" xlink:href="#sd-bookmark"/>\n      <use fill="url(#sd-bookmark-gradient)" fill-opacity="0.1" xlink:href="#sd-bookmark"/>\n    </g>\n  </g>\n</svg>\n'},23914:e=>{e.exports='<svg class="first-new-note-icon" width="46" height="46">\n  <path class="new-note-border-color" d="M37 46H1a1 1 0 0 1-1-1V9a1 1 0 0 1 1-1h16a1 1 0 1 1 0 2H2v34h34V29a1 1 0 1 1 2 0v16a1 1 0 0 1-1 1z"/>\n  <path class="new-note-wood-tip" d="M21.707 33.707L20.958 25l-8.665-.707-.754 6.246 3.922 3.922z"/>\n  <path class="new-note-main-color" d="M31.293 5.293l-19 19 5.457 5.457 18.906-19.094z"/>\n  <path class="new-note-secondary-color" d="M17 29l19-19 4.708 4.707-19 19z"/>\n  <path class="new-note-darker-top-eraser" d="M40.7,14.7l5-5c0.4-0.4,0.4-1,0-1.4L42.4,5l-5.8,5.6L40.7,14.7z"/>\n  <path class="new-note-dark-top-eraser" d="M45.707 8.293l-8-8a1 1 0 0 0-1.414 0l-5 5 9.414 9.414 5-5a1 1 0 0 0 0-1.414z"/>\n  <path class="new-note-dark-top-border" d="M30.586 6L32 4.586 41.414 14 40 15.414z"/>\n  <path class="new-note-led-tip" d="M15.5,34.5l-3.9-3.9L11,35L15.5,34.5z"/>\n</svg>'},5231:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n\t<rect x="12" y="8.5" width="2" height="5" rx="1" ry="1"\n\t  style="transform-origin: center; transform: var(--timeHourRotation, rotate(130deg))"\n\t/>\n\t<rect x="12" y="8" width="2" height="6" rx="1" ry="1"\n\t  style="transform-origin: center; transform: var(--timeMinuteRotation, rotate(0deg))"\n\t/>\n\t<path fill-rule="evenodd" d="M5 13C5 11.1401 5 10.2101 5.20445 9.44709C5.75925 7.37653 7.37653 5.75925 9.44709 5.20445C10.2101 5 11.1401 5 13 5C14.8599 5 15.7899 5 16.5529 5.20445C18.6235 5.75925 20.2408 7.37653 20.7956 9.44709C21 10.2101 21 11.1401 21 13C21 14.8599 21 15.7899 20.7956 16.5529C20.2408 18.6235 18.6235 20.2408 16.5529 20.7956C15.7899 21 14.8599 21 13 21C11.1401 21 10.2101 21 9.44709 20.7956C7.37653 20.2408 5.75925 18.6235 5.20445 16.5529C5 15.7899 5 14.8599 5 13ZM13 19C11.0113 19 10.4093 18.9828 9.96472 18.8637C8.58436 18.4938 7.50617 17.4156 7.1363 16.0353C7.01718 15.5907 7 14.9887 7 13C7 11.0113 7.01718 10.4093 7.1363 9.96472C7.50617 8.58436 8.58436 7.50617 9.96472 7.1363C10.4093 7.01718 11.0113 7 13 7C14.9887 7 15.5907 7.01718 16.0353 7.1363C17.4156 7.50617 18.4938 8.58436 18.8637 9.96472C18.9828 10.4093 19 11.0113 19 13C19 14.9887 18.9828 15.5907 18.8637 16.0353C18.4938 17.4156 17.4156 18.4938 16.0353 18.8637C15.5907 18.9828 14.9887 19 13 19Z"/>\n</svg>\n'},66089:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M7 5.5C7 5.22386 7.22386 5 7.5 5H8.5C8.77614 5 9 5.22386 9 5.5V8.70711L10.2289 9.70014C10.4366 9.86798 10.4758 10.1694 10.3179 10.3847L9.80837 11.0795C9.6402 11.3088 9.31488 11.3519 9.09282 11.1743L7 9.5V5.5Z"/>\n  <path fill-rule="evenodd" d="M1 8C1 6.13872 1 5.20808 1.24472 4.45492C1.73931 2.93273 2.93273 1.73931 4.45492 1.24472C5.20808 1 6.13872 1 8 1C9.86128 1 10.7919 1 11.5451 1.24472C13.0673 1.73931 14.2607 2.93273 14.7553 4.45492C15 5.20808 15 6.13872 15 8C15 9.86128 15 10.7919 14.7553 11.5451C14.2607 13.0673 13.0673 14.2607 11.5451 14.7553C10.7919 15 9.86128 15 8 15C6.13872 15 5.20808 15 4.45492 14.7553C2.93273 14.2607 1.73931 13.0673 1.24472 11.5451C1 10.7919 1 9.86128 1 8ZM8 13C5.98305 13 5.44891 12.9753 5.07295 12.8532C4.15964 12.5564 3.44358 11.8404 3.14683 10.9271C3.02467 10.5511 3 10.0169 3 8C3 5.98305 3.02467 5.44891 3.14683 5.07295C3.44358 4.15964 4.15964 3.44358 5.07295 3.14683C5.44891 3.02467 5.98305 3 8 3C10.0169 3 10.5511 3.02467 10.9271 3.14683C11.8404 3.44358 12.5564 4.15964 12.8532 5.07295C12.9753 5.44891 13 5.98305 13 8C13 10.0169 12.9753 10.5511 12.8532 10.9271C12.5564 11.8404 11.8404 12.5564 10.9271 12.8532C10.5511 12.9753 10.0169 13 8 13Z"/>\n</svg>\n'},3335:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M6 2h4a4 4 0 014 4v4a4 4 0 01-4 4H6a4 4 0 01-4-4V6a4 4 0 014-4zM1 6a5 5 0 015-5h4a5 5 0 015 5v4a5 5 0 01-5 5H6a5 5 0 01-5-5V6zm6-2h1v4h2v1H7V4z"/>\n</svg>\n'},91273:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path class="small-icon-fill" fill-rule="evenodd" d="M6 1a5 5 0 00-5 5v4a5 5 0 005 5h4a5 5 0 005-5V6a5 5 0 00-5-5H6zm1 3h1v4h2v1H7V4z"/>\n  <path class="small-icon-outline" fill-rule="evenodd" d="M10 2H6a4 4 0 00-4 4v4a4 4 0 004 4h4a4 4 0 004-4V6a4 4 0 00-4-4zM6 1a5 5 0 00-5 5v4a5 5 0 005 5h4a5 5 0 005-5V6a5 5 0 00-5-5H6z"/>\n</svg>\n'},89237:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 285">\n  <path d="M123 280.7c-.9-.1-1.6-.3-1.4-1.2 3.2-13.9 4.9-28.3 9.7-41.8.7-2 1.8-3.9 2.8-6-.5-.4-.9-.8-1-.8-34.6 20.6-69.8 21-105.5 4.4C16 229.9 6.6 221 4 208c-3-14.9-4.9-30.2.4-45.1 6-16.7 18.7-26.9 34.7-33.4 18.6-7.6 37.9-10.2 57.9-8 .5.1 1.1 0 1.4-.3 12.6-9.5 26.9-16.1 40.6-23.7 8.6-4.8 15.9-11.5 24.5-16.3.3-.2.6-.5.7-.8 1.8-5.2 6.3-7.3 10.7-9.3 14.6-6.5 29.4-12.8 44-19.4 23-10.4 44.6-23 64.6-38.4 4.3-3.3 9-6.3 13.5-9.3.8.2 1.1.7 1.3 1.6-4.1 2.8-8.3 5.7-12.5 8.6-12.7 8.9-24.9 18.4-38.6 25.7-22.8 12.2-46.6 22.4-70.3 32.7-4.5 2-9.1 3.9-11.1 9.1-.7 1.9-3.1 2.4-4.7 3.6-17 12.8-36.5 21.6-54.5 32.8-7.7 4.8-15 10.3-21.1 17-2.8 3.1-2.3 5.4 1.7 6.7 4.2 1.3 8.3 1.4 12.3-.9 11.3-6.4 23.4-10.5 36-13.2 2.3-.5 4.6-1.5 6.8-2.5 5.9-2.5 11.9-3.5 18.3-3.3 5.3.2 10.6.5 15.9-.2.7-.1 1.4 0 1.5.9.1.9-.4 1.1-1.2 1.2-1.5.1-2.9.5-4.4.5-5.6.1-11.1 0-16.6 0-1.5 7-3.3 15.1 3.5 20.9 4.2 3.6 8.2 7.5 12.8 11.6-.2-8.1 5.3-12.3 10.7-16.6-2.4-3.1-6-4-9.3-2.8-3.1 1.1-6.2 2-9.3 3-.2.1-.5-.1-.7-.1-.6-1.2 0-1.7 1-2.1 3.5-1.2 7-2.3 10.5-3.6 5.4-2 6.7-5.5 4.2-11.2.7-1 1.9-1.2 3-.9 1.5.3 2.2 1.5 2.4 2.9.6 3.6 1.2 7.2 1.8 11.2 2.1-2 3.3-4 4-6.2 1.2-3.9 2.4-7.9 2.3-12 0-.7.3-1.4 1.3-1.4.8 0 1 .7.9 1.3-.7 7.8-1.8 15.3-8.1 21-2.5 2.3-4.8 4.7-7.4 6.7-4.2 3.2-5 8-5.7 12.7-.9 7.1 3.4 12.7 12 16 1.2.5 2.4.9 3 2.4 4.4-1.9 9.2-3 11.8-7.9 2.2-4.2 6.5-6.3 10.4-8.7 5.3-3.4 10.9-6.3 15.9-10.2 2.6-2 5.6-3.2 8.6-4.5 13-5.4 24.5-13 33.9-23.4 5.9-6.5 9.7-14.7 13.4-22.7 3.1-6.9 7-13 14.6-16.3.4.1.7.7.9 1.4-.3.3-.6.6-1 .8-5.8 3.1-9.3 8-12 13.8-2.8 6.2-6.2 12.1-9.7 18-6.3 10.7-16.4 17.1-26.3 23.7-.5.4-1.1.7-1.6.9-.3 4.1.1 7.8 2.2 11.5 2 3.4 1.5 7.2-1 10.3-2.3 2.8-5.5 2.5-8.8 2-5.5-.8-9.9-4.4-14.9-6.4-4.3-1.7-8-2-10.9 2.1 5 6.1 5.5 10 1.9 14.4-3.4 4.1-7.8 3.8-17.1-1.3-4.1 2.2-8.3 4.2-12.9 5.1-9.2 2-17.4-4.2-15.7-13.3 1.5-7.7-2.8-11.1-7.3-15-4.9-4.3-10.5-8.2-10.9-15.6-.1-3.1.5-6.2.8-9.4.1-.6.1-1.2.2-2.2-8.4 1.5-15.7 6.1-24.4 7.1 19.2 12 32 27.3 29.6 51.1 3.7.5 7.2 1 10.8 1.6-.1 1.9-.3 3.6-.4 5.4 5.7 1.9 11.6 2.8 17.5 3.5 10.9 1.5 22 2.3 33 2.4 15.2.1 29.9-2.8 44-8.4 4.2-1.6 8.4-3.5 12.5-5.3 1.1-.4 2.1-.8 3 .3-36 19.5-73.7 17.3-112 9-1.5 2-1.9 4.5-2.5 7.2 40 7.2 79.3 8.6 117.1-10.2.9 1.1 0 1.8-1.1 2.4-8.4 4.7-17.5 7.3-26.7 9.8-18.6 5-37.5 5.5-56.6 4.2-10.6-.7-21-2.1-31.4-4h-.7c-.6 1.3-1.1 2.5-1.7 3.7-3.7-.5-7.2-1-10.8-1.5-.4.7-.7 1.2-1.2 2 1.9.6 3.7 1.2 5.4 1.8 2.3.9 3.2 2.7 2 4.9-3.4 6.4-6.8 12.8-10.4 19-1.3 2.3-3.2 4.2-4.9 6.4-1.5-.6-3.1-1.1-4.7-1.8-6.3 14.7-7.3 31-13.1 45.8 3.7-16.1 5.7-32.6 12-48.2 1.6.6 3.1 1.2 4.7 1.8-.2-1.2 0-2.3-1-3.1-.8-.6-1.6-1.3-2.5-2 .7-1.6 1.2-3.2 2-4.6.4-.7.9-2 1.9-1.7 1.8.5 3.3 1.6 4.1 3.4.2.5.3 1.1.6 2.2 3.4-6.4 6.6-12.3 9.7-18.4.6-1.1-.4-1.8-1.5-2.2-4.5-1.4-9-3.3-13.7-3.9-4.2 3.1-4.8 9.1-1 11.3-.9 1.4-1.7 2.8-2.7 4.3 1.1.6 2.1 1.1 3.4 1.7-1.3 2.3-2.6 4.6-3.9 7-1.3-.7-2.3-1.4-3.4-2-1.2 1.1-1.2 1.1 1.9 5.2-8.1 15.4-8.3 32.9-13.1 49.3zM92.4 125.6c-10.7-1.2-21-.7-31.2 1.2-14.7 2.7-28.3 7.9-39.5 18.3-13.2 12.2-15 28.9-4.6 42.4 7.5 9.6 17.6 15.4 28.9 19.4 17.5 6.2 35.5 7.3 53.7 4.2 14.8-2.4 28.5-7.7 40-17.8 10.8-9.4 14.9-22.8 10.1-34.7-5-12.5-15.3-19.6-26.9-25.1-.5-.2-1.3.1-1.9.2-7.5 2.3-14.5 5.6-21.4 9.3-4.8 2.6-9.8 1.9-14.5 0-3.7-1.5-4.5-5.4-2-8.4 2.7-3.2 5.8-6 9.3-9zm57.7 76.8c-1.8-.9-4.3.5-5.1-1.6-.9-2.7-1.9-5.5.6-8.2 1.8-1.9 3.3-4.3 4.6-6.6 1.4-2.5 1.9-5.9 6.1-3.7.3-9.6.1-18.7-5.4-26.8 2.8 6.4 4 12.9 2.3 19.8-3.1 12.8-11.8 21.2-22.7 27.4-19.7 11.1-41 14.1-63.2 11.4-17.2-2.1-33.1-7.4-46.4-19.2-11.9-10.5-15.8-25-10-38.3 1.1-2.6 2.8-5.1 4.6-8.4-4.5 5.2-7.4 10.4-9.5 16.1-3.4 9.3-2.4 18.9-2 28.4.3 5.6.3 11.3 2.2 16.7 3.9 11 11.6 18.7 21.7 23.8 25 12.6 51.3 14.7 78.3 7.6 9.2-2.4 17.8-6.5 23.9-11 3.2-5.5 5.4-9.4 7.7-13.3-1-.4-1.8-1-1.8-2-.2-4 .2-7.8 2.6-11.2.7-.9 1.5-1.8 2.9-1.4 2.5.7 5 1.4 7.6 2.2.4-.8.7-1.2 1-1.7zm72.3-46.3c.7.2 1.5.6 2.3.8 5.4 1.3 9.6 5.4 15.2 6.5 5.4 1.1 8.7-.6 8.8-5.2.1-4.5-2.3-8-5.1-11.2-.8-.9-2-1.8-3.6-1.2-6.5 2.3-12.4 5.8-17.6 10.3zm-55.5 29.4c-4.6-.6-8.9-1.2-13.2-1.8-1.4 4-4.2 7-6.6 10.4 5.1.7 10 1.3 14.9 2 1.6-3.6 3.2-7 4.9-10.6zm33.9-12.6c5.6 4.4 11.5 4.8 14 1.1 2.8-4.2 1.6-8.8-3.2-11.7-4.4 2.6-8.8 5.4-10.8 10.6zm-39.4 25c-5.2-.7-10.3-1.4-15.6-2.2.4 1.5.7 2.8.9 4.1 5 .7 9.8 1.3 14.7 2v-3.9zm11.1-31.6c-.9 3.9.8 7.3 4.3 9.8 3 2.2 6.2 2.2 10.4.9-6.6-1.9-11.2-5.5-14.7-10.7zm6.5-31.5c1.9 1.2 3.6 2.3 6.2 3.8-1.4-3.8-1.8-7.1-2.3-10.5-1.4 4.4-1.4 4.4-3.9 6.7z"/>\n  <path d="M80.9 151.5c2.8 0 6.7.8 10.2 3 5.4 3.4 5.6 8.8.3 12.4-6.5 4.4-17.8 4.2-24.1-.4-4.5-3.3-4.5-8.1 0-11.4 3.1-2.4 7.3-3.6 13.6-3.6zM79.4 166c3.1 0 5.5-.6 7.4-1.8 3.4-2.1 3.6-5.4.5-7.6-4.1-3-11.6-2.9-15.7.1-2.8 2.1-2.8 5.2.1 7.2 2.4 1.5 5 2.1 7.7 2.1zm-25.7 2.1c-1.2-.1-2.7-.3-2.6-1.7 0-1.5 1.6-1.7 2.8-1.6 1.2 0 2.8.1 2.7 1.8-.2 1.5-1.7 1.4-2.9 1.5zm1.9-12.5c-1.5 0-2.9-.1-3-1.6 0-1.6 1.5-1.7 2.7-1.7 1.2 0 2.8.2 2.7 1.7.1 1.6-1.5 1.5-2.4 1.6zm11.4 22c-1.4 0-3 0-3-1.6 0-1.4 1.5-1.6 2.7-1.6 1.2 0 2.8 0 2.9 1.5.1 1.7-1.5 1.7-2.6 1.7z"/>\n</svg>\n'},83159:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n\t<circle cx="7.5" cy="2.5" r="1.5"/>\n\t<circle cx="7.5" cy="7.5" r="1.5"/>\n\t<circle cx="7.5" cy="12.5" r="1.5"/>\n</svg>\n'},24461:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20">\n  <path d="M11.14 2L9 6h8a7.68 7.68 0 0 0-5.86-4zm-.47 3l1-1.9A6.65 6.65 0 0 1 15 5z" stroke-opacity="0" />\n  <path d="M17.45 7H13l3.92 7a8.15 8.15 0 0 0 .52-7zm-.66 4.71L14.71 8h2a7.18 7.18 0 0 1 .06 3.71zM13.69 11L10 18h.08A7.37 7.37 0 0 0 16 15zm-1.91 5.77l2-3.71 1.06 1.83a6.38 6.38 0 0 1-3.07 1.88zM3 14a7.68 7.68 0 0 0 5.86 4L11 14zm5.32 2.9A6.66 6.66 0 0 1 5 15h4.33zM5.41 10.17L3.08 6a8.12 8.12 0 0 0-.52 7H7zM3.27 12a7.14 7.14 0 0 1-.06-3.71L5.29 12zM9.92 2A7.37 7.37 0 0 0 4 5l2.31 4L10 2zM6.27 6.93L5.21 5.1a6.38 6.38 0 0 1 3-1.88z" stroke-opacity="0" />\n</svg>\n'},69710:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 44 34">\n  <path d="M40.5 32.5H3.7c-1.1 0-2-.9-2-2v-23c0-1.1.9-2 2-2h36.8c1.1 0 2 .9 2 2v23c0 1.1-.9 2-2 2z" fill-opacity="0" />\n  <circle cx="20" cy="20" r="9.5" fill="none" stroke-width="1.1" />\n  <circle cx="20" cy="20" r="5.5" fill="none" stroke-width="1.1" />\n  <path d="M37.5 8.5h-4c-1.1 0-2 .9-2 2s.9 2 2 2h4c1.1 0 2-.9 2-2s-.9-2-2-2z" />\n  <circle cx="7" cy="10" r="1.5" />\n  <path d="M11 1h5c2 0 3 1 3 3v1H8V4c0-2 1-3 3-3z" />\n</svg>\n'},61065:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20">\n  <path d="M13.89 6.23l-2.79.93a4.16 4.16 0 0 1 0 5.22l3 1.18a6.94 6.94 0 0 0-.12-7.34z" fill-opacity="0" />\n  <path d="M15 13.94a7.93 7.93 0 0 0-.09-8L17.66 5l-.32-1-3.07 1-1 .34-3 1-1.23.41-4.11 1.41-1.25.42L1 9.46l2.53 1 1.16.46 4.39 1.76 1.16.46 3.15 1.26 1 .38L17.31 16l.37-.93zM4.5 9.76a3.2 3.2 0 0 1 0-.4l5.58-1.86a3.23 3.23 0 0 1 0 4.5zm6.56 2.62a4.16 4.16 0 0 0 0-5.22l2.79-.93a6.94 6.94 0 0 1 .15 7.34z" stroke-opacity="0" />\n</svg>\n'},9428:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20">\n  <path stroke-opacity="0" d="M18 5H2a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2zM4.29 13.12H3V6.9h1.29zm5.41-.4a2.78 2.78 0 0 1-1.86.56 3 3 0 0 1-1.93-.55 1.84 1.84 0 0 1-.7-1.53h1.23a1.26 1.26 0 0 0 .24.64 1.38 1.38 0 0 0 1.11.38 2.39 2.39 0 0 0 .76-.1.72.72 0 0 0 .56-.72.53.53 0 0 0-.27-.48 3 3 0 0 0-.84-.29l-.67-.15a4.19 4.19 0 0 1-1.4-.48 1.52 1.52 0 0 1-.63-1.34 1.79 1.79 0 0 1 .61-1.39 2.62 2.62 0 0 1 1.81-.55 2.77 2.77 0 0 1 1.7.52 1.85 1.85 0 0 1 .74 1.51H8.91a.89.89 0 0 0-.5-.8 1.72 1.72 0 0 0-.77-.16 1.47 1.47 0 0 0-.82.2.64.64 0 0 0-.31.57.53.53 0 0 0 .3.5 3.76 3.76 0 0 0 .83.26l1.09.26A2.77 2.77 0 0 1 9.8 10a1.52 1.52 0 0 1 .56 1.27 1.78 1.78 0 0 1-.66 1.45zm6.36-.15a2.71 2.71 0 0 1-2 .73 2.71 2.71 0 0 1-2-.73A3.36 3.36 0 0 1 11 10a3.29 3.29 0 0 1 1-2.57 2.71 2.71 0 0 1 2-.73 2.71 2.71 0 0 1 2 .73A3.3 3.3 0 0 1 17 10a3.36 3.36 0 0 1-.94 2.57z"/>\n  <path stroke-opacity="0" d="M14 7.81a1.5 1.5 0 0 0-1.23.57 2.52 2.52 0 0 0-.44 1.62 2.52 2.52 0 0 0 .46 1.62 1.5 1.5 0 0 0 1.23.57 1.48 1.48 0 0 0 1.23-.57A2.55 2.55 0 0 0 15.7 10a2.55 2.55 0 0 0-.45-1.62A1.48 1.48 0 0 0 14 7.81z"/>\n</svg>\n'},94220:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20">\n  <circle cx="10" cy="10" r="8" fill="none" stroke-width="1.1" />\n  <circle cx="10" cy="10" r="1.5" fill="none" />\n  <path d="M11.48 10.483l3.537 3.535-.955.955-3.535-3.536zM15.495 1.494l3.02 3.02-1.5 1.498-3.02-3.02z"/>\n</svg>\n'},30689:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n\t<g style="display: var(--displayImagesCached)">\n\t\t<path opacity="0.3" d="M23 8C23 6.89543 22.1046 6 21 6H6C4.89543 6 4 6.89543 4 8V18C4 19.1046 4.89543 20 6 20H21C22.1046 20 23 19.1046 23 18V8ZM12.4431 15.9167L16.5 10.5L21 18H6L9.5 12.4167L12.4431 15.9167Z"/>\n\t\t<path d="M18 23C20.7614 23 23 20.7614 23 18C23 15.2386 20.7614 13 18 13C15.2386 13 13 15.2386 13 18C13 20.7614 15.2386 23 18 23Z" fill="var(--colorWarningBg)" />\n\t\t<path d="M17 16H18V18H20V19H17V16Z" fill="var(--colorWarningFg)" />\n\t</g>\n\t<g style="display: var(--displayImagesAll)">\n\t\t<path d="M23 8C23 6.89543 22.1046 6 21 6H6C4.89543 6 4 6.89543 4 8V18C4 19.1046 4.89543 20 6 20H21C22.1046 20 23 19.1046 23 18V8ZM12.4431 15.9167L16.5 10.5L21 18H6L9.5 12.4167L12.4431 15.9167Z"/>\n\t</g>\n\t<g style="display: var(--displayImagesNever)">\n\t\t<path opacity="0.3" d="M23 8C23 6.89543 22.1046 6 21 6H6C4.89543 6 4 6.89543 4 8V18C4 19.1046 4.89543 20 6 20H21C22.1046 20 23 19.1046 23 18V8ZM12.4431 15.9167L16.5 10.5L21 18H6L9.5 12.5L12.4431 15.9167Z"/>\n\t\t<path d="M18 23C20.7614 23 23 20.7614 23 18C23 15.2386 20.7614 13 18 13C15.2386 13 13 15.2386 13 18C13 20.7614 15.2386 23 18 23Z" fill="var(--colorErrorBg)" />\n\t\t<path d="M21 17H15V19H21V17Z" fill="var(--colorErrorFg)" />\n\t</g>\n\t<g style="display: var(--displayAnimationNever)">\n\t\t<path d="M9 13C11.7614 13 14 10.7614 14 8C14 5.23858 11.7614 3 9 3C6.23858 3 4 5.23858 4 8C4 10.7614 6.23858 13 9 13Z" fill="var(--colorErrorBg)" />\n\t\t<g>\n\t\t\t<path d="M6.5 5.5H8.375V10.5H6.5V5.5Z" fill="var(--colorErrorFg)" />\n\t\t\t<path d="M9.625 5.5H11.5V10.5H9.625V5.5Z" fill="var(--colorErrorFg)" />\n\t\t</g>\n\t</g>\n\t<g style="display: var(--displayAnimationOnce)">\n\t\t<path d="M9 13C11.7614 13 14 10.7614 14 8C14 5.23858 11.7614 3 9 3C6.23858 3 4 5.23858 4 8C4 10.7614 6.23858 13 9 13Z" fill="var(--colorWarningBg)"/>\n\t\t<path d="M7.75 4.25V11.75L11.5 8L7.75 4.25Z" fill="var(--colorWarningFg)" />\n\t</g>\n</svg>\n'},78823:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <g style="display: var(--displayImagesAll)">\n    <path d="M16 4C16 2.89543 15.1046 2 14 2H2C0.895431 2 0 2.89543 0 4V12C0 13.1046 0.895431 14 2 14H14C15.1046 14 16 13.1046 16 12V4ZM4.89 7.5L7.11 10.5L10.223 6L14.223 12H1.778L4.888 7.5H4.89Z"/>\n  </g>\n  <g style="display: var(--displayImagesCached)">\n    <path opacity="0.3" d="M16 4C16 2.89543 15.1046 2 14 2H2C0.895431 2 0 2.89543 0 4V12C0 13.1046 0.895431 14 2 14H14C15.1046 14 16 13.1046 16 12V4ZM4.89 7.5L7.11 10.5L10.223 6L14.223 12H1.778L4.888 7.5H4.89Z"/>\n    <path d="M12 16C14.2091 16 16 14.2091 16 12C16 9.79086 14.2091 8 12 8C9.79086 8 8 9.79086 8 12C8 14.2091 9.79086 16 12 16Z" fill="var(--colorWarningBg)" />\n    <path d="M11 10H12V12H14V13H11V10Z" fill="var(--colorWarningFg)"/>\n  </g>\n  <g style="display: var(--displayImagesNever)">\n    <path opacity="0.3" d="M16 4C16 2.89543 15.1046 2 14 2H2C0.895431 2 0 2.89543 0 4V12C0 13.1046 0.895431 14 2 14H14C15.1046 14 16 13.1046 16 12V4ZM4.89 7.5L7.11 10.5L10.223 6L14.223 12H1.778L4.888 7.5H4.89Z"/>\n    <path d="M12 16C14.2091 16 16 14.2091 16 12C16 9.79086 14.2091 8 12 8C9.79086 8 8 9.79086 8 12C8 14.2091 9.79086 16 12 16Z" fill="var(--colorErrorBg)"/>\n    <path d="M14 11H10V13H14V11Z" fill="var(--colorErrorFg)"/>\n  </g>\n  <g style="display: var(--displayAnimationNever)">\n    <path d="M4 8C6.20914 8 8 6.20914 8 4C8 1.79086 6.20914 0 4 0C1.79086 0 0 1.79086 0 4C0 6.20914 1.79086 8 4 8Z" fill="var(--colorErrorBg)"/>\n    <path d="M2 2H3.5V6H2V2Z" fill="var(--colorErrorFg)"/>\n    <path d="M4.5 2H6V6H4.5V2Z" fill="var(--colorErrorFg)"/>\n  </g>\n  <g style="display: var(--displayAnimationOnce)">\n    <circle fill="var(--colorWarningBg)" cx="4" cy="4" r="4"/>\n    <polygon fill="var(--colorWarningFg)" points="3 1 3 7 6 4" />\n  </g>\n</svg>\n'},39293:e=>{e.exports='<svg width="26" height="26" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M13 20a7 7 0 1 0 0-14 7 7 0 0 0 0 14zm0-11a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm0 3a1 1 0 0 0-1 1v3a1 1 0 1 0 2 0v-3a1 1 0 0 0-1-1z"/>\n</svg>\n'},28676:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zM8 4a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm0 3a1 1 0 0 0-1 1v3a1 1 0 1 0 2 0V8a1 1 0 0 0-1-1z"/>\n</svg>\n'},39567:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M7 8a1 1 0 0 1 2 0v3a1 1 0 1 1-2 0V8zm1-2a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/>\n  <path fill-rule="evenodd" d="M15 8A7 7 0 1 1 1 8a7 7 0 0 1 14 0zm-1 0A6 6 0 1 1 2 8a6 6 0 0 1 12 0z"/>\n</svg>\n'},37032:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M0 4C0 3.44772 0.447715 3 1 3H15C15.5523 3 16 3.44772 16 4V11C16 11.5523 15.5523 12 15 12H1C0.447715 12 0 11.5523 0 11V4ZM1 8H3V10H1V8ZM3 5H1V7H3V5ZM4 5H6V7H4V5ZM9 5H7V7H9V5ZM10 5H12V7H10V5ZM15 5H13V7H15V5ZM13 8H15V10H13V8ZM12 8H4V10H12V8Z"/>\n</svg>\n'},43448:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n\t<path d="M12.004 5.146A.5.5 0 0011.65 5H5v6.65a.5.5 0 00.146.354l7.583 7.582a2 2 0 002.828 0l4.029-4.029a2 2 0 000-2.828l-7.582-7.583zM9.49 11.171a1.691 1.691 0 11-.023-3.381 1.691 1.691 0 01.023 3.381z"/>\n</svg>\n'},51008:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n\t<path d="M7.146 1.146A.5.5 0 006.793 1H1v5.793a.5.5 0 00.146.353l7.147 7.147a1 1 0 001.414 0l4.586-4.586a1 1 0 000-1.414L7.146 1.146zM4.93 6.4a1.48 1.48 0 11-.02-2.96 1.48 1.48 0 01.02 2.96z"/>\n</svg>\n'},46038:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M4 3h3.586l5 5L8 12.586l-5-5V4a1 1 0 011-1zm3.586-1a1 1 0 01.707.293L14 8l-6 6-5.707-5.707A1 1 0 012 7.586V4a2 2 0 012-2h3.586zM7 6a1 1 0 11-2 0 1 1 0 012 0zm1 0a2 2 0 11-4 0 2 2 0 014 0z"/>\n</svg>\n'},36186:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M5.5 14l2.5-3 2.5 3h-5zM10.5 1l-2.5 3-2.5-3h5zM2 5h12v1h-12zM2 7h12v1h-12zM2 9h12v1h-12z"/></svg>'},79026:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M5 3l2.5-3 2.5 3h-5zM10 12l-2.5 3-2.5-3h5zM2 4h11v1h-11zM2 7h11v1h-11zM2 10h11v1h-11z"/></svg>'},34167:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M8.01009 13.0077L4.9503 7.76232C3.62689 5.09401 5.39275 2.5 8.01009 2.5C10.6274 2.5 12.3933 5.09401 11.0699 7.76232L8.01009 13.0077ZM8.01009 1.5C4.63204 1.5 2.39952 4.89687 4.06288 8.22361L4.07009 8.23802L4.0782 8.25194L7.14631 13.5116C7.53219 14.1731 8.48799 14.1731 8.87387 13.5116L11.942 8.25194L11.9501 8.23802L11.9573 8.22361C13.6207 4.89686 11.3881 1.5 8.01009 1.5ZM9.0101 6C9.0101 6.55228 8.56239 7 8.0101 7C7.45782 7 7.0101 6.55228 7.0101 6C7.0101 5.44772 7.45782 5 8.0101 5C8.56239 5 9.0101 5.44772 9.0101 6ZM10.0101 6C10.0101 7.10457 9.11467 8 8.0101 8C6.90553 8 6.0101 7.10457 6.0101 6C6.0101 4.89543 6.90553 4 8.0101 4C9.11467 4 10.0101 4.89543 10.0101 6Z"/>\n</svg>\n'},62469:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12">\n\n  <circle cx="6" cy="6" />\n\n  <g class="window-close-glyph dpi-standard">\n    <path fill="#93120F" d="M8 7v-2h1v-2h-2v1h-2v-1h-2v2h1v2h-1v2h2v-1h2v1h2v-2h-1z" />\n    <path fill="#7E0200" d="M5 5h2v2h-2v-2zm-1-1h1v1h-1v-1zm-1-1h1v1h-1v-1zm5 0h1v1h-1v-1zm-1 1h1v1h-1v-1zm-3 3h1v1h-1v-1zm-1 1h1v1h-1v-1zm4-1h1v1h-1v-1zm1 1h1v1h-1v-1z" />\n  </g>\n  <g class="window-close-glyph dpi-high">\n    <polygon fill="#4c0102" points="9 3 8.29 3 6 5.29 3.71 3 3 3 3 3.71 5.29 6 3 8.29 3 9 3.71 9 6 6.71 8.29 9 9 9 9 8.29 6.71 6 9 3.71 9 3" />\n  </g>\n\n</svg>\n'},3141:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12">\n\n  <circle cx="6" cy="6" />\n\n  <g class="window-zoom-glyph dpi-standard">\n    <polygon points="9 5 7 5 7 3 5 3 5 5 3 5 3 7 5 7 5 9 7 9 7 7 9 7 9 5" fill="#0a630c"/>\n    <rect x="5" y="2" width="2" height="1" fill="#157e1b" class="semi"/>\n    <rect x="5" y="9" width="2" height="1" fill="#157e1b" class="semi"/>\n    <rect x="9" y="5" width="1" height="2" fill="#157e1b" class="semi"/>\n    <rect x="2" y="5" width="1" height="2" fill="#157e1b" class="semi"/>\n  </g>\n  <g class="window-zoom-glyph dpi-high">\n    <polygon points="9.5 5.5 6.5 5.5 6.5 2.5 5.5 2.5 5.5 5.5 2.5 5.5 2.5 6.5 5.5 6.5 5.5 9.5 6.5 9.5 6.5 6.5 9.5 6.5 9.5 5.5" fill="#0a630c"/>\n    <rect x="5.5" y="2" width="1" height="0.5" fill="#1b8e25" class="semi"/>\n    <rect x="5.5" y="9.5" width="1" height="0.5" fill="#1b8e25" class="semi"/>\n    <rect x="9.5" y="5.5" width="0.5" height="1" fill="#1b8e25" class="semi"/>\n    <rect x="2" y="5.5" width="0.5" height="1" fill="#1b8e25" class="semi"/>\n  </g>\n\n  <g class="window-fullscreen-glyph dpi-standard">\n    <polygon points="9 7.6 4.4 3 8.38 3.1 8.9 3.63" fill="#0a630c"/>\n    <polygon points="3 4.5 7.5 9 3.63 8.9 3.1 8.38" fill="#0a630c"/>\n  </g>\n  <g class="window-fullscreen-glyph dpi-high">\n    <polygon points="3 4.5 7.5 9 3.63 9 3 8.38 3 4.5" fill="#0a630c"/>\n    <polygon points="9 7.5 4.5 3 8.38 3 9 3.63 9 7.5" fill="#0a630c"/>\n  </g>\n\n  <g class="window-restore-glyph dpi-standard">\n    <polygon points="6 10 2 6 6 6 6 10" fill="#0a630c"/>\n    <polygon points="6 2 10 6 6 6 6 2" fill="#0a630c"/>\n  </g>\n  <g class="window-restore-glyph dpi-high">\n    <polygon points="6 1.5 10.5 6 6.50 6 6 5.50 6 1.5" fill="#0a630c"/>\n    <polygon points="6 10.5 1.5 6 5.50 6 6 6.50 6 10.5" fill="#0a630c"/>\n  </g>\n</svg>\n'},91313:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12">\n\n  <circle cx="6" cy="6" />\n\n  <g class="window-minimize-glyph dpi-standard">\n    <rect x="3" y="5" width="6" height="2" fill="#965612"/>\n    <rect x="9" y="5" width="1" height="2" fill="#ab6e1c" class="semi" />\n    <rect x="2" y="5" width="1" height="2" fill="#ab6e1c" class="semi"/>\n  </g>\n  <g class="window-minimize-glyph dpi-high">\n    <rect x="2.5" y="5.5" width="7" height="1" fill="#965612"/>\n    <rect x="2" y="5.5" width="0.5" height="1" fill="#ab6e1c" class="semi"/>\n    <rect x="9.5" y="5.5" width="0.5" height="1" fill="#ab6e1c" class="semi"/>\n  </g>\n\n</svg>\n'},49244:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M3 3a2 2 0 0 0-2 2v1h14V5a2 2 0 0 0-2-2H3z"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M14 12.5V7H2v5.5A1.5 1.5 0 0 0 3.5 14h9a1.5 1.5 0 0 0 1.5-1.5zM6.5 8h3a1 1 0 1 1 0 2h-3a1 1 0 0 1 0-2z"/>\n</svg>\n'},83:e=>{e.exports='<svg class="onboarding-illustration" fill="none" xmlns="http://www.w3.org/2000/svg" width="242" height="195">\n  <path opacity=".5" fill-rule="evenodd" clip-rule="evenodd" d="M28.88 71.14a34.2 34.2 0 005.32 67.98h.07a58.8 58.8 0 00101.55 37.37 34.18 34.18 0 0053.24-8 31.7 31.7 0 0031.75-54.11 40.46 40.46 0 00-29.75-59.96A60.07 60.07 0 0078.44 36.44a42.13 42.13 0 00-49.55 34.69z" class="highlight-fill" fill-opacity=".25"/>\n  <path d="M130.5 111v50.5m0 0H173a8 8 0 008-8V145m-50.5 16.5H99" class="highlight-stroke" stroke-width="3"/>\n  <mask id="path-3-inside-1" class="bg-fill">\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M94.33 178.47h.03a16.64 16.64 0 005.76-32.25 16.64 16.64 0 00-27-11.5 16.65 16.65 0 00-32.42.06 15.83 15.83 0 00-17.06 10.4 16.64 16.64 0 000 33.3h70.69z"/>\n  </mask>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M94.33 178.47h.03a16.64 16.64 0 005.76-32.25 16.64 16.64 0 00-27-11.5 16.65 16.65 0 00-32.42.06 15.83 15.83 0 00-17.06 10.4 16.64 16.64 0 000 33.3h70.69z" class="bg-fill"/>\n  <path d="M94.33 178.47v-3 3zm5.79-32.25l-2.99.26.17 1.9 1.78.65 1.04-2.81zm-27-11.5l-2.92.68 1.09 4.64 3.71-2.98-1.88-2.34zm-32.42.06l-.72 2.91 2.96.75.69-2.98-2.93-.68zM23.95 145.2l-.06 3 2.47.05.52-2.41-2.93-.64zm-.28 33.28v-3 3zm70.66 3h.03v-6h-.02l-.01 6zm.03 0c10.85 0 19.64-8.8 19.64-19.64h-6c0 7.53-6.1 13.64-13.64 13.64v6zM114 161.83c0-8.46-5.35-15.66-12.84-18.43l-2.08 5.63a13.65 13.65 0 018.92 12.8h6zm-10.9-15.88a19.64 19.64 0 00-19.56-17.9v6c7.13 0 12.98 5.46 13.6 12.43l5.97-.53zm-19.56-17.9c-4.65 0-8.93 1.62-12.3 4.33l3.76 4.68c2.34-1.89 5.3-3.01 8.54-3.01v-6zm-7.5 5.98a19.65 19.65 0 00-19.12-15.13v6c6.45 0 11.86 4.48 13.28 10.5l5.84-1.37zM56.92 118.9c-9.33 0-17.13 6.5-19.14 15.21l5.85 1.35a13.65 13.65 0 0113.29-10.56v-6zm-15.49 12.97c-1.3-.32-2.66-.5-4.06-.5v6c.9 0 1.78.12 2.6.32l1.46-5.82zm-4.06-.5a16.73 16.73 0 00-16.35 13.2l5.86 1.26a10.73 10.73 0 0110.49-8.45v-6zM24 142.2h-.36v6h.25l.11-6zm-.36 0A19.64 19.64 0 004 161.83h6c0-7.53 6.1-13.64 13.64-13.64v-6zM4 161.83c0 10.85 8.8 19.64 19.64 19.64v-6c-7.53 0-13.64-6.1-13.64-13.64H4zm19.64 19.64h.03v-6h-.03v6zm70.7-6H23.66v6h70.66v-6z" class="highlight-fill" mask="url(#path-3-inside-1)"/>\n  <mask id="path-5-inside-2" class="bg-fill">\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M227.92 148.22a13.89 13.89 0 004.8-26.92 13.9 13.9 0 00-22.53-9.6 13.9 13.9 0 00-27.06.06 11.46 11.46 0 00-13.98 8.69h-.26a13.89 13.89 0 000 27.77h59.03z"/>\n  </mask>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M227.92 148.22a13.89 13.89 0 004.8-26.92 13.9 13.9 0 00-22.53-9.6 13.9 13.9 0 00-27.06.06 11.46 11.46 0 00-13.98 8.69h-.26a13.89 13.89 0 000 27.77h59.03z" class="bg-fill"/>\n  <path d="M227.92 148.22v-3h-3v3h3zm4.8-26.92l-2.98.26.16 1.9 1.79.66 1.04-2.82zm-22.53-9.6l-2.92.69 1.09 4.64 3.71-2.99-1.88-2.34zm-27.06.06l-.72 2.9 2.96.75.69-2.98-2.93-.67zm-13.98 8.69l-.06 3 2.47.04.52-2.41-2.93-.63zm-.26 27.77h3v-3h-3v3zm0 0h-3v3h3v-3zm59.03 0v3h3v-3h-3zm0 3v-6 6zm0 0c9.33 0 16.89-7.56 16.89-16.88h-6c0 6-4.88 10.88-10.9 10.88v6zm16.89-16.88a16.9 16.9 0 00-11.04-15.85l-2.08 5.63a10.9 10.9 0 017.12 10.22h6zm-9.1-13.3c-.75-8.63-8-15.4-16.82-15.4v6c5.69 0 10.36 4.36 10.85 9.92l5.98-.52zm-16.82-15.4c-4 0-7.69 1.4-10.58 3.72l3.76 4.68c1.87-1.5 4.24-2.4 6.82-2.4v-6zm-5.78 5.38A16.9 16.9 0 00196.67 98v6a10.9 10.9 0 0110.6 8.39l5.84-1.37zM196.67 98a16.9 16.9 0 00-16.46 13.08l5.85 1.35a10.9 10.9 0 0110.6-8.43v-6zm-12.81 10.85c-1.13-.28-2.3-.43-3.51-.43v6c.71 0 1.4.08 2.06.25l1.45-5.82zm-3.51-.43a14.46 14.46 0 00-14.14 11.4l5.87 1.26a8.46 8.46 0 018.27-6.66v-6zm-11.15 9.03h-.31v6h.2l.11-6zm-.31 0A16.89 16.89 0 00152 134.33h6c0-6.02 4.88-10.9 10.89-10.9v-6zM152 134.33c0 9.32 7.56 16.88 16.89 16.88v-6A10.89 10.89 0 01158 134.34h-6zm19.89 13.88h-6 6zm56.03-3h-59.03v6h59.03v-6zm-3 3h6-6z" class="highlight-fill" mask="url(#path-5-inside-2)"/>\n  <path d="M126 105h9v11.5a4.5 4.5 0 01-9 0V105z" class="bg-fill highlight-stroke" stroke-width="2"/>\n  <path d="M107.27 31.25l-9.02 9.02-5-5a4 4 0 010-5.66l3.36-3.37a4 4 0 015.66 0l5 5.01z" class="bg-fill highlight-stroke" stroke-width="2"/>\n  <path d="M156.41 31.25l9.03 9.02 5-5a4 4 0 000-5.66l-3.36-3.37a4 4 0 00-5.66 0l-5 5.01z" class="bg-fill highlight-stroke" stroke-width="2"/>\n  <circle cx="131.66" cy="64.66" r="45.72" class="bg-fill"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M99.03 32.63a45.72 45.72 0 00.6 64.66l32.03-32.03 32.03 32.03.3-.3a45.72 45.72 0 00.3-64.36l-32.63 32.63-32.63-32.63z" class="highlight-fill"/>\n  <circle cx="131.66" cy="64.66" r="45.72" class="highlight-stroke" stroke-width="4"/>\n  <path class="highlight-stroke" d="M99.26 97.21l64.95-64.95"/>\n  <path class="highlight-stroke" d="M164.06 97.2L99.11 32.27"/>\n  <circle cx="131.66" cy="64.66" r="17.52" class="highlight-stroke bg-fill" stroke-width="2"/>\n</svg>\n'},68914:e=>{e.exports='<svg class="onboarding-illustration" fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 144 81">\n  <rect x="46" y="35" width="46" height="46" rx="5" class="success"/>\n  <path d="M65 68.83L54.17 58 57 55.17l8 8 16-16L83.83 50 65 68.83z" fill="white"/>\n  <path opacity=".2" fill-rule="evenodd" clip-rule="evenodd" d="M68 17a1 1 0 01-1-1V1a1 1 0 112 0v15a1 1 0 01-1 1zm33.28 5.8a1 1 0 010-1.41l10.6-10.6a1 1 0 111.42 1.4L102.7 22.8a1 1 0 01-1.42 0zM36.73 21.4a1 1 0 01-1.42 1.41l-10.6-10.6a1 1 0 011.41-1.42l10.6 10.6zM114 57a1 1 0 011-1h28a1 1 0 010 2h-28a1 1 0 01-1-1zM1 56a1 1 0 100 2h28a1 1 0 100-2H1z" class="success"/>\n</svg>\n'},89182:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72">\n  <path fill-opacity=".3" fill-rule="evenodd" d="M66.27 66.27C60.55 72 51.77 72 36 72c-15.78 0-24.55 0-30.27-5.73C0 60.54 0 51.77 0 36S0 11.46 5.73 5.73C11.45 0 20.23 0 36 0c15.78 0 24.55 0 30.27 5.73C72 11.46 72 20.23 72 36s0 24.54-5.73 30.27zm-7.6-13.73H13.19a3.8 3.8 0 01-3.79-3.79V27.57l26.22 14.9 26.84-15.41v21.7a3.8 3.8 0 01-3.8 3.78zM13.19 19.07a3.8 3.8 0 00-3.66 2.82L35.61 36.7l26.57-15.26a3.8 3.8 0 00-3.51-2.38H13.19z"/>\n  <path fill-rule="evenodd" d="M8.4 25.85l27.22 15.47 27.84-16v23.43a4.8 4.8 0 01-4.8 4.8H13.2a4.8 4.8 0 01-4.79-4.8v-22.9zm27.22 16.62L9.4 27.57v21.18a3.8 3.8 0 003.8 3.8h45.47a3.8 3.8 0 003.79-3.8v-21.7L35.62 42.48zM8.37 22.37l.2-.74a4.8 4.8 0 014.62-3.56h45.48a4.8 4.8 0 014.44 3l.33.81L35.6 37.87 8.37 22.37zM54.76 70.3c4.76-.7 8.15-2.07 10.8-4.73 2.66-2.65 4.04-6.04 4.73-10.8.7-4.8.71-10.84.71-18.76 0-7.92 0-13.97-.7-18.76-.7-4.76-2.08-8.15-4.73-10.8C62.9 3.78 59.52 2.4 54.76 1.7 49.96 1 43.92 1 36 1c-7.92 0-13.97 0-18.76.7-4.76.7-8.15 2.08-10.8 4.74-2.66 2.65-4.04 6.04-4.73 10.8C1 22.04 1 28.08 1 36c0 7.92 0 13.97.7 18.76.7 4.76 2.08 8.15 4.73 10.8 2.66 2.66 6.05 4.04 10.81 4.73 4.8.7 10.84.71 18.76.71 7.92 0 13.97 0 18.76-.7zM35.61 36.71L9.53 21.9a3.8 3.8 0 013.66-2.82h45.48a3.8 3.8 0 013.51 2.38L35.61 36.7zM36 72c15.78 0 24.55 0 30.27-5.73C72 60.54 72 51.77 72 36s0-24.54-5.73-30.27C60.55 0 51.77 0 36 0 20.22 0 11.45 0 5.73 5.73 0 11.46 0 20.23 0 36s0 24.54 5.73 30.27C11.45 72 20.23 72 36 72z"/>\n</svg>\n'},29622:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M2.35717 3.36075C2.13323 3.58693 2.00515 3.89221 2 4.21203V11.7872C1.99441 11.9479 2.02163 12.1081 2.07996 12.2577C2.13828 12.4073 2.22648 12.5431 2.33904 12.6568C2.4516 12.7705 2.58613 12.8596 2.73425 12.9185C2.88237 12.9774 3.04091 13.0049 3.2 12.9993H12.8C13.1167 12.9941 13.4189 12.8647 13.6428 12.6385C13.8668 12.4123 13.9948 12.1071 14 11.7872L14 6C14 5.5 13.5 5 13 5H8L6.8 3H3.2C2.88334 3.0052 2.5811 3.13457 2.35717 3.36075Z"/>\n</svg>\n'},52529:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.29386 0.706223C7.68439 0.315699 8.31561 0.315699 8.70614 0.706223L13.4161 5.4162C13.7912 5.79127 14 6.29808 14 6.82851V12.0001C14 12.2653 13.8946 12.5197 13.7071 12.7072C13.5196 12.8947 13.2652 13.0001 13 13.0001H3C2.73478 13.0001 2.48043 12.8947 2.29289 12.7072C2.10536 12.5197 2 12.2653 2 12.0001V6.82851C2 6.29808 2.20882 5.79127 2.58389 5.4162L7.29386 0.706223ZM4.56066 4.85364L8 1.4143L11.4393 4.85364L8.35355 7.93943C8.15829 8.13469 7.84171 8.13469 7.64645 7.93943L4.56066 4.85364ZM3.85355 5.56075L3.291 6.1233C3.10447 6.30983 3 6.56187 3 6.82851L3 12.0001H13V6.82851C13 6.56187 12.8955 6.30983 12.709 6.12331L12.1464 5.56075L9.06066 8.64653C8.47487 9.23232 7.52513 9.23232 6.93934 8.64653L3.85355 5.56075Z"/>\n</svg>\n'},90205:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M4 1C2.89543 1 2 1.89543 2 3V12C2 13.1046 2.89543 14 4 14H13C14.1046 14 15 13.1046 15 12V3C15 1.89543 14.1046 1 13 1H4ZM11.2774 8.9856C11.6015 9.7681 11.7968 10.5966 11.857 11.439C11.8791 11.7483 12.1284 12 12.4385 12C12.7486 12 13.0018 11.7484 12.9825 11.4389C12.9733 11.2922 12.9606 11.1459 12.9443 11C12.8505 10.1614 12.6391 9.33849 12.3149 8.55585C11.8626 7.46392 11.1997 6.47177 10.364 5.63604C9.52823 4.80031 8.53608 4.13738 7.44415 3.68508C6.66151 3.3609 5.83859 3.14949 5 3.05573C4.85414 3.03942 4.70781 3.02667 4.56114 3.01751C4.25163 2.99817 4 3.25139 4 3.5615C4 3.87161 4.25171 4.12092 4.56103 4.14301C5.40342 4.20316 6.2319 4.39848 7.0144 4.7226C7.97008 5.11846 8.83843 5.69867 9.56988 6.43012C10.3013 7.16157 10.8815 8.02992 11.2774 8.9856ZM9.43123 12C9.11711 12 8.86589 11.7445 8.82923 11.4325C8.7771 10.9889 8.66397 10.5536 8.49233 10.1392C8.24797 9.54928 7.8898 9.01324 7.43828 8.56172C6.98676 8.1102 6.45073 7.75203 5.86078 7.50767C5.44641 7.33603 5.01114 7.2229 4.56748 7.17077C4.2555 7.13411 4 6.88289 4 6.56877C4 6.25465 4.25521 5.9972 4.56792 6.02694C4.71267 6.0407 4.85679 6.05971 5 6.08392C5.44363 6.15891 5.87847 6.28373 6.2961 6.45672C7.02405 6.75825 7.68549 7.20021 8.24264 7.75736C8.79979 8.31451 9.24175 8.97595 9.54328 9.7039C9.71627 10.1215 9.84109 10.5564 9.91608 11C9.94029 11.1432 9.9593 11.2873 9.97306 11.4321C10.0028 11.7448 9.74535 12 9.43123 12ZM5.25 12C5.94036 12 6.5 11.4404 6.5 10.75C6.5 10.0596 5.94036 9.5 5.25 9.5C4.55964 9.5 4 10.0596 4 10.75C4 11.4404 4.55964 12 5.25 12Z"/>\n</svg>\n'},53165:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M2.35715 3.36075C2.13321 3.58693 2.00513 3.89221 1.99998 4.21203V11.7872C1.9944 11.9479 2.02161 12.1081 2.07994 12.2577C2.13827 12.4073 2.22646 12.5431 2.33902 12.6568C2.45159 12.7705 2.58612 12.8596 2.73423 12.9185C2.88235 12.9774 3.04089 13.0049 3.19998 12.9993H12.8C13.1166 12.9941 13.4189 12.8647 13.6428 12.6385C13.8668 12.4123 13.9948 12.1071 14 11.7872L14 6C14 5.5 13.5 5 13 5H7.99998L6.79998 3H3.19998C2.88333 3.0052 2.58109 3.13457 2.35715 3.36075ZM2.99938 11.822L2.99998 11.8046V4.22318C3.00221 4.16171 3.02739 4.10511 3.06778 4.06432C3.10771 4.02398 3.15927 4.00208 3.2116 4H6.24588L7.49998 6H12.8C12.9104 6 13 6.08796 13 6.19842C13 7.13107 13 11.0636 13 11.7761C12.9978 11.8376 12.9726 11.8942 12.9322 11.935C12.8922 11.9753 12.8407 11.9972 12.7884 11.9993H3.18225L3.16453 11.9999C3.14404 12.0006 3.12342 11.9971 3.10382 11.9893C3.08419 11.9815 3.06565 11.9694 3.04965 11.9533C3.03362 11.9371 3.02049 11.9171 3.01163 11.8944C3.00276 11.8717 2.99851 11.847 2.99938 11.822Z"/>\n</svg>\n'},17737:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M10 2.5C10 2.77614 10.2239 3 10.5 3H12C12.5523 3 13 3.44772 13 4H3C3 3.44772 3.44772 3 4 3H5.5C5.77614 3 6 2.77614 6 2.5C6 2.22386 6.22386 2 6.5 2H9.5C9.77614 2 10 2.22386 10 2.5Z"/>\n  <path d="M4 5H12V12.5C12 13.3284 11.3284 14 10.5 14H5.5C4.67157 14 4 13.3284 4 12.5V5Z"/>\n</svg>\n'},8431:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M10.5 3a.5.5 0 0 1-.5-.5.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5.5.5 0 0 1-.5.5H4a1 1 0 0 0-1 1h10a1 1 0 0 0-1-1h-1.5ZM4 5v7.5A1.5 1.5 0 0 0 5.5 14h5a1.5 1.5 0 0 0 1.5-1.5V5h-1v7.5a.5.5 0 0 1-.5.5h-5a.5.5 0 0 1-.5-.5V5H4Z"/>\n  <path opacity=".3" d="M6 5v7h4V5H6Z"/>\n</svg>\n'},76047:e=>{e.exports='<svg width="26" height="26" xmlns="http://www.w3.org/2000/svg">\n  <path d="M4.5 6a.5.5 0 00-.5.5v1a.5.5 0 00.5.5h17a.5.5 0 00.5-.5v-1a.5.5 0 00-.5-.5h-17zm2 4a.5.5 0 00-.5.5v1a.5.5 0 00.5.5h13a.5.5 0 00.5-.5v-1a.5.5 0 00-.5-.5h-13zM8 14.5a.5.5 0 01.5-.5h9a.5.5 0 01.5.5v1a.5.5 0 01-.5.5h-9a.5.5 0 01-.5-.5v-1zm2.5 3.5a.5.5 0 00-.5.5v1a.5.5 0 00.5.5h5a.5.5 0 00.5-.5v-1a.5.5 0 00-.5-.5h-5z"/>\n</svg>'},94543:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M1 3.5a.5.5 0 01.5-.5h13a.5.5 0 01.5.5v1a.5.5 0 01-.5.5h-13a.5.5 0 01-.5-.5v-1zm2 4a.5.5 0 01.5-.5h9a.5.5 0 01.5.5v1a.5.5 0 01-.5.5h-9a.5.5 0 01-.5-.5v-1zM5.5 11a.5.5 0 00-.5.5v1a.5.5 0 00.5.5h5a.5.5 0 00.5-.5v-1a.5.5 0 00-.5-.5h-5z"/>\n</svg>'},89316:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M2 4.5a.5.5 0 01.5-.5h11a.5.5 0 010 1h-11a.5.5 0 01-.5-.5zm2 3a.5.5 0 01.5-.5h7a.5.5 0 010 1h-7a.5.5 0 01-.5-.5zM6.5 10a.5.5 0 000 1h3a.5.5 0 000-1h-3z"/>\n</svg>'},83318:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><g fill-rule="evenodd"><path d="m6.64645 7.64645c.19526-.19527.51184-.19527.7071 0l5.29285 5.29285c.1953.1953.5119.1953.7072 0l5.2928-5.29285c.1953-.19527.5119-.19527.7072 0 .1952.19526.1952.51184 0 .7071l-5.2929 5.29285c-.5858.5858-1.5356.5858-2.1214 0l-5.29285-5.29285c-.19527-.19526-.19527-.51184 0-.7071z"/><path d="m19 9h-12v7h12zm-12-2c-1.10457 0-2 .89543-2 2v7c0 1.1046.89543 2 2 2h12c1.1046 0 2-.8954 2-2v-7c0-1.10457-.8954-2-2-2z"/></g></svg>'},71387:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M0 3.5C0 3.22386 0.223858 3 0.5 3H8.5C8.77614 3 9 3.22386 9 3.5C9 3.77614 8.77614 4 8.5 4H0.5C0.223858 4 0 3.77614 0 3.5ZM0 5.5C0 5.22386 0.223858 5 0.5 5H2.5C2.77614 5 3 5.22386 3 5.5C3 5.77614 2.77614 6 2.5 6H0.5C0.223858 6 0 5.77614 0 5.5ZM3 7.5C3 7.22386 2.77614 7 2.5 7H0.5C0.223858 7 0 7.22386 0 7.5C0 7.77614 0.223858 8 0.5 8H2.5C2.77614 8 3 7.77614 3 7.5Z"/>\n  <path fill-rule="evenodd" d="M4.45459 5.16169L9.64645 10.3536L10 10.7071L10.3536 10.3536L15.5454 5.16169C15.8191 5.34012 16 5.64893 16 6V12C16 12.5523 15.5523 13 15 13H5C4.44772 13 4 12.5523 4 12V6C4 5.64893 4.18091 5.34012 4.45459 5.16169ZM5.70711 5H14.2929L10 9.29289L5.70711 5Z"/>\n</svg>\n'},25259:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path d="m3 7h9v1h-9zm0 2h4v1h-4zm0 2h4v1h-4z"/>\n  <path d="m8 11c0-1.10457.89543-2 2-2h12c1.1046 0 2 .89543 2 2v6c0 1.1046-.8954 2-2 2h-12c-1.10457 0-2-.8954-2-2zm11.2929 0h-6.5858l3.2929 3.2929zm-8 0h-1.2929v6h12v-6h-1.2929l-4.7071 4.7071z" fill-rule="evenodd"/>\n  </svg>'},71311:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="m9 3.5c0-.27614-.22386-.5-.5-.5h-8c-.276142 0-.5.22386-.5.5s.223858.5.5.5h8c.27614 0 .5-.22386.5-.5z"/><path d="m5 5c-.55228 0-1 .44772-1 1v6c0 .5523.44771 1 1 1h10c.5523 0 1-.4477 1-1v-6c0-.55228-.4477-1-1-1zm5 4.29289-3.29289-3.29289h6.58579zm-5-3.29289h.29289l4.70711 4.7071 4.7071-4.7071h.2929v6h-10z"/><path d="m0 5.5c0-.27614.223858-.5.5-.5h2c.27614 0 .5.22386.5.5s-.22386.5-.5.5h-2c-.276142 0-.5-.22386-.5-.5z"/><path d="m3 7.5c0-.27614-.22386-.5-.5-.5h-2c-.276142 0-.5.22386-.5.5s.223858.5.5.5h2c.27614 0 .5-.22386.5-.5z"/></svg>'},54255:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M1.64645 2.64645C1.84171 2.45118 2.15829 2.45118 2.35355 2.64645L7.64645 7.93934C7.84171 8.1346 8.15829 8.1346 8.35355 7.93934L13.6464 2.64645C13.8417 2.45118 14.1583 2.45118 14.3536 2.64645C14.5488 2.84171 14.5488 3.15829 14.3536 3.35355L9.06066 8.64645C8.47487 9.23223 7.52513 9.23223 6.93934 8.64645L1.64645 3.35355C1.45118 3.15829 1.45118 2.84171 1.64645 2.64645Z"/>\n  <path fill-rule="evenodd" d="M14 4H2V11H14V4ZM2 2C0.895431 2 0 2.89543 0 4V11C0 12.1046 0.895431 13 2 13H14C15.1046 13 16 12.1046 16 11V4C16 2.89543 15.1046 2 14 2H2Z"/>\n</svg>\n'},24073:e=>{e.exports='<svg width="46" height="48" xmlns="http://www.w3.org/2000/svg">\n  <g clip-path="url(#clip0)">\n    <path d="M16.293 11.293A1 1 0 0017 13h12a1 1 0 000-2H17a1 1 0 00-.707.293zM16.293 19.293A1 1 0 0117 19h12a1 1 0 010 2H17a1 1 0 01-.707-1.707z"/>\n    <path fill-rule="evenodd" d="M8.293 1.293A1 1 0 008 2v13.69L.419 21.185a1 1 0 00-.419.841V43a4 4 0 004 4h38a4 4 0 004-4V22.026a1 1 0 00-.417-.839L38 15.689V2a1 1 0 00-1-1H9a1 1 0 00-.707.293zM36 16.174v9.506l-12.972 6.938-.027.016L10 25.68v-9.45V3h26v13.174zM8 18.16l-5.12 3.712L8 24.611v-6.45zm30 6.45v-6.45l5.12 3.712L38 24.61zM2 43V23.67L41.879 45H4a2 2 0 01-2-2zm42 0c0 .27-.055.536-.159.78L25.12 33.769 44 23.669V43z"/>\n  </g>\n  <defs>\n    <clipPath id="clip0">\n      <path fill="#fff" d="M0 0h46v48H0z"/>\n    </clipPath>\n  </defs>\n</svg>\n'},95174:e=>{e.exports='<svg class="onboarding-illustration" width="209" height="187" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <rect x=".5" y=".5" width="208" height="27" rx="2.5" class="form-field"/>\n  <path d="M128 9.5a.5.5 0 00-.5-.5h-8a.5.5 0 000 1h8a.5.5 0 00.5-.5z" class="color-fg"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M124 11a1 1 0 00-1 1v6a1 1 0 001 1h10a1 1 0 001-1v-6a1 1 0 00-1-1h-10zm5 4.293L125.707 12h6.586L129 15.293zM124 12h.293L129 16.707 133.707 12H134v6h-10v-6z" class="color-fg"/>\n  <path d="M119 11.5a.5.5 0 01.5-.5h2a.5.5 0 010 1h-2a.5.5 0 01-.5-.5zM122 13.5a.5.5 0 00-.5-.5h-2a.5.5 0 000 1h2a.5.5 0 00.5-.5z" class="color-fg"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M166 8h10v1h-10V8zm-1 0a1 1 0 011-1h10a1 1 0 011 1v2h-1.085l-.735 7.605c-.077.795-.661 1.395-1.356 1.395h-5.648c-.696 0-1.28-.601-1.356-1.396L166.085 10H165V8zm2.001 2l.723 7.488c.025.265.22.465.452.465h5.648c.233 0 .427-.2.452-.464l.723-7.489h-7.998zm6.491 1.859l-.607-.598-1.818 1.794-1.818-1.794-.606.598 1.818 1.795-1.818 1.795.606.598 1.818-1.795 1.818 1.795.607-.598-1.819-1.795 1.819-1.795z" class="color-fg"/>\n  <path d="M195.5 8a.5.5 0 01-.5-.5.5.5 0 00-.5-.5h-3a.5.5 0 00-.5.5.5.5 0 01-.5.5H189a1 1 0 00-1 1h10a1 1 0 00-1-1h-1.5zM189 10v7.5a1.5 1.5 0 001.5 1.5h5a1.5 1.5 0 001.5-1.5V10h-1v7.5a.5.5 0 01-.5.5h-5a.5.5 0 01-.5-.5V10h-1z" class="color-fg"/>\n  <path opacity=".3" d="M191 10v7h4v-7h-4z" class="color-fg"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M99.357 9.36a1.239 1.239 0 00-.357.852v7.575a1.185 1.185 0 00.339.87 1.158 1.158 0 00.861.342h9.6c.316-.005.619-.134.843-.36.224-.227.352-.532.357-.852V12c0-.5-.5-1-1-1h-5l-1.2-2h-3.6c-.317.005-.62.135-.843.36zm.642 8.462v-7.599a.236.236 0 01.069-.159.211.211 0 01.143-.064h3.035l1.254 2h5.3c.11 0 .2.088.2.198v5.578a.24.24 0 01-.068.159.216.216 0 01-.144.064h-9.624a.16.16 0 01-.153-.105.2.2 0 01-.012-.072z" class="highlight-fill"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M100 17.822v-7.599a.236.236 0 01.068-.159.211.211 0 01.143-.064h3.035l1.254 2h5.3c.11 0 .2.088.2.198v5.578a.24.24 0 01-.068.159.216.216 0 01-.144.064h-9.624a.16.16 0 01-.153-.105.2.2 0 01-.012-.072z" class="highlight-fill"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M142 9.154c0-1.19.964-2.154 2.154-2.154h9.692c1.19 0 2.154.964 2.154 2.154v9.692c0 1.19-.964 2.154-2.154 2.154h-9.692A2.154 2.154 0 01142 18.846V9.154zm2.154-1.077h9.692c.595 0 1.077.482 1.077 1.077v9.692c0 .595-.482 1.077-1.077 1.077h-9.692a1.078 1.078 0 01-1.077-1.077V9.154c0-.595.482-1.077 1.077-1.077z" class="color-fg"/>\n  <path d="M153.5 18.5v-1a8.001 8.001 0 00-8-8h-1v1.4h1a6.602 6.602 0 016.6 6.6v1h1.4zM147.5 17a1.501 1.501 0 11-3.002 0 1.501 1.501 0 013.002 0z" class="color-fg"/>\n  <path d="M150.5 17.5v1h-1.4v-1a3.6 3.6 0 00-3.6-3.6h-1v-1.4h1a4.994 4.994 0 013.536 1.464A4.998 4.998 0 01150.5 17.5z" class="color-fg"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M77 13.829V18a1 1 0 001 1h10a1 1 0 001-1V13.83c0-.53-.209-1.038-.584-1.413l-1.063-1.062-3.292 3.293a1.5 1.5 0 01-2.122 0l-3.292-3.293-1.063 1.062A1.994 1.994 0 0077 13.828zm2.354-3.183l3.293 3.293a.5.5 0 00.706 0l3.293-3.293-2.94-2.94a.998.998 0 00-1.412 0l-2.94 2.94z" class="highlight-fill"/>\n  <rect opacity=".6" x="8" y="43" width="187" height="12" rx="2" class="color-fg-faded"/>\n  <rect opacity=".3" x="8" y="58" width="166" height="12" rx="2" class="color-fg-faded"/>\n  <rect opacity=".6" x="8" y="82" width="187" height="12" rx="2" class="color-fg-faded"/>\n  <rect opacity=".3" x="8" y="97" width="166" height="12" rx="2" class="color-fg-faded"/>\n  <rect opacity=".6" x="8" y="121" width="187" height="12" rx="2" class="color-fg-faded"/>\n  <rect opacity=".3" x="8" y="136" width="166" height="12" rx="2" class="color-fg-faded"/>\n  <rect opacity=".6" x="8" y="160" width="187" height="12" rx="2" class="color-fg-faded"/>\n  <rect opacity=".3" x="8" y="175" width="166" height="12" rx="2" class="color-fg-faded"/>\n</svg>\n'},52725:e=>{e.exports='<svg class="onboarding-illustration" width="216" height="200" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <g filter="url(#filter0_d)">\n    <path d="M7 9a5 5 0 015-5h192a5 5 0 015 5v156.03a5 5 0 01-4.55 4.98l-192 17.5A5 5 0 017 182.51V9z" class="bg-fill"/>\n  </g>\n  <rect fill-opacity=".2" x="46" y="24" width="77" height="12" rx="2" class="color-fg-faded"/>\n  <rect fill-opacity=".2" x="46" y="48" width="77" height="12" rx="2" class="color-fg-faded"/>\n  <rect fill-opacity=".2" x="46" y="72" width="60" height="12" rx="2" class="color-fg-faded"/>\n  <rect fill-opacity=".2" x="46" y="96" width="77" height="12" rx="2" class="color-fg-faded"/>\n  <rect fill-opacity=".2" x="46" y="120" width="77" height="12" rx="2" class="color-fg-faded"/>\n  <rect fill-opacity=".2" x="46" y="144" width="60" height="12" rx="2" class="color-fg-faded"/>\n  <path d="M33 26a2 2 0 100-4 2 2 0 000 4z" class="color-fg"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M33 32v-5c-.35 0-.687-.06-1-.17V32H22v-6h.293L27 30.707l4.262-4.262A3.01 3.01 0 0130.17 25H22a1 1 0 00-1 1v6a1 1 0 001 1h10a1 1 0 001-1zm-6-2.707L30.293 26h-6.586L27 29.293zM21.357 121.361a1.237 1.237 0 00-.357.851v7.575a1.187 1.187 0 00.339.87 1.156 1.156 0 00.86.342h9.6c.317-.005.62-.134.844-.36.224-.227.352-.532.357-.852V124c0-.5-.5-1-1-1h-5l-1.2-2h-3.6a1.214 1.214 0 00-.843.361zm.642 8.461v-7.599a.24.24 0 01.069-.159.215.215 0 01.143-.064h3.035l1.254 2h5.3c.11 0 .2.088.2.198v5.578a.238.238 0 01-.068.159.215.215 0 01-.144.064h-9.606l-.018.001a.142.142 0 01-.06-.011.169.169 0 01-.092-.095.179.179 0 01-.013-.072z" class="color-fg"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M22 129.822v-7.599a.24.24 0 01.067-.159.215.215 0 01.144-.064h3.035l1.254 2h5.3c.11 0 .2.088.2.198v5.578a.238.238 0 01-.068.159.215.215 0 01-.144.064h-9.606l-.018.001a.142.142 0 01-.06-.011.169.169 0 01-.092-.095.179.179 0 01-.013-.072z" class="color-fg" fill-opacity=".1"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M32.414 94.5a1.5 1.5 0 00-1.06.44L30.292 96 33 98.707l1-1a1.707 1.707 0 000-2.414l-.354-.354a1.5 1.5 0 00-1.06-.439h-.172zm-.354 1.146a.5.5 0 01.354-.146h.172a.5.5 0 01.353.146l.354.354a.707.707 0 010 1l-.293.293L31.707 96l.353-.354zM29.5 96.793l-5.5 5.5V105h2.707l5.5-5.5-2.707-2.707zM25 104v-1.293l4.5-4.5 1.293 1.293-4.5 4.5H25z" class="color-fg"/>\n  <path d="M23 97h4l-1 1h-3c-.5 0-1 .5-1 1v7c0 .5.5 1 1 1h5a1 1 0 001-1v-1l1-1v2a2 2 0 01-2 2h-5a2 2 0 01-2-2v-7c0-1 .895-2 2-2z" class="color-fg"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M19 72h14.546c.36 0 .715.09.992.31.293.23.462.578.462.99 0 .25-.099.47-.19.626a2.14 2.14 0 01-.318.41L24 85v-8l-5-5zm2.5.95L24 75.5l7-1.5-6 3.5.003 5 8.864-8.849c.062-.063.129-.144.176-.225.045-.076.053-.118.054-.125 0-.117-.038-.183-.1-.232-.078-.06-.223-.12-.45-.12H21.5zM26.294 47.706a.998.998 0 011.412 0l4.71 4.71c.375.375.584.882.584 1.413V59a1 1 0 01-1 1H22a1 1 0 01-1-1v-5.172c0-.53.209-1.037.584-1.412l4.71-4.71zm-2.733 4.148L27 48.414l3.44 3.44-3.086 3.085a.5.5 0 01-.708 0l-3.085-3.085zm-.707.707l-.563.562a.994.994 0 00-.291.706V59h10v-5.172a.994.994 0 00-.291-.705l-.563-.562-3.085 3.086a1.5 1.5 0 01-2.122 0l-3.085-3.086z" class="color-fg"/>\n  <path d="M159 38h-19a3 3 0 01-3-3V25a3 3 0 013-3h19v16z" class="color-fg"/>\n  <path fill-opacity="0.2" d="M159 22h19a3 3 0 013 3v10a3 3 0 01-3 3h-19V22z" class="color-fg-faded"/>\n  <path d="M145.181 34h1.011v-8.103h-1.005l-2.156 1.55v1.067l2.061-1.494h.089V34zm3.381-5.823v.006h.977v-.006c0-.955.64-1.59 1.589-1.59.893 0 1.583.624 1.583 1.433 0 .651-.252 1.09-1.297 2.223l-2.802 3.06V34h5.245v-.91h-3.796V33l1.949-2.094c1.33-1.426 1.712-2.083 1.712-2.925 0-1.286-1.112-2.275-2.566-2.275-1.505 0-2.594 1.034-2.594 2.471z" class="bg-fill"/>\n  <path d="M166.485 34h1.011v-8.103h-1.006l-2.156 1.55v1.067l2.061-1.494h.09V34zm6.199.19c1.718 0 2.92-.97 2.92-2.357 0-1.056-.668-1.876-1.685-2.067v-.09c.837-.23 1.354-.92 1.354-1.808 0-1.263-1.073-2.162-2.589-2.162s-2.589.899-2.589 2.162c0 .882.528 1.584 1.354 1.808v.09c-1.017.191-1.685 1.01-1.685 2.067 0 1.386 1.202 2.358 2.92 2.358zm0-.864c-1.123 0-1.898-.64-1.898-1.567 0-.926.775-1.566 1.898-1.566 1.123 0 1.898.64 1.898 1.566 0 .927-.775 1.567-1.898 1.567zm0-3.987c-.955 0-1.595-.55-1.595-1.375 0-.837.635-1.393 1.595-1.393s1.595.556 1.595 1.393c0 .825-.64 1.375-1.595 1.375z" class="color-fg"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M22 144h10v1H22v-1zm-1 0a1 1 0 011-1h10a1 1 0 011 1v2h-1.085l-.735 7.605c-.077.795-.661 1.395-1.356 1.395h-5.648c-.695 0-1.28-.601-1.356-1.396L22.085 146H21v-2zm2 2l.724 7.488c.025.265.22.466.452.466h5.648c.233 0 .427-.201.452-.465L31 146h-7.998zm6.491 1.859l-.606-.598-1.818 1.794-1.818-1.794-.606.598 1.818 1.795-1.818 1.795.606.598 1.818-1.795 1.818 1.795.606-.598-1.818-1.795 1.819-1.795z" class="color-fg"/>\n  <defs>\n    <filter id="filter0_d" x="0" y="0" width="216" height="197.52" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">\n      <feFlood flood-opacity="0" result="BackgroundImageFix"/>\n      <feColorMatrix in="SourceAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/>\n      <feOffset dy="3"/>\n      <feGaussianBlur stdDeviation="3.5"/>\n      <feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.13 0"/>\n      <feBlend in2="BackgroundImageFix" result="effect1_dropShadow"/>\n      <feBlend in="SourceGraphic" in2="effect1_dropShadow" result="shape"/>\n    </filter>\n  </defs>\n</svg>\n'},24566:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M2 7.82852V12.0001C2 12.2653 2.10536 12.5197 2.29289 12.7072C2.48043 12.8947 2.73478 13.0001 3 13.0001H13C13.2652 13.0001 13.5196 12.8947 13.7071 12.7072C13.8946 12.5197 14 12.2653 14 12.0001V7.82852C14 7.29808 13.7912 6.79127 13.4161 6.4162L12.3535 5.3536L9.06066 8.64645C8.47487 9.23223 7.52513 9.23223 6.93934 8.64645L3.64649 5.3536L2.58389 6.4162C2.20882 6.79127 2 7.29808 2 7.82852ZM4.3536 4.64649L7.64645 7.93934C7.84171 8.1346 8.15829 8.1346 8.35355 7.93934L11.6464 4.64649L8.70614 1.70622C8.31561 1.3157 7.68439 1.3157 7.29386 1.70622L4.3536 4.64649Z"/>\n</svg>\n'},90658:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M2 3h12a1 1 0 01.96.721L8 7.433 1.04 3.721A1 1 0 012 3zM1 4.833V12a1 1 0 001 1h12a1 1 0 001-1V4.833L8.235 8.441 8 8.567l-.235-.126L1 4.833zM0 4a2 2 0 012-2h12a2 2 0 012 2v8a2 2 0 01-2 2H2a2 2 0 01-2-2V4z"/>\n</svg>\n'},52462:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path class="small-icon-fill" fill-rule="evenodd" clip-rule="evenodd" d="M2 2C0.895431 2 0 2.89543 0 4V12C0 13.1046 0.895431 14 2 14H14C15.1046 14 16 13.1046 16 12V4C16 2.89543 15.1046 2 14 2H2ZM1 3.70001V4.83335L8 8.56668L15 4.83335V3.70001L8 7.43335L1 3.70001Z"/>\n  <path class="small-icon-outline" fill-rule="evenodd" clip-rule="evenodd" d="M14 3H2C1.44772 3 1 3.44772 1 4V12C1 12.5523 1.44772 13 2 13H14C14.5523 13 15 12.5523 15 12V4C15 3.44772 14.5523 3 14 3ZM2 2C0.895431 2 0 2.89543 0 4V12C0 13.1046 0.895431 14 2 14H14C15.1046 14 16 13.1046 16 12V4C16 2.89543 15.1046 2 14 2H2Z"/>\n</svg>\n'},4856:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M3 2C2.44772 2 2 2.44772 2 3V5H3.08537L3.81966 12.6037C3.89644 13.3987 4.48049 14.0002 5.17571 14.0002H10.8242C11.5188 14.0002 12.1033 13.4005 12.1802 12.6048L12.9146 5H14V3C14 2.44772 13.5523 2 13 2H3ZM10.4916 6.85906L9.88546 6.26074L8.06682 8.05543L6.24891 6.26074L5.64282 6.85906L7.46082 8.65367L5.64282 10.449L6.24891 11.0473L8.06682 9.2519L9.88546 11.0473L10.4916 10.449L8.67282 8.65367L10.4916 6.85906Z"/>\n</svg>\n'},68401:e=>{e.exports='<svg width="26" height="26" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M10.7 19.9c.1.1.2.1.3.1.4 0 .8-.3 1-.7l4-12c.2-.6-.1-1.1-.6-1.3-.6-.2-1.1.1-1.3.6l-4 12c-.2.6.1 1.1.6 1.3Zm-2.4-3.2-3-3c-.4-.4-.4-1 0-1.4l3-3 1.4 1.4L7.4 13l2.3 2.3-1.4 1.4Zm9.4 0-1.4-1.4 2.3-2.3-2.3-2.3 1.4-1.4 3 3c.4.4.4 1 0 1.4l-3 3Z"/>\n</svg>\n'},4266:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M5.7 14.9c.1.1.2.1.3.1.4 0 .8-.3 1-.7l4-12c.2-.6-.1-1.1-.6-1.3-.6-.2-1.1.1-1.3.6l-4 12c-.2.6.1 1.1.6 1.3Zm-2.4-3.2-3-3c-.4-.4-.4-1 0-1.4l3-3 1.4 1.4L2.4 8l2.3 2.3-1.4 1.4Zm9.4 0-1.4-1.4L13.6 8l-2.3-2.3 1.4-1.4 3 3c.4.4.4 1 0 1.4l-3 3Z"/>\n</svg>\n'},33329:e=>{e.exports='<svg width="26" height="26" xmlns="http://www.w3.org/2000/svg">\n  <path d="M7 7v4.5h.75l1.5-2.25h2.25v7.5l-2.25 1.5V19h7.5v-.75l-2.25-1.5v-7.5h2.25l1.5 2.25H19V7H7Z"/>\n</svg>\n'},68189:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M2 2v4.5h.75l1.5-2.25H6.5v7.5l-2.25 1.5V14h7.5v-.75l-2.25-1.5v-7.5h2.25l1.5 2.25H14V2H2Z"/>\n</svg>\n'},2473:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M7.5 0c-3.025 0-5.5 2.314-5.5 5.143v5.714c0 2.829 2.475 5.143 5.5 5.143s5.5-2.314 5.5-5.143v-5.714c0-2.829-2.475-5.143-5.5-5.143zm-3.5 5.322c0-1.637 1.29-3.006 3-3.322v4h-3v-.678zm7 5.761c0 1.608-1.571 2.917-3.5 2.917-1.931 0-3.5-1.309-3.5-2.917v-4.083h7v4.083zm-3-5.083v-4c1.709.315 3 1.685 3 3.322v.678h-3z"/>\n</svg>\n'},41868:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M4.5 11C5.38054 11 6.20201 10.7471 6.89574 10.31L10.2929 13.7071C10.6834 14.0976 11.3166 14.0976 11.7071 13.7071C12.0976 13.3166 12.0976 12.6834 11.7071 12.2929L8.30995 8.89574C8.74709 8.20201 9 7.38054 9 6.5C9 4.01472 6.98528 2 4.5 2C2.01472 2 0 4.01472 0 6.5C0 8.98528 2.01472 11 4.5 11ZM4.5 9C5.88071 9 7 7.88071 7 6.5C7 5.11929 5.88071 4 4.5 4C3.11929 4 2 5.11929 2 6.5C2 7.88071 3.11929 9 4.5 9Z"/>\n  <path d="M13 8L14.9757 6.02426C15.3537 5.64629 15.086 5 14.5515 5H11.4485C10.914 5 10.6463 5.64629 11.0243 6.02426L13 8Z"/>\n</svg>\n'},52145:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path d="M15.2929 20.7071C15.6834 21.0976 16.3166 21.0976 16.7071 20.7071C17.0976 20.3166 17.0976 19.6834 16.7071 19.2929L10.4142 13L16.7071 6.70711C17.0976 6.31658 17.0976 5.68342 16.7071 5.29289C16.3166 4.90237 15.6834 4.90237 15.2929 5.29289L7.58575 13L15.2929 20.7071Z"/>\n</svg>\n'},29629:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M10.2071 4.20711C10.5977 3.81658 10.5977 3.18342 10.2071 2.79289C9.81661 2.40237 9.18345 2.40237 8.79292 2.79289L3.58582 8L8.79292 13.2071C9.18345 13.5976 9.81661 13.5976 10.2071 13.2071C10.5977 12.8166 10.5977 12.1834 10.2071 11.7929L6.41424 8L10.2071 4.20711Z"/>\n</svg>\n'},46685:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M10.354 13.354a.5.5 0 01-.708 0l-5-5L4.293 8l.353-.354 5-5a.5.5 0 01.708.708L5.707 8l4.647 4.646a.5.5 0 010 .708z"/>\n</svg>\n'},88952:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path d="M17 18C17 18.5523 16.5523 19 16 19C15.4477 19 15 18.5523 15 18L15 14L10.7071 18.2929C10.0771 18.9229 9 18.4767 9 17.5858L9 8.41421C9 7.52331 10.0771 7.07714 10.7071 7.70711L15 12L15 8C15 7.44772 15.4477 7 16 7C16.5523 7 17 7.44771 17 8L17 18Z"/>\n</svg>\n'},4819:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M10 13C9.44772 13 9 12.5523 9 12L9 9L5.70711 12.2929C5.07714 12.9229 4 12.4767 4 11.5858L4 4.41421C4 3.52331 5.07714 3.07714 5.70711 3.70711L9 7L9 4C9 3.44771 9.44772 3 10 3C10.5523 3 11 3.44771 11 4L11 12C11 12.5523 10.5523 13 10 13Z"/>\n</svg>\n'},27308:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M10.5 4.2a.5.5 0 00-1 0v3.3L5.854 3.854A.5.5 0 005 4.207v7.586a.5.5 0 00.854.354L9.5 8.5v3.3a.5.5 0 101 0V4.2zM8.586 8L6 10.586V5.414L8.586 8z"/>\n</svg>\n'},15709:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path d="M9.29289 19.2929C8.90237 19.6834 8.90237 20.3166 9.29289 20.7071C9.68342 21.0976 10.3166 21.0976 10.7071 20.7071L18.4142 13L10.7071 5.29289C10.3166 4.90237 9.68342 4.90237 9.29289 5.29289C8.90237 5.68342 8.90237 6.31658 9.29289 6.70711L15.5858 13L9.29289 19.2929Z"/>\n</svg>\n'},89654:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M5.79286 11.7929C5.40234 12.1834 5.40234 12.8166 5.79286 13.2071C6.18339 13.5976 6.81655 13.5976 7.20708 13.2071L12.4142 8L7.20708 2.79289C6.81655 2.40237 6.18339 2.40237 5.79287 2.79289C5.40234 3.18342 5.40234 3.81658 5.79287 4.20711L9.58576 8L5.79286 11.7929Z"/>\n</svg>\n'},6198:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M5.646 2.646a.5.5 0 01.708 0l5 5 .353.354-.353.354-5 5a.5.5 0 01-.708-.708L10.293 8 5.646 3.354a.5.5 0 010-.708z"/>\n</svg>\n'},980:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M14.0607 5.14645C13.4749 4.56066 12.5251 4.56066 11.9393 5.14645L5.43934 11.6464C5.15804 11.9278 5 12.3093 5 12.7071V19.5C5 20.3284 5.67157 21 6.5 21H10.5C11.3284 21 12 20.3284 12 19.5V16.073C12.0032 16.0667 12.0072 16.0593 12.012 16.0508C12.0486 15.9868 12.1157 15.898 12.216 15.8084C12.4164 15.6296 12.6873 15.5 13 15.5C13.3127 15.5 13.5836 15.6296 13.784 15.8084C13.8843 15.898 13.9514 15.9868 13.988 16.0508C13.9928 16.0593 13.9968 16.0667 14 16.073V19.5C14 20.3284 14.6716 21 15.5 21H19.5C20.3284 21 21 20.3284 21 19.5V12.7071C21 12.3093 20.842 11.9278 20.5607 11.6464L14.0607 5.14645ZM7 12.9142L13 6.91421L19 12.9142V19H16V16C16 15.6363 15.8655 15.3053 15.7245 15.0586C15.5736 14.7944 15.3657 14.5395 15.116 14.3166C14.6164 13.8704 13.8873 13.5 13 13.5C12.1127 13.5 11.3836 13.8704 10.884 14.3166C10.6343 14.5395 10.4264 14.7944 10.2755 15.0586C10.1345 15.3053 10 15.6363 10 16V19H7V12.9142Z"/>\n</svg>\n'},10737:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n\t<path fill-rule="evenodd" d="M8 10.5C8.85199 10.5 8.97809 11.1049 8.99676 11.6963C9 11.799 9 11.9013 9 12V14C9 14.5523 9.44772 15 10 15H14C14.5523 15 15 14.5523 15 14V8.41421C15 8.149 14.8946 7.89464 14.7071 7.70711L8.70711 1.70711C8.31658 1.31658 7.68342 1.31658 7.29289 1.70711L1.29289 7.70711C1.10536 7.89464 1 8.149 1 8.41421V14C1 14.5523 1.44772 15 2 15H6C6.55228 15 7 14.5523 7 14V12C7 11.9013 7 11.799 7.00324 11.6963C7.02191 11.1049 7.14801 10.5 8 10.5ZM13 13V8.82843L8 3.82843L3 8.82843V13H5V12L4.99965 11.9448C4.99723 11.6655 4.9906 10.9031 5.28671 10.2122C5.47659 9.76911 5.8086 9.29298 6.35625 8.94816C6.89191 8.61089 7.47399 8.5 8 8.5C8.52601 8.5 9.10809 8.61089 9.64375 8.94816C10.1914 9.29298 10.5234 9.76911 10.7133 10.2122C11.0094 10.9031 11.0028 11.6655 11.0003 11.9448L11 12V13H13ZM6.99038 11.645C6.98978 11.6405 6.98933 11.6384 6.98933 11.6384L6.98953 11.6401C6.98953 11.6401 6.98997 11.6428 6.99038 11.645Z"/>\n</svg>\n'},79639:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M13 13V7.414l-5-5-5 5V13h3v-2-.052c-.001-.294-.003-.855.206-1.342.126-.294.339-.595.683-.812C7.227 8.581 7.612 8.5 8 8.5s.773.081 1.11.294c.345.217.558.518.684.812.209.487.207 1.048.206 1.342V13h3zm1 0V7.414a1 1 0 00-.293-.707l-5-5a1 1 0 00-1.414 0l-5 5A1 1 0 002 7.414V13a1 1 0 001 1h3a1 1 0 001-1v-2c0-.667 0-1.5 1-1.5s1 .833 1 1.5v2a1 1 0 001 1h3a1 1 0 001-1z"/>\n</svg>\n'},15159:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path d="M20 6.20711C20 5.76166 19.4614 5.53857 19.1464 5.85355L17.2797 7.72031C16.9669 7.46165 16.632 7.22741 16.2774 7.02069C14.7393 6.12402 12.9324 5.80372 11.1799 6.1171C9.4273 6.43048 7.84336 7.35709 6.71134 8.73121C5.57932 10.1053 4.97303 11.8373 5.00092 13.6175C5.02881 15.3976 5.68905 17.1098 6.86356 18.4478C8.03807 19.7858 9.65025 20.6623 11.4118 20.9206C13.1733 21.179 14.9693 20.8022 16.4785 19.8578C17.5598 19.1812 18.4434 18.2447 19.0553 17.1439C19.0803 17.099 19.1048 17.0538 19.1288 17.0084C19.1844 16.9033 19.2376 16.7968 19.2883 16.689C19.5213 16.193 19.2261 15.6315 18.7038 15.466C18.2666 15.3274 17.81 15.5117 17.5224 15.8594C17.4823 15.9079 17.4455 15.9596 17.4125 16.014C17.3994 16.0356 17.3869 16.0576 17.375 16.0801C16.9237 16.9329 16.2535 17.6577 15.4259 18.1757C14.3159 18.8702 12.9951 19.1473 11.6997 18.9573C10.4042 18.7673 9.21861 18.1227 8.35485 17.1387C7.49109 16.1547 7.00554 14.8955 6.98503 13.5864C6.96452 12.2772 7.41039 11.0035 8.24291 9.99293C9.07542 8.98238 10.2403 8.30093 11.5291 8.07047C12.818 7.84001 14.1468 8.07556 15.278 8.73499C15.4839 8.85508 15.6809 8.9878 15.868 9.13202L13.8536 11.1464C13.5386 11.4614 13.7617 12 14.2071 12H20V6.20711Z"/>\n</svg>\n'},95574:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M14 2.20711C14 1.76166 13.4614 1.53857 13.1464 1.85356L11.7246 3.27543C11.3372 2.96859 10.911 2.7088 10.4541 2.50391C9.21538 1.94834 7.82481 1.82932 6.50965 2.16629C5.19448 2.50327 4.03248 3.27631 3.2135 4.35912C2.39451 5.44193 1.96697 6.77049 2.00073 8.12771C2.03448 9.48494 2.52754 10.7906 3.39933 11.8314C4.27113 12.8721 5.47012 13.5864 6.80041 13.8576C8.1307 14.1288 9.51363 13.9408 10.7233 13.3244C11.4465 12.9557 12.0823 12.447 12.5968 11.8333C12.6276 11.7965 12.6581 11.7593 12.688 11.7218C12.7896 11.5946 12.886 11.4632 12.9771 11.3278C13.2826 10.8737 13.0562 10.2799 12.558 10.0533C12.1616 9.87286 11.7138 9.98233 11.3753 10.2501C11.3189 10.2948 11.2654 10.3439 11.2158 10.3968C11.1891 10.4252 11.1635 10.4548 11.1391 10.4853C10.7843 10.9298 10.3368 11.2969 9.82334 11.5585C9.01328 11.9714 8.08715 12.0973 7.19628 11.9157C6.30542 11.734 5.50247 11.2557 4.91865 10.5587C4.33482 9.86172 4.00463 8.98735 3.98203 8.07844C3.95942 7.16953 4.24574 6.27982 4.7942 5.55468C5.34265 4.82955 6.12082 4.31185 7.00156 4.08619C7.88231 3.86052 8.81354 3.94023 9.64312 4.31228C9.87802 4.41763 10.1008 4.54465 10.309 4.69096L8.85356 6.14645C8.53857 6.46143 8.76166 7 9.20711 7H14V2.20711Z"/>\n</svg>\n'},81315:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M7.5 3.5a4.5 4.5 0 104.032 6.5h1.093A5.502 5.502 0 012 8a5.5 5.5 0 019.39-3.89l1.256-1.256a.5.5 0 01.854.353V7H9.707a.5.5 0 01-.353-.854l1.328-1.328A4.486 4.486 0 007.5 3.5z"/>\n</svg>\n'},2753:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path d="M9 8C9 7.44772 9.44772 7 10 7C10.5523 7 11 7.44772 11 8V12L15.2929 7.70711C15.9229 7.07714 17 7.52331 17 8.41421V17.5858C17 18.4767 15.9229 18.9229 15.2929 18.2929L11 14V18C11 18.5523 10.5523 19 10 19C9.44772 19 9 18.5523 9 18V8Z"/>\n</svg>\n'},79257:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M6 3C6.55228 3 7 3.44772 7 4V7L10.2929 3.70711C10.9229 3.07714 12 3.52331 12 4.41421V11.5858C12 12.4767 10.9229 12.9229 10.2929 12.2929L7 9V12C7 12.5523 6.55228 13 6 13C5.44772 13 5 12.5523 5 12V4C5 3.44772 5.44772 3 6 3Z"/>\n</svg>\n'},23588:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M5.5 11.8a.5.5 0 001 0V8.5l3.646 3.646a.5.5 0 00.854-.353V4.207a.5.5 0 00-.854-.353L6.5 7.5V4.2a.5.5 0 00-1 0v7.6zM7.414 8L10 5.414v5.172L7.414 8z"/>\n</svg>\n'},67066:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path d="M8.70711 7.29289C8.31658 6.90237 7.68342 6.90237 7.29289 7.29289C6.90237 7.68342 6.90237 8.31658 7.29289 8.70711L11.5858 13L7.29289 17.2929C6.90237 17.6834 6.90237 18.3166 7.29289 18.7071C7.68342 19.0976 8.31658 19.0976 8.70711 18.7071L13 14.4142L17.2929 18.7071C17.6834 19.0976 18.3166 19.0976 18.7071 18.7071C19.0976 18.3166 19.0976 17.6834 18.7071 17.2929L14.4142 13L18.7071 8.70711C19.0976 8.31658 19.0976 7.68342 18.7071 7.29289C18.3166 6.90237 17.6834 6.90237 17.2929 7.29289L13 11.5858L8.70711 7.29289Z"/>\n</svg>\n'},52893:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M11.7071 5.70711C12.0976 5.31658 12.0976 4.68342 11.7071 4.29289C11.3166 3.90237 10.6834 3.90237 10.2929 4.29289L8 6.58579L5.70711 4.29289C5.31658 3.90237 4.68342 3.90237 4.29289 4.29289C3.90237 4.68342 3.90237 5.31658 4.29289 5.70711L6.58579 8L4.29289 10.2929C3.90237 10.6834 3.90237 11.3166 4.29289 11.7071C4.68342 12.0976 5.31658 12.0976 5.70711 11.7071L8 9.41421L10.2929 11.7071C10.6834 12.0976 11.3166 12.0976 11.7071 11.7071C12.0976 11.3166 12.0976 10.6834 11.7071 10.2929L9.41421 8L11.7071 5.70711Z"/>\n</svg>\n'},63818:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M6 1C5.44772 1 5 1.44772 5 2V4C5 4.55228 5.44772 5 6 5C6.55228 5 7 5.44772 7 6C7 6.55228 6.55228 7 6 7H2C1.44772 7 1 7.44772 1 8V10.5C1 10.7761 0.776142 11 0.5 11C0.223858 11 0 11.2239 0 11.5V13C0 13.5523 0.447715 14 1 14H3C3.55228 14 4 13.5523 4 13V11.5C4 11.2239 3.77614 11 3.5 11C3.22386 11 3 10.7761 3 10.5V10C3 9.44771 3.44772 9 4 9H6C6.55228 9 7 9.44771 7 10V10.5C7 10.7761 6.77614 11 6.5 11C6.22386 11 6 11.2239 6 11.5V13C6 13.5523 6.44772 14 7 14H9C9.55229 14 10 13.5523 10 13V11.5C10 11.2239 9.77614 11 9.5 11C9.22386 11 9 10.7761 9 10.5V10C9 9.44771 9.44771 9 10 9H12C12.5523 9 13 9.44771 13 10V10.5C13 10.7761 12.7761 11 12.5 11C12.2239 11 12 11.2239 12 11.5V13C12 13.5523 12.4477 14 13 14H15C15.5523 14 16 13.5523 16 13V11.5C16 11.2239 15.7761 11 15.5 11C15.2239 11 15 10.7761 15 10.5V8C15 7.44772 14.5523 7 14 7H10C9.44772 7 9 6.55228 9 6C9 5.44772 9.44771 5 10 5C10.5523 5 11 4.55228 11 4V2C11 1.44772 10.5523 1 10 1H6Z"/>\n</svg>\n'},90014:e=>{e.exports='<svg version="1.1" viewBox="0 0 16 16" height="16" width="16" class="note-icon" xmlns="http://www.w3.org/2000/svg">\n  <polygon points="9.5,8.5 9.5,14.9 11.5,13.3 13.5,14.9 13.5,8.5 "/>\n  <path stroke-opacity="0" d="M8,14c-1.6,0-3.4,0-5,0c0-3.7,0-8.3,0-12h10c0,1.3,0,3.7,0,5H8V14z"/>\n  <path fill-opacity="0" d="M8,13.5c-1.6,0-2.9,0-4.5,0c0-3.7,0-7.3,0-11h9c0,1.3,0,3.2,0,4.5"/>\n  <line fill-opacity="0" stroke-width="2" x1="4" y1="3" x2="12" y2="3"/>\n  <line fill-opacity="0" x1="5" y1="6.5" x2="11" y2="6.5"/>\n  <line fill-opacity="0" x1="5" y1="8.5" x2="8" y2="8.5"/>\n  <line fill-opacity="0" x1="5" y1="10.5" x2="8" y2="10.5"/>\n</svg>\n'},53001:e=>{e.exports='<svg version="1.1" viewBox="0 0 16 16" height="16" width="16" class="note-icon" xmlns="http://www.w3.org/2000/svg">\n\t<rect x="3.5" y="2.5" width="9" height="11" rx="0.1" ry="0.1" />\n\t<line fill-opacity="0" stroke-width="2" x1="4" y1="3" x2="12" y2="3"/>\n\t<line fill-opacity="0" x1="5" y1="6.5" x2="11" y2="6.5"/>\n\t<line fill-opacity="0" x1="5" y1="8.5" x2="11" y2="8.5"/>\n\t<line fill-opacity="0" x1="5" y1="10.5" x2="11" y2="10.5"/>\n</svg>\n'},42450:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M2 11V7a1 1 0 011-1h1a2 2 0 002-2h4c0 1.1.9 2 2 2h1a1 1 0 011 1v4a1 1 0 01-1 1H3a1 1 0 01-1-1zM1 7v4c0 1.1.9 2 2 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-1a1 1 0 01-1-1 1 1 0 00-1-1H6a1 1 0 00-1 1 1 1 0 01-1 1H3a2 2 0 00-2 2zm8 2a1 1 0 11-2 0 1 1 0 012 0zm1 0a2 2 0 11-4 0 2 2 0 014 0z"/>\n</svg>'},33851:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <circle cx="7.5" cy="7.5" r="4.5" fill-opacity="0.1"/>\n  <path d="M7.5 3C10 3 12 5 12 7.5S10 12 7.5 12 3 10 3 7.5 5 3 7.5 3m0-1C4.5 2 2 4.5 2 7.5S4.5 13 7.5 13 13 10.5 13 7.5 10.5 2 7.5 2z" fill-opacity="0.3"/>\n  <path d="M8 7V0H7v7H0v1h7v7h1V8h7V7H8zm0 0v1H7V7h1z"/>\n</svg>\n'},41380:e=>{e.exports='<svg width="16" height="16"\n    xmlns="http://www.w3.org/2000/svg">\n    <path fill-rule="evenodd" d="M2 13a2 2 0 002 2h8a2 2 0 002-2V3a2 2 0 00-1.999-2H4a2 2 0 00-2 2v10zm2-9h8v9H4V4zm1 1.956h6v1H5v-1zm0 2h6v1H5v-1zm0 2h6v1H5v-1z"/>\n</svg>'},60381:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M13 3H3v11h10V3zM2 2a1 1 0 011-1h10a1 1 0 011 1v12a1 1 0 01-1 1H3a1 1 0 01-1-1V2zm3 3h6v1H5V5zm0 3h6v1H5V8zm0 3h6v1H5v-1z"/>\n</svg>\n'},91329:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path class="small-icon-fill" fill-rule="evenodd" d="M13 3H3v11h10V3zM5 5h6v1H5V5zm0 3h6v1H5V8zm0 3h6v1H5v-1z"/>\n  <path class="small-icon-outline" fill-rule="evenodd" d="M2 2a1 1 0 011-1h10a1 1 0 011 1v12a1 1 0 01-1 1H3a1 1 0 01-1-1V2zm11 1H3v11h10V3z"/>\n</svg>\n'},34923:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M8.00001 2C6.93914 2 5.92172 2.42143 5.17158 3.17157C4.42143 3.92172 4.00001 4.93913 4.00001 6V8.48188C3.96952 8.87419 3.79988 9.24291 3.5214 9.5214C3.23918 9.80362 2.86427 9.97406 2.46606 10.0012C2.19715 10.0195 1.99114 10.2476 2.00029 10.517C2.00945 10.7864 2.23047 11 2.50001 11H13.5C13.7695 11 13.9906 10.7864 13.9997 10.517C14.0089 10.2476 13.8029 10.0195 13.534 10.0012C13.1357 9.97406 12.7608 9.80362 12.4786 9.5214C12.2001 9.24291 12.0305 8.87419 12 8.48189V6C12 4.93913 11.5786 3.92172 10.8284 3.17157C10.0783 2.42143 9.06087 2 8.00001 2ZM5.87868 3.87868C6.44129 3.31607 7.20436 3 8.00001 3C8.79565 3 9.55872 3.31607 10.1213 3.87868C10.6839 4.44129 11 5.20435 11 6V8.5C11 8.51133 11.0004 8.52265 11.0012 8.53395C11.0377 9.07104 11.2367 9.58173 11.568 10H4.43204C4.76336 9.58173 4.9623 9.07104 4.99885 8.53395C4.99962 8.52265 5.00001 8.51133 5.00001 8.5V6C5.00001 5.20435 5.31608 4.44129 5.87868 3.87868ZM7.06415 12.3355C6.9733 12.0747 6.68826 11.937 6.42749 12.0278C6.16672 12.1187 6.02897 12.4037 6.11982 12.6645C6.25579 13.0548 6.50984 13.3931 6.84674 13.6325C7.18365 13.8719 7.58669 14.0005 7.99999 14.0005C8.41328 14.0005 8.81632 13.8719 9.15323 13.6325C9.49013 13.3931 9.74418 13.0548 9.88015 12.6645C9.971 12.4037 9.83325 12.1187 9.57248 12.0278C9.31171 11.937 9.02667 12.0747 8.93582 12.3355C8.86814 12.5298 8.74169 12.6981 8.574 12.8173C8.40631 12.9365 8.2057 13.0005 7.99999 13.0005C7.79427 13.0005 7.59366 12.9365 7.42597 12.8173C7.25828 12.6981 7.13183 12.5298 7.06415 12.3355Z"/>\n</svg>\n'},24638:e=>{e.exports='<svg width="26" height="26" xmlns="http://www.w3.org/2000/svg">\n  <path d="M17.2 11.7C17.2 9 15.5 7 13 7c-2.2 0-4.2 2-4.2 4.7v.3h-.3a.5.5 0 00-.5.5V18a1 1 0 001 1h8a1 1 0 001-1v-5.5a.5.5 0 00-.5-.5h-.3v-.3zM15.7 13h-5.4v-1.3c0-1.7 1.4-3 2.8-3 1.7 0 2.8 1.3 2.8 3V13h-.2z"/>\n</svg>\n'},3638:e=>{e.exports='<svg width="26" height="26" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M17.2 12h-1.3v1H10.3v-1.3c0-1.7 1.4-3 2.8-3 .323 0 .624.047.9.134v-1.72A4.336 4.336 0 0013 7c-2.2 0-4.2 2-4.2 4.7v.3h-.3a.5.5 0 00-.5.5V18a1 1 0 001 1h8a1 1 0 001-1v-5.5a.5.5 0 00-.5-.5h-.3z"/>\n</svg>\n'},32721:e=>{e.exports='<svg width="28" height="28" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path opacity=".3" d="M24 0H4v28h20V0z"/>\n  <path d="M24 23H4c-1.1 0-2-.9-2-2V7c0-1.1.9-2 2-2h20c1.1 0 2 .9 2 2v14c0 1.1-.9 2-2 2zM4 7v14h20V7H4z"/>\n</svg>\n'},379:e=>{e.exports='<svg width="28" height="28" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <rect opacity=".3" x="2" y="5" width="24" height="18" rx="2"/>\n  <path d="M21.2 23h-4v-2h4v2zm-8 0h-4v-2h4v2zm-8 0H4c-1.1 0-2-.9-2-2v-1.3h2V21h1.1v2h.1zm20.6-1.1l-1.8-.8v-3.6h2v3.6c0 .2 0 .5-.2.8zM4 15.7H2v-4h2v4zm22-2.2h-2v-4h2v4zM4 7.7H2V7c0-1.1.9-2 2-2h4v2H4v.7zM24 7h-4V5h4v2zm-8 0h-4V5h4v2z"/>\n</svg>\n'},90905:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path d="M9.79289 5.79285L4.08578 11.5L9.79289 17.2071L11.2071 15.7928L6.91421 11.5L11.2071 7.20706L9.79289 5.79285Z"/>\n  <path d="M14.7929 10.2071L19.0858 14.5L14.7929 18.7928L16.2071 20.2071L21.9142 14.5L16.2071 8.79285L14.7929 10.2071Z"/>\n</svg>\n'},53514:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M5.79289 3.79285L2.08578 7.49995L5.79289 11.2071L7.20711 9.79285L4.91421 7.49995L7.20711 5.20706L5.79289 3.79285Z"/>\n  <path d="M8.79289 7.20706L11.0858 9.49995L8.79289 11.7928L10.2071 13.2071L13.9142 9.49995L10.2071 5.79285L8.79289 7.20706Z"/>\n</svg>\n'},75987:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M7 6C5.89543 6 5 6.89543 5 8V18C5 19.1046 5.89543 20 7 20H19C20.1046 20 21 19.1046 21 18V8C21 6.89543 20.1046 6 19 6H7ZM8 8C7.44772 8 7 8.44772 7 9V17C7 17.5523 7.44772 18 8 18H12V8H8Z"/>\n</svg>\n'},54558:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M14 9H13V10H12V9V11H11V9H8V11H2L2 5H8V7L14 7V9ZM4 7V9H6V7H4Z"/>\n</svg>\n'},28786:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path d="M9 9v8h3v-8zM14 9v8h3v-8z"/>\n</svg>\n'},70636:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M5 5C5 4.44772 5.44772 4 6 4C6.55228 4 7 4.44772 7 5V11C7 11.5523 6.55228 12 6 12C5.44772 12 5 11.5523 5 11V5Z"/>\n  <path d="M9 5C9 4.44772 9.44772 4 10 4C10.5523 4 11 4.44772 11 5V11C11 11.5523 10.5523 12 10 12C9.44772 12 9 11.5523 9 11V5Z"/>\n</svg>\n'},43927:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path class="permission-icon" d="M3 4c-.552 0-1 .448-1 1v5c0 .552.448 1 1 1h7c.552 0 1-.448 1-1v-1.625l2.171 1.899c.323.283.829.053.829-.376v-4.796c0-.43-.506-.659-.829-.376l-2.171 1.899v-1.625c0-.552-.448-1-1-1h-7z"/>\n  <g class="permission-denied">\n    <circle fill="#c30000" cx="4" cy="12" r="4"/>\n    <path d="M2 11h4v2h-4v-2z" fill="#fff"/>\n  </g>\n</svg>\n'},49823:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <mask id="pcams" fill="#fff">\n    <path d="M3 4c-.552 0-1 .448-1 1v5c0 .552.448 1 1 1h7c.552 0 1-.448 1-1v-1.625l2.171 1.899c.323.283.829.053.829-.376v-4.796c0-.43-.506-.659-.829-.376l-2.171 1.899v-1.625c0-.552-.448-1-1-1h-7z"/>\n  </mask>\n  <path class="permission-icon" mask="url(#pcams)" d="M11 8.375l.659-.753-1.659-1.451v2.204h1zm2.171 1.899l.659-.753-.659.753zm0-5.549l.659.753-.659-.753zm-2.171 1.899h-1v2.204l1.659-1.451-.659-.753zm-8-1.625v-2c-1.105 0-2 .895-2 2h2zm0 5v-5h-2v5h2zm0 0h-2c0 1.105.895 2 2 2v-2zm7 0h-7v2h7v-2zm0 0v2c1.105 0 2-.895 2-2h-2zm0-1.625v1.625h2v-1.625h-2zm.341.753l2.171 1.899 1.317-1.505-2.171-1.899-1.317 1.505zm2.171 1.899c.97.849 2.488.16 2.488-1.129h-2c0-.43.506-.659.829-.376l-1.317 1.505zm2.488-1.129v-4.796h-2v4.796h2zm0-4.796c0-1.289-1.518-1.978-2.488-1.129l1.317 1.505c-.323.283-.829.053-.829-.376h2zm-2.488-1.129l-2.171 1.899 1.317 1.505 2.171-1.899-1.317-1.505zm-2.512 1.027v1.625h2v-1.625h-2zm0 0h2c0-1.105-.895-2-2-2v2zm-7 0h7v-2h-7v2z"/>\n  <g class="permission-denied">\n    <circle fill="#c30000" cx="4" cy="12" r="4"/>\n    <path d="M2 11h4v2h-4v-2z" fill="#fff"/>\n  </g>\n</svg>\n'},9326:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path class="permission-icon" d="M6 1.207c0-.445-.539-.669-.854-.354l-2.793 2.793c-.195.195-.195.512 0 .707l2.793 2.793c.315.315.854.092.854-.354v-1.793h5.5c.276 0 .5-.224.5-.5v-1c0-.276-.224-.5-.5-.5h-5.5v-1.793zM10 12.793c0 .445.539.668.854.354l2.793-2.793c.195-.195.195-.512 0-.707l-2.793-2.793c-.315-.315-.854-.092-.854.354v1.793h-5.5c-.276 0-.5.224-.5.5v1c0 .276.224.5.5.5h5.5v1.793z"/>\n  <g class="permission-denied">\n    <circle fill="#c30000" cx="4" cy="12" r="4"/>\n    <path d="M2 11h4v2h-4v-2z" fill="#fff"/>\n  </g>\n</svg>\n'},4072:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path class="permission-icon" d="M5.854 2.354c.195-.195.195-.512 0-.707-.195-.195-.512-.195-.707 0l-2.288 2.288-.106.131c-.151.086-.252.248-.252.434s.102.348.252.434l.106.131 2.288 2.288c.195.195.512.195.707 0 .195-.195.195-.512 0-.707l-1.646-1.646h6.793c.276 0 .5-.224.5-.5s-.224-.5-.5-.5h-6.793l1.646-1.646zM9.646 11.646c-.195.195-.195.512 0 .707.195.195.512.195.707 0l2.288-2.288.106-.131c.151-.086.252-.248.252-.434s-.102-.348-.252-.434l-.106-.131-2.288-2.288c-.195-.195-.512-.195-.707 0-.195.195-.195.512 0 .707l1.646 1.646h-6.793c-.276 0-.5.224-.5.5s.224.5.5.5h6.793l-1.646 1.646z"/>\n  <g class="permission-denied">\n    <circle fill="#c30000" cx="4" cy="12" r="4"/>\n    <path d="M2 11h4v2h-4v-2z" fill="#fff"/>\n  </g>\n</svg>\n'},9027:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path class="permission-icon" d="M3.941 7.92c-.592-.822-.941-1.83-.941-2.92 0-2.761 2.239-5 5-5s5 2.239 5 5c0 1.09-.349 2.099-.941 2.92l-3.191 5.567c-.384.67-1.351.67-1.735 0l-3.191-5.567zm4.059-.92c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z"/>>\n  <g class="permission-denied">\n    <circle fill="#c30000" cx="4" cy="12" r="4"/>\n    <path d="M2 11h4v2h-4v-2z" fill="#fff"/>\n  </g>\n</svg>\n'},36055:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path class="permission-icon" d="M8 2.5c-1.933 0-3.5 1.567-3.5 3.5 0 .763.244 1.468.659 2.044l.015.021 2.393 4.173c.192.335.675.335.868 0l2.393-4.173.015-.021c.414-.574.658-1.28.658-2.044 0-1.933-1.567-3.5-3.5-3.5zm-4.5 3.5c0-2.485 2.015-4.5 4.5-4.5s4.5 2.015 4.5 4.5c0 .971-.308 1.871-.832 2.607l-2.367 4.129c-.576 1.005-2.026 1.005-2.603 0l-2.367-4.129c-.523-.736-.832-1.636-.832-2.607zm2.4 0c0-1.16.94-2.1 2.1-2.1 1.16 0 2.1.94 2.1 2.1 0 1.16-.94 2.1-2.1 2.1-1.16 0-2.1-.94-2.1-2.1zm2.1-1.1c-.608 0-1.1.492-1.1 1.1 0 .608.492 1.1 1.1 1.1.608 0 1.1-.492 1.1-1.1 0-.608-.492-1.1-1.1-1.1z"/>\n  <g class="permission-denied">\n    <circle fill="#c30000" cx="4" cy="12" r="4"/>\n    <path d="M2 11h4v2h-4v-2z" fill="#fff"/>\n  </g>\n</svg>\n'},72272:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path class="permission-icon" d="M4 6V7.333C4 9.358 5.791 11 8 11C10.209 11 12 9.358 12 7.333V6C12 5.448 12.448 5 13 5C13.552 5 14 5.448 14 6V7.667C14 10.31 11.838 12.503 9 12.927V14.001C9 14.553 8.552 15.001 8 15.001C7.448 15.001 7 14.553 7 14.001V12.927C4.162 12.504 2 10.31 2 7.667V6C2 5.448 2.448 5 3 5C3.552 5 4 5.448 4 6ZM5 3C5 1.343 6.343 0 8 0C9.657 0 11 1.343 11 3V7C11 8.657 9.657 10 8 10C6.343 10 5 8.657 5 7V3Z"/>\n  <g class="permission-denied">\n    <circle fill="#c30000" cx="4" cy="12" r="4"/>\n    <path d="M2 11h4v2h-4v-2z" fill="#fff"/>\n  </g>\n</svg>\n'},35237:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <g class="permission-icon">\n    <path d="M3.021 5.5c.276 0 .5.224.5.5 0 .967.148 2.365.786 3.506.616 1.1 1.704 1.994 3.714 1.994s3.098-.894 3.714-1.994c.639-1.14.786-2.539.786-3.506 0-.276.224-.5.5-.5s.5.224.5.5c0 1.033-.152 2.635-.914 3.994-.728 1.299-1.997 2.345-4.086 2.489v1.517c0 .276-.224.5-.5.5s-.5-.224-.5-.5v-1.517c-2.09-.144-3.359-1.19-4.086-2.489-.761-1.36-.914-2.961-.914-3.994 0-.276.224-.5.5-.5z"/>\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M8 1c-1.105 0-2 .895-2 2v4c0 1.105.895 2 2 2s2-.895 2-2v-4c0-1.105-.895-2-2-2zm0-1c-1.657 0-3 1.343-3 3v4c0 1.657 1.343 3 3 3s3-1.343 3-3v-4c0-1.657-1.343-3-3-3z"/>\n  </g>\n  <g class="permission-denied">\n    <circle fill="#c30000" cx="4" cy="12" r="4"/>\n    <path d="M2 11h4v2h-4v-2z" fill="#fff"/>\n  </g>\n</svg>\n'},90077:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <g class="permission-icon">\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M3 1c-.552 0-1 .448-1 1v11c0 .552.448 1 1 1h10c.552 0 1-.448 1-1v-11c0-.552-.448-1-1-1h-10zm1 4h1v4h1v3.4c0 .331-.269.6-.6.6h-.9c-.276 0-.5-.224-.5-.5v-7.5zm3 0h2v7.5c0 .276-.224.5-.5.5h-1c-.276 0-.5-.224-.5-.5v-7.5zm3 7.5v-3.5h1v-4h1v7.5c0 .276-.224.5-.5.5h-1c-.276 0-.5-.224-.5-.5z"/>\n  </g>\n  <g class="permission-denied">\n    <circle fill="#c30000" cx="4" cy="12" r="4"/>\n    <path d="M2 11h4v2h-4v-2z" fill="#fff"/>\n  </g>\n</svg>\n'},59301:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <g class="permission-icon">\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M4 2c-.552 0-1 .448-1 1v9c0 .552.448 1 1 1h8c.552 0 1-.448 1-1v-9c0-.552-.448-1-1-1h-8zm1 3h-1v6.5c0 .276.224.5.5.5h.9c.331 0 .6-.269.6-.6v-3.4h-1v-3zm2 0h2v6.5c0 .276-.224.5-.5.5h-1c-.276 0-.5-.224-.5-.5v-6.5zm3 3v3.5c0 .276.224.5.5.5h1c.276 0 .5-.224.5-.5v-6.5h-1v3h-1z"/>\n  </g>\n  <g class="permission-denied">\n    <circle fill="#c30000" cx="4" cy="12" r="4"/>\n    <path d="M2 11h4v2h-4v-2z" fill="#fff"/>\n  </g>\n</svg>\n'},22485:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path class="permission-icon" d="M9 3.308c1.722.408 3 1.95 3 3.692v2.586c0 .265.105.52.293.707l.414.414c.188.188.293.442.293.707v.088c0 .276-.224.5-.5.5h-9c-.276 0-.5-.224-.5-.5v-.088c0-.265.105-.52.293-.707l.414-.414c.188-.188.293-.442.293-.707v-2.586c.047-1.742 1.294-3.284 3-3.692v-.308c0-.598.518-1 1-1 .514 0 1 .402 1 1v.308zm-2.5 10.192c0-.175.03-.344.085-.5h2.829c.055.156.085.325.085.5 0 .828-.672 1.5-1.5 1.5s-1.5-.672-1.5-1.5z"/>\n  <g class="permission-denied">\n    <circle fill="#c30000" cx="4" cy="12" r="4"/>\n    <path d="M2 11h4v2h-4v-2z" fill="#fff"/>\n  </g>\n</svg>\n'},62067:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path class="permission-icon" d="M8 4.099v-.002l-.767.184c-1.262.302-2.192 1.45-2.233 2.734v2.778c0 .398-.158.779-.439 1.061l-.148.148h7.175l-.148-.148c-.281-.281-.439-.663-.439-1.061v-2.793c0-1.251-.932-2.411-2.231-2.719l-.769-.182zm-4 2.901c.047-1.742 1.294-3.284 3-3.692v-.308c0-.598.518-1 1-1 .514 0 1 .402 1 1v.308c1.722.408 3 1.95 3 3.692v2.793c0 .133.053.26.146.354l.707.707c.094.094.146.221.146.354v.295c0 .276-.224.5-.5.5h-9c-.276 0-.5-.224-.5-.5v-.295c0-.133.053-.26.146-.354l.707-.707c.094-.094.146-.221.146-.354v-2.793zm2.585 6.002c-.055.156-.085.323-.085.498s.03.344.085.5c.206.583.762 1 1.415 1s1.209-.417 1.415-1c.055-.156.085-.325.085-.5s-.03-.342-.085-.498l-.001-.002h-2.829l-.001.002z"/>\n  <g class="permission-denied">\n    <circle fill="#c30000" cx="4" cy="12" r="4"/>\n    <path d="M2 11h4v2h-4v-2z" fill="#fff"/>\n  </g>\n</svg>\n'},49989:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <g class="permission-icon">\n    <path opacity="0.5" d="M3 9C3 9.55228 2.55228 10 2 10V10C1.44772 10 1 9.55228 1 9V2C1 1.44772 1.44772 1 2 1H9C9.55228 1 10 1.44772 10 2V2C10 2.55228 9.55228 3 9 3H3.5C3.22386 3 3 3.22386 3 3.5V9Z"/>\n    <path d="M5 4C4.44772 4 4 4.44772 4 5V12C4 12.5523 4.44772 13 5 13H12C12.5523 13 13 12.5523 13 12V5C13 4.44772 12.5523 4 12 4H5ZM6 6.5C6 6.22386 6.22386 6 6.5 6H10.5C10.7761 6 11 6.22386 11 6.5V10.5C11 10.7761 10.7761 11 10.5 11H6.5C6.22386 11 6 10.7761 6 10.5V6.5Z" />\n  </g>\n  <g class="permission-denied">\n    <circle fill="#c30000" cx="4" cy="12" r="4"/>\n    <path d="M2 11h4v2h-4v-2z" fill="#fff"/>\n  </g>\n</svg>\n'},23217:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <g class="permission-icon">\n    <path opacity=".5" d="M4 10.5c0 .276-.224.5-.5.5s-.5-.224-.5-.5v-7.5c0-.552.448-1 1-1h7.5c.276 0 .5.224.5.5s-.224.5-.5.5h-7c-.276 0-.5.224-.5.5v7z"/>\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M6 5v6h6v-6h-6zm-.5-1c-.276 0-.5.224-.5.5v7c0 .276.224.5.5.5h7c.276 0 .5-.224.5-.5v-7c0-.276-.224-.5-.5-.5h-7z"/>\n  </g>\n  <g class="permission-denied">\n    <circle fill="#c30000" cx="4" cy="12" r="4"/>\n    <path d="M2 11h4v2h-4v-2z" fill="#fff"/>\n  </g>\n</svg>\n'},33520:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M13.58 2.153l.077.067c3.124 3.124 3.124 8.19 0 11.314-.293.293-.768.293-1.061 0-.293-.293-.293-.768 0-1.061 2.538-2.538 2.538-6.654 0-9.192-.293-.293-.293-.768 0-1.061.268-.268.69-.291.984-.067zm-10.176.067c.268.268.291.69.067.984l-.067.077c-2.483 2.483-2.537 6.476-.162 9.025l.162.168c.293.293.293.768 0 1.061-.293.293-.768.293-1.061 0-3.124-3.124-3.124-8.19 0-11.314.293-.293.768-.293 1.061 0zm8.055 2.054l.077.067c1.953 1.953 1.953 5.118 0 7.071-.293.293-.768.293-1.061 0-.293-.293-.293-.768 0-1.061 1.367-1.367 1.367-3.583 0-4.95-.293-.293-.293-.768 0-1.061.268-.268.69-.291.984-.067zm-5.934.067c.268.268.291.69.067.984l-.067.077c-1.321 1.321-1.365 3.436-.132 4.81l.132.139c.293.293.293.768 0 1.061-.293.293-.768.293-1.061 0-1.953-1.953-1.953-5.118 0-7.071.293-.293.768-.293 1.061 0zm2.475 1.536c1.105 0 2 .895 2 2s-.895 2-2 2-2-.895-2-2 .895-2 2-2z"/>\n  <g class="permission-denied">\n    <circle fill="#c30000" cx="4" cy="12" r="4"/>\n    <path d="M2 11h4v2h-4v-2z" fill="#fff"/>\n  </g>\n</svg>\n'},80490:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M13.3 2c.126 0 .241.047.329.124l.027.029c3.047 3.047 3.122 7.94.226 11.078l-.193.202c-.092.114-.232.187-.39.187-.276 0-.5-.224-.5-.5 0-.141.058-.268.151-.358l-.002-.002c2.734-2.734 2.734-7.166 0-9.899-.092-.093-.15-.22-.15-.36 0-.276.224-.5.5-.5zm-10.6 0c.276 0 .5.224.5.5 0 .141-.058.268-.15.36-2.672 2.672-2.732 6.965-.182 9.711l.182.189c.092.093.15.22.15.36 0 .276-.224.5-.5.5-.126 0-.242-.047-.33-.124l-.254-.265c-2.833-3.07-2.822-7.819.032-10.877l.222-.23c.088-.077.203-.124.33-.124zm8.5 2.145c.097 0 .188.028.264.075l.071.054c1.893 1.893 1.951 4.928.172 6.89l-.186.193c-.087.073-.199.118-.322.118-.276 0-.5-.224-.5-.5 0-.097.027-.187.075-.263l.053-.073c1.562-1.562 1.562-4.095 0-5.657-.079-.089-.128-.207-.128-.337 0-.276.224-.5.5-.5zm-6.4 0c.276 0 .5.224.5.5 0 .129-.049.247-.128.337-1.51 1.51-1.56 3.927-.151 5.498l.151.159.054.073c.047.076.075.167.075.263 0 .276-.224.5-.5.5-.092 0-.178-.025-.252-.068l-.07-.049-.186-.193c-1.725-1.903-1.723-4.814.005-6.715l.167-.175.071-.054c.077-.048.167-.075.264-.075zm3.2 1.665c1.105 0 2 .895 2 2s-.895 2-2 2-2-.895-2-2 .895-2 2-2z"/>\n  <g class="permission-denied">\n    <circle fill="#c30000" cx="4" cy="12" r="4"/>\n    <path d="M2 11h4v2h-4v-2z" fill="#fff"/>\n  </g>\n</svg>\n'},61063:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M2 9.99988H0V14.9998C0 15.5521 0.447715 15.9998 1 15.9998H15C15.5523 15.9998 16 15.5521 16 14.9998V9.99988H14V13.9998H2V9.99988Z"/>\n  <path d="M10 1C10 0.447715 9.55228 0 9 0H7C6.44772 0 6 0.447715 6 1V5.99995H3L8 10.9999L13 5.99995H10V1Z"/>\n</svg>\n'},64916:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M14.0046 2C15.1092 2 16 2.89543 16 4V12C16 13.1046 15.1077 14 14.0031 14C10.988 14 5.77574 14 1.99884 14C0.894274 14 0 13.1046 0 12V4C0 2.89543 0.890411 2 1.99498 2C5.09826 2 10.9258 2 14.0046 2ZM6 12.0418V4.01465H3C2.44772 4.01465 2 4.46068 2 5.01297C2 6.48887 2 9.25247 2 10.8705C2 10.9217 2 10.9797 2 11.0417C2 11.594 2.44772 12.0418 3 12.0418H6Z"/>\n</svg>\n'},20277:e=>{e.exports='<svg  viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M8 1C4.134 1 1 4.134 1 8C1 11.866 4.134 15 8 15C11.866 15 15 11.866 15 8C15 4.134 11.866 1 8 1ZM3 8C3 7.216 3.197 6.484 3.52 5.823C3.522 5.829 3.524 5.839 3.527 5.844L4.125 7.106C4.173 7.209 4.306 7.295 4.419 7.295H4.665C4.778 7.295 4.918 7.376 4.974 7.474L5.492 8.367C5.549 8.467 5.672 8.602 5.764 8.668L6.868 9.463C6.959 9.531 7.128 9.584 7.24 9.584H7.587C7.7 9.584 7.792 9.679 7.792 9.792V11.096C7.792 11.211 7.884 11.304 7.998 11.304H8.231C8.343 11.304 8.435 11.398 8.435 11.513V11.751C8.435 11.866 8.343 11.96 8.231 11.96H7.998C7.884 11.96 7.792 12.053 7.792 12.168V12.979C5.133 12.867 3 10.686 3 8ZM10.372 12.374C10.435 12.297 10.497 12.209 10.531 12.136L11.055 11.01C11.103 10.907 11.143 10.728 11.143 10.613V10.55C11.143 10.435 11.06 10.296 10.961 10.243L9.223 9.319C9.123 9.266 8.948 9.223 8.836 9.221H7.472C7.36 9.221 7.195 9.162 7.107 9.09L6.29 8.423C6.202 8.35 6.131 8.198 6.131 8.083L6.134 7.503C6.135 7.389 6.227 7.295 6.34 7.295H6.893C7.007 7.295 7.099 7.389 7.099 7.503V8.222C7.099 8.336 7.191 8.43 7.304 8.43H7.36C7.473 8.43 7.566 8.336 7.566 8.222L7.565 6.974C7.565 6.858 7.639 6.708 7.729 6.638L8.143 6.316C8.233 6.246 8.398 6.189 8.511 6.189H9.523C9.636 6.189 9.728 6.119 9.728 6.031C9.728 5.944 9.636 5.872 9.523 5.872H9.193C9.08 5.872 8.988 5.779 8.988 5.664L8.99 4.913C8.99 4.797 8.896 4.703 8.785 4.703H8.492C8.379 4.702 8.35 4.635 8.427 4.551L8.866 4.08C8.944 3.996 9.007 3.854 9.007 3.761C9.007 3.667 8.915 3.592 8.802 3.592H8.497C8.385 3.592 8.217 3.537 8.125 3.471L7.741 3.197C7.692 3.162 7.65 3.103 7.619 3.038C7.747 3.029 7.87 3 8 3C8.433 3 8.846 3.073 9.247 3.177C9.25 3.289 9.339 3.38 9.45 3.38H9.747C9.86 3.38 9.952 3.474 9.952 3.589V4.268C9.952 4.384 10.044 4.478 10.157 4.478H10.246C10.359 4.478 10.525 4.422 10.616 4.353C10.616 4.353 10.792 4.215 11.013 4.036C12.213 4.951 13 6.379 13 8C13 9.894 11.929 11.526 10.372 12.374Z"/>\n</svg>\n'},37028:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M8 13c3.636 0 6.764-2.067 8-5-1.236-2.933-4.364-5-8-5s-6.764 2.067-8 5c1.236 3.035 4.364 5 8 5zm0-1c2.209 0 4-1.791 4-4s-1.791-4-4-4-4 1.791-4 4 1.791 4 4 4zm0-2c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z"/>\n</svg>\n'},96970:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M8 11c2.273 0 4.161-1.276 5.033-3-.872-1.724-2.76-3-5.033-3-2.276 0-4.166 1.28-5.037 3.007C3.827 9.777 5.707 11 8 11zm0 1c-2.727 0-5.073-1.572-6-4 .927-2.346 3.273-4 6-4s5.073 1.654 6 4c-.927 2.346-3.273 4-6 4zm1-4a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm1 0a2 2 0 1 1-4 0 2 2 0 0 1 4 0z"/>\n</svg>\n'},27063:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M2 2h11a1 1 0 0 1 1 1v9a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1ZM0 3a2 2 0 0 1 2-2h11a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3Zm6.46.803a.5.5 0 0 0-.92 0L4.17 7H2.5a.5.5 0 0 0 0 1h2a.5.5 0 0 0 .46-.303L6 5.269l2.54 5.928a.5.5 0 0 0 .92 0L10.83 8h1.67a.5.5 0 0 0 0-1h-2a.5.5 0 0 0-.46.303L9 9.731 6.46 3.803Z"/>\n</svg>'},51491:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 70 80">\n  <path d="M35.002 0c-.772 0-1.549.028-2.33.083-8.999.87-17.366 5.457-23.425 12.843C3.188 20.312-.113 29.951.003 39.91v33.27c-.001.482.084.96.252 1.406.167.446.414.851.724 1.192.31.34.679.61 1.084.792a3.045 3.045 0 002.535-.01 3.25 3.25 0 001.061-.797c.82-.905 1.933-1.413 3.093-1.413s2.273.508 3.094 1.413l2.563 2.825c.82.905 1.933 1.413 3.093 1.413s2.273-.508 3.094-1.413l2.562-2.825c.82-.905 1.933-1.413 3.094-1.413 1.16 0 2.273.508 3.093 1.413l2.563 2.825C32.728 79.492 33.84 80 35 80s2.273-.508 3.094-1.413l2.563-2.825c.82-.905 1.933-1.413 3.093-1.413s2.273.508 3.093 1.413l2.563 2.825c.82.905 1.933 1.413 3.094 1.413 1.16 0 2.273-.508 3.093-1.413l2.563-2.825c.82-.905 1.933-1.413 3.093-1.413s2.273.508 3.094 1.413c.302.34.662.611 1.06.796a3.042 3.042 0 002.535.01 3.305 3.305 0 001.085-.791c.31-.34.557-.746.724-1.192.168-.445.253-.924.252-1.406V38.587c0-10.234-3.688-20.048-10.251-27.285C53.185 4.066 44.284 0 35 0zm-8.75 36.176c0 1.43-.385 2.83-1.106 4.02-.721 1.189-1.746 2.116-2.945 2.664-1.2.547-2.519.69-3.792.412-1.272-.28-2.442-.969-3.36-1.98-.917-1.012-1.542-2.302-1.795-3.705a7.927 7.927 0 01.373-4.18c.497-1.322 1.338-2.452 2.417-3.247a6.137 6.137 0 013.646-1.22c1.74 0 3.41.763 4.64 2.12 1.23 1.356 1.922 3.197 1.922 5.116zm30.624 0c0 1.43-.385 2.83-1.106 4.02-.722 1.189-1.746 2.116-2.945 2.664-1.2.547-2.519.69-3.792.412-1.273-.28-2.442-.969-3.36-1.98-.918-1.012-1.543-2.302-1.796-3.705a7.928 7.928 0 01.374-4.18c.496-1.322 1.337-2.452 2.417-3.247a6.137 6.137 0 013.645-1.22c1.74 0 3.41.763 4.64 2.12 1.231 1.356 1.923 3.197 1.923 5.116z" fill="url(#private-ghost-gradient)"/>\n</svg>\n'},2018:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path d="M8 2c-.11 0-.221.004-.333.013-1.285.13-2.48.818-3.346 1.926-.866 1.108-1.337 2.554-1.32 4.047v4.99c0 .073.011.145.035.212a.56.56 0 00.104.178.474.474 0 00.155.12.419.419 0 00.362-.002.468.468 0 00.151-.12.585.585 0 01.442-.212c.166 0 .325.077.442.212l.366.424A.585.585 0 005.5 14a.585.585 0 00.442-.212l.366-.424a.585.585 0 01.442-.212c.166 0 .325.077.442.212l.366.424A.585.585 0 008 14a.585.585 0 00.442-.212l.366-.424a.585.585 0 01.442-.212c.166 0 .325.077.442.212l.366.424A.585.585 0 0010.5 14a.585.585 0 00.442-.212l.366-.424a.585.585 0 01.442-.212c.166 0 .325.077.442.212a.469.469 0 00.152.12.411.411 0 00.362.001.474.474 0 00.155-.118.56.56 0 00.103-.18.623.623 0 00.036-.21V7.788c0-1.535-.527-3.007-1.464-4.093C10.598 2.61 9.326 2 8 2zM6.75 7.426c0 .215-.055.425-.158.603a.982.982 0 01-.42.4.82.82 0 01-.542.062.906.906 0 01-.48-.297 1.147 1.147 0 01-.257-.556 1.245 1.245 0 01.054-.627c.07-.198.19-.368.345-.487a.85.85 0 01.52-.183c.25 0 .488.114.664.318.176.203.274.48.274.767zm4.375 0c0 .215-.055.425-.158.603a.982.982 0 01-.42.4.82.82 0 01-.542.062.906.906 0 01-.48-.297 1.147 1.147 0 01-.257-.556 1.245 1.245 0 01.054-.627c.07-.198.19-.368.345-.487a.85.85 0 01.52-.183c.25 0 .488.114.664.318.175.203.274.48.274.767z"/>\n</svg>\n'},34166:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M3 3H5V5H3V3ZM2 2H3H5H6V3V5V6H5H3H2V5V3V2ZM10 3H13V6H10V3ZM9 2H10H13H14V3V6V7H13H10H9V6V3V2ZM6 10H3V13H6V10ZM3 9H2V10V13V14H3H6H7V13V10V9H11V10H12V11H11V12H10H9V11H10V10H9H8V11V12H9V13V14H10V13H11H12V14H13V13H14V11H13V10H14V9H13V8H12V9H11V8H7V9H6H3ZM12 9H13V10H12V9ZM13 11H12V13H13V11ZM6 7H2V8H6V7ZM8 7V4H7V7H8ZM8 2V3L7 3V2H8ZM11 4H12V5H11V4ZM5 11H4V12H5V11Z"/>\n</svg>\n'},48783:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12">\n  <path d="M10 0H2a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zM5 9H3V3h2zm4 0H7V3h2z"/>\n</svg>'},83035:e=>{e.exports='<svg width="72" height="72" xmlns="http://www.w3.org/2000/svg">\n    <path d="M71 52a1 1 0 00-1-1H36a1 1 0 00-1 1v7a1 1 0 001 1h34a1 1 0 001-1v-7z" fill-opacity=".3"/>\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M2.397 10.5c-1.333 0-2.004 1.608-1.066 2.555l15.435 15.593a.5.5 0 010 .704L1.331 44.945c-.938.947-.267 2.555 1.066 2.555h6.095c.4 0 .784-.16 1.066-.445l16.828-17a1.5 1.5 0 000-2.11l-16.828-17a1.5 1.5 0 00-1.066-.445H2.397zm-.355 1.852a.5.5 0 01.355-.852h6.095a.5.5 0 01.355.148l16.828 17a.5.5 0 010 .704l-16.828 17a.5.5 0 01-.355.148H2.397a.5.5 0 01-.355-.852l15.435-15.593a1.5 1.5 0 000-2.11L2.042 12.352zM20.215 10.5c-1.332 0-2.003 1.608-1.066 2.555l15.436 15.593a.5.5 0 010 .704L19.149 44.945c-.937.947-.267 2.555 1.066 2.555h10.55c.4 0 .784-.16 1.066-.445l16.828-17a1.5 1.5 0 000-2.11l-16.828-17a1.5 1.5 0 00-1.066-.445h-10.55zm-.355 1.852a.5.5 0 01.355-.852h10.55a.5.5 0 01.355.148l16.828 17a.5.5 0 010 .704l-16.828 17a.5.5 0 01-.355.148h-10.55a.5.5 0 01-.355-.852l15.435-15.593a1.5 1.5 0 000-2.11L19.86 12.352zM36 50.5a1.5 1.5 0 00-1.5 1.5v7a1.5 1.5 0 001.5 1.5h34a1.5 1.5 0 001.5-1.5v-7a1.5 1.5 0 00-1.5-1.5H36zm-.5 1.5a.5.5 0 01.5-.5h34a.5.5 0 01.5.5v7a.5.5 0 01-.5.5H36a.5.5 0 01-.5-.5v-7z"/>\n</svg>\n'},19222:e=>{e.exports='<svg width="26" height="26" xmlns="http://www.w3.org/2000/svg">\n  <path d="M6.207 9.207a.707.707 0 1 1 1-1l3.086 3.086a1 1 0 0 1 0 1.414l-3.086 3.086a.707.707 0 0 1-1-1l2.086-2.086a1 1 0 0 0 0-1.414L6.207 9.207z"/>\n  <path d="M10.707 9.707c-.63-.63-.184-1.707.707-1.707h.172a1 1 0 0 1 .707.293l3 3a1 1 0 0 1 0 1.414l-3 3a1 1 0 0 1-.707.293h-.172c-.89 0-1.337-1.077-.707-1.707l1.586-1.586a1 1 0 0 0 0-1.414l-1.586-1.586zM21 18a1 1 0 0 0-1-1h-6a1 1 0 1 0 0 2h6a1 1 0 0 0 1-1z"/>\n</svg>\n'},24319:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M1.20711 4.20711C0.761654 3.76165 1.07714 3 1.70711 3C1.89464 3 2.0745 3.0745 2.20711 3.20711L5.29289 6.29289C5.68342 6.68342 5.68342 7.31658 5.29289 7.70711L2.20711 10.7929C2.0745 10.9255 1.89464 11 1.70711 11C1.07714 11 0.761653 10.2383 1.20711 9.79289L3.29289 7.70711C3.68342 7.31658 3.68342 6.68342 3.29289 6.29289L1.20711 4.20711Z"/>\n  <path d="M5.70711 4.70711C5.07714 4.07714 5.52331 3 6.41421 3H6.58579C6.851 3 7.10536 3.10536 7.29289 3.29289L10.2929 6.29289C10.6834 6.68342 10.6834 7.31658 10.2929 7.70711L7.29289 10.7071C7.10536 10.8946 6.851 11 6.58579 11H6.41421C5.52331 11 5.07714 9.92286 5.70711 9.29289L7.29289 7.70711C7.68342 7.31658 7.68342 6.68342 7.29289 6.29289L5.70711 4.70711Z"/>\n  <path d="M16 13C16 12.4477 15.5523 12 15 12H9C8.44771 12 8 12.4477 8 13C8 13.5523 8.44771 14 9 14H15C15.5523 14 16 13.5523 16 13Z"/>\n</svg>\n'},50983:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M3 4h10v1H3zM3 6h10v1H3zM3 8h10v1H3zM3 10h6v1H3z"/>\n</svg>\n'},44425:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M1 8h14v1h-14zM1 6h14v1h-14zM1 4h14v1h-14zM1 10h8v1h-8z"/></svg>'},38037:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M5 1h1v8h-1zM7 1h1v14h-1zM9 1h1v14h-1zM11 1h1v14h-1z"/></svg>'},70204:e=>{e.exports='<svg width="26" height="26" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M11 5H6a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h5c0 .552.895 1 2 1s2-.448 2-1h5a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-5a2 2 0 0 0-2 2 2 2 0 0 0-2-2zm8 4V8h-5v1h5zm-7 0V8H7v1h5zm7 1v1h-5v-1h5zm0 3v-1h-5v1h5zm0 1v1h-5v-1h5zm-7-3v-1H7v1h5zm0 1v1H7v-1h5zm0 3v-1H7v1h5z"/>\n</svg>\n'},92484:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M6 1H1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h5c0 .552.895 1 2 1s2-.448 2-1h5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1h-5a2 2 0 0 0-2 2 2 2 0 0 0-2-2zm8 4V4H9v1h5zM7 5V4H2v1h5zm7 1v1H9V6h5zm0 3V8H9v1h5zm0 1v1H9v-1h5zM7 7V6H2v1h5zm0 1v1H2V8h5zm0 3v-1H2v1h5z"/>\n</svg>\n'},8797:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M1.875 2h5.25c.483 0 .875.384.875.857C8 2.384 8.392 2 8.875 2h5.25c.483 0 .875.384.875.857v10.286a.866.866 0 0 1-.875.857h-4.71c-.206.291-.762.5-1.415.5s-1.209-.209-1.415-.5h-4.71A.866.866 0 0 1 1 13.143V2.857C1 2.384 1.392 2 1.875 2zM7 4v1H3V4h4zm6 0v1H9V4h4zm0 2v1H9V6h4zm0 2v1H9V8h4zm0 2v1H9v-1h4zM7 6v1H3V6h4zm0 2v1H3V8h4zm0 2v1H3v-1h4z"/>\n</svg>\n'},106:e=>{e.exports='<svg width="26" height="26" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M6 6h5a2 2 0 0 1 2 2 2 2 0 0 1 2-2h5a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1h-5c0 .552-.895 1-2 1s-2-.448-2-1H6a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1zm1 11.5a.5.5 0 0 0 .5.5H12c.182 0 .353.049.5.134V9a1 1 0 0 0-1-1h-4a.5.5 0 0 0-.5.5v9zM13 9a1 1 0 0 1 1-1h4.5a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5H14a1 1 0 0 0-1 1V9z"/>\n  <path opacity=".5" d="M12 9v1H8V9h4zm6 0v1h-4V9h4zm0 2v1h-4v-1h4zm0 2v1h-4v-1h4zm0 2v1h-4v-1h4zm-6-4v1H8v-1h4zm0 2v1H8v-1h4zm0 2v1H8v-1h4zm-4.5 3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 0 .5.5H12c.182 0 .353.049.5.134v1A.995.995 0 0 0 12 18H7.5zm5.5 0a1 1 0 0 1 1-1h4.5a.5.5 0 0 0 .5-.5v1a.5.5 0 0 1-.5.5H14a1 1 0 0 0-1 1v-1z"/>\n</svg>\n'},66510:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M1 1h5a2 2 0 0 1 2 2 2 2 0 0 1 2-2h5a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1h-5c0 .552-.895 1-2 1s-2-.448-2-1H1a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zm1 11.5a.5.5 0 0 0 .5.5H7c.182 0 .353.049.5.134V4a1 1 0 0 0-1-1h-4a.5.5 0 0 0-.5.5v9zM8 4a1 1 0 0 1 1-1h4.5a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5H9a1 1 0 0 0-1 1V4z"/>\n  <path opacity=".5" d="M7 4v1H3V4h4zm6 0v1H9V4h4zm0 2v1H9V6h4zm0 2v1H9V8h4zm0 2v1H9v-1h4zM7 6v1H3V6h4zm0 2v1H3V8h4zm0 2v1H3v-1h4zm-4.5 3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 0 .5.5H7c.182 0 .353.049.5.134v1A.995.995 0 0 0 7 13H2.5zM8 13a1 1 0 0 1 1-1h4.5a.5.5 0 0 0 .5-.5v1a.5.5 0 0 1-.5.5H9a1 1 0 0 0-1 1v-1z"/>\n</svg>\n'},81789:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M1.875 2h5.25c.483 0 .875.384.875.857C8 2.384 8.392 2 8.875 2h5.25c.483 0 .875.384.875.857v10.286a.866.866 0 0 1-.875.857h-4.71c-.206.291-.762.5-1.415.5s-1.209-.209-1.415-.5h-4.71A.866.866 0 0 1 1 13.143V2.857C1 2.384 1.392 2 1.875 2zM2.5 3a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5H7c.182 0 .353.049.5.134V4a1 1 0 0 0-1-1h-4zM8 4v10a1 1 0 0 1 1-1h4.5a.5.5 0 0 0 .5-.5v-9a.5.5 0 0 0-.5-.5H9a1 1 0 0 0-1 1z"/>\n  <path opacity=".5" fill-rule="evenodd" d="M7 4v1H3V4h4zm6 0v1H9V4h4zm0 2v1H9V6h4zm0 2v1H9V8h4zm0 2v1H9v-1h4zM7 6v1H3V6h4zm0 2v1H3V8h4zm0 2v1H3v-1h4zm-4.5 3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 0 .5.5H7c.182 0 .353.049.5.134v1A.995.995 0 0 0 7 13H2.5zM8 13a1 1 0 0 1 1-1h4.5a.5.5 0 0 0 .5-.5v1a.5.5 0 0 1-.5.5H9a1 1 0 0 0-1 1v-1z"/>\n</svg>\n'},46708:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M7.35355 1.64645C7.15829 1.45118 6.84171 1.45118 6.64645 1.64645C6.45118 1.84171 6.45118 2.15829 6.64645 2.35355L8.29289 4H3.5C2.11929 4 1 5.11929 1 6.5V9.5C1 10.8807 2.11929 12 3.5 12V11C2.67157 11 2 10.3284 2 9.5V6.5C2 5.67157 2.67157 5 3.5 5H8.29289L6.64645 6.64645C6.45118 6.84171 6.45118 7.15829 6.64645 7.35355C6.84171 7.54882 7.15829 7.54882 7.35355 7.35355L9.85355 4.85355C9.90149 4.80561 9.93766 4.75036 9.96206 4.69139C9.98425 4.63777 9.9967 4.58107 9.99943 4.52399C9.99981 4.516 10 4.508 10 4.5M9.96206 4.30861C9.93766 4.24964 9.90149 4.19439 9.85355 4.14645L7.35355 1.64645M9.96206 4.30861C9.98615 4.36669 9.9996 4.4303 9.99999 4.497Z"/>\n  <path fill-rule="evenodd" d="M15 6.5C15 5.11929 13.8807 4 12.5 4V5C13.3284 5 14 5.67157 14 6.5V9.5C14 10.3284 13.3284 11 12.5 11H7.70711L9.35355 9.35355C9.54882 9.15829 9.54882 8.84171 9.35355 8.64645C9.15829 8.45118 8.84171 8.45118 8.64645 8.64645L6.14645 11.1464C5.95118 11.3417 5.95118 11.6583 6.14645 11.8536L8.64645 14.3536C8.84171 14.5488 9.15829 14.5488 9.35355 14.3536C9.54882 14.1583 9.54882 13.8417 9.35355 13.6464L7.70711 12H12.5C13.8807 12 15 10.8807 15 9.5V6.5Z"/>\n</svg>\n'},91086:e=>{e.exports='<svg width="26" height="26" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M8 13a1 1 0 001 1h8a1 1 0 100-2H9a1 1 0 00-1 1z"/>\n</svg>\n'},58579:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M4 8C4 8.55228 4.44772 9 5 9H11C11.5523 9 12 8.55228 12 8C12 7.44772 11.5523 7 11 7H5C4.44772 7 4 7.44772 4 8Z"/>\n</svg>\n'},78670:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <rect x="4" y="8" width="8" height="1" rx="0.5"/>\n</svg>\n'},47062:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n      <path d="M13 6c-3.866 0-7 3.133-7 7h2c0-2.758 2.243-5 5-5s5 2.242 5 5c0 2.757-2.243 5-5 5-1.61 0-3.03-.78-3.946-1.966H6.7C7.83 18.378 10.222 20 13 20c3.866 0 7-3.135 7-7 0-3.867-3.134-7-7-7"/>\n      <path d="M13 13H6V6l7 7z"/>\n    <path d="M12 11h2v4h-2z"/>\n</svg>'},52381:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M7.60744 11.9857C6.6858 11.895 5.82411 11.4876 5.16904 10.833L5.16806 10.832L5.17 10.8301C5.00333 10.6634 4.40001 10.6 4.00001 11C3.60003 11.4 3.59334 12.0733 3.75998 12.24L3.75736 12.2427C3.99548 12.4807 4.25234 12.6975 4.5238 12.8904C5.37123 13.4928 6.36578 13.8681 7.4119 13.9711C8.79334 14.1072 10.1792 13.76 11.3334 12.9888C12.4876 12.2176 13.3387 11.0701 13.7416 9.74172C14.1446 8.41336 14.0745 6.98638 13.5433 5.70391C13.0121 4.42144 12.0526 3.36284 10.8284 2.70848C9.60416 2.05412 8.19092 1.84449 6.82946 2.1153C5.468 2.38611 4.24256 3.12061 3.36194 4.19365C3.3366 4.22452 3.3116 4.25561 3.28693 4.28693L1.85355 2.85355C1.53857 2.53857 1 2.76165 1 3.20711V8H5.79289C6.23835 8 6.46143 7.46143 6.14645 7.14645L4.71252 5.71252C4.77282 5.62587 4.83671 5.54137 4.90409 5.45926C5.49191 4.74301 6.30989 4.25273 7.21866 4.07196C8.12744 3.8912 9.07078 4.03113 9.88795 4.46791C10.7051 4.9047 11.3456 5.61132 11.7001 6.46736C12.0547 7.32341 12.1015 8.27592 11.8325 9.1626C11.5636 10.0493 10.9955 10.8153 10.2251 11.33C9.45464 11.8448 8.52956 12.0765 7.60744 11.9857Z"/>\n  <path d="M8 6.00001C7.44772 6.00001 7 6.44772 7 7.00001V9.00001C7 9.55229 7.44772 10 8 10C8.55228 10 9 9.55229 9 9.00001V7.00001C9 6.44772 8.55228 6.00001 8 6.00001Z"/>\n</svg>\n'},44474:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M5.01415 3.98943C4.43062 4.42386 3.9526 4.97755 3.60883 5.60883L2 4V8H6L4.47786 6.47786C4.74354 5.86311 5.16683 5.32572 5.70868 4.92232C6.3855 4.41843 7.20954 4.15169 8.05325 4.16341C8.89697 4.17512 9.71329 4.46462 10.3759 4.9871C11.0384 5.50958 11.5103 6.2359 11.7184 7.05362C11.9265 7.87134 11.8593 8.73487 11.5271 9.51053C11.1949 10.2862 10.6163 10.9307 9.88088 11.3443C9.14542 11.758 8.29413 11.9176 7.45877 11.7986C6.62397 11.6797 5.85162 11.289 5.26111 10.6871L5.25992 10.6859L4.42936 11.5001C4.66585 11.7413 4.92474 11.9566 5.20151 12.1435C5.82559 12.565 6.5406 12.8426 7.29472 12.95C8.38328 13.1051 9.49262 12.8971 10.451 12.358C11.4094 11.819 12.1634 10.9792 12.5962 9.96839C13.0291 8.95762 13.1167 7.83235 12.8455 6.76676C12.5743 5.70117 11.9594 4.7547 11.096 4.07385C10.2326 3.393 9.16885 3.01574 8.0694 3.00048C6.96994 2.98522 5.89612 3.3328 5.01415 3.98943Z"/>\n  <path d="M8 6C7.44772 6 7 6.44772 7 7V9C7 9.55229 7.44772 10 8 10C8.55228 10 9 9.55229 9 9V7C9 6.44772 8.55228 6 8 6Z"/>\n</svg>\n'},71303:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n    <path d="M16 13l-6 5V8l6 5z" />\n</svg>'},19423:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M10.2929 7.29289C10.6834 7.68342 10.6834 8.31658 10.2929 8.70711L7.70711 11.2929C7.07714 11.9229 6 11.4767 6 10.5858L6 5.41421C6 4.52331 7.07714 4.07714 7.70711 4.70711L10.2929 7.29289Z"/>\n</svg>\n'},59098:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <polygon points="6,5 10,8.5 6,12"></polygon>\n</svg>'},55592:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72">\n  <path fill-rule="evenodd" d="M66.27 66.27C60.55 72 51.77 72 36 72c-15.78 0-24.55 0-30.27-5.73C0 60.54 0 51.77 0 36S0 11.46 5.73 5.73C11.45 0 20.23 0 36 0c15.78 0 24.55 0 30.27 5.73C72 11.46 72 20.23 72 36s0 24.54-5.73 30.27zM52.71 54.32a2.8 2.8 0 002.86-2.97A38.63 38.63 0 0020.02 15.8a2.8 2.8 0 00-2.97 2.86v.3a3.2 3.2 0 002.97 3.1A32.38 32.38 0 0149.3 51.36a3.2 3.2 0 003.1 2.97h.31zm-23.77-5.95a5.94 5.94 0 11-11.89 0 5.94 5.94 0 0111.89 0zm14.7 2.98c.18 1.63-1.17 2.97-2.81 2.97h-.25c-1.64 0-2.95-1.34-3.19-2.97a20.55 20.55 0 00-17.38-17.37c-1.62-.24-2.96-1.55-2.96-3.19v-.25c0-1.64 1.34-2.99 2.97-2.8a26.74 26.74 0 0123.61 23.61z" opacity=".3"/>\n  <path fill-rule="evenodd" d="M54.76 70.3c4.76-.7 8.15-2.08 10.8-4.73 2.66-2.66 4.04-6.05 4.73-10.81.7-4.8.71-10.84.71-18.76 0-7.92 0-13.97-.7-18.76-.7-4.76-2.08-8.15-4.73-10.8C62.9 3.78 59.52 2.4 54.76 1.7 49.96 1 43.92 1 36 1c-7.92 0-13.97 0-18.76.7-4.76.7-8.15 2.08-10.8 4.74-2.66 2.65-4.04 6.04-4.73 10.8C1 22.04 1 28.08 1 36c0 7.92 0 13.97.7 18.76.7 4.76 2.08 8.15 4.73 10.8 2.66 2.66 6.05 4.04 10.81 4.73 4.8.7 10.84.71 18.76.71 7.92 0 13.97 0 18.76-.7zm1.8-19.03a3.8 3.8 0 01-3.85 4.05h-.3a4.2 4.2 0 01-4.1-3.88 31.38 31.38 0 00-28.38-28.38 4.2 4.2 0 01-3.88-4.1v-.3a3.8 3.8 0 014.05-3.86 39.63 39.63 0 0136.47 36.47zm-26.62-2.9a6.94 6.94 0 11-13.89 0 6.94 6.94 0 0113.89 0zm14.69 2.87c.25 2.3-1.64 4.08-3.8 4.08h-.25c-2.22 0-3.88-1.8-4.18-3.82a19.55 19.55 0 00-16.53-16.53c-2.03-.3-3.82-1.96-3.82-4.18v-.25c0-2.16 1.78-4.05 4.08-3.8a27.75 27.75 0 0124.5 24.5zM36 72c15.78 0 24.55 0 30.27-5.73C72 60.54 72 51.77 72 36s0-24.54-5.73-30.27C60.55 0 51.77 0 36 0 20.22 0 11.45 0 5.73 5.73 0 11.46 0 20.23 0 36s0 24.54 5.73 30.27C11.45 72 20.23 72 36 72zm19.57-20.65a2.8 2.8 0 01-2.86 2.97h-.3a3.2 3.2 0 01-3.1-2.97 32.38 32.38 0 00-29.29-29.28 3.2 3.2 0 01-2.97-3.11v-.3a2.8 2.8 0 012.97-2.86 38.63 38.63 0 0135.55 35.55zM23 54.32a5.94 5.94 0 100-11.9 5.94 5.94 0 000 11.9zm17.83 0c1.64 0 2.99-1.34 2.8-2.97a26.75 26.75 0 00-23.61-23.61c-1.63-.19-2.97 1.16-2.97 2.8v.25c0 1.64 1.34 2.95 2.96 3.19A20.55 20.55 0 0137.4 51.35c.24 1.63 1.55 2.97 3.19 2.97h.25z"/>\n</svg>\n'},24885:e=>{e.exports='<svg fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 80 80">\n  <path d="M40 80c17.53 0 27.27 0 33.64-6.36C80 67.27 80 57.53 80 40s0-27.27-6.36-33.64C67.27 0 57.53 0 40 0S12.73 0 6.36 6.36C0 12.73 0 22.47 0 40s0 27.27 6.36 33.64C12.73 80 22.47 80 40 80z" fill="#FF6600"/>\n  <path d="M24.2 62.8c3.69 0 6.68-3.02 6.68-6.74s-2.99-6.74-6.68-6.74a6.72 6.72 0 00-6.7 6.74c0 3.72 3 6.74 6.7 6.74z" fill="white"/>\n  <path d="M64.12 58.35a4.16 4.16 0 01-4.25 4.45c-2.46 0-4.43-2-4.71-4.45a38.13 38.13 0 00-33.17-33.48c-2.46-.3-4.48-2.28-4.48-4.76a4.18 4.18 0 014.48-4.28c22.27 2.14 40.04 20.07 42.13 42.52z" fill="white"/>\n  <path d="M48.41 58.35c.35 2.44-1.68 4.45-4.15 4.45-2.46 0-4.41-2.02-4.9-4.43a22.45 22.45 0 00-17.39-17.59c-2.43-.5-4.46-2.46-4.46-4.94 0-2.49 2.02-4.53 4.48-4.18a31.41 31.41 0 0126.42 26.7z" fill="white"/>\n</svg>\n'},81346:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M5 12C5 13.1045 4.10457 14 3 14C1.89543 14 1 13.1045 1 12C1 10.8954 1.89543 9.99997 3 9.99997C4.10457 9.99997 5 10.8954 5 12Z"/>\n  <path d="M13 14C13.5523 14 14.004 13.5516 13.9616 13.0009C13.8563 11.6359 13.536 10.2938 13.0104 9.02508C12.3571 7.44785 11.3996 6.01474 10.1924 4.80758C8.98523 3.60042 7.55212 2.64284 5.97488 1.98953C4.70613 1.464 3.36409 1.14362 1.99903 1.03841C1.44837 0.995969 1 1.44768 1 1.99997V2.10229C1 2.65457 1.44865 3.09753 1.99861 3.14813C3.08735 3.24832 4.15675 3.51197 5.17036 3.93182C6.49253 4.47948 7.69388 5.2822 8.70582 6.29414C9.71777 7.30609 10.5205 8.50744 11.0681 9.82961C11.488 10.8432 11.7516 11.9126 11.8518 13.0014C11.9024 13.5513 12.3454 14 12.8977 14H13Z"/>\n  <path d="M9 14C9.55229 14 10.0057 13.5509 9.9445 13.002C9.85086 12.1627 9.63936 11.3391 9.31492 10.5558C8.86262 9.46389 8.19969 8.47173 7.36396 7.63601C6.52823 6.80028 5.53608 6.13734 4.44415 5.68505C3.66087 5.36061 2.83725 5.14911 1.99795 5.05547C1.44907 4.99423 1 5.44768 1 5.99997V6.08323C1 6.63551 1.45001 7.07582 1.99653 7.15539C2.56208 7.23773 3.11654 7.39004 3.64692 7.60973C4.4861 7.95733 5.2486 8.46682 5.89087 9.10909C6.53315 9.75137 7.04264 10.5139 7.39023 11.353C7.60993 11.8834 7.76223 12.4379 7.84458 13.0034C7.92415 13.55 8.36446 14 8.91674 14H9Z"/>\n</svg>\n'},28481:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M1 3.154C1 1.964 1.964 1 3.154 1h9.692C14.036 1 15 1.964 15 3.154v9.692c0 1.19-.964 2.154-2.154 2.154H3.154A2.154 2.154 0 011 12.846V3.154zm2.154-1.077h9.692c.595 0 1.077.482 1.077 1.077v9.692c0 .595-.482 1.077-1.077 1.077H3.154a1.077 1.077 0 01-1.077-1.077V3.154c0-.595.482-1.077 1.077-1.077z"/>\n  <path class="small-icon-outline" d="M12.5 12.5v-1a8 8 0 00-8-8h-1v1.4h1a6.6 6.6 0 016.6 6.6v1h1.4z"/>\n  <path class="small-icon-outline" d="M6.5 11a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z"/>\n  <path class="small-icon-outline" d="M9.5 11.5v1H8.1v-1a3.6 3.6 0 00-3.6-3.6h-1V6.5h1a5 5 0 015 5z"/>\n</svg>\n'},21287:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path ss="small-icon-fill" fill-rule="evenodd" clip-rule="evenodd" d="M14 2H2v12h12V2zm-1.5 10.5v-1a8 8 0 00-8-8h-1v1.4h1a6.6 6.6 0 016.6 6.6v1h1.4zm-6-1.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zm3 1.5v-1a5 5 0 00-5-5h-1v1.4h1a3.6 3.6 0 013.6 3.6v1h1.4z"/>\n  <path class="small-icon-outline" fill-rule="evenodd" clip-rule="evenodd" d="M1 3.154C1 1.964 1.964 1 3.154 1h9.692C14.036 1 15 1.964 15 3.154v9.692c0 1.19-.964 2.154-2.154 2.154H3.154A2.154 2.154 0 011 12.846V3.154zM3 2h10c.595 0 1 .405 1 1v10c0 .595-.405 1-1 1H3c-.595 0-1-.405-1-1V3c0-.595.405-1 1-1z"/>\n</svg>\n'},25650:e=>{e.exports='<svg height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M8.805 12h-5.805v-1h1v-7h-1v-1h5.866c.703 0 1.747.5 3.134 1.5l-.092 2.183c-.167.192-1.294.311-1.609.47.462.176 1.472 1.126 1.7 1.346v2c-.543.703-2.011 1.5-3.195 1.5zm-.644-1.042c.33 0 .566-.205.706-.615.088-.259.133-.573.133-.94 0-.619-.129-1.041-.387-1.265-.137-.12-.318-.18-.544-.18h-1.069v3zm-.077-3.941c.251 0 .447-.077.587-.231.22-.242.329-.677.329-1.305 0-.633-.117-1.059-.35-1.279-.132-.123-.327-.185-.587-.185h-1.063v3z" fill-rule="evenodd"/></svg>'},41028:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M8.295 9.866l-.991.991c-.286.286-.67.444-1.081.444-.411 0-.794-.158-1.081-.444-.596-.596-.596-1.565 0-2.161l.991-.991-1.178-1.178-.991.991c-1.243 1.242-1.243 3.276 0 4.518.621.621 1.44.932 2.259.932s1.638-.311 2.259-.932l.991-.991-1.178-1.178M7.705 6.134l.991-.991c.286-.286.67-.444 1.081-.444.411 0 .794.158 1.081.444.286.286.444.67.444 1.081 0 .411-.158.794-.444 1.081l-.991.991 1.178 1.178.991-.991c1.242-1.242 1.242-3.276 0-4.518-.621-.621-1.44-.932-2.259-.932s-1.638.311-2.259.932l-.991.991 1.178 1.179"/></svg>\n'},22713:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path class="hl" d="M5 7.5l-4 3.5v-7z"/>\n  <g>\n    <path d="M2 2h3v1h-3zm4 0h8v1h-8zm.001 2h8v1h-8zm0 2h8v1h-8zM6.001 8h8v1h-8zm0 2h8v1h-8z"/>\n    <path d="M2 12h3v1h-3zm4 0h4v1h-4z"/>\n  </g>\n</svg>\n'},57842:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M4 1.5C4 1.22386 4.22386 1 4.5 1H11.5C11.7761 1 12 1.22386 12 1.5C12 1.77614 11.7761 2 11.5 2H4.5C4.22386 2 4 1.77614 4 1.5Z"/>\n  <path d="M7 10L5 8L3 12H13L10 6L7 10Z"/>\n  <path fill-rule="evenodd" d="M2 3H14C14.5523 3 15 3.44772 15 4V13C15 13.5523 14.5523 14 14 14H2C1.44772 14 1 13.5523 1 13V4C1 3.44772 1.44772 3 2 3ZM14 4H2V13H14L14 4Z"/>\n</svg>\n'},71360:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M6 2h8v1h-8zm0 5h8v1h-8zm0 5h8v1h-8z"/>\n  <g class="hl">\n    <path d="M3 2v-1h1v3h1v1h-3v-1h1v-1h-1v-1zm1 7h1v1h-3v-1h1v-1h1v1zm-2-3h2v1h-2v-1zm2 1h1v1h-1v-1zm0 5v1h-1v-1h-1v-1h3v1h-1zm0 1h1v1h-1v-1zm-2 1h2v1h-2v-1z"/>\n    <path opacity=".5" style="mix-blend-mode:multiply" d="M3 1h2v4h-2zm0 5h2v4h-2zm0 5h2v4h-2z"/>\n  </g>\n</svg>\n'},92636:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M6 2h8v1h-8zm0 5h8v1h-8zm0 5h8v1h-8z"/>\n  <g class="hl" transform="translate(2 1)">\n    <circle id="Oval" cx="1.5" cy="1.5" r="1.5"/>\n    <circle cx="1.5" cy="6.5" r="1.5"/>\n    <circle cx="1.5" cy="11.5" r="1.5"/>\n  </g>\n</svg>\n'},70773:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M7 11h2v1h-6v-1h2l3-7h-2v-1h6v1h-2z"/></svg>\n'},37362:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M2 2h12v1h-12zm1 2h10v1h-10zm-1 2h12v1h-12zM2 10h12v1h-12zm2-2h8v1h-8z"/><path d="M5 12h6v1h-6z"/></svg>\n'},76992:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M2 2h12v1h-12zm0 2h12v1h-12zm0 2h12v1h-12zm0 2h12v1h-12zm0 2h12v1h-12zm0 2h6v1h-6z"/></svg>\n'},41885:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M2 2h11v1h-11zm0 2h10v1h-10zm0 2h12v1h-12zm0 2h9v1h-9zm0 2h11v1h-11zm0 2h6v1h-6z"/></svg>\n'},7246:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M3 2h11v1h-11zm1 2h10v1h-10zM2 6h12v1h-12zm3 2h9v1h-9z"/><path d="M3 10h11v1h-11zm5 2h6v1h-6z"/></svg>\n'},10681:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M2 2h3v1h-3zm4 0h8v1h-8zm.001 2h8v1h-8zm0 2h8v1h-8zm0 2h8v1h-8zm0 2h8v1h-8zm-4.001 2h3v1h-3zm4 0h4v1h-4z"/><path class="hl" d="M1 7.5l4-3.5v7z"/></svg>\n'},54472:e=>{e.exports='<svg height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><path class="hl" d="M11.046 6.954c-.629-1.387-2.026-2.354-3.646-2.354-2.206 0-4 1.794-4 4s2.394 4 4.6 4v1.599c-3.093 0-6.2-2.507-6.2-5.599 0-3.094 2.507-5.6 5.6-5.6 2.06 0 3.86 1.112 4.832 2.768l1.768-1.768v5h-5z"/></svg>\n'},269:e=>{e.exports='<svg height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M13.923 3.854c.59-.851.476-2.296-.423-2.854-.902-.557-2.25-.017-2.842.834-.557.804-.53 2.076-.949 2.987-.541 1.176-2.627 1.026-4.709 0-1.144 2.095-2.424 4.639-4 6.467l1.498.928c.674-.109 1.509-.662 1.849-1.269-.027.729-.316 1.375-.885 1.865l2.831 1.748c.361-.34.698-.61 1.07-.84-.211.402-.352.828-.417 1.244l1.676 1.036c.993-1.803 2.924-4.59 4.274-6.171-1.867-1.42-2.421-3.085-1.413-4.034.725-.685 1.903-1.165 2.441-1.942zm-.805-2.155c.427.242.546.743.264 1.112-.276.373-.851.476-1.276.234-.429-.243-.547-.74-.267-1.112.278-.372.851-.477 1.279-.234zm-3.091 10.029l-5.445-3.366 1.07-1.543 5.443 3.366z" fill-rule="evenodd"/></svg>'},86721:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M5 13H7V4H6.32005C6.11005 4 5.88005 4.02 5.62005 4.05C5.36005 4.09 5.10005 4.19 4.84005 4.35C4.58005 4.51 4.34005 4.78 4.10005 5.13C3.86005 5.49 3.65005 5.98 3.47005 6.61H3.30005V3H12.69V6.61H12.52C12.35 5.98 12.14 5.49 11.9 5.13C11.66 4.78 11.41 4.52 11.14 4.35C10.88 4.19 10.62 4.08 10.36 4.05C10.1 4.01 9.87005 4 9.66005 4H9V13H11V14H5V13Z"/>\n  <path d="M14 8H2V9H14V8Z"/>\n</svg>\n'},65438:e=>{e.exports='<svg height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><g fill-rule="evenodd"><path d="M3 13h9v1h-9zM7.5 10.75l1.5-.75v-6h-1v-1h4v1h-1v6l-2 2h-3l-2-2v-6h-1v-1h4v1h-1v6z"/></g></svg>'},94537:e=>{e.exports='<svg height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><path class="hl" d="M3.768 5.768c.973-1.656 2.773-2.768 4.832-2.768 3.093 0 5.6 2.506 5.6 5.6 0 3.092-3.107 5.599-6.2 5.599v-1.599c2.206 0 4.6-1.794 4.6-4s-1.794-4-4-4c-1.619 0-3.017.967-3.646 2.354l2.046 2.046h-5v-5z"/></svg>\n'},61453:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M7.26579 2H8.50199L14 14H12.2038L10.5646 10.4651H5.33978L3.8099 14H2L7.26579 2ZM9.84747 8.94352L7.86682 4.61794L6.0296 8.94352H9.84747Z"/>\n</svg>\n'},10375:e=>{e.exports='<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M13.76 15.17a5 5 0 111.41-1.41l3.54 3.53a1 1 0 01-1.42 1.42l-3.53-3.54zM14 11a3 3 0 11-6 0 3 3 0 016 0z"/>\n</svg>'},4868:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M6.5 11C7.38054 11 8.20201 10.7471 8.89574 10.31L12.2929 13.7071C12.6834 14.0976 13.3166 14.0976 13.7071 13.7071C14.0976 13.3166 14.0976 12.6834 13.7071 12.2929L10.3099 8.89574C10.7471 8.20201 11 7.38054 11 6.5C11 4.01472 8.98528 2 6.5 2C4.01472 2 2 4.01472 2 6.5C2 8.98528 4.01472 11 6.5 11ZM6.5 9C7.88071 9 9 7.88071 9 6.5C9 5.11929 7.88071 4 6.5 4C5.11929 4 4 5.11929 4 6.5C4 7.88071 5.11929 9 6.5 9Z"/>\n</svg>\n'},5983:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M9.47244 10.3917C8.9108 10.7755 8.23162 11 7.5 11C5.567 11 4 9.433 4 7.5C4 5.567 5.567 4 7.5 4C9.433 4 11 5.567 11 7.5C11 8.23162 10.7755 8.9108 10.3917 9.47244L12.4596 11.5404C12.7135 11.7942 12.7135 12.2058 12.4596 12.4596C12.2058 12.7135 11.7942 12.7135 11.5404 12.4596L9.47244 10.3917ZM9.9 7.5C9.9 8.82548 8.82548 9.9 7.5 9.9C6.17452 9.9 5.1 8.82548 5.1 7.5C5.1 6.17452 6.17452 5.1 7.5 5.1C8.82548 5.1 9.9 6.17452 9.9 7.5Z"/>\n</svg>\n'},96676:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" class="selectbox-checkmark" viewBox="0 0 16 16">\n  <path d="M5.3 13.3L1.5 9.5 3 8l2.3 2.5L13 2.7 14.6 4l-8 8z"/>\n</svg>\n'},17183:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M13.207 5.707 6.5 12.5 2.646 8.646l.708-.707L6.5 11.086 12.5 5l.707.707z"/>\n</svg>\n'},45243:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M9.57087 9.63143H5.15509L4.85492 10.3844C4.408 11.4698 4.18788 12.182 4.18788 12.5144C4.18788 12.8672 4.30795 13.1385 4.54141 13.3217C4.78155 13.5048 5.08171 13.5998 5.45525 13.5998V14H2V13.5998C2.51362 13.5184 2.9005 13.3352 3.1473 13.0435C3.39411 12.7518 3.70094 12.1481 4.05447 11.2256C4.08116 11.1374 4.22123 10.7982 4.46804 10.2148L7.84992 2H8.18344L12.0656 11.3951L12.5992 12.6365C12.7193 12.9146 12.8794 13.1317 13.0862 13.2945C13.2863 13.4573 13.5931 13.5591 14 13.5998V14H9.4308V13.5998C9.99111 13.5998 10.3713 13.5591 10.5648 13.4709C10.7649 13.3895 10.8583 13.2199 10.8583 12.9689C10.8583 12.84 10.7248 12.4601 10.4647 11.8293L9.57087 9.63143ZM9.42412 9.23799L7.36965 4.19785L5.32185 9.23799H9.42412Z"/>\n</svg>\n'},16761:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.892 2.298a.5.5 0 01.707 0l1.085 1.086a.5.5 0 010 .707l-.939.94-1.793-1.793.94-.94zm1.414-.707a1.5 1.5 0 00-2.122 0L8.892 2.884l-.354.354.354.353 2.5 2.5.353.354.354-.354 1.293-1.293a1.5 1.5 0 000-2.12L12.306 1.59zM2 9.776v3.207h3.207l5.855-5.855-3.208-3.207L2 9.776zM3 12v-1.852l4.854-4.812 1.793 1.792L4.834 12H3z"/><path d="M2 14h10v1H2z"/></svg>\n'},71665:e=>{e.exports='<svg width="229" height="141" xmlns="http://www.w3.org/2000/svg">\n  \x3c!-- outline --\x3e\n  <path fill-rule="evenodd" d="M40 129h113v4a8 8 0 0 0 8 8h32a8 8 0 0 0 8-8V61a8 8 0 0 0-8-8h-7V21a8 8 0 0 0-8-8H48a8 8 0 0 0-8 8v94a7.981 7.981 0 0 0 2.708 6H34v2a6 6 0 0 0 6 6zm2-14a6 6 0 0 0 6 6h105V61a8 8 0 0 1 8-8h23V21a6 6 0 0 0-6-6H48a6 6 0 0 0-6 6v94zm111 8v4H40a4 4 0 0 1-4-4h117zm11.026-68H161a6 6 0 0 0-6 6v72a6 6 0 0 0 6 6h32a6 6 0 0 0 6-6V61a6 6 0 0 0-6-6h-3.026l-2.282 3.862a2 2 0 0 1-1.722.982h-17.94a2 2 0 0 1-1.722-.982L164.026 55z"/>\n  \x3c!-- devices background --\x3e\n  <g fill-opacity=".3">\n    <path d="M62.636 25.636a9 9 0 1 1 12.729 12.73 9 9 0 0 1-12.728-12.73zm7.737 11.885c1.483-2.583 2.968-5.163 4.453-7.743.18-.314.252-.646.207-1.005-.11-.828-.95-1.427-1.766-1.247-1.001.22-1.491 1.256-1.03 2.177.166.337.246.695.253 1.12l-.023.245a2.4 2.4 0 0 1-2.525 2.131c-.87-.053-1.523-.472-1.969-1.218a69.107 69.107 0 0 1-.697-1.2l-.203-.355-.417-.725-.006-.01-.263-.458-.257-.447-.301-.519c-.307-.525-.771-.805-1.376-.773-1.143.06-1.787 1.271-1.217 2.267.565.987 1.133 1.972 1.701 2.96l.933 1.62a691.079 691.079 0 0 0 1.868 3.241c.311.534.795.793 1.41.748.549-.04.95-.33 1.225-.81z"/>\n    <path d="M86 115a3 3 0 0 0 3-3V50a3 3 0 0 0-3-3H51a3 3 0 0 0-3 3v62a3 3 0 0 0 3 3h35zm91-89a3 3 0 0 1-3 3H98a3 3 0 0 1 0-6h76a3 3 0 0 1 3 3zm-3 15a3 3 0 1 0 0-6H98a3 3 0 1 0 0 6h76zm3 12h-16a8 8 0 0 0-8 8v54H98a3 3 0 0 1-3-3V50a3 3 0 0 1 3-3h76a3 3 0 0 1 3 3v3zM34 121h119v7h48v6a6 6 0 0 1-6 6h-36a6 6 0 0 1-6-6v-5H40a6 6 0 0 1-6-6v-2zm132-27a2 2 0 0 1 2-2h25a2 2 0 1 1 0 4h-25a2 2 0 0 1-2-2zm2 5a2 2 0 1 0 0 4h25a2 2 0 1 0 0-4h-25zm-2 9a2 2 0 0 1 2-2h25a2 2 0 1 1 0 4h-25a2 2 0 0 1-2-2z"/>\n    <path d="M161 92a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm-2 9.044a2 2 0 1 1 4 0 2 2 0 0 1-4 0zm2 4.956a2 2 0 1 0-.001 3.999A2 2 0 0 0 161 106z"/>\n    <path d="M181.951 71.005c-2.735-2.673-7.166-2.673-9.9 0a6.735 6.735 0 0 0 0 9.68c2.734 2.672 7.165 2.672 9.9 0a6.74 6.74 0 0 0 0-9.68zm-.419 3.15a5162.507 5162.507 0 0 0-3.464 5.888c-.214.364-.526.585-.953.615-.478.034-.855-.162-1.096-.568-.488-.82-.971-1.643-1.455-2.466l-.724-1.232-.234-.397c-.364-.618-.727-1.235-1.089-1.854-.443-.757.058-1.678.947-1.723.47-.025.831.188 1.069.588l.229.385.41.697.329.56c.037.061.073.124.109.186l.049.083c.179.305.357.61.542.913.347.567.855.886 1.532.926.958.057 1.848-.623 1.963-1.62.008-.068.014-.136.017-.176v-.001l.001-.01a1.883 1.883 0 0 0-.197-.851c-.358-.7.023-1.489.802-1.656.634-.137 1.288.319 1.374.949.034.272-.022.525-.161.763z"/>\n  </g>\n  \x3c!-- clouds --\x3e\n  <path opacity=".3" d="M26.69 108.052A7.707 7.707 0 0 0 18.988 100a7.712 7.712 0 0 0-6.978 4.423 4.206 4.206 0 0 0-2.447-.777c-2.28 0-4.128 1.786-4.128 3.99 0 .327.042.644.119.948-2.6.554-4.554 2.906-4.554 5.724C1 117.537 3.565 120 6.73 120h18.787c3.028 0 5.483-2.586 5.483-5.967 0-2.932-1.846-5.381-4.31-5.981zm169.77-97.574a9.724 9.724 0 0 1-.011-.453c0-5.537 4.372-10.025 9.767-10.025 3.906 0 7.276 2.355 8.838 5.756a5.224 5.224 0 0 1 3.1-1.012c2.887 0 5.228 2.324 5.228 5.192 0 .425-.053.839-.15 1.234 3.294.72 5.768 3.769 5.768 7.436 0 4.202-3.249 7.394-7.257 7.394h-23.799c-3.835 0-6.944-3.353-6.944-7.752 0-3.815 2.338-6.99 5.46-7.77zm15.748 8.237.669.798a.38.38 0 0 0 .554.038 5.741 5.741 0 0 0 1.715-4.113c0-3.005-2.271-5.459-5.146-5.668V8.714c0-.082-.083-.125-.135-.07l-1.839 1.958a.107.107 0 0 0 0 .14l1.839 1.958c.052.055.135.012.135-.07v-1.01c1.888.205 3.365 1.825 3.365 3.818 0 1.07-.434 2.029-1.122 2.725a.41.41 0 0 0-.035.552zm-3.005 2.387v1.177c0 .082.083.125.135.07l1.839-1.957a.107.107 0 0 0 0-.14l-1.839-1.958c-.052-.055-.135-.012-.135.07v.878l-.363-.051c-1.707-.364-2.996-1.894-2.996-3.753 0-1.125.475-2.129 1.224-2.833a.392.392 0 0 0 .041-.542l-.683-.793a.379.379 0 0 0-.544-.04 5.73 5.73 0 0 0-1.82 4.207c0 3.002 2.269 5.453 5.141 5.665z"/>\n  <g opacity=".3">\n    \x3c!-- circles --\x3e\n    <path d="M40 25.95c-.329.033-.663.05-1 .05-5.523 0-10-4.477-10-10S33.477 6 39 6c4.478 0 8.268 2.943 9.542 7h6.177C53.315 5.597 46.811 0 39 0c-8.837 0-16 7.163-16 16s7.163 16 16 16c.336 0 .67-.01 1-.03v-6.02z" fill="url(#ltr)"/>\n    <path d="M201 125.148a12.933 12.933 0 0 0 7.802 1.58c7.136-.797 12.275-7.228 11.479-14.364-.797-7.135-7.226-12.273-14.361-11.475a12.947 12.947 0 0 0-4.92 1.579v6.49a7.977 7.977 0 0 1 5.474-3.1 7.997 7.997 0 0 1 8.837 7.062A8.001 8.001 0 0 1 201 118.663v6.485z" fill="url(#rtl)"/>\n    \x3c!-- lines --\x3e\n    <path d="M186 50v-9h25.5a4.5 4.5 0 0 1 0 9H186z" fill="url(#ltr)"/>\n    <path d="M201 69v-8a8.05 8.05 0 0 0-.062-1H223.5a4.5 4.5 0 0 1 0 9H201z" fill="url(#ltr)"/>\n    <path d="M201 88v-9h10.5a4.5 4.5 0 0 1 0 9H201z" fill="url(#ltr)"/>\n    <path d="M40 79.067V88H13.17a4.466 4.466 0 1 1 0-8.933H40z" fill="url(#rtl)"/>\n    <path d="M40 60.067V69H26.84a4.466 4.466 0 0 1 0-8.933H40z" fill="url(#rtl)"/>\n    <path d="M40 41v8.933H18.235a4.466 4.466 0 0 1 0-8.933H40z" fill="url(#rtl)"/>\n    <path d="M10.163 69a4.466 4.466 0 1 0 0-8.933H4.466a4.466 4.466 0 1 0 0 8.933h5.697z" fill="url(#rtl)"/>\n  </g>\n\n  <defs>\n    <linearGradient id="rtl" x1="0" y1="100%" x2="100%" y2="100%">\n      <stop offset="0" stop-color="var(--colorHighlightBgAlpha, #4A67FB33)"/>\n      <stop offset="100%" stop-color="var(--colorHighlightBg, #4A67FB)"/>\n    </linearGradient>\n    <linearGradient id="ltr" x1="0" y1="100%" x2="100%" y2="100%">\n      <stop offset="0" stop-color="var(--colorHighlightBg, #4A67FB)"/>\n      <stop offset="100%" stop-color="var(--colorHighlightBgAlpha, #4A67FB33)"/>\n    </linearGradient>\n  </defs>\n</svg>\n'},67651:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2 12v1.857S2 15 3.077 15h9.846S14 15 14 13.857V12h-1v1.857c0 .064-.007.1-.012.12A.289.289 0 0112.9 14H3.077c-.017 0-.03 0-.04-.002A.485.485 0 013 13.841V12H2zM7 7H4l4 2.698L11.935 7H9V2H7v5zm1 4L2.935 7.415C2.361 6.935 2.7 6 3.448 6H6V2a1 1 0 011-1h2a1 1 0 011 1v4h2.488c.748 0 1.087.936.512 1.415L8 11z"/></svg>\n'},87710:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.5 7a.501.501 0 00-.502.5v7c0 .274.224.5.502.5h11a.501.501 0 00.502-.5v-7c0-.274-.224-.5-.502-.5h-11zm-1.498.5c0-.83.672-1.5 1.498-1.5h11a1.5 1.5 0 011.498 1.5v7A1.5 1.5 0 0113.5 16h-11a1.5 1.5 0 01-1.498-1.5v-7z"/><path fill-rule="evenodd" clip-rule="evenodd" d="M8 1a3 3 0 00-3.002 3v2.5a.5.5 0 11-.996 0V4a4 4 0 117.996 0v2.5a.5.5 0 11-.996 0V4A3 3 0 008 1zM8 10a1 1 0 10-.002 2.002A1 1 0 008 10zm-1.998 1A2 2 0 1110 10.998 2 2 0 016.002 11z"/></svg>\n'},21922:e=>{e.exports='<svg width="17" height="16" xmlns="http://www.w3.org/2000/svg"><path d="M5 6h7v1H5V6zM5 8h7v1H5V8zM5 10h7v1H5v-1z"/><path fill-rule="evenodd" clip-rule="evenodd" d="M3 4a2 2 0 012-2h7a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V4zm2.2 0A1.2 1.2 0 004 5.2v7.6A1.2 1.2 0 005.2 14h6.6a1.2 1.2 0 001.2-1.2V5.2A1.2 1.2 0 0011.8 4H5.2z"/></svg>\n'},3699:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path d="M14.714 6.296l.207 1.817c.491.193.945.458 1.35.781l1.68-.725c.171-.099.354.021.402.106l1.418 2.457c.098.169.061.303-.11.401l-1.471 1.088c.038.254.057.514.057.779 0 .276-.021.547-.062.811l1.423 1.147c.171.099.207.232.11.401l-1.342 2.325c-.049.084-.232.204-.402.105l-1.692-.693c-.413.331-.877.601-1.378.797l-.246 1.811c0 .197-.195.296-.293.296h-2.684c-.195 0-.293-.099-.293-.296l-.281-1.805c-.507-.196-.976-.468-1.392-.802l-1.692.693c-.171.099-.354-.021-.402-.105l-1.342-2.325c-.098-.169-.061-.303.11-.401l1.423-1.147c-.041-.264-.062-.535-.062-.811 0-.265.02-.525.057-.779l-1.471-1.088c-.171-.099-.207-.232-.11-.401l1.418-2.457c.049-.084.232-.204.402-.106l1.68.725c.406-.324.861-.589 1.352-.782l.212-1.816c0-.197.195-.296.293-.296h2.837c.195 0 .293.099.293.296zm-1.714 8.704c1.105 0 2-.895 2-2 0-1.104-.895-2-2-2s-2 .896-2 2c0 1.105.895 2 2 2z"/>\n</svg>\n'},62675:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M9.711 1.296l.207 1.817c.491.193.945.458 1.35.781l1.68-.725c.171-.099.354.021.402.106l1.418 2.457c.098.169.061.303-.11.401l-1.471 1.088c.038.254.057.514.057.779 0 .276-.021.547-.062.811l1.423 1.147c.171.099.207.232.11.401l-1.342 2.325c-.049.085-.232.204-.402.106l-1.693-.693c-.413.331-.877.601-1.378.797l-.246 1.811c0 .197-.195.296-.293.296h-2.684c-.195 0-.293-.099-.293-.296l-.281-1.805c-.507-.196-.976-.468-1.393-.802l-1.692.693c-.171.099-.354-.021-.402-.106l-1.342-2.325c-.098-.169-.061-.303.11-.401l1.423-1.147c-.041-.264-.062-.535-.062-.811 0-.265.02-.525.057-.779l-1.471-1.088c-.171-.099-.207-.232-.11-.401l1.418-2.457c.049-.084.232-.204.402-.106l1.68.725c.406-.324.861-.589 1.352-.782l.212-1.816c0-.197.195-.296.293-.296h2.837c.195 0 .293.099.293.296zm-1.715 8.704c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z"/>\n</svg>\n'},89052:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M8.992 3.823l-.208-1.823h-1.571l-.213 1.823-.558.219c-.397.156-.765.37-1.095.633l-.469.374-1.687-.728-.786 1.361 1.475 1.092-.088.594c-.031.206-.046.417-.046.632 0 .224.017.444.05.658l.088.57-1.439 1.159.727 1.259 1.706-.698.46.369c.338.271.717.491 1.127.649l.539.208.284 1.825h1.454l.248-1.825.549-.214c.405-.158.78-.376 1.115-.645l.46-.369 1.706.698.727-1.259-1.439-1.159.088-.57c.033-.214.05-.434.05-.658 0-.215-.016-.426-.046-.632l-.088-.594 1.475-1.092-.786-1.361-1.687.728-.469-.374c-.329-.262-.696-.476-1.093-.632l-.559-.22zm-5.948-.654c-.171-.099-.354.021-.402.106l-1.418 2.457c-.098.169-.061.303.11.401l1.471 1.088c-.038.254-.057.514-.057.779 0 .276.021.547.062.811l-1.423 1.147c-.171.099-.207.232-.11.401l1.342 2.325c.049.085.232.204.402.106l1.692-.693c.417.334.886.607 1.393.802l.281 1.805c0 .197.098.296.293.296h2.684c.098 0 .293-.099.293-.296l.246-1.811c.501-.195.965-.466 1.378-.797l1.693.693c.171.099.354-.021.402-.106l1.342-2.325c.098-.169.061-.303-.11-.401l-1.423-1.147c.041-.264.062-.535.062-.811 0-.265-.02-.525-.057-.779l1.471-1.088c.171-.099.207-.232.11-.401l-1.418-2.457c-.049-.084-.232-.204-.402-.106l-1.68.725c-.405-.324-.86-.588-1.35-.781l-.207-1.817c0-.197-.098-.296-.293-.296h-2.837c-.098 0-.293.099-.293.296l-.212 1.816c-.491.193-.946.458-1.352.782l-1.68-.725zM8 9c.552 0 1-.448 1-1s-.448-1-1-1-1 .448-1 1 .448 1 1 1zm0 1c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z"/>\n</svg>\n'},78754:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M8.376.17a.5.5 0 0 0-.752 0l-3.5 4A.5.5 0 0 0 4.5 5H6v5.5a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5V5h1.5a.5.5 0 0 0 .376-.83l-3.5-4ZM6.5 4h-.898L8 1.26 10.398 4H9.5a.5.5 0 0 0-.5.5V10H7V4.5a.5.5 0 0 0-.5-.5ZM2 7.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 0 0-1h-1A1.5 1.5 0 0 0 1 7.5v7A1.5 1.5 0 0 0 2.5 16h11a1.5 1.5 0 0 0 1.5-1.5v-7A1.5 1.5 0 0 0 13.5 6h-1a.5.5 0 0 0 0 1h1a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-7Z"/>\n</svg>\n'},35735:e=>{e.exports='<svg width="26" height="26" xmlns="http://www.w3.org/2000/svg">\n  <path d="M9 8h-.5A1.5 1.5 0 0 0 7 9.5v7A1.5 1.5 0 0 0 8.5 18H9v-1a1 1 0 0 1-1-1v-6a1 1 0 0 1 1-1V8zm8 9v1h.5a1.5 1.5 0 0 0 1.5-1.5v-7A1.5 1.5 0 0 0 17.5 8H17v1a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1z"/>\n  <path fill-rule="evenodd" d="m5.234 20.848.383-.924A.994.994 0 0 0 6 20h.875v1H6c-.271 0-.53-.054-.766-.152zM19.125 21v-1H20a.994.994 0 0 0 .383-.076l.383.924A1.994 1.994 0 0 1 20 21h-.875zM22 8h-1V7a.994.994 0 0 0-.076-.383l.924-.383c.098.236.152.495.152.766v1zM6.875 5H6c-.271 0-.53.054-.766.152l.383.923A.994.994 0 0 1 6 6h.875V5zM4 18h1v1c0 .137.027.266.075.383l-.923.383A1.994 1.994 0 0 1 4 19v-1zm0-2h1v-2H4v2zm0-4h1v-2H4v2zm0-4h1V7c0-.137.027-.266.075-.383l-.923-.383A1.994 1.994 0 0 0 4 7v1zm4.625-3v1h1.75V5h-1.75zm3.5 0v1h1.75V5h-1.75zm3.5 0v1h1.75V5h-1.75zm3.5 0v1H20c.137 0 .266.027.383.075l.383-.923A1.994 1.994 0 0 0 20 5h-.875zM22 10h-1v2h1v-2zm0 4h-1v2h1v-2zm0 4h-1v1a.994.994 0 0 1-.076.383l.924.383c.098-.236.152-.495.152-.766v-1zm-4.625 3v-1h-1.75v1h1.75zm-3.5 0v-1h-1.75v1h1.75zm-3.5 0v-1h-1.75v1h1.75z"/>\n</svg>\n'},9784:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M4.444 3H4c-.736 0-1.333.672-1.333 1.5v7c0 .828.597 1.5 1.333 1.5h.444v-1c-.49 0-.888-.448-.888-1V5c0-.552.398-1 .888-1V3zm7.112 9v1H12c.736 0 1.333-.672 1.333-1.5v-7c0-.828-.597-1.5-1.333-1.5h-.444v1c.49 0 .888.448.888 1v6c0 .552-.398 1-.888 1z"/>\n  <path fill-rule="evenodd" d="m1.097 15.848.34-.924a.8.8 0 0 0 .34.076h.779v1h-.778c-.241 0-.471-.054-.68-.152zM13.444 16v-1h.778a.799.799 0 0 0 .34-.075l.34.923a1.596 1.596 0 0 1-.68.152h-.778zM16 3h-.889V2c0-.137-.024-.266-.067-.383l.821-.383c.087.236.135.495.135.766v1zM2.556 0h-.778c-.241 0-.471.054-.68.152l.34.923A.8.8 0 0 1 1.778 1h.778V0zM0 13h.889v1c0 .137.024.266.067.383l-.821.383A2.212 2.212 0 0 1 0 14v-1zm0-2h.889V9H0v2zm0-4h.889V5H0v2zm0-4h.889V2c0-.137.024-.266.067-.383l-.821-.383A2.212 2.212 0 0 0 0 2v1zm4.111-3v1h1.556V0H4.11zm3.111 0v1h1.556V0H7.222zm3.111 0v1h1.556V0h-1.556zm3.111 0v1h.778c.122 0 .237.027.34.075l.34-.923a1.603 1.603 0 0 0-.68-.152h-.778zM16 5h-.889v2H16V5zm0 4h-.889v2H16V9zm0 4h-.889v1c0 .137-.024.266-.067.383l.821.383c.087-.236.135-.495.135-.766v-1zm-4.111 3v-1h-1.556v1h1.556zm-3.111 0v-1H7.222v1h1.556zm-3.111 0v-1H4.11v1h1.556z"/>\n</svg>\n'},72753:e=>{e.exports='<svg width="26" height="26" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="m6.234 20.848.383-.924A.994.994 0 0 0 7 20h1v1H7c-.271 0-.53-.054-.766-.152zM18 21v-1h1a.994.994 0 0 0 .383-.076l.383.924A1.994 1.994 0 0 1 19 21h-1zm3-13h-1V7a.994.994 0 0 0-.076-.383l.924-.383c.098.236.152.495.152.766v1zM8 5H7c-.271 0-.53.054-.766.152l.383.923A.994.994 0 0 1 7 6h1V5zM5 18h1v1c0 .137.027.266.075.383l-.923.383A1.994 1.994 0 0 1 5 19v-1zm0-2h1v-2H5v2zm0-4h1v-2H5v2zm0-4h1V7c0-.137.027-.266.075-.383l-.923-.383A1.994 1.994 0 0 0 5 7v1zm5-3v1h2V5h-2zm4 0v1h2V5h-2zm4 0v1h1c.137 0 .266.027.383.075l.383-.923A1.994 1.994 0 0 0 19 5h-1zm3 5h-1v2h1v-2zm0 4h-1v2h1v-2zm0 4h-1v1a.994.994 0 0 1-.076.383l.924.383c.098-.236.152-.495.152-.766v-1zm-5 3v-1h-2v1h2zm-4 0v-1h-2v1h2z"/>\n</svg>\n'},36027:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="m1.234 15.848.383-.924A.994.994 0 0 0 2 15h1v1H2c-.271 0-.53-.054-.766-.152zM13 16v-1h1a.994.994 0 0 0 .383-.075l.383.923A1.994 1.994 0 0 1 14 16h-1zm3-13h-1V2a.994.994 0 0 0-.075-.383l.923-.383c.098.236.152.495.152.766v1zM3 0H2c-.271 0-.53.054-.766.152l.383.923A.994.994 0 0 1 2 1h1V0zM0 13h1v1c0 .137.027.266.075.383l-.923.383A1.994 1.994 0 0 1 0 14v-1zm0-2h1V9H0v2zm0-4h1V5H0v2zm0-4h1V2c0-.137.027-.266.075-.383l-.923-.383A1.994 1.994 0 0 0 0 2v1zm5-3v1h2V0H5zm4 0v1h2V0H9zm4 0v1h1c.137 0 .266.027.383.075l.383-.923A1.994 1.994 0 0 0 14 0h-1zm3 5h-1v2h1V5zm0 4h-1v2h1V9zm0 4h-1v1a.994.994 0 0 1-.075.383l.923.383c.098-.236.152-.495.152-.766v-1zm-5 3v-1H9v1h2zm-4 0v-1H5v1h2z"/>\n</svg>\n'},63267:e=>{e.exports='<svg viewBox="0 0 8 8" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n  <polygon points="5 3 5 0 3 0 3 3 0 3 0 5 3 5 3 8 5 8 5 5 8 5 8 3" />\n</svg>\n'},42822:e=>{e.exports='<svg viewBox="0 0 8 8" version="1.1" xmlns="http://www.w3.org/2000/svg">\n  <polygon points="0 3 0 5 8 5 8 3" />\n</svg>\n'},92800:e=>{e.exports='<svg viewBox="0 0 110 4" xmlns="http://www.w3.org/2000/svg">\n  <path d="M44 2.011c1.1-.011 2.2 1.989 3.3 1.989h62.7v-4l-110 .018v1.993s43.703.003 44 0z" class="folder-tab-color"/>\n</svg>\n'},23641:e=>{e.exports='<svg viewBox="0 0 110 90" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="none">\n  <g>\n    <path class="folderoutline" fill="url(#sd-folder-gradient)" d="M0 0h110v90h-110z" />\n    <path class="folder-tab-color" d="M44 2.011c1.1-.011 2.2 1.989 3.3 1.989h62.7v-4l-110 .018v1.993s43.703.003 44 0z" />\n  </g>\n</svg>\n'},82474:e=>{e.exports='<svg class="spinner" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path class="spinner-part1" d="M8 5c-.6 0-1-.4-1-1V1c0-.5.4-1 1-1 .5 0 1 .4 1 1v3c0 .6-.4 1-1 1z"/>\n  <path class="spinner-part2" d="M13.7 3.7L11.5 6c-.4.3-1 .3-1.4 0-.3-.5-.3-1 0-1.5l2.3-2.2c.4-.4 1-.4 1.4 0 .4.4.4 1 0 1.4z"/>\n  <path class="spinner-part3" d="M15 9h-3c-.5 0-1-.4-1-1 0-.5.4-1 1-1h3c.5 0 1 .4 1 1s-.4 1-1 1z"/>\n  <path class="spinner-part4" d="M13.7 13.6c-.4.4-1 .4-1.4 0L10 11.4c-.3-.4-.3-1 0-1.4.5-.4 1-.4 1.5 0l2.2 2.2c.4.4.4 1 0 1.4z"/>\n  <path class="spinner-part5" d="M8 16c-.6 0-1-.4-1-1v-3c0-.5.4-1 1-1 .5 0 1 .4 1 1v3c0 .6-.4 1-1 1z"/>\n  <path class="spinner-part6" d="M6 11.5l-2.3 2.2c-.4.4-1 .4-1.4 0-.4-.4-.4-1 0-1.4L4.5 10c.4-.3 1-.3 1.4 0 .3.5.3 1 0 1.5z"/>\n  <path class="spinner-part7" d="M4 9H1c-.6 0-1-.4-1-1 0-.5.4-1 1-1h3c.5 0 1 .4 1 1s-.4 1-1 1z"/>\n  <path class="spinner-part8" d="M6 6c-.5.3-1 .3-1.5 0L2.3 3.6c-.4-.4-.4-1 0-1.4.4-.4 1-.4 1.4 0L6 4.5c.3.4.3 1 0 1.4z"/>\n</svg>\n'},86484:e=>{e.exports='<svg width="196" height="32" xmlns="http://www.w3.org/2000/svg">\n  <rect class="border" x=".5" y=".5" width="195" height="31" rx="1.5" />\n  <path class="highlight" fill-rule="evenodd" d="M109 13h-8v8h8v-8zm-9-1v10h10V12h-10z"/>\n  <path fill-rule="evenodd" d="M9 9H1v16h8V9zM0 8v18h10V8H0z" class="border"/>\n  <path class="highlight" d="M12 25V6h1v19z"/>\n  <path class="highlight" fill-rule="evenodd" d="M177 25V7H12V6h173v19h10v1H93V9H15v17H1v-1h13V8h80v17h2V8h80v17h1zM97 9h78v16H97V9zm-79 4h8v8h-8v-8zm-1 9V12h10v10H17zm165-8.598L179 16l3 2.598v-5.196z"/>\n</svg>\n'},18998:e=>{e.exports='<svg width="196" height="32" xmlns="http://www.w3.org/2000/svg">\n  <rect x=".5" y=".5" width="195" height="31" rx="1.5" class="border"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M1 9h8v16H1V9zM0 26V8h10v18H0zM177 9H97v16h80V9zM96 8v18h82V8H96zm13 5h-8v8h8v-8zm-9-1v10h10V12h-10z"/>\n  <path class="highlight" fill-rule="evenodd" clip-rule="evenodd" d="M25 13h-8v8h8v-8zm-9-1v10h10V12H16z"/>\n  <path class="highlight" fill-rule="evenodd" clip-rule="evenodd" d="M13 9h80v17h1V8H12v18h1V9z"/>\n  <path class="highlight" d="M94 25h101v1H94zM1 25h11v1H1zM13 5h26v3H13zM40 5h26v2H40zM67 5h26v2H67z"/>\n</svg>\n'},86681:e=>{e.exports='<svg width="196" height="48" xmlns="http://www.w3.org/2000/svg">\n  <path class="border" d="M2 .5h192a1.5 1.5 0 011.5 1.5v44a1.5 1.5 0 01-1.5 1.5H2A1.5 1.5 0 01.5 46V2A1.5 1.5 0 012 .5z"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M4 28h80v16H4V28zM3 45V27h82v18H3zm5-13h8v8H8v-8zm-1 9V31h10v10H7zm161-13H88v16h80V28zm-81-1v18h82V27H87zm5 5h8v8h-8v-8zm-1 9V31h10v10H91zm93-9h-8v8h8v-8zm-9-1v10h10V31h-10zm-4-4h24v1h-23v16h23v1h-24V27z" class="highlight"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M9 8H1v16h8V8zM0 7v18h10V7H0z"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M25 12h-8v8h8v-8zm-9-1v10h10V11H16z" class="highlight"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M97 8h80v16H97V8zm-1 17V7h82v18H96zm5-13h8v8h-8v-8zm-1 9V11h10v10h-10z"/>\n  <path class="highlight" d="M93 24h103v1H93z"/>\n  <path class="highlight" d="M1 24h12v1H1z"/>\n  <g class="default-style">\n    <path fill-rule="evenodd" clip-rule="evenodd" class="highlight" d="M92 9H14v14h78V9zM14 7a2 2 0 00-2 2v14a2 2 0 002 2h78a2 2 0 002-2V9a2 2 0 00-2-2H14z"/>\n    <path opacity=".25" d="M90 11H80v10h10V11z" class="highlight"/>\n  </g>\n  <g class="dotted-style">\n    <path d="M39 4H13V7H12V25H13V8H93V25H94V7H39V4Z" class="highlight"/>\n    <path d="M66 4H40V6H66V4Z" class="highlight"/>\n    <path d="M67 4H93V6H67V4Z" class="highlight"/>\n  </g>\n</svg>\n'},95331:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M1 2.5A1.5 1.5 0 012.5 1h1A1.5 1.5 0 015 2.5v1A1.5 1.5 0 013.5 5h-1A1.5 1.5 0 011 3.5v-1zm5 0A1.5 1.5 0 017.5 1h1A1.5 1.5 0 0110 2.5v1A1.5 1.5 0 018.5 5h-1A1.5 1.5 0 016 3.5v-1zM12.5 1A1.5 1.5 0 0011 2.5v1A1.5 1.5 0 0012.5 5h1A1.5 1.5 0 0015 3.5v-1A1.5 1.5 0 0013.5 1h-1zM1 7.5A1.5 1.5 0 012.5 6h1A1.5 1.5 0 015 7.5v1A1.5 1.5 0 013.5 10h-1A1.5 1.5 0 011 8.5v-1zM7.5 6A1.5 1.5 0 006 7.5v1A1.5 1.5 0 007.5 10h1A1.5 1.5 0 0010 8.5v-1A1.5 1.5 0 008.5 6h-1zM11 7.5A1.5 1.5 0 0112.5 6h1A1.5 1.5 0 0115 7.5v1a1.5 1.5 0 01-1.5 1.5h-1A1.5 1.5 0 0111 8.5v-1zM2.5 11A1.5 1.5 0 001 12.5v1A1.5 1.5 0 002.5 15h1A1.5 1.5 0 005 13.5v-1A1.5 1.5 0 003.5 11h-1zM6 12.5A1.5 1.5 0 017.5 11h1a1.5 1.5 0 011.5 1.5v1A1.5 1.5 0 018.5 15h-1A1.5 1.5 0 016 13.5v-1zm6.5-1.5a1.5 1.5 0 00-1.5 1.5v1a1.5 1.5 0 001.5 1.5h1a1.5 1.5 0 001.5-1.5v-1a1.5 1.5 0 00-1.5-1.5h-1z"/>\n</svg>\n'},23942:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M9 5h2v2h-2z"/>\n  <path fill-opacity=".35" d="M5 1h2v2h-2v-2zm4 0h2v2h-2v-2zm4 0h2v2h-2v-2zm-12 4h2v2h-2v-2zm4 0h2v2h-2v-2zm8 0h2v2h-2v-2zm-12 4h2v2h-2v-2zm4 0h2v2h-2v-2zm4 0h2v2h-2v-2zm4 0h2v2h-2v-2zm-12 4h2v2h-2v-2zm4 0h2v2h-2v-2zm4 0h2v2h-2v-2z"/>\n  <path fill-opacity=".1" d="M5 5h-4v10h10v-4h4v-10h-10z"/>\n</svg>\n'},25531:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M9 1.288a1 1 0 00-1 0L2.5 4.461a1 1 0 00-.5.867v6.344a1 1 0 00.5.867L8 15.712a1 1 0 001 0l5.5-3.173a1 1 0 00.5-.867V5.328a1 1 0 00-.5-.867L9 1.288zM7.004 5.825A.75.75 0 017.75 5h1.343a.75.75 0 01.746.825l-.35 3.5a.75.75 0 01-.746.675H8.1a.75.75 0 01-.746-.675l-.35-3.5zm.417 5.925a.75.75 0 01.75-.75h.5a.75.75 0 01.75.75v.5a.75.75 0 01-.75.75h-.5a.75.75 0 01-.75-.75v-.5z"/></svg>\n'},32783:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="208" height="128" viewBox="0 0 208 128">\n\t<rect fill="none" stroke-width="10" width="198" height="118" x="5" y="5" ry="10" />\n\t<path stroke-width="0" d="m 30,98 0,-68 20,0 20,25 20,-25 20,0 0,68 -20,0 0,-39 -20,25 -20,-25 0,39 z" />\n\t<path stroke-width="0" d="m 155,98 -30,-33 20,0 0,-35 20,0 0,35 20,0 z" />\n</svg>\n'},75124:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M12.125 2.344a7 7 0 101.44 1.408L7.918 11.03a1 1 0 01-1.44.147.998.998 0 01-.345-.288L4.32 8.499A1 1 0 115.913 7.29l1.175 1.548 5.037-6.494z"/></svg>\n'},39135:e=>{e.exports='<svg viewBox="0 0 7 4" xmlns="http://www.w3.org/2000/svg"><path d="M3.5 4l-3.5-4h7z"/></svg>'},62525:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n      <path d="M12.6 7C9.507 7 7 9.506 7 12.6h1.6c0-2.206 1.794-4 4-4s4 1.794 4 4-1.794 4-4 4c-1.29 0-2.425-.623-3.157-1.573H7.56c.905 1.875 2.818 3.172 5.04 3.172 3.093 0 5.6-2.508 5.6-5.6 0-3.094-2.507-5.6-5.6-5.6"/>\n      <path d="M13 13H7V7l6 6z"/>\n</svg>'},76667:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M.784 13.53L7.118 1.653a1 1 0 011.764 0l6.334 11.875A1 1 0 0114.333 15H1.667a1 1 0 01-.883-1.47zm5.799-7.705A.75.75 0 017.329 5H8.67a.75.75 0 01.747.825l-.35 3.5A.75.75 0 018.32 10H7.68a.75.75 0 01-.746-.675l-.35-3.5zM7 11.75a.75.75 0 01.75-.75h.5a.75.75 0 01.75.75v.5a.75.75 0 01-.75.75h-.5a.75.75 0 01-.75-.75v-.5z"/></svg>\n'},12371:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path d="M11 15C11 15.5523 10.5523 16 10 16C9.44772 16 9 15.5523 9 15C9 14.4477 9.44772 14 10 14C10.5523 14 11 14.4477 11 15Z"/>\n  <path d="M14 15C14 15.5523 13.5523 16 13 16C12.4477 16 12 15.5523 12 15C12 14.4477 12.4477 14 13 14C13.5523 14 14 14.4477 14 15Z"/>\n  <path d="M17 15C17 15.5523 16.5523 16 16 16C15.4477 16 15 15.5523 15 15C15 14.4477 15.4477 14 16 14C16.5523 14 17 14.4477 17 15Z"/>\n  <path fill-rule="evenodd" d="M15.2222 7C13.3064 7 11.6041 8.03226 10.7673 9.58975C10.4836 9.53088 10.1896 9.5 9.88889 9.5C8.33443 9.5 6.94973 10.3278 6.25133 11.5896C4.93963 12.2253 4 13.5297 4 15.0833C4 17.3063 5.90238 19 8.11111 19H17.8889C20.0976 19 22 17.3063 22 15.0833C22 13.7239 21.2795 12.5539 20.221 11.8576C20.2218 11.8218 20.2222 11.7859 20.2222 11.75C20.2222 9.06683 17.9219 7 15.2222 7ZM12.3078 11.0947C12.6187 9.92977 13.7733 9 15.2222 9C16.9409 9 18.2222 10.291 18.2222 11.75C18.2222 11.9148 18.2065 12.0754 18.1766 12.231L18.0233 13.0279L18.7717 13.3419C19.5266 13.6587 20 14.3421 20 15.0833C20 16.0821 19.1166 17 17.8889 17H8.11111C6.8834 17 6 16.0821 6 15.0833C6 14.3101 6.51675 13.5977 7.32859 13.3027L7.74278 13.1522L7.91117 12.745C8.20096 12.0441 8.95509 11.5 9.88889 11.5C10.2579 11.5 10.6004 11.5855 10.8973 11.7327L11.9926 12.2759L12.3078 11.0947Z"/>\n</svg>\n'},30249:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M5 10C5.55228 10 6 9.55228 6 9C6 8.44772 5.55228 8 5 8C4.44772 8 4 8.44772 4 9C4 9.55228 4.44772 10 5 10Z"/>\n  <path d="M8 10C8.55228 10 9 9.55228 9 9C9 8.44772 8.55228 8 8 8C7.44772 8 7 8.44772 7 9C7 9.55228 7.44772 10 8 10Z"/>\n  <path d="M12 9C12 9.55228 11.5523 10 11 10C10.4477 10 10 9.55228 10 9C10 8.44772 10.4477 8 11 8C11.5523 8 12 8.44772 12 9Z"/>\n  <path fill-rule="evenodd" d="M6.06137 4.79152C6.88693 3.69117 8.2498 3 9.75 3C11.971 3 13.9354 4.53945 14.2158 6.67358C15.2565 7.2517 16 8.31987 16 9.6C16 11.5612 14.2953 13 12.3663 13H3.63375C1.71373 13 0 11.559 0 9.6C0 8.25863 0.810198 7.14916 1.93276 6.59292C2.38358 5.39217 3.6016 4.6 4.9375 4.6C5.33032 4.6 5.70959 4.66698 6.06137 4.79152ZM9.75 5C8.60263 5 7.6952 5.67043 7.37686 6.50514L6.86674 7.84271L5.7864 6.90347C5.57817 6.72244 5.28239 6.6 4.9375 6.6C4.26343 6.6 3.82196 7.04773 3.75852 7.4773L3.66694 8.09744L3.06887 8.28526C2.39216 8.49778 2 9.04475 2 9.6C2 10.2858 2.64177 11 3.63375 11H12.3663C13.365 11 14 10.29 14 9.6C14 9.05326 13.6102 8.50615 12.9389 8.28911L12.2278 8.05923L12.25 7.18864C12.2431 6.05963 11.2128 5 9.75 5Z"/>\n</svg>\n'},81606:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M8 1a7 7 0 100 14A7 7 0 008 1zm.648 10.758l3.084-2.68c.357-.323.357-.946 0-1.269a.989.989 0 00-1.297 0L9 9.179V5c0-.5-.494-1-1-1s-1 .5-1 1v4.178L5.565 7.81a.989.989 0 00-1.297 0c-.357.323-.357.946 0 1.27l3.084 2.679a.989.989 0 001.296 0z"/></svg>\n'},21776:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path d="M10.2132 18H18.6296C20.491 18 22 16.4965 22 14.6418C22 13.2753 21.1809 12.0994 20.0051 11.5751C20.0504 11.3248 20.0741 11.0671 20.0741 10.8038C20.0741 10.0367 19.8733 9.3163 19.5212 8.69196L10.2132 18Z"/>\n  <path d="M18.3595 7.02522C17.5821 6.38468 16.586 6 15.5 6C13.3927 6 11.6237 7.44854 11.1344 9.40423C10.6465 9.14615 10.0903 9 9.5 9C8.01292 9 6.74245 9.92742 6.23543 11.2354C4.92742 11.7425 4 13.0129 4 14.5C4 16.395 5.50607 17.9383 7.38657 17.9982L18.3595 7.02522Z"/>\n</svg>\n'},71775:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M10 3C10.8495 3 11.6369 3.26446 12.2844 3.71557L3.00002 13C1.34062 12.9946 0 11.6497 0 10C0 8.686 0.84 7.57 2.022 7.164C2.187 5.942 3.232 5 4.5 5C5.167 5 5.772 5.26 6.22 5.686C6.765 4.123 8.25 3 10 3Z"/>\n  <path d="M13.2844 4.71558L5 13H12.99C14.663 13 16 11.657 16 10C16 8.69701 15.164 7.58501 13.996 7.17201L14 7.00001C14 6.15055 13.7356 5.36314 13.2844 4.71558Z"/>\n</svg>\n'},38668:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path d="M19 12C19 12.0568 18.9988 12.1133 18.9965 12.1695C20.1635 12.5803 21 13.6925 21 15C21 16.6569 19.6569 18 18 18H8C6.34315 18 5 16.6569 5 15C5 13.6462 5.89669 12.5019 7.12853 12.1285C7.50189 10.8967 8.64623 10 10 10C10.4917 10 10.9557 10.1183 11.3652 10.3279C11.9984 8.9538 13.3878 8 15 8C17.2091 8 19 9.79086 19 12Z"/>\n</svg>\n'},45016:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M13.996 7.172C15.164 7.585 16 8.697 16 10C16 11.657 14.663 13 12.99 13H3.01C1.346 13 0 11.653 0 10C0 8.686 0.84 7.57 2.022 7.164C2.187 5.942 3.232 5 4.5 5C5.167 5 5.772 5.26 6.22 5.686C6.765 4.123 8.25 3 10 3C12.21 3 14 4.79 14 7L13.996 7.172Z"/>\n</svg>\n'},3117:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M15.2222 7C13.3064 7 11.6041 8.03226 10.7673 9.58975C10.4836 9.53088 10.1896 9.5 9.88889 9.5C8.33443 9.5 6.94973 10.3278 6.25133 11.5896C4.93963 12.2253 4 13.5297 4 15.0833C4 17.3063 5.90238 19 8.11111 19H17.8889C20.0976 19 22 17.3063 22 15.0833C22 13.7239 21.2795 12.5539 20.221 11.8576C20.2218 11.8218 20.2222 11.7859 20.2222 11.75C20.2222 9.06683 17.9219 7 15.2222 7ZM12.3078 11.0947C12.6187 9.92977 13.7733 9 15.2222 9C16.9409 9 18.2222 10.291 18.2222 11.75C18.2222 11.9148 18.2065 12.0754 18.1766 12.231L18.0233 13.0279L18.7717 13.3419C19.5266 13.6587 20 14.3421 20 15.0833C20 16.0821 19.1166 17 17.8889 17H8.11111C6.8834 17 6 16.0821 6 15.0833C6 14.3101 6.51675 13.5977 7.32859 13.3027L7.74278 13.1522L7.91117 12.745C8.20096 12.0441 8.95509 11.5 9.88889 11.5C10.2579 11.5 10.6004 11.5855 10.8973 11.7327L11.9926 12.2759L12.3078 11.0947Z"/>\n</svg>\n'},29832:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M9.75 3C8.2498 3 6.88693 3.69117 6.06137 4.79152C5.70959 4.66698 5.33032 4.6 4.9375 4.6C3.6016 4.6 2.38358 5.39217 1.93276 6.59292C0.810198 7.14916 0 8.25863 0 9.6C0 11.559 1.71373 13 3.63375 13H12.3663C14.2953 13 16 11.5612 16 9.6C16 8.31987 15.2565 7.2517 14.2158 6.67358C13.9354 4.53945 11.971 3 9.75 3ZM7.37686 6.50514C7.6952 5.67043 8.60263 5 9.75 5C11.2128 5 12.2431 6.05963 12.25 7.18864L12.2278 8.05923L12.9389 8.28911C13.6102 8.50615 14 9.05326 14 9.6C14 10.29 13.365 11 12.3663 11H3.63375C2.64177 11 2 10.2858 2 9.6C2 9.04475 2.39216 8.49778 3.06887 8.28526L3.66694 8.09744L3.75852 7.4773C3.82196 7.04773 4.26343 6.6 4.9375 6.6C5.28239 6.6 5.57817 6.72244 5.7864 6.90347L6.86674 7.84271L7.37686 6.50514Z"/>\n</svg>\n'},76611:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M8 15A7 7 0 108 1a7 7 0 000 14zM7.352 4.242l-3.084 2.68c-.357.323-.357.946 0 1.269a.989.989 0 001.297 0L7 6.821V11c0 .5.494 1 1 1s1-.5 1-1V6.822l1.435 1.369a.989.989 0 001.296 0c.358-.323.358-.946 0-1.27L8.649 4.243a.989.989 0 00-1.296 0z"/></svg>\n'},89016:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">\n  <path d="M1 18v3h3c0-1.66-1.34-3-3-3zm0-4v2c2.76 0 5 2.24 5 5h2c0-3.87-3.13-7-7-7zm0-4v2c4.97 0 9 4.03 9 9h2c0-6.08-4.93-11-11-11zm20-7H3c-1.1 0-2 .9-2 2v3h2V5h18v14h-7v2h7c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"/>\n</svg>\n'},43380:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16">\n  <path d="m12.5 5-1.4-1.4-3.1 3-3.1-3L3.5 5l3.1 3.1-3 2.9 1.5 1.4L8 9.5l2.9 2.9 1.5-1.4-3-2.9"/>\n</svg>\n'},61373:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M8 16A8 8 0 108 0a8 8 0 000 16zm0-2A6 6 0 108 2a6 6 0 000 12z"/>\n</svg>\n'},1149:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M7.998 0C5.24 0 4 2 4 4v2h-.502A2.5 2.5 0 001 8.5v5A2.5 2.5 0 003.498 16h9a2.5 2.5 0 002.498-2.5v-5A2.5 2.5 0 0012.498 6h-.502V4c0-2-1.239-4-3.998-4zm1.999 6V4c0-1-.344-2-1.999-2C6.344 2 6 3 6 4v2h3.997zM3 8.5a.5.5 0 01.498-.5h9a.5.5 0 01.498.5v5a.5.5 0 01-.498.5h-9A.5.5 0 013 13.5v-5zM8 13a2 2 0 100-4 2 2 0 000 4zm0-1a1 1 0 100-2 1 1 0 000 2z"/>\n</svg>\n'},19016:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M7.2 0C3.157.402 0 3.822 0 7.98 0 12.41 3.582 16 8 16a7.983 7.983 0 006.494-3.335l-1.738-1.006A6 6 0 117.2 2.053V0z"/>\n  <path opacity=".5" fill-rule="evenodd" d="M16 7.98c0 1.175-.252 2.29-.705 3.296l-1.74-1.006A6.001 6.001 0 008.8 2.053V0c4.044.402 7.201 3.822 7.201 7.98z"/>\n</svg>\n'},26055:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M7.352 1.242l-3.084 2.68c-.357.323-.357.946 0 1.269a.989.989 0 001.297 0L7 3.821V11c0 .5.494 1 1 1s1-.5 1-1V3.822l1.435 1.369a.989.989 0 001.296 0c.358-.323.358-.946 0-1.27L8.649 1.243a.989.989 0 00-1.296 0z"/>\n  <path d="M0 11v2.5A2.5 2.5 0 002.498 16h11a2.5 2.5 0 002.498-2.5V11h-2v2.5a.5.5 0 01-.498.5h-11A.5.5 0 012 13.5V11H0z"/>\n</svg>\n'},11826:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M7 6C5.34315 6 4 7.34315 4 9V17C4 18.6569 5.34315 20 7 20H19C20.6569 20 22 18.6569 22 17V9C22 7.34315 20.6569 6 19 6H7ZM6 9C6 8.44772 6.44772 8 7 8H19C19.5523 8 20 8.44772 20 9V17C20 17.5523 19.5523 18 19 18H7C6.44772 18 6 17.5523 6 17V9Z"/>\n  <rect style="display: var(--displayTileRow)" opacity="0.5" x="12" y="8" width="2" height="10"/>\n  <rect style="display: var(--displayTileColumn)" opacity="0.5" x="6" y="12" width="14" height="2"/>\n</svg>\n'},1313:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M3 2C1.34315 2 0 3.34315 0 5V11C0 12.6569 1.34315 14 3 14H13C14.6569 14 16 12.6569 16 11V5C16 3.34315 14.6569 2 13 2H3ZM2 5C2 4.44772 2.44772 4 3 4H13C13.5523 4 14 4.44772 14 5V11C14 11.5523 13.5523 12 13 12H3C2.44772 12 2 11.5523 2 11V5Z"/>\n  <rect style="display: var(--displayTileRow)" opacity="0.5" x="7" y="4" width="2" height="8"/>\n  <rect style="display: var(--displayTileColumn)" opacity="0.5" x="2" y="7" width="12" height="2"/>\n</svg>\n'},67567:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M8 6C8 5.44772 7.55228 5 7 5H1C0.447715 5 0 5.44772 0 6V10C0 10.5523 0.447715 11 1 11H15C15.5523 11 16 10.5523 16 10C16 9.44772 15.5523 9 15 9H9C8.44771 9 8 8.55228 8 8V6Z"/>\n  <rect opacity="0.35" x="9" y="5" width="7" height="3" rx="1"/>\n</svg>\n'},47746:e=>{e.exports='<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M8 5C6.34314 5 5 6.34314 5 8V18C5 19.6569 6.34314 21 8 21H18C19.6569 21 21 19.6569 21 18V8C21 6.34314 19.6569 5 18 5H8ZM8 14H12V18H14V14H18V12H14V8H12V12H8V14Z"/>\n</svg>\n'},89702:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" d="M4 2C2.89543 2 2 2.89543 2 4V12C2 13.1046 2.89543 14 4 14H12C13.1046 14 14 13.1046 14 12V4C14 2.89543 13.1046 2 12 2H4ZM7 4H9V7H12V9H9V12H7V9H4V7H7V4Z"/>\n</svg>\n'},43085:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path opacity=".6" d="M8.531 12.067a1 1 0 01-1.062 0L2.628 9.03a1 1 0 00-1.058-.003l-.203.126a1 1 0 00-.004 1.698L7.47 14.67a1 1 0 001.06 0l6.107-3.817a1 1 0 00-.004-1.698l-.203-.126a1 1 0 00-1.058.003l-4.84 3.036z"/>\n  <path d="M1.357 6.848a1 1 0 010-1.696l6.113-3.82a1 1 0 011.06 0l6.113 3.82a1 1 0 010 1.696l-6.113 3.82a1 1 0 01-1.06 0l-6.113-3.82z"/>\n</svg>\n'},95846:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M2 1a1 1 0 0 0-1 1v9.293l2.146-2.147a.5.5 0 0 1 .708 0L5.5 10.793l4.646-4.647a.5.5 0 0 1 .708 0L15 10.293V2a1 1 0 0 0-1-1H2ZM0 12.5V14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2a2 2 0 0 0-2 2v10.5ZM15 14v-2.293l-4.5-4.5-4.646 4.647a.5.5 0 0 1-.708 0L3.5 10.207l-2.5 2.5V14a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1ZM4 5a1 1 0 1 1 2 0 1 1 0 0 1-2 0Zm1-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4Z"/>\n</svg>\n'},94411:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n    <path fill-rule="evenodd" d="M3.055 6.549c.052.082.111.156.176.222l4.905 6.065c.45.693 1.34.868 2.193.79.899-.084 1.94-.453 2.93-1.069.99-.614 1.783-1.384 2.256-2.152.449-.73.687-1.604.266-2.316l-3.26-7.088a1.329 1.329 0 0 0-.141-.287c-.243-.374-.638-.572-1.055-.658-.424-.086-.916-.068-1.433.023-1.037.183-2.276.682-3.49 1.435-1.213.753-2.209 1.643-2.833 2.49-.311.423-.546.857-.656 1.275-.11.415-.106.86.128 1.247l.014.023Zm8.477-5.303c-.056-.076-.17-.161-.408-.21-.258-.053-.615-.05-1.058.028-.883.156-2.003.596-3.136 1.3-1.133.703-2.024 1.512-2.556 2.234-.266.362-.427.68-.494.936-.061.233-.037.373.007.457l.08.099a.765.765 0 0 0 .351.15c.259.052.616.05 1.058-.028.883-.156 2.004-.597 3.136-1.3 1.133-.703 2.025-1.512 2.556-2.234.267-.362.427-.681.494-.936a.763.763 0 0 0 .022-.383l-.052-.113Zm.687 1.493c-.1.178-.216.356-.345.532-.625.847-1.62 1.737-2.834 2.49-1.213.754-2.453 1.252-3.49 1.435a5.116 5.116 0 0 1-.629.074l4.01 4.96a.498.498 0 0 1 .036.05c.138.222.524.418 1.27.35.714-.066 1.607-.371 2.494-.922.887-.55 1.557-1.217 1.932-1.827.393-.639.388-1.072.25-1.293a.499.499 0 0 1-.03-.055L12.22 2.739ZM4.5 13.5a2 2 0 0 1-4 0c0-2 2-4 2-4s2 2 2 4Z"/>\n</svg>\n'},95369:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path d="m3 6.5-.4-.1L.1 3.9c-.1-.2-.1-.6 0-.8l3-3c.2-.1.6-.1.8 0l2.5 2.5c.2.2.2.5 0 .7s-.5.2-.7 0L3.5 1.2 1.2 3.5l2.1 2.1c.2.2.2.5 0 .7 0 .2-.2.2-.3.2zM15.5 16h-.1l-4-1-.2-.1-1.5-1.5c-.2-.2-.2-.5 0-.7s.5-.2.7 0l1.4 1.4 3.1.8-.9-3.1-1.4-1.4c-.2-.2-.2-.5 0-.7s.5-.2.7 0l1.5 1.5.1.2 1 4-.1.5-.3.1zm-11 0-.4-.1-4-4-.1-.4.1-.4 11-11c.2-.2.5-.2.7 0l4 4c.2.2.2.5 0 .7l-11 11c0 .2-.2.2-.3.2zm-3.3-4.5 3.3 3.3L14.8 4.5l-3.3-3.3L1.2 11.5z" />\n  <path d="m4.5 11-.4-.1-1.5-1.5c-.2-.2-.2-.5 0-.7s.5-.2.7 0l1.5 1.5c.2.2.2.5 0 .7l-.3.1zm2-2-.4-.1-1.5-1.5c-.2-.2-.2-.5 0-.7s.5-.2.7 0l1.5 1.5c.2.1.2.5.1.7l-.4.1zm2-2-.4-.1-1.5-1.5c-.2-.2-.2-.5 0-.7s.5-.2.7 0l1.5 1.5c.2.1.2.5.1.7l-.4.1zm2-2-.4-.1-1.5-1.5c-.2-.2-.2-.5 0-.7s.5-.2.7 0l1.5 1.5c.2.2.2.5 0 .7l-.3.1z" />\n</svg>'},36561:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48">\n  <path fill-rule="evenodd" d="M41 4a3 3 0 0 0-2.1.9L23.5 19.5a8.2 8.2 0 0 1 3 1.9 8.3 8.3 0 0 1 2 3L43 9.2A3 3 0 0 0 41 4ZM29 26.8l15.5-16.2a5 5 0 0 0-7-7.1L21.1 19a8.3 8.3 0 0 0-6.4 2.4c-1 1-1.6 2.4-2 3.8a34.1 34.1 0 0 0-1.7 9 60.2 60.2 0 0 0 0 1.6l-.1.1 1 .1h-1v1h1v-1 1h.2a37.8 37.8 0 0 0 5.8-.7c1.6-.2 3.3-.6 4.8-1a9.6 9.6 0 0 0 3.8-2 8.3 8.3 0 0 0 2.4-6.5ZM3 7a4 4 0 0 1 4-4h21v2H7a2 2 0 0 0-2 2v34c0 1.1.9 2 2 2h34a2 2 0 0 0 2-2V20h2v21a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V7Zm17.7 14A6.3 6.3 0 0 1 25 31.8c-.5.6-1.5 1-3 1.5a32.2 32.2 0 0 1-8.4 1.6H13a62.3 62.3 0 0 1 1.6-9c.4-1.5 1-2.5 1.5-3a6.3 6.3 0 0 1 4.5-2Z" />\n  <circle cx="41" cy="41" r="7" fill="var(--colorFgIntense)" />\n  <path fill-rule="evenodd" d="M40 42v2h2v-2h2v-2h-2v-2h-2v2h-2v2h2Z" fill="var(--colorBgIntense)" />\n</svg>\n'},71475:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M7 0a.5.5 0 0 0-.493.418l-.311 1.865a5.957 5.957 0 0 0-.963.398L3.694 1.583a.5.5 0 0 0-.644.053L1.636 3.05a.5.5 0 0 0-.053.644l1.098 1.54c-.16.306-.293.627-.398.962l-1.865.31A.5.5 0 0 0 0 7v2a.5.5 0 0 0 .418.493l1.865.311c.105.335.239.656.398.963l-1.098 1.539a.5.5 0 0 0 .053.644l1.414 1.414a.5.5 0 0 0 .644.053l1.54-1.098c.306.16.627.293.962.398l.31 1.865A.5.5 0 0 0 7 16h2a.5.5 0 0 0 .493-.418l.311-1.865c.335-.105.656-.239.963-.398l1.538 1.099a.5.5 0 0 0 .645-.053l1.414-1.414a.5.5 0 0 0 .053-.644l-1.098-1.54c.16-.307.293-.628.398-.963l1.865-.31A.5.5 0 0 0 16 9V7a.5.5 0 0 0-.418-.493l-1.865-.311a5.955 5.955 0 0 0-.398-.963l1.099-1.538a.5.5 0 0 0-.054-.645L12.95 1.636a.5.5 0 0 0-.643-.053l-1.54 1.098a5.958 5.958 0 0 0-.962-.398L9.494.418A.5.5 0 0 0 9 0H7Zm.13 2.76L7.424 1h1.152l.294 1.76a.5.5 0 0 0 .37.401c.465.12.903.302 1.305.54a.5.5 0 0 0 .546-.022l1.451-1.036.816.815L12.32 4.91a.5.5 0 0 0-.023.546c.239.402.421.84.54 1.306a.5.5 0 0 0 .403.37L15 7.423v1.152l-1.76.294a.5.5 0 0 0-.401.37c-.12.465-.302.903-.54 1.305a.5.5 0 0 0 .022.545l1.036 1.453-.815.815-1.451-1.037a.5.5 0 0 0-.546-.023c-.402.239-.84.421-1.306.54a.5.5 0 0 0-.37.403L8.577 15H7.424l-.294-1.76a.5.5 0 0 0-.37-.401 4.964 4.964 0 0 1-1.305-.54.5.5 0 0 0-.545.022l-1.452 1.036-.815-.815 1.036-1.451a.5.5 0 0 0 .023-.546 4.963 4.963 0 0 1-.54-1.306.5.5 0 0 0-.403-.37L1 8.577V7.424l1.76-.294a.5.5 0 0 0 .401-.37c.12-.465.302-.903.54-1.305a.5.5 0 0 0-.022-.545L2.643 3.458l.815-.815L4.91 3.679a.5.5 0 0 0 .545.023c.402-.239.84-.421 1.306-.54a.5.5 0 0 0 .37-.403ZM6 8a2 2 0 1 1 4 0 2 2 0 0 1-4 0Zm2-3a3 3 0 1 0 0 6 3 3 0 0 0 0-6Z"/>\n</svg>\n'},35024:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M5.976 11c-1.92.537-1.91 1.258-2.323 2.9C3.24 15.54 1 15.673 1 15.673c8.832 1.68 7.978-3.656 7.978-3.656C6.798 12.267 5.976 11 5.976 11M14 1.127c-.868-.316-1.91-.022-2.316.652l-.17.28c-.94.748-1.934 1.895-2.758 3.264C7.932 6.692 7.436 8.02 7.3 9.062l-.16.265c-.406.674-.03 1.484.838 1.8.866.316 1.908.023 2.314-.652l.202-.336c.92-.75 1.884-1.872 2.686-3.205s1.293-2.627 1.445-3.656l.212-.353c.406-.674.03-1.484-.838-1.8" />\n</svg>\n'},67905:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M8.5 11L4.86568 7.36568C4.36171 6.86171 4.71865 6 5.43137 6L11.5686 6C12.2814 6 12.6383 6.86171 12.1343 7.36569L8.5 11Z"/>\n</svg>\n'},29295:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M13.848 3.349v.99H12.63c-.457 1.264-1.074 2.297-1.852 3.15.871.675 1.937 1.18 3.222 1.47-.245.247-.567.725-.719 1.015-1.361-.35-2.46-.922-3.349-1.682C9.5 9 9 9.5 8 10l-.638-.969C8.053 8.708 9 8 9.162 7.533c-.76-.88-1.344-1.947-1.8-3.194h-1.21v-.99h3.315V2h1.024v1.349h3.357zM9.992 6.773c.608-.666 1.09-1.469 1.454-2.434H8.478c.363.922.862 1.742 1.514 2.434z"/>\n  <path d="M5.846 11.558H3.15L2.636 13H1l2.78-7h1.425L8 13H6.364l-.518-1.442zm-2.282-1.169h1.867l-.939-2.62-.928 2.62z"/>\n</svg>\n'},67757:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n<path class="trashicon-lid" d="M15.5 7c-.276 0-.5-.224-.5-.5l-.001-1.03c-.016-.262-.233-.47-.499-.47h-4c-.267 0-.485.209-.499.473l-.001 1.027c0 .276-.224.5-.5.5h-2.5c-.552 0-1 .448-1 1s.448 1 1 1h11c.552 0 1-.448 1-1s-.448-1-1-1h-2.5z"/>\n<path class="trashicon-bin" d="M17 10c.552 0 1 .448 1 1v8c0 1.105-.895 2-2 2h-7c-1.105 0-2-.895-2-2v-8l.007-.117c.058-.497.48-.883.993-.883s.936.386.993.883l.007.117v7c0 .552.448 1 1 1h5c.552 0 1-.448 1-1v-7l.007-.117c.058-.497.481-.883.993-.883z"/>\n<path class="trashicon-content" opacity=".3" d="M10 10v8h1v-8h-1zM12 10v8h1v-8h-1zM14 18v-8h1v8h-1z"/>\n</svg>\n'},14302:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path opacity="0.35" d="M7 5V12H9V5H7Z"/>\n  <path d="M10.5 2C10.2239 2 10 1.77614 10 1.5C10 1.22386 9.77614 1 9.5 1H6.5C6.22386 1 6 1.22386 6 1.5C6 1.77614 5.77614 2 5.5 2H4C3.44772 2 3 2.44772 3 3C3 3.55228 3.44772 4 4 4H12C12.5523 4 13 3.55228 13 3C13 2.44772 12.5523 2 12 2H10.5Z"/>\n  <path d="M4 5V12C4 13.6569 5.34315 15 7 15H9C10.6569 15 12 13.6569 12 12V5H10V12C10 12.5523 9.55228 13 9 13H7C6.44772 13 6 12.5523 6 12V5H4Z"/>\n</svg>\n'},3895:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path d="M10.5 3a.5.5 0 0 1-.5-.5.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5.5.5 0 0 1-.5.5H4a1 1 0 0 0-1 1h10a1 1 0 0 0-1-1h-1.5ZM4 5v7.5A1.5 1.5 0 0 0 5.5 14h5a1.5 1.5 0 0 0 1.5-1.5V5h-1v7.5a.5.5 0 0 1-.5.5h-5a.5.5 0 0 1-.5-.5V5H4Z"/>\n  <path opacity=".3" d="M6 5v7h4V5H6Z"/>\n</svg>\n'},85382:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n\t<path d="M8,6.5c0.8,0,1.5,0.7,1.5,1.5S8.8,9.5,8,9.5S6.5,8.8,6.5,8S7.2,6.5,8,6.5 M8,5C6.3,5,5,6.3,5,8s1.3,3,3,3s3-1.3,3-3\n\t\tS9.7,5,8,5L8,5z"/>\n</svg>\n'},88826:e=>{e.exports='<svg width="16" height="16" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <circle strokeWidth="2" cx="8" cy="8" r="3"/>\n</svg>\n'},33271:e=>{e.exports='<svg width="196" height="32" xmlns="http://www.w3.org/2000/svg">\n  <path class="border" d="M2 .5h192a1.5 1.5 0 011.5 1.5v28a1.5 1.5 0 01-1.5 1.5H2A1.5 1.5 0 01.5 30V2A1.5 1.5 0 012 .5z"/>\n  <path d="M1 24h12v1H1z"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M0 25V7h10v18H0zM1 8h8v16H1V8zM100 11v10h10V11h-10zm9 1h-8v8h8v-8z"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M13 8h80v17h102v-1h-17V7H96v17h-2V7H12v18h1V8zm84 16h80V8H97v16z"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M16 11v10h10V11H16zm9 1h-8v8h8v-8z"/>\n  <path fill="var(--colorBg)" d="M166 6a2 2 0 012-2h11a2 2 0 012 2v11a2 2 0 01-2 2h-11a2 2 0 01-2-2V6z"/>\n  <path class="highlight" fill-rule="evenodd" clip-rule="evenodd" d="M179 5h-11a1 1 0 00-1 1v11a1 1 0 001 1h11a1 1 0 001-1V6a1 1 0 00-1-1zm-11-1a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2V6a2 2 0 00-2-2h-11z"/>\n  <path class="highlight" d="M170 7h8v8l-8-8z"/>\n</svg>\n'},48013:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26">\n  <path d="M17.03 7.4l-3.18 3.18a.5.5 0 01-.85-.35v-3.3a6.15 6.15 0 00-2.36 11.83c.45.19.78.62.75 1.11-.04.63-.63 1.07-1.22.86A8.15 8.15 0 0113 4.93V2.76a.5.5 0 01.85-.35l4.09 4.08-.88.88a.7.7 0 01-.03.03zm1.38 2.76c.18.32.54.5.9.42l.23-.06c.59-.15.92-.78.63-1.31-.3-.55-1.04-.62-1.48-.18l-.16.17a.81.81 0 00-.12.96zm.73 3.23c.03-.5.34-.96.83-1.08.6-.15 1.19.25 1.18.86a8.2 8.2 0 01-.18 1.6c-.13.62-.82.88-1.37.57a1.15 1.15 0 01-.54-1.22c.04-.24.07-.48.08-.73zm-1.8 4.04a.79.79 0 01.94-.16l.22.13c.54.3.7 1 .26 1.44a8.11 8.11 0 01-3.96 2.19c-.6.14-1.13-.38-1.1-1 .04-.5.42-.88.9-1 1-.28 1.96-.8 2.75-1.6z" clip-rule="evenodd"/>\n</svg>\n'},27470:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path d="M10.31 4.55L8.87 5.98a.5.5 0 01-.85-.35V3.87a4.2 4.2 0 00-2.98 7.2 4.22 4.22 0 005.19.62l1.4 1.47a6.22 6.22 0 11-3.6-11.29V.5a.5.5 0 01.84-.35l2.92 2.91-.04.05-1.44 1.44zm1.2 5.91a4.2 4.2 0 00.73-2.18l2-.25a6.2 6.2 0 01-1.33 3.9l-1.4-1.47zm2.56-3.83l-2 .25a4.2 4.2 0 00-.5-1.08L13 4.37c.52.69.88 1.46 1.07 2.26z" clip-rule="evenodd"/>\n</svg>\n'},1293:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">\n  <path d="M10.74 4.14L8.95 5.93a.5.5 0 01-.85-.36V3.31a4.59 4.59 0 00-3.25 7.86 4.6 4.6 0 005.8.57l.7.74A5.6 5.6 0 118.1 2.3v-1.1a.5.5 0 01.85-.36l2.54 2.54-.04.04-.71.71zm1.07 6.5c.58-.79.88-1.72.89-2.66l1-.12a5.58 5.58 0 01-1.2 3.51l-.7-.73zm1.73-4.04l-1 .12c-.13-.5-.36-1-.67-1.44l.72-.72c.46.62.78 1.32.95 2.04z" clip-rule="evenodd"/>\n</svg>\n'},1652:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg"><path d="M14 6V2h-4c0-1.1-.9-2-2-2S6 .9 6 2H2v4c1.1 0 2 .9 2 2s-.9 2-2 2v4h4c0-1.1.9-2 2-2s2 .9 2 2h4v-4c1.1 0 2-.9 2-2s-.9-2-2-2z"/></svg>'},9390:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path opacity="0.35" fill-rule="evenodd" d="M8 6C6.34315 6 5 7.34315 5 9V17C5 18.6569 6.34315 20 8 20H18C19.6569 20 21 18.6569 21 17V9C21 7.34315 19.6569 6 18 6H8ZM7 9C7 8.44772 7.44772 8 8 8H18C18.5523 8 19 8.44772 19 9V17C19 17.5523 18.5523 18 18 18H8C7.44772 18 7 17.5523 7 17V9Z"/>\n  <rect x="8" y="9" width="10" height="5" rx="1"/>\n</svg>\n'},44278:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path opacity=".35" fill-rule="evenodd" clip-rule="evenodd" d="M3 1a3 3 0 00-3 3v8a3 3 0 003 3h10a3 3 0 003-3V4a3 3 0 00-3-3H3zM2 4a1 1 0 011-1h10a1 1 0 011 1v8a1 1 0 01-1 1H3a1 1 0 01-1-1V4z"/>\n  <rect x="3" y="4" width="10" height="5" rx="1"/>\n</svg>\n'},22493:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path opacity="0.35" fill-rule="evenodd" d="M8 6C6.34315 6 5 7.34315 5 9V17C5 18.6569 6.34315 20 8 20H18C19.6569 20 21 18.6569 21 17V9C21 7.34315 19.6569 6 18 6H8ZM7 9C7 8.44772 7.44772 8 8 8H18C18.5523 8 19 8.44772 19 9V17C19 17.5523 18.5523 18 18 18H8C7.44772 18 7 17.5523 7 17V9Z"/>\n  <rect x="8" y="9" width="5" height="8" rx="1"/>\n</svg>\n'},98434:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path opacity=".35" fill-rule="evenodd" clip-rule="evenodd" d="M3 1a3 3 0 00-3 3v8a3 3 0 003 3h10a3 3 0 003-3V4a3 3 0 00-3-3H3zM2 4a1 1 0 011-1h10a1 1 0 011 1v8a1 1 0 01-1 1H3a1 1 0 01-1-1V4z"/>\n  <rect x="3" y="4" width="5" height="8" rx="1"/>\n</svg>\n'},16619:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path opacity="0.35" fill-rule="evenodd" clip-rule="evenodd" d="M8 6C6.34315 6 5 7.34315 5 9V17C5 18.6569 6.34315 20 8 20H18C19.6569 20 21 18.6569 21 17V9C21 7.34315 19.6569 6 18 6H8ZM7 9C7 8.44772 7.44772 8 8 8H18C18.5523 8 19 8.44772 19 9V17C19 17.5523 18.5523 18 18 18H8C7.44772 18 7 17.5523 7 17V9Z"/>\n  <rect x="8" y="9" width="7" height="8" rx="1"/>\n</svg>\n'},88111:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M4 1.167h8a3 3 0 013 3v7.666a3 3 0 01-3 3H4a3 3 0 01-3-3V4.167a3 3 0 013-3zm0 1a2 2 0 00-2 2v7.666a2 2 0 002 2h8a2 2 0 002-2V4.167a2 2 0 00-2-2H4z"/>\n  <path d="M11.691 11.962a.499.499 0 00.16-.106l.005-.005A.498.498 0 0012 11.5v-5a.5.5 0 00-1 0v3.793L6.854 6.146a.5.5 0 10-.708.708L10.293 11H6.5a.5.5 0 000 1h5.003a.501.501 0 00.188-.038z"/>\n</svg>\n'},23634:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M4 1.167h8a3 3 0 013 3v7.666a3 3 0 01-3 3H4a3 3 0 01-3-3V4.167a3 3 0 013-3zm0 1a2 2 0 00-2 2v7.666a2 2 0 002 2h8a2 2 0 002-2V4.167a2 2 0 00-2-2H4z"/>\n  <path d="M4.309 4.038A.498.498 0 004 4.5v5a.5.5 0 001 0V5.707l4.146 4.147a.5.5 0 00.708-.708L5.707 5H9.5a.5.5 0 000-1h-5-.003a.5.5 0 00-.188.038z"/>\n</svg>\n'},80162:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M13.962 2.309A.5.5 0 0013.5 2h-5a.5.5 0 000 1h3.793L8.146 7.146a.5.5 0 10.708.708L13 3.707V7.5a.5.5 0 001 0v-5-.003a.5.5 0 00-.038-.188zM2 9.5a.5.5 0 01.5-.5h4a.5.5 0 01.5.5v4a.5.5 0 01-.5.5h-4a.5.5 0 01-.5-.5v-4zm1 .5v3h3v-3H3z" />\n</svg>'},37609:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22">\n    <path d="M3 5h16v2H3zM3 10h16v2H3zM3 15h16v2H3z"/>\n</svg>\n'},3783:e=>{e.exports='\x3c!-- Monochrome --\x3e\n<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 22" width="22" height="22">\n  <path d="M18.6 3.4C17.1 2 14.9 2 11 2S4.9 2 3.4 3.4C2 4.9 2 7.1 2 11s0 6.1 1.4 7.6C4.9 20 7.1 20 11 20s6.1 0 7.6-1.4C20 17.1 20 14.9 20 11s0-6.1-1.4-7.6zm-2.2 5.2l-4.2 7.2c-.3.4-.6.7-1.1.8-.6 0-1-.2-1.3-.7-.9-1.5-1.7-3-2.6-4.5-.5-.9-1.1-1.8-1.6-2.8-.6-.9 0-2 1.1-2.1.6 0 1 .2 1.3.7.4.7.8 1.3 1.2 2 .3.5.6 1 .8 1.5.4.7 1 1.1 1.8 1.1 1.2.1 2.2-.8 2.4-2v-.2c0-.4-.1-.7-.2-1-.4-.9 0-1.8 1-2 .8-.2 1.6.4 1.7 1.2 0 .2-.1.5-.3.8z"/>\n</svg>\n'},38151:e=>{e.exports='<svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">\n  <path d="M16 32c7.011 0 10.91 0 13.454-2.546C32 26.91 32 23.011 32 16c0-7.011 0-10.909-2.546-13.454C26.91 0 23.011 0 16 0 8.989 0 5.091 0 2.546 2.546 0 5.09 0 8.989 0 16c0 7.01 0 10.909 2.546 13.454C5.09 32 8.989 32 16 32" fill="#4c70f0"/>\n  <path d="M23.547 12.942c-1.957 3.406-3.917 6.81-5.87 10.217-.364.633-.892 1.016-1.616 1.068-.811.06-1.448-.283-1.857-.987-1.239-2.135-2.463-4.278-3.693-6.417-.748-1.302-1.499-2.602-2.243-3.905-.752-1.315.096-2.913 1.603-2.99.796-.042 1.41.325 1.814 1.018.552.947 1.094 1.9 1.64 2.85.395.684.78 1.374 1.186 2.05.586.984 1.449 1.538 2.597 1.607a3.163 3.163 0 0 0 3.328-2.812c.015-.13.024-.259.03-.325-.009-.56-.113-1.033-.335-1.478-.607-1.217.04-2.581 1.358-2.874 1.074-.238 2.186.553 2.328 1.645.062.48-.032.92-.27 1.333m.71-5.463c-4.634-4.639-12.147-4.639-16.781 0-4.635 4.638-4.635 12.158 0 16.795 4.634 4.638 12.147 4.638 16.782 0 4.634-4.637 4.634-12.157 0-16.795" fill="#fff"/>\n</svg>\n'},43893:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M10.9604 4.44569C10.4629 3.42529 10.9928 2.28123 12.0753 2.03561C12.9563 1.83607 13.8679 2.4994 13.9847 3.41546C14.0358 3.81793 13.958 4.18653 13.763 4.5331C12.1575 7.38833 10.55 10.2422 8.94712 13.0988C8.64918 13.6293 8.2163 13.9505 7.62207 13.9945C6.95657 14.044 6.43394 13.757 6.09839 13.1662C5.08249 11.3768 4.07782 9.58024 3.06885 7.78674C2.45515 6.69519 1.83948 5.605 1.22842 4.51209C0.612089 3.41004 1.30728 2.06983 2.54391 2.00479C3.19687 1.97057 3.70069 2.27852 4.03195 2.85919C4.48497 3.65295 4.9294 4.45213 5.37779 5.2486C5.70114 5.82249 6.01788 6.40011 6.35014 6.96825C6.83152 7.79216 7.53892 8.25696 8.48058 8.31489C9.81355 8.3962 11.0512 7.40798 11.2109 5.95665C11.2227 5.84824 11.2307 5.73983 11.2356 5.68427C11.2284 5.21472 11.1426 4.81903 10.9604 4.44569Z"/>\n</svg>\n'},32727:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n<path d="M11.256 4.73144L2.67246 20.0209C1.924 21.3541 2.88751 23 4.41643 23H21.5836C23.1125 23 24.076 21.3541 23.3275 20.0209L14.744 4.73144C13.9798 3.3702 12.0202 3.3702 11.256 4.73144Z" fill-opacity="0.2"/>\n<path d="M11.9059 10.4231C11.5644 10.4231 11.2975 10.7153 11.3314 11.0521L11.7933 15.6284C11.8228 15.9208 12.0712 16.1435 12.3678 16.1435H13.6322C13.9288 16.1435 14.1772 15.9208 14.2067 15.6284L14.6686 11.0521C14.7026 10.7153 14.4357 10.4231 14.0941 10.4231H11.9059Z" />\n<path d="M12.4227 17.2876C12.1038 17.2876 11.8453 17.5437 11.8453 17.8596V19.0037C11.8453 19.3197 12.1038 19.5758 12.4227 19.5758H13.5774C13.8962 19.5758 14.1547 19.3197 14.1547 19.0037V17.8596C14.1547 17.5437 13.8962 17.2876 13.5774 17.2876H12.4227Z" />\n</svg>\n'},20643:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n<path d="M7.13381 2.50139L1.36522 12.5003C0.980609 13.1669 1.46175 14 2.23141 14H13.7686C14.5382 14 15.0194 13.1669 14.6348 12.5003L8.86619 2.50139C8.48136 1.83435 7.51864 1.83435 7.13381 2.50139Z" fill-opacity="0.2"/>\n<path fill-rule="evenodd" clip-rule="evenodd" d="M7.32878 5.00012C6.88506 5.00012 6.53835 5.38324 6.5825 5.82475L6.9325 9.32475C6.97084 9.70815 7.29346 10.0001 7.67878 10.0001H8.3213C8.70661 10.0001 9.02923 9.70815 9.06757 9.32475L9.41757 5.82475C9.46173 5.38324 9.11501 5.00012 8.6713 5.00012H7.32878ZM7.75001 11C7.33579 11 7.00001 11.3358 7.00001 11.75V12.25C7.00001 12.6642 7.33579 13 7.75001 13H8.25001C8.66422 13 9.00001 12.6642 9.00001 12.25V11.75C9.00001 11.3358 8.66422 11 8.25001 11H7.75001Z"/>\n</svg>\n'},70913:e=>{e.exports='<svg width="16" height="16" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M7 6a1 1 0 1 1 2 0v3a1 1 0 0 1-2 0V6ZM7 12a1 1 0 1 1 2 0 1 1 0 0 1-2 0Z" fill="var(--colorFg)"/>\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M7.118 1.654a1 1 0 0 1 1.764 0l6.334 11.875A1 1 0 0 1 14.333 15H1.667a1 1 0 0 1-.883-1.47L7.118 1.653ZM2 14a.2.2 0 0 1-.176-.294l6-11.25a.2.2 0 0 1 .352 0l6 11.25A.2.2 0 0 1 14 14H2Z" fill="var(--colorFg)"/>\n</svg>\n'},17349:e=>{e.exports='<svg width="126" height="120" xmlns="http://www.w3.org/2000/svg">\r\n  <path d="M10 41.787a8 8 0 012.928-10.928L52.024 8.287a8 8 0 0110.928 2.928l2.497 4.324-52.953 30.572L10 41.787z" fill-opacity=".25"/>\r\n  <rect x="31.931" y="60.45" width="41.272" height="3.821" rx="1.911" transform="rotate(-30 31.931 60.45)"/>\r\n  <rect x="27.743" y="53.195" width="41.272" height="3.821" rx="1.911" transform="rotate(-30 27.743 53.195)"/>\r\n  <rect x="36.135" y="67.731" width="34.781" height="3.821" rx="1.911" transform="rotate(-30 36.135 67.73)"/>\r\n  <rect x="40.339" y="75.012" width="41.272" height="3.821" rx="1.911" transform="rotate(-30 40.339 75.012)"/>\r\n  <rect x="44.542" y="82.293" width="33.095" height="3.821" rx="1.911" transform="rotate(-30 44.542 82.293)"/>\r\n  <rect x="48.746" y="89.573" width="29.043" height="3.821" rx="1.911" transform="rotate(-30 48.746 89.573)"/>\r\n  <path d="M13.82 45.347l50.305-29.044.764 1.325L14.585 46.67z"/>\r\n  <path opacity=".2" fill-rule="evenodd" clip-rule="evenodd" d="M85.048 53.428L64.36 17.92l-1.728 1.006 21.18 36.355 1.236-1.853zm9.61 16.493l-1.793.897 3.77 6.472.007.011c.71 1.184 1.222 2.481 1.171 3.694-.047 1.13-.587 2.346-2.343 3.444-3.18 1.987-25.291 14.808-36.966 21.48a1 1 0 10.992 1.736c11.658-6.662 33.813-19.507 37.034-21.52 2.243-1.402 3.204-3.186 3.281-5.056.075-1.785-.662-3.486-1.45-4.8l-3.704-6.358z" fill="#000"/>\r\n  <path opacity=".1" fill-rule="evenodd" clip-rule="evenodd" d="M54.367 10.29a1 1 0 01-.37 1.364 7943.31 7943.31 0 01-24.024 13.68c-7.909 4.491-14.478 8.222-15.459 8.81-.726.436-1.342 1.31-1.605 2.391-.26 1.069-.148 2.243.448 3.237l.006.01.005.009 2 3.5.496.868-1.736.992-.496-.868-1.995-3.491c-.899-1.504-1.036-3.225-.671-4.728.362-1.493 1.246-2.87 2.52-3.635.995-.597 7.632-4.367 15.595-8.89 8.121-4.612 17.621-10.007 23.922-13.62a1 1 0 011.364.37z" fill="#fff"/>\r\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M13.928 32.59L53.024 10.02a6 6 0 018.196 2.196l23.81 41.24 1.237-1.856-23.315-40.384a8 8 0 00-10.928-2.928L12.928 30.859A8 8 0 0010 41.787l37.858 65.572a8 8 0 0010.928 2.928l39.096-22.572a8 8 0 002.928-10.928l-4.454-7.715-1.792.896 4.514 7.819a6 6 0 01-2.196 8.196l-39.096 22.572a6 6 0 01-8.196-2.196L11.732 40.787a6 6 0 012.196-8.196z"/>\r\n  <path opacity=".8" d="M105.515 21.267l5.957 3.44-22.546 39.051-5.958-3.44z"/>\r\n  <path d="M111.472 24.706l5.957 3.44-22.546 39.051-5.957-3.44z"/>\r\n  <path opacity=".2" d="M94.882 67.198l-11.914-6.88.989 12.045 10.925-5.165z"/>\r\n  <path d="M83.78 69.613l.177 2.75 2.47-1.222-2.647-1.528z"/>\r\n  <path opacity=".8" d="M109.365 14.598a3 3 0 014.098-1.098l3.359 1.94-4.586 7.943-5.957-3.44 3.086-5.345z"/>\r\n  <path d="M116.822 15.44l3.359 1.939a3 3 0 011.098 4.098l-3.086 5.345-5.957-3.44 4.586-7.943z"/>\r\n</svg>\r\n'},4798:e=>{e.exports='<svg width="126" height="120" xmlns="http://www.w3.org/2000/svg">\r\n  <path d="M4 10a6 6 0 016-6h106a6 6 0 016 6v7H4v-7z" fill-opacity=".2"/>\r\n  <path d="M63 4h2v112h-2zM65 59h57v2H65z"/>\r\n  <path d="M4 17h118v2H4z"/>\r\n  <rect x="16.788" y="8.915" width="25.139" height="4.436" rx="2.218"/>\r\n  <rect x="77.418" y="8.915" width="25.139" height="4.436" rx="2.218"/>\r\n  <rect x="9.394" y="8.915" width="4.436" height="4.436" rx="2.218"/>\r\n  <rect x="70.024" y="8.915" width="4.436" height="4.436" rx="2.218"/>\r\n  <rect opacity=".2" x="9" y="37" width="47" height="20" rx="2"/>\r\n  <rect x="9" y="26" width="37" height="6" rx="3"/>\r\n  <rect x="9" y="61" width="23.661" height="4" rx="2" fill-opacity=".2"/>\r\n  <rect x="9" y="91" width="24" height="4" rx="2" fill-opacity=".2"/>\r\n  <rect x="9" y="75" width="24" height="4" rx="2" fill-opacity=".2"/>\r\n  <rect x="9" y="105" width="24" height="4" rx="2" fill-opacity=".2"/>\r\n  <rect x="9" y="68" width="16" height="4" rx="2" fill-opacity=".2"/>\r\n  <rect x="9" y="98" width="16" height="4" rx="2" fill-opacity=".2"/>\r\n  <rect x="9" y="82" width="36" height="4" rx="2" fill-opacity=".2"/>\r\n  <rect x="35" y="61" width="21" height="4" rx="2" fill-opacity=".2"/>\r\n  <rect x="35" y="91" width="21" height="4" rx="2" fill-opacity=".2"/>\r\n  <rect x="35" y="75" width="21" height="4" rx="2" fill-opacity=".2"/>\r\n  <rect x="35" y="105" width="21" height="4" rx="2" fill-opacity=".2"/>\r\n  <rect x="27" y="68" width="29" height="4" rx="2" fill-opacity=".2"/>\r\n  <rect x="27" y="98" width="29" height="4" rx="2" fill-opacity=".2"/>\r\n  <rect x="47" y="82" width="9" height="4" rx="2" fill-opacity=".2"/>\r\n  <path d="M64 61h58v49a6 6 0 01-6 6H64V61z" fill-opacity=".25"/>\r\n  <rect x="71.503" y="89.988" width="41.406" height="14.788" rx="2"/>\r\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M72 71h25v2H72v-2zm41 4H87v2h26v-2zm-24 8H72v2h17v-2zm15-4H72v2h32v-2zm-32-4h13v2H72v-2zm41-4H99v2h14v-2zm-7 8h7v2h-7v-2zm7 4H91v2h22v-2z"/>\r\n  <path opacity=".1" d="M115 6a1 1 0 000-2v2zM6 17v-6H4v6h2zm0-6c0-.84.26-2.122 1.012-3.166C7.726 6.842 8.926 6 11 6V4C8.274 4 6.474 5.158 5.388 6.666 4.34 8.122 4 9.84 4 11h2zm5-5H115V4H11v2z" fill="#fff"/>\r\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M2 11a9 9 0 019-9h104a9 9 0 019 9v98a9 9 0 01-9 9H11a9 9 0 01-9-9V11zm9-7a7 7 0 00-7 7v98a7 7 0 007 7h104a7 7 0 007-7V11a7 7 0 00-7-7H11z"/>\r\n  <path opacity=".2" fill-rule="evenodd" clip-rule="evenodd" d="M121 12a1 1 0 011 1V108.5c0 2.21-.694 4.095-1.96 5.437-1.27 1.344-3.043 2.063-5.04 2.063H11a1 1 0 010-2h104c1.503 0 2.73-.531 3.585-1.437.859-.908 1.415-2.273 1.415-4.063V13a1 1 0 011-1z" fill="#000"/>\r\n</svg>\r\n'},34511:e=>{e.exports='<svg width="220" height="140" viewBox="0 0 220 140" xmlns="http://www.w3.org/2000/svg">\n    <path fill="#EFEFEF" d="M0 0H220V140H0V0Z"/>\n    <path fill="#E3E3E3" d="M0 114H220V140H0V114Z"/>\n    <path class="active-tab-preview" d="M6 120H75V134H6V120Z"/>\n    <path fill="#FFFFFF" d="M76 120H144V134H76V120ZM145 120H214V134H145V120Z"/>\n</svg>\n'},31614:e=>{e.exports='<svg width="220" height="140" xmlns="http://www.w3.org/2000/svg">\n    <path fill="#EFEFEF" d="M3 0H217C217.796 0 218.559 0.283653 219.121 0.788559C219.684 1.29346 220 1.97826 220 2.69231V140H0V2.69231C0 1.97826 0.31607 1.29346 0.87868 0.788559C1.44129 0.283653 2.20435 0 3 0V0Z"/>\n    <path fill="#E3E3E3" d="M0 0H81V140H0V0Z"/>\n    <path class="active-tab-preview" d="M6 6H75V20H6V6Z"/>\n    <path fill="#FFFFFF" d="M6 21H75V35H6V21ZM6 36H75V50H6V36Z"/>\n</svg>\n'},76201:e=>{e.exports='<svg width="220" height="140" xmlns="http://www.w3.org/2000/svg">\n    <path fill="#EFEFEF" d="M3 0H217C217.796 0 218.559 0.283653 219.121 0.788559C219.684 1.29346 220 1.97826 220 2.69231V140H0V2.69231C0 1.97826 0.31607 1.29346 0.87868 0.788559C1.44129 0.283653 2.20435 0 3 0V0Z"/>\n    <path fill="#E3E3E3" d="M139 0H220V140H139V0Z"/>\n    <path class="active-tab-preview" d="M145 6H214V20H145V6Z"/>\n    <path fill="#FFFFFF" d="M145 21H214V35H145V21ZM145 36H214V50H145V36Z"/>\n</svg>\n'},48753:e=>{e.exports='<svg width="220" height="140" xmlns="http://www.w3.org/2000/svg">\n  <path fill="#EFEFEF" d="M3 0h214a3.18 3.18 0 0 1 2.121.789c.563.504.879 1.19.879 1.903V140H0V2.692C0 1.978.316 1.293.879.79A3.183 3.183 0 0 1 3 0Z"/>\n  <path fill="#E3E3E3" d="M0 0h220v26H0V0Z"/>\n  <path class="active-tab-preview" d="M6 6h69v14H6V6Z"/>\n  <path fill="#FFFFFF" d="M76 6h68v14H76V6Zm69 0h69v14h-69V6Z"/>\n</svg>\n'},76259:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 116 116">\n  <path fill="#ef3939" d="M58 115c25 0 38.9 0 47.9-9.1C115 96.9 115 83 115 58s0-38.9-9.1-47.9C96.9 1 83 1 58 1s-38.9 0-47.9 9.1C1 19.1 1 33 1 58s0 38.9 9.1 47.9C19.1 115 33 115 58 115z"/>\n  <linearGradient id="a" x1="36.55" x2="91.02" y1="21.06" y2="115.39" gradientUnits="userSpaceOnUse">\n    <stop offset="0" stop-opacity=".2"/>\n    <stop offset=".79" stop-opacity=".05"/>\n  </linearGradient>\n  <path fill="url(#a)" d="M95.1 36.9A42.7 42.7 0 1 0 21.2 80l20.1 34.8 10.8.1h5.7c11.1 0 20 0 27.3-.8 9.1-1 15.6-3.2 20.7-8.3 7.3-7.3 8.7-17.9 9-34.9a3101.9 3101.9 0 0 1-19.7-34z"/>\n  <path fill="#fff" d="M88 27.8a42.7 42.7 0 1 0-60.3 60.5A42.7 42.7 0 1 0 88 27.8zm-2.5 19.7L64.4 84.2c-1.3 2.3-3.2 3.7-5.8 3.8-2.9.2-5.2-1-6.7-3.6L38.6 61.3l-8.1-14a7.1 7.1 0 0 1 5.8-10.8 6.8 6.8 0 0 1 6.5 3.7l5.9 10.3 4.3 7.4c2.1 3.5 5.2 5.5 9.3 5.8 5.8.3 11.3-3.9 12-10.1l.1-1.2c0-2-.4-3.7-1.2-5.3a7 7 0 0 1 4.9-10.3 7 7 0 0 1 8.4 5.9 8 8 0 0 1-1 4.8z"/>\n</svg>\n'},33427:e=>{e.exports='<svg width="126" height="120" xmlns="http://www.w3.org/2000/svg">\r\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M2 11a9 9 0 019-9h104a9 9 0 019 9v98a9 9 0 01-9 9H11a9 9 0 01-9-9V11zm9-7a7 7 0 00-7 7v98a7 7 0 007 7h104a7 7 0 007-7V11a7 7 0 00-7-7H11z"/>\r\n  <path d="M4 10a6 6 0 016-6h106a6 6 0 016 6v8H4v-8z" fill-opacity=".25"/>\r\n  <rect x="16" y="9" width="25" height="5" rx="2.5"/>\r\n  <rect opacity=".5" x="54" y="9" width="25" height="5" rx="2.5"/>\r\n  <rect opacity=".5" x="92" y="9" width="25" height="5" rx="2.5"/>\r\n  <rect x="9" y="9" width="5" height="5" rx="2.5"/>\r\n  <rect opacity=".5" x="47" y="9" width="5" height="5" rx="2.5"/>\r\n  <rect opacity=".5" x="85" y="9" width="5" height="5" rx="2.5"/>\r\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M122 18H4v2h37v96h2V20h79v-2z"/>\r\n  <path d="M4 19h37v97H10a6 6 0 01-6-6V19z" fill-opacity=".25"/>\r\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M9.394 25.643a3.697 3.697 0 00-3.697 3.695 3.697 3.697 0 007.394 0 3.697 3.697 0 00-3.697-3.695zm0 13.3a3.697 3.697 0 00-3.697 3.694 3.697 3.697 0 007.394 0 3.697 3.697 0 00-3.697-3.694zM5.697 55.936a3.697 3.697 0 017.394 0 3.697 3.697 0 01-7.394 0zm3.697 9.605a3.697 3.697 0 00-3.697 3.695 3.697 3.697 0 007.394 0 3.697 3.697 0 00-3.697-3.695zM5.697 82.535a3.697 3.697 0 017.394 0 3.697 3.697 0 01-7.394 0zm3.697 9.605a3.697 3.697 0 00-3.697 3.694 3.697 3.697 0 007.394 0 3.697 3.697 0 00-3.697-3.694zM30.097 25.643H16.048v1.478h14.049v-1.478zm0 13.3H16.048v1.477h14.049v-1.477zM16.048 52.242h14.049v1.478H16.048v-1.478zm14.049 13.3H16.048v1.477h14.049v-1.478zM16.048 78.84h14.049v1.478H16.048V78.84zm14.049 13.3H16.048v1.477h14.049V92.14zM16.048 28.598H38.23v1.477H16.048V28.6zm22.182 13.3H16.048v1.477H38.23v-1.478zM16.048 55.196H38.23v1.478H16.048v-1.478zm22.182 13.3H16.048v1.478H38.23v-1.478zm-22.182 13.3H38.23v1.477H16.048v-1.478zM38.23 95.095H16.048v1.477H38.23v-1.477zM16.048 31.553h18.485v1.478H16.048v-1.478zm18.485 13.3H16.048v1.477h18.485v-1.478zM16.048 58.152h18.485v1.478H16.048v-1.478zm18.485 13.3H16.048v1.477h18.485v-1.478zM16.048 84.751h18.485v1.477H16.048v-1.477zM34.533 98.05H16.048v1.478h18.485V98.05z"/>\r\n  <path opacity=".1" d="M115 6a1 1 0 000-2v2zM6 17v-6H4v6h2zm0-6c0-.84.26-2.122 1.012-3.166C7.726 6.842 8.926 6 11 6V4C8.274 4 6.474 5.158 5.388 6.666 4.34 8.122 4 9.84 4 11h2zm5-5H115V4H11v2z" fill="#fff"/>\r\n  <path opacity=".2" fill-rule="evenodd" clip-rule="evenodd" d="M121 11a1 1 0 011 1V108.5c0 2.21-.694 4.095-1.96 5.437-1.27 1.344-3.043 2.063-5.04 2.063H11a1 1 0 010-2h104c1.503 0 2.73-.531 3.585-1.437.859-.908 1.415-2.273 1.415-4.063V12a1 1 0 011-1z" fill="#000"/>\r\n</svg>\r\n'},9927:e=>{e.exports='<svg width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">\n    <path d="M1 1h2v1H1V1zm1 1h2v1H2V2zm4 0h2v1H6V2zm1-1h2v1H7V1zM3 3h4v1H3V3zm1 1h2v1H4V4zM3 5h4v1H3V5zM2 6h2v1H2V6zm4 0h2v1H6V6zm1 1h2v1H7V7zM1 7h2v1H1V7z"/>\n</svg>'},7969:e=>{e.exports='<svg class="window-maximize" xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 10 10">\n\n  <g class="window-maximize-glyph">\n    <path d="M1 2h8v1H1V2zM0 1h10v1H0V1zm0 7h10v1H0V8zm0-6h1v6H0V2zm9 0h1v6H9V2z"/>\n  </g>\n\n  <g class="window-restore-glyph">\n    <path d="M1 3h6v1H1V3zM0 2h8v1H0V2zm1 7h6v1H1V9zM0 3h1v7H0V3zm7 0h1v7H7V3zM2 0h8v1H2V0zm7 1h1v7H9V1z"/>\n  </g>\n</svg>\n'},98221:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 10 10">\n    <path d="M1 7h8v2H1z"/>\n</svg>'},51759:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 10 10">\n  <path d="M10.2.5l-.7-.7L5 4.3.5-.2l-.7.7L4.3 5-.2 9.5l.7.7L5 5.7l4.5 4.5.7-.7L5.7 5"/>\n</svg>\n'},9592:e=>{e.exports='<svg class="window-maximize" xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 10 10">\n\n  <g class="window-maximize-glyph">\n    <path d="M9 1v8H1V1h8m1-1H0v10h10V0z"/>\n  </g>\n\n  <g class="window-restore-glyph">\n    <path d="M3 0H2v2H0v8h8V8h2V0H3zm4 9H1V3h6v6zm2-2H8V2H3V1h6v6z"/>\n  </g>\n</svg>\n'},96375:e=>{e.exports='<svg width="10" height="10" viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg">\n  <path d="M0 5H10V6H0V5Z"/>\n</svg>\n'},13929:e=>{e.exports='<svg viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M21 8C21 6.89543 20.1046 6 19 6H7C5.89543 6 5 6.89543 5 8V18C5 19.1046 5.89543 20 7 20H19C20.1046 20 21 19.1046 21 18V8ZM10 8H12V10H10V8ZM9 8H7V10H9V8ZM19 11V18H7V11H19ZM13 10H19V8H13V10Z"/>\n</svg>\n'},2144:e=>{e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M1 4C1 2.89543 1.89543 2 3 2H13C14.1046 2 15 2.89543 15 4V12C15 13.1046 14.1046 14 13 14H3C1.89543 14 1 13.1046 1 12V4ZM9 4H13V6H9V4ZM8 4H6V6H8V4ZM5 4H3V6H5V4ZM3 7L3 12H13V7H3Z"/>\n</svg>\n'},32545:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M14 3H2a1 1 0 00-1 1v2h14V4a1 1 0 00-1-1zM1 12V7h14v5a1 1 0 01-1 1H2a1 1 0 01-1-1zM2 2a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V4a2 2 0 00-2-2H2zm4 2H2v1h4V4z"/>\n</svg>\n'},31866:e=>{e.exports='<svg width="16" height="16" xmlns="http://www.w3.org/2000/svg">\n  <path class="small-icon-fill" fill-rule="evenodd" clip-rule="evenodd" d="M1 4C1 3.44772 1.44772 3 2 3H14C14.5523 3 15 3.44772 15 4V6H1V4ZM1 7V12C1 12.5523 1.44772 13 2 13H14C14.5523 13 15 12.5523 15 12V7H1ZM2 4H6V5H2V4Z"/>\n  <path class="small-icon-outline" fill-rule="evenodd" clip-rule="evenodd" d="M2 3H14C14.5523 3 15 3.44772 15 4V6H16V4C16 2.89543 15.1046 2 14 2H2C0.895431 2 0 2.89543 0 4V6H1V4C1 3.44772 1.44772 3 2 3ZM1 7H0V12C0 13.1046 0.895431 14 2 14H14C15.1046 14 16 13.1046 16 12V7H15V12C15 12.5523 14.5523 13 14 13H2C1.44772 13 1 12.5523 1 12V7Z"/>\n</svg>\n'},62077:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i="iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACfSURBVHgBvZIxCgMhEEXHkEZPscex1s7LZHMWwU5bvU1yCW3NuoEQwoy6BPY1Mvh9OirAn7Dvwhjz2IYFya3OuTsmuPzUC+Csm/w2I+iBSo4IUAkpkFKC1hqVTAkaSilK8uFKTaSUQAixC0opEGNEc90TMPZ+Zc45mSEFbefWgvceQgikgGwh5wzW2r2VHt07mOHoPxgKnqMFtdZh5lxeJo4r4FiF0c8AAAAASUVORK5CYII="},72536:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i="iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACfSURBVHgBvZIxCgMhEEXHkEZPscex1s7LZHMWwU5bvU1yCW3NuoEQwoy6BPY1Mvh9OirAn7Dvwhjz2IYFya3OuTsmuPzUC+Csm/w2I+iBSo4IUAkpkFKC1hqVTAkaSilK8uFKTaSUQAixC0opEGNEc90TMPZ+Zc45mSEFbefWgvceQgikgGwh5wzW2r2VHt07mOHoPxgKnqMFtdZh5lxeJo4r4FiF0c8AAAAASUVORK5CYII="},9414:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i="iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAyUlEQVR42q3TvQrCMBDAcV+ro7vvURx9AXVyaUGwuzinfsw66OYD+AJ2K21DUlooDaXEXOGki7mCDfy4G5L/lslsvvjLuAFz1j9MBwe01queped5F8dxthAZGti0bfvFGHsIISRGyEDTNDsjAEqpAALanH7EGqjr+tDnuu4+DMM78H3/DHesgaqqjhYnMlCW5bUoihuAHSciA+bBM8/zDuw4cScDUsqXDRngnL9RlmURTtzJQJIkPE3TDuw4ERmI41jZkIEhRv2NH2DDzUU+EiSYAAAAAElFTkSuQmCC"},86635:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i="iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAqUlEQVR4AWP4z4gfElbAYMNQw9AAhSkMzBgKgNIiDOxQGMXgg6mgQYVdBSgJwgx8DLkMtUiwgsEXqKCBBwGTeKP5ENBbkKEBpEAAAftBGEKC+WAFlaK4IVhBjhQCFkiCMAKCFYTKIWCELAhHyMbJgXCcHFiBk7KTsicYI6CLEgi7KIEV6KnrqauDMAJARIAQpKCWz1RQBzvkMgWGBYMjkGjADoEyjpTHJgCRpZrxxM2tswAAAABJRU5ErkJggg=="},68551:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i="iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAZElEQVR42mNgoBj8if/9/vd/MHz/ux6Lgl/3//j+NwbBP76/n/2u/y+ApuD3f4g0VMlmqGlg+Of+n3gUBejwj+/v93gV/Df+/X+IKHgPCyhs3vxzn+FXwq/7yIGDAt//SqA8MgF9hfa1XsQ+LgAAAABJRU5ErkJggg=="},13253:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i="iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAACxMAAAsTAQCanBgAAAAHdElNRQfiAxMIBBzsKlp7AAAA6klEQVQoz42RP04CURDGf8MObmyk8QSElhtQYGdBYSgJhhvABTCEI+AFJJGaUEDiRewojKEBJWGzBXlRGQoWeKsJOJN5k5l8b/59YsJJyXBGhBJlNIlmPNnmN6TNNWGiNSomaVW0EMOUAlMY05C29/mLV4V69pDYvPedN/QqmLQUDhMARSJyQESOCGyCgjtWYJHY/gWF2AOofYuav4PC3GsR2I+MeoDcNUePQF5hmYUQR5iALAMQXexurPCp4AhxKcCb7rzwcPUSrP2uR3bc5fpWuKFEkLptFYAhVYwP+cumDAA6993nf7G5BYxPRUIY3xtuAAAAAElFTkSuQmCC"},89661:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i="iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAbElEQVR42mNgoBj8if/9/vd/MHz/ux6Lgl/3//j+NwbBP76/n/2u/y+ApuD3f4g0VMlmqGlg+Of+n3gUBejwj+/v93gV/Df+/Z90BRi+wFQAcSCcpoKC97CAwuGGXwm/7iMHDoYJDFicTZICAK40+w1CznHyAAAAAElFTkSuQmCC"},52361:()=>{},94616:()=>{},78491:()=>{},70253:e=>{"use strict";e.exports=JSON.parse('{"M":{"pb":[["af","Afrikaans","Afrikaans"],["az","Azerbaijani","Azərbaycanca"],["be","Belarusian","Беларуская"],["bg","Bulgarian","български"],["cs","Czech","Čeština"],["da","Danish","Dansk"],["de","German","Deutsch"],["de-CH","Swiss German","Schweizerdeutsch"],["el","Greek","Ελληνικά"],["en-US","English (US)","English (US)"],["en-GB","English (UK)","English (UK)"],["es","Spanish","Español"],["et","Estonian","Eesti keel"],["fa","Persian","فارسی"],["fi","Finnish","Suomi"],["fr","French","Français"],["fy","Frisian","Frysk"],["gd","Scots Gaelic","Gàidhlig"],["hu","Hungarian","Magyar"],["hr","Croatian","Hrvatski"],["hy","Armenian","Հայերեն"],["id","Indonesian","Bahasa Indonesia"],["is","Icelandic","Íslenska"],["it","Italian","Italiano"],["ja-KS","Japanese (Kansai)","関西弁"],["ja","Japanese","日本語"],["kab","Kabyle","Taqbaylit"],["ko","Korean","한국어"],["ku","Kurdish","Kurdî"],["lt","Lithuanian","Lietuvių"],["nb","Norwegian (Bokmål)","Norsk (bokmål)"],["nn","Norwegian (Nynorsk)","Norsk (nynorsk)"],["nl","Dutch","Nederlands"],["pl","Polish","Polski"],["pt-BR","Portuguese (Brazil)","Português (Brasil)"],["pt-PT","Portuguese (Portugal)","Português (Europeu)"],["ro","Romanian","Română"],["ru","Russian","Русский"],["sk","Slovak","Slovenčina"],["sl","Slovenian","Slovenščina"],["sq","Albanian","Shqip"],["sr","Serbian","Српски"],["sr-Latn","Serbian (Latin)","Srpski"],["sv","Swedish","Svenska"],["tr","Turkish","Türkçe"],["uk","Ukrainian","Українська"],["vi","Vietnamese","Tiếng Việt"],["zh-CN","Chinese (Simplified)","简体中文"],["zh-TW","Chinese (Traditional)","正體中文"]]}}')}},n={};function i(e){var s=n[e];if(void 0!==s)return s.exports;var o=n[e]={id:e,loaded:!1,exports:{}};return t[e].call(o.exports,o,o.exports,i),o.loaded=!0,o.exports}i.m=t,e=[],i.O=(t,n,s,o)=>{if(!n){var a=1/0;for(c=0;c<e.length;c++){for(var[n,s,o]=e[c],r=!0,l=0;l<n.length;l++)(!1&o||a>=o)&&Object.keys(i.O).every((e=>i.O[e](n[l])))?n.splice(l--,1):(r=!1,o<a&&(a=o));if(r){e.splice(c--,1);var d=s();void 0!==d&&(t=d)}}return t}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[n,s,o]},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),i.j=296,(()=>{var e={296:0};i.O.j=t=>0===e[t];var t=(t,n)=>{var s,o,[a,r,l]=n,d=0;if(a.some((t=>0!==e[t]))){for(s in r)i.o(r,s)&&(i.m[s]=r[s]);if(l)var c=l(i)}for(t&&t(n);d<a.length;d++)o=a[d],i.o(e,o)&&e[o]&&e[o][0](),e[a[d]]=0;return i.O(c)},n=self.webpackChunkgapp_browser_react=self.webpackChunkgapp_browser_react||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var s=i.O(void 0,[739,277],(()=>i(82882)));s=i.O(s)})();